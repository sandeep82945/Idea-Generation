{
    "abstractText": "We propose a regularization for Reduced Order Models (ROMs) of the quasi-geostrophic equations (QGE) to increase accuracy when the Proper Orthogonal Decomposition (POD) modes retained to construct the reduced basis are insufficient to describe the system dynamics. Our regularization is based on the so-called BV-\u03b1 model, which modifies the nonlinear term in the QGE and adds a linear differential filter for the vorticity. To show the effectiveness of the BV-\u03b1 model for ROM closure, we compare the results computed by a POD-Galerkin ROM with and without regularization for the classical double-gyre wind forcing benchmark. Our numerical results show that the solution computed by the regularized ROM is more accurate, even when the retained POD modes account for a small percentage of the eigenvalue energy. Additionally, we show that, although computationally more expensive that the ROM with no regularization, the regularized ROM is still a competitive alternative to full order simulations of the QGE.",
    "authors": [
        {
            "affiliations": [],
            "name": "MICHELE GIRFOGLIO"
        },
        {
            "affiliations": [],
            "name": "ANNALISA QUAINI"
        },
        {
            "affiliations": [],
            "name": "Roland Glowinski"
        }
    ],
    "id": "SP:cd48239313c1b52779541f7434e7d203e927e4dc",
    "references": [
        {
            "authors": [
                "Y. Achdou",
                "R. Glowinski",
                "O. Pironneau"
            ],
            "title": "Tuning the mesh of a mixed method for the stream function vorticity formulation of the navier-stokes equations",
            "venue": "Numer. Math.,",
            "year": 1992
        },
        {
            "authors": [
                "P. Benner",
                "W. Schilders",
                "S. Grivet-Talocia",
                "A. Quarteroni",
                "G. Rozza",
                "L.M. Silveira"
            ],
            "title": "Model Order Reduction",
            "year": 2020
        },
        {
            "authors": [
                "G. Carere",
                "M. Strazzullo",
                "F. Ballarin",
                "G. Rozza",
                "R. Stevenson"
            ],
            "title": "A weighted POD-reduction approach for parametrized PDE-constrained optimal control problems with random inputs and applications to environmental sciences",
            "venue": "Computers & Mathematics with Applications,",
            "year": 2021
        },
        {
            "authors": [
                "F. Chinesta",
                "A. Huerta",
                "G. Rozza",
                "K. Willcox"
            ],
            "title": "Model Order Reduction",
            "venue": "Encyclopedia of Computational Mechanics, Elsevier Editor,",
            "year": 2016
        },
        {
            "authors": [
                "F. Chinesta",
                "P. Ladeveze",
                "E. Cueto"
            ],
            "title": "A Short Review on Model Order Reduction Based on Proper Generalized Decomposition",
            "venue": "Archives of Computational Methods in Engineering,",
            "year": 2011
        },
        {
            "authors": [
                "B. Cushman-Roisin",
                "J.M. Beckers"
            ],
            "title": "Introduction to geophysical fluid dynamics: physical and numerical aspects",
            "year": 2011
        },
        {
            "authors": [
                "E.J. Dean",
                "R. Glowinski",
                "O. Pironneau"
            ],
            "title": "Iterative solution of the stream function-vorticity formulation of the stokes problem, applications to the numerical simulation of incompressible viscous flow",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 1991
        },
        {
            "authors": [
                "A. Dumon",
                "C. Allery",
                "A. Ammar"
            ],
            "title": "Proper General Decomposition (PGD) for the resolution of Navier-Stokes equations",
            "venue": "Journal of Computational Physics,",
            "year": 2011
        },
        {
            "authors": [
                "C. Franzke",
                "A.J. Majda",
                "E. Vanden-Eijnden"
            ],
            "title": "Low-order stochastic mode reduction for a realistic barotropic model climate",
            "venue": "Journal of the Atmospheric Sciences,",
            "year": 2005
        },
        {
            "authors": [
                "M. Girfoglio",
                "A. Quaini",
                "G.Rozza"
            ],
            "title": "Pressure stabilization strategies for a LES filtering",
            "venue": "Reduced Order Model. Fluids,",
            "year": 2021
        },
        {
            "authors": [
                "M. Girfoglio",
                "A. Quaini",
                "G. Rozza"
            ],
            "title": "A POD-Galerkin reduced order model for a LES filtering approach",
            "venue": "Journal of Computational Physics,",
            "year": 2021
        },
        {
            "authors": [
                "M. Girfoglio",
                "A. Quaini",
                "G. Rozza"
            ],
            "title": "A POD-Galerkin reduced order model for the Navier\u2013Stokes equations in stream function-vorticity formulation",
            "venue": "Computers & Fluids,",
            "year": 2022
        },
        {
            "authors": [
                "M. Girfoglio",
                "A. Quaini",
                "G. Rozza"
            ],
            "title": "A novel Large Eddy Simulation model for the Quasi-Geostrophic equations in a Finite Volume setting",
            "venue": "Journal of Computational and Applied Mathematics,",
            "year": 2023
        },
        {
            "authors": [
                "R. Glowinski"
            ],
            "title": "Finite element methods for incompressible viscous flow, in: P.G.Ciarlet, J.-L.Lions (Eds), Handbook of numerical analysis, volume 9",
            "year": 2003
        },
        {
            "authors": [
                "R. Glowinski",
                "O. Pironneau"
            ],
            "title": "Numerical solution for the two-dimensional Stokes problem through the streamfunction vorticity formulation. In Functional Analysis and Numerical Analysis, Japan-France Seminar",
            "venue": "Tokyo and Kyoto,",
            "year": 1976
        },
        {
            "authors": [
                "R. Greatbatch",
                "B. Nadiga"
            ],
            "title": "Four-gyre circulation in a barotropic model with double-gyre wind forcing",
            "venue": "Journal of Physical Oceanography,",
            "year": 2000
        },
        {
            "authors": [
                "M. Gunzburger",
                "T. Iliescu",
                "M. Mohebujjaman",
                "M. Schneier"
            ],
            "title": "An Evolve-Filter-Relax Stabilized Reduced Order Stochastic Collocation Method for the Time-Dependent Navier\u2013Stokes Equations",
            "venue": "SIAM/ASA Journal on Uncertainty Quantification, 7:1162\u20131184,",
            "year": 2019
        },
        {
            "authors": [
                "M. Gunzburger",
                "T. Iliescu",
                "M. Schneier"
            ],
            "title": "A Leray regularized ensemble-proper orthogonal decomposition method for parameterized convection-dominated flows",
            "venue": "IMA Journal of Numerical Analysis,",
            "year": 2019
        },
        {
            "authors": [
                "D. Holm",
                "B. Nadiga"
            ],
            "title": "Modeling mesoscale turbulence in the barotropic double-gyre circulation",
            "venue": "Journal of Physical Oceanography,",
            "year": 2003
        },
        {
            "authors": [
                "T. Iliescu",
                "H. Liu",
                "X. Xie"
            ],
            "title": "Regularized reduced order models for a stochastic burgers equation",
            "venue": "International Journal of Numerical Analysis and Modeling,",
            "year": 2016
        },
        {
            "authors": [
                "I. Kalashnikova",
                "M.F. Barone"
            ],
            "title": "On the stability and convergence of a Galerkin reduced order model (ROM) of compressible flow with solid wall and far-field boundary treatment",
            "venue": "International Journal for Numerical Methods in Engineering,",
            "year": 2010
        },
        {
            "authors": [
                "A.N. Kolmogorov"
            ],
            "title": "Dissipation of energy in isotropic turbulence",
            "venue": "Dokl. Akad. Nauk. SSSR,",
            "year": 1941
        },
        {
            "authors": [
                "A.N. Kolmogorov"
            ],
            "title": "The local structure of turbulence in incompressible viscous fluids at very large Reynolds numbers",
            "venue": "Dokl. Akad. Nauk. SSSR,",
            "year": 1941
        },
        {
            "authors": [
                "K. Kunisch",
                "S. Volkwein"
            ],
            "title": "Galerkin proper orthogonal decomposition methods for a general equation in fluid dynamics",
            "venue": "SIAM Journal on Numerical Analysis,",
            "year": 2002
        },
        {
            "authors": [
                "J.C. McWilliams"
            ],
            "title": "Fundamentals of geophysical fluid dynamics",
            "year": 2006
        },
        {
            "authors": [
                "I. Monteiro",
                "C. Carolina"
            ],
            "title": "Improving numerical accuracy in a regularized barotropic vorticity model of geophysical flow",
            "venue": "International Journal of Numerical Analysis and Modelling, Series B,",
            "year": 2014
        },
        {
            "authors": [
                "I. Monteiro",
                "C. Manica",
                "L. Rebholz"
            ],
            "title": "Numerical study of a regularized barotropic vorticity model of geophysical flow",
            "venue": "Numerical Methods for Partial Differential Equations,",
            "year": 2015
        },
        {
            "authors": [
                "C. Mou",
                "B. Koc",
                "O. San",
                "L.G. Rebholz",
                "T. Iliescu"
            ],
            "title": "Data-driven variational multiscale reduced order models",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 2021
        },
        {
            "authors": [
                "C. Mou",
                "H. Liu",
                "D.R. Wells",
                "T. Iliescu"
            ],
            "title": "Data-driven correction reduced order models for the quasi-geostrophic equations: A numerical investigation",
            "venue": "International Journal of Computational Fluid Dynamics,",
            "year": 2020
        },
        {
            "authors": [
                "C.Z. Mou",
                "Wang",
                "D. Wells",
                "X. Xie",
                "T. Iliescu"
            ],
            "title": "Reduced order models for the quasi-geostrophic equations: A brief survey",
            "year": 2020
        },
        {
            "authors": [
                "B. Nadiga",
                "L. Margolin"
            ],
            "title": "Dispersive-dissipative eddy parameterization in a barotropic model",
            "venue": "Journal of Physical Oceanography,",
            "year": 2001
        },
        {
            "authors": [
                "A. Quarteroni",
                "A. Manzoni",
                "F. Negri"
            ],
            "title": "Reduced Basis Methods for Partial Differential Equations",
            "year": 2016
        },
        {
            "authors": [
                "Sk. M. Rahman",
                "S.E. Ahmed",
                "O. San"
            ],
            "title": "A dynamic closure modeling framework for model order reduction of geophysical flows",
            "venue": "Physics of Fluids,",
            "year": 2019
        },
        {
            "authors": [
                "Sk. M. Rahman",
                "S. Pawar",
                "O. San",
                "A. Rasheed",
                "T. Iliescu"
            ],
            "title": "Nonintrusive reduced order modeling framework for quasigeostrophic turbulence",
            "venue": "Physical Review E,",
            "year": 2019
        },
        {
            "authors": [
                "Sk. M. Rahman",
                "O. San",
                "A. Rasheed"
            ],
            "title": "A Hybrid Approach for Model Order Reduction of Barotropic Quasi- Geostrophic",
            "venue": "Turbulence . Fluids,",
            "year": 2018
        },
        {
            "authors": [
                "G. Rozza",
                "D.B.P. Huynh",
                "A.T. Patera"
            ],
            "title": "Reduced Basis Approximation and a Posteriori Error Estimation for Affinely Parametrized Elliptic Coercive Partial Differential Equations",
            "venue": "Archives of Computational Methods in Engineering,",
            "year": 2008
        },
        {
            "authors": [
                "G. Rozza",
                "G. Stabile",
                "F. Ballarin"
            ],
            "title": "Advanced Reduced Order Methods and Applications in Computational Fluid Dynamics",
            "year": 2022
        },
        {
            "authors": [
                "O. San",
                "R. Maulik"
            ],
            "title": "Extreme learning machine for reduced order modeling of turbulent geophysical flows",
            "venue": "Physical Review E,",
            "year": 2018
        },
        {
            "authors": [
                "O. San",
                "A. Staples",
                "T. Iliescu"
            ],
            "title": "Approximate deconvolution large eddy simulation of a stratified two-layer quasigeostrophic ocean model",
            "venue": "Ocean Modelling,",
            "year": 2012
        },
        {
            "authors": [
                "O. San",
                "A. Staples",
                "Z. Wang",
                "T. Iliescu"
            ],
            "title": "Approximate deconvolution large eddy simulation of a barotropic ocean circulation model",
            "venue": "Ocean Modelling,",
            "year": 2011
        },
        {
            "authors": [
                "Omer San",
                "Traian Iliescu"
            ],
            "title": "A stabilized proper orthogonal decomposition reduced-order model for large scale quasigeostrophic ocean circulation",
            "venue": "Advances in Computational Mathematics,",
            "year": 2015
        },
        {
            "authors": [
                "F.M. Selten"
            ],
            "title": "An efficient description of the dynamics of barotropic flow",
            "venue": "Journal of Atmospheric Sciences,",
            "year": 1995
        },
        {
            "authors": [
                "S.K. Star",
                "G. Stabile",
                "F. Belloni",
                "G. Rozza",
                "J. Degroote"
            ],
            "title": "Extension and comparison of techniques to enforce boundary conditions in finite volume pod-galerkin reduced order models for fluid dynamic problems",
            "year": 1912
        },
        {
            "authors": [
                "M. Strazzullo",
                "F. Ballarin",
                "M. Girfoglio",
                "T. Iliescu",
                "G. Rozza"
            ],
            "title": "Consistency of the full and reduced order models for evolve-filter-relax regularization of convection-dominated, marginally-resolved flows",
            "venue": "International Journal for Numerical Methods in Engineering,",
            "year": 2021
        },
        {
            "authors": [
                "M. Strazzullo",
                "F. Ballarin",
                "R. Mosetti",
                "G. Rozza"
            ],
            "title": "Model reduction for parametrized optimal control problems in environmental marine sciences and engineering",
            "venue": "SIAM Journal on Scientific Computing,",
            "year": 2017
        },
        {
            "authors": [
                "T.E. Tezduyar",
                "R. Glowinski",
                "F. Glaisner"
            ],
            "title": "Streamline-upwind/Petrov-Galerkin procedures for the vorticitystream function form of the Navier-Stokes equations",
            "venue": "In Numerical Methods in Laminar and Turbulent Flow,",
            "year": 1987
        },
        {
            "authors": [
                "T.E. Tezduyar",
                "R. Glowinski",
                "J. Liou"
            ],
            "title": "Petrov-galerkin methods on multiply connected domains for the vorticity-stream function formulation of the incompressible navier-stokes equations",
            "venue": "International Journal for Numerical Methods in Fluids,",
            "year": 1988
        },
        {
            "authors": [
                "G.K. Vallis"
            ],
            "title": "Atmospheric and Oceanic Fluid Dynamics",
            "year": 2006
        },
        {
            "authors": [
                "Z. Wang",
                "I. Akhtar",
                "J. Borggard",
                "T. Iliescu"
            ],
            "title": "Proper orthogonal decomposition closure models for turbulent flows: A numerical comparison",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 2012
        },
        {
            "authors": [
                "H.G. Weller",
                "G. Tabor",
                "H. Jasak"
            ],
            "title": "Fureby. A tensorial approach to computational continuum mechanics using object-oriented techniques",
            "venue": "Computers in physics,",
            "year": 1998
        },
        {
            "authors": [
                "D. Wells",
                "Z. Wang",
                "X. Xie",
                "T. Iliescu"
            ],
            "title": "An evolve-then-filter regularized reduced order model for convectiondominated flows",
            "venue": "International Journal for Numerical Methods in Fluids,",
            "year": 2017
        },
        {
            "authors": [
                "X. Xie",
                "M. Mohebujjaman",
                "L.G. Rebholz",
                "T. Iliescu"
            ],
            "title": "Data-driven filtered reduced order modeling of fluid flows",
            "venue": "SIAM Journal on Scientific Computing,",
            "year": 2018
        },
        {
            "authors": [
                "X. Xie",
                "D. Wells",
                "Z. Wang",
                "T. Iliescu"
            ],
            "title": "Approximate deconvolution reduced order modeling",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 2016
        }
    ],
    "sections": [
        {
            "text": "phic equations (QGE) to increase accuracy when the Proper Orthogonal Decomposition (POD) modes retained to construct the reduced basis are insufficient to describe the system dynamics. Our regularization is based on the so-called BV-\u03b1 model, which modifies the nonlinear term in the QGE and adds a linear differential filter for the vorticity. To show the effectiveness of the BV-\u03b1 model for ROM closure, we compare the results computed by a POD-Galerkin ROM with and without regularization for the classical double-gyre wind forcing benchmark. Our numerical results show that the solution computed by the regularized ROM is more accurate, even when the retained POD modes account for a small percentage of the eigenvalue energy. Additionally, we show that, although computationally more expensive that the ROM with no regularization, the regularized ROM is still a competitive alternative to full order simulations of the QGE.\nKeywords: Quasi-geostrophic equations, Proper Orthogonal Decomposition, Reduced order model, Galerkin projection, Filter regularization\nDedicated to the memory of Roland Glowinski"
        },
        {
            "heading": "1. Introduction",
            "text": "During his long and distinguished career, Roland Glowinski has given outstanding contributions to the development of several methodologies (e.g., nonlinear least squares methods, domain decomposition methods, and fictitious domain methods) with applications to a wide range of problems. One of the fields he has extensively contributed to throughout his career is Computational Fluid Dynamics. Among his most cited works in this field, there is a handbook on finite element methods for incompressible viscous flow [14], which is a great example of clear, precise, and unambiguous scientific prose. For some of his works on the Stokes and Navier-Stokes equations, Glowinski has chosen the stream function-vorticity formulation [15, 46, 47, 7, 1]. This paper focuses on the stream function-potential vorticity formulation of the quasi-geostrophic equations, which are a simplification of the Navier-Stokes equations used for ocean modeling.\nOcean flows are characterized by the evolution of flow structures (eddies and vortices) with a broad range of spatial scales, the larger scales being of the order of hundreds or thousands kilometers and the smaller scales less than 1 mm big. This poses a serious challenge at the computational level, especially in certain flow regimes. Two non-dimensional numbers are often used to describe the ocean flow regime: the Reynolds number Re and the Rossby number Ro. The Reynolds number is the ratio of inertial forces to viscous forces, while the Rossby number weighs the inertial force over the Coriolis force. Ocean flows with large Re and small Ro are particularly challenging as they require very fine computational meshes to resolve all the eddy scales, leading to a prohibitive computational cost.\nIn order to contain the computational cost of ocean flow simulations, assumptions are introduced at the level of the the model describing the dynamics. One simplified model is given by the shallow water equations, which are obtained from the Navier\u2013Stokes equations under the assumption that\n1 mathLab, Mathematics Area, SISSA, via Bonomea 265, I-34136 Trieste, Italy 2 Department of Mathematics, University of Houston, Houston TX 77204, USA\n1\nar X\niv :2\n21 1.\n16 85\n1v 1\n[ m\nat h.\nN A\n] 3\n0 N\nov 2\n02 2\nthe horizontal length scale for the problem is much greater than its vertical length scale. Typically satisfied by ocean flows on large domains since maximum ocean depth is about 10 km, this assumption allows to average the Navier\u2013Stokes equations over the depth and get rid of the vertical dimension. In the limit of small Ro, i.e., when the inertial forces are negligible with respect to the Coriolis and pressure forces, one can further simplify the shallow water equations to obtain the quasi-geostrophic equations (QGE). The name for this model comes from the fact that for Ro = 0 one recovers geostrophic flow. See, e.g., [48, 6, 25] for mathematical and physical fundamentals, [39, 3, 45] for some advanced applications and [30] for a recent review on the QGE.\nAlthough the QGE represent one of the simplest models for geophysical flows, their numerical simulation is still non-trivial. In fact, when the the Munk scale (a length that depends on Ro/Re) is small, computational simulations require very fine meshes because the mesh size has to be smaller than the Munk scale. Since often long time intervals have to be simulated, the overall computational cost becomes prohibitive. Hence, the need for techniques that reduce the computational cost of simulations for small Rossby numbers remains pressing.\nReduced order models (ROMs) are inexpensive surrogates for expensive models that are built based on a relatively few solutions of the latter model and for which the expense incurred in the construction process is then amortized over many solutions of the surrogate [37, 2, 36]. ROMs have been applied to more efficiently treat problems in uncertainty quantification, control and optimization, and other settings that require multiple simulations, with applications ranging from biomedical to naval engineering. Among all the existing approaches for ROM development, the proper orthogonal decomposition (POD) is one of the most successful. POD allows to extract the dominant modes from a database of high-fidelity numerical solutions. Such modes are used to construct a reduced basis. Then, a way to build the reduced model is by projecting the governing equations onto the space spanned by the reduced basis. See, e.g., [37, 2, 36]. In this paper, we propose a POD-based ROM for the GQE when time is the only parameter.\nIt is well known that the number of POD basis functions is usually small (meaning, O(10)) for computational problems dominated by diffusion, i.e., for flows characterized by small Re. Since the size of the reduced problem depends on the size of the POD basis, POD-based ROMs are very efficient surrogate models for low Re flows. However, realistic geophysical flows are dominated by convection (i.e., Re is high) and thus the dimension of the POD basis is expected to be large. Since the use of large POD basis implies limited computational savings or none at all, one is forced to work with an insufficient number of POD modes in order to indeed reduce the computational time. However, when the number of modes is not enough to capture the relevant flow dynamics, the ROM solution is unphysical, typically displaying spurious numerical oscillations. One way to fix this issue is the introduction of a closure model.\nClosure models, also called regularizations, aim at capturing the effect of the truncated POD modes. In the literature, one can find several strategies to obtain ROM closure models for the QGE. Among these strategies, we mention large eddy simulation (LES) [42, 41, 33, 29, 28, 52, 49], machine learning [35, 34, 38], and stochastic mode reduction [9]. In this paper, we propose a novel ROM closure of the LES type and compare it with the corresponding ROM with no closure to stress the importance of regularization. The particular LES approach that we follow is called BV-\u03b1, from the fact that the QGE are also known as barotropic vorticity (BV) equations and parameter \u03b1 (the filtering radius) is of critical importance as we shall see.\nThe BV-\u03b1 model has been widely used as a replacement of the QGE, i.e., as a full order model [31, 19, 27, 26, 13]. By modifying the nonlinear term in the QGE and adding a differential filter for the vorticity (which can be linear [31, 19, 27, 26] or nonlinear [13]), the BV-\u03b1 model circumvents the need for a mesh size smaller than the Munk scale. Thanks to this, the BV-\u03b1 model provides a physical computed solution with coarser meshes than needed by the QGE. Here, we adopt the linear BV-\u03b1 model for ROM closure. To the best of our knowledge, this idea has not been investigated so far.\nThere are a few other differences between our regularized ROM approach and previous works. The high fidelity solutions for the construction of the reduced basis are obtained by direct numerical\nsimulations of the QGE with an efficient Finite Volume method [13, 12]. Other authors have chosen Finite Element methods [27, 26] or Finite Difference methods [31, 19]. We consider the formulation of the QGE in terms of potential vorticity, instead of standard vorticity as in all previous work. This choice is justified by the fact that the potential vorticity satisfies a conservation equation which can be exactly enforced by our Finite Volume method at the discrete level. In addition, we consider different coefficients for the ROM approximation of the potential vorticity and stream function. This leads to two important consequences. First, the stream function basis functions do not depend on the particular vorticity basis functions. Instead, they are computed directly from the stream function high-fidelity solutions. Second, the reduced spaces for the stream function and vorticity can have different dimensions.\nFor the assesement of the proposed ROM approach, we consider the classical double-gyre wind forcing benchmark [13, 14, 15, 16, 21, 22]. We present numerical results for two cases with the same Munk scale: i) Rossby number Ro = 0.0036, Reynolds number Re = 450 and ii) Rossby number Ro = 0.008, Reynolds number Re = 1000. The higher Re in the second case makes the computation of the high-fidelity solutions more challenging, while the smaller Ro of the first case introduces difficulties at the ROM level as we will show in Sec. 5.\nThe rest of the paper is organized as follows. In Sec. 3, we introduce the QGE and discuss their time and space discretization. Sec. 4 presents the POD-based ROM and the new closure based on the linear BV-\u03b1 model. Numerical results are reported in Sec. 5. Conclusions are drawn in Sec. 6, where we also presents some future perspectives."
        },
        {
            "heading": "2. Mathematical Models",
            "text": "In order to state the quasi-geostrophic equations, let \u2126 be a fixed two-dimensional spatial domain and (t0, T ) a time interval of interest. Let \u03c9 be the standard vorticity (i.e., the curl of the velocity field) and q = Ro \u03c9 + y the potential vorticity, where y is the non-dimensional vertical coordinate. In addition, we denote with \u03c8 the stream function and set \u03c8 = (0, 0, \u03c8). Then, the QGE in nondimensional variables read: find \u03c8 and q such that\n\u2202q \u2202t +\u2207 \u00b7 ((\u2207\u00d7\u03c8) q)\u2212 1 Re \u2206q = F in \u2126\u00d7 (t0, T ),(1) \u2212Ro\u2206\u03c8 + y = q in \u2126\u00d7 (t0, T ),(2)\nwhere Re is the Reynolds number, and F denotes an external forcing. In the rest of the paper, we will focus on external forces that depend exclusively on space.\nProblem (1)-(2) needs to be supplemented with proper boundary and initial conditions. We impose\n\u03c8 = 0 on \u2202\u2126\u00d7 (t0, T ),(3) q = y on \u2202\u2126\u00d7 (t0, T ),(4)\nq(x, y, t0) = q0 = y in \u2126,(5)\nwhich are a rather standard choice [31, 19, 27, 26, 39, 13]. Notice that (3)-(5) are equivalent to \u03c8 = \u03c9 = 0 on \u2202\u2126 and \u03c9(x, y, t0) = 0 in \u2126.\nThe Direct Numerical Simulation (DNS) of the QGE requires a mesh with mesh size h smaller than the Munk scale:\n\u03b4M = L 3\n\u221a Ro\nRe ,(6)\nwhere L is a characteristic length. When a mesh with h < \u03b4M cannot be afforded because the associated computational cost would be prohibitive or simply too high, one needs to find a way to model the effects of the scales lost to mesh under-refinement. A possible way to do that is to couple the QGE with a differential filter. The resulting model, called BV-\u03b1 [31, 19, 27, 26], reads: find \u03c8,\nq, and q such that\n\u2202q \u2202t +\u2207 \u00b7 ((\u2207\u00d7\u03c8) q)\u2212 1 Re \u2206q = F in \u2126\u00d7 (t0, T ),(7) \u2212\u03b12\u2206q + q = q in \u2126\u00d7 (t0, T ),(8) \u2212Ro\u2206\u03c8 + y = q in \u2126\u00d7 (t0, T ),(9)\nwhere q is the filtered vorticity and \u03b1 can be interpreted as a filtering radius (i.e., the radius of the neighborhood where the filter extracts information from the resolved scales). The differential filter leverages an elliptic operator that acts as a spatial filter by damping the spurious and nonphysical oscillations exhibited by the numerical solution on coarse meshes. The price that one has to pay to obtain a physical solution on a coarse grid is the addition of one equation, i.e., eq. (8).\nWe supplement problem (7)-(9) with initial data (5) and boundary conditions boundary conditions (3)-(4) plus the additional boundary condition\nq = y on \u2202\u2126\u00d7 (t0, T ).(10)\nWhile model (7)-(9) represents certainly an improvement over model (1)-(2) when coarse meshes are used, its effectivity remains limited for severely under-refined meshes. A better alternative is the nonlinear BV-\u03b1 model introduced in [13]. However, we do not consider the nonlinear BV-\u03b1 model in this manuscript since nonlinearities pose extra challanges at the ROM level."
        },
        {
            "heading": "3. The Full Order Method",
            "text": "Although we will use both the QGE (1)-(2) and the BV-\u03b1 model (7)-(9) to devise the ROMs, at the FOM level we consider only the QGE, i.e., our full order model is given by eqs. (1)-(2) endowed with boundary conditions (3)-(4) and initial data (5). This section is devoted to the time and space discretization of our full order model.\nLet us start with the time discretization of eq. (1)-(2). Let \u2206t \u2208 R, tn = t0 + n\u2206t, with n = 0, ..., NT and T = t0 + NT\u2206t. We denote by f\nn the approximation of a generic quantity f at the time tn. Problem (1)-(2) discretized in time by a Backward Differentiation Formula of order 1 (BDF1) reads: given q0 = q0, for n \u2265 0 find the solution (\u03c8n+1, qn+1) to\n1\n\u2206t qn+1 +\u2207 \u00b7\n(( \u2207\u00d7\u03c8n+1 ) qn+1 ) \u2212 1 Re \u2206qn+1 = bn+1,(11) \u2212Ro\u2207\u03c8n+1 + y = qn+1,(12)\nwhere bn+1 = F + qn/\u2206t. In order to contain the computational cost required to approximate the solution to problem (11)- (12), we opt for a segregated algorithm. Given the potential vorticity qn, at tn+1 such algorithm requires to:\ni) Find the potential vorticity qn+1 such that\n1\n\u2206t qn+1 +\u2207 \u00b7\n( (\u2207\u00d7\u03c8n) qn+1 ) \u2212 1 Re \u2206qn+1 = bn+1,(13)\nwhere \u03c8n+1 in (11) is replaced by a linear extrapolation, i.e. \u03c8n. ii) Find the stream function \u03c8n+1 such that\n\u2212Ro\u2207\u03c8n+1 + y = qn+1.(14)\nRemark 3.1. The results in Sec. 5 have been obtained with the BDF1 scheme. For this reason, the algorithm is presented with this choice of temporal discretization. Other schemes are possible. For example, in [13] we reported results given by the BDF2 scheme as well. Therein, we noticed that while BDF1 smooths certain magnitude peaks, the results for BDF1 and BDF2 agree in terms of pattern formation, average kinetic energy, and amplitude of kinetic energy oscillations.\nFor the space discretization of problem (13)-(14), we adopt a Finite Volume (FV) approximation that is derived directly from the integral form of the governing equations. For this purpose, we partition the computational domain \u2126 into cells or control volumes \u2126i, with i = 1, . . . , Nc, where Nc is the total number of cells in the mesh. Let Aj be the surface vector of each face of the control volume, with j = 1, . . . ,M . Then, the discretized form of eq. (13), divided by the control volume \u2126i, can be written as:\n1\n\u2206t qn+1i + \u2211 j \u03d5nj q n+1 i,j \u2212 1 Re \u2211 j (\u2207qn+1i )j \u00b7Aj = b n+1 i , \u03d5 n j = ( \u2207\u00d7\u03c8nj ) \u00b7Aj ,(15)\nwhere qn+1i and b n+1 i are the average potential vorticity and source term in control volume \u2126i and qn+1i,j the potential vorticity associated to the centroid of face j normalized by the volume of \u2126i. The discretized form of eq. (14) divided by the control volume \u2126i reads:\n\u2212Ro \u2211 j ( \u2207\u03c8n+1i ) j \u00b7Aj + yi = qn+1i ,(16)\nwith \u03c8n+1i denoting the average stream function in control volume \u2126i and yi is the vertical coordinate of the centriod. For further details, we refer the reader to [13, 12].\nFor the implementation of the numerical scheme described in this section, we chose the finite volume C++ library OpenFOAM\u00ae [50]."
        },
        {
            "heading": "4. The Reduced Order Models",
            "text": "We assume that any solution to problem (1)-(2) can be approximated as a linear combination of a \u201csmall\u201d number of global basis functions dependent on space variables only, multiplied by scalar coefficients that depend on time and/or other parameters, which can be physical or geometrical. As mentioned in Sec. 1, in this paper we are interested in the time reconstruction of the flow field with no other parameter. Hence, the solution (q, \u03c8) to eq. (1)-(2) is approximated by the reduced solution (qr, \u03c8r), with\nqr = Nrq\u2211 i=1 \u03b2i(t)\u03d5i(x), \u03c8r = Nr\u03c8\u2211 i=1 \u03b3i(t)\u03bei(x).(17) In (17), Nr\u03a6 denotes the cardinality of a reduced basis for the space field \u03a6 = {q, \u03c8}. We remark that we consider different coefficients for the approximation of the potential vorticity q and stream function \u03c8 fields. This is unlike the previous works where the same coefficients are used for both variables, i.e., \u03b2i(t) = \u03b3i(t). If one uses the BV-\u03b1 model (7)-(9), the solution (q, \u03c8, q) is approximated by the reduced solution (qr, \u03c8r, qr) with (qr, \u03c8r) as in (17) and\nqr = Nrq\u2211 i=1 \u03b2i(t)\u03d5i(x).(18)\nExtending our methodology to include phyisical parameters (e.g., the Reynolds number) is rather straightforward as such parameters can be handled in the same way we handle time. On the other hand, geometrical parameters require a different treatment [37, 2, 36].\n4.1. The POD algorithm. There exist several techniques in the literature to generate the reduced basis spaces. Some examples are Proper Orthogonal Decomposition (POD), the Proper Generalized Decomposition, and the Reduced Basis with a greedy sampling strategy. See, e.g., [2, 4, 5, 8, 21, 32, 36]. We generate the reduced basis spaces with the method of snapshots, briefly described hereafter.\nLet (qh, \u03c8h) be the solution computed with the FOM described in Sec. 3. Eq. (15)-(16) get solved at every time step, however not all solutions are retained as snapshots. Indeed, only the solutions at time instant tj \u2208 {t1, . . . , tNt} \u2282 (t0, T ], with NT a multiple of Nt, are stored into the snapshot matrices: S\u03a6 = [\u03a6(t1), . . . ,\u03a6(tNt)] \u2208 RN h \u03a6\u00d7Nt for \u03a6 = {qh, \u03c8h},(19)\nwhere Nh\u03a6 is the dimension of the full-order space \u03a6 belong to. The POD problem consists in finding, for each value of the dimension of the POD space NPOD = 1, . . . , Nt, the scalar coefficients a11, . . . , a Nt 1 , . . . , a 1 Nt , . . . , aNtNt and functions \u03b61, . . . , \u03b6Nt that minimize the error between the snapshots and their projection onto the POD basis. In the L2-norm, such problem reads\narg min Nt\u2211 i=1 \u2225\u2225\u2225\u2225\u2225\u03a6i \u2212 NPOD\u2211 k=1 aki \u03b6k \u2225\u2225\u2225\u2225\u2225 \u2200NPOD = 1, . . . , Nt with (\u03b6i, \u03b6j)L2(\u2126) = \u03b4i,j \u2200i, j = 1, . . . , Nt.(20)\nIt can be shown [24] that problem (20) is equivalent to the following eigenvalue problem\nC\u03a6Q\u03a6 = Q\u03a6\u039b\u03a6,(21) C\u03a6ij = (\u03a6i,\u03a6j)L2(\u2126) for i, j = 1, . . . , Nt,(22)\nwhere C\u03a6 is the correlation matrix computed from the snapshot matrix S\u03a6, Q\u03a6 is the matrix of eigenvectors and \u039b\u03a6 is a diagonal matrix whose diagonal entries are the eigenvalues of C\u03a6. Then, the basis functions are obtained as follows:\n\u03b6i = 1\nNt\u039b\u03a6i Nt\u2211 j=1 \u03a6jQ \u03a6 ij .(23)\nThe resulting POD modes are:\nL\u03a6 = [\u03b61, . . . , \u03b6Nr\u03a6 ] \u2208 R Nh\u03a6\u00d7N r \u03a6 .(24) The values of Nr\u03a6 < Nt are chosen according to reach a user-provided threshold \u03b5\u03a6 for the cumulative energy of the eigenvalues associated to field \u03a6:\n(25)\n\u2211Nr\u03a6 i=1 \u039b\n\u03a6 i\u2211Nt\ni=1 \u039b \u03a6 i\n\u2265 \u03b5\u03a6.\nIn the following, we will consider two approaches for the reduced order model, which share the same offline stage (i.e., collection of snapshots from the QGE with the method described in Sec. 3 and POD procedure described above) but they differ at the online stage. We call these approaches\n(1) QGE-QGE ROM: the system to be solved online results from Galerkin projection of the QGE on the reduced (POD) space; (2) QGE-BV-\u03b1 ROM: Galerkin projection of the BV-\u03b1 model on the POD space provides the system that has to be solved online.\nThe QGE-BV-\u03b1 ROM is the regularized ROM we introduce in this paper and the QGE-QGE ROM is its non-regularized counterpart.\n4.2. QGE-QGE ROM. By projecting the QGE onto the reduced space, we obtain the following system: find (\u03c8n+1r , q\nn+1 r ) that solves(\n1\n\u2206t qn+1r +\u2207 \u00b7\n( (\u2207\u00d7\u03c8nr ) qn+1r ) \u2212 1 Re \u2206qn+1r \u2212 bn+1r , \u03d5i ) L2(\u2126)\n= 0, i = 1, . . . , Nrq ,(26) ( \u2212Ro\u2206\u03c8n+1r + y \u2212 qn+1r , \u03bei ) L2(\u2126) = 0, i = 1, . . . , Nr\u03c8,(27)\nwhere bn+1r = Fr + q n r /\u2206t and \u03d5i and \u03bei are the basis functions in (17). During the online phase of the QGE-QGE ROM, at time tn+1 system (26)-(27) has to be solved. In order to write the algebraic system associated with the reduced problem (26)-(27), we introduce the following matrices:\nMrij = (\u03d5i, \u03d5j)L2(\u2126), M\u0303rij = (\u03bei, \u03d5j)L2(\u2126), Arij = (\u03d5i,\u2206\u03d5j)L2(\u2126),(28) Brij = (\u03bei,\u2206\u03bej)L2(\u2126), Grijk = (\u03d5i,\u2207 \u00b7 ((\u2207\u00d7 \u03bej)\u03d5k))L2(\u2126), Yrij = (\u03d5i, yj)L2(\u2126).(29)\nThen, the matrix form of eq. (26)-(27) reads: given \u03b2n and \u03b3n find vectors \u03b2n+1 and \u03b3n+1, i.e., the vectors whose entries are the values of coefficients \u03b2i and \u03b3i in (17) at time t n+1, such that\nM r\n( \u03b2n+1 \u2212 \u03b2n\n\u2206t\n) + (\u03b3n) T Gr\u03b2\nn+1 \u2212 1 Re Ar\u03b2 n+1 = h,(30)\n\u2212RoBr\u03b3n+1 + Y r \u2212 M\u0303 r\u03b2n+1 = 0,(31)\nwhere the entries of vector h are hi = (\u03d5i, F )L2(\u2126). For clarity, Algorithm 1 presents the pseudocode for QGE-QGE ROM. Lines 2-6 describe the offline stage, while lines 7-9 are perfomed online.\nAlgorithm 1 Pseudocode for QGE-QGE ROM\n1: q0, NT . Inputs needed 2: for n \u2208 {0, . . . , NT \u2212 1} do . Time loop 3: Solve system (15)-(16) . QGE simulation 4: end for 5: {qi}Nti=1 \u2286 {qk} NT k=1 {\u03c8i} Nt i=1 \u2286 {\u03c8k} NT k=1 . Snapshot collection 6: Qr .= POD({qi}Nti=1) \u03a8r . = POD({\u03c8i}Nti=1) . POD for vorticity and stream function spaces 7: for n \u2208 {0, . . . , NT \u2212 1} do . Time loop 8: Solve system (30)-(31) . Standard Galerkin projection 9: end for\n4.3. QGE-BV-\u03b1 ROM. Galerkin projection of the BV-\u03b1 model onto the reduced space gives us the following system: find (\u03c8n+1r , q n+1 r , q\nn+1 r ) that solves(\n1\n\u2206t qn+1r +\u2207 \u00b7\n( (\u2207\u00d7\u03c8nr ) qn+1r ) \u2212 1 Re \u2206qn+1r \u2212 bn+1r , \u03d5i ) L2(\u2126)\n= 0, i = 1, . . . , Nrq ,(32) ( \u2212\u03b12\u2206qn+1r + qn+1r \u2212 qn+1r , \u03d5i ) L2(\u2126)\n= 0, i = 1, . . . , Nrq ,(33) ( \u2212Ro\u2206\u03c8n+1r + y \u2212 qn+1r , \u03bei ) L2(\u2126) = 0, i = 1, . . . , Nr\u03c8.(34)\nUsing the matrices defined in (28)-(29), we can write the matrix of problem (32)-(34) as follows: given \u03b2n and \u03b3n find vectors \u03b2n+1 and \u03b3n+1 such that\nM r\n( \u03b2n+1 \u2212 \u03b2n\n\u2206t\n) + (\u03b3n) T Gr\u03b2\nn+1 \u2212 1 Re Ar\u03b2 n+1 = h,(35)\n\u2212\u03b12Ar\u03b2 n+1 +M r ( \u03b2 n+1 \u2212 \u03b2n+1 ) = 0(36)\n\u2212RoBr\u03b3n+1 + Y r \u2212 M\u0303 r\u03b2 n+1 = 0,(37)\nwhere vector h is the same introduced in Sec. 4.2. Algorithm 2 presents the pseudocode for QGE-BV-\u03b1 ROM. Notice that the lines 2-6 (offline phase) are the same as in Algorithm 1, while lines 7-9 (online phase) are different. The QGE-BV-\u03b1 ROM uses the differential filter at reduced order level as an eddy viscosity closure approach to stabilize the resulting surrogate model. The underlying analogy is the relationship between LES and truncated modal projection [49]. While filter regularization for ROMs has been studied for toy models like Burger\u2019s equation [20] and more complex models like the incompressible Navier-Stokes equations [51, 53, 18, 17, 10, 11, 44], to the best of our knowledge it is the first time that it is proposed for the QGE equations.\nThe major difference when the BV-\u03b1 model is used for regularization vs when it is used as FOM is setting of \u03b1. For the BV-\u03b1 model as FOM one takes \u03b1 \u223c h [31, 19, 27, 26], while the optimal value of \u03b1 for regularization is determined by requiring that the FOM solution and regularized ROM solution are as close as possible in average [51]. See Remark 5.1.\nAlgorithm 2 Pseudocode for QGE-BV-\u03b1 ROM\n1: q0, NT . Inputs needed 2: for n \u2208 {0, . . . , NT \u2212 1} do . Time loop 3: Solve system (15)-(16) . QGE simulation 4: end for 5: {qi}Nti=1 \u2286 {qk} NT k=1 {\u03c8i} Nt i=1 \u2286 {\u03c8k} NT k=1 . Snapshot collection 6: Qr .= POD({qi}Nti=1) \u03a8r . = POD({\u03c8i}Nti=1) . POD for vorticity and stream function spaces 7: for n \u2208 {0, . . . , NT \u2212 1} do . Time loop 8: Solve system (35)-(37) . BV-\u03b1 at the reduced level 9: end for\n4.4. Treatment of the Dirichlet boundary conditions. In order to homogeneize the snapshots for q and thus make them independent of the boundary conditions, we use a classical approach called lifting function method [43, 11]. The idea is to modify the vorticity snapshots as follows: instead of taking the computed qh snapshots, one takes q\u2032h = qh \u2212 q\u0303h(38)\nwhere q\u0303h is the time average of the qh snapshots, called lifting function. The POD is applied to the q\u2032h snapshots, i.e., the vorticity snapshots satisfying the homogeneous boundary conditions. Then, the lifting function is added back to the reduced vorticity qr and reduced filtered vorticity qr:\nqr = q\u0303h + Nrq\u2211 i=1 \u03b2i(t)\u03d5i(x), qr = q\u0303h + Nrq\u2211 i=1 \u03b2i(t)\u03d5i(x)."
        },
        {
            "heading": "5. Numerical results",
            "text": "In order to assess and compare the QGE-QGE and QGE-BV-\u03b1 ROMs, we consider the wellknown double-gyre wind forcing benchmark, which has been widely studied both at full and reduced order level [31, 19, 16, 40, 27, 26]. The computational domain is the [0, 1]\u00d7 [\u22121, 1] rectangle and the forcing term is set to F = sin(\u03c0y). The time interval of interest is [t0, T ] = [10, 80]. We will focus on two test cases that have the same Munk scale (6):\n- Case 1: Ro = 0.0036 and Re = 450; - Case 2: Ro = 0.008 and Re = 1000.\nWhile Case 1 has been used to test several ROM closure models [34, 35, 33, 29, 30, 28, 52, 49], to the best of our knowledge it is the first time that a larger value of Re as in Case 2 is considered for the same purpose. The interest in Case 2 lies in understanding the performance of our ROM approaches when the same Munk scale stays the same (i.e., same Ro to Re ratio) but the Kolmogorov scale [23, 22] decreases (i.e., smaller Re). For a study of Case 2 at the full order level, see [13].\nThe quantities of interest that we will use to test the performance of the ROM approaches are the kinetic energy of the system E:\n(39) E = 1\n2 \u222b \u2126 (( \u2202\u03c8 \u2202y )2 + ( \u2202\u03c8 \u2202x )2) d\u2126\nand the relative L2-norm error \u03b5:\n(40) \u03b5 = ||\u03c8\u0303FOM \u2212 \u03c8\u0303ROM ||L2(\u2126) ||\u03c8\u0303FOM ||L2(\u2126)\nof the time-averaged stream function \u03c8\u0303, which is defined as:\n(41) \u03c8\u0303 = 1\nT \u2212 t0 \u222b T t0 \u03c8dt.\nWe focus on the stream function, and not on vorticity, because it is \u03c8\u0303 that displays the well-known four gyre structure that is hard to capture when the numerical method is not accurate. For a study of the potential vorticity in this benchmark, we refer to [13].\nRemark 5.1. As mentioned in Sec. 4.3, the optimal value of \u03b1 varies whether the BV-\u03b1 model is used as FOM or ROM. We set \u03b1 for the QGE-BV-\u03b1 ROM by trial and error, i.e., we try several values and choose the one that minimizes error \u03b5 defined in (40). Although computationally cheap, this procedure, which also used in [51] for incompressible flow problems, could be improved by, e.g., a heuristic criterion.\nFollowing [29, 41, 30, 40], we collect 700 FOM snapshots, i.e., one every 0.1 time unit, for the training of the ROM in both cases. The FOM snapshots are computed using structured, orthogonal meshes with a level of refinement that will be specified for each case.\n5.1. Results for Case 1. For a rigorous DNS, one should use a mesh size h < \u03b4M = 0.02. Indeed, in [40] the finite element solutions are computed with a 256 \u00d7 512 mesh, which satisfies the condition on the mesh size. In [13], we successfully reproduced the results from [40] using the same mesh and a FV approach. In addition, we showed that our FV approach provides accurate approximated solutions of the QGE model with a 16 \u00d7 32 mesh, although it does not satisfy the condition on h. We speculate that the reason why we obtain accurate solutions on meshes coarser than necessary is the exact conservation yielded by FV methods at the discrete level. Thus, in order to reduce the offline cost without sacrificing accuracy we collect the FOM snapshots with the 16 \u00d7 32 mesh. We set \u2206t = 1e\u2212 4.\nWe start by displaying the eigenvalue decay for stream function and the potential vorticity in Figure 1. Notice how much slower such decay is for q than for \u03c8. This difference in the rapidity of the eigenvalue decay for the two variables makes this problem challenging for ROMs. Indeed, with Nr\u03c8 = 10 (i.e., 10 modes for \u03c8) one captures 98% of the eigenvalue energy (25), while with Nrq = 30 (i.e., 30 modes for q) one retains only 70% of energy (25). This is in line with [30], which reports that 30 modes for \u03c9 (standard vorticity, instead of potential vorticity) are needed to capture 78% of the eigenvalue energy. Comparison with the number of modes taken in other works, e.g. [34, 35, 33, 29, 28], is hindered not only because we state the problem in q rather than \u03c9, but also because we use stream function basis functions that are independent from the vorticity basis functions. Typically, one retains 99.99% of the eigenvalue energy for each variable. For this problem, that would mean Nr\u03c8 = 200 and N r q = 502, which are too large to lead to any meaningful reduction of the computational time. Thus, we will work with smaller values of Nr\u03c8 and N r q , as done in all previous works.\nFor illustration purposes, Figure 2 shows some selected POD basis functions for \u03c8. As expected, the scale of spatial structures becomes smaller and smaller as the basis function index increases. This is due to the fact that the POD modes are arranged in order of descending energy content.\nNext, we set the energy threshold for the selection of the stream function eigenvalues to 98%, which results in 10 modes (i.e., Nr\u03c8 = 10), and let N r q vary. In particular, we consider three values of Nrq that lead to under-resolution at the reduced order level: N r q = 10, 20, 30 that are needed to retain only 54%, 65% and 70% of the eigenvalue energy, respectively. Figure 3 compares the time evolution of the kinetic energy E (5) computed by the FOM and our two ROM approaches for the three values of Nrq . We observe that the kinetic energy computed by QGE-QGE ROM with N r q = 10 is much higher than the FOM kinetic energy over the entire time interval of interest. Since with Nrq = 10 we only capture 54% of the eigenvalue energy associated to q, such mismatch is to be expected. However, if we switch to the QGE-BV-\u03b1 ROM with the same Nrq , we obtain an average kinetic energy that compares well with average computed by the FOM. By increasing Nrq to 20 or 30, both the QGE-QGE ROM and the QGE-BV-\u03b1 ROM provide a good prediction of the average kinetic energy.\nFor further comparison, Figure 4 reports the time-averaged stream function (41) computed by the FOM and QGE-QGE and QGE-BV-\u03b1 ROMs for the same values of Nrq as in Fig. 3. As expected from Fig. 3 (top-left panel), \u03c8\u0303 computed by the QGE-QGE ROM with Nrq = 10 is highly inaccurate. See the second panel in the top row of Fig. 4, which shows only two gyres instead of four. However, even when the Nrq is increased to 20 and 30 the QGE-QGE ROM fails to reproduce the four-gyre pattern despite the fact that the average kinetic energy is well captured. It is interesting to note that these reduced order solution computed with Nrq = 10, 20, 30 look very similar to full order solutions computed with the QGE model on a severely under-refined mesh. See Fig. 1 in [13], which were obtained with a 4 \u00d7 8 mesh. This is evidence of the analogy between an under-resolved ROM and an under-resolved FOM. The second panel on the bottom row of Fig. 4 shows that the QGE-BV-\u03b1 ROM is able to recover the four-gyre pattern already with Nrq = 10, although obviously the solution is not accurate. As Nrq is increased, QGE-BV-\u03b1 ROM provides solutions that get closer and closer to the FOM solution. Even with Nrq = 30 though, the magnitude of \u03c8\u0303 computed by the QGE-BV-\u03b1 ROM is smaller than it should be. See the last panel on the bottom row of Fig. 4. We suspect that this is due to the use of a linear filter. In fact, when a linear filter is adopted at the full order level, the solutions are characterized by over-diffusion since the filter is not selective. It is reasonable to expect a similar behavior when a linear filter is used at the reduced order level.\nTo make the comparison between QGE-QGE and QGE-BV-\u03b1 ROMs more quantitative, we report in Table 1 the L2 errors (40). We see for any value of Nrq the L 2 error obtained with the QGE-BV-\u03b1 ROM is smaller than the L2-norm error obtained with the QGE-BV-\u03b1 ROM. This is particularly evident when Nrq = 10: the QGE-BV-\u03b1 ROM provides an error about 15 times smaller than the QGE-QGE ROM.\nIf one wanted to retrieve the four-gyre pattern with the QGE-QGE ROM, Nrq has to be increased to 40, which corresponds to retaining 74% of the eigenvalue energy. See Fig. 5. This is in agreement\nwith [30]. However, despite displaying the correct pattern, the \u03c8\u0303 computed by the QGE-QGE ROM is still far from being accurate.\nFinally, we provide a comment on the efficiency of our ROM approaches. Table 2 reports the CPU time required by the QGE-QGE ROM and the QGE-BV-\u03b1 ROM with Nrq = 10 and N\u03c8 = 10\nand the relative speed-ups with respect to the CPU time a FOM simulation (506 s). We note that by CPU time for the ROMs we mean the total time needed to solve the linear systems that yield the modal coefficients, i.e. the CPU time taken by the online phase only. A first observation on Table 2 is that the higher accuracy of the QGE-BV-\u03b1 ROM comes with an increased of about 50% in computational time with respect to the QGE-QGE ROM. Furthermore, we observe that, despite the overall low accuracy of the ROM solutions for Nrq = 10 and N\u03c8 = 10, the speed-up is not particularly encouraging. If Nrq is increased to 30 to gain accuracy, the speed-up deteriorates further. One reason we have identified for this poor reduction of the computational cost is the choice of a coarse mesh (i.e., 16 \u00d7 32). If we were to use a much finer mesh (e.g., 256 \u00d7 512 as in [13]), we would see more important computational savings. However, that would entail a much more onerous offline phase. Indeed, a FOM simulation with mesh 256 \u00d7 512 takes about 10 hours, leading to relative speed-ups two order of magnitude larger than the ones in Tables 2.\n5.2. Results for Case 2. The obvious effect of dealing with a smaller Kolmogorov scale (i.e., smaller Re) is the need for a finer mesh. Indeed, as shown in [13] a simulation obtained with the QGE model and mesh 16 \u00d7 32 does not provide a physical solution for Case 2. By increasing the\nFOM Nrq = 40\nresolution to 32 \u00d7 64, we do obtain a physical solution in terms of patterns and magnitudes despite the fact that a DNS would require an even finer mesh. Time step is set to \u2206t = 1e\u2212 4, as in Case 1.\nThe eigenvalue decay for the stream function and the potential vorticity for Case 2 is shown in Figure 6. Like for Case 1, the eigenvalue decay is very different for the two variables and it is much slower for q. However, there is one important difference: the eigenvalue decay is slightly faster for both variables in Case 2 than in Case 1. For example, for Nq = 30 we are able to capture 76% of the cumulative eigenvalue energy for q, instead of 70%. As we will see, this leads to better ROM reconstructions. Thus, while Case 2 seems more challenging than Case 1 at the FOM level, it is less so at the ROM level.\nFollowing what we have done for Case 1, we set N\u03c8r = 10 in order to retain 98% of the eigenvalue energy associated with \u03c8 and we let Nqr vary. For Case 2, with N q r = 10, 20, 30 we capture 59%, 71% and 76% of the eigenvalue energy associated with q. So, once again the ROM simulations are rather severely under-resolved. Figure 7 compares the time evoution of the kinetic energy E computed by the FOM and our two ROM approaches for the three values of Nrq . There are substantial differences between Figure 7 and the corresponding figure for Case 1, i.e., Figure 3. First of all, looking at the FOM kinetic energy, we see that for Case 2 it has oscillations with smaller amplitude and higher frequency (as one expects given the higher Re in Case 2), while the average value is comparable in both cases. As for the ROMs, the QGE-QGE ROM with Nqr = 10 performs better in Case 2: while it provides a kinetic energy with larger amplitude and lower frequency than the FOM, the average is comparable to the ROM average. In Case 1 even the average of E was off. On the other hand, the QGE-BV-\u03b1 ROM with Nrq = 10 seems to perform worse in Case 2, with several undershoots of the computed kinetic energy. As Nrq is increased to 20 and 30, the kinetic energies computed by ROMs get closer to the FOM kinetic energy. This improvement is reflected in the computed \u03c8\u0303 shown in Figure 8. Like in Case 1, we can see that the QGE-QGE ROM fails to capture the four-gyre pattern\nfor Nrq = 10, 20. However, when N r q is increased to 30, such pattern starts to emerge. We note that that \u03c8\u0303 computed by the QGE-QGE ROM with Nrq = 30 for Case 2 (last panel in the first row of Figure 8) looks similar to the \u03c8\u0303 computed by the same ROM with Nrq = 40 for Case 1 (second panel in Figure 5) This is not surprising since the retained eigenvalue energy is comparable: 76% for the former vs 74% for the latter. From the panels on the bottom row of Figure 8, we see that the pattern in \u03c8\u0303 given by the QGE-BV-\u03b1 ROM matches the FOM pattern already for Nrq = 20. When Nrq is increased, the QGE-BV-\u03b1 ROM becomes less diffusive and the magnitude of \u03c8\u0303 computed by the ROM gets closer to the magnitude computed by the FOM.\nFor a more quantitative comparison, we report in Table 3 the L2 error (40) for both ROMs with different values of Nrq . Like in Case 1, we see that the errors obtained with the QGE-BV-\u03b1 ROM are smaller in all cases, although the errors of the QGE-QGE ROM and QGE-BV-\u03b1 ROM get closer as Nrq increases. We note that if N r q is set to 40 for the QGE-QGE ROM (corresponding to retaining 80% of the eigenvalue energy), the computed \u03c8\u0303 shown in Figure 9 gets very close to the QGE-BV-\u03b1 solution with Nrq = 30.\nWe conclude this section with a comment on the efficiency of our ROM approaches in the spirit of Table 2. Table 4 reports the CPU time required by the ROMs in Case 2 and the relative speed up with respect to the FOM. First of all, we notice that the CPU times required by the ROMs are very similar for Case 1 and 2, while we observe more important speed-ups for Case 2. This is consistent with our hypothesis at the end of Sec. 5.1, i.e., that the use of a finer mesh would lead to larger computational savings. In fact, we recall that for Case 2 we use mesh 32\u00d764, while for Case 1 we took mesh 16\u00d732. Furthermore, it explains why previous work that used a 256 \u00d7 512 mesh [41] reports a speed-up of the order of 100."
        },
        {
            "heading": "6. Concluding remarks",
            "text": "This paper presents a novel regularization for reduced order models of the quasi-geostrophic equations when the POD modes retained to construct the reduced basis are insufficient to describe the system dynamics. The proposed regularization draws inspiration from the linear BV-\u03b1 model, which has been used only as a replacement of the QGE at the full order level so far. For the collection of the snapshots, we apply a Finite Volume method, which has the advantage of preserving conservation of conserved quantities at the discrete level. The particular ROM approach that we combined with the new regularization is of the POD-Galerkin type. To show the effectiveness of the BV-\u03b1 closure model, we compare the results computed by the ROM with and without regularization for the classical double-gyre wind forcing benchmark. We consider two cases with the same Munk scale, one with small Rossby number and the other with high Reynolds number.\nOur numerical results show that for both cases the solution computed by the regularized ROM is more accurate, even when the retained POD modes account for a small percentage of the cumulative eigenvalue energy (i.e., about 50-60%). The price to pay for this increased accuracy is an increased computational cost: the CPU time of the regularized ROM is about 1.5 times the CPU time required by the non-regularized ROM. Despite this increased computational cost, the regularized ROM is still a competitive alternative to the full order model. In fact, its cost is about 1/3 (for the small Ro case) to 1/6 (for the high Re case) of the cost of the full order model.\nWhile the ROM regularized by the linear BV-\u03b1 model is accurate in the reconstruction of the solution patterns, the positive and negative peaks in the magnitude get smoothed out. This is expected since linear filters are known to be dissipative. At the full order level, we have shown the a nonlinear version of the BV-\u03b1 model introduces much less artificial dissipation [13]. Hence, a natural extension of the work presented in this paper is a regularization inspired by this nonlinear BV-\u03b1 model."
        },
        {
            "heading": "Acknowledgements",
            "text": "We acknowledge the support provided by the European Research Council Executive Agency by the Consolidator Grant project AROMA-CFD \u201cAdvanced Reduced Order Methods with Applications in Computational Fluid Dynamics\u201d - GA 681447, H2020-ERC CoG 2015 AROMA-CFD, PI G. Rozza, ARIA H2020-MSCA-RISE-2019 project, PON \u201cResearch and Innovation on Green related issues\u201d FSE REACT-EU 2021 project, PRIN NA FROM-PDEs project and INdAM-GNCS 2019- 2021 projects. This work was also partially supported by US National Science Foundation through grant DMS-1953535 (PI A. Quaini). A. Quaini also acknowledges support from the Radcliffe Institute for Advanced Study at Harvard University where she has been a 2021-2022 William and Flora Hewlett Foundation Fellow."
        }
    ],
    "title": "A LINEAR FILTER REGULARIZATION FOR POD-BASED REDUCED ORDER MODELS OF THE QUASI-GEOSTROPHIC EQUATIONS",
    "year": 2022
}