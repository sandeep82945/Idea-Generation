{
    "abstractText": "Photovoltaic (PV) cell-level inverters have recently gained popularity, as they provide individual maximum power point tracking and energy management, minimizing so the mismatch losses, caused by partial-shading, degradation effects and cell manufacturing variations in solar modules and arrays. In this article, a fully decentralized control scheme, applicable to PV cell-level inverters in cascaded H-bridge (CHB) configuration is presented. A feasibility study is carried out, considering individual PV cell inverter controllers, eliminating the need for data exchange among them, or with the central higher-level controller. At first, the overall concept of the control scheme in grid-tied operation is presented, highlighting the control, synchronization and cell-adjustment challenges. Two alternative controller configurations are presented and analyzed. The first one is based on the well-established sinusoidal pulse width modulation (SPWM) technique, with three different configurations i.e., (a) with active power maximization, (b) with reactive power regulation and (c) with reactive power minimization. The aforementioned schemes are analyzed and compared, highlighting their pros and cons. As for the second configuration, a multilevel-based selfsynchronized/self-adjusted scheme is introduced, which minimizes switching losses and facilitates power line communication; however, power curtailment occurs in each cell. The mathematical analysis for the conduction angle calculation in each cell is presented. Finally, an experimental performance assessment for the aforementioned control strategies is performed (on a 4 cell CHB laboratory scale prototype), highlighting the advantages/disadvantages, as well as the implementation challenges of each one. INDEX TERMS Cascaded H-bridge, grid-tied inverter, multilevel inverter, power converter, power management, photovoltaic (PV) systems.",
    "authors": [
        {
            "affiliations": [],
            "name": "Nick Rigogiannis"
        },
        {
            "affiliations": [],
            "name": "Nick Delianidis"
        },
        {
            "affiliations": [],
            "name": "Ioannis Mandourarakis"
        },
        {
            "affiliations": [],
            "name": "Nick Papanikolaou"
        }
    ],
    "id": "SP:171abf9c8eecbc605d365bb20be2bf06aa538ea6",
    "references": [
        {
            "authors": [
                "N. Rigogiannis",
                "A. Boubaris",
                "Z. Agorastou",
                "N. Papanikolaou",
                "S. Siskos",
                "E. Koutroulis"
            ],
            "title": "Experimental Study of a Low-Voltage PV Cell-Level DC/AC Converter",
            "venue": "2021 10th International Conference on Modern Circuits and Systems Technologies (MOCAST), Thessaloniki, Greece, 2021, pp. 1-5, doi: 10.1109/MOCAST52088.2021.9493346.",
            "year": 2021
        },
        {
            "authors": [
                "N. Rigogiannis"
            ],
            "title": "Incorporation of SmartPV Technology in Zero Energy Building Concept",
            "venue": "2022 22nd International Symposium on Electrical Apparatus and Technologies (SIELA), Bourgas, Bulgaria, 2022, pp. 1-4, doi: 10.1109/SIELA54794.2022.9845757.",
            "year": 2022
        },
        {
            "authors": [
                "N. Delianidis",
                "N. Rigogiannis",
                "N. Papanikolaou",
                "S. Siskos",
                "E. Koutroulis"
            ],
            "title": "Digital Control Implementation for PV Cell-Level Inverters",
            "venue": "2022 11th International Conference on Modern Circuits and Systems Technologies (MOCAST), Bremen, Germany, 2022, pp. 1-4, doi: 10.1109/MOCAST54814.2022.9837576.",
            "year": 2022
        },
        {
            "authors": [
                "A. Boubaris",
                "N. Rigogiannis",
                "Z. Agorastou",
                "N. Papanikolaou",
                "S. Siskos",
                "E. Koutroulis"
            ],
            "title": "Analysis, Design and Simulation of an On- Chip DC/DC/AC Conversion System for PV Applications",
            "venue": "2019 Panhellenic Conference on Electronics & Telecommunications (PACET), Volos, Greece, 2019, pp. 1-6, doi: 10.1109/PACET48583.2019.8956293.",
            "year": 2019
        },
        {
            "authors": [
                "Z. Agorastou",
                "V. Gogoulou",
                "I. Mandourarakis",
                "N. Rigogiannis",
                "E. Koutroulis",
                "S. Siskos",
                "N. Papanikolaou"
            ],
            "title": "Development of a Smart Photovoltaic Cell",
            "venue": "IEEE International Conference on Industrial Technology (ICIT 2023),",
            "year": 2023
        },
        {
            "authors": [
                "D. Karwatzki",
                "A. Mertens"
            ],
            "title": "Generalized Control Approach for a Class of Modular Multilevel Converter Topologies",
            "venue": "IEEE Transactions on Power Electronics, vol. 33, no. 4, pp. 2888-2900, April 2018, doi: 10.1109/TPEL.2017.2703917.",
            "year": 2018
        },
        {
            "authors": [
                "L.G. Franquelo",
                "J. Rodriguez",
                "J.I. Leon",
                "S. Kouro",
                "R. Portillo",
                "M.A.M. Prats"
            ],
            "title": "The age of multilevel converters arrives",
            "venue": "IEEE Industrial Electronics Magazine, vol. 2, no. 2, pp. 28-39, June 2008, doi: 10.1109/MIE.2008.923519.",
            "year": 2008
        },
        {
            "authors": [
                "X. Hou",
                "Y. Sun",
                "H. Han",
                "Z. Liu",
                "W. Yuan",
                "M. Su"
            ],
            "title": "A fully decentralized control of grid-connected cascaded inverters",
            "venue": "IEEE Transactions on Sustainable Energy, vol. 10, no. 1, pp. 315-317, Jan. 2019, doi: 10.1109/TPWRD.2018.2816813.",
            "year": 2019
        },
        {
            "authors": [
                "Y. Yu",
                "G. Konstantinou",
                "B. Hredzak",
                "V.G. Agelidis"
            ],
            "title": "Power Balance of Cascaded H-Bridge Multilevel Converters for Large-Scale Photovoltaic Integration",
            "venue": "IEEE Transactions on Power Electronics, vol. 31, no. 1, pp. 292-303, Jan. 2016, doi: 10.1109/TPEL.2015.2406315.",
            "year": 2016
        },
        {
            "authors": [
                "I. Sarkar",
                "B.G. Fernandes"
            ],
            "title": "A Hybrid Symmetric Cascaded H- Bridge Multilevel Converter Topology",
            "venue": "IEEE Journal of Emerging and Selected Topics in Power Electronics, doi: 10.1109/JESTPE.2021.3104222.",
            "year": 2021
        },
        {
            "authors": [
                "E. Babaei",
                "S. Laali",
                "S. Alilu"
            ],
            "title": "Cascaded Multilevel Inverter With Series Connection of Novel H-Bridge Basic Units",
            "venue": "IEEE Transactions on Industrial Electronics, vol. 61, no. 12, pp. 6664-6671, Dec. 2014, doi: 10.1109/TIE.2014.2316264.",
            "year": 2014
        },
        {
            "authors": [
                "D. Iannuzzi",
                "M. Coppola",
                "P. Guerriero",
                "A. Dannier",
                "A.D. Pizzo"
            ],
            "title": "Power Scheduling Method for Grid Integration of a PV-BESS CHB Inverter With SOC Balancing Capability",
            "venue": "IEEE Access, vol. 10, pp. 112273-112285, 2022, doi: 10.1109/ACCESS.2022.3215270.",
            "year": 2022
        },
        {
            "authors": [
                "P. Liu",
                "S. Duan"
            ],
            "title": "Derivation of the Generalized Phase-Shifted Angles by Using Phasor Diagrams for the CHB Converter With Unbalanced DC Voltage Sources",
            "venue": "IEEE Transactions on Industrial Electronics, vol. 68, no. 12, pp. 12002-12009, Dec. 2021, doi: 10.1109/TIE.2020.3040674.",
            "year": 2021
        },
        {
            "authors": [
                "S. Rahman",
                "M. Meraj",
                "A. Iqbal",
                "B.P. Reddy",
                "I. Khan"
            ],
            "title": "A Combinational Level-Shifted and Phase-Shifted PWM Technique for Symmetrical Power Distribution in CHB Inverters",
            "venue": "IEEE Journal of Emerging and Selected Topics in Power Electronics, vol. 11, no. 1, pp. 932-941, Feb. 2023, doi: 10.1109/JESTPE.2021.3103610.",
            "year": 2023
        },
        {
            "authors": [
                "S. Maurya",
                "D. Mishra",
                "K. Singh",
                "A.K. Mishra",
                "Y. Pandey"
            ],
            "title": "An Efficient Technique to reduce Total Harmonics Distortion in Cascaded H- Bridge Multilevel Inverter",
            "venue": "2019 IEEE International Conference on Electrical, Computer and Communication Technologies (ICECCT), Coimbatore, India, 2019, pp. 1-5, doi: 10.1109/ICECCT.2019.8869424.",
            "year": 2019
        },
        {
            "authors": [
                "D.M. Scholten",
                "N. Ertugrul",
                "W.L. Soong"
            ],
            "title": "Analysis and control of decentralized PV cascaded multilevel modular integrated converters",
            "venue": "2016 IEEE Energy Conversion Congress and Exposition (ECCE), Milwaukee, WI, USA, 2016, pp. 1-9, doi: 10.1109/ECCE.2016.7854864.",
            "year": 2016
        },
        {
            "authors": [
                "H. Jafarian",
                "N. Kim",
                "B. Parkhideh",
                "J. Enslin"
            ],
            "title": "Analysis of smart inverter functions of decentralized grid-connected AC-stacked PV inverter architecture",
            "venue": "2017 IEEE Applied Power Electronics Conference and Exposition (APEC), Tampa, FL, USA, 2017, pp. 3594-3600, doi: 10.1109/APEC.2017.7931214.",
            "year": 2017
        },
        {
            "authors": [
                "H. Jafarian",
                "N. Kim",
                "B. Parkhideh"
            ],
            "title": "Decentralized Control Strategy for AC-Stacked PV Inverter Architecture Under Grid Background Harmonics",
            "venue": "IEEE Journal of Emerging and Selected Topics in Power Electronics, vol. 6, no. 1, pp. 84-93, March 2018, doi: 10.1109/JESTPE.2017.2773079.",
            "year": 2018
        },
        {
            "authors": [
                "Y. Zheng",
                "Y. Li",
                "S. Sheng",
                "B. Scandrett",
                "B. Lehman"
            ],
            "title": "Distributed control for modular plug-and-play subpanel photovoltaic converter system",
            "venue": "2017 IEEE Applied Power Electronics Conference and Exposition (APEC), Tampa, FL, USA, 2017, pp. 1267-1271, doi: 10.1109/APEC.2017.7930858.",
            "year": 2017
        },
        {
            "authors": [
                "S. Panigrahi",
                "A. Thakur",
                "Devashish",
                "M. Singh"
            ],
            "title": "Performance Evaluation of Solar Energy Conversion System Having Seven-level Cascaded H-bridge Inverter",
            "venue": "2019 IEEE International Conference on Innovations in Communication, Computing and Instrumentation (ICCI), Chennai, India, 2019, pp. 74-79, doi: 10.1109/ICCI46240.2019.9404440.",
            "year": 2019
        },
        {
            "authors": [
                "L. Xiong",
                "Y. Gui",
                "H. Liu",
                "W. Yang",
                "J. Gong"
            ],
            "title": "A hybrid CHB multilevel inverter with supercapacitor energy storage for gridconnected photovoltaic systems",
            "venue": "2018 IEEE Applied Power Electronics Conference and Exposition (APEC), San Antonio, TX, USA, 2018, pp. 3195-3199, doi: 10.1109/APEC.2018.8341559.",
            "year": 2018
        },
        {
            "authors": [
                "L. Zhang",
                "Z. Zhang",
                "J. Qin",
                "D. Shi",
                "Z. Wang"
            ],
            "title": "Design and Performance Evaluation of the Modular Multilevel Converter (MMC)based Grid-tied PV-Battery Conversion System",
            "venue": "2018 IEEE Energy Conversion Congress and Exposition (ECCE), Portland, OR, USA, 2018, pp. 2649-2654, doi: 10.1109/ECCE.2018.8558443.",
            "year": 2018
        },
        {
            "authors": [
                "M. Coppola",
                "P. Guerriero",
                "A. Dannier",
                "S. Daliento",
                "A. Del Pizzo"
            ],
            "title": "Improved Performance of Grid-Tied Photovoltaic Cascaded H- Bridge Inverter with Embedded Storage Units",
            "venue": "2021 IEEE 6th International Forum on Research and Technology for Society and Industry (RTSI), Naples, Italy, 2021, pp. 352-357, doi: 10.1109/RTSI50628.2021.9597300.",
            "year": 2021
        },
        {
            "authors": [
                "S.N. Manias"
            ],
            "title": "6 - Inverters (DC\u2013AC Converters)",
            "venue": "Power Electronics and Motor Drive Systems,",
            "year": 2017
        },
        {
            "authors": [
                "M. Hanhart"
            ],
            "title": "An Integrated 50 V Boost Controller With Digitally-Assisted MPPT for Submodule PV Applications",
            "venue": "IEEE Open Journal of Power Electronics, vol. 4, pp. 221-236, 2023, doi: 10.1109/OJPEL.2023.3250762.",
            "year": 2023
        },
        {
            "authors": [
                "F. Paterakis",
                "C.C. Marouchos",
                "M. Darwish",
                "D. Nafpaktitis"
            ],
            "title": "Comparison of a PWM inverter and a multilevel inverter using the switching function analysis for harmonic content and efficiency",
            "venue": "2017 52nd International Universities Power Engineering Conference (UPEC), Heraklion, Greece, 2017, pp. 1-5, doi: 10.1109/UPEC.2017.8231896.",
            "year": 2017
        },
        {
            "authors": [
                "Jih-Sheng Lai",
                "Fang Zheng Peng"
            ],
            "title": "Multilevel converters-a new breed of power converters",
            "venue": "IEEE Transactions on Industry Applications, vol. 32, no. 3, pp. 509-517, May-June 1996, doi: 10.1109/28.502161.",
            "year": 1996
        },
        {
            "authors": [
                "J. Rodriguez",
                "Jih-Sheng Lai",
                "Fang Zheng Peng"
            ],
            "title": "Multilevel inverters: a survey of topologies, controls, and applications",
            "venue": "IEEE Transactions on Industrial Electronics, vol. 49, no. 4, pp. 724-738, Aug. 2002, doi: 10.1109/TIE.2002.801052.",
            "year": 2002
        },
        {
            "authors": [
                "N. Rigogiannis",
                "A. Kotsidimou",
                "I. Arzanas",
                "C. Kyritsi",
                "N. Papanikolaou"
            ],
            "title": "Comparative Performance Study of Hybrid Si/SiC Insulated-Gate Bipolar Transistors",
            "venue": "2022 IEEE 7th Forum on Research and Technologies for Society and Industry Innovation (RTSI), Paris, France, 2022, pp. 191-197, doi: 10.1109/RTSI55261.2022.9905217.",
            "year": 2022
        },
        {
            "authors": [
                "I. Mandourarakis",
                "E. Koutroulis",
                "G.N. Karystinos"
            ],
            "title": "Power Line Communication Method for the Simultaneous Transmission of Power and Digital Data by Cascaded H-Bridge Converters",
            "venue": "IEEE Transactions on Power Electronics, vol. 37, no. 10, pp. 12793-12804, Oct. 2022, doi: 10.1109/TPEL.2022.3177859.",
            "year": 2022
        },
        {
            "authors": [
                "I. Mandourarakis",
                "E. Koutroulis",
                "G.N. Karystinos"
            ],
            "title": "Control of Cascaded H-bridge Converters for Power Line Communication",
            "venue": "IECON 2022 \u2013 48th Annual Conference of the IEEE Industrial Electronics Society, Brussels, Belgium, 2022, pp. 1-6, doi: 10.1109/IECON49645.2022.9969079.",
            "year": 2022
        },
        {
            "authors": [
                "I. Mandourarakis",
                "Z. Agorastou",
                "E. Koutroulis",
                "G.N. Karystinos",
                "S. Siskos"
            ],
            "title": "On-chip Power Line Communication for Cascaded Hbridge Power Converters",
            "venue": "2022 11th International Conference on Modern Circuits and Systems Technologies (MOCAST), Bremen, Germany, 2022, pp. 1-5, doi: 10.1109/MOCAST54814.2022.9837618.",
            "year": 2022
        },
        {
            "authors": [
                "N. Rigogiannis",
                "D. Voglitsis",
                "N. Papanikolaou"
            ],
            "title": "Microcontroller Based Implementation of Peak Current Control Method in a Bidirectional Buck-Boost DC-DC Converter",
            "venue": "2018 20th International Symposium on Electrical Apparatus and Technologies (SIELA), Bourgas, Bulgaria, 2018, pp. 1-4, doi: 10.1109/SIELA.2018.8447148.",
            "year": 2018
        }
    ],
    "sections": [
        {
            "text": "VOLUME XX, 2017 1\nindividual maximum power point tracking and energy management, minimizing so the mismatch losses, caused by partial-shading, degradation effects and cell manufacturing variations in solar modules and arrays. In this article, a fully decentralized control scheme, applicable to PV cell-level inverters in cascaded H-bridge (CHB) configuration is presented. A feasibility study is carried out, considering individual PV cell inverter controllers, eliminating the need for data exchange among them, or with the central higher-level controller. At first, the overall concept of the control scheme in grid-tied operation is presented, highlighting the control, synchronization and cell-adjustment challenges. Two alternative controller configurations are presented and analyzed. The first one is based on the well-established sinusoidal pulse width modulation (SPWM) technique, with three different configurations i.e., (a) with active power maximization, (b) with reactive power regulation and (c) with reactive power minimization. The aforementioned schemes are analyzed and compared, highlighting their pros and cons. As for the second configuration, a multilevel-based selfsynchronized/self-adjusted scheme is introduced, which minimizes switching losses and facilitates power line communication; however, power curtailment occurs in each cell. The mathematical analysis for the conduction angle calculation in each cell is presented. Finally, an experimental performance assessment for the aforementioned control strategies is performed (on a 4 cell CHB laboratory scale prototype), highlighting the advantages/disadvantages, as well as the implementation challenges of each one.\nINDEX TERMS Cascaded H-bridge, grid-tied inverter, multilevel inverter, power converter, power management, photovoltaic (PV) systems.\nI. INTRODUCTION Solar photovoltaic (PV) energy is dominant in the renewables market, constantly increasing its capacity in both large- and small-scale applications. Nowadays, the direction of increasing the integration level of PV systems, beyond the typical string inverters and microinverters, has set significant attention to the challenging concept of PV cell-level inverters [1], [2]. Such configurations have been recently proposed, where each individual PV cell of a PV module is connected to a DC-AC power converter. Thanks to individual Maximum Power Point Tracking (MPPT) and energy management in cell level, the generated power can be\nincreased, minimizing the negative effects of mismatch losses (e.g., due to partial shading or PV manufacturing variations) and potential induced degradation [2]. Hence, the incorporation of PV systems in emerging smart grid applications, such as in zero energy buildings (e.g., embedded in roofs and/or facades) is facilitated [3]. According to [3], it is estimated that in a zero energy building, individual PV cell MPPT and energy management can lead in a 6.8%\u201329.7% increase of annual energy production, in case of partial shading and/or non-uniform electrical characteristics of individual solar cells, i.e.,\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7\ncorresponding to approximately double energy yield, compared to the microinverter technology.\nIn [2]-[6] a chip implementation of a PV cell-level inverter is proposed and studied. Regarding the power converter configuration, a reconfigurable dual-stage inverter is considered, operating either as a DC-DC or as a DC-AC converter, feeding the PV generated power to an electric load, according to the target application, e.g., batteries, electricity grid etc. For the DC-DC and DC-AC power stages the synchronous boost and the H-bridge topologies are selected in cascaded configuration, with an intermediate DClink. The final architecture comprises multiple cell-level inverters connected electrically in series and parallel, forming strings, modules and arrays. Apparently, in each PV string the cell-level inverters comprise cascaded H-Bridges (CHBs).\nThe aforementioned CHB topology is widely used in PV inverter applications, whereas it is suitable for the abovedescribed application, as it fully exploits the modularity, scalability and redundancy of the cell-level approach [7], [8]. In this work, control and synchronization issues of the CHB configuration in grid-tied operation are studied, with focus on the particular characteristics of the PV cell-level inverter application.\nSeveral works can be found in recent scientific literature that focus on the control and energy management in grid-tied configuration of CHBs [9]-[21], distinguished into centralized and decentralized, in respect to the existence or not of local controllers and their interaction and communication with the higher-level central controller. Typically, according to the aforementioned works [9]-[21], a central controller is utilized, obtaining measurements from the utility grid and distributing signals to each H-bridge in order to synchronize with the utility grid and effectively control active and reactive power flow. In addition, in PV CHB configurations, battery or supercapacitor energy storage is commonly utilized in each H-bridge, to facilitate effective and flexible power control, DC-link voltage stabilization and Maximum Power Point Tracking (MPPT) operation for a wide range of operating conditions [22]-[25]. Finally, regarding the modulation techniques in CHB applications, the most commonly used one is the Sinusoidal Pulse Width Modulation (SPWM) [26], whereas the multilevel technique has been also utilized in CHBs and modular converter topologies [26]; indeed, both methods feature their pros and cons, which have been extensively discussed in scientific literature, e.g., in [8]-[25].\nNevertheless, for the studied PV cell-level inverter application, particular issues and challenges have to be taken into account. The idea of PV cell-level energy management has been developed over the recent years, whereas commercial solutions can be found, e.g., the SPV1020 integrated circuit of STMicroelectronics, implementing various functions, such as cell-level MPPT [27]. However, synchronization with the electricity network and higher-level\ncontrol schemes require a central control unit and measurements of the grid parameters. Under this light, this paper proposes a fully decentralized PV cell-level control, where each individual H-bridge is self-synchronized and self-adjusted, by obtaining local measurements at cell-level. In such a case, the use of a central controller is not considered imperative; although it may be desired for facilitating the overall system operation by remote monitoring and diagnostics services.\nHence, a feasibility study for individual cell inverter controllers is performed, eliminating the need for data exchange among CHBs, or with a central control unit. The challenging issue of self-synchronization is addressed, by individual measurements in each cell-level H-bridge, in order to implement the Phase Locked Loop (PLL) function and obtain the grid phase angle. In parallel, this paper presents two alternative controller configurations. Initially, an SPWM-based controller is presented with three versions, according to the desired control objective, i.e., (a) active power maximization, (b) reactive power regulation and (c) reactive power minimization. The aforementioned schemes are different in respect to the control variable, i.e., SPWM modulation index ma, phase difference \u03b4 or a combination of both of them, whereas they are analyzed and compared, highlighting their pros and cons.\nAs an alternative to the common SPWM-based control strategy, a multilevel-based one is introduced in this paper, in order to treat the inherent issues of SPWM technique, e.g., increased switching losses and complicated design, in case that communication with a central controller or among cells is desired, via Power Line Communication (PLC), due to the implementation difficulties that are raising by the higher harmonic content of the SPWM technique. However, degraded power quality may be obtained in multilevel case, due to curtailment in each cell (i.e., no MPPT mode in each level is feasible), caused by chopping in the conduction angles. The mathematical analysis of the multilevel-based controller configuration is presented, whereas two alternative versions are studied and compared, i.e., active power maximization either via phase difference \u03b4, or conduction angle \u03b8cond,i control; the pros and cons of each variations are indicated, too.\nIn this context, the main contributions of this paper can be\nsummarized as follows:\n\u2022 Control and synchronization challenges and issues for\nthe emerging topic of PV cell-level inverters in CHB configuration are presented and discussed in detail, focusing on a fully decentralized solution.\n\u2022 Three variations of the commonly used SPWM-based\npower control schemes, applicable to CHBs are analyzed and experimentally evaluated, highlighting their particular characteristics.\n\u2022 An SPWM-based reactive power minimization scheme\nis proposed, by simultaneous regulation of the modulation index ma and the phase difference \u03b4, through\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7\na Perturb and Observe (P&O) algorithm.\n\u2022 A decentralized multilevel-based power control and\nsynchronization strategy is introduced, as an alternative to the SPWM-based technique. Its mathematical analysis is performed, whereas its feasibility for a PV cell-level CHB system is experimentally tested and validated.\n\u2022 Significant conclusions for the experimentally assessed\ncontrol methods are obtained, highlighting their feasibility and applicability for the PV cell-level inverter system, according to the user needs and the target application features. The remainder of this paper is organized as follows: in Section II the detailed analysis of the studied SPWM-based and multilevel-based power control schemes is presented, highlighting the advantages and disadvantages of each method, as well as of each controller variation (in respect to the controlled parameter i.e., modulation index ma or phase difference \u03b4). Next, in Section III experimental results and measurements on a laboratory prototype are provided and discussed, validating the functionality and the particular characteristics of each control scheme. Finally, Section IV discusses the main conclusions the paper."
        },
        {
            "heading": "II. ANALYSIS OF THE STUDIED CONTROL SCHEMES",
            "text": "The generalized schematic diagram of grid-tied inverters in CHB configuration is illustrated in Fig. 1. Each PV cell-level inverter comprises a DC-DC conversion (synchronous boost) stage and a DC-AC (H-bridge) stage, as it is presented in [2]-[6].\nFIGURE 1. Generalized schematic diagram of the proposed cascaded H-bridge inverters system.\nIn addition, a filter inductor is connected in each inverter output. Hence, no additional output filter is required for the utility grid interconnection, whereas the individual grid voltage measurement becomes possible. The overall DC-AC conversion system may feed either a local load (standalone operation), or the electricity network (grid-tied operation).\nIn this work, AC grid-tied operation is focused, where each H-bridge must be individually synchronized with the grid voltage. For this reason, the output voltage measurement is implemented in each cell, so as the grid phase angle (\u03b8b) to be extracted, by means of a phase-locked loop (PLL). For the sake of analysis, it is assumed that synchronization with the grid has been established and all cell inverter outputs are equal to the grid voltage, divided by the number of CHBs, N. Given this assumption, the equivalent circuit is depicted in Fig. 2, where the voltage across each inductor is equal to the grid voltage, minus the output voltage of all CHBs, divided by N. This is analyzed, as follows:\nall all\ni\nLg grid inv\nLg\nu u u u\nN N\n\u2212 = = (1)\nall\ni\ninv\ninv\nu u\nN = (2)\nall all\ni i\ngrid inv inv grid\nac Lg inv\nu u u u u u u\nN N N\n\u2212 = + = + = (3)\nwhere uLgi, uinv and ugrid correspond to the voltage across each inductor, the inverter and the grid voltage, whereas uac is the output voltage of a cell inverter and N is the number of inverters.\nFIGURE 2. Equivalent circuit of the CHB system with distributed filter inductors.\nTherefore, the voltage across an inductor and an H-bridge equals to the grid voltage, divided by the total number of the CHBs. It is worth noting that the aforementioned is valid, assuming that the outputs of all cells are identical, otherwise the measurement of the \u03b8b angle will not be representative. Nevertheless, upon connecting the CHBs to the electricity network, none of the inverters is synchronized. In order synchronization to be established, current must flow from the grid, through the CHB system. However, during the time\nH-Bridge DC-link Cdc udc\nPV Cell-Level Inverter #N\nuo\nSynchronous\nBoost\nDC\nDC\nDC\nAC\nui\nLg/N\nuac\nii io\nPV Cell\nLocal Load (standalone)\nUtility Grid\n(grid-tied)\nSolid State\nPower\nController\n(current limiter)\nH-Bridge DC-link Cdc udc\nPV Cell-Level Inverter #1\nuo\nSynchronous\nBoost\nDC\nDC\nDC\nAC\nui\nLg/N\nuac\nii io\nPV Cell\nCdcL\nS1\nS2 Ciui\nS3\nS4\nudc\nS5\nS6\nuo\nSynchronous Boost\nDC/DC\nH-Bridge\nDC/ACDC-Link\nii\nio\nDC\nAC\nuLg #1 uLg #2 uLg #N\nuinv #1 uinv #2 uinv #N\nugrid\nDC\nAC\nDC\nAC\nLg/N Lg/N Lg/N\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7\ninterval that each inverter is unsynchronized, this amount of current may be excessive. Hence, synchronization is achieved by means of a series-connected current limiting device, implemented as a solid-state power controller. Thus, when connecting the inverter to the grid, a reduced current flows until synchronization occurs; thereupon the current limiting device is bypassed.\nThe input of each cell-level inverter is connected to a PV cell, whereas the synchronous boost DC-DC stage forms the DC-link, feeding the H-bridge inverter. The MPPT operation is executed by the boost converter, absorbing the maximum power from the solar cell. In case that the boost converter operates in MPPT mode and the DC-link voltage is effectively regulated (e.g., through the H-bridge inverter stage), the total energy yield of the PV system is injected into the electricity grid. In this way the DC-link voltage remains constant, while maximum power is extracted from the solar cell.\nFinally, in the studied configuration, input voltage and current signals (for MPPT operation), DC-link voltage signal (for power transfer maximization), and output voltage and current signals (for grid synchronization and reactive power estimation) are measured. For the AC voltage generation two methods were considered (i.e., SPWM and multilevel), described in detail in the following sub-Sections.\nA. SPWM-BASED TECHNIQUES\nThe SPWM technique is based on the typical PWM scheme, where the duty cycle value follows a sinusoidal waveform. In this paper the bipolar SPWM was considered and digitally implemented, for the experimental validation. At any given moment, two out of four MOSFET switches of the H-bridge are turned on, generating a square waveform, the average value of which is a 50 Hz sine wave [26]. This technique can be used to control the active and reactive power, exchanged with the grid. According to the expressions (4), (5) and the circuit analysis in Fig. 3, both active and reactive power flows depend on the output voltage of the cell inverters, as well as on the phase difference \u03b4 [26].\nsin inv grid\ng\nV V P\nL   = (4)\n2cosinv grid grid\ng\nV V V Q\nL\n\n\n\u2212 = (5)\nAs a result, by adjusting ma, \u03b4, or both, it is possible to control active as well as reactive power. In particular, three control schemes were applied, presented below."
        },
        {
            "heading": "1) Active power maximization via ma control.",
            "text": "In order to maximize the active power transferred to the utility grid, the modulation index ma can be regulated. Thereby, the phase difference \u03b4 between the inverter and grid voltages is held constant to a desired value, while the voltage amplitude of each inverter is regulated, to maximize the output power. The present method is characterized by its\nsimplicity, which is an important feature in the design of such a complex system [28]. However, in proportion to the active power, the reactive power is also affected, as there is a linear dependence of the reactive power and the inverter output voltage Vinv."
        },
        {
            "heading": "2) Active power maximization via \u03b4 control.",
            "text": "In this control scheme, the modulation index ma value remains constant, in each cell inverter. Hence, the active power injected to the electricity network is determined by the phase difference \u03b4. As the phase difference increases, the active power that is transferred increases, respectively. Although, the reactive power amount is not significantly affected by \u03b4, since for relatively small \u03b4 values, the cos\u03b4 remains close to unity. Therefore, the aforementioned technique constitutes a method of determining the desired reactive power exchanged with the grid while injecting maximum active power [26]. 3) Active power maximization and reactive power minimization via \u03b4 and ma control.\nThe presented method of active power maximization may facilitate the elimination of reactive power, too. In particular, by solving (4) and (5), the appropriate values of ma and \u03b4 can be derived, that minimize the reactive power, by simultaneously maximizing the active power [26]. In contrast to the previous methods, this is a more complicated one, requiring fine tuning of both variables.\nRegarding the synchronization in grid-tied operation, SPWM-controlled inverters can be synchronized with the grid either by using a Phase Locked Loop (PLL) or by adjusting the phase angle \u03b4, to achieve a particular active power setpoint [26]. However, in standalone operation (since there is no grid reference sine wave), the use of a PLL is imperative. In this paper, a software-based PLL scheme was digitally implemented, by the aid of a microcontroller unit\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7\n(MCU). Finally, Fig. 4 summarizes the above-described SPWM-based control schemes.\nB. MULTILEVEL-BASED SCHEME\nThe multilevel technique is a popular and commonly used method of generating a sine wave output in CHB inverter systems [8], [26], [28]-[30]. Each cell inverter forms a voltage level and generates a square waveform of a certain amplitude at its output, so that the combination of the voltages of all the CHBs to form a sinusoidal waveform. Fig. 5 illustrates an example of a multilevel waveform with 2N+1 voltage levels, which can be produced by an N CHB system.\nIn order to generate a multilevel waveform, the determination of the conduction angles \u03b8cond,i of each cell inverter is required. The \u03b8cond,i angles represent the time interval of each voltage level within a period. The optimal conduction angles for the minimum Total Harmonic Distortion (THD) case of the output voltage are calculated, by the aid of the following mathematical expressions (in respect to Fig. 5):\n, , ,\n1\n4 sin\n22\nN cond ilevel\ncell b rms\ni\nu V\n\n =\n  =  \n   (6)\n, 2 2cond i i xi   = \u2212 + (7)\n1sini i\nN  \u2212   =     (8)\n, 1\n2 cos( ) cos( )\ncell b xi i i\nlevel\nV\nNu   \u2212= \u2212   (9)\nwhere Vcell,b,rms and ulevel represent the rms voltage of the fundamental harmonic component of the H-bridge output, and the DC-link voltage, respectively, whereas \u03b8i and \u03b8xi are denoted in Fig. 5. The detailed mathematical analysis for a specific example of a 7-level inverter, generated by 3 CHBs, can be found in APPENDIX A. 1) Active power maximization via ma control. In order to control the active power that is injected to the grid, the phase difference \u03b4 of each cell inverter has to be determined [26]. In this case, the reactive power remains constant, as described in the previous SPWM sub-Section. However, in order to produce the output waveform in the multilevel technique all inverters must be in-phase with each other, otherwise the power quality would be degraded. Therefore, \u03b4 must be determined by an external central controller and distributed to all individual inverters, a fact that reduces the flexibility of the decentralized control. 2) Active power maximization via \u03b8cond,i control. An alternative method to regulate the active power of each inverter is to effectively adjust the conduction interval \u03b8cond. The power delivered by each cell depends on the pulse width of its output voltage. Therefore, it is possible to reduce the\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7\noutput power by reducing the \u03b8cond,i value. Nevertheless, reducing the pulse width leads to an output waveform that differs significantly from the ideal sine waveform, resulting to an increased THD factor and thus to deteriorated power quality.\nFor the case of multilevel technique, both in grid-tied and standalone operation, the CHBs need a PLL, in order to synchronize (i.e., with the electricity grid or with each other) [26], [28]. On the other hand, in case that all cell inverters are controlled through a central controller unit, in standalone operation the PLL can be avoided, as long as the common \u03b8 angle is distributed to all inverters. Finally, the proposed multilevel-based control scheme is depicted in Fig. 6."
        },
        {
            "heading": "C. ADVANTAGES AND DISADVANTAGES OF SPWM AND MULTILEVEL TECHNIQUES IN GRID-TIED OPERATION",
            "text": "As regards the SPWM technique, it is characterized by simplicity and flexibility, generating a pure sinusoidal waveform, resulting in significantly low THD, providing the possibility to control both active and reactive power, by regulating ma and \u03b4 in each cell inverter independently [28]. Thus, a CHB inverter system with independent control in each cell is possible. In parallel, the efficiency of the CHBs must be adequately high, for a system with cell-level inverters to become feasible. However, for the case of SPWM, significant switching losses are introduced, due to the high frequency of the SPWM carrier signal [26], [28]. Hence, the design of an SPWM-based system requires careful study, to avoid excessive power losses. It is worth noting that in order to acquire a fair comparison between the SPWM-based and the multilevel-based techniques regarding switching losses, the same semiconductor switches for both cases have to be considered. However, by exploiting the emerging technology of wide bandgap semiconductors (i.e., especially GaN devices, which are suitable for such lowvoltage applications) in practical applications, minimum switching losses are obtained, even for high switching frequencies [31].\nFurthermore, in case that either centralized control, or a centralized monitoring/diagnostics system exist, it is proposed that all cell-level inverters communicate with the central controller, via the PLC technique [32]-[34]. In such\ncase, the high frequency carrier of the SPWM signal may hamper communication due its high harmonic content. Consequently, further investigation is considered imperative, to explore both the necessity of central control and the feasibility of establishing communication, while using the SPWM technique.\nOn the other hand, several of the aforementioned problems are absent in the multilevel-based power control scheme. As this method is characterized by low switching frequencies (e.g., 50 Hz), it is suitable for on-chip implementation, where high efficiency is critical [26]. Moreover, the low switching frequencies facilitate the communication among all inverters, implemented via PLC [32]. In parallel, it is possible to determine a common angle \u03b4 for all inverters, as well as to dynamically parameterize each inverter individually, resulting in increased flexibility.\nHowever, a notable disadvantage of the multilevel technique in cell-level inverters is the degraded power quality. For the case that no central control unit exists, each inverter must feature a fixed \u03b4 value, regardless of the conditions of power generation (determined by solar irradiance and temperature conditions). As a result, in MPPT operation, specific \u03b8cond,i angles are obtained for each inverter, and consequently reactive power regulation is unfeasible. In addition, when input power is reduced, the pulse width in each CHB is also reduced, by adjusting (i.e., reducing) the \u03b8cond,i value, resulting in distortion in the output voltage waveform [26], [28]. Therefore, the output waveform may exhibit poor power quality, whereas notable reactive power is present, due to the changes in the rms value of its fundamental component.\nAn additional difficulty arises from the fact that each cell inverter occupies a specific level position of the output waveform, so that it is able to provide a certain amount of power; hence the lower-level inverters deliver more power than the higher-level ones. In this way, not all inverters can operate in MPPT mode. A potential solution is to introduce energy storage units, such as batteries or supercapacitors, in order the lower-level inverters to accumulate excess energy and deliver it to the grid when reduced input power is evident [22]-[25]. An alternative approach is to alter the level position of each inverter, in a specific manner, by the aid of a central controller, along with an appropriate algorithm, to maximize the power absorbed by each inverter.\nTo conclude, both sine wave generation techniques in CHB cell-level inverters are characterized by several assets, but are accompanied by drawbacks that have to be addressed, before employing them in a decentralized system comprising PV cell-level inverters. Finally, Table I summarizes the advantages and disadvantages of both the above-described techniques.\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7"
        },
        {
            "heading": "III. PROPOSED CONTROL SCHEMES EXPERIMENTAL VALIDATION",
            "text": "In this paper, experimental tests for both SPWM-based and multilevel-based schemes were performed, in grid-tied operation. At first, the ability of synchronization with the grid voltage is studied, with the utilization of a current limiting device. In addition, the maximization of active power is achieved in SPWM technique, by means of regulating angle \u03b4, or modulation index ma, or both simultaneously. In multilevel technique active power maximization is achieved by effectively regulating the conduction angle \u03b8cond,i. Subsequently, the response of the system under partial or total shading of PV cells is emulated by altering the input power of each inverter.\nA. EXPERIMENTAL SETUP\nAn experimental testbench comprising four CHB inverters is developed, to verify the theoretical background for both SPWM-based and multilevel-based techniques, as it is presented in Fig. 7. It is noted that the inverters are developed by discrete power electronic devices, because these tests were performed prior to the final on-chip design \u2013 in order to experimentally study (and troubleshoot) the implementation of the proposed control schemes. In the particular setup, the MPPT operation is emulated by supplying each inverter with constant current. Consequently, the experimental tests are focused on the inverter control schemes. The constant current is provided by laboratory power supplies (operating in constant current mode), with values ranging from 0 to 2 A.\nEach CHB adopts a custom developed 500 \u03bcH filter inductor to its output, whereas all inverters are connected in series, presenting a total inductance of 2 mH. In order to effectively stabilize the DC-link voltage, a 30 mF supercapacitor is utilized in each inverter. In addition, a simple current limiting device, consisting of a 10 \u03a9 resistor, along with a bypassing switch was used for the synchronization process. Most of the experimental tests were performed with the input voltage reference set to 3 Vdc, thus the peak sinusoidal output voltage is Vp = 12 V, whereas the\nrms output voltage is Vrms = 8.5 V. Therefore, a suitable transformer was utilized for the interconnection with the electricity grid.\nAs it has been already discussed, the synchronization with the grid voltage is achieved by measuring uac of each celllevel inverter, which is equivalent to the grid voltage divided by the number of inverters. Next, the sensed signal is processed by a PLL, so as the grid angle \u03b8b to be derived. It is noted that the angles \u03b4 presented at the following experimental results are in reference to the measured angle of the 4th (highest level) inverter, which might not represent the grid voltage. Moreover, as it was previously discussed, it is possible to minimize reactive power with the SPWM technique, by minimizing the output current of the CHB system. For this purpose, the output current is measured with a 25 m\u03a9 current sense (shunt) resistor of. A similar resistor is used at the H-bridge input, to measure the input current. Finally, the active power transferred to the grid can be maximized by measuring and stabilizing the DC-link voltage, as it is described in Section II. All measured signals are filtered and conditioned by means of an operational amplifying circuitry and fed to the MCU Analog-to-Digital\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7\nConverter (ADC) inputs.\nThe selected MCU is the TMS320F28379D from Texas Instruments, incorporated into the LAUNCHXL-F28379D (C2000 Delfino) development board [35], [36]. The MCU provides the signals for driving the MOSFETs of all CHBs, introducing the appropriate dead-time to prevent shootthrough current. Furthermore, all the necessary measurements are being sampled by its ADC module and processed accordingly. Table II summarizes the main components of the experimental setup.\nIn the following sub-Section experimental results and measurements for the two studied power control techniques are presented. The synchronization process is also described, whereas for the multilevel technique the synchronization process is more complicated, due to the asymmetrical operation of the inverters.\nB. EXPERIMENTAL RESULTS FOR THE SPWM TECHNIQUE\nThe active power is maximized by effectively regulating the modulation index ma, the angle \u03b4 or both, achieving different objectives in each case. 1) Constant \u03b4, regulating ma.\nFor the particular experimental tests, the phase angle \u03b4 is held constant to a predetermined value, while ma is regulated, to control the active power flow. The synchronization process is validated and the active power maximization via the DC-link voltage stabilization is examined. Subsequently, power loss scenarios (that correspond to shading or failure of some PV cells) of one or two CHBs are tested, where the adaptability of the system is highlighted. Finally, Table III presents the output current, the input currents and voltages of each cell-level inverter, as well as the fixed angle \u03b4. TABLE II RESULTS OF THE SPWM TECHNIQUE WITH CONSTANT PHASE DIFFERENCE\nIout,ac\n(A)\nIin,1 (A) Iin,2 (A) Iin,3 (A) Iin,4 (A) Vdc,1 (V) Vdc,2 (V) Vdc,3 (V) Vdc,4 (V) \u03b4 (\u00b0)\n0.89 0.627 0.649 0.63 0.616 3.21 3.17 3.26 3.23 15 0.64 0 0.144 0.136 0.134 2.77 3.36 3.4 3.38 15\n0.81 0 0 0.015 0.013 2.79 2.8 3.56 3.53 15"
        },
        {
            "heading": "1.41 0.828 0.83 0.834 0.849 3.15 3.09 3.19 3.16 20",
            "text": ""
        },
        {
            "heading": "1.36 0 0.455 0.439 0.422 2.78 3.27 3.34 3.3 20",
            "text": ""
        },
        {
            "heading": "1.87 0 0 0.184 0.167 2.78 2.79 3.48 3.44 20",
            "text": ""
        },
        {
            "heading": "1.94 0.998 0.992 0.993 0.991 2.96 2.91 3.04 3.01 25",
            "text": "2.06 0 0.802 0.787 0.772 2.81 3.13 3.23 3.19 25"
        },
        {
            "heading": "2.41 0 0 0.604 0.582 2.82 2.8 3.37 3.31 25",
            "text": "It is worth mentioning that in the case where all inverters are operating in full power (i.e., in the 25\u00b0 scenario), the input current is maximized at around 1 A; thus, the injected active power to the grid is maximized as well. On the other hand, for the case where one or two inverters are out of operation, the input current of the remaining inverters is reduced. This is due to the fact that the overall output voltage decreases notably and so the CHB system becomes unable to transfer the maximum active power, even with ma reaching 100% (due to the constant \u03b4 value).\nAlthough the active power is reduced, the reactive power is increased \u2013 due to the voltage reduction. Hence, the output current is not reduced in proportion to the active power, whilst it even increases in some cases. Fig. 8 illustrates the output current waveforms for all scenarios. Apparently, as more cells are shaded the current phase angle becomes higher (it gets closer to 90\u00b0), confirming so the increase of the reactive power.\n2) Constant ma, regulating \u03b4.\nExperimental results for the case of SPWM with ma set to 95% are presented. Table III presents three different cases for the input current value, where the angle \u03b4 is regulated accordingly, so as to transfer the total input active power to the grid. The output current waveforms are depicted in Fig. 9.\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7\nThe active power, the output current and the angle \u03b4 increase, in respect to the input current, as it was expected. The phase difference between the output current and the grid voltage denotes the presence of reactive power. However, reactive power is not affected as much as active power, thanks to the constant ma.\nNext, partial shading is emulated, by decreasing the input current of a cell-level inverter. Specifically, experimental tests with input current values of 0.8 A and 0.4 A representing no shading and shading conditions, respectively, were carried out. Partial shading was examined to one, two or three out of four inverters and the response of the system was observed. In Table IV the results of the aforementioned tests are given, keeping ma equal to 95% as in the previous case.\nIt is worth noting that Table IV presents some cases where \u03b4 becomes negative; however, it should be noted that this is a phase angle measurement in regard to the higher-level inverter and not the real phase angle \u03b4.\nTABLE IV RESULTS OF THE SPWM TECHNIQUE WITH PARTIAL SHADING\nIout,ac\n(A)\nIin,1 (A) Iin,2 (A) Iin,3 (A) Iin,4 (A) \u03b41 (\u00b0)\n\u03b42 (\u00b0) \u03b43 (\u00b0)\n\u03b44 (\u00b0)\nma\n(%)\n1.89 0.8 0.8 0.8 0.8 21 21 21.2 22 95 1.75 0.4 0.8 0.8 0.8 1 23 23 21 95 1.71 0.4 0.4 0.8 0.8 -3 -3 19 19 95 1.48 0.4 0.4 0.4 0.8 -12 -12 -13 16 95\nRegarding the synchronization with the electricity grid, it is maintained at all SPWM-based experiments, especially under partial shading conditions, while maximum active power from each individual cell in every operating condition is injected to the grid. Each inverter handles power flow separately and efficiently, whereas high power quality is indicated. Fig. 10 depicts the output current waveforms for each case.\n3) Regulating both \u03b4 and ma.\nReactive power can be reduced, or even eliminated by regulating both the angle \u03b4 and the modulation index ma. After the synchronization phase, ma is regulated by means of a Proportional Integral (PI) controller, in order to maximize the active power transferred to the grid and effectively stabilize the DC-link voltage. Concurrently, the angle \u03b4 is regulated through a Perturb and Observe (P&O) control algorithm, at a slower rate, aiming to minimize the output current. Apparently, in case that the active power is maximized, while the output current is minimized, reactive power minimization is achieved.\nFor the following experimental tests, the DC-link voltage is set to 4 V, in order to obtain higher ma control / operating range, compared to the previous case, where ma was constant, equal to 95%, whereas the input currents of all CHBs are equal to 0.8 A. Moreover, partial shading is examined by reducing the input current at some of the inverters. In Table V experimental results for this case, where output and input currents, as well as \u03b4 and ma are shown.\nTABLE V RESULTS OF THE SPWM TECHNIQUE WITH BOTH MODULATION INDEX AND PHASE REGULATION\nIout,ac\n(A)\nIin,1 (A) Iin,2 (A) Iin,3 (A) Iin,4 (A) \u03b41 (\u00b0) \u03b42 (\u00b0) \u03b43 (\u00b0) \u03b44 (\u00b0) ma,1 (%) ma,2 (%) ma,3 (%) ma,4 (%)\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7\n1.11 0.8 0.8 0.8 0.8 14 28 20 9 95 86 91 94 1.56 0.4 0.8 0.8 0.8 12 18 16 15 54 90 93 97 1.7 0.4 0.4 0.8 0.8 12 19 18 16 60 50 90 99 1.75 0.4 0.4 0.4 0.8 7 8 16 18 65 66 56 100\nAccording to the data presented in Table V, the active power is maximized, whereas angles \u03b4 and modulation indices ma obtain appropriate values, so that the output current and respectively the reactive power are reduced. Indeed, the reactive power is reduced; for instance, at the case of no partial shading, the output current is reduced to 1.11 A, while for the previous experiments the output current was 1.41 A and 1.89 A. In addition, as the input voltage increased from 3 V to 4 V the active power increased, too. Thus, an increase in active power followed by a decrease in apparent power is observed, meaning that reactive power is reduced. The same conclusion stands also for the tests with partial shading conditions.\nFig. 11 presents the output current waveforms for the aforementioned cases. It is clear that reactive power is significantly reduced under no shading conditions, although it progressively increases when partial shading occurs (due to the reduced capability for AC voltage generation of the CHB system, indicated by the fact that ma reaches 100%).\nC. EXPERIMENTAL RESULTS FOR THE MULTILEVEL TECHNIQUE\nIn this sub-Section, experimental results and measurements for the multilevel-based power control technique are presented. Moreover, the synchronization process is analyzed for various start-up conditions, whereas the operation of the inverter is tested for various values of \u03b4. Finally, the response of the inverter under partial shading is highlighted. 1) Synchronization process.\nPrior to the synchronization phase, a current limiting\nresistor of 10 \u03a9 is inserted between the CHB inverter system and the grid. Afterwards, two out of four cell-level inverters are activated and the grid voltage phase angle is obtained. Next, the rest of the inverters are activated and the multilevel waveform is generated. Lastly, the current limiting resistor is bypassed by the aid of a solid-state switch and the inverter is directly connected to the transformer. Apparently, the synchronization is affected by the selection pattern of the active inverters, because of the different voltage level of each one. Thus, activating the two lower-level cells first (with the greater \u03b8cond,i values) might have a different response than activating the respective higher-level cells (with the smaller \u03b8cond,i values). The corresponding voltage curves of the aforementioned two cases are depicted in Fig. 12.\nIt is worth noting that synchronization may occur even with all inverters on or off, by utilizing a proper current limiting device, meaning that it can be established regardless of the CHB start-up pattern. For instance, in case that the synchronization is initiated with all inverters in off mode, the MOSFET switches of the H-bridges are activated appropriately (in respect to the multilevel pulse signals), so that current can flow through the inverters; thus, the measured uout of each inverter would represent the grid voltage. Consequently, inverters can be activated after synchronization has been established. 2) Constant \u03b4, regulating \u03b8cond,i.\nExperiments were performed, to evaluate the active power regulation methods that were previously described. The experimental setup is the same as in the SPWM technique, presented in Fig. 7. In order to generate the multilevel waveform, the conduction angles \u03b8cond,i of each CHB are calculated, by using the mathematical expressions (6) - (9). Next, the input current value of each inverter is calculated, to meet the appropriate active power for an angle \u03b4 ranging from 5\u00b0 to 35\u00b0. The respective experimental measurements are given in Table VI.\nTABLE VI RESULTS OF THE MULTILEVEL TECHNIQUE WITH CONSTANT PHASE DIFFERENCE\nIout_ac\n(A)\nIin,1 (A) Iin,2 (A) Iin,3 (A) Iin,4 (A) Vdc,1 (V) Vdc,2 (V) Vdc,3 (V) Vdc,4 (V) \u03b4 (\u00b0)\n0.59 0.492 0.461 0.388 0.188 3.25 3.23 3.31 3.34 5 0.59 0.607 0.511 0.473 0.291 3.22 3.2 3.29 3.33 10\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7\n0.84 0.761 0.663 0.555 0.265 3.2 3.17 3.28 3.3 15 1.16 0.933 0.756 0.673 0.301 3.17 3.14 3.26 3.28 20 1.57 1.126 0.922 0.775 0.324 3.1 3.06 3.18 3.26 25 2.14 1.306 1.121 0.914 0.39 2.82 2.87 3.08 3.22 30 2.45 1.335 1.174 0.998 0.418 2.82 2.82 3.01 2.85 35\nThe maximum active power that can be transferred to the grid is proportional to angle \u03b4. The DC-link voltage is stabilized at around 3 V; however, in some cases it surpasses that threshold. This observation exposes a weak spot of the multilevel technique, which is the inability to transfer the total active power generated by each PV cell, while the conduction angles \u03b8cond,i become maximum. As a result, the higher level cells (with smaller \u03b8cond,i values) can transfer less power and are more susceptible to fail to operate in MPPT mode.\nAs it was mentioned above, the maximum active power of each inverter is proportional to \u03b4, whereas as the output power surpasses the input power, the DC-link voltage drops and the PI controller regulates the output power, by lowering the \u03b8cond,i value. Thus, the DC-link voltage is stabilized at around 3 V and the total input power is transferred to the utility grid. Finally, in Fig. 13 the multilevel waveforms of each CHB are presented.\nFig. 14 illustrates the reduction of \u03b8cond,1 at the 1st cell. To conclude, the DC-link voltage has been successfully regulated through the PI controller, while the synchronization with the grid was achieved and maintained in all experimental conditions and maximum power was transferred to the grid. 3) Operation with one cell disabled.\nExperiments were performed with one CHB turned off, to simulate the partial shading of a photovoltaic system. Unlike the SPWM technique, in multilevel case, the inverter level / number that is turned off is of particular importance (i.e., a\nspecific level is removed). Table VII presents the experimental measurements with an inverter in off mode, \u03b4 25\u00b0.\nTABLE VII RESULTS OF THE MULTILEVEL TECHNIQUE WITH PARTIAL SHADING\nIout,ac\n(A)\nIin,1 (A) Iin,2 (A) Iin,3 (A) Iin,4 (A) Vdc,1 (V) Vdc,2 (V) Vdc,3 (V) Vdc,4 (V) \u03b4 (\u00b0)"
        },
        {
            "heading": "1.53 1.102 0.981 0.776 0.344 3.1 3.06 3.17 3.26 25",
            "text": ""
        },
        {
            "heading": "2.47 0 0.705 0.605 0.292 -0.16 3.19 3.24 3.29 25",
            "text": ""
        },
        {
            "heading": "2.34 0.883 0 0.592 0.267 3.21 -0.12 3.24 3.3 25",
            "text": ""
        },
        {
            "heading": "2.23 0.985 0.811 0 0.239 3.12 3.11 -0.15 3.31 25",
            "text": "0.59 0.15 0.133 0.089 0 3.37 3.36 3.39 0.23 25\nThe inverters that are in operation maintain a stabilized DClink voltage, although the input current drops slightly. Thus, maximum power transfer cannot be obtained, because the overall inverter voltage is decreased, due to the loss of a cellinverter. However, this effect would not be noticeable in a real system with a greater number of PV cells, where the impact of a few cells to the overall inverter voltage would be insignificant. Furthermore, the synchronization is maintained at all cases, highlighting the robustness of the proposed decentralized control technique."
        },
        {
            "heading": "IV. CONCLUSION",
            "text": "In this work, control and synchronization issues of CHB inverters, applicable to PV cell-level inverters are discussed. A fully decentralized multilevel-based power control and synchronization strategy is proposed, as an alternative to the SPWM-based method. Both control schemes, including some variations regarding the regulation variables, are analyzed and experimentally evaluated, highlighting their specific characteristics. As regards the SPWM-based technique, its simplicity and high power quality are highlighted, whereas it suffers from higher switching losses\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7\ndue to the high frequency carrier signal and hinders the PLC communication. On the other hand, the multilevel-based strategy presents flexibility, higher efficiency, because of minimum switching losses (switches commutation occur at 50 Hz, i.e., the fundamental frequency), whilst it features deteriorated power quality and increased implementation complexity, due to the pre-calculation of the conduction angles, depending on the available cell-level inverters number.\nNevertheless, the feasibility of both the aforementioned decentralized control strategies has been experimentally validated, in a laboratory 4 CHB hardware prototype, as well as their applicability for PV cell-level inverter system. The most appropriate control scheme variation can be selected, according to the particular needs and characteristics of the target application."
        },
        {
            "heading": "APPENDIX A",
            "text": "The calculation of the fundamental harmonic component of a multilevel inverter output voltage can be derived, by the aid of the Fourier analysis, as follows:\n( ) 1 cos( ) sin( ) 2 o o n n n\na V a n t b n t \n\n=\n= + + (A1)\n, 0o na a = (A2)\n1 sin( ) ( )n ob u n t d t\n\n\n  \n\u2212\n=  (A3)\n1 1 1 sin( ) ( ) sin( ) ( )o ob u t d t u d\n \n \n     \n\u2212 \u2212\n= =  (A4)\nAs an example, the calculation of the fundamental harmonic component of a 7-level (3 cells), multilevel inverter output voltage is described below: ,2 ,3\n,1 ,2\n,3 ,2\n,3 ,3\n2 2\n1\n2 2\n2 2 2 2\n2 2 2\n2\nsin( ) ( ) 2 sin( ) ( )\n3 sin( ) ( ) 2 sin( ) ( )\nsin( )\ncond cond\ncond cond\ncond cond\ncond cond\nlevel level\ndc level\nlevel\nb u d u d\nu d u d\nu\n     \n     \n  \n   \n\n    \n   \n\n\u2212 \u2212 \u2212 + \u2212 +\n\u2212 \u2212 \u2212 + \u2212 +\n\u2212 + \u2212 +\n\u2212 \u2212 + \u2212 +\n\u2212 +\n= \u2212 + \u2212 +\n\u2212 + \u2212 +\n+ \u2212\n \n \n,1 ,2\n,2 ,1\n,3 ,3\n,2 ,3\n,2\n,3\n2 2 2 2\n2 2 2\n2 2 2 2\n2 2 2 2\n2 2\n2 2\n( ) sin( ) ( )\n2 sin( ) ( ) 3 sin( ) ( )\n2 sin( ) ( ) sin( )\ncond cond\ncond cond\ncond cond\ncond cond\ncond\ncond\nlevel\nlevel level\ndc level\nd u d\nu d u d\nu d u\n  \n\n  \n  \n\n \n  \n   \n  \n\u2212 + \u2212\n\u2212\n\u2212 +\n\u2212 \u2212\n+\n+\n+ +\n+ + +\n+ +\n \n \n\n,1\n,2\n2 2\n2 2\n( )\ncond\ncond\nd\n\n\n\n+\n+\n\n,2 ,1 1\n,3 ,2\n,3 ,3\n,2 ,3\ncos( ) cos( ) 2 2\n2 cos( ) cos( ) 2 2\n3 cos( ) cos( ) 2 2 2\n2 cos( ) cos( ) 2 2 2 2\ncond cond level\ncond cond level\ncond cond level\ncond cond level\nb u\nu\nu\nu\n      \n     \n   \n  \n\u2212 \u2212  = \u2212 + \u2212 \u2212 + + \n \n\u2212 \u2212  + \u2212 + \u2212 \u2212 + + \n \n\u2212  + \u2212 + \u2212 \u2212 + + \n \n+ \u2212 + \u2212 \u2212 +\n,1 ,2\n,2 ,1\n,3 ,2\n,3 ,3\ncos( ) cos( ) 2 2 2 2\ncos( ) cos( ) 2 2 2 2\n2 cos( ) cos( ) 2 2 2 2\n3 cos( ) cos( ) 2 2 2 2\n2\ncond cond level\ncond cond level\ncond cond level\ncond cond level\nu\nu\nu\nu\n  \n  \n  \n  \n  +   \n  + + \u2212 \u2212 \u2212 \u2212 \n \n  \u2212 \u2212 \u2212 \u2212 \u2212 \n \n  \u2212 \u2212 \u2212 \u2212 \u2212 \n \n  \u2212 + \u2212 \u2212 \u2212 \n \n\u2212 ,2 ,3\n,1 ,2\ncos( ) cos( ) 2 2 2 2\ncos( ) cos( ) 2 2 2 2\ncond cond level\ncond cond level\nu\nu\n  \n  \n  + \u2212 + \u2212   \n  \u2212 + \u2212 +  \n \n,2 ,1 1\n,3 ,2\n,3 ,3\n,2 ,3\n,1\nsin( ) sin( ) 2 2\n2 sin( ) sin( ) 2 2\n3 sin( ) sin( ) 2 2\n2 sin( ) sin( ) 2 2\nsin( ) sin( 2\ncond cond level\ncond cond level\ncond cond level\ncond cond level\ncond co level\nb u\nu\nu\nu\nu\n  \n \n \n \n \n  = \u2212 + + \n \n  + \u2212 + + \n \n  + + + \n \n  + \u2212 + \n \n+ \u2212 ,2\n,2 ,1\n,3 ,2\n,3 ,3\n,2 ,3\n,\n) 2\nsin( ) sin( ) 2 2\n2 sin( ) sin( ) 2 2\n3 sin( ) sin( ) 2 2\n2 sin( ) sin( ) 2 2\nsin(\nnd\ncond cond level\ncond cond level\ncond cond level\ncond cond level\ncond level\nu\nu\nu\nu\nu\n \n \n \n \n\n  \u2212   \n  \u2212 \u2212 \u2212 \n \n  \u2212 \u2212 \u2212 \n \n  \u2212 \u2212 \u2212 \u2212 \n \n  \u2212 \u2212 + \u2212 \n \n\u2212 \u2212 1 ,2\n) sin( ) 2 2\ncond  +    \n,1 ,2 ,3 1\n4 sin( ) sin( ) sin( )\n2 2 2\ncond cond condlevelub   \n\n  = + + \n \n(A5)\nThe above expression (A5) can be generalized for N cells,\nas:\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nVOLUME XX, 2017 7\n, 1\n1\n4 sin\n2\nN cond ilevel\ni\nu b\n\n =\n  =  \n   (A6)\nHence, it is obtained:\n, ,\n1\n4 sin\n2\nN cond ilevel\ncell b\ni\nu V\n\n =\n  =  \n   (A7)\nThe calculation of the conduction angle for each cell,\n\u03b8cond,i, according to Fig. 5, is as follows: , 2 2cond i i xi   = \u2212 + (A8)\n1 1\n, sin sinleveli cell b\niu i\nV N  \u2212 \u2212     = =       \n(A9)\n, 1\n2 cos( ) cos( )\ncell b xi i i\nlevel\nV\nNu   \u2212= \u2212   (A10)\nCombining the above equations (A8), (A9) and (A10), the obtained \u03b8cond,i must fulfil the below expression:\n,\n2 2 11\n,\n4 sin\n2 1 2sin 2 1 1 )\nN cond ilevel\nj\ncond i level\nu\ni i i N Nu N N\n\n   =\u2212         \u2212      = \u2212 + \u2212 \u2212 \u2212           \n \n\n(A11) Finally, as each \u03b8cond,i depends on the rest \u03b8cond,i-1 value (obtained by the exact previous lower level), the above equation can be solved, utilizing a simple iterative algorithm."
        }
    ],
    "title": "Feasibility Study of a Fully Decentralized Control Scheme for PV Cell-Level Cascaded H-Bridge Inverters",
    "year": 2023
}