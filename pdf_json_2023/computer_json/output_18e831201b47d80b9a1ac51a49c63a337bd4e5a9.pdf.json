{
    "abstractText": "In this paper, we introduce two local graph features for missing link prediction tasks on ogbl-citation2. We define the features as Circle Features, which are borrowed from the concept of circle of friends. We propose the detailed computing formulas for the above features. Firstly, we define the first circle feature as modified swing for common graph, which comes from bipartite graph. Secondly, we define the second circle feature as bridge, which indicates the importance of two nodes for different circle of friends. In addition, we firstly propose the above features as bias to enhance graph transformer neural network, such that graph self-attention mechanism can be improved. We implement a Circled Feature aware Graph transformer (CFG) model based on SIEG network, which utilizes a double tower structure to capture both global and local structure features. Experimental results show that CFG achieves the state-of-the-art performance on dataset ogbl-citation2.",
    "authors": [
        {
            "affiliations": [],
            "name": "Jingsong Lv"
        },
        {
            "affiliations": [],
            "name": "Hongyang Chen"
        },
        {
            "affiliations": [],
            "name": "Yao Qi"
        },
        {
            "affiliations": [],
            "name": "Lei Yu"
        }
    ],
    "id": "SP:6859bb1b86eba99792608dfc80b21351679519da",
    "references": [
        {
            "authors": [
                "D. Liben-Nowell",
                "J. Kleinberg"
            ],
            "title": "The link-prediction problem for social networks,",
            "venue": "Journal of the American society for information science and technology,",
            "year": 2007
        },
        {
            "authors": [
                "H. Federer"
            ],
            "title": "Curvature measures,",
            "venue": "Transactions of the American Mathematical Society,",
            "year": 1959
        },
        {
            "authors": [
                "L. Page",
                "S. Brin",
                "R. Motwani"
            ],
            "title": "and T",
            "venue": "Winograd, \u201cThe pagerank citation ranking: Bring order to the web,\u201d Technical report, stanford University, Tech. Rep.",
            "year": 1998
        },
        {
            "authors": [
                "G. Jeh",
                "J. Widom"
            ],
            "title": "Simrank: a measure of structural-context similarity,",
            "venue": "Proceedings of the eighth ACM SIGKDD international conference on Knowledge discovery and data mining,",
            "year": 2002
        },
        {
            "authors": [
                "Z. Li",
                "F. Liu",
                "W. Yang",
                "S. Peng",
                "J. Zhou"
            ],
            "title": "A survey of convolutional neural networks: analysis",
            "venue": "applications, and prospects,\u201d IEEE transactions on neural networks and learning systems",
            "year": 2021
        },
        {
            "authors": [
                "Z. Wu",
                "S. Pan",
                "F. Chen",
                "G. Long",
                "C. Zhang"
            ],
            "title": "and S",
            "venue": "Y. Philip, \u201cA comprehensive survey on graph neural networks,\u201d IEEE transactions on neural networks and learning systems, vol. 32, no. 1, pp. 4\u201324",
            "year": 2020
        },
        {
            "authors": [
                "L.A. Adamic",
                "E. Adar"
            ],
            "title": "Friends and neighbors on the web,",
            "venue": "Social networks,",
            "year": 2003
        },
        {
            "authors": [
                "A. Grover",
                "J. Leskovec"
            ],
            "title": "node2vec: Scalable feature learning for networks,",
            "venue": "Proceedings of the 22nd ACM SIGKDD international conference on Knowledge discovery and data mining,",
            "year": 2016
        },
        {
            "authors": [
                "Z. Wang",
                "C. Chen"
            ],
            "title": "and W",
            "venue": "Li, \u201cPredictive network representation learning for link prediction,\u201d in Proceedings of the 40th international ACM SIGIR conference on research and development in information retrieval",
            "year": 2017
        },
        {
            "authors": [
                "T.N. Kipf",
                "M. Welling"
            ],
            "title": "Semi-supervised classification with graph convolutional networks,",
            "venue": "arXiv preprint arXiv:1609.02907,",
            "year": 2016
        },
        {
            "authors": [
                "M. Zhang",
                "Y. Chen"
            ],
            "title": "Link prediction based on graph neural networks,",
            "venue": "Advances in neural information processing systems,",
            "year": 2018
        },
        {
            "authors": [
                "S. Klamt",
                "A. von Kamp"
            ],
            "title": "Computing paths and cycles in biological interaction graphs,",
            "venue": "BMC bioinformatics,",
            "year": 2009
        },
        {
            "authors": [
                "H. E"
            ],
            "title": "Sussenguth, \u201cA graph-theoretic algorithm for matching chemical structures.",
            "venue": "Journal of Chemical Documentation,",
            "year": 1965
        },
        {
            "authors": [
                "D.B. Johnson"
            ],
            "title": "Finding all the elementary circuits of a directed graph,",
            "venue": "SIAM Journal on Computing,",
            "year": 1975
        },
        {
            "authors": [
                "R.C. Read",
                "R.E. Tarjan"
            ],
            "title": "Bounds on backtrack algorithms for listing cycles",
            "venue": "paths, and spanning trees,\u201d Networks, vol. 5, no. 3, pp. 237\u2013252",
            "year": 1975
        },
        {
            "authors": [
                "J.L. Szwarcfiter",
                "P.E. Lauer"
            ],
            "title": "A search strategy for the elementary cycles of a directed graph,",
            "venue": "BIT Numerical Mathematics, vol. 16,",
            "year": 1976
        },
        {
            "authors": [
                "E. Birmel\u00e9",
                "R. Ferreira",
                "R. Grossi",
                "A. Marino",
                "N. Pisanti",
                "R. Rizzi"
            ],
            "title": "and G",
            "venue": "Sacomoto, \u201cOptimal listing of cycles and st-paths in undirected graphs,\u201d in Proceedings of the twenty-fourth annual ACM-SIAM symposium on Discrete algorithms. SIAM",
            "year": 2013
        },
        {
            "authors": [
                "L. Qin",
                "Y. Peng",
                "Y. Zhang",
                "X. Lin",
                "W. Zhang"
            ],
            "title": "and J",
            "venue": "Zhou, \u201cTowards bridging theory and practice: hop-constrained st simple path enumeration,\u201d in International Conference on Very Large Data Bases. VLDB Endowment",
            "year": 2019
        },
        {
            "authors": [
                "D.J. Watts",
                "S.H. Strogatz"
            ],
            "title": "Collective dynamics of \u2018small-world\u2019networks,",
            "venue": "nature, vol. 393,",
            "year": 1998
        },
        {
            "authors": [
                "R.D. Luce",
                "A.D. Perry"
            ],
            "title": "A method of matrix analysis of group structure,",
            "venue": "Psychometrika, vol. 14,",
            "year": 1949
        },
        {
            "authors": [
                "X. Yang",
                "Y. Zhu",
                "Y. Zhang",
                "X. Wang"
            ],
            "title": "and Q",
            "venue": "Yuan, \u201cLarge scale product graph construction for recommendation in e-commerce,\u201d arXiv preprint arXiv:2010.05525",
            "year": 2020
        },
        {
            "authors": [
                "A. Authors"
            ],
            "title": "SIEG: Structural Information Enhanced Graph Representation ,",
            "venue": "https://github.com/anonymous20221001/SIEG_OGB/blob/master/OGB_ VESSEL_SIEG.pdf,",
            "year": 2023
        },
        {
            "authors": [
                "C. Ying",
                "T. Cai",
                "S. Luo",
                "S. Zheng",
                "G. Ke",
                "D. He",
                "Y. Shen",
                "T. Liu"
            ],
            "title": "Do transformers really perform bad for graph representation? arxiv 2021,",
            "venue": "arXiv preprint arXiv:2106.05234",
            "year": 2021
        },
        {
            "authors": [
                "W. Hu",
                "M. Fey",
                "M. Zitnik",
                "Y. Dong",
                "H. Ren",
                "B. Liu",
                "M. Catasta"
            ],
            "title": "and J",
            "venue": "Leskovec, \u201cOpen graph benchmark: Datasets for machine learning on graphs,\u201d arXiv preprint arXiv:2005.00687",
            "year": 2020
        },
        {
            "authors": [
                "K. Wang",
                "Z. Shen",
                "C. Huang",
                "C.-H. Wu",
                "Y. Dong"
            ],
            "title": "and A",
            "venue": "Kanakia, \u201cMicrosoft academic graph: When experts are not enough,\u201d Quantitative Science Studies, vol. 1, no. 1, pp. 396\u2013413",
            "year": 2020
        },
        {
            "authors": [
                "T. Mikolov",
                "I. Sutskever",
                "K. Chen",
                "G.S. Corrado"
            ],
            "title": "and J",
            "venue": "Dean, \u201cDistributed representations of words and phrases and their compositionality,\u201d Advances in neural information processing systems, vol. 26",
            "year": 2013
        },
        {
            "authors": [
                "Z. Wang",
                "Y. Zhou",
                "L. Hong",
                "Y. Zou"
            ],
            "title": "and H",
            "venue": "Su, \u201cPairwise learning for neural link prediction,\u201d arXiv preprint arXiv:2112.02936",
            "year": 2021
        },
        {
            "authors": [
                "C. Sun",
                "J. Hu",
                "H. Gu",
                "J. Chen"
            ],
            "title": "and M",
            "venue": "Yang, \u201cAdaptive graph diffusion networks,\u201d arXiv preprint arXiv:2012.15024",
            "year": 2020
        },
        {
            "authors": [
                "P. Louis",
                "S.A. Jacob"
            ],
            "title": "and A",
            "venue": "Salehi-Abari, \u201cSimplifying subgraph representation learning for scalable link prediction,\u201d arXiv preprint arXiv:2301.12562",
            "year": 2023
        },
        {
            "authors": [
                "H. Yin",
                "M. Zhang",
                "Y. Wang",
                "J. Wang"
            ],
            "title": "and P",
            "venue": "Li, \u201cAlgorithm and system codesign for efficient subgraph-based graph representation learning,\u201d arXiv preprint arXiv:2202.13538",
            "year": 2022
        },
        {
            "authors": [
                "X. Song",
                "R. Ma",
                "J. Li",
                "M. Zhang"
            ],
            "title": "and D",
            "venue": "P. Wipf, \u201cNetwork in graph neural network,\u201d CoRR, vol. abs/2111.11638",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "CCS CONCEPTS \u2022 Computing methodologies\u2192Machine learning.\nKEYWORDS Graph Transformer, Graph Neural Networks, Circle Feature, Representation Learning, Link Prediction."
        },
        {
            "heading": "1 INTRODUCTION",
            "text": "Link prediction is an important task to find latent relationship between nodes. A traditional method is to utilize the node and edge features or latent node and edge features to predict such missing links. Such node features include degree, centrality level, common neighbors[1], curvature[2], pagerank[3], simrank [4], and so on. In addition, node related sub network features can also be used to predict missing links. A famous example is triangles between nodes. Furthermore, multi-hop adjacent neighborhood structure information can improve the prediction performance. Inspired by the success of the deep Convolutional Neural Network(CNN)[5] in the field of computer vision, Graph Neural Network(GNN) [6] is widely applied in the task of link prediction. GNN can capture deep receptive field information, which cover more information than local sub-network structure, such that the performance can be greatly improved. Recently, transformer based neural network beats traditional GNN for the capability of capturing global graph information.\nIn this paper, we introduce the concept of circle feature, which is borrowed from circle friends. The motivation is that nodes with more common circles have stronger connectiveness. We propose two circle features and give the formal definitions. In addition, We propose a Circle Feature aware Graph transformer(CFG) method for\nlink prediction, which improve the transformer self-attention mechanism. Finally, we conduct experiments on dataset ogbl-citation2, and show that CFG beats the state-of-the-art method for missing link prediction task."
        },
        {
            "heading": "2 RELATEDWORK",
            "text": ""
        },
        {
            "heading": "2.1 Link Prediction",
            "text": "Approaches for link prediction can be divided into three groups: neighborhood based, factor decomposition based and neural network based. Neighborhood based methods mainly search out neighborhood information in a wide-based or depth-based manner such that nodes similarity can be figured out and used for prediction of missing links, such as common neighbors [1], Adamic-Adar [7], SimRank [4] and Node2Vec [8]. Factor decomposition based methods mainly utilize latent factors to measure nodes similarity, such as PNRL [9]. In addition, neural network based methods are used to capture deep hierarchical structure features in an end-to-end manner, such as GCN [10], SEAL [11]."
        },
        {
            "heading": "2.2 Cycle Enumeration",
            "text": "Enumeration of simple cycles of graphs is a classical computer science problem whose efficient solutions data back to the early 70s, which has many important applications in several domains, ranging from the feedback loops detection in biological networks[12] to the mechanical analysis of chemical structures[13].\nThe most efficient solution was presented by Johnson[14], Read and Tarjan[15], and Szwarcfiter and Lauer[16], which achieve the lowest time complexity bounds for listing simple cycles in directed graphs. But this is not optimal for undirected graphs, an optimal cycle enumeration algorithm for undirected graphs was presented by Birmel\u00e9 et al.[17].\nDue to the complexity of calculation and the need of practical application, various types of constraints are imposed on the cycles. For instance, long cycles in financial transaction networks are less likely to be associated with money laundering, so hop constraints can be imposed in this situation[18]. Cycles of specific length attract much more research, such as, triangles, which has many real-life applications, the most-known among them, is to compute the clustering coefficient[19] and the transitivity ratio[20] of a graph."
        },
        {
            "heading": "3 METHODS",
            "text": ""
        },
        {
            "heading": "3.1 Problem Definition",
            "text": "Let \ud835\udc3a = (\ud835\udc49 , \ud835\udc38) represent a homogeneous, unweighted, undirected graph, where \ud835\udc49 represents the nodes set of the graph, and \ud835\udc38 \u2286 \ud835\udc49 \u00d7 \ud835\udc49 represents the edges set of the graph. Let \ud835\udc41 = |\ud835\udc49 | and \ud835\udc40 = |\ud835\udc38 |. Given an edge \ud835\udc52\ud835\udc56 \ud835\udc57 \u2208 \ud835\udc38, it can be represented as node\nar X\niv :2\n30 9.\n06 57\n4v 1\n[ cs\n.S I]\n1 1\nSe p\n20 23\npair (\ud835\udc63\ud835\udc56 , \ud835\udc63 \ud835\udc57 ), where \ud835\udc63\ud835\udc56 , \ud835\udc63 \ud835\udc57 \u2208 \ud835\udc49 . Now let \ud835\udc34 \u2208 R\ud835\udc41\u00d7\ud835\udc41 represent the corresponding symmetric adjacency matrix, where matrix element \ud835\udc4e\ud835\udc56 \ud835\udc57 indicates whether edge (\ud835\udc63\ud835\udc56 , \ud835\udc63 \ud835\udc57 ) \u2208 \ud835\udc38. For node features, let \ud835\udc4b \u2208 R\ud835\udc41\u00d7\ud835\udc51 represent the feature matrix, where the matrix element \ud835\udc65\ud835\udc56, \ud835\udc57 represents the \ud835\udc57\ud835\udc61\u210e element of feature vector of node \ud835\udc63\ud835\udc56 .\nNow given a network \ud835\udc3a = (\ud835\udc49 , \ud835\udc38), the problem is to predict whether a missing link edge \ud835\udc52\u2032 \u2208 \ud835\udc38\u2032 = \ud835\udc49 \u00d7\ud835\udc49 \u2212 \ud835\udc38 exists."
        },
        {
            "heading": "3.2 Circle Features",
            "text": "To judge whether two nodes are connected with an edge, we propose circled features to figure out whether two nodes are connected by circles of friends. The hypothesis is that if two nodes are connected by more circles with smaller size, the higher the probability that two nodes are connected is.\n3.2.1 Modified Swing Feature. The first proposed circled feature is a modified swing feature adapted to common graph, which is derived from an earlier work that can be applied only in bipartite graph [21]. For common graph, missing links for any two nodes should be predicted, which is different from the original swing method. See Figure 1. For original swing, any missing links between item nodes can be predicted. To differentiate link strength for any two nodes, we define a modified swing feature to rewrite the original adjacency matrix.\n\ud835\udc50 \ud835\udc60\ud835\udc64\ud835\udc56\ud835\udc5b\ud835\udc54+ \ud835\udc56 \ud835\udc57 = \ud835\udc4e\ud835\udc56, \ud835\udc57 + \u2211\ufe01\n\ud835\udc62\u2208\u0393\ud835\udc56\u2229\u0393\ud835\udc57 \u2211\ufe01 \ud835\udc63\u2208\u0393\ud835\udc56\u2229\u0393\ud835\udc57 1 \ud835\udefc+ | \u0393\ud835\udc62 \u2229 \u0393\ud835\udc63 |\n, where \ud835\udc4e\ud835\udc56 \ud835\udc57 is an element of adjacency matrix, \u0393\ud835\udc56 , \u0393\ud835\udc57 , \u0393\ud835\udc62 and \u0393\ud835\udc63 are common neighbors of corresponding nodes \ud835\udc56 , \ud835\udc57 ,\ud835\udc62 and \ud835\udc63 , and \ud835\udefc is a constant.\n3.2.2 Bridge Feature. The second proposed circle feature is bridge, which indicates the number of bridges that share the same circle. See Figure 2. Nodes \ud835\udc63\ud835\udc56 and \ud835\udc63 \ud835\udc57 share 3 circles. Specifically, we give the computation formula for bridge as follows.\n\ud835\udc50 \ud835\udc4f\ud835\udc5f\ud835\udc56\ud835\udc51\ud835\udc54\ud835\udc52\n\ud835\udc56 \ud835\udc57 = \ud835\udc4e\ud835\udc56, \ud835\udc57 + 1 2 tanh(\ud835\udc50) + \ud835\udf0e (\ud835\udc50) \u2212 0.5\n, where \ud835\udf0e is Sigmoid function, and tanh is hyperbolic tangent function, and \ud835\udc50 is number of bridges sharing the same circle that cover nodes \ud835\udc56 and \ud835\udc57 ."
        },
        {
            "heading": "3.3 Graph Self-attention Mechanism",
            "text": "Based on SIEG[22] network, which is constructed with a double tower structure of GCN[10] and Graphormer [23], we propose circle features to stimulate graph self-attention mechanism such that graph transformer can be improved. Specifically, to capture local graph structure information, we introduce the circle features to the transformer attention layer. Formally, we define the attention between two centered nodes as follows.\n\ud835\udc34\ud835\udc61\ud835\udc56 \ud835\udc57 = \ud835\udc44\ud835\udc56\ud835\udc3e \ud835\udc47 \ud835\udc57\u221a \ud835\udc51 + \ud835\udc4f\ud835\udc51\ud835\udc56\ud835\udc60\ud835\udc56 \ud835\udc57 + \ud835\udc4f \ud835\udc5b\ud835\udc62\ud835\udc5a \ud835\udc56 \ud835\udc57 + \ud835\udc53 \ud835\udc34\ud835\udc34 \ud835\udc56 \ud835\udc57 + \ud835\udc53 \ud835\udc3d \ud835\udc4e\ud835\udc50 \ud835\udc56 \ud835\udc57 + \ud835\udc50\ud835\udc60\ud835\udc64\ud835\udc56\ud835\udc5b\ud835\udc54+ \ud835\udc56 \ud835\udc57 + \ud835\udc50\ud835\udc4f\ud835\udc5f\ud835\udc56\ud835\udc51\ud835\udc54\ud835\udc52 \ud835\udc56 \ud835\udc57\n, where \ud835\udc44\ud835\udc56 is the \ud835\udc56\ud835\udc61\u210e row of Query matrix, \ud835\udc3e\ud835\udc57 is the \ud835\udc57\ud835\udc61\u210e row of Key matrix, \ud835\udc51 is the dimension of \ud835\udc44\ud835\udc56 and \ud835\udc3e\ud835\udc57 , \ud835\udc4f\ud835\udc51\ud835\udc56\ud835\udc60\ud835\udc56 \ud835\udc57 is the distance of the shortest path between nodes \ud835\udc56 and \ud835\udc57 , \ud835\udc4f\ud835\udc5b\ud835\udc62\ud835\udc5a\n\ud835\udc56 \ud835\udc57 is the number of the\nshortest path between the two nodes, \ud835\udc53 \ud835\udc34\ud835\udc34 \ud835\udc56 \ud835\udc57 and \ud835\udc53 \ud835\udc3d \ud835\udc4e\ud835\udc50 \ud835\udc56 \ud835\udc57 are the common\nneighbor status with the Adamic-Adar form and the Jaccard form respectively. \ud835\udc50\ud835\udc60\ud835\udc64\ud835\udc56\ud835\udc5b\ud835\udc54+\n\ud835\udc56 \ud835\udc57 and \ud835\udc50\ud835\udc4f\ud835\udc5f\ud835\udc56\ud835\udc51\ud835\udc54\ud835\udc52 \ud835\udc56 \ud835\udc57 are our proposed circle features."
        },
        {
            "heading": "4 EXPERIMENTS AND RESULTS",
            "text": "Below we evaluate the performance of our method on OGB dataset ogbl-citation2[24]."
        },
        {
            "heading": "4.1 Datasets and task",
            "text": "As mentioned before, the ogbl-citation2 dataset is a directed graph, representing the citation network between a subset of papers extracted from MAG [25]. Each node is a paper with 128-dimensional word2vec features [26] that summarizes its title and abstract, and each directed edge indicates that one paper cites another. Each node additionally has meta-information that identifies the year the associated paper was published. Given the citations already present, the aim is to predict missing citations. To be more specific, two references from each source paper are dropped at random, and a model is anticipated to place the two references that are missing higher than potential negative references."
        },
        {
            "heading": "4.2 Baselines",
            "text": "We compare ourmethodCFGwith PLNLP [27], AGDNw/GraphSAINT [28], SEAL [11], S3GRL(PoS Plus)[29], SUREL[30], NGNN + SEAL [31] and SIEG[22]."
        },
        {
            "heading": "4.3 Metrics and settings",
            "text": "The evaluation metric is Mean Reciprocal Rank (MRR), where the reciprocal rank of the true reference among the negative candidates is calculated for each source paper, and then the average is taken over all source papers. The experiments are executed in PyG with Pytorch under the circumstance of Tesla A100 GPU(80G RAM)."
        },
        {
            "heading": "4.4 Experimental Results",
            "text": "For comparison with existing methods, the performance of baseline methods are extracted from the ogbl-citation2 leaderboard and listed in the upper part of Table 1. In the lower part of the table, the results of CFG are figured out by conducting our method CFG ten times in the same environment with the same associated settings. \ud835\udc36\ud835\udc39\ud835\udc3a1 represents the method CFG using the first proposed circle feature swing plus, while \ud835\udc36\ud835\udc39\ud835\udc3a2 represents the one using both the first and the second circle features, namely swing plus feature and bridge feature. CFG beats all of the listed methods. It verifies the effectiveness of CFG model especially on dataset ogbl-citation2."
        },
        {
            "heading": "5 CONCLUSION",
            "text": "In this paper, we propose a Circle Feature aware Graph transformer(CFG) for link prediction task, which can stimulate graph transformer. CFG achieves top 1 performance on dataset ogblcitation2 until submission. The experimental results verify the superiority of CFG. We will optimize transformer self-attention mechanisms with circle features in future work."
        }
    ],
    "title": "Circle Feature Graphormer: Can Circle Features Stimulate Graph Transformer?",
    "year": 2023
}