{
    "abstractText": "In recent years, Gaussian Process (GP) regression has become widely used to analyse stellar and exoplanet time-series data sets. For spotted stars, the most popular GP covariance function is the quasi-periodic (QP) kernel, whose hyperparameters of the GP have a plausible interpretation in terms of physical properties of the star and spots. In this paper, we test the reliability of this interpretation by modelling data simulated using a spot model using a QP GP, and the recently proposed quasi-periodic plus cosine (QPC) GP, comparing the posterior distributions of the GP hyperparameters to the input parameters of the spot model. We find excellent agreement between the input stellar rotation period and the QP and QPC GP period, and very good agreement between the spot decay time-scale and the length scale of the squared exponential term. We also compare the hyperparameters derived from light and radial velocity (RV) curves for a given star, finding that the period and evolution time-scales are in good agreement. Ho we v er, the harmonic comple xity of the GP, while displaying no clear correlation with the spot properties in our simulations, is systematically higher for the RV than for the light-curve data. Finally, for the QP kernel, we investigate the impact of noise and time-sampling on the hyperparameters in the case of RVs. Our results indicate that good co v erage of rotation period and spot evolution time-scales is more important than the total number of points, and noise characteristics go v ern the harmonic complexity.",
    "authors": [
        {
            "affiliations": [],
            "name": "B. A. Nicholson"
        }
    ],
    "id": "SP:a877cd9ef838925afe4a45c4a703b459120f323e",
    "references": [],
    "sections": [
        {
            "text": "MNRAS 515, 5251\u20135266 (2022) https://doi.org/10.1093/mnras/stac2097 Advance Access publication 2022 July 28\nQuasi-periodic Gaussian processes for stellar activity: From physical to kernel parameters\nB. A. Nicholson 1 , 2 \u2039 and S. Aigrain 1 1 Sub-Department of Astrophysics, University of Oxford, Keble Rd, Oxford OX13RH, UK 2 University of Southern Queensland, Centre for Astrophysics, Toowoomba 4350, Australia\nAccepted 2022 July 22. Received 2022 July 20; in original form 2021 November 12\nA B S T R A C T In recent years, Gaussian Process (GP) regression has become widely used to analyse stellar and exoplanet time-series data sets. For spotted stars, the most popular GP covariance function is the quasi-periodic (QP) kernel, whose hyperparameters of the GP have a plausible interpretation in terms of physical properties of the star and spots. In this paper, we test the reliability of this interpretation by modelling data simulated using a spot model using a QP GP, and the recently proposed quasi-periodic plus cosine (QPC) GP, comparing the posterior distributions of the GP hyperparameters to the input parameters of the spot model. We find excellent agreement between the input stellar rotation period and the QP and QPC GP period, and very good agreement between the spot decay time-scale and the length scale of the squared exponential term. We also compare the hyperparameters derived from light and radial velocity (RV) curves for a given star, finding that the period and evolution time-scales are in good agreement. Ho we v er, the harmonic comple xity of the GP, while displaying no clear correlation with the spot properties in our simulations, is systematically higher for the RV than for the light-curve data. Finally, for the QP kernel, we investigate the impact of noise and time-sampling on the hyperparameters in the case of RVs. Our results indicate that good co v erage of rotation period and spot evolution time-scales is more important than the total number of points, and noise characteristics go v ern the harmonic complexity.\nKey words: methods: data analysis \u2013 techniques: photometric \u2013 techniques: radial velocities \u2013 stars: activity.\n1\nG p a b r r H m b o 2 n s\nf f p ( t a W w h\nb R\ns t s H b p s ( n r o w m\ns fi n i i p i t\n\u00a9 P C p\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024 I N T RO D U C T I O N aussian Process (GP) regression has become an increasingly opular method for analysing stellar activity signals in photometric nd radial velocity (RV) time-series data. In particular, GP models ased on quasi-periodic kernel functions are able to reproduce the otationally modulated signatures of evolving magnetically active egions remarkably well (see e.g. Aigrain, Pont & Zucker 2012 ; aywood et al. 2014 ; Angus et al. 2018 ). Quasi-periodic GP odels have been applied extensively to stellar time-series data, oth to mitigate the impact of stellar activity on planet detection r characterization (see e.g. Haywood et al. 2014 ; Barclay et al. 015 ; Grunblatt, Howard & Haywood 2015 ; Rajpaul et al. 2015 , and umerous later references), and to study stellar activity signals per e (see e.g. Angus et al. 2018 ; Barrag \u0301an et al. 2021 ).\nThere are many ways to construct a quasi-periodic kernel function or a GP model, but one such kernel has become especially popular or modelling stellar activity signals, to the extent that, in the exolanet community, it is often referred to simply as the Quasi-Periodic QP) kernel. The QP kernel is constructed by multiplying a periodic erm, consisting of the exponential of a sine-squared function, with decaying envelope, consisting of a squared exponential function. ith only four parameters, this kernel function can produce signals ith different amplitudes, periods, evolution time, and degree of armonic complexity. Random samples drawn from a QP GP prior\nE-mail: belinda.annette.nicholson@gmail.com\n( t c\nThe Author(s) 2022. ublished by Oxford University Press on behalf of Royal Astronomical Society. Th ommons Attribution License ( https://cr eativecommons.or g/licenses/by/4.0/), whi rovided the original work is properly cited.\near a striking resemblance to observed stellar light curves (see e.g. ajpaul et al. 2015 ). A QP kernel is not always the best choice of kernel to model tellar activity signals. For example, Gilbertson et al. ( 2020 ) show hat simpler, a-periodic kernels can in some circumstances perform omewhat better in terms of activity mitigation in RV time-series. o we ver, the QP kernel explicitly encodes the commonly held elief that the underlying signal should be quasi-periodic, even if its eriodic nature is not necessarily apparent in noisy and/or sparsely ampled data. Furthermore, most of the parameters of the QP kernel known as the hyperparameters, or HPs, of the GP) admit a fairly atural interpretation in terms of the physical properties of the active egions, such as their rotation rates and lifetimes. The primary goal f this study is to investigate, using simulated data, the extent to hich this \u2018natural\u2019 interpretation is robust and can be used to guide odelling decisions. Observed light and RV curves of active stars often contain ignificant power not only at the stellar rotation period, but at its rst few harmonics (see e.g. Aigrain et al. 2012 ), a feature which is ot naturally reproduced by the standard QP kernel. Consequently, n recent years a number of other quasi-periodic kernels have been nv estigated, which e xplicitly generate power at half the rotation eriod, including the \u2018QP plus cosine\u2019 (hereafter QPC) kernel ntroduced by Perger et al. ( 2021 , hereafter P21 ), given by equaion ( 2 ), and the \u2018rotation term\u2019 implemented in the CELERITE package F oreman-Macke y et al. 2017 ). After experimenting with both of hese, we decided to include the former in this study. Achieving onvergence with, and robustly interpreting the parameters of, GP\nis is an Open Access article distributed under the terms of the Creative ch permits unrestricted reuse, distribution, and reproduction in any medium,\nM\nm c\nu p m L f o d b o\np A p n h f e C 2 d d t r w b\nw w c t v\nf i d e i a d b s t v d t a f d o c e o a F ( a s d e\nt i\nt m t p o d o t o r a r i f\nw t f t e c S a fi\n2 M\nG c G h d e s p s t b\n2\nI m s e\nk\nw c t t d d G a\np\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\nodels based on the CELERITE rotation term is somewhat more hallenging with our model data, and we defer that to a separate paper.\nWhile GP models using the QP and QPC kernels provide a seful description of common observables, they are still very much henomenological. A more physically moti v ated family of GP odels for active star light curves was recently introduced by uger, F oreman-Macke y & Hedges ( 2021 ). Their STARRY-PROCESS ramework places a GP prior on the distribution of active regions n the stellar surface, which is described using a spherical harmonic ecomposition. Ho we ver, this relati vely ne w approach has not yet een widely used, nor has it been extended to RV data, placing it utside the scope of this work. The fact that a QP GP can be used to reco v er stellar rotation eriods from light curves has already been demonstrated (see e.g. ngus et al. 2018 ). Ho we ver, the behaviour of the other HPs, in articular the parameter controlling the evolution of the signal, has ot yet been investigated in detail. A number of recent studies ave shown that it is possible to measure active region lifetimes rom photometry, for example by fitting a function to the decaying nvelope autocorrelation function (ACF) of the light curve (Giles, ollier Cameron & Haywood 2017 ; Basri et al. 2021 ; Santos et al. 021 ). These studies have shown that, provided the light-curve uration significantly exceeds the active region lifetime, the ACF ecay time is roughly proportional to the active region lifetime, but he constant of proportionality is not unity. We would expect the esults obtained with a GP model, which ef fecti vely is a more direct ay of modelling the covariance, to be consistent with those obtained y fitting the ACF, but this has yet to be demonstrated. P21 analysed simulated RVs with four different spot distributions\nith GP models using QP, QPC, and CELERITE rotation kernels. They ere able to reco v er the input spot evolution time, but their study\nonsidered only a single value of the rotation period and evolution ime. In this work, we extend this to a much broader parameter space, arying the rotation period, spot lifetime, and number of spots.\nA common application of the QP GP is in filtering stellar activity rom RV time-series. When following up planet candidates detected n transit, it is common practice to \u2018train\u2019 the GP on the light-curve ata first (see e.g. Haywood et al. 2014 ; Rajpaul et al. 2015 ; Fulton t al. 2018 ). The posterior distribution o v er the HPs of the QP GP s then used as a prior for the RV analysis. Ho we ver, this may not l w ays be advisable, for two distinct reasons. First, the photometric ata, if available, is rarely contemporaneous with the RVs, and can e taken months or even years apart. Using a 70-yr compilation of olar irradiance data, Kosiarek & Crossfield ( 2020 ) showed that all he HPs of a QP GP fit to the light curve of a Sun-like star can ary significantly o v er the solar c ycle. This implies that it may be angerous to train a QP GP on light-curve data before applying it o RV data, if the two were taken too far apart. Furthermore, their nalysis of simultaneous SORCE photometry and HARPS-N RVs ound consistent periods and evolution time-scales, but significant ifferences in the length scale parameter that controls the complexity f the signal within a period (often referred to as the harmonic omplexity). This effect was also seen in simulated data by Barrag \u0301an t al. ( 2022 ). It is related to the fact that the RV variations depend not nly on the projected area of the active regions and their contrast, but lso on their local line-of-sight velocity. This underpins the so-called Fprime framework for predicting RV variations from photometry Aigrain et al. 2012 ), as well as latent variable models where RVs re modelled jointly with activity indicators extracted from the same pectra, as linear combinations of an underlying GP and its time eri v ati ve(s) (see e.g. Rajpaul et al. 2015 ; Jones et al. 2017 ; Delisle t al. 2022 ). Ho we ver, as it is still quite common in the literature\nNRAS 515, 5251\u20135266 (2022)\no model RVs alone using a QP GP trained on photometry, it is mportant to test the robustness of this approach.\nIn this work, we first use a simple spot model to simulate simulate ightly sampled, noise-less photometric and RV time-series, and then odel each independently with a QP or QPC GP. This allows us to est the extent to which the HPs of these models relate to the physical arameters of the simulations, and how closely the results based n photometry match each other. Doing this using highly idealized ata enables us to explore the differences between these two types of bservations at a fundamental lev el, remo ving the effects of noise and ime-sampling. As a second step, we then degrade the time-sampling f the RV data, and add white noise, to make the simulations more ealistic (since RV observations are typically ground-based). This llows us to investigate how time-sampling in particular affects the eco v ery of the GP HPs, in the case when space-based photometry s not available (i.e. for \u2018pure RV\u2019 surv e ys, rather than for transit ollow-up).\nThe remainder of this paper is organized as follows. In Section 2 , e define the QP and QPC kernels used in this work, and fit simulated ime-series generated from the GP prior itself. This allows us to test or degeneracies inherent to the GP models. In Section 3 , we define he spot model used to simulate stellar light and RV curves, and xamine the properties of the HPs obtained from the simulated light urves. The GP fits to the idealized RV data sets are discussed in ection 4 , and the effect of degrading the time-sampling of the RVs re explored in Section 5 . Finally, we summarize and discuss the ndings of this work in Section 6 .\nQUASI -PERI ODI C GAUSSI AN PROCESS O D E L S\nP regression is a powerful and flexible method for analysing data ontaining correlated noise. Rather than fitting a function to data, P regression instead fits the correlation between data points. At its eart, a GP is defined by its kernel covariance function, k , which escribes the extent to which two observations are correlated with ach other, usually as a function of their distance in some input pace (for time-series, the time interval separating them). For the urpose of modelling stellar activity signals in astronomical timeeries, a quasi-periodic covariance function is commonly chosen. In he most general sense, a quasi-periodic kernel is usually obtained y multiplying a periodic term with a decaying envelope.\n.1 The quasi-periodic kernel\nn the standard QP kernel most commonly used for stellar activity odelling, the periodic term is given by the exponential of a sinequared function, while the evolution is described by a squared xponential term. Formally, the QP kernel is defined as:\nQP ( t , t \u2032 ) = A exp [ \u2212 sin 2 (\u03c0 ( t \u2212 t \u2032 ) P ) \u2212 ( t \u2212 t \u2032 ) 2 2 l 2 ] , (1)\nhere A is the variance, is the scale factor (termed \u2018harmonic omplexity\u2019), and P the period of the sine-squared term, and l is he \u2018evolution time-scale\u2019 of the squared exponential term. These erms are referred to as the \u2018hyperparameters\u2019 of the GP so as to ifferentiate this process from fitting a parametric function to the ata. For further information of the quasi-periodic kernel GP and on P\u2019s in general, we refer the reader to Rasmussen & Williams ( 2006 ) nd Roberts et al. ( 2013 ). The QP GP used in this work is implemented using the GEORGE ython package (Ambikasaran et al. 2015 ) by combining the EX-\nP T a d \u2018 c f d\n2\nP c s s o a t\nw k c t\na\n2\nT p a T s w v t t s\nt c p c 2 w i l\np u M t e w d i w\nTable 1. Priors placed on the parameters and QP GP hyperparameters for the MCMC fit of the sample curves drawn from sets of QP GPs.\nInput Parameter Prior a\nln ( A ) U [ \u221230 , 30] ln ( P ) U [ \u221215 , 15] U [0 , 15] ln (2 l 2 ) U [ \u221230 , 30] Mean U [ \u221215 , 15] Note. a U [ a, b] refers to uniform priors between a and b .\nw e t n 1 a r a s p 5 p\nh b p t a p v s a a a t a c\nf a a s p f a v l w w l r t c\n3 C\nI s p\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\nSINE2KERNEL and EXPSQUAREDKERNEL built-in kernel functions. he GEORGE kernels use the hyperparameters values in natural log s input, with the exception of the term, and reparameterize the enominator of the squared exponential term as m = 2 l 2 , called the metric\u2019. We also solve for the mean function of the data, in this ase a constant, as this reflects the practice of fitting underlying unctions (such as a Keplerian orbit in the case of RVs) to the ata.\n.2 The quasi-periodic plus cosine kernel\n21 introduced the idea of adding a cosine term to the periodic omponent of the QP kernel, with a period equal to half that of the ine-squared term, to better handle cases where the distribution of pots on the stellar surface gives rise to signal the first harmonic f the stellar rotation period (evidenced by a secondary peak in the utocorrelation function at half the rotation period). Mathematically, his \u2018Quasi-Periodic plus Cosine\u2019 (QPC) kernel is defined as:\nk QPC ( t , t \u2032 ) = A exp [ \u2212 ( t \u2212 t \u2032 ) 2\n2 l 2\n] \u00d7\n( exp [ \u2212 sin 2 ( \u03c0 ( t \u2212 t \u2032 )\nP\n)] + f cos ( 4 \u03c0 ( t \u2212 t \u2032 )\nP\n)) , (2)\nhere A , , P , and l retain the same definitions as in the QP ernel, and we have introduced an additional hyperparameter f , which ontrols the amplitude of the cosine term relative to the sine-squared erm. As f tends to zero, the behaviour of k QPC tends to that of k QP .\nIn this work, we define this kernel again in GEORGE by with the ddition of a COSINEKERNEL term to our GEORGE QP kernel.\n.3 Exploring inherent degeneracies in the hyperparameters\nhe first step in assessing the ability of a GP to reco v er physical arameters of a star is to investigate the stability of the GP fit itself nd e xplore an y inherent de generacies in fitting a QP or QPC kernel. o test this, we generate a number of \u2018light curves\u2019 by drawing amples from our GP prior, and fit these sample curves to see if e reco v er the input GP hyperparameters. This step also serv es to alidate our fitting and posterior exploration procedure. The bulk of his analysis was carried out using the QP kernel, but we also discuss he QPC kernel and its extra hyperparameter towards the end of the ection.\nOur sample curves were generated o v er a range of hyperparameers, with 20 sample curves per set of hyperparameters. Each sample urve spans 100 d, with a sampling of three, evenly spaced points er day, and a fixed amplitude of 1. The grid of hyperparameters ontain period values of 2, 10, 30, and 60 d, values of 0.5 and and l values of a 1, 3, and 10 times the period. These values ere chosen as they represent the range of values typically found n the analysis of stellar light curves across a range of activity evels.\nMarkov Chain Monte Carlo (MCMC) was used to sample the osterior distribution of the hyperparameters for each sample curve, sing the EMCEE python package (F oreman-Macke y et al. 2013 ). The CMC was set up with 80 walkers in a Gaussian distribution about he sample curve input values, with a broad uniform prior used for ach hyperparameter across all sample curves (see Table 1 ). There as an initial burn in of 100 steps, from which a tight Gaussian istribution around the highest probability state was used to renitialize the w alk ers. The main MCMC w as then run until the alk ers had converged on a solution or a maximum of 8000 iterations\nas reached. The convergence of the MCMC walkers was checked very 100 steps, and a sample was deemed to have converged if he autocorrelation length of all chains was more than 60 times the umber of elapsed iterations and had not changed by more than per cent in the last 100 steps. For each of the MCMC solutions \u2018burn-in\u2019 of twice the maximum chain autocorrelation length was emo v ed, and the chains were thinned by half the minimum chain utocorrelation length to ensure an unbiased sample. The optimum olution for each hyperparameter was taken as the median of the osterior distribution, and the uncertainty as difference between the 0th and 16th percentile for the lower bound and the 84th and 50th ercentile for the upper. Fig. 1 sho ws ho w closely the input values of the period (leftand panel), l (middle), and (right-hand panel) were reco v ered y the GP, relative to the uncertainties calculated from the MCMC osterior distributions. Performing a Kolmogoro v\u2013Smirno v test on he distribution of (input\u2013output)/uncertainty for each of period, l nd , we find D statistic values of 0.081, 0.068, and 0.058, and values of 0.016, 0.071, and 0.18, respectively. The D statistic alues are close to 0 (normal distribution), and the p values are not ignificant enough to reject the null hypothesis that these distributions re drawn from a standard normal distribution. In other words, ll three distributions are consistent with a Gaussian with a mean round zero and a standard deviation of 1. This means that, within he limits of statistical uncertainty, the QP GP is non-degenerate nd stable: the parameters that go in are the parameters that will ome out.\nWe then tested in the same manner a set of light curves generated rom a QPC kernel. The input values for P , , and l were the same s in the QP case. We tested two values of f , 0.1 and 0.9, and adopted uniform prior on log ( f ) between log (10 \u22124 ) and 0 when fitting the amples. We find the same results for period, l and as with the ure QP case: the input hyperparameters are all well-reco v ered. The raction term, f , was only reco v ered in sev en cases within 3-sigma, ll of which had high f . Fig. 2 shows histograms of the reco v ered f alues for the low (solid) and high (hatched) input values. For the o w v alues of f , the QPC GP reco v er reco v ers the f values, but not as ell as it does for the other parameters. The high- f value cases are not ell reco v ered, despite these cases all having well reco v ered period, and values. As seen in 2 , the reco v ered f for these high- f cases ange from 0.2 to 0.9, with a median value of 0.7. This indicates that he QPC GP is only weakly sensitive to the true fraction term on the osine component.\nM O D E L L I N G SPOTTED STAR L I G H T U RV E S WI TH QUASI-PERIODIC G P S\nn this section, we describe how we simulate light curves for rotating tars with evolving active regions, and then fit them with quasieriodic GPs using the kernels described in Section 2 .\nMNRAS 515, 5251\u20135266 (2022)\nM\nFigure 1. Reco v ery of input QP GP hyperparameters: each panel shows a histogram of the difference between the input and output parameter v alues di vided by the uncertainty of the output solution for each of the varied hyperparameters: Period ( P , left-hand panel), length scale ( l , middle), and harmonic complexity ( , right-hand panel).\nFigure 2. Histograms of the reco v ered cosine term fraction f from a QPC GP for sample curves drawn from a QPC GP with a high f value of 0.9 (hatched), and low f value of 0.1 (solid).\n3\nT c a 2 r e i R\nt r p a o w s T f f\n1\nTable 2. Stellar model input parameter distributions.\nParameter Parameter range (uniform distribution)\nAverage spot number, N Spot 0 < log 10 ( N Spot ) < 2 Stellar rotation period, P rot 0 < log 10 ( P rot ) < 2 Spot decay timescale, \u03c4 1 P rot < \u03c4 < 10 P rot Spot longitude, \u03c6 0 < \u03c6 < 2 \u03c0 Spot latitude, \u03b8 0 < sin ( \u03b8 ) < 1 Spot maximum area, A max \u22123 \u2264 N Spot log 10 ( A max ) < \u22122\nb a p o s \u03b8 s 2 t s A t g o l l d a\n3\nW n d r\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\n.1 Simulating spotted star light cur v es o test the correlation of the QP GP hyperparameters with physical haracteristics of a star, we generate 100 simulated light curves using simple spot model implemented in the PySpot package 1 (Aigrain 021 ), which is a simplified version of the model used in the Kepler otation and differential rotation blind e x ercise presented in Aigrain t al. ( 2015 ). We first define the parameters of the star and the spots n each simulation, then use these simulations to produce light and V curves. All simulations last T = 250 d, with two equally spaced observa-\nions per day, and all the stars are seen equator on, and have the same adius as the Sun. For each simulation, we draw the stellar rotation eriod, P rot , the average number of spots present on the stellar surface t any given time, N Spot , and the ratio of the characteristic lifetime f the spots to the rotation period, \u03c4 / P rot , from random distributions hich are listed in Table 2 . Each spot grows exponentially, peaks in ize at a specific time and size, and then decays again exponentially. he times at which the spot sizes peak were drawn at random times rom \u2212T to 2 T . This is to a v oid a situation where, particularly or long lifetimes, the spot co v erage is systematically lower at the\nNRAS 515, 5251\u20135266 (2022)\nSee https:// github.com/saigrain/ pyspot.\nT l d\neginning and end of the simulation than in the middle. The spots are ssumed to be perfectly dark (contrast of 1 with respect to the stellar hotosphere) and their peak sizes A max range from 0.1 to 1 per cent f the visible hemisphere. The spots are randomly distributed on the tellar surface (uniform distribution in longitude, and in sin ( \u03b8 ) where is spot latitude). This is not particularly realistic, but limiting the pots to specific latitude bands (as done for example in Aigrain et al. 015 ) would not significantly alter the results of this study, because he stars are seen equator-on. After reaching its peak size, each pot decays according to an exponential with half-life \u03c4 . Following igrain et al. ( 2015 ), the spots grow five times more rapidly than hey decay (though we also performed some simulations with equal rowth and decay time, to see if this has an effect on the reco v ery f the spot lifetime, as discussed in Section 3.3.2 ). We then simulate ight curves using the analytic spot model of Dorren ( 1987 ), using a inear limb-darkening law with u = 0.5. Only idealized, noise-free ata were considered in this study, so the simulated fluxes have no ssociated uncertainties.\n.2 Fitting the light cur v es using a GP\nhen analysing a light curve simulated using a spot model, the GP is o longer the \u2018correct\u2019 model. Although the QP and QPC GP kernels escribed in Section 2 are very flexible, samples from GPs cannot eproduce the simulated light curves exactly (to machine precision). o account for this, we include a jitter term when modelling the ight curves with the QP and QPC GPs. This jitter term absorbs any eviations between the simulated observations and the GP model. In\nTable 3. Priors placed on the parameters and QP GP hyperparameters for the MCMC fit of the model time-series data.\nInput (hyper)parameter Prior a\nln ( A ) U [ \u221230 , 30] ln ( P ) U [ log ( max [2 T min , 1]) , T max ] b U [0 , 15] ln (2 l 2 ) U [ \u221230 , 30] Mean U [ \u221215 , 15] ln (J) U [ \u221220 , 20] Note. a U [ a, b] refers to uniform priors between a and b . b T max and T min refer to the maximum and minimum length of time between data points within a given time-series.\nFigure 3. The top panel compares the input stellar rotation period to the output QP GP period (both in natural log) for the model light-curve data, with the unity relation indicated by the grey dashed line. The bottom panel shows the residuals to the unity relation, with axes scaled to exclude the larger outliers so as to more clearly show the scatter around the zero (grey dashed line).\np d h T f\nT G v l m 1 a c d\nC ( f r d\no w i a w a\nt t t c d t i a t t a t p i I t s\n3\nF t u p f a o s\n3\nA o t m v r t\ni t o i t t r\n3 t\nF l h t\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\nractice, a jitter term is included by adding a constant value J to the iagonal of the covariance matrix. We fit for J alongside the other yperparameters, resulting in more robust uncertainties on the latter. he full set of parameters and GP hyperparameters that are solved or, and their associated prior distributions are given in Table 3 . Initial guesses for each hyperparameter were defined as follows.\nhe GP period P was set to the stellar rotation period P rot , and the P length scale l to the spot decay time-scale \u03c4 . The GP mean and ariance A were set to the sample mean and variance of the simulated ight curve. Since there is no single parameter of our stellar spot odel that relates directly to , we adopt an initial guess of = across all models. This value marks the transition between high nd low harmonic complexity cases (Barrag \u0301an et al. 2022 ), and was hosen because it allows easy exploration of parameter space in either irection. The optimum GP hyperparameters were found using Markov\nhain Monte Carlo (MCMC) with the python package EMCEE F oreman-Macke y et al. 2013 ). The MCMC was run with 80 walks or to a maximum of 10 000 steps, unless the convergence was eached sooner. MCMC analyses struggle with \u2018perfect\u2019, error-free ata, so to help with convergence we specify a small uncertainty\nf 10 \u22124 for the simulated data. The convergence of the MCMC alk ers w as check ed and measured using the same method outlined n Section 2.3 . For the solutions that met this convergence criteria, \u2018burn-in\u2019 of twice the maximum chain autocorrelation length as remo v ed, and the chains were thinned by half the minimum utocorrelation length. Given their greater complexity compared to the GP sample curves, he posterior distribution of the GP analysis of the light curves conains more local minima in which w alk ers can get \u2018lost\u2019. We mitigate his in two ways: First we set the walkers to follow a weighted ombination of differential evolution (80 per cent probability) and if ferential e volution snooker (20 per cent probability) mo v es, as his is suited for multimodal posterior distributions. Secondly, we mplement a three stage burn in: the MCMC was run for 300 iterations nd then reinitialized from the highest probability solution, repeating wice before the main MCMC run. If by the end of the main run here was not a converged solution for any of the reasons outlined bo v e, a \u2018burn in\u2019 of 5000 steps was remo v ed from the start of he chains, the same test for convergence run again. If a solution assed, the same procedure for thinning and removing the \u2018burnn\u2019 was used as for the MCMC solutions that converged normally. f the solution still failed convergence, then no further burn-in or hinning was applied and a flag allocated to note it as a non-converged olution.\n.3 Results\nor all converged MCMC solutions, the final value was taken as he median value of the posterior distribution, and we estimate an ncertainty by calculating the difference between the 50th and 16th ercentile for the lower bound, and the 84th and 50th percentile or the upper. Any non-converged solutions were excluded from the nalysis below. See Appendix A for further discussion on the handful f model light curves for which the QP GP did not converge to a single et of solutions.\n.3.1 Stellar rotation period and QP GP period\ncomparison between the stellar model rotation periods and the utput QP GP period is shown in Fig. 3 . As seen in the top panel, he QP GP reco v ers the stellar rotation period for all but one of the odel light cures. For the two outlier points, the recovered period alues are approximately a half and a tenth of the input model stellar otation periods, owing to the particular distribution and evolution of he spots creating signals at those periods.\nThe bottom panel shows the residuals of the GP period from the nput model rotation period, excluding the outlier point to better see he scatter about zero. This scatter around zero (perfect reco v ery f the rotation period) is evenly distributed above and below, and ncreases for shorter rotation periods. This increased scatter is due to he finite sampling, with the longer periods being better sampled by he two points per day in our model light curve, and hence are better eco v ered by the GP.\n.3.2 Stellar spot evolution time, \u03c4 , and QP GP evolution ime-scale, l\nig. 4 compares spot evolution time-scale, \u03c4 , of the model stellar ight curves with the QP GP length scale, l . The grey dashed line ighlights the 1:1 correlation, the purple vertical dashed line shows he total time span, T, of the model light curves of 250 d, and the\nMNRAS 515, 5251\u20135266 (2022)\nM\nFigure 4. This figure compares the input stellar model spot evolution time, \u03c4 , to the solutions QP GP evolution time-scale, l , for the set of model light curves (top panel), the residuals (middle), and the residuals with y-axis adjusted to highlight features at smaller \u03c4 (bottom). The grey dashed line indicates the unity relation, and the vertical dashed lines indicate the total (purple, T), half (green, T/2) and sixteenth (blue,T/16) time span of the data.\ng t\nt o m \u03c4 s T a i\ns o w g a s l i f s w s i a\nFigure 5. Same as Fig. 4 (direct comparison of values in the top panel, and residuals from the unity relation in the bottom panel), but for stellar models with equal spot emergence and decay times.\nc s\n3\nT p e t p t c s r\nr f p h\nd w a\nn A t i l b f\nv t l w m t\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\nreen and blue vertical dashed lines indicate a half and sixteenth of he time span, respectively. These results show a strong correlation between the spot evolution ime-scale and the QP GP length scale hyperparameter. In the case f the specific way we have defined the spot behaviour in our stellar odels, this is nearly a 1:1 relation, particularly at smaller values of . The deviation from 1:1 reco v ery increases with increasing timecale \u03c4 as the values of \u03c4 approach the total time-span of the data, . The QP GP length scale underestimates \u03c4 for values of \u03c4 between pproximately T/16 and T/2, past which the GP o v erestimates \u03c4 with ncreasing scatter beyond \u03c4 greater than the time span of the data.\nIn the stellar models used for this work, the spots emerge on the tellar surface five times faster than they decay, a choice moti v ated by bservations of spot emergence and decay times on the Sun. To see hether this has an impact on the reco v ered QP GP length scale, we enerated another set of simulated light curves with equal emergence nd decay times, and modelled them in the same way. The results are hown in Fig. 5 . Comparing this to Fig. 4 , the scatter around the 1:1 ine is smaller for equal emergence and decay times. Again we see ncreasing scatter with increasing \u03c4 , but this only becomes marked or values of \u03c4 approximately equal to or greater than the total time pan of the data set (purple dashed line). This result is unsurprising: hen spot emergence is much faster than decay, the light curves are till dominated by changes occurring on the spot decay time, but this s occasionally perturbed by the emergence of a large spot causing significant change on a much more rapid time-scale. This is more\nNRAS 515, 5251\u20135266 (2022)\nhallenging for our GP model, which has a single evolution length cale, to reproduce.\n.3.3 Stellar model parameters and QP GP harmonic complexity,\nhere is no intuitive physical interpretation for the harmonic comlexity QP GP hyperparameter, so we examine how this hyperparamter behaves across all the input stellar model properties. Fig. 6 shows he solutions for the QP GP with total spot number, stellar rotation eriod, spot evolution time-scale, and the ratio of spot evolution time o the stellar rotation period. We calculate Pearson product-moment orrelation coefficients of \u22120.36 with total spot number, 0.66 with tellar rotation period, 0.62 with spot evolution, and 0.12 with the atio of spot evolution time to stellar rotation period.\nSince the term go v erns how comple x the curve is within one otation period, the correlation with stellar rotation period results rom longer period light curves being better sampled within one eriod, and so more complex behaviour can be resolved, giving a igher value for gamma. The correlation with evolution time, however, is spurious, as emonstrated by the bottom panel. By dividing through by the period, e remo v e all correlation of the evolution time-scale with Gamma: t any given period, there is no correlation between \u03c4 and . The slight, though not significant, correlation with total spot umber is likely due to the difference in distribution of spots (see e.g. igrain et al. 2015 ), which occurs when there are very few compared o many spots on the stellar disc. Given the uniform distribution mposed on the spot latitudes across all stellar models, models with a arge number of spots will have an equally uniform spot distribution, ut asymmetries in spot distribution will occur when there are very ew spots.\nAnother influence in the outcome of these results are the input alues and prior distributions used. Unlike the other hyperparameters hat have initial values derived from the properties of the individual ight curv es, is giv en a starting value of 1 for all light curves. The alk ers thus have further to explore to find an optimum solution, and ay become \u2018stuck\u2019 in a local preferred solution instead of finding he global optimum solution. Ho we v er, as e xplained in Section 3.2 ,\nFigure 6. Light-curve MCMC solutions for the QP GP harmonic complexity, , against the input stellar model parameters of total spot number, stellar rotation period, spot evolution time-scale, and the ratio of the spot evolution time-scale to the stellar rotation period.\nt m t w t f t a\nFigure 7. This figure compares the QP and QPC solution for ln (Period). Figure description is same as Fig. 3 .\n3\nT M c Q t e\nt h\ni r a e i h p h m o\na s u s\na l l 2 b M c s\np s\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\nhis is mitigated by the multiple burn-in stages and setting a high aximum number of iterations to allow time for the w alk ers to find he best solution. The clustering of points near = 15 is a result of the alk ers reaching the upper bound of the uniform prior. Increasing his bound, ho we ver , does not change this behaviour , as it results rom the GP trying to fit every small feature of the data that are due o the high-cadence sampling. This demonstrates the need for having reasonable upper bound on so as to prevent overfitting the data.\n.4 QPC versus QP GP analyses of light curves\nhe same analysis was repeated with the QPC kernel, with the same CMC framework and convergence criteria. There were two nononverged solutions, one of which had also failed to converge in the P case (see Appendix A for further discussion). When comparing he two analyses, all models that had a non-converged solution in ither QP or QPC GP analyses were remo v ed.\nFigs 7 , 8 , and 9 show the comparison between the hyperparameters hat are common to the QP and QPC kernels. Across all three yperparameters the values QP and QPC values are almost identical.\nFor period, the agreement between the QP and QPC solutions s e xcellent, ev en at shorter period where scatter between the input otation period and output QP GP period is higher. Additionally, there re one fewer outliers in the QPC kernel results. The QPC kernel is xpected to better handle P/2 aliases in the data, but this is not seen n this case. The outlier in the QP case at \u223c0.5 P remains an outlier ere, and has been underestimated ever further to \u223c0.1 of the rotation eriod. The outlier that was at \u223c0.1 P in the QP case, on the other and, has converged to the input rotation value in the QPC case. The odels with that are the largest outliers in period are also the largest utliers in l and . The results for evolution time-scale l between the QP and QPC nalyses are also in excellent agreement. They show increasing catter at longer l , though all agree within the MCMC solution ncertainties. This scatter begins to increase at T/2, and increases ignificantly past T, as seen most clearly in bottom panel of Fig. 8 .\nFig. 9 demonstrates the excellent agreement between the QP nd QPC solutions for . In particular this is highlighted in the ower panel of this figure, which has been scaled to exclude the argest residuals and better see this scatter about zero. Abo v e \u223c (and ignoring the points clustered at the edge of the uniform prior oundary values of 15), the scatter in the values is smaller than the CMC uncertainties. Within those uncertainties, all residual points an be said to fall on zero, although all QPC points are systematically lightly larger than the QP values.\nThe near identical results seen between the QP and QPC kernels resented abo v e can be e xplained by the distribution of f values. As hown in Fig. 10 , all but a few of the converged solution have solution\nMNRAS 515, 5251\u20135266 (2022)\nM\nFigure 8. This figure compares the solutions of the QP and QPC GP evolution time-scale, l . Figure description is same as Fig. 4 .\nFigure 9. Top panel of this figure compares the QP and QPC kernel solutions for the harmonic complexity, , with grey dashed line indicating the unity relation. Bottom panel shows the residuals around the one-to-one relation, with y-axis scaled to exclude the four largest outliers.\nf b r o a t\nFigure 10. This figure shows a histogram of the fraction of cosine component, f , values for the QPC GP for our model light curves.\nt s h\n4 T\nI f s e w a p l i\na s s b p t e\nh t s p h d R w\n4\nT c G g s p G s\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\nor f that are very small and tend towards zero. As such, these GPs are ehaving more like the QP kernel, and hence giving near identical esults for period, l and . This is surprising, as more than a third of ur model curves have some signal at half the rotation period (seen as peak in their autocorrelation function at P/2), and thus are expected o have values of f greater than zero. It is possible that the cosine\nNRAS 515, 5251\u20135266 (2022)\nerm in the QPC kernel only requires a small amplitude to have a ignificant effect, but our results may also indicate that QP GP alone andles signals at P /2 almost as ef fecti vely as the QPC kernel."
        },
        {
            "heading": "APPLYI NG T H E Q P K E R N E L TO M O D E L RV",
            "text": "IME-SERIES\nt is common practice to use photometric data to inform the priors or QP GP analyses of RV data, often used to mitigate stellar activity ignals in the search for Keplarian signals from exoplanets. To xplore how the hyperparameters of a QP GP fit to photometric data ill compare to that of RV data, we use the same spot models used bo v e to compute RV time-series using the following, very simple rocedure (Aigrain et al. 2012 ): at each time-point, we compute the ocal RV of the stellar surface at the centre of each spot, and multiply t by the spot\u2019s contribution to the light curve (in relative flux units).\nThe resulting RV time-series have the same sampling and duration s the light curves. While they are not representative of real RV data ets, which are typically ground-based and have much sparser timeampling, we use these RV simulations to explore the differences etween the hyperparameters of the QP GP models trained on the hotometric and RV time-series. The impact of the difference in ime sampling between space and ground based observations will be xplored separately in Section 5 .\nThe same MCMC procedure was used to find solutions for the yperparameters of a QP GP applied to the RV time-series, and he treatments of non-converged solutions was the same. The two tellar models that gave multimodal (non-converged) solutions in the hotometric data, had converged, single solutions in the RVs, and a andful of the stellar models that had converged solutions for the LC ata had non-converged solutions here. To best compare the LC and V results, all models that non-converged solutions in either analysis ere remo v ed.\n.1 RV versus light-curve period\nhe comparison of the solution to the QP GP period from light urv e v ersus RV data is shown in Fig. 11 . The top panel plots the P solution for the light curve against those of the RVs, with the rey dashed line showing the unity relation, and the bottom panel hows the residuals from this, excluding the outlier seen in the upper anel results from the underestimated period of one light curve QP P solution. The period solutions for the RV QP GP shows no uch outliers, and reco v er well the model stellar rotation periods.\nFigure 11. The top panel compares the output QP GP period (in natural log) for the radial velocity (RV) data with the light-curve (LC) data, with the unity relation indicated by the grey dashed line. The bottom panel shows the residuals to the unity relation, with axes scaled to exclude the larger outliers and more clearly show the scatter around the zero (grey dashed line).\nFigure 12. This figure compares the solutions QP GP evolution time-scale l for model light curves (LC) with the solutions for the radial velocity (RV) data. The grey dashed line indicates the unity relation, and the purple vertical dashed lines indicate the total time span of the date of 250 d.\nT p O i\n4\nF s d d l\nFigure 13. The RV reco v ered harmonic complexity term ( ) of the QP GP, versus that from the light-curve (LC) data. The unity relation is shown by the grey dashed line.\na t\n4\nF h l Q c m s s r o\nb a\n4\nW a t c d f\nm t e t\nF t t s\nt w s\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\nhe lower panel show a greater scatter in the residuals for shorter eriods, reflecting the scatter seen in the light-curve GP solutions. v erall, the light curv e and RV QP GP solutions for the period are n excellent agreement, both reflecting the stellar rotation period.\n.2 RV versus light curve l\nig. 12 compares the QP GP length scale solution from RV timeeries versus the solution from model light-curve data, with the grey ashed line indicating the unity relation, and the vertical purple ashed line showing the total time span of the data of 250 d. The ight curve and RV solutions are in good agreement, but differ more\nt larger length scale, particularly for those length scales greater than he time span of the data.\n.3 RV versus light-curve\nig. 13 compares the RV and light-curve solutions of the QP GP armonic complexity, , with the 1:1 relation shown as a grey dashed ine. Unlike the period and the length scale, the RV and light-curve P GPs hav e v ery dif ferent solutions for . The RV solution gi ves a onsistently larger than the light-curve data from the same stellar odel. Further, the moderate correlations seen in the light-curve olutions between and the stellar rotation period is reduced in the olutions for RVs, with a Pearson correlation coefficient of 0.5. There emains a slight, but weaker anticorrelation with total spot number f \u22120.29. The lack of agreement between the harmonic complexity term etween RV and photometric data has implications for the way we pproach activity modelling in RV data sets (see Section 6 ).\n.4 QPC versus QP GP analyses of RVs\ne repeat the GP analysis of the model RVs with the QPC kernel, gain using the same MCMC framework, convergence criteria, and reatment on non-converged solutions. Only one model had nononverged solutions, and this was a different model to those that id not converge in any other GP analysis run (see Appendix A for urther discussion).\nA comparison of results between the QP and QPC kernels for odel RV data are shown in Figs 14 , 15 , and 16 . As was the case for he analysis of the model light curves, the QPC solutions for period, volution time-scale and harmonic complexity are nearly identical o those of the QP kernel.\nExamining the residuals of the period comparison (lower panel of ig. 14 ), there are three notable outliers. These models are also the\nhree largest outliers in but not in l . As in the light-curve analysis, he scatter in the difference between the QP and QPC kernels is maller than the uncertainty, and does not vary with period.\nSimilarly with the evolution time-scale, l , aside from some outliers, he scatter in the residuals about zero is smaller than the uncertainties, ith the scatter and degree of uncertainty increasing for longer timecales.\nMNRAS 515, 5251\u20135266 (2022)\nM\np h i c i t s\nFigure 16. This figure compares the QP and QPC GP solutions for for analysis of model RV data with the unity relation shown as a grey dashed line (top panel), and the residuals from the 1:1 relation with the grey line indicating zero residuals (bottom panel).\nFigure 17. This figure shows a histogram of the fraction of cosine component, f , values for the QPC GP for our model light curves.\ns o w\n5\nR s a T d e m t d R o o c\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\nThe harmonic complexity sho ws dif ferent behaviour here comared to the LC analysis, with the QPC values being consistently igher than the QP solution for the same stellar model RV. This offset n the harmonic complexity can be explained by the higher fraction of osine component f in the QPC solutions of the model RVs. As seen n Fig. 17 , many more models had a values of f abo v e 0.1, and thus he cosine component was accounting for more of the intraperiod ignal, leaving the harmonic complexity term to fit to more of the\nNRAS 515, 5251\u20135266 (2022)\nubtle variations from point-to-point, increasing the complexity term v erall \u2013 without the larger, simpler signal to fit to, the parameter as instead sensitive to the smaller scale changes.\nI M PAC T O F RV TIME SAMPLING\nV observations are typically ground-based, and as such their timeampling is generally much sparser than that of the simulated data sets nalysed in the previous section, and have much higher uncertainties. o test the application of QP GP regression to more realistic RV ata, we add noise to these data representative of the uncertainties xpected at world-leading precision radial velocity facilities with a ean uncertainty of 20 cm s \u22121 , and a standard deviation of 15 cm s \u22121 o approximately reflect the night-to-night variations caused by ifferent atmospheric conditions. We then re-sample the model V curves with the type of sampling expected from ground-based bservatories by choosing a real star at random, and calculating its bservability from a chosen observatory given seasonal and airmass onstraints, as one would when planning a RV observing season. We\nt o t m t E e e c g p w\na w a u w i t d m o i\np a v o a r F < t r a l a\nQ s a 5 t o e r t\nf p t\nb d a r n\na b h\nhen randomly selected N observations within the observable times, v er a time span of 250 d, with N = 250, 100, 50, and 30. While 30 o 50 points per season are typical of fairly intensive, present-day RV\nonitoring campaigns, 100 to 250 points per season corresponds to he planned sampling rates for future EPRV surv e ys aiming to detect arth analogues, such as the Terra Hunting Experiment (THE; Hall t al. 2018 ). To ensure adequate sampling of the rotation periods for ven the most rapidly rotating simulated stars, we added a further onstraint that the shortest gap between any two data points in a iven time-series should not be longer than the shortest rotation eriod in our simulations. This mimics what an observer would do hen planning observations. An example of this progressive degradation of the time-sampling nd increased errors is shown for one of the stellar models in Fig. 18 , ith the data points shown in grey. The re-sampled light curves we nalysed in the same way as light curves and the original RV curves, sing the same MCMC sampling and convergence criteria. As before, e exclude any non-converged solutions from our analysis. The lines n each panel of 18 are samples from the QP GP conditioned on he data, with hyperparameters drawn from the MCMC posterior istribution. Larger scatter between the curves indicate that the GP odel is less well constrained. The effect of reducing the number of bservations by a factor up to 5 (down to N = 100) appears negligible n these plots, but it becomes noticeable when N = 50 or 30.\nWe then compare the input stellar rotation period and output GP eriod in Fig. 19 . In the bottom, which shows the residuals from one-to-one correspondence, we hav e e xcluded the clear outliers isible in the top panel, and zoomed-in to better show the behaviour f the remaining data points. With decreased sampling, the scatter round the input value increases for smaller values of the stellar otation period, as these periods are less well resolved by the data. or d N = 50, only three cases with rotations periods below 4 d (ln ( P ) 1.38) conv erged. F or N = 30 this number went down even further o one. This highlights the importance of sampling both the stellar otation period and the orbital period(s) of any candidate planets dequately. For rapidly rotating stars, this necessarily translates into arge numbers of observations per season unless the planet periods re also short.\nIn Fig. 20 we compare the input model spot evolution time to the P GP solutions for the evolution time-scale in the re-sampled data\nets. As seen with the rotation period solutions, there is greater scatter t smaller values of the spot evolution time. Further, in the 30 and 0 point data sets there are no converged solutions for evolutionary ime-scales below 8 and 10 d, respectively. While the full sample v erestimates the e v aluation time-scale for mid-range values of spot volution time, this o v erestimation impro v es at the lower sampling ate of 250 and 100 d, but then underestimates the evolution time in he 50 and 30 data point sets.\nThese differences between the time samples can be understood rom the fact that the GP model is merely an approximation to the hotometric and RV curves, a fact that becomes more noticeable with he greater sampling of the data.\nThe spot model used to generate the data leads to some modest ut noticeable high-frequency features (sharp changes in the data ue to the emergence or disappearance of individual spots) that are pparent in the LC and RV curves, and that the QP GP struggles to eproduce. At the highest (500) time-sampling this actually leads to on-convergence in the cases of the shortest spot evolution times. At N = 250 and 100, the MCMC converges, but the derived l values re significantly lower than the injected spot lifetimes \u03c4 . This is ecause the GP needs as much freedom as possible to reproduce these igh frequency features, and it achieves this by having a shorter l .\nMNRAS 515, 5251\u20135266 (2022)\nM\nFigure 19. The top panel compares the input stellar rotation period to the output QP GP period (both in natural log) for different different time samplings of the model RV data, with the unity relation indicated by the grey dashed line. The bottom panel shows the residuals to the unity relation, with axes scaled to exclude the larger outliers and more clearly show the scatter around the zero (grey dashed line).\nFigure 20. This figure compares the solutions QP GP evolution time-scale l for different re-samplings of the RV data. The grey dashed line indicates the unity relation, and the grey vertical dashed lines indicate the total time span of the date of 250 d.\nn r s a o\nFigure 22. This figure compares the solutions QP GP harmonic complexity for \u2018perfectly\u2019 sampled noisy RV data that with degraded time sampling. The grey dashed line indicates the unity relation.\nN a l Q d t a\nf G w s r o a a T o t o\nt b s d\ns\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\nAs the time-sampling decrease further ( N = 50 and 30), this o longer happens, as these high frequency features are no longer esolved, but we also lose the ability to recover short evolution timecales due to them being undersample. These cases do not converge nd are not shown on the plot. For intermediate values of \u03c4 , we bserve that the values of l are systematically larger than tau for low\nNRAS 515, 5251\u20135266 (2022)\n. This is because with limited time sampling we can only place n upper limit on the rate at which the signal evolves. Once tau is ong compared to the sampling it then becomes measurable by the P GP. Note that all these considerations would apply to light-curve ata as well, but our light curves were not simulated with reduced ime-sampling because typically light curve with sufficient precision re measured from space with the high cadence sampling that allows.\nFig. 21 compares the values obtained for the noisy versus noiseree RV time-series, with the full 500-point sampling. The cluster of amma values at the upper end of the prior range ( = 15), which as present in the noise-free case, disappears in the noisy case. We peculate that, in the noise free cases, the GP model attempts to eproduce the small, sharp changes caused by the rapid emergence f individual spots, by adopting a short intraperiodic length scale (i.e. large value of ). As soon as even small amounts of white noise re added in the data, these small changes are no longer discernible. here is no apparent correlation between the individual values btained in the noisy and noise-free cases. This implies that, more han any physical property of the active regions, the noise properties f the data are the key factor driving the measured values. To assess the impact of sampling on , Fig. 22 compares solutions o the noise-included full data set to the degraded data. Solutions elow \u223c 2.5 across all sampling levels roughly agree with the full ample solutions. Beyond this value, the scatter in values increases ramatically, regardless of the sampling. This again confirms that the parameter is predominately driven by noise, which is on the same cale across all samplings of data.\n6\nT a t s a a R i\n6 p\nT w r t r s d a a o a w c p c\nt S a t d t s n p I d t s c e a l e\np p t W s c d i F i m t t\n6\nW i b a R h t t i n c c h d c c h e a h a s p a m u o\np t u l t c r c\n6\nT o a t b\nv\nfi t\nP i i n h f a\na\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\nDISCUSSION A N D C O N C L U S I O N S\nhis work seeks to find what physical meaning, if any, can be ttributed to the QP GP hyperparameters derived from photometric ime-series. In the context of the use of photometric data to inform tellar activity jitter models in RV data, we investigate the similarities nd differences between the QP GP hyperparameters of photometric nd RV data. Finally, we look at the impact of time sampling on V data on the solution to a QP GP, and the impact this has on the nferred stellar properties.\n.1 The relation between QP GP hyperparameters and stellar roperties\no investigate the physical meaning of QP GP hyperparameters, e solve for them for a set of model light curves with varying\notation periods and spot evolution times with MCMC, and compare he output hyperparameters to the input stellar properties. The esults from this showed almost perfect reco v ery of the input tellar rotation period, with increasing scatter for shorter periods ue to the finite sampling of the data. This result is expected, nd has been indicated previously. Angus et al. ( 2018 ) conducted similar study to the work presented here focusing on the reco v ery f rotation periods from Kepler light curves by a QP GP, using similar spot model to validate their results. The results in this ork form a much tighter correlations with period, and fewer ases of the QP GP finding an alias of the true stellar rotation eriod due to the lack of noise included in our stellar model light urves.\nWe also find a correlation between the spot evolution time and he QP GP length scale, consistent with behaviour demonstrated by antos et al. ( 2021 ) between spot evolution time and light-curve utocorrelation decay time-scales. Toward longer spot evolution imes the GP o v erestimates the evolution length scale, with increasing eviation and scatter when the spot evolution time-scales approach he time span of the data. This correlation is tighter when the pot emergence and decay times are equal. This behaviour is a atural consequence of the fact that the GP kernel has only one arameter to describe the evolution of the periodic signal o v er time. f the spot emergence times are considerably shorter than the spot ecay times, the simulated light and RV curves contain both shorter erm changes due to spot emergence, and slower changes due to pot decay. The best-fitting GP evolutionary time-scale is then a ompromise between those values, and less tightly correlated to ither. The longer period single is the one that is preferentially found, s it is better sampled by the data. This indicates that the QP GP ength scale can be used as an indicator of spot decay time and volution.\nThe harmonic complexity term, does not have an intuitive hysical interpretation, but does display some correlation with hysical stellar properties. The parameter is weakly correlated with otal spot number, though not at all with the average spot number.\ne also find to correlate moderately with rotation period and pot evolution time, although the latter is shown to be a spurious orrelation. The simplicity of our spot model does not allow for a eeper exploration of the possible influences on . Results from P21 ndicate some influence of spot distribution on this hyperparameter. uture studies involving more complex stellar models with varyng spot emergence patterns and differential rotation may reveal ore about the usefulness on the hyperparameter in probing he physical properties of stars from their photometric and RV ime-series.\n.2 QP GP r egr ession on photometry versus RVs\ne perform the same analysis on time-series of RV data points to nvestigate if the same QP GP hyperparameters can be applied to oth types of data. We show in this work that, although the period nd the length scale hyperparameters match for both photometric and V data, the harmonic complexity term does not: it is systematically igher in RV than photometric time-series. This can be explained as he RV time-series will behave as a combination of the photometric ime-series and its first deri v ati ve, creating a more complex change n the RV with time compared to the photometry. It is important to ote, ho we ver, that the model curves used in this analysis can be onsidered in the \u2018high complexity\u2019 regime for the QP GP harmonic omplexity. Barrag \u0301an et al. ( 2021a ) show that this behaviour of the armonic complexity between a time-series and its deri v ati ve is ependent on the complexity of the time-series. A high harmonic omplexity time-series will have a deri v ati ve with a higher harmonic omple xity. F or time-series data with low harmonic complexity, o we v er, the harmonic comple xity of the time-series will be almost qually low. This explains the discrepancy between the findings here nd those of Kosiarek & Crossfield ( 2020 ), who compare QP GP yperparameters between Solar photometric and RV observations, nd find a marginally lower harmonic complexity (their \u03b74 \u2018length cale\u2019 is equi v alent to 1/ ) in three of their RV data compared to the hotometry, and the opposite in another, though in none of the sets re these values as drastically different as we observe in some of our odels. We conclude from this that it is not appropriate to blindly se the harmonic complexity derived from photometry for analysis f RV time-series. One common scenario not investigated in this work is the use of hotometric data to constrain a GP on RVs taken months or years after he photometric observations, as happens in the case of RV followp of planet candidates from transit surv e ys. This inv estigation is eft to future work, as it requires a more sophisticated stellar model han the one used here. Such an investigation would require activityycle-like variations in addition to individual spot evolution and otational modulation to best estimate the efficacy of using nonontemporaneous photometry.\n.3 Comparati v e performance of the QP and QPC kernels\nhe QP and QPC kernels behave almost identically for the recovery f stellar rotation period and spot evolution times in both photometric nd RV data. In particular for photometric data, the QPC tended o have very small values of cosine fraction f , and so was largely ehaving as a QP kernel. Since we allowed the harmonic complexity of the QPC kernel to vary in our analysis, it is possible that any ariability present at half the rotation period was explained by higher , rather than higher f . P21 explored this potential degeneracy by xing the harmonic complexity and varying f only. We did the same est, repeating our QPC analysis of the model light curves with set to 5.2 (corresponding to the value of \u03c9 = 0.31 adopted by 21 , where = 1/2 \u03c9 2 ). Ho we ver, we found that this had almost no mpact on the resulting distribution of f values, which were almost dentical to those obtained when was allowed to vary. In fact, the umber of light curves with f < 0.1 increased slightly. On the other and, fixing significantly increased the scatter in the values of l or \u03c4 > T /2, and led to poorly constrained solution for the mean in round 10 per cent of our simulations.\nIn RV data, the fraction f of the cosine component was higher on verage, as was the harmonic complexity of the sine-squared term.\nMNRAS 515, 5251\u20135266 (2022)\nM\nE R\ns t s t c\nc m v I a\nb w e a o a i t s t\n6 a\nT a r c t t t a e d F s i f i s\nA\nT t t a S t U a\nD\nT t h t\nR\nA\nA A A\nA\nB\nB B\nB\nD D F\nF\nF\nG G\nG H\nH J\nK L P\nR\nR\nR\nS\nS\nS\nP o A c\nA S\nA o s t s\np fi\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024\nven so, the ability to recover periods and evolution time-scales from V data is largely the same with either kernel. Both kernels gave rise to at least one significant outlier in our\nample of 100 simulated stars, where the stellar period and evolution ime-scale \u03c4 were very different from the GP period and length cale l . The QPC kernel gave rise to e ven fe wer of these outliers han the QP kernel, but the total numbers are very small in either ase.\nWe can also compare the QP and QPC kernels in terms of MCMC onvergence. Both kernels led to non-converged solutions for some odels: 2 and 10 in total for the QP kernel on light curves and radial elocities, respectiv ely, compared with 2 and 1 for the QPC case. n real-world scenarios, though, the MCMC set up can be tuned to chiev e conv ergence for each individual case.\nOverall, the QP and QPC kernels are comparable in performance, oth having advantages and drawbacks. The QP kernel is simpler, ith fewer parameters, and in most cases we do not find sufficient vidence of superior performance with the QPC kernel to justify the dditional cost. The only advantage conferred by the QPC kernel n our sample appears to be impro v ed MCMC conv ergence in round 10 per cent of the RV curves, though we were unable to dentify an y ob vious reason why conv ergence was more difficult o reach in those particular cases. Future work with more realistic pot models and spot distribution patterns may shed more light on his.\n.4 The impact of \u2018realistic\u2019 noise and time sampling on QP GP nalysis of RVs\no reflect the scenario where there is only RV data for the QP GP nalysis, we degrade the time sampling of our RV data set to better eflect the observations from ground-based observatories. When it omes to the correlation of these degraded QP GP, the results show hat the reco v ery in evolution time and period is limited to both the otal time span of the data and the minimum separation of the data, he former limiting the ability to reproduce long evolution times, nd the latter impacting the ability to sample the shorter period and volution\u2019s times the larger this minimum separation becomes with ecreasing amounts of data. It is also apparent from the insets in ig. 18 that the fewer data points give fewer constraints on the GP olution, making it increasingly more flexible. This means that there s more and more de generac y between a GP-based activity model or the RVs and any potential planetary signal. This highlights the mportance of adequate time sampling in RVs, both in total time pan, and in sampling frequency.\nC K N OW L E D G E M E N T S\nhe authors would like to thank Annelies Mortier, Helen Giles, and he Oxford exoplanets group for their helpful suggestions and insights o this work. This project was carried out with support from Science nd Technology Facilities Council (STFC) Consolidated Grant T/S000488/1 (PI Balbus). SA also acknowledges support from he European Research Council (ERC) under under the European nion\u2019s Horizon 2020 research and innovation programme (Grant greement No. 865624).\nATA AVAILABILITY\nhe stellar model data can be found in the supplementary information o this paper, and the code used to generate them can be found here: ttps:// github.com/saigrain/ pyspot (Aigrain 2021 ). The code used for he QP GP analysis and time sampling is available on request.\nNRAS 515, 5251\u20135266 (2022)\nEFERENCES\nigrain S., 2021, pyspot: Simulate Light and Radial Velocity Curves of Spotted Stars. Available at: https:// doi.org/ 10.5281/ zenodo.5654179 igrain S., Pont F., Zucker S., 2012, MNRAS , 419, 3147 igrain S. et al., 2015, MNRAS , 450, 3211 mbikasaran S., F oreman-Macke y D., Greengard L., Hogg D. W., O\u2019Neil\nM., 2015, IEEE Trans. Pattern Anal. Mach. Intell., 38, 252 ngus R., Morton T., Aigrain S., F oreman-Macke y D., Rajpaul V., 2018,\nMNRAS , 474, 2094 arclay T., Endl M., Huber D., F oreman-Macke y D., Cochran W. D.,\nMacQueen P. J., Rowe J. F., Quintana E. V., 2015, ApJ , 800, 46 arrag \u0301an O., Aigrain S., Rajpaul V. M., Zicher N., 2022, MNRAS, 509, 866 arrag \u0301an O., Aigrain S., Gillen E., Guti \u0301errez-Canales F., 2021, Res. Notes\nAm. Astron. Soc. , 5, 51 asri G., Streichenberger T., McWard C., Edmond L., IV, Tan J., Lee M.,\nMelton T., 2022, ApJ , 924, 31 elisle J. B., Unger N., Hara N. C., S \u0301egransan D., 2022, A&A , 659, A182 orren J. D., 1987, ApJ , 320, 756 oreman-Macke y D., Hogg D. W., Lang D., Goodman J., 2013, PASP , 125,\n306 oreman-Macke y D., Agol E., Ambikasaran S., Angus R., 2017, AJ , 154,\n220 ulton B. J., Petigura E. A., Blunt S., Sinukoff E., 2018, PASP , 130,\n044504 ilbertson C., Ford E. B., Jones D. E., Stenning D. C., 2020, ApJ , 905, 155 iles H. A. C., Collier Cameron A., Haywood R. D., 2017, MNRAS , 472,\n1618 runblatt S. K., Howard A. W., Haywood R. D., 2015, AJ , 808, 127 all R. D., Thompson S. J., Handley W., Queloz D., 2018, MNRAS , 479,\n2968 aywood R. D. et al., 2014, MNRAS , 443, 2517\nones D. E., Stenning D. C., Ford E. B., Wolpert R. L., Loredo T. J., Gilbertson C., Dumusque X., 2017, preprint ( arXiv:1711.01318 ) osiarek M. R., Crossfield I. J. M., 2020, AJ , 159, 271 uger R., F oreman-Macke y D., Hedges C., 2021, AJ , 162, 124 erger M., Anglada-Escud \u0301e G., Ribas I., Rosich A., Herrero E., Morales J.\nC., 2021, A&A, 645, A58 (P21) ajpaul V., Aigrain S., Osborne M. A., Reece S., Roberts S., 2015, MNRAS ,\n452, 2269 asmussen C. E., Williams C. K. I., 2006, Gaussian Processes for Machine\nLearning. MIT Press, Cambridge oberts S., Osborne M., Ebden M., Reece S., Gibson N., Aigrain S., 2013,\nPhil. Trans. R. Soc. A , 371, 20110550 antos A. R. G., Mathur S., Garc \u0301\u0131a R. A., Cunha M. S., Avelino P. P., 2021,\nMNRAS , 508, 267\nUPPORTING I N F O R M AT I O N\nupplementary data are available at MNRAS online.\nlease note: Oxford University Press is not responsible for the content r functionality of any supporting materials supplied by the authors. ny queries (other than missing material) should be directed to the orresponding author for the article.\nPPENDI X A : T H E N O N - C O N V E R G E D O L U T I O N S\ncross all of the studies in this work, there was always at least ne model for which the MCMC did not converge to a single set of olutions for the QP or QPC GP hyperparameters. Further, the models hat did not converge were not al w ays the same. This section explores ome of the non-convergence scenarios.\nMost of the non-conv erged MCMC solutions gav e multimodal osterior distributions, an example of which is given in Fig. A1 . This gure e x emplifies what occurs in a majority of these multimodal\nFigure A1. An example of bimodal posterior distribution of a QP GP fit to a model light curve.\nc c \u2018 t o c w i p i s i b c o d\ne l s r\nm c c w a u a w s r d\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024 ases of the QPC non-converges cases, and most of the QP nononverged cases: there are two equally probable solutions for the jitter\u2019 white noise term and the harmonic complexity term. Given heir equal likelihood, the MCMC is unable to prefer one solution v er the other. Looking at the jitter versus panel in this figure we an see that they are correlated: the lower jitter v alues gi ve solutions ith higher harmonic complexity, and vice versa. Bimodality is seen n other hyperparameters as well, such as between l and period, or in eriod alone. The cases with bimodal posteriors have no similarities n their stellar parameters, and in the jitter- bimodal cases the olutions to the period and evolution time-scale l still match the nput model period and spot evolution time, respectively, so can e considered reliable solutions despite not strictly meeting our onvergence criteria due to the bimodality in the posteriors of the ther parameters. Such a bimodality in posteriors is possible in real ata too, and in such circumstances, so long as the likelihood are qual for both sets of parameters, they must be considered as equally ikely given the data. In this work, ho we ver, gi ven the lack of a single olution across all parameters these cases, for consistency across the esults they are excluded from our analysis. Some of the non-converged solutions for the QP analysis of the odel RV data had unconstrained, poorly constrained posteriors, or omplex posterior distributions, which meant that the convergence riteria were not met in the 10 000 step limit of our MCMC. As ith the bimodal solutions, there is nothing particularly remarkable bout the input stellar parameters of these models. The worst of the nconstrained solutions shown in Fig. A2 . While this model did have relative short rotation period with a short evolution time-scale, this as not an extreme case, and the QP GP was able to find converged olutions for even shorter rotations periods, and smaller ratios of otation period to evolution time-scale. Trying an MCMC with a ifferent \u2018mo v e\u2019 setup did not alter the conv ergence of these cases.\nMNRAS 515, 5251\u20135266 (2022)\nMNRAS 515, 5251\u20135266 (2022)\nFigure A2. An example of the posterior distribution of an unconstrained MCMC solution.\nThis paper has been typeset from a T E X/L A T E X file prepared by the author.\nD ow nloaded from https://academ ic.oup.com /m nras/article/515/4/5251/6651396 by Indian Institute of Technology Patna user on 18 January 2024"
        }
    ],
    "title": "Quasi-periodic Gaussian processes for stellar activity: From physical to kernel parameters",
    "year": 2022
}