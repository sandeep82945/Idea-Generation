{
    "abstractText": "Molecular Communications (MC) is a bio-inspired communication paradigm that uses molecules as information carriers, requiring unconventional transceivers and modulation/detection techniques. Practical MC receivers (MC-Rxs) can be implemented using field-effect transistor biosensor (bioFET) architectures, where surface receptors reversibly react with ligands. The time-varying concentration of ligand-bound receptors is translated into electrical signals via field effect, which is used to decode the transmitted information. However, ligandreceptor interactions do not provide an ideal molecular selectivity, as similar ligand types, i.e., interferers, co-existing in the MC channel, can interact with the same type of receptors. Overcoming this molecular cross-talk in the time domain can be challenging, especially when Rx has no knowledge of the interferer statistics or operates near saturation. Therefore, we propose a frequency-domain detection (FDD) technique for bioFET-based MC-Rxs that exploits the difference in binding reaction rates of different ligand types reflected in the power spectrum of the ligand-receptor binding noise. We derive the bit error probability (BEP) of the FDD technique and demonstrate its effectiveness in decoding transmitted concentration signals under stochastic molecular interference compared to a widely used time-domain detection (TDD) technique. We then verified the analytical performance bounds of the FDD through a particlebased spatial stochastic simulator simulating reactions on the MC-Rx in microfluidic channels.",
    "authors": [
        {
            "affiliations": [],
            "name": "Meltem Civas"
        },
        {
            "affiliations": [],
            "name": "Murat Kuscu"
        },
        {
            "affiliations": [],
            "name": "Ozgur B. Akan"
        }
    ],
    "id": "SP:805dd81df1fc838908d0856911769908b5ab13d2",
    "references": [
        {
            "authors": [
                "O.B. Akan",
                "H. Ramezani",
                "T. Khan",
                "N.A. Abbasi",
                "M. Kuscu"
            ],
            "title": "Fundamentals of molecular information and communication science",
            "venue": "Proc. IEEE, vol. 105, no. 2, pp. 306\u2013318, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "I.F. Akyildiz",
                "M. Ghovanloo",
                "U. Guler",
                "T. Ozkaya-Ahmadov",
                "A.F. Sarioglu",
                "B.D. Unluturk"
            ],
            "title": "Panacea: An internet of bio-nanothings application for early detection and mitigation of infectious diseases",
            "venue": "IEEE Access, vol. 8, pp. 140 512\u2013140 523, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "C. Koca",
                "M. Civas",
                "S.M. Sahin",
                "O. Ergonul",
                "O.B. Akan"
            ],
            "title": "Molecular communication theoretical modeling and analysis of sarscov2 transmission in human respiratory system",
            "venue": "IEEE Transactions on Molecular, Biological and Multi-Scale Communications, vol. 7, no. 3, pp. 153\u2013164, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "D.P. Martins",
                "M.T. Barros",
                "B.J. O\u2019Sullivan",
                "I. Seymour",
                "A. O\u2019Riordan",
                "L. Coffey",
                "J.B. Sweeney",
                "S. Balasubramaniam"
            ],
            "title": "Microfluidic-based bacterial molecular computing on a chip",
            "venue": "IEEE Sensors Journal, vol. 22, no. 17, pp. 16 772\u201316 784, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "M. Kuscu",
                "E. Dinc",
                "B.A. Bilgin",
                "H. Ramezani",
                "O.B. Akan"
            ],
            "title": "Transmitter and receiver architectures for molecular communications: A survey on physical design with modulation, coding, and detection techniques",
            "venue": "Proceedings of the IEEE, vol. 107, no. 7, pp. 1302\u20131341, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "M. Kuscu",
                "H. Ramezani",
                "E. Dinc",
                "S. Akhavan",
                "O.B. Akan"
            ],
            "title": "Fabrication and microfluidic analysis of graphene-based molecular communication receiver for internet of nano things (iont)",
            "venue": "Scientific reports, vol. 11, no. 1, pp. 1\u201320, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "T. Mora"
            ],
            "title": "Physical limit to concentration sensing amid spurious ligands",
            "venue": "Physical review letters, vol. 115, no. 3, p. 038102, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "C. Koca",
                "M. Civas",
                "O. Akan"
            ],
            "title": "Narrow escape problem in synaptic molecular communications",
            "venue": "Proceedings of the 9th ACM International Conference on Nanoscale Computing and Communication, 2022, pp. 1\u20137.",
            "year": 2022
        },
        {
            "authors": [
                "M. Kuscu",
                "O.B. Akan"
            ],
            "title": "Channel sensing in molecular communications with single type of ligand receptors",
            "venue": "IEEE Transactions on Communications, vol. 67, no. 10, pp. 6868\u20136884, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "C. Koca",
                "O.B. Akan"
            ],
            "title": "Channel clearance by perfectly absorbing boundaries in synaptic molecular communications",
            "venue": "IEEE Access, vol. 10, pp. 121 480\u2013121 493, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "M. Kuscu",
                "O.B. Akan"
            ],
            "title": "Detection in molecular communications with ligand receptors under molecular interference",
            "venue": "Digital Signal Processing, vol. 124, p. 103186, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "L.J. Mele",
                "P. Palestri",
                "L. Selmi"
            ],
            "title": "General model and equivalent circuit for the chemical noise spectrum associated to surface charge fluctuation in potentiometric sensors",
            "venue": "IEEE Sensors Journal, vol. 21, no. 5, pp. 6258\u20136269, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "M. Civas",
                "A. Abdali",
                "M. Kuscu",
                "O.B. Akan"
            ],
            "title": "Frequency-domain detection for molecular communications",
            "venue": "Proceedings of IEEE ICC 2023, 2023.",
            "year": 2023
        },
        {
            "authors": [
                "M. Civas",
                "M. Kuscu",
                "O. Cetinkaya",
                "B.E. Ortlek",
                "O.B. Akan"
            ],
            "title": "Graphene and related materials for the internet of bio-nano things",
            "venue": "APL Materials, vol. 11, no. 8, p. 080901, 2023. 12",
            "year": 2023
        },
        {
            "authors": [
                "E. Limpert",
                "W.A. Stahel",
                "M. Abbt"
            ],
            "title": "Log-normal distributions across the sciences: keys and clues: on the charms of statistics, and how mechanical models resembling gambling machines offer a link to a handy way to characterize log-normal distributions, which can provide deeper insight into variability and probability\u2014normal or log-normal: that is the question",
            "venue": "BioScience, vol. 51, no. 5, pp. 341\u2013352, 2001.",
            "year": 2001
        },
        {
            "authors": [
                "M. Kuscu",
                "O.B. Akan"
            ],
            "title": "Modeling convection-diffusion-reaction systems for microfluidic molecular communications with surface-based receivers in internet of bio-nano things",
            "venue": "PloS one, vol. 13, no. 2, p. e0192202, 2018.",
            "year": 1922
        },
        {
            "authors": [
                "A.O. Bicen",
                "I.F. Akyildiz"
            ],
            "title": "System-theoretic analysis and leastsquares design of microfluidic channels for flow-induced molecular communication",
            "venue": "IEEE Transactions on Signal Processing, vol. 61, no. 20, pp. 5000\u20135013, 2013.",
            "year": 2013
        },
        {
            "authors": [
                "M. Kuscu",
                "O.B. Akan"
            ],
            "title": "Modeling and analysis of sinw fet-based molecular communication receiver",
            "venue": "IEEE Transactions on Communications, vol. 64, no. 9, pp. 3708\u20133721, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "I. Heller",
                "S. Chatoor",
                "J. Mannik",
                "M.A. Zevenbergen",
                "J.B. Oostinga",
                "A.F. Morpurgo",
                "C. Dekker",
                "S.G. Lemay"
            ],
            "title": "Charge noise in graphene transistors",
            "venue": "Nano letters, vol. 10, no. 5, pp. 1563\u20131567, 2010.",
            "year": 2010
        },
        {
            "authors": [
                "J. Mucksch",
                "P. Blumhardt",
                "M.T. Strauss",
                "E.P. Petrov",
                "R. Jungmann",
                "P. Schwille"
            ],
            "title": "Quantifying reversible surface binding via surfaceintegrated fluorescence correlation spectroscopy",
            "venue": "Nano Letters, vol. 18, no. 5, pp. 3185\u20133192, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "S. Vaughan"
            ],
            "title": "A bayesian test for periodic signals in red noise",
            "venue": "Monthly Notices of the Royal Astronomical Society, vol. 402, no. 1, pp. 307\u2013320, 2010.",
            "year": 2010
        },
        {
            "authors": [
                "D. Barret",
                "S. Vaughan"
            ],
            "title": "Maximum likelihood fitting of x-ray power density spectra: application to high-frequency quasi-periodic oscillations from the neutron star x-ray binary 4u1608-522",
            "venue": "The Astrophysical Journal, vol. 746, no. 2, p. 131, 2012.",
            "year": 2012
        },
        {
            "authors": [
                "A.M. Sykulski",
                "S.C. Olhede",
                "A.P. Guillaumin",
                "J.M. Lilly",
                "J.J. Early"
            ],
            "title": "The debiased whittle likelihood",
            "venue": "Biometrika, vol. 106, no. 2, pp. 251\u2013266, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "E.R. Anderson",
                "T.L. Duvall Jr",
                "S.M. Jefferies"
            ],
            "title": "Modeling of solar oscillation power spectra",
            "venue": "The Astrophysical Journal, vol. 364, pp. 699\u2013705, 1990.",
            "year": 1990
        },
        {
            "authors": [
                "T. Toutain",
                "T. Appourchaux"
            ],
            "title": "Maximum likelihood estimators: An application to the estimation of the precision of helioseismic measurements",
            "venue": "Astronomy and Astrophysics, vol. 289, pp. 649\u2013658, 1994.",
            "year": 1994
        },
        {
            "authors": [
                "M. Levin"
            ],
            "title": "Power spectrum parameter estimation",
            "venue": "IEEE Transactions on Information Theory, vol. 11, no. 1, pp. 100\u2013107, 1965.",
            "year": 1965
        },
        {
            "authors": [
                "K. Libbrecht"
            ],
            "title": "On the ultimate accuracy of solar oscillation frequency measurements",
            "venue": "The Astrophysical Journal, vol. 387, pp. 712\u2013714, 1992.",
            "year": 1992
        },
        {
            "authors": [
                "S.S. Andrews"
            ],
            "title": "Smoldyn: particle-based simulation with rule-based modeling, improved molecular interaction and a library interface",
            "venue": "Bioinformatics, vol. 33, no. 5, pp. 710\u2013717, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "N.J. Kasdin"
            ],
            "title": "Discrete simulation of colored noise and stochastic processes and 1/f/sup/spl alpha//power law noise generation",
            "venue": "Proceedings of the IEEE, vol. 83, no. 5, pp. 802\u2013827, 1995.",
            "year": 1995
        },
        {
            "authors": [
                "T.M. Inc."
            ],
            "title": "Optimization toolbox version: 9.2 (r2021b)",
            "venue": "Natick, Massachusetts, United States, 2022. [Online]. Available: https: //www.mathworks.com",
            "year": 2022
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014Molecular communications, receiver, frequencydomain detection, biosensor, ligand-receptor interactions.\nI. INTRODUCTION\nUsing molecules to encode and transfer information, i.e., Molecular Communications (MC), is nature\u2019s way of connecting bio things, such as natural cells, with each other. Engineering this unconventional communication paradigm extend our connectivity to synthetic bio-nano things, such as nanobiosensors, artificial cells, is the vision that gave rise to the Internet of Bio-Nano Things (IoBNT). IoBNT is a novel networking framework with potential to enable groundbreaking healthcare and environmental applications [1]\u2013[4].\nThe authors are with the Department of Electrical and Electronics Engineering, Koc\u0327 University, Istanbul, Turkey (e-mail: {mcivas16, mkuscu, akan}@ku.edu.tr).\nOzgur B. Akan is also with the Internet of Everything (IoE) Group, Electrical Engineering Division, Department of Engineering, University of Cambridge, Cambridge, CB3 0FA, UK (email: oba21@cam.ac.uk).\nThis work was supported in part by the AXA Research Fund (AXA Chair for Internet of Everything at Koc\u0327 University), The Scientific and Technological Research Council of Turkey (TUBITAK) under Grant #120E301, European Union\u2019s Horizon 2020 Research and Innovation Programme through the Marie Sk\u0142odowska-Curie Individual Fellowship under Grant Agreement #101028935, and Huawei Graduate Research Scholarship.\nA preliminary version of this work was presented at IEEE International Conference on Communications (ICC) on June 2023.\nMC is fundamentally different from conventional electromagnetic communication techniques as it requires novel transceiver architectures as well as new modulation, coding, and detection techniques that can cope with the highly timevarying, nonlinear, and complex channel characteristics in biochemical environments [5]. The design of MC receivers (MCRxs) and detection techniques has unquestionably attracted the most attention in the literature. However, due to the simplicity it provides in modeling, many of the previous studies considered passive Rx architectures, that are physically unlinked from the MC channel, and thus, of little practical relevance [5]. An emerging trend in MC is to model and design more practical MC-Rxs that employ ligand receptors on their surface as selective biorecognition units, resembling the sensing and communication interface of natural cells. One such design, which was practically implemented in [6], is based on field-effect transistor biosensors (bioFETs). In this design, ligand-receptor (LR) interactions are translated into electrical signals via field-effect for the decoding of the transmitted information.\nLR interactions are fundamental to the sensing and communication of natural cells. However, the selectivity of biological receptors against their target ligands is not ideal, and this so-called receptor promiscuity results in cross-talk of other types of molecules co-existing in the biochemical environment [7], [8]. This cross-talk is often dealt with by natural cells through intracellular chemical reaction networks and multistate receptor mechanisms, such as kinetic proofreading [9], [10]. The same molecular interference problem also applies to abiotic MC-Rxs using ligand receptors. However, the absence of such molecular mechanisms to mitigate interference makes imperative to develop reliable detection techniques for these systems.\nIn our previous studies on biosynthetic MC-Rxs, we addressed the molecular interference issue by developing time-domain detection techniques leveraging different ligandreceptor binding statistics [11] and channel sensing methods enabling simultaneous sensing of multiple ligand types, thereby allowing the mitigation of interference [9]. However, the techniques developed for biosynthetic MC-Rxs are not applicable to biosensor-based MC-Rxs as they rely on samples from the bound time intervals of individual receptors to differentiate between interferer and information molecules. In biosensor-based MC-Rxs, the time trajectories of individual receptor states are not accessible, as the received signal is based on the concentration of bound ligands, which is transduced into electrical signals with additional noise. The difficulty in decoding information from time-varying concentrations\nar X\niv :2\n30 9.\n09 37\n7v 1\n[ ee\nss .S\nP] 1\n7 Se\np 20\n23\n2 of bound ligands is exacerbated, especially when the MCRx has no knowledge of the statistics of the interference concentration, and it operates near saturation. Therefore, new approaches are required to address the molecular interference issue for biosensor-based MC-Rxs.\nIn this paper, we introduce a novel frequency-domain detection (FDD) technique designed to address the challenge of distinguishing between different types of ligands for biosensorbased MC-Rxs. The FDD approach utilizes the power spectral density (PSD) of receptor occupancy fluctuations, i.e., binding noise, which contains the distinct characteristics of the different LR interactions. By leveraging this information, the FDD method enables the estimation of individual ligand concentrations in the channel.\nStochastic and reversible LR interactions can be represented through a one-step binding/unbinding model, where the state transition rates are determined by the binding and unbinding rates for the LR pair [12]. Although various types of ligands can interact with the same kind of receptors, these interactions often have different binding and unbinding rates. These differences in reaction rates are manifested in distinct characteristic frequencies fc, which are also dependent on the concentrations of the involved ligands. The characteristic frequency of the LR pair appears as a cut-off frequency in the Lorentzian-shaped PSD of the binding noise. When multiple types of ligands interact with the receptors, the PSD can be represented as the superposition of the Lorentzian-shaped PSDs. In such a scenario, the characteristic frequencies that define the shape of the binding noise PSD contain information on both reaction rates and the concentrations of the different ligands. The proposed FDD method exploits this feature to estimate the concentration of information-carrying molecules. This estimation is realized with a quasi-maximum likelihood approach, specifically the Whittle likelihood, which is based on both the observed PSD and the model PSD of the electrical output fluctuations at the MC-Rx. This electrical signal incorporates the binding noise from which the concentration information is extracted. The FDD method optimally decodes the transmitted symbol based on the estimated information-carrying molecule concentration.\nTo our knowledge, the FDD method introduced in this work is a novel approach for biosensor-based MC-Rxs as it addresses the limitation of the existing TDD methods in distinguishing between information-carrying and interfering ligands. To quantify the performance of the FDD method, we derived bit error probability (BEP) in closed form and compared it with the BEP of the TDD method that uses a single sample from the electrical output of the MC-Rx for symbol detection. To validate the accuracy of our analytical results, we used a particle-based stochastic simulator, which allowed us to simulate LR interactions on the surface of the MC-Rx in a microfluidic channel, along with Monte Carlo simulations. Although FDD requires additional computational resources compared to TDD, it is a promising detection strategy for biosensor-based MC-Rxs, especially in high-interference cases where TDD methods underperform significantly. In an earlier version of this work [13], we derived theoretical performance bounds, while in the current version, we validate the theoretical results using particle-based stochastic simulations and Monte\nx\nz\ny\n(a)\n(b)\nMC-Tx\nMC-Rx\nx = xR\nwchhch\nFlow\nFig. 1: A three-dimensional illustration (a) the microfluidic MC channel, including the positions of the MC-Tx and MCRx, and (b) the detailed view of the graphene bioFET-based MC-Rx exposed to information and interferer molecules.\nCarlo experiments. The rest of the paper is organized as follows. Section II provides an overview of the system model, while Section III details the TDD method. Next, Section IV introduces the FDD method. Section V outlines the validation procedure used to verify the theoretical derivations presented earlier. Following that, Section VI offers a comparative evaluation of the BEP performances of TDD and FDD methods. Finally, Section VII summarizes our conclusions."
        },
        {
            "heading": "II. SYSTEM MODEL",
            "text": "We consider an MC system that employs binary concentration shift keying (CSK). In this scenario, the transmitter (MC-Tx) emits Nm|s information molecules at the beginning of each signaling interval. Here, m signifies the informationcarrying molecules, while s, which can be either 0 or 1, denotes the transmitted bit. We assume that the signaling interval is long enough to neglect the effect of inter-symbol interference (ISI). The medium is a three-dimensional microfluidic channel with a rectangular cross-section, as illustrated in Fig. 1(a). The MC-Tx is located at the channel inlet, while the MC-Rx is positioned on the channel floor, centered at x = xR. Molecules are released from the MC-Tx instantly and uniformly across the channel cross-section at the release time and propagate through a unidirectional fluid flow along the x-axis.\nThe MC-Rx is based on the graphene bioFET architecture, which uses graphene funtionalized with uniform receptors as the transducer channel, as shown in Fig. 1(b). Graphene\u2019s unique electrical, mechanical, and biochemical properties, such as high charge carrier mobility, atomic thickness, and two-dimensional geometry combined with the bioFET configuration allowing signal amplification, enable highly sensitive detection of a wide range of biomolecules [14]. Graphene also\n3 provides label-free detection as it allows the functionalization of its surface with biological probes that reversibly bind to the corresponding target. Recently, the first micro/nanoscale MC-Rx based on the graphene bioFET was demonstrated, using single-stranded DNA molecules as information carriers and their complementary strands as receptors on the graphene surface [6].\nInformation molecules can reversibly react with the receptors on the MC-Rx. Additionally, interferer molecules of a single type are present in the channel, and they can react with the MC-Rx receptors as well, albeit with differing reaction rates compared to the information molecules. The concentration of interferer molecules in the vicinity of the MCRx at the sampling time, denoted as ci, is assumed to follow a log-normal distribution with a mean \u00b5ci and variance \u03c3 2 ci . This statistical model is commonly employed for capturing the variability in biological systems [15].\nMolecular propagation in the channel is governed by advection-diffusion processes. Given the instantaneous release of Nm|s molecules from the MC-Tx, and under the assumption that receiver reactions negligibly affect the ligand concentration in the channel, the ligand concentration in the channel across space and time can be expressed as follows [16]:\ncm|s(x, t) = Nm|s\nAch \u221a 4\u03c0Dt exp\n( \u2212 (x\u2212 ut) 2\n4Dt\n) . (1)\nIn (1), Ach = hchwch denotes the channel cross-sectional area, u represents the constant fluid flow velocity along the x-axis, and D is the effective diffusion coefficient. For channels having a rectangular cross-section, the effective diffusion coefficient D is formulated in relation to the intrinsic ligand diffusion coefficient D0, as follows [17]:\nD = ( 1 +\n8.5u2h2chl 2 ch\n210D20(h 2 ch + 2.4hchlch + l 2 ch)\n) D0. (2)\nThe peak of the ligand concentration profile reaches the MC-Rx\u2019s center position xR at time tD = xRu . Due to the lowpass filtering characteristics of the MC channel induced by the advection diffusion, the ligand concentration at the Rx position varies slowly. This allows the LR reactions to quickly reach equilibrium within a narrow time window centered around tD [16], [17]. Within this temporal window, the MC-Rx can sample the receptor states, and the ligand concentration can be expressed as:\ncm|s(xR, tD) = Nm|s\nAch \u221a 4\u03c0DtD . (3)\nTherefore, the probability of a single receptor being in a bound state in the presence of two different ligand types\u2014information molecules and interferer molecules\u2014can be expressed by\npb|s = cm|s/KDm + ci/KDi\n1 + cm|s/KDm + ci/KDi , (4)\nwhere KDm = k \u2212 m/k + m and KDi = k \u2212 i /k + i are the dissociation constant of information and interferer molecules, respectively [9]. The total number of receptors in the bound state Nb|s follows a Binomial distribution with the mean\n\u00b5Nb|s = pb|sNr and variance \u03c3 2 Nb|s = pb|s(1 \u2212 pb|s)Nr [18]. Here, Nr represents the total number of independent surface receptors.\nThe binding of charged ligands to the receptors results in an effective charge on the graphene channel via electric field-effect. This can be described by QGr|s = Nb|sqeffNe\u2212 . Here, Ne\u2212 is number of free electrons per ligand molecules. qeff represents the mean effective charge of a single electron in a bound ligand in the presence of ionic screening, namely, Debye screening. This can be expressed as qeff = q \u00d7 exp ( \u2212 r\u03bbD ) . In this expression, q is the elementary charge, r is effective length of a surface receptor, and \u03bbD is the Debye length. The Debye length, \u03bbD, is expressed by \u03bbD = \u221a \u03f5\u03baBT\n2NAq2cion , where \u03f5 represents the permittivity of the\nmedium, T is the temperature, \u03baB stands for Boltzmann\u2019s constant, NA is Avogadro\u2019s constant, and cion denotes the ionic concentration of the medium [18]. Accordingly, the mean surface potential due to the bound ligands can be expressed as\n\u03a8Gr|s = QGr|s\nCG , (5)\nwhere CG = (\n1 CGr + 1CQ\n)\u22121 is the total gate capacitance\nof the bioFET. CGr is the electrical double-layer capacitance between the graphene and electrolyte channel and is defined by CGr = AGr\u03f5/\u03bbD. In this expression, AGr is the area of the graphene surface exposed to the electrolyte. Additionally, CQ represents the quantum capacitance and is obtained as CQ = cq \u00d7 AGr, where cq is the quantum capacitance of graphene per unit area [6].\nThe change in the output current resulting from bound molecules at equilibrium can be formulated as \u2206Ib|s = g \u00d7 \u03a8Gr|s, where g is the transconductance of the bioFET. For a large number of bound receptors, the number of bound receptors at the sampling time can be approximated as Gaussiandistributed [18], i.e., Nb|s \u223c N (\u00b5Nb|s , \u03c32Nb|s). Considering the linearity of the transduction process, the change in the output current because of bound molecules can also be approximated as following a Gaussian distribution. The mean and variance of this distribution are \u00b5\u2206Ib|s = \u03b6\u00b5Nb|s and \u03c3 2 \u2206Ib|s = \u03b62\u03c32Nb|s , respectively. Here, \u03b6 is defined as qeffNe\u2212gCG . In low-dimensional semiconductor materials such as graphene, another factor adding to the variability in the overall output current is 1/f noise. According to the widely-used charge-noise model for graphene FETs [19], the power spectral density of 1/f noise is described by Sf (f) = Sf1Hz f\u03b2\n, where Sf1Hz is the noise power at 1 Hz, and \u03b2 is an empirically determined noise exponent with a typical range of 0.8 \u2264 \u03b2 \u2264 1.2. As discussed in [18], 1/f noise can be approximated as white noise within physically relevant observation windows. Accordingly, the variance of 1/f noise can be formulated as\n\u03c32f = \u222b fL 0 Sf (fL) df + \u222b fH fL Sf (f) df, (6)\nwhere fL represents the lower frequency limit of the observation window, below which the noise power is considered constant, and fH is the upper frequency limit, beyond which\n4 the noise power is considered negligible. As a result, the respective variance and mean of the total output current change are given by \u03c32\u2206Is = \u03b6 2\u03c32Nb|s + \u03c3 2 f , \u00b5\u2206Is = \u00b5\u2206Ib|s ."
        },
        {
            "heading": "III. TIME-DOMAIN DETECTION",
            "text": "We assume that Rx has the knowledge of the number of information molecules transmitted, Nm|s, and the binding/unbinding rates of information and interferer molecules. Since Rx has no knowledge of the interferer concentration statistics, it constructs the optimal ML decision threshold for TDD solely based on its knowledge of the received signal statistics corresponding to the transmitted concentration of information molecules [11]:\n\u03b3td = 1\n\u03c32\u2206I1 \u2212 \u03c3 2 \u2206I0\n( \u03c32\u2206I1\u00b5\u2206I0 \u2212 \u03c3 2 \u2206I0\u00b5\u2206I1 + \u03c3\u2206I1\u03c3\u2206I0\n\u00d7 \u221a (\u00b5\u2206I1 \u2212 \u00b5\u2206I0)2 + 2(\u03c32\u2206I1 \u2212 \u03c3 2 \u2206I0 ) ln(\u03c3\u2206I1/\u03c3\u2206I0) ) .\n(7) As Rx does not account for interference statistics in calculating \u03b3td, it uses the bound state probability corresponding to a single molecule case, namely, pb|s = cm|s/KDm\n1 + cm|s/KDm .\nTo derive the BEP for TDD, we first obtain the statistics of the receiver output. By applying the law of total expectation, we can express the mean number of bound receptors as follows:\n\u00b5Nb|s = \u222b \u221e 0 Nrpb|s(ci)f(ci)dci, (8)\nwhere pb|s(ci) = cm|s/KDm + ci/KDi\n1 + cm|s/KDm + ci/KDi , and f(\u00b7) is the\nprobability density function of log-normal distribution. Hence, the mean output current change due to bound molecules is\n\u00b5\u2206Is = \u03b6 \u222b \u221e 0 Nrpb|s(ci)f(ci)dci. (9)\nSimilarly, by applying the law of total variance, we obtain the variance of the current change as\n\u03c32\u2206Is = \u03b6 2 (\u222b \u221e 0 ( 1\u2212 pb|s(ci) ) pb|s(ci)Nrf(ci)dci\n+ \u222b \u221e 0 ( pb|s(ci)Nr )2 f(ci)dci ) \u2212 \u00b52\u2206Is + \u03c3 2 f .\n(10)\nTherefore, given the decision threshold \u03b3td, BEP for TDD can be expressed as follows [11]:\nPTDDe = 1\n4 erfc \u03b3td \u2212 \u00b5\u2206I0\u221a 2\u03c32\u2206I0 + 1 4 erfc \u00b5\u2206I1 \u2212 \u03b3td\u221a 2\u03c32\u2206I1  . (11)"
        },
        {
            "heading": "IV. FREQUENCY-DOMAIN DETECTION",
            "text": "In this section, we introduce the FDD method utilizing the model and observed PSD of the overall noise process (binding noise + 1/f noise of the graphene bioFET-based MC-Rx) to estimate the received concentration of information molecules cm, which will be used in symbol decision. Here, the observed PSD is the periodogram of the noise constructed with the timedomain samples. In the sequel, we describe the model PSD and then introduce the proposed estimation method."
        },
        {
            "heading": "A. Theoretical Model of Binding Noise PSD",
            "text": "This section describes the theoretical model of the binding noise PSD for a particular pair of information and interference concentration, namely \u03bb = [cm, ci]. The binding process of receptors can be described by the reaction model with three states, i.e., unbound (R), bound with information molecules (RM) and bound with interferer molecules (RI), with state occupation probabilities pR, pRM and pRI , respectively [12]:\nR+M k\u2212m \u21cc k+m RM\nR+ I k\u2212i \u21cc k+i RI.\n(12)\nHence, the chemical master equations are expressed as follows: dpRM dt\ndpRI dt dpR dt\n = \u2212k\u2212m 0 k+mcm0 \u2212k\u2212i k+i ci\nk\u2212m k \u2212 i \u2212k+mcm \u2212 k + i ci pRMpRI pR  (13)\nThe matrix containing reaction rates and the concentrations in (13), has rank 2 since one state probability can be written in terms of the other two state occupation probabilities as pR + pRM + pRI = 1. Therefore, by setting the left-hand side in (13) to zero the equilibrium probabilities can be obtained as\np0RM = cm/KDm\n1 + cmKDm + ciKDi\n, p0RI = ci/KDi\n1 + cmKDm + ciKDi\n(14)\nand p0R = 1\u2212 (p0RM +p0RI). In the equilibrium conditions, the state occupation probabilities can be expressed in terms of the equilibrium state probability and the fluctuations around this probability [12], [20] as\npj(t) = p 0 j +\u2206pj(t), j \u2208 {RM,RI,R}. (15)\nBy substituting (15) into (13) and applying Taylor\u2019s expansion, the state fluctuations can be expressed as follows [12]:\nd\u2206p\u2032(t)\ndt = \u2126\u2206p\u2032(t). (16)\nWe define the column vector p(t) containing the state probabilities as p(t) = [pRM (t), pRI(t), pR(t)] and its reduced form as p\u2032(t) = [pRM (t), pRI(t)]. Therefore, the relation between \u2206p\u2032(t) and \u2206p(t) can be expressed as:\n\u2206p(t) = R\u2206p\u2032(t), (17)\nwhere R is the transformation matrix [12]. Also, the matrix \u2126 in (16) is defined as follows:\n\u2126 = [ \u2212k+mcm \u2212 k\u2212m \u2212k+m \u2212k+i ci \u2212k + i ci \u2212 k \u2212 i ] . (18)\nThe deviation in the output current of the MC-Rx due to stochastic binding reactions, i.e., \u2206Ib(t), is then obtained as\n\u2206Ib(t) = qeff g\nCG zTR\u2206p\u2032(t) (19)\nwhere z = [Ne\u2212 ;Ne\u2212 ; 0] is the vector containing the number of elementary charges. As \u2206Ib(t) is a stationary process,\n5 the theoretical PSD of the binding noise fluctuations can be obtained by setting t = 0 as follows [12]:\nSb(f) = 2 F{E[\u2206Ib(t)\u2206Ib(t+ \u03c4)]} = 2 F{E[\u2206Ib(0)\u2206Ib(\u03c4)]}\n= 4Nr\n( qeffg\nCG\n)2 zTR\u0393 ( Re{(j2\u03c0fI2\u00d72 \u2212\u2126)\u22121} )T RT z,\n(20) where F{\u00b7} stands for Fourier transform, I2\u00d72 is the identity matrix, and \u0393 is the matrix containing the expected state probabilities, which is given as follows [12]:\n\u0393 =\n[ p0RM ( 1\u2212 p0RM ) \u2212p0RMp0RI\n\u2212p0RMp0RI p0RI ( 1\u2212 p0RI )] . (21) Therefore, the theoretical PSD of the total current noise corresponding to a particular (cm, ci) pair can be written as\nS(f) = Sb(f) + Sf (f). (22)"
        },
        {
            "heading": "B. Maximum Likelihood Estimation of PSD Parameters",
            "text": "In the following part, we describe the parameter value extraction, namely the estimation of information and interfering molecule concentrations, \u03bb = [cm, ci], from the noise PSD. The detector uses the estimated information molecule concentration c\u0302m for symbol decision, as will be explained in the following section, Sec. IV-C. Our analysis is based on the following assumptions:\n\u2022 The total noise process, namely the binding fluctuations combined with 1/f noise, is stationary, zero-mean with a single-sided spectrum. \u2022 The MC-Rx is provided with the model PSD function, which is expressed by (22). MC-Rx also has the knowledge of the binding/unbinding rates of information and interferer molecules, and the number of information molecules transmitted for bits s = 0 and s = 1 as mentioned in Section II. Therefore, MC-Rx estimates the steady information and interferer concentrations by taking time samples from the output current \u2206Ib in a sampling window, where we consider a single realization of the interferer concentration ci following log-normal distribution as mentioned in Section II. The DC component of \u2206Ib is discarded to isolate the noise. \u2022 The information and interferer concentrations are considered constant in the sampling window based on the equilibrium assumption discussed in Section II [18]. \u2022 The observed PSD of time domain samples and the parametric model of the PSD expressed by (22) is used in the ML estimation of \u03bb = [cm, ci]. It is assumed that the observed PSD is calculated with the periodogram method.\nFor each transmitted symbol, we have N number of noise samples x = (x1, x2, ..., xN ) taken with the sampling period of \u2206t. Hence, the total duration of sampling per symbol, namely the length of the sampling window, is Td = N\u2206t. Periodogram for the sampled signal can be computed from the Discrete Fourier transform (DFT) of the samples x. With even N , the periodogram values are then expressed as follows: Yk = 2\u2206t N |Xk|\n2 where k = 1, ..., N/2\u2212 1, and |Xk| are DFT components of x.\nFor a stochastic time series of length N , the random variable Wk = 2\nYk S(fk) follows chi-squared distribution \u03c72 [21], where S(fk), given by (22), is the true PSD at frequency fk and fk = k N\u2206t and k = 1, ..., N/2 \u2212 1. The \u03c7\n2 distribution with two degrees of freedom is in fact the exponential distribution [22]. Therefore, the periodogram values are exponentially distributed about the true PSD with the following probability given the model PSD value at a given frequency:\np(Yk|S(fk)) = 1 S(fk) e \u2212 Yk S(fk) , (23)\nfollowing that S(fk) is also expectation value at fk [22]. Based on (23), the likelihood of observing a pair of particular information and interferer concentrations, \u03bb = [cm, ci], is L(\u03bb) = N/2\u22121\u220f k=1 p(Yk|S(fk,\u03bb)) = N/2\u22121\u220f k=1 1 S(fk,\u03bb) e \u2212 Yk S(fk,\u03bb) , (24) where \u03bb = [cm, ci] is the parameters to be estimated. Here, we use Whittle likelihood, which can be a good approximation to the exact likelihood asymptotically, and also provide computational efficiency, i.e., O(N logN) computations compared to O(N2) for exact likelihood [22], [23]. Accordingly, the quasilog likelihood can be written as follows:\nlnL(\u03bb) = \u2212 N/2\u22121\u2211 k=1 ( Yk S(fk,\u03bb) + lnS(fk,\u03bb) ) . (25)\nML estimator extracts the value of \u03bb, i.e., \u03bb\u0302, that maximizes (25). Maximizing lnL(\u03bb) is equivalent to minimizing l = \u2212 lnL(\u03bb) [24], such that\n\u03bb\u0302 = argmin \u03bb {l}. (26)\nThe solution to (26) can be obtained through numerical methods, such as the Newton-Raphson method achieving ML estimation in only a few iterations. The FDD method requires O(N logN) computations in addition to the numerical solution of (26). In the TDD approach, however, the MC-Rx takes a single time sample and performs a single thresholding operation to determine the received symbol."
        },
        {
            "heading": "C. Symbol Detection",
            "text": "The ML estimator described in Sec. IV-B is asymptotically unbiased such that \u03bb\u0302 tends to have multi-normal distribution [25] with E[\u03bb\u0302] = \u03bb, and the respective variance of the estimated parameters, which is the diagonal elements of inverse Fisher information matrix (FIM) F(\u03bb),\n\u03c32 \u03bb\u0302i = (F(\u03bb))\u22121(ii), F(\u03bb)(ij) = E ( \u22022l\n\u2202\u03bbi\u2202\u03bbj\n) . (27)\nwhere the expectation is taken with respect to the probability distribution of the observed spectrum p(Y1, Y2, ..., YN ). Putting l = \u2212 lnL(\u03bb) into (27), the FIM can be expanded as: F(ij) =\nE N/2\u22121\u2211 k=1 S(fk)\u2212 Yk S2(fk) \u22022S \u2202\u03bbi\u2202\u03bbj + 2Yk \u2212 S(fk) S3(fk) \u2202S \u2202\u03bbi \u2202S \u2202\u03bbj  . (28)\n6 Algorithm 1 Frequency Domain Detection 1: function FREQUENCYDETECTION(Y [k], N,\u2206t, \u03b3fd) 2: Find initial guess: \u03bb0 \u2190 [c0m, c0i ] 3: fk \u2190 kN\u2206t for k = 1, . . . , N/2\u2212 1 4: Use Newton\u2019s method on WHITTLE(Y [k], fk,\u03bb) with\ninitial guess \u03bb0 to find optimal \u03bb\u2217 = [c\u2217m, c \u2217 i ].\n5: c\u0302m \u2190 c\u2217m 6: if c\u0302m > \u03b3fd 7: Estimated bit: s\u0302\u2190 1 8: else 9: Estimated bit: s\u0302\u2190 0\n10: end if 11: return s\u0302 12: end function 13: function WHITTLE(Y [k], fk,\u03bb) 14: l\u2190 \u2211N/2\u22121 k=1 Yk S(fk,\u03bb)\n+ lnS(fk,\u03bb) 15: return l 16: end function\nConsidering that S(f) is a slowly varying function, calculating individual periodogram values in (28) is unnecessary because periodogram values can be smoothed by summing over frequency such that\nN/2\u22121\u2211 n=1 Yk\u03d5(fk) \u2243 N/2\u22121\u2211 n=1 S(fk)\u03d5(fk), (29)\nfor any smooth function \u03d5(fk) [25], [26]. Based on (29), (28) can be simplified as [25]\nF(ij) \u2243 N/2\u22121\u2211 k=1 1 S2(fk) \u2202S \u2202\u03bbi \u2202S \u2202\u03bbj , (30)\nwhere the derivatives are taken at the true value of the parameters. (30) can also be approximated to integral [25], [26]:\nF(ij) \u2243 N\u2206t\n2\n\u222b 1 2\u2206t\n0\n1\nS2(f)\n\u2202S\n\u2202\u03bbi\n\u2202S \u2202\u03bbj df. (31)\n(31) is a good approximation for a large number of samples such that periodogram values can be approximated as Gaussian by the central limit theorem [27].\nMC-Rx decides the transmitted bit by applying the ML decision rule to the estimated concentration of the information molecule, denoted as c\u0302m. In the case of FDD, the ML decision threshold is defined as follows:\n\u03b3fd = 1\n\u03c32c\u0302m|1 \u2212 \u03c3 2 c\u0302m|0\n( \u03c32c\u0302m|1cm|0 \u2212 \u03c3 2 c\u0302m|0 cm|1 + \u03c3c\u0302m|1\u03c3c\u0302m|0\n\u00d7 \u221a\n(cm|1 \u2212 cm|0)2 + 2(\u03c32c\u0302m|1 \u2212 \u03c3 2 c\u0302m|0 ) ln ( \u03c3c\u0302m|1/\u03c3c\u0302m|0 )) ,\n(32) where \u03c32c\u0302m|s is the variance and cm|s is the expected value of estimated information molecule when the transmitted bit is s \u2208 {0, 1}.\nThe MC-Rx is assumed to know the peak information molecule concentrations for bit-0 and bit-1 at the sampling\ntime, as expressed by the equation:\ncm|s = Nm|s\nAch \u221a 4\u03c0Dtd . (33)\nAs the MC-Rx does not know the interfering molecule concentration, it computes the decision threshold, \u03b3fd, assuming the absense of interference in the channel. Therefore, the computation of ML decision threshold \u03b3fd relies on the following PSD model for a single type of molecule, i.e., information molecule:\nS(f, cm) = 4Nr\u03b6 2 1\n2\u03c0f + 1/\u03c4m pb(1\u2212 pb) + Sf (f), (34)\nwhere \u03c4m = 1/(cmk+m + k \u2212 m) and pb = cm KDm + cm . Using (34), and (30) for \u03bb = [cm], the variance of estimated information molecule concentration corresponding to the transmitted bit s \u2208 {0, 1} is written as [11]\n\u03c32c\u0302m|s = 1\nN\u2206t\n2\n\u222b 1 2\u2206t\n0\n1\nS2(f, cm|s)\n( \u2202S\n\u2202cm\n)2\u2223\u2223\u2223 cm=cm|s df .\n(35) (35) does not give the actual asymptotic variances since MCRx estimates the value of cm based on the model PSD given by (22).\nAlgorithm 1 outlines the FDD procedure, providing the necessary functions for solving the estimation problem defined by equation (26) and determining the transmitted bit at the receiver. On line 2, the initial concentration values [c0m, c 0 i ] are obtained by sweeping over sparse concentration values on WHITTLE(Y [k], fk,\u03bb) and selecting the values that minimize the corresponding function. On line 3, the variable fk represents the frequencies for which periodogram values are available. On line 4, Newton-Raphson method is used to solve the estimation problem defined in (26) by using WHITTLE(Y [k], fk,\u03bb) and the initial concentration values [c0m, c 0 i ] as the starting points. Once the optimal \u03bb\n\u2217 is found, lines 6-11 execute the thresholding operation on the estimated information molecule concentration c\u0302m to determine the transmitted bit."
        },
        {
            "heading": "D. Asymptotic Bit Error Probability",
            "text": "To calculate BEP for FDD, we need the actual values of the variance of estimated information molecule concentration corresponding to s = 0 and s = 1, i.e., \u03c32c\u0302m|s . Using the model PSD S(f,\u03bb) given by (22), and (30) with \u03bb = [cm, ci], the variance can be expressed as\n\u03c32c\u0302m|s = (Fs(\u03bb)) \u22121 (11), (36)\nwhere Fs\u2019s elements are:\nFs(11) =\nN\u2206t\n2\n\u222b 1 2\u2206t\n0\n1\nS2(f, (cm|s, \u00b5ci))\n( \u2202S\n\u2202cm )2\u2223\u2223\u2223cm=cm|s ci=\u00b5ci df\nFs(22) =\nN\u2206t\n2\n\u222b 1 2\u2206t\n0\n1\nS2(f, (cm|s, \u00b5ci))\n( \u2202S\n\u2202ci )2\u2223\u2223\u2223cm=cm|s ci=\u00b5ci df,\nFs(12),(21) =\nN\u2206t\n2\n\u222b 1 2\u2206t\n0\n1\nS2(f, (cm|s, \u00b5ci))\n( \u2202S\n\u2202cm\n)( \u2202S\n\u2202ci )\u2223\u2223\u2223cm=cm|s ci=\u00b5ci df.\n(37) As a result, BEP for FDD can be written as\nPFDDe = 1\n4 erfc \u03b3fd \u2212 cm|0\u221a 2\u03c32c\u0302m|0 + 1 4 erfc cm|1 \u2212 \u03b3fd\u221a 2\u03c32c\u0302m|1  . (38)\nHere, it should be noted that (38) is an asymptotic expression based on the Gaussian distribution assumption in Sec. IV-C."
        },
        {
            "heading": "V. SIMULATION OF THE SYSTEM",
            "text": "In this section, we detailed the simulation process used to validate our FDD technique. Specifically, we conducted Monte Carlo simulations to compare the theoretical results obtained by the analytical expressions derived in Sections III and IV and the results obtained through particle-based stochastic simulations. For the latter, we used Smoldyn [28]. The simulation algorithms were implemented in MATLAB, and parallelized CPU cores were used for reasonable computation times."
        },
        {
            "heading": "A. Particle-based Stochastic Simulations",
            "text": "We used the open-source particle-based spatial stochastic simulator, Smoldyn, to simulate the system. Its capability to capture stochastic events at a molecular level, such as diffusion and receptor binding/unbinding, fits our purpose [28]. As illustrated in Fig. 2, we created a straight microfluidic channel with a rectangular cross-section. The receptors are located in a specific region on the channel bed, indicating the position of the MC receiver."
        },
        {
            "heading": "B. Simulation Parameters",
            "text": "The simulation time step is an important parameter that affects the accuracy of Smoldyn. Using shorter time steps generally leads to higher accuracy but slower simulations. When choosing the time step, one consideration is to ensure it is significantly shorter than the characteristic time scale of any reaction in the system. For the reactions described by (12), the characteristic times or time constants can be obtained from the matrix \u2126 defined by (18), as follows:\n\u03c4c1,2 = \u22121/\u03bbc1,2 , (39)\nwhere \u03bbc1,2 corresponds to the eigenvalues of \u2126. These time constants only depend on the kinetics of the reactions and the concentrations of the information and interferer molecules. Therefore, given the transmitted bit s, the characteristic times (39) can be expanded as\n\u03c4c1,2|s = 2[\n1 \u03c4m|s + 1\u03c4i \u00b1 \u221a( 1 \u03c4m|s \u2212 1\u03c4i )2 + 4k+mcm|sk + i ci ] , (40)\nwhere \u03c4m|s = 1/(cm|sk+m + k \u2212 m), \u03c4i = 1/(cik + i + k \u2212 i ) correspond to the characteristic times of the independent reactions R+M k\u2212m \u21cc k+m RM and R+ I k\u2212i \u21cc k+i RI respectively.\nConsidering the system parameters summarized in Table I, we have chosen the simulation time step as \u2206ts = 0.0025 s. This choice represents a good compromise between accuracy and total execution time. Further reducing the time step can significantly increase the simulation time, posing a challenge for repeated experiments.\nThe noise PSD, given by equations (20)-(22), can be described as a superposition of Lorentzian spectral profiles. When they are not masked, the corner frequencies of these Lorentzian profiles are defined by the characteristic frequencies, which can be expressed in terms of characteristic times as fc1,2|s = 1/(2\u03c0\u03c4c1,2|s). When these frequencies are not masked, they can be identified by locating the peaks of the noise PSD multiplied by the corresponding frequency, as illustrated in Fig. 3a. Since the PSD exhibits a profile defined by its characteristic frequencies, which contain information about the equilibrium concentration of the information molecules within\n8 10 -2 10 -1 10 0 10 1 10 2\nf (Hz)\n10 -25\n10 -24\n10 -23\n10 -22\n10 -21\nS (\nA 2 /H\nz )\n10 -22\nf S\n( A\n2 )\nf 2|s\nf 1|s\n(a)\n10 -1\n10 0\n10 1\n10 2\nf (Hz)\n10 -27\n10 -26\n10 -25\n10 -24\n10 -23\n10 -22\n10 -21\n10 -20\nS (\nA 2 /H\nz )\nModel PSD Observed PSD\n(b)\nFig. 3: (a) Characteristic frequencies highlighted on the graph of the S multiplied by frequency f , where S is the theoretical PSD of noise. (b) Model PSD generated with estimated molecule concentrations and the observed PSD (periodogram) generated with the Smoldyn data.\nthe sampling window, it is crucial to resolve these characteristic frequencies to extract the relevant information accurately. In this regard, the sampling period \u2206t is a relevant parameter. The maximum observable frequency can be determined by fcmax = 1 2\u2206t . When a characteristic frequency exceeds this limit, certain portion of the information can be lost."
        },
        {
            "heading": "C. Monte Carlo Simulations",
            "text": "The Monte Carlo algorithm used to validate the BEP performance of FDD is described in Algorithm 2. In each iteration (line 6-19), representing the transmission of a random bit s in the microfluidic channel, the procedure is as follows.\nBased on the equilibrium assumption explained in Sec. II, the information molecule concentration cm|s and interferer concentration ci are assumed to remain constant within the sampling window. Therefore, the corresponding information concentration cm|s for the generated bit s and the interferer concentration ci generated from a log-normal distribution\nAlgorithm 2 Monte Carlo Simulation 1: Initialize: TDD error et \u2190 0, FDD error ef \u2190 0 2: Generate a bitstream consisting of M bits 3: Find decision threshold for TDD \u03b3td 4: Find decision threshold for FDD \u03b3fd 5: for each bit s in bitstream do 6: Compute information concentrations cm|s with (3) 7: Generate interferer concentration ci \u223c logN (a, b) 8: Run Smoldyn. Wait until equilibrium. 9: Record N samples from the number of bound recep-\ntors nB [k] for k = 1, . . . , N with sampling period \u2206t 10: Generate 1/f noise samples in the time domain\nn1/f [k] for k = 1, . . . , N 11: Convert to electrical output Ib[k]\u2190 n1/f [k] + \u03b6nB [k]\nfor k = 1, . . . , N 12: Take one sample, denoted as I1, from Ib[k] 13: s\u0302t \u2190 TIMEDETECTION(\u03b3td, I1) 14: If s\u0302t \u0338= s, increment et by 1. 15: Isolate the noise, denoted as \u2206Ib[k], from Ib[k] 16: Apply low pass filter to \u2206Ib[k] to obtain \u2206Ibf [k] 17: Compute the periodogram Y [m] for \u2206Ibf [k], for m =\n1, . . . , N2 \u2212 1 and sampling period \u2206t 18: s\u0302f \u2190 FREQUENCYDETECTION(Y [m], N,\u2206t, \u03b3fd) 19: If s\u0302f \u0338= s, increment ef by 1. 20: end for 21: Compute BEP for TDD: PTDDe \u2190 et/M 22: Compute BEP for FDD: PFDDe \u2190 ef/M 23: function TIMEDETECTION(\u03b3td, I1) 24: if I1 > \u03b3td 25: Estimated bit: s\u0302\u2190 1 26: else 27: Estimated bit: s\u0302\u2190 0 28: end if 29: return s\u0302 30: end function\nrepresent the concentrations at the sampling time. With these initial values, the Smoldyn simulation is run for a time duration sufficient for the binding reactions to reach equilibrium. Once equilibrium is attained, time samples are taken from the output of the Smoldyn (line 9), where the output corresponds to the number of bound receptors. The collected time samples are then scaled and combined with 1/f noise to simulate the transduction process of the bioFET, resulting in the electrical output denoted as Ib[k].\nTo simulate the 1/f noise in the time domain, we employed the FIR filtering method described in [29], which involves filtering white Gaussian noise in the frequency domain using an FIR filter with a 1/f passband and subsequently performing an inverse Fourier transform to obtain the 1/f noise sequence. The approximate noise variance \u03c32f is computed based on the expression given in Equation (6), with the parameter values specified in Table I.\nAs stated in line 12, a single sample is taken from the middle of the electrical output Ib[k] for TDD. For FDD, the base signal is removed from the electrical output Ib[k] to isolate\nthe noise component, \u2206Ib[k]. Additionally, considering that samples are taken within a finite sampling window, distortions near the Nyquist frequency in the PSD are inevitable due to the aliasing. Therefore, a low-pass filter with a passband near the Nyquist frequency is applied to the sampled noise to mitigate this distortion, as outlined in line 16. This filtering step helps reduce outliers that could affect the accuracy of the MLE. Then, periodogram PSD is computed using an N-point FFT of the filtered noise samples. No further processing is performed on the noise signal or the estimated PSD before the MLE to avoid introducing statistical distortion, which can result in erroneous parameter predictions. Finally, the MLE is performed by MATLAB\u2019s fminunc solver [30], which uses the quasi-Newton algorithm. The solver can find the solution within a few iterations in this specific scenario. Finally, BEP for TDD and FDD are computed as described by line 20-21.\nFig. 3b depicts the model noise PSD generated using the MLE estimated information and interferer concentration pair, [c\u0302m|s, c\u0302i], and the periodogram estimate of the observed noise PSD obtained by using the data from the Smoldyn."
        },
        {
            "heading": "VI. PERFORMANCE EVALUATION",
            "text": "In this section, we analyze the performance of FDD and TDD in terms of BEP. The default values of the system parameters are given in Table I, with the reaction rates adopted from [11]. Unless stated otherwise, the default parameter values are used in the rest of the paper.\nIt can be observed that the simulation results can deviate from the theoretical results due to the inherent nature of Monte Carlo simulations. Especially when dealing with high concentration values (high signal variance), Monte Carlo simulations can require a large number of iterations to converge, potentially leading to excessive simulation times when using Smoldyn. Therefore, to maintain a compromise between convergence and simulation times, we chose moderate number of iterations (1000) for the Monte Carlo simulations."
        },
        {
            "heading": "A. Effect of Interference on BEP",
            "text": "In the initial analysis, we examine the impact of interference strength on the BEP performance of both TDD and FDD. To investigate this, we introduce a tuning parameter \u03b3, which determines the mean interferer concentration \u00b5ci as \u00b5ci = \u03b3 \u00b7 cm|s=1. The results, as depicted in Fig. 4a, show that FDD outperforms TDD, except in cases where the interferer concentration is significantly lower than the concentration of information molecules as shown in Fig. 4a. As the interferer concentration increases, the performance of TDD deteriorates. This degradation occurs because the increasing number of bound receptors becomes occupied by the interfering molecules, leading to saturation of the receiver, thereby causing increase in the error probability. On the other hand, the performance of FDD improves with increasing interferer concentration up to a certain point, after which it starts to degrade.\n10"
        },
        {
            "heading": "100 200 300 400 500 600 700",
            "text": "Considering that the characteristic frequencies are influenced by both the concentration and affinities of the molecules, the effect of interference is initially indistinguishable in the PSD. This is because the concentration of interfering molecules is initially lower, which results in the individual Lorentzian PSD attributed to interfering molecules being overshadowed by that of the information-carrying molecules. However, as the concentration of interfering molecules increases, its impact on the combined PSD becomes more pronounced, allowing for a more accurate estimation of concentrations and, consequently, reduced error probabilities. Nevertheless, beyond a particular concentration of interfering molecules, the Lorentzian PSD attributed to the information-carrying molecules is overshadowed, increasing error probabilities."
        },
        {
            "heading": "B. Effect of Similarity on BEP",
            "text": "We also consider the effect of the affinity ratio between the information and interferer molecules, which we refer as the similarity parameter and define as \u03b7 = KDiKDm . To observe the direct effect of the similarity, we keep the bound state probabilities constant by scaling the mean interferer concentration, \u00b5ci , by \u03b7. As expected, TDD is not affected by the similarity parameter, as shown in Figure 4b. This occurs because the TDD method relies on the total bound state probability pbs , which remains constant in this case, thereby not affected by changes in similarity. On the other hand, BEP for FDD exhibits an interesting behavior. BEP improves as the similarity parameter \u03b7 increases, indicating that the information and interfering molecules become dissimilar. However, beyond a specific value of the similarity parameter, BEP starts to degrade. This trend can be explained as follows: When the similarity parameter \u03b7 is low, indicating high similarity between the information and interfering molecules, FDD cannot distinguish between these two types of molecules based on their affinities. This is because any noticeable distinction is not reflected in the spectrum. For example, when the similarity parameter \u03b7 is close to 1, the noise PSD appears as a single Lorentzian profile, thereby obscuring the Lorentzian profile associated with the reaction RM in the spectrum. As the similarity increases,\nit becomes more visible that PSD is the superposition of two Lorentzian profiles, and the characteristic frequencies f1|s and f2|s are more distinguishable. However, once the similarity goes beyond the point where f1|s and f2|s are most distinguishable, the PSD becomes less informative about the concentration of information cm|s. This occurs because interference becomes the dominant factor on the profile of the PSD, and the variations in cm|s have a lesser impact on the PSD. As a result, the PSD becomes less informative about the information concentration, cm|s, increasing the error probability."
        },
        {
            "heading": "C. Effect of Number of Samples on BEP",
            "text": "The BEP performance is further analyzed for the number of time samples N . As depicted in Fig. 5a, it is observed that the performance of FDD improves as the number of samples increases. This outcome aligns with expectations, as a larger number of samples leads to a decrease in the variance of the estimated information molecule concentration, \u03c32c\u0302m|s . The reduction in variance results in more accurate estimation as the error on the estimated parameter follows \u03c3c\u0302m|s \u221d \u221a (Fs) \u22121 (11)/N . Consequently, more samples lead to a decrease in the BEP. On the other hand, the performance of TDD remains unaffected by the number of samples, as the receiver only takes one sample, typically from the middle of the signal within the sampling window."
        },
        {
            "heading": "D. Effect of 1/f noise on BEP",
            "text": "We also simulate the BEP performance of FDD and TDD under varying 1/f noise power (at 1 Hz), as depicted in Fig. 5b. To better observe the performance trend, a similarity value of \u03b7 = 3 is chosen for this case. The results show that 1/f noise affects the performance of both TDD and FDD. Additionally, it can be observed that the performance of FDD is more sensitive to changes in the 1/f noise levels compared to TDD. Since 1/f noise is directly additive across the entire spectrum, increasing the 1/f noise level reduces the FDD performance by potentially masking critical frequencies under the background 1/f noise.\n11"
        },
        {
            "heading": "E. Effect of Bit-0/Bit-1 concentration ratio on BEP",
            "text": "We further explored the impact of the ratio of concentrations for bit-0 and bit-1, denoted as Nm|0/Nm|1, on the BEP. As depicted in Fig. 6a, it becomes apparent that the detection performances of both TDD and FDD methods experience a decline when the concentration values become closer.\nIn Fig.6a, the MC-Rx is observed in near saturation, implying a high level of receptor occupancy. Comparing the performance in Fig.6a with the result shown in Fig.6b, which corresponds to a case of lower bound state probabilities, a noticeable performance decline can be observed in the latter.\nThese results suggest that the FDD method is more effective when the receptor occupancy at the MC-Rx is higher. This property could be advantageous, as it aligns more closely with the typical conditions encountered in MC, wherein the receiver is commonly expected to operate near saturation most of the time due to the remaining molecules from previous transmissions or interferers."
        },
        {
            "heading": "VII. CONCLUSION",
            "text": "In this paper, we propose a frequency-domain detection method for the bioFET-based molecular communication receivers. The method leverages the receptor cross-reactivity to different ligands and utilizes the output noise power spectral density to detect the transmitted bit. We derived the bit error probability for frequency domain and one-shot time domain detection methods by considering a microfluidic channel where a single type of interfering molecules is present. We employed a particle-based spatial simulator to validate our theoretical derivations for bit error probabilities. Our analysis indicates a significant performance advantage of the proposed frequency-domain detection method over the timedomain detection method, especially in scenarios with high interference in the channel. This characteristic of the frequencydomain detection can be helpful since it can be applicable to practical conditions encountered in molecular communication, where receivers often operate close to saturation at high data transmission rates due to the presence of remaining molecules from previous transmissions or interference."
        }
    ],
    "title": "Frequency-Domain Detection for Molecular Communication with Cross-Reactive Receptors",
    "year": 2023
}