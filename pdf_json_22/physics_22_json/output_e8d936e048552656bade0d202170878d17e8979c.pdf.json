{
    "abstractText": "Upcoming large satellite constellations and the advent of tighter steerable beams will offer unprecedented flexibility. This new flexibility will require resource management strategies to be operated in highdimensional and dynamic environments, as existing satellite operators are unaccustomed to operational flexibility and automation. Frequency assignment policies have the potential to drive constellations\u2019 performance in this new context, and are no exception to real-time and scalability requirements. The majority of frequency assignment methods proposed in the literature fail to fulfill these two requirements, or are unable to meet them without falling short on bandwidth and/or power efficiency. In this paper we propose a new frequency assignment method designed to prioritize operational requirements. We present an algorithm based on Integer Linear Programming (ILP) that is able to fully define a frequency plan while respecting key system constraints such as handovers and interference. We are able to encode operators\u2019 goals such as bandwidth maximization or power reduction and produce optimal or quasioptimal plans according to such objectives. In our experiments, we find our method is able to allocate at least 50% more bandwidth and reduce power consumption by 40% compared to previous operational benchmarks. The performance advantage of our method compared to previous solutions increases with the dimensionality of the constellation; in an experiment with a 5,000-beam MEO constellation we find that we can allocate three times more bandwidth.",
    "authors": [
        {
            "affiliations": [],
            "name": "Juan Jose Garau-Luis"
        },
        {
            "affiliations": [],
            "name": "Sergi Aliaga"
        },
        {
            "affiliations": [],
            "name": "Guillem Casadesus"
        },
        {
            "affiliations": [],
            "name": "Nils Pachler"
        },
        {
            "affiliations": [],
            "name": "Edward Crawley"
        },
        {
            "affiliations": [],
            "name": "Bruce Cameron"
        }
    ],
    "id": "SP:608f55e71fb623f5dc9c0a128af87a863320f300",
    "references": [
        {
            "authors": [
                "Northern Sky Research"
            ],
            "title": "VSAT and Broadband Satellite Markets",
            "venue": "Tech. Rep., 2019.",
            "year": 2019
        },
        {
            "authors": [
                "\u2014\u2014"
            ],
            "title": "IFC Market project to reach $36 billion in cumulative revenue by 2028",
            "venue": "Tech. Rep., 2019. 30",
            "year": 2019
        },
        {
            "authors": [
                "I. del Portillo",
                "B.G. Cameron",
                "E.F. Crawley"
            ],
            "title": "A technical comparison of three low earth orbit satellite constellation systems to provide global broadband",
            "venue": "Acta Astronautica, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "N. Pachler",
                "I. del Portillo",
                "E.F. Crawley",
                "B.G. Cameron"
            ],
            "title": "An Updated Comparison of Four Low Earth Orbit Satellite Constellation Systems to Provide Global Broadband",
            "venue": "2021 IEEE International Conference on Communications Workshops (ICC Workshops). IEEE, jun 2021, pp. 1\u20137. [Online]. Available: https://ieeexplore.ieee.org/document/9473799/",
            "year": 2021
        },
        {
            "authors": [
                "S.A. SES"
            ],
            "title": "O3b mPOWER Press Factsheet",
            "venue": "Tech. Rep., Aug. 2021. [Online]. Available: https://www.ses.com/sites/ default/files/2022-02/SES O3b mPOWER Factsheet EN.pdf",
            "year": 2021
        },
        {
            "authors": [
                "T. Mizuike",
                "Y. Ito"
            ],
            "title": "Optimization of frequency assignment",
            "venue": "IEEE Transactions on Communications, vol. 37, no. 10, pp. 1031\u20131041, 1989. [Online]. Available: http://ieeexplore.ieee.org/document/41158/",
            "year": 1989
        },
        {
            "authors": [
                "J.-T. Camino",
                "S. Mourgues",
                "C. Artigues",
                "L. Houssin"
            ],
            "title": "A greedy approach combined with graph coloring for non-uniform beam layouts under antenna constraints in multibeam satellite systems",
            "venue": "2014 7th Advanced Satellite Multimedia Systems Conference and the 13th Signal Processing for Space Communications Workshop (ASMS/SPSC). IEEE, sep 2014, pp. 374\u2013381.",
            "year": 2014
        },
        {
            "authors": [
                "X. Hu",
                "S. Liu",
                "R. Chen",
                "W. Wang",
                "C. Wang"
            ],
            "title": "A Deep Reinforcement Learning-Based Framework for Dynamic Resource Allocation in Multibeam Satellite Systems",
            "venue": "IEEE Communications Letters, vol. 22, no. 8, pp. 1612\u20131615, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "G. Dulac-Arnold",
                "N. Levine",
                "D.J. Mankowitz",
                "J. Li",
                "C. Paduraru",
                "S. Gowal",
                "T. Hester"
            ],
            "title": "Challenges of real-world reinforcement learning: definitions, benchmarks and analysis",
            "venue": "Machine Learning, apr 2021. [Online]. Available: https://link.springer.com/10.1007/s10994-021-05961-4",
            "year": 2021
        },
        {
            "authors": [
                "U. Park"
            ],
            "title": "A Dynamic Bandwidth Allocation Scheme for a Multi-spot-beam Satellite System",
            "venue": "ETRI Journal, vol. 34, no. 4, pp. 613\u2013616, aug 2012.",
            "year": 2012
        },
        {
            "authors": [
                "J.P. Choi",
                "V.W.S. Chan"
            ],
            "title": "Optimum power and beam allocation based on traffic demands and channel conditions over satellite downlinks",
            "venue": "IEEE Transactions on Wireless Communications, vol. 4, no. 6, pp. 2983\u20132993, nov 2005.",
            "year": 2005
        },
        {
            "authors": [
                "Heng Wang",
                "Aijun Liu",
                "Xiaofei Pan",
                "Luliang Jia"
            ],
            "title": "Optimal bandwidth allocation for multi-spot-beam satellite communication systems",
            "venue": "Proceedings 2013 International Conference on Mechatronic Sciences, Electric Engineering and Computer (MEC). IEEE, dec 2013, pp. 2794\u20132798.",
            "year": 2013
        },
        {
            "authors": [
                "A. Paris",
                "I. del Portillo",
                "B.G. Cameron",
                "E.F. Crawley"
            ],
            "title": "A Genetic Algorithm for Joint Power and Bandwidth Allocation in Multibeam Satellite Systems",
            "venue": "2019 IEEE Aerospace Conference. IEEE, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "P.V.R. Ferreira",
                "R. Paffenroth",
                "A.M. Wyglinski",
                "T.M. Hackett",
                "S.G. Bilen",
                "R.C. Reinhart",
                "D.J. Mortensen"
            ],
            "title": "Multiobjective Reinforcement Learning for Cognitive Satellite Communications Using Deep Neural Network Ensembles",
            "venue": "IEEE Journal on Selected Areas in Communications, vol. 36, no. 5, pp. 1030\u20131041, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "S. Salcedo-Sanz",
                "C. Bouso\u00f1o-Calz\u00f3n"
            ],
            "title": "A Hybrid Neural-Genetic Algorithm for the Frequency Assignment Problem in Satellite Communications",
            "venue": "Applied Intelligence, vol. 22, no. 3, pp. 207\u2013217, may 2005.",
            "year": 2005
        },
        {
            "authors": [
                "G. Cocco",
                "T. De Cola",
                "M. Angelone",
                "Z. Katona",
                "S. Erl"
            ],
            "title": "Radio Resource Management Optimization of Flexible Satellite Payloads for DVB-S2 Systems",
            "venue": "IEEE Transactions on Broadcasting, vol. 64, no. 2, pp. 266\u2013280, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "J.J.G. Luis",
                "E. Crawley",
                "B. Cameron"
            ],
            "title": "Applicability and Challenges of Deep Reinforcement Learning for Satellite Frequency Plan Design",
            "venue": "2021 IEEE Aerospace Conference. IEEE, mar 2021, pp. 1\u201311.",
            "year": 2021
        },
        {
            "authors": [
                "N. Pachler de la Osa",
                "M. Guerster",
                "I. Portillo Barrios",
                "E. Crawley",
                "B. Cameron"
            ],
            "title": "Static beam placement and frequency plan algorithms for LEO constellations",
            "venue": "International Journal of Satellite Communications and Networking, p. sat.1345, aug 2020.",
            "year": 2020
        },
        {
            "authors": [
                "G. Maral",
                "M. Bousquet"
            ],
            "title": "Satellite communications systems: systems, techniques and technology",
            "year": 2011
        },
        {
            "authors": [
                "LLC Gurobi Optimization"
            ],
            "title": "Gurobi Optimizer Reference Manual",
            "venue": "2022. [Online]. Available: https://www.gurobi.com",
            "year": 2022
        },
        {
            "authors": [
                "S. Aliaga",
                "J.J. Garau-Luis",
                "E. Crawley",
                "B. Cameron"
            ],
            "title": "Dynamic resource management algorithm reconfiguration for multibeam satellite constellations",
            "venue": "2021 IEEE Aerospace Conference. IEEE, mar 2022.",
            "year": 2021
        },
        {
            "authors": [
                "ETSI EN 302 307-2"
            ],
            "title": "Digital Video Broadcasting (DVB); Second generation framing structure, channel coding and modulation systems for Broadcasting, Interactive Services, News Gathering and other broadband satellite applications; Part 2: DVB-S2 Extensions (DVB-S2X)",
            "venue": "Tech. Rep., 2015.",
            "year": 2015
        }
    ],
    "sections": [
        {
            "text": "Upcoming large satellite constellations and the advent of tighter steerable beams will offer unprecedented flexibility. This new flexibility will require resource management strategies to be operated in highdimensional and dynamic environments, as existing satellite operators are unaccustomed to operational flexibility and automation. Frequency assignment policies have the potential to drive constellations\u2019 performance in this new context, and are no exception to real-time and scalability requirements. The majority of frequency assignment methods proposed in the literature fail to fulfill these two requirements, or are unable to meet them without falling short on bandwidth and/or power efficiency. In this paper we propose a new frequency assignment method designed to prioritize operational requirements. We present an algorithm based on Integer Linear Programming (ILP) that is able to fully define a frequency plan while respecting key system constraints such as handovers and interference. We are able to encode operators\u2019 goals such as bandwidth maximization or power reduction and produce optimal or quasioptimal plans according to such objectives. In our experiments, we find our method is able to allocate at least 50% more bandwidth and reduce power consumption by 40% compared to previous operational benchmarks. The performance advantage of our method compared to previous solutions increases with the dimensionality of the constellation; in an experiment with a 5,000-beam MEO constellation we find that we can allocate three times more bandwidth.\nIndex Terms\nJ. Garau-Luis, G. Casadesus, N. Pachler, E. Crawley, and B. Cameron are with the Aeronautics and Astronautics department, Massachusetts Institute of Technology, Cambridge, MA, USA. S. Aliaga is with the Electrical Engineering and Computer Science department, Northeastern University, Cambridge, MA, USA.\nCorresponding author: Juan Jose Garau-Luis (garau@mit.edu) This work has been submitted to the IEEE for possible publication. Copyright may be transferred without notice, after which\nthis version may no longer be accessible.\nar X\niv :2\n20 4.\n12 49\n4v 1\n[ cs\n.C E\n] 2\n6 A\npr 2\n2 Satellite communications, frequency assignment, multibeam constellations, resource management\nI. INTRODUCTION\nAlthough satellite operators have been in the market for many years, their operations still tend to be relatevely static\u2014in time. This is especially the case for spectrum allocation policies. When frequency plans do vary, the changes are generally manually-operated, in an effort to find margin. This process entails dealing with a complex optimization problem that has been long studied. However, upcoming changes in the satellite communications industry and the need for automation pose additional challenges to spectrum optimization which previous methods might not be able to address; new algorithmic approaches are required instead."
        },
        {
            "heading": "A. Motivation",
            "text": "Three trends define the new satellite communications landscape. First, new types of users are coming into the market. Spaceborne data services are expected to substantially grow in the coming years [1], and mobile users will constitute a significant fraction of this new demand [2]. In the past, operators could safely assume fixed terminal locations; moving forward, frequency assignment policies must account for location changes over time, which at the technical level involves considering time-dependant constraints. There is a need for effective mechanisms against highly dynamic and time-dependent environments.\nThe remaining two trends are a consequence of technological improvements. On the one hand, the introduction of highly flexible payloads is constituting a market disruption in terms of spectrum management strategies. Previously, frequency plans were generally fixed, but in the next generation of communication satellites, operators will be able to reconfigure frequency plans in orbit, intermittently, and on a beam level. Exploiting this flexibility, as well as other mechanisms such as frequency reuse, is key to reacting to demand changes and achieving efficient spectrum usage.\nOn the other hand, the dimensionality of some of the upcoming constellations constitutes an additional level of complexity. Examples include SpaceX\u2019s 4,408-satellite LEO constellation with up to 32 beams per satellite [3], [4] and SES\u2019s O3b mPOWER MEO constellation, consisting of 11 satellites able to power thousands of beams each [5]. Any future frequency management strategy needs to account for scalability, which challenges the adequacy of some spectrum optimization approaches considered in the past.\n3 This new context calls for revisiting the strategies and algorithms previously utilized to make frequency assignment decisions. This problem is not only NP-hard and highly constrained [6], but now it also demands algorithmic solutions that are fast and scale well in order to be successfully operated in upcoming high-dimensional and dynamic environments."
        },
        {
            "heading": "B. Literature Review",
            "text": "Previous studies focus on carrier assignment (i.e., which central frequency), bandwidth allocation (i.e., how much bandwidth), or both. Reference [7] addresses the carrier assignment problem, specifically targeting the recoloring problem by means of local search and the Simulated Annealing algorithm, after an initial greedy combinatorial optimization approach. With the scaling computational burden of classic optimization approaches in mind, other authors propose Artificial Intelligence (AI) algorithms as an alternative to try to meet the new requirements of the future scenarios. In [8], a Deep Reinforcement Learning (DRL) model is proposed to solve the Dynamic Channel Allocation (DCA) problem, and it is shown to closely match the performance of state-of-the-art DCA algorithms. While the online operation of such models consists of simple forward passes of a neural network \u2013 substantially faster than other methods \u2013 the robustness and stability of DRL models is still disputed in many real world scenarios [9].\nRegarding bandwidth allocation studies, in [10], a binary search-based method is proposed as a fairer alternative to the water-filling approach considered in [11]. A later study [12] also uses the same fairness-centered optimization objective but allocates bandwidth using convex optimization instead. However, the nature of future satellite constellations is not fully reflected in their analyses since both studies test their methods on single-satellite and single-gateway use cases with no more than 20 beams. In the AI domain, in [13] and [14], Genetic Algorithms and DRL are, respectively, used to allocate bandwidth in single-satellite systems. Both studies consider simultaneously optimizing other variables such as power or the roll-off factor, respectively, but the solution quality and robustness of these AI methods are not tested for larger systems.\nBoth classic optimization and AI approaches are also considered for the combined carrier assignment and bandwidth allocation problem. In [15] a neural network combined with a genetic algorithm is used to address the problem through an interference minimization lens; it is tested on multiple scenarios, with a maximum of 36 beams and 128 bandwidth channels. The same problem, with an extension to also optimize for power, is addressed in [16] using a capacityoriented objective function and the Simulated Annealing algorithm. Tests on a single satellite\n4 with 200 beams and 16 bandwidth channels show that this method reduces both the unmet capacity and the excess capacity in comparison to traditional approaches based on conventional payloads. While these studies focus on optimizing bandwidth and carrier simultaneously, further considerations such as frequency reuse mechanisms or dynamic environments are out of their scope.\nTwo works do account for reuse mechanisms and prove to be substantially faster than other approaches. First, the DRL-based method introduced in [17] uses an agent to simultaneously make carrier assignments, bandwidth allocation, and frequency reuse selection. Despite its ability to scale, this algorithm does not always satisfy the complete set of constraints. Second, the constraint satisfaction algorithm presented in [18] uses a greedy assignment strategy to produce valid frequency plans in short amounts of time. However, since beams are assigned one at a time without an objective function, its usefulness is unclear when the operator wishes to prioritize a specific metric (e.g., bandwidth maximization)."
        },
        {
            "heading": "C. Paper Objectives",
            "text": "Given the new industry needs and the flexibility and dimensionality of new systems, an efficient spectrum management algorithm for multibeam satellite constellations must be able to simultaneously address the carrier assignment and the bandwidth allocation problems for constellations with up to thousands of satellites or beams. In addition, new frequency reuse mechanisms should be taken into account as key efficiency drivers, and an algorithm with a small computing burden is preferred given the dynamic behavior of the users. All the studies presented fail to address this complete set of requirements. Furthermore, none consider optimizing for multiple satellites simultaneously, and frequency reuse mechanisms are rarely included as an additional optimization dimension.\nTo try to close this research gap, we propose a frequency plan design algorithm based on Integer Linear Programming (ILP) that optimizes for carrier assignment, bandwidth allocation, and frequency reuse on the beam level in multibeam satellite constellations. The algorithm produces optimal or quasi-optimal plans according to an objective function, and these plans respect interference and handover constraints. The objective function can reflect multiple goals, such as maximizing bandwidth, minimizing frequency reuse, and minimizing power. We show that our algorithm can be adapted to address multiple scenarios including non-Geostationary Orbits (NGSO), dynamic environments, and high-dimensional constellations.\n5"
        },
        {
            "heading": "D. Paper Structure",
            "text": "The remainder of this paper is structured as follows: Section II presents the frequency plan design problem, the assumptions considered and the constraints involved; Section III introduces the optimization method based on Integer Linear Programming, together with the requirements that can be encoded in the objective function; Section IV discusses the results of applying our optimization algorithm to different scenarios; and finally Section V remarks the conclusions of the paper."
        },
        {
            "heading": "II. PROBLEM STATEMENT",
            "text": "As depicted in Figure 1, we consider a satellite constellation with NS identical multibeam satellites, all of them in the same orbital plane. The constellation serves multiple users and gateways on Earth, which we assume have already been grouped into NB beams. Each beam constantly serves its gateway or its group of users, which might be mobile \u2014the beam then \u201cfollows\u201d the users. At any point in time, each beam is powered from one \u2014and just one\u2014 of the satellites of the constellation. If the orbit of the satellites is NGSO, then handover operations take place and the satellite powering each beam changes over time. Our goal is to design a frequency plan for this constellation, which consists of completely defining frequency utilization for all beams.\nIn terms of frequency resources, we assume all satellites are allowed to use the exact same part of the spectrum, which is divided into NBW equal bandwidth chunks or slots. Likewise, all\n6\nsatellites have identical frequency reuse mechanisms:\nthere are NFR frequency reuses available, as well as NP polarizations for each reuse. Polarizations allow to use more spectrum in a concentrated area without incuring into additional interference. For example, NP = 2 when using right-handed and left-handed circular polarizations (RHCP and LHCP, respectively). For each beam, the operator must decide how many bandwidth slots are assigned and which reuse group and polarization should be used.\nFormally, a complete frequency plan is defined as the assignment, for every beam b \u2208\n{1, ..., NB}, of the following elements:\n\u2022 A discrete number of bandwidth slots bb, which can\u2019t be greater than NBW . \u2022 A positive integer fb, that indicates the first bandwidth slot used. Beam b then uses slots\nfb, fb + 1, ..., fb + bb \u2212 1, all of them part of the available spectrum.\n\u2022 A positive integer rb representing a frequency reuse out of the NFR available. \u2022 In case NP = 2, a binary variable representing the chosen polarization.\nFigure 2 introduces a representation of this decision space in the form of a grid, with NFR \u00b7NP rows and NBW columns. Each column represents a frequency slot, whereas each row corresponds to a combination of a frequency reuse and a polarization. As shown in the figure, rows are sorted, first, by frequency reuse, and second, by polarization. With this representation, making a frequency assignment for a beam turns into picking a specific cell in the grid corresponding to the first slot (black squares in the figure) and choosing a valid number of slots (colored cells).\nAs previously described, based on the upcoming satellite communications landscape, we\n7\nassume all satellites have digital and flexible payloads. Therefore, during operations, we assume any of the assignment parameters can be changed in real-time at negligible cost. Generally though, the operator will choose to make changes to the frequency assignment of certain beams whenever those beams undergo a handover. If the frequency assignment of a beam is not changed during the handover, then the beam utilizes the same frequency assignment on the new satellite. This is depicted in Figure 3, in which the green beam switches from satellite 1 to satellite 2 and preserves the same frequency reuse, polarization, and bandwidth slots.\nWhen a handover occurs, it is critical that the resources to be used on the new satellite are not being used by any other beam already. This constitutes an important constraint when making frequency assignment decisions for a NGSO constellation and applies to any pair of beams being powered by the same satellite at any point in time. We define this constraint for a pair of beams as an intra-group restriction between those beams. Then, the set RA represents all pairs (i, j) such that beams i and j hold an intra-group restriction. We assume that this set is known in advance and is externally updated during operation if needed.\nThere is another type of constraint to consider. If two beams whose footprints are close use the same polarization, they might interfere with each other if their assigned frequency slots overlap. This event, which we define as an inter-group restriction, is represented in Figure 4. Similarly to the handover constraint case, the set RE encodes all pairs of beams (i, j) that hold an inter-group restriction. This set is constructed following some interference criteria (e.g., SINR level, angular\n8\ndistance threshold) and might be time-dependant if the constellation serves mobile users."
        },
        {
            "heading": "III. PROPOSED OPTIMIZATION METHOD",
            "text": "In this section we encode each decision and restriction presented in the previous section as variables and constraints of an optimization method based on Integer Linear Programming (ILP). In the context of satellite resource allocation, methods such as ILP allow operators to easily encode problem needs, objectives, and constraints with low granularity with respect to the decision variables. Then, there exist multiple commercially-available tools that automatically produce the solution of each program.\nIn each subsection we outline how a specific feature of the frequency assignment problem is encoded in the ILP formulation using linear operators. We also give an overview of possible objective functions to guide the search to select the best feasible frequency plan. We assume the constraint sets RA and RE are an input to the model."
        },
        {
            "heading": "A. Frequency Plan Decisions",
            "text": "On the beam level, the frequency assignment decisions consist of choosing how many bandwidth slots, which ones, and which frequency reuse and polarization to use. From the perspective of the grid representation introduced in Figure 2, this means selecting 1) a column and 2) a row in the grid, and then 3) a number of consecutive slots. We encode the column (i.e., the first slot) as an integer variable fi, with domain {1, NBW}, for each beam i \u2208 {1, ..., NB}. Then we encode the row (i.e., frequency reuse and polarization) as an integer variable gi, with domain\n9 {1, ..., NFR \u00b7NP}. Finally, the number of consecutive slots is encoded as an integer variable bi, with the same domain as fi. We introduce these variables in the ILP formulation as follows:\nfi \u2208 {1, ..., NBW}, \u2200 i \u2208 {1, ..., NB} (1)\ngi \u2208 {1, ..., NFR \u00b7NP}, \u2200 i \u2208 {1, ..., NB} (2)\nbi \u2208 {1, ..., NBW}, \u2200 i \u2208 {1, ..., NB} (3)\nAny frequency plan can then be decoded using these three variables per beam. The optimization method returns these values to the operator."
        },
        {
            "heading": "B. Constraint: Limited spectrum",
            "text": "We now start accounting for the constraints of the problem. We first encode the constraint that all bandwidth slots used must be within the limits imposed by the system (i.e., only the NBW considered slots can be used). This is encoded as follows:\nfi + bi \u2212 1 \u2264 NBW , \u2200i \u2208 {1, ..., NB} (4)"
        },
        {
            "heading": "C. Auxiliary variables: relative spectrum location",
            "text": "The remaining constraints account for the intra-group and inter-group restrictions. Simply put, both of these restrictions involve the need to avoid spectrum overlaps for certain pairs of beams. For instance, if beams i and j hold a restriction, and are assigned to the same frequency reuse and polarization (i.e., gi = gj), we want to make sure that fi + bi \u2264 fj or fj + bj \u2264 fi, i.e., we want to ensure that beam i has allocated spectrum either to the left or to the right of beam j, but without overlapping. Before diving into the actual restrictions, these two possibilities need to be encoded in the optimization formulation in order to preserve linearity. To that end, we use binary variables zij and add the following constraints:\nzij \u2208 {0, 1}, \u2200 i, j s.t. (i, j) \u2208 R (5)\nfj \u2212 fi \u2265 0\u2212M(1\u2212 zij), \u2200 i, j s.t. (i, j) \u2208 R (6)\nfi \u2212 fj \u2265 \u2212Mzij, \u2200 i, j s.t. (i, j) \u2208 R (7)\nwhere M is a \u201csufficiently large\u201d number, is a very small positive number, and R represents the union RA \u222aRE . Given a restriction (i, j), if zij = 1, (6) is active and enforces that fj \u2265 fi (i.e., beam j can not use lower frequencies than beam i\u2019s). On the contrary, if zij = 0, (7) is active and the effect is the opposite.\n10"
        },
        {
            "heading": "D. Constraint: Intra-group or handover restrictions",
            "text": "We start by considering the intra-group restrictions, given by the set RA. This type of restrictions are caused by handover operations and are relevant if and only if constrained beams use the same frequency reuse and polarization. To first encode this condition linearly, we define auxiliary binary variables yij alongside the following constraints:\nyij \u2208 {0, 1}, \u2200 i, j s.t. (i, j) \u2208 RA (8)\ngi \u2265 gj \u2212M(1\u2212 yij), \u2200 i, j s.t. (i, j) \u2208 RA (9)\ngi \u2264 gj +M(1\u2212 yij), \u2200 i, j s.t. (i, j) \u2208 RA (10)\nIf yij = 1, the method enforces that gi = gj , since both (9) and (10) are active. If yij = 0, the opposite should occur; however, this can not be achieved solely with variable yij . To enforce strict inequality when yij = 0, we introduce binary variables pij to account for both cases gi > gj and gj > gi. Hence, we add the following constraints:\npij \u2208 {0, 1}, \u2200 i, j s.t. (i, j) \u2208 RA (11)\ngi \u2212 gj \u2265 \u2212M(1\u2212 pij + yij), \u2200 i, j s.t. (i, j) \u2208 RA (12)\ngi \u2212 gj \u2264 \u2212 +M(pij + yij), \u2200 i, j s.t. (i, j) \u2208 RA (13)\nwhich are active if and only if yij = 0. In that case, and when pij = 1, (12) is active and we have gi > gj . On the contrary, if pij = 0, (13) is active and gj > gi holds. To summarize the effect of the auxiliary variables introduced so far, Table I shows how the different frequency assignment cases between two beams holding an intra-group restriction are encoded by means of variables zij , yij , and pij .\nFinally we introduce the constraints that encode the intra-group restrictions:\nfi + bi \u2264 fj +M(2\u2212 yij \u2212 zij), \u2200 i, j s.t. (i, j) \u2208 RA (14)\nfj + bj \u2264 fi +M(1\u2212 yij + zij), \u2200 i, j s.t. (i, j) \u2208 RA (15)\nwhere M is again a \u201csufficiently large\u201d number. These constraints enforce a non-overlapping frequency assignment between beams i and j holding an intra-group restriction if and only if both beams use the same reuse group and polarization (yij = 1). Constraint (14) does so for the case in which zij = 1 (fi \u2264 fj), whereas constraint (15) is active when zij = 0 (fi > fj).\n11"
        },
        {
            "heading": "E. Constraint: Inter-group or interference restrictions",
            "text": "The inter-group restrictions are given by set RE and concern all pairs of beams with close footprints, which might interfere with each other during operations. Setting a threshold for how close two interfering beams can be is up to the operator\u2019s policy, which might prefer to trade additional inter-group restrictions for further interference mitigation. One way to define this set might be to impose an angular distance threshold between beams; we leave this decision out of the scope of this paper.\nAs introduced in Figure 4, this type of restrictions can negatively impact the performance of the system when both beams are using the same polarization, regardless of their frequency reuse. To specifically focus on polarization, we first introduce the following variables and constraints:\nki \u2208 {1, ..., NFR}, \u2200 i \u2208 {1, ..., NB} (16)\nmi \u2208 {0, NP \u2212 1}, \u2200 i \u2208 {1, ..., NB} (17)\ngi = NPki \u2212mi, \u2200 i \u2208 {1, ..., NB} (18)\nVariable ki encodes the frequency reuse assigned to beam i whereas variable mi encodes its polarization, if any.\nSimilar to constraints (8) - (10), we introduce binary variable sij for each pair of beams holding an inter-group constraint. This variable encodes whether beams i and j use the same\n12\npolarization, by means of the following constraints:\nsij \u2208 {0, NP \u2212 1}, \u2200 i, j s.t. (i, j) \u2208 RE (19)\nmi \u2265 mj \u2212Msij, \u2200 i, j s.t. (i, j) \u2208 RE (20)\nmi \u2264 mj +Msij, \u2200 i, j s.t. (i, j) \u2208 RE (21)\nIf sij = 0 then both (20) and (21) are active, and mi and mj are enforced to be equal. Note that in case NP = 1, then sij is always zero, since there is only one polarization.\nThen, following the same idea behind constraints (11) - (13), we use binary variable dij to help encoding whether mi > mj or mj > mi, i.e., enforcing mi and mj to be different in case there is more than one polarization and sij = 1. The following constraints explain this idea:\ndij \u2208 {0, 1}, \u2200 i, j s.t. (i, j) \u2208 RE (22)\nmi \u2212mj \u2264 \u2212 +M(1 + dij \u2212 sij), \u2200 i, j s.t. (i, j) \u2208 RE (23)\nmi \u2212mj \u2265 \u2212M(2\u2212 dij + sij), \u2200 i, j s.t. (i, j) \u2208 RE (24)\nwhich can only be active if sij = 1 (more than one polarization). Then, if dij = 0, (23) is active and therefore mj > mi. On the other hand, if dij = 1, (24) is active and mi > mj . Table II summarizes all cases that inter-group restrictions-related auxiliary variables encode.\nLastly, the actual constraints encoding the inter-group restriction interactions are the following:\nfi + bi \u2264 fj +M(1 + sij \u2212 zij), \u2200 i, j s.t. (i, j) \u2208 RE (25)\nfj + bj \u2264 fi +M(sij + zij), \u2200 i, j s.t. (i, j) \u2208 RE (26)\nThese constraints enforce a non-overlapping assignment between beams i and j holding an intergroup restriction if and only if both beams use the same polarization (sij = 0). Constraint (25)\n13\ndoes so for the case in which zij = 1 (fj \u2265 fi), whereas constraint (26) is active when zij = 0 (fi > fj)."
        },
        {
            "heading": "F. Objective Function",
            "text": "So far, we have discussed the decisions and constraints that need to be encoded to define valid frequency plans, i.e., plans that do not violate any constraint. However, we have not addressed how to prioritize different valid frequency plans according to the operator\u2019s preferences and goals. In certain occasions, operators might prefer plans that maximize bandwidth allocation or plans that use as few frequency reuses as possible. To encode these preferences into the ILP formulation, we propose the following objective function to be maximized:\nmax NB\u2211 i=1 (\u03b21,ibi \u2212 |\u03b22,i|gi \u2212 |\u03b23,i|fi \u2212 |\u03b24,i|Pi(fi, bi)) (27)\nwhere \u03b21,i, \u03b22,i, \u03b23,i, and \u03b24,i are weighting parameters for beam i, with \u03b2k,i \u2208 R. This function combines four different objectives:\n1) \u03b21,ibi focuses on maximizing allocated bandwidth for beam i, or minimizing it in case\n\u03b21,i < 0. A better control over used bandwidth can lead to a more efficient power consumption. 2) \u2212|\u03b22,i|gi attempts to use as few frequency reuses as possible, which is the case if |\u03b22,i| > 0.\nSetting \u03b22,i = 0 for all beams enables a uniform use of frequency reuses and polarizations. The coefficient \u03b22,i uses absolute terms because the effects of maximizing and minimizing gi are symmetric according to our formulation. 3) \u2212|\u03b23,i|fi seeks to have the same effect on the number of frequency slots used. If \u2212|\u03b23,i| <\n0, lower parts of the spectrum are prioritized. If \u03b23,i = 0, then the spectrum is used uniformly. We specifically subtract this term given lower frequencies may require less power consumption, and therefore are sometimes preferred by operators. 4) If available, \u2212|\u03b24,i|Pi(fi, bi) directly represents the RF power consumed by beam i when\nusing slots fi, fi + 1, ..., fi + bi\u2212 1. Reducing RF power when possible is reflected by this operand when \u03b24,i > 0. In our experiments, this metric does not correspond to a linear combination of variables per se. In the following section we provide additional details on its computation.\n14\nThe weighting parameters are used to define a priority hierarchy over these objectives. While these parameters can be identical for all beams, operators might be interested in prioritizing additional bandwidth or certain bands for specific beams, for example."
        },
        {
            "heading": "G. Additional design constraints",
            "text": "The variables and constraints presented so far encode the necessary information connected to the main decisions and main restrictions of the problem. There are other type of considerations that are not critical to operation or might not always be applicable but might be part of the operator\u2019s desiderata. We describe them next.\n1) Minimum bandwidth requirement: We have defined the bandwidth variable (3) with domain {1, ..., NBW}. However, we might be interested in specifying higher lower bounds, for contractual reasons or since using a single bandwidth slot might not be enough to satisfy the link budget equation [19] for certain beams. This way, we could redefine variable (3) as\nbi \u2208 {ci, ..., NBW}, \u2200 i \u2208 {1, ..., NB} (3)\nwhere ci is the minimum number of slots that beam i requires.\n2) Business constraints: While not a requirement of the problem per se, operators might prefer to first split frequency resources between different sets of users. For instance, specific frequency reuses might be saved for mobile users or the spectrum might be partitioned according to user latitudes. These constraints can be easily encoded in the ILP formulation by modifying the corresponding domains of variables (2) and (3).\n3) Active and inactive beams: In this work we have assumed a feasible solution is always possible. However, we might find ourselves in the unlikely scenario in which the operator must turn off certain beams in order to achieve constraint satisfaction. In this case, which beams to turn off and how to redesign the frequency assignment constitutes a different optimization problem that needs additional variables. Specifically, variables ai are introduced to encode whether beam i should be active or inactive/turned off in the plan. We describe the remaining changes with respect to the presented ILP formulation in Appendix A."
        },
        {
            "heading": "IV. RESULTS",
            "text": "In this section we present and discuss the results and performance of the proposed frequency plan optimization method. Specifically, we carry out three different experiments to validate its\n15\nusefulness: 1) first, we test our algorithm on three low-dimensional scenarios in which spectrum usage maximization is required. 2) In the second experiment, we study the scalability of our method by optimizing the frequency assignment in larger systems. To that end, we introduce an iteration-based optimization procedure that allows us to decrease the overall optimization time when needed. Finally, 3) in the third experiment, we consider a multibeam satellite constellation based on a real large constellation and a realistic user distribution to assess the benefits of using our approach to reduce on-board power consumption.\nIn all cases, the experiments make use of a representative example of a MEO constellation system, the O3b mPOWER constellation filed by O3b limited [20]. In this case, it has NS = 7 satellites, each capable of using NP = 2 polarizations. User distributions as well as gateway locations are provided by SES S.A. based on realistic configurations. In our analyses, we focus on optimizing the downlink frequency assignment, and vary the number of beams NB, frequency reuses NFR, and bandwidth slots NBW to represent scenarios with different spectrum availability. The specific parameters considered in each of the three experiments are summarized in Table III. The variable Nch corresponds to a feature of the iteration-based procedure described in Section IV-B. We use a commercial solver, Gurobi, for our experiments [21].\nBefore the method begins the optimization, given a particular user distribution, we use the beam placement algorithm described in [18] to determine the required number of beams and their positions. We also make use of the heuristic frequency assignment algorithm described in the same reference as a baseline benchmark throughout the remainder of the paper. In addition, this algorithm serves as a warm-start when using the iteration-based procedure detailed in Section IV-B. Based on this beam placement, we consider two beams will have an inter-group\n16\nor interference restriction if the center of their footprints is closer than four times the half-cone angle."
        },
        {
            "heading": "A. Experiment 1: Maximizing Bandwidth Allocation",
            "text": "In this experiment, our goal is to verify the behavior of the optimization method by maximizing bandwidth allocation in three scenarios with an increasing number of users and, in turn, an increasing number of beams, as described in Table III. We encode bandwidth allocation maximization in the proposed objective function (27) by adjusting the weighting parameters as follows:\n\u03b21,i = 1, \u03b22,i = \u03b23,i = \u03b24,i = 0, \u2200i \u2208 {1, ..., NB}\nTo quantify the performance of our method and compare it against others, we use the normalized total assigned bandwidth for both the heuristic (BWHEU ) and optimized (BWILP ) frequency plans. This metric is defined as follows:\nBW = 1\nCtot NB\u2211 i=1 bi (28)\nwhere Ctot is the total system capacity, defined as the total number of frequency slots available in the constellation:\nCtot = NS \u00b7NBW \u00b7NFR \u00b7NP (29)\nAs mentioned, the rationale behind improving spectrum utilization is that it generally results in lower power consumption, without explicitly resorting to the introduction of power considerations in the formulation by means of parameters \u03b24,i. We explore this case in Section IV-C. While we do not restrict the maximum bandwidth that can be assigned per beam, in real operations this might be necessary due to spectral efficiency considerations [19]. If needed, a bandwidth upper bound can be also encoded in our formulation.\nFigure 5 shows the frequency assignment at a specific instant for one of the satellites when using the heuristic algorithm and when using our method. Each colored region represents the frequency slots assigned to a beam. As observed, the colored region of the plot is substantially larger when using our method. Since the plot represents the frequency assignment for a specific time instant corresponding to a specific routing of beams to satellites, unassigned slots might be reserved for beams that are soon to undergo or have recently undergone handover operations in the simulation.\n17\nTo quantify the increase in the assigned bandwidth, Table IV presents the normalized total assigned bandwidth for the heuristic algorithm and our method in the three test scenarios. The results show that our optimization method achieves up to a 73% bandwidth increase with respect to the heuristic baseline solution in the scenario with 100 users, while satisfying all frequency and handover constraints.\nAn increase in the number of beams might not be proportional to an increase in the total number of frequency slots that we are able to allocate. This is clearly reflected by the values of BWILP presented in Table IV, since moving from 96 beams to 118 beams entails a total assigned bandwidth increase, but the effect of moving from 118 beams to 182 beams is the opposite. In the latter case, when increasing the number of beams, the number of intra- and inter-group constraints also increases, and therefore frequency assigments can not exploit more frequency slots in order to avoid frequency overlaps. Still, our method makes the best assignment possible regardless of the number of constraints.\n18"
        },
        {
            "heading": "B. Experiment 2: Iteration-based extension and computing time tradeoffs",
            "text": "In this experiment we test the scalability of our method and develop an iteration-based procedure to reduce the computing time in high-dimensional scenarios. As the dimensionality of both the constellation and user base increase, making frequency decisions in real time becomes more challenging, since the number of constraints scales quadratically with the number of beams. If computing time is a constraint, there is a point in which every algorithm\u2014even state-of-the-art ones\u2014must make tradeoffs in order to meet time requirements. We explore the tradeoffs of our method in this section.\nA method to speed up the optimization when dimensionality is large is presented in Appendix B. In this modified approach, we transform the prior formulation to an iteration-based approach where the search space is restricted to interesting regions. For each beam, we select a few variable assignments for each decision variable and let the solver choose the best combinations across beams. In each iteration, the optimization algorithm changes the frequency assignment of Nch beams, while the rest are kept fixed. Although the algorithm can make frequency decisions without any prior input, we found that using a complete suboptimal frequency plan as a warmstart substantially decreases runtime. There is no requirement of validity for the warm-start frequency plan, since our method can amend violated constraints or deactivate beams. In our experiments, we use the frequency plan provided by the heuristic algorithm presented in [18] as a warm-start. In general, we achieve a significant reduction in the number of variables and constraints that are considered in each call to the optimizer.\nTo test the iterative optimization method, we use a scenario with higher dimensionality, with NFR = 20 frequency reuses, NBW = 200 bandwidth slots, and NU = 1, 000 users. The users and their corresponding gateways are connected using NB = 1, 060 beams. We therefore increase both the search space \u2014more resources\u2014 and the constraint set \u2014more beams\u2014 compared to the first experiments. We still optimize the frequency plan to maximize the allocated bandwidth.\n19\nWe run the algorithm using three different configurations: Nch = 25, 50, and 100 changes at each iteration. The beams assigned at every iteration are chosen randomly and we do not impose any restriction on how many times a single beam can undergo assignment. Given the nature of the procedure, we might require specific beams to be reassigned in different iterations before converging to a stable solution. In our experiments we run the algorithm until getting this stable solution; we consider it is reached when the total allocated bandwidth does not increase during 50 consecutive iterations. Since we introduce stochastic elements, we run the algorithm 10 times for each of the selected Nch and report statistics on the 10 runs.\nTable V presents the results of using the iterative approach to reach a stable solution in less time when using Nch = 25, 50, and 100. We compare the total assigned bandwidth increase with respect to the warm-start and the computing time (wall-clock time). The value of Nch is directly related to the tradeoff between computing time and number of iterations. In all cases, we are able to find a global frequency assignment that more than triples the total assigned bandwidth without violating any constraints of the system. When using Nch = 25 we do so in less than one third the amount of time required for Nch = 100, although, since we are assigning fewer beams at a time, we observe that the improvement per iteration is lower, as graphically represented in Figure 6. The average total number of assignments, i.e. Nch \u00b7 Nit, is approximately 1.1 \u00d7 105, 1.6\u00d7105, and 2.0\u00d7105 for Nch = 25, 50, and 100, respectively. Note that this is about two orders of magnitude higher than the number of beams (NB = 1, 060 in these experiments). Table VI provides additional insights on the time and iterations it takes to increase the bandwidth by 100%, 200%, and 300%. Generally, we can observe our method achieves 80% of the improvement in less than 20% of the convergence time.\nWith these experiments, we assess that the iteration-based procedure enables the scalability of our optimization method, which is an important requirement for future high-dimensional constellation operations. Although limiting the number of beams that the optimization algorithms can modify significantly reduces the dimensionality of the solution space, the performance improvement comes at the expense of converging to suboptimal solutions and, therefore, needing to assign around one hundred times more beams in total. Nonetheless, robustness and fast reaction times are generally preferred over optimality when operating in highly dynamic and time-dependent environments, where the feasibility of the frequency assignment might be only temporary. Appropriately setting hyperparameters such as Nch is key in those cases [22].\n20"
        },
        {
            "heading": "C. Experiment 3: Minimizing Power Consumption in a Real-World Scenario",
            "text": "Finally, in this third experiment, we demonstrate the benefits of using our method to optimize the frequency assignment in a realistic scenario with a large-scale constellation and user base. The user data is provided by SES S.A. and includes throughput demand for 20,000 users located around the globe which, after running our beam placement algorithm, are grouped into approximately 5,000 beams (see Appendix C). In this experiment we prioritize directly reducing power consumption by leveraging the fourth term of the objective function equation (27), \u2212|\u03b21,i|Pi(fi, bi). For the purposes of this section, we understand Pi as a linear function that returns the consumed power for beam i given its fi and bi assignments. Its full implementation details into the formulation are described in Appendix D.\nFigure 7 shows the warm-start (heuristic baseline algorithm) and the optimized frequency\n21\n22\nplan (our method) for the seven satellites of the constellation at one moment of the simulation. For this experiment, we run the iterative implementation of the optimization algorithm with Nch = 50 until a stable solution is reached, as it can provide a solution under real-time operational constraints. The results presented in Table VII show that using our method reduces the power consumption by up to a 40% after fewer than 2,500 iterations. This is achieved by increasing the total allocated bandwidth by more than 250%, which can be observed in Figure 7: the optimized plan has significantly larger colored regions, i.e., assigned frequency slots, as well as several unused combinations of a frequency reuse and polarization.\nThe results of this experiment demonstrate that the framework with the iteration-based procedure is able to substantially improve the frequency assignment in a high-dimensional, realworld-based system. The algorithm is able to navigate the search space of this highly-constrained problem and change the frequency allocation of beams to decrease the overall power consumption. The number of changes per iteration Nch and the total number of iterations can be modified to adjust the system\u2019s operation to meet any possible time requirements. Although we used a specific representative constellation for our experiments, our framework can be adapted to constellations with different flexibilities: number of satellites and planes, number of frequency reuses and slots, additional operational constraints, etc."
        },
        {
            "heading": "V. CONCLUSION",
            "text": "In this paper, we have addressed the need to develop a frequency assignment optimization algorithm that accounts for the flexibility and dimensionality of the upcoming communication satellite operations. Our optimization framework leverages the use of frequency reuse mechanisms to efficiently handle carrier and bandwidth assignment for multisatellite constellations with thousands of beams while respecting handover and frequency constraints, a set of requirements that has previously not been addressed altogether. Our method is based on Integer Linear Programming and produces optimal or quasi-optimal frequency plans according to a flexible objective function that allows encoding multiple goals such as maximizing bandwidth, minimizing the number of\n23\nactive frequency reuses, and minimizing RF power consumption. We have also presented an iteration-based implementation of the framework that not only enables its operation in highdimensional use cases but also introduces degrees of flexibility to configure it depending on the scenario and computing time constraints.\nWe have carried out three different experiments to validate the performance, scalability, and potential real-world operability of our method, respectively. The results of the first experiment prove the ability of the framework to efficiently solve the frequency plan design problem, achieving a 73% improvement on the total allocated bandwidth in simple scenarios. The iterative optimization method analyzed in the second experiment is able to optimize the frequency assignment in higher-dimensional scenarios, achieving over a 300% improvement on spectrum usage in a time-efficient manner. Finally, the results from the third experiment demonstrate the benefits of using our framework in a real-world scenario with approximately 20,000 users and 5,000 beams. In this case, the framework increases the allocated bandwidth but prioritizes making an efficient use of frequency reuses and polarizations in order to achieve a 40% reduction in on-board power consumption."
        },
        {
            "heading": "APPENDIX A",
            "text": "OPTIMIZATION WITH ACTIVATION VARIABLES\nIt is possible that, given the constraints of the problem, not all conditions can be met and hence feasibility can not be guaranteed. To minimize the impact in those situations, some beams can be turned off and their assigned resources reallocated. We introduce binary variables ai to encode whether beam i should be active or not:\nai \u2208 {0, 1}, \u2200 i \u2208 {1, . . . , NB} (30)\nIf beam i is active, then ai = 1. Now these variables need to be taken into consideration when specifying the rest of the constraints of the program. Below we describe the changes to the constraints presented in the original framework."
        },
        {
            "heading": "A. Limited spectrum",
            "text": "If the maximum number of bandwidth slots available are not enough for beam i to satisfy the link budget equations [19], the beam should be turned off. To encode this scenario we modify\n24\nconstraint (4) and add the activation variables:\nfi + bi \u2212 1 \u2264 NBW +M(1\u2212 ai), \u2200i \u2208 {1, ..., NB} (4)\nHere, variable M represents a \u201csufficiently large\u201d number, such that this constraint has no effect if beam i is not active (ai = 0).\nB. Intra-group restrictions\nOther reasons why we might need to turn off certain beams are related to intra-group and intergroup restrictions. Regarding the former, constraints (14) and (15) can be extended to account for beam activation:\nfi + bi \u2212M(1\u2212 ai) \u2264 fj +M(3\u2212 aj \u2212 yij \u2212 zij), \u2200 i, j s.t. (i, j) \u2208 RA (14)\nfj + bj \u2212M(1\u2212 aj) \u2264 fi +M(2\u2212 ai \u2212 yij + zij), \u2200 i, j s.t. (i, j) \u2208 RA (15)\nNow these constraints prevent frequency overlap between beams i and j holding an intra-group restriction if and only if both beams are active (ai = 1 and aj = 1).\nC. Inter-group restrictions\nSimilarly, the constraints encoding the inter-group restrictions (25) and (26) are also extended:\nfi + bi \u2212M(1\u2212 ai) \u2264 fj +M(2\u2212 aj + sij \u2212 zij), \u2200 i, j s.t. (i, j) \u2208 RE (25)\nfj + bj \u2212M(1\u2212 aj) \u2264 fi +M(1\u2212 ai + sij + zij), \u2200 i, j s.t. (i, j) \u2208 RE (26)"
        },
        {
            "heading": "D. Objective function",
            "text": "Finally, to prevent the framework from unnecessarily turning off beams to improve the objective function (27), we include an additional term in the function that accounts for beam activation:\nmax NB\u2211 i=1 (\u03b21,ibi \u2212 |\u03b22,i|gi \u2212 |\u03b23,i|fi \u2212 |\u03b24,i|Pi(fi, bi) + |\u03b25,i|ai) (27)\nBy increasing the weight of parameter \u03b25,i \u2208 R the framework will prioritize having beam i active to maximizing any of the other elements of the function.\n25"
        },
        {
            "heading": "APPENDIX B",
            "text": "ITERATION-BASED OPTIMIZATION FORMULATION\nThere are two main factors that influence the computing time of an ILP formulation: the number of decisions to make and the dimensionality of the search space. An efficient formulation is able to reduce both of those factors without compromising the quality of the solution. The following lines describe the improved iteration-based ILP formulation used in Sections IV-B and IV-C. Note that, contrary to the initial formulation, the speed-ups proposed do not guarantee convergence or optimality over the final solution, but substantially reduce the amount of computing time needed to obtain a good enough result."
        },
        {
            "heading": "A. From full-optimization to an iteration-based approach",
            "text": "The first element to notice is that optimizing a large number of beams at the same time entails a high-dimensional combinatorial problem. Without accounting for interference restrictions, each beam has an order of NFRNPN2BW possibilities: for each beam, we can decide the frequency reuse, polarization, initial frequency, and total bandwidth to use. Then, the number of frequency plan combinations is in the order of (NFRNPN2BW ) NB . While this number is still tractable for low dimensional scenarios, optimizing for a large number of beams is infeasible from a time perspective. A way to reduce the dimensionality of the problem is to tune only certain beams at a time, while keeping the rest fixed, and iterate over the optimization procedure while selecting different sets of beams so that all beams are optimized. The number of beams that are allowed to change at every iteration will be denoted by Nch."
        },
        {
            "heading": "B. Reducing the search space by ranking",
            "text": "Next, we note that, although we can decide from NFRNPN2BW possibilities for each beam, only a small subset of those options is interesting from an optimization point of view; we explain this below. Specifically, considering the activation variables introduced in Appendix A, each beam i contributes to the objective function in the form of:\n\u03b21,ibi \u2212 |\u03b22,i|gi \u2212 |\u03b23,i|fi \u2212 |\u03b24,i|Pi(fi, bi) + |\u03b25,i|ai (27)\nThis allows us to rank the different options based on their contribution to the total objective value. The most interesting options will be the ones with the highests ranks. Let us denote xf,g,b,i as a binary decision variable that represents choosing the option for beam i which has initial\n26\nfrequency f , frequency reuse g, and bandwidth b. We can rewrite the contribution of each beam as: \u2211 f,g,b (\u03b21,ib\u2212 |\u03b22,i|g \u2212 |\u03b23,i|f \u2212 |\u03b24,i|Pi(f, b) + |\u03b25,i|)xf,g,b,i = \u2211 f,g,b lf,g,b,ixf,g,b,i (31) Where lf,g,b,i is the contribution of the option denoted by xf,g,b,i. Note that now the last factor |\u03b25,i| does not include the activation variable ai. This is addressed in the following section. Now, instead of considering all the feasible options, we will consider only a subset of alternatives for each beam, denoted by the symbol Vi. By considering a strict subset, we are limiting the options of the algorithm and reducing the search space of solutions, with the expectation that the optimal or close to optimal solution lies within the selected subset. By including a ranking system, we can define this subset as the X most interesting options. It is important to highlight that, while solutions with higher bandwidth will tend to be preferred, those are also the most difficult to allocate in the frequency plan. Therefore, instead of a single ranking system for all options, we pre-compute a ranking for each possible bandwidth, and include the options in the top of each ranking in the set. In our experiments we select the top 10 candidates per bandwidth assignment. Also, note that the interference constraints (inter-group restrictions) with beams that are not being changed can be computed a priori, and options that are not feasible (i.e., solutions that have interference constraints with beams that are not being changed), do not need to be included in the ranking, thus reducing the number of active constraints in the problem. The new problem formulation can be stated as:\nmax NB\u2211 i=1 \u2211 f,g,b\u2208Vi lf,g,b,ixf,g,b,i (32)\nAdditionally, we need to impose that at most one option can be active at a time:\u2211 f,g,b\u2208Vi xf,g,b,i = 1 \u2200i (33)"
        },
        {
            "heading": "C. Dealing with activation variables",
            "text": "Now we explain how the activation variables can come into play in this new formulation. As we use a warm-start in our iteration-based experiments, we first need to distinguish between cases where the beam in the warm-start plan is active or not:\n1) According to the warm-start, the original beam i is active, and it has initial frequency\nforig, frequency reuse gorig, and bandwidth borig. Then, we include an additional option\n27\nxorig,i that corresponds to the equivalent option in the original plan. Then, the previous constraint can be expressed as: \u2211 f,g,b\u2208Vi xf,g,b,i + xorig,i = 1 (33) 2) According to the warm-start, the original beam i is not active. Then, we include the\nadditional variable ai that indicates if the beam is active (ai = 1) or not (ai = 0). The previous constraint can be expressed as:\u2211 f,g,b\u2208Vi xf,g,b,i \u2212 ai = 0 (33)\nWith this formulation, a feasible option is guaranteed to exist, although not all beams might be active in the final solution. If a feasible solution with all beams active does exist, this formulation will provide it.\nD. Including intra- and inter-group restrictions\nThe final aspect to address in this new approach is how to include intra- and inter-group constraints. As mentioned, interference with fixed beams is passively included by disregarding the infeasible options. The only restrictions to be included are the ones between beams that are allowed to change in the same iteration. Since the decision variables are now just binary activation variables with implicit frequency reuse, initial frequency, and bandwidth, we can easily precompute if two options from two different beams collide or not. If they do, we only need to add a restriction of the type:\nxfi,gi,bi,i + xfj ,gj ,bj ,j \u2264 1 (34)\nWhich ensures that at most one of the two options will be active, guaranteeing constraint satisfaction in the final solution. Note that, since we need to add a constraint for each pair of colliding options, the number of constraints may increase quadratically with the number of options, which imposes computational constraints in the number of options that can be considered.\nNow, the complexity of the problem is solely determined by the number of beams that are allowed to change at each point, and the number of options considered for each beam, which are engineering decisions that can be assessed independently of the problem characteristics. As a final remark, note that if we set Nch = NB and consider all valid options, the formulation is equivalent to the original formulation presented in this work.\n28"
        },
        {
            "heading": "APPENDIX C",
            "text": "BEAM PLACEMENT DISTRIBUTION\nFigure 8 shows the beam placement distribution that results after using the beam placement algorithm from [18] on a set of approximately 18,000 users. 5,000 beams are used to serve these users."
        },
        {
            "heading": "APPENDIX D",
            "text": "POWER COMPUTING ALGORITHM\nOne of the elements in the objective function equation (27) corresponds to a metric for power consumption. As power equations are not linear [19], we can not directly use them in our framework. As a solution, we precompute, for each of the NB beams, the consumed power for each possible frequency assignment.\nTo that end, we use the satellite communications models described in [13]. For simplicity, we describe the procedure to compute the necessary power Pb for one beam b given its data rate demand Db and a certain allocated bandwidth BWb. We assume the satellites use the MODCOD\n29\nschemes defined in the standards DVB-S2 and DVB-S2X [23]. Given a certain roll-off factor \u03b1b, we can compute the lower bound of the required spectral efficiency as\n\u0393req = Db(1 + \u03b1b)\nBWb (35)\nWe select the MODCOD whose spectral efficiency is the lowest such that \u0393 \u2265 \u0393req. If no such MODCOD exists, we set a power value of Pb = M , where M is a sufficiently large number.\nOtherwise, we can get the appropriate value for Eb/N from the MODCOD scheme. Since in our work we have considered interference mitigation mechanisms by means of the inter-group constraints, we assume interference is negligible. We then compute the necessary C/N0 as\nC\nN0 \u2223\u2223\u2223\u2223 b = Eb N \u2223\u2223\u2223\u2223 b \u00b7 Db BWb\n(36)\nWith C/N0 in dB, we can then compute the power as:\nPb = C\nN0 \u2223\u2223\u2223\u2223 b +OBO \u2212GTx \u2212GRx\n+ FSPL + 10 log10(kTsys) (37)\nwhere OBO is the power-amplifier output back-off, GTx and GRx are the transmitting and receiving antenna gains, respectively, k. is the Boltzmann constant, and Tsys is the system temperature (assumed to be 290K). FSPL and Latm account for the free-space path losses, respectively. We assume FSPL are significantly larger than atmospheric losses, and losses at the transmitting and receiving antennas, so we neglect all the latter.\nWe compute a power value Pb for each possible assignment of BWb, and repeat the process\nfor all beams in the constellation."
        },
        {
            "heading": "ACKNOWLEDGMENT",
            "text": "This work was supported by SES S.A.. The authors would like to thank SES S.A. for their input to this paper and their financial support. The project that produced these results also received the support of a fellowship from \u201cla Caixa\u201d Foundation (ID 100010434). The fellowship code is LCF/BQ/AA19/11720036."
        }
    ],
    "title": "Frequency Plan Design for Multibeam Satellite Constellations Using Linear Programming",
    "year": 2022
}