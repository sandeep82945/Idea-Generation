{
    "abstractText": "9 Gene trees often differ from the species trees that contain them due to vari10 ous factors, including incomplete lineage sorting (ILS), gene duplication and loss 11 (GDL), and horizontal gene transfer (HGT). Several highly accurate species tree 12 estimation methods have been introduced to explicitly address ILS, including AS13 TRAL, a widely used statistically consistent method, and wQFM, a quartet amalga14 mation approach that is experimentally shown to be more accurate than ASTRAL. 15 Two recent advancements, ASTRAL-Pro and DISCO, have emerged in the field of 16 phylogenomics to consider gene duplication and loss (GDL) events. ASTRAL-Pro 17 introduces a refined measure of quartet similarity, accounting for both orthology 18 and paralogy. DISCO, on the other hand, offers a general strategy to decompose 19 multicopy gene family trees into a collection of single-copy trees, allowing the uti20 lization of methods previously designed for species tree inference in the context of 21 single-copy gene trees. In this study, we first introduce some variants of DISCO to 22 examine its underlying hypotheses and present analytical results on the statistical 23 guarantees of DISCO. In particular, we introduce DISCO-R, a variant of DISCO 24 with a refined and improved pruning strategy that provides more accurate and ro25 bust results. We then propose wQFM-DISCO (wQFM paired with DISCO) as an 26 adaptation of wQFM to handle multicopy gene trees resulting from GDL events. 27 Extensive evaluation studies on a collection of simulated and real data sets demon28 strate that wQFM-DISCO is significantly more accurate than ASTRAL-Pro and 29 other competing methods. 30",
    "authors": [
        {
            "affiliations": [],
            "name": "Sheikh Azizul Hakim"
        },
        {
            "affiliations": [],
            "name": "MD Rownok"
        },
        {
            "affiliations": [],
            "name": "Zahan Ratul"
        },
        {
            "affiliations": [],
            "name": "Shamsuzzoha Bayzid"
        }
    ],
    "id": "SP:6249b2880963ec3ffabefa42689bbe2e8876ac60",
    "references": [],
    "sections": [
        {
            "text": "Gene trees often differ from the species trees that contain them due to vari-10 ous factors, including incomplete lineage sorting (ILS), gene duplication and loss11 (GDL), and horizontal gene transfer (HGT). Several highly accurate species tree12 estimation methods have been introduced to explicitly address ILS, including AS-13 TRAL, a widely used statistically consistent method, and wQFM, a quartet amalga-14 mation approach that is experimentally shown to be more accurate than ASTRAL.15 Two recent advancements, ASTRAL-Pro and DISCO, have emerged in the field of16 phylogenomics to consider gene duplication and loss (GDL) events. ASTRAL-Pro17 introduces a refined measure of quartet similarity, accounting for both orthology18 and paralogy. DISCO, on the other hand, offers a general strategy to decompose19 multicopy gene family trees into a collection of single-copy trees, allowing the uti-20 lization of methods previously designed for species tree inference in the context of21 single-copy gene trees. In this study, we first introduce some variants of DISCO to22 examine its underlying hypotheses and present analytical results on the statistical23 guarantees of DISCO. In particular, we introduce DISCO-R, a variant of DISCO24 with a refined and improved pruning strategy that provides more accurate and ro-25 bust results. We then propose wQFM-DISCO (wQFM paired with DISCO) as an26 adaptation of wQFM to handle multicopy gene trees resulting from GDL events.27 Extensive evaluation studies on a collection of simulated and real data sets demon-28 strate that wQFM-DISCO is significantly more accurate than ASTRAL-Pro and29 other competing methods.30 Keywords: Species tree, gene tree, gene tree heterogeneity, incomplete lineage31 sorting (ILS), Gene duplication and loss (GDL), multicopy gene trees, Paralogy.32\n1\nDISCO-enabled wQFM\n1 Introduction33\nInferring species trees from gene trees sampled throughout the whole genome is a funda-34 mental problem in molecular evolutionary biology. However, this task is complicated by35 the phenomenon of gene tree heterogeneity (or discordance), where different genes may36 have different evolutionary histories. Gene tree heterogeneity can arise due to various37 biological processes, including incomplete lineage sorting (ILS), gene duplication and loss38 (GDL), and horizontal gene transfer (HGT) (Warnow, 2017). Numerous methods have39 been proposed for species tree inference, including co-estimation of gene trees and the40 species tree (Boussau et al., 2013a; Heled and Drummond, 2010; Liu, 2008; Szo\u0308llo\u030bsi et al.,41 2015), and species tree inference from sequence data (Bryant et al., 2012; Chifman and42 Kubatko, 2014). However, the most scalable and popular approach to date remains a43 two-step process, where gene trees are first inferred independently from sequence data,44 and then combined using summary methods that attempt to estimate species trees by45 summarizing the input gene trees under a model of gene tree discordance.46 Many summary methods have been proposed to target ILS and some of them have47 been shown to be statistically consistent under the multi-species coalescent (MSC) model48 (Avni et al., 2015; Bayzid and Warnow, 2012; Chifman and Kubatko, 2014; Islam et al.,49 2020; Mahbub et al., 2021; Mim et al., 2023; Mirarab et al., 2014; Reaz et al., 2014;50 Snir and Rao, 2010; Zhang, 2011). Other statistically consistent species-tree estimation51 methods include BEST (Liu, 2008) and *BEAST (Heled and Drummond, 2010), which52 co-estimate gene trees and species trees from input sequence alignments. While these53 methods can produce substantially more accurate trees than other methods, they are54 extremely computationally intensive and do not scale to large numbers of genes (Bayzid55 and Warnow, 2012, 2013; Smith et al., 2013).56 Maximizing quartet consistency (MQC) is one of the leading optimization criteria57 for estimating statistically consistent species trees from gene trees in the presence of58 ILS (Avni et al., 2015; Mahbub et al., 2021; Mirarab et al., 2014; Reaz et al., 2014; Snir59\n2"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "and Rao, 2010). MQC seeks a species tree that is consistent with the largest number of60 quartets induced by the set of gene trees. ASTRAL is arguably the most commonly used61 quartet-based summary method (Mirarab et al., 2014). Given a set of unrooted gene trees,62 ASTRAL uses a dynamic programming approach to solve the NP -hard optimization63 problem of finding the species tree that agrees with the largest number of quartet trees64 induced by the set of gene trees. A different method involves deducing individual quartets65 and then combining them into a cohesive species tree in a divide-and-conquer fashion,66 either with or without weights, e.g., Quartets Max-Cut (QMC) (Snir and Rao, 2010),67 Quartets Fiduccia\u2013Mattheyses (QFM) (Reaz et al., 2014), Weighted Quartets Max-Cut68 (wQMC) (Avni et al., 2015), Weighted Quartets Fiduccia\u2013Mattheyses (wQFM) (Mahbub69 et al., 2021) etc. While ASTRAL is an exact dynamic programming algorithm statistically70 consistent under the MSC model, wQMC and wQFM are heuristic-based methods and71 no result on statistical consistency exists in the literature. However, through extensive72 simulation studies, wQFM has been shown to have consistently outperformed wQMC and73 ASTRAL (Mahbub et al., 2021, 2022), even when gene trees are incomplete (Mahbub74 et al., 2022). These methods were originally proposed to address gene tree heterogeneity75 due to ILS and are thus applicable to single-copy gene trees.76 GDL events introduce paralogs, which are genes originating from a common ances-77 tor through duplication events, in addition to orthologs, which arise from speciation78 events (Fitch, 2000; Yang and Smith, 2014). Consequently, gene families may consist of79 multiple genes with the same species labels, resulting in multicopy gene trees. However,80 most of the summary methods require genes with at most one copy in each species, and81 so cannot be used directly in the presence of GDL. One way to address this is to iden-82 tify the orthologous genes so that the existing summary methods that were designed to83 handle single-copy gene trees can be applied to estimate species trees from sets of ortholo-84 gous genes. However, reliable identification of orthologous genes is challenging (Altenhoff85 et al., 2019). Furthermore, relying solely on orthologous genes leads to the exclusion86 of numerous multicopy gene trees, thereby discarding valuable information (1kp, 2019;87\n3"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "Wickett et al., 2014).88 There have been a few summary methods developed to estimate species trees from89 multicopy gene family trees by addressing gene duplications and losses and without requir-90 ing orthology determination, namely PHYLDOG (Boussau et al., 2013a), iGTP (Chaud-91 hary et al., 2010), DupTree (Wehe et al., 2008), DynaDup (Bayzid, 2023; Bayzid and92 Warnow, 2018; Bayzid et al., 2013), MulRF (Chaudhary et al., 2013), FastMulRFS (Mol-93 loy and Warnow, 2020), Guenomu, ASTRAL-Pro (Zhang et al., 2020), and Species-94 Rax (Morel et al., 2022). Most of these methods (Bayzid and Warnow, 2018; Bayzid95 et al., 2013; Chaudhary et al., 2010, 2013; Wehe et al., 2008) are parsimony-based ap-96 proaches where a species tree is estimated by minimizing a particular distance between97 the species tree and given set of gene trees (e.g., the total number of duplication and98 loss events). However, there are other methods that are more agnostic about the reasons99 for gene tree discordance and do not necessarily rely on maximum parsimony reconcil-100 iation. Example methods of this type include PHYLDOG (Boussau et al., 2013a) and101 Guenomu (De Oliveira Martins et al., 2016) that represent a powerful approach, lever-102 aging probabilistic models and Bayesian techniques, which co-estimates gene trees and103 species trees. These methods are computationally very demanding, so they are limited104 to small datasets. ASTRAL-Pro is a quartet-based species-tree inference method that105 aims to compute a species tree that maximizes the total similarity to the input gene106 trees, using a new measure of quartet similarity that accounts for orthology and paralogy107 (Zhang et al., 2020).108 Another approach to tackle multicopy gene family trees resulting from GDL events is109 to decompose multicopy gene trees into single-copy gene trees (Dunn et al., 2013; Hejnol110 et al., 2009; Kocot et al., 2013). Willson et al. (2021) introduced the DISCO algorithm111 to decompose multicopy gene trees into single-copy gene trees, allowing the utilization112 of methods designed for single-copy gene trees in handling multicopy gene trees. To113 obtain a rooted tagged (duplication/speciation) multi-labeled tree, DISCO utilizes the114 tagging and rooting heuristics of ASTRAL-Pro and uses a pruning strategy to produce115\n4"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "single-copy gene tress from multicopy gene family trees. ASTRAL-Pro and ASTRAL-116 DISCO (ASTRAL on the output set of DISCO) have been shown to be statistically117 consistent when either ILS or GDL is active (Willson et al., 2021; Zhang et al., 2020).118 Many successful summary methods (ASTRAL, wQFM, MP-EST, etc.) were designed to119 model ILS and therefore, suitable for only single-copy gene trees. Thus, any fundamental120 improvements of DISCO and its applications to enhance the capabilities of highly accurate121 methods such as wQFM in modeling both orthology and paralogy, thereby making them122 suitable for multicopy gene trees will be of great interest for estimating species trees from123 multi-locus data in the presence of GDL.124 This study entails the following key contributions. We first examine some underlying125 hypotheses regarding the pruning and tagging strategies of DISCO combined with both126 ASTRAL and wQFM and proposed DISCO-R (DISCO with a Refined pruning strategy127 that Regrafts clades that original DISCO may have missed), which resulted in more128 accurate and robust results. We for the first time apply wQFM in the multicopy gene129 tree setting and establish its experimental superiority over other competing methods130 including ASTRAL-Pro. Our findings from an extensive evaluation study highlight the131 effectiveness of the combined wQFM-DISCO approach and emphasize its superiority in132 species tree estimation from multicopy gene trees. We also extend theoretical guarantees133 of statistical consistency of ASTRAL combined with DISCO by showing that ASTRAL-134 DISCO is statistically consistent under DLCoal (Duplication, Loss, and Coalescence)135 model \u2013 a model to incorporate both ILS and GDL (Rasmussen and Kellis, 2012).136\n2 Background and preliminaries137\nWe now give a brief overview of the DLCoal model, ASTRAL-Pro, DISCO, and wQFM138 to make this paper self-contained.139\n5\nDISCO-enabled wQFM\n2.1 DLCoal model140\nThe following brief overview of the unified duplication-loss-coalescence (DLCoal) model141 has been adapted from (Markin and Eulenstein, 2021; Rasmussen and Kellis, 2012).142 A species tree represents an evolutionary history of a group of species. A locus tree143 represents a duplication-loss history of a particular gene. A locus tree is obtained from144 a species tree by running the duplication/loss process top-down along the edges of the145 species tree. In other words, the duplication/loss process is a birth-death process with146 a fixed birth (duplication) rate and death (loss) rate (Arvestad et al., 2004). The birth-147 death process starts in the root edge of the species tree; whenever it reaches a speciation148 point, the process splits into two copies and continues independently in the children149 edges. A locus tree node can be termed as speciation if such a node corresponds to a150 speciation event/node in the species tree or as duplication if such a node corresponds to151 the creation of a new locus. Note that locus tree leaves are labeled by gene names. The152 gene tree is obtained from a locus tree by running the bounded multispecies coalescent153 (b-MSC) process bottom-up along the edges of the locus tree. The duplication/loss154 process and the b-MSC process are jointly referred as the DLCoal model. In the standard155 multispecies coalescent (MSC) model, there is exactly one gene lineage starting in every156 extant locus tree leaf, and if two or more lineages enter the same locus tree edge, then the157 coalescence history of these lineages is determined by an exponential distribution. The158 b-MSC process in the unified DLCoal model is defined by imposing constraints on MSC159 due to the duplication points. In particular, all lineages originating below a daughter160 duplicate must coalesce below the respective duplication node.161\n2.2 ASTRAL-Pro162\nWe begin this section by reviewing the terminology introduced in (Zhang et al., 2020). Let163 S be a set of n species. The input to our problem is a collection of multicopy gene trees.164 Given a rooted multicopy gene tree G, we define a many-to-one mapping \u03b1G between its165\n6"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "leaf-set LG and S. For a leaf l \u2208 LG, \u03b1G(l) denotes the species the gene l was taken from.166 For a node u, we define LG(u) to be the set of leaves under u. We extend definitions such167 that \u03b1G(A) = {\u03b1G(a)|a \u2208 A} for A \u2282 LG and \u03b1G(u) = \u03b1G(LG(u)) for a node u in G. In168 other words, \u03b1G(u) denotes the set of species whose genes are present under a node u in169 G.170 A quartet Q is a four-membered subset LG. If we recursively delete leaves from G171 such that only four leaves in Q are left, we are left with a tree with two degree-3 nodes.172 These two nodes are called the anchors of Q. Since G is rooted, we can find the LCA of173 these two nodes which is referred to as the anchor LCA of Q in G.174 We tag every non-leaf node as speciation or duplication. Given a non-leaf node u175 with two children u1 and u2, we tag u as a speciation node if \u03b1G(u1) \u2229 \u03b1G(u2) = {}.176 Otherwise, we tag u as a duplication node. A quartet with a topology ab|cd in a gene177 tree is defined as a speciation-driven quartet (SQ) if all the four genes are contained in178 different species and the LCA of either a or b with either c or d is tagged as speciation.179 Two SQs on the same four species are equivalent if they have the same anchor LCA. The180 per-locus quartet score of a species tree S with respect to a rooted tagged gene tree G181 is the number of equivalent quartet classes that match the S topology. The Maximum182 per-Locus Quartet score Species Tree (MLQST) problem is to find the species tree that183 maximizes the PL quartet score with respect to input gene trees, given a set of rooted184 tagged gene trees. ASTRAL-Pro, in its exact version, solves the MLQST problem.185 ASTRAL, on the other hand, was designed to solve the Maximum Quartet Support186 Species Tree (MQSST) problem, which aims to find the species tree that agrees with the187 largest number of quartet trees induced by the set of gene trees. ASTRAL, or in general,188 the solution to the MQSST problem, is statistically consistent under MSC (Mirarab et al.,189 2014).190\n7\nDISCO-enabled wQFM\n2.3 DISCO191\nASTRAL-Pro roots and tags using the maximum parsimony principle with equal penalties192 for duplication and loss, and no penalty for ILS. DISCO performs a post-order traversal193 of the multicopy gene tree and prunes the smaller subtree at each duplication node.194 The central idea of DISCO is to decompose each multicopy gene tree into a set of195 single-copy gene trees (Willson et al., 2021). To accomplish so, DISCO uses the rooting196 and tagging algorithm of ASTRAL-Pro. ASTRAL-Pro roots and tags using the maximum197 parsimony principle with equal penalties for duplication and loss, and no penalty for ILS.198 Given a fully resolved unrooted binary tree, the ASTRAL-Pro algorithm places the root199 along an edge such that the total number of duplications and losses is minimized. After200 rooting the tree, each internal node is tagged either as a duplication or a speciation node.201 Given a rooted tagged gene tree G, the set of output trees SG is initially empty. The202 decomposition algorithm performs a postorder traversal. When it reaches a duplication203 node, the smaller subtree rooted at that node is pruned and added to SG. When the204 entire traversal is complete, the resultant tree is also added to SG. It can be ensured that205 every tree in SG is a single-copy tree. Summary methods take a collection of gene trees206\nC = {Gi} as input. The output of DISCO when fed with C as input is C \u2032 = \u22c3 i SGi . An207 illustrative example is presented in Section 4.208\n2.4 wQFM209\nwQFM considers the weighted version of the Maximum Quartet Consistency (MQC)210 problem (Reaz et al., 2014; Snir and Rao, 2010), which we call WMQC, and define as211 follows.212\nProblem Weighted Maximum Quartet Consistency (WMQC) Input A set Q of weighted quartets on a set S of taxa. Output A tree T on S such that the total weight of the quartets in Q\nthat are consistent with T is maximized.\n213\n214\n8"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "wQFM, in general, can be used to amalgamate any set of given weighted quartets215 (e.g., quartets induced by a the gene trees or the quartets produced by SVDquartets).216 In this study, we consider wQFM-GTF which estimates species trees by combining the217 quartets induced by the gene trees, and the weights of the quartets are computed based218 on the gene tree frequency (GTF), i.e., we use the frequency of the quartets in input gene219 trees as weights.220\n3 Statistical consistency of ASTRAL-DISCO under221\nthe unified DLCoal model222\nWillson et al. (2021) showed that ASTRAL-DISCO is statistically consistent when the223 cause of discordance is only GDL, provided that the rooting and tagging algorithm224 of ASTRAL-Pro is correct. Legried et al. (2020) proved the statistical consistency of225 ASTRAL-ONE under GDL. The ASTRAL-ONE pipeline consists of two stages. First,226 given a collection of multicopy gene trees, from each multicopy tree, a single-copy gene227 tree is obtained by randomly sampling one gene from each species. Then ASTRAL is228 run on the single-copy gene trees. Markin and Eulenstein (2021) extended the results of229 Legried et al. (2020) when ILS is also involved besides GDL. Under the unified (DLCoal)230 process (Rasmussen and Kellis, 2012), Markin and Eulenstein (2021) proved the following231 theorem.232\nTheorem 1 (Markin et al., 2021). Let S be a species tree with four leaves that displays233 quartet AB|CD, and let G be a gene tree that evolved in S according to the DLCoal234 process. If one picks genes a, b, c, d (that correspond to species A,B,C,D respectively)235 uniformly at random (assuming they exist) from G, then P (ab|cd \u2208 G) > P (ac|bd \u2208 G) =236 P (ad|bc \u2208 G).237\nWhen the inequality in Theorem 1 is satisfied, Legried et al. (2020) proved that238 ASTRAL-ONE is a statistically consistent estimator as presented in Theorem 2.239\n9"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "Theorem 2 (Legried et al, 2020; rephrased). Let S be a species tree with four leaves240 that displays quartet AB|CD, and let G be an arbitrarily large collection of gene trees241 over the species in S. If one picks genes a, b, c, d (that correspond to species A,B,C,D242 respectively) uniformly at random (assuming they exist) from any G \u2208 G and the resultant243 quartet q in G is more likely to match the species tree configuration than the other two,244 i.e., P (q = ab|cd) > P (q = ac|bd) = P (q = ad|bc), then ASTRAL-ONE almost surely245 returns S when run with G.246\nWe extend the previous results to show the statistical consistency of ASTRAL-DISCO247 under the unified DLCoal model (Theorem 3).248\nTheorem 3. ASTRAL-DISCO is statistically consistent under the DLCoal process, pro-249 vided that the input gene trees are correctly rooted and tagged.250\nProof. By assumption, each gene tree is obtained by running the DLCoal process over the251 true species tree, and the rooting and tagging are correct. Hence each duplication node252 in the gene tree marks the creation of a new locus. We consider that the subtree to be253 kept follows the parent locus (mother duplicate), and the subtree to be pruned follows the254 novel locus (daughter duplicate). Therefore, each resultant DISCO tree represents the255 history of a particular locus, which obeys the bounded-MSC model (a part of the DLCoal256 process). If one picks genes a, b, c, d (that correspond to species A,B,C,D respectively,257 assuming they exist) from any resultant DISCO tree G, then by Theorem 1, P (ab|cd \u2208258 G) > P (ac|bd \u2208 G) = P (ad|bc \u2208 G). Since a resultant DISCO tree is single-copy, there is259 only one quartet q induced by genes a, b, c, d, which can be either ab|cd, ac|bd, or ad|bc.260 So, P (q = ab|cd) > P (q = ac|bd) = P (q = ad|bc). Hence, by Theorem 2, ASTRAL-ONE261 on the resultant DISCO trees is statistically consistent under the DLCoal process. Since262 DISCO trees are single-copy trees, running ASTRAL on DISCO trees and ASTRAL-ONE263 on DISCO trees are equivalent and the theorem follows.264\nSince ASTRAL, both in its exact and heuristic version, exactly solves the MQSST265 problem when there are adequately many error-free gene trees, all the statistical con-266\n10"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "sistency results for ASTRAL will hold for any other algorithm that accurately solves267 MQSST. In particular, if the quartet amalgamation technique is proper and the weights268 of the input quartets are computed based on GTF, then the unique solution to the269 WMQC problem (the problem wQFM tries to heuristically solve) is a statistically con-270 sistent estimator of the true species tree under the MSC model (Mahbub et al., 2021).271 Following the same argument as above, we can conclude the following theorem.272\nTheorem 4. If the quartet amalgamation technique is proper and the weights of the input273 quartets are computed based on GTF of the trees decomposed by DISCO, then the unique274 solution to the WMQC problem is a statistically consistent estimator of the true species275 tree under the DLCoal model.276\n4 DISCO-R: A refined pruning strategy using re-277\ngrafting278\nIn this study, we tried to investigate some variants of DISCO and empirically showed that279 DISCO is quite robust. In particular, we propose an improved pruning strategy and call280 this variant DISCO-R. Zhang et al. introduced the concept of speciation-driven quartets281 (SQ) to formulate the ASTRAL-Pro algorithm (Zhang et al., 2020). They claimed that282 only SQs contain information about speciation. Since DISCO uses the rooting and tagging283 heuristic of ASTRAL-Pro, the quartets in the resultant DISCO trees are all marked as284 SQs and considered by ASTRAL-Pro (Willson et al., 2021). However, DISCO does285 not consider all speciation-driven quartets. Here, we introduce a new pruning heuristic286 DISCO-R, that provably includes more SQs than DISCO. We empirically show that287 DISCO-R performs at least as good as or better than DISCO.288 Let us consider a multicopy gene tree G in Figure 1a. We differentiate the instances289 of the same species by a numerical subscript. There is one duplication node which we290 mark as red. Since both subtrees have the same number of leaves, DISCO could prune291 any of the subtrees. Without loss of generality, let us assume that the larger subtree was292\n11"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "pruned. When fed with G, DISCO produces the two trees in Figure 1b. ASTRAL-Pro293 takes into consideration all SQs of G. All quartets in the output of DISCO trees are294 speciation driven. However, the output misses some SQs such as ac2|d2e, ah|d2e, ab|pe,295 ab|ph etc. We can see two types of SQs here. In case ab|pe and ab|ph, two species were296 from the pruned subtree and the rest two were from the backbone tree.297 We modify DISCO to include (the quartets that DISCO usually misses, ie., in our298 example in Fig. 1, we want to include ab|pe and ab|ph) these two quartets. In our new299 method DISCO-R, at a duplication node, we prune a subtree as usual. However, we take300 the subtree of the pruned subtree, excluding the species present in the backbone tree, and301 reattach it in the place of the duplication node. All degree-2 nodes are contracted. The302 output of DISCO-R when run with G is shown in Figure 1c. This scheme successfully303 incorporates the speciation-driven quartets ab|pe and ab|ph. However, the other SQs304 ac2|d2e and ah|d2e are still missing in DISCO-R. Moreover, DISCO-R introduces ae|c1d1305 and ad1|he. These quartets are present in G, but they are not speciation driven per the306 rooting and tagging scheme of ASTRAL-Pro. In brief, the quartets generated by DISCO307 are SQs, but not all SQs are covered by DISCO output trees. DISCO-R might cover308 more SQs than DISCO, but DISCO-R can introduce some non-SQs too. ASTRAL-Pro309 claims that these non-SQs do not convey any speciation-related information. However,310 our experiments establish the efficacy of DISCO-R. Moreover, it is possible to construct311 a collection of gene trees C = {Gi} such that one species is entirely missing from C \u2032 =312 \u22c3 i SGi . Such events cannot occur in DISCO-R because we do not prune any non-duplicate313 leaf. Such an example, adapted from (Willson et al., 2021), is shown in Figure 2.314\n4.1 Variants of DISCO and DISCO-R315\nDISCO uses the rooting and tagging heuristic of ASTRAL-Pro where they assign equal316 weights to each duplication and loss event. Then, while doing a postorder traversal,317 the smaller subtree is pruned at each duplication node. We wanted to examine the318 effects of various weighting schemes and pruning strategies. We experimented with several319\n12"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "13"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "variants of DISCO (e.g., DISCO-1, DISCO-2, . . . , DISCO-6). First, instead of pruning320 the smaller subtree at a duplication node as was done in the original DISCO algorithm,321 we experimented with pruning the larger subtree (DISCO-2) or randomly pruning one322 of the two subtrees (DISCO-3) at that node. We also experimented with the rooting323 algorithm of ASTRAL-Pro, where we assigned the cost of a duplication event to be twice324 the cost of a loss event (DISCO-5,-6). Such scoring heuristic was previously suggested in325 literature (David and Alm, 2010; Zhang et al., 2020). Zheng el al. also hypothesized that326 ASTRAL-Pro is somewhat robust on the underlying rooting and tagging heuristic. . We327 examined both DISCO and DISCO-R with different scoring heuristics. Table 1 shows six328 different variants that we have explored in this study.329\n14"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "5.1 Datasets331\nSimulated dataset. We analyzed a 25-taxa dataset simulated and analyzed by Zhang332 et al. (2020) in the ASTRAL-Pro study. For the default model, the number of species is333 25, and the number of gene trees is 1,000. The duplication rate (\u03bb+), which is also equal334 to the loss rate (\u03bb\u2212), is 4.9\u00d710\u221210. For the default model, gene trees have an ILS level of335 [60%, 80%]. We performed most of our experiments with varying duplication rates from336 0\u223c5\u03bb+ and loss/duplication ratios from 0 \u223c 1 with all other parameters kept the same337 as the default. We also performed some experiments with varying duplication rates and338 ILS levels while keeping the loss rate equal to the duplication rate .339 We also performed an experiment on a dataset of 100 taxa simulated by (Molloy and340 Warnow, 2020) and also used by (Zhang et al., 2020). The duplication rate was varied341 as {0, 1, 2, 5} \u00d7 10\u221210, and the loss rate was kept the same as the duplication rate. The342 ILS was controlled by varying the haploid population size as {1, 5} \u00d7 107, resulting in a343 much lower ILS level, 2% and 12%, respectively. Gene trees were estimated considering344 sequence lengths of 25, 50, 100, and 250 base pairs. and We only considered the model345 conditions with 500 genes.346\nEmpirical dataset. We also tested our methods on two popular biological datasets.347 First, we use the transcriptome dataset of land plant species (Plants83), which was first348\n15"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "analyzed by Wickett et al. (2014). We also reanalyze a dataset of 16 yeast species349 (Fungi16) with 7,280 multicopy gene trees from Butler et al. (2009) and a dataset of350 60 fungal species (Fungi60) with 5659 multicopy gene trees from Morel et al. (2022).351\n5.2 Methods compared352\nWe evaluated different variants of DISCO paired with ASTRAL and wQFM, two leading353 species tree estimation methods. We also compared wQFM-DISCO (wQFM paired with354 DISCO) with ASTRAL-Pro, ASTRAL-DISCO, DupTree, and MulRF.355\n5.3 Measurements356\nWe compared the estimated trees (on simulated datasets) with the model species tree us-357 ing normalized Robinson-Foulds (RF) distance (Robinson and Foulds, 1981) to measure358 the tree error. The RF distance between two trees is the sum of the bipartitions (splits)359 induced by one tree but not by the other, and vice versa. All the trees estimated in this360 study are binary and so False Positive (FP), and False Negative (FN) and RF rates are361 identical. For the biological dataset, we compared the estimated species trees to the sci-362 entific literature. We assessed support values in the estimated trees using local posterior363 probabilities (Sayyari and Mirarab, 2016) computed by ASTRAL. The local posterior364 probabilities are computed based on a transformation of normalized quartet scores (the365 percentage of quartets in the gene trees that agree with a branch in the estimated species366 tree). We analyzed multiple replicates of data for various model conditions and performed367 two-sided Wilcoxon signed-rank test (Wilcoxon, 1945). We set the threshold \u03b1 = 0.05 to368 measure the statistical significance of the differences between two methods.369\n16"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "6 Results and discussion370\n6.1 Experiment 1: evaluation of DISCO variants371\nIn Experiment 1, we have two separate experiments to assess: 1(a) the impact of different372 pruning strategies, and 1(b) the impact of different rooting and tagging strategies.373\n6.1.1 Experiment 1(a): Effects of choosing the subtree to be pruned374\nWe examined how the performance varies by pruning the smaller (DISCO-1), larger375 (DISCO-2), or one of them at random (DISCO-3). Originally, DISCO prunes the smaller376 subtree at a duplication node, but no justification was provided for their choice (Willson377 et al., 2021). We compared these three methods both with ASTRAL and wQFM with378 varying duplication rates and loss/duplication ratios (see Figure 3). When the duplica-379 tion rate is 0, the methods do not differ since the gene trees are single-copy and hence380 there is no pruning involved. Otherwise, among the 15 other model conditions, we see381 that ASTRAL-DISCO-1 performs better than both ASTRAL-DISCO-2 and ASTRAL-382 DISCO-3 on 12 model conditions with estimated gene trees with gene length of 100 bp,383 on 12 model conditions with estimated gene trees with gene length of 500 bp, and on 11384 model conditions with true gene trees. Similarly, wQFM-DISCO-1 showed superior per-385 formance compared to wQFM-DISCO-2 and wQFM-DISCO-3 on 11, 11, and 12 model386 conditions, respectively, across these three types of gene trees. In each case, the differ-387 ence is statistically significant (p << 0.01). ASTRAL and wQFM paired with DISCO-2388 (i.e., pruning the larger trees) produced the worst results in most of the cases. Relative389 performances of different variants of DISCO paired with either ASTRAL or wQFM are390 similar. Thus, we experimentally conclude that pruning the smaller subtree is the bet-391 ter strategy. Pruning the smaller subtree retains more speciation-driven quartets, which392 could be a plausible explanation for our findings. Therefore, in subsequent experiments,393 we only prune the smaller subtrees as in the original DISCO algorithm.394\n17"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "18"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "6.1.2 Experiment 1(b): Effects of different weighting schemes in the tagging395 technique of ASTRAL-Pro and DISCO396\nThe tagging heuristic used by ASTRAL-Pro (and also by DISCO) equally weights each397 duplication and loss event. We examined the effects of assigning the weight of a dupli-398 cation event two times that of a loss event. We also experimented with DISCO-R, the399 pruning technique we introduced in Section 4. We compared these methods (DISCO-400 1,4,5,6) paired with both ASTRAL and wQFM under various model conditions (see401 Figure 4). The relative ranks of the methods are shown in Table 2. Figure 4 and402 Table 2 suggest that regardless of the choice of species tree estimation methods (i.e.,403 ASTRAL or wQFM), DISCO-R with two different weighting schemes (i.e., DISCO-4 and404 DISCO-6) are frequently better than original DISCO variants (DISCO-1 and DISCO-5)405 and the improvements of DISCO-R variants over the original DISCO variants are some-406 times statistically significant (p < 0.05). However, on true gene trees, all DISCO and407 DISCO-R variants achieved comparable accuracy, with DISCO variants having a slight408 advantage over DISCO-R variants on some of the model conditions. In nearly every409 model condition, DISCO-4 and DISCO-6 methods (paired with ASTRAL or wQFM) had410 very similar accuracy, with neither reliably having an advantage over the other. Similar411 observations hold for DISCO-1 and DISCO-5 (i.e,. original DISCO variants with different412 weighting schemes). This indicates that the rooting and tagging heuristic incorporated413 by ASTRAL-Pro and also by DISCO is considerably robust to the assignments of weights414 to duplication and speciation events. These results indicate that our proposed DISCO-R415 provides more accurate and robust results than the original DISCO algorithm and sup-416 ports our findings that DISCO-R retains more species-driven quartets than DISCO (as417 discussed in Sec 4. Therefore, in subsequent experiments, we consider only DISCO-4418 (DISCO-R with an equal weighting scheme).419 We also observe that in each of the 48 model conditions and 6 variants of DISCO420 discussed, wQFM paired with any certain variant performed better than ASTRAL paired421 with that variant in 243 out of 288 times and this improvement is highly statistically422\n19"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "significant (p << 0.01). This finding supports the previously obtained result that wQFM423 is experimentally superior to ASTRAL (Mahbub et al., 2021, 2022).424\n6.1.3 Experiment 2: Comparisons of best existing summary methods425\nIn this experiment, we compared the best existing method ASTRAL-Pro with wQFM426 and ASTRAL paired with the best DISCO variant (DISCO-4) identified in our previous427 experiments. We also included DupTree and MulRF in our comparisons.428\n20"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "21"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "Varying duplication and loss ratios. First, we do the experiments on the same429 dataset as analyzed in Experiment 1, where duplication rate and loss/duplication ratio430 were varied with ILS level fixed at 70%. On true gene trees, in 7 of the 16 model431 conditions of varying duplication and loss rates, DupTree turns out to be the best method.432 However, in 7 other conditions, DupTree performed worse than all other methods, except433 MulRF. However, wQFM-DISCO-4 performed consistently well and it was better than434 other methods on average. The difference is statistically significant for all methods (p <435 0.05), except ASTRAL-Pro. MulRF has notably higher errors (p << 0.01) than the other436 methods across all model conditions.437 On the estimated gene trees, the accuracy of DupTree dramatically decreased com-438 pared to its performance on the true gene trees. MulRF remained the worst method.439 wQFM-DISCO-4, ASTRAL-Pro, and ASTRAL-DISCO-4 remained much more accu-440 rate than DupTree and MulRF. Remarkably, wQFM-DISCO-4 performs better than441 ASTRAL-Pro and ASTRAL-DISCO-4 across most of the test conditions. The supe-442 rior performance of wQFM-DISCO-4 is statistically significant (p < 0.05) for estimated443 gene trees with both 100bp and 500bp genes.444 Of the 16 different combinations of duplication and loss rates under consideration,445 wQFM-DISCO-4 turned out to be the best method 10, 10, 5 times and the second best446 method 4, 5, 8 times for estimated trees with 100bp genes, estimated trees with 500bp447 genes, and true gene trees respectively. On the other hand, ASTRAL-Pro only came448 out to be the best method 4, 4, 4 times and the second best method 4, 5, 7 times for449 estimated trees with 100bp genes, estimated trees with 500bp genes, and true gene trees,450 respectively. In all three types of input, wQFM-DISCO-4 is better on average than the451 other four methods in consideration.452\nVarying ILS levels. We then repeat this experiment in the case where ILS level also453 varies with the duplication rate, where loss/duplication rate is kept as 1. MulRF performs454 very well in conditions with no ILS, but as we increase the level of ILS, the performance455\n22"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "of MulRF degrades drastically. wQFM-DISCO-4, ASTRAL-Pro, and ASTRAL-DISCO-4456 are relatively robust and much more tolerant of the level of ILS. Remarkably, similar to457 previous experiments, wQFM-DISCO-4 was the best method. Of the 11 model conditions458 under consideration, wQFM-DISCO-4 turned out to be the best method 9, 6, 6 times459 and the second best method 2, 2, 2 times for estimated trees with 100bp genes, estimated460 trees with 500bp genes, and true gene trees. wQFM-DISCO-4 is either significantly better461 (p < 0.05) than the other four methods, or there is no statistically significant difference462 between them.463 Overall, under a wide range of model conditions with varying duplication/loss and464 ILS levels as well as varying gene tree estimation errors, wQFM paired with DISCO-4465 obtained the best performance. Out of a total 1650 test cases, it performed as good466 as or better than ASTRAL-Pro in 1503 and the improvement is statistically significant467 (p < 0.05).468\nVarying parameters on the 100 taxa dataset. We then examined the effect of469 varying gene tree estimation error (controlled by the sequence length), ILS level (con-470 trolled by haploid population size), and duplication rate (with duplication/loss ratio kept471 to 1) in the 100 taxa dataset described in Subsection 5.1. ASTRAL-Pro was reported to472 be the superior method on this dataset (Zhang et al., 2020), especially when compared473 to DupTree and MulRF. Consequentially, we report DupTree and MulRF performance474 in our analysis. As we observe from Fig. 6, wQFM-DISCO-4 turned out to be the best475 method in 25 out of the 40 model conditions and the second-best method in 8 out of the476 15 remaining conditions.477 Overall, in 29 model conditions, wQFM-DISCO-4 performs as good as ASTRAL-478 Pro or better, and the improvement of wQFM-DISCO-4 over ASTRAL is statistically479 significant (p << 0.01).480 Thus, wQFM is not only superior to ASTRAL on single-copy gene trees (as evident481 from previous studies (Mahbub et al., 2021, 2022)), wQFM paired with DISCO-4 is482\n23"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "24"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "more accurate and robust than ASTRAL-Pro under a wide variety of challenging model483 conditions.484\n6.2 Results on Biological Dataset485\n6.2.1 Plant (1KP) dataset486\nWe reanalyzed the transcriptome dataset consisting of 103 plant species, which was orig-487 inally analyzed by Wickett et al. (2014) (Wickett et al., 2014) using 424 single-copy gene488 trees with the ASTRAL method. The original study inferred 9,683 multicopy gene trees489 as well, containing up to 2,395 leaves, for 80 out of the 103 species, and three additional490\n25"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "genomes, making a total of 83 genomes. However, these multicopy gene trees were not491 analyzed due to a lack of suitable methods. Later, ASTRAL-Pro analyzed these mul-492 ticopy gene trees. We reanalyzed this dataset using wQFM paired with both DISCO493 and DISCO-4. DISCO and DISCO-4 decompose these multicopy gene trees into 55,297494 single-copy gene trees.495 wQFM-DISCO-4 returned a tree that is highly congruent with the ASTRAL-Pro496 tree, differing only on three branches with low support (Fig. 7. wQFM-DISCO-4 and497 ASTRAL-Pro trees differ from the ASTRAL tree based on single-copy gene trees reported498 byWickett et al. (2014) in two and five branches, respectively. Both wQFM-DISCO-4 and499 ASTRAL-Pro exhibit a significant difference from ASTRAL in that they both strongly500 support the GnePine hypothesis, where Gnetales is sister to Pinaceae, nested within501 the Coniferales. ASTRAL, on the other hand, recovered the Gnetifier hypothesis (i.e.,502 Gnetales is sister to Coniferales as a whole). ASTRAL-Pro differs from both the ASTRAL503 and the concatenated analysis using super matirix in the placement of Yucca. In contrast,504 the placement of Yucca in the wQFM-DISCO-4-estimated tree aligns with ASTRAL and505 the concatenated analysis. Similarly, ASTRAL-Pro, unlike wQFM-DISCO-4, differs from506 both ASTRAL and concatenated analysis in the relative position of Coleochaetale and507 Chara. ASTRAL-Pro placed Chara and embryophytes as sisters which was rejected by508 most of the analyses in Wicket et al (Wickett et al., 2014) (see Fig. 4 in Wicket et509 al). Another discordance with low support is related to the placements of Rosmarinus510 and Ipomoea, where ASTRAL-Pro, unlike ASTRAL, concatenated analysis and wQFM-511 DISCO-4, grouped them together as sisters.512 Comparing wQFM-DISCO-4 and wQFM-DISCO, we found differences in two branches:513 1) the placement of Yucca, and 2) the sister relationships of Rosmarinus and Ipomoea.514 In relation to these two differences, wQFM-DISCO is aligned with ASTRAL-Pro, while515 wQFM-DISCO-4 is aligned with the original ASTRAL and concatenated analysis. wQFM-516 DISCO tree, which exhibits discordance with the ASTRAL tree on four branches, is highly517 aligned with the ASTRAL-Pro tree, with only one difference pertaining to the placement518\n26"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "of chara. Thus, all the methods inferred reasonable species trees, differing from each519 other in two to five branches (often with low support), where the ground truth is subject520 to debate.521\n6.2.2 Fungal dataset522\nWe analyzed two fungal datasets: 1) a data set containing 16 yeast species with 7,280523 multicopy gene families available from Butler et al. (2009), and 2) a 60-species dataset524 from Morel et al. (2022).525\n16-species yeast dataset. Butler et al. (2009) analyzed only single copy gene trees526 based on 706 one-to-one orthologs (Butler et al., 2009). We re-analyzed the data consid-527 ering all the 7,280 multicopy gene trees (see Fig. 8(b). wQFM-DISCO, wQFM-DISCO-4528 and ASTRAL-Pro returned an identical tree, which differs from the tree reported in the529 original study on only one branch, introducing discordance in the relative position of530 Saccharomyces castellii and Candida glabrata. The original study placed Saccharomyces531 castellii as sister to Candida glabrata and the Saccharomyces group which was imposed by532 a constraint during the ML search. ASTRAL-Pro, wQFM-DISCO and wQFM-DISCO-533 4 trees placed Candida glabrata as sister to the Saccharomyces group, which is aligned534 with the unconstrained ML search in the concatenated analysis and the tree reported by535 Salichors and Rokas (Salichos and Rokas, 2013).536\n60-species fungal dataset. Morel et al. (2022) extracted a fungal dataset of 60 species537 from PhylomeDB (Huerta-Cepas et al., 2014). In their study, they found that ASTRAL-538 Pro, SpeciesRAX and FastMulRFS infer the same tree. In our study, we found that539 wQFM-DISCO-4 infers the same tree as well, which agrees with the species tree obtained540 by concatenation (Marcet-Houben and Gabaldo\u0301n, 2009) (see Fig. 8(a). However, this tree541 contradicts the relationship established in the literature regarding one specific branch,542 related to the positioning of the clade comprising Chytridiomycota (Batrachochytrium543 dendrobatidis) and Zygomycota (Rhizopus oryzae and Phycomyces blakesleeanus). Morel544\n27\nDISCO-enabled wQFM\n28"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "29"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "et al. (2022) discussed the biological phenomenon of this split in detail.545\n6.3 Running time546\nThe running time of wQFM is largely dominated by its \u2126(|leaf |4) quartet generation547 step from gene trees. When the only cause of gene tree discordance is ILS, the number of548 leaves equal the number of taxa. However, with GDL in consideration, specially in cases549 where the duplication rate is much larger than the loss rate, the number of leaves are550 often times many factors larger than the number of taxon. Running DISCO ensures that551 the quartet generation step can run in \u2126(min(|leaf |, |taxon|)4) time. For analyzing the552 S100 dataset, the quartet generation took 4 hours on average, but wQFM took only 10553 minutes minutes on average to infer a species tree from the weighted quartets. ASTRAL-554 Pro and ASTRAL-DISCO are faster and takes less than 2 minutes on average to infer the555 species tree from gene trees. On the 1KP plant dataset with 83 species, generating the556 quartets from gene trees took seven hours and running wQFM on the quartets took only557 5 minutes. ASTRAL-Pro took 39 minutes to infer a species tree. The superior accuracy558 produced by wQFM further motivates us to focus on how to improve its running time.559 Especially, if wQFM could be run without explicitly enumerating all quartets from input560 gene trees (which is the most time-consuming step), it would be much more scalable to561 large datasets.562\n7 Conclusions563\nWe introduced wQFM-DISCO as a remarkably accurate method for estimating species564 trees in the presence of gene duplication and loss events. The superior performance of565 wQFM-DISCO over ASTRAL-Pro across diverse model conditions demonstrates its effi-566 cacy and advancement in species tree estimation by effectively modeling both orthology567 and paralogy. Most of the popular summary methods were originally designed to take ILS568 into account and cannot handle multicopy gene trees resulting from GDL events. While569\n30"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "several parsimony-based summary methods such as DynaDup, DupTree, and iGTP have570 been developed to consider GDL events, they lack statistical significance. Additionally,571 traditional approaches like combined analysis or concatenation are not applicable to mul-572 ticopy gene trees. Reasonably accurate co-estimation methods exist (Boussau et al.,573 2013b; Zhang and Wu, 2017) but are computationally demanding, limiting their appli-574 cation to small datasets. Hence, species tree estimation in the presence of GDL remains575 challenging.576 ASTRAL-Pro and DISCO are recent advancements in this field. ASTRAL-Pro, a577 recent summary method, is capable of modeling both orthology and paralogy. DISCO, a578 simple yet valuable strategy, enables the utilization of methods designed for single-copy579 gene trees on multicopy gene trees. Our study examined various underlying hypotheses580 of DISCO and established its robustness by exploring different pruning strategies and581 scoring schemes for duplication and loss events. We proposed a novel pruning strat-582 egy in DISCO, referred to as DISCO-R, which enhances its accuracy and robustness by583 effectively incorporating more speciation-driven quartets. Finally, we proposed wQFM-584 DISCO as an adaptation of wQFM for estimating species trees despite the presence of585 paralogy. Extensive evaluations on diverse simulated and real datasets demonstrated that586 wQFM-DISCO consistently outperforms ASTRAL-Pro and other competing methods in587 terms of tree accuracy.588 While quartet-based methods like ASTRAL, wQFM, and SVDQuartets are highly589 accurate and widely used, their application to handle GDL events is limited. ASTRAL-590 Pro was the first known quartet-based method capable of handling multicopy gene trees591 and was shown to have superior accuracy compared to other competing methods. wQFM592 was shown to be more accurate than ASTRAL in multiple studies covering a wide range593 of model conditions including incomplete gene trees. However, wQFM was not suitable594 for multicopy gene trees. Therefore, the adaptation of wQFM for multicopy gene trees595 using DISCO and the demonstrated excellent performance of wQFM-DISCO represent596 significant advancements in the field.597\n31"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "wQFM, despite being more accurate than ASTRAL, has not gained widespread pop-598 ularity as a species tree estimation method, perhaps due to its limited scalability when599 dealing with large datasets containing hundreds of taxa. The presence of gene duplication600 leads to a substantial increase in the number of leaves, posing an additional challenge to601 the applicability of wQFM. Importantly, however, the decomposition of multicopy gene602 trees into single-copy trees using DISCO results in a reduction of leaf numbers, making603 them more suitable for analysis with wQFM. Thus, wQFM-DISCO is sufficiently fast604 to analyze the datasets from many important phylogenomic studies (Morel et al., 2022;605 Wickett et al., 2014). Therefore, wQFM paired with DISCO represents a highly accurate606 and scalable method to account for both orthology and paralogy, which we believe should607 be considered as a potential tool to estimate species trees in the presence of ILS and GDL.608 This study can be extended in several directions. We analyzed the dataset from the609 ASTRAL-Pro study covering a wide variety of model conditions. However, future stud-610 ies need to explore more complex scenarios involving biological processes such as whole611 genome duplication events, hemiplasy of duplication and loss events, horizontal gene612 transfer, and others. Although we proved ASTRAL-DISCO to be statistically consis-613 tent under the unified model of duplication, loss and coalescence (DLCoal), we could not614 establish any statistical consistency results for DISCO-R variants. We hypothesize that615 ASTRAL with DISCO-R would also be statistically significant under DLCoal. There have616 been some other theoretical results on the MQSST problem (Lafond and Scornavacca,617 2019). In particular, the problem is shown to be Fixed Parameter Tractable (FPT), and618 it also admits a PTAS. Future studies can extend such results in the setting of GDL and619 explore whether DISCO or DISCO-R can provide any provable approximation guarantee620 of the optimization problem they try to solve.621\n32"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "Availability622\nDISCO-R and other variants are freely available in open source form at https://github.623 com/skhakim/DISCO-variants. All the datasets analyzed in this paper are from previ-624 ously published studies and are publicly available.625\nCompeting interests626\nThe authors declare that they have no competing interests.627\nReferences628\nOne thousand plant transcriptomes and the phylogenomics of green plants. Nature, 574629 (7780):679\u2013685, 2019.630\nA. M. Altenhoff, N. M. Glover, and C. Dessimoz. Inferring orthology and paralogy.631 Evolutionary genomics: statistical and computational methods, pages 149\u2013175, 2019.632\nL. Arvestad, A. C. Berglung, J. Lagergren, and B. Sennblad. Gene tree reconstruction633 and orthology analysis based on an integrated model for duplications and sequence634 evolution. In O. Bininda-Emonds, editor, RECOMB, pages 238\u2013252, 2004.635\nE. Avni, R. Cohen, and S. Snir. Weighted quartets phylogenetics. Systematic biology, 64636 (2):233\u2013242, 2015.637\nM. S. Bayzid. Inferring optimal species trees in the presence of gene duplication and loss:638 Beyond rooted gene trees. Journal of Computational Biology, 30(2):161\u2013175, 2023.639\nM. S. Bayzid and T. Warnow. Estimating optimal species trees from incomplete gene640 trees under deep coalescence. Journal of Computational Biology, 19(6):591\u2013605, 2012.641\nM. S. Bayzid and T. Warnow. Naive binning improves phylogenomic analyses. Bioinfor-642 matics, 29(18):2277\u20132284, 2013.643\n33"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "M. S. Bayzid and T. Warnow. Gene tree parsimony for incomplete gene trees: addressing644 true biological loss. Algorithms for Molecular Biology, 13:1, 2018.645\nM. S. Bayzid, S. Mirarab, and T. Warnow. Inferring optimal species trees under gene646 duplication and loss. In Proc. of Pacific Symposium on Biocomputing (PSB), volume 18,647 pages 250\u2013261, 2013.648\nB. Boussau, G. J. Szo\u0308llo\u030bsi, L. Duret, M. Gouy, E. Tannier, and V. Daubin. Genome-scale649 coestimation of species and gene trees. Genome research, 23(2):323\u2013330, 2013a.650\nB. Boussau, G. J. Szo\u0308llo\u030bsi, L. Duret, M. Gouy, E. Tannier, and V. Daubin. Genome-scale651 coestimation of species and gene trees. Genome Research, 23(2):323\u2013330, 2013b.652\nD. Bryant, R. Bouckaert, J. Felsenstein, N. A. Rosenberg, and A. RoyChoudhury. Infer-653 ring species trees directly from biallelic genetic markers: bypassing gene trees in a full654 coalescent analysis. Molecular biology and evolution, 29(8):1917\u20131932, 2012.655\nG. Butler, M. D. Rasmussen, M. F. Lin, M. A. S. Santos, S. Sakthikumar, C. A. Munro,656 E. Rheinbay, M. Grabherr, A. Forche, J. L. Reedy, I. Agrafioti, M. B. Arnaud, S. Bates,657 A. J. P. Brown, S. Brunke, M. C. Costanzo, D. A. Fitzpatrick, P. W. J. de Groot,658 D. Harris, L. L. Hoyer, B. Hube, F. M. Klis, C. Kodira, N. Lennard, M. E. Logue,659 R. Martin, A. M. Neiman, E. Nikolaou, M. A. Quail, J. Quinn, M. C. Santos, F. F.660 Schmitzberger, G. Sherlock, P. Shah, K. A. T. Silverstein, M. S. Skrzypek, D. Soll,661 R. Staggs, I. Stansfield, M. P. H. Stumpf, P. E. Sudbery, T. Srikantha, Q. Zeng,662 J. Berman, M. Berriman, J. Heitman, N. A. R. Gow, M. C. Lorenz, B. W. Birren,663 M. Kellis, and C. A. Cuomo. Evolution of pathogenicity and sexual reproduction664 in eight Candida genomes. Nature, 459:657\u2013662, June 2009. ISSN 1476-4687. doi:665 10.1038/nature08064.666\nR. Chaudhary, M. S. Bansal, A. Wehe, D. Ferna\u0301ndez-Baca, and O. Eulenstein. iGTP:667 a software package for large-scale gene tree parsimony analysis. BMC Bioinformatics,668 pages 574\u2013574, 2010.669\n34"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "R. Chaudhary, J. G. Burleigh, and D. Ferna\u0301ndez-Baca. Inferring species trees from670 incongruent multi-copy gene trees using the Robinson-Foulds distance. Algorithms for671 Molecular Biology, 8(1):1\u201312, Dec. 2013. ISSN 1748-7188. doi: 10.1186/1748-7188-8-28.672\nJ. Chifman and L. Kubatko. Quartet from snp data under the coalescent model. Bioin-673 formatics, 30(23):3317\u20133324, 2014.674\nL. A. David and E. J. Alm. Rapid evolutionary innovation during an archaean genetic675 expansion. Nature, 469(7328):93\u201396, Dec. 2010. doi: 10.1038/nature09649. URL676 https://doi.org/10.1038/nature09649.677\nL. De Oliveira Martins, D. Mallo, and D. Posada. A bayesian supertree model for genome-678 wide species tree reconstruction. Systematic biology, 65(3):397\u2013416, 2016.679\nC. W. Dunn, M. Howison, and F. Zapata. Agalma: an automated phylogenomics work-680 flow. BMC bioinformatics, 14(1):1\u20139, 2013.681\nW. M. Fitch. Homology: a personal view on some of the problems. Trends in genetics,682 16(5):227\u2013231, 2000.683\nA. Hejnol, M. Obst, A. Stamatakis, M. Ott, G. W. Rouse, G. D. Edgecombe, P. Martinez,684 J. Bagun\u0303a\u0300, X. Bailly, U. Jondelius, et al. Assessing the root of bilaterian animals with685 scalable phylogenomic methods. Proceedings of the Royal Society B: Biological Sciences,686 276(1677):4261\u20134270, 2009.687\nJ. Heled and A. J. Drummond. Bayesian inference of species trees from multilocus data.688 Mol Biol Evol, 27:570\u2013580, 2010.689\nJ. Huerta-Cepas, S. Capella-Gutie\u0301rrez, L. P. Pryszcz, M. Marcet-Houben, and T. Ga-690 baldo\u0301n. PhylomeDB v4: zooming into the plurality of evolutionary histories of a691 genome. Nucleic Acids Research, 42(Database):D897, Jan. 2014. doi: 10.1093/nar/692 gkt1177.693\n35"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "M. Islam, K. Sarker, T. Das, R. Reaz, and M. S. Bayzid. Stelar: A statistically consistent694 coalescent-based species tree estimation method by maximizing triplet consistency.695 BMC genomics, 21(1):1\u201313, 2020.696\nK. M. Kocot, M. R. Citarella, L. L. Moroz, and K. M. Halanych. Phylotreepruner: a phy-697 logenetic tree-based approach for selection of orthologous sequences for phylogenomics.698 Evolutionary Bioinformatics, 9:EBO\u2013S12813, 2013.699\nM. Lafond and C. Scornavacca. On the Weighted Quartet Consensus problem. Theoretical700 Computer Science, 769:1\u201317, May 2019. ISSN 0304-3975. doi: 10.1016/j.tcs.2018.10.701 005.702\nB. Legried, E. K. Molloy, T. Warnow, and S. Roch. Polynomial-time statistical estimation703 of species trees under gene duplication and loss. Journal of Computational Biology,704 2020.705\nL. Liu. BEST: Bayesian estimation of species trees under the coalescent model. Bioinf,706 24:2542\u20132543, 2008.707\nM. Mahbub, Z. Wahab, R. Reaz, M. S. Rahman, and M. S. Bayzid. wQFM: highly708 accurate genome-scale species tree estimation from weighted quartets. Bioinformatics,709 37(21):3734\u20133743, Nov. 2021. ISSN 1367-4803. doi: 10.1093/bioinformatics/btab428.710\nS. Mahbub, S. Sawmya, A. Saha, R. Reaz, M. S. Rahman, and Md. S. Bayzid. Quartet711 Based Gene Tree Imputation Using Deep Learning Improves Phylogenomic Analyses712 Despite Missing Data. Journal of Computational Biology, 29(11):1156\u20131172, Nov. 2022.713 doi: 10.1089/cmb.2022.0212.714\nM. Marcet-Houben and T. Gabaldo\u0301n. The tree versus the forest: the fungal tree of life715 and the topological diversity within the yeast phylome. PloS one, 4(2):e4357, 2009.716\nA. Markin and O. Eulenstein. Quartet-based inference is statistically consistent under717\n36"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "the unified duplication-loss-coalescence model. Bioinformatics, 37(22):4064\u20134074, Nov.718 2021. ISSN 1367-4803. doi: 10.1093/bioinformatics/btab414.719\nS. A. Mim, M. Zarif-Ul-Alam, R. Reaz, M. S. Bayzid, and M. S. Rahman. Quartet720 Fiduccia\u2013Mattheyses revisited for larger phylogenetic studies. Bioinformatics, 39(6):721 btad332, June 2023. ISSN 1367-4811. doi: 10.1093/bioinformatics/btad332.722\nS. Mirarab, R. Reaz, M. S. Bayzid, T. Zimmermann, M. S. Swenson, and T. Warnow.723 ASTRAL: genome-scale coalescent-based species tree estimation. Bioinformatics, 30724 (17):i541\u2013i548, 2014.725\nE. K. Molloy and T. Warnow. FastMulRFS: fast and accurate species tree estimation726 under generic gene duplication and loss models. Bioinformatics, 36(Supplement1):727 i57\u2013i65, July 2020. ISSN 1367-4803. doi: 10.1093/bioinformatics/btaa444.728\nB. Morel, P. Schade, S. Lutteropp, T. A. Williams, G. J. Szo\u0308llo\u030bsi, and A. Stamatakis.729 Speciesrax: a tool for maximum likelihood species tree inference from gene family trees730 under duplication, transfer, and loss. Molecular biology and evolution, 39(2):msab365,731 2022.732\nM. D. Rasmussen and M. Kellis. Unified modeling of gene duplication, loss, and733 coalescence using a locus tree. Genome Research, 22(4):755, Apr. 2012. doi:734 10.1101/gr.123901.111.735\nR. Reaz, M. S. Bayzid, and M. S. Rahman. Accurate phylogenetic tree reconstruction736 from quartets: A heuristic approach. PLoS One, 9(8):e104008, 2014.737\nD. Robinson and L. Foulds. Comparison of phylogenetic trees. Math. Biosci., 53:131\u2013147,738 1981.739\nL. Salichos and A. Rokas. Inferring ancient divergences requires genes with strong phy-740 logenetic signals. Nature, 497:327\u2013331, May 2013. ISSN 1476-4687. doi: 10.1038/741 nature12130.742\n37"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "E. Sayyari and S. Mirarab. Fast coalescent-based computation of local branch support743 from quartet frequencies. Molecular Biology and Evolution, 33(7):1654\u20131668, 2016.744\nB. T. Smith, M. G. Harvey, B. C. Faircloth, T. C. Glenn, and R. T. Brumfield. Target745 capture and massively parallel sequencing of ultraconserved elements for comparative746 studies at shallow evolutionary time scales. Systematic biology, 63(1):83\u201395, 2013.747\nS. Snir and S. Rao. Quartets MaxCut: a divide and conquer quartets algorithm.748 IEEE/ACM Trans. Comput. Biol. Bioinform., 7(4):704\u2013718, 2010.749\nG. J. Szo\u0308llo\u030bsi, E. Tannier, V. Daubin, and B. Boussau. The inference of gene trees with750 species trees. Systematic biology, 64(1):e42\u2013e62, 2015.751\nT. Warnow. Computational Phylogenetics: An Introduction to Designing Methods for752 Phylogeny Estimation. Cambridge University Press, Cambridge, England, UK, Oct.753 2017. ISBN 978-1-10718471-8. doi: 10.1017/9781316882313.754\nA. Wehe, M. S. Bansal, J. G. Burleigh, and O. Eulenstein. Duptree: A program for large-755 scale phylogenetic analyses using gene tree parsimony. American Journal of Botany,756 24(13):1540\u20131541, 2008.757\nN. J. Wickett, S. Mirarab, N. Nguyen, T. Warnow, E. Carpenter, N. Matasci, S. Ayyam-758 palayam, M. S. Barker, J. G. Burleigh, M. A. Gitzendanner, et al. Phylotranscriptomic759 analysis of the origin and early diversification of land plants. Proceedings of the National760 Academy of Sciences, 111(45):E4859\u2013E4868, 2014.761\nF. Wilcoxon. Individual comparisons by ranking methods. Biometrics Bulletin, 1(6):762 80\u201383, 1945. ISSN 00994987. URL http://www.jstor.org/stable/3001968.763\nJ. Willson, M. S. Roddur, B. Liu, P. Zaharias, and T. Warnow. DISCO: Species Tree764 Inference using Multicopy Gene Family Tree Decomposition. Systematic Biology, 71765 (3):610\u2013629, 08 2021. ISSN 1063-5157. doi: 10.1093/sysbio/syab070. URL https:766 //doi.org/10.1093/sysbio/syab070.767\n38"
        },
        {
            "heading": "DISCO-enabled wQFM",
            "text": "Y. Yang and S. A. Smith. Orthology inference in nonmodel organisms using transcrip-768 tomes and low-coverage genomes: improving accuracy and matrix occupancy for phy-769 logenomics. Molecular biology and evolution, 31(11):3081\u20133092, 2014.770\nB. Zhang and Y.-C. Wu. Coestimation of Gene Trees and Reconciliations Under a771 Duplication-Loss-Coalescence Model, 2017. URL https://www.semanticscholar.772 org/paper/Coestimation-of-Gene-Trees-and-Reconciliations-a-Zhang-Wu/773 f62a080029d86ca57aae70c0d5f21fbdf626de03. [Online; accessed 10. Aug. 2023].774\nC. Zhang, C. Scornavacca, E. K. Molloy, and S. Mirarab. ASTRAL-Pro: Quartet-Based775 Species-Tree Inference despite Paralogy. Molecular Biology and Evolution, 37(11):3292\u2013776 3307, Nov. 2020. ISSN 0737-4038. doi: 10.1093/molbev/msaa139.777\nL. Zhang. From gene trees to species trees II: Species tree inference by minimizing deep778 coalescence events. IEEE/ACM Trans Comp Biol Bioinf, 99(PrePrints), 2011. ISSN779 1545-5963. doi: http://doi.ieeecomputersociety.org/10.1109/TCBB.2011.83.780\n39"
        }
    ],
    "title": "wQFM-DISCO: DISCO-enabled wQFM improves phylogenomic analyses despite the presence of paralogs",
    "year": 2023
}