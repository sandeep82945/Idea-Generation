{
    "authors": [
        {
            "affiliations": [],
            "name": "Mohamad Sawan"
        },
        {
            "affiliations": [],
            "name": "Dawei Mai"
        },
        {
            "affiliations": [],
            "name": "Michael Peter Kennedy"
        }
    ],
    "id": "SP:3f083c15fe5ca3db13ee2595f09e8982d1e3fa36",
    "references": [],
    "sections": [
        {
            "heading": "Analog Circuits and Signal Processing",
            "text": ""
        },
        {
            "heading": "Series Editors",
            "text": "Mohammed Ismail, Khalifa University, Dublin, OH, USA Mohamad Sawan, Montreal, QC, Canada\nThe Analog Circuits and Signal Processing book series, formerly known as the Kluwer International Series in Engineering and Computer Science, is a high level academic and professional series publishing research on the design and applications of analog integrated circuits and signal processing circuits and systems. Typically per year we publish between 5\u201315 research monographs, professional books, handbooks, edited volumes and textbooks with worldwide distribution to engineers, researchers, educators, and libraries.\nThe book series promotes and expedites the dissemination of new research results and tutorial views in the analog field. There is an exciting and large volume of research activity in the field worldwide. Researchers are striving to bridge the gap between classical analog work and recent advances in very large scale integration (VLSI) technologies with improved analog capabilities. Analog VLSI has been recognized as a major technology for future information processing. Analog work is showing signs of dramatic changes with emphasis on interdisciplinary research efforts combining device/circuit/technology issues. Consequently, new design concepts, strategies and design tools are being unveiled.\nTopics of interest include: Analog Interface Circuits and Systems; Data converters; Active-RC, switched-capacitor and continuous-time integrated filters; Mixed analog/digital VLSI; Simulation and modeling, mixed-mode simulation; Analog nonlinear and computational circuits and signal processing; Analog Artificial Neural Networks/Artificial Intelligence; Current-mode Signal Processing; Computer-Aided Design (CAD) tools; Analog Design in emerging technologies (Scalable CMOS, BiCMOS, GaAs, heterojunction and floating gate technologies, etc.); Analog Design for Test; Integrated sensors and actuators; Analog Design Automation/Knowledge-based Systems; Analog VLSI cell libraries; Analog product development; RF Front ends, Wireless communications and Microwave Circuits; Analog behavioral modeling, Analog HDL.\nMore information about this series at http://www.springer.com/series/7381\nDawei Mai \u2022 Michael Peter Kennedy\nWandering Spurs in MASH-Based Fractional-N Frequency Synthesizers\nHow They Arise and How to Get Rid of Them\nDawei Mai University College Dublin Dublin, Ireland\nMichael Peter Kennedy University College Dublin Dublin, Ireland\nISSN 1872-082X ISSN 2197-1854 (electronic) Analog Circuits and Signal Processing ISBN 978-3-030-91284-0 ISBN 978-3-030-91285-7 (eBook) https://doi.org/10.1007/978-3-030-91285-7\n\u00a9 The Editor(s) (if applicable) and The Author(s), under exclusive license to Springer Nature Switzerland AG 2022 This work is subject to copyright. All rights are solely and exclusively licensed by the Publisher, whether the whole or part of the material is concerned, specifically the rights of translation, reprinting, reuse of illustrations, recitation, broadcasting, reproduction on microfilms or in any other physical way, and transmission or information storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology now known or hereafter developed. The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication does not imply, even in the absence of a specific statement, that such names are exempt from the relevant protective laws and regulations and therefore free for general use. The publisher, the authors and the editors are safe to assume that the advice and information in this book are believed to be true and accurate at the date of publication. Neither the publisher nor the authors or the editors give a warranty, expressed or implied, with respect to the material contained herein or for any errors or omissions that may have been made. The publisher remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nThis Springer imprint is published by the registered company Springer Nature Switzerland AG The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland\nTo my family (D. M.) To Rossana (M. P. K.)"
        },
        {
            "heading": "Preface",
            "text": "Fractional-N frequency synthesizers are commonly used in communication systems. A divider controller is employed within a conventional divider-based fractional-N frequency synthesizer to achieve the desired fractional division ratio. A Multi-stAge noiSe-sHaping Digital Delta-Sigma Modulator (MASH DDSM) is usually used as the divider controller because of its high-pass shaped quantization error and ease of implementation. Among contributors to the output phase noise of a conventional fractional-N frequency synthesizer, the noise of the divider controller is normally high-pass shaped and its in-band contribution can ideally be ignored under the assumption of linearity. However, in the presence of nonlinearity, the phase noise contribution of the divider controller can become prominent in-band and spurious tones (abbreviated as \u201cspurs\u201d) appear. The causes of divider controllerinduced spurious tones in the long-term spectrum have been the focus of research for many years, and efforts continue to be made to identify and mitigate nonlinearityinduced spurs in fractional-N frequency synthesizers.\nIn addition to these spurs at fixed frequencies in the long-term spectrum (socalled \u201cfixed\u201d spurs), the short-term spectrum of a MASH DDSM-based fractionalN synthesizer can exhibit a type of time-varying spur phenomenon that is called wandering spurs. This type of spur appears in the short-term spectrum of the fractional-N frequency synthesizer and can impact applications such as radar and burst communications that depend on short windows of operation. Observations and analysis suggest that the phenomenon of wandering spurs originates in the MASH DDSM divider controller. In the third-order MASH 1-1-1 divider controller-based synthesizer considered in this book, the wandering spurs can be categorized based on the input of the MASH DDSM. Each type of wandering spur has a distinct cause.\nTechniques to mitigate wandering spurs have been proposed for MASH-based synthesizers. In this book, dither-based solutions built on the commonly used MASH 1-1-1 DDSM and dither-independent solutions that exploit modifications of the original MASH 1-1-1 architecture are analyzed and compared.\nThe book is structured as follows: In Chap. 2, a conventional fractional-N frequency synthesizer and simulation\nmethods to study it are reviewed.\nvii\nviii Preface\nIn Chap. 3, divider controller-induced fixed spurs in a MASH DDSM-based fractional-N frequency synthesizer are described in detail.\nIn Chap. 4, the root cause of wandering spurs is revealed. In Chap. 5, analysis of the three distinct cases of wandering spurs is presented. In Chap. 6, techniques to mitigate wandering spurs are developed based on the knowledge of their causes. In Chap. 7, measurement results for an implemented fractional-N frequency synthesizer demonstrator with MASH-based divider controllers for wandering spur mitigation are presented.\nAfter completing this book, we hope that the reader will have both an intuitive and a mathematical understanding of the phenomenon of wandering spurs. The reader will know how they arise and how to eliminate or mitigate them.\nDublin, Ireland Dawei Mai August 2021 M. Peter Kennedy"
        },
        {
            "heading": "Acknowledgments",
            "text": "We would like to thank Yann Donnelly from UCC/Tyndall National Institute, Stefano Tulisi, James Breslin, Pat Griffin, Michael Connor, Stephen Brookes, Brian Shelly, and Michael Keaveney from the team at Analog Devices Limerick for their excellent work in implementing and testing the demonstrator synthesizer in this book.\nThe screenshots of real-time spectra, phase noise spectra, and spectra from"
        },
        {
            "heading": "Contents",
            "text": "1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 1.1 Spurious Tones in Fractional-N Frequency Synthesizers . . . . . . . . . . . . 1\n1.1.1 Nonlinearity-Induced Fixed Spurious Tones . . . . . . . . . . . . . . . . . . 1 1.1.2 Wandering Spurs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n1.2 Contributions of This Book . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n2 Simulation of Phase Noise in a Fractional-N Frequency Synthesizer . . 7 2.1 Conventional Fractional-N Synthesizer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 2.2 Evaluation of Phase Noise in a Fractional-N Frequency Synthesizer 10\n2.2.1 Closed-Loop Behavioral Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10 2.2.2 Feedforward Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12 2.2.3 Evaluation of Phase Noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n2.3 Models of Nonlinearity in Fractional-N Frequency Synthesizer . . . . . 17 2.3.1 Spectral Impact of Nonlinearity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17 2.3.2 Piecewise Linear Nonlinearity Model . . . . . . . . . . . . . . . . . . . . . . . . . 19 2.3.3 Polynomial Nonlinearity Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20 2.3.4 Measuring Spurious Tones . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21 2.3.5 Simulations with a Nonlinearity Model . . . . . . . . . . . . . . . . . . . . . . . 22 2.4 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n3 Spurious Tones in Fractional-N Frequency Synthesizers . . . . . . . . . . . . . . . 25 3.1 Divider Controller-Induced Stationary Spurs in a\nMASH-Based Frequency Synthesizer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25 3.1.1 Integer Boundary Spurs (IBS) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25 3.1.2 Fractional Boundary Spurs. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27 3.1.3 Sub-Harmonic Spurs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n3.2 Wandering Spurs and the Spectrogram Method. . . . . . . . . . . . . . . . . . . . . . . 30 3.2.1 Wandering Spur in Long-Term Spectrum . . . . . . . . . . . . . . . . . . . . . 30 3.2.2 Spectrogram Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 3.3 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\nxi\nxii Contents"
        },
        {
            "heading": "4 Wandering Spurs and the MASH DDSM Divider Controller . . . . . . . . . . 35",
            "text": "4.1 MASH 1-1-1 DDSM-Based Fractional-N Frequency Synthesizer . . 35 4.2 Observation of Wandering Spurs in a Fractional-N Synthesizer . . . . . 36 4.3 Generating Mechanism of Wandering Spur in a MASH\n1-1-1-Based Fractional-N Synthesizer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39 4.3.1 Linear Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40 4.3.2 Nonlinear Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42\n4.4 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45"
        },
        {
            "heading": "5 Analysis of MASH 1-1-1-Induced Wandering Spur Patterns",
            "text": "in a Fractional-N Frequency Synthesizer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47 5.1 Structures of MASH 1-1-1 Internal States and Wandering Spurs . . . . 47\n5.1.1 Parabolic Structure of e2[n] and the Chirping in y2[n] . . . . . . . 47 5.1.2 Spectral Properties of y2[n] and e2[n] . . . . . . . . . . . . . . . . . . . . . . . . . 51\n5.2 Categorization of Wandering Spurs by MASH 1-1-1 Input . . . . . . . . . . 54 5.2.1 The Fractional Form of the Input X . . . . . . . . . . . . . . . . . . . . . . . . . . . 54 5.2.2 Categories of Wandering Spurs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56 5.3 Wandering Spur Pattern in Case I: Small Input X Contributes to the Linear Pattern After First Accumulation . . . . . . . . . . 57 5.4 Wandering Spur Patterns in Case II: Residue Under Modulo Operation Contributes to the Linear Pattern After the First Accumulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58 5.4.1 Time Domain Waveforms and the Fundamental\nWander Rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58 5.4.2 Occurrences of Higher Wander Rates on e2[n] Spectrogram 62 5.4.3 T1[n]-Induced Pattern and the Parity of D . . . . . . . . . . . . . . . . . . . . 64 5.4.4 Summary. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69\n5.5 Wandering Spur Patterns in Case III: Large Input X and No Residue Under Modulo Operation After the First Accumulation . . . . 71 5.5.1 Case A: Small Initial Value Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73 5.5.2 Case B: Large Initial Value Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74 5.5.3 Summary. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76 5.6 Example of Wandering Spurs in Other DDSMs . . . . . . . . . . . . . . . . . . . . . . 77 5.6.1 MASH 2-1 DDSM .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77 5.6.2 MASH 1-1-1 Alternatives. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80 5.6.3 Other MASH DDSMs. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83 5.6.4 A Cascade-of-Integrators with Feedforward (CIFF) DDSM . 86 5.7 Measurement Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87 5.7.1 Case I and Case II . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87 5.7.2 Case III. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90 5.8 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91"
        },
        {
            "heading": "6 MASH-Based Divider Controllers for Mitigation of",
            "text": "Wandering Spurs. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93 6.1 Root Cause of Wandering Spurs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93 6.2 Dither-Based Solutions to Wandering Spurs . . . . . . . . . . . . . . . . . . . . . . . . . . 94\nContents xiii\n6.3 Modified MASH DDSM Solutions to Wandering Spurs . . . . . . . . . . . . . 99 6.3.1 Second-Order Solutions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100 6.3.2 Third-Order Solutions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103 6.3.3 Summary. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106 6.4 Evaluation of Spectral Performance of the Representative Designs . 107 6.4.1 Envelope of Short-Term Spectrum . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107 6.4.2 Noise Floor in Long-Term Spectrum . . . . . . . . . . . . . . . . . . . . . . . . . . 107 6.4.3 Fixed Spurs in Long-Term Spectrum. . . . . . . . . . . . . . . . . . . . . . . . . . 109 6.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110"
        },
        {
            "heading": "7 Measurement Results for MASH-Based Wandering Spur",
            "text": "Mitigation Solutions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113 7.1 Implemented Synthesizer and Divider Controller Structure . . . . . . . . . . 113\n7.1.1 The Fractional-N Frequency Synthesizer . . . . . . . . . . . . . . . . . . . . . 113 7.1.2 MASH-Based Divider Controllers . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114 7.1.3 Measurement Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117\n7.2 Performance of Wandering Spur Mitigation . . . . . . . . . . . . . . . . . . . . . . . . . . 117 7.2.1 Standard MASH 1-1-1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118 7.2.2 Summary of Wandering Spur Patterns Observed in\nthe MASH 1-1-1-Based Synthesizer . . . . . . . . . . . . . . . . . . . . . . . . . . 121 7.2.3 Mode 1: Uniform Dither Solution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121 7.2.4 Mode 2: Modified Third EFM1 with DT (z) = \u2212z\u22121 + 2z\u22122 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124 7.2.5 Mode 3: Modified Third EFM1 with DT (z) = z\u22122 . . . . . . . . . . 125 7.2.6 Mode 4: Modified Third EFM1 with DT (z) = \u22122z\u22121(1 \u2212 z\u22121) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127 7.2.7 Mode 5: Modified Third EFM1 with DT (z) = 2z\u22122(1 \u2212 z\u22121) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129 7.2.8 Summary of the Performance of Wandering Spur Mitigation 131\n7.3 Output Phase Noise Performance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131 7.3.1 Standard MASH 1-1-1 and the Uniform Dither Solution . . . . 131 7.3.2 Modified MASH Solutions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132 7.3.3 Summary of Jitter Performance. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133 7.3.4 IBS Performance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133 7.4 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135\nA Relation Between Fractional Boundary Spurs and Fractional Spurs . . 137\nB Proofs of Theorems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141 B.1 Proof of Theorem 5.2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141 B.2 Proof of Theorem 5.3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142 B.3 Proof of Theorem 5.4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142 B.4 Proof About e2[n] Structure in Case II When D Is Even . . . . . . . . . . . . . 144\nxiv Contents\nC Analysis for MASH 2-1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153\nIndex . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157"
        },
        {
            "heading": "Acronyms",
            "text": "AC Alternating Current; also, time-varying BiCMOS Bipolar Complementary Metal Oxide Semiconductor BW BandWidth CP Charge Pump CTFT Continuous-Time Fourier Transform DC Direct Current; also, constant DDSM Digital Delta-Sigma Modulator DSM Delta-Sigma Modulator DTFT Discrete-Time Fourier Transform EFM Error Feedback Modulator FBS Fractional Boundary Spur FF Flip-Flop IBS Integer Boundary Spur LCM Least Common Multiple LFSR Linear Feedback Shift Register LO Local Oscillator LSB Least Significant Bit MASH Multi-stAge noiSe sHaping (Architecture) MMD Multi-Modulus Divider NL Nonlinear; Nonlinearity NTF Noise Transfer Function PCB Printed Circuit Board PD Phase Detector PFD Phase/Frequency Detector PLL Phase-Locked Loop PSD Power Spectral Density PWL PieceWise-Linear RADAR RAdio Detection And Ranging RBW Resolution BandWidth RC Resistor Capacitor RF Radio Frequency\nxv\nxvi Acronyms\nRMS Root Mean Square RNG Random Number Generator SNR Signal-to-Noise Ratio SPI Serial Peripheral Interface STF Signal Transfer Function VCO Voltage-Controlled Oscillator WR Wander Rate WS Wandering Spur XOR Exclusive OR"
        }
    ],
    "title": "Wandering Spurs in MASH-Based Fractional-N Frequency Synthesizers How They Arise and How to Get Rid of Them",
    "year": 2022
}