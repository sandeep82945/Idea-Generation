{
    "abstractText": "Microwave Kinetic Inductance Detectors (MKIDs) are cryogenic photon detectors and are attractive because they permit simultaneous time, energy and spatial resolution of faint astronomical sources. We present a costeffective alternative to dedicated (e.g. analogue) electronics for prototyping readout of single-pixel Optical/NIR MKIDs by repurposing existing and well-known ROACH-1 boards. We also present a pipeline that modernises previously-developed software and data frameworks to allow for extensiblity to new applications and portability to new hardware (e.g. Xilinx ZCU111 or 2x2 RFSoC boards).",
    "authors": [
        {
            "affiliations": [],
            "name": "Oi\u015b\u0131n Creaner"
        },
        {
            "affiliations": [],
            "name": "Colm Bracken"
        },
        {
            "affiliations": [],
            "name": "Jack Piercy"
        },
        {
            "affiliations": [],
            "name": "Gerhard Ulbricht"
        },
        {
            "affiliations": [],
            "name": "Eoin Baldwin"
        },
        {
            "affiliations": [],
            "name": "Mario De Lucia"
        },
        {
            "affiliations": [],
            "name": "Tom Ray"
        }
    ],
    "id": "SP:ef1d404130a63b53c2aef5e05932f3bfb980afcb",
    "references": [
        {
            "authors": [
                "P.K. Day",
                "H.G. LeDuc",
                "B.A. Mazin",
                "A. Vayonakis",
                "J. Zmuidzinas"
            ],
            "title": "A broadband superconducting detector suitable for use in large arrays",
            "venue": "Nature 425(6960), 817\u2013821 (2003).",
            "year": 2003
        },
        {
            "authors": [
                "G. Ulbricht",
                "M. De Lucia",
                "E. Baldwin"
            ],
            "title": "Applications for microwave kinetic induction detectors in advanced instrumentation",
            "venue": "Applied Sciences 11, 2671 (Mar 2021).",
            "year": 2021
        },
        {
            "authors": [
                "M.J. Strader"
            ],
            "title": "Digitial readout for microwave kinetic inductance detectors and applications in high time resolution astronomy",
            "venue": "PhD thesis,",
            "year": 2016
        },
        {
            "authors": [
                "N. Fruitwala",
                "P. Strader",
                "G. Cancelo",
                "T. Zmuda",
                "K. Treptow",
                "N. Wilcer",
                "C. Stoughton",
                "A.B. Walter",
                "N. Zobrist",
                "G Collura"
            ],
            "title": "Second generation readout for large format photon counting microwave kinetic inductance detectors",
            "venue": "Review of Scientific Instruments 91(12), 124705 (2020).",
            "year": 2020
        },
        {
            "authors": [
                "P.J. de Visser",
                "S.A.H. de Rooij",
                "V. Murugesan",
                "D.J. Thoen",
                "J.J.A. Baselmans"
            ],
            "title": "Phonon-trapping enhanced energy resolution in superconducting single photon detectors",
            "venue": "(2021).",
            "year": 2021
        },
        {
            "authors": [
                "E. Baldwin",
                "M. De Lucia",
                "C. Bracken",
                "G. Ulbricht",
                "T. Ray"
            ],
            "title": "Frequency domain multiplexing with the Xilinx ZCU111 RFSoC board",
            "venue": "[X-Ray, Optical, and Infrared Detectors for Astronomy IX ], 11454, 114542Q, SPIE (2020).",
            "year": 2020
        },
        {
            "authors": [
                "K. Dibert",
                "P. Barry",
                "Z. Pan",
                "A. Anderson",
                "B. Benson",
                "C. Chang",
                "K. Karkare",
                "J. Li",
                "T. Natoli",
                "M Rouble"
            ],
            "title": "Development of MKIDs for measurement of the cosmic microwave background with the south pole telescope",
            "venue": "Journal of Low Temperature Physics , 1\u20139 (2022).",
            "year": 2022
        },
        {
            "authors": [
                "E. Baldwin",
                "M. De Lucia",
                "C. Bracken",
                "G. Ulbricht",
                "O. Creaner",
                "J.D. Piercy",
                "T. Ray"
            ],
            "title": "Frequency domain multiplexing for MKIDs: Comparing the xilinx ZCU111 RFSoC with their new 2x2 RFSoC board",
            "venue": "[19 International Workshop on Low Temperature Detectors ], JLTP (2021).",
            "year": 2021
        },
        {
            "authors": [
                "E. Baldwin"
            ],
            "title": "Developing a Next Generation Readout System for Microwave Kinetic Inductance Detectors",
            "venue": "PhD thesis,",
            "year": 2022
        },
        {
            "authors": [
                "M. De Lucia"
            ],
            "title": "Modelling, development and characterisation of Microwave Kinetic Inductance Detectors for optical astronomy",
            "venue": "PhD thesis,",
            "year": 2022
        },
        {
            "authors": [
                "G. Ulbricht",
                "M. De Lucia",
                "E. Baldwin",
                "J.D. Piercy",
                "O. Creaner",
                "C. Bracken",
                "T. Ray"
            ],
            "title": "Performance of photon counting, optical to near-IR Microwave Kinetic Inductance Detectors utilizing proximity effects in Ti/TiN multilayers",
            "venue": "[Astronomical Telescopes and Instrumentation ], SPIE (2022).",
            "year": 2022
        },
        {
            "authors": [
                "M. De Lucia",
                "E. Baldwin",
                "G. Ulbricht",
                "J.D. Piercy",
                "O. Creaner",
                "C. Bracken",
                "T. Ray"
            ],
            "title": "Highly uniform superconducting Titanium Nitride \u2013 Titanium multilayers for MKIDs arrays for astronomical applications",
            "venue": "[Astronomical Telescopes and Instrumentation ], SPIE (2022).",
            "year": 2022
        },
        {
            "authors": [
                "J. Hickish",
                "Z. Abdurashidova",
                "Z. Ali",
                "K. Buch",
                "S. Chaudhari",
                "H. Chen",
                "M. Dexter",
                "R. Simone Domagalski",
                "J. Ford",
                "G. Foster",
                "D. George",
                "J. Greenberg",
                "L. Greenhill",
                "A. Isaacson",
                "H. Jiang",
                "G. Jones",
                "F. Kapp",
                "H. Kriel",
                "R. Lacasse",
                "D. Werthimer"
            ],
            "title": "A decade of developing radio-astronomy instrumentation using CASPER open-source technology",
            "venue": "Journal of Astronomical Instrumentation 05 (11 2016).",
            "year": 2016
        },
        {
            "authors": [
                "M.R. Vissers",
                "J. Gao",
                "M. Sandberg",
                "S.M. Duff",
                "D.S. Wisbey",
                "K.D. Irwin",
                "D.P. Pappas"
            ],
            "title": "Proximity-coupled Ti/TiN multilayers for use in kinetic inductance detectors",
            "venue": "Applied Physics Letters 102(23), 232603 (2013).",
            "year": 2013
        },
        {
            "authors": [
                "B.A. Mazin",
                "S.R. Meeker",
                "M.J. Strader",
                "P. Szypryt",
                "D. Marsden",
                "J.C. van Eyken",
                "G.E. Duggan",
                "A.B. Walter",
                "G. Ulbricht",
                "M. Johnson",
                "B. Bumble",
                "K. O\u2019Brien",
                "C. Stoughton"
            ],
            "title": "ARCONS: A 2024 pixel optical through near-IR cryogenic imaging spectrophotometer",
            "venue": "Publications of the Astronomical Society of the Pacific 125, 1348\u20131361 (nov 2013).",
            "year": 2013
        },
        {
            "authors": [
                "M. Strader",
                "C. Stoughton",
                "Neelay",
                "S. Meeker",
                "R. Dodkins",
                "B. Mazin"
            ],
            "title": "Firmware and software to control the SDR readout.",
            "venue": "https://github.com/bmazin/SDR",
            "year": 2012
        },
        {
            "authors": [
                "G. Ulbricht",
                "B.A. Mazin",
                "P. Szypryt",
                "A.B. Walter",
                "C. Bockstiegel",
                "B. Bumble"
            ],
            "title": "Highly multiplexible thermal kinetic inductance detectors for x-ray imaging spectroscopy",
            "venue": "Applied Physics Letters 106(25), 251103 (2015).",
            "year": 2015
        },
        {
            "authors": [
                "D Stern"
            ],
            "title": "IDL (interactive data language)",
            "venue": "(1977).",
            "year": 1977
        },
        {
            "authors": [
                "G Van Rossum"
            ],
            "title": "Python programming language",
            "venue": "[USENIX annual technical conference ], 41, 36 (2007).",
            "year": 2007
        },
        {
            "authors": [
                "D. Crockford"
            ],
            "title": "The application/json media type for javascript object notation (json)",
            "venue": "(2006).",
            "year": 2006
        },
        {
            "authors": [
                "O. Creaner",
                "E. Baldwin",
                "C. Bracken",
                "M. De Lucia",
                "G. Ulbricht",
                "J. Piercy",
                "T. Ray"
            ],
            "title": "MKIDSSDR.\u201d https://github.com/creanero/MKIDS SDR a fork of https://github.com/bmazin/SDR (2021)",
            "year": 2021
        },
        {
            "authors": [
                "O. Creaner",
                "E. Baldwin",
                "C. Bracken",
                "M. De Lucia",
                "G. Ulbricht",
                "J. Piercy",
                "T. Ray"
            ],
            "title": "IDL KIDs analysis translation project.",
            "venue": "GERHARD",
            "year": 2021
        },
        {
            "authors": [
                "J. Manley",
                "P. Prozesky",
                "A. Martens",
                "R. van Rooyen",
                "W. New"
            ],
            "title": "Interfaces to CASPER correlators.",
            "venue": "https://pypi.org/project/corr/",
            "year": 2011
        },
        {
            "authors": [
                "J.D. Hunter"
            ],
            "title": "Matplotlib: A 2d graphics environment",
            "venue": "Computing in Science & Engineering 9(3), 90\u201395 (2007).",
            "year": 2007
        },
        {
            "authors": [
                "Riverbank Computing"
            ],
            "title": "PyQT4",
            "venue": "(1998).",
            "year": 1998
        },
        {
            "authors": [
                "C.R. Harris",
                "K.J. Millman",
                "S.J. van der Walt",
                "R. Gommers",
                "P. Virtanen",
                "D. Cournapeau",
                "E. Wieser",
                "J. Taylor",
                "S. Berg",
                "N.J. Smith",
                "R. Kern",
                "M. Picus",
                "S. Hoyer",
                "M.H. van Kerkwijk",
                "M. Brett",
                "A. Haldane",
                "J.F. del \u0154\u0131o",
                "M. Wiebe",
                "P. Peterson",
                "P. G\u00e9rard-Marchant",
                "K. Sheppard",
                "T. Reddy",
                "W. Weckesser",
                "H. Abbasi",
                "C. Gohlke",
                "T.E. Oliphant"
            ],
            "title": "Array programming with NumPy",
            "venue": "Nature 585, 357\u2013362 (Sept. 2020).",
            "year": 2020
        },
        {
            "authors": [
                "Wes McKinney"
            ],
            "title": "Data Structures for Statistical Computing in Python",
            "venue": "[Proceedings of the 9th Python in Science Conference ], St\u00e9fan van der Walt and Jarrod Millman, eds., 56 \u2013 61 (2010).",
            "year": 2010
        }
    ],
    "sections": [
        {
            "text": "Keywords: MKIDs, ROACH, Prototyping, Readout, Software"
        },
        {
            "heading": "1. INTRODUCTION",
            "text": "Microwave Kinetic Inductance Detectors (MKIDs) are cryogenic photon detectors which consist of superconducting LC resonators and which operate by the kinetic inductance effect.1 They are read by observing changes in the frequency of this resonance.1,2 This change is proportional to the energy of the incident photon.1\nThey are thus attractive to astronomers2 because they permit simultaneous temporal resolution and energy resolution. Time resolution for MKIDs are typically of the order of 1-2\u00b5s.3,4 Energy resolution of up to E\u2206E \u2248 55 5 has been achieved. Additionally, by creating an array of MKIDs each with slightly different resonant frequencies, multiple MKIDs can be readout on the same feedline through frequency-domain multiplexing.6\u20138\nWe present a report on an aspect of ongoing project9,10 to develop and test new MKID designs as described elsewhere in these proceedings by Ref. 11, 12. This paper describes the work undertaken to modernise and streamline the software and firmware system for the Re-configurable Open Access Computer Hardware (ROACH1)13,14 board shown in Figure 1 used to iteratively test prototype MKIDs.\nOur challenge is to identify continued uses that can be made of existing equipment such as the ROACH-1. This will allow us to address constraints such as budgetary and human limitations, and careful design will allow the lessons learned here to be expanded to future implementations (e.g. in arrays.) On the other hand that these uses do not negatively impact future expansions by imposing design constraints on systems which will be reused and expanded."
        },
        {
            "heading": "2. PURPOSE",
            "text": "Our research focuses on the development of single MKID pixels in prototype arrays like the one shown in Figure 2 for prototyping various design parameters and fabrication procedures.11,12 For example, by varying the relative thickness of TiN/Ti/TiN multilayers, it is possible to select a critical temperature intermediate between that of Ti and TiN.12,15 Varying fabrication techniques can also lead to differences in noise characteristics or other important parameters.11 Therefore it is essential that a system that permits rapid testing be developed to allow these parameters to be varied in an iterative development process.\nFurther author information: (Send correspondence to O.C.) E-mail: creanero@cp.dias.ie, creanero@gmail.com\nar X\niv :2\n30 1.\n06 89\n3v 1\n[ as\ntr o-\nph .I\nM ]\n1 7\nJa n\n20 23\nIn this context, the multiplexing capabilities of MKIDs are not necessary to exploit at this stage. Therefore the difference in readout capacity between the venerable ROACH-1 board, which can be expected to support the readout of \u223c256 MKIDs,16 and later models such as the ZCU111 (\u223c4000) or RFSoC 2x2 (\u223c2000)8 is irrelevant for our purposes.\nBecause the firmware for these boards shares the Collaboration for Astronomy Signal Processing and Electronics Research (CASPER) approach of using Simulink blocks which carry out high-level functions and abstract the low-level functions from the developer,17 workflows developed for the older equipment should be relatively easy to convert to the newer systems at a later date.\nExisting software, developed from an earlier version by Ref. 18, sets up the readout of a single MKID pixel measurement by defining resonant frequency, resonator drive power and IQ loop center. It does this by providing an interface that allows the user to:\n\u2022 Perform a frequency sweep around an user-defined frequency (i.e. the predicted resonant frequency) to obtain these required parameters\n\u2022 Adjust the ADC input attenuation to make use of the full ADC dynamic range\n\u2022 Monitor a single MKID pixel\u2019s 2-dimensional IQ signal with a 1 MHz sampling rate\n\u2022 Calculate a 1-dimensional phase signal from the IQ value and trigger on it\n\u2022 Save a defined number of measurements to disk each time the trigger was reached"
        },
        {
            "heading": "2.1 CHALLENGE",
            "text": "Within the overall scope of this project, this paper addresses a specific challenge. The efficient development of streamlined software to allow the ROACH-1 board to continue to be used for prototype testing in the face of a number of practical constraints.\nThe readout software for this project was forked from Ref. 18 at an early stage, and heavily adapted for our purposes. It consists of a series of shell scripts to configure the hardware environment and python scripts that interface with this environment and allow for the programming of the board. Developed originally for the ARCONS instrument,16 it includes features which are irrelevant for our prototyping purpose, such as multichannel controls. In addition, some of the terms of art associated with ARCONS may not be obvious to a new user. Finally, because the code was forked and then heavily adapted, it is not possible to benefit from ongoing updates to the original work. Our recent effort has been to refactor this code to streamline it for our purposes and relieve some of the technical debt that has built up.\nBecause our work focuses on the prototyping aspect of MKIDs, we have frequent need to carry out postobservation analysis of our data. For example, when identifying noise characteristics of the data,11 there is need for post-processing. An existing code base for this process was available from Ref. 19, which was originally developed for X-ray imaging KIDs, but which could be readily adapted to our project. This software was written in IDL (Interactive Data Language),20 which is a proprietary language that requires expensive licences to compile. Additionally, the input and output data formats for this software are rigid binary data structures which are designed to be storage-efficient for their original purposes, but limit the scope of their extensiblity and which require bespoke reading and writing code. For these reasons, it was decided to convert this software to Python21 and the data formats to JavaScript Object Notation (JSON) format.22"
        },
        {
            "heading": "2.2 HUMAN FACTOR",
            "text": "In an academic environment such as is the case with our project, one must account for periodic changes in team composition. Ideally, this requires a streamlined onboarding process and avoidance of \u201cSingle point of failure\u201d team members: i.e. individuals who are the only one familiar with certain laboratory procedures.\nTo mitigate these factors, it is essential that good documentation be developed alongside software systems. These documents take two main forms: User-level documentation which describes what needs to be done to use the system, and Developer-level documentation which describes the software itself, and which is essential to understand how the software operates, which is essential for maintenance and future development.\nIn addition, introduction of new users to the group is simplified by the development of a streamlined front-end which is easily understood and which has design affordances which guide the user towards the intended use."
        },
        {
            "heading": "3. DESIGN APPROACH",
            "text": "In the refactoring and translation of the existing code base, the approach was to focus on five key factors: Usability, Transparency, Portability, Extensiblity and Modularity.\nUsability has been emphasised by identifying actions and interactions that the users need, and simplifying how to access them. Reasonable default values have been set for rarely changed settings, and interdependent variables where the user may wish to vary either term to produce an effect on the other have been presented as linked variables on the front-end. Procedural steps where the user was previously required to edit the code have been reconfigured to be available as part of the front end and their purposes clearly marked.\nTransparency has been improved by ensuring that the units for all variables are clearly displayed with standard SI prefixes. Terms-of-art specific to the original use-case of the software have been replaced with terms which can be more readily understood by the current users. Space-efficient binary data formats which require bespoke read-write operations have been replaced with human-readable data formats which lend themselves well to modern data analytics techniques.\nPortability was included in the design where possible by migrating to more modern and open-source languages, versions and platforms. This approach extended to both software and data aspects of the project.\nExtensiblity was maintained by use of the \u201cfor-but-not-with\u201d approach: for example while the current application does not require multiplexible readout for multiple MKIDs, we have retained the capacity for multichannel readout by storing the data as iterable collections such as lists. In the prototyping stage, these collections will typically be of size 1, while in later applications these collections can be made larger without necessitating any code changes.\nModularity has been worked into the existing codebase where possible to allow updates and maintenance to take place without extensive rewriting. Additionally, modular data design enabled by the migration to .json format instead of fixed-format binary data allows for new information to be recorded in the same format without interrupting older functionality.\nCode changes have taken place in an iterative development process. A short cycle of design-develop-test allows for improvements to be made without impacting the physical testing processes the software is intended to support. Where possible, isolated unit tests precede integration testing of new elements of the system. Once the developer has tested the system, hands-on user testing is carried out to ensure that the needs of the users have been met adequately. Other factors which have been considered include adding error-checking and graceful failure states to the system to prevent unexpected behaviour or crashes. By following these design approaches, the system is more able to tolerate changes in team composition."
        },
        {
            "heading": "4. PROGRESS",
            "text": "This paper presents a work-in-progress. Thus far we have made significant progress on streamlining the front-end user experience of the readout software. Additional back-end changes have been made to modularise the software system and smooth out the workflow and dataflow. We have also implemented changes in the data format for output from the readout software for the ROACH board and input to the analysis package. Finally, we have begun a progress to translate the existing post observation analysis software from IDL to Python.\nThe changes to the front end have emphasised usability and readability, and an illustrative example is shown in Figure 3. A default value for the ROACH board IP address used in our project was added, and no longer must be specified at run time, though the user can still specify a different value at runtime. Because we use a single MKID, and thus a single frequency is needed, the input for frequency has been changed to a specially developed SI SpinBox module. This constrains input to numeric values that can include decimal, floating point or SI prefix notations. This module can be seamlessly replaced with an existing input module for a list of frequencies if array readout is needed. In prototype testing, it is necessary to offset the Local Oscillator (LO) frequency from the resonant frequency by a user-defined amount. Where previously this was set directly by the user, either the offset value or the LO frequency can be set directly through a set of linked SpinBoxes, with either adjusting the other appropriately. Similarly, when it is necessary to sweep the LO through a series of frequencies for testing, the user can specify the full span of the sweep, the step-size or the number of steps through a set of linked SpinBoxes.\nThe labels of all of the numerical variables have been adjusted to include their units with appropriate SI prefixes. The back-end of this software has been streamlined in a number of ways, including by removing of unnecessary write-to-disc steps, connecting scripts which necessarily depend on one another and correcting calls which write to the board and wait for a response to do so in the correct order. The software is available from Ref. 23.\nWe have developed a new data format using the JSON notation22 as illustrated in Figure 4. This structure stores information about the experimental setup in a header, and then a series of headers for each result of this observation in a nested structure of keyword:value pairs. The example shown in Figure 4 shows the structure for storing the results of a series of measurements of pulses in I/Q space which are observed when a photon strikes the MKID under observation. Each pulse can be examined separately or the data aggregated as needed in the analytic software. This structure allows for extensibility, as additional information such as frequency inputs during a frequency sweep or timestamp values can be included in this structure. The analysis system can later open the file and extract the data into a Python dictionary which the user can further analyse.\nTranslation work has begun to redevelop the analysis software from Ref. 19 into a suitable Python package. The challenges in this phase of the project have included\n\u2022 Replacement of the existing data structures with more flexible Python equivalents\n\u2022 Identifying corresponding Python libraries for the IDL analysis procedures\n\u2022 Interpreting the relations between data in large functions, especially given IDL\u2019s singular namespace\nThese have been addressed by close consultation with the original developers and an iterative development process which allows for testing of the new version in stages. The code for this software is available from Ref. 24"
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "This project has received funding under Science Foundation Ireland Grant number 15/IA/2880.\nThis project makes use of Python libraries Corr,25 Matplotlib,26 PyQt4,27 Numpy28 and Pandas.29,30\nSamples shown in Figure 2 and used for testing the presented firmware have been fabricated by the Process & Product Development team at Tyndall National Institute, Cork, Ireland."
        }
    ],
    "title": "Repurposing ROACH-1 boards for prototyping of readout systems for optical-NIR MKIDs",
    "year": 2023
}