{
    "abstractText": "In the IoT-based economy, a large number of subjects (companies, public bodies, or private citizens) are willing to buy data or services offered by subjects that provide, operate, or host IoT devices. To support economic transactions in this setting, and to pave the way for the implementation of decentralized algorithmic governance powered by smart contracts, the adoption of the blockchain has been proposed both in scientific literature and in actual projects. The blockchain technology promises a decentralized payment system independent of (and possibly cheaper than) conventional electronic payment systems. However, there are a number of aspects that need to be considered for an effective IoT\u2013blockchain integration. In this review paper, we start from a number of real IoT projects and applications that (may) take advantage of blockchain technology to support economic transactions. We provide a reasoned review of several architectural choices in light of typical requirements of those applications and discuss their impact on transaction throughput, latency, costs, limits on ecosystem growth, and so on. We also provide a survey of additional financial tools that a blockchain can potentially bring to an IoT ecosystem, with their architectural impact. In the end, we observe that there are very few examples of IoT projects that fully exploit the potential of the blockchain. We conclude with a discussion of open problems and future research directions to make blockchain adoption easier and more effective for supporting an IoT economy.",
    "authors": [
        {
            "affiliations": [],
            "name": "Diego Pennino"
        },
        {
            "affiliations": [],
            "name": "Marco Zecchini"
        }
    ],
    "id": "SP:5913edae949c9bbeed377327434dc1797dc9b0cf",
    "references": [
        {
            "authors": [
                "M.M. Rathore",
                "A. Paul",
                "W.H. Hong",
                "H. Seo",
                "I. Awan",
                "S. Saeed"
            ],
            "title": "Exploiting IoT and big data analytics: Defining Smart Digital City using real-time urban data. Sustain",
            "venue": "Cities Soc",
            "year": 2018
        },
        {
            "authors": [
                "M. Compare",
                "P. Baraldi",
                "E. Zio"
            ],
            "title": "Challenges to IoT-Enabled Predictive Maintenance for Industry 4.0",
            "venue": "IEEE Internet Things J. 2020,",
            "year": 2020
        },
        {
            "authors": [
                "E. Borelli",
                "G. Paolini",
                "F. Antoniazzi",
                "M. Barbiroli",
                "F. Benassi",
                "F. Chesani",
                "L. Chiari",
                "M. Fantini",
                "F. Fuschini",
                "A Galassi"
            ],
            "title": "HABITAT: An IoT Solution for Independent Elderly",
            "venue": "Sensors",
            "year": 2019
        },
        {
            "authors": [
                "D. Gupta",
                "S. Bhatt",
                "M. Gupta",
                "A.S. Tosun"
            ],
            "title": "Future Smart Connected Communities to Fight COVID-19 Outbreak",
            "venue": "Internet Things 2021,",
            "year": 2021
        },
        {
            "authors": [
                "S. Huckle",
                "R. Bhattacharya",
                "M. White",
                "N. Beloff"
            ],
            "title": "Internet of Things, Blockchain and Shared Economy Applications",
            "venue": "Procedia Comput. Sci",
            "year": 2016
        },
        {
            "authors": [
                "L. Tan"
            ],
            "title": "Token Economics Framework; SSRN Scholarly Paper ID 3381452; Social Science Research Network: Rochester, NY, USA, 2019",
            "year": 2019
        },
        {
            "authors": [
                "G. Ishmaev"
            ],
            "title": "The Ethical Limits of Blockchain-Enabled Markets for Private IoT Data",
            "venue": "Philos. Technol",
            "year": 2020
        },
        {
            "authors": [
                "S. Mercan",
                "A. Kurt",
                "E. Erdin",
                "K. Akkaya"
            ],
            "title": "Cryptocurrency Solutions to Enable Micro-payments in Consumer IoT",
            "venue": "IEEE Consum. Electron. Mag",
            "year": 2021
        },
        {
            "authors": [
                "J. Robert",
                "S. Kubler",
                "S. Ghatpande"
            ],
            "title": "Enhanced Lightning Network (off-chain)-based micropayment in IoT ecosystems",
            "venue": "Future Gener. Comput. Syst",
            "year": 2020
        },
        {
            "authors": [
                "A. Ensor",
                "S. Schefer-Wenzl",
                "I. Miladinovic"
            ],
            "title": "Blockchains for IoT payments: A survey",
            "venue": "In Proceedings of the 2018 IEEE Globecom Workshops (GC Wkshps), Abu Dhabi, United Arab Emirates,",
            "year": 2018
        },
        {
            "authors": [
                "D. Strugar",
                "R. Hussain",
                "M. Mazzara",
                "V. Rivera",
                "J. Young Lee",
                "R. Mustafin"
            ],
            "title": "On M2M micropayments: A case study of electric autonomous vehicles",
            "venue": "In Proceedings of the 2018 IEEE International Conference on Internet of Things (iThings) and IEEE Green J. Sens. Actuator Netw. 2022,",
            "year": 2018
        },
        {
            "authors": [
                "T. Lundqvist",
                "A. de Blanche",
                "H.R.H. Andersson"
            ],
            "title": "Thing-to-thing electricity micro payments using blockchain technology",
            "venue": "In Proceedings of the 2017 Global Internet of Things Summit (GIoTS), Geneva, Switzerland,",
            "year": 2017
        },
        {
            "authors": [
                "C. Burchert",
                "C. Decker",
                "R. Wattenhofer"
            ],
            "title": "Scalable funding of Bitcoin micropayment channel networks",
            "venue": "R. Soc. Open Sci. 2018,",
            "year": 2018
        },
        {
            "authors": [
                "A. Panarello",
                "N. Tapas",
                "G. Merlino",
                "F. Longo",
                "A. Puliafito"
            ],
            "title": "Blockchain and iot integration: A systematic survey",
            "venue": "Sensors 2018,",
            "year": 2018
        },
        {
            "authors": [
                "H.N. Dai",
                "Z. Zheng",
                "Y. Zhang"
            ],
            "title": "Blockchain for Internet of Things: A Survey",
            "venue": "IEEE Internet Things J. 2019,",
            "year": 2019
        },
        {
            "authors": [
                "L. Atzori",
                "A. Iera",
                "G. Morabito"
            ],
            "title": "The Internet of Things: A survey",
            "venue": "Comput. Netw",
            "year": 2010
        },
        {
            "authors": [
                "O. Salman",
                "I. Elhajj",
                "A. Chehab",
                "A. Kayssi"
            ],
            "title": "IoT survey: An SDN and fog computing perspective",
            "venue": "Comput. Netw",
            "year": 2018
        },
        {
            "authors": [
                "G. Beniwal",
                "A. Singhrova"
            ],
            "title": "A systematic literature review on IoT gateways",
            "venue": "J. King Saud Univ. Comput. Inf. Sci. 2021,",
            "year": 2021
        },
        {
            "authors": [
                "C. Bormann",
                "M. Ersue",
                "A. Ker\u00e4nen"
            ],
            "title": "Terminology for Constrained-Node Networks; RFC 7228; Internet Engineering Task Force (IETF)",
            "year": 2014
        },
        {
            "authors": [
                "B. Prince",
                "D. Prince"
            ],
            "title": "Embedded Flash and EEPROM for Smart IoT",
            "year": 2018
        },
        {
            "authors": [
                "J. Tosi",
                "F. Taffoni",
                "M. Santacatterina",
                "R. Sannino",
                "D. Formica"
            ],
            "title": "Performance Evaluation of Bluetooth Low Energy: A Systematic Review",
            "venue": "Sensors 2017,",
            "year": 2017
        },
        {
            "authors": [
                "S. Farahani"
            ],
            "title": "Chapter 2\u2014ZigBee/IEEE 802.15.4 networking examples. In ZigBee Wireless Networks and Transceivers; Elsevier: Amsterdam",
            "venue": "The Netherlands,",
            "year": 2008
        },
        {
            "authors": [
                "F. Adelantado",
                "X. Vilajosana",
                "P. Tuset-Peiro",
                "B. Martinez",
                "J. Melia-Segui",
                "T. Watteyne"
            ],
            "title": "Understanding the Limits of LoRaWAN",
            "venue": "IEEE Commun. Mag",
            "year": 2017
        },
        {
            "authors": [
                "A. Yousefpour",
                "C. Fung",
                "T. Nguyen",
                "K. Kadiyala",
                "F. Jalali",
                "A. Niakanlahiji",
                "J. Kong",
                "J.P. Jue"
            ],
            "title": "All one needs to know about fog computing and related edge computing paradigms: A complete survey",
            "venue": "J. Syst. Archit",
            "year": 2019
        },
        {
            "authors": [
                "C. Antal",
                "T. Cioara",
                "I. Anghel",
                "M. Antal",
                "I. Salomie"
            ],
            "title": "Distributed ledger technology review and decentralized applications development guidelines",
            "venue": "Future Internet",
            "year": 2021
        },
        {
            "authors": [
                "W. Wang",
                "D.T. Hoang",
                "P. Hu",
                "Z. Xiong",
                "D. Niyato",
                "P. Wang",
                "Y. Wen",
                "D.I. Kim"
            ],
            "title": "A survey on consensus mechanisms and mining strategy management in blockchain networks",
            "venue": "IEEE Access 2019,",
            "year": 2019
        },
        {
            "authors": [
                "H. Xiong",
                "M. Chen",
                "C. Wu",
                "Y. Zhao",
                "W. Yi"
            ],
            "title": "Research on Progress of Blockchain Consensus Algorithm: A Review on Recent Progress of Blockchain Consensus Algorithms",
            "venue": "Future Inter",
            "year": 2022
        },
        {
            "authors": [
                "M.S. Ferdous",
                "M.J.M. Chowdhury",
                "M.A. Hoque"
            ],
            "title": "A survey of consensus algorithms in public blockchain systems for cryptocurrencies",
            "venue": "J. Netw. Comput. Appl",
            "year": 2021
        },
        {
            "authors": [
                "R. Tamassia"
            ],
            "title": "Authenticated data structures",
            "venue": "Algorithms\u2014ESA",
            "year": 2003
        },
        {
            "authors": [
                "D. Pennino",
                "M. Pizzonia",
                "A. Papi"
            ],
            "title": "Overlay indexes: Efficiently supporting aggregate range queries and authenticated data structures in off-the-shelf databases",
            "venue": "IEEE Access 2019,",
            "year": 2019
        },
        {
            "authors": [
                "D. Pennino",
                "M. Pizzonia",
                "F. Griscioli"
            ],
            "title": "Pipeline-integrity: Scaling the use of authenticated data structures up to the cloud",
            "venue": "Future Gener. Comput. Syst",
            "year": 2019
        },
        {
            "authors": [
                "M. Bernardini",
                "D. Pennino",
                "M. Pizzonia"
            ],
            "title": "Blockchains meet distributed hash tables: Decoupling validation from state storage",
            "venue": "In Proceedings of the Second Distributed Ledger Technology Workshop,",
            "year": 2019
        },
        {
            "authors": [
                "D. Leung",
                "A. Suhl",
                "Y. Gilad",
                "N. Zeldovich"
            ],
            "title": "Vault: Fast bootstrapping for the Algorand Cryptocurrency",
            "venue": "In Proceedings of the Network and Distributed Systems Security (NDSS) Symposium",
            "year": 2019
        },
        {
            "authors": [
                "G. Wood"
            ],
            "title": "Ethereum: A secure decentralised generalised transaction ledger",
            "venue": "Ethereum Proj. Yellow Pap. 2014,",
            "year": 2014
        },
        {
            "authors": [
                "H. Al-Breiki",
                "M.H.U. Rehman",
                "K. Salah",
                "D. Svetinovic"
            ],
            "title": "Trustworthy blockchain oracles: review, comparison, and open research challenges",
            "venue": "IEEE Access 2020,",
            "year": 2020
        },
        {
            "authors": [
                "S. Popov"
            ],
            "title": "The Tangle White Paper. 2018",
            "venue": "Available online: http://www.descryptions.com/Iota.pdf (accessed on",
            "year": 2022
        },
        {
            "authors": [
                "Churyumov",
                "A. Byteball"
            ],
            "title": "A decentralized system for storage and transfer of value",
            "venue": "Available online: https://byteball.org/ Byteball.pdf",
            "year": 2022
        },
        {
            "authors": [
                "E. Zhang"
            ],
            "title": "NEP-17 Token Standard. Available online: https://github.com/neo-project/proposals/blob/master/nep-17 .mediawiki (accessed on 18 January 2022)",
            "year": 2022
        },
        {
            "authors": [
                "M. Dotan",
                "Y.A. Pignolet",
                "S. Schmid",
                "S. Tochner",
                "A. Zohar"
            ],
            "title": "Survey on blockchain networking: Context, state-of-the-art, challenges",
            "venue": "ACM Comput. Surv",
            "year": 2021
        },
        {
            "authors": [
                "B.K. Mohanta",
                "D. Jena",
                "S.S. Panda",
                "S. Sobhanayak"
            ],
            "title": "Blockchain technology: A survey on applications and security privacy Challenges",
            "venue": "Internet Things 2019,",
            "year": 2019
        },
        {
            "authors": [
                "A. Cirillo",
                "V. Dalena",
                "A. Mauro",
                "F. Mogavero",
                "D. Pennino",
                "M. Pizzonia",
                "A. Vitaletti",
                "M. Zecchini"
            ],
            "title": "Empowering citizens by a blockchain-Based Robinson list",
            "venue": "Int. J. Comput. Appl",
            "year": 2021
        },
        {
            "authors": [
                "G.D. Monte",
                "D. Pennino",
                "M. Pizzonia"
            ],
            "title": "Scaling blockchains without giving up decentralization and security: a solution to the blockchain scalability trilemma",
            "venue": "In Proceedings of the 3rd Workshop on Cryptocurrencies and Blockchains for Distributed Systems, London, UK,",
            "year": 2020
        },
        {
            "authors": [
                "G. Yu",
                "X. Wang",
                "K. Yu",
                "W. Ni",
                "J.A. Zhang",
                "R.P. Liu"
            ],
            "title": "Survey: Sharding in blockchains",
            "venue": "IEEE Access 2020,",
            "year": 2020
        },
        {
            "authors": [
                "J. Chen",
                "S. Micali"
            ],
            "title": "Algorand: A secure and efficient distributed ledger",
            "venue": "Theor. Comput. Sci",
            "year": 2019
        },
        {
            "authors": [
                "C. Sguanci",
                "R. Spatafora",
                "A.M. Vergani"
            ],
            "title": "Layer 2 blockchain scaling: A survey",
            "venue": "arXiv 2021,",
            "year": 2021
        },
        {
            "authors": [
                "J. Poon",
                "T. The Bitcoin Lightning Network Dryja"
            ],
            "title": "Scalable off-Chain Instant Payments",
            "venue": "2016. Available online: https: //www.bitcoinlightning.com/wp-content/uploads/2018/03/lightning-network-paper.pdf",
            "year": 2022
        },
        {
            "authors": [
                "Buterin",
                "V. Zk-SNARKs"
            ],
            "title": "Under the Hood\u2014Vitalik Buterin\u2014Medium",
            "venue": "2018. Available online: https://medium.com/ @VitalikButerin/zk-snarks-under-the-hood-b33151a013f6",
            "year": 2022
        },
        {
            "authors": [
                "M.J. Page",
                "D. Moher",
                "P.M. Bossuyt",
                "I. Boutron",
                "T.C. Hoffmann",
                "C.D. Mulrow",
                "L. Shamseer",
                "J.M. Tetzlaff",
                "E.A. Akl",
                "S.E Brennan"
            ],
            "title": "PRISMA 2020 explanation and elaboration: updated guidance and exemplars for reporting systematic reviews",
            "venue": "BMJ 2021,",
            "year": 2021
        },
        {
            "authors": [
                "A. Haleem",
                "A. Allen",
                "A. Thompson",
                "M. Nijdam",
                "R. Helium Whitepaper Garg"
            ],
            "title": "A Decentralized Wireless Network",
            "venue": "2021. Available online: http://whitepaper.helium.com/",
            "year": 2021
        },
        {
            "authors": [
                "SavePlanetEarth (SPE). Whitepaper"
            ],
            "title": "A Carbon Sequestration Crypto Project",
            "venue": "Available online: https://saveplanetearth.io/SPE_ WhitePaper.pdf",
            "year": 2021
        },
        {
            "authors": [
                "Medicalchain. Whitepaper"
            ],
            "title": "Own Your Health",
            "venue": "Available online: https://medicalchain.com/Medicalchain-Whitepaper-EN.pdf",
            "year": 2021
        },
        {
            "authors": [
                "On the Money"
            ],
            "title": "Earn as You Drive with Jaguar Land Rover",
            "venue": "2019. Available online: https://www.jaguarlandrover.com/news/20 19/04/money-earn-you-drive-jaguar-land-rover",
            "year": 2021
        },
        {
            "authors": [
                "V. Vala\u0161t\u00edn",
                "K. Ko\u0161t\u2019\u00e1l",
                "R. Bencel",
                "I. Kotuliak"
            ],
            "title": "Blockchain based car-sharing platform",
            "venue": "In Proceedings of the 2019 International Symposium ELMAR, Zadar, Croatia,",
            "year": 2019
        },
        {
            "authors": [
                "Q. Zhou",
                "Z. Yang",
                "K. Zhang",
                "K. Zheng",
                "J. Liu"
            ],
            "title": "A decentralized car-sharing control scheme based on smart contract in internet-of-vehicles",
            "venue": "In Proceedings of the 2020 IEEE 91st Vehicular Technology Conference (VTC2020-Spring), Antwerp, Belgium,",
            "year": 2020
        },
        {
            "authors": [
                "M. Rahman",
                "M. Rashid",
                "M. Shamim Hossain",
                "E. Hassanain",
                "M. Alhamid",
                "M. Guizani"
            ],
            "title": "Blockchain and IoT-Based Cognitive Edge Framework for Sharing Economy Services in a Smart City",
            "venue": "IEEE Access 2019,",
            "year": 2019
        },
        {
            "authors": [
                "P. Fraga-Lamas",
                "T. Fern\u00e1ndez-Caram\u00e9s"
            ],
            "title": "A Review on Blockchain Technologies for an Advanced and Cyber-Resilient Automotive Industry",
            "venue": "IEEE Access 2019,",
            "year": 2019
        },
        {
            "authors": [
                "B. Esmaeilian",
                "J. Sarkis",
                "K. Lewis",
                "S. Behdad"
            ],
            "title": "Blockchain for the future of sustainable supply chain management in Industry 4.0",
            "venue": "Resour. Conserv. Recycl",
            "year": 2020
        },
        {
            "authors": [
                "G. Ramachandran",
                "R. Radhakrishnan",
                "B. Krishnamachari"
            ],
            "title": "Towards a decentralized data marketplace for smart cities",
            "venue": "In Proceedings of the 2018 IEEE International Smart Cities Conference (ISC2), Kansas, MO, USA,",
            "year": 2018
        },
        {
            "authors": [
                "Y. Wu",
                "H.N. Dai",
                "H. Wang"
            ],
            "title": "Convergence of Blockchain and Edge Computing for Secure and Scalable IIoT Critical Infrastructures in Industry 4.0",
            "venue": "IEEE Internet Things J. 2021,",
            "year": 2021
        },
        {
            "authors": [
                "W. Lin",
                "X. Huang",
                "H. Fang",
                "V. Wang",
                "Y. Hua",
                "J. Wang",
                "H. Yin",
                "D. Yi",
                "L. Yau"
            ],
            "title": "Blockchain Technology in Current Agricultural Systems: From Techniques to Applications",
            "venue": "IEEE Access 2020,",
            "year": 2020
        },
        {
            "authors": [
                "G. Perboli",
                "A. Manfredi",
                "S. Musso",
                "M. Rosano"
            ],
            "title": "A decentralized marketplace for M2M economy for smart cities",
            "venue": "In Proceedings of the 2019 IEEE 28th International Conference on Enabling Technologies: Infrastructure for Collaborative Enterprises (WETICE), Napoli, Italy,",
            "year": 2019
        },
        {
            "authors": [
                "C. Magrini",
                "J. Nicolas",
                "H. Berg",
                "A. Bellini",
                "E. Paolini",
                "N. Vincenti",
                "L. Campadello",
                "A. Bonoli"
            ],
            "title": "Using internet of things and distributed ledger technology for digital circular economy enablement: The case of electronic equipment",
            "venue": "Sustainability",
            "year": 2021
        },
        {
            "authors": [
                "M. Rahman",
                "G. Loukas",
                "S. Abdullah",
                "A. Abdu",
                "S. Rahman",
                "E. Hassanain",
                "Y. Arafa"
            ],
            "title": "Blockchain and IoT-based secure multimedia retrieval system for a massive crowd: Sharing economy perspective",
            "venue": "In Proceedings of the 2019 on International Conference on Multimedia Retrieval, Ottawa, ON, Canada,",
            "year": 2019
        },
        {
            "authors": [
                "M. Themistocleous",
                "K. Stefanou",
                "E. Iosif"
            ],
            "title": "Blockchain in solar energy",
            "venue": "Cyprus Rev. 2018,",
            "year": 2018
        },
        {
            "authors": [
                "L. Henesey",
                "Y. Lizneva",
                "R. Philipp",
                "C. Meyer",
                "L. Gerlitz"
            ],
            "title": "Improved load planning of RoRo vessels by adopting blockchain and internet-of-things",
            "venue": "In Proceedings of the 22nd International Conference on Harbor, Maritime & Multimodal Logistics Modelling and Simulation, Athens, Greece,",
            "year": 2020
        },
        {
            "authors": [
                "I.H. Chuang",
                "S.H. Huang",
                "W.C. Chao",
                "J.S. Tsai",
                "Y.H. Kuo"
            ],
            "title": "TIDES: A Trust-Aware IoT Data Economic System with BlockchainEnabled Multi-Access Edge Computing",
            "venue": "IEEE Access 2020,",
            "year": 2020
        },
        {
            "authors": [
                "O. Lamtzidis",
                "J. Gialelis"
            ],
            "title": "An IOTA Based Distributed Sensor Node System",
            "venue": "In Proceedings of the 2018 IEEE Globecom Workshops (GC Wkshps), Abu Dhabi, United Arab Emirates,",
            "year": 2018
        },
        {
            "authors": [
                "M.A. Uddin",
                "A. Stranieri",
                "I. Gondal",
                "V. Balasubramanian"
            ],
            "title": "Continuous patient monitoring with a patient centric agent: A block architecture",
            "venue": "IEEE Access 2018,",
            "year": 2018
        },
        {
            "authors": [
                "H. Hasan",
                "E. AlHadhrami",
                "A. AlDhaheri",
                "K. Salah",
                "R. Jayaraman"
            ],
            "title": "Smart contract-based approach for efficient shipment management",
            "venue": "Comput. Ind. Eng",
            "year": 2019
        },
        {
            "authors": [
                "S. Bajoudah",
                "C. Dong",
                "P. Missier"
            ],
            "title": "Toward a decentralized, trust-less marketplace for brokered IoT data trading using blockchain",
            "venue": "In Proceedings of the 2019 IEEE International Conference on Blockchain (Blockchain), Atlanta, GA, USA,",
            "year": 2019
        },
        {
            "authors": [
                "O. Leiba",
                "Y. Yitzchak",
                "R. Bitton",
                "A. Nadler",
                "A. Shabtai"
            ],
            "title": "Incentivized delivery network of iot software updates based on trustless proof-of-distribution",
            "venue": "In Proceedings of the 2018 IEEE European Symposium on Security and Privacy Workshops (EuroS PW),",
            "year": 2018
        },
        {
            "authors": [
                "S.A. Suchaad",
                "K. Mashiko",
                "N.B. Ismail",
                "M.H.Z. Abidin"
            ],
            "title": "Blockchain use in home automation for children incentives in parental control",
            "venue": "In Proceedings of the 2018 International Conference on Machine Learning and Machine Intelligence, Hanoi, Vietnam,",
            "year": 2018
        },
        {
            "authors": [
                "O. Mahmoud",
                "H. Kopp",
                "A.T. Abdelhamid",
                "F. Kargl"
            ],
            "title": "Applications of smart-contracts: anonymous decentralized insurances with IoT sensors. In Proceedings of the 2018 IEEE International Conference on Internet of Things (iThings) and IEEE Green Computing and Communications (GreenCom) and IEEE Cyber, Physical and Social Computing (CPSCom) and IEEE Smart Data (SmartData)",
            "venue": "Halifax, NS, Canada,",
            "year": 2018
        },
        {
            "authors": [
                "S.B.H. Youssef",
                "S. Rekhis",
                "N. Boudriga"
            ],
            "title": "A blockchain based secure IoT solution for the dam surveillance",
            "venue": "In Proceedings of the 2019 IEEE Wireless Communications and Networking Conference (WCNC), Marrakesh, Morocco,",
            "year": 2019
        },
        {
            "authors": [
                "Y.E. Oktian",
                "S.G. Lee",
                "H.J. Lee"
            ],
            "title": "Hierarchical multi-blockchain architecture for scalable internet of things environment",
            "venue": "Electronics 2020,",
            "year": 2020
        },
        {
            "authors": [
                "S. Umamaheswari",
                "S. Sreeram",
                "N. Kritika",
                "D.J. Prasanth"
            ],
            "title": "Biot: Blockchain based IoT for agriculture",
            "venue": "In Proceedings of the 2019 11th International Conference on Advanced Computing (ICoAC), Chennai, India,",
            "year": 2019
        },
        {
            "authors": [
                "N. Fotiou",
                "V.A. Siris",
                "G.C. Polyzos"
            ],
            "title": "Interacting with the Internet of Things using smart contracts and blockchain technologies",
            "venue": "In Proceedings of the International Conference on Security, Privacy and Anonymity in Computation,",
            "year": 2018
        },
        {
            "authors": [
                "X. Gong",
                "E. Liu",
                "R. Wang"
            ],
            "title": "Blockchain-based IoT application using smart contracts: Case study of M2M autonomous trading",
            "venue": "In Proceedings of the 2020 5th International Conference on Computer and Communication Systems (ICCCS), Shanghai, China,",
            "year": 2020
        },
        {
            "authors": [
                "R. Jabbar",
                "N. Fetais",
                "M. Kharbeche",
                "M. Krichen",
                "K. Barkaoui",
                "M. Shinoy"
            ],
            "title": "Blockchain for the Internet of vehicles: How to use blockchain to secure vehicle-to-everything (V2X) communication and payment",
            "venue": "IEEE Sens. J. 2021,",
            "year": 2021
        },
        {
            "authors": [
                "O. Leiba",
                "R. Bitton",
                "Y. Yitzchak",
                "A. Nadler",
                "D. Kashi",
                "A. Shabtai"
            ],
            "title": "IoTPatchPool: Incentivized delivery network of IoT software updates based on proofs-of-distribution",
            "venue": "Pervasive Mob. Comput",
            "year": 2019
        },
        {
            "authors": [
                "N. Weerasinghe",
                "T. Hewa",
                "M. Liyanage",
                "S.S. Kanhere",
                "M. Ylianttila"
            ],
            "title": "A novel blockchain-as-a-service (BaaS) platform for local 5G operators",
            "venue": "IEEE Open J. Commun. Soc. 2021,",
            "year": 2021
        },
        {
            "authors": [
                "A. Dawod",
                "D. Georgakopoulos",
                "P.P. Jayaraman",
                "A. Nirmalathas"
            ],
            "title": "An IoT-owned service for global IoT device discovery, integration and (Re) use",
            "venue": "In Proceedings of the 2020 IEEE International Conference on Services Computing (SCC), Beijing, China,",
            "year": 2020
        },
        {
            "authors": [
                "A. Javaid",
                "M. Zahid",
                "I. Ali",
                "R.J.U.H. Khan",
                "Z. Noshad",
                "N. Javaid"
            ],
            "title": "Reputation system for IoT data monetization using blockchain",
            "venue": "In Proceedings of the International Conference on Broadband and Wireless Computing, Communication and Applications, Antwerp, Belgium,",
            "year": 2019
        },
        {
            "authors": [
                "B. Hamdaoui",
                "M. Alkalbani",
                "A. Rayes",
                "N. Zorba"
            ],
            "title": "IoTShare: A blockchain-enabled IoT resource sharing on-demand protocol for smart city situation-awareness applications",
            "venue": "IEEE Internet Things J. 2020,",
            "year": 2020
        },
        {
            "authors": [
                "C. Fan",
                "S. Ghaemi",
                "H. Khazaei",
                "P. Musilek"
            ],
            "title": "Performance Evaluation of Blockchain Systems: A Systematic Survey",
            "venue": "IEEE Access 2020,",
            "year": 2020
        },
        {
            "authors": [
                "S. Smetanin",
                "A. Ometov",
                "M. Komarov",
                "P. Masek",
                "Y. Koucheryavy"
            ],
            "title": "Blockchain Evaluation Approaches: State-of-the-Art and Future Perspective",
            "venue": "Sensors",
            "year": 2020
        },
        {
            "authors": [
                "L. de Camargo Silva",
                "M. Samaniego",
                "R. Deters"
            ],
            "title": "IoT and blockchain for smart locks",
            "venue": "In Proceedings of the 2019 IEEE 10th Annual Information Technology, Electronics and Mobile Communication Conference (IEMCON),",
            "year": 2019
        },
        {
            "authors": [
                "D. Han",
                "H. Kim",
                "J. Jang"
            ],
            "title": "Blockchain based smart door lock system",
            "venue": "In Proceedings of the 2017 International Conference on Information and Communication Technology Convergence (ICTC), Jeju, Korea,",
            "year": 2017
        },
        {
            "authors": [
                "S. Au",
                "T. Power"
            ],
            "title": "Tokenomics: The Crypto Shift of Blockchains, ICOs, and Tokens",
            "venue": "Packt Publishing Ltd.: Birmingham,",
            "year": 2018
        },
        {
            "authors": [
                "R. Lamberty",
                "D. de Waard",
                "A. Poddey"
            ],
            "title": "Leading Digital Socio-Economy to Efficiency: A Primer on Tokenomics",
            "venue": "arXiv 2020,",
            "year": 2020
        },
        {
            "authors": [
                "H.M. Kim",
                "M. Laskowski",
                "M. Zargham",
                "H. Turesson",
                "M. Barlin",
                "D. Kabanov"
            ],
            "title": "Token Economics in Real Life: Cryptocurrency and Incentives Design for Insolar\u2019s Blockchain Network",
            "year": 2021
        },
        {
            "authors": [
                "L. Oliveira",
                "L. Zavolokina",
                "I. Bauer",
                "G. Schwabe"
            ],
            "title": "To token or not to token: Tools for understanding blockchain tokens",
            "venue": "In Proceedings of the International Conference of Information Systems (ICIS 2018),",
            "year": 2018
        },
        {
            "authors": [
                "Florie Mazzorana-Kremer"
            ],
            "title": "Guidelines for Enquiries Regarding the Regulatory Framework for Initial Coin Offerings (ICOs). 2018",
            "venue": "Available online: https://www.finma.ch/en/~/media/finma/dokumente/dokumentencenter/myfinma/1bewilligung/ fintech/wegleitung-ico.pdf?la=en (accessed on",
            "year": 2022
        },
        {
            "authors": [
                "W. Warren",
                "A. 0x Bandeali"
            ],
            "title": "An Open Protocol for Decentralized Exchange on the Ethereum Blockchain",
            "venue": "2017. Available online: https://github.com/0xProject/whitepaper",
            "year": 2022
        },
        {
            "authors": [
                "0x"
            ],
            "title": "Powering the Decentralized Exchange of Tokens on Ethereum",
            "venue": "Available online: https://0x.org/",
            "year": 2022
        },
        {
            "authors": [
                "G. Urdaneta",
                "G. Pierre",
                "M.V. Steen"
            ],
            "title": "A Survey of DHT Security Techniques",
            "venue": "ACM Comput. Surv",
            "year": 2011
        },
        {
            "authors": [
                "D. Pennino",
                "M. Pizzonia",
                "A. Vitaletti",
                "M. Zecchini"
            ],
            "title": "Efficient Certification of Endpoint Control on Blockchain",
            "venue": "IEEE Access 2021,",
            "year": 2021
        },
        {
            "authors": [
                "K. Coutinho",
                "P. Clark",
                "F. Azis",
                "N. Lip",
                "J. Hunt"
            ],
            "title": "Enabling Blockchain Scalability and Interoperability with Mobile Computing through LayerOne",
            "venue": "X. arXiv 2021,",
            "year": 2021
        },
        {
            "authors": [
                "K. Samani"
            ],
            "title": "New Models for Utility Tokens\u2014Multicoin Capital. 2018",
            "venue": "Available online: https://multicoin.capital/2018/02/13 /new-models-utility-tokens/ (accessed on",
            "year": 2022
        },
        {
            "authors": [
                "A. Khamisa"
            ],
            "title": "Token economies. In The Emerald Handbook of Blockchain for Business",
            "venue": "Emerald Publishing Limited: Bradford,",
            "year": 2021
        },
        {
            "authors": [
                "S. H\u00e4fner"
            ],
            "title": "Utility Token Design; Available at SSRN 3954773",
            "venue": "Research at W3F Fundation: Zug, Switzerland,",
            "year": 2021
        },
        {
            "authors": [
                "G. Huberman",
                "J.D. Leshno",
                "C. Moallemi"
            ],
            "title": "Monopoly without a monopolist: An economic analysis of the bitcoin payment system",
            "venue": "Rev. Econ. Stud",
            "year": 2021
        },
        {
            "authors": [
                "K.B. Wilson",
                "A. Karg",
                "H. Ghaderi"
            ],
            "title": "Prospecting non-fungible tokens in the digital economy: Stakeholders and ecosystem, risk and opportunity",
            "venue": "Bus. Horizons",
            "year": 2021
        },
        {
            "authors": [
                "P.P. Ray",
                "N. Kumar",
                "D. Dash"
            ],
            "title": "BLWN: Blockchain-Based Lightweight Simplified Payment Verification in IoT-Assisted e-Healthcare",
            "venue": "IEEE Syst. J. 2021,",
            "year": 2021
        },
        {
            "authors": [
                "T. K\u00e4bisch"
            ],
            "title": "Verification of Bitcoin in the Incubed Protocol; Hochschule Mittweida: Mittweida, Germany, 2020",
            "year": 2020
        },
        {
            "authors": [
                "P. Danzi",
                "A.E. Kal\u00f8r",
                "\u010c. Stefanovi\u0107",
                "P. Popovski"
            ],
            "title": "Delay and Communication Tradeoffs for Blockchain Systems With Lightweight IoT Clients",
            "venue": "IEEE Internet Things J. 2019,",
            "year": 2019
        },
        {
            "authors": [
                "T. Le",
                "M.W. Mutka"
            ],
            "title": "A lightweight block validation method for resource-constrained iot devices in blockchain-based applications",
            "venue": "In Proceedings of the 2019 IEEE 20th International Symposium on \u201cA World of Wireless, Mobile and Multimedia Networks\u201d",
            "year": 2019
        },
        {
            "authors": [
                "Q. Zhou",
                "H. Huang",
                "Z. Zheng",
                "J. Bian"
            ],
            "title": "Solutions to Scalability of Blockchain: A Survey",
            "venue": "IEEE Access 2020,",
            "year": 2020
        },
        {
            "authors": [
                "M. Swan"
            ],
            "title": "Blockchain economic networks: Economic network theory\u2014Systemic risk and blockchain technology",
            "venue": "In Business Transformation through Blockchain; Springer: Cham, Switzerlabd,",
            "year": 2019
        },
        {
            "authors": [
                "A. Singh",
                "K. Click",
                "R.M. Parizi",
                "Q. Zhang",
                "A. Dehghantanha",
                "K.K.R. Choo"
            ],
            "title": "Sidechain Technologies in Blockchain Networks: An Examination and State-of-the-Art Review",
            "venue": "J. Netw. Comput. Appl",
            "year": 2020
        },
        {
            "authors": [
                "I.A. Qasse",
                "M. Abu Talib",
                "Q. Nasir"
            ],
            "title": "Inter blockchain communication: A survey",
            "venue": "In Proceedings of the ArabWIC 6th Annual International Conference Research Track, Rabat, Morocco,",
            "year": 2019
        },
        {
            "authors": [
                "S. Schulte",
                "M. Sigwart",
                "P. Frauenthaler",
                "M. Borkowski"
            ],
            "title": "Towards blockchain interoperability",
            "venue": "In Proceedings of the International Conference on Business Process Management, Vienna, Austria,",
            "year": 2019
        },
        {
            "authors": [
                "G. Sagirlar",
                "B. Carminati",
                "E. Ferrari",
                "J.D. Sheehan",
                "E. Ragnoli"
            ],
            "title": "Hybrid-Iot: Hybrid blockchain architecture for Internet of Things-Pow Sub-Blockchains",
            "venue": "Halifax, NS, Canada,",
            "year": 2018
        },
        {
            "authors": [
                "Y. Jiang",
                "C. Wang",
                "Y. Wang",
                "L. Gao"
            ],
            "title": "A Cross-Chain Solution to Integrating Multiple Blockchains for IoT Data Management",
            "venue": "Sensors 2019,",
            "year": 2042
        },
        {
            "authors": [
                "M. Li",
                "H. Tang",
                "A.R. Hussein",
                "X. Wang"
            ],
            "title": "A Sidechain-Based Decentralized Authentication Scheme via Optimized Two-Way Peg Protocol for Smart Community",
            "venue": "IEEE Open J. Commun. Soc. 2020,",
            "year": 2020
        },
        {
            "authors": [
                "C.E. Ngubo",
                "P.J. McBurney",
                "M. Dohler"
            ],
            "title": "Blockchain, IoT and sidechains",
            "venue": "In Proceedings of the International MultiConference of Engineers and Computer Scientists, Hong Kong,",
            "year": 2019
        },
        {
            "authors": [
                "A.M. Antonopoulos"
            ],
            "title": "Mastering Bitcoin: Programming the Open Blockchain; O\u2019Reilly Media, Inc.: Newton, MA, USA, 2017",
            "year": 2017
        },
        {
            "authors": [
                "C. Dannen"
            ],
            "title": "Introducing Ethereum and Solidity; Springer: Cham, Switzerland, 2017; Volume 318",
            "year": 2017
        },
        {
            "authors": [
                "N. Atzei",
                "M. Bartoletti",
                "T. Cimoli"
            ],
            "title": "A survey of attacks on Ethereum smart contracts (Sok)",
            "venue": "In Proceedings of the International Conference on Principles of Security and Trust, Uppsala, Sweden,",
            "year": 2017
        },
        {
            "authors": [
                "M. Amoretti",
                "G. Brambilla",
                "F. Medioli",
                "F. Zanichelli"
            ],
            "title": "Blockchain-based proof of location",
            "venue": "In Proceedings of the 2018 IEEE International Conference on Software Quality, Reliability and Security Companion (QRS-C), Lisbon, Portugal,",
            "year": 2018
        },
        {
            "authors": [
                "F. Boeira",
                "M. Asplund",
                "M.P. Barcellos"
            ],
            "title": "Vouch: A secure proof-of-location scheme for Vanets",
            "venue": "In Proceedings of the 21st ACM International Conference on Modeling, Analysis and Simulation of Wireless and Mobile Systems, Montreal, QC, Canada,",
            "year": 2018
        },
        {
            "authors": [
                "U. Bodkhe",
                "D. Mehta",
                "S. Tanwar",
                "P. Bhattacharya",
                "P.K. Singh",
                "W.C. Hong"
            ],
            "title": "A Survey on Decentralized Consensus Mechanisms for Cyber Physical Systems",
            "venue": "IEEE Access 2020,",
            "year": 2020
        },
        {
            "authors": [
                "D.P. Oyinloye",
                "J.S. Teh",
                "N. Jamil",
                "M. Alawida"
            ],
            "title": "Blockchain Consensus: An Overview of Alternative Protocols",
            "venue": "Symmetry",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "Citation: Pennino, D.; Pizzonia, M.;\nVitaletti, A.; Zecchini, M. Blockchain\nas IoT Economy Enabler: A Review\nof Architectural Aspects. J. Sens.\nActuator Netw. 2022, 11, 20. https://\ndoi.org/10.3390/jsan11020020\nAcademic Editor: Lei Shu\nReceived: 27 January 2022\nAccepted: 24 March 2022\nPublished: 29 March 2022\nPublisher\u2019s Note: MDPI stays neutral\nwith regard to jurisdictional claims in\npublished maps and institutional affil-\niations.\nCopyright: \u00a9 2022 by the authors.\nLicensee MDPI, Basel, Switzerland.\nThis article is an open access article\ndistributed under the terms and\nconditions of the Creative Commons\nAttribution (CC BY) license (https://\ncreativecommons.org/licenses/by/\n4.0/).\nKeywords: Internet of Things (IoT); blockchain; payment; economy; tokens; applications of IoT and blockchain; smart contracts; scalability"
        },
        {
            "heading": "1. Introduction",
            "text": "The Internet of Things (IoT) is a network of tiny devices connected over the Internet to observe the physical world, gather data, and consciously act on it in a useful way. Billions of connected IoT devices are expected to bring a substantial added value for communities and for individuals, also in view of the fact that IoT is tightly connected with several well-known trends, such as Big Data, smart cities, and Industry 4.0, which promise to deeply change many aspects of our lives in the future. As an example, the unprecedented amount of data gathered by billions of IoT sensors will bring us the ability to get new insights and actionable intelligence regarding our world [1,2]. The pervasive presence of smart connected devices will enable the development of innovative services to improve our lives [3] and to face new and unexpected challenges, such as the COVID-19 outbreak [4], and private and public objects (i.e., things) will be available to anyone for renting, even for a short time, to support a new form of shared economy [5]. The general problem of giving a reward to subjects that contribute to this novel added value ecosystem is not only an economic or business-related question. Many IoT applications are peculiar regarding the amount of involved users, the volume and diversity of generated data, the frequency of economic transactions and their latency constraints,\nJ. Sens. Actuator Netw. 2022, 11, 20. https://doi.org/10.3390/jsan11020020 https://www.mdpi.com/journal/jsan\nas well as security requirements. Hence, related technical and architectural aspects are by themselves an interesting cross-cutting dimension for many IoT applications. This is even more compelling if we observe that decentralization is going to be a fundamental aspect of evolved IoT ecosystems. In fact, a single organization handling a vast amount of heterogeneous and pervasive IoT devices is not simply unrealistic, but also unfeasible. We expect that in the more complex scenarios, many organizations will contribute to a single IoT ecosystem. Furthermore, the pervasive nature of IoT deployments usually requires the involvement of end-users that buy, deploy, and contribute their devices to an ecosystem on the basis of some kind of future advantage. Ecosystems of this kind grow as more people are willing to contribute, and not (only) under the pressure of centralized investments. This decentralized nature of the IoT is a natural contact point with blockchain technology, and in particular, the usually open participation of users to IoT deployments suggests the employment of public/permissionless blockchains. For this reason, in this paper we will focus on the integration of IoT with that kind of blockchain, citing permissioned approaches only occasionally. This will provide the highest guarantees in terms of decentralization and security, but leave open significant challenges in terms of scalability, a key property for IoT. In essence, we will consider the reference scenario depicted in Figure 1. Thing providers are individuals or organizations that make things, and/or the data generated by those things, accessible to others. Examples of thing providers range from citizens running smart sensors for the collection of data on pollution in their houses to organizations renting scooters in cities (see Section 4 for a list of interesting use cases). On the other side, thing consumers use things and/or their generated data. Examples are citizens renting a scooter, or environmental protection agencies using data gathered by private citizens. In general, the participation of thing providers to an IoT ecosystem is motivated by a benefit. While in some cases, this might simply come from a community sharing the same purpose (e.g., environmental monitoring to improve the safety of a shared place), in general, an appropriate and automated economic reward is a natural incentive leading to an IoT-based economy. Renting a thing (e.g., a scooter) is likely the most straightforward case of IoT-based economy, but many other models are possible, such as selling data or getting a reward for participating in a network of interconnected things to serve as a data packet router. All the above considerations immediately suggest the use of blockchain technologies to support an IoT-based economy. In fact, blockchains are well known to be able to support the exchange of economic values (embodied by cryptocurrencies, or more precisely, tokens) in a decentralized manner and with a high level of security, without the need for the involved subjects to trust each other. In this setting, where the blockchain is primarily employed to exchange tokens, the employment of public/permissionless blockchains provides the highest guarantees and allows the exploitation of the tokens in a wider ecosystem. For example, we can envision an ecosystem in which the tokens gained to support the collection of environmental pollution data are employed for renting a scooter. The employment of blockchain brings many advantages in terms of flexibility because it allows us to implement an algorithmic governance capable of autonomously handling all the important aspects of the reward process, such as when to pay the reward, how its amount is calculated, who is charged and when, and so on. It also provides new financial tools to sustain the whole ecosystem, like Initial Coin Offering (ICO) and market-driven prices. These financial tools can be adopted as mechanisms to reward all the thing providers that want to participate in an ecosystem. A token that can be exchanged with many others, or that can be accepted as payment in many contexts, is more valuable (an economist may say more liquid) than one that is accepted as payment in only a few situations; this strengthens our previous choice to focus this work on the integration of IoT with public/permissionless blockchains. However, the employment of a blockchain has some drawbacks. Beside the obvious increase in architectural complexity, it forces one to make some architectural choices that have a significant impact, for example, on the scalability and on the resiliency of the whole system.\nIn this paper, we provide a review of architectural aspects of the integration of IoT and public/permissionless blockchain, to support the IoT-based economy. In our review, we start from some selected relevant projects and scientific papers in which the blockchainbased IoT economy is central, and we analyze the technical aspects of this integration, providing a reasoned survey of blockchain technologies and of architectural choices and showing their strengths and weaknesses. We deliberately neglect the financial, economical, ethical, and social analysis (see, for example, [5\u20137]) of the implications behind the considered scenarios, focusing only on the technologies that enable them. For example, we do not investigate what the economic drivers behind the adoption and sustainability of the business models leveraging cryptocurrencies or tokens are. However, we focus on the technical ingredients (e.g., smart contracts, payment channels, etc.) and architectures to enable those models. Other works [8\u201313] have analyzed this economic benefit, citing payments as a reason to adopt BC with IoT, only from a scientific point of view. Because a scientific solution can sometimes be tricky to apply in a real scenario, in this work, we started from real use cases. Finally, we remark that this paper focuses on techniques and strategies enabling a blockchain-based economy for IoT applications, but we invite readers interested in works showing how IoT benefits from the integration with blockchain to read [14,15].\nStructure of the Paper\nIn Section 2, we provide some background on IoT and blockchains. In Section 3, we review some blockchain technologies that are particularly suited for use in IoT ecosystems. In Section 4, we consider a set of applications that either take advantage of the reference scenario for the IoT economy depicted in Figure 1 or propose a setting in which that scenario is a natural evolution. In Section 7, we analyze the main technical ingredients and architectural choices to enable the IoT economy, also referring to choices actually made by the considered projects. In Section 6, we go beyond simple payments, discussing some financial tools enabled by blockchain adoption, their relation with IoT, and their architectural impact. Finally, in Section 8, we provide some conclusions and discuss some open problems."
        },
        {
            "heading": "2. Background",
            "text": "The two main technical components in the reference scenario in Figure 1 are the IoT and the blockchain. In this section, we introduce some background on these technologies, with a particular focus on the main aspects affecting the interaction between them."
        },
        {
            "heading": "2.1. Internet of Things Background",
            "text": "The Internet of Things (IoT) is a network of physical objects\u2014things\u2014that are equipped with sensors, actuators, and computation and communication capabilities for the purpose\nof observing a physical phenomenon, delivering the monitored data over the Internet, and acting in the environment, either according to local autonomous decisions or implementing remote commands [16]. The amount of IoT devices is rapidly increasing. By 2025, forecasts suggest that there will be more than 75 billion IoT-connected devices in use, which is three times those deployed in 2019 (https://www.statista.com/statistics/471264/iot-number-of-connecteddevices-worldwide/, (accessed on 28 March 2022)). The unprecedented amount of data collected by the IoT on the physical world, combined with cloud computing, promotes the development of new services, affecting many aspects of human daily life and with great market potential. Typical areas of application include manufacturing, smart city, supply chain, transportation, agriculture, energy management, environmental monitoring, and many others [16]. Lately, IoT devices have not only been exchanging data; an emerging trend is to enable Machine-to-Machine (M2M) payments, turning each connected device into a platform for selling and purchasing. By 2022, 451 Research\u2019s IoT Market Monitor expects that USD 7.5 billion in new transactions will be driven, in the US, through IoT payments (https://www. forbes.com/sites/jordanmckee/2019/10/09/the-internet-of-payments-has-arrived/?sh= 6faa22da3e69, (accessed on 28 March 2022)). A typical IoT architecture consists of things, gateways, and the cloud platform (see Figure 2) [17]. Usually, things support power-efficient wireless technologies (e.g., LoRaWAN [18], Sigfox [19]) that, in order to limit the energy consumption and prolong the network lifetime, do not allow direct connection to the Internet. In this scenario, gateways are more powerful devices, usually not bounded by energy constraints, in charge of receiving the wireless communications from the things and delivering the messages to the cloud platform over the Internet. In some cases, the things can be directly connected to the Internet, either because they exploit power-efficient wireless technologies (e.g., NB-IoT), or because, in some specific scenarios, they can be connected to external and/or renewable power sources that allow the exploitation of more energy-demanding wireless technologies [20]. The trade-off between energy consumption, expected network lifetime, and connection quality (in terms of bandwidth, latency, and coverage) are application-specific.\nThe things (or sensor nodes) are end nodes with sensors/actuators that are usually programmed for a specific application purpose. As already discussed, things can be deployed in a variety of application domains, and consequently, they feature very heterogeneous characteristics [17]. However, when compared even to low-end notebooks, they are usually devices with very limited resources, as shown in Table 1. This is extremely important, since most current blockchain technologies have requirements that cannot be easily satisfied even by low-end notebooks.\nThe massive production of data foreseen in the IoT impacts on network performances and on data congestion to the cloud servers. For this reason, additional computing layers, such as edge and fog computing, can be added between the things and the cloud to carry out the computation closest to the sources of data with the purpose of (a) filtering data to limit the traffic to the cloud and (b) improving the responsiveness to handle local events, and in general, enhancing the thing\u2019s computational and storage capacity [26]. Edge computing is data computation that happens at the network\u2019s edge, in proximity to the things, while fog computing acts as a mediator between the edge and the cloud for various purposes, such as data filtering or a localized learning model [17]. Section 7.2 discusses the main issues in accessing a blockchain from the things, and Figure 3 summarizes the possible roles of things and gateways with respect to blockchain integration. For the sake of simplicity, in this paper we limit our attention to gateways, but they actually represent any edge computing device capable of enhancing things\u2019 limited resources to support more advanced blockchain functionalities."
        },
        {
            "heading": "2.2. Blockchain and DLT Background",
            "text": "A Distributed Ledger Technology (DLT) is a decentralized log of records, the ledger, managed by multiple, usually autonomous, participants (also called users or subjects), across multiple nodes (for more details, see [27]). At each instant of time, the ledger represents a unique state that is updated by atomic transaction; this update is essentially the appending of a new record to the ledger. Unlike a centralized database, a distributed ledger is decentralized; there is no need for a central authority or intermediary for processing, validating, and/or authenticating transactions. A blockchain is a type of DLT where transactions are recorded according to an immutable order obtained by means of cryptographic hash functions that chain the blocks in which transactions are recorded. Since DLT gained attention through the diffusion of the blockchain, it is common practice to use the term blockchain even when talking about other types of DLT. For this reason, in the rest of the paper we will adopt the same common practice. The most common blockchains can be abstracted as key-value stores. For example, in a blockchain implementing a cryptocurrency, keys are addresses (also called accounts), while values are the balances of their wallets. In this scenario, a transaction is an operation that transfers cryptocurrency from one wallet to another. We call pending transactions those that are generated by users but are not (yet) processed by the blockchain. A confirmed transaction is an immutable transaction that was successfully processed by the blockchain. The state of the blockchain is a totally ordered sequence of confirmed transactions. For efficiency reasons, transactions are not confirmed one-by-one but aggregated into blocks. Pending transactions are confirmed when a new block is hlcreated (or hlmined). The mining of a new block requires:\n(1) selecting a subset of pending transactions; (2) ordering them; (3) verifying that all transactions of the block, considered in the chosen order, comply\nwith certain consensus rules (which depends also on the application domain).\nThe process of verification of consensus rules is called validation, and a transaction that passes this check is valid. The consensus (see [28\u201330]) is the decentralized process by which a block is finally stored in the ledger. For the sake of simplicity, in the blockchain, we can assume that a block b is composed of two parts: the body that contains all the valid transactions, and the header. In the body, transactions are usually ordered and stored using an Authenticated Data Structure (ADS) [31\u201333], which efficiently links their content with a cryptographic hash rbody. For the sake of simplicity, the header can be summarized as a tuple \u3008rp, rbody, sec\u3009, where rp is the hash of the header of the previous block p (this cryptographically links all blocks to obtain a chain), and sec is security information that provides proof that the block is the result of a consensus among many nodes. Hash rbody is employed to efficiently prove the presence of a transaction in the block exploiting cryptographic proofs obtained by ADSes (e.g., Merkle proofs). A blockchain is typically managed by a set of autonomous nodes that collectively create a peer-to-peer (p2p) network adhering to a protocol for inter-node communication and validating new blocks. Nodes do not trust each other, and malicious nodes are tolerated within certain limits, which depend on the consensus algorithm.\nIt is possible to distinguish three main types of blockchain nodes.\n\u2022 A full node verifies and relays the transactions and the blocks to the network. To check the validity of pending transactions, it has to independently validate the complete copy of the blockchain. \u2022 A light node connects to full nodes to interact with the blockchain. Namely, it uses full nodes as intermediaries. It needs only the chain of the block headers to operate. It can ask selected content of block bodies (i.e., the transactions) to full nodees when needed. Light nodes do no need to trust a specific full node, since full nodes provide the required information equipped with Merkle proofs. The amount of resources and storage needed is several orders of magnitude lower than that of a full node, while achieving a very high level of security. It currently takes about an hour and 100 MB to synchronize the entire Ethereum mainnet blockchain with a light node. \u2022 A client node relays on 3rd-party hosted nodes providing API to access blockchain services (e.g., Infura). These clients connect to a remote node and completely trust its responses in a non-cryptographically-proven manner.\nBoth full and light nodes suffer the problem concerning the first synchronization with the network, since they must download a huge amount of information. For example, nowadays, a full node of Ethereum, must download \u2248 1200 GB of data (Sources: https: //ycharts.com/indicators/reports/ethereum_statistics, https://etherscan.io/chartsync/ chaindefault, (accessed on 28 March 2022)). Since this is a change of 90% from one year ago, it is easy to highlight the first synchronization as a big problem in the blockchain scenario, and a huge one if we also consider the limitations of the IoT devices. To mitigate this problem, some solutions (such as [34\u201336]) have been proposed. The main concept of those solutions is the acceptance of a trade-off between the amount of stored information and the amount of data that a node can verify. Blockchains can be categorized according to who can write or read the content of the ledger and to who can participate in the consensus. In public blockchains, anyone can read the content of the ledger and propose a new transaction that, if successfully validated by the consensus, will be eventually stored in the ledger. In contrast, in private blockchains, users are authenticated, and access control allows or denies each user operation, as occurs for access control of regular information systems. Similarly, in a permissionless blockchain, every user can participate in the consensus (in this paper we also use the term unpermis-\nsioned), while in a permissioned one, the participation in the consensus is allowed only for specific users. While initially, blockchain was primarily conceived to implement cryptocurrencies, the most intriguing functionality of more recent technologies (e.g., Ethereum [37], EOS [38]) is smart contracts. These consist of pieces of code that are executed as part of a transaction. In simple terms, in these cases, the blockchain implements a global decentralized computer, and smart contracts are the programs running on it. Smart contracts can act only on data that are stored in the blockchain. However, in the IoT use cases that we consider in this paper, there is a need to access off-chain data. This is addressed by an architectural solution that is called oracle (for more details, see [39]). A detailed discussion of oracles and their role in the IoT context is provided in Section 7.3. The growing need for better performance compared to the speed of transaction management pushed the blockchain community to reuse a structure from the field of graph theory, the Direct Acyclic Graph (DAG). The DAG substitutes the chain, and each vertex of this graph represents a transaction of the system. Using a DAG instead of a normal chain brings the following advantages:\n(1) suited for microtransactions and high volumes of transactions; (2) eliminates the need for mining (each node can create and validate a transaction independently); (3) fees may be reduced significantly; (4) lower energy consumption.\nOn the other hand, it brings the following disadvantages:\n(1) has not yet sustained high levels of decentralization; (2) is more vulnerable to attacks due to its parallelization.\nCurrently, the DAG structure is used by EthereumII (in its new mining algorithm Ethash [40]), IOTA [41], Obyte [42], and Nano [43]. On a permissioned blockchain, peers are part of a well-known community that share a common goal, and consequently, there is usually no need of an explicit reward to incentivize participation. On the contrary, in permissionless blockchain, anyone can participate in the consensus, so a natural approach is to reward\u2014usually in the native token of the system\u2014whoever is working for the advantage of the network. For instance, in Bitcoin and Ethereum, a peer receives Bitcoin and Ether tokens, respectively, for solving the PoW; on Algorand, the peers of the elected committee reaching consensus are rewarded with Algos. New tokens with specific features, beyond the ones provides by native tokens, can also be created by smart contracts in compliance with standards (e.g., [44,45]). Alternatively, some technologies have specific support for the streamlined creation of new tokens, such as, for example, Algorand [46]. Tokens can be of two types:\n\u2022 Fungible tokens, if each token represents a value in the application. If two users exchange among themselves the same amount of fungible tokens, they will end up in the same initial state. For instance, fungible tokens may be used to represent an internal cash system, a voucher, and so on. \u2022 Non-fungible tokens (NFT), if each token is a digital twin of an off-chain object. If two users exchange among themselves their NFTs, they will not end up in the same initial state. For instance, NFTs can be used to represent an object of the physical world (such as a car, real estate, etc.) or an object of the digital world (such as images, audio files, etc.) in-chain.\nIn conclusion, for this blockchain overview, if the reader is interested, we also want to suggest [47,48], which summarize the current challenges faced in the blockchain field."
        },
        {
            "heading": "2.3. Decentralization and Scalability: The Blockchain Scalability Trilemma",
            "text": "As we stated in Section 2.1, an IoT ecosystem may produce a big amount of data and transactions, and therefore, using solutions that can handle and process such an\namount of data is a key property that should be guaranteed. However, scalability and high transaction throughput are still open issues for blockchain technologies. Introduced by Vitalik Buterin [49], the scalability trilemma states that it is challenging to create a system that is scalable, decentralized, and secure. Essentially, Buterin conjects that a system cannot excel in all three aspects but has to express a trade-off. We now describe the three aspects.\n\u2022 A blockchain is decentralized if no single entity controls the consensus, meaning that no one can control or censor the data that transacts through it. When consensus is governed by a limited number of entities, decentralization is limited. In this respect, permissionless blockchains guarantee the highest level of decentralization (anyone can contribute to consensus), while permissioned ones are more centralized. \u2022 A blockchain is secure if, to alter its correct behavior, or status, for example to perform a double-spending attack, an attacker has to control a large number of the nodes participating in the consensus, usually more than half or more than 1/3, depending on the consensus algorithm adopted. Typically, blockchain systems provide a high level of security, without any compromise. \u2022 A blockchain is scalable if it can support high transaction throughput and future growth. Current blockchain technologies have severe limitations regarding scalability. One aspect is that adding more nodes to the blockchain does not increase the maximum transaction throughput (more nodes just perform the same operations). It may be interesting to note that, since transactions have to be executed sequentially, throughput and latency are not independent. Algorand, which is considered one of the best performers among the permissionless blockchains, can reach more than 1200 transactions per second, producing a block every 5 s. An example of a citizenoriented Algorand-based application can be found in [50], where performances are also discussed. Some proposals of blockchains that increase their maximum transaction throughput when the number of nodes increases are available in the scientific literature [51,52]. See also Section 3 for IoT-targeted solutions.\nIn general, permissioned blockchains can provide higher transaction throughput and low latency, since only a limited amount of known nodes participate in the consensus, thus limiting the overall complexity\u2014at the cost of a greatly reduced decentralization. In this work, we mostly focus on permissionless blockchains. Proof-of-Work (PoW), the most consolidated consensus mechanism, provides limited transaction throughput scalability, but guarantees high decentralization and security. However, in recent years, the concentration of miners in very few geographical areas with low energy costs has brought into question the true decentralization of PoW. IOTA [41] is a distributed ledger with unprecedented performance in terms of scalability, but at least in its original implementation, it relies on coordinators, which greatly reduce decentralization. Indeed, the main IOTA network is governed by \u201cthe coordinator\u201d, a centralized node run by the IOTA Foundation. The coordinator states which transactions and data are included in the ledger. The IOTA Foundation plans to ditch the coordinator in version 2.0 of the IOTA protocol.\nCan we extend the Buterin trilemma to the Internt of Things (IoT)? The IoT is:\n\u2022 decentralized, if the network is made by devices managed by autonomous organizations and/or the data produced by the IoT are handled by autonomous organizations, \u2022 secure, if to alter the correct behavior/status of the network, an attacker would need control of the majority of the nodes. Device security is only as good as the weakest link in the infrastructure. As Brody said, \u201cSo if I have a very sophisticated hack-resilient blockchain network, but the operating system that my device runs on is poorly patched or isn\u2019t maintained or isn\u2019t updated, I\u2019ve rendered all of that pointless and my device is easily hacked at the edge.\u201d, \u2022 scalable, if nodes can be added to the network while still guaranteeing suitable SLA."
        },
        {
            "heading": "3. IoT-Targeted Blockchain Technologies",
            "text": "Table 2 summarizes some DLT technologies that are declared to be suitable for use in IoT solutions. They can be categorized into two categories:\n(1) those that aim to provide better performances in terms of scalability and reducing transaction fees; (2) those also aiming to guarantee blockchain verifiability for IoT devices, enhancing the security of the overall system.\nScalable technologies. In Section 2.3, we described how current blockchain technologies are affected by scalability problems. This limits their adoption with IoT due to the large amount of produced data and transactions. Research has attempted to design new solutions, attempting to solve this problem at different layers and with various approaches. A first approach is at the consensus layer, through Proof-of-Stake (PoS) consensus algorithms, which are more efficient and guarantee a higher transaction throughput with respect to PoW. Algorand [53] is an example of PoS blockchain, and it guarantees around 1200 transactions per second [54]. Despite its limited decentralization, delegated Proof-ofStake consensus also reaches good performance in terms of scalability (see, for example, EOS.IO [38]). Another approach is the one based on the adoption of a Directed Acyclic Graph (DAG) instead of a blockchain. IOTA [41] is among the leaders in this field. In IOTA, for each new transaction, every node participates in the consensus by validating two other transactions that are on the border of the DAG, and therefore, there is no need to pay fees. This is a relevant aspect considering the large amount of transactions necessary to store IoT data on-chain. However, as we mentioned in Section 2.3, IOTA currently relies on a centralized coordinator. Finally, the last approach to enhance scalability is through three techniques at layer-2, as summarized in [55].\n(a) State/payment channels are communication channels transporting transactions that could occur on the blockchain, but instead get conducted off of the blockchain, without significantly increasing the risk of any participant. On the mainnet, we can find only the \u201copening\u201d and the \u201cclosing\u201d of the channel (representing the initial and final general-purpose state or balance). Lightning Network [56] for Bitcoin and Raiden Network [57] for Ethereum are examples of layer-2 channels. (b) Sidechain is a separate blockchain attached to its parent blockchain through a twoway peg. It is a technique enabling one to move assets of the parent blockchain to the sidechain, and vice versa. Polygon foundation [58] has released a sidechain attached to the Ethereum mainnet. (c) Rollups is a technique where a number of off-chain transactions are validated onchain, either by default, leaving the possibility open to network users to dispute in case of an invalid update, or with a single cryptographic proof (e.g., zk-SNARK [59]). The first case is known as optimistic rollup, the second one as zk-rollup. The Polygon foundation has also released Hermez [60], a system to realize zk-rollups, while Optimism [61] and Arbitrum [62] are well-known implementations of optimistic rollups.\nHighly verifiable technologies. Things are resource-constrained devices (see Section 2.1). They usually have limited processing power, with a clock in the order of MHz, a RAM smaller than 1 GB (usually hundreds of MB), and a communication bandwidth of at most 1 Mbps (usually hundreds of Kbps). Furthermore, in many cases, things are battery powered, and to extend the device lifetime, duty-cycling techniques are commonly employed, which further limit the overall throughput of the node. These limited resources are in contrast with some typical requirements of most blockchain technologies. As an example, a full node requires hundreds of GB and a throughput of hundreds of MBps (speed of SSD) to copy the blockchain in a fair amount of time (tens of hours). This applies primarily to public/permissionless blockchains, since private/permissioned ones usually deal with\nlower amounts of data. In this work, we focus on public/permissionless blockchains, as already stated in the introduction. IoT devices are able to host neither a full node nor (in many cases) a light node. Therefore, to connect to the blockchain, they need to rely on an external full node that has to be trusted. INCUBED [63] is a protocol that aims to solve this problem. In INCUBED, small devices rely on any untrusted node of a specialized decentralized network. The Mina protocol [64] aims to be a lightweight blockchain that maintains a constant size of just 22 kB, regardless of how many transactions are committed to the network. This size should allow anyone to operate a node and help secure its network without needing sophisticated computer hardware. The key to the Mina protocol is the incorporation of zk-SNARKs. In Mina\u2019s case, this means that the nodes in the network do not verify all transactions in all blocks. Instead, the blockchain is represented with an easily verifiable cryptographic proof (the zk-SNARK). This proof is much smaller than the size of most other blockchains and represents the state of the whole chain (and not only the latest block). Combined with a Proof-of-Stake consensus mechanism, Mina claims their implementation of zk-SNARKs significantly cuts down on the resources needed to process and record transactions."
        },
        {
            "heading": "4. Blockchain-Supported IoT-Economies Use-Cases",
            "text": "In this section, we describe the process used to select the projects and applications that represent our use-cases to motivate and support the illustration of the technical components in the rest of the paper."
        },
        {
            "heading": "4.1. Methodology",
            "text": "In our investigation, we looked for projects and applications with the following eligibility criteria:\n\u2022 Projects/applications should have the goal to manage an ecosystem of IoT devices that, even if currently limited in size, has the potential to scale up both in terms of devices and involved people. \u2022 Projects/applications should entail economic transactions among subjects and/or IoT devices within the ecosystem and represent values by means of blockchain tokens. Transactions should be automatically triggered by IoT devices, or this possibility should at least be a future valuable direction of development. \u2022 Projects/applications should potentially involve a conspicuous community and/or involve one or more companies. \u2022 Projects/applications should be realized or realizable by using unpermissioned blockchains. The reasons for this choice were discussed in Sections 1 and 2.3. As an\nexception, we may also consider projects based on permissioned blockchains when they represent interesting use-cases, and when they might potentially be implemented on unpermissioned blockchain.\nTo achieve our goal, we considered (1) works taken from the scientific literature and (2) projects that are not scientifically documented, but that have published enough details regarding their goals, the economic relations between actors, their architecture, and their integration of IoT and blockchain technologies. For surveying relevant scientific works (see Section 4.3), we adopted an approach inspired by the PRISMA methodology [65]. PRISMA is based on four main phases: identification, screening, eligibility, inclusion. We refer the reader to [65] for the details regarding each phase. This methodology provided us with a reproducible process of scientific paper selection starting from well-established research databases. Concerning the projects that are not scientifically documented, namely those that did not publish a paper in renowned journals or proceedings, there are unfortunately no reference databases to search on. We stress that the habit to publish a white or yellow paper outside the usual scientific venues is quite common in the blockchain community, as also witnessed by the original paper by Sathoshi Nakamoto, \u201cBitcoin: A Peer-to-Peer Electronic Cash System\u201d, published in 2008. This is due to the aim and necessity of making these papers available to a wider audience. Furthermore, web search engines provide results that vary over time. For these reasons, it is almost impossible to apply a procedure that can be easily reproduced, like PRISMA; hence, for the selection of the projects, we reverted to an informal web search. We are conscious of the fact that, with this approach, we obtain a non-formally-defined sample of the current relevant projects for blockchain-based IoT economy. However, considering real-life projects is very important to understand the current state of the art of blockchain-enabled IoT economy, since, from the beginning of our search, we recognized that real projects, promoted by companies, startups, or communities, have to face challenges that are hardly encountered by scientific research projects. In particular, they have to face scalability problems, real users\u2019 interaction, and oddities of unpermissioned blockchains, such as market-dependent transaction fees, just to mention a few. Further, real-life projects often provide complete implementations (or at least plans) for many architectural aspects, which in scientific works may be overlooked. For these reasons, we consider fundamental the inclusion in our survey of real-life projects, even if, in their selection, we cannot follow a formal reproducible procedure."
        },
        {
            "heading": "4.2. Selection of Real-Life Projects and Applications",
            "text": "For searching out real-life projects and applications, we informally used web search (by the Google search engine), web navigation, and projects mentioned in the scientific literature, selecting elements that match the eligibility criteria discussed above and that provide a representative set of projects and applications relevant for the blockchain-enabled IoT economy. The results of our survey are shown in Table 3."
        },
        {
            "heading": "4.3. Selection of Scientific Works",
            "text": "We performed the identification phase of PRISMA, selecting Scopus [81] as our reference research article database. Scopus is the Elsevier\u2019s abstract and citation database, launched in 2004. It covers nearly 36,377 titles from approximately 11,678 publishers, of which 34,346 are peer-reviewed journals in top-level subject fields. We used the search tool of Scopus to focus on papers related to blockchain as an IoT economy enabler. A query is always in the form TITLE-ABS-KEY (search keys in AND), which means retrieving documents that have in the title, abstracts, and keywords all the\nSearch Terms Documents Result\niot 75,704\nblockchain 25,944\niot AND blockchain 4287\niot AND blockchain AND economy 141\niot AND blockchain AND payment 159\nIn the screening phase, we considered the 141 papers resulting from query E and the 159 papers from query P. We further restricted our attention to the ones with at least five citations. We obtained 38 papers for query E and 59 papers for query P, with an overlap of 6 papers. In the eligibility phase, we analyzed the 91 papers resulting form the screening phase. Many of those works are reviews (with a different focus with respect to this paper), papers about economics, or highly focused on using the blockchain to provide security guarantees for IoT devices and communications, beyond the rewards transactions. We considered only those papers that propose new architectures, tools, projects, or applications strongly related to our reference scenario depicted in Figure 1. Further, we noted that, in many of the considered papers, the ability of implementing payments by blockchain infrastructures is simply mentioned as a key enabler, but architectural aspects (like those described in Section 7) are either not detailed or only partially described, and the specific financial tools (see Section 6) are not analyzed in depth. In fact, scientific papers usually have the objective of proposing new approaches, the validation of which is rarely performed by setting up a fully-fledged ecosystem. The final outcomes of this process, in view of the eligibility criteria listed in Section 4.1, are the 32 included papers [9,10,82\u2013111]. Finally, in Table 5, we relate the content of the selected scientific works with the reallife projects listed in Table 3. This table shows that most of the main concepts, ideas, and tools presented in the scientific works are actually implemented in the selected real-life projects and applications, which furthermore have to face the technical challenges of a real deployment on the market\u2014a key aspect for solutions aimed at exploiting the blockchain as IoT economy enabler. For this reason, we mostly rely on projects and applications listed in Table 3 as references for the survey of architectural aspects provided in Section 7 and of blockchain-based financial tools provided in Section 6."
        },
        {
            "heading": "5. Applications Classification According to Performance Requirements",
            "text": "In this Section, we introduce a classification of the IoT sample applications presented in Table 3 according to the performances that they require from the blockchain. Performance requirements impact certain design choices, which we describe in Section 7. The\nclassification provided in this section helps us to understand the most important aspects to consider when choosing a blockchain technology for an IoT ecosystem. The evaluation of the performance of blockchain is a complex task that requires one to compare technologies with fairly different approaches (e.g., permissionless vs. permissioned blockchain) in search of appropriate trade-offs, the most important of which are well captured in the blockchain trilemma (see Section 2.3). As an example, it is possible to gain fairly good scalability in permissioned blockchain where a limited number of nodes can participate in the consensus, thus limiting the complexity of permissionless blockchain where every node can participate. However, this improvement in performance is clearly paid in terms of decentralization. Recent works such as [112,113] are first attempts to provide a systematic survey of the performance of different blockchain approaches. While a number of performance metrics could potentially be considered in our discussion, we focus on two of the most relevant here: latency and transactions throughput. The latency of a blockchain network is the time between the submission of a transaction to the network and the first confirmation of acceptance by the network in the blockchain. In certain technologies based on proof-of-work, after the first confirmation, the transaction becomes \u201cmore final\u201d as more blocks are added beyond the initial confirmation. However, in the IoT case, the first confirmation is usually enough. In particular, when the IoT application involves micropayments, the cost of undoing on confirmation is much higher than the obtained advantage. For example, vehicle rental applications [79,80] may be based on micropayments, as well as the Helium [66] ecosystem. The transactions throughput of a blockchain is the number of transactions handled per second, usually denoted by TPS. Table 6 in [112] shows that regardless of the adopted technology, in fairly limited evaluation environments that can only provide an upper bound on the performance, the latency is between about 0.1 s and 361 s, and the transactions throughput is between about 5 TPS and 6000 TPS. These numbers are in line with some other available performance evaluations [114] where Bitcoin performs 7 TPS, Ethereum 20, and Visa roughly 24,000 TPS. Latency requirements are clearly application dependent. However, many applications require some sort of interaction with a human (e.g., a payment should be confirmed before the scooter is unlocked), which provides a guideline for latency. In the following, we consider a latency comparable to the one necessary to perform a payment by a credit/debit card, which involves the authorization of the card issuer, to be low latency. In processing credit cards transactions, 5 s is considered an upper bound; however, 10 is still tolerable. Similarly, we consider the current throughput of credit card circuits, namely an order of tens of thousands of TPS, to be a high transactions throughput. In this case, we also relax this constraint, considering a high throughput of the order of thousands of TPS to be satisfactory. According to the above considerations, the applications considered in Table 3 can be classified as shown in Table 6. Note that applications with low (bounded) throughput are rare, since IoT technology is pervasive and tends to scale to a large number of IoT devices, unless there is some intrinsic limit in the application domain. We were not able to find any relevant application that requires low latency and is not throughput demanding."
        },
        {
            "heading": "6. Blockchain-Based Financial Tools for the IoT",
            "text": "Blockchain technology has had a close connection with finance since the beginning. It is well known that one of the main success story for blockchain is Bitcoin, the first cryptocurrency. Beside the original novelty of implementing transactions in a decentralized setting, it is now clear that blockchains enable a wide range of novel financial instruments, many of which are specific of blockchain-based economic systems. In this section, we discuss some of them that we believe are of special interest for an IoT-based economy and focus on the technical and architectural aspects to enable them."
        },
        {
            "heading": "6.1. Guaranteed Payments and Funds Unlocking",
            "text": "Blockchain-enabled payments can be made arbitrarily complex. In simple cases, spending or transferring funds is allowed after proving their possession. However, in general, blockchain technologies support the adoption of a wide variety of conditions, such as the following examples:\n(1) having the consent of m out of n other users (1 \u2264 m \u2264 n); (2) checking the expiration of a deadline; (3) checking that some other transaction has actually occurred.\nFurther, any logical combination of the above is possible, and since in IoT a device can signal the occurrence of a physical event in blockchain (by a suitable transaction [115,116]), this can be part of the condition as well. For example, this enables automated escrow systems [115,116], in which funds are unlocked when an actor executes some physical action. For blockchains that support smart contracts, any user that is entitled to create a smart contract can create his/her own custom conditions. For ad hoc blockchains with no smart contract support, this flexibility is also available, but decisions regarding which kind of conditions to adopt have to be made by the system designer in advance. Sophisticated payments between parties are used in many use-cases: in SavePlanetEarth [72], individuals exchanges SPE tokens with NFTs representing carbon credits; in MedicalChain [73], medical researchers buy access to a relevant patient\u2019s health data in a marketplace, paying in cryptos. Escrow payments are adopted in [79], where a user who is willing to rent a vehicle directly buys an unlock token from a smart contract to activate the vehicle."
        },
        {
            "heading": "6.2. Tokens",
            "text": "Tokens are digital assets whose ownership is recorded in a blockchain. Almost all unpermissioned blockchain networks have a native token (more properly called coins or\ncryptocurrencies). However, many technologies provide easy means to create new kinds of non-native tokens for specific purposes (see Section 2.2). Each kind of token (native or not) has specific rules according to which token units are created (we also say minted or mined), transferred, and destroyed (we also say burned). These rules are designed to fit the purpose of the token and can vary greatly among tokens. Some reasons to have custom tokens are the following:\n\u2022 They can be given to a thing provider, owning a thing, as a reward for allowing other users to use that thing. \u2022 They can be used as money to buy a service or data within the ecosystem. \u2022 They can represent a specific real thing so that ownership of the thing is represented\nin blockchain by the ownership of the token. This is the case of non-fungible tokens (NFTs), also called asset tokens.\n\u2022 They can be sold to investors and enthusiasts in the initial phase of a project for the purpose of raising fiat money funds by means of an Initial Coin Offer (see below). In turn, token holders get some rights within the newborn ecosystem, such as, for example, having access to an offered service at a lower price, getting a small share of the income, or expressing a vote for the governance of the project. \u2022 They can be used as a security to represent a share of the value of the ecosystem that can be traded and exchanged on a market (see below).\nThe first three cases are realized by standard blockchain features, possibly integrated with capabilities of IoT devices to coordinate transactions with physical events. The last two cases require relying on exchange services, which might be completely independent of the IoT ecosystem or might be integrated with it. In addition, approaches are possible where multiple tokens are used in a single ecosystem, where, for example, one token has the objective of representing the value of the ecosystem as a whole and is traded on the markets, and another serves as a cryptocurrency to buy and sell services in the ecosystem. The value of the second kind of token might be artificially anchored (pegged) to a fiat currency to keep the price of services within the ecosystem stable. This approach usually requires an oracle to observe the current exchange ratio of the first token with a fiat currency and an automatic way to transform the first kind of tokens into the second one, on demand. PlanetWatch [68] adopts two tokens with this perspective: Planet tokens are used as a mean to reward citizens for their provided measurements, and they are traded on the market; Earth Credits can be used to obtain services or products within the PlanetWatch ecosystem, and they can be exchanged either with euros, at a fixed price, or with Planet, at a price depending on its quotation. In Helium [66] and Powerledger [77], two tokens are similarly used. It is worth mentioning that, since different sets of rules result in different \u201ceconomic behavior\u201d, the new field of study called tokenomics (heavily based on game theory; see, for example, [6,117\u2013120]) aims at understanding and foreseeing the effect of a certain set of rules. Further information about the wide variety of possible tokens, their purposes, and their rules can be found in several works (see, for example, [121,122])."
        },
        {
            "heading": "6.3. Incentives",
            "text": "Incentives are an important part of any unpermissioned decentralized architecture. They are usually provided as tokens that reward a positive behavior and that can be converted into something valuable (e.g., fiat money or services) for whoever expressed that behavior. In general, in a blockchain, the reward is given for processing transactions and participating in the creation of new blocks. Integrating IoT with blockchain, we can provide incentives to motivate general positive behaviors, such as keeping some device active or hosting sensors. This may be not directly linked to a certain service or object to be actually used by anyone. In fact, there is some value just in having a part of the system be available for its use. This may motivate thing providers to join a project even in the very beginning phase, when end users are unlikely to buy any service. The possibility to reward service\navailability with freshly created tokens is clearly a value added of the blockchain adoption, in which the token creation strategy can be decided as part of the design of the system. From an architectural point of view, the only critical point is to assess that the condition for the reward holds. Related information may either be directly obtained from smart devices or assessed by an oracle (see Section 7.3). Incentive mechanisms are present in all projects that are listed in Section 4. For example, in PlanetWatch [68], citizens are rewarded when their measurements are uploaded to the blockchain, and in Helium [66], rewards are given when thing providers contribute to prove-of-coverage and to route data."
        },
        {
            "heading": "6.4. Exchanges and Offsetting of Exchange Rates",
            "text": "Exchanges allow one to buy/sell tokens, either for other tokens or for fiat currency. They are fundamental services that allow people to buy tokens to be used in an ecosystem or to convert tokens earned in an ecosystem into fiat or other cryptocurrencies. They are normally centralized, but there are examples of blockchain-based decentralized exchanges [123,124], which can possibly be integrated into user applications [125]. Certain IoT ecosystems may have among their goals the purpose to create or facilitate a market. In this case, some form of decentralized market management may be part of the ecosystem. The Power Ledger project [77] is a prominent example of this approach for smart grids. A token that is traded in an exchange varies its price (or exchange rate) over time. This feature is considered good if the token is meant to represent the value of the ecosystem, since it allows the token owners to gain if the project is successful. On the other side, if the token is meant to be used to buy services or data in an ecosystem, excessive price inflation may have a catastrophic effect, possibly making the actual price of services or data offered in the ecosystem no longer competitive. It is possible to offset the latter problem by pure technological means. In fact, by means of an oracle, it is possible to record in the blockchain the exchange rate of a token with respect to a fiat currency. Clearly, transactions on a blockchain must be performed using a token; however, using the last exchange rate, it is possible to dynamically adjust service/data prices expressed with the token so that they are stable when expressed in fiat currency. In the vehicle-renting system devised in [79], at the time of renting, the client application exchanges money with a cryptocurrency (ETH in their case) in the background to maintain a constant rental cost. Similar approaches are realized by Helium [66] and Power Ledger [77]."
        },
        {
            "heading": "6.5. Staking",
            "text": "As written above, using a blockchain, it can be possible to realize mechanisms that lock tokens and unlock them only when certain conditions hold. Imposing users to lock tokens before allowing them to do certain actions is called staking. Using blockchain, the realization of staking is easy. In fact, funds can be locked for a period of time, and it is enough to programmatically check the presence of the stake in blockchain before allowing the execution of the specific action. There are several reasons to adopt staking.\n\u2022 A first use of staking is to guarantee that a user has correctly fulfilled a certain task. Clearly, there should be a way to assess the correct execution of the task. In the IoT world, this may encompass taking data from a device or from an oracle. If the task is executed correctly, the user can get the benefit of their work and continue their job (or stop and get staked tokens back). If the user is recognized to cheat, the user is deprived of their staked tokens. This approach is used in escrow systems and in proof-of-stake consensus algorithms. In IoT systems, for example, a user can promise to keep a device up and running and can guarantee his/her honesty by staking some tokens. \u2022 Staking can be useful to avoid denial of service attacks and Sybil attacks [126]. In fact, an attacker can emulate a large number of users, nodes, or devices, essentially for free. In this way, the attacker can subvert certain systems (e.g., voting, blockchain consensus, or reputation systems). Forcing each user to stake some tokens makes the cost of the attack proportional to the amount of users, nodes, or devices being emulated. Note that this also impacts the IoT world, since cheap devices are usually\neasy to clone maliciously. On the other hand, it is possible to create hard-to-clone devices by wiring private keys and having a public key infrastructure that signs corresponding certificates. However, this approach centralizes the trust in one, or a few, certification authorities, which is undesirable in a decentralized architecture. An example of a decentralized certification approach based on blockchain is described in [127].\n\u2022 For projects that are valued using the price of a token, forcing users or thing providers to stake some tokens helps to reduce the amount of tokens in circulation. The more users or thing providers want to put tokens at stake, the higher is the demand for the token, and hence, according to the law of supply and demand, the higher is the price of the token. In other words, it is possible to obtain a non-speculative growth of the value of the token (i.e., a growth that matches the growth of the user base) by carefully designing the rules and adopting the blockchain to enforce them [128]. This approach is used in non-IoT blockchain-based services (e.g., [129,130]). Clearly, this is a general approach that can be fruitfully applied also in the context of blockchain-based IoT ecosystems.\nFor example, Helium [66] requires providers of validator nodes to put some Helium native tokens (HNT) at stake. In this case, staking increases the price of HNT. A complex system of penalties is not applied on staking, but rather, the amount of work reward is limited."
        },
        {
            "heading": "6.6. Burn-and-Mint Equilibrium",
            "text": "This approach was pioneered by the Factom blockchain-based data integrity service [131] and has now been adopted also in the IoT context by the Helium [66] network. In this model, the tokens paid by a consumer are not earned by anyone but simply burnt. This approach decouples the amount paid for data or services from the amount of tokens earned by the thing provider. Now, suppose one fixes the price p paid by the consumer in fiat currency and charges the consumer by the amount of tokens t that corresponds to p at the current exchange rate. To do that, the architecture has to include an oracle that regularly acquires the last exchange rate of the token and provides it to the blockchain to be used to compute the amount of tokens to be charged for each payment. Let B be the amount of burnt tokens in a certain unit of time. Let M be an amount of new tokens that is periodically minted and distributed among all nodes or thing providers proportionally to the job they have done in that period [128,132,133]. Let us assume M to be constant, and suppose we start from an equilibrium state in which B = M, and hence the amount of circulating tokens is constant over time. An increase in demand increases the burning rate B with respect to the constant token-minting rate M. Token scarcity makes the token price increase. In turn, a higher token price limits the demand, forcing B to stop increasing. Intuitively, the system is expected to settle into a new equilibrium at a higher price [128,132,133]. The opposite is true if demand decreases. Further, nothing prevents one from changing M artificially to achieve different objectives. A formal analysis of these kinds of blockchain-based economic systems can be found in [134]."
        },
        {
            "heading": "7. Architectural Aspects of Blockchain-Based IoT Economy",
            "text": "When an IoT ecosystem is equipped with a blockchain, many aspects regarding the blockchain itself and how it is integrated with the rest of the ecosystem have to be carefully considered. The adoption of a blockchain is not free, but it raises problems (e.g., regarding scalability) that have to be addressed to allow a project to develop and work correctly and profitably. On the other hand, it is possible to recognize some blockchain design opportunities that become available when a blockchain is used in an IoT ecosystem. In this section, we discuss the design problems and opportunities for an IoT\u2013blockchain integration when the blockchain is primarily a payment enabler. Throughout this section, we refer to the projects and applications identified in Section 4 to provide practical examples of the discussed choices and problems. We also refer to the classification shown in Section 5\nwhen dealing with performances. In the rest of this section, we first discuss problems and possible approaches and/or solutions to address them (Sections 7.1\u20137.5). Section 7.1 focus on high-level technology and deployment choices. Sections 7.2 and 7.3 focus on interfacing the blockchain with the rest of the ecosystem. Sections 7.6 and 7.7 focus on supporting high transactions throughput with low costs. Then, we address opportunities rising from the blockchain\u2013IoT integration (Sections 7.6 and 7.7)."
        },
        {
            "heading": "7.1. Blockchain Nodes: Technology and Deployment Choices",
            "text": "When adopting blockchain for an IoT application, we have three main options:\n1. leverage an existing general-purpose public blockchain network; 2. leverage an existing blockchain technology while creating a distinct dedicated network; 3. create a new ad-hoc blockchain technology and a new corresponding network.\nIn order to reduce production costs and leverage the reputation and reliability of already deployed solutions, the first option is usually considered the most appropriate, and it is easy to find examples of this approach (see, for example, [75,76,78]). As already discussed, public permissionless blockchains also have the advantage of providing the highest guarantee in terms of security\u2014a crucial requirement for the IoT economy\u2014and to facilitate the employment of the obtained incentives in a wider ecosystem of heterogeneous applications and services. In Section 4, the reader can find many examples of projects adopting general-purpose unpermissioned blockchains. The main drawback of this approach is that the IoT application is going to depend on the fluctuations of the public blockchain, and in particular on its network load. Public networks may be congested by usage spikes due to speculations [135] or other applications [136], just to mention two relevant examples. Further, communities governing a general-purpose public blockchain may make choices (e.g., regarding architecture evolution or required node power) that may be in contrast with the needs or the design of the considered IoT application. For these reasons, in some scenarios a dedicated blockchain network may be preferred. In other words, a well-known blockchain technology can be adopted only for a specific application with a dedicated network. In this case, all the issues related to fluctuations can be more easily handled. MedicalChain [73] is an example of this approach implemented as a permissioned blockchain. However, permissioned blockchains have limited decentralization, as already discussed in Sections 1 and 2.3. The most ambitious multivendor IoT ecosystems would probably rely on unpermissioned blockchains. The third approach is to develop an ad hoc blockchain technology to be deployed as a dedicated blockchain, typically on IoT gateways. This is more costly, but allows greater flexibility. For example, in the Helium [67] network, a specific blockchain is proposed that leverages the physical presence of devices on a territory, and their scarcity, to realize a new proof-of-coverage consensus algorithm. The work done by devices to achieve consensus is not wasted (as occurs in Bitcoin and in all blockchains based on regular proof-of-work), but is reused within the Helium ecosystem, realizing an elegant and efficient use of resources. Regarding this third approach, a possible criticism is that an ad hoc dedicated blockchain may be considered less reliable than a general purpose public blockchain. In fact, we can expect a smaller community working on the codebase, and hence governance, bug fixing, and software updates are expected to be less effective. On the other side, an ad hoc technology is expected to be simpler and more focused on the needs of the specific IoT application. In general, the trade-off between the possible greater efficiency of ad hoc solutions and the time necessary to acquire a satisfactory reputation with the wider public\u2014key ingrediente for the success of an IoT economy\u2014should be carefully evaluated."
        },
        {
            "heading": "7.2. Accessing a Blockchain from Resource-Constrained Devices",
            "text": "Since things and thing providers are often large in number, it is natural to consider hosting the nodes of the blockchain in the very same IoT devices. However, as remarked in Section 2.1, IoT devices are very often resource constrained and thus cannot always satisfy the requirements highlighted in Section 4. Figure 3 summarizes the possible roles of things\nand gateways with respect to blockchain integration. Things are hardly suited to directly speak to the blockchain due to their limits, and usually, with current technology, they just rely on a distinct (trusted) device or service to submit blockchain transactions on their behalf. If they are attached to the blockchain, they can at most play the role of a light node.\nIf the IoT architecture encompasses a nearby gateway or a server of a fog computing layer (see Section 2.1 for more details), these can be directly exploited to interface the blockchain, surely in the role of a light node and, in certain cases, even as a regular full node. In this case, a gateway or a server can be used by its nearby things not only for connecting to the Internet but also to submit blockchain transactions. In view of Figure 1, there are at least two fundamental use-cases to be supported regarding the interaction between IoT devices and the blockchain: a device should be able to interact with the blockchain (1) to perform payments and (2) to assess that a payment has been performed. Ideally, any device that has to perform these tasks should have access to the whole blockchain status (or history, depending on the technology). This is clearly unfeasible even for moderately powerful devices, such as, for example, mobile phones. To overcome this problem, light nodes adopt simplified payment verification, where Merkle proofs [31] are used as a means of verification of the information collected from untrusted nodes. However, even simply collecting and storing these proofs is still well above the power of many IoT devices. The work in [137] analyzes this problem and surveys results about different SPV implementations in the context of healthcare applications. It is worth mentioning a new technology, Mina [64], which offers an elegant solution using advanced cryptography and recursive zk-SNARKs to reduce the size of the blockchain to tens of KB (instead of hundreds of GB). Instead of verifying the entire chain from the beginning of time (full node), participants fully verify the network and transactions using recursive zero-knowledge proofs (or zk-SNARKs). Nodes can then store the small proof (of constant size), as opposed to the entire chain. While very promising, the Mina protocol can be considered still in its infancy. A more drastic solution that eases the adoption of very small IoT devices is to avoid having them store any proof. This means relying on an external centralized service to access the blockchain, which has to be considered trusted. An example of this approach is given by Helium [66]. While this may be considered secure enough for many applications, the introduction of a centralized element in the architecture has been regarded us unsatisfactory by some authors. For example, the INCUBED protocol [138] and other competing solutions [139,140] have the objective to provide very small devices with access to a blockchain without relying on a trusted third party.\nFigure 4 summarizes the possible relations between things and a blockchain."
        },
        {
            "heading": "7.3. Oracles: Interfacing the Blockchain with Off-Chain Data and Devices",
            "text": "Blockchains and smart contracts can only access data stored within the blockchain itself; on the contrary, IoT applications are ultimately designed to provide access to the physical world. This occurs, for example, in vehicle rentals [79,80], smart cars [75], and Industry Marketplace [78]. Blockchain technologies are designed to be deterministic, that is, when the whole transaction history is replayed it always ends up with the same results. Determinism is important so that blockchain nodes can come to a consensus [141]. If a smart contract requires accessing the measure of a smart meter, the value could differ from time to time, or even from place to place, causing nodes in the future, or without access to a certain site, to reach different conclusions about the state of the network, thus breaking the consensus. Oracles are components that allow a blockchain, or a smart contract, to get inputs from outside the blockchain. They inject data coming from outside the blockchain into regular blockchain transactions. In this way, they become part of the blockchain history and can be handled deterministically by all blockchain nodes. There are several oracle services providing APIs to allow smart contracts to access external data. Examples include Chainlink [142], Provable [143], BandChain [144], and Tellor [145]. Oracle functionalities can even be part of an IoT ecosystem. For example, in Helium [66], certain nodes of the network are in charge of providing information about the exchange ratio of the Helium native token to keep the service price constant (see Section 6). This is a form of special-purpose oracle included in an IoT ecosystem.\nOracles can be classified according to the following aspects.\nOrigin of off-chain data. There are software oracles and hardware oracles. A software oracle handles information data that originates from online sources, like the prices of commodities and goods, flight or train delays, and so on. Therefore, it extracts the needed information from an online resource and pushes it into the smart contract. Hardware oracles allow smart contracts to gather information directly from the physical world, for example, a car crossing a barrier where movement sensors must\ndetect the vehicle and send the data to a smart contract [75], or RFID sensors in the supply chain industry [78].\nInbound/outbound oracles. Inbound oracles pull in-chain data from the external world. Outbound oracles provide smart contracts with the ability to send data to the outside world. An example would be a smart lock in the physical world, which receives payment on its blockchain address and needs to unlock automatically.\nDegree of decentralization. Oracles can be centralized entities getting data from the off-chain world. However, using only one source of information could be risky and unreliable. For further security, a combination of different oracles may be used, where, for example, three out of five oracles could determine the outcome of an event. This combination of multiple oracles is called consensus-based oracles. ChainLink [142] and Tellor [145] are two examples of decentralized oracles. The special-purpose oracle of Helium mentioned above is consensus-based but has limited decentralization, since currently, only 11 fixed members can submit exchange ratio data (nine of them are anonymous for security reasons).\nFigure 5 summarizes two methods of interaction of an IoT device with the blockchain. The thing can autonomously initiate the interaction with a smart contract. In this case, it acts as the source of a \u201cstandard\u201d transaction invoking the smart contract; consequently, oracles are not necessary. If the thing is queried by the smart contract, oracles are required to guarantee the determinism and provide a consistent data view of the observed thing."
        },
        {
            "heading": "7.4. Transactions Throughput, Fees, and Sidechains",
            "text": "As already observed, scalability (i.e., supported transactions per second) is a major issue when blockchain is applied to the IoT. It easy to observe that most of the sample applications shown in Section 4 can scale to a huge number of devices and require very high transaction throughput. Bitcoin, the first blockchain, is able to sustain only a small number of transactions per second (about 7). A vast amount of literature is available on blockchain scalability [34,35,146]. Newer technologies may sustain even several thousands transactions per second. However, since in many applications we expect a large number of micropayments, depending on the application and on the size of the network, even the faster blockchain technology might represent a bottleneck that imposes a strong limit on the expansion of an IoT ecosystem. When resorting to a general-purpose public blockchain network, this problem is exacerbated by the fact that the blockchain is shared with a plethora of users that are unrelated\nwith our IoT application. For optimal functioning of the blockchain, they collectively have to generate a frequency of transactions below the maximum blockchain throughput. Since resources of a publicly shared blockchain are scarce, and they are paid by users, the price users (or things) pay for their transactions is governed by the law of supply and demand. When the demand of transactions is close to the maximum transaction throughput, the nodes of the blockchain start picking transactions to be included in the next block, favoring those that pay more. For the most successful blockchains, this has led to very high transaction fees [147]. Further, the actual transaction cost depends on the exchange rate of the blockchain native token with respect to fiat currency, which may greatly vary over time. Certain unpermissioned blockchains have overcome this problem by proposing an approach in which transactions are feeless. Some of them are EOS [38], Nano [43], and IOTA [41]. They achieve this result by different approaches: moving the cost onto developers (EOS), asking for the users to participate in transaction confirmation (IOTA), and assuming operators of nodes have other interests beyond fees (Nano). Other approaches achieve low fees for most transactions (e.g., NEO [148]). However, even in those cases, scalability limits remain. One solution to this problem is the adoption of sidechains, namely secondary blockchains connected to the main one, with a mechanism that allows bidirectional transfer of assets between the two chains. Sidechains may have their own consensus protocols specifically designed to improve scalability and interact programmatically [149] with the mainchain to provide the highest security guarantees and take advantage of well-reputed tokens and technologies. Communication between the sidechain and mainchain are governed by a protocol that has to be realized with smart contracts and off-chain devices. A large number of proposals of protocols and technologies are available in the literature and as open projects [150\u2013154]. Some IoT-specific contributions regarding sidechains are also present in literature [155\u2013158]. In any case, it is important to note that, at the time of writing, current blockchain technologies do not provide higher transactions throughput when the number of nodes increases. This means that any blockchain imposes an upper bound on the frequency of transactions that can be processed; hence, it is important to choose the blockchain technology in accordance with the growth plans of the IoT network. In certain cases, it is possible to adopt special high-transactions-throughput solutions for payment transactions based on payment channels (see Section 7.5)."
        },
        {
            "heading": "7.5. State and Payment Channels",
            "text": "In certain IoT applications, the problem of limited maximum transactions throughput of blockchain technologies (see Section 7.4) can be effectively tackled with the adoption of the so-called payment channels. A typical problem is charging for the use of a service on the basis of how much it is used and doing that continuously while the service is running. This was initially considered for incremental payment of video streaming, but the problem is relevant in typical IoT applications, such as vehicle renting [79,80]. Payment channels are one of the main ideas behind micropayment off-chain solutions, such as the Lightning Network [56]. In a payment channel, two entities (nodes or IoT devices), which are supposed to make a large number of small payments, agree to stake an amount of tokens to guarantee that they behave correctly in managing all micropayments off-chain. The blockchain is used when the channel is opened and the two parties stake their funds, and when the channel is closed and actual settlement is performed. Each micropayment is executed off-chain by exchanging partially signed transactions that commit each party to the new value of the settlement. These transactions are supposed not to be submitted for acceptance in the blockchain unless one of the two parties misbehaves and the channel has to be closed unilaterally, freezing the current balance. The complete technical details of this approach are very clearly explained in [159], and the performance of the Lighting Network in terms of efficiency and fee reduction are optimized for the IoT ecosystem in [9].\nThe technique can be extended to any kind of state change, and in this case, channels are more properly called state channels. Payment channels are extremely convenient since transactions are not limited by the maximum throughput of the blockchain but only by network and hardware limits. Fees are not paid for each economic transaction, but only for opening and closing transactions, which makes the adoption of a general-purpose unpermissioned blockchain much safer. In any case, the same technique can be used also in dedicated blockchains. This is the approach of Helium [66], in which payments of the Helium packet-forwarding service are performed using payment channels where the corresponding open and closing transactions are submitted on the Helium dedicated chain."
        },
        {
            "heading": "7.6. Smart Contracts",
            "text": "One of the fundamental aspects of the blockchain is that it allows the realization of automatic behavior, which usually bring some financial effect, without relying on a trusted centralized third party. This has opened the possibility of realizing automatic versions of well-known economic mechanisms or creating new ones that can exist only in a blockchainbased economic environment. Some of the most relevant, for the IoT contexts, are discussed in Section 6. All blockchains provide a consensus mechanism to accept and order transactions (see Section 2.2). In principle, transactions may be limited to the simple creation and transfer of tokens. However, the need for more complex transactions was quickly recognized (see Section 6). In general, when designing a blockchain, there is great flexibility in the kind of transaction that can be realized. However, at least for general-purpose blockchains, the spectrum of possible useful kinds of transactions is so wide that it is impossible to realize, natively, all possible kinds of transactions. For this reason, almost all general-purpose blockchains (starting from Bitcoin) have some form of scripting language that allows the user to adapt the rules to accept transactions according to his/her needs. In general, we define a smart contract as software that runs in a decentralized manner on a blockchain, allowing the developer to customize the rules according to which the transaction should be accepted. With the introduction of Ethereum [37], smart contracts acquired enough power and flexibility to allow very general applications: transactions can invoke smart contracts, smart contracts can record data to be used in subsequent invocations (i.e., they have a state), and the application logic can manage funds that are under the control of the smart contract (see, for example, Solidity [160]). While this flexibility is very appealing, it is worth noting that it has a significant cost. In fact, smart contracts require a very controlled execution environment (a so-called virtual machine (e.g., see [161])) that impacts on the efficiency of their execution. Further, the development of smart contracts has been recognized to be quite critical from the security point of view [162], in the sense that it is hard to code safe smart contracts. Given this difficulty and the fact that smart contracts may control large amounts of tokens (i.e., money), they are among the preferred targets of hacking activities. As an example, the Helium project encompasses an ad hoc blockchain that does not support smart contracts. Its very specific functionalities are hardcoded in the helium software."
        },
        {
            "heading": "7.7. Consensus Mechanisms Based on Physical Properties",
            "text": "While this paper is mostly focused on the advantages that blockchain can provide to IoT ecosystems, there is also an interesting advantage in the opposite direction. In fact, in an unpermissioned blockchain, the way in which the consensus on the next block is achieved is extremely critical for the security of the whole system. The main problem is that a simple vote-based approach is insecure. In fact, for an attacker, it is easy to emulate a large number of nodes (an approach known as Sybil attack) to obtain the majority in a decision. For this reason, it has to require some effort to participate in the consensus. In regular blockchains, the most famous approaches to this problem are the so-called proof-of-work, in which participants have to prove that they have solved a cryptographic puzzle, and\nproof-of-stake, in which participants have to prove that have staked (i.e., frozen for a certain amount of time) a certain amount of tokens (see also Section 6). A special-pupose blockchain in an IoT ecosystem can take advantage of the physical existence of IoT devices to obtain a high level of security while asking participants to perform some work that is useful for the ecosystem. For example, in Helium [67], consensus security is based on a so-called proof-of-coverage. In this approach, participants regularly challenge hot-spots to assess their coverage of a certain area. This kind of work cannot be easily scaled programmatically, since physical presence near the hot-spot is required. At the same time, this monitoring activity is reported to the users as valuable information about areas covered by the Helium network [163]. Certain constraints or tasks that are available in an IoT ecosystem can be used to create special-purpose consensus mechanisms. In our opinion, this is an aspect that is underutilized. For example, SolarCoin [74] encompasses the concept of verified energy production; however, this concept is not exploited for consensus. Other approaches based on physical properties were proposed in the literature and are candidates to be used in IoT ecosystems; see, for example, [164,165] and the surveys [166,167]."
        },
        {
            "heading": "8. Conclusions and Open Problems",
            "text": "We surveyed the relevant architectural aspects of blockchain\u2013IoT integration for the IoT-based economy. In particular, we focused on the adoption of unpermissioned blockchains that enable decentralized architectures.\nOur analysis can be summarized as follows.\n\u2022 The blockchain technology enables payments and several other financial tools in a decentralized way, which may be very relevant for IoT ecosystems. We listed a number of IoT projects and functioning ecosystems that are based on blockchain technologies to support payments and other economic aspects (like tuning a service price to compensate for exchange rate fluctuations). \u2022 A wide range of IoT applications require the blockchain to support a high transaction throughput, which usually depends on the amount of smart devices deployed. On the contrary, in current blockchain technology, the maximum transaction throughput does not increase when new nodes are added. This require a careful planning, and/or design, to avoid the risk of the blockchain being a choke point in the development of an IoT network. However, approaches such as sidechains, payment channels, or dedicated blockchains may mitigate this problem. \u2022 The landscape of the projects that exploit blockchain capabilities to support the IoTbased economy has currently only a few highlights. In our opinion, currently, the most interesting projects are Helium [66] and Power Ledger [77] for their integrated approach, their ambitious goals, and the degree of development. We found promising projects that are, however, currently only starting; some adopt a simple and old approach, and others are run by a single company with a centralized approach.\nThe analysis carried out in this paper led us to recognize the following problems that are relevant and, in our opinion, if successfully addressed, can ease the adoption of blockchain in an IoT ecosystem as payment enabler.\n\u2022 The IoT\u2013blockchain integration has many problems and many opportunities. From the projects we analyzed, we understand that, currently, a regular blockchain is very often adopted, overlooking problems (mostly those that are scalability-related) and not exploiting opportunities (especially those related to new economic/financial tools enabled by the blockchain). We think there are two reasons for this: (1) lack of comprehensive information on the topic and (2) difficulty in realizing the needed solutions from current available technology elements. \u2022 Regular blockchains are quite general but may not be very well suited for IoT integration. In particular, the main concerns are scalability, transaction cost, possibly\nunneeded functionalities (such as smart contracts), and the general requirements of quite powerful hardware to run a regular node. On the other hand, we understand that a project may not have resources and/or expertise to develop an ad hoc blockchain for its own ecosystem from scratch.\nWith respect to the second item, it is interesting to note that most of the listed concerns are likely to be of interest to most IoT projects that aim to scale to a large number of devices and transactions. From the above considerations, there are some research directions that can be suggested. The following are those that we think may be more valuable to pursue to ease adoption of blockchain as an IoT economy enabler.\n\u2022 Devise a methodology to guide IoT ecosystem designers to exploit the blockchainbased financial tools and the available blockchain architecture alternatives. \u2022 Develop an open-software low-footprint easily customizable blockchain to be used as unpermissioned ad hoc blockchain in an IoT ecosystem. This would ease the blockchain adoption in new IoT ecosystems at low cost without introducing a dependency on any general-purpose blockchain. \u2022 Evolve the blockchain state of the art toward scalable models that can be adopted in IoT ecosystems.\nAuthor Contributions: All authors contributed equally to the manuscript. All authors have read and agreed to the published version of the manuscript.\nFunding: This research was partially funded by Sapienza Ateneo Research grant \u201cLa disintermediazione della Pubblica Amministrazione: il ruolo della tecnologia blockchain e le sue implicazioni nei processi e nei ruoli della PA\u201dThis research was partially funded by POR FESR LAZIO 2014\u20132020, call for \u201cGruppi di ricerca 2020\u201d. Det. n. G04052 of 4 April 2019, under the \u201cLazioChain\u201d project, CUP F85F21001550009 - POR project code A0375E0116.\nInstitutional Review Board Statement: Not applicable.\nInformed Consent Statement: Not applicable.\nData Availability Statement: Not applicable.\nConflicts of Interest: The authors declare no conflict of interest."
        }
    ],
    "title": "Blockchain as IoT Economy Enabler: A Review of Architectural Aspects",
    "year": 2022
}