{
    "abstractText": "There is an increasing interest in Quantum Machine Learning (QML) models, how they work and for which applications they could be useful. There have been many different proposals on how classical data can be encoded and what circuit ans\u00e4tze and measurement operators should be used to process the encoded data and measure the output state of an ansatz. The choice of the aforementioned operators plays a determinant role in the expressive power of the QML model. In this work we investigate how certain changes in the circuit structure change this expressivity. We introduce both numerical and analytical tools to explore the effect that these operators have in the overall performance of the QML model. These tools are based on previous work on the teacher-student scheme, the partial Fourier series and the averaged operator size. We focus our analysis on simple QML models with two and three qubits and observe that increasing the number of parameterized and entangling gates leads to a more expressive model for certain circuit structures. Also, on which qubit the measurement is performed affects the type of functions that QML models could learn. This work sketches the determinant role that the processing and measurement operators have on the expressive power of simple quantum circuits.",
    "authors": [
        {
            "affiliations": [],
            "name": "Aikaterini (Katerina"
        },
        {
            "affiliations": [],
            "name": "Patrick Huembeli"
        }
    ],
    "id": "SP:0c0ddec157703aeb1924903b5aa45daf54d03898",
    "references": [
        {
            "authors": [
                "A. Dawid",
                "J. Arnold",
                "B. Requena",
                "A. Gresch",
                "M. P\u0142odzie\u0144",
                "K. Donatella",
                "K. Nicoli",
                "P. Stornati",
                "R. Koch",
                "M. B\u00fcttner",
                "R. Oku\u0142a",
                "G. Mu\u00f1oz-Gil",
                "R.A. Vargas-Hern\u00e1ndez",
                "A. Cervera- Lierta",
                "J. Carrasquilla",
                "V. Dunjko",
                "M. Gabri\u00e9",
                "P. Huembeli"
            ],
            "title": "E",
            "venue": "van Nieuwenburg, F. Vicentini, L. Wang, S. J. Wetzel, G. Carleo, E. Greplov\u00e1, R. Krems, F. Marquardt, M. Tomza, M. Lewenstein, and A. Dauphin, \u201cModern applications of machine learning in quantum sciences,\u201d ",
            "year": 2022
        },
        {
            "authors": [
                "K. Gili",
                "M. Mauri"
            ],
            "title": "and A",
            "venue": "Perdomo-Ortiz, ",
            "year": 2022
        },
        {
            "authors": [
                "S. Sim",
                "P.D. Johnson",
                "A. Aspuru-Guzik"
            ],
            "title": "Advanced Quantum Technologies 2",
            "venue": "1900070 ",
            "year": 2019
        },
        {
            "authors": [
                "A. Gratsea",
                "V. Kasper"
            ],
            "title": "and M",
            "venue": "Lewenstein, ",
            "year": 2021
        },
        {
            "authors": [
                "A. P\u00e9rez-Salinas",
                "A. Cervera-Lierta",
                "E. Gil-Fuster",
                "J.I. Latorre"
            ],
            "title": "Quantum 4",
            "venue": "226 ",
            "year": 2020
        },
        {
            "authors": [
                "M. Lewenstein",
                "A. Gratsea",
                "A. Riera-Campeny",
                "A. Aloy",
                "V. Kasper",
                "A. Sanpera"
            ],
            "title": "Quantum Science and Technology 6",
            "venue": "045002 ",
            "year": 2021
        },
        {
            "authors": [
                "D. Heimann",
                "G. Sch\u00f6nhoff"
            ],
            "title": "and F",
            "venue": "Kirchner, ",
            "year": 2022
        },
        {
            "authors": [
                "M. Schuld",
                "R. Sweke"
            ],
            "title": "and J",
            "venue": "J. Meyer, \u201cThe effect of data encoding on the expressive power of variational quantum machine learning models,\u201d ",
            "year": 2020
        },
        {
            "authors": [
                "H.-Y. Huang",
                "M. Broughton",
                "M. Mohseni",
                "R. Babbush",
                "S. Boixo",
                "H. Neven"
            ],
            "title": "and J",
            "venue": "R. McClean, \u201cPower of data in quantum machine learning,\u201d ",
            "year": 2020
        },
        {
            "authors": [
                "M. Ostaszewski",
                "E. Grant",
                "M. Benedetti"
            ],
            "title": "Quantum 5",
            "venue": "391 ",
            "year": 2021
        },
        {
            "authors": [
                "Y. Du",
                "M.-H. Hsieh",
                "T. Liu",
                "D. Tao"
            ],
            "title": "Phys",
            "venue": "Rev. Research 2, 033125 ",
            "year": 2020
        },
        {
            "authors": [
                "N. Moll",
                "P. Barkoutsos",
                "L.S. Bishop",
                "J.M. Chow",
                "A. Cross",
                "D.J. Egger",
                "S. Filipp",
                "A. Fuhrer",
                "J.M. Gambetta",
                "M. Ganzhorn",
                "A. Kandala",
                "A. Mezzacapo",
                "P. M\u00fcller",
                "W. Riess",
                "G. Salis",
                "J. Smolin",
                "I. Tavernelli",
                "K. Temme"
            ],
            "title": "Quantum Science and Technology 3",
            "venue": "030503 ",
            "year": 2018
        },
        {
            "authors": [
                "Y. Wu",
                "P. Zhang"
            ],
            "title": "and H",
            "venue": "Zhai, Physical Review Research 3 ",
            "year": 2021
        },
        {
            "authors": [
                "A. Abbas",
                "D. Sutter",
                "C. Zoufal",
                "A. Lucchi",
                "A. Figalli",
                "S. Woerner"
            ],
            "title": "Nature Computational Science 1",
            "venue": "403 ",
            "year": 2021
        },
        {
            "authors": [
                "L. Bishop",
                "S. Bravyi",
                "A.W. Cross",
                "J.M. Gambetta"
            ],
            "title": "J",
            "venue": "A. Smolin, and March ",
            "year": 2017
        },
        {
            "authors": [
                "Y. Cao",
                "J. Romero",
                "J.P. Olson",
                "M. Degroote",
                "P.D. Johnson",
                "M. Kieferov\u00e1",
                "I.D. Kivlichan",
                "T. Menke",
                "B. Peropadre",
                "N.P.D. Sawaya",
                "S. Sim",
                "L. Veis",
                "A. Aspuru-Guzik"
            ],
            "title": "Chemical Reviews 119",
            "venue": "10856 ",
            "year": 2019
        },
        {
            "authors": [
                "A. Kandala",
                "A. Mezzacapo",
                "K. Temme",
                "M. Takita",
                "M. Brink",
                "J.M. Chow",
                "J.M. Gambetta"
            ],
            "title": "Nature 549",
            "venue": "242 ",
            "year": 2017
        },
        {
            "authors": [
                "J.J. Meyer",
                "M. Mularski",
                "E. Gil-Fuster",
                "A.A. Mele",
                "F. Arzani",
                "A. Wilms"
            ],
            "title": "and J",
            "venue": "Eisert, \u201cExploiting symmetry in variational quantum machine learning,\u201d ",
            "year": 2022
        },
        {
            "authors": [
                "H.R. Grimsley",
                "S.E. Economou",
                "E. Barnes"
            ],
            "title": "and N",
            "venue": "J. Mayhall, Nature Communications 10 ",
            "year": 2019
        },
        {
            "authors": [
                "A. Peruzzo",
                "J. McClean",
                "P. Shadbolt",
                "M.-H. Yung",
                "X.-Q. Zhou",
                "P.J. Love",
                "A. Aspuru-Guzik"
            ],
            "title": "and J",
            "venue": "L. O\u2019Brien, Nature Communications 5 ",
            "year": 2014
        },
        {
            "authors": [
                "K. Mitarai",
                "M. Negoro",
                "M. Kitagawa",
                "K. Fujii"
            ],
            "title": "Phys",
            "venue": "Rev. A 98, 032309 ",
            "year": 2018
        },
        {
            "authors": [
                "M. Schuld",
                "A. Bocharov",
                "K.M. Svore",
                "N. Wiebe"
            ],
            "title": "Phys",
            "venue": "Rev. A 101, 032308 ",
            "year": 2020
        },
        {
            "authors": [
                "H.L. Tang",
                "V. Shkolnikov",
                "G.S. Barron",
                "H.R. Grimsley",
                "N.J. Mayhall",
                "E. Barnes"
            ],
            "title": "and S",
            "venue": "E. Economou, PRX Quantum 2 ",
            "year": 2021
        },
        {
            "authors": [
                "M. Benedetti",
                "D. Garcia-Pintos",
                "O. Perdomo",
                "V. Leyton-Ortega",
                "Y. Nam"
            ],
            "title": "and A",
            "venue": "Perdomo-Ortiz, npj Quantum Information 5 ",
            "year": 2019
        },
        {
            "authors": [
                "H. Shen",
                "P. Zhang",
                "Y.-Z. You",
                "H. Zhai"
            ],
            "title": "Phys",
            "venue": "Rev. Lett. 124, 200504 ",
            "year": 2020
        },
        {
            "authors": [
                "A. Nahum",
                "S. Vijay"
            ],
            "title": "and J",
            "venue": "Haah, Physical Review X 8 ",
            "year": 2018
        },
        {
            "authors": [
                "D.A. Roberts",
                "D. Stanford",
                "A. Streicher"
            ],
            "title": "Journal of High Energy Physics 2018 (2018)",
            "venue": "10.1007/jhep06",
            "year": 2018
        },
        {
            "authors": [
                "M.A. Nielsen",
                "I.L. Chuang"
            ],
            "title": "Quantum computation and quantum information: 10th anniversary edition,",
            "year": 2011
        },
        {
            "authors": [
                "M. Schuld"
            ],
            "title": "Quantum machine learning models are kernel methods,",
            "year": 2021
        },
        {
            "authors": [
                "S. Jerbi",
                "L.J. Fiderer",
                "H.P. Nautrup",
                "J.M. K\u00fcbler",
                "H.J. Briegel"
            ],
            "title": "and V",
            "venue": "Dunjko, \u201cQuantum machine learning beyond kernel methods,\u201d ",
            "year": 2021
        },
        {
            "authors": [
                "J. Haferkamp",
                "P. Faist",
                "N.B.T. Kothakonda",
                "J. Eisert",
                "N.Y. Halpern"
            ],
            "title": "Nature Physics 18",
            "venue": "528 ",
            "year": 2022
        },
        {
            "authors": [
                "V. Bergholm",
                "J. Izaac",
                "M. Schuld",
                "C. Gogolin",
                "M.S. Alam",
                "S. Ahmed",
                "J.M. Arrazola",
                "C. Blank",
                "A. Delgado"
            ],
            "title": "S",
            "venue": "Jahangiri, et al., arXiv preprint arXiv:1811.04968 ",
            "year": 2018
        }
    ],
    "sections": [
        {
            "heading": "1. INTRODUCTION",
            "text": "In recent years, there is increasing interest in the capabilities of Quantum Machine Learning (QML) models and their potential applications. To better understand for what tasks a QML model could be potentially used for [1], we first need to understand where its strengths and weaknesses lie [2\u201311]. A first step to better understand what a QML model is capable of, is to study its expressivity. It has been shown that a specific quantum circuit architecture can be used as a universal function approximator [8], i.e. it can approximate any classification function up to arbitrary precision. The work of [12] further sheds light on how the encoding of the data fundamentally limits the expressivity of quantum models. It also verifies that parameterized QML models with arbitrary single rotations and entangling gates give rise to complex trigonometric functions [12, 13].\nInstead of focusing on the data encoding, other works study the importance of the trainable part of the quantum circuits (consisting of data independent but parameterized gates) to which we refer to as the processing part of the circuit. For example, in [14], the authors perform a structure optimization that aims to find a more hardware efficient architecture for the desired problem. Finally, recent works focus on benchmarking different circuit structures both numerically [5, 7, 15, 16] and theoretically [6, 17\u201319].\nHow to choose an ansatz for a supervised QML task is still an open question. Circuit ansa\u0308tze that are used to find ground states in quantum chemistry [20] or many-body physics are often inspired by the problem itself [21\u201323] and some understanding of the optimization problem at hand can help to find a well-suited ansatz [14, 24]. For QML applications this does not apply in general [25\u201328] which might partially be because we still do not fully understand how specific parts of\n\u2217 gratsea.katerina@gmail.com\nthe processing and measurement operators affect the performance of the QML model. Moreover, even for small quantum circuits with a few number of qubits, there are still some open questions: \u201dHow many parameterized gates should be used?\u201d, \u201dHow many entangling gates and where?\u201d, \u201dWhere should the circuit be measured?\u201d and \u201dDo ancilla qubits help improve the expressivity of the circuit?\u201d.\nInspired by these questions, we aim to study the effect of the processing part of QML architectures. We believe that the structure of the processing and measurement operators play a determinant role in the QML model performance. Here the term performance characterizes the model\u2019s ability to learn through training [29], the type of functions that it can express [12] and its scrambling capability [17, 30], i.e. extracting information from the input state to the readout qubit.\nWe use both analytical and numerical tools to explore how the processing unitaries and measurement affect the properties of a QML model. We focus our analysis on simple quantum models with just 2-3 qubits, which help us better understand how different parts of the processing and measurement operators affect the performance. This analysis allows us to understand how the processing architecture affects the expressivity of the whole model, at least for circuits with small amounts of qubits, with the hope to draw insights on how specific parts will affect the performance of more complicated architectures with more qubits. We observe that increasing the number of parameterized and entangling gates leads to a more expressive model for certain circuit structures and that ancillary qubits help increasing the expressive power of the model. Finally, applying the measurement on certain qubits changes the classes of functions that QML models can learn.\nThe paper is structured as follows. In section 2, we introduce the analytical and numerical tools discussed in this work. In section 3, we apply these tools to analyze the performance of two simple quantum models. In section 3 3.3, we discuss that regarding the processing and measurement operator as a single unit could give insights on the performance of the QML models. Finally, in Section 5, we summarize the importance\nar X\niv :2\n21 1.\n03 10\n1v 1\n[ qu\nan t-\nph ]\n6 N\nov 2\n02 2\n2 of the non-encoding unitaries and the effect they have on the expressive power of quantum models."
        },
        {
            "heading": "2. TOOLS FOR ANALYSING QML MODELS",
            "text": "We study quantum circuits that consist of three parts: the encoding unitaries S (x), the processing gates U\u03b8 (consisting of data independent but parameterized gates) and the measurement operator M . The building blocks of such arbitrary quantum circuits are shown in Fig. 1. Throughout this work,\nwe focus on supervised learning tasks with a given data set D = {(xk, yk)}, where the input data xk are encoded by S ( xk )\nand yk are the labels given by the measurement outcome. The initial state is |0\u3009\u2297N , where N is the number of qubits. As shown in Fig.1, we first apply the encoding unitary S (x) (yellow), then the processing U\u03b8 (blue) and finally the measurement operator M (green).\nIn this section, we focus on two theoretical tools for characterizing the performance of QML models, i.e. the averaged operator size [17] and the Fourier representation [12]. These methods give us quantitative results on the effect of the processing and measurement operators (blue parameterized unitary and green operator in Fig.1). We also employ an extended version of the teacher-student scheme discussed in [7] to quantify differences in the prediction maps numerically, i.e. the density plots of the model predictions or labels yk for the input data xk."
        },
        {
            "heading": "2.1. Averaged operator size",
            "text": "In the works [17, 31, 32], the authors introduce related quantities to characterize quantum information scrambling, i.e. extracting information from the input state S(x)|0\u3009 to the readout qubit. In the work of [17], the authors propose the averaged operator size - a quantity that depends on the circuit architecture, the processing and the measurement operators. Moreover, its value is positively correlated with the learning efficiency of the QNN architecture.\nTo calculate the averaged operator size of an arbitrary operator O\u0302, we decompose it into a summation of a Pauli strings,\nwhich can be done for any Hermitian operator [33]. Such a decomposition has the form\nO\u0302 = \u2211 \u03b1 c\u03b1\u03c3\u0302 1 \u03b11 \u2297 \u03c3\u0302 2 \u03b12 \u00b7 \u00b7 \u00b7 \u2297 \u03c3\u0302 n \u03b1n , (1)\nwhere \u03c3\u0302i\u03b1i for \u03b1i \u2208 {0, 1, 2, 3} define the Pauli operators including the identity acting on qubit i. The coefficients c\u03b1 can be computed by\nc\u03b1 = 1 2n Tr ( O\u03c3\u03021\u03b11 \u2297 \u03c3\u0302 2 \u03b12 \u00b7 \u00b7 \u00b7 \u2297 \u03c3\u0302 n \u03b1n ) . (2)\nThe operator size of a Hermitian operator O\u0302 is given by Size(O\u0302) = \u2211 \u03b1 |c\u03b1|2 l(\u03b1), (3)\nwhere c\u03b1 are the coefficients of decomposition in Eq. (1) and l(\u03b1) counts the number of non-identity matrices in each Kronecker product in the summation given by the same equation. In our case, the hermitian operator O\u0302 = U\u0302\u03b8 \u2020 M\u0302 U\u0302\u03b8 depends only on the processing unitary U\u03b8 and the measurement M operators.\nTo obtain the averaged operator size for a given circuit architecture U\u03b8 and a fixed measurement M , we take the average over Haar random unitaries U\u03b8\nSize = \u222b dU\u0302\u03b8 Size ( U\u0302\u03b8 \u2020 M\u0302U\u0302\u03b8 ) . (4)\nA larger value of the average operator size suggests a more expressive circuit structure [17]."
        },
        {
            "heading": "2.2. Map differencies from teacher-student scheme",
            "text": "The teacher student scheme employed in [7] can be used to compare the expressivity of different QML circuit architectures. The main idea is that alternately one circuit plays the role of the teacher and the other one of the student. A randomly initialized teacher circuit maps the input data {xk} to labels yk that are to be learned by the student, and then, the roles are reversed. To compare their performances in the original work [7], three different quantitative scores were considered: the accuracy score, the (average) loss and the relative entropy and the prediction maps for a more qualitative overview. Here, we add another score to the TS scheme that directly compares differences between prediction maps which allows us to better quantify them. Specifically, we compute the average of the differences between the prediction maps of the teacher and student\n\u2206y = 1\np p\u2211 k |ykT \u2212 ykS |, (5)\nwhere {ykT } are the generated labels from the teacher and {ykS} the learned labels of the student where k runs over all points p of a given input dataset {xk}. Also, ykT , ykS take continuous values in [\u22121, 1], but for the calculation of the \u2206y\n3\nwe re-scale them to be in [0, 1]. We can present the \u2206y as a percentage difference between the two studied models. This allows us directly to compare how similar the prediction maps of the two models are. It is a quantitative measure of how well the student can learn the teacher, i.e. a \u2206y equal to zero suggests that the student learns the teacher perfectly, while high values for \u2206y indicate that the student is not able to learn the labeling provided by the teacher."
        },
        {
            "heading": "2.3. The representation of quantum models with partial Fourier series",
            "text": "In the work of [12], the authors explore how the data encoding influences the class of functions that a quantum model can learn. Circuit architectures employed in supervised tasks with multiple encoding unitaries on different qubit can be mapped to a partial multivariate Fourier series\nf\u03b8(x) = \u2211 j \u2211 k cjke ix\u00b7(\u03bbk\u2212\u03bbj), (6)\nwhere j, k \u2208 [ 2d ]N\nwith N the number of qubits and d is the dimension of an encoding gate, i.e. d = 1 if it is a single qubit gate. As it is explained in the original work, the frequency spectrum determines the functions that the quantum model could express, while the coefficients cjk determine how the accessible functions can be combined.\nThe number of Fourier basis functions is solely determined by the eigenvalues of the data-encoding Hamiltonians. This means that repeated data encoding gives rise to a larger frequency spectrum \u2126 and more complicated function classes. The processing and the measurement of the circuit determine the coefficients, and therefore, how the accessible functions can be combined. Inspired by the work of [12], in Section 3 3.3, we study how the processing and measurement operators of simple quantum circuits affect the coefficients, and therefore, the final function classes that these quantum circuits \u201dhas access to\u201d. This analysis sheds light on how individual elements of the processing and measurement architecture affect the function classes that the quantum model can express."
        },
        {
            "heading": "3. SIMPLE QUANTUM MODELS",
            "text": "In this section, we apply the tools described in the Section 2 on two simple quantum models shown in Fig. 2. We use a two dimensional input data set with xk = (xk1 , x k 2) and encode it to the circuit with the gates S(x) = Rx(x1)\u2297Rx(x2) applied on two distinct qubits, where Rx(\u03c6) = exp(\u2212i\u03c6\u03c3x/2) is the single qubit X rotation gate. These data encoding gates are depicted in light and dark orange colors respectively in the circuit diagrams. The blue gates represent the parameterized single qubit rotations Rot(\u03c6, \u03b8, \u03c9) = Rz(\u03c9)Ry(\u03b8)Rz(\u03c6). The predictions take continuous values yk \u2208 [\u22121, 1] given by the outcome of the measurement \u3008\u03c8k|Z |\u03c8k\u3009, where |\u03c8k\u3009 = U\u03b8S(x) |0\u3009\u2297N ."
        },
        {
            "heading": "3.1. Averaged operator size of simple quantum models",
            "text": "We compute the averaged operator size of Eq. (4) for the 2- qubit and 3-qubit circuits of Fig. 2 by taking the average over the Haar random unitaries for the parameterized single qubit unitaries depicted with blue color. For the numerical simulation we use a Monte-Carlo integration [34] introduced in the Appendix A. In Fig.3, we plot the averaged operator size as a function of the number of parameterized gates. The error bars are the standard deviation from the mean value. We increase the number of parameterized gates by adding a layer L with two arbitrary single qubit gates (blues color) and an a CNOT entangling gate, L = CNOTRot(\u03c6, \u03b8, \u03c9) \u2297 Rot(\u03c6\u2032, \u03b8\u2032, \u03c9\u2032). We stress here that the 3-qubit circuit always has a Toffoli gate before the measurement operator.\nThe average operator size for the 2-qubit case has approximately the same value around 1.60 independent of the number of gates used (see blue solid line of Fig. 3). The drop observed from two to four parameterized gates is small while the error is large. Therefore, this suggests that for the 2-qubit case the performance is approximately the same as we increase the number of parameterized gates. On the contrary, for the 3- qubit case, the averaged operator size significantly increases once we move from two to four parameterized gates, and afterwards, reaches a plateau. These results already suggest that the 3-qubit case performs better than the 2-qubit case, i.e. the circuit structure of the processing and measurement operator is more expressive.\nNext, we focus on the maximum value of the operator size, which corresponds to specific values of the parameterized angles that give the best possible performance of this circuit structure (represented with the dashed line in Fig. 3). From the dashed lines in Fig. 3, we see that for both circuits the maximum value of the operator size is equal to 2 for the circuits with two parameterized gates. As we increase the number of parameterized (and entangling gates), the maximum value of the operator size is increased for the 3-qubit, but quickly reaches a plateau. Once again, these results suggest that the 3-qubit circuit structure is more expressive than the 2-qubit.\n4 2 4 6 8 Number of parameterized gates 1.4 1.6 1.8 2.0 2.2 2.4 O p er at or S iz e max value of Size for 2 qubits max value of Size for 3 qubits Size for 2 qubits Size for 3 qubits\nFIG. 3. We plot the averaged operator sizes defined in Eq.(4) and their standard deviation as we increase the number of parameterized and entangling gates. The orange and blue solid lines are for the MC simulation of 2 and 3 qubits, respectively. The dashed orange and blue solid lines give the maximum value that each operator size could get for a given number of parameterized and entangling gates of 2 and 3 qubits, respectively. These results suggest that the 3-qubit circuit architecture is more expressive than the 2-qubit."
        },
        {
            "heading": "3.2. Teacher-student scheme",
            "text": "To further analyze the expressive power of the two models in Fig. 2, we employ the Teacher-student scheme introduced in Section 2 2.2. The analysis of the differences \u2206y of the prediction maps validates the results from the average operator size in the previous section.\nWe compute the \u2206y defined in Eq. 5 and see that on average both students are approximately 30% off from the desired target distributions of their teachers. An example of the prediction maps are shown in Fig. 10 in the Appendix B, which suggests that the student learns pretty much uncorrelated labeling. These results are in accordance with the results from the averaged operator size of Fig. 3 for two parameterized gates in the sense that both of them have similar values for their averaged operator size, i.e. 2 and approximately 1.7 for the 2-qubit and 3-qubit students, respectively.\nNext, we increase the number of parameterized (and entangling gates) by adding a layer L and present the results in Fig. 4. We see a significant improvement in performance by increasing the parameterized gates from 2 to 4 for the 3-qubit student. This means that it can learn more reliably the labeling provided by the 2-qubit teacher. On the contrary, the 2-qubit student has almost a constant \u2206y for any amount of parameterized gates which suggests that it can\u2019t improve and learn more reliably the 3-qubit teacher\u2019s outputs.\nTo obtain these results we used a dataset of 500 points on\na 2D grid with xi \u2208 [\u2212\u03c0, \u03c0] on a grid and we generated 100 different labelings via different random initalizations of the teacher. The students are as well randomly initiallized and trained until convergence. These results are in agreement with the calculations from the averaged operator size of the previous subsection 3 3.1. In both cases, for the 3-qubit circuit, we observe an improvement in performance as we increase the number of parameterized gates. Finally, we quickly reach a plateau in performance as we increase further the number of gates as it is also observed in the analysis of the averaged operator size.\n2 4 6 8 Number of parameterized gates\n10\n15\n20\n25\n30\n\u2206 y\n(% )\nstudent with 2 qubits\nstudent with 3 qubits\nFIG. 4. We plot the average of the differences between the prediction maps of the teacher and student defined in Eq.(4) as we increase the number of parameterized and entangling gates for the simple circuits shown in Fig.2. The blue line is for the Teacher with 3 qubits and the student with 2, while the orange line is for the opposite case."
        },
        {
            "heading": "3.3. The type of functions that simple quantum models learn",
            "text": "The results from the previous two subsections { 3 3.1 3 3.2} suggest that simple changes in the structure of the circuit highly affects the average operator size and \u2206y, i.e. the learning capability and expressive power of the models. Therefore, the number of parameterized (and entangling) gates, the circuit architecture and the number of (ancilla) qubits play an important role in QML model\u2019s performance. To further analyze the effect of the processing and measurement operators on the expressive power of the models, we use the representation of quantum models as partial Fourier series introduced in subsection 2 2.3.\nThe Fourier coefficients defined in Eq.6 are determined by the eigenvalues of the data-encoding Hamiltonians. For example, the data-encoding Hamiltonian for each qubit from the circuits of Fig. 2 isH = 1\n2 \u03c3x and we can assume without loss\nof generality that it has two distinct eigenvalues, i.e. \u03bb1 = \u22121, \u03bb2 = 1. Importantly, since we have the same type of encoding gate for each qubit, they have the same frequency spectrum \u2126. As it is explained in detail in the work of [12], we can derive the frequency spectrum for each qubit \u2126 = {\u22121, 0, 1} from the possible differences nqubit = \u03bb qubit j \u2212 \u03bb qubit i for\n5 \u03bbqubitj , \u03bb qubit i \u2208 {\u22121, 1}. Then, we have the Fourier coefficients as cn1n2 and Eq. (6) can be written as\nf(x) = \u2211 n1\u2208\u2126 \u2211 n2\u2208\u2126 cn1n2e \u2212in1x1e\u2212in2x2 . (7)\nBoth circuit models in Fig. 2 have the same number of Fourier basis functions given by Eq. 7, since they have the same number of encoding gates. This fundamentally limits their learning ability. But importantly, the structure of the processing and measurement operator affect the distribution of the coefficients.\nIn Fig. 5, we plot the real and imaginary parts of the Fourier coefficients for the 2-qubit (blue color) and 3-qubit (orange color) explicit circuits of Fig. 2 with two parameterized gates each. The coefficients c00, c01, c10, c\u221210, c0,\u22121 from Fig. 2\nfor the 2-qubit circuit are all zero (blue color), while they are non-zero for the 3-qubit (orange color). But what happens with the coefficients c11, c\u22121,\u22121, c\u221211, c1,\u22121? Interestingly, computing the exact analytical formula for the distributions of the coefficient c1,1 shows that they are different. We present these analytical formulas in Appendix C. In summary, even though the two quantum models of Fig. 2 have access to the same Fourier basis functions, the different distribution of their coefficients results in a different combination of these basis functions, and hence, give rise to different function classes.\nThis is also in accordance with the results from the previous two subsections { 3 3.1 3 3.2}. The 2-qubit student (Fig.2 left) has difficulties learning the prediction map of the 3-qubit teacher (Fig.2 right), since it has four coefficients strictly equal to zero which does not help approximating the more complicated distribution of the 3-qubit teacher. But reversing the roles, the 3-qubit student has also difficulties learning the 2-qubit teacher. Even though, the student could learn the zero coefficients, the coefficients c11, c\u22121,\u22121, c\u221211, c1,\u22121 of\nthe teacher belong to a different function class, i.e. they draw their values from a different distribution. This could be seen from the larger spread of the coefficients in Fig. 5. These results are in accordance with the averaged operator size (Fig.3) and \u2206y (Fig.4), since they also suggest that for just two parameterized gates both the 2-qubit and 3-qubit circuit have similar performance.\nMost importantly, once we add an extra layer L to the 3- qubit circuit, the spread of the Fourier coefficients in Figure 5 (in orange) increases and overlaps with the coefficients of the 2-qubit circuit (in blue) almost completely. These results are shown in light blue color at Fig.12 in the Appendix D). This is in accordance with the averaged operator size and \u2206y from the teacher-student scheme where a better performance is observed for the 3-qubit case by adding an extra layer L. On the contrary, adding an extra layer in the 2-qubit case does not improve the performance of the student as suggested as well from Fig.3 and Fig.4, i.e. the distribution of the coefficients shown in Figure 5 in blue stays the same.\nBut what more can we say for the distribution of these coefficients? Could we understand which circuit elements determine the exact zero terms? We tackle these questions in the next section."
        },
        {
            "heading": "4. VARIATIONAL MEASUREMENT",
            "text": "We can describe the expectation value of any circuit of Fig. 1 with the representation of matrix blocks shown in Fig.6a. Following [12], the data encoding unitary can be\nwritten as S(x) = V \u2020e\u2212ix\u03a3V via an eigenvalue decomposition, where \u03a3 is a diagonal matrix of eigenvalues and V is the unitary formed with the eigenvectors as columns. We ab-\n6 sorb V, V \u2020 into the initial state |\u03c8\u2032\u3009 = V |\u03c8\u3009 and into the processing part of the circuit U \u2032 = V UV \u2020. For consistency, we transform the measurement operator with M \u2032 = VMV \u2020. As a result, the encoding unitary is simply a diagonal matrix exp(\u2212ix\u03a3). The transformed matrix blocks are shown in Fig. 6b.\nIn Fig. 7, we schematically illustrate the mapping between the Fourier coefficients and the frequencies instead of explicitly writing the full matrix given by the inner product of the orange, blue and green matrix blocks of Fig. 6b. The Fourier coefficients depend only on the processing and measurement operators, therefore the matrix elements of M = U\u2020 \u2032 M \u2032U \u2032, while the frequencies on the encoding operator, i.e. the diagonal matrix of the encoding Hamiltonian as explained in detail in [12]. As introduced in Eq. 7, the Fourier coefficients are defined as cn1,n2 . For example, c00 corresponds to the frequencies with n1 = n2 = 0 for both qubits, which after explicitly calculating the expectation value in Eq. 7 in turn correspond to the diagonal matrix elements of M . Following the same procedure, c01 is the sum of elements M12 and M34, c10 is the sum of elements M13 and M24, c11 is the element M14 and c1,\u22121 is the element M23. Finally, c0,\u22121, c\u221210, c\u22121\u22121 and c\u221211 are the complex conjugates of c01, c10, c11 and c1\u22121, respectively.\nWe now discuss the simple example of the 2-qubit case from Fig. 2 with the Pauli Z operator applied to the 2nd qubit (M \u20321 = I , M \u2032 2 = Z). The transformed measurement opera-\ntor M \u2032 = M \u20321 \u2297M \u20322 = I \u2297 ( V ZV \u2020 ) of the data-encoding Hamiltonian) becomes\nM \u2032 =  0 h 0 0k 0 0 00 0 0 h\u2217 0 0 k\u2217 0  , (8) where h, k are complex trigonometric functions that determine the distribution of the coefficients. But the mapping between the zero elements and the coefficients that are zero does not match. For example, c11 which is determined by M14 has a non zero distribution as shown in Fig.5 (blue color), while eq. (8) suggests that M14 it should be strictly zero.\nTo resolve this discrepancy, we need to consider the processing and measurement operators as one matrix block M = U\u2020\u2032M \u2032U \u2032 (shown in green in Fig. 6c). This is in accordance\nwith recent works [35, 36], where the processing and measurement operators are regarded as one part in the circuit structure.\nFor the 2-qubit case, the combined matrix M (green blocks in Fig.6c) becomes:\nM =  0 0 0 f0 0 g 00 g\u2217 0 0 f\u2217 0 0 0  , (9) where f, g are complex trigonometric functions that determine the distribution of the coefficients shown in Fig. 5. Following the mapping between the coefficients and the elements of the combined matrix M , we can immediately see which coefficients are zero. The only non-zero coefficients are the c11, c1,\u22121 and their complex conjugates determined by M14, M23 and M41,M32, respectively.\nThis analysis suggests that in some cases replacing the usual segregation of a quantum circuit into three parts: encoding, processing and measurement with just two parts: encoding and variational measurement could reveal further insights on the performance and properties of QML models."
        },
        {
            "heading": "4.1. Toy application",
            "text": "To further emphasize the importance of the measurement operators of a circuit, we present a simple quantum model with two qubits (Fig.8). The Fourier coefficients of this circuit are represented in Fig.9, where the coefficients in purple represent the measurement of the 1st qubit and the Fourier coefficients in green represent the measurement on the 2nd qubit. As we see, the distribution of the Fourier coefficients differ greatly. Therefore, with the same circuit structure, we could create two different functions classes depending on where we measure. This might have a more relevant applications, but it already suggests that once we better understand how simple elements on our circuit structure affect the overall performance it is more natural to think of applications."
        },
        {
            "heading": "5. CONCLUSIONS",
            "text": "The data encoding is fundamentally limiting the performance of a circuit, but the processing and measurement can also significantly affect the capabilities of the model. We\n7\nshow that different parts of processing and measurement operators affect the performance of the QML model. As expected, increasing the number of layers L has a direct effect on the model\u2019s performance, but a plateau in the performance seems to be reached. We also observed that the circuit with the ancilla has overall a better performance in accordance with the recent work of [15].\nTo quantify the model\u2019s performance, we introduced three different tools: the averaged operator size, the \u2206y and the coefficient from the partial Fourier series. By applying the Fourier representation, we see that two different circuits with the same number of parameters could give rise to different function classes. Finally, we find that the segregation of the processing and measurement operator might not be ideal when interpreting the parts of the circuit. Instead when considered as one, i.e. the variational measurement, could give insights on the model\u2019s performance. The idea of the variational measurement has also been presented in the context of quantum kernels [37]. This might bring the relation between the Fourier representation and quantum kernels one step closer.\nOnce we better understand how QML models work, we can naturally start thinking about applications. For example, we presented a trivial implementation that arises from where we measure. Specifically, measuring either one of the two qubits on a 2-qubit circuit gives rise to fundamentally different classes of functions that this model could express. Therefore, with the same circuit structure one could learn or express two different function classes. This can be seen from the numerical calculation of the real and imaginary part of the Fourier coefficients in Fig. 8.\nWe understand that computing the analytical trigonometric expression for more qubits, or even gates, is similar to opening Pandora\u2019s box. Instead we suggest to focus on the other two\ntools proposed, i.e. the averaged operator size and the map differencies from the teacher-student scheme. In this work, we focused on simple quantum models and verified that the tools presented here are robust. The analytical and numerical results are in agreement, and therefore, these tools could be further used to test the performance of more complex circuit structures.\nIn conclusion, applying the averaged operator size and teacher-student scheme to other simple circuit structures could further help understand how QML models work. It would also be interesting to exploit the effect of measurement for a more interesting use-case application. But to do so, a careful study on how the measurement position affects the model\u2019s performance should be undertaken, i.e. by increasing the number of qubits and circuit complexity [38]. This study could also further strengthen the belief that ancillary qubits have better performance overall [15].\nNow, we have a better understanding on the basic questions posed earlier in the introduction: \u201dHow many parameterized gates to use?\u201d, \u201dHow many entangling gates and where?\u201d, \u201dDo ancilla qubits help?\u201d and \u201dWhere to measure?\u201d. We understand that the processing and measurement operators strongly affect the performance of the QML model. Therefore, focusing the research directions on how exactly they affect it is of great importance. If we want to find the great applications that QML promises [39, 40], we first need to understand how QML models work."
        },
        {
            "heading": "6. CODE",
            "text": "Code to reproduce the results and explore further settings can be found in the following Github repository: https://github.com/KaterinaGratsea/ Teacher-student_scheme-part-2."
        },
        {
            "heading": "7. ACKNOWLEDGEMENTS",
            "text": "The simulations were made with the Pennylane library [41] and the graphics with the ? software. ICFO group acknowledges support from: ERC AdG NOQIA; Agencia Estatal de Investigacio\u0301n (R&D project CEX2019-000910S, funded by MCIN/ AEI/10.13039/501100011033, Plan National FIDEUA PID2019-106901GB-I00, FPI, QUANTERA MAQS PCI2019-111828-2, QUANTERA DYNAMITE PCI2022-132919, Proyectos de I+D+I \u201cRetos Colaboracio\u0301n\u201d QUSPIN RTC2019-007196-7), MCIN via European Union NextGenerationEU (PRTR); Fundacio\u0301 Cellex; Fundacio\u0301 Mir-Puig; Generalitat de Catalunya through the European Social Fund FEDER and CERCA program (AGAUR Grant No. 2017 SGR 134, QuantumCAT U16-011424, cofunded by ERDF Operational Program of Catalonia 2014- 2020); EU Horizon 2020 FET-OPEN OPTOlogic (Grant No 899794); National Science Centre, Poland (Symfonia Grant No. 2016/20/W/ST4/00314); European Union\u2019s Horizon 2020 research and innovation programme under the Marie Sk\u0142odowska-Curie grant agreement No 847517.\n8"
        },
        {
            "heading": "Appendix A: Monte-Carlo integration",
            "text": "For the numerical simulation we use Monte-Carlo integration [34] and approximate the integral as\u222b\nU(N)\nf(U)dU \u2248 1 p p\u2211 i=1 f (Ui) , (A1)\nwhere p is the total number of random unitaries used and Ui is a randomly drawn unitary according to the Haar measure. To define such unitary numerically, we start by calling a N \u00d7N matrix with Gaussian values. Then, we perform a QR decomposition on this matrix which gives two matrices Q and R. Next, we define the diagonal matrix D from the diagonal elements of the matrix R, i.e. Dii = Rii/ |Rii|. Finally, the unitary random matrix according to the Haar measure is defined as Ui = QD [34].\n9"
        },
        {
            "heading": "Appendix B: Prediction maps",
            "text": "Fig. 10 shows an example of the prediction maps for the 2-qubit circuit as a teacher and the 3-qubit circuit as a student along with the reverse roles for each circuit. In both cases, the student deviates from the data distribution of its teacher.\nAppendix C: Coefficient c11\nHere, we present the explicit formula of the real and imaginary parts of the coefficient c11 for the 2-qubit and 3-qubit circuits in Fig. 2 in Eq. (C1),(C2) and Eq. (C3),(C4), respectively for the real and imaginary parts.\nRe (c11) = sin ( \u03b82 2 ) sin ( \u03c61 2 + \u03c91 2 ) cos ( \u03b81 2 ) cos ( \u03b82 2 ) sin ( \u03b81 2 ) cos ( \u2212\u03c61 2 + \u03c91 2 )( sin ( \u03c62 2 + \u03c92 2 ) cos ( \u2212\u03c622 + \u03c92 2 ) \u2212 cos ( \u03c62 2 + \u03c92 2 ) sin ( \u2212\u03c622 + \u03c92 2\n)) \u2212 sin ( \u03b82 2 ) sin ( \u2212\u03c612 + \u03c91 2 ) cos ( \u03b81 2 ) cos ( \u03b82 2 ) sin ( \u03b81 2 ) cos ( \u03c61 2 + \u03c91 2\n)( sin ( \u03c62 2 + \u03c92 2 ) cos ( \u2212\u03c622 + \u03c92 2 ) \u2212 cos ( \u03c62 2 + \u03c92 2 ) sin ( \u2212\u03c622 + \u03c92 2 )) + 14 ( \u22124 cos ( \u03b82 2 )2 + 2 ) cos ( \u03b81 2 )2 + 12 cos ( \u03b82 2\n)2 \u2212 14 (C1)\nIm (c11) = \u2212 ( cos ( \u03b82 2 )2 \u2212 12) sin ( \u03b812 ) sin(\u03c612 + \u03c912 ) cos ( \u03b812 ) cos(\u2212\u03c612 + \u03c912 ) + ( cos ( \u03b82 2\n)2 \u2212 12) sin(\u2212\u03c612 + \u03c912 ) sin ( \u03b812 ) cos ( \u03b812 ) cos(\u03c612 + \u03c912 )\u2212 sin ( \u03b822 ) cos ( \u03b822 )( sin ( \u03c62 2 + \u03c92 2 ) cos ( \u2212\u03c622 + \u03c92 2 ) \u2212 cos ( \u03c62 2 + \u03c92 2 ) sin ( \u2212\u03c622 + \u03c92 2 ))( cos ( \u03b81 2 )2 \u2212 12) (C2)\n10\nRe (c11) = \u2212 18 \u2212 1 8\n( \u22122 + 4 cos ( \u03b82 2 )2) cos ( \u03b81 2 )2 + 12 sin(\u03c62) sin(\u03b81) sin ( \u03b81 2 ) sin ( \u03b82 2 ) cos ( \u03b82 2 ) cos ( \u03b81 2 ) + 14 cos ( \u03b82 2 )2 (C3)\nIm (c11) = 1 2 sin(\u03c62) sin ( \u03b82 2 ) cos ( \u03b82 2 ) cos ( \u03b81 2 )2 \u2212 12 sin(\u03c61)(cos ( \u03b822 )2 \u2212 12) sin ( \u03b812 ) cos ( \u03b812 )+ 14 sin ( \u03b822 ) cos ( \u03b822 ) sin(\u03b82) (C4)"
        },
        {
            "heading": "Appendix D: 3-qubit circuit with 4 gates",
            "text": "Here, we present the Fourier coefficients in Fig. 12 for the circuit with 3 qubits and four parameterized gates sketched in Fig. 11. We see that the coefficients c1,1 and c1,\u22121 now take similar values with their corresponding coefficients shown in Fig. 5 in orange color.\n11"
        }
    ],
    "title": "The effect of the processing and measurement operators on the expressive power of quantum models",
    "year": 2022
}