{
    "abstractText": "This paper conducts a comprehensive study of a classical adaptive control problem: adaptive control of a state-space plant model: \u1e8b(t) = Ax(t) + Bu(t) in continuous time, or x(t+1) = Ax(t)+Bu(t) in discrete time, for state tracking of a chosen stable reference model system: \u1e8bm(t) = Amxm(t) + Bmr(t) in continuous time, or xm(t + 1) = Amxm(t) + Bmr(t) in discrete time. Adaptive state tracking control schemes for continuous-time systems have been reported in the literature, using a Lyapunov design and analysis method which has not been successfully applied to discrete-time systems, so that the discrete-time adaptive state tracking problem has remained to be open. In this paper, new adaptive state tracking control schemes are developed for discrete-time systems, using a gradient method for the design of adaptive laws for updating the controller parameters. Both direct and indirect adaptive designs are presented, which have the standard and desired adaptive law properties. Such a new gradient algorithm based framework is also developed for adaptive state tracking control of continuous-time systems, as compared with the Lyapunov method based framework.",
    "authors": [
        {
            "affiliations": [],
            "name": "Gang Tao"
        }
    ],
    "id": "SP:4dedad4f1eb4c87715fab5a73ede5ad18b454674",
    "references": [
        {
            "authors": [
                "A.M. Annaswamy",
                "A.L. Fradkov"
            ],
            "title": "A historical perspective of adaptive control and learning",
            "venue": "Annual Reviews in Control, vol. 52, pp. 18-41, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "H. Elliott",
                "W.A. Wolovich"
            ],
            "title": "A parameter adaptive control structure for linear multivariable systems",
            "venue": "IEEE Transactions on Automatic Control, vol. AC-27, no. 5, pp. 340-352, 1982.",
            "year": 1982
        },
        {
            "authors": [
                "P.A. Ioannou",
                "J. Sun"
            ],
            "title": "Robust Adaptive Control, Prentice-Hall",
            "venue": "Upper Saddle River, NJ,",
            "year": 1996
        },
        {
            "authors": [
                "Y.D. Landau",
                "R. Lozano",
                "M. M\u2019Saad",
                "A. Karimi"
            ],
            "title": "Adaptive Control: Algorithms, Analysis and Applications, 2nd ed",
            "year": 2011
        },
        {
            "authors": [
                "E. Lavretsky",
                "K.A. Wise"
            ],
            "title": "Robust and Adaptive Control with Aerospace",
            "year": 2013
        },
        {
            "authors": [
                "R. Ortega",
                "L. Hsu",
                "A. Astolfi"
            ],
            "title": "Immersion and invariance adaptive control of linear multivariable systems",
            "venue": "Systems and Control Letters, vol. 49, pp. 37\u201347, 2003.",
            "year": 2003
        },
        {
            "authors": [
                "S. Sastry",
                "M. Bodson"
            ],
            "title": "Adaptive Control: Stability, Convergence, and Robustness",
            "year": 1989
        },
        {
            "authors": [
                "J.T. Spooner",
                "M. Maggiore",
                "R. Ordsqez",
                "K.M. Passino"
            ],
            "title": "Stable Adaptive Control and Estimation for Nonlinear Systems: Neural and Fuzzy Approximator Techniques",
            "year": 2002
        },
        {
            "authors": [
                "G. Tao"
            ],
            "title": "Adaptive Control Design and Analysis",
            "year": 2003
        },
        {
            "authors": [
                "G. Tao"
            ],
            "title": "Multivariable adaptive control: A survey",
            "venue": "Automatica, vol. 50, no. 11, pp. 2737- 2764, November 2014.",
            "year": 2014
        },
        {
            "authors": [
                "G. Tao",
                "S. Chen",
                "X. Tang",
                "S.M. Joshi"
            ],
            "title": "Adaptive Control of Systems with Actuator Failures",
            "year": 2004
        },
        {
            "authors": [
                "G. Tao",
                "Y. Ling"
            ],
            "title": "Parameter estimation for coupled multivariable error models",
            "venue": "International Journal of Adaptive Control and Signal Processing, vol. 13, no. 3, pp. 145-159, 1999.",
            "year": 1999
        },
        {
            "authors": [
                "C. Wang",
                "C.Y. Wen",
                "L. Guo"
            ],
            "title": "Multivariable adaptive control with unknown signs of the high-frequency gain matrix using novel Nussbaum functions",
            "venue": "Automatica, 111, 108618, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "W. Wang",
                "C.Y. Wen",
                "J. Zhou"
            ],
            "title": "Adaptive Backstepping Control of Uncertain Systems with Actuator Failures, Subsystem Interactions, and Nonsmooth Nonlinearities",
            "year": 2017
        },
        {
            "authors": [
                "S. Yuan",
                "B.D. Schutter",
                "S. Baldi"
            ],
            "title": "Adaptive asymptotic tracking control of uncertain time-driven switched linear systems",
            "venue": "IEEE Transactions on Automatic Control, vol. 62, no. 11, pp. 5802\u20135807, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "Z.Q. Zhang",
                "Y.L. Sang",
                "X.K. Chen"
            ],
            "title": "Model reference adaptive disturbance rejection control using partial-state feedback",
            "venue": "Automatica, 154, 111071, August 2023. 36",
            "year": 2023
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n30 8.\n02 48\n4v 1\n[ ee\nss .S\nY ]\n4 A\nug 2\nKeywords: Continuous-time systems, direct adaptive control, discrete-time systems, gradient\nalgorithms, indirect adaptive control, Lyapunov method, stability analysis, state tracking."
        },
        {
            "heading": "1 Introduction",
            "text": "Adaptive control is a methodology for feedback control of dynamic systems with parameter, structure, actuator and sensor uncertainties. Parametrized system structure, actuator and sensor uncertainties can be dealt with by adaptive control schemes effectively. Of the broad areas of adaptive control research (see for example, [1]-[23], adaptive state tracking control is one topic of special interests. It meets certain desired system performance that the controlled plant state vector asymptotically tracks the reference model system state vector. It has a complete, direct and straightforward Lyapunov design and analysis framework for the continuous-time adaptive control case, under a necessary plant-model matching condition [7], [11], [15], [16].\nSuch a Lyapunov method has two important features: the first feature is that a positive definite function V containing both the system state tracking error e(t) and the parameter error \u03b8\u0303(t) is used\nfor system stability analysis. The second feature is that the adaptive laws are chosen to make the time-derivative V\u0307 \u2264 \u2212eT (t)e(t) \u2264 0, from which the system stability is ensured in the Lyapunov sense (making V a Lyapunov function of the adaptive control system) and the state tracking error e(t) is ensured, directly via Barbalat lemma, to be limt\u2192\u221e e(t) = 0. Such a Lyapunov method based straightforward design and analysis framework has in the recent years attracted researchers to pursue its extensions and applications for new adaptive control developments (see, for example, [10] and the literature review in [1]).\nHowever, the discrete-time adaptive state tracking control problem has remained to be open, as the Lyapunov method based framework has not been successfully applied to adaptive state tracking control of discrete-time systems with unknown parameters. In fact, there is no visible study in the literature on such a problem.\nIn this paper, we develop a new gradient algorithm based framework and its derived adaptive control schemes, to solve this long-standing discrete-time adaptive state tracking control problem, and to provide new solutions to continuous-time adaptive state tracking control. New features of such a framework include the formation of common-parameter estimation errors and development of composite-error adaptive laws. We conduct a comprehensive study of such classical and yet open adaptive control problems, derive adaptive control schemes of different types and for different systems, and show their stability analysis and comparisons.\nIn Section 2, we present the adaptive state tracking control problems and review the direct and indirect adaptive control schemes for continuous-time systems, based on a Lyapunov method. In Section 3, we develop a gradient algorithm based framework for solving the discrete-time adaptive state tracking control problem, with both the direct and indirect adaptive control schemes. In Section 4, we develop the gradient algorithm based framework for adaptive state tracking control of systems with multiple inputs, and in particular, we derive direct and indirect adaptive control schemes for solving the open discrete-time problems. In Sections 3 and 4, we also demonstrate how such a gradient algorithm based framework can be used for continuous-time systems."
        },
        {
            "heading": "2 Adaptive State Tracking Control",
            "text": "In this section, we first formulate the adaptive state tracking control problems, and then give an overview of adaptive state tracking control designs for continuous-time systems."
        },
        {
            "heading": "2.1 Problem Formulation",
            "text": "Consider the continuous-time single-input multi-output (SIMO) plant\nx\u0307(t) = Ax(t) + bu(t), x(t) \u2208 Rn, u(t) \u2208 R, (2.1)\nwhere A \u2208 Rn\u00d7n, b \u2208 Rn are unknown constant parameters, and assume that the state (output) vector x(t) is available for measurement. The state tracking control objective is to design a feedback\ncontrol law for the plant input u(t) such that all closed-loop system signals are bounded and x(t) asymptotically tracks a reference state vector xm(t) of a chosen reference model system\nx\u0307m(t) = Amxm(t) + bmr(t), xm(t) \u2208 Rn, r(t) \u2208 R, (2.2)\nwhere Am \u2208 Rn\u00d7n, bm \u2208 Rn with Am stable in the continuous-time sense: all eigenvalues of Am are the open left-half of the complex s-plane (for desired reference model system stability and performance), and r(t) is a chosen bounded reference input signal for desired system response.\nFor the discrete-time counterparts, the plant model is\nx(t + 1) = Ax(t) + bu(t), x(t) \u2208 Rn, t = 0, 1, 2, . . . , (2.3)\nwhere A \u2208 Rn\u00d7n and b \u2208 Rn are unknown constant matrix and vector, x(t) \u2208 Rn is the plant state (output) vector, and u(t) \u2208 R is the input signal, and the reference model system is\nxm(t+ 1) = Amxm(t) + bmr(t), xm(t) \u2208 Rn, r(t) \u2208 R (2.4)\nwhere Am \u2208 Rn\u00d7n and bm \u2208 Rn are some constant matrix and vector, all eigenvalues of Am are inside the unit circle of the complex z-plane, and r(t) is a chosen bounded reference input signal.\nThe following basic assumptions are needed to solve such a state tracking problem.\nAssumption (A1): There exist a constant vector k\u22171 \u2208 Rn and a nonzero constant scalar k\u22172 \u2208 R such that the following equations are satisfied:\nA + bk\u2217T1 = Am, bk \u2217 2 = bm. (2.5)\nAssumption (A2): The sign of k\u22172, sign[k \u2217 2], is known.\nSuch an assumption (2.5) is needed not only for solving the adaptive control problem when the plant parameters A and b are unknown, but also for solving the nominal control problem when A and b are known."
        },
        {
            "heading": "2.2 Continuous-Time Adaptive Control Designs",
            "text": "The state feedback state tracking controller structure is\nu(t) = kT1 (t)x(t) + k2(t)r(t), (2.6)\nwhere k1(t) and k2(t) are the estimates of k \u2217 1 and k \u2217 2 satisfying Assumption (A1). There are two methods to design an adaptive scheme to update the controller parameters: a direct method to adaptively update k1(t) and k2(t) directly, and an indirect method to adaptively update the estimates of the plant parameters and then to calculate the controller parameters k1(t) and k2(t) from the plant parameter estimates."
        },
        {
            "heading": "2.2.1 Direct Adaptive Control Design",
            "text": "With the control law (2.6), the plant (2.1) becomes\nx\u0307(t) = Ax(t) + b(kT1 (t)x(t) + k2(t)r(t))\n= Ax(t) + b(k\u2217T1 x(t) + k \u2217 2r(t)) + b(k\u0303 T 1 (t)x(t) + k\u03032(t)r(t)) = Amx(t) + bmr(t) + b(k\u0303 T 1 (t)x(t) + k\u03032(t)r(t)), (2.7)\nwhere Am = A+ bk \u2217T 1 and bm = bk \u2217 2 (see Assumption (A1)), and\nk\u03031(t) = k1(t)\u2212 k\u22171, k\u03032(t) = k2(t)\u2212 k\u22172. (2.8)\nWith (2.2) and e(t) = x(t)\u2212 xm(t), we have\ne\u0307(t) = Ame(t) + bm 1\nk\u22172 (k\u0303T1 (t)x(t) + k\u03032(t)r(t)). (2.9)\nAdaptive laws. We choose the adaptive laws for k1(t) and k2(t) as\nk\u03071(t) =\u2212sign[k\u22172]\u0393x(t)eT (t)Pbm (2.10) k\u03072(t) =\u2212sign[k\u22172]\u03b3r(t)eT (t)Pbm, (2.11)\nwhere \u0393 = \u0393T > 0 and \u03b3 > 0 are chosen adaptation gains, and P = P T > 0 satisfying PAm+A T mP = \u2212Q, for a chosen constant n\u00d7 n matrix Q = QT > 0.\nConsider the positive definite function for this Lyapunov-type algorithm:\nV = eTPe+ 1\n|k\u22172| k\u0303T1 \u0393\n\u22121k\u03031 + 1\n|k\u22172| k\u030322\u03b3 \u22121 (2.12)\nand its time-derivative\nV\u0307 = \u2212eT (t)Qe(t) \u2264 0, (2.13)\nwe conclude that k\u03031(t) = k1(t)\u2212 k\u22171, k\u03032(t) = k2(t)\u2212 k\u22172 and e(t) = x(t)\u2212 xm(t) are all bounded, and e(t) \u2208 L2. We further have from (2.6) that u(t) is bounded and from (2.9) that e\u0307(t) is bounded so that limt\u2192\u221e e(t) = 0 (following Barbalat lemma [7]). This result is summarized as:\nProposition 2.1 The control law (2.6), updated by the adaptive laws (2.10)-(2.11) and applied to the plant (2.1), ensures the closed-loop system signal boundedness and asymptotic tracking: limt\u2192\u221e(x(t)\u2212 xm(t)) = 0."
        },
        {
            "heading": "2.2.2 Indirect Adaptive Control Design",
            "text": "Using Assumption (A1), we parametrize the plant (2.1) as\nx\u0307(t) = Ax(t) + bu(t) = Amx(t) + bm(\u03b8 \u2217 2u(t)\u2212 \u03b8\u2217T1 x(t)), (2.14)\nwhere \u03b8\u22171 = k \u2217\u22121 2 k \u2217 1 and \u03b8 \u2217 2 = k \u2217\u22121 2 , and, with the estimates \u03b81(t) and \u03b82(t) of \u03b8 \u2217 1 and \u03b8 \u2217 2, generate an a posteriori estimate x\u0302(t) of x(t) from the estimator equation\n\u02d9\u0302x(t) = Amx\u0302(t) + bm(\u03b82(t)u(t)\u2212 \u03b8T1 (t)x(t)). (2.15)\nFor ex(t) = x\u0302(t)\u2212 x(t), we have the estimator state error equation\ne\u0307x(t) = Amex(t) + bm((\u03b82(t)\u2212 \u03b8\u22172)u(t)\u2212 (\u03b81(t)\u2212 \u03b8\u22171)Tx(t)). (2.16)\nAdaptive laws. Then, we choose the adaptive laws for \u03b81(t) and \u03b82(t):\n\u03b8\u03071(t) = \u03931x(t)e T x (t)Pbm (2.17) \u03b8\u03072(t) =\u2212\u03b32u(t)eTx (t)Pbm, (2.18)\nwhere \u03931 = \u0393 T 1 > 0, \u03b32 > 0, and P = P T > 0 such that PAm+A T mP = \u2212Q for a chosen Q = QT > 0.\nFor the positive definite function\nV = eTxPex + (\u03b81 \u2212 \u03b8\u22171)T\u0393\u221211 (\u03b81 \u2212 \u03b8\u22171) + (\u03b82 \u2212 \u03b8\u22172)2\u03b3\u221212 , (2.19)\nwe derive its time-derivative as: V\u0307 = \u2212eTxQex \u2264 0, so that \u03b81(t), \u03b82(t) and ex(t) are all bounded, and ex(t) \u2208 L2, as the basic properties of the adaptive laws (2.17)-(2.18). 1\nControl law. We choose the adaptive control law\nu(t) = 1\n\u03b82(t) v(t), v(t) = \u03b8T1 (t)x(t) + r(t). (2.20)\nTo implement this control law, \u03b82(t) should be projected to be away from zero: |\u03b82(t)| \u2265 \u03b8a2 > 0. This can be done using some information about k\u22172, described by:\nAssumption (A3): An upper bound kb2 of |k\u22172|: kb2 \u2265 |k\u22172|, is known.\nThen, \u03b8a2 = 1/k b 2 is a lower bound of |\u03b8\u22172|: 0 < \u03b8a2 \u2264 |\u03b8\u22172|, as \u03b8\u22172 = 1/k\u22172. With Assumption (A3),\nthe adaptive law (2.18) is modified as\n\u03b8\u03072(t) = \u2212\u03b32u(t)eTx (t)Pbm + f2(t), sign[\u03b8\u22172]\u03b82(0) \u2265 \u03b8a2 , (2.21)\nwhere f2(t) is a parameter projection signal: for g2(t) = \u2212\u03b32u(t)eTx (t)Pbm,\nf2(t) =\n   \n \n0 if sign[\u03b8\u22172]\u03b82(t) > \u03b8 a 2 , or\nif sign[\u03b8\u22172]\u03b82(t) = \u03b8 a 2 and sign[\u03b8 \u2217 2]g2(t) \u2265 0\n\u2212g2(t) otherwise, (2.22)\nwhich ensures that sign[\u03b82(t)] = sign[\u03b8 \u2217 2], |\u03b82(t)| \u2265 \u03b8a2 > 0 and (\u03b82(t)\u2212 \u03b8\u22172)f2(t) \u2264 0.\n1A vector signal x(t) belongs to L\u221e: x(t) \u2208 L\u221e, if x(t) is bounded, and x(t) \u2208 L2 if \u222b \u221e 0 xT (t)x(t) dt < \u221e (in the\ncontinuous-time case) or \u2211 \u221e t=0 xT (t)x(t) < \u221e (in the discrete-time case).\nWith the control law (2.20), the estimator state equation (2.15) becomes\n\u02d9\u0302x(t) = Amx\u0302(t) + bmr(t) (2.23)\nwhich implies that x\u0302(t) is bounded so that x(t) and x\u0307(t) are bounded as ex(t) = x\u0302(t) \u2212 x(t) is bounded, and that limt\u2192\u221e(x\u0302(t) \u2212 xm(t)) = 0 exponentially so that x\u0302(t) \u2212 xm(t) \u2208 L2. Hence we have x(t) \u2212 xm(t) = x\u0302(t) \u2212 xm(t) + x(t) \u2212 x\u0302(t) \u2208 L2 as x(t) \u2212 x\u0302(t) \u2208 L2, and finally, following Barbalat lemma, we have that limt\u2192\u221e(x(t)\u2212 xm(t)) = 0. In summary, we have:\nProposition 2.2 The adaptive controller (2.20), updated from the adaptive law (2.17)\u2013(2.18) and applied to the plant (2.1), ensures that all closed-loop system signals are bounded and limt\u2192\u221e(x(t)\u2212 xm(t)) = 0.\nThe above direct and indirect adaptive control schemes are based on a Lyapunov method characterized by two features. The first feature is that the positive definite function V in (2.12) or (2.19) contains the state error signal e(t) = x(t) \u2212 xm(t) or ex(t) = x\u0302(t) \u2212 x(t), in addition to the parameter errors k\u03031(t) = k1(t)\u2212k\u22171 and k\u03032(t) = k2(t)\u2212k\u22172 or \u03b8\u03031(t) = \u03b81(t)\u2212\u03b8\u22171 and \u03b8\u03032(t) = \u03b82(t)\u2212\u03b8\u22172 . The second feature is that the adaptive laws are chosen to ensure the desired time-derivative of V : V\u0307 = \u2212eTQe \u2264 0 or V\u0307 = \u2212eTxQex \u2264 0, from which the adaptive system stability directly follows, making the adaptive control system stable in the Lyapunov stability sense and e(t) \u2208 L2 or ex(t) \u2208 L2, explicitly leading to limt\u2192\u221e e(t) = 0 or limt\u2192\u221e ex(t) = 0.\nSuch an adaptive control design and analysis framework may be called a Lyapunov method based framework, as the positive definite function V is a Lyapunov function of the adaptive control system: it contains the full error signals and it is ensured to be V\u0307 \u2264 0. It however has not been successfully applied for adaptive state tracking control of discrete-time systems, more precisely, it has not been verified that a certain choice of adaptive laws can make such a positive definite function V a nonincreasing function for a discrete-time adaptive control system."
        },
        {
            "heading": "3 Discrete-Time Adaptive Control Designs",
            "text": "In this section, we develop two new adaptive control schemes: one direct design and one indirect design, using gradient algorithms, to solve the long-standing open discrete-time adaptive state tacking control problem, with system stability and tracking performance analysis and illustration.\nConsider the single-input multi-output (SIMO) time-invariant plant (2.3): x(t + 1) = Ax(t) + bu(t), and the reference model system (2.4): xm(t+1) = Amxm(t)+bmr(t), satisfying the conditions of Assumption (A1): A + bk\u2217T1 = Am, bk \u2217 2 = bm, for some constant k \u2217 1 \u2208 Rn and k\u22172 \u2208 R.\nNominal control. With the parameters k\u22171 and k \u2217 2 satisfying Assumption (A1), the control law\nu(t) = k\u2217T1 x(t) + k \u2217 2r(t) (3.1)\ncan achieve the desired control objective: the closed-loop control system with (3.1) becomes\nx(t + 1) = Ax(t) + b(k\u2217T1 x(t) + k \u2217 2r(t)) = Amx(t) + bmr(t) (3.2)\nso that the plant state vector x(t) is bounded, and so is the control u(t) in (3.1), and the tracking error e(t) = x(t)\u2212 xm(t) satisfies\ne(t + 1) = Ame(t), e(0) = x(0)\u2212 xm(0) (3.3)\nleading to limt\u2192\u221e e(t) = 0 exponentially. Such a control law is called the nominal control law.\nIt is clear that the condition (2.5) is also necessary for the control law (3.1) to achieve the control objective, even if the parameters A and b are known. The condition (2.5) is the so-called matching condition for the closed-loop control system to match the reference model system (2.4), exponentially with a nominal controller for the known plant parameter case, as shown above, or asymptotically with an adaptive controller for the unknown plant parameter case, as shown next.\nRemark 3.1 We note that the Lyapunov method used for the continuous-time adaptive state feedback state tracking system design and analysis in Section 2.2 has not been shown to be applicable to its discrete-time counterpart whose problem has remained to be open.\nIn this section, we will develop two gradient parameter estimation schemes for the discretetime state feedback state tracking adaptive control problem: a direct adaptive control scheme (see Section 3.1) whose controller parameters are directly updated by some adaptive laws, and an indirect adaptive control scheme (see Section 3.2) whose controller parameters are indirectly calculated from some adaptive parameter estimates."
        },
        {
            "heading": "3.1 Direct Adaptive Control Design",
            "text": "In this subsection, we develop the discrete-time direct adaptive gradient state tracking control scheme, establish its desired stability and tracking properties, and present an illustrative example."
        },
        {
            "heading": "3.1.1 Adaptive Control Scheme",
            "text": "For the adaptive control problem when the parameters A and b are unknown (and so are k\u22171 and k\u22172), the nominal control law (3.1) is replaced by its adaptive version:\nu(t) = kT1 (t)x(t) + k2(t)r(t), (3.4)\nwhere k1(t) and k2(t) are the estimates of k \u2217 1 and k \u2217 2, respectively. The adaptive control design task now is to choose some desired adaptive laws (algorithms) to update k1(t) and k2(t) so that the stated control objective is still achievable in the presence of the uncertainties of A and b.\nError model. Defining the parameter errors\nk\u03031(t) = k1(t)\u2212 k\u22171, k\u03032(t) = k2(t)\u2212 k\u22172 (3.5)\nand using (2.3), (2.5), and (3.4), we obtain the closed-loop system\nx(t+ 1) = Ax(t) + b ( kT1 (t)x(t) + k2(t)r(t) )\n= Amx(t) + bmr(t) + bm\n(\n1\nk\u22172 k\u0303T1 (t)x(t) +\n1\nk\u22172 k\u03032(t)r(t)\n)\n. (3.6)\nSubstituting (2.4) in (3.6), we have the tracking error equation\ne(t + 1) = Ame(t) + bm 1\nk\u22172\n( k\u0303T1 (t)x(t) + k\u03032(t)r(t) ) . (3.7)\nIntroducing \u03c1\u2217 = 1/k\u22172 and\n\u03b8(t) = [ kT1 (t), k2(t) ]T \u2208 Rn+1 (3.8)\n\u03b8\u2217 = [\nk\u2217T1 , k \u2217 2\n]T \u2208 Rn+1 (3.9)\n\u03c9(t) = [ xT (t), r(t) ]T \u2208 Rn+1 (3.10) Wm(z) = (zI \u2212 Am)\u22121bm = [wm1(z), wm2(z), . . . , wmn(z)]T , (3.11)\nfrom (3.7), we obtain e(t) = \u03c1\u2217Wm(z)[(\u03b8 \u2212 \u03b8\u2217)T\u03c9](t), 2 (3.12) which, with e(t) = [e1(t), e2(t), . . . , en(t)] T \u2208 Rn, is equivalent to\nei(t) = \u03c1 \u2217wmi(z)[(\u03b8 \u2212 \u03b8\u2217)T\u03c9](t), i = 1, 2, . . . , n. (3.13)\nLetting \u03c1(t) be the estimate of \u03c1\u2217 and introducing\n\u03b6i(t) = wmi(z)[\u03c9](t) \u2208 Rn+1 (3.14) \u03bei(t) = \u03b8 T (t)\u03b6i(t)\u2212 wmi(z)[\u03b8T\u03c9](t) \u2208 R, (3.15)\nwe define the estimation errors\n\u01ebi(t) = ei(t) + \u03c1(t)\u03bei(t), i = 1, 2, . . . , n, (3.16)\nand derive\n\u01ebi(t) = \u03c1 \u2217(\u03b8(t)\u2212 \u03b8\u2217)T \u03b6i(t) + (\u03c1(t)\u2212 \u03c1\u2217)\u03bei(t), i = 1, 2, . . . , n. (3.17)\nAdaptive laws. Similar to Assumption (A3), we make the following assumption on k\u22172:\nAssumption (A4): A lower bound ka2 > 0 of |k\u22172|: ka2 \u2264 |k\u22172|, is known. 3\nIntroducing the cost function J = 1 2\n\u2211\nn i=1 \u01eb2 i m2 , where m = m(t) is a normalization signal to be\ndefined, and deriving its gradients\n\u2202J \u2202\u03b8 = \u03c1\u2217\nn \u2211\ni=1\n\u01ebi\u03b6i m2\n(3.18)\n\u2202J \u2202\u03c1 =\nn \u2211\ni=1\n\u01ebi\u03bei m2 , (3.19)\n2As a notation, y(t) = G(z)[v](t) represents the output y(t) of the system G(z) with input v(t). 3With \u03c1\u2217 = 1/k\u2217\n2 , \u03c1b = 1/ka 2 is an upper bound of |\u03c1\u2217|: |\u03c1\u2217| \u2264 \u03c1b.\nwe choose the adaptive laws for \u03b8(t) and \u03c1(t) as\n\u03b8(t+ 1) = \u03b8(t)\u2212 sign[\u03c1 \u2217]\u0393 \u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t) (3.20)\n\u03c1(t+ 1) = \u03c1(t)\u2212 \u03b3 \u2211n i=1 \u01ebi(t)\u03bei(t)\nm2(t) , (3.21)\nwhere 0 < \u0393 = \u0393T < 2ka2In+1, 0 < \u03b3 < 2, and\nm(t) =\n\u221a \u221a \u221a\n\u221a1 + n \u2211\ni=1\n\u03b6Ti (t)\u03b6i(t) + n \u2211\ni=1\n\u03be2i (t). (3.22)"
        },
        {
            "heading": "3.1.2 Stability Analysis",
            "text": "Consider the positive definite function\nV (\u03b8\u0303, \u03c1\u0303) = |\u03c1\u2217|\u03b8\u0303T\u0393\u22121\u03b8\u0303 + \u03b3\u22121\u03c1\u03032, (3.23)\nwhere the parameter errors are\n\u03b8\u0303(t) = \u03b8(t)\u2212 \u03b8\u2217, \u03c1\u0303(t) = \u03c1(t)\u2212 \u03c1\u2217. (3.24)\nThe time-increment of V (\u03b8\u0303, \u03c1\u0303), along the trajectories of (3.20)-(3.21), is\nV (\u03b8\u0303(t+ 1), \u03c1\u0303(t+ 1))\u2212 V (\u03b8\u0303(t), \u03c1\u0303(t))\n= |\u03c1\u2217| ( \u03b8\u0303(t)\u2212 sign[\u03c1 \u2217]\u0393 \u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t)\n)T \u0393\u22121 ( \u03b8\u0303(t)\u2212 sign[\u03c1 \u2217]\u0393 \u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t)\n)\n+\n(\n\u03c1\u0303(t)\u2212 \u03b3 \u2211n i=1 \u01ebi(t)\u03bei(t)\nm2(t)\n) \u03b3\u22121 ( \u03c1\u0303(t)\u2212 \u03b3 \u2211n i=1 \u01ebi(t)\u03bei(t)\nm2(t)\n)\n\u2212 ( |\u03c1\u2217|\u03b8\u0303T (t)\u0393\u22121\u03b8\u0303(t) + \u03b3\u22121\u03c1\u03032(t) )\n=\u22122\u03c1 \u2217\u2211n i=1 \u01ebi(t)\u03b6 T i (t)\u03b8\u0303(t)\nm2(t) +\n\u2211n i=1 \u01ebi(t)\u03b6 T i (t)\nm2(t) |\u03c1\u2217|\u0393\n\u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t)\n\u22122 \u2211n i=1 \u01ebi(t)\u03bei(t)\u03c1\u0303(t)\nm2(t) +\n\u2211n i=1 \u01ebi(t)\u03bei(t)\nm2(t) \u03b3\n\u2211n i=1 \u01ebi(t)\u03bei(t)\nm2(t)\n=\u22122 \u2211n i=1 \u01eb 2 i (t)\nm2(t) +\n\u2211n i=1 \u01ebi(t)\u03b6 T i (t)\nm2(t) |\u03c1\u2217|\u0393\n\u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t)\n+\n\u2211n i=1 \u01ebi(t)\u03bei(t)\nm2(t) \u03b3\n\u2211n i=1 \u01ebi(t)\u03bei(t)\nm2(t) (3.25)\nwhere, with \u2016 \u00b7 \u20162 being the l2 vector norm and \u03b31 \u2208 (0, 2) being the maximum eigenvalue of |\u03c1\u2217|\u0393, \u2211n\ni=1 \u01ebi(t)\u03b6 T i (t)\nm2(t) |\u03c1\u2217|\u0393\n\u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t)\n\u2264 \u03b31 \u2211n i=1 |\u01ebi(t)|\u2016\u03b6i(t)\u20162 m2(t) \u2211n i=1 |\u01ebi(t)|\u2016\u03b6i(t)\u20162 m2(t)\n\u2264 \u03b31\n\u221a\n\u2211n i=1 |\u01ebi(t)|2\n\u221a\n\u2211n i=1 \u2016\u03b6i(t)\u201622\nm2(t)\n\u221a\n\u2211n i=1 |\u01ebi(t)|2\n\u221a\n\u2211n i=1 \u2016\u03b6i(t)\u201622\nm2(t)\n= \u03b31\n\u2211n i=1 |\u01ebi(t)|2 \u2211n i=1 \u2016\u03b6i(t)\u201622\nm4(t)\n= \u03b31\n\u2211n i=1 \u01eb 2 i (t) \u2211n i=1 \u03b6 T i (t)\u03b6i(t)\nm4(t) , (3.26)\nwhere, Schwarz inequality is used for the second inequality above, and similarly, \u2211n\ni=1 \u01ebi(t)\u03bei(t)\nm2(t) \u03b3\n\u2211n i=1 \u01ebi(t)\u03bei(t)\nm2(t)\n\u2264 \u03b3 \u2211n i=1 |\u01ebi(t)||\u03bei(t)| m2(t) \u2211n i=1 |\u01ebi(t)||\u03bei(t)| m2(t) \u2264 \u03b3 \u221a \u2211n i=1 |\u01ebi(t)|2 \u221a \u2211n i=1 |\u03bei(t)|2\nm2(t)\n\u221a\n\u2211n i=1 |\u01ebi(t)|2\n\u221a\n\u2211n i=1 |\u03bei(t)|2\nm2(t)\n= \u03b3\n\u2211n i=1 |\u01ebi(t)|2 \u2211n i=1 |\u03bei(t)|2\nm4(t)\n= \u03b3\n\u2211n i=1 \u01eb 2 i (t) \u2211n i=1 \u03be 2 i (t)\nm4(t) . (3.27)\nFinally, for \u03b30 = max{\u03b31, \u03b3} \u2208 (0, 2), we arrive at\nV (\u03b8\u0303(t+ 1), \u03c1\u0303(t+ 1))\u2212 V (\u03b8\u0303(t), \u03c1\u0303(t)) \u2264 \u2212(2 \u2212 \u03b30) \u2211n i=1 \u01eb 2 i (t)\nm2(t) \u2264 0, (3.28)\nfrom which we have the following desired properties:\nLemma 3.1 The adaptive laws (3.20)-(3.21) ensure:\n(i) \u03b8(t), \u03c1(t) and \u2211 n i=1 \u01eb2 i (t)\nm2(t) are bounded; and\n(ii) \u01ebi(t) m(t) \u2208 L2, i = 1, 2, . . . , n, \u03b8(t+ 1)\u2212 \u03b8(t) \u2208 L2, \u03c1(t + 1)\u2212 \u03c1(t) \u2208 L2.\nIn this discrete-time case, Property (ii) implies: limt\u2192\u221e \u01ebi(t) m(t) = 0, i = 1, 2, . . . , n, limt\u2192\u221e(\u03b8(t +\n1)\u2212 \u03b8(t)) = 0, and limt\u2192\u221e(\u03c1(t + 1)\u2212 \u03c1(t)) = 0. We can then establish the following result:\nTheorem 3.1 The adaptive controller (3.4), updated from the adaptive law (3.20)\u2013(3.21) and applied to the plant (2.3), ensures that all closed-loop system signals are bounded and limt\u2192\u221e(x(t)\u2212 xm(t)) = 0.\nProof: We first apply the discrete-time swapping lemma [6, page 366], [15, page 411] to the signals \u03bei(t) in (3.15): for a minimal realization (Ai, bi, ci) of wmi(z) = ci(zI \u2212 A)\u22121bi, with hic(z) = ci(zI \u2212A)\u22121 and hib(z) = (zI \u2212 A)\u22121b both stable and strictly proper, \u03bei(t) can be expressed as\n\u03bei(t) = \u03b8 T (t)\u03b6i(t)\u2212 wmi(z)[\u03b8T\u03c9](t)\n= hic(z)[(z \u2212 1)[\u03b8T ]zhib(z)[\u03c9]](t), (3.29)\nin which (z \u2212 1)[\u03b8](t) = \u03b8(t+ 1)\u2212 \u03b8(t) \u2208 L2 (that is, k1(t+ 1)\u2212 k1(t) \u2208 L2, k2(t+ 1)\u2212 k2(t) \u2208 L2), \u03c9(t) = [ xT (t), r(t) ]T\nand zhib(z) is stable and proper.\nThe above \u03bei(t) can be further expressed as\n\u03bei(t) = hic(z)[(z \u2212 1)[\u03b8T ]hib(z)[z[\u03c9]]](t) = hic(z)[(z \u2212 1)[\u03b8T ]hib(z)[[(Ax+ b(kT1 x+ k2r))T , r\u0304]T ]](t), (3.30)\nwhere r\u0304(t) = r(t + 1) and z[\u03c9](t) = \u03c9(t+ 1) = [xT (t + 1), r(t+ 1)]T with x(t + 1) = Ax(t) + bu(t) and u(t) = kT1 (t)x+ k2(t)r(t).\nWith \u01eb(t) = [\u01eb1(t), \u01eb2(t), . . . , \u01ebn(t)] T and \u03be(t) = [\u03be1(t), \u03be2(t), . . . , \u03ben(t)] T , from (3.16), we have\nx(t) = xm(t) + \u01eb(t)\u2212 \u03c1(t)\u03be(t). (3.31)\nDenoting the l1 vector norm of x(t) as\n\u2016x(t)\u2016 = \u2016x(t)\u20161 = |x1(t)|+ |x2(t)|+ \u00b7 \u00b7 \u00b7+ |xn(t)|, (3.32)\nwith m(t) = \u221a 1 + \u2211n\ni=1 \u03b6 T i (t)\u03b6i(t) + \u2211n i=1 \u03be 2 i (t), from (3.31), we obtain\n\u2016x(t)\u2016 \u2264 \u2016xm(t)\u2016+ \u2016\u01eb(t)\u2016 m(t) m(t) + |\u03c1(t)|\u2016\u03be(t)\u2016, (3.33)\nwhere \u2016\u01eb(t)\u2016 m(t) \u2208 L2 \u2229 L\u221e, and\nm(t) \u2264 1 + n \u2211\ni=1\n\u2016\u03b6i(t)\u2016+ \u2016\u03be(t)\u2016. (3.34)\nBasic operator concepts. A linear time-invariant system has a transfer function T (z) which can be considered as an operator operating on an input signal u(t) to generate an output signal y(t): y(t) = T (z)[u](t), where z is the time-advance operator: z[u](t) = u(t+ 1), in discrete time.\nA (scalar) linear operator T (z, t) represents a linear input-output relationship of a possibly\ntime-varying dynamic system whose output is y(t) = T (z, \u00b7)[u](t) \u2208 R, for an input u(t) \u2208 R.\nDefinition 3.1 A linear operator T (z, t) is stable and proper if\n|y(t)| = |T (z, \u00b7)[u](t)| \u2264 \u03b2 t\u22121 \u2211\n\u03c4=0\ne\u2212\u03b1(t\u22121\u2212\u03c4)|u(\u03c4)|+ \u03b3|u(t)| (3.35)\nfor any u(t) \u2208 R, all t \u2265 0, and some constants \u03b2 > 0, \u03b1 > 0, \u03b3 > 0. A linear operator T (z, t) is stable and strictly proper if it is stable with \u03b3 = 0.\nProposition 3.1 A linear operator T (z, t) is stable and proper if it represents a system described by the difference equation\nP (z)[y](t) = Q(z, t)[u](t), (3.36)\nwhere P (z) is an nth-order constant coefficient polynomial whose zeros are all inside the unit circle of the complex z-plane, and Q(z, t) is an nth-order polynomial with bounded and possibly time-varying coefficients. If the order of Q(z, t) is less than n, then T (z, t) is stable and strictly proper.\nDefinition 3.2 A linear operator T (z, t) is nonnegative if T (z, \u00b7)[u](t) \u2265 0, \u2200u(t) \u2265 0, \u2200t \u2265 0. A nonnegative linear operator T1(z, t) dominates a linear operator T2(z, t) if\n|T2(z, \u00b7)[u](t)| \u2264 T1(z, \u00b7)[u](t), \u2200u(t) \u2265 0, \u2200t \u2265 0. (3.37)\nA nonnegative linear operator T (z, t) is nondecreasing if\nT (z, t)[u1](t) \u2264 T (z, t)[u2](t), \u2200u2(t) \u2265 u1(t) \u2265 0, \u2200t \u2265 0. (3.38)\nProposition 3.2 For any stable and proper (strictly proper) linear operator T2(z, t), there exists a nonnegative, stable and proper (strictly proper) linear operator T1(z, t) which dominates T2(z, t). Such an operator T1(z, t) can be chosen to be nondecreasing.\nOperator-based signal analysis. For \u03b6i(t) = wmi(z)[\u03c9](t) in (3.34) with \u03c9(t) = [ xT (t), r(t) ]T ,\nthere exists a stable, strictly proper and nonnegative operator T\u03b6i(z) such that\n\u2016\u03b6i(t)\u2016 \u2264 T\u03b6i(z)[\u2016x\u2016](t) + c\u03b6i , (3.39)\nfor some constant c\u03b6i > 0. For \u03bei(t) = \u03b8 T (t)\u03b6i(t) \u2212 wmi(z)[\u03b8T\u03c9](t) in (3.29), there exist a stable, strictly proper and nonnegative operator T\u03bei(z) and a constant c\u03bei > 0 such that\n\u2016\u03bei(t)\u2016 \u2264 T\u03bei(z)[\u2016x\u2016](t) + c\u03bei . (3.40)\nWith \u03be(t) = [\u03be1(t), \u03be2(t), . . . , \u03ben(t)] T in (3.34), there exist a stable, strictly proper and nonnegative operator Tm(z) and a constant cm > 0 such that\nn \u2211\ni=1\n\u2016\u03b6i(t)\u2016+ \u2016\u03be(t)\u2016 \u2264 Tm(z)[\u2016x\u2016](t) + cm. (3.41)\nFor \u03bei(t) = hic(z)[(z \u2212 1)[\u03b8T ]hib(z)[[(Ax + b(kT1 x + k2r))T , r\u0304]T ]](t) in (3.30), for \u2206k1(t) = k1(t + 1)\u2212k1(t) \u2208 L2, there exist stable, strictly proper and nonnegative operators Tic(z) and Tib(z, t) and a constant ci > 0 such that\n|\u03bei(t)| \u2264 Tic(z)[\u2016\u2206k1\u2016 Tib(z, \u00b7)[\u2016x\u2016]](t) + ci, (3.42)\nand for the corresponding vector \u03be(t) = [\u03be1(t), \u03be2(t), . . . , \u03ben(t)] T , we have\n\u2016\u03be(t)\u2016 \u2264 Tc(z)[\u2016\u2206k1\u2016 Tb(z, \u00b7)[\u2016x\u2016]](t) + c\u03be (3.43)\nfor some stable, strictly proper and nonnegative operators Tc(z) and Tb(z, t) and some constant c\u03be > 0. From (3.33) and (3.39)-(3.43), we obtain\n\u2016x(t)\u2016 \u2264 \u2016xm(t)\u2016+ \u2016\u01eb(t)\u2016 m(t) (1 + Tm(z)[\u2016x\u2016](t) + cm) + |\u03c1(t)|(Tc(z)[\u2016\u2206k1\u2016 Tb(z, \u00b7)[\u2016x\u2016]](t) + c\u03be)\n= \u2016\u01eb(t)\u2016 m(t) Tm(z)[\u2016x\u2016](t) + |\u03c1(t)|Tc(z)[\u2016\u2206k1\u2016 Tb(z, \u00b7)[\u2016x\u2016]](t)\n+\u2016xm(t)\u2016+ \u2016\u01eb(t)\u2016 m(t) (1 + cm) + |\u03c1(t)|c\u03be, (3.44)\nwhere \u2016xm(t)\u2016+ \u2016\u01eb(t)\u2016m(t) (1+cm)+|\u03c1(t)|c\u03be is bounded. There exists a stable, strictly proper, nonnegative and nondecreasing operator T0(z) such that\n\u2016\u01eb(t)\u2016 m(t) Tm(z)[\u2016x\u2016](t) + |\u03c1(t)|Tc(z)[\u2016\u2206k1\u2016 Tb(z, \u00b7)[\u2016x\u2016]](t)\n\u2264 \u2016\u01eb(t)\u2016 m(t) T0(z)[\u2016x\u2016](t) + |\u03c1(t)|Tc(z)[\u2016\u2206k1\u2016 T0(z)[\u2016x\u2016]](t). (3.45)\nFrom (3.44) and (3.45), it follows that\nT0(z)[\u2016x\u2016](t) \u2264 T0(z)[ \u2016\u01eb\u2016 m T0(z)[\u2016x\u2016]](t) + T0(z)[|\u03c1|Tc(z)[\u2016\u2206k1\u2016 T0(z)[\u2016x\u2016]]](t) + c0, (3.46)\nwhere c0 \u2265 T0(z)[\u2016xm\u2016 + \u2016\u01eb\u2016m (1 + cm) + |\u03c1|c\u03be](t) is a constant. For (3.46), there exists a stable and strictly proper operator T (z) such that\nT0(z)[\u2016x\u2016](t) \u2264 T (z)[ \u2016\u01eb\u2016 m T0(z)[\u2016x\u2016]](t) + T (z)[\u2016\u2206k1\u2016 T0(z)[\u2016x\u2016]](t) + c0\n= T (z)[\n(\n\u2016\u01eb\u2016 m + \u2016\u2206k1\u2016 ) T0(z)[\u2016x\u2016]](t) + c0, (3.47)\nwhere \u2016\u01eb(t)\u2016 m (t) + \u2016\u2206k1(t)\u2016 \u2208 L2 \u2229 L\u221e. The L2 property of \u2016\u01eb(t)\u2016m (t) + \u2016\u2206k1(t)\u2016 ensures a small gain for the feedback structure in terms of T0(z)[\u2016x\u2016](t) in (3.47). A small gain theorem can be applied to (3.47), to prove that T0(z)[\u2016x\u2016](t) is bounded, and so is \u2016x(t)\u2016 from (3.44) and (3.45), so that u(t) = kT1 (t)x+ k2(t)r(t) is bounded. Thus, all system signals are bounded.\nThen, in (3.31), \u01eb(t) \u2208 L2 and \u03be(t) \u2208 L2 as \u03bei(t) \u2208 L2 from (3.30) with (z\u2212 1)[\u03b8](t) = \u03b8(t+ 1)\u2212 \u03b8(t) \u2208 L2. Finally, x(t)\u2212 xm(t) \u2208 L2 so that limt\u2192\u221e(x(t)\u2212 xm(t)) = 0. \u2207\nThe above adaptive control scheme is called a direct adaptive control scheme, as it directly\nupdates the controller parameters \u03b8(t) = [kT1 (t), k2(t)] T ."
        },
        {
            "heading": "3.1.3 An Illustrative Example",
            "text": "Consider the second-order plant: [\nx1(t+ 1) x2(t+ 1)\n]\n=\n[\n1 \u22121 2 1\n] [\nx1(t) x2(t)\n]\n+\n[\n0 2\n]\nu(t), (3.48)\nwith det(zI \u2212 A) = z2 \u2212 2z + 3 and poles: \u22121\u00b1 \u221a 2 i (i = \u221a \u22121), and the reference model system:\n[\nxm1(t+ 1) xm2(t+ 1)\n]\n=\n[\n1 \u22121 1.05 \u22121.2\n] [\nxm1(t) xm2(t)\n]\n+\n[\n0 1\n]\nr(t), (3.49)\nwhose transfer matrix (vector) is\nWm(z) = (zI \u2212 Am)\u22121bm = [wm1(z), wm2(z)]T\n= [ \u22121 z2 + 0.2z \u2212 0.15 , z \u2212 1 z2 + 0.2z \u2212 0.15] T (3.50)\nwith poles: 0.3 and \u22120.5. The matching parameters k\u22171 and k\u22172 for (2.5) are\nk\u22171 = [\u22120.475,\u22121.1]T , k\u22172 = 0.5. (3.51)\nWith \u03c9(t) = [xT (t), r(t)]T and \u03b8(t) = [kT1 (t), k2(t)] T , we have\n\u03b6i(t) = wmi(z)[\u03c9](t), i = 1, 2, (3.52)\nand with u(t) = \u03b8T (t)\u03c9(t), we have\n\u03bei(t) = \u03b8 T (t)\u03b6i(t)\u2212 wmi(z)[u](t), i = 1, 2. (3.53)\nThen, we generate the estimation errors (3.16):\n\u01ebi(t) = ei(t) + \u03c1(t)\u03bei(t), i = 1, 2, (3.54)\nwhere \u03c1(t) is the estimate of \u03c1\u2217 = 1/k\u22172 = 2.\nThe adaptive laws for \u03b8(t) and \u03c1(t) are from (3.20)-(3.21):\n\u03b8(t+ 1) = \u03b8(t)\u2212 sign[\u03c1 \u2217]\u0393 \u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t) (3.55)\n\u03c1(t+ 1) = \u03c1(t)\u2212 \u03b3 \u2211n i=1 \u01ebi(t)\u03bei(t)\nm2(t) , (3.56)\nwhere 0 < \u0393 = \u0393T < 2ka2I3 with k a 2 \u2264 |k\u22172| = 0.5, 0 < \u03b3 < 2, and\nm2(t) = 1 + 2 \u2211\ni=1\n\u03b6Ti (t)\u03b6i(t) + 2 \u2211\ni=1\n\u03be2i (t). (3.57)\nThe control law is from (3.4):\nu(t) = kT1 (t)x(t) + k2(t)r(t), (3.58)\nwhere k1(t) \u2208 R2 and k2(t) \u2208 R are from \u03b8(t): \u03b8(t) = [ kT1 (t), k2(t) ]T \u2208 R3, as the adaptive estimate of the unknown parameter vector \u03b8\u2217 = [k\u2217T1 , k \u2217 2] T , obtained from (3.55).\nSimulation results. The simulation results are shown in Figure 1 (the plant state x1(t), reference model state xm1(t), and tracking error e1(t) = x1(t) \u2212 xm1(t)), for r(t) = sin(0.13t), \u0393 = 0.5I3, \u03b3 = 1.5, \u03b8(0) = 1.25\u03b8 \u2217 and \u03c1(0) = 1.25\u03c1\u2217, and in Figure 2 (the plant state x2(t), reference model state xm2(t), and tracking error e2(t) = x2(t)\u2212 xm2(t)), for the same conditions. Another set of simulation results are shown in Figure 3 (the plant state x1(t), reference model state xm1(t), and tracking error e1(t) = x1(t)\u2212 xm1(t)), for r(t) = sin(0.13t) + sin(1.3t), \u0393 = 0.5I3, \u03b3 = 1.5, \u03b8(0) = 1.25\u03b8\u2217 and \u03c1(0) = 1.25\u03c1\u2217, and in Figure 4 (the plant state x2(t), reference model state xm2(t), and tracking error e2(t) = x2(t)\u2212 xm2(t)), for the same conditions."
        },
        {
            "heading": "3.1.4 Application to Continuous-Time Systems",
            "text": "The gradient design and analysis procedure developed in this subsection for the discrete-time case is also applicable to the continuous-time case, with those discrete-time transfer functions replaced by their corresponding counterpart continuous-time transfer functions, and with a continuous-time system analysis method (using the time-derivative of V (\u03b8\u0303, \u03c1\u0303) = |\u03c1\u2217|\u03b8\u0303T\u0393\u22121\u03b8\u0303+ \u03b3\u22121\u03c1\u03032 as in (3.23)) for the continuous-time versions of the adaptive laws (3.20)-(3.21), given by\n\u03b8\u0307(t) =\u2212sign[\u03c1 \u2217]\u0393 \u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t) , \u0393 = \u0393T > 0 (3.59)\n\u03c1\u0307(t) =\u2212\u03b3 \u2211n i=1 \u01ebi(t)\u03bei(t)\nm2(t) , \u03b3 > 0. (3.60)\nRemark 3.2 The Lyapunov design and analysis procedure for the continuous-time case consists of (2.7)-(2.13) and the control law (2.6), which may not be applicable to the discrete-time case.\nTo further illustrate this situation, from (3.7)-(3.10), we have\ne(t + 1) = Ame(t) + bm 1\nk\u22172 \u03b8\u0303T (t)\u03c9(t), (3.61)\nwhere \u03b8\u0303(t) = \u03b8(t)\u2212 \u03b8\u2217. Consider the positive definite function\nV (e, \u03b8\u0303) = eTPe+ 1\n|k\u22172| \u03b8\u0303T\u0393\u22121\u03b8\u0303, (3.62)\nwhere \u0393 = \u0393T > 0 is to be further specified, P = P T > 0 satisfying ATmPAm\u2212P = \u2212Q for a chosen Q = QT > 0, take the adaptive law for \u03b8(t) in the form\n\u03b8(t + 1) = \u03b8(t) + g(t), (3.63)\nwhere g(t) \u2208 Rn+1 is to be selected, and obtain the time-increment of V as\n\u2206V = V (e(t + 1), \u03b8\u0303(t + 1))\u2212 V (e(t), \u03b8\u0303(t))\n=\u2212eT (t)Qe(t) + 2\u03c9T (t)\u03b8\u0303(t) 1 k\u22172 bTmPAme(t) + \u03c9 T (t)\u03b8\u0303(t) 1 k\u22172 bTmPbm 1 k\u22172 \u03b8\u0303T (t)\u03c9(t)\n+ 2\n|k\u22172| gT (t)\u0393\u22121\u03b8\u0303(t) +\n1\n|k\u22172| gT (t)\u0393\u22121g(t). (3.64)\nIt would be desirable if g(t) could make \u2206V \u2264 \u2212eT (t)Qe(t) (similar to (2.13)), for desired system properties (similar to that in Proposition 2.1), but such a g(t) is yet to be derived, especially, the right sides of (2.10)-(2.11) as the components of g(t) cannot meet such a need."
        },
        {
            "heading": "3.2 Indirect Adaptive Control Design",
            "text": "Consider the discrete-time SIMO linear time-invariant plant (2.3):\nx(t + 1) = Ax(t) + bu(t), x(t) \u2208 Rn, u(t) \u2208 R (3.65)\nand the reference model system (2.4):\nxm(t+ 1) = Amxm(t) + bmr(t), xm(t) \u2208 Rn, r(t) \u2208 R (3.66)\nunder the matching condition (2.5):\nA + bk\u2217T1 = Am, bk \u2217 2 = bm. (3.67)\nPlant parametrization. From the above matching condition, we express\nA = Am \u2212 bm\u03b8\u2217T1 , b = bm\u03b8\u22172, (3.68)\nwhere \u03b8\u22171 = k \u2217\u22121 2 k \u2217 1 and \u03b8 \u2217 2 = k \u2217\u22121 2 . This expression shows that the parameter uncertainties of A and b are essentially that of \u03b8\u22171 and \u03b8 \u2217 2. Hence, the parameters \u03b8 \u2217 1 and \u03b8 \u2217 2 can be considered as the unknown parts of the plant parameters A and b, and we can parametrize the plant (3.65) as\nx(t + 1) = Ax(t) + bu(t) = Amx(t) + bm(\u03b8 \u2217 2u(t)\u2212 \u03b8\u2217T1 x(t)). (3.69)\nEstimator parametrization. We now design an adaptive parameter estimation algorithm to\nestimate the unknown parameters \u03b8\u22171 and \u03b8 \u2217 2 for adaptive control.\nLetting \u03b81(t) and \u03b82(t) be the estimates of \u03b8 \u2217 1 and \u03b8 \u2217 2, based on (3.69), we construct an adaptive\na posteriori state estimator described by the dynamic equation\nx\u0302(t+ 1) = Amx\u0302(t) + bm(\u03b82(t)u(t)\u2212 \u03b8T1 (t)x(t)), (3.70)\nto generate its state vector x\u0302(t) as an adaptive a posteriori estimate of the system state x(t). For the state estimation error ex(t) = x\u0302(t)\u2212x(t), from (3.69)-(3.70), we have the state estimation error dynamic system equation\nex(t+ 1) = Amex(t) + bm((\u03b82(t)\u2212 \u03b8\u22172)u(t)\u2212 (\u03b81(t)\u2212 \u03b8\u22171)Tx(t)), (3.71)\nof the similar form as that in (3.7) without 1/k\u22172:\ne(t+ 1) = Ame(t) + bm ( (k1(t)\u2212 k\u22171)Tx(t) + (k2(t)\u2212 k\u22172)r(t) ) . (3.72)\nHence, (3.71) can be expressed in the form of (3.12) with \u03c1\u2217 = 1 as\nex(t) = Wm(z)[(\u03b8 \u2212 \u03b8\u2217)T\u03c9](t), (3.73)\nwhere\n\u03b8(t) = [ \u03b8T1 (t), \u03b82(t) ]T \u2208 Rn+1 (3.74)\n\u03b8\u2217 = [\n\u03b8\u2217T1 , \u03b8 \u2217 2\n]T \u2208 Rn+1 (3.75)\n\u03c9(t) = [ \u2212xT (t), u(t) ]T \u2208 Rn+1 (3.76) Wm(z) = (zI \u2212 Am)\u22121bm = [wm1(z), wm2(z), . . . , wmn(z)]T . (3.77)\nBased on the state estimation error equation (3.73), we can design an adaptive scheme to update the parameter estimate \u03b8(t), using a similar procedure to that for the direct adaptive control case.\nWith ex(t) = [ex1(t), ex2(t), . . . , exn(t)] T \u2208 Rn, we write (3.73) as\nexi(t) = wmi(z)[(\u03b8 \u2212 \u03b8\u2217)T\u03c9](t), i = 1, 2, . . . , n, (3.78)\nand define the estimation errors\n\u01ebi(t) = exi(t) + \u03bei(t), i = 1, 2, . . . , n, (3.79)\nwhere\n\u03bei(t) = \u03b8 T (t)\u03b6i(t)\u2212Wmi(z)[\u03b8T\u03c9](t) \u2208 R (3.80) \u03b6i(t) = wmi(z)[\u03c9](t) \u2208 Rn+1, (3.81)\nand derive the estimation error equations\n\u01ebi(t) = (\u03b8(t)\u2212 \u03b8\u2217)T \u03b6i(t), i = 1, 2, . . . , n. (3.82)\nAdaptive laws. We choose the adaptive law for \u03b8(t) as\n\u03b8(t + 1) = \u03b8(t)\u2212 \u0393 \u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t) + f\u03b8(t), (3.83)\nwhere \u0393 = diag{\u03931, \u03b32} with \u03931 \u2208 Rn\u00d7n and \u03b32 \u2208 R such that 0 < \u03931 = \u0393T1 < 2In and \u03b32 \u2208 (0, 2),\nm(t) =\n\u221a \u221a \u221a\n\u221a1 + n \u2211\ni=1\n\u03b6Ti (t)\u03b6i(t) (3.84)\nis the normalizing signal, and\nf\u03b8(t) = [0, 0, . . . , 0, f2(t)] T \u2208 Rn+1 (3.85)\nwith f2(t) \u2208 R being a projection signal for \u03b82(t) in \u03b8(t) = [\u03b8T1 (t), \u03b82(t)]T , to ensure:\nsign[\u03b82(t)] = sign[\u03b8 \u2217 2] = sign[k \u2217 2] (3.86)\n|\u03b82(t)| \u2265 \u03b8a2 , (3.87)\nwhere \u03b8a2 > 0 is such that |\u03b8\u22172| \u2265 \u03b8a2 for \u03b8\u22172 = 1/k\u22172 (\u03b8a2 = 1/kb2, see Assumption (A3)).\nParameter projection. For g2(t) \u2208 R being the last component of\ng(t) = \u2212\u0393 \u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t) = [gT1 (t), g2(t)] T \u2208 Rn+1 (3.88)\nin (3.83), corresponding to \u03b8(t) = [\u03b8T1 (t), \u03b82(t)] T , we choose \u03b82(0) such that sign[\u03b82(0)] = sign[\u03b8 \u2217 2] = sign[k\u22172] and |\u03b82(0)| \u2265 \u03b8a2 , and set\nf2(t) =\n{\n0 if sign[k\u22172](\u03b82(t) + g2(t)) \u2265 \u03b8a2 , \u03b8a2 \u2212 \u03b82(t)\u2212 g2(t) otherwise,\n(3.89)\nto satisfy (3.86)-(3.87), as well as\n(\u03b82(t)\u2212 \u03b8\u22172 + g2(t) + f2(t))f2(t) \u2264 0. (3.90)\nStability analysis. Consider the positive definite function\nV (\u03b8\u0303) = \u03b8\u0303T\u0393\u22121\u03b8\u0303, \u03b8\u0303(t) = \u03b8(t)\u2212 \u03b8\u2217. (3.91)\nThe time-increment of V (\u03b8\u0303), along the trajectories of (3.83) without f\u03b8(t), is\nV (\u03b8\u0303(t + 1))\u2212 V (\u03b8\u0303(t))\n=\n(\n\u03b8\u0303(t)\u2212 \u0393 \u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t)\n)T \u0393\u22121 ( \u03b8\u0303(t)\u2212 \u0393 \u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t)\n)\n\u2212\u03b8\u0303T (t)\u0393\u22121\u03b8\u0303(t)\n=\u22122 \u2211n i=1 \u01ebi(t)\u03b6 T i (t)\u03b8\u0303(t)\nm2(t) +\n\u2211n i=1 \u01ebi(t)\u03b6 T i (t)\nm2(t) \u0393\n\u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t)\n=\u22122 \u2211n i=1 \u01eb 2 i (t)\nm2(t) +\n\u2211n i=1 \u01ebi(t)\u03b6 T i (t)\nm2(t) \u0393\n\u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t) (3.92)\nwhere, with \u2016 \u00b7 \u20162 being the l2 vector norm and \u03b31 \u2208 (0, 2) being the maximum eigenvalue of \u0393, and similar to (3.26),\n\u2211n i=1 \u01ebi(t)\u03b6 T i (t)\nm2(t) \u0393\n\u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t) \u2264 \u03b31\n\u2211n i=1 \u01eb 2 i (t) \u2211n i=1 \u03b6 T i (t)\u03b6i(t)\nm4(t) . (3.93)\nIt follows that\nV (\u03b8\u0303(t + 1))\u2212 V (\u03b8\u0303(t)) \u2264 \u2212(2\u2212 \u03b31) \u2211n i=1 \u01eb 2 i (t)\nm2(t) \u2264 0. (3.94)\nBased on its key property (3.90), the parameter projection signal f\u03b8(t) only adds some nonpositive term in V (\u03b8\u0303(t + 1))\u2212 V (\u03b8\u0303(t)), so that from (3.94), we can derive the following results:\nLemma 3.2 The adaptive law (3.83) ensures:\n(i) \u03b8(t) and \u2211 n i=1 \u01eb2 i (t)\nm2(t) are bounded; and\n(ii) \u2211 n i=1 \u01eb2 i (t)\nm2(t) \u2208 L1, that is, \u01ebi(t) m(t) \u2208 L2, i = 1, 2, . . . , n, \u03b8(t+ 1)\u2212 \u03b8(t) \u2208 L2.\nControl signal. With \u03b8(t) = [\u03b8T1 (t), \u03b82(t)] T , we design the adaptive control signal as\nu(t) = kT1 (t)x(t) + k2(t)r(t), k1(t) = \u03b81(t)\n\u03b82(t) , k2(t) =\n1\n\u03b82(t) . (3.95)\nThe adaptive law (3.83) with parameter projection on \u03b82(t) ensures |\u03b82(t)| \u2265 \u03b8a2 > 0 (that is, sign[\u03b8\u22172]\u03b82(t) \u2265 \u03b8a2 > 0) for all t \u2265 0, so that the adaptive control law (3.95) is implementable.\nThis is an indirect adaptive control design, as it first updates the estimates \u03b8(t) = [\u03b8T1 (t), \u03b82(t)] T\nof the uncertain plant parameters \u03b8\u2217 = [\u03b8\u2217T1 , \u03b8 \u2217 2] T in (3.69), and then calculates the controller parameters k1(t) and k2(t) from the plant parameter estimates \u03b8(t).\nSimilar to that in Theorem 3.1, the closed-loop signal boundedness and asymptotic state tracking\n(limt\u2192\u221e(x(t)\u2212 xm(t)) = 0) are also ensured by this adaptive control scheme. To see this, we note that, with the control law (3.95), the estimator equation (3.70) becomes\nx\u0302(t + 1) = Amx\u0302(t) + bmr(t), (3.96)\nwhich, compared with the reference system equation (3.66), implies that x\u0302(t) = xm(t), so that (3.79) also has the form (3.31) with \u03c1(t) = 1 and the proof of Theorem 3.1 for the direct adaptive control scheme is then also applicable to this indirect adaptive control scheme.\nRemark 3.3 Such an indirect adaptive control design using a gradient algorithm based adaptive law is also applicable to the continuous-time case, based on the error equation (2.16) which has a similar form to that in (3.71), with e\u0307x(t) replacing ex(t+ 1), and with a continuous-time version of the adaptive law (3.83):\n\u03b8\u0307(t) = \u2212\u0393 \u2211n i=1 \u01ebi(t)\u03b6i(t)\nm2(t) + f\u03b8(t), (3.97)\nwhere \u0393 = diag{\u03931, \u03b32} with \u03931 \u2208 Rn\u00d7n and \u03b32 \u2208 R such that \u03931 = \u0393T1 > 0 and \u03b32 > 0, m(t) = \u221a 1 + \u2211n\ni=1 \u03b6 T i (t)\u03b6i(t), and f\u03b8(t) = [0, . . . , 0, f2(t)] T is the projection signal whose component\nf2(t) \u2208 R can be similarly designed to that in (2.22)."
        },
        {
            "heading": "4 Designs for Multi-Input Multi-Output Systems",
            "text": "We now consider a multi-input multi-output (MIMO) linear time-invariant plant\nx\u0307(t) x(t+ 1)\n}\n= Ax(t) +Bu(t), (4.1)\nwhere the state vector x(t) \u2208 Rn is available for measurement and is used for generating a state feedback control signal u(t) \u2208 RM , and A \u2208 Rn\u00d7n and B \u2208 Rn\u00d7M are unknown parameter matrices.\nThe control objective is to design u(t) to ensure closed-loop system signal boundedness and\nasymptotic x(t) tracking the state vector xm(t) \u2208 Rn of a reference model system\nx\u0307m(t) xm(t + 1)\n}\n= Amxm(t) +Bmr(t), (4.2)\nwhere Am \u2208 Rn\u00d7n is a constant and stable matrix, Bm \u2208 Rn\u00d7M is a constant matrix, and r(t) \u2208 RM is a bounded reference input for a desired xm(t).\nThe state feedback control law structure is\nu(t) = KT1 (t)x(t) +K2(t)r(t), (4.3)\nwhere K1(t) \u2208 Rn\u00d7M and K2(t) \u2208 RM\u00d7M are estimates of some nominal parameter matrices K\u22171 and K\u22172 to be defined in the following assumptions (similar to Assumptions (A1)-(A2)):\nAssumption (A1M): There exist a constant matrix K\u22171 \u2208 Rn\u00d7M and a nonsingular constant matrix K\u22172 \u2208 RM\u00d7M such that\nA +BK\u2217T1 = Am, BK \u2217 2 = Bm. (4.4)\nAssumption (A2M): In Assumption (A1M), K\u22172 = diag{k\u221721, k\u221722, . . . , k\u22172M}, and sign[k\u22172i], i = 1, 2, . . . ,M , are known.\nFor a continuous-time direct adaptive control design, the following condition is used [15]:\nAssumption (A2Mc): A matrix Sp \u2208 RM\u00d7M is known such that Ms = K\u22172Sp = MTs > 0.\nAssumption (A2M) or (A2Mc) is a generalization of Assumption (A2) to the multi-input case: if M = 1, then K\u22172 = k \u2217 2 \u2208 R and Sp = sign[k\u22172]. While Sp in Assumption (A2Mc) may be complicated to specify for a general and unknown matrix K\u22172 , if K \u2217 2 meets Assumption (A2M): K\u22172 = diag{k\u221721, k\u221722, . . . , k\u22172M}, then Sp is simple, for example,\nSp = diag{sign[k\u221721], sign[k\u221722], . . . , sign[k\u22172M ]}. (4.5)"
        },
        {
            "heading": "4.1 Designs for Continuous-Time Systems",
            "text": "For a continuous-time multi-input plant: x\u0307(t) = Ax(t) + Bu(t), there are two designs: a direct adaptive control design [15] and an indirect adaptive control design [11]. Next, we present such designs with revisions, to solve some additional relevant parameter projection issues."
        },
        {
            "heading": "4.1.1 Direct Adaptive Control Design",
            "text": "For the state tracking error e(t) = x(t)\u2212 xm(t), using (4.1)-(4.4) including the control law (4.3), in the continuous-time case, we can derive the tracking error equation\ne\u0307(t) = Ame(t) +Bm ( K\u2217\u221212 K\u0303 T 1 (t)x(t) +K \u2217\u22121 2 K\u03032(t)r(t) ) , (4.6)\nwhere K\u03031(t) = K1(t)\u2212K\u22171 and K\u03032(t) = K2(t)\u2212K\u22172 . We choose the adaptive laws for the estimates K1(t) and K2(t) as\nK\u0307T1 (t) =\u2212STp BTmPe(t)xT (t) (4.7)\nK\u03072(t) =\u2212STp BTmPe(t)rT (t), (4.8)\nwhere P = P T > 0 satisfying PAm + A T mP = \u2212Q for a chosen Q = QT > 0, and Sp satisfies the condition in Assumption (A2Mc).\nThe time-derivative of the positive definite function\nV = eTPe+ tr[K\u03031M \u22121 s K\u0303 T 1 ] + tr[K\u0303 T 2 M \u22121 s K\u03032], (4.9)\ncan be derived as V\u0307 = \u2212eT (t)Qe(t) \u2264 0, from which we have that e(t), K\u03031(t) and K\u03032(t) are bounded and e(t) \u2208 L2, that is, x(t), K1(t) and K2(t) are bounded, and so is u(t), that is, all closed-loop signals are bounded. From (4.6), it follows that e\u0307(t) is bounded (so that e(t) is uniformly continuous), and with e(t) \u2208 L2 and from Barbalat lemma [7], that limt\u2192\u221e e(t) = 0.\nRemark 4.1 If Assumption (A2M) is used, that is, when K\u22172 = diag{k\u221721, k\u221722, . . . , k\u22172M}, then\nSp = diag{sign[k\u221721]\u03b31, sign[k\u221722]\u03b32, . . . , sign[k\u22172M\u03b3M ]} (4.10)\nwith \u03b3i > 0, i = 1, 2, . . . ,M , is a choice of Sp for the adaptive laws (4.7)-(4.8) which can remain in their forms or have K2(t) be projected to be diagonal: all non-diagonal elements of K2(t) are set to be zero directly. This follows from the sepcial parameter projection setting: the initial values and lower and upper bounds of those non-diagonal elements of K2(t) are set to be zero and the derivatives of those elements are made zero by the corresponding projection signals."
        },
        {
            "heading": "4.1.2 Indirect Adaptive Control Design",
            "text": "An indirect adaptive control design consists of several steps.\nPlant parametrization. From Assumption (A1M), we express\nA = Am \u2212 Bm\u0398\u2217T1 , B = Bm\u0398\u22172, (4.11)\nwith \u0398\u22171 = K \u2217 1(K \u2217\u22121 2 ) T , \u0398\u22172 = K \u2217\u22121 2 , and parametrize the plant (4.1) as\nx\u0307(t) = Ax(t) +Bu(t) = Amx(t) +Bm(\u0398 \u2217 2u(t)\u2212\u0398\u2217T1 x(t)). (4.12)\nParameter estimation. Letting \u03981(t) and \u03982(t) be the estimates of the unknown \u0398 \u2217 1 and \u0398 \u2217 2,\nwe first design an adaptive a posteriori state estimator for x(t):\n\u02d9\u0302x(t) = Amx\u0302(t) +Bm(\u03982(t)u(t)\u2212\u0398T1 (t)x(t)). (4.13)\nFor the state estimation error ex(t) = x\u0302(t)\u2212 x(t), we obtain the error equation\ne\u0307x(t) = Amex(t) +Bm((\u03982(t)\u2212\u0398\u22172)u(t)\u2212 (\u03981(t)\u2212\u0398\u22171)Tx(t)). (4.14)\nWe then choose the adaptive laws for \u03981(t) and \u03982(t):\n\u0398\u03071(t) = \u03931x(t)e T x (t)PBm (4.15) \u0398\u03072(t) =\u2212\u03932BTmPex(t)uT (t) + F2(t), (4.16)\nwhere \u03931 = \u0393 T 1 > 0, \u03932 > 0 is diagonal, P = P T > 0 satisfying PAm + A T mP = \u2212Q for a chosen Q = QT > 0, and F2(t) is a projection signal to be designed.\nFor the positive definite function\nV = eTxPex + tr[(\u03981 \u2212\u0398\u22171)T\u0393\u221211 (\u03981 \u2212\u0398\u22171)] + tr[(\u03982 \u2212\u0398\u22172)T\u0393\u221212 (\u03982 \u2212\u0398\u22172), (4.17)\nwe derive its time-derivative as V\u0307 = \u2212eTxQex \u2264 0, from which we conclude that \u03981(t), \u03982(t) and ex(t) are all bounded, and that ex(t) \u2208 L2.\nRemark 4.2 The adaptive law for \u03981(t) may also be chosen as\n\u0398\u0307T1 (t) = \u03931B T mPex(t)x T (t) (4.18)\nwhere \u03931 = \u0393 T 1 > 0 has different dimensions from that in (4.15).\nIn this case, we consider the positive definite function\nV = eTxPex + tr[(\u03981 \u2212\u0398\u22171)\u0393\u221211 (\u03981 \u2212\u0398\u22171)T ] + tr[(\u03982 \u2212\u0398\u22172)T\u0393\u221212 (\u03982 \u2212\u0398\u22172), (4.19)\nand can also derive its time-derivative as V\u0307 = \u2212eTxQex \u2264 0.\nControl law. The adaptive control law has the form (4.3):\nu(t) = KT1 (t)x(t) +K2(t)r(t), (4.20)\nwhere, for an indirect design, its parameters are calculated from\nKT1 (t) = \u0398 \u22121 2 (t)\u0398 T 1 (t), K2(t) = \u0398 \u22121 2 (t). (4.21)\nTo implement this control law, the parameter estimate \u03982(t) needs to be ensured to be nonsingular for all t \u2265 0, by using parameter projection on \u03982(t). While parameter projection can be easily done if K\u22172 is diagonal or triangular (and so is \u03982(t), as \u0398 \u2217 2 = K \u2217\u22121 2 ), it may also be done using some relevant knowledge of a more general matrix K\u22172 .\nWith the control law (4.20), the estimator equation (4.13) becomes\n\u02d9\u0302x(t) = Amx\u0302(t) +Bmr(t), (4.22)\nthat is, x\u0302(t) is bounded so that x(t) = x\u0302(t) \u2212 ex(t), u(t) in (4.20) and x\u0307(t) in (4.1) are bounded, and limt\u2192\u221e(x\u0302(t) \u2212 xm(t)) = 0 exponentially so that x\u0302(t) \u2212 xm(t) \u2208 L2. Hence we have that x(t)\u2212 xm(t) \u2208 L2, and, with x\u0307(t)\u2212 x\u0307m(t) \u2208 L\u221e, that limt\u2192\u221e(x(t)\u2212 xm(t)) = 0.\nParameter projection under Assumption (A2M). For K\u22172 = diag{k\u221721, k\u221722, . . . , k\u22172M} with sign[k\u22172i] known, i = 1, 2, . . . ,M , we also assume:\nAssumption (A3M): Upper bounds kb2i of |k\u22172i|: kb2i \u2265 |k\u22172i|, i = 1, 2, . . . ,M , are known.\nIn view of (4.11), in terms of \u0398\u22172 = K \u2217\u22121 2 = diag{\u03b8\u221721, \u03b8\u221722, . . . , \u03b8\u22172M} with \u03b8\u22172i = 1/k\u22172i, Assumption (A2M) implies that sign[\u03b8\u22172i], i = 1, 2, . . . ,M , are known, and Assumption (A3M) implies that lower bounds \u03b8a2i = 1/k b 2i of |\u03b8\u22172i|, i = 1, 2, . . . ,M , are known.\nFor parameter projection under the condition that K\u22172 is diagonal (and so is \u0398 \u2217 2, so that \u03982(t) should be made to be diagonal: \u03982(t) = diag{\u03b821(t), \u03b822(t), . . . , \u03b82M (t)}), we set the initial values and the derivatives of the non-diagonal elements of \u03982(t) to be zero, choose F2(t) in (4.16) to be diagonal: F2(t) = diag{f21(t), f22(t), . . . , f2M(t)}, let G2(t) = \u2212\u03932BTmPex(t)uT (t) (with \u03932 = \u03932 > 0 being diagonal) in (4.16) and denote the diagonal elements of G2(t) as g2i(t) for i = 1, 2, . . . ,M , choose \u03b82i(0) to be such that sign[\u03b8 \u2217 2i]\u03b82i(0) \u2265 \u03b8a2i > 0, and set\nf2i(t) =\n  \n  \n0 if sign[\u03b8\u22172i]\u03b82i(t) > \u03b8 a 2i, or\nif sign[\u03b8\u22172i]\u03b82i(t) = \u03b8 a 2i and sign[\u03b8 \u2217 2i]g2i(t) \u2265 0\n\u2212g2i(t) otherwise, (4.23)\nwhich ensures that sign[\u03b82i(t)] = sign[\u03b8 \u2217 2i], |\u03b82i(t)| \u2265 \u03b8a2i > 0 and (\u03b82i(t)\u2212 \u03b8\u22172i)f2i(t) \u2264 0."
        },
        {
            "heading": "4.2 Designs for Discrete-Time Systems",
            "text": "We now consider the discrete-time version of the plant (4.1):\nx(t + 1) = Ax(t) +Bu(t), (4.24)\nwith x(t) \u2208 Rn and u(t) \u2208 RM for M > 1, the reference system (4.2):\nxm(t+ 1) = Amxm(t) +Bmr(t), (4.25)\nwith Am \u2208 Rn\u00d7n stable, Bm \u2208 Rn\u00d7M , and the control law (4.3):\nu(t) = KT1 (t)x(t) +K2(t)r(t), (4.26)\nwith K1(t) \u2208 Rn\u00d7M and K2(t) \u2208 RM\u00d7M as the estimates of some nominal parameter matrices K\u22171 and K\u22172 satisfying Assumption (A1M): A +BK \u2217T 1 = Am, BK \u2217 2 = Bm.\nThe control law (4.26), applied to the plant (4.24), results in\ne(t + 1) = Ame(t) +BmK \u2217\u22121 2 \u0398\u0303 T (t)\u03c9(t), (4.27)\nwhere \u03c9(t) = [xT (t), rT (t)]T and \u0398\u0303(t) = \u0398(t)\u2212\u0398\u2217 with\n\u0398(t) = [KT1 (t), K2(t)] T , \u0398\u2217 = [K\u2217T1 , K \u2217 2 ] T . (4.28)\nThe error equation (4.27) is based on a direct adaptive control formulation in which the parameter matrix \u0398(t) to be updated directly contains the controller parameters K1(t) and K2(t). An indirect adaptive control formulation (see Section 3.2) has a similar equation (see (3.71) for the case of M = 1, with e(t) replaced by an estimation error ex(t), and without the term K \u2217\u22121 2 ). Next, we study the design of a gradient algorithm for discrete-time adaptive control based on such an error equation (to which a Lyapunov algorithm is not applicable)."
        },
        {
            "heading": "4.2.1 An Illustrative Example",
            "text": "We consider an example of the error equation (4.27):\ne(t + 1) = Ame(t) +BmK \u2217\u0398\u0303T (t)\u03c9(t), (4.29)\nfor the case of n = 3 and M = 2: e(t) \u2208 R3, Am \u2208 R3\u00d73, Bm \u2208 R3\u00d72, K\u2217 \u2208 R2\u00d72, \u0398\u0303T (t) = [\u03b8\u03031(t), \u03b8\u03032(t)]\nT = (\u0398(t)\u2212\u0398\u2217)T \u2208 R2\u00d7n\u03b8 , and \u03c9(t) \u2208 Rn\u03b8 . For K\u2217 = [k\u2217ij ] with i = 1, 2, j = 1, 2, and Wm(z) = (zI \u2212 Am)\u22121Bm = [wij(z)] with i = 1, 2, 3,\nj = 1, 2, we have the expression\ne(t) =Wm(z)[K \u2217\u0398\u0303T\u03c9](t)\n=\n\n  w11(z) w12(z) w21(z) w22(z) w31(z) w32(z)\n\n  [\n[\nk\u221711 k \u2217 12 k\u221721 k \u2217 22\n] [\n\u03b8\u0303T1 \u03c9 \u03b8\u0303T2 \u03c9\n]\n](t)\n=\n\n \nw11(z)k \u2217 11 + w12(z)k \u2217 21 w11(z)k \u2217 12 + w12(z)k \u2217 22 w21(z)k \u2217 11 + w22(z)k \u2217 21 w21(z)k \u2217 12 + w22(z)k \u2217 22 w31(z)k \u2217 11 + w32(z)k \u2217 21 w31(z)k \u2217 12 + w32(z)k \u2217 22\n\n \n[\n\u03b8\u0303T1 \u03c9 \u03b8\u0303T2 \u03c9\n]\n](t)\n=\n\n \n(w11(z)k \u2217 11 + w12(z)k \u2217 21)[\u03b8\u0303 T 1 \u03c9](t) + (w11(z)k \u2217 12 + w12(z)k \u2217 22)[\u03b8\u0303 T 2 \u03c9](t) (w21(z)k \u2217 11 + w22(z)k \u2217 21)[\u03b8\u0303 T 1 \u03c9](t) + (w21(z)k \u2217 12 + w22(z)k \u2217 22)[\u03b8\u0303 T 2 \u03c9](t) (w31(z)k \u2217 11 + w32(z)k \u2217 21)[\u03b8\u0303 T 1 \u03c9](t) + (w31(z)k \u2217 12 + w32(z)k \u2217 22)[\u03b8\u0303 T 2 \u03c9](t)\n\n \n(it may not lead to a solution for a general K\u2217 \u2208 R2\u00d72). (4.30)\nTo see this, we examine, for example,\n(w11(z)k \u2217 11 + w12(z)k \u2217 21)[\u03b8\u0303 T 1 \u03c9](t) = k \u2217 11w11(z)[\u03b8\u0303 T 1 \u03c9](t) + k \u2217 21w12(z)[\u03b8\u0303 T 1 \u03c9](t). (4.31)\nSuch a combined signal involves the combined uncertainty of k\u221711 and k \u2217 21, whose sign is uncertain, while the sign of k\u221711 can be specified from the single parameter k \u2217 11.\nHence, we need to consider a diagonal K\u2217 = diag{k\u221711, k\u221722} and then obtain\ne(t) =Wm(z)[K \u2217\u0398\u0303T\u03c9](t)\n=\n\n \nw11(z)k \u2217 11[\u03b8\u0303 T 1 \u03c9](t) + w12(z)k \u2217 22[\u03b8\u0303 T 2 \u03c9](t) w21(z)k \u2217 11[\u03b8\u0303 T 1 \u03c9](t) + w22(z)k \u2217 22[\u03b8\u0303 T 2 \u03c9](t) w31(z)k \u2217 11[\u03b8\u0303 T 1 \u03c9](t) + w32(z)k \u2217 22[\u03b8\u0303 T 2 \u03c9](t)\n\n  . (4.32)\nWith e(t) = [e1(t), e2(t), e3(t)] T , for i = 1, 2, 3, we have\nei(t) = wi1(z)k \u2217 11[\u03b8\u0303 T 1 \u03c9](t) + wi2(z)k \u2217 22[\u03b8\u0303 T 2 \u03c9](t)\n= k\u221711wi1(z)[\u03b8\u0303 T 1 \u03c9](t) + k \u2217 22wi2(z)[\u03b8\u0303 T 2 \u03c9](t). (4.33)\nFor i = 1, 2, 3, we introduce the estimation errors\n\u01ebi(t) = ei(t) + k11(t)\u03bei1(t) + k22(t)\u03bei2(t), (4.34)\nwhere k11(t) and k22(t) are the estimates of k \u2217 11 and k \u2217 22, and\n\u03bei1(t) = \u03b8 T 1 (t)\u03b6i1(t)\u2212 wi1(z)[\u03b8T1 \u03c9](t), \u03b6i1(t) = wi1(z)[\u03c9](t) (4.35) \u03bei2(t) = \u03b8 T 2 (t)\u03b6i2(t)\u2212 wi2(z)[\u03b8T2 \u03c9](t), \u03b6i2(t) = wi2(z)[\u03c9](t). (4.36)\nFrom (4.33)-(4.36), we derive\n\u01ebi(t) = k \u2217 11(\u03b81(t)\u2212 \u03b8\u22171)T \u03b6i1(t) + (k11(t)\u2212 k\u221711)\u03bei1(t)\n+k\u221722(\u03b82(t)\u2212 \u03b8\u22172)T \u03b6i2(t) + (k22(t)\u2212 k\u221722)\u03bei2(t). (4.37)\nConsider the cost function\nJ(\u03b81, \u03b82) =\n\u22113 i=1 \u01eb 2 i\nm2 (4.38)\nand obtain its gradients \u2202J\n\u2202\u03b81 =\nk\u221711 \u22113\ni=1 \u01ebi\u03b6i1 m2(t) , \u2202J \u2202\u03b82 =\nk\u221722 \u22113\ni=1 \u01ebi\u03b6i2 m2(t)\n(4.39)\n\u2202J\n\u2202k11 = \u22113 i=1 \u01ebi\u03bei1 m2(t) , \u2202J \u2202k22 = \u22113 i=1 \u01ebi\u03bei2 m2(t) . (4.40)\nThis motivates us to choose the adaptive laws\n\u03b81(t+ 1) = \u03b81(t)\u2212 sign[k\u221711]\u03931 \u22113 i=1 \u01ebi\u03b6i1\nm2(t) (4.41)\n\u03b82(t+ 1) = \u03b82(t)\u2212 sign[k\u221722]\u03932 \u22113 i=1 \u01ebi\u03b6i2\nm2(t) (4.42)\nk11(t+ 1) = k11(t)\u2212 \u03b31 \u22113 i=1 \u01ebi\u03bei1 m2(t)\n(4.43)\nk22(t+ 1) = k22(t)\u2212 \u03b32 \u22113 i=1 \u01ebi\u03bei2 m2(t) , (4.44)\nwhere 0 < \u0393i = \u0393 T i < 2/|k\u2217ii| and 0 < \u03b3i < 2, i = 1, 2, and\nm(t) =\n\u221a \u221a \u221a\n\u221a1 + 3 \u2211\ni=1\n(\u03b6Ti1(t)\u03b6i1(t) + \u03b6 T i2(t)\u03b6i2(t) + \u03be 2 i1(t) + \u03be 2 i2(t)). (4.45)\nConsider the positive definite function\nV (\u03b8\u03031, \u03b8\u03032, k\u030311, k\u030322) = |k\u221711|\u03b8\u0303T1 \u0393\u221211 \u03b8\u03031 + |k\u221722|\u03b8\u0303T2 \u0393\u221212 \u03b8\u03032 + \u03b3\u221211 k\u0303211 + \u03b3\u221212 k\u0303222 (4.46)\nwhere the parameter errors are\n\u03b8\u0303i(t) = \u03b8i(t)\u2212 \u03b8\u2217i , k\u0303ii(t) = kii(t)\u2212 k\u2217ii, i = 1, 2. (4.47)\nThe time-increment of V can be derived as\nV (\u03b8\u03031(t+ 1), \u03b8\u03032(t+ 1), k\u030311(t + 1), k\u030322(t+ 1))\u2212 V (\u03b8\u03031(t), \u03b8\u03032(t), k\u030311(t), k\u030322(t))\n\u2264\u2212(2 \u2212 \u03b30) \u22113 i=1 \u01eb 2 i (t)\nm2(t) \u2264 0, (4.48)\nfor some \u03b30 \u2208 (0, 2), which leads to the desired properties:\nLemma 4.1 The adaptive laws (4.41)-(4.44) ensure:\n(i) \u03b8i(t) and kii(t), i = 1, 2, and \u2211 3 i=1 \u01eb2 i (t)\nm2(t) are bounded; and\n(ii) \u2211 3 i=1 \u01eb2 i (t)\nm2(t) \u2208 L1, \u01ebi(t) m(t) \u2208 L2, \u03b8i(t+ 1)\u2212 \u03b8i(t) \u2208 L2, kii(t + 1)\u2212 kii(t) \u2208 L2, i = 1, 2.\nSummary. For an error equation (4.29) with a matrix K\u2217 of the form:\ne(t + 1) = Ame(t) +BmK \u2217\u0398\u0303T (t)\u03c9(t), (4.49)\na gradient adaptive law design requires K\u2217 to be diagonal. This applies to a direct adaptive control design for a multi-input discrete-time system: the nominal parameter matrix K\u22172 needs to be diagonal: K\u22172 = diag{k\u221721, k\u221722, . . . , k\u22172M} (see Assumption (A2M)). For an indirect adaptive control design, such an equation has K\u2217 = I, and the input-output model of the above equation is\ne(t) = Wm(z)[\u0398\u0303 T\u03c9](t), Wm(z) = (zI \u2212 Am)\u22121Bm, (4.50)\nand the adaptive scheme for estimating \u0398(t) can be designed following the technique developed in [19]. However, for indirect adaptive control, a submatrix \u03982 (also corresponding to K \u2217 2 ) of \u0398 needs to be made to be nonsingular by parameter projection (similar to that in Section 3.2, where \u03b82(t) needs to be nonzero, for the case of M = 1), which can be easily done if K\u22172 is diagonal."
        },
        {
            "heading": "4.2.2 Direct Adaptive Control Design",
            "text": "We follow the tracking error equation (4.27):\ne(t + 1) = Ame(t) +BmK \u2217\u22121 2 \u0398\u0303 T (t)\u03c9(t), (4.51)\nand, based on the above analysis, in addition to Assumption (A2M), also assume:\nAssumption (A4M): Lower bounds ka2i > 0 of |k\u22172i|: |k\u22172i| \u2265 ka2i, i = 1, 2, . . . ,M , are known.\nThen, denoting \u03c1\u2217i = 1/k \u2217 2i, i = 1, 2, . . . ,M , and\n\u0398(t) = [\u03b81(t), \u03b82(t), . . . , \u03b8M(t)], \u0398 \u2217 = [\u03b8\u22171, \u03b8 \u2217 2, . . . , \u03b8 \u2217 M ], (4.52)\nwith Wm(z) = (zI\u2212Am)\u22121Bm, \u03b8\u0303i(t) = \u03b8i(t)\u2212\u03b8\u2217i , i = 1, 2, . . . ,M , and K\u2217\u221212 = diag{\u03c1\u22171, \u03c1\u22172, . . . , \u03c1\u2217M}, we express (4.51) in the input-output form as\ne(t) = Wm(z)[\n\n     \n\u03c1\u22171\u03b8\u0303 T 1 \u03c9 \u03c1\u22172\u03b8\u0303 T 2 \u03c9 ...\n\u03c1\u2217M \u03b8\u0303 T M\u03c9\n\n      ](t), (4.53)\nwhich, with e(t) = [e1(t), . . . , en(t)] T and Wm(z) = [wij(z)], i = 1, 2, . . . , n, j = 1, 2, . . . ,M , can be further written as\nei(t) = wi1(z)[\u03c1 \u2217 1\u03b8\u0303 T 1 \u03c9](t) + wi2(z)[\u03c1 \u2217 2\u03b8\u0303 T 2 \u03c9](t) + \u00b7 \u00b7 \u00b7+ wiM(z)[\u03c1\u2217M \u03b8\u0303TM\u03c9](t), i = 1, 2, . . . , n\n= \u03c1\u22171wi1(z)[\u03b8\u0303 T 1 \u03c9](t) + \u03c1 \u2217 2wi2(z)[\u03b8\u0303 T 2 \u03c9](t) + \u00b7 \u00b7 \u00b7+ \u03c1\u2217MwiM(z)[\u03b8\u0303TM\u03c9](t). (4.54)\nWe introduce the estimation errors\n\u01ebi(t) = ei(t) + \u03c11(t)\u03bei1(t) + \u03c12(t)\u03bei2(t) + \u00b7 \u00b7 \u00b7+ \u03c1M (t)\u03beiM(t), (4.55)\nwhere \u03c1j(t), j = 1, 2, . . . ,M , are the estimates of \u03c1 \u2217 j , and\n\u03beij(t) = \u03b8 T j (t)\u03b6ij(t)\u2212 wij(z)[\u03b8Tj \u03c9](t), \u03b6ij(t) = wij(z)[\u03c9](t). (4.56)\nFrom (4.54)-(4.56), we derive\n\u01ebi(t) = \u03c1 \u2217 1(\u03b81(t)\u2212 \u03b8\u22171)T \u03b6i1(t) + (\u03c11(t)\u2212 \u03c1\u22171)\u03bei1(t) + \u00b7 \u00b7 \u00b7\n+\u03c1\u2217M(\u03b8M (t)\u2212 \u03b8\u2217M)T \u03b6iM(t) + (\u03c1M(t)\u2212 \u03c1\u2217M)\u03beiM(t). (4.57)\nWe choose the adaptive laws\n\u03b8i(t+ 1) = \u03b8i(t)\u2212 sign[\u03c1\u2217i ]\u0393i \u2211n k=1 \u01ebk\u03b6ki\nm2(t) (4.58)\n\u03c1i(t+ 1) = \u03c1i(t)\u2212 \u03b3i \u2211n k=1 \u01ebk\u03beki m2(t) , (4.59)\nwhere 0 < \u0393i = \u0393 T i |\u03c1\u2217i | < 2I and 0 < \u03b3i < 2, i = 1, 2, . . . ,M , and\nm(t) =\n\u221a \u221a \u221a \u221a\n\u221a1 + n \u2211\ni=1\nM \u2211\nj=1\n(\u03b6Tij(t)\u03b6ij(t) + \u03be 2 ij(t)). (4.60)\nIn view of the definition of \u03c1\u2217i = 1/k \u2217 2i and Assumption (A4M), we can choose 0 < \u0393i = \u0393 T i < k a 2iI with |k\u22172i| \u2265 ka2i > 0, i = 1, 2, . . . ,M , for ka2i known. This adaptive scheme has the same properties as that in Lemma 4.1:\n(i) \u03b8i(t) and \u03c1i(t), i = 1, 2, . . . ,M , and \u2211 n k=1 \u01eb2 k (t)\nm2(t) are bounded; and\n(ii) \u2211 n k=1 \u01eb2 k (t)\nm2(t) \u2208 L1, \u01ebi(t) m(t) \u2208 L2, \u03b8i(t+ 1)\u2212 \u03b8i(t) \u2208 L2, and \u03c1i(t+ 1)\u2212 \u03c1i(t) \u2208 L2, i = 1, 2, . . . ,M .\nRemark 4.3 Under Assumption (A2M), K\u22172 = diag{k\u221721, k\u221722, . . . , k\u22172M}, the matrix K2(t) in \u0398(t) = [KT1 (t), K2(t)] T for (4.51) can also be made to be diagonal by parameter projection.\nFor parameter projection, the gain matrix \u0393i in (4.58) is chosen as \u0393i = diag{\u0393i1,\u0393i2} with \u0393i1 \u2208 Rn\u00d7n and \u0393i2 \u2208 RM\u00d7M which is diagonal. Then, with\n\u0398(t) = [\u03b81(t), \u03b82(t), . . . , \u03b8M(t)] =\n[\nK1(t) KT2 (t)\n]\n, (4.61)\nwe can set the non-diagonal elements of K2(t) as zero."
        },
        {
            "heading": "4.2.3 Indirect Adaptive Control Design",
            "text": "From Assumption (A1M), we express\nA = Am \u2212 Bm\u0398\u2217T1 , B = Bm\u0398\u22172, (4.62)\nwith \u0398\u22171 = K \u2217 1(K \u2217\u22121 2 ) T , \u0398\u22172 = K \u2217\u22121 2 , and parametrize the plant (4.24) as\nx(t + 1) = Ax(t) +Bu(t) = Amx(t) +Bm(\u0398 \u2217 2u(t)\u2212\u0398\u2217T1 x(t)). (4.63)\nParameter estimation. Letting \u03981(t) and \u03982(t) be the estimates of the unknown parameters\n\u0398\u22171 and \u0398 \u2217 2, we design a discrete-time adaptive a posteriori state estimator for x(t):\nx\u0302(t+ 1) = Amx\u0302(t) +Bm(\u03982(t)u(t)\u2212\u0398T1 (t)x(t)). (4.64)\nFor the state estimation error ex(t) = x\u0302(t)\u2212 x(t), we obtain\nex(t+ 1) = Amex(t) +Bm((\u03982(t)\u2212\u0398\u22172)u(t)\u2212 (\u03981(t)\u2212\u0398\u22171)Tx(t)), (4.65)\nwhich, with \u03c9(t) = [\u2212xT (t), uT (t)]T and \u0398\u0303(t) = \u0398(t)\u2212\u0398\u2217 for\n\u0398(t) = [\u0398T1 (t),\u03982(t)] T , \u0398\u2217 = [\u0398\u2217T1 ,\u0398 \u2217 2] T , (4.66)\ncan be expressed in the form of (4.27) or (4.51) without K\u2217\u221212 :\nex(t+ 1) = Amex(t) +Bm\u0398\u0303 T (t)\u03c9(t). (4.67)\nWith Wm(z) = (zI \u2212 Am)\u22121Bm, and \u03b8\u0303i(t) = \u03b8i(t)\u2212 \u03b8\u2217i , i = 1, 2, . . . ,M , for\n\u0398(t) = [\u03b81(t), \u03b82(t), . . . , \u03b8M(t)], \u0398 \u2217 = [\u03b8\u22171, \u03b8 \u2217 2, . . . , \u03b8 \u2217 M ], (4.68)\nwe express (4.67) as\nex(t) = Wm(z)[\n\n     \n\u03b8\u0303T1 \u03c9 \u03b8\u0303T2 \u03c9 ... \u03b8\u0303TM\u03c9\n\n      ](t), (4.69)\nWith ex(t) = [ex1(t), ex2(t), . . . , exn(t)] T and Wm(z) = [wij(z)], i = 1, 2, . . . , n, j = 1, 2, . . . ,M ,\n(4.69) can be written as\nexi(t) = wi1[\u03b8\u0303 T 1 \u03c9](t) + wi2[\u03b8\u0303 T 2 \u03c9](t) + \u00b7 \u00b7 \u00b7+ wiM [\u03b8\u0303TM\u03c9](t). (4.70)\nSimilarly, we introduce the estimation errors\n\u01ebi(t) = exi(t) + \u03bei1(t) + \u03bei2(t) + \u00b7 \u00b7 \u00b7+ \u03beiM(t), (4.71)\nwhere\n\u03beij(t) = \u03b8 T j (t)\u03b6ij(t)\u2212 wij(z)[\u03b8Tj \u03c9](t), \u03b6ij(t) = wij(z)[\u03c9](t). (4.72)\nFrom (4.70)-(4.72), we derive\n\u01ebi(t) = (\u03b81(t)\u2212 \u03b8\u22171)T \u03b6i1(t) + \u00b7 \u00b7 \u00b7+ (\u03b8M (t)\u2212 \u03b8\u2217M)T \u03b6iM(t). (4.73)\nFor i = 1, 2, . . . ,M , we choose the adaptive laws\n\u03b8i(t+ 1) = \u03b8i(t)\u2212 \u0393i \u2211n k=1 \u01ebk\u03b6ki m2(t)\n(4.74)\nwhere 0 < \u0393i = \u0393 T i < 2I, and\nm(t) =\n\u221a \u221a \u221a \u221a\n\u221a1 + n \u2211\ni=1\nM \u2211\nj=1\n(\u03b6Tij(t)\u03b6ij(t) + \u03be 2 ij(t)). (4.75)\nThis adaptive scheme has the same properties as that in Lemma 4.1: (i) \u03b8i(t), i = 1, 2, . . . ,M , and \u2211 n k=1 \u01eb2 k (t)\nm2(t) are bounded; and\n(ii) \u2211 n k=1 \u01eb2 k (t)\nm2(t) \u2208 L1, \u01ebi(t) m(t) \u2208 L2, and \u03b8i(t+ 1)\u2212 \u03b8i(t) \u2208 L2, i = 1, 2, . . . ,M .\nParameter projection. To use \u0398(t) for control design, we need to ensure \u03982(t) in \u0398(t) = [\u0398T1 (t),\u03982(t)] T is nonsingular. This may be achieved by using parameter projection which can be easily done if K\u22172 is diagonal or triangular (and so is \u03982) and if the signs and the upper bounds kb2i \u2265 |k\u22172i| of the diagonal elements k\u22172i of K\u22172 are known, i = 1, 2, . . . ,M .\nFor parameter projection design, we recall\n\u0398(t) = [\u03b81(t), \u03b82(t), . . . , \u03b8M(t)] = [\u0398 T 1 (t),\u03982(t)] T =\n[\n\u03981(t) \u0398T2 (t)\n]\n, (4.76)\nand modify the adaptive laws (4.74) as\n\u03b8i(t + 1) = \u03b8i(t)\u2212 \u0393i \u2211n k=1 \u01ebk\u03b6ki m2(t) + fi(t), (4.77)\nwhere \u0393i = diag{\u0393i1,\u0393i2} with \u0393i1 \u2208 Rn\u00d7n such that \u0393i1 = \u0393Ti1 > 0 and \u0393i2 \u2208 RM\u00d7M such that \u0393i2 > 0 is diagonal (corresponding to the last M components of \u03b8i(t)), to design the projection functions fi(t) (whose first n components are set to be zero), i = 1, 2, . . . ,M .\nUnder Assumption (A2M), \u0398\u22172 = K \u2217\u22121 2 is diagonal, and we also choose \u03982(t) to be diagonal, which can be done by setting the non-diagonal elements of \u03982(0) and \u03982(t) to be zero for all t > 0. To design the parameter projection signals fi(t), i = 1, 2, . . . ,M , we denote\nF (t) = [f1(t), f2(t), . . . , fM(t)] =\n[\nF1(t) F2(t)\n]\n, (4.78)\nwhere F1(t) \u2208 Rn\u00d7M is set to be zero and F2(t) \u2208 RM\u00d7M is a diagonal matrix whose diagonal elements are denoted as f2i(t), i = 1, 2, . . . ,M . We also denote\ngi(t) = \u2212 \u0393i \u2211n k=1 \u01ebk\u03b6ki m2(t)\n(4.79)\nand form\nG(t) = [g1(t), g2(t), . . . , gM(t)] =\n[\nG1(t) G2(t)\n]\n, (4.80)\nwhere G1(t) \u2208 Rn\u00d7M , and G2(t) \u2208 RM\u00d7M with diagonal elements g2i(t), i = 1, 2, . . . ,M . We denote the diagonal elements of \u03982(t) as \u03b82i(t), i = 1, 2, . . . ,M , and choose \u03b82i(0) such that sign[\u03b82i(0)] = sign[\u03b8 \u2217 2i] = sign[k \u2217 2i] and |\u03b82i(0)| \u2265 \u03b8a2i, where the lower bounds \u03b8a2i = 1/kb2i of |\u03b8\u22172i|, i = 1, 2, . . . ,M , are known (see Assumption (A3M)). We then set the projection signals f2i(t) as\nf2i(t) =\n{\n0 if sign[k\u22172i](\u03b82i(t) + g2i(t)) \u2265 \u03b8a2i, \u03b8a2i \u2212 \u03b82i(t)\u2212 g2i(t) otherwise,\n(4.81)\nto ensure that sign[\u03b82i(t)] = sign[\u03b8 \u2217 2i] = sign[k \u2217 2i] and |\u03b82i(t)| \u2265 \u03b8a2i, and\n(\u03b82i(t)\u2212 \u03b8\u22172i + g2i(t) + f2i(t))f2i(t) \u2264 0. (4.82)\nControl law. The adaptive control law has the form (4.3):\nu(t) = KT1 (t)x(t) +K2(t)r(t), (4.83)\nwhere, for this indirect adaptive control design, its parameters are calculated from\nKT1 (t) = \u0398 \u22121 2 (t)\u0398 T 1 (t), K2(t) = \u0398 \u22121 2 (t), (4.84)\nwhere the parameter matrix \u03982(t) is ensured to be nonsingular for all t \u2265 0, by parameter projection."
        },
        {
            "heading": "4.2.4 Applications to Continuous-Time Systems",
            "text": "The developed direct and indirect gradient algorithm based adaptive control schemes present solutions to the open adaptive state tracking control problems for discrete-time systems. The continuous-time counterpart problems have been solved in the literature, using a Lyapunov method which has not been successfully used for discrete-time systems.\nOn the other hand, the developed gradient algorithm framework can be applied to adaptive\nstate tracking control of continuous-time systems, as illustrated next.\nDirect adaptive control design. The tracking error equation (4.6), similar to (4.51), is\ne\u0307(t) = Ame(t) +BmK \u2217\u22121 2 \u0398\u0303 T (t)\u03c9(t), (4.85)\nand the continuous-time version of (4.53) is\ne(t) = Wm(s)[\n\n     \n\u03c1\u22171\u03b8\u0303 T 1 \u03c9 \u03c1\u22172\u03b8\u0303 T 2 \u03c9 ...\n\u03c1\u2217M \u03b8\u0303 T M\u03c9\n\n      ](t), (4.86)\nfor Wm(s) = (sI \u2212 Am)\u22121Bm = [wij(s)] and e(t) = [e1(t), . . . , en(t)]T . We can also introduce the estimation errors\n\u01ebi(t) = ei(t) + \u03c11(t)\u03bei1(t) + \u03c12(t)\u03bei2(t) + \u00b7 \u00b7 \u00b7+ \u03c1M (t)\u03beiM(t), (4.87)\nwhere \u03c1j(t), j = 1, 2, . . . ,M , are the estimates of \u03c1 \u2217 j , and\n\u03beij(t) = \u03b8 T j (t)\u03b6ij(t)\u2212 wij(s)[\u03b8Tj \u03c9](t), \u03b6ij(t) = wij(s)[\u03c9](t). (4.88)\nWe then choose the adaptive laws\n\u03b8\u0307i(t) =\u2212 sign[\u03c1\u2217i ]\u0393i \u2211n k=1 \u01ebk\u03b6ki\nm2(t) (4.89)\n\u03c1\u0307i(t) =\u2212 \u03b3i \u2211n k=1 \u01ebk\u03beki m2(t) , (4.90)\nwhere \u0393i = \u0393 T i > 0 and \u03b3i > 0, i = 1, 2, . . . ,M , and\nm(t) =\n\u221a \u221a \u221a \u221a\n\u221a1 + n \u2211\ni=1\nM \u2211\nj=1\n(\u03b6Tij(t)\u03b6ij(t) + \u03be 2 ij(t)). (4.91)\nThis adaptive scheme has the desired properties:\nLemma 4.2 The adaptive laws (4.89)-(4.90) ensure:\n(i) \u03b8i(t) and \u03c1i(t), i = 1, 2, . . . ,M , and \u2211 n k=1 \u01eb2 k (t)\nm2(t) are bounded; and\n(ii) \u2211 n k=1 \u01eb2 k (t)\nm2(t) \u2208 L1, \u01ebi(t) m(t) \u2208 L2, \u03b8\u0307i(t) \u2208 L2, \u03c1\u0307i(t) \u2208 L2.\nIndirect adaptive control design. Based on the parametrized plant equation (4.12):\nx\u0307(t) = Ax(t) +Bu(t) = Amx(t) +Bm(\u0398 \u2217 2u(t)\u2212\u0398\u2217T1 x(t)), (4.92)\nand the state estimator equation (4.13):\n\u02d9\u0302x(t) = Amx\u0302(t) +Bm(\u03982(t)u(t)\u2212\u0398T1 (t)x(t)) (4.93)\nfor the state estimation error ex(t) = x\u0302(t)\u2212 x(t), we obtained the error equation (4.14):\ne\u0307x(t) = Amex(t) +Bm((\u03982(t)\u2212\u0398\u22172)u(t)\u2212 (\u03981(t)\u2212\u0398\u22171)Tx(t)), (4.94)\nas the continuous-time version of (4.65), which can be expressed as\ne\u0307x(t) = Amex(t) +Bm\u0398\u0303 T (t)\u03c9(t), (4.95)\nas similar to its discrete-time version (4.67), and further expressed as\nex(t) = Wm(s)[\n\n     \n\u03b8\u0303T1 \u03c9 \u03b8\u0303T2 \u03c9 ... \u03b8\u0303TM\u03c9\n\n      ](t), (4.96)\nas similar to its discrete-time version (4.69).\nFor ex(t) = [ex1(t), ex2(t), . . . , exn(t)] T and Wm(s) = [wij(s)], i = 1, 2, . . . , n, j = 1, 2, . . . ,M , we\ncan similarly introduce the estimation errors\n\u01ebi(t) = exi(t) + \u03bei1(t) + \u03bei2(t) + \u00b7 \u00b7 \u00b7+ \u03beiM(t), (4.97)\nwhere\n\u03beij(t) = \u03b8 T j (t)\u03b6ij(t)\u2212 wij(s)[\u03b8Tj \u03c9](t), \u03b6ij(t) = wij(s)[\u03c9](t). (4.98)\nFor i = 1, 2, . . . ,M , we choose the adaptive laws\n\u03b8\u0307i(t) = \u2212 \u0393i \u2211n k=1 \u01ebk\u03b6ki m2(t)\n(4.99)\nwhere \u0393i = \u0393 T i > 0, and\nm(t) =\n\u221a \u221a \u221a \u221a\n\u221a1 + n \u2211\ni=1\nM \u2211\nj=1\n(\u03b6Tij(t)\u03b6ij(t) + \u03be 2 ij(t)). (4.100)\nThis adaptive scheme has the similar properties to that in Lemma 4.1: (i) \u03b8i(t), i = 1, 2, . . . ,M , and \u2211 n k=1 \u01eb2 k (t)\nm2(t) are bounded; and\n(ii) \u2211 n k=1 \u01eb2 k (t)\nm2(t) \u2208 L1, \u01ebi(t) m(t) \u2208 L2, and \u03b8\u0307i(t) \u2208 L2.\nParameter projection can also be used to ensure that the parameter matrix \u03982(t) in \u0398(t) =\n[\u0398T1 (t),\u03982(t)] T is nonsingular, for calculating the parameters\nKT1 (t) = \u0398 \u22121 2 (t)\u0398 T 1 (t), K2(t) = \u0398 \u22121 2 (t), (4.101)\nto implement the adaptive control law\nu(t) = KT1 (t)x(t) +K2(t)r(t), (4.102)\nDiscussion. Based on the desired adaptive parameter estimation properties (see Lemma 4.2), similar to the procedure for the proof of Theorem 3.1, a continuous-time version of the operatorbased theory can be derived to establish the closed-loop signal boundedness and asymptotic tracking\nof xm(t) by x(t) for the new gradient algorithm based continuous-time adaptive state tracking schemes developed in Section 4.2.4.\nSuch gradient algorithm based adaptive state tracking control schemes are new additions to the Lyapunov algorithm based continuous-time adaptive state tracking schemes presented in Section 4.1 (their single-input versions developed in Section 3 are new additions to that presented in Section 2.2), to expand the solutions to the adaptive state tracking control problems."
        },
        {
            "heading": "5 Concluding Remarks",
            "text": "In this paper, we have studied a new gradient algorithm based framework for adaptive state tracking control of a continuous-time system: x\u0307(t) = Ax(t) + Bu(t) or a discrete-time system: x(t + 1) = Ax(t) + Bu(t), for the state vector x(t) to asymptotically track the state vector xm(t) of a chosen and stable reference model system. The gradient algorithm based framework has been used to develop new direct adaptive control and indirect adaptive control schemes, either to solve the open discrete-time state tracking control problem, or to provide new solutions to the continuous-time adaptive state tracking control problem which was solved in the literature with a Lyapunov method based framework (but its applicability to discrete-time systems has not been verified)."
        }
    ],
    "title": "Discrete-Time Adaptive State Tracking Control Schemes Using Gradient Algorithms",
    "year": 2023
}