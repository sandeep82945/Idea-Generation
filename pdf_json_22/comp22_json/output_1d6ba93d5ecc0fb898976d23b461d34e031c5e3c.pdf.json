{
    "abstractText": "The objective of this study is to construct a multi-department symptom-based automatic diagnosis model. However, it is difficult to establish a model to classify plenty of diseases and collect thousands of diseasesymptom datasets simultaneously. Inspired by the thought of \u201cknowledge graph is model\u201d, this study proposes to build an experience-infused knowledge model by continuously learning the experiential knowledge from data, and incrementally injecting it into the knowledge graph. Therefore, incremental learning and injection are used to solve the data collection problem, and the knowledge graph is modeled and containerized to solve the large-scale multi-classification problems. First, an entity linking method is designed and a heterogeneous knowledge graph is constructed by graph fusion. Then, an adaptive neural network model is constructed for each dataset, and the data is used for statistical initialization and model training. Finally, the weights and biases of the learned neural network model are updated to the knowledge graph. It is worth noting that for the incremental process, we consider both the data and class increments. We evaluate the diagnostic effectiveness of the model on the current dataset and the anti-forgetting ability on the historical dataset after class increment on three public datasets. Compared with the classical model, the proposed model improves the diagnostic accuracy of the three datasets by 5%, 2%, and 15% on average, respectively. Meanwhile, the model under incremental learning has a better ability to resist forgetting.",
    "authors": [
        {
            "affiliations": [],
            "name": "TIAN Yuanyuan"
        }
    ],
    "id": "SP:efc3e9aa92905dea67e85841fa1989d47b96b13e",
    "references": [
        {
            "authors": [
                "W ZHANG",
                "J ZHOU",
                "G LIU"
            ],
            "title": "A study on the online medical consulting websites based on the personal 130",
            "venue": "J. Shanghai Jiao Tong Univ. (Sci.),",
            "year": 2024
        },
        {
            "authors": [
                "C LIU Q",
                "Z. ZHANG P"
            ],
            "title": "Panoramic and personalised intelligent healthcare mode [J",
            "venue": "Journal of Shanghai Jiao Tong University (Science),",
            "year": 2022
        },
        {
            "authors": [
                "R. CUI X"
            ],
            "title": "Profession research on China\u2019s mobile health industry [D",
            "venue": "Beijing: Beijing Foreign Studies University,",
            "year": 2021
        },
        {
            "authors": [
                "A ESTEVA",
                "A ROBICQUET",
                "B RAMSUNDAR"
            ],
            "title": "A guide to deep learning in healthcare",
            "venue": "[J]. Nature Medicine,",
            "year": 2019
        },
        {
            "authors": [
                "Y WEI Z",
                "L LIU Q",
                "L PENG B"
            ],
            "title": "Task-oriented dialogue system for automatic diagnosis",
            "year": 2018
        },
        {
            "authors": [
                "K LIAO",
                "L LIU Q",
                "Y WEI Z"
            ],
            "title": "Task-oriented dialogue system for automatic disease diagnosis via hierarchical reinforcement learning [DB/OL",
            "year": 2004
        },
        {
            "authors": [
                "C KAO H",
                "F TANG K",
                "Y. CHANG E"
            ],
            "title": "Context-aware symptom checking for disease diagnosis using hierarchical reinforcement learning",
            "venue": "[J] .Proceedings of the AAAI Conference on Artificial Intelligence,",
            "year": 2018
        },
        {
            "authors": [
                "Y XIA",
                "B ZHOU J",
                "H SHI Z"
            ],
            "title": "Generative adversarial regularized mutual information policy gradient framework for automatic diagnosis",
            "venue": "[J]. Proceedings of the AAAI Conference on Artificial Intelligence,",
            "year": 2020
        },
        {
            "authors": [
                "X LIN",
                "X ZHOU Q",
                "K GONG"
            ],
            "title": "End-to-End Knowledge-Routed Relational Dialogue System for Automatic Diagnosis [J",
            "venue": "Proceedings of the AAAI Conference on Artificial Intelligence,",
            "year": 2019
        },
        {
            "authors": [
                "X ZHAO",
                "L CHEN",
                "H. CHEN"
            ],
            "title": "A weighted heterogeneous graph-based dialog system [J",
            "venue": "IEEE Transactions on Neural Networks and Learning Systems,",
            "year": 2021
        },
        {
            "authors": [
                "A TIWARI",
                "S SAHA",
                "P. BHATTACHARYYA"
            ],
            "title": "A knowledge infused context driven dialogue agent for disease diagnosis using hierarchical reinforcement learning [J",
            "venue": "Knowledge-Based Systems,",
            "year": 2022
        },
        {
            "authors": [
                "M NILASHI",
                "H AHMADI",
                "A MANAF A"
            ],
            "title": "Coronary heart disease diagnosis through self-organizing map and fuzzy support vector machine with incremental updates",
            "venue": "[J]. International Journal of Fuzzy Systems,",
            "year": 2020
        },
        {
            "authors": [
                "Y RODR\u00cdGUEZ ALDANA",
                "J MARA\u00d1\u00d3N REYES E",
                "S MACIAS F"
            ],
            "title": "Nonconvulsive epileptic seizure monitoring with incremental learning [J",
            "venue": "Computers in Biology and Medicine,",
            "year": 2019
        },
        {
            "authors": [
                "M SIRSHAR",
                "T HASSAN",
                "U AKRAM M"
            ],
            "title": "An incremental learning approach to automatically recognize pulmonary diseases from the multi-vendor chest radiographs",
            "venue": "[J]. Computers in Biology and Medicine,",
            "year": 2021
        },
        {
            "authors": [
                "Q. CHAI X"
            ],
            "title": "Diagnosis method of thyroid disease combining knowledge graph and deep learning [J",
            "venue": "IEEE Access, 2020,",
            "year": 2020
        },
        {
            "authors": [
                "Y XIE",
                "L HU",
                "X CHEN"
            ],
            "title": "Auxiliary diagnosis based on the knowledge graph of TCM syndrome",
            "venue": "[J]. Computers, Materials & Continua,",
            "year": 2020
        },
        {
            "authors": [
                "J XIE",
                "C JIANG J",
                "H WANG Y"
            ],
            "title": "Learning an expandable EMR-based medical knowledge network to enhance clinical diagnosis",
            "venue": "[J]. Artificial Intelligence in Medicine,",
            "year": 2020
        },
        {
            "authors": [
                "W HOU M",
                "R WEI",
                "L LU"
            ],
            "title": "Research review of knowledge graph and its application in medical domain [J",
            "venue": "Journal of Computer Research and Development,",
            "year": 2018
        },
        {
            "authors": [
                "Q SONG D",
                "B ZHOU",
                "W SHEN X"
            ],
            "title": "Dynamic knowledge graph modeling method for ship block manufacturing process [J",
            "venue": "Journal of Shanghai Jiao Tong University,",
            "year": 2021
        },
        {
            "authors": [
                "F FENG G",
                "K DU Z",
                "X. WU"
            ],
            "title": "A Chinese question answering system in medical domain [J",
            "venue": "Journal of Shanghai Jiao Tong University (Science),",
            "year": 2018
        },
        {
            "authors": [
                "Y ZAN H",
                "C HAN Y",
                "X FAN Y"
            ],
            "title": "Construction and analysis of symptom knowledge base in Chinese [J",
            "venue": "Journal of Chinese Information Processing,",
            "year": 2020
        },
        {
            "authors": [
                "Z LIN X",
                "H HE X",
                "Q CHEN"
            ],
            "title": "Enhancing dialogue symptom diagnosis with global attention and symptom graph [C]/",
            "venue": "Conference on Empirical Methods in Natural Language Processing and 9th International Joint Conference on Natural Language Processing. Hong Kong: ACL,",
            "year": 2019
        },
        {
            "authors": [
                "M CUI Y",
                "X CHE W",
                "T LIU"
            ],
            "title": "Revisiting pre-trained models for Chinese natural language processing [DB/OL",
            "year": 2020
        },
        {
            "authors": [
                "M MASANA",
                "X LIU",
                "B TWARDOWSKI"
            ],
            "title": "Classincremental learning: survey and performance evaluation on image classification [DB/OL",
            "year": 2010
        },
        {
            "authors": [
                "R JIN Y",
                "L LIU J",
                "Q LIU Y"
            ],
            "title": "A novel interpretable method based on dual-level attentional deep neural network for actual multilabel arrhythmia detection [J",
            "venue": "IEEE Transactions on Instrumentation and Measurement,",
            "year": 2022
        },
        {
            "authors": [
                "S TEIXEIRA M",
                "V MARAN",
                "M. DRAGONI"
            ],
            "title": "The interplay of a conversational ontology and AI planning for health dialogue management",
            "venue": "ACM/SIGAPP Symposium on Applied Computing. Online. ACM,",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "0 Introduction\nWith the outbreak of COVID-19, online medical treatment has achieved an explosive development. The newly registered users and average daily number of consultations on Chinese medical consulting websites such as Hao Daifu, Dingxiang Doctor, and Chunyu Doctor have successively broken new records[1-2]. These Internet medical platforms mainly provide an online consultation, that is, users describe their symptoms, and doctors give a preliminary diagnosis of related diseases based on the user\u2019s description. However, due to the increase in user number and demand for highquality services, online medical treatment also exposes problems such as imperfect medical data infrastructure and insufficient resources of doctors in various\nReceived: 2022-08-09 Accepted: 2022-08-30 Foundation item: the National Key Research and Develop-\nment Program (No. 2018YFB1307005), and the Smart Medical Project of Shanghai Municipal Commission of Health and Family Planning (No. 2018ZHYL0226)\n\u2217E-mail: chlliu@sjtu.edu.cn\ndepartments[3-4]. In recent years, with the rapid development of artificial intelligence technology, computer vision, natural language processing, and other deep learning methods have profoundly impacted several key fields in medicine[5]. It is of great significance to use artificial intelligence technology to help develop Internet medical treatments such as online consultation.\nRecently, many researchers have paid more attention to automatic disease diagnosis by constructing doctor-patient conversation data generated during an online consultation. Given that multiple rounds of symptom questioning were required to reach a disease conclusion ultimately, the researchers built a taskoriented dialogue system that mimics physician behaviors. The dialogue management module in the dialogue system is mainly implemented by reinforcement learning (RL)[6-9]. Based on the above work, some researchers have introduced medical knowledge into the dialogue system based on reinforcement learning by constructing the dialogue dataset into a knowledge graph[10-12]. Great progress has been made in researching the disease diagnosis using doctor-patient\nconversation data. However, the following problems still exist: The accuracy of the model itself and the dataset result in low diagnosis accuracy, which is inconsistent with the process of improving diagnostic ability through continuous learning in real scenes. These models are learning for a few specific diseases, and it is difficult to extend them to more diseases to achieve a multi-department (hundreds or thousands of diseases) diagnosis.\nModels that focus only on a few specific diseases are difficult to apply to real online consultation scenarios. Therefore, some researchers have researched incremental diagnosis of diseases. In recent years, the methods are all based on support vector machine (SVM) and neural network models[13-15]. These methods benefit from the powerful learning ability and representation ability of machine learning. It can have a better diagnostic effect on specific diseases. However, it is also limited by the output structure of the model, and it is difficult to achieve large increments. The knowledge graph is a structured representation of knowledge. In recent years, some researchers have applied knowledge graphs to the task of disease diagnosis, but these works mainly take knowledge graphs as additional expert knowledge or use their semantic relationship to help existing models to realize disease diagnosis[16-18]. In other words, the knowledge graph only plays an auxiliary role, but it ignores that the knowledge graph itself can be used as a carrier of a huge model.\nThe goal of this study is to build a multi-department level diagnostic model. There are two main difficulties to achieve this goal. First, it is difficult to collect data on thousands of diseases at the same time. Second, even if the data is collected, it is difficult to train a multi-department diagnostic model at one time for the existing model architecture. The diagnosis of diseases by doctors in real scenes is a quantitative reasoning process completed based on a wealth of professional knowledge and with the addition of experience. The improvement of a doctor\u2019s diagnosis is a process of learning and summarizing experience in clinical situations based on professional knowledge. The medical knowledge graph is a structured knowledge extracted from massive medical books and literature[19-20], while medical experience is mainly reflected in numerous electronic medical records and doctor-patient conversations. Therefore, this study believes that we can imitate the learning and growth process of doctors, extract the experience knowledge from doctor-patient conversation data, and continuously inject it into the knowledge graph, to achieve a high-quality multi-department level automatic disease diagnosis.\nBy imitating the learning and diagnosis process of doctors in real situations, this study makes the following contributions to solve the problems such as low accuracy of existing methods, incomplete diseases, and\ninconsistency with real scenes. (1) By collecting medical knowledge and utilizing the technology of graph fusion and entity link, a Chinese medical knowledge graph containing six types of entities including 9 619 diseases and 8 781 symptoms, is constructed. Three Chinese or English disease-symptom datasets are collected and collated to verify the effect of incremental learning.\n(2) An incremental disease automatic diagnosis method based on a weighted heterogeneous graph is proposed, which includes three modules: model initialization based on statistics, model training based on adaptive neural network, and evaluation model. Both data and class increments are handled in this method.\n(3) The experiment is conducted on two evaluation indexes: the diagnosis accuracy of the current dataset and the anti-forgetting ability of the historical dataset. Compared with the classical model, the proposed model improves the diagnosis accuracy by 5%, 2%, and 15% on three public datasets, respectively. At the same time, the proposed method has a better anti-forgetting ability for incremental cases."
        },
        {
            "heading": "1 Graph Fusion and Dataset Preprocessing",
            "text": ""
        },
        {
            "heading": "1.1 Knowledge Graph Construction and Fusion",
            "text": "The purpose of this study is to implement automatic disease diagnosis based on a knowledge graph, so it is crucial to build a standardized knowledge graph of symptoms, diseases, and other entities[21]. We collected two pieces of medical professional knowledge centered on diseases from two Chinese online health communities 39 Health 1\u25cb and Xunyiwenyao 2\u25cb, and then constructed them into knowledge graphs. In addition, we used a Chinese symptom knowledge base constructed by Zhengzhou University[22]. A rule-based graph fusion is performed on these knowledge graphs. 1.1.1 Chinese Symptom Knowledge Base\nThis knowledge base mainly collates the data of 8 772 symptoms, and each symptom\u2019s information includes symptom name, definition, body part, department, related disease, related symptoms, examination, pathogeny, diagnosis, precaution and therapy, and diet, with a total of eleven attributes. The department information in this data is not standardized, and the definition, examination, pathogeny, diagnosis, precaution, therapy, and other attributes are unstructured texts. Therefore, the handling method is to select only symptoms, diseases, and body parts as entities in the knowledge graph, and symptom name, definition, pathogeny, diagnosis, precaution, therapy, and diet as\n1\u25cbhttp://www.39net.com 2\u25cbhttps://www.xywy.com\nthe attributes of symptom entities. 1.1.2 39 Knowledge Graph\nFrom the online health community 39 Health, the data of 7 000 diseases is collected, and each disease\u2019s information includes name, introduction, insurance, infectivity, susceptible population, cost, cure rate, alias, therapy, symptoms and departments, body part, recommend drugs, diet, and related examination, with a total of fifteen attributes. The handling method takes the disease, alias, department, symptom, drug, food, body part, therapy, and examination as entities, and takes the name, introduction, insurance, infectivity, susceptible, cost, and cure rate as the attributes of disease entities. The number of each type of entities is shown in Table 1, and 39 knowledge graph (39KG) is finally constructed.\n1.1.3 XYWY Knowledge Graph Similarly, the information of 8 788 diseases was collected from the online health community Xunyiwenyao, and each disease\u2019s information includes name, introduction, pathogeny, insurance, infectivity, susceptible population, cost, cure rate, precaution, therapy, cure cycle, morbidity, symptoms, departments, recommended drugs, diet, and related examination, with a total of\nseventeen attributes. The introduction, pathogeny, precaution, and therapy are all unstructured texts. The handling method is to take the disease, department, symptoms, drugs, food, and examination as entities, and the name, introduction, pathogeny, insurance, infectivity, cost, cure cycle, susceptible, cure rate, morbidity, precaution, and therapy as the attributes of disease entities. The number of each type of entities is shown in Table 2, and the first letter of the Chinese pinyin of the website is taken as the name to finally build the XYWY knowledge graph (XYWY KG).\n1.1.4 Graph Fusion In this study, a rule-based method is used to do graph fusion. First, the abstract description framework of the knowledge graph is constructed, as shown in Fig. 1. For symptom entities, the Chinese symptom database is used as the base symptom entities, and the symptom entities in 39KG and XYWY KG are fused into the Chinese symptom database. XYWY KG is used as the disease entity base, and the diseases in 39KG are first fused to XYWY KG, and then the disease entity in the Chinese symptom database is fused. Body parts and departments use 39KG as the base entities for fusion. Drugs, food, and examination are directly integrated into the union of the three knowledge graphs. The entities of the final fusion result are shown in Table 3, and the entity relationships are shown in Table 4."
        },
        {
            "heading": "1.2 Disease-Symptom Dataset",
            "text": "In this study, three publicly available automatic disease diagnosis datasets are selected for incremental automatic disease diagnosis. In each sample of the three datasets, the symptom set is used as the characteristic data and the disease is used as the label.\nMZ Dataset[6,23] MZ dataset is a doctor-patient conversation data collected from Chinese medical consulting websites, and symptoms that patients did or did not present are extracted, as well as the final diagnosis conclusions made by doctors. The dataset consists of 710 samples of 4 diseases and 66 symptoms from pediatrics.\nDXY Dataset[10] DXY dataset is also doctorpatient conversation data collected from Chinese medical consulting websites. There are 524 samples of 41 symptoms and 5 diseases in this dataset.\nSynthetic Dataset[7] The synthetic dataset (SD) is a simulated dataset synthesized from a diseasesymptom data website, which collects a total of 30 000 samples of 266 symptoms and 90 diseases. It contains nine sub-datasets (Label1, Label4, \u00b7 \u00b7 \u00b7 , Label19), and the number of diseases and symptoms in the sub-data is shown in Table 5."
        },
        {
            "heading": "1.3 Dataset Post-Processing",
            "text": "Dataset post-processing includes translation from English to Chinese, linking Chinese entities to the\nknowledge graph, and data structure transformation. For the English dataset, the special biomedical dictionary in Baidu Translation is used for translation, and only the SD needs to be translated from English to Chinese. A sample of this dataset is shown in Fig. 2. Entity linking refers to disambiguating the entity reference obtained in the text to identify the corresponding mapping entity in the knowledge graph[19]. Because disease-symptom weights need to be trained from the dataset and injected into the knowledge graph, the disease and symptom entities in the dataset need to be linked to the knowledge graph first. The entity linking approach in this article has three steps, as described in the next three subsections.\n1.3.1 Distributed Representation of Knowledge Graph Entities\nLinking candidate entities to entities in the knowledge graph means calculating the similarity between two entities. With the rapid development of pre-trained language models in recent years, the relationship between texts can be well quantified and calculated by\nusing a high-dimensional vector to represent texts. In this study, a pre-trained Chinese language model, MAC-BERT[24], is used to take the disease and symptom entity in the knowledge graph as the input of the MAC-BERT model and output the distributed representation of the corresponding entity, that is, a 784- dimensional vector. 1.3.2 Text Matching\nFor an entity in the dataset, text matching is successful when the entity exists in the knowledge graph disease and symptom entity set, for example, the symptom entity \u201cabdominal pain\u201d in the dataset also appears in the knowledge graph symptom entities. The entities in the dataset that failed to match are then screened out. 1.3.3 Distributed Representation of Unmatched\nEntities The entities failed to match in Subsection 1.3.2, for example the dataset of entities is \u201c \u201d (headache), and the knowledge graph entity only appeared as \u201c \u201d (headache). The Mac-Bert model in Subsection 1.3.1 is used to calculate the distributed representation of them, and then the cosine similarity between its distributed representation and all the entity distributed representations in the knowledge graph is calculated separately:\nsimilarity = ab\n\u2016a\u2016 \u2016b\u2016 , (1)\nwhere a and b are distributed representations of two different entities.\nThe 50 entities with the highest similarity are selected for manual judgment and selection. For entities like \u201c \u201d (headache) and \u201c \u201d (headache), they are considered to refer to the same meaning, then the entity \u201c \u201d (headache) in the dataset is replaced with \u201c \u201d (headache), and then the entity linking is successful. For the entity that still cannot be matched, for example, the symptom entity \u201cmoderate fever\u201d of the dataset, and no synonym is found in the knowledge graph entity after the manual screening, it will be added to the knowledge graph as a new entity. 1.3.4 Data Structure Conversion\nData structure conversion is processing the three original datasets in order to obtain the dataset structure needed for this study. The three original datasets focus on automatic disease diagnosis and mining of implicit symptoms of users. Implicit symptoms are symptoms that users themselves have appeared but have not stated in their self-reports. This study focuses only on disease diagnosis tasks, so the distinction between explicit and implicit symptoms is ignored, and as long as a user has a certain symptom, it is counted as a feature in this sample. Figure 3 shows a data sample used in this study after processing."
        },
        {
            "heading": "2 Method",
            "text": "The method architecture proposed in this study is shown in Fig. 4, which consists of three modules, namely, the partial weight initialization module based on statistical analysis, the incremental weight training module based on neural network, and the evaluation module. This study is about incremental learning from multiple datasets, so the dataset of this round of incremental learning is called the current dataset, and the dataset before this round of incremental learning is called the historical dataset. In the proposed method, the disease and symptom in the initialization dataset of the current dataset are first statistically analyzed, the weight of the relationship between the disease and symptom is obtained, and then the partial knowledge graph, i.e., the disease-symptom subgraph in the current dataset, is initialized. After initialization, the training set in the current dataset (hereafter referred to as the current training set) and the historical training set are trained by the adaptive neural network model, and then the weight of the extended domain knowledge graph, that is, the disease-symptom subgraph in the current dataset and the historical dataset, is updated. Finally, the test set in the current dataset (hereafter referred to as the current test set) and the historical test set are used to evaluate diagnosis accuracy on the global knowledge graph using the diagnosis model."
        },
        {
            "heading": "2.1 Partial Weight Initialization Based on Statistical Analysis",
            "text": "Partial weight initialization, also called partial subgraph initialization, is a statistical analysis of the initialization dataset of the current dataset, from which the correlation degree and causality of diseases and symptoms are obtained, and then used to initialize the corresponding symptom-to-disease directed relationship weights in the knowledge graph, namely Wij in Fig. 5.\nWhen it is known that a patient has certain or several symptoms, how to infer the disease that the\npatient may suffer from, i.e., whether a certain number of symptoms, can better represent a certain disease. This study draws on the symptom frequencyinverse disease frequency (SF-IDF) proposed by related researchers[11]. The formula group is shown as\nsf-idf(i, j) = sf(i, j)idf(i, j), (2)\nsf(i, j) = nij\u2211\nk\nnkj , (3)\nidf(i, j) = log |D|\n|j : si \u2208 dj | , (4)\nwhere, nij is the number of times the symptom i appears in the disease j, the denominator of Eq. (3) is the total number of symptoms in the disease j, and k is the number of symptom categories that appear in the disease; |D| is the total number of diseases in the dataset, and the denominator of Eq. (4) is the number of times the symptom i appears in the dataset. For example, if a corpus has 4 types of diseases, and a symptom i occurs in 2 of them, then |D| is 4 and |j : si \u2208 dj | is 2[11].\nAs shown in Eq. (2), SF-IDF is a variation of the term frequency-inverse document frequency (TF-IDF) in an information retrieval system. SF-IDF can sta-\ntistically evaluate the importance of a symptom to a disease in the disease database, which increases proportionally with the number of times it appears in that disease category, i.e., Eq. (3), but decreases inversely with the frequency of its appearance in all disease categories, i.e., Eq. (4). For example, the frequency of fever is very high in hand-mouth-foot disease (HMFD), but at the same time it occurs more frequently in many diseases; then ultimately fever is not as important for HMFD. Because fever is a common symptom, it does not differentiate enough for disease diagnosis.\nBecause the research content is incremental weight training, the initial weights in the knowledge graph are all zero, and the trained disease-symptom pair weights will inevitably appear in the subsequent datasets. By this time, some disease-symptom pairs will have trained weights and weights initialized by the new dataset. The initialization method in this study is\nWij = { sf-idf(i, j), Wij = 0 Wij , Wij = 0 . (5)\nIf some weights have been trained, the trained weights will be used; otherwise, the newly calculated SF-IDF will be used. 2.2 Incremental Training Model Based on\nNeural Network The core of the research objective is to build a weighted knowledge graph of a multi-department, which requires multiple datasets with different data distributions. Therefore, such data increment of a certain disease will occur simultaneously in multiple datasets\nand such class increment of different diseases will occur in multiple data sets, as shown in Fig. 6. Given the simultaneous increments of data and class, it is inevitable that historical knowledge will be forgotten. To prevent the learned knowledge from being forgotten, this study sampled historical data to participate in training.\nThe neural network-based weight training model\nmeans that the current training set and the sampled historical training set are used to adaptively construct a neural network with symptoms as input and diseases as output and train the weights of the neural network to update the disease symptom weights in the knowledge graph. The model is divided into four steps, as shown in Fig. 7.\n2.2.1 Adaptive Neural Network Model Construction\nRegarding the selection of historical data, unlike other incremental learning[25], the specificity of data cannot be seen. When selecting historical data, sampling can only be carried out from all historical data. Incremental learning in this study can be selectively sampled. The symptoms in the current dataset that appeared in the historical dataset, i.e., the trained symptoms, are called co-occurrence symptoms. Since the result of training is the weight of disease-symptom pairs, it is only necessary to screen out the data samples containing co-occurring symptoms in the historical training set, and then sample this filtered historical training set.\nAs shown in Step 1 in Fig. 7, the disease-symptom neural network can be constructed by fusing the current training dataset with the sampled historical training set. i.e., all the symptoms and diseases in the fused dataset are respectively taken as the input layer nodes and output layer nodes of the neural network to build a fully connected layer neural network. Because the number and category of diseases and symptoms are variational in different datasets and periods, the constructed neural networks are adaptive. Neural network structure is shown in Fig. 8, with a total of input to output weight wij and output layer bias bj . The reason for using a single-layer neural network is that the causal relationship between diseases and symptoms is directly\nconnected in the neural network, and the training results can be directly applied to the knowledge graph through single-layer neural network training.\n2.2.2 Initializing the Weight of Neural Network After initializing the weights described in Subsection 2.1, the corresponding diseases and symptoms in the knowledge graph have a certain causality and correlation. And a neural network with uninitialized weights has been constructed as described in Subsection 2.2.1. As shown in Step 2 in Fig. 7, before training the neural network, the weights of disease-symptom pairs in the neural network need to be initialized using the corresponding disease-symptom relationship weights in the knowledge graph before training the neural network, and the initialization scheme is\nwij = Wij bj = Bj\n} , (6)\nwhere Bj is the bias in the attributes of the disease j in the knowledge graph. 2.2.3 Neural Network Model Training\nModel training is to train the weights and biases of the fully connected layer in the neural network. The symptom set of each sample in the fused training dataset is used as the input of the neural network by one-hot code, and the disease of each sample is the sample label. The weights of the model are trained using forward and backward propagations in the neural network, and the training process is shown in Algorithm 1.\nAlgorithm 1: Model training Input: features and labels of the training set samples Variables: Batch data generator D iter, loss function\nL, optimizer opt, training round E, adaptive neural network model Net\nInitialization: Initialize the model parameters according to Eq. (6)\nFor E do For X , y in D iter do 1. Input a batch of data into the Net to obtain model\noutput y hat 2. Calculate the L between y and y hat 3. Backpropagation of loss function L 4. The optimizer opt updates the model parameters 5. Calculate the number of correctly predicted samples End\nCalculate the accuracy of the training set End The knowledge graph parameters are updated according to Eq. (7)\n2.2.4 Update of Knowledge Graph Weight Instead of focusing on the overall effect of the trained neural network, the model focuses on the weights of individual disease-symptom pairs in the neural network and the disease bias. As shown in Step 4 in Fig. 7, after the neural network training is completed, the trained parameters need to be updated to the corresponding disease-symptom entity relationship in the knowledge graph as the learned empirical knowledge, and the knowledge graph update rules are\nWij = wij Bj = bj\n} . (7)"
        },
        {
            "heading": "2.3 Evaluation",
            "text": "The evaluation module not only evaluates the diagnostic effect of the disease in the current dataset, but also evaluates the diagnostic effect of the trained disease in the historical data, i.e., evaluating the anti-forgetting ability of the model. Therefore, the test dataset is processed differently from that in Subsection 2.2. Instead, a part of data is directly sampled from all historical datasets in proportion and used to verify the antiforgetting ability.\nThe evaluation in this study is directly implemented on the global knowledge graph, and the diagnosis model pseudocode used in the evaluation is shown in Algorithm 2. For each symptom in each sample, the disease, weight relationships Wij , and disease bias Bj are traversed in the knowledge graph. Then, for all the diseases traversed by symptoms, the sum in the weight relation is added and finally the bias is added. The highest score is considered to be the diagnosis result of the sample.\nAlgorithm 2: Disease diagnosis algorithm Input: The sequence of symptoms in the sample Syms Output: diagnosis result Dis\nVariable: symptom-disease relations weight Wij , disease bias Bj , disease-weight maps W map, disease-bias maps B map, and result maps R map for item in Syms do 1. Query all disease relationship weights Wij and\ndisease bias Bj related to symptom item from the knowledge graph and store them as tempmap and B map respectively.\n2. for dis, wt in temp-map do if dis in W map do\nAccumulate wt to W map else do\nadd dis, wt to W map end end\n3. Sum the W map and B map according to the disease and store them in R map 4. choose the highest value in R map as output"
        },
        {
            "heading": "3 Experiments and Results",
            "text": ""
        },
        {
            "heading": "3.1 Experimental Details",
            "text": "For each dataset, the entities in the dataset are first linked to the knowledge graph using the method in Subsection 2.2. Then, each dataset is divided into an initialization set, training set, and test set according to\na ratio of 4:4:2. After the weight initialization is completed by statistical analysis on the initialization set, the initialization set is added to the training set. The historical data in the training process is selected according to a ratio of 1:1. For example, if there are m samples with co-occurring symptoms in the current data set, m samples with co-occurring symptoms are selected from the historical training set, and if the latter is less than the former, all the latter are selected. The other details of the experiment are shown in Table 6. Batch size, learning rate, and epochs are set according to the characteristics of the dataset. The loss function uses the cross-entropy loss function, the output layer is connected to Softmax for normalization, and the optimizer uses Adam[26]. The incremental order of the experiments is MZ, DXY and SD, among which the nine sub-datasets of SD are incremented according to the numbering order. The experiment is carried out five times, and the final result is the average of the five experiments. The evaluation index of this experiment is the diagnosis accuracy of disease:\ndia acc = CN TN , (8)\nwhere CN is the number of samples correctly diagnosed in the test set, and TN is the total number of samples in the test set.\n3.2 Experimental Results 3.2.1 Comparison\nThe main purpose of this experiment is to evaluate the diagnostic effect on the current dataset and the anti-forgetting ability on the historical dataset after the class increment of the proposed method. The former is compared with some classical disease diagnosis models. First, SVM-EX&IM designed by Wei et al.[6-7] was used as the baseline of the experiment, and then five models based on reinforcement learning, HRL[7], KR-DS[10], Graph-DQN[11], PPO[27] and KI-CD[12], were selected respectively. KR-DS and Graph-DQN both introduce additional knowledge in the model through knowledge graphs. For the latter, this study designs a baseline, which is the fusion training of all historical data and current data at each round of dataset increment, and this baseline is the \u201cupper bound\u201d of accuracy in incremental learning.\n3.2.2 Overall Performance In the absence of incremental case, the diagnostic effect of our method on the current dataset, i.e., ours (current) in Table 7, performs well, with average improvements of 5%, 2%, and 15% in diagnosis accuracy\ncompared with the classical model (the six models mentioned in Table 7) on the three datasets, respectively. The diagnosis accuracy of SD is the weighted average sum of the accuracy of nine sub-datasets, and the weight is the proportion of the number of samples in the test set. The diagnostic accuracy of each sub-dataset is shown in the \u201ccurrent\u201d column in Table 8.\nIn this study, the anti-forgetting ability is defined as the diagnosis accuracy of historical datasets, which is shown in the row of ours (history) in Table 7 and the history column in Table 8 and is the result of sampling and evaluation of all historical test sets in the current round of learning. For example, when learning the label1 dataset, 0.780 is the diagnostic accuracy of the label1 test set, and 0.648 is the diagnostic accuracy of the MZ and DXY test sets after random sampling. The proposed method is compared with the baseline in terms of the training time, diagnostic accuracy of historical dataset, and diagnostic accuracy of current dataset. In terms of the training time, our method uses only 44% of the baseline time. Using baseline in incremental learning provides the highest diagnostic accuracy of the historical dataset, which is the \u201cupper bound\u201d of the diagnostic accuracy of the historical data at the current time in incremental learning. For the diagnostic accuracy of historical datasets, as shown in Fig. 9, our method is not far behind the \u201cupper bound\u201d (the closer the curve is, the better the anti-forgetting ability). The historical data will affect the learning and diagnosis effect of the current data to some extent. As shown in Fig. 10, our model is better than the baseline for the diagnos-\ntic accuracy of the current data. Considering the three indicators comprehensively, it shows that the proposed method can not only ensure a better diagnosis effect on the current dataset, but also have better anti-forgetting ability on the historical dataset after class increment, and the training time is less."
        },
        {
            "heading": "4 Conclusion",
            "text": "Aiming at the goal of building a multi-department disease diagnosis model, we propose an incremental injection of experiential knowledge from data into the knowledge graph. Considering the simultaneous increment of class and data, we propose an incremental automatic disease diagnosis method, which includes three modules: initialization of knowledge graph model based on statistical analysis, training of knowledge graph model based on adaptive neural network, and evaluation model based on knowledge graph. In the experiment, we evaluate the diagnostic effect on the current dataset and the anti-forgetting ability on the historical dataset after the class increment of the proposed method. The diagnosis accuracy of the three datasets is averagely improved by 5%, 2%, and 15% compared with that of the classical model; meanwhile, the antiforgetting ability is close to the \u201cupper bound\u201d of incremental learning. The experimental results show that the proposed method can not only guarantee the diagnosis effect on the current dataset but also have a good anti-forgetting ability. It shows that it is feasible to construct a knowledge graph with experience knowledge and implement multi-department disease diagnosis by incremental learning.\nIn the future work, some new incremental learning methods can be introduced to cope with the simultaneous increment of data and class, to improve the diagnostic performance and anti-forgetting ability at the same time. Multi-layer adaptive networks can also be constructed by constructing heterogeneous knowledge graphs so that more knowledge can be learned during training."
        }
    ],
    "title": "Weighted Heterogeneous Graph-Based Incremental Automatic Disease Diagnosis Method",
    "year": 2024
}