{
    "abstractText": "HAL is a multi-disciplinary open access archive for the deposit and dissemination of scientific research documents, whether they are published or not. The documents may come from teaching and research institutions in France or abroad, or from public or private research centers. L\u2019archive ouverte pluridisciplinaire HAL, est destin\u00e9e au d\u00e9p\u00f4t et \u00e0 la diffusion de documents scientifiques de niveau recherche, publi\u00e9s ou non, \u00e9manant des \u00e9tablissements d\u2019enseignement et de recherche fran\u00e7ais ou \u00e9trangers, des laboratoires publics ou priv\u00e9s. Copyright Measurement of individual color space using a luminous vector field David Alleysson, David M\u00e9ary",
    "authors": [
        {
            "affiliations": [],
            "name": "David Alleysson"
        },
        {
            "affiliations": [],
            "name": "David M\u00e9ary"
        },
        {
            "affiliations": [],
            "name": "DAVID ALLEYSSON"
        },
        {
            "affiliations": [],
            "name": "DAVID M\u00c9ARY"
        }
    ],
    "id": "SP:84d1bfef4f347bd8cf19aa41ec79d0ec843f2155",
    "references": [
        {
            "authors": [
                "K. Seymour",
                "C.W. Clifford",
                "N.K. Logothetis",
                "A. Bartels"
            ],
            "title": "The coding of color, motion, and their conjunction in the human visual cortex",
            "venue": "Current Biology,",
            "year": 2009
        },
        {
            "authors": [
                "D.M. Dacey",
                "Packer",
                "O.S. (2003). Colour coding in the primate retina"
            ],
            "title": "diverse cell types and cone-specific circuitry",
            "venue": "Current opinion in neurobiology, 13(4), 421-427. Lee, B. B., Martin, P. R., & Valberg, A.",
            "year": 1988
        },
        {
            "authors": [
                "P. Lennie",
                "J. Pokorny",
                "Smith",
                "V.C. (1993). Luminance. JOSA A",
                "10(6)",
                "C. 1283-1293. Ripamonti",
                "W.L. Woo",
                "E. Crowther",
                "Stockman",
                "A. (2009). Research Article Journal of the Optical Society of America A 9 The S-cone contribution to luminance depends on the M-",
                "L-cone adaptation levels"
            ],
            "title": "silent surrounds",
            "venue": "Journal of Vision, 9(3), 10-10. Stockman, A., Plummer, D. J., & Montag, E. D. (2005). Spectrally opponent inputs to the human luminance pathway: slow +M and L cone inputs revealed by intense long-wavelength adaptation. The Journal of Physiology, 566(1), 61-76. Webster, M. A., & Mollon, J. D.",
            "year": 1993
        },
        {
            "authors": [
                "S. Anstis",
                "Cavanagh",
                "P. (1983). A minimum motion technique for judging equiluminance. In Color vision"
            ],
            "title": "Physiology and psychophysics Ed",
            "venue": "by JD Mollon, LT Sharpe. p.156-166. Moreland, J. D. (1982). Spectral sensitivity measured by motion photometry. Documenta Ophthalmologica Proceedings Series. Cavanagh, P., MacLeod, D. I., & Anstis, S. M. (1987). Equiluminance: spatial and temporal factors and the contribution of blue-sensitive cones. JOSA A, 4(8), 1428-1438. Webster, M. A., & Mollon, J. D. (1997). Motion minima for different directions in color space. Vision Research, 37(11), 1479-1498. Koenderink, J., van Doorn, A., & Gegenfurtner, K.",
            "year": 2018
        },
        {
            "authors": [
                "R.M. Boynton",
                "P.K. Kaiser"
            ],
            "title": "Vision: the additivity law made to work for heterochromatic photometry with bipartite fields",
            "year": 1968
        },
        {
            "authors": [
                "P.K. Kaiser",
                "R.L. Vimal",
                "W.B. Cowan",
                "Hibino",
                "H. (1989). Nulling of apparent motion as a method for assessing sensation luminance"
            ],
            "title": "an additivity test",
            "venue": "Color Research & Application, 14(4), 187-191. Pokorny, J., Jin, Q., & Smith, V. C. (1993). Spectral-luminosity functions, scalar linearity, and chromatic adaptation. JOSA A, 10(6), 1304-1313. Chichilnisky, E. J., Heeger, D., & Wandell, B. A. (1993). Functional segregation of color and motion perception examined in motion nulling. Vision Research, 33(15), 2113-2125. Hurvich, L. M., & Jameson, D.",
            "year": 1954
        },
        {
            "authors": [
                "P. Suppes",
                "D.H. Krantz",
                "R.D. Luce",
                "A. Tversky"
            ],
            "title": "Foundations of measurement: Geometrical, threshold, and probabilistic representations (Vol",
            "venue": "Courier Corporation. Specially Chapter 15: Color and Force Measurement",
            "year": 2007
        },
        {
            "authors": [
                "Yilmaz H (1961) On color perception. In"
            ],
            "title": "Proceedings of the International School of Physics Enrico Fermi, Course 20",
            "venue": "Evidence for Gravitational Theories. Ed G. Moller (Published in 1962), pp 239-251. Dubois, E. (2009). The structure and properties of color spaces and the representation of color images. Synthesis lectures on image, video, and multimedia processing, 4(1), 1-129. Weinberg, J. W.",
            "year": 1976
        },
        {
            "authors": [
                "D. Alleysson",
                "D. M\u00e9ary"
            ],
            "title": "DataXprt,\u201d figshare (2023), https://doi. org/10.6084/m9.figshare.21707930",
            "year": 2023
        },
        {
            "authors": [
                "D. Alleysson",
                "D. M\u00e9ary"
            ],
            "title": "DataNaive,\u201d figshare (2023), https://doi. org/10.6084/m9.figshare.21707933",
            "year": 2023
        },
        {
            "authors": [
                "F. Csaki"
            ],
            "title": "A concise proof of Sylvester\u2019s theorem",
            "venue": "Periodica Polytechnica Electrical Engineering,",
            "year": 1970
        },
        {
            "authors": [
                "C. Witzel",
                "J. Maule",
                "A. Franklin"
            ],
            "title": "Red, yellow, green, and blue are not particularly colorful",
            "venue": "Journal of Vision,",
            "year": 2019
        },
        {
            "authors": [
                "H. Von Schelling"
            ],
            "title": "Concept of distance in affine geometry and its applications in theories of vision",
            "venue": "Ed R.D. Luce, Lawrence Erlbaum Associates",
            "year": 1956
        },
        {
            "authors": [
                "D.L. MacAdam"
            ],
            "title": "Visual sensitivities to color differences in daylight",
            "venue": "JOSA A,",
            "year": 1942
        },
        {
            "authors": [
                "Wandell",
                "B.A. (1982). Measurement of small color differences. Psychological Review",
                "89(3)",
                "281. Vos",
                "J.J. (2006). From lower to higher colour metrics"
            ],
            "title": "a historical account",
            "venue": "Clinical and Experimental Optometry, 89(6), 348-360. Resnikoff, H. L.",
            "year": 1974
        },
        {
            "authors": [
                "D. Alleysson",
                "D. M\u00e9ary"
            ],
            "title": "Neurogeometry of color vision",
            "venue": "Journal of Physiology-Paris,",
            "year": 2012
        },
        {
            "authors": [
                "J. Petitot"
            ],
            "title": "Neurog\u00e9om\u00e9trie de la vision: modeles mathematiques et physiques des architectures fonctionnelles",
            "venue": "Editions Ecole Polytechnique",
            "year": 2008
        }
    ],
    "sections": [
        {
            "text": "HAL Id: hal-04003481 https://hal.science/hal-04003481\nSubmitted on 24 Feb 2023\nHAL is a multi-disciplinary open access archive for the deposit and dissemination of scientific research documents, whether they are published or not. The documents may come from teaching and research institutions in France or abroad, or from public or private research centers. L\u2019archive ouverte pluridisciplinaire HAL, est destin\u00e9e au d\u00e9p\u00f4t et \u00e0 la diffusion de documents scientifiques de niveau recherche, publi\u00e9s ou non, \u00e9manant des \u00e9tablissements d\u2019enseignement et de recherche fran\u00e7ais ou \u00e9trangers, des laboratoires publics ou priv\u00e9s.\nCopyright\nMeasurement of individual color space using a luminous vector field\nDavid Alleysson, David M\u00e9ary\nTo cite this version: David Alleysson, David M\u00e9ary. Measurement of individual color space using a luminous vector field. Journal of the Optical Society of America. A Optics, Image Science, and Vision, 2023, 40 (3), pp.A199A207. 10.1364/JOSAA.476757. hal-04003481\nMeasurement of individual color space using a luminous vector field DAVID ALLEYSSON1 AND DAVID M\u00c9ARY1\n1Univ. Grenoble Alpes, Univ. Savoie Mont Blanc, CNRS, LPNC, 38000 Grenoble, France *Corresponding author: David.Alleysson (at) univ-grenoble-alpes.fr\nCompiled February 24, 2023\nThis study is intended to measure the geometry of the observer\u2019s color space when viewing a computer screen and to define individual variations from this data. A CIE photometric standard observer assumes that the eye\u2019s spectral efficiency function is constant, and photometry measurements correspond to vectors with fixed directions. By definition, the standard observer decomposes color space into planar surfaces of constant luminance. Using heterochromatic photometry with a minimum motion stimulus, we systematically measure the direction of luminous vectors for many observers and many color points. During the measurement process, the background and stimulus modulation averages are fixed to the given points in order to ensure that the observer is in a fixed adaptation mode. Our measurements result in a vector field or set of vectors (x, v), where x is the point\u2019s color space position, and v is the observer\u2019s luminousity vector. In order to estimate surfaces from vector fields, two mathematical hypotheses were used: (1) that surfaces are quadratic or equivalently that the vector field model is affine, and (2) that the metric of surfaces is proportional to a visual origin. Across twenty-four observers, we found that vector fields are convergent and the corresponding surfaces are hyperbolic. The equation of the surface in the display\u2019s color space coordinate system, and in particular the axis of symmetry, varied systematically from individual to individual. A hyperbolic geometry is compatible with studies that emphasize a modification of the photometric vector with changing adaptations. \u00a9 2023 Optical Society of America\nhttp://dx.doi.org/10.1364/ao.XX.XXXXXX"
        },
        {
            "heading": "1. INTRODUCTION",
            "text": "Human color perception is mediated by three types of retinal light-sensitive cells, the cone-photoreceptors called L, M or S. In order to generate the input required for luminance and motion perception, photoreceptor signals are linearly combined [1]. There is a functional separation between this input and the input for color perception at the level of retinal ganglion cells [2]. Due to the linearity of the luminance channel, it is anticipated that the human eye will exhibit a unique spectral efficiency function.\nThe spectral efficiency functions of human observers have been measured using heterochromatic flicker photometry [3] and correspond to a linear combination of Land M- cone spectral sensitivity only (without S-cone input) at a fixed adaptation state [4]. There was agreement among several observers that led to the establishment of a standard by the commission internationale de l\u2019\u00e9clairage (CIE), CIEV(\u03bb)-1924. These measures were confirmed by different kinds of experiments including minimal distinct\nborder, minimum motion, or test of the additivity principle known as Abney\u2019s law, for which the luminance of a compound light is equal to the sum of the luminances of its composing lights [5, 6]. However, several studies have suggested that the spectral efficiency function may be modulated by an observer\u2019s adaptation to the level of light or to a particular chromatic direction in the color space [4, 7].\nIn any given color space, such as a display\u2019s color space, the consistency of the efficiency function imposes a specific geometry on the standard observer. As will be demonstrated in section 2, V(\u03bb) can be represented by a vector in the color space of a display. The vector defined by V(\u03bb) is the same at any color point. As a result, all the vectors are parallel. The color points with equal luminance also lie on an iso-luminance plane orthogonal to the vectors. From a standard observer\u2019s perspective, photometric measurement by the visual system corresponds to the division of a color space into a pile of iso-luminance planes. However, because the spectral efficiency function may vary with\nthe observer\u2019s adaptation state, the iso-luminant surface could have a different geometry.\nWe define a luminous [8] vector field as a set of (x, v) pairs where x represents the coordinates of a color point p in color space and v represents the coordinates of the local luminous vector orthogonal to the iso-luminous surface at that point. We designed an experiment to estimate the direction and magnitude of the observer\u2019s luminous vector at several points in the display\u2019s color space. Our goal was to determine whether the direction of the observer\u2019s luminous vector corresponded to the direction given by V(\u03bb), forming a field of parallel vectors. A deviation from V(\u03bb) would indicate broken linearity, as well as deformation of the iso-luminous surface by the visual system.\nThe iso-luminous surface of an observer can be reconstructed by predicting v from x using a vector field model. In general, it is difficult to reconstruct the surface from the vector field. To simplify our mathematical analysis, we used an affine model of the form v = 2Ax + a0 that allows only quadratic surfaces with constant curvature. Possible quadratic surfaces include planes (if degenerated), ellipses, and hyperboloids.\nThe constant a0 represents the origin of the observer\u2019s visual system in the affine model. The application of proportionality toward this visual origin enables a unique correspondence between the measured vector field and the observer\u2019s iso-luminous surface for all points in color space. When considering the proportionality between surfaces, the origin and a single surface define the color space metric as a whole. Whatever type of iso-luminous surface is used, be it planar Figure 1(a), elliptical Figure 1(b) or hyperbolic Figure 1(c), they decompose color space into slices of iso-luminous surfaces. The surface corresponds to a plane when the vector field is constant (Figure 1(d)), an ellipsoid if the vector field is divergent (Figure 1(e)), or a hyperboloid if the vector field is convergent (Figure 1(f)).\nIn our experiment, we measured the luminous vector v at several color points of coordinate x in order to estimate the observer\u2019s luminous vector field (i.e. a set of (x, v) pairs). For the purpose of enabling orthogonality, we associated the display color space with a three-dimensional Euclidean space. There is a need in our study for having an orthogonal coordinate system for the display\u2019s color space. We will expressed observer\u2019s model in the display\u2019s coordinate system. If it is not orthogonal, the metric of the observer will be multiplied by the correlation metric of the display. In addition, we will use orthogonality between vectors or vectors to surfaces to design the minimum motion stimulus. This orthogonality will be simplified in Euclidean space. A variation of the minimum motion experiment [5] has been developed to estimate v at a fixed point p of coordinate x. In this experiment, we constrain the observer adaptation state to the given point p by covering the background of the display with the color p. The three-dimensional coordinates of v at a given point were then derived by using two sessions of minimum motion\nin two orthogonal planes. From the measured vector field we reconstruct the iso-luminous surfaces corresponding to the color space of the observer.\nIn the following section we will detail the geometry of the standard photometric observer and demonstrate that it engenders a decomposition of the color space into slices of iso-luminant planes because the spectral efficiency function V(\u03bb) is considered fixed. Then we describe the whole procedure for conducting the experiment and analyzing the data."
        },
        {
            "heading": "2. GEOMETRY OF THE STANDARD PHOTOMETRIC OBSERVER",
            "text": "We call standard photometric observer, hypothetical observer whose spectral efficiency function would be the one defined by the standard CIEV(\u03bb)-1924 and represented in the color space by a vector V\u03bb. Standard observer photometric measurements can be considered as the action of the vector V\u03bb on points p [9]. This action results in measuring the luminance value of the color point p. Luminance value L of a light p produced by the display is defined by the integral of the product between spectrum of light p(\u03bb) and relative spectral efficiency function of the standard photometric observer V\u03bb, by the following formula [10]:\nLuminance(p) = \u222b \u03bbM\n\u03bbm V(\u03bb)p(\u03bb)d\u03bb = L \u2208 R+, (1)\nwhere [\u03bbm, \u03bbM] indicates the wavelength interval for visible light.\nSeveral authors have shown that the spectral function space of light corresponds to a real Hilbert space [11],\nwhich we call the L space. It is particularly true for the set of possible lights emitted by a computer screen. This is because they can be expressed as a linear combination of the primaries of the display phosphors. The integral of Equation 1 can be viewed as a scalar product in L. Taking | f \u3009 as the vector corresponding to the spectral functions f (\u03bb) [12], the real Hilbert space of spectral functions of light L can be defined with [13]:\nLinearity : a| f \u3009+ b|g\u3009 = |a f + bg\u3009 (2) a, b \u2208 R, | f \u3009, |g\u3009, |a f + bg\u3009 \u2208 L\nDuality : \u3008 f | = | f \u3009t, | f \u3009 \u2208 L, \u3008 f | \u2208 L\u2217 (3) Scal. Prod. : \u3008 f |g\u3009 = \u222b f (\u03bb)g(\u03bb)d\u03bb \u2208 R (4)\nEucl. Norm. : \u2016| f \u3009\u2016 = \u221a \u3008 f | f \u3009 \u2208 R+ (5)\nLuminance value of a light p with spectrum p(\u03bb) is given by the scalar product: Luminance(p) = \u3008V|p\u3009, where \u3008V| is the dual vector corresponding to luminous efficiency of the eye, V(\u03bb).\nGeometry underlying standard photometric observer is based on the scalar product in L. Call |P\u3009 the matrix of size N \u00d7 3 containing the three display\u2019s primary emission spectra for N uniformly sampled wavelengths in the interval [\u03bbm, \u03bbM]. The orthogonal projection from spectral vector |x\u3009 to point of coordinate x in three-dimensional display\u2019s color space is given by the linear map \u0153 defined\nby [14]:\n\u0153: L \u2192 R3\n|x\u3009 7\u2192 x = \u0153(|x\u3009) = \u3008P|(PtP)\u2212 1 2 |x\u3009 = \u3008Q|x\u3009 (6)\nwhere Q is an orthogonal basis in which we may represent the primaries P by the vectors \u0153(|P\u3009). Basis of the color space is given by \u0153(|Q\u3009) = \u3008Q|Q\u3009 = 1. This is the canonical basis of R3 (1 is the identity matrix of size 3\u00d7 3). Scalar product in L corresponds to canonical Euclidean scalar product in R3:\nx.y def= xty = \u0153(|x\u3009)t\u0153(|y\u3009) = (\u3008Q|x\u3009)t(\u3008Q|y\u3009) = \u3008x|Q\u3009\u3008Q|y\u3009 = \u3008x|y\u3009 (7)\nLinear application \u0153 defines then an orthogonal projection from L to R3.\nV\u03bb is defined by V\u03bb = \u0153(|V\u3009) and is a fixed vector for the entire display\u2019s color space. An iso-luminant surface is a plane of level \u03ba that is orthogonal to V\u03bb. An iso-luminant plane passing through p of coordinate x is defined by a set of points of coordinate y such that Vt\u03bby = V t \u03bbx. Coordinates of the point `, intersection between the plane orthogonal to V\u03bb passing through p, and the line (OV) is given by ` = \u03baV\u03bb where \u03ba = Vt\u03bbx / Vt\u03bbV\u03bb = L / \u2016V\u03bb\u20162 is a factor of luminance compared to V\u03bb (For our display Vt\u03bbV\u03bb = \u2016V\u03bb\u20162 = 62 cd/m2). Figure 2 illustrates colorimetric observer in the color space of our display.\nStandard photometric observers do not adapt to the overall condition of the scene. Real observers do. Adaptation may result in a deformation of the vector field because the luminous vector will not remain constant. By relaxing the constraint of linearity for photometric measurements, one can use any surface shape for an iso-luminous surface. Restricting to proportional quadratic surfaces is a mathematical trick that allows the vector to be related to the point more easily. By doing so a projective formulation can be developed."
        },
        {
            "heading": "3. METHOD",
            "text": "The color space of the computer display was defined as Euclidean. Euclidean space is required for the definition of the observer\u2019s iso-luminous surface equation and for enabling orthogonality between vectors. For more information, please refer to supplementary method S1-SA. In this space, we are able to measure the luminous vector field using a minimum motion stimulus and compute the observer\u2019s iso-luminous surface based on the vector field."
        },
        {
            "heading": "A. Measuring luminous vector by heterochromatic photometry",
            "text": "We used a modified version of the minimum motion stimulus [5] in order to measure the luminous vector. Minimum motion stimulus consists of a spatial and color contrast modulated in time to produce motion. Motion perception occur when the two colors that compose the stimulus are not of equal luminosity to the observer. Minimum\nmotion takes place in a plane containing heterochromatic modulation between the two colors and homochromatic modulation in an orthogonal direction. Minimum motion is intended to measure the difference in luminosity between two colors, but we have modified it to measure the iso-luminous line on a plane for a single color. The vector orthogonal to this line at the color point represents the projection of the luminous vector onto the plane.\nGiven a point p, we define a plane P1 passing through p,\ncollinear with the vector Q1 = (1, 0, 0) and vn = V\u03bb/\u2016V\u03bb\u2016 with V\u03bb = \u0153(|V\u3009) corresponding to the standard observer\u2019s luminous efficiency vector V\u03bb normalized to 1 (Figure 3(a)). The vector vn is an a priori for the observer\u2019s luminous vector. The angle difference between the observer\u2019s true luminous vector and vn is measured using the minimum motion method. We defined an initial local coordinate system (p, i, j) where i and j are unitary orthogonal vectors (\u2016i\u2016 = 1, \u2016j\u2016 = 1 and i.j = 0) such that (i + j)/ \u221a 2 equals vn. Homochromatic frames are defined as modulations centered on p and in the direction i + j, whereas heterochromatic frames are modulations in the direction i\u2212 j (Figure 3(b)). The heterochromatic and homochromatic modulations in plane P1 are respectively red-green and light-dark yellow. During the test we rotate the local coordinate system around the normal vector n to the P1 plane (Figure 3(c)) depending on the observer\u2019s response to find the minimum motion angle for the observer. The angle at which motion is minimum is estimated using an adaptive procedure (Figure 3(d))(see Supplementary Method S1-SB). The vector corresponding to this angle is called vobs1, which is the observer\u2019s luminous vector estimated at a point p in the plane P1.\nThe minimum motion session is repeated for point p in plane P2, orthogonal to P1 and collinear with vobs1 (Figure 3(e)). For heterochromatic and homochromatic frames, respectively, the modulations are blue-yellow and light-dark gray (the relative contribution of red and green to the gray depends on vobs1 estimation in P1). Because P2 is collinear to vobs1, the result of the luminous vector estimation in the second plane directly defines the three-dimensional coordinates of the observer\u2019s luminous vector vobs at point p."
        },
        {
            "heading": "B. Stimulus",
            "text": "The minimum motion stimulus S(x, t) is defined by its spatial position on the screen x = [0, . . . , X \u2212 1] with X = 192 being the pixels extent, and its temporal variable t = [1, . . . , T] with T = 4 being the number of frames composing the stimulus, according to the following equation:\nS(x, t) = p + i ( m\u03a0( fxx) sin(2\u03c0 ftt)\n\u2212dR\u03a0( fxx + 1/4) cos(2\u03c0 ftt) )\n+ j ( m\u03a0( fxx) sin(2\u03c0 ftt)\n+dR\u03a0( fxx + 1/4) cos(2\u03c0 ftt) ) , (8)\nwith ft = 1/T, fx = Nb/X where Nb = 4 is the number of bars of the same color in the stimulus. We used:\n\u03a0(x) = 2(mod(x, 1) < 1/2)\u2212 1\nto produce a spatial square wave of height bars. In equation 8, (p, i, j) is the local coordinate system around p. The variable d \u2208 [\u22121, 1] changes the direction\nof motion to the left or right for all other parameters fixed. The value of d was randomly changed so that the observer wouldn\u2019t associate the variation in luminosity with the perceived direction of motion.\nThe variables m and R are the contrasts of the homochromatic and heterochromatic frames respectively. The two contrasts are modified with the point p to ensure that the stimulus is visible regardless of the luminance of p. These contrasts were set empirically. The contrasts for the reddest point p1 in the P1 plane is m1 = 1/100 and R1 = 1/10. We set m1 = 1/120 and R1 = 1/12 in the P2 plane. For the other points, the contrasts are proportional to the luminance of the reddest point, for i = [2, . . . , 15], mi = m1Vt\u03bbpi / Vt\u03bbp1 and Ri = R1V t \u03bbpi /\nVt\u03bbp1. The correction is similar for plane P1 and P2.\nThe stimulus is masked by a circular mask surrounded by a uniform background filled with the color of the point p. At a distance of one meter the visual angle of the stimulus is approximately 4.2 degrees. The head is left free but observers are placed against a table to fix the distance to the screen."
        },
        {
            "heading": "C. Procedure",
            "text": "We measure the luminous vectors around several points p of coordinate x. The points may have been picked at random in the Euclidean color space. In order to better understand the geometry of the visual system and compare it to the Euclidean geometry of the display\u2019s color space, we select points from spheres of constant radiometric norm (Figure 4). Spheres are defined by points p of coordinate x such that xtx = r2. There were two experiments conducted. In the long experiment, we measure fifteen points on five spheres of various radii (r = 1, 2, 3, 4, 5), for a total of seventy five points and vectors. In the short experiment, we measure only six points on two spheres (r = 2, 4) for a total of twelve points and vectors. The fifteen or six selected points lie on projective lines across radii (see dashed lines on Figure 4(a)(b)).\nAfter choosing point p, we fill the entire screen with the color corresponding to p during the two minimum motion sessions in P1 and P2 without interruption. The minimum motion stimulus is a slight modulation around point p and has a spatial and temporal average equal to point p. As a result, the observer\u2019s visual system remains fixed on p\u2019s color throughout the measurement.\nAn experiment presentation frame with white letters on a black background is presented before the first stimulus. Any button can then be pressed to move to the first point in the experiment. The duration of the stimulus is set at two seconds and the observer is given an additional one second to make a response before the next stimulus is presented. Observers are asked to respond left or right using the response box of the VSG2.5. When the observer responds the next trial begins. In case of no reponses the trial is not used for the estimation of the minimum motion angle. A measure of the minimum motion angle in one plane includes thirty trials lasting approximately two\nminutes. Two sessions (in P1 and then P2) are required to measure one vector. After two sessions, the screen returns to white writing on a black background, displaying a pause suggestion. The observer is invited to relax and close his eyes for a moment if desired. Any button can then be pressed to move to the next point in the experiment. For the short experiment, when all points on a sphere are measured, the experiment ends. The observer leaves the experiment room to ask the experimenter to restart the experiment on the next sphere. Measurements for the long experiment are divided into three parts.\nAfter measuring the direction of the vector vobs at all points p, we measured the vector length at all points. The length of the vectors is given as the minimum contrast m in the direction of the luminous vector, needed to detect the homochromatic frame from the background. The contrast on the heterochromatic frame R is set to zero. To do so, we used a contrast adjustment procedure that uses large and small, positive or negative, delta values."
        },
        {
            "heading": "D. Apparatus",
            "text": "To avoid reflections, all experiments were conducted in an experimental box with opaque black tissue on the walls and table. In order to ensure the stability of light during calibration measurements or experiments, computers and monitors were turned on at least an hour before the measurement. In this period, we ran a warm-up procedure displaying random colors.\nThis display consists of a 19-inch Trinitron CRT (DELL D1626HT) connected with BNC cables and driven by a Cambridge Research VSG 2.5 board with Windows 7. Display resolution is 1024x768@100Hz, and palette animation is used to generate stimulus. The answer box is a Cambridge Research six-button infrared response box connected to the VSG board. The programs were developed using the VSG-MATLAB API. 8.107 and VSG Library and ToolBox ver. 1.217."
        },
        {
            "heading": "E. Participants",
            "text": "Two authors conducted an experiment with seventy five vectors lasting five hours on three consecutive days. In contrast, twenty four naive observers conducted the experiment in less than one hour with twelve vectors. Two naive observers were excluded from the final sample. The first was due to a technical problem with the response box, and the second was due to the absence of data measurement for the vector length. Naive observers were recruited from psychology students at the university. They received one experimental point as a bonus for the final examination. Authors were forty nine years old at the time of the experiment. They had normal vision or corrected to normal. Naive observers are 14 males and 8 females, with an average age of 26 years and with normal or corrected to normal vision. None of the participants were dichromat based on their self-report. Experiment procedure had been approved by the ethical committee of the University of Grenoble Alpes under the number IRB 00010290-2017."
        },
        {
            "heading": "F. Surfaces from vector field",
            "text": "After two sessions of minimum motion by points, giving the direction of the vector, and the adjustment procedure giving the magnitude of the vector, we have N pairs of points and vectors composing the vector field (x, v). We write X and V as two matrices of size 3\u00d7N, which contain respectively N points and vectors. The value of N = 75 for the two authors and N = 12 for twenty two observers.\nA model of the visual system is a prediction of V from X. We choose an affine model of the kind v = 2Bx + a0 where the vector v is the ith member of the matrix V and the vector x is the ith member of the matrix X (See supplementary method S1-SC for more explanation). The matrix B is not symmetric and is replaced by A = (B + Bt)/2 [17]. The matrix A and the vector a0 are the parameters of the observer\u2019s model.\nFor a quadratic surface of level k passing through a point p of coordinate x, we have xt Ax + xta0 = k2 (See supplementary method S1-SD for more explanations). This equation is also written as:\n(x\u2212 x0)tH(x\u2212 x0) = 1 (9)\nwith x0 = (1/2)A\u22121a0, H = U( \u221a |S|/\u03c1)J ( \u221a |S|/\u03c1)Ut with \u03c12 = k2 + (1/4)at0 A \u22121a0 and U and S are the eigenvectors and eigenvalues matrices of A, A = USUt. The diagonal matrix J is the signature of A (containing in its diagonal the sign of the eigenvalues of A). Depending on the sign of the diagonal matrix J , the surfaces described by A are degenerate quadrics such as plane (if one eigenvalue is zero), ellipsoids (if the signs of the three eigenvalues are positive), or hyperboloids (if one or two eigenvalues are negative).\nBy posing z = ( \u221a |S|/\u03c1)Ut(x\u2212 x0), we have ztJ z = 1 which is the equation of the canonical surface of signature J . Thus the estimated surface for each observer can be seen as a transformation T = ( \u221a |S|/\u03c1)Ut of the canonical surface placed at the origin x0, (x\u2212 x0)tTtJ T(x\u2212 x0) = 1. The observer model is in this case defined by an origin x0 and a coordinate transformation T of the canonical projective space in z.\nThe matrix T represents the observer\u2019s own color space since it contains the eigenvalues and eigenvectors of A. The columns of the observer\u2019s T matrix represent the color space axes for the observer. Using the variance of the coordinates of these axes, we can estimate the variability between observers."
        },
        {
            "heading": "4. RESULTS",
            "text": "Figure 4(a,b) shows the measured vectors for two observers. On the figure, the vector field is slightly convergent (not clearly visible since points are chosen on spheres). Thus, the iso-luminous surfaces of the observers are proportional hyperboloids. Due to proportionality, the pile of hyperboloid surfaces is included in a cone (the spectral cone for the observer). Cone and unitary hyperboloid estimates are shown in Figure 4 (c,d). Table 1 shows the\nthree ordered eigenvalues of A [18] and the mean square error of the predicted V\u0303 calculated using the affine model V\u0303 = 2AX + x0 compared to V. (See supplementary material S1-SC and Dataset 1, Ref. [15], and Dataset 2, Ref. [16], for more information).\nThe signature of A has two negative eigenvalues for all observers we have tested so far, and for three observers, only one eigenvalue is negative, as shown in Table 1. To rule out the planar hypothesis we first checked that the mean eigenvalues of A from Table 1 were different from 0, on average, using t-test. The first (M=-0.156E-3; SD=0.174E-3), t(23) = -4.38, p <0.001, second (M=-0.056E-3; SD=0.045E-3), t(23) = -6.13, p <0.001, and third (M=4.6E-3; SD=2.1E-3), t(23) = 10.77, p <0.001, eigenvalues were all different from zero. Even though that could be implied from the sign of the t-test statistics, we also tested the sign of the eigenvalues using a sign rank test (using the exact solution for the function signrank in @MATLAB). The first and second eigenvalues in Table 1 were negatives and the third was positive (all p < 0.001). Because the group study indicates a negative value for the second column,\nwe attribute the positive value for the three observers to experimental noise. The eigenvector associated with the\nthird eigenvalue (third column of Table 1) is the axis of symmetry of the observer cone and unitary hyperboloid. Its direction is close to V\u03bb the spectral efficiency function of the eye. In the observer\u2019s color space, the direction of the luminous vector is the most precise direction since the third eigenvalue has a much higher absolute value than the two others. The ratio of eigenvalues indicates how precise an observer is for the other directions. Compared to the luminous direction, these ratios average 331 for the Blue/Yellow direction and 40.5 for the Red/Green direction.\nThe major differences between observers for the direction of the axis of symmetry are in the Blue-Yellow direction (Q3 direction) and not in the Red-Green direction (Q1 direction). The variance among observers of luminous axis coordinates along Q3 direction is 2.7E-3, while it is 1.6E-3 in Q1 direction.\nTable 2 presents, for observer number two, the Weber ratio as the ratio WR(r) = \u2016vobs\u2016/r between the length of the luminous vector \u2016vobs\u2016 and the radius of the sphere r on which the corresponding point is taken. Along each projective line, Weber ratio is consistent across the five radii as shown by the relatively low standard deviation compared to the mean (Compare columns M and SD of Table 2). Projective lines can then be graduated by the Weber/Fechner psychophysical law. However as shown in Table 2, the Weber ratio changes with the color of the point (see ratio differences across the lines in Table 2). The observed variation corresponds to what was found in [19,\nFigure 6], that compared achromatic Weber fraction for different colors. Blue (line 15) has a smaller ratio than red (line 1) and green (line 5) has a particularly large ratio. A similar variation of Weber ratio across colors was also found for all observers (See supplementary material S2-SA). Our Weber ratio follows the same variation as [19] however the value of the ratio is five times higher in our study. It may be because we measured a contrast at constant average luminosity, while they measured a\nluminosity contrast. Dr\u00f6sler [20] proposed that the constant parameters of psychophysical laws are projective invariant. Using the metric estimated for observer two, we checked if the observed change in the Weber constant from color to color could be adjusted on the basis of the observer\u2019s projective hyperbolic space. The factor for each projective line can be thought of as the hyperbolic norm of the point p(x) that we write |x| = \u221a (x\u2212 x0)tH(x\u2212 x0), where x0 and H are the observer\u2019s color space model. We apply a correction for each line of the table by calculating WBc(r) = (12.8Er{|x|} + 0.28)\u22121WB(r). The two constants are calculated as the best polynomial fit between Er{|x|} and Er{WB(r)} and are observer\u2019s dependent (Er{} is the expectation over r). Corrected Weber ratio are further normalized by a constant for having the same average Weber ratio than non corrected Weber ratio. From WBc(r) we compute a revised standard deviation SDc(r) (Last line of Table 2). The value SDc(r) is 3.2 times lower than non corrected SD. Also, the specific pattern of change in blue, green, and red was no longer observed across color points. This correction applies equally well to all observers, even naive observers for whom only two ratios per color point can be calculated (See supplementary material S2-SA). According to this post-hoc analysis, the psychophysical law constant for each projective line is a consequence of the hyperbolic norm of the observer\u2019s color space."
        },
        {
            "heading": "1 0.50 0.45 0.33 0.45 0.48 0.44 0.06",
            "text": ""
        },
        {
            "heading": "2 0.60 0.50 0.50 0.53 0.54 0.53 0.04",
            "text": ""
        },
        {
            "heading": "3 0.80 0.50 0.63 0.70 0.80 0.69 0.13",
            "text": ""
        },
        {
            "heading": "4 1.00 0.80 0.80 0.75 0.74 0.82 0.11",
            "text": ""
        },
        {
            "heading": "5 1.00 0.90 0.77 0.78 0.80 0.85 0.10",
            "text": ""
        },
        {
            "heading": "6 0.50 0.40 0.43 0.45 0.46 0.45 0.04",
            "text": ""
        },
        {
            "heading": "7 0.60 0.65 0.63 0.53 0.54 0.59 0.06",
            "text": ""
        },
        {
            "heading": "8 0.80 0.75 0.67 0.68 0.68 0.71 0.06",
            "text": ""
        },
        {
            "heading": "9 0.90 0.75 0.67 0.70 0.76 0.76 0.09",
            "text": ""
        },
        {
            "heading": "10 0.40 0.45 0.40 0.40 0.46 0.42 0.03",
            "text": ""
        },
        {
            "heading": "11 0.60 0.60 0.67 0.58 0.56 0.60 0.04",
            "text": ""
        },
        {
            "heading": "12 0.70 0.65 0.57 0.68 0.64 0.65 0.05",
            "text": ""
        },
        {
            "heading": "13 0.40 0.45 0.37 0.38 0.40 0.40 0.03",
            "text": ""
        },
        {
            "heading": "14 0.60 0.55 0.50 0.50 0.54 0.54 0.04",
            "text": ""
        },
        {
            "heading": "15 0.40 0.35 0.33 0.35 0.34 0.35 0.03",
            "text": ""
        },
        {
            "heading": "5. CONCLUSION",
            "text": "We found that the color space of the observer has a hyperbolic geometry. Constant luminosity surfaces are hyperboloid surfaces, and color spaces are a pile of hyperboloid\nsheets with varying radius k that correspond to different levels of luminosity. All of those hyperboloids are included in a cone defined for k\u2192 0. This is the spectral cone for the observer, or the locus of mostly saturated lights (i.e. monochromatic lights). The chromaticity diagram can be viewed as a hyperboloid surface rather than a planar surface in this geometry.\nAccording to literature, only the L- and M-cones input to the achromatic/motion channel we call V. Thus, V = aL + bM where a and b are the gains of the L and M channels, respectively. If adaptation modifies the spectral efficiency of the eye, it could be achieved by modifying those gains. If we further suppose that the color stimulus de-saturates the cone mechanism for which the stimulus is closest to (say red may de-saturate L-cones), then we can write those gains depending on the color position. If a = (M + S) and b = (L + S), then the surface in LMS color space has the equation: V = 2LM + LS + MS. This is the equation of the hyperboloid of level V having L, M and S vectors as basis. Following this geometry, the luminosity of a color is given by a weighted linear combination of L- and M-cone mechanisms for which the weights are proportional to the sum of the two other cone responses.\nSurprisingly enough, the quadratic metric we found is not inherited from the Hilbert scalar product (radiometric norm) but rather from a hyperbolic geometry that is likely imposed by visual processing. The transformation T and change of the origin x0 of the canonical unitary hyperboloid into the unitary hyperboloid of the observer represent the axes of the observer\u2019s color space. While LMS vectors lie on the envelope of the spectral cone, the axes estimated in T are based on a coordinate system having one component being the axis of symmetry of the observer\u2019s metric and the two others are orthogonal.\nWeber\u2019s law and the hyperbolic metric are separate. The hyperbolic metric acts only as a factor in Weber\u2019s law from color to color. Colorfulness is the coordinate of a point on the unitary hyperboloid or equivalently a point on the Klein disk. It can be divided into saturation and hue. Luminosity is the affix to the projective line. Brightness is a monotonic function of luminosity and could be associated with the hyperbolic norm of the point p.\nMetrics of color space are usually derived from color discrimination thresholds [21] showing a pseudoRiemannian [20, 22] or non-Riemannian [23] structure. Our results support the pseudo-Riemannian hypothesis because iso-luminous surfaces are hyperbolic. In our experiment we fixed the adaptation state of the observer to the point of measurement. This ensured a single point of adaptation across the visual field of the observer. Our result is thus based on several adaptation states and this is probably the reason why we found a cone with a large aperture. According to our interpretation, under a single adaptation state, the surface of equal luminosity is already a hyperboloid, but with a smaller aperture than the one we measured. By aggregating several points of adaptation\nwe found a global cone with a larger aperture. The luminous direction differs from the direction of the white on the screen. Indeed, we found that the luminous axis is close to V\u03bb, the direction of V(\u03bb) in the color space of the screen. In contrast, the manufacturer of the screen defines the white with R = G = B, so the direction of the white is closer to w = (1, 1, 1). Our measurements are not related to color appearance but to color physiology as we are taking heterochromatic photometry instead of whiteness measurements. From physiological to perceptual space, there is probably a projective transformation. We have shown that physiological color space has a hyperbolic metric. The perceptual space, which is probably an isomorphism transformed space from physiology [24], should also be hyperbolic.\nThere are individual variations between observers seeing the same points in the computer display color space. Their hyperbolic metrics differ, as evidenced by the difference between the eigenvectors matrix U and the eigenvalue matrix S of matrix A. Differences in the observer\u2019s color space may be compensated for in displaying images. Here, we suggest compensation can offer a way to reduce tiredness after spending long hours watching a display. Additionally, it can be used to enhance virtual reality immersion.\nFunding. This study have been conducted with laboratory proper funding.\nAcknowledgment. Authors are grateful to Arnaud Amblard and Eva Boglietti who contributed to participant recruitment and data acquisition. The authors wish to express their gratitude to anonymous reviewers and the editor for their feedback on the manuscript, which greatly improved its readability.\nDisclosures. The authors declare no conflicts of interest.\nData availability. All results data are available in Dataset 1, Ref. [15], and Dataset 2, Ref. [16].\nSupplementary Material. See Supplement for supporting content."
        }
    ],
    "title": "Measurement of individual color space using a luminous vector field",
    "year": 2023
}