{
    "abstractText": "Dynamic response evaluation in structural engineering is the process of determining the response of a structure, such as member forces, node displacements, etc when subjected to dynamic loads such as earthquakes, wind, or impact. This is an important aspect of structural analysis, as it enables engineers to assess structural performance under extreme loading conditions and make informed decisions about the design and safety of the structure. Conventional methods for dynamic response evaluation involve numerical simulations using finite element analysis (FEA), where the structure is modeled using finite elements and the equations of motion are solved numerically. Although effective, this approach can be computationally intensive and may not be suitable for real-time applications. To address these limitations, recent advancements in machine learning, specifically artificial neural networks, have been applied to dynamic response evaluation in structural engineering. These techniques leverage large data sets and sophisticated algorithms to learn the complex relationship between inputs and outputs, making them ideal for such problems. In this paper, a novel approach is proposed for evaluating the dynamic response of multi-degree-of-freedom (MDOF) systems using physics-informed recurrent neural networks. The focus of this paper is to evaluate the seismic (earthquake) response of nonlinear structures. The predicted response will be compared to state-of-the-art methods such as FEA to assess the efficacy of the physics-informed RNN model.",
    "authors": [
        {
            "affiliations": [],
            "name": "Faisal Nissar Malik"
        },
        {
            "affiliations": [],
            "name": "James Ricles"
        },
        {
            "affiliations": [],
            "name": "Masoud Yari"
        }
    ],
    "id": "SP:5064a957583ac2220113d8f420ffeddc287e5b56",
    "references": [
        {
            "authors": [
                "Thomas D Ancheta",
                "Robert B Darragh",
                "Jonathan P Stewart",
                "Erdal Seyhan",
                "Walter J Silva",
                "Brian S J Chiou",
                "Keith E Wooddell",
                "Robert W Graves",
                "Albert R Kottke",
                "David M Boore",
                "Tadahiro Kishida",
                "Jennifer L Donahue"
            ],
            "title": "Peer nga-west2 database, peer report 2013-03",
            "venue": "Technical report,",
            "year": 2013
        },
        {
            "authors": [
                "Soheil Sadeghi Eshkevari",
                "Martin Tak\u00e1\u010d",
                "Shamim N. Pakzad",
                "Majid Jahani"
            ],
            "title": "DynNet: Physics-based neural architecture design for nonlinear structural response modeling and prediction",
            "venue": "Engineering Structures,",
            "year": 2021
        },
        {
            "authors": [
                "Chinmoy Kolay",
                "James M. Ricles"
            ],
            "title": "Development of a family of unconditionally stable explicit direct integration algorithms with controllable numerical energy dissipation",
            "venue": "Earthquake Engineering & Structural Dynamics,",
            "year": 2014
        },
        {
            "authors": [
                "Nikos D. Lagaros",
                "Manolis Papadrakakis"
            ],
            "title": "Neural network based prediction schemes of the non-linear seismic response of 3d buildings",
            "venue": "Advances in Engineering Software,",
            "year": 2012
        },
        {
            "authors": [
                "Luis A. Montejo"
            ],
            "title": "Response spectral matching of horizontal ground motion components to an orientation-independent spectrum (RotDnn)",
            "venue": "Earthquake Spectra,",
            "year": 2021
        },
        {
            "authors": [
                "Ruiyang Zhang",
                "Zhao Chen",
                "Su Chen",
                "Jingwei Zheng",
                "Oral B\u00fcy\u00fck\u00f6zt\u00fcrk",
                "Hao Sun"
            ],
            "title": "Deep long short-term memory networks for nonlinear structural seismic response prediction",
            "venue": "Computers & Structures,",
            "year": 2019
        },
        {
            "authors": [
                "Ruiyang Zhang",
                "Yang Liu",
                "Hao Sun"
            ],
            "title": "Physics-informed multi-lstm networks for metamodeling of nonlinear structures",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 2020
        }
    ],
    "sections": [
        {
            "text": "Physics Informed Recurrent Neural Networks for Seismic Response Evaluation of Nonlinear Systems\nFaisal Nissar Malik Dept. of Civil Engineering\nLehigh University\nJames Ricles Dept. of Civil Engineering\nLehigh University\nMasoud Yari Dept. of Computer Science\nLehigh University\nMalik Arsala Nissar Dept. of Mechanical Engineering\nIIT Kanpur"
        },
        {
            "heading": "I. ABSTRACT",
            "text": "Dynamic response evaluation in structural engineering is the process of determining the response of a structure, such as member forces, node displacements, etc when subjected to dynamic loads such as earthquakes, wind, or impact. This is an important aspect of structural analysis, as it enables engineers to assess structural performance under extreme loading conditions and make informed decisions about the design and safety of the structure. Conventional methods for dynamic response evaluation involve numerical simulations using finite element analysis (FEA), where the structure is modeled using finite elements and the equations of motion are solved numerically. Although effective, this approach can be computationally intensive and may not be suitable for real-time applications. To address these limitations, recent advancements in machine learning, specifically artificial neural networks, have been applied to dynamic response evaluation in structural engineering. These techniques leverage large data sets and sophisticated algorithms to learn the complex relationship between inputs and outputs, making them ideal for such problems. In this paper, a novel approach is proposed for evaluating the dynamic response of multi-degree-of-freedom (MDOF) systems using physics-informed recurrent neural networks. The focus of this paper is to evaluate the seismic (earthquake) response of nonlinear structures. The predicted response will be compared to state-of-the-art methods such as FEA to assess the efficacy of the physics-informed RNN model.\nII. INTRODUCTION Dynamic response analysis is a valuable tool for designing and assessing the performance of structures under a variety of loads such as seismic, wind, or wave loading, as well as for conducting reliability analyses of infrastructure and large urban areas. The traditional approach for dynamic response analysis typically involves creating numerical models and solving the partial differential equations using numerical integrators, such as the Newmark-\u03b2 method or the KR-\u03b1 [3] method to predict the system\u2019s response under dynamic loads. However, this approach is computationally expensive and is not feasible in scenarios such as probabilistic seismic analysis where a large number of simulations need to be performed, or real-time hybrid simulations involving structures with a large number of degrees of freedom where the computations need to be performed in real-time.\nMachine learning and Artificial intelligence have proven to be effective tools for predicting the response of complex nonlinear systems with a high degree of accuracy at a fraction of the computational cost compared to traditional finite element analysis. Furthermore, machine learning techniques can also be leveraged as surrogate low-fidelity models to predict the response of systems under insufficient prior knowledge of the systems. These techniques can also be leveraged to model the system\u2019s behavior based on experimental data. The use of machine learning in predicting the behavior of structures under dynamic loads has been investigated by researchers such as Lagaros [4], Zhang [6], [7], and Eshkevari [2]. These studies demonstrate that machine learning has a lot of potential in the area of structural dynamics and response predictions. Zhang [7] used physics based LSTM models (PhyLSTM2, PhyLSTM3) for seismic response prediction. Their proposed architecture included two or three separate LSTM-based neural network models to predict the system\u2019s response such as the displacement and the restoring force. Essentially, they added additional terms in the loss function that penalizes the neural network based on discrepancies in the equations of motion. Even though the accuracy of the predictions was enhanced by imposing these new physical constraints, these architectures lack guidance from physics resulting in overly complex networks that require extended training periods and large amounts of training data. Therefore, in this paper, a new physics-guided neural network architecture is proposed that uses the idea of numerical integrators to predict the seismic response of highly nonlinear structural systems under limited availability of training data. The network architecture of the model is described in detail in Section III."
        },
        {
            "heading": "III. NETWORK ARCHITECTURE",
            "text": "Numerical solvers determine the structure\u2019s response X ={ x(t), x\u0307(t), x\u0308(t) } , where x(t) is the displacement, x\u0307(t) is the velocity and x\u0308(t)) is the acceleration at time t from the state of the system { x(ti\u22121), x\u0307(ti\u22121), x\u0308(ti\u22121) } at time ti\u22121 and the forcing function f(ti) at time t. For example the KR-\u03b1 method\nar X\niv :2\n30 8.\n08 65\n5v 1\n[ cs\n.L G\n] 1\n6 A\nug 2\n02 3\n[3] gives:\nX\u0307i+1 = X\u0307i +\u2206t\u03b11X\u0308i (1)\nXi+1 = Xi +\u2206tX\u0307i+1 +\u2206t 2\u03b12X\u0308i (2)\nM \u02c6\u0308Xi+1 + CX\u0307i+1\u2212\u03b1f +KXi+1\u2212\u03b1f = Fi+1\u2212\u03b1f (3) (4)\nwhere,\n\u02c6\u0308Xi+1 = (I \u2212 \u03b13)X\u0308i+1 + \u03b13X\u0308i (5) X\u0307i+1\u2212\u03b1f = (1\u2212 \u03b1f )X\u0307i+1 + \u03b1f X\u0307i (6) Xi+1\u2212\u03b1f = (1\u2212 \u03b1f )Xi+1 + \u03b1fXi (7) Fi+1\u2212\u03b1f = (1\u2212 \u03b1f )Fi+1 + \u03b1fFi (8)\nand initial acceleration vector is given by MX\u03080 = F0 \u2212 CX\u03070 \u2212 KX0, where M,C, and K are the mass, damping, and stiffness matrices, respectively, of dimension n \u00d7 n for an MDOF system with n DOFs; XX\u0307, X\u0308, and F are the displacement, velocity, acceleration, and force vector, respectively; \u03b11, \u03b12, \u03b13 are the integration parameter matrices of dimensions n\u00d7n; I is the identity matrix of dimension n\u00d7n; and \u03b1f is a scalar integration parameter. The network architecture is based on the same principle and is shown in Figure 1. The input to the model at time t is the state of the system [x(ti\u22121), x\u0307(ti\u22121) ] at time ti\u22121 and the ground acceleration { x\u0308g(t) } at time t, and the model predicts the system response at time t. The model consists of two separate subnets, the state prediction model (StateNet) and the restoring force and acceleration prediction model (RestNet). The StateNet takes the state of the system { x(ti\u22121), x\u0307(ti\u22121)}\nand the ground acceleration { x\u0308g(t) } to calculate the state of the system at time t. The RestNet takes the state of the system predicted by the StateNet at time t to predict the acceleration and restoring force at time t. The two subnets consists of two LSTM layers, followed by three fully connected layers as shown in the figure. Each LSTM layer has 200 neurons and the output from LSTM layers is passed through the three fully connected dense layers and ReLU activation to get the final output. The model architecture is shown in Figure 1.\nThe outputs of the model are passed through a tensor differentiator to calculate the time derivatives of the responses. The loss of model is calculated from these time derivatives and the predicted responses as:\nL(\u03b81, \u03b82) = w1L1(\u03b81) + w2L2(\u03b81) + w3L3(\u03b81, \u03b82) (9)\nwhere \u03b81, and \u03b82 are the parameters of the state and acceleration prediction models, respectively, L(\u03b8i) are the loss functions, wi is the weight given to ith loss term, and the loss terms are:\nL1(\u03b81) = || dXpred\ndt \u2212 X\u0307pred|| (10)\nL2(\u03b81) = ||Xreal \u2212Xpred||+ ||X\u0307real \u2212 X\u0307pred|| (11) L3(\u03b81, \u03b82) = ||X\u0308real \u2212 X\u0308pred|| (12)\n(13)\nL1(\u03b81) forces the time derivative of predicted response to be equal to the predicted derivative of the response. L2(\u03b82) and L3(\u03b81, \u03b82) are mean square losses for the two subnets. For simplicity, the values of w\u2032is are taken to be unity. It should be observed that L3 depends on both \u03b81 and \u03b82, therefore, the problem is a bi-objective optimization problem. The network is trained by using two different approaches. First, the model is trained for N epochs with teacher forcing. In this approach, the targets xreal(ti\u22121) and x\u0307real(ti\u22121) are passed as inputs to the StateNet instead of the model\u2019s predictions at time ti\u22121 to get the state at time t and the outputs from the StateNet are passed as inputs to the RestNet to get the acceleration and restoring forces. The Algorithm for teacher forcing is shown in Algorithm 1.\nAlgorithm 1 Training the Model with Teacher Forcing for One Input Sequence\n1: X0 \u2190 0, X\u03070 \u2190 0, X\u03080 \u2190 F0/M 2: while ti \u2264 tn do 3: Xp(ti)\u2190 Subnet1(Xr(ti\u22121), X\u0307r(ti\u22121), X\u0308r(ti\u22121)) 4: X\u0307p(ti)\u2190 Subnet1(Xr(ti\u22121), X\u0307r(ti\u22121), X\u0308r(ti\u22121)) 5: X\u0308p(ti)\u2190 Subnet2(Xr(t), X\u0307r(t), X\u0308g(t)) 6: end while 7: L(\u03b81, \u03b82)\u2190 L1(\u03b81) + L2(\u03b82) + L3(\u03b81, \u03b82) 8: \u03b8i \u2190 \u03b8i + lr dL(\u03b81, \u03b82)\nd\u03b8i\nAfter training the model with teacher forcing, the model is then trained for M epochs with scheduled learning. In this approach, the model is trained as shown in the earlier algorithm, however, the training data is randomly replaced by the model\u2019s own predictions to help the model correct its own mistakes. The trained model is used to predict the response to unknown ground motions as described below. To predict the response to an unknown ground motion, the model is called one step at a time to predict the responses at time ti. The predicted response through feedback is passed back into the model to calculate the response at time ti+1.\nThe displacement, velocity, and acceleration are initialized as X0, X\u03070, and X\u03080 = (F0 \u2212 CX\u03070 \u2212 KX0)/M , respectively. Since the system considered in this study starts from at rest conditions i.e., X0 = X\u03070 = 0, the initial acceleration X\u03080 becomes X\u03080 = F0/M = \u0393X\u0308g(0), where \u0393 is the influence vector. The pseudocode for the model inference is shown in Algorithm 2.\nAlgorithm 2 Model Inference\n1: X0 \u2190 0, X\u03070 \u2190 0, X\u03080 \u2190 F0/M 2: while ti \u2264 tn do 3: Xp(ti)\u2190 Subnet1(Xp(ti\u22121), X\u0307p(ti\u22121), X\u0308p(ti\u22121)) 4: X\u0307p(ti)\u2190 Subnet1(Xp(ti\u22121), X\u0307p(ti\u22121), X\u0308p(ti\u22121)) 5: X\u0308p(ti)\u2190 Subnet2(Xp(t), X\u0307p(t), X\u0308g(t)) 6: end while\nIn the proposed architecture, the learning rate of the optimizer, the number of neurons in the layers, the number of connections between the StateNet and RestNet, and the batch size are the most important hyper-parameters. In this architecture, no regularization methods have been used. Note that the hyper-parameters are problem specific and need to be fine-tuned as per the problem. The model is trained on a relatively small batch size. Since, the training involves tensor differentiation, and the time series are large in length (\u2265 1500), selecting a high batch size is not possible due to memory constraints. A batch size of five was selected for training the model. At this batch size, the model was observed to perform the best. The data-driven model used for benchmarking the performance of the proposed network is a LSTM-based network developed by Zhang [6]. The input to the data-driven model is the ground acceleration and the model predicts the acceleration, velocity, displacement, and the restoring force. The data-driven model is trained using Adam optimizer with MSE as the loss function."
        },
        {
            "heading": "IV. NUMERICAL EXAMPLES: DATASET",
            "text": "The data used for training the model is generated using finite element analysis. However, experimental or a combination of experimental and simulated data can also be used to train the model. To generate the training data, a set of D ground motions is selected and scaled to match a target design spectrum. The structure\u2019s response for the ground motions is calculated through finite element analysis and numerical integration to generate the training and validation dataset. For this paper, two numerical examples are investigated. The first example is a single degree of freedom (SDOF) Boucwen system. This system and dataset are the same as those used by Zhang [7]. The primary purpose of using this dataset was to benchmark the proposed architecture\u2019s performance against the PhyLSTM3 model developed by Zhang [7]. The dataset used by Zhang [7] consisted of 85 synthetic ground motions. The ground motion duration is 30 second and the ground motions are sampled at a frequency of 50Hz. Therefore, each ground motion has 1501 data points. 60 examples were\nused for training the model and 25 examples were used for evaluating the model. The model is compared to the data driven model [6], and the PhyLSTM3 model [7]. For the second example, a nonlinear MDOF system as shown in Figure 3 is used. The frame has a mass of 6, 720 kN, and 10, 080 kN for the first and second floors, respectively. The beams are rigid, and the columns are modeled with elastic beam-column elements. The bracing is modeled using a nonlinear truss element with \u201dSteel02\u201d uniaxial material. The material has a post-yield stiffness ratio of 2.8%. The ground floor is also connected to nonlinear viscous dampers with a velocity exponent of 0.2, as shown in the figure. The building is modeled in OpenSees and a combination of real world ground motion records downloaded for PEER NGA west 2 database [1] and synthetic ground motions is used to generate the training and validation dataset. Numerical integration is performed using the HHT-\u03b1 method to obtain the structure\u2019s response. The dataset consists of 274 ground motions sampled at a frequency of 50 hz, and the ground motion duration is fixed at 30 sec. The sampled records are scaled to match the UHS MCE design response spectrum in the period range 0.4 sec to 2.0 sec i.e., 0.5\u00d7T1 to 2.5\u00d7T1, where T1 is the fundamental period of the structure. The wavelet record scaling procedure proposed by Montejo [5] is used for scaling the ground motions to the target spectrum The design response spectrum, median response spectrum of the ground motion set and the individual scaled records are shown in Figure 2. As can be seen in the figure, the response spectrum matches well with the target spectrum in the period range of interest. The output from the network is the displacement, velocity, and acceleration response of the two floors, the force in damper at first floor, and the force in the first floor brace. 130 examples are used for training the model and 144 are used to validate the model. The model is trained as explained earlier in Section III. The purely data-driven LSTM model described earlier in Section III is also trained and evaluated as a benchmark."
        },
        {
            "heading": "V. NUMERICAL EXAMPLES: RESULTS",
            "text": "In this section, the results for the two numerical examples discussed in the earlier section are presented below."
        },
        {
            "heading": "A. Numerical Example I: SDOF Boucwen System",
            "text": "In this section, the results of the SDOF Boucwen system are presented. Recall that the training data consisted of 85 examples, where-in 60 examples were used for training the model and 25 examples were used for evaluating the model. The data-driven model is trained for 200 epochs and the training data is shuffled before each epoch. The proposed architecture is trained for 100 epochs with teacher forcing and 100 epochs with scheduled learning as described earlier in Section III. Figure 4 shows the actual displacement response of the structure, the response predicted using the proposed architecture, and the response predicted using the data-driven model on two ground motions from the validation data set. As can be seen in the figure, the proposed model is much better at predicting the displacement response of the structure in comparison to the purely data-driven LSTM model. The R2 values for the validation dataset are calculated as:\nR2(i) = 1\u2212 SSres(i) SStot(i)\n(14)\nwhere, R2(i) is the R-square value on ith example, SSres(i) is the sum of squares of the residuals for ith example and SStot(i) is the total sum of squares for ith example. The R2 values for the proposed architecture and the purely data-driven model for the 25 validation examples are calculated and are shown in Figure 5. The mean of R2 is 0.9929, and the standard deviation of R2 is 0.0043 for the proposed architecture on the validation dataset. These values are 0.5460, and 0.1660 for the data-driven model. In other words, the proposed model is able to explain 99.29% variation in displacement response, while the data-driven model is able to explain only 54.60% variation\nin the displacement response. Since the system under consideration and the dataset used for this example is the same as used by Zhang [7], the results are compared to the PhyLSTM3 model proposed by them. The code for PhyLSTM3 is not publicly available and thus it was not possible to reproduce the results. Therefore, the data shown by them in their original paper was compared to the proposed architecture. The R2 values for the best and worst case of the entire dataset for PhyLSTM3 are 0.99 and 0.79, respectively [7]. The R2 values for the best and the worst case on the entire dataset for the proposed architecture are 0.995 and 0.981, respectively. Thus it can be seen that the proposed architecture outperforms the PhyLSTM3 model for this system and dataset. It is also noteworthy to look at the mean square error of the predicted outputs. The mean square error for the data-driven LSTM and the proposed architecture are summarized in table I. As can be seen in the table, the proposed model shows a reduction of 98.50% in the mean square error for displacement response and a reduction of 89% in the mean square error for velocity response on the validation dataset when compared to\nthe purely data-driven LSTM model."
        },
        {
            "heading": "B. Numerical Example II: Nonlinear MDOF building.",
            "text": "In this section, the results for the nonlinear building frame are presented. Recall that the training data consisted of 274 examples, where-in 130 examples are used for training the model and 144 examples are used for evaluating the model. The data-driven model is trained for 500 epochs and the training data is shuffled before each epoch. The proposed architecture is trained for 250 epochs with teacher forcing and 250 epochs with scheduled learning as described earlier in Section III. Figure 6 shows the predicted displacement response for the first floor for two ground motions in the validation dataset. As can be seen in the figure, the proposed architecture is able to predict the response of the structure with a high degree of accuracy. The figure also shows that the output from the data-driven model is noisier in comparison to the response from the proposed architecture. Furthermore, the data-driven model overestimates the predicted displacement response. Figure 7 shows the predicted force vs deformation (hysteretic) behavior of the first-floor brace of the proposed architecture and the data-driven model for one ground motion record in the validation dataset. As can be seen in the figure, the proposed architecture is much better at capturing the nonlinear hysteretic behavior in comparison to the purely datadriven model. The R2 and mean square error values of the predicted re-\nsponses from the proposed architecture and purely data-driven LSTM model are also calculated and are shown in table II. As can be seen in the table, the proposed architecture outperforms the purely data-driven model for all the response quantities of interest, thus highlighting the efficacy of the proposed architecture. The mean square error of the predicted responses from the proposed network is roughly one order of magnitude less than that of the same from the data-driven model. For illustration, a histogram of R2 values of the displacement response on the validation data set from the proposed network and the data-driven model is shown in figure 8. The figure shows that the R2 values of the predicted responses from the proposed network are greater than 0.98, indicating a very strong correlation between the predicted and actual response. On the other hand, the R2 values of the predicted responses from the purely data-driven model lie anywhere between 0.8 and 0.98. The picture is even more clear when we look at the scatter plot of the actual and predicted displacement for the proposed architecture and the data-driven model shown in figure 9. As can be seen in the figure, the scatter plot of the actual displacement and the output from the proposed model is much more correlated than the same from the purely datadriven model. Since this example was not highly nonlinear, the data-driven model was also able to predict the response of the system with good accuracy."
        },
        {
            "heading": "VI. SUMMARY AND CONCLUSIONS",
            "text": "In this paper, a new architecture is proposed for evaluating the seismic response of nonlinear structures. The proposed algorithm was able to capture the nonlinear response of the structures with a high degree of accuracy. Based on the results of the study, the following conclusions have been made:\n1) The proposed architecture is able to capture the nonlinear behavior of structures accurately with less training data requirement. 2) Combined with teacher forcing and scheduled learning, the proposed architecture doesn\u2019t require long training epochs and performs well without the need for data scaling or normalization. 3) The proposed architecture is able to capture the hysteretic behavior of structures with great accuracy. 4) The proposed architecture is able to predict the seismic response of the structure in a fraction of the time compared to finite element analysis and thus can be used in combination with real-time hybrid simulations or probabilistic seismic analysis where computation cost is a huge concern."
        }
    ],
    "title": "Physics Informed Recurrent Neural Networks for Seismic Response Evaluation of Nonlinear Systems",
    "year": 2023
}