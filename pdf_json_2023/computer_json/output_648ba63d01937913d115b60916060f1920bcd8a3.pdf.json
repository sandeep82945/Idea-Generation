{
    "abstractText": "The high prevalence of cardiovascular diseases (CVDs) calls for accessible and cost-effective continuous cardiac monitoring tools. Despite Electrocardiography (ECG) being the gold standard, continuous monitoring remains a challenge, leading to the exploration of Photoplethysmography (PPG), a promising but more basic alternative available in consumer wearables. This notion has recently spurred interest in translating PPG to ECG signals. In this work, we introduce Region-Disentangled Diffusion Model (RDDM), a novel diffusion model designed to capture the complex temporal dynamics of ECG. Traditional Diffusion models like Denoising Diffusion Probabilistic Models (DDPM) face challenges in capturing such nuances due to the indiscriminate noise addition process across the entire signal. Our proposed RDDM overcomes such limitations by incorporating a novel forward process that selectively adds noise to specific regions of interest (ROI) such as QRS complex in ECG signals, and a reverse process that disentangles the denoising of ROI and non-ROI regions. Quantitative experiments demonstrate that RDDM can generate high-fidelity ECG from PPG in as few as 10 diffusion steps, making it highly effective and computationally efficient. Additionally, to rigorously validate the usefulness of the generated ECG signals, we introduce CardioBench, a comprehensive evaluation benchmark for a variety of cardiac-related tasks including heart rate and blood pressure estimation, stress classification, and the detection of atrial fibrillation and diabetes. Our thorough experiments show that RDDM achieves state-of-the-art performance on CardioBench. To the best of our knowledge, RDDM is the first diffusion model for cross-modal signal-to-signal translation in the bio-signal domain.",
    "authors": [
        {
            "affiliations": [],
            "name": "Debaditya Shome"
        },
        {
            "affiliations": [],
            "name": "Pritam Sarkar"
        },
        {
            "affiliations": [],
            "name": "Ali Etemad"
        }
    ],
    "id": "SP:287cdbb7797caf534093cece54047bfa14e38324",
    "references": [
        {
            "authors": [
                "E. Adib",
                "A. Fernandez",
                "F. Afghah",
                "J.J. Prevost"
            ],
            "title": "Synthetic ECG Signal Generation using Probabilistic Diffusion Models",
            "venue": "arXiv preprint arXiv:2303.02475.",
            "year": 2023
        },
        {
            "authors": [
                "J.M.L. Alcaraz",
                "N. Strodthoff"
            ],
            "title": "Diffusion-based conditional ECG generation with structured state space models",
            "venue": "Computers in Biology and Medicine, 107115.",
            "year": 2023
        },
        {
            "authors": [
                "A. Aliamiri",
                "Y. Shen"
            ],
            "title": "Deep learning based atrial fibrillation detection using wearable photoplethysmography sensor",
            "venue": "2018 IEEE EMBS International Conference on Biomedical & Health Informatics (BHI), 442\u2013445. IEEE.",
            "year": 2018
        },
        {
            "authors": [
                "R. Avram",
                "J.E. Olgin",
                "P. Kuhar",
                "J.W. Hughes",
                "G.M. Marcus",
                "M.J. Pletcher",
                "K. Aschbacher",
                "G.H. Tison"
            ],
            "title": "A digital biomarker of diabetes from smartphonebased vascular signals",
            "venue": "Nature medicine, 26(10): 1576\u20131582.",
            "year": 2020
        },
        {
            "authors": [
                "R. Banerjee",
                "A. Sinha",
                "A.D. Choudhury",
                "A. Visvanathan"
            ],
            "title": "PhotoECG: Photoplethysmographyto estimate ECG parameters",
            "venue": "2014 IEEE International Conference on",
            "year": 2014
        },
        {
            "authors": [
                "S.K. Bashar",
                "E. Ding",
                "A.J. Walkey",
                "D.D. McManus",
                "K.H. Chon"
            ],
            "title": "Noise detection in electrocardiogram signals for intensive care unit patients",
            "venue": "IEEE Access, 7: 88357\u201388368.",
            "year": 2019
        },
        {
            "authors": [
                "K. Bayoumy",
                "M. Gaber",
                "A. Elshafeey",
                "O. Mhaimeed",
                "E.H. Dineen",
                "F.A. Marvel",
                "S.S. Martin",
                "E.D. Muse",
                "M.P. Turakhia",
                "K. G Tarakji"
            ],
            "title": "Smart wearable devices in cardiovascular care: where we are and how to move forward",
            "venue": "Nature Reviews Cardiology,",
            "year": 2021
        },
        {
            "authors": [
                "B. Behinaein",
                "A. Bhatti",
                "D. Rodenburg",
                "P. Hungler",
                "A. Etemad"
            ],
            "title": "A transformer architecture for stress detection from ecg",
            "venue": "2021 International Symposium on Wearable Computers, 132\u2013134.",
            "year": 2021
        },
        {
            "authors": [
                "K. Bird",
                "G. Chan",
                "H. Lu",
                "H. Greeff",
                "J. Allen",
                "D. Abbott",
                "C. Menon",
                "N.H. Lovell",
                "N. Howard",
                "W.-S Chan"
            ],
            "title": "Assessment of hypertension using clinical electrocardiogram features: a first-ever review",
            "venue": "Frontiers in Medicine,",
            "year": 2020
        },
        {
            "authors": [
                "A. Blattmann",
                "R. Rombach",
                "H. Ling",
                "T. Dockhorn",
                "S.W. Kim",
                "S. Fidler",
                "K. Kreis"
            ],
            "title": "Align your latents: High-resolution video synthesis with latent diffusion models",
            "venue": "Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 22563\u201322575.",
            "year": 2023
        },
        {
            "authors": [
                "E. Burns",
                "R. Buttner"
            ],
            "title": "Guidelines for the Management of Atrial Fibrillation",
            "year": 2023
        },
        {
            "authors": [
                "A.J. Camm",
                "G. Corbucci",
                "L. Padeletti"
            ],
            "title": "Usefulness of continuous electrocardiographic monitoring for atrial fibrillation",
            "venue": "The American journal of cardiology, 110(2): 270\u2013276.",
            "year": 2012
        },
        {
            "authors": [
                "J. Chen",
                "K. Liao",
                "K. Wei",
                "H. Ying",
                "D.Z. Chen",
                "J. Wu"
            ],
            "title": "ME-GAN: Learning panoptic electrocardio representations for multi-view ECG synthesis conditioned on heart diseases",
            "venue": "International Conference on Machine Learning, 3360\u20133370. PMLR.",
            "year": 2022
        },
        {
            "authors": [
                "P. Dhariwal",
                "A. Nichol"
            ],
            "title": "Diffusion models beat gans on image synthesis",
            "venue": "Advances in neural information processing systems, 34: 8780\u20138794.",
            "year": 2021
        },
        {
            "authors": [
                "M. Elgendi",
                "R. Fletcher",
                "Y. Liang",
                "N. Howard",
                "N.H. Lovell",
                "D. Abbott",
                "K. Lim",
                "R. Ward"
            ],
            "title": "The use of photoplethysmography for assessing hypertension",
            "venue": "NPJ digital medicine, 2(1): 60.",
            "year": 2019
        },
        {
            "authors": [
                "T. Golany",
                "K. Radinsky"
            ],
            "title": "Pgans: Personalized generative adversarial networks for ecg synthesis to improve patient-specific deep ecg classification",
            "venue": "Proceedings of the AAAI Conference on Artificial Intelligence, volume 33, 557\u2013564.",
            "year": 2019
        },
        {
            "authors": [
                "P. Hamilton"
            ],
            "title": "Open source ECG analysis",
            "venue": "Computers in cardiology, 101\u2013104. IEEE.",
            "year": 2002
        },
        {
            "authors": [
                "A.Y. Hannun",
                "P. Rajpurkar",
                "M. Haghpanahi",
                "G.H. Tison",
                "C. Bourn",
                "M.P. Turakhia",
                "A.Y. Ng"
            ],
            "title": "Cardiologistlevel arrhythmia detection and classification in ambulatory electrocardiograms using a deep neural network",
            "venue": "Nature medicine, 25(1): 65\u201369.",
            "year": 2019
        },
        {
            "authors": [
                "J. Ho",
                "A. Jain",
                "P. Abbeel"
            ],
            "title": "Denoising diffusion probabilistic models",
            "venue": "Advances in neural information processing systems, 33: 6840\u20136851.",
            "year": 2020
        },
        {
            "authors": [
                "N. Ibtehaz",
                "S. Mahmud",
                "M.E. Chowdhury",
                "A. Khandakar",
                "M. Salman Khan",
                "M.A. Ayari",
                "A.M. Tahir",
                "M.S. Rahman"
            ],
            "title": "PPG2ABP: Translating photoplethysmogram (PPG) signals to arterial blood pressure (ABP) waveforms",
            "venue": "Bioengineering, 9(11): 692.",
            "year": 2022
        },
        {
            "authors": [
                "A.E. Johnson",
                "T.J. Pollard",
                "L. Shen",
                "L.-w. H. Lehman",
                "M. Feng",
                "M. Ghassemi",
                "B. Moody",
                "P. Szolovits",
                "L. Anthony Celi",
                "R.G. Mark"
            ],
            "title": "MIMIC-III, a freely accessible critical care database",
            "venue": "Scientific data, 3(1): 1\u20139.",
            "year": 2016
        },
        {
            "authors": [
                "M. Kachuee",
                "M.M. Kiani",
                "H. Mohammadzade",
                "M. Shabany"
            ],
            "title": "Cuff-less high-accuracy calibration-free blood pressure estimation using pulse transit time",
            "venue": "2015 IEEE international symposium on circuits and systems (ISCAS), 1006\u20131009. IEEE.",
            "year": 2015
        },
        {
            "authors": [
                "W. Karlen"
            ],
            "title": "CapnoBase IEEE TBME respiratory rate benchmark",
            "year": 2021
        },
        {
            "authors": [
                "D. Kauffman"
            ],
            "title": "Cardiovascular disease burden, deaths are rising around the world",
            "venue": "American College of Cardiology,",
            "year": 2020
        },
        {
            "authors": [
                "H.-G. Kim",
                "E.-J. Cheon",
                "D.-S. Bai",
                "Y.H. Lee",
                "B.-H. Koo"
            ],
            "title": "Stress and heart rate variability: a meta-analysis and review of the literature",
            "venue": "Psychiatry investigation,",
            "year": 2018
        },
        {
            "authors": [
                "E. Lan"
            ],
            "title": "Performer: A Novel PPG-to-ECG Reconstruction Transformer for a Digital Biomarker of Cardiovascular Disease Detection",
            "venue": "Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision, 1991\u20131999.",
            "year": 2023
        },
        {
            "authors": [
                "Y. Liang",
                "Z. Chen",
                "G. Liu",
                "M. Elgendi"
            ],
            "title": "A new, short-recorded photoplethysmogram dataset for blood pressure monitoring in China",
            "venue": "Scientific data, 5(1): 1\u20137.",
            "year": 2018
        },
        {
            "authors": [
                "A. Lisowska",
                "S. Wilk",
                "M. Peleg"
            ],
            "title": "Catching patient\u2019s attention at the right time to help them undergo behavioural change: Stress classification experiment from blood volume pulse",
            "venue": "Artificial Intelligence in Medicine: 19th International Conference on Artificial Intelligence in Medicine,",
            "year": 2021
        },
        {
            "authors": [
                "W. Long",
                "X. Wang"
            ],
            "title": "BPNet: A multi-modal fusion neural network for blood pressure estimation using ECG and PPG",
            "venue": "Biomedical Signal Processing and Control, 86: 105287.",
            "year": 2023
        },
        {
            "authors": [
                "I. Loshchilov",
                "F. Hutter"
            ],
            "title": "Decoupled Weight Decay Regularization",
            "venue": "International Conference on Learning Representations.",
            "year": 2018
        },
        {
            "authors": [
                "D. Makowski",
                "T. Pham",
                "Z.J. Lau",
                "J.C. Brammer",
                "F. Lespinasse",
                "H. Pham",
                "C. Sch\u00f6lzel",
                "S.H.A. Chen"
            ],
            "title": "NeuroKit2: A Python toolbox for neurophysiological signal processing",
            "venue": "Behavior Research Methods, 53(4): 1689\u20131696.",
            "year": 2021
        },
        {
            "authors": [
                "N. Neifar",
                "A. Ben-Hamadou",
                "A. Mdhaffar",
                "M. Jmaiel"
            ],
            "title": "DiffECG: A Generalized Probabilistic Diffusion Model for ECG Signals Synthesis",
            "venue": "arXiv preprint arXiv:2306.01875.",
            "year": 2023
        },
        {
            "authors": [
                "J. Pan",
                "W.J. Tompkins"
            ],
            "title": "A real-time QRS detection algorithm",
            "venue": "IEEE transactions on biomedical engineering, (3): 230\u2013236.",
            "year": 1985
        },
        {
            "authors": [
                "S. Peng",
                "Y. Yu",
                "K. Hao",
                "H. Xing",
                "D. Li",
                "C. Chen",
                "A. Huang",
                "X. Hong",
                "Y. Feng",
                "Y Zhang"
            ],
            "title": "Heart rate\u2013 corrected QT interval duration is significantly associated with blood pressure in Chinese hypertensives",
            "venue": "Journal of Electrocardiology,",
            "year": 2006
        },
        {
            "authors": [
                "M.A. Pimentel",
                "A.E. Johnson",
                "P.H. Charlton",
                "D. Birrenkott",
                "P.J. Watkinson",
                "L. Tarassenko",
                "D.A. Clifton"
            ],
            "title": "Toward a robust estimation of respiratory rate from pulse oximeters",
            "venue": "IEEE Transactions on Biomedical Engineering, 64(8): 1914\u20131923.",
            "year": 2016
        },
        {
            "authors": [
                "A. Reiss",
                "I. Indlekofer",
                "P. Schmidt",
                "K. Van Laerhoven"
            ],
            "title": "Deep PPG: large-scale heart rate estimation with convolutional neural networks",
            "venue": "Sensors, 19(14): 3079.",
            "year": 2019
        },
        {
            "authors": [
                "L. Ruan",
                "Y. Ma",
                "H. Yang",
                "H. He",
                "B. Liu",
                "J. Fu",
                "N.J. Yuan",
                "Q. Jin",
                "B. Guo"
            ],
            "title": "Mm-diffusion: Learning multimodal diffusion models for joint audio and video generation",
            "venue": "Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 10219\u201310228.",
            "year": 2023
        },
        {
            "authors": [
                "M. Saeed",
                "M. Villarroel",
                "A.T. Reisner",
                "G. Clifford",
                "L.-W. Lehman",
                "G. Moody",
                "T. Heldt",
                "T.H. Kyaw",
                "B. Moody",
                "R.G. Mark"
            ],
            "title": "Multiparameter Intelligent Monitoring in Intensive Care II (MIMIC-II): a public-access intensive care unit database",
            "venue": "Critical care medicine, 39(5):",
            "year": 2011
        },
        {
            "authors": [
                "C. Saharia",
                "W. Chan",
                "S. Saxena",
                "L. Li",
                "J. Whang",
                "E.L. Denton",
                "K. Ghasemipour",
                "R. Gontijo Lopes",
                "B. Karagol Ayan",
                "T Salimans"
            ],
            "title": "Photorealistic text-to-image diffusion models with deep language understanding",
            "venue": "Advances in Neural Information Processing Systems,",
            "year": 2022
        },
        {
            "authors": [
                "M. Sallem",
                "A. Ghrissi",
                "A. Saadaoui",
                "V. Zarzoso"
            ],
            "title": "Detection of Cardiac Arrhythmias From Varied Length Multichannel Electrocardiogram Recordings Using Deep Convolutional Neural Networks",
            "venue": "2020 Computing in Cardiology, 1\u20134. IEEE.",
            "year": 2020
        },
        {
            "authors": [
                "P. Sarkar",
                "A. Etemad"
            ],
            "title": "Self-supervised ECG representation learning for emotion recognition",
            "venue": "IEEE Transactions on Affective Computing, 13(3): 1541\u20131554.",
            "year": 2020
        },
        {
            "authors": [
                "P. Sarkar",
                "A. Etemad"
            ],
            "title": "Cardiogan: Attentive generative adversarial network with dual discriminators for synthesis of ecg from ppg",
            "venue": "Proceedings of the AAAI Conference on Artificial Intelligence, volume 35, 488\u2013496.",
            "year": 2021
        },
        {
            "authors": [
                "T Sch\u00e4ck"
            ],
            "title": "Computationally efficient heart rate estimation during physical exercise using photoplethysmographic signals",
            "venue": "In European Signal Processing Conference,",
            "year": 2017
        },
        {
            "authors": [
                "P. Schmidt",
                "A. Reiss",
                "R. Duerichen",
                "C. Marberger",
                "K. Van Laerhoven"
            ],
            "title": "Introducing wesad, a multimodal dataset for wearable stress and affect detection",
            "venue": "Proceedings of the 20th ACM international conference on multimodal interaction, 400\u2013408.",
            "year": 2018
        },
        {
            "authors": [
                "Y. Shen",
                "M. Voisin",
                "A. Aliamiri",
                "A. Avati",
                "A. Hannun",
                "A. Ng"
            ],
            "title": "Ambulatory atrial fibrillation monitoring using wearable photoplethysmography with deep learning",
            "venue": "Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery & Data Mining, 1909\u20131916.",
            "year": 2019
        },
        {
            "authors": [
                "J. Sohl-Dickstein",
                "E. Weiss",
                "N. Maheswaranathan",
                "S. Ganguli"
            ],
            "title": "Deep unsupervised learning using nonequilibrium thermodynamics",
            "venue": "International conference on machine learning, 2256\u20132265. PMLR.",
            "year": 2015
        },
        {
            "authors": [
                "S.B. Song",
                "J.W. Nam",
                "J.H. Kim"
            ],
            "title": "NAS-PPG: PPG-based heart rate estimation using neural architecture search",
            "venue": "IEEE Sensors Journal, 21(13): 14941\u201314949.",
            "year": 2021
        },
        {
            "authors": [
                "S.R. Steinhubl",
                "J. Waalen",
                "A.M. Edwards",
                "L.M. Ariniello",
                "R.R. Mehta",
                "G.S. Ebner",
                "C. Carter",
                "K. Baca-Motes",
                "E. Felicione",
                "T Sarich"
            ],
            "title": "Effect of a home-based wearable continuous ECG monitoring patch on detection of undiagnosed atrial fibrillation: the mSToPS randomized",
            "year": 2018
        },
        {
            "authors": [
                "H.K. Tewari",
                "R. Gadia",
                "D. Kumar",
                "P. Venkatesh",
                "S.P. Garg"
            ],
            "title": "Sympathetic\u2013parasympathetic activity and reactivity in central serous chorioretinopathy: a case\u2013control study",
            "venue": "Investigative ophthalmology & visual science, 47(8): 3474\u20133478.",
            "year": 2006
        },
        {
            "authors": [
                "X. Tian",
                "Q. Zhu",
                "Y. Li",
                "M. Wu"
            ],
            "title": "Cross-domain Joint Dictionary Learning for ECG Inference from PPG",
            "venue": "IEEE Internet of Things Journal.",
            "year": 2022
        },
        {
            "authors": [
                "K.R. Vardhan",
                "S. Vedanth",
                "G. Poojah",
                "K. Abhishek",
                "M.N. Kumar",
                "V. Vijayaraghavan"
            ],
            "title": "BP-Net: Efficient deep learning for continuous arterial blood pressure estimation using photoplethysmogram",
            "venue": "2021 20th IEEE International Conference on Machine Learning and Applications",
            "year": 2021
        },
        {
            "authors": [
                "M. Veglio",
                "A. Chinaglia",
                "P. Cavallo-Perin"
            ],
            "title": "QT interval, cardiovascular risk factors and risk of death in diabetes",
            "venue": "Journal of endocrinological investigation, 27: 175\u2013181.",
            "year": 2004
        },
        {
            "authors": [
                "K. Vo",
                "E.K. Naeini",
                "A. Naderi",
                "D. Jilani",
                "A.M. Rahmani",
                "N. Dutt",
                "H. Cao"
            ],
            "title": "P2E-WGAN: ECG waveform synthesis from PPG with conditional wasserstein generative adversarial networks",
            "venue": "Proceedings of the 36th Annual ACM Symposium on Applied Computing, 1030\u20131036.",
            "year": 2021
        },
        {
            "authors": [
                "M. W\u00f3jcikowski",
                "B. Pankiewicz"
            ],
            "title": "Photoplethysmographic time-domain heart rate measurement algorithm for resource-constrained wearable devices and its implementation",
            "venue": "Sensors, 20(6): 1783.",
            "year": 2020
        },
        {
            "authors": [
                "J.-Y. Zhu",
                "T. Park",
                "P. Isola",
                "A.A. Efros"
            ],
            "title": "Unpaired image-to-image translation using cycle-consistent adversarial networks",
            "venue": "Proceedings of the IEEE international conference on computer vision, 2223\u20132232.",
            "year": 2017
        },
        {
            "authors": [
                "Q. Zhu",
                "X. Tian",
                "C.-W. Wong",
                "M. Wu"
            ],
            "title": "Learning your heart actions from pulse: ECG waveform reconstruction from PPG",
            "venue": "IEEE Internet of Things Journal, 8(23): 16734\u2013 16748.",
            "year": 2021
        }
    ],
    "sections": [
        {
            "heading": "1 Introduction",
            "text": "The persistent rise in cardiovascular diseases (CVDs) is a leading cause of mortality worldwide, with an estimated 17.9 million fatalities attributed to CVDs in a year (Kauffman 2020). Early detection, timely intervention, and widelyaccessible health-monitoring devices are crucial factors in preventing CVDs and reducing related healthcare costs. Democratizing accurate cardiac monitoring is critical, as it empowers individuals and communities to take control of their cardiovascular health regardless of socioeconomic status or geographic location (Bayoumy et al. 2021).\nElectrocardiography (ECG) has long been the gold standard for cardiac monitoring, offering crucial insights to diagnose numerous CVDs (Hannun et al. 2019). However, their\nrequirement for specialized equipment and skilled medical personnel limits their accessibility and affordability for daily life cardiac activity monitoring. Continuous ECG monitoring is always preferred over conventional clinical settings as it offers a comprehensive assessment of cardiac activity by collecting and analyzing data from patients uninterruptedly in their day-to-day life, and is not limited to a single point in time. For example, the detection of Atrial Fibrillation (AFib) remains challenging due to its asymptomatic and intermittent nature (Camm, Corbucci, and Padeletti 2012), which often goes undetected in clinical settings that usually take place over the short duration of a patient\u2019s visit to the physician (Steinhubl et al. 2018).\nTo overcome these limitations, Photoplethysmography (PPG) has emerged as a promising non-invasive and costeffective alternative for continuous cardiac monitoring in wrist-based wearable devices. PPG is a non-invasive optical signal that measures blood volume fluctuations to capture cardiac activity. However, PPG lacks detailed cardiac information in comparison to ECG, which limits its use in diagnosing CVDs. Due to the non-invasive nature and ability of PPGs to be integrated into wearable devices, it provides an unmatched level of ubiquity.\nTo leverage the convenience and continuous monitoring ability of PPG and the diagnostic utility of ECG, PPG-toECG translation has emerged as a promising, yet challenging alternative (Sarkar and Etemad 2021; Vo et al. 2021; Lan 2023). The goal of PPG-to-ECG translation is to use deep learning techniques to generate ECG signals from PPG, with the aim that intricate CVD-related information in PPG signals become more prominent and detectable in the output ECG.\nWe identify two key areas that require significant improvement in the context of PPG-to-ECG translation. First, recent advances in Diffusion models have shown great promise in producing hyper-realistic content with high fidelity (Saharia et al. 2022; Blattmann et al. 2023; Ruan et al. 2023). Yet, to our knowledge, they have not been successfully explored for PPG-to-ECG translation. More specifically, designing Diffusion models capable of effectively learning the nuances of both spatial and temporal dynamics of bio-signals like ECG has not been explored. Second, despite promising results in PPG-to-ECG translation, to our knowledge, experiments to comprehensively evaluate the predictive power of the generated ECG in detecting CVDs in comparison to the original\nar X\niv :2\n30 8.\n13 56\n8v 2\n[ ee\nss .S\nP] 2\n8 D\nec 2\n02 3\nPPG signals has not been conducted.\nIn this paper, we leverage diffusion models (Sohl-Dickstein et al. 2015) and develop a framework for PPG-conditioned high-fidelity ECG generation. We observe that Diffusion models like Denoising Diffusion Probabilistic Models (DDPMs) (Ho, Jain, and Abbeel 2020) struggle to capture the nuances of bio-signal translation due to their inability to identify regions of interest (ROIs), and therefore fail to learn both the global structures and fine-grained local details. The underlying reason for this limitation is rooted in the forward process, which uniformly adds noise to the entire signal without considering the morphological differences of different biosignals (e.g., QRS complex in ECG or systolic peak in PPG). To overcome this challenge, we introduce a novel Diffusion model called Region-Disentangled Diffusion Model (RDDM) which is able to capture the complex temporal dynamics and region-specific intricate details of ECG signals. In particular, we introduce a novel forward process that selectively adds noise to specific ROIs in ECG and a reverse process that disentangles the denoising of QRS and Non-QRS regions. Our experiments show that our method outperforms state-of-theart methods in PPG-to-ECG translation in terms of standard error metrics (e.g., RMSE). Moreover, to tackle the second problem mentioned earlier, we introduce CardioBench, a comprehensive evaluation benchmark for PPG-to-ECG translation. CardioBench consists of a series of 5 cardiac-related tasks selected to evaluate the utility of the generated ECG signals. The tasks include (1) Heart rate (HR) estimation, (2) AFib detection, (3) Stress and Affect classification, (4) Diabetes detection, and (5) Blood Pressure (BP) estimation. Evaluating our proposed method on CardioBench demonstrates that the generated ECG signals can be effectively used for cardiac-related tasks, and can outperform the use of the original PPG for the same tasks by large margins.\nFollowing is a summary of our contributions:\n\u2022 We introduce RDDM, a novel diffusion model for highfidelity PPG-to-ECG translation. To the best of our knowledge, this is the first diffusion model for cross-modal signalto-signal translation in the bio-signal domain. \u2022 Our proposed RDDM introduces a novel approach that disentangles the diffusion process into two distinct components. The first component captures the global temporal structure of ECG signals, while the second component is dedicated to capture the fine-grained local details. This enables RDDM to generate high-fidelity ECG and do so in just 10 sampling steps making RDDM highly-efficient. \u2022 To evaluate the quality and utility of the generated ECG, we introduce CardioBench, a comprehensive evaluation benchmark comprised of 5 challenging cardiac-related tasks. \u2022 Our extensive evaluations demonstrate that the ECG signals generated by RDDM are significantly better in quality than DDPMs and prior works in both standard quantitative measures and their performance on CardioBench tasks. \u2022 We make the code public to the research community1.\n1https://github.com/DebadityaQU/RDDM\n2 Related work ECG synthesis with Generative models. Generative models, particularly Generative Adversarial Networks (GANs) have been used as a promising approach in ECG synthesis (Chen et al. 2022; Golany and Radinsky 2019). Recently, Diffusion models have also been used for ECG generation (Alcaraz and Strodthoff 2023; Adib et al. 2023; Neifar et al. 2023). Unconditional ECG generation using 2D Gramian Angular Field representations has been explored in (Adib et al. 2023). DDPMs have been used for ECG generation from clinical statements (Alcaraz and Strodthoff 2023). DiffECG (Neifar et al. 2023) explored the application of DDPM for classconditional ECG synthesis.\nPPG-to-ECG translation with Generative models. The research landscape of PPG-to-ECG translation remains relatively under-explored. Earlier attempts to solve this problem primarily focused on estimating various ECG parameters from PPG signals rather than direct reconstruction using methods like Feature selection (Banerjee et al. 2014), Linear regression (Zhu et al. 2021), and Dictionary learning (Tian et al. 2022). Such methods suffer a degradation in performance when evaluating in a subject-independent manner. CardioGAN (Sarkar and Etemad 2021) made the first attempt at using Generative models for direct PPG-to-ECG translation. They used unpaired training using CycleGAN (Zhu et al. 2017) with an improved architecture by incorporating attention and dual time-frequency discriminators. Empirically, they demonstrated significantly better HR estimation from the generated ECG compared to the original PPG. Similarly, (Vo et al. 2021) utilized conditional Wasserstein GANs for PPG-to-ECG translation. (Lan 2023) developed a Transformer-based framework for reconstructing ECG from PPG, and further fine-tuned the model for CVD detection using original PPG and generated ECG together.\n3 Region-Disentangled Diffusion Model Diffusion models (Sohl-Dickstein et al. 2015) consist of a forward and a reverse process. The forward diffusion process q(xt|xt\u22121) can be characterized as a Markov chain that progressively adds Gaussian noise at every timestep t:\nq(xT |x0) := T\u220f\nt=1\nq(xt|xt\u22121), where\nq(xt|xt\u22121) := N (xt; \u221a 1\u2212 \u03b2txt\u22121, \u03b2tI).\n(1)\nHere, x0 \u223c q(x0) is a clean signal and \u03b2t is a small positive constant obtained from a fixed variance schedule \u03b21, \u00b7 \u00b7 \u00b7 , \u03b2T . Let \u03b1t := 1 \u2212 \u03b2t and \u03b1\u0304t := \u220ft s=1 \u03b1s. Then, the forward diffusion process yields a sample at timestep t, denoted by xt, which can be obtained in a single step as follows:\nxt = \u221a \u03b1\u0304tx0 + \u221a 1\u2212 \u03b1\u0304t\u03f5, where \u03f5 \u223c N (0, I). (2)\nSince the reverse step of the forward process, q(xt\u22121|xt) is computationally infeasible, DDPMs (Ho, Jain, and Abbeel 2020) maximize the variational lower bound (ELBO) using a parameterized Gaussian transition p\u03b8(xt\u22121|xt) with parameter \u03b8. Consequently, the reverse process is approximated as\na Markov chain with a learned mean and a fixed variance, initiated from p(xT ) = N (xT ; 0, I):\np\u03b8(x0:T ) := p\u03b8(xT ) T\u220f t=1 p\u03b8(xt\u22121|xt), (3)\nwhere, p\u03b8(xt\u22121|xt) := N (xt\u22121;\u00b5\u03b8(xt, t), \u03c32t I). (4)\nand, \u00b5\u03b8(xt, t) := 1\u221a \u03b1t\n( xt \u2212\n1\u2212 \u03b1t\u221a 1\u2212 \u03b1\u0304t\n\u03f5\u03b8(xt, t) ) , (5)\nThe diffusion model \u03f5\u03b8 can be conditioned upon the input signal c, which makes the conditional objective:\nL(\u03b8) := Et,x0,\u03f5 [ |\u03f5\u2212 \u03f5\u03b8( \u221a \u03b1\u0304tx0 + \u221a 1\u2212 \u03b1\u0304t\u03f5, c, t)|2 ] . (6)\nPPG-to-ECG translation can be performed by adopting Equation 6 using the PPG signal as input condition c to generate the corresponding ECG signal x0. To enable the Diffusion model to learn both global structures and fine-grained local details of ECG for nuanced bio-signal translation, we propose RDDM which modifies the forward and reverse process of DDPMs as discussed below. Forward Process. The forward process of RDDM consists of 2 stages, (i) we obtain a noise-added sample xt following the standard forward process mentioned in Equation 2; (ii) in parallel, we also obtain a selectively noise-added sample x[m]t , in a process which we refer to as the ROI-guided forward process. Given the salience of cardiac-related information in the QRS complex of ECG signals, we define the ROI to\nAlgorithm 1: RDDM Training 1: repeat 2: x0 \u223c q(x0); 3: t \u223c Uniform({1, . . . , T}) 4: \u03f5 \u223c N (0, I) 5: Apply ROI mask: \u03f5[m] = (\u00b5 \u00b7 \u03f5) 6: Compute xt = \u221a \u03b1\u0304tx0 + \u221a 1\u2212 \u03b1\u0304t\u03f5\n7: Estimate x[p]t = \u03c1\u03d5(xt, c, t) 8: Compute x[m]t = \u221a \u03b1\u0304tx0 + \u221a 1\u2212 \u03b1\u0304t\u03f5[m] 9: Calculate gradient as\n\u2207\u03b8,\u03d5 ( \u03bb1 \u2225\u2225\u03f5[m]\u2212\u03f5\u03b8(x[m]t , c, t)\u2225\u22252+\u03bb2 \u2225\u2225\u2225x[m]t \u2212x[p]t \u2225\u2225\u22252) 10: until converged\nenable the Diffusion model to learn these regions effectively alongside the global structure of the ECG which is facilitated through the standard forward process. Accordingly, we define a binary mask \u00b5 with the same length of x as:\n\u00b5[i] =\n{ 1, if ir \u2212 \u03932 \u2264 i \u2264 ir + \u0393 2\n0, otherwise (7)\nwhere, ir denotes the indices of R-peaks and \u0393 is a hyperparameter defined as the window size to capture the ROI centered at ir. Finally, the ROI-guided forward process is defined as:\nx[m]t = \u221a \u03b1\u0304tx0 + \u221a 1\u2212 \u03b1\u0304t(\u00b5 \u00b7 \u03f5) where \u03f5 \u223c N (0, I). (8)\nReverse Process. Since \u00b5 is not available during inference, we approximate the parameterized transition \u03c1\u03d5(x [m] t |xt) by our training objective defined as:\nL(\u03b8, \u03d5) := E [ \u03bb1|(\u00b5 \u00b7 \u03f5)\u2212 \u03f5\u03b8(x[m]t , c, t)|2\n+\u03bb2|x[m]t \u2212 \u03c1\u03d5(xt, c, t)|2 ] .\n(9)\nHere, \u03bb1 and \u03bb2 are the loss coefficients. In our proposed objective, the first part is responsible for learning to denoise the ROIs (QRS), while the second part learns to denoise the rest of the regions (Non-QRS), effectively disentangling the denoising of the important regions of ECG signals.\nMore specifically, the objective function first guides the learning of \u03f5\u03b8, where \u03f5\u03b8 is responsible for refining the ROIs. The loss term |(\u00b5 \u00b7 \u03f5) \u2212 \u03f5\u03b8(x[m]t , c, t)|2 encourages \u03f5\u03b8 to estimate noise that, when subtracted from the signal, refines and enhances the morphology of the ROIs. This is achieved by minimizing the difference between the noise generated by \u03f5\u03b8 and the ROI-specific noise (\u03c1 \u00b7 \u03f5) in the original data distribution. Therefore, the role of \u03f5\u03b8 is to learn the finegrained details of the ROI.\nSecond, the loss term |x[m]t \u2212 \u03c1\u03d5(xt, c, t)|2 encourages \u03c1\u03d5 to minimize the discrepancy between x[m]t and the signal recovered by \u03c1\u03d5(xt, c, t). Consequently, the function \u03c1\u03d5 learns to denoise the non-ROI parts of the ECG signal, which implicitly involves learning \u2018where\u2019 to place the QRS complexes. This results in \u03c1\u03d5 capturing the temporal dynamics of the ECG signal. This disentanglement makes RDDM particularly suitable for PPG-to-ECG translation, which requires\nAlgorithm 2: RDDM Sampling\n1: xT \u223c N (0, I) 2: for t = T, . . . , 1 do 3: z \u223c N (0, I) if t > 1, else z = 0 4: x[p]t = \u03c1\u03d5(xt, c, t) 5: xt\u22121= 1\u221a\u03b1t ( x[p]t \u2212 1\u2212\u03b1t\u221a1\u2212\u03b1\u0304t \u03f5\u03b8(x [p] t , c, t) ) + \u03c3tz 6: end for 7: return x0\ncapturing both the spatial and temporal characteristics of ECG signals. The overall training algorithm of RDDM has been outlined in Algorithm 1. Sampling algorithm. As outlined in Algorithm 2, RDDM generates samples by initializing a random signal xT from a Gaussian distribution and iteratively applying the reverse process. For each time step t from T to 1, we sample a latent variable z from a Gaussian distribution if t > 1, otherwise, z = 0. We then obtain the ROI masked signal x[p]t as \u03c1\u03d5(xt, c, t). Finally, we update the signal xt\u22121 using \u03f5\u03b8. The resulting signal x0 is the final output of the sampling algorithm. The forward and reverse processes of our proposed method are depicted in Figure 1."
        },
        {
            "heading": "4 Experiment setup",
            "text": ""
        },
        {
            "heading": "4.1 Implementation details",
            "text": "Datasets. Following, we present the details of the datasets that are used in this study.\n\u2022 WESAD (Schmidt et al. 2018) comprises approximately 24 hours of synchronized Lead-II ECG data (sampled at 700Hz) and PPG data (sampled at 64 Hz) from 15 subjects with annotations of stress and affect states.\n\u2022 MIMIC AFib (Bashar et al. 2019) is a subset of the MIMIC-III waveform database (Johnson et al. 2016) with binary labels for AFib. It consists of 35 critically ill adults, out of which 19 suffer from AFib. Both ECG and PPG signals are sampled at 125 Hz.\n\u2022 PPG-BP (Liang et al. 2018) consists of 657 pre-windowed PPG signals from 219 subjects, along with rich metadata describing the health conditions of each subject. The PPG was recorded at a sampling rate of 1 kHz. Please note that unlike the other datasets used in this study, this dataset only consists of PPG signals and does not contain ECG.\n\u2022 Cuffless BP (Kachuee et al. 2015) is a dataset derived from the MIMIC-II waveform database (Saeed et al. 2011). It consists of thousands of PPG, ECG, and ABP signals recorded from various hospitals between 2001 and 2008, sampled at a frequency of 125 Hz.\n\u2022 CAPNO (Karlen 2021) comprises approximately 5.6 hours of paired Lead-II ECG and PPG signals sampled at 300 Hz. The data was recorded from 42 subjects under medical supervision.\n\u2022 BIDMC (Pimentel et al. 2016) is a dataset collected from 53 ICU patients, consisting of around 7 hours of concurrent Multi-lead ECG (Lead II, V, and AVR) and PPG\nsignals, both recorded at a frequency of 125 Hz. We utilize only the Lead-II ECG in our work.\n\u2022 DALIA (Reiss et al. 2019) is a dataset with approximately 35 hours of synchronized PPG and Lead-II ECG signals, recorded from 15 subjects performing daily-life activities like walking and driving. The ECG and PPG were recorded at sampling rates of 700 and 64 Hz respectively.\nTo train RDDM, we follow a similar setup to CardioGAN (Sarkar and Etemad 2021) and create a diverse training set by combining the paired ECG and PPG signals from WESAD, DALIA, CAPNO, BIDMC, and MIMIC-AFib. In particular, we use the data from 80% of the subjects for training and the remaining 20% of subjects are used for cross-subject evaluation. Additionally, for CardioBench, we use WESAD, DALIA, MIMIC AFib, PPG-BP, and Cuffless BP. Data pre-processing. We follow standard pre-processing steps for both ECG (Pan and Tompkins 1985; Makowski et al. 2021) and PPG (Makowski et al. 2021). First, we resample both signals at 128 Hz. Subsequently, we apply a highpass Butterworth filter with a cut-off frequency of 0.5 Hz on ECG signals. Similarly, a band-pass Butterworth filter with a cut-off frequency between 0.5 to 8 Hz is applied on PPG signals. Additionally, subject-specific z-score normalization is applied to compensate for individual variances. Further, min-max scaling is applied to re-scale the ECG and PPG signals between [\u22121, 1]. Finally, we segment both signals into 4-second windows which are used for RDDM training. Network architecture. We adapt the UNet architecture from (Ho, Jain, and Abbeel 2020; Dhariwal and Nichol 2021) and modify for 1D signals, which is used as the backbone for \u03f5\u03b8 and \u03c1\u03d5 modules. Additionally, we replace the default self-attention blocks with cross-attention modules to better condition the generated ECG for a given PPG input (Saharia et al. 2022). We apply cross-attention between ECG at the previous timestep and input PPG. Diffusion timestep t is added to each UNet block using Sinusoidal Position Embedding, similar to (Ho, Jain, and Abbeel 2020; Dhariwal and Nichol 2021; Saharia et al. 2022). The UNet architecture comprises 6 down-sampling and 6 up-sampling stages. During down-sampling, the number of filters is increased from 64 to 1024, doubling at each stage. Conversely, in up-sampling stages, the number of filters is decreased from 1024 to 64, halving at each stage. The final output is obtained from a single-channel convolutional layer. For a fair comparison, we also use the same architecture for the baseline DDPMs. Training setup and hyper-parameters. We train RDDM on 4\u00d7 NVIDIA A100 GPUs with a batch size of 512. We choose AdamW (Loshchilov and Hutter 2018) as the optimizer with a Cosine learning rate scheduler, having a base learning rate of 10\u22124 for a total of 500 epochs. We use a fixed linear variance scheduler with \u03b2 \u2208 (0.0001, 0.2). We empirically set the sampling steps to 10 and the ROI window size to \u0393 = 32 (see related study in Sec. 5.5). The loss coefficients in Equation 9 are set to \u03bb1 = 100 and \u03bb2 = 1."
        },
        {
            "heading": "4.2 Evaluation",
            "text": "We perform two types of evaluation to ensure a robust assessment of generated ECGs. First, we perform \u2018standard\u2019\nevaluation to report the error/distance metrics between generated ECG and ground-truth ECG. Additionally, to understand the utility and predictive power of the generated ECG in analyzing cardiac activity, we introduce a comprehensive evaluation benchmark, CardioBench. Following, we provide the details for both setups.\nStandard evaluation. The generated ECG signals are evaluated on standard quantitative metrics in a subjectindependent manner. Following CardioGAN (Sarkar and Etemad 2021), we generate 4-second ECG signals from RDDM and measure Root Mean Squared Error (RMSE) and Fre\u0301chet Distance (FD) with respect to the original ECG.\nCardioBench. To test the utility of the generated ECG in analyzing cardiac activity, e.g., detecting CVDs, we introduce CardioBench. CardioBench is designed as a comprehensive and challenging benchmark aimed at evaluating the generated ECG signals, with a focus on their ability to facilitate the detection of a range of heart conditions. Our proposed benchmark consists of 5 cardiac-related tasks across 6 datasets:\n(1) Heart rate estimation on WESAD (Schmidt et al. 2018) and DALIA (Reiss et al. 2019) datasets: Accurate HR estimation from synthetic ECG depends on the presence of R-peaks at the correct temporal locations with consistent RR intervals. Therefore, HR estimation is included to evaluate the temporal fidelity of generative models. In line with previous literature (Sarkar and Etemad 2021), we perform HR estimation by calculating Mean Absolute Error (MAE) in beats per minute (bpm) which measures the difference between the ground truth HR and the HR estimated from the generated ECG signals. We use (Hamilton 2002) for HR estimation from the generated ECG using 8-second windows.\n(2) Atrial Fibrillation detection on MIMIC-AFib (Bashar et al. 2019) dataset: AFib detection in synthetic ECG demands accurate generation of non-periodic irregular rhythms, absent P waves, variable ventricular rates, possible fibrillatory waves, and temporally compressed QRS complexes (Burns and Buttner 2023). This ability serves as a vital measure of a generative model\u2019s proficiency in capturing both detailed morphological features and non-periodic temporal dynamics, crucial for AFib detection. We evaluate the binary AFib classification using 4-second ECG windows. We apply Shorttime Fourier Transform (STFT) on the generated ECG and use it as input to a standard VGG-13 (Sallem et al. 2020).\n(3) Stress and Affect classification on WESAD (Schmidt et al. 2018) dataset: Stress and affect classification using generated ECG requires an accurate representation of nuanced changes in heart rate variability (Kim et al. 2018), sympathetic-parasympathetic balance (Tewari et al. 2006), and emotional state-induced ECG patterns (Sarkar and Etemad 2020). This capability acts as an indicator of a generative model\u2019s adeptness at capturing subtle morphological features and dynamic temporal changes. We perform threeclass classification of neutral, stress, and amusement. We adopt a Transformer-based classifier (Behinaein et al. 2021) using a window size of 60 seconds for a fair comparison with previous methods.\n(4) Diabetes detection on PPG-BP (Liang et al. 2018) dataset: Diabetes detection from synthetic ECG involves accurate capture of the anomalies in the ECG signals induced by the disease, such as prolonged QT intervals, alterations in the QRS complex, and changes in the ST-T segment (Veglio, Chinaglia, and Cavallo-Perin 2004). The ability to generate these distinguishing spatiotemporal variations serves as a crucial metric for ECG generation. We evaluate the generated ECG on the binary classification task of Diabetes detection. We adopt a VGG-11 classifier (Reiss et al. 2019) and apply STFT on the input. We use 2-second windows as per the pre-windowed dataset.\n(5) Blood Pressure estimation on Cuffless-BP (Kachuee et al. 2015) dataset: Estimation of BP from synthetic ECG require an accurate representation of ECG-derived features like heart rate, P wave, QRS duration, and QT interval, all of which correlate with blood pressure levels (Peng et al. 2006; Bird et al. 2020). This serves as a vital test of a generative model\u2019s capacity to reproduce fine-grained morphological and dynamic temporal features. We estimate the Systolic Blood Pressure (SBP) and Diastolic Blood Pressure (DBP), and evaluate using MAE. We use a simple 1D-UNet (Long and Wang 2023) as our estimator, and use 10 second windows following prior methods. Comparison setup. HR estimation using (Hamilton 2002) does not require specific training, and generated ECG is used directly for estimation. The other 4 tasks, however, require training neural nets. As a result, for AFib detection and Stress and Affect classification, we train the models using real ECG and evaluate on both real and generated ECG signals. We treat performance on the real ECG of the test splits as the\nupper bound and compare the performance of the generated ECG in each specific task. A similar approach is taken for BP estimation, with the distinction that it is treated as a multimodal task (Elgendi et al. 2019), for which we use the PPG and real ECG for training. Finally, to conduct Diabetes detection, we directly train the classifier on the generated ECG due to the unavailability of original ECG signals and use the ECG generated from the test set for testing. We present the key implementation details for evaluation on CardioBench in Table 1."
        },
        {
            "heading": "5 Results",
            "text": ""
        },
        {
            "heading": "5.1 Standard evaluation",
            "text": "The results presented in Table 2 clearly show that RDDM surpasses the current state-of-the-art PPG-to-ECG translation model (Sarkar and Etemad 2021) by a significant margin on all the datasets. For instance, RDDM improves RMSE from 0.63 to 0.24 on BIDMC. Additionally, RDDM outperforms the best version of the baseline DDPM by a large margin even when RDDM uses just 10 sampling steps compared to the best DDPM that uses 50 sampling steps."
        },
        {
            "heading": "5.2 Evaluation on CardioBench",
            "text": "HR estimation. Table 3 demonstrates that RDDM outperforms prior works and DDPM by achieving a substantially lower MAE on both datasets. On DALIA, RDDM achieves state-of-the-art MAE of 4.49 bpm, outperforming the best PPG-based method (Song, Nam, and Kim 2021) by 1.53 bpm. RDDM demonstrates an improvement of 1.17 bpm over DDPM. Next, on WESAD, RDDM achieves state-ofthe-art MAE of 1.40 bpm compared to the best PPG-based method (Reiss et al. 2019), CardioGAN, and DDPM, which achieve 9.50, 8.60, and 3.22 respectively. AFib detection. As reported in Table 4, RDDM outperforms both existing PPG-based methods and DDPM. Specifically, RDDM achieves F1=0.71 and Acc. = 0.65, demonstrating improvements of 11% and 22% over DDPM, and approximately 16% and 4% when compared to the top-performing PPG-based method (Aliamiri and Shen 2018). Moreover, our method shows the closest performance to the upper bound, achieving an F1 of 0.71 vs. the upper bound 0.74. Stress and Affect classification. As highlighted in Table 5, our method achieves superior performance compared to prior methods, with F1 = 0.64 and Acc. = 0.71. Compared to the best PPG-based method (Schmidt et al. 2018), RDDM exhibits a boost of 7% in F1 and 6% in Acc. Furthermore, RDDM also outperforms DDPM which achieves similar performance to (Schmidt et al. 2018). Moreover, our method shows the closest performance to the upper bound, achieving an F1 of 0.64, compared to the upper bound F1 of 0.68. Diabetes detection. As illustrated in Table 6, RDDM significantly improves upon existing PPG-based methods and\nDDPM in diabetes detection. Notably, our method achieves an Acc. of 0.80 and an F1 of 0.52, indicating substantial improvements of 15% in Acc. and 8% in F1, compared to the leading PPG-based method (Avram et al. 2020), which registers an Acc. of 0.65 and an F1 of 0.44. Furthermore, RDDM outperforms DDPM by an impressive margin of 33% and 9% in terms of Acc. and F1 respectively. It is notable that despite the multimodal classifier introduced by Performer (Lan 2023) being pre-trained on a large corpus, a classifier trained from scratch only on ECG signals generated by RDDM still outperforms it, marking an Acc. improvement of 4%. This result shows the high-fidelity of the ECG generated by RDDM. BP estimation. As demonstrated in Table 7, RDDM attains a state-of-the-art performance in BP estimation, achieving an MAE-SBP of 2.48 and an MAE-DBP of 1.20. Remarkably, RDDM makes significant improvements compared to the best PPG-based method (Vardhan et al. 2021) with a\nmargin of 2.68 in MAE-SBP and 2.25 in MAE-DBP. This performance gain supports the notion that the ECG generated by RDDM provides complementary information learned through training on a large dataset of PPG-ECG pairs, which could enhance the performance beyond what is possible with PPG-only BP estimation methods. Furthermore, RDDM even outperforms the upper bound by achieving MAE-SBP = 2.48 vs. the upper bound MAE-SBP = 3.31, and performs closely to the upper bound in terms of MAE-DBP. We believe this improvement over upper-bound is observed as the original ECG signals were quite noisy. Although DDPM achieves the lowest MAE-DBP = 0.63, it performs poorly in terms of estimating SBP, with an MAE-SBP = 5.95. In contrast, RDDM provides a balanced performance for estimating both SBP and DBP, demonstrating real-world utility."
        },
        {
            "heading": "5.3 Qualitative analysis",
            "text": "In Figure 2, we perform qualitative comparisons between RDDM with the best DDPM (50 sampling steps) and CardioGAN. Our comparison includes samples from MIMIC-AFib, WESAD, CAPNO, and BIDMC, covering a diverse set of PPG inputs of varying natures. The ECG signals generated by RDDM demonstrate high-fidelity compared to the groundtruth ECG signals, across all datasets. While comparing samples from MIMIC and BIDMC, generated ECG signals from CardioGAN and DDPM fail to accurately reproduce the QRS\ncomplex structure and significantly deviate from the original ECG morphology. Additionally, the generated ECG samples from DDPM exhibit higher noise as shown in MIMIC. In stark contrast, RDDM generates ECG signals that are almost identical to the ground truth ECG. Furthermore, in case of noisy PPG input, RDDM maintains temporal fidelity (as shown in WESAD) and also approximates the fine-grained structure of the QRS complex with remarkable precision. In contrast, DDPM and CardioGAN struggle to accurately generate QRS complex, leading to distorted temporal fidelity which results in irregular RR intervals. We provide additional generated ECG samples corresponding to different affective states in Figure 3 and samples corresponding to AFib patients in Figure 4."
        },
        {
            "heading": "5.4 Inference Time Comparison",
            "text": "Figure 5 presents an inference time comparison between RDDM and DDPM variants. We measure the total inference time required to translate the PPG test set of each dataset into ECG signals for standard evaluation (i.e., RMSE). We use a single Nvidia 2080Ti GPU for this experiment. Across all datasets, RDDM consistently exhibits the best balance between RMSE and inference time. In contrast, DDPM with 50 sampling steps not only performs worse in RMSE but\nis also slower by a factor of approx. 2.5\u00d7, highlighting the superiority of RDDM in both speed and fidelity."
        },
        {
            "heading": "5.5 Analysis of RDDM",
            "text": "ROI window size. To find the optimal ROI window size, we vary the value of \u0393 between 16 and 64 with a step size of 16 and track their performance on AFib detection. Figure 6 (left) shows that both extremely small (\u0393=16) and large window (\u0393=64) sizes degrade performance as they fail to capture the ROI accurately. An ROI window size of 32 works best in our setup, which is used in all the experiments. Sampling steps. To find the optimal value, we vary the number of sampling steps from 5 to 25 with a step size of 5 and evaluate on HR estimation. The results presented in Figure 6 (right) exhibit a similar trend for both WESAD and DALIA. The performance significantly improves when the number of sampling steps is increased from 5 to 10. However, the performance declines when the sampling steps are increased further. Thus, we set the sampling steps as 10 for RDDM.\n6 Conclusion In this paper, we introduce a novel diffusion model RDDM, specifically designed for high-fidelity PPG-to-ECG translation. To the best of our knowledge, RDDM is the first\ndiffusion model for cross-modal signal-to-signal translation within the domain of bio-signals. The issue of indiscriminate noise addition during the forward process limits diffusion models like DDPMs from capturing both temporal structures and morphological details. RDDM improves upon them by introducing a novel ROI-guided forward process and by disentangling the reverse process into 2 distinct components: (i) capturing the global temporal structure of ECG signals and (ii) capturing fine-grained local details. This allows RDDM to generate high-fidelity ECG signals in just 10 sampling steps. To assess the utility of generated ECG, we introduce a comprehensive evaluation benchmark CardioBench. CardioBench includes 5 popular cardiac-related tasks: HR and BP estimation, stress classification, and detection of AFib and diabetes. RDDM achieves superior performance compared to DDPM and prior works, excelling in both standard quantitative measures and performance on CardioBench."
        },
        {
            "heading": "Acknowledgement",
            "text": "This work was supported by Mitacs, Vector Institute, and Ingenuity Labs Research Institute."
        }
    ],
    "title": "Region-Disentangled Diffusion Model for High-Fidelity PPG-to-ECG Translation",
    "year": 2023
}