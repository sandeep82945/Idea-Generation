{
    "abstractText": "In this paper, we thoroughly analyze the detection of sleep apnea events in the context of Obstructive Sleep Apnea (OSA), which is considered a public health problem because of its high prevalence and serious health implications. We especially evaluate patients who do not always show desaturations during apneic episodes (non-desaturating patients). For this purpose, we use a database (HuGCDN2014-OXI) that includes desaturating and non-desaturating patients, and we use the widely used Physionet Apnea Dataset for a meaningful comparison with prior work. Our system combines features extracted from the Heart-Rate Variability (HRV) and SpO2, and it explores their potential to characterize desaturating and non-desaturating events. The HRV-based features include spectral, cepstral, and nonlinear information (Detrended Fluctuation Analysis (DFA) and Recurrence Quantification Analysis (RQA)). SpO2-based features include temporal (variance) and spectral information. The features feed a Linear Discriminant Analysis (LDA) classifier. The goal is to evaluate the effect of using these features either individually or in combination, especially in non-desaturating patients. The main results for the detection of apneic events are: (a) Physionet success rate of 96.19%, sensitivity of 95.74% and specificity of 95.25% (Area Under Curve (AUC): 0.99); (b) HuGCDN2014-OXI of 87.32%, 83.81% and 88.55% (AUC: 0.934), respectively. The best results for the global diagnosis of OSA patients (HuGCDN2014-OXI) are: success rate of 95.74%, sensitivity of 100%, and specificity of 89.47%. We conclude that combining both features is the most accurate option, especially when there are non-desaturating patterns among the recordings under study.",
    "authors": [
        {
            "affiliations": [],
            "name": "Sof\u00eda Mart\u00edn-Gonz\u00e1lez"
        },
        {
            "affiliations": [],
            "name": "Antonio G. Ravelo-Garc\u00eda"
        },
        {
            "affiliations": [],
            "name": "Juan L. Navarro-Mesa"
        },
        {
            "affiliations": [],
            "name": "Eduardo Hern\u00e1ndez-P\u00e9rez"
        }
    ],
    "id": "SP:4ead2ff1285334ec07a35c841ff8bee5069fd62f",
    "references": [
        {
            "authors": [
                "J. Bousquet",
                "N. Khaltaev"
            ],
            "title": "World Health Organization. Global Surveillance, Prevention and Control of Chronic Respiratory Diseases: A Comprehensive Approach",
            "venue": "World Health Organization: Geneva, Switzerland,",
            "year": 2007
        },
        {
            "authors": [
                "L. Lavie"
            ],
            "title": "Obstructive sleep apnoea syndrome\u2014An oxidative stress disorder",
            "venue": "Sleep Med. Rev",
            "year": 2003
        },
        {
            "authors": [
                "E.A. Phillipson"
            ],
            "title": "Sleep Apnea\u2014A Major Public Health Problem",
            "venue": "N. Engl. J. Med",
            "year": 2002
        },
        {
            "authors": [
                "R.B. Berry",
                "R. Budhiraja",
                "D.J. Gottlieb",
                "D. Gozal",
                "C. Iber",
                "V.K. Kapur",
                "C.L. Marcus",
                "R. Mehra",
                "S. Parthasarathy",
                "S.F Quan"
            ],
            "title": "Rules for Scoring Respiratory Events in Sleep: Update of the 2007 AASM Manual for the Scoring of Sleep and Associated Events",
            "venue": "J. Clin. Sleep Med",
            "year": 2012
        },
        {
            "authors": [
                "W.W. Flemons",
                "M.R. Littner",
                "J.A. Rowley",
                "P. Gay",
                "W.M. Anderson",
                "D.W. Hudgel",
                "R.D. McEvoy",
                "D.I. Loube"
            ],
            "title": "Home Diagnosis of Sleep Apnea: A Systematic Review of the Literature",
            "venue": "Chest",
            "year": 2003
        },
        {
            "authors": [
                "F. Mendonca",
                "S.S. Mostafa",
                "A.G. Ravelo-Garcia",
                "F. Morgado-Dias",
                "T. Penzel"
            ],
            "title": "A Review of Obstructive Sleep Apnea Detection Approaches",
            "venue": "IEEE J. Biomed. Health Inform",
            "year": 2019
        },
        {
            "authors": [
                "C. Doukas",
                "T. Petsatodis",
                "C. Boukis",
                "I. Maglogiannis"
            ],
            "title": "Automated sleep breath disorders detection utilizing patient sound analysis",
            "venue": "Biomed. Signal Process. Control",
            "year": 2012
        },
        {
            "authors": [
                "A.M. Alencar",
                "D.G.V. da Silva",
                "C.B. Oliveira",
                "A.P. Vieira",
                "H.T. Moriya",
                "G. Lorenzi-Filho"
            ],
            "title": "Dynamics of snoring sounds and its connection with obstructive sleep apnea",
            "venue": "Phys. A: Stat. Mech. Appl",
            "year": 2013
        },
        {
            "authors": [
                "L. Almazaydeh",
                "K. Elleithy",
                "M. Faezipour",
                "A. Abushakra"
            ],
            "title": "Apnea Detection based on Respiratory Signal Classification",
            "venue": "Procedia Comput. Sci",
            "year": 2013
        },
        {
            "authors": [
                "H. ElMoaqet",
                "J. Kim",
                "D. Tilbury",
                "S.K. Ramachandran",
                "M. Ryalat",
                "C.-H. Chu"
            ],
            "title": "Gaussian Mixture Models for Detecting Sleep Apnea Events",
            "venue": "Using Single Oronasal Airflow Record. Appl. Sci",
            "year": 2020
        },
        {
            "authors": [
                "H. ElMoaqet",
                "M. Eid",
                "M. Glos",
                "M. Ryalat",
                "T. Penzel"
            ],
            "title": "Deep Recurrent Neural Networks for Automatic Detection of Sleep Apnea from Single Channel Respiration Signals",
            "venue": "Sensors",
            "year": 2020
        },
        {
            "authors": [
                "J. Kim",
                "H. ElMoaqet",
                "D.M. Tilbury",
                "S.K. Ramachandran",
                "T. Penzel"
            ],
            "title": "Time domain characterization for sleep apnea in oronasal airflow signal: A dynamic threshold classification approach",
            "venue": "Physiol. Meas. 2019,",
            "year": 2019
        },
        {
            "authors": [
                "Y. Maali",
                "A. Al-Jumaily"
            ],
            "title": "Multi Neural Networks Investigation based Sleep Apnea Prediction",
            "venue": "Procedia Comput. Sci",
            "year": 2013
        },
        {
            "authors": [
                "A.M. Benavides",
                "R.F. Pozo",
                "D.T. Toledano",
                "J.L.B. Murillo",
                "E.L. Gonzalo",
                "L.H. G\u00f3mez"
            ],
            "title": "Analysis of voice features related to obstructive sleep apnoea and their application in diagnosis",
            "venue": "support. Comput. Speech Lang",
            "year": 2014
        },
        {
            "authors": [
                "J. Sol\u00e9-Casals",
                "C. Munteanu",
                "O.C. Mart\u00edn",
                "F. Barb\u00e9",
                "C. Queipo",
                "J. Amilibia",
                "J. Dur\u00e1n-Cantolla"
            ],
            "title": "Detection of severe obstructive sleep apnea through voice analysis",
            "venue": "Appl. Soft Comput",
            "year": 2014
        },
        {
            "authors": [
                "C. Varon",
                "A. Caicedo",
                "D. Testelmans",
                "B. Buyse",
                "S. Van Huffel"
            ],
            "title": "A Novel Algorithm for the Automatic Detection of Sleep Apnea from Single-Lead ECG",
            "venue": "IEEE Trans. Biomed. Eng",
            "year": 2015
        },
        {
            "authors": [
                "A.G. Ravelo-Garc\u00eda",
                "U. Casanova-Blancas",
                "S. Mart\u00edn-Gonz\u00e1lez",
                "E. Hern\u00e1ndez-P\u00e9rez",
                "I. Guerra-Moreno",
                "P. Quintana-Morales",
                "N. Wessel",
                "J.L. Navarro-Mesa"
            ],
            "title": "An approach to the enhancement of sleep apnea detection by means of detrended fluctuation analysis of RR intervals",
            "venue": "In Proceedings of the Computing in Cardiology",
            "year": 2014
        },
        {
            "authors": [
                "T. Penzel",
                "J. Kantelhardt",
                "L. Grote",
                "J. Peter",
                "A. Bunde"
            ],
            "title": "Comparison of detrended fluctuation analysis and spectral analysis for heart rate variability in sleep and sleep apnea",
            "venue": "IEEE Trans. Biomed. Eng",
            "year": 2003
        },
        {
            "authors": [
                "T. Penzel",
                "J. McNames",
                "P. De Chazal",
                "B. Raymond",
                "A. Murray",
                "G. Moody"
            ],
            "title": "Systematic comparison of different algorithms for apnoea detection based on electrocardiogram recordings",
            "venue": "Med. Biol. Eng. Comput",
            "year": 2002
        },
        {
            "authors": [
                "J. Mietus",
                "C. Peng",
                "P. Ivanov",
                "A. Goldberger"
            ],
            "title": "Detection of obstructive sleep apnea from cardiac interbeat interval time series",
            "venue": "In Proceedings of the Computing in Cardiology",
            "year": 2000
        },
        {
            "authors": [
                "S. Mart\u00edn-Gonz\u00e1lez",
                "J.L. Navarro-Mesa",
                "G. Juli\u00e1-Serd\u00e1",
                "J.F. Kraemer",
                "N. Wessel",
                "A.G. Ravelo-Garc\u00eda"
            ],
            "title": "Heart rate variability feature selection in the presence of sleep apnea: An expert system for the characterization and detection of the disorder",
            "venue": "Comput. Biol. Med",
            "year": 2017
        },
        {
            "authors": [
                "C. Maier",
                "H. Dickhaus",
                "M. Bauch",
                "T. Penzel"
            ],
            "title": "Comparison of heart rhythm and morphological ECG features in recognition of sleep apnea from the ECG",
            "venue": "In Proceedings of the Computing in Cardiology",
            "year": 2000
        },
        {
            "authors": [
                "C. Song",
                "K. Liu",
                "X. Zhang",
                "L. Chen",
                "X. Xian"
            ],
            "title": "An Obstructive Sleep Apnea Detection Approach Using a Discriminative Hidden Markov Model from ECG Signals",
            "venue": "IEEE Trans. Biomed. Eng",
            "year": 2016
        },
        {
            "authors": [
                "K. Karandikar",
                "T.Q. Le",
                "A. Sa-Ngasoongsong",
                "W. Wongdhamma",
                "S.T.S. Bukkapatnam"
            ],
            "title": "Detection of sleep apnea events via tracking nonlinear dynamic cardio-respiratory coupling from electrocardiogram signals",
            "venue": "In Proceedings of the 2013 35th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC),",
            "year": 2013
        },
        {
            "authors": [
                "A. Hossen",
                "B. Al Ghunaimi",
                "M.O. Hassan"
            ],
            "title": "Subband decomposition soft-decision algorithm for heart rate variability analysis in patients with obstructive sleep apnea and normal controls",
            "venue": "Signal Process",
            "year": 2005
        },
        {
            "authors": [
                "G. Guti\u00e9rrez-Tobal",
                "D. \u00c1lvarez",
                "J. Gomez-Pilar",
                "F. Del Campo",
                "R. Hornero"
            ],
            "title": "Assessment of Time and Frequency Domain Entropies to Detect Sleep Apnoea in Heart Rate Variability Recordings from Men and Women",
            "year": 2015
        },
        {
            "authors": [
                "L.J. Gula",
                "A.D. Krahn",
                "A. Skanes",
                "K.A. Ferguson",
                "C. George",
                "R. Yee",
                "G.J. Klein"
            ],
            "title": "Heart Rate Variability in Obstructive Sleep Apnea: A Prospective Study and Frequency Domain Analysis",
            "venue": "Ann. Noninvasive Electrocardiol",
            "year": 2003
        },
        {
            "authors": [
                "M. Bsoul",
                "H. Minn",
                "L. Tamil"
            ],
            "title": "Apnea MedAssist: Real-time Sleep Apnea Monitor Using Single-Lead ECG",
            "venue": "IEEE Trans. Inf. Technol. Biomed",
            "year": 2011
        },
        {
            "authors": [
                "C. Zamarr\u00f3n",
                "P. Romero",
                "J. Rodriguez",
                "F. Gude"
            ],
            "title": "Oximetry spectral analysis in the diagnosis of obstructive sleep apnoea",
            "venue": "Clin. Sci",
            "year": 1999
        },
        {
            "authors": [
                "J.V. Marcos",
                "R. Hornero",
                "D. Alvarez",
                "F. del Campo",
                "C. Zamarr\u00f3n"
            ],
            "title": "Assessment of four statistical pattern recognition techniques to assist in obstructive sleep apnoea diagnosis from nocturnal oximetry",
            "venue": "Med. Eng. Phys",
            "year": 2009
        },
        {
            "authors": [
                "J.V. Marcos",
                "R. Hornero",
                "D. Alvarez",
                "F. Del Campo",
                "M. L\u00f3pez",
                "C. Zamarr\u00f3n"
            ],
            "title": "Radial basis function classifiers to help in the diagnosis of the obstructive sleep apnoea syndrome from nocturnal oximetry",
            "venue": "Med. Biol. Eng. Comput",
            "year": 2008
        },
        {
            "authors": [
                "J.V. Marcos",
                "R. Hornero",
                "D. Alvarez",
                "F. Del Campo",
                "M. Aboy"
            ],
            "title": "Automated detection of obstructive sleep apnoea syndrome from oxygen saturation recordings using linear discriminant analysis",
            "venue": "Med. Biol. Eng. Comput",
            "year": 2010
        },
        {
            "authors": [
                "J.V. Marcos",
                "R. Hornero",
                "D. \u00c1lvarez",
                "M. Aboy",
                "F. Del Campo"
            ],
            "title": "Automated Prediction of the Apnea-Hypopnea Index from Nocturnal Oximetry Recordings",
            "venue": "IEEE Trans. Biomed. Eng",
            "year": 2012
        },
        {
            "authors": [
                "J.V. Marcos",
                "R. Hornero",
                "D. Alvarez",
                "I. Nabney",
                "F. Del Campo",
                "C. Zamarr\u00f3n"
            ],
            "title": "The classification of oximetry signals using Bayesian neural networks to assist in the detection of obstructive sleep apnoea syndrome",
            "venue": "Physiol. Meas",
            "year": 2010
        },
        {
            "authors": [
                "U.J. Magalang",
                "J. Dmochowski",
                "S. Veeramachaneni",
                "A. Draw",
                "M.J. Mador",
                "A. El-Solh",
                "B.J. Grant"
            ],
            "title": "Prediction of the ApneaHypopnea Index from Overnight Pulse Oximetry",
            "venue": "Chest",
            "year": 2003
        },
        {
            "authors": [
                "Y. Lee",
                "M. Bister",
                "P. Blanchfield",
                "Y. Salleh"
            ],
            "title": "Automated detection of obstructive apnea and hypopnea events from oxygen saturation signal",
            "venue": "In Proceedings of the 26th Annual International Conference of the IEEE Engineering in Medicine and Biology Society, San Francisco, CA, USA,",
            "year": 2004
        },
        {
            "authors": [
                "B. Xie",
                "W. Qiu",
                "H. Minn",
                "L. Tamil",
                "M. Nourani"
            ],
            "title": "An Improved Approach for Real-time Detection of Sleep Apnea",
            "venue": "In Proceedings of the BIOSIGNALS 2011\u2014Proceedings of the International Conference on Bio-Inspired Systems and Signal Processing,",
            "year": 2011
        },
        {
            "authors": [
                "T.Q. Le",
                "C. Cheng",
                "A. Sangasoongsong",
                "S.T. Bukkapatnam"
            ],
            "title": "Prediction of sleep apnea episodes from a wireless wearable multisensor suite",
            "venue": "In Proceedings of the 2013 IEEE Point-of-Care Healthcare Technologies (PHT), Bangalore, India,",
            "year": 2013
        },
        {
            "authors": [
                "C.-C. Hua",
                "C.-C. Yu"
            ],
            "title": "Smoothed Periodogram of Oxyhemoglobin Saturation by Pulse Oximetry in Sleep Apnea Syndrome",
            "venue": "Chest",
            "year": 2007
        },
        {
            "authors": [
                "R. Hornero",
                "D. Alvarez",
                "D. Abasolo",
                "F. del Campo",
                "C. Zamarron"
            ],
            "title": "Utility of Approximate Entropy from Overnight Pulse Oximetry Data in the Diagnosis of the Obstructive Sleep Apnea Syndrome",
            "venue": "IEEE Trans. Biomed. Eng",
            "year": 2007
        },
        {
            "authors": [
                "L.W. Hang",
                "C.W. Yen",
                "C.L. Lin"
            ],
            "title": "Frequency-domain index of oxyhemoglobin saturation from pulse oximetry for obstructive sleep apnea syndrome",
            "venue": "J. Med. Biol. Eng",
            "year": 2012
        },
        {
            "authors": [
                "A. Burgos",
                "A. Go\u00f1i",
                "A. Illarramendi",
                "J. Bermudez"
            ],
            "title": "Real-Time Detection of Apneas on a PDA",
            "venue": "IEEE Trans. Inf. Technol. Biomed",
            "year": 2010
        },
        {
            "authors": [
                "J.-C. V\u00e1zquez-Garc\u00eda",
                "W.H. Tsai",
                "W.W. Flemons",
                "A. Masuda",
                "R. Brant",
                "E. Hajduk",
                "W.A. Whitelaw",
                "J.E. Remmers"
            ],
            "title": "Automated analysis of digital oximetry in the diagnosis of obstructive sleep apnoea",
            "venue": "Thorax",
            "year": 2000
        },
        {
            "authors": [
                "D. \u00c1lvarez",
                "R. Hornero",
                "M. Garc\u00eda",
                "F. del Campo",
                "C. Zamarr\u00f3n"
            ],
            "title": "Improving diagnostic ability of blood oxygen saturation from overnight pulse oximetry in obstructive sleep apnea detection by means of central tendency measure",
            "venue": "Artif. Intell. Med",
            "year": 2007
        },
        {
            "authors": [
                "D. \u00c1lvarez",
                "R. Hornero",
                "D. Ab\u00e1solo",
                "F. Del Campo",
                "C. Zamarr\u00f3n"
            ],
            "title": "Nonlinear characteristics of blood oxygen saturation from nocturnal oximetry for obstructive sleep apnoea detection",
            "venue": "Physiol. Meas",
            "year": 2006
        },
        {
            "authors": [
                "D. Alvarez",
                "G.C. Gutierrez-Tobal",
                "F. Vaquerizo-Villar",
                "V. Barroso-Garcia",
                "A. Crespo",
                "C.A. Arroyo",
                "F. Del Campo",
                "R. Hornero"
            ],
            "title": "Automated analysis of unattended portable oximetry by means of Bayesian neural networks to assist in the diagnosis of sleep apnea",
            "venue": "In Proceedings of the 2016 Global Medical Engineering Physics Exchanges/Pan American Health Care Exchanges (GMEPE/PAHCE),",
            "year": 2016
        },
        {
            "authors": [
                "D.S. Morillo",
                "N. Gross",
                "A. Le\u00f3n",
                "L.F. Crespo"
            ],
            "title": "Automated frequency domain analysis of oxygen saturation as a screening tool for SAHS",
            "venue": "Med. Eng. Phys",
            "year": 2012
        },
        {
            "authors": [
                "D.S. Morillo",
                "J.L. Rojas",
                "L.F. Crespo",
                "A. Le\u00f3n",
                "N. Gross"
            ],
            "title": "Poincar\u00e9 analysis of an overnight arterial oxygen saturation signal applied to the diagnosis of sleep apnea hypopnea syndrome",
            "venue": "Physiol. Meas",
            "year": 2009
        },
        {
            "authors": [
                "J. Zhang",
                "Q. Zhang",
                "Y. Wang",
                "C. Qiu"
            ],
            "title": "A real-time auto-adjustable smart pillow system for sleep apnea detection and treatment",
            "venue": "In Proceedings of the 12th International Conference on Information Processing in Sensor Networks\u2014IPSN \u201913,",
            "year": 2013
        },
        {
            "authors": [
                "L.-W. Hang",
                "H.-L. Wang",
                "J.-H. Chen",
                "J.-C. Hsu",
                "H.-H. Lin",
                "W.-S. Chung",
                "Y.-F. Chen"
            ],
            "title": "Validation of overnight oximetry to diagnose patients with moderate to severe obstructive sleep apnea",
            "venue": "BMC Pulm. Med",
            "year": 2015
        },
        {
            "authors": [
                "D.W. Jung",
                "S.H. Hwang",
                "J.G. Cho",
                "B.H. Choi",
                "H.J. Baek",
                "Y.J. Lee",
                "D.-U. Jeong",
                "K.S. Park"
            ],
            "title": "Real-Time Automatic Apneic Event Detection Using Nocturnal Pulse Oximetry",
            "venue": "IEEE Trans. Biomed. Eng",
            "year": 2018
        },
        {
            "authors": [
                "A.M. Andr\u00e9s-Blanco",
                "D. Alvarez",
                "A. Crespo",
                "C.A. Arroyo",
                "A. Cerezo-Hern\u00e1ndez",
                "G. Guti\u00e9rrez-Tobal",
                "R. Hornero",
                "F. Del Campo"
            ],
            "title": "Assessment of automated analysis of portable oximetry as a screening test for moderate-to-severe sleep apnea in patients with chronic obstructive pulmonary disease",
            "venue": "PLoS ONE 2017,",
            "year": 2017
        },
        {
            "authors": [
                "N. Netzer",
                "A.H. Eliasson",
                "C. Netzer",
                "D.A. Kristo"
            ],
            "title": "Overnight Pulse Oximetry for Sleep-Disordered Breathing in Adults",
            "venue": "Chest",
            "year": 2001
        },
        {
            "authors": [
                "B. Raymond",
                "R.M. Cayton",
                "M.J. Chappell"
            ],
            "title": "Combined index of heart rate variability and oximetry in screening for the sleep apnoea/hypopnoea syndrome",
            "venue": "J. Sleep Res",
            "year": 2003
        },
        {
            "authors": [
                "C. Heneghan",
                "C.-P. Chua",
                "J.F. Garvey",
                "P. De Chazal",
                "R. Shouldice",
                "P. Boyle",
                "W.T. McNicholas"
            ],
            "title": "A Portable Automated Assessment Tool for Sleep Apnea Using a Combined Holter-Oximeter",
            "venue": "Sleep 2008,",
            "year": 2019
        },
        {
            "authors": [
                "P. De Chazal",
                "C. Heneghan",
                "W.T. McNicholas"
            ],
            "title": "Multimodal detection of sleep apnoea using electrocardiogram and oximetry",
            "venue": "signals. Philos. Trans. R. Soc. A: Math. Phys. Eng. Sci",
            "year": 2009
        },
        {
            "authors": [
                "C. Shi",
                "M. Nourani",
                "G. Gupta",
                "L. Tamil"
            ],
            "title": "A virtual sleep laboratory",
            "venue": "In Proceedings of the First ACM Workshop on Mobile Systems, Applications, and Services for Healthcare\u2014mHealthSys\u201911, Seattle, WA,",
            "year": 2011
        },
        {
            "authors": [
                "B. Xie",
                "H. Minn"
            ],
            "title": "Real-Time Sleep Apnea Detection by Classifier Combination",
            "venue": "IEEE Trans. Inf. Technol. Biomed",
            "year": 2012
        },
        {
            "authors": [
                "A.G. Ravelo-Garc\u00eda",
                "J.F. Kraemer",
                "J.L. Navarro-Mesa",
                "E. Hern\u00e1ndez-P\u00e9rez",
                "J. Navarro-Esteva",
                "G. Juli\u00e1-Serd\u00e1",
                "T. Penzel",
                "N. Wessel"
            ],
            "title": "Oxygen Saturation and RR Intervals Feature Selection for Sleep Apnea Detection",
            "venue": "Entropy",
            "year": 2015
        },
        {
            "authors": [
                "U.R. Acharya",
                "K.P. Joseph",
                "N. Kannathal",
                "C.M. Lim",
                "J.S. Suri"
            ],
            "title": "Heart rate variability: A review",
            "venue": "Med. Biol. Eng. Comput",
            "year": 2006
        },
        {
            "authors": [
                "H.M. Al-Angari",
                "A.V. Sahakian"
            ],
            "title": "Automated Recognition of Obstructive Sleep Apnea Syndrome Using Support Vector Machine Classifier",
            "venue": "IEEE Trans. Inf. Technol. Biomed",
            "year": 2012
        },
        {
            "authors": [
                "C. Zamarr\u00f3n",
                "F. Gude",
                "J. Barcala",
                "J.R. Rodriguez",
                "P.V. Romero"
            ],
            "title": "Utility of Oxygen Saturation and Heart Rate Spectral Analysis Obtained from Pulse Oximetric Recordings in the Diagnosis of Sleep Apnea Syndrome",
            "venue": "Chest",
            "year": 2003
        },
        {
            "authors": [
                "I. Ayappa",
                "B.S. Rapaport",
                "R.G. Norman",
                "D.M. Rapoport"
            ],
            "title": "Immediate consequences of respiratory events in sleep disordered breathing",
            "venue": "Sleep Med",
            "year": 2005
        },
        {
            "authors": [
                "G. Schlotthauer",
                "L.E. Di Persia",
                "L.D. Larrateguy",
                "D.H. Milone"
            ],
            "title": "Screening of obstructive sleep apnea with empirical mode decomposition of pulse oximetry",
            "venue": "Med. Eng. Phys",
            "year": 2014
        },
        {
            "authors": [
                "C. Zamarr\u00f3n",
                "V. Garc\u00eda Paz",
                "E. Morete",
                "F. del Campo-Mat\u00edas"
            ],
            "title": "Association of chronic obstructive pulmonary disease and obstructive sleep apnea consequences",
            "venue": "Int. J. Chron. Obstruct. Pulmon. Dis",
            "year": 2008
        },
        {
            "authors": [
                "G. Coccagna",
                "E. Lugaresi"
            ],
            "title": "Arterial Blood Gases and Pulmonary and Systemic Arterial Pressure During Sleep in Chronic Obstructive Pulmonary Disease",
            "venue": "Sleep 1978,",
            "year": 1978
        },
        {
            "authors": [
                "Y. Yamashiro",
                "M.H. Kryger"
            ],
            "title": "Nocturnal Oximetry: Is It a Screening Tool for Sleep Disorders",
            "venue": "Sleep",
            "year": 1995
        },
        {
            "authors": [
                "M.O. Mendez",
                "D.D. Ruini",
                "O.P. Villantieri",
                "M. Matteucci",
                "T. Penzel",
                "S. Cerutti",
                "A.M. Bianchi"
            ],
            "title": "Detection of Sleep Apnea from surface ECG based on features extracted by an Autoregressive Model",
            "venue": "In Proceedings of the 2007 29th Annual International Conference of the IEEE Engineering in Medicine and Biology Society,",
            "year": 2007
        },
        {
            "authors": [
                "M. Schrader",
                "C. Zywietz",
                "V. von Einem",
                "B. Widiger",
                "G. Joseph"
            ],
            "title": "Detection of sleep apnea in single channel ECGs from the PhysioNet data base",
            "venue": "In Proceedings of the Computers in Cardiology",
            "year": 2000
        },
        {
            "authors": [
                "H.M. Al-Angari",
                "A.V. Sahakian"
            ],
            "title": "Use of Sample Entropy Approach to Study Heart Rate Variability in Obstructive Sleep Apnea Syndrome",
            "venue": "IEEE Trans. Biomed. Eng",
            "year": 2007
        },
        {
            "authors": [
                "Y.-H. Shiau",
                "J.-H. Sie",
                "S.-P. Li"
            ],
            "title": "Detecting sleep apnea by volatility clustering of heart rate variability",
            "venue": "Int. J. Cardiol",
            "year": 2013
        },
        {
            "authors": [
                "C. Maier",
                "H. Dickhaus"
            ],
            "title": "Recurrence analysis of nocturnal heart rate in sleep apnea patients",
            "venue": "Biomed. Eng. Biomed. Tech",
            "year": 2006
        },
        {
            "authors": [
                "M.O. Mendez",
                "J. Corthout",
                "S. Van Huffel",
                "M. Matteucci",
                "T. Penzel",
                "S. Cerutti",
                "A.M. Bianchi"
            ],
            "title": "Automatic screening of obstructive sleep apnea from the ECG based on empirical mode decomposition and wavelet analysis",
            "venue": "Physiol. Meas",
            "year": 2010
        },
        {
            "authors": [
                "H. Sharma",
                "K. Sharma"
            ],
            "title": "An algorithm for sleep apnea detection from single-lead ECG using Hermite basis functions",
            "venue": "Comput. Biol. Med",
            "year": 2016
        },
        {
            "authors": [
                "C. Cheng",
                "C. Kan",
                "H. Yang"
            ],
            "title": "Heterogeneous recurrence analysis of heartbeat dynamics for the identification of sleep apnea",
            "venue": "events. Comput. Biol. Med",
            "year": 2016
        },
        {
            "authors": [
                "J.P. Zbilut",
                "P.A. Santucci",
                "S.-Y. Yang",
                "J.L. Podolski"
            ],
            "title": "Linear and Nonlinear Evaluation of Ventricular Arrhythmias",
            "year": 2002
        },
        {
            "authors": [
                "M.B. Tayel",
                "E.I. AlSaba"
            ],
            "title": "Review: Nonlinear Techniques for Analysis of Heart Rate Variability",
            "venue": "WSEAS Trans. Signal Process. 2017,",
            "year": 2017
        },
        {
            "authors": [
                "F. Del Campo",
                "R. Hornero",
                "C. Zamarr\u00f3n",
                "D. Abasolo",
                "D. \u00c1lvarez"
            ],
            "title": "Oxygen saturation regularity analysis in the diagnosis of obstructive sleep apnea",
            "venue": "Artif. Intell. Med",
            "year": 2006
        },
        {
            "authors": [
                "S.S. Mostafa",
                "F. Morgado-Dias",
                "A.G. Ravelo-Garc\u00eda"
            ],
            "title": "Comparison of SFS and mRMR for oximetry feature selection in obstructive sleep apnea detection",
            "venue": "Neural Comput. Appl",
            "year": 2020
        },
        {
            "authors": [
                "S.S. Mostafa",
                "D. Baptista",
                "A.G. Ravelo-Garc\u00eda",
                "G. Juli\u00e1-Serd\u00e1",
                "F. Morgado-Dias"
            ],
            "title": "Greedy based convolutional neural network optimization for detecting apnea",
            "venue": "Comput. Methods Programs Biomed",
            "year": 2020
        },
        {
            "authors": [
                "S.S. Mostafa",
                "F. Mendonca",
                "A.G. Ravelo-Garcia",
                "G.G. Juli\u00e1-Serd\u00e1",
                "F. Morgado-Dias"
            ],
            "title": "Multi-Objective Hyperparameter Optimization of Convolutional Neural Network for Obstructive Sleep Apnea Detection",
            "venue": "IEEE Access 2020,",
            "year": 2020
        },
        {
            "authors": [
                "S. Choi",
                "L. Bennett",
                "R. Mullins",
                "R. Davies",
                "J. Stradling"
            ],
            "title": "Which derivative from overnight oximetry best predicts symptomatic response to nasal continuous positive airway pressure in patients with obstructive sleep",
            "venue": "apnoea? Respir. Med",
            "year": 2000
        },
        {
            "authors": [
                "D. \u00c1lvarez",
                "R. Hornero",
                "J.V. Marcos",
                "F. del Campo"
            ],
            "title": "Multivariate Analysis of Blood Oxygen Saturation Recordings in Obstructive Sleep Apnea Diagnosis",
            "venue": "IEEE Trans. Biomed. Eng",
            "year": 2010
        },
        {
            "authors": [
                "S. LaFleur",
                "I. Mahgoub"
            ],
            "title": "A Personal Body Area Network as a Pre-Screening Surrogate to the Polysomnography",
            "venue": "In Proceedings of the 8th International Conference on Body Area Networks, Boston, MA, USA,",
            "year": 2013
        },
        {
            "authors": [
                "S. Mart\u00edn-Gonz\u00e1lez",
                "J.L. Navarro-Mesa",
                "G. Juli\u00e1-Serd\u00e1",
                "G.M. Ram\u00edrez-\u00c1vila",
                "A.G. Ravelo-Garc\u00eda"
            ],
            "title": "Improving the understanding of sleep apnea characterization using Recurrence Quantification Analysis by defining overall acceptable values for the dimensionality of the system, the delay, and the distance threshold",
            "venue": "PLoS ONE 2018,",
            "year": 2018
        },
        {
            "authors": [
                "A.G. Ravelo-Garc\u00eda",
                "J. Navarro-Mesa",
                "M. Murillo-Diaz",
                "J. Julia-Serda"
            ],
            "title": "Application of RR series and oximetry to a statistical classifier for the detection of sleep apnoea/hypopnoea",
            "venue": "In Proceedings of the Computers in Cardiology, Chicago, IL, USA,",
            "year": 2005
        },
        {
            "authors": [
                "T. Penzel",
                "G. Moody",
                "R. Mark",
                "A. Goldberger",
                "J. Peter"
            ],
            "title": "The apnea-ECG database",
            "venue": "In Proceedings of the Computers in Cardiology",
            "year": 2000
        },
        {
            "authors": [
                "M. Malik"
            ],
            "title": "Task Force of the European Society of Cardiology, and the North American Electrophysiology Society of Pacing and Electrophysiology. Guidelines heart rate variability",
            "venue": "Eur. Heart J",
            "year": 1996
        },
        {
            "authors": [
                "A.G. Ravelo-Garc\u00eda",
                "P. Saavedra-Santana",
                "G. Juli\u00e1-Serd\u00e1",
                "J.L. Navarro-Mesa",
                "J. Navarro-Esteva",
                "X. \u00c1lvarez-L\u00f3pez",
                "A. Gapelyuk",
                "T. Penzel",
                "N. Wessel"
            ],
            "title": "Symbolic dynamics marker of heart rate variability combined with clinical variables enhance obstructive sleep apnea screening",
            "venue": "Chaos Interdiscip. J. Nonlinear Sci",
            "year": 2014
        },
        {
            "authors": [
                "J. Pan",
                "W.J. Tompkins"
            ],
            "title": "A Real-Time QRS Detection Algorithm",
            "venue": "IEEE Trans. Biomed. Eng",
            "year": 1985
        },
        {
            "authors": [
                "N. Wessel",
                "A. Voss",
                "H. Malberg",
                "C. Ziehmann",
                "H.U. Voss",
                "A. Schirdewan",
                "U. Meyerfeldt",
                "J. Kurths"
            ],
            "title": "Nonlinear analysis of complex phenomena in cardiological data",
            "venue": "Herzschrittmachertherapie Elektrophysiologie",
            "year": 2000
        },
        {
            "authors": [
                "A.G. Ravelo-Garc\u00eda",
                "J.L. Navarro-Mesa",
                "S. Mart\u00edn-Gonz\u00e1lez",
                "E. Hern\u00e1ndez-P\u00e9rez",
                "P. Quintana-Morales",
                "I. Guerra-Moreno",
                "J. Navarro-Esteva",
                "G. Juli\u00e0-Serd\u00e0"
            ],
            "title": "Cepstrum Coefficients of the RR Series for the Detection of Obstructive Sleep Apnea Based on Different Classifiers",
            "year": 2013
        },
        {
            "authors": [
                "C.-K. Peng",
                "S. Havlin",
                "H.E. Stanley",
                "A.L. Goldberger"
            ],
            "title": "Quantification of Scaling Exponents and Crossover Phenomena in Nonstationary Heartbeat Time Series",
            "venue": "Chaos Interdiscip. J. Nonlinear Sci",
            "year": 1995
        },
        {
            "authors": [
                "P.-A. Absil",
                "R. Sepulchre",
                "A. Bilge",
                "P. G\u00e9rard"
            ],
            "title": "Nonlinear analysis of cardiac rhythm fluctuations using DFA method",
            "venue": "Phys. A Stat. Mech. Appl",
            "year": 1999
        },
        {
            "authors": [
                "E. Rodriguez",
                "J.C. Echeverria",
                "J. Alvarez-Ramirez"
            ],
            "title": "Detrended fluctuation analysis of heart intrabeat dynamics",
            "venue": "Phys. A Stat. Mech. Appl",
            "year": 2007
        },
        {
            "authors": [
                "J.-P. Eckmann",
                "S.O. Kamphorst",
                "D. Ruelle"
            ],
            "title": "Recurrence Plots of Dynamical Systems",
            "venue": "Europhysics Lett. 1987,",
            "year": 1987
        },
        {
            "authors": [
                "C. Webber",
                "J. Zbilut"
            ],
            "title": "Recurrence quantification analysis of nonlinear dynamical systems",
            "venue": "Tutorials Contemp. Nonlinear Methods Behav. Sci. 2005,",
            "year": 2005
        },
        {
            "authors": [
                "N. Marwan",
                "M.C. Romano",
                "M. Thiel",
                "J. Kurths"
            ],
            "title": "Recurrence plots for the analysis of complex systems",
            "venue": "Phys. Rep",
            "year": 2007
        },
        {
            "authors": [
                "F. Takens"
            ],
            "title": "Detecting Strange Attractors in Turbulence",
            "venue": "In Lecture Notes in Mathematics; Springer: Berlin/Heidelberg, Germany,",
            "year": 1981
        },
        {
            "authors": [
                "M. Shelhamer"
            ],
            "title": "Nonlinear Dynamics in Physiology\u2014A State-Space Approach",
            "venue": "World Scientific: Singapore,",
            "year": 2007
        },
        {
            "authors": [
                "M.B. Kennel",
                "R. Brown",
                "H.D.I. Abarbanel"
            ],
            "title": "Determining embedding dimension for phase-space reconstruction using a geometrical construction",
            "venue": "Phys. Rev. A",
            "year": 1992
        },
        {
            "authors": [
                "M. Mohebbi",
                "H. Ghassemian"
            ],
            "title": "Prediction of paroxysmal atrial fibrillation using recurrence plot-based features of the RR-interval signal",
            "venue": "Physiol. Meas",
            "year": 2011
        },
        {
            "authors": [
                "N. Marwan",
                "M. Thiel",
                "N.R. Nowaczyk"
            ],
            "title": "Cross recurrence plot based synchronization of time series",
            "venue": "Nonlinear Process. Geophys",
            "year": 2002
        },
        {
            "authors": [
                "J.B. Gao"
            ],
            "title": "Recurrence Time Statistics for Chaotic Systems and Their Applications",
            "venue": "Phys. Rev. Lett",
            "year": 1999
        },
        {
            "authors": [
                "N. Marwan",
                "J.F. Donges",
                "Y. Zou",
                "R.V. Donner",
                "J. Kurths"
            ],
            "title": "Complex network approach for recurrence analysis of time series",
            "venue": "Phys. Lett. A",
            "year": 2009
        }
    ],
    "sections": [
        {
            "text": "Citation: Mart\u00edn-Gonz\u00e1lez, S.;\nRavelo-Garc\u00eda, A.G.; Navarro-Mesa,\nJ.L.; Hern\u00e1ndez-P\u00e9rez, E. Combining\nHeart Rate Variability and Oximetry\nto Improve Apneic Event Screening\nin Non-Desaturating Patients. Sensors\n2023, 23, 4267. https://doi.org/\n10.3390/s23094267\nAcademic Editors: Hasan Ogul\nand Suzan Arslanturk\nReceived: 19 December 2022\nRevised: 17 April 2023\nAccepted: 18 April 2023\nPublished: 25 April 2023\nCopyright: \u00a9 2023 by the authors.\nLicensee MDPI, Basel, Switzerland.\nThis article is an open access article\ndistributed under the terms and\nconditions of the Creative Commons\nAttribution (CC BY) license (https://\ncreativecommons.org/licenses/by/\n4.0/).\nKeywords: apnea detection; cepstrum coefficients; detrended fluctuation analysis; heart rate variability; linear and nonlinear analysis; non-desaturating patients; oxygen saturation; recurrence quantification analysis"
        },
        {
            "heading": "1. Introduction",
            "text": "Sleep apnea is a widespread sleep respiratory disorder characterized by disrupted breathing during sleep. Sleep apnea events are classified according to the associated respiratory effort. Obstructive Sleep Apnea (OSA) occurs when the upper airway collapses and airflow is obstructed. However, when the upper airway is open and the respiratory drive is absent or inhibited, i.e., there is no respiratory effort, it is considered Central Sleep Apnea (CSA). Both types occur in Mixed Sleep Apnea (MSA). Although there are often CSA episodes in OSA patients, pure CSA is uncommon. OSA is the most common type of sleep apnea [1]. It is considered a public health problem because of its high prevalence, which is 4% among men and 2% among women [1], as well as its serious health implications, such as cardiovascular disorders, strokes, glucose metabolism abnormalities, sudden death, or depression, that lead to increased mortality rates [2]. However, other symptoms also severely affect quality of life, including daytime drowsiness, snoring, weight gain, irritability, or memory problems [3,4]. The severity of OSA is measured by the Apnea-Hypopnea Index (AHI), which represents the mean\nSensors 2023, 23, 4267. https://doi.org/10.3390/s23094267 https://www.mdpi.com/journal/sensors\nSensors 2023, 23, 4267 2 of 34\nnumber of breathing pauses per hour. Apnea in adults is scored when there is a drop in the peak signal excursion by \u226590% of the pre-event baseline using an oronasal thermal sensor (diagnostic study), PAP device flow (titration study), or an alternative apnea sensor, for \u226510 s. According to the definition, apneas may or may not be accompanied by desaturations, but they will always be labeled as apneas. Therefore, apneic events may be non-desaturating. Hypopnea in adults is scored when the peak signal excursions drop by \u226530% of the pre-event baseline, using nasal pressure (diagnostic study), PAP device flow (titration study), or an alternative sensor, for \u226510 s in association with either \u22653% arterial oxygen desaturation or an arousal [5]. Apneas and hypopneas have similar pathophysiology and, in general, similar impacts on patients [6]. AHI values lower than 5 are considered normal, and patients with AHIs over 5 are diagnosed with OSA and ranked according to the following ranges: (5, 15): mild sleep apnea; (15, 30): moderate sleep apnea; >30: severe sleep apnea."
        },
        {
            "heading": "1.1. Motivation and Problem Description",
            "text": "Due to the severity of OSA, early diagnosis of the disease is strongly recommended so that patients can receive appropriate and effective treatment. Polysomnography (PSG) is the gold standard diagnostic tool for OSA. It records different physiological signals throughout the night at the hospital, and it is supervised by qualified staff. The process is inconvenient for the patient, time consuming, and very expensive for the health care system. Therefore, efforts are geared towards developing alternative and simplified automatic, as well as portable, OSA detection techniques that are based on fewer physiological signals, thus reducing the time required for a final diagnosis. Several automatic OSA detection approaches have been reported in the literature [7]. Some carry out patient sound analysis [8\u201310], while others study airflow [11\u201313], abdominal and thoracic movement signals [14], and even voice analysis [15,16]. However, most include statistical pattern recognition based on characteristics extracted from single-lead electrocardiogram (ECG) signals [17\u201329] and blood oxygen saturation (SpO2) [30\u201355], which are measured by a pulse oximeter. In some cases, the single-lead ECG signal is combined with the SpO2 signal [56\u201361]. Standard Heart-Rate Variability (HRV) mirrors the autonomic neural regulation of the heart and the circulatory system, and thus, changes are a result of different physiological factors modulating the normal heart rate (HR) [62]. HRV studies are carried out using the time elapsed between two successive R waves obtained by measuring the delay between two consecutive R-peaks of the ECG. The RR series is the sequence of consecutive delays. There is a strong physiological relationship between HRV and OSA [5]. During normal sleep, parasympathetic and sympathetic control produce cyclic oscillations in the RR intervals due to breathing phases (cardio-acceleration during inhalation and cardiodeceleration during exhalation) called respiratory sinus arrhythmia (RSA) [5]. In general, HRV frequency components are found between 0 and 0.5 Hz, and the RSA component stands out at the breathing frequency, which is approximately 0.25 Hz. However, during an apneic episode, increased sympathetic control in the cardiovascular system modifies this cyclic oscillation pattern, and we find a brady-tachycardia pattern called \u2018cyclic variation of heart rate\u2019 (CVHR) [5]. As a result of apnea repetition, the CVHR frequency components appear in a frequency band ranging from 0.01 to 0.04 Hz [20]. However, it is worth noting that HRV is influenced not only by apnea but also by many additional factors, such as sleep stages, other diseases, or medication, which may mask the CVHR pattern [19]. The information contained in the SpO2 signal is also valuable for apnea detection purposes, as it directly tracks the variations that typically take place in sleep apnea patients during apneic events. Indeed, the American Academy of Sleep Medicine Task Force [5] includes oxygen saturation as one of the conditions that characterizes obstructive sleep apnea\u2013hypopnea events. Oximetry levels in healthy adults range between 96% and 99% and tend to remain constant, varying slightly with age and regardless of ethnicity, sex, or weight [32,55]. Repeated apneic events usually lead to recurrent hypoxias and hypercapnias. Therefore, a breathing disruption in sleep apnea usually results in an episode of hypoxemia\nSensors 2023, 23, 4267 3 of 34\nthat can be detected through a decrease in SpO2. This drop starts approximately 10 to 30 s after the apneic episode begins (slow desaturation) and normally starts to recover shortly after hypoventilation ends (fast resaturation) [5]. All this adds up to more irregular oximetry recordings in OSA patients with a typical saw-tooth morphology [49]. Moreover, an apneic episode lasts between 30 s and 2 min, including the arousal, and repeated apneic events lead to cyclical oxygen desaturations that take place with the same frequency. Thus, the signal power of the frequency band, ranging from 0.01\u20130.033 Hz, is usually higher in OSA patients [33] and is especially interesting for diagnostic purposes [40]. However, the SpO2 has an important drawback, as it has, in general, high specificity in sleep apnea, but the sensitivity is typically lower [56,63]. This is because breathing disruptions may not come accompanied by oxygen desaturations, especially if they are short [58,64,65]. Increased upper airway resistance may also lead to the absence of oxygen desaturations [66]. On the other hand, desaturations may also occur due to other pulmonary and cardiovascular diseases, such as chronic obstructive pulmonary disease (COPD) or alveolar hypoventilation [67,68]. Thus, patients who suffer from COPD and OSA simultaneously may experience more oxygen desaturations than those with only one of the two conditions [54]. Hence, features obtained from the SpO2 signal may not exactly mirror the apneic episodes, which could affect the performance of oximetry analysis [6]. Moreover, oximeters can also register poor quality SpO2 signals due to artifacts caused by motion or poor perfusion [58,69]. These can be considered the main handicap in exclusively using oximetry signals to detect apneas. Several authors have discussed this disadvantage in their works [34,42,58,64]. In Section 4.3, we provide a thorough analysis of several factors that can lead to non-desaturating apneas, which reinforce how important it is to avoid basing OSA diagnosis exclusively on the SpO2 signal."
        },
        {
            "heading": "1.2. Review of Relevant Literature",
            "text": "As OSA is considered to be a major health problem, several studies over the last 20 years have focused on addressing two main goals: automatic sleep apnea diagnosis (per-recording classification) and real-time detection of sleep apneic events (per-segment classification or quantification). In this section, we will focus on those studies in the literature that analyze extracting features from two of the most popular signals: the singlelead ECG and the oximetry signal. As far as the single-lead ECG is concerned, a wide variety of feature extraction techniques have been followed to detect the pathological patterns underlying sleep apnea. On the one hand, linear analysis has been put forward to detect information about the periodicities taking place in the RR series [19,70,71]. On the other hand, nonlinear methods have been introduced to reveal the complex autonomic and respiratory control mechanisms that interact in the regulation of the cardiac function [18,19,27,72\u201377]. The reason is that the cardiovascular system and, by extension, the HRV are considered dynamic, nonlinear, and nonstationary [78,79]. Table 1 shows some relevant studies related to apnea detection using the single lead ECG. Concerning the use of the SpO2 signal in apnea detection, several authors have also carried out works aiming to obtain further knowledge on oximetry dynamics associated with OSA, thus improving the diagnostic ability of overnight oxygen saturation monitoring. There are approaches that search for temporal OSA patterns [34,43,52,54], while others introduce spectral analysis to detect the peak commonly present in the 0.010 to 0.033 Hz frequency range during apnea [30,40,42,49,54]. More sophisticated techniques, such as nonlinear analysis, have also been proposed [34,41,47,80,81]. Recently, other techniques based on deep learning have also been presented [82,83]. The first studies that focused on sleep apnea detection by means of SpO2 used the conventional time-domain oximetry indices [36,84]. However, these methods are not suitable for real-time analysis, as they only identify OSA patients from whole overnight recordings. In the most recent works, conventional indices were included for comparison purposes with newer techniques [54]. Zamarr\u00f3n et al. [30] were the first authors who introduced spectral analysis. They concluded, as did most\nSensors 2023, 23, 4267 4 of 34\nauthors who applied this technique, that, in general, spectral analysis and, in particular, the frequency content of the apnea frequency band (0.010 to 0.033 Hz) are especially suited for apnea detection [31,35]. Beyond these temporal and spectral features, there are also studies which propose time-domain and frequency-domain statistics. \u00c1lvarez et al. [85] reached, using the variance, the best performance within the time-domain statistics in the single feature evaluation. They concluded that the conventional features from spectral analysis perform, in general, better than other approaches. However, frequency-domain statistics achieve lower performance. The nonlinear features proposed in the literature for sleep apnea detection using the SpO2 signal include Poincar\u00e9 parameters [50], approximate entropy (ApEn) [31\u201334,38,46,80], sample entropy (SamEn) [45], central tendency measure (CTM) [31\u201333,45\u201348], and Lempel\u2013Ziv complexity (LZC) [31\u201334,38,45].\nThere are two groups of studies in which the single-lead ECG signal is combined with the SpO2 signal [56\u201361]. In the first, research focuses on AHI estimation and, thus, on OSA diagnosis (per-recording classification) [56,86]. Raymond et al. [56] estimated the number of respiratory event-related arousals by counting the number of autonomic arousals (based on changes in the heart interbeat interval) that coincided with a rise in oximetry. They collected an hourly index that was defined as the cardiac-oximetry disturbance index (CODI) and assessed the correlation between the CODI and the AHI. LaFleur et al. [86] introduced an automated algorithm for detecting the presence of Long QT Syndrome (LQTS), which is associated with OSA. They also proposed a correlation classifier to correlate the ECG signal and the SpO2 data, resulting in an estimated AHI. In the second group, the studies carry out a real-time analysis aiming to detect apneic episodes on a minute-by-minute basis (per-segment classification) [57,58]. Heneghan et al. [57] put forward an algorithm that provided an estimation of apnea occurrences epoch-by-epoch and estimated an overall\nSensors 2023, 23, 4267 5 of 34\nper-recording AHI. De Chazal et al. [58] proposed an algorithm to identify epochs as normal or sleep-disordered breathing and to classify the pathological ones into one of six classes: obstructive, mixed, and central apnea, as well as obstructive, mixed, and central hypopnea. They derived an AHI estimation from this epoch-based classification approach using frequency and time domain features from the ECG signal, as well as time-domain oximetry features."
        },
        {
            "heading": "1.3. Objectives of This Study",
            "text": "In Section 1.1, we highlighted the limitations of using single-lead ECG and oximetry signals, individually, to detect sleep apnea. There are several articles devoted to the study of combining both signals for diagnostic purposes. However, to the best of our knowledge, until now there has been no work reporting improved performance when these signals are used alone vs. combined in patients who do not show marked oxygen desaturations during apneic events, hereafter referred to as non-desaturating patients. In the literature, authors only refer to non-desaturating patients within the limitations of the performed studies. In our analysis, we include a dataset that clearly distinguishes, among control, desaturating, and non-desaturating patients, the HuGCDN2014-OXI database, thus allowing a thorough quantitative analysis of our system under different circumstances. Moreover, we assess the performance of our system using the popular Apnea-ECG Physionet database. As for meaningful comparison with prior work, results obtained from the same database must be compared. Including both databases makes the results more generalizable, and thus, conclusions would not be limited by database variability. Thus far, there is no agreement about which features best describe the underlying process when apnea occurs. That is why there is still huge pressure for new studies to better understand the physiological mechanisms associated with sleep apnea that are mirrored in HRV and SpO2. If we only took into account the saturation information to detect respiratory events, we would find that, in some events, there is no desaturation, both in apneas and hypopneas. That is why we hypothesize that we can improve the detection of respiratory events using the information contained in the HRV and, thus, get closer to the AHI values. Therefore, and according to our previous research [22,61,87,88], we propose a feature combination that includes measures analyzed independently and that also had good results. We specifically measure the discriminant capacity of feature combinations from HRV and oximetry to assess its performance compared with that using oximetry-based features alone, especially in non-desaturating patients.\nSensors 2023, 23, x FOR PEER REVIEW 6 of 36\nSensors 2023, 23, 4267 6 of 34"
        },
        {
            "heading": "2. Materials and Methods",
            "text": ""
        },
        {
            "heading": "2.1. Databases",
            "text": "We used two databases to carry out the experiments: the Apnea-ECG Physionet database, hereinafter referred to as Physionet database, and the HuGCDN2014-OXI database.\n2.1.1. Physionet Database\nThe Physionet database, available free of charge from the Physionet website [89], was provided by Prof. Dr. Thomas Penzel for Computers in Cardiology Challenge 2000. Since then, it has been widely used for sleep apnea studies. The eight recordings include single-lead ECG (digitized at 100 Hz) and SpO2 signals (digitized at 8 Hz), as well as their corresponding scores, on a one-minute basis. Therefore, our real-time system is designed to give a minute-by-minute result. A physician, based on simultaneously recorded respiratory signals, performed the labeling process. The recordings lasted approximately 8 h. Of the eight recordings, five are sleep apnea patients with diverse AHI values, and three are control subjects. Demographic characteristics are summarized in Table 2. More details about the data are available in [89].\nIn each of the databases, we must define the learning set (L-set) used in the training process and the test set (T-set), for the assessment of the system. Concerning the Physionet database, we have used a crossvalidation strategy in the assessment process, as only 8 patients are available, which has allowed us to reach statistically valid classification results [38]. In each iteration, the system is trained with the L-set, made up of three OSA patients and two control subjects, and assessed with the remaining patients (T-set).\n2.1.2. HuGCDN2014-OXI Database\nThe HuGCDN2014-OXI database was provided by the Dr. Negr\u00edn University Hospital (Las Palmas de Gran Canaria, Spain) and contains recordings of 83 subjects, each containing the ECG signal, digitized at 200 Hz, and the SpO2 signal, digitized at 50 Hz. The sleep studies and the labeling process were carried out following the American Academia of Sleep Medicine (AASM) guidelines [5]. As in the Physionet database, a physician labeled every minute based on simultaneous polysomnography, marking it as apnea or nonapnea. There are three groups: (1) CONTROL: 38 healthy subjects with AHIs lower than 5 (range, 0\u20135); (2) DESATURATING PATIENTS: 34 OSA patients with AHIs higher than 25 (range, 30\u2013106.3) who show desaturations during apneic episodes; 3) NON-DESATURATING PATIENTS: 11 OSA patients with AHIs higher than 25 (range, 26.2\u201387.5) who do not always show desaturations during apneic episodes. Patients are defined as non-desaturating when their ODI is less than half their AHI. In our case, 75% of the non-desaturating patients present an ODI less than 7.35 and an apnea total of less than 98, i.e., for 75% of the non-desaturating patients, the percentage of desaturating apneic events is below 7.5%.\nSensors 2023, 23, 4267 7 of 34\nDemographic characteristics are summarized in Table 3. Figure 2 shows the RR and SpO2 signals of all types of subjects: control, desaturating, and non-desaturating. Hand labeled apnea events are depicted as red asterisks. As we can see, the behavior of the oximetry signal in desaturating and non-desaturating patients differs significantly.\nBMI: body mass index, AHI: apnea-hypopnea index, ODI: oxygen desaturation index.\nThe performance of the system for the HuGCDN2014-OXI database has been assessed using three testing sets of patients. Before designing these sets, we have defined the L-set, which is composed of half of the control and half of the desaturating patients. The test sets are: (1) T1-set\u2014half of the desaturating patients, none of whom is included in the L-set; (2) T2-set\u2014all non-desaturating patients; (3) T3-set\u2014composed of three subsets: half of the control patients excluded in the L-set, patients in T1-set, and patients in T2-set. Sensors 2023, 23, x FOR PEER REVIEW 8 of 36\nFigure 2. RR and SpO2 signals of a control subject (A,D), a desaturating patient (B,E), and a nondesaturating patient (C,F). Within the hand labeling, the red asterisks at the top represent apnea minutes, and the red asterisks at the bo om represent nonapnea minutes. The behavior of the oximetry signal in desaturating and non-desaturating patients differs significantly.\n2.2. Signals Preprocessing\nThe ECG signal is divided into five-minute segments that are shifted, in time, in increments of 1 min [19,21,23,26,28,90,91]. This frame length suits our analysis because CVHR oscillations vary between 20 and 60 s, and CVHR recurrence is only recognizable if there are several oscillations in the frame [90]. There is also a good balance between stationarity and good spectral resolution. The quantification obtained for each frame is assigned to the central minute, thus achieving the scoring on a one-minute basis.\nFor each five-minute segment, the RR series is constructed as the sequence of delays between consecutive R-peaks of the ECG. The R-peak detection is inspired by the Pan\u2013 Tompkins algorithm [92]. After the creation of the RR series and before obtaining the corresponding features, it is necessary to apply a procedure that automatically removes artifacts and ectopic values. We used the method proposed by Wessel et al. for this purpose [93]. The main advantage of this algorithm is that the adaptive filtering procedure spontaneously adapts the filter coefficients to sudden changes in the RR series.\nAs far as the SpO2 signal is concerned, artifacts detected are mainly related to signal interruptions due to poor contact between the finger and the sensor or due to a patient\u2019s movements, which appear as zero levels in the oxygen saturation. An automated algorithm eliminates the zero values to remove them from the signal. Moreover, in the same process, oxygen saturations below 50% are also considered artifacts, and they are removed from analysis [38,42,60]. Finally, the mean is subtracted from the SpO2 signal [49,50]. The average number of segments over each of the signals for each subject is 407 in HuGCDN2014-OXI (from 302 to 474) and 495 in Physionet (from 455 to 529).\n2.3. Feature Extraction\n2.3.1. Oximetry Features\nFor the oximetry analysis, we extract both time-domain and frequency-domain features, which provide complementary information about sleep apnea episodes.\n(a) Time-domain features:\nFigure 2. RR and SpO2 signals of a control subject (A,D), a desaturating patient (B,E), nd a nondesaturating patient (C,F). Within the hand labeling, the red asterisks at the top represent a n a minutes, and the red asterisks at the bottom represent nonapnea minutes. The behavior of the oximetry signal in desaturating and non-desaturating patients differs significantly."
        },
        {
            "heading": "2.2. Signals Preprocessing",
            "text": "The ECG signal is divided into five-minute segments that are shifted, in time, in increments of 1 min [19,21,23,26,28,90,91]. This frame length suits our analysis because CVHR oscillations vary between 20 and 60 s, and CVHR recurrence is only recognizable if there are several oscillations in the frame [90]. There is also a good balance between\nSensors 2023, 23, 4267 8 of 34\nstationarity and good spectral resolution. The quantification obtained for each frame is assigned to the central minute, thus achieving the scoring on a one-minute basis. For each five-minute segment, the RR series is constructed as the sequence of delays between consecutive R-peaks of the ECG. The R-peak detection is inspired by the Pan\u2013 Tompkins algorithm [92]. After the creation of the RR series and before obtaining the corresponding features, it is necessary to apply a procedure that automatically removes artifacts and ectopic values. We used the method proposed by Wessel et al. for this purpose [93]. The main advantage of this algorithm is that the adaptive filtering procedure spontaneously adapts the filter coefficients to sudden changes in the RR series. As far as the SpO2 signal is concerned, artifacts detected are mainly related to signal interruptions due to poor contact between the finger and the sensor or due to a patient\u2019s movements, which appear as zero levels in the oxygen saturation. An automated algorithm eliminates the zero values to remove them from the signal. Moreover, in the same process, oxygen saturations below 50% are also considered artifacts, and they are removed from analysis [38,42,60]. Finally, the mean is subtracted from the SpO2 signal [49,50]. The average number of segments over each of the signals for each subject is 407 in HuGCDN2014-OXI (from 302 to 474) and 495 in Physionet (from 455 to 529).\n2.3. Feature Extraction 2.3.1. Oximetry Features\nFor the oximetry analysis, we extract both time-domain and frequency-domain features, which provide complementary information about sleep apnea episodes.\n(a) Time-domain features:\nOximetry is, under normal circumstances, a very stable signal. However, sleep apnea events are commonly related to hypoxemias and, thus, to drops in the SpO2 values. These changes are mirrored in the signal\u2019s variance, which can be taken as a valuable measure to uncover breathing disruptions. To decide the frame length to consider in the variance analysis, it is important to take into account that a breathing pause is at least 10 s long and can last over 50 s [5]. Therefore, 1 min segments are suitable for our study, as they detect short and long apneic events. However, OSA patients may also have consecutive apneic episodes. To consider this possibility, we include the 5 min variance in the analysis. Thus, both variances are defined as varSAT1m and varSAT5m [61]. In the latter case, as in the ECG signal, we consider 5 min segments, shifted in time in increments of one minute, and the variance is assigned to the central minute.\n(b) Frequency domain features:\nAs the signal power in the frequency band, ranging from 0.01 to 0.033 Hz, is usually higher in OSA patients [33], spectral features are especially interesting for diagnostic purposes. In our study, we obtain the power spectrum of the SpO2 signal by means of the periodogram based on the Discrete Fourier Transform (DFT), according to Equation (1),\nS(k) = 1 N |XN(k)|2 (1)\nwhere XN(k) is the DFT of the analyzed signal, and N represents the number of samples. The samples of periodogram, S(k), are obtained for each 5 min oximetry segment, with 1 min of displacement between adjacent frames. To evaluate the information contributed by each frequency band, we introduce a filter bank (Fbank-FbSAT) implemented directly in the transformed domain [61]. We call M the number of filters in the filter bank, and we have as many parameters as filters in the bank. The outcomes are an estimation of the normalized power in each frequency band. As in the 5 min variance, we assign these parameters to the central minute of the 5 min segment. According to previous research [61], M = 20 is considered a suitable value for the number of filters for the oximetry signal. In short, 22 features will represent every minute of the SpO2 signal.\nSensors 2023, 23, 4267 9 of 34\n2.3.2. HRV Features\nFor each frame, we carry out frequency domain (Fbank-FbHRV) [18,22], cepstral domain (cepstrum coefficients-CC) [18,22,94], and nonlinear analysis. The latter includes DFA [18,22] and RQA [87]. The feature vector representing each frame contains the combination of all the previous measures.\n(a) Frequency domain features:\nAs in the oximetry signal, the frequency band of interest to detect the CVHR components, due to apnea repetition, ranges from 0.01 to 0.04 Hz [20]. The procedure that followed to extract spectral information is the same as in the SpO2 signal (explained in Section 2.3.1 (b)). The only difference is that, according to the results in previous research [18,22], the number of filters in the filter bank is set to M = 34, as this value gives the frequency content analysis enough resolution, especially the CVHR and RSA components.\n(b) Cepstral domain features:\nCepstral Analysis also detects periodic structures in signals, which appear as peaks in the cepstral representation. The cepstrum coefficients (c(\u03c4)) are found by taking the inverse Fourier transform (F\u22121) of the logarithm of the magnitude of the RR spectrum (F(x(n))), according to Equation (2). In the experiments, we introduce the real cepstrum, which uses the spectrum\u2019s magnitude only, thus obtaining information about the spectrum envelope, as well as the harmonic components.\nc(\u03c4) = real ( F\u22121(log(|F(x(n))|)) )\n(2)\nFrom the cepstral coefficients, we take the first 20 elements that we found in previous work to contain relevant information of the underlying system [18,22].\n(c) Detrended Fluctuation Analysis (DFA):\nIt is well known that RR series normally fluctuate in a complex, apparently erratic manner [95]. A question we have faced is whether this heterogeneous structure arises from the intrinsic dynamics of the heart rate or if fluctuations arise from a complex, nonlinear, and dynamic behavior. This question has attracted our attention and is the reason we applied it. In previous works [18,22], we have found that the heartbeat time series is often highly non-stationary, and we have seen that the physiological process associated with OSA can be characterized. In this context, DFA, which was first introduced by Peng et al. in 1995 [96], is a good option to characterize the physiological process associated with OSA and to detect apneic events. RR series may possess long-memory structure, so DFA is well-suited as a scaling analysis method. There are two main properties that make DFA especially valuable for detecting apneic episodes [18,19,22]: (1) it can be applied to stationary and nonstationary signals, and (2) it avoids spurious detection of long-range correlations in RR interval series that are artifacts of nonstationarity [19].\nThe DFA parameters are approximated by power-law (3) [18,19,22,95\u201398]:\nF(t) \u223c t\u03b1 (3)\nwhere \u03b1 is called the scaling exponent. The scaling exponent is also the slope of the line relating log F(t) to log t. For uncorrelated data, \u03b1 = 0.5. We have paid attention to the analysis of short-range and long-range correlations in the RR series, which help discriminate apneic and nonapneic minutes. We introduce two different scaling exponents. These are \u03b11 (short-range correlations, for time scales t between 10 and 40 beats) and \u03b12 (long-range correlations, for time scales t between 70 and 194). The limits for the time scales are based on previous work [18,19,22].\n(d) Recurrence Quantification Analysis (RQA):\nSensors 2023, 23, 4267 10 of 34\nA recurrence plot (RP), first proposed by Eckmann et al. [99], is a two-dimensional plot that represents a binary symmetric square recurrence matrix. An RP is useful to visualize the recurrence characteristics of systems. This matrix shows the times when two states can be considered neighbors in the phase space, according to a certain threshold [100]. It is considered especially useful to uncover hidden periodicities and characteristics that, otherwise, would remain unnoticed [101]. The first step prior to constructing the RP of a time series, u(t), is embedding. The most widely used strategy to carry out this process is the Takens time delay method [102]. This procedure aims to reconstruct a multivariate phase space that represents the original system from a single measured variable of that system [100]. It, therefore, generates time-delayed copies of the variable under study, so the original time series is considered a dimension of the underlying system, and each of its delayed copies becomes a new dimension of the system. A phase state, \u2192 x i, is defined as follows Equation (4):\n\u2192 x i = [u(i), u(i + \u03c4), . . . , u(i + (m\u2212 1)\u00b7\u03c4)] (4)\nwhere \u03c4 is the time delay and m is the embedding dimension. The delay is chosen to achieve variable independence, while avoiding state vectors that are autocorrelated [103]. The dimension represents the number of independent variables influencing the system under study. The delay is commonly chosen by calculating the first local minimum or the first zero crossing of the autocorrelation or mutual information [100]. For the dimension, the false nearest neighbors (FNN) method is the most widely used. A neighbor is considered a false neighbor when it is defined as a neighbor only because the dimension of the state space is too small. The dimension is increased in integer steps until the number of false nearest neighbors drops to zero [104]. In our experiments, and according to previous work [87], we concluded that working with dimensions of approximately 7\u20138 and delays of approximately 4\u20135 yield the best results in two different datasets, supporting the idea that reached results are potentially generalizable. In this work, the values for dimension and delay are m = 7 and \u03c4 = 4 for the Physionet database and m = 8 and \u03c4 = 5 for the HuGCDN2014-OXI database, which were considered optimal for the same databases in previous work [87].\nAfter embedding, the RP is constructed according to the following equation:\nRi,j = \u0398(\u03b5i \u2212 \u2225\u2225\u2225\u2192x i \u2212\u2192x j\u2225\u2225\u2225), i, j = 1, 2, . . . , N (5)\nwhere N is the number of reconstructed points \u2192 x i, \u03b5 is the threshold distance, \u0398 is the Heaviside function (\u0398(x) = 0 if x < 0 and \u0398(x) = 1, otherwise), and ||\u00b7|| is the norm [101]. First, we construct a distance matrix (DM), and afterwards, we apply a cutoff distance to find the recurrence matrix (RM). This process results in an N \u00d7 N symmetric matrix, containing Ri,j = 1, if \u2192 x i and \u2192 x j are neighbors, according to the \u03b5-threshold, and Ri,j = 0, if not. The RP is the graphical representation of the RM. For stochastic or chaotic signals, RPs are formed by isolated points with no, or very short, diagonal structures, whereas periodic and deterministic signals show longer diagonals with less single recurrence points [105]. Apart from the embedding parameters, delay, and dimension, the other crucial parameter is the distance threshold in the RP is \u03b5. There are two approaches to define it. We can either choose a fixed value so that \u03b5i = \u03b5, called the Fixed Distance Method, or we define this parameter so that each point of the trajectory is surrounded by a constant number of neighboring states, i.e., \u03b5i changes for each state, called Fixed Amount of Nearest Neighbors (FAN) Method. The latter case results in a constant density of recurrence points in each column [106]. Although, in general, the Fixed Distance Method is used more often than the FAN Method, we introduce the FAN Method with 5% of neighbors, according to previous results [87], this approach greatly improves the system performance using the Fixed Distance Method.\nSensors 2023, 23, 4267 11 of 34\nAfter constructing the RP, we obtain the RQA measures. RQA is the quantitative analysis of RP structures that allows us to obtain information about the system dynamics. There are features based on the recurrence density, as well as on the diagonal, vertical, and horizontal line structures that appear in the RP [101]. Moreover, another group of features can be derived from RPs, which are related to recurrence times [107]. Finally, we also include new measures originating in the complex network theory, such as clustering coefficient or transitivity [108], which, when applied to recurrence matrices, are more powerful and reliable for detecting periodic dynamics [109,110]. In our analysis, we found 17 features for each RR 5 min frame. Table 4 shows the RQA features included in the feature set. In our experiments, we used the Cross Recurrence Plot Toolbox (CRP Toolbox) [111]. In summary, 73 features will represent every 5 min RR frame (spectral analysis: 34, DFA: 2, cepstrum: 20, and RQA: 17)."
        },
        {
            "heading": "2.4. Feature Selection",
            "text": "After preprocessing and obtaining the features of both signals, HRV and SpO2, we carry out a feature selection process. This procedure helps us find a reduced feature set, made up of those variables that differentiate the two classes best, i.e., apneic and nonapneic minutes. Furthermore, this technique has other advantages: (1) it prevents overfitting by ruling out redundant and irrelevant features, (2) it reduces computational load, and (3) the selection facilitates the physiological interpretation of the results. In our analysis, we use a repeated random sub-sampling validation that leads to dimensionality reduction and increased accuracy [22,61,87,94,112]. This method evaluates the performance of a feature group, taking into account their interactions, unlike other feature selection techniques proposed in the literature, which only assess individual features [17,29,113]. We carry out the feature selection algorithm for the three different feature combinations: all HRV variables (73), all SpO2 variables (22), and the whole set of HRV and SpO2 variables (95).\nIn the procedure, we only use the learning set (L-set), as defined for each of the databases in Section 2.1. The graphical representation of the feature selection process is shown in Figures 3 and 4 for both databases. In the HuGCDN2014-OXI database, the L-set is divided into two equally sized groups that form a training set and a validation set, each containing the feature vectors of the randomly selected patients in each iteration. Thus, we avoid feature vectors from one patient being in both the training set and the validation set simultaneously. For this dataset, the number of iterations is set to 200, as this value provides stable results. In the Physionet database, as the training set is always made up of three OSA\nSensors 2023, 23, 4267 12 of 34\npatients and two control subjects, and the validation set is the rest of the 8 subjects, the total number of possible combinations is 30. That is why there are 30 iterations in this database.\nSensors 2023, 23, x FOR PEER REVIEW 13 of 36\nFigure 3. Graphical representation of the feature selection process in the Physionet database. In the procedure, we only use the learning set (L-set) defined for Physionet.\nFigure 4. Graphical representation of the feature selection process in the HuGCDN2014-OXI database. In the procedure, we only use the learning set (L-set) defined for HuGCDN2014-OXI.\nThe whole process is divided into two steps. First, we create the feature ranking according to the number of times a certain feature is selected by the sequential forward feature selection method (based on the classifier performance). In each iteration, the optimal feature set corresponds to the maximum accuracy in the validation set. Second, repeating a random sub-sampling validation process again, we obtain the error rate for an increasing number of features. They are entered in the same order as they appear in the ranking created in step one. This procedure assesses the averaged misclassification error, obtained for the validation data, while increasing the number of features. The final selected features will be those with the minimum averaged misclassification error. In all cases, the number of features selected is smaller than the original number of features.\n2.5. Classifiers\nThe detection of apneic episodes is carried out on a minute by minute basis, thus allowing real-time analysis. The proposed classifier is LDA, widely used for apnea detection and with good results [24,31,33,61]. Moreover, LDA also balances performance, complexity and interpretation, unlike other pa ern recognition techniques that require se ing\nFigure 3. Graphical representation of the feature selection process in the Physionet database. In the procedure, we only use the learning set (L-set) defined for Physionet.\nSensors 2023, 23, x FOR PEER REVIEW 13 of 36\nFigure 3. Graphical repres nt tio of the feature selection process in the Physionet database. In the procedure, we only use the learning set (L-set) defined for Physionet.\nFigure 4. Graphical presentation of th feature selection process in the HuGCDN2014-OXI database. In the procedure, we only use the learning set (L-set) defined for HuGCDN2014-OXI.\nThe w ole proc ss is divided into two steps. First, we create the f ature ranking according to the number of times a c rtain featur is selected by the sequential forward fe - ture s lection method (based on the classifier performance). In each iteration, the optimal feature set corresponds to the maximum accuracy in the validation set. Second, rep ti a random sub-sampling validation process again, we obtain the error rate for an increasi number of featur s. They ar entered in the s me order as they appear in the ranking created in step one. This procedure assesses the averaged misclassification error, obtained for th validation data, while increasin the number of features. The final selected featur s will be those with the minimum averaged misclassification error. In all cases, the number of features selected is smaller than the original number of features.\n2.5. Classifiers\nThe detection of apneic episodes is carried out on a minute by minute basis, thus allowing real-time analysis. The proposed classifier is LDA, widely used for apnea detection and with good results [24,31,33,61]. Moreov r, LDA also balanc performance, complexity and interpretation, unlike other pa ern recognition techniques that require se ing\nFigure 4. Graphical representation of the feature selection process in the HuGCDN2014-OXI database. In the procedure, we only use the learning set (L-set) defined for HuGCDN2014-OXI.\nThe whole process is divided into two steps. First, we create the feature ranking according to the number of times a certain feature is selected by the sequential forward feature selection method (based on the classifier performance). In each iteration, the optimal feature set corresponds to the maximum accuracy in the validation set. Second, repeating a random sub-sampling validation process again, we obtain the error rate for an increasing number of features. hey are entered in the same or er as they appear in the ranking created in step one. This procedur assesses the averag d misclassi c tion error, obtained for the validation data, while increasin the number of featu es. The fin l selected features will b those with the minimum veraged misclassification error. In all cases, the number of features selected is smaller than the original number of features."
        },
        {
            "heading": "2.5. Classifiers",
            "text": "The etection of apneic episodes is carried out on a m nute by minute basis, thus allowing real- ime analysis. The pr posed classifi is LDA, widely sed for apnea detection\nSensors 2023, 23, 4267 13 of 34\nand with good results [24,31,33,61]. Moreover, LDA also balances performance, complexity and interpretation, unlike other pattern recognition techniques that require setting different model parameters by the user, leading to a more complex training process [31]. We balanced the classes using an under-sampling strategy [114]."
        },
        {
            "heading": "3. Results",
            "text": "The main objective of the data analysis presented below is to evaluate the benefits found, both for the minute-by-minute classification of apneic events and for the overall classification of patients. In both cases, we focus, especially, on what happens when the subjects affected by OSA do not present clear desaturation patterns (non-desaturating patients). Likewise, we analyze the selected characteristics when using HRV variables, SpO2 variables, and when both types are combined. This procedure evaluates the relative importance of each one in the detection of apneas and, indirectly, in the characterization of the physiological system associated with this phenomenon. The measures considered for the system evaluation include classification rate, sensitivity, specificity, and AUC (Area Under Curve), where curve refers to ROC (Receiver Operating Characteristic). Within these parameters, sensitivity is considered especially relevant in the medical setting [32]. Sensitivity reflects the ability to correctly detect apneic minutes, within quantification, and OSA patients in per-recording classification. However, specificity shows the ability of the system to distinguish normal minutes and healthy patients, respectively. There is usually a compromise between both values, namely sensitivity and specificity. However, for the diagnosis of OSA or the detection of apneic episodes in general, we are more interested in a high sensitivity that reduces the risk of false negatives, as the impact of incorrect classification on a patient diagnosed with OSA will be greater than if the classification is incorrect in healthy patients [49,60]. This is especially important in this type of pathology, given the serious long-term health consequences. On the other hand, the AUC values will allow us to evaluate the system\u2019s performance, regardless of the working point (threshold) selected on the ROC curve."
        },
        {
            "heading": "3.1. Per-Segment Classification and Characteristic Selection",
            "text": "As pointed out in the previous sections, the considered HRV characteristics include those gathered through spectral analysis (FbHRV), cepstral analysis (CC), and nonlinear analysis (two DFA variables and 17 RQA variables). On the other hand, oximetric characteristics include variables corresponding to spectral analysis (FbSAT) and two variables related to temporal signal analysis (varSAT1m and varSAT5m). The features, selected according to the procedure shown in Section 2.4, are the input of a LDA classifier. In both databases, the results correspond to the point on the ROC curve with the shortest distance to the upper left vertex. Table 5 contains the test results obtained with the Physionet database using crossvalidation. Tables 6\u20138, corresponding to the HuGCDN2014-OXI database, distinguish between three cases: test results of desaturating patients (T1 test set) are shown in Table 6, results of non-desaturating patients (T2 test set) are in Table 7, and results of the whole set of control subjects, desaturating, and non-desaturating patients (T3 test set) are in Table 8. Each of the Tables 5\u20138 shows results attained by introducing only HRV characteristics, only oximetric characteristics, and by combining them.\nHRV + SpO2 95 12 96.19 95.74 95.25 0.990 1 (N(OR.): original number of features, N(RED.): number of selected features, ACC: classification rate (accuracy), SENS: sensitivity, SPEC: specificity, AUC: area under the ROC curve).\nSensors 2023, 23, 4267 14 of 34\nHRV + SpO2 95 24 82.689 97.967 66.396 0.930 1 (N(OR.): original number of features, N(RED.): number of selected features, ACC: classification rate (accuracy), SENS: sensitivity, SPEC: specificity, AUC: area under the ROC curve).\nHRV + SpO2 95 24 77.816 59.786 87.217 0.847 1 (N(OR.): original number of features, N(RED.): number of selected features, ACC: classification rate (accuracy), SENS: sensitivity, SPEC: specificity, AUC: area under the ROC curve).\nHRV + SpO2 95 24 87.323 83.812 88.549 0.934 1 (N(OR.): original number of features, N(RED.): number of selected features, ACC: classification rate (accuracy), SENS: sensitivity, SPEC: specificity, AUC: area under the ROC curve).\nThe first database, Physionet, does not distinguish between desaturating and nondesaturating patients. However, as it is one of the most widely used databases for sleep apnea studies, the results obtained will allow us to compare the performance of the proposed system with other existing systems in the literature. In general, we can conclude from Table 5 that the system performs very well with this database. As far as the AUC values are concerned, in all cases, they are higher than 0.98. Namely, results indicate that only six oximetric characteristics provide slightly better performance than the seven HRV characteristics. When we combine the two types of characteristics, there is another increase in the AUC, but it is at the cost of increasing the number of variables to 12. The classification rate and sensitivity behave similarly to the AUC. However, in this case, the increase when applying the oximetric characteristics, both in the classification rate and in the sensitivity, is approximately 3%, compared to those reached by the HRV characteristics. Moreover, the improvement obtained by combining both types of variables does not, in any case, exceed 1% compared to the values shown for SpO2 characteristics. The previous analysis indicates that combining electrocardiographic and oximetric characteristics yields the best results with 12 variables. However, the improvement is so small that, in this case, the introduction of the two signals would not be justified. Therefore, for this database, we would propose the use of six oximetric features. However, these results cannot be considered conclusive given the limited number of patients under study.\nSensors 2023, 23, 4267 15 of 34\nNonetheless, studying Tables 6\u20138, belonging to the HuGCDN2014-OXI database, we can explore the real purpose of this analysis, as it distinguishes between desaturating and non-desaturating patients. The first two tables (Tables 6 and 7) contain the results for each type of patient (desaturating and non-desaturating). Finally, Table 8 shows the results representing a real system, in which the tested subjects can be healthy or diagnosed with OSA (desaturating and non-desaturating). Table 6, corresponding to desaturating patients, shows that the classification rates are lower when only HRV features are used. When we consider oximetric variables or combine both types, the results are very similar, reaching values that are approximately 10% higher than those reached only with HRV. The sensitivity results are high (>82%). As with the classification rates, the oximetric variables, or the combination of oximetric and HRV variables, provide the best results for sensitivity (higher than 97%). Finally, AUC shows a similar behavior. There is an approximate 10% increase when using SpO2 features instead of HRV variables. When both types are combined, the value reached is practically the same as the values gained with only SpO2. Therefore, in this case, oximetric features are the most appropriate because, similar to the HRV + SpO2 combination, it uses 24 characteristics instead of 15 (SpO2). Table 7 shows the results obtained for non-desaturating patients. According to classification rates and AUCs, we can conclude that the values are lower than those reached in desaturating patients (Table 6). This indicates that the detection of apneic events is more difficult in non-desaturating patients than in desaturating ones. Moreover, there is a progressive increase in the results, between 2 and 5%, when using HRV features, SpO2 features, and a combination of both types. This behavior also differs from that observed in Table 6. However, the most noteworthy aspect is related to sensitivity. HRV features provide the best values (72%). These results contrast with those obtained for desaturating patients, where HRV features yielded the lowest sensitivities and classification rates. However, when we include SpO2 variables in non-desaturating patients, sensitivity drops considerably, as expected. Nevertheless, the most relevant result is related to the increase in sensitivity, from 51.24% to 59.79%, when using HRV + SpO2 features instead of SpO2 features alone. As stated above, Table 8\u2032s results represent a real system tested with healthy subjects and OSA diagnosed patients (desaturating and non-desaturating). For the main parameters (classification rate, sensitivity, and AUC), using only the HRV features yields the worst results, which improve using only SpO2 variables, but we obtain the best results by combining both feature types. For the feature selection process, Figure 5 shows the evolution of the averaged error rate to the number of selected features for both training and validation (see Section 2.4). The horizontal dotted line represents the misclassification error obtained without feature selection, and a circle indicates the point with the minimum validation error rate. What is particularly interesting is that there are cases with a clear minimum, as in Physionet with SpO2 features, and other cases in which, for a given range of features, the error rates are very similar, as in Physionet when HRV and SpO2 features are combined. In the latter cases, we could, therefore, reduce the number of features indicated in the third column of Tables 5\u20138, since with a smaller number of variables, results would be very similar. The column headers of Table 9 (Physionet) and Table 10 (HuGCDN2014-OXI) show the number of features for each case. We only see one value if there is a clear minimum. However, if we can reduce the number of variables, we indicate it with an arrow and the reduced number. In the latter cases, thicker lines delimit these variables in their respective columns. Tables 9 and 10 also show the selected features after the feature selection process for both databases. The order in which they appear is in agreement with the feature ranking created according to the number of times a certain feature is selected by the sequential forward feature selection method. The three columns contain the chosen variables when HRV, SpO2, or HRV + SpO2 features are used. Regarding HRV, the algorithm proposes the combination of variables containing spectral, cepstral, and non-linear information (both\nSensors 2023, 23, 4267 16 of 34\nDFA and RQA). Although the number of selected features in both databases is different, some are always in the final set, namely the first and fourth cepstrum coefficients, the \u03b11 variable (DFA), representative of short-term correlations, and T2 and Trans (RQA). However, for spectral information, while both low frequency information, represented by FbHRV 1 and 2, and higher frequencies (FbHRV 11 and 15) are considered relevant in the HuGCDN2014-OXI database, only one variable referring to higher frequencies (FbHRV 21) is included in Physionet. That is why we understand that all the information contained in these characteristics, especially the cepstral and non-linear information (DFA and RQA), plays an important role in the classification process and, therefore, in the characterization of the physiological system underlying sleep apnea.\nSensors 2023, 23, x FOR PEER REVIEW 17 of 36\nHRV, SpO2, or HRV + SpO2 features are used. Regarding HRV, the algorithm proposes the combination of variables containing spectral, cepstral, and non-linear information (both DFA and RQA). l t e number of selected features in both databases is d fferent, some are always in th , ely the first and fourth cepstrum coefficients, the \u03b11 variable (DFA), repres f short-term correlations, and T2 and Trans (RQA).\nHowever, for spectral information, while both low frequency information, repr - sented by FbHRV 1 and 2, and higher frequencies (FbHRV 11 and 15) are consi er d relevant in the HuGCDN2014-OXI database, only one variable referring to higher frequencies (FbHRV 21) is included in Physionet. That is why we understand that all the information contained in these characteristics, especially the cepstral and non-linear information (DFA and RQA), plays an important role in the classification process and, therefore, in the characterization of the physiological system underlying sleep apnea.\nUsing the SpO2 features yields similar results in both databases. However, as we saw previously, the number of characteristics selected in the HuGCDN2014-OXI database is greater than in Physionet. The selected variables always include signal variances (varSAT1m and varSAT5m) and spectral information: in particular, the very low frequencies (FbSAT 1 in Physionet, and FbSAT 1 and 2 in HuGCDN2014-OXI), two intermediate bands (1st band: FbSAT 4 in Physionet, and FbSAT 5 in HuGCDN2014-OXI; 2nd band: FbSAT 12 in Physionet, and FbSAT 9 and 10 in HuGCDN2014-OXI), and a band of higher frequencies represented by FbSAT 17 in Physionet, as well as FbSAT 17 and 20 in HuGCDN2014OXI. Thus, information related to low frequency oscillations, linked to consecutive apneic episodes, as well as some high frequency components related to short sleep breathing pauses, seem to be relevant.\nFinally, we analyze the feature set obtained when we merge HRV and SpO2 variables. The selection of variables that refer to variance (varSAT1m and varSAT5m) in the first positions is especially noteworthy. Moreover, this selection includes features related to the spectral content of the oximetric signal, located in the bands referred to previously.\nUsing the SpO2 features yields similar results in both databases. However, as we saw previously, the number of characteristics selected in the HuGCDN2014-OXI database is greater than in Physionet. The selected variables always include signal variances (varSAT1m and varSAT5m) and spectral information: in particular, the very low frequencies (FbSAT 1 in Physionet, and FbSAT 1 and 2 in HuGCDN2014-OXI), two intermediate bands (1st band: FbSAT 4 in Physionet, and FbSAT 5 in HuGCDN2014-OXI; 2nd band: FbSAT 12 in Physionet, and FbSAT 9 and 10 in HuGCDN2014-OXI), and a band of higher frequencies represented by FbSAT 17 in Physionet, as well as FbSAT 17 and 20 in HuGCDN2014OXI. Thus, information related to low frequency oscillations, linked to consecutive apneic episodes, as well as some high frequency components related to short sleep breathing pauses, seem to be relevant.\nSensors 2023, 23, 4267 17 of 34\nFinally, we analyze the feature set obtained when we merge HRV and SpO2 variables. The selection of variables that refer to variance (varSAT1m and varSAT5m) in the first positions is especially noteworthy. Moreover, this selection includes features related to the spectral content of the oximetric signal, located in the bands referred to previously. However, RQA measures take on special relevance for variables related to HRV. Specifically, in Physionet, these include T2, Clust, TT, RT, and RTmax, and in HuGCDN2014-OXI, they include Clust, Trans, DET, T2, RT, LAM, TT, Lmax, and ENTW. Except for RTmax,\nSensors 2023, 23, 4267 18 of 34\nall those chosen in Physionet are also chosen in HuGCDN2014-OXI. However, cepstrum coefficients are discarded in both databases. The feature selection algorithm also rules out the characteristics linked to the spectral content in Physionet, and only three (FbHRV 1, 23, and 30) occur in HuGCDN2014-OXI, and not in the first positions. Finally, the variable \u03b11 (DFA) is discarded in Physionet, but it is included in HuGCDN2014-OXI and in a privileged position within the ranking. We show the values and differences observed in the selected features in apneic and non-apneic minutes in Table 11 (Physionet) and Table 12 (HuGCDN201-OXI), where the medians and the interquartile ranges are defined. We applied the Wilcoxon test to compare statistical significance in the two groups under study. The test was performed using a level of significance p = 0.05, and values of p < 0.05 were considered significant. The corresponding p-values are shown in Tables 11 and 12."
        },
        {
            "heading": "3.2. Per-Recording Classification",
            "text": "The aim of this last section is to evaluate the proposed system in OSA diagnosis, with special emphasis on those patients who do not exhibit clear desaturating behavior during apneic events. This is especially important given that the ultimate goal of any OSA automatic diagnostic system is to contribute to the search for an alternative to polysomnography. In this section, we will only refer to the HuGCDN2014-OXI database, as we only have eight patients in Physionet and, furthermore, it does not distinguish between desaturators and non-desaturators. We carry out a per-recording classification according to the AHI estimation (automatic AHI). As we highlighted in our introduction, we estimate the AHI for a subject by calculating the average number of apneic minutes per hour, i.e., adding the total number of apneic minutes, dividing this value by the total number of minutes in the corresponding register, and multiplying the result by 60 [25].\nSensors 2023, 23, 4267 19 of 34\nFigure 6 shows automatic versus manual AHI (obtained manually by qualified staff) depending on the characteristics (HRV, SpO2, HRV, and SpO2). The different colors represent the control subjects (green), the desaturators (red), and the non-desaturators (blue). There is no defined criterion for the AHI value to discriminate between healthy and pathological subjects [44], so there are three horizontal lines in each graph representing AHI values commonly used in the OSA diagnosis\u20145, 10, or 15 [41,57]\u2014thus calculating the results according to the AHI value. We perform the per-recording classification analysis graphically, as it is a good way to assess how our system\u2019s regression line fits the function y = x. Figure 6 shows that, using only HRV features, the limit for the AHI value should be set at 15. In that case, 4 healthy subjects (out of 19) and 3 pathological subjects (out of 28, 17 desaturators and 11 non-desaturators) would be incorrectly classified. Of the three pathological subjects, two are desaturators, and one is a non-desaturator. However, using only oximetric variables leads to a high specificity in the classification of control patients and a high sensitivity in the detection of desaturating patients. This means that, regardless\nSensors 2023, 23, 4267 20 of 34\nof the AHI value (5, 10, or 15), all these subjects (control and desaturating patients) are well-classified. Nevertheless, of the 11 non-desaturating patients, and depending on the AHI limit, 2 for AHI = 5, 4 for AHI = 10, and 7 for AHI = 15 would be incorrectly classified. Finally, when we merge HRV and SpO2 features, sensitivity improves when classifying non-desaturating patients, and specificity worsens slightly. In this case, by setting the AHI limit at 5, almost all subjects would be well classified, although 3 subjects (2 control and 1 non-desaturator) would be at the limit. Accuracies, sensitivities, and specificities are shown in Table 13. Sensors 2023, 23, x FOR PEER REVIEW 21 of 36 results according to the AHI value. We perform the per-recording classification analysis graphically, as it is a good way to assess how our system\u2019s regression line fits the function y = x.\nset at 15. In that case, 4 healthy subjects (out of 19) and 3 pathological subjects (out of 28,\n17 desaturators and 11 non-desaturators) would be incorrectly classified. Of the three\npathological subjects, two are desaturators, and one is a non-desaturator. However, using\nonly oximetric variables leads to a high specificity in the classification of control patients\nand a high sensitivity in the detection of desaturating patients. This means that, regardless\nof the AHI value (5, 10, or 15), all these subjects (control and desaturating patients) are well-classified. Nevertheless, of the 11 non-desaturating patients, and depending on the AHI limit, 2 for AHI = 5, 4 for AHI = 10, and 7 for AHI = 15 would be incorrectly classified. Finally, when we merge HRV and SpO2 features, sensitivity improves when classifying non-desaturating patients, and specificity worsens slightly. In this case, by se ing the AHI limit at 5, almost all subjects would be well classified, although 3 subjects (2 control and 1 non-desaturator) would be at the limit. Accuracies, sensitivities, and specificities are shown in Table 13.\nHRV 5 63.83 100 10.53 10 76.60 96.43 47.37 15 85.11 89.29 78.95\nSpO2 5 95.74 92.86 100 10 91.49 85.71 100 15 85.11 75 100\nHRV and SpO2 5 95.74 100 89.47 10 93.62 89.29 100 15 87.23 78.57 100\nACC: classification rate (accuracy), SENS: sensitivity, SPEC: specificity.\nTable 13. Per-recording performance (test results) in HUGCDN2014-OXI (control subjects, desaturating, and non-desaturating patients), depending on the features and on the AHI limit. These results represent a real system, tested with healthy subjects and OSA diagnosed patients (desaturating and non-desaturating). For the main parameters (classification rate and sensitivity), we obtain the best results by combining both feature types (highlighted i gr y).\nFeatures AHI Limit ACC SENS SPEC\nHRV\n5 63.83 100 10.53\n10 76.60 96.43 47.37\n15 85.11 89.29 78.95\nSpO2\n5 95.74 92.86 100\n10 91.49 85.71 100\n15 85.11 75 100\nThe regression study presented in the previous paragraphs is good to assess the agreement and relationship between manual (AHIm) and automatic (AHIa) AHI estimations. We now go a step further by performing a statistical analysis of the errors of the automatic method compared to the manual method. For this purpose, the quantification of the agreement between the two quantitative AHI measurements plays an important role by studying the mean difference and constructing limits of agreement. We are interested in evaluating the bias, which is calculated from the mean error, and estimating an agreement interval, within which fall 95% of the errors. Bland and Altman (B&A) introduced a plot to describe the agreement between two quantitative measurements [115,116]. The resulting graph is a scatter plot, in which the vertical axis shows the difference between the two-paired\nSensors 2023, 23, 4267 21 of 34\nmeasurements (AHIa \u2212 AHIm), and the horizontal axis represents the average of these measures, estimated as (AHIa + AHIm)/2. We can summarize the agreement by calculating the bias, estimated by the mean error (d) and the standard deviation (sd). Assuming normality, we can expect 95% of the errors to lie in the confidence interval (CI) defined by d \u00b1 sd. A bias is not statistically significant if the line of equality (zero error) lies inside the CI, thus indicating that there is not a significant systematic error. For example, the automatic method does not show a significant constant under/overestimation compared to the automatic one. We may wonder about whether the agreement interval is sufficiently narrow. It depends on analytical and clinical goals. For our purposes, correct classification must be as high as possible. It is also important to understand the significance of confidences around the mean error and agreement limits, as these CI describe possible errors in the estimates due to deficiencies in the sampling. In general, the greater the number of samples used to evaluate the quality, the narrower the CI. In Figure 7, we show the Bland\u2013Altman plots for the automatic versus manual AHI in test patients, depending on the features, with the representation of confidence interval limits (95%) for the mean and agreement limits. The bias, standard deviation (Std), and 95% CI limits of Figure 7 are shown in Table 14.\nSensors 2023, 23, x FOR PEER REVIEW 22 of 36\nThe regression study presented in the previous paragraphs is good to assess the agreement and relationship between manual (AHIm) and automatic (AHIa) AHI estimations. We now go a step further by performing a statistical analysis of the errors of the automatic method compared to the manual method. For this purpose, the quantification of the agreement between the two quantitative AHI measurements plays an important role by studying the mean difference and constructing limits of agreement. We are interested in evaluating the bias, which is calculated from the mean error, and estimating an agreement interval, within which fall 95% of the errors. Bland and Altman (B&A) introduced a plot to describe the agreement between two quantitative measurements [115,116]. The resulting graph is a sca er plot, in which the vertical axis shows the difference between the two-paired measurements (AHIa \u2212 AHIm), and the horizontal axis represents the average of these measures, estimated as (AHIa + AHIm)/2.\nWe can summarize the agreement by calculating the bias, estimated by the mean error (\u0305) and the standard deviation (sd). Assuming normality, we can expect 95% of the errors to lie in the confidence interval (CI) defined by \u0305 . A bias is not statistically significant if the line of equality (zero error) lies inside the CI, thus indicating that there is not a significant systematic error. For example, the automatic method does not show a significant constant under/overestimation compared to the automatic one. We may wonder about whether the agreeme t interval is sufficiently narrow. It depends on anal tical a d clinical goals. F r our purpo es, co rect classi ti ust be as high as possible. It is also i p erstand the significance of confidences around the m an rror and agr ement li its, t ssible er ors in the estimates due to deficiencies in the sampling. In general, the t e number of samples used to evaluate the quality, the narro .\nIn Fi r , s the Bland\u2013Altman plots for the automatic versus manu l AHI in test patie ts, e e ding on the features, with the representation of confidence interval limits (95 ) for the ean and agreement limits. The bias, standard deviation (Std), and 95% CI li its of Figure 7 are shown in Table 14.\nFigure 7. Bland\u2013Altman plots for the automatic (AHIa) versus manual (AHIm) AHI depending on the feature in test patients, with the representation of confidence interval limits for mean and agreement limits.\nTable 14. Bias, standard deviation (Std), and 95% CI limits of Figure 7.\nFeatures Bias Std CI\nFigure 7. Bland\u2013Altman plots for the automatic (AHIa) versus manual (AHIm) AHI depending on the feature in test patients, with the representation of confidence interval limits for mean and agreement limits.\nAn inspection of the plots let us see some interesting characteristics of the classifiers. In all cases, control patients are grouped in small clusters, and they are well differentiated from desaturating and non-desaturating patients, which are scattered in wider areas. For HRV features, non-control patients are scattered in such a way that it is difficult to find differences among them. On the contrary, for SpO2, HRV, and SpO2 features, the differences are quite evident. Particularly, AHI for desaturating patients are underestimated, while for non-desaturating, the main tendency is to be overestimated. The confidences around the mean error and agreement limits are quite narrow. We must highlight that, for HRV and SpO2 features, we get the narrowest CI. Regarding the bias, we can see that, in all cases, the value is not zero, thus indicating certain lack of agreement. These biases are not significant because the lines of equality are within the confidence intervals of the mean errors. For SpO2, as well as HRV&SpO2 features, the biases are very small, and the patients incorrectly classified for AHI limit = 5 are 3. For\nSensors 2023, 23, 4267 22 of 34\nHRV features, the bias is higher than for the other 2, and a value of\u22126.2489 compromises the classification of patients more than for the other features (7 patients incorrectly classified)."
        },
        {
            "heading": "4. Discussion",
            "text": "This is a novel study that thoroughly analyzes the detection of sleep apnea events (quantification) and the diagnosis of OSA patients (per-recording classification), but it focuses on the system performance when the database includes patients who do not always show desaturations during apneic episodes (non-desaturating patients). In this context, this work aims to quantify the system improvement by combining information extracted from different signals (HRV and SpO2), mainly, in non-desaturating patients. The HRV features include spectral (Filterbank), cepstral, and nonlinear information (DFA and RQA), whereas SpO2 features consider temporal (1 min and 5 min variance) and spectral (Filterbank) information. The main contributions to the state of the art research are threefold. On the one hand, and for the first time in the literature, we evaluate how non-desaturating patients affect the performance of an automatic apnea detection system. This is particularly important given that, at present, there is no overall accepted alternative system to polysomnography that is simple, automatic, and requires fewer signals. This is due, among other things, to the lack of studies in the literature dealing with OSA patients with other concomitant pathologies. Very few studies have assessed OSA in patients who also suffered from COPD [54,117,118]. The most recent study, carried out by Andr\u00e9s-Blanco et al. [54], was meant to assess the influence of COPD on an automatic OSA detection system\u2019s performance using the oximeter signal in the patient\u2019s home. For this, they compared the results from polysomnography in the hospital with those obtained at the patient\u2019s home. The study distinguished between OSA patients with and without COPD. However, regarding COPD, it is important to highlight that, within the AASM recommendations [5], OSA analysis with portable systems in patients with COPD is, in principle, not recommended. On the other hand, it is important to highlight that, unlike other works in the literature that only focus on OSA diagnosis [36,40\u201342,47,49,50,64], we perform real-time detection of apneic events, which allows us to use the system in the context of OSA treatment [53]. Finally, the detection of the most representative features of the underlying system when using HRV or SpO2 features alone, or when combined, allows us to deepen the characterization of the physiological system associated with OSA."
        },
        {
            "heading": "4.1. Evaluation of HRV and SpO2 Signals in Apnea Detection and OSA Diagnosis",
            "text": "The objective of this section is to unify the conclusions reached in Sections 3.1 and 3.2, which are devoted to per-segment (apneic/non-apneic minute) and per-recording (control patient/desaturating patient/non-desaturating patient) classification, respectively, to define the proposed system. After analyzing Table 6 (results of minute-by-minute classification in desaturating patients in HuGCDN2014-OXI), we considered that using SpO2 variables was the best option to reach high success rates and sensitivities with the lowest number of variables (15). However, given that the subjects under analysis can be both desaturators and non-desaturators, the sensitivities observed in Table 7 (results of minute-by-minute classification in nondesaturating patients in HuGCDN2014-OXI) would lean against exclusively employing SpO2 features. Thus, we propose combining HRV and SpO2 variables as the best option. This would improve sensitivities in non-desaturating patients significantly. Moreover, the error rates and sensitivities of desaturating patients would not worsen because the results with SpO2, as well as HRV and SpO2, features are very similar. However, this decision would, to a certain extent, harm non-desaturating patients, as exclusively using HRV variables yields better sensitivities. Nonetheless, desaturating patients are more common in general. On the other hand, if the system could include only one signal, a method which best harmonizes sensitivities in both desaturators and non-desaturators, then that would be\nSensors 2023, 23, 4267 23 of 34\nthe electrocardiographic signal. In this case, classification rates would be worse. However, using only the oximeter signal would result in sensitivities that were too small in nondesaturating patients. Concerning the per-recording classification, if only one signal is available, we would also choose the HRV signal and set the AHI limit at 15, thus better balancing sensitivity and specificity (see Figure 6). Using only the SpO2 signal would result in sensitivities being too low in non-desaturating patients. However, we must point out that, whenever the system includes features extracted from SpO2 (SpO2, as well as HRV and SpO2), the resulting specificity values are high (see Figure 6). The latter had already been referred to by other authors when evaluating the results from classic oximetric indices (ODIs and CTs). They produce, in general, high specificities but low sensitivities [32]. On the other hand, if including two signals were possible, combining HRV and SpO2 signals would be recommended along with using an AHI limit of 5. These conditions would give the best results, which would be close to 100%, for the per-recording classification rate regardless of the type of subject considered (control, desaturator, and non-desaturator) and, especially, the sensitivity in the classification of non-desaturating patients would improve. In the literature, there are several works that compare the ECG signal with the SpO2 signal performance [60], and others analyze the advantages of combining them [57]. However, none differentiate patients who are not desaturators. Xie and Minn [60] concluded that SpO2 features obtained better results than ECG features in terms of their diagnostic capability. Based on our results (see Figure 6), we can suggest that this statement is entirely valid for all those patients with a clear desaturation pattern during apneas, but it is not applicable to non-desaturating patients. Regarding the combination of HRV and SpO2 variables, these same authors highlighted how convenient information contained in the HRV is a complement to the oximeter information in the OSA diagnosis. Although they focused on the study of the oximetric signal, Hang et al. [52] concluded that including HRV features could boost OSA diagnosis system performance. Given the recent technological developments in wearable and portable systems, pulse oximeters and ECG monitors that employ Bluetooth [86,119\u2013121] are now available, which allow data to be transmitted in real-time to a computer, smartphone, or tablet for analysis. This leads us to consider that a system that includes both signals can be easily and comfortably implemented for the patient, who would undergo the diagnostic test at home via a completely wireless system. In the state of the art research, there are some examples of physiological signal recording systems that send information to a smartphone, highlighting the proposed system\u2019s viability [122]."
        },
        {
            "heading": "4.2. Selected Features",
            "text": "Of the features selected when the system includes HRV variables exclusively, we can conclude that most of those selected in Physionet are also selected in HuGCDN2014-OXI. Analyzing the features chosen in each case, we can see that combining different characteristics\u2014in this case, cepstral, spectral, and non-linear (RQA and DFA) characteristics\u2014offers the most benefits, as they provide complementary information on the phenomena that occur during apneic events. These results suggest that, in addition to cepstral and frequency information, short-term correlations and recurrences in the signal play an important role in the classification process. In particular, the first cepstrum coefficient and \u03b11 (DFA) are selected in both databases, as they are in our previous work [22]. However, by including RQA measures, the spectral information of the HRV becomes less relevant. Regarding the RQA measures, the selection algorithm emphasizes the importance of information on recurrence times (T2) and on the degree of local grouping (Trans and Clust). These measures already stood out in one of our previous studies [87], in which the HRV analysis included exclusively RQA measures. When the system only considers the SpO2 features, the selection (see Tables 9 and 10) always contains the 1 min and 5 min variance at relevant ranking positions, regardless of the database. Moreover, it also includes many variables corresponding to the spectral information (filter bank outputs). These results differ, to some extent, from those obtained\nSensors 2023, 23, 4267 24 of 34\nby Ravelo et al. [61], in which the selection algorithm ruled out the 5 min variance. Several studies in the literature show, as does the present work, that basic temporal statistical analyses yield good results with very low computational costs [34,35,45,63,85]. However, some systems that use spectral analysis of oximetric signals obtain good results [30,34,40,45]. Finally, the SpO2 features stand out in the selection when combining HRV and SpO2 variables. As seen in the previous analysis, the selected set includes the two variances (1 min and 5 min), as in the study carried out by Ravelo et al. [61]. Regarding the HRV variables, the feature selection algorithm rules out cepstrum coefficients and almost all variables related to its spectral content. The DFA variable, \u03b11, remains in the HuGCDN2014OXI database. However, almost all RQA measures, selected when working only with HRV, are included. These results suggest that, once the system includes the oximeter signal, information related to recurrences in the HRV, contained in the RQA measures, plays a very important role in the classification process, unlike the spectral and cepstral information of the HRV. Especially relevant are variables related to the diagonal structures of the RPs (DET), to the vertical structures (LAM and TT), to recurrence times (RT, T2, RTmax, and ENTW), and to the degree of local grouping (Clust and Trans). These features coincide, to a large extent, with those found in one of our previous studies [87], when using the FAN Method: Clust, LAM, RTmax, T1, and DET. The set of features obtained by combining the HRV and SpO2 signals shows how important oximetric variables are compared with those extracted from the HRV, which is consistent with conclusions reached by other authors [60,61]. This is mainly because SpO2 is directly linked to the amount of oxygen entering the lungs during inhalation. Hence, an apneic event will result, mostly, in oxygen saturation variation due to airflow interruption. However, the HRV, obtained from the ECG signal, not only reflects the phenomena associated with OSA but can manifest many other concomitant disorders. That being said, according to the arguments presented above, we must highlight the importance of HRV variables, especially in non-desaturating patients."
        },
        {
            "heading": "4.3. Desaturation in the Presence of Apneas",
            "text": "In the automatic detection of apneic episodes, especially when based on the SpO2 signal, there are several factors that can cause significant differences between AHI and ODI, which are common in patients who we have defined as non-desaturators. These include the following: (1) limitations of pulse oximeters [49], whose accuracy may be conditioned by factors such as skin pigmentation, blood flow in the evaluation area, SpO2 values below 80%, artifacts, or disconnections due to patient movement, etc. This is especially important in OSA-diagnosed patients, whose peripheral blood perfusion is often limited; (2) hypopneas, which imply a decrease in airflow, are factored into AHI calculations. The main problem is that marked desaturation is not always present during a hypopnea. In this regard, we must point out that neither of the two databases used for the experiments distinguish between apneas and hypopneas; (3) short duration apneas that do not cause desaturations; (4) upper airway resistance syndrome, in which the patient does not show apneas or desaturations but, rather, repetitive arousals due to a progressive increase in intrapleural pressure, increased work of breathing, and daytime drowsiness. In the past, this disorder was not considered sleep apnea; however, the latest AASM recommendations suggest including it within this group of pathology [55,123]; (5) displacements of the hemoglobin dissociation curve due to a variation in partial pressure of carbon dioxide (pCO2), temperature, pH, or 2\u20133 diphosphoglycerate (2\u20133 DPG), among others. Repeated apneic events usually lead to recurrent hypoxias (SpO2 values lower than 90%) and hypercapnias (abnormal increase in carbon dioxide (CO2)) in arterial blood. The pH decreases as the concentration of CO2 increases. Moreover, hypoxias lead to a rise in 2\u20133 DPG, which binds to hemoglobin, thus reducing hemoglobin oxygen affinity. It is also important to note that how these factors affect the curve displacement is specific to each person. This would explain the different responses observed in patients due to airway obstructions of the same duration. All these circumstances contribute to a rightward shift\nSensors 2023, 23, 4267 25 of 34\nof the hemoglobin dissociation curve, a sign of hemoglobin\u2019s decreased affinity for oxygen that favors the release of oxygen in the tissues. On the other hand, there are also changes in the structure and amount of blood hemoglobin that can lead to particularly high (such as in methemoglobinemia or carboxyhemoglobinemia) or low (such as in anemia) oximetry readings that are not related to respiratory disturbances [55]. Another relevant factor is obesity, as oximeter data in this type of patient are not reliable for OSA diagnosis [55,124]. Last, a final observation on chemoreceptors and baroreceptors in OSA patients. Carlson et al. [125] found out that OSA patients show arterial baroreceptor reflex attenuation or inhibition, due to chemoreceptors stimulation. In the same context, Narkiewicz et al. [126] studied chemoreceptor sensitivity and set out that it is increased in OSA patients. Desaturation, accompanied by hypercapnia, stimulates ventilation because of chemoreceptors, so rapid increases in ventilation lead to resaturation and a decrease in the duration of apneas and hypopneas. All these factors reinforce how important it is to avoid basing OSA diagnosis exclusively on the SpO2 signal. Furthermore, with this work, we open the door to the possibility that, in the future, respiratory events can be studied thoroughly by attending, for example, to their duration. It is possible that the effects on sleep quality and, in general, on patients\u2019 quality of life depend on the duration of the respiratory events since, in short ones, desaturations may not occur."
        },
        {
            "heading": "4.4. Limitations of the Proposed Method",
            "text": "Despite its contributions, we must draw attention to some limitations present in the study. To a large extent, these limitations are related to the databases employed. In the widely used Physionet database, there are only eight patients with all the signals involved in this analysis\u2014ECG and SpO2. Including them allows us to compare our results with other works in the literature, although conclusions drawn from such a small database are limited. In any case, it is necessary to bear in mind that, as our main objective is to evaluate the system considering non-desaturating patients, our most important conclusions came from the HuGCDN2014-OXI database, whose main limitation is that it only accounts for control subjects and patients with severe OSA. We should also mention that neither database includes subjects with significant concomitant disorders, such as cardiorespiratory diseases. Additional studies with this type of patient would be necessary to give our conclusions a more generalizable character. All these circumstances are especially relevant considering that HRV, in the context of apnea, may be conditioned by the integrity of sympathetic and parasympathetic stimuli, so associated pathologies, such as diabetes mellitus or chronic heart failure, could cause a limited response of the autonomic system and, therefore, a decrease in HRV [127\u2013129]. Moreover, there are also some studies suggesting that the autonomic nervous system activity is age-dependent, which could lead to a decrease in HRV in healthy subjects [127,130\u2013132]. The latter led Zamarr\u00f3n et al. to think that combining HRV and SpO2 signals was especially important in elderly patients. On the other hand, Guti\u00e9rrez-Tobal et al. [27] studied the potential gender differences in HRV sleep apnea information. The conclusions of these works could suggest that assessing automatic systems for OSA diagnosis should differentiate pathologies, age, and sex of the subjects under study. We must bear in mind that most state of the art research aimed at diagnosing OSA or apneic events from HRV uses public databases. However, those that also include oximetry usually rely on their own databases, making it difficult to compare the different systems. In our opinion, more efforts should be made to create a database to replace the widely used Physionet. The new database should include ECG signals, SpO2 signals, and a sufficiently high number of subjects to allow the study of special interest groups. In this sense, it would be useful to include a greater range of ages, a greater number of women, subjects of different races, and patients with different diseases that may affect OSA diagnosis, especially pulmonary and cardiac diseases. This would also allow results from different\nSensors 2023, 23, 4267 26 of 34\nsystems to be compared. As a result, widely contrasted solutions could be reached to create a universal automatic system that is acceptable to the medical community. Finally, we must point out that our proposal is intended to be a portable or wearable system. However, the signals used in the analysis were collected in a controlled hospital environment. Therefore, we should evaluate its performance in an unsupervised environment to validate the conclusions obtained."
        },
        {
            "heading": "4.5. Comparison with Prior Work",
            "text": "As already discussed in Section 1.2, in the state of the art research, there are many studies that use the oximeter signal or the combination of HRV and SpO2 signals for OSA diagnosis. The problem when comparing our results with those reached in previous studies is the use, in most cases, of diverse private databases: the proportion of control subjects versus patients in the different OSA grades, concomitant diseases, desaturating characteristics, age, and physical attributes of the subjects under study, etc. These aspects are particularly relevant as obesity or the presence of COPD can increase the number of false positives [80]. However, general conclusions can be drawn depending on the type of features used in each case. The classical oximetric indices (delta index, ODIs, and CTs) show certain limitations that have been exposed in previous studies [36,45]. Of such limitations, one is records analysis, which can only be carried out offline. This allows overall classification of the subjects as pathological or non-pathological, but it is impossible to analyze apneic events in real time. Several authors have reported difficulty in performing an overall analysis in real time, i.e., obtaining screening results in a few minutes. Fortunately, the computational power of modern servers allows this task to be approached without appreciable delay. As mentioned in 4.1, recent technological developments in wearable and portable systems are now available, which allow data to be transmitted in real-time to a computer, smartphone or tablet for analysis. Additionally, there are examples of physiological signal recording systems that send information to a smartphone, highlighting the proposed system\u2019s viability. The sensitivities and specificities obtained vary greatly between the different studies (sensitivities between 30% and 98%, and specificities between 41% and 100% [50]), and the correlation between AHI and the oximetric indices is low [46]. Moreover, the results are generally worse than those obtained when other features are introduced, including temporal and frequency statistics, spectral analysis, and nonlinear analysis [42,45,48,85]. For meaningful comparison, we focus on the studies that use Physionet, especially those that include only the eight patients with both signals (ECG and SpO2). Table 15 shows the results obtained for per-segment classification because the small number of patients does not allow, in general, an adequate analysis of per-recording classification. Lee et al. [37] introduced the wavelet transform with an accuracy of 96.55%, sensitivity of 95.74%, and specificity of 97.02% by defining a threshold for each patient\u2019s own wavelet coefficients, which is not feasible in clinical practice. Therefore, the reference values for this study would be those shown in the second row and obtained with a global threshold (Acc: 82.70%; Sens: 78.99%; Spe: 84.82%). Burgos et al. [43] used a modified version of the classical oximetric indices to adapt them to a segmental study (Acc: 93.03%; Sens: 92.35%; Spe: 93.52%). The two authors referred to so far only made use of the SpO2 signal. Shi et al. [59] performed a comparative study dependent on the type of signal used, extracting time and frequency features of each signal. Wang et al. [133] used a residual network with HRV that was 94.39% accurate. With a self-configuring classifier combination, Mostafa et al. [134] reached an accuracy, sensitivity and specificity of 91.33%, 98.11%, and 86.98%. Mostafa et al. [83] reached an accuracy, sensitivity, and specificity of 94.24%, 92.04%, and 95.78% using a convolutional neural network with multi-objective hyperparameter optimization. In another study, Mostafa et al. [82] reached an accuracy, sensitivity, and specificity of 95.14%, 92.36%, and 97.08%, respectively, with a greedy based convolutional Neural Network. Bernardini et al. [135] proposed a convolutional deep learning architecture to reduce the temporal resolution of raw waveform data and reached an accuracy, sensitivity, and specificity of\nSensors 2023, 23, 4267 27 of 34\n93.60%, 91.20%, and 95.10%. Finally, Sharma et al. [136] decomposed the SpO2 signals into various sub-bands (SBs) and extracted Shannon entropy features (Acc.: 95.97%; Sens.: 95.78% and Spe.: 96.09%). Comparing the results from our study for the Physionet database with those reached in other works, we can conclude that, both for the cases in which the HRV and SpO2 signals are used individually and those where they are used jointly, our proposal shows interesting and competitive results that emphasize the physical information obtained from the features, along with a simpler classification method. Although the HuGCDN2014-OXI database is not exactly the same as the one used by Ravelo-Garc\u00eda et al. [61], Mostafa et al. [82,83,134], and Mendo\u00e7a et al. [137], the data were collected in the same sleep laboratory, which is why we consider it appropriate to compare the results obtained with both datasets in Table 16. Ravelo et al. [61] obtained the following results by combining SpO2 and ECG (Acc: 86.9%; Sens: 73.4%; Spe: 92.3%). Mostafa et al. [134] reached an accuracy, sensitivity and specificity of 85.30%, 82.48% and 86.28% respectively. Mendon\u00e7a et al. [137] obtained an accuracy, sensitivity, specificity, and AUC of 88%, 80%, 91%, and 0.86, respectively. Mostafa et al. [83] reached an accuracy, sensitivity, and specificity of 89.32%, 74.75%, and 94.44%, respectively. Finally, Mostafa et al. [82] reached an accuracy, sensitivity and specificity of 88.49%, 73.64%, and 93.80%, respectively. In our proposal, sensitivities are notably better and well-balanced with specificities. In return, we obtained lower specificities, all of which are greater than 76.90%. Bearing in mind that this is a medical diagnostic system, we consider the increased sensitivity especially relevant, especially as we also include a high proportion of non-desaturating patients, which further complicates the per-segment classification. In summary, we consider our results very promising. Nevertheless, there is still margin to improve the global system performance, e.g., increasing the number of features, specifically by adding new non-linear characteristics to both signals that will allow us to obtain additional complementary information; applying other pattern recognition methods as those based on deep learning [138], ANN, k-NN, SVM or decision tree classifiers; assessing other feature selection techniques.\nSensors 2023, 23, 4267 28 of 34"
        },
        {
            "heading": "5. Conclusions",
            "text": "To the best of our knowledge, this is the first study in the context of OSA that is focused on quantitative analysis of results from patients under study who do not show a clear desaturating pattern during apneic events. For this purpose, we have evaluated the use of features extracted from the HRV and SpO2 signals, individually and jointly, in different sets of patients according to their desaturating patterns. We concluded that the best option, both for the detection of apneic events and for the global diagnosis of OSA patients, is to combine both signals, especially when the subjects under study include patients with a non-desaturating pattern. In that case, we found, for the detection of apneic events in Physionet, a success rate of 96.19%, sensitivity of 95.74%, and specificity of 95.25% (AUC: 0.99) and in HuGCDN2014-OXI, we found rates of 87.32%, 83.81%, and 88.55% (AUC: 0.934), respectively. The results for the global diagnosis of OSA patients (HuGCDN2014-OXI) were: success rate of 95.74%, sensitivity of 100%, and specificity of 89.47%. The AHI limit, in this case, would be set at 5. However, if only one signal is available, we would suggest using the HRV, as otherwise, the sensitivity for non-desaturating patients would be very low. For this option, we found the following results in Physionet: a 92.71% success rate, 92.38% sensitivity, and 93.3% specificity (AUC: 0.983); in HuGCDN2014-OXI: 77.22%, 78.13%, and 76.9% (AUC: 0.854), respectively. For this case, we suggest 15 as an AHI limit. Regarding the features, we can highlight two cases. If both HRV and SpO2 signals are included, results suggest that we should include, of the SpO2 signal, both 1 min and 5 min variances, some variables related to the spectral information, and, of the HRV, the RQA measures and the \u03b11 variable (DFA). However, if we only used the HRV signal, it would be useful to add cepstrum coefficients and spectral information. In summary, we can conclude that the proposed system diagnoses OSA well, especially when using both HRV and SpO2 signals. Given recent technological breakthroughs in portable and wearable systems, both signals could be recorded wirelessly in patients\u2019 homes, thus avoiding the drawbacks of using polysomnography. Moreover, real-time detection of apneic events would allow for improved treatment, as steps could be taken during apneic episodes to restore normal breathing [51]. Given the important consequences of OSA for patients\u2019 long-term health, this would reduce mortality rates associated with this pathology.\nAuthor Contributions: Conceptualization, S.M.-G. and A.G.R.-G.; Methodology, S.M.-G., J.L.N.-M. and E.H.-P.; Software, S.M.-G. and A.G.R.-G.; Validation, S.M.-G., A.G.R.-G., J.L.N.-M. and E.H.-P.; Formal analysis, S.M.-G. and J.L.N.-M.; Investigation, S.M.-G., A.G.R.-G., J.L.N.-M. and E.H.-P.; Resources, A.G.R.-G. and J.L.N.-M.; Data curation, E.H.-P.; Writing\u2014original draft, S.M.-G., A.G.R.-G., J.L.N.-M. and E.H.-P.; Writing\u2014review & editing, S.M.-G. and E.H.-P.; Visualization, S.M.-G., A.G.R.-G., J.L.N.-M. and E.H.-P.; Supervision, A.G.R.-G.. All authors have read and agreed to the published version of the manuscript.\nSensors 2023, 23, 4267 29 of 34\nFunding: Publication fees have been charged by the project ULPGC Excellence, funded by the Consejer\u00eda de Econom\u00eda, Conocimiento y Empleo del Gobierno de Canarias.\nInstitutional Review Board Statement: All subjects gave their informed consent for inclusion before they participated in the study. The study was conducted in accordance with the Declaration of Helsinki, and the protocol was ap-proved by the Ethics Committee of Hospital Universitario de Gran Canaria Doctor Negr\u00edn (Negr\u00edn CEIC Code: 160019).\nInformed Consent Statement: Patient consent was waived because no participant can be identified.\nData Availability Statement: The data presented in this study (HuGCDN2014-OXI database) are openly available in Mendeley at https://data.mendeley.com/datasets/cdxs63gdzc/1 accessed on 17 April 2023.\nConflicts of Interest: The authors declare no conflict of interest."
        }
    ],
    "title": "Combining Heart Rate Variability and Oximetry to Improve Apneic Event Screening in Non-Desaturating Patients",
    "year": 2023
}