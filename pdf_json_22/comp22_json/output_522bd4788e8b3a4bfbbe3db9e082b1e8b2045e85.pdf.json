{
    "abstractText": "For Hamiltonian systems, simulation algorithms that exactly conserve numerical energy or pseudo-energy have seen extensive investigation. Most available methods either require the iterative solution of nonlinear algebraic equations at each time step, or are explicit, but where the exact conservation property depends on the exact evaluation of an integral in continuous time. Under further restrictions, namely that the potential energy contribution to the Hamiltonian is non-negative, newer techniques based on invariant energy quadratisation allow for exact numerical energy conservation and yield linearly implicit updates, requiring only the solution of a linear system at each time step. In this article, it is shown that, for a general class of Hamiltonian systems, and under the non-negativity condition on potential energy, it is possible to arrive at a fully explicit method that exactly conserves numerical energy. Furthermore, such methods are unconditionally stable, and are of comparable computational cost to the very simplest integration methods (such as St\u00f6rmer-Verlet). A variant of this scheme leading to a conditionally-stable method is also presented, and follows from a splitting of the potential energy. Various numerical results are presented, in the case of the classic test problem of Fermi, Pasta and Ulam, as well as for nonlinear systems of partial differential equations, including those describing high amplitude vibration of strings and plates.",
    "authors": [
        {
            "affiliations": [],
            "name": "Stefan Bilbao"
        },
        {
            "affiliations": [],
            "name": "Michele Ducceschi"
        },
        {
            "affiliations": [],
            "name": "Fabiana Zama"
        }
    ],
    "id": "SP:95e9703f466ae0591f3fb31ca1d8e70a71295358",
    "references": [
        {
            "authors": [
                "R. LaBudde",
                "D. Greenspan"
            ],
            "title": "Energy and momentum conserving methods of arbitrary order for the numerical integration of equations of motion I. Motion of a single particle",
            "venue": "Numerical Mathematics,",
            "year": 1976
        },
        {
            "authors": [
                "A. Marciniak"
            ],
            "title": "Energy conserving, arbitrary order numerical solutions of the N-body problem",
            "venue": "Numerische Mathematik,",
            "year": 1984
        },
        {
            "authors": [
                "W. Strauss",
                "L. Vazquez"
            ],
            "title": "Numerical solution of a nonlinear Klein-Gordon equation",
            "venue": "Journal of Computational Physics,",
            "year": 1978
        },
        {
            "authors": [
                "D. Greenspan"
            ],
            "title": "Conservative numerical methods for \u1e8d = f(x)",
            "venue": "Journal of Computational Physics,",
            "year": 1984
        },
        {
            "authors": [
                "J. Simo",
                "N. Tarnow",
                "K. Wong"
            ],
            "title": "Exact energy-momentum conserving algorithms for symplectic schemes for nonlinear dynamics",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 1992
        },
        {
            "authors": [
                "T. Hughes",
                "T. Caughey",
                "W. Liu"
            ],
            "title": "Finite-Element methods for nonlinear elastodynamics which conserve energy",
            "venue": "Journal of Applied Mechanics,",
            "year": 1978
        },
        {
            "authors": [
                "G. Zhong",
                "J. Marsden"
            ],
            "title": "Lie-Poisson Hamilton-Jacobi theory and Lie-Poisson integrators",
            "venue": "Physics Letters A,",
            "year": 1988
        },
        {
            "authors": [
                "E. Hairer"
            ],
            "title": "Long-time energy conservation of numerical integrators",
            "venue": "Foundations of Computational Mathematics: Santander",
            "year": 2005
        },
        {
            "authors": [
                "R. McLachlan",
                "M. Perlmutter"
            ],
            "title": "Energy drift in reversible time integration",
            "venue": "Journal of Physics A: Mathematical and General,",
            "year": 2004
        },
        {
            "authors": [
                "E. Faou",
                "E. Hairer",
                "T. Pham"
            ],
            "title": "Energy conservation with non-symplectic methods: Examples and counter-examples",
            "venue": "BIT, 44:699\u2013709,",
            "year": 2004
        },
        {
            "authors": [
                "F. Marazzato",
                "A. Ern",
                "C. Mariotti",
                "L. Monasse"
            ],
            "title": "An explicit pseudo-energy conserving time-integration scheme for Hamiltonian dynamics",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 2019
        },
        {
            "authors": [
                "L. Vu-Quoc",
                "S. Li"
            ],
            "title": "Invariant-conserving finite difference algorithms for the nonlinear Klein- Gordon equation",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 1993
        },
        {
            "authors": [
                "J. Diaz",
                "M. Grote"
            ],
            "title": "Energy conserving explicit local time stepping for second-order wave equations",
            "venue": "SIAM Journal of Scientific Computing,",
            "year": 2009
        },
        {
            "authors": [
                "Y. Chin",
                "C. Qin"
            ],
            "title": "Explicit energy-conserving schemes for the three-body problem",
            "venue": "Journal of Computational Physics,",
            "year": 1989
        },
        {
            "authors": [
                "B. Shadwick",
                "J. Bowman",
                "P. Morrison"
            ],
            "title": "Exactly conservative integrators",
            "venue": "SIAM Journal of Applied Mathematics,",
            "year": 1998
        },
        {
            "authors": [
                "G. Quispel",
                "D. McLaren"
            ],
            "title": "A new class of energy-preserving numerical integration methods",
            "venue": "Journal of Physics A: Mathematical and Theoretical,",
            "year": 2008
        },
        {
            "authors": [
                "L. Brugnano",
                "F. Iavernaro",
                "D. Trigiante"
            ],
            "title": "A two-step, fourth-order method with energy preserving properties",
            "venue": "Computer Physics Communications,",
            "year": 2012
        },
        {
            "authors": [
                "X. Yang",
                "D. Han"
            ],
            "title": "Linearly first- and second-order, unconditionally energy stable schemes for the phase field crystal model",
            "venue": "Journal of Computational Physics,",
            "year": 2016
        },
        {
            "authors": [
                "X. Yang",
                "J. Zhao",
                "Q. Wang"
            ],
            "title": "Numerical approximations for the molecular beam epitaxial growth model based on the invariant energy quadratization method",
            "venue": "Journal of Computational Physics,",
            "year": 2017
        },
        {
            "authors": [
                "J. Shen",
                "J. Xu",
                "J. Yang"
            ],
            "title": "The scalar auxiliary variable (SAV) approach for gradient flows",
            "venue": "Journal of Computational Physics,",
            "year": 2018
        },
        {
            "authors": [
                "Y. Gong",
                "J. Zhao"
            ],
            "title": "Energy-stable Runge\u2013Kutta schemes for gradient flow models using the energy quadratization approach",
            "venue": "Applied Mathematics Letters,",
            "year": 2019
        },
        {
            "authors": [
                "H. Zhang",
                "X. Qian",
                "S. Song"
            ],
            "title": "Novel high-order energy-preserving diagonally implicit Runge\u2013Kutta schemes for nonlinear Hamiltonian ODEs",
            "venue": "Applied Mathematics Letters,",
            "year": 2020
        },
        {
            "authors": [
                "S. Sato",
                "Y. Miyatake",
                "J. Butcher"
            ],
            "title": "High-order linearly implicit schemes conserving quadratic invariants, 2021",
            "year": 2021
        },
        {
            "authors": [
                "J. Sherman",
                "W. Morrison"
            ],
            "title": "Adjustment of an inverse matrix corresponding to a change in one element of a given matrix",
            "venue": "Annals of Mathematical Statistics,",
            "year": 1950
        },
        {
            "authors": [
                "S. Bilbao",
                "M. Ducceschi"
            ],
            "title": "Fast explicit algorithms for Hamiltonian numerical integration",
            "venue": "In Proceedings of the European Nonlinear Dynamics Conference,",
            "year": 2022
        },
        {
            "authors": [
                "O. Gonzalez",
                "J. Simo"
            ],
            "title": "On the stability of symplectic and energy-momentum algorithms for non-linear Hamiltonian systems with symmetry",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 1996
        },
        {
            "authors": [
                "W. Terrell"
            ],
            "title": "Stability and Stabilization",
            "year": 2009
        },
        {
            "authors": [
                "Z. Liu",
                "X. Li"
            ],
            "title": "The exponential scalar auxiliary variable (e-sav) approach for phase field models and its explicit computing",
            "venue": "SIAM Journal on Scientific Computing,",
            "year": 2020
        },
        {
            "authors": [
                "L. Lin",
                "Z. Yang",
                "S. Dong"
            ],
            "title": "Numerical approximation of incompressible navier-stokes equations based on an auxiliary energy variable",
            "venue": "Journal of Computational Physics,",
            "year": 2019
        },
        {
            "authors": [
                "E. Hairer",
                "C. Lubich",
                "G. Wanner"
            ],
            "title": "Geometric numerical integration illustrated by the St\u00f6rmer\u2013Verlet method",
            "venue": "Acta Numerica,",
            "year": 2003
        },
        {
            "authors": [
                "E. Fermi",
                "J. Pasta",
                "S. Ulam"
            ],
            "title": "Studies of nonlinear problems",
            "venue": "Technical Report Los Alamos LA-1940,",
            "year": 1955
        },
        {
            "authors": [
                "E. Hairer",
                "C. Lubich",
                "G. Wanner"
            ],
            "title": "Geometric Numerical Integration",
            "venue": "Springer Series in Computational Mathematics,",
            "year": 2006
        },
        {
            "authors": [
                "P. Morse",
                "U. Ingard"
            ],
            "title": "Theoretical Acoustics",
            "year": 1968
        },
        {
            "authors": [
                "J. Chabassier",
                "P. Joly"
            ],
            "title": "Energy preserving schemes for nonlinear Hamiltonian systems of wave equations: Application to the vibrating piano string",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 2010
        },
        {
            "authors": [
                "M. Ducceschi",
                "S. Bilbao"
            ],
            "title": "Simulation of the geometrically exact nonlinear string via energy quadratisation",
            "venue": "Journal of Sound and Vibration,",
            "year": 2022
        },
        {
            "authors": [
                "T. Itoh",
                "K. Abe"
            ],
            "title": "Hamiltonian-conserving discrete canonical equations based on variational difference quotients",
            "venue": "Journal of Computational Physics,",
            "year": 1988
        },
        {
            "authors": [
                "M. Ducceschi",
                "S. Bilbao"
            ],
            "title": "Non-iterative, conservative schemes for geometrically exact nonlinear string vibration",
            "venue": "In Proceedings of the International Conference on Acoustics (ICA",
            "year": 2019
        },
        {
            "authors": [
                "R. Courant",
                "K. Friedrichs",
                "H. Lewy"
            ],
            "title": "On the partial differential equations of mathematical physics",
            "venue": "Mathematische Annalen,",
            "year": 1928
        },
        {
            "authors": [
                "J. Chabassier",
                "M. Durufl\u00e9"
            ],
            "title": "Physical parameters for piano modeling",
            "venue": "Technical report,",
            "year": 2012
        },
        {
            "authors": [
                "T. von K\u00e1rm\u00e1n"
            ],
            "title": "Festigkeitsprobleme im maschinenbau",
            "venue": "Encyklopa\u0308die der Mathematischen Wissenschaften,",
            "year": 1910
        },
        {
            "authors": [
                "A. F\u00f6ppl"
            ],
            "title": "Vorlesungen \u00fcber technische Mechanik",
            "venue": "Druck und Verlag von B.G. Teubner,",
            "year": 1907
        },
        {
            "authors": [
                "A. Nayfeh",
                "D. Mook"
            ],
            "title": "Nonlinear Oscillations",
            "year": 1979
        },
        {
            "authors": [
                "M. Ducceschi",
                "O. Cadot",
                "C. Touz\u00e9",
                "S. Bilbao"
            ],
            "title": "Dynamics of the wave turbulence spectrum in vibrating plates: A numerical investigation using a conservative finite difference scheme",
            "venue": "Physica D: Nonlinear Phenomena,",
            "year": 2014
        },
        {
            "authors": [
                "N. Yokoyama",
                "M. Takaoka"
            ],
            "title": "Weak and strong wave turbulence spectra for elastic thin plate",
            "venue": "Physical Review Letters,",
            "year": 2013
        },
        {
            "authors": [
                "G. D\u00fcring",
                "C. Josserand",
                "S. Rica"
            ],
            "title": "Wave turbulence theory of elastic plates",
            "venue": "Physica D: Nonlinear Phenomena,",
            "year": 2017
        },
        {
            "authors": [
                "R. Kirby",
                "Z. Yosibash"
            ],
            "title": "Solution of von K\u00e1rm\u00e1n dynamic non-linear plate equations using a pseudo-spectral method",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 2004
        },
        {
            "authors": [
                "S. Bilbao"
            ],
            "title": "A family of conservative finite difference schemes for the dynamical von K\u00e1rm\u00e1n plate equations",
            "venue": "Numerical Methods for Partial Differential Equations,",
            "year": 2008
        },
        {
            "authors": [
                "R. Vichnevetsky",
                "J. Bowles"
            ],
            "title": "Fourier Analysis of Numerical Approximations of Hyperbolic Equations",
            "venue": "SIAM, Philadelphia, Pennsylvania,",
            "year": 1982
        }
    ],
    "sections": [
        {
            "heading": "1 Introduction",
            "text": "The design of exact energy conserving numerical methods for nonlinear Hamiltonian systems goes back as least as far as the work of LaBudde and Greenspan, for the single particle subject to a central potential [1], Marciniak [2] for the N -body problem, Strauss and Vazquez [3] for the nonlinear Klein-Gordon equation, and Greenspan on the nonlinear harmonic oscillator [4], and was greatly generalized by Simo et al. [5] in their work on energy- and momentum-conserving algorithms. The concept of energy conservation in time stepping schemes goes back much further in the case of linear systems\u2014see the discussion and references in [5], particularly with regard to the energy conservation of the Crank-Nicholson method for linear systems. An exact numerical conservation of a \u201cpseudoenergy\u201d (henceforth simply \u201cenergy\u201d or \u201cnumerical energy\u201d in this article) of a numerical scheme for a conservative system may be contrasted with schemes that conserve energy approximately\u2014see, e.g., early work by Hughes et. al [6]. The same point of view is taken with other geometrical numerical\nar X\niv :2\n20 6.\n12 39\n1v 2\n[ m\nat h.\nN A\n] 1\nJ ul\nintegration techniques, such as, e.g., symplectic methods, where energy is conserved approximately, following the result from Zhong and Marsden [7] that, under some restrictions, exact energy conservation and symplecticity for Hamiltonian systems cannot be obtained simultaneously [8]. Various studies examine the degree to which energy is conserved for symplectic and non-symplectic methods [9, 10]. In this paper, we focus on exact conservation of numerical energy rather than approximate conservation, and we will not consider momentum conservation. Part of the reason for the focus here on exact numerical energy conservation is the possibility of determining conditions for numerical stability as has been pointed out earlier\u2014see [5] and Remark 8 in [11].\nMost exact numerical energy-conserving algorithms presented to date are implicit [3, 2, 5, 12], requiring the solution of a nonlinear system of algebraic equations at each time step, normally through an iterative method (such as, e.g., Newton-Raphson). This is obviously a computational bottleneck, and a fully explicit formulation is preferable. Note, however, that for linear systems, explicit and exact energy-conserving methods are available\u2014see, e.g., [13]. Exact explicit and conservative intergrators have also been designed on a case-by-case basis\u2014normally new ad hoc stability considerations appear in a problem-dependent way regarding the choice of the time step. See [14] for a treatment of the three-body problem, and [15] for the Kepler problem.\nIn a recent article by Marazzato et al. [11], an explicit Hamiltonian integrator is presented that preserves a numerical energy exactly, for general nonlinear systems. Two features are worth noting: a) the conserved quantity is defined through a continuous time integration, and thus must itself be approximated, leading effectively to approximate (non-exact) energy conservation in a discrete time implementation\u2014with fine enough approximation, numerical energy conservation to machine precision may be achieved; and b) when the energy of the model system is non-negative, as it commonly is in practice, the numerical energy does not inherit this property, and thus conditions for numerical stability do not immediately follow. Other exactly conservative methods, also reliant on the exact evaluation of a continuous integration have been proposed previously [16, 17].\nIn the context of gradient flows for diffusive systems, recent progress has been made in developing energy-stable methods through a variable transformation representing the energy, generally a nonlinear function of the state, as a quadratic form\u2014such methods are referred to as invariant energy quadratisation (IEQ) approaches [18, 19]. The main result is that it is possible to arrive at updating equations for a time-stepping method that are linearly implicit\u2014so that the update depends only on the solution of a linear system, rather than the solution of a system of nonlinear algebraic equations. This allows for the sidestepping of the many difficulties associated with iterative solvers, and reduced computational cost. Alongside the more recently introduced scalar auxiliary variable (SAV) approaches [20], such techniques have been applied to a wide variety of problems [21]. More recently, IEQ/SAV approaches have been applied to Hamiltonian systems, as in the case of diagonally-implicit Runge Kutta methods [22]. For an interesting overview of the relationship between quadratisation techniques and linearly implicit schemes, see the recent article by Sato et al. [23].\nA linearly implicit method will require the solution of a linear system at each time step, and will most likely constitute the computational bottleneck in a simulation as a whole. As will be shown here, using IEQ and SAV approaches, it is possible to arrive at energy-stable (indeed exactly lossless in machine arithmetic) numerical designs that are fully explicit. The explicit character of the update derives from the availability of a closed form inverse for the linearly implicit system that arises, and furthermore the ability to solve an N \u00d7N linear system in O(N) operations, through the Sherman-Morrison inversion theorem [24]. This property is fully general, and not dependent on the particular form of the Hamiltonian, except through the additional non-negativity requirement on the potential energy. As a result, computer execution time for exactly energy conserving methods for Hamiltonian systems is very nearly on par with that of the simplest explicit numerical schemes,\nsuch as, e.g., St\u00f6rmer-Verlet integration. This design addresses the two points a) and b) above with reference to the scheme presented in [11].\nIn Section 2, a restricted class of Hamiltonian systems is introduced. Under the constraint that the potential energy is non-negative, quadratisation techniques can be used to arrive at a simplified system of three equations in momentum, position, and a single scalar auxiliary variable derived from the potential energy. A further generalised form is also discussed, where a quadratic term is extracted or split from the expression for the potential energy before quadratisation, leading to a distinct starting point for numerical designs. Time stepping methods are introduced in Section 3, including first the rudimentary St\u00f6rmer-Verlet method, the energy-conserving method presented in [11], and then an exact energy-conserving and unconditionally stable method obtained using IES/SAV approaches, and allowing an explicit update. A variation of this last scheme to the case of a split potential energy is also exactly energy-conserving, and leads to a distinct conditionally-stable method. In Section 4, three examples are presented: the Fermi-Pasta-Ulam ODE system, and two PDE systems then reduced, by semi-discretisation, to Hamiltonian ODE systems: the nonlinear vibration of a string, and the high-amplitude vibration of a thin plate. Various numerical results are presented, illustrating convergence rates, exact numerical energy conservation to machine precision, and relative computation times. Some concluding remarks appear in Section 5.\nPreliminary results have been presented recently at the 2022 European Nonlinear Dynamics Conference [25]."
        },
        {
            "heading": "2 Hamiltonian Systems",
            "text": "Consider a system of particles, with N generalised coordinates q = [q1, . . . , qN ]\u1d40 and momenta p = [p1, . . . , pN ]\n\u1d40. Here, \u1d40 indicates a transposition operation, so p and q are N \u00d71 column vectors. Both are functions of time t \u2265 0, so p = p(t) and q = q(t). Suppose also that an associated Hamiltonian H(p,q) is defined by\nH (p,q) = 12p \u1d40M\u22121p + V (q) (1)\nfor some constant symmetric positive definite N\u00d7N matrix M referred to as the mass matrix. V (q) is the potential energy for the system of particles. H and V are scalar functions of time t, through their dependence on p and q.\nThe system dynamics follow from Hamilton\u2019s equations:\nq\u0307 = \u2207pH p\u0307 = \u2212\u2207qH , (2)\nwhere dots indicate differentiation with respect to time t, and \u2207p and \u2207q are gradients with respect to p and q, respectively. For the particular form of Hamiltonian given in (1), Hamilton\u2019s equations become\nq\u0307 = M\u22121p p\u0307 = \u2212\u2207qV . (3)\nThrough time differentiation of the first of (3), and substitution of the second, a second order system of ordinary differential equations in q results:\nMq\u0308 = \u2212\u2207qV . (4)\nSuch a second order form serves as the starting point for many numerical methods, including the classic St\u00f6rmer-Verlet method. See Section 3.1. In the first order representation (3), initial conditions are required for q and p, so q(0) = q(0) and p(0) = p(0), for given N vectors q(0) and p(0). For the second order form (4), one may set q\u0307(0) = M\u22121p(0).\nThe defining feature of a Hamiltonian system is that, given initial conditions p(0) and q(0), the energy H(t) is constant for all t \u2265 0:\nH\u0307 = 0 \u2192 H(t) = H(0) = constant \u2200t \u2265 0 , (5)\nwhere H(0) = H(p(0),q(0)), evaluated from (1) using initial conditions q(0) and p(0)."
        },
        {
            "heading": "2.1 Comments",
            "text": "The system and Hamiltonian in (1) are not the most general possible. A few remarks are offered here:\n\u2022 The mass matrix M is assumed constant\u2014a common assumption [5]. In many cases of interest, it is furthermore diagonal, but we will consider the more general form here, and indicate cases in which a diagonal form of M will have an impact on computational performance.\n\u2022 The Hamiltonian in (1) is separable, so that H(p,q) = T (p) + V (q), for kinetic energy T and potential energy V . In some cases of interest [8], the mass matrix M may be of the form M = M(q), disturbing this splitting, but these cases will not be considered here.\n\u2022 Following from the points above, the Hamiltonian is quadratic in p, meaning that the associated dynamical system is linear in p.\n\u2022 The individual displacements qi and momenta pi, i = 1, . . . , N , are assumed scalar here, and represent either displacements/momenta in a signal coordinate direction, or individual components of more general vector displacements/momenta. Both cases will be seen in the numerical examples in Section 4."
        },
        {
            "heading": "2.2 Non-negativity of the Potential Energy",
            "text": "As a further constraint, assume that\nV (q) \u2265 0 \u2200q \u2208 RN . (6)\nThis constraint is a natural one in many applications, but not all\u2014for example, the gravitational potential used in the calculations of planetary orbits is not of this form [26]. This further implies, from (1), that\nH \u2265 0 \u2200p,q \u2208 RN . (7)\nFurthermore, as M > 0, from (5), one has the following bound on p(t) in terms of the initial conditions: \u2016p(t)\u2016 \u2264 \u221a 2\u03bbmax(M)H(0) \u2200t \u2265 0 , (8)\nwhere \u03bbmax(M) is the maximal eigenvalue of M, and \u2016 \u00b7 \u2016 indicates a Euclidean norm. If V (q) is radially unbounded [27], so that V (q)\u2192 +\u221e as \u2016q\u2016 \u2192 +\u221e, then a further bound follows for \u2016q\u2016.\nThe non-negativity property of V is essential to invariant energy quadratisation methods\u2014 indeed, it can be generalized to the case of V bounded from below, so that V (q) \u2265 c, for any constant c [20], but the non-negativity condition (6) above will be used here for simplicity."
        },
        {
            "heading": "2.3 Potential Energy Quadratisation",
            "text": "Under the non-negativity condition on V , from (6), one may define\nV = 12\u03c8 2 . (9)\nHamilton\u2019s equations become\nq\u0307 = M\u22121p p\u0307 = \u2212\u03c8\u2207q\u03c8 . (10)\nFurthermore, using the chain rule, \u03c8\u0307 = (\u2207q\u03c8)\u1d40q\u0307 . (11)\nFinally, introducing\ng , \u2207q\u03c8 = 1\u221a 2V \u2207qV , (12)\na system of three equations results:\nq\u0307 = M\u22121p p\u0307 = \u2212\u03c8g \u03c8\u0307 = g\u1d40q\u0307 . (13)\nAn auxiliary initial condition \u03c8(0) may be set as \u03c8(0) = \u221a\n2V (q(0)) in terms of the given initial condition q(0) = q(0).\nThe key feature of system (13) is that, if g is assumed known at at any given time instant, the resulting equations are linear in p, q and \u03c8. Though in the present case, g does indeed have a dependence on q, in the numerical setting, g can be evaluated directly using previously computed values of the solution, and thus the update becomes a matter of solving a linear system. This is the essence of the \u201clinearly implicit\u201d property of schemes arising from energy quadratisation. As will be shown subsequently here, under the appropriate numerical design, the linear system is of a particularly simple form with a known easily-computed inverse leading, effectively, to an explicit update. Such a property is independent of the particular form of the potential energy V (q), provided the non-negativity constraint (6) is satisfied."
        },
        {
            "heading": "2.4 Potential Energy Splitting",
            "text": "In some cases, the expression for the potential energy naturally takes the form\nV (q) = 1\n2 q\u1d40Kq + V \u2032(q) , (14)\nwhere K is a symmetric positive semi-definite N\u00d7N matrix, and where V \u2032 \u2265 0. The first term could represent the stored energy of the system due to linear mechanisms, and V \u2032 that due to additional nonlinear effects. Now, using\nV \u2032 = 12\u03c8 2 , (15)\none arrives at a system of equations generalizing (13):\nq\u0307 = M\u22121p p\u0307 = \u2212Kq\u2212 \u03c8g \u03c8\u0307 = g\u1d40q\u0307 . (16)\nThough equivalent to (13), in a numerical setting, such a splitting allows for a larger family of numerical designs, treating the linear and nonlinear parts of the problem separately. See Section 3.4."
        },
        {
            "heading": "2.5 Potential Energy Gauge and Regularisation",
            "text": "A well-known technique in IEQ/SAV approaches is the introduction of a constant shift of the global energy (see e.g. [20, 28])\u2014Hamilton\u2019s equations (3) are unchanged (i.e. gauge invariant), but some numerical schemes, such as IEQ/SAV-based approaches are affected [29]. This amounts to the replacement V \u2192 V + (17) for a suitably chosen shift constant \u2265 0. Under the non-negativity constraint (6), V + is thus bounded away from zero, regularizing the calculation of g as defined in (12). The regularization approach applies equally to the case of a split potential, under the replacement V \u2032 \u2192 V \u2032 + ."
        },
        {
            "heading": "3 Numerical Methods",
            "text": "In this section, we assume time discretization using a constant time step k, such that solutions are computed at times tn = nk, n = 0, 1, . . .. A discrete-time vector un represents an approximation to a continuous time vector u(t) at times t = tn."
        },
        {
            "heading": "3.1 St\u00f6rmer-Verlet Integration",
            "text": "The most basic approach to the integration of the Hamiltonian system as defined in Section 2 is through direct approximation of the second order form in (4), using centered differences, as:\nqn+1 = 2qn \u2212 qn\u22121 \u2212 k2M\u22121\u2207qV |q=qn . (18)\nThis discretisation is referred to as St\u00f6rmer-Verlet, and was known to Newton\u2014see [30] and the references therein. It is a fully explicit two-step scheme\u2014in order to advance the solution to time step n+ 1, a direct evaluation of the gradient of the potential energy V at time step n is required. The values of the state qn at n = 0 and n = 1 may be initialised, using the initial conditions q(0) and p(0), as\nq0 = q(0) q1 = q(0) + kM\u22121p(0) (19)\nto second order in k, using a Taylor series approximation. St\u00f6rmer-Verlet is second-order accurate in the time step k, time-reversible, and symplectic, but not energy-conserving except in an approximate sense [30]. It can exhibit numerical instability depending on both the choice of time step and the size of the initial conditions. Such instabilities will be mentioned in Section 4."
        },
        {
            "heading": "3.2 Explicit Energy-conserving Method (Marazzato et al.)",
            "text": "Consider the following scheme approximating (3), proposed by Marazzato et al. in [11]:\nqn+1 = qn + kM\u22121pn+ 1 2 pn+ 3 2 = pn\u2212 1 2 \u2212 2 \u222b (n+1)k nk \u2207qV (q\u0303n(t))dt . (20)\nThis is a time interleaved scheme, with pn and qn+ 1 2 defined at alternating multiples of k/2. The first of (20) is a standard interleaved approximation to the first of (3). The second of (20) relies on a continuous integration of \u2207qV over the time interval t \u2208 [nk, (n + 1)k], and over the known free-flight trajectory q\u0303n(t) defined by\nq\u0303n(t) = qn + (t\u2212 nk)M\u22121pn+ 1 2 . (21)\nOther conservative schemes proposed also rely on such a continuous integration [16]. Except for particular functional forms of the potential energy V (q), this integral is not available in closed form and must be approximated. However, once the integral is evaluated, the scheme (20) is fully explicit.\nThe scheme (20) has an associated numerical energy that is exactly conserved [11]:\nHn = 12p n+\n1 2M\u22121pn\u2212 1 2 + V (qn) = constant . (22)\nThere are two important points to mention here:\n\u2022 Scheme (20) is exactly conservative, but depends on a continuous integration over a free-flight trajectory as given in (21) in order to achieve this property. Thus the exact conservation property is approached in the limit of increasing accuracy in the approximation of the continuous integration. It is also important to point out here that a fine-grained approximation of the continuous integration will require multiple evaluations of the gradient \u2207qV which, depending on the functional form of V , represents an additional cost that grows with the desired accuracy of the approximation.\n\u2022 When V \u2265 0, the numerical energy (22) does not inherit the non-negativity property of the model system, and thus cannot be used in order to bound solution growth, as pointed out in Remark 8 of [11].\nUnder the additional non-negativity constraint (6) on V , it is possible to demonstrate a method that conserves a pseuodenergy that does not depend on a continuous integration, and that furthermore inherits the non-negativity property of the Hamiltonian of the model system, allowing for useful bounds on solution size. Furthermore, through the exploitation of matrix structure, it will be shown that such a method is fully explicit. Additionally, only one function evaluation \u2207qV is required per time step."
        },
        {
            "heading": "3.3 Explicit Exactly Energy-conserving Method",
            "text": "Returning now to the form (13) of Hamilton\u2019s equations obtained under quadratisation of the potential energy, and the introduction of the new variable \u03c8 as in (9), consider the following scheme, written in terms of the interleaved time series pn+ 1 2 and qn, and the scalar time series \u03c8n+ 1 2 :\nqn+1 = qn + kM\u22121pn+ 1 2 (23a)\npn+ 1 2 = pn\u2212 1 2 \u2212 k2g n\n( \u03c8n+ 1 2 + \u03c8n\u2212 1 2 ) (23b)\n\u03c8n+ 1 2 = \u03c8n\u2212 1 2 + 12 (g\nn) \u1d40 ( qn+1 \u2212 qn\u22121 ) . (23c)\nHere, gn is defined as\ngn = \u2207q\u03c8|q=qn = 1\u221a\n2V (qn) \u2207qV |q=qn . (24)\nThe system (23) may be manipulated into an explicit update form in the following way. Beginning\nfrom (23a), one may write:\nqn+1 (23a) = 2qn \u2212 qn\u22121 + kM\u22121 ( pn+ 1 2 \u2212 pn\u2212 1 2 ) (25)\n(23b) = 2qn \u2212 qn\u22121 \u2212 k 2 2 M \u22121gn\n( \u03c8n+ 1 2 + \u03c8n\u2212 1 2 ) (23c) = 2qn \u2212 qn\u22121 \u2212 k2M\u22121gn\u03c8n\u2212 1 2 \u2212 k 2\n4 M \u22121gn(gn)\u1d40\n( qn+1 \u2212 qn\u22121 ) .\nFinally, the update has the form Anqn+1 = bn , (26)\nwhere An = I + \u03b1n(\u03b2n)\u1d40 bn = 2qn \u2212 2k\u03b1n\u03c8n\u2212 1 2 \u2212 (I\u2212\u03b1n(\u03b2n)\u1d40)qn\u22121 . (27)\nHere, I is the N \u00d7 N identity matrix, and the vectors \u03b1n and \u03b2n are defined in terms of gn\nby \u03b1n = k2M \u22121gn and \u03b2n = k2g\nn. Thus, given qn, qn\u22121 and \u03c8n\u2212 1 2 , both An and bn may be\nexplicitly constructed. Notice that the matrix An is positive definite by construction, due to the positive definiteness of M, and thus the update (26) always has a unique solution. Once the update in (26) has been performed, \u03c8n+ 1 2 may be computed from (23c) explicitly, using qn\u22121, qn+1 and \u03c8n\u2212 1 2 . Scheme (26) requires initial values for q0 and q1, which may be set in the same way as for St\u00f6rmer-Verlet, as in (19), and also \u03c8 1 2 which may be set to second order in k in terms of the initial displacement q(0) and momentum p(0) as\n\u03c8 1 2 = \u221a 2V (q(0)) +\nk 2 \u221a 2V (q(0))\n( \u2207qV |q=q(0) )\u1d40 M\u22121p(0) . (28)\nThough the solution of (26) apparently requires an N \u00d7 N linear system solution, in fact, the inverse is available in closed form, and allows for an explicit solution in O(N) operations. An is a rank-1 perturbation of the identity, and thus Sherman Morrison inversion [24] yields:\n(An) \u22121 = I\u2212 \u03b1 n(\u03b2n)\u1d40\n1 + (\u03b2n)\u1d40\u03b1n . (29)\nComputational cost is thus on par with the other methods presented here. Notice in particular, though, that the solution of a linear system involving M\u22121 is common to all the methods in this section; the computational cost of performing this operation, which may indeed be the bottleneck, is not considered here. In many cases, though, M is diagonal, or even a simple multiple of the identity, and thus its inversion is trivial.\nExact conservation of a numerical energy follows directly from scheme (23). Left-multiplying\n(23b) by 12\n( pn+ 1 2 + pn\u2212 1 2 )\u1d40 M\u22121 gives:\n1 2\n( pn+ 1 2 + pn\u2212 1 2 )\u1d40 M\u22121 ( pn+ 1 2 \u2212 pn\u2212 1 2 ) + k4 ( pn+ 1 2 + pn\u2212 1 2 )\u1d40 M\u22121gn ( \u03c8n+ 1 2 + \u03c8n\u2212 1 2 ) (23b) = 0(30)\n1 2\n( pn+ 1 2 + pn\u2212 1 2 )\u1d40 M\u22121 ( pn+ 1 2 \u2212 pn\u2212 1 2 ) + 14 ( qn+1 \u2212 qn\u22121 )\u1d40 gn ( \u03c8n+ 1 2 + \u03c8n\u2212 1 2 ) (23a) = 0\n1 2\n( pn+ 1 2 + pn\u2212 1 2 )\u1d40 M\u22121 ( pn+ 1 2 \u2212 pn\u2212 1 2 ) + 12 ( \u03c8n+ 1 2 \u2212 \u03c8n\u2212 1 2 )( \u03c8n+ 1 2 + \u03c8n\u2212 1 2 ) (23c) = 0 .\nThis may be identified as\nHn+ 1 2 = Hn\u2212 1 2 = constant , (31)\nwhere the numerical energy Hn+ 1 2 is\nHn+ 1 2 = 12\n( pn+ 1 2 )\u1d40 M\u22121pn+\n1 2 + 12\n( \u03c8n+ 1 2 )2 \u2265 0 . (32)\nIt is worth comparing this expression, for which non-negativity is ensured, with the expression (22) for the scheme in Section 3.2. The momentum pn+ 1 2 may be bounded in terms of the energy H, for all time steps n, as\n\u2016pn+ 1 2 \u2016 \u2264 \u221a 2\u03bbmax(M)H , (33)\nwhich is identical to the bound (8) for the model system. The scheme (23) is thus unconditionally numerically stable."
        },
        {
            "heading": "3.4 Split Potential Form",
            "text": "Consider now the split form of the potential energy V , as described in Section 2.4, where a positive semi-definite quadratic form has been separated from V to leave a residual energy contribution V \u2032 \u2265 0, from which an auxiliary variable \u03c8 may be defined as in (15). Consider the following scheme, now modified with respect to (23) through the addition of a linear term in (34b) below:\nqn+1 = qn + kM\u22121pn+ 1 2 (34a)\npn+ 1 2 = pn\u2212 1 2 \u2212 kKqn \u2212 k2g n\n( \u03c8n+ 1 2 + \u03c8n\u2212 1 2 ) (34b)\n\u03c8n+ 1 2 = \u03c8n\u2212 1 2 + 12 (g\nn) \u1d40 ( qn+1 \u2212 qn\u22121 ) . (34c)\nwhere now,\ngn = \u2207q\u03c8|q=qn = 1\u221a\n2V \u2032(qn) \u2207qV \u2032|q=qn . (35)\nAn explicit update follows as in the case of the non-split form in (26), with An as given in (27), but with bn now defined as\nbn = ( 2I\u2212 k2M\u22121K ) qn \u2212 2k\u03b1n\u03c8n\u2212 1 2 \u2212 (I\u2212\u03b1n(\u03b2n)\u1d40)qn\u22121 . (36)\nAn expression for a conserved numerical energy follows as before, now taking the form:\nHn+ 1 2 = 12\n( pn+ 1 2 )\u1d40 M\u22121pn+\n1 2 + 12 (q n+1)\u1d40Kqn + 12\n( \u03c8n+ 1 2 )2 = constant . (37)\nBecause the second term is of indefinite sign, the numerical energy is not necessarily non-negative. Because it is a quadratic form, however, it may be bounded, using (34a), as:\n1 2 (q n+1)\u1d40Kqn \u2265 \u2212 18 (q n+1 \u2212 qn)\u1d40K(qn+1 \u2212 qn) = \u2212k\n2\n8\n( pn+ 1 2 )\u1d40 M\u22121KM\u22121pn+ 1 2 . (38)\nIt then follows that\nHn+ 1 2 \u2265 12\n( pn+ 1 2 )\u1d40( M\u22121 \u2212 k 2\n4 M\u22121KM\u22121\n) pn+ 1 2 . (39)\nGiven that M > 0, M\u22121 may be factored into unique upper and lower triangular factors as M\u22121 = M\u2212 T 2 M\u2212 1 2 , a condition for non-negativity of H is\nk \u2264 2\n\u03bbmax\n( M\u2212 1 2KM\u2212 T 2 ) . (40) The scheme is now conditionally stable, with the stability condition (40) corresponding to that for a linear system when V \u2032 = 0."
        },
        {
            "heading": "3.5 Remarks",
            "text": "\u2022 Linear Conditions: One of the interesting features of the non-split form (23) is that, even if the potential V is quadratic in q, implying a linear system, the scheme is not linear. If, however, the split form (34) is used, then under linear conditions, V \u2032 = 0, and scheme (34) reduces exactly to St\u00f6rmer-Verlet (18). Note that under linear conditions, St\u00f6rmer-Verlet does\nindeed possess an exactly conserved numerical energy, as given in (37) with \u03c8n+ 1 2 = 0.\n\u2022 Generalized Splitting: The non-split form (23) and the split form (34) may be combined to yield a large family of conservative schemes in an obvious way. If\nV (q) = 12q \u1d40Kq + Vnonlinear(q) , (41)\nwhere Vnonlinear \u2265 0 and consists of higher order terms in q, then any splitting of the form\nV (q) = 12q \u1d40K0q + V \u2032(q) V \u2032(q) = Vnonlinear + 1 2q \u1d40K\u2032q , (42)\nwith K = K0 + K\u2032, K0 \u2265 0, K\u2032 \u2265 0 will yield a conservative form. The resulting numerical scheme, with V \u2032 = 12\u03c8\n2 will inherit conservation of energy, which will be non-negative under a condition analogous to (40), but depending on K0.\n\u2022 Generalized Update for qn: Consider again the non-split scheme (23), which may be rewritten as\nqn+1 = qn + kM\u22121pn+ 1 2 (43a)\npn+ 1 2 = pn\u2212 1 2 \u2212 k2g n\n( \u03c8n+ 1 2 + \u03c8n\u2212 1 2 ) (43b)\n\u03c8n+ 1 2 = \u03c8n\u2212 1 2 + k2 (g n) \u1d40 M\u22121\n( pn+ 1 2 + pn\u2212 1 2 ) . (43c)\nIn this form, exact energy conservation follows from (43b) and (43c) only\u2014it is independent of the values of gn, which are derived solely from qn. Further opportunities for generalization are thus available\u2014(43a) could be replaced by any consistent update for qn+1, and the exact numerical energy conservation property remains undisturbed.\n\u2022 Variable Time Steps: Though the case of variable time steps will not be discussed here in detail (and was indeed investigated in [11]), an exact energy-conserving scheme follows immediately from the form given in (43) above. Consider time instants tn, and tn+1/2, for integer n, where tn < tn+1/2 < tn+1. From these, one may define two sequences of time steps: kn = tn+1/2 \u2212 tn\u22121/2 and kn+1/2 = tn+1 \u2212 tn. Supposing that qn is a time series defined for t = tn, and similarly pn+ 1 2 and \u03c8n+ 1 2 are defined for t = tn+ 1 2 , then a scheme follows as:\nqn+1 = qn + kn+ 1 2M\u22121pn+ 1 2 (44a)\npn+ 1 2 = pn\u2212 1 2 \u2212 k n\n2 g n\n( \u03c8n+ 1 2 + \u03c8n\u2212 1 2 ) (44b)\n\u03c8n+ 1 2 = \u03c8n\u2212 1 2 + k n\n2 (g n) \u1d40 M\u22121\n( pn+ 1 2 + pn\u2212 1 2 ) . (44c)\nIt is direct to show that, regardless of the choices of tn and tn+ 1 2 , the scheme (44) conserves the energy (32) exactly. Thus such a generalisation is unconditionally stable, under the same reasoning as in the case of constant time steps.\n\u2022 Regularisation: Regularisation through a potential energy shift, as described in Section 2.5, impacts on the calculation of g in (24) and (35), through a replacement V \u2192 V + or V \u2032 \u2192 V \u2032 + , respectively."
        },
        {
            "heading": "4 Examples",
            "text": "In this section, various Hamiltonian systems are simulated using schemes (23) and (34), beginning with the Fermi-Pasta-Ulam ODE problem in Section 4.1, and then progressing to more complex ODE systems derived as semi-discretisations to PDE systems. These include the coupled transverselongitudinal vibration of a string at high amplitudes, in Section 4.2, and the high amplitude vibration of a thin plate in Section 4.3.\nIn all cases, a useful measure of the exact energy conservation property is the relative energy deviation error,\nRelative error = Hn+\n1 2 \u2212H 1 2\nH 1 2\n. (45)\nIn double precision floating point arithmetic, it is normally on the order of machine precision, or approximately 10\u221216. Depending on the state size of the system in question, however, larger deviations are possible."
        },
        {
            "heading": "4.1 Fermi-Pasta-Ulam Problem",
            "text": "As a simple example, consider the classic system of a linear arrangement masses connected by linear and nonlinear springs, as proposed originally by Fermi, Pasta and Ulam [31], and later adapted as a test problem by various authors [32, 11], the form of which is followed here.\nConsider a system of N = 2M masses in a linear arrangement, which longitudinal displacements qi and momenta pi, i = 1, . . . , 2M . The system Hamiltonian is defined by\nH = 1\n2 2M\u2211 i=1 p2i + V where V = \u03c92 4 M\u2211 i=1 (q2i \u2212 q2i\u22121)2 + M\u2211 i=0 (q2i+1 \u2212 q2i)4 , (46)\nwhere, in the expression above, q0 = q2M+1 = 0. Thus each mass is connected, in an alternating arrangement, to a linear spring, and a cubic nonlinear spring.\nV is clearly non-negative here, and thus, after consolidation of the displacements qi and pi into vectors p and q of size N \u00d7 1, the scheme as presented in (23) follows immediately, with M = IN , the N \u00d7 N identity matrix, and with V as given in (46) above. This scheme is explicit, exactly conservative, and unconditionally stable.\nA split form (14) of the Hamiltonian also follows, using\nK = \u03c92\n2 IM \u2297 [ 1 \u22121 \u22121 1 ] V \u2032 = M\u2211 i=0 (q2i+1 \u2212 q2i)4 \u2265 0 , (47)\nwhere here, \u2297 indicates a Kronecker product. An exactly energy conserving method follows, as in (34), and is stable under the condition (40), which reduces in this case to\nk \u2264 2 \u03c9 . (48)"
        },
        {
            "heading": "4.1.1 Numerical Results",
            "text": "We use the same settings as in [11], and choose \u03c9 = 50, and M = 3. Simulations are run here with a time step of k = 10\u22123 s; the reference solution is computed using St\u00f6rmer-Verlet, with a time step of k = 2\u221220 u 10\u22126 s. For initial conditions, we set p(0) = 0, and q(0) = [0, 0, 0, \u03b1, 0, 0]\u1d40, for different values of \u03b1. See Figure 1, illustrating c comparison between time histories using the exactly conservative schemes (23) and (34) with St\u00f6rmer-Verlet (18). In all cases, the onset of errors is slightly faster for (23) than for the other schemes, indicating a higher error (see also Figure 3).\nFor the schemes (23) and (34), numerical energy, as defined by (32) and (37) respectively, is conserved to machine precision. See Figure 2, illustrating the relative deviation in energy, as defined in (45), for scheme (23) for the Fermi-Pasta-Ulam system, under the conditions as described above, and for \u03b1 = 100. It is easily seen that the relative error is on the order of machine roundoff error in double-precision floating point, or approximately 10\u221216. Furthermore, it is possible to directly observe the quantisation of the relative energy to the lowest bits in the machine number representation.\nAs a basic test of convergence, consider the L2 error defined, over a simulation duration n = 0, . . . , Nf , by\nError = \u221a\u221a\u221a\u221a Nf\u2211 n=0 k\u2016qn \u2212 qref(t = nk)\u20162 , (49)\nwhere qref are computed using St\u00f6rmer-Verlet with a time step of k = 2\u221220 u 10\u22126 s. The error appears in Figure 3, for the exact energy conserving method in (23), the split potential method in (34), and using St\u00f6rmer-Verlet, over a range of time steps. In this case, the total simulation duration is 1 s, and the initial condition is chosen to be large, with \u03b1 = 100. No regularisation was employed in this case (see Section 2.5). In general, the errors for St\u00f6rmer-Verlet and the split scheme (34) track each other quite closely, with the non-split method (23) performing somewhat worse. Second order accuracy is easily observed in all cases. Stability for St\u00f6rmer-Verlet is dependent on the size of the initial condition; for \u03b1 = 100, the range of time steps over which St\u00f6rmer-Verlet is unstable is indicated in the figure."
        },
        {
            "heading": "4.2 Nonlinear String Vibration",
            "text": "As a second example, consider the motion of a taut string. For sufficiently large displacements, the linear wave equation must be augmented by appropriate nonlinear terms to account for the amplitude-dependent physical phenomena observed during motion. One may obtain a geometrically exact model by considering large strains, and applying Hooke\u2019s law [33]. This model is written compactly as\n\u03c1A\u22022t u = \u2202x ( \u2202V \u2202\u03b6 ) , \u03c1A\u22022t v = \u2202x ( \u2202V \u2202\u03b7 ) . (50)\nHere, u = u(x, t) : D \u00d7 R+0 \u2192 R represents the transverse displacement, for a spatial domain D = [0, L], where L is the length of the unstretched string. Similarly, v = v(x, t) is the longitudinal displacement. In (50), \u2202t and \u2202x represent partial differentiation with respect to time t and spatial coordinate x. Furthermore, we define \u03b6 = \u2202xu, \u03b7 = \u2202xv. The function V = V(\u03b6, \u03b7) : R2 \u2192 R+0 is a non-negative potential density, which may be given in two equivalent forms as\nV(\u03b6, \u03b7) =  EA 2 ( \u03b62 + \u03b72 ) \u2212 (EA\u2212 T0) (\u221a (1 + \u03b7)2 + \u03b62 \u2212 1\u2212 \u03b7 ) , (51a)\nT0 2\n( \u03b62 + \u03b72 ) + EA\u2212 T0\n2\n(\u221a (1 + \u03b7)2 + \u03b62 \u2212 1 )2 . (51b)\nHere, the various constants that appear are: \u03c1, the volume density in kg\u00b7m\u22123; E, Young\u2019s modulus, in kg\u00b7 s\u22122 \u00b7 m\u22121; A, the area of the string cross section in m2; and T0, the applied tension in kg\u00b7\nm \u00b7 s\u22122. It is easy to show that (51a) is the same as (51b), and that V \u2265 0 \u2200 (\u03b6, \u03b7). In (51b), one may easily split V into a quadratic part, plus a non-negative nonlinear term, provided that EA > T0 (a condition that is generally satisfied, for instance by all strings of interest in musical acoustics): ultimately, this allows for numerical solution using a split potential form as described in Section 3.4. Both forms have been used in previous works: (51a) in e.g. [34, 11]; (51b) in [35]. System (50) is Hamiltonian, with the total energy defined by\nH = \u222b D \u03c1A 2 ( (\u2202tu) 2 + (\u2202tv) 2 ) + V dx. (52)\nEnergy conservation holds under a suitable set of boundary conditions. Here, conditions of fixed type are considered, such that u = v = 0 at x = {0, L}."
        },
        {
            "heading": "4.2.1 Semi-discrete Form",
            "text": "The domain D may be divided into segments of length h, the grid spacing. Let M be the total number of segments, yielding M \u2212 1 grid points, not including the end points, where the solution is fixed to zero. The continuous functions u(x, t), v(x, t) may then be approximated by grid functions ul(t), vl(t), at the grid point xl = lh, l = 1, ...,M \u2212 1. Approximations to \u2202x may be given as difference operators, expressed here in terms of their action on a grid function ul(t):\nD+ul = 1\nh (ul+1 \u2212 ul) , D\u2212ul =\n1 h (ul \u2212 ul\u22121) . (53)\nFrom these, one may also define the second difference operator as D2 = D+D\u2212. Furthermore, let \u03b6l = D\u2212ul, \u03b7l = D\u2212vl. A semi-discrete form for (50) is then obtained as\n\u03c1Au\u0308l = D+ ( \u2202Vl \u2202\u03b6l ) , \u03c1Av\u0308l = D+ ( \u2202Vl \u2202\u03b7l ) , (54)\nwhere Vl , V(\u03b6l, \u03b7l). It is convenient to write system (54) compactly using the consolidated state vector q = [u\u1d40,v\u1d40]\u1d40. In this form, the difference operators are represented by matrices, such that D\u2212 becomes the M \u00d7 (M \u2212 1) matrix D\u2212 given in terms of its action on e.g. u as\nD\u2212u = 1\nh ([u\u1d40, 0]\u2212 [0,u\u1d40]). (55)\nThen, define D+ = \u2212D\u1d40\u2212, and D2 = D+D\u2212. In vector form, (54) becomes\n\u03c1Aq\u0308 = 1\nh [ D+\u2207\u03b6V D+\u2207\u03b7V ] , (56)\nwhere \u03b6 = D\u2212u, \u03b7 = D\u2212v. This system conserves the semi-discrete energy of the form (1), with\nM = \u03c1AhI2M\u22122, V = h M\u2211 l=1 Vl. (57)\nHere I2M\u22122 is the (2M \u2212 2)\u00d7 (2M \u2212 2) identity matrix. A proof is obtained immediately by noting that V\u0307 = \u03b6\u0307\u1d40\u2207\u03b6V + \u03b7\u0307\u1d40\u2207\u03b7V = \u2212u\u0307\u1d40D+\u2207\u03b6V \u2212 v\u0307\u1d40D+\u2207\u03b7V = \u2212q\u0307\u1d40 [ D+\u2207\u03b6V D+\u2207\u03b7V ] . (58)\nThus, left-multiplying (56) by hq\u0307\u1d40 yields (57). A split potential form is also available, via (51b). In this case,\nK = \u2212T0h [ D2 0 0 D2 ] , V \u2032 = h(EA\u2212 T0) 2 M\u2211 l=1 (\u221a (1 + \u03b7l)2 + \u03b62l \u2212 1 )2 (59)"
        },
        {
            "heading": "4.2.2 Numerical Methods",
            "text": "System (56) may be integrated in time in a number of ways. First, introduce the discrete time vector qn, approximating q(t) at the time tn = kn. Furthermore, let V n = V (\u03b6n,\u03b7n). An explicit time stepping scheme is obtained by application of the St\u00f6rmer-Verlet algorithm:\nqn+1 = 2qn+1 \u2212 qn\u22121 + k 2\n\u03c1Ah [ D+\u2207\u03b6nV n D+\u2207\u03b7nV n ] . (60)\nWhile simple, this scheme does not conserve a positive discrete energy, and instabilities may occur at large displacements. A stable scheme may be obtained by an energy-conserving discretisation of the gradient [36, 37]:\nqn+1 = 2qn+1 \u2212 qn\u22121 + k 2\n\u03c1A\n[ D+ g n \u03b6\nD+ g n \u03b7\n] (61)\nwhere the discrete gradients are defined as\n(gn\u03b6 )l = V(\u03b6n+1l , \u03b7nl )\u2212 V(\u03b6 n\u22121 l , \u03b7 n l )\n\u03b6n+1l \u2212 \u03b6 n\u22121 l\n, (gn\u03b7)l = V(\u03b6nl , \u03b7 n+1 l )\u2212 V(\u03b6nl , \u03b7 n\u22121 l )\n\u03b7n+1l \u2212 \u03b7 n\u22121 l\n, (62)\nwith l = 1, ..,M . This scheme leads to discrete energy conservation, and unconditional stability, but it is fully implicit, and will generally require the use of iterative root finding routines such as Newton-Raphson [37].\nFinally, scheme (23) results from Hamiltonian (1) with definitions (57). The split-potential form (34) is also available, via (59). In the latter case, a stability condition arises as per (40), such that\nk \u2264 \u221a \u03c1A/T0 h. (63)\nThis is the standard Courant-Friedrichs-Lewy stability condition for the one-dimensional linear wave equation [38]."
        },
        {
            "heading": "4.2.3 Numerical Results",
            "text": "As a first example, let the string be initialised in its first linear mode of vibration in the transverse direction, that is\nu(x, 0) = \u03b1 \u221a A sin(\u03c0x/L), v(x, 0) = 0, (64)\nand let the initial velocity be zero for both transverse and longitudinal motion. The amplitude parameter \u03b1 is nondimensional. The string parameters are taken from [39], for the C3 piano string, and are: \u03c1 = 7850 kg m\u22123; A = 8.87 \u00b710\u22127 m2; L = 1.259 m; E = 2.02 \u00b71011 kg\u00b7 s\u22122 \u00b7 m\u22121; T0 = 759 kg\u00b7 m \u00b7 s\u22122. Figure 4 shows snapshots of the computed solution using scheme (34), and under various initial amplitudes \u03b1. In this case, a regularisation of the potential energy V \u2032 is employed (see Section 2.5), with a shift of = 108. Typical amplitude-dependent phenomena are visible: the frequency of vibration increases with the initial amplitude, and the initial shape deforms progressively.\nIn Figure 5, the output waveform of scheme (34) are checked against a reference solution obtained using the St\u00f6rmer-Verlet algorithm (60), for the large input amplitude \u03b1 = 300, indicating that the output of the two schemes converges to a common solution.\nThe relative energy error, as defined in (45), is shown in Figure 6, showing conservation to near machine accuracy. The larger range of variation here, compared with the case of the Fermi-PastaUlam system is a result of the much larger state size and the resulting accumulation of errors. Notice in particular that here, in contrast to the case of the Fermi-Pasta-Ulam system, even though the energy variation is extremely small, there is now a clear correlation with the numerical solution. Such an effect is highly dependent on finite wordlength effects in double precision floating point, including the precise order of operations in the final update, and within the expression used to calculate the relative error (45), and is not well understood.\nFigure 7 presents the compute times for schemes (60), (61) and (34). The fully implicit, conservative scheme (61) is the slowest, requiring a few iterations of the Newton-Raphson routine per time step. The proposed scheme (34) has compute times of the same order of magnitude as the fully explicit St\u00f6rmer-Verlet algorithm, and a few orders of magnitude smaller than the fully implicit scheme. All simulations were run in Matlab, using a 2016 MacBook Pro with a 2.9 GHz Quad-Core Intel Core i7 chip."
        },
        {
            "heading": "4.3 Nonlinear Plate Vibration: The F\u00f6ppl-von K\u00e1rm\u00e1n System",
            "text": "As a final example, consider the problem of the transverse vibration of a thin plate at high amplitudes. A commonly used model is the so-called dynamic analogue of the F\u00f6ppl-von K\u00e1rm\u00e1n equations (see, e.g., [40, 41, 42]), that have been used extensively recently in studies of wave turbulence [43, 44, 45]. Time-stepping methods have been developed [46], including a linearly-implicit energy-conserving method [47].\nThough the dynamic F\u00f6ppl-von K\u00e1rm\u00e1n equations can be written directly in Hamiltonian form, they are most commonly presented as the following pair of coupled partial differential equations:\n\u03c1\u03be\u22022t q = \u2212Q\u2206\u2206q + L(q, F ) 2\nE\u03be \u2206\u2206F = \u2212L(q, q) . (65)\nHere, q(x, y, t) and F (x, y, t) are the transverse displacement of the plate and Airy stress function respectively; both are functions of spatial coordinates (x, y) \u2208 D \u2282 R2, and time t \u2265 0. In this\nsimple example, the spatial domain D will be taken to be the square of side length L m, so that D = [0, L]2. \u2202t and \u2206 represent partial differentiation with respect to time t and the 2D Laplacian operator, respectively. \u2206\u2206 is thus the biharmonic operator. For simplicity, boundary conditions are assumed to be of simply supported type over the boundary \u2202D of D, so that\nq = \u2206q = 0 F = \u2206F = 0 over \u2202D . (66)\nThe various constants that appear in (65) are: \u03c1, the material density, in kg\u00b7 m\u22123; \u03be, the plate thickness, in m; E, Young\u2019s modulus, in kg\u00b7 s\u22122 \u00b7 m\u22121; and the flexural rigidity Q = E\u03be3/12(1\u2212\u03bd2), where \u03bd is Poisson\u2019s ratio for the plate material. L is a bilinear operator, defined in terms of its\naction on two functions f(x, y) and g(x, y) as\nL(f, g) = \u22022xf\u22022yg + \u22022yf\u22022xg \u2212 2\u2202x\u2202yf\u2202x\u2202yg , (67)\nwhere \u2202x and \u2202y represent partial differentiation with respect to x and y, respectively. Notice that only the first of (65) is dynamic; the pair of equations (65) could be rewritten as a single equation in displacement q alone, and would constitute a second order in time cubic nonlinear PDE.\nSystem (65) is Hamiltonian, with the total energy defined by\nH = \u222b\u222b D \u03c1\u03be 2 (\u2202tq) 2 + Q 2 (\u2206q)2 + 1 2E\u03be (\u2206F )2d\u03c3 . (68)\nThis particular form of the energy holds under fixed edge boundary conditions, (such as simply supported (66)), and must be modified under other types of conditions, such as free-edge. Notice that the final two terms under the integral above, which correspond to the potential energy, separate into a quadratic form in q, representing stored energy due to linear effects, and a quadratic form in F , representing additional nonlinear effects; both terms are individually non-negative, signalling that in numerical design, a splitting of the form described in Section 2.4 is available."
        },
        {
            "heading": "4.3.1 Semi-discrete Form",
            "text": "For the square region D, of side length L, one may start by defining grid locations xl = lh, ym = mh, where l,m = 1, . . . ,M \u2212 1, for some integer M such that M = L/h, where h is a grid spacing. The semi-discrete grid functions ql,m(t) and Fl,m(t) thus represent approximations to q(x, y, t) and F (x, y, t) at x = xl and y = ym, respectively.\nApproximations to the spatial derivative operators \u2202x and \u2202y may be written, in terms of their action on a grid function ul,m(t) (such as ql,m or Fl,m as defined above), as\nDx\u00b1ul,m = \u2213 1\nh (ul,m \u2212 ul\u00b11,m) Dy\u00b1ul,m = \u2213\n1 h (ul,m \u2212 ul,m\u00b11) . (69)\nUnder simply supported conditions, when grid points outside the range l,m = 1, . . . ,M \u2212 1 are referred to in the definitions above, such values are assumed to be zero. These are the most basic forward and backward approximations to derivatives, but are sufficient for the present purposes\u2014 more elaborate approximations (such as those of spectral type [48]) are available.\nFrom the basic operations defined in (69), centered approximations to the Laplacian \u2206 and biharmonic operator \u2206\u2206 follow as\nD\u2206 = Dx+Dx\u2212 +Dy+Dy\u2212 D\u2206\u2206 = D\u2206D\u2206 . (70)\nIt is important to note that this particular construction of the biharmonic approximation D\u2206\u2206, through a product of Laplacian approximations D\u2206 under fixed conditions ensures that the simply supported conditions (66) are satisfied.\nA semi-discrete approximation to (65) then follows as\n\u03c1\u03beq\u0308l,m = \u2212QD\u2206\u2206ql,m + `(q, F ) = 0 2\nE\u03be D\u2206\u2206Fl,m = \u2212`(q, q) . (71)\nThe operator `(\u00b7, \u00b7) approximates L(\u00b7, \u00b7), as defined in (67). One useful centered approximation, operating on two grid functions fl,m and gl,m is [47]:\n`(f, g) = Dx+Dx\u2212fDy+Dy\u2212g +Dy+Dy\u2212fDx+Dx\u2212g\n\u2212 12Dx+Dy+fDx+Dy+g \u2212 1 2Dx+Dy\u2212fDx+Dy\u2212g \u2212 1 2Dx\u2212Dy+fDx\u2212Dy+g \u2212 1 2Dx\u2212Dy\u2212fDx\u2212Dy\u2212g .\nIt is useful to represent the semi-discrete ODE system (71) in vector form, using (M \u2212 1)2 \u00d7 1 vectors q and F. In this representation, the operators Dx+ and Dy+ become (M \u2212 1)2\u00d7M(M \u2212 1) matrices Dx+ and Dy+, and Dx\u2212 = \u2212D\u1d40x+ and Dy\u2212 = \u2212D \u1d40 y+. The operators D\u2206 and D\u2206\u2206 become (M \u2212 1)2 \u00d7 (M \u2212 1)2 matrices D\u2206 and D\u2206\u2206 respectively. One arrives at the form\n\u03c1\u03beq\u0308 = \u2212QD\u2206\u2206q + `(q,F) = 0 2\nE\u03be D\u2206\u2206F = \u2212`(q,q) . (72)\nThis second order in time ODE system serves as the starting point for methods such as St\u00f6rmerVerlet and other linearly-implicit energy-conserving methods, as described below.\nBy introducing the momentum variable p = Mq\u0307, the first order system (3) equivalent to (72) results from a Hamiltonian of the form of (1), with N = (M \u2212 1)2, and where\nM = \u03c1\u03beh2I(M\u22121)2 V = Qh2\n2 \u2016D\u2206q\u20162 +\nh2\n2E\u03be \u2016D\u2206F\u20162 . (73)\nHere, I(M\u22121)2 is the (M \u22121)2\u00d7 (M \u22121)2 identity matrix. A natural splitting of the potential energy V as in (14) follows, with\nK = Qh2D\u2206\u2206 V \u2032 =\nh2\n2E\u03be \u2016D\u2206F\u20162 . (74)"
        },
        {
            "heading": "4.3.2 Numerical Methods",
            "text": "Beginning from the second order system (72), one may introduce the discrete time vectors qn and Fn, representing approximations to q and F at t = nk, for integer n, and where k is the time step in s. St\u00f6rmer-Verlet integration results immediately in:\nqn+1 = ( 2I(M\u22121)2 \u2212 Qk2\n\u03c1\u03be D\u2206\u2206\n) qn\u2212qn\u22121 + k 2\n\u03c1\u03be `(qn,Fn)\n2\nE\u03be D\u2206\u2206F\nn = \u2212`(qn,qn) . (75)\nThe first of these updates is explicit, but relies on Fn, which must be obtained from the second equation through the solution of a linear system involving the biharmonic operator D\u2206\u2206.\nThe St\u00f6rmer-Verlet scheme above is not conservative, and is prone to numerical instability. A slight variant, however, leads to a scheme with exact energy conservation:\nqn+1 = ( 2I(M\u22121)2 \u2212 Qk2\n\u03c1\u03be D\u2206\u2206\n) qn \u2212 qn\u22121 + k 2\n2\u03c1\u03be `(qn,Fn+1 + Fn\u22121) (76a)\n1\nE\u03be D\u2206\u2206\n( Fn+1 + Fn ) = \u2212`(qn+1,qn) . (76b)\nDue to the bilinearity of the operator `, this scheme is linearly implicit\u2014at each time step, qn+1 and Fn+1 must be solved simultaneously, using a linear system constructed anew at each time step; St\u00f6rmer-Verlet, in contrast, requires only the solution of a linear system in D\u2206\u2206, which is of a known form. Thus it may be expected that scheme (76), while energy-conserving and provably numerically stable [47], is significantly slower to execute than the St\u00f6rmer-Verlet scheme (75).\nFinally, from the Hamiltonian form given in (3), with V and M as given in (73), as well as the splitting of the potential energy as in (74), a time-interleaved scheme of the form (34) results. This scheme possesses a non-negative exactly conserved numerical energy under the condition (40) which, in this case, reduces to a lower bound on the grid spacing h in terms of the time step k:\nh \u2265 hmin = 2 \u221a k (D/\u03c1\u03be) 1 4 . (77)\nThe scheme, like St\u00f6rmer-Verlet, relies on a linear system solution involving the biharmonic operator D\u2206\u2206, but is otherwise explicit."
        },
        {
            "heading": "4.3.3 Numerical Examples",
            "text": "As an example, consider initialisation of the F\u00f6ppl-von K\u00e1rm\u00e1n system (65) through its lowest linear mode shape:\nq(x, y, 0) = \u03b1\u03be sin(\u03c0x/L) sin(\u03c0y/L) \u2202tq|x,y,t=0 = 0 , (78)\nwhere the dimensionless parameter \u03b1 controls the maximum amplitude of the initial condition relative to the plate thickness \u03be. Furthermore, the plate is assumed to be made of steel with E = 2\u00d71011 Pa, \u03c1 = 7850 kg\u00b7 m\u22123, and \u03bd = 0.3, and to be of thickness \u03be = 2 mm and side length L = 0.5 m.\nUsing the scheme (34), with the grid spacing and time step chosen according to (77), typical amplitude-dependent behaviour is observed. See Figure 8. At a low initial condition amplitude of \u03b1 = 0.01, behaviour is essentially linear. At amplitudes near the plate thickness at \u03b1 = 2, the period of oscillation decreases, and spontaneous mode generation is observed, and for large amplitudes, such as \u03b1 = 10, turbulent behaviour is observed. Under such stringent high-amplitude conditions (\u03b1 = 10), scheme (34) remains stable, and results converge to those of the reference solution, computed using St\u00f6rmer-Verlet with a time step of k = 2.5\u00d710\u22126 s. No regularisation (see Section 2.5) is used in this case. See Figure 9. Under these conditions, St\u00f6rmer-Verlet is unstable for k > 2\u00d7 10\u22125 s.\nThe simulation of the F\u00f6ppl-von K\u00e1rm\u00e1n system is computationally intensive. Most interesting in this case is a comparison of computation times between St\u00f6rmer-Verlet (75), the linearly-implicit energy-conserving method (76), and the explicit energy-conserving scheme (34). Unavoidable in all\ncases is some form of linear system solution; for (75) and (34), this will involve the biharmonic operator, which is constant over the course of a simulation, and thus amenable to factorisation techniques (e.g. Cholesky) to decrease solution times. For the linearly-implicit exact energy conserving method (76), however, this is not the case\u2014the linear system to be solved must be constructed anew at each time step. This is reflected in timings, as shown in Figure 10, for simulations of 1 second for different choices of time step k. Computation was performed in Matlab on a Lenovo P50 with an Intel Xeon E3 v5. As can be seen, computation time for the explicit scheme (34) is far lower than for scheme (76), and very nearly on par with St\u00f6rmer-Verlet.\nFinally, see Figure 11, illustrating the relative energy variation for scheme (34) for the F\u00f6ppl-von K\u00e1rm\u00e1n plate; as in the case of nonlinear string vibration, the energy variation is of the order of 10\u221215, with some correlation with the numerical solution visible\u2014see Figure 6 for comparison."
        },
        {
            "heading": "5 Concluding Remarks",
            "text": "The design of exactly energy-conserving methods for Hamiltonian systems has progressed from fully implicit designs through, more recently, to explicit methods for which exact energy conservation can be attained through an approximation to a continuous integral of the potential energy, or, more\nimportantly, to linearly implicit designs based on invariant energy quadratisation. The main novelty in this paper is to call attention to structure within such linearly implicit designs\u2014structure that can be exploited in order arrive at fully explicit methods. These exactly conservative methods are of roughly the same computational cost as the most efficient non-conservative explicit methods\u2014with the additional feature of a clear means of ensuring numerical stability, either unconditionally, or, if a splitting of the potential energy is employed, under well-defined conditions on the time step that are independent of the initial conditions. Accuracy is of second order, and is plainly evident in the centered (but interleaved) discretisation approach, and borne out by simulation results (see Section 4.1). It is not clear whether it is possible to extend this framework to obtain higher order accuracy.\nThese methods are not completely general, and require, additionally, a condition of non-negativity on the potential energy, as per invariant energy quadratisation approaches. More generally, given that the dynamics of a system are independent of shifts in the potential energy by a constant (i.e., a gauge), a more general condition is that the potential energy is bounded from below. The useful technique of splitting of the potential energy introduced here is a further restriction. But the restriction (6) mentioned above to non-negative expressions for potential energy V (or bounded from below) is slightly more strict than necessary. More general is a restriction to expressions V (q) that are single-signed for all q\u2014and even more generally, bounded either from above or below. An important example here is the N -body problem, under a gravitational potential, for which V (q) \u2264 0. In this case, one may set, instead of (9), V = \u2212 12\u03c8\n2, and the main development follows as above, with this sign change, and an explicit exactly energy conserving method follows as before. In this case, however, global bounds on solution size are not available, as the total energy itself is no longer necessarily non-negative. See the comments in [26] regarding general dynamic stability for Hamiltonian systems.\nOnly briefly alluded to here, in Section 3.5, is the extension to the case of variable time steps\u2014 useful in modeling systems with slow/fast dynamics, as discussed in [11]. The behaviour of such schemes remains unexplored. Another open question is the need for regularization, as introduced in Section 2.5. In two of the three cases presented here, the Fermi-Pasta-Ulam problem, and the F\u00f6ppl-von K\u00e1rm\u00e1n system, good results were obtained without the use of such regularisation. In the case of string vibration, however, such regularisation was necessary. It would be of great interest to know the origin of this distinction. In all cases, however, regularisation has no impact on the explicit nature of the schemes proposed here, and only negligible impact on computational cost."
        },
        {
            "heading": "Acknowledgments",
            "text": "M. Ducceschi was supported by the European Research Council (ERC), under grant 2020-StG950084-NEMUS. For the purpose of open access, the first author has applied a creative commons attribution (CC BY) licence to any author accepted manuscript version arising."
        }
    ],
    "title": "Explicit Exactly Energy-conserving Methods for Hamiltonian Systems",
    "year": 2022
}