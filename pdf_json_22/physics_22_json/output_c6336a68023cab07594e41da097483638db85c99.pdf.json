{
    "abstractText": "In this work isogeometric mortaring is used for the simulation of a six pole permanent magnet synchronous machine. Isogeometric mortaring is especially well suited for the efficient computation of rotating electric machines as it allows for an exact geometry representation for arbitrary rotation angles without the need of remeshing. The appropriate B-spline spaces needed for the solution of Maxwell\u2019s equations and the corresponding mortar spaces are introduced. Unlike in classical finite element methods their construction is straightforward in the isogeometric case. The torque in the machine is computed using two different methods, i.e., Arkkio\u2019s method and by using the Lagrange multipliers from the mortaring.",
    "authors": [
        {
            "affiliations": [],
            "name": "Melina Merkel"
        },
        {
            "affiliations": [],
            "name": "Bernard Kapidani"
        },
        {
            "affiliations": [],
            "name": "Sebastian Sch\u00f6ps"
        },
        {
            "affiliations": [],
            "name": "Rafael V\u00e1zquez"
        }
    ],
    "id": "SP:8aacb9c872c9303391a0423a15c8835358442f18",
    "references": [
        {
            "authors": [
                "P.T. Boggs",
                "A. Althsuler",
                "A.R. Larzelere",
                "E.J. Walsh",
                "R.L. Clay",
                "M.F. Hardwick"
            ],
            "title": "DART system analysis",
            "venue": "Sandia National Laboratories, Technical Report, Aug. 2005.",
            "year": 2005
        },
        {
            "authors": [
                "H. De Gersem",
                "T. Weiland"
            ],
            "title": "Harmonic weighting functions at the sliding interface of a finite-element machine model incorporating angular displacement",
            "venue": "IEEE Trans. Magn., vol. 40, no. 2, pp. 545\u2013548, Mar. 2004.",
            "year": 2004
        },
        {
            "authors": [
                "B. Davat",
                "Z. Ren",
                "M. Lajoie-Mazenc"
            ],
            "title": "The movement in field modeling",
            "venue": "IEEE Trans. Magn., vol. 21, no. 6, pp. 2296\u20132298, Nov. 1985.",
            "year": 1985
        },
        {
            "authors": [
                "H.C. Lai",
                "D. Rodger",
                "P.J. Leonard"
            ],
            "title": "Coupling meshes in 3D problems involving movements",
            "venue": "IEEE Trans. Magn., vol. 28, no. 2, pp. 1732\u20131734, Mar. 1992.",
            "year": 1992
        },
        {
            "authors": [
                "G.J. Wallinger"
            ],
            "title": "A method to couple non-conforming finite element meshes",
            "venue": "Dissertation, TU Graz, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "S. Kurz",
                "J. Fetzer",
                "G. Lehner"
            ],
            "title": "An improved algorithm for the BEM-FEM-coupling method using domain decomposition",
            "venue": "IEEE Trans. Magn., vol. 31, no. 3, pp. 1737\u20131740, 1995.",
            "year": 1995
        },
        {
            "authors": [
                "K. Roppert",
                "S. Schoder",
                "F. Toth",
                "M. Kaltenbacher"
            ],
            "title": "Non-conforming Nitsche interfaces for edge elements in curl\u2013curl-type problems",
            "venue": "IEEE Trans. Magn., vol. 56, no. 5, pp. 1\u20137, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "A. Buffa",
                "F. Rapetti"
            ],
            "title": "A sliding mesh-mortar method for a twodimensional eddy currents model of electric engines",
            "venue": "M2AN, 1999.",
            "year": 1999
        },
        {
            "authors": [
                "F. Bouillault",
                "A. Buffa",
                "Y. Maday",
                "F. Rapetti"
            ],
            "title": "The mortar edge element method in three dimensions: applications to magnetostatics",
            "venue": "SIAM J. Sci. Comput., vol. 24, no. 4, pp. 1303\u20131327, 2001.",
            "year": 2001
        },
        {
            "authors": [
                "E. Lange"
            ],
            "title": "Numerische Werkzeuge zur Simulation von nichtsinusf\u00f6rmig gespeisten geregelten elektrischen Maschinen im dynamischen Betrieb",
            "venue": "Dissertation, RWTH Aachen, Dec. 2012.",
            "year": 2012
        },
        {
            "authors": [
                "T.J.R. Hughes",
                "J.A. Cottrell",
                "Y. Bazilevs"
            ],
            "title": "Isogeometric analysis: CAD, finite elements, NURBS, exact geometry and mesh refinement",
            "venue": "CMAME, vol. 194, pp. 4135\u20134195, 2005.",
            "year": 2005
        },
        {
            "authors": [
                "A. Buffa",
                "R.H. V\u00e1zquez",
                "G. Sangalli",
                "L.B. da Veiga"
            ],
            "title": "Approximation estimates for isogeometric spaces in multipatch geometries",
            "venue": "Numer. Meth. Part. Differ. Equat., vol. 31, no. 2, pp. 422\u2013438, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "Z. Bontinck",
                "J. Corno",
                "S. Sch\u00f6ps",
                "H. De Gersem"
            ],
            "title": "Isogeometric analysis and harmonic stator-rotor coupling for simulating electric machines",
            "venue": "CMAME, vol. 334, pp. 40\u201355, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "L.A.J. Friedrich",
                "B.L.J. Gysen",
                "J.W. Jansen",
                "E.A. Lomonova"
            ],
            "title": "Analysis of motional eddy currents in the slitted stator core of an axialflux permanent-magnet machine",
            "venue": "IEEE Trans. Magn., vol. 56, no. 2, pp. 1\u20134, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "M. Merkel",
                "P. Gangl",
                "S. Sch\u00f6ps"
            ],
            "title": "Shape optimization of rotating electric machines using isogeometric analysis",
            "venue": "IEEE Trans. Energ. Convers., Feb. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "A. Buffa",
                "J. Corno",
                "C. de Falco",
                "S. Sch\u00f6ps",
                "R. V\u00e1zquez"
            ],
            "title": "Isogeometric mortar coupling for electromagnetic problems",
            "venue": "SIAM J. Sci. Comput., vol. 42, no. 1, pp. B80\u2013B104, Jan. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "B. Kapidani",
                "M. Merkel",
                "S. Sch\u00f6ps",
                "R. V\u00e1zquez"
            ],
            "title": "Tree-cotree decomposition of isogeometric mortared spaces in h(curl) on multi-patch domains",
            "venue": "Cornell University, Preprint arxiv:2110.15860, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "A. Arkkio"
            ],
            "title": "Analysis of induction motors based on the numerical solution of the magnetic field and circuit equations",
            "venue": "PhD Thesis, Helsinki University of Technology, 1987.",
            "year": 1987
        },
        {
            "authors": [
                "E. Cohen",
                "R.F. Riesenfeld",
                "G. Elber"
            ],
            "title": "Geometric Modeling with Splines: An Introduction",
            "year": 2001
        },
        {
            "authors": [
                "L. Beir\u00e3o da Veiga",
                "A. Buffa",
                "G. Sangalli",
                "R. V\u00e1zquez"
            ],
            "title": "Mathematical analysis of variational isogeometric methods",
            "venue": "Acta Numerica, vol. 23, pp. 157\u2013287, May 2014.",
            "year": 2014
        },
        {
            "authors": [
                "P. Dlotko",
                "B. Kapidani",
                "R. Specogna"
            ],
            "title": "Topoprocessor: An efficient computational topology toolbox for h-oriented eddy current formulations",
            "venue": "IEEE Trans. Magn., vol. 53, no. 6, pp. 1\u20134, Jun. 2017.",
            "year": 2017
        },
        {
            "authors": [
                "F. Henrotte",
                "M. Felden",
                "M. van der Giet",
                "K. Hameyer"
            ],
            "title": "Electromagnetic force computation with the eggshell method",
            "venue": "14th International IGTE Symposium,2010.",
            "year": 2010
        }
    ],
    "sections": [
        {
            "text": "\u00a92022 IEEE. Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses, in any current or future media, including reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for resale or redistribution to servers or lists, or reuse of any copyrighted component of this work in other works.\nTorque Computation with the Isogeometric Mortar Method for the Simulation of Electric Machines\nMelina Merkel1,2, Bernard Kapidani3, Sebastian Scho\u0308ps1,2, and Rafael Va\u0301zquez3 1Computational Electromagnetics Group, Technische Universita\u0308t Darmstadt, 64289 Darmstadt, Germany 2Centre for Computational Engineering, Technische Universita\u0308t Darmstadt, 64289 Darmstadt, Germany\n3Chair of Numerical Modelling and Simulation, E\u0301cole Polytechnique Fe\u0301de\u0301rale de Lausanne, 1015 Lausanne, Switzerland\nIn this work isogeometric mortaring is used for the simulation of a six pole permanent magnet synchronous machine. Isogeometric mortaring is especially well suited for the efficient computation of rotating electric machines as it allows for an exact geometry representation for arbitrary rotation angles without the need of remeshing. The appropriate B-spline spaces needed for the solution of Maxwell\u2019s equations and the corresponding mortar spaces are introduced. Unlike in classical finite element methods their construction is straightforward in the isogeometric case. The torque in the machine is computed using two different methods, i.e., Arkkio\u2019s method and by using the Lagrange multipliers from the mortaring.\nIndex Terms\u2014electric machines, isogeometric analysis, magnetostatics, mortaring, numerical simulation, splines, torque\nI. INTRODUCTION\nDue to the rise of e-mobility and the increased use of electric motors, there is large need for the simulation of machines. A bottleneck in the design workflow is the treatment of geometry and meshing. Up to 75 % of the simulation time is spent on modeling and geometry discretization [1]. The reason is that most simulations are carried out using the classical Finite Element Method (FEM) which uses element-wise polynomial mappings of (curved) triangulations of the geometry. Those mappings cannot exactly describe conic sections and since common machines have a cylindrical structure, a geometry error is introduced. This is particularly inconvenient in the airgap where the fields are of highest interest.\nCommonly, rotation is enabled by a cut in the air gap and a domain decomposition into rotor and stator is applied. Many methods have been proposed in the literature for handling the resulting non-matching discretizations, e.g. \u2018locked step\u2019, \u2018sliding surface\u2019, \u2018moving band\u2019 and \u2018harmonic coupling\u2019 approaches, see for example [2], [3], [4], [5]. Also, boundary element coupling is a viable option to consider motion [6]. Finally, Nitsche [7] and mortaring methods [8], [9] have been proposed. In particular, mortaring is commonly considered to be more complex in its implementation and computationally heavier at run-time, but accounts for the trace spaces in a mathematically correct way.\nAll \u2018sliding\u2019 methods share the the problem of geometric mismatch at the interface, see Figure 1. This may lead to numerical noise which is particular cumbersome when analyzing cogging torque. When using conventional finite elements this can be mitigated by mesh adaptation, see [10, Section 5.4] and similarly [5, Section 5.2.3]. The geometry error can be avoided when using Isogeometric Analysis (IGA) [11] which uses B-Splines and Non-Uniform Rational B-Splines (NURBS) for both the geometry representation (as weighting functions on a structured list of control points, defining a control mesh) and as basis functions for test-spaces and discretization. Classically, a conforming multipatch discretization is needed for IGA [12].\nWhile IGA has been used for machine models in the past, e.g., [13], [14], [15], this paper presents the first isogeometric simulation workflow for rotating machines with focus on torque computation. To implement rotation efficiently, we extend the isogeometric mortar method from [16] and use a tree-cotree regularization [17].\nThe paper is structured as follows; we discuss the mathematical model in Section II and the discretization using IGA in Section III. Mortaring and tree-cotree regularization are introduced in Sections III-A and III-B, respectively. Different methods for torque computation are given in Section IV. Finally, numerical results are presented in Section V and the paper is closed by conclusions in Section VI."
        },
        {
            "heading": "II. MATHEMATICAL MACHINE MODEL",
            "text": "The electromagnetic behavior of electric machines can be described by Maxwell\u2019s equations. Under common assumptions, the magnetostatic approximation can be employed. Using a magnetic vector potential A, such that B = curlA, the problem in a 3D domain \u2126 can be written as\ncurl (\u03bd curlA) = Jsrc + curlM, (1)\nar X\niv :2\n20 2.\n05 77\n1v 1\n[ cs\n.C E\n] 1\n1 Fe\nb 20\n22\nwhere \u03bd is the magnetic reluctivity, Jsrc is a source current density and M is the magnetization of permanent magnets. The weak formulation can be derived as: find A \u2208 V , s.t.\n(\u03bd curlA, curlv)\u2126 \u2212 (\u03bd curlA\u00d7 n,v)\u2202\u2126 = (Jsrc,v)\u2126 \u2212 (M, curlv)\u2126,\n(2)\nfor all basis functions v \u2208 V , where V \u2282 H(curl; \u2126), fulfill the boundary conditions on \u2202\u2126.\nLet us consider the case of a circular rotating machine. We introduce a cut within the air gap \u2126air decomposing the domain into \u2126 = \u21261 \u222a\u21262 for stator/rotor. We call the interface \u039312 = \u2202\u21261 \u2229 \u2202\u21262 \u2282 \u2126air with normal vector n12 and denote the air gap pieces by \u2126air,i = \u2126i \u2229 \u2126air. The angle \u03b1 encodes the angular offset between rotor and stator due to motion. Then, we may choose any closed surface S that is contained in the air gap, e.g., the lateral cylinder surface S = \u039312 to compute the torque, [18, p. 55f]. It can be parametrized conveniently by a cylindrical coordinate system with (constant) radial distance r = R, angle \u03b8 \u2208 [0, 2\u03c0] and axial coordinate z \u2208 [0, lz] where lz is the length of the machine. Now, the torque can be computed as the surface integral, see e.g. [18, eq. (121)]\nT\u03b8(\u03b1) = lz\u222b 0 2\u03c0\u222b 0 Br(\u03b1)H\u03b8(\u03b1)R 2 d\u03b8 dz, (3)\nwhere Br(\u03b1) and H\u03b8(\u03b1) are the radial and angular components of the magnetic flux density B and field strength H = \u03bdB for each rotor angle \u03b1, respectively. Note, that we dropped the spatial coordinates and transforms for readability.\nIII. ISOGEOMETRIC ANALYSIS The geometry is defined by one or several trivariate B-splines or NURBS mappings [19] from a reference domain \u2126\u0302 = (0, 1)3 to the physical domain \u2126. For geometries which cannot be represented by a regular mapping a conforming multipatch model can be used where the geometry of each patch is defined by a separate trivariate mapping. Following the usual notation, B-splines of degree p are defined from the knot vector\n\u039e = [\u03be1, . . . , \u03ben+p+1] 0 \u2264 \u03bei \u2264 \u03bei+1 \u2264 1, (4)\nusing the Cox-De Boor recursion formula [19], where n is the number of functions. Let us denote by B\u0302pi the i-th basis function of degree p on the reference domain (0, 1) and define the trivariate space of B-splines as\nSp1,p2,p3(\u039e1,\u039e2,\u039e3) =\nspan { 3\u220f k=1 B\u0302pkik (\u039ek) \u2223\u2223\u2223 1 \u2264 ik \u2264 nk} . (5)\nAs we need edge element basis functions for the solution of (2), we require a curl-conforming spline space. For simplicity we assume that the polynomial degree is the same in all parametric directions, i.e., p = p1 = p2 = p3. Following [16], we define the corresponding spline space in the reference domain \u2126\u0302 as\nS1p(\u2126\u0302) = Sp\u22121,p,p(\u039e \u2032 1,\u039e2,\u039e3)\n\u00d7 Sp,p\u22121,p(\u039e1,\u039e\u20322,\u039e3) \u00d7 Sp,p,p\u22121(\u039e1,\u039e2,\u039e\u20323),\n(6)\nwhere \u039e\u2032j = [\u03be j 2, . . . , \u03be j nj+p] for j = 1, 2, 3 is a modified knot vector with the first and last knot removed. This corresponds to lowering the degree and regularity of the basis functions by one in the j-th direction. Then, considering the geometry mappings and their Jacobians, the multipatch spline spaces in the physical domain \u2126 are defined by push-forwards. We obtain\nV := S1p(\u2126), M12 := \u03b3\u22a5,\u039312(S 1 q (\u21261)), (7)\nwith the trace operator \u03b3\u22a5,\u039312(u) := u\u00d7n12 restricted to \u039312. A stable mortar space M12 for the multiplier can be easily created by lowering its degree by an odd number with respect to the edge-element space of the vector potential, e.g., q = p\u22121 by removing knots from (4). Boundary conditions on \u2202\u2126 may still be implemented. Note that these spline spaces are part of a de Rham complex [16].\nA. Mortaring\nStator \u21261 and rotor \u21262 are modeled independently and are glued for angle \u03b1 using our isogeometric mortar method [16]. Note that we will drop the \u03b1 dependency for readability if possible. The coupling is realized by introducing a Lagrange multiplier\n\u03bb = \u03bd curlA\u00d7 n12,\nto (2), where n12 is the normal vector on \u039312, yielding the following problem: find u \u2208 V , \u03bb \u2208M12 such that\na(u,v)\u2126 + b(v,\u03bb)\u039312 = f(v)\u2126 (8)\nb(u,\u00b5)\u039312 = 0 (9)\nfor all v \u2208 V and \u00b5 \u2208M12 and the bilinear forms\na(u,v)\u2126 := 2\u2211 k=1 (\u03bd curlu, curlv)\u2126k , (10) b(u,\u00b5)\u039312 := ([\u03b312(u)],\u00b5)\u039312 (11)\nand right-hand-side\nf(v)\u2126 := 2\u2211 k=1 (Jsrc,v)\u2126k \u2212 (M, curlv)\u2126k (12)\nwhere \u03b312(u) = (n12 \u00d7 u) \u00d7 n12 and the brackets [\u00b7] denote the jump across the interface \u039312.\nSpectral correctness and inf-sup stability of the saddle-point problem (8-9) for adequate choices of the spaces have been recently proven in [16]. This is a significant advantage of isogeometric mortaring compared to other mortar variants, e.g., using conventional finite elements with rather complicated constructions of dual basis functions. One key issue is the construction of an intersection mesh in the reference domain \u0393\u0302 for the numerical quadrature of the integral (11), see Fig. 3. This is also straightforward due to the tensor product structure of the spaces.\nB. Tree-Cotree Regularization\nThe removal of the (discrete) kernel of the curl operator is a necessary requirement for the well-posedness of formulation (8)\u2013(9). In particular, the matrix discretizing (10) will be singular on each subdomain of the domain decomposition. A popular way to amend the issue in low order FEM (p = 1) is to set the solution a priori on the spanning tree of edges in the vertex-edge mesh graph. This works because of the discrete degrees of freedom (DoFs) correspondence to line integrals on edges of the FEM mesh, which in turn easily permits to identify the gradient subspace of V .\nUnfortunately, in the IGA setting just as in FEM, as soon as p > 1, the DoFs of V will lose their physical interpretation. Nevertheless, as noted in the literature [20] the basis functions of the spline spaces Skp (\u2126) in the discrete de Rham sequence can be identified with k\u2212dimensional entities of the underlying piecewise affine control mesh, i.e., with vertices, edges, facets, and cells for k = 0, 1, 2 and 3, respectively. Because of these one-to-one correspondences, it suffices to apply the algorithm for the tree and cotree construction to the control mesh graph itself, and identify the corresponding B-spline functions. Very conveniently, this observation holds also for different boundary conditions and in the case of non-contractible domains. In this last case we can apply the techniques used to identify generators of cohomology groups for low order schemes in [21] to the standard tree-cotree decomposition. Finally, the extension to mortaring is described in [17]."
        },
        {
            "heading": "IV. TORQUE CALCULATION",
            "text": "In our mortaring setting, one easily verifies that the third component of the Lagrange multiplier \u03bb3 = \u2212H\u03b8 can be identified with the (negative) angular component of the magnetic field strength. Therefore, we can immediately compute the torque by\nT\u03b8(\u03b1) = \u2212 lz\u222b\n0 2\u03c0\u222b 0 Br(\u03b1)\u03bb3(\u03b1)R 2 d\u03b8 dz (13)\nwhen evaluating Br = curl(A) \u00b7 n12 either on the boundary of \u21261 (stator) or \u21262 (rotor). Note that the corresponding numerical quadrature (on patch boundaries in the reference domain \u2126\u0302) is straight forward since we are integrating on a perfect cylindrical shape. However, such direct evaluation of (3) is commonly considered numerically unstable [18, p. 55], i.e., the result is very sensitive with respect to the choice of the integration interface S. Therefore a large variety of methods and formulae to calculate the electromagnetic torque has been developed, a comprehensive literature review is given in [22]. A particular popular variant is Arkkio\u2019s method which averages the torque over some volume, i.e.,\nT\u03b8(\u03b1) = lz\u222b 0 \u03b4\u222b 0 2\u03c0\u222b 0 Br(\u03b1)H\u03b8(\u03b1)(R+ r) 2 d\u03b8 dr dz. (14)\nwhere we can, for example, evaluate the fields either in the air gap contained in \u2126air,1 (stator) or \u2126air,2 (rotor)."
        },
        {
            "heading": "V. NUMERICAL RESULTS",
            "text": "The isogeometric mortaring described in (8-9) is used to compute the magnetic field of a six-pole permanent magnet synchronous machine, whose details are given in [15]. Degree p = 2 is used for the discrete edge element spaces V and q = 1 for the multiplier space M12 which is defined on the interface mesh of \u21261. The rotor consists of 24 patches, resulting in 540353 cotree DoFs (and 309663 eliminated tree DoFs), the stator is given by 228 patches and 1058880 cotree DoFs (and\n601392 eliminated tree DoFs), the multiplier adds another 3912 DoFs. The model and magnetic flux density in this machine can be seen in Fig. 2. The cogging torque is computed using the Lagrange multipliers (13) and Arkkio\u2019s method (14) on \u21261 (stator) and \u21262 (rotor), respectively. In Arkkio\u2019s method the integration volume is chosen in both cases as the whole air gap piece \u2126air,i. The results are shown in Fig. 4 and compared to a 2D reference solution computed using JMAG\u00ae with a finite element discretization of order p = 1 with 1618173 elements. The difference between the torque computed with the IGA approaches and the JMAG reference solution is shown in Fig. 5. All approaches are in excellent agreement. We do not observe the often reported instability for surface/line evaluation of the torque. In our approach, the cylindrical shape of the machine can be exactly described and the angular component of the magnetic field can be obtained from the Lagrange multipliers alleviating the need to numerically differentiate the magnetic vector potential for this component."
        },
        {
            "heading": "VI. CONCLUSION",
            "text": "We have introduced isogeometric mortaring for rotating electric machines using a tree-cotree decomposition for the regularization of the system. Two different methods for the torque computation of electric machines have been introduced and used for the computation of the cogging torque of a 3D six-pole permanent magnet synchronous machine. Isogeometric analysis and in particular isogeometric mortaring were demonstrated to be very well suited for the torque computation. Surface and volume integration for the evaluation of the torque are in excellent agreement with a reference solution."
        },
        {
            "heading": "ACKNOWLEDGEMENTS",
            "text": "This work is supported by the Graduate School CE within the Centre for Computational Engineering at Technische Universita\u0308t Darmstadt, by the Swiss National Science Foundation via the project HOGAEMS n.200021 188589, and by the Defense Advanced Research Projects Agency (DARPA), under contract HR0011-17-2-0028. The views, opinions and/or findings expressed are those of the author and should not be\ninterpreted as representing the official views or policies of the Department of Defense or the U.S. Government. We thank the JSOL Corporation for the fruitful discussions, partnership and JMAG license."
        }
    ],
    "title": "Torque Computation with the Isogeometric Mortar Method for the Simulation of Electric Machines",
    "year": 2022
}