{
    "abstractText": "AlphaFold2 (AF) can evaluate protein-protein interactions (PPIs) with high accuracy by finding evolutionary signals between proteins but comes with a high computational cost. Here, we speed up the prediction with AF for PPI network prediction 40x and reduce the disk space requirements 4000x for a set of 1000 proteins. Our protocol is easy to install and freely available from: https://github.com/patrickbryant1/SpeedPPI.",
    "authors": [
        {
            "affiliations": [],
            "name": "Patrick Bryant"
        },
        {
            "affiliations": [],
            "name": "Frank No\u00e9"
        }
    ],
    "id": "SP:5c30840e2ad786a136905d76a845838282689e09",
    "references": [
        {
            "authors": [
                "H Lu",
                "Q Zhou",
                "J He",
                "Z Jiang",
                "C Peng",
                "R Tong"
            ],
            "title": "Recent advances in the development of protein\u2013protein interactions modulators: mechanisms and clinical trials",
            "venue": "Signal Transduction and Targeted Therapy",
            "year": 2020
        },
        {
            "authors": [
                "TL Nero",
                "CJ Morton",
                "JK Holien",
                "J Wielens",
                "MW. Parker"
            ],
            "title": "Oncogenic protein interfaces: small molecules, big challenges",
            "venue": "Nat Rev Cancer",
            "year": 2014
        },
        {
            "authors": [
                "J Jumper",
                "R Evans",
                "A Pritzel",
                "T Green",
                "M Figurnov",
                "O Ronneberger"
            ],
            "title": "Highly accurate protein structure prediction with AlphaFold",
            "year": 2021
        },
        {
            "authors": [
                "P Bryant",
                "G Pozzati",
                "A. Elofsson"
            ],
            "title": "Improved prediction of protein-protein interactions using AlphaFold2",
            "venue": "Nat Commun",
            "year": 2022
        },
        {
            "authors": [
                "DF Burke",
                "P Bryant",
                "I Barrio-Hernandez",
                "D Memon",
                "G Pozzati",
                "A Shenoy"
            ],
            "title": "Towards a structurally resolved human protein interaction network",
            "venue": "Nat Struct Mol Biol",
            "year": 2023
        },
        {
            "authors": [
                "J Bernett",
                "DB Blumenthal",
                "M. List"
            ],
            "title": "Cracking the black box of deep sequence-based protein-protein interaction prediction",
            "venue": "bioRxiv",
            "year": 2023
        },
        {
            "authors": [
                "Consortium The UniProt",
                "A Bateman",
                "M-J Martin",
                "S Orchard",
                "M Magrane",
                "R Agivetova"
            ],
            "title": "UniProt: the universal protein knowledgebase in 2021",
            "venue": "Nucleic Acids Res",
            "year": 2020
        },
        {
            "authors": [
                "M Steinegger",
                "J. S\u00f6ding"
            ],
            "title": "Clustering huge protein sequence sets in linear time",
            "venue": "Nat Commun",
            "year": 2018
        },
        {
            "authors": [
                "M Steinegger",
                "M Mirdita",
                "J. S\u00f6ding"
            ],
            "title": "Protein-level assembly increases protein sequence recovery from metagenomic samples manyfold",
            "venue": "Nat Methods",
            "year": 2019
        },
        {
            "authors": [
                "AL Mitchell",
                "A Almeida",
                "M Beracochea",
                "M Boland",
                "J Burgin",
                "G Cochrane"
            ],
            "title": "MGnify: the microbiome analysis resource in 2020",
            "venue": "Nucleic Acids Res",
            "year": 2020
        },
        {
            "authors": [
                "BE Suzek",
                "H Huang",
                "P McGarvey",
                "R Mazumder",
                "CH. Wu"
            ],
            "title": "UniRef: comprehensive and non-redundant UniProt reference clusters",
            "year": 2007
        },
        {
            "authors": [
                "R Evans",
                "M O\u2019Neill",
                "A Pritzel",
                "N Antropova",
                "A Senior",
                "T Green"
            ],
            "title": "Protein complex prediction with AlphaFold-Multimer",
            "venue": "bioRxiv",
            "year": 2022
        },
        {
            "authors": [
                "HM Berman",
                "J Westbrook",
                "Z Feng",
                "G Gilliland",
                "TN Bhat",
                "H Weissig"
            ],
            "title": "The Protein Data Bank",
            "venue": "Nucleic Acids Res",
            "year": 2000
        },
        {
            "authors": [
                "M Mirdita",
                "L von den Driesch",
                "C Galiez",
                "MJ Martin",
                "J S\u00f6ding",
                "M. Steinegger"
            ],
            "title": "Uniclust databases of clustered and deeply annotated protein sequences and alignments",
            "venue": "Nucleic Acids Res",
            "year": 2017
        },
        {
            "authors": [
                "M Steinegger",
                "M Meier",
                "M Mirdita",
                "H V\u00f6hringer",
                "SJ Haunsberger",
                "J. S\u00f6ding"
            ],
            "title": "HH-suite3 for fast remote homology detection and deep protein annotation",
            "venue": "BMC Bioinformatics",
            "year": 2019
        }
    ],
    "sections": [
        {
            "text": "Main Protein-protein interactions (PPIs) govern many cellular processes [1,2] and are essential for understanding and identifying disease targets [3]. Constructing PPI networks is a difficult task due to noisy experimental data. Recently, it has been shown that adaptations of AlphaFold2 [4] (AF) for protein complexes (FoldDock [5]) can rival high-throughput yeast-two-hybrid and mass spectrometry screens in identifying PPIs [6].\nDue to the computational requirement of multiple sequence alignment (MSA) creation and structure prediction, it is not feasible to apply high-accuracy methods on a proteome scale. At the same time, single-sequence methods (i.e. those not dependent on an MSA) for PPI prediction have been found to be unreliable [7]. In contrast to other methods, AF for single chains has not been trained on PPIs and, therefore, successful PPI prediction indicates that the network generalizes to this new task. AF has been evaluated for PPI annotation on 1481 known interacting and 5694 non-interacting protein pairs [5]. The score pDockQ (equation 1) was shown to select true PPIs with an area under the ROC curve of 0.87 and only positive PPIs were observed at pDockQ scores above 0.5 [5].\n(1)\ud835\udc5d\ud835\udc37\ud835\udc5c\ud835\udc50\ud835\udc58\ud835\udc44 = 0.724 1+\ud835\udc52\u22120.052(\ud835\udc65\u2212152.611) + 0. 018\nHere, x is the average interface predicted lDDT from the AF predictions multiplied with the logarithm of the number of predicted inter-chain contacts (C\u03b2s within 8\u00c5).\nTo reduce the computational time and disk space required to annotate an entire PPI network we apply several strategies (Figure 1). 1)We apply a reduced MSA creation procedure by searching only Uniclust30 compared to the default one of AF [4,5] which searches BFD[8,9][9\u201311][8,9], MGnify[12] and UniRef90[13]. A slightly increased success rate (fraction of interactions with DockQ>0.23) in the structure prediction of PPIs has been observed using this reduced MSA generation [5]. 2)We pair MSAs using species information within the prediction run and keep all single-chain information by block diagonalization. 3)We rewrite the prediction script to prefetch features on the CPU while predictions are running on the GPU, meaning that the total prediction time is that of the GPU processing. Overall, our procedure speeds up PPI network prediction approximately 40 times compared to the default AF procedure for 1000 proteins (499\u2019500 pairwise interactions). The pipeline is compatible with any Unix-based system and can be easily parallelized using the provided source code.\nWe analyse the speedup for different reduction steps calculated for all pairwise interactions from 1000 unique proteins (Figure 2a). The main computational bottleneck for structure prediction is the MSA generation. The reduced MSA creation has a roughly 8-fold speedup compared to the default generation per chain. As all pairs have to be searched in unison using the default AF option with concatenated chains (or AlphaFold-multimer [14]), the speedup of creating MSAs for every single chain and then combining these have a much larger total impact on the computational time (11\u2019395-fold reduction in MSA search time, see Methods). Instead of saving PPI MSAs or features to disk, they are processed within the prediction runs, resulting in a 4\u2019460 -fold reduction in the disk space requirements for a set of 1000 proteins (Figure 2b). The user can set a pDockQ score threshold to determine which structures are saved to avoid saving low-quality predictions.\nFigure 2. a) Computational time (log scale) for different reduction steps calculated for all pairwise interactions over a set of 1000 proteins (499\u2019500 interactions in total). The prediction time here is calculated using an NVIDIA A100 GPU with 40 GB RAM and MSA generation with 16 CPU cores from an Intel Xeon E5-2690v4. The time per unit is taken over a few examples and is displayed as an example. The relative numbers will be similar between the options regardless of the time per example used (which depends on the computational infrastructure). The time requirement is reduced by approximately 40x with the reduced MSA option. The exact number of days is available in Table 1. b) Disk space requirements (log scale) for the databases and MSAs. The average disk space per Uniclust30 MSA is 11 Mb and using all databases from AF 650 Mb. Not saving the MSAs or features to disk has the largest effect. In total, the space requirement is reduced by approximately 4000x using Uniclust30 and keeping the MSAs and features in RAM for the predictions only. The exact number of GBs is available in Table 2 (Methods).\nThe databases used in AlphaFold (BFD[8,9], MGnify[12], PDB70, PDB mmCIF and PDB SEQRES[15], UniRef30 and UniRef90[13]) take a total of 2.49 TB and require hours to days for downloading and processing. Using only Uniclust30 reduces the memory requirement to 87 Gb, a 97% reduction in disk space. This database can be fetched in minutes, making the installation requirements more suitable for a larger user group. The overall memory requirement for the installation of the protocol described here is approximately 90 Gb. Due to the reduction in generated MSA information searching only Uniclust30 with HHblits, the average disk space needed is 11 Mb (1.7%) per MSA compared to 650 Mb for the MSAs generated with AF. No disk space is needed for the features as these are kept in RAM, which takes an average of 220 Mb per complex.\nWe provide two options for running the pipeline to suit a variety of users, either all-vs-all or some-vs-some. In the all-vs-all mode, a full PPI network is evaluated for a list of protein sequences (as in a real proteome evaluation setting). In some-vs-some, two lists of proteins of interest can be provided. All proteins in list one will be run against all proteins in list two and a network will be created using all possible pairs between the lists. Note that this evaluation will benefit from a similar speedup since if two lists of 1000 proteins each are analysed there are 10002=1\u2019000\u2019000 possible pairs. We hope that the speedup, reduced disk space and simplifications made here will result in an acceleration in the study of PPIs and new biological insights.\nReferences 1. Lu H, Zhou Q, He J, Jiang Z, Peng C, Tong R, et al. Recent advances in the\ndevelopment of protein\u2013protein interactions modulators: mechanisms and clinical trials. Signal Transduction and Targeted Therapy. 2020;5: 1\u201323.\n2. A Human Protein-Protein Interaction Network: A Resource for Annotating the Proteome. Cell. 2005;122: 957\u2013968.\n3. Nero TL, Morton CJ, Holien JK, Wielens J, Parker MW. Oncogenic protein interfaces: small molecules, big challenges. Nat Rev Cancer. 2014;14: 248\u2013262.\n4. Jumper J, Evans R, Pritzel A, Green T, Figurnov M, Ronneberger O, et al. Highly accurate protein structure prediction with AlphaFold. Nature. 2021;596: 583\u2013589.\n5. Bryant P, Pozzati G, Elofsson A. Improved prediction of protein-protein interactions using AlphaFold2. Nat Commun. 2022;13: 1\u201311.\n6. Burke DF, Bryant P, Barrio-Hernandez I, Memon D, Pozzati G, Shenoy A, et al. Towards a structurally resolved human protein interaction network. Nat Struct Mol Biol. 2023;30: 216\u2013225.\n7. Bernett J, Blumenthal DB, List M. Cracking the black box of deep sequence-based protein-protein interaction prediction. bioRxiv. 2023. p. 2023.01.18.524543. doi:10.1101/2023.01.18.524543\n8. The UniProt Consortium, Bateman A, Martin M-J, Orchard S, Magrane M, Agivetova R, et al. UniProt: the universal protein knowledgebase in 2021. Nucleic Acids Res. 2020;49: D480\u2013D489.\n9. BFD Download. Available: https://bfd.mmseqs.com/.\n10. Steinegger M, S\u00f6ding J. Clustering huge protein sequence sets in linear time. Nat Commun. 2018;9: 1\u20138.\n11. Steinegger M, Mirdita M, S\u00f6ding J. Protein-level assembly increases protein sequence recovery from metagenomic samples manyfold. Nat Methods. 2019;16: 603\u2013606.\n12. Mitchell AL, Almeida A, Beracochea M, Boland M, Burgin J, Cochrane G, et al. MGnify: the microbiome analysis resource in 2020. Nucleic Acids Res. 2020;48. doi:10.1093/nar/gkz1035\n13. Suzek BE, Huang H, McGarvey P, Mazumder R, Wu CH. UniRef: comprehensive and non-redundant UniProt reference clusters. Bioinformatics. 2007;23: 1282\u20131288.\n14. Evans R, O\u2019Neill M, Pritzel A, Antropova N, Senior A, Green T, et al. Protein complex prediction with AlphaFold-Multimer. bioRxiv. 2022. p. 2021.10.04.463034. doi:10.1101/2021.10.04.463034\n15. Berman HM, Westbrook J, Feng Z, Gilliland G, Bhat TN, Weissig H, et al. The Protein Data Bank. Nucleic Acids Res. 2000;28: 235\u2013242.\n16. Mirdita M, von den Driesch L, Galiez C, Martin MJ, S\u00f6ding J, Steinegger M. Uniclust databases of clustered and deeply annotated protein sequences and alignments. Nucleic Acids Res. 2017;45: D170\u2013D176.\n17. Steinegger M, Meier M, Mirdita M, V\u00f6hringer H, Haunsberger SJ, S\u00f6ding J. HH-suite3 for fast remote homology detection and deep protein annotation. BMC Bioinformatics. 2019;20: 473.\n18. Lluch-Senar M, Mancuso FM, Climente-Gonz\u00e1lez H, Pe\u00f1a-Paz MI, Sabido E, Serrano L. Rescuing discarded spectra: Full comprehensive analysis of a minimal proteome. Proteomics. 2016;16. doi:10.1002/pmic.201500187\nMethods MSA creation and analysis\nThe most expensive step of the protein structure prediction with AlphaFold2 is the creation of MSAs both in memory consumption and computational time. To speed this process up, we search only Uniclust30[16] with HHblits from HHsuite 3.3.0 [17]) for every single chain. The chains are thereafter paired using the organism identifiers [8] from the hits. This process takes on average 2 seconds, making it negligible compared to the search (average 338 s) with 16 CPU cores from an Intel Xeon E5-2690v4. We note that these timings can be highly variable, but that the relationships observed between the full and reduced searches should be similar.\nStructure prediction and scoring\nTo use GPU resources more efficiently, we prefetch data on the CPU that are loaded onto the GPU for prediction. Running AlphaFold2 on the same MSAs in the default way took approximately 3 minutes (191 s) per example and with the prefetching approximately 30 s to a few minutes will be saved per example using NVIDIA A100 GPUs with 40 GB RAM. Note that the time saved by the prefetching can be highly variable depending on the bandwidth. With prefetching, features are always ready to go to the GPU, making the prediction process as efficient as possible. The features are kept within the prediction script and never saved to disk, saving on average 220 Mb per example. The same with the scoring of the models using pDockQ. This means that users can set a threshold and only save predictions with a score above a certain threshold, reducing the disk space requirements further and saving a negligible 0.6 Mb per model below the score threshold (not included in the disk space calculations).\nTime complexity and disk space\nThe number of possible pairwise interactions from a set of n proteins is:\n(2)\ud835\udc5b\ud835\udc62\ud835\udc5a\ud835\udc4f\ud835\udc52\ud835\udc5f \ud835\udc5c\ud835\udc53 \ud835\udc5d\ud835\udc4e\ud835\udc56\ud835\udc5f\ud835\udc60 = \ud835\udc5b \u00b7 (\ud835\udc5b \u2212 1)/2\nFor a set of 1000 proteins (the order of the smallest known proteomes[18]), this results in\n\ud835\udc5b\ud835\udc62\ud835\udc5a\ud835\udc4f\ud835\udc52\ud835\udc5f \ud835\udc5c\ud835\udc53 \ud835\udc5d\ud835\udc4e\ud835\udc56\ud835\udc5f\ud835\udc60 = 1000 \u00b7 999/2 = 999'000/2 = 499'500 \ud835\udc5d\ud835\udc4e\ud835\udc56\ud835\udc5f\ud835\udc60\nfor a pair\nHHblits MSA creation with Uniclust30 for a single chain 338 s 338 s \u22c5 1000 proteins \u2248 4 days\nPrediction time per complex 191 s 191 s \u22c5 499500 \u2248 1104 days\nFeature generation time per complex (only one unit per protein is needed using prefetching) 30 s 30s \u22c5 499500 \u2248 173 days 30s \u22c5 1000 \u2248 0.35 days\nThe difference between the full and reduced procedure for 1000 proteins is therefore:\n\ud835\udc47\ud835\udc56\ud835\udc5a\ud835\udc52 \ud835\udc5f\ud835\udc4e\ud835\udc61\ud835\udc56\ud835\udc5c = 45579+1104+173 \ud835\udc51\ud835\udc4e\ud835\udc66\ud835\udc604+1104+0.35 \ud835\udc51\ud835\udc4e\ud835\udc66\ud835\udc60 \u2248 42\nThe difference between the full and reduced procedure for 1000 proteins is therefore:\n\ud835\udc37\ud835\udc56\ud835\udc60\ud835\udc58 \ud835\udc60\ud835\udc5d\ud835\udc4e\ud835\udc50\ud835\udc52 \ud835\udc5f\ud835\udc4e\ud835\udc61\ud835\udc56\ud835\udc5c = 2490+324675+109890 \ud835\udc3a\ud835\udc4f87+11 \ud835\udc3a\ud835\udc4f \u2248 4460\nData availability\nThe dataset and metrics used for the creation of FoldDock and pDockQ are available in the original publication [5] and from the GitHub repository which contains this pipeline (https://gitlab.com/ElofssonLab/FoldDock and https://github.com/patrickbryant1/SpeedPPI).\nAcknowledgements\nThe organism depictions in Figure 1 were created with https://bioicons.com/ and are available under the CC BY 3.0 license (https://creativecommons.org/licenses/by/3.0/)."
        }
    ],
    "title": "Rapid protein-protein interaction network creation from multiple sequence alignments with Deep Learning",
    "year": 2024
}