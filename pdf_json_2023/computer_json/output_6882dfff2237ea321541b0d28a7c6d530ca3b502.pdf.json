{
    "abstractText": "We establish optimal error bounds for the exponential wave integrator (EWI) applied to the nonlinear Schr\u00f6dinger equation (NLSE) with L\u221e-potential and/or locally Lipschitz nonlinearity under the assumption of H2-solution of the NLSE. For the semi-discretization in time by the first-order Gautschi-type EWI, we prove an optimal L2-error bound at O(\u03c4) with \u03c4 > 0 being the time step size, together with a uniformH2-bound of the numerical solution. For the full-discretization scheme obtained by using the Fourier spectral method in space, we prove an optimal L2-error bound at O(\u03c4 + h2) without any coupling condition between \u03c4 and h, where h > 0 is the mesh size. In addition, forW 1,4-potential and a little stronger regularity of the nonlinearity, under the assumption of H3-solution, we obtain an optimal H1-error bound. Furthermore, when the potential is of low regularity but the nonlinearity is sufficiently smooth, we propose an extended Fourier pseudospectral method which has the same error bound as the Fourier spectral method while its computational cost is similar to the standard Fourier pseudospectral method. Our new error bounds greatly improve the existing results for the NLSE with low regularity potential and/or nonlinearity. Extensive numerical results are reported to confirm our error estimates and to demonstrate that they are sharp.",
    "authors": [
        {
            "affiliations": [],
            "name": "WEIZHU BAO"
        },
        {
            "affiliations": [],
            "name": "CHUSHAN WANG"
        }
    ],
    "id": "SP:3210d1cde17d1a4a7561234e09eb1842787a59f8",
    "references": [
        {
            "authors": [
                "G.D. Akrivis"
            ],
            "title": "Finite difference discretization of the cubic Schr\u00f6dinger equation",
            "venue": "IMA J. Numer. Anal., 13 ",
            "year": 1993
        },
        {
            "authors": [
                "G.D. Akrivis",
                "V.A. Dougalis",
                "O.A. Karakashian"
            ],
            "title": "On fully discrete Galerkin methods of second-order temporal accuracy for the nonlinear Schr\u00f6dinger equation",
            "venue": "Numer. Math., 59 ",
            "year": 1991
        },
        {
            "authors": [
                "Y. Alama Bronsard"
            ],
            "title": "Error analysis of a class of semi-discrete schemes for solving the Gross- Pitaevskii equation at low regularity",
            "venue": "J. Comput. Appl. Math., 418 ",
            "year": 2023
        },
        {
            "authors": [
                "Y. Alama Bronsard",
                "Y. Bruned"
            ],
            "title": "and K",
            "venue": "Schratz, Low regularity integrators via decorated trees",
            "year": 2022
        },
        {
            "authors": [
                "Y. Bruned",
                "K. Schratz"
            ],
            "title": "Resonance-based schemes for dispersive equations via decorated trees",
            "venue": "Forum Math. Pi, 10, e2 ",
            "year": 2022
        },
        {
            "authors": [
                "X. Antoine",
                "W. Bao",
                "C. Besse"
            ],
            "title": "Computational methods for the dynamics of the nonlinear Schr\u00f6dinger/Gross-Pitaevskii equations",
            "venue": "Comput. Phys. Commun., 184 ",
            "year": 2013
        },
        {
            "authors": [
                "G.E. Astrakharchik",
                "B.A. Malomed"
            ],
            "title": "Dynamics of one-dimensional quantum droplets",
            "venue": "Phys. Rev. A, 98 ",
            "year": 2018
        },
        {
            "authors": [
                "W. Bao",
                "Y. Cai"
            ],
            "title": "Mathematical theory and numerical methods for Bose-Einstein condensation",
            "venue": "Kinet. Relat. Models, 6 ",
            "year": 2013
        },
        {
            "authors": [
                "W. Bao",
                "Y. Cai"
            ],
            "title": "Optimal error estimates of finite difference methods for the Gross- Pitaevskii equation with angular momentum rotation",
            "venue": "Math. Comp., 82 ",
            "year": 2013
        },
        {
            "authors": [
                "W. Bao",
                "Y. Cai"
            ],
            "title": "Uniform and optimal error estimates of an exponential wave integrator sine pseudospectral method for the nonlinear Schr\u00f6dinger equation with wave operator",
            "venue": "SIAM J. Numer. Anal., 52 ",
            "year": 2014
        },
        {
            "authors": [
                "W. Bao",
                "Y. Cai",
                "Y. Feng"
            ],
            "title": "Improved uniform error bounds of the time-splitting methods for ERROR ESTIMATES OF EWI FOR NLSE 25 the long-time (nonlinear) Schr\u00f6dinger equation",
            "venue": "Math. Comp., 92 ",
            "year": 2023
        },
        {
            "authors": [
                "W. Bao",
                "R. Carles",
                "C. Su",
                "Q. Tang"
            ],
            "title": "Error estimates of a regularized finite difference method for the logarithmic Schr\u00f6dinger equation",
            "venue": "SIAM J. Numer. Anal., 57 ",
            "year": 2019
        },
        {
            "authors": [
                "W. Bao",
                "R. Carles",
                "C. Su",
                "Q. Tang"
            ],
            "title": "Regularized numerical methods for the logarithmic Schr\u00f6dinger equation",
            "venue": "Numer. Math., 143 ",
            "year": 2019
        },
        {
            "authors": [
                "W. Bao",
                "R. Carles",
                "C. Su",
                "Q. Tang"
            ],
            "title": "Error estimates of local energy regularization for the logarithmic Schr\u00f6dinger equation",
            "venue": "Math. Models Methods Appl. Sci., 32 ",
            "year": 2022
        },
        {
            "authors": [
                "W. Bao",
                "Y. Feng",
                "Y. Ma"
            ],
            "title": "Regularized numerical methods for the nonlinear Schr\u00f6dinger equation with singular nonlinearity",
            "venue": "East Asian J. Appl. Math., 13 ",
            "year": 2023
        },
        {
            "authors": [
                "W. Bao",
                "D. Jaksch",
                "P.A. Markowich"
            ],
            "title": "Numerical solution of the Gross-Pitaevskii equation for Bose-Einstein condensation",
            "venue": "J. Comput. Phys., 187 ",
            "year": 2003
        },
        {
            "authors": [
                "W. Bao",
                "N.J. Mauser",
                "H.P. Stimming"
            ],
            "title": "Effective one particle quantum dynamics of electrons: a numerical study of the Schr\u00f6dinger-Poisson-X\u03b1 model",
            "venue": "Commun. Math. Sci., 1 ",
            "year": 2003
        },
        {
            "authors": [
                "W. Bao",
                "C. Wang"
            ],
            "title": "Error estimates of the time-splitting methods for the nonlinear Schr\u00f6dinger equation with semi-smooth nonlinearity, 2023",
            "year": 2023
        },
        {
            "authors": [
                "M. Bayindir",
                "B. Tanatar",
                "Z. Gedik"
            ],
            "title": "Bose-Einstein condensation in a one-dimensional interacting system due to power-law trapping potentials",
            "venue": "Phys. Rev. A, 59 ",
            "year": 1999
        },
        {
            "authors": [
                "C. Besse",
                "B. Bid\u00e9garay",
                "S. Descombes"
            ],
            "title": "Order estimates in time of splitting methods for the nonlinear Schr\u00f6dinger equation",
            "venue": "SIAM J. Numer. Anal., 40 ",
            "year": 2002
        },
        {
            "authors": [
                "O. Bokanowski",
                "N.J. Mauser"
            ],
            "title": "Local approximation for the Hartree-Fock exchange potential: a deformation approach",
            "venue": "Math. Models Methods Appl. Sci., 9 ",
            "year": 1999
        },
        {
            "authors": [
                "C.R. Cabrera",
                "L. Tanzi",
                "J. Sanz",
                "B. Naylor",
                "P. Thomas",
                "P. Cheiney",
                "L. Tarruell"
            ],
            "title": "Quantum liquid droplets in a mixture of Bose-Einstein condensates",
            "venue": "Science, 359 ",
            "year": 2018
        },
        {
            "authors": [
                "Y. Cai",
                "H. Wang"
            ],
            "title": "Analysis and computation for ground state solutions of Bose-Fermi mixtures at zero temperature",
            "venue": "SIAM J. Appl. Math., 73 ",
            "year": 2013
        },
        {
            "authors": [
                "T. Cazenave"
            ],
            "title": "Semilinear Schr\u00f6dinger Equations",
            "venue": "vol. 10 of Courant Lecture Notes in Mathematics, New York University, Courant Institute of Mathematical Sciences, New York; American Mathematical Society, Providence, RI",
            "year": 2003
        },
        {
            "authors": [
                "E. Celledoni",
                "D. Cohen",
                "B. Owren"
            ],
            "title": "Symmetric exponential integrators with an application to the cubic Schr\u00f6dinger equation",
            "venue": "Found. Comput. Math., 8 ",
            "year": 2008
        },
        {
            "authors": [
                "W. Choi",
                "Y. Koh"
            ],
            "title": "On the splitting method for the nonlinear Schr\u00f6dinger equation with initial data in H1",
            "venue": "Discrete Contin. Dyn. Syst., 41 ",
            "year": 2021
        },
        {
            "authors": [
                "J. Eilinghoff",
                "R. Schnaubelt",
                "K. Schratz"
            ],
            "title": "Fractional error estimates of splitting schemes for the nonlinear Schr\u00f6dinger equation",
            "venue": "J. Math. Anal. Appl., 442 ",
            "year": 2016
        },
        {
            "authors": [
                "L. Erd\u0151s",
                "B. Schlein",
                "H.-T. Yau"
            ],
            "title": "Derivation of the cubic non-linear Schr\u00f6dinger equation from quantum dynamics of many-body systems",
            "venue": "Invent. Math., 167 ",
            "year": 2007
        },
        {
            "authors": [
                "B.-Y. Guo"
            ],
            "title": "Spectral methods and their applications",
            "venue": "World Scientific Publishing Co., Inc., River Edge, NJ",
            "year": 1998
        },
        {
            "authors": [
                "Z. Hadzibabic",
                "C.A. Stan",
                "K. Dieckmann",
                "S. Gupta",
                "M.W. Zwierlein",
                "A. G\u00f6rlitz",
                "W. Ketterle"
            ],
            "title": "Two-species mixture of quantum degenerate Bose and Fermi gases",
            "venue": "Phys. Rev. Lett., 88 ",
            "year": 2002
        },
        {
            "authors": [
                "P. Henning",
                "D. Peterseim"
            ],
            "title": "Crank-Nicolson Galerkin approximations to nonlinear Schr\u00f6dinger equations with rough potentials",
            "venue": "Math. Models Methods Appl. Sci., 27 ",
            "year": 2017
        },
        {
            "authors": [
                "M. Hochbruck",
                "A. Ostermann"
            ],
            "title": "Exponential integrators",
            "venue": "Acta Numer., 19 ",
            "year": 2010
        },
        {
            "authors": [
                "L.I. Ignat"
            ],
            "title": "A splitting method for the nonlinear Schr\u00f6dinger equation",
            "venue": "J. Differential Equations, 250 ",
            "year": 2011
        },
        {
            "authors": [
                "H. Kadau",
                "M. Schmitt",
                "M. Wenzel",
                "C. Wink",
                "T. Maier",
                "I. Ferrier-Barbut",
                "T. Pfau"
            ],
            "title": "Observing the rosensweig instability of a quantum ferrofluid",
            "venue": "Nature, 530 ",
            "year": 2016
        },
        {
            "authors": [
                "T. Kato"
            ],
            "title": "On nonlinear Schr\u00f6dinger equations",
            "venue": "Ann. Inst. H. Poincar\u00e9 Phys. Th\u00e9or., 46 ",
            "year": 1987
        },
        {
            "authors": [
                "M. Kn\u00f6ller",
                "A. Ostermann",
                "K. Schratz"
            ],
            "title": "A Fourier integrator for the cubic nonlinear 26 W",
            "venue": "BAO, AND C. WANG Schr\u00f6dinger equation with rough initial data, SIAM J. Numer. Anal., 57 ",
            "year": 2019
        },
        {
            "authors": [
                "T.D. Lee",
                "K. Huang",
                "C.N. Yang"
            ],
            "title": "Eigenvalues and eigenfunctions of a Bose system of hard spheres and its low-temperature properties",
            "venue": "Phys. Rev., 106 ",
            "year": 1957
        },
        {
            "authors": [
                "C. Lubich"
            ],
            "title": "On splitting methods for Schr\u00f6dinger-Poisson and cubic nonlinear Schr\u00f6dinger equations",
            "venue": "Math. Comp., 77 ",
            "year": 2008
        },
        {
            "authors": [
                "A. Ostermann",
                "F. Rousset",
                "K. Schratz"
            ],
            "title": "Error estimates at low regularity of splitting schemes for NLS",
            "venue": "Math. Comp., 91 ",
            "year": 2021
        },
        {
            "authors": [
                "A. Ostermann",
                "F. Rousset",
                "K. Schratz"
            ],
            "title": "Error estimates of a Fourier integrator for the cubic Schr\u00f6dinger equation at low regularity",
            "venue": "Found. Comput. Math., 21 ",
            "year": 2021
        },
        {
            "authors": [
                "A. Ostermann",
                "K. Schratz"
            ],
            "title": "Low regularity exponential-type integrators for semilinear Schr\u00f6dinger equations",
            "venue": "Found. Comput. Math., 18 ",
            "year": 2018
        },
        {
            "authors": [
                "A. Ostermann",
                "Y. Wu",
                "F. Yao"
            ],
            "title": "A second-order low-regularity integrator for the nonlinear Schr\u00f6dinger equation",
            "venue": "Adv. Contin. Discrete Models, ",
            "year": 2022
        },
        {
            "authors": [
                "A. Ostermann",
                "F. Yao"
            ],
            "title": "A fully discrete low-regularity integrator for the nonlinear Schr\u00f6dinger equation",
            "venue": "J. Sci. Comput., 91 ",
            "year": 2022
        },
        {
            "authors": [
                "D.S. Petrov",
                "G.E. Astrakharchik"
            ],
            "title": "Ultradilute low-dimensional liquids",
            "venue": "Phys. Rev. Lett., 117 ",
            "year": 2016
        },
        {
            "authors": [
                "P.W.H. Pinkse",
                "A. Mosk",
                "M. Weidem\u00fcller",
                "M.W. Reynolds",
                "T.W. Hijmans",
                "J.T.M. Walraven"
            ],
            "title": "Adiabatically changing the phase-space density of a trapped Bose gas",
            "venue": "Phys. Rev. Lett., 78 ",
            "year": 1997
        },
        {
            "authors": [
                "F. Rousset",
                "K. Schratz"
            ],
            "title": "A general framework of low regularity integrators",
            "venue": "SIAM J. Numer. Anal., 59 ",
            "year": 2021
        },
        {
            "authors": [
                "L. Sanchez-Palencia",
                "D. Cl\u00e9ment",
                "P. Lugan",
                "P. Bouyer",
                "G.V. Shlyapnikov",
                "A. Aspect"
            ],
            "title": "Anderson localization of expanding Bose-Einstein condensates in random potentials",
            "venue": "Phys. Rev. Lett., 98 ",
            "year": 2007
        },
        {
            "authors": [
                "J.M. Sanz-Serna"
            ],
            "title": "Methods for the numerical solution of the nonlinear Schr\u00f6dinger equation",
            "venue": "Math. Comp., 43 ",
            "year": 1984
        },
        {
            "authors": [
                "J. Shen",
                "T. Tang",
                "L.-L. Wang"
            ],
            "title": "Spectral Methods: Algorithms",
            "venue": "Analysis and Applications, vol. 41 of Springer Series in Computational Mathematics, Springer, Heidelberg",
            "year": 2011
        },
        {
            "authors": [
                "C. Sulem",
                "P.-L. Sulem"
            ],
            "title": "The Nonlinear Schr\u00f6dinger Equation: Self-Focusing and Wave Collapse",
            "venue": "Applied Mathematical Sciences, Springer New York, NY",
            "year": 1999
        },
        {
            "authors": [
                "Y. Tourigny"
            ],
            "title": "Optimal H1 estimates for two time-discrete Galerkin approximations of a nonlinear Schr\u00f6dinger equation",
            "venue": "IMA J. Numer. Anal., 11 ",
            "year": 1991
        },
        {
            "authors": [
                "J. Wang"
            ],
            "title": "A new error analysis of Crank-Nicolson Galerkin FEMs for a generalized nonlinear Schr\u00f6dinger equation",
            "venue": "J. Sci. Comput., 60 ",
            "year": 2014
        },
        {
            "authors": [
                "I. Zapata",
                "F. Sols",
                "A.J. Leggett"
            ],
            "title": "Josephson effect between trapped Bose-Einstein condensates",
            "venue": "Phys. Rev. A, 57 ",
            "year": 1998
        },
        {
            "authors": [
                "X. Zhao"
            ],
            "title": "Numerical integrators for continuous disordered nonlinear Schr\u00f6dinger equation",
            "venue": "J. Sci. Comput., 89 ",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "Key words. nonlinear Schro\u0308dinger equation, exponential integrator, semi-smooth nonlinearity, bounded potential, error estimate, Fourier spectral method, extended Fourier pseudospectral method\nMSC codes. 35Q55, 65M15, 65M70, 81Q05\n1. Introduction. In this paper, we consider the following nonlinear Schro\u0308dinger equation (NLSE)\n(1.1) { i\u2202t\u03c8(x, t) = \u2212\u2206\u03c8(x, t) + V (x)\u03c8(x, t) + f(|\u03c8(x, t)|2)\u03c8(x, t), x \u2208 \u2126, t > 0, \u03c8(x, 0) = \u03c80(x), x \u2208 \u2126,\nwhere t is time, x = (x1, \u00b7 \u00b7 \u00b7 , xd)T \u2208 Rd (d = 1, 2, 3) is the spatial coordinate, \u03c8 = \u03c8(x, t) is a complex-valued wave function, and \u2126 = \u03a0di=1(ai, bi) \u2282 Rd is a bounded domain equipped with periodic boundary condition. Here, V = V (x) : \u2126 \u2192 R is a real-valued potential and f = f(\u03c1) : [0,\u221e) \u2192 R with \u03c1 = |\u03c8|2 being the density describes the nonlinear interaction. We assume that V \u2208 L\u221e(\u2126) and f(|z|2)z : C \u2192 C is locally Lipschitz continuous, and thus both V and f may be of low regularity.\nWhen V (x) = |x|2/2 and f(\u03c1) = \u03c1, the NLSE (1.1) collapses to the nonlinear Schro\u0308dinger equation with harmonic potential and cubic nonlinearity (or smooth potential and nonlinearity) or the Gross-Pitaevskii equation (GPE), which has been widely adopted for modeling and simulation in quantum mechanics, nonlinear optics and Bose-Einstein condensation (BEC) [8, 28, 51]. For the smooth NLSE with sufficiently smooth initial data \u03c80, many accurate and efficient numerical methods have been proposed and analyzed in last two decades, including the finite difference method [1, 9, 8, 6], the exponential wave integrator [10, 33, 25], the time-splitting\n\u2217Submitted to the editors DATE. Funding: This research is supported by the Ministry of Education, Singapore, under its Academic Research Fund MOE-T2EP20122-0002 (A-8000962-00-00). \u2020Department of Mathematics, National University of Singapore, Singapore 119076 (matbaowz@nus.edu.sg, https://blog.nus.edu.sg/matbwz/). \u2021Department of Mathematics, National University of Singapore, Singapore 119076 (e0546091@u.nus.edu).\n1\nar X\niv :2\n30 2.\n09 26\n2v 2\n[ m\nat h.\nN A\n] 2\n6 A\nug 2\n02 3\nmethod [16, 20, 39, 27, 8, 6, 11], the finite element method [2, 49, 52, 53, 32], etc. Recently, many works are done to analyze and design numerical methods for the cubic NLSE with low regularity initial data \u03c80 and with/without potential (see [27, 40, 42, 37, 41, 47, 44, 43, 5, 4] and references therein for other dispersive partial differential equations).\nArising from different physics applications, both V and f in (1.1) may be of low regularity. Typical examples of the low regularity L\u221e-potential include, in many physical contexts, the square-well potential or step potential, which are discontinuous; in the study of BEC in different trapping shape, the power law potential V (x) = |x|\u03b3 (\u03b3 > 0) [46, 19], and in the analysis of Josephson effect and Anderson localization, some disorder potential [54, 48]. Low regularity nonlinearity such as f(\u03c1) = \u03c1\u03c3 (\u03c3 > 0) or f(\u03c1) = \u03c1 ln \u03c1 are considered in, e.g., the Schro\u0308dinger-Poisson-X\u03b1 model [17, 21], the Lee-Huang-Yang correction [38] which is adopted to model and simulate quantum droplets [35, 22, 7, 45], and the mean-field model for Bose-Fermi mixture [31, 23].\nMost numerical methods for the cubic NLSE with smooth potential can be extended straightforwardly to solve the NLSE (1.1) with L\u221e-potential and/or locally Lipschitz nonlinearity (different from the singular nonlinearity in [12, 13, 14, 15]). However, the performance of these methods are quite different from the smooth case and the error analysis of them is a very subtle and challenging question. For (1.1) with power-type nonlinearity f(\u03c1) = \u03c1\u03c3 and sufficiently smooth potential, the Lie-Trotter time-splitting method is analyzed in [18, 26, 34] with reduced convergence order in L2-norm when \u03c3 < 1/2 and in H1-norm when \u03c3 < 1. The analysis of (1.1) with smooth nonlinearity and L\u221e-potential seems more challenging and the only known convergence result is the one obtained in [32] for the Crank-Nicolson Galerkin scheme, where first order convergence in time and less than second order convergence in space in L2-norm are shown under strong assumptions on the exact solution (among others \u2202t\u03c8 \u2208 H2), and a coupling condition between the time step size \u03c4 and the mesh size h. Some low regularity integrators or resonance-based Fourier integrators are also proposed to reduce the regularity requirements on both V and \u03c8, while the regularity assumption on V is still stronger than H1 [55, 4, 3], which still excludes the popular well potential and step potential widely adopted in physics literatures. The main difficulty comes from the low regularity of solution of the NLSE with L\u221e-potential and locally Lipschitz nonlinearity, where only H2 well-posedness is guaranteed [36, 24], and the low regularity of the potential and the nonlinearity which causes order reduction in local truncation errors and prevent us from obtaining stability estimates in high order Sobolev spaces H\u03b1 (\u03b1 > d/2) (see [18, 55, 32] for more detailed discussion). Besides, for the NLSE (1.1) with purely L\u221e-potential, how to estimate the spatial discretization is also a challenging problem and it turns out that it is very subtle and challenging to estimate the classical methods including the finite difference method, the pseudospectral method and the finite element method [32].\nThe main aim of this paper is to establish optimal error bounds for a first order Gautschi-type exponential wave integrator (EWI), also known as the exponential Euler scheme in the literature [33], applied to the NLSE with L\u221e-potential and/or locally Lipschitz nonlinearity. Our main results are as follows:\n(i) For the semi-discretization in time (EWI (2.2)), we prove an optimal L2-error bound at O(\u03c4) with \u03c4 > 0 being the time step size, and a uniform H2-bound of the numerical solution, under the assumption of H2-solution of the NLSE (see (3.2) in Theorem 3.1).\n(ii) For the full discretization of the EWI by using the Fourier spectral method for spatial derivatives (EWI-FS (2.11)), we prove an optimal L2-error bound at\nO(\u03c4 + h2) without any coupling condition between \u03c4 and the mesh size h (see (4.1) in Theorem 4.1).\n(iii) For W 1,4-potential and a little more regular nonlinearity, under the assumption of H3-solution, we obtain optimal H1-error bounds for EWI and EWI-FS schemes. (see (3.3) in Theorem 3.1 and (4.2) in Theorem 4.1). (iv) When the potential is of low regularity but the nonlinearity is sufficiently smooth, we propose an extended Fourier pseudospectral method for spatial discretization of the EWI, leading to EWI-EFP scheme (2.13). For the EWI-EFP, we establish optimal error bounds in L2- and H1-norm under the same assumption on the potential and exact solution as the EWI-FS (see Corollary 4.4). However, the computational cost of EWI-EFP is similar to the standard Fourier pseudospectral discretization of the EWI.\nOur error bounds greatly improve the previous results for the NLSE with low regularity potential and/or nonlinearity. In general, compared with the error estimates of classical exponential wave integrators [4] and time-splitting methods [18] in the literature, to obtain optimal error bounds, we reduce the differentiability requirement on the potential by two orders and on the nonlinearity by one order. Moreover, when V \u2208 L\u221e and f is smooth as considered in [32], compared with their results for the Crank-Nicolson Galerkin scheme, we improve the convergence order in L2-norm to the optimal first order in time and the optimal second order in space, remove the coupling condition requirement between \u03c4 and h in [32], relax the regularity assumption on the exact solution such that it is theoretically guaranteed, and reduce the computational cost in practical implementation.\nHere, we briefly explain why we can obtain the improved error bounds. In general, time-splitting methods and EWIs require weaker regularity on the exact solution to obtain the same order of convergence, compared with finite difference methods. In practical computation, time-splitting methods tend to outperform EWIs when the solution is smooth, which requires the potential and nonlinearity as well as the initial data are all smooth. The main reason is that time-splitting methods are usually structure-preserving scheme, i.e. they preserve mass conservation, time symmetry, time-transverse invariance, and dispersion relation at the discretized level [6, 8]. On the contrary, when the NLSE (1.1) involves low regularity potential and/or nonlinearity, leading to a solution with low regularity, we find that the first-order Gautschi-type EWI offers two major advantages in obtaining optimal error bounds: (i) in obtaining local truncation errors, time-splitting methods need to apply the Laplacian \u2206 to the equation while the EWI only needs to apply \u2202t to the equation, and thus the EWI needs weaker regularity requirement on both potential and nonlinearity; and (ii) a smoothing operator is adopted in the EWI scheme to control the dispersion of high frequencies and thus it helps to keep the numerical solution in H2 at each time step, which makes it possible to obtain the stability estimates in high order Sobolev spaces, while it is a challenging and subtle task to establish H2-bounds of the numerical solution by using the time-splitting methods.\nThe rest of the paper is organized as follows. In Section 2, we present a semidiscretization in time by the first-order Gautschi-type EWI and then a full discretization in space by the Fourier spectral/extended pseudospectral methods. Sections 3 and 4 are devoted to the error estimates of the semi-discretization scheme and the full-discretization scheme, respectively. Numerical results are reported in Section 5 to confirm the error estimates. Finally, some conclusions are drawn in Section 6. Throughout the paper, we adopt the standard Sobolev spaces as well as their corresponding norms, and denote by C a generic positive constant independent of the\nmesh size h and time step size \u03c4 , and by C(\u03b1) a generic positive constant depending only on the parameter \u03b1. The notation A \u2272 B is used to represent that there exists a generic constant C > 0, such that |A| \u2264 CB.\n2. The exponential wave integrator Fourier spectral method. In this secton, we introduce an exponential wave integrator and its spatial discretization to solve the NLSE with low regularity potential and nonlinearity. For simplicity of the presentation and to avoid heavy notations, we only carry out the analysis in 1D and take \u2126 = (a, b). The only dimension sensitive estimates are the Sobolev embedding into L\u221e and the inverse inequalities to control L\u221e-norm by L2-norm. In our analysis, we only use the embedding H2(\u2126) \u21aa\u2192 L\u221e(\u2126) which holds for 1D, 2D and 3D, and for the inverse inequalities, we clearly show how it depends on the space dimension. Thus, generalizations to 2D and 3D are straightforward, and the main results remain unchanged.\nWe define periodic Sobolev spaces as (see, e.g. [29] for the equivalent definition)\nHmper(\u2126) := {\u03d5 \u2208 Hm(\u2126) : \u03d5(k)(a) = \u03d5(k)(b), k = 0, \u00b7 \u00b7 \u00b7 ,m\u2212 1}, m \u2265 1."
        },
        {
            "heading": "2.1. Semi-discretization in time by an exponential wave integrator.",
            "text": "Choose a time step size \u03c4 > 0 and denote time steps as tn = n\u03c4 for n = 0, 1, \u00b7 \u00b7 \u00b7 . By Duhamel\u2019s formula, the exact solution of the NLSE (1.1) is given as\n\u03c8(tn+1) =\u03c8(tn + \u03c4) = e i\u03c4\u2206\u03c8(tn) \u2212i \u222b \u03c4 0 ei(\u03c4\u2212s)\u2206 [ V \u03c8(tn + s) + f(|\u03c8(tn + s)|2)\u03c8(tn + s) ] ds, n \u2265 0,(2.1)\nwhere we abbreviate \u03c8(x, t) by \u03c8(t) for simplicity of notations when there is no confusion. Let \u03c8[n] := \u03c8[n](x) be the approximation of \u03c8(x, tn) for n \u2265 0. Applying the approximation \u03c8(tn + s) \u2248 \u03c8(tn) for the integrand in (2.1) and integrating out ei(\u03c4\u2212s)\u2206 exactly, we get a semi-discretization in time by the first-order Gautschi-type EWI as\n(2.2) \u03c8[n+1] = \u03a6\u03c4 (\u03c8[n]) := ei\u03c4\u2206\u03c8[n] \u2212 i\u03c4\u03c61(i\u03c4\u2206)\n( V \u03c8[n] + f(|\u03c8[n]|2)\u03c8[n] ) , n \u2265 0,\n\u03c8[0] = \u03c80,\nwhere \u03c61 is an entire function defined as\n\u03c61(z) = ez \u2212 1 z , z \u2208 C.\nThe operator \u03c61(i\u03c4\u2206) is defined through its action in the Fourier space as (\u03c61(i\u03c4\u2206)v) (x)= \u2211 l\u2208Z \u03c61(\u2212i\u03c4\u00b52l )v\u0302lei\u00b5l(x\u2212a)\n= v\u03020 + \u2211\nl\u2208Z\\{0}\n1\u2212 e\u2212i\u03c4\u00b52l i\u03c4\u00b52l v\u0302le i\u00b5l(x\u2212a), x \u2208 \u2126,(2.3)\nwhere \u00b5l = 2\u03c0l b\u2212a for l \u2208 Z, and v\u0302l (l \u2208 Z) are the Fourier coefficients of the function v \u2208 L2(\u2126) defined as\n(2.4) v\u0302l = 1\nb\u2212 a \u222b b a v(x)e\u2212i\u00b5l(x\u2212a)dx, l \u2208 Z.\nFrom (2.3), noting that |1\u2212 e\u2212i\u03b8| \u2264 2 for \u03b8 \u2208 R, we see that (2.5) \u2223\u2223\u2223 \u0302(\u03c61(i\u03c4\u2206)v)l\u2223\u2223\u2223 \u2264  2 \u03c4 |v\u0302l| \u00b52l , l \u2208 Z \\ {0},\n|v\u03020|, l = 0,\nwhich implies \u03c61(i\u03c4\u2206)v \u2208 H2per(\u2126) for all v \u2208 L2(\u2126). Hence, \u03a6\u03c4 is indeed a flow in H2per(\u2126) for any V \u2208 L\u221e(\u2126), making it possible to obtain uniform H2-bound of the semi-discrete solution with some new analysis techniques we will introduce later.\nIn fact, the introduction of the smoothing function \u03c61(i\u03c4\u2206) in (2.2) is one of the major advantages of the EWI (2.2) over the time-splitting methods in terms of controlling the dispersion of high frequencies or resonance. With this smoothing function, one can show that the numerical solution is in H2 at every time step. For comparison, based on the results in [18] for time-splitting methods applied to the NLSE with semi-sooth nonlinearity, the numerical solution of the semi-discretization is not in H2 in general! The situation is even worse if there is purely L\u221e-potential.\n2.2. Full discretization by the Fourier spectral method. Then we further discretize the semi-discretization (2.2) in space by the Fourier spectral method to obtain a full-discretization scheme. Choose a mesh size h = (b\u2212 a)/N with N being a positive integer and denote grid points as\nxj = a+ jh, j = 0, 1, \u00b7 \u00b7 \u00b7 , N.\nDefine the index sets TN = { \u2212N\n2 , \u00b7 \u00b7 \u00b7 , N 2 \u2212 1\n} , T 0N = {0, 1, \u00b7 \u00b7 \u00b7 , N},\nand denote\nXN = span { ei\u00b5l(x\u2212a) : l \u2208 TN } ,(2.6)\nYN = { v = (v0, v1, \u00b7 \u00b7 \u00b7 , vN )T \u2208 CN+1 : v0 = vN } .(2.7)\nLet PN : L 2(\u2126) \u2192 XN be the standard L2-projection onto XN and IN : YN \u2192 XN be the standard Fourier interpolation operator as\n(PNu)(x) = \u2211 l\u2208TN u\u0302le i\u00b5l(x\u2212a),(2.8)\n(INv)(x) = \u2211 l\u2208TN v\u0303le i\u00b5l(x\u2212a), x \u2208 \u2126 = [a, b],(2.9)\nwhere u \u2208 L2(\u2126), v \u2208 YN , u\u0302l (l \u2208 Z) are the Fourier coefficients of u defined in (2.4) and v\u0303l (l \u2208 TN ) are the discrete Fourier transform coefficients defined as\n(2.10) v\u0303l = 1\nN N\u22121\u2211 j=0 vje \u2212i\u00b5l(xj\u2212a), l \u2208 TN .\nLet \u03c8n := \u03c8n(x) be the approximation of \u03c8(x, tn) for n \u2265 0. Then an exponential wave integrator-Fourier spectral method (EWI-FS) for the NLSE (1.1) is given as\n(2.11) \u03c8n+1 = \u03a6\u03c4h(\u03c8\nn) := ei\u03c4\u2206\u03c8n \u2212 i\u03c4\u03c61(i\u03c4\u2206)PN ( V \u03c8n + f(|\u03c8n|2)\u03c8n ) , n \u2265 0,\n\u03c80 = PN\u03c80.\nNote that \u03c8n \u2208 XN for n \u2265 0 and we have\n(2.12) \u0302(\u03c8n+1)l = e \u2212i\u03c4\u00b52l (\u0302\u03c8n)l \u2212 i\u03c4\u03c61(\u2212i\u03c4\u00b5 2 l )\n( (\u0302V \u03c8n)l + G\u0302(\u03c8 n)l ) , n \u2265 0,\n(\u0302\u03c80)l = (\u0302\u03c80)l, l \u2208 TN ,\nwhere G(\u03c8n)(x) = G(\u03c8n(x)) := f(|\u03c8n(x)|2)\u03c8n(x) for x \u2208 \u2126. We remark here that the EWI-FS is usually implemented by the Fourier pseudospectral method (see, e.g., [10, 29]) in practical computations. Of course, due to the low regularity of the potential and/or nonlinearity, it is very hard to establish error bounds for the full-discretization by the Fourier pseudospectral method."
        },
        {
            "heading": "2.3. Full discretization by an extended Fourier pseudospectral method.",
            "text": "In practice, the Fourier spectral method cannot be efficiently implemented. Here, we propose an extended Fourier pseudospectral method when the potential is of low regularity but the nonlinearity is sufficiently smooth, i.e., we adopt the Fourier spectral method to discretize the linear potential and use the Fourier pseudospectral method to discretize the nonlinearity. This full discretization has two advantages: (i) we can establish its optimal error bounds, and (ii) the computational cost of this discretization is similar to the standard Fourier pseudospectral method.\nLet \u03c8 \u27e8n\u27e9 j be the numerical approximation of \u03c8(xj , tn) for j \u2208 T 0N and n \u2265 0, and\ndenote \u03c8\u27e8n\u27e9 := (\u03c8 \u27e8n\u27e9 0 , \u03c8 \u27e8n\u27e9 1 , \u00b7 \u00b7 \u00b7 , \u03c8 \u27e8n\u27e9 N )\nT \u2208 YN . Then an exponential wave integratorextended Fourier pseudospectral (EWI-EFP) method for the NLSE (1.1) reads\n(2.13)\n\u03c8 \u27e8n+1\u27e9 j = \u2211 l\u2208TN e\u2212i\u03c4\u00b5 2 l (\u0303\u03c8\u27e8n\u27e9)le i\u00b5l(xj\u2212a)\n\u2212 i\u03c4 \u2211 l\u2208TN \u03c61(\u2212i\u03c4\u00b52l ) ( \u0302(V IN\u03c8\u27e8n\u27e9)l + \u02dcG(\u03c8\u27e8n\u27e9)l) ei\u00b5l(xj\u2212a), n \u2265 0, \u03c8 \u27e80\u27e9 j = \u03c80(xj), j \u2208 T 0 N ,\nwhere G(\u03c8\u27e8n\u27e9)j = f(|\u03c8\u27e8n\u27e9j |2)\u03c8 \u27e8n\u27e9 j for j \u2208 T 0N . To compute the Fourier projection coefficients \u0302 ( V IN\u03c8\u27e8n\u27e9 ) l , we use an extended FFT as shown below. Note that IN\u03c8\n\u27e8n\u27e9 \u2208 XN for all n \u2265 0, and thus we have\n(2.14) PN (V IN\u03c8 \u27e8n\u27e9) = PN ( P2N (V )IN\u03c8 \u27e8n\u27e9 ) , n \u2265 0.\nMoreover, since P2N (V )IN\u03c8 \u27e8n\u27e9 \u2208 X4N and I4N is an identity on X4N , we have\nP2N (V )IN\u03c8 \u27e8n\u27e9 = I4N ( P2N (V )IN\u03c8 \u27e8n\u27e9 ) , n \u2265 0,\nwhich plugged into (2.14) yields\n(2.15) PN ( V IN\u03c8 \u27e8n\u27e9 ) = PNI4N ( P2N (V )IN\u03c8 \u27e8n\u27e9 ) , n \u2265 0,\nwhere P2N (V ) can be precomputed numerically or analytically, and thus the right hand side of (2.15) can be computed exactly and efficiently using the extended FFT: using FFT for P2N (V )IN\u03c8 \u27e8n\u27e9 with length 4N instead of N . As a result, the memory\ncost is O(4N) and the computational cost per time step is O(4N log(4N)). Note that \u03c8\u27e8n\u27e9 (n \u2265 0) obtained by (2.13) satisfies\n(2.16) IN\u03c8\n\u27e8n+1\u27e9 = ei\u03c4\u2206IN\u03c8 \u27e8n\u27e9 \u2212 i\u03c4\u03c61(i\u03c4\u2206) ( PN ( V IN\u03c8 \u27e8n\u27e9 ) + ING(\u03c8 \u27e8n\u27e9) ) ,\nIN\u03c8 \u27e80\u27e9 = IN\u03c80, n \u2265 0.\n3. Optimal error bounds for the semi-discretization (2.2). In this section, we establish optimal error bounds in L2-norm andH1-norm for the semi-discretization (2.2) of the NLSE (1.1).\n3.1. Main results. For the optimal L2-norm error bound, we assume that the nonlinearity is locally Lipschitz continuous, i.e., there exists a fixed function CLip(\u00b7) : R+ \u2192 R+ such that\n(A) |f(|z1|2)z1 \u2212 f(|z2|2)z2| \u2264 CLip(M0)|z1 \u2212 z2|, zj \u2208 C, |zj | \u2264M0, j = 1, 2.\nAssumption (A) is satisfied by f \u2208 C1((0,\u221e)) satisfying\n|f(\u03c1)|+ |\u03c1f \u2032(\u03c1)| \u2264 L(M0), 0 < \u03c1 \u2264M0\nwith CLip(M0) \u223c L(M0) for M0 > 0. In particular, (A) allows (i) f(\u03c1) = \u03bb1\u03c1 \u03c31 + \u03bb2\u03c1 \u03c32 for any 0 < \u03c31 < \u03c32 and \u03bb1, \u03bb2 \u2208 R with CLip(M0) \u223c\n|\u03bb1|M\u03c310 + |\u03bb2|M \u03c32 0 ;\n(ii) f(\u03c1) = \u03bb\u03c1\u03c3 ln \u03c1 for any \u03c3 > 0 and \u03bb \u2208 R with CLip(M0) \u223c 1 + M\u03c30 + M\u03c30 | lnM0|. For the optimal H1-norm error bound, we assume\n(B) \u2225f(|v|2)v\u2212f(|w|2)w\u2225H1 \u2264 C(\u2225v\u2225H3 , \u2225w\u2225H2)\u2225v\u2212w\u2225H1 , v \u2208 H3(\u2126), w \u2208 H2(\u2126).\nAssumption (B) is satisfied by (i) f(\u03c1) = \u03bb1\u03c1 \u03c31 +\u03bb2\u03c1 \u03c32 for \u03c32 > \u03c31 \u2265 1/2 and \u03bb1, \u03bb2 \u2208 R with C(\u00b7, \u00b7) depending\non \u2225v\u2225H3 and \u2225w\u2225H2 ; (ii) f(\u03c1) = \u03bb\u03c1\u03c3 ln \u03c1 for any \u03c3 > 1/2 and \u03bb \u2208 R with C(\u00b7, \u00b7) depending on \u2225v\u2225H3\nand \u2225w\u2225H2 . We remark here that (B) implies (A) by taking v(x) \u2261 z1 and w(x) \u2261 z2 in (B). Nonlinearity satisfying (B) occurs in physical applications including Lee-Huang-Yang correction [38, 35, 22, 7, 45] and Bose-Fermi mixture [31, 23] in 1D, 2D and 3D, and Schrodinger-Poisson-X\u03b1 model [17, 21] in 2D. Assumption (A) covers, in addition to all those mentioned before, the case of Schrodinger-Poisson-X\u03b1 model in 3D.\nLet Tmax be the maximal existing time of the solution of the NLSE (1.1) and take 0 < T < Tmax be a fixed time. Define\n(3.1) M := max { \u2225\u03c8\u2225L\u221e([0,T ];H2), \u2225\u03c8\u2225L\u221e([0,T ];L\u221e), \u2225\u2202t\u03c8\u2225L\u221e([0,T ];L2), \u2225V \u2225L\u221e } .\nLet \u03c8[n] be the numerical approximation obtained by the EWI (2.2), then we have\nTheorem 3.1. Under the assumptions that V \u2208 L\u221e(\u2126), f satisfies Assumption (A) and the exact solution \u03c8 \u2208 C([0, T ];H2per(\u2126)) \u2229 C1([0, T ];L2(\u2126)), there exists \u03c40 > 0 depending on M and T and sufficiently small such that for any 0 < \u03c4 < \u03c40, we have \u03c8[n] \u2208 H2per(\u2126) for 0 \u2264 n \u2264 T/\u03c4 and\n(3.2) \u2225\u03c8(\u00b7, tn)\u2212 \u03c8[n]\u2225L2 \u2272 \u03c4, \u2225\u03c8[n]\u2225H2 \u2264 C(M), \u2225\u03c8(\u00b7, tn)\u2212 \u03c8[n]\u2225H1 \u2272 \u221a \u03c4 , 0 \u2264 n \u2264 T/\u03c4.\nMoreover, if V \u2208 W 1,4(\u2126) \u2229 H1per(\u2126), f satisfies (B) and \u03c8 \u2208 C([0, T ];H3per(\u2126)) \u2229 C1([0, T ];H1(\u2126)), we have, for 0 < \u03c4 < \u03c40,\n(3.3) \u2225\u03c8(\u00b7, tn)\u2212 \u03c8[n]\u2225H1 \u2272 \u03c4, 0 \u2264 n \u2264 T/\u03c4.\nRemark 3.2. According to the known regularity results (see, e.g. Corollary 4.8.6 in [24]), under the assumptions that V \u2208 L\u221e(\u2126) and (A), it can be expected that \u03c8 \u2208 C([0, T ];H2per(\u2126)) \u2229 C1([0, T ];L2(\u2126)) for some 0 < T < Tmax if \u03c80 \u2208 H2per(\u2126).\nRemark 3.3. Recall that, for the time-splitting methods analyzed in [18] with f(\u03c1) = \u03c1\u03c3, the optimal L2-norm error bound in time is obtained for V \u2208 H2(\u2126) and \u03c3 \u2265 1/2, and the optimal H1-norm error bound in time is obtained for V \u2208 H3(\u2126) and \u03c3 \u2265 1. Hence, our results greatly relax the regularity requirements on both the potential and nonlinearity.\nIn the following, we shall prove Theorem 3.1. We start with the proof of (3.2), and the proof of (3.3) can be obtained by the standard Lady Windermere\u2019s fan argument with the established uniform H2-bound of the semi-discretization solution in (3.2).\nIn the rest of this section, we assume that V \u2208 L\u221e(\u2126), f satisfies Assumption (A) and \u03c8 \u2208 C([0, T ];H2per(\u2126)) \u2229 C1([0, T ];L2(\u2126)).\n3.2. Local truncation error. We define an operator B : L\u221e(\u2126) \u2192 L\u221e(\u2126) as\n(3.4) B(v) = V v + f(|v|2)v, v \u2208 L\u221e(\u2126).\nand define a constant CL(\u00b7) := \u2225V \u2225L\u221e + CLip(\u00b7) with CLip(\u00b7) given by Assumption (A). For the operator B, we have\nLemma 3.4. Let v, w \u2208 L\u221e(\u2126) satisfying \u2225v\u2225L\u221e \u2264M0 and \u2225w\u2225L\u221e \u2264M0, then\n(3.5) \u2225B(v)\u2212B(w)\u2225L2 \u2264 CL(M0)\u2225v \u2212 w\u2225L2 .\nProof. Recalling (3.4) and (A), we have\n\u2225B(v)\u2212B(w)\u2225L2 = \u2225V (v \u2212 w) + f(|v|2)v \u2212 f(|w|2)w\u2225L2 \u2264 \u2225V \u2225L\u221e\u2225v \u2212 w\u2225L2 + CLip(M0)\u2225v \u2212 w\u2225L2 = CL(M0)\u2225v \u2212 w\u2225L2 ,\nwhich completes the proof.\nLemma 3.5. For 0 \u2264 n \u2264 T/\u03c4 \u2212 1, define\n(3.6) gn(t) := B(\u03c8(tn + t))\u2212B(\u03c8(tn)), 0 \u2264 t \u2264 \u03c4.\nThen gn \u2208 C([0, \u03c4 ];L2(\u2126)) \u2229W 1,\u221e([0, \u03c4 ];L2(\u2126)) satisfies\n\u2225gn\u2225L\u221e([0,\u03c4 ];L2) \u2264 CL(M)M\u03c4,(3.7) \u2225\u2202tgn\u2225L\u221e([0,\u03c4 ];L2) \u2264 CL(M)M.(3.8)\nProof. Using Lemma 3.4, we have, for 0 \u2264 s < t \u2264 \u03c4 ,\n\u2225gn(t)\u2212 gn(s)\u2225L2= \u2225B(\u03c8(tn + t))\u2212B(\u03c8(tn + s))\u2225L2 \u2264 CL(M)\u2225\u03c8(tn + t)\u2212 \u03c8(tn + s)\u2225L2\n\u2264 CL(M) \u222b t s \u2225\u2202t\u03c8(tn + \u03c3)\u2225L2d\u03c3.(3.9)\nFrom (3.9), recalling (A), one has gn \u2208 C([0, \u03c4 ];L2(\u2126)), and, by using Lemma 3.4 again, one has\n\u2225gn(t)\u2225L2 = \u2225B(\u03c8(tn + t))\u2212B(\u03c8(tn))\u2225L2 \u2264 CL(M)\u2225\u03c8(tn + t)\u2212 \u03c8(tn)\u2225L2 \u2264 \u03c4CL(M)\u2225\u2202t\u03c8\u2225L\u221e([tn,tn+\u03c4 ];L2) \u2264 CL(M)M\u03c4,\nwhich proves (3.7). Noting (3.9), from the standard theory of Sobolev spaces (see, e.g., Proposition 1.3.12 in [24]), we have gn \u2208 W 1,\u221e([0, T ];L2(\u2126)) and, by letting \u03c6(\u03c3) = CL(M)\u2225\u2202t\u03c8(tn + \u03c3)\u2225L2 for 0 \u2264 \u03c3 \u2264 \u03c4 ,\n\u2225\u2202tgn\u2225L\u221e([0,\u03c4 ];L2) \u2264 \u2225\u03c6\u2225L\u221e([0,\u03c4 ]) \u2264 CL(M)M,\nwhich concludes the proof.\nSimilar to Lemma 4.8.5 in [24], we have\nLemma 3.6. Assume \u03c4 > 0 and g \u2208 C([0, \u03c4 ];L2(\u2126)) \u2229W 1,1([0, \u03c4 ];L2(\u2126)). If\n(3.10) w(t) = \u2212i \u222b t 0 ei(t\u2212s)\u2206g(s)ds, t \u2208 [0, \u03c4 ],\nthen we have\n(3.11) \u2225\u2206w\u2225L\u221e([0,\u03c4 ];L2) \u2264 \u2225g\u2225L\u221e([0,\u03c4 ];L2) + \u2225g(0)\u2225L2 + \u2225\u2202tg\u2225L1([0,\u03c4 ];L2).\nProof. Taking the time derivative on both sides of (3.10) and noting that g \u2208 W 1,1([0, \u03c4 ];L2(\u2126)), we have for 0 \u2264 t \u2264 \u03c4\n\u2202tw(t) = \u2212i d\ndt \u222b t 0 eis\u2206g(t\u2212 s)ds= \u2212ieit\u2206g(0)\u2212 i \u222b t 0 eis\u2206\u2202tg(t\u2212 s)ds\n= \u2212ieit\u2206g(0)\u2212 i \u222b t 0 ei(t\u2212s)\u2206\u2202tg(s)ds.(3.12)\nFrom (3.12), using the isometry property of eit\u2206, we have\n(3.13) \u2225\u2202tw(t)\u2225L2 \u2264 \u2225g(0)\u2225L2 + \u2225\u2202tg\u2225L1([0,\u03c4 ];L2), 0 \u2264 t \u2264 \u03c4.\nNote that w defined in (3.10) satisfies the equation\ni\u2202tw = \u2212\u2206w + g, 0 \u2264 t \u2264 \u03c4,\nwhich implies, by using (3.13),\n(3.14) \u2225\u2206w(t)\u2225L2 \u2264 \u2225\u2202tw(t)\u2225L2 + \u2225g(t)\u2225L2 \u2264 \u2225g(0)\u2225L2 + \u2225\u2202tg\u2225L1([0,\u03c4 ];L2)+ \u2225g(t)\u2225L2 ,\nand the conclusion follows from taking supremum of t on both sides.\nNow we can obtain the following local truncation error estimates.\nProposition 3.7 (local truncation error). For 0 \u2264 n \u2264 T/\u03c4 \u2212 1, we have\n(3.15) \u2225\u03c8(tn+1)\u2212 \u03a6\u03c4 (\u03c8(tn))\u2225H\u03b1 \u2264 C(M)\u03c42\u2212\u03b1/2, 0 \u2264 \u03b1 \u2264 2,\nwhere C(M) \u223c CL(M)M .\nProof. Recalling (2.1) and (3.4), we have\n(3.16) \u03c8(tn+1) = e i\u03c4\u2206\u03c8(tn)\u2212 i \u222b \u03c4 0 ei(\u03c4\u2212s)\u2206B(\u03c8(tn + s))ds, 0 \u2264 n \u2264 T/\u03c4 \u2212 1.\nBy the construction of the EWI (2.2) and (3.4), we have\n(3.17) \u03a6\u03c4 (\u03c8(tn)) = e i\u03c4\u2206\u03c8(tn)\u2212 i \u222b \u03c4 0 ei(\u03c4\u2212s)\u2206B(\u03c8(tn))ds, 0 \u2264 n \u2264 T/\u03c4 \u2212 1.\nSubtracting (3.17) from (3.16) and recalling (3.6), we have \u03c8(tn+1)\u2212 \u03a6\u03c4 (\u03c8(tn))= \u2212i \u222b \u03c4 0 ei(\u03c4\u2212s)\u2206(B(\u03c8(tn + s))\u2212B(\u03c8(tn)))ds\n= \u2212i \u222b \u03c4 0 ei(\u03c4\u2212s)\u2206gn(s)ds, 0 \u2264 n \u2264 T/\u03c4 \u2212 1.(3.18)\nFrom (3.18), using (3.7), one gets (3.19) \u2225\u03c8(tn+1)\u2212 \u03a6\u03c4 (\u03c8(tn))\u2225L2 \u2264 \u222b \u03c4 0 \u2225gn(s)\u2225L2ds \u2264 CL(M)M\u03c42,\nwhich proves (3.15) for \u03b1 = 0. Then we shall establish (3.15) with \u03b1 = 2, and (3.15) with 0 < \u03b1 < 2 will follow from the Gagliardo-Nirenberg interpolation inequalities. Applying Lemma 3.6 to (3.18), using (3.8) and noting gn(0) = 0, we have\n\u2225\u2206(\u03c8(tn+1)\u2212 \u03a6\u03c4 (\u03c8(tn)))\u2225L2 \u2264 \u2225gn\u2225L\u221e([0,\u03c4 ];L2) + \u2225gn(0)\u2225L2 + \u2225\u2202tgn\u2225L1([0,\u03c4 ];L2) \u2264 CL(M)M\u03c4 + \u03c4\u2225\u2202tgn\u2225L\u221e([0,\u03c4 ];L2) \u2264 2CL(M)M\u03c4,(3.20)\nwhich combined with (3.19) implies\n(3.21) \u2225\u03c8(tn+1)\u2212 \u03a6\u03c4 (\u03c8(tn))\u2225H2 \u2264 C(M)\u03c4, 0 \u2264 n \u2264 T/\u03c4 \u2212 1,\nwhere C(M) \u223c CL(M)M . The conclusion follows from (3.19) and (3.21) and the Gagliardo-Nirenberg interpolation inequalities.\nRemark 3.8. In (3.19), the optimal local truncation error in L2-norm is obtained with the boundedness of \u2225\u2202tB(\u03c8(t))\u2225L2 (recalling Lemma 3.5) instead of \u2225\u2206B(\u03c8(t))\u2225L2 in the time-splitting methods [18].\n3.3. L\u221e-conditional stability estimate of (2.2). Then we shall establish the L\u221e-conditional stability estimate of the numerical flow (2.2). The key is the following lemma, which can be understood as the smoothing effect of the operator \u03c61(i\u03c4\u2206), which is another major advantage of the EWI (2.2).\nLemma 3.9. Let v, w \u2208 L2(\u2126) and 0 < \u03c4 < 1. Then we have\n\u2225\u03c61(i\u03c4\u2206)v \u2212 \u03c61(i\u03c4\u2206)w\u2225H\u03b1 \u2264 C(\u03b1)\u03c4\u2212\u03b1/2\u2225v \u2212 w\u2225L2 , 0 \u2264 \u03b1 \u2264 2,\nwhere C(\u03b1) = 2 \u03b1 2 (1 + \u00b5\u221221 ) \u03b1 2 .\nProof. It suffices to show that for any v \u2208 L2(\u2126),\n(3.22) \u2225\u03c61(i\u03c4\u2206)v\u2225H\u03b1 \u2264 C(\u03b1)\u03c4\u2212\u03b1/2\u2225v\u2225L2 , 0 \u2264 \u03b1 \u2264 2.\nNote that\n(3.23) |ei\u03b8 \u2212 1| \u2264 2\u03b3\u03b81\u2212\u03b3 , \u03b8 \u2208 R, 0 \u2264 \u03b3 \u2264 1.\nBy Parseval\u2019s identity, using (3.23) with \u03b3 = \u03b1/2 and recalling (2.3), we have\n1\nb\u2212 a \u2225\u03c61(i\u03c4\u2206)v\u22252H\u03b1 = \u2211 l\u2208Z (1 + \u00b52l ) \u03b1|\u03c61(\u2212i\u03c4\u00b52l )|2|v\u0302l|2\n= |v\u03020|2 + \u2211\nl\u2208Z\\{0}\n(1 + \u00b52l ) \u03b1 \u2223\u2223\u2223\u2223\u2223ei\u03c4\u00b5 2 l \u2212 1 \u03c4\u00b52l \u2223\u2223\u2223\u2223\u2223 2 |v\u0302l|2\n\u2264 |v\u03020|2 + 2\u03b1 \u2211\nl\u2208Z\\{0}\n(1 + \u00b52l ) \u03b1 ( \u03c4\u00b52l )\u2212\u03b1 |v\u0302l|2 = |v\u03020|2 + 2\u03b1\u03c4\u2212\u03b1\n\u2211 l\u2208Z\\{0} ( 1 + \u00b52l \u00b52l )\u03b1 |v\u0302l|2\n\u2264 |v\u03020|2 + C(\u03b1)2\u03c4\u2212\u03b1 \u2211\nl\u2208Z\\{0}\n|v\u0302l|2\n\u2264 C(\u03b1)2\u03c4\u2212\u03b1 \u2211 l\u2208Z |v\u0302l|2 = C(\u03b1)2\u03c4\u2212\u03b1 1 b\u2212 a \u2225v\u22252L2 ,\nwhich proves (3.22) and concludes the proof.\nWith Lemma 3.9, we are able to obtain the stability estimate of the numerical flow (2.2) up to H2 without additional regularity on the potential and nonlinearity.\nProposition 3.10 (stability estimate). Let v, w \u2208 H2per(\u2126) such that \u2225v\u2225L\u221e \u2264 M0 and \u2225w\u2225L\u221e \u2264M0 and let 0 < \u03c4 < 1. Then we have, for 0 \u2264 \u03b1 \u2264 2,\n\u2225\u03a6\u03c4 (v)\u2212 \u03a6\u03c4 (w)\u2225H\u03b1 \u2264 \u2225v \u2212 w\u2225H\u03b1 + C(M0)\u03c41\u2212\u03b1/2\u2225v \u2212 w\u2225L2 .\nProof. Recalling (2.2) and (3.4), we have\n(3.24) \u03a6\u03c4 (u) = ei\u03c4\u2206u\u2212 i\u03c4\u03c61(i\u03c4\u2206)B(u), u \u2208 H2per(\u2126).\nTaking u = v and u = w in (3.24), subtracting one from the other and using the isometry property of eit\u2206, Lemma 3.9 and Lemma 3.4, we have\n\u2225\u03a6\u03c4 (v)\u2212 \u03a6\u03c4 (w)\u2225H\u03b1 \u2264 \u2225ei\u03c4\u2206v \u2212 ei\u03c4\u2206w\u2225H\u03b1 + \u03c4\u2225\u03c61(i\u03c4\u2206)(B(v)\u2212B(w))\u2225H\u03b1\n\u2264 \u2225v \u2212 w\u2225H\u03b1 + C(\u03b1)\u03c41\u2212\u03b1/2\u2225B(v)\u2212B(w)\u2225L2 \u2264 \u2225v \u2212 w\u2225H\u03b1 + C(\u03b1)\u03c41\u2212\u03b1/2CL(M0)\u2225v \u2212 w\u2225L2 .\nThe conclusion follows from letting C(M0) = C(\u03b1)CL(M0) with \u03b1 = 2.\n3.4. Proof of the optimal L2-error bound (3.2). With the local truncation error estimate in Proposition 3.7 and the L\u221e-conditional stability estimate in Proposition 3.10, we can prove (3.2) by mathematical induction.\nProof of (3.2) in Theorem 3.1. Define the error function e[n] := \u03c8(tn)\u2212 \u03c8[n] for 0 \u2264 n \u2264 T/\u03c4 . For 0 \u2264 n \u2264 T/\u03c4 \u2212 1 and 0 \u2264 \u03b1 \u2264 2, we have\n\u2225e[n+1]\u2225H\u03b1= \u2225\u03c8(tn+1)\u2212 \u03c8[n+1]\u2225H\u03b1 = \u2225\u03c8(tn+1)\u2212 \u03a6\u03c4 (\u03c8[n])\u2225H\u03b1 \u2264 \u2225\u03c8(tn+1)\u2212 \u03a6\u03c4 (\u03c8(tn))\u2225H\u03b1 + \u2225\u03a6\u03c4 (\u03c8(tn))\u2212 \u03a6\u03c4 (\u03c8[n])\u2225H\u03b1 .(3.25)\nIn the following, we first establish the error bounds in L2-norm and H 7 4 -norm together by the mathematical induction, which, in particular, yield the uniform L\u221e-bound of \u03c8[n]. With the uniform L\u221e-bound, we can obtain the uniform H2-bound of \u03c8[n]. The error bound in H1-norm will follow from the error bound in L2-norm and the uniform H2-bound by using the standard interpolation inequalities.\nLet C0 := max{C(1 + M),M, 1} \u2265 1 with M given in (3.1) and C(\u00b7) defined in Proposition 3.10, and C1 := C(M) with C(\u00b7) defined in Proposition 3.7. Let 0 < \u03c40 < 1 be chosen such that\n(3.26) 2C0Te C0TC1\u03c4 1 8 0 \u2264 1/c,\nwhere c is the constant given by the Sobolev embedding H 7 4 \u21aa\u2192 L\u221e. We are going to prove that when 0 < \u03c4 < \u03c40, we have, for 0 \u2264 n \u2264 T/\u03c4 ,\n(3.27) \u2225e[n]\u2225L2 \u2264 eC0TC1\u03c4, \u2225e[n]\u2225H 74 \u2264 2C0Te C0TC1\u03c4 1 8 .\nWe shall prove (3.27) by mathematical induction. When n = 0, e[n] = \u03c8[0] \u2212 \u03c80 = 0, and (3.27) holds trivially. We assume that (3.27) holds for 0 \u2264 n \u2264 m \u2264 T/\u03c4 \u2212 1. Under this assumption, we have, by Sobolev embedding, \u03c4 < \u03c40 and (3.26),\n(3.28) \u2225\u03c8[n]\u2225L\u221e \u2264 \u2225\u03c8(tn)\u2225L\u221e + \u2225e[n]\u2225L\u221e \u2264M + c\u2225e[n]\u2225 H 7 4 \u2264M + 1, 0 \u2264 n \u2264 m.\nTaking \u03b1 = 0 and \u03b1 = 7/4 in (3.25), we have for 0 \u2264 n \u2264 T/\u03c4 \u2212 1,\n\u2225e[n+1]\u2225L2 \u2264 \u2225\u03c8(tn+1)\u2212 \u03a6\u03c4 (\u03c8(tn))\u2225L2 + \u2225\u03a6\u03c4 (\u03c8(tn))\u2212 \u03a6\u03c4 (\u03c8[n])\u2225L2 ,(3.29) \u2225e[n+1]\u2225\nH 7 4 \u2264 \u2225\u03c8(tn+1)\u2212 \u03a6\u03c4 (\u03c8(tn))\u2225 H 7 4 + \u2225\u03a6\u03c4 (\u03c8(tn))\u2212 \u03a6\u03c4 (\u03c8[n])\u2225 H 7 4 .(3.30)\nUsing Propositions 3.7 and 3.10 with \u03b1 = 0 and \u03b1 = 7/4 for (3.29) and (3.30), respectively, and noting (3.28), we have for 0 \u2264 n \u2264 m,\n\u2225e[n+1]\u2225L2 \u2264 (1 + C0\u03c4)\u2225e[n]\u2225L2 + C1\u03c42,(3.31)\n\u2225e[n+1]\u2225 H 7 4 \u2264 \u2225e[n]\u2225 H 7 4 + C0\u03c4 1 8 \u2225e[n]\u2225L2 + C1\u03c41+ 1 8 .(3.32)\nFrom (3.31), using the standard discrete Gronwall\u2019s inequality, we have\n(3.33) \u2225e[m+1]\u2225L2 \u2264 eC0TC1\u03c4.\nFrom (3.32), using the assumption that (3.27) holds for 0 \u2264 n \u2264 m, we have\n(3.34) \u2225e[n+1]\u2225 H 7 4 \u2264 \u2225e[n]\u2225 H 7 4 + C0\u03c4 1 8 eC0TC1\u03c4 + C1\u03c4 1+ 18 , 0 \u2264 n \u2264 m.\nSumming over n from 0 to m in (3.34), noting that e[0] = 0 and C0 \u2265 1, we obtain\n\u2225e[m+1]\u2225 H 7 4 \u2264 C0\u03c4 1 8 eC0TC1m\u03c4 + C1m\u03c4 1+ 18\n\u2264 C0TeC0TC1\u03c4 1 8 + C1T\u03c4 1 8\n\u2264 2C0TeC0TC1\u03c4 1 8 .(3.35)\nCombing (3.33) and (3.35), we prove (3.27) for n = m+1, and thus for all 0 \u2264 n \u2264 T/\u03c4 by mathematical induction.\nThen we prove the uniform H2 bound of \u03c8[n]. We first note that (3.28) now holds for any 0 \u2264 n \u2264 T/\u03c4 . Taking \u03b1 = 2 in (3.25), using Propositions 3.7 and 3.10 with \u03b1 = 2 and (3.27), we have for 0 \u2264 n \u2264 T/\u03c4 \u2212 1,\n\u2225e[n+1]\u2225H2\u2264 \u2225\u03a8\u03c4 (\u03c8(tn))\u2212 \u03a6\u03c4 (\u03c8(tn))\u2225H2 + \u2225\u03a6\u03c4 (\u03c8(tn))\u2212 \u03a6\u03c4 (\u03c8[n])\u2225H2 \u2264 \u2225e[n]\u2225H2 + C0\u2225e[n]\u2225L2 + C1\u03c4 \u2264 \u2225e[n]\u2225H2 + C0eC0TC1\u03c4 + C1\u03c4.(3.36)\nSumming (3.36) from 0 to n\u2212 1, we obtain\n(3.37) \u2225e[n]\u2225H2 \u2264 C0eC0TC1n\u03c4 + C1n\u03c4 \u2264 2C0eC0TC1T, 0 \u2264 n \u2264 T/\u03c4.\nFinally, combining (3.27) and (3.37), and using the interpolation inequality for the H1-error bound, we prove (3.2).\n3.5. Proof of the optimal H1-error bound (3.3). To prove (3.3), we assume that V \u2208 W 1,4(\u2126) \u2229 H1per(\u2126), f satisfies Assumption (B), \u03c8 \u2208 C([0, T ];H3per(\u2126)) \u2229 C1([0, T ];H1(\u2126)) and 0 < \u03c4 < \u03c40 with \u03c40 given in (3.26). Under the assumptions above, B : H1per(\u2126) \u2192 H1per(\u2126) satisfies\n(3.38) \u2225B(v)\u2212B(w)\u2225H1 \u2264 C(\u2225v\u2225H3 , \u2225w\u2225H2 , \u2225V \u2225W 1,4(\u2126))\u2225v\u2212w\u2225H1 , v, w \u2208 H2(\u2126).\nProof of (3.3) in Theorem 3.1. From (3.18), using (3.38) and the isometry property of eit\u2206, and noting that \u03c8 \u2208 C1([0, T ];H1(\u2126)), we have, for 0 \u2264 n \u2264 T/\u03c4 \u2212 1,\n(3.39) \u2225\u03c8(tn+1)\u2212 \u03a6\u03c4 (\u03c8(tn))\u2225H1 \u2264 \u222b \u03c4 0 \u2225B(\u03c8(tn + s))\u2212B(\u03c8(tn))\u2225H1ds \u2272 \u03c42.\nNoting that |\u03c61(i\u03b8)| \u2264 1 for \u03b8 \u2208 R, we have\n(3.40) \u2225\u03c61(i\u03c4\u2206)v\u2225H1 \u2264 \u2225v\u2225H1 , v \u2208 H1per(\u2126),\nwhich implies, by recalling (3.24) and using (3.38) again,\n\u2225\u03a6\u03c4 (\u03c8(tn))\u2212 \u03a6\u03c4 (\u03c8[n])\u2225H1\u2264 \u2225\u03c8(tn)\u2212 \u03c8[n]\u2225H1 + \u03c4\u2225B(\u03c8(tn))\u2212B(\u03c8[n])\u2225H1 \u2264 (1 + C\u03c4)\u2225\u03c8(tn)\u2212 \u03c8[n]\u2225H1 , 0 \u2264 n \u2264 T/\u03c4 \u2212 1,(3.41)\nwhere C depends on \u2225V \u2225W 1,4 , \u2225\u03c8(tn)\u2225H3 and \u2225\u03c8[n]\u2225H2 , which are uniformly bounded. Then (3.3) follows from (3.39) and (3.41) by the standard Lady Windermere\u2019s fan argument.\n4. Optimal error bounds for the full discretization (2.11). In this section, we establish optimal error bounds in L2- and H1-norm for the full-discretization scheme EWI-FS (2.11), and generalize them to the EWI-EFP scheme (2.13).\n4.1. Main results. For \u03c8n (0 \u2264 n \u2264 T/\u03c4) obtained by the EWI-FS scheme (2.11), we have\nTheorem 4.1. Assume that V \u2208 L\u221e(\u2126), f satisfies Assumption (A) and the exact solution \u03c8 \u2208 C([0, T ];H2per(\u2126)) \u2229 C1([0, T ];L2(\u2126)), there exists \u03c40 > 0 and h0 > 0 depending on M and T and sufficiently small such that for any 0 < \u03c4 < \u03c40 and 0 < h < h0, we have\n(4.1) \u2225\u03c8(\u00b7, tn)\u2212 \u03c8n\u2225L2 \u2272 \u03c4 + h2, \u2225\u03c8n\u2225H2 \u2264 C(M), \u2225\u03c8(\u00b7, tn)\u2212 \u03c8n\u2225H1 \u2272 \u221a \u03c4 + h, 0 \u2264 n \u2264 T/\u03c4.\nMoreover, if V \u2208 W 1,4(\u2126) \u2229 H1per(\u2126), f satisfies (B) and \u03c8 \u2208 C([0, T ];H3per(\u2126)) \u2229 C1([0, T ];H1(\u2126)), we have, for 0 < \u03c4 < \u03c40 and 0 < h < h0,\n(4.2) \u2225\u03c8(\u00b7, tn)\u2212 \u03c8n\u2225L2 \u2272 \u03c4 + h3, \u2225\u03c8(\u00b7, tn)\u2212 \u03c8n\u2225H1 \u2272 \u03c4 + h2, 0 \u2264 n \u2264 T/\u03c4.\nRemark 4.2. Thanks to the strong H2-control of the semi-discretization solution in (3.2), there is no coupling condition between \u03c4 and h for all 1 \u2264 d \u2264 3 in Theorem 4.1.\nIn the following, we shall prove Theorem 4.1. We use different methods to prove (4.1) and (4.2). For the L2-norm error bound (4.1), we compare the full-discretization solution \u03c8n with the semi-discretization solution \u03c8[n] to avoid the coupling condition between \u03c4 and h when using the inverse inequalities. Then, for the H1-norm error bound (4.2), we can directly compare the full-discretization solution with the exact solution since we already have control of the full-discretization solution in H2-norm.\nIn the rest of this section, we assume that V \u2208 L\u221e(\u2126), f satisfies Assumption (A) and \u03c8 \u2208 C([0, T ];H2per(\u2126)) \u2229 C1([0, T ];L2(\u2126)).\n4.2. Proof of the optimal L2-error bound (4.1). We start with the error estimates between the semi-discretization solution \u03c8[n] and the full-discretization solution \u03c8n.\nProposition 4.3. Let 0 < \u03c4 < \u03c40 with \u03c40 given in Theorem 3.1. Then there exists h0 depending on M and T and small enough such that for 0 < h < h0, we have\n\u2225PN\u03c8[n] \u2212 \u03c8n\u2225L2 \u2264 C(M,T )h2, 0 \u2264 n \u2264 T/\u03c4.\nProof. Define the error function en := PN\u03c8 [n] \u2212 \u03c8n for 0 \u2264 n \u2264 T/\u03c4 . Then e0 = PN\u03c8 [0]\u2212\u03c80 = 0. Applying PN on both sides of (2.2), noting that PN commutes with ei\u03c4\u2206 and \u03c61(i\u03c4\u2206) and recalling (3.4), we have\n(4.3) PN\u03c8 [n+1] = ei\u03c4\u2206PN\u03c8 [n] \u2212 i\u03c4\u03c61(i\u03c4\u2206)PNB(\u03c8[n]), 0 \u2264 n \u2264 T/\u03c4 \u2212 1.\nRecalling (2.11) and (3.4), we have\n(4.4) \u03c8n+1 = ei\u03c4\u2206\u03c8n \u2212 i\u03c4\u03c61(i\u03c4\u2206)PNB(\u03c8n), 0 \u2264 n \u2264 T/\u03c4 \u2212 1.\nSubtracting (4.4) from (4.3), we have, for 0 \u2264 n \u2264 T/\u03c4 \u2212 1,\n(4.5) en+1 = ei\u03c4\u2206en \u2212 i\u03c4\u03c61(i\u03c4\u2206)PN (B(\u03c8[n])\u2212B(\u03c8n)).\nFrom (4.5), using the isometry property of eit\u2206, the L2-projection property of PN and Lemma 3.9 with \u03b1 = 0, we have, for 0 \u2264 n \u2264 T/\u03c4 \u2212 1,\n\u2225en+1\u2225L2 \u2264 \u2225en\u2225L2 + \u03c4\u2225\u03c61(i\u03c4\u2206)PN ((B(\u03c8[n])\u2212B(\u03c8n))\u2225L2 \u2264 \u2225en\u2225L2 + \u03c4\u2225(B(\u03c8[n])\u2212B(\u03c8n)\u2225L2 \u2264 \u2225en\u2225L2 + \u03c4\u2225(B(\u03c8[n])\u2212B(PN\u03c8[n])\u2225L2 + \u03c4\u2225(B(PN\u03c8[n])\u2212B(\u03c8n)\u2225L2 .(4.6)\nBy (3.2), using Sobolev embedding and the boundedness of PN , we have\n(4.7) \u2225PN\u03c8[n]\u2225L\u221e \u2264 c\u0303\u2225PN\u03c8[n]\u2225H2 \u2264 c\u0303\u2225\u03c8[n]\u2225H2 \u2264 c\u0303C(M) =:M0, 0 \u2264 n \u2264 T/\u03c4,\nwhere c\u0303 is given by the Sobolev embedding H2 \u21aa\u2192 L\u221e. Similarly, \u2225\u03c8[n]\u2225L\u221e \u2264 M0. From (4.6), noting (4.7), using Lemma 3.4, the uniform H2-bound in (3.2), and the\nstandard projection error estimate \u2225\u03d5 \u2212 PN\u03d5\u2225L2 \u2272 h2|\u03d5|H2 \u2200\u03d5 \u2208 H2per(\u2126), we have, for 0 \u2264 n \u2264 T/\u03c4 \u2212 1,\n(4.8) \u2225en+1\u2225L2 \u2264 \u2225en\u2225L2 + CL(max{M0, \u2225\u03c8n\u2225L\u221e})\u03c4\u2225en\u2225L2 + C\u03031\u03c4h2,\nwhere C\u03031 depends exclusively on M . The conclusion then follows from the discrete Gronwall\u2019s inequality and the standard induction argument by using the inverse inequality [50]\n(4.9) \u2225\u03d5\u2225L\u221e \u2264 Cinvh\u2212 d 2 \u2225\u03d5\u2225L2 , \u03d5 \u2208 XN ,\nwhere d is the dimension of the space, i.e. d = 1 in the current case. For the convenience of the reader, we present this process in the following.\nLet C\u03030 := CL(1 +M0) with CL(\u00b7) given in Lemma 3.4 and recall C\u03031 given by (4.8). Let 0 < h0 < 1 be chosen such that\n(4.10) Cinve C\u03030T C\u03031h 2\u2212d/2 0 \u2264 1.\nWe shall show that, when 0 < h < h0, for 0 \u2264 n \u2264 T/\u03c4 ,\n(4.11) \u2225en\u2225L2 \u2264 eC\u03030T C\u03031h2, \u2225\u03c8n\u2225L\u221e \u2264 1 +M0.\nRecall that e0 = 0, and by (4.7), \u2225\u03c80\u2225L\u221e = \u2225PN\u03c80\u2225L\u221e = \u2225PN\u03c8[0]\u2225L\u221e \u2264 M0. Then (4.11) holds for n = 0. Assume that (4.11) holds for 0 \u2264 n \u2264 m \u2264 T/\u03c4 \u2212 1, which implies, from (4.8),\n(4.12) \u2225en+1\u2225L2 \u2264 (1 + C\u03030\u03c4)\u2225en\u2225L2 + C\u03031\u03c4h2, 0 \u2264 n \u2264 m,\nwhich further implies, by using discrete Gronwall\u2019s inequality,\n(4.13) \u2225em+1\u2225L2 \u2264 eC\u03030T C\u03031h2.\nFrom (4.13), using (4.9), recalling (4.7) and (4.10), we have, by triangle inequality,\n(4.14) \u2225\u03c8m+1\u2225L\u221e \u2264 \u2225em+1\u2225L\u221e + \u2225PN\u03c8[m+1]\u2225L\u221e \u2264 Cinvh2\u2212d/2\u2225em+1\u2225L2 +M0\n\u2264 CinveC\u03030T C\u03031h2\u2212d/2 +M0 \u2264 1 +M0.\nCombing (4.13) and (4.14) proves (4.11) for n = m+ 1, and thus for all 0 \u2264 n \u2264 T/\u03c4 by mathematical induction, which completes the proof.\nProof of (4.1) in Theorem 4.1. By triangle inequality, for 0 \u2264 \u03b1 \u2264 2,\n(4.15) \u2225\u03c8(tn)\u2212\u03c8n\u2225H\u03b1 \u2264 \u2225\u03c8(tn)\u2212\u03c8[n]\u2225H\u03b1 +\u2225\u03c8[n]\u2212PN\u03c8[n]\u2225H\u03b1 +\u2225PN\u03c8[n]\u2212\u03c8n\u2225H\u03b1 .\nFrom (3.2), using the interpolation inequalities, we have\n(4.16) \u2225\u03c8(tn)\u2212 \u03c8[n]\u2225H\u03b1 \u2272 \u03c41\u2212\u03b1/2, 0 \u2264 \u03b1 \u2264 2.\nFrom (4.15), using (4.16) and the standard Fourier projection error estimates\n(4.17) \u2225\u03d5\u2212 PN\u03d5\u2225H\u03b1 \u2272 h2\u2212\u03b1|\u03d5|H2 , 0 \u2264 \u03b1 \u2264 2, \u03d5 \u2208 H2per(\u2126),\nand noting (3.2), we have\n(4.18) \u2225\u03c8(tn)\u2212 \u03c8n\u2225H\u03b1 \u2272 \u03c41\u2212\u03b1/2 + h2\u2212\u03b1 + \u2225PN\u03c8[n] \u2212 \u03c8n\u2225H\u03b1 .\nFrom (4.18), using the inverse estimate \u2225\u03d5\u2225H\u03b1 \u2272 h\u2212\u03b1\u2225\u03d5\u2225L2 \u2200\u03d5 \u2208 XN [30, 50] and Proposition 4.3, we have\n(4.19) \u2225\u03c8n \u2212 \u03c8(tn)\u2225H\u03b1 \u2272 \u03c41\u2212\u03b1/2 + h2\u2212\u03b1 + h\u2212\u03b1h2 \u2272 \u03c41\u2212\u03b1/2 + h2\u2212\u03b1, 0 \u2264 \u03b1 \u2264 2,\nwhich proves (4.1) by taking \u03b1 = 0, 1, 2.\n4.3. Proof of the optimal H1-error bound (4.2). To prove (4.2), we assume that V \u2208 W 1,4(\u2126) \u2229 H1per(\u2126), f satisfies Assumption (B), \u03c8 \u2208 C([0, T ];H3per(\u2126)) \u2229 C1([0, T ];H1(\u2126)) and 0 < \u03c4 < \u03c40, 0 < h < h0. Since we already have the uniform control of \u03c8n in H2-norm, (4.2) can be proved similarly to (3.3), and we just sketch the outline here.\nProof of (4.2) in Theorem 4.1. Recalling (2.11) and (3.16), we have\nPN\u03c8(tn+1)\u2212 \u03a6\u03c4h(PN\u03c8(tn)) = \u2212i \u222b \u03c4 0 ei(\u03c4\u2212s)\u2206PN (B(\u03c8(tn + s))\u2212B(PN\u03c8(tn))) ds, 0 \u2264 n \u2264 T \u03c4 \u2212 1,(4.20)\nwhich implies, by the property of eit\u2206 and PN , for X = L 2 or H1, that\n\u2225PN\u03c8(tn+1)\u2212 \u03a6\u03c4h(PN\u03c8(tn))\u2225X \u2264 \u222b \u03c4 0 (\u2225B(\u03c8(tn + s))\u2212B(\u03c8(tn))\u2225X + \u2225B(\u03c8(tn))\u2212B(PN\u03c8(tn))\u2225X) ds.(4.21)\nFrom (4.21), using Lemma 3.4 and (3.38), we have, for 0 \u2264 n \u2264 T/\u03c4 \u2212 1,\n(4.22) \u2225PN\u03c8(tn+1)\u2212 \u03a6\u03c4h(PN\u03c8(tn))\u2225L2 \u2272 \u03c42 + \u03c4h3, \u2225PN\u03c8(tn+1)\u2212 \u03a6\u03c4h(PN\u03c8(tn))\u2225H1 \u2272 \u03c42 + \u03c4h2.\nBesides, recalling (2.11), using Lemmas 3.4 and 3.9, (3.22) and (3.38), we have\n(4.23) \u2225\u03a6\u03c4h(PN\u03c8(tn))\u2212 \u03a6\u03c4h(\u03c8n)\u2225L2 \u2264 (1 + C1\u03c4)\u2225PN\u03c8(tn)\u2212 \u03c8n\u2225L2 , \u2225\u03a6\u03c4h(PN\u03c8(tn))\u2212 \u03a6\u03c4h(\u03c8n)\u2225H1 \u2264 (1 + C2\u03c4)\u2225PN\u03c8(tn)\u2212 \u03c8n\u2225H1 ,\nwhere C1 depends on \u2225PN\u03c8(tn)\u2225L\u221e and \u2225\u03c8n\u2225L\u221e , and C2 depends on \u2225PN\u03c8(tn)\u2225H3 and \u2225\u03c8n\u2225H2 for 0 \u2264 n \u2264 T/\u03c4 \u2212 1. Thus, both C1 and C2 are under control. Then the proof can be completed by the Lady Windermere\u2019s fan argument and the standard projection error estimates of PN .\n4.4. Extension to the EWI-EFP (2.13). For IN\u03c8 \u27e8n\u27e9(0 \u2264 n \u2264 T/\u03c4) obtained from the EWI-EFP scheme (2.13), it satisfies the same error bounds as \u03c8n(0 \u2264 n \u2264 T/\u03c4) in Theorem 4.1, under the same assumptions on potential and the exact solution, but with a little more regular nonlineairty. To be precise, we introduce another assumption on the nonlinearity as\n(C) f(|v|2)v \u2208 H\u03b1per(\u2126), \u2200v \u2208 H\u03b1per(\u2126).\nFor the optimal L2-norm error bound, we assume that f satisfies Assumptions (A) and (C) with \u03b1 = 2. Two typical examples of f include (i) f(\u03c1) = \u03bb1\u03c1 \u03c31 + \u03bb2\u03c1 \u03c32 with \u03c32 > \u03c31 \u2265 1/2 and \u03bb1, \u03bb2 \u2208 R, and (ii) f(\u03c1) = \u03bb\u03c1\u03c3 ln \u03c1 with \u03c3 > 1/2 and \u03bb \u2208 R. For the optimal H1-norm error bound, we assume, in addition to Assumption (B), f satisfies (C) with \u03b1 = 3 and the discrete counterpart of Assumption (B)\n(B\u2019) \u2225IN (f(|v|2)v \u2212 f(|w|2)w)\u2225H1 \u2264 C(\u2225v\u2225H3 , \u2225w\u2225H2)\u2225v \u2212 w\u2225H1 , v, w \u2208 XN ,\nwith two typical examples of f : (i) f(\u03c1) = \u03bb1\u03c1 \u03c31 + \u03bb2\u03c1 \u03c32 with \u03c32 > \u03c31 \u2265 1 and \u03bb1, \u03bb2 \u2208 R, and (ii) f(\u03c1) = \u03bb\u03c1\u03c3 ln \u03c1 with \u03c3 > 1 and \u03bb \u2208 R (see, e.g., [18] for the proof).\nThen we have the following error bounds for the EWI-EFP scheme (2.13).\nCorollary 4.4. Assume that V \u2208 L\u221e(\u2126), f satisfies Assumptions (A) and (C) with \u03b1 = 2 and the exact solution \u03c8 \u2208 C([0, T ];H2per(\u2126)) \u2229 C1([0, T ];L2(\u2126)). There exists \u03c40 > 0 and h0 > 0 depending on M and T and sufficiently small such that for any 0 < \u03c4 < \u03c40 and 0 < h < h0, we have\n(4.24) \u2225\u03c8(\u00b7, tn)\u2212 IN\u03c8\u27e8n\u27e9\u2225L2 \u2272 \u03c4 + h2, \u2225IN\u03c8\u27e8n\u27e9\u2225H2 \u2264 C(M), \u2225\u03c8(\u00b7, tn)\u2212 IN\u03c8\u27e8n\u27e9\u2225H1 \u2272 \u221a \u03c4 + h, 0 \u2264 n \u2264 T/\u03c4.\nMoreover, if V \u2208W 1,4(\u2126)\u2229H1per(\u2126), f satisfies Assumptions (B), (B\u2019) and (C) with \u03b1 = 3 and \u03c8 \u2208 C([0, T ];H3per(\u2126)) \u2229 C1([0, T ];H1(\u2126)), we have, for 0 < \u03c4 < \u03c40 and 0 < h < h0,\n(4.25) \u2225\u03c8(\u00b7, tn)\u2212IN\u03c8\u27e8n\u27e9\u2225L2 \u2272 \u03c4+h3, \u2225\u03c8(\u00b7, tn)\u2212IN\u03c8\u27e8n\u27e9\u2225H1 \u2272 \u03c4+h2, 0 \u2264 n \u2264 T/\u03c4.\nFor notational simplicity, we define BN : C(\u2126) \u2192 XN as\n(4.26) BN (\u03d5) := PN (V \u03d5) + ING(\u03d5), \u03d5 \u2208 C(\u2126),\nwhere G(\u03d5)(x) = f(|\u03d5(x)|2)\u03d5(x) for x \u2208 \u2126. Then we have Lemma 4.5. Let v, w \u2208 XN . Assume that V \u2208 L\u221e(\u2126) and f satisfies (A) and (C) with \u03b1 = 2. If \u2225v\u2225H2 \u2264M0 and \u2225w\u2225L\u221e \u2264M1, we have\n(4.27) \u2225PNB(v)\u2212BN (w)\u2225L2 \u2264 C(\u2225V \u2225L\u221e ,M0,M1)\u2225v \u2212 w\u2225L2 + C(M0)h2.\nMoreover, if V \u2208 W 1,4(\u2126) \u2229 H1per(\u2126), f satisfies Assumptions (B\u2019) and (C) with \u03b1 = 3, and \u2225v\u2225H3 \u2264M2, and \u2225w\u2225H2 \u2264M3, we have\n(4.28) \u2225PNB(v)\u2212BN (w)\u2225H1 \u2264 C(\u2225V \u2225W 1,4 ,M2,M3)\u2225v \u2212 w\u2225H1 + C(M2)h2.\nProof. Recalling (3.4) and (4.26), we have\nPNB(v)\u2212BN (w) = PN (V (v \u2212 w)) + PNG(v)\u2212 ING(w) = PN (V (v \u2212 w)) + (PN \u2212 IN )G(v) + ING(v)\u2212 ING(w).(4.29)\nFrom (4.29), using assumption (C) with \u03b1 = 2, we have\n\u2225PNB(v)\u2212BN (w)\u2225L2 \u2272 \u2225V \u2225L\u221e\u2225v \u2212 w\u2225L2 + C(M0)h2 + \u2225ING(v)\u2212 ING(w)\u2225L2 \u2264 \u2225V \u2225L\u221e\u2225v \u2212 w\u2225L2 + C(M0)h2 + C(M0,M1)\u2225v \u2212 w\u2225L2 ,(4.30)\nwhere we use \u2225ING(\u03d5)\u22252L2 = h \u2211 j\u2208T 0N |G(\u03d5(xj))|2 and IN is an identity on XN in the last line, and we prove (4.27). To prove (4.28), using (C) with \u03b1 = 3 and (B\u2019), from (4.29), we have\n\u2225PNB(v)\u2212BN (w)\u2225H1 \u2272 \u2225V \u2225W 1,4\u2225v \u2212 w\u2225H1 + C(M2)h2 + C(M2,M3)\u2225v \u2212 w\u2225H1 ,\nwhich proves (4.28), and completes the proof.\nProof of Corollary 4.4. The proof is similar to the proof of Theorem 4.1, and we sketch it here for the convenience of the reader. We start with the proof of (4.24). Define the error function e\u27e8n\u27e9 := PN\u03c8\n[n] \u2212 IN\u03c8\u27e8n\u27e9 for 0 \u2264 n \u2264 T/\u03c4 . Then e\u27e80\u27e9 = PN\u03c80 \u2212 IN\u03c80 satisfies \u2225e\u27e80\u27e9\u2225L2 \u2264 C(M)h2. Recalling (2.16), (4.3), and (4.26), we obtain, for 0 \u2264 n \u2264 T/\u03c4 \u2212 1,\n(4.31) e\u27e8n+1\u27e9 = ei\u03c4\u2206e\u27e8n\u27e9 \u2212 i\u03c4\u03c61(i\u03c4\u2206)(PNB(\u03c8[n])\u2212BN (IN\u03c8\u27e8n\u27e9)).\nFrom (4.31), by the boundedness of ei\u03c4\u2206, PN and \u03c61(i\u03c4\u2206), Lemma 3.4, triangle inequality, the uniform H2-bound of \u03c8[n] in (3.2), and (4.27), we get\n\u2225e\u27e8n+1\u27e9\u2225L2 \u2264 \u2225e\u27e8n\u27e9\u2225L2 + \u03c4 ( \u2225PNB(\u03c8[n])\u2212 PNB(PN\u03c8[n])\u2225L2\n+ \u2225PNB(PN\u03c8[n])\u2212BN (IN\u03c8\u27e8n\u27e9)\u2225L2 )\n\u2264 \u2225e\u27e8n\u27e9\u2225L2 + C(M)\u03c4h2 + (1 + C(M, \u2225IN\u03c8\u27e8n\u27e9\u2225L\u221e)\u03c4)\u2225e\u27e8n\u27e9\u2225L2 .(4.32)\nFrom (4.32), by discrete Gronwall\u2019s inequality and the same induction process as in the proof of Proposition 4.3, noting first step error \u2225e\u27e80\u27e9\u2225L2 \u2264 C(M)h2, we obtain\n(4.33) \u2225e\u27e8n\u27e9\u2225L2 \u2264 C(M,T )h2, 0 \u2264 n \u2264 T/\u03c4.\nThe rest of the proof of (4.24) can be completed by following the proof of (4.1).\nThen we outline the proof of (4.25). Define the numerical flow \u03a6 \u27e8\u03c4\u27e9 h : XN \u2192 XN\nassociated with the EWI-EFP scheme (2.13) as\n(4.34) \u03a6 \u27e8\u03c4\u27e9 h (v) = e i\u03c4\u2206v \u2212 i\u03c4\u03c61(i\u03c4\u2206)BN (v), v \u2208 XN .\nRecalling (2.16), we have IN\u03c8 \u27e8n+1\u27e9 = \u03a6 \u27e8\u03c4\u27e9 h (IN\u03c8 \u27e8n\u27e9) for n \u2265 0. Recalling (3.16) and (4.34), the local truncation error can be decomposed as\nPN\u03c8(tn+1)\u2212 \u03a6\u27e8\u03c4\u27e9h (PN\u03c8(tn)) = \u2212i \u222b \u03c4 0 ei(\u03c4\u2212s)\u2206 ( PNB(\u03c8(tn + s))\u2212 PNB(\u03c8(tn))+\nPNB(\u03c8(tn))\u2212 PNB(PN\u03c8(tn)) + PNB(PN\u03c8(tn))\u2212BN (PN\u03c8(tn)) ) ds,(4.35)\nwhich implies, by the boundedness of eit\u2206 and PN , and using (3.38) and (4.28),\n(4.36) \u2225PN\u03c8(tn+1)\u2212 \u03a6\u27e8\u03c4\u27e9h (PN\u03c8(tn))\u2225H1 \u2272 \u03c4 2 + \u03c4h2.\nBesides, recalling (4.34) and using (B\u2019), we have H1-stability estimate\n(4.37) \u2225\u03a6\u27e8\u03c4\u27e9h (PN\u03c8(tn))\u2212 \u03a6 \u27e8\u03c4\u27e9 h (IN\u03c8 \u27e8n\u27e9)\u2225H1 \u2264 (1 + C3\u03c4)\u2225PN\u03c8(tn)\u2212 IN\u03c8\u27e8n\u27e9\u2225H1 ,\nwhere C3 depends on \u2225V \u2225W 1,4 , \u2225\u03c8(tn)\u2225H3 and \u2225IN\u03c8\u27e8n\u27e9\u2225H2 , and thus is under control. The proof of the H1-error bound in (4.25) can be completed by applying standard Lady Windermere\u2019s fan argument with (4.36) and (4.37). The proof of the L2-error bound in (4.25) can be obtained similarly. Then the proof is completed.\n5. Numerical results. In this section, we present some numerical examples for the NLSE with either low regularity potential or nonlinearity. In the following, we fix \u2126 = (\u221216, 16), T = 1, d = 1 and consider the power-type nonlinearity f(\u03c1) = \u2212\u03c1\u03c3 (\u03c3 > 0).\nLet \u03c8n(0 \u2264 n \u2264 T/\u03c4) be the numerical solution obtained by the EWI-FS method (2.11) or the EWI-EFP method (2.13), which will be made clear in each case. Define the error functions\nekL2 = \u2225\u03c8(tk)\u2212 IN\u03c8k\u2225L2 , ekH1 = \u2225\u03c8(tk)\u2212 IN\u03c8k\u2225H1 , 0 \u2264 k \u2264 n := T/\u03c4.\n5.1. For the NLSE with locally Lipschitz nonlinearity. In this subsection, we only consider the NLSE with the power-type nonlinearity and without potential:\n(5.1) i\u2202t\u03c8(x, t) = \u2212\u2206\u03c8(x, t)\u2212 |\u03c8(x, t)|2\u03c3\u03c8(x, t), x \u2208 \u2126, t > 0,\nwhere \u03c3 > 0. Recall that Assumption (A) is satisfied for any \u03c3 > 0 and Assumption (B) is satisfied for any \u03c3 \u2265 1/2. Note that when there is no potential, the extended Fourier pseudospectral method collapses to the standard Fourier pseudospectral method.\nTwo types of initial data are considered: (i) Type I. The H2 initial datum\n(5.2) \u03c80(x) = x|x|0.51e\u2212 x2 2 , x \u2208 \u2126.\n(ii) Type II. The smooth initial datum\n(5.3) \u03c80(x) = xe \u2212 x22 , x \u2208 \u2126.\nThe two initial data are specially chosen to demonstrate the influence of the low regularity of f around the origin. Since both Type I and II initial data are odd functions, the corresponding solutions of the NLSE will satisfy \u03c8(0, t) \u2261 0 for all t \u2265 0. The difference of these two initial data lies in the regularity.\nWe shall test the convergence order in both time and space for Type I and II initial data. For each initial datum, we choose \u03c3 = 0.1, 0.2, 0.3, 0.4. The \u2019exact\u2019 solutions are computed by the Strang splitting Fourier pseudospectral method with \u03c4 = \u03c4e := 10 \u22126 and h = he := 2 \u22129. When test the spatial errors, we fix the time step size \u03c4 = \u03c4e, and when test the temporal errors, we fix the mesh size h = he. We start with the Type I H2 initial datum (5.2). Figure 5.1 exhibits the spatial error in L2- and H1-norm of the EWI-FS (solid lines) and the EWI-EFP (dotted lines) method for \u03c3 = 0.1 with the Type I initial datum. We can observe that the EWI-FS method is second order convergent in L2-norm and first order convergent in H1-norm. Moreover, we see that there is almost no difference between the spatial error of the EWI-FS method and the EWI-EFP method, which suggests that the Fourier pseudospectral method seems also suitable to discretize the low regularity nonlinearity.\nFigure 5.2 plots the temporal error in L2- and H1-norm of the EWI for different 0 < \u03c3 < 1/2 with Type I initial datum. Figure 5.2 (a) shows that the temporal convergence is first order in L2-norm for all the four \u03c3 and Figure 5.2 (b) shows the temporal convergence is half order in H1-norm for all the four \u03c3.\nThe results in Figures 5.1 and 5.2 confirm our optimal L2-norm error bound for the NLSE with locally Lipschitz nonlinearity, and demonstrate that it is sharp.\nThen we consider the Type II smooth initial datum (5.3). Figure 5.3 shows the spatial error in L2- and H1-norm of the EWI-FS (solid lines) and the EWI-EFP (dotted lines) method for \u03c3 = 0.1 with the Type II initial datum. We can observe that the convergence orders in H1-norm of the EWI-FS (solid lines) and the EWIEFP (dashed lines) are almost the same (roughly 2.5), though the value of the error of the EWI-FS is smaller than the EWI-EFP. While the convergence order in L2norm of the EWI-FS method is roughly 3.5, which is almost one order higher than that of the EWI-EFP method. This observation suggests that when the solution has better regularity, the Fourier spectral method outperforms the Fourier pseudospectral method for discretizing the low regularity nonlinearity.\nFigure 5.4 displays the temporal error in L2- and H1-norm of the EWI for different 0 < \u03c3 < 1 with the Type II initial datum. Figure 5.4 (a) and (b) show that the temporal convergence is first order in both L2- and H1-norm for all the four \u03c3. However, currently, we can only prove the first order H1-convergence in time under Assumption (B) which holds only when \u03c3 \u2265 1/2. Besides, as shown in Figure 5.3 in [18], for the time-splitting methods, we can observe first order convergence in H1-norm only when \u03c3 \u2265 1/2, which suggests that the EWI may be better than the time-splitting methods when the nonlinearity is of low regularity.\nThe results in Figures 5.3 and 5.4 confirm our optimal H1-norm error bound for the NLSE with low regularity nonlinearity, but also indicates that Assumption (B) may be relaxed.\n5.2. For the NLSE with low regularity potential. In this subsection, we only consider the cubic NLSE with low regularity potential as\n(5.4) i\u2202t\u03c8(x, t) = \u2212\u2206\u03c8(x, t) + V (x)\u03c8(x, t)\u2212 |\u03c8(x, t)|2\u03c8(x, t), x \u2208 \u2126, t > 0,\nwhere V is chosen as either V1 \u2208 L\u221e(\u2126) or V2 \u2208W 1,4(\u2126) defined as\n(5.5) V1(x) = { \u2212 4, x \u2208 (\u22122, 2) 0, otherwise , V2(x) = |x|0.76, x \u2208 \u2126.\nWe shall test the convergence orders for the NLSE (5.4) with V = V1 and \u03c80 \u2208 H2(\u2126), and V = V2 and \u03c80 \u2208 H3(\u2126), respectively. The \u2019exact\u2019 solutions are computed by the EWI-EFP method with \u03c4 = \u03c4e := 10 \u22126 and h = he := 2 \u22129. When test the spatial errors, we fix the time step size \u03c4 = \u03c4e, and when test the temporal errors, we fix the mesh size h = he.\nWe start with the spatial error and compare the performance of the extended Fourier pseudospectral method and the standard Fourier pseudospectral (FP) method which can be obtained by replacing \u0302(V IN\u03c8\u27e8n\u27e9)l with \u02dc(V \u03c8\u27e8n\u27e9)l in (2.13). We remark here that, since the nonlinearity is smooth in (5.4), the results of the EWI-FS method are almost the same as those of the EWI-EFP method.\nFigure 5.5 (a) shows the spatial error in L2- and H1-norm of the EWI-EFP method (solid lines) and the EWI-FP method (dotted lines) with V = V1 \u2208 L\u221e(\u2126) given in (5.5) and \u03c80 \u2208 H2(\u2126) given in (5.2). We can observe that the EWI-EFP is second order convergent in L2-norm and first order convergent in H1-norm in space. However, the spatial convergence order of the EWI-FP method is only first order in both L2- and H1-norm, and the value of the error is much larger. This implies that when discretizing purely L\u221e-potential, the extended Fourier pseudospectral method is much better than the standard Fourier pseudospectral method. Figure 5.5 (b) plots the temporal convergence of the EWI in L2- and H1-norm with the Type I initial\ndatum. We can observe that the EWI is first order convergent in L2-norm and half order convergent in H1-norm in time.\nThe results in Figure 5.5 validate our optimal L2-norm error bound for the NLSE with L\u221e-potential and demonstrate that it is sharp.\nFigure 5.6 (a) shows the spatial error in L2- andH1-norm of the EWI-EFP method (solid lines) and the EWI-FP method (dotted lines) with V = V2 \u2208W 1,4(\u2126) given in (5.5) and \u03c80 \u2208 H3(\u2126) given by \u03c80(x) = (1 + |x|2.51)e\u2212x\n2/2. We can observe that the EWI-EFP is third order convergent in L2-norm and second order convergent in H1norm in space. However, the spatial convergence order of the EWI-FP method is only 1.7 order in both L2- and H1-norm, and the value of the error is much larger. This implies again that the extended Fourier pseudospectral method is much better than the standard Fourier pseudospectral method when the potential is of low regularity. Figure 5.6 (b) plots the temporal convergence of the EWI in L2- and H1-norm with the H3 initial datum. We can observe that the EWI is first order convergent in H1-norm in time for V \u2208W 1,4(\u2126).\nThe results in Figure 5.6 validate our optimal H1-norm error bound for the NLSE with W 1,4-potential and demonstrate that it is sharp.\n5.3. Comparison with the time-splitting method. In this subsection, we present some numerical results to compare the performance of the EWI and the timesplitting method applied to the NLSE with low regularity potential and nonlinearity. To be precise, we compare the EWI with the first-order Lie-Trotter time-splitting method with standard Fourier pseudospectral method for spatial discretization (abbreviated as TSFP in the following). Here, we fix h = he and compare the temporal errors, roughly speaking, this is equivalent to do comparison for semi-discretization in time by different time integrators.\nFirst, we consider the NLSE (5.1) with low regularity nonlinearity \u03c3 = 0.1 and the smooth initial datum (5.3). In Figure 5.7, we can observe that both the EWI and the TSFP are first order convergent in L2-norm, although the value of the error of the TSFP method is smaller than the EWI. However, when measured in H1-norm, the EWI is still first order convergent (although this is not covered by our error estimates as already mentioned in the discussion of Figure 5.4), but the error of the TSFP method fluctuates a lot, and leads to order reduction.\nThen we consider the NLSE (5.4) with low regularity potential V = V1 \u2208 L\u221e(\u2126) in (5.5) and an H2-initial data given in (5.2). In Figure 5.8, we can observe that the EWI is first order and half order convergent in L2- and H1-norm, respectively. However, both the L2- and H1-error of the TSFP method fluctuates drastically and suffer from sever order reduction.\nBased on the discussion above, we can conclude that in general, the EWI is better than the TSFP method when approximating the NLSE with low regularity potential and nonlinearity. However, the numerical results also necessitate the design and analysis of higher order and structure-preserving (e.g. time symmetric) EWIs for better error constant. This will be considered in our future work.\n6. Conclusions. We established optimal error bounds for the first-order Gautschitype exponential wave integrator (EWI) applied to the nonlinear Schro\u0308dinger equation (NLSE) with L\u221e-potential and/or locally Lipschitz nonlinearity under the assumption of H2-solution. For the semi-discretization in time by the first-order Gautschitype EWI, we proved an optimal L2-norm error bound at O(\u03c4) and a uniform H2bound of the numerical solution. For the full discretization obtained from the semidiscretization by using the Fourier spectral method in space, we proved an optimal L2-norm error bound at O(\u03c4 + h2) without any coupling condition between \u03c4 and h. For W 1,4-potential and a little more regular nonlinearity, under the assumption\nof H3-solution of the NLSE, we proved optimal H1-norm error bounds for both the semi-discrete and fully discrete schemes. As a by-product, we proposed an extended Fourier pseudospectral method to implement the full discretization when the potential is of low regularity and the nonlinearity is smooth, in which the potential and nonlinearity were discretized by the Fourier spectral method and the Fourier pseudospectral method, respectively. The proposed numerical implementation has similar computational cost as the standard Fourier pseudospectral method, but we can establish rigorous error bounds for this method. On the contrary, one cannot establish optimal error bounds for the standard Fourier pseudospectral method for the NLSE when the potential is of low regularity, e.g. V \u2208 L\u221e. In the future, we will consider even weaker potential, e.g. V \u2208 L1, including Coulomb potential and/or spatial/temporal Dirac delta potential."
        }
    ],
    "title": "OPTIMAL ERROR BOUNDS ON THE EXPONENTIAL WAVE INTEGRATOR FOR THE NONLINEAR SCHRO\u0308DINGER EQUATION WITH LOW REGULARITY POTENTIAL AND NONLINEARITY\u2217",
    "year": 2023
}