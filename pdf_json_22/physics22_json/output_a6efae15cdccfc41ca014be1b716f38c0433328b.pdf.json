{
    "abstractText": "The Euler equation of an ideal (i.e. inviscid incompressible) fluid can be regarded, following V.Arnold, as the geodesic flow of the right-invariant L-metric on the group of volume-preserving diffeomorphisms of the flow domain. In this paper we describe the common origin and symmetry of generalized flows, multiphase fluids (homogenized vortex sheets), and conventional vortex sheets: they all correspond to geodesics on certain groupoids of multiphase diffeomorphisms. Furthermore, we prove that all these problems are Hamiltonian with respect to a Poisson structure on a dual Lie algebroid, generalizing the Hamiltonian property of the Euler equation on a Lie algebra dual.",
    "authors": [
        {
            "affiliations": [],
            "name": "Anton Izosimov"
        },
        {
            "affiliations": [],
            "name": "Boris Khesin"
        }
    ],
    "id": "SP:c5dd5b0cce0e6b20d96982813b38e99645a354fe",
    "references": [
        {
            "authors": [
                "V.I. Arnold"
            ],
            "title": "Sur la g\u00e9om\u00e9trie diff\u00e9rentielle des groupes de Lie de dimension infinie et ses applications \u00e0 l\u2019hydrodynamique des fluides parfaits",
            "venue": "Ann. Inst. Fourier,",
            "year": 1966
        },
        {
            "authors": [
                "B.A.V.I. Arnold"
            ],
            "title": "Khesin. Topological methods in hydrodynamics",
            "year": 1998
        },
        {
            "authors": [
                "M. Boucetta"
            ],
            "title": "Riemannian geometry of Lie algebroids",
            "venue": "J. Egyptian Math. Soc.,",
            "year": 2011
        },
        {
            "authors": [
                "Y. Brenier"
            ],
            "title": "The least action principle and the related concept of generalized flows for incompressible perfect fluids",
            "venue": "J. Amer. Math. Soc.,",
            "year": 1989
        },
        {
            "authors": [
                "Y. Brenier"
            ],
            "title": "A homogenized model for vortex sheets",
            "venue": "Arch. Ration. Mech. Anal.,",
            "year": 1997
        },
        {
            "authors": [
                "Y. Brenier"
            ],
            "title": "Minimal geodesics on groups of volume-preserving maps and generalized solutions of the Euler equations",
            "venue": "Comm. Pure Appl. Math.,",
            "year": 1999
        },
        {
            "authors": [
                "Y. Brenier"
            ],
            "title": "Une interpr\u00e9tation variationnelle de la relativit\u00e9 g\u00e9n\u00e9rale dans le vide en termes de transport",
            "venue": "optimal. C. R. Math. Acad. Sci. Paris,",
            "year": 2022
        },
        {
            "authors": [
                "Y. Brenier",
                "D. Vorotnikov"
            ],
            "title": "On optimal transport of matrix-valued measures",
            "venue": "SIAM J. Math. Anal.,",
            "year": 2020
        },
        {
            "authors": [
                "K.J. Ciosmak"
            ],
            "title": "Optimal transport of vector measures",
            "venue": "Calc. Var. Partial Differential Equations,",
            "year": 2021
        },
        {
            "authors": [
                "N.T.J.-P. Dufour"
            ],
            "title": "Zung. Poisson structures and their normal forms",
            "year": 2006
        },
        {
            "authors": [
                "D.G. Ebin",
                "J. Marsden"
            ],
            "title": "Groups of diffeomorphisms and the motion of an incompressible fluid",
            "venue": "Ann. of Math.,",
            "year": 1970
        },
        {
            "authors": [
                "A. Izosimov",
                "B. Khesin"
            ],
            "title": "Vortex sheets and diffeomorphism groupoids",
            "venue": "Adv. Math.,",
            "year": 2018
        },
        {
            "authors": [
                "B. Khesin",
                "J. Lenells",
                "G. Misio lek",
                "S.C. Preston"
            ],
            "title": "Geometry of diffeomorphism groups, complete integrability and geometric statistics",
            "venue": "Geom. Funct. Anal. (GAFA),",
            "year": 2013
        },
        {
            "authors": [
                "C. Loeschcke"
            ],
            "title": "On the relaxation of a variational principle for the motion of a vortex sheet in perfect fluid",
            "venue": "PhD thesis, Rheinische Friedrich-Wilhelms-Universita\u0308t Bonn,",
            "year": 2012
        },
        {
            "authors": [
                "K.C.H. Mackenzie"
            ],
            "title": "General theory of Lie groupoids and Lie algebroids. Number 213 in London Mathematical Society Lecture Note Series",
            "year": 2005
        },
        {
            "authors": [
                "F. Otto"
            ],
            "title": "The geometry of dissipative evolution equations: the porous medium equation",
            "venue": "Comm. Partial Differential Equations,",
            "year": 2001
        },
        {
            "authors": [
                "A.I. Shnirelman"
            ],
            "title": "On the geometry of the group of diffeomorphisms and the dynamics of an ideal incompressible fluid",
            "venue": "Math. USSR Sb.,",
            "year": 1987
        },
        {
            "authors": [
                "A.I. Shnirelman"
            ],
            "title": "Generalized fluid flows, their approximation and applications",
            "venue": "Geom. Funct. Anal. (GAFA),",
            "year": 1994
        }
    ],
    "sections": [
        {
            "text": "Contents"
        },
        {
            "heading": "1 Introduction 2",
            "text": "1.1 Groupoid framework for generalized flows . . . . . . . . . . . . . . . . . . . . . 3 1.2 Groupoid setting for multiphase fluids . . . . . . . . . . . . . . . . . . . . . . . 5 1.3 Structure of the paper . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7"
        },
        {
            "heading": "2 Lie groupoids and algebroids 8",
            "text": "2.1 Lie groupoids . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 2.2 Lie algebroids . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 2.3 Dual Lie algebroids as Poisson vector bundles . . . . . . . . . . . . . . . . . . . 10 2.4 Euler-Arnold equations on Lie algebroids . . . . . . . . . . . . . . . . . . . . . 11"
        },
        {
            "heading": "3 Kinematics of multiphase fluids 12",
            "text": "3.1 The Lie groupoid of multiphase diffeomorphisms . . . . . . . . . . . . . . . . . 13 3.2 The Lie algebroid of multiphase vector fields . . . . . . . . . . . . . . . . . . . . 14 3.3 The dual algebroid and its tangent space . . . . . . . . . . . . . . . . . . . . . . 16 3.4 Poisson bracket on the dual algebroid . . . . . . . . . . . . . . . . . . . . . . . 17"
        },
        {
            "heading": "4 Dynamics of multiphase fluids 20",
            "text": "4.1 Geodesic and Hamiltonian framework for multiphase fluids . . . . . . . . . . . 20 4.2 Potential solutions as geodesics on the space of multiphase densities . . . . . . 22"
        },
        {
            "heading": "5 Groupoid of generalized flows 24",
            "text": ""
        },
        {
            "heading": "6 Open problems 27",
            "text": ""
        },
        {
            "heading": "7 Appendix: Dynamics of classical vortex sheets 28",
            "text": "\u2217Department of Mathematics, University of Arizona; e-mail: izosimov@math.arizona.edu \u2020Department of Mathematics, University of Toronto; e-mail: khesin@math.toronto.edu\nar X\niv :2\n20 6.\n01 43\n4v 3\n[ m\nat h.\nD G\n] 1\n2 O\nct 2\n02 3\nBibliography 29"
        },
        {
            "heading": "1 Introduction",
            "text": "Classical hydrodynamics deals with an ideal (i.e. inviscid incompressible) fluid, whose motion is described by the Euler equation. In this paper we consider a broader setting of multiphase fluids and generalized flows. A multiphase fluid consists of several fractions that can freely penetrate through each other without resistance and are constrained only by the conservation of total density. Such flows arise, in particular, in connection with vortex sheets in an ideal fluid, i.e. hypersurfaces of discontinuity in fluid velocity with different speed of fluid layers on different sides of the hypersurface. By relaxing the condition of a sharp border between the layers one obtains homogenized vortex sheets [5], which allow mixing of the two parts of the fluid, rather than separating them by a hypersurface. Such homogenized vortex sheets can be thought of as examples of multiphase flows. Beyond the vortex sheet setting, multiphase fluids arise e.g. in plasma physics and chemistry.\nOf particular interest are multiphase fluids with continuum of phases (or generalized flows), introduced by Y. Brenier [6]. One can think of them as flows in which every fluid particle spreads into a cloud thus moving to any other point of the manifold with certain probability (we define this precisely below), see Figure 1. While, according to A. Shnirelman [17], a shortest curve on the group of volume-preserving diffeomorphisms does not exist between some pairs of maps, generalized flows of Brenier do allow such a shortest solution for a large class of diffeomorphisms.\nIn this paper we describe the common origin and symmetry of both multiphase fluids (equivalently, homogenized vortex sheets) and generalized flows (fluids with continuum of phases): they both correspond to geodesics on certain groupoids of multiphase diffeomorphisms. Groupoids can be thought of as groups with partially defined multiplication. We also present the Hamiltonian framework for them by describing the corresponding dynamics as Euler-Arnold flows for right-invariant energy metrics on the groupoid. In other words, we prove that generalized flows are Hamiltonian for the corresponding Poisson structure on the dual Lie algebroid, generalizing Lie-Poisson structures.\nRecall that in 1966 Arnold proved that the Euler equation for an ideal fluid describes the geodesic flow of a right-invariant metric on the group of volume-preserving diffeomorphisms of\nthe flow domain [1]. This insight turned out to be indispensable for the study of geometry and topology of fluid flows, Hamiltonian properties and conservation laws in hydrodynamics, as well as a powerful tool for obtaining sharper existence and uniqueness results for Euler-type equations [2]. However, such objects as the above-mentioned multiphase fluids or generalized flows do not fit into Arnold\u2019s approach. In the paper [12] on classical vortex sheets in incompressible flows we introduced the language of Lie groupoids in hydrodynamics. In the present paper we demonstrate its universality by extending Arnold\u2019s framework to other Lie groupoids with one-sided invariant metrics, thus treating generalized flows (which did not allow any group interpretation before) and vortex sheets on the same footing, as well as developing a groupoid-theoretic description for many fluid dynamical settings."
        },
        {
            "heading": "1.1 Groupoid framework for generalized flows",
            "text": "Recall that the hydrodynamical Euler equation for an incompressible fluid filling a closed compact Riemannian manifold M is the following evolution law on the velocity field u:\nBtu` \u2207uu \u201c \u00b4\u2207p ,\nsupplemented by the divergence-free condition div u \u201c 0 on M . The pressure function p is defined uniquely modulo an additive constant by those conditions. This setting also extends to manifolds with boundary, as well as non-compact manifolds (such as Rn), by imposing appropriate boundary or decay conditions. Arnold\u2019s theorem sheds light on the origin of this equation:\nTheorem 1.1 (Arnold [1]). The Euler equation can be regarded as an equation of the geodesic flow on the group SDiffpMq of volume-preserving diffeomorphisms of M with respect to the right-invariant metric given at the identity of the group by the squared L2-norm of the fluid\u2019s velocity field (i.e., the fluid kinetic energy1).\nThis theorem provides an attractive way to construct Euler solutions as shortest curves, i.e. geodesics, joining two volume-preserving diffeomorphisms of M . However, in [17] Shnirelman proved that not all pairs of such diffeomorphisms admit a shortest curve connecting them. This variational problem was \u201ccured\u201d by Brenier [6], who introduced the space of generalized fluid flows and proved the existence in that space of a shortest curve joining any two volumepreserving diffeomorphisms from a large class.\nGeneralized flows satisfy the following equations: \" Btp\u03c1auaq ` div p\u03c1aua b uaq ` \u03c1a\u2207p \u201c 0 , (1a)\nBt\u03c1a ` div p\u03c1auaq \u201c 0 , (1b)\nalong with the constraint \u015f A \u03c1a da \u201c 1. Here ua P VectpMq is the fluid velocity field, depending on an additional parameter a belonging to a certain measure space A. One can think of A as enumerating fractions of the fluid, with ua being the velocity of a particular fraction. Likewise \u03c1a P C8pMq is the mass density of the fraction with label a P A. The pressure function p P C8pMq is common for all fractions.\nRemark 1.2. Using (1b) one can rewrite (1a) in the form similar to the classical Euler equation:\nBtua ` \u2207uaua \u201c \u00b4\u2207p. (2) 1The L2-metric is twice the kinetic energy of the fluid, which leads to a simple time rescaling, and we will\nnot be mentioning this throughout the paper.\nThe above form is given for consistency with [6], and it also simplifies the derivation of equation for the pressure function.\nNamely, the pressure can be obtained from the velocities ua and densities \u03c1a as follows. Integrating (1b) over the space A we get the condition\ndiv p \u017c\nA \u03c1auadaq \u201c 0, (3)\nwhich can be thought of as an analog of the condition div u \u201c 0 for the classical Euler equation. Further, taking the divergence of(1a), integrating over A, and using (3) we get\n\u2206p \u201c \u00b4div \u017c\nA div p\u03c1aua b uaq da, (4)\nwhich is a Poisson equation and hence has a unique solution for the pressure function, up to an additive constant.\nTheorem 1.3 (= Theorem 5.3). The Euler equations (1) for a generalized flow are geodesic equations for the right-invariant L2-metric on (source fibers of) the Lie groupoid GDiffpMq of generalized diffeomorphisms. Equivalently, the Euler equations (1) are the groupoid EulerArnold equations corresponding to the L2-metric on the algebroid GVectpMq.\nThe Lie groupoid GDiffpMq of generalized diffeomorphisms is a natural generalization of the group SDiffpMq of volume-preserving diffeomorphisms. (Just like the latter arises from \u201cintegrating\u201d the condition div u \u201c 0 on fluid velocities, the groupoid GDiffpMq \u201cintegrates\u201d equation (3).) The definition of that groupoid is as follows. Its base is the space GDenspMq of generalized densities, i.e. sets of densities \u00b5 :\u201c t\u00b5a P DenspMq | a P Au such that all \u00b5a are positive, have prescribed masses ca, i.e.\n\u017c\nM \u00b5a \u201c ca, (5)\nand together constitute the fixed volume form volM on M , i.e. \u015f A \u00b5a da \u201c volM at each point of M (in particular, \u015f\nA cada \u201c \u015f\nM volM ). One can think of those densities as a set A of different fractions of an incompressible fluid, penetrating through each other without resistance. Such a generalized density \u00b5 can also be interpreted as a doubly stochastic measure \u00b5a ^ da on the direct product M \u02c6A. The relation between densities \u00b5a and functions \u03c1a introduced above is \u00b5a \u201c \u03c1avolM . In particular, the condition \u015f\nA \u00b5a da \u201c volM is equivalent to the constraint \u015f\nA \u03c1a da \u201c 1. The elements of GDiffpMq are triples p\u03d5 ;\u00b5,\u00b51q where \u03d5 :\u201c t\u03d5a P DiffpMq | a P Au is a generalized diffeomorphism, and \u00b5,\u00b51 P GDenspMq are generalized densities such that \u03d5\u02da\u00b5 \u201c \u00b51 component-wisely, i.e. \u03d5a\u02da\u00b5a \u201c \u00b51a for each a P A. The multiplication of such triples is defined by the natural composition, p\u03c8 ;\u00b51,\u00b52qp\u03d5 ;\u00b5,\u00b51q :\u201c p\u03c8\u03d5 ;\u00b5,\u00b52q .\nThe infinitesimal object corresponding to this Lie groupoid is the Lie algebroid GVectpMq describing the space of velocities for a generalized fluid. It is a vector bundle over GDenspMq with the following structure. Its fiber over \u00b5 P GDenspMq is the space GVectpM,\u00b5q that consists of generalized vector fields on M of the form u :\u201c tua | a P Au with ua P VectpMq that are \u201cdivergence-free\u201d with respect to the generalized volume form: \u015f\nA Lua\u00b5a da \u201c 0 (the latter equation is equivalent to (3)). The vector bundle GVectpMq carries additional structures, namely a bracket on sections and a so-called anchor map, see Section 5. These structures endow the dual bundle GVectpMq\u02da with a Poisson structure. Equations (1) are Hamiltonian with respect to that structure:\nTheorem 1.4 (=Theorem 5.2). The Euler equations (1) for a generalized flow written on the dual GVectpMq\u02da of the algebroid are Hamiltonian with respect to the natural Poisson structure on the dual algebroid and the Hamiltonian function given by the L2 kinetic energy.\nThe above two theorems provide the group-theoretic and Hamiltonian frameworks for generalized flows.\nRemark 1.5. The smoothness of the groupoid and algebroid is understood below in the Fre\u0301chet C8 setting. Similarly, one can consider the setting of Hilbert manifolds modeled on Sobolev Hs spaces for sufficiently large s, s \u0105 dimM{2 ` 1, cf. [11].\nRemark 1.6. Theorem 1.4 remains valid if we exclude the condition (5) from the definition of the groupoid. That condition is added for technical reasons (specifically, to make the groupoid transitive, see Definition 2.3 below) and does not affect equations (1). Indeed, preservation of masses \u015f\nM \u00b5a is just a consequence of those equations."
        },
        {
            "heading": "1.2 Groupoid setting for multiphase fluids",
            "text": "In this section we discuss the \u201cdiscrete version\u201d of generalized flows, namely, multiphase flows on a Riemannian manifold M . Such flows appear in [5] in the context of homogenized vortex sheets and are governed by the following equations:\n#\nBtuj ` \u2207ujuj \u201c \u00b4\u2207p , Bt\u03c1j ` div p\u03c1jujq \u201c 0 .\n(6)\nHere \u03c11, . . . , \u03c1n P C8pMq are mass densities of n phases of the fluid subject to the constraint \u0159n\nj\u201c1 \u03c1j \u201c 1, the vector fields u1, . . . , un P VectpMq are the corresponding fluid velocities, and the pressure p P C8pMq is common for all phases. These equations can be thought of as a discrete analogue of (1), which becomes particularly transparent upon rewriting equation (1a) in the form (2). Conversely, we can rewrite the first equation in (6) in the form\nBtp\u03c1jujq ` div p\u03c1juj b ujq ` \u03c1j\u2207p \u201c 0.\nFurthermore, the second equation implies\ndiv n \u00ff\nj\u201c1 \u03c1juj \u201c 0, (7)\nwhich results in the following equation for the pressure, cf. (4):\n\u2206p \u201c \u00b4div n \u00ff\nj\u201c1 div p\u03c1iui b uiq.\nThe Lie groupoid MDiffpMq underlying equations (6) is a discrete version of the groupoid GDiffpMq. Its base is the space MDenspMq of multiphase densities, i.e. n-tuples of densities \u00b5 :\u201c p\u00b51, ..., \u00b5nq satisfying the conditions that all densities \u00b5i are positive and sum to a fixed density volM everywhere on M , while their total masses are given by a fixed n-tuple of constants c1, . . . , cn P R. These densities can be thought of as densities of different mutually penetrating fractions of the fluid, subject only to the total incompressibility condition.\nNow the elements of our Lie groupoid MDiffpMq are n-tuples of diffeomorphisms of M preserving the property of incompressibility of multiphase densities, i.e. the set of tuples\np\u03d5 ;\u00b5,\u00b51q :\u201c p\u03d51, ..., \u03d5n;\u00b51, ..., \u00b5n, \u00b511, ..., \u00b51nq with multiphase forms \u00b5,\u00b51 P MDenspMq such that the multiphase diffeomorphism \u03d5 push-forwards one of them to the other, \u03d5\u02da\u00b5 \u201c \u00b51 component-wisely. The multiplication in MDiffpMq is defined in the same way as for GDiffpMq.\nThe corresponding Lie algebroid MVectpMq is the space of possible velocities of the multiphase fluid. It is a vector bundle over MDenspMq where the fiber of MVectpMq over \u00b5 P MDenspMq is the space MVectpM,\u00b5q which consists of multiphase vector fields on M \u201cdivergence-free\u201d with respect to the multiphase volume form, i.e. vector fields of the form u :\u201c pu1, ..., unq, where ui P VectpMq are such that \u0159n j\u201c1 Luj\u00b5j \u201c 0.\nTheorem 1.7 (=Theorem 4.4). The Euler equations (6) for a multiphase fluid flow are geodesic equations for the right-invariant L2-metric on (source fibers of) the Lie groupoid MDiffpMq of multiphase volume-preserving diffeomorphisms. Equivalently, they are groupoid Euler-Arnold equations corresponding to the L2-metric on the algebroid MVectpMq.\nFor the case of a flat space M the geodesic (although not the group) nature of homogenized vortex sheets (i.e. multiphase flows) was established in [14, Proposition 6]. One can see that the standard hydrodynamical Euler equation is a particular case of the above multiphase equations with only one phase, n \u201c 1. Furthermore, equations (6) can be described within the Hamiltonian framework:\nTheorem 1.8 (=Theorem 4.2). The Euler equations (6) for a multiphase flow written on the dual MVectpMq\u02da of the algebroid are Hamiltonian with respect to the natural Poisson structure on the dual algebroid and the Hamiltonian function given by the L2 kinetic energy.\nThis theorem is an analogue of the Hamiltonian property of the Euler-Arnold equation on the dual to a Lie algebra with respect to the Lie-Poisson structure.\nReturn to the metric properties of the groupoid Euler-Arnold equation. Given any initial density \u00b5 P MDenspMq, consider the subset MDiffpMq\u00b5 \u0102 MDiffpMq of multiphase diffeomorphisms which push \u00b5 forward to another multiphase density (a so-called source fiber of the groupoid MDiffpMq). That set is equipped with an L2-metric. At the same time, there is a natural metric x , yMDens on the space MDenspMq of multiphase densities induced by the well known Wasserstein metric. The connection between those two metrics is described by the following result.\nTheorem 1.9 (=Theorem 4.7). For any multiphase density \u00b5 P MDenspMq the groupoid target mapping trg : pMDiffpMq\u00b5, x , yL2q \u00d1 pMDenspMq, x , yMDensq is a Riemannian submersion. In particular, horizontal geodesics on MDiffpMq\u00b5 project to geodesics on MDenspMq. Those geodesics correspond to potential solutions of the system (6).\nIn particular, this result implies a geodesic description of potential solutions to (6), cf. [14, Proposition 7]. These potential solutions have the form u \u201c p\u2207f1, ...,\u2207fnq in M , see Figure 2. The Wasserstein-type metric x , yMDens is apparently related to the metric between vector densities described recently in [8, 9].\nOne of the byproducts of the groupoid approach is the following generalized Kelvin\u2019s theorem. Namely, define the multiphase vorticity \u03c9 :\u201c du5 for an n-tuple of vector fields u P MVectpMq as the component-wise vorticity n-tuple, i.e. \u03c9j :\u201c du5j with u5j standing for the 1-forms metric-dual to the vector fields uj .\nCorollary 1.10 (=Corollary 4.5). For a multiphase fluid the vorticity is \u201cfrozen into the flow\u201d in the generalized sense: Bt\u03c9 ` Lu\u03c9 \u201c 0, that is the vorticity of each phase is transported by the corresponding velocity field: Bt\u03c9j ` Luj\u03c9j \u201c 0 .\nWe would like to emphasize that in the classical Euler equation, the vorticity (along with circulations in a non-simply-connected M) fully determine the velocity field. In the multiphase setting the situation is different: in particular, there are nontrivial solutions with zero vorticity and zero circulation. The reason is in the different geometry of symplectic leaves for the corresponding Poisson bracket. Indeed, in the group setting these leaves are coadjoint orbits in g\u02da of the corresponding group, while in the case of an algebroid one has the group action only in the kernel bundle of the corresponding anchor map (and in its dual bundle). The corresponding symplectic leaves are obtained by taking the inverse images of the orbits for the action under the projection of A\u02da into that dual bundle, cf. [12]. We hope to return to this description in a future publication."
        },
        {
            "heading": "1.3 Structure of the paper",
            "text": "The rest of the paper is a detailed discussion of objects involved in the above theorems, along with proofs of those theorems. We start with the discrete case (Theorems 1.7 - 1.9). It is discussed in Sections 3 and 4 (while in Section 2 we recall basics of the groupoid and algebroid theory). The continuous case (Theorems 1.3 and 1.4) is discussed in Section 5. The proofs in that case are very similar to the discrete situation, so we only discuss necessary modifications.\nSeveral open problems and suggested in Section 6. It is worth mentioning that the groupoid approach above may also allow one to give a geometric description for yet another equivalent point of view on generalized flows, taken by Brenier [4] and Shnirelman [18] (see also [2, Section IV.7]), as probabilistic measures on the space of parametrized continuous paths in the flow domain. It would be also interesting to describe the group and Hamiltonian picture for vector and matrix densities in [8, 9] and the surprising appearance of the general relativity equation for matrix measures in [7].\nAcknowledgements. We are indebted to the MFO Institute in Oberwolfach, Germany and its program of Research in Pairs, where this work was completed. We are also grateful to the anonymous referee for various suggestions improving the exposition. A.I. was supported by NSF grant DMS-2008021. B.K. was partially supported by an NSERC Discovery grant."
        },
        {
            "heading": "2 Lie groupoids and algebroids",
            "text": "In this section we briefly recall basic facts about Lie groupoids and algebroids (details can be found, e.g., in [10, 15])."
        },
        {
            "heading": "2.1 Lie groupoids",
            "text": "Definition 2.1. A groupoid G \u00d1 B is a pair of sets, B (the base of the groupoid) and G (the groupoid itself), endowed with the following structures:\n1. Two maps src, trg : G \u00d1 B, called source and target respectively.\n2. Partial binary operation pg, hq \u00de\u00d1 gh on G which is defined for all pairs g, h P G such that srcpgq \u201c trgphq and has the following properties:\n(a) The source of the product is the source of the right factor: srcpghq \u201c srcphq, while the target of the product is the target of the left factor: trgpghq \u201c trgpgq.\n(b) Associativity: gphkq \u201c pghqk whenever any of those expressions is well-defined. (c) Identity: for any x P B, there exists an element idx P G such that idtrgpgq \u00a8 g \u201c g \u00a8 idsrcpgq \u201c g for every g P G. (d) Inverse: for any g P G, there exists an element g\u00b41 P G such that g\u00b41g \u201c idsrcpgq\nand gg\u00b41 \u201c idtrgpgq.\nA groupoid G \u00d1 B is called a Lie groupoid if G, B are manifolds, the source and target are submersions, and the maps pg, hq \u00de\u00d1 gh, x \u00de\u00d1 idx, and g \u00de\u00d1 g\u00b41 are smooth. (The domain of the multiplication map is tpx, yq P G\u02c6G | srcpxq \u201c trgpyqu. The submersion property of source and target ensures that this set is a submanifold of G \u02c6 G, so smoothness of multiplication is well-defined.)\nExample 2.2. (a) Any Lie group G is a Lie groupoid over a point.\n(b) For any smooth manifold B, the set G :\u201c B \u02c6 B is a Lie groupoid over B, called the pair groupoid. The source and target are defined by srcpx, yq \u201c x, trgpx, yq \u201c y, while the product is given by py, zqpx, yq :\u201c px, zq.\n(c) Let B be a smooth manifold, and let G be a Lie group acting on B. Then the action Lie groupoid G\u02d9B \u00d1 B is defined as follows. The points of G\u02d9B are triples pg;x, yq, where x, y P B, g P G, and gx \u201c y. The source map is given by srcpg;x, yq :\u201c x, the target is trgpg;x, yq :\u201c y, and the multiplication is defined by ph; y, zqpg;x, yq :\u201c phg;x, zq .\nDefinition 2.3. A groupoid G \u00d1 B is called transitive if for any x, y P B there exists g P G such that srcpgq \u201c x and trgpgq \u201c y.\nFor example, an action groupoid G \u02d9 B is transitive if and only if the G-action on B is transitive.\nDefinition 2.4. Let G \u00d1 B be a groupoid. Then the source fiber Gx of G corresponding to x P B is the set Gx :\u201c tg P G | srcpgq \u201c xu.\nFor instance, for an action groupoid G\u02d9B, any source fiber is canonically identified with the group G."
        },
        {
            "heading": "2.2 Lie algebroids",
            "text": "The infinitesimal object corresponding to a Lie groupoid is a Lie algebroid.\nDefinition 2.5. A Lie algebroid A over a manifold B is a vector bundle A \u00d1 B endowed with a Lie bracket r , s on smooth sections and a vector bundle map #: A \u00d1 TB, called the anchor, such that for any two smooth sections \u03b6, \u03b7 of A and any smooth function f P C8pBq, one has r\u03b6, f\u03b7s \u201c f r\u03b6, \u03b7s ` pL#\u03b6fq\u03b7 .\nThe Lie algebroid A \u00d1 B corresponding to a Lie groupoid G \u00d1 B is constructed as follows. The fiber of A over x P B is the tangent space to the source fiber Gx at the identity idx. The anchor map on that fiber is defined as the differential of the target map trg : Gx \u00d1 B, while the bracket on sections is defined as follows. Every section of A can be uniquely extended to a right-invariant vector field on G tangent to source fibers, and the correspondence between such vector fields and sections of A is a vector space isomorphism (see Figure 3). This allows one to define the bracket of sections of A as the Lie bracket of the corresponding rightinvariant vector fields (which is again a right-invariant vector field tangent to source fibers, and, therefore, corresponds to a section of A).\nExample 2.6. For Lie groupoids of Example 2.2, the corresponding algebroids are:\n(a) The Lie algebra g of the group G, considered as a Lie algebroid over a point. The anchor map is trivial, while the bracket on sections (which are simply elements of g) is just the bracket on g.\n(b) The tangent bundle TB of B. The corresponding bracket on sections is the standard Lie bracket of vector fields, while the anchor map is the identity.\n(c) The action Lie algebroid g \u02d9B, where g is the Lie algebra of the group G. As a vector bundle, g \u02d9 B is a trivial bundle over B with fiber g. The anchor map g \u02d9 B \u00d1 TB is defined for an element pu, xq P g \u02d9 B by #pu, xq \u201c \u03c1upxq, where \u03c1u is the infinitesimal generator of the G-action corresponding to u P g. The bracket of sections is given by\nr\u03b6, \u03b7spxq :\u201c r\u03b6pxq, \u03b7pxqsg ` pL#\u03b6\u03b7qpxq \u00b4 pL#\u03b7\u03b6qpxq , (8)\nwhere r , sg is the bracket in g, and the derivatives L#\u03b6\u03b7, L#\u03b7\u03b6 are defined by identifying sections of g \u02d9B with g-valued functions on B.2\nDefinition 2.7. A Lie algebroid A \u00d1 B is called transitive if the anchor map is surjective.\nThe Lie algebroid associated with a transitive Lie groupoid is transitive."
        },
        {
            "heading": "2.3 Dual Lie algebroids as Poisson vector bundles",
            "text": "Recall that the dual space g\u02da of any Lie algebra g carries a natural linear Poisson structure. This result extends to the algebroid setting: the dual of a Lie algebroid is a Poisson vector bundle.\nDefinition 2.8. A Poisson vector bundle E \u00d1 B is a vector bundle whose total space E is endowed with a fiberwise linear Poisson structure, i.e. a Poisson structure such that the bracket of any two fiberwise linear functions is again a fiberwise linear function.\nTwo basic examples of Poisson vector bundles are a vector space endowed with a linear Poisson structure (which is a Poisson vector bundle over a point), and the cotangent bundle of a manifold B. These Poisson vector bundles are dual, respectively, to Lie algebroids g and TB from Examples 2.6(a) and 2.6(b). For general Lie algebroids, one has the following result.\nProposition 2.9. The dual bundle3 A\u02da \u00d1 B of any Lie algebroid A \u00d1 B has a natural structure of a Poisson vector bundle. The Poisson structure on A\u02da is uniquely determined by requiring that for arbitrary fiberwise linear functions \u03b6, \u03b7 and an arbitrary fiberwise constant function f , one has t\u03b6, \u03b7u :\u201c r\u03b6, \u03b7s, t\u03b6, fu :\u201c L#\u03b6f . Here we identify fiberwise linear functions on A\u02da with sections of A, and fiberwise constant functions on A\u02da with functions on the base B.\nIn what follows, we will need the following explicit formula for the Poisson structure on a Lie algebroid dual.\nProposition 2.10. [3] Let A be a Lie algebroid. Then, for any \u03b1 P A\u02da and for any smooth functions f, g P C8pA\u02daq, one has\ntf, gup\u03b1q \u201c x\u03b1, rdF fp\u03b1\u0302q, dF gp\u03b1\u0302qsy ` L#dF fp\u03b1q ` g \u02dd \u03b1\u0302 \u00b4 x\u03b1\u0302, dF gp\u03b1\u0302qy \u02d8\n\u00b4L#dF gp\u03b1q ` f \u02dd \u03b1\u0302 \u00b4 x\u03b1\u0302, dF fp\u03b1\u0302qy \u02d8\n, (9)\nwhere \u03b1\u0302 is an arbitrary section of A\u02da extending \u03b1, and dF fp\u03b1q, dF gp\u03b1q P A are fiber-wise differentials of f and g at \u03b1 (i.e. differentials restricted to the tangent space of the fiber of \u03b1 P A\u02da).\nThis formula can be used as a definition in the infinite-dimensional case. Although for general infinite-dimensional algebroids it is not even clear why this expression makes sense, we prove it below by obtaining an explicit formula in the setting of multiphase diffeomorphism groupoids.\n2It is useful to compare this bracket to that of a semidirect product Lie algebra g\u0303 :\u201c g\u02d9B, where the group of the Lie algebra g acts on a vector space B (e.g. the Lie algebra for the group of affine transformations of B, the semidirect product of linear transformations and translations). The Lie bracket of g\u0303 between two elements pu, \u03b1q, pv, \u03b2q P g \u02d9 B is pru, vsg, adu\u03b2 \u00b4 adv\u03b1q .\n3If the fibers of A are infinite-dimensional, then the fibers of A\u02da consist of sufficiently regular functionals on fibers of A. In the hydrodynamical setting we will make this precise below.\nAlso note that for an action algebroid (see Example 2.6c) formula (9) becomes\ntf, gup\u03b1q \u201c x\u03b1, rdF fp\u03b1q, dF gp\u03b1qsy ` qpf, gq \u00b4 qpg, fq, (10)\nwhere qpf, gq :\u201c x\u03b1,L#dF fp\u03b1qdF gp\u03b1\u0302qy ` L#dF fp\u03b1q ` g \u02dd \u03b1\u0302 \u00b4 x\u03b1\u0302, dF gp\u03b1\u0302qy \u02d8 . (11)"
        },
        {
            "heading": "2.4 Euler-Arnold equations on Lie algebroids",
            "text": "Let A \u00d1 B be a finite- or infinite-dimensional Lie algebroid, and let I : A \u00d1 A\u02da be an invertible bundle morphism. (In the infinite-dimensional case one needs to consider the smooth dual bundle A\u02da, similarly to consideration of smooth duals of infinite-dimensional Lie algebras, cf. [2]. In the hydrodynamical setting we define this smooth dual in detail in Section 3.) We call such I an inertia operator. An inertia operator I defines a metric on A given by\nxu, vyA :\u201c xIpuq, vy\nfor any u, v in the same fiber of A. Since the inertia operator I is invertible, one also has a dual metric on A\u02da: x\u03b1, \u03b2yA\u02da :\u201c xI\u00b41p\u03b1q, \u03b2y \u201c xI\u00b41p\u03b1q, I\u00b41p\u03b2qyA for any \u03b1, \u03b2 in the same fiber of A\u02da. Consider also a function H P C8pA\u02daq defined by\nHp\u03b1q :\u201c 1 2 x\u03b1, \u03b1yA\u02da @\u03b1 P A\u02da.\nDefinition 2.11. The Hamiltonian equation associated with the Poisson structure on A\u02da and the function H is called the groupoid Euler-Arnold equation corresponding to the metric x , yA.\nExample 2.12. When A is a Lie algebra, we obtain the standard notion of an Euler-Arnold equation on a Lie algebra dual. When A \u201c TB is the tangent bundle of a manifold B, the Euler-Arnold equation is the geodesic equation on B. (The latter is, of course, a second order equation on B, but it becomes first order \u2013 specifically, the algebroid Euler-Arnold equation \u2013 if we interpret it as an equation on TB.)\nRemark 2.13. In the case when the algebroid A is associated with a certain Lie groupoid G, solutions of the Euler-Arnold equation can be interpreted as geodesics of a right-invariant source-wise (i.e. defined only for vectors tangent to source fibers) metric on G. In the transitive case those solutions can also be thought of as geodesics on any source fiber Gx.\nFurthermore, an Euler-Arnold equation on a transitive algebroid A \u00d1 B always gives rise to a certain geodesic flow on the base B. Indeed, let A \u00d1 B be a Lie algebroid. Then, since the anchor map #: A \u00d1 TB is an algebroid morphism, the dual map #\u02da : T \u02daB \u00d1 A\u02da is Poisson. Note that if, moreover, the algebroid A is transitive, then #\u02dapT \u02daBq is a symplectic leaf in A\u02da. Indeed, if A is transitive, then the Poisson map #\u02da is injective, while the image of a closed injective Poisson map of a symplectic manifold is always a symplectic leaf.\nProposition 2.14. Let A \u00d1 B be a transitive Lie algebroid, and let x , yA be a positivedefinite metric on A for an invertible inertia operator I : A \u00d1 A\u02da. Assume also4 that for this metric x , yA there is an orthogonal decomposition A \u201c Ker# \u2018 pKer#qK. Then the following holds:\n4Note that this property is automatic in the finite-dimensional case.\n1. The pullback of the groupoid Euler-Arnold flow corresponding to the metric x , yA from the symplectic leaf #\u02dapT \u02daBq to T \u02daB is the geodesic flow for a certain metric x , yB on B. Explicitly, for any x P B and any \u03b6, \u03b7 P TxB, the metric x , yB reads\nx\u03b6, \u03b7yB \u201c x#\u00b41p\u03b6q,#\u00b41p\u03b7qyA , (12)\nwhere #\u00b41 : TB \u00d1 pKer#qK is the inverse for the restriction of the anchor map to pKer#qK.\n2. Assume, in addition, that the algebroid A corresponds to a certain transitive groupoid G. Then, for every x P B, the target mapping trg : pGx, x , yGq \u00d1 pB, x , yBq is a Riemannian submersion. (Here the metric x , yG on Gx is defined using the identification between metrics on A and right-invariant source-wise metrics on G, see Remark 2.13.)\nFor the proof see [12].\nExample 2.15. Let M be a Riemannian manifold. Consider the natural transitive action of its diffeomorphism group DiffpMq on the space DenspMq of densities on M of unit total mass, and let DiffpMq \u02d9DenspMq be the corresponding action groupoid (see Example 2.2(c)). Define a metric on the corresponding action algebroid VectpMq \u02d9 DenspMq by setting\nxu, vyL2 :\u201c \u017c\nM pu, vq\u00b5\nfor u, v lying in the fiber of VectpMq \u02d9 DenspMq over \u00b5 P DenspMq. (Recall that the fibers of VectpMq \u02d9 DenspMq are identified with the Lie algebra VectpMq, see Example 2.6(c).) Then, according to Remark 2.13, for any \u00b5 P DenspMq, there is a corresponding metric on the source fiber pDiffpMq \u02d9 DenspMqq\u00b5 \u201c DiffpMq. It is an L2-type metric on DiffpMq, and there is a Riemannian submersion of that metric onto Wasserstein metric on DenspMq, see [16] and Remark 4.8 below.\nExample 2.16. Another example is given by the metric on the space VSpMq of vortex sheets in a manifold M , discussed in [12, 14] and in Appendix below. In that case one considers the Lie groupoid DSDiffpMq of volume-preserving diffeomorphisms of a manifold M that are discontinuous along a hypersurface. Its Lie algebroid DSVectpMq \u00d1 VSpMq consists of velocities of the fluid with a vortex sheet: given a vortex sheet \u0393, the corresponding velocities are discontinuous vector fields on M of the form u \u201c \u03c7`\u0393u` ` \u03c7 \u00b4 \u0393u ,\u0301 where \u03c7 ` \u0393 , \u03c7 \u00b4 \u0393 are the indicator functions of connected components D\u02d8\u0393 of M z \u0393, and u\u02d8 are smooth divergencefree vector fields on D\u02d8\u0393 such that the restrictions of u\n` and u\u00b4 to \u0393 have the same normal component, see appendix. There is a Riemannian submersion from an L2 metric on DSDiffpMq to a metric on the space of classical vortex sheets, cf. [12, 14]."
        },
        {
            "heading": "3 Kinematics of multiphase fluids",
            "text": "In this section, M is a compact connected manifold without boundary endowed with a volume form volM ."
        },
        {
            "heading": "3.1 The Lie groupoid of multiphase diffeomorphisms",
            "text": "In this subsection, we define the Lie groupoid MDiffpMq of volume-preserving multiphase diffeomorphisms. This groupoid (or, more precisely, any of its source fibers) can be viewed as the configuration space of a fluid with several phases penetrating through each other. The conditions defining the groupoid MDiffpMq can be seen as integration of the corresponding infinitesimal equation (7), just like the group of volume-preserving diffeomorphisms arises from \u201cintegrating\u201d the divergence-free condition on the corresponding velocity field u.\nThe base of the groupoid MDiffpMq is, by definition, the space MDenspMq of multiphase densities, i.e. the space of n-tuples \u00b5 :\u201c p\u00b51, ..., \u00b5nq, where each \u00b5i P DenspMq is a density (top-degree form) on M , satisfying the following conditions:\n1. \u0159n j\u201c1 \u00b5j \u201c volM .\n2. \u00b5j \u0105 0 for all j \u201c 1, ..., n everywhere on M .\n3. \u015f M \u00b5j \u201c cj for fixed constants c1, . . . , cn P R (such that \u0159n j\u201c1 cj \u201c \u015f M volM ).\nThese densities can be thought of as densities of different fractions of the fluid, that can penetrate through each other without resistance, subject only to the total incompressibility condition. The case of two densities, n \u201c 2, supported on two different sides of the separating hypersurface \u0393 \u0102 M corresponds to the regular vortex sheet \u0393 for an incompressible flow in M . This case belongs to the closure of our space of positive densities. The general case with densities p\u00b51, ..., \u00b5nq corresponds to a multiphase fluid where different phases can percolate through each other.\nThe elements of MDiffpMq are n-tuples of diffeomorphisms of M preserving the above property of incompressibility of multiphase densities, i.e. the set of tuples p\u03d5 ;\u00b5,\u00b51q :\u201c p\u03d51, ..., \u03d5n;\u00b51, ..., \u00b5n, \u00b511, ..., \u00b51nq with multiphase forms \u00b5,\u00b51 P MDenspMq such that the multiphase diffeomorphism \u03d5 push-forwards one of them to the other, \u03d5\u02da\u00b5 \u201c \u00b51 component-wisely. The source and the target of p\u03d5 ;\u00b5,\u00b51q are, by definition, \u00b5 and \u00b51 respectively. The multiplication in MDiffpMq is given by composition of diffeomorphisms:\np\u03c8 ;\u00b51,\u00b52qp\u03d5 ;\u00b5,\u00b51q :\u201c p\u03c8\u03d5 ;\u00b5,\u00b52q .\nRemark 3.1. The groupoid MDiffpMq \u00d1 MDenspMq is a transitive Lie-Fre\u0301chet groupoid. The proof of the Lie-Fre\u0301chet property is the standard consideration similar to that for groups of diffeomorphisms, cf. [12]. One can consider a more general case of densities \u00b5j \u011b 0 on M , in which case the groupoid is not necessarily transitive. The latter case covers that of the usual vortex sheets \u0393 \u0102 M , corresponding to the indicator densities supported on two different sides of Mz\u0393, see Appendix.\nSince MDiffpMq is a Lie-Fre\u0301chet groupoid, it follows that the corresponding algebroid is well-defined as a Fre\u0301chet vector bundle over MDenspMq with a bracket and anchor on smooth sections. We describe this algebroid in detail in the next section.\nRemark 3.2. One can also consider the groupoid MDiffpMq in the category of Hilbert manifolds modeled on Sobolev Hs spaces for sufficiently large s, s \u0105 dimM{2 ` 1, similarly to, e.g., [11] or [13, Remark 3.3]. Note also that if n \u201c 1, i.e. we have a one-phase fluid, with the groupoid MDiffpMq becoming the group SDiffpMq of \u00b5-preserving diffeomorphisms of M .\nRemark 3.3. Note that if we drop the requirement that the densities \u00b5j sum to volM in the definition of the groupoid MDiffpMq, we obtain the definition of the action groupoid\nDiffpMqn \u02d9 DenspMqn, which is the product of n copies of the action groupoid DiffpMq \u02d9 DenspMq (see Example 2.2(c)) corresponding to the natural action of the group DiffpMq on the space of densities DenspMq. So, the action groupoid DiffpMqn \u02d9 DenspMqn comes with a subgroupoid MDiffpMq. The subgroupoid MDiffpMq inherits certain properties of the ambient action groupoid. In particular, the brackets in the algebroids corresponding to these groupoids are given by the same formulas."
        },
        {
            "heading": "3.2 The Lie algebroid of multiphase vector fields",
            "text": "In this subsection we describe the Lie algebroid MVectpMq \u00d1 MDenspMq corresponding to the Lie groupoid MDiffpMq. This algebroid serves as the space of velocities for a multiphase fluid.\nTheorem 3.4. The Lie algebroid MVectpMq \u00d1 MDenspMq corresponding to the groupoid MDiffpMq is as follows:\n1. The fiber of MVectpMq over \u00b5 :\u201c p\u00b51, ..., \u00b5nq P MDenspMq is the space MVectpM,\u00b5q which consists of multiphase vector fields on M of the form u :\u201c pu1, ..., unq, where uj P VectpMq are such that\n\u00ffn\nj\u201c1 Luj\u00b5j \u201c 0 (13)\n(in other words, the multiphase vector field is \u201cdivergence-free\u201d with respect to the multiphase volume form).\n2. The anchor map #: MVectpM,\u00b5q \u00d1 T\u00b5MDenspMq is given by the negative Lie derivative,\nu :\u201c pu1, ..., unq \u00de\u00d1 \u00b4Lu\u00b5 :\u201c p\u00b4Lu1\u00b51, ...,\u00b4Lun\u00b5nq .\n3. Let U, V be sections of MVectpMq. Then their algebroid bracket is\nrU, V sp\u00b5q \u201c rUp\u00b5q, V p\u00b5qs ` L#Up\u00b5qV \u00b4 L#V p\u00b5qU , (14)\nwhere the first summand in the right-hand side is the usual Lie bracket of vector fields on M .\nRemark 3.5. The derivative L#Up\u00b5qV is a multiphase vector field defined by\nL#Up\u00b5qV :\u201c d\ndt |t\u201c0V p\u00b5ptqq ,\nwhere \u00b5ptq is any smooth curve in MDenspMq with \u00b5p0q \u201c \u00b5 and the tangent vector at \u00b5 given by #Up\u00b5q. That derivative does not have to lie in MVectpM,\u00b5q, but belongs to the bigger space VectpMqn :\u201c tpu1, ..., unq | uj P VectpMqqu of n-tuples of vector fields on M with no condition (13).\nRemark 3.6. Note that the first term on the right-hand side of (14) is not an element of MVectpM,\u00b5q. Indeed, for two multiphase vector fields u and v satisfying \u0159\ni Luj\u00b5j \u201c \u0159\ni Lvj\u00b5j \u201c 0, their (component-wise) Lie bracket does not necessarily have this property. However, the last two terms do not have this property either (see Remark 3.5) and compensate the first term.\nRemark 3.7. The Lie algebroid MVectpMq is a subalgebroid in the action algebroid VectpMqn \u02d9 DenspMqn of smooth multiphase vector fields without restrictions acting on volume multiphase forms (see Remark 3.3). Because of that the bracket in MVectpMq automatically has form (14) (cf. Example 2.6(c)). However, MVectpMq is not an action algebroid. In particular, the fibers of MVectpMq are not closed under the Lie bracket of vector fields (see Remark 3.6) and hence do not have any natural Lie algebra structure.\nProof of Theorem 3.4. We begin with the first statement. By definition, the fiber of MVectpMq over \u00b5 consists of tangent vectors at id\u00b5 P MDiffpMq to curves of the form p\u03d5ptq;\u00b5,\u00b5ptqq, where \u00b5p0q \u201c \u00b5 and \u03d5p0q \u201c pid, . . . , idq. The tangent vector to such a curve is an n-tuple of vector fields\nuj \u201c d\ndt |t\u201c0\u03d5jptq P VectpMq .\nAlso note that \u00ffn\nj\u201c1 \u03d5jptq\u02da\u00b5j \u201c\n\u00ffn\nj\u201c1 \u00b5jptq \u201c volM .\nDifferentiating this relation with respect to t at t \u201c 0, we get (13), as needed. Conversely, given any n-tuple of vector fields uj P VectpMq satisfying (13), one can construct a curve \u03d5ptq in the source fiber MDiffpMq\u00b5 whose tangent vector at id\u00b5 coincides with u. So, the fiber of MVectpMq over \u00b5 is indeed the space MVectpM,\u00b5q.\nTo prove the second statement we need the following.\nLemma 3.8. The tangent space T\u00b5MDenspMq is the space of multiphase top-degree forms \u03be \u201c p\u03be1, ..., \u03benq satisfying the following conditions:\n1. \u0159n j\u201c1 \u03bej \u201c 0 on M .\n2. \u015f M \u03bej \u201c 0 for each i \u201c 1, . . . , n.\nProof. These are infinitesimal versions of the conditions \u0159 i \u00b5j \u201c volM and \u015f M \u00b5j \u201c cj respectively.\nNow, we compute the anchor map (one can also get the formula for the anchor map using that our algebroid is a subalgebroid in the action algebroid, see Remark 3.7). Let u P MVectpMq\u00b5. Consider a curve p\u03d5ptq;\u00b5,\u00b5ptqq P MDiffpMq\u00b5 where \u00b5ptq :\u201c \u03d5ptq\u02da\u00b5 and whose tangent vector at id\u00b5 is u. Then, by definition of the anchor map for the algebroid of a Lie groupoid, we have\n#u \u201c d dt |t\u201c0trgp\u03d5ptqq \u201c d dt |t\u201c0\u03d5ptq\u02da\u00b5 \u201c \u00b4Lu\u00b5 ,\nas desired. Finally, the last statement of the theorem follows from the fact that our algebroid is a subalgebroid in the action algebroid (see Remark 3.7) and formula (8) for the action algebroid bracket. Thus, Theorem 3.4 is proved. l"
        },
        {
            "heading": "3.3 The dual algebroid and its tangent space",
            "text": "In this subsection, we describe the dual of the Lie algebroid MVectpMq. This space can be viewed as the space of momenta for a multiphase fluid.\nAs the dual of MVectpMq, we consider the \u201csmooth dual bundle\u201d defined as follows.\nDefinition 3.9. The smooth dual MVectpM,\u00b5q\u02da of the space MVectpM,\u00b5q is the space of linear functions f : MVectpM,\u00b5q \u00d1 R that admit a smooth density, which means that there exist smooth 1-forms \u03b11, . . . , \u03b1n such that\nfpuq \u201c \u00ffn\nj\u201c1\n\u017c\nM \u03b1jpujq\u00b5j (15)\nfor all u P MVectpM,\u00b5q.\nFormula (15) defines a surjective linear map \u03c0 : \u21261pMqn \u00d1 MVectpM,\u00b5q\u02da: each collection p\u03b11, . . . , \u03b1nq P \u21261pMqn is mapped to a linear function on MVectpM,\u00b5q defined by (15). Proposition 3.10. The kernel of the map \u03c0 : \u21261pMqn \u00d1 MVectpM,\u00b5q\u02da consists of n-tuples of the form pdf, . . . , dfq, where f P C8pMq. Therefore, we have an isomorphism\nMVectpM,\u00b5q\u02da :\u201c \u21261pMqn{\u03b4pdC8pMqq,\nwhere \u03b4 : \u21261pMq \u00d1 \u21261pMqn is the diagonal embedding \u03b4p\u03b1q \u201c p\u03b1, . . . , \u03b1q.\nProof. First observe that \u03b4pdC8pMqq \u0102 Ker\u03c0. This is due to condition (13):\nxpdf, . . . , dfq,uy \u201c \u00ffn\nj\u201c1\n\u017c\nM dfpujq\u00b5j \u201c \u00b4\n\u00ffn\nj\u201c1\n\u017c\nM f ^ Luj\u00b5j\n\u201c \u00b4 \u017c\nM f ^\n\u00ffn\nj\u201c1 Luj\u00b5j \u201c 0 .\nSo, the map \u03c0 : \u21261pMqn \u00d1 MVectpM,\u00b5q\u02da descends to a surjective linear map\n\u03c0 : \u21261pMqn{\u03b4pdC8pMqq \u00d1 MVectpM,\u00b5q\u02da.\nWe need to show that the latter is injectibe. This is based on the following.\nProposition 3.11. For any choice of a Riemannian metric on M , any coset r\u03b1s P \u21261pMqn{\u03b4pdC8pMqq has a unique (\u201cco-closed\u201d) representative \u03b1 P \u21261pMqn such that\nd\u02da \u00ffn\nj\u201c1 \u03c1j\u03b1j \u201c 0 , (16)\nwhere \u03c1j :\u201c \u00b5j{volM .\nProof. This is equivalent to saying that for any \u03b1 P \u21261pMqn there exists a function f P C8pMq, unique up to an additive constant, such that\nd\u02da \u00ffn j\u201c1 \u03c1jp\u03b1j ` dfq \u201c 0 \u00f4 d\u02da\n\u00b4\ndf ` \u00ffn\nj\u201c1 \u03c1j\u03b1j\n\u00af\n\u201c 0 \u00f4 \u2206f \u201c \u00b4d\u02da \u00ffn\nj\u201c1 \u03c1j\u03b1j .\nThis is a Poisson equation on f whose solution is unique up to an additive constant, as needed.\nReturning to the proof of Proposition 3.10, given r\u03b1s P \u21261pMqn{\u03b4pdC8pMqq, r\u03b1s \u2030 0, consider its representative \u03b1 satisfying (16) for some Riemannian metric on M . Then the multiphase vector field \u03b17 satisfies (13), so \u03b17 P MVectpM,\u00b5q. Furthermore, we have\n@ \u03c0pr\u03b1sq,\u03b17 D \u201c \u00ffn\nj\u201c1\n\u017c\nM\n\u00b4\n\u03b17j , \u03b1 7 j\n\u00af\n\u00b5j \u0105 0 ,\nand hence \u03c0pr\u03b1sq \u2030 0. So \u03c0 is indeed injective, as needed.\nIn what follows we make an identification MVectpM,\u00b5q\u02da \u00bb \u21261pMqn{\u03b4pdC8pMqq. Accordingly, the smooth dual of the algebroid MVectpMq is the trivial vector bundle\nMVectpMq\u02da \u201c \u010f \u00b5PMDenspMq MVectpM,\u00b5q\u02da \u201c ` \u21261pMqn{\u03b4pdC8pMqq \u02d8 \u02c6 MDenspMq.\nover the space of multiphase densities MDenspMq. An important property of the smooth dual MVectpM,\u00b5q\u02da \u201c \u21261pMqn{\u03b4pdC8pMqq is that this subspace of the full dual space \u201cseparates points\u201d, meaning that for any non-zero u P MVectpM,\u00b5q there exists r\u03b1s P MVectpM,\u00b5q\u02da such that xr\u03b1s,uy \u2030 0 (indeed, one can take \u03b1 :\u201c u5). This is equivalent to saying that MVectpM,\u00b5q injects into the dual of its smooth dual, which is needed for the Poisson bracket on MVectpMq\u02da to be well-defined. This Poisson bracket is described in the next section. For this we describe the tangent and cotangent spaces to MVectpMq\u02da. First we note that since MVectpMq\u02da is a trivial vector bundle, we have the following natural splitting of its tangent space.\nProposition 3.12. There is a natural splitting\nTr\u03b1s,\u00b5MVectpMq\u02da \u00bb MVectpM,\u00b5q\u02da \u2018 T\u00b5MDenspMq . (17)"
        },
        {
            "heading": "3.4 Poisson bracket on the dual algebroid",
            "text": "In this section we show that formula (9) gives a well-defined Poisson bracket on MVectpMq\u02da. For this we need to describe the cotangent space to MVectpMq\u02da and we start by defining the cotangent space to the base, T \u02da\u00b5 MDenspMq. Definition 3.13. The smooth cotangent space T \u02da\u00b5 MDenspMq is the quotient C80 pMqn { \u03b4pC80 pMqq, where C80 pMq :\u201c C8pMq {R, and \u03b4 : C80 pMq \u00d1 C80 pMqn is the diagonal embedding h \u00de\u00d1 ph, . . . , hq. The pairing between a coset rf s P C80 pMqn { \u03b4pC80 pMqq and a tangent vector \u03be P T\u00b5MDenspMq (i.e. a collection p\u03be1, . . . , \u03benq of top-degree forms on M such that\n\u0159n j\u201c1 \u03bej \u201c 0, see Lemma 3.8) is given by\nxrf s, \u03bey :\u201c \u00ffn\nj\u201c1\n\u017c\nM fj\u03bej .\n(The right-hand side does not depend on the choice of a representative f P rf s thanks to the zero sum condition on \u03be . The integral \u015f\nM fj\u03bej is well-defined for fj P C 8 0 pMq since \u015f M \u03bej \u201c 0.)\nNow we define the cotangent space to MVectpMq\u02da by dualizing splitting (17).\nDefinition 3.14. Let pr\u03b1s,\u00b5q P MVectpMq\u02da. Then the smooth cotangent space to MVectpMq\u02da at pr\u03b1s,\u00b5q is\nT \u02dar\u03b1s,\u00b5MVectpMq \u02da :\u201c MVectpM,\u00b5q \u2018 T \u02da\u00b5 MDenspMq , (18)\nwhere the second summand is the smooth cotangent space.\nFurther, we define the notion of a differentiable function on MVectpMq\u02da. Roughly speaking, a function is differentiable if it has a differential belonging to the smooth cotangent space.\nDefinition 3.15. A function F : MVectpMq\u02da \u00d1 R is differentiable if there exists a section dF of the smooth cotangent bundle T \u02daMVectpMq\u02da such that for any smooth curve pr\u03b1sptq, \u00b5ptqq in MVectpMq\u02da one has\nd dt F pr\u03b1sptq,\u00b5ptqq \u201c xdF pr\u03b1sptq,\u00b5ptqq , p d dt r\u03b1sptq, d dt \u00b5ptqqy .\nUsing splitting (18), we decompose dFpr\u03b1sq for r\u03b1s P MVectpM,\u00b5q\u02da into the fiber and base parts:\ndF pr\u03b1s,\u00b5q \u201c ` dFF pr\u03b1s,\u00b5q , dBF pr\u03b1s,\u00b5q \u02d8 ,\nwhere\ndFF pr\u03b1s,\u00b5q P MVectpM,\u00b5q , dBF pr\u03b1s,\u00b5q P T \u02da\u00b5 MDenspMq \u201c C80 pMqn { \u03b4pC80 pMqq.\nTheorem 3.16. Let F1,F2 : MVectpMq\u02da \u00d1 R be differentiable functions. Then their Poisson bracket reads\ntF1,F2u \u201c PpdF1, dF2q ,\nwhere the value of the Poisson tensor P on two cotangent vectors\npu, rf sq, pv, rgsq P T \u02dar\u03b1s,\u00b5MVectpMq \u02da \u201c MVectpM,\u00b5q \u2018 T \u02da\u00b5 MDenspMq\nat a point pr\u03b1s,\u00b5q P MVectpMq\u02da is\nPr\u03b1s,\u00b5 ppu, rf sq, pv, rgsqq \u201c \u00ffn\nj\u201c1\n\u017c\nM\n` \u00b4d\u03b1jpuj , vjq ` Lujgj \u00b4 Lvjfj \u02d8 \u00b5j . (19)\nHere \u03b1 P \u21261pMqn is an arbitrary representative of the coset r\u03b1s.\nRemark 3.17. Equivalently, this bracket can be written in the form, similar to a Lie-Poisson bracket with additional terms:\nPr\u03b1s,\u00b5 ppu, rf sq, pv, rgsqq\n\u201c \u00ffn\nj\u201c1\n\u017c\nM\n` \u03b1ipruj , vjsq ` Lvj ` iuj\u03b1j \u00b4 fj \u02d8 \u00b4 Luj ` ivj\u03b1j \u00b4 gj \u02d8\u02d8 \u00b5j . (20)\nProof of Theorem 3.16. Formulas (19) and (20) are equivalent to each other. To see this, rewrite the first term in (20) using the formula iru,vs \u201c rLu, ivs. So, it suffices to derive (20).\nSince the bracket (14) on sections of MVectpMq has the same form as for an action algebroid, we can compute the Poisson bracket in the dual using formula (10). This gives\ntF1,F2u pr\u03b1s,\u00b5q \u201c x\u03b1, \u201c dFF1pr\u03b1s,\u00b5q, dFF2pr\u03b1s,\u00b5q \u2030 y ` qpF1,F2q \u00b4 qpF2,F1q, (21)\nHere and below the pairing x , y between multiphase forms and multiphase vector fields is given by (15), and the commutator of multiphase vector fields is defined component-wisely. To compute the qpFk,Flq terms we extend r\u03b1s to a constant section A : MDenspMq \u00d1 MVectpMq, Ap\u00b5q :\u201c r\u03b1s of the trivial vector bundle MVectpMq\u02da. Also, let Uk be the section of MVectpMq given by Uk :\u201c dFFkpAq. Then formula (11) gives\nqpFk,Flq :\u201c x\u03b1,L#Ukp\u00b5qUly ` L#Ukp\u00b5q pFl \u02ddAq \u00b4 L#Ukp\u00b5qxA,Uly. (22)\nNow, take any curve \u00b5kptq P MDenspMq such that \u00b5kp0q \u201c \u00b5, and the tangent vector to \u00b5kptq at \u00b5 is #Ukp\u00b5q. Then, using that A is a constant section, we get\nL#Ukp\u00b5q pFl \u02ddAq \u201c d\ndt |t\u201c0FlpAp\u00b5kptqqq \u201c xdBFlpr\u03b1s,\u00b5q,#Ukp\u00b5qy. (23)\nFurther, we have\nL#Ukp\u00b5qxA,Uly \u201c d dt |t\u201c0 xAp\u00b5kptqq, Ulp\u00b5kptqqy \u201c d dt |t\u201c0 \u00ffn j\u201c1\n\u017c\nM\n\u00b4\niUlp\u00b5kptqqj\u03b1j\n\u00af\n\u00b5kptqj\n\u201c \u00ffn\nj\u201c1\n\u017c\nM\n\u02c6\ni d dt |t\u201c0Ulp\u00b5kptqqj \u03b1j\n\u02d9\n\u00b5kptqj ` \u00ffn\nj\u201c1\n\u017c\nM\n\u00b4\niUlp\u00b5kptqqj\u03b1j\n\u00af d\ndt |t\u201c0\u00b5kptqj\n\u201c @ \u03b1,L#Ukp\u00b5qUl D ` @ iUlp\u00b5q\u03b1,#Ukp\u00b5q D .\nSubstituting this, along with (23), into (22), we get\nqpFk,Flq :\u201c @ dBFlpr\u03b1s,\u00b5q \u00b4 iUlp\u00b5q\u03b1,#Ukp\u00b5q D .\nFinally, plugging this into (21) and using that Ulp\u00b5q \u201c dFFlpr\u03b1s,\u00b5q, one gets (20).\nCorollary 3.18. The Hamiltonian operator\nP7r\u03b1s,\u00b5 : T \u02da r\u03b1s,\u00b5MVectpMq \u02da \u00d1 Tr\u03b1s,\u00b5MVectpMq\u02da\ncorresponding to the Poisson bracket on MVectpMq\u02da is given by\npu, rf sq \u00de\u00d1 p\u00b4riud\u03b1s \u00b4 rdf s,\u00b4Lu\u00b5q . (24)\n(Note that the coset rdf s of df in \u21261pMqn{dC8pMq does not depend on the choice of a representative f in the coset rf s P C80 pMqn{C80 pMq.)\nProof. By definition, we have\nxpv, rgsq,P7r\u03b1s,\u00b5pu, rf sqy \u201c Pr\u03b1s,\u00b5 ppu, rf sq, pv, rgsqq\n\u201c \u00ffn\nj\u201c1\n\u017c\nM\n` \u00b4d\u03b1jpuj , vjq ` Lujgj \u00b4 Lvjfj \u02d8 \u00b5j\n\u201c x\u00b4riud\u03b1s \u00b4 rdf s, vy \u00b4 xLu\u00b5, rgsy.\nThe result follows.\nRemark 3.19. Using Proposition 4.6 below, the Hamiltonian operator (24) can be rewritten in terms of the anchor map #: MVectpMq \u00d1 TMDenspMq, as follows:\npu, rf sq \u00de\u00d1 p\u00b4riud\u03b1s \u00b4 #\u02darf s,#uq,\nwhich agrees with the corresponding operator for the motion of vortex sheets, see [12, Corollary 6.27]."
        },
        {
            "heading": "4 Dynamics of multiphase fluids",
            "text": ""
        },
        {
            "heading": "4.1 Geodesic and Hamiltonian framework for multiphase fluids",
            "text": "In this section, M is a compact connected oriented manifold without boundary endowed with a Riemannian metric p , q and the corresponding Riemannian volume form volM . We define a metric x , yL2 on the Lie algebroid MVectpMq as follows: for u,v P MVectpM,\u00b5q, one has\nxu,vyL2 :\u201c \u00ffn\nj\u201c1\n\u017c\nM puj , vjq\u00b5j . (25)\nProposition 4.1. 1. The inertia operator I associated with the L2-metric x , yL2 on MVectpMq takes values in the smooth dual MVectpMq\u02da. For u P MVectpM,\u00b5q, one has Ipuq \u201c ru5s, where\nu5 :\u201c pu51, . . . , u5nq,\nu5j denotes the 1-form dual to the vector field uj with respect to the Riemannian metric p , q on M , and ru5s stands for the coset of u5 in \u21261pMqn { \u03b4pdC8pMqq.\n2. The inertia operator I : MVectpMq \u00d1 MVectpMq\u02da is an isomorphism of vector bundles.\nProof. By definition of the inertia operator, for u,v P MVectpM,\u00b5q, one has\nxIpuq, vy \u201c xu,vyL2 \u201c \u00ffn\nj\u201c1\n\u017c\nM puj , vjq\u00b5j \u201c\n\u00ffn\nj\u201c1\n\u017c\nM ivju\n5 j \u00b5j .\nThis means that the functional Ipuq coincides with the functional represented by the coset of u5 P \u21261pMqn, proving the first statement.\nThe second statement, i.e. invertibility of the inertia operator, is equivalent to saying that the equation ru5s \u201c r\u03b1s has a unique solution u P MVectpM,\u00b5q for any coset r\u03b1s P MVectpM,\u00b5q\u02da. Written in terms of the form \u03b1 :\u201c u5, the condition u P MVectpM,\u00b5q translates to (16). (Indeed, the defining condition (13) of MVectpM,\u00b5q is equivalent to (7), which, in turn, is equivalent to (16) since the divergence of a vector field is the same as the co-differential of its metric dual form.) So, the result follows from Proposition 3.11. Explicitly, we have I\u00b41pr\u03b1sq \u201c \u03b17, where \u03b1 is the coset representative satisfying (16).\nSince the inertia operator is invertible, we also obtain an L2-metric on MVectpMq\u02da, and the corresponding Euler-Arnold Hamiltonian\nH pr\u03b1s,\u00b5q :\u201c 1 2 \u00ffn j\u201c1\n\u017c\nM p\u03b1j , \u03b1jq\u00b5j ,\nwhere \u03b1 P r\u03b1s is a representative satisfying (16).\nTheorem 4.2. The Euler-Arnold equation corresponding to the L2-metric on MVectpMq written in terms of a coset r\u03b1s P MVectpM,\u00b5q\u02da reads\n$\n&\n%\nBtr\u03b1s ` riud\u03b1 ` 1\n2 diu\u03b1s \u201c 0 , (26a)\nBt\u00b5 \u201c \u00b4Lu\u00b5 , (26b)\nwhere \u03b1 P r\u03b1s is the representative satisfying (16), and u :\u201c \u03b17 P MVectpM,\u00b5q. It is a Hamiltonian equation on the algebroid dual MVectpMq\u02da with respect to the natural Poisson structure described above and the energy Hamiltonian function H.\nRemark 4.3. Note that for a single phase fluid (n \u201c 1), the equations (26) are equivalent to Btr\u03b1s ` riud\u03b1s \u201c 0, and therefore to the Euler equation Btr\u03b1s ` Lur\u03b1s \u201c 0.\nProof of Theorem 4.2. It suffices to compute dHpr\u03b1s,\u00b5q and apply the Hamiltonian operator. Let pr\u03b1spsq,\u00b5psqq be an arbitrary smooth curve in MVectpMq\u02da \u201c p\u21261pMqn { \u03b4pdC8pMqqq \u02c6 MDenspMq with r\u03b1sp0q \u201c r\u03b1s and \u00b5p0q \u201c \u00b5. Let also \u03b1psq P r\u03b1spsq be the representative satisfying (16). Then\nd ds |s\u201c0Hpr\u03b1spsq,\u00b5psqq \u201c 1 2 d ds |s\u201c0 \u00ffn j\u201c1\n\u017c\nM p\u03b1jpsq, \u03b1jpsqq\u00b5jpsq\n\u201c xu, d ds |s\u201c0r\u03b1spsq y ` 1 2 \u00ffn j\u201c1\n\u017c\nM p\u03b1jpsq, \u03b1jpsqq\nd\nds |s\u201c0\u00b5jpsq ,\nimplying that\ndFHpr\u03b1s,\u00b5q \u201c u, dBHpr\u03b1s,\u00b5q \u201c 1 2 rp\u03b1,\u03b1qs .\nNow, to get (26), it suffices to apply the Hamiltonian operator (24), ending the proof.\nTheorem 4.4. The Euler-Arnold equations corresponding to the L2-metric on MVectpMq written in terms of the fluid velocities u :\u201c I\u00b41pr\u03b1sq P MVectpMq read\n\" Btuj ` \u2207ujuj \u201c \u00b4\u2207p, (27a) Bt\u00b5j \u201c \u00b4Luj\u00b5j , (27b)\nwhere the pressure p P C8pMq is common for all phases and is defined uniquely up to an additive constant by equations (27) supplemented by the condition\n\u00ffn\nj\u201c1 Luj\u00b5j \u201c 0. (28)\nEquivalently, equations (27) describe the velocity along a geodesic for the L2 metric on a source fiber of the groupoid MDiffpMq.\nProof. Equation (27b) was already established by Theorem 4.2, so it suffices to derive (27a). The latter rewrites as\nBt\u03b1j ` iujd\u03b1j ` 1\n2 diuj\u03b1j \u201c df ,\nwhere \u03b1 P r\u03b1s is the representative satisfying (16), and f P C8pMq does not depend on i. Equivalently, this can be written as\nBt\u03b1j ` Luj\u03b1j \u00b4 1\n2 diuj\u03b1j \u201c df .\nTaking the metric dual vector field and applying the formula pLuu5 \u00b4 12dpu, uqq 7 \u201c \u2207uu, we get Btu ` \u2207uu \u201c \u2207f ,\nwhich is equivalent to (27a) for p \u201c \u00b4f . Now, we show that the pressure p can be expressed, using conditions (27) and (28), in terms of velocity fields uj and densities \u00b5j (up to an additive constant). Let \u03c1j :\u201c \u00b5j{volM . Then, from (27a), we get\n\u00b4\u2207p \u201c \u00b4 \u00b4 \u00ffn\nj\u201c1 \u03c1j\n\u00af\n\u2207p \u201c \u00b4 \u00ffn\nj\u201c1 \u03c1j\u2207p \u201c\n\u00ffn\nj\u201c1 \u03c1jpBtuj ` \u2207ujujq.\nTaking divergence, we get\n\u00b4\u2206p \u201c div \u00ffn\nj\u201c1 \u03c1jpBtuj ` \u2207ujujq. (29)\nFurthermore, (28) can be rewritten as\ndiv \u00ffn\nj\u201c1 \u03c1juj \u201c 0,\nso (29) rewrites as\n\u00b4\u2206p \u201c div \u00ffn\nj\u201c1 p\u03c1j\u2207ujuj \u00b4 pBt\u03c1jqujq. (30)\nAlso, (26b) is equivalent to Bt\u03c1j \u201c \u00b4div p\u03c1jujq,\nso (30) becomes\n\u00b4\u2206p \u201c div \u00ffn\nj\u201c1 p\u03c1j\u2207ujuj ` div p\u03c1jujqujq,\ncf. (4). This is a Poisson equation on p, so the function p is indeed uniquely determined by uj , \u00b5j up to an additive constant. (Note that for n \u201c 1 the second term in the right-hand side vanishes and one gets the standard equation for the pressure \u00b4\u2206p \u201c div\u2207uu.)\nRecall that for a fluid velocity field u, the corresponding vorticity is the 2-form \u03c9 :\u201c du5. For an n-tuple of vector fields u P MVectpMq, the vorticity is an n-tuple\n\u03c9j :\u201c du5j .\nCorollary 4.5 (Generalized Kelvin\u2019s theorem). For a multiphase fluid, the vorticity of each phase is transported by the corresponding velocity field:\nBt\u03c9j ` Luj\u03c9j \u201c 0 .\nProof. Take the exterior derivative of both sides in (26a).\nIn particular, vorticities remain in the same diffeomorphism class during the Euler-Arnold evolution. Furthermore, solutions for potential initial conditions remain potential for all times, as they correspond to the vanishing initial vorticity, which always remains zero thanks to the corollary above. In the next section we discuss properties of potential solutions in detail."
        },
        {
            "heading": "4.2 Potential solutions as geodesics on the space of multiphase densities",
            "text": "Now, we apply Proposition 2.14 to obtain a geodesic description of potential solutions.\nProposition 4.6. Let rf s P T \u02da\u00b5 MDenspMq (recall that the latter space is C80 pMqn{\u03b4pC80 pMqq). Then its image under the map #\u02da : T \u02da\u00b5 MDenspMq \u00d1 MVectpM,\u00b5q\u02da is given by\n#\u02darf s :\u201c rdf s.\n(Note that the coset rdf s of df in \u21261pMqn{\u03b4pdC8pMqq does not depend on the choice of a representative f in the coset rf s P C80 pMqn{\u03b4pC80 pMqq.)\nProof. Let rf s P T \u02da\u00b5 MDenspMq, and let u P MVectpM,\u00b5q. Then\nx#\u02darf s,uy \u201c xrf s,#uy \u201c \u00b4 \u00ffn\nj\u201c1\n\u017c\nM fj Luj \u00b5j \u201c\n\u00ffn\nj\u201c1\n\u017c\nM piujdfjq\u00b5j \u201c xdf ,uy .\nThe result follows.\nIt follows that the vector field v :\u201c I\u00b41p#\u02darf sq \u201c I\u00b41prdf sq has the multiphase gradient form v \u201c \u2207f :\u201c p\u2207f1, ...,\u2207fnq. This means that the symplectic leaf #\u02dapT \u02daMDenspMqq \u0102 MVectpMq\u02da is metric dual to velocity fields of potential motions of a multiphase fluid.\nTheorem 4.7. 1. Potential solutions of equations (27) of a multiphase fluid are geodesics of a metric x , yMDens on MDenspMq induced by the product Wasserstein metric on the ambient space Densc1pMq \u02c6 \u00a8 \u00a8 \u00a8 \u02c6 DenscnpMq, where DenscpMq is the space of positive smooth densities on M with total mass c.\n2. For any multiphase density \u00b5 P MDenspMq the groupoid target mapping trg : pMDiffpMq\u00b5, x , yL2q \u00d1 pMDenspMq, x , yMDensq is a Riemannian submersion, see Figure 2. Here x , yL2 is the restriction of the right-invariant source-wise metric on MDiffpMq corresponding to the L2-metric on MVectpMq.\nRemark 4.8. Recall that the Wasserstein metric on the space DenscpMq of densities of fixed total volume c on M is defined as follows: for any tangent vector \u03be P T\u00b5DenscpMq its square length is\nx\u03be, \u03beyW :\u201c inf t xu, uyL2 | u P VectpMq, Lu\u00b5 \u201c \u03beu \u201c x\u2207f,\u2207fyL2 ,\nwhere f P C8pMq is such that L\u2207f\u00b5 \u201c \u03be.\nProof of Theorem 4.7. We first prove the existence of a metric x , yMDens with desired properties, and then show that it is induced by the Wasserstein metric. To prove existence, we use Proposition 2.14. To apply that proposition we need to show that MVectpMq \u201c Ker# \u2018 pKer#qK. Take any u P MVectpM,\u00b5q. Consider functions f \u201c pf1, ..., fnq satisfying Luj\u00b5j \u201c L\u2207fj\u00b5j (construction of such functions boils down to the solution of the Poisson equation div \u03c1j\u2207fj \u201c div \u03c1juj on fj). Then one has\nu \u201c pu \u00b4 \u2207f q ` \u2207f . (31)\nNotice that Luj\u00b4\u2207fj\u00b5j \u201c 0, so u\u00b4\u2207f P Ker#. Furthermore, Ker# consists of all multiphase vector fields u P MVectpM,\u00b5q which satisfy the divergence-free condition Luj\u00b5j \u201c 0 and hence are orthogonal to multiphase gradients with respect to the metric (25). In particular, we have \u2207f P pKer#qK. Thus we obtain a decomposition MVectpMq \u201c Ker# \u2018 pKer#qK, and hence, by Proposition 2.14, a metric x , yMDens with the listed properties.\nTo show that the metric x , yMDens is induced by the Wasserstein metric, observe from (31) that the map #\u00b41 : T\u00b5MDenspMq \u00d1 pKer#qK is given by #\u00b41p\u03beq \u201c \u2207f where the multiphase function f is found from the requirement \u03bej \u201c L\u2207fj\u00b5j . Plugging this into (12), we see that the metric x , yMDens computed on any \u03be P TMDenspMq is indeed the product Wasserstein metric, as needed.\nRecall that MDiffpM,\u00b5q is the configuration space of a multiphase fluid. The motion of the fluid follows the geodesics of the x , yL2-metric on the space MDiffpMq. Potential solutions thus correspond to horizontal (with respect to the target mapping) geodesics.\nRemark 4.9. The metric x , yMDens constructed above can also be defined as follows:\nx\u03be, \u03beyMDens \u201c inf txu,uyL2 | u P MVectpM,\u00b5q, #u \u201c \u03beu\nfor any \u03be P T\u00b5MDenspMq. This directly follows from its Riemannian submersion property.\nRemark 4.10. The Riemannian metric on MDenspMq makes the latter into a metric space with the distance between multiphase densities \u00b5 and \u00b5\u0303 satisfying the following inequality:\ndist2MDensp\u00b5, \u00b5\u0303q \u011b n \u00ff\nj\u201c1 dist2W p\u00b5j , \u00b5\u0303jq ,\nwhere distW is the Wasserstein distance on DenspMq. In particular, the distance function distMDens is non-degenerate (i.e. distMDensp\u00b5, \u00b5\u0303q \u0105 0 whenever \u00b5 \u2030 \u00b5\u0303)."
        },
        {
            "heading": "5 Groupoid of generalized flows",
            "text": "The above consideration can be extended to the case of \u201ccontinuous\u201d index i, i.e. to multiphase flows where phases are enumerated by a continuous parameter a which belongs to a measure space A. Below we adapt all the above definitions and statements to that setting, while the proofs are valid mutatis mutandis.\nConsider a closed compact manifold M with a fixed volume form volM and a measure space A with a fixed function ca : A \u00d1 R. The base of the Lie groupoid GDiffpMq of volumepreserving generalized diffeomorphisms is the space GDenspMq of generalized densities, i.e. sets of densities \u00b5 :\u201c t\u00b5a P DenspMq | a P Au satisfying the conditions: all \u00b5a are positive, have prescribed masses ca, i.e. \u015f\nM \u00b5a \u201c ca, and they together constitute the volume form volM , i.e.\n\u017c\nA \u00b5a da \u201c volM (32)\nat each point of M . (Here and in what follows we assume that the dependence of all objects on a P A is such that the integrals below are well-defined. A particular example of such a setting is described in Remark 5.1.) Now one can think of those densities as a set A of different fractions of an incompressible fluid, penetrating through each other without resistance.\nThe elements of GDiffpMq are sets of diffeomorphisms \u03d5 :\u201c t\u03d5a P DiffpMq | a P Au of M preserving the above property of incompressibility of generalized densities, i.e. the set of tuples p\u03d5 ;\u00b5,\u00b51q :\u201c tp\u03d5a;\u00b5a, \u00b51aq | a P Au with generalized forms \u00b5,\u00b51 P GDenspMq such that \u03d5\u02da\u00b5 \u201c \u00b51 component-wisely, i.e. \u03d5a\u02da\u00b5a \u201c \u00b51a for each a P A. The source, target and multiplication (i.e. composition) of such triples is given exactly as before.\nSimilarly, the space of velocities for a generalized fluid, i.e. the Lie algebroid GVectpMq \u00d1 GDenspMq corresponding to the Lie groupoid GDiffpMq, is a vector bundle with the following structure. Its fiber of GVectpMq over \u00b5 P GDenspMq is the space GVectpM,\u00b5q that consists of generalized vector fields on M of the form u :\u201c tua | a P Au with ua P VectpMq that are \u201cdivergence-free\u201d with respect to the generalized volume form: \u015f\nA Lua\u00b5a da \u201c 0. The corresponding anchor map #: GVectpM,\u00b5q \u00d1 T\u00b5GDenspMq is given by the negative Lie derivative, u \u00de\u00d1 \u00b4Lu\u00b5 :\u201c t\u00b4Lua\u00b5a | a P Au , and the algebroid bracket is given by the same formula (14). The tangent space T\u00b5GDenspMq is the space of generalized forms \u03be satisfying the two conditions: \u015f\nA \u03bea da \u201c 0 on M and \u015f M \u03bea \u201c 0 for all a P A (cf. Lemma 3.8).\nRemark 5.1. In the case when A is a manifold and the dependence of all objects on a P A is smooth, the above setting can also be reformulated as follows. Consider compact manifolds M and A with fixed volume forms volM and volA respectively. The base of the Lie groupoid GDiffpMq is the space GDenspMq of doubly stochastic measures on M \u02c6 A with everywhere positive smooth density, i.e. volume forms \u00b5 P DenspM \u02c6 Aq such that p\u03c0M q\u02da\u00b5 \u201c volM and p\u03c0Aq\u02da\u00b5 \u201c volA, where \u03c0M and \u03c0A are projections to M and A respectively. The above description of GDenspMq is then recovered by viewing a doubly stochastic measure \u00b5 as a collection of measures \u00b5a parametrized by a P A which have fixed volumes (defined by the measure volA) and add up to the measure volM .\nThe elements of the groupoid GDiffpMq in this language are horizontal diffeomorphisms \u03d5 P DiffpM \u02c6 Aq which take one doubly stochastic measure to another. More precisely, GDiffpMq is the set of triples p\u03d5 ;\u00b5,\u00b51q where \u03d5 P DiffpM\u02c6Aq is of the form px, aq \u00de\u00d1 p\u03d5apxq, aq and maps \u00b5 P GDenspMq to \u00b51 P GDenspMq, i.e. \u03d5\u02da\u00b5 \u201c \u00b51.\nThe Lie algebroid GVectpMq \u00d1 GDenspMq corresponding to the Lie groupoid GDiffpMq is a vector bundle with the following structure. Its fiber of GVectpMq over \u00b5 P GDenspMq is the space GVectpM,\u00b5q that consists of vector fields u P VectpM\u02c6Aq which are horizontal (i.e. tangent to fibers of the projection \u03c0A) and \u201cdivergence-free\u201d in the sense that p\u03c0M q\u02daLu\u00b5 \u201c 0 .\nThe anchor map #: GVectpM,\u00b5q \u00d1 T\u00b5GDenspMq in the algebroid GVectpMq is given by the negative Lie derivative, u \u00de\u00d1 \u00b4Lu\u00b5 , and the algebroid bracket is given by the same formula (14). The tangent space T\u00b5GDenspMq is the space of top-degree forms \u03be on M \u02c6 A such that p\u03c0M q\u02da\u03be \u201c 0 and p\u03c0Aq\u02da\u03be \u201c 0.\nReturning to the general case of a measure space A, the smooth dual GVectpM,\u00b5q\u02da of the space GVectpM,\u00b5q is defined as the quotient\nGVectpM,\u00b5q\u02da :\u201c \u21261pMqA{\u03b4pdC8pMqq ,\nwhere \u21261pMqA stands for functions A \u00d1 \u21261pMq. The elements of GVectpM,\u00b5q\u02da are cosets\nr\u03b1s :\u201c t\u03b1a ` df | f P C8pMqu,\nwhere all 1-forms \u03b1a P \u21261pMq in one coset differ by the same function differential. The pairing between a coset r\u03b1s P GVectpM,\u00b5q\u02da and a generalized vector field u P GVectpM,\u00b5q is given by the formula:\nxr\u03b1s,uy :\u201c \u017c\nA\n\u017c\nM \u03b1apuaq\u00b5a da.\nAs before, the dual algebroid is the total space\nGVectpMq\u02da :\u201c \u010f \u00b5PGDenspMq GVectpM,\u00b5q\u02da ,\nwhich is a trivial vector bundle over the space of generalized densities GDenspMq. The dual algebroid is a Poisson bundle, and the Poisson bracket on this space is given by a formula analogous to (19). As a corollary, we obtain the Hamiltonian operator\nP7r\u03b1s,\u00b5 : T \u02da r\u03b1s,\u00b5GVectpMq \u02da \u00d1 Tr\u03b1s,\u00b5GVectpMq\u02da\ncorresponding to the Poisson bracket on GVectpMq\u02da given by the same formula (24):\npu, rf sq \u00de\u00d1 p\u00b4riud\u03b1s \u00b4 rdf s,\u00b4Lu\u00b5q .\nTo describe geodesics on the space of generalized solutions we equip the manifold M with a Riemannian metric p , q whose Riemannian volume form is volM . As before, to simplify the exposition, M is a compact connected oriented manifold without boundary, although the results extend to noncompact M by imposing appropriate decay assumptions.\nThe x , yL2 metric on the Lie algebroid GVectpMq is as follows: for u,v P GVectpM,\u00b5q, one has\nxu,vyL2 :\u201c \u017c\nA\n\u017c\nM pua, vaq\u00b5a da. (33)\nThe inertia operator I : GVectpMq \u00d1 GVectpMq\u02da associated with this L2-metric on GVectpMq is as follows. For u P GVectpM,\u00b5q one has Ipuq \u201c ru5s, where u5 :\u201c tu5a | a P Au. Here u5a is the 1-form metric-dual to the vector field ua on M , and ru5s stands for the coset of u5 in \u21261pMqA { \u03b4pdC8pMqq.\nThe corresponding Euler-Arnold Hamiltonian on GVectpMq\u02da is\nH pr\u03b1s,\u00b5q :\u201c 1 2\n\u017c\nA\n\u017c\nM p\u03b1a, \u03b1aq\u00b5a da,\nwhere \u03b1 P r\u03b1s is a representative satisfying the following co-closedness type condition:\nd\u02da \u017c\nA \u03c1a\u03b1a da \u201c 0 , (34)\nfor \u03c1a :\u201c \u00b5a{volM (this is just the condition (3) written in terms of the multiform \u03b1 \u201c u5). With this adjustment of notations the following theorem literally repeats Theorem 4.2 and provides the Hamiltonian framework for generalized flows:\nTheorem 5.2. The Euler-Arnold equation for generalized flows corresponding to the L2metric on GVectpMq written in terms of a coset r\u03b1s P GVectpM,\u00b5q\u02da reads\n#\nBtr\u03b1s ` riud\u03b1 ` 12diu\u03b1s \u201c 0 , Bt\u00b5 \u201c \u00b4Lu\u00b5 ,\nwhere \u03b1 P r\u03b1s is the representative satisfying (34), and u :\u201c \u03b17 P GVectpM,\u00b5q. It is a Hamiltonian equation on the algebroid dual GVectpMq\u02da with respect to the natural Poisson structure described above and the energy Hamiltonian function H.\nLet us rewrite explicitly the Euler-Arnold equations in terms of fluid velocities of generalized flows.\nTheorem 5.3. The Euler-Arnold equations corresponding to the L2-metric on GVectpMq written in terms of the fluid velocities u and density \u03c1a \u201c \u00b5a{volM coincide with generalized flow equations (1.13) - (1.15) of [6]:\n\" Btp\u03c1auaq ` div p\u03c1aua b uaq ` \u03c1a\u2207p \u201c 0, (35a) Bt\u03c1a ` div p\u03c1auaq \u201c 0, (35b)\nsubject to the constraint \u015f A \u03c1a da \u201c 1, where the pressure p P C 8pMq is common for all phases and is defined uniquely up to an additive constant by these equations. Equivalently, the generalized flow equations (35a)-(35b) describe the velocity along a geodesic for the L2 metric on a source fiber of the groupoid GDiffpMq.\nProof. The constraint \u015f A \u03c1a da \u201c 1 follows from (32) and the definition \u03c1a \u201c \u00b5a{volM of the density function. Using Theorem 5.2 and the same argument as in the proof of Theorem 4.4, one gets the equations\n\" Btua ` \u2207uaua \u201c \u00b4\u2207p, (36a) Bt\u00b5a \u201c \u00b4Lua\u00b5a. (36b)\nClearly, (36b) is equivalent to (35b), so it only remains to derive (35a). Using (35b) and (36a), we obtain\nBtp\u03c1auaq \u201c pBt\u03c1aqua ` \u03c1apBtuaq \u201c \u00b4div p\u03c1auaqua \u00b4 \u03c1ap\u2207uaua ` \u2207pq \u201c \u00b4pdiv p\u03c1auaqua ` \u2207\u03c1auauaq \u00b4 \u03c1a\u2207p \u201c \u00b4div p\u03c1aua b uaq \u00b4 \u03c1a\u2207p ,\nwhere the last equality follows from the identity div pub vq \u201c div puqv ` \u2207uv. Thus, (35a) is equivalent to (36a), as required.\nRemark 5.4. The quantity m :\u201c \u03c1u5 \u201c t\u03c1au5a | a P Au has the physical meaning of the momentum. In terms of momentum the metric (33) assumes a simpler form xu,vyL2 \u201c \u015f\nA\n\u015f\nM mapvaq volM da and the equations (35a)-(35b) are often written on ma, cf. [6]."
        },
        {
            "heading": "6 Open problems",
            "text": "Arnold\u2019s original insight in [1] uncovered the geometry behind the hydrodynamic Euler equation: for an ideal fluid confined to a fixed domain the Euler equation describes the geodesic flow for the energy metric on the Lie group of volume-preserving diffeomorphisms of that domain. The analytical part of this approach is due to Ebin and Marsden [11] who proved short-time existence in the setting of Sobolev spaces Hs, where s is sufficiently large (s \u0105 dimM{2 ` 1).\nThe present paper can be regarded as an analog of Arnold\u2019s take by providing the geometric framework of Lie groupoids, instead of Lie groups, for the Euler equation for multiphase fluids and generalized flows. We hope that it will encourage the appearance of necessary analytical setting, in the form of existence theorems in appropriate Sobolev or tame Fre\u0301chet spaces.\nHere we summarize several open problems motivated by the groupoid approach:\n\u2013 Provide an analytic framework and existence theorems for the Euler equation for multiphase fluids and generalized flows, extending the Ebin\u2013Marsden setting [11] from groups to groupoids of diffeomorphisms.\n\u2013 There are (at least) two different definitions of generalized flows, both suggested by Y. Brenier: the one discussed above, as a continuum version of multiphase flows [5, 6], and the other via probabilistic measures on the space of all parametrized continuous paths X \u201c Cpr0, 1s;Mq satisfying the incompressibility and finiteness of action conditions [4], see also [2, 18]. Their equivalence is intuitively assumed but, to the best of our knowledge, not written up. Once it is formally established, it would open new ways of applying groupoids in probabilistic settings.\n\u2013 There is a natural semigroup of continuous maps, in which fluid particles are allowed to collide and stick to each other. In that setting compositions of maps are well-defined but inversion is not, cf. [6], which seems to be an appropriate framework for the description of shock waves in fluids. While there seem to be a projection from the diffeomorphism groupoid to the semigroup of maps, the corresponding Hamiltonian picture for the semigroup is rather obscure.\n\u2013 In the appendix below we give a groupoid description of vortex sheets [12], which can be thought of as the limiting case for the relaxed problem of evolution of homogenized vortex sheets or miltiphase flows, see [5, 14]. It would be interesting to obtain a rigorous treatment of this limiting procedure in the Lagrangian and Hamiltonian setting.\n\u2013 Finally, it would be interesting to apply the framework of Euler-Arnold equations on Lie groupoids, along with the corresponding Hamiltonian framework on Lie algebroid duals, to other problems in mathematical physics, both in finite and infinite dimensions. This approach seems natural in the situations where the group symmetry is not available, e.g. fluids with dynamic boundary, a rigid body moving in a manifold, etc."
        },
        {
            "heading": "7 Appendix: Dynamics of classical vortex sheets",
            "text": "Classical vortex sheets can be thought of as a particular case (or, rather, as belonging to a closure) of multiphase fluids where the densities are indicator functions of open sets separated by a hypersurface in a manifold M , see [12, 14]. Namely, the multiphase Lie groupoid in that case becomes the Lie groupoid DSDiffpMq of volume-preserving diffeomorphisms ofM that are discontinuous along a hypersurface. The elements of the groupoid DSDiffpMq are quadruples p\u03931,\u03932, \u03d5`, \u03d5\u00b4q, where \u03931,\u03932 P VSpMq are hypersurfaces (vortex sheets) in M confining the same total volume, while \u03d5\u02d8 : D\u02d8\u03931 \u00d1 D \u02d8 \u03932 are volume-preserving diffeomorphisms between connected components of M z \u0393i denoted by D`\u0393i , D \u00b4 \u0393i\n. The multiplication of the quadruples in DSDiffpMq is given by the natural composition of discontinuous diffeomorphisms and is shown in Figure 4.\nThe corresponding Lie algebroid DSVectpMq \u00d1 VSpMq is the space of possible velocities of a fluid with a vortex sheet, defined as follows. Given a vortex sheet \u0393, the corresponding velocities are discontinuous vector fields on M of the form u \u201c \u03c7`\u0393u``\u03c7 \u00b4 \u0393u ,\u0301 where \u03c7 ` \u0393 , \u03c7 \u00b4 \u0393 are indicator functions of the connected components D\u02d8\u0393 of M z \u0393, and u\u02d8 are smooth divergencefree vector fields on D\u02d8\u0393 which have the same normal component on \u0393. The map from such vector fields u to their normal components on \u0393 is the anchor map # of the corresponding algebroid. Via the general procedure described above one defines a right-invariant L2-metric on this groupoid and constructs an analogue of the geodesic Euler-Arnold equation.\nTheorem 7.1 ([12]). The Euler-Arnold equation corresponding to the L2-metric on the algebroid DSVectpMq coincides with the the Euler equation for a fluid flow discontinuous along a vortex sheet \u0393 \u0102 M :\n$\n\u2019 &\n\u2019 %\nBtu` ` \u2207u`u` \u201c \u00b4\u2207p ,\u0300 Btu\u00b4 ` \u2207u\u00b4u\u00b4 \u201c \u00b4\u2207p ,\u0301\nBt\u0393 \u201c #u , (37)\nwhere u \u201c \u03c7`\u0393u` ` \u03c7 \u00b4 \u0393u \u00b4 is the fluid velocity, div u\u02d8 \u201c 0, and p\u02d8 P C8pD\u02d8\u0393 q are functions satisfying the continuity condition p`|\u0393 \u201c p\u00b4|\u0393.\nEquivalently, Euler equations (37) are geodesic equations for the right-invariant L2-metric on (source fibers of) the Lie groupoid DSDiffpMq of discontinuous volume-preserving diffeomorphisms.\nThe above consideration also defines a metric on the space VSpMq of vortex sheets, while the target map is a Riemannian submersion of the L2-metric on the groupoid of discontinuous diffeomorphisms to the metric on VSpMq, see [12, 14].\nRemark 7.2. The multiphase groupoid studied in Section 3.1 can be regarded as a relaxed version of the vortex sheet groupoid as follows. Given a hypersurface \u0393 \u0102 M we define the multiphase density \u00b5 :\u201c p\u00b5`, \u00b5\u00b4q as a pair of indicator densities \u00b5\u02d8 \u201c \u03c7\u02d8volM for indicator functions \u03c7\u02d8 of the connected components D \u02d8 \u0393 of M z \u0393, and therefore satisfying the condition \u00b5` ` \u00b5\u00b4 \u201c volM on M . Now, for a groupoid element p\u03d5 ;\u00b5,\u00b51q :\u201c p\u03d5`, \u03d5\u00b4;\u00b5`, \u00b5\u00b4, \u00b51`, \u00b51\u00b4q the pair of diffeomorphisms \u03d5\u02d8 on M satisfying \u03d5\u02d8\u02da\u00b5\u02d8 \u201c \u00b51\u02d8 for indicator densities \u00b51\u02d8 representing the connected components D\u02d8\u03931 of M z \u0393\n1 boils down to a pair of volM -preserving diffeomorphisms sending, respectively, D\u02d8\u0393 to D \u02d8 \u03931 , i.e. \u0393 to \u0393\n1 while preserving the volume form volM on M .\nOne can see that the definitions of the corresponding algebroids, their brackets and anchor maps, as well as the corresponding Poisson structures and Hamiltonian equations are consistent with taking this relaxed version and lead to the relation between the Euler equations (6) and (37). It would be interesting to formally establish the convergence for the relaxed solutions to the classical solutions with vortex sheets, cf. Section 6."
        }
    ],
    "title": "Geometry of generalized fluid flows",
    "year": 2023
}