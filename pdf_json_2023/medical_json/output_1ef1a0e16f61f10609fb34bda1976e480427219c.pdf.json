{
    "abstractText": "The growing number of available single-cell gene expression datasets from different species creates opportunities to explore evolutionary relationships between cell types across species. Cross-species integration of single-cell RNAsequencing data has been particularly informative in this context. However, in order to do so robustly it is essential to have rigorous benchmarking and appropriate guidelines to ensure that integration results truly reflect biology. Here, we benchmark 28 combinations of gene homology mapping methods and data integration algorithms in a variety of biological settings. We examine the capability of each strategy to perform species-mixing of known homologous cell types and to preserve biological heterogeneity using 9 established metrics. We also develop a new biology conservation metric to address the maintenance of cell type distinguishability. Overall, scANVI, scVI and SeuratV4 methods achieve a balance between species-mixing and biology conservation. For evolutionarily distant species, including in-paralogs is beneficial. SAMap outperforms when integrating whole-body atlases between species with challenging gene homology annotation. We provide our freely available crossspecies integration and assessment pipeline to help analyse new data and develop new algorithms.",
    "authors": [
        {
            "affiliations": [],
            "name": "Yuyao Song"
        },
        {
            "affiliations": [],
            "name": "Zhichao Miao"
        },
        {
            "affiliations": [],
            "name": "Alvis Brazma"
        },
        {
            "affiliations": [],
            "name": "Irene Papatheodorou"
        }
    ],
    "id": "SP:9a6914e80c2e3a5b9b50ed93ecc70329cf40b7db",
    "references": [
        {
            "authors": [
                "Tabula Sapiens Consortium*. et al. The tabula sapiens"
            ],
            "title": "a multipleorgan, single-cell transcriptomic atlas of humans",
            "venue": "Science 376, eabl4896",
            "year": 2022
        },
        {
            "authors": [
                "Tabula Muris Consortium"
            ],
            "title": "Single-cell transcriptomics of 20 mouse organs creates a tabula muris",
            "venue": "Nature 562,",
            "year": 2018
        },
        {
            "authors": [
                "L Han"
            ],
            "title": "Cell transcriptomic atlas of the non-human primate macaca fascicularis",
            "venue": "Nature 604,",
            "year": 2022
        },
        {
            "authors": [
                "F Wang"
            ],
            "title": "Endothelial cell heterogeneity and microglia regulons revealed by a pig cell landscape at single-cell level",
            "venue": "Nat. Commun",
            "year": 2022
        },
        {
            "authors": [
                "M Jiang"
            ],
            "title": "Characterization of the zebrafish cell landscape at single-cell resolution",
            "venue": "Front. Cell Dev. Biol",
            "year": 2021
        },
        {
            "authors": [
                "Musser",
                "J. M"
            ],
            "title": "Profiling cellular diversity in sponges informs animal cell type and nervous system evolution",
            "venue": "Science 374,",
            "year": 2021
        },
        {
            "authors": [
                "H.M. Vergara"
            ],
            "title": "et al.Whole-body integration of gene expression and single-cell morphology",
            "venue": "Cell 184,",
            "year": 2021
        },
        {
            "authors": [
                "D Arendt"
            ],
            "title": "The origin and evolution of cell",
            "venue": "types. Nat. Rev. Genet",
            "year": 2016
        },
        {
            "authors": [
                "Tosches",
                "M. A"
            ],
            "title": "Evolution of pallium, hippocampus, and cortical cell types revealed by single-cell transcriptomics in reptiles",
            "venue": "Science 360,",
            "year": 2018
        },
        {
            "authors": [
                "J Woych"
            ],
            "title": "Cell-type profiling in salamanders identifies innovations in vertebrate forebrain evolution",
            "venue": "Science 377,",
            "year": 2022
        },
        {
            "authors": [
                "M.E.R. Shafer",
                "A.N. Sawh",
                "A.F. Schier"
            ],
            "title": "Gene family evolution underlies cell-type diversification in the hypothalamus of teleosts",
            "venue": "Nat. Ecol. Evol",
            "year": 2021
        },
        {
            "authors": [
                "Bakken",
                "T. E"
            ],
            "title": "Comparative cellular analysis of motor cortex in human, marmoset and mouse",
            "venue": "Nature 598,",
            "year": 2021
        },
        {
            "authors": [
                "H Li"
            ],
            "title": "Cross-species single-cell transcriptomic analysis reveals divergence of cell composition and functions in mammalian ileum epithelium",
            "venue": "Cell Regen. 11,",
            "year": 2022
        },
        {
            "authors": [
                "J Xu"
            ],
            "title": "Transcriptional and functional motifs defining renal function revealed by single-nucleus RNA sequencing",
            "venue": "Proc. Natl Acad. Sci. USA. 119,",
            "year": 2022
        },
        {
            "authors": [
                "C. Liang",
                "J.M. Musser",
                "A. Cloutier",
                "R.O. Prum",
                "G.P. Wagner"
            ],
            "title": "Pervasive correlated evolution in gene expression shapes cell and tissue type transcriptomes",
            "venue": "Genome Biol. Evol",
            "year": 2018
        },
        {
            "authors": [
                "M.E.R. Shafer"
            ],
            "title": "Cross-species analysis of single-cell transcriptomic data",
            "venue": "Front. Cell Dev. Biol",
            "year": 2019
        },
        {
            "authors": [
                "Luecken",
                "M. D"
            ],
            "title": "Benchmarking atlas-level data integration in single-cell genomics",
            "venue": "Nat. Methods https://doi.org/10.1038/",
            "year": 2021
        },
        {
            "authors": [
                "L Heumos"
            ],
            "title": "Best practices for single-cell analysis across modalities",
            "venue": "Nat. Rev. Genet",
            "year": 2023
        },
        {
            "authors": [
                "Tarashansky",
                "A. J"
            ],
            "title": "Mapping single-cell atlases throughout Metazoa unravels cell type evolution",
            "venue": "eLife 10,",
            "year": 2021
        },
        {
            "authors": [
                "L. Haghverdi",
                "A.T.L. Lun",
                "M.D. Morgan",
                "J.C. Marioni"
            ],
            "title": "Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors",
            "venue": "Nat. Biotechnol",
            "year": 2018
        },
        {
            "authors": [
                "I Korsunsky"
            ],
            "title": "Fast, sensitive and accurate integration of singlecell data with Harmony",
            "venue": "Nat. Methods 16,",
            "year": 2019
        },
        {
            "authors": [
                "J Liu"
            ],
            "title": "Jointly defining cell types from multiple single-cell datasets using LIGER",
            "venue": "Nat. Protoc",
            "year": 2020
        },
        {
            "authors": [
                "A.R. Kriebel",
                "J.D. Welch"
            ],
            "title": "UINMF performs mosaic integration of single-cell multi-omic datasets using nonnegative matrix factorization",
            "venue": "Nat. Commun",
            "year": 2022
        },
        {
            "authors": [
                "B. Hie",
                "B. Bryson",
                "B. Berger"
            ],
            "title": "Efficient integration of heterogeneous single-cell transcriptomes using Scanorama",
            "venue": "Nat. Biotechnol",
            "year": 2019
        },
        {
            "authors": [
                "R. Lopez",
                "J. Regier",
                "M.B. Cole",
                "M.I. Jordan",
                "N. Yosef"
            ],
            "title": "Deep generative modeling for single-cell transcriptomics",
            "venue": "Nat. Methods 15,",
            "year": 2018
        },
        {
            "authors": [
                "C Xu"
            ],
            "title": "Probabilistic harmonization and annotation of singlecell transcriptomics data with deep generative models",
            "venue": "Mol. Syst. Biol. 17,",
            "year": 2021
        },
        {
            "authors": [
                "A. Butler",
                "P. Hoffman",
                "P. Smibert",
                "E. Papalexi",
                "R. Satija"
            ],
            "title": "Integrating single-cell transcriptomic data across different conditions, technologies, and species",
            "venue": "Nat. Biotechnol",
            "year": 2018
        },
        {
            "authors": [
                "T Stuart"
            ],
            "title": "Comprehensive integration of single-.Cell Data",
            "venue": "Cell 177,",
            "year": 2019
        },
        {
            "authors": [
                "Y Hao"
            ],
            "title": "Integrated analysis ofmultimodal single-cell data.Cell",
            "year": 2021
        },
        {
            "authors": [
                "A. Tanay",
                "A. Seb\u00e9-Pedr\u00f3s"
            ],
            "title": "Evolutionary cell type mapping with single-cell genomics",
            "venue": "Trends Genet",
            "year": 2021
        },
        {
            "authors": [
                "F Cunningham"
            ],
            "title": "Ensembl 2022",
            "venue": "Nucleic Acids Res. 50,",
            "year": 2022
        },
        {
            "authors": [
                "Z Miao"
            ],
            "title": "Putative cell type discovery from single-cell gene expression data",
            "venue": "Nat. Methods 17,",
            "year": 2020
        },
        {
            "authors": [
                "D Franjic"
            ],
            "title": "Transcriptomic taxonomy and neurogenic trajectories of adult human, macaque, and pig hippocampal and entorhinal cells",
            "venue": "Neuron. https://doi.org/10.1016/j.neuron.2021.10",
            "year": 2021
        },
        {
            "authors": [
                "Wagner",
                "D. E"
            ],
            "title": "Single-cell mapping of gene expression landscapes and lineage in the zebrafish embryo",
            "venue": "Science 360,",
            "year": 2018
        },
        {
            "authors": [
                "Briggs",
                "A. J"
            ],
            "title": "The dynamics of gene expression in vertebrate embryogenesis at single-cell resolution",
            "venue": "Science 360,",
            "year": 2018
        },
        {
            "authors": [
                "McLellan",
                "M. A"
            ],
            "title": "High-resolution transcriptomic profiling of the heart during chronic stress reveals cellular drivers of cardiac fibrosis and hypertrophy",
            "venue": "Circ. 142,",
            "year": 2020
        },
        {
            "authors": [
                "D Osumi-Sutherland"
            ],
            "title": "Cell type ontologies of the human cell atlas",
            "venue": "Nat. Cell Biol",
            "year": 2021
        },
        {
            "authors": [
                "Moreno",
                "P. et al. Expression atlas update"
            ],
            "title": "gene and protein expression in multiple species",
            "venue": "Nucleic Acids Res. 50, D129\u2013D140",
            "year": 2022
        },
        {
            "authors": [
                "H. Zeng"
            ],
            "title": "What is a cell type and how to define it",
            "venue": "Cell 185,",
            "year": 2022
        },
        {
            "authors": [
                "K Shekhar"
            ],
            "title": "Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics",
            "venue": "Cell 166,",
            "year": 2016
        },
        {
            "authors": [
                "M. Stamboulian",
                "R.F. Guerrero",
                "M.W. Hahn",
                "Radivojac",
                "P. The ortholog conjecture revisited"
            ],
            "title": "The value of orthologs and paralogs in function prediction",
            "venue": "Bioinformatics 36, i219\u2013i226",
            "year": 2020
        },
        {
            "authors": [
                "R.A. Studer",
                "M. Robinson-Rechavi"
            ],
            "title": "How confident can we be that orthologs are similar, but paralogs differ",
            "venue": "Trends Genet",
            "year": 2009
        },
        {
            "authors": [
                "G.M. Kurtzer",
                "V. Sochat",
                "Bauer",
                "M.W. Singularity"
            ],
            "title": "scientific containers for mobility of compute",
            "venue": "PLoS One 12, e0177459",
            "year": 2017
        },
        {
            "authors": [
                "M Baron"
            ],
            "title": "A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure",
            "venue": "Cell Syst. 3,",
            "year": 2016
        },
        {
            "authors": [
                "Y Liao"
            ],
            "title": "Cell landscape of larval and adult Xenopus laevis at single-cell resolution",
            "venue": "Nat. Commun",
            "year": 2022
        }
    ],
    "sections": [
        {
            "heading": "Benchmarking strategies for cross-species",
            "text": "integration of single-cell RNA sequencing data\nYuyao Song 1 , Zhichao Miao 1,2, Alvis Brazma 1 & Irene Papatheodorou 1\nThe growing number of available single-cell gene expression datasets from different species creates opportunities to explore evolutionary relationships between cell types across species. Cross-species integration of single-cell RNAsequencing data has been particularly informative in this context. However, in order to do so robustly it is essential to have rigorous benchmarking and appropriate guidelines to ensure that integration results truly reflect biology. Here, we benchmark 28 combinations of gene homology mapping methods and data integration algorithms in a variety of biological settings. We examine the capability of each strategy to perform species-mixing of known homologous cell types and to preserve biological heterogeneity using 9 established metrics. We also develop a new biology conservation metric to address the maintenance of cell type distinguishability. Overall, scANVI, scVI and SeuratV4 methods achieve a balance between species-mixing and biology conservation. For evolutionarily distant species, including in-paralogs is beneficial. SAMap outperforms when integrating whole-body atlases between species with challenging gene homology annotation. We provide our freely available crossspecies integration and assessment pipeline to help analyse new data and develop new algorithms.\nAnimal cells show conspicuous diversity and have fundamental unities across species. Recently, single-cell RNA-sequencing (scRNA-seq) and single-nucleus RNA-sequencing (snRNA-seq) have been applied in a diversity of species, generating full-body cell atlases from transcriptome profiles of millions of individual cells1\u20137. Comparing cellular expression profiles cross-species provides insights into the origin and evolution of organs and cell types6,8\u201310, highlights species-specific expression patterns11,12, as well as further delineates how cell types execute their functions in health and disease13,14.\nDue to millions of years of evolution, the gene expression profiles of evolutionarily related cell types from different species exhibit significant global transcriptional shifts11,15,16. To compare these profiles, a cross-species mapping of genes via sequence homology is necessary to place cells into the same expression space. However, when performing a joint analysis of scRNA-seq data on the raw count data, a \u201cbatch effect\u201d emerges between species. Cells from the same species tend to exhibit higher transcriptomic similarity among themselves rather than with their cross-species counterparts16,17. We term this \u201cspecies effect\u201d, to distinguish from pure technical batch effects between same-species samples18. By correcting for the species effect during joint analysis of scRNA-seq data, we can find a latent representation of cells from different species on which they form clusters based on transcriptomic identity. Integrating scRNA-seq data cross-species can therefore identify cells that are transcriptomically similar between species, informing the degree of cell type expression conservation and divergence, as well as generating hypotheses about evolutionary cell type homology10,19.\nReceived: 11 November 2022\nAccepted: 21 September 2023\nCheck for updates\n1European Molecular Biology Laboratory-European Bioinformatics Institute (EMBL-EBI), Wellcome Genome Campus, Hinxton CB10 1SA, United Kingdom. 2Guangzhou Laboratory, Guangzhou International Bio Island, Guangzhou 510005, China. e-mail: ysong@ebi.ac.uk; irenep@ebi.ac.uk\nNature Communications | (2023) 14:6495 1\n12 34\n56 78\n9 0 () :,;\n12 34\n56 78\n9 0 () :,;\nVarious data integration algorithms originally designed for batch correction or cross-condition integration in scRNA-seq have been rapidly adapted to cross-species analysis16. A recent benchmark of batch correction methods17 highlighted top-performing algorithms including: mutual nearest neighbours based fastMNN20; iterative clustering based Harmony21; LIGER which utilises integrative nonnegative matrix factorization (iNMF)22 and its recent upgrade LIGER UINMF that also takes unshared features23; a panorama-stitching algorithm Scanorama24; a probabilistic model with distributions specifiedbydeepneural networks scVI25 and its semi-supervised extension scANVI26; as well as SeuratV4 methods, which uses canonical correlation analysis (CCA) or reciprocal principal component analysis (RPCA) to identify anchors between datasets then uses dynamic time warping to align the subspaces27\u201329.\nAlthough a diversity of batch-correction algorithms is available, it is still very challenging to generate an informative cross-species joint embedding16,17,19. On one hand, species effects can be much stronger than average technical batch effects, so moderate methods frequently fail to integrate the data17,19. On the other hand, speciesspecific populations may become obscure if the algorithm overfits16. Importantly, mapping genes from different species by gene homology can cause significant information loss since homology annotation can be challenging for species without a well-annotated genome or between evolutionally distant species30. The method SAMap tackles this issue by reciprocally and iteratively updating a gene-gene mapping graph from de-novo basic local alignment search tool (BLAST) analysis and a cell-cell mapping graph to stitch atlases between species19. SAMap can lay much stronger mapping of homologous cell types across distant species and is capable of discovering gene paralog substitution events. However, SAMap is computationally intensive and designed for whole-body alignment, while methods optimised for large-scale integration may be more scalable to multiple datasets and more species.\nIt is unclear which strategy for cross-species integration yields the most informative results and how the selection of homologous genes and integration algorithms affect the observable relationships between cells. This is because strategies have not been tested head-tohead across a variety of organs, species and biological systems. Furthermore, the number of species involved in the integration and the time that species have diverged can impact the output characteristics differently among strategies.\nIn this work, we develop the BENchmarking strateGies for crossspecies integrAtion of singLe-cell RNA sequencing data (BENGAL) pipeline. We run BENGAL to examine 28 cross-species integration strategies, covering 4 ways of mapping genes by homology and 10 integration algorithms in 16 tasks. Our analysis focuses on cell types that exhibit a clear one-to-one correspondence across somevertebrate species. Through this, we identify strategies that produce reliable embeddings in this fundamental scenario in various biological contexts.We reason that onlywhen established homologous cell types are well-integrated, the output from the respective approach can then be further explored through subsequent analysis, such as a deeper clustering to identify cell states at a higher granularity or to decipher complex cell type taxonomy. To quantitatively analyse integration results, we use established batch correction metrics and biology conservation metrics to analyse the integration of homologous cell types between species, and the loss of biological heterogeneity, respectively. To address overcorrection, we develop a new biology conservation metric to address loss of cell type distinguishability due to integration. We further perform cross-annotation of cell types using the integrated data to determine if the integration enables cell type annotation transfer. Finally, by observing the behaviour of different integration strategies in tasks with certain examination points, we provide guidelines for appropriate strategy selection aligned to cross-species integration goals."
        },
        {
            "heading": "Results",
            "text": "Integration of cross-species scRNA-seq data The BENGAL pipeline performs cross-species integration and assessment of integration results using 28 strategies, as illustrated in Fig. 1. Quality control (QC) and curation of cell ontology annotations of input data are required prior to running the pipeline and should be performed in an input-specific manner. (see Methods for details and recommended practices). During integration, the pipeline first translates orthologous genes between species using ENSEMBL multiple species comparison tool31 and concatenates raw count matrices from different species. We compared three approaches for cross-species gene homology mapping: mapping using only one-to-one orthologs; mappings including one-to-many or many-to-many orthologs by selecting those with a high average expression level, or with a strong homology confidence (seeMethods). Notably, LIGERUINMFalso takes unshared features, therefore genes without annotated homology are added on top of the mapped genes. We fed the concatenated raw count matrix to 9 integration algorithms, some of which were topperformers from previous benchmarking of data integration17, including fastMNN, Harmony, LIGER, LIGER UINMF, Scanorama, scVI, scANVI, SeuratV4CCA and SeuratV4RPCA. SAMap requires de-novo reciprocal BLAST to construct a gene-gene homology graph and we therefore followed the standalone workflow."
        },
        {
            "heading": "Output assessment",
            "text": "Integration outputs were assessed from three main aspects, species mixing, biology conservation and annotation transfer. We computed and compared 4 batch correction metrics and 5 biology conservation metrics for species mixing and biology conservation, respectively (Fig. 1, see Methods for metrics selection and applicability, see Supplementary Methods for metrics principle). We also calculated these metrics in 3 types of homology concatenated, unintegrated data, to contextualise the raw scores.Metrics scores in integrated data from 27 strategies (excluding SAMap) and in unintegrated data were min-max scaled per task to equalise their discriminative power (seeMethods for scaling detail). The species mixing score is the average of applicable scaled batch correction metrics, while the biology conservation score is the average of applicable scaled biology conservation metrics. The integrated score is a weighted average of species mixing score and biology conservation score with a 40/60weighting17. It is worth noting that batch correctionmetrics are not applicable to SAMap outputs, so we did not include it in the scoring and ranking (see Supplementary Note 1 for reasons). Instead, we show Uniform Manifold Approximation and Projection (UMAP) for visual inspection and alignment score to quantify the percentage of cross-species neighbours (see Methods for alignment score calculation).\nImportantly, we developed a new metric, Accuracy Loss of Cell type Self-projection (ALCS), to target the most unwanted artefact of cross-species integration. ALCS quantifies the degree of blending between cell types per-species after integration, thus indicating the tendency of overcorrection of cross-species heterogeneity that may obscure species-specific cell types. We employed the self-projection concept inmachine learning implemented in our previous work Single Cell Clustering Assessment Framework (SCCAF)32 and used the test accuracy of self-projection to indicate how well cell type labels are distinguishable from each other on a given feature representation. The loss of self-projection accuracy after integration, compared with unintegrated per-species data, measures the loss of cell type distinguishability due to integration (see Methods for further details of ALCS). We report ALCS separately to highlight its importance in our cross-species integration setting.\nFor annotation transfer, amultinomial logistic classifier built upon the SCCAF frameworkwas trainedonone species andused to annotate cell types in another species based on the shared features in the integrated embedding. We assessed annotation transfer by calculating\nNature Communications | (2023) 14:6495 2\nAdjusted Rand Index (ARI) between the original and transferred annotation (see Methods for details).\nBenchmarking metrics of different integration strategies varied widely We ran the BENGAL pipeline for 16 cross-species integration tasks spanning a variety of biological scenarios to observe species mixing and biology conservation (see Table 1 for task design andMethods for tasks abbreviation). We explored performance of the different strategies in 3 different adult tissues, namely pancreas, hippocampus and heart, as well as in whole-body embryonic development. Using heart data from 5 species, we explored the upper limit of the number of species to include in one integration with 4 tasks. In addition, we performed pairwise integration to examine the impact of divergent time between species on integration output with 10 tasks.\nTo provide an overview of strategies\u2019 performance, we calculated themean and standard deviation of integrated scores for all strategies using the 7 reference tasks (excluding pairwise integration tasks as they overlap with the heart tasks, Table 1, Fig. 2a). Overall, major differences were given by integration algorithms but not homology methods. Strategies that achieved successful integrations stayed largely consistent across tasks, while the relative species mixing and biology conservation scores varied. In general, scANVI, scVI, SeuratV4 CCA, SeuratV4 RPCA, harmony and fastMNN performed well across the board. For each task, we analysed strategies\u2019 relative species mixing and biology conservation (Fig. 2b). scVI, harmony and SeuratV4 RPCA ranked top3 in terms of average species mixing across tasks, while for biology conservation, it was scANVI, SeuratV4 CCA and SeuratV4RPCA (Supplementary Data 1). Across all tasks, weobserved a trade-off between species mixing and biology conservation in most strategies (Fig. 2b, see Supplementary Figs. 1\u201316 for detailed metrics and scores of each task). SAMap yield strong cross-species alignment (see alignment score in Supplementary Fig. 17 and UMAP visualisation in Supplementary Figs. 27\u201342).\nBatch correction metrics\n1. Per-species data QC 3. Build concatenated input 4. Data integration\nfastMNN\nLIGER\nHarmony\nScanorama\nscANVI\nscVI\nSeuratV4 CCA SeuratV4 RPCA\nDoublet removal\nRemove high-MT cells\nOntology annotation\n2. Align cell type ontology annotation (optional)\n...\nscOntoMatch\nAligned cell type tree\nCell type annotation uncomparable cross species\nLIGER UINMF\nSAMap\nIntegrated data from 28 strategies\n5. Assessment of species mixing, biology conservation and annotation transfer after data integration\nSpecies\nCell type\n...\nGene groups\none2one orthologs\nin-paralogs\nspecies-\n(2) higher expression\n(3) stronger homology\nConcatenated raw count matrices\n(1) one2one only\n(4) all genes\n...\nAccuracy loss of cell type self-projection Annotation transfer between species\nFibroblast Cardiac muscle cell Smooth muscle cell Endothelial cell Macrophage\n#genes #RNA %MT\nSpecies mixingBiology conservation\nTest accuracy loss after integration\nPrincipal component regression\nscore\nBatch average silhouette width\nK-nearest neighbour\nbatch effect test\nGraph connectivity\n?\nAdjusted rand index\nTrain\nPredict\nPredicted cell type\nAnnotated cell type\nAnnotation transfer\nP re\nc is\nio n\nRecall\nPreprocessing BENGAL\nBiology conservation metrics\n1. Cell type average\nsilhouette width\n2. Normalized mutual\ninformation\n3. Adjusted rand index\n4. Isolated label F1\nscore\n5. Trajectory\nconservation score\nSelf-projection with multinomial logistic regression\nCell Ontology\nENSEMBL homology annotation\nFig. 1 | Schematic of the BENGAL pipeline. 1 Quality control of input data is performed prior to data integration. and is not part of BENGAL. Potential doublets and low-quality cells expressing highmitochondrial genes should be removed. Cell ontology annotations are collected from atlases or data portals or curated from the originally published annotation. 2 When the granularity of ontology annotation is incomparable across datasets, one-to-one homology between cell types needs to be robustly aligned.Wedeveloped scOntoMatch tofind the appropriate annotation granularity and align cell type hierarchies across given datasets (see Methods). 3 Genes are grouped and translated across species by homologydefined in ENSEMBL\nmultiple species comparison tool. Raw count matrices are then concatenated across species using four possible homology matching methods respective to method inputs. 4 Run 9 integration algorithms to generate integrated output. 5 Perform integration assessment from speciesmixing, biology conservation and cell type annotation transfer. BENGAL, BENchmarking strateGies for cross-species integrAtion of singLe-cell RNA sequencing data; QC, quality control; MT, mitochondrial; SCCAF, single cell clustering assessment framework; AUC, area under the curve; CV, cross-validation. Created with BioRender.com.\nNature Communications | (2023) 14:6495 3\nTa b le\n1 |O\nve rv ie w\no f th e re fe re n ce\nta sk\ns fo r b en\nch m ar ki n g st ra te g ie s fo r cr o ss -s p ec\nie s in te g ra ti o n o f sc\nR N A -s eq\nd at a\nTa sk\nna m e\nPa nc\nre as _h s_ m m\n4 5\nH ip p oc\nam p us\n_h s_ m u_ ss\n3 3\nEm b ry o_ xt _d r3\n4 ,3 5\nH ea\nrt _h s_ m f1,\n3 H ea\nrt _h s_ m f_ m m\n1, 3, 3 6\nH ea\nrt _h s_ m f_ m m _x l1,\n3, 3 6 ,4 6\nH ea\nrt _h s_ m f_ m m _x l_ d r1 ,3 ,5 ,3 6 ,4 6\nS p ec\nie s\nH om\no sa p ie ns\na , M us\nm us\ncu lu s\nH om\no sa p ie ns\n,M ac\nac a m ul at ta ,\nS us\nsc ro fa\nX en\nop us\ntr op\nic al is ,\nD an\nio re ri o\nH om\no sa p ie ns\n,M ac\nac a\nfa sc ic ul ar is\nH om\no sa p ie ns\n,M ac\nac a\nfa sc\nic ul ar is ,M us m us cu lu s\nH om\no sa p ie ns\n,M ac\nac a fa sc icu la ris ,M us m us cu lu s, X en op us la ev is\nH om\no sa p ie ns\n,M ac\nac a fa sc ic u-\nla ris\n,M us\nm us\ncu lu s,\nX en\nop us\nla e-\nvi s,\nD an\nio re rio\nTe ch\nno lo g y\nin D ro p\nsn R N A -s eq\nin D ro p s\nsc R N A -s eq\nw ith\n10 \u00d7\nG en\nom ic s 3\u2032\nV 3. 1\n(H .s ap\nie ns\n), sn\nR N A -s eq\nw ith\nD N B el ab\nC S er ie s\nS in g le -C\nel lL ib ra ry\nPr ep\nS et\n(M .fa\nsc ic ul ar is )\nsa m e w ith\n4 ,s\ncR N A -s eq\nw ith\n10 \u00d7 G en\nom ic s 3\u2019\nV 2\n(M .m\nus cu\nlu s)\nsa m e w ith\n5, m ic ro w el lse q (X .la ev is )\nsa m e w ith\n6 ,m\nic ro w el lse q (D .r er io )\nN um\nb er\nof ce lls p er b at ch\nH om\no sa p ie ns : 8 ,4 0 2; M us\nm us\ncu -\nlu s:\n1, 8 75\nH om\no sa p ie ns\n:9 ,1 70\n,8 ,2 14 ,7 ,9 0 7,\n6 ,8 9 3,\n6 ,0 9 1, 5, 55\n5; M ac\nac a\nm ul at ta :1 9 ,0 9 2,\n8 ,6 78\n,8 ,3 37\n;S us\nsc ro fa :1 3, 16 8 ,1 2, 8 6 9 ,1 0 ,8 14\nX en\nop us\ntr op\nic al is :\n12 3, 6 32\n;D an io re rio :3 6 ,6 27\nH om\no sa p ie ns\n:1 2, 74 7; M ac ac a fa sc ic ula ri s: 10 ,4 6 5\nsa m e w ith\n4 ,M\nus m us - cu lu s: 7, 4 0 2\nsa m e w ith\n5, X en\nop us\nla e-\nvi s:\n21 ,4 27\nsa m e w ith\n6 ,D\nan io\nre rio\n:3 ,1 9 3\nN um\nb er\nof an aly se d O 2O ho m ol og s\n11 ,2 4 8\n12 ,5 57\n51 8 8\n12 ,9 9 8\n11 ,2 0 2\n6 6 0 9\n4 26\n7\nN um\nb er\nof an aly se d O 2M an d M 2M ho m ol og s\n6 6 4\n24 17 4 9\n39 8\n19 9\n9 9\n8 2\nC ha\nlle n g e\np re se\nnt ed\nB as ic\np er fo rm\nan ce\nLa rg e d at a si ze\n,c om\np le x ce\nll ty p e\nst ru ct ur e\nW ho\nle -b od\ny d at a,\nch al le ng\nin g ho\nm ol -\nog y,\nd ev\nel op\nm en\nta l\ntr aj ec\nto ry\nC ro ss -s tu d y an\nd cr os ste ch no lo g y in te g ra tio\nn C ro ss -s tu d y an\nd cr os ste ch no lo g y in te g ra tio\nn Ev\nol ut io na\nri ly\nd is ta nt\nsp e-\nci es\n,c ha\nlle ng\nin g ho\nm ol og\ny Ev\nol ut io n ar ily\nd is ta nt\nsp ec\nie s,\nch al le ng\nin g ho\nm ol og\ny\nTh e \u201cN\num b er\nof ce\nlls p er\nb at ch\n\u201d re fe rs\nto th e ce\nlls fr om\nea ch\nb at ch\nth at\nha ve\np as se\nd th e q ua\nlit y co\nnt ro lc\nri te ri a in\nth e or ig in al\nlit er at ur e an\nd w er e in cl ud\ned in\nth e in te g ra tio\nn. Th\ne \u201cN\num b er\nof an\nal ys ed\nO 2O\nho m ol og\ns\u201d an\nd \u201cN\num b er\nof an\nal ys ed\nO 2M\nan d M 2M\nho m ol og\ns\u201d p er ta in\nto th e g en\nes th at\nw er e an\nal ys ed\nin th e in te g ra tio\nn ta sk s sa tis\nfy in g th e fo llo\nw in g cr ite\nri a:\n(1 )q\nua nt ifi ed\nin al ld\nat as et s in vo\nlv ed\n,( 2)\nca n b e m ap\np ed\nto an\nEN S EM\nB L g en\ne ID ,a nd\n(3 )h\nav e ho\nm ol og\ny an\nno ta tio\nn ac\nro ss\nal ls tu d ie d sp\nec ie s. To\nid en\ntif y\non eto -o ne\nor th ol og\ns an\nd in -p ar al og\ns, in cl ud\nin g on\neto -m\nan y an\nd m an\nyto -m\nan y or th ol og\ns, w e us\ned th e EN\nS EM\nB L m ul tip\nle sp\nec ie s co\nm p ar is on\nto ol\n(v er si on\n10 6 )a\nnd ac\nce ss ed\nit vi a b io m aR\nt( v2\n.4 6 .3 ). O 2O\n,o ne\n-t oon\ne; O 2M\n,o ne\n-t om an\ny; M 2M\n,m an\nyto -m\nan y.\na T he\nsc ie nt ifi c na\nm es\nof sp\nec ie s ar e in\nita lic\nfo rm\nat tin\ng .\nNature Communications | (2023) 14:6495 4\nLoss of cell type distinguishability after integration After examining output characteristics using established metrics for species mixing and biology conservation, we calculated ALCS to observe the conservation of cell type distinguishability. Figure 3a shows the ALCS of various strategies in 7 example tasks, ordered by increasing maximum divergence time among integrated species. We found that as the integration involves more species that have diverged for a longer time, there is a general increase in ALCS across all strategies, but to a different extent. Overall, LIGER, LIGER UINMF and fastMNN have noticeably higher ALCS. As an example, we show\nfastMNN\na\nb\nIntegration strategy\nHomology method\nIntegration method\nHarmony\nLIGER\nLIGER UINMF\nScanorama\nscANVI\nscVI\nSeuratV4 CCA\nSeuratV4 RPCA\nunintegrated\nO2O\nSpecies mixing score\nB io\nlo gy\nc on\nse rv\nat io\nn sc\nor e\nHE SH\nHeart_hs_mf_mm Heart_hs_mf_mm_xl Heart_hs_mf_mm_xl_dr\nPancreas_hs_mm Hippocampus_hs_mu_ss Embryo_dr_xt\nHeart_hs_mf\n0.00 0.25 0.50 0.75 1.00 0.00 0.25 0.50 0.75 1.00 0.00 0.25 0.50 0.75 1.00\n0.00 0.25 0.50 0.75 1.00 0.00 0.25 0.50 0.75 1.00 0.00 0.25 0.50 0.75 1.00\n0.00 0.25 0.50 0.75 1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\nMedian of unintegrated\nMedian of all\n0 0.15\n0.25\n0.50\n0.75\n1.00\nsc AN\nVI S\nH\nsc AN\nVI O\n2O sc AN VI H E\nSe ur\nat V4\nC CA\nH E\nSe ur\nat V4\nC CA\nS H\nSe ur\nat V4\nR PC\nA HE\nSe ur\nat V4\nC CA\nO 2O\nSe ur\nat V4\nR PC\nA SH\nSe ur\nat V4\nR PC\nA O2\nO\nHa rm\non y H\nE\nHa rm\non y O\n2O\nHa rm\non y S\nH sc VI S H sc VI H E\nfas tM\nNN S\nH\nsc VI\nO 2O fas tM NN H E\nfas tM\nNN O\n2O\nSc an\nor am\na SH\nSc an\nor am\na HE\nSc an\nor am\na O2\nO\nun int\neg ra\nte d\nHE\nun int\neg ra\nte d\nO2 O\nun int\neg ra\nte d\nSH\nLI GE\nR HE\nLI GE\nR SH LI GE R O2 O LI GE R UI NM F SH LI GE R UI NM F HE\nLI GE\nR UI\nNM F\nO2 O\nIn te\ngr at\ned s\nco re\nFig. 2 | Benchmarking scores andmetrics of different integration strategies on cross-species analysis. a We used 4 batch correction metrics and 5 biology conservation metrics to examine the output of 28 data integration strategies and rank the strategies based on 7 cross-species data integration tasks (see Methods for metrics and tasks details). Batch correction metrics and biological conservation metrics are min-max scaled per task. The species mixing score is the average of scaled batch correction metrics applicable to the output type of the integration algorithm, while the biological conservation score is the average of scaled applicable biology conservation metrics to the output type and to the integration task (see Methods for metrics and scaling details). The integrated score is a weighted average of speciesmixing score and biology conservation scorewith 40/60weight, respectively. The bar in the boxplot shows the arithmetic mean, lower and upper\nhinges correspond to the first and third quartiles, whiskers extend from the hinge to the largest value no further than 1.5 * interquartile range and outliers beyond this range are plotted as individual data points. b The species mixing score and biology conservation score of 7 example tasks (see Table 1 for task details andMethods for task naming). O2O, only use one-to-one orthologs; HE, one-to-one orthologs plus one-to-many and many-to-many orthologs matched by higher average expression level; SH, one-to-one orthologs plus one-to-many and many-to-many orthologs matched by stronger homology confidence. hs, Homo sapiens, human; mf,Macaca fascicularis, long-tailed macaque; mu, Macaca mulatta, rhesus macaque; mm, Mus musculus, mouse; ss, Sus scrofa, pig; xl, Xenopus laevis, African clawed frog; xt, Xenopus tropicalis, Western clawed frog; dr, Danio rerio, zebrafish.\nNature Communications | (2023) 14:6495 5\nthe Uniform Manifold Approximation and Projection (UMAP) visualisation of scANVI HE and LIGER O2O integration of the hippocampus_hs_mu_ss task (Fig. 3b). Though both methods were capable of species mixing, LIGER merged several groups of cell types, for instance among EC, CA1 Sub, GC and Oligo (cell type group 1, red dashed circle), as well as Endo with Vas (cell type group 2, dark grey dashed circle), whereas these cell types were kept distinguishable in scANVI. The relative ALCS stayed consistent in the 10 pairwise integration strategies of species in the heart tasks, where we also observed higher ALCS between species pairs that have diverged for a longer time (Supplementary Fig. 18).\nWe conclude that cell type distinguishability is in general at risk when integrating evolutionarily distant species, but scANVI and scVI can produce more robust results than others. When the goal of crossspecies integration is to uncover cell type homology, it is important to choose methods with low ALCS, to derive correct interpretations of cell type similarity based on the integrated embedding.\nIntegration of pancreas and hippocampal-entorhinal system We demonstrate BENGAL, starting from the integration between human and mouse pancreas (Pancreas_hs_mm task, Fig. 4a\u2013c), and\nhuman, rhesus macaque and pig hippocampal-entorhinal system33 (Hippocampus_hs_mu_ss task, Fig. 4d\u2013f). These two scenarios have clearly distinguishable cell types and evident one-to-one cell type homology. The data were generated in the same study thus reducing technical batch effects. In comparison with the Pancreas_hs_mm task, the Hippocampus_hs_mu_ss task challenged the strategies with a larger data size and more complex subcluster structures (Table 1).\nPrior to integration, cells clustered strongly by species of origin (Fig. 4b, e). After integration and assessment, we observed diverse outputs from different strategies (Fig. 4c, f, Supplementary Figs. 1, 2). Overall, the integrated scores ranged between 0.33\u20130.94 for the Pancreas_hs_mm task or 0.31\u20130.89 for the Hippocampus_hs_mu_ss task. Batch correction scores were between 0.14 and 0.97 or 0.35 and 0.78, and biology conservation scores between 0.13 and 0.96, or 0 and0.99, for the pancreas or Hippocampus_hs_mu_ss task, respectively. In both cases, harmony, fastMNN, scANVI, scVI, SeuratV4 CCA, SeuratV4 RPCA andSAMapwereable to integrate the datawhile scanorama, LIGER and LIGER UNIMF did not integrate some homologous cell type pairs, such as beta cells and delta cells (Supplementary Fig. 31). Subcluster structures were visible on the UMAPs by scVI/scANVI but not on outputs by\nEmbryo_dr_xt\nHeart_hs_mf_mm_xl_dr\nHeart_hs_mf_mm_xl\nHippocampus_hs_mu_ss\nHippocampus_hs_mu_ss\nHeart_hs_mf_mm\nPancreas_hs_mm\n0.0 0.2 0.4 0.6\n0.0 0.2 0.4 0.6\n0.0 0.2 0.4 0.6\n0.0 0.2 0.4 0.6\n0.0 0.2 0.4 0.6\n0.0 0.2 0.4 0.6\n0.0 0.2 0.4 0.6\nIntegration strategy\nA LC\nS\ncell type group 2\ncell type group 1\nH.sapiens\nM.mulatta\nS.scrofa\nAstro CA1 Sub CA2-3 CR EC Endo GC InN MC Micro OPC Oligo Progenitor SMC Vas immune\nscANVI HE, ALCS = 0.003 \u00b1 0.003\nLIGER O2O, ALCS = 0.389 \u00b1 0.213\nSpecies Cell type\nCell type\nCell type\nSpecies\nSpecies\nIntegration method\nfastMNN Harmony LIGER\nLIGER UINMF\nScanorama\nscANVI\nscVI\nSeuratV4 CCA\nSeuratV4 RPCA unintegrated\na b In cr ea se o f d iv er ge nc e tim e be tw ee n m os t d is ta nt s pe ci es\n(MYA)\nLI GE\nR O2\nO LI GE R HE LI GE R SH\nLI GE\nR UI\nNM F\nSH\nLI GE\nR UI\nNM F\nO2 O\nLI GE\nR UI\nNM F\nHE\nfas tM\nNN O\n2O\nfas tM\nNN S\nH\nfas tM\nNN H\nE\nSc an\nor am\na O2\nO\nHa rm\non y O\n2O\nSc an\nor am\na HE\nSe ur\nat V4\nC CA\nO 2O\nSc an\nor am\na SH\nHa rm\non y S\nH\nHa rm\non y H\nE\nSe ur\nat V4\nC CA\nS H\nSe ur\nat V4\nC CA\nH E\nSe ur\nat V4\nR PC\nA O2\nO\nSe ur\nat V4\nR PC\nA SH\nSe ur\nat V4\nR PC\nA HE sc VI O 2O sc VI S H sc VI H E\nsc AN\nVI O\n2O\nun int\neg ra\nte d\nO2 O\nsc AN\nVI S\nH sc AN VI H E un int eg ra te d SH un int eg ra te d HE\nHeart_hs_mf\n29\n87\n94\n352\n429\nFig. 3 | Loss of cell type distinguishability after integration is measured by accuracy loss of cell type self-projection. a The ALCS of different integration strategies in 7 cross-species integration tasks. ALCS is the decrease in test accuracy of a cell type classifier trainedon integrated data, comparedwith unintegrateddata (see Methods for details). A high ALCS indicates that cell types become indistinguishable from each other after the integration and suggests overcorrection. Tasks are ordered by increasing divergent time between the most distant species. b Example of strategies with high and lowALCS in the Hippocampus_hs_mu_ss task. In scANVI HE integrated data, all cell types are clearly distinguishable after integration. However, In LIGER O2O results, EC, CA1 Sub, GC and some Oligo (cell type group 1), as well as Endo with Vas (cell type group 2) became merged. ALCS, accuracy loss of cell type self-projection; MYA, million years ago; O2O, only use\none-to-one orthologs; HE, one-to-one orthologs plus one-to-many and many-tomany orthologs matched by higher average expression level; SH, one-to-one orthologs plus one-to-many and many-to-many orthologs matched by stronger homology confidence; hs, Homo sapiens, human; mf,Macaca fascicularis, longtailed macaque; mu,Macaca mulatta, rhesus macaque; mm,Musmusculus, mouse; ss, Sus scrofa, pig; xl, Xenopus laevis, African clawed frog; xt, Xenopus tropicalis, Western clawed frog; dr, Danio rerio, zebrafish. Astro, astrocytes; CR, Cajal-Retzius cells; EC, entorhinal cortex; Endo, endothelial cells; GC, granule cell; InN, inhibitory neurons; MC, mossy cell; Micro, microglia cells; OPC, oligodendrocyte progenitor cells; Oligo, oligodendrocytes; NP, neuronal progenitors; SMC, smooth muscle cells; Vas, vasculature.\nNature Communications | (2023) 14:6495 6\nother methods in the Hippocampus_hs_mu_ss task (Fig. 4f). We hypothesize that heterogeneitywithin each cell typewasbetter preserved in these deep learning-based methods, compared with nearest neighbour-based methods. SAMap gave a strong cross-species alignment, leading to a high degree of overlap between shared cell types on the UMAPs."
        },
        {
            "heading": "Integrating embryonic development",
            "text": "Next, we integrated the whole-body embryonic development process between xenopus and zebrafish. This is more challenging than integrating mature tissues because cell types are less distinct and a continuous trajectory exists among cells from different developmental stages. Based on mapped homologous cell types and recorded hours\na b\nc\nd e\nPancreas_hs_mm task\nDecreasing integrated score\nDecreasing integrated score\nf\nPancreas_hs_ task\nH.sapiens M.musculus Species Cell type\nCell type\nHippocampus_hs_mu_ss task\nH.sapiens M.mulatta S.scrofa\nCell type\nSpecies Cell type\nNature Communications | (2023) 14:6495 7\npost fertilisation (HPF) between a zebrafish and xenopus embryonic development dataset34,35, we examined species mixing and biology conservation of various integration outputs (Fig. 5a, b).\nWe observed an overall lower rate of success across strategies in the Embryo_dr_xt task. Algorithms that achieved higher integrated scores than unintegrated data include scVI/scANVI, SeuratV4methods and Harmony, and they had comparable species mixing and biology conservation scores (Fig. 5b). However, due to the homologymatching process, maximum 6937 homologous genes among 17,330 and 9661 genes were included in the analysis for zebrafish and xenopus, respectively, while SAMap were able to include all genes due to its utilisation of a gene-to-gene BLAST graph. Hence, when integrating\nFig. 4 | Integration results of human and mouse pancreas and human, rhesus macaque and pig hippocampal-entorhinal system. a UMAP visualisation of cell types in human and mouse pancreatic tasks. b UMAP visualisation of unintegrated data of the pancreas task. In unintegrated data, cells cluster primarily by species and homologous cell types form different species from separate clusters. One-toone orthologs between human and mouse were used to concatenate raw count matrices, then processed by standard analysis pipeline (see Methods). c UMAP visualisation of integration results of five top-performing algorithms and SAMap of the pancreas task, organised by decreasing integrated score and coloured by species or cell type. All strategies were ranked by integrated score and for the top 5 integration algorithms, the homology strategy with the highest integrated score was shown. The respective species mixing and biology conservation scores were also shown. The scoreswerenot calculated for SAMap (not applicable, seeMethods\nfor details). d\u2013f UMAP visualisation of original data, unintegrated data and integration results of five top-performing strategies and SAMap of the hippocampus task. SM, species mixing score; BC, biology conservation score; O2O, only use oneto-one orthologs; HE, one-to-one orthologs plus one-to-many and many-to-many orthologs matched by higher average expression level; SH, one-to-one orthologs plus one-to-many and many-to-many orthologs matched by stronger homology confidence; hs, Homo sapiens, human; mu,Macaca mulatta, rhesus macaque; mm, Mus musculus, mouse; ss, Sus scrofa, pig; Astro, astrocytes; CR, Cajal-Retzius cells; EC, entorhinal cortex; Endo, endothelial cells; GC, granule cell; InN, inhibitory neurons; MC, mossy cell; Micro, microglia cells; OPC, oligodendrocyte progenitor cells; Oligo, oligodendrocytes; NP, neuronal progenitors; SMC, smooth muscle cells; Vas, vasculature.\n4 6 8 10 11 12 13 14 16 18 20 22 24 Apoptotic_like Apoptotic_like_2 Blastula Blood Cement_gland_primordium Dorsal_organizer Endoderm Endothelial Epidermal_progenitor Epiphysis Eye_primordium Forebrain_midbrain Forerunner_cells Germline Goblet_cell Hatching_gland Heart Hindbrain Intermediate_mesoderm Involuting_marginal_zone Ionocyte Lens Macrophage Myeloid_progenitors Nanog_high Neural_crest Neural_crest_crestin Neural_crest_iridoblast Neural_crest_mcamb Neural_crest_melanoblast Neural_crest_xanthophore Neuroectoderm Neuroendocrine_cell Neuron Non_neural_ectoderm Notochord\nCell type\nCell type\nCell type\nHPF\nHPF\nSpecies\nHPF\nSpecies\nCell type HPF\na\nb\nD.rerio X.tropicalis\nD.rerio D.rerio X.tropicalis X.tropicalis\nFig. 5 | Integrationof embryonic developmentbetween xenopus and zebrafish. a UMAP visualisation of unintegrated data of xenopus and zebrafish embryonic development. Cells are colouredby their cell types and thedevelopmental stages as in HPF. b UMAP visualisation of integration results of five top-performing algorithms and SAMap, organised by decreasing integrated score and coloured by species or cell type. Note that 5 types of Neural_crest cells in zebrafish were\ncombined into Neural_crest in the integration for matching with xenopus. All strategieswere ranked by integrated score and for the top 5 integration algorithms, the homology strategywith the highest integrated scorewas shown. The respective species mixing and biology conservation scores were also shown. The scores were not calculated for SAMap (not applicable, see Methods for details). SM, species mixing score; BC, biology conservation score; HPF, hour post fertilisation.\nNature Communications | (2023) 14:6495 8\nspecies with less well-annotated gene homology, SAMap can keep a much more complete profile of cellular expression when successfully integrating the data. On the other hand, we found that SAMap had a relatively low trajectory conservation score in SAMap (Supplementary\nFig. 19). As seen on the SAMap UMAP, homologous cell types were strongly linked to each other and cells from different developmental stages were partially mixed. However, methods such as scVI/scANVI and SeuratV4 displayed a more explicit progression of developmental stages along the embedding (Fig. 5b). This observation suggests that SAMap focuses on prioritising identity-defining expression characteristics that stitch together evolutionarily related cell types.\nCross-atlas integration of heart and aorta among five species We designed a challenging task that is to integrate the heart and aorta tissue from five species: human, long-tail macaque, mouse, xenopus and zebrafish. While the mouse data were from an independent study to cover more cell types36, all other species data were from current multi-organ atlases.We performed the integration by gradually adding one more species, starting from human and long-tail macaque, to explore the upper limit of the number of species to generate informative integration results. We have also performed pairwise integration of all species to examine the impact of divergence time on integration results.\nWhen comparing cell type annotations between atlases, we noticed that the annotation granularity varied greatly (Supplementary\nFig. 20). To robustly match homologous populations between atlases based on existing expert annotation, we employed the cell ontology (CL), a species-neutral, controlled vocabulary system that describes the ancestor-descendant relationship of cell type terms. CL is the current standard vocabulary used in both the Human Cell Atlas37 and the EBI Single Cell Expression Atlas38 for cell type annotation. Leveraging the hierarchical organisation of CL, we developed scOntoMatch, an R package which aligns the granularity of ontology annotations among scRNA-seq datasets to make them comparable across studies (see Methods for details of the scOntoMatch algorithm). Applying scOntoMatch to the heart data, we found the highest common granularity for cell type annotation in different integration runs.\nAfter integration, scANVI reached the highest integrated score (0.62\u20130.69, Fig. 6a, individual metrics unscaled for each task for crosstask comparison. The same applies to the scores below). This was largely due to its high biology conservation score (0.70\u20130.83). On the other hand, SeuratV4 RPCA methods gave the highest species mixing score for the four tasks (0.46\u20130.54). For all tasks, scanorama, LIGER and LIGER UINMF had lower integrated scores than unintegrated data. In general, addition of species did not affect the relative performance of the integration algorithms and the species mixing scores, highlighting their robustness by these criteria (Fig. 6a). In contrast, biology conservation scores and ALCS dropped significantly (Figs. 6a, 3a), suggesting a general loss of biological signals of cell type specificities when distant species were added to the integration.\nSince only 8 among 22 cell types were shared by all species, we took this opportunity to investigate how different strategies handle cell types found in few datasets using isolated label F1 (iso_F1) score. We found that nearest neighbour-based methods have a tendency to overcorrect, leading to merging of similar cell types, especially when more species are involved in the integration (Fig. 6c). As an example, we show the SeuratV4 CCA integration of one-to-one orthologs only data for the four tasks (Fig. 6d, e). Among methods that achieved integration, SeuratV4CCA had a low iso_F1 score, suggesting cell types specific to few species data were not well-separated (Supplementary Figs. 4\u20137).\nIncrease of ALCS with addition of species was broadly observed formost strategies, indicating a loss of cell type distinctionwhenmany species data were involved in one integration (Supplementary Fig. 21). For example, ALCS of SeuratV4 CCA O2O was roughly maintained\nbetween integration of human and macaque or human, macaque and mouse, but adding xenopus to the integration led to some loss of cell type distinction and this became global and stronger after zebrafish was integrated (Fig. 6d). Integrating many species that span a large evolutionary distance cannot therefore yield robust results for downstream analysis, such as de novo clustering, due to information loss during gene homologymapping and the integration process. Similarly, pairwise integration also suggested that integration is more prone to loss of cell type distinction between species that have diverged for a longer time (Supplementary Fig. 18).\nCell type annotation transfer cross-species One key application of cross-species integration is cell type annotation transfer: using annotated cell types in a well-studied species to label the cell types of a newly characterised species. To investigate the potential of different strategies to support annotation transfer, we performed pairwise cross-annotation in all tasks. In practice, we applied the SCCAF multinomial logistic classifier trained on one species to predict the cell type labels of another species. When the transferred labels covered all known sharded cell types and had an acceptable adjusted rand score (ARI) with the original label, we considered cross-annotation successful.\nOverall, we observed that if data integration was well-achieved, annotation transfer was mostly successful (Fig. 7). In all tasks, strategies showed a significant positive correlation of integrated score with average ARI (Spearman\u2019s rank correlation P-value < 0.001). Compared with species mixing score, biology conservation score correlated stronger with ARI, suggesting that cross-annotation is facilitated by well-preserved cell type features (Supplementary\nFig. 22). We noticed that with the addition of evolutionarily more distant species in the heart tasks, the overall annotation transfer quality did not drop for methods that achieved successful integration (Fig. 7). However, when integration is not achieved, annotation transfer can result in a negativeARI,meaning that the process ismore erroneous than random label assignment. Inspection of UMAP visualisation of showed that transferred annotation was to a large extent accurate in methods such as scANVI and SeuratV4 CCA even between distant species, such as human and zebrafish (see Supplementary Fig. 23 for successful and unsuccessful examples). This is in line with the observation that top-performing methods stayed relatively robust with the addition of more species (Fig. 6a). Pairwise integration tasks show similar results that annotation transfer is more difficult between evolutionarily distant species for all strategies (Supplementary Fig. 24).\nImpact of one-to-many and many-to-many homologous genes We found that incorporating one-to-many and many-to-many homologous genes was beneficial when they accounted for a high proportion of genes used in the integration. Specifically, in the Embryo_dr_xt task, algorithms which successfully integrated the data achieved higher integrated scores if in-paralogs were included, especially when the in-paralogwith higher homology confidencewasmatchedwith the corresponding ortholog (Supplementary Fig. 25). The improvement was primarily driven by increased biology conservation scores, suggesting that including these genes preserved a more complete picture of cell type expression profiles which facilitated data integration. This observation is consistent with SAMap outperforming in the Embryo_dr_xt task, as SAMapused all genes andwas better able to resolve the alignment between homologous cell types (Fig. 5, Supplementary\nFig. 17). Although we did not observe significant improvements in benchmarking scores by adding in-paralogs in most tasks, we found that the homology method still influenced integration from the perspective of highly variable genes (HVGs). We observed that different HVGs were selected, especially among evolutionarily distant species, when incorporating in-paralogs (Supplementary Fig. 26). Since\nNature Communications | (2023) 14:6495 9\nintegration algorithms other than SAMap require HVG selection, adding in-paralogs that contribute to cell type expression variation which would support the integration algorithms. Overall, our findings highlight the importance of carefully considering the inclusion of inparalogs in data integration, as their impact varies depending on the specific task and species being studied."
        },
        {
            "heading": "Discussion",
            "text": "We benchmarked 28 strategies for cross-species single-cell transcriptomics data integration, covering 4 ways to match genes crossspecies by homology and 10 integration algorithms. Based on consensus cell type homology and unified ontology annotation, we used 4 metrics to evaluate the degree of species mixing and 6 for scoring\n0.2\n0.4\n0.6\n0.8\nHe ar\nt_ hs\n_m f\nHe ar\nt_ hs\n_m f_\nm m\nHe ar\nt_ hs\n_m f_\nm m\n_x l\nHe ar\nt_ hs\n_m f_\nm m\n_x l_d\nr\nTask name\nB io\nlo g\ny co\nn se\nrv at\nio n\ns co\nre (\nun sc\nal ed\n)\n0.2\n0.4\n0.6\n0.8\nHe ar\nt_ hs\n_m f\nHe ar\nt_ hs\n_m f_\nm m\nHe ar\nt_ hs\n_m f_\nm m\n_x l\nHe ar\nt_ hs\n_m f_\nm m\n_x l_d\nr\nTask name\nTask nameTask name\nS pe\nci es\nm ix\nin g\nsc or\ne (u\nns ca\nle d)\n0.2\n0.4\n0.6\n0.8\nHe ar\nt_ hs\n_m f\nHe ar\nt_ hs\n_m f_\nm m\nHe ar\nt_ hs\n_m f_\nm m\n_x l\nHe ar\nt_ hs\n_m f_\nm m\n_x l_d\nr\nTask name\nIn te\ngr at\ned s\nco re\n( un\nsc al\ned )\nb dc\ne\nDivergent time\n0.00\n0.05\n0.10\n0.15\nHe ar\nt_ hs\n_m f\nHe ar\nt_ hs\n_m f_\nm m\nHe ar\nt_ hs\n_m f_\nm m\n_x l\nHe ar\nt_ hs\n_m f_\nm m\n_x l_d\nr\nA LC\nS\nD.rerio\nH.sapiens\nM.fascicularis M.musculus X.laevis\nB cell cardiac muscle cell dendritic cell endothelial cell erythrocyte\nfat cell fibroblast granulocyte innate immune epithelial cell macrophage\nmast cell mesothelial cell of epicardium natural killer cell pericyte cell plasma cell\nproliferating cell Schwann cell schwann precursor cell smooth muscle cell stromal cell T cell\nfastMNN\nIntegration method\nCell type\nSpecies\nHarmony\nLIGER\nLIGER UINMF\nScanorama\nscANVI\nscVI\nSeuratV4 CCA\nSeuratV4 RPCA\nunintegrated\na\n0.00\n0.25\n0.50\n0.75\n1.00\nHe ar\nt_ hs\n_m f\nHe ar\nt_ hs\n_m f_\nm m\nHe ar\nt_ hs\n_m f_\nm m\n_x l\nHe ar\nt_ hs\n_m f_\nm m\n_x l_d\nr\nis o\nF 1\nAlgorithm\nNN based\nOthers\nSeuratV4 CCA O2O integrated\nSeuratV4 CCA O2O integrated\nSpecies\nCell type\nNature Communications | (2023) 14:6495 10\nbiology conservation.We also provided the following freely available tools: BENGAL, a Nextflow pipeline for cross-species scRNA-seq data integration and assessment of integration results; ALCS, a crossspecies integration-focused biology conservation metric to quantify the loss of cell type distinguishability; scOntoMatch; an R package to help align the granularity of cell ontology annotation across datasets.\nWe found that deep neural network-based scVI/scANVI generally achieved an overall balance between species mixing and biology conservation. scANVI performed the best across the board, suggesting that taking cell type annotation into account is beneficial for the integration. On the other hand, SeuratV4 methods were able to integrate successfully for evolutionarily distant species but were more prone to overcorrection due to its nearest neighbour foundations. Algorithms based on NMF could not integrate some cell types and merged different cell types in basic scenarios, suggesting that they were less suitable for cross-species integration. We noticed that the tailor-made cross-species integration algorithm, SAMap, can pick up key similarities between homologous cell types that are otherwise difficult to detect in complex situations. The impact of the homology method depended on the species involved in the integration. Different homology methods influenced HVG selection and had larger influences when there was a high proportion of one-to-many and many-to-many orthologs between the studied species. By performing cell type annotation transfer using integrated results, we observed that if integration is well-achieved, annotation transfer was to a large extent successful evenbetween evolutionarily distant species such as human and zebrafish. Nonetheless, highly similar cell types could still be mislabelled between closely related species e.g. human and mouse.\nFig. 6 | Integrating heart tissue from human, long-tail macaque, mouse, xenopus and zebrafish. a Unscaled integrated score, species mixing score and biology conservation score of all strategies for the four heart tasks. The batch metrics andbiology conservationmetrics are notmin-max scaledper task to enable cross-task comparison. Each point shows the average score across three homologousmethods of each integration algorithm and error bars indicate the standard deviation. b The divergence time among the studied species in millions of years. c The isolated label F1 score of different strategies in the 4 heart tasks. Nearest neighbour-based (NN-based) results (n = 9) are by algorithms including fastMNN, SeuratV4 CCA and SeuratV4 RPCA and the other results (n = 18) are by non-NNbased algorithms. The bar in the boxplot shows the arithmetic mean, lower and\nupper hinges correspond to the first and third quartiles and whiskers extend from the hinge to the largest value no further than 1.5 * interquartile range from the hinge. There are no outliers. d The ALCS of SeuratV4 CCA O2O integrated data per species of each heart task. High ALCS indicates a strong loss of cell type distinguishability due to overcorrection (see Methods for details). e UMAP visualisation of SeuratV4 CCA O2O integrated data in heart tasks, coloured by species and cell type. Unscaled SM and BC scores are also shown. Iso F1, isolated label F1 score; NN, nearest neighbour; ALCS, accuracy loss of cell type self-projection; SM, species mixing score; BC, biology conservation score; O2O, only use one-to-one orthologs; hs, Homo sapiens, human; mf,Macaca fascicularis, long-tailed macaque; mm, Mus musculus, mouse; xl, Xenopus laevis, African clawed frog; dr, Danio rerio, zebrafish.\nHomology method\nO2O HE SH\nIntegration method\nfastMNN\nHarmony\nLIGER\nLIGER UINMF\nScanorama\nscANVI\nscVI\nSeuratV4 CCA\nSeuratV4 RPCA\n= 0.79\np = 1.4e\u221206\ny = 0.049 1.1 x\nRadj 2 = 0.54\n= 0.9\np = 2.3e\u221207\ny = 0.12 1.3 x\nRadj 2 = 0.79\n= 0.82\np = 9.9e\u221207\ny = 0.36 0.75 x\nRadj 2 = 0.81\n= 0.92\np = 1.3e\u221207\ny = 0.051 1.2 x\nRadj 2 = 0.63\n= 0.79\np = 3e\u221206\ny = 0.073 0.4 x\nRadj 2 = 0.38\n= 0.93\np = 6.5e\u221207\ny = 0.13 1.3 x\nRadj 2 = 0.81\n= 0.78\np = 1.7e\u221206\ny = 0.014 1.2 x\nRadj 2 = 0.61\nHeart_hs_mf_mm Heart_hs_mf_mm_xl Heart_hs_mf_mm_xl_dr\nPancreas_hs_mm Hippocampus_hs_mu_ss Embryo_dr_xt\nHeart_hs_mf\n0.00 0.25 0.50 0.75 1.00 0.00 0.25 0.50 0.75 1.00 0.00 0.25 0.50 0.75 1.00\n0.00 0.25 0.50 0.75 1.00 0.00 0.25 0.50 0.75 1.00 0.00 0.25 0.50 0.75 1.00\n0.00 0.25 0.50 0.75 1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\n0.00\n0.25\n0.50\n0.75\n1.00\nIntegrated score\nA ve\nra ge\nA R\nI o f a\nnn ot\nat io\nn tr\nan sf\ner\nFig. 7 | Adjusted rand index of cross-species cell type annotation transfer. The averageARIs between transferred annotation andoriginal annotation in 7 reference tasks are shown for all integration strategies. A high ARI suggests a successful annotation transfer. Spearman\u2019s rank correlation coefficients indicate that ARI significantly positively correlates with the integrated score in all tasks (two-sided Student\u2019s t-test P-value < 0.001). This is further demonstratedby a linear regression using y = x indicated by the grey line and the band shows 95% confidence interval. Strategies are represented by points whose colour is the integration algorithm and whose shape is the homologymethod. ARI, adjusted rand index;\u03c1, Spearman\u2019s rank\ncorrelation coefficient; p, P-value of Spearman\u2019s rank correlation; R2adj, adjusted goodness-of-fit of the linear model; O2O, only use one-to-one orthologs; HE, oneto-one orthologs plus one-to-many and many-to-many orthologs matched by higher average expression level; SH, one-to-one orthologs plus one-to-many and many-to-many orthologs matched by stronger homology confidence; hs, Homo sapiens, human;mf,Macaca fascicularis, long-tailedmacaque;mu,Macacamulatta, rhesus macaque; mm, Mus musculus, mouse; ss, Sus scrofa, pig; xl, Xenopus laevis, African clawed frog; xt, Xenopus tropicalis, Western clawed frog; dr, Danio rerio, zebrafish.\nNature Communications | (2023) 14:6495 11\nBased on a diversity of cross-species integration scenarios investigated in this study, we provide the following guidelines on choosing the most appropriate algorithm for cross-species integration: for closely related species, scVI (scANVI when confident cell type annotation is available) or harmony carries out species mixing while preserving biological heterogeneity. For relatively distant species, SeuratV4 methods can achieve strong speciesmixing and RPCA ismore scalable than CCA for larger datasets17,39. For integration of whole-body atlases or between species lacking well-curated gene homology annotation, SAMap excel in aligning homologous cell types by resolving the gene homology mapping challenge. For species sharing a large amount of one-to-many and many-to-many orthologs, including them in the analysis can improve the integration as more information about cell type expression profiles are preserved. It is important to note that the actual integration of scRNA-seq data is most beneficial among species that have diverged up to a certain extent, such as those from the same phylum. According to the heart example, we conclude that when data integration is performed between non-mammals with mammals, the result can still serve as basis for cell type annotation transfer, but the embedding is not suitable for de novo clustering analysis due to strong loss of biology. Alternative approaches such as correlation analysis of cell type marker genes might be more appropriate for very distant species16,30.\nOur quantitative scoring system of species mixing and biology conservation is supported by two assumptions: (1) cell type annotations are accurate; (2) known cell type homology from literature is confident. It is important to point out that our knowledge about cell types and their evolution is still rapidly growing8,40. The increasing availability of scRNA-seq atlases fromdifferent species will provide the opportunity to study the evolution of cell types at a greater extent in the future. This study focuses on addressing the computational artefacts introduced by scRNA-seq integration strategies in cross-species scenarios and the different limitations of such approaches, using oneto-one cell type mappings. While valid non-one-to-one cell type mappings across species do exist, particularly over long evolutionary distances19,30, we are currently limited by: the availability of datasets that can serve as ground truth; sophisticated computational methods; and more specialised assessment metrics to benchmark non-one-toone evolutionary cell type mappings (see Supplementary Note 2 for further discussions).\nFuture cross-species integration will require the development of novel integration strategies that overcome the limitation of gene orthology, are aware of the evolutionary homology between cell types and adopt a hierarchical structure of cell type classification. Currently, cross-species integration still heavily relies on curated gene orthology based on sequence. From the standpoint of gene evolution, this has two caveats: (1) species-specific genes contribute to a large extent the novelty of species-specific cell types and should not be ignored when performing cross-species analysis11,41, (2) functional diversification between orthologsmight be as common as between paralogs and outparalogs can exhibit higher expression similarity compared to their corresponding orthologs through gain, loss and partition of function19,42,43. Up till now, only SAMap tackles the above caveats by de novo gene homology mapping and iterative refinement. However, being a heuristic approach, it does not provide explanations of the observed cell type expression similarity. Expression similarities between cell cross-species may arise for reasons other than evolutionary homology, such as convergence and concerted evolution8. Novel algorithms are required to disentangle the source of the expression similarities to achieve deeper understandings of cell types10. Computational methods able to combine other modalities, such as chromatin accessibility data from single-cell sequencing assay for transposase-accessible chromatin (scATAC-seq) with scRNA-seq data can identify cell type mapping due to evolutionary relatedness. Moreover, as cell types have undergone complex evolutionof identity-\ndefining transcriptional regulatory machinery19, the correspondence between cell types from different species will not be comprehensively described by a flat mapping such as one-to-one or one-to-many. Adopting a hierarchical representation of cells in the integration outcome can benefit the comprehension of the relationship between cell types across species."
        },
        {
            "heading": "Methods",
            "text": ""
        },
        {
            "heading": "Abbreviations",
            "text": "We used consistent abbreviations for species and homology methods across this study for clarity and brevity. For species,we took the initials of the scientific name of the species: hs, Homo sapiens, human; mf, Macaca fascicularis, long-tailedmacaque; mu,Macacamulatta, rhesus macaque; mm, Mus musculus, mouse; ss, Sus scrofa, pig; xl, Xenopus laevis, African clawed frog; xt, Xenopus tropicalis, Western clawed frog; dr, Danio rerio, zebrafish. For homology methods the abbreviations were: matching only one-to-one orthologs between species, O2O; matching one-to-one orthologs and in-paralogs with which have a higher expression value, HE; matching one-to-one orthologs and inparalogs which have a higher homology confidence, SH; include all homologous genes as well as those without homology information, all genes. We named the integration tasks following the pattern: tissue_species, and the integration strategies following the pattern algorithm_homology_method.\nQuality control of scRNA-seq datasets We followed theQC criteria in the original studies for each dataset. We excluded cells that didn\u2019t pass QC from the raw count data, according to published cell type annotations. We did not apply additional QC in this study nor is the QC step part of the BENGAL pipeline, since the criteria are highly specific to each dataset and should be performed on case-by-case while observing the data."
        },
        {
            "heading": "Reference transcriptomes",
            "text": "Transcriptomes used in the BLAST step in SAMap were downloaded from ENSEMBL, except that for xt in Embryo_dr_xt task the transcriptome was downloaded from Xenbase (https://www.xenbase.org/ entry/static-xenbase/ftpDatafiles.jsp). Transcriptome versions were in line with the version at original publication of each dataset: Pancreas_hs_mm task: mm (GRCm38) and hs (GRCh38); Hippocampus_hs_mu_ss task: hs (GRCh38), mu (Mmul_10), ss (Sscrofa11); heart tasks: hs (GRCh38), ma (Macaca_fascicularis_6.0), mm (GRCm39), xl (v9.2), dr (GRCz11); Embryo_dr_xt task: xt (Xtropicalisv9.0), dr (GRCz10).\nCuration of cell type annotation based on known homology We took the published cell type annotation of all datasets used in this study and curated the cell type annotations into cell ontology37 terms. We paid specific attention that the same cell type identifier refers to homologous cell types i.e. cell types fromdifferent species which trace back to the same precursor cell type in a common evolutionary ancestor8.\nIn the Pancreas_hs_mm and Hippocampus_hs_mu_ss tasks, cell type homology was evident between species and were matched in the original study. For the Hippocampus_hs_mu_ss task, NBs, RGLs and nIPCs from macaque and pig were collectively annotated as neuronal progenitor. In the human data, we collectively annotated CA1 and SUB as CA1 SUB, CA2, CA3 as CA 2-3, macrophage, microglia, myeloid cell and T cell as immune, aSMCs and vSMCs as smooth muscle cell, pericytes and vascular and leptomeningeal cell as vasculature, COP was combined with OPC. For the Embryo_dr_xt task, we used the annotations provided in the SAMap study19, as they had manually matched one-to-one homologous cell types using multiple lines of evidence including developmental hierarchies. For the heart tasks, we leveraged the hierarchical structure of cell ontology to align\nNature Communications | (2023) 14:6495 12\nannotation granularity across datasets, so that homologous cell populations for a given set of species with curated ontology annotation were matched (see the \u201cAligning ontology annotation with scOntoMatch\u201d section below). Overall, we ensured one-to-one mapping of homologous cell types among the studied species for benchmarking purpose, even though this might lose granularity and lead to slightly more coarse annotation in the heart tasks."
        },
        {
            "heading": "The BENGAL pipeline",
            "text": "The BENGAL pipeline was built using Nextflow (v22.04.3) DSL2 in java (OpenJDK v11.0.9.1-internal) and utilises singularity containers44 for portability and reproducibility and is compatiblewith the execution on high performance computing (HPC) clusters. For data integration, python-based scripts were written based on Python (v3.9.13), Scanpy (v1.9.1), h5py (v3.7.0) and anndata (v0.7.5). We used python implementation of harmonypy (v0.0.5), scanorama (v1.7.2), scVI and scANVI (v0.15.0 with pytorch v1.12.1 and cudatoolkit v11.6 to support executionwithNvidiaGPU), SAMap (v1.0.2). R-based scripts were based onR (v4.0.5). We used Seurat (v4.1.1), LIGER (v0.5.0) and LIGER UINMF (v1.1.0) and fastMNN (v1.12.3 from package batchelor). For SCCAF analysis, we made modifications to the SCCAF package v0.0.10 and provided a docker container in docker://yysong123/intgpy:sccaf. For batch correctionmetrics andbiology conservationmetrics calculation, we used scIB (v1.1.3).\nTranslating features cross-species by gene homology We used ENSEMBL multiple species comparison tool (version 106), accessed via biomaRt (v2.46.3), to annotate gene homology and translate ENSEMBLgene id cross-species.We chose ENSEMBL tobe the primary database for gene homology annotation, since there is manually curated homology in addition to the automated annotation pipeline, it is a popular choice among previous and current crossspecies scRNA-seq studies and it is broadly accessible for biologists from various disciplines. BENGAL can be conveniently adapted to use other homology databases, such as EggNOG or BLAST, as long as a homology matching table can be provided.\nConstruct concatenated cross-species count matrix Starting from raw count matrices of scRNA-seq data from different species, the BENGAL pipeline first identifies gene groups composed of one-to-one, one-to-many or many-to-many orthologs and speciesspecific genes using ENSEMBLmultiple species comparison tool. Oneto-one orthologs are directly matched across species. On top of that, one-to-many or many-to-many orthologs within each gene group are added andmatched by selecting those with higher average expression level calculated using scanpy.pp.calculate_qc_metrics, orwith stronger homology confidence defined in ENSEMBL using available attributes among: orthology.confidence, Gene.order.conservation.score, Whole.genome.alignment.coverage, query.gene.identical.to.target, gene.identical.to.query.gene in respective order from biomaRt. The method LIGER UINMF also takes unshared features (species-specific genes) and these genes were added in addition to the three types of inputs with shared features. SAMap quantifies gene homology strength using de novo BLAST, so the raw countmatrix and the full set of genes were given to the method without the above homologymatching step, and tblastx (from BLAST v2.12.0) was run using transcriptomes data to generate blast maps for the method.\nStandard processing of scRNA-seq data Per-species data and unintegrated data were analysed following the scanpy standard analysis workflow with following parameters: sc.pp.highly_variable_genes(adata, min_mean = 0.0125, max_mean= 3, min_disp =0.5); sc.pp.scale(adata, max_value = 10); sc.tl.pca(adata, svd_solver = \u2018arpack\u2019); sc.pp.neighbours(adata, n_neighbors = 15, n_pcs = 40); sc.tl.umap(adata, min_dist = 0.3, spread= 1).\nFor the homology concatenated data input to integration algorithms, we selected highly variable genes per integration key by sc.pp.highly_variable_genes(adata, min_mean = 0.0125, max_mean = 3, min_disp = 0.5, batch_key = integration_key). This function calculates HVGs per batch and uses the intersection of HVGs across batches as input for PCA (see below for integration key per task)."
        },
        {
            "heading": "Cross-species data integration",
            "text": "Taking the concatenatedmatrixwith cells fromall species and features matched by homology as input, the pipeline runs 10 integration methods using default parameters.\nfastMNN: we used the fastMNN fromgithub.com/LTLA/batchelor, via SeuratWrappers (v0.3.0) following the tutorial http://htmlpreview. github.io/?https://github.com/satijalab/seurat-wrappers/blob/master/ docs/fast_mnn.html.\nharmony: we used scanpy.external.pp.harmony_integrate to run harmony following tutorial: https://scanpy.readthedocs.io/en/stable/ generated/scanpy.external.pp.harmony_integrate.html.\nLIGER: we used the LIGER method via SeuratWrappers (v0.3.0) following the tutorial: http://htmlpreview.github.io/?https://github. com/satijalab/seurat-wrappers/blob/master/docs/liger.html.\nLIGER UINMF: we ran LIGER UINMF via github.com/welch-lab/ liger following the tutorial http://htmlpreview.github.io/?https:// github.com/welch-lab/liger/blob/master/vignettes/SNAREseq_ walkthrough.html.\nSAMap: we ran SAMap using github.com/atarashansky/SAMap following the tutorial and vignette in the github repository.\nScanorama: we used scanpy.external.pp.harmony_integrate to run scanorama following tutorial: https://scanpy.readthedocs.io/en/ stable/generated/scanpy.external.pp.scanorama_integrate.html.\nscANVI: we ran scANVI following documentation https://docs. scvi-tools.org/en/stable/api/reference/scvi.model.SCANVI.html. Note that although scANVI can be initialised from a pre-trained scVI model, we built scANVI models from scratch using the input AnnData object. This is to make the scANVI runs independent of scVI runs for benchmarking purposes.\nscVI: we ran scVI from scvi-tools.org/ following tutorial https:// docs.scvi-tools.org/en/stable/tutorials/notebooks/harmonization.html.\nSeuratV4CCA and SeuratV4RPCA: we ran SeuratV4CCA from https://satijalab.org/seurat/index.html following https://satijalab.org/ seurat/articles/integration_introduction.html and RPCA following https://satijalab.org/seurat/articles/integration_rpca.html."
        },
        {
            "heading": "Integration key",
            "text": "SAMap is designed toperform integration betweendata fromdifferent species so \u2018species\u2019 were used as the integration key. For the integration methods other than SAMap, we used \u2018species\u2019 as the integration key if there is only one batch per species (Embryo_dr_xt task) or perspecies batches have unbalanced cell type composition (Pancreas_hs_mm task and Heart tasks), otherwise, we used \u2018batch\u2019 as integration key if each batch has balanced cell types (Hippocampus_hs_mu_ss task). Highly variable genes were selected using the same integration keys."
        },
        {
            "heading": "Dimension reduction and visualisation",
            "text": "For methods which output an embedding, neighbourhood graphs were calculated with n_neighbors = 15, n_pcs = 40, and the UMAP representations were computed using min_dist = 0.3 and spread = 1.0. Points were shuffled when plotting UMAP to avoid colour overlap. For methods that output a pseudo-count matrix, we first calculated PCA, then used the same parameters to calculate neighbourhood graph and UMAP. SAMap outputs a corrected neighbourhood graph, so we only recalculated UMAP using the same parameter for visualisation.\nNature Communications | (2023) 14:6495 13\nSpecies mixing score and batch correction metrics Speciesmixing was assessed by 4 established batch correctionmetrics for scRNA-seq. This includes the principal component regression (PCR), batch average silhouettewidth (bASW), graph connectivity (GC) and k-nearest neighbour batch effect test (kBET). Principals of these metrics are described in SupplementaryMethods. In practice, we used the scIB package to calculate the metrics17. All metrics were computed on the PCA embedding for methods returning a pseudo-count matrix (SeuratV4methods, n_pcs = 20), or theoutput embedding formethods returning a latent embedding (n_dims = 20). For metrics that operate on kNN graphs, we calculated k = 20 nearest neighbours on the PCA or embedding both using the first 20 dimensions. In addition, PCR does not rely on cell type annotation whilst the other metrics take cell type labels into account. We highlighted the separation of these two types of methods in detailed scores and rankings of each task (Supplementary Figs. 1\u20137).\nWe computed these 4 metrics in 28 integration strategies and 3 unintegrated data of different homology strategies. For each metric, we performed min-max scaling to reflect the relative performance of different strategies in concordance with scIB17. We included the unintegrated data in the scaling as a reference, to avoid minor differences in metrics between algorithms that performed similarly well enlarged by scaling.\nSpeciesmixing score is the average of the scaled 4metrics. This is to balance the potential biases between different metrics as none of them are on itself a comprehensive evaluation of species mixing.\nSpeciesmixing score = average\u00f0PCRscaled, bASWscaled, GCscaled, kBETscaled\u00de \u00f01\u00de\nUnlike the study of scIB, we did not include batch graph Local Inverse Simpson\u2019s Index (iLISI) score. This was because most integration outputs simply have a raw iLISI score near 0 (see Supplementary Fig. 43 for raw metrics distribution). We reasoned that integrated data could not show improvement in terms of iLISI score because cross-species difference is among the largest effects. All other batch correction metrics could show informative range of variation and using the average was the most appropriate for comparing between strategies. See Supplementary Methods for principles of the batch metrics, with further details available in the scIB study17.\nBiology conservation score and metrics Biology conservation was assessed by 5 biology conservationmetrics for scRNA-seq, as well as ALCS, a novelmetricwe developed to reflect maintenance of cell type distinguishability. Biology conservation metrics include cell type ASW (cASW), normalised mutual information (NMI), ARI, iso_F1 score and trajectory conservation score (Traj, only applicable in the Embryo_dr_xt task). Principals of these metrics were described in Supplementary Methods. We computed these 5 metrics in 28 integration strategies and 3 unintegrated data of different homology strategies using scIB and perform min-max scaling. Biology conservation score is the average of the scaled metrics.\nBiology conservation score=\naverage cASWscaled,NMIscaled,ARIscaled,isoF1scaled,Trajscaled\n\u00f02\u00de\nWe did not include cell type graph LISI (cLISI) in scIB for a similar reason with iLISI: this score was easily fulfilled bymost of the results in our study (Supplementary Fig. 43). All strategies achieved a cLISI close to 1 and thus was not informative to scale thesemetrics or include it in biology conservation score. See Supplementary Methods for\nprinciples of the biological conservation metrics, with further details available in the scIB study17."
        },
        {
            "heading": "Integrated score",
            "text": "Integrated scorewas theweighted average of speciesmixing score and biology conservation score. In concordance with the scIB study, we gave 0.4 weight to species mixing and 0.6 weight to biology conservation.\nIntegrated Score =0:4 *species mixing score +0:6 *biology conservation score\n\u00f03\u00de\nIn this study, we presented integrated scores that allow for comparison between integration strategies utilised in our cross-species integration tasks. It is important to note that scores in this study donot suggest a complete evaluation of the algorithms employed. These algorithms primarily perform cross-batch and cross-modality integration, as demonstrated by their benchmarking on these tasks in the scIB study17."
        },
        {
            "heading": "Alignment score",
            "text": "To quantitatively analyse the degree of cross-species alignment achieved by SAMap,we calculated the alignment score (AS) used in the SAMap study. AS is the average percentage of cross-species neighbours over the maximum number of possible neighbours across all cells from all species.\nAlignment score =\nP cells numberof cross species neighbours maximumnumberof neighbours\ntotal number of cells \u00f04\u00de\nThis reflects the degree of cross-species alignment and is comparable between SAMap and other strategies. We calculated AS on the kNN graph calculated from embeddings or PCA of pseudo-count matrices from other strategies with sc.pp.neighbours(adata, n_neighbours = 20, n_pcs = 20) and directly on the graph output of SAMap (SAMap ran with n_neighbours = 20). Across all tasks, SAMap showed significantly higher AS than other strategies, while other strategies showed smaller improvement over unintegrated data (Supplementary\nFig. 17). Undeniably, SAMap directly operates at kNN level to align cross-species neighbours, resulting in enhanced cross-species alignment. On the other hand, we treated inter-species and intra-species edges equally when kNN was calculated for other methods. Nevertheless, AS is in concordance with the observed strong cross-species alignment by SAMap from the UMAP visualisations.\nAssessing biology conservation with ALCS Wepropose a newmetric, ALCS, to assess themaintenance of cell type distinction after cross-species integration. This is motivated by our observation that integration algorithms tend to overcorrect and lose the separation of similar cell types on the integrated embedding, since cross-species difference is huge. This behaviour contradicts the goal of cross-species integration, as any species-specific population with subtle differences from others will become unidentifiable after integration.\nTo calculate ALCS, we adapted functions from the Single Cell Clustering Assessment Framework (SCCAF)32. SCCAF is a selfprojection-based approach to assess the validity of a classification system, in our case the cell type annotations. Self-projection is the process in which a machine learning classifier is trained on half of the training set andused topredict the label of theother half. The accuracy of self-projection indicates the clarity of the classification. In our case, we chose to use multinomial logistic classifiers as it has been shown to perform equally well compared with other models in the SCCAF study\nNature Communications | (2023) 14:6495 14\n(see Supplementary Note 3 for other supported classifiers and discussions). We explored the possibility of using a kNN classifier for ALCS but concluded that several caveats hinder its proper adaptation so far (see Supplementary Note 4 for analysis). We computed the loss of self-projection accuracy on the integrated embedding compared with the original per-species data, as a measurement of howmuch cell type distinguishability is lost due to integration.\nALCS= test accuracy original\u00f0 \u00de test accuracy integrated\u00f0 \u00de \u00f05\u00de\nSCCAF models were trained on the PCA embedding for methods returning a pseudo-count matrix and the output embedding for those whooutput an embedding. It is not applicable formethods that output a kNN graph.\nAligning ontology annotation with scOntoMatch ScRNA-seq datasets from different studies often have varying levels of granularity in their cell type annotations,making it difficult to compare them. To address this, we developed an R package called scOntoMatch, which aligns the granularity of cell type annotation. Such alignment requires an ontology as a reference and we used Cell Ontology in this study37. CL describes the ancestor-descendant relationships between cell type terms across animals, making it a reliable reference for harmonising annotation granularity for cross-species annotation.\nThe scOntoMatch algorithm mainly has two steps. First, it trims the cell type tree in each dataset to remove redundant terms. Second, it identifies an ontology matching across the datasets. The latter is achieved by finding terms that can be directly matched and matching descendants in one dataset to ancestors in another to find the last common ancestor (LCA) term across all datasets. The output is an ontology annotation of all cells that has the highest possible granularity, and aligned across datasets, enabling cross-species comparison. In the aligned annotations, every cell type term is a leaf node in the directed acyclic graph (DAG) created by all cell types from all the input datasets. The scOntoMatch package also provides functions for visualising the CL hierarchy. This approach is essential for batch correction and biology conservation metrics, which rely on cell type annotation and require a systematic, structured way of matching cell type annotations across studies."
        },
        {
            "heading": "Annotation transfer cross-species",
            "text": "To transfer cell type annotations between species, we employed the SCCAF multinomial logistic classifiers. For each pair of species, we initially trained an SCCAF classifier using data from one species on the integrated data. Subsequently, we used this classifier to infer the cell type annotation of the other species within the same integrated result. To evaluate the accuracy of the transferred annotations, we calculated the ARI between the original annotation and the transferred annotation for each species. The overall ARI for each integration strategy was computed by averaging the ARIs of all species in all transfer runs. A successful annotation transfer is indicated by an ARI close to 1."
        },
        {
            "heading": "Reporting summary",
            "text": "Further information on research design is available in the Nature Portfolio Reporting Summary linked to this article."
        },
        {
            "heading": "Data availability",
            "text": "All datasets analysed in this study are publicly available. Raw count matrices and published annotations can be download from the following sources: inDrop data from human and mouse pancreas are available via the GEO database under accession code GSE8413345; snRNA-seq data from human, macaque and pig hippocampal and entorhinal regions are available via the GEO database under accession\ncode GSE18653833; scRNA-seq data of heart and aorta tissue from human are available via figshare [https://figshare.com/projects/ Tabula_Sapiens/100973]1, snRNA-seq data of the heart of long-tail macaque are accessible via the NHPCA database [https://db.cngb.org/ nhpca/download]3, scRNA-seq data ofmouseheart are available via the EBI ArrayExpress database under accession code E-MTAB-8810 (only no compound treatment mouse data was used)36, microwell-seq data of Xenopus laevis heart are available via figshare [https://figshare.com/ articles/dataset/Cell_Atlas_of_the_Xenopus_Laevis_at_Single-Cell_ Resolution/19152839]46 and microwell-seq data of zebrafish heart are available via the ZCL database [https://bis.zju.edu.cn/ZCL/]5; inDrops data of zebrafish embryo are available via the GEO database under accession code GSE11229434 and inDrops data of xenopus embryo are available via the GEO database under accession code GSE11307435. Reference transcriptomes used are listed in Methods. Raw metrics, scaled metrics, scores and rankings for all tasks generated in this benchmark are provided in Supplementary Data 1."
        },
        {
            "heading": "Code availability",
            "text": "The BENGAL pipeline is available at https://github.com/FunctionalGenomics/BENGAL and the version of code used in this study is available via Zenodo with https://doi.org/10.5281/zenodo.826878447. Codes and source data for generating the figures in this study are deposed at https://github.com/Functional-Genomics/BENGAL_ reproducibility. The package scOntoMatch is available through CRAN https://cran.r-project.org/web/packages/scOntoMatch/index. html, the version used in this study is 0.1.0 and the development version is available at https://github.com/Functional-Genomics/ scOntoMatch."
        },
        {
            "heading": "2. Tabula Muris Consortium. et al. Single-cell transcriptomics of",
            "text": "20 mouse organs creates a tabula muris. Nature 562, 367\u2013372 (2018). 3. Han, L. et al. Cell transcriptomic atlas of the non-human primate macaca fascicularis. Nature 604, 723\u2013731 (2022). 4. Wang, F. et al. Endothelial cell heterogeneity and microglia regulons revealed by a pig cell landscape at single-cell level. Nat. Commun. 13, 1\u201318 (2022). 5. Jiang, M. et al. Characterization of the zebrafish cell landscape at single-cell resolution. Front. Cell Dev. Biol. 9, 743421 (2021). 6. Musser, J. M. et al. Profiling cellular diversity in sponges informs animal cell type and nervous system evolution. Science 374, 717\u2013723 (2021)."
        },
        {
            "heading": "7. Vergara, H.M. et al.Whole-body integration of gene expression and",
            "text": "single-cell morphology. Cell 184, 4819\u20134837.e22 (2021). 8. Arendt, D. et al. The origin and evolution of cell types. Nat. Rev. Genet. 17, 744\u2013757 (2016)."
        },
        {
            "heading": "9. Tosches, M. A. et al. Evolution of pallium, hippocampus, and cortical cell types revealed by single-cell transcriptomics in reptiles.",
            "text": "Science 360, 881\u2013888 (2018). 10. Woych, J. et al. Cell-type profiling in salamanders identifies innovations in vertebrate forebrain evolution. Science 377, eabp9186 (2022)."
        },
        {
            "heading": "11. Shafer, M. E. R., Sawh, A. N. & Schier, A. F. Gene family evolution",
            "text": "underlies cell-type diversification in the hypothalamus of teleosts. Nat. Ecol. Evol. https://doi.org/10.1038/s41559-021-01580-3 (2021). 12. Bakken, T. E. et al. Comparative cellular analysis of motor cortex in human, marmoset and mouse. Nature 598, 111\u2013119 (2021)."
        },
        {
            "heading": "13. Li, H. et al. Cross-species single-cell transcriptomic analysis reveals divergence of cell composition and functions in mammalian ileum",
            "text": "epithelium. Cell Regen. 11, 19 (2022).\nNature Communications | (2023) 14:6495 15\n14. Xu, J. et al. Transcriptional and functional motifs defining renal function revealed by single-nucleus RNA sequencing. Proc. Natl Acad. Sci. USA. 119, e2203179119 (2022)."
        },
        {
            "heading": "15. Liang, C., Musser, J. M., Cloutier, A., Prum, R. O. & Wagner, G. P. Pervasive correlated evolution in gene expression shapes cell and",
            "text": "tissue type transcriptomes. Genome Biol. Evol. 10, 538\u2013552 (2018)."
        },
        {
            "heading": "16. Shafer, M. E. R. Cross-species analysis of single-cell transcriptomic",
            "text": "data. Front. Cell Dev. Biol. 7, 175 (2019)."
        },
        {
            "heading": "17. Luecken, M. D. et al. Benchmarking atlas-level data integration in",
            "text": "single-cell genomics. Nat. Methods https://doi.org/10.1038/ s41592-021-01336-8 (2021)"
        },
        {
            "heading": "18. Heumos, L. et al. Best practices for single-cell analysis across",
            "text": "modalities. Nat. Rev. Genet. 24, 1\u201323 (2023)."
        },
        {
            "heading": "19. Tarashansky, A. J. et al. Mapping single-cell atlases throughout",
            "text": "Metazoa unravels cell type evolution. eLife 10, e66747 (2021). 20. Haghverdi, L., Lun, A. T. L., Morgan, M. D. & Marioni, J. C. Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors. Nat. Biotechnol. 36, 421\u2013427 (2018). 21. Korsunsky, I. et al. Fast, sensitive and accurate integration of singlecell data with Harmony. Nat. Methods 16, 1289\u20131296 (2019). 22. Liu, J. et al. Jointly defining cell types from multiple single-cell datasets using LIGER. Nat. Protoc. 15, 3632\u20133662 (2020). 23. Kriebel, A. R. & Welch, J. D. UINMF performs mosaic integration of single-cell multi-omic datasets using nonnegative matrix factorization. Nat. Commun. 13, 1\u201317 (2022). 24. Hie, B., Bryson, B. & Berger, B. Efficient integration of heterogeneous single-cell transcriptomes using Scanorama. Nat. Biotechnol. 37, 685\u2013691 (2019)."
        },
        {
            "heading": "25. Lopez, R., Regier, J., Cole, M. B., Jordan, M. I. & Yosef, N. Deep",
            "text": "generative modeling for single-cell transcriptomics. Nat. Methods 15, 1053\u20131058 (2018). 26. Xu, C. et al. Probabilistic harmonization and annotation of singlecell transcriptomics data with deep generative models. Mol. Syst. Biol. 17, e9620 (2021)."
        },
        {
            "heading": "27. Butler, A., Hoffman, P., Smibert, P., Papalexi, E. & Satija, R. Integrating single-cell transcriptomic data across different conditions,",
            "text": "technologies, and species. Nat. Biotechnol. 36, 411\u2013420 (2018). 28. Stuart, T. et al. Comprehensive integration of single-.Cell Data. Cell 177, 1888\u20131902.e21 (2019). 29. Hao, Y. et al. Integrated analysis ofmultimodal single-cell data.Cell 184, 3573\u20133587.e29 (2021)."
        },
        {
            "heading": "30. Tanay, A. & Seb\u00e9-Pedr\u00f3s, A. Evolutionary cell type mapping with",
            "text": "single-cell genomics. Trends Genet. 37, 919\u2013932 (2021). 31. Cunningham, F. et al. Ensembl 2022. Nucleic Acids Res. 50, D988\u2013D995 (2022)."
        },
        {
            "heading": "32. Miao, Z. et al. Putative cell type discovery from single-cell gene",
            "text": "expression data. Nat. Methods 17, 621\u2013628 (2020). 33. Franjic, D. et al. Transcriptomic taxonomy and neurogenic trajectories of adult human, macaque, and pig hippocampal and entorhinal cells. Neuron. https://doi.org/10.1016/j.neuron.2021.10. 036 (2021) 34. Wagner, D. E. et al. Single-cell mapping of gene expression landscapes and lineage in the zebrafish embryo. Science 360, 981\u2013987 (2018)."
        },
        {
            "heading": "35. Briggs, A. J. et al. The dynamics of gene expression in vertebrate",
            "text": "embryogenesis at single-cell resolution. Science 360, eaar5780 (2018). 36. McLellan, M. A. et al. High-resolution transcriptomic profiling of the heart during chronic stress reveals cellular drivers of cardiac fibrosis and hypertrophy. Circ. 142, 1448\u20131463 (2020)."
        },
        {
            "heading": "37. Osumi-Sutherland, D. et al. Cell type ontologies of the human cell",
            "text": "atlas. Nat. Cell Biol. 23, 1129\u20131135 (2021)."
        },
        {
            "heading": "38. Moreno, P. et al. Expression atlas update: gene and protein",
            "text": "expression in multiple species. Nucleic Acids Res. 50, D129\u2013D140 (2022). 39. Seurat. Fast Integration using Reciprocal PCA (RPCA). https:// satijalab.org/seurat/articles/seurat5_integration_rpca.html (2023). 40. Zeng, H. What is a cell type and how to define it? Cell 185, 2739\u20132755 (2022). 41. Shekhar, K. et al. Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics. Cell 166, 1308\u20131323.e30 (2016)."
        },
        {
            "heading": "42. Stamboulian, M., Guerrero, R. F., Hahn, M. W. & Radivojac, P. The ortholog conjecture revisited: The value of orthologs and paralogs",
            "text": "in function prediction. Bioinformatics 36, i219\u2013i226 (2020). 43. Studer, R. A. & Robinson-Rechavi, M. How confident can we be that orthologs are similar, but paralogs differ? Trends Genet. 25, 210\u2013216 (2009). 44. Kurtzer, G. M., Sochat, V. & Bauer, M. W. Singularity: scientific containers for mobility of compute. PLoS One 12, e0177459 (2017)."
        },
        {
            "heading": "45. Baron, M. et al. A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure.",
            "text": "Cell Syst. 3, 346\u2013360.e4 (2016)."
        },
        {
            "heading": "46. Liao, Y. et al. Cell landscape of larval and adult Xenopus laevis at",
            "text": "single-cell resolution. Nat. Commun. 13, 4306 (2022)."
        },
        {
            "heading": "47. Song, Y. Benchmarking strategies for cross-species integration of",
            "text": "single-cell RNA sequencing data. Zenodo https://doi.org/10.5281/ zenodo.8268784 (2023)."
        },
        {
            "heading": "Acknowledgements",
            "text": "Thisworkwas supportedby: the EuropeanMolecular Biology Laboratory (Y.S., Z.M., A.B., I.P.); the EMBL international PhD program (Y.S.); and the Biotechnology and Biological Sciences Research Council (BBSRC) grant \u2018Fly Cell Atlas\u2019 [BB/T014563/1] (I.P.)."
        },
        {
            "heading": "Author contributions",
            "text": "All authors conceived the project. Y.S. designed the framework and curated data, wrote the pipeline and software, performed data analysis andvisualisation,with supervision from I.P. and inputs fromZ.M. andA.B. Y.S. wrote the initial draft of the manuscript and all authors participated in review and editing."
        },
        {
            "heading": "Funding",
            "text": "Open Access funding enabled and organized by Projekt DEAL."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41467-023-41855-w. Correspondence and requests for materials should be addressed to"
        },
        {
            "heading": "Yuyao Song or Irene Papatheodorou.",
            "text": "Peer review information Nature Communications thanks Laleh Haghverdi and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. A peer review file is available. Reprints and permissions information is available at http://www.nature.com/reprints Publisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nNature Communications | (2023) 14:6495 16\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/ licenses/by/4.0/.\n\u00a9 The Author(s) 2023\nNature Communications | (2023) 14:6495 17"
        }
    ],
    "title": "Benchmarking strategies for cross-species integration of single-cell RNA sequencing data",
    "year": 2023
}