{
    "abstractText": "In response to the requirements of 5G and beyond, cell-free systems have emerged to ensure uniform service throughout the area. However, the idea of having no cells leads to a considerably large monolithic system, which is not scalable. In this context, common sense suggests the creation of clusters of Access Points (APs) and User Equipments (UEs) that allow the system to be managed locally to some extent. The clustering procedure has to ensure certain performance for the global system and, at the same time, ensure its scalability. In this paper, first, scalability is analyzed. Subsequently, we study and compare two clustering approaches for uplink and downlink. Finally, we propose a combination of clustering and resource allocation techniques that outperforms the rest of the analyzed state-of-the-art solutions. INDEX TERMS Cell-free massive Multiple-Input Multiple-Output (MIMO), scalability, clustering.",
    "authors": [
        {
            "affiliations": [],
            "name": "DANAISY PRADO-ALVAREZ"
        },
        {
            "affiliations": [],
            "name": "DANIEL CALABUIG"
        },
        {
            "affiliations": [],
            "name": "JOSE F. MONSERRAT"
        },
        {
            "affiliations": [],
            "name": "SAMER BAZZI"
        },
        {
            "affiliations": [],
            "name": "WEN XU"
        }
    ],
    "id": "SP:38bdc0cee76cb2ddf95c5e30e9fdac44175af85d",
    "references": [
        {
            "authors": [
                "H.Q. Ngo",
                "A. Ashikhmin",
                "H. Yang",
                "E.G. Larsson",
                "T.L. Marzetta"
            ],
            "title": "Cell-free massive MIMO versus small cells",
            "venue": "IEEE Transactions on Wireless Communications, vol. 16, no. 3, pp. 1834\u20131850, Mar. 2017. DOI: 10.1109/twc.2017.2655515.",
            "year": 1834
        },
        {
            "authors": [
                "S. Buzzi",
                "C. D\u2019Andrea"
            ],
            "title": "Cell-free massive MIMO: User-centric approach",
            "venue": "IEEE Wireless Communications Letters, vol. 6, no. 6, pp. 706\u2013709, Dec. 2017. DOI: 10.1109/lwc.2017.2734893.",
            "year": 2017
        },
        {
            "authors": [
                "G. Interdonato",
                "P. Frenger",
                "E.G. Larsson"
            ],
            "title": "Scalability aspects of cell-free massive MIMO",
            "venue": "ICC 2019 - 2019 IEEE International Conference on Communications (ICC), IEEE, May 2019. DOI: 10. 1109/icc.2019.8761828.",
            "year": 2019
        },
        {
            "authors": [
                "D. Calabuig",
                "R.H. Gohary",
                "H. Yanikomeroglu"
            ],
            "title": "Optimum transmission through the multiple-antenna Gaussian multiple access channel",
            "venue": "IEEE Transactions on Information Theory, vol. 62, no. 1, pp. 230\u2013243, 2016. DOI: 10.1109/TIT.2015.2502244.",
            "year": 2016
        },
        {
            "authors": [
                "M. Costa"
            ],
            "title": "Writing on dirty paper (corresp.)",
            "venue": "IEEE Transactions on Information Theory, vol. 29, no. 3, pp. 439\u2013441, 1983. DOI: 10.1109/ TIT.1983.1056659.",
            "year": 1983
        },
        {
            "authors": [
                "S. Vishwanath",
                "N. Jindal",
                "A. Goldsmith"
            ],
            "title": "Duality, achievable rates, and sum-rate capacity of Gaussian MIMO broadcast channels",
            "venue": "IEEE Transactions on Information Theory, vol. 49, no. 10, pp. 2658\u2013 2668, 2003. DOI: 10.1109/TIT.2003.817421.",
            "year": 2003
        },
        {
            "authors": [
                "E. Bj\u00f6rnson",
                "L. Sanguinetti"
            ],
            "title": "Scalable cell-free massive MIMO systems",
            "venue": "IEEE Transactions on Communications, vol. 68, no. 7, pp. 4247\u20134261, 2020. DOI: 10.1109/TCOMM.2020.2987311.",
            "year": 2020
        },
        {
            "authors": [
                "G. Interdonato",
                "E. Bj\u00f6rnson",
                "H.Q. Ngo",
                "P. Frenger",
                "E.G. Larsson"
            ],
            "title": "Ubiquitous cell-free massive MIMO communications",
            "venue": "EURASIP Journal on Wireless Communications and Networking, vol. 2019, no. 1, Aug. 2019. DOI: 10.1186/s13638-019-1507-0.",
            "year": 2019
        },
        {
            "authors": [
                "H. Huh",
                "H. Papadopoulos",
                "G. Caire"
            ],
            "title": "MIMO broadcast channel optimization under general linear constraints",
            "venue": "2009 IEEE International Symposium on Information Theory, 2009, pp. 2664\u20132668. DOI: 10.1109/ISIT.2009.5205911.",
            "year": 2009
        },
        {
            "authors": [
                "L. Zhang",
                "R. Zhang",
                "Y.-C. Liang",
                "Y. Xin",
                "H.V. Poor"
            ],
            "title": "On Gaussian MIMO BC-MAC duality with multiple transmit covariance constraints",
            "venue": "IEEE Transactions on Information Theory, vol. 58, no. 4, pp. 2064\u20132078, 2012. DOI: 10.1109/TIT.2011.2177760.",
            "year": 2012
        }
    ],
    "sections": [
        {
            "text": "INDEX TERMS Cell-free massive Multiple-Input Multiple-Output (MIMO), scalability, clustering.\nI. INTRODUCTION\nThe performance of systems based on a cell-centric design has always been limited by the interference experienced by User Equipments (UEs) at cell borders. New applications for Fifth Generation (5G) and beyond require seamless deployments to ensure uniform service over the entire area. A natural solution is the use of user-centric cell-free systems. In this context and considering massive Multiple-Input Multiple-Output (MIMO) as one of the enabling technologies of next-generation systems, cell-free massive MIMO [1] was proposed to overcome the high interference levels at the cell borders.\nNormally, when talking about cell-free massive MIMO, and due to the large number of antennas at the network side, the Access Points (APs) acquire the Channel State Information (CSI) through the use of uplink pilot signals sent by the UEs, and then this CSI is used in the design of precoders. To be able to use this CSI in the downlink, Time Division Duplexing (TDD) mode is considered. In general, at the APs, the signal is multiplexed/de-multiplexed, converted by the analog/digital and digital/analog converters, and processed by the base-band (BB) unit. On the other hand, a Central Processing Unit (CPU) is in charge of the coordination among all APs.\nSome challenges arise when implementing the canonical form of cell-free massive MIMO described before. First,\nsince all APs must be connected to the same CPU via fronthaul, the system has to withstand a considerable amount of traffic and signaling, which increases the computational requirements of the CPU and the front-haul capacity demands. This problem can be tackled via a user-centric approach, so that a given UE is served by a subset of APs close to it that share a CPU, helping to relax the front-haul performance requirements significantly [2]. In [3], the authors described four network deployments going from the conventional cellular network to a cell-free massive MIMO network considering a user-centric approach. In this work, several practical aspects are analyzed such as the cost and complexity of the deployment, limited capacity of back/front-haul connections, and network synchronization. It is important to remember that the objective of cell-free massive MIMO is to reduce the interference at the cell borders of traditional cellular systems. Therefore, the subset of APs for each UE has to be selected taking this objective into account. In this line, it is possible to identify two different clustering approaches depending on how interference is reduced. The first approach creates a different cluster for each UE, locating the UEs at the center of their clusters. In this case, the cluster border is distanced as much as possible. The second approach includes many UEs in the same cluster and uses interference cancellation techniques to reduce the interference.\nIn this work, we will analyze these two approaches for up-\nVOLUME 4, 2016 1\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nPrado-Alvarez et al.: Study of Clustering Solutions for Scalable Cell-Free Massive MIMO\nlink and downlink under different scenarios in order to figure out which would be the most suitable in terms of achievable data rate under certain circumstances. Based on the obtained results, we will propose a combination of clustering and resource allocation techniques that outperforms the current solutions in the literature.\nThe reminder of this paper is organized as follows. In Section II, the system model is presented. Afterward, the scalability concept is analyzed in Section III. Section IV describes the two previously mentioned clustering approaches. The performance of particular clustering solutions from the two approaches with the corresponding resource allocation techniques is evaluated in Section V for the uplink, and in Section VI for the downlink. Finally, Section VII draws the conclusion.\nII. SYSTEM MODEL In this work, a cell-free massive MIMO system with clusters is considered. In particular, we define the system S = {{Lm}Mm=1, {Km}Mm=1} as a system with M clusters of single-antenna APs and UEs. The APs and UEs in the mth cluster are those in Lm and Km, respectively. We assume that the UEs are exactly in one of those clusters, although APs can be in several clusters, i.e., Km \u2229 Kn = \u2205 for all m \u0338= n, but this is not necessarily true for any pair of sets in {Lm}Mm=1. The amount of APs and UEs in the system is L = | \u222aMm=1 Lm| and K = | \u222aMm=1 Km|, respectively.\nLet m\u0303(k) be the cluster the k-th UE belongs to. Without loss of generality, we index the UEs in the same cluster continuously, i.e., the UEs in the m-th cluster are those with indices k\u0303(m\u22121)+1, k\u0303(m\u22121)+2, . . . , k\u0303(m), where k\u0303(m) is the largest index of the UEs in the m-th cluster, and k\u0303(0) = 0. The channel between the k-th UE and the APs of the mth cluster is denoted by Hkm \u2208 C|Lm|, where |Lm| is the amount of APs in the m-th cluster.\nInterference cancellation techniques are used for the set of UEs in each cluster. In particular, some interference cancellation is performed between the UEs 1, 2, . . . , k\u0303(1), also between the UEs k\u0303(1) + 1, . . . , k\u0303(2), etc.\nAs a performance measure of the system, the total sum data rate is calculated for both uplink and downlink. In the case of the uplink, Successive Interference Cancellation (SIC) [4] is considered in the decoding. This algorithm consists of (i) decoding the signal of the first UE considering the signal of the rest as interference, (ii) subtracting the signal decoded from the first UE from the received signal, (iii) decoding the signal of the second UE considering the signal from the third UE onwards as interference, and so on. This reception technique is known to be capacity-achieving if all the sources of interference have a known covariance. Specifically, since the decoding order does not affect the sum rate [5], we assume that the first signal to be decoded is the one corresponding to the UE with the highest index, i.e., the UE k\u0303(m) of the m-th cluster, and then we follow the decreasing order of the indices. Therefore, the achievable data rate of the k-th UE in the uplink with an identity noise\ncovariance is as shown in (1) at the beginning of the next page, where P is the available power at the UEs. In (1), the interference has been divided into two terms according to its origin. In the numerator, the first term is the noise covariance; the second term includes the interference from UEs in clusters with indices m < m\u0303(k), the interference from the UEs in the same cluster, and the signal of the kth UE; and the third term includes the interference from the UEs in clusters with indices m > m\u0303(k). In the denominator, the terms are similar except for the fact that the signal of the k-th UE is not included.\nAnalogously, in the case of the downlink, Dirty Paper Coding (DPC) [6] is considered. This coding technique consists of adapting the codebooks of the transmitter to a known interference in such a way that the interference does not affect the achievable rate. Therefore, the CPU of the AP cluster can (i) encode the signal of the first UE, (ii) treat this signal as a known interference for the second UE, and so on. In this case, the first UE sees the signal from the other UEs as interference, the second UE sees the signal from the third UE onwards as interference, etc. As in the case of SIC, this encoding technique is known to be capacity-achieving if all the sources of interference have a known covariance. Some works found an uplink-downlink duality when SIC and DPC are used [7]. In particular, the achievable rates are the same. In [7], it is shown that the DPC encoding order that achieves certain achievable rates is the reversed SIC decoding order of the dual uplink system. Following this principle, we assume that the encoding order is the reversed order considered for the uplink, i.e., the encoding follows the increasing order of the UEs\u2019 indices. Therefore, the achievable data rate of the k-th UE in the downlink with an identity noise covariance is shown in (2) at the beginning of the next page, where Qk is the transmit covariance matrix of the k-th UE. In (2), the interference has also been divided into two terms according to its origin, and in a similar manner as in (1). Since single-antenna UEs are considered, it is not needed to include determinants in the equation."
        },
        {
            "heading": "III. ANALYSIS OF THE SCALABILITY",
            "text": "Cell-free massive MIMO systems in their canonical form rely on the cooperation of the L APs to serve the K UEs, i.e., M = 1. This implies that, as the network grows, so do the computational requirements of the network and the volume of data and signaling that has to be exchanged between each AP and each UE. Due to this, these systems are said to be non-scalable. It is therefore important to find solutions with superior performance and good scalability with the network size. To do this, it is important to agree on the main features that a scalable system should satisfy. Then, we could design systems with such features. In this section, we analyze a scalability definition from the state of the art, and subsequently, we propose a new definition."
        },
        {
            "heading": "2 VOLUME 4, 2016",
            "text": "This work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nPrado-Alvarez et al.: Study of Clustering Solutions for Scalable Cell-Free Massive MIMO\nRULk = log |I + P\n\u2211k i=1 Him\u0303(k)H \u2217 im\u0303(k) + P \u2211K i=k\u0303(m\u0303(k))+1 Him\u0303(k)H \u2217 im\u0303(k)|\n|I + P \u2211k\u22121\ni=1 Him\u0303(k)H \u2217 im\u0303(k) + P \u2211K i=k\u0303(m\u0303(k))+1 Him\u0303(k)H \u2217 im\u0303(k)| . (1)\nRDLk = log 1 +\n\u2211k\u0303(m\u0303(k)\u22121) i=1 H \u2217 km\u0303(i)QiHkm\u0303(i) + \u2211K i=k H \u2217 km\u0303(i)QiHkm\u0303(i)\n1 + \u2211k\u0303(m\u0303(k)\u22121)\ni=1 H \u2217 km\u0303(i)QiHkm\u0303(i) + \u2211K i=k+1 H \u2217 km\u0303(i)QiHkm\u0303(i) . (2)\nA. STATE-OF-THE-ART DEFINITION In [8], the authors formally defined that the network is scalable if the following tasks have finite complexity and resource requirements for each AP as the number of UEs, K, tends to \u221e:\n1) Signal processing for channel estimation; 2) Signal processing for data reception and transmission; 3) Front-haul signaling for data and CSI sharing; 4) Power control optimization. In [3], a solution was proposed and considered to be fully scalable. The solution is based on the definition of fixed clusters of APs, each of them connected to a different CPU. Each UE selects the best-server AP and a set of serving APs, up to a maximum quantity of APs. The CPU of the best-server is in charge of the channel estimation and the reception/transmission processing. This processing and channel estimation is done independently for each UE and takes into account only the serving APs. Therefore, even in the worst case (all UEs require the maximum amount of serving APs), the total resource requirements of this solution increase linearly with the amount of UEs in the network. When the network grows, all, the amount of UEs, APs, and CPUs grow with the same proportion and, hence, both the amount of UEs and the available resources grow with the same proportion. As a consequence, the system is scalable. However, this scalability claimed in [3] was questioned by [8], since [3] does not explicitly limit the number of UEs that can connect to one AP.\nThis raises the question of whether all the criteria in the scalability definition in [8] are necessary in practice. For instance, although one can argue the necessity of limiting the amount of UEs that can be served by one AP, the reality is that many works in the literature dealing with resource allocation problems do not consider this limitation. This is due to two main reasons. First, it is unlikely to saturate the APs by the amount of UEs, specially considering deployments with more APs than UEs like in cell-free massive MIMO systems. Second, real systems have access control mechanisms to avoid this situation. In this sense, we wonder whether it is reasonable to criticize the scalability of the solution in [3] because the amount of UEs served by an AP is not explicitly limited.\nB. PROPOSED DEFINITION From our point of view, the definition of scalability should take into account the system viability in terms of computation\nand resource requirements as the system increases in size. To do this, we have to discuss first when a system is viable. In this context, we can define viability using the system denial of service probability, i.e., the probability that a UE cannot be served by the system due to the lack of computational, front-haul or radio resources. Let Dk be the denial of service probability for the k-th UE. Then, the denial of service probability of the system S is defined as\nPD(S) = lim K\u2032\u2192K\n1\nK \u2032 K\u2032\u2211 k=1 Dk. (3)\nThis definition is valid for both the case K = \u221e, and the case K < \u221e. In the latter, this definition can be rewritten as PD(S) = 1K \u2211K k=1 Dk. We say that a system is viable if the denial of service probability is below a maximum threshold, i.e., PD(S) \u2264 Pmax < 1.\nLet Sm = {{Lm}, {Km}} be a subsystem of the system S composed of the m-th cluster alone, whose denial of service probability is PD(Sm). Considering that the m-th cluster is viable, i.e., PD(Sm) \u2264 Pmax, more clusters can be added without affecting the viability of the system if they are designed to meet the same criterion. This is explained by the fact that the availability of computational, front-haul, and radio resources of a cluster does not depend on the rest of the system. It is worth noticing that with the increase in UEs, these may experience a deterioration of the received signal but this is caused not by a reduction in the radio resources available, but by interference. Considering that for the k-th UE the denial of service probability is Dk = PD(Sm\u0303(k)), we say that the system is viable since following (3), we get, PD(S) \u2264 Pmax. In other words, if we design viable clusters, the overall system composed of those clusters will also be viable, and certainly, scalable.\nWe now look at the canonical cell-free massive MIMO case, where a unique CPU manages the reception and transmission to all UEs, and collects CSI information from all APs. Taking into account that the CPU computational capabilities, as well as the front-haul resources, are limited, the number of UEs with Dk < 1 is finite. This means that if K = \u221e, the result of (3) is 1. In other words, the canonical cell-free massive MIMO system is not viable, and of course, not scalable. Note that this conclusion is valid even if we provide the CPU with infinite computational capabilities, i.e., the front-haul still makes the system not scalable.\nVOLUME 4, 2016 3\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nPrado-Alvarez et al.: Study of Clustering Solutions for Scalable Cell-Free Massive MIMO\nTherefore, using our (less restrictive) definition of scalability, clustering ensures the scalability of the system, if cooperation between clusters is not allowed.\nIV. CLUSTERING APPROACHES As shown in Section III, the solution to guarantee scalability is self-presenting: divide and conquer. However, the division of the network into clusters and the posterior allocation of resources should be done in a smart way, trying to take full advantage of the flexibility of cell-free deployments and user-centric solutions. In this sense, our work focuses on the study of the strengths and weaknesses of current clustering solutions with the aim of proposing more advanced solutions to achieve better performance.\nIn what follows, two clustering approaches are analyzed. The first approach focuses on ensuring that the UEs are closed to the center of the cluster, thus avoiding edge effects. In the extreme case of this approach, the UEs are placed at the center creating a cluster of APs for each individual UE. Due to this, each cluster of APs serves only one UE as shown in Figure 1. This approach requires the highest number of CPUs in a particular area. However, in this case, each CPU can have lower computational capabilities than in other cases where a CPU has to serve several UEs. These clusters can be overlapping. The second approach includes several UEs in each cluster of APs and focuses on using interference cancellation techniques within each cluster to reduce the effect of interference. In the extreme case of this approach, the AP clusters are enlarged as much as possible including all the UEs in their coverage area in order to maximize the amount of canceled interference in the clusters. This produces disjoint clusters as shown in Figure 2. For the same average amount of APs in each cluster, the disjoint cluster approach is the one that requires the lowest number of clusters in a particular area, hence, the lowest number of CPUs. However, in this case, each CPU needs to serve the highest amount of UEs. Therefore, this solution demands more powerful CPUs but, at the same time, a smaller number of them.\nIt is worth noticing that the channel estimation and signaling overheads do not depend directly on the clustering approach but on the number of APs in each cluster and is linearly proportional to the total number of UEs served. Synchronization is also a critical aspect. With this respect, in [3], a synchronization mechanism is proposed, which could be used in any of the clustering approaches. With this synchronization mechanism, the overhead is proportional to the number of APs each AP is collaborating with and to the number of clusters that contain each pair of AP.\nIn the following sections, these two approaches are compared in terms of sum data rate. For this purpose, first, different clustering techniques are analyzed for both uplink and downlink. Then, conclusions are reached on the suitability of using one clustering solution or another, depending on the characteristics of the scenario and the inherent needs of each of the transmission modes."
        },
        {
            "heading": "V. ANALYSIS OF THE CLUSTERING SOLUTIONS FOR THE UPLINK",
            "text": "In this section, we present a clustering solution for each of the two clustering approaches described in Section IV for the uplink. Subsequently, we study the performance of the two solutions in a particular scenario to gain insights into the performance of the two clustering approaches."
        },
        {
            "heading": "A. USER-AT-CENTER",
            "text": "This solution is part of the first clustering approach in Section IV. Therefore, each UE is at the center of a customdesigned cluster and therefore does not experience edge effects. The clusters of different UEs can overlap. In [8], the clusters are formed according to the following procedure. The UE appoints the AP with the strongest large-scale fading channel coefficient as its master AP. The maximum amount of UEs that one AP can serve is limited. So, when the UE requests the service, the AP will assign the channel it considers to be the least affected by interference from the other UEs it serves. The master AP informs a limited set of neighboring APs that it is going to serve this UE. In particular, the informed APs are those whose channel with"
        },
        {
            "heading": "4 VOLUME 4, 2016",
            "text": "This work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nPrado-Alvarez et al.: Study of Clustering Solutions for Scalable Cell-Free Massive MIMO\nthe UE is at most a \u201cthreshold\u201d weaker than the channel of the master AP. Then, the informed APs decide whether they serve the UE or not. To make this decision, the APs have to take into account other UEs they are serving. Using this clustering solution, as many clusters as UEs are created, with the UEs being relatively centered in their respective clusters. This implies that the last UE of the m-th cluster is m, i.e., k\u0303(m) = m and the cluster where the k-th UE belongs to is k, i.e., m\u0303(k) = k. Considering this, the achievable data rate of the k-th UE for uplink and downlink results in, respectively,\nRUL-UaCk = log |I + P\n\u2211K i=1 HikH \u2217 ik|\n|I + P \u2211K\ni=1,i\u0338=k HikH \u2217 ik|\n, (4)\nRDL-UaCk = log 1 +\n\u2211K i=1 H \u2217 ikQiHik\n1 + \u2211K\ni=1,i\u0338=k H \u2217 ikQiHik\n. (5)\nSince this clustering solution creates a different AP cluster for each UE, it is not possible to cancel interference between any of the UEs. Therefore, all the UEs in this scenario are considered interferers by the k-th UE.\nB. DISJOINT CLUSTERS This solution is part of the second clustering approach in Section IV. For this solution, the APs are grouped into nonoverlapping clusters of a specific size, i.e., |Lm| = N for all m. Regarding the UE clusters, the clustering process is as follows. First, the UEs select their master APs as in the previous solution, i.e., the APs with the strongest large-scale fading channel coefficient. Then, the m-th UE cluster is composed of the UEs whose master AP is in the m-th AP cluster. It is clear that, following this clustering process, the UE clusters are composed of several UEs in general. Therefore, since the signals of the UEs in the same cluster are processed by the same CPU, some interference cancellation technique could be used for the decoding/encoding. However, UEs are not prevented from suffering cluster border effects.\nC. COMPARISON OF SOLUTIONS FOR UPLINK In this section, we study the performance of the two previous clustering solutions in a particular scenario. The scenario is a square of 32 by 32 ceiling-mounted APs in a squared grid with an inter-AP distance of 10 m. In order to avoid scenario border effects, a wrap-around technique is implemented. The UEs are randomly distributed in the scenario. The heights of APs and UEs are 6 m and 1.5 m respectively. The channel model used is the \u201cIndustrial indoor scenario\u201d presented in [9]. The UEs have 10 mW of available power, and the noise power at the receivers is 1.5887 \u00b7 10\u221210 mW, which corresponds to the noise power at 15 \u25e6C and a transmission bandwidth of 20 MHz. In this scenario, the AP clusters of the \u201cdisjoint clusters\u201d (DC) solution are squared groups of APs located in a squared grid over the scenario.\nFirst, the results for several configurations of the \u201cuser-atcenter\u201d (UaC) solution are obtained. From one configuration to the other the only parameter that changes is the maximum\nnumber of UEs that can be served by one AP, denoted by \u03b1. As shown in Figure 3, the average data rate per UE decreases as the number of UEs in the scenario increases. This decrement can be softened by allowing each AP to serve more UEs, i.e. by increasing \u03b1.\nIn the case of the UaC solution, the size of the AP clusters is variable. Assuming that the master AP of each UE informs all APs in the scenario to create the AP cluster of this UE, then all APs serve min(K,\u03b1) UEs. Using this assumption, we can compute the average AP cluster size as Lmin(K,\u03b1)/K. For instance, in the case of 256 UEs and \u03b1 = 16, the average cluster size is 1024\u00d7 16/256 = 64. In order to facilitate the comparison between the UaC solution and the DC solution for different cluster sizes, we will compare the data rate of certain average cluster size of the UaC solution with the data rate of the same cluster size of the DC solution.\nFigure 4 shows the average data rate per UE versus the total number of UEs in the scenario for UaC and DC solutions\nVOLUME 4, 2016 5\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nPrado-Alvarez et al.: Study of Clustering Solutions for Scalable Cell-Free Massive MIMO\nfor cluster sizes of 16, 64 and 256 APs. The figure also shows the average data rate for canonical cell-free massive MIMO with and without interference cancellation as a benchmark. Note that canonical cell-free massive MIMO without interference cancellation is a particularization of the UaC solution, whereas canonical cell-free massive MIMO with interference cancellation is a particularization of the DC solution, both for N = 1024. In Figure 4, when cluster sizes of 16 APs and 64 APs or less than 64 UEs are considered, the compared solutions have similar behaviour. However, when considering clusters of 256 APs and more than 64 UEs, the DC solution clearly outperforms the UaC solution. Objectively speaking, according to what it is shown, there is no solution whose performance prevails over the other for any number of UEs. This motivates the definition of a mixed solution in the following section.\nD. MIXED SOLUTION FOR THE UPLINK This solution is inspired by the idea of merging the best of the previous solutions: the avoidance of border effects and the possibility of applying interference cancellation. The UE and AP clustering is performed as follows. First, the APs are grouped into non-overlapping cluster cores as for the disjoint clusters approach. Then, more APs are added to those clusters. The criterion to follow for such cluster addition could be, e.g., proximity. As a result, the cores will be surrounded by other APs of their clusters. Second, each UE is linked to its best-serving AP, as previously. The cluster of UEs served by each AP cluster is the set of UEs linked to the APs in the corresponding core. The latter implies that the cluster of UEs is centered with respect to the cluster of APs preventing them from experimenting edge effects. Figure 5 illustrates this solution. In the figure, four clusters are delimited by colored solid lines. The core of each cluster is formed by the APs that have the same color as the mentioned lines. The UEs are represented in the color of the cluster they are served by. For the sake of simplicity, for the results in this section and for the same scenario described in the previous section, the AP clusters are assumed to be squares of \u221a |Lm| \u00d7 \u221a |Lm| APs, whereas the cluster cores\nare squares of \u221a |Lm|/2\u00d7 \u221a |Lm|/2 APs at the center of the corresponding cluster, for m = 1, . . . ,M . In Figure 6 the achievable data rate per UE for a cluster average size of 256 APs is shown for the UaC, the DC and the mixed solutions. The curve of the UaC solution was obtained following the procedure explained in Figure 4. As can be noticed, the performance with the mixed solution is better than the UaC and the DC solutions. Therefore, in this case, the best performance is not obtained by only (i) avoiding the cluster border effects or (ii) canceling all the interference of UEs with the master AP in the cluster. In this case, we need to use a solution that mixes the two clustering approaches. In any case, the DC solution is the most similar to the mixed solution. This highlights the importance of canceling interference."
        },
        {
            "heading": "VI. ANALYSIS OF THE CLUSTERING SOLUTIONS FOR THE DOWNLINK",
            "text": "In the uplink, the APs can be considered passive receivers, since they just need to send the signal received to the corresponding CPUs. However, in the downlink, the APs are actively transmitting so the available power needs to be allocated to each of those transmissions. This power allocation becomes more challenging if the clusters are overlapping. In that case, as each AP could be connected to more than one CPU, all the CPUs involved would have to cooperate and this could lead to a non-scalable system. In order to preserve the scalability of the system, suboptimal strategies should be considered. One of the options is to allocate power equally as will be detailed later in Section VI-A for the UaC solution. Another option would be to design a scheme to make a fixed pre-allocation of power and then optimize the power allocation in each cluster. However, there is no clear criterion for such pre-allocation. Due to this and in order to simplify the subsequent analysis, we will not consider a mixed solution, which requires the APs to pre-allocate power to all the clusters they belong to."
        },
        {
            "heading": "6 VOLUME 4, 2016",
            "text": "This work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nPrado-Alvarez et al.: Study of Clustering Solutions for Scalable Cell-Free Massive MIMO\nA. USER-AT-CENTER According to [8], in the downlink, the AP clusters are created as explained in Section V-A. We recall that this clustering solution produces overlapping AP clusters that serve only one UE each. Moreover, since the APs serve a maximum of \u03b1 UEs (or belong to a maximum of \u03b1 clusters), they split their available power into this amount of UEs. This implies that the APs pre-allocate a certain amount of power for the different clusters they belong to. Letting P be the available power at the APs, they use a maximum of P/\u03b1 for each UE or cluster [8]. The actual power used to transmit to the UEs is obtained by multiplying P/\u03b1 by a normalized precoding vector, which, in the case of the k-th UE, is computed as\nwk = Hkk |Hkk| . (6)\nThen, the power used by the l-th AP of the k-th cluster to transmit to the k-th UE is\nP \u03b1 |wkl|2 \u2264 P \u03b1 , (7)\nwhich indicates that the total power used to transmit to the UEs by all APs is, indeed, P/\u03b1. This power allocation, which is proposed in [8], ensures the APs do not use more power than P , although in a very conservative way. In particular, on average, the APs use significantly less power than P to transmit to all the UEs. In order to illustrate this fact, we assume that each AP serves exactly \u03b1 UEs. Then, the average amount of APs serving each UE is\nLserving = L\u03b1\nK . (8)\nAs mentioned before, the total power used to transmit to each UE is P/\u03b1, which is split into the APs serving this UE. Therefore, the average power used per AP and UE is P/\u03b1Lserving. Since the APs serve \u03b1 UEs, the average total power used per AP is\nP\n\u03b1Lserving \u03b1 =\nPK L\u03b1 . (9)\nWe consider here two numerical examples. If \u03b1 = 4, K = 256, and L = 1024, the average total power used per AP would be P/16, and if \u03b1 = 8, K = 64, and L = 1024, the average drops to P/128. This conclusion is quite striking, as it shows that a large part of the available power is unused.\nB. DISJOINT CLUSTERS As in the case of the uplink, we can also consider the creation of disjoint clusters in the downlink with size |Lm| = N for all m. As discussed before, the resource allocation in each cluster should not be conditioned to the particular allocation performed in neighboring clusters. If not, the effect of each cluster would propagate throughout the scenario, making the resource allocation not scalable. In order to avoid this scalability problem, we propose to perform the resource allocation in each cluster as if they were isolated from the rest, i.e., assuming that the interference from the other clusters do not\naffect their UEs. Without loss of generality, we are going to particularize this resource allocation for the first cluster, i.e., m = 1. In this case, and taking into account that we neglect the interference from other clusters, the achievable rate of the k-th UE is, using (2),\nRDL-2k ({Qi} k\u0303(1) i=1 ) = log\n1 +H\u2217k1 (\u2211k\u0303(1) i=k Qi ) Hk1\n1 +H\u2217k1 (\u2211k\u0303(1) i=k+1 Qi ) Hk1 , (10)\nfor k = 1, . . . k\u0303(1). The rate expression in (10) is the one used for the resource allocation, i.e., the computation of the transmit covariances {Qi}k\u0303(1)i=1 . However, the actual achievable rate is shown in (2), which takes all the interference into account. The expression in (10) is the one used in the following section to compute the achievable rate in the figures.\nTo obtain the transmit covariances, we propose to maximize the sum data rate in the cluster taking into account the limited available power in the APs. Mathematically, for the cluster m = 1, we want to solve\nmax {Qk}k\u0303(1)k=1 k\u0303(1)\u2211 k=1 RDL-2k ({Qi} k\u0303(1) i=1 ),\ns.t. Qk \u2ab0 0, k = 1, . . . , k\u0303(1), k\u0303(1)\u2211 k=1 qkl \u2264 P, l = 1, . . . , N,\n(11)\nwhere qkl is the l-th element of the main diagonal of Qk. To find a solution for (11), we can use the algorithm proposed in [10], which is based on [11]. With the optimum transmit covariance matrices in (11), the APs use all their available power. It is worth recalling that this solution is optimum locally, i.e., for one isolated cluster. The use of all the available power can be dangerous in terms of the interference caused to other clusters. Due to this, we also consider a different resource allocation.\nFor the alternative resource allocation, we consider that the available power can be shared among all the APs in the cluster. By doing this, the optimum covariance matrices contain, in the eigenvectors, the optimum precoding matrices without the limitation of the power constraints. These precoding matrices define the optimum power distribution to maximize the data rate. Due to this, we propose to use a scaled version of these covariance matrices. The scaling is necessary to ensure that the power constraints are met. More specifically, we solve\nmax {Qk}k\u0303(1)k=1 k\u0303(1)\u2211 k=1 RDL-2k ({Qi} k\u0303(1) i=1 ),\ns.t. Qk \u2ab0 0, k = 1, . . . , k\u0303(1), k\u0303(1)\u2211 k=1 Qk \u2264 NP.\n(12)\nVOLUME 4, 2016 7\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nPrado-Alvarez et al.: Study of Clustering Solutions for Scalable Cell-Free Massive MIMO\nLet {Q\u0304k}k\u0303(1)k=1 be the optimum solution of (12). In general, these covariance matrices do not satisfy the individual power constraints in each AP. Due to that, we compute\nQk = P\nmaxl (\u2211k\u0303(1) k=1 q\u0304kl ) Q\u0304k, k = 1, . . . , k\u0303(1), (13) where q\u0304kl is the l-th element of the main diagonal of Q\u0304k. The covariance matrices {Qk}k\u0303(1)k=1 in (13) satisfy the power constraints in each AP and, since they are scaled versions of {Q\u0304k}k\u0303(1)k=1, they have the same eigenvectors and, hence, they define the same precoding matrices. The optimization problem in (12) can be solved with the algorithm presented in [10], or with other techniques that make use of the uplinkdownlink duality like in [12] and in [7].\nC. COMPARISON OF SOLUTIONS FOR DOWNLINK In this section, we study the performance of the two previous clustering solutions in the same scenario described in Section V-C, with the same available power at the APs and the same noise power at the receivers. We start showing the achievable sum data rate with different configurations of the UaC solution. Figure 7 shows the sum data rate versus the number of UEs for the UaC solution for different values of \u03b1, i.e., the maximum number of UEs that each AP can serve. As it can be observed, the difference between the curves is not significant, even considering cases where the average total power used per AP is very low (see Section VI-A). This suggests that the system is limited by interference.\nRegarding the DC solution, the two power allocation approaches presented are compared for N = 16 and N = 64 in Figure 8. In the legend, the results corresponding to the cluster-optimal resource allocation are labeled as \u201cLocal Opt.\u201d, whereas the results of the suboptimal resource allocation are labeled as \u201cSubopt.\u201d. The results highlight that, although the optimal resource allocation per cluster (neglecting inter-cluster interference) allows for achieving higher per-cluster rate values, the effect of interference makes\nthe total data rates worse than those obtained with the suboptimal resource allocation algorithm. In other words, by using all the available power in the APs, the sum data rate is more affected by the interference than benefiting from the transmitted power.\nFigure 9 shows the sum data rate versus the number of UEs for the best result obtained for UaC, i.e. \u03b1 = 1, the DC solution with suboptimal resource allocation for cluster sizes, N , equal to 4, 16, 64, 256, and the canonical cell-free massive MIMO with DPC. The latter corresponds to the DC solution with N = 1024. As can be observed, the DC solution shows a better performance than the UaC solution. Specifically, the performance could improve by 2.5 times for N = 256 and 256 UEs in the scenario. Note also that the rate improvement from one cluster size to another is almost constant, e.g., the absolute rate improvement from the N = 4 case to the N = 16 case is similar to that from the N = 16 case to the N = 64 case. An exception is the rate improvement from the N = 256 case to the N = 1024 case. As mentioned before, the latter case corresponds to canonical cell-free massive MIMO. Since, in this case, there is only one cluster, this cluster does not suffer from external interference, and this is the cause of the extra rate gain between the N = 256 and the N = 1024 cases."
        },
        {
            "heading": "VII. CONCLUSION",
            "text": "In this work, we studied scalability issues of cell-free massive MIMO. After considering a scalability definition presented in the literature, we proposed a new definition that is less restrictive and includes more systems that are intuitively scalable.\nWe also studied two clustering approaches to design scalable cell-free massive MIMO systems. The first approach is to design clusters for each UE in such a way that the UEs are at the center of their clusters, hence avoiding clusteredge effects. The second approach is to include several UEs in each cluster to be able to use interference cancellation techniques inside each cluster. In the case of the uplink, none"
        },
        {
            "heading": "8 VOLUME 4, 2016",
            "text": "This work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nPrado-Alvarez et al.: Study of Clustering Solutions for Scalable Cell-Free Massive MIMO\nof the two approaches seem to be the best for all cluster sizes and amounts of UEs. This motivated the development of a clustering solution that mixes the two approaches. This solution showed the best performances in all tested configurations. In the case of the downlink, whether or not the clustering solution allows overlapping AP clusters has a major impact on the performance. In particular, in order to avoid a global optimization to make the system scalable, if an AP belongs to several clusters, pre-allocating certain amount of power to each cluster is needed. This is an additional resource management procedure not present in the uplink. This power pre-allocation makes APs underutilize their available power. Due to this, a disjoint clustering solution that follows the second approach, i.e., interference cancellation, provided the best performance.\nREFERENCES [1] H. Q. Ngo, A. Ashikhmin, H. Yang, E. G. Larsson, and T. L.\nMarzetta, \u201cCell-free massive MIMO versus small cells,\u201d IEEE Transactions on Wireless Communications, vol. 16, no. 3, pp. 1834\u20131850, Mar. 2017. DOI: 10.1109/twc.2017.2655515. [2] S. Buzzi and C. D\u2019Andrea, \u201cCell-free massive MIMO: User-centric approach,\u201d IEEE Wireless Communications Letters, vol. 6, no. 6, pp. 706\u2013709, Dec. 2017. DOI: 10.1109/lwc.2017.2734893. [3] G. Interdonato, P. Frenger, and E. G. Larsson, \u201cScalability aspects of cell-free massive MIMO,\u201d in ICC 2019 - 2019 IEEE International Conference on Communications (ICC), IEEE, May 2019. DOI: 10. 1109/icc.2019.8761828. [4] S. Verdu et al., Multiuser detection. Cambridge university press, 1998. [5] D. Calabuig, R. H. Gohary, and H. Yanikomeroglu, \u201cOptimum transmission through the multiple-antenna Gaussian multiple access channel,\u201d IEEE Transactions on Information Theory, vol. 62, no. 1, pp. 230\u2013243, 2016. DOI: 10.1109/TIT.2015.2502244. [6] M. Costa, \u201cWriting on dirty paper (corresp.),\u201d IEEE Transactions on Information Theory, vol. 29, no. 3, pp. 439\u2013441, 1983. DOI: 10.1109/ TIT.1983.1056659. [7] S. Vishwanath, N. Jindal, and A. Goldsmith, \u201cDuality, achievable rates, and sum-rate capacity of Gaussian MIMO broadcast channels,\u201d IEEE Transactions on Information Theory, vol. 49, no. 10, pp. 2658\u2013 2668, 2003. DOI: 10.1109/TIT.2003.817421. [8] E. Bj\u00f6rnson and L. Sanguinetti, \u201cScalable cell-free massive MIMO systems,\u201d IEEE Transactions on Communications, vol. 68, no. 7, pp. 4247\u20134261, 2020. DOI: 10.1109/TCOMM.2020.2987311.\n[9] G. Interdonato, E. Bj\u00f6rnson, H. Q. Ngo, P. Frenger, and E. G. Larsson, \u201cUbiquitous cell-free massive MIMO communications,\u201d EURASIP Journal on Wireless Communications and Networking, vol. 2019, no. 1, Aug. 2019. DOI: 10.1186/s13638-019-1507-0. [10] H. Huh, H. Papadopoulos, and G. Caire, \u201cMIMO broadcast channel optimization under general linear constraints,\u201d in 2009 IEEE International Symposium on Information Theory, 2009, pp. 2664\u20132668. DOI: 10.1109/ISIT.2009.5205911. [11] L. Zhang, R. Zhang, Y.-C. Liang, Y. Xin, and H. V. Poor, \u201cOn Gaussian MIMO BC-MAC duality with multiple transmit covariance constraints,\u201d IEEE Transactions on Information Theory, vol. 58, no. 4, pp. 2064\u20132078, 2012. DOI: 10.1109/TIT.2011.2177760. [12] W. Yu, \u201cUplink-downlink duality via minimax duality,\u201d IEEE Transactions on Information Theory, vol. 52, no. 2, pp. 361\u2013374, 2006. DOI: 10.1109/TIT.2005.862102.\nDANAISY PRADO-ALVAREZ graduated in Electronics and Telecommunication Engineering in 2015 at Technological University of Havana \u201cJos\u00e9 Antonio Echeverr\u00eda\u201d, Cuba. She received her M.Sc. degree in Telecommunication Technologies, Systems, and Networks and her Ph.D. degree in Telecommunications from the Universitat Polit\u00e8cnica de Val\u00e8ncia (UPV) in 2017 and 2022, respectively. In 2018, she joined the iTEAM Research Institute of the Universitat Polit\u00e8cnica de\nVal\u00e8ncia, Valencia, Spain. Her current research interests are focused on 5G&6G wireless technologies design, channel modeling, network planning and resource allocation.\nDANIEL CALABUIG (M\u201911) received the M.Sc. and Ph.D. degrees in telecommunications from the Universitat Polit\u00e8cnica de Val\u00e8ncia (UPV), Valencia, Spain, in 2005 and 2010 respectively. In 2005 he joined the Instituto de Telecomunicaciones y Aplicaciones Multimedia (iTEAM) from the UPV. During his Ph.D. he participated in some European projects and activities like NEWCOM, COST2100 and ICARUS, working on radio resource management in heterogeneous wireless systems and\nHopfield neural networks optimization. In 2010 he obtained a Marie Curie Fellowship from the European Commission to research on cooperative multipoint transmissions. Thanks to this fellowship, Daniel Calabuig visited the Department of Systems and Computer Engineering at Carleton University, Ottawa, Canada, from 2010 to 2012. In 2012, he returned to the iTEAM and worked inside the European projects Mobile and wireless communications Enablers for the Twenty-twenty Information Society (METIS), METIS-II, and 5G for Connected and Automated Road Mobility in the European Union (5G-CARMEN).\nVOLUME 4, 2016 9\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nPrado-Alvarez et al.: Study of Clustering Solutions for Scalable Cell-Free Massive MIMO\nJOSE F. MONSERRAT (SM\u201914) received his MSc. degree with High Honors and Ph.D. degree in Telecommunications engineering from the Universitat Polit\u00e8cnica de Val\u00e8ncia (UPV) in 2003 and 2007, respectively. He was the recipient of the First Regional Prize of Engineering Studies in 2003 for his outstanding student record receiving also the Best Thesis Prize from the UPV in 2008. In 2009 he was awarded with the best young researcher prize of Valencia. In 2016 he received\nthe merit medal from the Spanish royal academy of engineering, in the young researcher category. He is currently full professor in the Communications Department of the UPV and vice-president of the UPV. His current research focuses on the design of future 5G wireless systems and their performance assessment. He has been involved in several European Projects, being especially significant his participation in NEWCOM, PROSIMOS, WINNER+ and METIS/METIS-II, where he led the simulation activities, or 5G-CARMEN on autonomous driving and 5G-SMART on industry 4.0. He also participated in 2010 in one external evaluation group within ITUR on the performance assessment of the candidates for the future family of standards IMT-Advanced. He co-edited two special issues in IEEE Communications Magazine on IMT-Advanced and 5G technologies and is co-editor of the Wiley book \u201cMobile and wireless communications for IMTAdvanced and beyond\u201d and the Cambridge book \u201c5G Mobile and Wireless Communications Technology\u201d. Jose Monserrat is senior member of the IEEE, manages around 0.5 MC yearly budget, holds 9 patents and has published more than 100 journal papers. Currently the group headed by Prof. Jose F. Monserrat consists of 5 Postdoctoral fellows, 8 PhD students and 2 Master students. Prof. Monserrat has been advisor of the European Parliament and the World Bank.\nSAMER BAZZI received the B.E. degree in computer and communications engineering from the American University of Beirut (AUB) in 2008, and the M.Sc. and Dr.-Ing. degrees in communications engineering from the Technische Universit\u00e4t M\u00fcnchen (TUM) in 2010 and 2016, respectively. From 2010 to 2014 he was a member of DOCOMO Euro-Labs located in Munich, Germany, and an external Dr.-Ing. candidate at the chair of Signal Processing Methods at TUM, where he\nworked on coordinated multi-point techniques and precoding for interference channels. He joined Huawei Technologies Duesseldorf GmbH - European Research Center in February 2015, where he is currently a principal engineer. His research interests include MIMO systems, parameter estimation, interference management, and general signal processing techniques for wireless communications.\nWEN XU (SM\u201903) received a B.Sc. degree in 1982 and an M.Sc. degree in 1985 from Dalian University of Technology (DUT), China, and a Dr.-Ing. degree in 1996 from Technische Universit\u00e4t M\u00fcnchen (TUM), Germany, all in electrical engineering. From 1995 till 2006 he was with the Siemens Mobile (later BenQ Mobile), Munich, where he was head of the Algorithms and Standardization Lab. As a competence center, the lab was responsible for physical layer and multimedia\nsignal processing, and partly protocol stack aspects, of 2G, 3G and 4G mobile terminals, and actively involved in standardization activities of ETSI, 3GPP, DVB and ITU. From 2007 till 2014, he was with Infineon Technologies AG (later Intel Mobile Communications GmbH), Neubiberg, focusing on wireline and wireless system concepts/architectures and software/hardware implementations. In 2014, he joined Huawei Technologies Duesseldorf GmbH - European Research Center, Munich, where he is head of Radio Access Technologies Dept. His research interests include signal processing, source/channel coding and wireless communications systems in general. Dr. Xu is a member of the Verband der Elektrotechnik, Elektronik, Informationstechnik (VDE), Germany."
        },
        {
            "heading": "10 VOLUME 4, 2016",
            "text": "This work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/"
        }
    ],
    "title": "Study of Clustering Solutions for Scalable Cell-Free Massive MIMO",
    "year": 2023
}