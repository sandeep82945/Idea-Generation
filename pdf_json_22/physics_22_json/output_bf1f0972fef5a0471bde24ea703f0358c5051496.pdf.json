{
    "abstractText": "This paper presents a stable finite element approximation for the acoustic wave equation on second-order form, with perfectly matched layers (PML) at the boundaries. Energy estimates are derived for varying PML damping for both the discrete and the continuous case. Moreover, a priori error estimates are derived for constant PML damping. Most of the analysis is performed in Laplace space. Numerical experiments in physical space validate the theoretical results Keyword: PML, Wave equation, FEM, Laplace transforms.",
    "authors": [
        {
            "affiliations": [],
            "name": "Gustav Ludvigsson"
        },
        {
            "affiliations": [],
            "name": "Kenneth Duru"
        },
        {
            "affiliations": [],
            "name": "Gunilla Kreiss"
        }
    ],
    "id": "SP:33dc3313f07c1fb5985fa3dae37ec0e5c8d886eb",
    "references": [
        {
            "authors": [
                "S Abarbanel",
                "D Gottlieb",
                "Jan S Hesthaven"
            ],
            "title": "Well-posed perfectly matched layers for advective acoustics",
            "venue": "Journal of Computational Physics,",
            "year": 1999
        },
        {
            "authors": [
                "Daniel Appel\u00f6",
                "Thomas Hagstrom",
                "Gunilla Kreiss"
            ],
            "title": "Perfectly matched layers for hyperbolic systems: general formulation, well-posedness, and stability",
            "venue": "SIAM Journal on Applied Mathematics,",
            "year": 2006
        },
        {
            "authors": [
                "Daniel Appel\u00f6",
                "Gunilla Kreiss"
            ],
            "title": "A new absorbing layer for elastic waves",
            "venue": "Journal of Computational Physics,",
            "year": 2006
        },
        {
            "authors": [
                "Daniel H Baffet",
                "Marcus J Grote",
                "S\u00e9bastien Imperiale",
                "Maryna Kachanovska"
            ],
            "title": "Energy decay and stability of a perfectly matched layer for the wave equation",
            "venue": "Journal of Scientific Computing,",
            "year": 2019
        },
        {
            "authors": [
                "Eliane B\u00e9cache",
                "Sandrine Fauqueux",
                "Patrick Joly"
            ],
            "title": "Stability of perfectly matched layers, group velocities and anisotropic waves",
            "venue": "Journal of Computational Physics,",
            "year": 2003
        },
        {
            "authors": [
                "Eliane B\u00e9cache",
                "Maryna Kachanovska"
            ],
            "title": "Stability and convergence analysis of timedomain perfectly matched layers for the wave equation in waveguides",
            "venue": "SIAM Journal on Numerical Analysis,",
            "year": 2004
        },
        {
            "authors": [
                "Jean-Pierre B\u00e9renger"
            ],
            "title": "A perfectly matched layer for the absorption of electromagnetic waves",
            "venue": "Journal of computational physics,",
            "year": 1994
        },
        {
            "authors": [
                "Susanne C. Brenner",
                "L. Ridgway Scott"
            ],
            "title": "The Mathematical Theory of Finite Element Method, volume 15 of Texts in Applied Mathematics",
            "year": 2008
        },
        {
            "authors": [
                "Weng Cho Chew",
                "William H Weedon"
            ],
            "title": "A 3d perfectly matched medium from modified maxwell\u2019s equations with stretched coordinates",
            "venue": "Microwave and optical technology letters,",
            "year": 1994
        },
        {
            "authors": [
                "Bernardo Cockburn"
            ],
            "title": "Static condensation, hybridization, and the devising of the hdg methods",
            "year": 2016
        },
        {
            "authors": [
                "Francis Collino"
            ],
            "title": "High order absorbing boundary conditions for wave propagation models: straight line boundary and corner cases",
            "venue": "In Second International Conference on Mathematical and Numerical Aspects of Wave Propagation (Newark,",
            "year": 1993
        },
        {
            "authors": [
                "J. Diaz",
                "P. Joly"
            ],
            "title": "A time domain analysis of pml models in acoustics",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 2006
        },
        {
            "authors": [
                "K. Duru",
                "G. Kreiss"
            ],
            "title": "A well-posed and discretely stable perfectly matched layer for elastic wave equations in second order formulation",
            "venue": "Commun. Comput. Phys.,",
            "year": 2012
        },
        {
            "authors": [
                "K. Duru",
                "G. Kreiss"
            ],
            "title": "Boundary waves and stability of the perfectly matched layer for the two space dimensional elastic wave equation in second order form",
            "venue": "SIAM Num. Analys.,",
            "year": 2014
        },
        {
            "authors": [
                "Kenneth Duru"
            ],
            "title": "A perfectly matched layer for the time-dependent wave equation in heterogeneous and layered media",
            "venue": "Journal of Computational Physics,",
            "year": 2014
        },
        {
            "authors": [
                "Kenneth Duru"
            ],
            "title": "The role of numerical boundary procedures in the stability of perfectly matched layers",
            "venue": "SIAM Journal on Scientific Computing,",
            "year": 2016
        },
        {
            "authors": [
                "Kenneth Duru",
                "Alice-Agnes Gabriel",
                "Gunilla Kreiss"
            ],
            "title": "On energy stable discontinuous galerkin spectral element approximations of the perfectly matched layer for the wave equation",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 2019
        },
        {
            "authors": [
                "Kenneth Duru",
                "Jeremy E Kozdon",
                "Gunilla Kreiss"
            ],
            "title": "Boundary conditions and stability of a perfectly matched layer for the elastic wave equation in first order form",
            "venue": "Journal of Computational Physics,",
            "year": 2015
        },
        {
            "authors": [
                "Kenneth Duru",
                "Gunilla Kreiss"
            ],
            "title": "On the accuracy and stability of the perfectly matched layer in transient waveguides",
            "venue": "Journal of Scientific Computing,",
            "year": 2012
        },
        {
            "authors": [
                "Kenneth Duru",
                "Gunilla Kreiss"
            ],
            "title": "The perfectly matched layer (pml) for hyperbolic wave propagation problems: A review, 2022",
            "year": 2022
        },
        {
            "authors": [
                "Kenneth Duru",
                "Leonhard Rannabauer",
                "Alice-Agnes Gabriel",
                "Gunilla Kreiss",
                "Michael Bader"
            ],
            "title": "A stable discontinuous galerkin method for the perfectly matched layer for elastodynamics in first order form",
            "venue": "Numerische Mathematik,",
            "year": 2020
        },
        {
            "authors": [
                "Alexandre Ern",
                "Jean-Luc Guermond"
            ],
            "title": "Theory and practice of finite elements, volume 159",
            "year": 2004
        },
        {
            "authors": [
                "Dan Givoli"
            ],
            "title": "High-order local non-reflecting boundary conditions: a review",
            "venue": "Wave motion,",
            "year": 2004
        },
        {
            "authors": [
                "Marcus J Grote",
                "Imbo Sim"
            ],
            "title": "Efficient pml for the wave equation",
            "venue": "arXiv preprint arXiv:1001.0319,",
            "year": 2010
        },
        {
            "authors": [
                "Thomas Hagstrom",
                "Timothy Warburton",
                "Dan Givoli"
            ],
            "title": "Radiation boundary conditions for time-dependent waves based on complete plane wave expansions",
            "venue": "Journal of Computational and Applied Mathematics,",
            "year": 2010
        }
    ],
    "sections": [
        {
            "text": "Keyword: PML, Wave equation, FEM, Laplace transforms."
        },
        {
            "heading": "1 Introduction",
            "text": "Accurate and effective domain truncation schemes are necessary for efficient numerical simulation of wave propagation problems in many applications. This is because waves typically propagate over large domains, while the domain of interest usually is much smaller. Solving the problem over the whole domain may be computationally costly or even impossible. It is necessary to truncate the large domain so that the problem only has to be solved over the smaller domain of interest. When truncating the domain, an artificial boundary is introduced, and careful treatment of this artificial boundary is necessary to get reliable results from numerical simulations.\nThere are now two powerful and equally appealing approaches for realizing an effective domain truncation scheme. The first is to use a non-reflecting boundary condition (NRBC), [11, 25, 23], which is a boundary condition that is enforced at the artificial boundary such that spurious reflections from the artificial boundary are sufficiently minimized. The second one is adding an absorbing layer where the underlying equations are transformed such that waves decay rapidly as they propagate in the layer. The perfectly matched layer (PML),\n\u2217Division of Scientific Computing, Department of Information Technology, Uppsala University, Sweden. \u2020Mathematical Sciences Institute, The Australian National University, Australia. \u2021Division of Scientific Computing, Department of Information Technology, Uppsala University, Sweden.\nar X\niv :2\n20 6.\n08 50\n7v 1\n[ m\nat h.\nN A\n] 1\n[7, 16, 13], is an absorbing layer with the desirable property that all waves enter the layer and are absorbed without any reflections, regardless of frequency and angle of incidence.\nThe PML technology was initially introduced for electromagnetic waves by Be\u0301renger in [7]. The approach has since then been extended to other wave propagation problems such as elastic wave propagation, see for example [3, 21, 14], and acoustic wave propagation, for example, [24, 1]. Please see [20] for a recent review. In this paper, we consider the PML formulation for the second-order scalar wave equation presented in [24].\nThe PML approach has grown popular over the last decades due to its versatility, efficiency, and ease of implementation using standard numerical methods such as finite difference, finite volume, finite element, spectral, and discontinuous Galerkin methods. One caveat is that in practice, once the PML-formulation is discretized, the PML approach is no longer completely non-reflecting. This is due to the discretization, which disturbs the perfect matching, and the finite PML width, which means that the residual outgoing waves will reflect from the outer boundary and travel back through the layer.\nHowever, stability for the chosen continuous PML and the corresponding discretization is imperative for the approach to be efficient and robust and for results from simulations to be reliable. There is a large body of work treating the stability and well-posedness of PML formulations at the continuous PDE level. For instance, in [6, 12] the Cagniard\u2013De Hoop method was used to derive analytical solutions of the continuous PML for the 2D and 3D acoustic wave equation in a homogeneous medium. We note that the stability analysis of the PML at the discrete level has attracted less attention in the literature. This is attributable to the complex and asymmetrical forms of the PML equations, which make applying standard analytical tools such as the energy methods technically difficult.\nThe stability of a PML model has been studied from a mode perspective. In [5] a necessary geometric stability condition was formulated for the initial value problems of general firstorder hyperbolic systems. When violated, exponentially growing modes in time are present, making the layer useless. However, even if the Cauchy problem does not have growing modes, there can still be stability issues related to boundaries and interfaces. Mode analysis has to some degree been extended to include such issues, see [14, 13, 18, 19, 15]. However, the mode-based stability results are also cumbersome to extend to discrete settings.\nA standard approach to the stability of a numerical scheme is to first derive an energy estimate for the corresponding continuous problem and then mimic the energy analysis in the discrete setting. In physical space, there are severe technical difficulties in deriving energy estimates for problems with PMLs, especially when including boundaries, heterogeneous medium parameters, and allowing for spatially varying damping parameters. In [2] firstorder constant coefficient Cauchy problems are considered. A temporally decaying energy in physical space could be found by requiring several algebraic inequalities, which must be verified in Fourier-Laplace space. However, the energy involves combinations of higher-order derivatives of the unknowns and is therefore difficult to work within a discrete setting. An important step was recently taken in [4], where energy estimates, valid in both continuous and discrete settings, are derived in physical space for the PML formulation for the secondorder wave equation presented in [24], but only for constant media and damping functions.\nThis paper aims to formulate a stable and accurate finite element method (FEM) for the wave equation on a domain surrounded by a PML. We take the approach of deriving an energy estimate in Laplace space, as in [17], where stability results are derived for a\ndiscontinuous Galerkin spectral element method (DGSEM) for the wave equation as a firstorder system. The analysis in [17] allows constant damping parameters, while the stability analysis in this paper extends the analysis to also include continuously variable damping coefficients. The key step taken in [17] was to construct physics-based numerical fluxes with appropriate penalty weights, which allowed the derivation of energy estimates in the Laplace space. For continuous Galerkin FEM, we show that the choice of the weak form and solution space are crucial for proving numerical stability and convergence of high order FEM for the PML for the wave equation in general domains. The chosen weak form allows us to prove energy estimates for heterogeneous medium parameters with piecewise continuous wave speed and continuously varying damping functions, both in continuous and discrete settings. In addition, we prove a convergence result. These are the main results of this paper. Also worth noting is that the paper demonstrates the strength of the strategy of doing energy analysis in Laplace space. We believe that this strategy can facilitate stability results for many other PML problems.\nThe outline of this paper is as follows. In Section 2 we present the underlying wave problem in three space dimensions. In Section 3 we introduce the PML formulation. In Section 4 we derive continuous energy estimates. In Section 5 the weak form is presented. Numerical stability and a priori error estimates are derived in Section 6. The numerical experiments are presented in Section 7. Finally, in Section 8 we summarise the results and draw conclusions."
        },
        {
            "heading": "2 Equations",
            "text": "We consider the time dependent acoustic wave equation on second order form in a source free heterogeneous medium\n1 \u03ba u\u0308\u2212\u2207 \u00b7\n( 1 \u03c1 \u2207u ) = 0, x \u2208 \u2126, t \u2208 (0, T ), (1)\nwhere x = (x, y, z) \u2208 \u2126 \u2282 R3, u : \u2126 \u00d7 (0, T ) \u2192 R is the solution to the wave equation (1), and T > 0 is the final time. The medium is defined by the wave speed c = \u221a \u03ba/\u03c1, where \u03ba > 0 is the bulk-modulus and \u03c1 > 0 is the density. The wave equation (1) is subjected to the initial conditions\nu(x, t = 0) = g1(x), u\u0307(x, t = 0) = g2(x), x \u2208 \u2126, (2)\nwhere we assume that the initial data is compactly supported. The domain \u2126 is bounded by the boundary \u2202\u2126. On \u2202\u2126 we augment the wave equation with the well-posed linear boundary conditions\n1\u2212 r 2 Zu\u0307+ 1 + r 2 \u2207u \u00b7 n = 0, x \u2208 \u2202\u2126, (3)\nwhere n is the outward unit normal on the boundary \u2202\u2126, r with |r| \u2264 1 is the reflection coefficient and Z = \u03c1c > 0 is the wave impedance. Note that r = \u22121 corresponds to a Dirichlet boundary condition\nu = 0 =\u21d2 u\u0307 = 0, x \u2208 \u2202\u2126, (4)\nr = 1 yields a Neumann boundary condition\n\u2207u \u00b7 n = 0, x \u2208 \u2202\u2126, (5)\nand r = 0 corresponds to the classical first order absorbing boundary condition\n1 2 Zu\u0307+ 1 2 \u2207u \u00b7 n = 0, x \u2208 \u2202\u2126. (6)\nRemark 1 We have tacitly considered homogeneous boundary data under the usual assumptions of compatibility between boundary and initial data. The analysis follows through for the case of non-homogeneous boundary data, but this would complicate the algebra.\nWe will now derive the standard energy estimate, on which a proof of well-posedness can be based. To begin, for real functions u, v defined over \u2126 we introduce the inner products\n(u, v) = \u222b \u2126 u\u2217vdx,\nand for the boundary\n\u3008u, v\u3009 = \u222b \u2202\u2126 u\u2217vdS\ntogether with the corresponding norm\n\u2016u\u20162b = (bu, u), b(x) > 0.\nIf b \u2261 1 we will omit the subscript b. We define the energy as\nE(t) = 1\n2\n( \u2016u\u0307\u201621/\u03ba + \u2016\u2207u\u201621/\u03c1 ) . (7)\nTo begin with assume that the material parameters are continuous and there is a sufficiently smooth solution. We will now use the standard technique to derive an energy estimate. Multiply equation (1) by u\u0307 and integrate by parts in space to get(\n1 \u03ba u\u0308, u\u0307\n) + (( 1 \u03c1 \u2207u ) ,\u2207u\u0307 ) \u2212 \u2329 1 \u03c1 (\u2207u \u00b7 n) , u\u0307 \u232a = 0. (8)\nThe boundary term vanishes for the cases when |r| = 1, which corresponds to either the Dirichlet boundary condition (4) or the Neumann boundary condition (6). If r 6= \u22121 we have \u2329\n1 \u03c1 (\u2207u \u00b7 n) , u\u0307\n\u232a = \u2329 c 1\u2212 r 1 + r u\u0307, u\u0307 \u232a , (9)\nwhere c > 0 is the wave speed. It follows that\n1\n2\nd\ndt\n( \u2016u\u0307\u201621/\u03ba + \u2016\u2207u\u201621/\u03c1 ) +BT = 0, (10)\nwhere\nBT = { 0, r = \u22121\u2329 c1\u2212r 1+r u\u0307, u\u0307 \u232a , r 6= \u22121.\n(11)\nIn particular we note that BT \u2265 0 since |r| \u2264 1. Thus\nd\ndt E(t) = \u2212BT \u2264 0, (12)\nwhich after integration in time gives us the energy estimate\nE(t) \u2264 E(0) \u2200t \u2265 0. (13)\nIf |r| = 1 then we have energy conservation, that is E(t) = E(0) for all t \u2265 0. If |r| < 1 then energy is lost through the boundaries.\nWe can include piece-wise continuous material properties in the above. At interfaces \u0393 where the wave speed c > 0 is discontinuous we prescribe the interface condition\n[[u]] = 0, [[ 1\n\u03c1 \u2207u \u00b7 n]] = 0, (14)\nwhere n is a unit normal at the interface. In the derivation of the energy estimate interface terms appear, but vanish due to this condition, and the same energy estimate holds also for this case. In the following analysis we will include the possibility of material interfaces."
        },
        {
            "heading": "3 PML",
            "text": "In this section we re-derive the PML problem used in [24] using the well-known complex coordinate stretching technique [9].\nWe begin with introducing the Laplace transform in time. Let u\u0302 = L (u) be the Laplace transform of u defined by\nu\u0302(x, y, z, s) = L (u) := \u222b \u221e 0 e\u2212stu(x, y, z, t)dt, (15)\nwhere s \u2208 C with Re(s) = a > 0. Laplace transforming the wave equation (1) in time, with homogeneous initial conditions, yields\ns2 \u03ba u\u0302\u2212\u2207 \u00b7\n( 1 \u03c1 \u2207u\u0302 ) = 0 (16)\nWe introduce the PML coordinate transformation\n\u03b7 \u2192 \u03b7\u0303 = \u03b7 + 1 s \u222b \u03b7 0 d\u03b7(\u03b8)d\u03b8, \u03b7 = x, y, z, (17)\nwhere d\u03b7(\u03b7) are the damping functions, and s is dual Laplace time variable. Note that\n\u2202 \u2202\u03b7\u0303 = 1\nS\u03b7\n\u2202 \u2202\u03b7 , S\u03b7 = 1 + d\u03b7 (\u03b7) s . (18)\nIn the Laplace space we apply the coordinate transformation to the wave equation (16) yielding\ns2 \u03ba u\u0302 = \u2207d \u00b7\n( 1\n\u03c1 \u2207du\u0302\n) , (19)\nwhere \u2207d = ( 1Sx \u2202 \u2202x , 1 Sy \u2202 \u2202y , 1 Sz \u2202 \u2202z )T . To invert the Laplace transforms we multiply (19) with SxSySz, we have\ns2SxSySz \u03ba\nu\u0302\u2212\u2207 \u00b7 ( S 1\n\u03c1 \u2207du\u0302\n) = 0, S = SySz 0 00 SxSz 0 0 0 SxSy  . (20) Introducing the diagonal matrices\nd = dx 0 00 dy 0 0 0 dz  , \u0393 = dy + dz \u2212 dx 0 00 dx + dz \u2212 dy 0 0 0 dx + dy \u2212 dz  , \u03a5 =\ndydz 0 00 dxdz 0 0 0 dxdy  , the auxiliary variables \u03c6\u0302 = ( \u03c6\u0302x, \u03c6\u0302y, \u03c6\u0302z )T , \u03c8\u0302 with\ns\u03c6\u0302 = \u2212d\u03c6\u0302+ ( 1\n\u03c1 \u0393 +\n1\ns\u03c1 \u03a5\n) \u2207u\u0302, (21a)\ns\u03c8\u0302 = u\u0302, (21b)\nand inverting the Laplace transforms results in the PML equation in the time-domain\n1 \u03ba u\u0308+ 1 \u03ba \u2211 \u03b7 d\u03b7u\u0307+ dxdydz \u03ba \u2211 \u03b7 1 d\u03b7 u =\u2207 \u00b7 ( 1 \u03c1 \u2207u ) +\u2207 \u00b7 \u03c6\u2212 dxdydz \u03ba \u03c8, (22a)\n\u03c6\u0307 = \u2212d\u03c6+ 1 \u03c1 \u0393\u2207u+ 1 \u03c1 \u03a5\u2207\u03c8, (22b)\n\u03c8\u0307 = u. (22c)\nWe will use boundary and interface conditions, which in Laplace space have the form\n1\u2212 r 2 c ((Sn) \u00b7 n) (su\u0302) + r + 1 2\n( 1\n\u03c1 S\u2207du\u0302\n) \u00b7 n = 0, (23)\nand\n[[u\u0302]] = 0, [[\n( 1\n\u03c1 S\u2207du\u0302\n) \u00b7 n]] = 0. (24)\nNote that (23) can be written as\nSxSySz\n( 1\u2212 r\n2 c (\u2211 \u03b7 n2\u03b7 S\u03b7 ) (su\u0302) + r + 1 2 1 \u03c1 \u2211 \u03b7 n\u03b7 S2\u03b7 \u2202u\u0302 \u2202\u03b7 ) = 0, (25)\nand since SxSySz 6= 0 we must also have( 1\u2212 r\n2 c (\u2211 \u03b7 n2\u03b7 S\u03b7 ) (su\u0302) + r + 1 2 1 \u03c1 \u2211 \u03b7 n\u03b7 S2\u03b7 \u2202u\u0302 \u2202\u03b7 ) = 0, (26)\nSimilarly the second part of (24) can be written as\n[[\n( 1\n\u03c1 SxSySz \u2211 \u03b7 n\u03b7 S2\u03b7 \u2202u\u0302 \u2202\u03b7\n) ]] = 0. (27)\nCorresponding to (23) and (24) we have relations in physical space in terms of the solution and the auxilary variables. The corresponding boundary condition is\nc (1\u2212 r) 2 (u\u0307+ \u03b8 \u00b7 n) + (1 + r) 2\n( 1\n\u03c1 \u2207u+ \u03c6\n) \u00b7 n = 0, (x, y, z) \u2208 \u2202\u2126, (28)\nand the corresponding interface conditions are\n[[u]] = 0, [[\n( 1\n\u03c1 \u2207u+ \u03c6\n) \u00b7 n]] = 0, (29)\nwhere\n\u03b8 = ((dy + dz)u+ dydz\u03c8)nx((dx + dz)u+ dxdz\u03c8)ny ((dx + dy)u+ dxdy\u03c8)nz  . The conditions (28) and (29) are non-trivial modifications of (3) and (14) respectively. The modifications are chosen to ensure the energy estimate, and to allow for energy dissipation at the boundary. Note that r = \u22121 corresponds to the Dirichlet boundary condition\nu = 0 =\u21d2 u\u0307+ \u03b8 \u00b7 n = 0, (x, y, z) \u2208 \u2202\u2126,\nand r = 1 corresponds to the Neumann boundary condition( 1\n\u03c1 \u2207u+ \u03c6\n) \u00b7 n = 0, (x, y, z) \u2208 \u2202\u2126."
        },
        {
            "heading": "4 Energy analysis for the PML problem",
            "text": "In this section we will derive the energy estimate for the PML problem in Laplace space. Consider the inhomogeneaus system\n1 \u03ba u\u0308+ 1 \u03ba \u2211 \u03b7 d\u03b7u\u0307+ dxdydz \u03ba \u2211 \u03b7 1 d\u03b7 u =\u2207 \u00b7 ( 1 \u03c1 \u2207u ) +\u2207 \u00b7 \u03c6\u2212 dxdydz \u03ba \u03c8 + 1 \u03ba Fu, (30a)\n\u03c6\u0307 = \u2212d\u03c6+ 1 \u03c1 \u0393\u2207u+ 1 \u03c1 \u03a5\u2207\u03c8 + f\u03c6, (30b)\n\u03c8\u0307 = u+ f\u03c8, (30c)\nwith vanishing initial data and subject to the boundary and interface conditions (28) and (29). Problems with homogeneous initial and boundary data can be reformulated as (30) by a suitable change of variables.\nNext we Laplace transform (30) in time and get\ns2 \u03ba SxSySzu\u0302 =\u2207 \u00b7\n( 1 \u03c1 \u2207u\u0302 ) +\u2207 \u00b7 \u03c6\u0302+ 1 \u03ba ( F\u0302u + dxdydz s f\u0302\u03c8 ) , (31a)\ns\u03c6\u0302 = \u2212d\u03c6\u0302+ 1 \u03c1 \u0393\u2207u\u0302+ 1 \u03c1 \u03a5\u2207\u03c8\u0302 + f\u0302\u03c6, (31b)\ns\u03c8\u0302 = u\u0302+ f\u0302\u03c8, (31c)\nUsing (31b)-(31c) and eliminating the auxiliary variables \u03c6\u0302, \u03c8\u0302 in (31a) yields\ns2SxSySz \u03ba\nu\u0302\u2212\u2207 \u00b7 ( S 1\n\u03c1 \u2207du\u0302 ) = SxSySz \u03ba F\u0302 + SxSySz\u2207 \u00b7 f\u0302 , (32)\nwith the boundary condition\nSxSySz\n( 1\u2212 r\n2 c (\u2211 \u03b7 n2\u03b7 S\u03b7 ) (su\u0302) + r + 1 2 1 \u03c1 \u2211 \u03b7 n\u03b7 S2\u03b7 \u2202u\u0302 \u2202\u03b7 ) = 0, (33)\nand the interface condition\n[[u\u0302]] = 0, [[\n( 1\n\u03c1 S\u2207du\u0302\n) \u00b7 n]] = 0. (34)\nHere\nF\u0302 = 1\nSxSySz\n( F\u0302u +\ndxdydz s f\u0302\u03c8\n) ,\nSxSySz\u2207 \u00b7 f\u0302 =\u2207 \u00b7 f\u0302g, and\nf\u0302g = (sI + d) \u22121 ( 1\ns\u03c1 \u03a5\u2207f\u0302\u03c8 + f\u0302\u03c6\n) .\nRemark 2 In realistic settings we typically have f\u03c6 = f\u03c8 = 0. However, for generality, we choose to include them in the analysis in this section.\nIn [17], an acoustic first-order system with a surrounding PML is considered. After eliminating the velocity field the pressure is shown to satisfy (32)-(34). This means that we can take advantage of the analysis there. Following [17], we note that for s = a + ib 6= 0, a > 0, and d\u03b7 \u2265 0, with \u03b7 = x, y, z, we have\nRe\n( (sS\u03b7) \u2217\nS\u03b7\n) = a+ k\u03b7, k\u03b7 = 2d\u03b7b 2\n|sS\u03b7|2 \u2265 0. (35)\nNext define an energy for the solution in Laplace space\nE2u\u0302(s) =\n( 1\n\u03ba su\u0302, su\u0302\n) + \u2211\n\u03b7=x,y,z\n( 1\n\u03c1\n1\nS\u03b7\n\u2202u\u0302 \u2202\u03b7 , 1\nS\u03b7\n\u2202u\u0302\n\u2202\u03b7\n)\n= \u2016su\u0302\u201621/\u03ba + \u2211\n\u03b7=x,y,z\n\u2225\u2225\u2225\u2225 1S\u03b7 \u2202u\u0302\u2202\u03b7 \u2225\u2225\u2225\u22252\n1/\u03c1\n\u2265 0, (36)\nand an energy for the data\nE2f (s) =\n( 1\n\u03ba F\u0302 , F\u0302\n) + (\u03c1f\u0302 , f\u0302)\n= \u2225\u2225\u2225F\u0302\u2225\u2225\u22252 1/\u03ba + \u2225\u2225\u2225f\u0302\u2225\u2225\u22252 \u03c1 > 0,\n(37)\nwith\nf\u0302 = ( sSyf\u0302x, sSyf\u0302y, sSzf\u0302z )T .\nThe following theorem gives an energy estimate in Laplace space. It is similar to Theorem 1 in [17], but more general since it allows continuously varying damping.\nTheorem 1 Consider the Laplace transformed PML equation (32) in a piece-wise continuous heterogeneous media with continuously varying damping coefficients dx, dy, dz \u2265 0, subject to boundary condition (33), |r| \u2264 1, and interface conditions (34) at discontinuities in material parameters. Then for any s \u2208 C with Re(s) = a > \u03b2, where \u03b2 = max\u03b7=x,y,z,\u2126 (\u221a \u03ba/\u03c1|d\u2032\u03b7(\u03b7)/d\u03b7| ) , a solution satisfies\n(a\u2212 \u03b2)E2u\u0302(s) + \u2211\n\u03b7=x,y,z \u2225\u2225\u2225\u2225 1S\u03b7 \u2202u\u0302\u2202\u03b7 \u2225\u2225\u2225\u22252 k\u03b7/\u03c1 +BTr(u\u0302) \u2264 2Eu\u0302(s)Ef (s), (38)\nwhere\nBTr(u\u0302) = { 0, r = \u22121\u222b \u2202\u2126 ( 1\u2212r 1+r c|(su\u0302)|2 \u2211 \u03b7=x,y,z a(a+d\u03b7)+b2 (a+d\u03b7)2+b2 n2\u03b7 ) dS \u2265 0, r 6= \u22121,\nEu and Ef are defined in (36) and (37), n\u03b7 are the components of the normal, and b = Im(s).\nProof 1 We multiply (32) with (su\u0302)\u2217/(SxSySz) from the left and integrate over our domain \u2126, we have\n( s \u03ba (su\u0302) , su\u0302 ) \u2212 \u2211\n\u03b7=x,y,z\n( 1\nS\u03b7\n\u2202\n\u2202\u03b7\n( 1\n\u03c1S\u03b7\n\u2202u\u0302\n\u2202\u03b7\n) , su\u0302 ) = ( 1\n\u03ba F\u0302 , su\u0302\n) + ( \u2207 \u00b7 f\u0302 , su\u0302 ) Integrating by part gives us( s\n\u03ba (su\u0302) , su\u0302\n) + \u2211\n\u03b7=x,y,z\n( (sS\u03b7) \u2217\n\u03c1S\u03b7\n( 1\nS\u03b7\n\u2202u\u0302\n\u2202\u03b7\n) , 1\nS\u03b7\n\u2202u\u0302\n\u2202\u03b7 ) + \u2211\n\u03b7=x,y,z\n( \u2202\n\u2202\u03b7\n( 1\nS\u03b7\n)( 1\n\u03c1S\u03b7\n\u2202u\u0302\n\u2202\u03b7\n) , su\u0302 ) \u2212 \u2211\n\u03b7=x,y,z\n\u2329 1\n\u03c1\n( 1\nS2\u03b7\n\u2202u\u0302 \u2202\u03b7 n\u03b7\n) , su\u0302 \u232a = ( 1\n\u03ba F\u0302 , su\u0302\n) + ( \u2207 \u00b7 f\u0302 , su\u0302 ) ,\nwhere n\u03b7 is the \u03b7 component of the normal. Note that the last term in the first row of the above vanishes if the damping is constant in space. At discontinuities in \u03c1 the interface terms vanishes due to the interface conditions (24), when we take into account that the damping is continous. At the boundaries we enforce the boundary conditions (23). Note that if r = \u22121 we have (su\u0302) = 0 and the boundary integral vanishes. And if r 6= \u22121 we enforce the boundary conditions and we have\n( s \u03ba (su\u0302) , su\u0302 ) + \u2211\n\u03b7=x,y,z\n( (sS\u03b7) \u2217\n\u03c1S\u03b7\n( 1\nS\u03b7\n\u2202u\u0302\n\u2202\u03b7\n) , 1\nS\u03b7\n\u2202u\u0302\n\u2202\u03b7\n) + \u2211\n\u03b7=x,y,z\n( \u2202\n\u2202\u03b7\n( 1\nS\u03b7\n)( 1\n\u03c1S\u03b7\n\u2202u\u0302\n\u2202\u03b7\n) , su\u0302 )\n+ \u2211\n\u03b7=x,y,z\n\u2329 1\u2212 r 1 + r c n2\u03b7 S\u03b7 (su\u0302) , su\u0302 \u232a = ( 1 \u03ba F\u0302 , su\u0302 ) + ( \u2207 \u00b7 f\u0302 , su\u0302 ) Note also that the boundary integral vanishes when r = 1. Adding the conjugate transpose yields\n2(a\u2212 \u03b2)\n(( 1\n\u03ba (su\u0302) , su\u0302\n) + \u2211\n\u03b7=x,y,z\n( 1\n\u03c1\n( 1\nS\u03b7\n\u2202u\u0302\n\u2202\u03b7\n) , 1\nS\u03b7\n\u2202u\u0302\n\u2202\u03b7\n))\n+ 2 \u2211\n\u03b7=x,y,z\n( \u03ba\u03b7 \u03c1 ( 1\nS\u03b7\n\u2202u\u0302\n\u2202\u03b7\n) , 1\nS\u03b7\n\u2202u\u0302\n\u2202\u03b7\n) + 2 \u2211 \u03b7=x,y,z \u2329 1\u2212 r 1 + r c a(a+ d\u03b7) + b 2 (a+ d\u03b7)2 + b2 n2\u03b7 (su\u0302) , su\u0302 \u232a \u2264 ( 1\n\u03ba F\u0302 , su\u0302\n) + ( su\u0302, 1\n\u03ba F\u0302\n) \u2212 ( f\u0302 , s\u2207u\u0302 ) \u2212 ( s\u2207u\u0302, f\u0302 ) where \u03b2 satisfies\n\u03b2 = max \u03b7=x,y,z,\u2126\n(\u221a \u03ba/\u03c1|d\u2032\u03b7(\u03b7)/d\u03b7| ) .\nHere we have used \u2223\u2223\u2223\u2223 \u2202\u2202\u03b7 ( 1\nS\u03b7 )\u2223\u2223\u2223\u2223 \u2264 \u2223\u2223\u2223\u2223d\u2032\u03b7(\u03b7)d\u03b7 \u2223\u2223\u2223\u2223\nUsing Cauchy Schwarz inequality and \u2223\u2223\u2223\u2223(sS\u03b7)\u2217sS\u03b7 \u2223\u2223\u2223\u2223 = 1,\ngive us the desired estimate, which completes the proof.\nRemark 3 In particular, constant damping coefficients gives us \u03b2 = 0 and the proof holds for any a > 0.\nCorollary 1 Consider the problem defined in Theorem 1 with constant damping dx, dy, dz \u2265 0. The problem is asymptotically stable in the sense that no exponentially growing solutions are supported.\nTransforming our estimate in Theorem 1 from Laplace domain into time domain is hard to do while keeping the sharpness of the bound. However we can straight-forwardly achieve a bound that increases exponentially with time. This does not prove asymptotic stability but it is enough to assure well-posedness of the PML problem. Let L \u22121 denote the inverse Laplace transform and introduce the following norms\nE2u(t, d\u03b7) = \u2225\u2225L \u22121(su\u0303)\u2225\u22252 1/\u03ba + \u2211\n\u03b7=x,y,z\n\u2225\u2225\u2225\u2225L \u22121( 1S\u03b7 \u2202u\u0303\u2202\u03b7 )\u2225\u2225\u2225\u22252\n1/\u03c1\n= \u2225\u2225\u2225\u2225\u2202u\u2202t \u2225\u2225\u2225\u22252\n1/\u03ba\n+ \u2211\n\u03b7=x,y,z\n\u2225\u2225\u2225\u2225\u2202u\u2202\u03b7 \u2212 d\u03b7e\u2212d\u03b7t\u2202u\u2202\u03b7 \u2225\u2225\u2225\u22252\n1/\u03c1\n> 0,\n(39)\nand\nE2f (t, d\u03b7) = \u2225\u2225\u2225L \u22121 (F\u0302)\u2225\u2225\u22252 1/\u03ba + \u2225\u2225\u2225L \u22121 (f\u0302)\u2225\u2225\u22252 \u03c1 > 0. (40)\nTheorem 2 Consider the Laplace transformed PML equation (19) with constant damping d\u03b7 \u2265 0 and subject to homogeneous initial data. Let the energy norms E2u(t, d\u03b7) > 0, E2f (t, d\u03b7) > 0 be defined as (39) and (40). Then\u222b T\n0\ne\u2212atE2u(t, d\u03b7)dt \u2264 4\n(a\u2212 \u03b2)2 \u222b T 0 e\u22122atE2f (t, d\u03b7)dt (41)\nfor any a > \u03b2 and T > 0.\nProof 2 The proof can be found in [17].\nFrom the results in this section we can conclude that our PML problem is well posed. In particular, for constant damping (41) is valid for any a > 0, and we can choose a > 0 in relation to the time interval. A bound in physical space is obtained, which grows only algebraically in time. With variable damping the bound grows exponentially. In section 6 we will see that we can follow the same approach to prove stability in the corresponding sense also for the discrete problem."
        },
        {
            "heading": "5 The finite element approximation",
            "text": "In this section we formulate the PML problem in weak form, and state the corresponding FEM. For the weak form we will consider u, \u03c8 \u2208 V , where\nV = { H10 (\u2126), r = \u22121, H1(\u2126), r 6= \u22121,\nand \u03c6 \u2208 [L2(\u2126)]3. Note that u \u2208 V is the standard choice for the wave equation without damping. In the PML u \u2208 V in (31) implies \u03c6 \u2208 [L2(\u2126)]3 and \u03c8 \u2208 V . Here H10 (\u2126) and H1(\u2126) are the standard Sobolev spaces. We begin by multiplying the PML system in (31) by test functions v, q \u2208 V and p \u2208 [L2(\u2126)]3 and integrating over the domain. We obtain(\n1 \u03ba u\u0308+ 1 \u03ba \u2211 \u03b7 d\u03b7u\u0307+ dxdydz \u03ba \u2211 \u03b7 1 d\u03b7 u, v\n)\n= ( \u2207 \u00b7 ( 1 \u03c1 \u2207u ) +\u2207 \u00b7 \u03c6\u2212 dxdydz \u03ba \u03c8 + 1 \u03ba Fu, v ) , (42a)(\n\u03c6\u0307,p ) = ( \u2212d\u03c6+ 1\n\u03c1 \u0393\u2207u+ 1 \u03c1 \u03a5\u2207\u03c8 + f\u03c6,p ) , (42b)(\n\u03c8\u0307, q )\n= (u+ f\u03c8, q) . (42c)\nWhen r = \u22121 we have a Dirichlet boundary condition, which is imposed strongly in the function space for u and v. When r 6= \u22121 we need to consider the boundary condition multiplied by the test function v and integrated over the boundary,\n1\u2212 r 2 \u3008c (u\u0307+ \u03b8 \u00b7 n) , v\u3009+ 1 + r 2\n\u2329 1\n\u03c1 \u2207u \u00b7 n + \u03c6 \u00b7 n, v\n\u232a = 0. (43)\nSimilarly, we will use the interface condition multiplied by the test function v, and integrated over the interface, \u2329\n[[ 1\n\u03c1 \u2207u \u00b7 n]] + [[\u03c6 \u00b7 n]], v\n\u232a = 0. (44)\nNext we perform integration by parts on the right hand side of equation (42a). If we take (44) into account the result is(\n1 \u03ba u\u0308+ 1 \u03ba \u2211 \u03b7 d\u03b7u\u0307+ dxdydz \u03ba \u2211 \u03b7 1 d\u03b7 u, v\n) = \u2212 ( 1\n\u03c1 \u2207u,\u2207v\n) \u2212 (\u03c6,\u2207v)\n\u2212 ( dxdydz \u03ba \u03c8, v ) + ( 1 \u03ba Fu, v ) + \u2329 1 \u03c1 \u2207u \u00b7 n + \u03c6 \u00b7 n, v \u232a , (45)(\n\u03c6\u0307,p ) = ( \u2212d\u03c6+ 1\n\u03c1 \u0393\u2207u+ 1 \u03c1 \u03a5\u2207\u03c8 + f\u03c6,p ) , (46)(\n\u03c8\u0307, q )\n= (u+ f\u03c8, q) . (47)\nWhen r 6= \u22121 we use (43) to express the boundary term in u\u0307 and \u03b8, and thus the boundary term can be written as\nBTr(u,\u03b8, v) := { 0, r = \u22121,\u2329 c (1\u2212r) r+1 (u\u0307+ \u03b8 \u00b7 n) , v \u232a , r 6= \u22121,\nWhen r = \u22121 the term vanishes due to the strong Dirichlet condition imposed on the function space.\nRemark 4 Note that both the first and second term of the right hand side of (42a) are integrated by parts. This weak form will allow the discrete energy analysis in the next section to follow the steps in Section 4. We also note that with this formulation the interface condition is imposed weakly.\nRemark 5 From experience we know that naively only integrating the first term of the right hand side of (42a) by parts, yields an unstable numerical method.\nThe weak PML problem can now be stated. For all v, q \u2208 V and p \u2208 [L2 (\u2126)]3, find u, \u03c8 \u2208 V and \u03c6 \u2208 [L2 (\u2126)]3 such that(\n1 \u03ba u\u0308+ 1 \u03ba \u2211 \u03b7 d\u03b7u\u0307+ dxdydz \u03ba \u2211 \u03b7 1 d\u03b7 u, v\n) = \u2212 ( 1\n\u03c1 \u2207u,\u2207v ) \u2212 (\u03c6,\u2207v)\u2212 ( dxdydz \u03ba \u03c8, v ) \u2212BTr(u,\u03b8, v) + ( 1 \u03ba Fu, v ) (48a)(\n\u03c6\u0307,p ) = ( \u2212d\u03c6+ 1\n\u03c1 \u0393\u2207u+ 1 \u03c1 \u03a5\u2207\u03c8 + f\u03c6,p ) , (48b)(\n\u03c8\u0307, q )\n= (u+ f\u03c8, q) . (48c)\nNote that for |r| = 1 the boundary term vanishes identically. Since we derived this weak form from the strong form consistency follows.\nIt remains to formulate the Galerkin approximation. For this purpose we discretise our domain \u2126 by introducing a tesselation K\u2126, with no\nhanging nodes, consisting of elements, K, that completely cover \u2126. More precisely \u2126 = \u22c3\nK\u2208K\u2126\nK. (49)\nNext we introduce our discrete spaces\nVh = {v \u2208 V : v|K\u2208 Np(K), K \u2208 K\u2126} (50)\nand Wh = {v \u2208 [L2 (\u2126)]3 : v|K\u2208 Np(K), K \u2208 K\u2126}. (51)\nwhere Np(K) denotes an element with polynomial order p \u2265 1, over K.\nThe Galerkin approximation for the PML problem can now be stated. For all v, q \u2208 Vh and p \u2208 Wh, find uh, \u03c8h \u2208 Vh and \u03c6h \u2208 Wh such that(\n1 \u03ba u\u0308h + 1 \u03ba \u2211 \u03b7 d\u03b7u\u0307h + dxdydz \u03ba \u2211 \u03b7 1 d\u03b7 uh, v\n) = \u2212 ( 1\n\u03c1 \u2207uh,\u2207v ) \u2212 (\u03c6h,\u2207v)\u2212 ( dxdydz \u03ba \u03c8h, v ) \u2212BTr(uh,\u03b8h, v) + ( 1 \u03ba Fu, v ) (52a)(\n\u03c6\u0307h,p ) = ( \u2212d\u03c6h + 1\n\u03c1 \u0393\u2207uh +\n1 \u03c1 \u03a5\u2207\u03c8h + f\u03c6,p ) , (52b)(\n\u03c8\u0307h, q ) = (uh + f\u03c8, q) . (52c)\nThe initial data (2) is L2-projected onto the finite element space. The numerical experiments will be performed in 2D. There the approximation reads as in 3D, but the number of auxiliary variables is reduced to two, corresponding to the first two components of \u03c6 in the 3D case."
        },
        {
            "heading": "6 Discrete Analysis",
            "text": "In this section we derive energy and convergence results for particular cases. The energy result is quite general and holds for continuously varying damping coefficient, while the convergence proof is more restrictive and relies on constant damping coefficients. For simplicity we will consider Dirichlet boundary condition, but the analysis can easily be extended to the more general boundary conditions."
        },
        {
            "heading": "6.1 Discrete energy analysis",
            "text": "Here, we derive an energy estimate for the discrete problem with a particular choice of quadrature, which corresponds to the polynomial order. In the final part of the derivation we will assume that in each element the quadrature points can be used to interpolate any function to the local polynomial space. For later use we introduce\nDefinition 1 The quadrature and the polynomial space satisfy the Interpolation Condition if any function values at the quadrature points in each element can be interpolated by a polynomial, which belongs to the local polynomial space. For each element T the local interpolating polynomial defines the Quadrature Point Interpolant Iq(T ). By Iq we denote the corresponding global Quadrature Point Interpolant.\nFor example, with rectangular elements we can use a tensor product Lagrange basis with piece-wise polynomials of degree p in each spatial direction based on Lagrange-GaussLobatto nodes, and a corresponding Gauss-Legandre quadrature with p+1 quadrature points in each direction, to satisfy the Interpolation Condition. Such a quadrature rule can integrate polynomials of order 2p + 1 exactly. If a higher order quadrature involving more points is used, the Interpolation Condition will not be satisfied. Comments on how to extend the result to the other quadratures or exact integration will follow in the end of the section.\nWe will analyze the discretization in Laplace space, and therefore we consider the Laplace transform of the discrete weak form,(\ns2 \u03ba u\u0302h + s \u03ba \u2211 \u03b7 d\u03b7u\u0302h + dxdydz \u03ba \u2211 \u03b7 1 d\u03b7 u\u0302h, v ) h = \u2212 ( 1 \u03c1 \u2207u\u0302h,\u2207v ) h\n\u2212 ( \u03c6\u0302h,\u2207v ) h \u2212 ( dxdydz \u03ba \u03c8\u0302h, v ) h + ( 1 \u03ba F\u0302u, v ) h\n(53a)( s\u03c6\u0302h,p ) h = ( \u2212d\u03c6\u0302h + 1 \u03c1 \u0393\u2207u\u0302h + 1 \u03c1 \u03a5\u2207\u03c8\u0302h,p ) h\n, (53b)( s\u03c8\u0302h, q ) h = (u\u0302h, q)h , (53c)\nThe effects of initial data is incorporated in the forcing function F\u0302uh , but here we have for brevity assumed forcing only in the main equation. Here v \u2208 Vh and w \u2208 Wh. Further, the discrete inner product used in (53a)-(53c), and the corresponding norm are defined by quadrature instead of integrals.\nThe next step is to derive a discrete reduced weak form involving only u\u0302h and v. We would like to use p\u0303(x) = (s\u2217I + d(x))\u22121\u2207v as test function in (53b). Here I is the identity matrix and d is a diagonal matrix defined in section 3. However, for variable damping p\u0303 is not in Wh even if v \u2208 Vh. If the Interpolation Condition (see definition 1) is satisfied, the corresponding Quadrature Point Interpolant can be used, and we have\nTheorem 3 Let u\u0302h, \u03c6\u0302h, and \u03c8\u0302h satisfy the discrete weak form in Laplace space, (53a)-(53c). For constant damping functions the solution u\u0302h satisfies the reduced weak form(\ns2SxSySz \u03ba u\u0302h, v ) h = \u2212 ( 1 \u03c1 S\u2207du\u0302h,\u2207v ) h + ( 1 \u03ba F\u0302u, v ) h , \u2200v \u2208 Vh. (54)\nIf the Interpolation Condition (see definition 1) is fulfilled, then the solution u\u0302h satisfies (54) also in the case of spatially varying damping functions.\nProof 3 Consider the case of spatially varying damping functions. The constant case follows in the same way. In (53c) we note that \u03c8\u0302h and u\u0302h are in the same space, which is spanned by the test functions q. Thus we have\n\u03c8\u0302h = 1\ns u\u0302h.\nWe can thus eliminate \u03c8\u0302h from (53b) and (53a). Next we let\nph(x) = Iq(Tj)(s \u2217I + d(x))\u22121\u2207v(x), x \u2208 Tj,\nfor any v \u2208 Vh. By the Interpolation Condition ph \u2208 Wh. With ph as test function in (53b) we get (\n\u03c6\u0302h,\u2207v ) h = ( 1 \u03c1 ( \u0393 + 1 s \u03a5 ) \u2207u\u0302h, (s\u2217I + d)\u22121\u2207v ) h .\nBy the definitions of the diagonal matrices \u0393 and \u03a5, this relation can be rewritten as( \u03c6\u0302h,\u2207v ) h = ( 1 \u03c1 S\u2207du\u0302h,\u2207v ) h \u2212 ( 1 \u03c1 \u2207u\u0302h,\u2207v ) h ,\nand we can also eliminate \u03c6\u0302h from (53a), arriving at the problem in reduced weak-form, (54).\nIf the Interpolation Condition is not satisfied we need to find a suitable test function p\u0303h \u2208 Wh that will allow eliminating \u03c6\u0302h from (53a). We will use a projection of p\u0303(x) = (s\u2217I + d(x))\u22121\u2207v defined by\nDefinition 2 For g \u2208 Wh the projection gp = \u03a0p(s\u2217I + d)\u22121g \u2208 Wh is defined as the solution to\n(wh, (s \u2217I + d)gp)h = (wh, g)h , \u2200wh \u2208 Wh. (55)\nNow introduce ph = \u03a0p(s \u2217I + d)\u22121\u2207v as test function in (53b), and get( \u03c6\u0302h,\u2207v ) h = ( 1 \u03c1 ( \u0393 + 1 s \u03a5 ) \u2207u\u0302h,\u03a0p(s\u2217I + d)\u22121\u2207v ) h .\nBy the definitions of the diagonal matrices \u0393 and \u03a5, this relation can be rewritten similarly as above,(\n\u03c6\u0302h,\u2207v ) h = ( 1 \u03c1 S\u2207du\u0302h, (s\u2217I + d)\u03a0p(s\u2217I + d)\u22121\u2207v ) h \u2212 ( 1 \u03c1 \u2207u\u0302h,\u2207v ) h , (56)\nand we can again eliminate \u03c6\u0302h from (45), arriving at the problem in reduced weak-form. This proves the more general theorem\nTheorem 4 Let u\u0302h, \u03c6\u0302h, and \u03c8\u0302h satisfy the discrete weak form in Laplace space (53a)-(53c). Then u\u0302h also satisfies the reduced weak form(\ns2SxSySz \u03ba u\u0302h, v ) h = \u2212 ( 1 \u03c1 S\u2207du\u0302h, (s\u2217I + d)\u03a0p(s\u2217I + d)\u22121\u2207v ) h + ( 1 \u03ba F\u0302u, v ) h ,\u2200v \u2208 Vh.\n(57) Here \u03a0p is defined in Definition 2.\nFor simplicity we will in the remainder of this section assume that the Interpolation Condition is satisfied. It follows that the reduced weak form is (54).\nWe will use a similar energy for the approximate solution in Laplace space, u\u0302h, as for the exact solution\nE2u\u0302h(s) =\n( 1\n\u03ba su\u0302h, su\u0302h ) h + \u2211\n\u03b7=x,y,z\n( 1\nS\u03b7\u03c1\n\u2202u\u0302h \u2202\u03b7 , 1\nS\u03b7\n\u2202u\u0302h \u2202\u03b7 ) h > 0 (58)\nand an energy for the data\nE2fh(s) =\n( 1\n\u03ba F\u0302u, F\u0302u ) h > 0 (59)\nThe discrete norms are defined using the same quadrature points as above. We can now formulate a stability result.\nTheorem 5 Consider the discrete weak form (54) in a piece-wise continuous heterogeneous media and with continuous damping d\u03b7(\u03b7) \u2265 0, with homogeneous initial data. Assume that the Interpolation Condition (see Definition 1) is satisfied. There exists a \u03b2h = \u03b2 + O(hp\u22121), with p being the polynomial order of the discrete space, such that for any Re(s) = a > \u03b2h the solution u\u0302h \u2208 Vh satisfies\n(a\u2212 \u03b2h)E2u\u0302h(s) \u2264 2Eu\u0302h(s)Efh(s). (60)\nHere Eu\u0302h, Efh are defined in (58)\u2013(59) and \u03b2 is defined in Theorem 1.\nProof 4 Let v = sIq ( S\u2217xS \u2217 yS \u2217 z )\u22121 u\u0302h, where Iq is the Quadrature Point Interpolant defined in Definition 1. By assumption v \u2208 Vh. Note that in the quadrature points v(q\u0304(j)i ) = s ( S\u2217xS \u2217 yS \u2217 z )\u22121 u\u0302h at q\u0304 (j) i , and that for variable damping parameters the interpolation is needed to ensure that v is in the test space. It follows that( s2\n\u03ba u\u0302h, (su\u0302h) ) h + \u2211\n\u03b7=x,y,z\n( 1\n\u03c1\n1\nS2\u03b7\n\u2202u\u0302h \u2202\u03b7 , \u2202(su\u0302h) \u2202\u03b7 ) h +\n+ \u2211\n\u03b7=x,y,z\n( 1\n\u03c1\n1\nS\u03b7\n\u2202u\u0302h \u2202\u03b7 , \u2202 \u2202\u03b7\n( Ip 1\nS\u03b7\n) su\u0302h ) h = ( 1 \u03ba F\u0302u, (su\u0302h) ) h\n(61)\nNote that \u2202\n\u2202\u03b7\n( Ip 1\nS\u03b7\n) = \u2202\n\u2202\u03b7\n( 1\nS\u03b7\n) + O(hp\u22121).\nThus adding the conjugate transpose of (61) and using Cauchy-Schwarz inequality with\n\u2223\u2223(sS\u03b7)\u2217 sS\u03b7 \u2223\u2223 = 1, gives us the desired estimate, which completes the proof.\nRemark 6 There is a corresponding stability estimate for the discrete solution in physical space. As for the continuous problem, the estimate excludes exponential growth when the damping is constant, while with variable damping it allows bounded, exponential growth.\nRemark 7 If some other quadrature is used the more general reduced form, (57), is valid. Note that the difference between integral values when using different quadratures is proportional to hp for some p > 0. Therefore we expect that when using other quadratures, or exact integration, the discrete solution u\u0302h will satisfy a similar, but slightly perturbed energy estimate."
        },
        {
            "heading": "6.2 Convergence",
            "text": "Next, we turn our attention to the question of convergence. We will prove a Theorem which is valid for constant damping coefficients, d\u03b7 \u2265 0. A discussion on how to extend the convergence proof to include continuously varying damping is given at the end of this\nsubsection. However, the lemmas in this subsection are valid also for continuously varying damping functions. In this subsection we will use the Sobolev norm \u2016 \u00b7 \u2016Hk = \u2016 \u00b7 \u2016Wk2 as well as the corresponding semi-norm |\u00b7|Hk = |\u00b7|Wk2 .\nLet Ih : H 1(\u2126) \u2192 Vh, where Vh is the space of piece-wise polynomials of degree k, be the standard Cle\u0301ment interpolation operator, see for example [22]. We will use the following variant of the standard interpolation result\n\u2016\u2207d(u\u2212 Ihu)\u2016 \u2264 \u2016\u2207(u\u2212 Ihu)\u2016 \u2264 CIhl|u|Hl+1(\u2126), (62)\nwhere CI is a constant independent of u, h and s, and 1 \u2264 l \u2264 k. Note that the first inequality in (62) holds since | 1\nS\u03b7 | \u2264 1. The second inequality holds as long as u \u2208 H l+1(\u2126).\nNext we introduce a bi-linear form that will be useful in our convergence proof. Let u and v be complex valued functions and define\nA(u, v) = \u2211\n\u03b7=x,y,z\n(s\u2217 1\n\u03c1\n1\nS2\u03b7\n\u2202u \u2202\u03b7 , \u2202v \u2202\u03b7 ). (63)\nLemma 1 Consider Re(s) = a > 0 and a given function f \u2208 L2. The bilinear form (63) can be used to formulate two problems. Find u,w \u2208 V s.t.\nA(u, v) = (f, v), \u2200v \u2208 V, A(v, w) = (v, f), \u2200v \u2208 V, (64)\nrespectively. The following inequality holds\n|A(u, v)| \u2264 \u2016\u2207du\u2016 1 \u03c1 \u2016\u2207dsv\u2016 1 \u03c1 , (65)\nas well as the following elliptic regularity results\n\u2016u\u2016H2 \u2264 CR 1\na \u2016f\u2016, \u2016w\u2016H2 \u2264 CR\n1 a \u2016f\u2016. (66)\nHere CR is a constant independent of u, h and s.\nProof 5 Note that Re(s\u2217 1 \u03c1 1 S2\u03b7 ) = 1 \u03c1|S\u03b7 |2Re( s\u2217S\u2217\u03b7 S\u03b7 ). By (35) this quantity is positive as long as Re(s) > 0, and ellipticity follows. Along with ellipticity we get the elliptic regularity result (66), see for example [8]. The inequality (65) follows easily since |S\u2217\u03b7 |/|S\u03b7| = 1.\nThanks to (35) the following Lemma can straightforwardly be proven.\nLemma 2 Consider Re(s) = a > 0. Let u and v be complex valued functions, and let A be the bilinear form defined in Lemma 1. For the bilinear form A\u0303(u, v) = A(u, v) +A\u2217(u, v). we have the following inequality\nA\u0303(u, u) \u2265 a\u2016\u2207du\u201621 \u03c1 , (67)\nWe can define finite element approximations corresponding to the two elliptic problems defined in Lemma 1. In particular we have\nLemma 3 Let uh \u2208 Vh \u2208 V be the standard finite element approximation corresponding to the first problem defined in (64), with A being the bi-linear form (63). Then uh satisfies the orthogonality\nA(uh \u2212 u, v) = 0, v \u2208 Vh (68)\nProof 6 Subtracting the variational formulation from its corresponding finite element formulation gives us the result.\nWe can then define our Ritz-projection Rh : V \u2192 Vh as:\nA(Rhu\u2212 u, v) = 0, \u2200v \u2208 Vh (69)\nThe Ritz projection satisfies the following best approximation result\nLemma 4 Assume u \u2208 V . For all Re(s) = a > 0 the Ritz projection, Rhu, defined in 69, satisfies the following best approximation result\n\u2016\u2207d(Rhu\u2212 u)\u2016 1 \u03c1 \u2264 1 a \u2016\u2207d(sv \u2212 su)\u2016 1 \u03c1 , \u2200v \u2208 Vh. (70)\nProof 7 For any v \u2208 Vh let Rhu\u2212 u = Rhu\u2212 v + v \u2212 u then it follows\na\u2016\u2207d(Rhu\u2212 u)\u201621 \u03c1 \u2264 A\u0303(Rhu\u2212 u, v \u2212 u) \u2264 \u2016\u2207d(Rhu\u2212 u)\u2016 1 \u03c1 \u2016\u2207d(sv \u2212 su\u0302)\u2016 1 \u03c1 ,\nwhere we used the orthogonality result, the Ritz projection and the inequalities (65) and (67). This concludes the proof.\nIn the next Lemma we state the convergence of the Ritz projection.\nLemma 5 Assume Re(s) = a > 0. For all u \u2208 Hk+1(\u2126) with k \u2265 1, Rhu in (69) satisfies the following two estimates\n\u2016\u2207d(Rhu\u2212 u)\u2016 \u2264 C1 1\na hk\u2016su\u2016 1 \u03c1 ,Hk+1(\u2126), (71)\nand\n\u2016Rhu\u2212 u\u2016 \u2264 C2 1\na2 hk+1\u2016s2u\u2016 1 \u03c1 ,Hk+1(\u2126). (72)\nHere C1 and C2 are constants independent of u, h and s.\nProof 8 To begin with we note that the error estimate (71) follows from Lemma 4 and the interpolation result (62).\nNext we prove the estimate (72). Let e = Rhu \u2212 u and consider the elliptic problem defined in Lemma 1. Find w \u2208 H2(\u2126) such that\nA(v, w) = (v, e), \u2200v \u2208 V (73)\nNote that the forcing is chosen to be the error e. Choosing v = e and applying the definition of our Ritz projection yields\n\u2016e\u20162 = A(e, w) = A(e, w \u2212 Ihw) \u2264 \u2016\u2207dse\u2016 1 \u03c1 \u2016\u2207d(w \u2212 Ihw)\u2016 1 \u03c1\n\u2264 C\u2217I 1\na hk\u2016s2u\u2016 1 \u03c1 ,Hk+1h|w| 1 \u03c1 ,H2 \u2264 C2\n1\na2 hk+1\u2016s2u\u2016 1 \u03c1 ,Hk+1\u2016e\u2016,\nwhere we used the interpolation result (62) together with result (71) and elliptic regularity (66). The constants C\u2217I and C2 = C \u2217 ICR are constants independent of u, s and h. C \u2217 I is obtained from applying the interpolation result (62) two times and C2 = C \u2217 ICR, where CR comes from applying (66). This concludes the proof.\nFinally we will show convergence of the reduced weak form (54). Our convergence result is for the case of constant damping. Thus the reduced weak form (54) is equivalent to\n( s2\n\u03ba u\u0302h, v) + \u2211 \u03b7=x,y,z ( S\u2217\u03b7 S\u03b7 1 \u03c1 1 S\u03b7 \u2202u\u0302h \u2202\u03b7 , 1 S\u03b7 \u2202v \u2202\u03b7 ) = (F, v), \u2200v \u2208 Vh (74)\nClearly the solution u\u0302 of the continuous problem satisfies the same reduced weak form for \u2200v \u2208 V . For this weak form we have\nTheorem 6 For any s \u2208 C, with Re(s) = a > 0 the solution u\u0302h to (74) with constant damping satisfies the a priori estimate\n\u2016u\u0302h \u2212 u\u0302\u2016 \u2264 Chk+1 ( 1\na3 \u2016s3u\u0302\u2016Hk+1(\u2126) +\n1\na2 \u2016s2u\u0302\u2016Hk+1(\u2126)\n) . (75)\nHere u\u0302 is assumed to be a sufficiently smooth solution of the corresponding continuous problem and C is a constant independent of h, u\u0302 and s.\nProof 9 Let e = u\u0302h\u2212 u\u0302 and introduce \u03be = u\u0302h\u2212Rhu\u0302 and \u03b3 = Rhu\u0302\u2212 u\u0302 so that e = \u03be+\u03b3. For \u03b3 we have the error estimate in Lemma 5. What remains is to find a bound for \u03be as well. We have\n(s2(\u03be + \u03b3), v) + \u2211\n\u03b7=x,y,z\n( 1\n\u03c1S2\u03b7\n\u2202(\u03be + \u03b3) \u2202\u03b7 , \u2202v \u2202\u03b7 ) = 0.\nWe let v = s\u03be and get\ns\u2016s\u03be\u20162 + \u2211\n\u03b7=x,y,z\n( s\u2217S\u2217\u03b7 S\u03b7\u03c1 1 S\u03b7 \u2202\u03be \u2202\u03b7 , 1 S\u03b7 \u2202\u03be \u2202\u03b7 ) = \u2212(s2\u03b3, s\u03be)\u2212 \u2211 \u03b7=x,y,z ( s\u2217 S2\u03b7\u03c1 \u2202\u03b3 \u2202\u03b7 , \u2202\u03be \u2202\u03b7 ).\nThe last term disappear by the Ritz projection (69). Adding conjugate to both sides yields\na(\u2016s\u03be\u20162 + \u2016\u2207d\u03be\u20162) \u2264 \u2016s2\u03b3\u2016\u2016s\u03be\u2016\nwhich further gives us\n\u2016s\u03be\u2016 \u2264 1 a \u2016s2\u03b3\u2016 \u2264 1 a \u2016s2(Rhu\u0302\u2212 u\u0302)\u2016 \u2264\nhk+1\na3 \u2016s4u\u0302\u2016Hk+1 . (76)\nNote that \u2016s\u03be\u2016 = |s|\u2016\u03be\u2016 and \u2016s4u\u2016Hk+1 = |s|\u2016s3u\u0302\u2016Hk+1. We now have our estimate of\n\u2016\u03be\u2016 \u2264 Ch k+1\na3 \u2016s3u\u0302\u2016Hk+1 (77)\nCombining (77) and Lemma 5 together with the triangle inequality we get our desired result.\nRemark 8 Theorem 6 was proven for constant damping coefficients d\u03b7. To show the corresponding convergence result for varying damping coefficients we need a discrete stability result, which is based on exact integration. As discussed above such a stability result is likely to be a perturbation of the stability estimate for the particular discretization discussed in Section 6.1. It is therefore not surprising that good convergence properties are seen in Section 7 for our discretizations of the variable damping case."
        },
        {
            "heading": "7 Numerical Experiments",
            "text": "In this section, we present some numerical experiments to validate the theoretical results presented in Section 6, as well as to quantify the numerical PML errors.\nAll the experiments in this section are performed in 2D on the domain \u2126T = [\u22126, 6] \u00d7 [\u22126, 6] with PML layer size \u2206pml = 0.6 along all sides. We denote the original domain, i.e. the domain without PML as \u2126in = [\u22125.4, 5.4]\u00d7 [\u22125.4, 5.4]. We use the spatial discretisation presented in Section 5. In the experiments, we use standard continuous square quadrilateral Lagrange elements, Qp, for the solution u, where p = 1, 2, 3 denotes the order of the Lagrange polynomials. To match the theory we use discontinuous square quadrilateral Lagrange elements for the auxiliary variables. Gauss-Legendre quadrature nodes are used for integration over the elements. As boundary condition, we use the Dirichlet boundary condition defined in equation (4), which is imposed strongly. The initial condition is set to zero and we have a forcing function in the form of a Gaussian pulse centered at (0, 0). For all experiments, we let the damping profile be defined as\ndx =\n{ d0( |x|\u22125.4 \u2206pml\n)3, if |x| \u2265 5.4 0, otherwise\n(78)\ndy =\n{ d0( |y|\u22125.4 \u2206pml\n)3, if |y| \u2265 5.4 0, otherwise\n(79)\nwhere d0 \u2265 0 is the damping strength coefficient and it is chosen as in [16] to balance the modeling error and the discretisation error. It is given by\nd0 = 4c\n2\u2206pml ln(\n1\ntol ) (80)\nwhere \u2206pml is the PML-width, c is the wave-speed and tol is chosen as\ntol = C0\n[ 1\n\u2206pml\nh\np+ 1\n]p+1 . (81)\nHere p is the order of the polynomial approximation, h is the element size, and C0 = 2. The PML error tolerance, tol, is controlled by the PML with \u2206pml, the order of the polynomial approximation p, and the element size h. For a PML of finite thickness the PML error will converge to zero at the rate of the accuracy of the underlying numerical method [16, 17, 15].\nFor time integration we will use the fourth-order Runge-Kutta method."
        },
        {
            "heading": "7.1 Homogeneous problem",
            "text": "In this subsection we consider the homogeneous case i.e. \u03ba = \u03c1 = 1, and first investigate the numerical PML-error in maximum norm. In order to measure the numerical PML-error, we simulate both the PML problem as described in this section, as well as a reference problem. The reference problem is a problem defined on the larger domain \u2126r = [\u221212, 12]\u00d7 [\u221212, 12], on which we solve the wave equation without any PML. The size of \u2126r is chosen so that the reflections from the outer boundary will not reach \u2126in during the simulation. We use the same initial condition, the same source, the same time step, and the same spatial resolution. The numerical PML-error is defined as the difference between the PML solution and the reference solution, and is calculated at every node in \u2126in, and at every time step. The simulation is performed for t \u2208 [0, 10]. At the end of this time interval a reflected wave in the reference problem will just have reached the outer boundary of \u2126in. The computations are done with Q1, Q2, and Q3 elements, as well as for different element sizes. We use a time step \u2206t = 0.01 for all the elements and all spatial resolutions. This time step is chosen so that the dominant error for all resolutions and all orders will come from the space discretisation.\nIn Figures 2a, 2b, and 2c we have plotted the maximum PML-error in \u2126in as a function of time for different resolutions and for different polynomial orders. In Figure 2d the convergence of the PML-error in maximum norm can be seen. The error is measured at the end time t = 10. We can see that the solution converges with at least the expected rates as we refine the element size.\nTo verify the stability results from Section 6 we look at the long-time behavior of our simulated PML-problem. For this purpose solve the same problem as before but for times t \u2208 [0, 150], so that we can see what happens when the simulation is allowed to run for a longer time. We then measure the maximum amplitude of our solution in \u2126in. The result can be seen in Figure 1a. Note that no long-time growth of the solution can be observed.\nIn Figure 3 we can see snapshots of the solution at times t = 2, t = 4, t = 6 and t = 12. We can follow how the Gaussian pulse propagates in \u2126in and vanishes as it enters the PML."
        },
        {
            "heading": "7.2 Heterogeneous problem",
            "text": "Next we consider the heterogeneous problem. The setup is the same as for the homogeneous problem except that we let the wave speed vary in the domain and we have chosen our end time to be t = 14 to make up for the lower wave speed. The wave speed is chosen as\nc(x, y) =  0.75, y > 2.4\n1, |y| \u2264 2.4. 1.25, y < \u22122.4\n(82)\nNote that the element boundaries are chosen so that they aline with the material interfaces.\nWe perform the same experiments for the heterogeneous case as for the homogeneous case. In Figures 4a, 4b and 4c we can see the maximum PML error as a function of time for different resolutions and for different elements Q1, Q2 and Q3.\nIn Figure 4d we can see the convergence of the PML-error in maximum norm at the end time t = 14. We can note that the convergence rate is slightly lower than expected for the Q3 elements.\nIn Figure 1b we can see the long-time behavior of the solution to the heterogeneous problem. To capture the long-time behavior we run the simulation until t = 150, just as in the homogeneous case. No asymptotic growth is observed, which again agrees with the stability analysis in Section 6. Finally, we can see snapshots of the solution at different times in Figure 5. We can follow how the Gaussian pulse propagates and vanishes as it enters the PML. One can also see that the wave spreads faster when y < \u22122.4 and slower when y > 2.4."
        },
        {
            "heading": "8 Summary and Discussion",
            "text": "We have presented a stable FEM for the acoustic wave equation on second-order form with a PML. To begin with, we prove an energy estimate in Laplace space, which extends the result in [17] from constant damping to continuously varying damping. We also formulate the problem weakly in terms of a bi-linear form. In this formulation, we use the standard H1 space for the physical variable and a combination of H1 and L2 spaces for the auxiliary variables. Our FEM is then obtained by restricting to the corresponding continuous and discontinuous piece-wise polynomial finite-dimensional subspaces. The chosen weak form allows us to mimic the energy estimate in a discrete setting.\nAn a priori error estimate for the case of constant damping follows by applying standard\ntechniques in Laplace space. It indicates convergence of order p + 1, where p is the local polynomial order. For variable damping, a technical difficulty is related to the fact that the discrete stability relies on quadrature while exact integration is used in the continuous case. This prevents the straightforward extension of the convergence result to spatially varying damping.\nNumerical experiments for the case of varying damping verify the stability and convergence results. We compute in 2 space dimensions and use square, Cartesian elements. Note that the theoretical results presented in Section 6 are more general and cover the 3D problem with no hanging nodes as the only restriction on element shape. Therefore we are confident that when the method is applied to a 3D problem, it will be stable and have good accuracy properties.\nNote that the method uses a discontinuous function space for some of the auxiliary variables. Experiments using continuous function spaces for all variables were also performed, but with less accurate results. The degradation of accuracy was pronounced for piece-wise linears, in analogy with results in [10].\nA standard approach to stability is to derive energy estimates in physical space. The analysis in this paper is done in Laplace space, both for the continuous and the discrete problems. It demonstrates how an energy estimate in Laplace space for the continuous problem can be transformed to stability and accuracy results for a discrete method. By performing analysis in Laplace space, the energy approach is applicable to many more problems, and it is our expectation that the techniques presented in this paper will be useful for many different problems."
        },
        {
            "heading": "Acknowledgments",
            "text": "This research was partially supported by the Swedish Research Council."
        }
    ],
    "title": "On energy-stable and high order finite element methods for the wave equation in heterogeneous media with perfectly matched layers",
    "year": 2022
}