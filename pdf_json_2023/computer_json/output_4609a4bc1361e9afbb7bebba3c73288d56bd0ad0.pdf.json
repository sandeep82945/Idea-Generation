{
    "abstractText": "This paper proposes a method of passively estimating the parameters of frequency-modulated-continuous-wave (FMCW) radar signals with a wide range of structural parameter values and analyzes how a malicious actor could employ such estimates to track and spoof a target radar. When radars are implemented to support automated driver assistance systems, an intelligent spoofer has the potential to substantially disrupt safe navigation by inducing its target to perceive false objects. Such a spoofer must acquire highly accurate estimates of the target radar\u2019s chirp sweep, timing, and frequency parameters while additionally tracking and compensating for time and Doppler shifts due to clock errors and relative movement. This is a difficult task for millimeter-wave radars due to severe Doppler shifts and fast sweep rates, especially when the spoofer uses off-the-shelf FMCW equipment. Algorithms and techniques for acquiring and tracking an FMCW radar are proposed and verified through simulation, which will help guide future decisions on appropriate radar spoofing countermeasures.",
    "authors": [
        {
            "affiliations": [],
            "name": "Andrew M. Graff"
        },
        {
            "affiliations": [],
            "name": "Todd E. Humphreys"
        }
    ],
    "id": "SP:cc54daeb7c2c2c665329dc50dcda1e1123afcc9a",
    "references": [
        {
            "authors": [
                "J. Hasch",
                "E. Topak",
                "R. Schnabel",
                "T. Zwick",
                "R. Weigel",
                "C. Waldschmidt"
            ],
            "title": "Millimeter-wave technology for automotive radar sensors in the 77 GHz frequency band",
            "venue": "IEEE Transactions on Microwave Theory and Techniques, vol. 60, no. 3, pp. 845\u2013860, 2012.",
            "year": 2012
        },
        {
            "authors": [
                "S. Sun",
                "A.P. Petropulu",
                "H.V. Poor"
            ],
            "title": "MIMO radar for advanced driver-assistance systems and autonomous driving: Advantages and challenges",
            "venue": "IEEE Signal Processing Magazine, vol. 37, no. 4, pp. 98\u2013 117, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "S.M. Patole",
                "M. Torlak",
                "D. Wang",
                "M. Ali"
            ],
            "title": "Automotive radars: A review of signal processing techniques",
            "venue": "IEEE Signal Processing Magazine, vol. 34, no. 2, pp. 22\u201335, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "F. Engels",
                "P. Heidenreich",
                "A.M. Zoubir",
                "F.K. Jondral",
                "M. Wintermantel"
            ],
            "title": "Advances in automotive radar: A framework on computationally efficient high-resolution frequency estimation",
            "venue": "IEEE Signal Processing Magazine, vol. 34, no. 2, pp. 36\u201346, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "W.A. Lies",
                "L. Narula",
                "P.A. Iannucci",
                "T.E. Humphreys"
            ],
            "title": "Longrange, low SWaP-C FMCW radar",
            "venue": "IEEE Journal of Selected Topics in Signal Processing, pp. 1\u20131, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M. Ahrholdt"
            ],
            "title": "D12.1-study report on relevant scenarios and applications and requirements specification",
            "venue": "European Commission: MOre Safety for All by Radar Interference Mitigation (MOSARIM), 2010.",
            "year": 2010
        },
        {
            "authors": [
                "M. Kunert"
            ],
            "title": "D1.5-study on the state-of-the-art interference mitigation techniques",
            "venue": "European Commission: MOre Safety for All by Radar Interference Mitigation (MOSARIM), 2010.",
            "year": 2010
        },
        {
            "authors": [
                "S. Alland",
                "W. Stark",
                "M. Ali",
                "M. Hegde"
            ],
            "title": "Interference in automotive radar systems: Characteristics, mitigation techniques, and current and future research",
            "venue": "IEEE Signal Processing Magazine, vol. 36, no. 5, pp. 45\u201359, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "R. Komissarov",
                "A. Wool"
            ],
            "title": "Spoofing attacks against vehicular FMCW radar",
            "venue": "Proceedings of the 5th Workshop on Attacks and Solutions in Hardware Security, 2021, pp. 91\u201397.",
            "year": 2021
        },
        {
            "authors": [
                "N. Miura",
                "T. Machida",
                "K. Matsuda",
                "M. Nagata",
                "S. Nashimoto",
                "D. Suzuki"
            ],
            "title": "A low-cost replica-based distance-spoofing attack on mmWave FMCW radar",
            "venue": "Proceedings of the 3rd ACM Workshop on Attacks and Solutions in Hardware Security Workshop, 2019, pp. 95\u2013 100.",
            "year": 2019
        },
        {
            "authors": [
                "M. Ordean",
                "F.D. Garcia"
            ],
            "title": "Millimeter-wave automotive radar spoofing",
            "venue": "arXiv preprint arXiv:2205.06567, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "P. Nallabolu",
                "C. Li"
            ],
            "title": "A frequency-domain spoofing attack on FMCW radars and its mitigation technique based on a hybrid-chirp waveform",
            "venue": "IEEE Transactions on Microwave Theory and Techniques, vol. 69, no. 11, pp. 5086\u20135098, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "Z. Sun",
                "S. Balakrishnan",
                "L. Su",
                "A. Bhuyan",
                "P. Wang",
                "C. Qiao"
            ],
            "title": "Who is in control? Practical physical layer attack and defense for mmWave-based sensing in autonomous vehicles",
            "venue": "IEEE Transactions on Information Forensics and Security, vol. 16, pp. 3199\u20133214, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M. Gardill",
                "J. Schwendner",
                "J. Fuchs"
            ],
            "title": "In-situ time-frequency analysis of the 77 GHz bands using a commercial chirp-sequence automotive FMCW radar sensor",
            "venue": "2019 IEEE MTT-S International Microwave Symposium (IMS). IEEE, 2019, pp. 544\u2013547.",
            "year": 2019
        },
        {
            "authors": [
                "\u2014\u2014"
            ],
            "title": "An approach to over-the-air synchronization of commercial chirpsequence automotive radar sensors",
            "venue": "2020 IEEE Topical Conference on Wireless Sensors and Sensor Networks (WiSNeT). IEEE, 2020, pp. 46\u201349.",
            "year": 2020
        },
        {
            "authors": [
                "S. Roehr",
                "P. Gulden",
                "M. Vossiek"
            ],
            "title": "Method for high precision clock synchronization in wireless systems with application to radio navigation",
            "venue": "2007 IEEE Radio and Wireless Symposium. IEEE, 2007, pp. 551\u2013554.",
            "year": 2007
        },
        {
            "authors": [
                "F. Lampel"
            ],
            "title": "System level synchronization of phase-coded FMCW automotive radars for RadCom",
            "venue": "2020 14th European Conference on Antennas and Propagation (EuCAP). IEEE, 2020, pp. 1\u20135.",
            "year": 2020
        },
        {
            "authors": [
                "V. Krishnamurthy",
                "K. Pattanayak",
                "S. Gogineni",
                "B. Kang",
                "M. Rangaswamy"
            ],
            "title": "Adversarial radar inference: Inverse tracking, identifying cognition, and designing smart interference",
            "venue": "IEEE Transactions on Aerospace and Electronic Systems, vol. 57, no. 4, pp. 2067\u20132081, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "R.G. Brown",
                "P.Y. Hwang"
            ],
            "title": "Introduction to Random Signals and Applied Kalman Filtering",
            "year": 2012
        },
        {
            "authors": [
                "R. Mucci"
            ],
            "title": "A comparison of efficient beamforming algorithms",
            "venue": "IEEE Transactions on Acoustics, Speech, and Signal Processing, vol. 32, no. 3, pp. 548\u2013558, 1984.",
            "year": 1984
        },
        {
            "authors": [
                "Y. Tsin",
                "T. Kanade"
            ],
            "title": "A correlation-based approach to robust point set registration",
            "venue": "European conference on computer vision. Springer, 2004, pp. 558\u2013569.",
            "year": 2004
        },
        {
            "authors": [
                "A.J. Viterbi",
                "A.M. Viterbi"
            ],
            "title": "Nonlinear estimation of PSK-modulated carrier phase with application to burst digital transmission",
            "venue": "IEEE Transactions on Information theory, vol. 29, no. 4, pp. 543\u2013551, 1983. 7",
            "year": 1983
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014FMCW, radar, passive, spoofing, mmWave\nI. INTRODUCTION\nFrequency-modulated continuous-wave (FMCW) radars operate by transmitting a sequence of multiple linear chirps called a frame. After reflecting off an object, the received signal is mixed with a replica of the transmitted chirp sequence, resulting in a sinusoid whose frequency indicates the range to the reflecting object. By examining the phase shifts of this sinusoid across multiple chirps, a radar can estimate the object\u2019s relative velocity. Furthermore, an FMCW radar can estimate an object\u2019s direction by examining the phase shifts across elements in its antenna array.\nMillimeter-wave (mmWave) radars have significantly improved radar precision [1], providing benefits over alternative sensors for use in automated driver assistance systems (ADAS) and autonomous vehicle (AV) platforms [2], [3]. Radars are currently deployed in ADAS for adaptive cruise control, forward collision avoidance, and lane-change assist, among others [4]. In more advanced systems, these radars may be used for imaging by providing point cloud data to computer vision systems within AVs [2]. Beyond the automotive industry, these radars can provide precise sensing for urban air mobility applications [5]. With an ever increasing number of automated systems relying on mmWave FMCW radar, it is crucial that these sensors remain secure against potential threats.\nSince typical fast-chirp mmWave FMCW radars use an intermediate frequency (IF) bandwidth in the 10s of MHz and\nchirp slopes in the 10s of MHz/\u00b5s, these radars only sample a thin sliver of the time-frequency spectrum at any instant, making it unlikely that persistent interference will appear in the band of sensitivity and manifest as a false reflecting object [6], [7]. However, existing fast-chirp processing is susceptible to deliberate spoofing. By controlling the time-of-arrival and frequency offset of the spoofing signal, an attacker can induce the target receiver to perceive fake objects at any arbitrary range and velocity. Since FMCW radars are the most widely used radars in automotive vehicles [8], such spoofing could have widespread ramifications.\nPrevious studies on radar spoofing have focused directly on the mechanics of a spoofing attack, demonstrating FMCW spoofing attacks with commercial-off-the-shelf (COTS) devices [9], [10], [11], with custom boards [12], and with an AV testbed [13]. However, this work assumes that the spoofer already knows the target radar\u2019s waveform, which is unlikely in a real-world scenario. Furthermore, the advanced spoofing attack in [13] was carried out using high-end test equipment, which may not be representative of the most common radar spoofing threats. Separate from spoofing literature, the related problem of FMCW parameter estimation and synchronization has been examined. Gardill et al. proposed a method of finding an unknown FMCW signal by analyzing the time-frequency spectrum of interference when mixed with a local fast-sweeprate FMCW signal [14]. Their study was then extended to demonstrate how such a tactic could be used to first estimate signal parameters, switch the local mixer to a CW signal to obtain precise timing, and then switch the local mixer to a time-aligned replica of the transmitted signal [15]. While these studies did not directly address FMCW spoofing, they show that synchronization schemes are practical and that issues such as timing jitter can be accounted for. However, the papers do not propose a rigorous method of chirp parameter estimation and tracking. Other work has focused purely on synchronizing FMCW systems when the signal shape is known [16], [17]. Work on counter-adversarial tracking has also analyzed the estimation and countering of cognitive radars [18].\nPrior work has studied passive FMCW parameter estimation and FMCW spoofing attacks but falls short of detailing a comprehensive attack that can be carried out using COTS radars without prior signal knowledge. This paper addresses these gaps so future work can evaluate effective countermeasures.\n979-8-3503-1114-3/23/$31.00 \u00a92023 IEEE Preprint of the 2023 IEEE 97th Vehicular Technology Conference Florence, Italy, June 20-23, 2023\nar X\niv :2\n30 7.\n11 07\n2v 1\n[ ee\nss .S\nP] 2\n0 Ju\nl 2 02\n3"
        },
        {
            "heading": "II. SYSTEM MODEL",
            "text": "Consider an environment where there is a set of radars I, all with standard FMCW architectures, and each having one or more transmit and receive antennas. Each radar has a signal generator that creates linear frequency chirps. A sequence of these chirps, called a frame, is generated and processed coherently. The number of chirps depends on the desired Doppler resolution and can range between tens and hundreds of chirps per frame. Each chirp signal is sent to one or more transmit antennas and to a mixer that takes its other input from the receive antennas. Let the transmitted signal of the kth chirp in the ith radar\u2019s frame be denoted as sik(t), where i \u2208 I and k \u2208 Ki, with Ki being the set of chirps in one frame from radar i. The kth chirp has a start frequency fik, a chirp slope \u03b2ik, a phase offset \u03d5ik, and a duration Tik. A baseband model of the ith radar\u2019s kth chirp is\ncik(t) =\n{ exp ( j2\u03c0 ( fikt+ \u03b2ikt 2\n2\n) + j\u03d5ik ) t \u2208 [0, Tik)\n0 otherwise . (1)\nThis chirp signal is sent to one or more transmit antennas with some complex weighting. Assume that radar i has NTX,i transmit antennas and NRX,i receive antennas. Let the vector of transmit antenna weights for chirp k on radar i be wik \u2208 CNTX,i\u00d71. For this paper, wik is assumed to be one-hot, meaning that it contains only one nonzero element. However, MIMO radars may use orthogonal codes such as Hadamard codes across multiple antennas, in which case every element of wik would contain \u00b11 in accordance with the code. Additionally, wik may apply a binary phase-shift keying (BPSK) or quadrature phase-shift keying (QPSK) phase code across each chirp k. Each chirp signal is delayed \u2206tik seconds after the beginning of the frame and weighted by the vector wik, creating the transmitted signal\nsi(t) = \u2211 k\u2208K wikcik(t\u2212\u2206tik), (2)\nwhich propagates along several paths to the receive antennas. Let Ril be a set of paths from radar l to radar i. In the case of monostatic radar, the transmit and receive radars are the same, and this set can be written as Rii. Focusing on the monostatic case, the signal in each path r \u2208 Rii experiences a propagation delay \u2206tr and arrives with a receive magnitude \u03b1ir. Due to the antenna array manifold, relative phase shifts are imparted on the signal depending upon the angles of departure and arrival of each path. The transmitter array phase shift is given by aTX,ir \u2208 CNTX,i\u00d71 and the receiver array phase shift is given by aRX,ir \u2208 CNRX,i\u00d71 for the rth path. Lastly, the signal propagating along the rth path experiences a Doppler shift fD,r arising from the motion of the radar and the reflecting object. This shift is modeled as a multiplication of the signal by \u03bdr(t) = exp (j2\u03c0fD,rt). The received signal across all receive antennas is then given by the vector\nxi(t) = \u2211 r\u2208Rii \u03b1iraRX,ira \u22a4 TX,irsi(t\u2212\u2206tr)\u03bdr(t). (3)\nIn addition to this monostatic signal, radar i will receive interference from other radars in the environment. The interference signal received at radar i is\nx\u0303i(t) = \u2211\nl\u2208I\\{i} \u2211 r\u2208Ril \u03b1iraRX,ira \u22a4 TX,lrsl(t\u2212\u2206tr)\u03bdr(t). (4)\nThe sum xi(t)+x\u0303i(t) is mixed with the conjugate transpose of radar i\u2019s local signal given in (2), passed through a lowpass anti-aliasing filter with impulse response h(t), and sampled with period Ts, creating the NRX,i \u00d7NTX,i matrix Yi[n]:\nYi(t) = (xi(t) + x\u0303i(t)) s H i (t). (5)\nYi[n] = \u222b \u221e \u2212\u221e h(nTs \u2212 \u03c4)Yi(\u03c4) d\u03c4. (6)\nConsider the mixed signals originating from a different radar. Let mikr\nlk\u0303 (t) be the resulting signal when the k\u0303th\ntransmitted chirp from radar l is received along path r by radar i and mixed with its kth chirp:\nmikr lk\u0303 (t) = clk\u0303(t\u2212\u2206tr)c \u2217 ik(t)\u03bdr(t) (7) =exp ( j2\u03c0 ( (flk\u0303 \u2212 fik)t\u2212 \u03b2lk\u0303\u2206trt+ fD,rt\u2212 flk\u0303\u2206tr\n+ 12 (\u03b2lk\u0303 \u2212 \u03b2ik)t 2 + 12\u03b2l,k\u0303\u2206t 2 r ) + j(\u03d5lk\u0303 \u2212 \u03d5ik) ) .\nThis is a linear chirp with a slope of \u03b2lk\u0303 \u2212 \u03b2ik, a start frequency of flk\u0303 \u2212 fik \u2212 \u03b2lk\u0303\u2206tr + fD,r, and a phase shift of \u22122\u03c0flk\u0303\u2206tr + \u03c0\u03b2lk\u0303\u2206t2r + \u03d5lk\u0303 \u2212 \u03d5ik.\nReal-world radar systems are prone to clock errors, and the system model must account for their effects, especially in the case of bistatic propagation where the two radars are unsynchronized. Therefore, the clock frequency and phase drifts are modeled with the two-state model described in [19, Chapter 9.3]. This model is parameterized by two Allan variance parameters, h0 and h\u22122. Consider two white-noise processes, Fi(t) and Gi(t), with spectral densitiesSf,i \u2248 h02 and Sg,i \u2248 2\u03c02h\u22122, respectively. The time perceived at radar i is t\u0303i(t), a function of the true time t:\nt\u0303i(t) = t+ \u222b t 0 Fi(\u03c4f ) + \u222b \u03c4f 0 Gi(\u03c4g) d\u03c4g d\u03c4f . (8)\nConsidering only the azimuth dimension, propagation path r has an angle of arrival \u03b8AOA,r and an angle of departure \u03b8AOD,r. Each radar\u2019s antennas have a gain as a function of angle, GRX,i(\u03b8) and GTX,i(\u03b8). The signal experiences a path loss of Lprop,r, which may be one-way for a direct path, or two-way for a reflected path. The reflection in the path has a radar cross section of \u03c3RCS,r. The total received power is PRX,ir = PTX,lGRX,i(\u03b8AOA,r)GTX,l(\u03b8AOD,r)L\u22121prop,r\u03c3RCS; the received magnitude is \u03b1ir = \u221a PRX,ir."
        },
        {
            "heading": "III. FMCW ENTRAINMENT",
            "text": "Consider an instance of the signal model where the set of radars includes one target radar l and one spoofer radar i. The spoofer aims to transmit a false replica of the target\u2019s signal, causing the target radar to perceive a fake object. However, the spoofer is assumed to have no prior knowledge of the\ntarget\u2019s signal structure other than it taking the form of a mmWave FMCW signal with repeating frames. To recreate the target signal accurately for spoofing, the spoofer must have an estimate of the parameters in Table I. These are the parameters as perceived by the spoofer which may be different from the true target parameters due to ambiguities caused by the clocks, timing, Doppler, and chirp phase shifts. Furthermore, the spoofer is assumed to use COTS FMCW radar equipment. While a wideband mmWave receiver may be capable of easily estimating these parameters after capturing the entire chirp sequence, the small IF bandwidth of COTS FMCW radars complicates this task. Instead, the spoofer must strategically design its mixing signal to collect information about the spectrum and the target signal, only receiving useful samples when the target and mixing signals are close in frequency. The spoofing scheme proposed here offers one possible strategy for estimating the target signal\u2019s parameter under these constraints.\nThe proposed FMCW spoofing attack can be divided into three stages: (1) an identification stage where the spoofer samples the spectrum to discover a target radar signal and coarsely estimates the target\u2019s parameters, (2) a tracking stage where the spoofer refines its parameter estimates and tracks the signal with greater precision, and (3) a spoofing stage where the spoofer transmits a signal with the intent of appearing as a fake object to the target radar. This paper focuses on the first two stages, which will collectively be called signal entrainment.\nA. Identification\nDuring the identification stage, the spoofer operates passively and attempts to find an FMCW radar to target. Throughout this stage, the spoofer restricts its signal to a constant frequency tone with frequency ftone. First, the spoofer attempts to detect the presence of an FMCW signal. From (7), the mixed output of a chirp with a constant frequency tone (i.e., fik = ftone and \u03b2ik = 0) is a chirp whose instantaneous frequency is \u03b2lk\u0303(t\u2212\u2206tr)+flk\u0303\u2212ftone +fD,r. Due to the antialiasing filter, this signal will be filtered out except for the short time-span when the instaneous frequency is near zero. Fig. 1 visualizes one instance of such a signal. Due to the one-way path loss of the target-spoofer system and beamforming, this signal is easily detectable above the noise floor without any pulse integration. Recall that wik and, consequently, si(t) are assumed to be one-hot. From (5), this assumption means Yi[n] has only one non-zero column. Let this column be written as yi[n] with shape NRX,i\u00d71 in this specific case. Beamforming\nis performed with an FFT [3], [20] of yi[n] across the receive antenna dimension, creating the beamformed vector y\u0303i[n], whose bth element corresponds to the bth beamforming bin. Assuming an oversampling factor of Nos, y\u0303i[n] has the shape NosNRX,i \u00d7 1.\nFirst, the spoofer determines which sample index n and beamforming bin b contain the maximum power: {n\u0302max, b\u0302max} = argmaxn,b | (y\u0303i[n])b |2. The spoofer then uses a constant false alarm rate (CFAR) detector [21, Chapter 6.5] on the power-maximizing beamformed signal (y\u0303i[n])b\u0302max to create a set of detections Dsample containing sample indices and frequencies (n\u0302, f\u0302). The frequencies come from the known frequency of the spoofer\u2019s mixer, ftone. The set of detections Dsample is consolidated by replacing groups of neighboring sample indices n\u0302 with a single detection at the center sample of each group. Lastly, a new set D is created where D = {(nTs, f) : (n, f) \u2208 Dsample}, converting the sample indices to times.\nNow, the spoofer estimates the frame interval Tframe and frame timing offset \u2206tframe, which are defined graphically as shown in Fig. 2. The spoofer collects two captures of samples while mixing the received signal with a constant frequency tone for Tcapture seconds each. Tcapture is chosen to be long enough to contain at least two repetitions of the target radar\u2019s frame, whose interval Tframe is unknown to the spoofer but can be reasonably bounded. The samples from both captures are passed through the same CFAR detector, creating two sets of detections: D1 and D2. Note that f1 = f2 = ftone since the mixing frequency has not changed. These detections are\nvisualized in relation to the frame parameters in Fig. 2 and to the chirp parameters in Fig. 3. Since the spoofer currently has no reference of the target\u2019s frame timing, the spoofer does not yet know which frame each detection belongs to. To estimate the frame timing under this ambiguity, the spoofer analyzes the periodicity of the detections. This is done by evaluating how well these two sets match over shifts in time using a Gaussian kernel likelihood function k(t1, t2, \u03c3) = exp ( \u2212|t1\u2212t2|2\n\u03c32\n) .\nThis approach is inspired by kernel correlation techniques used in point-set registration [22]. The sum kernel likelihood between the sets for a lag l is\nd(l) = \u2211\n(t1,f1)\u2208D1 \u2211 (t2,f2)\u2208D2 k(t1, t2 \u2212 l, \u03c3). (9)\nThe kernel standard deviation \u03c3 is chosen to be greater than the longest possible chirp interval and less than the shortest possible frame interval, causing the function d(l) to smooth over small time differences between the two sets. The result is a function that exhibits multiple peaks with an inter-peak distance approximately equal to the frame interval, from which one may obtain an estimate T\u0302frame. Fig. 4a shows an example of this sum kernel likelihood function.\nThe spoofer then estimates the frame timing offset \u2206tframe. Since there is an inherent ambiguity between the frame timing offset and the chirp timing offsets relative to the frame start, the spoofer has flexibility in selecting this value. However, it is important that the chosen offset does not cause the estimated\nframes to contain detections from two of the target\u2019s frames. To minimize this possibility, \u2206tframe is chosen as the time that minimizes the mean squared distance between the detection times and the center of the nearest frame. The two sets of detections are combined to form D = D1\u222aD2, and the frame offset \u2206tframe is estimated as\n\u2206t\u0302frame = (10)\nargmin \u2206tframe\u2208[0,T\u0302frame] \u2211 (t,f)\u2208D \u2223\u2223\u2223\u2223\u2223((t\u2212\u2206tframe) mod T\u0302frame)\u2212 T\u0302frame2 \u2223\u2223\u2223\u2223\u2223 2 .\nWith an estimate of the frame interval and a frame time offset that centers the chirp sequence in the frame, the spoofer can now partition its detections into each frame and further refine its frame interval estimate. Similar to the first frame interval estimation, a kernel likelihood measure is used. First, define a function g(t, l) = (t \u2212 \u2206t\u0302frame) mod (T\u0302frame \u2212 l), and let \u03c3ref be a refined kernel standard deviation, which is chosen to be less than the minimum chirp duration but larger than the spoofer\u2019s desired time resolution. Then the sum kernel likelihood using the refined kernel is\ndref(l) = \u2211\n(t1,f1)\u2208D \u2211 (t2,f2)\u2208D k(g(t1, l), g(t2, l), \u03c3ref). (11)\nThe frame interval estimate error is given by the value l that maximizes the refined kernel likelihood: l\u0302max = argmaxl dref(l). This likelihood function is visualized in Fig. 4b. Using this error, the spoofer creates a new set of detections that accounts for the refined frame timing estimate:\nDframe = {(g(t, l\u0302max), f) : (t, f) \u2208 D}. (12)\nFinally, the frame interval estimate T\u0302frame is adjusted by l\u0302max seconds for future captures. Frame timing estimation is complete now that the spoofer has estimates T\u0302frame and \u2206t\u0302frame.\nNext, the spoofer identifies each chirp in the frame. Chirps from different frames are matched by their proximity in time in the new set Dframe. The matching criterion for (t1, f1) \u2208 Dframe and (t2, f2) \u2208 Dframe is (t1 \u2212 t2)2 < \u03c32chirp. Each unique set of matching detection times is considered a detected chirp, creating an initial estimate of the set of chirps K\u0302. Each chirp\u2019s time offset is set equal to the average of the detection times matched to that chirp. The chirp timing threshold \u03c3chirp is chosen to be larger than the worst-case timing jitter and less than the minimum inter-chirp time.\nNow that the spoofer has a sense of the target radar\u2019s frame timing and chirp locations, the spoofer can begin sampling frequencies to determine each chirp\u2019s duration Tk, start time \u2206tk, start frequency \u2206fk, and slope \u03b2k. The spoofer captures samples for Msearch frames, mixing with a different constant frequency tone fm, \u2200m \u2208 {1, . . . ,Msearch} in the mth frame. In this paper, fm were linearly spaced in frequency, but other strategies are possible. As before, the spoofer creates a set of detections Dsearch, from which it estimates each chirp\u2019s parameters using Algorithm 1, which associates likely detections with each chirp, performs a least-squares regression,\nand updates the covariance of its parameter estimates. This process is visualized in Fig. 5. The inputs to the algorithm are an initial estimated time for the chirp \u2206tk, the set of detections Dsearch, and a prior measurement variance for detection frequencies \u03c32freq. The output is a chirp slope estimate \u03b2\u0302k, a linear regression frequency offset f\u0302k, a vector of detection times tmatch,k associated with the chirp, and a vector of frequencies fmatch,k associated with the chirp. This algorithm is run for each chirp k \u2208 K\u0302. Let nstart,k = argminn (tmatch,k)n, the index of the first occuring matched detection. Then the kth chirp\u2019s start frequency is estimated as \u2206f\u0302k = (fmatch,k)n. The start time is estimated using the linear regression frequency offset as \u2206t\u0302k = (\u2206f\u0302k \u2212 f\u0302k)/\u03b2k. The spoofer now has an estimate of all signal parameters required to recreate the target signal accurately enough to begin tracking.\nAlgorithm 1 Iterative Chirp Parameter Estimation Input: \u2206tk, Dsearch, \u03c32freq Output: \u03b2\u0302k, f\u0302k, tmatch,k, fmatch,k\n1: \u03b2\u0302k \u2190 0, f\u0302k \u2190 0, K \u2190 diag{[\u221e,\u221e]} 2: D\u2032 \u2190 Dsearch sorted by distance from \u2206tk 3: (t1, f1)\u2190 1st entry in D\u2032, D\u2032 \u2190 D\u2032 \\ (t1, f1) 4: tmatch \u2190 [t1], fmatch \u2190 [f1] 5: for {t, f} \u2208 D\u2032 do 6: f\u0302k \u2190 \u03b2\u0302kt+ f 7: x\u2190 [t 1] 8: \u03c3\u03022freq \u2190 xKxH + \u03c32freq 9: if |f\u2212f\u0302k|\n\u03c3\u0302freq < 2 then\n10: tmatch,k \u2190 [t\u22a4match,k t]\u22a4, fmatch,k \u2190 [f\u22a4match,k f ]\u22a4 11: X \u2190 [tmatch,k 1] 12: [\u03b2\u0302k f\u0302k]\n\u22a4 \u2190 (XHX)\u22121XHfmatch,k 13: K \u2190 \u03c32freq(XHX)\u22121 14: else 15: exit 16: end if 17: end for"
        },
        {
            "heading": "B. Tracking",
            "text": "After identifying the target radar\u2019s signal as described, the spoofer can track the signal using more traditional FMCW\nsignal processing, similar to the processing described in [3]. During this tracking phase, the individual chirp parameters are refined to produce a mixed signal mikr\nlk\u0303 (t) similar to what\nwould arise when tracking a genuine reflection. Rather than using continuous frequency tones, as in the identification stage, the spoofer uses its estimated target signal in its mixer.\nRecall that the spoofer collects a vector of samples during its frame denoted as yi[n]. Rather than sampling continously over the entire frame, the spoofer now only samples during each chirp. The vector of sample indices corresponding to chirp k can be denoted as nk, containing Nsample samples, assuming the same number of samples are collected during each chirp. These samples can be structured into a 3-dimensional tensor (Y\n(k) i )an = (yi[(nk)n])a, where the 1st dimension is the receive antenna index a, the 2nd dimension is the sample index n, and the 3rd dimension (denoted with the superscript) is the chirp index k. In the radar literature, this tensor is commonly referred to as the \u201cradar data cube.\u201d\nThe spoofer beamforms across receive antennas with an FFT across the 1st dimension of the radar data cube, creating Y\u0303 (k)i . The spoofer also performs range and Doppler processing with an FFT, as in [3], over the 2nd and 3rd dimensions of this tensor, creating Y\u0306 (d)i , where d is the post-FFT Doppler bin index. Note that this FFT processing assumes homogenous chirp slopes. For non-homogeneous chirps, the FFTs must be transformed to align in range, the details of which are omitted in this paper. Next, the spoofer determines the beamforming, range, and Doppler bin indices (b, n, and d) that maximize the power of this processed tensor:\nb\u0302max, n\u0302max, d\u0302max = argmax b,n,d \u2223\u2223\u2223(Y\u0306 (d)i ) bn \u2223\u2223\u22232 . (13) These indices are then converted into an angle \u03b8\u0302 in radians, a time delay \u2206t\u0302 in seconds, and a Doppler frequency f\u0302D in Hz. The spoofer implements a simple 1st-order tracker to place the peak at a desired time delay and Doppler frequency.\nDue to inaccurate chirp timing and chirp slope estimates, the processed signal may appear spread out in range and Doppler, reducing or eliminating any clear peak. To address this, the spoofer first refines its individual chirp estimates using the beamformed signal prior to range and Doppler processing Y\u0303 (k)i . The spoofer takes the b\u0302maxth row of Y\u0303 (k) i , denoted (z(k)i ) \u22a4, to beamform in the target\u2019s direction. Then, it performs only range processing through an FFT of this vector, creating z\u0306(k)i . This differs from Y\u0306 (d) i since only the power-maximizing beam is used and Doppler processing is not performed, creating a separate range signal for each chirp. The range index n with the peak power is found as\nn\u0302max,k = argmax n \u2223\u2223\u2223(z\u0306(k)i ) n \u2223\u2223\u22232 . (14) The complex values at these peak-power range indices are pk = (z\u0306 (k) i )n\u0302max,k . Then, the range indices n\u0302max,k are converted into time delay estimates \u03b4t\u0302k. Let \u03b4t\u0304 be the average of \u03b4t\u0302k over k. The spoofer shifts the start time of the kth chirp by \u03b4t\u0302k\u2212\u03b4t\u0304 seconds to align all chirps at the same range.\nAdditionally, the spoofer can refine its estimate of each chirp\u2019s slope. By (7), slope error causes the mixed signal to have a residual linear frequency slope. This is addressed by searching for the chirp slope rate that, when mixed with the samples prior to range processing, maximizes the power in the peak of the range FFT. For a residual slope \u03b2\u0302, the slope-correction signal is m\u03b2\u0302 [n] = exp(j\u03c0\u03b2\u0302(Tsn)\n2), \u2200n \u2208 {1, . . . , Nsample}, denoted in vector notation as m\u03b2\u0302 . This is mixed with the beamformed sample signal creating z(k)\ni\u03b2\u0302 =\nz (k) i \u2299 m\u03b2\u0302 (with \u2299 being a Hadamard product). Then, the spoofer performs its range FFT, creating z\u0306(k) i\u03b2\u0302\n. The residual slope is estimated as\n\u03b4\u03b2\u0302k = argmax \u03b2 max n \u2223\u2223\u2223(z\u0306(k)i\u03b2 ) n \u2223\u2223\u22232 . (15) The spoofer then adjusts the slope for the kth chirp by \u2212\u03b4\u03b2\u0302k. The last chirp-level parameters to be estimated and compensated for are the chirp phase shifts \u03d5k, \u2200k \u2208 K\u0302, which arise from both transmit phase weightings and the physical placement of transmit antennas. Recall the values pk obtained earlier, containing the complex values at the power-maximizing range bin for each chirp, which can be stacked into a vector p. Fig. 6a shows an example of the phases of p where residual Doppler is present, despite the Doppler tracking. Therefore, a Viterbi and Viterbi (V&V) Algorithm [23] is used to wipe off any phase modulation for refined Doppler estimation. Assuming a modulation order of Mmod which is a power of 2, the modified values are pV,k = p log2(Mmod) k . The spoofer then finds the index corresponding to the peak of the FFT of pV,k. This index is converted into a frequency estimate f\u0302V and a phase estimate \u03d5\u0302V. Let Tc be the average chirp interval. A correction signal is created m\u0302V[n] = exp(j2\u03c0f\u0302VTck+ j\u03d5\u0302V), \u2200k \u2208 K\u0302, denoted in vector notation as m\u0302V. This signal is multiplied with p, giving pcorr = p \u2299 m\u0302V. In this new signal, phase shifts due to any residual Doppler are approximately removed, and the relative phase shift of each chirp can be estimated. The spoofer decodes the phase modulation of each chirp through detection regions defined by the modulation order Mmod, creating an estimate \u03d5\u0302k. This FFT-based approach relies on the chirp\nspacing being approximately uniform, but could be extended to use a non-uniform DFT when chirp spacing is non-uniform. Fig. 6b shows the phases of pcorr derived from the same p shown in Fig. 6a with QPSK detection regions overlaid."
        },
        {
            "heading": "IV. RESULTS",
            "text": "The results shown are from MATLAB simulation. The simulated scenario has one target radar, one spoofing radar, and one point reflector colocated with the target radar. The target radar transmits a frame with a standard time-multiplexed MIMO configuration across 3 transmit and 4 receive antennas. The IF bandwidth is 10MHz and the target\u2019s chirps sweep a bandwidth of 500MHz in 32 \u00b5s. A random binary phase code is applied to each chirp\u2019s weighting which repeats each frame. The spoofer radar is equipped with the same antenna elements and RF chains, but has 8 receive antennas. The radars are placed 50m apart and have a relative velocity of 14.14m/s.\nFig. 7a and Fig. 7b show the range-Doppler map that the spoofer perceives during the tracking stage. In Fig. 7a, the spoofer has just finished its identification stage. Due to coarse estimates of the chirp timings and slopes, the power is spread out in range and Doppler. Furthermore, the spoofer\u2019s tracker aims to place this signal at a perceived range of 100m and Doppler of 0Hz. In Fig. 7b, the tracker has shifted the signal to its desired range and refined its individual chirp timing and slope estimates, concentrating the power in range. The tracker has also corrected for its chirp phase estimates, concentrating the power in Doppler. The performance of the tracker can be quantified with three metrics: power concentration in range, power concentration in Doppler, and RMSE of the chirp slope estimates. Fig. 8a shows the concentration in range, measured by the width around the peak that contains 50% of the signal\u2019s power. As the chirp timing and slope are refined, this width\nreduces to near 0.54m. Fig. 8b shows the same analysis for Doppler. No improvement in Doppler spread is seen until frame 12 when the phase estimates are applied, decreasing the spread to near 63Hz. After frame 12, some fluctuation is seen due to TX-dependent phase shifts from the array manifold as the target radar moves."
        },
        {
            "heading": "V. CONCLUSION",
            "text": "These results demonstrate how an intelligent adversary may succesfully identify and track a mmWave FMCW radar using a COTS FMCW radar itself. This adversary does not require any prior knowledge of the target\u2019s signal\u2019s timing and chirp parameters, making such an attack effective in the real-world where the target\u2019s signal is unknown. After the described entrainment, the spoofer may transmit its signal, inducing the target to perceive very precisely controlled spoofed objects. In future analysis, it will be crucial to consider such an adversary when evaluating spoofing countermeasures."
        },
        {
            "heading": "ACKNOWLEDGMENT",
            "text": "Research was sponsored by the U.S. Department of Transportation (USDOT) under the University Transportation Center (UTC) Program Grant 69A3552047138 (CARMEN), and by affiliates of the 6G@UT center within the Wireless Networking and Communications Group at The University of Texas at Austin."
        }
    ],
    "title": "Signal Identification and Entrainment for Practical FMCW Radar Spoofing Attacks",
    "year": 2023
}