{
    "abstractText": "We describe a simple quantum algorithm for preparing K copies of an N-dimensional quantum state whose amplitudes are given by a quantum oracle. Our result extends a previous work of Grover, who showed how to prepare one copy in time O( \u221a N). In comparison with the naive O(K \u221a N) solution obtained by repeating this procedure K times, our algorithm achieves the optimal running time of \u0398( \u221a KN). Our technique uses a refinement of the quantum rejection sampling method employed by Grover. As a direct application, we obtain a similar speed-up for obtaining K independent samples from a distribution whose probability vector is given by a quantum oracle.",
    "authors": [
        {
            "affiliations": [],
            "name": "Yassine Hamoudi"
        }
    ],
    "id": "SP:893e545e70bf34fd3a6c96c58b234e23d8b8ca06",
    "references": [
        {
            "authors": [
                "A.W. Harrow",
                "A. Hassidim",
                "S. Lloyd"
            ],
            "title": "Quantum algorithm for linear systems of equations",
            "venue": "Physical Review Letters 103,",
            "year": 2009
        },
        {
            "authors": [
                "D.W. Berry"
            ],
            "title": "High-order quantum algorithm for solving linear differential equations",
            "venue": "Journal of Physics A: Mathematical and Theoretical",
            "year": 2014
        },
        {
            "authors": [
                "S. Aaronson"
            ],
            "title": "Read the fine print",
            "venue": "Nature Physics 11,",
            "year": 2015
        },
        {
            "authors": [
                "M. M\u00f6tt\u00f6nen",
                "J.J. Vartiainen",
                "V. Bergholm",
                "M.M. Salomaa"
            ],
            "title": "Transformation of quantum states using uniformly controlled rotations",
            "venue": "Quantum Information & Computation",
            "year": 2005
        },
        {
            "authors": [
                "M. Plesch"
            ],
            "title": "Brukner, Quantum-state preparation with universal gate decompositions",
            "venue": "Physical Review A",
            "year": 2011
        },
        {
            "authors": [
                "L.K. Grover"
            ],
            "title": "Synthesis of quantum superpositions by quantum computation",
            "venue": "Physical Review Letters 85,",
            "year": 2000
        },
        {
            "authors": [
                "M. Ozols",
                "M. Roetteler",
                "J. Roland"
            ],
            "title": "Quantum rejection sampling",
            "venue": "ACM Transactions on Computation Theory 5,",
            "year": 2013
        },
        {
            "authors": [
                "Y.R. Sanders",
                "G.H. Low",
                "A. Scherer",
                "D.W. Berry"
            ],
            "title": "Black-box quantum state preparation without arithmetic",
            "venue": "Physical Review Letters 122,",
            "year": 2019
        },
        {
            "authors": [
                "C.N. Wiebe"
            ],
            "title": "Grandade, Can small quantum systems learn",
            "venue": "Quantum Information & Computation 17,",
            "year": 2017
        },
        {
            "authors": [
                "C. Zalka"
            ],
            "title": "Simulating quantum systems on a quantum computer, Proceedings of the Royal Society A: Mathematical",
            "venue": "Physical and Engineering Sciences 454,",
            "year": 1998
        },
        {
            "authors": [
                "L.K. Grover",
                "T. Rudolph"
            ],
            "title": "Creating superpositions that correspond to efficiently integrable probability distributions",
            "year": 2002
        },
        {
            "authors": [
                "P. Kaye",
                "M. Mosca"
            ],
            "title": "Quantum networks for generating arbitrary quantum states",
            "venue": "Proceedings of the International Conference on Quantum Information (ICQI)",
            "year": 2001
        },
        {
            "authors": [
                "A.N. Soklakov",
                "R. Schack"
            ],
            "title": "Efficient state preparation for a register of quantum bits",
            "venue": "Physical Review A",
            "year": 2006
        },
        {
            "authors": [
                "A. Kitaev",
                "W.A. Webb"
            ],
            "title": "Wavefunction preparation and resampling using a quantum computer",
            "year": 2009
        },
        {
            "authors": [
                "D. Aharonov",
                "A. Ta-Shma"
            ],
            "title": "Adiabatic quantum state generation",
            "venue": "SIAM Journal on Computing 37,",
            "year": 2007
        },
        {
            "authors": [
                "R.D. Somma",
                "S. Boixo",
                "H. Barnum",
                "E. Knill"
            ],
            "title": "Quantum simulations of classical annealing processes",
            "venue": "Physical Review Letters 101,",
            "year": 2008
        },
        {
            "authors": [
                "A.P. Wocjan"
            ],
            "title": "Abeyesinghe, Speedup via quantum sampling",
            "venue": "Physical Review A 78,",
            "year": 2008
        },
        {
            "authors": [
                "S. Apers"
            ],
            "title": "Quantum walk sampling by growing seed sets",
            "venue": "Proceedings of the 27th European Symposium on Algorithms (ESA)",
            "year": 2019
        },
        {
            "authors": [
                "A.W. Harrow",
                "A.Y. Wei"
            ],
            "title": "Adaptive quantum simulated annealing for bayesian inference and estimating partition functions, in Proceedings of the 31st Symposium on Discrete Algorithms",
            "year": 2020
        },
        {
            "authors": [
                "L. Devroye"
            ],
            "title": "Non-Uniform Random Variate",
            "venue": "Generation (Springer-Verlag,",
            "year": 1986
        },
        {
            "authors": [
                "P. Bratley",
                "B.L. Fox",
                "L.E. Schrage"
            ],
            "title": "A Guide to Simulation, 2nd ed",
            "year": 1987
        },
        {
            "authors": [
                "D.E. Knuth"
            ],
            "title": "The Art of Computer Programming, Volume II: Seminumerical Algorithms, 3rd ed",
            "venue": "(Addison- Wesley,",
            "year": 1998
        },
        {
            "authors": [
                "A.J. Walker"
            ],
            "title": "New fast method for generating discrete random numbers with arbitrary frequency distributions, Electronics",
            "venue": "Letters 10,",
            "year": 1974
        },
        {
            "authors": [
                "A.J. Walker"
            ],
            "title": "An efficient method for generating discrete random variables with general distributions",
            "venue": "ACM Transactions on Mathematical Software 3,",
            "year": 1977
        },
        {
            "authors": [
                "R.A. Kronmal",
                "A.V. Peterson"
            ],
            "title": "On the alias method for generating random variables from a discrete distribution",
            "venue": "The American Statistician 33,",
            "year": 1979
        },
        {
            "authors": [
                "M.D. Vose"
            ],
            "title": "A linear algorithm for generating random numbers with a given distribution",
            "venue": "IEEE Transactions on Software Engineering",
            "year": 1991
        },
        {
            "authors": [
                "L.K. Grover"
            ],
            "title": "Rapid sampling through quantum computing",
            "venue": "Proceedings of the 32nd Symposium on Theory of Computing (STOC)",
            "year": 2000
        },
        {
            "authors": [
                "Y. Hamoudi",
                "F. Magniez"
            ],
            "title": "Quantum time-space tradeoff for finding multiple collision pairs, in Proceedings of the 16th Conference on the Theory of Quantum Computation, Communication and Cryptography",
            "year": 2021
        },
        {
            "authors": [
                "T. H\u00e4ner",
                "M. Roetteler",
                "K.M. Svore"
            ],
            "title": "Optimizing quantum circuits for arithmetic (2018)",
            "year": 2018
        },
        {
            "authors": [
                "C. D\u00fcrr",
                "M. Heiligman",
                "P. H\u00f8yer",
                "M. Mhalla"
            ],
            "title": "Quantum query complexity of some graph problems",
            "venue": "SIAM Journal on Computing",
            "year": 2006
        },
        {
            "authors": [
                "G. Brassard",
                "P. H\u00f8yer",
                "M. Mosca",
                "A. Tapp"
            ],
            "title": "Quantum amplitude amplification and estimation",
            "venue": "Contemporary Mathematics 305,",
            "year": 2002
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n20 7.\n11 01\n4v 1\n[ qu\nan t-\nph ]\n2 2\nJu l 2\n02 2\nPreparing many copies of a quantum state in the black-box model\nYassine Hamoudi Simons Institute for the Theory of Computing, Berkeley, California 94720, USA\u2217\n(Dated: July 25, 2022)\nWe describe a simple quantum algorithm for preparing K copies of an N-dimensional quantum state whose amplitudes are given by a quantum oracle. Our result extends a previous work of Grover, who showed how to prepare one copy in time O( \u221a N). In comparison with the naive O(K \u221a N) solution obtained by repeating this procedure K times, our algorithm achieves the optimal running time of \u0398( \u221a KN). Our technique uses a refinement of the quantum rejection sampling method employed by Grover. As a direct application, we obtain a similar speed-up for obtaining K independent samples from a distribution whose probability vector is given by a quantum oracle.\nI. INTRODUCTION\nThe preparation of a specific quantum state is an important building block and a critical bottleneck in many quantum algorithms [1\u20134]. The objective of the State Preparation problem is to find the minimum amount of resources needed to generate a quantum state given some description of it. In general, the complexity of this problem scales linearly with the dimension of the state to be prepared [5, 6]. Yet, it is possible to achieve sublinear bounds for particular states or input models. One such example is the black-box model where, given oracle access to a non-zero non-negative vector w = (w1, . . . , wN ), the objective is to load the associated normalized probability vector into the amplitudes of the log(N)-qubit state |w\u3009 defined as\n|w\u3009 := 1\u221a W\nN \u2211\ni=1\n\u221a wi|i\u3009 (1)\nwhere W = \u2211N\ni=1 wi is the (unknown) normalization factor. Grover adapted his celebrated quantum search algorithm to this problem in [7], where he showed that O( \u221a N) queries to w are sufficient to prepare |w\u3009. In practice, one can expect that several copies of the same quantum state are needed for further use. For instance, |w\u3009 may be fed in an algorithm that fails with some probability and that must be repeated several times. The no-cloning theorem prevents the state |w\u3009 from being easily duplicated. In fact, it is easy to show that additional queries to the input are required to prepare several copies of |w\u3009. The problem of adapting the state preparation procedure to the desired number K of copies has received little attention. Usually, it is possible to simply repeat K times the procedure used to prepare one copy, but the complexity grows linearly with K. For instance, the algorithm of Grover leads to a query complexity of O(K \u221a N) for preparing the K-fold state |w\u3009\u2297K . In this paper, we investigate the question of whether a more efficient approach exists. We describe a two-phase\n\u2217 hamoudi@berkeley.edu\nalgorithm consisting of a preprocessing step that uses O( \u221a KN) queries, after which each copy of |w\u3009 requires only O( \u221a N/K) queries to be prepared. Our result improves upon the previous approach by a factor of \u221a K, and it is shown to be optimal."
        },
        {
            "heading": "A. Related work",
            "text": "Our work is based on the quantum rejection sampling method, where a state that is easy to prepare (e.g. a uniform superposition) is mapped to a target state by amplitude amplification. This method was pioneered by Grover in [7] and subsequently studied in [8\u201311]. All of these works (except for [10]) take place in the quantum oracle model and they often require a number of queries that is polynomial in the dimensionN of the state. In the non-oracular setting, the problem of loading an arbitrary vector (w1, . . . , wN ) into the amplitudes of a quantum state can be done with a circuit of depth O(N) and width O(logN) [5, 6]. It is possible to use only polylog(N) resources for specific cases such as efficiently integrable probability distributions [12\u201314] (Proposition 4), uniformly bounded amplitudes [15], Gaussian states [16] or probability distributions resulting from a Bayesian network [10]. A different line of work [17\u201322] studied the preparation of a quantum state that corresponds to the stationary distribution of a Markov chain. These algorithms use Markov chain Monte Carlo methods and quantum walk techniques to obtain a preparation time scaling with the spectral gap. Aharonov and Ta-Shma [17] also showed that the existence of an efficient procedure to convert any circuit into a coherent state encoding the output distribution of that circuit would imply that SZK \u2286 BQP. The State Preparation problem is also related to the task of preparing samples from a discrete distribution. We refer the reader to [23\u201325] for a general introduction on the latter topic. In particular, the Importance Sampling problem (also called Weighted Sampling or L1 Sampling) asks to generateK independent samples from the probability vector (\nw1 W , . . . , wN W\n)\nassociated with a non-negative weight vector w. The alias method [26\u201329] solves this problem with a preprocessing cost of O(N) operations, and a generating cost\n2 of O(1) operations per sample. Grover [7, 30] suggested a quadratically faster algorithm for obtaining one sample, based on preparing the state |w\u3009 and measuring it in the computational basis. Our state preparation algorithm extends the work of Grover to the case of generating K independent samples with a total cost of O( \u221a KN) operations. An alternative quantum algorithm for (approximately) generating K such samples was proposed before in [31], where it was combined with the stochastic gradient descent method to address the submodular function minimization problem."
        },
        {
            "heading": "B. Overview",
            "text": "The two parts of our state preparation algorithm are described in Theorems 2 and 3. Combined together, these results lead to the following main theorem.\nTheorem 1. There is a quantum algorithm with the following properties. Consider two integers 1 \u2264 K \u2264 N , a real \u03b4 \u2208 (0, 1) and a non-zero vector w \u2208 RN\u22650. Then, with probability at least 1\u2212 \u03b4, the algorithm outputs K copies of the state |w\u3009 and it uses O( \u221a KN log(1/\u03b4)) queries to w in expectation.\nWe now provide a high-level description of how the algorithm works. Our starting point is the result from Grover [7] for preparing one copy of the state |w\u3009 in the black-box model. Given an upper bound h on the largest value maxiwi, this algorithm uses two queries and one controlled rotation to implement a unitary U such that,\nU |~0\u3009 = 1\u221a N\nN \u2211\ni=1\n|i\u3009 ( \u221a\nwi h |0\u3009+\n\u221a\n1\u2212 wi h |1\u3009\n)\n. (2)\nThe state |w\u3009|0\u3009 has amplitude \u221a\nW Nh in U |~0\u3009, thus it\ncan be extracted by using the amplitude amplification algorithm with O ( \u221a\nNh W\n)\napplications of U and U\u22121.\nIn particular, if the largest coordinate of w is smaller than h = W/K then we can prepare one copy of |w\u3009 in time O( \u221a N/K), and K copies in time O( \u221a KN). We use this observation to construct a new circuit C (Figure 2) such that |w\u3009|0\u3009 has amplitude at least \u221a K/N in C|~0\u3009, even if w contains large coordinates. This circuit uses only two queries to w, but it requires O( \u221a KN) queries to be constructed during a preprocessing phase that is executed only once (Theorem 2). The preprocessing phase consists first of computing the set H that contains the positions of the K largest coordinates in w, by using a variant of the quantum maximum finding algorithm (Proposition 2). The circuit C is then defined to proceed in two stages. First, it prepares a state whose amplitudes depend only on the values in {wi : i \u2208 H} (Equation (4)). Next, it modifies this state by querying the set {wi : i /\u2208 H} in a way that is similar to that of U . The crucial observation is that the values in {wi : i /\u2208 H}\nmust be smaller than W/K by definition of H , thus they can be amplified at a smaller cost. Finally, each copy of |w\u3009 can be obtained by one application of the amplitude amplification algorithm on C (Theorem 3). We show in the next proposition that our algorithm is optimal by a simple reduction from the K-Search problem.\nProposition 1. Any bounded-error quantum algorithm that can output K copies of the quantum state |w\u3009 given oracle access to any non-zero vector w \u2208 RN\u22650 must perform at least \u2126 (\u221a KN ) quantum queries to w.\nProof. We consider a variant of the K-Search problem where the objective is to find K preimages of 1 in an oracle O : [N ] \u2192 {0, 1} containing at least 2K such preimages. The bounded-error quantum query complexity of this problem is \u0398( \u221a KN) (the proof can easily be derived from [32, Appendix A] for instance). On the other hand, by a coupon collector argument [33], if we prepare and measure in the computational basis \u0398(K) copies of |w\u3009 where w = (O(1), . . . ,O(N)) \u2208 {0, 1}N , then we obtain the positions of at least K different preimages of 1 with constant success probability. It implies that generating \u2126(K) such copies requires using at least \u2126( \u221a KN) quantum queries to w."
        },
        {
            "heading": "II. PRELIMINARIES",
            "text": ""
        },
        {
            "heading": "A. Computational model",
            "text": "We use the quantum circuit model over a universal gate set made of the CNOT gate and of all one-qubit gates. We suppose that the real numbers manipulated by our algorithms (such as the coordinates of w) can be encoded over c bits, for a fixed value of c. In particular, these numbers can be stored in quantum registers of size c. We also add the three gates described in Figure 1. The indicator gate 1H is specified by a subset H \u2286 [N ]. It operates on a Boolean value b and an index i \u2208 [N ]. The Boolean value [i /\u2208 H ] is equal to 1 if and only if i /\u2208 H . The query gate Ow is specified by the input vector w to the problem. It operates on an index i \u2208 [N ] and a real v (encoded over c bits). Finally, the controlled rotation gate Roth is specified by a real h > 0 and it operates on a Boolean value b and a real v. We refer the reader to [9, 34] and references therein for efficient implementations of the arithmetic gates and controlled rotation gates with a given precision. We will also use |~0\u3009 in our notations to represent a multi-qubit basis state |0\u3009\u2297\u2113 for some \u2113 > 1. The query complexity of an algorithm is the number of times it uses the oracle gate Ow to access the input w. If not specified, the total number of elementary gates used by our algorithms will be larger than their respective query complexity by at most a polylog(N) factor.\n3 Query gate\n|v\u3009 Ow\n|v \u2295 wi\u3009\n|i\u3009 |i\u3009\nIndicator gate Controlled rotation gate\n|i\u3009 1H\n|i\u3009\n|b\u3009 |b\u2295 [i /\u2208 H ]\u3009\n|b\u3009 Roth\n|\u03c7\u3009\n|v\u3009 |v\u3009\nFIG. 1. Three gates used in our circuits. The state |\u03c7\u3009 is defined as \u221a v h |b\u3009 + \u221a 1\u2212 v h |1 \u2212 b\u3009 if 0 < v \u2264 h, and |b\u3009 otherwise."
        },
        {
            "heading": "B. Quantum subroutines",
            "text": "The next algorithm generalizes the quantum minimum finding of Du\u0308rr and H\u00f8yer [35] to findingK largest entries in a vector w. The algorithm succeeds if it outputs a set H \u2282 [N ] of K coordinates that dominate all other entries. There is not necessarily a unique choice for H since different coordinates of w may be equal.\nProposition 2 (Top-K maximum finding \u2013 Theorem 4.2 in [36]). There exists a quantum algorithm with the following properties. Consider two integers 1 \u2264 K \u2264 N , a real \u03b4 \u2208 (0, 1) and a vector w \u2208 RN\u22650. Then, the algorithm outputs the positions of K largest entries in w with success probability at least 1 \u2212 \u03b4, and it performs O( \u221a KN log(1/\u03b4)) queries to w.\nWe also need the well-known amplitude amplification algorithm.\nProposition 3 (Amplitude Amplification \u2013 Theorem 3 in [37]). Let C be a quantum circuit that prepares the state C|~0\u3009 = \u221ap|\u03d5\u3009|0\u3009+\u221a1\u2212 p|\u03d5\u22a5\u3009|1\u3009 for some p \u2208 [0, 1] and two unit states |\u03d5\u3009, |\u03d5\u22a5\u3009. Then, the amplitude amplification algorithm outputs the state |\u03d5\u3009 by using O(1/ \u221a p) applications of C and C\u2020 in expectation.\nFinally we will use the next quantum state preparation algorithm that requires having an efficient procedure to compute the partial sum \u2211j\n\u2113=iw\u2113 for any 1 \u2264 i \u2264 j \u2264 N .\nProposition 4 (State preparation by integration \u2013 [12\u201314]). There is a quantum algorithm with the following properties. Consider an integer N and a non-zero vector w \u2208 RN\u22650 such that there is a (classical) reversible circuit with T gates that computes\n\u2211j \u2113=iw\u2113 given i \u2264 j.\nThen, the algorithm outputs |w\u3009 and it uses O(T logN) elementary gates."
        },
        {
            "heading": "III. MAIN ALGORITHM",
            "text": "We describe in details our state preparation algorithm for preparing K copies of |w\u3009 given oracle access to w = (w1, . . . , wN ). The first step of the algorithm is a preprocessing phase (Algorithm 1) that constructs a particular circuit C described in Figure 2.\nAlgorithm 1 Preprocessing phase.\n1: Compute a set H \u2286 [N ] of the positions of K largest entries in w by using the top-K maximum finding algorithm (Proposition 2) with failure probability \u03b4. 2: Compute h = mini\u2208H wi and\nZ = (N \u2212K)h+ \u2211\ni\u2208H\nwi. (3)\n3: Use the state preparation algorithm of Proposition 4 to construct a circuit D such that, on input |~0\u3009out, it prepares the state\nD|~0\u3009out = \u2211\ni\u2208H\n\u221a\nwi Z |i\u3009out + \u2211\ni/\u2208H\n\u221a\nh Z |i\u3009out. (4)\n4: Output the circuit C represented in Figure 2.\nTheorem 2 (Preprocessing phase). Consider two integers 1 \u2264 K \u2264 N , a real \u03b4 \u2208 (0, 1) and a non-zero vector w \u2208 RN\u22650. Then, Algorithm 1 outputs with probability at least 1\u2212 \u03b4 the description of a quantum circuit C such that, on input |~0\u3009, it prepares the state\n|\u03c8\u3009 = \u221apw|w\u3009|0\u3009 + \u221a 1\u2212 pw|w\u22a5\u3009|1\u3009 (5)\nwhere pw \u2265 K/N and |w\u22a5\u3009 is some unit state. The algorithm performs O( \u221a KN log(1/\u03b4)) queries to w. The circuit C performs two queries to w and it uses O(K logN) elementary gates.\nProof. We assume that the top-K maximum finding algorithm returns a correct set H at step 1 of Algorithm 1, which is the case with probability at least 1 \u2212 \u03b4. The circuit C represented in Figure 2 operates on four registers: rot and ind that contain a Boolean value, qry that contains a real v \u2265 0, and out that contains an integer i \u2208 [N ]. The indicator gate 1H flips the content\n4 of ind when the out register contains i /\u2208 H , which allows the rotation gate Roth to be activated only when i /\u2208 H . The gates Ow and 1H are applied a second time at the end of C to uncompute the registers qry and ind. A simple calculation shows that the final state is C|~0\u3009 = |~0\u3009qry|0\u3009ind|\u03c8\u3009out,rot where\n|\u03c8\u3009out,rot = \u2211\ni\u2208H\n\u221a\nwi Z |i\u3009out|0\u3009rot\n+ \u2211\ni/\u2208H\n\u221a\nh Z |i\u3009out ( \u221a wi h |0\u3009rot + \u221a 1\u2212 wi h |1\u3009rot )\n=\n\u221a\nW Z |w\u3009out|0\u3009rot +\n\u221a\n1\u2212 WZ |w \u22a5\u3009out|1\u3009rot\n(6) for some irrelevant unit state |w\u22a5\u3009out. In order to lower bound the coefficient pw := W Z , we first observe that the smallest value h = mini\u2208H wi over H must satisfy h \u2264 WK since otherwise \u2211\ni\u2208H wi would exceed W . Thus, p\u22121w = Z W = (N\u2212K)h+ \u2211 i\u2208H wi\nW \u2264 N\u2212KK + 1 = NK . The algorithm uses O( \u221a KN log(1/\u03b4)) queries at step 1 by Proposition 2. The set {wi : i \u2208 H} can be computed with K queries, after which steps 2\u20134 do not need to perform any new query. For any i \u2264 j, the partial amplitude sum\n\u2211j \u2113=i\u3008\u2113|D|~0\u30092 is equal to 1Z ( \u2211 \u2113\u2208H\u2229{i,...,j} wi+\nh \u00b7 |{i, . . . , j} \\H | )\n, which can be computed by a classical circuit with O(K) gates since H is of size K. Thus, by Proposition 4, the circuit D constructed at step 3 requires O(K logN) elementary gates. Finally, the number of gates needed to implement the circuit C at step 4 is\ndominated by the number of gates needed in D since the other gates are included in the computational model (see Section IIA).\nWe use the circuit C constructed during the above preprocessing phase, together with the amplitude amplification algorithm, to obtain the next state preparation phase that generates one copy of |w\u3009 in time O( \u221a N/K).\nTheorem 3 (State preparation phase). Consider two integers 1 \u2264 K \u2264 N , a real \u03b4 \u2208 (0, 1) and a non-zero vector w \u2208 RN\u22650. Let C denote a quantum circuit obtained with Algorithm 1 on input K, \u03b4, w that correctly prepares the state |\u03c8\u3009 described in Theorem 2. Then, given the description of C, one can prepare the state |w\u3009 by using O( \u221a N/K) queries to w in expectation.\nProof. This is a direct application of the amplitude amplification algorithm (Proposition 3) on C, where the complexity is derived from the fact that |w\u3009|0\u3009 has amplitude at least \u221a K/N in |\u03c8\u3009 by Theorem 2."
        },
        {
            "heading": "IV. DISCUSSION",
            "text": "We did not address the precision errors in our analysis. In particular, it can be relevant to replace the controlled rotation gate (which requires to calculate the arcsine function) by the comparison-based circuit defined in [9] that avoids arithmetic. We also restricted ourselves to preparing states with non-negative real amplitudes. Arbitrary phase factors can be introduced by using the techniques discussed in [9, 14].\n[1] F. Magniez, A. Nayak, J. Roland, and M. Santha, Search via quantum walk, SIAM Journal on Computing 40, 142 (2011). [2] A. W. Harrow, A. Hassidim, and S. Lloyd, Quantum algorithm for linear systems of equations, Physical Review Letters 103, 150502 (2009). [3] D. W. Berry, High-order quantum algorithm for solving linear differential equations, Journal of Physics A: Mathematical and Theoretical 47, 105301 (2014). [4] S. Aaronson, Read the fine print, Nature Physics 11, 291 (2015). [5] M. Mo\u0308tto\u0308nen, J. J. Vartiainen, V. Bergholm, and M. M. Salomaa, Transformation of quantum states using uniformly controlled rotations, Quantum Information & Computation 5, 467 (2005). [6] M. Plesch and v. Brukner, Quantum-state preparation with universal gate decompositions, Physical Review A 83, 032302 (2011). [7] L. K. Grover, Synthesis of quantum superpositions by quantum computation, Physical Review Letters 85, 1334 (2000). [8] M. Ozols, M. Roetteler, and J. Roland, Quantum rejection sampling, ACM Transactions on Computation Theory 5, 11:1 (2013).\n[9] Y. R. Sanders, G. H. Low, A. Scherer, and D. W. Berry, Black-box quantum state preparation without arithmetic, Physical Review Letters 122, 020502 (2019). [10] G. H. Low, T. J. Yoder, and I. L. Chuang, Quantum inference on Bayesian networks, Physical Review A 89, 062315 (2014). [11] N. Wiebe and C. Grandade, Can small quantum systems learn, Quantum Information & Computation 17, 568 (2017). [12] C. Zalka, Simulating quantum systems on a quantum computer, Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences 454, 313 (1998). [13] L. K. Grover and T. Rudolph, Creating superpositions that correspond to efficiently integrable probability distributions (2002), arXiv:quant-ph/0208112. [14] P. Kaye and M. Mosca, Quantum networks for generating arbitrary quantum states, in Proceedings of the International Conference on Quantum Information (ICQI) (2001) p. PB28. [15] A. N. Soklakov and R. Schack, Efficient state preparation for a register of quantum bits, Physical Review A 73, 012307 (2006).\n5 [16] A. Kitaev and W. A. Webb, Wavefunction preparation and resampling using a quantum computer (2009), arXiv:0801.0342 [quant-ph]. [17] D. Aharonov and A. Ta-Shma, Adiabatic quantum state generation, SIAM Journal on Computing 37, 47 (2007). [18] R. D. Somma, S. Boixo, H. Barnum, and E. Knill, Quantum simulations of classical annealing processes, Physical Review Letters 101, 130504 (2008). [19] P. Wocjan and A. Abeyesinghe, Speedup via quantum sampling, Physical Review A 78, 042336 (2008). [20] D. Orsucci, H. J. Briegel, and V. Dunjko, Faster quantum mixing for slowly evolving sequences of Markov chains, Quantum 2, 105 (2018). [21] S. Apers, Quantum walk sampling by growing seed sets, in Proceedings of the 27th European Symposium on Algorithms (ESA) (2019) pp. 9:1\u20139:12. [22] A. W. Harrow and A. Y. Wei, Adaptive quantum simulated annealing for bayesian inference and estimating partition functions, in Proceedings of the 31st Symposium on Discrete Algorithms (SODA) (2020) pp. 193\u2013212. [23] L. Devroye, Non-Uniform Random Variate Generation (Springer-Verlag, 1986). [24] P. Bratley, B. L. Fox, and L. E. Schrage, A Guide to Simulation, 2nd ed. (Springer-Verlag, 1987). [25] D. E. Knuth, The Art of Computer Programming, Volume II: Seminumerical Algorithms, 3rd ed. (AddisonWesley, 1998). [26] A. J. Walker, New fast method for generating discrete random numbers with arbitrary frequency distributions, Electronics Letters 10, 127 (1974). [27] A. J. Walker, An efficient method for generating discrete random variables with general distributions, ACM Transactions on Mathematical Software 3, 253 (1977). [28] R. A. Kronmal and A. V. Peterson, On the alias method for generating random variables from a discrete distribution, The American Statistician 33, 214 (1979). [29] M. D. Vose, A linear algorithm for generating random numbers with a given distribution, IEEE Transactions on Software Engineering 17, 972 (1991). [30] L. K. Grover, Rapid sampling through quantum computing, in Proceedings of the 32nd Symposium on Theory of Computing (STOC) (2000) pp. 618\u2013626. [31] Y. Hamoudi, P. Rebentrost, A. Rosmanis, and M. Santha, Quantum and classical algorithms for approximate submodular function minimization, Quantum Information & Computation 19, 1325 (2019). [32] Y. Hamoudi and F. Magniez, Quantum time-space tradeoff for finding multiple collision pairs, in Proceedings of the 16th Conference on the Theory of Quantum Computation, Communication and Cryptography (TQC) (2021) pp. 1:1\u20131:21. [33] Coupon collector\u2019s problem to obtain at least half the coupons (2017), available at https://math.stackexchan ge.com/q/2117546/256631. [34] T. Ha\u0308ner, M. Roetteler, and K. M. Svore, Optimizing quantum circuits for arithmetic (2018), arXiv:1805.12445 [quant-ph]. [35] C. Du\u0308rr and P. H\u00f8yer, A quantum algorithm for finding the minimum (1996), arXiv:quant-ph/9607014. [36] C. Du\u0308rr, M. Heiligman, P. H\u00f8yer, and M. Mhalla, Quantum query complexity of some graph problems, SIAM Journal on Computing 35, 1310 (2006).\n[37] G. Brassard, P. H\u00f8yer, M. Mosca, and A. Tapp, Quantum amplitude amplification and estimation, Contemporary Mathematics 305, 53 (2002)."
        }
    ],
    "year": 2022
}