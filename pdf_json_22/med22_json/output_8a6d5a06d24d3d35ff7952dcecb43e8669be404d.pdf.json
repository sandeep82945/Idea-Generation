{
    "abstractText": "Melanoma is considered to be the most aggressive form of skin cancer. Due to the similar shape of malignant and benign cancerous lesions, doctors spend considerably more time when diagnosing these findings. At present, the evaluation of malignancy is performed primarily by invasive histological examination of the suspicious lesion. Developing an accurate classifier for early and efficient detection can minimize and monitor the harmful effects of skin cancer and increase patient survival rates. This paper proposes a multi-class classification task using the CoAtNet architecture, a hybrid model that combines the depthwise convolution matrix operation of traditional convolutional neural networks with the strengths of Transformer models and self-attention mechanics to achieve better generalization and capacity. The proposed multi-class classifier achieves an overall precision of 0.901, recall 0.895, and AP 0.923, indicating high performance compared to other state-of-the-art networks.",
    "authors": [
        {
            "affiliations": [],
            "name": "Daniel Kvak"
        }
    ],
    "id": "SP:19cbff07712351cc9e43c1a9606d48c1de9b90b7",
    "references": [
        {
            "authors": [
                "S. Albawi",
                "T.A. Mohammed",
                "S. Al-Zawi"
            ],
            "title": "Understanding of a convolutional neural network, in \u20182017 international conference on engineering and technology (ICET)",
            "year": 2017
        },
        {
            "authors": [
                "J. Amann",
                "A. Blasimme",
                "E. Vayena",
                "D. Frey",
                "V.I. Madai"
            ],
            "title": "Explainability for artificial intelligence in healthcare: a multidisciplinary perspective",
            "venue": "BMC Medical Informatics and Decision Making",
            "year": 2020
        },
        {
            "authors": [
                "S.M. Anwar",
                "M. Majid",
                "A. Qayyum",
                "M. Awais",
                "M. Alnowami",
                "M.K. Khan"
            ],
            "title": "Medical image analysis using convolutional neural networks: a review",
            "venue": "Journal of medical systems",
            "year": 2018
        },
        {
            "authors": [
                "Z. Apalla",
                "D. Nashan",
                "R.B. Weller",
                "X. Castellsagu\u00e9"
            ],
            "title": "Skin cancer: epidemiology, disease burden, pathophysiology, diagnosis, and therapeutic approaches",
            "venue": "Dermatology and therapy",
            "year": 2017
        },
        {
            "authors": [
                "B.C. Bastian"
            ],
            "title": "The molecular pathology of melanoma: an integrated taxonomy of melanocytic neoplasia",
            "venue": "Annual Review of Pathology: Mechanisms of Disease",
            "year": 2014
        },
        {
            "authors": [
                "K. Boyd",
                "K.H. Eng",
                "C.D. Page"
            ],
            "title": "Area under the precision-recall curve: point estimates and confidence intervals, in \u2018Joint European conference on machine learning and knowledge discovery in databases",
            "year": 2013
        },
        {
            "authors": [
                "M. Buckland",
                "F. Gey"
            ],
            "title": "The relationship between recall and precision",
            "venue": "Journal of the American society for information science",
            "year": 1994
        },
        {
            "authors": [
                "P. Carli",
                "D. Massi",
                "V. de Giorgi",
                "B. Giannotti"
            ],
            "title": "Clinically and dermoscopically featureless melanoma: when prevention fails",
            "venue": "Journal of the American Academy of Dermatology",
            "year": 2002
        },
        {
            "authors": [
                "J. Chang",
                "J. Sha"
            ],
            "title": "An efficient implementation of 2d convolution in cnn",
            "venue": "IEICE Electronics Express pp",
            "year": 2016
        },
        {
            "authors": [
                "Z. Dai",
                "H. Liu",
                "Q.V. Le",
                "M. Tan"
            ],
            "title": "Coatnet: Marrying convolution and attention for all data sizes",
            "venue": "Advances in Neural Information Processing Systems",
            "year": 2021
        },
        {
            "authors": [
                "M. Elgendi",
                "M.U. Nasir",
                "Q. Tang",
                "D. Smith",
                "Grenier",
                "J.-P",
                "C. Batte",
                "B. Spieler",
                "W.D. Leslie",
                "C. Menon",
                "Fletcher",
                "R. R"
            ],
            "title": "The effectiveness of image augmentation in deep learning networks for detecting covid-19: A geometric transformation perspective",
            "venue": "Frontiers in Medicine",
            "year": 2021
        },
        {
            "authors": [
                "J.R. England",
                "P.M. Cheng"
            ],
            "title": "Artificial intelligence for medical image analysis: a guide for authors and reviewers",
            "venue": "American journal of roentgenology",
            "year": 2019
        },
        {
            "authors": [
                "R. Garg",
                "S. Maheshwari",
                "A. Shukla"
            ],
            "title": "Decision support system for detection and classification of skin cancer using cnn, in \u2018Innovations in Computational Intelligence and Computer Vision",
            "year": 2021
        },
        {
            "authors": [
                "M. Ghassemi",
                "L. Oakden-Rayner",
                "A.L. Beam"
            ],
            "title": "The false hope of current approaches to explainable artificial intelligence in health care",
            "venue": "The Lancet Digital Health",
            "year": 2021
        },
        {
            "authors": [
                "Y. Guo",
                "Y. Li",
                "L. Wang",
                "T. Rosing"
            ],
            "title": "Depthwise convolution is all you need for learning multiple visual domains",
            "venue": "in \u2018Proceedings of the AAAI Conference on Artificial Intelligence\u2019,",
            "year": 2019
        },
        {
            "authors": [
                "P. Hamet",
                "J. Tremblay"
            ],
            "title": "Artificial intelligence in medicine",
            "venue": "Metabolism 69,",
            "year": 2017
        },
        {
            "authors": [
                "T. Hida",
                "T. Kamiya",
                "A. Kawakami",
                "J. Ogino",
                "H. Sohma",
                "H. Uhara",
                "K. Jimbow"
            ],
            "title": "Elucidation of melanogenesis cascade for identifying pathophysiology and therapeutic approach of pigmentary disorders and melanoma",
            "venue": "International Journal of Molecular Sciences",
            "year": 2020
        },
        {
            "authors": [
                "A. Holzinger",
                "G. Langs",
                "H. Denk",
                "K. Zatloukal",
                "H. M\u00fcller"
            ],
            "title": "Causability and explainability of artificial intelligence in medicine",
            "venue": "Wiley Interdisciplinary Reviews: Data Mining and Knowledge Discovery",
            "year": 2019
        },
        {
            "authors": [
                "N. Japkowicz",
                "S. Stephen"
            ],
            "title": "The class imbalance problem: A systematic study\u2019, Intelligent data analysis",
            "year": 2002
        },
        {
            "authors": [
                "J.D. Jensen",
                "B.E. Elewski"
            ],
            "title": "The abcdef rule: combining the \u201cabcde rule\u201d and the \u201cugly duckling sign\u201d in an effort to improve patient self-screening examinations\u2019, The Journal of clinical and aesthetic dermatology",
            "year": 2015
        },
        {
            "authors": [
                "S.H. Kassani",
                "P.H. Kassani"
            ],
            "title": "A comparative study of deep learning architectures on melanoma detection",
            "venue": "Tissue and Cell",
            "year": 2019
        },
        {
            "authors": [
                "D. Kvak",
                "M. Bendik",
                "A. Chromcova"
            ],
            "title": "Towards clinical practice: Design and implementation of convolutional neural network-based assistive diagnosis system for covid-19 case detection from chest x-ray images",
            "year": 2022
        },
        {
            "authors": [
                "Q. Li",
                "W. Cai",
                "X. Wang",
                "Y. Zhou",
                "D.D. Feng",
                "M. Chen"
            ],
            "title": "Medical image classification with convolutional neural network, in \u20182014 13th international conference on control automation robotics & vision (ICARCV)",
            "year": 2014
        },
        {
            "authors": [
                "W. Liu",
                "D. Hill",
                "A.F. Gibbs",
                "M. Tempany",
                "C. Howe",
                "R. Borland",
                "M. Morand",
                "J.W. Kelly"
            ],
            "title": "What features do patients notice that help to distinguish between benign pigmented lesions and melanomas?: the abcd (e) rule versus the seven-point checklist",
            "venue": "Melanoma research",
            "year": 2005
        },
        {
            "authors": [
                "N.H. Matthews",
                "Li",
                "W.-Q",
                "A.A. Qureshi",
                "M.A. Weinstock",
                "E. Cho"
            ],
            "title": "Epidemiology of melanoma",
            "venue": "Exon Publications pp",
            "year": 2017
        },
        {
            "authors": [
                "A. Miko\u0142ajczyk",
                "M. Grochowski"
            ],
            "title": "Data augmentation for improving deep learning in image classification problem, in \u20182018 international interdisciplinary PhD workshop (IIPhDW)",
            "year": 2018
        },
        {
            "authors": [
                "F. Nachbar",
                "W. Stolz",
                "T. Merkle",
                "A.B. Cognetta",
                "T. Vogt",
                "M. Landthaler",
                "P. Bilek",
                "O. Braun-Falco",
                "G. Plewig"
            ],
            "title": "The abcd rule of dermatoscopy: high prospective value in the diagnosis of doubtful melanocytic skin lesions",
            "venue": "Journal of the American Academy of Dermatology 30(4),",
            "year": 1994
        },
        {
            "authors": [
                "H. Panwar",
                "P. Gupta",
                "M.K. Siddiqui",
                "R. Morales-Menendez",
                "P. Bhardwaj",
                "V. Singh"
            ],
            "title": "A deep learning and grad-cam based color visualization approach for fast detection of covid-19 cases using chest x-ray and ct-scan images",
            "venue": "Chaos, Solitons & Fractals",
            "year": 2020
        },
        {
            "authors": [
                "C. Payer",
                "D. \u0160tern",
                "H. Bischof",
                "M. Urschler"
            ],
            "title": "Integrating spatial configuration into heatmap regression based cnns for landmark localization",
            "venue": "Medical image analysis",
            "year": 2019
        },
        {
            "authors": [
                "D.S. Rigel",
                "R.J. Friedman",
                "A.W. Kopf"
            ],
            "title": "The incidence of malignant melanoma in the united states: issues as we approach the 21st century",
            "venue": "Journal of the American Academy of Dermatology",
            "year": 1996
        },
        {
            "authors": [
                "W. Samek",
                "M\u00fcller",
                "K.-R"
            ],
            "title": "Towards explainable artificial intelligence, in \u2018Explainable AI: interpreting, explaining and visualizing deep learning",
            "year": 2019
        },
        {
            "authors": [
                "R.R. Selvaraju",
                "M. Cogswell",
                "A. Das",
                "R. Vedantam",
                "D. Parikh",
                "D. Batra"
            ],
            "title": "Grad-cam: Visual explanations from deep networks via gradientbased localization",
            "venue": "in \u2018Proceedings of the IEEE international conference on computer vision\u2019,",
            "year": 2017
        },
        {
            "authors": [
                "W. Shen",
                "M. Zhou",
                "F. Yang",
                "C. Yang",
                "J. Tian"
            ],
            "title": "Multi-scale convolutional neural networks for lung nodule classification, in \u2018International conference on information processing in medical imaging",
            "year": 2015
        },
        {
            "authors": [
                "C. Shorten",
                "T.M. Khoshgoftaar"
            ],
            "title": "A survey on image data augmentation for deep learning",
            "venue": "Journal of big data",
            "year": 2019
        },
        {
            "authors": [
                "M. Tan",
                "Q.V. Le"
            ],
            "title": "Mixconv: Mixed depthwise convolutional kernels",
            "year": 2019
        },
        {
            "authors": [
                "M. Thoma"
            ],
            "title": "Analysis and optimization of convolutional neural network architectures",
            "year": 2017
        },
        {
            "authors": [
                "F. Wang",
                "R. Kaushal",
                "D. Khullar"
            ],
            "title": "Should health care demand interpretable artificial intelligence or accept \u201cblack box\u201d medicine?",
            "year": 2020
        },
        {
            "authors": [
                "E. Yilmaz",
                "J.A. Aslam"
            ],
            "title": "Estimating average precision with incomplete and imperfect judgments",
            "venue": "in \u2018Proceedings of the 15th ACM international conference on Information and knowledge management\u2019,",
            "year": 2006
        },
        {
            "authors": [
                "L. Yu",
                "H. Chen",
                "Q. Dou",
                "J. Qin",
                "P.A. Heng"
            ],
            "title": "Integrating online and offline three-dimensional deep learning for automated polyp detection in colonoscopy videos",
            "venue": "IEEE journal of biomedical and health informatics",
            "year": 2016
        }
    ],
    "sections": [
        {
            "text": "Keywords: skin cancer; melanoma; computer-aided diagnostics; image classification; CoAtNet; convolutional neural networks; deep learning.\n\u2217Corresponding author: daniel.kvak@carebot.com\nar X\niv :2\n20 5.\n10 51\n5v 1\n[ ee\nss .I"
        },
        {
            "heading": "1 Introduction",
            "text": "Artificial intelligence (AI) is emerging to assist healthcare professionals with routine tasks such as removing noise, analysing images or reading medical reports. (Hamet & Tremblay 2017) In deep learning, currently the most widely adopted AI technique, computer algorithms learn using backpropagation to predict outcomes based on large data sets. (Albawi et al. 2017) The efficiency of these methods has improved dramatically in recent years and can now be found in areas ranging from computer-aided diagnostics (CADx) to online shopping to autonomous vehicles. However, deep learning tools also raise troubling questions because they solve problems in ways that humans cannot always observe. (Wang et al. 2020, Holzinger et al. 2019) There is a growing call among researchers and institutions to clarify the basis on which artificial intelligence makes decisions. (Kvak et al. 2022, Amann et al. 2020, Samek & M\u00fcller 2019)\nThe US Food and Drug Administration (FDA) recently outlined ten guiding principles that should be the cornerstone for the development of clinically applicable artificial intelligence. (FDA 2021) These guiding principles can help support the introduction of objective, safe and effective medical devices to the market. Beyond monitoring or defining the correct use, the core principles include many practices that have proven successful in other sectors; however, the greatest emphasis is on the so-called explainability of predictions (XAI, explainable artificial intelligence), which limits the risk of clinical bias. (Ghassemi et al. 2021)"
        },
        {
            "heading": "2 Background",
            "text": "One of the most common methods used to identify melanoma is the ABCD rule which was introduced in 1985. (Nachbar et al. 1994) The acronym stands for Asymmetry, Borderline Irregularity, Changes in Color and Diameter. In 2004, the letter E was added to the ABCD acronym to stand for Evolving. (Jensen & Elewski 2015) Each criterion has certain features that are recognized to distinguish between benign and malignant melanoma. In addition, the method failed to recognize certain malignant nevi in their early stages. (Carli et al. 2002, Liu et al. 2005)\nMelanoma is less common than other types, but it is the most dangerous form of skin cancer because it can spread quickly to other parts of the body. (Coit et al. 2009) It results from neoplastic proliferation of melanocytes. Malignant melanoma predominantly affects the skin, but can also affect eyes, ears, leptomeninges, and the mucous membranes of the mouth or genital tract. (Bastian 2014) The incidence of melanoma is increasing, affecting mainly the light skin population. (Matthews et al. 2017, Rigel et al. 1996) The pathophysiology of melanoma development is not yet clearly understood. (Hida et al. 2020) Multiple pathogenetic mechanisms of melanoma development are hypothesized. Melanoma develops not only on sun-exposed skin, where UV radiation is the main pathogenetic factor, but also in body parts that are relatively protected\nfrom radiation. (Apalla et al. 2017, Coit et al. 2009) When melanoma is suspected, it is important to biopsy the suspicious lesion on the skin or mucosa (excision with a 1-3 mm margin of tissue) and subsequent histological examination. (Bastian 2014)"
        },
        {
            "heading": "3 Computational approach",
            "text": "CADx approaches based on deep learning and computer vision may represent an effective and, above all, affordable alternative to invasive histological examination. (Kassani & Kassani 2019) Applications based on convolutional neural networks (CNN) show promising results in medical image detection, classification and segmentation. (Li et al. 2014, Anwar et al. 2018) High accuracy is now achieved in interstitial lung disease classification (Shen et al. 2015) or in the detecion of colorectal adenomas and neoplastic lesions. (Yu et al. 2016) Many attempts have been made in the literature to improve the performance of CNN, either by using optimization methods to select significant features or by using image preprocessing techniques before the classification step. (Thoma 2017)"
        },
        {
            "heading": "3.1 Proposed model arcitecture",
            "text": "CoAtNet offers a unique combination of depthwise convolutions (1) and self-attention (2) to allow fast and accurate advancement for large-scale image recognition and classification. The proposed architecture is based on the\nobservation that CNNs tend to exhibit improved generalization (i.e., the difference in performance between training and testing) due to their inductive bias, whereas self-attention models tend to show greater capacity (i.e., the ability to fit large-scale training data). (Dai et al. 2021)\n(1) is a type of convolution operation where we use one convolution filter for each input channel. (Tan & Le 2019) Unlike spatially separable convolutions, depthwise convolutions work with kernels that cannot be split. (Guo et al. 2019) In a conventional 2D convolution performed over multiple input channels, the filter is as deep as the input and allows us to arbitrarily mix channels to generate individual features in the output. (Chang & Sha 2016) In contrast, depthwise convolutions maintain each channel separately. We can express this with the formula below:\nyi = \u2211\nj\u2208L(i)\nwi\u2212j xj (1)\n(2) has become widespread technique adopted in natural language processing (NLP), with the fully-attentional Transformer model having largely replaced recurrenr neural networks (RNN) and being used in state-of-the-art language understanding models such as GPT, BERT, and XLNet. This technique allows the receptive field to be entire spatial locations, and computes weights based on renormalized pairwise similarity between pairs: if each pixel in the feature map is treated as a random variable and paring covariances are calculated, the value of each predicted pixel can be enhanced or weakened based on its similarity to other pixels in the image. The participating target pixels are the weighted sum of the values of all pixels, where the weights represent the correlation between each pixel and the target pixel. This can be represented by the following formula:\nyi = \u2211 j\u2208G\nexp ( x>i xj )\u2211 k\u2208G exp ( x>i xk\n)\ufe38 \ufe37\ufe37 \ufe38 Ai,j xj (2)"
        },
        {
            "heading": "4 Dataset",
            "text": "The development of robust CADx systems for the automated diagnosis of skin lesions is hindered by the small size of clinically evaluated dermatoscopic image datasets available. (Garg et al. 2021) We assembled dermatoscopic images from various publicly available repositories while maintaining a representation of different populations, acquired and stored by different modalities.\nThe final dataset consists of 6,826 dermatoscopic images, representative of all important diagnostic categories in the field of various lesions: actinic keratoses, basal cell carcinoma, benign keratosis-like lesions, dermatofibroma, melanoma, nevus, and vascular lesions (angiomas, angiokeratomas, pyogenic granulomas, and hemorrhages). For a fraction of the images (\u223c50%), the ground truth was determined by histopathological examination, while in the remaining images the finding was decided by expert consensus or confirmed by in vivo confocal microscopy. A total of 300 images were extracted from the dataset as a test set (100 melanoma, 100 non-melanoma skin cancer, 100 benign skin lesions). The remaining 6,526 dermatology images were split between the training and validation set in an 80/20 ratio."
        },
        {
            "heading": "4.1 Data augmentation",
            "text": "Data augmentation increases the size of the input training data along with the regularization of the model, thus improving the generalization of the training model. (Miko\u0142ajczyk & Grochowski 2018) It also helps to create new train examples by randomly applying different transformations to the available dataset to reflect the noise in the real data. (Shorten & Khoshgoftaar 2019, Elgendi et al. 2021) In this study, we applied transformations involving random rotations (<= 0.25), modifications in contrast (0.9-1.1) and brightness (0.9-1.1), zoom (<= 0.25), and saturation (0.9-1.1). The extension of validation set was not investigated."
        },
        {
            "heading": "5 Classifier performance",
            "text": "The classification performance of the proposed model for multi-class problem was evaluated for each component and the average classification performance of the model was calculated. Table 1 includes the precision (3) and recall (4) calculated based on the following equations below:\nPrecision = TP\nTP + FP (3)\nRecall = TP\nTP + FN (4)\nFor specific experiments and given that there is a class imbalance problem, the most reliable metric is the model average accuracy metric, while given that the accuracy is high, the second most important metric is the recall metric for individual classes. (Japkowicz & Stephen 2002) This is due to the importance of correctly identifying true cases that are malignant. AP (Average Precision) (5) summarizes a precision-recall curve as the weighted mean of precisions achieved at each threshold (Yilmaz & Aslam 2006), with the increase in recall from the previous threshold used as the weight:\nAP = \u2211 n (Rn \u2212Rn\u22121)Pn (5)"
        },
        {
            "heading": "5.1 Visualizing model predictions",
            "text": "Despite the classifier showing impressive results on standard metrics, from a clinical perspective, it is important for us to determine whether features relevant to skin lesion detection and analysis were extracted during CoAtNet training using backpropagation. (Payer et al. 2019) As mentioned in the chapter 1 Introduction, medical devices should not serve as \"black boxes\" but need to provide additional information about how the model arrived at its predictions.\n(England & Cheng 2019, Amann et al. 2020, Samek & M\u00fcller 2019) Gradientweighted Class Activation Mapping (Grad-CAM) is a method that uses gradient extraction from the last convolutional layer of a neural network to indicate the pixels that contribute most to the model output and the predicted probability of an image belonging to a predefined class. (Selvaraju et al. 2017) The resulting activation map can be plotted over the original image and can be interpreted as a visual tool to identify the regions that the model predicts whether an image belongs to a particular class. (Selvaraju et al. 2017, Panwar et al. 2020)"
        },
        {
            "heading": "5.2 Model performance on test data",
            "text": "The precision-recall curve shows the trade-off between precision and recall for different thresholds. (Buckland & Gey 1994) A high area under the curve represents both high recall and high precision, with high precision associated with low False Positive cases and high recall associated with low False Negative cases. (Boyd et al. 2013) The combination of the Figure 4 and Figure 5 for the test set suggests that the model learned appropriate features for classification across malignant and benign lesions from a limited dataset."
        },
        {
            "heading": "6 Conclusions",
            "text": "In this study, we classified nine skin lesions with a particular focus on melanoma, which, although not as prevalent, is responsible for three-quarters of skin cancer\nrelated deaths. The classification of melanoma was performed using no lesion segmentation or complex image preprocessing. The proposed method is based on the state-of-the-art CoAtNet architecture, which incorporates the advantages of depthwise convolution and self-attention mechanism. Considering the necessity of large-scale data for efficient training, we applied data augmentation techniques to the existing dataset. Evidence from the exploratory analysis shows that the proposed approach significantly outperforms state-of-the-art models by achieving model average precision of 0.901, recall 0.895 and AP 0.923."
        },
        {
            "heading": "7 Authorship statement",
            "text": "All persons who meet authorship criteria are listed as authors, and all authors certify that they have participated sufficiently in the work to take public responsibility for the content, including participation in the concept, design, analysis, writing, or revision of the manuscript. Furthermore, each author certifies that this material or similar material has not been and will not be submitted to or published in any other publication."
        },
        {
            "heading": "8 Ethical procedure",
            "text": "The authors hereby declare that this research article meets all applicable standards with regards to the ethics of experimentation and research integrity. The authors also declare that the text of the article complies with ethical standards, the anonymity of the patients was respected."
        }
    ],
    "title": "Visualizing CoAtNet Predictions for Aiding Melanoma Detection",
    "year": 2022
}