{
    "abstractText": "The fusion of X\u2010ray fluorescence spectroscopy (XRF) and visible near infrared spectroscopy (visNIR) has been widely used in geological exploration. The outer product analysis (OPA) has a good effect in the fusion. The dimension of the spectral matrix obtained by OPA is large, and the Competitive Adaptive Reweighted Sampling (CARS) cannot cover the whole spectrum. As a result, the selected variables by the method are inconsistent each time. In this paper, a new feature variable screening method is proposed, which uses the Least Angle Regression (LAR) to select the high dimensional spectral matrix first, and then uses CARS to complete the secondary selection of the spectral matrix, forming the LAR\u2010 CARS algorithm. The purpose is to make the sampling method cover all the spectral data. XRF and visNIR tests were carried out on three cores in two boreholes, and a cross\u2010validation set, validation set and a test set were established by combining the results of wavelength dispersion X\u2010ray fluorescence spectrometer and ITRAX Core scanner in the laboratory. The quantitative model was established with the Extreme Gradient Boosting (XGBoost) and LAR\u2010CARS was compared to these other algorithms (LAR, Successive Projections Algorithm, Monte Carlo uninformative variables elimination and CARS). The results showed that the RMSEP values of the models established by the LAR\u2010CARS for six rock\u2010forming elements (Si, Al, K, Ca, Fe, Ti) were relatively small, and the RPD ranges from 1.424 to 2.514. All these results show that the high\u2010dimensional matrix formed by XRF and visNIR integration combined with LAR\u2010CARS can be used for quantitative analysis of rock forming elements in in\u2010situ coal seam cores, and the analysis results can be used as the basis for judging lithology. The research will provide necessary technical support for digital mine construction.",
    "authors": [
        {
            "affiliations": [],
            "name": "Lei Zhu"
        },
        {
            "affiliations": [],
            "name": "Wenzhe Gu"
        },
        {
            "affiliations": [],
            "name": "Tianqi Song"
        },
        {
            "affiliations": [],
            "name": "Fengqi Qiu"
        },
        {
            "affiliations": [],
            "name": "Qingya Wang"
        }
    ],
    "id": "SP:4c3ff8f4890b137c1dcfc941947bb0cb79186ac6",
    "references": [
        {
            "authors": [
                "Y. Zhang",
                "A.E. Hartemink"
            ],
            "title": "Data fusion of vis-NIR and PXRF spectra to predict soil physical and chemical properties",
            "venue": "Eur. J. Soil Sci",
            "year": 2020
        },
        {
            "authors": [
                "V.V. Okol\u2019nishnikov",
                "A.A. Ordin",
                "S.V. Rudometov"
            ],
            "title": "Development of a digital model of mining face of coal mine",
            "venue": "Optoelectron. Instrum. Proc",
            "year": 2021
        },
        {
            "authors": [
                "F. van der Meer"
            ],
            "title": "Near-infrared laboratory spectroscopy of mineral chemistry: A review",
            "venue": "Int. J. Appl. Earth Obs. Geoinf",
            "year": 2018
        },
        {
            "authors": [
                "B Hu"
            ],
            "title": "Application of portable XRF and VNIR sensors for rapid assessment of soil heavy metal pollution",
            "venue": "PLoS One 12,",
            "year": 2017
        },
        {
            "authors": [
                "Rios",
                "F. J"
            ],
            "title": "Combined investigations of fluid inclusions in opaque ore minerals by NIR/SWIR microscopy and microthermometry and synchrotron radiation X-ray fluorescence",
            "venue": "Appl. Geochem",
            "year": 2006
        },
        {
            "authors": [
                "O. Haavisto",
                "J. Kaartinen"
            ],
            "title": "Multichannel reflectance spectral assaying of zinc and copper flotation slurries",
            "venue": "Int. J. Miner. Process",
            "year": 2009
        },
        {
            "authors": [
                "W Qingya"
            ],
            "title": "Quantitative analysis of soil cadmium content based on the fusion of XRF and Vis-NIR data",
            "venue": "Chemom. Intell. Lab. Syst. 226,",
            "year": 2022
        },
        {
            "authors": [
                "Q. Wang",
                "F. Li"
            ],
            "title": "On-stream mineral identification of tailing slurries of tungsten via NIR and XRF data fusion measurement techniques",
            "venue": "Anal. Methods",
            "year": 2020
        },
        {
            "authors": [
                "F. Marini",
                "M. Tomassetti",
                "M. Piacentini",
                "L. Campanella",
                "P. Flamini"
            ],
            "title": "Application of near infrared spectroscopy (NIR), X-ray fluorescence (XRF) and chemometrics to the differentiation of marmora samples from the Mediterranean basin",
            "venue": "Nat. Prod. Res",
            "year": 2016
        },
        {
            "authors": [
                "J. Thomson",
                "I.W. Croudace",
                "R.G. Rothwell"
            ],
            "title": "A geochemical application of the ITRAX scanner to a sediment core containing eastern Mediterranean sapropel units",
            "venue": "Geol. Soc. Lond. Spec. Publ. 267,",
            "year": 2006
        },
        {
            "authors": [
                "R. Tjallingii",
                "U. R\u00f6hl",
                "M. K\u00f6lling",
                "T. Bickert"
            ],
            "title": "Influence of the water content on X-ray fluorescence core-scanning measurements in soft marine sediments: XRF CORE SCANNING",
            "venue": "Geochem. Geophys. Geosyst",
            "year": 2007
        },
        {
            "authors": [
                "T.S. Paulsen",
                "R.D. Jarrard",
                "T.J. Wilson"
            ],
            "title": "A simple method for orienting drill core by correlating features in whole-core scans and oriented borehole-wall imagery",
            "venue": "J. Struct. Geol",
            "year": 2002
        },
        {
            "authors": [
                "Barros",
                "A. S"
            ],
            "title": "Relations between mid-infrared and near-infrared spectra detected by analysis of variance of an intervariable data matrix",
            "venue": "Appl. Spectrosc",
            "year": 1997
        },
        {
            "authors": [
                "D Wang"
            ],
            "title": "Synthesized use of VisNIR DRS and PXRF for soil characterization: Total carbon and total nitrogen",
            "venue": "Geoderma 243\u2013244,",
            "year": 2015
        },
        {
            "authors": [
                "S. Wang",
                "W. Li",
                "J. Li",
                "X. Liu"
            ],
            "title": "Prediction of soil texture using FT-NIR spectroscopy and PXRF spectrometry with data fusion",
            "venue": "Soil Sci. 178,",
            "year": 2013
        },
        {
            "authors": [
                "A Gholizadeh"
            ],
            "title": "vis-NIR and XRF data fusion and feature selection to estimate potentially toxic elements in soil",
            "venue": "Sensors 21,",
            "year": 2021
        },
        {
            "authors": [
                "F.A.P. Peres",
                "F.S. Fogliatto"
            ],
            "title": "Variable selection methods in multivariate statistical process control: A systematic literature review",
            "venue": "Comput. Ind. Eng. 115,",
            "year": 2018
        },
        {
            "authors": [
                "J. Pacheco",
                "S. Casado",
                "L. N\u00fa\u00f1ez"
            ],
            "title": "A variable selection method based on Tabu search for logistic regression models",
            "venue": "Eur. J. Oper. Res",
            "year": 2009
        },
        {
            "authors": [
                "G Tang"
            ],
            "title": "A new spectral variable selection pattern using competitive adaptive reweighted sampling combined with successive projections algorithm",
            "venue": "Analyst 139,",
            "year": 2014
        },
        {
            "authors": [
                "H. Li",
                "Y. Liang",
                "Q. Xu",
                "D. Cao"
            ],
            "title": "Key wavelengths screening using competitive adaptive reweighted sampling method for multivariate calibration",
            "venue": "Anal. Chim. Acta 648,",
            "year": 2009
        },
        {
            "authors": [
                "J. Liu",
                "P. Hu",
                "H. Xue",
                "X. Pan",
                "C. Chen"
            ],
            "title": "Prediction of milk protein content based on improved sparrow search algorithm and optimized back propagation neural network",
            "venue": "Spectrosc. Lett. 55,",
            "year": 2022
        },
        {
            "authors": [
                "L L\u00f6wemark"
            ],
            "title": "Practical guidelines and recent advances in the Itrax XRF core-scanning procedure",
            "venue": "Quatern. Int. 514,",
            "year": 2019
        },
        {
            "authors": [
                "J. Ye",
                "Z. Tian",
                "H. Wei",
                "Y. Li"
            ],
            "title": "Baseline correction method based on improved asymmetrically reweighted penalized least squares for the Raman spectrum",
            "venue": "Appl. Opt",
            "year": 2020
        },
        {
            "authors": [
                "A. Savitzky",
                "M.J. Golay"
            ],
            "title": "Smoothing and differentiation of data by simplified least squares procedures",
            "venue": "Anal. Chem",
            "year": 1964
        },
        {
            "authors": [
                "P. Geladi",
                "D. MacDougall",
                "H. Martens"
            ],
            "title": "Linearization and scatter-correction for near-infrared reflectance spectra of meat",
            "venue": "Appl. Spectrosc",
            "year": 1985
        },
        {
            "authors": [
                "F.S. Terra",
                "R.A. ViscarraRossel",
                "J.A.M. Dematt\u00ea"
            ],
            "title": "Spectral fusion by Outer Product Analysis (OPA) to improve predictions of soil organic C",
            "venue": "Geoderma 335,",
            "year": 2019
        },
        {
            "authors": [
                "J de Rubio"
            ],
            "title": "Learning of operator hand movements via least angle regression to be teached in a manipulator",
            "venue": "Evol. Syst",
            "year": 2020
        },
        {
            "authors": [
                "M.R.E. Symonds",
                "A. Moussalli"
            ],
            "title": "A brief guide to model selection, multimodel inference and model averaging in behavioural ecology using Akaike\u2019s information criterion",
            "venue": "Behav. Ecol. Sociobiol",
            "year": 2011
        },
        {
            "authors": [
                "L. Hu",
                "C. Yin",
                "S. Ma",
                "Z. Liu"
            ],
            "title": "Rapid detection of three quality parameters and classification of wine based on Vis-NIR spectroscopy with wavelength selection by ACO and CARS algorithms. Spectrochim",
            "venue": "Acta Part A Mol. Biomol. Spectrosc",
            "year": 2018
        },
        {
            "authors": [
                "Ara\u00fajo",
                "M.C. U"
            ],
            "title": "The successive projections algorithm for variable selection in spectroscopic multicomponent analysis",
            "venue": "Chemom. Intell. Lab. Syst",
            "year": 2001
        },
        {
            "authors": [
                "J Li"
            ],
            "title": "Nondestructive firmness measurement of the multiple cultivars of pears by Vis-NIR spectroscopy coupled with multivariate calibration analysis and MC-UVE-SPA method",
            "venue": "Infrared Phys. Technol",
            "year": 2020
        },
        {
            "authors": [
                "Ren",
                "H.-Y"
            ],
            "title": "Estimation of As and Cu contamination in agricultural soils around a mining area by reflectance spectroscopy: A case study",
            "venue": "Pedosphere 19,",
            "year": 2009
        },
        {
            "authors": [
                "R.V. Rossel",
                "R. McGlynn",
                "A. McBratney"
            ],
            "title": "Determining the composition of mineral-organic mixes using UV\u2013Vis\u2013NIR diffuse reflectance spectroscopy",
            "venue": "Geoderma 137,",
            "year": 2006
        },
        {
            "authors": [
                "R. Hu",
                "L. Zhang",
                "Z. Yu",
                "Z. Zhai",
                "R. Zhang"
            ],
            "title": "Optimization of soluble solids content prediction models in \u2018Hami\u2019 melons by means of Vis-NIR spectroscopy and chemometric tools",
            "venue": "Infrared Phys. Technol",
            "year": 2019
        },
        {
            "authors": [
                "Coelho",
                "A.R. F"
            ],
            "title": "Natural mineral enrichment in Solanum tuberosum L. cv. Agria: Accumulation of Ca and interaction with other nutrients by XRF analysis",
            "venue": "The 1st International Electronic Conference on Plant Science",
            "year": 2020
        },
        {
            "authors": [
                "P. Samui",
                "D.P. Kothari"
            ],
            "title": "Utilization of a least square support vector machine (LSSVM) for slope stability analysis",
            "venue": "Sci. Iran",
            "year": 2011
        },
        {
            "authors": [
                "T. Li",
                "H. Wang",
                "X. Chen",
                "J. Zhou"
            ],
            "title": "Soil reserves of potassium: Release and availability to Lolium perenne in relation to clay minerals in six cropland soils from eastern China: Soil potassium dynamics in relation to clay minerals in eastern China",
            "venue": "Land Degrad. Dev",
            "year": 2017
        }
    ],
    "sections": [
        {
            "text": "1 Vol.:(0123456789) Scientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\nwww.nature.com/scientificreports\nCoal seam in\u2011situ inorganic analysis based on least angle regression and competitive adaptive reweighted sampling algorithm by XRF\u2013visNIR fusion Lei Zhu 1, Wenzhe Gu 2*, Tianqi Song 1, Fengqi Qiu 1 & Qingya Wang 3,4\nThe fusion of X\u2011ray fluorescence spectroscopy (XRF) and visible near infrared spectroscopy (visNIR) has been widely used in geological exploration. The outer product analysis (OPA) has a good effect in the fusion. The dimension of the spectral matrix obtained by OPA is large, and the Competitive Adaptive Reweighted Sampling (CARS) cannot cover the whole spectrum. As a result, the selected variables by the method are inconsistent each time. In this paper, a new feature variable screening method is proposed, which uses the Least Angle Regression (LAR) to select the high dimensional spectral matrix first, and then uses CARS to complete the secondary selection of the spectral matrix, forming the LAR\u2011 CARS algorithm. The purpose is to make the sampling method cover all the spectral data. XRF and visNIR tests were carried out on three cores in two boreholes, and a cross\u2011validation set, validation set and a test set were established by combining the results of wavelength dispersion X\u2011ray fluorescence spectrometer and ITRAX Core scanner in the laboratory. The quantitative model was established with the Extreme Gradient Boosting (XGBoost) and LAR\u2011CARS was compared to these other algorithms (LAR, Successive Projections Algorithm, Monte Carlo uninformative variables elimination and CARS). The results showed that the RMSEP values of the models established by the LAR\u2011CARS for six rock\u2011forming elements (Si, Al, K, Ca, Fe, Ti) were relatively small, and the RPD ranges from 1.424 to 2.514. All these results show that the high\u2011dimensional matrix formed by XRF and visNIR integration combined with LAR\u2011CARS can be used for quantitative analysis of rock forming elements in in\u2011situ coal seam cores, and the analysis results can be used as the basis for judging lithology. The research will provide necessary technical support for digital mine construction.\nX-ray fluorescence (XRF) and near infrared spectroscopy technology (visNIR) are widely used in geological exploration, soil pollution investigation, inorganic and organic content analysis1. In recent years, the construction of digital mines has attracted a lot of attention, and the application of new technologies has promoted the digital process of core exploration2. In particular, XRF and visNIR have made great progress in the field of digital core. For example, portable single-optical path raster scanning NIR mineral analyzer developed by the Institute of Intelligent Instruments and Measurement and Control Technology of Jilin University, near-infrared mineral analyzer developed by Nanjing Institute of Geology and Mineral Resources, in-site portable XRF analyzer developed by Chengdu University of Technology3. The development of these small instruments provides technical support for digital mine construction.\nXRF and visNIR are both rapid and nondestructive detection techniques, which have been used in digital mining for decades. However, due to the physical limitations of XRF and visNIR, many factors can affect the accuracy and reproducibility of in-situ analysis. Therefore, the spectral fusion of XRF and visNIR was proposed and also applied in the characterization of soil, minerals and element content4. Rios et\u00a0al.5 introduced visNIR\nOPEN\n1China Coal Energy Research Institute Co., Ltd., Xi\u2019an 710054, China. 2School of Energy and Mining Engineering, China University of Mining and Technology (Beijing), Beijing 10083, China. 3State Key Laboratory of Nuclear Resources and Environment, East China University of Technology, Nanchang 330013, China. 4School of"
        },
        {
            "heading": "Automation Engineering, University of Electronic Science and Technology of China, Chengdu 611731, Sichuan,",
            "text": "China. *email: guwenzhecumtb@163.com\n2 Vol:.(1234567890) Scientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\nas a supplementary detection technology to make up for the deficiency of XRF in mineral characterization, and studied the internal characteristics of hematite and granite-greenstone ore in detail. Haavisto6 applied visNIR and XRF analyzer together in the content determination of floating slurry to obtain high-frequency detection results and sudden changes in grade. Wang et\u00a0al.7,8 set up visNIR and XRF spectral fusion equipment to carry out quantitative analysis of four minerals in tungsten ore flotation process, and the results can be used for accurate ratio of flotation slurry. Marini et\u00a0al.9 performed in-situ quantitative analysis of mineral samples in The Mediterranean Basin by fusion of NIR and XRF combined with stoichiometry and obtained good results. At the same time, the fusion devices of the two technologies have also been developed, such as ITRAX Core Scanner10, Avaatech Scanner11, DMT Core Scan12. In recent years, numerous studies have shown that the fusion of XRF and visNIR by outer product analysis (OPA) method can obtain richer characteristic spectra13\u201315, and the established quantitative model has better robustness.\nOuter product analysis (OPA) is accomplished through the Kronecker product form of two detection signals16. However, the data volume after fusion is large, the dimension of variables is high, and there is interference of multicollinearity problem. When using partial least squares or support vector machines to build quantitative model of mineral or element, the prediction ability and robustness of the model will be reduced. It is particularly important to select appropriate variables for data with high dimensions. At present, more and more screening methods of characteristic variables have been proposed, such as variable selection method based on statistics17, variable selection method based on a single indicator and swarm intelligence optimization algorithm18. These algorithms provide a broad idea for variable selection.\nThe CARS uses Monte Carlo (MC) sampling and PLS regression coefficient as the index to select characteristic wavelength variables19. The adaptive reweighted sampling (ARS)20 as the core of the method to retain the wavelength points with heavy weight (large absolute value of regression coefficient) in the PLS model, and select the optimal variable subset combination according to the principle of minimum root mean square error of cross-validation. Many research results show that the CARS has simple structure, quick operation speed, but covering all OPA variables with MC sampling is very difficult. The number of extracted variables is big (more than 4,000,000 using XRF and visNIR data), the models are prone to overfitting, and have poor stability, so the improvement of CARS is a significant work21.\nThe Least Angle regression (LAR) combined with wavelength selection method of CARS (LAR-CARS) is proposed. A large number of characteristic variables are screened first and then refined again. This combination of methods can not only ensure the operation speed, but also ensure the MC sampling covers all the feature data. At present there is no report on the combination of inorganic element analysis method with it. In this study, core coal and naturally broken coal were collected in Zhashui mining area of China. XRF and visNIR were used to obtain the original spectral information of core. After necessary data pretreatment, model input was generated through OPA. The LAR-CARS algorithm was compared with the LAR, Successive Projections Algorithm (SPA), MC-UVE and CARS methods. XGBoost was used to establish a quantitative model and compare the statistical parameters of the model. The objective of this study was (a) evaluate and compare the correlation between the newly proposed LAR-CARS variable selection method and inorganic elements in coal seams and its importance for modeling performance, (b) explore the optimal modeling strategy for the analysis of inorganic elements in coal core by XRF and visNIR through exoproduct fusion, and evaluate the applicability of this method. The purpose of this study is to develop a data fusion technique that can be applied to in-situ core detection."
        },
        {
            "heading": "Materials and methods",
            "text": "Experimental area and sampling. Drilling core sampling points are distributed in Zhashui County, Shaanxi province (108\u00b049\u203248\u2033\u2013109\u00b02\u203231\u2033\u00a0E, 33\u00b032\u203216\u2033\u201333\u00b041\u203213\u2033\u00a0N), which is abundant in mineral resources, especially coal and iron resources. The sampling locations are shown in Fig.\u00a01. S1 and S2 were taken out from Position 1, and S3 was taken out from Position 2. The cores of the three sections were not connected, they were all located in the coal reservoir, and the mineral types were similar. Three separate drill cores were studied here. Each core was 100\u00a0mm in diameter.\nSamples\nPosition 1\nPosition 2\nPosition 1 Position 2\nS2 S3\nS1\nFigure\u00a01. The location of the studied agricultural fields in Zhashui, China. (generated from publicly available geoscience data on the DataV.GeoAtlas platform; http:// datav. aliyun. com/ portal/ school/ atlas/ area_ gener ator, last access: 19 July 2022).\n3 Vol.:(0123456789) Scientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\nSpectral collection. After core S1 and S2 were extracted, spectral tests were carried out. Olympus Delta Premium (DP-6000-C) Field-portable XRF Analyser; SDD detector; Rh target, 125\u00a0eV energy resolution, Amptek. Test parameters were: tube voltage 35\u00a0kV, current 40\u00a0\u03bcA, Test time 30\u00a0s. VisNIR Spectroscopy was recorded using a FieldSpec Pro FR visNIR Spectrometer (PANalytical Inc., formerly Analytical Spectral Devices-ASD, Boulder, CO). The spectral range was 350\u20132500\u00a0nm. The sampling interval was 3\u00a0nm (350\u20131000\u00a0nm) and 10\u00a0nm (1000\u20132500\u00a0nm), and the sampling resolution of the spectra was 1\u00a0nm. A Spectralon\u00ae panel with 99% reflectance was used to calibrate the spectrometer and each sample was randomly scanned 10 times. The average of three results with the best signal-to-noise ratio were the spectrum of the samples.\nThe XRF and visNIR tests were conducted at 50\u00a0mm intervals, assisted by a marker length tape parallel to the core axis. Fractures were avoided when testing, requiring that each test be directly against solid rock or coal. Move the measuring point slightly if necessary and mark the test point finally. 318 points with 656 spectral data (XRF: 322, NIR: 334) were detected for analysis by S1 and S2. 295 points (XRF: 295, NIR: 295) were left after kicking out operational errors and obvious differences caused by changes in experimental environment. 174 spectral data (XRF: 87, NIR: 87) were collected from S3 and no abnormal data was found after inspection.\nLaboratory physicochemical analysis. 4\u00a0g samples were taken from S1 and S2 according to the test points, dried at 105\u00a0 \u00b0C for 1\u00a0 h and cooled to room temperature. The samples were placed in a tablet press (Shanghai Shengli SL201 semi-automatic press machine). High-density polyethylene dry powder was used as the substrate, and 0.4\u00a0g maltodextrin powder was added to the samples that were difficult to form, kept at 40\u00a0T pressure for 20\u00a0s. Pressed into a diameter of 32\u00a0mm, outer diameter of 40\u00a0mm wafer, a total of 295 samples. Wavelength dispersive X-ray fluorescence spectrometer (Axios Pw4400, Panaco, the Netherlands) was used during this research, and the test parameters are shown in Table\u00a01.\nS3 was scanned and analyzed using ITRAX Core Scanner. Before scanning, the core scanner was corrected with the sample discretization results of WD-XRF to ensure the consistency of the instrument results. The sampling interval of instrument was 1\u00a0cm on the core, and the other parameters were set according to the Ref.22 to obtain the oxide content results, which were converted to the element content.\nSpectral pretreatment and out product fusion. XRF is characteristic spectrum. In the process of spectral acquisition, there will be a lot of noise information interference such as high-frequency random noise, baseline drift and scattering, which will affect the correlation between XRF spectrum and element content, and ultimately affect the reliability and stability of model establishment, so it is necessary to preprocess spectral data.\nConsidering the large amount of noise at both ends of the detection range, the introduction of these noises will affect the performance of the model. First, delete the data at both ends and keep the data in the middle which contain more information about the element content. The visNIR reflection spectrum intercepted 450\u20132450\u00a0nm (2000 channels) and converted the reflection spectrum into an absorption spectrum. The XRF spectrum was selected from 0.405 to 42.105\u00a0keV (2000 channels). The purpose was to eliminate the influence of noise and low-energy radiation. The sym4 wavelet function was used for wavelet transform denoising and the adaptive iterative weighted penalty least squares (airPLS) method was used to calibrate the baseline23. Then, baseline correction was performed on both spectra. Savitzky\u2013Golay (SG) smoothing24 with 15 window size and second order polynomial, Standard Normal Variate (SNV)25 were used to preprocess the raw data. At this time, the numerical range of visNIR spectrum was \u2212 3.92 to 4.59, and the numerical range of XRF spectrum was \u2212 1.56 to 3.37, which solved the dimensional inconsistency between different physical quantities. This problem is commonly encountered in data fusion. The pre-processed spectral data are shown in Fig.\u00a02a,b. Because 370 spectral data are displayed, the transparency of each data is set to 90%. The darker the color, the more concentrated the location of the spectrum appears.\nThe OPA is calculated by the Kronecker product of XRF and visNIR, and the fusion process is detailed in Ref.26. XRF and visNIR spectra each have 2000 channels. After fusion, the spectral variable reaches 2000 \u00d7 2000. The fused matrix is shown in Fig.\u00a02c. The spectrum pretreatment and OPA steps are completed.\nThe least angle regression and competitive adaptive reweighting sampling algorithm (LAR\u2011CARS). Algorithm principle. LAR-CARS consists of LAR and CARS. LAR is first used for the matrix with higher dimensions to complete the coarse selection of feature variables, and then CARS is used to complete the fine selection of feature variables. Least Angle Regression algorithm (LAR)27 is a new machine algorithm\nTable 1. Test conditions of wavelength dispersive X-ray fluorescence analyzer.\nChannel Spectral lines Crystal Collimator (\u03bcm) The detector Tube voltage (kV) Tube current (mA)\nSi K\u03b1 Li200 150 Scient 60 60\nAl K\u03b1 Li200 150 Flow 60 60\nK K\u03b1 Li200 150 Scient 60 60\nCa K\u03b1 Li200 150 Flow 60 60\nFe K\u03b1 Li200 150 Scient 60 60\nTi K\u03b1 Li200 150 Scient 60 60\nS K\u03b1 Li200 150 Scient 60 60\n4 Vol:.(1234567890) Scientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\nproposed based on linear regression principle. The algorithm is faster than other methods in selecting characteristic variables. The principle of the algorithm is relatively simple. First, the first-order penalty function is constructed to make the coefficient of the variable zero, and then some invalid variables are removed to reduce the scale of the model and a model with higher explanatory degree is obtained. The linear regression model is shown as follows:\nwhere ( xi1, xi2, . . . , xip )\nis the independent variable corresponding to the ith sample, yi is the dependent variable, and \u03b4j represents the regression coefficient of the j-th independent variable, and its constraint value is t. Under the constraint of formula (2), LAR algorithm adjusts \u03b4i to minimize the sum of the square variances of yi and the regression variable \u00b5i . When the initial value of t is small, the coefficient of the independent variable \u03b4i with low variable dependence is directly set to zero, and these characteristic variables are eliminated. The remaining variables are reconstituted into sparse feature matrix. When t increases to a large value or a preset value, the constraint disappears, and the least square method is used to solve the data subset. The main method for determining t value is Akaikes Information Criterion (AIC)28.\nConcrete implementation process is (1) vector X variable coefficient of the initial value is set to 0, and then in the direction of feature vector xi, find out the y(0) that has the greatest correlation with the initial target residuals. (2) move the xi by \u03b8j step length to xj, make the characteristic of residual vector y(0) \u2212 \u03b8ixi and xj have the same relevance (i.e., is located in the angle of the xi and xj just divide the line). (3) move along the angular bisector until the next variable xl with the same residual correlation with (xi,\u00a0xj) is found, and the cycle continues until all variables are selected. The two-dimensional plane calculation process of the algorithm is shown in Fig.\u00a03.\nCARS algorithm combines Monte Carlo sampling with PLS and establishes feature wavelength selection method based on the \"survival of the fittest\" rule in biological evolution29. Adaptive Reweighted Sampling (ARS) technology20 is used to screen out characteristic wavelengths with large absolute values of regression coefficients and remove those with small absolute values, so as to obtain a series of optimal subsets of variables. Then, the cross-validation method is used to determine the subset with the minimum RMSECV value in the variable quantum set, which is the optimal wavelength combination of the measured elements.\n(1)min S(\u03b4) =\ufffd y \u2212 \u00b5 \ufffd2= n \ufffd\ni=1\n\ufffd yi \u2212 \u00b5i \ufffd2 =\nn \ufffd\ni=1\n\nyi \u2212\np \ufffd\nj=1\nxij\u03b4j\n\n\n2\n(2)subject to p \u2211\nj=1\n\u2223 \u2223\u03b4j \u2223 \u2223 \u2264 t (t \u2265 0)\n0 10 20 30 40 100 101 102 103 104 105 106 Co un ts (c ps )\nEnergy (keV) 400 800 1200 1600 2000 2400\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nR ef le ct an ce\nWanvelength(nm)\na. b.\n-5.000\n-1.300\n2.400\n6.100\n9.800\nThe OPA value\nc.\nFigure\u00a02. The acquired spectra, (a) XRF, (b) visNIR, (c) OPA.\nx2\nx(1)\nx2\n\u03b8i x1\nx(2)=x1+x2 \u03b1=\u03b2\ny(0)\ny(1) \u03b1 \u03b2\nFigure\u00a03. The two-dimensional diagram of LAR algorithm.\n5 Vol.:(0123456789) Scientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\nAlgorithm steps. First, LAR was used for preliminary screening of the fused spectral feature variables, and CARS was used for further screening of the selected variables, so as to find the minimum set of feature energy points with excellent modeling performance and interpretation. The specific steps are as follows:\n(1) Assuming that the fused spectral data is an i \u00d7 l matrix, the input model is used to solve the regression coefficient, and the regression variable matrix is constructed. The model solution is based on the principle of AIC minimization. The correlation of characteristic variable I is represented by 0 and 1, with 0 representing low correlation and 1 representing high correlation. (2) LAR model uses variable matrix to solve spectral characteristic variables:\nwhere X is the characteristic variables selected by LAR model. X is the fusion spectral matrix by OPA and \u03b2 = [\u03b21, \u03b22, . . . , \u03b2l]\nT is the regression variable matrix. (3) The variables screened by LAR were randomly sampled 50 times by Monte Carlo sampling method. The\nregression analysis model is established by subset variables X and target element quantity Y,\nThe contribution matrix \u03b2i can be expressed as\nThe corresponding weight wi of each feature variable is solved through the matrix\n(4) Exponential decay functions were used to forcibly remove wavelength points with relatively small weights. (5) Wavelength with large absolute value of regression coefficient in PLS model was screened by N times\nadaptive reweighting sampling technology. RMSECV value of new variable subset generated each time was calculated and compared, and the variable subset with the smallest value was regarded as the optimal variable subset.\nFinally, Matlab R2019b and Origin 2018.0 were used to complete the algorithm writing and chart drawing of LAR, SPA, MC-UVE and CARS. Firstly, the LOOCV set samples were modeled, and the single sample test and the fused OPA spectrum (2000 \u00d7 2000) were selected as the objects. LAR, SPA, MC-UVE, CARS and LARCARS algorithms were used for screening. The selection method of CARS variable was based on Monte Carlo cross validation, the maximum number of principal components was 50, the number of Monte Carlo operation samples was 50, the number of interactive verification samples was 10, and the number of operation times was 50. SPA variable selection method used vector projection analysis principle. Specific principles and steps of SPA and MC-UVE variable selection methods can be found in literature30,31 The computer\u2019s environment was configured as Intel Core i7-9750H @2.60\u00a0GHz, 16\u00a0GB (2667\u00a0MHz), Intel UHD Graphics 630 128\u00a0MB.\nData analysis and evaluation indicators. Gradient boosting decision tree (GBDT) is an integrated learning algorithm based on decision tree. The base learner of GBDT adopts regression tree, and each tree fits the negative gradient of the loss function on the previous tree. Finally, the linear weighted sum of the results of all regression trees is taken as the output model. XGBoost is an efficient implementation of GBDT, and its base learner includes classification tree and regression tree. The analysis of coal seam inorganic elements in this study belongs to regression problem, so the base learner used in this study is regression tree. Compared with GBDT algorithm, XGBoost algorithm explicitly adds regularization terms in the objective function. When updating the base learner, GBDT generates the base learner iteratively according to the first derivative, while XGBoost updates the base learner not only according to the first derivative but also according to the second derivative. In addition, XGBoost algorithm also makes a lot of optimization during implementation. An XGBoost model with n trees can be expressed as:\nwhere yi represents the element content of the i-th sample, xi represents the characteristic variable after spectral screening of the i-th sample, and fn represents the prediction function of the n-th decision tree.\nGradient Boosting strategy is adopted for XGBoost model, which updates the model by updating the negative Gradient direction of the loss function, and its optimization model can be expressed as\n(3)X = X\u03b2\n(4)Y = Xi\u03b2+ \u03b5 = X\u03b2i + \u03b5\n(5)\u03b2i = X \u22121 i (Y \u2212 \u03b5)\n(6)\u03c9i =\n\u2223\n\u2223 \u2223 X \u22121 i (Y \u2212 \u03b5) \u2223 \u2223 \u2223\np \u2211\ni=1\n\u2223\n\u2223 \u2223X \u22121 i (Y \u2212 \u03b5) \u2223 \u2223 \u2223\ni = 1, 2, . . . , p\n(7)yi = N \u2211\nn=1\nfn(xi)\n(8)\ufffd(f ) = \u03b3T + 1\n2 \ufffd \u03c9 \ufffd2\n6 Vol:.(1234567890) Scientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\nwhere l (yi,yi) represents the loss function, i.e., the mean square error, \u03a9(fn) represents the regularization term, \u03b3 represents the model complexity, T represents the number of leaf nodes in the model, represents the fixed coefficient, and \u03c9 represents the quantization weight vector of leaf nodes. On the basis of preserving the welltrained tree model, XGBoost model continuously substituted the derivative of the prediction function according to the loss function into the prediction function of the last round to update the prediction function, and finally obtained the prediction result through iterative calculation.\nIn order to comprehensively evaluate the performance of all models, Cores S1 and S2 were modeled and validated. Applicability analysis was performed with S3 cores. The modeling process was as follows: WD-XRF test samples (295) were used as cross-validation, and separate cores (75 points) were used to independently verify the model. Leave-One-Out-Cross-Validation (LOOCV) was used to train the model. In this way, one sample in the group of built models is eliminated, and the remaining samples are used to train the model to predict the composition of excluded samples, calculate the difference between the predicted value and the actual value, and repeat the process until all samples are removed once. The total error obtained is the prediction accuracy of the cross-validation root mean square Error (RMSECV) judgment model. The statistical distribution of LOOCV set and prediction set is shown in Table\u00a02.\nThe root mean square error of prediction (RMSEP) was obtained by predicting the single core mining point. The overall prediction accuracy of the model was measured by four parameters: coefficient of determination (R2), root mean square error of cross validation (RMSECV), RMSEP and relative deviation percentage (RPD). R2 reflects the stability of model establishment and validation. RMSECV and RMSEP are used to test the predictive power of the model32. RPD is the ratio of sample standard deviation to RMSE, which measures the predictive power of the model. When RPD < 1.4, this model cannot be used to predict samples. When 1.4 \u2264 RPD < 2, the model is considered just good enough to be used for rough evaluation of samples. When RPD \u2265 2, the model has good predictive ability33. The LAR and CARS information processing flow chart presented in this paper is shown in Fig.\u00a04. The parameters of the LAR-CARS algorithm were set as follows: the number of repetitions is 2048, the maximum number of latent variables of cross-validation is 10, the preprocessing method is center-centered, and the number of Monte card sampling is 50."
        },
        {
            "heading": "Results and analysis",
            "text": "Selection of spectral characteristic variables. Screening results are shown in Fig.\u00a05. According to the results, the number of variables roughly selected by LAR is larger than other algorithms. According to the algorithm principle, the LAR principle is simple and many variables are screened out. CARS showed a small number of variables obtained from the four commonly used variable screening methods, with the number of variables ranging from 2537 to 4138. Compared with MC-UVE, SPA algorithm had a smaller number of variables, ranging from 2766 to 5678. MC-UVE had a large number of variables, ranging from 10,777 to 22,347. The results obtained are similar to previous reports34.\nThe number of screening variables directly affects the calculation speed of the model. The distribution of single element screening variables will be studied below. Figure\u00a06 shows the distribution positions of the characteristic variables of calcium elements in the whole spectrum based on different extraction methods. As can be\nSet type Core Metal Max. (%) Min. (%) Mean (%) SD (%) CV (%) Skewness Kurtosis\nLOOCV set(train set) S1\nSi 46.877 2.602 25.763 9.755 0.379 \u2212 0.077 \u2212 0.692\nAl 21.918 3.249 12.399 4.164 0.336 0.048 \u2212 0.781\nK 3.441 0.288 1.784 0.718 0.403 \u2212 0.004 \u2212 0.812\nCa 10.427 0.184 5.370 3.012 0.561 \u2212 0.075 \u2212 1.313\nFe 11.534 0.355 5.835 2.953 0.506 0.127 \u2212 1.121\nTi 1.457 0.061 0.749 0.341 0.454 0.069 \u2212 0.936\nValidation set S2\nSi 43.270 3.474 21.847 9.883 0.452 0.238 \u2212 0.793\nAl 22.615 3.132 10.664 4.597 0.431 0.393 \u2212 0.459\nK 4.501 0.620 1.960 0.768 0.392 0.638 0.474\nCa 12.099 0.393 4.976 2.897 0.582 0.375 \u2212 0.608\nFe 13.504 0.624 5.119 2.842 0.555 0.517 \u2212 0.294\nTi 2.565 0.150 1.099 0.474 0.431 0.691 0.333\nTest set S3\nSi 36.738 9.009 21.655 6.126 0.283 0.361 \u2212 0.404\nAl 17.809 3.133 10.706 2.715 0.254 0.350 0.535\nK 3.366 0.828 1.960 0.451 0.230 0.239 0.853\nCa 10.674 1.792 5.094 1.678 0.329 0.220 0.410\nFe 8.652 1.053 5.138 1.587 0.309 \u2212 0.192 \u2212 0.490\nTi 2.022 0.541 1.078 0.297 0.276 0.229 0.121\n7 Vol.:(0123456789) Scientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\nseen from the figure, the visNIR features extracted by LAR were mainly concentrated in 800\u20131200 channel, and the XRF features were mainly concentrated in 400\u2013800 channel and about 1600 channel. The wavelength range of SPA screening was similar to that of LAR. Compared with LAR, SPA method reduced the visNIR features of 1300\u20131800 channel and XRF features of 1200\u20131600 channel. The LAR-CARS selected the lowest number of features, and compared with LAR results, the visNIR 1200\u20132000 channel density was diluted and the XRF 1000\u20132000 channel count was reduced. The results of LAR-CARS were concentrated around 800\u20131200 and 1600 channel in visNIR and 746 channel in XRF. The spectrum range of 800\u20131200 channel was 1149\u20131549\u00a0nm, represents the out-of-plane deformation vibration and C\u2013H stretching vibration according the visNIR spectrometer handbook. These peaks had strong characteristics, but more interference. The 1600 channel corresponds to 1949\u00a0nm, where the stretching vibration of C\u2013H double bond was mainly present. According to the XRF calibration results of pure elements, the 400\u2013800 channel corresponds to 8.381\u201316.783\u00a0keV, which mainly correspond to the K\u03b1 characteristic peaks of Cu, Ni, Zn, Ga, As and other heavy metals.\nThere are K\u03b1 characteristic peak of Rh, Pd, Ag, Cd elements around the 1600 channel at 23.587\u00a0keV. LAR algorithm can filter out the Ca element characteristic peak 3.69\u00a0keV, while other algorithm do not selected the characteristic peak. The reason was that there are many disturbances near the Ca characteristic peak, such as K and Ar in the air, which can interference of Ca. The linear relationship between Ca peak intensity and content was severely affected, so the linear relationship is not strong, which is also the reason why Ca cannot be quantified by traditional XRF calibration method, which is similar to what was reported in literature35.\nEvaluation of feature selection. In this section, the LAR-CARS algorithm was used to screen the wavelength variables of the sample spectrum, and compared with the LAR, SPA, MC-UVE and CARS algorithms, the six elements of Si, Al, K, Ca, Fe and Ti in the core, LAR-XGBoost, SPA-XGBoost, MC-UVE-XGBoost and\nFigure\u00a04. The Flow chart of proposed variable selection method by LAR-CARS.\n2 5\n2 8\n1\n4 7\n6 1\n1 7\n6 8\n9\n2 8\n0 9\n5 2\n9\n1 3\n4 3\n6\n3 8\n9 2\n1 5\n4 7\n3\n2 6\n0 4\n4 7\n1\n2 7\n8 6\n9\n5 6\n7 8\n2 2\n3 4\n7\n4 1\n3 8\n8 6\n8\n1 0\n0 3\n4\n2 7\n6 6\n1 0\n7 7\n7\n1 9\n1 6\n4 3\n0\n3 6\n1 2\n8\n5 6\n7 3\n2 0\n1 1\n5\n3 4\n6 8\n7 3\n2\n2 3\n4 1\n4\n3 3\n0 9\n1 3\n3 7\n5\n2 5\n3 7\n5 9\n4\nLAR SPA MC-UVE CARS LAR-CARS 102\n103\n104\n105\nT h\ne o\np ti\nm al\nn u\nm b\ner o\nf v\nar ia\nb le\ns\nVariable screening method\nSi\nAl\nK\nCa\nFe\nTi\nFigure\u00a05. Number of optimal variables to filter.\n8 Vol:.(1234567890) Scientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\nCARS-XGBoost models were established respectively, and the process of model establishment was carried out according to Ref.36. The prediction effect of the established model was evaluated. The modeling effects of each model are shown in Fig.\u00a07. In the quantitative model of Si, The R2 of LAR-XGBoost was the smallest, at 0.75, corresponding to the RMSECV value of 5.67%. The results of CARS-XGBoost and LAR-CARS-XGBoost were similar, where the RMSECV of CARS-XGBoost and LAR-CARS-XGBoost were 3.281% and 3.491%, respectively. The RPD values of the two models were 3.08 and 2.91. The two models achieved better prediction effect. It was worth noting that although MC-UVE screened a large number of feature wavelengths, up to 17,689, the prediction effect was improved compared with SPA, which was similar to what was reported in literature31. In the quantitative models of Al, the differences among the five models were not large, with R2 ranging from 0.811 to 0.871 and RMSECV ranging from 1.721 to 2.069%, with a range of 0.348%. The best model was CARS-XGBoost with R2 of 0.870 and RPD of 2.608.\nIn the quantitative model of K, SPA-XGBoost performed poorly, with R2 of 0.663. The prediction effects of the other four models were relatively close, with R2 range of 0.806\u20130.815. The best-performing model was LARCARS with an RMSECV of 0.334, which was 37% lower than the RMSECV 0.532 of the highest SPA-XGBoost model. Among the Ca quantitative models, the worst model was LAR-XGBoost, with R2 of 0.689 and RPD of 1.615. The prediction performance of the other four models was relatively close, with R2 ranging from 0.857 to 0.880. The best performing model was SPA-XGBoost with an RPD of 2.493, while the LAR-CARS was close to SPA-XGBoost with an RPD of 2.419. Among the quantitative models of Fe, the LAR-XGBoost model had the worst performance, with R2 of 0.674 and RMSECV of 2.166%. The other four models had similar prediction performance, with R2 ranging from 0.829 to 0.881. The model with the best performance was LAR-CARSXGBoost and RPD was 2.599. Among the prediction models of Ti, the LAR-XGBoost model had poor prediction performance, with RPD of 1.553 and R2 of 0.679. The best performance model was LAR-CARS-XGBoost with RPD of 1.985 and RMSECV of 0.188%, which showed a significant improvement in performance compared with the other four models. In conclusion, the prediction effect of LAR-XGBoost was always poor in the six element prediction models, while the prediction effect of LAR-CARS and CARS was generally good.\nEffect evaluation of independent prediction sets. XGBoost modeling was carried out according to the independent prediction set, and LAR, SPA, MC-UVE, CARS and LAR-CARS models were established for Si, Al, K, Ca, Fe and Ti, respectively. The prediction results are shown in Fig.\u00a08. Among the Si prediction models, SPA-XGBoost had the worst prediction, with R2 of 0.635 and RMSEP of 6.903%. The CARS-XGBoost model had the best effect, with R2 of 0.874 and RPD of 3.930. LAR-CARS-XGBoost also performed well, with R2 of 0.838 and RMSEP of 4.324%. In the prediction model for Al, LAR performed worst, with R2 of 0.843 and\n0\n4 0\n0\n8 0\n0\n1 2\n0 0\n1 6\n0 0\n2 0\n0 0\n0\n400\n800\n1200\n1600\n2000\nThe channel of XRF\nT h\ne ch\nan n\nel o\nf N\nIR\na.\n0\n4 0\n0\n8 0\n0\n1 2\n0 0\n1 6\n0 0\n2 0\n0 0\n0\n400\n800\n1200\n1600\n2000\nThe channel of XRF\nT h\ne ch\nan n\nel o\nf N\nIR\nb.\n0\n4 0\n0\n8 0\n0\n1 2\n0 0\n1 6\n0 0\n2 0\n0 0\n0\n400\n800\n1200\n1600\n2000\nThe channel of XRF\nT h\ne ch\nan n\nel o\nf N\nIR\nc.\n0\n4 0\n0\n8 0\n0\n1 2\n0 0\n1 6\n0 0\n2 0\n0 0\n0\n400\n800\n1200\n1600\n2000\nThe channel of XRF\nT h\ne ch\nan n\nel o\nf N\nIR\nd.\n0\n4 0\n0\n8 0\n0\n1 2\n0 0\n1 6\n0 0\n2 0\n0 0\n0\n400\n800\n1200\n1600\n2000\nThe channel of XRF\nT h\ne ch\nan n\nel o\nf N\nIR\ne.\nFigure\u00a06. The feature selection of Ca OPA spectral distribution, (a) LAR, (b) SPA, (c) MC-UVE, (d) CARS, (e) LAR-CARS.\n9 Vol.:(0123456789) Scientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\nRMSEP of 2.005%. The best performance was CARS-XGBoost with R2 of 0.931 and RMSEP of 1.316%. The LAR-CARS-XGBoost also had good performed, with R2 of 0.910 and RPD of 2.960. In the K prediction model, the performance of models was relatively balanced, the range of R2 was 0.737\u20130.842, and the range of RPD was 1.921\u20132.372. The best performing model was LAR-CARS-XGBoost, with R2 of 0.842, RPD of 2.372 and RMSEP of 0.338%. In the Ca prediction model, LAR-XGBoost had poor prediction performance, with R2 of 0.741. The best model was LAR-CARS-XGBoost, with R2 of 0.890 and RPD of 2.497. Among the Fe prediction models, LAR\u2019s prediction ability was poor, with R2 of 0.680. SPA, MC-UVE, CARS, and LAR-CARS showed similar performance. The R2 of the four models ranged from 0.855 to 0.898, and the RPD range was 2.282 to 2.523. In the prediction model of Ti, LAR-CARS-XGBoost had the best performance, with R2 of 0.871 and RPD of 2.583.\nIt can be seen from the above results that the feature variables screened by LAR have poor performance, while CARS and LAR-CARS screen fewer feature variables, and the established model had better stability and prediction performance. CARS had the best performance in Si and Al, and LAR-CARS had the best performance in K, Ca, Fe and Ti.\nThe application of core in\u2011situ inorganic analysis. The purpose of this study is to develop a data fusion technique that can be applied to in-situ core detection. Therefore, the CARS-XGBoost and the LARCARS-XGBoost were specifically applied to a fresh core detection. At the same time, this section of core was placed in ITRAX Core scanner for scanning analysis. Before scanning, the core scanner was corrected with the sample results of wavelength dispersive X-ray fluorescence spectrometer to ensure the consistency of the scanning results of the two instruments. The sampling interval of the instrument on the core was 1\u00a0cm, and other parameters were set by referring to literature to obtain oxide content results, which were converted into element content, and the detection results were shown in Fig.\u00a09. Statistical parameters are shown in Table\u00a03.\nAccording to the detection results, in the Si model, CARS and LAR-CARS had good predictive performance. In the Al model, LAR-CARS had best predictive performance. In the K model, the prediction performance of CARS and LAR-CARS was very similar, and there was almost no difference between the two models. In the model of Ca, LAR-CARS had best prediction performance. In the model of Fe, CARS and LAR-CARS had similar prediction performance. In the model of Ti, LAR-CARS had best prediction performance.\nThe results of in-situ core detection show that the algorithm model of LAR-CARS was generally good. In K and Fe prediction models, CARS and LAR-CARS had similar prediction performance. The RPD of K was only 1.352\u20131.486. The prediction accuracy was relatively poor among all models, which may be due to the fact that there were few types of inorganic and organic matter related to K and their occurrence in China was relatively small, which was similar to the report37. In minerals. Si had a good prediction effect, and the RPD of the two\n0.754 0.820\n0.886 0.906 0.900\n0.811 0.856 0.871 0.870 0.871\n0.809\n0.663\n0.790 0.806 0.815\n0.689\n0.878 0.857 0.866 0.880\n0.674\n0.855 0.829 0.867 0.881\n0.679 0.704 0.728 0.716\n0.829\nLAR SPA MC-UVE CARS LAR-CARS 0\n2\n4\n6\nR M\nS E\nC V\n/%\nRMSECV\na. Si\n2.0\n2.5\n3.0\nRPD RPD\nRPDRPD\nRPDRPD\nR P\nD\nLAR SPA MC-UVE CARS LAR-CARS 0\n1\n2\nb. Al\nR M\nS E\nC V\n/%\nRMSECV\n2.2\n2.4\n2.6\nR P\nD\nLAR SPA MC-UVE CARS LAR-CARS 0.0\n0.2\n0.4\n0.6\nc. K\nR M\nS E\nC V\n/%\nRMSECV\n1.6\n2.0\n2.4\nR P\nD\nLAR SPA MC-UVE CARS LAR-CARS 0.0\n0.5\n1.0\n1.5\n2.0\nR M\nS E\nC V\n/%\nRMSECV\n1.5\n2.0\n2.5\nd. Ca\nR P\nD\nLAR SPA MC-UVE CARS LAR-CARS 0\n1\n2\ne. Fe\nR M\nS E\nC V\n/%\nRMSECV\n1.6\n2.0\n2.4\nR P\nD\nLAR SPA MC-UVE CARS LAR-CARS 0.0\n0.1\n0.2\nR M\nS E\nC V\n/%\nRMSECV\n1.2\n1.6\n2.0\nf. Ti\nR P\nD\nFigure\u00a07. XGBoost modeling results of LOOCV set, (a) Si, (b) Al, (c) K, (d) Ca, (e) Fe, (f) Ti. *The bar chart is labeled R2 for this model.\n10\nVol:.(1234567890)\nScientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\n0.775\n0.635\n0.837 0.874 0.838\n0.843 0.918 0.906\n0.931 0.910\n0.799 0.737 0.795 0.822 0.842\n0.741\n0.862 0.896 0.894 0.890\n0.680\n0.885 0.889 0.855 0.898\n0.752 0.821\n0.777 0.773\n0.871\nLAR SPA MC-UVE CARS LAR-CARS 0\n2\n4\n6\n8\nR M\nS E\nP /%\nRMSEP\na. Si\n1.5\n2.0\n2.5\n3.0\nRPD RPD\nRPDRPD\nRPDRPD\nR P\nD\nLAR SPA MC-UVE CARS LAR-CARS 0\n1\n2\nb. Al\nR M\nS E\nP /%\nRMSEP\n2.5\n3.0\n3.5\nR P\nD\nLAR SPA MC-UVE CARS LAR-CARS 0.0\n0.2\n0.4\n0.6 c. K\nR M\nS E\nP /%\nRMSEP\n1.8\n2.0\n2.2\n2.4\nR P\nD\nLAR SPA MC-UVE CARS LAR-CARS 0.0\n0.5\n1.0\n1.5\n2.0\nR M\nS E\nP /%\nRMSEP\n1.5\n2.0\n2.5\nd. Ca\nR P\nD\nLAR SPA MC-UVE CARS LAR-CARS 0\n1\n2\ne. Fe\nR M\nS E\nP /%\nRMSEP\n1.6\n2.0\n2.4\nR P\nD\nLAR SPA MC-UVE CARS LAR-CARS 0.0\n0.1\n0.2\n0.3\n0.4\nR M\nS E\nP /%\nRMSEP\n2.0\n2.4\nf. Ti\nR P\nD\nFigure\u00a08. XGBoost modeling effect of validation set, (a) Si, (b) Al, (c) K, (d) Ca, (e) Fe, (f) Ti. *The bar chart is labeled R2 for this model.\n118.200\n118.900\n118.800\n118.700\n118.600\n118.500\n118.400\n118.300\n0 40 0 25 0 4 0 15 0 10 0.00 2.75 Si/% Al/% K/% Ca/% Fe/%\nLAR-CARS\nCARS\nMetal\nTi/%\nFigure\u00a09. The effect of in-situ core detection.\n11\nVol.:(0123456789)\nScientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\nalgorithm models was 2.031 and 2.392, indicating that the screened characteristic variables had a good sensitivity to Si and a high linearity. In particular, it should be noted that Fe also has a good prediction effect, with RPD of 2.234 and 2.426, which may be because Fe oxides such as Fe3O4 and Fe2O3 have obvious characteristic peaks in the visNIR spectral region. The detection accuracy of Fe-containing minerals by visNIR spectroscopy was generally good, which was similar to that reported in Ref.38. The results of this study show that LAR-CARS can improve the quantitative analysis of rock forming elements by screening characteristic variables of XRF and visNIR OPA, and provide necessary technical support for digital exploration."
        },
        {
            "heading": "Conclusion",
            "text": "In this paper, the combination of LAR and CARS algorithm is used to establish the wavelength variable screening algorithm, which is applied to the quantitative analysis of rock forming elements in coal seam cores. By comparing the quantitative results of coal core drilling elements with five commonly used algorithms LAR, SPA, MCUVE, CARS and LAR-CARS, the influence of characteristic variable selection algorithm on quantitative analysis of XRF and visNIR by OPA was evaluated. The results showed that LAR-CARS screened fewer variables. After the analysis of the selected variables, the characteristic variables screened by CARS and LAR-CARS were statistically related to the measured elements. In XRF detection, the absorption enhancement effect between elements will affect the linear relationship between element content and characteristic peak intensity, so the traditional XRF internal standard method is not accurate for core detection with complex matrix effect and various elements, which affects the analysis of key areas in exploration. In visNIR spectral detection, although elements do not directly have characteristic peaks in the spectral range, organic compounds, hematite and pyrite in the core all have obvious characteristic peaks in the visNIR spectral range, and these substances have a statistical relationship with element content. Therefore, the feature variable screening algorithm will select more feature peaks, and too many feature summits will affect the stability of the model. Through the comparison of the number of characteristic variables, it is found that it is of practical significance to select the spectra using LAR first and then CARS.\nIn this study, two drilling three-section discontinuous cores were selected as the research object, one of which was selected as LOOCV set and the other as independent validation set. The prediction results of LOOCV set showed that the LAR-CARS had a good stability in the detection of six rock forming elements (Si, Al, K, Ca, Fe and Ti). The validation set effect showed that the models established by CARS and LAR-CARS can be well applied to the validation set. The RPD of other models (LAR, SPA, MC-UVE) was over 1.4, indicating that these models had certain predictive performance. Among them, the prediction ability of LAR was poor, which was related to the large number of feature variables screened by LAR. High dimensional matrix will reduce the generalization ability of quantitative model. Too many characteristic variables have multicollinearity, which affects the accuracy of quantification.\nThe ultimate goal of this study is to develop a portable technique for in-situ detection that can facilitate detailed scanning of key exploration areas. Therefore, CARS and LAR-CARS models with good performance were used to test a section of core separately, and the results were compared with the ITRAX Core scanner instrument commonly used in the core scanning industry. The results showed that RMSEP of CARS and LAR-CARS models were small, and the RPD ranged from 1.424 to 2.514. All these results showed that the high-dimensional matrix formed by XRF and visNIR integration combined with LAR-CARS can be used for quantitative analysis of rock-forming elements in in-situ coal seam cores, and the analysis results can be used as the basis for judging lithology. The research will provide necessary technical support for digital mine construction."
        },
        {
            "heading": "Data availability",
            "text": "The data used to support the findings of this study are available from the corresponding author upon request.\nReceived: 28 July 2022; Accepted: 23 December 2022"
        },
        {
            "heading": "Acknowledgements",
            "text": "This work was financially supported by the Nuclear Technology Application Engineering Research Center Open Foundation of Ministry of Education (No. HJSJYB2018-5), the Jiangxi Provincial Natural Science Foundation (Grant No. 20202BABL214021), Education Department of Jiangxi Province (Grant No. GJJ200719), Jiangxi\n13\nVol.:(0123456789)\nScientific Reports | (2022) 12:22365 | https://doi.org/10.1038/s41598-022-27037-6\nProvincial Post-doctoral Foundation (Grant No. 2020KY43), Open Fund of Key Laboratory for Digital Land and Resources of Jiangxi Province, East China University of Technology (DLLJ202006)."
        },
        {
            "heading": "Author contributions",
            "text": "L.Z. leaded the method application, experiment conduction and the result analysis. W.G. participated in the data extraction and preprocessing. T.S., F.Q., W.G. and Q.W. participated in the manuscript revision, and provided theoretical guidance and the revision of this paper. All authors read and approved the final manuscript."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Correspondence and requests for materials should be addressed to W.G.\nReprints and permissions information is available at www.nature.com/reprints.\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or\nformat, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http:// creat iveco mmons. org/ licen ses/ by/4. 0/.\n\u00a9 The Author(s) 2022"
        }
    ],
    "title": "Coal seam in\u2010situ inorganic analysis based on least angle regression and competitive adaptive reweighted sampling algorithm by XRF\u2013visNIR fusion",
    "year": 2022
}