{
    "abstractText": "In this work, we study a group of N homogeneous vehicles travelling on a ring road by describing the collective vehicle dynamics via the so-called Optimal Velocity Model (OVM). We analyze the stability of the equilibrium motion regime in which all vehicles drive at the same speed and keep the same headway. First, stability is studied through linearization, thereby highlighting the roles of the model parameters. Next, we tackle the full nonlinear model and we determine ellipsoidal estimates of the equilibrium\u2019s region of attraction by defining and solving suitable Linear Matrix Inequalities (LMIs). Finally, safety aspects are discussed, incorporated in our LMI formulation as lower bounds of the inter-vehicle distances, and illustrated via simulations.",
    "authors": [
        {
            "affiliations": [],
            "name": "Cristina Magnetti Gisolo"
        },
        {
            "affiliations": [],
            "name": "Maria Laura Delle Monache"
        },
        {
            "affiliations": [],
            "name": "Francesco Ferrante"
        },
        {
            "affiliations": [],
            "name": "Paolo Frasca"
        }
    ],
    "id": "SP:d97b573f4ca2cc6fb0803b0f67953d82483c2e0c",
    "references": [
        {
            "authors": [
                "Y. Sugiyama",
                "M. Fukui",
                "M. Kikuchi",
                "K. Hasebe",
                "A. Nakayama",
                "K. Nishinari",
                "S. ichi Tadaki",
                "S. Yukawa"
            ],
            "title": "Traffic jams without bottlenecks\u2014experimental evidence for the physical mechanism of the formation of a jam",
            "venue": "New Journal of Physics, vol. 10, no. 3, p. 033001, 2008.",
            "year": 2008
        },
        {
            "authors": [
                "R.E. Stern",
                "S. Cui",
                "M.L. Delle Monache",
                "R. Bhadani",
                "M. Bunting",
                "M. Churchill",
                "N. Hamilton",
                "R. Haulcy",
                "H. Pohlmann",
                "F. Wu",
                "B. Piccoli",
                "B. Seibold",
                "J. Sprinkle",
                "D.B. Work"
            ],
            "title": "Dissipation of stop-and-go waves via control of autonomous vehicles: Field experiments",
            "venue": "Transportation Research Part C: Emerging Technologies, vol. 89, pp. 205\u2013 221, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "I. Gasser",
                "G. Sirito",
                "B. Werner"
            ],
            "title": "Bifurcation analysis of a class of \u2018car following\u2019 traffic models",
            "venue": "Physica D: Nonlinear Phenomena, vol. 197, no. 3, pp. 222\u2013241, 2004.",
            "year": 2004
        },
        {
            "authors": [
                "S. Feng",
                "Y. Zhang",
                "S.E. Li",
                "Z. Cao",
                "H.X. Liu",
                "L. Li"
            ],
            "title": "String stability for vehicular platoon control: Definitions and analysis methods",
            "venue": "Annual Reviews in Control, vol. 47, pp. 81\u201397, 2019. 8",
            "year": 2019
        },
        {
            "authors": [
                "R. Merco",
                "F. Ferrante",
                "P. Pisu"
            ],
            "title": "A hybrid controller for DoSresilient string-stable vehicle platoons",
            "venue": "IEEE Transactions on Intelligent Transportation Systems, vol. 22, no. 3, pp. 1697\u20131707, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "C. Wu",
                "A.M. Bayen",
                "A. Mehta"
            ],
            "title": "Stabilizing traffic with autonomous vehicles",
            "venue": "2018 IEEE International Conference on Robotics and Automation (ICRA), pp. 6012\u20136018, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "V. Giammarino",
                "S. Baldi",
                "P. Frasca",
                "M.L. Delle Monache"
            ],
            "title": "Traffic flow on a ring with a single autonomous vehicle: An interconnected stability perspective",
            "venue": "IEEE Transactions on Intelligent Transportation Systems, vol. 22, no. 8, pp. 4998\u20135008, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "Y. Zheng",
                "J. Wang",
                "K. Li"
            ],
            "title": "Smoothing traffic flow via control of autonomous vehicles",
            "venue": "IEEE Internet of Things Journal, vol. 7, no. 5, pp. 3882\u20133896, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "J. Wang",
                "Y. Zheng",
                "Q. Xu",
                "J. Wang",
                "K. Li"
            ],
            "title": "Controllability analysis and optimal controller synthesis of mixed traffic systems",
            "venue": "2019 IEEE Intelligent Vehicles Symposium (IV), pp. 1041\u20131047, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "M.L. Delle Monache",
                "T. Liard",
                "A. Rat",
                "R. Stern",
                "R. Bhadani",
                "B. Seibold",
                "J. Sprinkle",
                "D.B. Work",
                "B. Piccoli"
            ],
            "title": "Feedback Control Algorithms for the Dissipation of Traffic Waves with Autonomous Vehicles",
            "year": 2019
        },
        {
            "authors": [
                "G. Orosz",
                "G. St\u00e9p\u00e1n"
            ],
            "title": "Subcritical Hopf bifurcations in a carfollowing model with reaction-time delay",
            "venue": "Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences, vol. 462, no. 2073, pp. 2643\u20132670, 2006.",
            "year": 2006
        },
        {
            "authors": [
                "S.S. Avedisov",
                "G. Orosz"
            ],
            "title": "Nonlinear network modes in cyclic systems with applications to connected vehicles",
            "venue": "Journal of Nonlinear Science, vol. 25, no. 4, pp. 1015\u20131049, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "M. Bando",
                "K. Hasebe",
                "A. Nakayama",
                "A. Shibata",
                "Y. Sugiyama"
            ],
            "title": "Dynamical model of traffic congestion and numerical simulation",
            "venue": "Phys. Rev. E, vol. 51, pp. 1035\u20131042, Feb 1995.",
            "year": 1995
        },
        {
            "authors": [
                "H. Yin",
                "P. Seiler",
                "M. Arcak"
            ],
            "title": "Stability analysis using quadratic constraints for systems with neural network controllers",
            "venue": "IEEE Transactions on Automatic Control, vol. 67, no. 4, pp. 1980\u20131987, 2022.",
            "year": 1980
        }
    ],
    "sections": [
        {
            "text": "I. INTRODUCTION"
        },
        {
            "heading": "A. Background",
            "text": "Vehicular transportation is undergoing a major disruption, moving from vehicles in which the humans are completely responsible of all the driving tasks towards fully automated vehicles in which automation will be responsible of most (if not all) driving tasks. Furthermore, several experiments have shown that we can harvest the potential of automation towards traffic control and even a small number of automated vehicles can be effective in controlling traffic under specific circumstances. A seminal experiment featuring a group of vehicles on a ring road has been performed by Sugiyama et al. [1]. The ring road, in this case, is a representation of a road of infinite length that allows to observe in a controlled environment the phenomenon of the stop-and-go waves. More recent experiments in [2] show that stop-and-go waves produced by a group of human-driven vehicles on a ring road can be controlled by a small number of autonomous vehicles (AVs).\nTraffic control through AVs aims to avoid large oscillations of the speed, sudden braking and acceleration, dissipate stopand-go waves and make traffic flow more fluid. In particular,\nC. Magnetti Gisolo was a student at Politecnico di Torino, Turin, Italy and a research intern at GIPSA-lab, Grenoble, France.\nM. L. Delle Monache is with the Department of Civil and Environmental Engineering at the University of California, Berkeley; email: mldellemonache@berkeley.edu. This work was partially done while she was with Univ. Grenoble Alpes, Inria, CNRS, Grenoble INP, GIPSA-lab, 38000 Grenoble, France.\nFrancesco Ferrante is with Department of Engineering, University of Perugia, Via G. Duranti, 67, 06125 Perugia, Italy, email: francesco.ferrante@unipg.it\nP. Frasca are with Univ. Grenoble Alpes, CNRS, Inria, Grenoble INP, GIPSA-lab, 38000 Grenoble, France.\nThis work has been partly supported by ANR via grant HANDY, number ANR-18-CE40-0010.\nthe objective of the control strategy is to make the group reach an equilibrium state, called uniform flow equilibrium, in which all vehicles travel at the same velocity and have the same headway. Despite the effectiveness of the use of AVs in traffic control, it is not clear by which mechanism their interconnection with human-driven vehicles stabilizes traffic: hence the need for advancing the study of the stability of traffic flows. In this perspective of control, in this work we analyze the stability of the uniform flow equilibrium in a specific mathematical description of traffic flow: the Optimal Velocity Model (OVM). Other models have also been proposed and studied in the literature; see, e.g., [3].\nSeveral papers have looked at stability and string stability to explain the stability of multi-vehicle platoons; see, e.g., [4], [5]. In [6], the authors look at the linearized OVM and derive a linear string stability approach to the problem: this approach has been supplemented in [7] with specific string stability condition for ring roads. Indeed, most analytic studies on the topic of mixed traffic rely on the linearization of the nonlinear dynamics around the equilibrium flow [8], [9], [10]. Relevant exceptions include [11] and [12], where nonlinear approaches based on bifurcation theory are proposed to evaluate the role of delays and the impact of connected cruise control on connected vehicle system."
        },
        {
            "heading": "B. Contributions",
            "text": "In this paper, we try to overcome this simplification by moving from classical linear stability analysis to the study of the nonlinear dynamics and stability. Before the nonlinear analysis, we start by linearizing the nonlinear model around the uniform flow equilibrium and studying its stability through eigenvalue analysis. However, the linearization limits the study of stability to a local neighborhood of the equilibrium, preventing to derive any conclusion on the trajectories of the original nonlinear model when they are sufficiently far from the equilibrium point. For this reason, in the second part of this paper, we study stability by focusing on the nonlinear model and trying to identify its region of attraction through ellipsoidal estimates. By this method, we are able to determine a region of the state space from which the trajectories of the nonlinear model are guaranteed to converge to the equilibrium point. This method is computationally convenient because it is based on solving suitable Linear Matrix Inequalities (LMIs). Furthermore, safety constraints can be effectively incorporated in the analysis, thereby defining \u201csafe\u201d ellipsoidal regions of\n2 attraction. The ability to compute safe invariant regions for the full nonlinear model is a key advantage of our approach for practical applications."
        },
        {
            "heading": "C. Outline",
            "text": "The article is organized as follows. In Section II we introduce the OVM model on a ring. Section III studies the stability of the model after linearization and how stability depends on the model parameters. Next, we move on to the nonlinear analysis of the model in Section IV by defining and computing regions of attraction. Section V builds on these methods and computes safety regions for the trajectories of the models to avoid collisions. Section VI concludes the article."
        },
        {
            "heading": "II. OPTIMAL VELOCITY MODEL ON A RING",
            "text": "The Optimal Velocity Model of N vehicles introduced by Bando et al. in [13] is described by:{\nx\u0307i = vi v\u0307i = b [Vopt (xi+1 \u2212 xi)\u2212 vi] , \u2200 i = 1, . . . , N, (1)\nwhere b is a constant representing the sensitivity of the driver, xi and vi are the absolute position and velocity of the center of mass of the i-th vehicle and \u2206xi = xi+1 \u2212 xi is the headway with respect to the preceding vehicle i + 1. Suppose the N vehicles drive on a ring road of length L, then N + 1 = 1. The optimal velocity function is:\nVopt(\u2206xi) = Vmax tanh (\u2206xi \u2212 lv \u2212 ds) + tanh (lv + ds)\n1 + tanh (lv + ds) ,\nwhere Vmax is the maximum speed, lv is the vehicle length and ds is the safe distance between vehicles i and i+ 1. We are interested in a particular state, called speed equilibrium, in which the vehicles of model (1) drive with the same constant velocity v\u2217. Since the velocity function depends only on the headway, at the speed equilibrium also the vehicle distances are the same and equal to \u2206x\u2217 = L/N . We refer to this particular state as uniform flow equilibrium, in which\nxi+1 \u2212 xi = \u2206x\u2217 = L\nN := d\nvi = v\u2217 = Vopt(d). (2)\nModel (1) is rewritten in a new set of state variables such that the uniform flow equilibrium coincides with the origin of the new model. The new state variables are the relative velocities yi of each couple of adjacent vehicles and the spacing errors zi with respect to the distance d = L/N at the uniform flow equilibrium. zi = xi+1 \u2212 xi \u2212 d = \u2206xi \u2212 d, yi = vi+1 \u2212 vi. In these state variables, model (1) turns into{\nz\u0307i = yi y\u0307i = b [ Vmax\ntanh(zi+1+d\u2212d0)\u2212tanh(zi+d\u2212d0) 1+tanh(d0)\n\u2212 yi ] (3)\nwhere d0 = lv + ds and, when i = N , i + 1 = 1. Therefore, the uniform flow equilibrium (2) corresponds to the origin, because zi = z\u2217 = \u2206x\u2217 \u2212 d = 0 and yi = y\u2217 = 0. Since the vehicles travel on a closed ring road, their relative distances\nmust satisfy N\u2211 i=1 \u2206xi = N\u2211 i=1 (zi + d) = L. Since L = Nd,\nthe sum of the spacing errors is equal to zero, which allows writing zN as a function of the other variables. The resulting Reduced Optimal Velocity Model is\nz\u0307i = yi, i = 1, . . . , N \u2212 1\ny\u0307i = bVmax tanh(zi+1+d\u2212d0)\u2212tanh(zi+d\u2212d0)\n1+tanh(d0) \u2212 byi,\n\u2200 i = 1, . . . , N \u2212 2\ny\u0307N\u22121 = bVmax\ntanh ( \u2212\nN\u22121\u2211 i=1 zi+d\u2212d0\n) \u2212tanh(zN\u22121+d\u2212d0)\n1+tanh(d0) \u2212 byN\u22121\ny\u0307N = bVmax\ntanh(z1+d\u2212d0)\u2212tanh ( \u2212\nN\u22121\u2211 i=1 zi+d\u2212d0 ) 1+tanh(d0)\n\u2212 byN (4)\nThe origin is an equilibrium point of model (4) and corresponds to the uniform flow equilibrium."
        },
        {
            "heading": "III. LINEAR ANALYSIS",
            "text": "With the objective of unveiling some structural properties of system (3), in this section we present some preliminary results based on a linear analysis around the zero equilibrium point. We therefore linearize the Reduced Optimal Velocity Model (4) around the origin, thereby obtaining\nz\u0307i = yi, \u2200 i = 1, . . . , N \u2212 1 y\u0307i = \u2212\u03b3zi + \u03b3zi+1 \u2212 byi, \u2200 i = 1, ..., N \u2212 2\ny\u0307N\u22121 = \u2212\u03b3 N\u22122\u2211 j=1 zj \u2212 2\u03b3zN\u22121 \u2212 byN\u22121\ny\u0307N = 2\u03b3z1 + \u03b3 N\u22122\u2211 j=1 zj \u2212 byN\n, (5)\nwhere \u03b3 = b\u2202Vopt(d)\u2202zi = bVmax sech2(d\u2212 d0) 1 + tanh(d0) . Using the state vector\n\u03c7\u0303 = [z1, z2, ..., zN\u22121, y1, y2, ..., yN ] T \u2208 R2N\u22121, (6)\nwe obtain \u02d9\u0303\u03c7 = J\u0303 \u03c7\u0303, where\nJ\u0303 = [ 0 J\u0303zy J\u0303yz \u2212bIN ] ,\nJ\u0303yz = bVmax sech 2(d\u2212 d0) 1 + tanh(d0)  \u22121 1 (0)\n. . . . . . (0) \u22121 1 \u22121 . . . \u22121 \u22122 2 1 . . . 1\n \u2208 RN\u00d7N\u22121,\nJ\u0303zy =  1 (0) 0 1 ... . . . ...\n(0) 1 0  \u2208 RN\u22121\u00d7N . Its stability properties are stated in the following result,\nwhich is a corollary of recent stability results by [7].\n3 Theorem 1. The most critical eigenvalue \u03bb\u2217 of the linearized reduced model (5) around the uniform flow equilibrium has real part\n\u211c(\u03bb\u2217) = \u2212 b 2 + 1 2 (\u221ab4 + 32\u03b32aN \u2212 8b2\u03b3aN + b2 \u2212 4\u03b3aN 2 ) 1 2 ,\nwhere aN = 1\u2212 cos( 2\u03c0N ) and \u03b3 = bVmax sech2(d\u2212 d0) 1 + tanh(d0) , and the uniform flow equilibrium is asymptotically stable if and only if the parameters satisfy the following constraint:\nVmax b sech2(d\u2212 d0) 1 + tanh(d0) < 1 1 + cos(2\u03c0N ) =: \u03baN . (7)\nProof. The characteristic polynomial of J\u0303 can be explicitly computed as:\ndet(J\u0303 \u2212 \u03bbI) = (\u03bb+ b) N\u22121\u220f k=1 (\u03bb2 + b\u03bb+ \u03b3 \u2212 \u03b3e 2k\u03c0j N ). (8)\nBy comparing this expression with the characteristic polynomial in [7, Appendix A], we can apply the necessary and sufficient stability conditions in [7, Theorem 1]. Specializing these conditions to our model, we obtain:\nVmax b sech2(d\u2212 d0) 1 + tanh(d0) < 1\n1 + cos( 2\u03c0(i\u22121)N ) , \u2200 i = 2, ..., N\nThe most restrictive constraint is obtained for i = 2, thereby leading to (7).\nThe stability of the equilibrium depends on the parameters. Considering the stability condition (7), the uniform flow equilibrium may become unstable when b decreases, Vmax increases or |d \u2212 d0| decreases. If we fix d0 = lv + ds and the number of vehicles, then the stability of the uniform flow equilibrium depends on the length L of the ring road. If ring road is too long (d \u226b d0), then the left-hand side term of (7) is very close to zero for any b and Vmax. Thus, the stability constraint is satisfied. Nevertheless, as |d \u2212 d0| increases, the most critical eigenvalue tends to the imaginary axis. In particular,\nlim |d\u2212d0|\u2192\u221e\n\u211c(\u03bb\u2217) = 0,\nso the uniform flow equilibrium is asymptotically stable, but the convergence of the trajectories towards it is slow.\nThe stability conditions also depend on the number of vehicles N . As N increases, the stability constraint (7) becomes more restrictive, so the set of the parameters for which the uniform flow equilibrium is asymptotically stable is smaller. However, since \u03baN \u2265 1/2, for any N there exists a set of parameters (b, Vmax, L, d0) such that asymptotic stability of the uniform flow equilibrium is ensured. Moreover, the size of the group of vehicles affects also \u211c(\u03bb\u2217). Assume to increase N and the length L of the ring road such that d = LN is constant. Then,\nlim N\u2192\u221e\n\u211c(\u03bb\u2217) = 0.\nThus, as the number of vehicles and the length of the ring increase, convergence of the trajectories to the uniform flow\n0 20 40 60 80 100\nt [s]\n0\n50\n100\n150\n200\nA b s o lu\nte p\no s it io\nn s x\ni [ m\n]\nFig. 1: Absolute positions xi of a group of N = 22 vehicles, with b = 10 s\u22121 and Vmax = 5 m/s.\nFig. 2: Absolute velocities vi of a group of N = 22 vehicles, with b = 10 s\u22121 and Vmax = 5 m/s.\nequilibrium gets slower. The effect of b, Vmax, d \u2212 d0, and N on the stability will be confirmed by the nonlinear analysis that is presented in the next section.\nIn order to illustrate the value of the above stability analysis, we simulate the Optimal Velocity Model on a ring road and show that when the linearization is not stable, the nonlinear OVM model produces stop-and-go-waves. To this purpose, we present two simulations of a group of N = 22 vehicles on a ring of length L = 220 m, where d0 = lv + ds = 10 m, with two different choices of b and Vmax.\nExample 1 (Asymptotically stable equilibrium). If b = 10 s\u22121 and Vmax = 5 m/s, then the stability condition (7) is satisfied. The trajectories of the model converge to the uniform flow equilibrium, as shown in Fig. 1 and Fig. 2.\nExample 2 (Unstable equilibrium). If b = 3 s\u22121 and Vmax = 15 m/s, the stability condition (7) is not satisfied and the uniform flow equilibrium is unstable. In simulation, the trajectories of (1) produce stop-and-go waves even if they start from the uniform flow equilibrium, as shown in Fig. 3 and Fig. 4."
        },
        {
            "heading": "IV. NONLINEAR ANALYSIS: REGIONS OF ATTRACTION",
            "text": "The analysis presented in Section III enables to outline some structural conditions to ensure local asymptotic stability of (3). However, the results in Section III are based on a linearized model and therefore only apply locally and do not provide any information on the region of attraction of the origin for\n4 0 20 40 60 80 100\nt [s]\n0\n50\n100\n150\n200\nA b s o lu\nte p\no s it io\nn s x\ni [ m\n]\nFig. 3: Absolute positions xi of a group of N = 22 vehicles, with b = 3 s\u22121 and Vmax = 15 m/s.\n0 20 40 60 80 100\nt [s]\n0\n5\n10\n15\nA b s o lu\nte v\ne lo\nc it ie\ns v\ni [m\n/s ]\nFig. 4: Absolute velocities vi of a group of N = 22 vehicles, with b = 3 s\u22121 and Vmax = 15 m/s.\nthe actual dynamics, which can potentially be quite small. In this sense, the results in Section III may be difficult to exploit in practice. To overcome this drawback, in this section we focus on the nonlinear system (4) and determine an ellipsoidal inner estimate of the region of attraction (ROA) of the origin, which is the region of attraction of the uniform flow for the nonlinear system (1). To this end, we rely on the results in [14] to encapsulate the nonlinearity tanh into a local sector bound. This method enables to devise sufficient conditions in terms of matrix inequalities that can be efficiently exploited to obtain ellipsoidal estimates of the ROA.\nSystem (4) can be rewritten as:\n\u02d9\u0303\u03c7 = A\u03c7\u0303+B tanh(K\u03c7\u0303+ d\u0304), (9)\nwhere \u03c7\u0303 is defined in (6), d\u0304 := (d \u2212 d0)1N , and A :=[ 0 Azy 0 \u2212bIN ] , with\nAzy :=  1 0 0 1 ... . . . ...\n0 1 0\n \u2208 RN\u22121\u00d7N\nB := [ 0N\u22121\u00d7N Byz ] \u2208 R2N\u22121\u00d7N\nwhere\nByz := bVmax\n1 + tanh(d0)  \u22121 1 (0) \u22121 1 . . . . . .\n(0) \u22121 1 1 0 . . . 0 \u22121\n \u2208 RN\u00d7N\nand K := [ Kyz 0N\u00d7N ] \u2208 RN\u00d72N\u22121, with\nKyz :=  1 (0) 1 . . .\n(0) 1 \u22121 . . . . . . \u22121  \u2208 RN\u00d7N\u22121. We compute an underestimate of the ROA of the origin of (4). In particular, notice that for all d, d0 \u2208 R, Bd\u0304 = 0, thereby confirming that \u03c7\u0303 = 0 is an equilibrium for (4). Similarly as in [14], we inscribe the nonlinearity tanh into a local sector bound by the following lemma [14, Lemma 1].\nLemma 1. Let \u03bd and \u03bd\u0304 be real numbers, \u03bd\u22c6 \u2208 [\u03bd, \u03bd], and\n\u03b1(\u03bd, \u03bd) := min\n{ tanh(\u03bd\u0304)\u2212 tanh(\u03bd\u2217)\n\u03bd\u0304 \u2212 \u03bd\u2217 , tanh(\u03bd\u2217)\u2212 tanh(\u03bd) \u03bd\u2217 \u2212 \u03bd } where \u03b1 < 1. Then, for all \u03bd \u2264 \u03bd \u2264 \u03bd\u0304, one has that tanh (\u03bd) lies within the local sector [\u03b1(\u03bd, \u03bd), 1] centered in (\u03bd\u2217, tanh(\u03bd\u2217)). Namely, for all \u03bd \u2208 [\u03bd, \u03bd\u0304]\n(\u2206y(\u03bd)\u2212 \u03b1(\u03bd, \u03bd)\u2206\u03bd)(\u2206\u03bd \u2212\u2206y(\u03bd)) \u2265 0, (10)\nwhere \u2206y(\u03bd) := tanh(\u03bd)\u2212 tanh(\u03bd\u2217) and \u2206\u03bd := \u03bd \u2212 \u03bd\u2217. \u25a1\nIn the remainder of the analysis, we take \u03bd\u2217 = d\u2212d0. In the particular case in which d = d0, it turns out that d\u0304 = 0, hence tanh is inscribed in a local sector centered in the origin.\nLemma 1 can be used to obtain a sector condition for the vector valued function tanh: RN \u2192 RN , this is due to the decentralized nature of such a function. In particular, let v, v \u2208 RN , a \u2208 RN , where for all i \u2208 {1, 2, . . . , N}, ai := \u03b1(vi, vi). Then, from Lemma 1, for all v \u2aaf v \u2aaf v, v \u2aaf v\u2217 \u2aaf v\n\u03b6(v, v\u2217) T\u03a8TM(\u03bb)\u03a8\u03b6(v, v\u2217) \u2265 0, (11)\nwhere\n\u03b6(v, v\u2217) :=\n[ v \u2212 v\u2217\ntanh(v)\u2212 tanh(v\u2217)\n] ,\u03a8 := [ IN \u2212IN\n\u2212 diag(a) IN\n] ,\nM(\u03bb) := [ 0N\u00d7N diag(\u03bb) diag(\u03bb) 0N\u00d7N ] , \u03bb \u2208 RN\u22650.\nCondition (11) is used to state the following result, which is a continuous-time version of [14, Theorem 1].\nTheorem 2 (LMIs & Regions Of Attraction). Consider system (9). Let v\u2217 = d\u0304, v \u2ab0 v\u2217, and v = 2v\u2217\u2212 v\u0304. Define the following matrices:\nR :=\n[ In 0n\u00d7N\n0N\u00d7n IN\n] , Q := [ K 0N\u00d7N\n0N\u00d7n IN\n] ,\nwhere n := 2N\u22121. If there exist a symmetric positive definite matrix P \u2208 Rn\u00d7n and a vector \u03bb \u2208 RN\u22650 such that\nRT [ ATP \u2212 PA PB\nBTP 0\n] R+QT\u03a8TM(\u03bb)\u03a8Q < 0 (12)\n5 [\n(v\u0304(i) \u2212 v\u2217(i))2 K(i)\nKT(i) P\n] \u2265 0, i = 1, . . . , N, (13)\nwhere K(i) is the i-th line of K, KT(i) is its transpose, v\u2217(i) and v\u0304(i) are the i-th elements of v\u2217 and v\u0304 respectively. Then\nE(P ) := {\u03c7\u0303 \u2208 Rn : \u03c7\u0303TP\u03c7\u0303 \u2264 1}\nis forward invariant and included in the ROA of the origin of system (9).\nProof. The satisfaction of (13) guarantees that\nE(P ) \u2286 {\u03c7\u0303 \u2208 Rn : v \u2212 v\u2217 \u227c K\u03c7\u0303 \u227c v\u0304 \u2212 v\u2217},\nIn particular, for all \u03c7\u0303 \u2208 E(P ), (11) holds. Let us consider the following quadratic Lyapunov function candidate V (\u03c7\u0303) := \u03c7\u0303TP\u03c7\u0303. To prove the result, we show that for all \u03c7\u0303 \u2208 (E(P ) \\ {0})\nV\u0307 (\u03c7\u0303) = \u02d9\u0303\u03c7TP\u03c7\u0303+ \u03c7\u0303TP \u02d9\u0303\u03c7 < 0. (14)\nThe latter can be written in the following matrix form:\nV\u0307 (\u03c7\u0303) = [ \u03c7\u0303T (u\u2212 u\u2217)T ] [ATP + PA PB BTP 0 ] [ \u03c7\u0303 u\u2212 u\u2217 ] .\n(15) where we use the shorthand notation u = tanh(K\u03c7\u0303+ d) and u\u2217 = tanh(d).\nBy pre-and-post multiplying the matrix in the lefthand side of (12) by [\u03c7\u0303T (u\u2212 u\u2217)T ] and its transpose, one gets:\nW (\u03c7\u0303) := [ \u03c7\u0303T (u\u2212 u\u2217)T ] [ATP + PA PB BTP 0 ] [ \u03c7\u0303 u\u2212 u\u2217 ] + [ v \u2212 v\u2217 u\u2212 u\u2217 ]T \u03a8TM(\u03bb)\u03a8 [ v \u2212 v\u2217 u\u2212 u\u2217 ] .\nTherefore, by using (12) and (15), it follows that\nW (\u03c7\u0303) = V\u0307 (\u03c7\u0303) + [ v \u2212 v\u2217 u\u2212 u\u2217 ]T \u03a8TM(\u03bb)\u03a8 [ v \u2212 v\u2217 u\u2212 u\u2217 ] < 0.\nThe latter with (11) yields (14) and concludes the proof.\nTheorem 2 enables to obtain an ellipsoid that is an innerapproximation of the ROA of model (4). With the objective of reducing the conservatism in the estimation of the ROA, we embed the conditions of Theorem 2 into a suitable optimization problem aimed at maximizing the size of the ellipsoidal set E(P ). To this end, a possible approach consists of minimizing the trace of matrix P . Specifically, an optimal estimate of the ROA can be obtained by solving the following optimization problem:\nminimize trace(P ) subject to inequalities (12), (13).\n(16)\nWhen v\u0304 is fixed, conditions (12) (13) are linear matrix inequalities in the decision variables P and \u03bb. Therefore, (16) can be efficiently solved via off-the-shelf software, with the only caveat of selecting the vector v\u0304. Notice that since E(P ) is contained in the polyhedral set {\u03c7\u0303 \u2208 Rn : v \u2212 v\u2217 \u227c K\u03c7\u0303 \u227c v\u0304 \u2212 v\u2217}, the selection of the values of v\u0304 affects the size of the ellipsoidal estimate in several ways. In particular, the larger is v\u0304, the wider is the local sector and the volume of the ellipsoid. Nevertheless, increasing too much v\u0304 may lead\nto no feasible solutions for problem (16). For this reason, the choice of v\u0304 requires a trade-off between the quality of the approximation and the feasibility of the optimization problem. As in Example 3, given the model parameters, the best estimate is obtained with the maximum v\u0304 for which the optimization problem is feasible.\nExample 3 (Ellipsoidal ROA). We consider a platoon of N = 22 vehicles. Consider the same parameters of Example 1, where b = 10 s\u22121, Vmax = 5 m/s and d0 = 10 m. Thus, the stability constraint (7) is satisfied and the origin is an asymptotically stable equilibrium point for the model. Assume the length L of the ring road is such that d = LN equals d0 = lv + ds = 10 m, then v\u2217 = u\u2217 = 0. The maximum value of v\u0304(i) for which (16) is feasible is v\u0304(i) = 0.7089, \u2200 i = 1, 2, . . . , N. We compute the maximumvolume ellipsoid E(P ) \u2208 R43 and in Figure 5 are shown its intersections with (z1, z2) and (y1, y2) planes.\nThe parameters of the model affect the maximum value of v\u0304 for which (16) is feasible, so they ultimately affect the size of the maximum-volume ellipsoidal estimate. Moreover, the dependence on the parameters of the volume of the best approximation of the ROA of the nonlinear model (4) around the origin reflects the relationship between the parameters and the eigenvalues of the linearized model (5) around the origin.\nIf d \u2212 d0 \u0338= 0, then v\u2217, u\u2217 \u0338= 0 and the local sectors are not centered at the origin: in this case the choice of v\u0304 is limited to small values with respect to v\u2217 and the volume of the resulting ellipsoidal estimate is small. On the contrary, if d = d0 the local sectors are centered in the origin and we get the largest ellipsoidal estimate. Also the number of vehicles affects the size of the maximum-volume ellipsoidal estimate of the ROA. In particular, as N increases, the maximum value of v\u0304 for which the optimization problem (16) is feasible decreases, leading to ellipsoids with smaller volume. Finally, we analyze the dependence of the size of the ellipsoidal estimate of the ROA of the nonlinear model (4) around the origin on b and Vmax. We fix d = d0, compute the ellipsoidal estimates for different values of b and Vmax and see that reducing b and increasing Vmax lead to smaller maximum values of v\u0304(i) for which problem (16) is feasible and to smaller ellipsoidal estimates. Let us fix Vmax = 5 m/s, compute E(P ) for different values of b and project it on subspaces generated by bases of the state variables. In Table I are shown the ranges of the state variables belonging to E(P ) and the corresponding volumes. As expected, by increasing b, the volume of the ellipsoidal estimate of the ROA increases. The\n6 -0.6 -0.4 -0.2 0 0.2 0.4 0.6\nz 1 [m]\n-0.6\n-0.4\n-0.2\n0\n0.2\n0.4\n0.6\nz 2 [\nm ]\n-4 -2 0 2 4\ny 1 [m/s]\n-4\n-2\n0\n2\n4\ny 2 [\nm /s\n]\nFig. 5: Example 3 - Cross-sections of E(P ) (blue) in the (z1, z2) plane (left) and in the (y1, y2) plane (right), together with illustrative trajectories (whose starting points are marked by a star). The purple trajectory starts inside E(P ), remains inside by invariance and converges to the origin. Being E(P ) an underestimate of the ROA, there are trajectories (like the orange one) that converge to the origin even if they originate from outside the ellipsoid.\nTABLE II: Dependence of the ellipsoidal estimate on Vmax. Increasing Vmax, the levels v\u0304 decrease and the size of E(P ) decreases. b = 20 s\u22121 and d = d0.\nVmax\n[m\ns\n]\nVector v\u0304 Volume of E(P ) z1 and y1 \u2208 E(P )\nVmax = 5 v\u0304(i) = 0.8750 2.20\u00d7 1011 |z1| \u2264 0.8750 m |y1| \u2264 6.77 m/s\nVmax = 10 v\u0304(i) = 0.7171 2.13\u00d7 106 |z1| \u2264 0.7171 m |y1| \u2264 7.57 m/s Vmax = 15 v\u0304(i) = 0.5109 117.03 |z1| \u2264 0.5108 m |y1| \u2264 6.62 m/s\nellipsoids are inner-approximations, so we can\u2019t state whether tuning b actually makes the ROA enlarge, but a larger b allows to get to a wider set of initial conditions for which we are sure the trajectories of (4) converge to the uniform flow equilibrium. Finally, we compute the ellipsoidal estimates by solving (16) fixing b = 20 s\u22121 with different values of Vmax. The ellipsoids are projected on subspaces generated by bases of the state variables. In Table II are shown the ranges of the state variables belonging to E(P ) and the corresponding volumes. By increasing Vmax, the volume of the ellipsoidal estimates of the ROA decreases, meaning that the set of initial conditions, from which the trajectories of (4) converge to the uniform flow equilibrium, becomes smaller.\nV. INVARIANCE-BASED SAFETY ANALYSIS Besides the convergence of the trajectories of model (1) to the uniform flow equilibrium, we are interested in vehicle safety. To this goal, maintaining the inter-vehicle distances above a certain minimum value is beneficial in order to avoid collisions. Let us suppose that the minimum safe inter-vehicle distance would be dmin = 8m. In Fig. 6 are shown the relative distances of the time simulation of a group of 22 vehicles on a ring of length L = 220 m. The parameters of the model do not satisfy the stability condition and the vehicles do not keep the minimum distance dmin.\nThe method put in place in Section IV to determine invariant ellipsoidal sets is suitable to include safety constraints to\navoid accidents. To prevent the collision between two adjacent vehicles, we can impose a lower bound on their distance \u2206xi or, equivalently, on their spacing error zi = \u2206xi \u2212 d. Let us consider the following constraints on the minimum and the maximum inter-vehicle distances \u2206xi:\ndmin \u2264 \u2206xi \u2264 dmax, (17)\nwhere dmin is the safety distance and dmax is the maximum allowed inter-vehicle distance. Condition (17) can be obtained by imposing the following constraints on the spacing errors zi,\u2200 i = 1, . . . , N \u2212 1:\ndmin \u2212 d \u2264 zi \u2264 dmax \u2212 d, (18)\nwhere d = L/N . These constraints are encoded in a symmetric polytope defined as\nS(|Q|, \u03c1) := {\u03c7\u0303 \u2208 Rn : |Q\u03c7\u0303| \u2aaf \u03c1}, (19)\nwhere \u03c7\u0303 is the state vector (6), the safety ranges are defined in (18), where dmin\u2212d = \u2212(dmax\u2212d) to get a symmetric polytope, Q = [ IN\u22121 0N\u22121\u00d7N ] \u2208 RN\u22121\u00d72N\u22121, with IN\u22121 the\n7 identity matrix \u2208 RN\u22121\u00d7N\u22121, and \u03c1 = (dmax\u2212d)1 \u2208 RN\u22121. The objective is then to find the maximum-volume ellipsoidal estimate of the ROA for system (4) that lies inside the safety polytope S(|Q|, \u03c1). In this way, by starting the trajectories inside the resulting ellipsoid, not only the vehicles reach the uniform flow equilibrium, but they will travel at safe distance.\nIt is shown in [15, Appendix C.8.3] that the ellipsoid E(P ) = {\u03c7\u0303 \u2208 Rn : \u03c7\u0303TP\u03c7\u0303 \u2264 1} can be included in a symmetric polytope S(|Q|, \u03c1), with Q \u2208 Rm\u00d7n by enforcing the following inequality for each element of vector \u03c1:[\nP QT(i) Q(i) \u03c12(i)\n] \u2265 0, \u2200i \u2208 {1, 2, . . . ,m} (20)\nwhere QT(i) is the transpose of the i-th row of Q. To find an ellipsoid included into the intersection of the ROA and a safety symmetric polytope S(|Q|, \u03c1), one can include (20) in the set of constraints of the optimization problem (16). The resulting optimization problem is then\nminimize trace(P ) subject to inequalities (12), (13), (20).\n(21)\nBeing E(P ) an invariant and contractive set, if the trajectories of system (4) are initialized inside it, they remain within this set and converge to the origin. Therefore, the vehicles keep a minimum inter-vehicle distance dmin.\nIn the following example, we compute the maximumvolume ellipsoidal estimate of the ROA included in a safety polytope for the model (4). The estimate of the ROA provided by the solution of (16) is not safe, therefore, solving problem (21) provides a smaller ellipsoid that guarantees the safety of the trajectories.\nExample 4. Consider a group of N = 5 vehicles that travel on a ring of length L = 50 m. Assume the model parameters are b = 20 s\u22121, Vmax = 5 m/s and d0 = 10 m. The maximumvolume ellipsoidal estimate of the ROA is obtained for v\u0304(i) = 3.1308 and its cross-section in the (z1, z2) plane is shown in Fig. 7 in blue. Suppose to force the constraint on the vehicle distances,\n8 m \u2264 \u2206xi \u2264 12 m, (22)\nthen the ellipsoid should lie in a safety polytope S(|Q|, \u03c1) where \u03c1 = 2 m. Since our ellipsoidal estimate is not included in the polytope, we add (20) and find a smaller ellipsoid whose section on (z1, z2) is shown in Figure 7 in red. The trajectories that start inside this smaller ellipsoid converge to the origin and the vehicle distances satisfy the safety constraints (22)."
        },
        {
            "heading": "VI. CONCLUSION",
            "text": "The stability of the Optimal Velocity model has been investigated by completing the local linearization-based analysis with a more refined nonlinear analysis. Sufficient conditions based on LMIs have been proposed to determine ellipsoidal estimates of the region of attraction of the nonlinear model. The relationship between stability of the uniform flow equilibrium and the model parameters is first probed by the linearized model and then confirmed by the analysis in the nonlinear framework. In the linear model, some choices of the parameters may lead\nFig. 7: Example 4 - Cross-sections in the (z1, z2) plane of the maximum-volume estimate of the ROA (blue), the safety polytope S(|Q|, \u03c1) (pink), and the ellipsoidal estimate included in the safety polytope (red). The trajectories initialized inside the invariant safe ellipsoid (red) stay within it.\nto eigenvalues with positive real part and make the uniform flow an unstable equilibrium. In the nonlinear context, the same behaviour of the parameters leads to smaller ellipsoidal estimates of the region of attraction. The nonlinear analysis also brings a contribution regarding safety: the computation of invariant and contractive sets for the uniform flow equilibrium allows us to identify sets of initial conditions such that the trajectories of a group of N vehicles do not collide.\nA possible improvement of the nonlinear analysis is to use non-quadratic Lyapunov function and get polytopic estimates of the region of attraction instead of ellipsoids. The polytopic representation can potentially provide a clearer view of the set of initial conditions from which the trajectories converge to the equilibrium. Future work should also focus on the introduction of a control input on one of the vehicles in order to improve stability, enlarge the basin of attraction of the uniform flow equilibrium, and avoid instability and collisions. The presence of an input represents the action of an AV and the analysis would help to understand the interconnection between AVs and human-driven vehicles."
        }
    ],
    "title": "Nonlinear Analysis of Stability and Safety of Optimal Velocity Model Vehicle Groups on Ring Roads",
    "year": 2023
}