{
    "abstractText": "In the Noisy Intermediate Scale Quantum (NISQ) era, the dynamic nature of quantum systems causes noise sources to constantly vary over time. Transient errors from the dynamic NISQ noise landscape are challenging to comprehend and are especially detrimental to classes of applications that are iterative and/or long-running, and therefore their timely mitigation is important for quantum advantage in real-world applications. The most popular examples of iterative long-running quantum applications are variational quantum algorithms (VQAs). Iteratively, VQA\u2019s classical optimizer evaluates circuit candidates on an objective function and picks the best circuits towards achieving the application\u2019s target. Noise fluctuation can cause a significant transient impact on the objective function estimation of the VQA iterations\u2019 tuning candidates. This can severely affect VQA tuning and, by extension, its accuracy and convergence. This paper proposes QISMET: Quantum Iteration Skipping to Mitigate Error Transients, to navigate the dynamic noise landscape of VQAs. QISMET actively avoids instances of high fluctuating noise which are predicted to have a significant transient error impact on specific VQA iterations. To achieve this, QISMET estimates transient error in VQA iterations and designs a controller to keep the VQA tuning faithful to the transient-free scenario. By doing so, QISMET efficiently mitigates a large portion of the transient noise impact on VQAs and is able to improve the fidelity by 1.3x-3x over a traditional VQA baseline, with 1.6-2.4x improvement over alternative approaches, across different applications and machines.",
    "authors": [
        {
            "affiliations": [],
            "name": "Gokul Subramanian Ravi"
        },
        {
            "affiliations": [],
            "name": "Kaitlin Smith"
        },
        {
            "affiliations": [],
            "name": "Jonathan M. Baker"
        },
        {
            "affiliations": [],
            "name": "Tejas Kannan"
        },
        {
            "affiliations": [],
            "name": "Nathan Earnest"
        },
        {
            "affiliations": [],
            "name": "Ali Javadi-Abhari"
        },
        {
            "affiliations": [],
            "name": "Henry Hoffmann"
        },
        {
            "affiliations": [],
            "name": "Frederic T. Chong"
        }
    ],
    "id": "SP:d5c86092285ef307b1bffcdb4b631bd39ca6c81e",
    "references": [
        {
            "authors": [
                "Jacob Biamonte",
                "Peter Wittek",
                "Nicola Pancotti",
                "Patrick Rebentrost",
                "NathanWiebe",
                "Seth Lloyd"
            ],
            "title": "Quantum machine learning",
            "venue": "Nature 549,",
            "year": 2017
        },
        {
            "authors": [
                "M J Biercuk",
                "A C Doherty",
                "H Uys"
            ],
            "title": "2011",
            "venue": "Dynamical decoupling sequence construction as a filter-design problem. Journal of Physics B: Atomic, Molecular and Optical Physics 44, 15 ",
            "year": 2011
        },
        {
            "authors": [
                "Sergey Bravyi",
                "Sarah Sheldon",
                "Abhinav Kandala",
                "David C Mckay",
                "Jay M Gambetta"
            ],
            "title": "Mitigating measurement errors in multiqubit experiments",
            "venue": "Physical Review A 103,",
            "year": 2021
        },
        {
            "authors": [
                "JJ Burnett",
                "A Bengtsson",
                "M Scigliuzzo",
                "D Niepce",
                "M Kudra",
                "P Delsing",
                "J Bylander"
            ],
            "title": "2019",
            "venue": "Decoherence benchmarking of superconducting qubits. npj Quantum Inf. 5. ",
            "year": 2019
        },
        {
            "authors": [
                "Yongshan Ding",
                "Pranav Gokhale",
                "Sophia Fuhui Lin",
                "Richard Rines",
                "Thomas Propson",
                "Frederic T Chong"
            ],
            "title": "Systematic Crosstalk Mitigation for Superconducting Qubits via Frequency-Aware Compilation",
            "year": 2020
        },
        {
            "authors": [
                "Edward Farhi",
                "Jeffrey Goldstone",
                "Sam Gutmann"
            ],
            "title": "A Quantum Approximate Optimization Algorithm",
            "year": 2014
        },
        {
            "authors": [
                "JayMGambetta",
                "JerryMChow",
                "andMatthias Steffen"
            ],
            "title": "Building logical qubits in a superconducting quantum computing system",
            "venue": "npj Quantum Information",
            "year": 2017
        },
        {
            "authors": [
                "Tudor Giurgica-Tiron",
                "Yousef Hindy",
                "Ryan LaRose",
                "Andrea Mari",
                "William J Zeng"
            ],
            "title": "Digital zero noise extrapolation for quantum error mitigation",
            "venue": "IEEE International Conference on Quantum Computing and Engineering (QCE)",
            "year": 2020
        },
        {
            "authors": [
                "Pranav Gokhale",
                "Yongshan Ding",
                "Thomas Propson",
                "Christopher Winkler",
                "Nelson Leung",
                "Yunong Shi",
                "David I. Schuster",
                "Henry Hoffmann",
                "Frederic T. Chong"
            ],
            "title": "Partial Compilation of Variational Algorithms for Noisy Intermediate-Scale Quantum Machines",
            "venue": "Proceedings of the 52nd Annual IEEE/ACM International Symposium on Microarchitecture (Oct 2019)",
            "year": 2019
        },
        {
            "authors": [
                "E.L. Hahn"
            ],
            "title": "1950",
            "venue": "Spin Echoes. Phys. Rev. 80 ",
            "year": 1950
        },
        {
            "authors": [
                "Petar Jurcevic",
                "Ali Javadi-Abhari",
                "Lev S Bishop",
                "Isaac Lauer",
                "Daniela Borgorin",
                "Markus Brink",
                "LaurenCapelluto",
                "OktayGunluk",
                "Toshinari Itoko",
                "Naoki Kanazawa"
            ],
            "title": "Demonstration of quantum volume 64 on a superconducting quantum computing system",
            "venue": "Quantum Science and Technology",
            "year": 2021
        },
        {
            "authors": [
                "Abhinav Kandala",
                "Antonio Mezzacapo",
                "Kristan Temme",
                "Maika Takita",
                "Markus Brink",
                "Jerry M Chow",
                "Jay M Gambetta"
            ],
            "title": "Hardware-efficient variational quantum eigensolver for small molecules and quantum magnets",
            "venue": "Nature 549,",
            "year": 2017
        },
        {
            "authors": [
                "Kaveh Khodjasteh",
                "Daniel A. Lidar"
            ],
            "title": "Performance of deterministic dynamical decoupling schemes: Concatenated and periodic pulse sequences",
            "venue": "Physical Review A 75,",
            "year": 2007
        },
        {
            "authors": [
                "P.V. Klimov",
                "J. Kelly",
                "Z. Chen",
                "M. Neeley",
                "A. Megrant",
                "B. Burkett",
                "R. Barends",
                "K. Arya",
                "B. Chiaro"
            ],
            "title": "Yu Chen",
            "venue": "A. Dunsworth, A. Fowler, B. Foxen, C. Gidney, M. Giustina, R. Graff, T. Huang, E. Jeffrey, Erik Lucero, J. Y. Mutus, O. Naaman, C. Neill, C. Quintana, P. Roushan, Daniel Sank, A. Vainsencher, J. Wenner, T. C. White, S. Boixo, R. Babbush, V. N. Smelyanskiy, H. Neven, and JohnM. Martinis. 2018. Fluctuations of Energy-Relaxation Times in Superconducting Qubits. Physical Review Letters 121, 9 ",
            "year": 2018
        },
        {
            "authors": [
                "Ryan LaRose",
                "Andrea Mari",
                "Sarah Kaiser",
                "Peter J. Karalekas",
                "Andre A. Alves",
                "Piotr Czarnik",
                "Mohamed El Mandouh",
                "Max H. Gordon",
                "Yousef Hindy",
                "Aaron Robertson",
                "Purva Thakre",
                "Nathan Shammah",
                "William J. Zeng"
            ],
            "title": "Mitiq: A software package for error mitigation on noisy quantum computers",
            "year": 2021
        },
        {
            "authors": [
                "Wim Lavrijsen",
                "Ana Tudor",
                "Juliane M\u00fcller",
                "Costin Iancu",
                "Wibe de Jong"
            ],
            "title": "Classical Optimizers for Noisy Intermediate-Scale Quantum Devices",
            "venue": "IEEE International Conference on Quantum Computing and Engineering (QCE)",
            "year": 2020
        },
        {
            "authors": [
                "Ying Li",
                "Simon C. Benjamin"
            ],
            "title": "Efficient Variational Quantum Simulator Incorporating Active Error Minimization",
            "venue": "Phys. Rev. X",
            "year": 2017
        },
        {
            "authors": [
                "Angus Lowe",
                "Max Hunter Gordon",
                "Piotr Czarnik",
                "Andrew Arrasmith",
                "Patrick J Coles",
                "Lukasz Cincio"
            ],
            "title": "Unified approach to data-driven quantum error mitigation",
            "venue": "arXiv preprint arXiv:2011.01157",
            "year": 2020
        },
        {
            "authors": [
                "John M Martinis",
                "Ken B Cooper",
                "Robert McDermott",
                "Matthias Steffen",
                "Markus Ansmann",
                "KD Osborn",
                "Katarina Cicak",
                "Seongshik Oh",
                "David P Pappas",
                "Raymond W Simmonds"
            ],
            "title": "Decoherence in Josephson qubits from dielectric loss",
            "venue": "Physical review letters 95,",
            "year": 2005
        },
        {
            "authors": [
                "Jarrod R McClean",
                "Jonathan Romero",
                "Ryan Babbush",
                "Al\u00e1n Aspuru-Guzik"
            ],
            "title": "The theory of variational hybrid quantum-classical algorithms",
            "venue": "New Journal of Physics 18,",
            "year": 2016
        },
        {
            "authors": [
                "Nikolaj Moll",
                "Panagiotis Barkoutsos",
                "Lev S Bishop",
                "Jerry M Chow",
                "Andrew Cross",
                "Daniel J Egger",
                "Stefan Filipp",
                "Andreas Fuhrer",
                "Jay M Gambetta",
                "Marc Ganzhorn"
            ],
            "title": "Quantum optimization using variational algorithms on near-term quantum devices",
            "venue": "Quantum Science and Technology 3,",
            "year": 2018
        },
        {
            "authors": [
                "ClemensM\u00fcller",
                "Jared H Cole",
                "J\u00fcrgen Lisenfeld"
            ],
            "title": "Towards understanding two-level-systems in amorphous solids: insights from quantum circuits",
            "venue": "Reports on Progress in Physics 82,",
            "year": 2019
        },
        {
            "authors": [
                "Prakash Murali",
                "Jonathan M Baker",
                "Ali Javadi-Abhari",
                "Frederic T Chong",
                "Margaret Martonosi"
            ],
            "title": "Noise-adaptive compiler mappings for noisy intermediatescale quantum computers",
            "venue": "In Proceedings of the Twenty-Fourth International Conference on Architectural Support for Programming Languages and Operating Systems",
            "year": 2019
        },
        {
            "authors": [
                "PrakashMurali",
                "David CMcKay",
                "Margaret Martonosi",
                "Ali Javadi-Abhari"
            ],
            "title": "Software mitigation of crosstalk on noisy intermediate-scale quantum computers",
            "venue": "In Proceedings of the Twenty-Fifth International Conference on Architectural Support for Programming Languages and Operating Systems",
            "year": 2020
        },
        {
            "authors": [
                "Alberto Peruzzo",
                "Jarrod McClean",
                "Peter Shadbolt",
                "Man-Hong Yung",
                "Xiao-Qi Zhou",
                "Peter J Love",
                "Al\u00e1n Aspuru-Guzik",
                "Jeremy L O\u2019brien"
            ],
            "title": "A variational eigenvalue solver on a photonic quantum processor",
            "venue": "Nature communications",
            "year": 2014
        },
        {
            "authors": [
                "Bibek Pokharel",
                "Namit Anand",
                "Benjamin Fortman",
                "Daniel A Lidar"
            ],
            "title": "Demonstration of fidelity improvement using dynamical decoupling with superconducting qubits",
            "venue": "Physical review letters 121,",
            "year": 2018
        },
        {
            "authors": [
                "Bibek Pokharel",
                "Namit Anand",
                "Benjamin Fortman",
                "Daniel A. Lidar"
            ],
            "title": "Demonstration of Fidelity Improvement Using Dynamical Decoupling with Superconducting Qubits",
            "venue": "Physical Review Letters 121,",
            "year": 2018
        },
        {
            "authors": [
                "John Preskill"
            ],
            "title": "Quantum Computing in the NISQ era and beyond",
            "venue": "Quantum",
            "year": 2018
        },
        {
            "authors": [
                "Gokul Subramanian Ravi",
                "Kaitlin N. Smith",
                "Pranav Gokhale",
                "Andrea Mari",
                "Nathan Earnest",
                "Ali Javadi-Abhari",
                "Frederic T. Chong"
            ],
            "title": "VAQEM: A Variational Approach to Quantum Error Mitigation",
            "year": 2021
        },
        {
            "authors": [
                "F.C. Robey",
                "D.R. Fuhrmann",
                "E.J. Kelly",
                "R. Nitzberg"
            ],
            "title": "1992",
            "venue": "A CFAR adaptive matched filter detector. IEEE Trans. Aerospace Electron. Systems 28, 1 ",
            "year": 1992
        },
        {
            "authors": [
                "Steffen Schl\u00f6r",
                "J\u00fcrgen Lisenfeld",
                "ClemensM\u00fcller",
                "Alexander Bilmes",
                "Andre Schneider",
                "David P Pappas",
                "Alexey V Ustinov",
                "Martin Weides"
            ],
            "title": "Correlating decoherence in transmon qubits: Low frequency noise by single fluctuators",
            "venue": "Physical review letters 123,",
            "year": 2019
        },
        {
            "authors": [
                "Kaitlin N Smith",
                "Gokul Subramanian Ravi",
                "Prakash Murali",
                "Jonathan M Baker",
                "Nathan Earnest",
                "Ali Javadi-Abhari",
                "Frederic T Chong"
            ],
            "title": "Error Mitigation in Quantum Computers through Instruction Scheduling",
            "year": 2021
        },
        {
            "authors": [
                "Alexandre M Souza",
                "Gonzalo A \u00c1lvarez",
                "Dieter Suter"
            ],
            "title": "Robust dynamical decoupling",
            "venue": "Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences",
            "year": 2012
        },
        {
            "authors": [
                "Swamit S Tannu",
                "Moinuddin K Qureshi"
            ],
            "title": "Mitigating measurement errors in quantum computers by exploiting state-dependent bias",
            "venue": "In Proceedings of the 52nd Annual IEEE/ACM International Symposium on Microarchitecture",
            "year": 2019
        },
        {
            "authors": [
                "Swamit S Tannu",
                "Moinuddin K Qureshi"
            ],
            "title": "Not all qubits are created equal: a case for variability-aware policies for NISQ-era quantum computers",
            "venue": "In Proceedings of the Twenty-Fourth International Conference on Architectural Support for Programming Languages and Operating Systems",
            "year": 2019
        },
        {
            "authors": [
                "Kristan Temme",
                "Sergey Bravyi",
                "Jay M Gambetta"
            ],
            "title": "Error mitigation for short-depth quantum circuits",
            "venue": "Physical review letters 119,",
            "year": 2017
        },
        {
            "authors": [
                "AV Uvarov",
                "AS Kardashin"
            ],
            "title": "and Jacob D Biamonte",
            "venue": "2020. Machine learning phase transitions with a quantum processor. Physical Review A 102, 1 ",
            "year": 2020
        },
        {
            "authors": [
                "Steven Vancoillie",
                "Per \u00c5ke Malmqvist",
                "Valera Veryazov"
            ],
            "title": "Potential energy surface of the chromium dimer re-re-revisited with multiconfigurational perturbation theory",
            "venue": "Journal of chemical theory and computation 12,",
            "year": 2016
        },
        {
            "authors": [
                "Lorenza Viola",
                "Emanuel Knill",
                "Seth Lloyd"
            ],
            "title": "Dynamical decoupling of open quantum systems",
            "venue": "Physical Review Letters 82,",
            "year": 1999
        },
        {
            "authors": [
                "GregWelch",
                "Gary Bishop"
            ],
            "title": "An introduction to the Kalman filter",
            "year": 1995
        }
    ],
    "sections": [
        {
            "text": "The most popular examples of iterative long-running quantum applications are variational quantum algorithms (VQAs). Iteratively, VQA\u2019s classical optimizer evaluates circuit candidates on an objective function and picks the best circuits towards achieving the application\u2019s target. Noise fluctuation can cause a significant transient impact on the objective function estimation of the VQA iterations\u2019 tuning candidates. This can severely affect VQA tuning and, by extension, its accuracy and convergence.\nThis paper proposes QISMET: Quantum Iteration Skipping to Mitigate Error Transients, to navigate the dynamic noise landscape of VQAs. QISMET actively avoids instances of high fluctuating noise which are predicted to have a significant transient error impact on specific VQA iterations. To achieve this, QISMET estimates transient error in VQA iterations and designs a controller to keep the VQA tuning faithful to the transient-free scenario. By doing so, QISMET efficiently mitigates a large portion of the transient noise impact on VQAs and is able to improve the fidelity by 1.3x-3x over a traditional VQA baseline, with 1.6-2.4x improvement over alternative approaches, across different applications and machines.\nCCS CONCEPTS \u2022 Computer systems organization\u2192 Quantum computing.\n\u2217Correspondence: gravi@uchicago.edu\nPermission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for components of this work owned by others than ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee. Request permissions from permissions@acm.org. ASPLOS \u201923, March 25\u201329, 2023, Vancouver, BC, Canada \u00a9 2023 Association for Computing Machinery. ACM ISBN 978-1-4503-9916-6/23/03. . . $15.00 https://doi.org/10.1145/3575693.3575739\nKEYWORDS quantum computing, variational quantum algorithms, error mitigation, transient error, superconducting qubits, noisy intermediatescale quantum, variational quantum eigensolver\nACM Reference Format: Gokul Subramanian Ravi, Kaitlin Smith, Jonathan M. Baker, Tejas Kannan, Nathan Earnest, Ali Javadi-Abhari, Henry Hoffmann, and Frederic T. Chong. 2023. Navigating the Dynamic Noise Landscape of Variational Quantum Algorithms with QISMET. In Proceedings of the 28th ACM International Conference on Architectural Support for Programming Languages and Operating Systems, Volume 2 (ASPLOS \u201923), March 25\u201329, 2023, Vancouver, BC, Canada. ACM,NewYork, NY, USA, 15 pages. https://doi.org/10.1145/3575693.3575739"
        },
        {
            "heading": "1 INTRODUCTION",
            "text": "Quantum computers leverage superposition, interference, and entanglement to give them significant computing advantage in chemistry [17], optimization [26], machine learning [6] and other domains of critical interest. In near-term quantum computing, called Noisy Intermediate-Scale Quantum (NISQ), we expect to work with machines which comprise 100-1000s of imperfect qubits [33].\nToday, noise prevents quantum computers from surpassing the capabilities of classical computers in almost all applications. NISQ devices suffer from high error rates in the form of state preparation and measurement (SPAM) errors, gate errors, qubit decoherence, crosstalk, etc. These errors stem from multiple noise sources such as the imperfect classical control of the device, thermal fluctuations, destructive qubit coupling, imperfect insulation of the qubits, quasi-particles, and other external stimuli [9, 19, 24, 27, 36]. The dynamic nature of quantum systems causes these noise sources to constantly vary over time, with some noise sources experiencing greater transient fluctuations than others. Additionally, because current fabrication techniques lack the precision to make homogeneous quantum device batches, the transient noise properties are unique to each device.\nEffectively understanding and mitigating different forms of error is critical for quantum advantage in real-world applications. Multiple error mitigation techniques have been explored on NISQ devices in the recent past [8, 10, 13, 22, 28, 29, 31, 37\u201341, 44]. While these techniques have the potential to greatly improve execution fidelity, they almost always view machine noise as static, or at least expect the noise to be stable for sufficiently long periods of time such that their characteristics can be adequately captured, appropriately characterized, and then effectively mitigated. Unfortunately, this is\nar X\niv :2\n20 9.\n12 28\n0v 2\n[ qu\nan t-\nph ]\n2 9\nSe p\n20 23\noften insufficient\u2014in this work we show that the transient errors from the dynamic noise landscape are challenging to comprehend and are especially detrimental to classes of applications that are iterative and/or long-running, and therefore their timely mitigation is important for significant fidelity improvements. Here, we use the term \u2018transient error\u2019 to refer to a temporary change in a quantum circuit\u2019s output distribution, produced due to sudden noninsignificant shift in device characteristics of one or more qubits in the quantum circuit [9, 19, 36]. The effect of these transient errors is seen even with the statistical robustness offered by executing multiple circuit shots (which are required to capture probabilistic output distributions).\nThe most popular examples of iterative long-running quantum applications are variational quantum algorithms (VQAs). VQAs are considered one of the most promising quantum tasks for near-term quantum advantage in the NISQ era. They have wide application in approximation [26], chemistry [30] etc, which are usually designed as minimization problems. VQAs are hybrid quantum-classical algorithms and they iteratively run a parameterized quantum circuit (QC) on the quantum machine. The QC parameters are optimized each iteration by a classical tuner/optimizer to try and approach the global minimum of the variational objective function. The classical optimizer inherently attempts to adjust the QC to the noise characteristics of the quantum device, and hence, in theory, gives VQAs the potential for quantum advantage even on noisy machines.\nTransient errors can be severely detrimental to VQAs. Iteratively, the VQA tuner estimates gradients of some form [21] across multiple circuit candidates to choose the best set of VQA parameters for further tuning. The VQA tuner works under the underlying assumption that the noise landscape of the device is unchanged during this gradient estimation process across the candidates. This is often not the case. Noise fluctuation can cause a significant transient impact on the objective function estimation of one or more\ncircuit candidates, and this can severely affect measured gradients and, therefore, the accuracy and convergence of VQA.\nThis discrepancy between VQA\u2019s ideal and reality is illustrated in Fig.1. The orange line shows the scenario with no noise, which is unrealistic (unless noise is entirely mitigated). The goal is to follow this line as closely as possible during VQA evaluation. The blue line shows VQA estimations if only static noise was present (this could potentially encompass dynamic noise that varies at very coarse temporal granularity). This is again unrealistic, but most prior error mitigation and optimization proposals have focused primarily on this setting, attempting to lower this blue line to bring it closer to orange, achieving considerable benefits. The reality is represented by the red line which shows that VQA estimations are affected by both static as well as transient noise - traditional VQA optimizations can be less effective in dealing with transients.\nThis paper proposes QISMET: Quantum Iteration Skipping to Mitigate Error Transients, to navigate the dynamic noise landscape of VQA. QISMET tries to eliminate the effect of VQA transient errors to the maximum extent possible\u2014lowering the red line in Fig.1 to bring it close to the blue line (shown in green). Other error mitigation techniques can be added orthogonally to bring the blue line (and, by extension, QISMET\u2019s green line) closer to the orange ideal scenario.\nQISMET is built with three key insights: 1 QISMET identifies a key capability in VQAs: a previous VQA iteration acts as an optimal reference circuit to estimate the effect of transient errors on a current VQA iteration. To utilize this, the current execution block reruns the reference circuit from the previous iteration, and the difference between the VQA outcomes is estimated. 2 Using traditional per-iteration gradient calculation, combined with QISMET\u2019s novel transient error estimation, QISMET is able to predict an estimate of the transient-free gradient for every iteration. 3 Finally, QISMET designs a controller to decide if a particular iteration is acceptable to VQA or not. A VQA iteration is accepted only if the direction of the observed VQA gradient from the machine loosely matches the direction of the predicted transient-free gradient (relative to the previous iteration). In other words, a new set of VQA parameters is accepted only if the machine estimation of the parameters being good or bad, relative to the current parameters, matches the predicted transient-free estimation of the same (within some margin of error).\nContributions and Results: 1 To the best of our knowledge, this work is among the first to study the effects of transient errors on VQAs. 2 This paper proposes QISMET, which actively avoids instances of high fluctuating noise which have a significant transient error impact on specific VQA iterations and can severely impact VQA accuracy and convergence.\n3 To achieve this, QISMET estimates transient error in VQA iterations and designs a controller to keep the VQA iteration gradients faithful to the transient-free scenario.\n4 By doing so, QISMET efficiently mitigates a large portion of the effects of transient noise on VQAs and is able to improve the fidelity of VQAs by 1.3x-3x over a traditional VQA baseline, across different applications and machines, with 1.6-2.4x improvement over alternative approaches.\n5 To diligently analyze the effects of transients, this work also builds transient error noise models for target VQA applications from observing real device transients. These are then integrated with the Qiskit simulator."
        },
        {
            "heading": "2 BACKGROUND",
            "text": "Quantum Information: A qubit can exist in a linear superposition of the basis states |0\u27e9 and |1\u27e9, taking the form of |\ud835\udf13 \u27e9 = \ud835\udefc |0\u27e9 + \ud835\udefd |1\u27e9. Together with other QC capabilities, this gives rise to the potential for quantum computers to exponentially outperform classical computers in certain applications. Qubits are manipulated through gates that modify their probability amplitudes, i.e. the coefficients of |0\u27e9 and |1\u27e9. There are many non-trivial single-qubit gates that can modify qubit state. Pairs of qubits can be manipulated via multiqubit interactions such as the two-qubit controlled-\ud835\udc4b , or \ud835\udc36\ud835\udc4b gate. Together, these enable universal quantum computation.\nNoise in the NISQ era: NISQ devices are error-prone and up to around 100 qubits in size today [33]. These devices are extremely sensitive to external influences and require precise control, and as a result, some of the biggest challenges that limit scalability include limited coherence, gate errors, readout errors, and connectivity. We will dive deeper into different noise sources and errors in Section 3. Multiple forms of error mitigation strategies have been proposed to correct different forms of quantum errors. These include, but are not limited to, noise aware compilation [28, 40]; correcting measurement errors [8, 39]; scheduling for crosstalk [10, 29]; extrapolating for zero noise [20, 22, 23, 41]; decoherence mitigation through dynamical decoupling [7, 16, 18, 32, 38], spin-echo correction [15], gate scheduling [37]; etc. In addition, some of these can be used in conjunction to achieve better fidelity [34]. Many of these techniques make deployment decisions that are dependent on noise characteristics of qubits and gates which have to be captured through expensive full machine characterization, and are thus captured only at some coarse granularity of time (eg., roughly once a day on IBMQ machines). Therefore, they are suboptimal in the presence of fine-granularity dynamic fluctuations.\nVariational Quantum Algorithms: Variational algorithms expect to have innate error resilience due to hybrid alternation with a noise-robust classical optimizer [25, 30]. An overview of this process is illustrated in Fig. 2. There are multiple applications in the VQA domain such as the Quantum Approximate Optimization\nAlgorithm (QAOA) [11] and the Variational Quantum Eigensolver (VQE) [30]. Our applications in this work target VQE but QISMET is broadly applicable across all VQAs. An important application of VQE is the ground state energy estimation of a molecule, a task that is exponentially difficult in general for a classical computer [14]. Estimating the molecular ground state has important applications in chemistry, such as determining reaction rates and molecular geometry. At a high level, VQE can be conceptualized as a guesscheck-repeat algorithm. The check stage involves the preparation of a quantum state corresponding to the guess. This preparation stage is done in polynomial time on a quantum computer, but would incur exponential cost in general on a classical computer. This contrast gives rise to a potential quantum speedup for VQE [14]. The quantum circuit used in each iteration of VQE (and VQA in general) is termed an ansatz which describes the range of valid physical systems that can be explored and thus determines the optimization surface. Traditionally, the ansatz is parameterized by 1-qubit rotation gates. The VQA problem is represented as a Hamiltonian and is a linear combination of multiple Pauli terms. The lowest eigenvalue of the Hamiltonian corresponds to the system\u2019s ground state energy [25]. Every iteration, the VQA objective function calculates the expectation value of this Hamiltonian. This objective function is derived from ansatz measurements over different bases. An illustration of this is shown in Fig.8.\nClassical Tuning for VQAs: The classical tuner/optimizer variationally updates the parameterized circuit until the measured objective converges to a minimum. For simple VQA problems and in the presence of minimal noise, the optimization surface is convex around the global minimum and smooth [21]. As noise increases, in line with NISQ machines, the optimization surface can potentially become non-convex and non-smooth. The surface contour worsens as the problem complexity increases because of increase in circuit depth, number of parameters, and entanglement spread [21]. In this work we predominantly focus on the popular Simultaneous Perturbation Stochastic Approximation (SPSA) [4] optimizer which has shown some robustness to noise. SPSA is a method of stochastic gradient approximation, which only requires two measurements of the objective function per iteration, regardless of the dimension of the optimization problem."
        },
        {
            "heading": "3 MOTIVATION: TRANSIENT NOISE AND ITS IMPACT",
            "text": ""
        },
        {
            "heading": "3.1 Device Level",
            "text": "Non-uniformity among superconducting (SC) transmon qubits degrades the capacity of many near-term QCs to execute meaningful quantum workloads. At the physical level, every superconducting transmon qubit is unique because of the unavoidable process variation during device fabrication. These unintended differences across a quantum chip are called defects. One of the most severe defects that stochastically appears during transmon manufacture is a twolevel system (TLS) [27]. The name TLS might be confusing because a qubit, when working as intended, is also a system with two levels. However, the difference is that a TLS defect is inopportunely placed such that it destructively couples to qubits during computation, significantly reducing the duration of time in which quantum state information can be maintained [24].\nThe Josephson Junction (JJ), or two superconductors separated by a thin metal-oxide insulator, is the critical component of the transmon qubit [12]. JJs are delicate components that must be fabricated with ultimate precision to achieve properties that enable the superconducting circuit to hold quantum state. Unfortunately, microscopic defects like TLS, taking the form of impurities inside materials or irregularities in atomic crystal structure, can appear in areas within the oxide layers or on the surface of the chip. TLS defects take on their own charge properties, and because each defect is unique, TLS is difficult to characterize. If TLS is close in proximity to the active components of the transmon, parasitic coupling causes qubit energy to be absorbed, causing fluctuation in qubit parameters such as T1 (amplitude) and T2 (phase) coherence times. Since transmon quantum systems are dynamic with evolving electric fields and states within JJs, the coupling strength of TLS that is near-resonant to a qubit varies over time, causing the qubit fluctuations to themselves be transient in nature [9, 36]. Apart from TLS, qubit parameters are also affected (potentially to a lesser degree) by thermal fluctuations, magnetic flux, quasi-particles, etc. [9, 19].\nFig.3 shows transient fluctuations in T1 times observed over 65 hours on a transmon qubit [9] for reasons described above. It should be noted that not all fluctuations are detrimental to a target circuit. We expect circuits to suffer significant fidelity impact only from fluctuations that result in very low T1 times. These are the outliers that are circled in the figure. Our expectation that impactful transients are an exception rather than the norm is evident in our analysis in the rest of this section and in our quantitative results. Furthermore, other fluctuating qubit parameters can also have significant impact; T1 times are just one example."
        },
        {
            "heading": "3.2 Circuit Level",
            "text": "Fluctuations in T1 times and other qubit/gate-level characteristics impact the execution of quantum circuits. The severity of impact could depend on: a Width of the QC:More number of qubits increases the probability of high impact transients on some (or at least one) of the qubits, b Depth of the QC: i) Deeper circuits are closer to the decoherence limit; therefore, a transient decrease in T1/T2 times can severely reduce circuit fidelity, and ii) deeper circuits usually imply more CX gates, which provide more sites for a substantial impact of error fluctuation,\nc Circuit State: Effect of errors is state dependent. For example, a circuit that carries a superposition of states with a high proportion of 0s is less affected by decoherence.\nExamples of the impact of transients on circuit fidelity are shown in Fig.4. The two primary figures show circuit fidelity data collected over a 45-hour period. Each data point is the average circuit fidelity obtained over a batch of 140 circuits over a one-hour period. The top circuit is a 4-qubit circuit with a depth of 6 CX gates. The average fidelity is around 83% and the total variation in fidelity is only around 5%. The bottom circuit is 8-qubits with a depth of approximately 50 CX gates. The average fidelity is around 25% and the variation is a concerning 35%. The zoomed figure at the bottom shows the fidelity variation over one of the batches, nearly 100% variation across the batch. The dashed line indicates a 90% threshold - in our applications we find that avoiding the extremes beyond this 90% is the most beneficial trade-off. More on this in Section 7.7."
        },
        {
            "heading": "3.3 Application Level (VQA)",
            "text": "Finally, the impact of transient errors on quantum circuits have a cumulative effective on long-running applications such as VQAs whose outcomes are influenced by per-iteration circuit fidelity. Discrepancies in gradient evaluations caused by transient noise fluctuations can lead the classical tuner to proceed along unfavorable directions in the VQA space, severely impeding convergence and accuracy. Section 4.1 discusses this in more detail.\nA severe case of transient error affecting VQA is shown in Fig.5. This is obtained from an experiment run on IBMQ Jakarta over\nroughly a 24-hour period. While we would ideally expect this VQA to somewhat monotonically converge to the minimum, multiple sharp spikes caused by transient fluctuations are seen. The spikes shown here are not the result of the optimizer jumping out of local minimas - such spikes are smoother and of lower amplitude. Although the detrimental impact of some transient fluctuations might be negated over a few iterations (for instance, in the case of the first circled spike), others fluctuations have a more lasting impact (second circled spike). The end expectation value reached at the end of 500 iterations is no better than that at 100 iterations, clearly showcasing the detrimental impact of transient noise. While such severe impacts might not always occur, milder scenarios are very common and are still detrimental, especially for long running use cases."
        },
        {
            "heading": "4 QISMET PROPOSAL",
            "text": ""
        },
        {
            "heading": "4.1 Navigating the Dynamic Noise Landscape",
            "text": "In every iteration of VQA, a classical tuner evaluates the gradient along a particular direction. Subsequently, it chooses directions which are some function of the prior evaluated gradients. Although different optimizers might implement this in various ways, most gradient-based approaches are some interpretation of the above. For instance, in a simple steepest-path approach, the direction with the steepest gradient (towards the optimum) is chosen. This tuning approach is built on the fundamental assumption that the direction gradients evaluated are affected by the same noise environment.\nFig.6 shows the VQA landscape for a minimization task under different scenarios. The blue dot represents the current configuration. The other dots represent different VQA configurations evaluated by the tuner towards picking a subsequent configuration. The dot positions along the Y-axis show their objective function estimates obtained on the machine in the presence of transients. Dots above the dashed line are perceived by the VQA tuner to worsen the objective while those below are perceived to improve it (\u2018perceived\u2019 because the true transient-free estimates can be different from the\nmachine obtained estimates, which could be skewed by transients). The color and number of each dot is indicative of its true objective function estimate in the absence of transients - note that these true estimates are not simply known in reality. Green dots improve the objective while red dots worsen it and the numbers indicate the magnitude. In a steepest-gradient approach, the VQA tuner would ideally want to select the true minimum - a green dot with highest magnitude number. But in reality it picks the perceived minimum - i.e., the dot which is lowest in the vertical direction (indicated by arrow). This setting is key to understanding the impact of transients on VQA and the QISMET solution. a The ideal scenario with no transients is illustrated in Fig.6.a. Here, the configuration selected by the tuner, which is the lowest vertically, is, in fact, the green dot with highest magnitude (green6). This is because the true and perceived estimates are equal in an ideal transient-free setting. Thus, it selects the true minimum among the evaluated samples. The effective VQA objective progress is shown in the inset at the bottom (moving lower is better) - in this case, it is optimal. b Unfortunately, this is often not the case in reality as shown in Fig.6.b. Transient noise induces discrepancies in the gradient evaluations, and this can cause the tuner to perceive configurations differently from their transient-free true estimates. This is indicated in the figure by the colors/magnitudes not being correlated with vertical positions. Some true good configurations are perceived as bad (green dots above the dashed line) and some true bad configurations are perceived as good (red dots below the dashed line). Furthermore, in this scenario, the perceived minimum which the tuner selects, i.e., the lowest dot in the vertical direction, is in fact a true bad configuration (red-3). Choosing this configuration throws the VQA optimization significantly farther from the optimum, creating upward spikes as seen in Fig.5 and thereby derailing accurate convergence. VQA progress is shown in the inset - the VQA objective worsens. c Fig.6.c shows how QISMET would navigate this realistic landscape with transient errors. By estimating the transient noise (discussed in Section 5.1), QISMET tries to identify which perceived gradients are opposite in direction to their true gradients. In other words, from Fig.6.b QISMET tries to predict which green dots are above the dashed line and which red dots are below. It then reexecutes these configurations on the quantum device until they are aligned with their true gradient directions (i.e., greens go below the dashed line and reds go above) or the retry budget is exhausted. In Fig.6.c the retried configurations are circled in black. Over the retrials, most (but not all) configurations realigned with their true gradient directions. The realignment would happen for a configuration if it is able to execute in an instance of low transient noise - this is highly probable since transients of significant detrimental effect are fairly uncommon (as seen in Figures 3 and 4). Eventually when selecting the new configuration, the tuner again selects the perceived minimum, i.e., the lowest vertical dot, but now this is a good true minimum (green-5), even if it is not the best (which was green-6 in the ideal case). Since the selected configuration is still a good true minimum it does not derail the VQA optimization even in the presence transients. VQA progress is shown in the inset - the VQA objective improves, even if not optimal (compared to the ideal\ncase). Thus, QISMET is more robust to the dynamic noise landscape of VQA."
        },
        {
            "heading": "4.2 Per-iteration QISMET Functionality",
            "text": "Fig.7 shows an instance of how QISMET functions over multiple iterations of VQA. A sequence of VQA \u2018jobs\u2019 are run on the quantum machine - each job is a collection of independent circuits. If VQA is run with some error mitigation (measurement error mitigation, for example), job \ud835\udefc would consist of circuits corresponding to the (\ud835\udc56)\ud835\udc61\u210e VQA iteration (orange inner box) and some related error mitigation circuits (dark gray inner box). QISMET adds some reference circuits to job \ud835\udefc . These are the repeated circuits from the (\ud835\udc56 \u2212 1)\ud835\udc61\u210e VQA iteration (yellow box). Circuits in the other jobs shown can be similarly inferred from the figure. Progress in the VQA algorithm is determined by the QISMET controller which is shown in the triangle labeled \u2018C\u2019 between jobs. The following steps can occur: 1 Upon executing job \ud835\udefc , the QISMET controller takes as input: a) iteration (\ud835\udc56 \u2212 1) circuits from the previous job \ud835\udf14 (yellow), b) its repetitions in the current job, i.e., iteration (\ud835\udc56 \u2212 1) circuits in job \ud835\udefc (yellow), and c) the primary circuits of job \ud835\udefc , which correspond to iteration (\ud835\udc56) (orange). In this case, the controller is shown to make the decision that the impact of transient noise on the (\ud835\udc56)\ud835\udc61\u210e iteration is reasonable. 2 Thus, VQA proceeds to job \ud835\udefd with its primary circuit as VQA iteration (\ud835\udc56 + 1) (blue), along with other circuits, as shown in figure. 3 After completion of job \ud835\udefd , the QISMET controller now takes as input: a) the iteration (\ud835\udc56) circuits from the previous job \ud835\udefc (orange), b) its repetitions in the current job, i.e., iteration (\ud835\udc56) circuits in job \ud835\udefd (orange), and c) the primary circuit of job \ud835\udefd , which correspond to iteration (\ud835\udc56 + 1) (blue). In this instance, the controller is shown to\nmake the decision that the transient noise impact is significant and can be detrimental to VQA. 4 Therefore, VQA does not proceed. Instead the VQA iteration (\ud835\udc56 + 1) circuits along with other circuits are repeated via job \ud835\udefe (hence same coloring as job \ud835\udefd). Note: since some transients effects can stay for extended time periods, the number of such rejections and repetitions is limited to some small max-out. 5 When the controller checks again (note that it obtains the iteration (\ud835\udc56) circuits in orange from job \ud835\udefc), it is deemed that significant fluctuation has passed and the current impact of transient noise is within reasonable limits. 6 Thus, VQA proceeds to job \ud835\udeff with the primary circuit as VQA iteration (\ud835\udc56 + 2), along with other circuits.\nBy taking steps as described above, the QISMET controller is able to navigate the dynamic noise VQA landscape, making decisions to the effect of Fig.9 as discussed in Section 4.1. Transient error estimation is discussed in Section 5.1 and controller logic in Section 5.2."
        },
        {
            "heading": "5 QISMET DESIGN",
            "text": "The QISMET proposal has two major components. The first component estimates transient error in each VQA iteration and uses this to make transient-free predictions. The second component uses the transient-free predictions to skip/retry particular iterations which are deemed harmful to VQA convergence."
        },
        {
            "heading": "5.1 Transient Estimation, Transient-Free Prediction",
            "text": "Fig.8 is a detailed expansion of any single iteration of Fig.7. Note that no error mitigation circuits from Fig.7 are shown. The left of Fig.8 shows the VQA iteration (\ud835\udc56) circuit that was run in the \u2018previous\u2019\njob \ud835\udefc . Its objective function (or energy) estimation on the machine is denoted by \ud835\udc38\ud835\udc5a (\ud835\udc56). To its right is \u2018current\u2019 job \ud835\udefd in which two circuits are shown. The left circuit is the rerun of iteration (\ud835\udc56) and its energy estimation on the machine is denoted by \ud835\udc38\ud835\udc5a\ud835\udc45 (\ud835\udc56). The right circuit is the iteration (\ud835\udc56 + 1) VQA circuit and its energy estimation on the machine is denoted by \ud835\udc38\ud835\udc5a (\ud835\udc56+1). The machine gradient for iteration (\ud835\udc56 + 1) is \ud835\udc3a\ud835\udc5a (\ud835\udc56 + 1) and is the difference between the machine energy estimates of iterations (\ud835\udc56 + 1) and (\ud835\udc56). This is the gradient estimate that a traditional VQA tuner would use towards parameter selection for the next iteration. QISMET estimates the transient error in iteration (\ud835\udc56 + 1) i.e., \ud835\udc47\ud835\udc5a (\ud835\udc56 + 1), as the energy difference between the rerun of iteration (\ud835\udc56) in job \ud835\udefd and its original run in job \ud835\udefc . QISMET then predicts the transient-free energy for iteration (\ud835\udc56 + 1) i.e., \ud835\udc38\ud835\udc5d (\ud835\udc56 + 1), relative to (\ud835\udc56) by removing the transient error component from \ud835\udc38\ud835\udc5a (\ud835\udc56 + 1). The predicted transient-free gradient\nis then \ud835\udc3a\ud835\udc5d (\ud835\udc56 + 1). Equations are shown to the right of Fig.8. This data is passed onto the QISMET controller which is discussed next in Section 5.2.\nNote that this assumes that the impact of the transient error on iteration (\ud835\udc56 + 1) is the same as that on iteration (\ud835\udc56). Although this is not necessarily exactly true, circuit (\ud835\udc56) is the closest possible reference circuit for transient noise estimation on circuit (\ud835\udc56 + 1), so its choice is justified."
        },
        {
            "heading": "5.2 Gradient Faithful QISMET Controller",
            "text": "Fig.9 is an illustration of different scenarios presented to the QISMET controller and the corresponding decisions made so that it achieves the navigation illustrated in Fig.6.\nThe intuitive idea is that the controller accepts VQA iterations only if the directions of the true gradients (i.e., gradients obtained\nin an ideal transient-free scenario) match the direction of the perceived gradients (i.e., gradients observed by the VQA tuner based on machine energy estimations). This prevents scenarios such as truly bad VQA configurations being perceived as good configurations, which could throw the VQA optimization away from its path towards the optimum target.\nIn the figure, the green dots are VQA energy estimates made on the quantum machine for iteration (\ud835\udc56), i.e., \ud835\udc38\ud835\udc5a (\ud835\udc56). The blue dots are machine energy estimates for iteration (\ud835\udc56 + 1), i.e., \ud835\udc38\ud835\udc5a (\ud835\udc56 + 1). The yellow lines are the negation of the estimated transient error between (\ud835\udc56) and (\ud835\udc56+1), i.e., \u2212\ud835\udc47\ud835\udc5a (\ud835\udc56+1). They are used to produce the orange dots which are the predictions of the transient-free energy for iteration (\ud835\udc56 + 1) relative to (\ud835\udc56), i.e., \ud835\udc38\ud835\udc5d (\ud835\udc56 + 1). Different scenarios and controller decisions are discussed below. 1 In Fig.9.a and b, both the machine estimates and the predicted transient-free estimates for iteration (\ud835\udc56 + 1) have a positive gradient wrt (\ud835\udc56), i.e.,\ud835\udc3a\ud835\udc5a (\ud835\udc56+1) and\ud835\udc3a\ud835\udc5d (\ud835\udc56+1) are both positive. Thus, the VQA iteration is acceptable, as the direction of the gradient is maintained.\n2 In (d) and (e), the machine gradients and predicted transient-free gradients of (\ud835\udc56 + 1) wrt (\ud835\udc56) are both negative, thus this iteration is acceptable. 3 In (c), the machine estimate for (\ud835\udc56 +1) has a positive gradient wrt (\ud835\udc56), but since the transient noise is significantly large, the predicted estimate (after negation of the transient noise) has a negative gradient. This is unacceptable since it makes a potentially bad VQA configuration be interpreted as a good one. 4 (f) is the inverse of (c) - again unacceptable because it makes a good VQA configuration be interpreted as bad. 5 Finally, the gradient swings within a specified error threshold region (pink shaded region) are always accepted. This is to avoid frequent skipping on less impacting transients. This is discussed and evaluated in Section 7.7."
        },
        {
            "heading": "5.3 Other Skipping and Filtering Techniques",
            "text": "It could be argued that an alternative intuitive solution is to avoid all instances inwhich transient noise is greater than some set threshold. The controller could simply be designed to skip a VQA iteration (\ud835\udc56) if abs(\ud835\udc47\ud835\udc5a (\ud835\udc56)) > \ud835\udf0f . We find that such a solution is unsuitable because many transients (even of reasonable magnitude) that are constructive to VQA progress, are skipped, thus, affecting accuracy and substantially delaying convergence. A quantitative comparison is discussed in Section 7.3.\nThe above is a fundamental difference between the QISMET gradient faithful controller and other filtering techniques that are common in classical computing (such as in signal processing). For example, Kalman filtering [45] is a signal processing approach that uses a system\u2019s environment model, some known inputs to that system, and multiple noisy measurements (say, from sensors), to build an understanding of the system\u2019s noise/variation, and then calculate noise-free estimates. It is generally suitable to application settings with dynamic variations similar to our focus in this work. A key feature of such filtering techniques is that they treat all forms of measurement variance to be the same and eliminate the variance in a principled way by inferring some information from multiple measurements.\nUnfortunately, this is less suited to the VQA tuning landscape. As discussed in Section 5.2, not all transients are harmful to VQA progress and only those that flip the gradient directions are detrimental and need to be avoided. From Fig.9, let\u2019s consider scenarios (a) and (c). While both have significant transient error magnitudes, (a) is not detrimental to VQA progress and is accepted by QISMET while (c) is deemed detrimental and is rejected. In contrast, the Kalman Filter (and related techniques) will incorporate some information from both (a) and (c) towards its elimination of noise and estimation of the true value. When carefully tuned, the differences in these scenarios can be incorporated into the filter to some extent, but its efficiency will be limited. With less careful tuning, the filtering might, in fact, prove to be detrimental. We quantitatively showcase different filtering scenarios in Sec.7.4.\nIt should also be noted that Kalman and other classical filtering techniques work best when the signal and noise follow some specific fairly stable characteristics. Unfortunately, as per our current understanding of quantum devices, the transient noise dynamism\nis largely non-deterministic and constantly varying over fine granularities of time."
        },
        {
            "heading": "6 METHODOLOGY",
            "text": ""
        },
        {
            "heading": "6.1 Applications and General Infrastructure",
            "text": "QISMET is a software optimization that can be integrated with any VQA classical optimizer. We implement it in Python and use it with the Qiskit VQA framework [5], through which it interacts with quantum execution.\nWe limit ourselves to one VQA domain, the VQE, which was introduced in Section 2. Due to noisy machine limitations on circuit width and depth, applications are restricted to 6 qubits. Our evaluations encompass 2 Hamiltonians, 6 different ansatz, and 7 IBMQ machines (as well as simulation). We primarily use the SPSA classical tuner across all our evaluations.\nOur primary focus is the one-dimensional TFIM (Transverse Field Ising Model) Hamiltonian, which is an ubiquitous model that has applications in understanding phase transitions in magnetic materials [42]. The TFIM is a desirable system since it is exactly solvable via classical means. Further, the Hamiltonian is easily constructed to create small problem sizes. We also evaluate the potential energy of the Hydrogen molecule over bond lengths of 0.4 - 2 \u00c5.\nWe use the hardware efficient SU2 [2] and RA [1] ansatz which are of low depth and therefore suited to NISQ devices. The number of block repetitions in the ansatz is varied between 2, 4 and 8 repetitions. IBM Q machines targeted for machine runs are Guadalupe (27q), Toronto (27q), Sydney (27q), Casablanca (7q), Jakarta (7q), and Mumbai (27q). IBM Q machines from which traces are generated for simulation are Guadalupe (27q), Toronto (27q), Cairo (27q), and Casablanca (7q). Machine details can be found on the IBM Quantum Systems page [3]. TFIM simulation application details are summarized in Table 1."
        },
        {
            "heading": "6.2 Building Transient Noise Models for Simulation",
            "text": "While execution on real quantummachines is a must for the holistic evaluation of application fidelity, sufficient access to machines is still limited today, especially for long-running applications such as VQAs. Further, fair evaluation requires a deterministic environment across different points of comparison, as well as reproducible results to validate and improve upon the proposal. To enable longer VQA runs in a deterministic environment and for reproducible comparisons, we are required to explore the use of IBM\u2019s quantum\nsimulator (via Qiskit). Unfortunately, the noise models traditionally available to Qiskit are static over the period of a machine\u2019s calibration cycle - they are refreshed roughly once per day.\nTo enable fine-granularity transient noise analysis in simulation, we build transient error traces for our target application-machine combinations. Per-iteration transient effects on VQA are captured and normalized to the magnitude of the VQA estimations. These transient effects are composed into a data structure and integrated into Qiskit\u2019s VQA framework. In each simulated VQA iteration, an instance of transient noise is accessed from the data structure corresponding to the particular application-machine pair. This transient noise is factored in with existing static components from Qiskit\u2019s noise models.\nFurthermore, the magnitude of transient noise can also be varied to perform a wider range of analyzes, as shown in Fig.10. The figure shows a variety of transient noise magnitudes applied to a VQA application, varying from 0-50% of the ideal VQA objective estimations. Intuitively, it is evident that as the impact of transient noise increases, the accuracy and convergence of the VQA estimates worsen. Similar experiments can be performed to test the capability of new proposals - we use this simulator to extensively evaluate QISMET."
        },
        {
            "heading": "6.3 Evaluation Comparisons",
            "text": "We evaluate QISMET based on VQA energy estimates (using the standard Hartree Energy metric when applicable). In one or more experiments, we compare:\nBaseline: Traditional VQA employing measurement error mitigation but no mitigation for transient errors.\nQISMET: Baseline + control to estimate transients and skip/rerun iterations when appropriate. The QISMET error threshold is set so as to skip at most 10% of the iterations (found to be the most suitable - Section 7.7).\nBlocking: A Qiskit SPSA optimization that only accepts VQA updates that move towards the objective.\nResampling: SPSA optimization that increases the number of times the gradient is sampled (we use 2x).\n2nd-order: A Qiskit SPSA optimization that estimates secondorder derivatives to condition the gradient.\nNoise-free: An ideal scenario without any form of error (run on the Qiskit simulator).\nQISMET-conservative: QISMET with threshold set to skip at most 1% of the VQA iterations.\nQISMET-aggressive: QISMET with threshold set to skip at most 25% of the VQA iterations.\nOnly-transients: An alternative proposed technique that skips VQA iterations if the estimated transient error is larger than some specified threshold.\nKalman: A classical filtering approach discussed in Section 5.3. It requires tuning filter hyper-parameters such as the Transition Coefficient (T), which is a linear estimation of the slope of the noisefree curve, and the Measurement Variance (MV), which is related to the variance in the noisy measurements.\n7 EVALUATION RESULTS"
        },
        {
            "heading": "7.1 Real Machine Experiments",
            "text": "First, we analyze VQA experiments run on the real IBMQ quantum machines. Note that the number of iterations that we can run on these machines is limited due to access constraints.\nFig.11 shows a comparison of QISMET against the baseline on a 6-qubit TFIM VQA on IBMQ Guadalupe. Both versions of the application are run for around 270 iterations, over a 48 hour period. The versions are run in a synchronous manner, so each iteration of the baseline is run temporally adjacent to the corresponding iteration of the QISMET version. Many instances of moderate transient error impact the baseline - two phases with transient errors are circled. While the baseline quickly recovers from the first transient phase, the second phase is more harmful, causing the VQA accuracy to somewhat stagnate over the next 50-100 iterations. These transient phases are predominantly avoided with QISMET, leading to a 40% improvement in VQA estimation over 270 iterations.\nFig.12 shows a comparison of QISMET against the baseline for the same 6-qubit TFIM VQA on IBMQ Sydney. Both versions of the application are run for around 350 iterations, over a 48 hour period.While themachine behavior is smooth formost of the tuning period, there is a single phase of significant turbulence (circled) which heavily impacts the baseline. QISMET is able to avoid this turbulent phase - QISMET is especially effective here since the transients only occur for a few iterations - once QISMET skips those errors, it is able to continue its steady progress, achieving a 50% improvement over the 350 iterations.\nFig.13 shows the QISMET benefits over the baseline on the primary vertical axis and the number of iterations run on the secondary vertical axis. Results are shown across 6 different IBM Q machines. QISMET improves the measured VQA expectation by by 29-51% across the machines, with a mean improvement of 39%. These improvements are achieved over 200-450 VQA iterations run on the devices. We expect that the relative QISMET benefits would be greater if more iterations were run since there would be increased potential for more transients to impact the baseline."
        },
        {
            "heading": "7.2 Comparing against SPSA Optimization Schemes",
            "text": "Fig.14 shows simulated evaluations of App2 (see Table 1) for five schemes - Baseline, QISMET, Resampling, Blocking and 2nd-order. These are introduced in Section 6. Simulations are run for 2000 iterations using the SPSA tuner, with convergence generally beginning at around 1250 iterations. QISMET performs best, achieving a VQA expectation of -1.5, which is a 65% improvement over the baseline.\nThe Blocking and Resampling schemes also show some improvement over the baseline. While the Blocking scheme can avoid transient errors thatmove VQA away from the objective, it also hurts the ability to escape from local minima. Similarly, while the Resampling scheme\u2019s increase in samples offers some transient robustness, it has twice the computational cost per iteration and therefore can be 2x slower to converge. Therefore, the VQA improvements obtained from these are around 30% lower than QISMET. The 2nd-order scheme uses 2nd-order derivatives to influence the gradients calculated in each iteration. We observe this scheme to in fact be detrimental in the presence of transients - imperfect 2nd-order derivatives can potentially skew the gradients even further away from optimal. This scheme performs 35% worse than the baseline and roughly 2.5x worse than QISMET."
        },
        {
            "heading": "7.3 Alternative Only-Transients Skipping Approach",
            "text": "Fig.15 shows the the alternative skipping approach discussed in Section 5.3, evaluated for App1. Thresholds (based on which the controller decides to skip or not) vary from a very high threshold, which keeps the % of skips below 1% (99p), to a low threshold, which allows up to 50% of the iterations to be skipped (50p). In all scenarios, the resulting VQA estimates are worse than the baseline and the higher skipping thresholds always perform better. This is clearly indicative that the skipping technique is more harmful than useful, motivating the need for a more intelligent approach such as QISMET."
        },
        {
            "heading": "7.4 Comparing against Kalman filtering",
            "text": "Furthering the discussion in Section 5.3, we compare different Kalman instances (with different values of T and MV parameters -\ndetails in Section 6.3) in Fig.16. We show its evaluation for App6, against the Baseline and Qismet, for 500 iterations, in simulation. Here, the Kalman filtering is applied on top of the noisy VQA tuning performed with SPSA. Note here that the T and MV values are tuned via an oracle approach, with noise known apriori, purely to maximize benefits.\nWe show 6 different Kalman instances with MV=0.01/0.1 and T=0.9/0.99/1 in Fig.16. A low MV value indicates that the filter assumes low influence of variation in the machine measurements - thus the filter does not actively combat it. Thus, any instance of high transient noise significantly impacts the filter (seen in the pink line, for example). A high MV value indicates the possibility of high variation influence in the measurements - so the filter actively avoids this. Unfortunately, the filter is unable to differentiate between machine noise and actual algorithmic variance (navigating local minima etc) - thus, this filtering technique saturates quickly and poorly (seen in the dark blue line, for example). A T value farther away from 1 imposes a forced downward descent on the estimated values - while this is helpful in true downward slopes, it is bad for escaping minima. In this application example, the most stable low estimate is produced by (MV=0.1, T=1) whereas the lowest but an erratic estimate is produced by (MV=0.01, T=1). While the estimates are as much as 1.4x better than the baseline, QISMET estimates are 3x better than the best Kalman variant, while also being stable."
        },
        {
            "heading": "7.5 Simulated Comparisons for Multiple Benchmarks",
            "text": "Next, in Fig.17 we perform evaluation comparisons for five schemes - QISMET, Blocking, Resampling, 2nd-order , and Kalman filter, across the six applications listed in Table 1. All evaluations are simulated for 2000 iterations and optimized with the SPSA tuner. QISMET provides consistent benefits, always outperforming the baseline and competing schemes, achieving mean improvements\nof 2x (up to 3x), 1.7x, 1.6x, 2.4x, and 1.85x respectively. Note that Blocking and Resampling schemes are inconsistent, offering a mean improvement over the baseline (1.2-1.25x), but perform worse on some applications (highlighted in red). As noted earlier, while these schemes have some robustness to transients, they are slow to accurate convergence due to increased per-iteration evaluation. The 2nd-order scheme consistently performs worse than the baseline and is not observed to be a suitable solution for transient errors. The Kalman filter hyper-parameters are tuned as discussed in Section 7.4 and only the best-case results are shown. While there is nonnegligible improvement over the baseline, the benefits are fairly low due to the reasons described in Section 5.3. Clearly, Qismet achieves a considerably higher improvement. Also, the best Kalman instance varies across different applications, further highlighting the challenges. Finally, it should be noted that QISMET benefits are generally greater for deeper circuits and/or on traces from noisier machines. This is intuitive and in line with the discussion in Section 3.2."
        },
        {
            "heading": "7.6 Multi-VQA Experiments for Molecules",
            "text": "In molecular chemistry, it is important to estimate the difference in VQE estimates across multiple Hamiltonians [43]. Here, each Hamiltonian models a particular geometry of the molecule (usually different bond lengths), and the VQE estimate is a measure of the\nmolecular potential energy. The difference between the energy estimates at different bond lengths is indicative of the chemical reaction rates for the molecule of interest. If transient noise affects some of the VQA experiments more than others, then the difference in energy estimates can be very skewed.\nFig.18 shows potential energy estimation for the \ud835\udc3b2 molecule through simulation. This simulation setup only uses transient noise and no static noise component. Estimations are performed for 10 different \ud835\udc3b \u2212 \ud835\udc3b bond lengths, each corresponding to a unique Hamiltonian and VQE experiment. The ideal noise-free scenario is shown, along with estimates obtained with QISMET and the baseline. Clearly, QISMET provides high-accuracy estimates, and the shape of the bell curve closely models the noise-free scenario. On the other hand, the baseline steadily deviates away from noisefree. Greater deviation is expected at higher bond lengths since the quantum component of the potential energy is more significant in this region (and therefore, so is the quantum error)."
        },
        {
            "heading": "7.7 Sweeping the QISMET Error Threshold",
            "text": "In Section 5.2, we discussed the use of a threshold to control the fraction of transients that are skipped by the QISMET controller. In Fig.19 three different thresholds are analyzed along with the baseline - these were introduced in Section 6. The evaluation is shown for two simulated use cases which experience low and high transient noise respectively. For the chosen use cases, the conservative threshold skips too few instances to have a significant impact and, therefore, performs similarly to the baseline. The aggressive threshold pushes QISMET to be worse than the baseline in the scenario\nwith low transient noise - too many iterations with low transient noise are skipped unnecessarily which delay convergence. In the scenario with high transient noise, the aggressive threshold still achieves considerable benefit since there are enough such impacting transients to skip. The best-case threshold is a good trade-off and is able to achieve the highest benefits in both scenarios, achieving a 1.2x and 3x improvement over the baseline, respectively. Note that intelligent dynamic thresholding can potentially be used to improve these benefits further, but is beyond our current scope."
        },
        {
            "heading": "8 DISCUSSION",
            "text": ""
        },
        {
            "heading": "8.1 Tuning QISMET Parameters",
            "text": "There are two tunable parameters in the QISMET framework. The more impactful one is the error threshold, which is discussed in Section 5.2 and evaluated in Section 7.7. If transient errors are very few and of very large magnitude, then conservative thresholds are suitable\u2014QISMET will predominantly follow the baseline and only avoid the transient errors which clearly stand out as egregious occurrences. On the other hand, transient errors which are more frequent and of magnitudes that are not too large but still detrimental, will benefit from more aggressive thresholds.\nThe other tunable parameter is the retry budget or the maximum number of repetitions that QISMET will perform on any iteration that does not meet the error threshold. In this work we fix this to 5 repetitions. The optimal number for this budget could be derived from an understanding of the typical time duration for which transient effects last. As long as the execution time taken by the retry-budget number of repetitions is slightly greater than the transient error duration, then an instance without the transient error\u2019s effects can be achieved for the given iteration. At the same time, if some device characteristic change occurs for a long time duration, i.e., it is not transient (eg., machine re-calibration), then we would want the change to be quickly accepted by QISMET, and adapted to by the VQA tuner in future iterations. From our real device experiments, we observe that transient errors disappear in one or two repetitions."
        },
        {
            "heading": "8.2 QISMET Suitability",
            "text": "QISMET is most effective and has most significant benefits when transient errors are of high magnitude and of reasonably short duration. Such instances can be identified and skipped in just a single trial. Our empirical real machine observations suggest that this is often the case. Transients of lower magnitude are not harmful to either QISMET or the baseline. There are some particular scenarios in which QISMET could perform poorly. One, if transient errors are gradually accumulating, then the errors would always be acceptable to the threshold but they might push VQA far from optimality. In this scenario though, QISMET would perform no worse than the baseline. Two, if high magnitude transient errors are of very long duration, then the effect of the transient is accepted after a retry budget worth of skips\u2014thus, the negative impact on VQA estimation is similar to the baseline, but QISMET also suffers from lost iterations in this scenario\u2014thus QISMET is worse off. While there could be other adversarial scenarios that negatively impact\nQISMET, quantum devices are too noisy today for contrived adversarial patterns to have any realistic likelihood of occurrence over a prolonged period."
        },
        {
            "heading": "8.3 QISMET Overheads",
            "text": "QISMET requires that each execution instance runs the current VQA iteration as well as a rerun of the previous iteration. In the absence of other error mitigation and/or supporting circuits, this means that the circuit execution overhead of QISMET is at least 2x (compared to a baseline with no transient errors). For the above scenario, in the absence of no skips, the overhead is exactly 2x, whereas the overhead increases with the number of skips. On most fairly reliable machines, the number of skips is extremely small\u2014 only the egregious transients are being avoided. However, it should be noted that error mitigation circuits (such as those to combat measurement errors) are often run alongside the primary circuit. These supporting circuits are often many in number, scaling in proportion to the number of measurement bits. In the presence of such circuits, QISMET overheads are reduced. Further, any QISMET overhead will only be negatively reflected if transients are entirely absent\u2014in practical settings which do have some transients, avoiding them with QISMET substantially lowers the overall iteration and execution time cost.\nKalman comparison:While, at first glance, it may seem that there are no overheads to the Kalman filtering (since circuits are run only once), it should be noted that the oracle (or any) approach used to tune the hyper-parameters requires some profiling, which would likely be much more expensive than the QISMET scenario, as described above."
        },
        {
            "heading": "8.4 Other Classical Techniques",
            "text": "In Sec.7.4, we showed that QISMET can substantially outperform classical filtering techniques such as the Kalman filter. Other filtering techniques are also available, such as Constant False Alarm Rate (CFAR) [35] detection, which is used in radar systems to detect target returns against a background of noise and interference. Similar to Kalman, they are limited in their capability to avoid specific detrimental transients. Finally, while the above filtering techniques are fairly unsupervised, supervised techniques are impractical since there is no useful labeled training data available, since the data would have to be machine-application pair dependent and stable over long periods of time."
        },
        {
            "heading": "9 CONCLUSION",
            "text": "Transient errors can be very detrimental to quantum computing in the NISQ era, especially for long-running applications such as VQAs. This paper proposes QISMET to navigate the dynamic noise landscape of VQA. It actively avoids instances of high fluctuating noise which can have a significant transient error impact on specific VQA iterations. To achieve this, QISMET estimates transient noise in VQA iterations and designs a controller to keep the machineobtained iteration gradients (specifically, their directions) faithful to their corresponding transient-free predicted estimates."
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "This work is funded in part by EPiQC, an NSF Expedition in Computing, under award CCF-1730449; in part by STAQ under award NSF Phy-1818914; in part by NSF award 2110860; in part by the US Department of Energy Office of Advanced Scientific Computing Research, Accelerated Research for Quantum Computing Program; and in part by the NSF Quantum Leap Challenge Institute for Hybrid Quantum Architectures and Networks (NSF Award 2016136) and in part based upon work supported by the U.S. Department of Energy, Office of Science, National Quantum Information Science Research Centers. This work was completed in part with resources provided by the University of Chicago\u2019s Research Computing Center. This research used resources of the Oak Ridge Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC05-00OR22725. GSR is supported as a Computing Innovation Fellow at the University of Chicago. This material is based upon work supported by the National Science Foundation under Grant # 2030859 to the Computing Research Association for the CIFellows Project. KNS is supported by IBM as a Postdoctoral Scholar at the University of Chicago and the Chicago Quantum Exchange. HH is supported by NSF (grants CCF2119184, CNS-1956180, CNS-1952050, CCF-1823032, CNS-1764039), ARO (grantW911NF1920321), and a DOE Early Career Award (grant DESC0014195 0003). FTC is Chief Scientist for Quantum Software at ColdQuanta and an advisor to Quantum Circuits, Inc."
        }
    ],
    "title": "Navigating the Dynamic Noise Landscape of Variational Quantum Algorithms with QISMET",
    "year": 2023
}