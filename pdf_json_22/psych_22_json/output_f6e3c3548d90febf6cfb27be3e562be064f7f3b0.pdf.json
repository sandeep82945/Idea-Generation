{
    "abstractText": "This paper presents the design of deep learning architectures which allow to classify the social relationship existing between two people who are walking in a sideby-side formation into four possible categories \u2013colleagues, couple, family or friendship. The models are developed using Neural Networks or Recurrent Neural Networks to achieve the classification and are trained and evaluated using a database of readings obtained from humans performing an accompaniment process in an urban environment. The best achieved model accomplishes a relatively good accuracy in the classification problem and its results enhance partially the outcomes from a previous study [1]. Furthermore, the model proposed shows its future potential to improve its efficiency and to be implemented in a real robot.",
    "authors": [
        {
            "affiliations": [],
            "name": "Oscar Castro"
        },
        {
            "affiliations": [],
            "name": "Alberto Sanfeliu"
        }
    ],
    "id": "SP:4f7ba0161300033d87ba0c2eda5f347c49da1c91",
    "references": [
        {
            "authors": [
                "Z. Yucel",
                "F. Zanlungo",
                "C. Feliciani",
                "A. Gregorj",
                "T. Kanda"
            ],
            "title": "Identification of social relation within pedestrian dyads",
            "venue": "PloS one, vol. 14, no. 10, p. e0223656, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "S. Lemaignan",
                "M. Warnier",
                "E.A. Sisbot",
                "A. Clodic",
                "R. Alami"
            ],
            "title": "Artificial cognition for social human\u2013robot interaction: An implementation",
            "venue": "Artificial Intelligence, vol. 247, pp. 45\u201369, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "M. Doering",
                "D. Br\u0161\u010di\u0107",
                "T. Kanda"
            ],
            "title": "Data-driven imitation learning for a shopkeeper robot with periodically changing product information",
            "venue": "ACM Transactions on Human-Robot Interaction (THRI), vol. 10, no. 4, pp. 1\u201320, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M. Villamizar",
                "A. Garrell",
                "A. Sanfeliu",
                "F. Moreno-Noguer"
            ],
            "title": "Interactive multiple object learning with scanty human supervision",
            "venue": "Computer vision and image understanding, vol. 149, pp. 51\u201364, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "H.-M. Gross",
                "H. Boehme",
                "C. Schroeter",
                "S. M\u00fcller",
                "A. K\u00f6nig",
                "E. Einhorn",
                "C. Martin",
                "M. Merten",
                "A. Bley"
            ],
            "title": "Toomas: interactive shopping guide robots in everyday use-final implementation and experiences from long-term field trials",
            "venue": "2009 IEEE/RSJ International Conference on Intelligent Robots and Systems. IEEE, 2009, pp. 2005\u2013 2012.",
            "year": 2009
        },
        {
            "authors": [
                "N. Hirose",
                "R. Tajima",
                "K. Sukigara"
            ],
            "title": "Personal robot assisting transportation to support active human life",
            "venue": "2015 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS). IEEE, 2015, pp. 5395\u20135402.",
            "year": 2015
        },
        {
            "authors": [
                "F. Faber",
                "M. Bennewitz",
                "C. Eppner",
                "A. Gorog",
                "C. Gonsior",
                "D. Joho",
                "M. Schreiber",
                "S. Behnke"
            ],
            "title": "The humanoid museum tour guide robotinho",
            "venue": "RO-MAN 2009-The 18th IEEE International Symposium on Robot and Human Interactive Communication. IEEE, 2009, pp. 891\u2013896.",
            "year": 2009
        },
        {
            "authors": [
                "A. Garrell",
                "A. Sanfeliu"
            ],
            "title": "Cooperative social robots to accompany groups of people",
            "venue": "The International Journal of Robotics Research, vol. 31, no. 13, pp. 1675\u20131701, 2012.",
            "year": 2012
        },
        {
            "authors": [
                "M.A. Yousuf",
                "Y. Kobayashi",
                "Y. Kuno",
                "A. Yamazaki",
                "K. Yamazaki"
            ],
            "title": "Development of a mobile museum guide robot that can configure spatial formation with visitors",
            "venue": "International Conference on Intelligent Computing. Springer, 2012, pp. 423\u2013432.",
            "year": 2012
        },
        {
            "authors": [
                "Y. Morales",
                "T. Kanda",
                "N. Hagita"
            ],
            "title": "Walking together: Side-byside walking model for an interacting robot",
            "venue": "Journal of Human-Robot Interaction, vol. 3, no. 2, pp. 50\u201373, 2014.",
            "year": 2014
        },
        {
            "authors": [
                "D. Karunarathne",
                "Y. Morales",
                "T. Kanda",
                "H. Ishiguro"
            ],
            "title": "Model of side-by-side walking without the robot knowing the goal",
            "venue": "International Journal of Social Robotics, vol. 10, no. 4, pp. 401\u2013420, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "E. Repiso",
                "A. Garrell",
                "A. Sanfeliu"
            ],
            "title": "Robot approaching and engaging people in a human-robot companion framework",
            "venue": "IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS), 2018, pp. 8200\u20138205.",
            "year": 2018
        },
        {
            "authors": [
                "A. Garrell",
                "C. Coll",
                "R. Alqu\u00e9zar",
                "A. Sanfeliu"
            ],
            "title": "Teaching a drone to accompany a person from demonstrations using non-linear asfm",
            "venue": "2019 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS). IEEE, 2019, pp. 1985\u20131991.",
            "year": 2019
        },
        {
            "authors": [
                "E. Repiso",
                "A. Garrell",
                "A. Sanfeliu"
            ],
            "title": "People\u2019s adaptive side-by-side model evolved to accompany groups of people by social robots",
            "venue": "IEEE Robotics and Automation Letters, vol. 5, no. 2, pp. 2387\u20132394, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "E. Prassler",
                "D. Bank",
                "B. Kluge"
            ],
            "title": "Key technologies in robot assistants: Motion coordination between a human and a mobile robot",
            "venue": "Transactions on Control, Automation and Systems Engineering, vol. 4, no. 1, pp. 56\u201361, 2002.",
            "year": 2002
        },
        {
            "authors": [
                "L. Takayama",
                "C. Pantofaru"
            ],
            "title": "Influences on proxemic behaviors in human-robot interaction",
            "venue": "2009 IEEE/RSJ International Conference on Intelligent Robots and Systems. IEEE, 2009, pp. 5495\u20135502.",
            "year": 2009
        },
        {
            "authors": [
                "Z. Wang",
                "T. Chen",
                "J. Ren",
                "W. Yu",
                "H. Cheng",
                "L. Lin"
            ],
            "title": "Deep reasoning with knowledge graph for social relationship understanding",
            "venue": "arXiv preprint arXiv:1807.00504, 2018.",
            "year": 1807
        },
        {
            "authors": [
                "Q. Sun",
                "B. Schiele",
                "M. Fritz"
            ],
            "title": "A domain based approach to social relation recognition",
            "venue": "Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, 2017, pp. 3481\u20133490.",
            "year": 2017
        },
        {
            "authors": [
                "J. Li",
                "Y. Wong",
                "Q. Zhao",
                "M.S. Kankanhalli"
            ],
            "title": "Visual social relationship recognition",
            "venue": "International Journal of Computer Vision, vol. 128, no. 6, pp. 1750\u20131764, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "Z. Yucel",
                "F. Zanlungo",
                "C. Feliciani",
                "A. Gregorj",
                "T. Kanda"
            ],
            "title": "Estimating social relation from trajectories",
            "venue": "Collective Dynamics, vol. 5, pp. 222\u2013229, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "F. Zanlungo",
                "Z. Y\u00fccel",
                "T. Kanda"
            ],
            "title": "Intrinsic group behaviour ii: On the dependence of triad spatial dynamics on social and personal features; and on the effect of social interaction on small group dynamics",
            "venue": "PloS one, vol. 14, no. 12, p. e0225704, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "A.P. Fiske"
            ],
            "title": "The four elementary forms of sociality: framework for a unified theory of social relations.",
            "venue": "Psychological review,",
            "year": 1992
        },
        {
            "authors": [
                "M.S. Clark",
                "J. Mills"
            ],
            "title": "Interpersonal attraction in exchange and communal relationships.",
            "venue": "Journal of personality and social psychology,",
            "year": 1979
        },
        {
            "authors": [
                "E.B. Foa",
                "U.G. Foa"
            ],
            "title": "Resource theory of social exchange",
            "venue": "Handbook of social resource theory. Springer, 2012, pp. 15\u201332.",
            "year": 2012
        },
        {
            "authors": [
                "B. D"
            ],
            "title": "Bugental, \u201cAcquisition of the algorithms of social life: a domainbased approach.",
            "venue": "Psychological bulletin,",
            "year": 2000
        },
        {
            "authors": [
                "F. Zanlungo",
                "D. Br\u0161\u010di\u0107",
                "T. Kanda"
            ],
            "title": "Spatial-size scaling of pedestrian groups under growing density conditions",
            "venue": "Physical Review E, vol. 91, no. 6, p. 062810, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "O.I. Abiodun",
                "A. Jantan",
                "A.E. Omolara",
                "K.V. Dada",
                "N.A. Mohamed",
                "H. Arshad"
            ],
            "title": "State-of-the-art in artificial neural network applications: A survey",
            "venue": "Heliyon, vol. 4, no. 11, p. e00938, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "Y. Goldberg"
            ],
            "title": "Neural network methods for natural language processing",
            "venue": "Synthesis lectures on human language technologies, vol. 10, no. 1, pp. 1\u2013309, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "S. Li",
                "W. Li",
                "C. Cook",
                "C. Zhu",
                "Y. Gao"
            ],
            "title": "Independently recurrent neural network (indrnn): Building a longer and deeper rnn",
            "venue": "Proceedings of the IEEE conference on computer vision and pattern recognition, 2018, pp. 5457\u20135466.",
            "year": 2018
        },
        {
            "authors": [
                "Y. Yu",
                "X. Si",
                "C. Hu",
                "J. Zhang"
            ],
            "title": "A review of recurrent neural networks: Lstm cells and network architectures",
            "venue": "Neural computation, vol. 31, no. 7, pp. 1235\u20131270, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "J. Torres"
            ],
            "title": "DEEP LEARNING Introducci\u00f3n pr\u00e1ctica con Keras. Lulu.com, 2018. This figure \"fig1.png\" is available in \"png\" format",
            "year": 2018
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n20 7.\n02 89\n0v 1\n[ cs\n.L G\n] 6\nJ ul\n2 02\n2\nI. INTRODUCTION\nThe world of robotics is experiencing an unprecedented growth towards artificial intelligence or big data. Also, the field of Human Robot Interaction (HRI) is no exception in this regard, more and more researchers include these theories to allow the development of robots capable of executing more natural, safe, social and comfortable tasks for humans who interact with them to perform everyday tasks [2]\u2013[4].\nFurthermore, this interaction between robots and humans is presented as one of the great challenges for robotics that must be faced, and even more so if we want non-trained volunteers to feel comfortable interacting with these robots. For this reason, we must equip robots with more human and social skills, like the accompaniment task which is present in many situations, such as shopping [5], traveling to other places [6], or visiting museums [7]. Where the robot should be adapted to allow a more human, predicable and comfortable accompaniment behaviors. To do so, the classification of these human social relationships is crucial to allow the robot to behave in consequence.\nIn this research we are interested in the development of social robots capable of accompanying pedestrians. To ensure this purpose, the robot which is accompanying a person should adapt its behavior in the best possible way, and it is mandatory to be able to analyze, to learn and to execute the variables that the accompanying processes imply to give an adequate response to each person and situation, in order to obtain a comfortable and safe interaction for both parties. Thanks to the correct identification using the human social relationship classification during the accompaniment task, the robot should be able to adapt its movements and\nThe authors are with the Institut de Robo\u0300tica i Informa\u0300tica Industrial (CSIC-UPC). Llorens Artigas 4-6, 08028 Barcelona, Spain. oscar.castro.arcusa@estudiantat.upc.edu, {erepiso,agarrell,sanfeliu}@iri.upc.edu\nto generate a greater sense of security and comfort for people and, therefore, improve their experience during the accompaniment process.\nIn this paper, we present new methods to classify the social relationship of humans being accompanied by other humans, to allow a robot to learn these types of social behaviors so that in the future, it would be capable of accompanying people in a social and more comfortable manner. Fig. 1 shows a set examples of different relationships between humans navigating in a side-by-side formation.\nIn the remainder of the paper, the related work is presented in Sec. II. Sec. III describes the used database and exposes the implemented architectures of Neural Networks (NNs) and Recurrent Neural Networks (RNNs). Sec. IV shows the obtained results. Sec. VI includes the discussion of the paper. Finally, conclusions are given in Sec. VII."
        },
        {
            "heading": "II. RELATED WORK",
            "text": "The main purpose of the current research is to make robots capable of accompanying a person in a social accepted manner. However, to achieve this goal, robots should understand the relationship established between individuals during the task, in order to adapt their behavior. For this reason, it is necessary, in the first place, to classify the type of affinity that is constituted between two people, so that in the future it could be applied to the robot-human relationship."
        },
        {
            "heading": "A. Accompaniment with social robots",
            "text": "One of the most promising applications in recent years in the field of social robots is accompanying people. In society, there are a wide variety of situations in which a social robot can carry out accompaniment tasks, whether accompanying a group of humans or a single person. In particular, the ability to accompany a single person is an important tool that every urban robot should have, responding to the basic need to accompany people in a natural and safe way. Some of the situations where side-by-side accompaniment is a fundamental pillar arise when guiding [7]\u2013[9] or accompanying walking\npeople [10], [11], especially in urban [12] or aerial [13] environments.\nHRI research in the field of robot navigation while accompanying humans presents a challenging task as the robot has to navigate safely and naturally while accompanying a person. Currently, there are models that allow a robot to navigate with social awareness and accompany a person sideby-side in crowded urban areas [12], [14], [15], even without knowing the destination of the accompanied person [11]. However, not all existing models are able to adjust certain parameters, such as social distance or accompanying speed, according to the specific characteristics of the accompaniment or the particular environment of the accompanied person [10].\nIn addition, it has been shown that there are several factors that affect the social interactions between the robot and the accompanied person, e.g. if the accompanied people have experience in pet care or in the world of robots, they decrease their personal space with respect to the robot compared to the space that inexperienced people maintain [16].\nHowever, the aforementioned works do not consider the different social relationships that are established between individuals in the accompaniment task. In contrast, we present a classification model of human behavior that allows us to identify the social relationship existing between two people in a couple performing an accompaniment process with the future objective that it can be adapted for a robot, so that when it is used it allows the robot to adapt to each person and, consequently, to have a greater acceptance."
        },
        {
            "heading": "B. Classification of social relationship between couples",
            "text": "In general, there are a wide variety of studies focused on classifying the social relationship between people with the aim of designing machines and robots capable of interacting socially with humans [17]\u2013[19]. Focusing on environments such as urban areas, there are also studies that focus on classifying the social relationship between members of pedestrian groups in public spaces [20], or analysing how the type of relationship between members of the same social group affects the dynamics of the group when moving around [21].\nFor example, authors in [1] presents a study that focuses on analysing social groups of pedestrians in public spaces with the aim of identifying the type of relationship between group members. In particular, the study uses pedestrian couples as the social group of reference.\nAlthough there are various classifications of human-tohuman social relationships [22]\u2013[24], the above study [1] classifies the relationship of pedestrian couples into four categories: colleagues, couple, family or friends [25]. Using two different methods, the study manages to obtain relatively good results in classifying the relationship of the couples and distinguishing between the four categories above. Also, we compare our results with this work.\nIn contrast to previous studies, this work develops different models that perform the classification of the existing social relationship in couples during accompaniment based on the application of deep learning models. Therefore, the methods\nimplemented allow for the classification of the relationship between the members of a couple while they are in the process of accompaniment into four possible categories: colleagues, couple, family or friendship. Specifically, we implement various models that use NNs, both standard and recurrent, to perform the classification."
        },
        {
            "heading": "III. CLASSIFICATION OF HUMANS\u2019 RELATIONSHIP",
            "text": "For social robots to find their place in today\u2019s society in the field of accompanying people, it is of vital importance that they are able to adapt to human behavior when carrying out these accompanying tasks. An indispensable part of these tasks is to observe this behavior and identify what kind of relationship is established with the person being accompanied.\nIn order that the robot will be able to classifying social relationships between humans, we describe the database that we use in Sec. III-A, and deep learning is used to create several models to obtain this robot\u2019s behavior in Sec.III-C."
        },
        {
            "heading": "A. Database Description",
            "text": "In order to design the desired classification method it is need it a database to work on. This database allows deep learning models to be trained and the effectiveness of their classifications to be tested. The used database in this work was provided by Dr. Francesco Zanlungo of the Intelligent Robotics and Communication Laboratory of the Advanced Telecommunications Research Institute (ATR) in Kyoto, author of several studies in the field of HRI and social robots [1], [21].\nThis database contains the readings of different variables taken from couples performing an accompaniment process, walking through an urban environment, and the labels corresponding to the couples\u2019 social relationships. These labels were assigned by several people that observe the couple behavior and recognize their relation. The provided database presents the examples of couples divided into four categories \u2013colleagues, couple, family or friendship. In total, it consists of 867 examples of couples. The distribution of examples of pedestrian couples in the four studied categories are: 267 in Colleagues, 96 in Couple, 218 in Family, and 286 in Friendship.\nEach example of couple includes 13 different variables: detection time; \u2212\u2192p c =(pX , pY , pZ)c where c \u2208 {1, 2} meaning position of pedestrian 1 and 2; \u2212\u2192 V c = (VX , Vy) velocity of pedestrian 1 and 2; and V T c total velocity of pedestrian 1 and 2. Most of these variables can be seen graphically in the Fig. 2. In addition, to the aforementioned 13 parameters, three new variables are calculated using these previous parameters due to the importance they prove to have in the processes of social accompaniment and navigation [1], [20], [21]. These new three variables are included in Eq. 1, 2 and 3. All these variables are used to characterize the performed type of accompaniment. As the accompaniment processes are dynamic processes given during navigation, the experiments have different measurements as each process has a different duration.\n\u2022 Distance between pedestrians, calculated as\nDist = ||\u2212\u2192p 2 \u2212 \u2212\u2192p 1||, (1)\nwhere \u2212\u2192p 2 is the position of pedestrian 2 and \u2212\u2192p 1 is the\nposition of pedestrian 1. \u2022 Relative pedestrian-to-pedestrian velocity, calculated as\nV elRelative = |V T 1 \u2212 V T 2 |, (2)\nwhere V T 1 is the total velocity of pedestrian 1 and V T 2\nis the total velocity of pedestrian 2. \u2022 Total velocity of the couple, calculated as\nV elTotal = V T 1 + V T 2\n2 , (3)\nIn summary, the database used is made up of 867 examples of pedestrian couples, each of which is defined by 16 parameters that will allow the developed method to classify each example in one of the defined categories. Further details about the database can be obtained in [1], [26]."
        },
        {
            "heading": "B. Database adaptation for our Deep Learning Architectures",
            "text": "As couple accompaniment is a dynamic process over time, the readings of variables at a given instant may not accurately represent the reality of the relationship. To do this, we took the readings from each experiment and averaged each variable, converting the readings from one experiment into a single reading, except for the time variable, which is obtained by subtracting the final and initial times.\nTo train the different NNs designed, the existing database is divided into training set and test set. Thus, 90 % of the data is used as a training set to train the model and the remaining 10 % is used to test the accuracy and validity of the trained model as a test set. Therefore, if the database consists of 867 experiments, a total of 780 examples make up the training set and the remaining 87 examples are part of the test set."
        },
        {
            "heading": "C. Deep Learning Architecture",
            "text": "Neural networks (NNs) are especially notable for their ability to process information due to their structure. They are built by complex computational units, known as neurons, which are distributed in layers and are interconnected\nforming a network of elements that work together to solve specific problems [27].\nThe proposed classification methods are based on NNs. The design of the proposed models is based on finding the correct configuration of the so-called hyperparameters of the system. These hyperparameters are those variables of the model that must be configured and adjusted during the design and that allow controlling the training process of the NN.\nDifferent NN designs are used to test which one offers the best accuracy, both in the training set and, especially, in the test set. In each design implemented, several hyperparameters of the network are varied: the number of hidden layers, the number of neurons in the hidden layers, the learning rate and the number of epochs in the training process. In addition, the L2 regularisation and dropout methods are used to try to solve the overfitting problem.\nThere are several design conditions that are met for all\nNNs developed. These conditions are:\n\u2022 The input layer consists of 16 neurons. Each neuron corresponds to one of the input parameters explained in\nthe subsection III-A.\n\u2022 The hidden layers are designed with the ReLU activation\nfunction.\n\u2022 The output layer is designed with the Softmax activation\nfunction.\n\u2022 The Mini-Batch Gradient Descent is used as gradient\ndescent algorithm.\n\u2022 The croos-entropy function is used as the loss function.\nA general outline of the developed classification method can be seen in Fig. 3. On the one hand, the variables extracted from the examples in the database feed the deep learning models designed. On the other hand, the classification of the example into one of the defined social relationship types is obtained in the NN output."
        },
        {
            "heading": "D. Recurrent Neural Network",
            "text": "A recurrent neural network (RNN) is a type of NN capable of working with temporal sequences of data. The ability\nto have memory makes RNNs a suitable tool for machine learning tasks involving sequential data. By being able to use relevant information from past input data in the training process, they can make more accurate predictions [29].\nOnce the standard NN models have been implemented, several RNNs are designed to test their efficiency. Having readings of the database samples over a certain period of time, it is decided to implement RNNs due to their ability to work with temporal sequences of data and extract possible dependencies between them.\nSpecifically, Long Short-Term Memory (LSTM) networks are an extension of RNNs that use special hidden units, called memory cells, whose goal is to increase the memory of the network so that it is able to remember important information over time [30]. In this way, LSTMs can better capture temporal dependencies of long-term input data, due to the ability of LSTM units to register possible temporal behavioral patterns. In addition, they have the ability to avoid the phenomenon of vanishing or exploding gradients [31].\nThe RNNs developed in this work follow the same design conditions as NNs, as explained in subsection III-C. In addition, the first hidden layer of the RNNs is a LSTM layer, which allows the model to capture the temporal dependencies of the input data in the long term."
        },
        {
            "heading": "IV. RESULTS",
            "text": "In this section, we present the results obtained form the different neural networks implemented. First, the NNs (of Sec. III-C) and the RNNs (Sec. III-D) models are used to classify the people behavior in four categories in Sec. IV-A and second, the same methods are used to classify the behaviors in only two categories, because the categories of couple, family, and friendship can be merged in one \u201dintimate\u201d, due to the fact that they have a similar degree of intimacy, very different than the one of the colleagues category."
        },
        {
            "heading": "A. Results of NNs models",
            "text": "The characteristics of the NNs implemented are detailed in Table I. By running the networks defined in Table I, the results are obtained as shown in Table II. To try to\navoid the phenomenon of overfitting, in some models L2 regularisation and dropout methods (15 % in the hidden layers) are implemented. We only show the confusion matrix of the best model selected in table III. The other confusion matrices show worst results in general or show that the neural net can differentiate well one or two types of the four mentioned, then these neural nets can not be used alone to classify correctly all the people\u2019s behaviors.\nTable III shows that the examples in the family and friendship categories are correctly classified with accuracies of 42, 86 % and 50, 00 %, respectively, when using the RN23 model. Also, it may classify part of the other examples of the two other categories, couples and colleagues."
        },
        {
            "heading": "B. Results of RNNs models",
            "text": "The characteristics of the RNNs implemented are given in Table IV. The results obtained by executing the networks defined in Table IV are given in Table V. In order to try to avoid the phenomenon of overfitting, the L2 regularisation method is implemented in all models. The confusion of the best obtained method is shown in table VI.\nTable VI highlights the accuracies of 82, 61 % and 30, 30 % obtained by correctly classifying the examples in the categories of colleagues and friendship, respectively, when using the RNR2-1 model. Also, we can see here that this method tries to classify in the friendship category the categories of family and couple due to the similarity of these three categories. The fact that supports that after, we try to test our classifiers in a new database that join these three types of relation in one."
        },
        {
            "heading": "C. Results analysis",
            "text": "At first glance, when analysing the results presented in Tables II and V, it is observed that the best accuracies in the training set are obtained in the models based on standard NNs, as shown in Table II. On the contrary, the best accuracies in the test set are obtained in the models based on RNNs, as shown in Table V. Specifically, the RN2-3 model, which has an accuracy of 99, 10 % in the training set and 40, 23 % in the test set, and the RNR2-3 model, which has an accuracy of 66, 52 % in the training set and 42, 31 % in the test set, stand out.\nAlthough the accuracies of the methods in the training set and test set are basic evaluation metrics, an analysis of the confusion matrices obtained is necessary to understand how the classification of the examples into the four categories studied is being performed.\nWhen analysing the confusion matrices of the models based on standard NNs that show better accuracy, different phenomena are observed. In Table III, corresponding to the model with the highest accuracy in both, the training set and\nN\u00ba of hidden layers\nN\u00ba of neurons in the hidden layers N\u00ba of epochs Learning rate L2 Reg. Dropout\nRNR2-1 2 25-12 1500 0,00015 Yes No RNR2-2 4 2500-1800- 1200-600 10 0,00011 Yes No RNR2-3 2 1500-600 25 0,00011 Yes No\nTABLE IV: Features of RNN models implemented.\nTraining set accuracy Test set accuracy\nRNR2-1 45,17% 41,03% RNR2-2 62,05% 30,77% RNR2-3 66,52% 42,31%\nTABLE V: Accuracy of RNN models implemented.\nthe test set, it is observed that the RN2-3 model recognises the correct categories more accurately than the others, even reaching 50, 00 % accuracy in the friendship category, and with the exception of the examples in the couples category, which are assigned in a similar proportion among the four categories. This same pattern is repeated in the RN2-4 model, although the accuracy of the classification of the friendship and couple categories worsens but improves in the family category. The only model that shows high accuracy in the couple category is RN2-1, although it shows relatively low efficiency in classifying examples in the other categories. As for the RN2-2 and RN2-5 models, in general, they are not able to classify the examples in the correct categories with a higher accuracy than the others and, moreover, the effectiveness of the classification is in all cases surpassed by that of the RN2-3 model. Thus, the RN2-3 model is postulated as the model based on a standard NN capable of performing a better classification of human relationships in the four categories studied.\nOn the other hand, when analysing the confusion matrices generated from the models based on RNNs, different phenomena are observed. As can be seen in Table VI, corresponding to the RNR2-1 model, it is observed that the presented model has a preference when performing the classification to assign the examples in the categories of colleagues or friendship, resulting in a very high accuracy for the category of colleagues (82, 61 %), but null for the category of couple and very low for the category of family, because due to its similarity the method classifies all in the category of friendship. The latter is a pattern that is repeated for all the RNN models, as all the models designed have zero accuracy in correctly classifying the examples in the database into the category of couple. Taking this into consideration, the rest of the models present a similar situation by having more facilities to classify the data in certain categories than in others. For example, while the RNR2-3 model is highly accurate in correctly classifying the examples in the colleague category (but with less % than the selected model), the RNR2-2 model is highly accurate in classifying the examples in the family category In addition, models based on RNNs have, in general, considerably good accuracy in classifying examples of the colleagues category compared to models based on standard NNs. After all, the RNR2-3 model seems to emerge as the model based on a RNN that\nPredicted value Colleagues Couple Family Friendship\nReal value Colleagues 82,61 0 8,70 8,70 Couple 33,33 0 0 66,67 Family 43,75 0 18,75 37,50\nFriendship 60,61 0 9,09 30,30\nTABLE VI: Confusion matrix of the RNR2-1 model (in %).\ncan perform a better classification of human relationships by showing, in general, a relatively higher efficiency than the other models in classifying the examples into the four correct categories. However, it has not been possible to produce a model capable of obtaining the best accuracy in at least three of the relationship categories, as the RN2-3 model does.\nTherefore, it is considered that the model that can best perform the classification of the social relationship in human couples is the RN2-3 model, as it presents the best accuracy of all the models implemented in the training set, as well as the best accuracies in the test set, and the best efficiencies as a whole when classifying the data correctly (see Table III)."
        },
        {
            "heading": "V. CONCLUSIONS EXTRACTED FROM THE IMPLEMENTATION OF ALL METHODS",
            "text": "The differences between the accuracies obtained in the designed models are due to the different configurations of hyperparameters that have been implemented in them. Depending on these configurations, the networks present higher or lower accuracies in the training set and test set. Even so, when analysing the confusion matrices of the models designed, it is possible to draw a series of conclusions.\nModels with a higher number of neurons in their hidden layers or a higher number of epochs are able to train their network parameters better and, consequently, obtain high accuracies in the training set. However, the accuracy slightly decreases with increasing the number of hidden layers from two to four, as can be seen when comparing the results of the two-hidden-layer RN2-3 model with the results of the four-hidden-layer RN2-4 model (see Table II). This phenomenon may occur as a result of the increased learning difficulty during training due to the increased number of layers. Therefore, an unnecessary increase in the number of layers in the model design should be avoided, because such an increase does not necessarily lead to an increase in model accuracy and, on the contrary, may lead to a reduction in model efficiency.\nAnother factor to take into account is the training time of the models. When the number of hidden layers, the number of neurons in the hidden layers, or the number of epochs is increased, the computational time and the computational cost of the model training process increases. In the specific case of this work, it has been decided to give priority to the accuracy of the models in the classification, but in the case of looking for a model with a shorter training period, the correct choice of these three hyperparameters must be taken into account in order to achieve this objective.\nMoreover, the L2 regularisation method manages to slightly decrease the overfitting phenomenon and increase the accuracy of the model, as can be seen by comparing the\nresults of the RN2-2 and RN2-3 models (see Table II). On the other hand, the dropout method not only fails to increase the accuracy of the model in the test set, but also considerably decreases the accuracy in the training set, as can be seen by comparing the results of models RN2-3 and RN2-5 (see Table II).\nFinally, the choice of the learning rate is approached as a process of choosing different values and testing the effectiveness of the models for each of them until the value that offers the best possible results is found.\nConsequently, the design of NNs is proposed as an iterative trial-and-error process with the aim of finding the configuration of hyperparameters that offers the best efficiency of the model and, therefore, the best possible accuracy in the database classification process.\nTherefore, it can be stated that NNs-based methods of deep learning are positioned as a relatively effective tool for classifying the relationship between people in a couple. However, in order for these methods to realise their full potential, it is necessary to considerably increase the database with more examples of couples, as it is with large datasets that NNs work best. In addition, the process of setting up hyperparameters and testing new NN models should also be continued in order to see how effective they are.\nFinally, it can be concluded that the differentiation between the four categories is a complicated process due to the similarity that data from examples of different categories can present, even for a human being (see Fig. 1). In the absence of a behavioral manual for the different social relationships, finding a model capable of identifying patterns between different examples of the same category can be a very difficult task. However, the best models presented perform relatively well in the process of classifying the social relationship of the people in a couple into one of the four categories studied. In order to increase the effectiveness of the model, it is necessary to increase the number of examples in the database. In particular, it is necessary to increase the number of examples whose social relationship is that of a couple, as this is, in general, the relationship that shows the worst accuracy in the classification carried out by the models designed."
        },
        {
            "heading": "A. Classification into two categories",
            "text": "Finally, in order to better analyse the results obtained, it was decided to merge the categories of couple, family and friendship into a single category called \u201cintimate\u201c, in reference to the consideration that the three merged relationships entail a higher degree of intimacy between the members of the couple than the relationship of colleagues. In this sense, the category of colleagues is renamed as \u201cacquaintances\u201c for the purpose of the classification process.\nIn the following, we report the classification results obtained by the two types of NNs used. The characteristics of the different NN models implemented are detailed in Table VII. The results obtained by executing the networks defined in the Table VII are listed in Table VIII. To try to avoid the phenomenon of overfitting, L2 regularisation\nis implemented in some models. The confusion matrices of the different designed methods are collected in table (IX).\nTable IX-left highlights that, using the RN2-6 model, the examples in the categories of acquaintances and intimate are correctly classified with accuracies of 45, 83 % and 80, 95 %, respectively. Table IX-center shows that the examples in the intimate category are correctly classified with an accuracy of 74, 60 % when using the RN2-7 model. Table IX-right highlights that, using the RNR2-4 model, examples in the intimate category are correctly classified with an accuracy of 85, 45%. The classification into two possible categories shows a considerable increase in the accuracy in the test set of the different models designed, as can be seen in Table VIII. Specifically, the RN2-6 model stands out, with an accuracy of 96, 15 % in the training set and 71, 26 % in the test set. Furthermore, it can be seen in Table IX-left that the model has a high accuracy in the recognition of examples in the intimate category and by far the best accuracy of all models for the acquaintances category. In contrast, other models such as RN2-7 or RNR2-4 show a very considerable bias towards the intimate category, as can be seen in Tables IX-center and IX-right. Therefore, the RN2-6 model is postulated as the NN-based model capable of performing a better classification of human relationships into the two categories presented.\nThus, it can be stated that the process of classifying the social relationship into two categories is more accurate than the classification into four categories. In addition, as discussed above, it is necessary to increase the database of examples and to continue the process of setting hyperparameters in order to achieve a model with the best possible efficiency."
        },
        {
            "heading": "B. Comparison with state-of-art-method",
            "text": "Once the results of the different classification models have been obtained, they are compared with the results obtained in the work [1]. However, it is important to bear in mind that, although the objective of this project coincides with that of the comparative study, the databases used are not exactly the same. Nevertheless, it is possible to make a comparison of the results obtained by using different classification methods.\nAs various methods, parameters and even data are used in the study [1], the best results obtained by some of the methods presented are used to compare them with the results\nobtained by the models developed in this work. Specifically, we select one of the methods of the study that obtains the best classification accuracies in the four categories of relationships (see Table X).\nTherefore, we compare the results of one of the best models of the study [1], shown in Table X, with the results of the RN2-3 model developed in this work (see Table III), which is considered the model designed to best classify the social relationship in human couples. Thus, it is observed that while the method of the study presents a better accuracy in the categories of colleagues and couples, the developed model has a higher accuracy in the categories of family and friendship. However, the method implemented in [1] presents greater differences in the classification accuracies of the categories of colleagues and couple with respect to the method implemented in this work, than those presented by this method in the categories of family and friendship with respect to those of the comparative study. Consequently, it is difficult to say with certainty which model performs a better overall classification of social relationships in the four categories presented.\nEven so, the potential offered by the deep learning models suggests that an increase in the database of examples of accompanying couples and some minor adjustments in the configuration of the hyperparameters of the model designed could provide the necessary improvement to obtain greater efficiency in the classification process.\nFinally, our new strategy to merge the three most similar categories in one, derived to obtain better classifications results than in the state-of-art method. And for a robot application to customize the robot\u2019s behavior to accompany people, this classification in two categories can be enough and derive in good accompaniment customization results."
        },
        {
            "heading": "VI. DISCUSSION",
            "text": ""
        },
        {
            "heading": "A. Summary",
            "text": "We have designed a deep learning model that allows to classify the social relationship between two people who are doing an accompaniment process into four possible categories (colleagues, couple, family or friendship) with a good accuracy. The model has been developed using NNs and it has been trained and evaluated using a database of readings obtained from couples performing an accompaniment process in an urban environment. The confusion matrix\nhas been used to verify the effectiveness of the classification and the results have been compared with those obtained in a similar work [1].\nWe believe that the classification model can be improved to provide its full potential by increasing the database and adjusting the value of the hyperparameters, which can lead to its further adaptation to be implemented in a social robot."
        },
        {
            "heading": "B. Contributions for HRI",
            "text": "One of the pillars that technology must always bear in mind is to make people\u2019s lives easier. Thus, interaction between robots and people must be natural and safe. To achieve this, a robot must be able to identify how the person, it is accompanying and interacting, is behaving.\nBy correctly identifying the behavior of the person it is accompanying, the social robot should be able to adapt its movement to generate a greater sense of security and comfort for the person and, therefore, improve their experience during the process."
        },
        {
            "heading": "C. Applicability",
            "text": "If the database is enhanced and some adjustments in the model are done in order to improve the efficiency, the described model could be adapted to make the robot one of the members of the couple. Then, this new model could be implemented in a social robot. If this hypothetical social robot were to carry out a accompaniment process with a person, it should be able to act as an active member of that couple, navigating alongside them and classifying, in real time, the behavior of the accompanying human based on the measurements of its sensors to adapt its navigation. In addition, the accompanied person could choose, prior to the accompaniment process, what type of relationship he/she wants the robot to have with him/her.\nIt is important to take into account the advantage that a robotic system can adapt itself as comfortably as possible to a person while accompanying them to a destination. This can be very beneficial, for example, when using robot assistants for people with special needs, sick or elderly in nursing homes. Such robots can also support care home workers, helping to reduce their heavy workload. Ultimately, providing robots with the tools that allow them to adapt their behavior in a personalised way, and behave in the most social way possible can only bring benefits for the society of the future."
        },
        {
            "heading": "D. Limitations",
            "text": "Although social relationship classification in couples may prove to be a useful application, we believe that the maximum potential and most applications will come from adapting this function so that a social robot can benefit from and\nbe able to adapt its behavior to the preferences shown by the person it is accompanying."
        },
        {
            "heading": "VII. CONCLUSIONS",
            "text": "We have presented several models capable of classifying the social behavior of a couple of humans during their accompaniment. From the analysis of the results, the RN23 model based on a standard NN stands out, with which good accuracies are obtained in the process of classifying the social relationship between two people.\nThe future work would be oriented towards two different objectives. The first objective would be trying to improve the precision of the implemented NNs. To achieve this, it is essential to increase the database with more labeled examples of couples accompanying each other and, then, continue adjusting the parameters of the models and modifying their design to increase their effectiveness.\nThe second objective to be carried out would be the implantation of the designed models in a real robot with the necessary instruments to collect data from the target couples. If this phase were to be carried out successfully, the next step to be taken would be to adapt the programs designed to consider the robot as one of the members of the couple. Then, the robot should obtain the data of various parameters of the human companion\u2019s navigation while it is moving to be able to process them through the new models implemented and, thus, classify its behavior in one of the four categories studied. Finally, the robot would have the necessary information to be able to adapt to the behavior shown by its human companion. Using this process, the robot should be able to accompany people in a more natural, safe, social and comfortable way for them."
        }
    ],
    "title": "Humans Social Relationship Classification during Accompaniment",
    "year": 2022
}