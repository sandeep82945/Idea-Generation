{
    "abstractText": "We report the implemented architecture for monitoring the health and the quality of the Son Of X-Shooter (SOXS) spectrograph for the New Technology Telescope in La Silla at the European Southern Observatory. Contact authors: Laurent Marty (laurent.marty@inaf.it) and Marco Landoni (marco.landoni@inaf.it) ar X iv :2 20 9. 07 18 3v 1 [ as tr oph .I M ] 1 5 Se p 20 22 Briefly, we report on the innovative no-SQL database approach used for storing time-series data that best suits for automatically triggering alarm, and report high-quality graphs on the dashboard to be used by the operation support team. The system is designed to constantly and actively monitor the Key Performance Indicators (KPI) metrics, as much automatically as possible, reducing the overhead on the support and operation teams. Moreover, we will also detail about the interface designed to inject quality checks metrics from the automated SOXS Pipeline (Young et al. 2022).",
    "authors": [
        {
            "affiliations": [],
            "name": "Marco Landoni"
        },
        {
            "affiliations": [],
            "name": "Laurent Marty"
        },
        {
            "affiliations": [],
            "name": "Dave Young"
        },
        {
            "affiliations": [],
            "name": "Laura Asquini"
        },
        {
            "affiliations": [],
            "name": "Stephen J. Smartt"
        },
        {
            "affiliations": [],
            "name": "Sergio Campana"
        },
        {
            "affiliations": [],
            "name": "Riccardo Claudi"
        },
        {
            "affiliations": [],
            "name": "Pietro Schipani"
        },
        {
            "affiliations": [],
            "name": "Matteo Aliverti"
        },
        {
            "affiliations": [],
            "name": "Federico Battaini"
        },
        {
            "affiliations": [],
            "name": "Andrea Baruffolo"
        },
        {
            "affiliations": [],
            "name": "Sagi Ben-Ami"
        },
        {
            "affiliations": [],
            "name": "Federico Biondi"
        },
        {
            "affiliations": [],
            "name": "Andrea Bianco"
        },
        {
            "affiliations": [],
            "name": "Giulio Capasso"
        },
        {
            "affiliations": [],
            "name": "Rosario Cosentino"
        },
        {
            "affiliations": [],
            "name": "Francesco D\u2019Alessio"
        },
        {
            "affiliations": [],
            "name": "Paolo D\u2019Avanzo"
        },
        {
            "affiliations": [],
            "name": "Matteo Genoni"
        },
        {
            "affiliations": [],
            "name": "Ofir Hershko"
        },
        {
            "affiliations": [],
            "name": "Hanindyo Kuncarayakti"
        },
        {
            "affiliations": [],
            "name": "Matteo Munari"
        },
        {
            "affiliations": [],
            "name": "Giuliano Pignata"
        },
        {
            "affiliations": [],
            "name": "Adam Rubin"
        },
        {
            "affiliations": [],
            "name": "Salvatore Scuderi"
        },
        {
            "affiliations": [],
            "name": "Fabrizio Vitali"
        },
        {
            "affiliations": [],
            "name": "Jani Achr\u00e9n"
        },
        {
            "affiliations": [],
            "name": "Jos\u00e9 Antonio Araiza-Duran"
        },
        {
            "affiliations": [],
            "name": "Iair Arcavi"
        },
        {
            "affiliations": [],
            "name": "Anna Brucalassi"
        },
        {
            "affiliations": [],
            "name": "Rachel Bruch"
        },
        {
            "affiliations": [],
            "name": "Enrico Cappellaro"
        },
        {
            "affiliations": [],
            "name": "Mirko Colapietro"
        },
        {
            "affiliations": [],
            "name": "Massimo Della Valle"
        },
        {
            "affiliations": [],
            "name": "Marco De Pascale"
        },
        {
            "affiliations": [],
            "name": "Rosario Di Benedetto"
        },
        {
            "affiliations": [],
            "name": "Sergio D\u2019Orsi"
        },
        {
            "affiliations": [],
            "name": "Avishay Gal-Yam"
        },
        {
            "affiliations": [],
            "name": "Marcos Hernandez"
        },
        {
            "affiliations": [],
            "name": "Jari Kotilainen"
        },
        {
            "affiliations": [],
            "name": "Gianluca Li Causi"
        },
        {
            "affiliations": [],
            "name": "Seppo Mattila"
        },
        {
            "affiliations": [],
            "name": "Luca Oggioni"
        },
        {
            "affiliations": [],
            "name": "Giorgio Pariani"
        },
        {
            "affiliations": [],
            "name": "Michael Rappaport"
        },
        {
            "affiliations": [],
            "name": "Kalyan Radhakrishnan"
        },
        {
            "affiliations": [],
            "name": "Davide Ricci"
        },
        {
            "affiliations": [],
            "name": "Marco Riva"
        },
        {
            "affiliations": [],
            "name": "Bernardo Salasnich"
        },
        {
            "affiliations": [],
            "name": "Ricardo Zanmar Sanchez"
        },
        {
            "affiliations": [],
            "name": "Maximilian Stritzinger"
        }
    ],
    "id": "SP:13db1648fd51a02bba543cc834feaaf65cad597f",
    "references": [
        {
            "authors": [
                "P Schipani"
            ],
            "title": "Development status of the SOXS spectrograph for the ESO-NTT telescope",
            "venue": "Proc. SPIE 11447, 1144709 (2020).",
            "year": 2020
        },
        {
            "authors": [
                "M Aliverti"
            ],
            "title": "The mechanical design of SOXS for the NTT",
            "venue": "Proc. SPIE 10702, 1070231 (2018).",
            "year": 2018
        },
        {
            "authors": [
                "M Aliverti"
            ],
            "title": "Manufacturing, integration and mechanical verification of SOXS",
            "venue": "Proc. SPIE 11447, 114476O (2020). Figure 7: A zoomed view of a graph for a quality check. See text for details",
            "year": 2020
        },
        {
            "authors": [
                "F Biondi"
            ],
            "title": "The assembly integration and test activities for the new SOXS instrument at NTT",
            "venue": "Proc. SPIE 10702, 107023D (2018).",
            "year": 2018
        },
        {
            "authors": [
                "F Biondi"
            ],
            "title": "The AIV strategy of the common path of Son of X-Shooter",
            "venue": "Proc. SPIE 11447, 114476P (2020).",
            "year": 2020
        },
        {
            "authors": [
                "A Brucalassi"
            ],
            "title": "The acquisition camera system for SOXS at NTT",
            "venue": "Proc. SPIE 10702, 107022M (2018).",
            "year": 2018
        },
        {
            "authors": [
                "A Brucalassi"
            ],
            "title": "Final design and development status of the acquisition and guiding system for SOXS",
            "venue": "Proc. SPIE 11447, 114475V (2020).",
            "year": 2020
        },
        {
            "authors": [
                "G Capasso"
            ],
            "title": "SOXS control electronics design",
            "venue": "Proc. SPIE 10707, 107072H (2018).",
            "year": 2018
        },
        {
            "authors": [
                "R Claudi"
            ],
            "title": "The common path of SOXS (Son of X-Shooter)",
            "venue": "Proc. SPIE 10702, 107023T (2018).",
            "year": 2018
        },
        {
            "authors": [
                "R Claudi"
            ],
            "title": "Operational modes and efficiency of SOXS",
            "venue": "Proc. SPIE 11447, 114477C (2020).",
            "year": 2020
        },
        {
            "authors": [
                "M Colapietro"
            ],
            "title": "Progress and tests on the Instrument Control Electronics for SOXS",
            "venue": "Proc. SPIE 11452, 1145225 (2020).",
            "year": 2020
        },
        {
            "authors": [
                "R Cosentino"
            ],
            "title": "The vis detector system of SOXS",
            "venue": "Proc. SPIE 10702, 107022J (2018).",
            "year": 2018
        },
        {
            "authors": [
                "R Cosentino"
            ],
            "title": "Development status of the UV-VIS detector system of SOXS for the ESO-NTT telescope",
            "venue": "Proc. SPIE 11447, 114476C (2020).",
            "year": 2020
        },
        {
            "authors": [
                "M Genoni"
            ],
            "title": "SOXS End-to-End simulator: development and applications for pipeline design",
            "venue": "Proc. SPIE 11450, 114501B (2020).",
            "year": 2020
        },
        {
            "authors": [
                "H Kuncarayakti"
            ],
            "title": "Design and development of the SOXS calibration unit",
            "venue": "Proc. SPIE 11447, 1144766 (2020).",
            "year": 2020
        },
        {
            "authors": [
                "D Ricci"
            ],
            "title": "Architecture of the SOXS instrument control software",
            "venue": "Proc. SPIE 10707, 107071G (2018).",
            "year": 2018
        },
        {
            "authors": [
                "D Ricci"
            ],
            "title": "Development status of the SOXS instrument control software",
            "venue": "Proc. SPIE 11452, 114522Q (2020).",
            "year": 2020
        },
        {
            "authors": [
                "A Rubin"
            ],
            "title": "MITS: the Multi-Imaging Transient Spectrograph for SOXS",
            "venue": "Proc. SPIE 10702, 107022Z (2018).",
            "year": 2018
        },
        {
            "authors": [
                "A Rubin"
            ],
            "title": "Progress on the UV-VIS arm of SOXS",
            "venue": "Proc. SPIE 11447, 114475L (2020).",
            "year": 2020
        },
        {
            "authors": [
                "Sanchez",
                "R. Z"
            ],
            "title": "Optical design of the SOXS spectrograph for ESO NTT",
            "venue": "Proc. SPIE 10702, 1070227 (2018).",
            "year": 2018
        },
        {
            "authors": [
                "Sanchez",
                "R. Z"
            ],
            "title": "SOXS: effects on optical performances due to gravity flexures, temperature variations, and subsystems alignment",
            "venue": "Proc. SPIE 11447, 114475F (2020).",
            "year": 2020
        },
        {
            "authors": [
                "P Schipani"
            ],
            "title": "The new SOXS instrument for the ESO NTT",
            "venue": "Proc. SPIE 9908, 990841 (2016).",
            "year": 2016
        },
        {
            "authors": [
                "P Schipani"
            ],
            "title": "SOXS: a wide band spectrograph to follow up transients",
            "venue": "Proc. SPIE 10702, 107020F (2018).",
            "year": 2018
        },
        {
            "authors": [
                "F Vitali"
            ],
            "title": "The NIR spectrograph for the new SOXS instrument at the NTT",
            "venue": "Proc. SPIE 10702, 1070228 (2018).",
            "year": 2018
        },
        {
            "authors": [
                "F Vitali"
            ],
            "title": "The development status of the NIR arm of the new SOXS instrument at the ESO/NTT telescope",
            "venue": "Proc. SPIE 11447, 114475N (2020).",
            "year": 2020
        },
        {
            "authors": [
                "D Young"
            ],
            "title": "The SOXS data reduction pipeline",
            "venue": "Proc. SPIE 11452, 114522D (2020).",
            "year": 2020
        },
        {
            "authors": [
                "L Marty"
            ],
            "title": "The quality check system architecture for soxs",
            "venue": "Proc. SPIE (in press 2022).",
            "year": 2022
        },
        {
            "authors": [
                "M Landoni"
            ],
            "title": "The soxs scheduling system",
            "venue": "Proc. SPIE (in press 2022).",
            "year": 2022
        },
        {
            "authors": [
                "M. Landoni",
                "P. Romano",
                "S. Vercellone",
                "J. Knodlseder",
                "A. Bianco",
                "F. Tavecchio",
                "A. Corina"
            ],
            "title": "A Cloud-Based architecture for the Cherenkov Telescope Array observation simulations",
            "venue": "[AGN13: Beauty and the Beast ], 13, 3 (Oct. 2018).",
            "year": 2018
        }
    ],
    "sections": [
        {
            "text": "Contact authors: Laurent Marty (laurent.marty@inaf.it) and Marco Landoni (marco.landoni@inaf.it)\nBriefly, we report on the innovative no-SQL database approach used for storing time-series data that best suits for automatically triggering alarm, and report high-quality graphs on the dashboard to be used by the operation support team. The system is designed to constantly and actively monitor the Key Performance Indicators (KPI) metrics, as much automatically as possible, reducing the overhead on the support and operation teams. Moreover, we will also detail about the interface designed to inject quality checks metrics from the automated SOXS Pipeline (Young et al. 2022).\nKeywords: SOXS, noSQL, Quality control, Quality Checks, Pipeline, Data Reduction, Spectroscopy, Imaging"
        },
        {
            "heading": "1. INTRODUCTION",
            "text": "The Son-Of-X-shooter (SOXS) (Son Of X-Shooter) instrument is a new medium resolution spectrograph (R ' 4500) able to simultaneously observe 350-2000nm (U- to H-band) to a limiting magnitude of R \u223c 20 (3600sec, S/N \u223c 10). It shall be hosted at the Nasmyth focus of the New Technology Telescope (NTT) at La Silla Observatory, Chile (see1 for an overview). This paper describes the design of the SOXS quality check and data-flow system. Details of each of the other SOXS subsystems can be found in a set of related papers , see.1\u201328 A peculiarity of this instrument, as described in Asquini et al 2022 SPIE in press, the instrument will be operated in the ESO La Silla-Paranal Observatory operation environment without an astronomer on the mountain. From this stems the need to design and develop a suite of software that can autonomously organize and manage the night both in advance (for scientists to approve and scrutinize) and to monitor the health of the instrument. In this paper we focus on the Quality Check System architecture that has been implemented for SOXS."
        },
        {
            "heading": "2. THE SOXS PIPELINE - THE FIRST BLOCK FOR THE QUALITY CONTROL",
            "text": "As described in Young et al 2022 SPIE in press, the main purpose of the SOXS Data Reduction pipeline is to use SOXS calibration data to remove all instrument signatures and deliver Phase 3 compliant science data products. The pipeline also measures parameters on calibration product and intermediate product to assess both the quality of the data and the health of the instrument. The schema shown in Figure 1 reports how the SOXS pipeline interacts with Quality Check Systems by using FITS headers."
        },
        {
            "heading": "3. A NO-SQL APPROACH DATABASE",
            "text": "The Quality Check control for SOXS will store time-series data that will be presented to the user in order to produce both (a) a first glance table that summarises the status of instrument, by comparing measured values on the images with those expected by design (RON, dark,..), and (b) provide interactive plots that can be used to better understand trends, outliers, etc. Since the structure of the database, the number of monitored Quality Checks and the data structure in general will be fluid both during the design of the instrument and during the operations we decided to adopt a MongoDB no SQL database to store our data points. The noSQL databases have the great advantage to be fast against certain queries and flexible with respect to the underlying data structure (no a-priori design of the data structure is needed). They basically store each datum as a JSON file in sets called collections. We exploit this to fact to design the overall architecture of our databases as reported in Figure 2. Briefly, for each arm of the instrument we define in our MongoDB cluster a database that contain JSON documents that are organized in Collections as in the sample of Figure 3. For each group of Quality Checks that we intend to maintain under control (dark current, efficiencies, Signal-to-Noise ratio reached, etc.) we define a MongoDB Collection (which is no more than a set of document) to store a JSON document for each measured data-point which contain the measured value with proper unit and a set of metadata used to identify the datapoint. Those metadata are the qcname (a mnemonic label that will be displayed on the Web Application) and the group name which the quality check belongs to. For example, as shown in Figure 3 in the Collection format stability we will measure a number wavelength calibration quality checks in the group called wavecal slit. The quality check value diffy rms which measures the rms on the wavelenght calibration belongs to the collection Format Stability in the group wavecal slit.Finally, for keeping the data up-to-date a deamon, running on the pipeline machine, checks for new calibration, intermediate and final product on the filesystem. If new files are found, then the header is parsed and a JSON document is sent to the MongoDB database cluster in the proper collection for storage (see Figure 4)."
        },
        {
            "heading": "4. THE WEB APPLICATION",
            "text": "In order to present data to the end-user and to the operation team, a proper Web Application with state-of-the art responsive tecnologies has been developed.\nThe application is in charge to present a Dashboard (see Figure 5) where the global health status of the instrument is presented. If the series of monitored quality check parameters is OK, a green tick is reported while a red mark is shown when parameters are 1-sigma out of the expected nominal value coming from design (or actual measurements during the Commissioning Phase in La Silla).\nThe Web application is also capable to show, for each monitored quality check, a detailed and interactive graph that could be used by the operation team to debug problems on the instrument or to monitor trends on relevant parameters of the detector (such as the dark current, the fixed pattern noise, etc.). Figure 6 and Figure 7 report a detailed view of the graph available for each quality check. The user, by moving the cursor on the plot line, could read the values and their goodness indicated by green or red marks.\nThe application allows also to download the data, selecting date range and relevant quality checks, in CSV or TXT format for offline analyses with other third-party tools if needed."
        },
        {
            "heading": "5. ALARMING",
            "text": "An important part of the monitor system of SOXS is the automatic alarm feature present on the system. In particular, by adopting Cloud Based services offered by Amazon Web Services (see e.g.29 ) the system is able to notify the operation team of a faulty monitored quality check by email or SMS. This methodology, coupled with the presented web-based dashboard, allows a very quick instrument monitoring by the operation team both in Europe and Chile and to discover as soon as possible drifting key parameters of SOXS in advance."
        }
    ],
    "title": "The Quality Check system architecture for Son-Of-X-Shooter SOXS",
    "year": 2022
}