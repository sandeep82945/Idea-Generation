{
    "abstractText": "Diffuse scattering of electromagnetic waves from natural and artificial surfaces has been extensively studied in various disciplines, including radio wave propagation, and several diffuse scattering models based on different approaches have been proposed over the years, two of the most popular ones being Kirchhoff Theory and the so-called Effective Roughness heuristic model. The latter, although less rigorous than the former, is more flexible and applicable to a wider range of real-world cases, including non-Gaussian surfaces, surfaces with electrically small correlation lengths and scattering from material inhomogeneities that are often present under the surface. Unfortunately, the Effective Roughness model, with the exception of its Lambertian version, does not satisfy reciprocity, which is an important physical-soundness requirement for any propagation model. In the present work, without compromising its effectiveness and its simple and yet sound power-balance approach, we propose a reciprocal version of the Effective Roughness model, which can be easily implemented and replaced to the old version in ray-based propagation models. The new model is analyzed and compared to the old one and to other popular models. Once properly calibrated, it is shown to yield similar if not better performance with respect to the old one when checked vs. measurements.",
    "authors": [
        {
            "affiliations": [],
            "name": "Enrico M.Vitucci"
        },
        {
            "affiliations": [],
            "name": "Nicol\u00f2 Cenni"
        },
        {
            "affiliations": [],
            "name": "Franco Fuschini"
        }
    ],
    "id": "SP:d5125b7f09a7790752f0e02a7073c74619ec398a",
    "references": [
        {
            "authors": [
                "N.L. Felsen"
            ],
            "title": "Marcuvitz, Radiation and Scattering of Waves",
            "venue": "New York: IEEE Press,",
            "year": 1973
        },
        {
            "authors": [
                "V. Degli-Esposti",
                "H. Bertoni"
            ],
            "title": "Evaluation of the role of diffuse scattering in urban microcellular propagation",
            "venue": "Gateway to 21st Century Communications Village. VTC 1999-Fall. IEEE VTS 50th Vehicular Technology Conference (Cat. No.99CH36324), vol. 3, 1999, pp. 1392\u2013 1396 vol.3.",
            "year": 1999
        },
        {
            "authors": [
                "V. Degli-Esposti"
            ],
            "title": "A diffuse scattering model for urban propagation prediction",
            "venue": "IEEE Trans. Antennas Propag., vol. 49, no. 7, pp. 1111\u2013 1113, 2001.",
            "year": 2001
        },
        {
            "authors": [
                "V. Degli-Esposti",
                "F. Fuschini",
                "E.M. Vitucci",
                "G. Falciasecca"
            ],
            "title": "Measurement and modelling of scattering from buildings",
            "venue": "IEEE Trans. Antennas Propag., vol. 55, no. 1, pp. 143\u2013153, 2007.",
            "year": 2007
        },
        {
            "authors": [
                "E.M. Vitucci",
                "J. Chen",
                "V. Degli-Esposti",
                "J.S. Lu",
                "H.L. Bertoni",
                "X. Yin"
            ],
            "title": "Analyzing radio scattering caused by various building elements using millimeter-wave scale model measurements and ray tracing",
            "venue": "IEEE Trans. Antennas Propag., vol. 67, no. 1, pp. 665\u2013669, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "V. Degli-Esposti",
                "D. Guiducci",
                "A. de\u2019Marsi",
                "P. Azzi",
                "F. Fuschini"
            ],
            "title": "An advanced field prediction model including diffuse scattering",
            "venue": "IEEE Trans. Antennas Propag., vol. 52, no. 7, pp. 1717\u20131728, 2004.",
            "year": 2004
        },
        {
            "authors": [
                "F. Mani",
                "F. Quitin",
                "C. Oestges"
            ],
            "title": "Directional spreads of dense multipath components in indoor environments: Experimental validation of a ray-tracing approach",
            "venue": "IEEE Trans. Antennas Propag., vol. 60, no. 7, pp. 3389\u20133396, 2012.",
            "year": 2012
        },
        {
            "authors": [
                "E.M. Vitucci",
                "F. Mani",
                "V. Degli-Esposti",
                "C. Oestges"
            ],
            "title": "Polarimetric properties of diffuse scattering from building walls: Experimental parameterization of a ray-tracing model",
            "venue": "IEEE Trans. Antennas Propag., vol. 60, no. 6, pp. 2961\u20132969, 2012.",
            "year": 2012
        },
        {
            "authors": [
                "F. Mani",
                "E.M. Vitucci",
                "F. Quitin",
                "V. Degli-Esposti",
                "C. Oestges"
            ],
            "title": "Parameterization of a polarimetric diffuse scattering model in indoor environments",
            "venue": "IEEE Trans. Antennas Propag., vol. 62, no. 8, pp. 4361\u2013 4364, 2014.",
            "year": 2014
        },
        {
            "authors": [
                "E.M. Vitucci",
                "L. Tarlazzi",
                "F. Fuschini",
                "P. Faccin",
                "V. Degli- Esposti"
            ],
            "title": "Interleaved-MIMO DAS for indoor radio coverage: Concept and performance assessment",
            "venue": "IEEE Trans. Antennas Propag., vol. 62, no. 6, pp. 3299\u20133309, 2014.",
            "year": 2014
        },
        {
            "authors": [
                "V. Degli-Esposti",
                "F. Fuschini",
                "E.M. Vitucci",
                "M. Barbiroli",
                "M. Zoli",
                "L. Tian",
                "X. Yin",
                "D. Dupleich",
                "R. Muller",
                "C. Schneider"
            ],
            "title": "Raytracing based mm-wave beamforming assessment",
            "venue": "IEEE Access, vol. 2, 2014.",
            "year": 2014
        },
        {
            "authors": [
                "F. Fuschini",
                "M. Zoli",
                "E.M. Vitucci",
                "M. Barbiroli",
                "V. Degli-Esposti"
            ],
            "title": "A study on millimeter-wave multiuser directional beamforming based on measurements and ray tracing simulations",
            "venue": "IEEE Trans. Antennas Propag., vol. 67, no. 4, pp. 2633\u20132644, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "E.M. Vitucci",
                "V. Degli-Esposti",
                "F. Mani",
                "F. Fuschini",
                "M. Barbiroli",
                "M. Gan",
                "C. Li",
                "J. Zhao",
                "Z. Zhong"
            ],
            "title": "Tuning ray tracing for mmwave coverage prediction in outdoor urban scenarios",
            "venue": "Radio Science, vol. 54, no. 11, pp. 1112\u20131128, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "F. Sheikh",
                "Y. Gao",
                "T. Kaiser"
            ],
            "title": "A study of diffuse scattering in massive MIMO channels at terahertz frequencies",
            "venue": "IEEE Trans. Antennas Propag., vol. 68, no. 2, pp. 997\u20131008, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "C. Jansen",
                "S. Priebe",
                "C. M\u00f6ller",
                "M. Jacob",
                "H. Dierke",
                "M. Koch",
                "T. K\u00fcrner"
            ],
            "title": "Diffuse scattering from rough surfaces in THz communication channels",
            "venue": "IEEE Trans. Terahertz Sci. Technol., vol. 1, no. 2, pp. 462\u2013472, 2011.",
            "year": 2011
        },
        {
            "authors": [
                "P. Beckmann",
                "A. Spizzichino"
            ],
            "title": "The scattering of electromagnetic waves from rough surfaces",
            "year": 1963
        },
        {
            "authors": [
                "L. Tsang",
                "J. Kong",
                "K.-H. Ding"
            ],
            "title": "Scattering of Electromagnetic Waves: Theories and Applications",
            "venue": "Hoboken, New Jersey: John Wiley and Sons, Ltd,",
            "year": 2000
        },
        {
            "authors": [
                "P. Pongsilamanee",
                "H.L. Bertoni"
            ],
            "title": "Specular and nonspecular scattering from building fa\u00e7ades",
            "venue": "IEEE Trans. Antennas Propag., vol. 52, no. 7, pp. 1879\u20131889, 2004.",
            "year": 1879
        },
        {
            "authors": [
                "V. Degli-Esposti",
                "F. Fuschini",
                "E.M. Vitucci"
            ],
            "title": "A fast model for distributed scattering from buildings",
            "venue": "2009 3rd European Conference on Antennas and Propagation, 2009, pp. 1932\u20131936.",
            "year": 2009
        },
        {
            "authors": [
                "F. Fuschini",
                "V. Degli-Esposti",
                "E.M. Vitucci"
            ],
            "title": "A model for forwarddiffuse scattering through a wall",
            "venue": "Proceedings of the Fourth European Conference on Antennas and Propagation, 2010, pp. 1\u20134.",
            "year": 2010
        },
        {
            "authors": [
                "L. Minghini",
                "R. D\u2019Errico",
                "V. Degli Esposti",
                "E.M. Vitucci"
            ],
            "title": "Electromagnetic simulation and measurement of diffuse scattering from building walls",
            "venue": "The 8th European Conference on Antennas and Propagation (EuCAP 2014), 2014, pp. 1298\u20131302.",
            "year": 2014
        },
        {
            "authors": [
                "J. Pascual-Garc\u0131\u0301a",
                "J.-M. Molina-Garc\u0131\u0301a-Pardo",
                "M.-T. Mart\u0131\u0301nez-Ingl\u00e9s",
                "J.-V. Rodr\u0131\u0301guez",
                "N. Saur\u0131\u0301n-Serrano"
            ],
            "title": "On the importance of diffuse scattering model parameterization in indoor wireless channels at mmwave frequencies",
            "venue": "IEEE Access, vol. 4, pp. 688\u2013701, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "F. Fuschini",
                "S. H\u00e4fner",
                "M. Zoli",
                "R. M\u00fcller",
                "E.M. Vitucci",
                "D. Dupleich",
                "M. Barbiroli",
                "J. Luo",
                "E. Schulz",
                "V. Degli-Esposti",
                "R.S. Thom\u00e4"
            ],
            "title": "Item level characterization of mm-wave indoor propagation",
            "venue": "Eurasip J. Wirel. Commun. Netw., vol. 2016, no. 4, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "B. Duvenhage",
                "K. Bouatouch",
                "D.G. Kourie"
            ],
            "title": "Numerical verification of bidirectional reflectance distribution functions for physical plausibility",
            "venue": "Proceedings of the South African Institute for Computer Scientists and Information Technologists Conference, ser. SAICSIT \u201913, 2013, p. 200\u2013208.",
            "year": 2013
        },
        {
            "authors": [
                "B. Walter",
                "S. Marschner",
                "H. Li",
                "K.E. Torrance"
            ],
            "title": "Microfacet models for refraction through rough surfaces",
            "venue": "Rendering Techniques, 2007.",
            "year": 2007
        },
        {
            "authors": [
                "J.-F. Wagen"
            ],
            "title": "Diffuse scattering and specular reflection from facets of arbitrary size and roughness using the computer graphics GGX model",
            "venue": "2020 International Symposium on Networks, Computers and Communications (ISNCC), 2020, pp. 1\u20135.",
            "year": 2020
        },
        {
            "authors": [
                "M. Saillard",
                "G. Soriano"
            ],
            "title": "Rough surface scattering at low-grazing incidence: A dedicated model",
            "venue": "Radio Science, vol. 46, no. 5, 2011.",
            "year": 2011
        },
        {
            "authors": [
                "S. Priebe",
                "M. Jacob",
                "C. Jansen",
                "T. K\u00fcrner"
            ],
            "title": "Non-specular scattering modeling for THz propagation simulations",
            "venue": "Proceedings of the 5th European Conference on Antennas and Propagation (EUCAP), 2011, pp. 1\u20135.",
            "year": 2011
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014Radio Propagation, Building Walls, Irregular Surfaces, Diffuse Scattering, RF Coverage, Field Reciprocity, Power Conservation, Ray Tracing.\nI. INTRODUCTION\nDiffuse scattering (DS) of radio waves, intended here as non-specular reflection from terrain, objects and building walls surfaces due to surface roughness or material irregularities, has been studied for years in many application fields such as remote sensing and optics.\nWith reference to radio propagation in urban environment, assuming flat, smooth and homogeneous building walls or indoor furniture panels, propagation can be conveniently analyzed using the Geometrical Optics (GO) approximation [1],\nManuscript received September 4, 2022; revised March 7, 2022; accepted May 13, 2023.\nCorresponding author: Enrico M. Vitucci This work was supported by the European Union under the Italian National Recovery and Resilience Plan (NRRP) of NextGenerationEU, partnership on \u201cTelecommunications of the Future\u201d (PE00000014 - program \u201cRESTART\u201d). The work is also supported in part by the Eu Project 6G-SHINE (6G SHort range extreme communication IN Entities), Horizon Europe Programme, Grant No. 101095738, and by the Eu COST Action INTERACT (IntelligenceEnabling Radio Communications for Seamless Inclusive Interactions), Grant CA20120.\nAll the Authors are with the Department of Electrical, Electronic, and Information Engineering \u201dGuglielmo Marconi\u201d (DEI), CNIT, University of Bologna, 40126 Bologna, Italy (e-mail: enricomaria.vitucci, nicolo.cenni2, franco.fuschini, v.degliesposti @unibo.it).\nwhere radio wave interactions can be modeled as specular reflections, transmissions and edge diffractions.\nHowever, perfectly smooth slabs are rarely present in reallife, especially in dense urban areas where building walls can show relevant deviations from smooth homogeneous layers, such as compound materials, windows frames, metal reinforcements, pillars, rough plaster and brick surfaces, cables, advertising boards, etc. Similar considerations hold true for indoor walls and furniture. In fact, some investigations showed that DS due to such details - often disregarded in building maps and databases - can be an important propagation mechanism in urban environment [2]\u2013[5]. In particular, DS has been shown to generate a large part of the time-domain, angle-domain and polarization dispersion of the multipath radio channel in most environments [6]\u2013[9], and the knowledge of this phenomena can be exploited in the design of MIMO wireless links and to implement advanced beamforming strategies [10]\u2013[12]. Moreover, DS has been shown to play a prominent role even in the determination of the actual Radio frequency (RF) coverage level, especially in Non Line of Sight (NLoS), millimeterwave frequency applications [13]. Recent studies have also highlighted the importance of DS from rough surfaces in Terahertz wireless communications links [14]\u2013[16]. Therefore, accounting for specular reflection, transmission and diffraction is not sufficient: analysis and modeling of diffuse scattering is mandatory to achieve a complete understanding of urban radio propagation.\nThe most widely known diffuse scattering models available in the literature only deal with surface roughness, and include Kirchhoff Theory, the Small Perturbation Method and the Integral Equation Method [17], [18]. The most popular approach to DS is Kirchhoff Theory, based on BeckmannKirchhoff theory for scattering of incident plane waves from Gaussian rough surfaces described in terms of roughness\u2019 standard deviation and correlation distance [17]. Another diffuse scattering approach developed specifically for building walls and derived from physical optics is proposed in [19]: here the assumption is that non-specular scattering from the fac\u0327ades of large buildings is dominated by windows and decorative masonry, whose placement tends to be nearly periodic.\nHowever, Kirchhoff Theory is not applicable to nonGaussian surface roughness, to strong surface irregularities where the roughess\u2019 correlation length is comparable to, or smaller than, the wavelength (e.g. indentations), or when the surface size is comparable to, or smaller than, correlation length. Moreover all the cited models are not suitable to cases where the presence of internal, material irregularities\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/"
        },
        {
            "heading": "IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. XX, NO. YY, MONTH 202X 2",
            "text": "have a significant impact. The possibility for radiowaves to penetrate inside the wall, undergo scattering interactions due to the internal inhomogeneities and re-emerge with nearly random propagation direction and characteristics must also be accounted for.\nTherefore, in more recent years heuristic models like the Effective Roughness (ER) model [4] have been proposed to overcome the foregoing limitations. The ER model is aimed at modeling non-specular scattering from surfaces, but its parameters are not actual surface roughness parameters as for the Kirchhoff model, they are \u201deffective\u201d parameters that must take into account also the effect of the more general irregularities and details described above, hence the name \u201dEffective Roughness\u201d model. Thanks to its heuristic nature, the ER model can account for the effect of any kind of surface or volume inhomogeneity, without restriction with respect to its statistical characteristics. Differently from the Kirchhoff model, the specular reflected wave and the scattered wave are treated from the beginning as distinct waves where the attenuation of the former is due to part of its power being diverted into the latter by irregularities. This fact allows its straightforward, \u201cplug-and-play\u201d integration into ray-based models where specular reflection and transmission are implemented as phase-coherent waves that follow GO theory, albeit with a proper attenuation, while diffuse scattering can have different spatial and polarization characteristics.\nThe ER model is physically consistent as it is based on a power balance between specular reflection, transmission and scattering. It is flexible because the scattering pattern can be chosen among several different options, and due to its simplicity and low number of parameters it can be easily tuned vs. measurement data.\nAfter its introduction in 2007, analytical formulations of the ER model have been developed to describe the anglespread produced by DS from a single wall [20], it has been extended to transmitted scattering in the forward half-space (e.g. beyond a wall) [21] and has been further validated vs. full-wave electromagnetic simulations and measurements in reference cases [22]. The parameterization of the ER model in the mm-wave bands for different construction materials has also been discussed in [23], [24]. Furthermore, the ER model has been finally embedded into some commercial ray based field prediction software tools [25].\nDespite its strengths, the original - or legacy - ER model also has an important shortcoming: with the exception of its Lambertian scattering pattern version, it doesn\u2019t fully satisfy reciprocity, which means that the predicted scattered field intensity is not invariant with respect to the exchange of transmitter and receiver, as it should be according to propagation theory [26]. Although, being a heuristic model, its fitting to the actual physical process can always be adjusted through parameter calibration, non-reciprocity represents an important theoretical flaw, especially considering that its non-reciprocal, directive scattering versions have been shown to be the most suitable to describe DS from real buildings [4].\nOther models similar to the ER model that satisfy reciprocity have been developed for computer graphic applications [27], [28], or have been derived from them [29]. However, such\nmodels do not distinguish specular from diffuse reflection and therefore cannot be easily implemented into existing ray-based propagation models. Moreover, although power constraints are present, such as that the back-scattered power cannot be greater than the incident power, they don\u2019t comply with a clear power conservation balance at the surface in order to minimize parameters and to achieve maximum compatibility with traditional formulations based on Geometrical Optics for smooth surfaces and material slabs.\nIn the present work, starting from the approach of the original ER model, we first develop a better and more complete mathematical derivation of its normalization factors with respect to the rather incomplete demonstration provided in [4], using Euler\u2019s Gamma and Beta functions. Then we propose a new version of the ER model that satisfies reciprocity without sacrificing the original power-balance assumptions, if not to a negligible extent for grazing incidence. We also provide a discussion on reciprocity and power balance of the new ER model with respect to the original formulation, and a comparison with respect to other reference models (e.g. Kirchhoff). Finally, the model is validated through comparison with measurements in a reference case.\nThe paper is organized as follows. In Section II, some background on the original ER model and its formulation are provided, then the new reciprocal formulation is presented (the mathematical details are provided in the appendices). In Section III, comparisons to the legacy ER model, to other reference models and to measurements are shown and discussed. Finally, conclusions are drawn in Section IV."
        },
        {
            "heading": "II. THE NEW ER MODEL\u2019S FORMULATION",
            "text": ""
        },
        {
            "heading": "A. Background on the ER Model",
            "text": "When a surface element dS is illuminated by an impinging electromagnetic wave, the following power balance must hold:\nPi = Pr + Ps + Pp (1)\nbeing Pi, Pr, Ps and Pp the incident, the reflected, the scattered and transmitted powers, respectively (Fig. 1).\nThe basic assumption of the ER approach is that the scattered power can be simply related to a scattering coefficient S \u2208 [0, 1] as:\nPs = S 2 \u00b7 ( U2Pi ) (2)\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/"
        },
        {
            "heading": "IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. XX, NO. YY, MONTH 202X 3",
            "text": "Depending on the value of U , S2 represents the percentage of either the incident (U = 1) or the reflected power (U = \u0393, being \u0393 = \u2223\u2223E\u0304r\u2223\u2223 / \u2223\u2223E\u0304i\u2223\u2223 the modulus of the reflection coefficient) that is spread in non specular directions [4]. In the following, DS is supposed to occur at the expense of specular reflection, i.e. U = \u0393 is considered in eq. (2).\nTherefore, the power balance (1) can be written as:\n1 = \u03932R2 + \u03932S2 + Pp/Pi (3)\nwhere R is the reflection reduction factor, which is related to the so called \u201dRayleigh\u2019s factor\u201d of Kirchhoff theory [17]. By assuming that the ratio Pp/Pi does not depend on the degree of roughness, i.e. on the parameter S, from (3) we easily get that the reflection reduction factor is [4]: R = \u221a 1\u2212 S2.\nPower balance assumptions of the legacy ER model (referred to as ER power-balance in the following), represented by eq. (2) and (3), imply the following equation where power diverted from specular reflection equals the integral of the scattered field power density over the backscattering half space, i.e. (Fig. 1)\nPs = S 2\u03932Pi = S 2\u03932 \u2223\u2223E\u0304i\u2223\u22232 2\u03b7 \u2206\u2126i r 2 i =\n= \u222b 2\u03c0 0 \u222b \u03c0 2 0 \u2223\u2223E\u0304S\u2223\u22232 2\u03b7 r2S sin \u03b8S d\u03b8S d\u03d5S\n(4)\nwhere ri, rS are the distances between the surface element dS and the source, and between dS and the observation point, respectively, \u2206\u2126i is the solid angle subtended from dS at the transmitter side (see Fig.1), and \u03b7 = \u221a \u00b50/\u03f50 is the free-space impedance. Moreover, the squared amplitude of the scattered field is assumed to be expressed by the following formula:\u2223\u2223E\u0304S (\u03b8i, \u03d5i, \u03b8S , \u03d5S)\u2223\u22232 = E2S0 \u00b7 f(\u03b8i, \u03d5i, \u03b8S , \u03d5S) (5) where f (\u03b8i, \u03d5i, \u03b8S , \u03d5S) \u2208 [0, 1] represents the diffuse scattering spatial pattern. The overall scattered field is then modelled as a non-uniform spherical wave.\nAssuming the surface element dS in the far field region of the transmitting source, the incident field is a spherical wave, and therefore:\u2223\u2223E\u0304i (ri, \u03b8i, \u03d5i)\u2223\u2223 = \u221a60 Pt gt (\u03b8i, \u03d5i)\nri = Ki (\u03b8i, \u03d5i) ri (6)\nwhere Ki (\u03b8i, \u03d5i) is a parameter depending on the source properties (transmit power, antenna gain). By substituting (5) and (6) into (4) and exploiting the expression for the solid angle \u2206\u2126i = dS cos \u03b8ir2i , the following formula can be achieved:\n\u2223\u2223E\u0304S\u2223\u22232 = ( KiS ri rS )2 \u03932 dS cos \u03b8i\nF (\u03b8i, \u03d5i)\ufe38 \ufe37\ufe37 \ufe38 E2S0\n\u00b7f (\u03b8i, \u03d5i, \u03b8S , \u03d5S) (7)\nwhere F (\u03b8i, \u03d5i) represents the following integral expression:\nF (\u03b8i, \u03d5i) = \u222b 2\u03c0 0 \u222b \u03c0 2 0 f(\u03b8i, \u03d5i, \u03b8S , \u03d5S)sin \u03b8S d\u03b8S d\u03d5S (8)\nIt can be observed that, according to (7), \u2223\u2223E\u0304S\u2223\u2223 = 0 for any observation angle, when the incident wave is parallel to the surface element, i.e. \u03b8i = \u03c0/2: in fact, for grazing incidence, no power is captured and then scattered by the surface.\nIt is worth noting that, in order to have a reciprocal expression for the intensity of the scattered field \u2223\u2223E\u0304S\u2223\u2223, the product of the three functions in (7) needs to be reciprocal, i.e.:\nf (\u03b8i, \u03d5i, \u03b8S , \u03d5S)\nF (\u03b8i, \u03d5i) \u00b7 cos \u03b8i = grec (\u03b8i, \u03d5i, \u03b8S , \u03d5S) (9)\nwhere grec is a reciprocal function, i.e. a function invariant to the exchange of (\u03b8i, \u03d5i) with (\u03b8S , \u03d5S).\nThe former version of the scattering model in [4] was aimed at a single-lobe, directive scattering pattern by means of the following choice:\nf (\u03b8i, \u03d5i, \u03b8S , \u03d5S) =\n( 1 + cos\u03c8R\n2\n)\u03b1R \u03b1R \u2208 N (10)\nwhere the exponent \u03b1R is a tuning parameter for the directivity of the scattering pattern (the greater \u03b1R, the narrower the lobe), and \u03c8R is the angle between the scattering direction (\u03b8S , \u03d5S) and the specular direction (Fig. 1). The following relation is also provided in [4]:\ncos\u03c8R = cos \u03b8i cos \u03b8S \u2212 sin \u03b8i sin \u03b8S cos (\u03d5S \u2212 \u03d5i) (11)\nBy applying the power balance (4), equation (7) becomes:\u2223\u2223E\u0304S\u2223\u22232 = (KiS ri rS )2 \u03932 dS cos \u03b8i F\u03b1R (\u03b8i) ( 1 + cos \u03c8R 2 )\u03b1R (12)\nwhere F\u03b1R is the solution of the integral in (8), when (10) is enforced [4]. Note that with the chosen shape for the scattering pattern in eq. (10), F\u03b1R does not depend on the azimuth angle \u03d5i, for symmetry reasons.\nA complete solution for F\u03b1R was not derived in [4]: however, two different, closed-form expressions were proposed, depending on whether \u03b1R is even or odd.\nInstead, a more compact and general expression for F\u03b1R is fully derived in this work, by exploiting the properties of the Euler\u2019s Beta function (Appendix A). The new closed-form solution valid for any value of \u03b1R is (see Appendix B):\nF\u03b1R (\u03b8i) = 2\u03c0 \u03b1R!\n2\u03b1R \u03b1R\u2211 j=0\n1\n(\u03b1R \u2212 j)! (j + 1)!! \u00b7\n\u00b7 \u230aj/2\u230b\u2211 l=0 cosj\u22122l \u03b8i sin 2l \u03b8i 2l l! (j \u2212 2l)!! 0 \u2264 \u03b8i < \u03c0 2\n(13)\nwhere \u230ax\u230b stands for the greatest integer less than or equal to x, and the ! and !! symbols stand for the factorial and double factorial functions, respectively (see Appendix A). In the case of normal incidence (\u03b8i = 0), (13) reduces to:\nF\u03b1R (0) = 4\u03c0\n\u03b1R + 1\n( 1\u2212 1\n2\u03b1R+1 ) Looking at equations (12) and (13), it is evident that the\namplitude of the scattered field \u2223\u2223E\u0304S\u2223\u22232 is non reciprocal, due to the presence in (13) of the functions (cos \u03b8i)m and (sin \u03b8i)m, which are not counterbalanced by similar terms containing the scattering elevation angle \u03b8S .\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/"
        },
        {
            "heading": "IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. XX, NO. YY, MONTH 202X 4",
            "text": ""
        },
        {
            "heading": "B. The new reciprocal formulation",
            "text": "The aim is to achieve a reciprocal expression for the scattered field. To this extent, we propose the following new expression for the diffuse scattering pattern:\nf (\u03b8i, \u03d5i, \u03b8S , \u03d5S) = \u221a cos \u03b8S ( 1 + cos\u03c8R\n2\n)\u03b1R \u03b1R \u2265 1\n(14) Such scattering function is obtained by multiplying the pattern of the legacy ER model, i.e. (10), by the factor\u221a cos \u03b8S . With this assumption, the scattered power tends to zero for grazing observation angles, i.e. when \u03b8S approaches \u03c0/2. This is a necessary condition for reciprocity: in fact, according to (7),\n\u2223\u2223E\u0304S\u2223\u2223 = 0 for \u03b8i = \u03c0/2, no matter what is the observation angle \u03b8S as the solid angle \u2206\u2126i goes to zero; similarly, it must be\n\u2223\u2223E\u0304S\u2223\u2223 = 0 for \u03b8S = \u03c0/2, independently from the incidence angle \u03b8i.\nBesides, it can be observed that the multiplication of (10) by \u221a cos \u03b8S causes a skew of the maximum of the scattering pattern with respect to specular reflection. This disaligment is of the order of a few degrees, and is more evident for grazing incidence angles, and low values of the parameter \u03b1R: some examples will be shown and discussed in Section III.\nLet\u2019s now discuss more in detail the reciprocity of the new model\u2019s formulation. In order for the model to be reciprocal, according to eq. (9) the following condition must be satisfied:\ncos \u03b8i F\u03b1R\n\u221d \u221a cos \u03b8i (15)\nwhich implies: F\u03b1R \u221d \u221a cos \u03b8i.\nActually, it can be observed that F\u03b1R that would result from (14) being inserted into (8), i.e. which satisfies ER power-balance, is a monotonic decreasing function having its maximum value for \u03b8i = 0, that can be well approximated by a function proportional to \u221a cos(\u03b8i), as shown in Fig. 2.\nThis means that, if we assume F\u03b1R \u221d \u221a\ncos(\u03b8i), reciprocity is strictly satisfied, while also ER power-balance is satisfied to a good extent.\nIn fact, Fig. 2 shows F\u03b1R (\u03b8i) /F\u03b1R (0) derived from (8) through numerical integration for 3 different values of the\nparameter \u03b1R, vs. the function \u221a cos \u03b8i. It can be observed that the approximation is very good except for very grazing incidence angles (e.g. greater than 85\u25e6). This allows to write F\u03b1R in the form:\nF\u03b1R (\u03b8i) \u2248 k (\u03b1R) \u221a cos \u03b8i (16)\nwhere k (\u03b1R) is an amplitude parameter depending only on the exponent \u03b1R. This approximation satisfies both eq. (9) (i.e. reciprocity) and, with good approximation, eq. (8) (i.e. ER power-balance).\nThe value of k (\u03b1R) can be determined in a straightforward way by assuming the approximation (16) as valid and solving the integral (8) for \u03b8i = 0, as shown in Appendix C.\nThen, the final reciprocal expression of the scattered field when (14) is enforced and under the approximation (16) is (see Appendix C):\u2223\u2223E\u0304S\u2223\u22232 =(KiS\nri rS\n)2 \u03932 dS\nk (\u03b1R) \u00b7\n\u00b7 \u221a cos \u03b8i cos \u03b8S ( 1 + cos\u03c8R\n2 )\u03b1R (17) with\nk (\u03b1R) = 4\u03c0\n2\u03b1R \u03b1R\u2211 j=0 ( \u03b1R j ) 1 2j + 3\nThe expression used in (17) for k (\u03b1R) is valid only for integer positive values of the exponent \u03b1R, as it has been computed by using the binomial theorem (see Appendix C). However, in case real positive values of the exponent \u03b1R are needed for a finer tuning of the model, k (\u03b1R) can be calculated using the following interpolating function:\nk (\u03b1R) \u2248  (0.07937\u03b1R + 0.1745) \u22121 if \u03b1R > 4 (0.002966\u03b12R + 0.05675\u03b1R+\n+ 0.2387)\u22121 if 1 \u2264 \u03b1R \u2264 4"
        },
        {
            "heading": "C. Double lobe model, reciprocal formulation",
            "text": "Similarly to what done in [4] for the legacy ER model, it is possible to derive a double-lobe model, where an additional lobe steered in the incidence direction is added to the scattering pattern. This is useful in many practical cases, where walls with big irregularities, e.g. indentations, generate a strong backscattering component in the incidence direction trough micro interactions consisting of multiple-bounce reflections (see Fig. 3).\nIn order to obtain a reciprocal formulation for this doublelobe model, we propose the following expression for the scattered field\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/\nIEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. XX, NO. YY, MONTH 202X 5\n\u2223\u2223E\u0304S\u2223\u22232 = (KiS ri rS )2 \u03932 dS cos \u03b8i F\u03b1i,\u03b1R \u221a cos \u03b8S \u00b7\n\u00b7 [ \u039b ( 1 + cos\u03c8R\n2\n)\u03b1R + (1\u2212 \u039b) ( 1 + cos\u03c8i\n2 )\u03b1i] (18) with\nF\u03b1i,\u03b1R = \u039bF\u03b1R + (1\u2212 \u039b)F\u03b1i\nF\u03b1R = 2\u03c0\u222b 0 \u03c0 2\u222b 0 \u221a cos \u03b8S ( 1 + cos\u03c8R 2 )\u03b1R sin \u03b8Sd\u03b8Sd\u03d5S\nF\u03b1i = 2\u03c0\u222b 0 \u03c0 2\u222b 0 \u221a cos \u03b8S ( 1 + cos\u03c8i 2 )\u03b1i sin \u03b8Sd\u03b8Sd\u03d5S\n(19) where \u03c8i is the angle formed by the observation and incidence directions, \u03b1i is a parameter that accounts for the directivity of the backscattering lobe, F\u03b1i,\u03b1R is the solution of the power balance integral (8) for the double-lobe pattern, and \u039b \u2208 [0, 1] is a factor taking into account how the scattered power is subdivided between the two lobes.\nIt can be easily shown (see Appendix D) that both the integrals in (19) can be approximated by a function proportional to \u221a cos \u03b8i, i.e. F\u03b1R \u2248 k (\u03b1R) \u221a cos \u03b8i and F\u03b1i \u2248\nk (\u03b1i) \u221a cos \u03b8i. If so, also F\u03b1i,\u03b1R is proportional to \u221a cos \u03b8i, and this allows to get a reciprocal expression for the scattered field. The final (reciprocal) expression of the scattered field for the double-lobe ER model is then:\n\u2223\u2223E\u0304S\u2223\u22232 =(KiS ri rS )2 \u03932 dS 4\u03c0 \u221a cos \u03b8i cos \u03b8S \u00b7\n\u00b7 \u039b 2\u03b1R\u03b1R\u2211 j=0 ( \u03b1R j ) 1 2j+3 ( 1 + cos\u03c8R 2 )\u03b1R +\n+(1\u2212 \u039b) 2 \u03b1i \u03b1i\u2211 j=0 ( \u03b1i j ) 1 2j+3\n( 1 + cos\u03c8i\n2\n)\u03b1i\n(20)\nNote also that (17) is obtained as a particular case of (20), when \u039b=1."
        },
        {
            "heading": "III. COMPARISONS",
            "text": ""
        },
        {
            "heading": "A. Comparison with existing models",
            "text": "The new, Reciprocal ER model (RER model in the following) is discussed and compared with the legacy ER model and other models in this section.\nThe shape of its scattering pattern lobe is shown in Fig. 4 for different incidence angles and \u03b1R values. The lobe\u2019s directivity increases with \u03b1R, as it should, and its maximum is directed toward the specular direction. However, differently\nfrom the legacy ER model, the lobe is always constrained to have a null for \u03b8S = \u03c0/2 in order to satisfy reciprocity as explained in section II.B. Consequently, a slight drifting of the peak away from the specular direction toward lower \u03b8S values can be observed for incidence angles greater than \u03c0/3 and low \u03b1R values.\nAs stated above, the new formulation of the ER model was derived to satisfy reciprocity. The old ER model however, was already almost reciprocal for not-too-grazing incidence angles (up to about 40\u25e6), and for low values of \u03b1R, as shown in Fig. 5, where the term cos \u03b8i/F\u03b1R (\u03b8i, \u03d5i) of eq. (9) is almost constant and therefore reciprocity condition is approximately satisfied. On the other hand, it strictly respects the ER power balance, based on which it was conceived.\nVice versa, the new ER model is perfectly reciprocal but its reciprocal formulation was obtained from an approximation that slightly differs from the numerical solution of the powerbalance integral (8), especially for very grazing angles of incidence, as explained in section II.B. It is worth noting however, that reciprocity is a more important requirement than ER power-balance, since the latter is based on the simplifying yet reasonable assumption that the quantity Pp/Pi of equation (3) does not depend on parameter S, which might not be rigorously true in real-life cases.\nIn order to quantify the influence of the approximation in the power balance integral (8), we can introduce the powerbalance anomaly, which is normalized to the incident power Pi, and defined as:\n\u2206rel = P\u0302s \u2212 Ps Pi\n(21)\nwhere Ps is the scattered power obtained through the original power balance assumptions, i.e. through solution of the integral (8) to determine the value of F\u03b1R (\u03b8i), while P\u0302s is the corresponding value obtained by using the approximation F\u03b1R (\u03b8i) \u2248 k (\u03b1R) \u221a cos \u03b8i.\nThrough a few simple mathematical steps, the following expression for \u2206rel can be derived:\n\u2206rel = S 2\u03932\n( F\u03b1R (\u03b8i)\nk (\u03b1R) \u221a cos \u03b8i\n\u2212 1 )\n(22)\nThe power-balance anomaly \u2206rel of the new ER model is plotted vs. \u03b8i in Fig. 6, assuming S = 0.4, while the modulus of the reflection coefficient \u0393 was calculated with the Fresnel coefficient (TE polarization) for the case of a lossless dielectric wall with \u03f5r = 5. It is evident that \u2206rel is very small, within 1 % of the incident power up to incident angles of 85 degrees or more!\nIt is interesting to compare the behaviour of the RER model with other models available in the literature, e.g. the Kirchhoff model for scattering from rough surfaces. The Kirchhoff model is a widely used reference model that, being physics-based, is reciprocal and necessarily satisfies physically consistent power-balance constraints. However, it has several parameters, it is valid only for surface roughness of the Gaussian type, with correlation length larger than the wavelength, and it also has approximations that make it invalid for grazing incidence angles, as discussed for instance in [30].\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/"
        },
        {
            "heading": "IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. XX, NO. YY, MONTH 202X 6",
            "text": "The Kirchhoff\u2019s scattering coefficient provided in [17] is made of two parts, a coherent specular component, derived from the Radar Cross Section theory, and an incoherent diffuse component which accounts for the non-specular contribution of the facets representing the irregular surface. For the sake of comparison with the RER model, in the following we consider only the incoherent component. In Fig. 7 the normalized scattering diagrams for the RER model and the Kirchhoff model (diffuse incoherent component) are compared for a 1.3 GHz incident plane wave with \u03b8i = \u03c0/3, the same case of [4], Fig. 10. The following parameters are used in the Kirchhoff model: surface roughness standard deviation \u03c3h = 1 cm and correlation length lcorr = 0.5m, which are typical literature values for a brick wall as the one considered in [4]. For comparison, the directivity parameter \u03b1R of the RER model\nhas been optimized to reproduce the same scattering lobe width as the Kirchhoff model, thus getting \u03b1R = 65, which is a much higher value with respect to what found in [4] for the brick wall case, i.e. \u03b1R = 4. The shape of the two patterns is very similar: interestingly, the maximum is slightly tilted upward with respect to the specular direction in both cases, albeit to a lesser extent in the RER model case. However, the much greater degree of spreading observed in [4] is an indication that surface elements such as indentations and material inhomogeneities (e.g. the alternation of brick and mortar, cavities inside bricks) probably give a greater contribution to DS than mere Gaussian surface roughness. Besides the aforementioned limitations, there are additional issues that make not straightforward the implementation of\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/"
        },
        {
            "heading": "IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. XX, NO. YY, MONTH 202X 7",
            "text": "the Kirchhoff model in ray-based prediction tools, as discussed for example in [31]. Moreover, as the incoherent component is computed through a series expansion, the Kirchhoff model is computational less efficient than the RER model, from 1 to 2 orders of magnitude depending on how the series is truncated.\nAnother possible approach to deal with DS from irregular surfaces is the one based on the use of computer graphics models, originally conceived for rendering of photorealistic images. Such models are based on the so called Bidirectional Reflectance Distribution Function (BRDF), which is a directional scattering coefficient. In recent years, \u201dphysicallybased\u201d BDRFs have been proposed, which obey to reciprocity and comply with upper bound power constraints, such as that Pi should always be greater than or equal to Ps [27].\nOne example is the popular GGX shading model, originally introduced in [28]. In [29], it has been proposed to use a slightly modified version of the GGX model for radio wave propagation prediction. In the model, an equivalent roughness parameter \u03a3s, expressed in dB, is used: \u03a3s = 0 dB means maximum roughness, while \u03a3s < \u221240 dB means smooth surface with quasi-specular behaviour. In particular, in [29] it is shown that, by parameterizing the GGX model to reproduce both the specular and the diffuse components and by adding them through incoherent power sum, realistic results in good agreement with the measurements can be achieved.\nIn Fig. 8, the directional coefficient D of the GGX model as defined in [29], is compared with the scattering patterns of the RER model and of the legacy ER model for an incidence angle \u03b8i = 45\u25e6 and a surface with moderate roughness, i.e. \u03a3s = \u22124 dB. In such a case, the best-fit directivity parameter is \u03b1R = 8 for both the RER and the legacy ER model. The GGX and the legacy ER model have a very similar scattering diagram, and interestingly both of them do not go to zero at grazing scattering angles, differently from the RER and the Kirchhoff models."
        },
        {
            "heading": "B. Comparison with measurements",
            "text": "Finally, the new ER model is compared with the measurements carried out in [4] on 3 different reference scenarios: the fac\u0327ade of a rural building, a warehouse with brick walls, and a metal hangar wall. In the measurements, the fac\u0327ade of the building was illuminated by a Tx directive antenna pointing\ntowards the centre of the wall, while the Rx directive antenna, also aiming at the wall centre, was moved along a semicircle in front of the wall to derive an estimate of the angular scattering pattern. A 2D view of the measurement scenario is depicted in Fig. 9, where \u03b2 and \u03b3 stands for the pointing angles of the Tx and Rx antennas, respectively.\nDespite the use of directive antennas all the interaction mechanisms (direct path, specular reflection, diffraction, diffuse scattering) are simultaneously present to some extent, and therefore the measured pattern need to be compared with RT simulations including all mechanisms: the new RER model has been embedded in the RT simulator described in [6], similarly to what done in [4] for the legacy model. Both parameters S and \u03b1R have been optimized by varying their values over the range [0-1] for S and [1-20] for \u03b1R with step of 0.01 and 0.5 respectively, using a least square method to get the best match of the overall RT-simulated scattering pattern with the measured scattering pattern. Results are shown in Fig. 10 for the rural building case with slanted illumination (i.e. \u03b2 = 150\u25e6): the optimum values of the parameters are S = 0.36 and \u03b1R = 2 in this case. As expected, the scattering model allows to fill the gap for those receiving\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/"
        },
        {
            "heading": "IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. XX, NO. YY, MONTH 202X 8",
            "text": "positions where the coherent interaction mechanisms (specular reflection, diffraction) are weaker. The curve corresponding to a simulation without diffuse scattering (i.e. S = 0) is also reported for reference in the figure, and shows a very poor performance for the Rx locations further from the specular reflection angle (i.e. \u03b3 = 30\u25e6 in Fig. 10). From the plot, it is evident that the proposed model, if properly parametrized, can accurately describe scattering from such a typical building wall, with an RMS Error (RMSE) of 1.42 dB. This result is even better than the one shown in [4] for the legacy ER model in the same scenario, not reported in the figure for the sake of legibility, where the best RMSE value was 1.85 dB.\nSimilar results are shown in Fig. 11 and 12 for the brick wall (normal illumination, \u03b2 = 90\u25e6) and hangar wall (slanted illumination, \u03b2 = 30\u25e6), respectively. Also in these cases, the introduction of the RER model into the RT simulation allows a considerable reduction of the RMS Error.\nFinally, results for all scenarios and illumination angles shown in [4] are summarized in Table I, showing the optimum values of S and \u03b1R to achieve the best matching between measurements and simulation, and the obtained RMSE value. The RMSE value for the case S = 0 (no scattering in the RT simulation) is also reported for reference in the table. In all cases, results are similar or better than the ones shown in [4] for the legacy ER model.\nRegarding the S parameter, it is confirmed that typical values for a metal wall, representative of relatively smooth surfaces, are below 0.1. In the case of medium roughness, such as the brick wall analyzed here, typical S values are around 0.2. In the case of a building fac\u0327ade with surface and volume irregularities, as for the rural building considered here, typical S values are of 0.3-0.4. The optimum S value shown in Table I for the rural building with normal illumination is actually higher (0.79): however, by setting S=0.4 the RMS Error would increase only to 5 dB, still much better than the RMSE value for S=0, which is 26.58 dB.\nMoreover, in all the analyzed cases it is confirmed that low values of the \u03b1R parameter, i.e. \u03b1R = 2 or \u03b1R = 3 are needed to achieve a good matching with measurements, also in agreement with other studies [7]."
        },
        {
            "heading": "IV. CONCLUSION",
            "text": "The Effective Roughness model, a popular model for diffuse scattering from objects and building walls that is conceived to complement ray-based radio propagation models, is reconsidered and modified in the present work in order to satisfy reciprocity, an important physical-soundness requisite. To this aim, the formulation of the original model has been modified to satisfy reciprocity without significantly affecting the simple and yet sound power-balance approach it is based on. The new, reciprocal version of the Effective Roughness model, which can be easily implemented and replaced to the old version\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/"
        },
        {
            "heading": "IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. XX, NO. YY, MONTH 202X 9",
            "text": "in ray-based propagation models, is analyzed and compared to the old one and to other popular models in section III. Finally, comparison with some of the measurements previously considered in [4] for the validation of the original model has shown that the new one yields similar performance, if not better."
        },
        {
            "heading": "APPENDIX A EULER\u2019S GAMMA AND BETA FUNCTIONS",
            "text": "The Euler\u2019s Gamma function definition is [32]:\n\u0393 (z) = \u222b \u221e 0 tz\u22121 e\u2212t dt (23)\nwhere z is a complex number having positive non-zero real part (\u211c(z) > 0). We recap here some useful properties of the Gamma function that will be used in the proofs of the next appendices:\n\u0393 (z) = \u0393 (z + 1)\nz (24)\n\u0393 (z) \u0393 ( z + 1\n2\n) = 21\u22122z \u221a \u03c0 \u0393 (2z) (25)\n\u0393 (n+ 1) = n! (26) \u0393 (n 2 ) = (n\u2212 2)!! 2 n\u22121 2 (27)\nwhere n is a natural number and n!, n!! are the factorial and double factorial (or semi-factorial) functions, respectively, defined as:\nn! = n\u22121\u220f k=0 (n\u2212 k) = n(n\u2212 1)(n\u2212 2) . . .\nn!! = \u2308n2 \u2309\u22121\u220f k=0 (n\u2212 2k) = n(n\u2212 2)(n\u2212 4) . . .\n(28)\nwhere \u2308x\u2309 stands for the least integer greater than or equal to x. Also, it is conventionally assumed: 0! = 1 and 0!! = 1.\nIn the following appendices we will also make use of the following binomial theorem [32]:\n(a+ b) n = n\u2211 k=0 ( n k ) an\u2212k bk = n\u2211 k=0 ( n k ) ak bn\u2212k (29)\nwhere ( n\nk\n) =\nn!\nk! (n\u2212 k)! In the particular case that b is equal to the constant function b(x) = 1, (29) reduces to:\n(1 + a) n = n\u2211 k=0 ( n k ) ak (30)\nThe Euler\u2019s Beta function is defined as [32]:\nB(x, y) = \u222b 1 0 tx\u22121 (1\u2212 t)y\u22121 dt (31)\nwhere \u211c(x) > 0, \u211c(y) > 0. The following properties hold:\nB(x, y) = \u0393 (x) \u0393 (y)\n\u0393 (x+ y) (32)\nB(x, y) = 2 \u222b \u03c0/2 0 sin2x\u22121 t cos2y\u22121 t dt (33)"
        },
        {
            "heading": "APPENDIX B",
            "text": "COMPLETE DERIVATION OF F\u03b1R FOR THE LEGACY ER\nMODEL (NON-RECIPROCAL)\nThe aim of this section is to prove equation (13), which is the closed-form solution of the integral (8) for the singlelobe scattering pattern of the legacy ER model (see eq. (10)), originally proposed in [4]. The integral to be solved is:\nF\u03b1R = \u222b 2\u03c0 0 \u222b \u03c0/2 0 ( 1 + cos\u03c8R 2 )\u03b1R sin \u03b8S d\u03b8S d\u03d5S (34)\nwith cos\u03c8R = cos \u03b8i cos \u03b8S \u2212 sin \u03b8i sin \u03b8S cos (\u03d5S \u2212 \u03d5i). Using the binomial theorem in the form (29) we obtain\nF\u03b1R = 1\n2\u03b1R \u222b 2\u03c0 0 \u222b \u03c0/2 0 \u03b1R\u2211 j=0 ( \u03b1R j ) cosj \u03c8R sin \u03b8S d\u03b8S d\u03d5S\n(35) It follows that\nF\u03b1R = 1\n2\u03b1R \u03b1R\u2211 j=0 ( \u03b1R j )\u222b 2\u03c0 0 \u222b \u03c0/2 0 (cos \u03b8i cos \u03b8S+\n\u2212 sin \u03b8i sin \u03b8S cos (\u03d5S \u2212 \u03d5i))j sin \u03b8S d\u03b8S d\u03d5S\n(36)\nBy applying the binomial theorem again (eq.(30)), we get\nF\u03b1R = 1\n2\u03b1R \u03b1R\u2211 j=0 ( \u03b1R j ) j\u2211 l=0 ( j l ) (\u22121)l cosj\u2212l \u03b8i sinl \u03b8i \u00b7\n\u00b7 \u222b 2\u03c0 0 \u222b \u03c0/2 0 cosj\u2212l \u03b8S sin l \u03b8S cos\nl (\u03d5S \u2212 \u03d5i) sin \u03b8S d\u03b8S d\u03d5S (37)\nLet I stand for\nI = \u222b 2\u03c0 0 \u222b \u03c0/2 0 cosj\u2212l \u03b8S sin l \u03b8S cos l (\u03d5S \u2212 \u03d5i) sin \u03b8S d\u03b8S d\u03d5S\n= \u222b \u03c0/2 0 cosj\u2212l \u03b8S sin l+1 \u03b8S d\u03b8S \u222b 2\u03c0 0 cosl (\u03d5S \u2212 \u03d5i) d\u03d5S = I1 \u00b7 I2 (38) Let us consider the first factor in (38), i.e. I1 =\u222b \u03c0/2 0 cosj\u2212l \u03b8S sin l+1 \u03b8S d\u03b8S . Applying (33) we obtain:\nI1 = 1\n2 B\n( l\n2 + 1, j \u2212 l + 1 2\n) (39)\nThe second factor I2 = \u222b 2\u03c0 0\ncosl (\u03d5S \u2212 \u03d5i) d\u03d5S may be written as\nI2 = \u222b 2\u03c0 0 (cos\u03d5S cos\u03d5i + sin\u03d5S sin\u03d5i) l d\u03d5S (40)\nUsing the binomial theorem we get:\nI2 = l\u2211 q=0 ( l q ) cosl\u2212q \u03d5i sin q \u03d5i \u222b 2\u03c0 0 cosl\u2212q \u03d5S sin q \u03d5S d\u03d5S\n(41)\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/"
        },
        {
            "heading": "IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. XX, NO. YY, MONTH 202X 10",
            "text": "Let be X = \u222b 2\u03c0 0 cosl\u2212q \u03d5S sin q \u03d5S d\u03d5S . This integral can be split into four parts:\nX = \u222b \u03c0/2 0 cosl\u2212q \u03d5S sin q \u03d5S d\u03d5S +\n+ \u222b \u03c0 \u03c0/2 cosl\u2212q \u03d5S sin q \u03d5S d\u03d5S +\n+ \u222b 3\u03c0/2 \u03c0 cosl\u2212q \u03d5S sin q \u03d5S d\u03d5S +\n+ \u222b 2\u03c0 3\u03c0/2 cosl\u2212q \u03d5S sin q \u03d5S d\u03d5S\n(42)\nIt is evident that if q is odd the four terms cancel each other out. The same thing happens when q is even and l is odd. On the other hand when l and q are both even, the four terms give the same value. Therefore we have\nX =\n{ 4 \u222b \u03c0/2 0 cosl\u2212q \u03d5S sin q \u03d5S d\u03d5S , if l,q even\n0 otherwise (43)\nUsing (33) we obtain:\nX =\n{ 2B ( q+1 2 , l\u2212q+1 2 ) , if l,q even\n0 otherwise (44)\nCombining (37), (38), (39), (41) we can assert that\nF\u03b1R = 1\n2\u03b1R \u03b1R\u2211 j=0 ( \u03b1R j ) j\u2211 l=0 ( j l ) (\u22121)l cosj\u2212l \u03b8i sinl \u03b8i \u00b7\n\u00b7 1 2 B\n( l\n2 + 1, j \u2212 l + 1 2 ) l\u2211 q=0 ( l q ) cosl\u2212q \u03d5i sin q \u03d5iX\n(45)\nSince X is nonzero only when the indices l and q are even, combining (44) and (45) we can write\nF\u03b1R = 1\n2\u03b1R \u03b1R\u2211 j=0 ( \u03b1R j ) \u230aj/2\u230b\u2211 l=0 ( j 2l ) cosj\u22122l \u03b8i sin 2l \u03b8i \u00b7\n\u00b7B ( l + 1,\nj \u2212 2l + 1 2 ) l\u2211 q=0 ( 2l 2q ) cos2l\u22122q \u03d5i sin 2q \u03d5i \u00b7\n\u00b7B ( q + 1\n2 , l \u2212 q + 1 2 ) (46)\nLet us consider B ( l + 1, j\u22122l+12 ) and B ( q + 12 , l \u2212 q + 1 2 ) . Using properties (32), (27), (26) it is simple to obtain\nB ( l + 1,\nj \u2212 2l + 1 2\n) = 2l+1 l!\n(j \u2212 2l \u2212 1)!! (j + 1)!!\n(47)\nIn a similar way, using (32), (26), (25) we get\nB ( q + 1\n2 , l \u2212 q + 1 2 ) = \u03c0 (2q)! (2l \u2212 2q)! 22l q! l! (l \u2212 q)!\n(48)\nBy substituting (47) and (48) into (46) and rearranging some terms we obtain\nF\u03b1R = 2\u03c0 \u03b1R!\n2\u03b1R \u03b1R\u2211 j=0\n1\n(\u03b1R \u2212 j)! (j + 1)!! \u230aj/2\u230b\u2211 l=0 cosj\u22122l \u03b8i sin 2l \u03b8i 2l (j \u2212 2l)!! \u00b7\n\u00b7 l\u2211\nq=0\ncos2l\u22122q \u03d5i sin 2q \u03d5i\nq! (l \u2212 q)! (49)\nwhere the symbol \u230ax\u230b stands for the greatest integer less than or equal to x.\nBut \u2211l\nq=0 cos2l\u22122q \u03d5i sin 2q \u03d5i q!(l\u2212q)! equals 1/l!, as it can be easily\nverified by applying the binomial theorem. Then, after this substitution we can eventually write the final formulation of F\u03b1R :\nF\u03b1R = 2\u03c0 \u03b1R!\n2\u03b1R \u03b1R\u2211 j=0\n1\n(\u03b1R \u2212 j)! (j + 1)!! \u230aj/2\u230b\u2211 l=0 cosj\u22122l \u03b8i sin 2l \u03b8i\n2l l! (j \u2212 2l)!! (50)\nThis equation is also valid in the case of normal incidence, i.e. \u03b8i = 0, if for the 0th-order term of the second summation it is conventionally assumed, as most automatic calculators do:\nlim \u03b8i\u21920\n(sin \u03b8i) 0 = 00 = 1\nIn such a case, for normal incidence (50) reduces to:\nF\u03b1R (0) = 4\u03c0\n\u03b1R + 1\n( 1\u2212 1\n2\u03b1R+1 ) The same result can be also obtained by directly integrating (8) for \u03b8i = 0, which is straightforward."
        },
        {
            "heading": "APPENDIX C SOLUTION OF THE POWER BALANCE INTEGRAL FOR THE NEW ER RECIPROCAL MODEL (SINGLE-LOBE VERSION)",
            "text": "The aim of this section is to justify equation (17). We assume that F\u03b1R can be written in the following, approximate form, as discussed in Section II:\nF\u03b1R \u2248 k (\u03b1R) \u221a cos \u03b8i (51)\nLooking at this expression, we observe that k (\u03b1R) is equal to F\u03b1R when \u03b8i = 0. Thus we can assert that\nF\u03b1R \u2248 k (\u03b1R) \u221a cos \u03b8i = F\u03b1R (\u03b8i = 0) \u221a cos \u03b8i (52)\nThe value of F\u03b1R (\u03b8i = 0) can be found by directly integrating (8) for \u03b8i = 0, and observing that, for normal incidence, cos\u03c8R = cos \u03b8S . Then, we get:\nF\u03b1R \u2248 2\u03c0\n\u221a cos \u03b8i 2\u03b1R\n\u222b \u03c0 2\n0\n\u221a cos \u03b8S (1 + cos \u03b8S) \u03b1R sin \u03b8S d\u03b8S\n(53) Then, by applying the binomial theorem we obtain\nF\u03b1R \u2248 2\u03c0\n\u221a cos \u03b8i 2\u03b1R\n\u222b \u03c0 2\n0\nsin \u03b8S \u221a cos \u03b8S \u03b1R\u2211 j=0 ( \u03b1R j ) cosj \u03b8S d\u03b8S\n(54)\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/"
        },
        {
            "heading": "IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. XX, NO. YY, MONTH 202X 11",
            "text": "Equation (54) can be rewritten as\nF\u03b1R \u2248 2\u03c0\n\u221a cos \u03b8i 2\u03b1R \u03b1R\u2211 j=0 ( \u03b1R j )\u222b \u03c0 2 0 sin \u03b8S cos j+ 12 \u03b8S d\u03b8S\n(55) Applying (33) in (55) we have\nF\u03b1R \u2248 \u03c0 \u221a cos \u03b8i 2\u03b1R \u03b1R\u2211 j=0 ( \u03b1R j ) B ( 1, j 2 + 3 4 ) (56)\nUsing properties (32), (24) we get the final expression for F\u03b1R :\nF\u03b1R \u2248 4\u03c0\n\u221a cos \u03b8i 2\u03b1R \u03b1R\u2211 j=0 ( \u03b1R j ) 1 2j + 3 (57)\nEventually, eq. (17) is obtained by substituting (57) and (14) into (7)."
        },
        {
            "heading": "APPENDIX D SOLUTION OF THE POWER BALANCE INTEGRAL FOR THE DOUBLE-LOBE RER MODEL",
            "text": "The aim of this section is to justify equation (20). In order to do that, let\u2019s consider the two integrals in (19)\nF\u03b1R = 2\u03c0\u222b 0 \u03c0 2\u222b 0 \u221a cos \u03b8S ( 1 + cos\u03c8R 2 )\u03b1R sin \u03b8Sd\u03b8Sd\u03d5S\nF\u03b1i = 2\u03c0\u222b 0 \u03c0 2\u222b 0 \u221a cos \u03b8S ( 1 + cos\u03c8i 2 )\u03b1i sin \u03b8Sd\u03b8Sd\u03d5S\n(58) and remember that [4]:\ncos\u03c8i = cos \u03b8i cos \u03b8S + sin \u03b8i sin \u03b8S cos (\u03d5S \u2212 \u03d5i) (59)\nWe notice that only difference between (11) and (59) is in the sign of the second term.\nWe want to show that the integrals in (58) have the same result, for a fixed value of the exponent. Proving this is equivalent to proving that the result of the integral M defined in equation (60) does not depend on the sign of the term sin \u03b8i sin \u03b8S cos (\u03d5S \u2212 \u03d5i):\nM = \u222b 2\u03c0 0 \u222b \u03c0/2 0 \u221a cos \u03b8S(1 + cos \u03b8i cos \u03b8S+\n\u00b1 sin \u03b8i sin \u03b8S cos (\u03d5S \u2212 \u03d5i))m sin \u03b8S d\u03b8S d\u03d5S (60)\nIn order to prove that, we apply the binomial theorem twice and with a little manipulation of the factors we get\nM = m\u2211 j=0 ( m j ) j\u2211 l=0 [ ( j l ) (\u00b11)l sinl \u03b8i cosj\u2212l \u03b8i \u00b7\n\u00b7 \u222b \u03c0/2 0 sinl+1 \u03b8S cos j\u2212l+ 12 \u03b8S d\u03b8S \u00b7\n\u00b7 \u222b 2\u03c0 0 cosl (\u03d5S \u2212 \u03d5i)\u03b1R sin \u03b8S d\u03d5S ]\n(61)\nBut \u222b 2\u03c0 0\ncosl (\u03d5S \u2212 \u03d5i)\u03b1R sin \u03b8S d\u03d5S \u0338= 0 only when the index l is even. Thus, the overall contribution of the term (\u00b11)l is\ncompletely irrelevant since (+1)l = (\u22121)l = 1 when l is even. This proves that the \u00b1 sign does not change the result of M .\nTherefore, the 2 integrals in (58) have the same form, and the only difference between them is in the value of the exponent, either \u03b1R or \u03b1i. By adopting the same procedure as in Appendix C, we then find that:\nF\u03b1R \u2248 F\u03b1R (0) \u221a cos \u03b8i \u2248 4\u03c0 \u221a cos \u03b8i\n2\u03b1R\n\u03b1R\u2211 j=0 ( \u03b1R j ) 1 2j + 3\nF\u03b1i \u2248 F\u03b1i (0) \u221a cos \u03b8i \u2248 4\u03c0 \u221a cos \u03b8i\n2\u03b1i\n\u03b1i\u2211 j=0 ( \u03b1i j ) 1 2j + 3\n(62) and by substituting F\u03b1i,\u03b1R = \u039bF\u03b1R + (1 \u2212 \u039b)F\u03b1i into (18), we finally get (20)."
        },
        {
            "heading": "IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION, VOL. XX, NO. YY, MONTH 202X 12",
            "text": "[16] C. Jansen, S. Priebe, C. Mo\u0308ller, M. Jacob, H. Dierke, M. Koch, and T. Ku\u0308rner, \u201cDiffuse scattering from rough surfaces in THz communication channels,\u201d IEEE Trans. Terahertz Sci. Technol., vol. 1, no. 2, pp. 462\u2013472, 2011. [17] P. Beckmann and A. Spizzichino, The scattering of electromagnetic waves from rough surfaces. Oxford: Pergamon Press, 1963. [18] L. Tsang, J. Kong, and K.-H. Ding, Scattering of Electromagnetic Waves: Theories and Applications. Hoboken, New Jersey: John Wiley and Sons, Ltd, 2000. [19] P. Pongsilamanee and H. L. Bertoni, \u201cSpecular and nonspecular scattering from building fac\u0327ades,\u201d IEEE Trans. Antennas Propag., vol. 52, no. 7, pp. 1879\u20131889, 2004. [20] V. Degli-Esposti, F. Fuschini, and E. M. Vitucci, \u201cA fast model for distributed scattering from buildings,\u201d in 2009 3rd European Conference on Antennas and Propagation, 2009, pp. 1932\u20131936. [21] F. Fuschini, V. Degli-Esposti, and E. M. Vitucci, \u201cA model for forwarddiffuse scattering through a wall,\u201d in Proceedings of the Fourth European Conference on Antennas and Propagation, 2010, pp. 1\u20134. [22] L. Minghini, R. D\u2019Errico, V. Degli Esposti, and E. M. Vitucci, \u201cElectromagnetic simulation and measurement of diffuse scattering from building walls,\u201d in The 8th European Conference on Antennas and Propagation (EuCAP 2014), 2014, pp. 1298\u20131302. [23] J. Pascual-Garc\u0131\u0301a, J.-M. Molina-Garc\u0131\u0301a-Pardo, M.-T. Mart\u0131\u0301nez-Ingle\u0301s, J.-V. Rodr\u0131\u0301guez, and N. Saur\u0131\u0301n-Serrano, \u201cOn the importance of diffuse scattering model parameterization in indoor wireless channels at mmwave frequencies,\u201d IEEE Access, vol. 4, pp. 688\u2013701, 2016. [24] F. Fuschini, S. Ha\u0308fner, M. Zoli, R. Mu\u0308ller, E. M. Vitucci, D. Dupleich, M. Barbiroli, J. Luo, E. Schulz, V. Degli-Esposti, and R. S. Thoma\u0308, \u201cItem level characterization of mm-wave indoor propagation,\u201d Eurasip J. Wirel. Commun. Netw., vol. 2016, no. 4, 2016. [25] Remcom. (2022) Wireless InSite Diffuse Scattering. Available: https://www.remcom.com/wireless-insite-diffuse-scattering. Accessed: 2022-08-09. [26] J. Van Bladel, Electromagnetic Fields. New York: Wiley-IEEE Press, 2007, pp. 405\u2013413. [27] B. Duvenhage, K. Bouatouch, and D. G. Kourie, \u201cNumerical verification of bidirectional reflectance distribution functions for physical plausibility,\u201d in Proceedings of the South African Institute for Computer Scientists and Information Technologists Conference, ser. SAICSIT \u201913, 2013, p. 200\u2013208. [28] B. Walter, S. Marschner, H. Li, and K. E. Torrance, \u201cMicrofacet models for refraction through rough surfaces,\u201d in Rendering Techniques, 2007. [29] J.-F. Wagen, \u201cDiffuse scattering and specular reflection from facets of arbitrary size and roughness using the computer graphics GGX model,\u201d in 2020 International Symposium on Networks, Computers and Communications (ISNCC), 2020, pp. 1\u20135. [30] M. Saillard and G. Soriano, \u201cRough surface scattering at low-grazing incidence: A dedicated model,\u201d Radio Science, vol. 46, no. 5, 2011. [31] S. Priebe, M. Jacob, C. Jansen, and T. Ku\u0308rner, \u201cNon-specular scattering modeling for THz propagation simulations,\u201d in Proceedings of the 5th European Conference on Antennas and Propagation (EUCAP), 2011, pp. 1\u20135. [32] M. Abramowitz and I. A. Stegun, Handbook of Mathematical Functions with Formulas, Graphs, and Mathematical Tables. New York City: Dover, 1964.\nEnrico M. Vitucci (S\u201904, M\u201908, SM\u201918) is currently an Associate Professor in applied electromagnetics, antennas, and propagation with the Department of Electrical, Electronic and Information Engineering \u201dG. Marconi\u201d (DEI), University of Bologna. Formerly, he has been a Research Associate with the Center for Industrial Research on ICT, University of Bologna. In 2015, he was a Visiting Researcher with Polaris Wireless, Inc., Mountain View, CA, USA. He is Chair of the Cesena-Forli Unit of the InterDepartment Center for Industrial Research on ICT\n(CIRI-ICT) of the University of Bologna. He is the author or a coauthor of about 100 technical articles on international journals and conferences, and co-inventor of five international patents. He participated to several European research and cooperation programs (COST 2100, COST IC1004, COST IRACON, COST INTERACT) and in the European Networks of Excellence NEWCOM and NEWCOM++. His research interests are in deterministic and wireless propagation models for 5G and beyond. Prof. Vitucci is a member of the Editorial Board of the Journal Wireless Communications and Mobile Computing.\nNicolo\u0300 Cenni is currently a M.Sc. student in Electronic and Telecommunications Engineering at the Department of Electrical, Electronic and Information Engineering (DEI), University of Bologna. He received his B.Sc. degree in Electronic Engineering at the Cesena Campus of the University of Bologna, in 2021. He was awarded for the best B.Sc. thesis in Electronic Engineering at the Cesena Campus, and received a scholarship funded by JMA Wireless Italy, Castel San Pietro Terme, Bologna, Italy. His interests are in wireless communications, radio\npropagation, applied electromagnetics and mathematics.\nFranco Fuschini received the M.Sc. degree in Telecommunication Engineering and the Ph.D. degree in Electronics and Computer Science from the University of Bologna in March 1999 and in July 2003, respectively. In April 1999 he got the \u2018Marconi Foundation Young Scientist Prize\u2019 in the context of the XXV Marconi International Fellowship Award. He is now Associate Professor at the Department of Electrical, Electronic and Information Engineering \u201cG. Marconi\u201d of the University of Bologna. His main research interests are in the area of radio systems\ndesign and radio propagation channel theoretical modelling and experimental investigation. Franco Fuschini is author or co-author of more than 30 journal papers on radio propagation and wireless system design.\nVittorio Degli-Esposti (M\u201994-SM\u201916) is an Associate Professor at the \u201cDipartimento di Ingegneria Elettrica, Elettronica e dell\u2019Informazione\u201d (DEI) of the Alma Mater Studiorum - University of Bologna. He is qualified (Abilitazione S.N.) as Full Professor. From January 2015 to December 2016 he\u2019s been Director of Research at Polaris Wireless Inc., Mountain View, California, USA. He has been Adjunct Professor at Helsinki University of Technology (now Aalto University), and Tongji University, Shanghai, in 2006 and 2013, respectively. He has been Post-\nDoc Researcher in 1998 at Polytechnic University, Brooklyn, New York (now NYU Polytechnic) in the group led by Professor H. L. Bertoni, and participated in several European Research Projects including the European Cooperation Actions COST 231, 259, 273, 2100, IC1004, IRACON, and INTERACT, the European Networks of Excellence NEWCOM and NEWCOM++ and the 7th Framework Program IP Project ALPHA. He is elected Chair of the Propagation Working Group (WG9) of the European Association on Antennas and Propagation (EuRAAP). He has been Vice-Chair of the European Conference on Antennas and Propagation (EuCAP), editions 2010 and 2011, Short-Courses and Workshops Chair of the 2015 edition, Invited Speaker at EuCAP 2014, invited Speaker at International Symposium on Antennas and Propagation (ISAP) 2020 and Short-Courses Chair of the European Conference on Networks and Communications, (EuCNC) 2020. He has been founder and lecturer of the biennial Courses for PhD students and Researchers \u201cShort range radio propagation: theory, models and future applications\u201d and \u201cMobile Radio Propagation for 5G and Beyond\u201d of the European School of Antennas (http://www.antennasvce.org/Community/Education/Courses/). He is author or co-author of over 140 peer-reviewed technical papers and coinventor of 7 international patents in the fields of applied electromagnetics, radio propagation and wireless systems. He is Senior Member of the IEEE, Editor of the IEEE Transactions on Vehicular Technology and Associate Editor of the journals Radio Science and IEEE Access.\nThis work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 License. For more information, see https://creativecommons.org/licenses/by-nc-nd/4.0/"
        }
    ],
    "title": "A Reciprocal Heuristic Model for Diffuse Scattering from Walls and Surfaces",
    "year": 2023
}