{
    "abstractText": "The water cycle is highly interconnected; water fluxes in one part depend on physical and human processes throughout. For example, rivers are a water supply, a receiver of wastewater, and an aggregate of many hydrological, biological, and chemical processes. Thus, simulations of the water cycle that have highly constrained boundaries may miss key interactions that create unanticipated impacts or unexpected opportunities (Dobson & Mijic, 2020; Liu, Dobson, & Mijic, 2022). Integrated environmental models aim to resolve the issue of boundary conditions, however they have some key limitations (Rauch et al., 2017), and in particular we find a significant need for a parsimonious, self-contained suite that is accessible and easy to setup.",
    "authors": [
        {
            "affiliations": [],
            "name": "Barnaby Dobson"
        },
        {
            "affiliations": [],
            "name": "Leyang Liu"
        },
        {
            "affiliations": [],
            "name": "Ana Mijic"
        }
    ],
    "id": "SP:243a4a9353ddd67955f6f04bbcf6e817165d5e18",
    "references": [
        {
            "authors": [
                "J.G. Arnold",
                "D.N. Moriasi",
                "P.W. Gassman",
                "K.C. Abbaspour",
                "M.J. White",
                "R. Srinivasan"
            ],
            "title": "SWAT: Model use, calibration, and validation",
            "venue": "Transactions of the ASABE,",
            "year": 2012
        },
        {
            "authors": [
                "G.F. Belete",
                "A. Voinov",
                "G.F. Laniak"
            ],
            "title": "An overview of the model integration process: From pre-integration assessment to testing",
            "venue": "Environmental Modelling & Software,",
            "year": 2017
        },
        {
            "authors": [
                "G. Burger",
                "P.M. Bach",
                "C. Urich",
                "G. Leonhardt",
                "M. Kleidorfer",
                "W. Rauch"
            ],
            "title": "Designing and implementing a multi-core capable integrated urban drainage modelling toolkit: Lessons from CityDrain3",
            "venue": "Advances in Engineering",
            "year": 2016
        },
        {
            "authors": [
                "B. Dobson",
                "T. Jovanovic",
                "Y. Chen",
                "A. Paschalis",
                "A. Butler",
                "A. Mijic"
            ],
            "title": "Integrated modelling to support analysis of COVID-19 impacts on london\u2019s water system and in-river water quality",
            "venue": "Frontiers in Water,",
            "year": 2021
        },
        {
            "authors": [
                "B. Dobson",
                "A. Mijic"
            ],
            "title": "Protecting rivers by integrating supply-wastewater infrastructure planning and coordinating operational decisions",
            "venue": "Environmental Research Letters,",
            "year": 2020
        },
        {
            "authors": [
                "Dobson"
            ],
            "title": "Water Systems Integrated Modelling framework, WSIMOD: A Python package for integrated modelling of water quality and quantity across the water cycle",
            "venue": "Journal of Open Source Software,",
            "year": 2023
        },
        {
            "authors": [
                "B. Dobson",
                "H. Watson-Hill",
                "S. Muhandes",
                "M. Borup",
                "A. Mijic"
            ],
            "title": "A reduced complexity model with graph partitioning for rapid hydraulic assessment of sewer networks",
            "venue": "Water Resources Research,",
            "year": 2022
        },
        {
            "authors": [
                "J. Giron\u00e1s",
                "L.A. Roesner",
                "L.A. Rossman",
                "J. Davis"
            ],
            "title": "A new applications manual for the storm water management model (SWMM)",
            "venue": "Environmental Modelling & Software,",
            "year": 2010
        },
        {
            "authors": [
                "J. Gregersen",
                "P. Gijsbers",
                "S. Westen"
            ],
            "title": "OpenMI: Open modelling interface",
            "venue": "Journal of Hydroinformatics,",
            "year": 2007
        },
        {
            "authors": [
                "L. Liu",
                "B. Dobson",
                "A. Mijic"
            ],
            "title": "Hierarchical systems integration for coordinated urbanrural water quality management at a catchment scale",
            "venue": "Science of The Total Environment,",
            "year": 2022
        },
        {
            "authors": [
                "L. Liu",
                "B. Dobson",
                "A. Mijic"
            ],
            "title": "Optimisation of urban-rural nature-based solutions for integrated catchment water management",
            "venue": "Journal of Environmental Management",
            "year": 2023
        },
        {
            "authors": [
                "S. Muhandes",
                "B. Dobson",
                "A. Mijic"
            ],
            "title": "The value of aggregated city scale models to rapidly assess SuDS in combined sewer systems",
            "venue": "Frontiers in Water,",
            "year": 2022
        },
        {
            "authors": [
                "W. Rauch",
                "C. Urich",
                "P. Bach",
                "B. Rogers",
                "F. De Haan",
                "R. Brown"
            ],
            "title": "Modelling transitions in urban water systems",
            "venue": "Water Research,",
            "year": 2017
        },
        {
            "authors": [
                "N.K. Shrestha",
                "O.T. Leta",
                "B. De Fraine",
                "A. Van Griensven",
                "W. Bauwens"
            ],
            "title": "OpenMIbased integrated sediment transport modelling of the River Zenne, Belgium",
            "venue": "Environmental Modelling & Software,",
            "year": 2013
        },
        {
            "authors": [
                "W. Usher",
                "T. Russell"
            ],
            "title": "A software framework for the integration of infrastructure simulation models",
            "year": 2019
        },
        {
            "authors": [
                "Dobson"
            ],
            "title": "Water Systems Integrated Modelling framework, WSIMOD: A Python package for integrated modelling of water quality and quantity across the water cycle",
            "venue": "Journal of Open Source Software,",
            "year": 2023
        }
    ],
    "sections": [
        {
            "text": "Water Systems Integrated Modelling framework, WSIMOD: A Python package for integrated modelling of water quality and quantity across the water cycle"
        },
        {
            "heading": "Barnaby Dobson 1, Leyang Liu 1, and Ana Mijic 1",
            "text": "1 Department of Civil and Environmental Engineering, Imperial College London, UK DOI: 10.21105/joss.04996\nSoftware \u2022 Review \u2022 Repository \u2022 Archive\nEditor: Chris Vernon Reviewers:\n\u2022 @cheginit \u2022 @jlarsen-usgs\nSubmitted: 07 November 2022 Published: 07 March 2023\nLicense Authors of papers retain copyright and release the work under a Creative Commons Attribution 4.0 International License (CC BY 4.0)."
        },
        {
            "heading": "Summary",
            "text": "The water cycle is highly interconnected; water fluxes in one part depend on physical and human processes throughout. For example, rivers are a water supply, a receiver of wastewater, and an aggregate of many hydrological, biological, and chemical processes. Thus, simulations of the water cycle that have highly constrained boundaries may miss key interactions that create unanticipated impacts or unexpected opportunities (Dobson & Mijic, 2020; Liu, Dobson, & Mijic, 2022). Integrated environmental models aim to resolve the issue of boundary conditions, however they have some key limitations (Rauch et al., 2017), and in particular we find a significant need for a parsimonious, self-contained suite that is accessible and easy to setup."
        },
        {
            "heading": "Statement of need",
            "text": "Traditional approaches to water system modelling broadly fall into highly numerical models that excel in representing individual subsystems, or systems dynamics models that create broad representations but that lack a physical basis. Early attempts at a physical representation of the water cycle combined existing numerical models through an integration framework (Rauch et al., 2017). While successful, this approach has an incredibly high user burden because each subsystem model is so detailed, and as a consequence is also difficult to customise. To illustrate, SWAT is one of the most widespread models of the rural water cycle (Arnold et al., 2012), while SWMM is the same but for the urban water cycle (Giron\u00e1s, Roesner, Rossman, & Davis, 2010). It has been demonstrated that these two software can interface using the OpenMI integration framework (Shrestha, Leta, De Fraine, Van Griensven, & Bauwens, 2013). Despite this seemingly powerful combination of two near-ubiquitous models, integrated applications have been limited, and we propose that this is for the same reasons presented in (Rauch et al., 2017): user burden and customisation difficulty.\nBecause of this need, we provide a parsimonious and self-contained suite for integrated water cycle modelling in the WSIMOD Python package. It brings together a range of software developed over the course of three years on the CAMELLIA project. Urban water processes are based on those presented and validated in the CityWat model (Dobson et al., 2021; Dobson & Mijic, 2020; Dobson, Watson-Hill, Muhandes, Borup, & Mijic, 2022; Muhandes, Dobson, & Mijic, 2022), while hydrological and agricultural processes are from the CatchWat model (Liu et al., 2022, 2023). WSIMOD also provides an interface for message passing between different model components, enabling all parts of the water cycle to interact with all other parts. The result is a simulation model that is easy to set up, highly flexible and ideal for representing water quality and quantity in \u2018non-textbook\u2019 water systems (which in our experience is nearly all of them).\nThe package provides a variety of tutorials and examples to help modellers create nodes (i.e.,\nDobson et al. (2023). Water Systems Integrated Modelling framework, WSIMOD: A Python package for integrated modelling of water quality and quantity across the water cycle. Journal of Open Source Software, 8(83), 4996. https://doi.org/10.21105/joss.04996.\n1\nrepresentations of subsystems within the water cycle), connect them together with arcs (i.e., representing the fluxes between subsystems), and orchestrate them into a model that creates simulations."
        },
        {
            "heading": "Limitations",
            "text": "We highlight that WSIMOD is not intended to be a substitute for sophisticated physical models, nor for a system dynamics approach. In applications where detailed hydraulic/hydrological process representations are needed (e.g., informing the design of specific pipes, cases where processes are hard to quantify such as representing social drivers of population growth, etc.) there are likely better tools available. Our case studies highlight that WSIMOD is most useful in situations where physically representing cross-sytem processes and thus capturing the impacts of cross-system interactions are essential towards the questions you ask of your model. Secondary benefits are that the parsimonious representations utilised are computationally fast and flexible in capturing a wide range of system interventions."
        },
        {
            "heading": "Acknowledgements",
            "text": "WSIMOD was developed by Barnaby Dobson and Leyang Liu. Theoretical support was provided by Ana Mijic. Testing the WSIMOD over a variety of applications has been performed by Fangjun Peng, Vladimir Krivstov and Samer Muhandes. Software development support was provided by Imperial College\u2019s Research Software Engineering service, in particular from Diego Alonso and Dan Davies.\nWe are incredibly grateful for the detailed software reviews provided by Taher Chegini and Joshua Larsen and editing by Chris Vernon. Their suggestions have significantly improved WSIMOD.\nThe design of WSIMOD was significantly influenced by CityDrain3 (Burger et al., 2016), OpenMI (Gregersen, Gijsbers, & Westen, 2007), smif (Usher & Russell, 2019; Usher et al., 2018), and the following review (Belete, Voinov, & Laniak, 2017).\nWe acknowledge funding from the CAMELLIA project (Community Water Management for a Liveable London), funded by the Natural Environment Research Council (NERC) under grant NE/S003495/1."
        }
    ],
    "title": "Water Systems Integrated Modelling framework, WSIMOD: A Python package for integrated modelling of water quality and quantity across the water cycle",
    "year": 2023
}