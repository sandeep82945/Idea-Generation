{
    "abstractText": "Dagoberto Contreras, Fiona McCarthy, and Matthew C. Johnson Department of Physics and Astronomy, York University, Toronto, Ontario, M3J 1P3, Canada Center for Computational Astrophysics, Flatiron Institute, 162 5th Avenue, New York, NY 10010 USA Perimeter Institute for Theoretical Physics, Waterloo, Ontario N2L 2Y5, Canada and Department of Physics and Astronomy, University of Waterloo, Waterloo, Ontario, N2L 3G1, Canada",
    "authors": [
        {
            "affiliations": [],
            "name": "Dagoberto Contreras"
        },
        {
            "affiliations": [],
            "name": "Fiona McCarthy"
        },
        {
            "affiliations": [],
            "name": "Matthew C. Johnson"
        }
    ],
    "id": "SP:9176302b28bcae9d19f8dba5814af9d5d4bf221a",
    "references": [
        {
            "authors": [
                "J. Aguirre"
            ],
            "title": "Simons Observatory)",
            "venue": "JCAP 1902,",
            "year": 2019
        },
        {
            "authors": [
                "R.A. Sunyaev",
                "I.B. Zeldovich"
            ],
            "title": "MNRAS 190",
            "venue": "413 ",
            "year": 1980
        },
        {
            "authors": [
                "A.-S. Deutsch",
                "E. Dimastrogiovanni",
                "M.C. Johnson",
                "M. M\u00fcnchmeyer",
                "A. Terrana"
            ],
            "title": "Phys",
            "venue": "Rev. D98, 123501 ",
            "year": 2018
        },
        {
            "authors": [
                "K.M. Smith",
                "M.S. Madhavacheril",
                "M. M\u00fcnchmeyer",
                "S. Ferraro",
                "U. Giri"
            ],
            "title": "and M",
            "venue": "C. Johnson ",
            "year": 2018
        },
        {
            "authors": [
                "J. Cayuso",
                "R. Bloch",
                "S.C. Hotinli",
                "M.C. Johnson"
            ],
            "title": "and F",
            "venue": "McCarthy ",
            "year": 2021
        },
        {
            "authors": [
                "A. Terrana",
                "M.-J. Harris",
                "M.C. Johnson"
            ],
            "title": "Journal of Cosmology and Astroparticle Physics 2017",
            "venue": "040 ",
            "year": 2017
        },
        {
            "authors": [
                "J.I. Cayuso",
                "M.C. Johnson",
                "J.B. Mertens"
            ],
            "title": "Phys",
            "venue": "Rev. D 98, 063502 ",
            "year": 2018
        },
        {
            "authors": [
                "M.S. Madhavacheril",
                "N. Battaglia",
                "K.M. Smith"
            ],
            "title": "and J",
            "venue": "L. Sievers ",
            "year": 2019
        },
        {
            "authors": [
                "N. Battaglia"
            ],
            "title": "JCAP 1608",
            "venue": "058 ",
            "year": 2016
        },
        {
            "authors": [
                "S.C. Hotinli",
                "K.M. Smith",
                "M.S. Madhavacheril"
            ],
            "title": "and M",
            "venue": "Kamionkowski ",
            "year": 2021
        },
        {
            "authors": [
                "L. Thiele",
                "F. Villaescusa-Navarro",
                "D.N. Spergel",
                "D. Nelson",
                "A. Pillepich"
            ],
            "title": "Astrophys",
            "venue": "J. 902, 129 ",
            "year": 2020
        },
        {
            "authors": [
                "B. Hadzhiyska",
                "B.D. Sherwin",
                "M. Madhavacheril",
                "S. Ferraro"
            ],
            "title": "Phys",
            "venue": "Rev. D 100, 023547 ",
            "year": 2019
        },
        {
            "authors": [
                "K.M. G\u00f3rski",
                "E. Hivon",
                "A.J. Banday",
                "B.D. Wandelt",
                "F.K. Hansen",
                "M. Reinecke",
                "M. Bartelmann"
            ],
            "title": "ApJ 622",
            "venue": "759 ",
            "year": 2005
        },
        {
            "authors": [
                "Y. Akrami"
            ],
            "title": "Planck), Astron. Astrophys",
            "year": 2003
        },
        {
            "authors": [
                "A. Lewis",
                "A. Challinor",
                "A. Lasenby"
            ],
            "title": "ApJ 538",
            "venue": "473 ",
            "year": 2000
        },
        {
            "authors": [
                "A. Cooray",
                "R.K. Sheth"
            ],
            "title": "Phys",
            "venue": "Rept. 372, 1 ",
            "year": 2002
        },
        {
            "authors": [
                "N. Battaglia",
                "J. Cosmology Astropart"
            ],
            "title": "Phys",
            "venue": "2016, 058 ",
            "year": 2016
        },
        {
            "authors": [
                "F. McCarthy",
                "M.C. Johnson"
            ],
            "title": "Phys",
            "venue": "Rev. D 102, 043520 ",
            "year": 2020
        },
        {
            "authors": [
                "S.C. Hotinli",
                "J. Meyers",
                "N. Dalal",
                "A.H. Jaffe",
                "M.C. Johnson",
                "J.B. Mertens",
                "M. M\u00fcnchmeyer",
                "K.M. Smith"
            ],
            "title": "and A",
            "venue": "van Engelen, Phys. Rev. Lett. 123, 061301 ",
            "year": 2019
        },
        {
            "authors": [
                "A.-S. Deutsch",
                "M.C. Johnson",
                "M. M\u00fcnchmeyer",
                "A. Terrana"
            ],
            "title": "Journal of Cosmology and Astroparticle Physics 2018",
            "venue": "034 ",
            "year": 1705
        }
    ],
    "sections": [
        {
            "text": "Maximum likelihood kinetic Sunyaev Zel\u2019dovich velocity reconstruction\nDagoberto Contreras1, Fiona McCarthy2,3,4, and Matthew C. Johnson1,3 1Department of Physics and Astronomy, York University, Toronto, Ontario, M3J 1P3, Canada\n2Center for Computational Astrophysics, Flatiron Institute, 162 5th Avenue, New York, NY 10010 USA\n3Perimeter Institute for Theoretical Physics, Waterloo, Ontario N2L 2Y5, Canada and 4Department of Physics and Astronomy, University of Waterloo, Waterloo, Ontario, N2L 3G1, Canada\nThe kinetic Sunyaev Zel\u2019dovich (kSZ) effect, cosmic microwave background (CMB) temperature anisotropies induced by the scattering of CMB photons from free electrons, will be measured by near-term CMB experiments at high significance. By combining CMB temperature anisotropies with a tracer of structure, such as a galaxy redshift survey, previous literature introduced a number of techniques to reconstruct the radial velocity field. This reconstructed radial velocity field encapsulates the majority of the cosmological information contained in the kSZ temperature anisotropies, and can provide powerful new tests of the standard cosmological model and theories beyond it. In this paper, we introduce a new estimator for the radial velocity field based on a coarse-grained maximum likelihood fit for the kSZ component of the temperature anisotropies, given a tracer of the optical depth. We demonstrate that this maximum likelihood estimator yields a higher fidelity reconstruction than existing quadratic estimators in the low-noise and high-resolution regime targeted by upcoming CMB experiments. We describe implementations of the maximum likelihood estimator in both harmonic space and map space, using either direct measurements of the optical depth field or a galaxy survey as a tracer. We comment briefly on the impact of biases introduced by imperfect reconstruction of the optical depth field.\nI. INTRODUCTION\nFuture cosmic microwave background (CMB) experiments such as Simons Observatory [1], CMB-S4 [2], and CMB-HD [3] will probe the high-resolution, low-noise frontier where secondary CMB anisotropies dominate. Secondary anisotropies arise due to the electromagnetic (Sunyaev Zel\u2019dovich effect) or gravitational (lensing) scattering of CMB photons from structure, and encode a significant amount of astrophysical and cosmological information. How to access this information is an active area of investigation. In this paper, we focus on the kinetic Sunyaev Zel\u2019dovich (kSZ) effect, blackbody temperature anisotropies induced by the scattering of CMB photons from free electrons in bulk motion along the line of sight [4]. We introduce a new estimator for the radial velocity field based on a coarse-grained maximum likelihood solution constructed from the CMB temperature anisotropies and a tracer of the optical depth.\nPrevious literature introduced a set of quadratic estimators (QEs) for the radial velocity field [5\u20137] based on the CMB temperature anisotropies and a galaxy survey as a tracer of the optical depth1. Fisher forecasts [5\u20137], the analysis of N-body simulations [9, 10], and the analysis of Gaussian mocks containing various foregrounds and systematics [7] indicate that these QEs will yield high fidelity reconstructions of the radial velocity field with near-term CMB and galaxy surveys. The QE reconstructs the radial velocity field from statistical anisotropies in the cross-power spectrum of the CMB temperature and a redshift-binned galaxy survey. The estimator relies on the assumption that all the fields involved are Gaussian, and is based on the theoretical ensemble average spectra, which are used to find the appropriate weights for the estimators to be unbiased and have the minimum variance. However, these properties of the QE lead to significant signal-to-noise penalties and biases in the high signal-to-noise regime. For example, the non-Gaussian nature of the optical depth and galaxy density on small scales leads to the so-called N (3/2) bias which can exceed the Gaussian reconstruction noise in the high signal-to-noise regime [10]. For sufficiently low noise and high resolution CMB experiments, and in the absence of foregrounds, the dominant contribution to the observed temperature anisotropies on small angular scales will be the kSZ effect itself. In this limit, the QE is limited by sample variance, since it relies on searching for statistical anisotropies beyond those expected\n1 More precisely, one reconstructs the remote dipole field: the CMB dipole seen in the local rest frame of the scatterer, projected along the line of sight. The largest contribution to the remote dipole field is given by the radial peculiar velocity, but there are additional \u2019primordial\u2019 contributions; see Refs. [5, 8] for discussion.\nar X\niv :2\n20 5.\n15 77\n9v 1\n[ as\ntr o-\nph .C\nO ]\n3 1\nM ay\n2 02\n2\n2 in the ensemble average. However, because one is able to accurately measure the detailed kSZ temperature anisotropies in this limit, it should be possible to do better by using the properties of our realization rather than the ensemble statistics (e.g. to use a form a sample variance cancellation).\nTo overcome these two shortcomings of the QE, we introduce a new estimator for the radial velocity field based on a coarse-grained maximum likelihood condition. This maximum likelihood (MaxL) estimator does not rely on the assumption that the underlying fields are Gaussian (hence we do not expect the analogue of the N (3/2) bias), and relies on the realization of the underlying fields rather than their statistical properties (and hence should incorporate a form of sample variance cancellation). We therefore expect the MaxL estimator to have advantages over the QE in the high signal to noise regime, where the kSZ effect is signal dominated (e.g. over the primary CMB, instrumental noise, and foregrounds) in the CMB on small angular scales. Because it relies on the properties of a realization, forecasting with the MaxL estimator requires simulations, unlike the QE, whose statistical properties can be calculated analytically. We create properly correlated random Gaussian realizations of the underlying fields and make direct comparisons between the reconstruction of the QE as implemented previously [7] and the MaxL estimator. Because the realizations are purely Gaussian, we are unable to demonstrate the absence of a non-Gaussian bias for the MaxL estimator, and therefore it will be important in future work to compare the results of applying the MaxL estimator and QE to N-body simulations.\nA key ingredient of the MaxL estimator is an estimate of the optical depth field. In the absence of a direct measurement (e.g. by using a large number of Fast Radio Bursts [11]), we must infer the optical depth from a tracer of large scale structure, such as a galaxy survey. This inference will be imperfect, leading to a multiplicative optical depth bias on the reconstructed velocities [6, 11\u201313]. Further multiplicative biases will be introduced by redshift errors in the galaxy survey and various systematics in the galaxy and CMB surveys. These multiplicative biases on the QE are described in detail in Ref. [7], and in this paper we describe their nature using a simplistic estimator for the optical depth field. Our implementation of the MaxL estimator can likely be improved upon through the use of more accurate methods to estimate the optical depth field, e.g. using machine learning techniques trained on accurate hydrodynamical simulations (see e.g. [14]).\nThe plan of the paper is as follows. In Sec. II we provide some intuition and motivation for the MaxL estimator. In Sec. III we review our model for the kSZ component of the temperature anisotropies, which is largely a review of Ref. [7]. In Sec. IV, we derive an implementation of the maximum likelihood estimator (given the optical depth field) for the radial velocity field in both harmonic space and map space. In Sec. V we compare the performance of the MaxL estimator and QE on a set of correlated Gaussian mock datasets. In Sec. VI we discuss inference of the optical depth field from a galaxy redshift survey and the associated optical depth bias on the reconstructed velocity; we conclude in Sec. VII.\nSome notation\nThroughout the paper, we refer to objects defined on a sphere in both in \u201charmonic\u201d and \u201cmap\u201d space. We label the multipole moments of fields in harmonic space by the pairs (`,m), (`\u2032,m\u2032) . . . and of the pixels in map space by the letters i, j, . . .. For coarse-grained quantities, we use capital letters (L,M), (L\u2032,M \u2032), . . . or I, J . . .. We denote operators in boldface, such that \u03c4 is a field but \u03c4 is an operator.\nII. INTUITION AND MOTIVATION\nIn this section we give a heuristic description of the QE that recovers the radial velocity field from a temperature and optical depth measurement, and motivate a new estimator that can avoid some of the QE reconstruction noise in the high-signal-to-noise regime of velocity reconstruction.\nThe kSZ contribution to the CMB temperature \u0398 is of the form \u03c4v, where v is the radial velocity field and \u03c4 is the optical depth field, such that\n\u0398 = \u0398pCMB + \u0398kSZ,\n\u223c \u0398pCMB + \u03c4v, (1)\nwhere \u0398pCMB describes all contributions to the temperature anisotropies that are not kSZ (this includes primary CMB contributions as well as other foreground contributions and instrumental noise). Here, we\n3 employ a toy model where kSZ is sourced by a two dimensional field; later we include line of sight effects. The goal is to use a measurement of \u0398 and \u03c4 to recover v. The QE recovers the velocity from this combination and their statistics:\nv\u0302QE \u223c 1 A \u0398 \u03c4, (2)\nwhere A is a theoretically calculated filter that can be thought of as \u223c \u2329 \u03c42 \u232a ; it is calculated from the ensemble statistics of \u03c4 . The QE differs from the true velocity by\nv\u0302QE \u2212 v \u223c 1\u3008\u03c42\u3009\u0398 \u03c4 \u2212 v\n\u223c v ( \u03c42 \u3008\u03c42\u3009 \u2212 1 ) + \u0398pCMB \u3008\u03c42\u3009 . (3)\nIn particular, there is a contribution to the residual sourced by the difference of the realization of \u03c42 from its theoretically expected variance. This contribution persists even when \u0398pCMB is vanishingly small.\nHowever, in the limit where the \u0398kSZ contributions dominate over the non-kSZ contributions, we can avoid this contribution to the reconstruction noise by neglecting \u0398pCMB and simply \u201cinverting\u201d Eq. (1):\nv\u0302 \u223c \u0398 \u03c4 . (4)\nIn this case, the \u201creconstruction noise\u201d only has contributions from the non-kSZ contributions to the temperature:\nv\u0302 \u2212 v \u223c \u0398 pCMB\n\u03c4 . (5)\nThis allows us to make a lower-noise estimate of v by utilizing angular scales where the kSZ temperature dominates over the other contributions to the CMB temperature, similar to what is done in the gradientinversion approach to CMB lensing reconstruction [15].\nIn the remainder of this Paper, we develop this idea more rigorously by deriving a new estimator from the maximization of a likelihood, and compare explicitly the performance of the \u201cMaxL\u201d estimator with that of the QE. Note that further complication arises from the fact that the kSZ temperature is not truly sourced by the product of one velocity and one electron density field, as in Eq. (1), but by the integral of this product along the line of sight. We will deal with this explicitly by \u201credshift-binning\u201d the velocity and optical depth fields, with the end-goal being to reconstruct the redshift-binned velocity field."
        },
        {
            "heading": "III. THE KINETIC SUNYAEV ZEL\u2019DOVICH EFFECT",
            "text": "The observed kSZ temperature anisotropies in the direction n\u0302 are given by the line-of-sight integral over radial comoving distance \u03c7\n\u0398kSZ(n\u0302) = \u222b \u03c7max 0 d\u03c7 \u03c4\u0307(n\u0302, \u03c7)v(n\u0302, \u03c7). (6)\nHere, v(n\u0302, \u03c7) is the radial velocity field and the differential optical depth \u03c4\u0307(n\u0302, \u03c7) is\n\u03c4\u0307(n\u0302, \u03c7) = \u2212\u03c3Ta(\u03c7)n\u0304e(\u03c7) (1 + \u03b4e(n\u0302, \u03c7)) , (7)\nwith \u03c3T the Thompson cross section, a(\u03c7) the scale factor, n\u0304e(\u03c7) the cosmological mean electron density, and \u03b4e(n\u0302, \u03c7) the electron overdensity field. There are contributions to the kSZ signal from during and after the epoch of reionization. We are primarily concerned with the late-time kSZ effect in this paper2, and so in\n2 See Ref. [16] for a discussion of kSZ velocity reconstruction during the epoch of reionization.\n4 Eq. (6) we introduce a cutoff \u03c7max on the line of sight integral at some time after reionization (which also justifies our neglect of the optical depth factor e\u2212\u03c4 in this equation).\nFollowing Ref. [7], we decompose fields along the radial direction in the basis of Haar wavelets:\nv(n\u0302, \u03c7) = \u221e\u2211 s=0 vs(n\u0302)hs(\u03c7), (8)\nwhere hs are the Haar wavelet basis functions; these form a complete basis on the interval 0 \u2264 \u03c7 \u2264 \u03c7max. The Haar expansion has the additional useful property that if we truncate at a fixed index N , the sum in the Haar basis is simply related to a sum over radial tophat bin-averages over bins of equal comoving size \u2206\u03c7 = \u03c7max/N :\nv(n\u0302, \u03c7) = N\u22121\u2211 \u03b1=0 v\u03b1(n\u0302)\u03a0\u03b1(\u03c7) + \u221e\u2211 s=N vs(n\u0302)hs(\u03c7), (9)\nwhere \u03a0\u03b1 are radial top-hat bins. We will reserve Greek superscripts \u03b1, \u03b2, \u03b3, . . . to denote the tophat binaverages. The bin averages v\u03b1 give a coarse-grained description of the field on the past light cone, and the remaining sum over Haar moments gives the residual fine-grained information. We can therefore write the line of sight integral in Eq. (6) as the sum:\n\u0398kSZ(n\u0302) = \u221e\u2211 s=0 \u03c4s(n\u0302)vs(n\u0302) = N\u22121\u2211 \u03b1=0 \u03c4\u03b1(n\u0302)v\u03b1(n\u0302) + \u221e\u2211 s=N \u03c4s(n\u0302)vs(n\u0302), (10)\nwhere we have defined \u03c4\u03b1(n\u0302) \u2261 \u2206\u03c7 \u03c4\u0307\u03b1(n\u0302). Below, we approximate the continuum limit by truncating at fixed N . For the contribution to kSZ from the redshift range 0 < z < 5 most of the kSZ autopower is captured for N = 512 as shown in Ref. [7]. However, in practice we will have to truncate the sum at a somewhat lower value of N for the application of the estimators derived below.\nIt will be useful to think of the optical depth as a set of N operators that map the bin-averaged radial velocity field to the observed temperature anisotropies, in which case we can write the sky-basis-independent equation truncated at fixed N :\n\u0398kSZ ' N\u22121\u2211 \u03b1=0 \u03c4\u03b1 \u00b7 v\u03b1. (11)\nHere, just as any field defined on a sphere, \u0398kSZ can be represented either in map space or harmonic space. In map space, \u0398i has dimension equal to the number of pixels Npix at some resolution (e.g. using the Healpix pixelization scheme [17]); v\u03b1i is a set of N fields each with dimension equal to Npix; \u03c4 \u03b1 ij is a set of N operators each with dimension equal to Npix \u00d7 Npix. In harmonic space, \u0398`m has dimension equal to the number of modes required to describe the field at the appropriate resolution (which should in principle be equal to Npix, but in practice is somewhat larger); we denote this number as Nharm. In Appendix A, we present the form of \u03c4 in each representation, as well as a mixed harmonic-map space representation."
        },
        {
            "heading": "IV. MAXIMUM LIKELIHOOD ESTIMATOR",
            "text": "The dominant blackbody components of the observed CMB temperature anisotropies are the lensed primary CMB and the late-time and reionization kSZ. Neglecting the reionization kSZ, the blackbody component of the temperature anisotropy is given by:\n\u0398 = \u0398pCMB + \u221e\u2211 s=0 \u03c4s \u00b7 vs. (12)\nHere \u0398pCMB are the primary CMB anisotropies in map or harmonic space, which we assume purely Gaussian with covariance CpCMB. The likelihood function L for the primary CMB is then\nlnL = (\u0398\u2212 \u221e\u2211 s=0 \u03c4 s \u00b7 vs)\u2020(CpCMB)\u22121(\u0398\u2212 \u221e\u2211 s=0 \u03c4 s \u00b7 vs) + ln det CpCMB (13)\n5 Extremizing L with respect to (vq)\u2020:\n\u03b4\n\u03b4(vq)\u2020 lnL = (\u03c4 q)\u2020(CpCMB)\u22121 (\u0398\u2212 \u221e\u2211 s=0 \u03c4 s \u00b7 vs) = 0\n=\u21d2 (\u03c4 q)\u2020(CpCMB)\u22121\u0398 = \u221e\u2211 s=0 [ (\u03c4 q)\u2020(CpCMB)\u22121\u03c4 s ] \u00b7 vs\n(\u03c4\u03b1)\u2020(CpCMB)\u22121\u0398 ' N\u22121\u2211 \u03b2=0 [ (\u03c4\u03b1)\u2020(CpCMB)\u22121\u03c4\u03b2 ] \u00b7 v\u03b2 . (14)\nIn the last line we truncate the radial sum at N and work with the bin coefficients (denoted by the Greek indices). Note that \u0398 and \u03c4 are fixed, and our goal is to find the set of v\u03b1 that maximize the likelihood. Organizing both v\u03b2 and (\u03c4\u03b1)\u2020(CpCMB)\u22121\u0398 into (Npix \u00d7N)-dimensional vectors containing both the bin and pixel information, and organizing [ (\u03c4\u03b1)\u2020(CpCMB)\u22121\u03c4\u03b2 ] into an (NpixN) \u00d7 (NpixN)-dimensional operator, Eq. (14) is a linear equation for the velocity field:[ \u03c4 \u2020(CpCMB)\u22121\u0398 ] = [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ] \u00b7 v. (15)\nThis equation will have a solution when the operator \u03c4 \u2020(CpCMB)\u22121\u03c4 has a well-defined inverse. In general, this isn\u2019t the case, since there will be many highly oscillatory functions v that nearly satisfy the maximum likelihood condition and pixels at which the operator (whose eigenbasis is in map space) is nearly zero (indicating small eigenvalues). However, we can first perform the matrix products in \u03c4 \u2020(CpCMB)\u22121\u03c4 at full resolution, and then coarse-grain this operator so that it is invertible. The maximum-likelihood condition is then\nW ([ \u03c4 \u2020(CpCMB)\u22121\u0398 ]) = W ([ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]) \u00b7W (v)\n=\u21d2 W (v) = [ W ([ \u03c4 \u2020(CpCMB)\u22121\u03c4 ])]\u22121 W ([ \u03c4 \u2020(CpCMB)\u22121\u0398 ]) (16)\nwhere W (\u00b7) is the coarse-graining procedure; we demonstrate explicitly below that it is appropriate to separately coarse-grain [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ] and v. The proposal is that with Eq. (16), we can reconstruct\nthe coarse-grained velocity W (v). We now separately examine if there is a useful solution to the maximum likelihood condition in harmonic or map space for the velocity field."
        },
        {
            "heading": "A. Harmonic space estimator",
            "text": "Before coarse graining, the maximum likelihood condition in harmonic space is[ \u03c4 \u2020(CpCMB)\u22121\u0398 ]\u03b1 `m = \u2211\n`\u2032m\u2032; \u03b2\n[ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 `m;`\u2032m\u2032 v\u03b2`\u2032m\u2032 . (17)\nIn Appendix A we evaluate the components of the operators and vectors in Eq. (17) explicitly, obtaining:[ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 `m;`\u2032m\u2032 = \u222b d\u2126 \u03c4\u03b1(n\u0302)\u03c4\u0304\u03b2(n\u0302)Y \u2217`m(n\u0302)Y`\u2032m\u2032(n\u0302), (18)\nand [ \u03c4 \u2020(CpCMB)\u22121\u0398 ]\u03b2 `m = \u222b d\u2126 \u03c4\u03b2(n\u0302)\u0398\u0304(n\u0302)Y \u2217`m(n\u0302), (19)\nwhere the bar denotes inverse-variance filtering using CpCMB` :\nA\u0304(n\u0302) \u2261 \u2211 `m A`m CpCMB` Y`m(n\u0302). (20)\n6 The coarse-graining operation required to make the operator [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 `m;`\u2032m\u2032 invertible is to cut off the sum at a maximum multipole Lmax, which will be the maximum multipole of the v field that we recover; for more details, see Appendix B. After this coarse-graining, the maximum-likelihood solution for the velocity is:\nv\u0302\u03b1LM = Lmax\u2211 L\u2032M \u2032 N\u22121\u2211 \u03b2=0 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b2 LM ;L\u2032M \u2032 (\u03c4 \u2020(CpCMB)\u22121\u0398)\u03b2L\u2032M \u2032 , (21)\nwhere the Lmax cut-off should be done after the calculation of \u03c4 \u2020(CpCMB)\u22121\u03c4 but before its inversion. The maximum values N and Lmax must be empirically determined from the numerical inversion\nof [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 `m;`\u2032m\u2032 for each realization. A crude approach to finding an approximate solution to the maximum likelihood condition Eq. (17) is to substitute with the ensemble-average operator over realizations of the optical depth, which is explicitly invertible. This approach is presented in Appendix C, where we demonstrate that it yields an expression equivalent to the QE in the low signal-to-noise regime. We note that Eq. (21) is nearly identical to an estimator that was successfully used to reconstruct our peculiar velocity with respect the CMB rest frame using the thermal Sunyaev Zel\u2019dovich effect [18].\nWe now compute the mean and variance of the MaxL estimator. The estimator Eq. (21) is based on a fixed realization of the optical depth, so the statistics of the estimator should be computed over an ensemble of realizations of the primary CMB which we denote by \u3008\u3009\u0398. In this ensemble, the mean of the estimator is:\n\u3008v\u0302\u03b1LM \u3009\u0398 = L\u2032max\u2211 L\u2032M \u2032 N\u22121\u2211 \u03b2=0 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b2 LM ;L\u2032M \u2032 \u3008 [ \u03c4 \u2020(CpCMB)\u22121\u0398 ]\u03b2 L\u2032M \u2032 \u3009\u0398. (22)\nWe find that\n\u3008v\u0302\u03b1LM \u3009\u0398 = v\u03b1LM + \u03b2\u03b1LM , (23) where \u03b2 is a \u201ccoarse-graining\u201d bias\n\u03b2\u03b1LM \u2261 Lmax\u2211 L\u2032M \u2032 N\u22121\u2211 \u03b3=0 \u221e\u2211 c=N Lmax\u2211 L\u2032\u2032M \u2032\u2032 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b3 LM ;L\u2032M \u2032 [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b3cL\u2032M \u2032;L\u2032\u2032M \u2032\u2032v c L\u2032\u2032M \u2032\u2032 . (24)\nDetails of the calculation that leads to (23) are in Appendix D 1. We also calculate the variance of the estimator, and find that\n\u3008v\u0302\u03b1LM v\u0302\u03b2L\u2032M \u2032\u3009\u0398 = (Cvv)\u03b1\u03b2LM ;L\u2032M \u2032 +N\u03b1\u03b2LM ;L\u2032M \u2032 , (25) with\n(Cvv)\u03b1\u03b2LM ;L\u2032M \u2032 = (v \u03b1 LM + \u03b2 \u03b1 LM )(v \u03b2 L\u2032M \u2032 + \u03b2 \u03b2 L\u2032M \u2032), (26)\nand\nN\u03b1\u03b2LM ;L\u2032M \u2032 = ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b2 LM ;L\u2032M \u2032 . (27)\nUnlike the QE [5, 7], where one must assume that the underlying fields are Gaussian, it is not necessary to make any assumptions about the statistics of the optical depth or velocity fields. Therefore, we do not expect additional contributions to the estimator variance beyond what is presented here. This is in contrast to the QE, where extra contributions to the estimator variance arise from the non-Gaussian nature of the optical depth and velocities [10]. We view this as a significant advantage of the MaxL estimator, since these non-Gaussian contributions are difficult to compute and remove.\nEvaluating the harmonic space MaxL estimator in Eq. (21) requires costly, and potentially numerically inaccurate, forward and reverse spherical harmonic transforms. Motivated by this, in the next section we construct a map space estimator. Ultimately, the implementation of the map space estimator is simpler and more accurate, and will be the method used for the forecasts presented below. However, there may be contexts in which the harmonic space estimator is superior, as we comment on below.\n7"
        },
        {
            "heading": "B. Map space estimator",
            "text": "We now derive an alternative coarse graining procedure and obtain a MaxL estimator defined in terms of fields in map space. In map space, (as demonstrated in Appendix A) the maximum likelihood condition can be written explicitly as\n\u03c4\u03b1(n\u0302)\u0398\u0304(n\u0302) = N\u22121\u2211 \u03b2=0 \u03c4\u03b1(n\u0302)\u03c4\u0304\u03b2(n\u0302)v\u03b2(n\u0302), (28)\nwhere the bar denotes inverse-variance filtering by CpCMB` :\nA\u0304(n\u0302) \u2261 \u2211 `m A`m CpCMB` Y`m(n\u0302). (29)\nTo coarse-grain, we define a set of smoothing kernels WI(n\u0302) with compact support in regions of the map labeled by I = 1, 2, . . . Imax such that \u222b\nd\u2126 WI(n\u0302)WJ(n\u0302) = \u03b4IJ \u2206\u03b82\n(30)\nwhere we have assumed each kernel is non-zero over the same solid angle \u2206\u03b82 for all I. A simple choice for WI(n\u0302) satisfying this criterion, utilized below, is a simple average over equal-area pixels. Note that this is only one choice of definition for WI(n\u0302) among many possibilities. Multiplying both sides of Eq. (28) by WI(n\u0302) and integrating over the map, we obtain\u222b\nd\u2126 WI(n\u0302)\u03c4 \u03b1(n\u0302)\u0398\u0304(n\u0302) = N\u22121\u2211 \u03b2=0 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b1(n\u0302)\u03c4\u0304\u03b2(n\u0302)v\u03b2(n\u0302). (31)\nExpanding the velocity in terms of an average velocity v\u03b2I over the region of the map labeled by I and a residual \u2206v\u03b2I (n\u0302) in the same region, we have\u222b d\u2126 WI(n\u0302)\u03c4 \u03b1(n\u0302)\u0398\u0304(n\u0302) =\nN\u22121\u2211 \u03b2=0 v\u03b2I \u222b d\u2126 WI(n\u0302)\u03c4 \u03b1(n\u0302)\u03c4\u0304\u03b2(n\u0302) + N\u22121\u2211 \u03b2=0 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b1(n\u0302)\u03c4\u0304\u03b2(n\u0302)\u2206v\u03b2I (n\u0302). (32)\nDefining the operators\nWI;\u03b1\u03b2 \u2261 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b1(n\u0302)\u03c4\u0304\u03b2(n\u0302), (33)\nwe have the following estimator for the average velocity in region I:\nv\u0302\u03b1I = N\u22121\u2211 \u03b2=0 WI;\u03b1\u03b2\u22121 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b2(n\u0302)\u0398\u0304(n\u0302). (34)\nIn Appendix C, we demonstrate that the QE in the low signal-to-noise regime is recovered upon replacing WI;\u03b1\u03b2 \u2192 \u3008WI;\u03b1\u03b2\u3009\u03c4 .\nIn our implementation of the map space estimator, we employ the Healpix equal-area pixelization scheme [17]. If we define the input fields at a native Healpix resolution with pixels indexed by i = 1, 2, . . . N inpix and the regions I are defined by pixels at a degraded Healpix resolution Noutpix , then we can write a discrete version of the MaxL estimator:\nv\u0302\u03b1I = N\u22121\u2211 \u03b2=0 N inpix\u2211 i=1 WIi \u03c4 \u03b1 i \u03c4\u0304 \u03b2 i \u22121 N inpix\u2211 i=1 WIi \u03c4 \u03b2 i \u0398\u0304i  . (35)\n8 Note that WIi as defined here is simply the Healpix ud grade function \u2013 an operator that averages pixels at a fine resolution labeled by i that fit within a coarse pixel labeled by I (see Ref. [17]).\nTaking an ensemble average over realizations of the primary CMB, the estimator mean is\n\u3008v\u0302\u03b1I \u3009\u0398 = v\u03b1I + \u03b2\u03b1I (36)\nwhere the additive bias \u03b2\u03b1I arises from coarse graining:\n\u03b2\u03b1I = N\u22121\u2211 \u03b2;\u03b3=0 WI;\u03b1\u03b2\u22121 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b2(n\u0302)\u03c4\u0304\u03b3(n\u0302)\u2206v\u03b3I (n\u0302)\n+ N\u22121\u2211 \u03b2=0 \u221e\u2211 c=N WI;\u03b1\u03b2\u22121 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b2(n\u0302)\u03c4\u0304 c(n\u0302)vc(n\u0302). (37)\nThe first term is the bias from the pixel-averaging operation and the second term is the bias from coarse graining along the line of sight. Moving to the estimator variance:\n\u3008v\u0302\u03b1I v\u0302\u03b2J \u3009\u0398 = (v\u03b1I + \u03b2\u03b1I ) ( v\u03b2J + \u03b2 \u03b2 J ) + 1\n\u2206\u03b82 WI;\u03b1\u03b2\u22121\u03b4IJ (38)\nJust as for the harmonic space estimator, the estimator variance includes an additive bias due to coarse graining as well as a reconstruction noise. Note that the reconstruction noise is local, and does not have any pixel-pixel covariance (although there is bin-bin covariance). A derivation of the estimator mean and variance can be found in Appendix D 2.\nThe map space estimator is local, only depending on the fields in the region supported by WI(n\u0302). This allows us to construct Imax independent N \u00d7 N operators WI;\u03b1\u03b2 , which are more easily (and accurately) inverted than the single (N2harmN) \u00d7 (N2harmN) operator needed for the harmonic space MaxL estimator. The local nature of the estimator also makes it a convenient choice for masked datasets. Indeed, one could generalize the discussion above to arbitrary complex pixelizations, suited to a particular procedure for masking, foreground removal, or anisotropic noise.\nV. IMPLEMENTATION AND FORECASTS\nIn this section, we describe an implementation of the MaxL estimator and compare its performance to the existing QE introduced in Ref. [5]. Unlike the QE, whose performance can be forecast from theoretical spectra, the performance of the MaxL estimator depends on the realization. We therefore must generate ensembles of simulations to compare the performance of the MaxL estimator to the QE. In this paper, we perform reconstructions on ensembles of properly correlated Gaussian simulations generated using the algorithm of [7]; an analysis of N-body simulations is an important direction for future work. Specifically, we first calculate the theoretical power spectra of the lensed primary CMB CpCMB` ; of the velocity field C vv ` ; and of the electron density field C\u03c4\u03c4` . We neglect the cross-power spectrum of electrons and velocity C \u03c4v ` since the estimators utilize the optical depth and velocities on very different scales. We use CAMB [19] to calculate quantities such as the primary CMB and linear matter power spectrum, with the non-linear regimes modelled with a halo model [7] (see e.g. Ref. [20] for a review of the halo model). The electrons are modelled with the density profiles of [21]. These power spectra are then used to create appropriately correlated Gaussian simulations of the binned velocity v and \u03c4 , as well as the primary CMB. To model the non-Gaussian kSZ map, we simply multiply and sum the simulated v and \u03c4 maps: \u0398kSZ = \u2211 v\u03b1\u03c4\u03b1. We use 32 redshift bins between z = 0.2 and z = 5, and employ a binning scheme such that each bin has equal comoving width. Further details of this implementation are given in Sec. III of [7]. We consider the idealized scenario where all non-blackbody foregrounds are absent and where we neglect the non-Gaussianities induced by lensing of the primary CMB. A discussion of these effects in the context of the QE can be found in Ref. [7].\nIn Fig. 1 we show the ensemble averaged power spectra of the (lensed) primary CMB and of the kSZ effect. Note that we only include power from the 32 redshift bins between 0.2 < z < 5 used in our analysis, while Ref. [7] demonstrated that approximately 512 radial bins are necessary to capture the majority of the kSZ power in this redshift range. We continue with this model in order to be self-consistent, as using a larger\nnumber of bins would be too computationally expensive. We do not expect this approximation to affect our conclusions.\nThroughout this section, we consider the case where we have access to a direct measurement of the optical depth. In practice, we will not have access to such a map: one must use a tracer of the electrons such as a galaxy survey. Connecting such a tracer to the optical depth necessitates further modelling, in particular through the cross power spectrum C\u03c4g` . Incorrect modelling of C \u03c4g ` leads to a bias on the reconstruction known as the optical depth bias; we comment on this further in Section VI. Additionally, we first consider the case where C\u03c4\u03c4` is known to arbitrarily high resolution, and don\u2019t consider realistic effects such as the shot noise of a galaxy survey or redshift error on a photometric survey.\nWe have validated two pipelines, based the map and harmonic space MaxL estimators presented above. We find that the map space estimator has a number of computational advantages. The harmonic space estimator involves several forward and reverse spherical harmonic transforms, which in the Healpix pixelization are not information-preserving. This loss of information leads to numerical inaccuracies in the reconstruction which can be overcome by using exact, but less efficient, pixelization schemes. In addition, the operator inversion required in the velocity estimator is costly when incorporating the full multipole and bin covariance; this places computational limitations on the degree of coarse graining that can be considered. The map space estimator overcomes both of these challenges, and so we focus on this implementation in what follows.\nIn our first illustration of the MaxL estimator, we completely remove the primary CMB and perform reconstruction on kSZ maps alone (we add a negligible amount of white noise to ensure that we are not dividing by zero when we filter). We use the equal-area Healpix pixelization [17], where the resolution is set by the parameter Nside, related to the number of pixels in the map by Npix = 12N 2 side. We apply both the MaxL estimator and the QE to the kSZ-only and optical depth maps for a single realization at a native resolution of N inside = 2048. Recalling the discussion in Sec. II, we expect the QE to be limited by reconstruction noise, while the MaxL estimator is formally noiseless if the maximum likelihood condition can be inverted without coarse graining. Some degree of coarse graining is necessary for a well-defined solution to the maximum likelihood condition, and we therefore expect the MaxL estimator to be limited by the additive coarse graining bias as described in the previous section.\nThe power spectrum of the true velocity and the power spectrum of the reconstruction residuals (defined by v\u0302 \u2212 v) are shown in Fig. 2. For the QE, we perform the reconstruction at a resolution of Noutside = 128; for the MaxL estimator, we perform the reconstruction at a variety of resolutions Noutside = 16, 64, 128. For low-resolution output maps (Noutside = 16) the MaxL estimator in fact performs worse than the QE due to a large coarse-graining bias \u03b2, but as we increase Noutside the MaxL estimator becomes superior as expected. We have explicitly checked that the residual agrees with \u03b2 as calculated directly from (37).\nWhen we include the primary CMB in the temperature maps, we do not expect the improvement of the MaxL estimator over the QE to be as dramatic. In this case, the MaxL estimator will have both reconstruction noise and an additive coarse-graining bias (see Eq. (38)). We only expect the MaxL estimator to improve upon the QE when the resolution of the input maps is high enough to probe the regime where\n10\nthe amplitude of the kSZ anisotropies are comparable to those of the primary CMB. To test this expected resolution-dependence, we produce input maps at N inside = 1024, 2048. In Fig. 3 we compare the velocity reconstruction using the quadratic and MaxL estimators for Noutside = 16, 64, 128 using maps with N in side = 2048. In Fig. 4 we plot the ratio of the total signal to noise for the MaxL estimator and the QE; the signal to noise is defined as\nS/NL =\n\u221a Tr [ Cv\n\u03b1v\u03b2 L\n( N v\u0302\n\u03b1v\u0302\u03b2 L\n)\u22121] (39)\nwhere Cv \u03b1v\u03b2 L is the (true) signal matrix and we use the power of the residual as a proxy for the noise N v\u0302\u03b1v\u0302\u03b2\nL . We see that the signal to noise for the MaxL estimator is comparable to that of the QE for N inside = 1024. Increasing to N inside = 2048, the MaxL signal to noise per mode is approximately 25% higher than for the QE on small angular scales, and significantly higher on large angular scales. This demonstrates the improvement in performance expected once angular scales on which kSZ power is significant compared to the primary CMB are included.\nFrom these results we see that with perfect knowledge of the optical depth field and including only the\n11\nprimary CMB and kSZ temperature anisotropies, the MaxL estimator does yield a higher fidelity reconstruction than the QE for sufficiently high resolution data. In the next section, we take one step towards increasing realism and compare the performance of the MaxL and quadratic estimators when the optical depth is inferred from a galaxy survey."
        },
        {
            "heading": "VI. ESTIMATING THE OPTICAL DEPTH",
            "text": "In the absence of a direct measure of the differential optical depth, we must estimate it from a tracer in order to implement the maximum likelihood estimators introduced above. A simple estimator is:\n\u03c4\u0302\u03b1`m = N\u22121\u2211 \u03b2,\u03b3=0 (C\u03c4g) \u03b1\u03b2 ` ( [Cgg] \u22121 )\u03b2\u03b3 ` g\u03b3`m, (40)\nwhere g\u03b3`m is the redshift-binned galaxy density, (C gg) \u03b2\u03b3 ` is the galaxy power spectrum, and (C \u03c4g) \u03b1\u03b2 ` is the cross-power with the optical depth. The ensemble mean of this estimator is zero while the variance is:\n\u3008\u03c4\u0302\u03b1`m(\u03c4\u0302\u03b2`m)\u2020\u3009 = N\u22121\u2211 \u03b3,\u03b4=0 (C\u03c4g) \u03b1\u03b3 ` ( [Cgg] \u22121 )\u03b3\u03b4 ` (Cg\u03c4 ) \u03b4\u03b2 ` . (41)\nFor correlated Gaussian fields Eq. (40) will yield an optical depth that has the expected statistics. However, it is likely that there are superior ways to faithfully estimate the optical depth from the galaxy density. We leave this question to future work. Note that the estimator variance reduces to (C\u03c4\u03c4 ) \u03b1\u03b2 ` in the limit where the\nactual realization of the optical depth is related to the realization of the galaxy density by \u03c4\u03b1`m = \u2211 b\u03b1\u03b3` g \u03b3 `m; that is, when the optical depth in a redshift bin can be obtained by isotropically filtering a linear combination of the tracers in different bins.\nAn implementation of the MaxL estimator in this scenario involves two steps: first one estimates the optical depth field, then one uses in the MaxL estimator to obtain the reconstructed velocity. To compare the MaxL and quadratic estimators we must now include a galaxy field in our correlated Gaussian simulations. Following in the implementation in Ref. [7], we generate galaxy auto- and cross-spectra for an LSST-like galaxy survey. We refer the reader to Ref. [7] for complete details, but in brief: the galaxy spectra are generated using a halo model incorporating a realistic halo occupation distribution (HOD), with number density of galaxies in the survey assumed to be\nn(z) = ng 2z0\n( z\nz0\n)2 exp ( \u2212 z z0 ) , (42)\n12\nwith z0 = 0.3 and ng = 40 arcmin \u22122. The HOD and number density of objects determine the galaxy bias and galaxy shot noise in Cgg` ; the halo model is used to determine a self-consistent C g\u03c4 ` . Using these spectra as inputs, we generate properly correlated Gaussian maps of all fields at a Healpix resolution of N inside = 2048. Redshift errors associated with a photometric galaxy survey such as LSST lead to bin-bin correlations in the galaxy spectra on both large and small scales; we defer the inclusion of this effect to future work.\nUsing the Gaussian simulations described above, we implement the QE on the galaxy density and temperature (kSZ and primary CMB) maps using the theory spectra for Cgg` and C g\u03c4 ` as inputs. We then use Eq. (40) to estimate the optical depth from the galaxy density and apply the MaxL estimator to the estimated optical depth and temperature map. The reconstruction residuals v\u0302 \u2212 v for the MaxL and quadratic estimators are shown in Fig. 5. At low-redshfit (left panel), a high-fidelity reconstruction is possible, albeit at a lower signal-to-noise than what is possible using the optical depth itself as a tracer. At high redshift all galaxy density measurements are shot-noise dominated, as the galaxy density is very low. As such, it is not possible to reconstruct the high-z velocity; this is evident on the right hand side of Fig. 5. At both low- and high-redshift, the MaxL estimator performs at least as well as the QE, in this regime (N inside = 2048). Given that an LSST-like experiment is shot-noise dominated on small angular scales, the additional information leveraged by the MaxL estimator from the optical depth on small scales is significantly degraded. Because of this, it may be difficult to identify an implementation of the MaxL estimator that would outperform the QE for near-term experiments.\nWhen a tracer is used in the MaxL estimator, we must confront the inevitable modelling uncertainty involved in estimating the optical depth field. In the estimator Eq. (40), this modelling uncertainty arises through the theory spectra (C\u03c4g) \u03b1\u03b2 ` and (C gg) \u03b1\u03b2 ` that must be provided as inputs. As we demonstrate explicitly in Appendix E, the consequence is an overall multiplicative bias on the estimator mean, referred to in previous literature (e.g. [6, 11\u201313]) as the optical depth bias. Neglecting the coarse-graining bias, for the map space estimator we have:\n\u3008v\u0302\u03b1I \u3009 = N\u22121\u2211 \u03b3=0 R\u03b1\u03b3I v \u03b3 I , (43)\nwhere the optical depth bias matrix is\nR\u03b1\u03b3I \u2261 N\u22121\u2211 \u03b2=0 [\u222b d\u2126 WI(n\u0302)\u03c4\u0302 \u03b2(n\u0302)\u02c6\u0304\u03c4\u03b1(n\u0302) ]\u22121 \u222b d\u2126 WI(n\u0302)\u03c4\u0302 \u03b2(n\u0302)\u03c4\u0304\u03b3(n\u0302). (44)\nA hat on \u03c4 implies that it has been reconstructed from a tracer, while the absence of a hat indicates the actual optical depth. In complete generality, the optical depth bias matrix contains N2 \u00d7 Npix free parameters.\n13\nThese free parameters are completely degenerate with the N \u00d7Npix independent degrees of freedom in the coarse grained velocity. Fortunately, as argued in Appendix E, we expect that the optical depth bias does not depend on the pixel index I. Roughly, this follows from the assumption that the optical depth field is statistically isotropic. Furthermore, we expect that the dominant contribution to the off-diagonal \u03b1 6= \u03b3 components of the optical depth matrix are expected to arise from redshift errors in the tracer used to reconstruct the optical depth. This implies that there are only N free parameters in the optical depth bias matrix, so long as the redshift errors of the tracer can be well-characterized. This is consistent with the QE, where there are N free parameters expected in the optical depth bias [7]. A complete investigation of the optical depth bias will be the focus of future work."
        },
        {
            "heading": "VII. CONCLUSIONS",
            "text": "In this paper, we have introduced a new class of estimators for the radial velocity field (more generally, the remote dipole field) from the CMB temperature anisotropies induced by the kinetic Sunyaev Zel\u2019dovich effect and a tracer of the optical depth field. These MaxL estimators are based on a coarse-grained maximum likelihood condition, and we have introduced two coarse-graining schemes in harmonic and map space that can be used to solve for the maximum likelihood radial velocity field. We derived the expected properties of the MaxL estimator, and compared the performance of the MaxL estimator to the existing quadratic estimator using the correlated Gaussian simulation framework of Ref. [7].\nThe MaxL estimator introduced here has several advantages over the existing QE for velocity reconstruction. As we have demonstrated, the MaxL estimator can in principle yield a higher fidelity reconstruction than the QE in the high-resolution, low-noise frontier of future CMB experiments. The MaxL estimator is not derived based on the assumption that the optical depth field is Gaussian, and it therefore does not receive contributions from the non-Gaussian bias terms present in the QE [10]. The map space version of the MaxL estimator is numerically stable and simple to implement. It is absolutely local, making it a useful and versatile tool to apply to datasets containing masks and spatially varying foregrounds. The modular nature of the MaxL estimator makes it amenable to improvements in techniques used to estimate the optical depth field or improved coarse-graining schemes. Furthermore, applying both the quadratic and MaxL estimators to future datasets will be a useful diagnostic of various biases and systematics in each analysis.\nThere are a variety of directions to take in future work. An important first step is a comparison of the quadratic and MaxL estimators using N-body data, where some of the advantages of the MaxL estimator described above can be confirmed in a more realistic setting. Another line of inquiry is to determine better methods for estimating the optical depth field from a galaxy redshift survey, or other tracers of large scale structure such as the cosmic infrared background [22]. For example, machine learning techniques trained on simulations could capture non-Gaussian information to better model the tracer-optical depth correlations; such a framework could incorporate multiple tracers into an overall estimate of the optical depth field over a wide range of redshifts. It will also be important to develop an analysis framework incorporating a mask and spatially varying foreground mitigation techniques as exists for the QE [7]. Finally, one can construct an analogous set of MaxL estimators based on other CMB secondaries; for example, transverse velocity reconstruction from the moving lens effect [23] or remote quadrupole reconstruction from the polarized Sunyaev Zel\u2019dovich effect [5, 24]. Improved techniques to produce unbiased high-fidelity reconstruction of cosmological fields will yield significant scientific dividends for future experiments, maximizing the ability of these datasets to constrain fundamental properties of our Universe."
        },
        {
            "heading": "Acknowledgments",
            "text": "We thank R. Bloch, C. Hill, S. Hotinli, M. Madhavacheril, J. Mertens, M. Mu\u0308nchmeyer, and B. Sherwin for useful conversations and input at various stages of this project. MCJ is supported by the National Science and Engineering Research Council through a Discovery grant. This research was supported in part by Perimeter Institute for Theoretical Physics. Research at Perimeter Institute is supported by the Government of Canada through the Department of Innovation, Science and Economic Development Canada and by the Province of Ontario through the Ministry of Research, Innovation and Science. Some of the results in this paper have\n14\nbeen derived using the HEALPix package [17].\n[1] J. Aguirre et al. (Simons Observatory), JCAP 1902, 056 (2019), 1808.07445. [2] K. N. Abazajian et al. (CMB-S4) (2016), 1610.02743. [3] N. Sehgal et al. (2019), 1906.10134. [4] R. A. Sunyaev and I. B. Zeldovich, MNRAS 190, 413 (1980). [5] A.-S. Deutsch, E. Dimastrogiovanni, M. C. Johnson, M. Mu\u0308nchmeyer, and A. Terrana, Phys. Rev. D98, 123501\n(2018), 1707.08129. [6] K. M. Smith, M. S. Madhavacheril, M. Mu\u0308nchmeyer, S. Ferraro, U. Giri, and M. C. Johnson (2018), 1810.13423. [7] J. Cayuso, R. Bloch, S. C. Hotinli, M. C. Johnson, and F. McCarthy (2021), 2111.11526. [8] A. Terrana, M.-J. Harris, and M. C. Johnson, Journal of Cosmology and Astroparticle Physics 2017, 040 (2017),\n1610.06919. [9] J. I. Cayuso, M. C. Johnson, and J. B. Mertens, Phys. Rev. D 98, 063502 (2018), URL https://link.aps.org/\ndoi/10.1103/PhysRevD.98.063502. [10] U. Giri and K. M. Smith (2020), 2010.07193. [11] M. S. Madhavacheril, N. Battaglia, K. M. Smith, and J. L. Sievers (2019), 1901.02418. [12] N. Battaglia, JCAP 1608, 058 (2016), 1607.02442. [13] S. C. Hotinli, K. M. Smith, M. S. Madhavacheril, and M. Kamionkowski (2021), 2108.02207. [14] L. Thiele, F. Villaescusa-Navarro, D. N. Spergel, D. Nelson, and A. Pillepich, Astrophys. J. 902, 129 (2020),\n2007.07267. [15] B. Hadzhiyska, B. D. Sherwin, M. Madhavacheril, and S. Ferraro, Phys. Rev. D 100, 023547 (2019), 1905.04217. [16] S. C. Hotinli and M. C. Johnson (2020), 2012.09851. [17] K. M. Go\u0301rski, E. Hivon, A. J. Banday, B. D. Wandelt, F. K. Hansen, M. Reinecke, and M. Bartelmann, ApJ\n622, 759 (2005), astro-ph/0409513. [18] Y. Akrami et al. (Planck), Astron. Astrophys. 644, A100 (2020), 2003.12646. [19] A. Lewis, A. Challinor, and A. Lasenby, ApJ 538, 473 (2000), astro-ph/9911177. [20] A. Cooray and R. K. Sheth, Phys. Rept. 372, 1 (2002), astro-ph/0206508. [21] N. Battaglia, J. Cosmology Astropart. Phys. 2016, 058 (2016), 1607.02442. [22] F. McCarthy and M. C. Johnson, Phys. Rev. D 102, 043520 (2020), 1907.06678. [23] S. C. Hotinli, J. Meyers, N. Dalal, A. H. Jaffe, M. C. Johnson, J. B. Mertens, M. Mu\u0308nchmeyer, K. M. Smith,\nand A. van Engelen, Phys. Rev. Lett. 123, 061301 (2019), 1812.03167. [24] A.-S. Deutsch, M. C. Johnson, M. Mu\u0308nchmeyer, and A. Terrana, Journal of Cosmology and Astroparticle Physics\n2018, 034 (2018), 1705.08907v3."
        },
        {
            "heading": "Appendix A: Harmonic and map space representations",
            "text": "In this paper, we work both in harmonic space and in map space (also referred to as \u201cpixel\u201d or \u201creal\u201d space). In each case, we are considering fields in a different basis: in map space, we describe fields by associating a value to each pixel on a sphere, while in harmonic space we describe fields by expanding in the basis of spherical harmonics. In this Appendix, we briefly recall how to transform from one basis to another, considering both the fields themselves, and the operators on these fields."
        },
        {
            "heading": "1. Fields",
            "text": "A 2-dimensional field A(n\u0302) defined on a sphere can be represented in the map or harmonic basis: a(n\u0302) = \u2211 i aiPi(n\u0302) = \u2211 `m a`mY`m(n\u0302) (A1)\nwhere ai is the value of the field at each pixel Pi(n\u0302) and a`m are the spherical harmonic coefficients of the field decomposed onto the spherical harmonic basis Y`m(n\u0302). In the map basis, each pixel can be denoted i and the value ai is given by\nai = \u222b d\u2126 a(n\u0302)Pi(n\u0302) (A2)\n15\nwhere Pi is an element of the discrete pixelization basis. In the harmonic basis, fields can be represented as a sum over the spherical harmonic basis Y`m with the a`m\u2019s given by\na`m = \u222b d\u2126 a(n\u0302)Y \u2217`m(n\u0302). (A3)\nIn particular, we can go between map-space and harmonic-space according to\na`m =\n\u222b d\u2126 (\u2211 i aiPi(n\u0302) ) Y \u2217`m(n\u0302) = \u2211 i aiY \u2217 `m(n\u0302i); (A4)\nai = \u222b d\u2126 \u2211 `m a`mY`m(n\u0302)Pi(n\u0302) = \u2211 `m a`mY`m(n\u0302i), (A5)\nwhere Y`m(n\u0302i) \u2261 \u222b d\u2126Pi(n\u0302)Y`m(n\u0302), e.g. the spherical harmonic weighted over the pixel centered on n\u0302i."
        },
        {
            "heading": "2. Operators",
            "text": "We can decompose operators O on either basis. Thus the expression\nOb = c (A6)\ncan be written as \u2211 j Oijbj = ci, (A7)\nor \u2211 LM O`m;LMbLM = c`m. (A8)\nWe can also consider a mixed basis \u2211 LM Oi;LMbLM = ci. (A9)\nWe also have the relation\nO`m;LMbLM = \u2211 i OijbjY \u2217 `m(n\u0302i) (A10)\n= \u2211 i Oij \u2211 `\u2032m\u2032 b`\u2032m\u2032Y`\u2032m\u2032(n\u0302j)Y \u2217 `m(n\u0302i). (A11)"
        },
        {
            "heading": "3. The maximum likelihood condition in map and harmonic space",
            "text": "The maximum likelihood condition is[ \u03c4 \u2020(CpCMB)\u22121\u0398 ] = [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ] \u00b7 v. (A12)\nTo write this in harmonic or map space, we need to form both the operator \u03c4 \u2020(CpCMB)\u22121\u03c4 and the vector \u03c4 \u2020(CpCMB)\u22121\u0398 in map and harmonic space. Let us first consider the operator \u03c4 \u2020(CpCMB)\u22121\u03c4 .\nFirst, it will be useful to write the elements of \u03c4 and CpCMB. In map space, \u03c4 is diagonal:\n\u03c4\u03b1ij = \u03c4 \u03b1 i \u03b4ij (A13)\n16\nwhere \u03c4\u03b1i are the components of the \u03c4 \u03b1 field in the position basis and \u03b4ij is the Kronecker delta, the identity on map space. Using the basis-transformation Eq. (A11) for a diagonal operator on map space gives\n\u03c4\u03b1`m;LM = \u2211 `\u2032m\u2032 \u03c4\u03b1`\u2032m\u2032 \u222b d\u2126 Y`\u2032m\u2032(n\u0302)YLM (n\u0302)Y \u2217 `m(n\u0302). (A14)\nWe can also write a mixed-basis expression\n\u03c4\u03b1i;LM = \u03c4 \u03b1 i YLM (n\u0302i). (A15)\nIt will be most helpful to consider CpCMB in harmonic space, where it is diagonal:\nCpCMB`m;`\u2032m\u2032 = C pCMB ` \u03b4``\u2032\u03b4mm\u2032 , (A16)\nwhere CpCMB` is the power spectrum of the primary CMB. Then we can evaluate[ (CpCMB)\u22121\u03c4 ]\u03b1 `\u2032\u2032m\u2032\u2032LM = \u2211 `m (CpCMB)\u22121`\u2032\u2032m\u2032\u2032`m\u03c4 \u03b1 `m;LM\n= \u2211\n`m; `\u2032m\u2032\n[\u222b d\u2126 Y`\u2032m\u2032YLMY \u2217 `m ] \u03c4\u03b1`\u2032m\u2032\nCpCMB` \u03b4``\u2032\u2032\u03b4mm\u2032\u2032 (A17)\n= \u2211 `\u2032m\u2032 (\u22121)m\u2032\u2032 \u221a (2`\u2032 + 1)(2L+ 1)(2`\u2032\u2032 + 1) 4\u03c0 ( L `\u2032 `\u2032\u2032 0 0 0 )( L `\u2032 `\u2032\u2032 M m\u2032 \u2212m\u2032\u2032 ) \u03c4\u03b1`\u2032m\u2032 CpCMB`\u2032\u2032\nwhere\n( L `\u2032 `\u2032\u2032 M m\u2032 \u2212m\u2032\u2032 ) is the Wigner 3J-symbol. Without making further assumptions, this is as far as we\ncan go. However, we will mainly be interested in the regime where L `\u2032, `\u2032\u2032. The triangle inequality restricts ` and `\u2032 to the range |`\u2032\u2032\u2212`\u2032| \u2264 L \u2264 `\u2032\u2032+`\u2032. So, as long as CpCMB`\u2032\u2032 is not a strongly varying function, we can approximate:\nCpCMB`\u2032\u2032 ' C pCMB `\u2032\u2032\u00b1L ' C pCMB `\u2032 . (A18)\nUnder this approximation, we have:\n\u2211 `m [ (CpCMB)\u22121 ] `\u2032\u2032m\u2032\u2032;`m \u03c4\u03b1`m;LM = \u222b d\u2126 [\u2211 `\u2032m\u2032 \u03c4\u03b1`\u2032m\u2032 CpCMB`\u2032 Y`\u2032m\u2032 ] YLMY \u2217 `\u2032\u2032m\u2032\u2032 , (A19)\nwhich has a nice mixed pixel-space harmonic-space representation:[ (CpCMB)\u22121 ] ij \u03c4\u03b1j;LM = \u03c4\u0304 \u03b1 i YLM (n\u0302i) (A20)\nwhere \u03c4\u0304\u03b1i is the inverse-variance filtered field\n\u03c4\u0304\u03b1i \u2261 \u2211 `\u2032m\u2032 \u03c4\u03b1`\u2032m\u2032 CpCMB`\u2032 Y`\u2032m\u2032(n\u0302i). (A21)\nWith these results, we can now form the operator [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ] . It is most convenient to do this using\nthe mixed representation:[ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 L\u2032M \u2032;LM = \u222b d\u2126 \u03c4\u03b1(n\u0302)\u03c4\u0304\u03b2(n\u0302)YL\u2032M \u2032(n\u0302) \u2217YLM (n\u0302). (A22)\nUsing an analogous set of arguments, we have:[ \u03c4 \u2020(CpCMB)\u22121\u0398 ]\u03b2 L\u2032M \u2032 = \u222b d\u2126 \u03c4\u03b2(n\u0302)\u0398\u0304(n\u0302)Y \u2217L\u2032M \u2032(n\u0302) (A23)\n17\nwhere, again, the bar denotes inverse-variance filtering: \u0398\u0304i \u2261 \u2211 `\u2032m\u2032 \u0398`\u2032m\u2032 CpCMB`\u2032 Y`\u2032m\u2032(n\u0302i). (A24)\nThe maximum likelihood condition is[ \u03c4 \u2020(CpCMB)\u22121\u0398 ]\u03b1 L\u2032M \u2032 = \u2211 LM ; \u03b2 [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 L\u2032M \u2032;LM v\u03b2LM . (A25)\nWe can also rotate into map space by first writing[ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 i;LM = \u03c4\u03b1i \u03c4\u0304 \u03b2 i YLM (n\u0302i) (A26)\nand [ \u03c4 \u2020(CpCMB)\u22121\u0398 ]\u03b1 i = \u03c4\u03b1i \u0398\u0304i. (A27)\nThe maximum likelihood condition is then:\n\u03c4\u03b1i \u0398\u0304i = \u2211 LM ; \u03b2 \u03c4\u03b1i \u03c4\u0304 \u03b2 i v \u03b2 LM YLM (n\u0302i) = N\u22121\u2211 \u03b2=0 \u03c4\u03b1i \u03c4\u0304 \u03b2 i v \u03b2 i . (A28)"
        },
        {
            "heading": "Appendix B: Coarse-graining",
            "text": "To determine if there is a solution to the maximum likelihood condition Eq. (A12), we must determine if the operator \u03c4 \u2020(CpCMB)\u22121\u03c4 is invertible for a particular coarse graining procedure. Note that this operator depends on the actual realization of the optical depth anisotropies, so there is some danger that an inverse exists for some realizations but not others. Nevertheless, we can get some idea of what to expect by examining the statistical properties of this operator over an ensemble of realizations of the optical depth anisotropies. For example, if we focus on the harmonic basis, the mean of the operator is:\n\u3008 [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 L\u2032M \u2032;LM \u3009\u03c4 = \u2211 `,`\u2032 (2`+ 1)(2`\u2032 + 1) 4\u03c0 ( ` `\u2032 L 0 0 0 )2 C\u03c4 \u03b1\u03c4\u03b2 `\u2032 CpCMB` \u03b4LL\u2032\u03b4MM \u2032 (B1)\nwhere the \u3008. . .\u3009\u03c4 denotes an ensemble average over the optical depth anisotropies. On average, we see that the operator is diagonal in harmonic space. If the sum is dominated by large-` (which we expect it to be) then it will also be nearly diagonal in bin-space. This is because the bin-bin correlations in C\u03c4 a\u03c4b\n` become vanishingly small at high-` as the scales probed by the angular projection become much smaller than the extent of the bins. Finding the variance of the operator:\n\u3008 ([ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 L\u2032M \u2032;LM )2 \u3009 ' \u3008 [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 L\u2032M \u2032;LM \u30092\n+ (\u2211 ` 2`+ 1 4\u03c0 [ C\u03c4 \u03b1\u03c4\u03b1 ` C \u03c4\u03b2\u03c4\u03b2 ` (CpCMB` ) 2 + C\u03c4 \u03b1\u03c4\u03b2 ` C \u03c4\u03b1\u03c4\u03b2 ` (CpCMB` ) 2 ])\u2211 `\u2032\u2032 (2`\u2032\u2032 + 1)(2L+ 1)(2L\u2032 + 1)\n\u00d7 ( L L\u2032 `\u2032\u2032\n0 0 0\n)2( L L\u2032 `\u2032\u2032 M M \u2032 M \u2212M \u2032 )2\n(B2)\nwhere we have assumed that the optical depth anisotropies are Gaussian and used the limit where L,L\u2032 are small. Notably, the variance is not diagonal in the harmonic coefficients, and becomes increasingly nondiagonal at higher L and L\u2032. It is also non-diagonal in bin space. Therefore, in a particular realization we can expect that the operator \u03c4 \u2020(CpCMB)\u22121\u03c4 becomes highly non-diagonal on small angular scales. This implies that the condition number could be quite large at full resolution, and there may be no well-defined inverse. Our strategy is therefore to coarse-grain the maximum likelihood condition by truncating at some empirically determined Lmax and N before solving for the velocity field.\n18"
        },
        {
            "heading": "Appendix C: Connecting to the quadratic estimator",
            "text": ""
        },
        {
            "heading": "1. Harmonic space estimator",
            "text": "In the low signal-to-noise regime, we can obtain the quadratic estimator from the maximum likelihood condition Eq. (21) by taking an ensemble average over the optical depth \u3008\u3009\u03c4 :[\n\u03c4 \u2020(CpCMB)\u22121\u0398 ]\u03b1 L\u2032M \u2032 = \u2211 LM ; \u03b2 \u3008 [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 L\u2032M \u2032;LM \u3009\u03c4 v\u03b2LM . (C1)\nThe ensemble average is given by Eq. (B1), which using the notation of Ref. [7] can be recognized as:\n\u3008 [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2 L\u2032M \u2032;LM \u3009\u03c4 = 1 2L+ 1 \u2211 `,`\u2032 Gv \u03b2\u03c4\u03b2 ``\u2032L f v\u03b2\u03c4\u03b1 `L`\u2032 \u03b4LL\u2032\u03b4MM \u2032 (C2)\nwith\nGv \u03b2\u03c4\u03b2 ``\u2032L = fv\n\u03b2\u03c4\u03b2\n`L`\u2032\nCpCMB` C \u03c4\u03b2\u03c4\u03b2 `\u2032\n; fv \u03b2\u03c4\u03b1\n`L`\u2032 =\n\u221a (2`+ 1)(2`\u2032 + 1)(2L+ 1)\n4\u03c0\n( ` `\u2032 L 0 0 0 ) C\u03c4 \u03b2\u03c4\u03b1 `\u2032 . (C3)\nThe left hand side of the maximum likelihood condition can be expanded to:[ \u03c4 \u2020(CpCMB)\u22121\u0398 ]\u03b1 LM = \u2211\n`m;`\u2032m\u2032\n(\u22121)M ( ` `\u2032 L m m\u2032 \u2212M ) Gv \u03b1\u03c4\u03b1 ``\u2032L \u0398`m\u03c4 \u03b1 `\u2032m\u2032 . (C4)\nFor a completely diagonal C\u03c4 \u03b2\u03c4\u03b1 `\u2032 = C \u03c4\u03b1\u03c4\u03b1\n`\u2032 \u03b4\u03b1\u03b2 , we solve the ensemble-averaged maximum likelihood condition to arrive at the traditional form for the quadratic estimator appearing in Refs. [5, 7]:\nv\u03b1LM = A v\u03b1 L \u2211 `m;`\u2032m\u2032 (\u22121)M ( ` `\u2032 L m m\u2032 \u2212M ) Gv \u03b1\u03c4\u03b1 ``\u2032L \u0398`m\u03c4 \u03b1 `\u2032m\u2032 (C5)\nwhere\nAv \u03b1 L \u2261  1 2L+ 1 \u2211 `,`\u2032 Gv \u03b1\u03c4\u03b1 ``\u2032L f v\u03b1\u03c4\u03b1 `L`\u2032 \u22121 . (C6) There are, however, a few crucial differences with the quadratic estimator presented in Refs. [5, 7]. In the traditional quadratic estimator, the weights needed for an unbiased minimum variance reconstruction require that everywhere above we replace CpCMB` \u2192 C pCMB ` + C kSZ ` . In the limit where C pCMB ` CkSZ` , as occurs for a sufficiently high-resolution low-noise CMB experiment, this is a non-negligible difference \u2013 as expected, since in this case the temperature anisotropies on small scales are very non-Gaussian, and far from the limit of Gaussian fields used to derive the quadratic estimator. Therefore, we only recover the traditional quadratic estimator in the limit where CpCMB` CkSZ` . This observation supports the notion that the maximum likelihood estimator will be superior in the high signal-to-noise regime. Another difference arises in the case where C\u03c4 \u03b2\u03c4\u03b1\n` is not diagonal. In this case, to find a solution to the ensemble averaged maximum likelihood\ncondition it is necessary to find the inverse of C\u03c4 \u03b2\u03c4\u03b1\n` (if it exists). The resulting solution is different than the approach presented in Ref. [7], which first constructs a set of biased estimators which are then de-biased by forming the appropriate linear combinations. The relevant differences would be interesting to explore further in future work.\n19"
        },
        {
            "heading": "2. Map space estimator",
            "text": "Just as for the harmonic space estimator, we can derive an ensemble average map space estimator. Starting from Eq. (32):\u222b\nd\u2126 WI(n\u0302)\u03c4 \u03b1(n\u0302)\u0398\u0304(n\u0302) = N\u22121\u2211 \u03b2=0 v\u03b2I \u222b d\u2126 WI(n\u0302)\u3008\u03c4\u03b1(n\u0302)\u03c4\u0304\u03b2(n\u0302)\u3009\u03c4 (C7)\n+ N\u22121\u2211 \u03b2=0 \u222b d\u2126 WI(n\u0302)\u3008\u03c4\u03b1(n\u0302)\u03c4\u0304\u03b2(n\u0302)\u3009\u03c4\u2206v\u03b2I (n\u0302) (C8)\n= N\u22121\u2211 \u03b2=0 v\u03b2I \u3008\u03c4\u03b1(0)\u03c4\u0304\u03b2(0)\u3009\u03c4 \u222b d\u2126 [ WI(n\u0302) + \u222b d\u2126 WI(n\u0302)\u2206v \u03b2 I (n\u0302) ] (C9)\n= N\u22121\u2211 \u03b2=0 v\u03b2I \u3008\u03c4\u03b1(0)\u03c4\u0304\u03b2(0)\u3009\u03c4 (C10)\nwhere we\u2019ve assumed that \u03c4\u03b1 is statistically isotropic, \u222b d\u2126 WI(n\u0302) = 1, and \u222b d\u2126 WI(n\u0302)\u2206v \u03b2 I (n\u0302) = 0 by definition. This suggests the following map space quadratic estimator:\nv\u0302\u03b1I = N\u22121\u2211 \u03b2=0 [ \u3008\u03c4\u03b2(0)\u03c4\u0304\u03b1(0)\u3009\u03c4 ]\u22121 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b1(n\u0302)\u0398\u0304(n\u0302). (C11)\nFor a diagonal variance \u3008\u03c4\u03b2(0)\u03c4\u0304\u03b1(0)\u3009\u03c4 = \u3008\u03c4\u03b1(0)\u03c4\u0304\u03b1(0)\u3009\u03c4\u03b4\u03b1\u03b2 , we can identify\n\u3008\u03c4\u03b1(0)\u03c4\u0304\u03b1(0)\u3009\u03c4 = 1\nAv \u03b1\nL=0\n(C12)\nas defined above in Eq. (C6). Since Eq. (C6) is nearly independent of L [5, 7], one can simply show that Eq. (C11) is equivalent to Eq. (C5) at low L, and also equivalent to the map based quadratic estimator presented in Refs. [5, 7] (with the same caveats as for the harmonic space estimator). In the low signal-tonoise regime, Eq. (C11) may be a simpler implementation of the quadratic estimator used in previous work. We leave further investigation of this point to future work."
        },
        {
            "heading": "Appendix D: Mean and variance of the MaxL estimator",
            "text": ""
        },
        {
            "heading": "1. Harmonic space estimator",
            "text": "The mean of the harmonic space estimator is\n\u3008v\u0302\u03b1LM \u3009\u0398 = L\u2032max\u2211 L\u2032M \u2032 N\u22121\u2211 \u03b2=0 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b2 LM ;L\u2032M \u2032 \u3008 [ \u03c4 \u2020(CpCMB)\u22121\u0398 ]\u03b2 L\u2032M \u2032 \u3009\u0398. (D1)\nTo calculate this, we must evaluate:\n\u3008 [ \u03c4 \u2020(CpCMB)\u22121\u0398 ]\u03b1 L\u2032M \u2032 \u3009\u0398 = \u222b d\u2126 \u03c4\u03b1(n\u0302) \u3008\u0398\u0304(n\u0302)\u3009\u0398 Y \u2217L\u2032M \u2032(n\u0302). (D2)\nThe observed temperature anisotropies consist of the zero-mean primary CMB and the kSZ:\n\u3008\u0398\u0304(n\u0302)\u3009\u0398 = \u3008\u0398\u0304pCMB(n\u0302)\u3009\u0398 + \u0398\u0304kSZ(n\u0302) = \u0398\u0304kSZ(n\u0302) (D3)\n20\nExpanding the kSZ anisotropies into coarse- and fine-grained components, we have \u3008 [ \u03c4 \u2020(CpCMB)\u22121\u0398 ]\u03b1 L\u2032M \u2032 \u3009\u0398 = \u222b d\u2126 \u03c4\u03b1(n\u0302) N\u22121\u2211 \u03b2=0 Lmax\u2211 LM \u03c4\u0304\u03b2(n\u0302)v\u03b2LMYLM (n\u0302)\n+ \u221e\u2211 b=N Lmax\u2211 LM \u03c4\u0304 b(n\u0302)vbLMYLM (n\u0302) + \u221e\u2211 b=0 \u221e\u2211 LM=Lmax \u03c4\u0304 b(n\u0302)vbLMYLM (n\u0302) ] Y \u2217L\u2032M \u2032(n\u0302)\n' N\u22121\u2211 \u03b2=0 Lmax\u2211 LM [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1\u03b2L\u2032M \u2032;LMv \u03b2 LM + \u221e\u2211 b=N Lmax\u2211 LM [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b1bL\u2032M \u2032;LMv b LM\nwhere we assumed that the dominant contributions from the velocity field are at low L. We therefore have\n\u3008v\u0302\u03b1LM \u3009\u0398 = v\u03b1LM + \u03b2\u03b1LM (D4) where\n\u03b2\u03b1LM \u2261 Lmax\u2211 L\u2032M \u2032 N\u22121\u2211 \u03b3=0 \u221e\u2211 c=N Lmax\u2211 L\u2032\u2032M \u2032\u2032 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b3 LM ;L\u2032M \u2032 [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b3cL\u2032M \u2032;L\u2032\u2032M \u2032\u2032v c L\u2032\u2032M \u2032\u2032 . (D5)\nSo, the estimator is unbiased up to an additive bias \u03b2\u03b1LM , which depends on the fine-grained radial velocity modes.\nMoving to the variance:\n\u3008v\u0302\u03b1LM v\u0302\u03b2L\u2032M \u2032\u3009\u0398 = Lmax\u2211\nLaMa;LbMb\nN\u22121\u2211 \u03b3;\u03b4=0 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b3 LM ;LaMa ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b2\u03b4 L\u2032M \u2032;LbMb\n\u00d7 \u222b \u222b\nd\u2126d\u2126\u2032 \u03c4\u03b3(n\u0302)\u03c4 \u03b4(n\u0302\u2032) \u3008\u0398\u0304(n\u0302)\u0398\u0304(n\u0302\u2032)\u3009\u0398 YLaMa(n\u0302)YLbMb(n\u0302\u2032). (D6)\nThere is a contribution to the temperature correlation function from the primary CMB and from the kSZ effect:\n\u3008\u0398\u0304(n\u0302)\u0398\u0304(n\u0302\u2032)\u3009\u0398 = \u2211 `m\n1\nCpCMB` Y`m(n\u0302)Y`m(n\u0302\n\u2032) + \u0398\u0304kSZ(n\u0302)\u0398\u0304kSZ(n\u0302\u2032). (D7)\nThe first term will give rise to the Gaussian estimator noise and the second will describe our signal and biases arising due to our coarse-graining of the maximum likelihood condition:\n\u3008v\u0302\u03b1LM v\u0302\u03b2L\u2032M \u2032\u3009\u0398 = (Cvv)\u03b1\u03b2LM ;L\u2032M \u2032 +N\u03b1\u03b2LM ;L\u2032M \u2032 . (D8)\nThe reconstruction noise N\u03b1\u03b2LM ;L\u2032M \u2032 arises due to the contribution from the primary CMB:\nN\u03b1\u03b2LM ;L\u2032M \u2032 = \u2211\nLaMa;LbMb;`m\n\u2211 \u03b3;\u03b4 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b3 LM ;LaMa ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b2\u03b4 L\u2032M \u2032;LbMb\n\u00d7 \u222b \u222b d\u2126d\u2126\u2032 \u03c4\u03b3(n\u0302)\u03c4 \u03b4(n\u0302\u2032) 1\nCpCMB` Y`m(n\u0302)Y`m(n\u0302\n\u2032)YLaMa(n\u0302)YLbMb(n\u0302 \u2032) (D9)\n' \u2211\nLaMa;LbMb\n\u2211 \u03b3;\u03b4 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b3 LM ;LaMa ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b2\u03b4 L\u2032M \u2032;LbMb\n\u00d7 \u222b d\u2126 \u03c4\u03b3(n\u0302)\u03c4\u0304 \u03b4(n\u0302) YLaMa(n\u0302)YLbMb(n\u0302) (D10)\n= \u2211\nLaMa;LbMb\n\u2211 \u03b3;\u03b4 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b3 LM ;LaMa ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b2\u03b4 L\u2032M \u2032;LbMb\n(D11)\n\u00d7 ( \u03c4 \u2020(CpCMB)\u22121\u03c4 )\u03b3\u03b4 LbMb;LaMa\n(D12)\n= ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b2 LM ;L\u2032M \u2032\n(D13)\n21\nwhere in going from the first to second lines we have assumed that CpCMB` does not vary too quickly on scales of order \u2206` = L and used the identity\u222b\nd2n Y`amaY`bmbY`cmcY`dmd = \u2211 `m (\u222b d2n Y`amaY`bmbY`m )(\u222b d2n\u2032 Y`cmcY`dmdY`m ) . (D14)\nFor the signal and bias due to \u2018fine modes\u2019 we have:\n(Cvv)\u03b1\u03b2LM ;L\u2032M \u2032 = \u2211\nLaMa;LbMb\n\u2211 \u03b3;\u03b4 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b3 LM ;LaMa ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b2\u03b4 L\u2032M \u2032;LbMb\n\u00d7 \u222b \u222b\nd\u2126d\u2126\u2032 \u03c4\u03b3(n\u0302)\u03c4 \u03b4(n\u0302\u2032) \u0398\u0304kSZ(n\u0302)\u0398\u0304kSZ(n\u0302\u2032) YLaMa(n\u0302)YLbMb(n\u0302 \u2032) (D15)\n' \u2211\nLaMa;LbMb\n\u2211 \u03b3;\u03b4;e;f ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b3 LM ;LaMa ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b2\u03b4 L\u2032M \u2032;LbMb\n\u00d7 \u222b \u222b\nd\u2126d\u2126\u2032 \u03c4\u03b3(n\u0302)\u03c4 \u03b4(n\u0302\u2032)\u03c4\u0304e(n\u0302)ve(n\u0302)\u03c4\u0304f (n\u0302\u2032)vf (n\u0302\u2032) YLaMa(n\u0302)YLbMb(n\u0302 \u2032)\n= \u2211\nLaMa;LbMb\n\u2211 \u03b3;\u03b4;e;f ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b3 LM ;LaMa ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b2\u03b4 L\u2032M \u2032;LbMb\n\u00d7 \u2211\nLcMc;LdMd\nveLcMcv f LdMd \u222b d\u2126 \u03c4\u03b3(n\u0302)\u03c4\u0304e(n\u0302)YLaMa(n\u0302)YLcMc(n\u0302) \u222b d\u2126\u2032\u03c4 \u03b4(n\u0302\u2032)\u03c4\u0304f (n\u0302\u2032)YLbMb(n\u0302 \u2032)YLdMd(n\u0302 \u2032)\n= \u2211\nLaMa;LbMb \u2211 LcMc;LdMd \u2211 \u03b3;\u03b4;e;f veLcMcv f LdMd ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b3 LM ;LaMa [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b3e LaMa;LcMc\n\u00d7 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b2\u03b4 L\u2032M \u2032;LbMb [ \u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u03b4f LbMb;LdMd = (v\u03b1LM + \u03b2 \u03b1 LM )(v \u03b2 L\u2032M \u2032 + \u03b2 \u03b2 L\u2032M \u2032). (D16)\nThe main assumption made in the derivation of the estimator mean and variance was that CpCMB` does not vary too quickly on scales of order \u2206` = L, which can always be satisfied for sufficiently small L. For modest values of L \u223c 100, we expect this to be a reasonable assumption at large ` where the primary CMB is smooth and dominated by lensing, instrumental noise, or reionization kSZ (depending on the instrument)."
        },
        {
            "heading": "2. Map space estimator",
            "text": "We now compute the mean and variance of the map space estimator. Starting with the mean:\n\u3008v\u0302\u03b1I \u3009\u0398 = N\u22121\u2211 \u03b2=0 WI;\u03b1\u03b2\u22121 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b2(n\u0302)\u0398\u0304kSZ(n\u0302), (D17)\n= N\u22121\u2211 \u03b2=0 WI;\u03b1\u03b2\u22121 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b2(n\u0302) \u221e\u2211 c=0 \u03c4\u0304 c(n\u0302) (vcI + \u2206v c I(n\u0302)) (D18)\n= N\u22121\u2211 \u03b2;\u03b3=0 v\u03b3IWI;\u03b1\u03b2 \u22121 WI;\u03b3\u03b2 + N\u22121\u2211 \u03b2;\u03b3=0 WI;\u03b1\u03b2\u22121 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b2(n\u0302)\u03c4\u0304\u03b3(n\u0302)\u2206v\u03b3I (n\u0302) (D19)\n+ N\u22121\u2211 \u03b2=0 \u221e\u2211 c=N WI;\u03b1\u03b2\u22121 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b2(n\u0302)\u03c4\u0304 c(n\u0302)vc(n\u0302) (D20) = v\u03b1I + \u03b2 \u03b1 I (D21)\n22\nwhere we have defined\n\u03b2\u03b1I = N\u22121\u2211 \u03b2;\u03b3=0 WI;\u03b1\u03b2\u22121 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b2(n\u0302)\u03c4\u0304\u03b3(n\u0302)\u2206v\u03b3I (n\u0302)\n+ N\u22121\u2211 \u03b2=0 \u221e\u2211 c=N WI;\u03b1\u03b2\u22121 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b2(n\u0302)\u03c4\u0304 c(n\u0302)vc(n\u0302). (D22)\nMoving to the estimator variance, we have:\n\u3008v\u0302\u03b1I v\u0302\u03b2J \u3009\u0398 = N\u22121\u2211 \u03b3;\u03b4=0 WI;\u03b1\u03b3\u22121WJ;\u03b2\u03b4\u22121 \u222b d\u2126d\u2126\u2032 WI(n\u0302)WJ(n\u0302 \u2032)\u03c4\u03b3(n\u0302)\u03c4 \u03b4(n\u0302\u2032)\u3008\u0398\u0304(n\u0302)\u0398\u0304(n\u0302\u2032)\u3009\u0398\n= N\u22121\u2211 \u03b3;\u03b4=0 WI;\u03b1\u03b3\u22121WJ;\u03b2\u03b4\u22121 [\u222b d\u2126 WI(n\u0302)\u03c4 \u03b3(n\u0302)\u0398\u0304kSZ(n\u0302) \u222b d\u2126\u2032 WJ(n\u0302 \u2032)\u03c4 \u03b4(n\u0302\u2032)\u0398\u0304kSZ(n\u0302\u2032)\n+ \u2211 `m \u222b d\u2126 WI(n\u0302)\u03c4 \u03b3(n\u0302)Y`m(n\u0302) \u222b d\u2126\u2032 WJ(n\u0302 \u2032) \u03c4 \u03b4(n\u0302\u2032) CpCMB` Y`m(n\u0302 \u2032) ]\n' (v\u03b1I + \u03b2\u03b1I ) ( v\u03b2J + \u03b2 \u03b2 J ) + N\u22121\u2211 \u03b3;\u03b4=0 WI;\u03b1\u03b3\u22121WJ;\u03b2\u03b4\u22121 \u222b d\u2126 WI(n\u0302)WJ(n\u0302)\u03c4 \u03b3(n\u0302)\u03c4\u0304 \u03b4(n\u0302)\n= (v\u03b1I + \u03b2 \u03b1 I ) ( v\u03b2J + \u03b2 \u03b2 J ) + 1\n\u2206\u03b82 WI;\u03b1\u03b2\u22121\u03b4IJ (D23)\nwhere in going from the second to the third line, we have made the approximation that CpCMB` is not too rapidly varying with scale, as we did in the derivation of the harmonic space estimator variance."
        },
        {
            "heading": "Appendix E: Optical depth bias",
            "text": "When we only have access to an estimate \u03c4\u0302 of the differential optical depth, the harmonic space estimator is given by\nv\u0302\u03b1LM = L\u2032max\u2211 L\u2032M \u2032 N\u22121\u2211 \u03b2=0 ( [\u03c4\u0302 \u2020(CpCMB)\u22121\u03c4\u0302 ]\u22121 )\u03b1\u03b2 LM ;L\u2032M \u2032 (\u03c4\u0302 \u2020(CpCMB)\u22121\u0398)\u03b2L\u2032M \u2032 (E1)\nComputing the estimator mean, we have:\n\u3008v\u0302\u03b1LM \u3009\u0398 = L\u2032max\u2211 L\u2032M \u2032 N\u22121\u2211 \u03b2=0 ( [\u03c4\u0302 \u2020(CpCMB)\u22121\u03c4\u0302 ]\u22121 )\u03b1\u03b2 LM ;L\u2032M \u2032 \u3008(\u03c4\u0302 \u2020(CpCMB)\u22121\u0398)\u03b2L\u2032M \u2032\u3009\u0398 (E2)\n= [ Lmax\u2211 L\u2032\u2032M \u2032\u2032 N\u22121\u2211 \u03b3=0 R\u03b1\u03b3LM ;L\u2032\u2032M \u2032\u2032v \u03b3 L\u2032\u2032M \u2032\u2032 ] + \u03b2\u0302\u03b1LM (E3)\nwhere\nR\u03b1\u03b3LM ;L\u2032\u2032M \u2032\u2032 = L\u2032max\u2211 L\u2032M \u2032 N\u22121\u2211 \u03b2=0 ( [\u03c4\u0302 \u2020(CpCMB)\u22121\u03c4\u0302 ]\u22121 )\u03b1\u03b2 LM ;L\u2032M \u2032 [\u03c4\u0302 \u2020(CpCMB)\u22121\u03c4 ]\u03b2\u03b3L\u2032M \u2032;L\u2032\u2032M \u2032\u2032 (E4)\nand\n\u03b2\u0302\u03b1LM \u2261 Lmax\u2211 L\u2032M \u2032 N\u22121\u2211 \u03b3=0 \u221e\u2211 c=N Lmax\u2211 L\u2032\u2032M \u2032\u2032 ( [\u03c4\u0302 \u2020(CpCMB)\u22121\u03c4\u0302 ]\u22121 )\u03b1\u03b3 LM ;L\u2032M \u2032 [\u03c4\u0302 \u2020(CpCMB)\u22121\u03c4 ]\u03b3cL\u2032M \u2032;L\u2032\u2032M \u2032\u2032v c L\u2032\u2032M \u2032\u2032 . (E5)\n23\nWhen \u03c4\u0302 = \u03c4 , this is simply the identity matrix, and we recover an unbiased estimator mean. In reality, an imperfect estimate of the differential optical depth will result in the mixing of information and therefore a bias. It is important to characterize the magnitude and properties of this bias to obtain useful cosmological information from the reconstruction.\nTo explore the optical depth bias a bit more, suppose we have a pretty good reconstruction of the differential optical depth, such that\n\u03c4\u0302\u03b1(n\u0302) = \u03c4\u03b1(n\u0302) + n\u03b1\u03c4 (n\u0302); n \u03b1 \u03c4 (n\u0302) \u03c4\u03b1(n\u0302). (E6)\nWe can approximate [\u03c4\u0302 \u2020(CpCMB)\u22121\u03c4\u0302 ]\u22121 ' [ 1\u2212 [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 \u00b7 [n\u03c4 \u2020(CpCMB)\u22121n\u03c4 ] ] \u00b7 [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 (E7)\nand therefore\nR\u03b1\u03b3LM ;L\u2032\u2032M \u2032\u2032 ' \u03b4\u03b1\u03b3\u03b4LM ;L\u2032\u2032M \u2032\u2032 \u2212 L\u2032max\u2211 L\u2032M \u2032 N\u22121\u2211 \u03b2=0 ( [\u03c4 \u2020(CpCMB)\u22121\u03c4 ]\u22121 )\u03b1\u03b2 LM ;L\u2032M \u2032 [n\u03c4 \u2020(CpCMB)\u22121n\u03c4 ] \u03b2\u03b3 L\u2032M \u2032;L\u2032\u2032M \u2032\u2032 . (E8)\nTaking an ensemble average over \u03c4 and n\u03c4 , and using Eq. (B1), we have\n\u3008R\u03b1\u03b3LM ;L\u2032\u2032M \u2032\u2032\u3009 ' \u03b4\u03b1\u03b3\u03b4LM ;L\u2032\u2032M \u2032\u2032 \u2212 \u03b4LM ;L\u2032\u2032M \u2032\u2032 \u03b2max\u2211 \u03b2 \u3008\u03c4\u03b1(0)\u03c4\u0304\u03b2(0)\u3009\u22121\u3008n\u03b2\u03c4 (0)n\u0304\u03b3\u03c4 (0)\u3009 (E9)\nwhere \u3008\u03c4\u03b1(0)\u03c4\u0304\u03b2(0)\u3009\u22121 is the bin-space inverse of Eq. (B1) and \u3008n\u03b2\u03c4 (0)n\u0304\u03b3\u03c4 (0)\u3009 is\n\u3008n\u03b2\u03c4 (0)n\u0304\u03b3\u03c4 (0)\u3009 = \u2211 ` 2`+ 1 4\u03c0 C n\u03b2\u03c4n \u03b3 \u03c4 ` CpCMB` . (E10)\nIn particular, note that on average in this limit the optical depth bias is independent of scale L\u2032\u2032M \u2032\u2032, and small when the differential optical depth is reconstructed well.\nFor the map space estimator, we have:\nv\u0302\u03b1I = N\u22121\u2211 \u03b2=0 [\u222b d\u2126 WI(n\u0302)\u03c4\u0302 \u03b2(n\u0302)\u02c6\u0304\u03c4\u03b1(n\u0302) ]\u22121 \u222b d\u2126 WI(n\u0302)\u03c4\u0302 \u03b2(n\u0302)\u0398\u0304(n\u0302). (E11)\nComputing the estimator mean:\n\u3008v\u0302\u03b1I \u3009 = N\u22121\u2211 \u03b3=0 R\u03b1\u03b3I v \u03b3 I + \u03b2\u0302 \u03b1 I (E12)\nwhere\nR\u03b1\u03b3I \u2261 N\u22121\u2211 \u03b2=0 [\u222b d\u2126 WI(n\u0302)\u03c4\u0302 \u03b2(n\u0302)\u02c6\u0304\u03c4\u03b1(n\u0302) ]\u22121 \u222b d\u2126 WI(n\u0302)\u03c4\u0302 \u03b2(n\u0302)\u03c4\u0304\u03b3(n\u0302) (E13)\nand\n\u03b2\u0302\u03b1I = N\u22121\u2211 \u03b2;\u03b3=0 [\u222b d\u2126 WI(n\u0302)\u03c4\u0302 \u03b2(n\u0302)\u02c6\u0304\u03c4\u03b1(n\u0302) ]\u22121 \u222b d\u2126 WI(n\u0302)\u03c4\u0302 \u03b2(n\u0302)\u03c4\u0304\u03b3(n\u0302)\u2206v\u03b3I (n\u0302)\n+ N\u22121\u2211 \u03b2=0 \u221e\u2211 c=N [\u222b d\u2126 WI(n\u0302)\u03c4\u0302 \u03b2(n\u0302)\u02c6\u0304\u03c4\u03b1(n\u0302) ]\u22121 \u222b d\u2126 WI(n\u0302)\u03c4 \u03b2(n\u0302)\u03c4\u0304 c(n\u0302)vc(n\u0302). (E14)\nAssuming a well-modelled optical depth, as in Eq. (E6), a similar derivation as for the harmonic estimator yields:\n\u3008R\u03b1\u03b3I \u3009 ' \u03b4\u03b1\u03b3 \u2212 N\u22121\u2211 \u03b2=0 \u3008\u03c4\u03b1(0)\u03c4\u0304\u03b2(0)\u3009\u22121\u3008n\u03b2\u03c4 (0)n\u0304\u03b3\u03c4 (0)\u3009. (E15)\nSo, the optical depth bias in this limit is independent of the pixel index I."
        }
    ],
    "title": "Maximum likelihood kinetic Sunyaev Zel\u2019dovich velocity reconstruction",
    "year": 2022
}