{
    "abstractText": "Impulse and Gaussian are the two most common types of noise that affect digital images due to imperfections in the imaging process, compression, storage, and communication. The conventional filtering approaches, however, reduce the image quality in terms of sharpness and resolution while suppressing the effects of noise. In this work, a machine learning-based filtering structure has been proposed that preserves the image quality while effectively removing the noise. Specifically, a support vector machine classifier is employed to detect the type of noise affecting each pixel to select an appropriate filter. The choice of filters includes median and bilateral filters of different kernel sizes. The classifier is trained using example images with known noise parameters. The proposed filtering structure has been shown to perform better than the conventional approaches in terms of image quality metrics. Moreover, the design has been implemented as a hardware accelerator on an FPGA device using high-level synthesis tools.",
    "authors": [
        {
            "affiliations": [],
            "name": "Abdulhadi Mohammad din Dawrayn"
        }
    ],
    "id": "SP:ceea2d581e8418c0ae31c98b219a165270f0144a",
    "references": [
        {
            "authors": [
                "S. Avidan",
                "A. Shamir"
            ],
            "title": "Seam carving for content-aware image resizing",
            "venue": "Paper presented at the ACM SIGGRAPH",
            "year": 2007
        },
        {
            "authors": [
                "M. Bilal"
            ],
            "title": "Resource-efficient FPGA implementation of perspective transformation for bird&apos;s eye view generation using high-level synthesis framework",
            "venue": "IET Circuits, Devices & Systems,",
            "year": 2019
        },
        {
            "authors": [
                "A. Buades",
                "B. Coll",
                "J. Morel"
            ],
            "title": "A non-local algorithm for image denoising",
            "venue": "Paper presented at the 2005 IEEE Computer Society Conference on Computer Vision and Pattern Recognition (CVPR\u201905)",
            "year": 2005
        },
        {
            "authors": [
                "S.D. Carlo",
                "P. Prinetto",
                "D. Rolfo",
                "P. Trotta"
            ],
            "title": "AIDI: An adaptive image denoising FPGA-based IPcore for real-time applications",
            "venue": "Paper presented at the 2013 NASA/ESA Conference on Adaptive Hardware and Systems (AHS-2013)",
            "year": 2013
        },
        {
            "authors": [
                "B.H. Chen",
                "Y.S. Tseng",
                "J.L. Yin"
            ],
            "title": "Gaussian-Adaptive Bilateral Filter",
            "venue": "IEEE Signal Processing Letters,",
            "year": 2020
        },
        {
            "authors": [
                "W. Chen",
                "P. Chen",
                "Y. Hsiao",
                "S. Lin"
            ],
            "title": "A Low-Cost Design of 2D Median Filter",
            "venue": "IEEE Access : Practical Innovations, Open Solutions,",
            "year": 2019
        },
        {
            "authors": [
                "S.D. Dabhade",
                "G.N. Rathna",
                "K.N. Chaudhury"
            ],
            "title": "A Reconfigurable and Scalable FPGA Architecture for Bilateral Filtering",
            "venue": "IEEE Transactions on Industrial Electronics,",
            "year": 2018
        },
        {
            "authors": [
                "K. Dabov",
                "A. Foi",
                "V. Katkovnik",
                "K. Egiazarian"
            ],
            "title": "Image Denoising by Sparse 3-D TransformDomain Collaborative Filtering",
            "venue": "IEEE Transactions on Image Processing,",
            "year": 2007
        },
        {
            "authors": [
                "I. Frosio",
                "K. Egiazarian",
                "K. Pulli"
            ],
            "title": "Machine learning for adaptive bilateral filtering. Paper presented at the SPIE/IS&T Electronic Imaging, San Francisco, California, United States",
            "year": 2015
        },
        {
            "authors": [
                "A. Gabiger-Rose",
                "M. Kube",
                "R. Weigel",
                "R. Rose"
            ],
            "title": "An FPGA-Based Fully Synchronized Design of a Bilateral Filter for Real-Time Image Denoising",
            "venue": "IEEE Transactions on Industrial Electronics,",
            "year": 2014
        },
        {
            "authors": [
                "R. Garnett",
                "T. Huegerich",
                "C. Chui",
                "H. Wenjie"
            ],
            "title": "A universal noise removal algorithm with an impulse detector",
            "venue": "IEEE Transactions on Image Processing,",
            "year": 2005
        },
        {
            "authors": [
                "R.G. Gavaskar",
                "K.N. Chaudhury"
            ],
            "title": "Fast Adaptive Bilateral Filtering",
            "venue": "IEEE Transactions on Image Processing,",
            "year": 2019
        },
        {
            "authors": [
                "H. G\u00f3mez-Moreno",
                "P. Gil-Jim\u00e9nez",
                "S. Lafuente-Arroyo",
                "R. L\u00f3pez-Sastre",
                "S. Maldonado-Basc\u00f3n"
            ],
            "title": "A \u201cSalt and Pepper\u201d Noise Reduction Scheme for Digital Images Based on Support Vector Machines Classification and Regression",
            "venue": "Advance online publication",
            "year": 2014
        },
        {
            "authors": [
                "H. G\u00f3mez-Moreno",
                "S. Maldonado-Basc\u00f3n",
                "F. L\u00f3pez-Ferreras",
                "P. Gil-Jim\u00e9nez"
            ],
            "title": "Removal of Impulse Noise in Images by Means of the Use of Support Vector Machines. Paper presented at the Proceedings of the 7th International Work-Conference on Artificial and Natural Neural Networks: Part II: Artificial Neural Nets Problem Solving Methods, Ma\u00f3, Menorca, Spain",
            "year": 2009
        },
        {
            "authors": [
                "R.C. Gonzalez",
                "R.E. Woods"
            ],
            "title": "Digital Image Processing (3rd ed.)",
            "year": 2006
        },
        {
            "authors": [
                "P. Gouchol",
                "L. Jyh-Charn",
                "A.S. Nair"
            ],
            "title": "Selective removal of impulse noise based on homogeneity level information",
            "venue": "IEEE Transactions on Image Processing,",
            "year": 2003
        },
        {
            "authors": [
                "X. Hou",
                "J. Harel",
                "C. Koch"
            ],
            "title": "Image Signature: Highlighting Sparse Salient Regions",
            "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence,",
            "year": 2012
        },
        {
            "authors": [
                "X. Jia",
                "Y. Guo",
                "B. Zhao",
                "Y. Huang"
            ],
            "title": "Fractional-integral-operator-based improved SVM for filtering salt-and-pepper noise",
            "venue": "IET Image Processing,",
            "year": 2019
        },
        {
            "authors": [
                "E. Kalali",
                "I. Hamzaoglu"
            ],
            "title": "Low complexity 2D adaptive image processing algorithm and its hardware implementation",
            "venue": "IEEE Transactions on Consumer Electronics,",
            "year": 2017
        },
        {
            "authors": [
                "S. Khan",
                "Lee",
                "D.-H"
            ],
            "title": "An adaptive dynamically weighted median filter for impulse noise removal",
            "venue": "EURASIP Journal on Advances in Signal Processing,",
            "year": 2017
        },
        {
            "authors": [
                "K.N. P",
                "A.N"
            ],
            "title": "Adaptive Image Filters",
            "venue": "In Color Image Processing and Applications. Digital Signal Processing. Springer",
            "year": 2000
        },
        {
            "authors": [
                "S. Lefkimmiatis"
            ],
            "title": "Non-local Color Image Denoising with Convolutional Neural Networks",
            "venue": "Paper presented at the IEEE Conference on Computer Vision and Pattern Recognition (CVPR),",
            "year": 2017
        },
        {
            "authors": [
                "T. Lin",
                "P. Yu"
            ],
            "title": "Adaptive Two-Pass Median Filter Based on Support Vector Machines for Image Restoration",
            "venue": "Neural Computation,",
            "year": 2004
        },
        {
            "authors": [
                "L. McCrackin",
                "S. Shirani"
            ],
            "title": "Strategic image denoising using a support vector machine with seam energy and saliency features",
            "venue": "Paper presented at the 2014 IEEE International Conference on Image Processing (ICIP)",
            "year": 2014
        },
        {
            "authors": [
                "K. Radlak",
                "L. Malinski",
                "B. Smolka"
            ],
            "title": "Deep Learning Based Switching Filter for Impulsive Noise Removal in Color Images",
            "venue": "Sensors (Basel),",
            "year": 2020
        },
        {
            "authors": [
                "A. Roy",
                "R.H. Laskar"
            ],
            "title": "Fuzzy SVM based fuzzy adaptive filter for denoising impulse noise from color images",
            "venue": "Multimedia Tools and Applications,",
            "year": 2019
        },
        {
            "authors": [
                "A. Roy",
                "J. Singha",
                "S.S. Devi",
                "R.H. Laskar"
            ],
            "title": "Impulse noise removal using SVM classification based fuzzy filter from gray scale images",
            "year": 2016
        },
        {
            "authors": [
                "S. Sadangi",
                "S. Baraha",
                "P.K. Biswal"
            ],
            "title": "Efficient Hardware Implementation of Switching Median Filter for extraction of Extremely High Impulse Noise Corrupted Images. Paper presented at the TENCON",
            "venue": "IEEE Region",
            "year": 2019
        },
        {
            "authors": [
                "J.P. Smith",
                "J.I. Bailey",
                "J. Tuthill",
                "L. Stefanazzi",
                "G. Cancelo",
                "K. Treptow",
                "B.A. Mazin"
            ],
            "title": "A HighThroughput Oversampled Polyphase Filter Bank Using Vivado HLS and PYNQ on a RFSoC",
            "venue": "IEEE Open Journal of Circuits and Systems,",
            "year": 2021
        },
        {
            "authors": [
                "P. Taghinia Jelodari",
                "M. Parsa Kordasiabi",
                "S. Sheikhaei",
                "B. Forouzandeh"
            ],
            "title": "FPGA implementation of an adaptive window size image impulse noise suppression system",
            "venue": "Journal of Real-Time Image Processing,",
            "year": 2019
        },
        {
            "authors": [
                "C. Tomasi",
                "R. Manduchi"
            ],
            "title": "Bilateral filtering for gray and color images",
            "venue": "Paper presented at the Sixth International Conference on Computer Vision (IEEE Cat. No.98CH36271),",
            "year": 1998
        },
        {
            "authors": [
                "Z. Vasicek",
                "L. Sekanina"
            ],
            "title": "An Area-Efficient Alternative to Adaptive Median Filtering in FPGAs",
            "venue": "Paper presented at the 2007 International Conference on Field Programmable Logic and Applications",
            "year": 2007
        },
        {
            "authors": [
                "B. Zhang",
                "J.P. Allebach"
            ],
            "title": "Adaptive Bilateral Filter for Sharpness Enhancement and Noise Removal",
            "venue": "IEEE Transactions on Image Processing,",
            "year": 2008
        },
        {
            "authors": [
                "K. Zhang",
                "W. Zuo",
                "Y. Chen",
                "D. Meng",
                "L. Zhang"
            ],
            "title": "Beyond a Gaussian Denoiser: Residual Learning of Deep CNN for Image Denoising",
            "venue": "IEEE Transactions on Image Processing,",
            "year": 2017
        },
        {
            "authors": [
                "W. Zhou",
                "A.C. Bovik",
                "H.R. Sheikh",
                "E.P. Simoncelli"
            ],
            "title": "Image quality assessment: From error visibility to structural similarity",
            "venue": "IEEE Transactions on Image Processing,",
            "year": 2004
        }
    ],
    "sections": [
        {
            "text": "DOI: 10.4018/IJCVIP.2022010106\nThis article published as an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/) which permits unrestricted use, distribution, and production in any medium,\nprovided the author of the original work and original publication source are properly credited\nImpulse and Gaussian are the two most common types of noise that affect digital images due to imperfections in the imaging process, compression, storage, and communication. The conventional filtering approaches, however, reduce the image quality in terms of sharpness and resolution while suppressing the effects of noise. In this work, a machine learning-based filtering structure has been proposed that preserves the image quality while effectively removing the noise. Specifically, a support vector machine classifier is employed to detect the type of noise affecting each pixel to select an appropriate filter. The choice of filters includes median and bilateral filters of different kernel sizes. The classifier is trained using example images with known noise parameters. The proposed filtering structure has been shown to perform better than the conventional approaches in terms of image quality metrics. Moreover, the design has been implemented as a hardware accelerator on an FPGA device using high-level synthesis tools."
        },
        {
            "heading": "KeywoRDS",
            "text": ""
        },
        {
            "heading": "Adaptive Filtering, Bilateral Filter, FPGA, Gaussian Noise, High-Level Synthesis, Image Denoising, Impulse Noise, Machine Learning, Median Filter, Support Vector Machine, Switching Filter",
            "text": ""
        },
        {
            "heading": "INTRoDUCTIoN",
            "text": "Image and video data processing has become ubiquitous in the recent years due to the popularity of smart surveillance, advance driver assistance, augmented reality and virtual reality etc. Digital Image Processing (DIP) is a broad field with operations ranging from image quality enhancement (e.g. contrast adjustment and denoising etc.), content analysis (e.g. frequency domain analysis and segmentation etc.) to implementation of compression techniques (e.g. Discrete Cosine and Wavelet Transforms etc.). Image denoising is a particularly important area in this regard since different types of noise arise in digital images due to imperfections in imaging systems, compression and communication channels etc. Conventionally, these denoising operations have been performed using mathematical operations (e.g. convolution) with fixed parameters (kernels). Such image processing filters are\nlinear in nature and work well for most typical scenarios where imaging conditions are known and invariable (Gonzalez & Woods, 2006). Some non-linear operations (e.g. rank-order filtering, closure and dilation etc.) have also been advised for specific cases. For dynamically changing scenarios, adaptive filtering techniques (K.N. & A.N., 2000; Khan & Lee, 2017) have also been recommended in the past. Two common types of noise affecting digital images are impulse (Salt and Pepper) noise and Gaussian noise. Conventionally, these have been treated using Median and Wiener adaptive filters respectively. These filters are known for their edge preserving property. However, any filtering operation necessarily affects the sharp edges and resolution of the image. In order to quantify the distortion, two metrics have been widely used by the research community i.e. Signal to Noise Ratio (SNR) and Structural Similarity Index (SSIM) (Zhou, Bovik, Sheikh, & Simoncelli, 2004). Figure 1 shows an example where input images have been corrupted by synthetic noise i.e. 25% impulse noise (top) and Gaussian noise with \u03c3=0.025 (bottom). These noisy images have been filtered through median and Wiener adaptive filters respectively. Resultantly, the SNR of the top noisy image has improved from 6.7 dB to 20.2 dB while the bottom image sees an increase of SNR from 10.1dB to 18.96 dB. Similarly, SSIM of the noisy images increase from 0.077 to 0.78 (top) and from 0.42 to 0.73 (bottom). Gaussian noise particularly affects the image texture more and hence the recovered images depict lower SNR and SSIM values.\nIn the recent years, however, the role of machine learning techniques has been gaining popularity. Thus, a few image denoising algorithms based on combining the power of machine learning tools and conventional convolution-based operations have also been proposed in the recent years. This\neffectively alters the filtering kernel based on the properties of current pixel\u2019s neighborhood. Various features such as seam energy, local color, saliency, median and predicted values have been proposed for this purpose. The training of such learning-based filtering methods require the original natural image patches as well as those with added noise. Thus, only those pixels which have been classified as noisy by the machine learning detector are processed while the remaining are not affected. Moreover, different pixels could be classified differently according to their neighborhood conditions and processed using an appropriate filtering kernel. This filter switching operation leads to noise free output image with minimal impact on visual quality. A brute force application of filtering kernel on the other hand leads to deterioration of vital information in an image. One other matter of concern in the filtering structures is the design, development and testing of full hardware systems which requires a lot of effort and time. Thus, there is an increasing trend of describing the circuit behavior using high-level synthesis tools to reduce the development time and spend more effort at the algorithmic design level. Hardware Description Language (HDL) Coder and Vision HDL toolboxes in Simulink\u00ae by Mathworks\u00ae provide higher level abstraction of image processing for quick deployment on a variety of target hardware. Resultantly, the development cycle of image and video processing hardware applications using these tools gets shortened. The hardware implementation of learning-based image filtering operations is a relatively new field with only few mentions in the current literature. Among these few works, most have considered a relatively simpler task i.e. removal of the impulse noise. In this paper, we have proposed both machine learning-based algorithms and corresponding hardware for mixed types of noise i.e. Gaussian and impulse noise with variable magnitude. Specifically, this work has the following contributions.\n1. Exploration of various hand-coded features to be used for machine learning-based switching filter with respect to algorithm complexity and performance. 2. Development of a unified switching filter to remove mixed noise using different kernels. 3. Development of the corresponding hardware structure using higher level synthesis tool (Simulink\nHDL Coder). 4. Release of the developed framework as open-source software to reproduce the experimental results1. 5. Performance evaluation of the proposed structure on standard test images using image quality\nassessment metrics."
        },
        {
            "heading": "BACKGRoUND",
            "text": "Edge preservation is an essential albeit a difficult task while removing noise from the images. An early notable noise suppression filter known for its edge-preserving property is Bilateral filter (Tomasi & Manduchi, 1998) which is based on Gaussian low pass filtering kernel but incorporates local variation in pixel values as well. Thus, the arrangement of pixel values around an edge modify the filtering kernel to preserve the image sharpness while removing random noise. Realizing the importance of local statistics in determining the optimal filtering kernel, various researchers have considered the adaptive version of Bilateral filter as well (B. H. Chen, Tseng, & Yin, 2020). However, the adaptive approach further increases the computational complexity of the original Bilateral filter making it slower. To circumvent this, Gavaskar and Chaudhury (Gavaskar & Chaudhury, 2019) have described a faster version of adaptive Bilateral filtering kernel. The mean and variance of the pixels in a small working window are the only two statistical properties that are considered in such approaches to adaptively vary the kernel size. In order to remove both Gaussian and impulse noise, Garnett et al. (Garnett, Huegerich, Chui, & Wenjie, 2005) proposed a new statistical measure, Rank-Ordered Absolute Difference (ROAD), which could be used to identify the noise type and apply different filtering kernels accordingly. ROAD is inspired by the Bilateral filter which changes its filtering behavior upon detection of an edge using quantifiable local measures. Inclusion of impulse detection in the kernel function of Bilateral filter through ROAD makes it effective against Salt and Pepper\n(SnP) and Gaussian noise alike. The modified kernel has been named Trilateral filter. Subsequently, many researchers have used this generic concept of modifying the kernel based on the detection of noise. These filters have also been referred to as switching filters in the literature. Recently, Jia et al. (Jia, Guo, Zhao, & Huang, 2019) have proposed a machine learning-based adaptive filtering approach to remove SnP noise. For this purpose, they have used Support Vector Regression (SVR) to estimate the true value of noisy image pixel using directional fractional integration and simple average values as features calculated from neighboring pixels values. Similarly, an Entropy-based Adaptive Bilateral Filter (EABF) was proposed in (Frosio, Egiazarian, & Pulli, 2015) using two entropy-based features to learn a set of kernel parameters from noisy test images. This technique was shown to work better than the conventional Bilateral filter especially in the presence of higher levels of Gaussian noise and can be used for any generic adaptive filtering scheme. Laplacian of Gaussian operator has also been suggested as a feature for pixel classification (B. Zhang & Allebach, 2008) in an adaptive Bilateral filter structure. Another discriminative feature for impulse noise detection has been described in (Gouchol, Jyh-Charn, & Nair, 2003) and measure the homogeneity of pixel values in a small neighborhood. This feature is quite similar to the variance and entropy-based features in principle. Laura and Shirani (McCrackin & Shirani, 2014) have proposed an adaptive filter based on Support Vector Machine (SVM) to select the output corresponding to one of two denoising filters i.e. block-matching and 3D filtering method (BM3D) (Dabov, Foi, Katkovnik, & Egiazarian, 2007) and the non-local means (Buades, Coll, & Morel, 2005). They have used image seam energy (Avidan & Shamir, 2007) and saliency map (Hou, Harel, & Koch, 2012) as features for SVM classification. Since, both filtering approaches provide convincing denoised output when applied alone, the affects of SVM misclassification are not apparent. They have used structural similarity image measure (SSIM) (Zhou et al., 2004) as the metric for quality assessment and report a better value for the proposed approach using SVM-based adaptive selection of filtering kernels than the conventional application of either kernel alone. Thus, this machine learning-based approach intelligently combines the best of two filtering approaches without any compromise. This approach has been, however, tried only for removal of Gaussian noise. Lin and Yu (Lin & Yu, 2004) have proposed a similar SVM-based adaptive filter for SnP noise and used four distinguishing features for noise detection. These features are based on the difference between pixel value and the median value in a small neighborhood. This approach simply replaces the values of the pixels classified by the SVM detector as noisy with the median value. Thus, a better edge preservation than plain median filtering approach is achieved since the filtering kernel is applied on the noisy pixels only. Hilario et al. (Hilario G\u00f3mezMoreno, Gil-Jim\u00e9nez, Lafuente-Arroyo, L\u00f3pez-Sastre, & Maldonado-Basc\u00f3n, 2014; H. G\u00f3mezMoreno, Maldonado-Basc\u00f3n, L\u00f3pez-Ferreras, & Gil-Jim\u00e9nez, 2009) have used a similar approach for detecting SnP noise but reconstruct the noisy pixel values using regression instead of median operation. Moreover, they have used plain pixel values in a small neighborhood as the features for SVM training. Following a similar approach, Roy et al. (Roy, Singha, Devi, & Laskar, 2016) have employed a Fuzzy filter to process the given pixel once it has been classified as noisy by an SVM detector. They have employed the prediction error (based on non-causal linear prediction), absolute difference between the pixel and neighborhood median values, absolute pixel value and mean value of the neighborhood as the noise detection features. In a later work (Roy & Laskar, 2019), they have also considered Local Binary Pattern (LBP) as an additional feature. Recently, Convolutional Neural Networks (CNN) have been applied to many different computer vision and digital image processing tasks including suppression of Gaussian noise (Lefkimmiatis, 2017; K. Zhang, Zuo, Chen, Meng, & Zhang, 2017) among others. Similarly, Radlak et al. (Radlak, Malinski, & Smolka, 2020) have applied the switching filter approach with CNN-based filtering to remove impulse noise. Despite, their superior performance, a major drawback of CNN-based approaches is the higher processing load which necessitates the use of GPUs to achieve real-time performance.\nOther than the effective suppression of noise with minimal impact on the image quality, efficient hardware implementation of two-dimensional (2D) image filtering kernel has been an important goal\nin this research area. Various works have been reported in the literature to simplify the design of both linear and non-linear image processing filters (W. Chen, Chen, Hsiao, & Lin, 2019; Dabhade, Rathna, & Chaudhury, 2018; Gabiger-Rose, Kube, Weigel, & Rose, 2014; Kalali & Hamzaoglu, 2017). However, only few hardware implementation of switching or machine learning-based kernel filters have been mentioned in the literature. Parham et al. (Taghinia Jelodari, Parsa Kordasiabi, Sheikhaei, & Forouzandeh, 2019) have described a hardware architecture for an adaptive median filter to suppress SnP noise using a switching mechanism based on noise density which is estimated using a local histogram of noisy pixel values. Recently, Sadangi et al. (Sadangi, Baraha, & Biswal, 2019) have also described an FPGA implementation of adaptive median filter based on noise detection. Both of these architectures are inspired by the inability of a single median filtering kernel to effectively process images with different noise density. Hence, the switching is involved to alter the kernel based on the estimated noise statistics. Moreover, these custom designs are not flexible enough to be tailored for different filtering scenarios or easily enhanced. There has been a growing trend in hardware design community to use high-level synthesis tools for design entry (Bilal, 2019; Smith et al., 2021). This approach not only reduces the development time but also makes the design more accessible to other researchers and practitioners.\nIt is clear from this survey of the relevant works reported in the literature that although machine learning-based adaptive and switching filters have been recognized for their better performance in preserving the sharpness of the images while effectively suppressing the noise, these structures have yet to see widespread appeal. Moreover, the hardware implementation of such filtering structures has been largely overlooked."
        },
        {
            "heading": "MACHINe LeARNING-BASeD IMAGe DeNoISING FILTeR DeSIGN",
            "text": "This section describes multiple proposed approaches to improve the existing switching and machine learning-based image filtering structures presented in the literature. As mentioned earlier, switching denoising filters perform better than the brute force application of filtering kernel on the whole image since they selectively process each pixel based on a given criterion for the presence of noise or not. The detection of noise is generally done through various image features obtained from local statistics of the neighborhood around the given pixel as discussed in the literature review above. For the impulse noise of type SnP, this is particularly simpler since the noisy pixels always take on the extreme values i.e. 0 or 255 for 8 bit images. Thus, the baseline design for our work is a switching filter which detects the SnP noise by looking for these extreme values and replaces it with the median pixel value in a neighborhood of fixed size. Thus, the median operation is only performed to remove these extreme values and the remaining pixels are not filtered at all. Figure 2 shows the results of applying this switching filter and compares it to the conventional median filter while filtering an image corrupted by 25% SnP. Clearly the switching filter not only removes the noise effectively but also preserves image sharpness better than the conventional median filter. All three color channels i.e. Red, Green and Blue (RGB) have been independently processed in this case. Figure 3 depicts the flowchart of this baseline switching filter. However, this simple switching filter can be further improved by inclusion of multiple choices of the filtering kernels selectable through a machine learning classifier as described next.\nDue to different texture at different parts of the image, a different kernel could lead to better filtering operation. This fact is the basis for many adaptive filters proposed in the literature. Along these lines, we improve upon the baseline switching median filter (Figure 3) using two Median kernels instead of one. Any one of the two kernels will be selected on detection of noise based on the local image statistics. This decision will be made through an SVM classifier. Any machine learning classifier identifies patterns through some distinguishing features. As discussed in the previous section, researchers have used various features of varying complexity to detect noise patterns. The goal of this work is to identify features that offer a good compromise between detection accuracy\nand implementation effort. This is especially important for the development of the corresponding hardware architecture. Thus, in this work, the following features have been selected for classification owing to their simpler filtering kernel:\n1. Absolute pixel value 2. Mean in a local neighborhood 3. Median in a local neighborhood 4. Difference between Mean and pixel value\n5. Difference between Median and pixel value 6. Horizontal and vertical gradients 7. Gradient magnitude 8. Laplacian\nFor SVM classifier training and testing, images from the USC-SIPI dataset (\u201cThe USC-SIPI Image Database,\u201d 1977) have been used. Images patches corrupted with known noise characteristics are used as training examples. The corrupted noise patches are then filtered through two median kernels i.e. [3\u00d73] and [5\u00d75] separately. The kernel leading to the output closest to the original value is given the \u2018positive\u2019 label while the other as \u2018negative\u2019. The SVM classifier uses the above identified features and the generated labels to classify the noisy patches and this decision is subsequently used to select one of the two median kernels for processing. The SVM classifier is only applied to the pixels earlier identified by the switching mechanism of the baseline filter. Thus, the detected noisy pixels can be treated through one of the two median kernels depending on the local image statistics while the uncorrupted pixels are left unchanged. The over all filter structure has been depicted in Figure 4 and named as SW-SVM-MED. The performance of this modified filtering structure which enhances the baseline switching filter through inclusion of an SVM classifier has been discussed in the next section.\nThe above switching and SVM-based enhanced switching filter only incorporated Median filtering kernels which are only helpful against SnP noise. In the presence of Gaussian noise, however, a different filtering kernel will be required. As mentioned earlier, Bilateral filter has been widely used to suppress Gaussian noise. However, Bilateral filter is not helpful against the SnP noise. Thus, we propose another enhanced version of the switching filter which selects an appropriate filtering kernel to suppress mixed noise i.e. when both SnP and Gaussian noise are present in the image. The proposed structure has been show in Figure 5. Notice that the simple SnP detector of the baseline filter has been removed. This is because in the case of mixed noise, SnP does not necessarily corrupt the pixel values to take the extreme value of either 0 or 255. Thus, in the proposed new structure, the SVM classifier chooses the appropriate kernel i.e. Median or Bilateral to process the given pixel. The training is done as before by corrupting images patches with known noise characteristics (mixed SnP and Gaussian) and filtering by Median and Bilateral kernels separately. Positive and negative labels are again generated based on the values closest to the original. This structure has been named as SVM-MED-BILAT and its performance has been discussed and compared against the reference works in the next section."
        },
        {
            "heading": "PeRFoRMANCe eVALUATIoN oF THe PRoPoSeD FILTeRS",
            "text": "The proposed SVM-based filtering structures described in the previous section have been trained and tested using known noise parameters but different training image patches from the USC-SIPI dataset. We have employed both PSNR and SSIM image quality metrics for evaluating the proposed approach. The results of denoising performance of the proposed SW-SVM-MED filter on images corrupted by SnP noise have been given in Table 1. It can be clearly seen that the proposed approach either outperforms or performs comparatively with the baseline switching filter (Figure 3). Moreover, it could be noticed that the performance is better for the more likely case of noise occurrences i.e.\nwithin the range 5% to 15%. When the noise density is lower than 5%, there are only a few occurrences of noise impulses which means that if the SVM-based filter misclassifies even a few occurrences, it will reflect as a loss in PSNR. However, in absolute terms, the PSNR is pretty high i.e. around 43.7 dB on average. Furthermore, SSIM value still depicts that the proposed approach yields a denoised image with sharpness and image details very close to the original image. Figure 6 displays some visual results showing the superior performance of the proposed SW-SVM-MED filter. These results are reproducible through the provided source code.\nTable 2 shows the results of denoising images corrupted by different amounts of Gaussian and SnP noise. Peak SNR (PSNR) and SSIM values were collected for each image in the USC-SIPI dataset processed with conventional Median and Bilateral filters. The average values were computed and compared against those obtained by the proposed SVM-MED-BILAT filter (Figure 5). It can be noticed that under all the cases considered, the proposed filter yielded better results both in terms of PSNR and SSIM. It should be noted, however, that the performance of the proposed filter is closer to that of conventional median filter in cases where the effect of SnP noise increases. This is expected since Median filter effectively suppresses SnP noise. The proposed filter also uses median filter whenever it detects the occurrence of SnP on a given pixel. However, better performance is achieved since SVM classifier is able to detect presence or absence of SnP noise in most cases and applies the result of Bilateral filter where appropriate as well. Thus, the overall effect is a better filtering response than median or bilateral filters applied alone. It can be further noticed that Bilateral filter gives a very poor performance in comparison when SnP noise is present. Figure 7 displays some visual results showing the superior performance of the proposed SVM-MED-BILAT filter. These results are reproducible through the provided source code.\nTable 3 gives the performance improvement comparison of the proposed approach with other works reported in the literature with respect to improvement in PSNR values. It can be noticed that the SVM-based classifier which combines the best results of both Median and Bilateral filters against\nSnP and Gaussian noise respectively yields a very promising result. Thus, while other techniques are effective against a particular type of noise i.e. SnP or Gaussian, the proposed approach is effective against both. It may be reiterated here that Bilateral filter is not very responsive against SnP noise. However, combining it intelligently with median filter using a machine learning-based classifier yields promising results. The adaptive filter proposed by Laura and Shirani (McCrackin & Shirani, 2014) uses a similar approach based on Support Vector Machine (SVM) to build a switching filter around BM3D and NLM algorithms as discussed previously. However, the proposed filtering structure is more suitable for hardware implementation owing to its simpler switching kernels. Moreover, the proposed filter has been shown to be effective against mixed noise and not just Gaussian. Nevertheless,\nthis machine learning-based approach intelligently combines the best of two filtering approaches without any compromise since either filter helps in suppressing the noise. It is worth mentioning here that despite the sub-optimal performance of linear SVM classifier due to non-linearly separable classes, the output filtering response is still better than using either Median or Bilateral filter alone. Furthermore, in our experimentation we have made use of \u2018soft margin\u2019 in SVM classifier which helps in generalizing the classifier response in the wake of non-linearly separable classes. In the provided Matlab code for the proposed SVM-based filtering framework, this can be adjusted using the \u2018BoxConstraint\u2019 parameter for different scenarios. A non-linear kernel such as Gaussian Radial Basis Function (RBF) could lead to a better classification accuracy but requires exorbitantly large number of logic resources for its corresponding hardware implementation as well. Thus, we have limited our design to linear SVM classifier in the interest of making the design suitable for inclusion in hardware image processing pipelines.\nHARDwARe IMPLeMeNTATIoN\nThe proposed filtering structures analyzed for performance in the last section have been implemented as hardware accelerators for use in image processing pipelines in real-time. For this purpose, high-level synthesis tool from Mathworks\u00ae i.e. Simulink Hardware Descriptive Language (HDL) Coder has been used. Figure 8 shows the Simulink model for the baseline switching median filter. The model is based on the Simulink intrinsic support for image processing pipeline using standard AXI-4 streaming pixel interface bus. The benefit of using Simulink HDL coder is that the design process related to the timing and control signals gets encapsulated in the intrinsic support of this standard bus. Thus, the design effort is only spent on the actual image processing part while the standard interface links are generated automatically. This high-level synthesis approach saves a lot of coding and debugging work and the actual intended algorithm remains the focus of the design effort. The fully synthesized model can be inserted into the standard video processing pipeline in commercial FPGAs such as the Xilinx Zynq devices since it is compatible with the AXI-4 streaming bus standard. Specifically, the \u2018pixelIn\u2019 and \u2018pixelOut\u2019 signals correspond to the raster scanline-based pixels data as commonly found in real-time image processing pipelines. Similarly, \u2018ctrlIn\u2019 and \u2018ctrlOut\u2019 refer to the timing signals related to horizontal and vertical synchronization signals as well the valid pixel signal. The\nproposed filtering structures work in real-time and thus make no changes to the pixel control bus signals related to the timing while making use of only the input pixel signal and generating the output. The \u201cMedian Filter\u201d block is a built-in block in Simulink. The \u201cImage Filter\u201d block in this diagram is a plain delay line to match that of the median filter. The switching logic has been implemented using Simulink intrinsic blocks.\nThe corresponding Simulink model for the proposed SW-SVM-MED filter has been shown in Figure 9. As discussed earlier, this is an improvement over the baseline switching median filter and incorporates an SVM-based classifier to select one of the two median filtering kernels. The details of the SVM-based filter block have been shown in Figure 10. There are four distinct filtering structures to calculate the features outlined previously. To reduce the computational complexity, the derivative magnitude feature has been simplified to avoid the expensive square root operation. Thus, a simpler addition of absolute values of vertical and horizontal gradients is considered instead. The same operation is used in the software model implementation as well for consistency.\nThe corresponding hardware for the proposed SVM-MED-BILAT filter (Figure 11) is similar with the exception that the switching happens between the output of a bilateral filter and a median filter as discussed in the previous section.\nThe proposed filtering architectures have been synthesized using Simulink HDL Coder for Xilinx Zynq-7000 (XC7Z020-CLG484) FPGA. The synthesis results have been reported in Table 4. It can be noticed that the proposed SVM-based filters consume only a few more slice logic resources (approx. 40%) while yielding higher image quality with respect to both PSNR and SSIM metrics. The switching median filter structure proposed in (Sadangi et al., 2019) in comparison uses more than four times resources. Similarly, the adaptive median filter by (Vasicek & Sekanina, 2007) uses\nmore slice logic resources and can only handle SnP noise. Their reported SNR is also lower on standard images corrupted by 5% SnP (less than 30 dB) while the proposed filter \u2018SW-SVM-MED\u2019 not only consumes lower logic resources but also yields a higher SNR as show in Table 1. Similarly, the adaptive Guassian filter hardware (Carlo et al., 2013) consumes almost ten times more resources\nwhile only accomplishing a sub-optimal filtering output since their reported error statistics are only marginally better than static Gaussian filter while the proposed approach makes use of Bilateral filter in its switching response which is known to preserve edges better than Gaussian. The proposed designs have been implemented and tested with 640 \u00d7 480 video frame resolution at 15 frames per second (fps). This requires a pixel processing rate of 4.6 MHz and is within the maximum allowable clock frequency (1/delay) permitted by the synthesized designs. Moreover, using a higher resolution frame e.g. 1280 \u00d7 720 at 30 fps is also supported since it requires a pixel processing speed of 27.6 MHz. Moreover, for larger resolution frames, the Slice LUT requirement will remain same and only additional memory for line buffers will be required. Even higher frame rates can also be supported with the additional cost of pipelining stages."
        },
        {
            "heading": "CoNCLUSIoN",
            "text": "This paper has proposed machine learning-based filtering structures to remove impulse and Gaussian noise from images. Experimental evidence has been provided that using a machine learning classifier (i.e. SVM) can lead to a better filtering response than using a single filtering kernel alone. To this end, a switching mechanism that selects an appropriate filtering kernel (Median or Bilateral) using SVM classifier has been employed. For the sake of efficient hardware implementation, simple features have been adopted which help the SVM classifier select the kernel leading to the highest PSNR/ SSIM value. Moreover, the hardware has been developed using Simulink HDL Coder to facilitate high level synthesis leading to shorter development time and effective dissemination of knowledge through reproducible results. The whole filtering framework has been made available as open-source software for the researchers and practitioners working in this domain."
        },
        {
            "heading": "ACKNowLeDGMeNT",
            "text": "The authors gratefully acknowledge the help and support provided by the Department of Electrical & Computer Engineering at King Abdulaziz University to conduct the experiments for this work. This research received no specific grant from any funding agency in the public, commercial, or notfor-profit sectors."
        }
    ],
    "title": "SVM-Based Switching Filter Hardware Design for Mixed Noise Reduction in Digital Images Using High-Level Synthesis Tools",
    "year": 2022
}