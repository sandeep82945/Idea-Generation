{
    "abstractText": "To include the bound electron effects in particle-in-cell (PIC) simulation, we propose a model in which the response of the dipole components of partially ionized ions to external electromagnetic fields can be included. Instead of treating the macroion particle as a single particle without an internal structure, the ions are considered to have a structure composed of a central nucleus and a bounded electron cloud in our model. The two parts experience the interactions of both the external electromagnetic fields and the internal Coulomb fields. In this way, the laser scattering effects by a partially ionized medium can be modeled properly in the PIC simulation. The laser propagation in a neutral medium and the Bragg scattering of the laser in crystal structure have been simulated with a PIC code modified based on our model as the benchmark. Our model may find applications to study some interesting problems, such as the x-ray laser-driven wakefield acceleration in crystals, the x-ray laser-driven high energy density physics, and intense laser propagation in partially ionized nonlinear optical materials, etc.",
    "authors": [
        {
            "affiliations": [],
            "name": "Xiangyan An"
        },
        {
            "affiliations": [],
            "name": "Min Chen"
        },
        {
            "affiliations": [],
            "name": "Zheng-Ming Sheng"
        },
        {
            "affiliations": [],
            "name": "Jie Zhang"
        }
    ],
    "id": "SP:8240e8f0b4e3e086bb74dcf1f2b05323db36be81",
    "references": [
        {
            "authors": [
                "J.M. Dawson"
            ],
            "title": "Particle simulation of plasmas",
            "venue": "Reviews of Modern Physics 55 (2) ",
            "year": 1983
        },
        {
            "authors": [
                "H. Nishimura",
                "R. Mishra",
                "S. Ohshima",
                "H. Nakamura",
                "M. Tanabe",
                "T. Fujiwara",
                "N. Yamamoto",
                "S. Fujioka",
                "D. Batani",
                "M. Veltcheva",
                "T. Desai",
                "R. Jafer",
                "T. Kawamura",
                "Y. Sentoku",
                "R. Mancini",
                "P. Hakel",
                "F. Koike",
                "K. Mima"
            ],
            "title": "Energy transport and isochoric heating of a low-Z",
            "venue": "reducedmass target irradiated with a high intensity laser pulse, Physics of Plasmas 18 (2) ",
            "year": 2011
        },
        {
            "authors": [
                "T. Tajima",
                "J.M. Dawson"
            ],
            "title": "Laser Electron Accelerator",
            "venue": "Physical Review Letters 43 (4) ",
            "year": 1979
        },
        {
            "authors": [
                "E. Esarey",
                "C.B. Schroeder",
                "W.P. Leemans"
            ],
            "title": "Physics of laser-driven plasma-based electron accelerators",
            "venue": "Reviews of Modern Physics 81 (3) ",
            "year": 2009
        },
        {
            "authors": [
                "U. Teubner",
                "P. Gibbon"
            ],
            "title": "High-order harmonics from laser-irradiated plasma surfaces",
            "venue": "Reviews of Modern Physics 81 (2) ",
            "year": 2009
        },
        {
            "authors": [
                "T.D. Arber",
                "K. Bennett",
                "C.S. Brady",
                "A. Lawrence-Douglas",
                "M.G. Ramsay",
                "N.J. Sircombe",
                "P. Gillies",
                "R.G. Evans",
                "H. Schmitz",
                "A.R. Bell",
                "C.P. Ridgers"
            ],
            "title": "Contemporary particle-in-cell approach to laser-plasma modelling",
            "venue": "Plasma Physics and Controlled Fusion 57 (11) ",
            "year": 2015
        },
        {
            "authors": [
                "M. Chen",
                "E. Cormier-Michel",
                "C. Geddes",
                "D. Bruhwiler",
                "L. Yu",
                "E. Esarey",
                "C. Schroeder",
                "W. Leemans"
            ],
            "title": "Numerical modeling of laser tunneling ionization in explicit particle-in-cell codes",
            "venue": "Journal of Computational Physics 236 ",
            "year": 2013
        },
        {
            "authors": [
                "T. Tajima",
                "M. Cavenago"
            ],
            "title": "Crystal x-ray accelerator",
            "venue": "Physical Review Letters 59 (13) ",
            "year": 1987
        },
        {
            "authors": [
                "Y.-M. Shin",
                "D.A. Still",
                "V. Shiltsev"
            ],
            "title": "X-ray driven channeling acceleration in crystals and carbon nanotubes",
            "venue": "Physics of Plasmas 20 (12) ",
            "year": 2013
        },
        {
            "authors": [
                "X. Zhang",
                "T. Tajima",
                "D. Farinella",
                "Y. Shin",
                "G. Mourou",
                "J. Wheeler",
                "P. Taborek",
                "P. Chen",
                "F. Dollar",
                "B. Shen"
            ],
            "title": "Particle-in-cell simulation of x-ray wakefield acceleration and betatron radiation in nanotubes",
            "venue": "Physical Review Accelerators and Beams 19 (10) ",
            "year": 2016
        },
        {
            "authors": [
                "S. Hakimi",
                "X. Zhang",
                "C. Lau",
                "P. Taborek",
                "F. Dollar",
                "T. Tajima"
            ],
            "title": "X-ray laser wakefield acceleration in a nanotube",
            "venue": "International Journal of Modern Physics A 34 (34) ",
            "year": 2019
        },
        {
            "authors": [
                "I.Y. Dodin",
                "N.J. Fisch"
            ],
            "title": "Charged particle acceleration in dense plasma channels",
            "venue": "Physics of Plasmas 15 (10) ",
            "year": 2008
        },
        {
            "authors": [
                "S. Hakimi",
                "T. Nguyen",
                "D. Farinella",
                "C.K. Lau",
                "H.-Y. Wang",
                "P. Taborek",
                "F. Dollar",
                "T. Tajima"
            ],
            "title": "Wakefield in solid state plasma with the ionic lattice force",
            "venue": "Physics of Plasmas 25 (2) ",
            "year": 2018
        },
        {
            "authors": [
                "Z. Liang",
                "B. Shen",
                "X. Zhang",
                "L. Zhang"
            ],
            "title": "High-repetition-rate few-attosecond high-quality electron beams generated from crystals driven by intense X-ray laser",
            "venue": "Matter and Radiation at Extremes 5 (5) ",
            "year": 2020
        },
        {
            "authors": [
                "H.-K. Chung",
                "B.I. Cho",
                "O. Ciricosta",
                "S.M. Vinko",
                "J.S. Wark",
                "R.W. Lee"
            ],
            "title": "Atomic processes modeling of X-ray free electron laser produced plasmas using SCFLY code",
            "venue": "AIP Conference Proceedings 1811 (1) ",
            "year": 2017
        },
        {
            "authors": [
                "R. Royle",
                "Y. Sentoku",
                "R.C. Mancini",
                "I. Paraschiv",
                "T. Johzaki"
            ],
            "title": "Kinetic modeling of x-ray laser-driven solid Al plasmas via particle-in-cell simulation",
            "venue": "Physical Review E 95 (6) ",
            "year": 2017
        },
        {
            "authors": [
                "S.X. Hu",
                "L.A. Collins"
            ],
            "title": "Phase control of the inverse above-threshold-ionization process with few-cycle pulses",
            "venue": "Physical Review A 70 (3) ",
            "year": 2004
        },
        {
            "authors": [
                "S.X. Hu",
                "L.A. Collins"
            ],
            "title": "Intense laser-induced recombination: The inverse above-threshold ionization process",
            "venue": "Physical Review A 70 (1) ",
            "year": 2004
        },
        {
            "authors": [
                "H.-J. Hagemann",
                "W. Gudat",
                "C. Kunz"
            ],
            "title": "Optical constants from the far infrared to the x-ray region: Mg",
            "venue": "al, cu, ag, au, bi, c, and al2o3, J. Opt. Soc. Am. 65 (6) ",
            "year": 1975
        }
    ],
    "sections": [
        {
            "text": "Key words: particle-in-cell simulation, bound electrons, x-rays, crystals"
        },
        {
            "heading": "1 Introduction",
            "text": "Particle-in-cell (PIC) codes are widely used in plasma physics, especially in the simulation of laser-plasma interaction [1], such as in inertial confinement fusion [2], laser wakefield acceleration [3, 4], high order harmonics generation [5] and so on. However, the usual PIC codes only consider the electric currents contributed by free electrons and ions. These charged particles are modeled by particle clouds with special shapes and finite size, i.e. macro-particles. They are accelerated by external electromagnetic (EM) fields which are calculated from the Maxwell equations with source terms contributed\n\u2217Corresponding author. Email addresses: minchen@sjtu.edu.cn (M. Chen)\nhttp://www.global-sci.com/ Global Science Preprint\nar X\niv :2\n20 8.\n08 03\n8v 1\n[ ph\nys ic\ns. pl\nas m\n-p h]\n1 7\n2 by the charged particles. The internal EM properties of some particles, such as the dipole components contributed by the bound electrons and the central nucleus, are neglected. For particles with the same charge to mass ratio, their trajectories would be identical once their initial positions and velocities are the same. For example, the dynamical evolutions of a proton and a He+ ion in normal PIC simulation are the same although there is one bound electron in the He+ ion. Even though the ionization process is included in some PIC codes [6, 7], the effects of the bound electrons of the ions are still neglected, where only the free electrons which are ionized will respond to the external EM fields.\nOn the other hand, in some applications, where the laser fields are not high enough to ionize all the electrons of the ions and the electromagnetic response of the bound electrons cannot be neglected, the usual PIC codes will be inadequate. In the wakefield acceleration by x-ray pulses in crystal [8], nanotubes, and dense plasmas [9\u201312], for example, although the x-ray propagation and the following wakefield acceleration have been numerically studied and even the radiation reaction and the collision have also been included [13], the response of the internal bound electrons has not been included. Some researchers have placed the ions periodically in space to simulate the crystals effect [14] and the fine modulation of the wake was observed in the simulations [15]. However, the laser diffraction by the crystal structure cannot be properly simulated since this effect is related to the response of the internal bound electrons.\nIn this paper, we extend the usual PIC algorithm to include the effects of the bound electrons. The ions that are not fully ionized are considered a two-body macro-particle. The Coulomb interaction connects the two bodies. Since one macro-particle in the PIC codes represents many real particles with similar trajectories in the phase space. To extend this model to the bound electrons, some limitations should be satisfied for specific applications. Otherwise, the effect of the bound electrons may be amplified due to the artificial coherence induced by the macro-particle. As long as the size of the macro-particles (\u03bbpseu, usually characterized by the grid resolution dx) is much smaller than the character scale length of the concerned problem (\u03bbc, usually characterized by the laser wavelength \u03bb0, radiation wavelength or the plasma wavelength), the macro-particle can be used not only to represent the trajectory of the represented particles; but also to correctly handle the coherent synthesis effects of these particles. In this case, although the electrons are combined to different ions, their responses to the external EM fields can be coherent since \u03bbpseu <\u03bbc. The artificial coherence embedded in the macro-particle model correctly represents the real physical effect. Another issue is the different responses of each bound electron in the same ion. Usually, the bound electrons are in different quantum states. The outer ones may show a stronger response to the external fields since the Coulombic force from the ion is relatively weak. However, it is impossible to include these detailed quantum responses of different bound electrons in a PIC code and it is not necessary for many applications. In our macro-particle model, a combined electron in the macroparticle is represented by Zb bound electrons of the ions and Zb is an adjustable number determined by the ionization degree. The detailed responses of every single electron are neglected, only the main response contributed by the dipole component has been re-\n3 served. That is to say that the code is only useful when a localized collective electron in an ion is a useful approximation. It cannot be used in the processes where the quantum effects, such as excitation and ionization by x-ray, dominate. These processes usually need to include atomic physics in PIC codes by storing the internal states and calculating the transition matrix. The quite different spatial and temporal scales for atomic process and plasma evolution should be involved, which is almost impossible for today\u2019s computational technology. However, for our targeted problems, the plasma effects dominate over the quantum response of the ions.\nWe also noticed x-ray plasma interaction has been modeled in some existed code [16, 17], where x-ray laser is modeled by photons and its interaction with plasmas is described by the transport equation ( 1 c \u2202 \u2202t +n\u00b7\u2207 ) I = \u03b7\u2212\u03c7I, where I(r,\u2126,\u03bd,t) is the x-ray intensity, \u03b7(r,\u03bd,t) is the emissivity, \u03c7(r,\u03bd,t) is the opacity, \u2126(\u03b8,\u03c6) is a solid angle, and \u03bd is the radiation frequency. In this approach, the detailed responses of the ions to the x-ray are represented by the plasma\u2019s opacity. Although the x-ray transportation can be modeled, the evolution of the electromagnetic fields with the x-ray frequency cannot be explicitly obtained, which is important for the motion of the freely charged particles. Differently from that, in our model, the x-ray laser is treated as EM waves, and the response of the bound electrons is calculated according to the particle model. In our way, both the EM response of the neutral medium and the Bragg diffraction effect of laser propagation in the crystal can be modeled properly. In the following, we will introduce the modified particle model and show some typical simulation cases for the benchmark of our model."
        },
        {
            "heading": "2 Two-Body Macro-Particle Model for Ions",
            "text": "The ions and electrons in the usual PIC codes are represented by macro-particles. The weight of a macro-particle means the number of the real particles in it. The motions of these macro-particles with mass mc, charge qc and velocity vc are calculated according to the external EM fields. The term qcvc/dV is included in the current to update the fields.\nAs shown in Fig. 1, in our extended PIC simulation model, we assume an partially ionized ion particles is composed of two parts: a nucleus with mass m1, charge q1, and\n4 a combined bound electron with mass m2, charge q2. The particle also contains a bound electron number Zb. Thus m1,2 and q1,2 can be determined according to q2 =\u2212Zbe,m2 = Zbme,q1 = qc\u2212q2,m1 =mc\u2212m2, where e and me represent the charge and mass of an electron. Either of them has its own position and momentum. At each time step, we update their momenta according to the Boris algorithm [18].\nu\u22121,2=u n 1,2+ q1,2\u2206t 2m1,2 E1,2(rn+1/21,2 ) (2.1)\nu+1,2=u \u2212 1,2+ ( u\u22121,2+ ( u\u22121,2\u00d7t1,2 )) \u00d7s1,2 (2.2)\nun+11,2 =u + 1,2+ q1,2\u2206t 2m1,2 E1,2(rn+1/21,2 ) (2.3)\nwith t1,2=B1,2(rn+1/21,2 )q1,2\u2206t/(2m1,2\u03b3 \u2212 1,2), s1,2=2t1,2/(1+t 2 1,2) (2.4)\nwhere u,q,m,\u2206t,E,B,r are the nomalized momentum p/(mc), the charge, the mass, the time step, the electric field, the magnetic field, and the position, respectively, and the subscript 1,2 represents the quantities of the nucleus and the electron, respectively. The electric fields here contain not only the external fields, but also the internal interaction from the nucleus and the combined electrons which can be calculated from the following modified Coulomb potential. Then the currents of each part q1,2v1,2/dV are included into the total current, which is used to update the fields.\nSince we introduce new features in PIC simulation, their initial conditions should be set. At this point, by considering the momentum conservation and assuming the fact that there are no electromagnetic fields emitted from the ions at the beginning, one can get:\np1+p2= pc, (2.5) q1v1+q2v2=0. (2.6)\nThe total momentum pc depends on the initial temperature of the atoms or the partially ionized ions. If we set it as zero, the corresponding initial condition for the nucleus and the combined electron is v1=v2=0.\nSince the main response is the average dipole contribution of the combined electrons, to exclude the extreme response from the innermost electrons, we use a modified Coulomb potential, i.e. VM =\nq1q2 4\u03c0\u03b50 \u221a r2+a2c to simulate the interaction between the nucleus\nand the combined electrons at the out shells [19, 20], where r represents the distance between the combined electron and nucleus. It corresponds to a modified Coulomb force\nq1q2r 4\u03c0\u03b50(r2+a2c )3/2\n. Here ac is an adjustable parameter determined by the material. The numerical divergence of the usual Coulomb force with r = 0 is also avoided. The comparison of the Coulomb interaction and the modified one is shown in Fig. 2. As one can see, the field is close to the usual Coulomb field for the out shell electrons.\nSince the modified Coulomb interaction vanishes when the nucleus and the electron are at the same position, the initial condition r1 = r2 = rc should be taken, where rc is the position of the ion.\n5"
        },
        {
            "heading": "3 Benchmark of the new PIC model",
            "text": "Based on the above model, we have modified the PIC code EPOCH [6] to include the effects of the combined electrons. The positions and the momenta of the nucleus and the bound electrons are added as new data elements of the ion class and the whole structure of the code is thus maintained. We just need to update the new features of the ions in the usual calculation loop and the data transfer among the different parallel processes is almost the same as before. Thus the performance of the code is not affected a lot.\nTo check the validity of our modified code, we apply it to two conditions. First, we study the laser propagation in a neutral medium where all the particles are neutral without plasma. We theoretically deduce the relationship between the material\u2019s permittivity and the parameters of the macro-particles used in the code. Simulations are then performed to check its validity. Then we study the laser propagation in a crystal, where the ions are periodically placed and the Bragg effect can be observed when the ions are not fully ionized.\nSince one of the main purposes of our code is in the study of x-ray laser-driven wakefield acceleration, in the following, we use x-ray as the drive laser. It is quite natural to extend such applications to the usual laser wavelength such as the Ti Sapphire laser with a wavelength of 800nm."
        },
        {
            "heading": "3.1 Simulation of x-ray laser propagation in neutral medium",
            "text": "In the usual PIC simulations, the vacuum permittivity is used in the Maxwell equations. No material permittivity is included because the material polarization contributed by the combined electrons is not considered. In our extended PIC code, such contribution and the permittivity of the material can be naturally included. Since we have used the\n6 new macro-particle model, the vacuum permittivity is still used in the Maxwell equation. However, we should get the relation between the macro-particle model and the material permittivity.\nFor simplicity, we take the case of non-relativistic laser intensity so that the magnetic field of the laser and the longitudinal motion of the particles can be ignored. Then one can obtain the equations of motion for the nucleus and the electron.\nm1 d2r1 dt2 =q1E+F(r), (3.1) m2 d2r2 dt2 =q2E\u2212F(r), (3.2)\n(3.3)\nwhere F(r) is the internal Coulomb force between the two bodies within the macroparticle of the ions. Since we have modified Coulomb potential to VM =\nq1q2 4\u03c0\u03b50 \u221a r2+a2c , the\nintrinsic frequency of the system can be obtained from the Taylor series of VM:\n1 2 \u22022V \u2202r2 \u2223\u2223\u2223\u2223 r=0 = 1 2 mr\u03c92c (3.4)\n\u03c92c = |q1q2|\n4\u03c0\u03b50mra3c . (3.5)\nThen the equations of motion can be solved and we find\nr1= [ \u2212 qc\nmc\u03c92 + m2 m1+m2 \u00b7 qr mr(\u03c92c\u2212\u03c92)\n] E, (3.6)\nr2= [ \u2212 qc\nmc\u03c92 \u2212 m1 m1+m2 \u00b7 qr mr(\u03c92c\u2212\u03c92)\n] E, (3.7)\nwhere E and \u03c9 are the electric field and angular frequency of the laser, respectively, and (m1+m2)rc=m1r1+m2r2, r=r1\u2212r2, mc=(m1+m2), qc=(q1+q2), mr=(m1m2)/(m1+ m2), qr =(q1m2\u2212q2m1)/(m1+m2).\nThen we can derive the permittivity of such a medium through D = \u03b5E = \u03b50E+P = \u03b50E+\u2211P/dV = \u03b50+n1q1r1+n2q2r2, where P is the dipole moment of such an atom and P is the electric polarization. The result is\n\u03b5= \u03b50+ { n1q1 [ \u2212 qc\nmc\u03c92 + m2 m1+m2 \u00b7 qr mr(\u03c92c\u2212\u03c92) ] +n2q2 [ \u2212 qc\nmc\u03c92 \u2212 m1 m1+m2 \u00b7 qr mr(\u03c92c\u2212\u03c92)\n]} .\n(3.8)\nThis formula connects the macro-particle parameter ac, Zb with the material\u2019s property \u03b5 and the dispersion relationship in such a material is determined by c2k2/\u03c92= \u03b5/\u03b50= \u03b5r.\n7 To illustrate the results more clear, we take the material gold, for example, which is n2=n1=n0=5.9\u00d71022cm\u22123. Meanwhile, since the gold has one valent electron, we have considered these electrons as free, which will add a term \u2212n0e2/(me\u03c92) in the permittivity. As shown in Fig. 3-(a), the permittivity in our model can be larger than one, which is impossible for the usual plasmas. The divergences come from the resonance when \u03c9\u223c\u03c9c. Meanwhile, we can always choose proper parameters Zb and ac to obtain the real permittivity.\nWe have carried out PIC simulations to check the model and the modified code. In the simulation, we use the same laser with the wavelength of 12.4 nm(corresponding to photon energy 0.1 keV) and the normalized vector potential a= |eE/me\u03c9c|= 1.0\u00d710\u22126. In addition, the gold atoms are set to be partially ionized with Zb = 78 and there is one free electron per Au atom in the simulation. We let the laser propagate in the medium for 300T0 with different ac and compare the group velocities obtained from the simulation and the model. The group velocity in a material with permittivity \u03b5 is given by\nvg = d\u03c9 dk = ( k \u03c9 + \u03c92 2c2k \u00b7 d\u03b5r d\u03c9 )\u22121 (3.9)\nThe result is given in Fig. 3-(b), which shows that the group velocities from the simulations match well with those from the model. The group velocity falls fast around ac\u223c 9.5\u00d710\u221211m, which comes from the resonance around \u03c9\u223c\u03c9c. Around this region, the PIC simulations show that the laser is reflected and the group velocity is meaningless there. Thus we compare the phase-shifts \u03c6 in the reflection instead. The complex\n8 amplitude of the incoming and reflecting electric fields can be described by\nE\u03030R = (\n1\u2212 \u03b2\u0303 1+ \u03b2\u0303\n) E\u03030I (3.10)\n\u03b2\u0303=\n\u221a \u03b5\n\u03b50 =\u0393i (3.11)\nThen the phase-shift \u03c6 is given by\n\u03c6=arctan ( \u2212 2\u0393\n1\u2212\u03932\n) (3.12)\nAs one can see that the simulated phase shifts in these cases agree with the theoretical prediction quite well.\nMoreover, we also take the case \u03bb0 = 56nm, Zb = 20 in Fig. 3-(a) as a benchmark of refraction. The laser beam is set to be incident to the gold with an incident angle \u03c0/6. Then the transformation of the electric field of the incident and refractive laser is shown in Fig. 3-(c). Again, our code gives a correct angle of refraction. These simulations show the validity of our code to describe the x-ray laser propagation in a neutral medium."
        },
        {
            "heading": "3.2 Simulation of x-ray laser diffraction in a crystal",
            "text": "As mentioned in the introduction, to correctly simulate the wakefield acceleration driven by x-ray lasers in crystals, the laser propagation in a not fully ionized periodic structure should be carried out. In such cases, the Bragg diffraction is a typical phenomenon. To simplify the problem, we only consider a two-dimensional crystal structure. The material is chosen to be gold and the number density of the neutral gold atoms is set to be n=5.9\u00d71022 cm\u22123. Thus the crystal constant is set to be d=n\u22121/3=0.26nm. The wavelength \u03bb0 of the x-ray laser is set to be equal to the crystal constant. The laser has a width of 3 nm and a pulse length of 5 nm. The peak electric field of the x-ray laser is set to be 1.23\u00d71010 V/m. The simulation box is set to be [\u2212100\u03bb0,100\u03bb0]\u00d7[\u2212100\u03bb0,100\u03bb0] and the gold crystal covers the region [\u221220\u03bb0,20\u03bb0]\u00d7[\u2212100\u03bb0,100\u03bb0]. The laser propagates\nalong the x axis. With these parameters, \u03bb0=d, the Bragg\u2019s law N\u03bb0=2dsin(\u03b8) gives the Bragg angle \u03b8B=arcsin(1/2)=\u03c0/6. Simulations with two different laser incidence angles are checked as shown in Fig. 4.\nIn the first case, we set \u03b8B as the angle between the crystal axis and the x axis. From the theoretical analysis, the scattered laser will be along the direction of 2\u03b8B, as shown in Fig. 4-(a). In the second simulation, as a comparison, the crystal axis is along the x axis, as shown in Fig. 4-(b). The distributions of the scattered laser fields for the two cases from the simulations are shown in Fig. 5(a,b). It is illustrated clearly that the scattered laser has an intense component along the Bragg angle in the first case. The corresponding wave vectors of the fields are shown in Fig. 5(c,d), which are consistent with the theoretical predictions. Therefore, the modified code correctly simulates the Bragg scattering, which proves the contribution of combined electrons is properly modeled.\nAs a typical application, here we show such a scattering effect on the generation of the wakefield driven by an x-ray laser in a crystal. The parameters are the same as those in the simulation of the Bragg scattering, except the normalized vector potential a0 of the laser is 3.0 and the gold is longer and pre-ionized with 30 free electrons per ion. The excited longitudinal and transverse wakefields, and the scattered laser fields are shown in Fig. 6. We can find that the laser is continuously scattered in the Bragg angle and the wakefield is slightly modulated by the scattered beam. These effects cannot be observed when the plasma is initially fully ionized and thus the response of bound electrons is\n10\nabsent. Detailed studies of x-ray driven wakefield acceleration in crystals, such as wake excitation and electron injection, will be our future work."
        },
        {
            "heading": "4 Discussion & Summary",
            "text": "To model the atomic physics in PIC simulations is a quite challenging topic. It would need to solve a time-dependent Schrodinger or Dirac equation for every ion to obtain an overall model, which is impossible. However, the expectation value \u3008r\u3009 and \u3008p\u3009 from Schrodinger\u2019s or Dirac\u2019s equation is just the same as that from the Newtonian or relativistic equation of motion. In other words, \u3008r\u3009 and \u3008p\u3009 are calculated precisely in our semi-classical model. To preserve more quantum information, more properties should be calculated in our model. For example, the evolving equations of \u2329 r2 \u232a\ncan be derived from the quantum equations and included in our model. In this way, we can preserve new information \u03c32(r) in the model. In general, we can calculate more properties and consume more computing resources to preserve more quantum information.\nAs we mentioned before, although our method can be extended to include more bound electron effects, so far it is still limited for applications. The quantum effects and detailed response of each bound electron are not included. Besides these, the artificial coherence due to the PIC macro particle model should also be well treated. To fully or even partially include the quantum mechanics in a routine PIC code is extremely difficult due to both considerations of the huge number of particles and the details of each particle. This means that our model can only be used for those processes in which the quantum effects are not so obvious, i.e. the material\u2019s response can be described in a classical way.\nIn summary, by treating the partially ionized ion particles as a two-body system with an internal interaction rather than a single charged particle, the combined electron effects due to both free electrons and bound electrons can be included in a normal PIC frame. The combined electrons can reserve the dipole contribution of the electrons and thus the material\u2019s permittivity can be included without modifying the Maxwell equations. Such\n11\nresponse and other combined electron effects can be adjusted by modulating the internal interaction of the two-body system through the parameters Zb and ac. The permittivity of a medium made by such a model is derived and compared with the experimental data. The laser propagation and scattering in neutral medium and crystals are successfully simulated with a PIC code modified with our model. This method shows a simple way to simulate the effect of the bound electrons in the PIC codes and has the potential to demonstrate and study the linear and nonlinear interactions of lasers with crystals and partially ionized medium at various wavelengths from x-rays to the mid-infrared regime. It deserves to point out that such a modified code should be used carefully since the macro-particle model for combined electrons may artificially introduce the coherence of the different electrons. Our model may be extended to high order contributions of the combined electrons by including multiple components, even though the complexity will be increased."
        },
        {
            "heading": "Acknowledgments",
            "text": "The computations in this paper were run on the \u03c0 2.0 cluster supported by the Center for High Performance Computing at Shanghai Jiao Tong University. This work was supported by the National Natural Science Foundation of China (11991074 and 12135009)."
        }
    ],
    "title": "Modeling of bound electron effects in particle-in- cell simulation",
    "year": 2022
}