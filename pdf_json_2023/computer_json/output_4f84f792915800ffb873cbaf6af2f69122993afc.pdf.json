{
    "abstractText": "Physical modeling of precipitation at fine (sub-kilometer) spatial scales is computationally very expensive. This study develops a highly efficient framework for this task by coupling deep learning (DL) and physical modeling. This framework is developed and tested using regional climate simulations performed over a domain covering Montreal and adjoining regions, for the summers of 2015\u20132020, at 2.5 km and 250 m resolutions. The DL framework uses a recurrent approach and considers atmospheric physical processes, such as advection, to generate high-resolution information from low-resolution data, which enables it to recreate fine details and produce temporally consistent fields. The DL framework generates realistic high-resolution precipitation estimates, including intense short-duration precipitation events, which allows it to be applied in engineering problems, such as evaluating the climate resiliency of urban storm drainage systems. The results portray the value of the proposed DL framework, which can be extended to other resolutions, periods, and regions.",
    "authors": [
        {
            "affiliations": [],
            "name": "B. Teufel"
        },
        {
            "affiliations": [],
            "name": "L. Sun"
        },
        {
            "affiliations": [],
            "name": "M. N. Khaliq"
        },
        {
            "affiliations": [],
            "name": "S. B\u00e9lair"
        },
        {
            "affiliations": [],
            "name": "A. Shamseldin"
        },
        {
            "affiliations": [],
            "name": "D. Nagesh Kumar"
        }
    ],
    "id": "SP:761846c648f8ccc4a69b40b5a3d1de8b3a3c2d9e",
    "references": [
        {
            "authors": [
                "AY Barrera-Animas",
                "LO Oyedele",
                "M Bilal",
                "TD Akinosho",
                "JMD Delgado",
                "LA Akanbi"
            ],
            "title": "Rainfall prediction: a comparative analysis of modern machine learning algorithms for time-series forecasting",
            "venue": "Mach Learn Appl 7:100204",
            "year": 2022
        },
        {
            "authors": [
                "ND Brenowitz",
                "CS Bretherton"
            ],
            "title": "Prognostic validation of a neural network unified physics parameterization",
            "venue": "Geophys Res Lett 45(12):6289\u20136298",
            "year": 2018
        },
        {
            "authors": [
                "J Caballero",
                "C Ledig",
                "A Aitken",
                "A Acosta",
                "J Totz",
                "Z Wang",
                "W Shi"
            ],
            "title": "Real-time video super-resolution with spatio-temporal networks and motion compensation. Paper presented at the 2017 IEEE conference on computer vision and pattern recognition",
            "year": 2017
        },
        {
            "authors": [
                "Chung H",
                "Shin K-S"
            ],
            "title": "Genetic algorithm-optimized long short-term memory network for stock market prediction",
            "year": 2018
        },
        {
            "authors": [
                "J C\u00f4t\u00e9",
                "S Gravel",
                "A M\u00e9thot",
                "A Patoine",
                "M Roch",
                "A Staniforth"
            ],
            "title": "The operational CMC\u2013MRB global environmental multiscale (GEM) model. Part I: design considerations and formulation",
            "venue": "Monthly Weather Rev 126(6):1373\u20131395",
            "year": 1998
        },
        {
            "authors": [
                "M Daniel",
                "A Lemonsu",
                "M D\u00e9qu\u00e9",
                "S Somot",
                "A Alias",
                "V Masson"
            ],
            "title": "Benefits of explicit urban parameterization in regional climate modeling to study climate and city interactions",
            "venue": "Clim Dyn 52(5):2745\u20132764",
            "year": 2019
        },
        {
            "authors": [
                "Y Ding",
                "Y Zhu",
                "J Feng",
                "P Zhang",
                "Z Cheng"
            ],
            "title": "Interpretable spatio-temporal attention LSTM model for flood forecasting",
            "year": 2020
        },
        {
            "authors": [
                "GT Diro",
                "L Sushama"
            ],
            "title": "Simulating Canadian arctic climate at convectionpermitting resolution",
            "year": 2019
        },
        {
            "authors": [
                "C Dong",
                "CC Loy",
                "K He",
                "X Tang"
            ],
            "title": "Image super-resolution using deep convolutional networks",
            "venue": "IEEE Trans Pattern Anal Mach Intell 38(2):295\u2013307",
            "year": 2016
        },
        {
            "authors": [
                "L Girihagama",
                "M Naveed Khaliq",
                "P Lamontagne",
                "J Perdikaris",
                "R Roy",
                "L Sushama",
                "A Elshorbagy"
            ],
            "title": "Streamflow modelling and forecasting for Canadian watersheds using LSTM networks with attention mechanism",
            "year": 2022
        },
        {
            "authors": [
                "M Fuentes",
                "A Geer",
                "L Haimberger",
                "S Healy",
                "RJ Hogan",
                "E H\u00f3lm",
                "M Janiskov\u00e1",
                "S Keeley",
                "P Laloyaux",
                "P Lopez",
                "C Lupu",
                "G Radnoti",
                "P de Rosnay",
                "I Rozum",
                "F Vamborg",
                "S Villaume",
                "J-N Th\u00e9paut"
            ],
            "title": "The ERA5 global reanalysis",
            "venue": "Q J R Meteorol Soc 146(730):1999\u20132049",
            "year": 2020
        },
        {
            "authors": [
                "P Huszar",
                "T Halenka",
                "M Belda",
                "M Zak",
                "K Sindelarova",
                "J Miksovsky"
            ],
            "title": "Regional climate model assessment of the urban land-surface forcing over central Europe",
            "venue": "Atmos Chem Phys 14(22):12393\u201312413",
            "year": 2014
        },
        {
            "authors": [
                "TF Stocker",
                "D Qin",
                "G-K Plattner",
                "M Tignor",
                "SK Allen",
                "J Boschung",
                "A Nauels",
                "Y Xia",
                "V Bex",
                "(eds Midgley PM"
            ],
            "title": "Climate change 2013: the physical science basis",
            "venue": "IPCC",
            "year": 2013
        },
        {
            "authors": [
                "EJ Kendon",
                "N Ban",
                "NM Roberts",
                "HJ Fowler",
                "MJ Roberts",
                "SC Chan",
                "JP Evans",
                "G Fosser",
                "JM Wilkinson"
            ],
            "title": "Do convection-permitting regional climate models improve projections of future precipitation change",
            "year": 2017
        },
        {
            "authors": [
                "WS Lai",
                "JB Huang",
                "N Ahuja",
                "MH Yang"
            ],
            "title": "Deep Laplacian pyramid networks for fast and accurate super-resolution",
            "year": 2017
        },
        {
            "authors": [
                "L Li",
                "Q Yu",
                "Y Yuan",
                "Y Shang",
                "H Lu",
                "X Sun"
            ],
            "title": "Super-resolution reconstruction and higher-degree function deformation model based matching for Chang\u2019E-1 lunar images",
            "venue": "Sci China Ser Technol Sci 52(12):3468",
            "year": 2009
        },
        {
            "authors": [
                "D Liu",
                "Z Wang",
                "Y Fan",
                "X Liu",
                "S Chang",
                "T Huang"
            ],
            "title": "Robust video super-resolution with learned temporal dynamics",
            "venue": "Paper presented at the 2017 IEEE international conference on computer vision (ICCV)",
            "year": 2017
        },
        {
            "authors": [
                "O Makansi",
                "E Ilg",
                "T Brox"
            ],
            "title": "End-to-end learning of video super-resolution with motion compensation",
            "year": 2017
        },
        {
            "authors": [
                "V Masson"
            ],
            "title": "A physically-based scheme for the urban energy budget in atmospheric models. Bound-Layer Meteorol 94(3):357\u2013397",
            "year": 2000
        },
        {
            "authors": [
                "JA Milbrandt",
                "MK Yau"
            ],
            "title": "A multimoment bulk microphysics parameterization. Part I: analysis of the role of the spectral shape parameter",
            "venue": "J Atmos Sci 62(9):3051\u20133064",
            "year": 2005
        },
        {
            "authors": [
                "N M\u00f6lders",
                "MA Olson"
            ],
            "title": "Impact of urban effects on precipitation in high latitudes",
            "venue": "J Hydrometeorol",
            "year": 2004
        },
        {
            "authors": [
                "TR Oke"
            ],
            "title": "The energetic basis of the urban heat island",
            "venue": "Q J R Meteorol Soc 108(455):1\u201324",
            "year": 1982
        },
        {
            "authors": [
                "P Pradhan",
                "T Tingsanchali",
                "S Shrestha"
            ],
            "title": "Evaluation of soil and water assessment tool and artificial neural network models for hydrologic simulation in different climatic regions of Asia",
            "venue": "Sci Total Environ 701:134308",
            "year": 2020
        },
        {
            "authors": [
                "AF Prein",
                "W Langhans",
                "G Fosser",
                "A Ferrone",
                "N Ban",
                "K Goergen",
                "M Keller",
                "M T\u00f6lle",
                "O Gutjahr",
                "F Feser",
                "E Brisson",
                "S Kollet",
                "J Schmidli",
                "NPM van Lipzig",
                "R Leung"
            ],
            "title": "A review on regional convection-permitting climate modeling: demonstrations, prospects, and challenges",
            "venue": "Rev Geophys 53(2):323\u2013361",
            "year": 2015
        },
        {
            "authors": [
                "SN Ray",
                "S Chattopadhyay"
            ],
            "title": "Analyzing surface air temperature and rainfall in univariate framework, quantifying uncertainty through Shannon entropy and prediction through artificial neural network",
            "venue": "Earth Sci Inf 14(1):485\u2013503",
            "year": 2021
        },
        {
            "authors": [
                "M Reichstein",
                "G Camps-Valls",
                "B Stevens",
                "M Jung",
                "J Denzler",
                "N Carvalhais",
                "Prabhat"
            ],
            "title": "Deep learning and process understanding for data-driven Earth system science",
            "year": 2019
        },
        {
            "authors": [
                "MSM Sajjadi",
                "R Vemulapalli",
                "M Brown"
            ],
            "title": "18\u201323 June 2018) Frame-recurrent video super-resolution. Paper presented at the 2018 IEEE/CVF conference on computer vision and pattern recognition",
            "year": 2018
        },
        {
            "authors": [
                "JM Shepherd",
                "SJ Burian"
            ],
            "title": "Detection of urban-induced rainfall anomalies in a major coastal city. Earth Interact 7(4):1\u201317",
            "year": 2003
        },
        {
            "authors": [
                "K Stengel",
                "A Glaws",
                "D Hettinger",
                "RN King"
            ],
            "title": "Adversarial super-resolution of climatological wind and solar data",
            "venue": "Proc Natl Acad Sci",
            "year": 2020
        },
        {
            "authors": [
                "X Tao",
                "H Gao",
                "R Liao",
                "J Wang",
                "J Jia"
            ],
            "title": "Detail-revealing deep video super-resolution",
            "venue": "Paper presented at the 2017 IEEE international conference on computer vision (ICCV)",
            "year": 2017
        },
        {
            "authors": [
                "B Teufel",
                "L Sushama"
            ],
            "title": "High-resolution modelling of climatic hazards relevant for Canada\u2019s northern transportation sector",
            "venue": "Clim Dyn. https:// doi",
            "year": 2022
        },
        {
            "authors": [
                "B Teufel",
                "L Sushama",
                "V Poitras",
                "T Dukhan",
                "S B\u00e9lair",
                "L Miranda-Moreno",
                "L Sun",
                "AP Sasmito",
                "G Bitsuamlak"
            ],
            "title": "Impact of COVID-19-related traffic slowdown on urban heat characteristics",
            "year": 2021
        },
        {
            "authors": [
                "D Trinh",
                "M Luong",
                "F Dibos",
                "J Rocchisani",
                "C Pham",
                "TQ Nguyen"
            ],
            "title": "Novel example-based method for super-resolution and denoising of medical images",
            "venue": "IEEE Trans Image Process 23(4):1882\u20131895",
            "year": 2014
        },
        {
            "authors": [
                "SP Van",
                "HM Le",
                "DV Thanh",
                "TD Dang",
                "HH Loc",
                "DT Anh"
            ],
            "title": "Deep learning convolutional neural network in rainfall\u2013runoff modelling",
            "venue": "J Hydroinf 22(3):541\u2013561",
            "year": 2020
        },
        {
            "authors": [
                "T Vandal",
                "E Kodra",
                "S Ganguly",
                "A Michaelis",
                "R Nemani",
                "AR Ganguly"
            ],
            "title": "DeepSD: generating high resolution climate change projections through single image super-resolution. Paper presented at the proceedings of the 23rd ACM SIGKDD international conference on knowledge discovery",
            "year": 2017
        },
        {
            "authors": [
                "Z Wang",
                "D Liu",
                "J Yang",
                "W Han",
                "T Huang"
            ],
            "title": "Deep networks for image super-resolution with sparse prior",
            "venue": "Paper presented at the 2015 IEEE international conference on computer vision (ICCV)",
            "year": 2015
        },
        {
            "authors": [
                "Y Wu",
                "B Teufel",
                "L Sushama",
                "S Belair",
                "L Sun"
            ],
            "title": "Deep learning-based superresolution climate simulator\u2013emulator framework for urban heat studies",
            "venue": "Geophys Res Lett 48(19):e2021GL094737. https://",
            "year": 2021
        },
        {
            "authors": [
                "Y Xie",
                "E Franz",
                "M Chu",
                "N Thuerey"
            ],
            "title": "TempoGAN: a temporally coherent, volumetric GAN for super-resolution fluid flow",
            "venue": "ACM Trans Graph",
            "year": 2018
        }
    ],
    "sections": [
        {
            "text": "\u00a9 Crown 2023. Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http:// creat iveco mmons. org/ licen ses/ by/4. 0/.\nKeywords Deep learning, Regional climate model, Convection permitting model, Intense precipitation, Engineering scale"
        },
        {
            "heading": "Introduction",
            "text": "Intense short-duration precipitation events can lead to catastrophic flash flooding in urban regions and their intensity/duration/frequency characteristics are thus widely used in the design of engineering systems, such as storm water drainage. In a warming climate, the intensity and frequency of extreme precipitation are expected to increase due to the increasing water-holding capacity of the atmosphere (e.g., IPCC 2013), which is increasingly being accounted for by practitioners during the design of civil infrastructure. Understanding projected changes to short-duration precipitation extremes is particularly important, given that rapid urbanization is occurring, leading to over two-thirds of the global population being projected to live in urban regions by 2050 (UN 2018). Urban regions influence regional weather and climate, as they are replete with anthropogenic heat and aerosol sources, store little water and obstruct atmospheric motion (e.g., Oke 1982; Huszar et\u00a0al. 2014; Daniel et\u00a0 al. 2019). The urban heat island (UHI), characterized by higher temperatures in urban regions than surrounding areas, may contribute to strengthening convection which *Correspondence: B. Teufel bernardo.teufel@mail.mcgill.ca 1 Department of Civil Engineering, Trottier Institute for Sustainability in Engineering and Design, McGill University, Montreal, Canada 2 Ocean, Coastal and River Engineering (OCRE) Research Centre, National Research Council Canada, Ottawa, Canada 3 Meteorological Research Division, Science and Technology Branch, Environment and Climate Change Canada, Dorval, Canada 4 Department of Civil and Environmental Engineering, University of Auckland, Auckland, New Zealand 5 Department of Civil Engineering, Indian Institute of Science, Bangalore, India 6 CSIRO Land and Water, Canberra, Australia\ncan lead to enhanced precipitation extremes (e.g., Shepherd and Burian 2003; M\u00f6lders and Olson 2004).\nRegional climate models (RCMs) are useful tools to study projected changes to climate, which are being increasingly used to inform effective adaptation measures to cope with the impacts of global warming in many fields. However, short-duration precipitation extremes are generally associated with small-scale processes, such as deep convection, which are not resolved at the scales of most existing RCM simulations and are thus approximated through various parameterizations. The recent studies have shown that high resolution (i.e., convection permitting) RCM simulations can realistically capture short-duration precipitation extremes due to better representation of mesoscale dynamics, cloud microphysics, surface heterogeneity and orographic effects (Prein et\u00a0al. 2015; Kendon et\u00a0al. 2017; Diro and Sushama 2019; Teufel and Sushama 2022).\nDevelopment of effective adaptation and mitigation strategies requires information of intense precipitation changes at engineering/super scales (i.e., < 1\u00a0 km spatial resolution). The previous studies have shown that climate simulations with advanced representation of urban regions in RCMs are able to adequately capture urban\u2212 climate feedbacks (e.g., Teufel et\u00a0 al. 2021). However, despite significant developments in computing technology, parallel programming architectures and improved representation of physical processes in climate models, high computational cost continues to be a major barrier in undertaking climate simulations at engineering scales for sufficiently longer periods. For example, a climate simulation at 250\u00a0m requires about 1000 times the computing resources required at 2.5\u00a0 km over the same domain. In addition, ensembles of climate simulations are generally required to quantify uncertainty in climate projections and that further amplifies the required resources. The recent advances in machine learning (Brenowitz and Bretherton 2018; Reichstein et\u00a0al. 2019) and its applications in various fields (e.g., Chung and Shin 2018; Ding et\u00a0al. 2020; Pradhan et\u00a0al. 2020; Stengel et\u00a0al. 2020; Van et\u00a0al. 2020; Ray and Chattopadhyay 2021; Barrera-Animas et\u00a0al. 2022; Girihagama et\u00a0al. 2022) provide an opportunity for developing hybrid approaches, combining physical understanding of atmospheric processes with machine learning architectures, to overcome this obstacle and advance studies on climate\u2212urban infrastructure interactions (Wu et\u00a0 al. 2021) and informing design methodologies. In the recent years, deep learningbased image super-resolution (SR) models built using convolutional neural networks (CNNs) have been developed (e.g., Wang et\u00a0al. 2015; Dong et\u00a0al. 2016; Lai et\u00a0al. 2017; Zhang et\u00a0 al. 2018) and applied to produce highresolution physical fields in various domains (Li et\u00a0 al.\n2009; Trinh et\u00a0al. 2014; Vandal et\u00a0al. 2017; Xie et\u00a0al. 2018; Stengel et\u00a0al. 2020). The CNN-based SR approach is datadriven and does not require solving complex analytical formulations, which dramatically decreases the computational cost of generating high-resolution data once the parameters of CNNs are properly trained and validated.\nThis study focuses on the development, validation and application of a novel framework combining the physically based regional climate model GEM (Global Environmental Multiscale) outputs with deep learning techniques to efficiently generate precipitation information at applied engineering-oriented fine spatial scales. Such fine resolution information is extremely useful for evaluating climate resiliency of urban infrastructure systems to flash flooding in urban centers such as Montreal, where flash flooding caused by high-intensity rainfall is a recurrent problem. Montreal is the second largest city of Canada and is the major economic hub in eastern Canada. Weather related disruptions can trigger cascading impacts on various interconnected urban systems in Montreal. Given such a high impact of short-duration precipitation extremes in urban regions, the objective of this study is to develop an efficient and physically consistent emulator for intense precipitation during the summer season for Montreal, at the sub-hourly time scales associated with deep convection, to support studies on climate resilience of various urban systems. In addition, the goal is to keep the development as generic as possible so that the developed framework can be extended to other seasons, periods and regions of the world.\nThe remainder of this manuscript is organized as follows: \u201cMethodology\u201d section describes the machine learning framework, the physical climate model, and the experiments performed. \u201cResults\u201d section presents the outputs obtained from the machine learning model and compares them to the climate model outputs. Finally, \u201cDiscussion and conclusions\u201d section provides discussion, conclusions and future avenues of research. Main highlights of the study are also discussed in this section."
        },
        {
            "heading": "Methodology",
            "text": ""
        },
        {
            "heading": "Deep learning framework",
            "text": "Given that precipitation evolves in both space and time, the objective of generating high-resolution (HR) precipitation from low-resolution (LR) precipitation is functionally similar to the problem of video super-resolution (VSR). VSR differs from single image SR in that temporal relationships are exploited by combining the information from multiple LR frames to reach better quality results. Many existing VSR methods approach the problem by combining a batch of LR frames to estimate a single HR frame, effectively dividing the task of VSR into a large number of separate multiframe SR subtasks (Caballero\net\u00a0al. 2017; Liu et\u00a0al. 2017; Makansi et\u00a0al. 2017; Tao et\u00a0al. 2017). However, generating each output frame separately reduces the method\u2019s ability to produce temporally consistent HR frames, often resulting in artifacts.\nThe deep learning (DL) framework used in this study is inspired by the one proposed by Sajjadi et\u00a0 al. (2018), named frame-recurrent video super-resolution (FRVSR; Fig.\u00a0 1a). This recurrent approach passes the previously estimated HR frame as an input for the following iteration. Information from past frames can thus be propagated to later frames which helps the model to recreate fine details and produce temporally consistent\nvideos, significantly outperforming other state of the art methods.\nIn this study, two physical considerations are taken into account to adapt the FRVSR approach to the task of generating SR precipitation. First, in VSR the displacements from one frame to the next (called optical flow) are typically estimated from the frames themselves\u2014Sajjadi et\u00a0al. (2018) used an encoder\u2212decoder CNN for this task. The same approach could be chosen for SR precipitation, but instead, the physical fact that precipitation is advected by wind is used to derive optical flow, which has the advantage that flow estimates are available at all times\nand locations, given that wind is a continuous field. This approach also avoids having to train an additional CNN and needing to merge two loss terms. Second, the CNNs in Sajjadi et\u00a0al. (2018) operate in LR space, enabling faster training, but imposing some constraints on the choice of the upscale factor (4 \u00d7 in their case). This is undesirable in SR precipitation, where the upscale factor may vary depending on the specific resolutions of the HR and LR climate simulations. In addition, applying transposed convolutions or similar methods to generate HR outputs can result in undesirable gradients and artifacts\u2014for these reasons, the CNN in the proposed SR precipitation framework is set to operate in HR.\nThe estimates of FRVSR tend to improve with time, i.e., for the first frame of a scene, its performance cannot exceed that of a single-frame image reconstruction method. For subsequent frames, the framework is able to leverage past information, thus producing better estimates. One implication of this is that if movement between consecutive frames is too fast, each frame will appear relatively independent from the previous ones, and a significant fraction of the new frame will not have been previously seen by the DL model, which would degrade its performance. To avoid this, displacements between frames should be small\u2014in the case of SR precipitation, this can be achieved by using the highest feasible temporal resolution, as constrained by the timestep of the climate model.\nFigure\u00a01b shows the DL framework used in this study. The inputs consist of LR precipitation fields and LR storm motion estimates (derived from cloud-level winds). LR information first needs to be upscaled to HR, which is accomplished using bilinear interpolation on precipitation and each storm motion component (u, v). The HR storm motion is then used to advance the previous HR precipitation estimate in time, which is then used alongside the upscaled LR precipitation as inputs to SRNet, which outputs the new best estimate of HR precipitation. The above procedure is then repeated for each subsequent timestep. SRNet is a 5-layer CNN in which the convolutional kernel of each layer is 3 \u00d7 3 and each layer outputs 16 feature maps. The rectified linear unit (ReLU) function is used as the activation function for all convolutional layers. The loss function is defined as the mean squared error (MSE) of the reconstruction (for all grid cells and all timesteps)."
        },
        {
            "heading": "Climate model and\u00a0simulations",
            "text": "The limited area version of the physically based model GEM (C\u00f4t\u00e9 et\u00a0 al. 1998; Girard et\u00a0 al. 2014) is used to perform simulations for the summers (June\u2013August) of 2015\u20132020, at 2.5\u00a0km (low) and 250\u00a0m (high) resolution. The experimental domains for the two resolutions\nare shown in Fig.\u00a01c, with the smaller 250\u00a0m resolution domain covering the city of Montreal. The urban coverage for Montreal and surroundings is shown in Fig.\u00a0 1d. GEM is used for numerical weather prediction at Environment and Climate Change Canada (ECCC). The land part of the model is represented using the Canadian Land Surface Scheme\u2013CLASS (Verseghy 2011), while the urban regions are represented by the Town Energy Balance (TEB; Masson 2000) model. Condensation processes are computed by a double-moment microphysics scheme (Milbrandt and Yau 2005). More details on the parameterizations used can be found in Diro and Sushama (2019). The urban climate simulation at high resolution is driven at the lateral boundaries by the low resolution GEM simulation, which is in turn driven by ERA5 reanalysis data (Hersbach et\u00a0 al. 2020) from the European Centre for Medium-Range Weather Forecasts. GEM outputs at 1-min intervals from both simulations constitute the input data for the DL framework, and match the timestep of the LR simulation. The HR simulation uses a 10\u00a0s timestep, but the highest feasible temporal resolution is constrained by the coarser timestep of the LR simulation (60\u00a0s)."
        },
        {
            "heading": "Deep learning experiments",
            "text": "It is fundamental to note that the HR GEM simulation is driven by the LR GEM simulation only at the lateral boundaries, which means that the HR simulation has considerable freedom to develop its own precipitation evolution, which often differs from the LR simulation in precipitation coverage and intensity. Although expected, these differences make it unadvisable to train the DL framework using the HR and LR simulation outputs directly. Instead, a two step process is developed: first, the DL framework is trained using the HR data and LR data generated from it (this is the method by which VSR frameworks are usually trained); and second, the trained framework is applied to the LR simulation outputs to generate HR data.\nFor the first step, it is desirable to generate LR data in which precipitation follows the spatiotemporal evolution of the HR data as closely as possible, given that during training the DL framework will strive to minimize errors in both space and time in the reconstruction of HR precipitation. This generated LR data (LRG) is obtained by simply averaging the HR fields over each LR grid cell. Here, the data for the summers of 2015\u20132018 is used as the training dataset, and the data for 2019 is used as the validation dataset. Finally, the data for 2020 are used as the test dataset.\nFor the second step, the unseen LR simulations outputs for the entire 2015\u20132020 period are used as inputs to the trained DL framework. The HR outputs from the\nframework will closely follow the spatiotemporal evolution of the LR data, which differs from the HR truth. Given this, and the focus on high-intensity precipitation events, the performance of the framework needs to be assessed in terms of statistical similarity, such as the ability to reproduce the precipitation frequency\u2013intensity relationships, often used for the design of urban drainage networks."
        },
        {
            "heading": "Results",
            "text": "Reconstruction of\u00a0HR information from\u00a0 LRG data The performance of the DL framework is assessed by comparing its estimates to the HR truth, for unseen data in the testing period (i.e., summer of 2020). Comparisons\nare performed both for select intense precipitation events, and in terms of overall statistics for the testing period.\nFigure\u00a0 2a shows the precipitation intensities for 1-min snapshots during selected heavy precipitation events. It can be seen that the DL framework performs very well compared to the HR truth, being able to reproduce many details not visible in the LRG input for all of the events. For instance, the HR truth for event 1 shows the presence of many cores (local maxima) of heavy precipitation. The DL framework is able to realistically capture most of those cores, being only slightly smoother than the HR truth. The same is true for events 3 and 4, although for the latter, the finest\nstructures (only few HR gridcells wide) are not fully reproduced. The DL framework also performs very well at delineating the regions with precipitation intensities above 1\u00a0mm/h and it is also able to emulate the spatial structure of precipitation cores, in which high-intensity precipitation is surrounded by lesser precipitation intensities, a feature not seen in LRG, where a grid cell with high-intensity precipitation can be adjacent to one with zero or negligible precipitation.\nTo further assess its performance, the ability of the DL framework to reproduce the precipitation intensity\u2212frequency relationship is evaluated. In Fig.\u00a0 2b, it can be seen that the frequency of very heavy precipitation (above 20\u00a0 mm/h) is underestimated when averaging the HR data over a LR grid. For the heaviest intensities (100\u00a0 mm/h and above), the frequency is underestimated by up to 50%. The DL framework is able to well reconstruct the frequency of heavy precipitation, reversing most of the underestimation present in the LRG input, and being close to the HR truth over the entire range of precipitation intensities. Since the performance of the framework for specific locations within the domain is also of interest, Fig.\u00a02c shows the intensity\u2212frequency curves for Montreal\u2019s downtown core. Compared with Fig.\u00a0 2b, the underestimation of the heaviest precipitation rates is more pronounced in LRG, reaching close to 80%. The DL framework is able to correct a significant fraction of the underestimation, but not its entirety. One potential explanation would be higher frequency of precipitation events with very fine spatial structures over the downtown core, which are not fully reproduced by the DL framework (as previously mentioned)."
        },
        {
            "heading": "Generation of\u00a0HR information from\u00a0actual LR data",
            "text": "Given that the developed DL framework performs well at reconstructing the HR truth from the LRG data (see \u201cReconstruction of HR information from LRG data\u201d section), the next step is to apply the framework to the actual LR data and assess the realism of the generated output in terms of its similarity to the HR truth. Given that the fields cannot be directly compared at the grid cell level due to the differences between LR and HR GEM, measures of statistical similarity are used.\nGEM simulations at LR exhibit a significantly greater degree of spatial autocorrelation than the LRG data created from HR fields (Fig.\u00a03a). This is not surprising, considering that the actual resolution of a climate model is around 4\u20136 times coarser than its grid spacing, which means that the LRG data are expected to have a greater amount of spatial detail (originally resolved at HR) than the corresponding LR data.\nGiven that the DL framework is trained using the LRG data, it is desirable to transform the actual LR data so that it better resembles the LRG data. The transformation applied reduces spatial autocorrelation (Fig.\u00a03a) and is functionally similar to a sharpening filter. The transformation is performed by convolution with a 3 \u00d7 3 kernel, in which the center element has a value of 1.88, the four corners are zero, and the other four elements are \u2212 0.22 (the sum of all elements equals one as to not introduce bias). These values are chosen with the goal of improving the frequency\u2212intensity relationship of the LR data, which is much closer to LRG after the transformation (Fig.\u00a03b).\nApplying the trained DL model to the transformed LR data produces HR estimates that closely follow the\nspatiotemporal evolution of precipitation in LR GEM, but with the statistical characteristics of HR GEM. Figure\u00a04a shows that LR GEM significantly underestimates the frequency of occurrence of torrential precipitation (above 50\u00a0 mm/h), which is greatly improved (i.e., much closer to the HR truth) after applying the DL framework. It is worth noting that the locations of high values in the DL outputs resemble those of LR GEM, which are not the same as in HR GEM. Given the relative rarity of such heavy precipitation, the differences in the location of the maxima are a consequence to the small sample size (6\u00a0 years) and not indicative of longterm means. In terms of the precipitation intensity\u2212 frequency relationship (Fig.\u00a0 4b), the DL framework produces results that are very close to the HR truth over the entire intensity range (from 1 to 100\u00a0 mm/h). Even for specific areas, such as Montreal\u2019s downtown core (Fig.\u00a04c) the performance of the DL framework is quite adequate and much better than the original LR data."
        },
        {
            "heading": "Discussion and\u00a0conclusions",
            "text": "In this study, a physics-informed deep learning framework that enhances the resolution of precipitation from 2.5\u00a0km to 250\u00a0m (i.e., by a factor of 10) is developed and tested for Montreal, which is the second largest city in Canada, using outputs from a physically based regional climate model. It is noted that the deep learning framework is able to recreate fine details and produce temporally consistent precipitation fields by taking into account physical atmospheric processes, such as the advection of precipitation by wind, which is the novelty of this study. The results show that the deep learning model is capable of capturing many of the fundamental characteristics of intense short-duration precipitation events at fine spatial scales, such as their coverage, intensity and spatial structure.\nWhen applying this framework to outputs from coarser climate simulations in future studies, it is important to account for the fact that the actual resolution of the precipitation data is coarser than its grid spacing, meaning that the data will be overly smooth\nand preprocessing (e.g., sharpening) would be required to increase the quality and realism of the estimates produced by the framework. Potential future improvements to this framework include taking into account the spatial structure of precipitation and/or controlling variables (e.g., buoyancy, wind speed/shear), and improvements to storm motion estimates, given that storms often influence atmospheric circulation at local scales and thus not always follow regional-scale winds. We intend to explore such ideas in future research.\nFinally, the benefits of a properly trained deep learning framework capable of generating engineering scale precipitation information cannot be overstated. For a fraction of the computational cost of conventional methods that involve high-resolution numerical regional climate models, long simulations of precipitation with ample spatial and temporal detail can readily be performed, and even generating several ensembles of simulations is readily feasible, which is fundamental for quantifying uncertainty in climate projections. This advancement in modeling intense precipitation events using physics-informed deep learning framework will facilitate the development of effective adaptation and mitigation strategies for the climate challenges being faced by highly interconnected engineering systems in complex urban environments. It is hoped that the outcomes of this study and the developed theoretical framework will trigger several additional studies in other urban regions of the world.\nAcknowledgements The GEM simulations and DL experiments considered in this study were performed on the supercomputer managed by the Digital Research Alliance of Canada and Calcul Qu\u00e9bec. The authors would like to acknowledge the two anonymous reviewers for their helpful comments.\nAuthor contributions BT, FC and LSus designed the deep learning framework in consultation with LSun and MNK. BT performed the climate simulations and FC coded the deep learning framework. Both FC and BT performed deep learning experiments and analyzed the results. BT drafted the initial manuscript, to which all authors contributed substantial revisions, following which they read and approved the final manuscript.\nFunding This research was funded by the National Research Council of Canada (New Beginnings Initiative), Canadian Space Agency (Grant 21SUESDFIM), Natural Sciences and Engineering Research Council of Canada, Trottier Institute for Sustainability in Engineering and Design and McGill Sustainability Systems Initiative.\nAvailability of data and materials All data used in this study can be accessed at: https:// zenodo. org/ record/ 66319 96"
        },
        {
            "heading": "Declarations",
            "text": "Competing interests The authors declare that they have no competing interests.\nReceived: 29 July 2022 Accepted: 28 March 2023\nReferences Barrera-Animas AY, Oyedele LO, Bilal M, Akinosho TD, Delgado JMD, Akanbi\nLA (2022) Rainfall prediction: a comparative analysis of modern machine learning algorithms for time-series forecasting. Mach Learn Appl 7:100204. https:// doi. org/ 10. 1016/j. mlwa. 2021. 100204 Brenowitz ND, Bretherton CS (2018) Prognostic validation of a neural network unified physics parameterization. Geophys Res Lett 45(12):6289\u20136298. https:// doi. org/ 10. 1029/ 2018G L0785 10 Caballero J, Ledig C, Aitken A, Acosta A, Totz J, Wang Z, Shi W (21\u201326 July 2017) Real-time video super-resolution with spatio-temporal networks and motion compensation. Paper presented at the 2017 IEEE conference on computer vision and pattern recognition (CVPR) Chung H, Shin K-S (2018) Genetic algorithm-optimized long short-term memory network for stock market prediction. Sustainability 10(10):3765 C\u00f4t\u00e9 J, Gravel S, M\u00e9thot A, Patoine A, Roch M, Staniforth A (1998) The operational CMC\u2013MRB global environmental multiscale (GEM) model. Part I: design considerations and formulation. Monthly Weather Rev 126(6):1373\u20131395. https:// doi. org/ 10. 1175/ 1520- 0493(1998) 126< 1373: tocmg e>2. 0. co;2 Daniel M, Lemonsu A, D\u00e9qu\u00e9 M, Somot S, Alias A, Masson V (2019) Benefits of explicit urban parameterization in regional climate modeling to study climate and city interactions. Clim Dyn 52(5):2745\u20132764. https:// doi. org/ 10. 1007/ s00382- 018- 4289-x Ding Y, Zhu Y, Feng J, Zhang P, Cheng Z (2020) Interpretable spatio-temporal attention LSTM model for flood forecasting. Neurocomputing 403:348\u2013 359. https:// doi. org/ 10. 1016/j. neucom. 2020. 04. 110 Diro GT, Sushama L (2019) Simulating Canadian arctic climate at convectionpermitting resolution. Atmosphere 10(8):430 Dong C, Loy CC, He K, Tang X (2016) Image super-resolution using deep convolutional networks. IEEE Trans Pattern Anal Mach Intell 38(2):295\u2013307. https:// doi. org/ 10. 1109/ TPAMI. 2015. 24392 81 Girard C, Plante A, Desgagn\u00e9 M, McTaggart-Cowan R, C\u00f4t\u00e9 J, Charron M, Gravel S, Lee V, Patoine A, Qaddouri A, Roch M, Spacek L, Tanguay M, Vaillancourt PA, Zadra A (2014) Staggered vertical discretization of the Canadian environmental multiscale (GEM) model using a coordinate of the loghydrostatic-pressure type. Mon Weather Rev 142(3):1183\u20131196. https:// doi. org/ 10. 1175/ mwr-d- 13- 00255.1 Girihagama L, Naveed Khaliq M, Lamontagne P, Perdikaris J, Roy R, Sushama L, Elshorbagy A (2022) Streamflow modelling and forecasting for Canadian watersheds using LSTM networks with attention mechanism. Neural Comput Appl 34(22):19995\u201320015. https:// doi. org/ 10. 1007/ s00521- 022- 07523-8 Hersbach H, Bell B, Berrisford P, Hirahara S, Hor\u00e1nyi A, Mu\u00f1oz-Sabater J, Nicolas J, Peubey C, Radu R, Schepers D, Simmons A, Soci C, Abdalla S, Abellan X, Balsamo G, Bechtold P, Biavati G, Bidlot J, Bonavita M, De Chiara G, Dahlgren P, Dee D, Diamantakis M, Dragani R, Flemming J, Forbes R, Fuentes M, Geer A, Haimberger L, Healy S, Hogan RJ, H\u00f3lm E, Janiskov\u00e1 M, Keeley S, Laloyaux P, Lopez P, Lupu C, Radnoti G, de Rosnay P, Rozum I, Vamborg F, Villaume S, Th\u00e9paut J-N (2020) The ERA5 global reanalysis. Q J R Meteorol Soc 146(730):1999\u20132049. https:// doi. org/ 10. 1002/ qj. 3803 Huszar P, Halenka T, Belda M, Zak M, Sindelarova K, Miksovsky J (2014) Regional climate model assessment of the urban land-surface forcing over central Europe. Atmos Chem Phys 14(22):12393\u201312413. https:// doi. org/ 10. 5194/ acp- 14- 12393- 2014 IPCC (2013) Climate change 2013: the physical science basis. In: Stocker TF, Qin D, Plattner G-K, Tignor M, Allen SK, Boschung J, Nauels A, Xia Y, Bex V, Midgley PM (eds) Contribution of working group I to the 5th assessment report of the intergovernmental panel on climate change. Cambridge University Press, Cambridge Kendon EJ, Ban N, Roberts NM, Fowler HJ, Roberts MJ, Chan SC, Evans JP, Fosser G, Wilkinson JM (2017) Do convection-permitting regional climate models improve projections of future precipitation change? Bull Am Meteor Soc 98(1):79\u201393. https:// doi. org/ 10. 1175/ bams-d- 15- 0004.1 Lai WS, Huang JB, Ahuja N, Yang MH (21\u201326 July 2017) Deep Laplacian pyramid networks for fast and accurate super-resolution. Paper presented at\nthe 2017 IEEE conference on computer vision and pattern recognition (CVPR)\nLi L, Yu Q, Yuan Y, Shang Y, Lu H, Sun X (2009) Super-resolution reconstruction and higher-degree function deformation model based matching for Chang\u2019E-1 lunar images. Sci China Ser Technol Sci 52(12):3468. https:// doi. org/ 10. 1007/ s11431- 009- 0334-7 Liu D, Wang Z, Fan Y, Liu X, Wang Z, Chang S, Huang T (22\u201329 Oct 2017) Robust video super-resolution with learned temporal dynamics. Paper presented at the 2017 IEEE international conference on computer vision (ICCV) Makansi O, Ilg E, Brox T (2017) End-to-end learning of video super-resolution with motion compensation, Cham Masson V (2000) A physically-based scheme for the urban energy budget in atmospheric models. Bound-Layer Meteorol 94(3):357\u2013397. https:// doi. org/ 10. 1023/A: 10024 63829 265 Milbrandt JA, Yau MK (2005) A multimoment bulk microphysics parameterization. Part I: analysis of the role of the spectral shape parameter. J Atmos Sci 62(9):3051\u20133064. https:// doi. org/ 10. 1175/ jas35 34.1 M\u00f6lders N, Olson MA (2004) Impact of urban effects on precipitation in high latitudes. J Hydrometeorol 5(3):409\u2013429. https:// doi. org/ 10. 1175/ 1525- 7541(2004) 005% 3c0409: ioueop% 3e2.0. co;2 Oke TR (1982) The energetic basis of the urban heat island. Q J R Meteorol Soc 108(455):1\u201324. https:// doi. org/ 10. 1002/ qj. 49710 845502 Pradhan P, Tingsanchali T, Shrestha S (2020) Evaluation of soil and water assessment tool and artificial neural network models for hydrologic simulation in different climatic regions of Asia. Sci Total Environ 701:134308. https:// doi. org/ 10. 1016/j. scito tenv. 2019. 134308 Prein AF, Langhans W, Fosser G, Ferrone A, Ban N, Goergen K, Keller M, T\u00f6lle M, Gutjahr O, Feser F, Brisson E, Kollet S, Schmidli J, van Lipzig NPM, Leung R (2015) A review on regional convection-permitting climate modeling: demonstrations, prospects, and challenges. Rev Geophys 53(2):323\u2013361. https:// doi. org/ 10. 1002/ 2014R G0004 75 Ray SN, Chattopadhyay S (2021) Analyzing surface air temperature and rainfall in univariate framework, quantifying uncertainty through Shannon entropy and prediction through artificial neural network. Earth Sci Inf 14(1):485\u2013503. https:// doi. org/ 10. 1007/ s12145- 020- 00555-5 Reichstein M, Camps-Valls G, Stevens B, Jung M, Denzler J, Carvalhais N, Prabhat (2019) Deep learning and process understanding for data-driven Earth system science. Nature 566(7743):195\u2013204. https:// doi. org/ 10. 1038/ s41586- 019- 0912-1 Sajjadi MSM, Vemulapalli R, Brown M (18\u201323 June 2018) Frame-recurrent video super-resolution. Paper presented at the 2018 IEEE/CVF conference on computer vision and pattern recognition Shepherd JM, Burian SJ (2003) Detection of urban-induced rainfall anomalies in a major coastal city. Earth Interact 7(4):1\u201317. https:// doi. org/ 10. 1175/ 1087- 3562(2003) 007% 3c0001: douira% 3e2.0. co;2 Stengel K, Glaws A, Hettinger D, King RN (2020) Adversarial super-resolution of climatological wind and solar data. Proc Natl Acad Sci 117(29):16805\u2013 16815. https:// doi. org/ 10. 1073/ pnas. 19189 64117 Tao X, Gao H, Liao R, Wang J, Jia J (22\u201329 Oct 2017) Detail-revealing deep video super-resolution. Paper presented at the 2017 IEEE international conference on computer vision (ICCV) Teufel B, Sushama L (2022) High-resolution modelling of climatic hazards relevant for Canada\u2019s northern transportation sector. Clim Dyn. https:// doi. org/ 10. 1007/ s00382- 022- 06265-6 Teufel B, Sushama L, Poitras V, Dukhan T, B\u00e9lair S, Miranda-Moreno L, Sun L, Sasmito AP, Bitsuamlak G (2021) Impact of COVID-19-related traffic slowdown on urban heat characteristics. Atmosphere 12(2):243 Trinh D, Luong M, Dibos F, Rocchisani J, Pham C, Nguyen TQ (2014) Novel example-based method for super-resolution and denoising of medical images. IEEE Trans Image Process 23(4):1882\u20131895. https:// doi. org/ 10. 1109/ TIP. 2014. 23084 22 UN (2018) World urbanization prospects: the 2018 revision. Department of Economic and Social Affairs, United Nations New York, NY, USA Van SP, Le HM, Thanh DV, Dang TD, Loc HH, Anh DT (2020) Deep learning convolutional neural network in rainfall\u2013runoff modelling. J Hydroinf 22(3):541\u2013561. https:// doi. org/ 10. 2166/ hydro. 2020. 095 Vandal T, Kodra E, Ganguly S, Michaelis A, Nemani R, Ganguly AR (2017) DeepSD: generating high resolution climate change projections through single image super-resolution. Paper presented at the proceedings of the 23rd ACM SIGKDD international conference on knowledge discovery\nand data mining, Halifax, NS, Canada. https:// doi. org/ 10. 1145/ 30979 83. 30980 04\nVerseghy DL (2011) CLASS\u2014the Canadian land surface scheme (version 3.5), technical documentation (version 1). Climate Research Division, Science and Technology Branch, Environment Canada Wang Z, Liu D, Yang J, Han W, Huang T (7\u201313 Dec 2015) Deep networks for image super-resolution with sparse prior. Paper presented at the 2015 IEEE international conference on computer vision (ICCV) Wu Y, Teufel B, Sushama L, Belair S, Sun L (2021) Deep learning-based superresolution climate simulator\u2013emulator framework for urban heat studies. Geophys Res Lett 48(19):e2021GL094737. https:// doi. org/ 10. 1029/ 2021G L0947 37 Xie Y, Franz E, Chu M, Thuerey N (2018) TempoGAN: a temporally coherent, volumetric GAN for super-resolution fluid flow. ACM Trans Graph 37(4):Article 95. https:// doi. org/ 10. 1145/ 31975 17. 32013 04 Zhang Y, Tian Y, Kong Y, Zhong B, Fu Y (18\u201323 June 2018) Residual dense network for image super-resolution. Paper presented at the 2018 IEEE/CVF conference on computer vision and pattern recognition"
        },
        {
            "heading": "Publisher\u2019s Note",
            "text": "Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations."
        }
    ],
    "title": "Physics-informed deep learning framework to model intense precipitation events at super resolution",
    "year": 2023
}