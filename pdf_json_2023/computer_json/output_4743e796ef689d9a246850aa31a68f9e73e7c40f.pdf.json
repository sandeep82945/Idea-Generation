{
    "abstractText": "The present work is concerned with the extension of modified potential operator splitting methods to specific classes of nonlinear evolution equations. The considered partial differential equations of Schr\u00f6dinger and parabolic type comprise the Laplacian, a potential acting as multiplication operator, and a cubic nonlinearity. Moreover, an invariance principle is deduced that has a significant impact on the efficient realisation of the resulting modified operator splitting methods for the Schr\u00f6dinger case. Numerical illustrations for the time-dependent Gross\u2013Pitaevskii equation in the physically most relevant case of three space dimensions and for its parabolic counterpart related to ground state and excited state computations confirm the benefits of the proposed fourth-order modified operator splitting method in comparison with standard splitting methods. The presented results are novel and of particular interest from both, a theoretical perspective to inspire future investigations of modified operator splitting methods for other classes of nonlinear evolution equations and a practical perspective to advance the reliable and efficient simulation of Gross\u2013Pitaevskii systems in real and imaginary time.",
    "authors": [
        {
            "affiliations": [],
            "name": "S. Blanes"
        },
        {
            "affiliations": [],
            "name": "F. Casas"
        },
        {
            "affiliations": [],
            "name": "C. Gonz\u00e1lez"
        },
        {
            "affiliations": [],
            "name": "M. Thalhammer"
        }
    ],
    "id": "SP:8b2291d40a78fc578059e66815985699ba68c402",
    "references": [
        {
            "authors": [
                "X. Antoine",
                "A. Arnold"
            ],
            "title": "Ch",
            "venue": "Besse, M. Ehrhardt, A. Sch\u00e4dle. A review of transparent and artificial boundary conditions techniques for linear and nonlinear Schr\u00f6dinger equations. Commun. Comput. Phys. 4 ",
            "year": 2008
        },
        {
            "authors": [
                "J. Auer",
                "E. Krotscheck",
                "S. Chin"
            ],
            "title": "A fourth-order real-space algorithm for solving local Schr\u00f6dinger equations",
            "venue": "J. Chem. Phys. 115 ",
            "year": 2001
        },
        {
            "authors": [
                "W. Auzinger",
                "H. Hofst\u00e4tter",
                "O. Koch"
            ],
            "title": "Non-existence of generalized splitting methods with positive coefficients of order higher than four",
            "venue": "Appl. Math. Letters 97 ",
            "year": 2019
        },
        {
            "authors": [
                "P. Bader",
                "S. Blanes",
                "F. Casas"
            ],
            "title": "Solving the Schr\u00f6dinger eigenvalue problem by the imaginary time propagation technique using splitting methods with complex coefficients",
            "venue": "J. Chem. Phys. 139 ",
            "year": 2013
        },
        {
            "authors": [
                "W. Bao",
                "Q. Du"
            ],
            "title": "Computing the ground state solution of Bose\u2013Einstein condensates by a normalized gradient flow",
            "venue": "SIAM J. Sci. Comput. 25 ",
            "year": 2004
        },
        {
            "authors": [
                "W. Bao",
                "S. Jin",
                "P. Markowich"
            ],
            "title": "On time-splitting spectral approximations for the Schr\u00f6dinger equation in the semiclassical regime",
            "venue": "J. Comput. Phys. 175 ",
            "year": 2002
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas"
            ],
            "title": "On the necessity of negative coefficients for operator splitting schemes of order higher than two",
            "venue": "Appl. Numer. Math. 54 ",
            "year": 2005
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas",
                "A. Escorihuela-Tom\u00e0s"
            ],
            "title": "Applying splitting methods with complex coefficients to the numerical integration of unitary problems",
            "venue": "J. Comput. Dyn. 9 ",
            "year": 2022
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas",
                "A. Murua"
            ],
            "title": "An efficient algorithm based on splitting for the time integration of the Schr\u00f6dinger equation",
            "venue": "J. Comput. Phys. 303 ",
            "year": 2015
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas",
                "C. Gonz\u00e1lez",
                "M. Thalhammer"
            ],
            "title": "Efficient splitting methods based on modified potentials: numerical integration of linear parabolic problems and imaginary time propagation of the Schr\u00f6dinger equation",
            "venue": "To appear in Commun. Comput. Phys. ",
            "year": 2023
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas",
                "C. Gonz\u00e1lez",
                "M. Thalhammer"
            ],
            "title": "Symmetricconjugate splitting methods for evolution equations of parabolic type",
            "venue": "Submitted ",
            "year": 2023
        },
        {
            "authors": [
                "M. Caliari",
                "S. Zuccher"
            ],
            "title": "A fast time splitting finite difference approach to Gross\u2013Pitaevskii equations",
            "venue": "Commun. Comput. Phys. 29 ",
            "year": 2021
        },
        {
            "authors": [
                "F. Castella",
                "P. Chartier",
                "S. Decombes",
                "G. Vilmart"
            ],
            "title": "Splitting methods with complex times for parabolic equations",
            "venue": "BIT 49 ",
            "year": 2009
        },
        {
            "authors": [
                "S. Chin"
            ],
            "title": "Symplectic integrators from composite operator factorizations",
            "venue": "Phys. Lett. A 226 ",
            "year": 1997
        },
        {
            "authors": [
                "S. Chin"
            ],
            "title": "Structure of positive decomposition of exponential operators",
            "venue": "Phys. Rev. E 71 ",
            "year": 2005
        },
        {
            "authors": [
                "I. Danaila",
                "B. Protas"
            ],
            "title": "Computation of ground states of the Gross\u2013Pitaevskii functional via Riemannian optimization",
            "venue": "SIAM J. Sci. Comput. 39 ",
            "year": 2017
        },
        {
            "authors": [
                "E. Gross"
            ],
            "title": "Structure of a quantized vortex in boson systems",
            "venue": "Nuovo Cimento 20 ",
            "year": 1961
        },
        {
            "authors": [
                "E. Hairer"
            ],
            "title": "Ch",
            "venue": "Lubich, G. Wanner. Geometric Numerical Integration. Springer, Second Edition",
            "year": 2006
        },
        {
            "authors": [
                "E. Hansen",
                "A. Ostermann"
            ],
            "title": "High order splitting methods for analytic semigroups exist",
            "venue": "BIT 49 ",
            "year": 2009
        },
        {
            "authors": [
                "E. Hille",
                "R. Phillips"
            ],
            "title": "Functional Analysis and Semi-Groups",
            "venue": "American Mathematical Society",
            "year": 1974
        },
        {
            "authors": [
                "A. Iserles"
            ],
            "title": "A First Course in the Numerical Analysis of Differential Equations",
            "venue": "Cambridge University Press, Second Edition",
            "year": 2008
        },
        {
            "authors": [
                "E. Kieri"
            ],
            "title": "Stiff convergence of force-gradient operator splitting methods",
            "venue": "Appl. Numer. Math. 94 ",
            "year": 2015
        },
        {
            "authors": [
                "R. McLachlan",
                "G. Quispel"
            ],
            "title": "Splitting methods",
            "venue": "Acta Numerica 11 ",
            "year": 2002
        },
        {
            "authors": [
                "A. Messiah"
            ],
            "title": "Quantum Mechanics",
            "venue": "Dover",
            "year": 1999
        },
        {
            "authors": [
                "L. Pitaevskii"
            ],
            "title": "Vortex lines in an imperfect Bose gas",
            "venue": "Sov. Phys. JETP 13 ",
            "year": 1961
        },
        {
            "authors": [
                "I. Omelyan",
                "I. Mryglod",
                "R. Folk"
            ],
            "title": "On the construction of high order force gradient algorithms for integration of motion in classical and quantum systems",
            "venue": "Phys. Rev. E 66 ",
            "year": 2002
        },
        {
            "authors": [
                "I. Omelyan",
                "I. Mryglod",
                "R. Folk"
            ],
            "title": "Symplectic analytically integrable decomposition algorithms: classification",
            "venue": "derivation, and application to molecular dynamics, quantum and celestial mechanics simulations. Comput. Phys. Comm. 151 ",
            "year": 2003
        },
        {
            "authors": [
                "R. Ruth"
            ],
            "title": "A canonical integration technique",
            "venue": "IEEE Trans. Nucl. Sci. 30 ",
            "year": 1983
        },
        {
            "authors": [
                "J. Sanz-Serna",
                "M. Calvo"
            ],
            "title": "Numerical Hamiltonian Problems",
            "venue": "Dover",
            "year": 2018
        },
        {
            "authors": [
                "Q. Sheng"
            ],
            "title": "Solving linear partial differential equations by exponential splitting",
            "venue": "IMA J. Numer. Anal. 9 ",
            "year": 1989
        },
        {
            "authors": [
                "M. Suzuki"
            ],
            "title": "General theory of fractal path integrals with applications to manybody theories and statistical physics",
            "venue": "J. Math. Phys. 32 ",
            "year": 1991
        },
        {
            "authors": [
                "M. Suzuki"
            ],
            "title": "Hybrid exponential product formulas for unbounded operators with possible applications to Monte Carlo simulations",
            "venue": "Phys. Lett. A 201 ",
            "year": 1995
        },
        {
            "authors": [
                "M. Thalhammer"
            ],
            "title": "High-order exponential operator splitting methods for timedependent Schr\u00f6dinger equations",
            "venue": "SIAM J. Numer. Anal. 46 ",
            "year": 2008
        },
        {
            "authors": [
                "M. Thalhammer",
                "J. Abhau"
            ],
            "title": "A numerical study of adaptive space and time discretisations for Gross\u2013Pitaevskii equations",
            "venue": "J. Comput. Phys. 231 ",
            "year": 2012
        },
        {
            "authors": [
                "V. Varadarajan"
            ],
            "title": "Lie Groups",
            "venue": "Lie Algebras, and Their Representations. Springer",
            "year": 1984
        },
        {
            "authors": [
                "H. Yoshida"
            ],
            "title": "Construction of higher order symplectic integrators",
            "venue": "Phys. Lett. A 150 ",
            "year": 1990
        }
    ],
    "sections": [
        {
            "text": "The present work is concerned with the extension of modified potential operator splitting methods to specific classes of nonlinear evolution equations. The considered partial differential equations of Schr\u00f6dinger and parabolic type comprise the Laplacian, a potential acting as multiplication operator, and a cubic nonlinearity. Moreover, an invariance principle is deduced that has a significant impact on the efficient realisation of the resulting modified operator splitting methods for the Schr\u00f6dinger case.\nNumerical illustrations for the time-dependent Gross\u2013Pitaevskii equation in the physically most relevant case of three space dimensions and for its parabolic counterpart related to ground state and excited state computations confirm the benefits of the proposed fourth-order modified operator splitting method in comparison with standard splitting methods.\nThe presented results are novel and of particular interest from both, a theoretical perspective to inspire future investigations of modified operator splitting methods for other classes of nonlinear evolution equations and a practical perspective to advance the reliable and efficient simulation of Gross\u2013Pitaevskii systems in real and imaginary time.\nKey words: Nonlinear evolution equations, Parabolic problems, Schr\u00f6dinger equations, Gross\u2013Pitaevskii systems, Geometric time integration, Operator splitting methods, Fourier spectral method, Stability, Convergence, Efficiency.\n1Addresses: Sergio Blanes, Universitat Polit\u00e8cnica de Val\u00e8ncia, Instituto de Matem\u00e1tica Multidisciplinar, 46022 Valencia, Spain. Fernando Casas, Universitat Jaume I, IMAC and Departament de Matem\u00e0tiques, 12071 Castell\u00f3n, Spain. Ces\u00e1reo Gonz\u00e1lez, Universidad de Valladolid, Departamento de Matem\u00e1tica Aplicada, 47011 Valladolid, Spain. Mechthild Thalhammer, Leopold\u2013Franzens-Universit\u00e4t Innsbruck, Institut f\u00fcr Mathematik, 6020 Innsbruck, Austria. Websites: personales.upv.es/serblaza, www.gicas.uji. es/fernando.html, www.imuva.uva.es/en/investigadores/33, techmath.uibk.ac.at/mecht. Email addresses: serblaza@imm.upv.es, fernando.casas@uji.es, ome@am.uva.es, mechthild.thalhammer@uibk.ac.at.\nPreprint submitted to Elsevier 16 October 2023\nar X\niv :2\n31 0.\n08 96\n9v 1\n[ m\nat h.\nN A\n] 1"
        },
        {
            "heading": "1 Introduction",
            "text": "Scope of applications. A wide range of relevant applications in sciences includes the numerical integration of initial value problems for nonlinear evolution equations. In many cases, the function defining the right-hand side comprises two or more parts\n d dt u(t) = F1 ( u(t) ) + F2 ( u(t) ) ,\nu(0) = u0 , t \u2208 [0, T ] . (1)\nAs prominent instances, we highlight nonlinear Schr\u00f6dinger equations, more specifically, time-dependent Gross\u2013Pitaevskii equations that arise in the description of Bose\u2013Einstein condensation, see [17,25]. For a comprehensive overview of the underlying principles of quantum theory, we refer to [24].\nNonlinear Schr\u00f6dinger equation (Gross\u2013Pitaevskii equation). A fundamental model for the nonlinear dynamics of a single Bose\u2013Einstein condensate reads asi \u2202t\u03a8(x, t) = \u2212\u2206\u03a8(x, t) + V (x)\u03a8(x, t) + \u03d1 |\u03a8(x, t)|2\u03a8(x, t) ,\u03a8(x, 0) = \u03a80(x) , (x, t) \u2208 \u2126\u00d7 [0, T ] , (2a) where \u2206 = \u22022x1 + \u00b7 \u00b7 \u00b7 + \u2202 2 xd\ndenotes the Laplacian with respect to the spatial variables x = (x1, . . . , xd) \u2208 Rd, V : Rd \u2192 R a real-valued potential, \u03d1 \u2208 R the coupling constant, and \u03a8 : \u2126\u00d7 [0, T ] \u2282 Rd\u00d7R \u2192 C the space-time-dependent complex-valued macroscopic wave function. Assigning for a regular function v : \u2126 \u2192 C the linear differential and nonlinear multiplication operators\n( F1(v) ) (x) = c\u2206 v(x) , c = i ,(\nF2(v) ) (x) = c\u0304 ( V (x) + \u03d1 |v(x)|2 ) v(x) , c\u0304 = \u2212 i ,\nx \u2208 \u2126 ,\n(2b)\nand setting u(t) = \u03a8(\u00b7, t) for t \u2208 [0, T ], we retain the general formulation (1).\nNonlinear parabolic equation. By analogy to the time-dependent Gross\u2013 Pitaevskii equation (2a), we consider the parabolic problem \u2202tU(x, t) = \u2206U(x, t) + V (x)U(x, t) + \u03d1 |U(x, t)|2 U(x, t) ,U(x, 0) = U0(x) , (x, t) \u2208 \u2126\u00d7 [0, T ] , (3a) for a real-valued solution U : \u2126 \u00d7 [0, T ] \u2282 Rd \u00d7 R \u2192 R. Accordingly, it\ncorresponds to (2b) with different constant( F1(v) ) (x) = c\u2206 v(x) , c = 1 ,(\nF2(v) ) (x) = c\u0304 ( V (x) + \u03d1 |v(x)|2 ) v(x) , c\u0304 = 1 ,\nx \u2208 \u2126 ,\n(3b)\nand, setting u(t) = U(\u00b7, t) for t \u2208 [0, T ], we obtain again the general form (1). It is noteworthy that the parabolic equation (3a) arises in ground state and excited state computations, see for instance [5,16].\nSplitting approach. In essence, operator splitting methods rely on the presumption that the numerical approximation of the subproblems\nd dt u1(t) = F1 ( u1(t) ) , ddt u2(t) = F2 ( u2(t) ) ,\nis significantly simpler compared to the numerical approximation of the original problem (1). Then, within multiple scopes, for ordinary differential equations and time-dependent partial differential equations, for linear problems as well as nonlinear problems, a variety of works has confirmed the benefits of operator splitting methods regarding desirable features that are subsumed under the central concepts stability, efficiency, and preservation of conserved quantities. For general information, we refer to [23,29]. Specific studies in the context of Schr\u00f6dinger equations are given, e.g., in [6,9,12,34].\nAlternative approach. In this work, we propose an approach that provides a favourable alternative to standard operator splitting methods in situations, where the operator F2 and an iterated commutator of F2 and F1, given by\nG2(v) = F \u2032\u2032 1 (v)F2(v)F2(v) + F \u2032 1(v)F \u2032 2(v)F2(v) + F \u2032 2(v)F \u2032 2(v)F1(v)\n\u2212 F \u2032\u20322 (v)F1(v)F2(v)\u2212 2F \u20322(v)F \u20321(v)F2(v) , (4)\nhave a similar structure. As relevant nonlinear partial differential equations with this property, we identify Schr\u00f6dinger and parabolic equations such as (2) and (3) that comprise the Laplacian, a potential acting as multiplication operator, and a cubic nonlinearity. For specifications concerning (4), we in particular refer to Sections 3 and 4.\nFormal means and objectives. Our educated guess that leads us to modified operator splitting methods relies on a formal generalisation of the linear case, which we briefly sketch next and describe in further detail in the subsequent sections.\n(i) Linear ordinary differential equations. The starting point is a linear ordinary differential equation defined by non-commuting square matrices\nd dt u(t) = Au(t) +B u(t) , t \u2208 [0, T ] .\nThe corresponding solution value at the final time is given by the matrix exponential, that is\nu(T ) = eT (A+B) u(0) = ( e\u03c4(A+B) )N u(0) , \u03c4 = T\nN , N \u2208 N .\nStandard splitting methods are built on compositions of the factors ea \u03c4A and eb \u03c4B with suitably chosen coefficients a and b. Beyond that, components of the form\neb \u03c4B+c \u03c4 3 [B,[B,A]] , [ B, [B,A] ] = B2A\u2212 2BAB + AB2 , (5)\nwith certain coefficients b and c are incorporated in modified potential operator splitting methods. The underlying idea of this approach is to gain freedom in the adjustment of the method coefficients and, amongst others, to overcome an order barrier valid for standard splitting methods.\n(ii) Linear partial differential equations. Advantages of this approach become apparent in the context of the imaginary time integration of linear Schr\u00f6dinger equations comprising the Laplacian and a potential. There, the operator arising in (5) reduces to a multiplication operator, which is defined by the potential and its gradient. (iii) Nonlinear partial differential equations. The guide line for the extension to nonlinear evolution equations (1) is provided by the calculus of Lie derivatives, see [35] for a detailed exposition. In order to make our contribution accessible to a broader readership, we do not presume the knowledge of this formal calculus and explain the required elementary means on occasion. Basically, the operators F1 and F2 take the roles of the matrices A and B, and (5) is replaced by the solution to\nd dt u(t) = b F2\n( u(t) ) + c \u03c4 2G2 ( u(t) ) , t \u2208 [0, \u03c4 ] ,\nsee also (4). This formalism is expedient with regard to the design of novel higher-order time integration methods for nonlinear partial differential equations. Though, it is then equally of importance to concretise formal considerations and to confirm that the resulting modified operator splitting methods are indeed practicable and beneficial.\n(iv) Main objectives. In this work, for the sake of concreteness, we focus on the extension of a famous fourth-order modified potential operator splitting method by Chin [14] to the Gross\u2013Pitaevskii equation (2) and the parabolic equation (3). So far, this scheme has been introduced and studied merely for the linear case.\nOutline. The present manuscript is organised as follows. In Section 2, we review fundamental concepts for operator splitting methods. In Sections 3 and 4, we state the formal generalisation of a fourth-order modified potential operator splitting method to the nonlinear case and substantiate it for the\nGross\u2013Pitaevskii equation (2) and its parabolic analogue (3). A fundamental invariance principle that includes a known result for standard splitting methods as a special case is deduced in Section 5. In Section 6, we detail the implementation of the novel modified operator splitting method based on a Fourier spectral space discretisation and provide numerical comparisons with standard splitting methods. Additional information on a publicly accessible Matlab code is found in Appendix A. The observed order reduction of Yoshida\u2019s fourth-order complex splitting method (8d) is analysed in Appendix B."
        },
        {
            "heading": "2 Survey of standard and modified potential splitting methods",
            "text": "Linear case. As an illustrative example, we state the simplest representative of standard splitting methods, the first-order Lie\u2013Trotter splitting method, for a system of linear differential equations d dt u(t) = Au(t) +B u(t) ,\nu(0) = u0 , t \u2208 [0, T ] , (6)\ndefined by non-commuting time-independent complex matrices A,B \u2208 CM\u00d7M . For a positive integer number N \u2208 N with associated time increment and equidistant grid points\n\u03c4 = T N , tn = n \u03c4 , n \u2208 {0, 1, . . . , N} ,\nnumerical approximations to the exact solution values are obtained by the recurrence\nun+1 = e\u03c4B e\u03c4A un \u2248 u(tn+1) , n \u2208 {0, 1, . . . , N \u2212 1} .\nHigher-order splitting methods for (6) involve the action of several matrix exponentials on the current approximation and can be cast into the format\nun+1 = ebs\u03c4B eas\u03c4A \u00b7 \u00b7 \u00b7 eb1\u03c4B ea1\u03c4A un \u2248 u(tn+1) , n \u2208 {0, 1, . . . , N \u2212 1} ,\nwith real or complex coefficients (aj, bj)sj=1, respectively.\nNonlinear case. Their generalisation to nonlinear evolution equations (1) is based on the composition of the solutions to the subproblems defined by F1 and F2. We henceforth employ the compact notation\nd dt u1(t) = \u03b1F1 ( u1(t) ) , E\u03c4,\u03b1F1 ( u1(tn) ) = u1(tn + \u03c4) , d dt u2(t) = \u03b2F2 ( u2(t) ) , E\u03c4,\u03b2F2 ( u2(tn) ) = u2(tn + \u03c4) ,\n\u03b1, \u03b2 \u2208 C , t \u2208 [tn, tn + \u03c4 ] ,\n(7a)\nso that a higher-order splitting method applied to (1) reads as\nun+1 = ( E\u03c4,bsF2 \u25e6 E\u03c4,asF1 \u25e6 \u00b7 \u00b7 \u00b7 \u25e6 E\u03c4,b1F2 \u25e6 E\u03c4,a1F1 ) (un) \u2248 u(tn+1) ,\nn \u2208 {0, 1, . . . , N \u2212 1} . (7b)\nSchemes. In view of numerical comparisons, we introduce the coefficients of the first-order Lie\u2013Trotter splitting method\ns = 1 , a1 = 1 , b1 = 1 , (8a)\nand the second-order Strang splitting method\ns = 2 , a1 = 0 , a2 = 1 , b1 = 1 2 = b2 . (8b)\nThe well-known fourth-order splitting method by Yoshida [36] involves four stages\ns = 4 , a1 = 0 , a2 = 1\u2212 2 b2 = a4 , a3 = 4 b2 \u2212 1 , b1 = 1 2 \u2212 b2 = b4 , b2 = 16 ( 1\u2212 3 \u221a 2\u2212 1 2 3 \u221a 4 ) = b3 .\n(8c)\nReconsidering its construction based on a triple jump composition of the Strang splitting method, a corresponding fourth-order splitting method with complex coefficients is obtained\ns = 4 , a1 = 0 , a2 = 1\u2212 2 b2 = a4 , a3 = 4 b2 \u2212 1 , b1 = 1 2 \u2212 b2 = b4 , b2 = 16 ( 1 + 1 2 3 \u221a 2 + 1 4 3 \u221a 4 ) + i \u221a 3 12 ( 1 2 3 \u221a 4\u2212 3 \u221a 2 ) = b3 , (8d)\nsee also [8,11,18].\nStability issues. In connection with the time integration of dissipative systems and parabolic equations as well as the imaginary time propagation of Schr\u00f6dinger equations, operator splitting methods are subject to additional stability constraints. In order to explain this matter of fact, we recall that the application of a splitting method with real coefficients (aj, bj)sj=1 to the Gross\u2013 Pitaevskii equation (2) in imaginary time and to the parabolic equation (3) involves the subproblems\n\u2202tU(x, t) = aj \u2206U(x, t) , (x, t) \u2208 \u2126\u00d7 [tn, tn + \u03c4 ] , j \u2208 {1, . . . , s} .\nEvidently, requiring well-posedness of these subproblems or stability of the resulting splitting method, respectively, implies\naj \u2265 0 , j \u2208 {1, . . . , s} .\nThis positivity condition, however, excludes higher-order schemes, since any splitting method that exceeds a second-order barrier necessarily comprises\nnegative coefficients, see for example [7,30,31]. Specifically, this holds true for the fourth-order splitting method by Yoshida\na3 \u2248 \u2212 1.7 < 0 ,\nsee (8c). A feasible remedy to this issue is the design of splitting methods with complex coefficients (aj, bj)sj=1 such that\n\u211c(aj) \u2265 0 , j \u2208 {1, . . . , s} ,\nsee, e.g., [13,19]. The fourth-order scheme (8d) indeed fulfills these constraints\na1 = 0 , \u211c(a2) = \u211c(a4) \u2248 0.3 > 0 , \u211c(a3) \u2248 0.4 > 0 .\nFor further considerations in the context of the imaginary time propagation of the linear Schr\u00f6dinger equation by complex splitting methods, we refer to [4].\nModified potential splitting methods. Reviving former work by Ruth and Suzuki, see for instance [28,31,32], a favourable alternative to standard operator splitting methods was proposed by Chin. In a seminal work [14], he developed a famous fourth-order scheme of splitting type that comprises positive coefficients and hence overcomes the second-order barrier for standard splitting methods with real coefficients. Expressed in his own words, the basic idea is to incorporate an additional higher order composite operator so that the implementation of one algorithm requires only one evaluation of the force and one evaluation of the force and its gradient. For linear evolution equations (6), the resulting scheme takes the form\nun+1 = e 1 6 \u03c4B e 1 2 \u03c4A e 2 3 \u03c4B\u2212 1 72 \u03c43[B,[B,A]] e 1 2 \u03c4A e 1 6 \u03c4B un \u2248 u(tn+1) ,\nn \u2208 {0, 1, . . . , N \u2212 1} . (9)\nHere, the iterated commutator of complex matrices A,B \u2208 CM\u00d7M is given by\n[B,A] = BA\u2212 AB , [ B, [B,A] ] = B2A\u2212 2BAB + AB2 , (10a)\nsee also (5). More generally, for linear differential and multiplication operators\n(Av)(x) = c\u2206 v(x) ,\n(B v)(x) = c\u0304 V (x) v(x) , x \u2208 \u2126 , c \u2208 C , (10b)\nretained from (2) and (3) for the special choice \u03d1 = 0, a straightforward calculation yields a linear multiplication operator that depends on the Euclidean\nnorm of the gradient of the potential\n[ B, [B,A] ] v(x)\n= c\u0304 |c|2 (( V (x) )2 \u2206 v(x)\u2212 2V (x)\u2206 ( V (x) v(x) ) +\u2206 (( V (x) )2 v(x) )) = 2 c\u0304 |c|2 ( \u2207V (x) )T \u2207V (x) v(x) , x \u2208 \u2126 .\n(10c)\nThis explains the common notion force-gradient operator splitting method or modified potential operator splitting method for the scheme (9) and related splitting methods in the context of classical or quantum many-body problems and beyond. More recent contributions that exploit (9) for linear ordinary and partial differential equations are, e.g., [2,15,26,27].\nGeneralisations to specific classes of nonlinear evolution equations. We point out that the operator B defined in (10b) and the iterated commutator (10c) are of the same nature. This structural similarity explains the efficiency of Chin\u2019s scheme (9) for partial differential equations comprising the Laplacian and a potential acting as multiplication operator. Anticipating the detailed expositions in Sections 3 and 4, we stress that the generalisations to the time-dependent Gross\u2013Pitaevskii equation (2) and its parabolic analogue (3) maintain this feature, even though the iterated commutators are more involved."
        },
        {
            "heading": "3 Modified operator splitting method",
            "text": "Formal generalisation. Our educated guess to formally generalise the modified potential operator splitting method (9) to the significantly more involved case of a nonlinear evolution equation (1) is\nun+1 = ( E\u03c4, 1\n6 F2 \u25e6 E\u03c4, 1 2 F1 \u25e6 E\u03c4, 2 3 F2\u2212 172 \u03c42G2 \u25e6 E\u03c4, 1 2 F1 \u25e6 E\u03c4, 1 6 F2\n) un \u2248 u(tn+1) ,\nn \u2208 {0, 1, . . . , N \u2212 1} . (11a)\nThat is, we replace the matrices A and B by the nonlinear operators F1 and F2 as well as the iterated commutator of matrices by the following operator\nG1(v) = F \u2032 2(v)F1(v)\u2212 F \u20321(v)F2(v) , G2(v) = F \u2032 2(v)G1(v)\u2212G\u20321(v)F2(v) ,\n(11b)\nsee (4) and (5). We determine the G\u00e2teaux derivatives generalising directional derivatives through\nH \u2032(v)w = lim \u03b5\u21920 1 \u03b5\n( H(v + \u03b5w)\u2212H(v) ) , (12)\nsee also [20], and presume well-definedness of the arising operators on suitably chosen domains. According to (7), the decisive operator is associated with a nonlinear evolution equation that comprises the time increment as parameter\nd dt u\u03032(t) = \u03b21F2 ( u\u03032(t) ) + \u03b22 \u03c4 2G2 ( u\u03032(t) ) , t \u2208 [tn, tn + \u03c4 ] ,\nE\u03c4, \u03b21F2+\u03b22\u03c42G2 ( u\u03032(tn) ) = u\u03032(tn + \u03c4) , \u03b21, \u03b22 \u2208 R .\n(13)\nSpecification and implementation. In the subsequent sections, we complete the remaining tasks. We first specify the iterated commutator (11b) for the time-dependent Gross\u2013Pitaevskii equation (2) and contrast it to the result obtained for the parabolic counterpart (3). Then, we deduce an invariance principle that has a substantial impact on the efficiency of the modified operator splitting method (11) when applied to the Gross\u2013Pitaevskii equation (2). Implementation issues as well as strategies to reduce the computational cost for parabolic equations are finally discussed in Section 6."
        },
        {
            "heading": "4 Iterated commutators",
            "text": "Generally speaking, the appropriate framework for the extension of iterated commutators for matrices or linear operators, see (10a), to nonlinear operators is provided by the formal calculus of Lie-derivatives. In the present work, we concretise and verify the heuristic characterisation (11) for relevant applications, the time-dependent Gross\u2013Pitaevskii equation (2) and the related parabolic equation (3). In the context of Schr\u00f6dinger equations, the arising functions v, w : \u2126 \u2192 C take complex values, whereas it suffices to consider real-valued functions v, w : \u2126 \u2192 R for parabolic problems. In both cases, suitable regularity requirements apply. For notational simplicity, we omit the dependence on the spatial variable.\nDerivatives. The G\u00e2teaux derivatives of the linear differential and nonlinear multiplication operators defined in (2) and (3) are given by\nF1(v) = c\u2206v ,\nF \u20321(v)w = c\u2206w , F2(v) = c\u0304 ( V + \u03d1 |v|2 ) v = c\u0304 ( V v + \u03d1 v2 v\u0304 ) ,\nF \u20322(v)w = c\u0304 ( V w + 2\u03d1 v\u0304 v w + \u03d1 v2w ) ,\nsee also (12).\nFirst commutators. On the one hand, by performing differentiation twice, we obtain\nF \u20321(v)F2(v) = |c|2\u2206 ( V v + \u03d1 v2 v\u0304 ) = |c|2 ( \u2206V v + 2 (\u2207V )T \u2207v + V\u2206v\n) + |c|2 \u03d1 ( 2\u2206v v\u0304 v +\u2206v\u0304 v2 + 2 (\u2207v)T \u2207v v\u0304 + 4 (\u2207v)T \u2207v\u0304 v ) .\nOn the other hand, a simple replacement yields\nF \u20322(v)F1(v) = |c|2 ( V\u2206v + 2\u03d1 v\u0304 v\u2206v ) + c\u03042 \u03d1 v2\u2206v\u0304 .\nAs a consequence, the difference is given by\nG1(v) = F \u2032 2(v)F1(v)\u2212 F \u20321(v)F2(v) = \u2212 |c|2 ( \u2206V v + 2 (\u2207V )T \u2207v ) + ( c\u03042 \u2212 |c|2 ) \u03d1\u2206v\u0304 v2 \u2212 2 |c|2 \u03d1 ( (\u2207v)T \u2207v v\u0304 + 2 (\u2207v)T \u2207v\u0304 v ) .\nFor the parabolic case (3) with c = 1 this implies\nG1(v) = \u2212\u2206V v \u2212 2 (\u2207V )T \u2207v \u2212 6\u03d1 (\u2207v)T \u2207v v ,\nand the analogous result for the Schr\u00f6dinger case (2) with c = i is\nG1(v) = \u2212\u2206V v \u2212 2 (\u2207V )T \u2207v \u2212 2\u03d1 ( \u2206v\u0304 v2 + (\u2207v)T \u2207v v\u0304 + 2 (\u2207v)T \u2207v\u0304 v ) .\nIterated commutators. The iterated commutator associated with the parabolic equation (3) results from straighforward but lengthy calculations\nG2(v) = 2 ( (\u2207V )T (\u2207V ) + \u03d1 G\u03032(v) ) v ,\nG\u03032(v) = \u2212\u2206V v2 + 6 (\u2207V )T (\u2207v) v + 6 ( V + 2\u03d1 v2 ) (\u2207v)T (\u2207v) ,\n(14)\nand for the Gross\u2013Pitaevskii equation (2), we instead arrive at\nG2(v) = \u2212 2 i ( (\u2207V )T (\u2207V )\u2212 2\u03d1 ( G\u030321(v) + \u03d1 G\u030322(v) )) v ,\nG\u030321(v) = |v|2\u2206V , G\u030322(v) = |v|2 ( 2\u211c(v\u0304\u2206v) + 3 (\u2207v\u0304)T (\u2207v) ) + \u211c ( v\u03042 (\u2207v)T (\u2207v) ) .\n(15)\nFor the special case of linear multiplication operators, i.e. \u03d1 = 0, we indeed recover (10c). It is also noteworthy that the operator in (15) involves \u2206v and hence implies stronger regularity requirements on v compared to the operator in (14), which only comprises the gradient \u2207v."
        },
        {
            "heading": "5 Invariance principle",
            "text": "Invariance principle. For the purpose of illustration, we introduce the nonlinear Schr\u00f6dinger equationi \u2202t\u03a8(x, t) = \u2212\u2206\u03a8(x, t) + |\u03a8(x, t)|2\u03a8(x, t) ,\u03a8(x, 0) = \u03a80(x) , (x, t) \u2208 \u2126\u00d7 [0, T ] , retained from (2) for vanishing potential V = 0 and normalised constant \u03d1 = 1. Any standard operator splitting method (7) relies on the time integration of the subproblem involving the Laplaciani \u2202t\u03a81(x, t) = \u2212\u03b1\u2206\u03a81(x, t) , \u03b1 \u2208 R ,\u03a81(x, tn) given , (x, t) \u2208 \u2126\u00d7 [tn, tn + \u03c4 ] , which we perform by means of a Fourier spectral space discretisation, see Section 6. Moreover, we make use of the fact that the subproblem comprising the cubic nonlinearityi \u2202t\u03a82(x, t) = \u03b21 |\u03a82(x, t)|2\u03a82(x, t) , \u03b21 \u2208 R ,\u03a82(x, tn) given , (x, t) \u2208 \u2126\u00d7 [tn, tn + \u03c4 ] , (16a) satisfies the fundamental invariance principle\n|\u03a82(x, t)|2 = |\u03a82(x, tn)|2 , (x, t) \u2208 \u2126\u00d7 [tn, tn + \u03c4 ] .\nThis identity follows by means of differentiation with respect to time and substitution of the time derivative by the nonlinearity\n\u2202t |\u03a82(x, t)|2 = 2\u211c ( \u03a82(x, t) \u2202t\u03a82(x, t) ) = \u2212 2 \u03b21\u211c ( i |\u03a82(x, t)|4 ) = 0 ,\n(x, t) \u2208 \u2126\u00d7 [tn, tn + \u03c4 ] .\nIt implies that the exact solution to the nonlinear subproblem satisfies the reduced problemi \u2202t\u03a82(x, t) = \u03b21 |\u03a82(x, tn)|2\u03a82(x, t) , \u03b21 \u2208 R ,\u03a82(x, tn) given , (x, t) \u2208 \u2126\u00d7 [tn, tn + \u03c4 ] , (16b) and hence can be determined by pointwise multiplication\n\u03a82(x, t) = e\u2212 i\u03b21 |\u03a82(x,tn)| 2 \u03a82(x, tn) , (x, t) \u2208 \u2126\u00d7 [tn, tn + \u03c4 ] . (16c)\nFor the numerical realisation, equidistant grid points are chosen accordingly to the Fourier spectral space discretisation, see also Section 6.\nGeneralisation. In this section, we establish a substantial extension of the above stated result (16) that has important implications concerning the efficient implementation of the modified operator splitting method (11) for the time-dependent Gross\u2013Pitaevskii equation (2), see also (13) and (15). Furthermore, the obtained invariance principle for the evolution operator\nE\u03c4, \u03b21F2+\u03b22\u03c42G2 , \u03c4, \u03b21, \u03b22 \u2208 R ,\nis connected with the significance of the modified operator splitting method as a geometric integrator, see [18,21] and references given therein.\nNotation. With regard to a compact formulation as abstract evolution equation, we again omit the dependence of the potential and a regular complexvalued function v : \u2126 \u2192 C on the spatial variable. Besides, for accomplishing relations of the form\nF2(v) = c\u0304 f1(v) v , G2(v) = c\u0304 f2(v) v ,\nit is convenient to introduce the abbreviations\nf(v) = \u03b21 f1(v) + \u03b22 \u03c4 2f2(v) ,\nf1(v) = V + \u03d1 g1(v) , f2(v) = 2 (\u2207V )T (\u2207V )\u2212 4\u03d1 g6(v) , g1(v) = |v|2 , g2(v) = \u211c(v\u0304\u2206v) ,\ng3(v) = (\u2207v\u0304)T (\u2207v) , g4(v) = \u211c ( v\u03042 (\u2207v)T (\u2207v) ) ,\ng5(v) = \u03d1 ( 2 g2(v) + 3 g3(v) ) , g6(v) = g1(v) ( \u2206V + g5(v) ) + \u03d1 g4(v) .\n(17)\nTheorem (Invariance principle). The solution to the subproblem\n d dt \u03c8(t) = \u2212 i f ( \u03c8(t) ) \u03c8(t) ,\n\u03c8(0) = \u03c80 , t \u2208 [0, \u03c4 ] ,\nwith defining function introduced in (17) satisfies the invariance principle\nf ( \u03c8(t) ) = f(\u03c80) , t \u2208 [0, \u03c4 ] .\nProof. In order to demonstrate that the invariance principle holds, we deter-\nmine the G\u00e2teaux derivatives of the defining functions\nf \u2032(v)w = \u03b21 f \u2032 1(v)w + \u03b22 \u03c4 2f \u20322(v)w ,\nf \u20321(v)w = \u03d1 g \u2032 1(v)w , f \u2032 2(v)w = \u2212 4\u03d1 g\u20326(v)w ,\ng\u20321(v)w = 2\u211c(v\u0304 w) , g\u20322(v)w = \u211c(\u2206v\u0304 w) + \u211c(v\u0304\u2206w) , g\u20323(v)w = 2\u211c ( (\u2207v\u0304)T (\u2207w) ) ,\ng\u20324(v)w = 2\u211c ( v\u0304 w (\u2207v)T (\u2207v) ) + 2\u211c ( v\u03042 (\u2207v)T (\u2207w) ) ,\ng\u20325(v)w = 2\u03d1 g \u2032 2(v)w + 3\u03d1 g \u2032 3(v)w , g\u20326(v)w = ( \u2206V + g5(v) ) g\u20321(v)w + g1(v) g \u2032 5(v)w + \u03d1 g \u2032 4(v)w ,\nwhere suitable regularity requirements apply to v, w : \u2126 \u2192 C. Observing that the potential V and the basic components g1, g2, g3, g4 define real-valued functions, we have\n( gj(v) ) (x) \u2208 R , j \u2208 {1, . . . , 6} ,(\nfk(v) ) (x) \u2208 R , k \u2208 {1, 2} , ( f(v) ) (x) \u2208 R , x \u2208 \u2126 .\nEvidently, this implies that the following composition vanishes\ng\u20321(v) ( i f(v) v ) = 2\u211c ( i |v|2 f(v) ) = 0 .\nCertain contributions originating from the iterated commutator, however, require a closer examination, namely\ng\u20322(v) ( i f(v) v ) = \u211c ( i f(v)\u211c ( v\u0304\u2206v )) + \u211c ( i |v|2\u2206f(v) ) + 2\u211c ( i v\u0304 ( \u2207f(v) )T \u2207v\n) = 2\u211c ( i v\u0304 ( \u2207f(v) )T \u2207v ) ,\ng\u20323(v) ( i f(v) v ) = 2\u211c ( i v ( \u2207f(v) )T \u2207v\u0304 ) + 2\u211c ( i f(v) (\u2207v\u0304)T \u2207v\n) = 2\u211c ( i v ( \u2207f(v) )T \u2207v\u0304 ) ,\ng\u20324(v) ( i f(v) v ) = \u2212 2\u211c ( i f(v) v\u03042 (\u2207v)T \u2207v ) + 2\u211c ( i |v|2 v\u0304 ( \u2207f(v) )T \u2207v\n) + 2\u211c ( i f(v) v\u03042 (\u2207v)T \u2207v\n) = 2\u211c ( i |v|2 v\u0304 ( \u2207f(v) )T \u2207v ) .\nOn the basis of these identities, we conclude( g1(v) ( 2 g\u20322(v) + 3 g \u2032 3(v) ) + g\u20324(v) )) ( i f(v) v\n) = 12\u211c ( i |v|2 ( \u2207f(v) )T \u211c ( v\u0304\u2207v )) = 0 .\nThis proves that any composition of the special form\nf \u2032(v) ( i f(v) v ) = \u03d1 ( \u03b21 \u2212 4 \u03b22 \u03c4 2 ( \u2206V + g5(v) )) g\u20321(v) ( i f(v) v\n) \u2212 4\u03d12\u03b22 \u03c4 2 ( g1(v) ( 2 g\u20322(v) + 3 g \u2032 3(v) ) + g\u20324(v) ) ( i f(v) v\n) = 0\nvanishes. As a consequence, the time-derivative of the decisive function is equal to zero\nd dt f\n( \u03c8(t) ) = f \u2032 ( \u03c8(t) ) d dt \u03c8(t) = \u2212 f \u2032 ( \u03c8(t) ) ( i f ( \u03c8(t) ) \u03c8(t) ) = 0 , t \u2208 [0, \u03c4 ] ,\nand hence, the desired identity follows\nf ( \u03c8(t) ) = f(\u03c80) , t \u2208 [0, \u03c4 ] .\nSummary. In view of Section 6, we summarise our considerations for the modified operator splitting method (11) applied to the time-dependent Gross\u2013 Pitaevskii equation (2). On the one hand, the realisation of\n\u03c8n+1 = ( E\u03c4, 1\n6 F2 \u25e6 E\u03c4, 1 2 F1 \u25e6 E\u03c4, 2 3 F2\u2212 172 \u03c42G2 \u25e6 E\u03c4, 1 2 F1 \u25e6 E\u03c4, 1 6 F2\n) \u03c8n ,\nn \u2208 {0, 1, . . . , N \u2212 1} ,\nrelies on the numerical integration of the linear Schr\u00f6dinger equation\nd dt \u03c8(t) = i\u03b1\u2206\u03c8(t) , t \u2208 [tn, tn + \u03c4 ] , E\u03c4,\u03b1F1 ( \u03c8(tn) ) = \u03c8(tn + \u03c4) ,\nfor \u03b1 \u2208 R. On the other hand, it reduces to the pointwise evaluation of the solution representation\nE\u03c4, \u03b21F2+\u03b22\u03c42G2(\u03c80) = e\u2212 i \u03c4(\u03b21f1(\u03c80)+\u03b22\u03c4 2f2(\u03c80)) \u03c80 , \u03c4 \u2208 R , (18)\nfor appropriate choices of \u03b21, \u03b22 \u2208 R, see (17) for the definitions of f1 and f2. We recall that the known identity (16) for the particular case \u03b22 = 0 is established by a simplified argument."
        },
        {
            "heading": "6 Numerical results",
            "text": "In the following, we illustrate the stability and global error behaviour of the novel modified operator splitting method (11) for the time-dependent Gross\u2013 Pitaevskii equation (2) and its parabolic analogue (3). The numerical tests, performed in one, two, and three space dimensions, in particular confirm the theoretical considerations of Sections 3 to 5. For the purpose of comparison, we in addition include the corresponding results for widely-used standard splitting methods. Further information on a publicly accessible Matlab code to reproduce Figures 1\u20134 is found in Appendix A.\nImplementation. The practical realisation of standard operator splitting methods such as (8) and of the modified operator splitting method (11), respectively, requires the time integration of the subproblems involving the Laplacian and the nonlinear multiplication operator. In our implementation, we make use of fast Fourier techniques, which are based on the following considerations.\n(i) Space grid. With regard to the employed Fourier spectral space discretisation, we replace the underlying unbounded domain by a Cartesian product of sufficiently large intervals\na = 10 , x \u2208 [\u2212 a, a]d \u2282 \u2126 ,\nand choose the total number of equidistant spatial grid points according to the dimension\nd = 1 : M = 512 , d = 2 : M = 1282 , d = 3 : M = 643 .\n(ii) Derivatives. The iterated commutator arising in the modified operator splitting method (11) for (2) and (3) involves the gradient \u2207V and the Laplacian \u2206V of the space-dependent potential, which we may assume to be known analytically. Otherwise, we employ the approach described subsequently. The numerical computation of the spatial derivatives \u2207v and \u2206v, where v represents the current value of the time-discrete solution, is traced back to a fast Fourier transform, pointwise multiplications, and an inverse fast Fourier transform. Denoting by (Fm)m\u2208Zd the Fourier functions with periodicity domain [\u2212 a, a]d, by (\u00b5m)m\u2208Zd the purely imaginary eigenvalues associated with the first spatial derivatives, and by (\u03bbm)m\u2208Zd the corresponding real eigenvalues of the Laplace operator\nFm(x) = (2 a)\u2212 d 2 e i\u03c0m1 ( x1 a +1) \u00b7 \u00b7 \u00b7 e i\u03c0md ( xd a +1) ,\n\u2207Fm = \u00b5mFm , \u00b5m = i\u03c0ma \u2208 C d\u00d71 ,\n\u2206Fm = \u03bbmFm , \u03bbm = \u2212 \u03c0 2|m|2 a2\n\u2208 R , m = (m1, . . . ,md) \u2208 Zd , x = (x1, . . . , xd) \u2208 [\u2212 a, a]d ,\nthe following formal representations hold\nv = \u2211 m\u2208Zd vmFm , vm = \u222b [\u2212 a,a]d v(x)F\u2212m(x) dx , m \u2208 Zd ,\n\u2207v = \u2211 m\u2208Zd \u00b5m vmFm , \u2206v = \u2211 m\u2208Zd \u03bbm vmFm .\nTheir realisation relies on a suitable truncation of the infinite index set M \u2282 Zd so that |M| = M and quadrature approximations by the trapezoidal rule.\n(iii) Linear subproblem. Formally, the solution to the linear subproblem is given by a Fourier series\nd dt u1(t) = \u03b1F1\n( u(t) ) = c \u03b1\u2206u1(t) , t \u2208 [tn, tn + \u03c4 ] , \u03b1 \u2208 R ,\nE\u03c4,\u03b1F1 ( u(tn) ) = E\u03c4,\u03b1F1 ( \u2211 m\u2208Zd u1,m(tn)Fm ) = \u2211 m\u2208Zd e c \u03b1 \u03c4\u03bbm u1,m(tn)Fm ,\nsee also (2), (3), and (7). Again, the application of fast Fourier techniques permits the efficient computation of approximations to the spectral coefficients and the evaluation of finite sums on the equidistant spatial grid points covering the underlying domain\nu\u03031,m,n \u2248 u1,m(tn) , m \u2208 M ,\u2211 m\u2208M e c \u03b1 \u03c4\u03bbm u\u03031,m,nFm(x) , x \u2208 [\u2212 a, a]d .\n(iv) Nonlinear subproblem (Schr\u00f6dinger equation). In the context of the Gross\u2013Pitaevskii equation (2), we make use of the fact that the solution to the nonlinear subproblem (13) satisfies the invariance principle deduced in Section 5. Consequently, it simply remains to evaluate the representation (18) on the equidistant grid.\n(v) Nonlinear subproblem (Parabolic equation). In the case of the parabolic equation (3), we additionally apply an explicit Runge\u2013Kutta method of order four. Due to the stiffness of the problem, the time stepsize has to be adjusted to the spatial grid width to ensure stability. Alternative approaches with improved stability properties and reduced computational costs are detailed below.\nNumerical results. In our numerical tests, we perform the time integration of the Gross\u2013Pitaevskii equation (2) and the parabolic equation (3), comparing the nonlinear case with \u03d1 = 1 to the simplified linear case with \u03d1 = 0. We prescribe the Gaussian-shaped initial state\nu0(x) = e\u2212 1 2 (x21+\u00b7\u00b7\u00b7+x 2 d) , x = (x1, . . . , xd) \u2208 Rd ,\nas well as the two polynomial potentials\nV (x) = C0Cq d\u2211 j=1 xqj ,\nC2 = 1 , C4 = 1 24 , q \u2208 {2, 4} , x = (x1, . . . , xd) \u2208 Rd ,\nfor which the required first- and second-order derivatives are known analytically. For the special case of a quadratic potential with prefactor C0 \u2208 {1,\u2212 1} chosen accordingly to the type of the equation and \u03d1 = 0, the knowledge of the exact solution\nu(x, t) = ed c\u0304 t u0(x) , (x, t) \u2208 Rd \u00d7 [0, T ] ,\npermits the validation of the Fourier spectral space discretisation and the time-splitting approach. In the general case, we instead determine a numerical reference solution based on a refined time stepsize. The global errors of the modified operator splitting method (11) at final time T = 1, measured in a discrete L2-norm, are compared to those obtained by the standard Lie\u2013 Trotter, Strang, and Yoshida splitting methods of non-stiff orders one, two, and four, see also (8). The obtained results, displayed in Figures 1\u20134, confirm the favourable behaviour of the modified operator splitting method.\nEnergy conservation. In order to complement our numerical comparisons regarding the stability and global error behaviour of standard and modified operator splitting methods, we perform the time integration of the onedimensional Gross\u2013Pitaevskii equation (2) on the interval [0, T ]. We determine approximations to the values of the energy at equidistant time grid points\nE(tn) = \u222b \u2126 ( \u2212\u2206\u03a8(x, tn) + V (x)\u03a8(x, tn) + \u03d1 |\u03a8(x, tn)|2\u03a8(x, tn) ) \u00d7\u03a8(x, tn) dx , n \u2208 {0, 1, . . . , N} ,\n(19a)\nand their deviations with respect to the minimal value\nE(tn)\u2212min { E(t\u2113) : \u2113 \u2208 {0, 1, . . . , N} } , n \u2208 {0, 1, . . . , N} . (19b)\nThe obtained results confirm the favourable geometric properties of the modified operator splitting method (11), see Figure 6.\nComputational cost. In general, an expedient measure for the computational cost of the modified operator splitting method (11) for the Gross\u2013 Pitaevskii equation (2) and the parabolic equation (3), respectively, is the number of fast Fourier transforms and their inverses. Evidently, the numerical solution of two linear subproblems per time step amounts to two fast Fourier transforms and two inverse fast Fourier transforms. Besides, the time integration of the nonlinear subproblem requires the computation of space derivatives via Fourier transforms.\n(i) For nonlinear Schr\u00f6dinger equations such as (2), the validity of the invariance property permits to significantly reduce the cost related to the evaluation of E\u03c4, 2\n3 F2\u2212 172 \u03c42G2 . Due to the fact that the spectral coefficients of the current numerical solution v are available, the computation of gradient \u2207v and Laplacian \u2206v results in d+1 inverse fast Fourier transforms.\n(ii) For the parabolic equation (3), a favourable approach is based on the following considerations. The presence of the additional factor \u03c4 2 in connection with the double commutator permits to use an approximation by means of the the second-oder Strang splitting method, that is\nE\u03c4, 2 3 F2\u2212 172 \u03c42G2 \u2248 E 1 2 \u03c4, 2 3 F2 \u25e6 E\u03c4,\u2212 1 72 \u03c42G2 \u25e6 E 1 2 \u03c4, 2 3 F2 .\nFor linear ordinary differential equations of the form\nd dt u(t) = B u(t) + \u03c4 2C u(t) , t \u2208 [0, \u03c4 ] ,\ndefined by complex matrices B,C \u2208 CM\u00d7M , elementary calculations based on series expansions of matrix exponentials confirm that this approach leads to a fourth-order approximation\ne\u03c4(B+\u03c4 2C) = e 1 2 \u03c4B e\u03c4 3C e 1 2 \u03c4B +O ( \u03c4 5 ) .\nThe rigorous generalisation of the argument to (3) is part of a future convergence analysis. On the one hand, an explicit representation of the evolution operator associated with the nonlinear ordinary differential equation\nd dt u(x, t) =\n( V (x) + \u03d1 |u(x, t)|2 ) u(x, t) , x \u2208 \u2126 , t \u2208 [0, \u03c4 ] ,\nis known. More precisely, fixing x \u2208 \u2126, the distinction of cases yields\nu(x, t) =  u(x,0)\u221a e\u22122 t V (x)+\u03d1 (e\u22122 t V (x)\u22121)/V (x) (u(x,0))2 , V (x) \u0338= 0 ,\nu(x,0)\u221a 1\u22122 t \u03d1 (u(x,0))2\n, V (x) = 0 , t \u2208 [0, \u03c4 ] .\nOn the other hand, for the time integration of the nonlinear subproblem involving the double commutator, it suffices to apply the first-order explicit Euler method. Numerical tests confirm the enhanced stability, accuracy, and efficiency of the resulting approach, in particular, in case of a fourth-order polynomial potential, see Figure 5."
        },
        {
            "heading": "7 Conclusions",
            "text": "In the present work, we have introduced a general framework for the extension of Chin\u2019s fourth-order modified potential operator splitting method (9) to\nnonlinear evolution equations. To the best of our knowledge, this matter is novel and of major interest from theoretical and practical perspectives.\nMoreover, we have specified the resulting fourth-order modified operator splitting method (11) for the time-dependent Gross\u2013Pitaevskii equation (2) and its parabolic counterpart (3). It seems likely that our approach and the drawn conclusions also extend to Schr\u00f6dinger equations involving nonlinear and possibly nonlocal terms of the form g(|\u03a8(x, t)|)\u03a8(x, t) .\nDue to the fact that our numerical tests have confirmed the favourable performance of the proposed fourth-order scheme in comparison with standard real and complex splitting methods of order four, it is natural to extend our considerations in various respects.\nProceeding our recent work [10] for linear evolution equations of parabolic and Schr\u00f6dinger type, we find it promising to design high-order modified operator splitting methods for nonlinear evolution equations that are optimal with regard to a preselected criterium such as efficiency. In contrast to the linear case, we have to take into account the additional costs for the evaluation of second iterated commutators and that higher-order iterated commutators will not vanish, in general, see (10c) as well as (14) and (15). Nonetheless, based on the successful strategies for the efficient implementation of the fourth-order scheme (11), it suggests itself to address an in-depth analysis of similarly structured modified operator splitting methods.\nA desirable feature of the proposed fourth-order modified operator splitting method is the positivity of the coefficients. Concerning the design of high-order schemes, in light of contributions on the linear case, see for instance [3,15], this will necessitate further deliberations on the appropriate format. Evidently, positivity is intrinsically related to the issue of well-posedness and stability for parabolic problems. Besides, it affects aliasing effects on truncated space domains and the incorporation of artificial boundary conditions, which is of particular interest in the context of nonlinear Schr\u00f6dinger equations, see for example [1] and references given therein.\nFurthermore, we intend to carry out a rigorous convergence analysis of modified operator splitting methods applied to the time-dependent Gross\u2013 Pitaevskii equation and its parabolic analogue. We point out that the study for the linear case [22] together with the formal calculus of Lie-derivatives provides a guiding principle. However, the accomplishment for specific nonlinear evolution equations involving unbounded operators requires careful calculations and investigations, see also [33]."
        },
        {
            "heading": "Acknowledgements",
            "text": "The authors dedicate this work to Arieh Iserles due to his seminal contributions in the area of numerical analysis and geometric numerical integration. The authors are grateful to the two anonymous reviewers for their careful reading of the manuscript and valuable comments. This work has been supported by Ministerio de Ciencia e Innovaci\u00f3n (Spain) through projects PID2019-104927GB-C21 and PID2019-104927GBC22, MCIN/AEI/10.13039/501100011033, ERDF (A way of making Europe). Sergio Blanes and Fernando Casas acknowledge the support of the Conselleria d\u2019Innovaci\u00f3, Universitats, Ci\u00e8ncia i Societat Digital from the Generalitat Valenciana (Spain) through project CIAICO/2021/180."
        },
        {
            "heading": "A Matlab code",
            "text": "A Matlab code that illustrates the practical implementation of modified operator splitting methods as outlined in Section 6 and reproduces the numerical results displayed in Figures 1\u20134 is available at\ndoi.org/10.5281/zenodo.7945624.\nBy default, the space dimenson is set equal to one such that the overall computation time amounts to a few minutes. For dimensions two and three, respectively, the computational effort will increase accordingly to the complexity of the problem.\nStructure of the code. The underlying process carries out the time integration of the Gross\u2013Pitaevskii equation (2) and the related parabolic equation (3) by the standard splitting methods with coefficiens specified in (8) and the novel modified operator splitting methods (11) with iterated commutators given in (14) and (15), respectively. The space discretisation is based on the Fourier spectral method and realised by fast Fourier transforms and their inverses. In loops over the selected space dimensions and the different test cases (parabolic / Schr\u00f6dinger equation, polynomial potential of degree two / four, linear case \u03d1 = 0 / nonlinear case with \u03d1 = 1), the global errors are computed for certain sequences of time stepsizes. In order to make similarities apparent and contrast differences, several auxiliary functions are defined.\n\u2022 Core. Selection of time integration methods. Definition of problem data (initial and final time, initial state, potential and its derivatives). Choice of sequences of time stepsizes. Performance of time integration. Computation of global errors. \u2022 PrecomputationFourier. Computation of underlying space grid and eigenvalues associated with Laplacian. \u2022 FourierReal2Spectral, FourierSpectral2Real. Fast Fourier transform and its inverse. \u2022 PartA. Numerical solution of linear subproblems associated with Laplacian based on Fourier transforms. \u2022 BWithoutU, B, TimeStepRKM124B, PartB. Numerical solution of nonlinear subproblems in the context of standard operator splitting methods. \u2022 DoubleCommutator, BModifiedWithoutU, BModified, TimeStepRKM124BModified, PartBModified. Numerical solution of nonlinear subproblems in the context of modified operator splitting methods. \u2022 TimeIntegration. Time integration by standard and modified operator splitting methods \u2022 MyTestCases. Definition of decisive quantities characterising different test cases.\n\u2022 MyPlot. Visualisation of obtained results.\nSpecialisation and improvements. The main purpose of the elementary structured Matlab code is the systematic comparison of the procedures required for the novel schemes with those for standard operator splitting methods, on the one hand for Schr\u00f6dinger equations and on the other hand for parabolic equations. We point out that a significant improvement of the performance will be achieved by separating the different types of evolution equations as well as time integrators and reconciling auxiliary functions. Further enhancements in particular in connection with the more costly fast (inverse) Fourier transforms concern the distinction of real and complex arithmetics as well as the avoidance of redundancies, e.g., by reordering the eigenvalues associated with the Laplacian instead of the solution values and omitting additional scaling constants."
        },
        {
            "heading": "B Order reduction of complex splitting methods",
            "text": "In order to explain the observed order reduction for the complex splitting method (8d), it suffices to study a nonlinear ordinary differential equation of the form (1) with F1 = 0 and F2(u) = |u|2 u on a single subinterval of length (0, \u03c4). More precisely, we consider the nonlinear subproblems\n ddt u(t) = F (1) 2 ( u(t) ) = ( u(t) )3 ,\nu(0) = u0 \u2208 R , t \u2208 (0, \u03c4) ,\n d dt u(t) = F (2) 2 ( u(t) ) = |u(t)|2 u(t) ,\nu(0) = u0 \u2208 R , t \u2208 (0, \u03c4) ,\nwith coinciding real-valued solutions\nE \u03c4,F (1) 2 (u0) = u(\u03c4) = E\u03c4,F (2)2 (u0) .\nOn the one hand, using the Taylor series expansion\nu(\u03c4) = u(0) + \u03c4 u\u2032(0) + 1 2 \u03c4 2 u\u2032\u2032(0) + 1 6 \u03c4 3 u\u2032\u2032\u2032(0) + 1 24 \u03c4 4 u\u2032\u2032\u2032\u2032(0) +O\n( \u03c4 5 )\nin combination with the differential equation and derivatives thereof implies\nu(\u03c4) = ( 1 + \u03c4 u20 + 3 2 \u03c4 2 u40 + 5 2 \u03c4 3 u60 + 35 8 \u03c4 4 u80 ) u0 +O ( \u03c4 5 ) .\nAs a consequence, for any real number b \u2208 R, the relation b \u2208 R : u(b \u03c4) = ( 1+ b \u03c4 u20 + 3 2 b2 \u03c4 2 u40 + 5 2 b3 \u03c4 3 u60 + 35 8 b4 \u03c4 4 u80 ) u0 +O ( \u03c4 5 )\nis valid. For complex numbers, however, the more general expansion b, u0 \u2208 C : E\u03c4,bF (2)2 (u0) = ( 1 + b \u03c4 |u0|2 + ( b2 + 1 2 |b|2 ) \u03c4 2 |u0|4\n+ ( b3 + (7\n6 b+ 1 3 b) |b|2 ) \u03c4 3 |u0|6\n+ ( b4 + 1\n24 (46 b2 + 6 b 2 + 29 |b|2) |b|2 ) \u03c4 4 |u0|8 ) u0\n+O ( \u03c4 5 )\nis obtained by decomposing the solution and accordingly the defining function into real and imaginary parts. In order to reproduce the approximation that corresponds to the Yoshida splitting, we impose the basic symmetry and order conditions\nb4 = b1 , b3 = b2 , b1 + b2 + b3 + b4 = 1 ,\nand then perform the fourfold composition\nuSplitting(\u03c4) = ( E \u03c4,b1F (2) 2 \u25e6 E \u03c4,b2F (2) 2 \u25e6 E \u03c4,b2F (2) 2 \u25e6 E \u03c4,b1F (2) 2 ) (u0) .\nRequiring this expansion to coincide with the expansion of the exact solution\nuSplitting(\u03c4)\u2212 u(\u03c4) = C(u0)\u2111(b1) ( 1\u2212\u211c(b1) ) \u03c4 3 +O ( \u03c4 4 )\nleads to a condition that obviously contradicts the order conditions for splitting methods and explains the observation of local order three and global order two. Similar arguments apply to evolution equations of Schr\u00f6dinger type such as the Gross\u2013Pitaevskii equation. But, in this context, the invariance principle permits to avoid the application of a fourth-order Runge\u2013Kutta method to the arising nonlinear subproblem\nd dt u(t) = F (2) 2\n( u(t) ) = \u2212 i |u(t)|2 u(t) , t \u2208 (0, \u03c4) ."
        }
    ],
    "title": "Generalisation of splitting methods based on modified potentials to nonlinear evolution equations of parabolic and Schro\u0308dinger type",
    "year": 2023
}