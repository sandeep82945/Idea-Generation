{
    "abstractText": "The central technological appeal of quantum science resides in exploiting quantum effects, such as entanglement, for a variety of applications, including computing, communication and sensing. The overarching challenge in these fields is to address, control and protect systems of many qubits against decoherence. Against this backdrop, optical photons, naturally robust and easy to manipulate, represent ideal qubit carriers. However, the most successful technique so far for creating photonic entanglement is inherently probabilistic and, therefore, subject to severe scalability limitations. Here we report the implementation of a deterministic protocol for the creation of photonic entanglement with a single memory atom in a cavity. We interleave controlled single-photon emissions with tailored atomic qubit rotations to efficiently grow Greenberger\u2013Horne\u2013Zeilinger (GHZ) states of up to 14 photons and linear cluster states of up to 12 photons with a fidelity lower bounded by 76(6)% and 56(4)%, respectively. Thanks to a source-to-detection efficiency of 43.18(7)% per photon, we measure these large states about once every minute, which is orders of magnitude faster than in any previous experiment. In the future, this rate could be increased even further, the scheme could be extended to two atoms in a cavity or several sources could be quantum mechanically coupled, to generate higherdimensional cluster states. Overcoming the limitations encountered by probabilistic schemes for photonic entanglement generation, our results may offer a way towards scalable measurement-based quantum computation and communication.",
    "authors": [
        {
            "affiliations": [],
            "name": "Philip Thomas"
        },
        {
            "affiliations": [],
            "name": "Leonardo Ruscio"
        },
        {
            "affiliations": [],
            "name": "Olivier Morin"
        },
        {
            "affiliations": [],
            "name": "Gerhard Rempe"
        }
    ],
    "id": "SP:ed53603a85c7c6838617c7e391823ac7e3609806",
    "references": [
        {
            "authors": [
                "C.H. Bennett",
                "D.P. DiVincenzo"
            ],
            "title": "Quantum information and computation",
            "venue": "Nature 404,",
            "year": 2000
        },
        {
            "authors": [
                "J. Preskill"
            ],
            "title": "Quantum computing in the NISQ era and beyond",
            "venue": "Quantum 2,",
            "year": 2018
        },
        {
            "authors": [
                "Zhong",
                "H.-S"
            ],
            "title": "12-photon entanglement and scalable scattershot boson sampling with optimal entangled-photon pairs from parametric down-conversion",
            "venue": "Phys. Rev. Lett. 121,",
            "year": 2018
        },
        {
            "authors": [
                "C Sch\u00f6n"
            ],
            "title": "Sequential generation of entangled multiqubit states",
            "venue": "Phys. Rev. Lett. 95,",
            "year": 2005
        },
        {
            "authors": [
                "T. Wilk"
            ],
            "title": "Quantum Interface Between an Atom and a Photon",
            "venue": "Dissertation, Technische Universita\u0308t Mu\u0308nchen",
            "year": 2008
        },
        {
            "authors": [
                "N.H. Lindner",
                "T. Rudolph"
            ],
            "title": "Proposal for pulsed on-demand sources of photonic cluster state strings",
            "venue": "Phys. Rev. Lett. 103,",
            "year": 2009
        },
        {
            "authors": [
                "A. Reiserer",
                "G. Rempe"
            ],
            "title": "Cavity-based quantum networks with single atoms and optical photons",
            "venue": "Rev. Mod. Phys. 87,",
            "year": 2015
        },
        {
            "authors": [
                "D.M. Greenberger",
                "M.A. Horne",
                "A. Zeilinger"
            ],
            "title": "Bell\u2019s Theorem, Quantum Theory and Conceptions of the Universe (ed",
            "year": 1989
        },
        {
            "authors": [
                "M Hein"
            ],
            "title": "Quantum Computers, Algorithms and Chaos https://ebooks.iospress.nl/ publication/27431 115\u2013218",
            "year": 2006
        },
        {
            "authors": [
                "Yao",
                "X.-C"
            ],
            "title": "Experimental demonstration of topological error correction",
            "venue": "Nature 482,",
            "year": 2012
        },
        {
            "authors": [
                "I Schwartz"
            ],
            "title": "Deterministic generation of a cluster state of entangled photons",
            "venue": "Science 354,",
            "year": 2016
        },
        {
            "authors": [
                "D Istrati"
            ],
            "title": "Sequential generation of linear cluster states from a single photon emitter",
            "venue": "Nat Commun 11,",
            "year": 2020
        },
        {
            "authors": [
                "Yang",
                "C.-W"
            ],
            "title": "Sequential generation of multiphoton entanglement with a Rydberg superatom",
            "year": 2021
        },
        {
            "authors": [
                "S Welte"
            ],
            "title": "Photon-mediated quantum gate between two neutral atoms in an optical cavity",
            "venue": "Phys. Rev. X",
            "year": 2018
        },
        {
            "authors": [
                "S. Langenfeld",
                "P. Thomas",
                "O. Morin",
                "G. Rempe"
            ],
            "title": "Quantum repeater node demonstrating unconditionally secure key distribution",
            "venue": "Phys. Rev. Lett. 126,",
            "year": 2021
        },
        {
            "authors": [
                "S Daiss"
            ],
            "title": "A quantum-logic gate between distant quantum-network modules",
            "venue": "Science 371,",
            "year": 2021
        },
        {
            "authors": [
                "A. Russo",
                "E. Barnes",
                "S. Economou"
            ],
            "title": "Generation of arbitrary all-photonic graph states from quantum emitters",
            "venue": "New J. Phys. 21,",
            "year": 2019
        },
        {
            "authors": [
                "R. Raussendorf",
                "H.J. Briegel"
            ],
            "title": "A one-way quantum computer",
            "venue": "Phys. Rev. Lett",
            "year": 2001
        },
        {
            "authors": [
                "H.J. Briegel",
                "D.E. Browne",
                "W. D\u00fcr",
                "R. Raussendorf",
                "M. Van den Nest"
            ],
            "title": "Measurement-based quantum computation",
            "venue": "Nat. Phys 5,",
            "year": 2009
        },
        {
            "authors": [
                "M. Zwerger",
                "W. D\u00fcr",
                "H.J. Briegel"
            ],
            "title": "Measurement-based quantum repeaters",
            "venue": "Phys. Rev. A 85,",
            "year": 2012
        },
        {
            "authors": [
                "J Borregaard"
            ],
            "title": "One-way quantum repeater based on near-deterministic photon-emitter interfaces",
            "venue": "Phys. Rev. X 10,",
            "year": 2020
        },
        {
            "authors": [
                "Sackett",
                "C. A"
            ],
            "title": "Experimental entanglement of four particles",
            "venue": "Nature 404,",
            "year": 2000
        },
        {
            "authors": [
                "A Omran"
            ],
            "title": "Generation and manipulation of Schr\u00f6dinger cat states in Rydberg atom arrays",
            "venue": "Science 365,",
            "year": 2019
        },
        {
            "authors": [
                "M Gong"
            ],
            "title": "Genuine 12-qubit entanglement on a superconducting quantum processor",
            "venue": "Phys. Rev. Lett. 122,",
            "year": 2019
        },
        {
            "authors": [
                "Besse",
                "J.-C"
            ],
            "title": "Realizing a deterministic source of multipartite-entangled photonic qubits",
            "venue": "Nat. Commun",
            "year": 2020
        },
        {
            "authors": [
                "I Pogorelov"
            ],
            "title": "Compact ion-trap quantum computing demonstrator",
            "venue": "PRX Quantum",
            "year": 2034
        },
        {
            "authors": [
                "P Walther"
            ],
            "title": "Experimental one-way quantum computing",
            "venue": "Nature 434,",
            "year": 2005
        },
        {
            "authors": [
                "Lanyon",
                "B. P"
            ],
            "title": "Measurement-based quantum computation with trapped ions",
            "venue": "Phys. Rev. Lett. 111,",
            "year": 2013
        },
        {
            "authors": [
                "T Stolz"
            ],
            "title": "A quantum-logic gate between two optical photons with an efficiency above 40",
            "venue": "Phys. Rev. X",
            "year": 2022
        },
        {
            "authors": [
                "O. Morin",
                "M. K\u00f6rber",
                "S. Langenfeld",
                "G. Rempe"
            ],
            "title": "Deterministic shaping and reshaping of single-photon temporal wave functions",
            "venue": "Phys. Rev. Lett. 123,",
            "year": 2019
        },
        {
            "authors": [
                "J Schupp"
            ],
            "title": "Interface between trapped-ion qubits and traveling photons with close-to-optimal efficiency",
            "venue": "PRX Quantum",
            "year": 2021
        },
        {
            "authors": [
                "N Tomm"
            ],
            "title": "A bright and fast source of coherent single photons",
            "venue": "Nat. Nanotechnol",
            "year": 2021
        },
        {
            "authors": [
                "E Knall"
            ],
            "title": "Efficient source of shaped single photons based on an integrated diamond nanophotonic system",
            "year": 2022
        },
        {
            "authors": [
                "P. Senellart",
                "G. Solomon",
                "A. White"
            ],
            "title": "High-performance semiconductor quantum-dot single-photon sources",
            "venue": "Nat. Nanotechnol",
            "year": 2017
        },
        {
            "authors": [
                "O. G\u00fchne",
                "Lu",
                "C.-Y",
                "Gao",
                "W.-B",
                "Pan",
                "J.-W"
            ],
            "title": "Toolbox for entanglement detection and fidelity estimation",
            "venue": "Phys. Rev. A",
            "year": 2007
        },
        {
            "authors": [
                "G. T\u00f3th",
                "O. G\u00fchne"
            ],
            "title": "Detecting genuine multipartite entanglement with two local measurements",
            "venue": "Phys. Rev. Lett. 94,",
            "year": 2005
        },
        {
            "authors": [
                "K. Tiurev",
                "A.S. S\u00f8rensen"
            ],
            "title": "Fidelity measurement of a multiqubit cluster state with minimal effort",
            "year": 2021
        },
        {
            "authors": [
                "S.D. Barrett",
                "T.M. Stace"
            ],
            "title": "Fault tolerant quantum computation with very high threshold for loss errors",
            "venue": "Phys. Rev. Lett. 105,",
            "year": 2010
        },
        {
            "authors": [
                "R. Raussendorf",
                "J. Harrington"
            ],
            "title": "Fault-tolerant quantum computation with high threshold in two dimensions",
            "venue": "Phys. Rev. Lett. 98,",
            "year": 2007
        }
    ],
    "sections": [
        {
            "text": "Nature | Vol 608 | 25 August 2022 | 677"
        },
        {
            "heading": "Article",
            "text": ""
        },
        {
            "heading": "Efficient generation of entangled",
            "text": "multiphoton graph states from a single atom\nPhilip Thomas1 \u2709, Leonardo Ruscio1, Olivier Morin1 & Gerhard Rempe1\nThe central technological appeal of quantum science resides in exploiting quantum effects, such as entanglement, for a variety of applications, including computing, communication and sensing1. The overarching challenge in these fields is to address, control and protect systems of many qubits against decoherence2. Against this backdrop, optical photons, naturally robust and easy to manipulate, represent ideal qubit carriers. However, the most successful technique so far for creating photonic entanglement3 is inherently probabilistic and, therefore, subject to severe scalability limitations. Here we report the implementation of a deterministic protocol4\u20136 for the creation of photonic entanglement with a single memory atom in a cavity7. We interleave controlled single-photon emissions with tailored atomic qubit rotations to efficiently grow Greenberger\u2013Horne\u2013Zeilinger (GHZ) states8 of up to 14 photons and linear cluster states9 of up to 12 photons with a fidelity lower bounded by 76(6)% and 56(4)%, respectively. Thanks to a source-to-detection efficiency of 43.18(7)% per photon, we measure these large states about once every minute, which is orders of magnitude faster than in any previous experiment3,10\u201313. In the future, this rate could be increased even further, the scheme could be extended to two atoms in a cavity14,15 or several sources could be quantum mechanically coupled16, to generate higherdimensional cluster states17. Overcoming the limitations encountered by probabilistic schemes for photonic entanglement generation, our results may offer a way towards scalable measurement-based quantum computation18,19 and communication20,21.\nEntanglement plays a crucial role in quantum information science. For multiqubit systems, many of the states considered, such as for entanglement purification, secret sharing, quantum error correction, as well as interferometric measurements, belong to the family of graph states9. Two prominent examples are GHZ and cluster states, which are central ingredients for various measurement-based quantum information protocols19\u201321. One-way quantum computing18, for instance, represents a conceptually appealing alternative to its circuit-based counterpart. Instead of carrying out unitary quantum logic gates, computation relies on adaptive single-qubit measurements. This operational easing comes at the price that a multiqubit entangled resource state, a cluster state, needs to be prepared in advance.\nAlthough multiqubit entanglement has been demonstrated on various platforms3,22\u201326, only small-scale implementations of measurement-based quantum computing have been realized so far10,27,28. Among these platforms, optical photons stand out as qubit carriers, as these suffer negligible decoherence and benefit from crosstalk-free single-qubit addressability and measurement capabilities with off-the-shelf components. However, the most common sources for entangled photons are based on spontaneous parametric down-conversion (SPDC). This scheme is inherently probabilistic and thus makes scaling up to larger states an increasingly difficult challenge, even for a moderate number of qubits.\nTo address this issue, deterministic schemes have been proposed4\u20136. These use a single-spin memory qubit that mediates entanglement over\na string of sequentially emitted photons. This approach is resource efficient as it permits the generation of in principle arbitrarily many entangled photons from a single device. First experiments along these lines have been performed with quantum dots11,12 demonstrating entanglement of up to three and four qubits, respectively, in a linear cluster state. Low photon generation and collection efficiencies, a noisy semiconductor environment or the need for a probabilistic entangling gate were among the biggest obstacles for reaching higher photon numbers. Recent experiments with Rydberg superatoms13,29 demonstrated GHZ states of up to six photons. Although the single-emitter strategy could in principle provide a stepping stone for photonic quantum computation, no implementation has demonstrated a performance that beats or even compares to the SPDC approach3.\nHere we produce large and high-fidelity photonic graph states of the GHZ and cluster type. Inspired by the proposals of refs. 4\u20136, which we adapt to our physical system, we use a cavity quantum electrodynamics platform as an efficient photon source30\u201334 and, for the first time, surpass the state-of-the-art SPDC platform. Arbitrary single-qubit rotations between photon emissions allow for the flexible preparation of different types of states in a programmable fashion. We generate and detect GHZ states of up to 14 photons and linear cluster states of up to 12 photons with genuine multipartite entanglement. In principle, higher-dimensional cluster states can be created by coupling several sources17, for example, by means of optically mediated controlled NOT gates of the kind demonstrated recently16. By virtue of this feature, so\nhttps://doi.org/10.1038/s41586-022-04987-5\nReceived: 26 January 2022\nAccepted: 16 June 2022"
        },
        {
            "heading": "Published online: 24 August 2022",
            "text": ""
        },
        {
            "heading": "Open access",
            "text": "Check for updates\n1Max-Planck-Institut f\u00fcr Quantenoptik, Garching, Germany. \u2709e-mail: philip.thomas@mpq.mpg.de\n678 | Nature | Vol 608 | 25 August 2022"
        },
        {
            "heading": "Article",
            "text": "far unique to the atomic cavity quantum electrodynamics platform, our technique supports modular extension towards scalable architectures for one-way quantum computation18,19, as depicted in Fig.\u00a01a."
        },
        {
            "heading": "Experimental setup and protocol",
            "text": "Our apparatus is shown schematically in Fig.\u00a01b. It consists of a single 87Rb atom at the centre of a high-finesse optical cavity. A magnetic bias field oriented parallel to the cavity direction defines the quantization axis and gives rise to a Zeeman splitting with Larmor frequency \u03c9L = 2\u03c0 \u00d7 100 kHz. Several laser beams propagating perpendicular to the cavity allow for various manipulations, such as state preparation by optical pumping and coherent driving of Raman transitions between the hyperfine ground-state manifolds with energy selectivity provided by the Zeeman splitting. The cavity serves as an efficient light\u2013matter interface for atom\u2013photon entanglement7 with an optical cooperativity of C \u2248 1.5 (Methods). A vacuum-stimulated Raman adiabatic passage (vSTIRAP) enables the generation of photons with high indistinguishability stemming from accurate control over their temporal wave function30. Photons that are outcoupled from the cavity are analysed with a polarization-resolving detection setup mainly consisting of a polarizing beam splitter (PBS) and a pair of superconducting nanowire single-photon detectors. Furthermore, an electro-optic modulator is used for fast selection of the measurement basis by switching between the Z basis (right and left circular polarization) and the X basis (horizontal and vertical polarization). When set to the X basis, a half-wave plate can optionally be placed to rotate the detection basis along the equator of the Bloch sphere.\nThe experimental protocol for generation of entangled photons in essence consists of a periodic sequence of photon generations interleaved with single-qubit rotations performed on the atom. The sequence is shown in Fig.\u00a01c, including the corresponding processes in the atomic-level diagram. We first initialize the atom in the state F m= 2, = 0\u27e9F\u2223 by optical pumping. Here we write the atomic state as\nF m, \u27e9F\u2223 , in which F denotes the total angular momentum and mF is its projection along the quantization axis. Then we apply a control pulse (1.5 \u03bcs), which induces the vSTIRAP process generating a photon (300 ns full width at half maximum) entangled in polari zation with the atomic state. This process can be written as \u2223 \u2223 \u2223 \u2223 \u2223R L2, 0\u27e9 \u2192 ( 1, 1\u27e9 \u27e9 \u2212 1, \u22121\u27e9 \u27e9)/ 2 , in which R L/ \u27e9\u2223 denotes right/left circular polarization of the photon and \u2223 \u2223{ 1, 1\u27e9, 1, \u22121\u27e9} serves as our atomic qubit basis. We then perform a single qubit rotation R\u03b8 of angle \u03b8 (step 1) on the atom. For cluster states \u03b8 = \u03c0/2, for GHZ states, no rotation is performed, that is, \u03b8 = 0. Afterwards we transfer the qubit from \u22231, \u00b1 1\u27e9 to \u22232, \u00b1 2\u27e9 (step 2). Both steps 1 and 2 are realized by means of a series of Raman pulses with a 790-nm laser (Methods). Finally, we induce the vSTIRAP process (step 3) by applying a control pulse, which produces a photon (step 4) and takes the atom back to the states 1, \u00b11\u27e9\u2223 . Steps 2\u20134 can be summarized by writing \u2223 \u2223 \u2223R L1, \u00b11\u27e9 \u2192 1, \u00b11\u27e9 / \u27e9 . One photon production cycle consisting of steps 1\u20134 takes 200 \u03bcs (50 \u03bcs) for the cluster (GHZ) state sequence. It is repeated N \u2212 2 times, each iteration adding another qubit to a growing chain of entangled photons. For the final photon however (closing), the atomic qubit is transferred from \u22231, \u00b1 1\u27e9 to \u2223 \u22132, 1\u27e9 (instead of \u22232, \u00b1 2\u27e9) such that, in the subsequent emission process, the atom ends up in 1, 0\u27e9\u2223 , which readily disentangles it from the photonic state. We note that in the case of\u00a0cluster states, initializing as well as disentangling the atom are not strictly necessary, as the same can be achieved by appropriate Z basis measurements of the first and last photons6. In the case of GHZ states however, the protocol must be performed as described in Fig.\u00a01c to obtain an N-photon state of the form \u2223 \u2223 \u2223R LGHZ \u27e9 = ( \u27e9 + \u27e9 )/ 2N N N\u2297 \u2297 ."
        },
        {
            "heading": "GHZ states",
            "text": "We start the experiment by producing GHZ states. In contrast to cluster states, GHZ states are more sensitive to noise and require a higher level of control in their preparation process. Regardless, because their density matrix contains only four non-zero entries, it is much easier to\nc\nmF\nTime\nb\nPBS Det1\nDet2\nZ/X basis switch\nDetection\n87Rb\nB eld\na\nvSTIRAP Qubit rotation Raman transfer\nAuxiliary photon\nOutput photon\nOptical bre\nPhoton source\nEntanglement vSTIRAP\n0\u20131 1 0\u20131 10\u20132 \u20131 21\nF = 1\nF = 2\nD2\nInitialization (photon 1)\nCycling (photons 2, 3,..., N \u2013 1)\nClosing (photon N)\nTransfer\nPhoton\nQubit rotation\n. . .\n1\n/2\n2\n22\n1\n34 43\n3 4\nFig. 1 | Experimental setup and protocol. a, Proposed one-way quantum computing hardware architecture. Each source produces a one-dimensional photonic cluster state while at the same time entanglement is distributed across the emitters by ancillary photons being successively reflected off each atom\u2013cavity system16. Thus a two-dimensional fabric of photonic cluster states is woven from the individual one-dimensional chains, readily serving as a resource for measurement-based quantum computing. b, Experimental setup. A single 87Rb atom coupled to a high-finesse cavity emits a stream of entangled photons. Various lasers directed onto the atom from the side allow to control the photon emission and manipulate the atomic state to realize the desired protocol. The chain of photons is detected by a polarization-resolving\ndetection setup composed of a PBS and two detectors (Det1 and Det2). A fast polarization electro-optic modulator switches between two predefined settings such that each individual photon can be measured in either the Z or the X basis. A half-wave plate before the PBS rotates the detection basis from X to Y and arbitrary superpositions thereof. c, Protocol for cluster/GHZ state generation divided into three steps. Initialization of the atom and first photon emission, cycling process in which the atomic qubit is rotated by \u03b8 = 0 or \u03c0/2 and a new entangled photon is emitted, and closing of the protocol by emission of a last photon while disentangling the atom from the generated string of photons.\nNature | Vol 608 | 25 August 2022 | 679\nmeasure the fidelity FN of an N-photon GHZ state 35 than for a cluster state, despite the large Hilbert space of dimension 2N. Therefore, the quantitative analysis of a multiphoton GHZ state, besides representing an interesting result by itself, provides a useful tool for benchmarking and gives insights into the inner dynamics of our system.\nFor estimation of the fidelity, it is sufficient to measure the non-zero elements on the diagonal and off-diagonal of the density matrix separately. The diagonal elements represent the populations NP of the R\u27e9\nN\u2297\u2223 and L\u27e9 N\u2297\u2223 components of the state and can be obtained by measuring all photons in the Z basis. The corresponding experimental data, shown in Fig.\u00a02b in blue, agree well with the ideal GHZ state, for which = 1NP , with only a weak dependence on N. To demonstrate that the states R\u27e9 N\u2297\u2223 and \u2223L\u27e9 N\u2297 are in a coherent superposition, we set the measurement basis to R L( \u27e9 \u00b1 e \u27e9)/ 2\u03d5i\u2223 \u2223 , in which \u03d5 \u2208 [0, \u03c0] , thus spanning the full equator of the Bloch sphere. This allows us to measure the characteristic parity oscillations, which behave as cos(N\u03d5) (Methods), see Fig.\u00a02a. The coherences NC of the density matrix are extracted from the visibility of the oscillations for all photon numbers up to N = 10. For 14 photons, the coincidence rate decreases notably owing to the finite photon production efficiency. To acquire enough data, we only measure the parity for \u03d5 = 0, which is indicated by the yellow diamond in Fig.\u00a0 2b. Eventually, the fidelity is calculated using the formula F P C= ( + )/2N N N and is shown in Fig.\u00a02b in red. As only a single measurement setting was used for 14C , we also provide a lower bound for the fidelity on the basis of an entanglement witness (Methods). With this,\nwe prove genuine 14-photon entanglement with a fidelity \u2265 76(6)%14F , surpassing the 50% threshold by more than 4 standard deviations. To the best of our knowledge, this is the largest entangled state of photons so far.\nWithin the measured range, we observe that the decay of NP , CN and FN as a function of photon number is well captured by a linear model with a slope of 0.86(9)%, 1.3(2)% and 1.04(9)% per photon, respectively. By extrapolation of this trend, we estimate that the fidelity will cross the 50% threshold at around 44 qubits. The remarkably slow decay in fidelity is particularly astonishing as we observe very little decoherence even when the sequence is deliberately chosen to exceed the intrinsic coherence time of the atomic qubit (about 1 ms). This behaviour is explained by a dynamical decoupling effect built into the protocol, which arises from the opposite signs of the Zeeman splitting in the two hyperfine ground-state manifolds. Hence, the qubit precession is reversed every time the atom is transferred from F = 1\u27e9\u2223 to F = 2\u27e9\u2223 or vice versa, which can be seen as two spin-echo pulses for every photon production cycle. Although this mechanism contributes to the high-visibility fringes seen in Fig.\u00a02a, no extra effort is needed to exploit it (Methods). At present, we attribute the main source of infidelity to the vSTIRAP. This can be explained by the finite cooperativity that allows for unwanted paths in the emission process (Methods)."
        },
        {
            "heading": "Cluster states",
            "text": "The characterization of cluster states is more demanding, as the density matrix contains many non-zero elements. We therefore use the entanglement witness W proposed in ref. 36, which is based on the stabilizer formalism. A lower bound of the fidelity can be derived from W, requiring only two local measurement settings XZXZ... and ZXZX... (Methods). Compared with quantum state tomography, this has the advantage of a tremendous reduction in experimental overhead but comes at the cost of a potentially substantial underestimation of the true state fidelity. Nonetheless, the experimental results shown in Fig.\u00a03a exceed the 50% threshold for all measured points. Here, the data only includes events in which exactly N photons are detected for a sequence of N consecutive generation attempts. For the largest cluster state of 12 photons we find the fidelity to be lower bounded by 56(4)%. Comparing the results to the GHZ states in Fig.\u00a02, we notice a much faster decay of the fidelity (3.6(2)% per photon). Besides the large number of Raman transfers in the protocol (five transfers per cycle, see Methods), we attribute this mainly to the lower bound, which\u2014by construction\u2014underestimates the fidelity. A tighter lower bound that was recently formulated37 could provide a more accurate\u00a0estimate of the fidelity in future experiments.\nIn addition to providing a lower bound for the fidelity, we now present the measured stabilizer operators, defined as Sk = Zk\u22121XkZk+1 (Fig.\u00a03b). Here k \u2208 {1, 2, ..., N}, Z Z= =N0 +1 , and Xk and Zk denote the respective Pauli matrices acting on the kth qubit. In this scenario, events in which three consecutive photons, k \u2212 1, k and k + 1, are detected in the appropriate basis contribute to the stabilizer Sk. In principle, arbitrarily many stabilizers could be measured by repeating the protocol for a corresponding number of cycles. Here, however, we terminate the sequence at k = 15. We find an average of \u2329S1\u232a = 96.13(9)% and \u2329Sk\u232a = 92(1)% for k \u2265 2, indicating a large overlap of the generated state with the target linear cluster state."
        },
        {
            "heading": "Coincidence rate",
            "text": "We emphasize that the ability of producing entanglement of up to 14 photons is based, on the one hand, on the excellent coherence properties of the atom and, on the other hand, on the large photon generation and detection efficiencies. The latter is crucial, as the success probability ps of detecting a coincidence of N consecutive photons scales exponentially with the photon number, ps = \u03b7 N. Here \u03b7 denotes the\n680 | Nature | Vol 608 | 25 August 2022"
        },
        {
            "heading": "Article",
            "text": "probability to generate and detect a single photon for a given attempt. We can express \u03b7 as the product of the source efficiency \u03b70, that is, the probability of producing a photon at the output of the cavity, and the detection efficiency \u03b7d. It is clear that a low efficiency \u03b7 \u226a 1 poses a great obstacle to achieving large photonic states within reasonable measurement times.\nFigure\u00a04 shows the raw rate of multiphoton coincidences as a function of photon number N including post-selection and experimental duty cycle. The experimental sequence consists of 14 (12) consecutive photon generation attempts with all timing parameters identical to the GHZ (cluster) protocol and a new run starting every 1.1 ms (3.0 ms). The data shown (blue for GHZ and red for cluster states) are the coincidence count rates of events in which N consecutive photons were detected starting from the first attempt. For instance, for the largest state of 14 photons, we recorded 151 coincidences in 7 h of experimental runtime, equivalent to roughly one event every 3 min. From an exponential fit to the data, we extract the overall single-photon generation and detection efficiency \u03b7 = 43.18(7)%. We estimate the intrinsic generation efficiency \u03b70 to be 66%, mainly limited by the cooperativity and the escape efficiency (see ref. 30). Both can be optimized by higher-quality mirrors and a smaller cavity-mode volume. The detection efficiency of \u03b7d = 0.7 captures all the remaining loss contributions, such as optical elements and detectors. These include free-space-to-fibre couplings (94% twice), propagation through optical fibre (97%), free-space optics (90%) and detector efficiency (90%). Correcting for the detection efficiency \u03b7d, we infer an N-photon coincidence rate at the output of the cavity, as given by the light blue line in Fig.\u00a04. This represents the limit of our system with the current parameters. As a comparison, we also show the rate of the best available SPDC system, as well as deterministic sources using single quantum dots or Rydberg-blockaded atomic ensembles. Although the repetition rate for these systems is typically many orders of magnitude higher than in our protocol, our system far outperforms previous\nimplementations in terms of real-time coincidence count rate as well as efficiency scaling."
        },
        {
            "heading": "Summary and outlook",
            "text": "To conclude, we have presented a scalable and freely programmable source of entangled photons, demonstrating\u2014to our knowledge\u2014the largest entangled states of optical photons to this day. It is deterministic in the sense that no probabilistic entangling gates are required. This gives us a clear scaling advantage over previous schemes. Moreover, the ability to perform arbitrary single-qubit rotations on the emitter provides the flexibility to grow graph states of different types.\nAt this stage, our system faces mostly technical limitations, such as optical losses, finite cooperativity and imperfect Raman pulses. Even modest improvements in these respects would put us within reach of loss and fault tolerance thresholds for quantum error correction19,38\u201340. Hence, a clear path towards one-way quantum computing architectures would be the generation of two-dimensional cluster states by entangling several photon sources17. For example, in a next step, two of our systems could be coupled through remote quantum logic gates16 to produce 2 \u00d7 N \u2018ladder\u2019 cluster states. Alternatively, entangling operations such as gates or Bell-state measurements could be performed on two (or more) individual atoms as single emitters in the same cavity14,15. Similar strategies apply for the generation of tree graph states and one-way quantum repeaters20,21. The present work thus opens up a new road for photonic quantum computation and communication."
        },
        {
            "heading": "Online content",
            "text": "Any methods, additional references, Nature Research reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at https://doi.org/10.1038/s41586-022-04987-5.\nNature | Vol 608 | 25 August 2022 | 681\n1. Bennett, C. H. & DiVincenzo, D. P. Quantum information and computation. Nature 404, 247\u2013255 (2000). 2. Preskill, J. Quantum computing in the NISQ era and beyond. Quantum 2, 79 (2018). 3. Zhong, H.-S. et\u00a0al. 12-photon entanglement and scalable scattershot boson sampling\nwith optimal entangled-photon pairs from parametric down-conversion. Phys. Rev. Lett. 121, 250505 (2018).\n4. Sch\u00f6n, C. et\u00a0al. Sequential generation of entangled multiqubit states. Phys. Rev. Lett. 95, 110503 (2005). 5. Wilk, T., Quantum Interface Between an Atom and a Photon. Dissertation, Technische Universit\u00e4t M\u00fcnchen. http://mediatum.ub.tum.de/node?id=637078 (2008). 6. Lindner, N. H. & Rudolph, T. Proposal for pulsed on-demand sources of photonic cluster state strings. Phys. Rev. Lett. 103, 113602 (2009). 7. Reiserer, A. & Rempe, G. Cavity-based quantum networks with single atoms and optical photons. Rev. Mod. Phys. 87, 1379 (2015). 8. Greenberger, D. M., Horne, M. A. & Zeilinger, A. in Bell\u2019s Theorem, Quantum Theory and Conceptions of the Universe (ed. Kafatos, M.) 69\u201372 (Springer, 1989). 9. Hein, M. et\u00a0al. in Quantum Computers, Algorithms and Chaos https://ebooks.iospress.nl/ publication/27431 115\u2013218 (IOS Press, 2006). 10. Yao, X.-C. et\u00a0al. Experimental demonstration of topological error correction. Nature 482, 489\u2013494 (2012). 11. Schwartz, I. et\u00a0al. Deterministic generation of a cluster state of entangled photons. Science 354, 434\u2013437 (2016). 12. Istrati, D. et\u00a0al. Sequential generation of linear cluster states from a single photon emitter. Nat Commun 11, 5501 (2020). 13. Yang, C.-W. et\u00a0al. Sequential generation of multiphoton entanglement with a Rydberg superatom. Preprint at https://arxiv.org/abs/2112.09447 (2021). 14. Welte, S. et\u00a0al. Photon-mediated quantum gate between two neutral atoms in an optical cavity. Phys. Rev. X 8, 011018 (2018). 15. Langenfeld, S., Thomas, P., Morin, O. & Rempe, G. Quantum repeater node demonstrating unconditionally secure key distribution. Phys. Rev. Lett. 126, 230506 (2021). 16. Daiss, S. et\u00a0al. A quantum-logic gate between distant quantum-network modules. Science 371, 614\u2013617 (2021). 17. Russo, A., Barnes, E. & Economou, S. Generation of arbitrary all-photonic graph states from quantum emitters. New J. Phys. 21, 055002 (2019). 18. Raussendorf, R. & Briegel, H. J. A one-way quantum computer. Phys. Rev. Lett. 86, 5188 (2001). 19. Briegel, H. J., Browne, D. E., D\u00fcr, W., Raussendorf, R. & Van den Nest, M. Measurement-based quantum computation. Nat. Phys 5, 19\u201326 (2009). 20. Zwerger, M., D\u00fcr, W. & Briegel, H. J. Measurement-based quantum repeaters. Phys. Rev. A 85, 062326 (2012). 21. Borregaard, J. et\u00a0al. One-way quantum repeater based on near-deterministic photon-emitter interfaces. Phys. Rev. X 10, 021071 (2020). 22. Sackett, C. A. et\u00a0al. Experimental entanglement of four particles. Nature 404, 256\u2013259 (2000). 23. Omran, A. et\u00a0al. Generation and manipulation of Schr\u00f6dinger cat states in Rydberg atom arrays. Science 365, 570\u2013574 (2019). 24. Gong, M. et\u00a0al. Genuine 12-qubit entanglement on a superconducting quantum processor. Phys. Rev. Lett. 122, 110501 (2019).\n25. Besse, J.-C. et\u00a0al. Realizing a deterministic source of multipartite-entangled photonic qubits. Nat. Commun. 11, 4877 (2020). 26. Pogorelov, I. et\u00a0al. Compact ion-trap quantum computing demonstrator. PRX Quantum 2, 020343 (2021). 27. Walther, P. et\u00a0al. Experimental one-way quantum computing. Nature 434, 169\u2013176 (2005). 28. Lanyon, B. P. et\u00a0al. Measurement-based quantum computation with trapped ions. Phys.\nRev. Lett. 111, 210501 (2013). 29. Stolz, T. et\u00a0al. A quantum-logic gate between two optical photons with an efficiency\nabove 40%. Phys. Rev. X 12, 021035 (2022). 30. Morin, O., K\u00f6rber, M., Langenfeld, S. & Rempe, G. Deterministic shaping and reshaping of\nsingle-photon temporal wave functions. Phys. Rev. Lett. 123, 133602 (2019). 31. Schupp, J. et\u00a0al. Interface between trapped-ion qubits and traveling photons with\nclose-to-optimal efficiency. PRX Quantum 2, 020331 (2021). 32. Tomm, N. et\u00a0al. A bright and fast source of coherent single photons. Nat. Nanotechnol. 16,\n399\u2013403 (2021). 33. Knall, E. et\u00a0al. Efficient source of shaped single photons based on an integrated diamond\nnanophotonic system. Preprint at https://doi.org/10.48550/arXiv.2201.02731 (2022). 34. Senellart, P., Solomon, G. & White, A. High-performance semiconductor quantum-dot\nsingle-photon sources. Nat. Nanotechnol. 12, 1026\u20131039 (2017). 35. G\u00fchne, O., Lu, C.-Y., Gao, W.-B. & Pan, J.-W. Toolbox for entanglement detection and\nfidelity estimation. Phys. Rev. A 76, 030305 (2007). 36. T\u00f3th, G. & G\u00fchne, O. Detecting genuine multipartite entanglement with two local\nmeasurements. Phys. Rev. Lett. 94, 060501 (2005). 37. Tiurev, K. & S\u00f8rensen, A. S., Fidelity measurement of a multiqubit cluster state with\nminimal effort. Preprint at https://arXiv.org/abs/2107.10386 (2021). 38. Barrett, S. D. & Stace, T. M. Fault tolerant quantum computation with very high threshold\nfor loss errors. Phys. Rev. Lett. 105, 200502 (2010). 39. Raussendorf, R. & Harrington, J. Fault-tolerant quantum computation with high threshold\nin two dimensions. Phys. Rev. Lett. 98, 190504 (2007). 40. Varnava, M., Browne, D. E. & Rudolph, T. How good must single photon sources and\ndetectors be for efficient linear optical quantum computation? Phys. Rev. Lett. 100, 060502 (2008).\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate\ncredit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/.\n\u00a9 The Author(s) 2022"
        },
        {
            "heading": "Article",
            "text": ""
        },
        {
            "heading": "Methods",
            "text": ""
        },
        {
            "heading": "Experimental setup",
            "text": "The central component of the setup used in this work is a high-finesse optical cavity with a 87Rb atom trapped at its centre. The cavity consists of two highly reflective mirrors oriented parallel to each other at a distance of 500 \u03bcm with an optical mode waist of w0 = 30 \u03bcm. The two mirrors have a transmitivity of T1 = 100 ppm and T2 = 4 ppm, giving rise to a finesse of F \u2248 60,000, such that photons populating the cavity mode are outcoupled predominantly through the low-reflective side. The cavity is tuned to the atomic D2 line with a detuning of \u0394c = \u2212150 MHz with respect to the transition \u2223 \u2223F F= 1\u27e9 \u2194 \u2032 = 1\u27e9 . The combined system of the atom and cavity is best described in the framework of cavity quantum electrodynamics with parameters (g, \u03ba, \u03b3) = 2\u03c0 \u00d7 (cge \u00d7 10.8, 2.7, 3.0) MHz, g being the atom\u2013cavity coupling strength for the relevant transition, \u03ba the decay rate of the cavity field and \u03b3 the free-space atomic decay rate associated with the D2 transition of 87Rb. cge is the Clebsch\u2013Gordan coefficient between the relevant excited state ( e\u27e9\u2223 ) coupling to the vSTIRAP control pulse and the final state ( g\u27e9\u2223 ) of the photon production process. The above parameters put our system in the intermediate to strong coupling regime with a cooperativity parameter defined as C = g2/(2\u03ba\u03b3). Note that the specific value of C depends on the transition path associated to a certain excited state. For example, for the emission from \u22232, \u00b1 2\u27e9 as in the cycling step of the protocol, we have \u2223 \u2223g F m\u27e9 = = 1, = \u00b1 1\u27e9F and e F m\u27e9 = \u2032 = 2, \u2032 = \u00b1 2\u27e9F\u2223 \u2223 . Hence, we get c = 1/4ge , giving C = 1.8."
        },
        {
            "heading": "Atom loading",
            "text": "Atoms are transferred from a magneto-optical trap to the centre of the cavity, in which they are trapped by a two-dimensional optical lattice composed of two standing-wave potentials, one at 772 nm oriented along the cavity axis and one at 1,064 nm propagating perpendicular to the cavity axis. An electron-multiplying charge coupled device camera detects the atomic fluorescence, which is collected by means of a high-numerical-aperture objective. A single atom is prepared quasi-deterministically by removing any excess atom with a resonant laser beam steered onto the atom by means of an acousto-optic deflector. The position of the atom is monitored during the experiment and controlled through appropriate feedback to the optical trapping potential.\nExperimental duty cycle and post-selection Because the atoms have a finite lifetime in the dipole trap, they have to be reloaded regularly. The average trapping time depends markedly on the type of conducted experiment (that is, heating/cooling mechanisms). For our experiments, we achieved an average trapping time of roughly 20 s. The time required for loading and repositioning of the atom after occasional jumps to a different location reduces the experimental duty cycle. By counting the number of experimental runs carried out at a given repetition rate over a longer measurement interval, we evaluate the overall duty cycle to be close to 50%.\nOnce a camera image shows that the atom has moved away from the target position, the corresponding data to that image are discarded through post-selection processing. The same applies to images with more than one atom near the cavity centre.\nFurther post-selection is performed by processing the data collected by the single-photon detectors: an experimental run is considered successful when N photons were detected in a row, each within predefined time windows (1 \u03bcs width in this work). Note that Fig.\u00a04 shows the coincidence rate after applying post-selection."
        },
        {
            "heading": "Protocol",
            "text": "The full experimental sequence including timings of the optical pulses is shown in Extended Data Fig.\u00a01. As described in the main text, it mainly consists of a repeating sequence of single-qubit rotations and photon\nemissions (cycling), with further initialization and closing steps at the beginning and the end. The atom is initialized in the state \u22232, 0\u27e9 by optical pumping (5 \u03bcs). A square-shaped control pulse (1.5 \u03bcs) produces the first photon, thus generating the atom\u2013photon entangled state \u2223 \u2223 \u2223 \u2223R L1, 1\u27e9 \u27e9 \u2212 1, \u22121\u27e9 \u27e91 1 (up to normalization), in which the index \u20181\u2019 refers to the first photon. If no photon was detected, we immediately go back to the state preparation step and another photon attempt. We choose a maximum of seven attempts for the first photon to avoid excessive heating of the atom. After a successful first photon detection, we start the cycling stage with the single-qubit gate, which\u2014for cluster states\u2014 consists of a \u03c0/2 rotation contained in three Raman manipulations. First, the population in \u22231, 1\u27e9 is transferred to 2, 0\u27e9\u2223 with a \u03c0 pulse, taking 53 \u03bcs. Then a \u03c0/2 pulse is applied to the transition 1, \u22121\u27e9 \u2194 2, 0\u27e9\u2223 \u2223 , realizing the qubit rotation. Afterwards, the population in 2, 0\u27e9\u2223 is transferred back to 1, 1\u27e9\u2223 with another \u03c0 pulse. The operation described transforms the basis states as follows: \u2223 \u2223 \u22231, 1\u27e9 \u2192 1, 1\u27e9 + 1, \u22121\u27e9 and \u2223 \u2223 \u22231, \u22121\u27e9 \u2192 \u2212 1, 1\u27e9 + 1, \u22121\u27e9. The whole pulse sequence for the single-qubit gate takes 132.5 \u03bcs. For GHZ states, the required rotation angle is \u03b8 = 0, which means that the qubit rotation can be skipped entirely. To produce the next photon, we transfer the population from 1, \u00b11\u27e9\u2223 to \u22232, \u00b12\u27e9 by means of two sequential Raman \u03c0 pulses (790 nm), each taking 21 \u03bcs. We then apply a vSTIRAP control pulse, leading to a photon emission. The atom\u2013photon\u2013photon state then reads R L R R L L( 1, 1\u27e9 \u27e9 + 1, \u22121\u27e9 \u27e9) \u27e9 \u2212 (\u2212 1, +1\u27e9 \u27e9 + 1, \u22121\u27e9 \u27e9) \u27e92 2 1 2 2 1\u2223 \u2223 \u2223 \u2223 \u2223 \u2223 \u2223 \u2223 \u2223 \u2223 for cluster states, that is, \u03b8 = \u03c0/2. The index \u20182\u2019 now refers to the second photon. The cycling step is repeated as many times as desired. In the very last cycle, the closing step is performed. Here, following the qubit rotation, the atomic population is transferred from 1, \u00b11\u27e9\u2223 to 2, 1\u27e9\u2223 \u2213 instead of 2, \u00b12\u27e9\u2223 , which takes 55 \u03bcs. Thus the atom is disentangled in the subsequent photon emission. This step can be seen as an atom-to-photon state transfer, as the atomic qubit is mapped to the polarization state. After the last photon, we run a calibration sequence for actively stabilizing the optical power of the laser pulses. Finally, the atom is laser-cooled for several hundred microseconds. The length of a full period of the experiment including calibration and cooling depends on the type of state produced and the number of photons N. It can be as short as 400 \u03bcs and as long as 3 ms."
        },
        {
            "heading": "Raman manipulations",
            "text": "The Raman transitions shown as orange and green arrows in Extended Data Fig.\u00a01 are performed with a 790-nm laser. The duration of these transitions make up the most part of the experimental sequence. In principle, choosing a higher Rabi frequency could drastically increase the repetition rate of the protocol but would lead to more crosstalk between the transitions, as they would start to overlap in frequency space. As a consequence, a compromise between repetition rate and high-fidelity Raman manipulations has to be found. For our choice of experimental parameters, we estimate the infidelity per single-qubit rotation to be smaller than 1%.\nThe Raman transfer in the closing step from F = 1\u27e9\u2223 to F = 2\u27e9\u2223 is realized with a 795-nm Raman laser close to the D1 line of rubidium. For this specific Raman transition, we cannot choose a large detuning because this would lead to a destructive interference owing to the Clebsch\u2013Gordan coefficients. As a consequence, we have a chance of about 5% of spontaneous scattering, which reduces the fidelity. As mentioned in the main text, alternatively, the atom can also be disentangled from the photonic state by measuring the most recently generated photon in the Z basis. Although this would slightly increase the fidelity, the rate would decrease, as the detection of an extra photon is required."
        },
        {
            "heading": "Estimation of errors",
            "text": "For GHZ states, we observe a total error rate of about 1% per photon. We attribute most of the infidelity to spontaneous scattering during the photon production process, as the vSTIRAP control pulse couples to\nthe F\u2032 = 3 excited state of the D2 line. This opens a decay channel, which competes with the coherent emission of the photon. By post-selecting on early photon arrival, one can partly filter out events in which scattering has occurred (Extended Data Fig.\u00a04). In the future, this could be eliminated by generating the photons on the D1 line, in which no F\u2032 = 3 state is present. This should greatly improve the error rate.\nThe same error mechanism applies in the case of cluster states. Furthermore, the single-qubit gate implemented with Raman lasers introduces errors, which we estimate to be smaller than 1%. These could be explained by finite frequency resolution, pulse intensity fluctuations, as well as drifts in optical alignment. For instance, increasing the Zeeman splitting would be a way to further optimize this process.\nMinor sources of error include polarization alignment. For setting the polarization detection basis, we use a reference polarizer in front of the cavity and measure the polarization extinction to be on the order of 10,000:1. For switching the detection basis, we use a polarization electro-optic modulator (QUBIG PC3R-NIR) with a switching time of 5 ns. The extinction ratio is specified as >1,000:1, whereas we measured values of around 5,000:1.\nThe error rate for cluster states of 3.6% as given in the main text is presumably overestimated owing to the definition of the fidelity lower bound. Taking into account the error sources identified above, we estimate the true error rate to be smaller than 2%. With the suggested improvements, we expect a reduction well below 1% to be realistic."
        },
        {
            "heading": "Generation efficiency",
            "text": "The intrinsic source efficiency, that is, the probability of obtaining a photon at the output of the cavity, is given by\n\u03b7 C\nC \u03b7= 2 2 + 1 \u00d7 , (1)0 esc\nin which C \u2248 1.5 is the cooperativity and \u03b7esc \u2248 0.88 denotes the escape efficiency, that is, the probability of a photon being outcoupled from the output port30. Note that the above formula is only valid in the case of a single excited state, whereas the efficiency becomes a function of the detuning, \u03b70 (\u0394), when several excited states are present.\nThe source efficiency could hence be improved by increasing both the cooperativity and the escape efficiency. As the two parameters are generally not independent, let us assume for simplicity that we reduce the waist of the cavity mode by a factor of 2. This increases the cooperativity by a factor of 4 without altering the escape efficiency. We would thereby improve the source efficiency from 66% to 81%.\nFurthermore, the efficiency of the detection setup could be improved. For instance, by redesigning and optimization of the setup, one could replace a fibre-to-fibre coupling with a fibre splice, eliminate a free-space-to-fibre coupling and reduce the losses from optical surfaces. In this scenario, an improvement of the detection efficiency \u03b7d from 0.7 to 0.85 seems feasible. Given these realistic improvements, the combined source-to-detection efficiency \u03b7 would reach the mark of 2/3, an important threshold for linear optical quantum computation40."
        },
        {
            "heading": "GHZ state fidelity",
            "text": "In the mathematical formalism of spin 1/2 particles, a GHZ state looks like\nGHZ \u27e9 = 1 2 ( \u2191\u2191\u2191 . . .\u27e9 + \u2193\u2193\u2193 . . .\u27e9) , (2)N\u2223 \u2223 \u2223\nin which in the photonic case \u2223 \u2223\u2191\u27e9/ \u2193\u27e9 corresponds to \u2223 \u2223R L\u27e9/ \u27e9. For measuring the diagonal elements of the density matrix, that is, the populations PN of the \u2223\u2191\u27e9\nN\u2297 and \u2193\u27e9 N\u2297\u2223 components, it suffices to measure all particles in the Z basis to obtain\n= ( \u2191\u27e9 \u27e8\u2191 ) + ( \u2193\u27e9 \u27e8\u2193 ) . (3)N N N\u2297 \u2297P \u2223 \u2223 \u2223 \u2223\nFor the coherences, we introduce the parity operator3,35\n= 0 e e 0 (4)\u03d5 \u03d5 \u03d5\nN \u2212i\ni\n\u2297\nM \n \n  \ndescribing a measurement of all N particles in the basis \u2223 \u2223( \u2191\u27e9 \u00b1 e \u2193\u27e9)/ 2\u03d5i . Varying the parameter \u03d5 from 0 to \u03c0 corresponds to a continuous rotation of the measurement basis along the equator of the Bloch sphere. In the experiment, this is achieved by scanning the angle of a half-wave plate in front of the PBS in the detection setup. It is straightforward to show that the expectation value of M\u03d5 for the ideal GHZ state is\n\u2223 \u2223 N\u03d5\u27e8GHZ GHZ \u27e9 = cos( ). (5)N \u03d5 NM\nThese characteristic parity oscillations are what can be seen in Fig.\u00a02a. The amplitudes of the oscillations as obtained from a cosine fit are a measure for the coherences of the density matrix. The fidelity is then obtained from the formula\n= ( + )/2 (6)N N N (GHZ)F P C\nFor the largest photon number of N = 14, we chose to measure an entanglement witness derived in ref. 36 to obtain a fidelity lower bound. The witness is based on the stabilizer formalism, the stabilizing operators for GHZ states being\nS X X X= \u22c5 \u22c5 \u22c5 \u22c5 (7)N1 (GHZ) 1 2\nS Z Z= \u22c5 , (8)k k k\u22652 (GHZ) \u22121\nin which k = 1, 2, ..., N and Zk and Xk are the Pauli matrices acting on the kth qubit. With this, the fidelity is lower bounded by\n\u220f S S \u2265 1 +\n2 +\n1 + 2\n\u2212 1. (9)N k\nk(GHZ) 1 (GHZ)\n\u22652\n(GHZ)\nF\nWitnessing cluster states entanglement A lower bound for the fidelity can be derived in a similar fashion for one-dimensional cluster states36. With the set of stabilizers Sk as defined in the main text, the bound is given by the inequality\nF \u220f \u220f S S \u2265 1 +\n2 +\n1 + 2\n\u2212 1 (10)N k\nk\nk\nk(C)\neven odd\nIt is easy to verify by direct calculation that the terms for even and odd k in equation\u00a0(10) correspond to the local measurement settings ZXZX... and XZXZ..., respectively. As an example, for a four-qubit linear cluster state, we have\nZ X Z Z X\nX Z Z X Z\n\u2265 1 4 (1 + ) (1 + ) + 1 4 (1 + ) (1 + ) \u22121.\n(11)\n4 (C)\n1 2 3 3 4\n1 2 2 3 4\nF"
        },
        {
            "heading": "Coherence and dynamical decoupling",
            "text": "In the main text, we already highlighted that our system benefits from a built-in dynamical decoupling mechanism owing to the level structure"
        },
        {
            "heading": "Article",
            "text": "of the atomic hyperfine ground states. A measurement of the intrinsic coherence time of the atom can be seen in Extended Data Fig.\u00a03a. Here we look at the overlap between two photons both emitted from the atom with a variable time delay. The first photon is measured in the linear basis ( H V\u27e9/ \u27e9\u2223 \u2223 ), which projects the atom onto a superposition of the qubit states \u22231, +1\u27e9 and 1, \u22121\u27e9\u2223 . The atomic state then precesses with twice the Larmor frequency. After a certain time t, the atomic qubit is read out by mapping it onto a photon, which is then measured in the same basis as the first photon. The fidelity, which we define as the projection of the second photon on the first, shows oscillations damped by noise, such as magnetic field fluctuations. After roughly 1.2 ms, the envelope of the oscillations crosses the classical threshold of 0.66, which defines the intrinsic coherence time of the atomic qubit. For the GHZ sequence however, we observe that the effect of decoherence is intrinsically reduced. We can show this by artificially extending the length of the sequence to 1.25 ms for a six-photon GHZ state. In this case, every photon production cycle takes 300 \u03bcs. The ratio of time that the qubit resides in F = 1\u27e9\u2223 and F = 2\u27e9\u2223 can then be varied by scanning the delay \u03c4 between the hyperfine transfer from 1, \u00b11\u27e9\u2223 to \u22232, \u00b12\u27e9 and the vSTIRAP control pulse, as illustrated in Extended Data Fig.\u00a03b. For different values of \u03c4, we record the parity oscillations similar to Fig.\u00a02a and infer the visibility. From the measured data, we can see a clear dependence of the visibility as a function of \u03c4, with a rephasing appearing at around 85 \u03bcs. The maximum value is roughly equal to the six-photon coherence shown in Fig.\u00a02 (shown as a dashed line for reference), for which the sequence length was only 250 \u03bcs. This is strong evidence that a large part of the decoherence is mitigated as an inherent feature of the protocol."
        },
        {
            "heading": "Data availability",
            "text": "The datasets generated and/or analysed during the current study are available at https://doi.org/10.5281/zenodo.6598546. Further information is available from the corresponding author on reasonable request. Acknowledgements The authors thank A. S\u00f8rensen for valuable discussions. This work was supported by the Bundesministerium f\u00fcr Bildung und Forschung through the Verbund QR.X (16KISQ019), by the Deutsche Forschungsgemeinschaft under Germany\u2019s Excellence Strategy - EXC-2111 - 390814868 and by the European Union\u2019s Horizon 2020 research and innovation programme through the project Quantum Internet Alliance (QIA, grant agreement no. 820445). Author contributions All authors contributed to the experiment, analysis of the results and writing of the manuscript. Funding Open access funding provided by Max Planck Society. Competing interests The authors declare no competing interests. Additional information Correspondence and requests for materials should be addressed to Philip Thomas. Peer review information Nature thanks Ofer Firstenberg, Peter Lodahl and Valentina Parigi for their contribution to the peer review of this work. Peer reviewer reports are available. Reprints and permissions information is available at http://www.nature.com/reprints.\nExtended Data Fig. 1 | Detailed experimental sequence. As in Fig.\u00a01c, the sequence is divided into initialization, cycling and closing. After each run, we perform several hundreds of microseconds of active power stabilization of\nlaser pulses, as well as atom cooling. The sequence shown takes up to 3 ms, depending on the number of photons and the type of photonic state (GHZ or cluster)."
        },
        {
            "heading": "Article",
            "text": "Extended Data Fig. 2 | Parity oscillations. Complete dataset for the GHZ coherence measurements for all measured photon numbers N.\nExtended Data Fig. 3 | Coherence properties of the emitter. a, Intrinsic memory coherence measured as the overlap between two photons emitted from the atom with a variable delay. The inset shows a zoom of the oscillations owing to the time evolution of the atomic qubit states. The arrow shows the sequence length for the data taken in b. b, Visibility of parity oscillations for a\nsix-photon GHZ state as a function of temporal delay \u03c4 between the hyperfine remapping and the vSTIRAP control pulse. As a model is difficult to obtain for an unknown noise spectrum, a Gaussian fit to the data (solid line) provides a guide to the eye. A maximum of the visibility can be observed for around 85 \u03bcs."
        },
        {
            "heading": "Article",
            "text": "Extended Data Fig. 4 | Infidelity induced by the vSTIRAP process. Two photons are generated in subsequent cycles of the GHZ protocol and measured in the R/L basis. Their correlation (red) is analysed as a function of maximum permitted arrival time tmax with respect to the beginning of the emission process. The relative efficiency (blue) shows the number of counts detected up to tmax, as opposed to the full photonic wave packet. The correlation decreases as a function of tmax, which we attribute to spontaneous scattering events induced by the vSTIRAP control pulse. The dashed line marks the value of tmax used in this work."
        }
    ],
    "title": "Efficient generation of entangled multiphoton graph states from a single atom",
    "year": 2022
}