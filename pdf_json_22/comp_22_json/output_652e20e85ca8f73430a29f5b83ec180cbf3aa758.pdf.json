{
    "abstractText": "Johannes Kruse , 2 Eike Cramer , Benjamin Sch\u00e4fer , and Dirk Witthaut 1, 2, \u2217 Forschungszentrum J\u00fclich, Institute for Energy and Climate Research (IEK-STE), 52428 J\u00fclich, Germany Institute for Theoretical Physics, University of Cologne, K\u00f6ln, 50937, Germany Forschungszentrum J\u00fclich GmbH, Institute of Energy and Climate Research, Energy Systems Engineering (IEK-10), J\u00fclich 52428, Germany Institute for Automation and Applied Informatics, Karlsruhe Institute of Technology, 76344 Eggenstein-Leopoldshafen, Germany (Dated: November 4, 2022)",
    "authors": [
        {
            "affiliations": [],
            "name": "Johannes Kruse"
        },
        {
            "affiliations": [],
            "name": "Eike Cramer"
        },
        {
            "affiliations": [],
            "name": "Benjamin Sch\u00e4fer"
        },
        {
            "affiliations": [],
            "name": "Dirk Witthaut"
        }
    ],
    "id": "SP:f24dfcd3b97e85126f8fb380ab47947172d8a9db",
    "references": [
        {
            "authors": [
                "J. Rockstr\u00f6m",
                "O. Gaffney",
                "J. Rogelj",
                "M. Meinshausen",
                "N. Nakicenovic",
                "H.J. Schellnhuber"
            ],
            "title": "A roadmap for rapid decarbonization",
            "venue": "Science 355, 1269 ",
            "year": 2017
        },
        {
            "authors": [
                "J. Rogelj",
                "G. Luderer",
                "R.C. Pietzcker",
                "E. Kriegler",
                "M. Schaeffer",
                "V. Krey"
            ],
            "title": "and K",
            "venue": "Riahi, Energy system transformations for limiting end-of-century warming to below 1.5 \u00b0C, Nature Climate Change 5, 519 ",
            "year": 2015
        },
        {
            "authors": [
                "I. Staffell",
                "S. Pfenninger"
            ],
            "title": "The increasing impact of weather on electricity supply and demand",
            "venue": "Energy 145, 65 ",
            "year": 2018
        },
        {
            "authors": [
                "A. Orths",
                "C.L. Anderson",
                "T. Brown",
                "J. Mulhern",
                "D. Pudjianto",
                "B. Ernst",
                "O. Mark",
                "J. McCalley",
                "G. Strbac"
            ],
            "title": "Flexibility from energy systems integration: Supporting synergies among sectors",
            "venue": "IEEE Power and Energy Magazine 17, 67 ",
            "year": 2019
        },
        {
            "authors": [
                "D. Witthaut",
                "F. Hellmann",
                "J. Kurths",
                "S. Kettemann",
                "H. Meyer-Ortmanns",
                "M. Timme"
            ],
            "title": "Collective nonlinear dynamics and self-organization in decentralized power grids",
            "venue": "Rev. Mod. Phys. 94, 015005 ",
            "year": 2022
        },
        {
            "authors": [
                "D. Heide"
            ],
            "title": "L",
            "venue": "von Bremen, M. Greiner, C. Hoffmann, M. Speckmann, and S. Bofinger, Seasonal optimal mix of wind and solar power in a future, highly renewable Europe, Renewable Energy 35, 2483 ",
            "year": 2010
        },
        {
            "authors": [
                "S. Collins",
                "P. Deane",
                "B.\u00d3. Gallach\u00f3ir",
                "S. Pfenninger",
                "I. Staffell"
            ],
            "title": "Impacts of Inter-annual Wind and Solar Variations on the European Power System",
            "venue": "Joule 2, 2076 ",
            "year": 2018
        },
        {
            "authors": [
                "J. Lin",
                "F.H. Magnago"
            ],
            "title": "Electricity Markets: Theories and Applications",
            "year": 2017
        },
        {
            "authors": [
                "M. Anvari",
                "E. Proedrou",
                "B. Sch\u00e4fer",
                "C. Beck",
                "H. Kantz",
                "M. Timme"
            ],
            "title": "Data-driven load profiles and the dynamics of residential electricity consumption",
            "venue": "Nature Communications 13, 4593 ",
            "year": 2022
        },
        {
            "authors": [
                "C. Han",
                "H. Hilger",
                "E. Mix",
                "P.C. B\u00f6ttcher",
                "M. Reyers",
                "C. Beck",
                "D. Witthaut",
                "L.R. Gorj\u00e3o"
            ],
            "title": "Complexity and persistence of price time series of the european electricity spot market",
            "venue": "PRX Energy 1, 013002 ",
            "year": 2022
        },
        {
            "authors": [
                "J. Machowski",
                "J. Bialek"
            ],
            "title": "and J",
            "venue": "Bumby, Power System Dynamics: Stability and Control ",
            "year": 2008
        },
        {
            "authors": [
                "F. Milano",
                "F. D\u00f6rfler",
                "G. Hug",
                "D.J. Hill",
                "G. Verbic"
            ],
            "title": "Foundations and Challenges of Low-Inertia Systems (Invited Paper)",
            "venue": "2018 Power Systems Computation Conference (PSCC) ",
            "year": 2018
        },
        {
            "authors": [
                "P. Vorobev",
                "D.M. Greenwood",
                "J.H. Bell",
                "J.W. Bialek",
                "P.C. Taylor",
                "K. Turitsyn"
            ],
            "title": "Deadbands",
            "venue": "Droop, and Inertia Impact on Power System Frequency Distribution, IEEE Transactions on Power Systems 34, 3098 ",
            "year": 2019
        },
        {
            "authors": [
                "L.R. Gorj\u00e3o",
                "M. Anvari",
                "H. Kantz",
                "C. Beck",
                "D. Witthaut",
                "M. Timme",
                "B. Sch\u00e4fer"
            ],
            "title": "Data-driven model of the power-grid frequency dynamics",
            "venue": "IEEE Access 8, 43082 ",
            "year": 2020
        },
        {
            "authors": [
                "D. Kraljic"
            ],
            "title": "Towards realistic statistical models of the grid frequency",
            "venue": "IEEE Transactions on Power Systems (in press) ",
            "year": 2022
        },
        {
            "authors": [
                "F. Guo",
                "D. Schlipf"
            ],
            "title": "A Spectral Model of Grid Frequency for Assessing the Impact of Inertia Response on Wind Turbine Dynamics",
            "venue": "Energies 14, 2492 ",
            "year": 2021
        },
        {
            "authors": [
                "M. Mart\u0301\u0131nez-Barbeito",
                "D. Gomila",
                "P. Colet"
            ],
            "title": "Dynamical model for power grid frequency fluctuations: Application to islands with high penetration of wind generation, Preprint at https: //ifisc.uib-csic.es/en/publications/dynamicalmodel-for-power-grid-frequency-fluctuati/ (2022)",
            "year": 2022
        },
        {
            "authors": [
                "L. Hirth",
                "J. M\u00fchlenpfordt",
                "M. Bulkeley"
            ],
            "title": "The ENTSO-E Transparency Platform \u2013 A review of Europe\u2019s most ambitious electricity data platform",
            "venue": "Applied Energy 225, 1054 ",
            "year": 2018
        },
        {
            "authors": [
                "G.E. Karniadakis",
                "I.G. Kevrekidis",
                "L. Lu",
                "P. Perdikaris",
                "S. Wang",
                "L. Yang"
            ],
            "title": "Physics-informed machine learning",
            "venue": "Nature Reviews Physics 3, 422 ",
            "year": 2021
        },
        {
            "authors": [
                "G. Carleo",
                "I. Cirac",
                "K. Cranmer",
                "L. Daudet",
                "M. Schuld",
                "N. Tishby",
                "L. Vogt-Maranto",
                "L. Zdeborov\u00e1"
            ],
            "title": "Machine learning and the physical sciences",
            "venue": "Reviews of Modern Physics 91, 045002 ",
            "year": 2019
        },
        {
            "authors": [
                "J. Zhao",
                "A. G\u00f3mez-Exp\u00f3sito",
                "M. Netto",
                "L. Mili",
                "A. Abur",
                "V. Terzija",
                "I. Kamwa",
                "B. Pal",
                "A.K. Singh",
                "J. Qi",
                "Z. Huang",
                "A.P.S. Meliopoulos"
            ],
            "title": "Power System Dynamic State Estimation: Motivations",
            "venue": "Definitions, Methodologies, and Future Work, IEEE Transactions on Power Systems 34, 3188 ",
            "year": 2019
        },
        {
            "authors": [
                "L. Ljung"
            ],
            "title": "Perspectives on system identification",
            "venue": "Annual Reviews in Control 34, 1 ",
            "year": 2010
        },
        {
            "authors": [
                "J. Stiasny",
                "G.S. Misyris",
                "S. Chatzivasileiadis"
            ],
            "title": "Physics-Informed Neural Networks for Non-linear System Identification for Power System Dynamics",
            "venue": "2021 IEEE Madrid PowerTech ",
            "year": 2021
        },
        {
            "authors": [
                "S.M. Lundberg",
                "G. Erion",
                "H. Chen",
                "A. DeGrave",
                "J.M. Prutkin",
                "B. Nair",
                "R. Katz",
                "J. Himmelfarb",
                "N. Bansal",
                "S.-I. Lee"
            ],
            "title": "From local explanations to global understanding with explainable AI for trees",
            "venue": "Nature Machine Intelligence 2, 56 ",
            "year": 2020
        },
        {
            "authors": [
                "J. Kruse",
                "B. Sch\u00e4fer",
                "D. Witthaut"
            ],
            "title": "Revealing drivers and risks for power grid frequency stability with explainable AI",
            "venue": "Patterns 2, 100365 ",
            "year": 2021
        },
        {
            "authors": [
                "J. Kruse",
                "E. Cramer",
                "B. Sch\u00e4fer"
            ],
            "title": "and D",
            "venue": "Witthaut, Physics-inspired machine learning for power grid frequency modelling (v0.1.0), https://doi.org/10.5281/ zenodo.7274829 ",
            "year": 2022
        },
        {
            "authors": [
                "J. Kruse",
                "E. Cramer",
                "B. Sch\u00e4fer",
                "D. Witthaut"
            ],
            "title": "Supplementary data: \u201dPhysics-inspired machine learning for power grid frequency modelling",
            "venue": "https://doi.org/ 10.5281/zenodo.7273665 ",
            "year": 2022
        },
        {
            "authors": [
                "T. Weissbach",
                "E. Welfonder"
            ],
            "title": "High frequency deviations within the European Power System: Origins and proposals for improvement",
            "venue": "2009 IEEE/PES Power Systems Conference and Exposition ",
            "year": 2009
        },
        {
            "authors": [
                "J. Kruse",
                "B. Sch\u00e4fer",
                "D. Witthaut"
            ],
            "title": "Exploring deterministic frequency deviations with explainable AI",
            "venue": "2021 IEEE International Conference on Communications, Control, and Computing Technologies for Smart Grids (SmartGridComm) ",
            "year": 2021
        },
        {
            "authors": [
                "J. Kruse",
                "B. Sch\u00e4fer",
                "D. Witthaut"
            ],
            "title": "Secondary control activation analysed and predicted with explainable AI",
            "venue": "Electric Power Systems Research 212, 108489 ",
            "year": 2022
        },
        {
            "authors": [
                "S. P\u00fctz",
                "B. Sch\u00e4fer",
                "D. Witthaut",
                "J. Kruse"
            ],
            "title": "Revealing interactions between HVDC cross-area flows and frequency stability with explainable AI",
            "venue": "Preprint at https: //arxiv.org/abs/2204.10727 ",
            "year": 2022
        },
        {
            "authors": [
                "J. Kruse",
                "B. Sch\u00e4fer",
                "D. Witthaut"
            ],
            "title": "Pre-Processed Power Grid Frequency Time Series",
            "venue": "https://doi.org/ 10.5281/zenodo.5105820 ",
            "year": 2020
        },
        {
            "authors": [
                "P. Mehta",
                "M. Bukov",
                "C.-H. Wang",
                "A.G.R. Day",
                "C. Richardson",
                "C.K. Fisher",
                "D.J. Schwab"
            ],
            "title": "A highbias",
            "venue": "low-variance introduction to Machine Learning for physicists, Physics Reports A High-Bias, Low-Variance Introduction to Machine Learning for Physicists, 810, 1 ",
            "year": 2019
        },
        {
            "authors": [
                "X. Glorot",
                "Y. Bengio"
            ],
            "title": "Understanding the difficulty of training deep feedforward neural networks",
            "venue": "Proceedings of the Thirteenth International Conference on Artificial Intelligence and Statistics ",
            "year": 2010
        },
        {
            "authors": [
                "S.M. Lundberg",
                "S.-I. Lee"
            ],
            "title": "A unified approach to interpreting model predictions",
            "venue": "Proceedings of the 31st International Conference on Neural Information Processing Systems, NIPS\u201917 ",
            "year": 2017
        },
        {
            "authors": [
                "M. Abadi",
                "P. Barham",
                "J. Chen",
                "Z. Chen",
                "A. Davis",
                "J. Dean",
                "M. Devin",
                "S. Ghemawat",
                "G. Irving"
            ],
            "title": "M",
            "venue": "Isard, et al., TensorFlow: a system for Large-Scale machine learning, in 12th USENIX symposium on operating systems design and implementation (OSDI 16) ",
            "year": 2016
        },
        {
            "authors": [
                "J.V. Dillon",
                "I. Langmore",
                "D. Tran",
                "E. Brevdo",
                "S. Vasudevan",
                "D. Moore",
                "B. Patton",
                "A. Alemi",
                "M. Hoffman",
                "R.A. Saurous"
            ],
            "title": "TensorFlow Distributions",
            "venue": "Preprint at https://arxiv.org/abs/1711.10604 ",
            "year": 2017
        },
        {
            "authors": [
                "M. Anvari",
                "L.R. Gorj\u00e3o",
                "M. Timme",
                "D. Witthaut",
                "B. Sch\u00e4fer",
                "H. Kantz"
            ],
            "title": "Stochastic properties of the frequency dynamics in real and synthetic power grids",
            "venue": "Physical review research 2, 013339 ",
            "year": 2020
        },
        {
            "authors": [
                "H. Haehne",
                "J. Schottler",
                "M. Waechter",
                "J. Peinke",
                "O. Kamps"
            ],
            "title": "The footprint of atmospheric turbulence in power grid frequency measurements",
            "venue": "EPL (Europhysics Letters) 121, 30001 ",
            "year": 2018
        },
        {
            "authors": [
                "E. Cramer",
                "L.R. Gorj\u00e3o",
                "A. Mitsos",
                "B. Sch\u00e4fer",
                "D. Witthaut",
                "M. Dahmen"
            ],
            "title": "Validation Methods for Energy Time Series Scenarios From Deep Generative Models",
            "venue": "IEEE Access 10, 8194 ",
            "year": 2022
        },
        {
            "authors": [
                "E. Cramer",
                "L. Paeleke",
                "A. Mitsos",
                "M. Dahmen"
            ],
            "title": "Normalizing flow-based day-ahead wind power scenario generation for profitable and reliable delivery commitments by wind farm operators",
            "venue": "Computers & Chemical Engineering 166, 107923 ",
            "year": 2022
        },
        {
            "authors": [
                "B. Sch\u00e4fer",
                "C. Beck",
                "K. Aihara",
                "D. Witthaut",
                "M. Timme"
            ],
            "title": "Non-Gaussian power grid frequency fluctuations characterized by L\u00e9vy-stable laws and superstatistics",
            "venue": "Nature Energy 3, 119 ",
            "year": 2018
        },
        {
            "authors": [
                "J. Kruse",
                "B. Sch\u00e4fer",
                "D. Witthaut"
            ],
            "title": "Predictability of Power Grid Frequency",
            "venue": "IEEE Access 8, 149435 ",
            "year": 2020
        },
        {
            "authors": [
                "W. Bang",
                "J.W. Yoon"
            ],
            "title": "Forecasting the Electric Network Frequency Signals on Power Grid",
            "venue": "2019 International Conference on Information and Communication Technology Convergence (ICTC) ",
            "year": 2019
        },
        {
            "authors": [
                "J. Dong",
                "X. Ma",
                "S. Djouadi",
                "H. Li",
                "Y. Liu"
            ],
            "title": "Frequency Prediction of Power Systems in FNET Based on State- Space Approach and Uncertain Basis Functions",
            "venue": "IEEE Transactions on Power Systems 29, 2602 ",
            "year": 2014
        },
        {
            "authors": [
                "S. Kaur",
                "S. Agrawal",
                "Y.P. Verma"
            ],
            "title": "Power Grid Frequency Prediction Using ANN Considering the Stochasticity of Wind Power",
            "venue": "2013 5th International Conference and Computational Intelligence and Communication Networks ",
            "year": 2013
        },
        {
            "authors": [
                "S. Homan",
                "N. Mac Dowell",
                "S. Brown"
            ],
            "title": "Grid frequency volatility in future low inertia scenarios: Challenges and mitigation options",
            "venue": "Applied Energy 290, 116723 ",
            "year": 2021
        },
        {
            "authors": [
                "S. Chatzivasileiadis",
                "A. Venzke",
                "J. Stiasny",
                "G. Misyris"
            ],
            "title": "Machine Learning in Power Systems: Is It Time to Trust It",
            "venue": "IEEE Power and Energy Magazine 20, 32 ",
            "year": 2022
        },
        {
            "authors": [
                "G.S. Misyris",
                "A. Venzke",
                "S. Chatzivasileiadis"
            ],
            "title": "Physics-Informed Neural Networks for Power Systems",
            "venue": "2020 IEEE Power Energy Society General Meeting (PESGM) ",
            "year": 2020
        },
        {
            "authors": [
                "M. Raissi",
                "P. Perdikaris",
                "G.E. Karniadakis"
            ],
            "title": "Physicsinformed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations",
            "venue": "Journal of Computational Physics 378, 686 ",
            "year": 2019
        },
        {
            "authors": [
                "B. Huang",
                "J. Wang"
            ],
            "title": "Applications of Physics-Informed Neural Networks in Power Systems - A Review",
            "venue": "IEEE Transactions on Power Systems (in press) ",
            "year": 2022
        },
        {
            "authors": [
                "A. Ulbig",
                "T.S. Borsche",
                "G. Andersson"
            ],
            "title": "Impact of Low Rotational Inertia on Power System Stability and Operation",
            "venue": "IFAC Proceedings Volumes 19th IFAC World Congress, 47, 7290 ",
            "year": 2014
        },
        {
            "authors": [
                "E. Weitenberg",
                "Y. Jiang",
                "C. Zhao",
                "E. Mallada",
                "C. De Persis",
                "F. D\u00f6rfler"
            ],
            "title": "Robust Decentralized Secondary Frequency Control in Power Systems: Merits and Tradeoffs",
            "venue": "IEEE Transactions on Automatic Control 64, 3967 ",
            "year": 2019
        },
        {
            "authors": [
                "P.C. B\u00f6ttcher",
                "A. Otto",
                "S. Kettemann",
                "C. Agert"
            ],
            "title": "Time delay effects in the control of synchronous electricity grids",
            "venue": "Chaos: An Interdisciplinary Journal of Nonlinear Science 30, 013122 ",
            "year": 2020
        },
        {
            "authors": [
                "L. Hirth",
                "I. Ziegenhagen"
            ],
            "title": "Balancing power and variable renewables: Three links",
            "venue": "Renewable and Sustainable Energy Reviews 50, 1035 ",
            "year": 2015
        },
        {
            "authors": [
                "C.W. Gardiner"
            ],
            "title": "Handbook of stochastic methods",
            "venue": "Vol. 3 ",
            "year": 2009
        },
        {
            "authors": [
                "B. \u00d8ksendal"
            ],
            "title": "Stochastic Differential Equations",
            "venue": "Universitext ",
            "year": 2003
        }
    ],
    "sections": [
        {
            "text": "Physics-inspired machine learning for power grid frequency modelling\nJohannes Kruse ,1, 2 Eike Cramer ,3 Benjamin Scha\u0308fer ,4 and Dirk Witthaut 1, 2, \u2217\n1Forschungszentrum Ju\u0308lich, Institute for Energy and Climate Research (IEK-STE), 52428 Ju\u0308lich, Germany 2Institute for Theoretical Physics, University of Cologne, Ko\u0308ln, 50937, Germany\n3Forschungszentrum Ju\u0308lich GmbH, Institute of Energy and Climate Research, Energy Systems Engineering (IEK-10), Ju\u0308lich 52428, Germany 4Institute for Automation and Applied Informatics, Karlsruhe Institute of Technology, 76344 Eggenstein-Leopoldshafen, Germany\n(Dated: November 4, 2022)\nThe operation of power systems is affected by diverse technical, economic and social factors. Social behaviour determines load patterns, electricity markets regulate the generation and weatherdependent renewables introduce power fluctuations. Thus, power system dynamics must be regarded as a non-autonomous system whose parameters vary strongly with time. However, the external driving factors are usually only available on coarse scales and the actual dependencies of the dynamic system parameters are generally unknown. Here, we propose a physics-inspired machine learning model that bridges the gap between large-scale drivers and short-term dynamics of the power system. Integrating stochastic differential equations and artificial neural networks, we construct a probabilistic model of the power grid frequency dynamics in Continental Europe. Its probabilistic prediction outperforms the daily average profile, which is an important benchmark. Using the integrated model, we identify and explain the parameters of the dynamical system from the data, which reveals their strong time-dependence and their relation to external drivers such as wind power feed-in and fast generation ramps. Finally, we generate synthetic time series from the model, which successfully reproduce central characteristics of the grid frequency such as their heavy-tailed distribution. All in all, our work emphasises the importance of modelling power system dynamics as a stochastic non-autonomous system with both intrinsic dynamics and external drivers.\nI. INTRODUCTION\nMitigation of climate change requires a comprehensive transformation of our economy and lifestyle, in particular the way we generate and utilise electric power [1, 2]. Power plants based on fossil fuels must be replaced by renewable sources such as wind and solar power, which are volatile and uncertain [3]. Various sectors are being integrated, for instance through electric heatpumps [4], introducing numerous new interdependencies and increasing system complexity. The electric power system is at the heart of this transformation. Hence, understanding risks and guaranteeing stability of the electric power system is critical amidst far-reaching challenges [5].\nPower system operation is determined by various technical, economic and social influences and perturbations. Power generation from renewable sources is essentially determined by the weather [6, 7], while the dispatch of conventional power plants is determined on various electricity markets [8]. Moreover, the load depends on the decisions and actions of millions of consumers [9]. As the power grid does not store electric energy, generation and load must be balanced at all times. On long time scales of hours, this is achieved by trading on electricity markets [10]. On short time scales of seconds and minutes, several layers of control reserves balance the grid, e.g., to counteract unforeseen perturbations and forecasting errors [11]. The activation of these reserves is mainly\n\u2217 d.witthaut@fz-juelich.de\ncontrolled by the grid frequency, which directly monitors the power imbalance: A scarcity of generation leads to a drop of the frequency, which is easily monitored anywhere in the grid. The stability of this load-frequency control system is challenged by the energy transformation, as the effective inertia of the grid decreases making the frequency more susceptible to perturbations [12].\nThe realistic modelling of frequency dynamics in largescale power systems is profitable but complex due to its non-autonomous character. Stochastic dynamical models have successfully reproduced central characteristics of frequency measurements such as their non-standard distributions [13\u201315]. Such models can be used to generate synthetic frequency time series, which are, for example, employed to optimise electric devices [16]. Moreover, they can be used to explore dynamics under different operating conditions, e.g., with an increased wind power generation [17]. However, multiple technical, economic and social influences and perturbations shape power system dynamics, as explained above. As a consequence, the power system must be regarded as a stochastic nonautonomous dynamical system, which makes grid frequency modelling a daunting task.\nIn this context, the data-driven representation of external drivers can greatly facilitate realistic models, but data assimilation is challenging due to insufficient data sources. Integrating actual load time series can improve stochastic models of grid frequency dynamics in Continental Europe [14]. The assimilation of load and generation data enabled an accurate reproduction of grid frequency recordings for the Gran Canaria island [17]. However, load and generation time series are typically\nar X\niv :2\n21 1.\n01 48\n1v 1\n[ ee\nss .S\nY ]\n2 N\nov 2\n02 2\n2 only available at hourly time scales [18], while frequency dynamics happen at much smaller time scales, thus requiring a careful adoption of these external drivers. For large-scale power systems such as the Continental European grid, the data is often incomplete with missing or unrealistic data points [19]. The physical model is uncertain as for example control schemes vary among local control zones and detailed setups are not publicly available [20]. Finally, important dynamical parameters such as the inertia cannot be calculated exactly due to scarce time series on the power plant level [21].\nIn this work, we propose physics-inspired machine learning (PIML) to approach these challenges. Compared to numerical simulations, PIML models can perform better in solving ill-posed problems with noisy insufficient data and imperfect physical models [22, 23]. Moreover, they can better generalise from small amounts of data than common machine learning methods, and they efficiently solve inverse problems of differential equations in situations with insufficient data or incomplete models [22]. Notably, inverse problems are particularly important for power system control to estimate hidden states or dynamical parameters from measurements [24]. The inverse problem of inferring system parameters from input/output data is known as system identification [25] and PIML models offer a promising tool for such applications [26].\nIn particular, we develop a PIML model for the loadfrequency dynamics of electric power systems, which includes proportional and integral controllers, stochastic noise and external techno-economic driving factors. The internal dynamics is described by a set of stochastic differential equations, which admit an analytic solution. The external driving is manifested through specific system parameters, which depend on a variety of technoeconomic features such as the generation mix. This dependency is deduced via a feed-forward artificial neural network (FFNN), which is trained on data of the Continental European power system in a maximum likelihood approach. Finally, we interpret our model with SHapely Additive eXplanation (SHAP) values [27, 28] to extract the dependency between dynamical parameters and techno-economic features. All in all, the model bridges the gap between the large-scale behaviour of interdependent energy systems and markets and the shortterm dynamics of the power system.\nThe article is organised as follows. In Sec. II we introduce the physics-inspired machine learning model for the grid frequency dynamics and discuss its implementation. In Sec. III we present and evaluate three model applications: probabilistic prediction, system identification and explanation, and generation of synthetic time series. Finally, we discuss our results as well as possible future directions in Sec. IV."
        },
        {
            "heading": "II. AN INTEGRATED MODEL FOR POWER SYSTEM LOAD-FREQUENCY DYNAMICS",
            "text": "Here, we present the details of how we constructed a physics-inspired model of the power grid frequency including a stochastic description of the frequency dynamics on coarse scales and the interaction with technoeconomic features. Furthermore, we interpret the model in terms of power system operation and discuss the implementation as an artificial neural network. The detailed implementation of our data preparation and model pipeline, as well as all input data and the results are available on Zenodo [29, 30]."
        },
        {
            "heading": "A. Short-term dynamics and control of the grid frequency",
            "text": "Our starting point is a stochastic model for the dynamics of the grid frequency as illustrated in Fig. 1a. The rate of change of the frequency at a time t is determined by the balance of power generation and load as well as the load-frequency control system (details are provided in appendix A 1). Denoting the deviation from the reference as \u03c9(t) = 2\u03c0(f(t)\u2212 fref), we have the equation of motion\nM d\u03c9\ndt = Pim(t) + Pnoise(t) + Pcontrol(t), (1)\nwhere M is the aggregated inertia constant. The power imbalance on the right-side has been decomposed into three contributions. The term Pim(t) denotes sustained power imbalances, for instance due to a mismatch of the load and the scheduled generation of dispatchable power pants (cf. Fig. 1b). For time intervals of a quarter-hour, we can approximate the time dependence of these imbalances by an affine linear function\nPim(t) = M \u00b7 (q + rt), (2)\nwhere q models the power step of scheduled generation and r represents the continuous drift of the load (cf. Fig. 1c). The term Pnoise(t) describes short-term fluctuations of the power balance, which we modelled as\nPnoise(t) = M \u00b7D \u00b7 \u03be(t), (3)\nwhere \u03be(t) is white noise with a standard normal distribution and D quantifies the strength of short-term power fluctuations. The term Pcontrol(t) denotes the balance of primary and secondary load-frequency control, which can be modelled by a proportional-integral law as\nPcontrol(t) = \u2212 M \u03c4 \u03c9(t)\u2212 M \u03ba2 \u222b t ti\n\u03c9(t\u2032) dt\u2032\ufe38 \ufe37\ufe37 \ufe38 =:\u03b8(t)\n(4)\nwith time constants \u03c4 and \u03ba. We note that some simplifications are necessary to keep the model tractable. For\n3 instance, Eq. (4) neglects the existence of a small deadband in the proportional control law.\nDue to the presence of noise, the equation of motion (1) must be interpreted as a stochastic differential equation (SDE) with the explicit form\nd\u03b8 dt = \u03c9 d\u03c9 dt = q + rt\u2212 \u03c9\u03c4\u22121 \u2212 \u03b8\u03ba\u22122 +D\u03be(t). (5)\nThe parameter \u03c4 quantifies the effective primary control time scale. Equation (5) resembles a driven harmonic oscillator with an eigenfrequency \u03ba, which can be interpreted as the intrinsic time scale of secondary control. In contrast, the effective time scale of secondary control is approximated by \u03c4/\u03ba2 [13], as the frequency decays with this time constant in the overdamped case [14]. Note that these are only effective parameters which were rescaled by the inertia M . For example, the actual primary control strength is M/\u03c4 (Eq. (4)). However, the whole model is invariant under a scaling of M (cf. appendix A 2) such that it is only possible to estimate the ratio of parameters and the inertia.\nApplying Ito\u0302\u2019s calculus, the SDE can be recast into a Fokker-Planck equation (FPE) of the probability density function P(\u03c9, \u03b8; t)\n\u2202 \u2202t P(\u03b8, \u03c9; t) = [ \u2212 \u2202 \u2202\u03c9 ( q + rt\u2212 \u03c4\u22121\u03c9 \u2212 \u03ba\u22122\u03b8 ) \u2212 \u2202 \u2202\u03b8 \u03c9 + D2 2 \u22022 \u2202\u03c92 ] P(\u03b8, \u03c9; t). (6)\nAs we show in appendix A 3, the FPE is solved by a multivariate Gaussian distribution\nP(x; t) = 1 2\u03c0|\u03a3| exp\n( \u22121\n2 (x\u2212 \u00b5)>\u03a3\u22121(x\u2212 \u00b5)\n) (7)\nwith x> = (\u03b8, \u03c9) and time-dependent parameters\n\u00b5(t) = ( \u00b5\u03b8(t) \u00b5\u03c9(t) ) , \u03a3(t) = ( \u03c32\u03b8(t) \u03c3\u03b8\u03c9(t) \u03c3\u03b8\u03c9(t) \u03c3 2 \u03c9(t) ) ,\nif the parameters satisfy the ordinary differential equations\nd dt \u00b5\u03b8 = \u00b5\u03c9 d dt \u00b5\u03c9 = q + rt\u2212 \u03c4\u22121\u00b5\u03c9 \u2212 \u03ba\u22122\u00b5\u03b8\nd dt \u03c32\u03b8 = 2\u03c3\u03b8\u03c9 d dt \u03c32\u03c9 = \u03c3\n2\u03c9 \u2212 \u03c4\u22121\u03c3\u03b8\u03c9 \u2212 \u03ba\u22122\u03c32\u03b8 d dt \u03c3\u03b8\u03c9 = \u22122\u03c4\u22121\u03c32\u03c9 \u2212 2\u03ba\u22122\u03c3\u03b8\u03c9 . (8)\nHere, \u00b5 and \u03c3 are the mean and standard deviation of the angle and the frequency deviation, while \u03c3\u03b8\u03c9 represents their covariance.\nIn appendix A 5, we solve the moment equations (8) analytically, thus solving the entire stochastic dynamic model, which vastly simplifies the analysis."
        },
        {
            "heading": "B. Power system operation and interdependecies",
            "text": "The SDE for the frequency dynamics in Eq. (5) contains several parameters, describing the load-frequency control system (\u03c4 , \u03ba), or the power imbalances on different time scales (r, q, D). The parameters are not constant, but change during the day. For instance, the market based scheduling of conventional power plants causes characteristic imbalances of generation and load [31, 32]. Electricity is traded on the spot markets in blocks of 15, 30 or 60 minutes, leading to characteristic patterns of the power imbalance Pim(t) illustrated in Fig. 1b,c. The shape of these patterns, as well as other properties of the power system, change in time due to the influence of a variety of techno-economic features.\nWe thus propose a model that integrates the internal dynamics of the frequency-control system, the stochastic noise, and the impact of various techno-economic features. In every 15 minute interval, the frequency is modelled by the SDE (5). The system parameters \u03c4 , \u03ba, D, r, q change from interval to interval, depending on the influence of external techno-economic features as detailed below. This dependence is modelled by a FFNN, that is trained such that the stochastic dynamics best fits the recorded time series. More precisely, the FFNN constitutes a parameter model FNN : X 7\u2192 \u03d1, where X summarises the values of techno-economic features (Fig. 1d). The vector \u03d1 includes the system parameters \u03c4 , \u03ba, D, r, q as well as the initial covariances \u03c3\u03c9\u03b8,0, \u03c3 2 \u03c9,0 and \u03c3 2 \u03b8,0 at time t = ti, while the initial means \u00b5\u03c9,0 and \u00b5\u03b8,0 are directly obtained from the data.\nWe thus establish a model that links different temporal and technological scales, from the slow evolution of electricity markets to the fast dynamics of the power grid frequency. The integrated model predicts a probability distribution P(\u03c9, \u03b8; t) for an entire interval of 15 minutes from techno-economic features."
        },
        {
            "heading": "C. Techno-economic features affecting power system dynamics and operation",
            "text": "As input features for the PIML model, we used several operational time series of the Continental European power system from the ENTSO-E Transparency platform [18]. Following ref. [28], we downloaded load forecasts, day-ahead scheduled generation, day-ahead forecast data for wind and solar power, day-ahead electricity prices, actual generation per type and actual load. In addition, we included pumped hydro consumption (cf. [33]), as well as net scheduled, i.e., market-based flows and net physical flows between Continental Europe and other synchronous areas (cf. [34]).\n4\nWe prepared the features for each 15 minute interval. This opens the possibility to capture the effects of intraday electricity markets that operate in 15 minute intervals, while the day-ahead electricity market typically acts every 60 minutes [8]. To this end, we determined the time resolution of each feature in each country, which can vary due to different market designs. Then, we upsampled 60 minute data using linear interpolation for load and renewable generation data, and forward padding for all other feature types.\nTo gain additional interpretable input data, we engineered physically meaningful features and aggregated the data area-wise (cf. [28, 33]). We included forecast errors (day-ahead minus actual), ramps (time derivative of a feature) and unscheduled flows (scheduled minus physical flows). Since all features are only available on country-\nlevel, the data was finally aggregated within the whole Continental European area to represent the aggregated impact on the grid frequency (the detailed implementation is available on Zenodo [29]).\nThe grid frequency recordings used in this work were taken from ref. [35], which provides pre-processed frequency data from the German transmission system operator TransnetBW [36]."
        },
        {
            "heading": "D. Artificial neural network model",
            "text": "The integrated model provides a probabilistic prediction of the power grid frequency for every 15-minute interval [ti, ti+1]. The architecture of the model is depicted in Fig. 1d.\n5 As input, we used the techno-economic features\nX(i) = (X1(i), ..., XN (i))\nT for each time interval [ti, ti+1]. In the first step, each featureXk was normalised using functions \u03b7k(Xk) = (Xk\u2212\u3008Xk\u3009)/\u03c3k to improve numeric stability, where \u3008\u00b7\u3009 denotes the average and \u03c3k the standard deviation of the feature.\nThe normalised features were fed into a FFNN of Nh hidden layers with Nu units and activation functions \u03d5. The last layer comprises a linear activation \u03bb, as we aim to predict real-valued parameters \u03d1.\nThe following layer rescales the output of the FFNN and implements several constraints. The rescaling was implemented to improve training efficiency and stability. After random initialisation, the outputs uj of the FFNN typically have the same scale, but the physical parameters do not. Such a mismatch will yield large initial errors along certain parameter axis leading to inhomogeneous loss landscapes which can make optimisation inefficient and more difficult [37]. This difficulty can be mitigated by a suitable rescaling. Furthermore, several output variables must respect physical constraints. For instance, the time constants \u03c4 and \u03ba must be positive and respect the inequality \u03ba \u2265 2\u03c4 to avoid an unphysical oscillation behaviour of the solution. Rescaling and constraints were implemented with parameter-specific functions \u03bdj(uj), which are described in appendix C.\nAfter rescaling, the output \u03d1(i) of the parameter model FNN was used to compute a probabilistic prediction of the grid frequency for the entire time interval [ti, ti+1] based on Eq. (7). The vector \u03d1(i) contains the system parameters as well as the covariances at t = ti, while the means \u00b5\u03c9,0 and \u00b5\u03b8,0 are directly taken from data. For training and forecasting applications, we used the actual value of the frequency \u00b5\u03c9,0(i) = \u03c9(ti) and esti-\nmated \u00b5\u03b8,0(i) = \u222b ti ti\u221260s \u03c9(t\n\u2032) dt\u2032. For the generation of synthetic time series, we predicted intervals sequentially in time and estimated \u00b5\u03c9,0 and \u00b5\u03b8,0 from the preceding prediction and not from the data."
        },
        {
            "heading": "E. Training, testing and interpretation",
            "text": "Our complete data set comprises 107650 data points from 2015 to 2019. In particular, it includes features X(i) and frequency time series \u03c9(i) = (\u03c9(ti), ..., \u03c9(ti + tmax))\nT for each interval i. To assess the timedependence of the performance, we modelled and predicted subsets of the 15 minute interval with tmax < 15 min (cf. Sec. III A), but the full interval (tmax = 15 min) was used in all other cases.\nWe quantified the ability of the model to predict the stochastic frequency dynamics by the negative loglikelihood. For a given time interval I = [ti, ti + tmax], the negative log-likelihood is defined as\nC(\u03c9(i),\u03d1(i)) = \u2212 \u2211 t\u2208I logP(\u03c9; t|\u03d1(i)), (9)\nwhere P (\u03c9; t|\u03d1) is the marginal of the PDF (7) evaluated at the measured data \u03c9(t). The log-likelihood is a negatively oriented metric, i.e., smaller values represent a better performance.\nTo train the FFNN, we initialised the weights using the Glorot uniform initialiser [38]. Using data from 2015 to 2017, we trained the weights with stochastic gradient descent using the ADAM optimiser with a fixed learning rate [37]. As a loss function we chose the negative loglikelihood (9), summed over all quarter-hour intervals in the training set. The model hyperparameters were optimised using random search on data from 2018 (as a validation set) and with parameter choices defined in Tab. I. In particular, we trained the model for 100 epochs and applied early stopping based on the validation loss. Then, we retrained the best model on data from 2015 to 2018 and evaluated the performance in terms of the negative log-likelihood on data from 2019 as a test set.\nWe benchmarked the developed model by comparing its performance to the daily profile of the grid frequency, which is defined as follows. For a fixed time of the day td, we collected all frequency values recorded on all days in the training set and calculated their average \u00b5p(td) and the corresponding standard deviation \u03c3p(td). Our daily profile model Pp returns a normal distribution Pp(\u03c9; t) = N (\u00b5p(td), \u03c3p(td)) based on the time of the day td(t) of the time step t. For example, the predicted mean \u00b5p(td) for January 11, 2019, at 11:00 equals the average of frequency values at 11:00 over all days in the training set. In addition to the daily profile, we applied the constant model as a benchmark, which simply provides a normal distribution using the global mean and variance of the whole frequency time series.\nFinally, we interpreted our parameter model FNN : X 7\u2192 \u03d1 with SHapely Additive eXplanation (SHAP) values [27], which attribute the prediction of a single parameter \u03d1j(i) to the impact of different features Xk(i). Aggregating individual SHAP values offers a tool to inspect feature importances and dependencies extracted by the FFNN. In particular, we used KernelSHAP [39], which approximates SHAP values for any machine learning model.\nOur FFNN model is implemented with tensorflow [40] and tensorflow probability [41] and we used keras tuner for hyperparameter optimisation [42].\n6"
        },
        {
            "heading": "III. MODEL APPLICATION AND EVALUATION",
            "text": "We demonstrate and evaluate three applications of our PIML model. First, it provides a probabilistic prediction of the grid frequency trajectory in each time interval, which we evaluate in terms of the performance and compare it to elementary benchmarks (Sec. III A). Second, the model infers time-dependent imbalance and control parameters based on the data, i.e., we can use it for system identification. We analyse their timedependence, compare our estimates with values from the literature and explain their dependency on technoeconomic features with SHAP values (Sec. III B). Third, our model provides a tool for generating synthetic frequency time series by drawing samples from the stochastic process. Such synthetic scenarios should reproduce central stochastic characteristics of the grid frequency, which we evaluate in Sec. III C."
        },
        {
            "heading": "A. Probabilistic prediction of the grid frequency",
            "text": "Our physics-inspired model provides a probabilistic prediction for unseen samples of the grid frequency. Its performance depends both on the length of the prediction and on the available set of features (Fig. 2).\nThe machine-learning model outperforms elementary benchmarks irrespective of the prediction horizon (Fig. 2a-d). Using all available techno-economic features, the full model yielded lower median loss values than the daily profile and the constant model for each prediction length tmax. Restricting the feature set to day-ahead available data yields a similar performance, which enables us to forecast future frequency deviations better than the daily profile.\nHowever, the performance slightly deteriorates with increasing prediction length (Fig. 2e). The absolute loglikelihood of different data sets, i.e., of different tmax values, cannot be compared. We therefore employed the relative loss increase between the machine learning model and the daily profile as a measure, which mainly exhibits negative values as our model outperforms the daily profile. Predicting only the first tmax = 360 seconds yielded a better performance then predicting the full interval (tmax = 900 s). This points to a potential limitation of our model at the end of the prediction interval, which is likely due to the approximate treatment of the power imbalance Pim(t) (cf. Fig. 1c). Our model assumes a discrete step at the start of an interval, while real power plants start ramping up or down continuously earlier at the end of the previous interval [20]. Hence, the frequency \u03c9(t) at the end of an interval is already driven by the dispatch in the future interval. This aspect is not included in the physics-inspired model, while it is present in the daily profile.\nThe prediction examples in Fig. 2f-i illustrate the strengths and limitations of our model. The intervals\nwith the best model performance at 00:00 and 06:00 demonstrate how our model outperforms the daily profile by far. A remarkable aspect is observed when inspecting the intervals with the worst performance: As the physicsinspired model fails to capture the dynamics, so does the daily profile, albeit at a different magnitude (Fig. 2g,i). The limitations of our model due to continuous generation ramps turned up in Fig. 2i: The frequency increased and then ramped down expectedly due to the rising load in the morning, which causes upwards deterministic frequency deviations. However, the frequency ramped up again towards the end of the interval, which is not covered in our model (see above), but slightly visible in the daily profile.\nIn the following sections, we explain dynamical parameters based on techno-economic features, among others. The full model better suits for explanation as it also includes actually measured features, such as forecast errors. Therefore, we only focus on the full model and predict the full interval (with tmax = 15 min) in following sections."
        },
        {
            "heading": "B. System identification and explanation",
            "text": ""
        },
        {
            "heading": "1. Inference and variation of system parameters",
            "text": "In addition to probabilistic prediction, our PIML model provides a tool to infer dynamical system parameters from frequency measurements and techno-economic features (Fig. 3). In contrast to time-independent models [14, 43], our parameter model FNN extracts timedependent system parameters \u03d1(i) for each time interval i, which mirror the local dynamical properties of loadfrequency control (cf. Fig. 1). Note that we only estimate effective parameters that also contain the impact of the inertia (cf. Sec. II), which we discuss later in Sec. IV.\nThe inferred parameters strongly change during the day, which illustrates the importance of time-dependent dynamical modelling (Fig. 3a-e). The daily profile of the primary control time scale shows variations of 14 %, while the intrinsic secondary control time scale varies by 16 %. The power imbalance parameters show even stronger variations, with the short-term fluctuation strength D varying by 61 % and the deterministic parameters q and r changing by 550 % and 442 %.\nThe imbalance parameters show distinct patterns that reveal physically meaningful impact factors on the grid frequency. We inferred upwards power steps q and negative drifts r in the morning around 06:00 and in the evening around 18:00, while the opposite behaviour was estimated around noon and during the night. This successfully models the deterministic imbalances between scheduled generation and continuous load: Around noon and during the night, the load is decreasing thus causing downward power steps and positive drifts (cf. Fig. 1b,c). Moreover, the inferred power steps q peak at the beginning of the hour, while being smaller during the rest of the hour. This indicates the dominance of generation\n7 Co nst ant\nDa ily\npro file\nDa y-a\nhea d Ful\nl\n\u2212600\n\u2212400\n\u2212200\n0\nN eg\n. lo\ng -l\nik el\nih o o d C( \u03c9 ,\u03d1\n) a tmax=360 s\nCo nst\nant\nDa ily\npro file\nDa y-a\nhea d Ful\nl\n\u2212800\n\u2212600\n\u2212400\n\u2212200\n0\nb tmax=540 s\nCo nst\nant\nDa ily\npro file\nDa y-a\nhea d Ful\nl\n\u22121000\n\u2212500\n0\nc tmax=720 s\nCo nst\nant\nDa ily\npro file\nDa y-a\nhea d Ful\nl\n\u22121000\n\u2212500\n0\nd tmax=900 s\n360 540 720 900\ntmax [s]\n\u22121.0\n\u22120.5\n0.0\n0.5\nR el\nat iv\ne lo\nss in\ncr ea\nse\ne\n00:00 00:15\n\u22120.25\n0.00\n\u03c9 [r\na d\n/ s]\nf Best performance\n00:00 00:15\n\u22120.5\n0.0\ng Worst performance\n06:00 06:15\nTime\n0.00\n0.25\n\u03c9 [r\nad /s\n]\nh\n06:00 06:15\nTime\n\u22120.5 0.0\ni\nchanges within 1 h intervals over changes in 15 min periods, which is consistent with the characteristics of the European electricity markets: In fact, much more generation volume is traded on the hourly day-ahead market then on the quarter-hourly intraday market in Europe [44].\nThe inferred parameters generally agree with estimates from the literature [14], with small differences due to redundancies between secondary control and deterministic deviations (Fig. 3f). The panel depicts the ratio between the time average of our absolute parameter estimates and the reference value from the literature \u03d1refj (cf. appendix B), which was extracted by a time-independent model. Our model (with standard scaling defined in appendix C), inferred values for \u03c4 and D that are very similar to the reference, i.e., the ratio to the reference is near one. The secondary control was weaker in our model (larger time scale) and the deterministic power mismatch was also weaker, i.e., our model inferred smaller absolute\ngeneration steps q and drifts r. As discussed in ref. [14], there is a redundancy between secondary control and deterministic power drifts, because both can drive the frequency back to its reference. This makes it generally difficult to obtain unique estimates, which might explain the difference to the literature values for \u03ba.\nThe adequate inference of dynamical parameters is greatly facilitated by our implementation of appropriate scaling steps. Fig. 3f depicts the parameter estimates if no scaling is applied (triangle markers), which resulted in much stronger deviations from the literature values. This is probably due to the large difference in scale between the parameters, which renders the FFNN training inefficient and unstable due to the very heterogeneous loss landscape [37]. Note that small variations of the scaling coefficients (defined in appendix C) did not strongly change the parameter estimates (square markers) such that the results seem to be independent of the exact choice of the scaling."
        },
        {
            "heading": "2. Techno-economic drivers of dynamical system properties",
            "text": "Using SHAP values [27], we explain the dependencies between the techno-economic features and the dynamical parameters \u03d1j , which the model extracted from the data (Fig. 4). Focusing on the deterministic mismatch parameters q and r and the primary control time scale \u03c4 , we analysed feature importances quantified by the mean absolute SHAP value (Fig. 4a), as well as dependencies (Fig. 4b-d) that display SHAP values for different feature values.\nThe power step q was mostly determined by generation ramps and forecast errors (Fig. 4a,b). The most important feature, forecast error generation ramp, represents the difference between day-ahead scheduled generation ramps (on a 1h basis) and actual values of the total generation ramps that also include intraday trading within 15 minute intervals. Therefore, they mirror the additional 15 minute ramps that are not included in the day-ahead generation ramps thus making the feature\nessential for the model to estimate the power steps q. In addition, it is known that especially fast generation ramps drive the power step and thus the rate of change of frequency (RoCoF) at the beginning of the market intervals [28]. Accordingly, the PIML model yielded a high importance of hydro power ramps, which are among the fastest in the European power system. Interestingly, positive ramps exhibited a smaller effect then negative ramps. This probably relates to the limitation of our model in representing upwards deterministic deviations. Upwards deviations typically start before the start of the interval (cf. Sec. III C), while downward ramps rather follow the approximation of a discrete power step at t = ti. Therefore, the remaining upward power step at ti represents only a part of the total step. Hence, the model sees a step which is smaller than for downwards deviations and thus assumes a weaker effect of positive hydro ramps on the step q.\nThe drift r of the deterministic mismatch mirrors continuous changes of the load (Fig. 1b,c). Consistently,\nload ramps obtained the highest feature importance for r with positive load ramps leading to negative slopes r (Fig. 4a,c). Solar ramps were also ranked highly, but their dependency showed the opposite behaviour. This mirrors the fact that in addition to the load, solar power also shapes the slow evolution of the deterministic mis-\nmatch Pim(t) \u223c r \u00b7 t [32]: The load and aggregated solar power typically change slowly and continuously on a time scale of hours, with the load having a negative impact and the solar power having a positive impact on the power imbalance. This perfectly manifests in the opposite effects of load and solar ramps on the mismatch slope\n10\nr, which were identified by our PIML model (Fig. 4c). The effective time scale of primary control \u03c4 was determined by load ramps, waste power generation and wind power (Fig. 4a,d). Most interestingly, increasing wind power generation led to a larger time scale of primary control. In an Ornstein-Uhlenbeck process, \u03c4 quantifies the time to revert back to the mean after a disturbance. A large wind power feed-in can cause large stochastic imbalances and thus effectively reduce the mean-reverting time \u03c4 . This would be consistent with our SHAP results and with previous studies that showed an increased variability of short-term frequency dynamics with increasing wind power feed-in [45]. Notably, this dependency cannot be caused by the rescaling of dynamical parameters with the inertia. If the actual primary control strength M/\u03c4 was constant (cf. Sec. II), increasing wind power, and thus decreasing inertia M , would correspond to decreasing values of \u03c4 . However, we observed the opposite: the dependency showed increasing values of \u03c4 (Fig. 4d), thus pointing to other causes such as an increased variability.\nFinally, note that the hour and minute features were very important, in particular for \u03c4 , \u03ba and D (Fig. 4a). This points to missing information in the feature set, so that the model relies on an average daily behaviour using the hour and minute features."
        },
        {
            "heading": "C. Generation of synthetic grid frequency time series",
            "text": "A third major application of probabilistic machine learning models is the generation of synthetic time series. Scenario generation, i.e., the generation of multiple synthetic samples from the model, is important for simulation or optimisation models [46, 47]. Given a data set of external features, synthetic time series are obtained as follows. For every interval i, we applied the FFNN to predict the system parameters \u03d1(i). We then integrated the original SDE (5) using a standard Euler-Maruyama method. To ensure continuity, we used the final values of \u03c9 and \u03b8 from one interval as initial states for the following interval. As a test case, we generated a synthetic trajectory from August 25 to September 05 in our test set, for which the first hours are shown in Fig. 5a.\nPower grid frequency trajectories exhibit several highly characteristic stochastic properties [48]: The distribution of both frequency \u03c9(t) and its increments \u2206\u03c9T (t) = \u03c9(t+ T )\u2212 \u03c9(t) is heavy tailed (Fig. 5b,c). Large deviations and large jumps are much more likely than expected from conventional normal statistics. Furthermore, the autocorrelation function peaks at multiples of a quarterhour, the smallest interval of electricity trading in Europe, which are most strongly pronounced after one hour (Fig. 5d). All these characteristic patterns were well reproduced by our PIML model.\nMoreover, the daily pattern strongly determines the grid frequency in Continental Europe [49]. Our synthetic\ntime series adequately reproduced this important pattern, especially during the evening and night (Fig. 5e,f). In particular, the samples captured the specific dynamics of August and September 2019 in contrast to the daily profile predictor, which predicts a strong downward ramp at 20:00. Upward frequency deviations, for example at 05:00 and 06:00 in the morning, are reproduced less accurately than negative deviations at 23:00 (Fig. 5g). Our model does not capture continuous (conventional) generation ramps that start before the beginning of the interval (cf. Sec. III A). These effects were particularly strong for upward ramps (e.g., at 05:50 in Fig. 5g) and less dominant for downward ramps (e.g., at 23:50 in Fig. 5e), which explains the model deviations in the morning interval.\nFurthermore, our results reveal important aspects of load-frequency dynamics and control. The success of our model suggests that the non-normal statistics is a direct consequence of the non-autonomous character of the power system. The changing system parameters induce heavy tails in the frequency distribution, without the need for heavy-tailed power fluctuations, cf. the discussion in [15, 48]."
        },
        {
            "heading": "IV. DISCUSSION",
            "text": "We have developed a model of power system operation that integrates both the internal system dynamics and the external techno-economic features. The integration has been achieved by the combination of an explicit simulation model in terms of stochastic differential equations, and an artificial neural network to link the external influences to the system parameters. We thus obtained a generic physics-inspired machine learning model of power system dynamics and control.\nUsing grid frequency recordings from the Continental European power grid as a test case, we demonstrated three applications of our physics-inspired model. First, we provided a probabilistic prediction of the grid frequency in intervals of 15 minutes. Our model outperformed the daily average profile of the grid frequency, which already is a good predictor in Continental Europe [28]. This was also possible when using only dayahead available techno-economic features, thus providing the possibility to forecast grid frequency dynamics 15 minutes ahead. Previous grid frequency predictors only used historic frequency data as inputs [49\u201351]. Approaches that integrated external features previously focused on aggregated frequency deviations [28, 52], which is also a cause of the data quality. Techno-economic features are typically available only on aggregated time scales of 15 min or 1h, while the frequency fluctuates on time scale of seconds (and even shorter time scales). We bridge the gap between large-scale techno-economic features and short-term frequency dynamics by using a physics-inspired model. It connects the time-aggregated features with dynamical parameters of a stochastic process that well describes the short term grid frequency\n11\nfluctuations.\nSecond, our model provides a tool for system identification and explanation. The model inferred the effective system parameters for every 15 minute interval from frequency measurements and techno-economic input features. The parameters were rescaled by the inertia (cf. Sec. II), but the actual system parameters can be obtained by incorporating inertia time series, which however can only be approximated for large-scale power systems [21, 53]. As an example, we extracted the timevarying nature of deterministic power imbalances, which\narises due to the step-wise evolution of scheduled conventional generation. The inferred power steps were particularly large for the first 15 minutes within the hour, which is consistent with the large share of generation traded at hourly day-ahead markets [44]. The strong time variation of the inferred parameters indicates the importance of modelling the grid frequency as a non-autonomous system with time-dependent parameters. Explaining the inferred parameters with SHAP values further revealed their dependency on techno-economic drivers. For example, the primary control time scale increased with rising\n12\nfeed-in of wind power, which are harder to control and thus effectively lead to longer relaxation times. Our tool therefore extracts and explains physically meaningful system parameters and their time-dependent drivers.\nThird, we used our model for scenario generation of synthetic grid frequency time series. The synthetic data well approximated the heavy-tailed distribution of frequency deviations and the recurrent patterns in its autocorrelation. In contrast to previous stochastic models [13\u201315], the synthetic time series also reproduced the actual frequency trajectory with its local time-dependent characteristics. Most interestingly, we only applied Gaussian white noise, but well reproduced the heavy-tailed distribution due to the time-dependent parameters of our stochastic model of power imbalance fluctuations and the control system. Notably, the model requires very little system specific information as inputs, but learns them directly from the data. Hence, the model is highly flexible and can easily be transferred to other grids.\nIn the context of power system dynamics and control, physics-inspired machine learning methods have become popular during the past years [54, 55]. Classical physicsinformed neural networks (PINNs) are commonly applied to the differential equations directly [56], which we circumvented by solving our system analytically. However,\nan analytical solution is not possible anymore when including non-linearities such as deadbands. In the future, our model can be modified to leverage classical PINNs to also treat non-linearities and more generic power system dynamics. Previous applications of PINNs to power system dynamics have successfully addressed autonomous dynamics [55, 57]. We contribute to these developments by proposing a model that explicitly models nonautonomous dynamics, which may greatly advance the application of physics-inspired machine learning in the energy sector."
        },
        {
            "heading": "ACKNOWLEDGEMENTS",
            "text": "This work was performed as part of the Helmholtz School for Data Science in Life, Earth and Energy (HDSLEE) and received funding from the Helmholtz Association of German Research Centres via the grant no. VH-NG-1727. We gratefully acknowledge support from the German Federal Ministry of Education and Research (BMBF grant no. 03EK3055B). This project has received funding from the European Union\u2019s Horizon 2020 research and innovation programme under the Marie Sk lodowska-Curie grant agreement No. 840825.\n[1] J. Rockstro\u0308m, O. Gaffney, J. Rogelj, M. Meinshausen, N. Nakicenovic, and H. J. Schellnhuber, A roadmap for rapid decarbonization, Science 355, 1269 (2017). [2] J. Rogelj, G. Luderer, R. C. Pietzcker, E. Kriegler, M. Schaeffer, V. Krey, and K. Riahi, Energy system transformations for limiting end-of-century warming to below 1.5 \u00b0C, Nature Climate Change 5, 519 (2015). [3] I. Staffell and S. Pfenninger, The increasing impact of weather on electricity supply and demand, Energy 145, 65 (2018). [4] A. Orths, C. L. Anderson, T. Brown, J. Mulhern, D. Pudjianto, B. Ernst, O. Mark, J. McCalley, and G. Strbac, Flexibility from energy systems integration: Supporting synergies among sectors, IEEE Power and Energy Magazine 17, 67 (2019). [5] D. Witthaut, F. Hellmann, J. Kurths, S. Kettemann, H. Meyer-Ortmanns, and M. Timme, Collective nonlinear dynamics and self-organization in decentralized power grids, Rev. Mod. Phys. 94, 015005 (2022). [6] D. Heide, L. von Bremen, M. Greiner, C. Hoffmann, M. Speckmann, and S. Bofinger, Seasonal optimal mix of wind and solar power in a future, highly renewable Europe, Renewable Energy 35, 2483 (2010).\n[7] S. Collins, P. Deane, B. O\u0301. Gallacho\u0301ir, S. Pfenninger, and I. Staffell, Impacts of Inter-annual Wind and Solar Variations on the European Power System, Joule 2, 2076 (2018). [8] J. Lin and F. H. Magnago, Electricity Markets: Theories and Applications (John Wiley & Sons, Inc., 2017). [9] M. Anvari, E. Proedrou, B. Scha\u0308fer, C. Beck, H. Kantz, and M. Timme, Data-driven load profiles and the dynamics of residential electricity consumption, Nature Com-\nmunications 13, 4593 (2022). [10] C. Han, H. Hilger, E. Mix, P. C. Bo\u0308ttcher, M. Reyers,\nC. Beck, D. Witthaut, and L. R. Gorja\u0303o, Complexity and persistence of price time series of the european electricity spot market, PRX Energy 1, 013002 (2022). [11] J. Machowski, J. Bialek, and J. Bumby, Power System Dynamics: Stability and Control (John Wiley & Sons, Ltd., 2008). [12] F. Milano, F. Do\u0308rfler, G. Hug, D. J. Hill, and G. Verbic, Foundations and Challenges of Low-Inertia Systems (Invited Paper), in 2018 Power Systems Computation Conference (PSCC) (IEEE, 2018) pp. 1\u201325. [13] P. Vorobev, D. M. Greenwood, J. H. Bell, J. W. Bialek, P. C. Taylor, and K. Turitsyn, Deadbands, Droop, and Inertia Impact on Power System Frequency Distribution, IEEE Transactions on Power Systems 34, 3098 (2019). [14] L. R. Gorja\u0303o, M. Anvari, H. Kantz, C. Beck, D. Witthaut, M. Timme, and B. Scha\u0308fer, Data-driven model of the power-grid frequency dynamics, IEEE Access 8, 43082 (2020). [15] D. Kraljic, Towards realistic statistical models of the grid frequency, IEEE Transactions on Power Systems (in press) (2022). [16] F. Guo and D. Schlipf, A Spectral Model of Grid Frequency for Assessing the Impact of Inertia Response on Wind Turbine Dynamics, Energies 14, 2492 (2021). [17] M. Mart\u0301\u0131nez-Barbeito, D. Gomila, and P. Colet, Dynamical model for power grid frequency fluctuations: Application to islands with high penetration of wind generation, Preprint at https: //ifisc.uib-csic.es/en/publications/dynamicalmodel-for-power-grid-frequency-fluctuati/ (2022).\n13\n[18] ENTSO-E Transparency Platform, https: //transparency.entsoe.eu/ (2020). [19] L. Hirth, J. Mu\u0308hlenpfordt, and M. Bulkeley, The ENTSO-E Transparency Platform \u2013 A review of Europe\u2019s most ambitious electricity data platform, Applied Energy 225, 1054 (2018). [20] ENTSO-E, Report on Deterministic Frequency Deviations, https://consultations.entsoe.eu/ system-development/deterministic_frequency_\ndeviations_report/user_uploads/report_ deterministic_frequency_deviations_final-draft-\nfor-consultation.pdf (2019). [21] ENTSO-E, Inertia and rate of change of frequency\n(RoCoF), https://eepublicdownloads.azureedge.net/ clean-documents/SOC%20documents/Inertia%20and%\n20RoCoF_v17_clean.pdf (2020). [22] G. E. Karniadakis, I. G. Kevrekidis, L. Lu, P. Perdikaris,\nS. Wang, and L. Yang, Physics-informed machine learning, Nature Reviews Physics 3, 422 (2021). [23] G. Carleo, I. Cirac, K. Cranmer, L. Daudet, M. Schuld, N. Tishby, L. Vogt-Maranto, and L. Zdeborova\u0301, Machine learning and the physical sciences, Reviews of Modern Physics 91, 045002 (2019). [24] J. Zhao, A. Go\u0301mez-Expo\u0301sito, M. Netto, L. Mili, A. Abur, V. Terzija, I. Kamwa, B. Pal, A. K. Singh, J. Qi, Z. Huang, and A. P. S. Meliopoulos, Power System Dynamic State Estimation: Motivations, Definitions, Methodologies, and Future Work, IEEE Transactions on Power Systems 34, 3188 (2019). [25] L. Ljung, Perspectives on system identification, Annual Reviews in Control 34, 1 (2010). [26] J. Stiasny, G. S. Misyris, and S. Chatzivasileiadis, Physics-Informed Neural Networks for Non-linear System Identification for Power System Dynamics, in 2021 IEEE Madrid PowerTech (2021) pp. 1\u20136. [27] S. M. Lundberg, G. Erion, H. Chen, A. DeGrave, J. M. Prutkin, B. Nair, R. Katz, J. Himmelfarb, N. Bansal, and S.-I. Lee, From local explanations to global understanding with explainable AI for trees, Nature Machine Intelligence 2, 56 (2020). [28] J. Kruse, B. Scha\u0308fer, and D. Witthaut, Revealing drivers and risks for power grid frequency stability with explainable AI, Patterns 2, 100365 (2021). [29] J. Kruse, E. Cramer, B. Scha\u0308fer, and D. Witthaut, Physics-inspired machine learning for power grid frequency modelling (v0.1.0), https://doi.org/10.5281/ zenodo.7274829 (2022). [30] J. Kruse, E. Cramer, B. Scha\u0308fer, and D. Witthaut, Supplementary data: \u201dPhysics-inspired machine learning for power grid frequency modelling\u201d, https://doi.org/ 10.5281/zenodo.7273665 (2022). [31] T. Weissbach and E. Welfonder, High frequency deviations within the European Power System: Origins and proposals for improvement, in 2009 IEEE/PES Power Systems Conference and Exposition (IEEE, 2009) pp. 1\u2013 6. [32] J. Kruse, B. Scha\u0308fer, and D. Witthaut, Exploring deterministic frequency deviations with explainable AI, in 2021 IEEE International Conference on Communications, Control, and Computing Technologies for Smart Grids (SmartGridComm) (IEEE, 2021) pp. 133\u2013139. [33] J. Kruse, B. Scha\u0308fer, and D. Witthaut, Secondary control activation analysed and predicted with explainable AI, Electric Power Systems Research 212, 108489 (2022).\n[34] S. Pu\u0308tz, B. Scha\u0308fer, D. Witthaut, and J. Kruse, Revealing interactions between HVDC cross-area flows and frequency stability with explainable AI, Preprint at https: //arxiv.org/abs/2204.10727 (2022). [35] J. Kruse, B. Scha\u0308fer, and D. Witthaut, Pre-Processed Power Grid Frequency Time Series, https://doi.org/ 10.5281/zenodo.5105820 (2020). [36] TransnetBW GmbH, Regelenergie Bedarf + Abruf, https://www.transnetbw.de/de/strommarkt/ systemdienstleistungen/regelenergie-bedarf-und-\nabruf (2020). [37] P. Mehta, M. Bukov, C.-H. Wang, A. G. R. Day,\nC. Richardson, C. K. Fisher, and D. J. Schwab, A highbias, low-variance introduction to Machine Learning for physicists, Physics Reports A High-Bias, Low-Variance Introduction to Machine Learning for Physicists, 810, 1 (2019). [38] X. Glorot and Y. Bengio, Understanding the difficulty of training deep feedforward neural networks, in Proceedings of the Thirteenth International Conference on Artificial Intelligence and Statistics (JMLR Workshop and Conference Proceedings, 2010) pp. 249\u2013256. [39] S. M. Lundberg and S.-I. Lee, A unified approach to interpreting model predictions, in Proceedings of the 31st International Conference on Neural Information Processing Systems, NIPS\u201917 (2017) pp. 4768\u20134777. [40] M. Abadi, P. Barham, J. Chen, Z. Chen, A. Davis, J. Dean, M. Devin, S. Ghemawat, G. Irving, M. Isard, et al., TensorFlow: a system for Large-Scale machine learning, in 12th USENIX symposium on operating systems design and implementation (OSDI 16) (2016) pp. 265\u2013283. [41] J. V. Dillon, I. Langmore, D. Tran, E. Brevdo, S. Vasudevan, D. Moore, B. Patton, A. Alemi, M. Hoffman, and R. A. Saurous, TensorFlow Distributions, Preprint at https://arxiv.org/abs/1711.10604 (2017). [42] T. O\u2019Malley, E. Bursztein, J. Long, F. Chollet, H. Jin, L. Invernizzi, et al., Keras tuner, https://github.com/ keras-team/keras-tuner (2019). [43] M. Anvari, L. R. Gorja\u0303o, M. Timme, D. Witthaut, B. Scha\u0308fer, and H. Kantz, Stochastic properties of the frequency dynamics in real and synthetic power grids, Physical review research 2, 013339 (2020). [44] EPEX SPOT, Press release: Intraday trading increases by 27.0% on year, https://www.epexspot.com/en/news/ intraday-trading-increases-270-year (2020). [45] H. Haehne, J. Schottler, M. Waechter, J. Peinke, and O. Kamps, The footprint of atmospheric turbulence in power grid frequency measurements, EPL (Europhysics Letters) 121, 30001 (2018). [46] E. Cramer, L. R. Gorja\u0303o, A. Mitsos, B. Scha\u0308fer, D. Witthaut, and M. Dahmen, Validation Methods for Energy Time Series Scenarios From Deep Generative Models, IEEE Access 10, 8194 (2022). [47] E. Cramer, L. Paeleke, A. Mitsos, and M. Dahmen, Normalizing flow-based day-ahead wind power scenario generation for profitable and reliable delivery commitments by wind farm operators, Computers & Chemical Engineering 166, 107923 (2022). [48] B. Scha\u0308fer, C. Beck, K. Aihara, D. Witthaut, and M. Timme, Non-Gaussian power grid frequency fluctuations characterized by Le\u0301vy-stable laws and superstatistics, Nature Energy 3, 119 (2018).\n14\n[49] J. Kruse, B. Scha\u0308fer, and D. Witthaut, Predictability of Power Grid Frequency, IEEE Access 8, 149435 (2020). [50] W. Bang and J. W. Yoon, Forecasting the Electric Network Frequency Signals on Power Grid, in 2019 International Conference on Information and Communication Technology Convergence (ICTC) (2019) pp. 1218\u20131223. [51] J. Dong, X. Ma, S. Djouadi, H. Li, and Y. Liu, Frequency Prediction of Power Systems in FNET Based on StateSpace Approach and Uncertain Basis Functions, IEEE Transactions on Power Systems 29, 2602 (2014). [52] S. Kaur, S. Agrawal, and Y. P. Verma, Power Grid Frequency Prediction Using ANN Considering the Stochasticity of Wind Power, in 2013 5th International Conference and Computational Intelligence and Communication Networks (2013) pp. 311\u2013315. [53] S. Homan, N. Mac Dowell, and S. Brown, Grid frequency volatility in future low inertia scenarios: Challenges and mitigation options, Applied Energy 290, 116723 (2021). [54] S. Chatzivasileiadis, A. Venzke, J. Stiasny, and G. Misyris, Machine Learning in Power Systems: Is It Time to Trust It?, IEEE Power and Energy Magazine 20, 32 (2022). [55] G. S. Misyris, A. Venzke, and S. Chatzivasileiadis, Physics-Informed Neural Networks for Power Systems, in 2020 IEEE Power Energy Society General Meeting (PESGM) (2020) pp. 1\u20135. [56] M. Raissi, P. Perdikaris, and G. E. Karniadakis, Physicsinformed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations, Journal of Computational Physics 378, 686 (2019). [57] B. Huang and J. Wang, Applications of Physics-Informed Neural Networks in Power Systems - A Review, IEEE Transactions on Power Systems (in press) (2022). [58] A. Ulbig, T. S. Borsche, and G. Andersson, Impact of Low Rotational Inertia on Power System Stability and Operation, IFAC Proceedings Volumes 19th IFAC World Congress, 47, 7290 (2014). [59] E. Weitenberg, Y. Jiang, C. Zhao, E. Mallada, C. De Persis, and F. Do\u0308rfler, Robust Decentralized Secondary Frequency Control in Power Systems: Merits and Tradeoffs, IEEE Transactions on Automatic Control 64, 3967 (2019). [60] P. C. Bo\u0308ttcher, A. Otto, S. Kettemann, and C. Agert, Time delay effects in the control of synchronous electricity grids, Chaos: An Interdisciplinary Journal of Nonlinear Science 30, 013122 (2020). [61] L. Hirth and I. Ziegenhagen, Balancing power and variable renewables: Three links, Renewable and Sustainable Energy Reviews 50, 1035 (2015). [62] C. W. Gardiner, Handbook of stochastic methods, Vol. 3 (Springer, 2009). [63] B. \u00d8ksendal, Stochastic Differential Equations, Universitext (Springer, 2003). [64] T. Hastie, R. Tibshirani, and J. Friedman, The Elements of Statistical Learning: Data Mining, Inference, and Prediction, 2nd ed. (Springer, 2016).\n15\nAppendix A: A stochastic model of grid frequency dynamics and control\n1. The aggregated swing equation\nGrid frequency deviations \u2206f(t) = (f(t)\u2212 fref) from the reference fref = 50 Hz or 60 Hz reflect power imbalances \u2206P in the grid, which have to be compensated via different sources. Firstly, the rotational energy of synchronous machines provides momentary reserve power Prot through changes in the rotation speed [58]:\nProt = 2HSB fref d\u2206f dt = 2\u03c0M d\u2206f dt . (A1)\nHere, H denotes the average inertia constant of a synchronous machine, which is typically around 6 s for conventional generators [13] and SB is the total rated power of all generators. Loosely speeking, H equals the kinetic energy of the rotating machine rotating at fref divided by its rated power. The parameter M then denotes the aggregated inertia of the grid.\nSecondly, damping power is provided via primary control, also refered to as frequency containment reserve (FCR), and frequency-sensitive loads [58],\nPprim = K1\u2206f, (A2)\nwhere K1 = KT + KL is the inverse droop coefficient, which comprises the effect of control KT and load damping KL ([K1] = W/Hz). The control effect KT is typically one or two orders of magnitude larger than KL [11]. Their values are often provided in the per unit (pu) system with Kpu1 = frefK1/P0, as the parameter KT depends on the steady-state load P0 within the specific system. For example, in Great Britain a typical value of K pu 1 = 12.5 is reported [13]. Thirdly, secondary control, also referred to as frequency restoration reserve (FRR), restores the frequency back to its reference fref . Secondary control is typically implemented as an integral controller (but other implementations exist)[59]:\nPsec = K2\u03b8\u0304, (A3)\nwith the integrated frequency deviation\n\u03b8\u0304(t) = \u222b t ti \u2206f(t\u2032) dt\u2032. (A4)\nThe parameter K2 is the secondary control gain ([K2] = W), which reads K pu 2 = frefK2/P0 in the pu system. For example, in Great Britain a typical value of Kpu2 = 0.05/s is reported [13]. In interconnected power grids, secondary control may also be used to reduce unscheduled flows between different control areas [60]. These control actions are applied reciprocally in two areas and thus have only minor effects for the overall frequency dynamics.\nFinally, this yields the aggregated swing equation, which is simply the power balance of all contributions:\nd\u03b8\u0304 dt = \u2206f, (A5)\n2\u03c0M d\u2206f\ndt = \u2212K1\u2206f \u2212K2\u03b8\u0304 + \u2206P (t). (A6)\nHere, \u2206P (t) denotes the imbalance of power generation and load, excluding the contribution of the control system (A2) and (A3).\n2. Stochastic differential equations\nFollowing reference [14], we modelled the power imbalances \u2206P (t) = Pim(t) + D\u0304\u03be(t) as a sum of \u201cdeterministic\u201d power imbalances Pim(t) and stochastic deviations D\u0304\u03be(t). In the large European power grids, deterministic power imbalances repeatedly arise due to a different ramping of dispatchable generators and the load or due to forecasting errors [61]. Stochastic deviations are modelled as Gaussian noise \u03be(t) defined as the derivative of a Wiener process Wt that has independent, normally distributed increments dWt with zero mean and variance \u3008dW 2t \u3009 = dt.\n16\nTo estimate model parameters, we have to rescale Eq. (A6) by M as all parameters otherwise are undefined up to a multiplicative factor. In addition, we transition from frequencies and integrated frequencies to angular velocities and angles. We define\n\u03c4\u22121 = K1\n2\u03c0M , (A7)\n\u03ba\u22122 = K2\n2\u03c0M , (A8)\nD = D\u0304\nM , (A9)\nP (t) = Pim(t)\nM , (A10)\n\u03b8 = 2\u03c0\u03b8\u0304. (A11)\nBased on these definitions, we obtain a stochastic model for the angular grid frequency deviation \u03c9 = 2\u03c0\u2206f :\nd\u03b8 = \u03c9 dt, (A12) d\u03c9 = ( P (t)\u2212 \u03c4\u22121\u03c9 \u2212 \u03ba\u22122\u03b8 ) dt+D dWt. (A13)\nCollecting both stochastic variables into a vector X = (\u03b8, \u03c9)T , we can write our model as a two-dimensional matrix equation\ndX = a(X, t)dt+D dW t, (A14)\nusing the drift vector a(X, t) = (a\u03b8, a\u03c9) T with a\u03b8 = \u03c9, a\u03c9 = P (t)\u2212\u03c4\u22121\u03c9\u2212\u03ba\u22122\u03b8, the diffusion matrix D = diag(D, 0) and a two-dimensional Wiener process W t. The stochastic differential equation (A14) can be recast into a Fokker-Planck equation for the joint probability density function P(\u03b8, \u03c9; t) that describes the distribution of the two random variables \u03b8 and \u03c9 at time t [62]. Using Ito\u0302 calculus, one obtains\n\u2202 \u2202t P(\u03b8, \u03c9; t) = [ \u2212 \u2202 \u2202\u03c9 ( P (t)\u2212 \u03c4\u22121\u03c9 \u2212 \u03ba\u22122\u03b8 ) \u2212 \u2202 \u2202\u03b8 \u03c9 + D2 2 \u22022 \u2202\u03c92 ] P(\u03b8, \u03c9; t). (A15)\n3. Solution of the Fokker-Planck equation\nIn this section, we proof that the Fokker-Planck equation (A15) is solved by a multivariate normal distribution with PDF\nP(x; t) = 1 2\u03c0|\u03a3| exp\n( \u22121\n2 (x\u2212 \u00b5)>\u03a3\u22121(x\u2212 \u00b5)\n) (A16)\nwith x> = (\u03b8, \u03c9) and time-dependent parameters\n\u00b5(t) = ( \u00b5\u03b8(t) \u00b5\u03c9(t) ) , \u03a3(t) = ( \u03c32\u03b8(t) \u03c3\u03b8\u03c9(t) \u03c3\u03b8\u03c9(t) \u03c3 2 \u03c9(t) ) .\nif the parameters satisfy the ordinary differential equations\nd dt \u00b5\u03b8 = \u00b5\u03c9 , d dt \u00b5\u03c9 = P (t)\u2212 \u03c4\u22121\u00b5\u03c9 \u2212 \u03ba\u22122\u00b5\u03b8 ,\nd dt \u03c32\u03b8 = 2\u03c3\u03b8\u03c9, d dt \u03c32\u03c9 = \u03c3\n2\u03c9 \u2212 \u03c4\u22121\u03c3\u03b8\u03c9 \u2212 \u03ba\u22122\u03c32\u03b8 , d dt \u03c3\u03b8\u03c9 = \u22122\u03c4\u22121\u03c32\u03c9 \u2212 2\u03ba\u22122\u03c3\u03b8\u03c9 . (A17)\n17\nWe proof this result using the characteristic function, which is defined via the Fourier transform\n\u03c6(u; t) = \u222b eiu >x P(x; t)d2x. (A18)\nIn terms of the characteristic function, the FPE reads\n\u2202 \u2202t \u03c6(u; t) = L\u03c6(u; t)\n= is [( P (t) + i\u03c4\u22121 \u2202\n\u2202s + i\u03ba\u22122\n\u2202\n\u2202r\n) + r \u2202\n\u2202s \u2212 D\n2 2 s2 ] \u03c6(u; t), (A19)\nwhere we have defined u> = (r, s). The characteristic function of the normal distribution (A16) reads\n\u03c6(u; t) = exp ( iu>\u00b5\u2212 1\n2 u>\u03a3u\n) , (A20)\n\u03c6(r, s; t) = exp ( i(r\u00b5\u03b8 + s\u00b5\u03c9)\u2212 1\n2 (r2\u03c32\u03b8 + s 2\u03c32\u03c9 + 2rs\u03c3\u03b8\u03c9)\n) .\nWe now show that the normal distribution (A20) with the parameters (A17) satisfies the Fokker-Planck equation (A19). We first evaluate the right-hand side of the FPE,\nL\u03c6(u; t) = is [( P (t) + i\u03c4\u22121 \u2202\n\u2202s + i\u03ba\u22122\n\u2202\n\u2202r\n) + r \u2202\n\u2202s \u2212 D\n2 2 s2 ] exp ( i(r\u00b5\u03b8 + s\u00b5\u03c9)\u2212 1 2 (r2\u03c32\u03b8 + s 2\u03c32\u03c9 + 2rs\u03c3\u03b8\u03c9) ) ,\n= [ isP (t)\u2212 D 2\n2 s2 \u2212 (\u03c4\u22121s\u2212 r)(i\u00b5\u03c9 \u2212 s\u03c32\u03c9 \u2212 r\u03c3\u03b8\u03c9)\u2212 \u03ba2s(i\u00b5\u03b8 \u2212 r\u03c32\u03b8 \u2212 s\u03c3\u03b8\u03c9)\n] \u03c6(u; t). (A21)\nNow we proceed with the left-hand side,\n\u2202 \u2202t \u03c6(u; t) =\n[ i ( s d\u00b5\u03c9 dt + r s\u00b5\u03b8 dt ) \u2212 1 2 ( r2 d\u03c32\u03b8 dt + s2 d\u03c32\u03b8 dt + 2rs d\u03c3\u03b8\u03c9 dt )] \u03c6(u; t) . (A22)\nInserting the equations (A17) then yields\n\u2202 \u2202t \u03c6(u; t) =\n[ isP (t)\u2212 D 2\n2 s2 \u2212 (\u03c4\u22121s\u2212 r)(i\u00b5\u03c9 \u2212 s\u03c32\u03c9 \u2212 r\u03c3\u03b8\u03c9)\u2212 \u03ba2s(i\u00b5\u03b8 \u2212 r\u03c32\u03b8 \u2212 s\u03c3\u03b8\u03c9)\n] \u03c6(u; t), (A23)\nwhich coincides with the right-hand side (A21).\n4. Moment equations\nThe ordinary differential equations for the parameters (A17) can also be obtained in a more direct way, once we know that the PDF remains Gaussian for all times. In fact, we can exploit that the parameters of a Gaussian PDF equal the mean and the (co-) variances. The dynamics of the mean and the (co-) variances are determined by the moment equations, which we extracted using Ito\u0302\u2019s lemma. For any twice differentiable scalar function g(X) of the random variable X in Eq. (A14), Ito\u0302\u2019s lemma reads [63],\ndg = [ (\u2207g)T \u00b5+ 1 2 Tr ( DTHgD )] dt+ (\u2207g)T DdW , (A24)\nwhere \u2207g is the gradient and Hg is the hessian matrix of the function g(X). This yielded in our case\ndg =\n[ \u2202g\n\u2202\u03c9 \u00b5\u03c9 +\n\u2202g \u2202\u03b8 \u03c9 +\nD2\n2\n\u22022g\n\u2202\u03c92\n] dt+ \u2202g\n\u2202\u03c9 D dW. (A25)\nTo apply this to moment functions, we further assumed d\u3008g\u3009 = \u3008dg\u3009. For the first moments (averages) g = \u3008\u03b8\u3009 and g = \u3008\u03c9\u3009 we obtained\nd\u3008\u03b8\u3009 dt\n= \u3008\u03c9\u3009, (A26) d\u3008\u03c9\u3009 dt = P (t)\u2212 \u03c4\u22121\u3008\u03c9\u3009 \u2212 \u03ba\u22122\u3008\u03b8\u3009. (A27)\n18\nThe second moments g = \u3008\u03b82\u3009, g = \u3008\u03c92\u3009 and the mixed moment g = \u3008\u03c9\u03b8\u3009 yielded\nd\u3008\u03b82\u3009 dt\n= 2\u3008\u03b8\u03c9\u3009, (A28) d\u3008\u03c92\u3009\ndt = 2P (t)\u3008\u03c9\u3009 \u2212 2\u03c4\u22121\u3008\u03c92\u3009 \u2212 2\u03ba\u22122\u3008\u03c9\u03b8\u3009+D2, (A29)\nd\u3008\u03c9\u03b8\u3009 dt = P (t)\u3008\u03b8\u3009 \u2212 \u03c4\u22121\u3008\u03c9\u03b8\u3009 \u2212 \u03ba\u22122\u3008\u03b82\u3009+ \u3008\u03c92\u3009. (A30)\nIn this derivation, we used \u3008\u03c9dW \u3009 = 0 and \u3008\u03b8dW \u3009 = 0. Identifying \u00b5\u03b8 = \u3008\u03b8\u3009, \u00b5\u03c9 = \u3008\u03c9\u3009, \u03c32\u03c9 = \u3008\u03c92\u3009 \u2212 \u3008\u03c9\u30092, \u03c32\u03b8 = \u3008\u03b82\u3009 \u2212 \u3008\u03b8\u30092 and \u03c3\u03b8,\u03c9 = \u3008\u03c9\u03b8\u3009 \u2212 \u3008\u03c9\u3009\u3008\u03b8\u3009 then reproduces Eq. (A17).\n5. Solution of the moment equations\nWe now provide a semi-analytic solutions for the ordinary differential equations (A17) describing the evolution of the paramaters \u00b5\u03b8, \u00b5\u03c9, \u03c3 2 \u03c9, \u03c3 2 \u03b8 and \u03c3\u03b8,\u03c9. We first note that the equations for the deterministic part (the means) and the stochastic part (the (co-) variances) decouple, hence they can be treated separately. We collected the deterministic equations using the vector yd = (\u00b5\u03b8, \u00b5\u03c9) T ,\ndyd dt = Adyd + bd(t), (A31)\nAd = ( 0 1 \u2212\u03ba\u22122 \u2212\u03c4\u22121 ) , (A32)\nbd(t) =\n( 0\nP (t)\n) . (A33)\nWith ys = (\u03c3 2 \u03b8 , \u03c3\u03b8,\u03c9, \u03c3 2 \u03c9) T , the stochastic part yielded\ndys dt = Asys + bs, (A34)\nAs =  0 2 0\u2212\u03ba\u22122 \u2212\u03c4\u22121 1 0 \u22122\u03ba\u22122 \u22122\u03c4\u22121  , (A35) bd =  00 D2\n . (A36) These equations are linear, ordinary differential equations (ODEs), for which several solution methods exist.\na. Solution of the homogeneous equations\nThe general solution of the homogeneous ODE y\u0307 = Ay with time-independent coefficients A is given by\nyh(t) = U(t)U \u22121(0)y0. (A37)\nThe columns of the matrix U(t) span the solution space of the homogeneous ODE. The column vectors are given by ui = vie\n\u03bbit, where vi are the eigenvectors of A and \u03bbi are the corresponding eigenvalues. Using any computer algebra program, we calculated the eigenvalues and eigenvectors for the matrix Ad of the deterministic part:\n\u03bbd,1 = \u2212 1\n2\u03c4\n\u221a 1\u2212 4\u03c4 2\n\u03ba2 \u2212 1 2\u03c4 , (A38)\n\u03bbd,1 = 1\n2\u03c4\n\u221a 1\u2212 4\u03c4 2\n\u03ba2 \u2212 1 2\u03c4 , (A39)\nvd,1 = (\u03bbd,2\u03ba 2, 1)T , (A40)\nvd,2 = (\u03bbd,1\u03ba 2, 1)T . (A41)\n19\nFor the matrix As from the stochastic part, we obtained\n\u03bbs,1 = \u2212\u03c4\u22121, (A42)\n\u03bbs,2 = \u2212 1\n\u03c4\n\u221a 1\u2212 4\u03c4 2\n\u03ba2 \u2212 1 \u03c4 , (A43)\n\u03bbs,3 = 1\n\u03c4\n\u221a 1\u2212 4\u03c4 2\n\u03ba2 \u2212 1 \u03c4 , (A44)\nvs,1 = (\u03ba 2,\u2212\u03ba\n2\n2\u03c4 , 1)T , (A45)\nvs,2 = (\u2212\u03ba2 \u2212 \u03bbs,3 \u03ba4 2\u03c4 , \u03bbs,3\u03ba 2 2 , 1)T , (A46) vs,3 = (\u2212\u03ba2 \u2212 \u03bbs,2 \u03ba4\n2\u03c4 , \u03bbs,2\u03ba\n2\n2 , 1)T . (A47)\nTo specify the homogeneous ODE solutions for \u00b5\u03c9(t) and \u03c3 2 \u03c9(t), we needed the inverses of the matrix U(t), i.e., the matrices U\u22121d (t) and U \u22121 s (t), which we again obtained through a computer algebra program. The \u03c9-components of the solution for the homogeneous system (A37) then read\n\u00b5\u03c9,h(t) = 1 \u03bbd,1 \u2212 \u03bbd,2 [ \u03ba\u22122\u03b80 ( e\u03bbd,2t \u2212 e\u03bbd,1t ) + \u03c90 ( \u03bbd,1e \u03bbd,1t \u2212 \u03bbd,2e\u03bbd,2t )] , (A48)\n\u03c32\u03c9,h(t) = [ \u03c32\u03b8,0 ( e\u03bbs,2t + e\u03bbs,3t \u2212 2e\u03bbs,1t ) \u03c42 \u03ba2\n(A49)\n+\u03c3\u03c9,\u03b8,0\n( \u22122\u03c4e\u03bbs,1t + 8\u03c4 2\n\u03ba2 \u03bbs,2\u03ba 2(4\u03c4)\u22121 + 1 \u03bbs,2 \u2212 \u03bbs,3 e\u03bbs,2t + 8\u03c42 \u03ba2 \u03bbs,3\u03ba 2(4\u03c4)\u22121 + 1 \u03bbs,3 \u2212 \u03bbs,2\ne\u03bbs,3t )\n+ \u03c32\u03c9,0\n( \u22122\u03c4e\u03bbs,1t + 2\u03bbs,2\u03c4\n2 \u2212 \u03bbs,2\u03ba2 \u2212 2\u03c4 \u03bbs,3 \u2212 \u03bbs,2 e\u03bbs,2t + 2\u03bbs,3\u03c4 2 \u2212 \u03bbs,3\u03ba2 \u2212 2\u03c4 \u03bbs,2 \u2212 \u03bbs,3\ne\u03bbs,3t )]\n1\n\u03ba2 \u2212 4\u03c42 , (A50)\nwhere \u03b80, \u03c90 denote the initial conditions of the averages and \u03c3 2 \u03b8,0, \u03c3\u03b8,\u03c9,0, \u03c3 2 \u03c9,0 represent the initial conditions of the covariances.\nb. (Semi-)Analytical solution of inhomogeneous equations\nThe general solution of the inhomogeneous ODE y\u0307 = Ay + b(t) with time-independent coefficient A is given by the sum of the homogeneous solution and an inhomogeneous contribution yin(t)\nyODE(t) = yh(t) + yin(t),\n= yh(t) +U(t) \u222b t 0 U\u22121(t\u2032)b(t\u2032)dt\u2032. (A51)\nWe first provide a semi-analytical solution, which leaves the integration of the inhomogeneity bd(t) to a numerical routine. This enables us to flexibly insert different power function P (t), as we will see below.\nThe \u03c9-components of the inhomogeneous contributions yield\n\u00b5\u03c9,in(t) = 1\n\u03bbd,1 \u2212 \u03bbd,2\n[ \u03bbd,1e \u03bbd,1t \u222b t 0 P (t\u2032)e\u2212\u03bbd,1t \u2032 dt\u2032 \u2212 \u03bbd,2e\u03bbd,2t \u222b t 0 P (t\u2032)e\u2212\u03bbd,2t \u2032 dt\u2032 ] , (A52)\n\u03c32\u03c9,in(t) = D2 \u03ba2 \u2212 4\u03c42 [ 2\u03c42 \u03bbs,1 (1\u2212 e\u03bbs,1t) + 2\u03c4/\u03bbs,2 \u2212 2\u03c4 2 + \u03ba2 \u03bbs,3 \u2212 \u03bbs,2 (1\u2212 e\u03bbs,2t) + 2\u03c4/\u03bbs,3 \u2212 2\u03c4 2 + \u03ba2 \u03bbs,2 \u2212 \u03bbs,3 (1\u2212 e\u03bbs,3t) ] . (A53)\nNote that the deterministic part contains an integral over the deterministic power imbalance P (t), which we can compute numerically for any power function. However, the factors e\u2212\u03bbt in Eq. (A52) can become very large as \u03bb < 0 for stable systems thus causing numerical problems. To use this semi-analytical solution during neural network training, one has to mitigate these numerical problems, e.g., by strongly restricting the parameter space.\nWe used a fully analytical solution for the case P (t) = q+ rt, thus avoiding these numerical problems. In this case, the inhomogeneous solution of the deterministic part yielded\n\u00b5\u03c9,in(t) = 1\n\u03bbd,1 \u2212 \u03bbd,2\n[ e\u03bbd,1t ( q + r\n\u03bbd,1\n) \u2212 e\u03bbd,2t ( q + r\n\u03bbd,2\n) + r ( 1\n\u03bbd,2 \u2212 1 \u03bbd,1\n)] . (A54)\n20\ndynamics, hence we only needed a closed form solution for \u00b5\u03c9 and \u03c3\u03c9.\nAppendix B: Parameter values from the literature\nBased on the definition in Eqs. (A12)-(A13), Gorjao et al. inferred time-independent parameter values using the Kramers-Moyal expansion [14]. The authors employed the actual grid frequency instead of the angular velocity. Thus, we rescaled the results according to D \u2192 2\u03c0D, q \u2192 2\u03c0q, r \u2192 2\u03c0r, \u03b8 \u2192 2\u03c0\u03b8, while \u03c4 and \u03ba stayed the same.\n\u03c4 = 120 s , (B1)\n\u03ba = 183 s , (B2)\nD = 0.007 s\u22123/2 , (B3)\nq = 0.0042 s\u22122 , (B4) r = 0.000009 s\u22123. (B5)\nIn the main text, we use these parameter values as reference values and therefore call them \u03d1refj . Note that the authors of ref. [14] did not directly provide a result for r, but its value was implicitly defined through the constraint \u3008Pim(t)\u3009t = 0, which yields r = 2q/tmax. Moreover, the parameter q was specified separately for the full hour and for every (other) quarter of the hour, so we took the average value here.\nAppendix C: Parameter Scaling and Constraints\nThe developed PIML model includes a layer that rescales the parameters and ensures some physical constrains (Fig. 1d). The outputs uj of the FFNN do not necessarily fulfil the physical constraints of the parameters \u03d1j (cf. Tab. II), as the linear activation of the output takes arbitrary real values, while \u03c4 , for example, only takes positive real values. Moreover, the physical parameters \u03d1j vary strongly in scale (cf. appendix B), but the outputs uj of the initialised FFNN typically have the same scale due uniform random initialisation of the weights [64]. This will yield large initial errors along certain parameter axis thus leading to inhomogeneous loss landscapes which can make optimisation inefficient and more difficult [37].\nTherefore, we added a constraint and scaling layer that applies functions \u03bdj to the FFNN outputs. The results then represent the parameter estimates \u03d1j = \u03bdj(uj). First, the functions \u03bdj enforce the physical constraints. For example, a softplus function S+(u) = log(exp(u) + 1) \u2208 (0,\u221e) enforces positivity, and the sigmoid function Sig(u) = (1 + exp(\u2212u)\u22121 \u2208 (0, 1) was used to ensure that \u03c4 \u2264 \u03ba/2 holds. Numerical imprecision can lead to a violation of these constraints so that we added a safety factor \u03b4 = 0.999 in some cases. Second, the factors sj , which mirror the typical scale of parameters \u03d1j , are applied to make the optimisation more efficient. Third, minimum values are added in certain cases to ensure numerical stability during optimisation. For example, a very small standard deviation \u03c3\u03c9,0 can lead to probability densities beyond float precision. All in all, we defined the following functions using minimum\n21\nvalues, scaling factors and constraints from Tab. II:\n\u03bd1(u1) = S+(u1)s1 + v1, \u03bd2(u2) = \u03b4 tanh(u1)\u03bd1(u1)\u03bd3(u3), \u03bd3(u3) = S+(u3)s3 + v3,\n\u03bd4(u4) =\n( 2v4\n\u03bd5(u5) + \u03b4Sig(u4)\n( 1\u2212 2v4\n\u03bd5(u5)\n)) \u03bd5(u5)\n2 ,\n\u03bd5(u5) = S+(u5)s5 + v5, \u03bd6(u6) = S+(u6)s6 + v6, \u03bd7(u7) = u7s7,\n\u03bd8(u8) = u8s8.\nTo test the impact of the scaling with sj , we varied the scaling parameters according to Tab. II. In particular, we trained the PIML model for each combination of the individual scaling choices listed in the table. For each scaling tuple, we additionally simulated 10 different random initialisation of the FFNN weights. Finally, we trained 10 initialisations using the standard scaling defined in Tab. II and no scaling with sj = 1 (cf. Sec. III B)."
        }
    ],
    "title": "Physics-inspired machine learning for power grid frequency modelling",
    "year": 2022
}