{
    "abstractText": "Genome-wide association studies (GWAS) focus on finding associations between genotypes and phenotypes such as susceptibility to diseases. Since genetic data is extremely sensitive and long-lived, individuals and organizations are reluctant to share their data for analysis. This paper proposes two solutions for a fully decentralized and privacy-preserving system for performing minor allele frequency analysis on multiple data sets. Homomorphic encryption and zero-knowledge proofs are used in combination with a blockchain system to achieve data privacy and enable verifiability. Preliminary evaluation of the solutions reveals several important challenges such as handling large cipher texts in smart contracts and reuse of the encrypted data for specific researcher queries that need to be tackled in order to make the solutions more practical.",
    "authors": [
        {
            "affiliations": [],
            "name": "Leon Visscher"
        },
        {
            "affiliations": [],
            "name": "Mohammed Alghazwi"
        },
        {
            "affiliations": [],
            "name": "Dimka Karastoyanova"
        },
        {
            "affiliations": [],
            "name": "Fatih Turkmen"
        }
    ],
    "id": "SP:92534ac74868d12ceac3e0ab4d0bcec4d36ce3a0",
    "references": [
        {
            "authors": [
                "Mohammed Alghazwi",
                "Fatih Turkmen",
                "Joeri van der Velde",
                "Dimka Karastoyanova"
            ],
            "title": "Blockchain for Genomics: A Systematic Literature Review",
            "venue": "Distrib. Ledger Technol. (aug 2022)",
            "year": 2022
        },
        {
            "authors": [
                "Kerem Ayoz",
                "Erman Ayday",
                "A. Ercument Cicek"
            ],
            "title": "Genome Reconstruction Attacks Against Genomic Data-Sharing Beacons",
            "venue": "Proceedings on Privacy Enhancing Technologies 2021,",
            "year": 2021
        },
        {
            "authors": [
                "Nir Bitansky",
                "Ran Canetti",
                "Alessandro Chiesa",
                "Eran Tromer"
            ],
            "title": "From extractable collision resistance to succinct non-interactive arguments of knowledge, and back again",
            "venue": "In Proceedings of the 3rd Innovations in Theoretical Computer Science Conference on - ITCS",
            "year": 2012
        },
        {
            "authors": [
                "Charlotte Bonte",
                "EleftheriaMakri",
                "AminArdeshirdavani",
                "Jaak Simm",
                "YvesMoreau",
                "Frederik Vercauteren"
            ],
            "title": "Towards practical privacy-preserving genomewide association study",
            "venue": "BMC Bioinformatics 19,",
            "year": 2018
        },
        {
            "authors": [
                "Ellen W. Clayton",
                "Colin M. Halverson",
                "Nila A. Sathe",
                "Bradley A. Malin"
            ],
            "title": "A systematic literature review of individuals\u2019 perspectives on privacy and genetic information in the United States",
            "venue": "PLOS ONE 13,",
            "year": 2018
        },
        {
            "authors": [
                "Ariel Gabizon",
                "Zachary J. Williamson",
                "Oana Ciobotaru"
            ],
            "title": "PLONK: Permutations over Lagrange-bases for Oecumenical Noninteractive arguments of Knowledge",
            "venue": "Technical Report 953",
            "year": 2019
        },
        {
            "authors": [
                "Jens Groth"
            ],
            "title": "On the Size of Pairing-Based Non-interactive Arguments",
            "venue": "In Advances in Cryptology \u2013 EUROCRYPT 2016, Marc Fischlin and Jean-Se\u0301bastien Coron (Eds.)",
            "year": 2016
        },
        {
            "authors": [
                "Miran Kim",
                "Kristin Lauter"
            ],
            "title": "Private genome analysis through homomorphic encryption",
            "venue": "BMC Medical Informatics and Decision Making 15,",
            "year": 2015
        },
        {
            "authors": [
                "Ahmed Kosba",
                "Charalampos Papamanthou",
                "Elaine Shi"
            ],
            "title": "xJsnark: A Framework for Efficient Verifiable Computation",
            "venue": "IEEE Symposium on Security and Privacy (SP)",
            "year": 2018
        },
        {
            "authors": [
                "Jose L. Mu\u00f1oz-Tapia",
                "Marta Belles",
                "Miguel Isabel",
                "Albert Rubio",
                "Jordi Baylina"
            ],
            "title": "CIRCOM: A Robust and Scalable Language for Building Complex Zero- Knowledge Circuits",
            "year": 2022
        },
        {
            "authors": [
                "Pascal Paillier"
            ],
            "title": "Public-Key Cryptosystems Based on Composite Degree Residuosity Classes",
            "venue": "In Advances in Cryptology \u2014 EUROCRYPT \u201999, Jacques Stern (Ed.)",
            "year": 1999
        },
        {
            "authors": [
                "Fatih Turkmen",
                "Muhammad Rizwan Asghar",
                "Yuri Demchenko"
            ],
            "title": "iGeno- Pri: Privacy-preserving genomic data processing with integrity and correctness proofs",
            "venue": "In 14th Annual Conference on Privacy, Security and Trust,",
            "year": 2016
        },
        {
            "authors": [
                "Peter M. Visscher",
                "Naomi R. Wray",
                "Qian Zhang",
                "Pamela Sklar",
                "Mark I. McCarthy",
                "Matthew A. Brown",
                "Jian Yang"
            ],
            "title": "2017. 10 Years of GWAS Discovery: Biology, Function, and Translation",
            "venue": "The American Journal of Human Genetics 101,",
            "year": 2017
        }
    ],
    "sections": [
        {
            "text": "CCS CONCEPTS \u2022 Security and privacy \u2192 Privacy-preserving protocols.\nKEYWORDS Blockchain, Smart Contracts, Genomics, Privacy-preserving protocols\nACM Reference Format: Leon Visscher, Mohammed Alghazwi, Dimka Karastoyanova, and Fatih Turkmen. 2022. Poster: Privacy-preserving Genome Analysis using Verifiable Off-Chain Computation. In Proceedings of the 2022 ACM SIGSAC Conference on Computer and Communications Security (CCS \u201922), November 7\u201311, 2022, Los Angeles, CA, USA. ACM, New York, NY, USA, 3 pages. https://doi.org/10.1145/3548606.3563548"
        },
        {
            "heading": "1 INTRODUCTION",
            "text": "Genome-wide association studies (GWAS) focus on finding associations between genotypes and phenotypes [15] which can help to identify one\u2019s susceptibility to genetic diseases. However, in order to obtain significant results, researchers must have access to the\nPermission to make digital or hard copies of part or all of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for third-party components of this work must be honored. For all other uses, contact the owner/author(s). CCS \u201922, November 7\u201311, 2022, Los Angeles, CA, USA \u00a9 2022 Copyright held by the owner/author(s). ACM ISBN 978-1-4503-9450-5/22/11. https://doi.org/10.1145/3548606.3563548\ngenotypes of as many individuals as possible. Because of the sensitive nature of genetic data, individuals are usually reluctant to make their data available for research [6] which presents a challenge.\nExisting solutions such as the Beacon Project make it easier to perform specific analysis queries on federated data, but still do not address these privacy concerns since the data still needs to be held by organizations that need to be trusted. Moreover, there are numerous privacy risks (e.g., re-identification and reconstruction attacks) associated with the use of Beacon networks [2].\nIn this paper, we propose two decentralized solutions to an instance of GWAS, namelyMinor Allele Frequency (MAF), that allows any individual or organization to make their genomic data available for analysis without violating privacy. More specifically, we assume that there are one or more data owners owning a private data set with allele variants, and a researcher who wants to obtain the MAF of one or more of these data sets combined. The data owners do not need to share their data in plain, and the researcher may only know the result of the analysis."
        },
        {
            "heading": "2 RELATEDWORK",
            "text": "The use of blockchain in genomics is increasingly being explored in research [1]. However, the focus of most research is on managing and sharing genomic data using a blockchain system, instead of performing actual privacy-preserving computation.\nSeveral studies explored solutions for performing privacy-preserving genome analysis without the use of a blockchain system. Kim et al. [10] propose an efficient evaluation algorithm for performing minor allele frequency and \ud835\udf122 statistic analysis using fully HE with the main goal of outsourcing computation on private data to a cloud computing service. In contrast, Bonte et al. [4] used somewhat HE and multi-party computation (MPC) to implement two solutions for performing privacy-preserving \ud835\udf122 statistic analysis focusing specifically on preventing re-identification attacks.\nAlthough the proposed solutions are relevant and effective, in each of the proposed solutions a centralized component is present where at least an aggregate computation is performed. Furthermore, none of these papers enables the verifiability of the performed computation. [14] proposes a solution to this however it considers an outsourced computation (i.e., cloud) setting rather than a decentralized setting as we do in this paper.\nCCS \u201922, November 7\u201311, 2022, Los Angeles, CA, USA Leon Visscher, Mohammed Alghazwi, Dimka Karastoyanova, & Fatih Turkmen"
        },
        {
            "heading": "3 APPROACH",
            "text": "We present two different solutions (i.e., on-chain and off-chain) for performing privacy-preserving and verifiable Minor Allele Frequency (MAF) analysis in a decentralized fashion. MAF is the frequency of occurrence of the least common allele at a specific locus within a population, which can be used to identify associations between genotypes and phenotypes. The on-chain solution performs MAF computation in a Solidity smart contract and it is mostly intended as a reference solution for evaluating the off-chain solution. The off-chain solution uses a rollup system that performs computations off-chain and generates a proof of correct computation using zk-SNARKs[3]. The result of the computation together with the proof of correct computation is submitted to a smart contract in the latter. Both solutions employ the Paillier cryptosystem [13] for MAF computation on encrypted data."
        },
        {
            "heading": "3.1 Implementation",
            "text": "The first step is organizing and pre-processing the data. For theMAF use-case, only the count of allele occurrences of a single nucleotide polymorphism (SNP) is required and not the entire genotype. Therefore, the data owners first compute the allele counts. SNP data are organized in an array of four integers representing the count of one for each of the four possible nucleotide bases A, C, T, and G as shown in Listing 1.\n{ \" r s 1 1 6 86243 \" : [ 7 , 0 , 5 , 0 ] , \" r s 4 4 2 6491 \" : [ 0 , 1 0 , 0 , 2 ] }\nListing 1: Plain data set JSON example\nEach of the four values is then encrypted using the Paillier cryptosystem [13]. The Paillier cryptosystem is an additive HE cryptosystem that allows for computing the sum of two values while the values are encrypted. Because the ciphertext is a number modulo \ud835\udc5b2 where \ud835\udc5b is the public modulo used for the Paillier cryptosystem, the size of the ciphertext is 2\ud835\udc5b bits. When using a 3072-bit value for \ud835\udc5b, the encrypted data for one SNP consists of an array of four 6144-bit values."
        },
        {
            "heading": "3.2 On-chain solution",
            "text": "After organizing and pre-processing the data, the encrypted data is sent to the smart contract. As shown in Figure 1, the on-chain version uses a Solidity library, Big Number [8], for performing computations on these large 6144-bit values within the smart contract. A data owner encodes and encrypts their data and submits it to the\nsmart contract. The researcher can call the performQuery method which computes and returns the result."
        },
        {
            "heading": "3.3 Off-chain solution",
            "text": "The off-chain solution (shown in Figure 2) uses a rollup system to perform the computations off-chain which increases performance and scalability. Additionally, by using HE, the data used can come frommultiple data owners and still remain private. Zero-knowledge proofs (ZKPs) is used to verify that the off-chain computation is performed correctly.\nCircom, which is a language for compiling zk-SNARKs for arithmetic circuits [12], was used in our off-chain solution to generate proofs of correct computation. Zk-SNARK fields have a maximum size of 254 bits. In order to generate proofs for the large cipher text multiplications, the long multiplication method proposed by Kosba et al. [11] was used. The cipher text values are split into several registers and a constraint is defined for multiplying each register."
        },
        {
            "heading": "4 EVALUATION",
            "text": "Our experiments have been conducted on a laptop with an Intel i7 2.80GHz (4 cores) CPU and 15GB of RAM. Table 1 shows the gas required for performing the computations using the on-chain and off-chain solutions. Performing the MAF query itself using the on-chain solution takes around 4 times as much gas. However, the off-chain solution uses nearly one million gas on verifying the proof and storing the results in the smart contract, which are not required in the on-chain solution."
        },
        {
            "heading": "4.1 HE Performance",
            "text": "The level of security of the Paillier cryptosystem depends on the size of the chosen public modulo. The larger this value, the more difficult it is to break the encryption. However, increasing the public modulo will also negatively impact the performance since the time it takes to encrypt one value increases exponentially with it. In our experiments, encrypting one value using a public modulo of 3072 bits takes around 230 ms. Encrypting one SNP consists of encrypting four values, which effectively means one second for the overall SNP encryption. Thus, the total amount of time required to encrypt a data set increases linearly with the number of SNPs in the data set at around one second per SNP.\nPoster: Privacy-preserving Genome Analysis using Verifiable Off-Chain Computation CCS \u201922, November 7\u201311, 2022, Los Angeles, CA, USA"
        },
        {
            "heading": "4.2 Proof Verification",
            "text": "For verifying the proofs in a smart contract, the verification key is inserted into the smart contract code. Therefore, the larger the size of the verification key, the larger the size of the smart contract. Table 2 shows the size of the verification smart contract in kilobytes and the duration of the proof generation steps for the Groth16 and PLONK schemes. EIP-170 [5] introduced a maximum size for smart contracts deployed on the Ethereum mainnet of 24.576 kB. As can be seen, the smart contract for verifying two 6144-bit values using the PLONK scheme already exceeds this limit, and the Groth16 version nearly hits it. The two main proof constructions used for zk-SNARKS are Groth16 [9] and PLONK [7] both of which are supported by Circom and evaluated in the off-chain solution. Table 2 shows that using PLONK results in worse performance, especially for proof generation. However, an important functional difference is that Groth16 requires a circuit-specific pre-processing ceremony whereas PLONK is based on a general-purpose ceremony."
        },
        {
            "heading": "5 DISCUSSION",
            "text": "The main performance and scalability issue of the off-chain solution is the limited size of data that zk-SNARKS and blockchain systems can handle. Because of the large size of the cipher texts, various workarounds are needed to compute these values in the smart contract and to generate proofs for the computations. For instance, generating a proof for the multiplication of two 3072-bit values 49 registers of 126-bits are required to hold the 6144-bit result.\nMoreover, using such a rollup system is only beneficial when verifying the proof of computation requires fewer resources than performing the computation itself. Meaning that the amount of gas required to perform the on-chain proof verification should not exceed that when running the analysis fully on-chain. Performing the MAF query itself using the off-chain solution saves around 75% of gas compared to performing the entire query on-chain. However, verifying the proof and inserting the results of the computation into the smart contract takes almost ten times as much gas as performing the entire query on-chain. This problem can be mitigated, however, by sending the proof and results to the researcher through an offchain channel.\nFinally, a drawback of the current implementation is that the data used to calculate MAF must be specifically encrypted for the researcher performing the query. Since only the researcher should be able to decrypt the result, the data must be encrypted with the public key of the researcher, and the computations must be performed on this encrypted data."
        },
        {
            "heading": "6 CONCLUSIONS & FUTUREWORK",
            "text": "In this paper, we presented two decentralized solutions for computing MAF while preserving data privacy and supporting verifiability. Several challenges have been identified through the implementation and evaluation of these solutions.\nThe first challenge is related to the handling of large data in zkSNARK systems and in smart contracts. These environments have limited-sized primitive types, resulting in the need for unscalable workarounds. Improving the scalability of these workarounds offers a good research opportunity. The second challenge refers to the current need for encrypting the data for each researcher separately. A solution that requires the data to be encrypted once, but still allows only the researcher performing the query to decrypt the result would greatly improve this system.\nNevertheless, combining privacy-enhancing technologies such as homomorphic encryption and zero-knowledge proofs with a blockchain system is a promising solution for achieving decentralized, privacy-preserving genomic analysis encouraging more individuals to make their genetic data available for research."
        }
    ],
    "title": "Poster: Privacy-preserving Genome Analysis using Verifiable Off-Chain Computation",
    "year": 2022
}