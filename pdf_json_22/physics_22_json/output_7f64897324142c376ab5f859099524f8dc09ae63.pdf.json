{
    "abstractText": "In this paper, we propose a new spectral decomposition method to simulate waves propagating in complicated waveguides. For the numerical solutions of waveguide scattering problems, an important task is to approximate the Dirichlet-to-Neumann map efficiently. From previous results, the physical solution can be decomposed into a family of generalized eigenfunctions, thus we can write the Dirichlet-to-Neumann map explicitly by these functions. From the exponential decay of the generalized eigenfunctions, we approximate the Dirichlet-to-Neumann (DtN) map by a finite truncation and the approximation is proved to converge exponentially. With the help of the truncated DtN map, the unbounded domain is truncated into a bounded one, and a variational formulation for the problem is set up in this bounded domain. The truncated problem is then solved by a finite element method. The error estimation is also provided for the numerical algorithm and numerical examples are shown to illustrate the efficiency of the algorithm.",
    "authors": [
        {
            "affiliations": [],
            "name": "Ruming Zhang"
        }
    ],
    "id": "SP:7339c6d7dc1b4b6d653b0a9cbbef5082fe366eeb",
    "references": [
        {
            "authors": [
                "S.C. Brenner",
                "L.R. Scott"
            ],
            "title": "The Mathematical Theory of Finite Element Methods",
            "year": 1994
        },
        {
            "authors": [
                "F. Cakoni",
                "D. Colton"
            ],
            "title": "Qualitative Methods in Inverse Scattering Theory. An Introduction",
            "year": 2006
        },
        {
            "authors": [
                "T. Dohnal",
                "B. Schweizer"
            ],
            "title": "A bloch wave numerical scheme for scattering problems in periodic wave-guides",
            "venue": "SIAM J. Numer. Anal.,",
            "year": 2018
        },
        {
            "authors": [
                "M. Ehrhardt",
                "H. Han",
                "C. Zheng"
            ],
            "title": "Numerical simulation of waves in periodic structures",
            "venue": "Commun. Comput. Phys.,",
            "year": 2009
        },
        {
            "authors": [
                "M. Ehrhardt",
                "J. Sun",
                "C. Zheng"
            ],
            "title": "Evaluation of scattering operators for semi-infinite periodic arrays",
            "venue": "Commun. Math. Sci.,",
            "year": 2009
        },
        {
            "authors": [
                "C. Engstr\u00f6m"
            ],
            "title": "Spectral approximation of quadratic operator polynomials arising in photonic band structure calculations",
            "venue": "Numer. Math.,",
            "year": 2014
        },
        {
            "authors": [
                "L.C. Evans"
            ],
            "title": "Partial Differential Equations",
            "venue": "AMS,",
            "year": 1998
        },
        {
            "authors": [
                "S. Fliss"
            ],
            "title": "A dirichlet-to-neumann approach for the exact computation of guided modes in photonic crystal waveguides",
            "venue": "SIAM Journal on Scientific Computing,",
            "year": 2013
        },
        {
            "authors": [
                "S. Fliss",
                "P. Joly"
            ],
            "title": "Exact boundary conditions for time-harmonic wave propagation in locally perturbed periodic media",
            "venue": "Appl. Numer. Math.,",
            "year": 2009
        },
        {
            "authors": [
                "S. Fliss",
                "P. Joly"
            ],
            "title": "Solutions of the time-harmonic wave equation in periodic waveguides: asymptotic behaviour and radiation condition",
            "venue": "Arch. Rational Mech. Anal.,",
            "year": 2015
        },
        {
            "authors": [
                "S. Fliss",
                "P. Joly",
                "V. Lescarret"
            ],
            "title": "A dirichlet-to-neumann approach to the mathematical and numerical analysis in waveguides with periodic outlets at infinity",
            "venue": "Pure Appl. Anal.,",
            "year": 2021
        },
        {
            "authors": [
                "G.H. Hardy",
                "J.E. Littlewood"
            ],
            "title": "P\u00f3lya. Inequalities",
            "year": 1988
        },
        {
            "authors": [
                "V. Hoang"
            ],
            "title": "The limiting absorption principle for a periodic semin-infinite waveguide",
            "venue": "SIAM J. Appl. Math.,",
            "year": 2011
        },
        {
            "authors": [
                "T. Hohage",
                "S. Soussi"
            ],
            "title": "Riesz bases and jordan form of the translation operator in semi-infinite periodic waveguides",
            "venue": "J. Math. Pures Appl.,",
            "year": 2013
        },
        {
            "authors": [
                "P. Joly",
                "J.-R. Li",
                "S. Fliss"
            ],
            "title": "Exact boundary conditions for periodic waveguides containing a local perturbation",
            "venue": "Commun. Comput. Phys.,",
            "year": 2006
        },
        {
            "authors": [
                "Yitzhak Katznelson"
            ],
            "title": "An introduction to harmonic analysis",
            "year": 2004
        },
        {
            "authors": [
                "A. Kirsch",
                "A. Lechleiter"
            ],
            "title": "A radiation condition arising from the limiting absorption principle for a closed full- or half-waveguide problem",
            "venue": "Math. Meth. Appl. Sci.,",
            "year": 2018
        },
        {
            "authors": [
                "M. Reed",
                "B. Simon"
            ],
            "title": "Methods of modern mathematical physics. I",
            "year": 1980
        },
        {
            "authors": [
                "M.E. Taylor"
            ],
            "title": "Partial Differential Equations I",
            "year": 2011
        },
        {
            "authors": [
                "Lijun Yuan",
                "Ya Yan Lu"
            ],
            "title": "A recursive-doubling dirichlet-to-neumann-map method for periodic waveguides",
            "venue": "J. Lightwave Technol.,",
            "year": 2007
        },
        {
            "authors": [
                "R. Zhang"
            ],
            "title": "Numerical method for scattering problems in periodic waveguides",
            "year": 1906
        },
        {
            "authors": [
                "R. Zhang"
            ],
            "title": "High order methods for numerical simulations of acoustic waves in locally perturbed periodic waveguides",
            "year": 2021
        },
        {
            "authors": [
                "R. Zhang"
            ],
            "title": "Spectrum decomposition of translation operators in periodic waveguide",
            "venue": "SIAM Journal on Applied Mathematics,",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "Keywords: spectral decomposition, complicated waveguides, Dirichlet-to-Neumann map"
        },
        {
            "heading": "1 Introduction",
            "text": "The numerical simulation of wave propagating in complicated unbounded waveguides is a challenging task, due to the existence of guided waves. To obtain the physical solution, the limiting absorption principle is always a standard way. In the past decades, a number of mathematicians as well as scientists from other disciplines have been working on this topic and several numerical methods have been proposed. In [15], the authors developed a numerical method to approximate the Dirichlet-to-Neumann maps in periodic waveguides, based on a numerical solution of an operator valued Riccati equation. The method is wellknown and applied to other related topics in [8, 9]. We would like to mention that in [11], the authors studied the same problem as in this paper with their method. Another important method, which is called the recursive doubling procedure, was proposed in [20] first for exponential decaying solutions first. The method is later extended to further topics in [4, 5] and the cases with guided waves are also included.\nIn recent years, mathematicians have made great improvements in the analysis of physical solutions in periodic waveguides. The structures of the are described by the radiation conditions, see [10,13,14,17] for details. Although there are several versions of radiation conditions, they are equivalent in principle. Generally speaking, a physical solution is composed of a finite number of propagating modes and an evanescent part. With this property, a Bloch wave decomposition method was proposed in [3] for physical solutions in the joint of two different periodic half waveguides. In [21, 22], the author also proposed the numerical method for (locally perturbed) periodic waveguides based on the Floquet-Bloch transform.\nIn this paper, we propose a spectral decomposition method to approximate the DtN map, which is given explicitly by the radiation condition, and then solve this problem numerically. This method is based on the spectral analysis of the translation operator for the physical solutions in periodic waveguides, in the author\u2019s previous paper [23]. In this paper, the physical solution is decomposed into a finite number of propagating modes and a countable number of evanescent modes, which are generalized eigenfunctions for quasi-periodic problems. More precisely, compared to the existing results, the evanescent part of the\n\u2217Institute of Applied and Numerical mathematics, Karlsruhe Institute of Technology, Karlsruhe, Germany ; ruming.zhang@kit.edu.\nar X\niv :2\n20 7.\n12 69\n0v 1\n[ m\nat h.\nN A\n] 2\n6 Ju\nl 2 02\n2\nphysical solution can also be decomposed into a discrete set of evanescent modes. The evanescent modes decays exponentially, and the decay rate is determined by the corresponding eigenvalues. From the results in [14], a distribution of the eigenvalues are studied and we can get a very accurate estimation of the number of generalized eigenfunctions and their decay rate. These two papers inspire the new method in this paper.\nFrom the decomposition of the physical solutions, we write out the Dirichlet-to-Neumann map explicitly by the generalized eigenfunctions. Then we approximate the Dirichlet-to-Neumann map by a finite truncation and the approximation also converges to the exact one exponentially. Then the domain is truncated into a bounded one from the Dirichlet-to-Neumann map, and a variational formulation for the problem is set up in this bounded domain. Finally we solve the problem by a finite element method. The error estimation is also provided for the numerical algorithm.\nNote that this method was mentioned in Section 4.4, [4]. However, the authors didn\u2019t work on this method due to the lack of results at that time. They also proposed two disadvantages according to the method. First, it is not easy to have an accurate approximation of small Floquet multipliers; second, the generalized eigenfunctions are not orthogonal and this makes it difficult to formulate the Dirichletto-Neumann map. Actually, since the generalized eigenfunctions decay very fast, we only need a small number of Floquet multipliers and generalized eigenfunctions. Thus the difficulties make no problem in this case. We will discuss this in Section 3.3 in detail.\nThe rest of the paper is organized as follows. In the second section, the mathematical model for the problem and also important definitions and notations are introduced. In Section 3, some important results for periodic waveguides are recalled. With these information, the variational formulation is set up for the solution in Section 4. The numerical scheme and error estimation are organized in Section 5, and some numerical examples are shown in Section 6."
        },
        {
            "heading": "2 Mathematical model and notations",
            "text": "We consider waves propagating in a complicated waveguide \u2126. Suppose \u2126 is composed of three parts, a left half guide \u2126\u2212 := (\u2212\u221e,\u2212R) \u00d7 (\u2212a, a), a right half guide \u2126+ := (R,+\u221e) \u00d7 (\u2212b, b) and \u21260 the part that joints \u2126\u2212 and \u2126+. Note that the structures of \u2126\u2212 and \u2126+ are not necessarily the same. The domain \u21260 is assumed to be connected and its boundary \u2202\u21260 is composed of finite number of Lipschitz continuous closed curves. For a visualization we refer to Figure 1.\nThe problem is modeled by the following Helmholtz equation:\n\u2206u+ k2qu = f in \u2126; u = 0 on \u2202\u2126. (1)\nThe source term f is assumed to be in L2(\u2126) and also compactly supported in \u21260. The refractive index q \u2208 L\u221e(\u2126) and is strictly positive:\nq(x) \u2265 c > 0 for all x \u2208 \u2126.\nMoreover, the function q is periodic in \u2126\u2212 and \u2126+ in x1-direction. For simplicity, let\nq(x) = { q\u2212(x), when x \u2208 \u2126\u2212; q+(x), when x \u2208 \u2126+;\nwhere q\u2212 is L\u2212-periodic and q+ is L+-periodic. Here the structures of q\u2212 and q+ can be different. We denote the following periodicity cells:\n\u2126+j := (R+ jL+, R+ (j + 1)L+)\u00d7 (\u2212b, b) and \u2126 \u2212 j := (\u2212R+ (j \u2212 1)L\u2212,\u2212R+ jL\u2212)\u00d7 (\u2212a, a),\nwhere j = 0, 1, . . . ,\u221e. Define the line segments\n\u0393+j := {R+ jL+} \u00d7 [\u2212b, b] and \u0393 \u2212 j := {\u2212R+ (j \u2212 1)L\u2212} \u00d7 [\u2212a, a]; j = 0, 1, . . . .\nThen \u0393+j is the left boundary of \u2126 + j and \u0393 + j+1 is its right boundary; \u0393 \u2212 j is the left boundary of \u2126 \u2212 j and \u0393\u2212j+1 is its right boundary. The half guides are composed by the cells:\n\u2126+ = \u222a\u221ej=0\u2126+j ; \u2126\u2212 = \u222a 0 j=\u2212\u221e\u2126 \u2212 j .\nFor simplicity, we can also extend \u2126+ and \u2126\u2212 to the full guide\n\u2126\u0303+ := R\u00d7 (\u2212b, b), \u2126\u0303\u2212 := R\u00d7 (\u2212a, a).\nThus \u2126\u0303+ = \u222aj\u2208Z\u2126+j ; \u2126\u0303\u2212 = \u222aj\u2208Z\u2126 \u2212 j .\nAt the same time, we can also extend q+ and q\u2212 periodically into the full guides \u2126\u0303+ and \u2126\u0303\u2212 and the extended functions are still denoted by q+ and q\u2212.\nWe can also extend our problem to different boundary conditions and the Dirichlet boundary condition is just chosen as an example. Due to the existence of guided modes, the well-known Limiting Absorption Principle (LAP) is applied to the problem to get the unique physical solution. That is, we replace k2 by k2 + i\u03b5 for any \u03b5 > 0 in (1) and obtain the unique solution u\u03b5 \u2208 H\u03031(\u2126) (here H\u03031(\u2126) is the subspace of H1(\u2126) with homogeneous Dirichlet data on \u2202\u2126). Let \u03b5 \u2192 0+, then the limit of u\u03b5 in H\u03031loc(\u2126), which is called an LAP solution in this paper, is the solution we would like to simulate numerically. Especially, when f \u2208 L2(\u21260) and q \u2208 L\u221e(\u2126), the function u \u2208 H\u03032loc(\u2126).\nTo describe the solution obtained by the LAP, it is essential to introduce the radiation conditions in the half-guides \u2126\u2212 and \u2126+. The DtN maps on the left (right) boundary of \u2126+ (\u2126\u2212), which are defined by the radiation conditions, play important roles. Thus we need to introduce some important definitions and results related to the DtN maps."
        },
        {
            "heading": "3 Periodic waveguide problem",
            "text": "In this section, we focus on the problem defined in a reference periodic waveguide W := R \u00d7 (0, 1) with the boundary \u2202W . A number of radiation conditions have been introduced (see [10,13,17]) to characterize the LAP solutions and they are equivalent in principle. We first introduce the cell problems, and then conclude the radiation condition briefly. In the second part, we recall important spectral decomposition of the problem introduced in [23]. At the end, we will estimate the distribution of the eigenvalues of the periodic waveguide. We begin with the following problem:\n\u2206u+ k2qu = g in W ; u = 0 on \u2202W. (2)\nThe refractive index q is strictly positive and periodic in x1-direction:\nq(x) \u2265 c > 0, q(x1 + 1, x2) = q(x1, x2), \u2200x = (x1, x2) \u2208W.\nFor simplicity, we also introduce the following notations. The periodicity cells and edges are denoted by:\nWj := (j, j + 1)\u00d7 (0, 1); \u0393j := {j} \u00d7 (0, 1)."
        },
        {
            "heading": "3.1 Cell problems and the radiation condition",
            "text": "We focus on a reference periodicity cell W0 and let \u03a3\u2212 := (0, 1)\u00d7 {0} and \u03a3+ := (0, 1)\u00d7 {1} be its lower and upper edges. We define space of z-quasi-periodic functions by:\nVz := H\u03031z (W0) = { \u03d5 \u2208 H\u03031(W0) : \u03d5 \u2223\u2223 \u03931 = z\u03d5 \u2223\u2223 \u03930 } for any z \u2208 C. For any z \u2208 C, consider the following problem in Vz:\n\u2206w(z, x) + k2qw(z, x) = 0 in W0. (3)\nSometimes it is more convenient to use \u03b1 := \u2212i log(z) instead of z. Here the logarithm function takes value in the branch cut (\u2212\u03c0, \u03c0] + iR. Then |z| > 1 corresponds to Im (\u03b1) < 0, and |z| < 1 corresponds to Im (\u03b1) > 0, and |z| = 1 corresponds to \u03b1 \u2208 (\u2212\u03c0, \u03c0] . Let V\u03b1 := Vz when z = ei\u03b1. For \u03b1 = 0, the space V0 is composed of periodic functions thus we let Vper := V0 = V1. Since the domains Wn are with the same shape for all n \u2208 Z, we identify H\u03031z (Wn) with V\u03b1 = Vz. With the same reason, we also identify Hs(\u0393n) with Hs(\u03930) for s = \u00b11/2. Moreover, we also let V := H\u03031(W0).\nRemark 1. From now on, we use the notations w(z, x) and w(\u03b1, x) to indicate the same function and this implies that z = ei\u03b1. Similarly for vz and v\u03b1 in the following contents.\nFor simplicity, we introduce a periodization technique. For a function w(\u03b1, \u00b7) \u2208 V\u03b1, define:\nv\u03b1(x) := e \u2212i\u03b1x1w(\u03b1, x) \u2208 Vper.\nFrom direct calculation, v\u03b1 satisfies\n\u2206v\u03b1 + 2i\u03b1 \u2202v\u03b1 \u2202x1 + (k2q \u2212 \u03b12)v\u03b1 = e\u2212i\u03b1x1g(x) in W0; v\u03b1|\u03931 = v\u03b1|\u03930 . (4)\nThe variational form of the above equation is to find v\u03b1 \u2208 Vper such that\u222b W0 [ \u2207v\u03b1 \u00b7 \u2207\u03d5\u2212 2i\u03b1 \u2202v\u03b1 \u2202x1 \u03d5\u2212 (k2q \u2212 \u03b12)v\u03b1\u03d5 ] dx = \u2212 \u222b W0 e\u2212i\u03b1x1g(x)\u03d5(x) dx (5)\nholds for any \u03d5 \u2208 Vper. This problem can be written as\n\u3008A\u03b1v\u03b1, \u03d5\u3009Vper = \u3008F\u03b1g, \u03d5\u3009Vper (6)\nwhere A\u03b1 : Vper \u2192 Vper is a Fredholm operator depends analytically on \u03b1 \u2208 C (see [17]) and F\u03b1 : L2(W0)\u2192 Vper depends analytically on \u03b1. Moreover, A\u03b1 is self-adjoint when \u03b1 is real.\nFrom the analytic Fredholm theorem (Theorem VI.14, [18]), all the points z \u2208 C such that (3) has nontrivial solutions in Vz (or equivalently, those \u03b1 = \u2212i log(z) where A\u03b1 is not invertible in Vper) compose a discrete set F \u2282 C\u00d7 := C \\ {0}, then v depends analytically on z \u2208 C\u00d7 \\ F and meromorphically on z \u2208 C\u00d7. For details we refer to Theorem 9 in [23]. In the following, we introduce the set F in details.\n\u2022 Define the set UF := {z \u2208 F : |z| = 1} ,\nthen it is finite (can be empty). Suppose z \u2208 UF, the nontrivial solution w(z, \u00b7) \u2208 Vz is a propagating mode or a Bloch wave. We recall some important facts introduced in [17]. Suppose for a fixed z \u2208 UF, N is the space spanned by all the nontrivial solutions of (3) in Vz. Then N is a finite dimensional space with the dimension m. There is an orthonormal basis of N , denoted by {\u03d5j \u2208 N : j = 1, 2, . . . ,m} such that the following equations hold:\n\u2212i \u222b W0 \u2202\u03d5j \u2202x1 \u03c8 dx = k\u03bbj \u222b W0 n\u03d5j\u03c8 dx \u2200\u03c8 \u2208 N ; k \u222b W0 n\u03d5j\u03d5j\u2032 dx = \u03b4j,j\u2032 \u2200 j, j\u2032 = 1, . . . ,m, (7)\nwhere \u03bbj \u2208 R and \u03b4j,j\u2032 is the Kronecker delta function. In particular, when \u03c8 = \u03d5j , \u2212i \u222b W0 \u2202\u03d5j \u2202x1 \u03d5j dx = \u03bbj . (8)\nWe can also decide the direction that \u03d5j propagates from the sign of the parameter \u03bbj . When \u03bbj > 0, \u03d5j propagates to the right; when \u03bbj < 0, \u03d5j propagates to the left; while when \u03bbj = 0, \u03d5j is a standing wave which has to be avoided (see Assumption 2).\n\u2022 Suppose z \u2208 F and |z| < 1, then the nontrivial solution w(z, \u00b7) \u2208 Vz can be extended z-quasiperiodically to a solution in the full guide W that decays exponentially when x1 \u2192 \u221e. Let N be the space spanned by all the generalized eigenfunctions of (3) in Vz with the dimension m. Then it is spanned by the linear independent vectors \u03d51, . . . , \u03d5m, and the residue\u222e\nCz\nw(z, x) dz = m\u2211 `=1 c` \u03d5`(x)\nwhere c` \u2208 C are the coefficients and Cz is the counterclockwise circle with center z which encircles only one element z \u2208 F.\n\u2022 When z \u2208 F with |z| > 1, everything is similar but the corresponding generalized eigenfunctions are decaying exponentially when x1 \u2192 \u2212\u221e.\nWe need the following assumption to guarantee that the LAP works.\nAssumption 2. Assume that for k and q appear in this paper, there is no standing wave in either \u2126\u2212 or \u2126+.\nFinally we introduce some useful notations. Since UF is symmetric, let\nUF+ = {z+1 , z + 2 , . . . , z + J }; UF\u2212 = {z \u2212 1 , z \u2212 2 , . . . , z \u2212 J }\nwhere z+j = z \u2212 j . Moreover, z + j is associated with a rightward propagating wave and z \u2212 j is associated with a leftward propagating wave. Note that it is possible that UF+ \u2229 UF\u2212 6= \u2205. Then we define the sets\nF+ = {z+1 , z + 2 , . . . , z + J , z + J+1, . . . }; F\u2212 = {z \u2212 1 , z \u2212 2 , . . . , z \u2212 J , z \u2212 J+1, . . . },\nwhere F = F+ \u222a F\u2212. Moreover, \u2223\u2223z+j \u2223\u2223 < 1 and \u2223\u2223z\u2212j \u2223\u2223 > 1 for all j \u2265 J + 1, and the points are ordered by:\n\u221e > \u00b7 \u00b7 \u00b7 \u2265 \u2223\u2223z\u2212J+2\u2223\u2223 \u2265 \u2223\u2223z\u2212J+1\u2223\u2223 > 1 > \u2223\u2223z+J+1\u2223\u2223 \u2265 \u2223\u2223z+J+2\u2223\u2223 \u2265 \u00b7 \u00b7 \u00b7 > 0.\nFor each z\u00b1j (j \u2265 1), let N \u00b1 j be the space spanned by all the nontrivial solutions of (3) in Vz\u00b1j with the dimension m\u00b1j . We also assume that the spaces are spanned by the following linear independent basis:\nN+j := span { \u03d5+j,1, \u03d5 + j,2, . . . , \u03d5 +\nj,m+j\n} ; N\u2212j := span { \u03d5\u2212j,1, \u03d5 \u2212 j,2, . . . , \u03d5\n\u2212 j,m\u2212j\n} ."
        },
        {
            "heading": "3.2 Spectral decomposition of the LAP solution",
            "text": "In this subsection, we recall the spectral decomposition of the LAP solution developed in [23]. We recall the decomposition of the solution in the following theorem.\nTheorem 3 (Theorem 27, [23]). Suppose Assumption 2 holds. Then for n \u2265 1,\nu(x1 + n, x2) = J\u2211 j=1 m+j\u2211 `=1\n\u2329 g, \u03d5+j,` \u232a 2\u03bb+j,` ein\u03b1 + j \u03d5+j,`(x) + \u221e\u2211 j=J+1 Res ( w(z, x)zn\u22121, z = z+j ) ; (9)\nu(x1 \u2212 n, x2) = J\u2211 j=1 m\u2212j\u2211 `=1\n\u2329 g, \u03d5\u2212j,` \u232a 2\u03bb\u2212j,` e\u2212in\u03b1 \u2212 j \u03d5\u2212j,`(x) + \u221e\u2211 j=J+1 Res ( w(z, x)z\u2212n\u22121, z = z\u2212j ) , (10)\nwhere \u03bb\u00b1j,` is obtained from (8), and the residue is defined as:\nRes (w(z, x)zm, z = z0) := \u222e |z\u2212z0|=\u03b4 w(z, x)zm dz ,\nand w(z, x) satisfies (4) with z = ei\u03b1 and f be replaced by g, the disk with center z0 and radius \u03b4 > 0 only contains one pole z0 \u2208 F.\nChoose two values 0 < r < 1 < R such that there is no point in F that lies on the circles with the center at 0 and radius r and R, i.e., {z \u2208 C : |z| = r} \u2229 F = {z \u2208 C : |z| = R} \u2229 F = \u2205, we define the following integral for n \u2265 1:\nI+n,r g := \u222e |z|=r w(z, x)zn\u22121 dz ; I\u2212\u2212n,R g := \u222e |z|=R w(z, x)z\u2212n\u22121 dz .\nThus I+n,r and I \u2212 \u2212n,R are linear operators from L 2(W0) to V . The following result comes directly from the residue theorem in Banach spaces.\nCorollary 4. Suppose Assumption 2 holds. Then the following conditions hold for any 0 < r < 1 < R and n \u2265 1,\nu(x1 + n, x2) = J+r\u2211 j=1 m+j\u2211 `=1 c+j,`e in\u03b1+j \u03d5+j,`(x) + I + n,r g; (11) u(x1 \u2212 n, x2) = J\u2212R\u2211 j=1 m\u2212j\u2211 `=1 c\u2212j,`e \u2212in\u03b1\u2212j \u03d5\u2212j,`(x) + I \u2212 \u2212n,R g; (12)\nwhere J+r and J \u2212 R are the positive integers such that\u2223\u2223\u2223z+\nJ+r \u2223\u2223\u2223 > r > \u2223\u2223\u2223z+ J+r +1 \u2223\u2223\u2223 , \u2223\u2223\u2223z\u2212 J\u2212R \u2223\u2223\u2223 < R < \u2223\u2223\u2223z+ J\u2212R +1 \u2223\u2223\u2223 , and c\u00b1j,` = \u3008g,\u03d5\u00b1j,`\u3009 2\u03bbj,` when j = 1, 2, . . . , J and ` = 1, 2, . . . ,m\u00b1j .\nDefine the operators by:\nK+n,r g := J+r\u2211 j=1 m+j\u2211 `=1 c+j,`e in\u03b1+j \u03d5+j,`(x), and K \u2212 \u2212n,R g := J\u2212R\u2211 j=1 m\u2212j\u2211 `=1 c\u2212j,`e \u2212in\u03b1\u2212j \u03d5\u2212j,`(x).\nWhen r = 0 and R =\u221e, the two operators are defined in the following way\nK+n,0g := \u221e\u2211 j=1 m+j\u2211 `=1 c+j,`e in\u03b1+j \u03d5+j,`(x), and K \u2212 \u2212n,\u221eg := \u221e\u2211 j=1 m\u2212j\u2211 `=1 c\u2212j,`e \u2212in\u03b1\u2212j \u03d5\u2212j,`(x).\nThen the following result comes immediately as a corollary of Theorem 18, [23].\nLemma 5. Suppose 0 < r < 1 < R <\u221e are two numbers such that {z \u2208 C : |z| = r or |z| = R} \u2229 F = \u2205. Then\nK+n,0 = K+n,r + I+n,r; K \u2212 \u2212n,\u221e = K\u2212\u2212n,R + I \u2212 \u2212n,R where n \u2265 1. (13)\nFor each fixed n \u2265 1, there is a constant C > 0 such that\u2225\u2225K+n,0 g\u2225\u2225V \u2264 C\u2016g\u2016L2(W0); \u2225\u2225K\u2212\u2212n,\u221e g\u2225\u2225V \u2264 C\u2016g\u2016L2(W0). In the next theorem, we will estimate the terms I+n,rg and I \u2212 n\u2212,Rg, when r and R take some special values.\nTheorem 6. For each m \u2208 N, define rm := exp ( \u2212\u03c0 \u221a m2+(m+1)2\n2\n) and Rm := exp ( \u03c0 \u221a m2+(m+1)2\n2\n) ,\nthen we have the following estimations for n \u2265 1:\u2225\u2225I+n,rm g\u2225\u2225V \u2264 Ce\u2212\u03c0(n\u22121)m\u2016g\u2016L2(W0) (14) and \u2225\u2225\u2225I\u2212\u2212n,Rm g\u2225\u2225\u2225V \u2264 Ce\u03c0(n\u22121)m\u2016g\u2016L2(W0). (15) Here the constant C does not depend on m, n and g.\nProof. We begin with the estimation of I+n,rmg. From Lemma 26, [23], for any \u03b8 \u2208 (\u2212\u03c0, \u03c0], zm(\u03b8) := rme\ni\u03b8 /\u2208 F. Moreover, \u2016w (zm(\u03b8), \u00b7)\u2016L2(W0) \u2264 Ce \u03c0mm\u22121\u2016g\u2016L2(W0), (16)\nwhere C does not depend on m, \u03b8 and g. In (5), let \u03b1 be replaced by \u03b1 + i\u03b2 := \u2212i log(z) and v\u03b1 = \u03d5 = w (zm(\u03b8), \u00b7) in (5), take the real part, we get:\u222b\nW0\n[ |\u2207w (zm(\u03b8), x)|2 \u2212 2i\u03b1 \u2202w (zm(\u03b8), x)\n\u2202x1 w (zm(\u03b8), x)\u2212 (k2q + \u03b22 \u2212 \u03b12) |w (zm(\u03b8), x)|2\n] dx\n= \u2212Re (\u222b\nW0\nz\u2212x1g(x)w (zm(\u03b8), x) dx ) With Young\u2019s inequality and H\u00f6lder\u2019s inequality,\n\u2016\u2207w (zm(\u03b8), \u00b7)\u20162L2(W0) \u2264 1\n2 \u2225\u2225\u2225\u2225\u2202w(zm(\u03b8), \u00b7)\u2202x1 \u2225\u2225\u2225\u22252 L2(W0) + 2\u03b12 \u2016w(zm(\u03b8), \u00b7)\u20162L2(W0)\n+ \u2225\u2225k2q + \u03b22 \u2212 \u03b12\u2225\u2225\u221e \u2016w(zm(\u03b8), \u00b7)\u20162L2(W0) + \u2225\u2225z\u2212x1\u2225\u2225\u221e \u2016g\u2016L2(W0) \u2016w(zm(\u03b8), \u00b7)\u2016L2(W0) .\nUse the fact that \u2225\u2225\u2225\u2202w(zm(\u03b8),\u00b7)\u2202x1 \u2225\u2225\u2225L2(W0) \u2264 \u2016\u2207w (zm(\u03b8), \u00b7)\u2016L2(W0), since \u03b1 \u2208 (\u2212\u03c0, \u03c0] and \u03b2 = O(m),\n\u2016\u2207w (zm(\u03b8), \u00b7)\u20162L2(W0) \u2264 2(k 2\u2016q\u2016\u221e + \u03b22 + 3\u03b12) \u2016w(zm(\u03b8), \u00b7)\u20162L2(W0) + r \u22121/2 m \u2016g\u2016L2(W0) \u2016w(zm(\u03b8), \u00b7)\u2016L2(W0)\n\u2264 C(k2\u2016q\u2016\u221e + \u03b22 + 3\u03b12)e2\u03c0mm\u22122\u2016g\u20162L2(W0) + Ce 2\u03c0mm\u22121\u2016g\u20162L2(W0) \u2264 Ce\u03c0m\u2016g\u2016L2(W0).\nTogether with the estimation for the L2-norm in (16), we get the estimation:\n\u2016w (zm(\u03b8), \u00b7)\u2016V \u2264 Ce \u03c0m\u2016g\u2016L2(W0).\nThus we plug this result to I+n,rmg, and use Minkowski\u2019s integral inequality (Theorem 202, [12]):\n\u2225\u2225I+n,rmg\u2225\u2225V = \u2225\u2225\u2225\u2225\u2225 \u222e |z|=rm w(z, x)zn\u22121 dz \u2225\u2225\u2225\u2225\u2225 V = \u2225\u2225\u2225\u2225irnm \u222b \u03c0 \u2212\u03c0 w(zm(\u03b8), x)e in\u03b8 d\u03b8 \u2225\u2225\u2225\u2225 V\n\u2264 Crnm \u222b \u03c0 \u2212\u03c0 \u2016w(zm(\u03b8), \u00b7)\u2016Vper d\u03b8 \u2264 Ce \u2212\u03c0(n\u22121)m\u2016g\u2016L2(W0).\nThus I+n,rm is a bounded linear operator from L 2(W0) to V .\nFor I\u2212\u2212n,Rm , the proof is similar by replacing z with z \u22121 thus is omitted.\nLemma 7. When n \u2265 2, the operators K+n,0 and K \u2212 \u2212n,\u221e are compact from L2(W0) to V .\nProof. First consider K+n,0 = K+n,rm + I + n,rm where rm := exp\n( \u2212\u03c0 \u221a m2+(m+1)2\n2\n) . Note that K+n,rm is a\nfinite rank operator, then we only need to study the properties of I+n,rm .\nFrom Theorem 6, for a fixed n \u2265 1, there is a constant C > 0 such that\n\u2016I+n,rm g\u2016V \u2264 Ce \u2212(n\u22121)\u03c0m\u2016g\u2016L2(\u2126+0 ) \u2192 0, as m\u2192\u221e.\nThus K+n,0 = K+n,rm + I + n,rm is the limit of a sequence of finite rank operators K + n,rm , it is compact. The proof of K\u2212\u2212n,\u221e is similar thus is omitted.\nFor any g \u2208 L2(W0), un = K+n,0 g and u\u2212n = K \u2212 \u2212n,\u221e g satisfy\n\u2206un + k 2qun = 0 in Wn; \u2206u\u2212n + k2qu\u2212n = 0 in W\u2212n\nwith homogeneous Dirichlet boundary conditions on the upper and lower boundaries of W\u00b1n. For the structures of Wn and W\u2212n we refer to Fig 3.2. Since un, u\u2212n \u2208 V , we conclude that\nR ( K+n,0 ) , R ( K\u2212\u2212n,\u221e ) \u2282 { \u03d5 \u2208 V : \u2206\u03d5 \u2208 L2(W0) } .\nFrom Theorem 5.5, [2], \u2202un\u2202x1 \u2223\u2223\u2223 \u0393n , \u2202u\u2212n\u2202x1 \u2223\u2223\u2223 \u0393\u2212n+1\n\u2208 H\u22121/2(\u03930). Define the trace operators\n\u03b3+0 \u03d5 := \u03d5|\u0393n and \u03b3 + 1 \u03d5 :=\n\u2202\u03d5\n\u2202x1 \u2223\u2223\u2223\u2223 \u0393n for \u03d5 \u2208 R ( K+n,0 ) ;\n\u03b3\u22120 \u03d5 := \u03d5|\u0393\u2212n+1 and \u03b3 \u2212 1 \u03d5 :=\n\u2202\u03d5\n\u2202x1 \u2223\u2223\u2223\u2223 \u0393\u2212n+1 for \u03c8 \u2208 R ( K\u2212\u2212n,\u221e ) Then\n\u2202u\n\u2202x1 \u2223\u2223\u2223\u2223 \u0393n = \u03b3+1 [ K+n,r + I+n,r ] g, where u \u2223\u2223 \u0393n = \u03b3+0 [ K+n,r + I+n,r ] g; (17)\n\u2202u\n\u2202x1 \u2223\u2223\u2223\u2223 \u0393\u2212n+1 = \u03b3\u22121 [ K\u2212\u2212n,R + I \u2212 \u2212n,R ] g, where u \u2223\u2223 \u0393\u2212n+1 = \u03b3\u22120 [ K\u2212\u2212n,R + I \u2212 \u2212n,R ] g. (18)\nLet W+ := (0,+\u221e)\u00d7 (0, 1) be a halfguide and u+ be the LAP solution of\n\u2206u+ + k 2qu+ = 0 in W+; u+ = 0 on \u2202W+ \\ \u03930; u+ = \u03d5 on \u03930\nfor a \u03d5 \u2208 H1/2(\u03930), then define the DtN map T+ by\nT+ [ \u03d5 \u2223\u2223 \u03930 ] = \u2202u+ \u2202x1 \u2223\u2223\u2223\u2223 \u03930 .\nSimilarly, let W\u2212 := (\u2212\u221e, 0)\u00d7 (0, 1) and u\u2212 be the LAP solution that satisfies\n\u2206u\u2212 + k 2qu\u2212 = 0 in W\u2212; u\u2212 = 0 on \u2202W\u2212 \\ \u03930; u\u2212 = \u03c8 on \u03930.\nfor a \u03c8 \u2208 H1/2(\u03930), then define the DtN map T\u2212 by\nT\u2212 [ \u03c8 \u2223\u2223 \u03930 ] = \u2212 \u2202u\u2212\n\u2202x1 \u2223\u2223\u2223\u2223 \u03930 .\nTo make sure that T\u00b1 are well defined, we need the following assumption.\nAssumption 8 (Assumption 5.1, [17]). The only solution u\u00b1 \u2208 H1(W\u00b1) that satisfies\n\u2206u\u00b1 + k 2qu\u00b1 = 0 in W\u00b1; u\u00b1 = 0 on \u2202 W\u00b1\nis the trivial one.\nWith above assumption, Theorem 5.4 in [17] showed that the half-guide problems are well-posed and the solutions u\u00b1 \u2208 H1loc(W\u00b1) depend continuously on the boundary data \u03d5,\u03c8 \u2208 H1/2(\u03930). The following lemma is a corollary of this theorem.\nLemma 9. With Assumption 2 and 8, the operators T\u00b1 are bounded from H1/2(\u03930) to H\u22121/2(\u03930).\nFrom the definitions of the operators T\u00b1, we rewrite the boundary condition for LAP solutions in W . For an LAP solution u of (2),\n\u2202u\n\u2202x1 \u2223\u2223\u2223\u2223 \u0393n = T+\u03b3+0 [ K+n,r + I+n,r ] g;\n\u2202u\n\u2202x1 \u2223\u2223\u2223\u2223 \u0393\u2212n+1 = T\u2212\u03b3\u22120 [ K\u2212\u2212n,R + I \u2212 \u2212n,R ] g, (19)\nwhere u|\u0393n = \u03b3 + 0 [ K+n,r + I+n,r ] g; u|\u0393\u2212n+1 = \u03b3 \u2212 0 [ K\u2212\u2212n,R + I \u2212 \u2212n,R ] g."
        },
        {
            "heading": "3.3 Estimation of number of generalized eigenfunctions",
            "text": "From (19), (13) and the definitions of K+n,0 and K \u2212 \u2212n,\u221e, the DtN maps T\u00b1 are defined by infinite number of generalized eigenfunctions. In this subsection, we would like to estimate the dimension of the eigenspace related to the eigenvalues lying in the rectangle\nD+m := [\u2212\u03c0, \u03c0] + i[0, \u03c0m) or D\u2212m := [\u2212\u03c0, \u03c0] + i(\u2212\u03c0m, 0], (20)\nwhen m is a positive integer. The estimation is based on Proposition 4.2 in [14]. Recall that the operator A\u03b1, which is defined by the left hand side in (5), it depends on the refractive index q. So we rewrite it as Aq(\u03b1). Then A0(\u03b1) is related to the case that q = 0, which comes directly from the Laplacian operator. All these \u03b1 \u2208 C such that A0(\u03b1) is not invertible are given explicitly by:\n\u03b1j,` = 2\u03c0j \u00b1 i\u03c0`; \u03d5 = exp (i [2\u03c0j \u00b1 i\u03c0`]x1) sin(\u03c0`x2), j \u2208 Z, ` = 1, 2, . . . ,\u221e.\nSince we are only interested in the values in (\u2212\u03c0, \u03c0] + iR, let\u2019s focus on the values with j = 0. Moreover, we only focus on the domain that lies above the real axis since the domain below is symmetric. So we define the reference points as \u03b1rn = i\u03c0n, n = 1, 2, . . . ,\u221e. For simplicity, let the dimension of the eigenspace of Aq(\u03b1) at the point \u03b10 be denoted by N(Aq(\u03b1);\u03b10). Suppose \u0393 is a closed curve that encircles the points \u03b11, . . . , \u03b1p, then letN(Aq(\u03b1); \u0393) = \u2211q j=1 N(Aq(\u03b1);\u03b1q).\nBefore the introduction of the result in Proposition 4.2 in [14], we define the open disc Dn := { z \u2208 C : |z \u2212 \u03b1rn| <\n2k2\u2016q\u2016\u221e \u03c0(2n\u2212 1) } and the closed rectangle\nNn := [\u2212\u03c0, \u03c0] + i [( n\u2212 1\n2\n) \u03c0, ( n+ 1\n2\n) \u03c0 ] .\nTheorem 10 (Proposition 4.2 in [14]). Let N0 be a positive integer which is defined by\nN0 \u2265 min { n \u2208 N : \u03c0(2n\u2212 1)\n2 \u2265 k 2\u2016q\u2016\u221e \u03c0\n} ,\ntake n \u2265 N0. Then N(Aq(\u03b1); \u2202Dn) = N(Aq(\u03b1);Nn) = 1.\nFrom Theorem 10, we estimate N(Aq(\u03b1); \u2202D+m). Let the number of points in F lying in the domain D+N0\u22121/2 be M0, then we can estimate the number for a general m > 0. Then\nN(Aq(\u03b1); \u2202D + m) \u2264 { M0, when m \u2264 N0 \u2212 1/2; M0 + \u2308 m\u2212N0 + 12 \u2309 , when m > N0 \u2212 1/2;\nwhere dse is the largest integer which is no larger than s. So from above arguments, it is concluded that\nN(Aq(\u03b1); \u2202D + m) = O(m).\nThus the dimension of the eigenspace related to eigenvalues lying in D+m is O(m). The result is the same for D\u2212m."
        },
        {
            "heading": "4 Variational formulation",
            "text": "In this section, we introduce a variational formulation for the LAP solution u to the equation (1) in the open bounded domain D such that:\nD = \u2126\u22121 \u222a \u2126 \u2212 0 \u222a \u21260 \u222a \u2126 + 0 \u222a \u2126 + 1 .\nSince we have to use the results for periodic waveguides, we first extend the LAP solution u restricted in \u2126+ (\u2126\u2212) to the full waveguide \u2126\u0303+ (\u2126\u0303\u2212). Let X+ and X\u2212 be two smooth functions which satisfy\nX+(x1) =  1, x1 \u2265 R+ L+; 0, x1 \u2264 R; smooth, otherwise;\nX\u2212(x1) =  1, x1 \u2264 \u2212R\u2212 L\u2212; 0, x1 \u2265 \u2212R; smooth, otherwise.\nLet u\u0303+(x) := X+(x1)u(x) and extend it by 0 into \u2126\u0303+. Then it is a solution of\n\u2206u\u0303+ + k 2q+u\u0303+ =M+u ( := 2X \u2032+(x1) \u2202u(x)\n\u2202x1 + X \u2032\u2032+(x1)u(x)\n) in \u2126\u0303+; u\u0303+ = 0 on \u2202\u2126\u0303+. (21)\nSimilarly, let u\u0303\u2212(x) := X\u2212(x1)u(x) and extend it by 0 into \u2126\u0303\u2212, then it satisfies\n\u2206u\u0303\u2212 + k 2q\u2212u\u0303\u2212 =M\u2212u ( := 2X \u2032\u2212(x1) \u2202u(x)\n\u2202x1 + X \u2032\u2032\u2212(x1)u(x)\n) in \u2126\u0303\u2212; u\u0303\u2212 = 0 on \u2202\u2126\u0303\u2212; (22)\nThe operatorM+ (M\u2212) is bounded from H\u03031(\u2126+0 ) (H\u03031(\u2126 \u2212 0 )) to L 2(\u2126+0 ) (L 2(\u2126\u22120 )), and there is a constant"
        },
        {
            "heading": "C > 0 such that \u2225\u2225M+u\u2225\u2225",
            "text": "L2(\u2126+0 ) \u2264 C\u2016u\u2016H\u03031(\u2126+0 ), \u2225\u2225M\u2212u\u2225\u2225 L2(\u2126\u22120 ) \u2264 C\u2016u\u2016H\u03031(\u2126\u22120 ).\nFrom Corollary 4, the solutions u\u0303+ and u\u0303\u2212 are the unique LAP solutions of (21) and (22) in \u2126\u0303+ and \u2126\u0303\u2212 with source termsM+u andM\u2212u, respectively. Moreover, from their definitions,\nu\u0303+|\u2126+\\\u2126+0 = u| \u2126+\\\u2126+0 ; u\u0303\u2212|\u2126\u2212\\\u2126\u22120 = u| \u2126\u2212\\\u2126\u22120 .\nFrom (19),\n\u2202u\u0303+ \u2202x1 \u2223\u2223\u2223\u2223 \u0393+2 = T+\u03b3+0 [ K+r + I+r ] M+u, where u\u0303+|\u0393+2 = \u03b3 + 0 [ K+r + I+r ] M+u;\n\u2202u\u0303\u2212 \u2202x1 \u2223\u2223\u2223\u2223 \u0393\u2212\u22121 = T\u2212\u03b3\u22120 [ K\u2212R + I \u2212 R ] M\u2212u, where u\u0303\u2212|\u0393\u2212\u22121 = \u03b3 \u2212 0 [ K\u2212R + I \u2212 R ] M\u2212u;\nwhere K+r = K+2,r, I + 2,r, K \u2212 R = K \u2212 \u22122,R and I \u2212 R = I \u2212 \u22122,R.\nWith these boundary conditions, the problem can be formulated in the bounded domain D. Let\nVD := { \u03d5 \u2208 H1(D) : \u03d5 = 0 on \u2202D \u2229 \u2202\u2126 } .\nThen we look for u \u2208 VD such that\u222b D [ \u2207u \u00b7 \u2207\u03d5\u2212 k2nu\u03d5 ] dx \u2212 \u222b \u0393+2 \u2202u \u2202x1 \u03d5ds + \u222b \u0393\u2212\u22121 \u2202u \u2202x1 \u03d5ds = \u2212 \u222b D f\u03d5dx (23)\nholds for all \u03d5 \u2208 VD. From Riesz representation theorem, we can define the following operators in VD by: \u3008Au,\u03d5\u3009VD = \u222b D [ \u2207u \u00b7 \u2207\u03d5\u2212 k2nu\u03d5 ] dx ; \u2329 D+u, \u03d5 \u232a VD = \u222b \u0393+2 \u2202u \u2202x1 \u03d5ds ; \u2329 D\u2212u, \u03d5 \u232a VD = \u2212 \u222b \u0393\u2212\u22121 \u2202u \u2202x1 \u03d5ds .\nThen (23) is written as the equivalent form:\n(A\u2212D+ \u2212D\u2212)u = F, (24)\nwhere F \u2208 VD such that \u3008F,\u03d5\u3009VD = \u2212 \u222b D f\u03d5dx . Since the operator A is Fredholm, we still need to study the operators D\u00b1. Let \u03b3+ : \u03d5 7\u2192 \u03d5 \u2223\u2223 \u0393+2 and \u03b3\u2212 : \u03d5 7\u2192 \u03d5 \u2223\u2223 \u0393\u2212\u22121\nbe the trace operators from VD to H1/2(\u03932) and H1/2(\u0393\u22122). Then from a duality argument,\nD+ = ( \u03b3+ )\u2217 T+\u03b3+0 [ K+r + I+r ] M+ and D\u2212 = ( \u03b3\u2212 )\u2217 T\u2212\u03b3\u22120 [ K\u2212R + I \u2212 R ] M\u2212.\nFrom Lemma 9, T\u00b1 are bounded. From the boundedness of \u03b3\u00b1, \u03b3\u00b10 andM\u00b1, with the results in Lemma 7, D\u00b1 are compact operators. Then A \u2212 D+ \u2212 D\u2212 is a Fredholm operator. Thus it is invertible if and only if it is uniquely solvable. To guarantee that the original problem (1) has a unique solution, we make the following assumption.\nAssumption 11. For given k > 0 and n \u2208 L\u221e(\u21260), there is no eigenfunctions of (1).\nWith Assumption 11, the following well-posedness result is obvious from the Fredholm alternative.\nTheorem 12. Suppose Assumptions 2, 11 and 8 hold. The problem (24) has a unique solution which satisfies the radiation condition defined in Theorem 3.\nTheorem 13. With Assumptions 2, 11 and 8, the unique solution of (24) in VD is equivalent to the LAP solution of (1).\nProof. Suppose u is the LAP solution of (1). From the constructions above, the solution u \u2223\u2223 D is an element in VD and satisfies (23) which is equivalent to (24). Suppose u is the solution of (24), then u satisfies \u2206u+ k2qu = 0 in \u2126+0 \u222a \u2126 + 1 with u = 0 on the lower and upper boundaries of \u2126+. Let u\u0303+(x) := X+(x1)u(x) and extend it by 0 to \u2126\u0303+ \\\u2126+. Define the domain \u2126\u0303\u2212+ by \u2126\u0303+ \\ ( \u2126+ \\ (\u2126+0 \u222a \u2126 + 1 ) ) , then u\u0303+ satisfies\n\u2206u\u0303+ + k 2q+u\u0303+ =M+u in \u2126\u0303\u2212+; u\u0303+ = 0 on \u2202\u2126\u0303\u2212+ \u2229 \u2202\u2126.\nFrom definition of D+ and the fact that u = u\u0303+ in \u2126+1 ,\n\u2202u\u0303+ \u2202x2 \u2223\u2223\u2223\u2223 \u0393+2 = T+\u03b3+0 [ K+r + I+r ] M+u, where u\u0303+|\u0393+2 = \u03b3 + 0 [ K+r + I+r ] M+u.\nWe define the function u\u0303+ by u\u0303+(x1 + n, x2) := [ K+n,r + I+n,r ] M+u, n = 2, 3, . . . .\nThen u\u0303+ as well as its derivative are continuous across the boundary \u0393+2 . This implies that u\u0303+ is extended to be an LAP solution in H1loc ( \u2126\u0303+ ) . Since u = u\u0303+ in \u2126+1 , u is also extended to \u2126+ and satisfies the radiation conditions (11)-(12). With a similar process, we also extend u to \u2126\u2212 as an LAP solution. Thus u is the LAP solution of (1). From Assumption 11, there is no eigenfunction of (1). Thus the LAP solution for the problem is unique. So u is the unique LAP solution of (1).\nFrom perturbation theory, we approximate the problem (23) by the following modified problem:\u222b D [ \u2207u \u00b7 \u2207\u03d5\u2212 k2nu\u03d5 ] dx \u2212 \u2329 T+\u03b3+0 K+rM+u, \u03d5 \u232a L2(\u0393+2 ) + \u2329 T\u2212\u03b3\u22120 K \u2212 RM \u2212u, \u03d5 \u232a L2(\u0393\u2212\u22121) = \u2212 \u222b D f\u03d5dx (25)\nTheorem 14. Let rm := exp ( \u2212\u03c0L+ \u221a m2+(m+1)2\n2\n) and Rm := exp ( \u03c0L\u2212 \u221a m2+(m+1)2\n2\n) . Then the\nvariational problem (25) has a unique solution in VD and the solution um satisfies\n\u2016um \u2212 u\u2016VD \u2264 Ce \u2212cm\u2016u\u2016VD , (26)\nwhere u is the solution of the original problem (23).\nThe proof comes directly from the convergence rate of I+rm and I \u2212 Rm in Theorem 6, thus is omitted.\nWe rewrite the boundary terms in (25) to be fit for numerical simulations. From (19) and the definitions of K+r and K\u2212R ,\nT+um = J+rm\u2211 j=1 m+j\u2211 `=1 c+j,` \u2202\u03d5+j,`(x) \u2202x1 , where um(x) = \u221e\u2211 j=1 m+j\u2211 `=1 c+j,`\u03d5 + j,`(x) on \u0393 + 2 ;\nT\u2212um = J\u2212Rm\u2211 j=1 m\u2212j\u2211 `=1 c\u2212j,` \u2202\u03d5\u2212j,`(x) \u2202x1 , where um(x) = \u221e\u2211 j=1 m\u2212j\u2211 `=1 c\u2212j,`\u03d5 \u2212 j,`(x) on \u0393 \u2212 \u22121.\nThus finally (25) becomes\n\u222b D [ \u2207u \u00b7 \u2207\u03d5\u2212 k2nu\u03d5 ] dx \u2212 J+r\u2211 j=1 m+j\u2211 `=1 c+j,` \u222b \u0393+2 \u2202\u03d5+j,`(x) \u2202x1 \u03d5(x) ds\n+ J\u2212r\u2211 j=1 m\u2212j\u2211 `=1 c\u2212j,` \u222b \u0393\u2212\u22121 \u2202\u03d5\u2212j,`(x) \u2202x1 \u03d5(x) ds = \u2212 \u222b D f\u03d5dx\n(27)\nFrom Theorem 10, to obtain an approximation um with the error about e\u2212cm, actually we only need O(m) number of generalized eigenfunctions to construct the variational problem (27). Thus the computational complexity in the formulation of the DtN map is expected to be small."
        },
        {
            "heading": "5 Numerical implementation",
            "text": "In this section, we introduce the numerical method to solve the problem (27). The process consists of two steps. In the first section, we approximate the eigenvalues and eigenfunctions \u03bb\u00b1j,` and \u03d5 + j,` by the spectral method; in the second section, we approximate the problem (25) by a high order finite element method."
        },
        {
            "heading": "5.1 Numerical approximation of eigenvalues and eigenfunctions",
            "text": "In this subsection, we introduce the numerical approximation of the eigenvalues and eigenfunctions \u03bb\u00b1j,` and \u03d5\u00b1j,` by the spectral method. For simplicity, we still take the reference waveguide W as an example.\nRecall W0 := (0, 1) \u00d7 (0, 1), \u03930 := {0} \u00d7 (0, 1), \u03931 := {1} \u00d7 (0, 1), \u03a3\u2212 := (0, 1) \u00d7 {0} and \u03a3+ := (0, 1)\u00d7 {1}. We are looking for nontrivial solutions in Vper such that it satisfies\n\u2206v + 2i\u03b1 \u2202v\n\u2202x1 + (k2q \u2212 \u03b12)v = 0 in W0; v = 0 on \u03a3\u2212 \u222a \u03a3+. (28)\nWe expand v by the Fourier series\nv = \u221e\u2211 j=\u2212\u221e \u221e\u2211 `=1 vj,` exp(i2\u03c0jx1) sin(\u03c0`x2), where vj,` = 2 \u222b \u21260 v(x) exp(\u2212i2\u03c0jx1) sin(\u03c0`x2) dx . (29)\nFrom direct calculation of the Fourier transform,\n\u2206v + 2i\u03b1 \u2202v\n\u2202x1 \u2212 \u03b12v = \u221e\u2211 j=\u2212\u221e \u221e\u2211 `=1 (\u22124\u03c02j2 \u2212 \u03c02`2 \u2212 4\u03c0j\u03b1\u2212 \u03b12)vj,` exp(i2\u03c0jx1) sin(\u03c0`x2). (30)\nThe only difficulty lies in the term qv. We first extend q to be an even function with respect to x2 \u2208 [\u22121, 1], and then extend it periodically to x2 \u2208 R. Thus it has the Fourier series\nq = \u221e\u2211 j=\u2212\u221e \u221e\u2211 `=0 qj,` exp(i2\u03c0jx1) cos(\u03c0`x2), where qj,` = c` \u222b \u21260 q(x) exp(\u2212i2\u03c0jx1) cos(\u03c0`x2) dx ,\nhere c` = 2 when ` 6= 0 and c0 = 1. Since qv = 0 when x2 = 0, 1, it can be extended to be an odd 2-periodic function in x2 direction. Thus it is spanned by\nqv = \u221e\u2211 j=\u2212\u221e \u221e\u2211 `=1 wj,` exp(i2\u03c0jx1) sin(\u03c0`x2), (31)\nwhere\nwj,` = 2 \u222b \u21260 q(x)v(x)e\u2212i2\u03c0jx1 sin(\u03c0`x2) dx = 1 2 \u221e\u2211 j\u2032=\u2212\u221e \u221e\u2211 `\u2032=1 vj\u2032,`\u2032 [qj\u2212j\u2032,`\u2212`\u2032 \u2212 qj\u2212j\u2032,`+`\u2032 ] .\nPut (30) and (31) into (28), then the coefficients satisfy the following equations:\n( \u22124\u03c02j2 \u2212 \u03c02`2 \u2212 4\u03c0\u03b1j \u2212 \u03b12 ) vj,` + k2\n2 \u221e\u2211 j\u2032=\u2212\u221e \u221e\u2211 `\u2032=1 vj\u2032,`\u2032 [qj\u2212j\u2032,`\u2212`\u2032 \u2212 qj\u2212j\u2032,`+`\u2032 ] = 0. (32)\nTo solve the above quadratic eigenvalue problem, we truncate the series (29) for a large N :\nvN = N\u2211 j=\u2212N N\u2211 `=1 vNj,` exp(i2\u03c0jx1) sin(\u03c0`x2). (33)\nLet VN := ( vNj,` ) j=\u2212N,\u00b7\u00b7\u00b7 ,N, `=1,...,N be the vector of coefficients, then (32) now becomes\n(B + \u03b1A\u2212 \u03b12I)VN = 0,\nwhere I is the identity matrix, and B, A are matrices which comes directly from (32). To solve the quadratic eigenvalue problem, we formulate the following linearized problem. Let WN := \u03b1VN , then\nL ( VN WN ) := ( B A I 0 )( VN WN ) = \u03b1 ( VN WN ) (34)\nBy solving the above linear eigenvalue problem, we can find out the corresponding eigenvalues and eigenfunctions.\nTo approximate the DtN map, we need to find out all the eigenvalues and eigenfunctions in D+M and D\u2212M defined in (20), for some M > 0. For the real eigenvalues, we need to apply (7)-(8) to find out all the rightward and leftward propagating modes. Finally we obtain the modes \u03d5M,N,+j,` , where ` = 1, 2, . . . ,M+j and j = 1, 2, . . . , J + r that associate with \u2126+, and modes \u03d5 M,N,\u2212 j,` , where ` = 1, 2, . . . ,M \u2212 j and j = 1, 2, . . . , J\u2212R that associate with \u2126\u2212. For simplicity, we reorder the modes and denote them by\n\u03d5M,N,+m where m = 1, 2, . . . ,M +; \u03d5M,N,\u2212m where m = 1, 2, . . . ,M \u2212.\nNow we are prepared to discretize (27) by a finite element method."
        },
        {
            "heading": "5.2 Finite element method",
            "text": "To discretize (27) by the finite element method, we generate quasi-regular triangular meshes Mh in \u2126, and the meshsize is h > 0 and sufficiently small. Then we use the cubic Lagrangian element to compute the solution of (27). Let { \u03d5\n(h) j (x), j = 1, 2, . . . , Nh\n} be the set of piecewise quadratic basis functions with\nhomogeneous Dirichlet boundary conditions on \u2202\u2126, based on the meshMh. We approximate u by\nuh,M,N (x) = Nh\u2211 j=1 u\u0302(j)\u03d5 (h) j (x),\nwhere u\u0302(j) \u2208 C are the coefficients. To discretize (27), we still need to find out the coefficients cM,N,\u00b1m from the above approximation uh,M,N \u2223\u2223 \u0393+2 and uh,M,N \u2223\u2223 \u0393\u2212\u22121 . Take uh,M,N \u2223\u2223 \u0393+2\nfor example, it is sufficient to decompose\n\u03d5(h)n \u2223\u2223\u2223 \u0393+2 = M+\u2211 m=1 cM,N,+m,n \u03d5 M,N,+ m (x) \u2223\u2223 \u0393+2\nfor those \u03d5(h)n such that \u03d5 (h) n \u2223\u2223\u2223 \u0393+2 6= 0 almost everywhere, where \u03d5M,N,+m are the eigenfunctions obtained in the previous subsection. Thus cM,N,+m can be obtained by solving the following linear system: a11 a12 \u00b7 \u00b7 \u00b7 a1,M+ a21 a22 \u00b7 \u00b7 \u00b7 a2,M+ ... ... ...\n... aM+,1 aM+,2 \u00b7 \u00b7 \u00b7 aM+,M+\n  cM,N,+1,n cM,N,+2,n\n... cM,N,+M+,n\n =  b1 b2 ...\nbM+  , (35) where\naj,` = \u2329 \u03d5M,N,+` , \u03d5 M,N,+ j \u232a L2(\u0393+2 ) , bj = \u2329 \u03d5(h)n , \u03d5 M,N,+ j \u232a L2(\u0393+2 ) .\nNote that since \u03d5M,N,\u00b1m are generalized eigenfunctions, they are linearly independent. Thus the matrix above is invertible. However, this problem is always ill-posed when the number m is large. Fortunately, from Theorem 6 and Theorem 10, we only need a small number of eigenfunctions due to the fast convergence rate thus the matrices are also small. The process to compute cM,N,\u2212m,n is similar. Then we obtain the decomposition\n\u03d5(h)n \u2223\u2223\u2223 \u0393+2 = M+\u2211 m=1 cM,N,+m,n \u03d5 M,N,+ m (x) \u2223\u2223 \u0393+2 and \u03d5(h)n \u2223\u2223\u2223 \u0393\u2212\u22121 = M\u2212\u2211 m=1 cM,N,\u2212m,n \u03d5 M,N,\u2212 m (x) \u2223\u2223 \u0393\u2212\u22121 .\nThus \u2202uh,M,N \u2202x1 \u2223\u2223\u2223\u2223 \u0393+2 = Nh\u2211 j=1 u\u0302(j) M+\u2211 m=1 cN,M,+m,j \u2202\u03d5M,N,+m \u2202x1 (x) \u2223\u2223\u2223\u2223 \u0393+2 := Nh\u2211 j=1 u\u0302(j)\u03c8M,N,+j (x)\nand \u2202uh,M,N \u2202x1 \u2223\u2223\u2223\u2223 \u0393\u2212\u22121 = Nh\u2211 j=1 u\u0302(j) M\u2212\u2211 m=1 cN,M,\u2212m,j \u2202\u03d5M,N,\u2212m \u2202x1 (x) \u2223\u2223\u2223\u2223 \u0393\u2212\u22121 := Nh\u2211 j=1 u\u0302(j)\u03c8M,N,\u2212j (x)\nwhere \u03c8M,N,+j (x) = \u2211M+ m=1 c M,N,+ m,j \u2202\u03d5M,N,+m \u2202x1 (x) \u2223\u2223\u2223 \u0393+2 and \u03c8M,N,\u2212j (x) = \u2211M\u2212 m=1 c M,N,\u2212 m,j \u2202\u03d5M,N,\u2212m \u2202x1 (x) \u2223\u2223\u2223 \u0393\u2212\u22121 are computed before the finite element discretization. Then the discretization of (27) is given as follows:\nNh\u2211 j=1 u\u0302(j) \u222b D [ \u2207\u03d5(h)` \u00b7 \u2207\u03d5 (h) ` \u2212 k 2n\u03d5 (h) j \u03d5 (h) ` ] dx \u2212 Nh\u2211 j=1 u\u0302(j) \u222b \u0393+2 \u03c8M,N,+j \u03d5 (h) ` ds\n+ Nh\u2211 j=1 u\u0302(j) \u222b \u0393\u22122 \u03c8M,N,\u2212j \u03d5 (h) ` ds = \u2212 \u222b D f\u03d5 (h) ` dx .\n(36)\nBy solving (36), we get the final result uh,M,N . The algorithm is organized as follows:\nAlgorithm 1 Numerical simulation of the LAP solution of (1).\n1. Find out all the eigenfunctions \u03d5M,N,\u00b1m by solving (34) and the orthonormal process (7).\n2. Decide the coefficients cM,N,\u00b1j,` by solving (35).\n3. Formulate (36) from the computed eigenfunctions and coefficients."
        },
        {
            "heading": "5.3 Error estimation",
            "text": "The numerical analysis of Algorithm 5.2 consists of two parts. In the first part, we estimate the error of the eigenfunctions from (34); in the second part, we study the convergence of the finite element discretization (36). First we make the further assumption for the refractive index.\nAssumption 15. The refractive index q is periodic in \u2126\u00b1, strictly positive, and it is real analytic.\nWe begin with the regularity of the solution of (4) when q satisfies the above assumption. From the periodicity boundary condition, the solution can be extended to the solution in the whole waveguide W . We summarize the Cauchy-Kowalesky theorem as follows.\nTheorem 16 (Proposition 4.2, [19]). When q and g are real analytic functions in W , then the solution v is real analytic. If g = 0 in W , v is analytic and 1-periodic in x1 directions.\nSince v is analytic and periodic, it is expanded into the Fourier series (29). Since it is well known that the Fourier coefficients for periodic analytic functions (see Sect I.4, [16]), we have the following estimation:\n|vj,`| = O ( exp ( \u2212c \u221a j2 + `2 )) .\nDefine the finite dimensional subspace\nXN := \u03d5 = N\u2211\nj=\u2212N N\u2211 `=1 \u03d5Nj,` exp(i2\u03c0jx1) sin(\u03c0`x2),  \u2282 L2(W0)\nand let PN be the projection operator from L2(W0) to XN , then vN = PNv. Thus\n\u2016v \u2212 vN\u2016L2(W0) = \u2016(I \u2212 PN )v\u2016L2(W0) = O(exp(\u2212cN)).\nWe are prepared to study the error estimation of the solution of the linear eigenvalue problem (34). The numerical analysis for the approximation of eigenvalues and eigenfunctions has been studied in many papers. For details we refer to equations (94)-(96) and Section 4 in [6].\nLet \u00b5 be a discrete spectrum of the operator L with the ascent n \u2208 N, which means ker(L\u2212 \u00b5I)n+1 = ker(L\u2212\u00b5I)n \u2283 ker(L\u2212\u00b5I)n\u22121. Let m be the dimension of the eigenspace corresponding to the eigenvalue \u00b5. Then we get n sequence of eigenvalues {\u00b5Nj : N \u2208 N} (j = 1, 2, . . . , N) such that\nmax 1\u2264j\u2264n \u2223\u2223\u00b5\u2212 \u00b5Nj \u2223\u2223 = O (\u2016(I \u2212 PN )v\u20162L2(W0)) = O (exp (\u22122cN/n)) . Let v be a generalized eigenvector of L\u2212\u00b5I, then for any integer ` \u2208 [j, n], there is a generalized eigenvector vN of order ` such that\n\u2016v \u2212 vN\u2016V = O (exp(\u2212cN(`\u2212 j + 1)/n)) .\nNote that from Theorem 10, when |Im (\u00b5)| is sufficiently large, the eigenspace related to \u00b5 is of dimension one. Thus we can always choose a suitable \u03b3 > 0 such that\u2223\u2223\u00b5\u2212 \u00b5Nj \u2223\u2223 \u2264 C exp(\u2212\u03b3N) and \u2016v \u2212 vN\u2016V \u2264 C exp(\u2212\u03b3N).\nLet K+r and K\u2212R be defined by replacing the eigenfunctions by the numerical computation, then we finally get the following approximation:\u2225\u2225K+r \u2212KNr \u2225\u2225 , \u2225\u2225K\u2212R \u2212KNR \u2225\u2225 \u2264 C exp(\u2212\u03b3N). Let r and R be defined by a fixed positive integer M , then from Theorem 6, we finally have:\u2225\u2225K+0 \u2212KNr \u2225\u2225 , \u2225\u2225K\u2212\u221e \u2212KNR \u2225\u2225 = O (exp(\u2212\u03b3N) + exp(\u2212\u03beM)) .\nThe following regularity result comes directly from the interior regularity for elliptic equations, for details we refer to Theorem 5, Section 6.3 in [7].\nTheorem 17. Suppose \u2202\u2126 is composed of finite number of non-intersecting C4-curves. The refractive index q satisfies Assumption 2, 11 and 15, f \u2208 H2(\u2126) and is compactly supported. Let u be the solution of (23) in H1(D), then it lies in the space H\u03034(D).\nBased on above regularity results, we study the convergence of (36) based on the finite element method. Define the finite dimensional subspace\nYh :=\n{ \u03d5(x) =\nL\u2211 `=1 \u03d5\u0302(`)\u03c8`(x)\n} \u2282 H\u03031(D).\nLet uh be the solution of (23) in Yh, then from Theorem 4.7.3 in [1], we have the following error estimation:\n\u2016u\u2212 uh\u2016L2(D) \u2264 Ch4\u2016u\u2016H4(D) (37)\nLet uN,M,h be the solution of (27) where the DtN maps are chosen as above. Then\n\u2016u\u2212 uN,M,h\u2016L2(D) \u2264 Ch 4 + Ce\u2212\u03b3N + Ce\u2212\u03beM . (38)"
        },
        {
            "heading": "6 Numerical examples",
            "text": "To illustrate the efficiency of Algorithm 5.2, we show two numerical examples. Note that to guarantee the sufficient regularity of the solutions, we only consider very smooth domains and refractive indexes.\nExample 18. We consider the following problem in the planar waveguide W = R\u00d7 (0, 1):\n\u2206u+ k2qu = f in W ; u = 0 on \u2202W.\nThe refractive index is represented by q = q1 + q2, where q1 is a 1-periodic function: q1(x) =2 + [ (2\u2212 4i)e\u221214\u03c0ix1 + (2 + 4i)e14\u03c0ix1 ] cos(\u03c0x2) + 3 [ e\u22126\u03c0ix1 + e6\u03c0ix1 ] cos(2\u03c0x2)\n+ [ (1 + 0.2i)e\u22122\u03c0ix1 + (1\u2212 0.2i)e2\u03c0ix1 ] cos(3\u03c0x2).\nBoth q2 and f are compactly supported functions:\nq2(x) =  0, |x\u2212 b0| > 0.15; 2, 0.1 < |x\u2212 b0| < 0.15; 2\u03b6(|x\u2212 b0|; 0.1, 0.15), otherwise;\nf(x) =  0, |x\u2212 c0| > 0.3; 3, 0.1 < |x\u2212 c0| < 0.3; 3 \u03b6(|x\u2212 c0|; 0.1, 0.3), otherwise;\nwhere b0 = (0.2, 0.2)>, c0 = (0.1, 0.4)> and \u03b6(t) is a C4-continuous function defined by\n\u03b6(t; a, b) =  1, t \u2264 a; 0, t \u2265 b; 1\u2212 [\u222b b \u03c4=a (\u03c4 \u2212 a)4(\u03c4 \u2212 b)4 d\u03c4 ]\u22121 [\u222b t \u03c4=a (\u03c4 \u2212 a)4(\u03c4 \u2212 b)4 d\u03c4 ] , a < t < b.\nFor the visualization of the waveguide we refer to Figure 3\nExample 19. The domain \u2126 is defined by three parts (see Figure 1). The left guide \u2126\u2212 = (\u2212\u221e,\u22122) \u00d7 (\u22120.5, 0.5) and the refractive index is given by\nq\u2212(x1, x2) = q1(x1, x2 + 0.5).\nThe right guide \u2126+ = (0,+\u221e)\u00d7 (\u22120.25, 0.25) and the refractive index is\nq+(x) =3 + [ 2ie\u221220\u03c0ix1 \u2212 2ie20\u03c0ix1 ] cos(4\u03c0(x2 + 0.25))\n+ [ (0.3\u2212 0.8i)e\u22124\u03c0ix1 + (0.3 + 0.8i)e4\u03c0ix1 ] cos(10\u03c0(x2 + 0.25)).\nThe domain \u21260 is an annulus with center (\u22121, 0), large radius 1 and small radius. The domain \u21260 is connected with \u2126+ and \u2126\u2212 by an open domain and then composes the whole domain \u2126. We also assume that the boundary of \u2126 is composed of three disjoint C4-smooth boundaries. In particular, let the circle with center (\u22121, 0) and radius 0.5 be denoted by C0. Then the problem we are considering is\n\u2206u+ k2qu = 0 in \u2126; u = 0 on \u2202\u2126 \\ C0; u = f on C0,\nwhere f(x) = exp (i cos(0.5)x1 + i sin(0.5)x2) .\nTo compute reference solutions, we apply the recursive doubling procedure which was proposed in [5]. The method is based on the finite element method introduced in Section 5.2 with meshsize 0.005. We first compute the DtN map from the recursive doubling procedure with an extrapolation technique, and then solve (23) by the finite element method. The solution is denoted by ur and is treated as the \u201cexact solution\u201d.\nThen we compute the numerical results by Algorithm 5.2. To guarantee the accuracy of the eigenvalues and eigenvectors, we fix N = 128 and only vary the parameter M . First, we use a spectral method to find out all the eigenfunctions that are corresponding to eigenvalues that in D+M or D \u2212 M . For the waveguide in Example 18, since the height of the waveguide is 1, we choose D+M := [\u2212\u03c0, \u03c0] + i[0,M\u03c0) and D\u2212M = [\u2212\u03c0, \u03c0]+i(\u2212M\u03c0, 0]; while for the left guide in Example 19, we still chooseD \u2212 M = [\u2212\u03c0, \u03c0]+i(\u2212M\u03c0, 0] but for the right guide, since the height is 0.5, we choose D+M := [\u2212\u03c0, \u03c0]+i[0, 2M\u03c0). For the finite element approximation, the meshsize h is fixed to be 0.005. We compare the relative norm between the numerical solution uM and the reference solution ur:\nerror := \u2016uM \u2212 ur\u2016L2(D) \u2016ur\u2016L2(D) .\nFor the results we refer to Table 6. Note that we are only interested in the dependence of the error on the parameter M , since N is already sufficiently large so the error brought by N is ignored, while the dependence on h is a standard topic in finite element method and it is not an important topic in this paper. The errors for both examples stay at a relatively low level. For the first example, the relative error stays around 4.5 \u00d7 10\u22124; for the second one, the relative error first decays significantly as M increases, but then stays around 1.8\u00d7 10\u22124. This fact can be explained by the error brought by the finite element method, or the recursive doubling procedure, or in other words, not explicit reference solutions. For the visualization of the numerical result for Example 2, we refer to Figure 4.\nAt the same time, we are also interested in the convergence rate of the algorithm with respect to the parameter M . To this end, we compute the numerical solution for M = 10, and let u10 to be the \u201cexact solution\u201d. Then we compare the relative norm between the numerical solution uM and the reference solution u10:\nerror := \u2016uM \u2212 u10\u2016L2(D) \u2016u10\u2016L2(D) .\nThe relative errors are shown in Table 6 and the dependence of the logarithm of the errors andM is shown in Figure 5. We can roughly see the linear dependence of the logarithm of the errors on the parameter M . Thus the error decays exponentially with respect to M . Finally we also want to mention that, the number of eigenfunctions depends linearly on M , i.e., for both half-guides, the number of eigenfunctions related to the eigenvalues lying in D+M (or D \u2212 M ) is always M . So we don\u2019t need to solve a large ill-posed linear system (35) to achieve an accurate solution."
        },
        {
            "heading": "Acknowledgment",
            "text": "This work is funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) \u2013 Project-ID 258734477 \u2013 SFB 1173"
        }
    ],
    "title": "A spectral decomposition method to approximate DtN maps in complicated waveguides",
    "year": 2022
}