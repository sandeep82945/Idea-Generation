{
    "abstractText": "We initiate the study of a quantitative measure for the failure of a binary operation to be commutative and associative. We call this measure the associative-commutative spectrum as it extends the associative spectrum (also known as the subassociativity type), which measures the nonassociativity of a binary operation. In fact, the associative-commutative spectrum (resp. associative spectrum) is the cardinality of the operad with (resp. without) permutations obtained naturally from a groupoid (a set with a binary operation). In this paper we provide some general results on the associative-commutative spectrum, precisely determine this measure for certain binary operations, and propose some problems for future study.",
    "authors": [],
    "id": "SP:bd935e162af7c95f8a21f9ceca0c73e70dd7753d",
    "references": [
        {
            "authors": [
                "C. Bergman"
            ],
            "title": "Universal algebra",
            "venue": "Pure and Applied Mathematics (Boca Raton), 301, CRC, Boca Raton, FL",
            "year": 2012
        },
        {
            "authors": [
                "G. Birkhoff"
            ],
            "title": "On the structure of abstract algebras",
            "venue": "Proc. Cambr. Philos. Soc. 31 ",
            "year": 1935
        },
        {
            "authors": [
                "M.S. Braitt",
                "D. Silberger"
            ],
            "title": "Subassociative groupoids",
            "venue": "Quasigroups Related Systems 14 ",
            "year": 2006
        },
        {
            "authors": [
                "B. Cs\u00e1k\u00e1ny",
                "T. Waldhauser"
            ],
            "title": "Associative spectra of binary operations",
            "venue": "Mult.-Valued Log. 5 ",
            "year": 2000
        },
        {
            "authors": [
                "S. Even",
                "A. Lempel"
            ],
            "title": "Generation and enumeration of all solutions of the characteristic sum condition",
            "venue": "Information and Control 21 ",
            "year": 1972
        },
        {
            "authors": [
                "A. Giorgilli",
                "G. Molteni"
            ],
            "title": "Representation of a 2-power as sum of k 2-powers: a recursive formula",
            "venue": "J. Number Theory 133 ",
            "year": 2013
        },
        {
            "authors": [
                "N. Hein",
                "J. Huang"
            ],
            "title": "Modular Catalan numbers",
            "venue": "European J. Comb. 61 ",
            "year": 2017
        },
        {
            "authors": [
                "N. Hein",
                "J. Huang"
            ],
            "title": "Variations of the Catalan numbers from some nonassociative binary operations",
            "venue": "Discrete Math. 345 ",
            "year": 2022
        },
        {
            "authors": [
                "J. Huang"
            ],
            "title": "Norton algebras of the Hamming graphs via linear characters",
            "venue": "Electron. J. Combin. 28 ",
            "year": 2021
        },
        {
            "authors": [
                "J. Huang",
                "M. Mickey",
                "J. Xu"
            ],
            "title": "The nonassociativity of the double minus operation",
            "venue": "J. Integer Seq. 20 ",
            "year": 2017
        },
        {
            "authors": [
                "D. Krenn",
                "S. Wagner"
            ],
            "title": "Compositions into powers of b: asymptotic enumeration and parameters",
            "venue": "Algorithmica 75 ",
            "year": 2016
        },
        {
            "authors": [
                "S. Lehr",
                "J. Shallit",
                "J. Tromp"
            ],
            "title": "On the vector space of the automatic reals",
            "venue": "Theoret. Comput. Sci. 163 ",
            "year": 1996
        },
        {
            "authors": [
                "E. Lehtonen",
                "T. Waldhauser"
            ],
            "title": "Associative spectra of graph algebras I",
            "venue": "Foundations, undirected graphs, antiassociative graphs, J. Algebraic Combin. 53 ",
            "year": 2021
        },
        {
            "authors": [
                "E. Lehtonen",
                "T. Waldhauser"
            ],
            "title": "Associative spectra of graph algebras II",
            "venue": "Satisfaction of bracketing identities, spectrum dichotomy, J. Algebraic Combin. 55 ",
            "year": 2022
        },
        {
            "authors": [
                "S. Liebscher",
                "T. Waldhauser"
            ],
            "title": "On associative spectra of operations",
            "venue": "Acta Sci. Math. (Szeged) 75 ",
            "year": 2009
        },
        {
            "authors": [
                "J.-L. Loday",
                "B. Vallette"
            ],
            "title": "Algebraic operads",
            "venue": "Grundlehren der mathematischen Wissenschaften, 346, Springer, Heidelberg",
            "year": 2012
        },
        {
            "authors": [
                "R.D. Schafer"
            ],
            "title": "On the algebras formed by the Cayley-Dickson process",
            "venue": "Amer. J. Math. 76 ",
            "year": 1954
        },
        {
            "authors": [
                "R.P. Stanley"
            ],
            "title": "Enumerative combinatorics",
            "venue": "Vol. 2, Cambridge Studies in Advanced Mathematics, 62, Cambridge University Press, Cambridge",
            "year": 1999
        },
        {
            "authors": [
                "L. Tak\u00e1cs"
            ],
            "title": "Enumeration of rooted trees and forests",
            "venue": "Math. Sci. 18 ",
            "year": 1993
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n20 2.\n11 82\n6v 2\n[ m\nat h.\nC O\n] 1\n8 M\nay 2\n02 3\nof a binary operation. In fact, the associative-commutative spectrum (resp. associative spectrum) is the cardinality of the operad with (resp. without) permutations obtained naturally from a groupoid (a set with a binary operation). In this paper we provide some general results on the associative-commutative spectrum, precisely determine this measure for certain binary operations, and propose some problems for future study."
        },
        {
            "heading": "1. Introduction",
            "text": "Associativity and commutativity are important properties for binary operations. Although many familiar operations satisfy both properties, some only satisfy one or neither of them. Moreover, nonassociativity and noncommutativity arise in many algebraic structures, such as Lie algebras, Poisson algebras, and so on. One can measure the failure of a binary operation to be associative by its associative spectrum, which we recall below.\nA groupoid is a set G with a single binary operation \u2217.1 A bracketing of n variables is a groupoid term over the set Xn := {x1, . . . , xn} of variables that is obtained by inserting parentheses in the word x1x2 . . . xn in a valid way. Let P\u2217(n) denote the set of all n-ary term operations on (G, \u2217) induced by the bracketings of n variables. The cardinality |P\u2217(n)| measures to some extent the failure of \u2217 to be associative. In general, we have 1 \u2264 |P\u2217(n)| \u2264 Cn\u22121 where Cn := 1n+1 ( 2n n ) is the ubiquitous Catalan number.\nCsa\u0301ka\u0301ny andWaldhauser [4] called the sequence (san(\u2217))n\u2208N+ , where san(\u2217) := |P\u2217(n)| andN+ := {1, 2, 3, . . .}, the associative spectrum of the binary operation \u2217, while Braitt and Silberger [3] named it the subassociativity type of the groupoid (G, \u2217). Independently, Hein and the first author [7] also proposed the study of san(\u2217) = |P\u2217(n)| for a binary operation \u2217, and provided an explicit formula when \u2217 satisfies k-associativity (a generalization of associativity). The associative spectra of many other binary operations have been determined [8, 11, 15, 16, 17].\nFor each n \u2265 1, let P\u2217(n) be the set of all n-ary term operations induced on (G, \u2217) by full linear terms of n variables, i.e., groupoid terms over Xn in which each variable x1, . . . , xn occurs exactly once (but in an arbitrary order, as opposed to bracketings). We call the sequence (sacn (\u2217))n\u2208N+ , where sacn (\u2217) := |P\u2217(n)|, the associative-commutative spectrum (in brief, ac-spectrum) of the binary operation \u2217, which measures both the nonassociativity and the noncommutativity of \u2217. We will determine the ac-spectra for certain binary operations and exhibit some connections to other interesting combinatorial objects and results.\nIt turns out that the associative spectrum and the ac-spectrum have connections with the operad theory, which models both nonassociativity and noncommutativity by using binary trees. It was developed by Boardman, May, Vogt, and others, with applications recently found in many branches of mathematics (see, e.g., Loday and Vallette [18]). We recall some basic definitions below.\n(J. Huang) Department of Mathematics and Statistics, University of Nebraska at Kearney, Kearney, NE 68849, USA\n(E. Lehtonen) Department of Mathematics, Khalifa University, P.O. Box 127788, Abu Dhabi, United Arab Emirates and Centro de Matema\u0301tica e Aplicac\u0327o\u0303es, Faculdade de Cie\u0302ncias e Tecnologia, Universidade Nova de Lisboa,\nQuinta da Torre, 2829-516 Caparica, Portugal\nE-mail addresses: huangj2@unk.edu, erkko.lehtonen@ku.ac.ae. Key words and phrases. Associative-commutative spectrum; associative spectrum; binary operation; tree. This work is funded by National Funds through the FCT \u2013 Fundac\u0327a\u0303o para a Cie\u0302ncia e a Tecnologia, I.P., under the scope\nof the project UIDB/00297/2020 (Center for Mathematics and Applications) and the project PTDC/MAT-PUR/31174/2017. 1Note that the term groupoid has a different meaning in category theory.\n1\nAn operad without permutations is an indexed family P = {P(n)}n\u22651 of sets with an identity element 1 \u2208 P(1) and, for all positive integers n,m1, . . . ,mn, a composition map\n\u25e6 : P(n)\u00d7 P(m1)\u00d7 \u00b7 \u00b7 \u00b7 \u00d7 P(mn)\u2192 P(m1 + \u00b7 \u00b7 \u00b7+mn)(1.0.1) (P, P1, . . . , Pn) 7\u2192 P \u25e6 (P1, . . . , Pn)(1.0.2)\nsatisfying the following conditions: for any P \u2208 P(n), Pi \u2208 P(ni), Pi,j \u2208 P(ni,j) (1 \u2264 i \u2264 n, 1 \u2264 j \u2264 ni), we have P \u25e6 (1, . . . , 1) = P = 1 \u25e6 P and\nP \u25e6 (P1 \u25e6 (P1,1, . . . , P1,m1), . . . , Pn \u25e6 (Pn,1, . . . , Pn,mn)) = (P \u25e6 (P1, . . . , Pn)) \u25e6 (P1,1, . . . , P1,m1 , . . . , Pn,1, . . . , Pn,mn).\n(An operad without permutations can thus be seen as a many-sorted algebra with a nullary operation 1 and operations \u25e6n,m1,...,mn for all positive integers n,m1, . . . ,mn, but for notational simplicity, the same symbol \u25e6 is used to denote all of the latter.) The elements of P(n) are called n-ary operations.2 The Hilbert series of an operad P without permutations is \u2211\u221en=1|P(n)|tn.\nWe call P = {P(n)}n\u22651 an operad with permutations if P satisfies all of the above and has an action of the symmetric group Sn on P(n) for each n \u2265 1 satisfying the following equivariance conditions: for any P \u2208 P(n), w \u2208 Sn, Pi \u2208 P(mi), and wi \u2208 Smi ,\n(P \u00b7 w) \u25e6 (Pw\u22121(1), . . . , Pw\u22121(n)) = (P \u25e6 (P1, . . . , Pn)) \u00b7 w, P \u25e6 (P1 \u00b7 w1, . . . , Pn \u00b7 wn) = (P \u25e6 (P1, . . . , Pn)) \u00b7 (w1, . . . , wn).\nHere by abuse of notation, the permutation w on the right side of the first equation is the permutation of the set {1, . . . ,m1+\u00b7 \u00b7 \u00b7+mn} that breaks the set into n consecutive blocks of sizesm1, . . . ,mn and then permutes the n blocks by w. The Hilbert series of an operad P = {P(n)}n\u22651 with permutations is \u2211\u221e n=1 |P(n)| n! t\nn. Given a groupoid (G, \u2217), we have an operad P\u2217 := {P\u2217(n)}n\u22651 without permutations and an operad P\u2217 := {P\u2217(n)}n\u22651 with permutations, whose Hilbert series have coefficients given by the associative spectrum san(\u2217) and the ac-spectrum sacn (\u2217), respectively.\nIt is clear that sacn (\u2217) \u2265 1; the equality holds for all n \u2208 N+ if and only if \u2217 is both commutative and associative. On the other hand, we have the following upper bounds for the ac-spectrum.\n(i) Since full linear terms over Xn are in bijection with (ordered) binary trees with n labeled leaves, we have sacn (\u2217) \u2264 n!Cn\u22121 for an arbitrary binary operation \u2217.\n(ii) Since the equivalence classes of full linear terms over Xn modulo the equational theory of associative groupoids (semigroups) are in bijection with permutations of {1, . . . , n}, we have sacn (\u2217) \u2264 n! if \u2217 is an associative binary operation.\n(iii) Since the equivalence classes of full linear terms over Xn modulo the equational theory of commutative groupoids are in bijection with unordered binary trees with n labeled leaves, we have sacn (\u2217) \u2264 Dn\u22121 if \u2217 is commutative, where Dn := (2n)!/(2nn!) [19, A001147].\nThe upper bound in the last case is the solution to Schro\u0308der\u2019s third problem; see, e.g., Stanley [21, p. 178]. In Section 3 we show that the above upper bounds can be achieved by the free groupoid on one generator,\nthe free associative groupoid (i.e., the free semigroup) on two generators, and the free commutative groupoid on one generator, respectively.\nIn Section 4 we focus on binary operations that are associative or commutative. For an associative noncommutative binary operation \u2217, we show that its ac-spectrum sacn (\u2217) attains the upper bound n! if it has a neutral element (i.e., identity element), and give some other examples for which sacn (\u2217) < n! in Section 4.1. In Section 4.2 and Section 4.3, we provide some concrete examples of commutative groupoids whose ac-spectra reach the upper bound Dn\u22121, but for the arithmetic, geometric, and harmonic means, we show that their ac-spectra coincide with an interesting sequence that counts ways to express 1 as an ordered sum of powers of 2 [19, A007178]. The last example shows that the ac-spectrum of a commutative operation may not achieve the upper bound Dn\u22121 even if it is totally nonassociative, i.e., its associative spectrum equals the upper bound Cn\u22121. However, we show that the converse does hold: a commutative groupoid is totally nonassociative if its ac-spectrum reaches that upper bound.\n2One can obtain an operad without permutations by taking P(n) to be the set of all n-ary operations on a set, or, as another example, all n-ary term operations of an algebraic structure. This motivates the terminology \u201cn-ary operation\u201d in the context of operads.\nIn Section 5 we show that the ac-spectrum of the bilinear product of some anticommutative algebras over a field, including the cross product and certain Lie brackets, is exactly two times the upper bound Dn\u22121 for the ac-spectrum of a commutative operation.\nIn Section 6, we determine the ac-spectra of some more examples of totally nonassociative operations, including the exponentiation, the implication, and the negated disjunction (NOR). The exponentiation and the converse implication satisfy the identity x(yz) \u2248 x(zy) and their ac-spectrum reaches the upper bound nn\u22121 for the ac-spectrum of any binary operation satisfying the above identity. Here nn\u22121 shows up because it is the number of unordered rooted trees with n labeled vertices. The negated disjunction is commutative and its ac-spectrum reaches the upper bound Dn\u22121 for commutative operations. Together with Example 4.1.2, this completely describes the ac-spectra of all two-element groupoids.\nIn Section 7, we see that for some groupoids, two full linear terms induce the same term operation if and only if the corresponding binary trees are equivalent with respect to certain attributes related to the depths of the leaves. In Section 7.1 we obtain a formula involving the Stirling numbers of the second kind for the ac-spectrum of a binary operation \u2217 satisfying the property that any two full linear terms agree on \u2217 if and only if the right depth sequences of their corresponding binary trees are congruent modulo k (this is also equivalent to the the k-associativity mentioned earlier). An example is given by a \u2217 b := a+ e2\u03c0i/kb, which becomes addition and subtraction when k = 1 and k = 2. Related to this example is the operation a \u2217 b := e2\u03c0i/k(a + b). When k = 2 this becomes the double minus operation a \u2296 b := \u2212a \u2212 b whose associative spectrum is |P\u2217(n)| = \u230a2n/3\u230b [19, A000975], as shown by Csa\u0301ka\u0301ny and Waldhauser [4, \u00a7 5.3] and independently by the first author, Mickey, and Xu [11]. In section 7.2 we show that sacn (\u2296) = (2n\u2212(\u22121)n)/3, which is the well-known Jacobsthal sequence [19, A001045]. The more general operation a\u2217 b := e2\u03c0i/k(a+ b) satisfies the k-depth-equivalence studied recently by the second author. Computations show that neither the associative spectrum nor the ac-spectrum of this operation matches with any existing sequence in OEIS [19] when k > 2.\nIn Section 8, we make some concluding remarks and indicate possible directions for further research. For the reader\u2019s convenience, we provide a summary in Table 1.1, in which we indicate for the different\ntypes of groupoids considered in this paper their ac-spectra and, for the sake of comparison, also their associative spectra."
        },
        {
            "heading": "2. Preliminaries",
            "text": "In this section we briefly recall some fundamental concepts concerning algebras, terms and identities, as well as trees, that are necessary for our work. We will also introduce the (fine) associative-commutative spectrum of a groupoid. This is a modification of the (fine) associative spectrum, introduced by Csa\u0301ka\u0301ny and Waldhauser [4] and Liebscher and Waldhauser [17].\nLet N+ denote the set of positive integers and let [n] denote the set {1, . . . , n}. 2.1. Algebras, terms, and identities. We recall some basic notions from universal algebra (see, e.g., Bergman [1]). An algebra3 is a pair A = (A,F ), where A is a nonempty set (the universe or the base set) and F = (fi)i\u2208I is a family of operations on A (the fundamental operations). The mapping \u03c4 : I \u2192 N that assigns to each i \u2208 I the arity of fi is called the algebraic similarity type (or type) of A. We may take as the index set a set F of operation symbols. Then an algebra of type \u03c4 : F \u2192 N is a pair A = (A,FA), where FA = (fA)f\u2208F is a family of operations on A, each fA having arity \u03c4(f). An algebra is trivial if its universe has just one element.\nLet us now fix an algebraic similarity type \u03c4 : F \u2192 N. Let X be a set of variables that is disjoint from F . We define terms of type \u03c4 over X by the following recursion: every variable x \u2208 X is a term, and if f \u2208 F and t1, . . . , t\u03c4(f) are terms, then f(t1, . . . , t\u03c4(f)) is a term. Let T\u03c4 (X) denote the set of all terms of type \u03c4 over X . We usually take the set X of variables to be one of the standard sets of variables: for n \u2208 N+, Xn := {x1, . . . , xn} and X\u03c9 := {x1, x2, . . . }. Let var(t) denote the set of variables occurring in the term t, and let |t| denote the total number of occurrences of variables in t.\nWe can define an algebra T\u03c4 (X) of type \u03c4 with universe T\u03c4 (X) and, for each f \u2208 F , the \u03c4(f)-ary fundamental operation fT\u03c4 (X) defined as fT\u03c4 (X)(t1, . . . , t\u03c4(f)) := f(t1, . . . , t\u03c4(f)). The algebra T\u03c4 (X) is called the term algebra of type \u03c4 over X . Note that T\u03c4 (X) is absolutely free over X , meaning that T\u03c4 (X) is generated by X and has the universal mapping property, i.e., for any algebra A = (A,FA) of type \u03c4 and\n3This is not to be confused with an algebra over a field. See Example 2.1.1(vii) and Section 5.\nany map h : X \u2192 A, there is a unique homomorphism h\u266f : T\u03c4 (X) \u2192 A that extends h. In particular, the term algebra T\u03c4 (Xn) is called a free algebra of type \u03c4 on n generators.\nStill in regard to the universal mapping property of T\u03c4 (X), let A = (A,FA) be an arbitrary algebra of type \u03c4 , let h : X \u2192 A be an arbitrary map, and let h\u266f : T\u03c4 (X)\u2192 A be the unique homomorphic extension of h. We call the map h an assignment of values from A for the variables in X . For a term t \u2208 T\u03c4 (X), we call h\u266f(t) the value of t in A under h, and we say that t evaluates to h\u266f(t) in A under the assignment h. For notational simplicity, we will write also h(t) for h\u266f(t). Of course, it is only the restriction of an assignment h to var(t) that matters for the value h\u266f(t), so we may safely consider just partial assignments var(t)\u2192 A.\nLet A = (A,FA) be an algebra of type \u03c4 . For each term t \u2208 T\u03c4 (Xn), we define an n-ary operation tA on A by the following recursion. If t is a variable xi \u2208 Xn, then tA = pr(n)i , where pr (n) i is the i-th n-ary projection, defined by (a1, . . . , an) 7\u2192 ai. If t = f(t1, . . . , t\u03c4(f)), where f \u2208 F and t1, . . . , t\u03c4(f) \u2208 T\u03c4 (Xn), then tA(a1, . . . , an) := f A(tA1 (a1, . . . , an), . . . , t A \u03c4(f)(a1, . . . , an)). The operation t A is called the term operation\ninduced by t on A. In other words, the term operation tA provides the evaluations of t in A under all possible assignments of values for variables: if h : Xn \u2192 A is the assignment h(xi) = ai for each xi \u2208 Xn, then h(t) = tA(a1, . . . , an). For a set T \u2286 T\u03c4 (X) of terms, let TA := {tA | t \u2208 T }.\nAn identity of type \u03c4 is a pair (s, t) of terms s, t \u2208 T\u03c4 (X\u03c9), usually written as s \u2248 t. An algebra A = (A,FA) satisfies the identity s \u2248 t, denoted A |= s \u2248 t, if sA = tA (here we must assume that s, t \u2208 T\u03c4 (Xn) for some n \u2208 N, but this is not a real restriction because it can always be done). In other words, A satisfies s \u2248 t, if, by interpreting the terms s and t in the algebra A, the two terms evaluate to\nthe same value for all assignments of values from A for the variables. The set of all identities satisfied by an algebra A (by every member of a class A of algebras of type \u03c4 , resp.) is called the equational theory of A (of A, resp.). Conversely, the set of all algebras satisfying a set \u03a3 of identities is called the equational class axiomatized by \u03a3. It is well known that a class of algebras is an equational class if and only if it is a variety, i.e., a class of algebras that is closed under homomorphic images, subalgebras, and direct products (Birkhoff [2]).\nIn practice, we will often use the usual infix notation for binary operations, i.e., we write a \u2217 b instead of \u2217(a, b). For unary operations, it is also common to use special notations such as a\u22121 instead of \u22121(a) or a instead of (a). We may also omit some parentheses from terms when there is no risk of misunderstanding.\nExample 2.1.1. Examples of familiar algebras include the following.\n(i) A groupoid is an algebra (G, \u2217) with a single binary operation \u2217, i.e., an algebra of algebraic similarity type \u03c4 = (2). A groupoid is commutative if it satisfies the identity x \u2217 y \u2248 y \u2217 x (commutative law), and it is associative if it satisfies the identity x\u2217 (y \u2217 z) \u2248 (x\u2217 y)\u2217 z (associative law). An associative groupoid is called a semigroup.\n(ii) A monoid is an algebra (M, \u2217, e) of type (2, 0) that satisfies the associative law and the identities x \u2217 e \u2248 e \u2217 x \u2248 x. We call e a neutral element (or identity element).\n(iii) A group is an algebra (G, \u2217,\u22121, e) of type (2, 1, 0) such that (G, \u2217, e) is a monoid and it satisfies the identities x \u2217 x\u22121 \u2248 x\u22121 \u2217 x \u2248 e. (iv) A ring is an algebra (R,+.\u00b7,\u2212, 0) of type (2, 2, 1, 0) such that (R,+,\u2212, 0) is a commutative group, (R, \u00b7) is a semigroup, and it satisfies the identities x\u00b7(y+z) \u2248 (x\u00b7y)+(x\u00b7z) and (y+z)\u00b7x \u2248 (y\u00b7x)+(z\u00b7x) (distributive laws). A ring in which the multiplication is commutative is called a commutative ring.\n(v) A ring with identity is an algebra (R,+, \u00b7,\u2212, 0, 1) of type (2, 2, 1, 0, 0) such that (R,+, \u00b7,\u2212, 0) is a ring and (R, \u00b7, 1) is a monoid. A field is a nontrivial commutative ring with identity in which every nonzero element has a multiplicative inverse (i.e., for all x \u2208 R \\ {0}, there is a y \u2208 R such that x \u00b7 y = y \u00b7 x = 1).\n(vi) Let F = (F,+, \u00b7,\u2212, 0, 1) be a fixed field. A vector space over F is an algebra (V,+,\u2212, 0, (\u03bba)a\u2208F ) such that (V,+,\u2212, 0) is a commutative group and, for all a, b \u2208 F , the following identities are satisfied:\n\u03bb1(x) \u2248 x, \u03bba(x+ y) \u2248 \u03bba(x) + \u03bba(y), \u03bba+b(x) \u2248 \u03bba(x) + \u03bbb(x),\n\u03bba(\u03bbb(x)) \u2248 \u03bba\u00b7b(x). The unary operation \u03bba is called scalar multiplication by a. One often writes ax for \u03bba(x).\n(vii) Let F be a fixed field as above. An algebra over the field F is an algebra (A,+,\u2212, 0, (\u03bba)a\u2208F , \u2217), where (A,+,\u2212, 0, (\u03bba)a\u2208F ) is a vector space over F and \u2217 is a bilinear binary operation, that is, for all a, b \u2208 F , the following identities are satisfied:\n(x+ y) \u2217 z \u2248 x \u2217 z + y \u2217 z, z \u2217 (x+ y) \u2248 z \u2217 x+ z \u2217 y,\n\u03bba(x) \u2217 \u03bbb(y) \u2248 \u03bba\u00b7b(x \u2217 y). 2.2. Associative-commutative spectrum. In this paper, we discuss almost exclusively groupoids, i.e., algebras of type \u03c4 = (2). Therefore, from now on, unless otherwise mentioned, we assume that the algebras under consideration are groupoids and the algebraic similarity type is not explicitly mentioned and is omitted from any notation we use. When we speak, for example, of terms, we mean terms in the language of groupoids. In fact, since we now have only one operation symbol, it does no harm to omit it from terms.\nA term is called linear if no variable occurs more than once therein. We call a term t \u2208 T (Xn) full over Xn if var(t) = Xn, i.e., every variable xi \u2208 Xn occurs in t. Thus, a full linear term over Xn is a term that is obtained by inserting n \u2212 1 pairs of parentheses in a valid way into the word x\u03c3(1)x\u03c3(2) . . . x\u03c3(n) for some permutation \u03c3 \u2208 Sn. If, in the above, \u03c3 is the identity permutation, then we get a bracketing over Xn. In other words, a full linear term t \u2208 T (Xn) is of the form t = t\u2032[x\u03c3(1), . . . , x\u03c3(n)] for some bracketing t\u2032 (the underlying bracketing of t) and some permutation \u03c3 \u2208 Sn. (For a term t \u2208 T (Xn) and terms u1, . . . , un \u2208 T (Xm), we let t[u1, . . . , un] denote the term in T (Xm) obtained from t by replacing each\noccurrence of xi by ui, for all i \u2208 [n].) Let Fn and Bn denote the set of all full linear terms over Xn and the set of all bracketings over Xn, respectively. It is well known that the number of bracketings over Xn equals the (n\u2212 1)-st Catalan number Cn\u22121 = 1n ( 2n\u22122 n\u22121 ) , i.e., |Bn| = Cn\u22121. Consequently, |Fn| = n!Cn\u22121. If s, t \u2208 Bn (s, t \u2208 Fn, resp.) for some n \u2208 N, then we call s \u2248 t a bracketing identity (a full linear identity, resp.).\nExample 2.2.1. There are twelve full linear terms over X3, and they form the set\nF3 = {((x\u03c3(1)x\u03c3(2))x\u03c3(3)) : \u03c3 \u2208 S3} \u222a {(x\u03c3(1)(x\u03c3(2)x\u03c3(3))) : \u03c3 \u2208 S3}. There are two bracketings over X3, and they form the set\nB3 = {((x1x2)x3), (x1(x2x3))}, which is a subset of F3.\nLet G = (G, \u2217) be a groupoid. The fine associative-commutative spectrum (in brief, fine ac-spectrum) of G is the sequence (\u03c3acn (G))n\u2208N+ , where \u03c3 ac n (G) := {(s, t) \u2208 Fn \u00d7 Fn | G |= s \u2248 t}. In other words, \u03c3acn (G) is the restriction of the equational theory of G to full linear identities over Xn. It is clear that \u03c3acn (G) is an equivalence relation on Fn. The associative-commutative spectrum (in brief, ac-spectrum) of G is the sequence (sacn (G))n\u2208N, where s ac n (G) := |Fn/\u03c3acn (G)|, i.e., the number of equivalence classes of \u03c3acn (G). Equivalently, s ac n (G) is the number of distinct term operations on G induced by the full linear terms over Xn, in symbols, s ac n (G) = |FGn | = |{tG | t \u2208 Fn}|. The fine associative spectrum (\u03c3an(G))n\u2208N+ and the associative spectrum (san(G))n\u2208N+ of G were defined analogously by Liebscher and Waldhauser [17] by taking bracketings instead of full linear terms, i.e., by replacing Fn with Bn in the above definitions. These numbers satisfy 1 \u2264 san(G) \u2264 |Bn| = Cn\u22121 and 1 \u2264 sacn (G) \u2264 |Fn| = n!Cn\u22121. We say G is totally nonassociative if san(G) = Cn\u22121 for all n \u2265 1. For notational simplicity, we may avoid giving a name to the groupoid and refer only to its fundamental operation, and hence we may sometimes replace G with \u2217 in the notations introduced above. For example, we may write t\u2217 for tG or sacn (\u2217) for sacn (G).\nThe opposite groupoid (G, \u2217)opp of a groupoid (G, \u2217) is the groupoid (G, \u25e6) with a \u25e6 b := b \u2217 a for all a, b \u2208 G. Groupoids A and B are said to be antiisomorphic if A and Bopp are isomorphic. It is easy to see that isomorphic or antiisomorphic groupoids have the same associative spectrum and the same ac-spectrum. The following facts follow immediately from the fact that equational classes of groupoids (classes axiomatized by identities) coincide with varieties of groupoids (classes closed under homomorphic images, subgroupoids, and direct products).\n(i) If A is a homomorphic image of B, then \u03c3acn (A) \u2287 \u03c3acn (B) and sacn (A) \u2264 sacn (B). (ii) If A is a subgroupoid of B, then \u03c3acn (A) \u2287 \u03c3acn (B) and sacn (A) \u2264 sacn (B). (iii) If C = A\u00d7B, then \u03c3acn (C) = \u03c3acn (A) \u2229 \u03c3acn (B) and sacn (C) \u2265 max{sacn (A), sacn (B)}.\n2.3. Trees. Now recall that a (finite, undirected) graph is a pair (V,E) where V is a (finite) set whose elements are called vertices and E is a set of unordered pairs of vertices (i.e., sets of the form {a, b}, where a, b \u2208 V ) called edges. A graph is connected if for any pair of vertices u, v \u2208 V , there exists a sequence of vertices (v0, v1, . . . , v\u2113) such that v0 = u, vivi+1 \u2208 E for i = 0, 1, . . . , \u2113\u2212 1, and v\u2113 = v. A cycle is a sequence of distinct vertices (v0, v1, . . . , v\u2113) such that vivi+1 \u2208 E for all i = 0, 1, . . . , \u2113 \u2212 1 and v\u2113v0 \u2208 E. A tree is a connected graph without any cycle.\nLet T be a rooted tree, i.e., a tree with a distinguished vertex called the root and with edges oriented away from the root. We usually draw T in such a way that its root appears at the very top and each vertex v has a nonnegative number of children (i.e., out-neighbors) hanging below v. A vertex in T is a leaf if it has no children, or an internal vertex otherwise.\nA rooted tree T is ordered4 if the children of each internal vertex are linearly ordered, or unordered otherwise. Given an ordered tree T , the unordered tree obtained from T by simply ignoring the order of children of each internal vertex is called the underlying unordered tree of T and denoted by T u. A rooted tree is labeled if all of its vertices are labeled. Given a vertex v in a rooted tree T , the subtree of T rooted at v is the union of the paths from v to the leaves that v connects to, with v itself as the root.\n4Ordered trees are often called plane trees since a plane embedding of a tree induces a cyclic ordering of the neighbours of each vertex; moreover, if the root is drawn at the top \u2013 following our drawing convention \u2013 then the embedding specifies a linear ordering for the children of each internal vertex.\nA rooted tree T is a binary tree if each internal vertex has exactly two children. A binary tree is leaf-labeled if its leaves are labeled. The left subtree TL and right subtree TR of an ordered binary tree T are the subtrees rooted at the left child and at the right child of the root of T , respectively. If S and T are two ordered binary trees, then S \u2227 T is the ordered binary tree whose left and right subtrees are S and T , respectively. One can naturally extend these definitions to unordered binary trees by not distinguishing left and right.\nLet T be a binary tree with n leaves labeled 1, . . . , n in some order. The left depth \u03b4T (i), right depth \u03c1T (i), and depth dT (i) of a leaf i in an ordered binary tree T is the number of left, right, and all steps in the path from the root to the leaf labeled i. This leads to the left depth sequence \u03b4T := (\u03b4T (1), . . . , \u03b4T (n)), the right depth sequence \u03c1T := (\u03c1T (1), . . . , \u03c1T (n)) and the depth sequence dT := (dT (1), . . . , dT (n)) of T . If the leaves of t are labeled 1, . . . , n from left to right, then each sequence above determines the ordered binary tree T uniquely [4, 7, 11]. The depth sequence can also be defined for unordered leaf-labeled binary trees.\nThere is a bijection between the set T (X) of all terms over X and the set of ordered binary trees with leaves labeled by the variables in X (if X = X\u03c9 then we may identify a label xi with i), defined recursively as follows: each variable x \u2208 X corresponds to a tree with just one vertex labeled with x, and if the terms t1 and t2 correspond to trees T1 and T2, respectively, then the term (t1t2) corresponds to the tree T1 \u2227 T2. We write Tt for the binary tree corresponding to the term t via this bijection, and we write tT for the term corresponding to the binary tree T via its inverse map."
        },
        {
            "heading": "3. Free groupoids",
            "text": "In this section we show that the various upper bounds for the associative-commutative spectra mentioned in Section 1 can be achieved by certain free groupoids with a small number of generators.5\n3.1. Free groupoid on one generator and free semigroup on two generators. We first show that the upper bound sacn (G) \u2264 n!Cn\u22121 for the ac-spectrum sacn (G) of an arbitrary groupoid G becomes an equality when G is the free groupoid on one generator.\nProposition 3.1.1. For every n \u2208 N+, the n-th term of the ac-spectrum of the free groupoid T(X1) with one generator is sacn (T(X1)) = n!Cn\u22121.\nProof. We need to show that distinct full linear terms overXn induce distinct term operations on T(X1). Let t, u \u2208 Fn with t 6= u. If the underlying bracketings of t and u are distinct, say t\u2032 and u\u2032, then the assignment that maps every variable to x1 yields terms t \u2032[x1, . . . , x1] and u \u2032[x1, . . . , x1], which are distinct terms in\nT (X1). Assume now that the underlying bracketings of t and u are equal. Then t = b[x\u03c3(1), . . . , x\u03c3(n)] and u = b[x\u03c4(1), . . . , x\u03c4(n)] for some bracketing b \u2208 Bn and permutations \u03c3 and \u03c4 of [n], with \u03c3 6= \u03c4 . There exists an i \u2208 [n] such that \u03c3\u22121(i) 6= \u03c4\u22121(i). Now the assignment xi 7\u2192 (x1x1) and xj 7\u2192 x1 for all j 6= i maps t and u to terms of the form b[x1, . . . , x1, (x1x1), x1, . . . , x1], where the single occurrence of (x1x1) appears at distinct positions (namely, \u03c3\u22121(i) and \u03c4\u22121(i), respectively); these terms are clearly distinct. This completes the proof.\nThe set \u03a3aX of all identities over X that are satisfied by all semigroups (the restriction of the equational theory of semigroups to identities over X) is a congruence of the term algebra T(X), and the quotient T(X)/\u03a3aX is referred to as a free semigroup over X . It is isomorphic to the semigroup X\n+ = (X+, \u00b7) of nonempty words over X endowed with the operation \u00b7 of concatenation.\nIf G is a semigroup then sacn (G) \u2264 n! for all n \u2208 N+, since all bracketings over Xn induce the same term operation on G and it is only the order of variables in a full linear term that matters. We show that the equality in this upper bound holds when G is the free semigroup with two generators.\nProposition 3.1.2. For every n \u2208 N+, the n-th term of the ac-spectrum of the free semigroup with two generators is sacn (T(X2)/\u03a3 a X2 ) = n!.\nProof. Let t, u \u2208 Fn. Then t = t\u2032[x\u03c3(1), . . . , x\u03c3(n)] and u = u\u2032[x\u03c4(1), . . . , x\u03c4(n)] for some bracketings t\u2032, u\u2032 \u2208 Bn and permutations \u03c3, \u03c4 \u2208 Sn. We need to show that t and u induce distinct term operations on X+2 = (X+2 , \u00b7) if and only if \u03c3 6= \u03c4 . By associativity, the valuation of t and u under an assignment h : Xn \u2192 X+2 results in the words h(t) := h(x\u03c3(1)) . . . h(x\u03c3(n)) and h(u) := h(x\u03c4(1)) . . . h(x\u03c4(n)), respectively. Therefore, it is clear\n5We suspect that the free algebras (in a suitable variety) with countably infinitely many generators always have the largest spectrum possible (among the algebras in the variety).\nthat the term operations coincide whenever \u03c3 = \u03c4 . If \u03c3 6= \u03c4 , then it is easy to find an assignment h such that h(t) 6= h(u) and hence the term operations are distinct. For example, thinking of the two elements of X2 as the binary digits 0 and 1, we define, for each i \u2208 [n], h(xi) as the binary representation of the number i with N := \u2308log2 n\u2309 bits. Then h(t) (h(u), resp.) is a binary word of length nN , where the i-th block of N bits is the binary representation of \u03c3(i) (\u03c4(i), resp.). Since \u03c3 6= \u03c4 , there is an i \u2208 [n] such that \u03c3(i) 6= \u03c4(i); therefore h(t) and h(u) differ in the i-th block of N bits.\nRemark 3.1.3. Note that we need (at least) two generators for the above proof to work. In fact, the ac-spectrum of the free semigroup with one generator is the constant 1 sequence.\n3.2. Free commutative groupoid with one generator. The set \u03a3cX of all identities over X that hold in all commutative groupoids (the restriction of the equational theory of commutative groupoids to identities over X) is a congruence of the term algebra T(X), and the quotient T(X)/\u03a3cX is referred to as a free commutative groupoid over X .\nIt is clear that if G is a commutative groupoid and s, t \u2208 Fn are full linear terms such that Ts and Tt have the same underlying unordered binary tree, then sG = tG. Consequently, sacn (G) is bounded above by the number Dn\u22121 of unordered binary trees with n labeled leaves [19, A001147], i.e., the solution to Schro\u0308der\u2019s third problem; see, e.g., Stanley [21, p. 178]. To show that this upper bound can be achieved by taking G to be a free commutative groupoid, we need a slightly more complex construction (which we could in fact have used already for the free groupoids, but there a simpler method works).\nDefinition 3.2.1. For n \u2208 N+ and i \u2208 [n], let \u03be(n)i be the term (((. . . ((((. . . ((x1x1)x1) . . . )x1)(x1x1))x1) . . . )x1)x1),\nwhere the two subterms (x1x1) appear at depths n and i; see Figure 3.1.\nLemma 3.2.2. The unordered binary trees corresponding to \u03be (n) i and \u03be (n) j are isomorphic if and only if i = j.\nProof. In T \u03be (n) \u2113 with 1 \u2264 \u2113 \u2264 n\u2212 1, the number of leaves at depth n+ 1 is 2, the number of leaves at depth \u2113 + 1 is 3, and the number of leaves at depth k with k \u2208 [n] \\ {\u2113} is 1. In T\n\u03be (n) n\n, the number of leaves at\ndepth n+1 is 4 and the number of leaves at depth k with k \u2208 [n] is 1. Consequently, T \u03be (n) i and T \u03be (n) j are not isomorphic if i 6= j. If i = j, then T \u03be (n) i and T \u03be (n) j are equal and hence obviously isomorphic.\nProposition 3.2.3. For every n \u2208 N+, the n-th term of the ac-spectrum of the free commutative groupoid T(X1)/\u03a3\nc X1 with one generator is Dn\u22121.\nProof. We need to show that for all t, u \u2208 Fn such that t \u2248 u /\u2208 \u03a3cXn , the term operations on T(X1)/\u03a3cX1 induced by t and u are distinct. Let t, u \u2208 Fn with t \u2248 u /\u2208 \u03a3cXn . Consider the assignment xi 7\u2192 \u03be (n) n . The resulting terms t\u2032 := t[\u03be (n) 1 , . . . , \u03be (n) n ] and u\u2032 := u[\u03be (n) 1 , . . . , \u03be (n) n ] belong to T (X1). It is easy to verify that the labeled unordered binary trees corresponding to t\u2032 and u\u2032 are isomorphic if and only if those of t and u are. Since t \u2248 u /\u2208 \u03a3cXn , the binary trees corresponding to t and u are nonisomorphic as labeled unordered binary trees; hence so are the trees corresponding to t\u2032 and u\u2032, and we have t\u2032 \u2248 u\u2032 /\u2208 \u03a3cX1 , so t\u2032 T(X1)/\u03a3 c X1 6= u\u2032T(X1)/\u03a3 c X1 ."
        },
        {
            "heading": "4. Associative or commutative groupoids",
            "text": "In this section we study the ac-spectra of some groupoids that are either associative or commutative.\n4.1. Associative groupoids (semigroups). Assume first that G is an associative groupoid (a semigroup). We know that the upper bound sacn (G) \u2264 n! for semigroups is reached by the free semigroup with two generators (Proposition 3.1.2). Now we provide another example of a family of groupoids for which this upper bound is achieved.\nProposition 4.1.1. If G = (G, \u2217) is a noncommutative monoid, then we have sacn (G) = n! for all n \u2265 1. Proof. Let s, t \u2208 Fn. Then s = s\u2032[x\u03c0(1), . . . , x\u03c0(n)] and t = t\u2032[x\u03c4(1), . . . , x\u03c4(n)] for some bracketings s\u2032, t\u2032 \u2208 Bn and permutations \u03c0, \u03c4 \u2208 Sn. We show that sG = tG if and only if \u03c0 = \u03c4 , from which the proposition follows.\nIf \u03c0 = \u03c4 , then clearly sG = tG because the bracketings s\u2032 and t\u2032 are irrelevant by the associativity of \u2217. Assume now that \u03c0 6= \u03c4 . Then \u03c4\u22121\u03c0 is a nonidentity permutation, and therefore it must have an inversion pair, say (i, j) with i < j and \u03c4\u22121\u03c0(i) > \u03c4\u22121\u03c0(j). Since \u2217 is not commutative, there exist elements a, b \u2208 G such that a \u2217 b 6= b \u2217 a. Let e be the neutral element of \u2217. Assign the value a to x\u03c0(i) = x\u03c4(\u03c4\u22121\u03c0(i)), the value b to x\u03c0(j) = x\u03c4(\u03c4\u22121\u03c0(j)), and the value e to all remaining variables. Under this assignment, the term s evaluates to e . . . eae . . . ebe . . . e = ab, where on the left side, a and b occur as the i-th and the j-th factors, respectively. On the other hand, the term t evaluates to e . . . ebe . . . eae . . . e = ba, where on the left side, a and b occur as the \u03c4\u22121\u03c0(i)-th and the \u03c4\u22121\u03c0(j)-th factors, respectively. This shows that sG 6= tG.\nThe above proposition would no longer be true if we omitted the assumption that the groupoid has a neutral element, as shown by the following example.\nExample 4.1.2. Csa\u0301ka\u0301ny and Waldhauser [4, Section 4] determined the associative spectrum of every twoelement groupoid. Such a groupoid is isomorphic or antiisomorphic to G = ({0, 1}, \u2217), where x \u2217 y is defined as one of the following: (1) 1, (2) x, (3) min{x, y}, (4) x+ y (mod 2), (5) x+ 1 (mod 2), (6) x \u2193 y (negated disjunction, NOR) or (7) x\u2192 y (implication). We now set out to determine their ac-spectra.\nWe have sacn (G) = 1 for all n \u2208 N+ if \u2217 defined by (1), (3), or (4), since \u2217 is both associative and commutative in these three cases. The operation \u2217 defined by (2) is associative but not commutative, and we have sacn (G) = n for all n \u2208 N+, since for any t \u2208 Fn with t = t\u2032[x\u03c4(1), . . . , x\u03c4(n)], where t\u2032 \u2208 Bn and \u03c4 \u2208 Sn, we have tG = pr(n)\u03c4(1). For the operation \u2217 defined by (5), we have sac1 (G) = 1, sac2 (G) = 2, and sacn (G) = 2n for all n \u2265 3, since for any t \u2208 Fn with t = t\u2032[x\u03c4(1), . . . , x\u03c4(n)], where t\u2032 \u2208 Bn and \u03c4 \u2208 Sn, we have tG(a1, . . . , an) = a\u03c4(1) + d (mod 2), where d is the left depth of the leftmost leaf in the binary tree corresponding to t. The groupoids given by (6) and (7) are totally nonassociative and their ac-spectra will be determined in Section 6.\n4.2. Commutative groupoids. Now we assume that G = (G, \u2217) is a commutative groupoid. Recall that we have an upper bound sacn (G) \u2264 Dn\u22121 which is attained by the free commutative groupoid with one generator (Proposition 3.2.3). As shown by the following lemma, any commutative groupoid G reaching this upper bound must be totally nonassociative.\nLemma 4.2.1. Let G = (G, \u2217) be a commutative groupoid. If sacn (G) = Dn\u22121 for n \u2208 N+, then G is totally nonassociative, i.e., san(G) = Cn\u22121 for all n \u2208 N+.\nProof. The commutativity of \u2217 and the hypothesis sacn (G) = Dn\u22121 imply that terms s, t \u2208 Fn induce the same operation on G if and only if s and t are are congruent modulo the equational theory \u03a3cXn of commutative semigroups, i.e., the unordered binary trees T us and T u t with labeled leaves corresponding to the terms s and t are isomorphic. Binary trees corresponding to bracketings of n variables are isomorphic as unordered leaf-labeled binary trees if and only if the bracketings are equal. Consequently, san(G) = Cn\u22121.\nThe converse of Lemma 4.2.1 does not hold. If \u2217 is the arithmetic, geometric, or harmonic mean, then san(\u2217) = Cn\u22121 for all n \u2265 1 (see Csa\u0301ka\u0301ny, Waldhauser [4]). However, as we are going to show next, its ac-spectrum agrees with an interesting sequence in OEIS [19, A007178], which enumerates different ways to write 1 as an ordered sum of n powers of 2 (i.e., compositions of 1 into powers of 2) and is also related to the so-called prefix codes or Huffman codes (see, e.g., Even and Lempel [5], Giorgilli and Molteni [6], Knuth [12], Krenn and Wagner [13] and Lehr, Shallit and Tromp [14]).\nProposition 4.2.2. If \u2217 is the arithmetic mean on R, the geometric mean on R+, or the harmonic mean on R+, then s ac n (\u2217) equals the number of ways to write 1 as an ordered sum of n powers of 2 for all n \u2265 1.\nProof. As observed by Csa\u0301ka\u0301ny and Waldhauser [4], the groupoid R with the arithmetic mean (x + y)/2 is isomorphic to the groupoid R+ with the geometric mean \u221a xy via x 7\u2192 ex, and the groupoid R+ with arithmetic mean (x+ y)/2 is isomorphic to the groupoid R+ with the harmonic mean ((x \u22121 + y\u22121)/2)\u22121 via x 7\u2192 x\u22121. Therefore we may assume G = (R, \u2217) with x \u2217 y := (x+ y)/2. A bracketing t \u2208 Bn induces the operation tG(a1, . . . , an) = \u2211n i=1 2\n\u2212diai over the arithmetic mean, where di is the depth of the i-th leaf in Tt. Thus two bracketings over Xn induce the same operation on G if and only if their corresponding binary trees have the same depth sequence (which means that the trees coincide). It follows that the operations on G induced by the full linear terms over Xn are in a one-to-one correspondence with the sequences belonging to the union of the Sn-orbits of all depth sequences of binary trees with n leaves. It is known and can be shown by induction that any sequence (d1, . . . , dn) in these orbits must satisfy the condition 1 = 2\u2212d1 + \u00b7 \u00b7 \u00b7+ 2\u2212dn , and any sequence of positive integers satisfying this condition must be a permutation of the depth sequence of a binary tree. The result follows.\nNext, we consider the rock-paper-scissors operation \u2217 defined on the set {rock, paper, scissors} by x \u2217 y = y \u2217 x := x if x beats y or x = y. Rock beats scissors, scissors beat paper, and paper beats rock. Proposition 4.2.3. For the rock-paper-scissors operation \u2217, we have sacn (\u2217) = Dn\u22121 and san(\u2217) = Cn\u22121 for all n \u2265 1. Proof. By Lemma 4.2.1, it suffices to prove sacn (\u2217) = Dn\u22121 for all n \u2265 1. We proceed by induction on n. Let s, t \u2208 Fn. Since \u2217 is commutative, it suffices to show that if T us 6= T ut are distinct then s\u2217 6= t\u2217. The claim clearly holds for 1 \u2264 n \u2264 2. Let now n \u2265 3, and assume that the claim holds for terms with fewer than n variables. Let xj and xk be two leaves with a common parent in Ts.\nFirst, suppose that xj and xk also share a parent in Tt. Then deleting xj and xk from both Ts and Tt and labeling their parent with a new variable will yield binary trees Us and Ut with n\u2212 1 labeled leaves. Since T us 6= T ut implies Uus 6= Uut , we have (tUs)\u2217 6= (tUt)\u2217 by the induction hypothesis. It follows that s\u2217 6= t\u2217.\nNext, suppose that xj and xk do not share a parent in Tt. Let a be the first common ancestor of xj and xk in Tt, let S be the subtree of Tt rooted at a, and let R and R\n\u2032 be the subtrees of Tt rooted at the two children of a. We may assume, without loss of generality, that R contains xj and at least one other leaf, and R\u2032 contains xk. Then using an assignment h with h(xj) = rock, h(xk) = scissors, and h(xi) = paper for all i \u2208 [n] \\ {j, k}, we have h(tR) = paper, h(tR\u2032) = scissors, and thus h(t) = scissors. On the other hand, we have h(s) = paper. Therefore s\u2217 6= t\u2217. 4.3. Commutative groupoids with a neutral element. For a commutative groupoid G with a neutral element, we show that there are only two distinct possibilities: G is either associative or totally nonassociative (see Theorem 4.3.1 below). Examples of nonassociative commutative groupoids with a neutral element include the Jordan algebras of n\u00d7n self-adjoint matrices over R,C, or H (the algebra of quaternions) with a product defined by x \u25e6 y := (xy+ yx)/2. The identity matrix In is the neutral element for this commutative algebra.\nTheorem 4.3.1. Let G = (G, \u2217) be a commutative groupoid with neutral element e. Then either (i) G is associative, in which case san(G) = s ac n (G) = 1 for all n \u2208 N+, or\n(ii) san(G) = Cn\u22121 and s ac n (G) = Dn\u22121 for all n \u2265 1.\nProof. If G is associative and commutative, then all full terms in Fn induce the same term operation on G and so san(G) = s ac n (G) = 1 for all n \u2208 N+.\nAssume now that G is not associative. Then there exist elements a, b, c \u2208 G such that a(bc) 6= (ab)c. By Lemma 4.2.1, it suffices to prove sacn (G) = Dn\u22121 for all n \u2265 1. We are going to show that sG 6= tG whenever s, t \u2208 Fn are noncongruent terms modulo the equational theory \u03a3cXn of commutative groupoids, i.e., T us 6= T ut . The claim holds trivially for n = 1 and n = 2, so we may assume n \u2265 3.\nConsider now the case n = 3. Modulo \u03a3cX3 , there are three distinct full linear terms over X3, namely t1 := x1(x2x3), t2 := x2(x1x3), t3 := x3(x1x2), and the term functions they induce on G are distinct because\ntG1 (a, c, b) = a(cb) = a(bc) 6= (ab)c = c(ab) = tG2 (a, c, b), tG1 (a, b, c) = a(bc) 6= (ab)c = c(ab) = tG3 (a, b, c), tG2 (b, a, c) = a(bc) 6= (ab)c = c(ba) = tG3 (b, a, c).\nAssume now that n \u2265 4 and that the claim holds for terms with fewer than n variables. We have s = (sLsR) and t = (tLtR) for subterms sL, sR, tL, tR. Note that the term t\n\u2032 := (tRtL) is congruent to t modulo \u03a3cXn , so we may consider t\n\u2032 in place of t if necessary. Observe that {var(sL), var(sR)} and {var(tL), var(tR)} are partitions of [n].\nConsider first the case when {var(sL), var(sR)} 6= {var(tL), var(tR)}. By taking, if necessary, the term t\u2032 in place of t, and by changing the roles of s and t, if necessary, it follows that there exist j, k, \u2113 \u2208 [n] such that xj \u2208 var(sL) \u2229 var(tL), xk \u2208 var(sR) \u2229 var(tL), and x\u2113 \u2208 var(sR) \u2229 var(tR). Let h be the assignment xj 7\u2192 a, xk 7\u2192 b, x\u2113 7\u2192 c, and xi 7\u2192 e for all i \u2208 [n] \\ {i, j, k}. Then h(s) = h(sL) \u2217 h(sR) = a(bc) and h(t) = h(tL) \u2217 h(tR) = (ab)c, which shows that sG 6= tG.\nFinally, consider the case when {var(sL), var(sR)} = {var(tL), var(tR)}. By taking, if necessary, the term t\u2032 in place of t, we may assume that var(sL) = var(tL) and var(sR) = var(tR). We must have sL 6= tL or sR 6= tR, say the former. Then sGL 6= tGL by the induction hypothesis. Hence there is an assignment h for the variables in var(sL) = var(tL) such that h(sL) 6= h(tL). Extend h into an assignment h\u2032 on Xn by defining xi 7\u2192 e for all xi \u2208 var(sR) = var(tR). Then\nh\u2032(s) = h\u2032(sL) \u2217 h\u2032(sR) = h(sL) \u2217 e = h(sL) 6= h(tL) = h(tL) \u2217 e = h\u2032(tL) \u2217 h\u2032(tR) = h\u2032(t) which shows that sG 6= tG. This concludes the proof."
        },
        {
            "heading": "5. Anticommutative algebras",
            "text": "We now turn our attention to ac-spectra of bilinear products in algebras over a field. An algebra over a field F of characteristic not 2 is said to be anticommutative if it satisfies the identity xy \u2248 \u2212yx, which implies the identity xx \u2248 0 since xx \u2248 \u2212xx.\n5.1. Commutative version of a bilinear product. Given an anticommutative algebra over a field, we can turn the product \u2217 into a commutative bilinear product \u229b as follows. Definition 5.1.1. Let A = (A,+,\u2212, 0, (\u03bba)a\u2208F , \u2217) be an algebra over a field F. Let g be any choice function on the collection C := {{a,\u2212a} | a \u2208 A} and let f : A\u2192 C, f(a) := {a,\u2212a}. (Recall that a choice function on a collection C of subsets of some base set X is a mapping g : C \u2192 X such that g(S) \u2208 S for every S \u2208 C.) Note that any map f arising in this way is even, i.e., it satisfies f(a) = f(\u2212a) for all a \u2208 A. Now we can fix a basis B of the vector space A, and for all basis vectors a, b \u2208 B, we define a\u229b b := g(f(a \u2217 b)). This partial operation extends to a commutative bilinear product on A. (It is well known that any partial operation on A with domain B extends in a unique way to a bilinear product on A, and a bilinear product is commutative if and only if its restriction to the basis is commutative.) Such a product \u229b will be referred to as a commutative version of \u2217. Theorem 5.1.2. Let A = (A,+,\u2212, 0, (\u03bba)a\u2208F , \u2217) be an anticommutative algebra over a field F, and assume that the commutative version \u229b of \u2217 satisfies s\u229b 6= \u00b1t\u229b for any terms s, t \u2208 Fn with T us 6= T ut .\n(i) We have sacn (\u229b) = Dn\u22121 and s a n(\u229b) = Cn\u22121 for all n \u2265 1.\n(ii) We have sacn (\u2217) = 2sacn (\u229b) = 2Dn\u22121 for all n \u2265 2 and san(\u2217) = Cn\u22121 for all n \u2265 1.\nProof. Let A be the universe of the algebra. Since s\u229b 6= \u00b1t\u229b for any terms s, t \u2208 Fn with T us 6= T ut , the ac-spectrum sacn (\u229b) of the commutative operation \u229b must attain the upper bound Dn\u22121 for commutative operations. This implies san(\u229b) = Cn\u22121 for all n \u2265 1 by Lemma 4.2.1.\nAssume n \u2265 2 below. For any t \u2208 Fn, if (t1t2) is a subterm of t and t\u0303 is the term obtained from t by replacing (t1t2) by (t2t1), then t\u0303\n\u229b = t\u229b and t\u0303\u2217 = \u2212t\u2217. Any terms s, t \u2208 Fn such that T us = T ut can be obtained from each other by a sequence of such swaps of subterms. On the other hand, for any terms s, t \u2208 Fn such that T us 6= T ut , we have s\u229b 6= \u00b1t\u229b by the hypothesis.\nIt follows that for each f \u2208 F\u229bn := {t\u229b | t \u2208 Fn}, the terms in Fn that give rise to f induce two distinct functions on (A, \u2217), namely, f and \u2212f , and for distinct f, g \u2208 F\u229bn , any terms in Fn giving rise to f and g induce distinct functions on (A, \u2217). Therefore the cardinality of F \u2217n := {t\u2217 | t \u2208 Fn} is exactly two times that of F\u229bn , i.e., s ac n (\u2217) = 2sacn (\u229b) for all n \u2265 2.\nFinally, let s and t be distinct bracketings. Let Ts and Tt be the corresponding ordered binary trees with leaves labeled by x1, . . . , xn from left to right. Then the underlying unordered leaf-labeled trees T u s and T u t must be distinct. Therefore s\u229b 6= t\u229b by our assumption, and hence s\u2217 6= t\u2217 by what we have shown above. This shows that san(\u2217) = Cn\u22121 for all n \u2265 1.\nTo apply Theorem 5.1.2 to some familiar anticommutative algebras, we need a lemma.\nLemma 5.1.3. Let A = (A,+,\u2212, 0, (\u03bba)a\u2208F , \u2217) be an anticommutative algebra over a field F, and let \u229b be the commutative version of \u2217. Suppose the following conditions hold for some U \u2286 A \\ {0} and P \u2286 U \u00d7 U .\n(i) For any w \u2208 U , there exists u \u2208 U such that (u,w) \u2208 P , (ii) There exists (u, v) \u2208 P such that (c(u\u229b v), w) \u2208 P for some scalar c 6= 0 and some w \u2208 U . (iii) There exists (u, v) and (u,w) in P such that (c(v\u229bw), z) \u2208 P for some scalar c 6= 0 and some z \u2208 U . (iv) For any n \u2265 2, t \u2208 Fn, j \u2208 [n], and (u,w) \u2208 P , there exist u1, . . . , un \u2208 U such that uj = u and\nt\u229b(u1, . . . , un) = cw for some scalar c 6= 0. Then s\u229b 6= \u00b1t\u229b for any terms s, t \u2208 Fn with T us 6= T ut . Proof. We will prove the slightly stronger statement that for any linear terms s, t \u2208 T (X\u03c9) with var(s) = var(t) and T us 6= T ut , there is an assignment h\u2032 : var(s) = var(t) \u2192 U such that one of h\u2032(s) and h\u2032(t) is 0 and the other is nonzero. Consequently, s\u229b 6= \u00b1t\u229b for any terms s, t \u2208 Fn with T us 6= T ut .\nWe proceed by induction on n. We must have n \u2265 3 since T us 6= T ut . For n = 3, we have, without loss of generality, s = (x1x2)x3 and t = x1(x2x3). Let u, v, w, and c be as in (ii), i.e., (u, v) \u2208 P and (c(u\u229bv), w) \u2208 P ; note that the latter implies that u\u229bv \u2208 U . By (iv), there exists z \u2208 U such that u\u229bz = v. Then s\u229b(u, u, z) = (u\u229b u)\u229b z = 0\u229b z = 0 and t\u229b(u, u, z) = u\u229b (u\u229b z) = u\u229b v \u2208 U .\nAssume now that n > 3 and that the lemma holds for linear terms with fewer than n variables. There exist two leaves labeled by xj and xk with a common parent in Ts. We distinguish cases according to whether the leaves with these labels have a common parent also in Tt.\nCase 1: The leaves labeled by xj and xk also share a parent in Tt. Then deleting xj and xk from both Ts and Tt and labeling their parent with a new variable y will result in two binary trees Rs and Rt with n\u22121 labeled leaves. Since T us 6= T ut implies Rus 6= Rut , the inductive hypothesis provides an assignment h : var(tRt) \u2192 U such that one of h(tRs) and h(tRt) is 0 and the other is nonzero. Now let h\n\u2032 : var(t)\u2192 U be an assignment that coincides with h on var(tRt) \\ {y} and assign values to xj and xk such that h\u2032(xj)\u229b h\u2032(xk) = ch(y) for some c 6= 0; such values exist by (i) and (iv) with n = 2 and w = h(y). It follows that h\u2032(s) = ch(tRs) and h\u2032(t) = ch(tRt), so one of h \u2032(s) and h\u2032(t) is zero and the other is nonzero.\nCase 2: The leaves labeled by xj and xk do not share a parent in Tt. Let S be the subtree of Tt rooted at the first common ancestor a of xj and xk, and let R and R\n\u2032 be the subtrees of Tt rooted at the two children of a. We may assume, without loss of generality, that R contains xj and R \u2032 contains xk.\nCase 2.1: Either R or R\u2032, say the former, contains only one leaf. Then the latter must have at least two leaves. Let u, v, and w be as in (ii). By (iv), there exists an assignment h : var(tS)\u2192 U such that h(xj) = h(xk) = u, h(tR) = u, h(tR\u2032) = cv, and h(tS) = c(u \u229b v) \u2208 U for some nonzero scalar c. If S = Tt then let h\u2032 := h. If S 6= Tt then we can use (iv) again to obtain an assignment h\u2032 : var(t)\u2192 U extending h such that h\u2032(t) = cc\u2032w for some nonzero scalar c\u2032. On the other hand, we have h\u2032(s) = 0 since xj \u229b xk = u\u229b u = 0.\nCase 2.2: Both R and R\u2032 contain at least two leaves. Let u, v, w, and z be as in (iii). By (iv), there exists an assignment h : var(tS)\u2192 U such that h(xj) = h(xk) = u, h(tR) = cv, h(tR\u2032) = c\u2032w, and h(tS) = cc\u2032(v\u229bw) \u2208\nU for some nonzero scalars c and c\u2032. If S = Tt then let h \u2032 := h. If S 6= Tt then we can use (iv) again to obtain an assignment h\u2032 : var(t) \u2192 U extending h such that h\u2032(t) = cc\u2032c\u2032\u2032z 6= 0 for some nonzero scalar c\u2032\u2032. On the other hand, we have h\u2032(s) = 0 since xj \u229b xk = u\u229b u = 0.\n5.2. The cross product. Since the cross product for a three-dimensional Euclidean vector space is anticommutative, we can determine its ac-spectrum by using a commutative operation associated with it.\nDefinition 5.2.1. Define \u22ca\u22c9 on a three-dimensional real vector space V with a basis {u, v, w} by letting x \u22ca\u22c9 x := 0 for all x \u2208 {u, v, w} and x \u22ca\u22c9 y := z for all distinct x, y \u2208 {u, v, w}, where z \u2208 {u, v, w} \\ {x, y}, and extending this bilinearly from {u, v, w} to V , i.e.,\n(\u03b1u + \u03b2v + \u03b3w) \u22ca\u22c9 (\u03b1\u2032u+ \u03b2\u2032v + \u03b3\u2032w) = (\u03b2\u03b3\u2032 + \u03b3\u03b2\u2032)u + (\u03b3\u03b1\u2032 + \u03b1\u03b3\u2032)v + (\u03b1\u03b2\u2032 + \u03b2\u03b1\u2032)w\nfor any scalars \u03b1, \u03b2 and \u03b3. This operation occurs in recent studies of the Norton algebras of certain distance regular graphs and it is commutative and totally nonassociative [10, Example 3.11, Remark 5.10].\nFor V = R3 with {u, v, w} being the standard basis {i, j,k}, we have a choice function g satisfying g({\u00b1i}) = i, g({\u00b1j}) = j, and g({\u00b1k}) = k, and this makes \u22ca\u22c9 a commutative version of the cross product \u00d7.\nTo apply Theorem 5.1.2, we need to first verify the assumptions in Lemma 5.1.3 for \u22ca\u22c9.\nLemma 5.2.2. The assumptions (i)\u2013(iv) in Lemma 5.1.3 hold for \u22ca\u22c9, U := {u, v, w} and P := {(x, y) : x, y \u2208 U, x 6= y}. Proof. It is clear that (i) holds. For (ii), we have (u, v) \u2208 P and (u \u22ca\u22c9 v, u) = (w, u) \u2208 P . For (iii), we have (u, v), (u,w) \u2208 P and (v \u22ca\u22c9 w, v) = (u, v) \u2208 P .\nIt remains to show (iv), that is, for any n \u2265 2, t \u2208 Fn, j \u2208 [n], and (a, b) \u2208 P , there is an assignment of values from {u, v, w} to the variables occurring in t such that xj gets value a and t evaluates to b. We prove this by induction on n. For n = 2, this follows from the definition of \u22ca\u22c9.\nAssume now that n \u2265 3. Then t = (rs) for some subterms r and s. Assume without loss of generality that xj occurs in r (the case when xj occurs in s is treated similarly). First suppose that r = xj . By the inductive hypothesis, there is an assignment h : Xn \\ {xj} \u2192 {u, v, w} such that h(s) = a \u22ca\u22c9 b. By further setting h(xj) = a, we get h(t) = a \u22ca\u22c9 (a \u22ca\u22c9 b) = b. Now suppose that r contains at least two variables. By the inductive hypothesis, there is an assignment h : Xn \u2192 {u, v, w} such that h(xj) = a, h(r) = a \u22ca\u22c9 b, and h(s) = a. Then h(t) = (a \u22ca\u22c9 b) \u22ca\u22c9 a = b.\nNow we can determine the ac-spectra of the cross product \u00d7 and its commutative version \u22ca\u22c9. Corollary 5.2.3. For the cross product \u00d7 on R3 and its commutative version \u22ca\u22c9, we have\n\u2022 sacn (\u22ca\u22c9) = Dn\u22121 for all n \u2265 1, \u2022 sacn (\u00d7) = 2Dn\u22121 for all n \u2265 2, and \u2022 san(\u00d7) = san(\u22ca\u22c9) = Cn\u22121 for all n \u2265 1.\nProof. The result follows immediately from Theorem 5.1.2, Lemma 5.1.3 and Lemma 5.2.2.\n5.3. Lie algebras. A Lie algebra is an algebra over a field F satisfying the identities\nxx \u2248 0, x(yz) + y(zx) + z(xy) \u2248 0.\nThe first of the above identities implies that the identity xy \u2248 \u2212yx is also satisfied, since 0 \u2248 (x + y)(x+ y) \u2248 xx + xy + yx+ yy \u2248 xy + yx.\nHence a Lie algebra over a field of characteristic distinct from 2 must be anticommutative. The second one is known as the Jacobi identity. The bilinear product of a Lie algebra is often denoted by [\u2212,\u2212] and is called the Lie bracket. A Lie algebra is abelian if its Lie bracket is constantly zero. Such a Lie algebra is trivially commutative and associative. In general, a Lie algebra is neither commutative nor associative.\nDefinition 5.3.1. A triple (e, f, h) of nonzero elements of a Lie algebra is called an sl2-triple if [e, f ] = h, [h, e] = 2e, and [h, f ] = \u22122f .\nIt is well known that sl2-triples exist in every semisimple Lie algebra over a field of characteristic zero. Consider a Lie algebra over a field of characteristic distinct from 2 with an sl2-triple (e, f, h). One can check that e, f, hmust be linearly independent. Thus we can fix a basis containing e, f, h and obtain a commutative version [[\u2212,\u2212]] of the Lie bracket [\u2212,\u2212] satisfying (5.3.1) [[e, f ]] = [[f, e]] = h, [[h, e]] = [[e, h]] = 2e, and [[h, f ]] = [[f, h]] = 2f.\nLemma 5.3.2. Let L be a Lie algebra over a field of characteristic distinct from 2 with an sl2-triple (e, f, h). Then the conditions (i)\u2013(iv) in Lemma 5.1.3 hold for the Lie bracket [\u2212,\u2212] and its commutative version [[\u2212,\u2212]] with U := {e, f, h} and P := {(e, e), (f, f), (e, h)}. Proof. Let [L] = (L, [[\u2212,\u2212]]), where L is the universe of L. It is clear that (i) holds. For (ii), we have (e, h) \u2208 P and (12 [[e, h]], e) = (e, e) \u2208 P . For (iii), we have (e, e), (e, h) \u2208 P and (12 [[e, h]], e) = (e, e) \u2208 P . It remains to show (iv), i.e., for any n \u2265 2, t \u2208 Fn, j \u2208 [n], and (u,w) \u2208 P , there are u1, . . . , un \u2208 U such that uj = u and t\n[L](u1, . . . , un) = cw for some scalar c 6= 0. We proceed by induction on n. For n = 2, this holds by Equation (5.3.1). Assume now that n \u2265 3 and that (iv) holds for bracketings of fewer than n variables. Then t = (t1t2) for subterms t1 and t2. Assume xj \u2208 var(t1), without loss of generality. We distinguish some cases below.\nFirst suppose (u,w) = (e, e). By applying the inductive hypothesis to t1 and t2 (trivial if |t1| = 1 or |t2| = 1), we get elements u1, . . . , un \u2208 {e, f, h} such that uj = e, t[L]1 (u1, . . . , u\u2113) = c1e, and t [L] 2 (u\u2113+1, . . . , un) = c2h for some nonzero scalars c1, c2. Then t [L](u1, . . . , un) = [[c1e, c2h]] = 2c1c2e. A similar argument is valid for\nthe case (u,w) = (f, f). Now suppose (u,w) = (e, h). By the inductive hypothesis (trivial if |t1| = 1 or |t2| = 1), there exist u1, . . . , un \u2208 {e, f, h} such that uj = e, t[L]1 (u0, . . . , u\u2113) = c1e, and t [L] 2 (u\u2113+1, . . . , un) = c2f for some nonzero scalars c1, c2. Then t [L](u1, . . . , un) = [c1e, c2f ] = c1c2h.\nCorollary 5.3.3. Let L be a Lie algebra over a field of characteristic distinct from 2 with an sl2-triple. For the Lie bracket [\u2212,\u2212] of L, it holds that sacn ([\u2212,\u2212]) = 2Dn\u22121 for all n \u2265 2 and san([\u2212,\u2212]) = Cn\u22121 for all n \u2265 1. Proof. The result follows immediately from Theorem 5.1.2, Lemma 5.1.3 and Lemma 5.3.2."
        },
        {
            "heading": "6. Totally nonassociative operations",
            "text": "In this section we focus on the ac-spectra of some totally nonassociative operations that are not commutative or anticommutative. Recall that a binary operation \u2217 is said to be totally nonassociative if san(\u2217) = Cn\u22121 for all n \u2265 1. The arithmetic, geometric, and harmonic means, the cross product on R3, and the Lie brackets of Lie algebras over fields of characteristic distinct from 2 with an sl2-triple are all totally nonassociative and their ac-spectra have been determined in earlier sections. There are many other examples of totally nonassociative operations [4, 10]. We will study the exponentiation, the implication, and the negated disjunction (NOR) in this section.\n6.1. Exponentiation. Recall that any binary operation \u2217 satisfies sacn (\u2217) \u2264 n!Cn\u22121 for all n \u2265 1, and the equality is achieved by the free groupoid on one generator (Proposition 3.1.1). We show that if \u2217 is the exponentiation then sacn (\u2217) is strictly less than this upper bound.\nWe need the following lemma, which applies to the exponentiation.\nLemma 6.1.1 (Csa\u0301ka\u0301ny, Waldhauser [4, statements 4.2.1 and 4.2.2]). Let G = (G, \u2217) be a groupoid, and assume that the operation \u2217 : G\u00d7G\u2192 G is surjective. Let t \u2208 T (X\u03c9) be a linear term. Then the following statements hold.\n(i) The term operation tG is surjective. (ii) If \u2217 is surjective and its Cayley table has neither two identical columns nor two identical rows,\nthen tG depends on every variable in var(t), i.e., for every x \u2208 var(t), there exist assignments h, h\u2032 : var(t)\u2192 G such that h(z) = h\u2032(z) for all z \u2208 var(t) \\ {x} and h(t) 6= h\u2032(t).\nDefinition 6.1.2. Let t be a term. If t is not a variable, then it is of the form t = (tLtR) for some subterms tL and tR. If the left subterm tL is not a variable, we can further write it in the form tL = (t \u2032 Lt \u2032 R). Continuing in this way, always further decomposing left subterms until we reach one that is a variable, we can write the\nterm t in the form t = ((\u00b7 \u00b7 \u00b7 ((xit1)t2) \u00b7 \u00b7 \u00b7 )tk), which we will refer to as the leftmost decomposition of t, and the subterms t1, . . . , tk are called the factors of the decomposition. The variable xi is called the leftmost variable of t. Denote the leftmost variable of t by L(t).\nNote that the number of factors in a leftmost decomposition of t equals the number of opening parentheses preceding the leftmost variable in t. We can think of this in terms of the binary tree Tt. The factors of the leftmost decomposition correspond to the subtrees Tt1 , . . . , Ttk rooted at the right children of the internal vertices along the unique path from the leftmost leaf to the root of Tt.\nDefinition 6.1.3. Based on leftmost decomposition, we associate with each term t \u2208 T (X) an ordered labeled tree Pt that is defined by the following recursion. If t is a variable xi \u2208 X , then Pt is the one-vertex tree with the single vertex labeled by xi. If t is not a variable and t = ((\u00b7 \u00b7 \u00b7 ((xit1)t2) \u00b7 \u00b7 \u00b7 )tk) is the leftmost decomposition of t, then Pt is the ordered tree whose root is labeled by xi and has k children at which the subtrees Pt1 , Pt2 , . . . , Ptk are rooted.\nProposition 6.1.4. Let G = (G, \u2217) be a groupoid satisfying the identity (xy)z \u2248 (xz)y. If s, t \u2208 T (X\u03c9) are linear terms such that the corresponding ordered labeled trees Ps and Pt have equal underlying unordered trees, i.e., P us = P u t , then s\nG = tG. Consequently, sacn (G) \u2264 nn\u22121. Moreover, if the equality holds, then san(G) = Cn\u22121.\nProof. Since G satisfies the identity (xy)z \u2248 (xz)y, it also satisfies the identity (6.1.1) ((\u00b7 \u00b7 \u00b7 ((x0x1)x2) \u00b7 \u00b7 \u00b7 )xn) \u2248 ((\u00b7 \u00b7 \u00b7 ((x0x\u03c3(1))x\u03c3(2)) \u00b7 \u00b7 \u00b7 )x\u03c3(n)) for every n \u2208 N+ and \u03c3 \u2208 Sn. In other words, permuting the factors of the leftmost decomposition of a term does not alter the induced term operation on G.\nSuppose s, t \u2208 T (X\u03c9) with P us = P ut . We prove sG = tG by induction on n := |s| = |t|. This clearly holds for 1 \u2264 n \u2264 2. Assume now that n \u2265 3 and that the claim holds for terms with fewer than n variables. Let s = ((\u00b7 \u00b7 \u00b7 ((xis1)s2) \u00b7 \u00b7 \u00b7 )sd) and t = ((\u00b7 \u00b7 \u00b7 ((xjt1)t2) \u00b7 \u00b7 \u00b7 )te) be the leftmost decompositions of s and t.\nSince P us = P u t , the roots of Ps and Pt are labeled with the same variable and have the same number of children, that is, xi = xj and d = e. The subtrees rooted at the children of the root of Ps are Ps1 , . . . , Psd , and, similarly the subtrees rooted at the children of the root of Pt are Pt1 , . . . , Ptd . Since P u s = P u t , there is a permutation \u03c0 \u2208 Sd such that P usi = P ut\u03c0(i) for all i \u2208 [d]. By the induction hypothesis, we have sGi = tG\u03c0(i) for all i \u2208 [d]. Consequently,\nsG(a) = ((\u00b7 \u00b7 \u00b7 ((xGi (a) \u2217 sG1 (a)) \u2217 sG2 (a)) \u2217 \u00b7 \u00b7 \u00b7 ) \u2217 sGd (a)) = ((\u00b7 \u00b7 \u00b7 ((xGi (a) \u2217 tG\u03c0(1)(a)) \u2217 tG\u03c0(2)(a)) \u2217 \u00b7 \u00b7 \u00b7 ) \u2217 tG\u03c0(d)(a)) = ((\u00b7 \u00b7 \u00b7 ((xGi (a) \u2217 tG1 (a)) \u2217 tG2 (a)) \u2217 \u00b7 \u00b7 \u00b7 ) \u2217 tGd (a)) = tG(a)\nfor all a in the domain of sG, so sG = tG. It follows that sacn (G) is bounded above by the number of unordered rooted trees with n labeled vertices, which is nn\u22121 (see, e.g., Taka\u0301cs [22, \u00a73]).\nNow suppose sacn (G) = n n\u22121, i.e., P us = P u t if and only if s G = tG for all s, t \u2208 T (X\u03c9). If two distinct binary trees have leaves labeled 1, . . . , n from left to right, then they correspond to distinct ordered trees with nodes labeled 1, . . . , n in the pre-order (first visit the root and then recursively visit the subtrees rooted at the children of the root from left to right), so the underlying unordered labeled trees are distinct and they induce distinct term operations on G. This shows that san(G) = Cn\u22121.\nProposition 6.1.5. For G = (R\u22650, \u2217), where \u2217 is the exponentiation operation defined by a \u2217 b := ab for all a, b \u2208 R\u22650, we have sacn (G) = nn\u22121 and san(G) = Cn\u22121.\nProof. Proposition 6.1.4 applies to the groupoid G = (R\u22650, \u2217) since it satisfies (xy)z \u2248 (xz)y by the power rule of exponents: (ab)c = abc = (ac)b. Thus it suffices to show that sG = tG implies P us = P u t for any linear terms s, t \u2208 T (X\u03c9). Assume sG = tG, which implies var(s) = var(t) by Lemma 6.1.1. We show P us = P u t by induction on n := |s| = |t|. This is trivial for 1 \u2264 n \u2264 2 and we can assume it holds for linear terms with fewer than n variables, where n \u2265 3. Let s = ((\u00b7 \u00b7 \u00b7 ((xis1)s2) \u00b7 \u00b7 \u00b7 )sd) and t = ((\u00b7 \u00b7 \u00b7 ((xjt1)t2) \u00b7 \u00b7 \u00b7 )te) be the leftmost decompositions of s and t.\nLet h : X\u03c9 \u2192 R\u22650 be an assignment of distinct prime numbers to the variables, e.g., xi 7\u2192 pi, where pi is the i-th prime, for each i \u2208 N+. We have\nh(s) = ((\u00b7 \u00b7 \u00b7 ((h(xi) \u2217 h(s1)) \u2217 h(s2)) \u2217 \u00b7 \u00b7 \u00b7 ) \u2217 h(sd)) = ph(s1)h(s2)\u00b7\u00b7\u00b7h(sd)i , h(t) = ((\u00b7 \u00b7 \u00b7 ((h(xj) \u2217 h(t1)) \u2217 h(t2)) \u2217 \u00b7 \u00b7 \u00b7 ) \u2217 h(te)) = ph(t1)h(t2)\u00b7\u00b7\u00b7h(te)j .\nSince sG = tG, we must have h(s) = h(t). It follows from the fundamental theorem of arithmetic that pi = pj and h(s1)h(s2) \u00b7 \u00b7 \u00b7h(sd) = h(t1)h(t2) \u00b7 \u00b7 \u00b7h(te). Therefore xi = xj . Moreover, since s is a linear term, the sets var(s1), var(s2), . . . , var(sd) are pairwise disjoint and so h(s1), h(s2), . . . , h(sd) are powers of distinct primes; similarly var(t1), var(t2), . . . , var(te) are pairwise disjoint and so h(t1), h(t2), . . . , h(te) are powers of distinct primes. It follows again from the fundamental theorem of arithmetic that d = e and there is a unique permutation \u03c0 \u2208 Sd such that h(s\u2113) = h(t\u03c0(\u2113)) for all \u2113 \u2208 [d]. Now, by considering, for each \u2113 \u2208 [d], all assignments that fix xi 7\u2192 2, xp 7\u2192 1 for all xp \u2208 X\u03c9 \\ (var(s\u2113)\u222a {xi}) and let the values for the variables in var(s\u2113) vary, we see that s G \u2113 = t G\n\u03c0(\u2113) for all \u2113 \u2208 [d]. By the induction hypothesis, we have P us\u2113 = P us\u03c0(\u2113) , and it follows that P us = P u t .\n6.2. Implication. Now we study the implication \u2192 defined on the set {0, 1} by x \u2192 y = 0 if x = 1 and y = 0 or x\u2192 y = 0 otherwise. It turns out to be more convenient to use the converse implication \u2190, which is defined on {0, 1} by x \u2190 y := y \u2192 x. As the groupoids ({0, 1},\u2192) and ({0, 1},\u2190) are antiisomorphic, their ac-spectra coincide; therefore it suffices to consider only \u2190.\nNote that the implication\u2192 and the converse implication\u2190 are surjective operations on {0, 1}, and their Cayley tables have no two identical columns nor two identical rows. Hence Lemma 6.1.1 applies to \u2192 and \u2190. Proposition 6.2.1. For G = ({0, 1}, \u2217), where \u2217 is the converse implication \u2190, we have sacn (G) = nn\u22121 and san(G) = Cn\u22121.\nProof. Observe first that G satisfies the identity (x1x2)x3 \u2248 (x1x3)x2. Therefore Proposition 6.1.4 applies to G. It remains to show that sG = tG implies P us = P u t for any linear terms s, t \u2208 T (X\u03c9).\nAssume sG = tG, which implies var(s) = var(t) by Lemma 6.1.1. We show P us = P u t by induction on n := |s| = |t|. This is trivial for 1 \u2264 n \u2264 2 and we can assume it holds for linear terms with fewer than n variables, where n \u2265 3.\nLet h : X\u03c9 \u2192 {0, 1} be the assignment with h(xi) = 0 and h(xk) = 1 for k 6= i. Then clearly h(s) = ((\u00b7 \u00b7 \u00b7 ((h(xi) \u2217 h(s1)) \u2217 h(s2)) \u2217 \u00b7 \u00b7 \u00b7 ) \u2217 h(sd)) = ((\u00b7 \u00b7 \u00b7 ((0 \u2217 1) \u2217 1) \u2217 \u00b7 \u00b7 \u00b7 ) \u2217 1) = 0,\nh(t) = ((\u00b7 \u00b7 \u00b7 ((h(xj) \u2217 h(t1)) \u2217 h(t2)) \u2217 \u00b7 \u00b7 \u00b7 ) \u2217 h(te)) = { 0, if i = j,\n1, if i 6= j. Since sG = tG, we must have i = j.\nWe claim that for every k \u2208 [d], there exists some \u2113 \u2208 [e] such that L(sk) = L(t\u2113). Suppose, to the contrary, that L(sk) =: x\u03b1 is not the leftmost variable of any factor t\u2113. Consider the assignment h that maps xi and x\u03b1 to 0 and all remaining variables to 1. We now have that h(sk) = 0, h(sm) = 1 for any m 6= k, and h(t1) = \u00b7 \u00b7 \u00b7 = h(td) = 1. This leads to a contradiction:\nh(s) = ((\u00b7 \u00b7 \u00b7 ((((\u00b7 \u00b7 \u00b7 ((0 \u2217 1) \u2217 1) \u2217 \u00b7 \u00b7 \u00b7 ) \u2217 1) \u2217 0) \u2217 1) \u2217 \u00b7 \u00b7 \u00b7 ) \u2217 1) = 1, h(t) = ((\u00b7 \u00b7 \u00b7 ((0 \u2217 1) \u2217 1) \u2217 \u00b7 \u00b7 \u00b7 ) \u2217 1) = 0.\nA similar argument shows that for every \u2113 \u2208 [e], we have L(t\u2113) = L(sk) for some k \u2208 [d]. Consequently, d = e and there exists a bijection \u03c0 \u2208 Sd such that L(sk) = L(t\u03c0(k)) for all k \u2208 [d].\nLet \u2113 \u2208 [d], and suppose h : X\u03c9 \u2192 {0, 1} is an assignment satisfying xi 7\u2192 0 and L(sk) 7\u2192 1 for all k \u2208 [d] \\ {\u2113}. It is easy to see that then h(s) = 0 \u2217 h(s\u2113) = h(s\u2113), where we use the notation 0 := 1 and 1 := 0. Similarly, if h satisfies xi 7\u2192 0 and L(tk) 7\u2192 1 for all k \u2208 [d] \\ {\u2113}, then h(t) = 0 \u2217 h(t\u2113) = h(t\u2113).\nConsidering the kind of assignments described above, we can conclude that var(s\u2113) = var(t\u03c0(\u2113)) for all \u2113 \u2208 [d]. (Suppose, to the contrary, that there is a variable z \u2208 var(s\u2113)\\var(t\u03c0(\u2113)). By Lemma 6.1.1, sG\u2113 depends on every variable in var(s\u2113), in particular on z; therefore there exist assignments h, h\n\u2032 : var(s\u2113)\u2192 {0, 1} such that h(x) = h\u2032(x) whenever x 6= z and h(s\u2113) 6= h\u2032(s\u2113). Extend both h and h\u2032 to X\u03c9 by mapping xi 7\u2192 0 and xp 7\u2192 1 for all xp \u2208 X\u03c9 \\ (var(s\u2113) \u222a {xi}). Now h(s) = h(s\u2113) 6= h\u2032(s\u2113) = h\u2032(s). On the other hand, since h\nand h\u2032 only disagree at z and z /\u2208 var(t\u03c0(\u2113)), it follows that h(t) = h(t\u03c0(\u2113)) = h\u2032(t\u03c0(\u2113)) = h\u2032(t). Consequently, sG 6= tG, a contradiction. Thus var(s\u2113) \u2286 var(t\u03c0(\u2113)). A similar argument shows that var(t\u03c0(\u2113)) \u2286 var(s\u2113).) Now, for all assignments h with h(xi) = 0 and h(L(sk)) = 1 for all k \u2208 [d] \\ {\u2113} we have h(s\u2113) = h(s) = h(t) = h(s\u03c0(\u2113)), so s G \u2113 = t G\n\u03c0(\u2113) for all \u2113 \u2208 [d]. By the induction hypothesis, P us\u2113 = P ut\u03c0(\u2113) for all \u2113 \u2208 [d], and, consequently, P us = P u t .\n6.3. Negated disjunction (NOR). Now we study the ac-spectrum of the groupoid G = ({0, 1}, \u2193), where \u2193 is the negated disjunction (NOR), defined by the rule x \u2193 y = 1 if and only if x = y = 0. Note that the negated disjunction is surjective and its Cayley table has no two identical columns nor two identical rows. Hence Lemma 6.1.1 applies thereto.\nDefinition 6.3.1.\n(i) If fi : Ai \u2192 B (i \u2208 I) are functions with pairwise disjoint domains Ai, then we can define their union\u22c3 i\u2208I fi : \u22c3 i\u2208I Ai \u2192 B by the condition that for all i \u2208 I, the restriction of \u22c3 i\u2208I fi to Ai coincides\nwith fi. In the case when the index set I is finite, we may use notation such as f \u222a g or f \u222a g \u222a h. (ii) Let G = (G, \u25e6) be a groupoid. Let t \u2208 T (X\u03c9) be a linear term. If |t| \u2265 2, then t = (t1t2). Since t is\nlinear, the sets var(t1) and var(t2) are disjoint, and therefore we can write any assignment h : var(t)\u2192 G in a unique way as the union of the two assignments h1 : var(t1)\u2192 G and h2 : var(t2)\u2192 G that are the restrictions of h to var(t1) and var(t2), respectively. Then it clearly holds that h = h1 \u222a h2 and h(t) = (h1 \u222a h2)(t) = h1(t1) \u25e6 h2(t2).\nLet G = ({0, 1}, \u2193). For a term t \u2208 T (X\u03c9), let Tt and Ft be the sets of true and false assignments of t, that is,\nTt := {h : var(t)\u2192 {0, 1} | h(t) = 1}, Ft := {h : var(t)\u2192 {0, 1} | h(t) = 0}.\nIf t is a linear term with |t| \u2265 2, then t = (t1t2), var(t1) \u2229 var(t2) = \u2205, and we have Tt = {h1 \u222a h2 | h1 \u2208 Ft1 \u2227 h2 \u2208 Ft2}, Ft = {h1 \u222a h2 | h1 \u2208 Tt1 \u2228 h2 \u2208 Tt2}.\nLemma 6.3.2. Let k \u2208 {2, 3, 4}, let S1, . . . , Sk be nonempty sets, and let S := S1 \u00d7 \u00b7 \u00b7 \u00b7 \u00d7 Sk. (i) If k = 2, let A \u2286 S1, B \u2286 S2, C \u2286 S1, D \u2286 S2, and let U := A\u00d7B, V := C \u00d7D. (ii) If k = 3, let A \u2286 S1 \u00d7 S2, B \u2286 S3, C \u2286 S1, D \u2286 S2 \u00d7 S3, and let\nU := {(a1, a2, a3) \u2208 S | (a1, a2) \u2208 A, a3 \u2208 B}, V := {(a1, a2, a3) \u2208 S | a1 \u2208 C, (a2, a3) \u2208 D}.\n(iii) If k = 4, let A \u2286 S1 \u00d7 S2, B \u2286 S3 \u00d7 S4, C \u2286 S1 \u00d7 S3, D \u2286 S2 \u00d7 S4, and let U := {(a1, a2, a3, a4) \u2208 S | (a1, a2) \u2208 A, (a3, a4) \u2208 B}, V := {(a1, a2, a3, a4) \u2208 S | (a1, a3) \u2208 C, (a2, a4) \u2208 D}.\nAssume that U = V := S \\ V . Then there exists a j \u2208 [k] such that for all tuples a = (a1, . . . , ak) and b = (b1, . . . , bk) in S satisfying ai = bi for all i 6= j, we have {a,b} \u2286 U or {a,b} \u2286 V . Proof. Suppose, to the contrary, that no such j exists. The argument is slightly different for the different values of k, and we consider separately the three different cases.\n(i) Assume k = 2. There exist pi, qi \u2208 Si (i \u2208 [2]) and p\u20321 \u2208 S1, q\u20322 \u2208 S2 such that (p1, p2), (q1, q2) \u2208 U , (p\u20321, p2), (q1, q \u2032 2) \u2208 V . By the definition of the sets U and V , we have p1, q1 \u2208 A, p2, q2 \u2208 B, p\u20321, q1 \u2208 C, p2, q \u2032 2 \u2208 D.\nSince (q1, q2) \u2208 U = V and q1 \u2208 C, we must have q2 /\u2208 D. It follows that (z1, q2) \u2208 V = U for all z1 \u2208 S1. Since (p\u20321, p2) \u2208 V = U and p2 \u2208 B, we must have p\u20321 /\u2208 A. It follows that (p\u20321, z2) \u2208 U = V for all z2 \u2208 S2. Therefore (p\u20321, q2) \u2208 U \u2229 V , which is a contradiction to our assumption that U = V .\n(ii) Assume k = 3. There exist pi, qi, ri \u2208 Si (i \u2208 [3]) and p\u20321 \u2208 S1, q\u20322 \u2208 S2, r\u20323 \u2208 S3 such that (p1, p2, p3), (q1, q2, q3), (r1, r2, r3) \u2208 U, (p\u20321, p2, p3), (q1, q \u2032 2, q3), (r1, r2, r \u2032 3) \u2208 V.\nBy the definition of the sets U and V , we have\n(p1, p2), (q1, q2), (r1, r2) \u2208 A, p3, q3, r3 \u2208 B, p\u20321, q1, r1 \u2208 C, (p2, p3), (q\u20322, q3), (r3, r\u20323) \u2208 D.\nSince (p1, p2, p3) \u2208 U = V and (p2, p3) \u2208 D, we must have p1 /\u2208 C. It follows that (p1, z2, z3) \u2208 V = U for all z2 \u2208 S2 and z3 \u2208 S3, and, in particular, z3 \u2208 B for all z3 \u2208 S3, i.e., B = S3. On the other hand, since (r1, r2, r \u2032 3) \u2208 V = U and (r1, r2) \u2208 A, we must have r\u20323 /\u2208 B = S3. We have reached a contradiction.\n(iii) Assume k = 4. There exist pi, qi, ri, si \u2208 Si for all i \u2208 [4] and p\u20321 \u2208 S1, q\u20322 \u2208 S2, r\u20323 \u2208 S3, s\u20324 \u2208 S4 such that\n(p1, p2, p3, p4), (q1, q2, q3, q4), (r1, r2, r3, r4), (s1, s2, s3, s4) \u2208 U, (p\u20321, p2, p3, p4), (q1, q \u2032 2, q3, q4), (r1, r2, r \u2032 3, r4), (s1, s2, s3, s \u2032 4) \u2208 V.\nBy the definition of the sets U and V , we have\n(p1, p2), (q1, q2), (r1, r2), (s1, s2) \u2208 A, (p3, p4), (q3, q4), (r3, r4), (s3, s4) \u2208 B, (p\u20321, p3), (q1, q3), (r1, r \u2032 3), (s1, s3) \u2208 C, (p2, p4), (q\u20322, q4), (r2, r4), (s2, s\u20324) \u2208 D.\nSince (p1, p2, p3, p4) \u2208 U = V and (p2, p4) \u2208 D, we must have (p1, p3) /\u2208 C. It follows that (p1, z2, p3, z4) \u2208 V = U for all z2 \u2208 S2 and z4 \u2208 S4, and, in particular, (p1, z2) \u2208 A for all z2 \u2208 S2.\nSince (s1, s2, s3, s4) \u2208 U = V and (s1, s3) \u2208 C, we must have (s2, s4) /\u2208 D. It follows that (z1, s2, z3, s4) \u2208 V = U for all z1 \u2208 S1 and z3 \u2208 S3, and, in particular, (z3, s4) \u2208 B for all z3 \u2208 S3.\nSince (r1, r2, r \u2032 3, r4) \u2208 V = U and (r1, r2) \u2208 A, we must have (r\u20323, r4) /\u2208 B. It follows that (z1, z2, r\u20323, r4) \u2208\nU = V for all z1 \u2208 S1 and z2 \u2208 S2, and, in particular, (z1, r\u20323) \u2208 C for all z1 \u2208 S1. Since (q1, q \u2032 2, q3, q4) \u2208 V = U and (q3, q4) \u2208 B, we must have (q1, q\u20322) /\u2208 A. It follows that (q1, q\u20322, z3, z4) \u2208 U = V for all z3 \u2208 S3 and z4 \u2208 S4, and, in particular, (q\u20322, z4) \u2208 D for all z4 \u2208 S4. Therefore (p1, q \u2032 2) \u2208 A, (r\u20323, s4) \u2208 B, (p1, r\u20323) \u2208 C, and (q\u20322, s4) \u2208 D, so (p1, q\u20322, r\u20323, s4) \u2208 U \u2229 V . This is a contradiction to our assumption that U = V .\nProposition 6.3.3. For G = ({0, 1}, \u2193), we have sacn (G) = Dn\u22121. Proof. Since \u2193 is commutative, we have sacn (G) \u2264 Dn\u22121. In order to prove that the equality holds, we need to show that for all linear terms s, t \u2208 T (X\u03c9), sG = tG implies that the leaf-labeled unordered binary trees T us and T u t are isomorphic.\nAssume sG = tG, which implies var(s) = var(t) =: Y by Lemma 6.1.1. We proceed by induction on n := |s| = |t|. The claim is obvious for n \u2264 2. Assume now that n \u2265 3 and that the claim holds for linear terms with fewer than n variables. Then s = (s1s2) and t = (t1t2).\nFirst consider the case when {var(s1), var(s2)} = {var(t1), var(t2)}; by the commutativity of \u2193, we may assume that var(s1) = var(t1) and var(s2) = var(t2). Suppose, to the contrary, that T u s and T u t are not isomorphic. Then T us1 6\u223c= T ut1 or T us2 6\u223c= T ut2 ; without loss of generality, assume that T us1 6\u223c= T ut1 . By the induction hypothesis, sG1 6= tG1 , so there exists an assignment h1 : var(s1)\u2192 {0, 1} such that h1(s1) 6= h1(t1); without loss of generality, assume h1(s1) = 0 and h1(t1) = 1. By Lemma 6.1.1, s G 2 is surjective, so there is an assignment h2 : var(s2) \u2192 {0, 1} such that h2(s2) = 0. Now (h1 \u222a h2)(s) = h1(s1) \u2193 h2(s2) = 0 \u2193 0 = 1 and (h1 \u222a h2)(t) = h1(t1) \u2193 h2(t2) = 1 \u2193 h2(t2) = 0, so sG 6= tG, a contradiction.\nSuppose now that {var(s1), var(s2)} 6= {var(t1), var(t2)}. There are pairwise disjoint sets Y1, Y2, Y3, Y4 \u2286 Y such that var(s1) = Y1 \u222a Y2, var(s2) = Y3 \u222a Y4, var(t1) = Y1 \u222a Y3, var(t2) = Y2 \u222a Y4, and at most one of the sets Yi is empty; without loss of generality, assume that only Y4 is potentially empty. Let\nW := {(h1, h2, h3, h4) \u2208 {0, 1}Y1 \u00d7 {0, 1}Y2 \u00d7 {0, 1}Y3 \u00d7 {0, 1}Y4 | h1 \u222a h2 \u222a h3 \u222a h4 \u2208 Ts = Tt}. Note that for all (h1, h2, h3, h4) \u2208 W , we have (h1\u222ah2)(s1) = (h3\u222ah4)(s2) = (h1\u222ah3)(t1) = (h2\u222ah4)(t2) = 0. Claim: There exist A \u2286 {0, 1}Y1, B \u2286 {0, 1}Y2, C \u2286 {0, 1}Y3, D \u2286 {0, 1}Y4 such that W = A\u00d7B \u00d7 C \u00d7D. Proof of the Claim: Let A, B, C, and D be the projections of W into the first, second, third, and fourth components, respectively, i.e., A := {h1 \u2208 {0, 1}Y1 | (h1, h2, h3, h4) \u2208 W} and similarly for B, C, D. We clearly haveW \u2286 A\u00d7B\u00d7C\u00d7D. In order to prove the reverse inclusion, let (a, b, c, d) \u2208 A\u00d7B\u00d7C\u00d7D. Then there exist (ai, bi, ci, di) \u2208 W for all i \u2208 [4] such that a = a1, b = b2, c = c3, d = d4. Now (a1 \u222a c1)(t1) = 0 and (b2 \u222a d2)(t2) = 0, so (a1 \u222a b2 \u222a c1 \u222a d2)(t) = 1, i.e., (a1, b2, c1, d2) \u2208 W . Similarly, (a3 \u222a c3)(t1) = 0 and\n(b4 \u222a d4)(t2) = 0, so (a3 \u222a b4 \u222a c3 \u222a d4)(t) = 1, i.e., (a3, b4, c3, d4) \u2208 W . It follows that (a1 \u222a b2)(s1) = 0 and (c3 \u222a d4)(s2) = 0, so (a1 \u222a b2 \u222a c3 \u222a d4)(s) = 1, i.e., (a, b, c, d) \u2208 W . \u22c4\nIt now follows from the above claim that\nFs1 = {h1 \u222a h2 | h1 \u2208 A, h2 \u2208 B}, Fs2 = {h3 \u222a h4 | h3 \u2208 C, h4 \u2208 D}, Ft1 = {h1 \u222a h3 | h1 \u2208 A, h3 \u2208 C}, Ft2 = {h2 \u222a h4 | h2 \u2208 B, h4 \u2208 D}.\nLet us focus on s1. Since Y1 and Y2 are nonempty, |s1| \u2265 2, so s1 = (s11s12). For i, j \u2208 [2], let Zij := var(s1i)\u2229Yj . Note that Z11 and Z12 are not both empty, and Z21 and Z22 are not both empty; without loss of generality, assume that Z11 and Z22 are nonempty. Let\nT := {(a, b, c, d) \u2208 {0, 1}Z11 \u00d7 {0, 1}Z12 \u00d7 {0, 1}Z21 \u00d7 {0, 1}Z22 | a \u222a b \u222a c \u222a d \u2208 Ts1}, F := {(a, b, c, d) \u2208 {0, 1}Z11 \u00d7 {0, 1}Z12 \u00d7 {0, 1}Z21 \u00d7 {0, 1}Z22 | a \u222a b \u222a c \u222a d \u2208 Fs1}.\nWe clearly have T = F := ({0, 1}Z11 \u00d7 {0, 1}Z12 \u00d7 {0, 1}Z21 \u00d7 {0, 1}Z22) \\ F. Moreover, T = {(a, b, c, d) \u2208 {0, 1}Z11 \u00d7 {0, 1}Z12 \u00d7 {0, 1}Z21 \u00d7 {0, 1}Z22 | a \u222a b \u2208 Fs11 , c \u222a d \u2208 Fs12}, F = {(a, b, c, d) \u2208 {0, 1}Z11 \u00d7 {0, 1}Z12 \u00d7 {0, 1}Z21 \u00d7 {0, 1}Z22 | a \u222a c \u2208 A, b \u222a d \u2208 B}.\nIt now follows from Lemma 6.3.2 (statement (i) if Z12 = Z21 = \u2205; statement (ii) if one of Z12 and Z21 is empty and the other is nonempty; statement (iii) if both Z12 and Z21 are nonempty) that there is a variable xj \u2208 var(s1) on which sG1 does not depend. This is in direct contradiction to Lemma 6.1.1, which asserts that sG1 depends on every variable in var(s1). Therefore the case when {var(s1), var(s2)} 6= {var(t1), var(t2)} does not occur."
        },
        {
            "heading": "7. Depth equivalence relations",
            "text": "In this section we study binary operations \u2217 satisfying the property that two full linear terms agree on \u2217 if and only if their corresponding binary trees are equivalent with respect to certain attributes related to the depths of the leaves. More precisely, two binary trees are considered equivalent if their (right) depth sequences are congruent modulo some positive integer k. Here all binary trees are ordered and their leaves are unlabeled unless otherwise stated.\n7.1. The k-right-depth-equivalence.\nDefinition 7.1.1. A groupoid G = (G, \u2217) and the corresponding binary operation \u2217 are said to be right k-associative if G satisfies the identity\n([x1x2 \u00b7 \u00b7 \u00b7xk+1]Rxk+2) \u2248 (x1[x2 \u00b7 \u00b7 \u00b7xk+2]R), where [\u00b7 \u00b7 \u00b7 ]R is a shorthand for the rightmost bracketing of the variables occurring between the square brackets, e.g., [x1x2 \u00b7 \u00b7 \u00b7xk+1]R = (x1(x2(\u00b7 \u00b7 \u00b7 (xkxk+1) \u00b7 \u00b7 \u00b7 ))). One can also define the left k-associativity similarly. The left or right k-associativity becomes the usual associativity when k = 1.\nExample 7.1.2. Typical examples of k-associative operations are the ones defined by a \u2217 b := a+\u03c9b for all a, b \u2208 C, where \u03c9 = e2\u03c0i/k is a k-th primitive root of unity. This reduces to addition and subtraction when k = 1, 2, respectively.\nPrevious work [7] showed that the equivalence relation on binary trees induced by the left k-associativity is the same as the congruence relation on the left depth sequences of binary trees modulo k; this is called the k-left-depth-equivalence relation by the second author. The number of equivalence classes is called the k-modular Catalan number, which counts many restricted families of Catalan objects and has interesting closed formulas [7]. Of course, the right k-associativity corresponds to the k-right-depth-equivalence relation, whose equivalence classes are also counted by the k-modular Catalan number.\nDefinition 7.1.3. The k-right-depth-equivalence relation extends immediately from binary trees with unlabeled leaves to ones with labeled leaves. Let T and T \u2032 be binary trees with n leaves labeled by x1, . . . , xn (in an arbitrary order). We say that T and T \u2032 are k-right-depth-equivalent if \u03c1T (xi) \u2261 \u03c1T \u2032(xi) (mod k) for all i \u2208 [n], i.e., the right depth sequences \u03c1T and \u03c1T \u2032 (see Subsection 2.3 for the definition of the right depth sequence) are componentwise congruent modulo k.\nNow we consider a stronger form of the right k-associativity. Suppose that a binary operation \u2217 satisfies the property that any two full linear terms agree on \u2217 if and only if Ts and Tt are k-right-depth-equivalent, i.e.,\n(7.1.1) \u2200s, t \u2208 Fn, s\u2217 = t\u2217 \u21d0\u21d2 \u03c1Ts(xi) \u2261 \u03c1Tt(xi) (mod k), i = 1, 2, . . . , n. It is clear that such a binary operation \u2217 must be k-right-associative. The above example a \u2217 b := a+ e2\u03c0i/kb satisfies property (7.1.1) and another example is given by f \u2217 g := xf + yg for all x, y \u2208 C[x, y]/(yk \u2212 1) [8]. The associative spectrum of these examples is given by the k-modular Catalan numbers mentioned above. Our goal here is to determine the ac-spectrum sacn (\u2217) of a binary operation \u2217 satisfying property (7.1.1) and its exponential generating function. If k = 1 then we clearly have sacn (\u2217) = 1 for all n \u2265 1 with exponential generating function \u2211 n\u22651 t\nn/n! = et \u2212 1. Thus we assume k \u2265 2 in the remainder of this section. Example 7.1.4. Let us consider the subtraction operation \u2212 on C. For n \u2265 2, one can check that the term operations in F\u2212n are precisely the operations of the form (a1, . . . , an) 7\u2192 \u00b1a1 \u00b1 a2 \u00b7 \u00b7 \u00b7 \u00b1 an with at least one plus sign and at least one minus sign. Hence sacn (\u2212) = 2n \u2212 2 and\n\u221e\u2211\nn=1\nsacn (\u2212) n! tn = t+ \u2211\nn\u22652\n2n \u2212 2 n! tn\n= t+ e2t \u2212 1\u2212 2t\u2212 2(et \u2212 1\u2212 t) = t+ e2t \u2212 2et + 1 = t+ (et \u2212 1)2.\nDefinition 7.1.5. Let T be any binary tree with n \u2265 2 leaves. For i \u2208 [k], let nT (i) be the number of leaves in T whose right depth is congruent to i modulo k. We say a sequence (n1, . . . , nk) of nonnegative integers is (right) (n, k)-admissible if it satisfies\n(i) n1 \u2265 1, nk \u2265 1, and n1 + n2 + \u00b7 \u00b7 \u00b7+ nk = n \u2265 2, (ii) if ni = 0 for some i \u2208 {2, 3, . . . , k \u2212 2} then ni+1 = 0, and (iii) if nk\u22121 = 0 then nk = 1.\nLemma 7.1.6. Let T be any binary tree with n \u2265 2 leaves. Then (nT (1), . . . , nT (k)) is (n, k)-admissible. Proof. (i) We have nT (1) \u2265 1 and nT (k) \u2265 1 since the two leftmost leaves in T have right depth 0 and 1, respectively. We have nT (1) + nT (2) + \u00b7 \u00b7 \u00b7+ nT (k) = n since T has n leaves.\n(ii) Let i \u2208 {2, 3, . . . , k \u2212 2}. Suppose there exists a leaf v in T whose right depth is congruent to i + 1 modulo k. If v is a right child then the leftmost leaf of the subtree rooted at the left sibling u of v has right depth congruent to i modulo k. If v is a left child then it must have an ancestor u whose right depth is one less than that of v (otherwise the right depth of v would be zero), and the leftmost leaf in the subtree rooted at u has right depth congruent to i modulo k. Therefore nT (i+1) > 0 implies nT (i) > 0, or in other words, nT (i) = 0 implies nT (i+ 1) = 0.\n(iii) Similarly to (2), one can show that if a leaf of T is different from the leftmost leaf but has right depth congruent to k, then there exists a leaf with right depth congruent to k\u2212 1 modulo k. Hence nT (k \u2212 1) = 0 implies nT (k) = 1.\nLemma 7.1.7. Let (n1, . . . , nk) be any (n, k)-admissible sequence. Then there exists a binary tree T with n leaves such that nT (i) = ni for all i \u2208 [k]. Proof. We prove this lemma by induction on n. There is no (n, k)-admissible sequence for n = 1, and the claim is trivial for n = 2. Assume n \u2265 3 and let (n1, . . . , nk) be an (n, k)-admissible sequence.\nIf n1 > 1 then applying the induction hypothesis to the (n\u2212 1, k)-admissible sequence (n1\u2212 1, n2, . . . , nk) gives a binary tree T \u2032 with n\u2212 1 leaves such that nT \u2032(1) = n1 \u2212 1 and nT \u2032(i) = ni for i \u2208 {2, 3, . . . , k}, and the binary tree T := T \u2032 \u2227 1 satisfies nT (i) = ni for all i, where 1 is the one-vertex tree.\nAssume now n1 = 1. We must have n2 \u2265 1, since n2 = 0 would imply n3 = \u00b7 \u00b7 \u00b7 = nk\u22121 = 0 and nk = 1; hence n = 2 < 3, a contradiction. Therefore we can apply the induction hypothesis to the (n\u22121, k)-admissible sequence (n2, n3, . . . , nk\u22121, nk \u2212 1, 1) and get a binary tree T \u2032 with nT \u2032(i \u2212 1) = ni for i \u2208 {2, 3, . . . , k \u2212 1}, nT \u2032(k \u2212 1) = nk \u2212 1, and nT \u2032(k) = 1. Then the binary tree T := 1 \u2227 T \u2032 satisfies nT (1) = nT \u2032(k) = 1, nT (i) = nT \u2032(i\u2212 1) = ni for i \u2208 {2, 3, . . . , k \u2212 1}, and nT (k) = nT \u2032(k \u2212 1) + 1 = nk.\nRemark 7.1.8. If i \u2208 {1, k} then letmT (i) := nT (i)\u22121; otherwise letmT (i) := nT (i). It follows immediately from the previous two lemmas that the sequences (mT (1), . . . ,mT (k)) obtained from binary trees T with n leaves are precisely those sequences (m1, . . . ,mk) of nonnegative integers such that\n(i) m1 +m2 + \u00b7 \u00b7 \u00b7+mk = n\u2212 2, and (ii) if mi = 0 for some i \u2208 {2, 3, . . . , k \u2212 1} then mi+1 = 0.\nBy removing the trailing zeros, one sees that either (m1, . . . ,mk) corresponds to a composition (i.e., an ordered partition) of n\u2212 2 with length at most k if m1 > 0, or (m2, . . . ,mk) corresponds to a composition of n\u2212 2 with length at most k \u2212 1 if m1 = 0.\nRecall that the number of partitions of the set [n] = {1, 2, . . . , n} into k (unordered) blocks is the Stirling number of the second kind S(n, k) whose exponential generating function is\n\u2211\nn\u22651\nS(n, k) tn\nn! = (et \u2212 1)k k! .\nTheorem 7.1.9. Let \u2217 be a binary operation satisfying property (7.1.1) with k \u2265 2. Then sacn (\u2217) = k!S(n, k) + n \u2211\n0\u2264i\u2264k\u22122\ni!S(n\u2212 1, i), \u2200n \u2265 1,\n\u221e\u2211\nn=1\nsacn (\u2217) n! tn = (et \u2212 1)k + \u2211\n0\u2264i\u2264k\u22122\nt(et \u2212 1)i.\nProof. We prove the desired formula for sacn (\u2217) by induction. It is trivial when n = 1. Assume n \u2265 2 below. Property (7.1.1) asserts that two terms s, t \u2208 Fn induce the same term operation on \u2217 if and only if the\nright-depth sequences \u03c1Ts := (\u03c1Ts(x1), . . . , \u03c1Tx(xn)) and \u03c1Tt := (\u03c1Tt(x1), . . . , \u03c1Tt(xn)) are componentwise congruent modulo k. Therefore sacn (\u2217) equals the number of possible right-depth sequences modulo k of binary trees with n leaves labeled with x1, . . . , xn.\nBy Lemmas 7.1.6 and 7.1.6, a sequence (d1, . . . , dn) with 1 \u2264 d1, . . . , dn \u2264 k is congruent modulo k to the right depth sequence of a binary tree with n leaves labeled by x1, . . . , xn if and only if the sequence (n1, . . . , nk) is (n, k)-admissible, where\nni := #{j \u2208 [n] : dj = i} for i = 1, . . . , k. First, assume that n1, . . . , nk \u2265 1. Then (n1, . . . , nk) is (n, k)-admissible if and only if n1 + \u00b7 \u00b7 \u00b7+ nk = n.\nThus the sequences (d1, . . . , dn) belonging to this case are in bijection with partitions of [n] into ordered blocks {j \u2208 [n] : dj = i} for i = 1, . . . , k, and they are counted by k!S(n, k).\nNext, assume that there exists i \u2208 [k \u2212 2] such that ni+1 = 0, where i is as small as possible. We have ni+1 = \u00b7 \u00b7 \u00b7 = nk\u22121 = 0 and nk = 1. Thus the number of sequences (d1, d2, . . . , dn) belonging to this case is\nn \u2211\n1\u2264i\u2264k\u22122\ni!S(n\u2212 1, i)\nCombining the above two cases we have\nsacn (\u2217) = k!S(n, k) + n \u2211\n1\u2264i\u2264k\u22122\ni!S(n\u2212 1, i)\n= k!S(n, k) + n \u2211\n0\u2264i\u2264k\u22122\ni!S(n\u2212 1, i).\nConsequently, we have the exponential generating function \u221e\u2211\nn=1\nsacn (\u2217) n! tn = \u2211\nn\u22651\nk!S(n, k) tn\nn! +\n\u2211\nn\u22651\n\u2211\n0\u2264i\u2264k\u22122\ni!S(n\u2212 1, i) t n\n(n\u2212 1)!\n= (et \u2212 1)k + \u2211\n0\u2264i\u2264k\u22122\ni! \u2211\nn\u22651\nS(n\u2212 1, i) t n\n(n\u2212 1)!\n= (et \u2212 1)k + \u2211\n0\u2264i\u2264k\u22122\nt(et \u2212 1)i.\nRemark 7.1.10. When k = 3 we have n \u2211\n1\u2264i\u2264k\u22122 i!S(n\u22121, i) = n for all n \u2265 2. When k = 4, the sequence n \u2211\n1\u2264i\u2264k\u22122 i!S(n\u2212 1, i) is recorded in OEIS [19, A058877] and has the following simple closed formulas:\nn2n\u22121 \u2212 n = \u2211\n1\u2264j\u2264n\n(n\u2212 2 + j)2n\u2212j\u22121 = \u2211\n1\u2264j\u2264n\u22121\n( n\nj\n) (n\u2212 j).\nRecently, Hein and the first author [8] generalized the k-associativity to the (k, \u2113)-associativity, based on the example f \u2217 g := xf + yg for all x, y \u2208 C[x, y]/(xk \u2212 1, y\u2113 \u2212 1), which satisfies (7.1.2) \u2200s, t \u2208 Fn, s\u2217 = t\u2217 \u21d0\u21d2 \u03b4Ts(xi) \u2261 \u03b4Tt(xi) (mod k), \u03c1Ts(xi) \u2261 \u03c1Tt(xi) (mod \u2113), i = 1, 2, . . . , n.\nComputations give the following ac-spectra for any operation \u2217 satisfying the above property (7.1.2), which do not appear in OEIS.\n\u2022 (k, \u2113) = (2, 2): 1, 2, 12, 54, 260, 1080, . . . \u2022 (k, \u2113) = (3, 2): 1, 2, 12, 84, 590, 4110, . . . \u2022 (k, \u2113) = (4, 2): 1, 2, 12, 84, 770, 7080, . . . \u2022 (k, \u2113) = (3, 3): 1, 2, 12, 108, 960, 9240, . . .\n7.2. The k-depth-equivalence. We now consider the operation on C defined by a \u2217 b := e2\u03c0i/\u2113a+ e2\u03c0i/kb, which generalizes the example a \u2217 b := a+ e2\u03c0i/kb mentioned earlier. When k = \u2113, one sees that any two full linear terms agree on \u2217 if and only if their corresponding binary trees are k-depth-equivalent, i.e.,\n(7.2.1) \u2200s, t \u2208 Fn, s\u2217 = t\u2217 \u21d0\u21d2 dTs(xi) \u2261 dTt(xi) (mod k).\nFurther generalizations of depth equivalence were studied in recent work of the second author. For k = 2, the resulting operation is the double minus operation a\u2296 b := \u2212a\u2212 b. The first author, Mickey, and Xu [11] showed that if san(\u2296) = 1 if n = 1 and\nsan(\u2296) = \u230a 2n\n3\n\u230b =\n \n\n2n \u2212 1 3 , if n is even,\n2n \u2212 2 3 , if n is odd\nif n \u2265 2. This coincides with an interesting sequence in OEIS [19, A000975] (except for the first term). Now we show that sacn (\u2296) agrees with the well-known Jacobsthal sequence [19, A001045].\nTheorem 7.2.1. For n \u2265 1 we have sacn (\u2296) = (2n \u2212 (\u22121)n)/3.\nProof. Note first that every term operation in B\u2296n is of the form (a1, . . . , an) 7\u2192 \u00b1a1\u00b1\u00b7 \u00b7 \u00b7\u00b1an. On the other hand, not every operation of this form is in B\u2296n . Consider operations of this form with exactly r plus signs in the defining expression; there are ( n r ) such operations. It was shown in [11, Theorem 8] that\n(i) all operations of this form are in B\u2296n if n+ r \u2261 2 (mod 3) and n 6= 2r \u2212 1, (ii) all but the one with alternating signs are in B\u2296n if n+ r \u2261 2 (mod 3) and n = 2r \u2212 1, and (iii) none of them is in B\u2296n if n+ r 6\u2261 2 (mod 3). Now, let us consider term operations in F\u2296n . They are again of the form (a1, . . . , an) 7\u2192 \u00b1a1 \u00b1 \u00b7 \u00b7 \u00b7 \u00b1 an. We get no new operations in the first and third cases above, but one more in the second case: the operation with alternating signs is in F\u2296n . Taking the sum over all possible values of r, we have s ac n (\u2296) = san(\u2296) if n is even and sacn (\u2296) = san(\u2296) + 1 if n is odd. This implies that sacn (\u2296) = (2n \u2212 (\u22121)n)/3.\nOne sees that this theorem holds for any binary operation \u2217 satisfying property (7.2.1) with k = 2. For k \u2265 3, neither san(\u2217) nor sacn (\u2217) occurs in OEIS.\n\u2022 san(\u2217) for k = 3: 1, 2, 5, 14, 42, 129, 398, 1223, 3752, 11510, . . . \u2022 san(\u2217) for k = 4: 1, 2, 5, 14, 42, 132, 429, 1429, 4849, 16689, . . . \u2022 sacn (\u2217) for k = 3: 1, 3, 13, 35, 101, 315, . . . \u2022 sacn (\u2217) for k = 4: 1, 3, 13, 75, 285, 1099, . . ."
        },
        {
            "heading": "8. Remarks and questions",
            "text": "Csa\u0301ka\u0301ny and Waldhauser [4, Section 4] examined the associative spectrum of every two-element groupoid. We obtain the ac-spectra of all two-element groupoids in Example 4.1.2 and Propositions 6.2.1 and 6.3.3.\nAs possible directions for further research, one could study the associative spectra and the ac-spectra of groupoids satisfying some properties weaker than associativity. We would like to mention a few examples of such properties that have emerged in different branches of algebra.\nA groupoid (G, \u2217) is left alternative (resp., right alternative) if it satisfies the identity (x\u2217x)\u2217y \u2248 x\u2217(x\u2217y) (resp., y\u2217(x\u2217x) = (y\u2217x)\u2217x). A groupoid is alternative if it is both left and right alternative. An associative groupoid must be alternative, but not vice versa.\nA Lie algebra is neither commutative nor associative, but it is flexible in the sense that it satisfies the identity x \u2217 (y \u2217 x) \u2248 (x \u2217 y) \u2217 x. Any commutative or associative operation must be flexible. So flexibility becomes important when a binary operation is neither commutative nor associative, such as the multiplication of the sedenions, which is not even alternative (the same for all higher Cayley\u2013Dickson algebras). For example, the multiplication of the octonions is alternative but not associative. In 1954, Richard Schafer [20] examined the algebras generated by the Cayley\u2013Dickson process over a field and showed that they satisfy the flexible identity.\nA groupoid (G, \u2217) is power associative if the subgroupoid generated by any element is associative. Power associativity and alternativity are unrelated properties in the sense that neither implies the other, as shown, e.g., by the examples provided by Holin [9, Appendix A.1.1].\nRecall that the Jordan algebra of n \u00d7 n self-adjoint matrices over R, C, or H with a product defined by x \u25e6 y := (xy + yx)/2 is commutative and thus flexible. Although it is not associative, it is power associative and satisfies the Jordan identity\n(x \u25e6 y) \u25e6 (x \u25e6 x) \u2248 x \u25e6 (y \u25e6 (x \u25e6 x)). We showed in Section 4.3 that the associative spectrum san(\u25e6) of the Jordan algebra achieves the upper bound Cn\u22121 for an arbitrary binary operation and its ac-spectrum s ac n (\u25e6) reaches the upper bound Dn\u22121 for commutative operations. Another interesting example is the Okubo algebra, which consists of all 3-by-3 trace zero complex matrices\nwith product defined as\nx \u25e6 y := axy + byx\u2212 tr(xy)I3/3. Here I3 is the 3-by-3 identity matrix and a, b \u2208 C satisfy a+ b = 3ab = 1. The Okubo algebra is flexible and power associative but not associative nor alternative."
        }
    ],
    "year": 2023
}