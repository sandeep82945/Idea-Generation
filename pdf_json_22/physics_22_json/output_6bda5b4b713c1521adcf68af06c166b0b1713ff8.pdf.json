{
    "abstractText": "In aeromagnetic detection, the magnetic interference conducted by electric currents in onboard electronic (OBE) equipment is gradually being taken seriously with the development of aeromagnetic compensation technology. Here, we propose a compensation method based on the synthetically total magnetic field (STMF) measured by an onboard fluxgate vector magnetometer. In this method, a compensation model is firstly built to suppress the electric current magnetic interference (ECMI) which is jointly measured by a scalar magnetometer and a fluxgate vector magnetometer. The singular spectrum analysis (SSA) method is introduced to accurately extract the characteristic signal of the ECMI from the compensated STMF. In addition, in order to better suppress the geomagnetic gradient interference, the International Geomagnetic Reference Field (IGRF) model is introduced to modify the existing geomagnetic gradient compensation model. Based on these, a novel compensation model including the traditional aeromagnetic compensation model, modified geomagnetic gradient model, and ECMI compensation model is proposed. The results in the field experiment show that this model has better compensation performance than the TLG model, which is extended from the T\u2013L compensation model.",
    "authors": [
        {
            "affiliations": [],
            "name": "Chao Zhang"
        },
        {
            "affiliations": [],
            "name": "Changping Du"
        },
        {
            "affiliations": [],
            "name": "Xiang Peng"
        }
    ],
    "id": "SP:624d4034be3f64c66132fee2ff991432b1823da2",
    "references": [
        {
            "authors": [
                "S.N.F. Jamaludin",
                "M. Pubellier",
                "B. Sautter"
            ],
            "title": "Shallow vs. Deep Subsurface Structures of Central Luconia Province, Offshore Malaysia Reveal by Aeromagnetic",
            "venue": "Airborne Gravity and Seismic Data. Appl. Sci",
            "year": 2021
        },
        {
            "authors": [
                "A.M. Gorodnitskiy",
                "Y.V. Brusilovskiy",
                "A.N. Ivanenko",
                "A.M. Filin",
                "N.A. Shishkina"
            ],
            "title": "New methods for processing and interpreting marine magnetic anomalies: Application to structure, oil and gas exploration, Kuril forearc, Barents and Caspian seas",
            "venue": "Geosci. Front. 2013,",
            "year": 2013
        },
        {
            "authors": [
                "A. Sheinker",
                "N. Salomonski",
                "B. Ginzburg",
                "L. Frumkis",
                "B.Z. Kaplan"
            ],
            "title": "Aeromagnetic search using genetic algorithm",
            "venue": "Piers Online 2005,",
            "year": 2005
        },
        {
            "authors": [
                "K. Parvar",
                "A. Braun",
                "D. Layton-Matthews",
                "M. Burns"
            ],
            "title": "UAV magnetometry for chromite exploration in the Samail ophiolite sequence, Oman",
            "venue": "J. Unmanned Veh. Syst. 2018,",
            "year": 2018
        },
        {
            "authors": [
                "W. Tolles",
                "J. Lawson"
            ],
            "title": "Magnetic Compensation of MAD Equipped Aircraft",
            "venue": "Airborne Instruments Lab. Inc.: Mineola, NY, USA,",
            "year": 1950
        },
        {
            "authors": [
                "P. Leliak"
            ],
            "title": "Identification and evaluation of magnetic-field sources of magnetic airborne detector equipped aircraft",
            "venue": "IRE Trans. Aerosp. Navig. Electron",
            "year": 1961
        },
        {
            "authors": [
                "S.H. Bickel"
            ],
            "title": "Small signal compensation of magnetic fields resulting from aircraft maneuvers",
            "venue": "IEEE Trans. Aerosp. Electron. Syst. 1979,",
            "year": 1979
        },
        {
            "authors": [
                "P.M. Williams"
            ],
            "title": "Aeromagnetic compensation using neural networks",
            "venue": "Neural Comput. Appl. 1993,",
            "year": 1993
        },
        {
            "authors": [
                "Z. Dou",
                "K. Ren",
                "Q. Han",
                "X. Niu"
            ],
            "title": "A Novel Real-Time Aeromagnetic Compensation Method Based on RLSQ",
            "venue": "In Proceedings of the 2014 Tenth International Conference on Intelligent Information Hiding and Multimedia Signal Processing, Kitakyushu, Japan,",
            "year": 2014
        },
        {
            "authors": [
                "M. Fu",
                "J. Li",
                "T. Wu",
                "T. Liu",
                "M. Wang",
                "K. Wang",
                "J. Kang"
            ],
            "title": "Aeromagnetic compensation based on Tikhonov regularization with limited L-curve parame-ter-choice algorithm",
            "venue": "In Proceedings of the 2018 37th Chinese Control Conference, Wuhan, China,",
            "year": 2018
        },
        {
            "authors": [
                "G. Zhao",
                "Q. Han",
                "X. Peng",
                "P. Zou",
                "H. Wang",
                "C. Du",
                "X. Tong",
                "Q. Li",
                "H. Guo"
            ],
            "title": "An Aeromagnetic Compensation Method Based on a Multimodel for Mitigating Multicollinearity",
            "year": 2019
        },
        {
            "authors": [
                "B. Gu",
                "Q. Li",
                "H. Liu"
            ],
            "title": "Aeromagnetic compensation based on truncated singular value decomposition with an improved parameterchoice algorithm",
            "venue": "In Proceedings of the 2013 6th International Congress on Image and Signal Processing (CISP), Hangzhou, China,",
            "year": 2013
        },
        {
            "authors": [
                "B.W. Leach"
            ],
            "title": "Aeromagnetic compensation as a linear regression problem. In Information Linkage between Applied Mathematics and Industry",
            "year": 1980
        },
        {
            "authors": [
                "Z. Cao",
                "D. Chen",
                "F. Yu",
                "H. Wang",
                "Z. Zeng"
            ],
            "title": "EMI suppression of UAV power in aeromagnetic survey",
            "venue": "IEEE Electromagn. Compat. Mag. 2009,",
            "year": 2009
        },
        {
            "authors": [
                "C. Du",
                "H. Wang"
            ],
            "title": "Extended aeromagnetic compensation modelling including non-manoeuvring interferences",
            "venue": "IET Sci. Meas. Technol",
            "year": 2019
        },
        {
            "authors": [
                "G. Noriega",
                "A. Marszalkowski"
            ],
            "title": "Adaptive techniques and other recent developments in aeromagnetic compensation",
            "venue": "First Break",
            "year": 2017
        },
        {
            "authors": [
                "S. Yang",
                "M. Tan",
                "T. Yu",
                "X. Li",
                "X. Wang",
                "J. Zhang"
            ],
            "title": "Hybrid reduced graphene oxide with special magnetoresistance for wireless magnetic field sensor",
            "venue": "Nano-Micro Lett. 2020,",
            "year": 2020
        },
        {
            "authors": [
                "V. Matko",
                "M. Milanovi\u0107"
            ],
            "title": "High Resolution Switching Mode Inductance-to-Frequency Converter with Temperature Compensation",
            "venue": "Sensors 2014,",
            "year": 1924
        },
        {
            "authors": [
                "T. Ohmuta",
                "K. Mitsui",
                "N. Shibata"
            ],
            "title": "ECG QT-I nterval Measurement Using Wavelet Transformation",
            "venue": "Sensors",
            "year": 2020
        },
        {
            "authors": [
                "M. Zhu",
                "X. Zhou",
                "B. Zang",
                "B. Yang",
                "M. Xing"
            ],
            "title": "Micro-Doppler Feature Extraction of Inverse Synthetic Aperture Imaging Laser Radar Using Singular-Spectrum Analysis",
            "venue": "Sensors 2018,",
            "year": 2018
        },
        {
            "authors": [
                "B. Azzerboni",
                "F. La Foresta",
                "N. Mammone",
                "F.C. Morabito"
            ],
            "title": "A new approach based on wavelet-ICA algorithms for fetal electrocardiogram extraction",
            "venue": "In Proceedings of the ESANN, Bruges, Belgium,",
            "year": 2005
        },
        {
            "authors": [
                "Y. Guo",
                "S. Huang",
                "Y. Li",
                "G.R. Naik"
            ],
            "title": "Edge effect elimination in single-mixture blind source separation",
            "venue": "Circuits Syst. Signal Process",
            "year": 2013
        },
        {
            "authors": [
                "H. Hassani"
            ],
            "title": "Singular spectrum analysis: Methodology and comparison",
            "venue": "J. Data Sci",
            "year": 2007
        },
        {
            "authors": [
                "H. Wang",
                "C. Du"
            ],
            "title": "Aeromagnetic compensation with suppressing heading error of the scalar atomic magnetometer",
            "venue": "JIEEE Geosci. Remote Sens. Lett. 2019,",
            "year": 2019
        },
        {
            "authors": [
                "Z. Dou",
                "Q. Han",
                "X. Niu",
                "X. Peng",
                "H. Guo"
            ],
            "title": "An aeromagnetic compensation coefficient-estimating method robust to geomagnetic gradient",
            "venue": "IEEE Geosci. Remote Sens. Lett. 2016,",
            "year": 2016
        },
        {
            "authors": [
                "J.D. Jackson"
            ],
            "title": "Classical Electrodynamics",
            "year": 2021
        },
        {
            "authors": [
                "Z. Wu",
                "N.E. Huang"
            ],
            "title": "Ensemble empirical mode decomposition: A noise-assisted data analysis method",
            "venue": "Adv. Adapt. Data Anal. 2009,",
            "year": 2009
        },
        {
            "authors": [
                "E. Dawson",
                "L.R. Newitt"
            ],
            "title": "An analytical representation of the geomagnetic field in Canada for 1975",
            "venue": "Part I: The main field. Can. J. Earth Sci",
            "year": 1978
        },
        {
            "authors": [
                "D.D. McGregor"
            ],
            "title": "High-ensitivity helium resonance magnetometers",
            "venue": "Rev. Sci. Instrum",
            "year": 1987
        },
        {
            "authors": [
                "I. Daubechies"
            ],
            "title": "Orthonormal bases of compactly supported wavelets",
            "venue": "Commun. Pure Appl. Math",
            "year": 1988
        },
        {
            "authors": [
                "W.-H. Jung",
                "S.-G. Lee"
            ],
            "title": "ECG Identification Based on Non-Fiducial Feature Extraction Using Window Removal Method",
            "venue": "Appl. Sci. 2017,",
            "year": 2017
        },
        {
            "authors": [
                "E. Aker",
                "M.L. Othman",
                "V. Veerasamy",
                "I.b. Aris",
                "N.I.A. Wahab",
                "H. Hizam"
            ],
            "title": "Fault Detection and Classification of Shunt Compensated Transmission Line Using Discrete Wavelet Transform and Naive Bayes Classifier",
            "venue": "Energies",
            "year": 2020
        },
        {
            "authors": [
                "A. Mannelli",
                "F. Papi",
                "G. Pechlivanoglou",
                "G. Ferrara",
                "A. Bianchini"
            ],
            "title": "Discrete Wavelet Transform for the Real-Time Smoothing of Wind Turbine Power Using Li-Ion Batteries",
            "venue": "Energies",
            "year": 2021
        },
        {
            "authors": [
                "G. Noriega"
            ],
            "title": "Performance measures in aeromagnetic compensation",
            "venue": "Lead. Edge 2011,",
            "year": 2011
        }
    ],
    "sections": [
        {
            "text": "Citation: Zhang, C.; Du, C.; Peng, X.;\nHan, Q.; Guo, H. An Aeromagnetic\nCompensation Method for\nSuppressing the Magnetic\nInterference Generated by Electric\nCurrent with Vector Magnetometer.\nSensors 2022, 22, 6151. https://\ndoi.org/10.3390/s22166151\nAcademic Editor: Nerija \u017durauskiene\u0307\nReceived: 27 June 2022\nAccepted: 15 August 2022\nPublished: 17 August 2022\nPublisher\u2019s Note: MDPI stays neutral\nwith regard to jurisdictional claims in\npublished maps and institutional affil-\niations.\nCopyright: \u00a9 2022 by the authors.\nLicensee MDPI, Basel, Switzerland.\nThis article is an open access article\ndistributed under the terms and\nconditions of the Creative Commons\nAttribution (CC BY) license (https://\ncreativecommons.org/licenses/by/\n4.0/).\nKeywords: aeromagnetic compensation; electric current magnetic interference; vector magnetometer; geomagnetic gradient interference; IGRF model"
        },
        {
            "heading": "1. Introduction",
            "text": "Aeromagnetic detection has been widely applied in geophysical exploration, geological mapping, leakage detection of oil and gas pipelines, shipwreck salvaging, and other fields in recent years [1\u20135]. Its working principle is to find the buried ferromagnetic object by analyzing the anomaly of the geomagnetic field, which is caused by the ferromagnetic object and is sensed by the airborne magnetometer. However, the airborne magnetometer also senses magnetic interference from the motion platform, geomagnetic gradient, and geomagnetic environmental background field when collecting the magnetic field of the object. The magnetic interference from the platform is larger than the object\u2019s magnetic field because the magnetometer is very close to the fuselage. To suppress it, Tolls and Lawson proposed the T\u2013L compensation model in 1950 [6]. In this model, the authors categorized the magnetic interference into three parts: permanent field, induced field, and eddy field. In Ref. [7], the interference is written as the form of 16-term compensation functions, each of which consists of a fixed compensation coefficient and a basis function, and a practical application method has also been provided. To solve the problem of multicollinearity in the equations constructed by the T\u2013L model, Bickel proposed the small signal method by decomposing the direction cosine angle into the form of the main direction and its variation, obtaining the solution of the equations in 1979 [8]. With the improvement of\nSensors 2022, 22, 6151. https://doi.org/10.3390/s22166151 https://www.mdpi.com/journal/sensors\ncomputing power and the development of mathematical solution methods, more methods have been applied to accurately solve the equations, such as recursive least squares (RLS), truncated singular value decomposition, ridge estimation, and neural networks [9\u201314]. These methods can improve the compensation accuracy to a certain extent, but they still cannot satisfy the requirements of modern, high-precision aeromagnetic compensation. The platform magnetic interference not only contains the traditional maneuver magnetic interference, but also contains electric current magnetic interference (ECMI) from in onboard electronic (OBE) equipment and magnetic interference caused by movable parts relative to the fuselage. The quality of aeromagnetic compensation can be improved through studying the sources of these additional magnetic interferences and forming the updated compensation models. In Ref. [15], the authors proposed to use electromagnetic compatibility technology to suppress the current magnetic interference of switch mode power supply on aircraft platform. In Ref. [16], the authors proposed compensation methods for the magnetic interference from the relative movable component and onboard electric current, respectively. In Ref. [17], the authors proposed a compensation method for the ECMI according to monitor the current change in every electronic equipment. However, the compensation effect of these models on the ECMI relies on the accuracy of the sensor used to monitor the electric current, and a large number of current sensors are needed to monitor all current drivers which can cause magnetic interference. Thus, the compensation accuracy of these models has been limited by the precisions of current sensors and adaptive compensation methods. In addition, magnetic sensors are also affected by temperature. In Ref. [18], the authors prepared hybrid reduced graphene oxide nanosheets that have large magnetoresistance at a low magnetic field at room temperature and used in wireless magnetic field sensors for quick detection of low electromagnetic radiation. In Ref. [19], the authors proposed a novel method for the temperature-compensated inductance\u2013to\u2013 frequency converter, which can be used in magnetic sensors. In this paper, a new method to compensate the ECMI based on a fluxgate vector magnetometer is proposed. In practice, there are two different magnetometers in the airborne detection system. One is a scalar magnetometer which is far from the aircraft and used to measure the scalar target magnetic signal, the other is a vector magnetometer which is near the aircraft body and used to obtain the direction cosine of the geomagnetic field in the reference system of the airborne platform. Thus, both magnetometers will collect scalar and vector ECMI at the same time. The ECMI measured by the scalar magnetometer can be expressed by projecting the vector field of the ECMI to the direction of the geomagnetic field [16]. Based on this, this paper infers the compensation model of the ECMI, and the model is an expression including the compensated synthetically total magnetic field (STMF) of the ECMI, direction cosine of geomagnetic field and constant coefficient to be estimated. In order to obtain the accurate ECMI characteristic signal from the STMF measured by the onboard fluxgate vector magnetometer, we apply a decomposition method to extract the ECMI characteristic signal from the residual magnetic field, which is the STMF after suppressing the platform maneuver magnetic interference and geomagnetic gradient interference. Common decomposition techniques include wavelet transform (WT), ensemble empirical mode decomposition (EEMD), singular spectrum analysis (SSA) and others [20\u201322]. An appropriate wavelet basis function needs to be firstly determined in the WT, but it is difficult to find a proper wavelet basis function to accurately extract the characteristic signal of the ECMI [23]. EEMD is an improved version of empirical mode decomposition (EMD) that can decompose nonlinear and non-stationary signals. However, EEMD has the disadvantage of edge effect and certain noise in each component after decomposition [24]. SSA is a powerful tool and currently developed for dealing with nonlinear and non-stationary time series without the edge effect or requiring prior information to find an appropriate basis function. It can also be combined with elements of classical time-series analysis, multivariate statistics, and signal processing to process complicated signals, and is used in many fields [25]. Therefore, SSA is introduced to extract the characteristic signal of ECMI in this paper. In addition, the International Geomagnetic Reference Field (IGRF)\nmodel is also brought in to form a novel compensation model for geomagnetic gradient interference by combining with the first-order geomagnetic gradient compensation model. Thus far, a novel compensation model can be constructed by combining the traditional magnetic interference compensation model, the ECMI compensation model, and the modified geomagnetic gradient compensation model. In this paper, we first deduce the relationship between the ECMI measured by the scalar magnetometer at the far end of the fuselage and the synthetic ECMI field measured by the vector magnetometer near the fuselage. Then, we introduce the SSA method to accurately extract the characteristic signal of ECMI from the compensated STMF. Next, a new geomagnetic gradient interference compensation model is constructed by combining the IGRF model and the previous first\u2013order linear model. Finally, the aeromagnetic compensation model proposed in this paper is summarized. Some field experiments are arranged to illustrate the effectiveness of this compensation method."
        },
        {
            "heading": "2. Analysis and Methods",
            "text": "In the aeromagnetic detection, the total magnetic field Bt measured by the magnetometer includes the target signal BM, the platform maneuver magnetic interference BTL, the geomagnetic gradient interference field BE, and the ECMI BC. Thus, Bt can be expressed as\nBt = BM + BTL + BE + BC. (1)\nIn order to better detect the target signal BM, the three kinds of magnetic interference need to be well-suppressed."
        },
        {
            "heading": "2.1. Compensation Model for Platform Maneuver Magnetic Interference",
            "text": "Tolles and Lawson regarded the platform as a conjoined and rigid whole, and believed that the maneuver magnetic interference comes from the permanent magnetic field, induced magnetic field, and eddy magnetic field of the platform. Therefore, a compensation model was constructed according to the physical analysis of the generation of three magnetic fields to suppress the platform maneuver magnetic interference. This compensation model is usually called the T\u2013L compensation model, which will be briefly introduced below. In this paper, a coordinate system is established with the position of the onboard magnetometer as the origin O, as shown in Figure 1. The Y-axis points to the nose along the direction of the fuselage, the Z-axis is perpendicular to the fuselage downward, and the X-axis, Y-axis, and Z-axis follow the right-hand rule. Among them, N is the geomagnetic north, Bg is the vector geomagnetic field, and \u03b1X, \u03b1Y and \u03b1Z are the angles between the geomagnetic field Bg and the three axes of the platform coordinate system.\nAccording to the T\u2013L model, the platform maneuver magnetic interference model consists of three permanent field components, five induced field components, and eight\neddy field components, each of which is expressed as a fixed compensation coefficient and a corresponding basis function [26]\nBTL = 16\n\u2211 i=1 ai\u00b5i, (2)\nwhere ai (i = 1 . . . 16) is the compensation coefficient to be estimated, and \u00b5i (i = 1 . . . 16) is the relevant basis function, \u00b51 = cos \u03b1X , \u00b52 = cos \u03b1Y, \u00b53 = cos \u03b1Z, \u00b54 = Bg cos \u03b1X cos \u03b1X , \u00b55 = Bg cos \u03b1X cos \u03b1Y, \u00b56 = Bg cos \u03b1X cos \u03b1Z, \u00b57 = Bg cos \u03b1Y cos \u03b1Y, \u00b58 = Bg cos \u03b1Y cos \u03b1Z, \u00b59 = Bg cos \u03b1X(cos \u03b1X) \u2032 , \u00b510 = Bg cos \u03b1X(cos \u03b1Y) \u2032 , \u00b511 = Bg cos \u03b1X(cos \u03b1Z) \u2032 , \u00b512 = Bg cos \u03b1Y(cos \u03b1X) \u2032 , \u00b513 = Bg cos \u03b1Y(cos \u03b1Y) \u2032 , \u00b514 = Bg cos \u03b1Y(cos \u03b1Z) \u2032 , \u00b515 = Bg cos \u03b1Z(cos \u03b1X) \u2032 , \u00b516 = Bg cos \u03b1Z(cos \u03b1Y) \u2032 , where Bg =\n\u2223\u2223Bg\u2223\u2223, cos \u03b1X, cos \u03b1Y and cos \u03b1Z denote the cosine value of \u03b1X , \u03b1Y and \u03b1Z, respectively. In addition, they also represent the direction cosine of Bg in the coordinate system. (cos \u03b1X) \u2032 , (cos \u03b1Y) \u2032 and (cos \u03b1Z) \u2032 are the time derivatives of cos \u03b1X , cos \u03b1Y and cos \u03b1Z, respectively, which are defined as\n(cos M) \u2032 = d cos M(t) dt , (3)\nwhere M represents \u03b1X , \u03b1Y, or \u03b1Z, and varies with time. The traditional aeromagnetic compensation methods do not consider the effect of the geomagnetic gradient interference and assume that the geomagnetic field is a constant. However, in practice, a large geomagnetic gradient interference will be introduced due to the non-stationary motion of the platform, which seriously affects the solution of the compensation coefficient and decreases the quality of aeromagnetic detection data. In Ref. [27], to suppress the geomagnetic gradient interference, the authors used the position information (i.e., longitude, latitude, and altitude) of the airborne platform to build a first\u2013order Taylor polynomial compensation model and added it to the T\u2013L compensation model to form the TLG model, which can be expressed as\nBTLG = BTL + BG = 16\n\u2211 i=1\nai\u00b5i + 3\n\u2211 j=1 bjgj, (4)\nwhere bj (j = 1, 2, 3) is the coefficient to be estimated, and gj (j = 1, 2, 3) is the location information of the platform, representing longitude, latitude, and altitude, respectively.\n2.2. Compensation Model for the Magnetic Interference Generated by the Electric Current 2.2.1. Analysis\nThe electric current in electronic systems on the motion platform will generate a magnetic interference field, and the magnetic field is related to the magnitude and direction of the electric current. In aeromagnetic detection, the detection target is usually in a very low frequency band (<1 Hz), so this paper only cares about the magnetic field in the low frequency band. The frequency range of ECMI we concern is lower than 0.1 Hz, and it can be thought be generated by quasi\u2013static current. Thus, the magnetic field generated by quasi-static electric current in on-board electronic systems can be estimated by using the Biot\u2013Savart law, which is usually used to calculate the static magnetic field. Considering that the aircraft platform requires high security, the cables inside it need to be strictly routed and \u201cnode\u2013type\u201d fixed. The position of the cable is therefore fixed throughout the entire flight. The magnetic interference generated by the cable will attenuate in a cubic form with the distance from the observation, so the magnetic interference field caused by some cables that are far away from the magnetometer is negligible, and the cable that is closer to the magnetometer is called as the effective interference segment. Let a and b be the start and end points of the effective interference segment, respectively. Therefore, we make equivalent the effective interference segment from a to b as a finite\nlength current\u2013carrying wire. In addition, the magnetic interference generated by it can be regarded as the superposition of the magnetic interference generated by many different pieces of current element Idl in a to b. According to the Biot\u2014Savart law [28], the vector ECMI in the place where the scalar magnetometer is installed can be expressed as\nBId(rs, t) = \u2212 \u00b50 4\u03c0 \u222b b a Rs R3s \u00d7 I(t)dl, (5)\nwhere Rs = rs \u2212 r, Rs = |Rs|, in which rs is the vector position of scalar magnetometer, r is the vector position of the current element and \u00b50 is the vacuum permeability. Let C = \u2212\u00b50/(4\u03c0) and Ks = \u222b b a Rs/R 3 s \u00d7 dl = (ks1, ks2, ks3), so BId can be shortly written as\nBId = CIKs. (6)\nFrom Equation (2), Bg/ \u2223\u2223Bg\u2223\u2223 = (\u00b51, \u00b52, \u00b53). Thus, the scalar magnetic field BId is the\nprojection of the vector expression onto the direction of the geomagnetic field, which can be expressed as\nBId = BId \u00b7 Bg\u2223\u2223Bg\u2223\u2223 = CI(ks1\u00b51 + ks2\u00b52 + ks3\u00b53). (7)\nIn the aeromagnetic detection, the vector magnetometer is installed in the place closer to the fuselage and can also obtain the ECMI signal at the same time. Thus, the vector ECMI measured by the onboard fluxgate vector magnetometer can be written as\nBCv = CIKv, (8)\nwhere Kv = \u222b b a Rv/R 3 v \u00d7 dl = (kv1, kv2, kv3), in which Rv = rv \u2212 r and rv is the vector position of fluxgate magnetometer. Thus, the STMF measured by the onboard fluxgate vector magnetometer can be expressed as\nBCv = CI \u221a k2v1 + k 2 v2 + k 2 v3. (9)\nTake the above formula into Equation (7), and the scalar magnetic field caused by the electric current can be rewritten as\nBId = BCv\u221a\nk2v1 + k 2 v2 + k 2 v3\n(ks1\u00b51 + ks2\u00b52 + ks3\u00b53). (10)\nBecause the positions of the scalar magnetometer and the fluxgate vector magnetometer are fixed, the distance between the magnetometers and the current element remains constant throughout the whole flight. Thus, Equation (10) can be written as\nBId = BCv(p1\u00b51 + p2\u00b52 + p3\u00b53), (11)\nwhere p1, p2, and p3 are the three constant coefficients. As can be seen from the above formula, BId can be linearly represented by BCv. However, the vector fluxgate magnetometer is also affected by platform maneuver magnetic interference and geomagnetic gradient interference while obtaining BCv. Thus, the processing methods need to be introduced to suppress those magnetic interference to obtain relatively accurate ECMI. Then, we use an extraction method to obtain the characteristic signal hc from the compensated magnetic field, which is directly proportional to the ECMI measured by the fluxgate vector magnetometer. Finally, taking hc into the Equation (11), and the BC of predicted ECMI can be expressed as\nBC = hc(q1\u00b51 + q2\u00b52 + q3\u00b53), (12)\nwhere q1, q2, and q3 are the coefficients to be estimated.\n2.2.2. Extraction Method of the Characteristic Signal of ECMI\nThe extraction method is very important when compensating the ECMI, and common extraction methods contain WT, EEMD, and SSA. Here, the three methods will be compared and the best will be chosen as the effective extraction method.\n(1) Wavelet Transform\nWT can locally analyze the data in time (space) frequency, gradually refine the signal through scale transformation and translation operation, and finally realize the time subdivision of high frequency and frequency subdivision of low frequency. Therefore, WT can effectively decompose the non-stationary signal into signals of different frequency bands, but because the wavelet basis function is not unique, the results obtained by decomposing the same signal with different wavelet basis functions will be different. Therefore, WT needs prior knowledge to determine the optimal wavelet basis. This will be adverse to the establishment of ECMI compensation model.\n(2) Ensemble Empirical Mode Decomposition\nEEMD is an improved version of EMD and can well decompose the nonlinear and non\u2013stationary signal to give a clear analysis. EMD can adaptively decompose the non\u2013 stationary original signal into intrinsic mode function (IMF) of different frequency bands, and it avoids the selection of basis functions. However, this technique suffers from mode mixing problem, i.e., a component of a similar scale will reside in different IMFs. To alleviate from this problem, the EEMD technique has been proposed in [29]. It takes advantage of the uniform distribution of the power spectral density of Gaussian white noise, and adds the Gaussian white noise into the signal to be decomposed. EEMD ameliorates the problem of mode aliasing existing in EMD to some extent, but does not improve the problem of the edge effect and brings in some noise into each component after decomposition, so that the decomposition result will produce a certain degree of distortion [24]. These factors are not conducive to the extraction of ECMI.\n(3) Singular Spectrum Analysis\nSSA is a new decomposing method used to deal with nonlinear and non-stationary time series. The SSA algorithm first builds a trajectory matrix through a sliding window, and then uses singular value decomposition to decompose the trajectory matrix into the form of singular values and eigenvectors, and then classifies the singular values according to the amplitude of the value. Finally, it uses the classified singular values and corresponding vectors to reconstruct the data and then effectively decomposes the original single-channel sequence data into independent components such as slow variation trend, oscillation, and noise [25]. SSA can not only avoid the selection of basis functions, but also avoid the pollution of white noise to the signal and edge effect. Compared with the other two decomposition methods, this method is more conducive to extracting the ECMI. Therefore, we will use SSA to extract hc from the compensated STMF Bre\u2212 f lux measured by the fluxgate vector magnetometer, and its process is described below. Step 1. Let N be the length of sequence Bre\u2212 f lux, select the appropriate window length L (L < N/2), and set K = N \u2212 L + 1. Arrange Bre\u2212 f lux to obtain the trajectory matrix X, which is expressed as\nX =  x1 x2 \u00b7 \u00b7 \u00b7 xK x2 x3 \u00b7 \u00b7 \u00b7 xK+1 ... ... ...\nxL xL+1 \u00b7 \u00b7 \u00b7 xN . (13) Step 2. The covariance matrix of X is S = XXT . Obtain the eigenvalues \u03bb1, \u03bb2 . . . \u03bbL\nof S and the corresponding eigenvectors \u03b41, \u03b42 . . . \u03b4L by eigenvalue decomposition. Here, the eigenvalues are arranged in descending order. Let vm = XT\u03b4m/ \u221a \u03bbm (m = 1, 2 \u00b7 \u00b7 \u00b7 L). Then, the mth component of the trajectory matrix X can be obtained, which is expressed as\nXm = \u221a \u03bbm\u03b4mvTm = \u03b4m\u03b4 T mX. (14)\nThrough the above steps, L components can be obtained. Step 3. From the above, Xm corresponds to the eigenvalue \u03bbm. Divide the above L\ncomponents into c groups (c = 2 in this paper) using a certain method. Then, add the components in the same group to obtain a new L\u00d7 K matrix Sj (j = 1, 2). Here, we group the L components by calculating the contribution rate P of the eigenvalues. P is defined as\nP = \u2211 d i=1 \u03bbi\n\u2211Lj=1 \u03bbj \u00d7 100%, (15)\nwhere d \u2264 L. When P \u2265 85%, the first d components in the L components will be divided into the first group, and the remaining components will be divided into the second group. Step 4. The new L\u00d7 K matrix Sj can be transformed into a one-dimensional sequence[ s\u22171 , s \u2217 2 , \u00b7 \u00b7 \u00b7 , s\u2217N ] by taking the diagonal averaging method, as described below. sij is the element in the ith row and the jth column in Sj,\ns\u2217n =  1 n \u2211 n m=1 sm,n\u2212m+1 (1 \u2264 n < L) 1 L \u2211 L m=1 sm,n\u2212m+1 (L \u2264 n < K)\n1 N\u2212n+1 \u2211 N\u2212K+1 m=n\u2212K+1 sm,n\u2212m+1 (K \u2264 n < N)\n, (16)\nwhere n = 1, 2 \u00b7 \u00b7 \u00b7N. Finally, hc is obtained by distinguishing the magnitude of the decomposed signals."
        },
        {
            "heading": "2.3. Modified Compensation Model for Geomagnetic Gradient Interference",
            "text": "The geomagnetic gradient interference compensation model in the TLG model cannot fully describe the complex geomagnetic gradient interference due to its low-order linearity [30]. The compensation accuracy of this model is low in a large working area or an area where the geomagnetic gradient is not uniform. To solve this problem, we combine the IGRF model with the linear model to construct a novel compensation model for the geomagnetic gradient interference, which will be called the TLGI model. The expression is written as\nBTLGI = BTLG + BIGRF = 16\n\u2211 i=1\nai\u00b5i + 3\n\u2211 i=1 bigi + c f , (17)\nwhere f is the predicted geomagnetic field obtained by using the IGRF model with the position information (i.e., longitude, latitude, and altitude) of the airborne platform. c is the coefficient to be estimated."
        },
        {
            "heading": "2.4. A Novel Compensation Model",
            "text": "Combining Equations (12) and (17), a new compensation model TLGIC including the platform maneuver magnetic interference compensation model, geomagnetic gradient interference compensation model, and the ECMI compensation model can be expressed as\nBTLGIC = BTL + BG + BIGRF + BC = 16\n\u2211 i=1\nai\u00b5i + 3\n\u2211 i=1\nbigi + c f + 3\n\u2211 i=1 qihc\u00b5i. (18)\nThe above formula can be rearranged as\nBTLGIC = J \u00b7 C, (19)\nwhere J is a row vector consisting of \u00b5i, gi, f and hcui, and C is a column vector consisting of the compensation coefficients ai, bi, c, and qi. The compensation coefficients will be solved in a calibration flight where three groups of maneuver actions are executed. In the flight, the aircraft usually maneuvers at a certain frequency. A bandpass filter with a narrow bandwidth in which most of the maneuver magnetic interference and limited other\nmagnetic interference are contained will be applied to the two sides of the equations formed by the TLGIC compensation model to equalize the equations when solving the coefficients. In summary, the key steps of using the TLGIC model for aeromagnetic compensation are as follows: Step 1. The total magnetic field B f lux is synthesized by using the data collected by the fluxgate vector magnetometer, and the basic functions of TLG compensation model are constructed with the magnetic data measured by the fluxgate vector magnetometer, and the position information measured by the Beidou satellite navigation system. A Butterworth bandpass filter with a frequency band of 0.06\u223c0.6 Hz is applied to the both ends of the compensation equations, and then the RLS method is used to obtain the compensation coefficients. Finally, the residual magnetic field can be obtained by subtracting the magnetic field calculated by the compensation coefficients and basis functions from B f lux. Step 2. The SSA algorithm is applied to extract the characteristic signal of ECMI hc from the residual magnetic field in the step 1 and construct the compensation model of ECMI BC. Step 3. The TLGIC model is constructed using the TLG compensation model, the IGRF model and the compensation model BC, and then uses the same method as that in step 1 to solve the compensation coefficients C. Step 4. In the detection flight, the TLGIC compensation model and the compensation coefficients obtained in the above steps will be used to compensate the measurement magnetic data in real time."
        },
        {
            "heading": "3. Field Experiment",
            "text": "In order to verify the effectiveness of the method proposed in this paper, some field experiments with a fixed-wing unmanned aerial vehicle were carried out in the field, where the geomagnetic background field is magnetically quiet. In the experiment, to obtain the accurate compensation coefficients, let the platform perform roll, pitch, and yaw maneuvers in the directions of east, south, west, and north in a fixed period. The flying altitude is controlled to avoid magnetic interference caused by local geology. In addition, the optically pumped magnetometer with 4He atoms with accuracy <2.5 nT and the range of 20\u223c100 \u00b5T is used for measuring the scalar magnetic field, and its principle can be seen in [31]. A fluxgate vector magnetometer with accuracy <10 nT and a range of\u2212100\u223c100 \u00b5T is used to obtain the motion attitude of the platform. In addition, the Beidou satellite navigation system is used to obtain the position information of the platform in real time. Two laps of calibration flights are arranged in the experiment, in which the first lap is used to obtain the compensation coefficients, and the second lap is to verify the applicability of the compensation coefficients. The compensation results of the first lap flight data using the two compensation models TLG and TLGIC are shown in Figure 2. The grey line is the filtered original magnetic field, the red line is the filtered compensation result of the TLG model, and the blue line is the filtered compensation result of the TLGIC model. The results show that two models can both obviously compensate the maneuver magnetic interference, but the compensation effect of TLGIC model is better. Then, the coefficients of two models solved in the first lap are used for the magnetic data of the second lap to verify their universality, and the results are shown in Figure 3. We can clearly see that the compensation effect of the TLGIC model is still better than that of the TLG model.\nFigures 4 and 5 show the decomposition results of the compensated STMF that come from the fluxgate vector magnetometer in two calibration flights using WT, EEMD, and SSA algorithms. In the two figures, (a) is the compensated STMF; (b), (c), and (d) are the extraction results of SSA, WT, and EEMD algorithms, respectively. In the SSA algorithm, the window length is set to 100 considering the maximum width of the ECMI signal. As can be seen from Figures 4b and 5b, the SSA algorithm can well extract the characteristic signal of the ECMI and retain more details of the ECMI. In WT, Daubechies wavelet series is a series of compact support and orthonormal wavelet functions [32], of which the Daubechies4 (db4) wavelet is often used for characteristic signal extraction in non-stationary time series [33\u201335], so it is selected as the decomposition basis function in this paper. As well as the number of decomposition layers being set to 10, the higher-frequency noise components and low-frequency trend components are removed, and the signals of the third to eighth decomposition layers are superimposed to obtain the ECMI characteristic signal. In EEMD,\nthe signal is also decomposed into ten IMFs, and the fourth to eighth IMF components are selected to reconstruct a new signal. By comparing the three subfigures (b), (c), and (d) in Figures 4 and 5, it is obvious that SSA can more effectively decompose out the characteristic signal of the ECMI from the compensated STMF, and the extraction result contains the complete characteristic signal of the ECMI, especially in the turn. Although WT and EEMD can also extract the ECMI characteristic signal, their extraction results distort the characteristic of the ECMI to certain extent, which also explains why the compensation result of TLGIC_SSA is the best one. Here, we define the three compensation models constructed by combining three decomposing methods with the TLGIC compensation model as TLGIC_SSA, TLGIC_WT, and TLGIC_EEMD. To better show the compensation performances of the three methods, three indicators, Figure of Merit (FOM), Standard Deviation (STD) and Improvement Ratio (IR) [14,36], are used to evaluate their compensation results. The evaluation results are shown in Tables 1 and 2, fully showing that the performance of several compensation algorithms related to the TLGIC model is obviously better than that of the TLG model, and the compensation performance of the TLGIC_SSA model is the best one, which is consistent with our expected results. In the first compensation case, by comparing the compensated results of the TLGIC_SSA model with that of the TLG model, STD reduces by 36.36%, IR increases by 57.12%, and FOM reduces by 24.54%. In the second compensation case, STD reduces by 35.48%, IR increases by 54.99%, and FOM reduces by 27.10%.\nFurthermore, in order to verify the compensation effect of the proposed algorithm in actual application, this paper also uses the compensation coefficients obtained by the two models in the first-lap to compensate the data of low-altitude flight, and the results are shown in Figure 6a. The compensated total magnetic field measured by the fluxgate vector magnetometer is plotted in Figure 6b to show the appearance time of the ECMI during flight and to make an amplitude comparison between the ECMI measured by the scalar magnetometer and the fluxgate vector magnetometer. Figure 6 shows that the ECMI in the magnetic data measured by the fluxgate vector magnetometer presents \u201cgate\u201d-shaped signal and its Peak-to-Peak Value (PPV) is about 25 nT, while the PPV in the scalar magnetometer is about 0.1 nT, and it is far smaller than that in the fluxgate vector magnetometer. In addition, Table 3 shows that the PPV of the compensation result of the TLGIC_SSA model decreased by 68% compared with that of TLG compensation model, and this illustrates that the TLGIC_SSA model can better suppress the ECMI of the platform."
        },
        {
            "heading": "4. Conclusions",
            "text": "In this paper, we propose a new aeromagnetic compensation model named the TLGIC model, including an ECMI compensation model, a modified geomagnetic gradient compensation model, and a T\u2013L compensation model. In the ECMI compensation model, the relationship is first inferred between the ECMI measured by the scalar magnetometer mounted away from the fuselage and measured by a fluxgate vector magnetometer placed near the platform body, and a compensation model is constructed according to the relationship. In addition, the SSA algorithm is introduced to accurately extract the characteristic signal of ECMI from the compensated total magnetic field measured by the vector magnetometer. At the same time, considering the limitations in real applications of the first-order linear geomagnetic gradient compensation model, the IGRF model is introduced\nto combine with the first-order linear geomagnetic gradient compensation model to form a modified compensation model. Some field experiments have been arranged to verify that the new compensation model proposed in this paper has higher compensation accuracy than the traditional compensation model.\nAuthor Contributions: Conceptualization, C.Z. and C.D.; methodology, C.Z. and C.D.; software, C.Z.; validation, C.Z., C.D., X.P. and Q.H.; formal analysis, C.Z. and C.D.; investigation, C.Z. and C.D.; resources, C.D., X.P. and H.G.; data curation, C.Z. and C.D.; writing\u2014original draft preparation, C.Z.; writing\u2014review and editing, C.D., X.P., Q.H. and H.G.; visualization, C.Z. and C.D.; supervision, X.P. and H.G.; project administration, X.P. and H.G.; funding acquisition, C.D., X.P. and H.G. All authors have read and agreed to the published version of the manuscript.\nFunding: This research was funded by support from the National Natural Science Foundation of China (NSFC) (Grant Nos. 61571018, 62101010) and the National Key Research and Development Program of China.\nInstitutional Review Board Statement: Not applicable.\nInformed Consent Statement: Not applicable.\nData Availability Statement: The data that support the findings of this study are available from the corresponding author, upon reasonable request.\nConflicts of Interest: The authors declare no conflict of interest."
        }
    ],
    "title": "An Aeromagnetic Compensation Method for Suppressing the Magnetic Interference Generated by Electric Current with Vector Magnetometer",
    "year": 2022
}