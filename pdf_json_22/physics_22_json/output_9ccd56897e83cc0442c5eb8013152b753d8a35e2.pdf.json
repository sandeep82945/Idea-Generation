{
    "abstractText": "Research on laser-plasma interaction in the quantum-electrodynamic (QED) regime has been greatly advanced by particle-in-cell & Monte-Carlo simulations (PIC-MC). While these simulations are widely used, we find that noticeable numerical error arises due to inappropriate implementation of the quantum process accounting for hard photon emission and pair production in the PIC-MC codes. The error stems from the low resolution of the QED table used to sample photon energy, which is generated in the logarithmic scale and cannot resolve high energy photons. We propose a new sampling method via Sigmoid function that handles both the low energy and high energy end of the photon emission spectrum. It guarantees the accuracy of PIC-MC algorithms for hard photon radiation and other related processes in the strong-field QED regime.",
    "authors": [
        {
            "affiliations": [],
            "name": "Yinlong Guo"
        },
        {
            "affiliations": [],
            "name": "Xuesong Geng"
        },
        {
            "affiliations": [],
            "name": "Liangliang Ji"
        },
        {
            "affiliations": [],
            "name": "Baifei Shen"
        },
        {
            "affiliations": [],
            "name": "Ruxin Li"
        }
    ],
    "id": "SP:2879e0331fb2012e3aff9c940843a7ee51bf47e8",
    "references": [
        {
            "authors": [
                "J.W. Yoon",
                "Y.G. Kim",
                "I.W. Choi",
                "J.H. Sung",
                "H.W. Lee",
                "S.K. Lee",
                "C.H. Nam"
            ],
            "title": "Realization of Laser Intensity over 10 23 W/Cm 2",
            "venue": "Optica 8, 630 ",
            "year": 2021
        },
        {
            "authors": [
                "C.N. Danson",
                "C. Haefner",
                "J. Bromage",
                "T. Butcher",
                "J.-C.F. Chanteloup",
                "E.A. Chowdhury",
                "A. Galvanauskas",
                "L.A. Gizzi",
                "J. Hein",
                "D.I. Hillier",
                "N.W. Hopps",
                "Y. Kato",
                "E.A. Khazanov",
                "R. Kodama",
                "G. Korn",
                "R. Li",
                "Y. Li",
                "J. Limpert",
                "J. Ma",
                "C.H. Nam",
                "D. Neely",
                "D. Papadopoulos",
                "R.R. Penman",
                "L. Qian",
                "J.J. Rocca",
                "A.A. Shaykin",
                "C.W. Siders",
                "C. Spindloe",
                "S. Szatm\u00e1ri",
                "R.M.G.M. Trines",
                "J. Zhu",
                "P. Zhu",
                "J.D. Zuegel"
            ],
            "title": "Petawatt and Exawatt Class Lasers Worldwide",
            "venue": "High Power Laser Sci. Eng. 7, e54 ",
            "year": 2019
        },
        {
            "authors": [
                "Z. Zhang",
                "F. Wu",
                "J. Hu",
                "X. Yang",
                "J. Gui",
                "P. Ji",
                "X. Liu",
                "C. Wang",
                "Y. Liu",
                "X. Lu",
                "Y. Xu",
                "Y. Leng",
                "R. Li",
                "Z. Xu"
            ],
            "title": "The Laser Beamline in SULF Facility",
            "venue": "High Power Laser Sci. Eng. 8, ",
            "year": 2020
        },
        {
            "authors": [
                "T.G. Blackburn"
            ],
            "title": "Radiation Reaction in Electron\u2013Beam Interactions with High- Intensity Lasers",
            "venue": "Rev. Mod. Plasma Phys. 4, 5 ",
            "year": 2020
        },
        {
            "authors": [
                "J. Dawson"
            ],
            "title": "One-Dimensional Plasma Model",
            "venue": "Phys. Fluids 5, 445 ",
            "year": 1962
        },
        {
            "authors": [
                "C.P. Ridgers",
                "T.G. Blackburn",
                "D.D. Sorbo",
                "L.E. Bradley",
                "C. Slade-Lowther",
                "C.D. Baird",
                "S.P.D. Mangles",
                "P. McKenna",
                "M. Marklund",
                "C.D. Murphy",
                "A.G.R. Thomas"
            ],
            "title": "Signatures of Quantum Effects on Radiation Reaction in Laser\u2013Electron-Beam Collisions",
            "venue": "J. Plasma Phys. 83, ",
            "year": 2017
        },
        {
            "authors": [
                "T.G. Blackburn",
                "C.P. Ridgers",
                "J.G. Kirk",
                "A.R. Bell"
            ],
            "title": "Quantum Radiation Reaction in Laser\u2013Electron-Beam Collisions",
            "venue": "Phys. Rev. Lett. 112, 015001 ",
            "year": 2014
        },
        {
            "authors": [
                "C.N. Harvey",
                "A. Gonoskov",
                "A. Ilderton",
                "M. Marklund"
            ],
            "title": "Quantum Quenching of Radiation Losses in Short Laser Pulses",
            "venue": "Phys. Rev. Lett. 118, 105004 ",
            "year": 2017
        },
        {
            "authors": [
                "A. H\u00fctzen",
                "J. Thomas",
                "J. B\u00f6ker",
                "R. Engels",
                "R. Gebel",
                "A. Lehrach",
                "A. Pukhov",
                "T.P. Rakitzis",
                "D. Sofikitis",
                "M. B\u00fcscher"
            ],
            "title": "Polarized Proton Beams from Laser-Induced Plasmas",
            "venue": "High Power Laser Sci. Eng. 7, ",
            "year": 2019
        },
        {
            "authors": [
                "M. B\u00fcscher",
                "A. H\u00fctzen",
                "L. Ji",
                "A. Lehrach"
            ],
            "title": "Generation of Polarized Particle Beams at Relativistic Laser Intensities",
            "venue": "High Power Laser Sci. Eng. 8, e36 ",
            "year": 2020
        },
        {
            "authors": [
                "T.D. Arber",
                "K. Bennett",
                "C.S. Brady",
                "A. Lawrence-Douglas",
                "M.G. Ramsay",
                "N.J. Sircombe",
                "P. Gillies",
                "R.G. Evans",
                "H. Schmitz",
                "A.R. Bell",
                "C.P. Ridgers"
            ],
            "title": "Contemporary Particle-in-Cell Approach to Laser-Plasma Modelling",
            "venue": "Plasma Phys. Control. Fusion 57, 113001 ",
            "year": 2015
        },
        {
            "authors": [
                "J. Derouillat",
                "A. Beck",
                "F. P\u00e9rez",
                "T. Vinci",
                "M. Chiaramello",
                "A. Grassi",
                "M. Fl\u00e9",
                "G. Bouchard",
                "I. Plotnikov",
                "N. Aunai",
                "J. Dargent",
                "C. Riconda",
                "M. Grech"
            ],
            "title": "Smilei : A Collaborative",
            "venue": "Open-Source, Multi-Purpose Particle-in-Cell Code for Plasma Simulation, Comput. Phys. Commun. 222, 351 ",
            "year": 2018
        },
        {
            "authors": [
                "I.V. Sokolov",
                "N.M. Naumova",
                "J.A. Nees"
            ],
            "title": "Numerical Modeling of Radiation- Dominated and Quantum-Electrodynamically Strong Regimes of Laser-Plasma Interaction",
            "venue": "Phys. Plasmas 18, 093109 ",
            "year": 2011
        },
        {
            "authors": [
                "A. Gonoskov",
                "S. Bastrakov",
                "E. Efimenko",
                "A. Ilderton",
                "M. Marklund",
                "I. Meyerov",
                "A. Muraviev",
                "A. Sergeev",
                "I. Surmin",
                "E. Wallin"
            ],
            "title": "Extended Particle-in-Cell Schemes for Physics in Ultrastrong Laser Fields: Review and Developments",
            "venue": "Phys. Rev. E 92, 023305 ",
            "year": 2015
        },
        {
            "authors": [
                "N.V. Elkina",
                "A.M. Fedotov",
                "I. Yu"
            ],
            "title": "Kostyukov",
            "venue": "M. V. Legkov, N. B. Narozhny, E. N. Nerush, and H. Ruhl, QED Cascades Induced by Circularly Polarized Laser Fields, Phys. Rev. Spec. Top. - Accel. Beams 14, 054401 ",
            "year": 2011
        },
        {
            "authors": [
                "A. Pukhov"
            ],
            "title": "Three-Dimensional Electromagnetic Relativistic Particle-in-Cell Code VLPL (Virtual Laser Plasma Lab)",
            "venue": "J. Plasma Phys. 61, 425 ",
            "year": 1999
        },
        {
            "authors": [
                "C.P. Ridgers",
                "J.G. Kirk",
                "R. Duclous",
                "T.G. Blackburn",
                "C.S. Brady",
                "K. Bennett",
                "T.D. Arber",
                "A.R. Bell"
            ],
            "title": "Modelling Gamma-Ray Photon Emission and Pair Production in High- Intensity Laser\u2013Matter Interactions",
            "venue": "J. Comput. Phys. 260, 273 ",
            "year": 2014
        },
        {
            "authors": [
                "M. Lobet"
            ],
            "title": "E",
            "venue": "d\u2019Humi\u00e8res, M. Grech, C. Ruyer, X. Davoine, and L. Gremillet, Modeling of Radiative and Quantum Electrodynamics Effects in PIC Simulations of Ultra- Relativistic Laser-Plasma Interaction, J. Phys. Conf. Ser. 688, 012058 ",
            "year": 2016
        },
        {
            "authors": [
                "R. Duclous",
                "J.G. Kirk",
                "A.R. Bell"
            ],
            "title": "Monte Carlo Calculations of Pair Production in High-Intensity Laser\u2013Plasma Interactions",
            "venue": "Plasma Phys. Control. Fusion 53, 015009 ",
            "year": 2011
        },
        {
            "authors": [
                "J. Schwinger"
            ],
            "title": "On Gauge Invariance and Vacuum Polarization",
            "venue": "Phys. Rev. 82, 664 ",
            "year": 1951
        },
        {
            "authors": [
                "V.I. Ritus"
            ],
            "title": "Quantum Effects of the Interaction of Elementary Particles with an Intense Electromagnetic Field",
            "venue": "J. Sov. Laser Res. 6, 497 ",
            "year": 1985
        },
        {
            "authors": [
                "A.D. Piazza"
            ],
            "title": "Extremely High-Intensity Laser Interactions with Fundamental Quantum Systems",
            "venue": "Rev Mod Phys 84, 52 ",
            "year": 2012
        },
        {
            "authors": [
                "A.G.R. Thomas",
                "C.P. Ridgers",
                "S.S. Bulanov",
                "B.J. Griffin",
                "S.P.D. Mangles"
            ],
            "title": "Strong Radiation-Damping Effects in a Gamma-Ray Source Generated by the Interaction of a High-Intensity Laser with a Wakefield-Accelerated Electron Beam",
            "venue": "Phys. Rev. X 2, 041004 ",
            "year": 2012
        },
        {
            "authors": [
                "C.N. Harvey",
                "A. Ilderton",
                "B. King"
            ],
            "title": "Testing Numerical Implementations of Strong-Field Electrodynamics",
            "venue": "Phys. Rev. A 91, 013822 ",
            "year": 2015
        },
        {
            "authors": [
                "T.G. Blackburn",
                "D. Seipt",
                "S.S. Bulanov",
                "M. Marklund"
            ],
            "title": "Benchmarking Semiclassical Approaches to Strong-Field QED: Nonlinear Compton Scattering in Intense Laser Pulses",
            "venue": "Phys. Plasmas 25, 083108 ",
            "year": 2018
        },
        {
            "authors": [
                "J. Esberg",
                "U.I. Uggerh\u00f8j"
            ],
            "title": "Does Experiment Show That Beamstrahlung Theory - Strong FIeld QED - Can Be Trusted",
            "venue": "J. Phys. 16 ",
            "year": 2009
        },
        {
            "authors": [
                "L.L. Ji",
                "J. Snyder",
                "B.F. Shen"
            ],
            "title": "Single-Pulse Laser-Electron Collision within a Micro-Channel Plasma Target",
            "venue": "Plasma Phys. Control. Fusion 61, 065019 ",
            "year": 2019
        },
        {
            "authors": [
                "T.G. Blackburn",
                "A. Ilderton",
                "M. Marklund",
                "C.P. Ridgers"
            ],
            "title": "Reaching Supercritical Field Strengths with Intense Lasers",
            "venue": "New J. Phys. 21, 053040 ",
            "year": 2019
        },
        {
            "authors": [
                "T.G. Blackburn",
                "A.J. MacLeod",
                "B. King"
            ],
            "title": "From Local to Nonlocal: Higher Fidelity Simulations of Photon Emission in Intense Laser Pulses",
            "venue": "New J. Phys. 23, 085008 ",
            "year": 2021
        },
        {
            "authors": [
                "A. Di Piazza",
                "M. Tamburini",
                "S. Meuren",
                "C.H. Keitel"
            ],
            "title": "Implementing Nonlinear Compton Scattering beyond the Local-Constant-Field Approximation",
            "venue": "Phys. Rev. A 98, 012134 ",
            "year": 2018
        },
        {
            "authors": [
                "A. Di Piazza",
                "M. Tamburini",
                "S. Meuren",
                "C.H. Keitel"
            ],
            "title": "Improved Local-Constant- Field Approximation for Strong-Field QED Codes",
            "venue": "Phys. Rev. A 99, 022125 ",
            "year": 2019
        },
        {
            "authors": [
                "A. Ilderton",
                "B. King",
                "D. Seipt"
            ],
            "title": "Extended Locally Constant Field Approximation for Nonlinear Compton Scattering",
            "venue": "Phys. Rev. A 99, 042121 ",
            "year": 2019
        },
        {
            "authors": [
                "T. Heinzl",
                "B. King",
                "A.J. MacLeod"
            ],
            "title": "Locally Monochromatic Approximation to QED in Intense Laser Fields",
            "venue": "Phys. Rev. A 102, 063110 ",
            "year": 2020
        }
    ],
    "sections": [
        {
            "text": "Research on laser-plasma interaction in the quantum-electrodynamic (QED) regime has been\ngreatly advanced by particle-in-cell & Monte-Carlo simulations (PIC-MC). While these simulations\nare widely used, we find that noticeable numerical error arises due to inappropriate implementation\nof the quantum process accounting for hard photon emission and pair production in the PIC-MC\ncodes. The error stems from the low resolution of the QED table used to sample photon energy,\nwhich is generated in the logarithmic scale and cannot resolve high energy photons. We propose a\nnew sampling method via Sigmoid function that handles both the low energy and high energy end\nof the photon emission spectrum. It guarantees the accuracy of PIC-MC algorithms for hard photon\nradiation and other related processes in the strong-field QED regime.\nKeywords: Particle-in-cell and Monte-Carlo simulation, Laser-plasma interaction, Strong-field Quantum electrodynamics\n* xsgeng@siom.ac.cn \u2020 jill@siom.ac.cn \u2021 ruxinli@mail.siom.ac.cn"
        },
        {
            "heading": "1. Introduction",
            "text": "The 10-100 PW laser facilities around the world are committed to provide laser pulses of intensity approaching 1023W/cm2 [1\u20133]. Under such condition laser-matter interaction exhibits new features,\nsuch as emission of high energy gamma photons and production of electron-positron pairs. These\nimportant processes can be described by the strong-field quantum electro-dynamics (SF-QED)\ntheory [4]. Due to the high nonlinearity in relativistic laser-plasma and SF-QED regime, it is\nunlikely to obtain accurate analytical solutions for the interactions. Therefore, computational\nmethods based on the particle-in-cell (PIC) algorithm [5] and Monte-Carlo (MC) sampling have\nbeen developed to simulate light-matter interactions in this regime [6\u201310].\nIn open-sourced codes like EPOCH and SMILEI [11,12], the hard photon emission and pair\nproduction are implemented into regular PIC loop via the MC approach [13\u201316] to capture the\nprobabilistic and stochastic QED effects [14,17\u201319]. To optimize the computation efficiency, a pre-\ncalculated table is set from the SF-QED theory [20], according to which stochastic QED events are\ntriggered after MC sampling and fine interpolation. Here we use the code SMILEI to simulate the\ncollision between an ultrashort high intensity laser pulse and an ultra-relativistic electron bunch. We\nfind unusual stair-like structure in the high energy end of the photon spectra in moderate QED\nregime. We point out that the occurrence of the structure originates from insufficient/ inappropriate\nQED table sampling. This leads to significant overestimation of photon emission near the spectrum\ncut-off. The error becomes more apparent for larger QED parameters, e.g., higher electron energy,\nstronger laser fields and/or shorter pulse duration. The disparity can be slightly mitigated by using\nlarge table size for larger QED parameters, which, however, cannot solve the problem once and for\nall. In this work, we propose a new sampling algorithm that can well handle the sampling of the\nphoton emission spectrum in both the low-energy end and the high-energy end at reasonable table\nsize. The new method safely extends the application of QED-MC algorithm to larger QED\nparameters and more extreme situations.\n2. Method\n2.1 Theoretical basis\nThe regular loop of PIC algorithm is modified to account for nonlinear Compton scattering and\nnonlinear Breit-Wheeler pair production [11,12]. In laser-plasma interactions, charged particles follow the Lorentz equation \ud835\udc51\ud835\udc5d\n\ud835\udc51\ud835\udc61 = \ud835\udc52(\ud835\udc6c + \ud835\udc97 \u00d7 \ud835\udc69) when no QED processes are triggered. Here \ud835\udc91 =\n\ud835\udefe\ud835\udc5a\ud835\udc52\ud835\udc97 is the particle momentum, with \ud835\udc5a\ud835\udc52 the particle rest mass, \ud835\udc52 the particle charge, \ud835\udc6c and \ud835\udc69 the electric and magnetic field, respectively. Electrons moving in laser-plasma fields radiate, which is defined by the nonlinear QED parameter \ud835\udf12\ud835\udc52~\ud835\udefe |\ud835\udc6c|\n\ud835\udc6c\ud835\udc84\ud835\udc93 , where \ud835\udefe is the electron relativistic factor and\n\ud835\udc6c\ud835\udc50\ud835\udc5f = (\ud835\udc5a\ud835\udc52\n2\ud835\udc503)\n\u210f\ud835\udc52 \u2248 1.3 \u00d7 1016 V/cm the Sauter-Schwinger critical field [21]. The quantum effect and\nstrong radiation-reaction becomes active when \ud835\udf12\ud835\udc52 approaches unity at large normalized laser amplitude \ud835\udc4e0 = \ud835\udc52\ud835\udc6c\n\ud835\udc5a\ud835\udc52\ud835\udf140\ud835\udc50 \u226b 1 (\ud835\udf140 is the laser angular frequency) since \ud835\udf12\ud835\udc52 controls the strength of\nnonlinear quantum effects [22\u201324].\nConsidering ultra-relativistic electrons, the emitted photons gather in a radiation cone \ud835\udefa~ 1\n\ud835\udefe \u226a 1,\nalmost parallel to the electron momentum. For strong laser field (\ud835\udc4e0 \u226b 1) the coherence length is ~ \ud835\udf06\n\ud835\udc4e0 \u226a 1 , i.e., the scale of the electromagnetic field variation is quite large as compared to the radiation formation length, allowing one to employ locally-constant cross-field approximation (LCFA) [25] at field strengths much smaller than the Schwinger limit \ud835\udc38\n\ud835\udc38\ud835\udc84\ud835\udc93 \u226a 1, which is proved to\nbe numerically valid when fields are sufficiently strong [26,27]. Under these assumptions, the\npoint-like QED processes take place on the classical trajectory. The Lorentz invariant rate of\ninstantaneous photon emission of an electron is [18,22] :\n\ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe =\n2 3\n\ud835\udefc2 \ud835\udf0f\ud835\udc52 \ud835\udc3a(\ud835\udf12\ud835\udc52,\ud835\udf12\ud835\udefe) \ud835\udf12\ud835\udefe , (1)\nwhere \ud835\udefc \u2248 1/137 is the fine structure constant, \ud835\udf0f\ud835\udc52 = \ud835\udc5f\ud835\udc52\n\ud835\udc50 =\n\ud835\udc522\n4\ud835\udf0b\ud835\udf160\ud835\udc5a\ud835\udc52\ud835\udc50 3 the time for light to cross the\nclassical radius of the electron, \ud835\udc3a(\ud835\udf12\ud835\udc52 , \ud835\udf12\ud835\udefe) = \u221a3\n2\ud835\udf0b\n\ud835\udf12\ud835\udefe \ud835\udf12\ud835\udc52 [\u222b \ud835\udc3e5\n3\n(\ud835\udc66)\ud835\udc51\ud835\udc66 + 3\n2 \ud835\udf12\ud835\udefe\ud835\udf08\ud835\udc3e2\n3\n(\ud835\udf08) +\u221e\n\ud835\udf08 ], \ud835\udc3e1\n3 (\ud835\udc66), \ud835\udc3e2 3 (\ud835\udf08) are\nmodified Bessel functions and \ud835\udf08 = 2\ud835\udf12\ud835\udefe\n3\ud835\udf12\ud835\udc52(\ud835\udf12\ud835\udc52\u2212\ud835\udf12\ud835\udefe) , \ud835\udc66 =\n\ud835\udf12\ud835\udefe\n3\ud835\udf12\ud835\udc52(\ud835\udf12\ud835\udc52\u2212\ud835\udf12\ud835\udefe) , respectively. The Lorentz-invariant\nquantum parameter is composed of the electron four-momentum \ud835\udc5d\ud835\udf08 ( a photon with four-momentum \u210f\ud835\udc58\ud835\udf08) and field tensor \ud835\udc39 \ud835\udf07\ud835\udf08 [4,22,23]:\n\ud835\udf12\ud835\udc52 = | \ud835\udc39\ud835\udf07\ud835\udf08\n\ud835\udc38\ud835\udc60\n\ud835\udc5d\ud835\udf08\n\ud835\udc5a\ud835\udc52\ud835\udc50 | , and \ud835\udf12\ud835\udefe = |\n\ud835\udc39\ud835\udf07\ud835\udf08\n\ud835\udc38\ud835\udc60\n\u210f\ud835\udc58\ud835\udf08 \ud835\udc5a\ud835\udc52\ud835\udc50 |. (2)\nThe parameter \ud835\udf12\ud835\udc52 decides the character of photon emission: for classical radiation \ud835\udf12\ud835\udc52 \u226a 1, there can be large numbers of photons and each one contains very small portion of energy of the emitting\nelectron. In consequence, the radiation reaction could be modelled classically as a continuously damping force. In moderate quantum region \ud835\udf12\ud835\udc52~1, during each emission the photon may take a very large part of the electron energy thus hard photons are emitted discreetly and stochastic\nquantum effects arise [18,23].\nHigh energy photons can further decay into \ud835\udc52+\ud835\udc52\u2212 pairs in strong fields, known as the nonlinear Breit-Wheeler process, dominated by the parameter \ud835\udf12\ud835\udefe . Similarly, the Lorentz invariant rate of photon decaying into \ud835\udc52+\ud835\udc52\u2212 pairs is [18,22]:\n\ud835\udc512\ud835\udc41\u00b1\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\u2212 =\n1\n\u221a3\ud835\udf0b\n\ud835\udefc\ud835\udc5a\ud835\udc52\ud835\udc50 2\ud835\udf12\ud835\udc52\n\u210f\ud835\udf12\ud835\udefe 2 \u222b \u221a\ud835\udc66\ud835\udc3e1\n3\n( 2\n3 \ud835\udc66\n3 2) \ud835\udc51\ud835\udc66 \u2212 (2 \u2212 \ud835\udf12\ud835\udefe\ud835\udc65 3\n2)\ud835\udc3e2 3\n( 2\n3 \ud835\udc65\n3\n2) +\u221e\n\ud835\udf08 , (3)\nwhere \ud835\udf12\u2212 is quantum parameter of the newborn electron, and \ud835\udc65 = ( \ud835\udf12\ud835\udefe\n\ud835\udf12\ud835\udc52 + \ud835\udf12\u2212)\n2 3 .\n2.2 Implementation of QED modules in PIC\nThe numerical models of QED in PIC vary in different codes. But they share a common idea of\nimplementation [11,12,14\u201316,19]. We introduce the MC realization of photon emission and pair\nproduction in SMILEI [12] based on the theoretical approach introduced above. For photon emission, every propagating electron in the laser field is assigned with an optical depth \ud835\udf0f\ud835\udc52 with initial \ud835\udf0f\ud835\udc520 = 0. Its time evolution follows [12,18]:\n\ud835\udc51\ud835\udf0f\ud835\udc52\n\ud835\udc51\ud835\udc61 = \u222b\n\ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe \ud835\udc51\ud835\udf12\ud835\udefe \ud835\udf12\ud835\udc52 0 . (4)\nWhen the optical depth \ud835\udf0f\ud835\udc52 reaches (larger than) the optical depth \ud835\udf0f\ud835\udc53, a photon is emitted along the direction of electron motion. Since the photon radiation event is similar to the particle decay, which follows Poisson distribution \ud835\udc52\u2212\ud835\udf06 , the optical depth \ud835\udf0f\ud835\udc53 can therefore be randomly sampled determined by \ud835\udf0f\ud835\udc53 = \u2212 ln(\ud835\udf09) where \ud835\udf09 \u2208 (0,1) is a uniform random number.\nOnce the photon radiation is triggered by reaching \ud835\udf0f\ud835\udc53, the photon energy is randomly chosen from\nthe radiation spectrum \ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe , as shown in Fig. 1(a). Here the radiation spectrum becomes the\nprobability density function (PDF) of the energy that defines the weight of different photon energies\nwhen randomly choosing a photon energy. Therefore, by integrating the PDF along the photon\nenergy axis one gets the sampling function [12,18]:\n\ud835\udc43\ud835\udf12\ud835\udc52(\ud835\udf12\ud835\udefe) = \u222b\n\ud835\udc512\ud835\udc41\ud835\udefe \ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe \ud835\udc51\ud835\udf12\ud835\udefe \ud835\udf12\ud835\udefe 0\n\u222b \ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe \ud835\udc51\ud835\udf12\ud835\udefe\n\ud835\udf12\ud835\udc52 0\n(5)\nthat stacks the weights of different energies, where the denominator scales the function to (0, 1), as shown in Fig. 1(b). Then uniform random sampling of \ud835\udc43\ud835\udf12\ud835\udc52(\ud835\udf12\ud835\udefe) can generate photon energies of which the distribution is identical to the PDF. This process requires calculating the inverse function of \ud835\udc43\ud835\udf12\ud835\udc52(\ud835\udf12\ud835\udefe) and the photon energy can then be calculated by:\n\u03c7\u03b3 = \ud835\udc43\ud835\udf12\ud835\udc52 \u22121(\ud835\udf09\u2032) (6)\nwhere \ud835\udf09\u2032 \u2208 (0,1) is another random number, as shown by the arrows in Fig. 1(b). For example, when \ud835\udf09\u2032 = 0.97 and \ud835\udf12\ud835\udc52 = 1 , it reads \ud835\udeff \u2248 0.58 , as shown by the arrows in Fig. 1(b). Once \u03c7\u03b3 is determined, the photon energy is \ud835\udf16\ud835\udefe = \ud835\udefe\ud835\udc52\ud835\udc5a\ud835\udc52\ud835\udc50 2 \ud835\udf12\ud835\udefe\n\ud835\udf12\ud835\udc52 . Through momentum conservation, i.e., \ud835\udc5d\ud835\udc52\nf =\n(\ud835\udc5d\ud835\udc52 i \u2212\n\ud835\udf16\ud835\udefe \ud835\udc50 ) = (1 \u2212 \ud835\udeff)\ud835\udc5d\ud835\udc52 i , discrete and stochastic photon emission and radiation reaction are\nnumerically implemented. We should note that the \ud835\udf12\ud835\udefe axis is normalized to \ud835\udeff = \ud835\udf12\ud835\udefe\n\ud835\udf12\ud835\udc52 \u2208 (0,1) in the\ncalculations.\nUsing the above sampling method, we generate 106 photons from 106 random numbers \ud835\udf09\u2032 at\nspecific \ud835\udf12\ud835\udc52s, and their spectrums are in well agreement with the analytical spectrum \ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe for \ud835\udf12\ud835\udc52 =\n0.01,1,10, as shown in Fig. 1(a). For computational accuracy, the evaluation of \ud835\udc43\ud835\udf12\ud835\udc52 \u22121 uses a look-up table of size \ud835\udc41 = 1024 (see Section 2.3 for explanation).\nAs for BW pair production, the MC scheme follows a similar way, with the rate defined by Eq. (3). Note that only photons with energy higher than 2\ud835\udc5a\ud835\udc52\ud835\udc50 2 are involved in pair production, accounting for the rest mass of the generated pair.\n2.3 Tabulation and interpolation of the QED emission probability\nThe QED process in PIC implementation is computationally expensive as compared to the PIC\nloop due to the complexity of the integral functions. To improve the simulation efficiency of the\nQED process, the integrals are approximated by interpolation from pre-calculated tables sampled at pre-defined values, e.g., \ud835\udf12\ud835\udc52 and photon energies. This technique is widely accepted by PIC simulation codes [11,12].\nFor computation of the optical depth \ud835\udf0f\ud835\udc52 , tabulation of Eq. (4) at different \ud835\udf12\ud835\udc52 is required. To determine the generated photon energy, Eq. (5) is further tabulated for different \ud835\udf12\ud835\udc52 and \ud835\udf12\ud835\udefe. In both equations, \ud835\udf12\ud835\udc52 is usually discretized in logarithmic scale in order to cover a wide range of interaction, e.g., \ud835\udf12\ud835\udc52 \u2208 (10 \u22124, 103). Then Eq. (4) is integrated along \ud835\udf12\ud835\udefe and tabulated with chosen \ud835\udf12\ud835\udc52 values. In Eq. (5) the photon energy parameter \ud835\udf12\ud835\udefe \u2208 (0, \ud835\udf12\ud835\udc52) is also discretized in logarithmic scale in general cases for fine sampling of the low energy photons since the radiation probability of high energy photons (\ud835\udf12\ud835\udefe \u2248 \ud835\udf12\ud835\udc52) is low.\nAt each time step, log10(\ud835\udf12\ud835\udc52) is calculated to determine the location for interpolation in the table\nof Eq. (4). Then \ud835\udc51\ud835\udf0f\ud835\udc52\n\ud835\udc51\ud835\udc61 is interpolated from the data near log10(\ud835\udf12\ud835\udc52), e.g., (\n\ud835\udc51\ud835\udf0f\ud835\udc52\n\ud835\udc51\ud835\udc61 )\n(\ud835\udc5a) and ( \ud835\udc51\ud835\udf0f\ud835\udc52\n\ud835\udc51\ud835\udc61 )\n(\ud835\udc5a+1) .\nLinear interpolation is widely adopted in this case such that \ud835\udc51\ud835\udf0f\ud835\udc52\n\ud835\udc51\ud835\udc61 is determined by\n\ud835\udc51\ud835\udf0f\ud835\udc52\n\ud835\udc51\ud835\udc61 =\n( \ud835\udc51\ud835\udf0f\ud835\udc52 \ud835\udc51\ud835\udc61\n) (\ud835\udc5a+1)\n\u2212( \ud835\udc51\ud835\udf0f\ud835\udc52 \ud835\udc51\ud835\udc61\n) (\ud835\udc5a)\n\ud835\udf12\ud835\udc52 (\ud835\udc5a+1) \u2212\ud835\udf12\ud835\udc52 (\ud835\udc5a) \u00d7 [\ud835\udf12\ud835\udc52 \u2212 \ud835\udf12\ud835\udc52\n(\ud835\udc5a)] + ( \ud835\udc51\ud835\udf0f\ud835\udc52\n\ud835\udc51\ud835\udc61 )\n(\ud835\udc5a)\n, (7)\nwhere \ud835\udf12\ud835\udc52 (\ud835\udc5a) is logarithmically distributed. If a photon emission event is triggered, the photon energy is determined by inverse sampling of Eq. (5) from a uniformly distributed random number \ud835\udf09 \u2208 (0, 1), i.e., \ud835\udf12\ud835\udefe = \ud835\udc43\ud835\udf12\ud835\udc52 \u22121(\ud835\udf09), as shown in Fig. 1 (b). Photon energy parameter \ud835\udf12\ud835\udefe is interpolated by inversing the curve defined in the table of Eq. (5) at a given \ud835\udf12\ud835\udc52\n\ud835\udf12\ud835\udefe = \ud835\udf12\ud835\udefe\n(\ud835\udc5a+1) \u2212\ud835\udf12\ud835\udefe (\ud835\udc5a)\n\ud835\udc43\ud835\udf12\ud835\udc52 (\ud835\udc5a+1) \u2212\ud835\udc43\ud835\udf12\ud835\udc52 (\ud835\udc5a) \u00d7 [\ud835\udf09 \u2212 \ud835\udc43\ud835\udf12\ud835\udc52\n(\ud835\udc5a) ] + \ud835\udf12\ud835\udefe (\ud835\udc5a) . (8)\nAgain, \ud835\udf12\ud835\udefe \u2208 (0, \ud835\udf12\ud835\udc52) is also logarithmically distributed. It should be noted that the radiation probability in Eq. (1) diverges at low photon energies thus the lower limit of \ud835\udf12\ud835\udefe in the integration\nof Eq. (5) must be manually chosen [12,15].\nThe BW process shares a similar way for tabulation and random sampling defined by Eq. (3)\nand its integrals, except that the BW spectrum peaks at \ud835\udeff\u00b1 = \ud835\udf12\u00b1\n\ud835\udf12\ud835\udefe = 0.5 and is symmetric to \ud835\udeff\u00b1 =\n0.5, meaning that it only requires tabulation of \ud835\udeff\u00b1 \u2208 (0, 0.5). 3. Results\n3.1 Error in photon spectra in the QED regime\nIn our 2-dimensional simulations, the laser pulse of pulse duration \ud835\udf0f\ud835\udc3f (full width at half maximum,\nFWHM) and normalized amplitude \ud835\udc4e0 head-on collides with an electron bunch of kinetic energy \ud835\udf00\ud835\udc52 = \ud835\udefe\ud835\udc5a\ud835\udc52\ud835\udc63 2 . In other to emphasize the numerical errors of the Monte-Carlo method, monoenergetic electron bunch is utilized for demonstration. The wavelength of the laser pulse is \ud835\udf06\ud835\udc3f = 0.8 \u03bcm and the focal spot size is \ud835\udc640 = 5 \u03bcm \u2248 6.25\ud835\udf06\ud835\udc3f. This linearly polarized laser pulse takes the Gaussian profile \ud835\udc4e\ud835\udc3f = \ud835\udc4e0\ud835\udc52 \u2212 \ud835\udc612 \ud835\udf0f\ud835\udc3f\ud835\udc52 \u2212 \ud835\udc5f2 \ud835\udc640 sin(\ud835\udf140\ud835\udc61) \ud835\udc86\ud835\udc9a with \ud835\udc5f 2 = \ud835\udc662 + \ud835\udc672 ( \ud835\udc67 = 0 for 2D simulation), \ud835\udf140 = 2\ud835\udf0b\ud835\udc50\n\ud835\udf06 and enters from the left of the simulation window. The electron bunch is also Gaussian\nprofiled, \ud835\udc5b\ud835\udc52(\ud835\udc5f, \ud835\udf09 = \ud835\udc65 \u2212 \ud835\udc50\ud835\udc61) = \ud835\udc5b0\ud835\udc52\ud835\udc65\ud835\udc5d(\u2212 \ud835\udc5f2\n2\ud835\udf0e\ud835\udc5f 2 \u2212\n\ud835\udf092\n2\ud835\udf0e\ud835\udc65 2) . Here \ud835\udf0e\ud835\udc5f\n2 = 0.5 \u00d7 0.5 \u03bcm2 , \ud835\udf0e\ud835\udc65 2 = 6.25 \u00d7\n6.25 \u03bcm2 the longitudinal and transverse beam sizes and \ud835\udc5b0 = 10 \u22123\ud835\udc5b\ud835\udc50, with \ud835\udc5b\ud835\udc50 =\n\ud835\udc5a\ud835\udc52\ud835\udf14 2 4\ud835\udf0b\ud835\udc522 , where \ud835\udc52\nand \ud835\udc5a\ud835\udc52 the electron charge and mass, \ud835\udf140 the field frequency. The grid size of the simulation is\n\ud835\udf06\ud835\udc3f\n160 \u00d7\n\ud835\udf06\ud835\udc3f 40 in x- and y-direction to guarantee the accuracy of the simulation and the time step is \ud835\udc470 100\nwith \ud835\udc470 = \ud835\udf06\ud835\udc3f\n\ud835\udc50 . The length of the simulation window in x-direction ranges from 8 \u03bcm to 90 \u03bcm\ncorresponding to pulse lengths from 2.5 fs to 100 fs and the length of y-direction is 20 \u03bcm.\nThe spectra of photons and electrons after collision are summarized in Fig. 2 for \ud835\udc4e0 = 100 and \ud835\udf00\ud835\udc52 = 1000 MeV (corresponding to \ud835\udf12\ud835\udc52,\ud835\udc5a\ud835\udc4e\ud835\udc65~1). Here only the pulse duration \ud835\udf0f\ud835\udc3f changes, from subcycle (2.5 fs) to long pulses (100 fs).\nIt is shown in Fig. 2 (a) that the photon cut-off energy increases for shorter pulses and longer\npulses generate more low-energy photons. This is the stochastic nature of QED radiation: electrons\nradiate photons with certain probabilities. For shorter laser pulses, some electrons may undergo\nlimited or even no photon emission events in the rising edge of the pulse. They reserve most of the\nenergy when reaching the pulse center such that the electron QED parameter can be maximized.\nPhotons emitted here carry largest amount of electron energies. On the contrary, longer pulses have\nmore gentle pulse front, which depletes the electron energy by inducing more photon emission\nevents. Before approaching the pulse center, electrons are already cooled down and the peak QED\nparameter is lower. As verified in Fig. 2 (b), there are plenty of electrons reserve their energies for\nfew-cycle lasers but gathering in the low energy region for longer pulses.\nIt is noticed that stair-like structure appears at the high energy end of photon spectra for\nultrashort pulse duration. The featured structure emerges while stochastic quantum effects become\nimportant. However, as we will show below, such structure reflects inaccurate sampling in the\nMonte-Carlo process accounting for photon emission. This may cause huge error in the high energy\nend and incorrectly enhance the stochastic behavior at short pulse lengths [8]. 3.2 The stair structure dependence on \ud835\udc82\ud835\udfce and \ud835\udf3a\ud835\udc86\nIn the following simulations we choose three laser durations \ud835\udf0f\ud835\udc3f = 2.5 fs, 30 fs and 100 fs. First, we fix the electron energy at \ud835\udf00\ud835\udc52 = 1000 MeV and change the normalized laser amplitude from \ud835\udc4e0 = 20 to \ud835\udc4e0 = 200. Then the electron energy \ud835\udf00\ud835\udc52 varies from 100 MeV to 2000 MeV keeping the same laser amplitude \ud835\udc4e0 = 100. The corresponding peak quantum parameter is \ud835\udf12~0.1, 1 and 2. Fig. 3 shows the spectra of photons after interaction. The stair structure appears when the cut-off of photon energy ratio \ud835\udeff = \ud835\udf00\ud835\udefe/\ud835\udf000 approaches unity. This is most evident for ultrashort pulse duration, large laser amplitude and high electron energies, as seen in Fig. 3 (a) and (d). Longer pulses employed in\nFig. 3 (b) and (c) produce much smoother spectrum distributions, hence lower electron energy. Thus, the photon energy ratio \ud835\udeff~1 or QED parameter \ud835\udf12~1 is related to whether the stair structure appears\nor not.\n20 to 200 (a-c), the electron energy \ud835\udf00\ud835\udc52 varies from 100 MeV to 1000 MeV (d-f), with \ud835\udeff = \ud835\udf00\ud835\udc52,\ud835\udefe\n\ud835\udf160 .\n3.3 The stair structure with different table size\nWe illustrate the consequences of inaccurate table sampling using the following parameters: \ud835\udc4e0 = 100, \ud835\udf0f\ud835\udc3f = 5 fs, \ud835\udf00\ud835\udc52 = 3200 MeV (\ud835\udf12\ud835\udc52~3.2, moderate quantum region). The grid number of the QEDMC table can be set as 128, 256, 512 and 1024, respectively. In Fig. 4 (a) and (b) we see that in the low energy region \ud835\udeff < 0.8 all distributions are consistent. Significant divergence is seen in the\nregion beyond. For 128 points grids, there is a sharp decline around \ud835\udeff = 0.8, followed by slow and long slop extending to \ud835\udeff = 1. Here the photon number is still at an unexpected high level. The quasiplateau starts at \ud835\udeff = 0.9 for 256 grids and the photon number at maximum energy is suppressed by\nseveral times. The distribution tends to converge for 512 and 1024 points grids.\nHigher resolution apparently gives more precise results. The error caused by insufficient sampling\nresolution of the QED table overestimates the photon number emitted in the high energy end.\nAlthough these photons only cover a small region of the energy spectra, they exhibit strong signature\nof radiation-dominated QED effects, e.g., the number the low-energy electrons. As shown in Fig.\n4(b), the low-energy electrons are also overcounted by 100 times at low resolution. Besides, the\nhigh-energy photons may decay into pairs through BW process in the intense pulse, further enlarge\nthe error induced by over-estimated high-energy photons."
        },
        {
            "heading": "4. Discussion and Solution",
            "text": "4.1 Grid effect induced by logarithmic sampling\nIt has been shown in section 2.3 that the \ud835\udf12\ud835\udefe/\ud835\udf12\ud835\udc52 values are logarithmically sampled for fine sampling of the low energy photons, resulting in coarse sampling of high energy photons. Fig. 5 (ad) display the photon emission spectrum \ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe for different \ud835\udf12\ud835\udc52 and different table sizes \ud835\udc41 and one\ncan see sharp transitions of the spectrum when \ud835\udeff = \ud835\udf12\ud835\udefe\n\ud835\udf12\ud835\udc52 > 0.5, which is more significant when \ud835\udeff\napproaches unity. The grid effect can be eased by using larger table sizes but cannot be eliminated since the spacing between the gridded \ud835\udeff does not converge when \ud835\udeff \u2192 1 under logarithmic sampling.\nFor chosen parameters \ud835\udf12\ud835\udc52 = 0.01, 1, 10, the spectra are compared in Fig. 6 (a-d), which can be seen as the featured radiation spectra under these parameters [19,22]. At small \ud835\udf12\ud835\udc52 , where the radiation can be treated classically, the spectra peak at low \ud835\udeff values. A few points are enough to rebuild the distribution. When \ud835\udf12\ud835\udc52 is larger, the spectrum is significantly blue shifted and broadened. The peak even shifts towards \ud835\udeff~1 at \ud835\udf12\ud835\udc52 = 10 . In this case, the logarithmically sampled photon energies cannot resolve the spectra. The change at the high energy end is so steep that polynomial\nfitting cannot approximate the spectrum, leading to the unphysical stair structure of the energy\nspectra in QED-PIC simulation. This grid effect will imprint these errors into the integrated probability rate \u222b \ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe \ud835\udc51\ud835\udf12\ud835\udefe \ud835\udf12\ud835\udc52 0 , which modifies the random sampling of photon energies as shown\nin the results.\n[10\u22125, 1 \u2212 10\u22125].\nThe above results suggest that one must be careful when performing simulations including hard\nphoton emission and pair production based on the QED table approach. According to the QED-MC\nimplementation, it is possible to find an appropriate table size under certain conditions. For example, the maximum \ud835\udf12\ud835\udc52 in laser-electron collision with laser amplitude \ud835\udc4e0 and electron gamma factor \ud835\udefe\ud835\udc56 can be estimated by evaluating the electron energy in the laser pulse [23]:\n\ud835\udefe\ud835\udf0f = \ud835\udefe\ud835\udc56\n1+\ud835\udc53\ud835\udc4e0 2\ud835\udefe\ud835\udc56\n, (9)\nwhere \ud835\udc53 = ( 4\ud835\udc5f\ud835\udc52\n3 ) \u222b [\n\ud835\udc4e\ud835\udc66(\ud835\udc5f,\ud835\udf0f \u2032)\n\ud835\udc4e0 ]\n2\n\ud835\udc51\ud835\udf0f \ud835\udf0f\n0 is the pulse profile factor and \ud835\udf0f = \ud835\udf14(\ud835\udc61 \u2212\n\ud835\udc65 \ud835\udc50 ) the relative phase.\nWhen the electron reaches the peak of the laser pulse, the peak QED parameter can be estimated\nby [30]:\n\ud835\udf12e,max = \ud835\udc4e0\ud835\udefe\ud835\udf0f\ud835\udf14(1+\ud835\udc50\ud835\udc5c\ud835\udc60\ud835\udf03)\n\ud835\udc5a =\n2\ud835\udf14 \ud835\udc5a \ud835\udc4e0\ud835\udefe\ud835\udc56\n1+\ud835\udc53\ud835\udc4e0 2\ud835\udefe\ud835\udc56\n. (10)\nFor example, if \ud835\udf12e,max = 1, the largest photon energy to resolve is \ud835\udeffmax \u2248 0.95, as shown in Fig. 6. Supposing a table of size \ud835\udc41 is discretized in logarithmic scale in the \ud835\udeff direction, i.e., \ud835\udeff \u2208 [10\u2212\ud835\udefc, 100] and \ud835\udeff(\ud835\udc5a) = 10\u2212\ud835\udefc+\ud835\udc5a \ud835\udefc\n\ud835\udc41\u22121 . If the acceptable resolution of \ud835\udeff near \ud835\udeffmax is \ud835\udf16 = \ud835\udeff (\ud835\udc5a) \u2212\n\ud835\udeff(\ud835\udc5a\u22121) < 10\u22122 , the minimum N required is \ud835\udc41min = 1100 for \ud835\udefc = 5 , which can be varied depending on \ud835\udf16.\nAs for BW process, \ud835\udeff\u00b1 is also logarithmically discretized but in the range of [10 \u2212\ud835\udefc, 10log10 0.5]\ndue to symmetry of the electron/positron spectrum as shown in Fig. 7(a). Since the slope of the spectrum at \ud835\udeff\u00b1 = 0.5 is zero, the symmetric logarithmical discretization is sufficient to resolve the spectrum at \ud835\udeff\u00b1 = 0.5 and \ud835\udeff\u00b1 \u2248 0 at the table size of \ud835\udc41 = 128, as shown in Fig. 7(b) where 255 data points are displayed due to symmetry. It should be noted that the SMILEI code implicitly\navoided the grid effect via symmetric logarithmical discretization and will not induce significant\nnumerical error like the photon spectrums.\n4.2 Sigmoid sampling\nIncreasing the table size can ease the tabulation effects but logarithmic sampling can never mimic\nthe asymptotic behavior in both low energy and high energy ends of the spectrum. Note that even if high-order polynomial fitting is used in the interpolation, the rapid change of \ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe at strong QED\nregion \ud835\udf12\ud835\udc52 > 1 (\ud835\udeff~1) can hardly be reproduced accurately. As a result, we encounter the stair-like energy spectra with incorrect energies and amounts for hard photons.\nWe notice the asymptotic behavior of the photon emissivity for high energy and low energy photons in Fig. 5, the latter of which was solved by using logarithmic distribution of \ud835\udeff = \ud835\udf12\ud835\udefe/\ud835\udf12\ud835\udc52 which results in the problem discussed here. To resolve both the high energy and low energy ends, we propose distributing the \ud835\udeff values of the QED table via Sigmoid function:\n\u03b4 = 1\n1+exp(\u2212\ud835\udc34\ud835\udc4b) \u2208 [\ud835\udeffmin, \ud835\udeffmax ] (11)\nwhere \ud835\udc4b is a uniform sequence of length \ud835\udc41 and \ud835\udc34 is the scaling parameter controlling the bounds of \ud835\udeff. For instance, for \ud835\udc4b \u2208 [\u22121,1], Fig. 8 shows the distribution for \ud835\udc34 = 6.91,11.5,16.1 corresponding\nto \ud835\udeff \u2208 [10\u22123, 1 \u2212 10\u22123] , \ud835\udeff \u2208 [10\u22125, 1 \u2212 10\u22125] and \ud835\udeff \u2208 [10\u22127, 1 \u2212 10\u22127] , where the sequence length is restricted to \ud835\udc41 = 128. By controlling \ud835\udc34 and \ud835\udc41, one is able to control the bounds and shape of the distribution of \ud835\udeff. For results shown in Fig. 5 (e-h) and Fig. 6 (e-h), we choose A=11.5 (\ud835\udeffmin = 10\u22125 ) for comparison with logarithmic sampling of \ud835\udefc = 5 . For common cases A = 8.805 , corresponding to \ud835\udeff \u2208 [1.5 \u00d7 10\u22124, 1 \u2212 1.5 \u00d7 10\u22124], is a good choice that the variation at \ud835\udeff = 0.5\nis not too steep, which is adopted in the simulations in Fig. 9.\nUsually, the QED parameter \ud835\udf12\ud835\udc52 ranges over deep quantum region with \ud835\udf12\ud835\udc52\ud835\udc5a\ud835\udc4e\ud835\udc65 \u226b 10 1 and classical domain with \ud835\udf12\ud835\udc52\ud835\udc5a\ud835\udc56\ud835\udc5b \u2264 10 \u22123 for tabulation. Besides, the photon emission rate reaches a plateau after reaching quantum region as shown in Fig. 5 where the variation of the emission\nspectrum slows down for larger \ud835\udf12\ud835\udc52. They can both help the accuracy in moderate quantum region \ud835\udf12\ud835\udc52 \u2264 10 . For these reasons, it is credible that suitable logarithmically sampled points \ud835\udf12\ud835\udc52 \u2208 (10\u22125, 102) is enough for tabulation. One could just choose a wider range of \ud835\udf12\ud835\udc52 to recede the numerical error for more extreme condition. Finally, for the tabulation of the integral of \ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe , \ud835\udeff =\n\ud835\udf12\ud835\udefe/\ud835\udf12\ud835\udc52 is distributed via Sigmoid sampling and \ud835\udf12\ud835\udc52 is logarithmically distributed. 4.3 The comparison between two tabulation methods\nWe compare the results of the proposed method with the logarithmic one in Fig. 5 (e-f). It is clear\nthat even 128 points tabulating reproduces the characteristics of \ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe very well at the high\nnonlinear region \ud835\udeff~1, as well as the classical region \ud835\udeff \u226a 1, and better for N = 256, 512 and 1024 points. Further, the newly discrete photon emissivity \ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe at chosen sections \ud835\udf12\ud835\udc52 = 0.01, 1, 10 are\nshown in Fig. 6 (e)-(f), where the stair structure is rarely noticeable, illustrating the high accuracy\nin all cases.\nIt should be noted that, as discussed in section 4.1, when using the Sigmoid sampling the\nrequired minimum table size to resolve \ud835\udf16 = 10\u22122 near \ud835\udeff = 0.95 for \ud835\udf12\ud835\udc52 = 1 is \ud835\udc41min = 60 , much lower than that of the logarithmic sampling. With a table of fair and appropriate size it can be helpful\nfor efficient and economical computation, especially when referring to the heavy table interpolation\nprocesses in the QED-MC algorithm, since locating the random number \ud835\udf09 in the table requires searching the array of the integral of \ud835\udc512\ud835\udc41\ud835\udefe\n\ud835\udc51\ud835\udf0f\ud835\udc51\ud835\udf12\ud835\udefe for a given \ud835\udf12\ud835\udc52, the speed of which is at the order of\n\ud835\udc42(\ud835\udc41) or \ud835\udc42(log \ud835\udc41) when using bianry search.\nBy implementing the sigmoid sampling method into SMILEI, we perform simulations to compare\nthe photon spectrums in Fig. 9 where the parameter of Fig. 9(b) is identical to Fig. 4. It can be seen\nthat with Sigmoid modification one gets relatively more accurate results in the \ud835\udf12\ud835\udc52 > 1 region with table size of \ud835\udc41 = 128 when compared to the original sampling method with larger table sizes. In\nother words, by using Sigmoid like tabulation we can achieve more accurate photon emission in\nboth classical and deep QED region, which significantly improve the applicability of PIC-MC\nsimulations in the strong-field QED regime.\n4.4 Connections to other numerical problems\nThe numerical implementation of the Monte-Carlo QED process in PIC simulation has been\ndiscussed and tested in multiple research [14,17,19,26,27,31]. It is pointed out that common\nnumerical implementation fails out of the valid region of LCFA, i.e., where the harmonic structure\nof the radiation spectrum and quantum interference effect are important. Therefore, recent studies\nfocus on extending the valid region of LCFA [32\u201335]. In our work we find that insufficient sampling\nof the formulars based on LCFA leads to the numerical errors. Therefore, our work focuses on\nremoving the numerical errors of these implementations and recovering the physical process that is\nimproperly programed. On the other hand, the region where the numerical errors are significant is\nwell within the valid region of LCFA where the field strength is sufficiently high, and the harmonic\nradiation and quantum interference can be neglected.\n5. Conclusion\nIn conclusion, we have studied in detail the interaction between an ultrashort high intensity laser\npulse and an ultra-relativistic electron beam. By using PIC simulation, we find the emergence of\nstair-like structure in the high energy part of the spectra in moderate quantum region. The structure\nis more apparent for higher electron QED parameters. We find out that the structure stems from\ninaccurate photon emission due to insufficient resolution of the tables used in the QED-MC\nalgorithm. These may induce significant error for high energy photons and sequential electron-\npositron pair production. We therefore proposed a novel way using Sigmoid sampling to overcome\nthe challenge, which effectively extends the application of the QED-MC algorithm in more extreme\nsituations including high-energy photon emission, Breit-Wheeler pair-production by these photons and consequent QED cascades in the \ud835\udf12\ud835\udc52 > 1 region. Acknowledgement\nThe authors would like to thank the contributors of the PIC code SMILEI [12]. This work was\nsupported by the Strategic Priority Research Program of the Chinese Academy of Sciences (Grant\nNo. XDB 16010000) and the National Natural Science Foundation of China (Grants No. 11875307,\nNo.11935008 and No. 11804348)."
        },
        {
            "heading": "Declaration of competing interest",
            "text": "The authors declare that they have no known competing financial interests or personal\nrelationships that could have appeared to influence the work reported in this paper."
        }
    ],
    "title": "Improving the accuracy of hard photon emission by Sigmoid sampling of the QED-table in particle-in-cell-Monte-Carlo simulations",
    "year": 2022
}