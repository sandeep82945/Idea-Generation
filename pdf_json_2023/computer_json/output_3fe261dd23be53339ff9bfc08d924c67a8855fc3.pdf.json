{
    "abstractText": "We propose a hybrid feedback law inducing self-oscillating behavior in second-order resonant converters. With our controller, the converter switches at the resonant frequency of its tank, without the need of external oscillators. In addition, the output amplitude can be adjusted by a reference signal ranging from zero to \u03c0/2. The amplitude modulation is then performed while maintaining an approximately constant switching frequency. Theoretical results show uniqueness and almost global asymptotic stability of a nontrivial hybrid limit cycle. Experimental results show that a circuit implementing the new controller successfully matches the desirable simulated behavior.",
    "authors": [
        {
            "affiliations": [],
            "name": "Nicola Zaupa"
        },
        {
            "affiliations": [],
            "name": "Carlos Olalla"
        },
        {
            "affiliations": [],
            "name": "Isabelle Queinnec"
        },
        {
            "affiliations": [],
            "name": "Luis Mart\u00ednez-Salamero"
        },
        {
            "affiliations": [],
            "name": "Luis Mart\u0131\u0301nez-Salamero"
        },
        {
            "affiliations": [],
            "name": "Luca Zaccarian"
        }
    ],
    "id": "SP:d28ab8e526d0e93924d3717e28070aad08c57d86",
    "references": [
        {
            "authors": [
                "R. Erickson",
                "M. Dragan"
            ],
            "title": "Fundamentals of Power Electronics, 3rd ed",
            "year": 2020
        },
        {
            "authors": [
                "R. Oruganti",
                "F.C. Lee"
            ],
            "title": "Resonant Power Processors, Part II-Methods of Control",
            "venue": "IEEE Trans. on Industry Applications, 1985.",
            "year": 1985
        },
        {
            "authors": [
                "M. Youssef",
                "P. Jain"
            ],
            "title": "A review and performance evaluation of control techniques in resonant converters",
            "venue": "30th Annual Conference of IEEE Industrial Electronics Society, 2004. IECON 2004, 2004.",
            "year": 2004
        },
        {
            "authors": [
                "V. Vorperian"
            ],
            "title": "Approximate small-signal analysis of the series and the parallel resonant converters",
            "venue": "IEEE Tran. on Power Electronics, 1989.",
            "year": 1989
        },
        {
            "authors": [
                "Y. Yin",
                "R. Zane",
                "J. Glaser",
                "R. Erickson"
            ],
            "title": "Small-signal analysis of frequency-controlled electronic ballasts",
            "venue": "IEEE Transactions on Circuits and Systems I: Fundamental Theory and Applications, 2003.",
            "year": 2003
        },
        {
            "authors": [
                "J. Burdio",
                "F. Canales",
                "P. Barbosa",
                "F. Lee"
            ],
            "title": "Comparison study of fixed-frequency control strategies for ZVS DC/DC series resonant converters",
            "venue": "IEEE Power Electronics Specialists Conference, 2001.",
            "year": 2001
        },
        {
            "authors": [
                "M. Youssef",
                "H. Pinheiro",
                "P. Jain"
            ],
            "title": "Self-sustained phase-shift modulated resonant converters: Modeling, design, and performance",
            "venue": "IEEE Transactions on Power Electronics, 2006.",
            "year": 2006
        },
        {
            "authors": [
                "H. Pinheiro",
                "P. Jain",
                "G. Joos"
            ],
            "title": "Performance characterization of two self-oscillating controllers for parallel resonant converters operating with unity input power factor",
            "venue": "Record 28th Annual IEEE Power Electronics Specialists Conference, 1997.",
            "year": 1997
        },
        {
            "authors": [
                "R. Bonache-Samaniego",
                "C. Olalla",
                "L. Mart\u0131\u0301nez-Salamero",
                "H. Valderrama-Blavi"
            ],
            "title": "Design of self-oscillating resonant converters based on a variable structure systems approach",
            "venue": "IET Power Electronics, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "R. Bonache-Samaniego",
                "C. Olalla",
                "L. Mart\u0131\u0301nez-Salamero"
            ],
            "title": "Dynamic Modeling and Control of Self-Oscillating Parallel Resonant Converters Based on a Variable Structure Systems Approach",
            "venue": "IEEE Transactions on Power Electronics, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "N. Zaupa",
                "L. Mart\u0131\u0301nez-Salamero",
                "C. Olalla",
                "L. Zaccarian"
            ],
            "title": "Results on hybrid control of self-oscillating resonant converters",
            "venue": "IFAC Conference on Analysis and Design of Hybrid Systems, Jul. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "N. Zaupa",
                "L. Mart\u0131\u0301nez-Salamero",
                "C. Olalla",
                "L. Zaccarian"
            ],
            "title": "Hybrid control of self-oscillating resonant converters",
            "venue": "IEEE Transactions on Control Systems Technology, pp. 1\u20138, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "R. Goebel",
                "R. Sanfelice",
                "A. Teel"
            ],
            "title": "Hybrid Dynamical Systems: modeling, stability, and robustness",
            "year": 2012
        },
        {
            "authors": [
                "A. Nabae",
                "I. Takahashi",
                "H. Akagi"
            ],
            "title": "A New Neutral-Point-Clamped PWM Inverter",
            "venue": "vol. IA-17, no. 5, pp. 518\u2013523, 1981.",
            "year": 1981
        },
        {
            "authors": [
                "A. Bisoffi",
                "F. Forni",
                "M. Da Lio",
                "L. Zaccarian"
            ],
            "title": "Relay-based hybrid control of minimal-order mechanical systems with applications",
            "venue": "Automatica, vol. 97, pp. 104\u2013114, 2018. 46 48 50 52 fr eq u en cy (k H z) simulated experimental 0 1 2 (z 1 ) p ea k ! 1 0 0.5 1 1.5 ' (rad) 0 1 2 (z 2 ) p ea k Fig. 8. Simulated and experimental responses with R = 21.8 \u03a9. The black dotted line is the estimated resonant frequency f\u03020 = 45.8 kHz.",
            "year": 2018
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014 Stability of hybrid systems, Lyapunov methods, Power electronics.\nI. INTRODUCTION\nCONTROL of resonant converters is a well-known prob-lem in power electronics associated with several solutions [1]\u2013[3]. Conventional approaches include frequency modulation, where the switching frequency is the control input [4], [5], and amplitude modulation, where the control input is the phase-shift between the two legs of the switches [6], [7]. Frequency modulation may induce desirable zero voltage switching (ZVS) but the regulation of the operating point may require wide frequency ranges. Conversely, amplitude modulation desirably operates at constant switching frequency, at the expense of losing ZVS.\nThis paper adopts a state-plane hybrid control approach inducing self-oscillation of the resonant converter without the need of external inputs. State-plane based methods that turn to self-oscillating schemes have been proposed in the past, either ensuring the oscillations regardless of the load condition [7], [8], or proposing state-plane-induced input selection [9], [10]. Our approach has several advantages with respect to these previous papers. First, we relax the conservative requirement imposed by [9], [10] on the quality factor. Secondly, the proposed controller has useful links with the conventional control methods, as explained next.\nThis work was supported in part by: the Spanish Ministry of Science and Innovation under projects PID2019-111443RB-100 and PID2020120151RB-I00; the ANR via grant HANDY, number ANR-18-CE400010; and the MUR under PRIN grant DOCEAT, number 2020RTWES4. (Corresponding author: Nicola Zaupa (e-mail: nzaupa@laas.fr).)\nNicola Zaupa, Isabelle Queinnec and Luca Zaccarian are with LAASCNRS, University of Toulouse, CNRS, Toulouse, France. Luca Zaccarian is also with Universita\u0300 di Trento, 38123 Trento, Italy.\nCarlos Olalla and Luis Mart\u0131\u0301nez-Salamero are with the Departament d\u2019Enginyeria Electro\u0300nica, Ele\u0300ctrica i Automa\u0300tica, Escola Te\u0300cnica Superior d\u2019Enginyeria, Universitat Rovira i Virgili, 43007 Tarragona, Spain.\nIn our previous works [11], [12], we addressed the control of second-order parallel and series resonant converters (PRC and SRC, respectively) with the hybrid formulation of [13] in a unified way. To represent the switching input voltage vs of the resonant tank we used there a discrete variable \u03c3 \u2208 {\u22121, 1}. The hybrid control law allowed regulation of the converter by changing the operating frequency. Thus, the hybrid controller provided a self-oscillating frequency modulation behavior.\nGiven the limitations of using wide frequency ranges in resonant conversion, the objective of this paper is to propose and to validate a hybrid controller that allows modulation of the amplitude of the first harmonic of the input voltage vs. The hybrid controller produces, in a way, a self-oscillating amplitude modulation behavior. We introduce here a third value for \u03c3 \u2208 {\u22121, 0, 1} corresponding to a zero voltage input, allowing us to operate at the resonant frequency of the tank across a range of output amplitudes.\nThe fact of having a three-level input voltage is beneficial in two ways: modulation of input voltage first harmonic is possible and the harmonic content is reduced. The last point is supported by [14] since PRC and SRC are topologically similar to three-level neutral point clamped inverters (NPC) feeding a lossless LC two-port terminated at a resistive load. On the other hand, NPC requires an external sinusoidal reference tuned at the proper frequency. While, in our three-level input voltage SRC and PRC it is not required because the hybrid control induces an oscillation at the resonant frequency.\nThe paper is structured as follows. The system model and the proposed controller are discussed in Section II. Section III states and proves our main theoretical result and Section IV reports the experimental implementation and validation on a power converter prototype. Section V conclude the work.\nNotation. R (R>0) [R\u22650] and Z (Z>0) [Z\u22650] are the sets of (positive) [non-negative] real and integer numbers. Rn denotes the n-dimensional Euclidean space. Given two vectors u \u2208 Rn and w \u2208 Rm, u\u22a4 denotes the transpose of u, and (u,w) := [ u\u22a4 w\u22a4 ]\u22a4 denotes their stacking. Given a (continuous, discrete, or hybrid) signal x, x\u0307 denotes its derivative with respect to continuous time t, while x+ denotes\nits next value with respect to discrete time j."
        },
        {
            "heading": "II. SYSTEM MODEL AND PROPOSED CONTROLLER",
            "text": "We address parallel and series second-order resonant converters (PRC and SRC, respectively) as shown in Fig. 1. As in [11], [12], consider the following change of coordinates\nz1 := vC Vg \u2212 \u03c3, z2 := 1 Vg\n\u221a L\nC iC , (1)\nbased on the voltage and current on the capacitor (vC and iC) and the discrete variable \u03c3 \u2208 {\u22121, 0, 1} representing the switching input voltage vs of the resonant tank, so that vs = \u03c3Vg , where Vg is the external DC supply. Following the derivation in [11, eqs. (1) to (4)], the continuous-time dynamics of both converters is unified to\nz\u03071 = \u03c9z2, z\u03072 = \u2212\u03c9z1 \u2212 \u03b2z2, (2) where \u03c9 := (\u221a LC )\u22121\nis the natural frequency and \u03b2 > 0 is the inverse of the time constant of the exponential decay associated with each resonant tank of Fig. 1:\n\u03b2PRC := 1\nRC , \u03b2SRC :=\nR L . (3)\nThis novel approach to control (1) includes the possibility to apply a zero voltage input \u03c3 = 0. While this extra value does not change coordinates (1) nor their continuous dynamics (2), it radically changes the switching possibilities, which are here described by a hybrid model enforcing a precise periodic sequence for \u03c3: 1, 0, -1, 0, . . . (in practice \u03c3 is a three-level square waveform): z\u03071 z\u03072 \u03c3\u0307\nd\u0307\n = f(\u03be) =  \u03c9z2 \u2212\u03c9z1 \u2212 \u03b2z2\n0 0  \u03be \u2208 C(\u03c6), (4a)  z+1 z+2 \u03c3+\nd+\n = g(\u03be) =  z1 + d z2\n\u2212d+ \u03c3 \u2212d+ 2\u03c3  \u03be \u2208 D(\u03c6). (4b) In our new model (4), \u03be := (z1, z2, \u03c3, d) collects the four states: two physical and two logical ones. The logical state \u03c3 denotes the switch position, as in [11], [12]. The new logical\nstate d \u2208 {\u22121, 1} plays an important role when \u03c3 = 0 as it stores the past value of \u03c3, so that the next value will be assigned as the opposite one (i.e. \u2212d), in order to generate the correct switching pattern. Clearly, any variation of \u03c3 and d must be instantaneous, so that \u03c3\u0307 = 0 and d\u0307 = 0.\nThe angle \u03c6 \u2208 [0, \u03c0/2) is a reference input affecting the steady-state output voltage (minimum for \u03c6 = \u03c0/2 and maximum for \u03c6 = 0). Based on \u03c6, we select the jump and flow sets as\nC(\u03c6) := C1(\u03c6) \u222a C10(\u03c6) \u222a C\u20131(\u03c6) \u222a C\u201310(\u03c6), D(\u03c6) := D1(\u03c6) \u222a D10(\u03c6) \u222a D\u20131(\u03c6) \u222a D\u201310(\u03c6),\n(5a)\nwhich correspond to the union of four jump and flow sets graphically illustrated in Fig. 2. Selection (5a) intuitively leads to a reduced phase mismatch between vs and iC , as shown by the sample solution of (4), (5) represented in black. More precisely, for each q \u2208 {\u20131, 1}, define\nCq(\u03c6) := {(z, \u03c3, d) : \u03c3 = q, d = q, d ((z1 + \u03c3) sin\u03c6\u2212 z2 cos\u03c6) \u2264 0}, (5b)\nCq0(\u03c6) := {(z, \u03c3, d) : \u03c3 = 0, d = q, (d (z1 sin\u03c6\u2212 z2 cos\u03c6) \u2265 0) \u2228 (dz2 \u2265 0)}, (5c)\nDq(\u03c6) := {(z, \u03c3, d) : \u03c3 = q, d = q, dz2 \u2265 0, (z1 + \u03c3) sin\u03c6\u2212 z2 cos\u03c6 = 0}, (5d)\nDq0(\u03c6) := {(z, \u03c3, d) : \u03c3 = 0, d = q, dz2 \u2264 0, z1 sin\u03c6+ z2 cos\u03c6 = 0}. (5e)\nNote that D1(\u03c6) and D\u20131(\u03c6) are horizontally translated with respect to the origin. Therefore, when \u03c3 = 0, solutions flow by spanning a constant cone centered at the origin, so that the flowing interval is constant regardless of the amplitude of z. Secondly, the zero crossing of the current iC (proportional to z2) happens approximately at the middle of that flowing interval (the lower \u03b2 the better this approximation, due to the higher quality factor). This results in keeping vs and iC mostly in phase and, for the SRC configuration, it ensures that the input voltage and the current of the resonant tank are almost synchronized.\nRemark 1 Shifting horizontally the two jump sets D1 and D\u20131 has a desirable effect on the relation between \u03c6 and the output amplitude. First, we can reach zero amplitude for \u03c6 = \u03c0/2. Secondly, the static relation between \u03c6 and\nthe steady-state amplitude of z2 is well interpolated by a cosine function: Ass(\u03c6) = 4\u03c0R \u221a L C cos\u03c6, where 4 \u03c0R \u221a L C is the amplitude of the first harmonic of iC normalized by z2 at the resonant frequency. See Fig. 3, showing simulation results (blue asterisks) vs the graph of the function Ass. \u25e6"
        },
        {
            "heading": "III. STABILITY OF THE RESONANT BEHAVIOR",
            "text": ""
        },
        {
            "heading": "A. Main result",
            "text": "For our main stability result we require a mild underdamped assumption (see [12, Remark 1]) for the oscillating behavior, requiring that flowing solutions revolve in the phase-plane of Fig. 2, which ensures existence of a non trivial asymptotically stable hybrid limit cycle (as defined in [12] and recalled below) for any reference input \u03c6 \u2208 [0, \u03c0/2).\nAssumption 1 The relation 2\u03c9 > \u03b2 > 0 is satisfied, namely the resonant tank is underdamped. Equivalently, the roots of s2 + \u03b2s+ \u03c92 = 0 are complex conjugate.\nDefinition 1 [12] Given an hybrid system H = (C, f,D, g), a nontrivial hybrid periodic trajectory \u03b6 is a complete solution (namely, a solution that evolves forever) that is not identically zero and for which there exists a pair (T, J) \u2208 R\u22650 \u00d7 Z\u22650 satisfying T + J > 0, such that (t, j) \u2208 dom(\u03b6) implies (t+ T, j + J) \u2208 dom(\u03b6) and, moreover,\n\u03b6(t, j) = \u03b6(t+ T, j + J). (6)\nThe image of \u03b6 is a nontrivial hybrid periodic orbit.\nWe state next the main theoretical result of this work. It states the asymptotic stability of a nontrivial hybrid periodic orbit with basin of attraction corresponding to the whole space except for the four points (see the green dots in Fig. 4) in the set K := {(0, 0, 0,\u22121), (0, 0, 0, 1), (\u22121, 0, 1, 1), (1, 0,\u22121,\u22121)}. These points comprise weak equilibria1 and they do not belong to the basin of attraction: for example, solutions starting from (0, 0, 0,\u22121) and (0, 0, 0, 1) can flow forever staying there or may jump to (\u22121, 0, 1, 1) or (1, 0,\u22121,\u22121) and then: either flow and converge to the hybrid limit cycle, or continue to jump among the points in K.\n1A weak equilibrium is a point from which there exist constant solutions but also non-constant ones.\nTheorem 1 Under Assumption 1, for each selection of \u03c6 \u2208 [0, \u03c0/2), the closed loop (4), (5) has a unique nontrivial hybrid periodic orbit O\u03c6 that is stable and almost globally attractive with basin of attraction \u039e = (R2\u00d7{\u22121, 0, 1}\u00d7{\u22121, 1}) \\K."
        },
        {
            "heading": "B. Preliminary observations to prove Theorem 1",
            "text": "Let us define the set \u2126 = \u21261 + \u2126\u20131 + \u212610 + \u2126\u201310 as the set of points visited by any solution flowing in C from g(D). More rigorously, denoting t 7\u2192 \u03c8\u03be0(t, 0) any flowing solution of (4) from \u03be0, for each i \u2208 {1, \u20131, 10, \u201310}, we define\n\u2126i = {\u03be \u2208 C : \u03be = \u03c8g(\u03be0)(t, 0) for some \u03be \u2208 Di, t \u2265 0}.\nSets \u21261 and \u2126\u20131 correspond to two cones centered at the origin. Set \u212610 (resp. \u2126\u201310) corresponds to a cone minus an area limited by what we may call boundary solution, which flows from the cone vertex zv = (1, 0) (resp. zv = (\u22121, 0)). About this boundary solution, it is well defined for any \u03c6 \u2208 [0, \u03c0/2) since the vector field at the vertex is vertical, therefore the solution is forced to initially flow inside the cone and then, due to Assumption 1, it revolves clockwise while flowing, until it reaches D\u20131 (resp. D1). We define the scalar \u03bbm > 0 as the distance between the vertex (1, 0) (resp. (\u22121, 0)) and the point where the boundary solution intersects D\u20131 (resp. D1) after flowing in the cone.\nFig. 4 depicts \u03bbm, the set \u2126, the set P := (D1 \u222aD\u20131)\u2229\u2126, and the coordinate \u03bb \u2208 [\u03bbm,+\u221e) defined as\n\u03bb = \u039b(\u03be) := |[ 1 0 0 00 1 0 0 ] g(\u03be)| , \u2200\u03be \u2208 P, (7)\nsee also the first and third diagram in Fig. 2. The following lemma is an immediate property of solutions and is stated without proof.\nLemma 1 Set \u2126 is forward invariant and all solutions from \u2126 are unique. Moreover, all solutions from (C \u222aD)\\K converge to \u2126 in uniform finite time.\nIntroduce now the function \u03d5P(\u03be0) : \u2126 \u2192 P returning the value \u03c8\u03be0(tP , jP) \u2208 P , where \u03c8\u03be0 is the solution to (4) starting at \u03be0 (unique by Lemma 1), and (tP , jP) is\n(tP , jP) = argmin (t,j)\u2208dom\u03c8\u03be0 (t+ j) s.t. \u03c8\u03be0(t, j) \u2208 P. (8)\nIntuitively speaking, for any \u03be0 \u2208 \u2126, \u03d5P(\u03be0) denotes the value of the unique solution starting at \u03be0 the first time that it belongs to P ."
        },
        {
            "heading": "C. Proof of Theorem 1",
            "text": "We first prove existence and global asymptotic stability (GAS) from \u2126 of a hybrid periodic orbit O\u03c6 contained in the interior of \u2126, based on a Poincare\u0301 analysis. Then by the uniform convergence established in Lemma 1, the result follows.\nAfter the first jump, all solutions must transit through set P . Therefore, we may define a Poincare\u0301 map characterizing a solution half-cycle as \u03be+ = \u03d5P(g(\u03be)) \u2208 P for any \u03be \u2208 P . Due to the central symmetry of the dynamics, we can also\nparameterize the Poincare\u0301 map in terms of \u03bb, as defined in (7), through description\n\u03bb+ = \u03a6(\u03bb), \u03bb \u2208 [\u03bbm,+\u221e), (9)\nwith \u03a6(\u03bb) := \u039b(\u03d5P(\u03be\u03bb)), and \u039b\u22121(\u03bb) denoting a selection of \u03be\u03bb \u2208 P ensuring \u039b(\u03be\u03bb) = \u03bb. The discrete dynamics (9) plays the role of a Poincare\u0301 map for (4) restricted to \u2126. We show below that there exists a unique globally asymptotically stable equilibrium \u03bb\u22c6 = \u03a6(\u03bb\u22c6) for (9).\nEnergy function. Due to Lemma 1, we consider next only points \u03be \u2208 P . Then, the proof of existence and uniqueness focuses on the behavior of the z components of the unique solution to (4) inducing \u03a6, in terms of the energy function\nE(z) := 1\n2 |z|2. (10)\nDue to this fact, to simplify our notation, in the sequel, we use g to denote the z component of the jump map g. Also, we will employ overlines on the jump and flow sets, to denote their projection on the z plane. With a slight abuse of notation, we will only refer to the z component of the solutions, whenever the \u03c3 and d components are clear from the (flow or jump) set under consideration.\nLet \u03c6 \u2208 [0, \u03c0/2) be fixed and, for each \u03bb \u2265 \u03bbm, consider any pair of points zF (\u03bb) \u2208 g(D1) and zB(\u03bb) \u2208 g(D\u20131) both of them at the same distance \u03bb from the origin, where \u201cF \u201d stands for \u201cForward\u201d and \u201cB\u201d stands for \u201cBackwards\u201d. A pictorial representation of these points and related solutions is shown in Fig. 4. Due to the symmetry of the jump sets, we have E(zF (\u03bb)) = E(zB(\u03bb)) = 1 2\u03bb\n2. Consider the points \u03b6F (\u03bb) \u2208 g(D10) and \u03b6B(\u03bb) \u2208 g(D10) obtained, respectively, from the forward flowing solution (unique from Lemma 1) starting at zF (\u03bb) and the backward solution starting at zB(\u03bb), jumping back to the unique point zB(\u03bb)\u2212 \u2208 D\u20131 and then (uniquely) flowing backwards in time in C\u20131 until they both reach g(D10).\nForward solution. About zF (\u03bb) and \u03b6F (\u03bb), the forward solution flows in C10 and then jumps after it reaches D10 (which necessarily happens after a finite time, due to the revolving nature of flowing solutions, as induced by Assumption 1). In particular, since C10 is a cone, regardless of \u03bb, the solution flows for a fixed time T and the energy dissipation during such a flowing interval corresponds to \u03a3F (\u03bb) = 12\u03bb\n2(1 \u2212 \u00b5(\u03c6)2), where \u00b5(\u03c6) (the dependence on \u03c6 is dropped in the following) is a constant that can be easily computed from the flowing solution of z\u0307 = Az, by solving the equality eAT \u03bb [ cos\u03c6 sin\u03c6 ] =\n\u03bb\u00b5 [ cos\u03c6 \u2013 sin\u03c6 ] , resulting in \u00b5 = [ cos\u03c6 \u2212 sin\u03c6 ]\u22a4 eAT [ cos\u03c6 sin\u03c6 ] \u2208 (0, 1]. After this flowing interval, the solution belongs to D10 and must jump (from eAT zF (\u03bb) = \u03bb\u00b5 [ cos\u03c6 \u2013 sin\u03c6 ] to \u03b6F (\u03bb)). This jump is associated with an increase \u03b4F of the energy E, amounting to\n\u03b4F (\u03bb) = 1\n2\n( |(eAT zF )+|2 \u2212 |eAT zF |2 ) = 1\n2 + \u03bb\u00b5 cos\u03c6.\n(11) Overall, we may characterize the energy at point \u03b6F (\u03bb) as\nEF (\u03bb) := E(\u03b6F (\u03bb)) = 1\n2 \u03bb2 \u2212 \u03a3F (\u03bb) + \u03b4F (\u03bb). (12)\nBackward solution. Consider now zB(\u03bb) and \u03b6B(\u03bb), and also here notice that the backward solution of interest jumps backwards to a point in D\u20131 denoted as zB(\u03bb)\u2212 = \u03bb [\u2212 cos\u03c6 \u2212 sin\u03c6 ] +[ 10 ] = [ 1\u2212\u03bb cos\u03c6 \u2212\u03bb sin\u03c6 ] . The variation of energy across this backward time jump corresponds to\n\u03b4B(\u03bb) = 1\n2\n( |zB(\u03bb)\u2212|2 \u2212 |zB(\u03bb)|2 ) = 1\n2 \u2212 \u03bb cos\u03c6. (13)\nContinuing in the backwards motion of this solution, for any \u03bb \u2265 \u03bbm, we see a flowing interval in the set C\u20131 where the solution reaches (in finite backwards time) the set g(D10), due to the revolving properties induced by Assumption 1.\nApplying [12, Lemma 2] such a flowing interval is associated with an energy increase (in backwards time) corresponding to \u03a3B(\u03bb) := \u03b2\u03c9\u03a0(zB(\u03bb)\n\u2212), where \u03a0(zB(\u03bb)\u2212) is the (unsigned) area hatched between the graph of the backwards trajectory and the axis z2 = 0. Note that \u03a3B is a positive and quadratically increasing function of \u03bb.\nOverall, we may characterize the energy at point \u03b6B(\u03bb) as\nEB(\u03bb) := E(\u03b6B(\u03bb)) = 1\n2 \u03bb2 +\u03a3B(\u03bb) + \u03b4B(\u03bb). (14)\nEnergy balance. Consider the mismatch function\nE\u0303(\u03bb) := EF (\u03bb)\u2212 EB(\u03bb) = \u03b4(\u03bb)\u2212 \u03a3(\u03bb), (15)\nwhere \u03a3 is a quadratically increasing function of \u03bb (it is strongly convex):\n\u03a3(\u03bb) := \u03a3B(\u03bb) + \u03a3F (\u03bb) = \u03a3B(\u03bb) + 1\n2 \u03bb2(1\u2212 \u00b52), (16)\nand \u03b4 is a linearly increasing function of \u03bb:\n\u03b4(\u03bb) := \u03b4F (\u03bb)\u2212 \u03b4B(\u03bb) = \u03bb(1 + \u00b5) cos\u03c6. (17)\nLemma 2 There exist a unique value \u03bb\u22c6 > \u03bbm such that E\u0303(\u03bb\u22c6) = 0. Moreover, \u03bb\u22c6 is a fixed point for \u03a6 in (9).\nProof: Let us show that E\u0303(\u03bbm) = \u03b4(\u03bbm)\u2212\u03a3(\u03bbm) > 0, which from (15) is equivalent to showing that EF (\u03bbm) \u2212 EB(\u03bbm) > 0. For \u03bb = \u03bbm, a) the forward solution reaches \u03b6F (\u03bbm) with energy EF (\u03bbm) = 12 + 1 2\u03bb 2 m\u00b5\n2 + \u03bbm\u00b5 cos\u03c6; b) by definition of \u03bbm, the backward solution reaches the vertex \u03b6B = (1, 0) with energy EB(\u03bbm) = 12 . Therefore EF (\u03bbm)\u2212EB(\u03bbm) = 12\u03bb 2 m\u00b5\n2+\u03bbm\u00b5 cos\u03c6, which is the sum of two positive scalars. Since function \u03bb 7\u2192 \u03c8\u0303(\u03bb) := \u2212E\u0303(\u03bb) is negative at \u03bbm and strongly convex, then, from [12, Lemma 1], there exists a unique positive value \u03bb\u22c6 > \u03bbm such that E\u0303(\u03bb\u22c6) = 0. Finally, we can express the energy difference, in terms of \u03bb, between the final and initial points \u03a6(\u03bb) and \u03bb, as E\u0303(\u03bb) = 12 (\u03a6(\u03bb)\n2 \u2212 \u03bb2). From which we conclude that \u03bb\u22c6 is a fixed point for (9).\nThe corresponding points \u03be\u22c6 \u2208 P that satisfy \u039b(\u03be\u22c6) = \u03bb\u22c6, and the image of the unique solution originating from those points is a unique nontrivial hybrid periodic orbit in the interior of \u2126 (because \u03bb\u22c6 > \u03bbm), characterized as\nO\u03c6 = {\u03be \u2208 \u2126 : \u039b(\u03d5P(\u03be)) = \u03bb\u22c6}. (18)\nLyapunov function. In order to prove GAS of the hybrid periodic orbit we reduce the stability analysis to the Poincare\u0301 map (9). We have already shown that there exists a unique equilibrium point \u03bb\u22c6 = \u03a6(\u03bb\u22c6). Then, we introduce the quadratic Poincare\u0301-like Lyapunov function,\nV (\u03bb) := (\u03bb\u2212 \u03bb\u22c6)2. (19)\nSimilar to the final part of the proof of [15, Lemma 2], to prove global asymptotic stability, we show that:\nV (\u03a6(\u03bb))\u2212 V (\u03bb) < 0 \u2200\u03bb \u2265 \u03bbm, \u03bb \u0338= \u03bb\u22c6,\nor, equivalently,\n(\u03a6(\u03bb)\u2212 \u03bb)(\u03a6(\u03bb) + \u03bb\u2212 2\u03bb\u22c6) < 0 \u2200\u03bb \u2265 \u03bbm, \u03bb \u0338= \u03bb\u22c6. (20)\nTo show this, let us divide the study for \u03bb > \u03bb\u22c6 and \u03bb < \u03bb\u22c6. From the proof of Lemma 2, for \u03bb > \u03bb\u22c6, we have that E\u0303(\u03bb) < 0, which implies \u03a6(\u03bb) \u2212 \u03bb < 0, in other terms \u03bb > \u03a6(\u03bb) > \u03bb\u22c6 where \u03a6(\u03bb) > \u03bb\u22c6 comes from the uniqueness of flowing solutions so that they cannot cross. Next, we assess the positivity of the second term in (20) as \u03a6(\u03bb)+\u03bb\u2212 2\u03bb\u22c6 > 2(\u03a6(\u03bb)\u2212\u03bb\u22c6) > 0. For the case \u03bb < \u03bb\u22c6, similar considerations hold, leading to (20). Finally, continuity of \u03a6 follows from similar reasonings to [15, Lemma 2] and the stability of \u03bb\u22c6 for (9) proved above, imply global asymptotic stability of O\u03c6 in (18) from \u2126, following the steps in [15, Proposition 1], which are here omitted due to length restrictions. Finally, GAS of O\u03c6 from \u039e follows from the uniform convergence established in Lemma 1."
        },
        {
            "heading": "IV. EXPERIMENTAL VALIDATION",
            "text": "The results of Theorem 1 are validated on an experimental SRC prototype and via simulations. The experimental setup consists in an SRC designed for a 50 kHz resonant frequency. The DC power supply is Vg = 24V, the resonant tank components are L = 94.5\u00b5H and C = 100 nF. The control law is implemented in an FPGA where we use ADCs to\nsense the current and the voltage on the capacitor (needed to compute (z1, z2) as illustrated in [11]).\nThe control law is implemented in the FPGA as an automaton with four states, corresponding to the four parts in which one period can be decomposed, based on the variables \u03c3 and d: (\u03c3, d) \u2208 {(1, 1), (0, 1), (\u22121,\u22121), (0,\u22121)}. (see Fig. 2). The jump sets are modeled as half-planes to ensure robustness and simplicity in the implementation. The automaton is allowed to go to the next sequential state whenever 1) jump signal is active and 2) the automaton is in the preceding state (e.g (\u03c3, d) = (1, 1) and D1 active: (z1 + 1) sin\u03c6\u2212 z2 cos\u03c6 \u2265 0). Differently from [12], to evaluate the jump conditions, a generic scaled version of (z1, z2) is not enough: we need to know the scaling factor in the acquisition chain and compensate for it. This is due to the sets D1 and D\u20131 being shifted with respect to the origin.\nMultiple experiments have been run for two load selections: R = 10.1\u2126 and R = 21.8\u2126. Fig. 5 compares the simulated and experimental steady-state responses for different values of \u03c6. We emphasize that no startup controller is needed due to the (almost) global attractivity established in Theorem 1, thus the device starting at rest effectively spirals out to reach the pre-\nscribed oscillating behavior. The corresponding experimental time waveforms are reported in Fig. 6. Note that, the input current (i.e. the capacitor current, due to the SRC configuration) is approximately in phase with the input voltage. Having the first harmonics aligned implies improved performance in terms of efficiency, since more power is transmitted to the load and less power is dissipated in the resonant tank. Finally, Figs. 7 and 8 compare the simulated and experimental frequencies and amplitudes. The black horizontal dotted lines show the resonant frequencies evaluated by characterizing the resonant tank, with the load, at low power. The physical controller presents some limits for low amplitudes (large \u03c6) due to the resolution of the ADCs and the amplitude of the noise. Therefore, only a subset of values for \u03c6 has been validated experimentally.\nThe experiments confirm the simulation results. The frequency mismatch visible in both figures amounts to an acceptable 4%. Minor amplitude discrepancies are also visible, probably due to model uncertainties (e.g. nonlinear dependence of the inductor on the current, parasitic effect on the PCB, sampling effects) but the reliable closed-loop behavior illustrates the robustness of the proposed control."
        },
        {
            "heading": "V. CONCLUSIONS AND FUTURE WORK",
            "text": "We have proposed a novel state-plane control approach modulating the first harmonic of the input voltage as an emergent self-oscillating behavior: an amplitude modulation approach. Through a reference input \u03c6 \u2208 [0, \u03c0/2) we can control the amplitude of the converter output and we can always generate a self-oscillating hybrid limit cycle in underdamped conditions. The expected theoretical and simulated response has been confirmed by experiments on an SRC prototype.\nThe proposed hybrid controller opens interesting possibilities for future research. First, it can be anticipated that using the reference input for regulation of the converter will present advantageous dynamic properties. Secondly, novel conditions on the hybrid control law ensuring zero voltage switching would reduce the switching losses and open new possibilities\non operating the power converters at their best efficiency points.\nREFERENCES [1] R. Erickson and M. Dragan, Fundamentals of Power Electronics, 3rd ed.\nSpringer Nature, 2020. [2] R. Oruganti and F. C. Lee, \u201cResonant Power Processors, Part II-Methods\nof Control,\u201d IEEE Trans. on Industry Applications, 1985. [3] M. Youssef and P. Jain, \u201cA review and performance evaluation of control\ntechniques in resonant converters,\u201d in 30th Annual Conference of IEEE Industrial Electronics Society, 2004. IECON 2004, 2004. [4] V. Vorperian, \u201cApproximate small-signal analysis of the series and the parallel resonant converters,\u201d IEEE Tran. on Power Electronics, 1989. [5] Y. Yin, R. Zane, J. Glaser, and R. Erickson, \u201cSmall-signal analysis of frequency-controlled electronic ballasts,\u201d IEEE Transactions on Circuits and Systems I: Fundamental Theory and Applications, 2003. [6] J. Burdio, F. Canales, P. Barbosa, and F. Lee, \u201cComparison study of fixed-frequency control strategies for ZVS DC/DC series resonant converters,\u201d in IEEE Power Electronics Specialists Conference, 2001. [7] M. Youssef, H. Pinheiro, and P. Jain, \u201cSelf-sustained phase-shift modulated resonant converters: Modeling, design, and performance,\u201d IEEE Transactions on Power Electronics, 2006. [8] H. Pinheiro, P. Jain, and G. Joos, \u201cPerformance characterization of two self-oscillating controllers for parallel resonant converters operating with unity input power factor,\u201d in Record 28th Annual IEEE Power Electronics Specialists Conference, 1997. [9] R. Bonache-Samaniego, C. Olalla, L. Mart\u0131\u0301nez-Salamero, and H. Valderrama-Blavi, \u201cDesign of self-oscillating resonant converters based on a variable structure systems approach,\u201d IET Power Electronics, 2016. [10] R. Bonache-Samaniego, C. Olalla, and L. Mart\u0131\u0301nez-Salamero, \u201cDynamic Modeling and Control of Self-Oscillating Parallel Resonant Converters Based on a Variable Structure Systems Approach,\u201d IEEE Transactions on Power Electronics, 2017. [11] N. Zaupa, L. Mart\u0131\u0301nez-Salamero, C. Olalla, and L. Zaccarian, \u201cResults on hybrid control of self-oscillating resonant converters,\u201d in IFAC Conference on Analysis and Design of Hybrid Systems, Jul. 2021. [12] N. Zaupa, L. Mart\u0131\u0301nez-Salamero, C. Olalla, and L. Zaccarian, \u201cHybrid control of self-oscillating resonant converters,\u201d IEEE Transactions on Control Systems Technology, pp. 1\u20138, 2022. [13] R. Goebel, R. Sanfelice, and A. Teel, Hybrid Dynamical Systems: modeling, stability, and robustness. Princeton University Press, 2012. [14] A. Nabae, I. Takahashi, and H. Akagi, \u201cA New Neutral-Point-Clamped PWM Inverter,\u201d vol. IA-17, no. 5, pp. 518\u2013523, 1981. [15] A. Bisoffi, F. Forni, M. Da Lio, and L. Zaccarian, \u201cRelay-based hybrid control of minimal-order mechanical systems with applications,\u201d Automatica, vol. 97, pp. 104\u2013114, 2018."
        }
    ],
    "title": "Hybrid Control of Self-Oscillating Resonant Converters With Three-Level Input",
    "year": 2023
}