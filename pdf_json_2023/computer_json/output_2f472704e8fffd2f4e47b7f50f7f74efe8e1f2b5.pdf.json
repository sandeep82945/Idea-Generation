{
    "abstractText": "Liquidity providers (LPs) on decentralized exchanges (DEXs) can protect themselves from adverse selection risk by updating their positions more frequently. However, repositioning is costly, because LPs have to pay gas fees for each update. We analyze the causal relation between repositioning and liquidity concentration around the market price, using the entry of a blockchain scaling solution, Polygon, as our instrument. Polygon\u2019s lower gas fees allow LPs to update more frequently than on Ethereum. Our results demonstrate that higher repositioning intensity and precision lead to greater liquidity concentration, which benefits small trades by reducing their slippage. JEL classifications: G14, G18, G19",
    "authors": [
        {
            "affiliations": [],
            "name": "Basile Caparros"
        },
        {
            "affiliations": [],
            "name": "Amit Chaudhary"
        },
        {
            "affiliations": [],
            "name": "Olga Klein"
        }
    ],
    "id": "SP:b658ecf5fd597d00fb8742b4b557d3757169f009",
    "references": [
        {
            "authors": [
                "J. Aoyagi"
            ],
            "title": "Liquidity provision by automated market makers",
            "venue": "Working paper, Hong Kong University of Science and Technology",
            "year": 2020
        },
        {
            "authors": [
                "J. Aoyagi",
                "Y. Ito"
            ],
            "title": "Coexisting exchange platforms: Limit order books and automated market makers",
            "venue": "Working paper,",
            "year": 2021
        },
        {
            "authors": [
                "A. Aspris",
                "S. Foley",
                "J. Svec",
                "L. Wang"
            ],
            "title": "Decentralized exchanges: The \u201cwild west",
            "venue": "of cryptocurrency trading. International Review of Financial Analysis,",
            "year": 2021
        },
        {
            "authors": [
                "A. Barbon",
                "A. Ranaldo"
            ],
            "title": "On the quality of cryptocurrency markets: Centralized versus decentralized exchanges",
            "venue": "Working paper, University of St. Gallen",
            "year": 2021
        },
        {
            "authors": [
                "A. Capponi",
                "R. Jia"
            ],
            "title": "The adoption of blockchain-based decentralized exchanges",
            "venue": "Working paper,",
            "year": 2021
        },
        {
            "authors": [
                "N. Chemaya",
                "D. Liu"
            ],
            "title": "Estimating investor preferences for blockchain security",
            "venue": "Working paper,",
            "year": 2022
        },
        {
            "authors": [
                "J. Hasbrouck",
                "T.J. Rivera",
                "F. Saleh"
            ],
            "title": "The need for fees at a dex: How increases in fees can increase dex trading",
            "year": 2022
        },
        {
            "authors": [
                "L. Heimbach",
                "E. Schertenleib",
                "R. Wattenhofer"
            ],
            "title": "Risks and returns of uniswap v3 liquidity providers",
            "venue": "Working paper,",
            "year": 2022
        },
        {
            "authors": [
                "T. Hendershott",
                "C.M. Jones",
                "A.J. Menkveld"
            ],
            "title": "Does algorithmic trading improve liquidity",
            "venue": "The Journal of finance,",
            "year": 2011
        },
        {
            "authors": [
                "A.S. Kyle"
            ],
            "title": "Continuous auctions and insider",
            "venue": "trading. Econometrica,",
            "year": 1985
        },
        {
            "authors": [
                "A. Lehar",
                "C.A. Parlour"
            ],
            "title": "Decentralized exchanges",
            "venue": "Working paper, Haas School of Business, UC Berkeley",
            "year": 2021
        },
        {
            "authors": [
                "A. Lehar",
                "C.A. Parlour",
                "M. Zoican"
            ],
            "title": "Liquidity fragmentation on decentralized exchanges",
            "year": 2022
        },
        {
            "authors": [
                "P. O\u2019Neill",
                "S. Foley",
                "T. Putnins"
            ],
            "title": "Can markets be fully automated? evidence from an \u201cautomated market maker",
            "year": 2022
        },
        {
            "authors": [
                "A. Park"
            ],
            "title": "Conceptual flaws of decentralized automated market making",
            "venue": "Working paper,",
            "year": 2022
        },
        {
            "authors": [
                "arbitrageurs. Lehar",
                "Parlour",
                "O\u2019Neill"
            ],
            "title": "2022) further show that the pool size acts as an equilibrating mechanism on DEXs, equivalent to the bid-ask spread on CEXs",
            "year": 2022
        }
    ],
    "sections": [
        {
            "text": "Liquidity providers (LPs) on decentralized exchanges (DEXs) can protect themselves from adverse selection risk by updating their positions more frequently. However, repositioning is costly, because LPs have to pay gas fees for each update. We analyze the causal relation between repositioning and liquidity concentration around the market price, using the entry of a blockchain scaling solution, Polygon, as our instrument. Polygon\u2019s lower gas fees allow LPs to update more frequently than on Ethereum. Our results demonstrate that higher repositioning intensity and precision lead to greater liquidity concentration, which benefits small trades by reducing their slippage.\nJEL classifications: G14, G18, G19\nKeywords: decentralized exchanges, FinTech, gas fees, liquidity concentration, market depth, slippage\n\u2217We would like to thank Marius Zoican, Alfred Lehar, Gleb Kurovskiy, Fahad Saleh, Norman Schu\u0308rhoff, Ganesh Viswanath-Natraj, Roman Kozhan and seminar participants at Warwick Business School and Gillmore Center for Financial Technology for insightful comments on this paper. This paper has been presented at the 2023 Economics of Financial Technology Conference. The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper. This research did not receive any specific grant from funding agencies in the public, commercial, or not-for-profit sectors.\n\u2020ChainSolid (basile@chainsolid.com)\n\u2021Warwick Business School, Gillmore Centre for Financial Technology (a.chaudhary.3@warwick.ac.uk) - ChainSolid (amit@chainsolid.com) - I thank Prabal Banerjee for valuable feedback and comments.\n\u00a7Warwick Business School, Gillmore Center for Financial Technology (olga.klein@wbs.ac.uk)\nar X\niv :2\n30 6.\n17 74\n2v 2\n[ q-\nfi n.\nT R\n] 4"
        },
        {
            "heading": "1 Introduction",
            "text": "One of the major cryptocurrency exchanges, FTX, filed for bankruptcy on November 11, 2022. Crucially, FTX kept custody of its client deposits. Thus, whereas the exact reasons for its collapse are still being investigated by the US Securities and Exchange Commission (SEC), at least $1B of its customers\u2019 funds have vanished, according to Reuters1. FTX was a centralized exchange (CEX), with all trades taking place through a limit order book (LOB). In any LOB-based market, a central institution, such as FTX, is needed to match trades and keep records of all transactions.\nA recent alternative to CEXs are so-called decentralized exchanges (DEXs) that operate directly on the blockchain. In contrast to CEXs, users themselves keep custody of their assets on DEXs. They execute their trades directly from their wallet, using smart contracts, i.e. a set of pre-programmed rules.2 Therefore, executing directly on the blockchain provides higher level of security for clients\u2019 funds. Indeed, there is evidence of significant trading volume shifting to DEXs in the week of FTX collapse. According to Reuters, \u201cvolumes at the largest DEX, Uniswap, spiked to $17.2 billion in the week of Nov 6-13, from just over $6 billion the week before\u201d.3\nThis higher level of security on DEXs comes, however, at a cost. First, transactions are overall slower, since they have to be validated by \u201cminers\u201d or \u201cvalidators\u201d before being recorded on the blockchain. Second, users of the blockchain have to compensate validators with the so-called \u201cgas fees\u201d for their efforts. Importantly, \u201cgas fees\u201d are paid not only by liquidity demanders, but also by liquidity providers (LPs). Essentially, gas fees act as a\n1\u201cExclusive: At least $1 billion of client funds missing at failed crypto firm FTX\u201d, Reuters, November 13, 2022. Available at https://www.reuters.com/markets/currencies/exclusive-least-1-billion-client-fundsmissing-failed-crypto-firm-ftx-sources-2022-11-12/\n2Aspris et al. (2021) also argue that decentralized exchanges have higher security, because assets are never transferred to the custody of a third party. Lehar and Parlour (2021) and Barbon and Ranaldo (2021) provide a comprehensive overview of differences between CEXs and DEXs. However, allowing users to keep custody of their own assets is the most important advantage of DEXs.\n3\u201cCryptoverse: Let\u2019s talk about DEX, baby\u201d, Reuters, November 22, 2022. Available at https://www.reuters.com/markets/currencies/cryptoverse-lets-talk-about-dex-baby-2022-11-22/\n0\n\u201ctransaction tax\u201d for every transaction added to the blockchain. Liquidity demanders pay gas fees whenever they would like to execute a trade.4 Liquidity providers pay gas fees whenever they deposit or withdraw liquidity from the exchange.\nIn this paper, we analyze the effects of repositioning intensity, i.e. frequency of position updates by LPs, on liquidity concentration on the largest DEX, Uniswap v3. Much alike traditional market makers, LPs are subject to adverse selection risk (). To protect themselves from being adversely selected, LPs need to update their positions in response to changes in the market price, similar to canceling and reposting limit orders in the LOB. With lower gas fees, it is cheaper for LPs to update their liquidity positions. Consequently, they can reposition more frequently, which results in better protection from adverse selection.5 With better protection from adverse selection, LPs can earn higher fees (for the same amount of capital deposited) by setting narrower price ranges around the market price, i.e. their positions become more concentrated. Thus, we expect that a higher repositioning intensity by LPs leads to higher concentration of aggregate liquidity around the market price.\nIn contrast, if gas fees are high, LPs should only update their positions if the market price sufficiently deviates from their position\u2019s price range, as repositioning is costly. Therefore, we expect LPs to set wider price ranges when they are not able to update frequently, in order to reduce adverse selection risk. Lower repositioning intensity should thus result in lower concentration of aggregate liquidity in the pool. Overall, concentration of aggregate pool liquidity around the market price is important, because higher concentration translates into lower slippage and thus lower execution cost for traders.\nTesting the empirical relation between repositioning intensity and liquidity concentration might be problematic, because repositioning intensity is potentially endogenous. A choice of an LP to update their position can in itself depend on the current liquidity concentration in\n4Gas fees are in addition to standard exchange fees that both CEXs and DEXs charge for trade execution. Prior findings by Barbon and Ranaldo (2021) suggest that gas fees on the main blockchain for DEXs, Ethereum, indeed represent a considerable portion of execution cost for traders on Uniswap v2.\n5Lehar et al. (2022) discuss trading mechanics on Uniswap v3 in great detail and also argue that liquidity updating should be more frequent with lower gas fees.\nthe pool. To identify the causal effect of repositioning intensity, we use the entry of Polygon PoS (proof of stake), an Ethereum scaling solution, as an instrument. Ethereum has high levels of gas fees, with an average gas fee of $14 per trade on Uniswap v3 in 2022. Further, transaction validation takes a long time, with only around 10-30 transactions written on Ethereum per second. In contrast, Polygon allows for a quicker validation of transactions, and can thus process up to 700 transactions per second (TPS), up to 70 times more than Ethereum.6 As a result, Polygon charges lower gas fees of only around $0.01 per transaction. Lower gas fees on Polygon allow LPs to update their positions more frequently. Therefore, we use the entry of Polygon as our instrument for an exogenous increase in repositioning intensity of LPs.\nWe test our predictions above using three most liquid ETH pools on Uniswap v3 that exist both on Polygon and Ethereum: USDC/(W)ETH 0.05%, USDC/(W)ETH 0.3% and (W)ETH/USDT 0.3%. Our sample period ranges from January 2022 to December 2022. Uniswap v3 launched on Polygon in December 2021. Our sample starts in January 2022, omitting the first month, when there was not enough liquidity on Polygon yet.\nWe first examine slippage for trades of different sizes across Ethereum and Polygon. We define slippage as the difference between the average execution price and the pre-execution market price. Our results show that the average slippage is higher on Polygon, compared to Ethereum. This higher slippage is due to significantly lower total value locked (TVL) on Polygon.7 Chemaya and Liu (2022) discuss the trade-off between better scalability and lower security of new Ethereum scaling solutions, such as Polygon and Optimism. LPs are more reluctant to deposit large amounts of liquidity on less secure blockchains, resulting in a lower overall TVL, compared to Ethereum. Similar to separating equilibrium, larger TVL\n6Quicker transaction validation is due to a lower number of validators on Polygon, who can achieve consensus more quickly, compared to Ethereum. A lower number of validators results in less decentralization, i.e. lower security of Polygon. Still, Polygon is regarded to have a decent level of decentralization with over 100 unique validators. We discuss the trade-off between security and scalability of blockchain scaling solutions in Section 2.2.\n7Total value locked (TVL) can be compared to overall market depth in the traditional LOB.\non Ethereum attracts larger trades, for which greater liquidity is more important than high gas fees. In contrast, Polygon is more attractive for smaller liquidity providers and smaller traders, who are primarily concerned about gas fees, and less so about security.\nImportantly, once we condition on the trade size, we find that small trades (up to $10K) have significantly lower slippage on Polygon, compared to Ethereum. Lower slippage of small trades on Polygon can be explained by higher liquidity concentration around the market price. Indeed, we observe that liquidity concentration, defined as market depth of the pool within 2% of the market price, scaled by TVL, is significantly higher on Polygon.8\nThe next step of our analysis is to test whether higher liquidity concentration is caused by higher repositioning intensity of LPs. As discussed above, we use the entry of Polygon as an instrument for an exogenous increase in updating frequency of LPs. Our findings from instrumental variable regressions provide strong supporting evidence for our predictions, suggesting that an increase in repositioning intensity indeed leads to greater concentration of liquidity around the market price.\nOne potential concern could be that, whereas liquidity providers increase intensity of their repositioning, they do not necessarily reposition close to the new market price. Further, although a position might be centered around the market price, it might still have a wide price range. To address these issues, we also run instrumental variable regressions for three measures of repositioning precision of LPs: the average gap between the midprice of their positions and the market price; the average range length of their positions; and the average position concentration, which combines the previous two measures. Consistent with our expectations, we find that an increase in repositioning precision also results in greater concentration of liquidity around the market price.\nOverall, our findings are important, because they show that blockchain scaling solutions already represent a viable alternative to Ethereum for small traders and liquidity providers. Specifically, their lower gas fees allow small liquidity providers to better manage their posi-\n8We also provide robustness checks for liquidity concentration within 1% and 10% of the market price.\ntions, protecting themselves from adverse selection. In turn, higher repositioning intensity and precision of LPs leads to higher liquidity concentration, which especially benefits small traders by reducing their slippage.\nOur paper contributes to the emerging literature on decentralized exchanges. First studies on decentralized exchanges focus their analysis on a particular subclass of automated market makers (AMMs), the constant product market makers (CPMMs), on the example of Uniswap v2. CPMMs do not allow liquidity providers to set a price range for their positions (). Hence, the only decision of a liquidity provider on Uniswap v2 is whether to provide liquidity or not in a specific pool. Lehar and Parlour (2021), Capponi and Jia (2021) and O\u2019Neill et al. (2022) show that liquidity providers on AMMs are subject to adverse selection by competing arbitrageurs. In this setup, Lehar and Parlour (2021) and O\u2019Neill et al. (2022) show how pool size acts as an equilibrating force in AMMs. Pools with higher adverse selection problem will experience more liquidity withdrawals and therefore reduce to an optimal size, in which average earned fees compensate liquidity providers in taking adverse selection risk. Lehar and Parlour (2021) do not explicitly analyze the role of gas fees, and treat them as an important pre-commitment by liquidity providers not to withdraw liquidity from the AMM. Barbon and Ranaldo (2021) compare transaction cost and price efficiency among DEXs and CEXs, taking gas fees into consideration. They show that execution cost is higher on Uniswap v2, compared to Binance, mainly due to the fixed nature of gas fees.\nTo the best of our knowledge, there are currently only two papers that analyze liquidity provision on Uniswap v3. Importantly, Uniswap v3 allows LPs to set price ranges for their positions, similar to limit orders in limit order books. Hasbrouck et al. (2022) show theoretically that higher-fee pools attract more liquidity providers, which reduces price impact of trades and increases the equilibrium trading volume. Lehar et al. (2022) focus their analysis on liquidity fragmentation across low- and high-fee pools on Ethereum. They argue that low-fee pools require more frequent updating in response to a higher trading volume, catering mostly to large LPs. High-fee pools are rather attractive for passive small (retail) LPs,\ndue to their lower liquidity management cost. Their model also predicts that, in presence of very low gas fees, all liquidity consolidates in a low-fee pool. Indeed, we find strong supporting evidence for this prediction in our paper, on an example of low- and high-fee pools on Polygon. In contrast to Lehar et al. (2022), the main focus of our study is the effect of repositioning intensity and precision of LPs on aggregate liquidity concentration around the market price."
        },
        {
            "heading": "2 The landscape of cryptoasset markets",
            "text": ""
        },
        {
            "heading": "2.1 Centralized vs decentralized exchanges",
            "text": "Cryptoassets are currently traded on two different types of exchanges: centralized exchanges (CEXs) and decentralized exchanges (DEXs). Centralized exchanges, such as Binance, Kraken, Coinbase (and previously, FTX) operate using limit order books. Figure 1 presents a snapshot of Binance BTC/USDT limit order book, with the bid side (in green) representing the cumulative BTC quantity of buy limit orders, and the ask side (in red) representing the cumulative BTC quantity of sell limit orders. In limit order markets, liquidity is usually provided by professional market makers, who strategically compete with each other by submitting limit orders.\n[Insert Figure 1 approximately here]\nIn contrast, decentralized exchanges operate directly on a blockchain, with liquidity usually provided through an \u201cautomated market maker\u201d (AMM). An AMM just follows a set of pre-programmed rules, so-called \u201csmart contracts\u201d, such that there is no explicit human intervention required when a trade (or a so-called \u201cswap\u201d) is submitted. Each asset pair, for example, USDC/ETH, comprises a separate liquidity pool. Liquidity providers (LPs), including retail investors, can deposit (\u201cmint\u201d) liquidity to the pool by adding both assets, or so-called tokens, in a respective ratio. They can also withdraw (\u201cburn\u201d) liquidity from the pool at a later point in time. Liquidity demanders (traders) can then swap one token for\nanother in the pool at the current market price. Thus, in contrast to limit order markets, proper matching of buy and sell orders is not required in an AMM. All trades are executed against the AMM, with the market price determined by mathematical formulas in smart contracts. Liquidity demanders pay a pre-specified exchange fee, e.g. 0.3%, for each trade as a compensation to liquidity providers. Both liquidity demanders and liquidity providers have to pay additional transaction fees, so-called \u201cgas fees\u201d, as a compensation to miners who actually record their transactions (i.e. \u201cswaps\u201d, \u201cmints\u201d, \u201cburns\u201d) on the blockchain. Importantly, DEXs users keep custody of their assets, because they execute trades from their own wallets and settlement is immediate.9\nUniswap is the leading decentralized exchange, with its first version, Uniswap v1, launched on Ethereum on November 2, 2018. The main drawback of Uniswap v1 is that it only supports trading against ETH, i.e. selling DAI for USDC requires two transactions: first, selling DAI for ETH and, second, ETH for USDC. To overcome this problem, Uniswap v2 was released in May 2020. Importantly, Uniswap v2 does not allow for competition of liquidity providers. The only decision liquidity providers make is whether to deposit liquidity in the pool or not. The trading fee equals 0.3% for all pools on Uniswap v2. Fees earned from trades are distributed pro-rata to liquidity providers, i.e. in proportion to the amount of liquidity they provide in the pool. Therefore, all gains (and losses) are mutualized by liquidity providers.\nThe latest version, Uniswap v3, was released in May 2021, implementing two main changes to Uniswap v2. First, it allows some degree of competition on price between liquidity providers by introducing the so-called \u201cconcentrated liquidity\u201d. Specifically, when depositing their tokens, LPs can now indicate the price range, i.e. the minimum and the maximum prices in a given pool at which their liquidity position is active. However, there is no competition on speed available, as all gains for LPs within the same price range are still\n9Barbon and Ranaldo (2021) provide an excellent overview of additional differences between CEXs and DEXs, relating to custody of assets, fees accrual etc.\nmutualized. Second, Uniswap v3 allows for four various fee tiers: 0.01%, 0.05%, 0.3% and 1%. Therefore, the same pair of assets can potentially be traded in four different pools.10 We discuss mechanics of trading on Uniswap v3 in more detail in Section 2.3.\nAs of August 2022, $914B were traded on CEXs, out of which $443B were traded on Binance. Panel A of Figure 2 shows monthly traded volume on CEXs (in $) from May 2017 to April 202311. Among all CEXs, Binance is dominating, with an average market share of 50%.\n[Insert Figure 2 approximately here]\nTotal traded volume on DEXs is 12 times lower than on CEXs as of August 2022, around $75B. However, it fluctuates considerably, with high values of $182B in November 2021 and $112B in March 2023, and low values of $39B in December 2022. Panel B of Figure 2 shows monthly volume traded on DEXs (in $) from January 2020 to April 2023. Uniswap v3 is the leading DEX with a market share of 58% in August 2022, followed by PancakeSwap with 11% and Curve with 8%. As Uniswap v3 is leading in terms of its market share among DEXs, we focus our analysis on this DEX in our paper."
        },
        {
            "heading": "2.2 Polygon entry",
            "text": "Whereas Ethereum is currently the most secure blockchain with a number of validators exceeding 500,000 as of December 2022, its main disadvantage is low scalability. Specifically, Ethereum can only handle 10-30 transactions per second (TPS), which results in high gas fees. For example, an estimated average of gas fees for a trade on Uniswap v3 amounts to $14 in 2022.12\n10In contrast to Uniswap v2, fees earned by LPs are no longer deposited in the pool as liquidity. Instead, fee earnings in Uniswap v3 are stored separately and can be withdrawn any time by LPs.\n11Source: The Block, https://www.theblock.co/data. 12See Appendix A.\nTo address the scalability issue, there exist overlays of Ethereum that offer higher speed and, consequently, lower gas fees. Polygon PoS (proof of stake), often simply referred to as Polygon, is one of the most adopted Ethereum scaling solutions. It can handle around 700 TPS13, up to 70 times Ethereum\u2019s TPS14. Polygon\u2019s gas fees are around $0.01 per transaction.15 Whereas Polygon allows for faster transaction processing and lower gas fees, it requires its own security and decentralization efforts that are not as robust as Ethereum\u2019s. Specifically, Polygon PoS is a sidechain secured by a proof-of-stake consensus mechanism. It is a sidechain, because all the staking management is defined on Ethereum, i.e. Polygon depends on Ethereum.16 The overall number of validators on Polygon is lower, but it still has a decent level of decentralization with over 100 unique validators. Fewer validators can achieve consensus more quickly, hence leading to a shorter time between blocks and higher overall throughput. Chemaya and Liu (2022) discuss in detail the trade-off between security and scalability of Ethereum scaling solutions, including Polygon.\nUniswap v3 launched on Polygon in December 2021.17 Polygon liquidity pools are separate to those on Ethereum, i.e. liquidity is fragmented across pools. Thus, the same liquidity pool, USDC/ETH 0.05% for example, can exist on both Ethereum and Polygon. Therefore, in our following analysis, we use the launch of Uniswap v3 on Polygon as an instrument to identify the effect of lower gas fees on liquidity.\nCurrently, Uniswap v3 has also launched on the following Ethereum scaling solutions: Optimism, Arbitrum, Celo and BNB Smart Chain. We conduct our study on Polygon for\n13Source: Polygon\u2019s blog, https://polygon.technology/blog/what-do-you-prefer-maximum-security-orcheaper-transactions.\n14Source: Binance Academy, https://academy.binance.com/en/glossary/transactions-per-second-tps.\n15Polygon\u2019s base gas fee is around $0.01 per transaction, but users can also add so-called gas tips to miners to prioritize the order of their transaction within the block. Still, most of transactions on Polygon only cost a few cents in gas fees.\n16While validators are required to stake MATIC tokens to secure the network, users stake them in an Ethereum smart contract while bridging assets to Polygon.\n17In addition to Uniswap v3, Polygon is widely used as a scaling solution by other DeFi protocols, such as Aave, Curve, SushiSwap, Balancer, etc.\nreasons of core data public availability. 18"
        },
        {
            "heading": "2.3 Trading mechanics: Uniswap v3",
            "text": "To set the stage, we first provide a brief introduction to trading mechanics on Uniswap v3. For reference, trading mechanics on Uniswap v2 are discussed in Appendix B. In Uniswap v2, liquidity deposited in the pool is uniformly distributed along the price curve, i.e. it is available for trading on the entire price range, [0,\u221e[. The advantage of this traditional implementation of AMM is that LPs earn fees irrespective of the market price. However, it requires a great amount of capital to be \u201clocked up\u201d in the pool without being \u201cactive\u201d, i.e. used in swaps. For example, prices close to infinity are definitely unrealistic, but the same amount of liquidity is reserved at these unrealistic prices than at the market price.\nUniswap v3 seeks to improve \u201ccapital efficiency\u201d of liquidity providers, by allowing them to \u201cconcentrate\u201d their liquidity on smaller price ranges. When they open a new liquidity position, i.e. deposit their tokens to a Uniswap v3 pool, they have to specify a price range, [pa, pb], where pa is the minimum price and pb the maximum price of token X in units of token Y at which their position is active. According to Uniswap v3 whitepaper (Adams et al., 2021), \u201ca position only needs to maintain enough reserves to support trading within its range, and therefore can act like a constant product pool with larger (virtual) reserves within that range\u201d.\nFigure 3 illustrates the notion of \u201cvirtual reserves\u201d. A position on a range of [pa, pb] and a market price pc \u2208 [pa, pb] only needs to hold a smaller amount of real X reserves, xreal, which are gradually depleted (i.e. swapped against Y reserves) until the market price, pc, reaches the upper price bound, pb. If the market price reaches pb, then all X reserves are depleted and the position is no longer active, i.e. stops earning fees. The position then consists only of Y reserves. Similarly, this position only needs to hold yreal reserves, which\n18We download historical logs of Polygon transactions (swaps, mints and burns on Uniswap v3) from BigQuery. Data for other Ethereum scaling solutions is currently not available.\nare gradually depleted until the market price reaches the lower price bound, pa, when Y reserves are depleted and the position becomes inactive. Should the pool price fall back to the specified price range, the liquidity position becomes active again. Thus, virtual reserves magnify real reserves in a way that the liquidity in the pool matches that of the market price range19.\n[Insert Figure 3 approximately here]\nThe price curve for Uniswap v3 is a modification of x \u00b7 y = k, such that the position is\nsolvent exactly within its price range, [plower, pupper] (Adams et al., 2021):\n( x+\nL \u221a pupper\n) (y + L \u221a plower) = L 2 (1)\nIn contrast to Uniswap v2, the amount of tokens deposited in a liquidity position is no longer in 50-50 ratio. In fact, it depends on the selected price range relative to the market price, with larger reserves of Y required if the price range is skewed to prices lower than the market price, pmkt. If the selected price range is strictly lower than the market price (and excludes it), then LP only has to deposit token Y. This case corresponds to point b being below point c on the price curve on Figure 3, i.e. pmkt > [plower, pupper]. Similarly, if the preferred price range is strictly higher than the market price, then LP only has to deposit token X. This case corresponds to point a being above point c on Figure 3, i.e. pmkt < [plower, pupper].\n[Insert Figure 4 approximately here]\nFigure 4 illustrates the latter scenario, i.e. an LP would like to add liquidity to USDC/ETH\n0.3% pool, with pmkt < [plower, pupper]. The preferred price range [0.00092,0.00107] ETH per\n19Heimbach et al. (2022) provide mathematical relations between real and virtual reserves and discuss them in more detail.\nUSDC is strictly above the market price of 0.000755 ETH per USDC. Therefore, an LP only has to add Y reserves to the pool, i.e. only ETH token20."
        },
        {
            "heading": "3 Data and summary statistics",
            "text": "Our sample consists of three most liquid pools on Uniswap v3 that are used for trading on both Ethereum and Polygon: USDC/(W)ETH 0.05%, USDC/(W)ETH 0.3% and (W)ETH/USDT 0.3%.21 Our sample period covers the calendar year following the launch of Uniswap v3 on Polygon, ranging from January 1, 2022 to December 31, 2022. The data source for trades (swaps) and liquidity providing events (mints/burns) is BigQuery. Table 1 compares volume and liquidity for the three pools across both Ethereum and Polygon. Specifically, we report the average traded volume over the previous 24 hours and the average liquidity size, measured as total value locked (TVL), both in $M.\n[Insert Table 1 approximately here]\nUnsurprisingly, both volume and TVL of all three pools on Ethereum significantly exceed those on Polygon. For example, the average 24-hour volume on Ethereum\u2019s most liquid pool, USDC/ETH 0.05%, is $589M, around 18 times higher than Polygon\u2019s $33M. Ethereum\u2019s average TVL of $174M is also around 16 times higher than Polygon\u2019s TVL of $10.8M. Notably, the turnover, measured as the ratio of volume to TVL, is approximately the same across both Ethereum and Polygon (as reported in the last column of Table 1). We observe much lower trading volume and TVL for the high-fee pool, USDC/WETH 0.3%. These\n20If an LP is only obliged to deposit either token X or token Y, he just indicates the preferred amount of this token. If the price range includes the market price, then he indicates the preferred amount of either X or Y to be deposited, and Uniswap v3 protocol then computes the required amount of the other token. The required amount of the other token is related to the \u201cskewness\u201d of the price range. If the price range is symmetrical around the market price, the amounts deposited are as on Uniswap v2, i.e. according to a 50-50 ratio.\n21Whereas ETH/USDT 0.05% pool exists on Ethereum, WETH/USDT 0.05% pool does not currently exist on Polygon. All pools on Polygon use wrapped ETH (WETH), as ETH is not the native token of Polygon. The native token of Polygon, MATIC, is not liquid on Ethereum - hence, we exclude it from our analysis.\nfindings are consistent with theoretical predictions of Lehar et al. (2022) that lower gas fees lead to lower fragmentation of liquidity across high- and low-fee pools. As gas fees on Polygon are relatively cheap at $0.01, it is optimal for LPs to actively manage their positions in the low-fee pool. Thus, most of liquidity provision takes place on the low-fee pool on Polygon.\n[Insert Table 2 approximately here]\nWe further provide summary statistics of trade sizes and trade frequencies across the two chains in Table 2. Panel A of this table shows that the average trade size on Ethereum is significantly larger for all three pools. For example, the average trade size for USDC/(W)ETH 0.05% on Ethereum is around $78K. In contrast, Polygon\u2019s average trade size for this pool is much lower, around $2.5K. We observe even lower trade sizes on Polygon for remaining two pools, USDC/(W)ETH 0.3% and (W)ETH/USDT 0.3%, most likely because of their overall lower TVL on Polygon. In contrast, we observe that pools with higher fees have higher TVL and larger average trade size on Ethereum. This finding is consistent with the theory of Hasbrouck et al. (2022) that pools with higher fees attract more liquidity providers, increasing their TVL and attracting larger trades.\nPanel B of Table 2 reports the average daily number of trades as well as the average daily number of purchases and sales across the two chains. Strikingly, Polygon has twice as many trades, around 13.5K per day, compared to Ethereum\u2019s 7.5K for USDC/(W)ETH 0.05%. For the other two pools, the number of trades is approximately the same across the two chains. For all pools, the order flow is balanced, i.e. the average daily number of buys is approximately equal to the average daily number of sells. We also report the average time between the trades (in seconds) in the last column. Overall, we conclude that the higher volume on Ethereum is mostly driven by larger trades being executed on this chain. In contrast, Polygon is rather used by smaller traders who trade more frequently.\nAs discussed in Section 2.2, Ethereum\u2019s larger liquidity can be explained by its higher security. Liquidity providers would like to minimize the risk of losing their funds, especially so for large liquidity deposits. Therefore, Ethereum is mostly used for large liquidity deposits,\nresulting in higher TVL. Large traders are also attracted to Ethereum, both due to its higher security and larger liquidity, which helps them reduce the slippage of their trades. Since gas fees are fixed, they are not of primary concern for large traders. In contrast, Polygon is rather attractive for smaller traders, who are primarily concerned about gas fees, and less so about security. Thus, we observe a separating equilibrium, in which large traders and LPs choose Ethereum due to its higher security, whereas small traders and LPs choose Polygon due to its lower gas fees."
        },
        {
            "heading": "4 Slippage on Uniswap v3: Ethereum vs Polygon",
            "text": "We start our analysis by comparing slippage for trades of different sizes both on Ethereum and Polygon. In this paper, we define slippage of a trade as the difference between the average execution price and the pre-execution market price:\nSlippage = \u2223\u2223\u2223 pavgpmkt \u2212 1\u2223\u2223\u2223\nIn other words, slippage shows by how much the execution price is worse than the previously displayed market price.22 Slippage is greater for larger trades and, as in Kyle (1985), is inversely related to market depth. 23 In this section, we first discuss our methodology of slippage computation on Uniswap v3. We then analyze slippage for trades of different sizes across the two chains in a multivariate setup."
        },
        {
            "heading": "4.1 Computing slippage on Uniswap v3",
            "text": "Adding liquidity to Uniswap v3 pools. On Uniswap v3, LPs are able to specify the price range on which their liquidity position will be active. To make this possible, the space of\n22Slippage is based on the average execution price. It differs from the definition of price impact in the market microstructure, computed as the difference between the post-execution market price and the preexecution market price. In this paper, we take the trader perspective for whom the average execution price is arguably of greater importance for estimating their execution cost.\n23Appendix C shows a numerical example of slippage computation on CEXs.\nprices is divided into discrete ticks, [i, i \u2208 Z]. According to Uniswap v3 whitepaper (Adams et al., 2021), there can be a tick at every price that is an integer power of 1.0001, such that the following relation holds for the price pi corresponding to tick i:\npi = 1.0001 i (2)\nSpecifically, this relation implies that each tick is 1 bp (basis point) away from its neighbouring ticks. However, not all ticks can be initialized, but only those that are divisible by a pre-specified pool parameter, the tick spacing s. For example, USDC/ETH 0.3% pool has a s of 60. Therefore, only ticks that are divisible by 60 can be initialized, i.e. (-120, -60, 0, 60, 120...)24. A tick range can then be defined as [i, i+ s].\nOne liquidity position of an LP can cover one or more tick ranges, [i, i+ s]. The liquidity on each tick range [i, i+ s], Li, is then an aggregation of all LP positions that are currently active on it. Therefore, aggregated liquidity in a Uniswap v3 pool is no longer constant (as in Uniswap v2), but fragmented across multiple tick ranges. Figure 5 illustrates a stylized distribution of liquidity on the price space for Uniswap v2 and Uniswap v3 (Adams et al., 2021).\n[Insert Figure 5 approximately here]\nLet pi denote price of token X (in units of token Y) that corresponds to tick i. From Uniswap v3 whitepaper (Adams et al., 2021), we obtain the following relations for xi, quantity of tokens X locked in the tick range [i, i+ s], and yi, quantity of tokens Y locked in the same tick range:\n24In general, lower values for s allow for more precise price ranges However, gas fees for swaps might be more expensive in pools with low s, because the trader is required to pay a constant gas fee for every initialized tick that the swap crosses.\nxi = Li\u221a zi \u2212 Li\u221a pi+s\n(3)\nyi = Li \u00b7 ( \u221a zi \u2212 \u221a pi) (4)\nwhere\nzi =  pi if pmkt \u2264 pi pmkt if pi < pmkt < pi+s\npi+s if pi+s \u2264 pmkt\nNumerical example. To illustrate, suppose that an LP would like to add liquidity to USDC/ETH 0.3% pool (with a s of 60). Assume the market tick is 200618, such that the market price is:\npmkt = 1.0001 200618\nTo convert prices to a human-readable format, we have to scale pmkt by 10 (dy\u2212dx), where dy is the number of decimals for token Y and dx is the number of decimals for token X. In our example, dy = 18 for ETH and dx = 6 for USDC:\npmktadj = 1.0001200618 10(18\u22126) = 0.00051558 ETH per USDC\nwhich corresponds to 1/0.00051558 = 1939.56 USDC per ETH\nSuppose an LP would like to add 50 ETH (token Y) to the price range [plower, pupper] that corresponds to tick range [ilower, iupper] = [200520, 200640], illustrated as Mint 1 on Panel A of Figure 6. Note that this range includes two corresponding elementary tick ranges: [200520, 200580] and [200580, 200640]. How many USDC (token X) does the LP have to add to complete their liquidity position?\n[Insert Figure 6 approximately here]\nTo compute the required quantity of tokens X, we first infer the liquidity Lpos of this\nposition from Equation (4):\nLpos = ypos\u221a\npmkt\u2212 \u221a plower\n= 50\u00b710 18\n\u221a 1.0001200618\u2212 \u221a 1.0001200520 = 4.505 \u00b7 1017\nwith zp = pmkt, because the position includes the market tick, plower < pmkt < pupper. Note that we have to rescale 50 ETH to \u201cUniswap v3\u201d format as follows: ypos = 50\u00b710dy = 50\u00b71018. Given Lpos, we can compute xpos from Equation (3):\nxpos = Lpos\u221a pmkt \u2212 Lpos\u221a pupper\n= Lpos \u221a pupper\u2212 \u221a pmkt\u221a\npmkt\u00b7 \u221a pupper\nAgain to convert to \u201chuman readable\u201d format, we have to scale xpos by 10 dx , i.e. xposadj =\nxpos/10 6 = 21812 USDC.\nSuppose there are two additional mints to the pool, as illustrated on Panel A of Figure\n6. Table 2 below summarizes all three liquidity positions in the pool:\nTo compute aggregated liquidity on each tick range, Li, we have to add up liquidity of all active liquidity positions, Lpos, on a given tick range. Panel B of Figure 6 shows distribution of aggregated liquidity by tick range. For example, there is only one active liquidity position on tick range [200520, 200580]. Therefore, Li = Lpos = 4.505e17. On the next tick range, [200580, 200640], all three liquidity positions are active, such that Li =\u22113 j=1 Lposj = 2.771e18. From Equations (3) and (4), we can then compute aggregated xi and yi liquidity reserves for each tick range [i, i+ s]. Table 3 below summarizes distribution of liquidity and reserves by tick range:\nreserves in one of the tokens, either X (if i > imkt), or Y (if i+ s < imkt).\nTrading on Uniswap v3. Suppose we would like to submit a trade to USDC/ETH 0.3% pool, i.e. swap tokens X and tokens Y. Let \u25b3x and \u25b3y denote the total quantities of tokens X and Y to be swapped in a trade (for example, if we would like to buy tokens X with tokens Y, we have \u25b3x < 0 and \u25b3y > 0). Since liquidity is fragmented along tick ranges, we have to consider separately every tick range that is necessary for trade execution. Let \u25b3xi and \u25b3yi denote the quantities of tokens X and Y to be swapped within a given tick range [i, i+ s]. Price curve in Equation (1) imposes:\n( xi +\u25b3xi +\nLi\u221a pi+s\n) \u00b7 (yi +\u25b3yi + Li \u00b7 \u221a pi) = ( xi +\nLi\u221a pi+s\n) \u00b7 (yi + Li \u00b7 \u221a pi) = L 2 i (5)\nfrom where we obtain the following for \u25b3xi and \u25b3yi:\n\u21d2  \u25b3xi = \u2212 \u25b3yi\u00b7(xi+ Li\u221api+s ) yi+\u25b3yi+Li\u00b7 \u221a pi \u25b3yi = \u2212\u25b3xi\u00b7(yi+Li\u00b7 \u221a pi)\nxi+\u25b3xi+ Li\u221api+s\n(6)\nNumerical example (continued). Assume the current distribution of liquidity in USDC/ETH 0.3% pool as on Panel B of Figure 6. Suppose we would like to buy ETH with 200K USDC. How many ETH can we get?\nWe know that \u25b3xi = 200K. Further, from Table 3 we know Li, xi and yi for the market\ntick range, [200580, 200640]. From Equation (6), we obtain for \u25b3yi:\n\u25b3yi = \u2212 200000\u00b7106(119.42\u00b71018+2.771\u00b71018\u00b7\n\u221a 1.0001200580)(\n134159\u00b7106+200000\u00b7106+ 2.771\u00b71018\u221a 1.0001200640\n) \u00b71018 = \u2212102.94 ETH\nOverall, we obtain 102.94 ETH with 200K USDC. Therefore, the average execution price\nis pavg = \u25b3y \u25b3x = 102.94 200000 = 0.0005147 ETH per USDC. The slippage of this trade is:\nSlippage = \u2223\u2223\u2223 pavgpmkt \u2212 1\u2223\u2223\u2223 = \u2223\u22230.000514700.00051558 \u2212 1\u2223\u2223 = 0.0017 = 17 bp\nTick-crossing trades on Uniswap v3. In the numerical example above, we could execute the whole trade within the market tick range, because the reserves of Y in this tick range were sufficient, i.e. 119.42 > 102.94. Below we provide general formulas for trades that are too large to be executed within a single tick range and involve crossing several ticks.\nSuppose we would like to sell tokens X (USDC) for tokens Y (ETH). We are adding\n\u25b3x > 0 to the pool and withdrawing \u25b3y < 0.\nFor a given tick range [i, i+s], denote by \u25b3xmaxi the maximum quantity of tokens X that you can add to this range (by taking reserves of token Y). Let \u25b3ymini denote the minimum quantity of tokens Y that you can \u201cadd\u201d to this range - or, in other words, the maximum quantity of tokens Y than you can take from this range by adding tokens X. From liquidity distribution of the pool, we know reserves yi for each tick range, such that \u25b3ymini = \u2212yi. We can then compute \u25b3xmaxi using Equation (6):\n \u25b3ymini = \u2212yi\n\u25b3xmaxi = \u2212 \u25b3ymini \u00b7 (xi + Li\u221api+s ) yi +\u25b3ymini + Li \u00b7 \u221a pi = xiyi Li \u00b7 \u221a pi + yi\u221a pipi+s\nLet {istart, istart \u2212 s, ..., iend} be the lower ticks of the consecutive tick ranges that we use during the trade. We consume all available liquidity in the tick ranges of lower ticks i \u2208 {istart, istart\u2212 s, ..., iend+ s}, and spend our remaining tokens X in the tick range of lower tick iend, such that \u25b3x and \u25b3y can be expressed as follows:\n \u25b3x = \u2211 i\u2208{istart,istart\u2212s,...,iend+s} \u25b3xmaxi +\u25b3xiend \u25b3y = \u2211\ni\u2208{istart,istart\u2212s,...,iend+s}\n\u25b3ymini +\u25b3yiend\n\u21d2  \u25b3xiend = \u25b3x\u2212 \u2211 i\u2208{istart,istart\u2212s,...,iend+s}\u25b3x max i \u25b3y (6)= \u2212 \u2211 i\u2208{istart,istart\u2212s,...,iend+s} yi \u2212 \u25b3xiend \u00b7(yiend+Liend \u00b7 \u221a piend )\nxiend+\u25b3xiend+ Liend\u221a piend+s\n(7)\nNumerical example (continued). To illustrate a tick-crossing trade, suppose we would now like to buy ETH with a larger quantity of 250K USDC. How many ETH can we get?\nWe first start computing \u25b3xmaxi for the market tick range, [200580,200640], given the\ncurrent reserves yi = 119.42 ETH and xi = 134159 USDC:\n\u25b3xmaxi = xiyi Li\u00b7 \u221a pi + yi\u221a pipi+s = 134159\u00b710 6\u00b7119.42\u00b71018 2.771\u00b71018\u00b7 \u221a 1.0001200580 + 119.42\u00b710 18 \u221a 1.0001200580\u00b71.0001200640\n\u25b3xmaxi,adj = \u25b3xmaxi 106 = 232064 USDC\nThis means that we can spend 232064 USDC in the market tick range, swapping them for the full amount of 119.42 ETH reserves. Therefore, we are left with \u25b3xiend = 250K \u2212\n232064 = 17936 USDC to spend in the next (lower) tick range, [200520,200580]25.\nFrom Equation (7), we can now compute \u25b3y :\n\u25b3y = \u2212119.42 \u00b7 1018 \u2212 17936\u00b710 6(30.58\u00b71018+4.505\u00b71017\u00b7\n\u221a 1.0001200520)\n0+17936\u00b7106+ 4.505\u00b71017\u221a 1.0001200580\n\u25b3yadj = \u25b3y1018 = \u2212128.63 ETH\nOverall, we obtain 128.63 ETH with 250K USDC. Therefore, the average execution price\nis pavg = \u25b3y \u25b3x = 128.63 250000 = 0.00051452 ETH per USDC. The slippage of this trade is:\nSlippage = |0.00051452 0.00051558 \u2212 1| = 0.0021 = 21 bp\nAppendix D provides general formulas for an opposite trade direction, i.e. buying tokens\nX with tokens Y and derivations of slippage on Uniswap v2."
        },
        {
            "heading": "4.2 Slippage: Ethereum vs Polygon",
            "text": "Summary statistics. For each minute in our sample period (January 1 - December 31, 2022), we compute slippage, Slippage, for hypothetical trades of sizes [$100, $500, $1K, $5K, $10K, $50K, $100K, $500K, $1M]. We use end-of-minute liquidity distribution, separately for Ethereum and Polygon. Table 3 presents summary statistics for Slippage (in bp), averaged across the three pools. We also report summary statistics for the average traded volume over the previous 24 hours, V olume (in $M); the average realized volatility of ETH/USD over the previous 24 hours, V olatility, (in %); and the average one-minute return, Return (in bp), which we use later as our control variables. Appendix E provides a detailed description of all variable definitions.\n[Insert Table 3 approximately here]\nGiven Ethereum\u2019s overall larger liquidity, it is not surprising that its average slippage of 5.93 bp is significantly lower than Polygon\u2019s 700 bp. The median slippage on Polygon is\n25In this simple example, our trade of 250K only crosses one tick. Therefore, there is only one term in the sum \u2211 i\u2208{istart,istart\u2212s,...,iend+s} \u25b3x max i .\nalso higher, 9.35 bp, as compared to Ethereum\u2019s 0.29 bp. However, these statistics represent the average across both small hypothetical trades of $100, $500, etc. and large hypothetical trades of up to $1M. As Polygon is mostly used by smaller traders, the main focus of our analysis will be the comparison of slippage for small trades across Ethereum and Polygon.\nMultivariate tests: small vs large trades. We expect that slippage for smaller trades should be lower on Polygon due to higher concentration of liquidity positions around the market price. Polygon\u2019s lower gas fees allow liquidity providers to update their positions more frequently. Should a permanent price change occur, LPs can withdraw and re-deposit their positions around the new market price more quickly and at a cheaper cost. Thus, higher speed and lower gas fees on Polygon help LPs better protect their positions from adverse selection by arbitrageurs. Being able to better protect themselves, LPs can earn higher fees on Polygon (for the same deposited amount) by concentrating their positions around the market price. Higher liquidity concentration around the market price benefits small traders, by reducing the slippage of their trades.\nIn contrast, LPs should post their liquidity on wider price ranges on Ethereum, given its significantly higher gas fees. If it is costly for LPs to update their position, posting on a wider range provides better protection from adverse selection. Therefore, we expect less frequent updating on Ethereum, with LPs posting their positions on wider ranges and updating them only if the market price significantly deviates from them. Wider liquidity positions should then result in less concentrated liquidity on Ethereum, which increases slippage for small trades. For large trades, Ethereum\u2019s large TVL, which corresponds to overall market depth on CEXs, is still of first-order importance, as compared to liquidity concentration.\nTo test our predictions above, we first estimate following OLS regressions, separately for\neach pool:\nSlippagei,t = \u03b1 + \u03b21Polygoni,t + \u03b22Sizei,t +\n+ \u03b23Buyi,t + \u03b24|Return|i,t + \u03b25V olumei,t + \u03b26V olatilityi,t\n+ HourFE +DayFE + \u03b5i,t.\nThe dependent variable, Slippage, shows the slippage for a trade of a given size for pool i in minute t (from the end-of-minute snapshot of liquidity distribution). The first right-hand side variable, Polygon, equals 1 for transactions on Polygon, and zero otherwise. Observations on Ethereum serve as a benchmark sample. The vector of control variables includes trade size (in $K), Size; the direction of the trade, Buy, that equals 1 for purchases of token X and 0 for its sales; trading volume over previous 24 hours (in $M), V olume; realized volatility of ETH/USD over previous 24 hours, measured as the sum of squared one-minute returns, V olatility; and absolute return of ETH/USD over the previous minute, |Return|. All regressions include hour- and day-fixed effects and allow standard errors to cluster at the day level.\n[Insert Table 4 approximately here]\nPanel A of Table 4 reports results for USDC/(W)ETH 0.05% pool. The coefficient on Polygon in Model (1) shows that slippage on Polygon is on average 18.38 bp higher, relative to the average slippage of 2.67 bp on Ethereum. Unsurprisingly, slippage is increasing in the size of the trade. It is 3.69 bp lower for buys of token X than for its sells, suggesting that LPs post relatively larger liquidity in USDC to the pool, compared to ETH. Further, slippage is decreasing in the volume traded, implying that LPs deposit more liquidity if they observe higher volume over previous 24 hours. This finding is consistent with our prior expectations, because LPs can earn higher fees in periods of higher volume. Finally, slippage is increasing in both the absolute return of ETH/USD over the previous minute and the realized volatility\nover previous 24 hours. These findings are also in line with our expectations, suggesting that LPs are more likely to withdraw liquidity from the pool during times of higher uncertainty.\nAs the main focus of our study are small trades, we next condition our analysis on trade size. We split all trade sizes into two categories: \u201csmall\u201d, which we define as trade sizes up to $1K (Model 2); and \u201clarge\u201d - as those that exceed this cutoff. In Model (2), we add a dummy variable Large that equals 1 for large trades and zero otherwise. We also add its interaction term with Polygon, Polygon \u00b7 Large, that captures the relative difference in slippage of large trades on Polygon, relative to Ethereum. The coefficient on Polygon now captures the relative difference in slippage of small trades between Ethereum and Polygon, and is of main interest in our analysis. As Large is mechanically related to Size, we omit Size from the vector of our control variables in Model (2).\nWe observe a positive and significant coefficient on Large in Model (2), suggesting that large trades on Ethereum (i.e. those in excess of $1K) have on average 3.99 bp higher slippage, compared to small trades. Importantly, we observe coefficients of different signs on Polygon and Polygon \u00b7 Large. The negative coefficient on Polygon shows that slippage of small trades (less than $1K) on this chain is by around 20 bp lower, compared to small trades on Ethereum. The positive coefficient on the interaction term, Polygon \u00b7 Large, shows that large trades on Polygon have a significantly higher slippage of 57 bp, relative to large trades on Ethereum. Hence, the overall positive coefficient on Polygon in Model (1) is driven by significantly higher slippage for larger trades. Once we condition on trade size, we observe significantly lower slippage for small trades on Polygon. These findings strongly support our predictions above of lower slippage for small trades on Polygon.\nModels (3) and (4) report similar results, using $5K and $10K cutoffs to split trades into small and large categories, respectively. Our main findings still hold, irrespective of the cutoff that we use to define large trades. As three quarters of all trades are lower than $3K on Polygon (from Table 2), our cutoffs represent a valid split of all trades into small and large categories across the two blockchains.\nModels (5) and (6) are similar to previous Models (1) and (3), but use the total cost of trade execution as the dependent variable. We measure the total execution cost as the sum of slippage (in bp) and gas fees (in bp) for executing a trade on Uniswap v3.26 Since a gas fee represents a fixed cost per transaction, we expect gas fees to contribute significantly to execution cost of smaller trades, whereas they should be of less importance for larger trades.\nAssuming that each trade on Uniswap v3 requires on average 120K gas units on Ethereum, we estimate daily average gas fees by multiplying the daily average gas price, downloaded from Etherscan, by 120K.27 Gas fees on Polygon cost around $0.01 per transaction. Predictably, lower gas fees on Polygon result in significantly lower total execution cost of 307 bp on Polygon for smaller trades (Model 6). For large trades, the effect of higher slippage outweighs the effect of lower gas fees, leading to significantly higher execution cost of 530 bp.\nPanels B and C show corresponding results for USDC/(W)ETH 0.3% and (W)ETH/USDT\n0.3%, respectively. To preserve space, we do not report coefficients on control variables, but they are included in all regressions. The effects for USDC/(W)ETH 0.3% are practically the same as for USDC/(W)ETH 0.05% (Panel A), both in terms of statistic and economic significance. For (W)ETH/USDT 0.3%, we find that slippage for smaller trades on Polygon does not differ significantly, relative to small trades on Ethereum, irrespective of the cutoff (Models 2-4). However, this is still an important result, given that TVL of WETH/USDT on Polygon is only $0.34M, compared to Ethereum\u2019s $81.57M (from Table 1).\nOverall, our findings in this section confirm our predictions that small trades on Polygon have significantly lower slippage, relative to small trades on Ethereum. The total execution cost of small trades is further diminished by low gas fees on Polygon. In contrast, large trades have significantly lower slippage on Ethereum due to its larger liquidity (higher TVL).\n26In this computation, we omit the exchange fee (i.e., 0.05% for USDC/(W)ETH 0.05%), which is also paid by traders to LPs, because it is equal across Ethereum and Polygon.\n27Appendix A provides more detailed computations and shows variation of gas fees on Ethereum in our sample period.\nWhereas gas fees are higher on Ethereum, they are not of first-order importance for large trades, because they represent a fixed cost. The effect of lower slippage outweighs the effect of higher gas fees for large trades on Ethereum. In the next section, we test more explicitly whether more frequent repositioning affects liquidity concentration (and, thus, slippage) on DEXs."
        },
        {
            "heading": "5 Repositioning and liquidity concentration",
            "text": ""
        },
        {
            "heading": "5.1 Repositioning intensity and liquidity concentration",
            "text": "So far, our results show that small trades on Polygon have overall lower slippage, compared to Ethereum. We hypothesize that this effect can be explained by higher liquidity concentration around the market price on Polygon, driven by more frequent position updating by LPs. In the following, we refer to the position updating frequency of LPs as repositioning intensity. In this section, we would like to explicitly test the causal relation between repositioning intensity and liquidity concentration on DEXs. The straightforward approach to test this association is by regressing liquidity concentration on repositioning intensity and other variables, controlling for market conditions. However, the choice of an LP to update their position, i.e. burn and subsequently mint at a new price range, is potentially endogenous, and can in itself depend on the current liquidity concentration in the pool. Hence, the slope coefficient on repositioning intensity from standard OLS estimation would represent a biased estimate of its causal effect on liquidity concentration.\nTo identify the causal effect of repositioning intensity, we use the entry of Polygon as our instrument for an exogenous increase in updating frequency of LPs. For any instrument to be valid, it has to satisfy two criteria. First, the instrument must be correlated with the endogenous explanatory variable, i.e. it should induce change in the explanatory variable. Second, it must satisfy the exclusion restriction, i.e. it should not be correlated with the error term in the explanatory equation. We expect the first condition to hold, because an\nexogenous decrease in gas fees on Polygon should result in more frequent repositioning by LPs. We show that this is indeed the case in our following analysis in Tables 6 and 7. For exclusion restriction to hold, Polygon entry should not affect liquidity concentration other than through its effect on repositioning intensity. We argue that such correlation with the error term is rather unlikely, because it would mean that Uniswap v3 chose its entry date on Polygon strategically and was able to accurately predict a market-wide increase in liquidity concentration. Our setup is similar to Hendershott et al. (2011), who use the introduction of NYSE Autoquote as an instrument for an exogenous increase in algorithmic trading, and investigate its causal effect on liquidity.\nLiquidity concentration. We start by comparing liquidity concentration around the market price across Ethereum and Polygon in Table 5. Specifically, we define liquidity concentration within x% of the market price, as the market depth within x% of pmkt, divided by TV L. Market depth within x% of pmkt is computed as the $ value of the liquidity between pmkt 1+x% and pmkt \u00b7 (1 + x%).\n[Insert Table 5 approximately here]\nColumn (1) reports average levels of liquidity concentration within 1% of the market price, separately for Ethereum and Polygon. Columns (2) and (3) report corresponding statistics for liquidity concentration within 2% and 10% of the market price, respectively. Liquidity concentration mechanically increases with the percentage band, i.e. market depth, scaled by TVL, within 10% of the market price is by construction higher than within 1% of the market price. More surprisingly, only around 22%-37% of all liquidity is concentrated within 10% for all pools. Hence, around two thirds of TVL are further away than 10% from the market price across all pools. We also report the difference between average liquidity concentration on Polygon and Ethereum and t-statistics of the two-tailed t-test with the null-hypothesis of difference equaling zero. Consistent with our expectations, we find strong evidence for higher liquidity concentration on Polygon across all percentage bands and across\nall pools. T-statistics range between 51.04 and 320.00, confirming that all differences are statistically significant.\nLiquidity provision and repositioning intensity. We further examine differences in liquidity provision and repositioning intensity across Ethereum and Polygon in Table 5. For all our analyses of liquidity provision, we filter out liquidity mints and burns, for which the mid price of their range, computed as \u221a plower \u00b7 pupper, lies further than 20% away from the market price. We treat these mints and burns as outliers and exclude them from our analysis.28 We further exclude so-called \u201cjust-in-time\u201d (JIT) liquidity positions, which are used to provide \u201cflash\u201d liquidity within the same block to large trades on Ethereum towards the end of our sample.29 JIT positions represent around 15% of our sample on Ethereum and only negligible percentage on Polygon. We exclude them, since this \u201cflash\u201d liquidity does not affect TVL and thus, liquidity concentration, which is our main variable of interest. Further, JIT liquidity provision only benefits a few large traders on Ethereum, and is generally not used to provide liquidity for small trades.\n[Insert Table 6 approximately here]\nWe report the average daily number of mints for each chain in column (1) and the average daily number of burns in column (4). We observe significantly more frequent minting and burning of liquidity on Polygon for USDC/(W)ETH 0.05% pool. A mint on Polygon takes place on average every 2.81 minutes and a burn every 4.44 minutes, as compared to Ethereum\u2019s 17.16 and 43.86 minutes, respectively (see columns 2 and 5). The daily minted value on Polygon of around $35M approximately equals $29M minted daily on Ethereum (column 3). The daily burned value on Polygon is also around $35M, whereas the daily burned value on Ethereum is significantly lower, just around $15.7M (column 6).\n28These positions represent around 13% of our overall sample. Our main findings continue to hold irrespective of the cutoff that we use to filter out outliers (for example, 10% or 30% away from the current price). Minting and burning with the mid price far away from the current market price could potentially be used by \u201cwash LPs\u201d, who aim to artificially increase TVL in the pool for improving its overall statistics.\n29Lehar et al. (2022) also exclude JIT positions from their analysis. JIT positions involve minting liquidity just before the large trade and subsequently burning the position, all within the same block.\nFor USDC/(W)ETH 0.3% and (W)ETH/USDT 0.3%, the daily number of mints is approximately the same across Ethereum and Polygon. Mints occur every 15 minutes for USDC/(W)ETH 0.3% and every 100-120 minutes for (W)ETH/USDT 0.3%. The daily minted value is much lower on Polygon, which is consistent with our prior findings of overall lower TVL for high-fee pools on Polygon. Consequently, the daily burned value is also lower for high-fee pools on Polygon. These findings further support predictions of \\textcite{lehar2022liquidity} that all liquidity mostly consolidates in the low-fee pool in presence of low gas fees.\nWhereas the daily minted and burned values on Polygon do not significantly exceed those on Ethereum, they are more balanced on Polygon, i.e. the average daily minted value is approximately equal to the average daily burned value on Polygon. In contrast, the average daily minted value significantly exceeds the burned value on Ethereum for all pools. More balanced values on Polygon suggest more intense liquidity repositioning, with liquidity providers burning and reminting their positions in response to changes in the market price.\nWe next measure repositioning intensity, Intensity, more explicitly, using the following\nformula:"
        },
        {
            "heading": "Intensity = 1\u2212 |Minted\u2212Burned|",
            "text": "Minted+Burned\n(8)\nWe use 5 minutes as our benchmark time interval for computing intensity, but our main results also hold if we aggregate to 10 minutes or hourly instead.30 Intensity can take values between 0 and 1, with higher values associated with more intense repositioning. For example, if the minted value within 5 minutes is exactly equal to the burned value, then intensity equals 1, or 100%. If there are only mints within 5 minutes, but no burns, then intensity equals 0.31\n30One-minute intervals are too frequent for our purposes, because the average time between mints on Polygon is around 2.81 minutes on USDC/WETH 0.05%, which is already the most liquid pool.\n31Our current data for Polygon does not allow us to identify liquidity providers. Hence, we measure\nColumn (7) of Table 6 presents the average 5-minute repositioning intensity (in %) across Ethereum and Polygon. For USDC/(W)ETH 0.05%, the repositioning intensity on Polygon is around 18% higher, which represents a 100% increase relative to the average level of 17% on Ethereum. As expected, for USDC/(W)ETH 0.3% and (W)ETH/USDT 0.3%, we observe overall lower levels of intensity on both chains, as compared to the low-fee USDC/(W)ETH 0.05% pool. Importantly, intensity on Polygon is significantly higher for these pools, relative to intensity on Ethereum. Thus, there is significantly more repositioning taking place on Polygon, driven by lower gas fees on this chain.\nInstrumental variable (IV) regressions. We proceed with testing the causal relation between repositioning intensity and liquidity concentration, using Polygon as an instrument for an exogenous increase in Intensity. We first estimate the following first-stage regression, separately for each pool:\nIntensityt = \u03b1 + \u03b21Polygont +\n+ \u03b24|Return|t + \u03b25V olumet + \u03b26V olatilityt\n+ HourFE +DayFE + \u03b5i,t,\nwhere Intensity and |Return| are measured over 5-minute intervals. V olume is the volume over previous 24 hours and V olatility is the realized volatility over previous 24 hours, both measured at the end of each 5-minute interval. All regressions include hour- and day-fixed effects and allow standard errors to cluster at the day level.\n[Insert Table 7 approximately here]\nModel (1) in Panel A of Table 7 reports the results for USDC/(W)ETH 0.05%. The coefficient of 0.18 on Polygon implies that repositioning intensity is 18% higher on Polygon\naggregate repositioning intensity within a given time interval.\nfor this pool, consistent with our previous statistics from Table 6. repositioning intensity on Polygon is also significantly higher for USDC/(W)ETH 0.3% and (W)ETH/USDT 0.3% by 9% and 5% (Panel B and C, respectively).\nModels (2)-(4) report results for the second-stage regression:\nLiquidityConcentrationt = \u03b1 + \u03b21Intensityt +\n+ \u03b24|Return|t + \u03b25V olumet + \u03b26V olatilityt\n+ HourFE +DayFE + \u03b5i,t,\nLiquidity concentration is measured at the end of each 5-minute interval. The set of instruments consists of all explanatory variables, except that we use Polygon in place of Intensity. For all pools, Polygon instrument shows that an increase in repositioning intensity significantly increases liquidity concentration within 1%-10% of the market price (Models 2- 4, respectively). The IV estimate of 0.10 on Intensity variable in our benchmark Model (3) of Panel A means that a 1% increase in Intensity increases liquidity concentration by 10% for USDC/(W)ETH 0.05% pool. The average standard deviation for Intensity is 0.3746 for this pool, such that a one-standard deviation change in Intensity is associated with a 0.3746 \u00b7 0.10 = 0.0374 or 3.74% change in liquidity concentration. This value represents a nearly 40% increase from the mean liquidity concentration (within 2% of the market price) of 9.82% on Ethereum.\nFurther, we observe that the effect of repositioning intensity on liquidity concentration increases with the percentage band, i.e. it affects liquidity concentration within 10% to a larger extent than within 1%. This effect is most likely due to more repositioning taking place within 10% of the market price, as opposed to repositioning within 1%. We also observe a stronger effect of intensity for high-fee pools in Panel B and C, with coefficients of 0.37 and 0.35 in our benchmark Model (3), respectively. Table 6 shows that these pools have\noverall lower levels of repositioning intensity, hence the effect of a 1% increase in intensity appears stronger for these pools. We repeat our analysis from Model (3), using 10-minute intervals instead of 5-minute intervals. The results are very similar to Model (3) across all pools. Thus, we only report results for 5-minute intervals in the remainder of our analysis."
        },
        {
            "heading": "5.2 Repositioning precision and liquidity concentration",
            "text": "So far, we use Polygon as an instrument for an exogenous increase in repositioning intensity to show that there is a causal relation between repositioning intensity and liquidity concentration around the market price. However, it could be that liquidity providers do not necessarily reposition close to the new market price. Our measure of repositioning intensity does not take into account whether liquidity positions are centered around the market price or not. Further, a position might be centered around the market price, but it could also have a wide price range, which should not necessarily result in higher liquidity concentration. To address these issues, we next focus our analysis on repositioning precision, which we define as the distribution of liquidity positions around the market price.\nSpecifically, we use three measures for repositioning precision: position gap, position length and position concentration. Our first measure is PositionGap, computed as \u2223\u2223\u2223 pmidpmkt \u2212 1\u2223\u2223\u2223, where pmid is the mid price of the position. For each position, posted on the range [plower, pupper], we compute pmid as \u221a plower \u00b7 pupper. The lower the position gap, the closer the mid price of minted positions to the market price. Therefore, PositionGap is inversely related to repositioning precision. We report the dollar-weighted average position gap (in %) across all minted positions within a given 5-minute interval, separately for Ethereum and Polygon, in Column (1) of Table 8.\n[Insert Table 8 approximately here]\nFor USDC/(W)ETH 0.05%, we observe the average position gap of 2.65% on Ethereum, i.e. liquidity providers mint their positions on average 2.65% away from the market price.\nConsistent with our prior expectations, we find that the average position gap on Polygon is significantly lower by 0.66%, which represents an improvement in repositioning precision of around 25%. For high-fee pools, the average position gap on Ethereum is higher, 3.65%- 3.89%. However, we observe significant precision improvement on Polygon for these pools by 0.63%-0.71%.\nOur second measure of repositioning precision is PositionLength, computed as |pupper\u2212plower| pmid\nfor each position. The shorter the position length, the narrower the position is. Similar to PositionGap, it is inversely related to repositioning precision. We report the dollar-weighted average position length (in %) across all minted positions within a given 5-minute interval, separately for Ethereum and Polygon, in Column (2) of Table 8. We observe that positions are significantly narrower by 5.6% on Polygon for USDC/(W)ETH 0.05%, relative to the average value of around 20% on Ethereum. For high-fee pools, they are overall substantially wider on Ethereum, in the range of 70%. This result is consistent with more passive liquidity providers (with lower repositioning intensity) posting wider ranges on high-fee pools to protect themselves from adverse selection. Importantly, we observe substantially narrower positions in these pools on Polygon by 34%-47%. This substantial reduction in position length for high-fee pools is due to lower gas fees on Polygon. With low gas fees, it is cheaper, even for relatively more passive (i.e. retail) liquidity providers, to update their positions, protecting themselves from adverse selection.\nThe previous two measures look separately at the mid price of the position range and on its length. Our third measure, PositionConcentration, combines the previous two to address a potential criticism that positions with lower gaps could potentially be wider, or, alternatively, narrower positions could be posted further away from the market price. We compute PositionConcentration as 1 PositionGap\u00b7PositionLength and further scale it to lie in the range [0,1] as 1\u2212 1.0001 \u22121 PositionGap\u00b7PositionLength . As for other measures, we compute the dollarweighted average position concentration across all minted positions within a given 5-minute interval. Repositioning precision increases in PositionConcentration with the highest pos-\nsible value of 1, or 100%. Column (3) of Table 8 shows that position concentration is indeed significantly higher on Polygon. On USDC/(W)ETH 0.05%, position concentration is higher by 11.5%, which is around one third relative to the average value of 36.3% on Ethereum. As expected, position concentration is generally lower on high-fee pools, but it also improves by 5%-13% on Polygon.\nOverall, our results show that not only liquidity providers post their positions closer to the market price on Polygon, but they also post them at significantly narrower ranges, especially so in high-fee pools. Thus, lower gas fees on Polygon result in both higher repositioning intensity and higher repositioning precision, i.e. higher position concentration around the market price.\nInstrumental variable (IV) regressions. In the last step of our analysis, we test the causal relation between repositioning precision and liquidity concentration. We expect higher repositioning precision to result in higher liquidity concentration. However, similar to repositioning intensity, repositioning precision is endogenous. To address this issue, we use the entry of Polygon as our instrument for an exogenous increase in repositioning precision. Since LPs are able to reposition more frequently on Polygon, they are better able to protect themselves from adverse selection. Hence, for the same amount of capital deposited, LPs can maximize their rewards from liquidity provision by improving the precision of their positions, i.e. minting positions that are more concentrated around the market price on Polygon. Indeed, our findings from Table 8 show that repositioning precision is significantly higher on Polygon.\nWe re-estimate our previous instrumental variables regressions, with Polygon now used\nas an instrument for Precision. Table 9 reports results for second-stage regressions:\nLiquidityConcentrationt = \u03b1 + \u03b21Precisiont +\n+ \u03b24|Return|t + \u03b25V olumet + \u03b26V olatilityt\n+ HourFE +DayFE + \u03b5i,t,\nwith liquidity concentration within 2% of the market price as the dependent variable.32 Model (1) shows results with PositionGap as a measure of Precision. Consistent with our expectations, higher position gap reduces liquidity concentration. The average standard deviation for PositionGap is 0.0336 for USDC/(W)ETH 0.05%. Therefore, the IV estimate of -3.08 means that a one-standard deviation increase in PositionGap is associated with a 0.0336 \u00b7\u22123.08 = \u22120.1034 or 10.34% decrease in liquidity concentration. As expected, we also observe a significant and negative effect of PositionLength (Model 2) and a significant and positive effect of PositionConcentration (Model 3) on liquidity concentration for all pools.\nWe further split all liquidity positions into those that are closed (burned) within the same day and those that are outstanding for at least one day. We refer to the former as intraday positions and to the latter as multiday positions. On Ethereum, only around 4-6% of daily minted value is associated with intraday positions. In contrast, intraday positions on Polygon account for around 35% of daily minted value for USDC/WETH 0.05% and around 20% for USDC/WETH 0.3% and WETH/USDT 0.3%. We re-estimate our Model (3) with PositionConcentration as a measure of Precision, separately for intraday positions and multiday positions. Models (4) and (5) present the corresponding results. We expect that repositioning precision of intraday positions has a stronger effect on liquidity concentration. Indeed, we observe that the coefficient of 0.42 on PositionConcentration is double as high for intraday positions in USDC/(W)ETH 0.05% pool, compared to 0.21 for multiday positions.\n32We do not report the first-stage regressions to conserve space, but we confirm that Precision is significantly higher on Polygon (available upon request). All our results also hold if we use liquidity concentration within 1% or 10% as the dependent variable.\nFor high-fee pools, we observe an opposite result, i.e. we observe stronger effect of multiday positions on liquidity concentration. This finding goes against our initial expectations, but can possibly be explained by the fact that there is less need for LPs to update positions within the same day in these pools, because the rewards are higher.\nTo sum up, our results in this section show that both repositioning intensity and precision increase liquidity concentration around the market price on Uniswap v3 pools. As both these variables are potentially endogenous, we use the entry of Polygon as an instrument to identify the causal effect of repositioning intensity and precision on liquidity concentration. An increase in liquidity concentration is especially important for the execution of small trades. Higher concentration around the market price reduces their slippage, as we show in Section 4. Thus, Polygon, alongside other Ethereum scaling solutions, is especially attractive for small traders and liquidity providers."
        },
        {
            "heading": "6 Conclusions",
            "text": "Liquidity providers (LPs) on decentralized exchanges (DEXs) can protect themselves from adverse selection by either setting a wide price range for their position or by updating it more frequently, in response to changes in the market price. However, updating is costly, because every repositioning from an LP requires the payment of a fixed cost (a gas fee) to blockchain validators. Blockchain scaling solutions, such as Polygon, allow for more frequent updating by LPs due to their lower gas fees. With more frequent updating, LPs are better able to track the market price and protect themselves from adverse selection. Thus, for the same amount of capital deposited in the pool, they can maximize their rewards by making their positions more concentrated around the market price. In this paper, we use the entry of Polygon as an instrument to show that higher repositioning intensity and precision of LPs leads to higher liquidity concentration.\nHigher liquidity concentration around the market price is important, because it reduces\nslippage, especially for small trades. Indeed, we find that slippage of small trades (up to $10K) is significantly smaller on Polygon, relative to the incumbent Ethereum. Thus, liquidity pools on Polygon provide better execution terms for small trades. However, these benefits come at a cost of Polygon\u2019s lower security, compared to Ethereum. Due to its higher security, Ethereum attracts larger liquidity providers, resulting in higher TVL. Therefore, slippage of large trades is lower on Ethereum as liquidity pools are on aggregate deeper. Further, high gas fees on Ethereum, due to their fixed nature, are of lower importance for large traders. Thus, similar to separating equilibrium, we observe that large traders and liquidity providers are attracted to Ethereum, whereas small (e.g. retail) traders and liquidity providers are better off using blockchain scaling solutions."
        },
        {
            "heading": "Appendix A",
            "text": ""
        },
        {
            "heading": "Estimating gas fees",
            "text": "Any transaction on a blockchain requires the payment of gas fees, which are used to compensate validators for their work in verifying transactions and securing the network.\nGas fees are computed with the quantity of gas units required, which depends on the transaction. For example, a trade on Uniswap v3 (Ethereum) requires on average 120K gas units.\nThe price of one gas unit, the gas price, varies over our sample period, as shown in Panel A of Figure A1. Panel B shows the gas fees to pay for a hypothetical trade on Uniswap v3 (Ethereum) that requires 120K gas units. These fees vary from as little as $1.30 in October 2022 to $160 during the period of Terra collapse in early May 2022. On average, a trade that requires 120K gas units on Uniswap v3 (Ethereum) costs $14 in gas fees during our sample period (January - December 2022)."
        },
        {
            "heading": "Appendix B",
            "text": ""
        },
        {
            "heading": "Trading mechanics on Uniswap v2",
            "text": "Uniswap v2 is a constant product market maker (CPMM), which is the most widely adopted subclass of automated market makers (AMMs). The price curve, or so-called bonding curve, is defined as:\nx \u00b7 y = k (9)\nwhere x is the current quantity of token X, the base token in the pool (e.g., BTC for BTC/USDT pair), y is the current quantity of token Y, the quote token (e.g., USDT for BTC/USDT pair) and k is the pool\u2019s constant, showing the total liquidity available in the pool. In absence of mints and burns, pool\u2019s constant k has to preserve its value. For example, a trade (or swap) that buys BTC with USDT will remove \u25b3x of BTC from the pool and add \u25b3y of USDT to the pool. Denote the new amount of BTC in the pool after the trade as x\u2032, i.e. x\u2032 = x+\u25b3x, and the new amount of USDT as y\u2032, i.e. y\u2032 = y +\u25b3y, with \u25b3x < 0 and \u25b3y > 0. CPMM requires k to be the same before and after the trade:\nx \u00b7 y = (x+\u25b3x)(y +\u25b3y) = k (10)\nTherefore, the product between the reserves of the pool\u2019s two tokens is constant, provided there is no changes to total liquidity in the pool. Figure A2 illustrates this trade as a transition along the price curve from state c to state b. Note that the convexity of the curve causes the trader to receive less BTC than the actual BTC value of the USDT added to the pool, i.e. slippage of the trade is determined by convexity of the price curve.\nThe market price in Uniswap v2 pools is determined by the ratio of the current quantities\nof two tokens in the pool:\npmkt = y\nx (11)\nwhich shows the market price of token X (BTC) in units of token Y (USDT). After the\ntrade, as in example above, price of BTC increases to p\u2032mkt = y\u2032 x\u2032 , because removing some of BTC from the pool makes it relatively scarce. In contrast, adding USDT to the pool makes it a relatively abundant asset, such that it becomes relatively cheaper.\nIn Uniswap v2, LPs are required to deposit their liquidity in a 50-50 ratio, i.e. they deposit both tokens in equivalent quantities. If liquidity providers add liquidity to the pool, the pool size increases, i.e. the pool\u2019s constant k increases. The larger the pool size the lower the slippage of a given trade. However, trading fees are then shared between a larger number of LPs. Recent studies by Capponi and Jia (2021), Lehar and Parlour (2021), and O\u2019Neill et al. (2022) discuss the economics of Uniswap v2 in more detail. Specifically, they show that LPs face a trade-off between the amount of fees earned from liquidity providing and adverse selection cost, imposed on them by informed arbitrageurs. Lehar and Parlour (2021) and O\u2019Neill et al. (2022) further show that the pool size acts as an equilibrating mechanism on DEXs, equivalent to the bid-ask spread on CEXs."
        },
        {
            "heading": "Appendix C",
            "text": ""
        },
        {
            "heading": "Slippage on CEXs",
            "text": "Suppose you would like to submit a market order to buy 100 ETH with USDT and the current state of the ask side of ETH/USDT limit order book is as in Table I below. The first available ask price, or \u201cbest ask\u201d, is 1350.10 USDT per ETH. However, there are only 50 ETH available at this price. The next available ask price is 1350.20 USDT, at which you can buy another 30 ETH. You can buy the remaining 20 ETH at 1350.60 USDT, because there are currently 70 ETH available at this price.\nWe use the mid price before the trade, i.e. the average of the best bid and the best ask, as the pre-execution market price pmkt to make the slippage values comparable across CEXs and DEXs. On CEXs, traders pay half-spread as a part of the slippage. On DEXs, there is no explicit bid-ask spread, such that pmkt is the pool price before the trade.\nSuppose pmkt = 1350 in the example above. The slippage of this trade is:\nSlippage = \u2223\u2223\u2223 pavgpmkt \u2212 1\u2223\u2223\u2223 = \u2223\u22231350.231350 \u2212 1\u2223\u2223 = 0.00017% = 1.7 bp"
        },
        {
            "heading": "Appendix D",
            "text": ""
        },
        {
            "heading": "Slippage on Uniswap v3: buy X with Y",
            "text": "Suppose we would like to buy tokens X with tokens Y. We are adding \u25b3y > 0 to the\npool and removing \u25b3x < 0.\nFor a given tick range [i, i+s], denote by \u25b3ymaxi the maximum quantity of tokens Y that you can add to this range (by removing reserves of token X). Let \u25b3xmini denote the minimum quantity of tokens X that you can \u201cadd\u201d to this range, i.e. the maximum quantity of tokens X than you can take from this range by adding tokens Y. From liquidity distribution of the pool, we know reserves xi for each tick range, such that \u25b3xmini = \u2212xi. We can then compute \u25b3ymaxi using Equation (6): \u25b3xmini = \u2212xi \u25b3ymaxi = \u2212 \u25b3xmini \u00b7 (yi + Li \u00b7 \u221a pi)\nxi +\u25b3xmini + Li\u221api+s =\nxiyi \u221a pi+s\nLi + xi \u00b7\n\u221a pipi+s\nLet {istart, istart + s, ..., iend} be the lower ticks of the consecutive tick ranges that we use during the trade. We consume all available liquidity in the tick ranges of lower ticks i \u2208 {istart, istart+ s, ..., iend\u2212 s}, and spend our remaining tokens Y in the tick range of lower tick iend, such that \u25b3x and \u25b3y can be expressed as follows:\n \u25b3y = \u2211 i\u2208{istart,istart+s,...,iend\u2212s} \u25b3ymaxi +\u25b3yiend \u25b3x = \u2211\ni\u2208{istart,istart+s,...,iend\u2212s}\n\u25b3xmini +\u25b3xiend\n\u21d2  \u25b3yiend = \u25b3y \u2212 \u2211 i\u2208{istart,istart+s,...,iend\u2212s}\u25b3y max i \u25b3x (6)= \u2212 \u2211\ni\u2208{istart,istart+s,...,iend\u2212s} xi \u2212 \u25b3yiend \u00b7(xiend+\nLiend\u221a piend+s )\nyiend+\u25b3yiend+Liend \u00b7 \u221a piend .\n(12)"
        },
        {
            "heading": "Slippage on Uniswap v2",
            "text": "Let\u2019s consider a pool with x tokens X and y tokens Y. We have:\npmkt = y\nx\n\u21d2 x \u00b7 pmkt \u00b7 pY in $mkt = y \u00b7 pY in $mkt\n\u21d2 x \u00b7 pX in $mkt = y \u00b7 pY in $mkt (13)\nWe also have the following formula involving the total value locked TV L (in $):\nTV L = x \u00b7 pX in $mkt + y \u00b7 pY in $mkt\n(13)\u21d2  x = TV L 2\u00b7pX in $mkt\ny = TV L 2\u00b7pY in $mkt\n(14)\nLet\u2019s assume we want to swap tokens X and tokens Y. Let \u25b3x and \u25b3y be the quantities of tokens X and Y we will add to the pool (for example, if we want to buy tokens X with tokens Y, we have \u25b3x < 0 and \u25b3y > 0). Let q be the trade size in $. Uniswap v2 curve x \u00b7 y = k imposes:\n(x+\u25b3x) \u00b7 (y +\u25b3y) = x \u00b7 y = k\n\u21d2  \u25b3x = \u2212 x\u00b7\u25b3y y+\u25b3y\n\u25b3y = \u2212 y\u00b7\u25b3x x+\u25b3x\n(15)\nBuy. Let\u2019s assume we want to buy tokens X with tokens Y. The slippage of this buy is:\nSlippage = \u2223\u2223\u2223\u2223 pavgpmkt \u2212 1 \u2223\u2223\u2223\u2223 = \u2212 \u25b3ypmkt \u00b7 \u25b3x \u2212 1\n(15)\u21d2 Slippage = y +\u25b3y pmkt \u00b7 x \u2212 1\n(14)\u21d2 Slippage = TV L 2\u00b7pY in $mkt + q pY in $mkt\npmkt \u00b7 TV L2\u00b7pX in $mkt \u2212 1\n\u21d2 Slippage = 2q TV L\n(16)\nSell. Let\u2019s assume we want to sell tokens X for tokens Y. The slippage of this sell is:\nSlippage = \u2223\u2223\u2223\u2223 pavgpmkt \u2212 1 \u2223\u2223\u2223\u2223 = 1\u2212 pavgpmkt = 1 + \u25b3ypmkt \u00b7 \u25b3x\n(15)\u21d2 Slippage = 1\u2212 y pmkt \u00b7 (x+\u25b3x)\n(14)\u21d2 Slippage = 1\u2212 TV L 2\u00b7pY in $mkt pmkt \u00b7 ( TV L\n2\u00b7pX in $mkt + q pX in $mkt ) \u21d2 Slippage = q\nq + TV L 2\n(17)"
        },
        {
            "heading": "Appendix E",
            "text": "Variable Description Source Buy A variable that takes the value 1 if the trade is a buy of tokens\nX with tokens Y, and zero otherwise.\nBigQuery\nExecutionCost Total execution cost, computed as the sum of Slippage and gas\nfees relative to Size.\nBigQuery, Etherscan\nIntensity Repositioning intensity of liquidity providers, measured as 1 \u2212 |Minted\u2212Burned| Minted+Burned within a given interval (5min, 10min, etc.),\nMinted (Burned) being the $ value of the minted (burned) liquidity.\nBigQuery\nLarge A variable that takes the value 1 if the size of the trade exceeds\na specified cutoff ($1K/$5K/$10K), and zero otherwise.\nLiquidityConcentration Market depth within 1%/2%/10% of pmkt, divided by TV L.\nMarket depth within x% of pmkt is computed as the $ value of the liquidity between pmkt 1+x% and pmkt \u00b7 (1 + x%)\nBigQuery\npmid Mid price of a position, computed as \u221a plower \u00b7 pupper. BigQuery pmkt On DEXs: price of the pool. On CEXs: mid price of the limit\norder book.\nBigQuery\nPolygon A variable that takes the value 1 if the transaction takes place\non Polygon, and zero otherwise.\nBigQuery\nPositionConcentration Concentration of a position around pmkt, computed and scaled\nas 1\u2212 1.0001 \u22121 PositionGap\u00b7PositionLength .\nBigQuery\nPositionGap Relative difference between pmid and pmkt, computed as\u2223\u2223\u2223 pmidpmkt \u2212 1\u2223\u2223\u2223. BigQuery PositionLength Price range length of a position, computed as pupper\u2212plower\npmid . BigQuery\nReturn 1min return of ETH/USD. Binance Size Hypothetical trade size in 100, 500, 1K, 5K, 10K, 50K, 100K,\n500K, 1M (in $). Slippage Slippage, computed as \u2223\u2223\u2223 pavgpmkt \u2212 1\u2223\u2223\u2223. Please refer to Section 4.1\nfor details on pavg computation on Uniswap v3.\nBigQuery\nTV L Total value locked, i.e. $ value of all the liquidity in the pool. BigQuery V olatility Realized volatility of ETH/USD over the previous 24 hours,\ncomputed as the square root of the sum of squared 1minReturns over previous 24 hours.\nBinance\nV olume Traded volume over previous 24 hours, computed every minute\n(in $).\nBigQuery"
        },
        {
            "heading": "Figures",
            "text": ""
        },
        {
            "heading": "Panel B: DEXs volume",
            "text": ""
        },
        {
            "heading": "Panel A: CEXs volume",
            "text": ""
        },
        {
            "heading": "Panel A: Liquidity mints",
            "text": ""
        },
        {
            "heading": "Panel A: Trade size",
            "text": ""
        },
        {
            "heading": "Tables",
            "text": ""
        },
        {
            "heading": "Panel B: Trade frequency",
            "text": "Mean SD 25% 50% 75%\nSlippage (bp)\nEthereum 5.93 14.92 0.02 0.29 4.00\nPolygon 700.90 2066.06 0.66 9.35 118.73\nVolume 24h ($M) Ethereum 231.30 319.64 26.08 68.17 382.89\nPolygon 11.64 19.19 0.15 1.03 20.74\nVolatility 24h (%) 4.06 1.99 2.81 3.72 4.74 Return 1min (bp) -0.01 11.91 -4.73 0.00 4.63\nPanel B: USDC/(W)ETH 0.3%\nSlippage ExecutionCost\nTotal $1K cutoff\n$5K cutoff\n$10K cutoff\nTotal $5K cutoff\n(1) (2) (3) (4) (5) (6)\nPolygon 16.48 *** -20.69 *** -20.49 *** -20.19 *** -128.27 *** -421.83 ***\n(8.39) (-7.69) (-7.62) (-7.53) (-6.38) (-12.67)\nPolygon \u00b7 Large 55.76 *** 66.56 *** 82.52 *** 528.40 *** (26.24) (26.21) (26.17) (17.41) Large 5.51 *** 6.57 *** 8.14 *** -455.60 ***\n(58.03) (58.03) (58.03) (-15.15)\nSize 0.12 *** -0.06 ***\n(28.18) (-4.70)\nR2 0.39 0.18 0.23 0.29 0.09 0.18 Observations 18,921,636 18,921,636 18,921,636 18,921,636 18,921,636 18,921,636 HourFE Yes Yes Yes Yes Yes Yes DayFE Yes Yes Yes Yes Yes Yes\nPanel C: (W)ETH/USDT 0.3%\nSlippage ExecutionCost\nTotal $1K cutoff\n$5K cutoff\n$10K cutoff\nTotal $5K cutoff\n(1) (2) (3) (4) (5) (6)\nPolygon 6500.29 *** 31.13 49.39 77.17 6360.35 *** -347.14 ***\n(37.36) (0.27) (0.43) (0.68) (35.94) (-2.99)\nPolygon \u00b7 Large 9703.75 *** 11611.63*** 14452.02*** 12073.47*** (46.99) (46.99) (46.99) (50.10) Large 16.82 *** 20.07 *** 24.85 *** -442.11 ***\n(46.55) (46.56) (46.56) (-14.63)\nSize 18.86 *** 18.68 ***\n(47.95) (47.09)\nR2 0.32 0.16 0.20 0.25 0.31 0.19 Observations 18,921,636 18,921,636 18,921,636 18,921,636 18,921,636 18,921,636 HourFE Yes Yes Yes Yes Yes Yes DayFE Yes Yes Yes Yes Yes Yes\nTable 6: Liquidity provision and repositioning intensity: Ethereum vs Polygon. This table reports average levels of liquidity provision across Ethereum and Polygon for three liquidity pools: USDC/(W)ETH 0.05%, USDC/(W)ETH 0.3%, (W)ETH/USDT 0.3%. We report the average daily number of mints (column 1); the average duration between two mints (in minutes) (column 2); the average daily minted value (in $M) (column 3); the average daily number of burns (column 4); the average duration between two burns (in minutes) (column 5); the average daily burned value (in $M) (column 6); and average repositioning intensity over 5-minute intervals (in %) (column 7). We measure repositioning intensity as\n1\u2212 |Minted$\u2212Burned$|Minted$+Burned$ within a 5-minute interval. Appendix E provides a detailed description of all variable definitions. We also report the difference between Polygon and Ethereum. T-statistics of the two-tailed t-test with the null-hypothesis of difference equaling zero are reported in parentheses.\nPool Mints Delta Minted Burns Delta Burned Intensity\n(#/day) (min) ($M/day) (#/day) (min) ($M/day) (%) USDC/(W)ETH 0.05%\nEthereum 83.94 17.16 29.12 32.83 43.86 15.71 17.01\nPolygon 512.95 2.81 35.46 324.36 4.44 35.15 35.36 Difference -429.01 14.35 -6.33 -291.54 39.42 -19.44 -18.26\nt-stat (-27.54) (-0.70) (-24.19) (-2.16) (-65.81)\nUSDC/(W)ETH 0.3%\nEthereum 97.83 14.72 9.11 22.79 63.19 4.67 8.68\nPolygon 92.42 15.58 0.43 43.31 33.25 0.21 19.33 Difference 5.41 -0.86 8.68 -20.52 29.94 4.46 -10.66\nt-stat (0.90) (16.59) (-8.01) (12.95) (-39.07)\n(W)ETH/USDT 0.3%\nEthereum 13.48 106.82 1.97 3.07 469.06 0.57 12.21\nPolygon 11.86 121.42 0.04 6.74 213.65 0.02 18.65 Difference 1.62 -14.59 1.93 -3.67 255.41 0.55 -6.44\nt-stat (2.69) (9.01) (-5.89) (8.10) (-8.24)\nPanel B: USDC/(W)ETH 0.3%\nIntensity LiquidityConcentration\n5min 10min\n1% 2% 10% 2%\n(1) (2) (3) (4) (5)\nPolygon 0.09 ***\n(20.47)\nIntensity 0.19 *** 0.37 *** 1.13 *** 0.38 ***\n(25.99) (26.14) (26.30) (18.40)\nObservations 48,332 48,332 48,332 48,332 24,151 HourFE Yes Yes Yes Yes Yes DayFE Yes Yes Yes Yes Yes\nPanel C: (W)ETH/USDT 0.3%\nIntensity LiquidityConcentration\n5min 10min\n1% 2% 10% 2%\n(1) (2) (3) (4) (5)\nPolygon 0.05 ***\n(4.82)\nIntensity 0.18 *** 0.35 *** 0.69 *** 0.28 ***\n(7.02) (7.02) (6.89) (6.04)\nObservations 7,876 7,876 7,876 7,876 3,943 HourFE Yes Yes Yes Yes Yes DayFE Yes Yes Yes Yes Yes\nTable 8: Repositioning precision: Ethereum vs Polygon. This table reports average levels of position gap (%), position length (%) and position concentration (%) across Ethereum and Polygon for three liquidity pools: USDC/(W)ETH 0.05%, USDC/(W)ETH 0.3%, (W)ETH/USDT 0.3%. We define position gap as the dollar-weighted average gap between the mid price of minted positions, pmid, and pmkt, computed as \u2223\u2223\u2223 pmidpmkt \u2212 1\u2223\u2223\u2223 within a 5-minute interval. pmid is computed as\u221aplower \u00b7 pupper. Position length is the dollar-weighted average range length of minted positions, computed as |pupper\u2212plower|\npmid , within a 5-\nminute interval. Position concentration is the dollar-weighted average concentration of minted positions, computed and scaled as 1\u22121.0001 \u22121 PositionGap\u00b7PositionLength , within a 5-minute interval. Appendix E provides a detailed description of all variable definitions. Column (1) reports average levels of position gap, separately for Ethereum and Polygon. We also report the difference between the average position gap on Polygon and Ethereum. T-statistics of the two-tailed t-test with the null-hypothesis of difference equaling zero are reported in parentheses. Columns (2) and (3) report corresponding statistics for position length and position concentration, respectively. ***, **, and * indicate statistical significance at the 1%, 5%, and 10% level, respectively.\nPool Position Position Position\ngap (%) length (%) concentration (%)\nUSDC/(W)ETH 0.05%\nEthereum 2.65 19.91 36.30\nPolygon 1.99 14.27 47.82\nDifference 0.66 *** 5.64 *** -11.52 ***\nt-stat (26.13) (29.11) (-37.94)\nUSDC/(W)ETH 0.3%\nEthereum 3.65 70.88 12.38\nPolygon 2.94 23.67 25.85\nDifference 0.71 *** 47.21 *** -13.47 ***\nt-stat (17.50) (110.44) (-50.77)\n(W)ETH/USDT 0.3%\nEthereum 3.89 68.81 12.79\nPolygon 3.26 34.65 18.27\nDifference 0.63 *** 34.16 *** -5.48 ***\nt-stat (5.92) (29.81) (-9.16)\nPanel B: USDC/(W)ETH 0.3%\nLiquidityConcentration\nTotal Total Total Intraday Multiday\n(1) (2) (3) (4) (5)\nPositionGap -5.71 ***\n(-11.93)\nPositionLength -0.08 ***\n(-74.55)\nPositionConc. 0.34 *** 0.36 *** 0.59 ***\n(32.63) (8.68) (22.34)\nObservations 48,332 48,323 48,332 8,653 48,332 HourFE Yes Yes Yes Yes Yes DayFE Yes Yes Yes Yes Yes\nPanel C: (W)ETH/USDT 0.3%\nLiquidityConcentration\nTotal Total Total Intraday Multiday\n(1) (2) (3) (4) (5)\nPositionGap -3.85 ***\n(-4.66)\nPositionLength -0.06 ***\n(-22.20)\nPositionConc. 0.34 *** -3.03 0.42 ***\n(9.07) (-0.33) (8.15)\nObservations 7,876 7,873 7,876 1,052 7,876 HourFE Yes Yes Yes Yes Yes DayFE Yes Yes Yes Yes Yes\nFigure A1: Gas price and gas fees on Ethereum. Panel A of this figure shows historical gas price on Ethereum over our sample period, January 1, 2022 until December 31, 2022, downloaded from Etherscan. Panel B shows gas fees for a trade on Uniswap v3 (Ethereum), assuming that it requires on average 120K gas units."
        },
        {
            "heading": "Panel A",
            "text": "Panel B\nFigure A2: Price curve for Uniswap v2: constant product market maker (CPMM). This figure illustrates a swap on the BTC/USDT pool on Uniswap v2. Pool reserves of token X, i.e. BTC, are on the x-axis. Pool reserves of token Y, i.e. USDT, are on y-axis. The price curve, x \u00b7 y = k, ensures the constant product between the reserves of the pool\u2019s two assets (in absence of liquidity deposits/withdrawals). A buy of BTC with USDT reduces the reserves of BTC from x to x\u2032 and increases the reserves of USDT from y to y\u2032. The pool\u2019s price after the buy moves upwards from pc to pb."
        }
    ],
    "title": "Blockchain scaling and liquidity concentration on decentralized exchanges\u2217",
    "year": 2023
}