{
    "abstractText": "Anti-lock Brake System (ABS) is a mandatory active safety feature on road vehicles with analogous systems for aircraft and locomotives. This feature aims to prevent locking of the wheels when braking and to improve the handling performance, as well as reduce stopping distance of the vehicle. Estimation uncertainties in the vehicle state and environment (road surface) are often neglected or handled separately from the ABS controller, leading to sub-optimal braking. In this paper, a Dual Control for Exploration-Exploitation (DCEE) approach is taken toward the ABS problem which achieves both accurate state (and environment) estimation and superior braking performance. Compared with popular Extremum Seeking methods, improvements of up to 15% and 8.5% are shown in stopping time and stopping distance, respectively. A Regularized Particle Filter with Markov Chain Monte Carlo step is used to estimate vehicle states and parameters of the Magic Formula tyre model that includes the peak friction coefficient for the environment. The effectiveness of the DCEE approach is demonstrated across a range of driving scenarios such as low and high speeds; snow, wet and dry roads and changing road surfaces.",
    "authors": [
        {
            "affiliations": [],
            "name": "Benjamin Sullivan"
        },
        {
            "affiliations": [],
            "name": "Jingjing Jiang"
        },
        {
            "affiliations": [],
            "name": "Georgios Mavros"
        },
        {
            "affiliations": [],
            "name": "Wen-Hua Chen"
        }
    ],
    "id": "SP:67f193921ad97cf46ddb0fe4561722db32f37c63",
    "references": [
        {
            "authors": [
                "Q. Xu",
                "L. Cai"
            ],
            "title": "Active Braking Control of Electric Vehicles to Achieve Maximal Friction Based on Fast Extremum-Seeking and Reachability",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 69, no. 12, pp. 14 869\u201314 883, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "S.M. Savaresi",
                "M. Tanelli"
            ],
            "title": "Active Braking Control Systems Design for Vehicles, ser. Advances in Industrial Control",
            "year": 2010
        },
        {
            "authors": [
                "M. Gerard",
                "W. Pasillas-L\u00e9pine",
                "E. De Vries",
                "M. Verhaegen"
            ],
            "title": "Improvements to a five-phase ABS algorithm for experimental validation",
            "venue": "Vehicle System Dynamics, vol. 50, no. 10, pp. 1585\u20131611, 2012.",
            "year": 2012
        },
        {
            "authors": [
                "W. Pasillas-L\u00e9pine"
            ],
            "title": "Hybrid modeling and limit cycle analysis for a class of five-phase anti-lock brake algorithms",
            "venue": "Vehicle System Dynamics, vol. 44, pp. 173\u2013188, 2006.",
            "year": 2006
        },
        {
            "authors": [
                "C.-Y. Kuo",
                "E.C. Yeh"
            ],
            "title": "A Four-Phase Control Scheme of an Anti-Skid Brake System for all Road Conditions",
            "venue": "Proceedings of the Institution of Mechanical Engineers, Part D: Journal of Automobile Engineering, vol. 206, no. 4, pp. 275\u2013283, oct 1992.",
            "year": 1992
        },
        {
            "authors": [
                "W. Pasillas-L\u00e9pine"
            ],
            "title": "Hybrid modeling and limit cycle analysis for a class of five-phase anti-lock brake algorithms",
            "venue": "Vehicle System Dynamics, vol. 44, no. 2, pp. 173\u2013188, 2006.",
            "year": 2006
        },
        {
            "authors": [
                "H. Mirzaeinejad",
                "M. Mirzaei"
            ],
            "title": "A novel method for non-linear control of wheel slip in anti-lock braking systems",
            "venue": "Control Engineering Practice, vol. 18, no. 8, pp. 918\u2013926, aug 2010.",
            "year": 2010
        },
        {
            "authors": [
                "C. Mi",
                "H. Lin",
                "Y. Zhang"
            ],
            "title": "Iterative Learning Control of Antilock Braking of Electric and Hybrid Vehicles",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 54, no. 2, pp. 486\u2013494, mar 2005.",
            "year": 2005
        },
        {
            "authors": [
                "A. Harifi",
                "A. Aghagolzadeh",
                "G. Alizadeh",
                "M. Sadeghi"
            ],
            "title": "Designing a sliding mode controller for slip control of antilock brake systems",
            "venue": "Transportation Research Part C: Emerging Technologies, vol. 16, no. 6, pp. 731\u2013741, dec 2008.",
            "year": 2008
        },
        {
            "authors": [
                "W. Rattasiri",
                "N. Wickramarachchi",
                "S.K. Halgamuge"
            ],
            "title": "An optimized anti-lock braking system in the presence of multiple road surface types",
            "venue": "International Journal of Adaptive Control and Signal Processing, vol. 21, no. 6, pp. 477\u2013498, aug 2007.",
            "year": 2007
        },
        {
            "authors": [
                "Z. Zhao",
                "Z. Yu",
                "Z. Sun"
            ],
            "title": "Research On Fuzzy Road Surface Identification and Logic Control for Anti-lock Braking System",
            "venue": "2006 IEEE International Conference on Vehicular Electronics and Safety. IEEE, dec 2006, pp. 380\u2013387.",
            "year": 2006
        },
        {
            "authors": [
                "H. Mirzaeinejad",
                "M. Mirzaei"
            ],
            "title": "Optimization of nonlinear control strategy for anti-lock braking system with improvement of vehicle directional stability on split-\u03bc roads",
            "venue": "Transportation Research Part C: Emerging Technologies, vol. 46, pp. 1\u201315, sep 2014. 21",
            "year": 2014
        },
        {
            "authors": [
                "H.-S. Tan",
                "M. Tomizuka"
            ],
            "title": "An Adaptive Sliding Mode Vehicle Traction Controller Design",
            "venue": "American Control Conference. IEEE, may 1990, pp. 1856\u20131862.",
            "year": 1990
        },
        {
            "authors": [
                "Y.-K. Chin",
                "W.C. Lin",
                "M. Sidlosky",
                "D.S. Rule",
                "M.S. Sparschu"
            ],
            "title": "Sliding-mode ABS Wheel-slip Control",
            "venue": "Tech. Rep., 1992.",
            "year": 1992
        },
        {
            "authors": [
                "I. Haskara",
                "\u00dc. \u00d6zg\u00fcner",
                "J. Winkelman"
            ],
            "title": "Extremum Control for Optimal Operating Point Determination and Set Point Optimization Via Sliding Modes",
            "venue": "Journal of Dynamic Systems, Measurement, and Control, vol. 122, no. 4, pp. 719\u2013724, dec 2000.",
            "year": 2000
        },
        {
            "authors": [
                "S. Drakunov",
                "U. Ozguner",
                "P. Dix",
                "B. Ashrafi"
            ],
            "title": "ABS control using optimum search via sliding modes",
            "venue": "IEEE Transactions on Control Systems Technology, vol. 3, no. 1, pp. 79\u201385, mar 1995.",
            "year": 1995
        },
        {
            "authors": [
                "M.K. Kartic B. Ariyur"
            ],
            "title": "Real-time optimization by extremum-seeking",
            "year": 2004
        },
        {
            "authors": [
                "E. Din\u00e7men",
                "T. Acarman",
                "B. Aksun G\u00fcven\u00e7"
            ],
            "title": "ABS control algorithm via extremum seeking method with enhanced lateral stability",
            "venue": "IFAC Proceedings Volumes (IFAC-PapersOnline), vol. 43, no. 7, pp. 19\u201324, 2010.",
            "year": 2010
        },
        {
            "authors": [
                "E. Din\u00e7men",
                "B.A. G\u00fcven\u00e7",
                "T. Acarman"
            ],
            "title": "Extremum-seeking control of ABS braking in road vehicles with lateral force improvement",
            "venue": "IEEE Transactions on Control Systems Technology, vol. 22, no. 1, pp. 230\u2013237, jan 2014.",
            "year": 2014
        },
        {
            "authors": [
                "L. Shaohua",
                "W. Guiyang",
                "W. Hesen",
                "Z. Lipeng"
            ],
            "title": "Automatic emergency braking/anti-lock braking system coordinated control with road adhesion coefficient estimation for heavy vehicle",
            "venue": "IET Intelligent Transport Systems, vol. 16, no. 11, pp. 1521\u20131534, nov 2022.",
            "year": 2022
        },
        {
            "authors": [
                "X. Zhang",
                "Y. Xu",
                "M. Pan",
                "F. Ren"
            ],
            "title": "A vehicle ABS adaptive sliding-mode control algorithm based on the vehicle velocity estimation and tyre/road friction coefficient estimations",
            "venue": "Vehicle System Dynamics, vol. 52, no. 4, pp. 475\u2013503, apr 2014.",
            "year": 2014
        },
        {
            "authors": [
                "T.A. Wenzel",
                "K.J. Burnham",
                "M.V. Blundell",
                "R.A. Williams"
            ],
            "title": "Dual extended Kalman filter for vehicle state and parameter estimation",
            "venue": "Vehicle System Dynamics, vol. 44, no. 2, pp. 153\u2013171, feb 2007.",
            "year": 2007
        },
        {
            "authors": [
                "C. Li",
                "Y. Liu",
                "L. Sun",
                "Y. Liu",
                "M. Tomizuka",
                "W. Zhan"
            ],
            "title": "Dual Extended Kalman Filter Based State and Parameter Estimator for Model-Based Control in Autonomous Vehicles",
            "venue": "2021.",
            "year": 2021
        },
        {
            "authors": [
                "K. Bogdanski",
                "M.C. Best"
            ],
            "title": "Kalman and particle filtering methods for full vehicle and tyre identification",
            "venue": "Vehicle System Dynamics, vol. 56, no. 5, pp. 769\u2013790, may 2017.",
            "year": 2017
        },
        {
            "authors": [
                "L. Chen",
                "M. Bian",
                "Y. Luo",
                "K. Li"
            ],
            "title": "Real-time identification of the tyre-road friction coefficient using an unscented Kalman filter and mean-square-error-weighted fusion",
            "venue": "Proc IMechE Part D: J Automobile Engineering, vol. 230, no. 6, pp. 788\u2013802, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "Z. Qin",
                "C. Liang",
                "M. Hu",
                "X. Chen"
            ],
            "title": "A lateral and longitudinal dynamics control framework of autonomous vehicles based on multiparameter joint estimation",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 71, no. 6, p. 5837, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "Q. Wang",
                "Y. Zhao",
                "Y. Deng",
                "H. Xu",
                "H. Deng",
                "F. Lin"
            ],
            "title": "Optimal Coordinated Control of ARS and DYC for Four-Wheel Steer and In-Wheel Motor Driven Electric Vehicle with Unknown Tire Model",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 69, no. 10, pp. 10 809\u201310 819, oct 2020.",
            "year": 2020
        },
        {
            "authors": [
                "Y. Huang",
                "Y. Zhang",
                "Z. Wu",
                "N. Li",
                "J. Chambers"
            ],
            "title": "A Novel Adaptive Kalman Filter with Inaccurate Process and Measurement Noise Covariance Matrices",
            "venue": "IEEE Transactions on Automatic Control, vol. 63, no. 2, pp. 594\u2013601, feb 2018.",
            "year": 2018
        },
        {
            "authors": [
                "J.C. Dixon"
            ],
            "title": "Tires, Suspension and Handling, Second Edition",
            "venue": "SAE International,",
            "year": 1996
        },
        {
            "authors": [
                "B. Ristic",
                "S. Arulampalam",
                "N. James Gordon"
            ],
            "title": "Beyond the Kalman Filter: Particle Filters for Tracking Applications Particle Filters for Tracking Applications",
            "year": 2004
        },
        {
            "authors": [
                "T. Li",
                "M. Bolic",
                "P.M. Djuric"
            ],
            "title": "Resampling Methods for Particle Filtering: Classification, implementation, and strategies; Resampling Methods for Particle Filtering: Classification, implementation, and strategies",
            "venue": "IEEE Signal Processing Magazine, vol. 32, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "T. Li",
                "S. Sun",
                "T.P. Sattar",
                "J.M. Corchado"
            ],
            "title": "Fight sample degeneracy and impoverishment in particle filters: A review of intelligent approaches",
            "venue": "Expert Systems with Applications, vol. 41, no. 8, pp. 3944\u20133954, jun 2014.",
            "year": 2014
        },
        {
            "authors": [
                "M.S. Arulampalam",
                "S. Maskell",
                "N. Gordon",
                "T. Clapp"
            ],
            "title": "A tutorial on particle filters for online nonlinear/non-Gaussian Bayesian tracking",
            "venue": "IEEE Transactions on Signal Processing, vol. 50, no. 2, pp. 174\u2013188, feb 2002.",
            "year": 2002
        },
        {
            "authors": [
                "C. Andrieu",
                "A. Doucet",
                "R. Holenstein"
            ],
            "title": "Particle Markov chain Monte Carlo methods",
            "venue": "Journal of the Royal Statistical Society. Series B: Statistical Methodology, vol. 72, no. 3, pp. 269\u2013342, jun 2010.",
            "year": 2010
        },
        {
            "authors": [
                "J. Elfring",
                "E. Torta",
                "R. van de Molengraft"
            ],
            "title": "Particle filters: A hands-on tutorial",
            "venue": "Sensors (Switzerland), vol. 21, no. 2, pp. 1\u201328, jan 2021.",
            "year": 2021
        },
        {
            "authors": [
                "W.H. Chen",
                "C. Rhodes",
                "C. Liu"
            ],
            "title": "Dual Control for Exploitation and Exploration (DCEE) in autonomous search",
            "venue": "Automatica, vol. 133, p. 109851, nov 2021.",
            "year": 2021
        },
        {
            "authors": [
                "K. Nam",
                "S. Oh",
                "H. Fujimoto",
                "Y. Hori"
            ],
            "title": "Estimation of sideslip and roll angles of electric vehicles using lateral tire force sensors through rls and kalman filter approaches",
            "venue": "IEEE Transactions on Industrial Electronics, vol. 60, no. 3, pp. 988\u20131000, 2013. 22",
            "year": 2013
        },
        {
            "authors": [
                "V. Mazzilli",
                "D. Ivone",
                "S. De Pinto",
                "L. Pascali",
                "M. Contrino",
                "G. Tarquinio",
                "P. Gruber",
                "A. Sorniotti"
            ],
            "title": "On the benefit of smart tyre technology on vehicle state estimation",
            "venue": "Vehicle System Dynamics, pp. 1\u201326, oct 2021.",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n30 6.\n14 73\n0v 1\n[ ee\nss .S\nY ]\n2 6\nJu n\n20 23\nAnti-lock Brake System (ABS) is a mandatory active safety feature on road vehicles with analogous systems for aircraft and locomotives. This feature aims to prevent locking of the wheels when braking and to improve the handling performance, as well as reduce stopping distance of the vehicle. Estimation uncertainties in the vehicle state and environment (road surface) are often neglected or handled separately from the ABS controller, leading to sub-optimal braking. In this paper, a Dual Control for Exploration-Exploitation (DCEE) approach is taken toward the ABS problem which achieves both accurate state (and environment) estimation and superior braking performance. Compared with popular Extremum Seeking methods, improvements of up to 15% and 8.5% are shown in stopping time and stopping distance, respectively. A Regularized Particle Filter with Markov Chain Monte Carlo step is used to estimate vehicle states and parameters of the Magic Formula tyre model that includes the peak friction coefficient for the environment. The effectiveness of the DCEE approach is demonstrated across a range of driving scenarios such as low and high speeds; snow, wet and dry roads and changing road surfaces.\nIndex Terms\nAnti-lock Brake System, Dual Control for Exploration-Exploitation, Particle Filter\nI. INTRODUCTION\nActive safety systems, such as Electronic Stability Control, Traction Control and Adaptive Cruise Control, are safety features found on many ground vehicles due to the ability to actively improve controllability and safety of the vehicle. This is either through autonomously activating the vehicle controls (Advanced Driver Assistance Systems in ground vehicles), or automatically activating inline with direct driver operation, e.g. pressing the accelerator may also activate Traction Control. This paper focuses on arguably the most critical active safety feature, the Anti-lock Brake System (ABS). The performance of ABS becomes limited when either the state of the vehicle (i.e. tyre slip) is poorly estimated or the quality of the road surface is unknown: too much braking causes the wheels to lock or too little braking leads to an increased chance of collision. The relationship between friction coefficient and the\nThis work was supported by the UK Engineering and Physical Sciences Research Council (EPSRC) Established Career Fellowship \u201cGoal-\nOriented Control Systems: Disturbance, Uncertainty and Constarints\u201d under the grant number EP/T005734/1.\nThe authors are with the Department of Aeronautical and Automotive Engineering, Loughborough University, LE11 3TU, UK. Correspondence;\nb.sullivan@lboro.ac.uk; j.jiang2@lboro.ac.uk; g.mavros@lboro.ac.uk; w.chen@lboro.ac.uk.\nThis work has been submitted to the IEEE for possible publication. Copyright may be transferred without notice, after which this version\nmay no longer be accessible.\nvehicle state (wheel slip ratio) is shown in Fig. 1 [1] [2]. The aim of our design is to achieve the greatest braking performance, i.e., the maximum friction force from the road surface. Thus the ABS problem is twofold: estimate the vehicle states and parameters, as well as control the vehicle to achieve its maximum retardation.\nTraditionally, two control methodologies exist for ABS. They are Wheel Slip Control (WSC) and Wheel Deceleration Control (WDC). In the latter class of methods, wheel deceleration control is achieved using rule based heuristics often employing hybrid automata to regulate the wheel deceleration [3]\u2013[5]. This methodology is sub-optimal and in fact attempt to bound the vehicle within the optimal acceleration setpoint using a set of acceleration thresholds. For example, as shown in Fig. 1, a hypothetical set-point of wheel acceleration \u03b71 leads to an operating point that is only suitable for snow covered roads, all the other road types lead to the vehicle either sliding significantly or under-braking. WSC methods however, regulate the wheel slip to its largest value before the vehicle begins sliding, achieving the greatest retardation forces. Such methods are beneficial since they have a clear mathematical background and work even if there is no well defined maxima [6]. [7]\u2013[9] proposed control designs using a priori knowledge of the optimum slip ratio and neglecting measurement noise, while [10]\u2013[12] estimates the slip value of the vehicle for changing road surfaces. Sliding Mode Control has traditionally been used for ABS controllers [13]\u2013 [15] and extended to uncertain systems in [16] where the optimum slip ratio has been estimated in an online fashion using Extremum Seeking [17]\u2013[19]. Despite this, Sliding Mode Control is prone to high frequency oscillations (chattering) as the controller attempts to hold onto the surface and can cause the vehicle to slide [12].\nIn this paper, we develop a chatter free solution, namely the Dual Control for Exploration and Exploitation (DCEE) approach which aims to predicatively estimate and achieve the best control action on any road surface.\n3 This problem is fundamentally an exploration-exploitation of the road surface friction thus the DCEE is qualified. The DCEE methodology further improves on the current state of the art by informing the action selection by predicted measurements. Ultimately, this method predicts the future outcome in a cost function that minimizes the error between the predicted tyre force and the maximum available tyre force for any given road surface. It is able to deal with time-varying road conditions, which is different from other works that only consider a time-invariant setpoint e.g. [20].\nKalman Filtering (KF) and subsequent extensions (e.g Extended [21]\u2013[23] or Unscented [24]\u2013[26]) have been used to solve the estimation problems (e.g. wheel speed and vehicle velocity), yet do not adequately handle the highly non-linear dynamics of braking systems and non-Gaussian noises. Limited cases exist for this problem using the Sequential Monte Carlo (SMC) approach [24]. However, such approach cannot deal with higher-dimensional static parameter estimation in this work. A GPF approach was implemented to identify a tyre model along with the state of the vehicle [27]. However, this required measurements of lateral and longitudinal velocities, accelerations and wheel speed. Hence, the implementation cost is higher than that of typical WSC or WDC solutions that measure wheel speed and vehicle longitudinal velocity only. Furthermore a unique piece-wise tyre force model is identified during this study but lacks usefulness for other systems since it makes assumptions about linearity, saturation and introduces scaling gains. Bayesian Inference has shown to perform well in vehicle localization and target tracking for non-linear systems and/or non-Guassian observations for state estimation e.g. [22], [28] but remains challenging when applied for parameter estimation. We show that a Regularized Particle Filter (RPF) approach for joint state and parameter estimation of unknown vehicle states and tyre model parameters is suitable for the ABS problem. The application of the Particle Filter when used for vehicular active safety is under-examined, particularly for dynamic parameters as is the case for changing road surfaces which we demonstrate our method for.\nA novel control scheme based on exploitation and exploration has been proposed and verified with simulation, results of which shows an improvement of up to 15% in stopping time and 8.5% in stopping distance by comparing with benchmarks. We demonstrate that the RPF can estimate both vehicle states and all the parameters of the Magic formula tyre model simultaneously. Furthermore, a novel resampling method is introduced, namely Retrogressive resampling that significantly improves the estimation and control result in the presence of step changes to parameters. These phenomena are typical of braking on changing road surfaces e.g. traversing newly paved road to an old road surface, onto untreated icy roads or over \u2019potholes\u2019.\nThe structure of the rest of the paper is as follows with the system architecture shown in Fig. 2. The system model and slip-friction relationship are described in Section II, while the joint state and parameter estimation using Particle Filtering is presented in Section III with an effective resampling method for parameter step changes, namely Retrogressive resampling. Then a controller is presented using the Dual Control for Exploration and Exploitation method in Section IV. Simulation results are presented in Section V, demonstrating the effectiveness of the proposed method. Finally, conclusions and discussion on future progression are conducted in Section VI."
        },
        {
            "heading": "II. SYSTEM DYNAMICS",
            "text": "This work focuses on the longitudinal only behaviour of the vehicle during braking as one considers the lateral vehicle stability to be outside the remit of an ABS feature. Thus we target the 7 degree of freedom (DOF) vehicle model for demonstration of this work.\nA. Vehicle Dynamics: 7 DOF Model\nThe 7 DOF vehicle dynamics model is shown in Fig. 3. From first principles, the summation of all forces and\nmoments are found using the center of mass [xG, yG, zG] and align with the SAE frame of reference [29]:\n4 \u2211\nj=1\nFx,j = m\n(\ndU\ndt +Wq\n)\n\u2212m\n(\nxGq 2 \u2212 zG\ndq dt\n)\n(1)\n4 \u2211\nj=1\nFz,j = m\n(\ndW\ndt \u2212 Uq\n)\n\u2212m\n(\nzGq 2 + xG\ndq dt\n)\n(2)\n4 \u2211\nj=1\nMy = Iyy dq\ndt +mzG\n(\ndU\ndt +Wq\n)\n\u2212mxG\n(\ndW\ndt \u2212 Uq\n)\n(3)\nwhere Fx,j and Fz,j denotes the longitudinal and vertical tyre force at wheel j \u2208 [1, 2, 3, 4] as shown in Fig. 3 respectively, while q represents the pitch velocity about the centre of gravity. In addition, m is the total vehicle mass and U and W are the longitudinal (forward) and vertical vehicle body centred velocities. Iyy is the vehicle body products of inertia about the yy axis, while My denotes the pitching moment.\nWe model the suspension using a spring/damper, with spring stiffness k and damping coefficient c, connecting\neach wheel to the rigid chassis as:\nFz,f = kf (z \u2212 |a|\u03c6) + cf (W \u2212 |a|q) (4)\nFz,r = kr (z + |b|\u03c6) + cr (W + |b|q) (5)\nwhere \u03c6 is the pitch angle, a and b are the distances to the centre of gravity from the front and rear axles respectively, z is the vertical displacement of the centre of gravity. Note that subscripts f and r are used to denote the front and rear axles.\nFinally, the remaining four degrees of freedom are from the wheel accelerations, \u03c9\u0307, given by the following\nrelationship:\nIw\u03c9\u0307j = Tj \u2212RFT,j (6)\nwhere Tj denotes the sum of the brake or driving action (control input) applied to the centre of jth wheel for all j \u2208 {1, 2, 3, 4}. Note that T3 = T4 = 0 as we only apply braking and driving torques to the front wheels in this study. Note that all wheels are assumed identical, hence the wheel inertia Iw and the effective tyre radius R are the same between all wheels."
        },
        {
            "heading": "B. Steady State Tyre Dynamics",
            "text": "Tyre force models such as the non-linear Magic formula provide an accurate representation of the available road surface friction across a range of operating conditions, e.g., dry, wet or asphalt, cobblestone as shown in Fig. 1. The non-sliding (slip ratio smaller than the optimum value) and sliding (slip ratio larger than the optimum value) regions of the road surface are captured where the peak friction coefficient leads to the greatest tyre force and retardation of the vehicle. Thus finding the optimal wheel slip is the target of this work. Simply, the tyre force Fx,j can be calculated using the normal load Fz,j on the tyre:\nFx,j = \u00b5(\u03ba)Fz,j , (7)\nwhere \u00b5(\u03ba) represents the friction coefficient for a certain road and it is a function of slip ratio \u03ba. According to the tyre model (i.e., Magic formula), it can be found by the following function [30]:\n\u00b5j = D sin[C arctan(B\u03baj \u2212 E(B\u03baj \u2212 arctanB\u03baj))] (8)\n6 where B,C,D and E are the stiffness factor, the shape factor, the peak factor (determining the peak friction coefficient) and the curvature factor, respectively. In addition, the vehicle slip ratio \u03baj is calculated as:\n\u03baj = \u03c9jR\u2212 U\nU (9)\nFurthermore, the practical slip ratio definition is used here giving negative force under braking as is usual practice when using the Magic formula."
        },
        {
            "heading": "III. STATE AND PARAMETER ESTIMATION",
            "text": "Our work aims to find the maximum friction force and control the vehicle to generate such force so as to be able to stop as soon as possible. This requires the identification of all the parameters of the magic formula (i.e., \u0398 = [B,C,D,E]T ), as well as the states of the ego vehicle, such as body velocity and wheel speeds. The 7DOF vehicle dynamics represented by (1)-(9) can be reduced to the nonlinear discrete-time double corner model with 3DOF, e.g. [2], as\nxk = f (xk\u22121,uk\u22121,\u0398k\u22121)\nyk = xk +Vk\n(10)\nwhere uk is the torque control input used to brake the front two wheels, i.e., uk = [T1,k, T2,k], and xk represents the state of the vehicle, including longitudinal body velocity and wheel speeds, i.e., xk = [Uk, \u03c9f,k, \u03c9r,k]. This is a simplified version of the previous system model whereby only the longitudinal and wheel rotational degrees of freedom are maintained. The wheels of each individual axle are assumed to have the same rotational velocity, hence this is a single-track model that only distinguished between front and rear slip, but not left and right. Note that the parameter \u0398 is assumed to be static, but may exhibit sudden step changes to match the operating condition. Even though the model does not include pitch and heave motions, it permits differential vertical loading conditions over the front and rear axles that can be significant during braking. In addition, we assume that all states are measurable but with additive noise hence matching that of the sensor, thus the system output is yk \u2208 R3\u00d71.\nNote that we assume that all braking torques are applied to front wheels only as we achieve the majority of braking here. To estimate states and parameters at the same time, we create a single augmented vector variable \u03c7k as:\n\u03c7k = [Uk, \u03c9f,k, \u03c9r,k, Bk, Ck, Dk, Ek] T ,\nwhose dynamics are represented by\n\u03c7k =\n\n\nxk \u0398k\n\n =\n\n\nf (xk\u22121,uk\u22121,\u0398k\u22121)\n\u0398k\u22121\n\n =\n\n\nf (\u03c7k\u22121,uk\u22121)\n\u0398k\u22121\n\n (11)\nRemark 1: One may take \u0398k = \u0398k\u22121 since we assume that all the parameters in the Magic Formula are\npiece-wise constants despite the changing road conditions.\nRemark 2: Here lies the challenge associated with the tyre model identification during an ABS scenario. Our system is required to quickly determine the correct parameters whilst operating robustly to an uncertain environment. Hence the best braking action is require to be found as quickly as possible to avoid collision.\n7"
        },
        {
            "heading": "A. Estimation Using Bayesian Inference",
            "text": "In having a history of observations i.e. Yk\u22121 = {y0, y1 : yk\u22121} the objective of an observer is to estimate the current state \u03c7k using all the information available and recursively update the priori belief p (\u03c7k | Yk\u22121) as new information becomes available. Given we can predict the state value using our system model (11), one may use the Chapman-Kolmogorov equation to calculate the prior belief as:\np (\u03c7k | Yk\u22121) =\n\u222b\np (\u03c7k | \u03c7k\u22121) p (\u03c7k\u22121 | Yk\u22121) d\u03c7k\u22121 (12)\nFrom a new measurement at the current time step, yk, the posterior likelihood p (\u03c7k | Yk) can be updated using Bayes theorem based on the likelihood p (yk | \u03c7k), prior p (\u03c7k | Yk\u22121) and marginal likelihood p (yk | Yk\u22121):\np (\u03c7k | Yk) = p (yk | \u03c7k) p (\u03c7k | Yk\u22121)\np (yk | Yk\u22121) (13)\nwhere the normalising constant is:\np (yk | Yk\u22121) =\n\u222b\np (yk | \u03c7k) p (\u03c7k | Yk\u22121) d\u03c7k (14)\nRemark 3: We attempt to identify parameters of a widely accepted tyre model which, to the best of the authors\nknowledge, is the first complete identification effort of the Magic Formula using a Bayesian approach."
        },
        {
            "heading": "B. Regularized Particle Filter",
            "text": "Determining the solution to (13) is generally intractable as it requires the entire observation history Yk that is costly for real online systems. In the case of linear finite dimension systems that exhibit Gaussian noise characteristics, the Kalman Filter provides the optimal recursive Bayesian solution. However, to better approximate real systems including system non-linearities and non-Gaussian noises, a Sequential Monte Carlo (SMC) approach is more appropriate. Due to these reasons, the optimal state estimation is achieved by using a Bayesian solution [31] that is approximated by the sum of weighted samples, wi associated with the Dirac function \u03b4, as the following using the number of particles, ni:\np (\u03c7k | Yk) \u2248 ni \u2211\ni=1\nwik\u03b4 ( \u03c7k \u2212 \u03c7 i k )\n(15)\nwhere wik is found using the importance density q:\nwik \u221d w i k\u22121\np ( yk | \u03c7ik ) p ( \u03c7ik | \u03c7 i k\u22121 )\nq (\n\u03c7ik | \u03c7 i k\u22121,yk\n) (16)\nThe expected value is calculated from our particles using the standard form for finding the weighted mean:\nE [\u03c7k] =\nni \u2211\ni=1\nW ik\u03c7 i k (17)\nwhere W ik is the normalised particle weight i.e. W i k = w i k/ \u2211ni i=1 w i k such that the sum of the normalised particle weights equals 1. The inference problem so far has been restricted to Sequential Importance Sampling which forms the basic mechanic for most particle filtering methods. There are however a number of limitations to this method including degeneracy and impoverishment which must be addressed.\n8 The degeneracy problem exists when the weight of a single particle is updated with increasing likelihood until it reaches nearly 100% likely where the weight, wik, equals 1. In this extreme scenario, computation of this single particle leads to the expected state value from the filter since all other weights are insignificant, hence the efficiency is extremely poor. Once degeneracy is observed in the weight values, the estimates will begin to diverge and result in unacceptably poor errors. To mitigate this issue, particle resampling is utilised to redistribute those with high weightings to multiple particles of the same value and remove those with low weightings. This in turn increases the number of active particles. Resampling methods include systematic, stratified and branch-kill with further discussions found in [32]. The stratified resampling method is used in this work for its superior computational efficiency. Furthermore one may decide to selectively re-sample only when the level of degeneracy is below a threshold. The effective sample size, Neff , is one way to measure this [33] and is calculated by\nNeff = 1\n\u2211ni i=1\n( wik )2\n(18)\nResampling is active if Neff \u2264 Koni, where Ko is introduced to control the resampling frequency as in practice large value of this threshold alone leads to overly frequent resampling that can be detrimental to the estimation effort. Here we chose to define this using a linear relationship, dependant on the expected peak friction.\nRemark 4: It is clear to see from Fig. 1 that the parameter identification problem, particularly the estimation of peak friction parameter D, is more challenging on snow or icy surfaces since the peak is less defined than that for dry or wet roads. Therefore, one would expect a higher resampling frequency were the peak is harder to identify, ensuring an adequate distribution of particles. In this paper, Ko is chosen as a time-varying parameter subject to the expectation of the road condition. At time step k, it is defined as\nKo,k = \u2212 3\n20 E [Dk] + 0.295 (19)\nAccording to (19) there is no need to do manual adaptation among operating conditions and the observer is automatically adapted to the tyre model estimation of the peak friction.\nSample impoverishment is an undesirable quality of particle filtering where the particles \u201cmove\u201d closer together yielding the particle population to have no diversity and is a side effect of high frequency resampling. When all particles occupy the same value, leading to poor representation of the posterior density, this is often referred to as \u201cparticle collapse\u201d. It can be seen that frequent resampling would instigate this phenomenon, hence impoverishment and degeneracy are interlinked.\nTo introduce particle diversity, two methods may be employed to move a particle to a new value and could be used in unison along with the resampling threshold, namely a regularization step (Regularized Particle Filter (RPF) [34]) and a Markov Chain Monte Carlo (MCMC) step. By using the RPF, jittering of the particle population is achieved. The regularization step may be approximated to the following using the Gaussian Kernel. Note that the characteristics of the kernel are zero mean subject to small variance (i.e., \u01ebk \u223c N (0, 1)). The regularization step, using the re-sampled particle population, is conducted as follows:\n\u03c7i\u22c6k = \u03c7 i k + hoptDk\u01eb i k (20)\n9 where \u03c7i\u22c6k represents the new particle value. hopt is the bandwidth calculated by\nhopt = An \u22121 nx+4 i (21)\nwhere A = [4/ (nx + 2)] 1 nx+4 , nx equals to the length of the augmented state and is selected to minimize the mean integrated square error (MISE). Finally, Dk is the solution to the equation Sk = DkD T k , where Sk denotes the weighted covariance and is calculated by\nSk = ni\nni \u2212 1\n1 \u2211ni\ni Wi,k\nni \u2211\ni=1\nWi,k (\u03c7i,k \u2212 \u00b5k) 2\n(22)\nThe purpose of the MCMC step is similar to the regularization step. However, this method ensures that a resampled particle population (or regularized sample) is free from sample degeneracy and impoverishment [33]. The aim is to draw more samples from areas with high probability by an acceptance probability, using the posterior distribution following resampling p(\u03c7k | Yk), and a proposal distribution p(yk | \u03c7i\u22c6k ). MCMC methods randomly draw a sample (Monte Carlo) that is dependant on the likelyhood of the prior sample i.e. Markov Chain.A common MCMC method utilised in Particle Filters is the Metropolis-Hastings Step, originally presented in [35] with the replication in [36] utilized for this work.\nRemark 5: The Regularization has the additional benefit of introducing artificial dynamics to the augmented state matrix. If an unlikely scenario, for example, of extreme tyre wear, very low or high road surface friction coefficients or very high vehicle speeds are observed, the particle values are able to expand to handle this.\nThe complete regularized particle filter with MCMC step is shown in Algorithm 1.\nAlgorithm 1 Regularized Particle Filter with MCMC Step\nInput: \u03c7ik\u22121, w i k\u22121,yk Output: \u03c7ik, w i k\n1: Propagate system state according to (11) 2: Determine likelihood by (16) 3: Use (18) to calculate effective ratio 4: Compute the resampling gain Ko,k by (19) 5: if Neff \u2264 Ko,kni then 6: Systematic Resampling 7: Regularization 8: MCMC Step 9: end if"
        },
        {
            "heading": "C. Parameter Step Change: Retrogressive Resampling",
            "text": "Particle filtering is well suited to slowly changing states or parameters, such as vehicle\u2019s velocity which cannot instantaneously change from 0 to 20m/s due to mechanical constraints, instead it would be accelerating over a period of time. However, change of road conditions is different. In fact, the changes in the road surface parameters\n10\ncan be best described as step changes, for example, traversing from an old road surface to a newly paved surface, from a dry road to a wet road, or over potholes. The performance of estimating a changing road surface is shown in Fig. 4 where an RPF estimator first converges successfully to the first road surface, but fails to quickly converge to the second one. It takes nearly 1.5s to diversify the particle population and re-converge to the new ground truth. The maximum and minimum particle values show the diversity and clearly indicate how the filter immediately becomes impoverished and cannot escape this effect in a timely manner. In fact the filter is impoverished for over a second whereby the particle population range doesn\u2019t include the true value.\nTo manage such sudden change in operating conditions, a simple yet effective method for resampling the particle population is introduced, namely Retrogressive resampling. In the case that the states of the vehicle are continuously tracked regardless of the road condition but the road surface parameters are not, a trigger to reset these parameters to their initial conditions using the current uncertainty of the system is required. If we observe high estimation uncertainties, a reset is triggered, leading to a normally distributed particle population over the initial range. The weightings are also reverted to their initial values thus giving an equal likelihood over the entire parameter space. The Retrogresive resampling method is presented in Algorithm 2 where we use the uncertainty of the predicted maximum tyre force, quantified by its error variance matrix, Pk+1|k described in Section IV. This step is applied at the beginning of every new measurement.\nRemark 6: There is no need to tune the Retrogressive resampling process since P0, the initial value of maxPk+1|k, is determined by how the initial conditions are set. Following the initialisation, if at any point during the manoeuvre the uncertainty exceeds that of the initial value then we resample accordingly."
        },
        {
            "heading": "IV. DUAL CONTROL FOR EXPLORATION-EXPLOITATION",
            "text": "The ABS problem is both a stochastic and adaptive control problem since we do not know the current state of the vehicle and parameters associated with the vehicle (tyre model) that we may exploit to achieve optimal braking. The Particle Filter is used to find the current road surface friction \u00b5, the maximum road surface friction D, the wheel speed and body velocity. Thus the brake torque is selected as the action that produces the smallest tracking error\n11\nAlgorithm 2 Retrogressive Resampling\nInput: Pk+1|k,x i k,\u0398 i 0,\u0398 i k, w i 0, P0, w i k Output: xik,\u0398 i k, w i k\n1: if maxPk+1|k \u2265 P0 then 2: \u0398ik \u2190 \u0398 i 0 3: xik \u2190 x i k 4: wik \u2190 w i 0 5: else 6: \u0398ik \u2190 \u0398 i k 7: xik \u2190 x i k 8: wik \u2190 w i k 9: end if\nbetween the current and the estimated maximum tyre forces. However, this results in exploitation of the estimation solely through experience of the recursive RPF observer rather than prediction since the observer can only determine the correct parameters when it has experienced the maxima. This maxima is found by driving the vehicle to begin sliding without prediction. It is clear that altering the brake force will change how the vehicle behaves, affecting the future state and consequently the future measurements of our vehicle state. To this effect, the DCEE framework incorporates information from a one step prediction into our control action selection using predicted observations, propagated from the RPF observer and a discrete-time approximation of the vehicle dynamics. In this way, our system intelligently distinguishes those control actions that do not drive the vehicle to reach the minumum stopping distance whilst considering the uncertainty of the maximum tyre force estimation."
        },
        {
            "heading": "A. DCEE Formulation",
            "text": "The objective function is selected to minimize the error between the predicted tyre force Fk+1|k and the maximum\ntyre force F \u2217k , hence is defined as:\nmin uk J (uk) = min uk E\u0398k\n[\nEyk+1|k\n[\u2223\n\u2223Fk+1|k \u2212 F \u2217 k\n\u2223 \u2223 | \u03c7\u0304k,yk ]]\n(23a)\nsubject to\nuk = uk\u22121 + \u03c4k (23b)\n\u03c4k \u2208 T (23c)\nwhere yk and denotes the current measurements. T is a set of control actions and uk is the current torque which is assumed to be deterministic. Different from traditional control schemes, the reference is unknown and the maximum tyre force must be estimated in an online fashion according to the changes in road condition. Furthermore, one may expect the tyre properties to change as they are replaced due to wear during its lifespan. Thus an adaptive control scheme is necessary to control the vehicles braking whilst including the typical proprioceptive and exteroceptive\n12\noperating dynamics of the vehicle and environment. According to [37], the cost function (23) is equivalent to the following one using the variance of the error between the predicted tyre force and its maximum value, Pk+1|k :\nJ(uk) = \u2223 \u2223F\u0304k+1|k \u2212 F\u0304 \u2217 k+1|k \u2223 \u2223+ Pk+1|k, (24)\nwhere F \u2217k is the expectation of the predicted estimation of the total available tyre force using the peak friction coefficient D, i.e.,\nF\u0304 \u2217k+1|k = E [ F \u2217k+1|k | Yk+1|k ] . (25)\nand similarly for the predicted state given a potential control action from T and the estimated augmented state matrix where F\u0304 denotes the tyre force vector using the admissible action set T :\nF\u0304k+1|k = E [ Fk+1|k | Yk+1|k ]\n(26)\nCost function (24) shows the exploration-exploitation effect by not only incorporating the dynamic nature of the maximum tyre force but also the likelihood of achieving it, captured in the variance of the tyre force tracking error Pk+1|k . Then, Pk+1|k is found as the variance of the predicted tracking error:\nPk+1|k = V ar ( F\u0304k+1|k \u2212 F\u0304 \u2217 k+1|k )\n(27)\nThe first right hand term of (24) exploits the current information gathered by the observer as per traditional control theory, while the second right hand term quantifies the uncertainty of the vehicle reaching the predicted maximum tyre force.\nRemark 7: ABS is fundamentally an exploration-exploitation problem since the maximum friction of a road surface is unknown and cannot be measured. Thus the control system should aim to understand the environment by means of the available actions (exploration) observing the response, then taking the best action that results in the shortest stopping distance (exploitation) in a recursive manner. Most existing methodologies do not acknowledge this problem instead, computing the most appropriate action from the posterior belief of the road (exploitation only). SMC, for example, only considers the reference surface rather than exploring the system to find it."
        },
        {
            "heading": "B. Measurement Prediction",
            "text": "The goal of the measurement prediction is to determine the actions that achieve the highest brake force, before taking them. Since we have already generated a belief in the current state of the vehicle one may predict what the next tyre force measurement is, given a selected control input. In practice, physical measurement of the tyre force represents a significant challenge since unconventional sensors, such as Load Sensor Bearings [38] or other Smart Tyre systems [39], are used. However this work does not require such systems to estimate the tyre force or predict it.\nRemark 8: This work does not require sophisticated sensing, instead estimating the current and predicted tyre\nforce from low cost conventional sensors.\n13\nThe predicted tyre force for ith particle, F i k+1|k, is found using a discrete time approximation of the half car dynamics using the posterior estimate of the augmented state matrix, \u03c7ik from the RPF and the vertical load on the wheel:\nF ik+1|k = \u00b5 i k+1|kFz (28)\nwhere \u00b5i k+1|k is the predicted friction coefficient found using the posterior estimation of the augmented state i.e. \u03c7\u0304k. Then similarly for the predicted maximum tyre force using peak factor D where D i k+1|k = D i k instead of the predicted friction coefficient.\nThis however leads to ni predicted tyre forces for each action which is unnecessarily large since the performance gain of ni particles (potentially thousands of measurements for each action) does not justify the computational cost. Therefore one may \u2018intelligently\u2019 select the most relevant observations using the stratified resampling technique [32] with the posterior weighting. This facilitates the redistribution of the particle population into strata or within sub-populations that are drawn randomly from within these groups. Considering that the prediction is inherently uncertain, we determine that only 40 predicted observations is required for ABS. Performing resampling on the predicted particle population also has the additional benefit of ensuring that the observations are non-degenerate thus ensuring a set of unique measurements. Finally, making the assumption that the tyre force observations follow a Gaussian distribution with variance \u03c3f = 250, one determines the likelihood of the predicted tyre force. Ensuring that when approximating the tyre forces by Eqs. (25)-(26), we use the down sampled set of predicted tyre force measurements when determining the weights."
        },
        {
            "heading": "V. SIMULATION",
            "text": "The effectiveness of the aforementioned closed loop control scheme is demonstrated in simulation using the system architecture shown in Fig. 2 with the 7DOF vehicle model (i.e., (1)-(9)) parameterised using a Jaguar XJ vehicle as shown in Table I. Online estimation of the augmented state vector \u03c7k is done in all scenarios where the road surface friction is modelled using the Magic formula with the parameters of the road surface shown in Table II. It is acknowledged that the tyre stiffness changes between road types demonstrating the insensitivity of this method to different tyres thus further showing the advantages of the DCEE based solution. Measurements of the ego body velocity and wheel speed [U, \u03c9f , \u03c9r] T are corrupted by the additive noise Vk such that Vk \u223c N ( [0, 0, 0] T , diag (0.2, 0.5, 0.5) ) .\nIn real world scenarios and in the context of ABS, the ego vehicle begins in an unknown environment, particularly if there has been rain or snow for example. Therefore the particles are initialised with a set of parameter values that encompass all road types and scenarios mentioned here. These are represented as uniform distributions: B \u2208 U [4, 21], C \u2208 U [1.2601, 1.601], D \u2208 U [0.2, 1.6] and E \u2208 U [\u221212, 2]. Additionally, since we assume the vehicle to be in an unknown environment we also assume proprioceptive uncertainty where we find the initial states to found from any low cost sensor then uniformly distributed as per the quality of the sensor. Although some sensors exhibit Gaussian noise, we do not need to make such assumption given our observer design. In the case of body velocity and wheel speed, they are within [v0 \u2212 2m/s, v0 + 2m/s] of the first GPS velocity measurement and [\u03c90 \u2212 3.5rad/s, \u03c90 + 3.5rad/s] from the wheel speed sensor.\n14"
        },
        {
            "heading": "A. Change In Initial Speed",
            "text": "In reality, the ABS should work in a wide range, from high to low speeds, including those above the normal driving speeds i.e. above the typical speed limit. Therefore, we tested the proposed DCEE based solution for a range of initial velocities, from 10mph to 100mph, and aimed to stop the vehicle as soon as possible. Simulation results are shown in Fig. 5. Beneficial to this technique is that no gain tuning is required between operating points i.e., the same model, as well as the same parameter values, are used for each starting velocity. No locking of the wheel occurs and the vehicle uniformly decelerates over all velocities. One notices the oscillation in the wheel speed at low body velocities when staring from 30 and 10mph. This may be attributed to the low number of steps the controller has taken where the PF does not converge as well therefore not holding as steady wheel deceleration. Although this is only for a very short period of 0.2s. Furthermore, initial variation, particularly in the 100mph test case, is a result of the the controller uncertainty in the location of the maximum tyre force. This period is short since the controller can quickly identify and reach the appropriate tyre force. Further oscillations in the wheel speed are due to the observer resampling which is always greater in the initial period as the filter converges to the\n15\ntrue state/parameter, but exist throughout the manoeuvre. This is required to prevent degradation in the filter and improve the identification of less sensitive parameters.\nVery quick convergence of the ego states is achieved as is shown on Figure 5. In fact less than 0.5% error is observed in all vehicle states after 13 time steps however the tyre model parameters requires a longer time and is aided throughout the scenario by the excitation caused through the explorative effort of the DCEE controller."
        },
        {
            "heading": "B. Adverse Road Conditions",
            "text": "Road conditions vary a lot, from dry to muddy and from wet to snow. Furthermore, the road surface does not always remain the same. For example, water may collect on parts of the road but drain away on other sections of the road, thus ABS should be able to work efficiently and adapt to these changes. The robustness of our ABS solution to both static and changing road conditions is tested in this sub-section.\n1) Static Road Surface Estimation: The DCEE method is well suited to the online identification of many road surfaces with the estimation result of dry, wet and snow covered road surfaces during an ABS manoeuvre from 20m/s shown in Fig. 6. The road surfaces are identified correctly, estimating the initial non-sliding elastic region and defining the maxima appropriately. Small errors found at higher slips where the vehicle has had limited experience\n16\nfor, i.e., driving the vehicle to a condition when the slip ratio equals to 0.4 would cause significant sliding thus the vehicle never reaches this. Therefore due to the lower exploration effort, the identification performance becomes degraded. However, as the goal of the ABS is to keep the vehicle working at the condition when the friction coefficient achieves the maximum value, the results are more than acceptable.\n2) Dynamic Road Surface: The RPF estimation results of individual parameters for a time-varying road surface (the road surface changes from dry to wet at 0.5s) can be found in Fig. 7 where the sensitivity of the parameters is made clear. Parameter D converges almost immediately and tracks the step change very well. Comparing this to the original result (that does not use Retrogressive resampling) in Fig. 4, one can clearly conclude the importance of the Retrogressive resampling approach. The remaining parameters have mixed tracking performance with parameter E showing to be insensitive to changes throughout the surface but without any detrimental impact on the controller or vehicle since this parameter governs the sliding region of the tyre model which the ABS prevents the vehicle from operating in. More importantly, one may look to the product of the parameters B, C and D since this defines the gradient of the slip-\u00b5 curve and by taking the arcsine of this product one finds the angle of the slope. Shown in Fig. 7, one can observe that this estimation is slower than that for parameter D, eventually converging by the end of the manoeuvre.\nThe vehicle behaviour during the braking procedure can be assessed by tyre forces, as shown in Fig. 8. The maximum available tyre force is time-varying. Thus, the weight transfer during the manoeuvre is also time-varying. However, the DCEE method is able to continually drive the vehicle to this varying operating condition without lock of any wheels. Estimation of the current time-varying friction coefficient at the wheels closely tracks the true friction (see Fig. 8) along with holding a steady state error of less than 0.02 (i.e., \u2264 3%) with maximum available.\nIt can be shown that by including the Retrogressive resampling step one not only improves the augmented state estimation but also reduces the uncertainty of the location of the maximum available tyre force. Shown in Fig. 9 is a comparison between the same changing road surface scenario with and without the resampling step. By using\n17\nthis method, one reduces the estimation uncertainty (especially after 0.5s when the vehicle is driven on a wet road) and provides a quicker (i.e., within 0.1s) convergence to the steady state."
        },
        {
            "heading": "C. Comparison with Extremum Seeking Control",
            "text": "To demonstrate the superiority of our DCEE method above existing schemes, we make comparison with two Extremum Seeking Control (ESC) for the ABS problem, referred to as Continuous Sine Perturbation (CSP) [40] and Bisection method (Bisection) [1]. Having identified the optimal slip ratio we utilise the P-controller and reachability based control schemes also presented in these works. The P-controller uses the gain c = 500, chosen to match the performance for our vehicle whereas all other parameters for the CSP model remain the same. The sampling time is, \u2206T = 0.001 and the initial conditions for the Bisection method are: a = 0.1, b = 0.2 and tolerance is ld = 0.001. Measurements of the ego velocity and wheel speed are made in all systems whereby a low pass filter with cutoff frequencies of 20Hz and 100Hz for ego body and wheel speed sensors respectively are used to remove the noise except in the DCEE approach where the aforementioned Particle Filter is used. Simulation results are displayed in Figs. 10 and 11.\n18\nIn this example, the DCEE approach is compared to both ESC methods, stopping the vehicle in 2.274s which is 15.0% faster than the CSP method and 11.7% faster than the bisection method. This leads to an overall stopping distance of 24.45m that is 2.09m shorter than that of CSP and 1.56m than that of the bisection method. Noticeably, the reachability controller used in the bisection method is unable to maintain a stable wheel speed and tends away from constant vehicle deceleration. Furthermore, one may notice slightly slower deceleration of the wheel speed which can be attributed to the DCEE being primarily driven by the exploration of the state and parameter space. This however is beneficial since the wheel speed in our method begins a steady deceleration much faster than either of the ESC methods and with no chatter. Similarly the other methods also go through the explorative phase although are only identifying the optimal slip, not the road condition as and optimal tyre force as we are. The bisection method has large oscillations, undershooting the correct wheel speed and the CSP method undershoots\n19\nbut at steady state, reaching a slower deceleration thus causing higher wheel speeds.\nNoticeably the vehicle with DCEE is able to achieve a greater total tyre force given the transient loading condition and is highlighted in Fig. 11. The inclusion of the suspension dynamics is imperative for simulation and shows the limitation for classical adaptive control, such as the CSP, fails to maintain as large tyre force throughout the\n20\ntransient loading behaviour of the vehicle. Conversely the Bisection method is able to track this change although with significant instability, extending into the steady state part of the manoeuvre. Our DCEE method achieves and maintains a greater total tyre force with superior stability even while identifying the tyre model parameters which the other methods do not."
        },
        {
            "heading": "VI. CONCLUSION",
            "text": "The DCEE method has been demonstrated as an effective ABS solution. Estimation of vehicle states from noisy sensors and identification of Magic formula tyre model parameters are done so within this framework in an online manner. We have extended the use of the particle filtering method to parameter identification in the presence of sudden changes in operation using the Retrogressive resampling method which incorporates the estimation uncertainty of the maximum available tyre force in a holistic, goal-orientated way. This work shows a performance margin of up to 15% in stopping time and 8.5% in stopping distance compared to existing ABS methods while achieving a higher steady state braking force.\nFuture work may include introducing a longer prediction horizon to the DCEE methodology to bring greater stability in the control action although would undoubtedly introduce higher computational cost. Whilst this method considers unknown vehicle states and unknown vehicle parameters, extending this framework to identify the transient tyre behaviour would also be beneficial."
        }
    ],
    "title": "An Exploration-Exploitation Approach to Anti-lock Brake Systems",
    "year": 2023
}