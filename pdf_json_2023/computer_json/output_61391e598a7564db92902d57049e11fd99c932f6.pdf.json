{
    "abstractText": "Model Predictive Control (MPC) provides an optimal control solution based on a cost function while allowing for the implementation of process constraints. As a model-based optimal control technique, the performance of MPC strongly depends on the model used where a trade-off between model computation time and prediction performance exists. One solution is the integration of MPC with a machine learning (ML) based process model which are quick to evaluate online. This work presents the experimental implementation of a deep neural network (DNN) based nonlinear MPC for Homogeneous Charge Compression Ignition (HCCI) combustion control. The DNN model consists of a Long Short-Term Memory (LSTM) network surrounded by fully connected layers which was trained using experimental engine data and showed acceptable prediction performance with under 5% error for all outputs. Using this model, the MPC is designed to track the Indicated Mean Effective Pressure (IMEP) and combustion phasing trajectories, while minimizing several parameters. Using the acados software package to enable the real-time implementation of the MPC on an ARM Cortex A72, the optimization calculations are completed within 1.4 ms. The external A72 processor is integrated with the prototyping engine controller using a UDP connection allowing for rapid experimental deployment of the NMPC. The IMEP trajectory following of the developed controller was excellent, with a root-meansquare error of 0.133 bar, in addition to observing process constraints.",
    "authors": [
        {
            "affiliations": [],
            "name": "David C. Gordon"
        },
        {
            "affiliations": [],
            "name": "Alexander Winkler"
        },
        {
            "affiliations": [],
            "name": "Julian Bedei"
        },
        {
            "affiliations": [],
            "name": "Patrick Schaber"
        },
        {
            "affiliations": [],
            "name": "Jakob Andert"
        },
        {
            "affiliations": [],
            "name": "Charles R. Koch"
        }
    ],
    "id": "SP:6ff9f4497370c288cfc9cc10ab152815766f0d46",
    "references": [
        {
            "authors": [
                "James Blake Rawlings",
                "David Q Mayne",
                "Moritz Diehl"
            ],
            "title": "Model predictive control: theory, computation, and design",
            "year": 2017
        },
        {
            "authors": [
                "Jos\u00e9 David L\u00f3pez",
                "Jairo Jos\u00e9 Espinosa",
                "John Ramiro Agudelo"
            ],
            "title": "LQR control for speed and torque of internal combustion engines",
            "venue": "IFAC Proceedings Volumes",
            "year": 2011
        },
        {
            "authors": [
                "Armin Norouzi"
            ],
            "title": "Adaptive sliding mode control of a four-wheel-steering autonomous vehicle with uncertainty using parallel orientation and position control",
            "venue": "In: International Journal of Heavy Vehicle Systems",
            "year": 2020
        },
        {
            "authors": [
                "Eugene Lavretsky",
                "Kevin A Wise"
            ],
            "title": "Robust adaptive control",
            "venue": "Robust and adaptive control. Springer,",
            "year": 2013
        },
        {
            "authors": [
                "LN Aditya Basina"
            ],
            "title": "Data-driven modeling and predictive control of maximum pressure rise rate in RCCI engines",
            "venue": "IEEE Conference on Control Technology and Applications (CCTA 2020)",
            "year": 2020
        },
        {
            "authors": [
                "Jay H Lee"
            ],
            "title": "Model predictive control: Review of the three decades of development",
            "venue": "In: International Journal of Control, Automation and Systems",
            "year": 2011
        },
        {
            "authors": [
                "F. Allg\u00f6wer"
            ],
            "title": "Nonlinear Predictive Control and Moving Horizon Estimation \u2014 An Introductory Overview",
            "venue": "Advances in Control",
            "year": 1999
        },
        {
            "authors": [
                "Dominic Liao-McPherson"
            ],
            "title": "Model predictive emissions control of a diesel engine airpath: Design and experimental evaluation",
            "venue": "In: International Journal of Robust and Nonlinear Control",
            "year": 2020
        },
        {
            "authors": [
                "Armin Norouzi"
            ],
            "title": "Integrating machine learning and model predictive control for automotive applications: A review and future directions",
            "venue": "Engineering Applications of Artificial Intelligence",
            "year": 2023
        },
        {
            "authors": [
                "Hermann Breitbach"
            ],
            "title": "Lean-burn Stratified Combustion at Gasoline Engines",
            "venue": "MTZ Worldwide",
            "year": 2013
        },
        {
            "authors": [
                "Ian Adcock"
            ],
            "title": "ICE Breaker! Mazda\u2019s Skyactiv-X using SpCCI",
            "venue": "SAE Automotive Engineering",
            "year": 2017
        },
        {
            "authors": [
                "Morteza Fathi",
                "Omid Jahanian",
                "Mahdi Shahbakhti"
            ],
            "title": "Modeling and controller design architecture for cycleby-cycle combustion control of homogeneous charge compression ignition (HCCI) engines \u2013 A comprehensive review",
            "venue": "Energy Conversion and Management",
            "year": 2017
        },
        {
            "authors": [
                "Masoud Aliramezani",
                "Charles Robert Koch",
                "Mahdi Shahbakhti"
            ],
            "title": "Modeling, diagnostics, optimization, and control of internal combustion engines via modern machine learning techniques: A review and future directions",
            "venue": "Progress in Energy and Combustion Science",
            "year": 2022
        },
        {
            "authors": [
                "Mingxin Yu"
            ],
            "title": "Diesel engine modeling based on recurrent neural networks for a hardware-in-the-loop simulation system of diesel generator sets",
            "venue": "In: Neurocomputing",
            "year": 2018
        },
        {
            "authors": [
                "Julian Bedei"
            ],
            "title": "Dynamic measurement with incycle process excitation of HCCI combustion: The key to handle complexity of data-driven control?",
            "venue": "In: International Journal of Engine Research",
            "year": 2023
        },
        {
            "authors": [
                "Aur\u00e9lien G\u00e9ron"
            ],
            "title": "Hands-on machine learning with Scikit- Learn, Keras, and TensorFlow: Concepts, tools, and techniques to build intelligent systems",
            "venue": "O\u2019Reilly Media,",
            "year": 2019
        },
        {
            "authors": [
                "S. Hochreiter",
                "J. Schmidhuber"
            ],
            "title": "Long short-term memory",
            "venue": "Neural Computation",
            "year": 1997
        },
        {
            "authors": [
                "Byung-Ki Jeon",
                "Eui-Jong Kim"
            ],
            "title": "LSTM-Based Model Predictive Control for Optimal Temperature Set- Point Planning",
            "venue": "Sustainability",
            "year": 2021
        },
        {
            "authors": [
                "David C. Gordon"
            ],
            "title": "End-to-End Deep Neural Network Based Nonlinear Model Predictive Control: Experimental Implementation on Diesel Engine Emission Control",
            "venue": "In: Energies",
            "year": 2022
        },
        {
            "authors": [
                "Robin Verschueren"
            ],
            "title": "acados: a modular open-source framework for fast embedded optimal control",
            "year": 2019
        },
        {
            "authors": [
                "David Carl Gordon"
            ],
            "title": "Realtime Machine Learning based In-Cycle Control of Homogeneous Charge Compression Ignition",
            "venue": "PhD thesis",
            "year": 2023
        },
        {
            "authors": [
                "David Gordon"
            ],
            "title": "Development and experimental validation of a real-time capable field programmable gate array\u2013based gas exchange model for negative valve overlap",
            "venue": "In: International Journal of Engine Research",
            "year": 2018
        },
        {
            "authors": [
                "Armin Norouzi"
            ],
            "title": "Deep learning based model predictive control for compression ignition engines",
            "venue": "Control Engineering Practice",
            "year": 2022
        },
        {
            "authors": [
                "Moritz Diehl",
                "Hans Joachim Ferreau",
                "Niels Haverbeke"
            ],
            "title": "Efficient Numerical Methods for Nonlinear MPC and Moving Horizon Estimation",
            "year": 2009
        },
        {
            "authors": [
                "Robin Verschueren"
            ],
            "title": "acados \u2013 a modular opensource framework for fast embedded optimal control",
            "venue": "Mathematical Programming Computation",
            "year": 2021
        },
        {
            "authors": [
                "Gianluca Frison"
            ],
            "title": "An efficient implementation of partial condensing for Nonlinear Model Predictive Control",
            "year": 2016
        },
        {
            "authors": [
                "Gianluca Frison",
                "Moritz Diehl"
            ],
            "title": "HPIPM: a highperformance quadratic programming framework for model predictive control",
            "venue": "IFAC-PapersOnLine",
            "year": 2020
        },
        {
            "authors": [
                "Christian Wouters"
            ],
            "title": "Evaluation of the Potential of Direct Water Injection in HCCI Combustion",
            "venue": "SAE Technical Paper Series. SAE International,",
            "year": 2019
        }
    ],
    "sections": [
        {
            "text": "I. Introduction Model-based optimal control techniques leverage the significant advances in system modeling and the computational performance increases seen over the last two decades [1]. A wide range of model-based control methods have been investigated including: linear quadratic regulator [2], sliding mode controller [3], adaptive control [4], and Model Predictive Control (MPC) [5]. Of these model-based control strategies MPC is the most widely used in a range of applications [6]. Which takes advantage of the ability of MPC to provide an optimal control solution while allowing for the implementation of constraints on system states and controller outputs [7]. For automotive applications, MPC sounds like an ideal solution as internal combustion engines (ICEs) have\n1Teaching and Research Area Mechatronics in Mobile Propulsion, RWTH Aachen University, Forckenbeckstrasse 4, 52074 Aachen, Germany. andert@mmp.rwth-aachen.de\n2University of Alberta, 116 St and 85 Ave, Edmonton, AB T6G 2R3, Canada. dgordon@ualberta.ca\nnonlinear process dynamics and have many constraints that must be obeyed, however, the high computational demand of the online MPC has meant that it has only recently been applied to vehicles [8, 9]. One such solution is the integration of black-box machine learning (ML) process models which are quick to evaluate during MPC optimization.\nOne specific application of interest for the application of MPC is the combustion control of Homogeneous Charge Compression Ignition (HCCI) which has shown promise in reducing engine-out emissions (99% reduction in NOx vs modern gasoline combustion [10]) and increasing efficiency (up to 30% compared to current gasoline engines [11]). The challenge is that HCCI is susceptible to large cyclic variations and correspondingly poor combustion stability as the combustion process lacks a direct mechanism to control combustion timing [12]. Specifically, HCCI operation suffers from significant cycle-to-cycle coupling, resulting from high exhaust gas re-circulation, leading to bounded operation due to misfire at low loads and high-pressure rise rates and peak pressure at high loads which complicates modeling and control implementation.\nSeveral ML techniques have been widely used for addressing engine performance, emission modeling and control [13\u201315]. As HCCI combustion experiences significant cyclic coupling a Recurrent Neural Network (RNN) is of interest for process modeling due to the inclusion of backward connections to handle sequential inputs [16]. However, the contribution of earlier time steps become increasingly small (the \u201cvanishing gradient\u201d) and thus RNN cannot accurately capture long-term dependencies in the process. Therefore, memory cells can be introduced of which the Long Short-Term Memory (LSTM) cell is the most common [17]. Each LSTM cell has two recurrent loops, one for long-term information and one for shortterm information. However, traditionally the integration of an LSTM model into a nonlinear Model Predictive Controller (NMPC) has been focused on slow-response applications such as temperature set-point planning for buildings [18]. Recent progress in the experimental application of LSTM-NMPC to high-speed systems including diesel combustion control has shown great potential of the strategy [19]. Unlike the existing literature, this work demonstrates the implementation of a real-time controller on an external ARM Cortex A72 processor using the acados optimal control framework to allow for ar X iv :2 31 0.\n08 39\n2v 1\n[ ee\nss .S\nY ]\n1 2\nO ct\n2 02\n3\nreal-time execution of the NMPC for control of HCCI combustion [20]. The controller will be designed to track engine load and combustion timing trajectories while minimizing fuel and water consumption, pressure rise rates, and NOx emissions."
        },
        {
            "heading": "II. Experimental Setup",
            "text": "A single cylinder research engine (SCRE) outfitted with a fully variable electromechanical valve train (EMVT) is used. The EMVT system allows for engine operation with a variety of valve strategies, however, in this work only negative valve overlap (NVO) will be used to provide the required thermal energy for HCCI combustion. Fuel, conventional European RON 95 gasoline with 10 % ethanol, and distilled water is directly injected into the combustion chamber. Full engine details can be found in [21]. The SCRE is controlled using a dSPACE MicroAutoBox II (MABX) rapid control prototyping (RCP) ECU containing an Xilinx Kintex-7 FPGA which is used to calculate combustion metrics in realtime [22]."
        },
        {
            "heading": "III. Deep Neural Network-based Engine Model",
            "text": "To model the HCCI engine performance and emissions, a deep neural network (DNN) with seven hidden layers (six Fully Connected (FC) layers and one LSTM layer) was developed as shown in Fig 1.\nTo train this DNN, which has 2260 learnable parameters, a data set of 65,000 consecutive cycles was collected from the SCRE. During the engine operation, the process inputs of duration of injection (DOI) of fuel, DOI of water, and negative valve overlap (NVO) duration were varied in both amplitude and frequency. Then, using a similar training process to previous work, the combustion outputs of engine load represented by indicated mean effective pressure (IMEP), combustion phasing angle (CA50), maximum pressure rise rate (MPRR) and engine out nitrogen oxide emissions NOx were predicted [19]. The overall accuracy of this model for each output is summarized in Table I which lists the mean squared error in percent for training and validation data. MPRR was the most difficult parameter to predict, with a 4.7% error on the validation dataset, while other outputs were predicted with less than 4% error.\nFor implementation into an MPC, this model is formulated using a nonlinear state-space representation to\nallow for integration into acados as described in [23]. The nonlinear state-space model is given by\nx(k + 1) = f (x(k), u(k)) , (1a) y(k) = fFC,out (f (x(k), u(k))) ,\n= g (x(k), u(k)) , (1b)\nwith f combining the input and LSTM layers, fF C,out representing the output layers. Here x(k) are the internal model states (corresponding to the LSTM: four cell states, c(k), and four hidden states, h(k)), y(k) the model outputs, and u(k) the model inputs. These are:\nx(k) = [\nc(k \u2212 1) h(k \u2212 1)\n] \u2208 R8, y(k) =  yIMEP(k) yCA50(k) yNOx(k)\nyMPRR(k)\n \u2208 R4,\nu(k) =  yIMEP(k \u2212 1) yCA50(k \u2212 1) uDOI,fuel(k)\nuDOI,water(k) uNVO(k)  \u2208 R5. (2) To reduce the oscillation of the outputs, the gradient of manipulated variables is added as new inputs [24]. This ensures that the positive definite weighting matrix forces the change to zero thus allowing the controller to achieve the desired output setpoints:[\nx(k + 1) u(k) ] \ufe38 \ufe37\ufe37 \ufe38\nx\u0303(k+1)\n= [ f(x(k), u(k \u2212 1) + \u2206u(k))\nu(k \u2212 1) + \u2206u(k) ] \ufe38 \ufe37\ufe37 \ufe38\nf\u0303(x\u0303(k),\u2206u(k))\n, (3a)\n[ y(k)\nu(k \u2212 1) ] \ufe38 \ufe37\ufe37 \ufe38\ny\u0303(k)\n= [\ng(x(k)) u(k \u2212 1) ] \ufe38 \ufe37\ufe37 \ufe38\ng\u0303(x\u0303(k))\n. (3b)\nThis formulation allows for both the absolute inputs and their gradient to be penalized within the cost function.\nThus, the discrete Optimal Control Problem (OCP) is defined as follows\nmin \u2206u0,...,\u2206uN\u22121\nx\u03030,...,x\u0303N y\u03030,...,y\u0303N\nN\u2211 i=0 \u2225ri \u2212 y\u0303i\u22252Q + \u2225\u2206uj\u2225 2 R\ns.t. x\u03030 = [ x(k), u(k \u2212 1) ]\u22a4 ,\nx\u0303i+1 = f\u0303(x\u0303i, \u2206ui) \u2200i \u2208 H \\ N, y\u0303i = g\u0303(x\u0303i, \u2206ui) \u2200i \u2208 H,\numin \u2264 Fu \u00b7 u\u0303k \u2264 umax \u2200i \u2208 H, ymin \u2264 Fy \u00b7 y\u0303k \u2264 ymax \u2200i \u2208 H\n(4)\nwhere H = {0, 1, . . . , N}. The reference r\u0303i and the weighting matrix Q are selected such that deviations from the requested IMEP and CA50 are penalized while minimizing NOx emissions, duration of injected fuel DOI,fuel(k) and water DOI,water(k) and change in control input \u2206u. Therefore, the specific cost function J is\nspecified as\nJ = N\u2211\ni=0 \u2225rIMEP,i \u2212 yIMEP,i\u22252qIMEP\ufe38 \ufe37\ufe37 \ufe38\nReference Tracking\n+ \u2225rCA50,i \u2212 yCA50,i\u22252qCA50\ufe38 \ufe37\ufe37 \ufe38 Reference Tracking + \u2225uDOI,fuel,i\u22252rDOI,fuel + \u2225uDOI,water,i\u2225 2 rDOI,water\ufe38 \ufe37\ufe37 \ufe38\nFuel / Water consumption reduction\n+ \u2225yNOx,i\u2225 2 qNOx\ufe38 \ufe37\ufe37 \ufe38\nEmission Reduction\n+ \u2225\u2206ui\u22252R\ufe38 \ufe37\ufe37 \ufe38 Oscillation Reduction\n(5)\nOne significant advantage of using MPC for combustion control is the ability to impose constraints on inputs and outputs to ensure safe engine operation. Fu and Fy in Eq. 4 are diagonal matrices which map the bounded outputs and inputs. The control outputs are limited to match the hardware used (umin,max) while constraints imposed on the outputs (ymin,max) are used to guarantee safe engine operation as summarized in Table II. In this work the constraints are not overly restrictive, however, in future testing, these limits could be modified to meet specific legislation or design constraints."
        },
        {
            "heading": "IV. Experimental deployment of LSTM-NMPC",
            "text": "engine control is the limited calculation time available. For this work, the engine is operated at 1500 rpm resulting in one complete engine cycle taking 80 ms. The\ncombustion metrics, calculated on the FPGA, are completed at 60 crank angle degrees (CAD) after top dead center (aTDC) [22] and the valve timing setpoint must be known by 260 CAD, so only 200 CAD or 22 ms are available for the NMPC calculation. To meet the real-time requirements, the computationally efficient open source package acados is used [25]. When compared to previous LSTM-based NMPC integration [19], this work offloads the NMPC calculation to an ARM Cortex A72 processor located in a Raspberry Pi 400 (RPI) overclocked to 2.2 Ghz clock frequency. The RPI communicates with the main engine controller running on the dSPACE MABX II over UDP as shown in Figure 2.\nThe NMPC calculation on the RPI is standalone from the main engine controller (dSpace MABX II) other than receiving the current measured states (MPRR, IMEP, CA50 and NOx emissions) and reference from the MABX as shown in figure 3. Both the optimizer and LSTM model are calculated on the RPI where the\n0 50 100 150 200 250 300 350 400 450 500 550 600 6500\n5\n10\n15\nCycle [-]\nC A 50 [C A D\naT D\nC ]\n0 50 100 150 200 250 300 350 400 450 500 550 600 6501.5 2\n2.5 3\n3.5\nIM EP [b ar ]\n0 50 100 150 200 250 300 350 400 450 500 550 600 6500 8\n16\nM PR R [b ar /C\nA D\n]\n0 50 100 150 200 250 300 350 400 450 500 550 600 6500 100 200 300 N O x [p pm ]\n0 50 100 150 200 250 300 350 400 450 500 550 600 6500.6 0.7 0.8 0.9 D O I fu el [m s]\n0 50 100 150 200 250 300 350 400 450 500 550 600 6500 0.2 0.4 D O I w at er [m s]\n0 50 100 150 200 250 300 350 400 450 500 550 600 650 180 200 220 N V O [C A D ]\nFig. 3: Experimental cycle-to-cycle NMPC implementation on ARM Cortex A72: Showing IMEP reference tracking performance. Experimental data shown in blue, DNN model data in black and reference shown in dashed red.\ncalculated actuations for the next cycle are sent to the MABX II. One significant benefit of this formulation is that the NMPC model can be updated or replaced without rebuilding the main engine control software, thus significantly reducing the development time of the controller. Additionally, this modular controller design allows for the NMPC to be executed on any external processor that can interface with the MABX II over the user datagram protocol (UDP).\nWhen compared to other MPC implementations, in simulation acados outperforms both MATLAB\u2019s MPC toolbox using fmincon as well as the FORCES PRO backends [23]. This difference in solver performance is attributed to the higher dimension of the state than the\ncontrol input vector in addition to the short prediction horizon of three cycles needed to model HCCI ICE dynamics. This allows the OCP solver to take full advantage of the condensation benefits [24, 26].\nAs no discretization is required for the model used, the plant model can be directly implemented using the discrete dynamics interface of acados. The Gauss-Newton approximation is used for the computation of the Hessian in the underlying Sequential Quadratic Programming (SQP) algorithm. The Optimal Control Problem in Eq. 4 leads to a band diagonal structure in the matrices of the Quadratic Problems (QPs) which are solved using the Interior Point (IP) based QP solver hpipm [27], that is provided by the acados package [25].\nUsing a model-in-the-loop (MiL) simulation run on the targeted hardware; the weights, number of SQP iterations and prediction horizon are defined for the NMPC. These MiL simulations showed that three SQP iterations can be completed in the available calculation window. Additionally, as previous work has shown that the cycle-to-cycle dependency of HCCI lasts approximately two cycles so a prediction horizon of three cycles is sufficient [28].\nFor experimental implementation, a reference load profile is provided to the controller using a target IMEP. Additionally, a reference CA50 is provided to keep the combustion phasing at an efficient operation point of 6 CAD aTDC. Using the constraints specified in Table II the NMPC is implemented and the experimental LSTM-NMPC performance can be seen in figure 3. As the NMPC allows for multi-objective tracking both the IMEP and CA50 tracking performance will be evaluated. A simulated load profile of varying IMEP steps is provided resulting in a tracking performance of 0.133 bar RSME while being able to keep the CA50 at the setpoint of 6 CAD aTDC with an RSME of 1.83 CAD. As expected, the duration of fuel injection corresponds with the requested IMEP. This trend is also seen in the NVO duration where with increased fuelling a reduced NVO is requested to allow more air into the cylinder.\nThe constraints applied are obeyed for all but one of the cycles (cycle 552) where the 300 ppm constraint on NOx emissions is slightly exceeded to 305 ppm. This is likely due to plant-model mismatch, resulting from the model predicting a slightly lower NOx output than experimental data. With reference to Figure 3, the model prediction for both CA50 and IMEP parameters appear damped compared to the experimental values. However, for both engine performance metrics, the model is able to capture the trends quite accurately with the DNN model predicting IMEP with an RSME of 0.09 bar and for CA50 the RSME is 1.27 CAD.\nThe experimental testing of the acados NMPC executed on the ARM Cortex A72 external processor resulted in an average execution time of 1.18 ms with all calculations taking below 1.4 ms for each of the 650 cycles tested. Even with the 1 ms UDP communication time, the NMPC is below the 22 ms available and shows that if needed the model complexity could be increased with the computational power available.\nThe LSTM model used in the NMPC implementation has the ability for the cell and hidden states to vary depending on the current engine output. This allows the LSTM model to adapt as the engine changes. The change in the LSTM states can be seen in Figure 4. These are not physical but rather internal states resulting from the structure of the DNN model used.\nWhen compared to the time and resource-intensive process traditionally used for developing a look-up tablebased control strategy the LSTM-based NMPC provides a strategy to allow for rapid controller development.\nFor the model used in this work, the experimental data collected (65,000 engine cycles) took 1.5 hours of testbench time to collect. Often the most significant drawback of blackbox-based models is the required training time for the model itself, however, using modern computing hardware (Intel I7-12700K based PC with a NVIDIA RTX 3090Ti) the model training took just under 3 hours. Taking advantage of the flexibility of acados allows for efficient NMPC design and integration to the external processor. This control design process is significantly quicker than traditional engine control development which can save time and reduce calibration effort and costs while providing improved controller performance by allowing for the integration of an optimal control strategy on experimental hardware."
        },
        {
            "heading": "V. Conclusions",
            "text": "Overall, the development and experimental implementation of an LSTM-based NMPC executed on an external processor using the acados framework was shown. To train the DNN process model, which has 2260 learnable parameters, a data set of 65,000 consecutive cycles was used. The DNN network consists of an LSTM layer, used to capture long-term dependencies and cyclic coupling, surrounded by fully connected layers providing a computationally efficient model of the HCCI combustion outputs (IMEP, MPRR, CA50 and NOx). This model resulted in an error below 5% for all outputs on validation data.\nUsing this DNN model of the HCCI process, the opensource software acados provided the required embedded programming for real-time implementation of the LSTMNMPC. Experimental testing showed HCCI cycle-tocycle combustion control provided good load and combustion phasing tracking while simultaneously obeying process constraints. With an average turnaround time of 1.18 milliseconds, this work showed the potential of the ML-based NMPC on a real-time system where only 22 ms was available for NMPC calculation and actuation.\nThe advantage of the proposed LSTM-NMPC implementation allows for a shorter controller development time and efficient MPC integration.\nThe proof of concept shown in this work can then be further improved by tightening process constraints to match emission legislation and to improve the longevity of the engine. Additionally, the developed toolchain for ML-based NMPC could be applied to other nonlinear constrained systems including ICEs utilizing alternative fuels or hydrogen fuel cells."
        },
        {
            "heading": "Acknowledgements",
            "text": "The research was performed under the Natural Sciences Research Council of Canada Grant 2022-03411 and as part of the Research Unit (Forschungsgruppe) FOR 2401 \u201cOptimization based Multiscale Control for Low Temperature Combustion Engines\u201d which is funded by the German Research Association (Deutsche Forschungsgemeinschaft, DFG)."
        }
    ],
    "title": "Introducing a Deep Neural Network-based Model Predictive Control Framework for Rapid Controller Implementation",
    "year": 2023
}