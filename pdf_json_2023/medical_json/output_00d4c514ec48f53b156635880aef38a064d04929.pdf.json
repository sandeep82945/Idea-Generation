{
    "abstractText": "Likelihood-based tests of phylogenetic trees are a foundation of modern systematics. Over the past decade, an enormous wealth and diversity of model-based approaches have been developed for phylogenetic inference of both gene trees and species trees. However, while many techniques exist for conducting formal likelihood-based tests of gene trees, such frameworks are comparatively underdeveloped and underutilized for testing species tree hypotheses. To date, widely used tests of tree topology are designed to assess the fit of classical models of molecular sequence data and individual gene trees and thus are not readily applicable to the problem of species tree inference. To address this issue, we derive several analogous likelihood-based approaches for testing topologies using modern species tree models and heuristic algorithms that use gene tree topologies as input for maximum likelihood estimation under the multispecies coalescent. For the purpose of comparing support for species trees, these tests leverage the statistical procedures of their original gene tree-based counterparts that have an extended history for testing phylogenetic hypotheses at a single locus. We discuss and demonstrate a number of applications, limitations, and important considerations of these tests using simulated and empirical phylogenomic data sets that include both bifurcating topologies and reticulate network models of species relationships. Finally, we introduce the open-source R package SpeciesTopoTestR (Species Topology Tests in R) that includes a suite of functions for conducting formal likelihoodbased tests of species topologies given a set of input gene tree topologies.",
    "authors": [
        {
            "affiliations": [],
            "name": "Richard Adams"
        },
        {
            "affiliations": [],
            "name": "Michael DeGiorgio"
        },
        {
            "affiliations": [],
            "name": "Yoko Satta"
        }
    ],
    "id": "SP:5cb2b753bd83f113a482fe121dbc20c461546849",
    "references": [
        {
            "authors": [
                "Adams RH",
                "Castoe TA."
            ],
            "title": "Statistical binning leads to profound model violation due to gene tree error incurred by trying to avoid gene tree error",
            "venue": "Mol Phyl Evol. 134:164\u2013171.",
            "year": 2019
        },
        {
            "authors": [
                "RH Adams",
                "DR Schield",
                "DC Card",
                "TA. Castoe"
            ],
            "title": "Assessing the impacts of positive selection on coalescent-based species tree estimation and species delimitation",
            "venue": "Syst Biol. 67:1076\u20131090.",
            "year": 2018
        },
        {
            "authors": [
                "M Anisimova",
                "O. Gascuel"
            ],
            "title": "Approximate likelihood-ratio test for branches: a fast, accurate, and powerful alternative",
            "venue": "Syst Biol. 55: 539\u2013552.",
            "year": 2006
        },
        {
            "authors": [
                "Ayala FJ."
            ],
            "title": "Darwin and the scientific method",
            "venue": "Proc Natl Acad Sci U S A. 106 Suppl 1(Suppl 1):10033\u201310039.",
            "year": 2009
        },
        {
            "authors": [
                "Brandon RN."
            ],
            "title": "Theory and experiment in evolutionary biology",
            "venue": "Synthese 99:59\u201373.",
            "year": 1994
        },
        {
            "authors": [
                "D Bryant",
                "R Bouckaert",
                "J Felsenstein",
                "NA Rosenberg",
                "A. RoyChoudhury"
            ],
            "title": "Inferring species trees directly from biallelic genetic markers: bypassing gene trees in a full coalescent analysis",
            "venue": "Mol Biol Evol. 29:1917\u20131932.",
            "year": 2012
        },
        {
            "authors": [
                "Buckley TR."
            ],
            "title": "Model misspecification and probabilistic tests of topology: evidence from empirical data sets",
            "venue": "Syst Biol. 51:509\u2013523.",
            "year": 2002
        },
        {
            "authors": [
                "R Burgess",
                "Z. Yang"
            ],
            "title": "Estimation of hominoid ancestral population sizes under Bayesian coalescent models incorporating mutation rate variation and sequencing errors",
            "venue": "Mol Biol Evol. 25: 1979\u20131994.",
            "year": 2008
        },
        {
            "authors": [
                "Carstens BC",
                "Dewey TA."
            ],
            "title": "Species delimitation using a combined coalescent and information-theoretic approach: an example from North American Myotis bats",
            "venue": "Syst Biol. 59:400\u2013414.",
            "year": 2010
        },
        {
            "authors": [
                "Carstens BC",
                "Knowles LL."
            ],
            "title": "Estimating species phylogeny from gene-tree probabilities despite incomplete lineage sorting: an example from Melanoplus grasshoppers",
            "venue": "Syst Biol. 56:400\u2013411.",
            "year": 2007
        },
        {
            "authors": [
                "Degnan JH",
                "Rosenberg NA."
            ],
            "title": "Gene tree discordance, phylogenetic inference and the multispecies coalescent",
            "venue": "Trends Ecol Evol. 24: 332\u2013340.",
            "year": 2009
        },
        {
            "authors": [
                "Y Du",
                "S Wu",
                "SV Edwards",
                "L. Liu"
            ],
            "title": "The effect of alignment uncertainty, substitution models and priors in building and dating the mammal tree of life",
            "venue": "BMC Evol Biol. 19:203.",
            "year": 2019
        },
        {
            "authors": [
                "Edwards SV"
            ],
            "title": "Is a new and general theory of molecular systematics emerging? Evolution 63:1\u201319",
            "year": 2009
        },
        {
            "authors": [
                "SV Edwards",
                "Z Xi",
                "A Janke",
                "BC Faircloth",
                "JE McCormack",
                "TC Glenn",
                "B Zhong",
                "S Wu",
                "EM Lemmon",
                "AR Lemmon"
            ],
            "title": "Implementing and testing the multispecies coalescent model: a valuable paradigm for phylogenomics",
            "venue": "Mol Phylogenet Evol",
            "year": 2016
        },
        {
            "authors": [
                "B Efron",
                "E Halloran",
                "S. Holmes"
            ],
            "title": "Bootstrap confidence levels for phylogenetic trees",
            "venue": "Proc Natl Acad Sci U S A. 93:13429\u201313434.",
            "year": 1996
        },
        {
            "authors": [
                "J. Felsenstein"
            ],
            "title": "Evolutionary trees from DNA sequences: a maximum likelihood approach",
            "venue": "J Mol Evol. 17:368\u2013376.",
            "year": 1981
        },
        {
            "authors": [
                "J. Felsenstein"
            ],
            "title": "Confidence limits on phylogenies: an approach using the bootstrap",
            "venue": "Evolution 39:783\u2013791.",
            "year": 1985
        },
        {
            "authors": [
                "M Forthman",
                "E Braun",
                "R. Kimball"
            ],
            "title": "Gene tree quality affects empirical coalescent branch length estimation",
            "venue": "Zoo Scripta. 51:1\u201313.",
            "year": 2022
        },
        {
            "authors": [
                "M Fourment",
                "AF Magee",
                "C Whidden",
                "A Bilge",
                "FA Matsen",
                "VN. Minin"
            ],
            "title": "19 Dubious ways to compute the marginal likelihood of a phylogenetic tree topology",
            "venue": "Syst Biol. 69:209\u2013220.",
            "year": 2020
        },
        {
            "authors": [
                "MK Fujita",
                "AD Leach\u00e9",
                "FT Burbrink",
                "JA McGuire",
                "C. Moritz"
            ],
            "title": "Coalescent-based species delimitation in an integrative taxonomy",
            "venue": "Trends Ecol Evol. 27:480\u2013488.",
            "year": 2012
        },
        {
            "authors": [
                "J Gaither",
                "L. Kubatko"
            ],
            "title": "Hypothesis tests for phylogenetic quartets, with applications to coalescent-based species tree inference",
            "venue": "J Theor Biol. 408:179\u2013186.",
            "year": 2016
        },
        {
            "authors": [
                "N. Goldman"
            ],
            "title": "Statistical tests of models of DNA substitution",
            "venue": "J Mol Evol. 36:182\u2013198.",
            "year": 1993
        },
        {
            "authors": [
                "N Goldman",
                "JP Anderson",
                "AG. Rodrigo"
            ],
            "title": "Likelihood-based tests of topologies in phylogenetics",
            "venue": "Syst Biol. 49:652\u2013670.",
            "year": 2000
        },
        {
            "authors": [
                "M Hasegawa",
                "H. Kishino"
            ],
            "title": "Confidence limits of the maximumlikelihood estimate of the hominoid three from mitochondrialDNA sequences",
            "venue": "Evolution 43:672\u2013677.",
            "year": 1989
        },
        {
            "authors": [
                "M Hasegawa",
                "H. Kishino"
            ],
            "title": "Accuracies of the simple methods for estimating the bootstrap probability of a maximum-likelihood tree",
            "venue": "142.",
            "year": 1994
        },
        {
            "authors": [
                "M Hasegawa",
                "H Kishino",
                "T. Yano"
            ],
            "title": "Dating of the human-ape splitting by a molecular clock of mitochondrial DNA",
            "venue": "J Mol Evol. 22:160\u2013174.",
            "year": 1985
        },
        {
            "authors": [
                "Heled J",
                "Drummond AJ."
            ],
            "title": "Bayesian Inference of species trees from multilocus data",
            "venue": "Mol Biol Evol. 27:570\u2013580.",
            "year": 2009
        },
        {
            "authors": [
                "DM Hillis",
                "BK Mable",
                "C. Moritz"
            ],
            "title": "Applications of molecular systematics: the state of the field and a look to the future",
            "venue": "In: Hillis DM, Moritz C, Mable BK, editors. Molecular systematics. Sunderland (MA): Sinauer. p. 515\u2013543.",
            "year": 1996
        },
        {
            "authors": [
                "S. Holmes"
            ],
            "title": "Statistical approach to tests involving phylogenies",
            "venue": "In: Gascuel O, editor. Mathematics of evolution and phylogeny. Oxford: Oxford University Press. p. 91\u2013120.",
            "year": 2005
        },
        {
            "authors": [
                "R. Hudson"
            ],
            "title": "Generating samples under a Wright\u2013Fisher neutral model of genetic variation",
            "venue": "Bioinformatics 18:337\u2013338.",
            "year": 2002
        },
        {
            "authors": [
                "Huelsenbeck JP",
                "Bull JJ."
            ],
            "title": "A likelihood ratio test to detect conflicting phylogenetic signal",
            "venue": "Syst Biol. 45:92\u201398.",
            "year": 1996
        },
        {
            "authors": [
                "Huelsenbeck JP",
                "Crandall KA."
            ],
            "title": "Phylogeny estimation and hypothesis testing using maximum likelihood",
            "venue": "Annu Rev Ecol Syst. 28:437\u2013466.",
            "year": 1997
        },
        {
            "authors": [
                "C Hung",
                "SV Drovetski",
                "RM. Zink"
            ],
            "title": "Multilocus coalescence analyses support a mtDNA-based phylogeographic history for a widespread palearctic passerine bird",
            "venue": "Evolution 66:2850\u20132864.",
            "year": 2012
        },
        {
            "authors": [
                "I Irisarri",
                "R. Zardoya"
            ],
            "title": "Phylogenetic hypothesis testing",
            "venue": "eLS.",
            "year": 2013
        },
        {
            "authors": [
                "ED Jarvis",
                "S Mirarab",
                "AJ Aberer",
                "B Li",
                "P Houde",
                "C Li",
                "SY Ho",
                "BC Faircloth",
                "B Nabholz",
                "JT. Howard"
            ],
            "title": "Whole-genome analyses resolve early branches in the tree of life of modern birds",
            "venue": "Science 346: 1320\u20131331.",
            "year": 2014
        },
        {
            "authors": [
                "X Jiang",
                "SV Edwards",
                "L. Liu"
            ],
            "title": "The multispecies coalescent model outperforms concatenation across diverse phylogenomic data sets",
            "venue": "Syst Biol. 69:795\u2013812.",
            "year": 2020
        },
        {
            "authors": [
                "A Kim",
                "J. Degnan"
            ],
            "title": "Pranc: Ml species tree estimation from the ranked gene trees under coalescence",
            "venue": "Bioinformatics 36:4819\u20134821.",
            "year": 2020
        },
        {
            "authors": [
                "H Kishino",
                "M. Hasegawa"
            ],
            "title": "Evaluation of the maximum likelihood estimate of the evolutionary tree topologies from DNA sequence data, and the branching order in Hominoidea",
            "venue": "J Mol Evol. 29:170\u2013179.",
            "year": 1989
        },
        {
            "authors": [
                "H Kishino",
                "T Miyata",
                "M. Hasegawa"
            ],
            "title": "Maximum likelihood inference of protein phylogeny and the origin of chloroplasts",
            "venue": "J Mol Evol. 31:151\u2013160.",
            "year": 1990
        },
        {
            "authors": [
                "H Koch",
                "M. DeGiorgio"
            ],
            "title": "Maximum likelihood estimation of species trees from gene trees in the presence of ancestral population structure",
            "venue": "Genome Biol Evol. 12:3977\u20133995.",
            "year": 2020
        },
        {
            "authors": [
                "LS Kubatko",
                "BC Carstens",
                "LL. Knowles"
            ],
            "title": "STEM: species tree estimation using maximum likelihood for gene trees under coalescence",
            "venue": "Bioinformatics 25:971\u2013973.",
            "year": 2009
        },
        {
            "authors": [
                "Kubatko LS",
                "Degnan JH."
            ],
            "title": "Inconsistency of phylogenetic estimates from concatenated data under coalescence",
            "venue": "Syst Biol. 56:17\u201324.",
            "year": 2007
        },
        {
            "authors": [
                "S Kumar",
                "AJ Filipski",
                "FU Battistuzzi",
                "SL Kosakovsky Pond",
                "K. Tamura"
            ],
            "title": "Statistics and truth in phylogenomics",
            "venue": "Mol Biol Evol. 29: 457\u2013472.",
            "year": 2012
        },
        {
            "authors": [
                "Lanier HC",
                "Knowles LL."
            ],
            "title": "Is recombination a problem for speciestree analyses? Syst Biol",
            "venue": "61:691\u2013701.",
            "year": 2012
        },
        {
            "authors": [
                "JY Lee",
                "L Joseph",
                "SV. Edwards"
            ],
            "title": "A species tree for the Australo-Papuan Fairy-wrens and allies (Aves: Maluridae)",
            "venue": "Syst Biol. 61:253\u2013271.",
            "year": 2012
        },
        {
            "authors": [
                "JW Leigh",
                "E Susko",
                "M Baumgartner",
                "AJ. Roger"
            ],
            "title": "Testing congruence in phylogenomic analysis",
            "venue": "Syst Biol. 57:104\u2013115.",
            "year": 2008
        },
        {
            "authors": [
                "PO Lewis",
                "MT Holder",
                "KE. Holsinger"
            ],
            "title": "Polytomies and Bayesian phylogenetic inference",
            "venue": "Syst Biol. 54:241\u2013253.",
            "year": 2005
        },
        {
            "authors": [
                "L. Liu"
            ],
            "title": "BEST: Bayesian estimation of species trees under the coalescent model",
            "venue": "Bioinformatics 24:2542\u20132543.",
            "year": 2008
        },
        {
            "authors": [
                "L Liu",
                "C Anderson",
                "D Pearl",
                "SV. Edwards"
            ],
            "title": "Modern phylogenomics: building phylogenetic trees using the multispecies coalescent model",
            "venue": "In: Anisimova M, editors. Evolutionary genomics: statistical and computational methods. New York: Springer. p. 211\u2013239.",
            "year": 2019
        },
        {
            "authors": [
                "Liu L",
                "Pearl DK."
            ],
            "title": "Species trees from gene trees: reconstructing Bayesian posterior distributions of a species phylogeny using estimated gene tree distributions",
            "venue": "Syst Biol. 56:504\u2013514.",
            "year": 2007
        },
        {
            "authors": [
                "L Liu",
                "Z Xi",
                "S Wu",
                "CC Davis",
                "SV. Edwards"
            ],
            "title": "Estimating phylogenetic trees from genome-scale data",
            "venue": "Ann N Y Acad Sci. 1360:36\u201353.",
            "year": 2015
        },
        {
            "authors": [
                "L Liu",
                "L Yu",
                "SV. Edwards"
            ],
            "title": "A maximum pseudo-likelihood approach for estimating species trees under the coalescent model",
            "venue": "BMC Evol Biol. 10:302.",
            "year": 2010
        },
        {
            "authors": [
                "Maddison WP."
            ],
            "title": "Gene trees in species trees",
            "venue": "Syst Biol. 46:523\u2013536.",
            "year": 1997
        },
        {
            "authors": [
                "DP Martin",
                "P Lemey",
                "D. Posada"
            ],
            "title": "Analysing recombination in nucleotide sequences",
            "venue": "Mol Ecol Res. 11:943\u2013955.",
            "year": 2011
        },
        {
            "authors": [
                "S Mirarab",
                "MS Bayzid",
                "B Boussau",
                "T. Warnow"
            ],
            "title": "Statistical binning enables an accurate coalescent-based estimation of the avian tree",
            "venue": "Science 346:1250463.",
            "year": 2014
        },
        {
            "authors": [
                "S Mirarab",
                "R Reaz",
                "MS Bayzid",
                "T Zimmermann",
                "MS Swenson",
                "T. Warnow"
            ],
            "title": "ASTRAL: genome-scale coalescent-based species tree estimation",
            "venue": "Bioinformatics 30:i541\u2013i548.",
            "year": 2014
        },
        {
            "authors": [
                "S Naser-Khdour",
                "BQ Minh",
                "W Zhang",
                "EA Stone",
                "R. Lanfear"
            ],
            "title": "The prevalence and impact of model violations in phylogenetic analysis",
            "venue": "Genome Biol Evol. 11:3341\u20133352.",
            "year": 2019
        },
        {
            "authors": [
                "LT Nguyen",
                "HA Schmidt",
                "A von Haeseler",
                "BQ. Minh"
            ],
            "title": "IQ-TREE: a fast and effective stochastic algorithm for estimating maximumlikelihood phylogenies",
            "year": 2015
        },
        {
            "authors": [
                "R. Nichols"
            ],
            "title": "Gene trees and species trees are not the same",
            "venue": "Trends Ecol Evol. 16:358\u2013364.",
            "year": 2001
        },
        {
            "authors": [
                "JR Oaks",
                "KA Cobb",
                "VN Minin",
                "AD. Leach\u00e9"
            ],
            "title": "Marginal likelihoods in phylogenetics: a review of methods and applications",
            "venue": "Syst Biol. 68:681\u2013697.",
            "year": 2019
        },
        {
            "authors": [
                "HA Ogilvie",
                "RR Bouckaert",
                "AJ. Drummond"
            ],
            "title": "StarBEAST2 brings faster species tree inference and accurate estimates of substitution rates",
            "venue": "Mol Biol Evol. 34:2101\u20132114.",
            "year": 2017
        },
        {
            "authors": [
                "E Paradis",
                "J Claude",
                "K. Strimmer"
            ],
            "title": "APE: analyses of phylogenetics and evolution in R language",
            "venue": "Bioinformatics 20:289\u2013290.",
            "year": 2004
        },
        {
            "authors": [
                "D Paraskevis",
                "K Deforche",
                "P Lemey",
                "G Magiorkinis",
                "A Hatzakis",
                "AM. Vandamme"
            ],
            "title": "Slidingbayes: exploring recombination using a sliding window approach based on Bayesian phylogenetic inference",
            "venue": "Bioinformatics 21:1274\u20131275.",
            "year": 2005
        },
        {
            "authors": [
                "K. Pearson"
            ],
            "title": "VII",
            "venue": "Mathematical contributions to the theory of evolution. III. Regression, heredity, and panmixia. Philos Trans R Soc Lond Ser A-Contain Pape Math Phys Character. 187:253\u2013318.",
            "year": 1896
        },
        {
            "authors": [
                "J Pei",
                "Y. Wu"
            ],
            "title": "STELLS2: fast and accurate coalescent-based maximum likelihood inference of species trees from gene tree topologies",
            "venue": "Bioinformatics 33:1789\u20131797.",
            "year": 2017
        },
        {
            "authors": [
                "Posada D",
                "Crandall KA."
            ],
            "title": "Selecting the best-fit model of nucleotide substitution",
            "venue": "Syst Biol. 50:580\u2013601.",
            "year": 2001
        },
        {
            "authors": [
                "Posada D",
                "Crandall KA."
            ],
            "title": "The effect of recombination on the accuracy of phylogeny estimation",
            "venue": "J Mol Evol. 54:396\u2013402.",
            "year": 2002
        },
        {
            "authors": [
                "B Rannala",
                "Z. Yang"
            ],
            "title": "Bayes Estimation of species divergence times and ancestral population sizes using DNA sequences from multiple loci",
            "venue": "Genetics 164:1645\u20131656.",
            "year": 2003
        },
        {
            "authors": [
                "B Rannala",
                "Z. Yang"
            ],
            "title": "Efficient Bayesian species tree inference under the multispecies coalescent",
            "venue": "Syst Biol. 66:823\u2013842.",
            "year": 2017
        },
        {
            "authors": [
                "J Ripplinger",
                "J. Sullivan"
            ],
            "title": "Assessment of substitution model adequacy using frequentist and Bayesian methods",
            "venue": "Mol Biol Evol. 27:2790\u20132803.",
            "year": 2010
        },
        {
            "authors": [
                "S Roch",
                "M. Steel"
            ],
            "title": "Likelihood-based tree reconstruction on a concatenation of aligned sequence data sets can be statistically inconsistent",
            "venue": "Theor Popul Biol. 100:56\u201362.",
            "year": 2015
        },
        {
            "authors": [
                "L Salichos",
                "A. Rokas"
            ],
            "title": "Inferring ancient divergences requires genes with strong phylogenetic signals",
            "venue": "Nature 497:327\u2013331.",
            "year": 2013
        },
        {
            "authors": [
                "E Sayyari",
                "S. Mirarab"
            ],
            "title": "Testing for polytomies in phylogenetic species trees using quartet frequencies",
            "venue": "Genes (Basel). 9:132.",
            "year": 2018
        },
        {
            "authors": [
                "M Schierup",
                "J. Hein"
            ],
            "title": "Consequences of recombination on traditional phylogenetic analysis",
            "venue": "Genetics 156:879\u2013891.",
            "year": 2000
        },
        {
            "authors": [
                "T. Seo"
            ],
            "title": "Calculating bootstrap probabilities of phylogeny using multilocus sequence data",
            "venue": "Mol Biol Evol. 25:960\u2013971.",
            "year": 2008
        },
        {
            "authors": [
                "X-X Shen",
                "CT Hittinger",
                "A. Rokas"
            ],
            "title": "Contentious relationships in phylogenomic studies can be driven by a handful of genes",
            "venue": "Nat. Ecol Evol. 1:1\u201310.",
            "year": 2017
        },
        {
            "authors": [
                "X Shi",
                "H Gu",
                "E Susko",
                "C. Field"
            ],
            "title": "The comparison of the confidence regions in phylogeny",
            "venue": "Mol Biol Evol. 22:2285\u20132296.",
            "year": 2005
        },
        {
            "authors": [
                "H Shimodaira",
                "M. Hasegawa"
            ],
            "title": "Multiple comparisons of log-likelihoods with applications to phylogenetic inference",
            "venue": "Mol Biol Evol. 16:1114\u20131116.",
            "year": 1999
        },
        {
            "authors": [
                "S Song",
                "L Liu",
                "SV Edwards",
                "S. Wu"
            ],
            "title": "A phylogeny of birds based on over 1,500 loci collected by target enrichment and highthroughput sequencing",
            "venue": "PLoS One. 8:e54858.",
            "year": 2012
        },
        {
            "authors": [
                "A. Stamatakis"
            ],
            "title": "RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies",
            "venue": "Bioinformatics 30: 1312\u20131313.",
            "year": 2014
        },
        {
            "authors": [
                "K Strimmer",
                "A. Rambaut"
            ],
            "title": "Inferring confidence sets of possibly misspecified gene trees",
            "venue": "Proc Biol Sci. 269:137\u2013142.",
            "year": 2002
        },
        {
            "authors": [
                "J Sullivan",
                "P. Joyce"
            ],
            "title": "Model selection in phylogenetics",
            "venue": "Annu Rev Ecol Evol Syst. 36:445\u2013466.",
            "year": 2005
        },
        {
            "authors": [
                "DL Swofford",
                "GJ Olsen",
                "PJ. Waddell"
            ],
            "title": "Phylogenetic inference",
            "venue": "In: Hillis DM, Moritz C, Mable BK, editors. Molecular systematics. Sunderland (MA): Sinauer. p. 407\u2013514.",
            "year": 1996
        },
        {
            "authors": [
                "C Than",
                "D Ruths",
                "L. Nakhleh"
            ],
            "title": "Phylonet: a software package for analyzing and reconstructing reticulate evolutionary relationships",
            "venue": "BMC Bioinformatics 9:322.",
            "year": 2008
        },
        {
            "authors": [
                "Wang Z",
                "Liu KJ."
            ],
            "title": "A performance study of the impact of recombination on species tree analysis",
            "venue": "BMC Genomics 17:165\u2013174.",
            "year": 2016
        },
        {
            "authors": [
                "D Wen",
                "Y Yu",
                "J Zhu",
                "L. Nakhleh"
            ],
            "title": "Inferring phylogenetic networks using PhyloNet",
            "venue": "Syst Biol. 67:735\u2013740.",
            "year": 2018
        },
        {
            "authors": [
                "P Westfall",
                "S Young",
                "S. Wright"
            ],
            "title": "On adjusting P-values for multiplicity",
            "venue": "Biometrics 49:941\u2013945.",
            "year": 1993
        },
        {
            "authors": [
                "Y. Wu"
            ],
            "title": "Coalescent-based species tree inference from gene tree topologies under incomplete lineage sorting by maximum likelihood",
            "venue": "Evol Int J Org Evol. 66:763\u2013775.",
            "year": 2012
        },
        {
            "authors": [
                "Z Xi",
                "L Liu",
                "C. Davis"
            ],
            "title": "Genes with minimal phylogenetic information are problematic for coalescent analyses when gene tree estimation is biased",
            "venue": "Mol Phylogenet Evol. 92:63\u201371.",
            "year": 2015
        },
        {
            "authors": [
                "W Xie",
                "PO Lewis",
                "Y Fan",
                "L Kuo",
                "MH. Chen"
            ],
            "title": "Improving marginal likelihood estimation for Bayesian phylogenetic model selection",
            "venue": "Syst Biol. 60:150\u2013160.",
            "year": 2011
        },
        {
            "authors": [
                "B Xu",
                "Z. Yang"
            ],
            "title": "Challenges in species tree estimation under the multispecies coalescent model",
            "venue": "Genetics 204:1353\u20131368.",
            "year": 2016
        },
        {
            "authors": [
                "Z. Yang"
            ],
            "title": "Likelihood and Bayes estimation of ancestral population sizes in hominoids using data from multiple loci",
            "venue": "Genetics 162:1811\u20131823.",
            "year": 2002
        },
        {
            "authors": [
                "Y Yu",
                "J Dong",
                "K Liu",
                "L. Nakhleh"
            ],
            "title": "Maximum likelihood inference of reticulate evolutionary histories",
            "venue": "Proc Natl Acad Sci U S A. 111: 16448\u201316453.",
            "year": 2014
        },
        {
            "authors": [
                "Y Yu",
                "N Ristic",
                "L. Nakhleh"
            ],
            "title": "Fast algorithms and heuristics for phylogenomics under hybridization and incomplete lineage sorting",
            "venue": "BMC Bioinformatics 14 Suppl 15(Suppl 15):S6.",
            "year": 2013
        },
        {
            "authors": [
                "S Zhu",
                "JH Degnan",
                "SJ Goldstien",
                "B. Eldon"
            ],
            "title": "Hybrid-Lambda: simulation of multiple merger and Kingman gene genealogies in species networks and species trees",
            "venue": "BMC Bioinformatics 16: 292.",
            "year": 2015
        }
    ],
    "sections": [
        {
            "text": "Key words: maximum likelihood, phylogenomics, bootstrap, phylogenetic networks, multispecies coalescent.\n\u00a9 The Author(s) 2023. Published by Oxford University Press on behalf of Society for Molecular Biology and Evolution. This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (https:// creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com Open Access\nA rticle"
        },
        {
            "heading": "Introduction",
            "text": "Hypothesis testing is a fundamental concept of statistical inference that has been a cornerstone of contemporary systematics and evolutionary research in general for much of the past century (Pearson 1896; Felsenstein 1985; Brandon 1994; Ayala 2009; Kumar et al. 2012). Phylogenetic trees represent explicit hypotheses concerning the degree of evolutionary relatedness among organisms, and decades of research have produced many hypothesis-testing frameworks for evaluating features of phylogenies. Examples of these phylogenetic characteristics include topology (Goldman et al. 2000), specific branches (e.g., Lewis et al. 2005; Anisimova and Gascuel 2006), species delimitations (e.g., Carstens and Dewey 2010; Fujita et al. 2012), and phylogenetic congruency (e.g., Huelsenbeck and Bull 1996; Leigh et al. 2008). Testing phylogenetic hypotheses is therefore an essential component of evolutionary analysis that can be useful for many applications, such as assessing statistical confidence (e.g., Efron et al. 1996; Holmes 2005; Shi et al. 2005), performing model selection (e.g., Huelsenbeck and Crandall 1997; Posada and Crandall 2001; Sullivan and Joyce 2005), understanding model fit and adequacy (e.g., Goldman 1993; Ripplinger and Sullivan 2010), and illuminating model misspecification and tree reconstruction bias (e.g., Buckley 2002; Naser-Khdour et al. 2019; Jiang et al. 2020). Given such widespread adoption of phylogenetic hypothesis-testing frameworks, it is somewhat surprising that they have been comparatively underdeveloped and underutilized for species tree inference (Liu et al. 2019). In practice, it is quite common for studies to simply measure node support (e.g., bootstrap or posterior probabilities) without any formal statistical evaluation of hypotheses in a more rigorous testing framework. Bayesian methods provide a natural assessment of statistical support by obtaining posterior probabilities of tree topologies, as well as Bayes factor support for hypotheses (e.g., *BEAST, *BEAST2, SNAPP, BPP, and BEST; Rannala and Yang 2003; Liu 2008; Heled and Drummond 2009; Bryant et al. 2012; Ogilvie et al. 2017). However, many Bayesian approaches tend to scale poorly with the size of modern phylogenomic data sets (Rannala and Yang 2003; but see recent improvements in Rannala and Yang 2017), such that genome-scale inference is typically conducted using more computationally efficient heuristic methods (e.g., STEM, MP-EST, STELLS, and ASTRAL; Kubatko et al. 2009; Liu et al. 2010; Wu 2012; Mirarab, Bayzid, et al. 2014; Mirarab, Reaz,\nMol. Biol. Evol. 40(7):msad159 https://doi.org/10.1093/molbev/msad159 Advance Access publication July 13, 2023 1\nnloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\net al. 2014). Importantly, many likelihood-based tests of phylogenetic hypotheses (i.e., Goldman et al. 2000) evaluate the fit of gene trees at individual loci and thus may best represent tests of genealogical relationships among alleles, rather than population or species relationships. Reconstructing evolutionary relationships among organisms is typically the primary objective of phylogenetic studies, and yet, the past few decades of research have amassed widespread evidence that gene trees and species trees are not necessarily the same (Nichols 2001; Degnan and Rosenberg 2009; Edwards et al. 2016). Incomplete lineage sorting (ILS) is a particularly notorious and pervasive source of conflict that can mislead even genome-scale analyses (Maddison 1997; Kubatko and Degnan 2007; Edwards 2009; Liu et al. 2015), which led to the development of coalescent-based species tree methods for modeling gene tree evolution as a function of species trees (e.g., Rannala and Yang 2003; Liu and Pearl 2007; Kubatko et al. 2009; Wu 2012; Edwards et al. 2016). The distinction between gene tree and species tree inference is critical because many classical phylogenetic methods explicitly assume gene tree homogeneity (i.e., all loci share a single tree; Felsenstein 1981) and may exhibit statistical biases in the presence of such conflict (Roch and Steel 2015). Long-established phylogenetic hypothesis-testing frameworks that apply these same principles (i.e., Goldman et al. 2000) may also be sensitive to gene tree heterogeneity.\nRecently, Liu et al. (2019) highlighted the paucity of likelihood techniques for assessing and comparing support for species topologies under the multispecies coalescent (MSC) model and emphasized a need for research into approaches for testing species tree hypotheses. The authors also demonstrated one such version of a likelihood ratio test that uses gene tree estimates and a two-step species tree algorithm (MP-EST; Liu et al. 2010) that was applied to a data set of fairy wrens (Lee et al. 2012) to evaluate three alternative phylogenetic hypotheses (i.e., figure 5 in Liu et al. 2019); a similar test was used for assessing topological support of the mammalian tree of life (Du et al. 2019). Carstens and Knowles (2007) provided one of the first of only a few examples of formal testing of species topology hypotheses using a coalescent-based approach to species tree inference. They applied an efficient approximation to a likelihood ratio test (Anisimova and Gascuel 2006) to assess whether the maximum likelihood (ML) species topology given input gene trees was significantly better than all possible alternatives. Follow-up studies applied similar principles for testing species topologies given a set of gene trees (e.g., Hung et al. 2012), and some heuristics have been developed that use other statistics and characteristics of phylogenomic data in lieu of the likelihood ratio, such as quartet frequencies of input gene trees (e.g., Gaither and Kubatko 2016; Sayyari and Mirarab 2018) and splits based on nucleotide site pattern frequencies (e.g., Gaither and Kubatko 2016). A more common practice is to simply compare bootstrap support without conducting any formal hypothesis test. In addition to these approaches, a number of Bayesian methods have been\nimplemented for testing phylogenetic hypotheses using Bayes factors (i.e., Xie et al. 2011; Oaks et al. 2019; Fourment et al. 2020), though these are less commonly applied to large-scale genomic data. Given these findings, a natural question is whether we can reformulate classical likelihood tests of phylogenies for the purpose of testing species tree hypotheses. That is, can we synergize MSC-based tree models with the hypothesis-testing frameworks that have been extensively applied for comparing support of gene topologies?\nHere, we propose several likelihood-based tests of species topologies that use a set of gene tree topologies as input by reformulating a number of classical phylogenetic hypothesis tests in light of the MSC. Specifically, we extend the Kishino\u2013 Hasegawa (KH; Hasegawa and Kishino 1989; Kishino and Hasegawa 1989), Shimodaira\u2013Hasegawa (SH; Shimodaira and Hasegawa 1999), and Swofford\u2013Olsen\u2013Waddell\u2013Hillis (SOWH; Hillis et al. 1996; Swofford et al. 1996) tests to evaluate bifurcating and reticulate species hypotheses. In addition, we introduce these species topology tests within the opensource R package SpeciesTopoTestR (Species Topology Tests in R)."
        },
        {
            "heading": "New Approaches",
            "text": "Background: Heuristic Species Tree Inference Gene trees may disagree with the overall species tree relationships among a set of organisms for many reasons (Maddison 1997; Kubatko and Degnan 2007; Edwards 2009; Liu et al. 2015), and recent years have witnessed a wealth of new approaches for using multilocus data to infer species trees despite such conflict, including both Bayesian frameworks (e.g., *BEAST, *BEAST2, SNAPP, BPP, and BEST; Rannala and Yang 2003; Liu 2008; Heled and Drummond 2009; Bryant et al. 2012; Ogilvie et al. 2017) and heuristic methods (e.g., STEM, MP-EST, STELLS, and ASTRAL; Kubatko et al. 2009; Liu et al. 2010; Wu 2012; Mirarab, Bayzid, et al. 2014; Mirarab, Reaz, et al. 2014). Bayesian methods typically integrate over gene tree branch lengths, topologies, and other parameters when computing a posterior probability distribution over species trees using gene sequence data as input. This task typically requires substantial computational time and resources to integrate over the large parameter space that includes both gene (e.g., substitution models and gene tree topologies) and species tree (e.g., divergence times and species tree topologies) parameters conditional on input multilocus alignments.\nTo decrease computational burden and increase scalability, heuristic methods have been designed for larger-scale phylogenomic analyses by using estimated gene trees as input for reconstructing species trees under the MSC without computing posterior probabilities. Most likelihood-based heuristic methods use gene tree topologies as input for computing the likelihood of a species tree given a set of gene trees (e.g., MP-EST and STELLS). Similarly, some heuristic methods compute explicit MSC likelihoods (e.g., STELLS) or pseudo-likelihoods (MP-EST), while others use nonlikelihood criteria (e.g., ASTRAL).\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nBayesian methods provide a number of benefits (e.g., accounting for uncertainty in both gene and species tree inference), yet the need to integrate over many parameters reduces their efficiency, leading to a dominance of heuristic approaches for more computationally efficient analyses of genome-scale data.\nTo ensure that our species tree hypothesis tests scale with the size of multilocus data sets, we focus on the application of heuristic algorithms in this study. Debates over both the power and pitfalls of heuristic methods have persisted for decades now, and we do not attempt to solve these debates here; instead, we seek to understand whether these popular methods\u2014though imperfect\u2014can be leveraged for testing species topology hypotheses in a more computationally efficient manner, and we also evaluate their performances using estimated gene trees taken from gene sequence data. In particular, we apply the coalescent-based ML strategy implemented in STELLS2 (Pei and Wu 2017), which uses input gene tree topologies to optimize the species tree topology and coalescent branch lengths under the MSC model. For STELLS2, the likelihood of a species tree given a set of input gene tree topologies is computed under the MSC model, rather than directly from the sequence data. Additionally, we include the option to use the coalescent-based likelihood function provided in PhyloNet (Yu et al. 2013, 2014), which can also be used for evaluating bifurcating or network species topologies under the MSC model. Though we focus on these implementations, we note that other approaches may be implemented in a similar manner (and we discuss future implementations in the Discussion section).\nLike similar heuristic strategies (e.g., ASTRAL and MP-EST), a key assumption of our new approaches is that input gene tree topologies are known with certainty. Of course, in practice, input gene tree topologies are typically estimated from sequence data using standard phylogenetic procedures, such as RAxML (Stamatakis 2014) or IQ-TREE (Nguyen et al. 2015), which adds a source of error that can influence downstream inference. Because poorly estimated gene trees can reduce species tree accuracy (Yang 2002; Burgess and Yang 2008; Xi et al. 2015; Xu and Yang 2016), we consider the performance of these tests using both the set of true (simulated) gene trees and the associated set of estimated gene trees inferred from molecular sequence data. As we will show, gene tree estimation error may reduce statistical power of our species tree hypothesis tests, but with only minimal impact on false positive rates. In the next subsection, we discuss the formulation of our species tree hypothesis tests in light of classical phylogenetic testing frameworks that have been historically used for single-gene tree inference.\nLikelihood-Based Tests of Tree Topology Given Input Gene Tree Topologies Phylogenetic trees present a number of unique challenges to statistical inference, and nearly three decades of systematic research have focused on the development of\nlikelihood-based frameworks to account for these inherent peculiarities when conducting hypothesis tests (Huelsenbeck and Crandall 1997; Irisarri and Zardoya 2013). Goldman et al. (2000) provided an overview of popular likelihood-based tests of tree topology that were \u2014and still are\u2014widely used and relevant for comparing the fits of competing phylogenetic hypotheses. For continuity, we follow the terminology of Goldman et al. (2000) while introducing natural extensions of these principles for comparing species topologies. Importantly, Goldman et al. (2000) discussed several implementations and limitations of the popular KH (Hasegawa and Kishino 1989; Kishino and Hasegawa 1989) and SH (Shimodaira and Hasegawa 1999) tests and also described a third test (SOWH) that applies parametric bootstrapping. Given a sequence alignment, these tests perform an array of statistical procedures to generate null distributions that are used to evaluate differences in likelihoods measured between gene trees (fig. 1a). Our focus is to adapt these phylogenetic hypothesis-testing frameworks to the problem of species tree inference from input gene tree topologies (fig. 1b).\nDeveloping Analogous Tests of Species Topologies Given Input Gene Tree Topologies To derive analogous tests of species topologies, we apply the MSC to compute species tree likelihoods given a set of input gene tree topologies (Rannala and Yang 2003). We therefore adopt the principles of two-step species tree methods (e.g., MP-EST, ASTRAL, and STELLS; Liu et al. 2010; Mirarab, Bayzid, et al. 2014; Mirarab, Reaz, et al. 2014; Pei and Wu 2017) commonly employed for phylogenomic inference to derive MSC-based topology tests that mirror the original tests (KH, SH, and SOWH) based on individual gene tree inference. Specifically, we test whether the MSC-based likelihoods of two or more species topologies differ significantly. As an analogy to Goldman et al. (2000) and the methods discussed within, we are primarily interested in testing the topologies of species trees, and we use ML to optimize the MSC parameters of topology hypotheses (e.g., using STELLS to optimize branch lengths conditional on a species topology) given input gene tree topologies, rather than Bayesian inference given multilocus sequence alignments (e.g., Rannala and Yang 2003; Liu 2008; Heled and Drummond 2009; Bryant et al. 2012; Ogilvie et al. 2017). That is, we test hypotheses about the overall species topology (similar to the original tests in Goldman et al. 2000), with branch lengths that are optimized to compare topologies at their peak MSC likelihoods.\nConsider a set G = {g1, g2, . . . , gl} of independent gene tree topologies computed on a phylogenomic data set, where g1 is the gene tree topology estimated for the first locus, and so on, up to the lth locus for gl. Each gene tree in G can be estimated using likelihood methods such as RAxML (Stamatakis 2014), IQ-TREE (Nguyen et al. 2015), or similar approaches. We wish to test\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nhypotheses concerning the relationship among species that gave rise to G (fig. 1b). Borrowing from two-step species tree algorithms, we treat G as input data for estimating and testing species topologies (e.g., testing if the MSC likelihoods of two distinct topologies are statistically different given G). We can test such hypotheses using the log-likelihood ratio\n\u03b4 = ln L(S1) \u2212 ln L(S2),\nwhere ln L(S1) and ln L(S2) indicate the respective logtransformed and maximized MSC-based likelihoods of species topologies S1 and S2 (fig. 1b), respectively. Maximizing the likelihoods of S1 and S2 can be accomplished by optimizing their coalescent branch lengths with an appropriate ML algorithm (e.g., STELLS or PhyloNet). Thus, we seek to test species tree hypotheses related to \u03b4, rather than individual gene tree hypotheses (i.e., fig. 1a and b), and can derive analogs to the KH, SH, and SOWH tests by replacing computations of classical phylogenetic likelihoods (i.e., sequence models) with the those of coalescent likelihoods relevant to \u03b4 (figs. 2\u20134).\nAs with two-step species tree algorithms (e.g., MP-EST, STELLS, and ASTRAL), these tests assume that input gene trees are known without error, which we expand upon in the Discussion section. For comparisons that include at least one network topology (e.g., one or both of S1 and S2 include at least one reticulating branch), we also include the option to use the coalescent-based likelihood function\nof PhyloNet (Yu et al. 2013, 2014). Importantly, though we focus on the STELLS or PhyloNet frameworks for computing species tree likelihoods, we note that other heuristic, likelihood-based functions could be applied in a similar manner. We refer to our new species tree hypothesis tests as the KH*, SH*, and SOWH* tests, which are each described in the three immediately following subsections.\nThe KH* Test The KH test has been widely adopted for conducting likelihood tests of topology hypotheses for single genes by assessing fit of molecular sequence data to two distinct gene topologies at their branch length-optimized likelihood values (Goldman et al. 2000). Subsequent studies expanded this test, highlighting several of its properties and limitations (e.g., Kishino et al. 1990), such as requiring that gene tree hypotheses be defined beforehand (Swofford et al. 1996; Shimodaira and Hasegawa 1999), and its diminished performance under evolutionary model misspecification (i.e., Buckley 2002; Strimmer and Rambaut 2002); features that are also likely to be relevant to species tree implementations that are based on similar principles.\nWe refer to our KH test extension for conducting tests of species topologies under the MSC as KH*. The KH* test compares the likelihoods of two species topologies S1 and S2, while using variations of nonparametric bootstrapping to assess significance. Details of specific KH* algorithms are described in figure 2a, and a schematic of the general KH*\ng1 g2 S1 S2\n\u03b4=ln L(g1) \u2013 ln L(g2)\nA A G T C C G ... A G G T C T G ... A G G T C T G ... A A C A C C G ...\ng1, g2, g3, ...,gl )\n=( )\n\u03b4=ln L(S1) \u2013 ln L(S2)\ngene tree topologies species topologies\nhy po\nth es\nes to\nte st\nte st\ns ta\ntis tic\nm od el pa ra m\net er s in pu t\nG =(\nlik el\nih oo d fu nc tio n\n...\n(a) (b)\nsequence alignments estimated gene trees\nbranch lengths, substitution rates, etc.\ndivergence times, effective population sizes, etc.\nphylogenetic likelihood: gene tree given alignment multispecies coalescent likelihood: species tree given gene trees\nFIG. 1. Comparing the components of classical likelihood-based tests of gene tree topologies (a) with the analogous tests of species topologies derived in this study (b). While topology is the primary focus of both tests (top row), a species tree hypothesis-testing framework (b) is concerned with the fit of species topologies (examples depicted by S1 and S2) to gene tree distributions (G shown in lower right) under the MSC model, rather than the fit of specific gene tree topologies (i.e., g1 and g2) to molecular sequence data (example alignment in lower left). The test statistics are computed by optimizing relevant model parameters according to either the standard phylogenetic likelihood function (a) or the MSC likelihood (b), respectively. Note that the example species topology S2 represents a hybridization network.\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nprocedure is depicted in figure 2b. Suppose we wish to test whether topologies S1 and S2 are equally supported by a given input set of gene trees G. For the KH* test, the null (H0) and alternative (HA) hypotheses can be defined as\nH0:E[\u03b4] = 0 HA:E[\u03b4] \u2260 0,\nwhere \u03b4 = ln L(S1) \u2212 ln L(S2) and the expectations E[\u00b7] are functions of the model parameters and taken over data samples. Note that this is the identical terminology for both the null and alternative hypothesis as stated in Goldman et al. (2000) based on the original KH test. Using our input gene tree sets, we seek to test whether the difference in MSC log-likelihoods \u03b4 diverges significantly from this expectation under H0. During the testing procedure, the model parameters are optimized using ML under the MSC. The KH* test thus evaluates whether two topologies S1 and S2 are equally likely to have generated gene tree topologies in G. The general protocol of the KH* test is defined in the following steps (fig. 2):\n1) Two topologies S1 and S2 are defined a priori. 2) Coalescent branch lengths of both S1 and S2 are op-\ntimized independently using ML.\n3) The observed statistic \u03b4 is computed using the two branch length optimized trees from Step (2). 4) A total of b nonparametric bootstrap samples are obtained by resampling (with replacement) from the original gene tree set G. 5) For each bootstrap replicate gene tree set, the branch lengths of topologies S1 and S2 are optimized again using ML to obtain a null distribution for \u03b4. 6) The bootstrap distribution is used to evaluate whether the observed test statistic \u03b4 is a plausible sample under the null hypothesis.\nMirroring their gene tree counterparts (Goldman et al. 2000), we implemented three versions of KH* (KH\u22171 , KH \u2217 2 , and KH\u22173 ; fig. 2a) by replacing computations of gene-tree likelihoods (Felsenstein 1981) with MSC-based likelihoods (Yang 2002; Rannala and Yang 2003). As with the KH tests, all three versions of KH* apply nonparametric bootstrapping of the set G to obtain a null distribution of \u03b4 for computing two-sided P values (fig. 2). The KH\u22171 test shares many properties with the species topology tests implemented in Liu et al. (2019) and Du et al. (2019) that compare the pseudolikelihood of two different topologies using the framework of MP-EST. The KH\u22172 and KH \u2217 3 algorithms differ from KH\u22171 in Step (5) by applying the\n(a)\n( )G =\nG(1)= ( ) G(2)= ( )...\nG(b)= ( )...\n...\n...\n...\nS1 S2\nco mp\nute\ntes t s\ntat ist\nic\nno n-\npa ra\nm et ric bo ot str ap s\n.. .\n...\ncompute bootstrap statistics\n\u03b4(1) = ln L(S1|G (1)) \u2013 ln L(S2|G (1)) \u03b4(2) = ln L(S1|G (2)) \u2013 ln L(S2|G (2))\n\u03b4(b) = ln L(S1|G (b)) \u2013 ln L(S2|G (b))\nnull distribution\ningis fi\nsl evel ecnac\n\u03b4 = ln L(S1|G) \u2013 ln L(S2|G)\n(b)\ncompare with null distribution\nge ne\nrat e\nnu ll d\nist rib\nuti on\nFIG. 2. The KH* test for species tree hypotheses. Details for the three KH* algorithms (KH\u22171 , KH \u2217 2 , and KH \u2217 3 ) are provided in (a), and a general schematic overview of the KH* test is shown in (b). Briefly, the KH* test evaluates whether the difference in MSC likelihoods \u03b4 computed between two species topologies S1 and S2 (b, top) is a plausible draw from a null distribution obtained using nonparametric bootstrapping (b, right). Two example topologies are shown in (b): a classical bifurcating topology on the left (S1) and a species network on the right (S2). Nonparametric bootstrapping of the input gene tree set G is conducted to obtain b total replicate sets G(1), G(2), \u2026, G(b) (b, left), which, in turn, yields a distribution of \u03b4(1), \u03b4(2), \u2026, \u03b4(b) (b, bottom) under the null hypothesis. The primary difference between the three KH* algorithms is whether RELL bootstrapping is used (KH\u22172 and KH \u2217 3 ) or not (KH \u2217 1 ), while KH \u2217 3 also uses normal approximation to evaluate significance. See table 1 for a description of gene tree analog acronyms priNPfcd, priNPncd, and priNPncn.\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nresampling estimated log-likelihood (RELL; Kishino et al. 1990; Hasegawa and Kishino 1994) approach to speed up computation by avoiding branch length optimization for each bootstrap replicate. KH\u22173 tests whether the observed \u03b4 statistic is a plausible sample from a normal distribution with mean 0 and variance computed across bootstrap replicates.\nThe SH* Test The SH test was designed to improve upon KH by relaxing the requirement that two trees be selected in advance (Shimodaira and Hasegawa 1999; Goldman et al. 2000). While KH* is only valid when comparing two topologies selected before comparing their likelihoods, the SH* test is applied to all topologies included within a set M = {S1, S2, . . . , St} containing t different species topologies, correcting for multiple comparisons in the process. This set ideally encompasses all plausible topologies, including the ML estimate (Goldman et al. 2000). We can therefore formulate the SH* test for evaluating multiple species topologies by examining the null and alternative hypotheses, which we describe below. Details of specific SH* algorithms are described in figure 3a, and a schematic of the general SH* procedure is depicted in figure 3b. For topology Sx in M, let ln L(Sx) represent the log-likelihood value of topology Sx at maximized coalescent branch lengths given\ninput gene tree set G. We can define the null and alternative hypotheses as\nH0:E[\u03b4x] = 0 HA:E[\u03b4x] > 0,\nwhere \u03b4x = ln L(SML) \u2212 ln L(Sx) and SML is the ML topology given the set of input gene trees G. Our terminology for the null and alternative hypotheses is identical to those stated in Goldman et al. (2000) and Shimodaira and Hasegawa (1999) based on the original SH test.\nThe SH* test is conceptually similar to KH* with the important distinction of correcting for the ML topology. Steps of the SH* test include the following (fig. 3):\n1) A set M = {S1, S2, . . . , St} of t species topologies is defined to include all reasonable topologies, as well as the ML topology SML. 2) For each topology Sx in M, optimize the coalescent parameters and compute the observed test statistic \u03b4x = ln L(SML) \u2212 ln L(Sx) using the ML topology SML. 3) Conduct nonparametric bootstrap resampling to obtain a set of b samples of the original gene tree set G. 4) For each bootstrap replicate i, find S(i)ML (i.e., ML topology specific to replicate i), and for each topology Sx in M,\n(a) (b)\n>\nFIG. 3. The SH* test for species tree hypotheses. Details for the two algorithms (SH\u22171 and SH \u2217 2 ) are provided in (a), and a general schematic overview of the SH* test is shown in (b). Briefly, the SH* test evaluates whether the difference in MSC likelihoods \u03b4 computed between two or more species topologies S1, S2, . . . , St (b, top) included in a set of t topologies is a plausible draw from a null distribution obtained using nonparametric bootstrapping. Specifically, the difference in MSC likelihood is computed between the species topology in the set with ML (SML) and each of the other t \u2212 1 topologies. Several example topologies include two classical bifurcating trees on the left (S1 and S2) and a species network on the right (St). In this schematic, the first topology S1 also happens to be SML. Nonparametric bootstrapping of the input gene tree set G is conducted to obtain b total replicates G(1), G(2), \u2026, G(b) (b, left), yielding a distribution of \u03b4(1), \u03b4(2), \u2026, \u03b4(b) (b, bottom) under the null hypothesis. As with KH*, the two SH* algorithms differ on whether RELL bootstrapping is used (SH\u22172 ) or not (SH \u2217 1 ). See table 1 for a description of gene tree analog acronyms posNPfcd and posNPncd.\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\ncompute the statistic \u03b4(i)x to obtain a null distribution of \u03b4x. 5) Test whether the null distribution of \u03b4x is a plausible outcome under the null hypothesis for each species topology Sx in M. 6) If the observed statistic \u03b4x of any tree is outside the significance cutoff, then reject the null hypothesis, otherwise fail to reject.\nWe implemented two versions of SH* (SH\u22171 and SH \u2217 2 ; figure 3a) in SpeciesTopoTestR that are analogs to the original algorithms (Goldman et al. 2000). As with the KH* test, SH* also uses nonparametric bootstrapping either with (SH\u22172) or without (SH\u22171) RELL to generate a null distribution for computing P values (fig. 3). During bootstrap resampling, the ML topology S(i)ML computed for bootstrap gene tree set G (i) must\nbe considered in the set M of plausible species tree candidates for significance levels to be appropriate (Westfall et al. 1993; Goldman et al. 2000). An exhaustive consideration of all possible topologies may be infeasible for large trees with many species, but a potential solution could be to first generate bootstrap gene tree sets, compute the S(i)ML for each set, and include all distinct ML bootstrap tree topologies in the set of plausible topologies M.\nThe SOWH* Test We expanded the SOWH test (Hillis et al. 1996; Swofford et al. 1996) to develop the SOWH* test defined by the null and alternative hypotheses\nH0:E[\u03b4] = 0\n(a) (b)\n>\nFIG. 4. The SOWH* test for species tree hypotheses. Details for the two SOWH* algorithms (SOWH\u22171 and SOWH \u2217 2 ) are provided in (a), and a general schematic overview of the SOWH* test is shown in panel (b). Briefly, the SOWH* test evaluates whether the difference in MSC likelihoods \u03b4 computed between a hypothesized target species topology (S1; b, top) and the ML estimate (SML; b, top) is a plausible draw from a null distribution obtained using parametric bootstrapping (b, right). Parametric bootstrapping is conducted using the optimized branch lengths of S1 (b, left) to obtain b total replicates G(1), G(2), \u2026, G(b) (b, bottom left) that are used to find a ML topology for each replicate which, in turn, yields a distribution of \u03b4(1), \u03b4(2), \u2026, \u03b4(b) (b, bottom right) under the null hypothesis. Each round of parametric bootstrapping is followed by a search for a ML topology that is used to compare with the target topology S1 at their optimized parameter values (branch lengths) to compute the values of \u03b4(i). As with KH* and SH*, the two SOWH* algorithms differ on whether RELL bootstrapping is used (SOWH\u22172 ) or not (SOWH\u22171 ) in the processes of generating the null distribution of \u03b4S . See table 1 for a description of gene tree analog acronyms posPfud and posPpud."
        },
        {
            "heading": "Tree Choice Statistical Procedure Optimization Algorithm Test Statistic and",
            "text": "pri: topologies selected a priori NP: nonparametric bootstrap\nf : all parameters are estimated (full)\nc: centered distribution\nd: test statistic is compared directly with its distribution\npos: topologies chosen from analysis of data (posteriori)\nP: parametric p: some parameters are fixed (partial) n: no optimization of any parameters u: uncentered distribution\nn: normal distribution assumed for statistic\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nHA:E[\u03b4] > 0,\nwhere \u03b4 = ln L(SML) \u2212 ln L(S1), SML is the ML topology given the set of input gene trees G, and S1 is a target topology of interest. Details of specific SOWH* algorithms are described in figure 4a, and a schematic of the general SOWH* procedure is depicted in figure 4b. As with the original SOWH, parametric bootstrapping (Goldman et al. 2000) is used to simulate replicate gene tree sets under the MSC according to optimized branch lengths of S1, which provide a null distribution for assessing significance. This application of parametric bootstrapping (i.e., simulating data under a parametric model) rather than nonparametric bootstrapping is a key distinction between SOWH* and both KH* and SH*. Here, the difference in MSC likelihoods \u03b4 between a target topology S1 and the ML topology SML is used to test the null, and each round of parametric bootstrapping is followed by a search for the ML topology to compute null test statistics.\nThe general steps of the SOWH* test include (fig. 4):\n1) The target species topology S1 is specified and its coalescent branch lengths are optimized using ML. 2) The ML topology SML is found using the entire original gene tree set G. 3) The observed test statistic \u03b4 = ln L(SML) \u2212 ln L(S1) is computed using the optimized topology S1 and the ML topology SML. 4) A total of b parametric bootstrap replicates are obtained by simulating gene trees with the MSC under the optimized species topology S1. 5) A new ML topology S(i)ML is estimated independently for each bootstrap replicate i, and the branch lengths of S1 are optimized to compute the null distribution of \u03b4. 6) The observed statistic \u03b4 is tested whether it represents a plausible sample under the null hypothesis.\nWe implemented two versions of SOWH* (fig. 4a) that differ in whether RELL approximation is applied (SOWH\u22172) or not (SOWH\u22171)."
        },
        {
            "heading": "Results",
            "text": "We explored the statistical properties of the KH*, SH*, and SOWH* tests across an array of simulation conditions that included both the true, known (simulated) gene trees as well as estimated gene trees. Specifically, we investigated the statistical power for rejecting the null hypotheses when a specific tree is used to generate the data, as well as the false positive rate for each test when gene trees are generated under a null hypothesis (details provided in Methods and Materials). Our simulations highlight the utility of KH* for testing hypotheses involving both bifurcating topologies and hybridization networks (figs. 5 and 6). As expected, the power of KH* is a function of evolutionary model parameters as well as the number of input gene trees. In particular, we find that the significance of\nKH* tends to increase (i.e., P values decrease) as the number of input gene tree topologies increases (bottom to top across the y-axes of fig. 5) and as species divergence times increase (left to right across the x-axes of fig. 5a and b). We also see that KH* can evaluate hypotheses concerning the presence or absence of hybridization edges (fig. 5c). In particular, the hybridization proportion m has a strong influence over KH* when applied to increasingly larger data sets (bottom to top along the y-axis of fig. 5c). Statistical significance increases with both the strength of migration and the number of input gene trees (i.e., left to right and bottom to top in fig. 5c, respectively), as the dominant phylogenetic signal induced by the network changes from one of a symmetric topology (matching the alternate) to an asymmetric one with increasing m. As expected, significance was slightly reduced when using estimated instead of the known (simulated) gene trees (fig. 5a\u2013f).\nThese results were consistent when evaluating the proportion of replicates with P \u2264 0.05 for scenarios of both true positive (blue lines, fig. 6) and false positive (red lines, fig. 6) settings. As the number of loci increases from l = 10 to l = 100 (i.e., increasingly darker blue lines in fig. 6), the test demonstrates higher power to reject the null hypothesis when gene trees were simulated under a specific generating topology (black topology at the top of fig. 6) that differed from an alternate tested topology (blue topology at the top of fig. 6). Furthermore, we observe lower statistical power to distinguish between trees when using estimated gene tree topologies (fig. 6d\u2013f) compared with using true, known gene tree topologies (fig. 6a\u2013c). For applications of the KH* test to species trees involving hybridization events (fig. 6c and f), power to reject the null under true positive scenarios was highest when using large data sets (l = 100 gene trees) and moderate to high migration proportions (m \u2265 0.4). Across our simulations, we find consistent evidence of low false positive rates to reject the null hypothesis of the KH* test regardless of data set size (darker red lines indicate more loci; fig. 6).\nWe also evaluated the statistical power for rejecting the null hypothesis using simulated and estimated gene trees for a scenario of bifurcating and reticulating species trees with the SH* test (fig. 7) using the SH\u22172 algorithm. We tracked P values of the SH* test across simulations for the true species tree used to generate the input genealogies (black trees; fig. 7), two specific alternative topologies (blue trees; fig. 7), and the mean across all 14 alternative topologies (right column; fig. 7). We also conducted a separate series of analyses to investigate false positive rates under randomly generated genealogies (red lines; fig. 7), with false positive rates elevated slightly (\u223c0.05\u20130.07 across different numbers of input gene trees). Note that these elevated false positive rates are due to using the fast SH* algorithm (SH\u22172), and we later show that the false positive rates are better controlled when using the SH\u22171 algorithm instead. Increasing the number of input genes from l = 10 to l = 100 (increasingly darker blue lines in fig. 7) improves the power of the SH* test for both known (fig. 7a\u2013c) and estimated (fig. 7d\u2013f) gene trees. Moreover,\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nechoing the findings of the KH* test, we observe that statistical power is reduced when applying the SH* test to estimated gene trees (fig. 7d\u2013f) compared with known gene trees (fig. 7a\u2013c).\nIn addition to our simulation analyses, we also explored the application of the SH* test to an empirical data set comprising a total of 8,870 gene trees (4,279 exon, 912 intron, and 3,679 ultraconserved elements [UCEs]) obtained from Jarvis et al. (2014), including a set of t = 33 distinct proposed 20-taxon topologies for the avian phylogeny. Specifically, we applied the SH* test to evaluate these 33 species topologies when sampling increasing larger sets of input gene trees. In these empirical analyses, we find that increasing the number of gene trees analyzed resulted in strong statistical support for rejecting the null hypothesis across the 33 bird topologies in our applications of SH* (fig. 8). These analyses also highlight quantitative differences in results of the SH* test depending on locus type (UCEs vs. exons vs. introns) and data set size (number of genes). For example, SH* displays higher significance (i.e., lower P values) when analyzing intron-based gene trees. However, even with large data sets (i.e., \u2265 100 gene trees), null hypotheses are not rejected for certain topologies. For example, the UCE and intron analyses that used all available gene trees fail to reject the \u201cIntron_MP-EST_unbinned\u201d (topology inferred with MP-EST using introns only) and \u201cTENT_MP-EST_unbinnned\u201d\n(topology inferred using all nucleotide data with MP-EST) topologies that were both inferred without locusbinning methods (i.e., \u201cstatistical\u201d binning\u201d; Mirarab, Bayzid, et al. 2014; Mirarab, Reaz, et al. 2014; Adams and Castoe 2019), while the \u201cLiterature_Morphology_Livezey Zusi\u201d (morphology-based topology) and \u201cExon_RAxML_ Heterogeneous\u201d (concatenated RAxML tree inferred using exons only with heterogenous model partitions) topologies are identified in the exon-only applications of SH* (fig. 8; for more details on these trees, see Jarvis et al. 2014).\nAs with both the KH* and SH* tests, we also estimated the statistical power and false positive rate of the SOWH* test under various evolutionary simulations. Our applications of SOWH* highlight both its statistical properties under simulated settings (fig. 9) and its utility for testing contentious species tree hypotheses in an empirical application (fig. 10). As with the KH* test, we find higher statistical power of the SOWH* test as both the branch lengths (increasing from left to right along the x-axes) and the number of input gene trees (increasingly darker blue lines) increase (fig. 9). That is, providing more input gene trees increases the power of the test for rejecting the null hypothesis. We also find evidence of low false positive rates across different data set sizes (increasingly darker red lines; fig. 9) with the SOWH* test for testing two scenarios that differ in the shape of the tested trees (i.e., unbalanced topology vs.\nnu m\nbe r o\nf g en\ne tr\nee s\nA B C D A C B D A B C D A B C D A B C DA B C D\nm\n10\n(a)\n20 30 40 50 60 70 80 90\n100\nP-value\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0(b)\n0.0 0.4 0.6 1.2 1.6 2.0\nnu m\nbe r o\nf g en\ne tr\nee s\n10 20 30 40 50 60 70 80 90\n100\n(c)\n(d) (e) (f)\n0.0 0.4 0.8 1.2 1.6 2.0\nm 0.0 0.2 0.4 0.6 0.8 1.0\nFIG. 5. Demonstrating the KH* test across an array of simulation scenarios for evaluating bifurcating topologies (left and center panels) and a species network (right panels). Heatmaps depict the mean P value obtained across 100 replicate analyses for each combination of simulation conditions (darker to lighter colors represent higher to lower P values), and the two topologies that are tested are shown above each respective heatmap. The data set sizes (i.e., number of input gene trees l) are represented on the y-axes, whereas the x-axes depict the scaling of different evolutionary parameters used in the simulations. For each set of conditions, gene trees were simulated using the left, \u201ctrue\u201d (generating) species topology shown above each respective set of analyses, with the alternative topology shown to the right in blue, and either the divergence times scaled by multiplying branches by a scaling factor \u03b3 \u2208 [0.1, 2] (all branches multiplied by the value of \u03b3) for the left and center panels (a, b, d, and e) or by varying the migration fraction m \u2208 [0, 1] for the network shown in the right panels (c and f ). The top panels (a\u2013c) were conducted using the true, simulated gene trees, while the results shown in the bottom panels (d\u2013f ) were analyzed using estimates of the gene trees.\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nbalanced topology; fig. 9a\u2013d), particularly when the branch lengths of the species tree are longer.\nIn addition to our simulation analyses, we applied the SOWH* test to three example case studies of contentious phylogenetic relationships in amphibians, reptiles, and birds (hypotheses shown in fig. 10). In each of the three empirical demonstrations (Amphibians, Reptiles, and Neoaves), SOWH* identifies evidence to reject the null hypothesis for at least one of the proposed topologies (fig. 10). In our analyses of the Amphibian trees, we find that SOWH* fails to reject the null hypothesis for one of the target trees using both algorithms (fig. 10a and d). For the Reptile analysis, SOWH* fails to reject the null hypothesis for the placement of birds as sister to turtles and crocodiles (fig. 10b and e), whereas both topologies reject the null in our Neoaves demonstration (fig. 10c and f). We find that the shape of the null distribution of the test statistic (gray violin plots in fig. 10) depends on whether RELL approximation is used (i.e., SOWH\u22171 vs. SOWH \u2217 2 ; top vs. bottom panels in fig. 10) but with matching outcomes for rejecting or failing to reject the null."
        },
        {
            "heading": "Discussion",
            "text": "These methods seek to synergize both the \u201cold\u201d and the \u201cnew\u201d within a unified framework and represent a first step\ntoward developing new approaches that incorporate more complex species models, hypotheses, algorithms, and statistical procedures. For example, we can envision hypothesistesting frameworks for species models that include additional processes that influence gene tree distributions (e.g., Lanier and Knowles 2012; Adams et al. 2018; Koch and DeGiorgio 2020). Importantly, we view these tests as complementary with existing methods for evaluating species tree hypotheses and models, such as Bayesian approaches for phylogenetic model testing (e.g., *BEAST, SNAPP, and BPP; Rannala and Yang 2003; Heled and Drummond 2009; Bryant et al. 2012). Such Bayesian approaches make use of full sequence alignments and provide a natural measure of reliability with posterior probabilities and thus are a gold standard for species tree inference. Yet, because they employ Markov chain Monte Carlo algorithms in their estimation procedure, they are highly computationally expensive. Our approaches provide a model-based framework for testing species topology hypotheses while making computations on large genomic data sets more tractable via heuristic ML algorithms that operate on input gene tree topologies rather than sequence alignments. Additionally, our implementation of the KH\u22171 test most closely resembles that of the species topology test implemented in Liu et al. (2019).\nThese species topology tests mirror their gene-based counterparts and share many of the same assumptions;\n(a) (b) (c)\n(d) (e) (f)\nFIG. 6. Assessing the statistical performance of the KH* test across an array of simulation scenarios for evaluating true positives (blue trees and lines) and false positives (red lines) for bifurcating topologies (a, b, d, and e) and a species network (c and f ). Results shown for tests of scenarios involving true positives (alternative topologies tested shown in dark blue) and false positive rates (red lines). For estimating power (blue lines), gene trees were simulated using the left, \u201ctrue\u201d (generating) species topology shown above each respective set of analyses, with the alternative topology shown to the right in blue above each set of analyses. False positive rates were estimated using randomly generated coalescent gene trees (red lines). Lines indicate the proportion of replicates with P \u2264 0.05, with colors ranging from light (l = 10 gene trees) to dark (l = 100 gene trees) in increments of 10 gene trees. Top panels (a\u2013c) show results when using the true, simulated gene trees, whereas estimated gene trees were used in the test results shown in the bottom panels (d\u2013f ). See figure 5 caption for additional information regarding the parameters \u03b3 and m.\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nwe emphasize that most any consideration of the original tests is also likely relevant. For example, as with the original KH test, KH* is only valid when comparing species topologies that have been defined a priori, meaning that it is inappropriate to apply the test when one of the topologies has already been selected as the ML estimate\nbecause the null expectation of \u03b4 = 0 no longer holds. Similarly, the SH* and SOWH* tests are also subject to considerations and limitations of their respective gene tree counterparts. For example, SH is often more conservative than SOWH, and SOWH may be more prone to false positives, at least when models are misspecified\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0 (a) A B C D\nA C B D\nA B C D A B C D\n(b) (c) A B C D\nmean across 14 alternative topologies\nl =\n10\nl =\n10 0\nl = 10\nl =\n10 0 l\n= 1 0l\n= 10\n0\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0 (d) (e) (f)\nl =\n10\nl =\n10 0\nl = 10\nl =\n10 0\nl = 10 l =\n10 0\n0.5 1.0 1.5 2.00.0 0.5 1.0 1.5 2.00.0 0.5 1.0 1.5 2.00.0\n\u03b3 \u03b3 \u03b3\nFIG. 7. Assessing the statistical performance of the SH* test across an array of simulation scenarios for evaluating true positives (blue trees and lines) as well as estimated false positive rates (red lines). Lines indicate the proportion of replicates with P \u2264 0.05, with colors ranging from light (l = 10 gene trees) to dark (l = 100 gene trees) in increments of 10 gene trees. Top panels (a\u2013c) show results when using the true, simulated gene trees, whereas estimated gene trees were used in the test results shown in the bottom panels (d\u2013f ). The third column shows the fraction of replicates with P \u2264 0.05 averaged across all 14 alternative rooted topologies for four-species trees. Generating species topology shown on the left, with the alternative topologies shown in blue. See figure 5 caption for additional information regarding the parameter \u03b3.\n1k90080070060050040030 02001009080706050403020101k90080070060050040030 0200100908070605040302010 367 9\nnumber of gene trees\n\"Intron R A xM L H om ogenous\"\n\"T E N T M P-E ST (unbinned)\"\n\"Intron M P-E ST (unbinned)\"\n\"E xon\nR A xM L H eterogenous\"\n\"L iterature M orphology (L ivezey-Z\nusi)\"\nnumber of gene trees number of gene trees 427 9 1k90080070060050040030 0200100908070605040302010 912\n\"T E N T M P-E ST (unbinned)\"\n\"Intron M P-E ST (unbinned)\"\n0.0\n0.25\n0.50\n0.75\n1.0\nP -v\nal ue\nUCEs exons introns\nFIG. 8. Applying SH\u2217 to the avian phylogenomic data set. Boxplots summarizing the distribution of P values across 100 replicate analyses for each data set size obtained for 33 avian species topologies computed for different data set sizes (number of genes) and for different locus types: UCEs (left), exons (center), and introns (right). Tree labels in the upper right of each panel indicate the names of particular trees defined in Jarvis et al. (2014).\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\n(Buckley 2002). Another limitation of these tests in their current form is that only gene topologies are considered, similar to two-step species tree algorithms (e.g., STELLS and ASTRAL). Here, we focused our study on exploring the application of the MSC likelihood function as implemented in STELLS and PhyloNet frameworks; other similar approaches (e.g., STEM, MP-EST, and PRANC; Kubatko et al. 2009; Liu et al. 2010; Kim and Degnan 2020) may prove fruitful for future studies and work on phylogenetic hypothesis tests.\nWe also wish to underscore the important assumption of these tests, which is that input gene trees are error free. Though this assumption is shared with many heuristic approaches for species tree inference, it can inflate phylogenetic conflict when violated (Yang 2002; Burgess and Yang 2008; Seo 2008; Xu and Yang 2016; Forthman et al. 2022). Using the SH* test as an example, we observed reduced power when estimating gene tree topologies from shorter loci (fig. 11a\u2013c) when compared with longer loci (fig. 11d\u2013i) for which gene tree estimates would be more reliable. Nonetheless, we find evidence of low and consistent estimates of false positive rates (fig. 12), even for short\nloci, with slightly lower false positive rates with the SH\u22171 algorithms compared with the SH\u22172 (RELL bootstrap approximation) for the conditions explored here (left vs. right results in fig. 12, respectively). Though we probed the behavior of these tests when applied to both simulated and estimated gene trees (figs. 5\u20137, 9, 11, and 12), a broader exploration of evolutionary and experimental settings may reveal a parameter space for which these tests perform differently. As with other methods that assume error-free input, accuracy is likely to be heavily influenced by gene tree quality, and we believe that input quality should be carefully considered when using SpeciesTopoTestR. To address such concerns, a potential area of future improvement is to incorporate multiple levels of bootstrapping that resample both gene trees and sequence alignment columns. However, such a strategy is expected to require a significant computational burden as well as assumptions about the models of sequence evolution, while missing data from the original sequence alignments may also pose challenges.\nRelated to these concerns is the potential for recombination to influence species tree inference and therefore the hypothesis tests described in this study. Traditional\n(a) (b)\n0.0 0.5 1.0 1.5 2.0\nl = 10\n0.0 0.5 1.0 1.5 2.0\nl = 1 0\nl = 1\n00\nl = 1 0\nl = 1\n00\nl = 1\n0\n(c) (d)\nA B C D A C B D A B C D A B C DA C DB A C DB\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nPr op\n. P -v\nal ue\n< 0.\n05\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nPr op\n. P -v\nal ue\n< 0.\n05\nFIG. 9. Investigating the statistical performance of the SOWH* test across an array of simulation scenarios for evaluating true positives (blue trees and lines) and false positives (red trees and lines). Lines indicate the proportion of replicates with P \u2264 0.05, with colors ranging from light blue (l = 10 gene trees) to dark blue (l = 100 gene trees) in increments of 10 gene trees. Results shown for the scenarios using the true, simulated gene trees (a and b), and the estimated gene trees (c and d ). Generating species topologies shown in black to the left above each set of analyses, with the tested topologies shown in blue (i.e., true positives) or red (i.e., false positives). See figure 5 caption for additional information regarding the parameter \u03b3.\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\napproaches to gene tree inference using ML or Bayesian inference typically assume that all sites within a locus are genetically linked and therefore share the same genealogical history (i.e., no recombination within a sequence alignment). Likewise, most species tree methods assume free recombination between loci and a lack of recombination within a locus. The tests described in this study implement similar frameworks and therefore make the same assumptions. Recombination can be a challenge for gene tree estimation by influencing branch length and topology estimates under certain conditions (Schierup and Hein 2000; Posada and Crandall 2002). These challenges may be particularly relevant for analyses of large phylogenomic data sets sampled across many species with ample opportunity for recombination events across a tree (Adams and Castoe 2018). For species tree inference, recent studies have found evidence that commonly used species tree algorithms may be relatively robust to intralocus recombination for some methods (Lanier and Knowles 2012). However, the impacts of simultaneously violating both assumptions\u2014free recombination among loci but no recombination within a locus\u2014remain an open question (Wang and Liu 2016). Methods that seek to test for evidence of phylogenetic congruency may hold promise for\nevaluating evidence for intralocus recombination (Paraskevis et al. 2005; Martin et al. 2011; Adams et al. 2021). Importantly, we caution that users carefully consider this and all other assumptions when conducting the KH*, SH*, and SOWH* tests. Similar to previous studies (e.g., Lanier and Knowles 2012), we also found evidence that the KH* test may be relatively robust to certain conditions of recombination (fig. 13). Future work will help our understanding of recombination and other model violations on species tree tests and inference."
        },
        {
            "heading": "Materials and Methods",
            "text": "Evaluating the KH* Test To explore the behavior of the KH* test (fig. 2), we conducted simulations across varying evolutionary (e.g., topologies and divergence times) and experimental (e.g., number of input gene trees l) parameters. We first evaluated KH* for assessing support between two alternative bifurcating four-taxon species topologies (fig. 5a) by simulating data sets that varied in number of gene trees l \u2208 {1, 2, . . . , 10, 20, . . . , 100} and coalescent branch lengths on the species tree. We used these analyses to evaluate the statistical power of the test for rejecting the\nAmbystoma\nXenopus\nRana\nCyclorana\nIchthyophis\nParamesotriton\nAmbystoma\nIchthyophis\nXenopus\nRana\nCyclorana\nParamesotriton Pelodiscus\nTrachemys\nCrocodylus\nAlligator\nStruthio\nColumba\nPelodiscus\nTrachemys\nCrocodylus\nAlligator\nStruthio\nColumba\n(a) l = 1845 gene trees (c) l = 2328 gene trees(b) l = 2639 gene trees \u03b4 (i )\n0\n50\n100\n150\n2000\n2500\n3000\n0\n1000\n2000\n3000\n4000\n5000\n6000\n0.0\n0.1\n0.2\n0.3\n0.4\n500\n600\n0\n200\n400\n600\n2000\n3000\n0\n200\n400\n500\n300\n100\n5000\n6000\n0\n100\n200\n300\n400\n500\n\u03b4 (i\n)\nFicedula\nZonotrichia\nTaeniopygia\nFalco\nColumba\nMelopsittacus\nFicedula\nZonotrichia\nTaeniopygia\nColumba\nFalco\nMelopsittacus\n(d) l = 1845 gene trees (f) l = 2328 gene trees(e) l = 2639 gene trees\nFIG. 10. Applying the SOWH\u2217 to three example test cases: Amphibians (left columns), Reptiles (center columns), and Neoaves (left columns). Violin plots depict the distribution of the test statistic \u03b4(i) across b = 103 replicates for each pair of trees shown at the bottom. Stars indicate the value of the observed statistic, with colors of the stars indicating whether the result is statistically significant (red stars) or not (blue stars) given the null distribution (gray violin distributions). The top row of violin plots (a\u2013c) indicates the results obtained using the SOWH\u22171 algorithm, while the bottom row (d\u2013f ) shows the results of the SOWH\u22172 algorithm.\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nnull hypotheses when the null hypotheses are indeed false because one specific topology was used to generate a set of gene trees, and a separate, alternative topology was included in the test. Specifically, gene trees were simulated using a \u201ctrue\u201d (generating) species tree (fig. 5a, left topology in black) with branches (in coalescent units) scaled by multiplying by a factor \u03b3 = [0.1, 2], and KH* was applied using an \u201cincorrect\u201d alternative topology with a swapped branch (fig. 5a, right topology in blue) and 104 bootstrap replicates to compute P values under the null hypothesis. That is, we used these simulations to evaluate the power of the test for rejecting the null hypothesis, as we expect that the \u201ccorrect\u201d topology (fig. 5a, left topology in black) should be more supported than the \u201cincorrect\u201d topology (fig. 5a, right topology in blue) as the number of input gene trees increases, because the \u201ccorrect\u201d topology was used to directly simulate the input gene trees. For each combination of branch length scaling and gene tree counts, we performed 100 replicates to obtain a distribution of P values across the different simulation settings.\nWe also conducted similar analyses that assumed a different symmetric topology as the \u201cincorrect\u201d alternative topology (right topology in blue; fig. 5b) using these same simulation conditions to demonstrate power for rejecting the null hypothesis with different topologies. Input gene trees were simulated using the \u201ccorrect\u201d topology (fig. 5b, left topology in black), and we evaluated power for rejecting the null hypotheses using the \u201cincorrect\u201d alternative topology (right topology in blue; fig. 5b). Additionally, we explored the behavior of KH* for evaluating hybridization hypotheses. Gene trees were simulated under a network topology (fig. 5c, left network) using PHYLONET (Than et al. 2008) with a single directional pulse of migration with proportion m \u2208 [0, 1], which were then used to assess support for this network and an \u201cincorrect\u201d alternative bifurcating topology with the migration edge removed (i.e., m = 0). These simulations evaluated the power of the test for rejecting the null hypotheses because a hybridization network was used to simulate the input gene trees, while we tested an alternative \u201cincorrect\u201d bifurcating tree (blue topology; fig. 5c).\n(a) (b) (c)\n(d) (e) (f)\n(g) (h) (i)\nFIG. 11. Estimated gene trees and statistical power of the SH* test. Results are shown for estimates of true positive rates (blue lines and trees) across a range of branch scaling values \u03b3 = [0.1, 2] with gene trees estimated from simulated alignments comprising 100 bp (a\u2013c), 1 kb (d\u2013f ), and 10 kb (g\u2013i). Lines indicate the proportion of replicates with P \u2264 0.05, with colors ranging from light blue (l = 10 gene trees) to dark blue (l = 100 gene trees) in increments of 10 gene trees. The third column shows the fraction of replicates with P \u2264 0.05 averaged across all 14 alternative rooted topologies for four-species trees. See figure 5 caption for additional information regarding the parameter \u03b3.\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nAcross these simulations, heatmaps illustrate mean P values computed across the 100 replicates using the true species topology (left topologies in fig. 5a\u2013c) and an alternative topology (right topologies in fig. 5a\u2013c) with the KH\u22172 algorithm for each set of simulation conditions. Additionally, we also used these simulation scenarios to quantify the proportion of replicates with P \u2264 0.05 to investigate true positives (blue trees and results shown in fig. 6). We evaluated the false positive rate of the KH* test (red curves displayed in fig. 6) by simulating random input gene trees under the coalescent process without any species trees using the rcoal function provided in the R package APE (Paradis et al. 2004).\nInvestigating the Impact of Input Gene Tree Error To assess the performance of the KH* test under scenarios with gene tree estimation error, we repeated each simulation analysis using estimated gene trees (figs. 5d\u2013f and 6d\u2013f) instead of the known simulated gene trees. Using a uniform per-base, population-scaled mutation rate of \u03b8 = 0.01, we simulated 2-kb alignments for each simulated gene tree under the HKY model (Hasegawa et al. 1985) with parameter values inspired by Burgess and Yang (2008): a transition/transversion ratio of 4.6 and base equilibrium frequencies of 0.3 (A), 0.2 (C), 0.2 (G), and 0.3 (T). A single gene tree was estimated for each 2-kb alignment using IQ-TREE (Nguyen et al. 2015), and the estimated set of gene trees was then used as input to KH*. We evaluated both true positives (blue lines in fig. 6) and false positives (red lines in fig. 6) using these estimated gene trees instead of the true, simulated gene trees. In addition to the KH* test, we used this strategy to assess the performance of both the SH* and SOWH* tests with estimated gene trees as well as simulated gene trees (details provided in the following sections).\nOur chosen branch lengths and their associated scaling by \u03b3 permit evaluation of species hypotheses that are difficult for inference. Specifically, in our simulations with short internal branch lengths in terms of coalescent time\nunits (i.e., small \u03b3), we expect extensive gene tree variation as well as discordance of gene trees with species trees (Degnan and Rosenberg 2009) due to ILS (Maddison 1997). For extreme settings in which the scaling parameter leads to particularly small internal branch lengths, the level of gene tree incongruence would be consistent with expectations from adaptive radiations, such as in the evolution of Aves and other Amniotes (Jarvis et al. 2014; Shen et al. 2017). However, under mutation, our tested scenarios are not completely concordant with Amniote evolution, as species branching tends to be deep in the past (e.g., Song et al. 2012) and we would therefore expect larger numbers of mutations along such branches, and in the extreme case of deep evolution of Aves, recurrent mutation may reduce phylogenetic signal and increase gene tree estimation error (Salichos and Rokas 2013; Xi et al. 2015; Xu and Yang 2016). However, our experiments still represent difficult cases, as the external branches of our experiments would have little bearing on gene tree topology estimation, with the exception that recurrent mutation is unlikely to be an additional factor for gene tree estimation error and hence inaccuracies of our species tree topology tests. Instead, we focus on how gene tree estimation error can hamper our tests, as it has been shown to enhance phylogenetic conflict (Seo 2008; Xu and Yang 2016; Forthman et al. 2022).\nEvaluating the SH* Test To evaluate the statistical properties of the SH* test, we conducted a series of simulations based on the same scenarios used for our KH* investigations (species tree models shown at top of fig. 7). Briefly, we simulated gene tree sets of varying size l \u2208 {1, 2, . . . , 10, 20, . . . , 100} and coalescent branch lengths scaled by \u03b3 = [0.1, 2]. For each set of simulation conditions, we generated 100 replicate data sets and applied the SH\u22172 algorithm to estimate true positive rates for \u201cincorrect\u201d alternative topologies (blue topologies; fig. 7). To evaluate false positive rates, as with our KH* experiments, we simulated genealogies using rcoal without any particular species tree because the null\n10 20 30 40 50 60 70 80 90 100 10 20 30 40 50 60 70 80 90 100\n0.00\n0.25\nLocus Length True Gene Trees 100bp 1kb 2kb 10kb\nE st\nim at\ned F\nal se\nP os\niti ve\nR at\ne\nNumber of Gene Trees\nSH2 *SH1 *\nNumber of Gene Trees\nFIG. 12. Evaluating the impact of gene tree estimation error on false positive rates of the SH* test. Results are shown for false positive rates estimated using randomly generated gene trees of uniform probability (i.e., no species tree was used) for both the SH\u22171 (left) and SH\u22172 (right) algorithms across increasing numbers of input gene trees (left to right; 10\u2013100 gene trees) and different locus lengths (points; from 100 bp to 10 kb), with red circles indicating the use of the true, simulated gene trees.\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nhypothesis H0:E[\u03b4] = 0 is predicted to hold because we do not expect, on average, that any species tree should be favored over another for these gene trees. We evaluated the performance of the SH* test for both the true simulated gene trees and estimated gene trees using the same protocol as with our KH* test experiments, which involved simulating 2-kb alignments for each gene tree under the HKY model with a transition/transversion ratio of 4.6 and base equilibrium frequencies of 0.3 (A), 0.2 (C), 0.2 (G), and 0.3 (T). Gene tree estimates were then obtained for each alignment using IQ-TREE, and the estimated set of gene trees was then used as input to SH*.\nThroughout our simulations, we evaluated the true positive rate of the SH* test by tracking the fraction of replicates with P \u2264 0.05 of two alternative topologies (i.e., blue trees shown at the tops of fig. 7a and b) as well as the fraction of replicates with P \u2264 0.05 averaged across all 14 possible alternative topologies for four species (fig. 7c). We conducted a separate array of analyses to investigate the impacts of different locus lengths when estimating gene trees to be used as input into the SH* test. We varied the number of base pairs across three orders of magnitude (100 bp, 1 kb, and 10 kb) and applied SH* using the gene tree estimates following the same protocol as with the KH* test simulations to estimate both the true positive rates (i.e., trees shown at top of fig. 11; application of SH\u22172 algorithm) and false positive rates (results shown in fig. 12; applications of SH\u22171 and SH \u2217 2).\nWe also demonstrated SH* on an empirical phylogenomic example consisting of 8,870 gene trees (4,279 exon, 912 intron, and 3,679 UCEs) obtained from the Jarvis et al. (2014) bird study. We applied SH* on these trees for a set of t = 33 distinct proposed 20-taxon topologies for the avian phylogeny (Jarvis et al. 2014; fig. 8) using the SH\u22172 algorithm with 10\n4 RELL replicates in distinct analyses of only exons, introns, or UCEs and explored the\ninfluence of data set size by varying the number of input gene trees on a logarithmic scale (i.e., 10, 20, \u2026, 100, 200, \u2026, 1000). For each of the three locus types (exons, introns, or UCEs) and data set sizes, we conducted 100 replicate analyses by sampling (with replacement) from their respective gene tree sets (i.e., only exons, introns, or UCEs) and applying SH* to each replicate. We also conducted separate analyses using either all 4,279 exons, all 912 introns, or all 3,679 UCEs.\nEvaluating the SOWH* Test We first investigated the statistical performance of the SOWH* test using two four-tip species trees scenarios (shown at top of fig. 9). Following the same protocol for the simulation-based investigation of the KH* and SH* tests, we evaluated the fraction of replicates that resulted in false positives (i.e., red trees at top of fig. 9) and true positives (i.e., blue trees at top of fig. 9) by repeatedly simulating gene tree sets for l \u2208 {1, 2, . . . , 10, 20, . . . , 100} loci according to the black species trees shown at the top of figure 9 with branch lengths scaled by a factor \u03b3 = [0.1, 2]. We conducted 100 replicates for each set of simulation conditions and applied the SOWH\u22172 algorithm with 103 bootstrap replicates to compute P values under the null hypothesis. Additionally, we repeated these analyses to investigate the behavior of the SOWH* test using gene tree estimates obtained from IQ-TREE following the same protocol as applied for the KH* and SH* tests, with 2-kb alignments simulated according to the HKY model with a transition/transversion ratio of 4.6 and base equilibrium frequencies of 0.3 (A), 0.2 (C), 0.2 (G), and 0.3 (T).\nWe also conducted an empirical demonstration of the SOWH* using three example case studies (Amphibians, Reptiles, and Neoaves) that were previously investigated by Shen et al. (2017) to explore the causes and\nnu m\nbe r o\nf g en\ne tr\nee s\n100\n0 .0\n0 .2\n0 .4\n0 .6\n0 .8\n1 .0\n0.0 0.5 1.0 1.5 2.0\n(a) (b)\nP ro\np. P\n-v al\nue <\n0 .0\n5\n90\n80\n70\n60\n50\n40\n30\n20\n10\nP -value 1.0\n0.0\n0.0 0.4 0.6 1.2 1.6 2.0\nl = 10\nl = 1\n00\nA B C D\nA C B D\nFIG. 13. Exploring the impact of recombination on the statistical performance of the KH* test. Results are shown for the mean P value across replicates (a) and proportion of replicates with P \u2264 0.05 (b). For each set of conditions, gene trees within a recombining locus were simulated using the \u201ctrue\u201d (generating) species topology shown to the right in black, with the alternative topology shown in blue. Divergence times for the true topology were scaled by multiplying branches by a scaling factor \u03b3 \u2208 [0.1, 2]. See Materials and Methods for our simulation protocol.\nD ow nloaded from https://academ ic.oup.com /m be/article/40/7/m sad159/7223883 by Indian Institute of Technology Patna user on 13 January 2024\nconsequences of phylogenomic conflict. Thus, we sought to apply SOWH* to characterize statistical support for contentious species topology hypotheses in each of these examples (hypothesized topologies shown in fig. 10). We employed both SOWH\u22171 and SOWH \u2217 2 with 10\n3 bootstrap replicates on two plausible rooted Neoaves, Reptiles, or Amphibian topologies using the 2,328, 2,639, or 1,845 respective gene trees of Shen et al. (2017).\nSimulations with Recombination Lastly, we conducted a series of simulation analyses to explore potential impacts of intralocus recombination on the statistical performance of the KH* test. For these analyses, we used the software ms (Hudson 2002) to simulate gene trees with recombination under the bifurcating species tree shown in black on the right of figure 13. Mirroring our previous analyses for evaluating the KH* test (i.e., figs. 5 and 6), we conducted simulations across varying divergence times (scaling branches by \u03b3 \u2208 [0.1, 2]) and a number of input gene trees l \u2208 {1, 2, . . . , 10, 20, . . . , 100}. In these simulations, we included a per-base, populationscaled recombination \u03c1 = 0.0004 for each locus was simulated for a total length of 2 kb. At the end of each simulated locus, we collected the gene trees and associated length of each recombination block (i.e., alignment blocks separated by recombination events). Next, we simulated sequences for each separate recombination block within a locus using the associated gene tree and the HKY model parameters used previously (e.g., figs. 5 and 6) and concatenated across all blocks within a locus to construct a single alignment of 2-kb total length. We then estimated a single gene tree from the entire 2-kb concatenated alignment; this procedure effectively violated the standard assumption of no recombination within a locus because recombination events and blocks were ignored. Finally, we used these sets of gene tree estimates as input for the KH\u22172 test using the original topology (black tree in fig. 13) and an alternative topology (blue tree in fig. 13) to evaluate statistical properties."
        },
        {
            "heading": "Acknowledgments",
            "text": "This work was supported by the National Science Foundation grants DEB-1949268, BCS-2001063, and DBI-2130666 and by the National Institutes of Health grant R35GM128590. This research was also supported by the Arkansas High Performance Computing Center, which is funded through multiple National Science Foundation grants and the Arkansas Economic Development Commission. The authors also acknowledge the use of services provided by Research Computing at the Florida Atlantic University. This work was also supported by start-up funds provided from the University of Arkansas."
        },
        {
            "heading": "Data Availability",
            "text": "All versions of our species tree hypothesis tests are implemented in the open-source R package SpeciesTopoTestR\n(github.com/radamsRHA/SpeciesTopoTestR), which requires the dependencies APE (Paradis et al. 2004), HYBRIDLAMBDA (Zhu et al. 2015), PHYLONET (Wen et al. 2018) and STELLS2 (Pei and Wu 2017).\nConflict of interest statement. The authors of this study (R.H.A and M.D.) do not report any conflicts of interest."
        }
    ],
    "title": "Likelihood-Based Tests of Species Tree Hypotheses",
    "year": 2023
}