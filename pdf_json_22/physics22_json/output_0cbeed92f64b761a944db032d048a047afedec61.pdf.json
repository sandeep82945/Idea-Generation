{
    "abstractText": "We propose a quantum error mitigation strategy for the variational quantum eigensolver (VQE) algorithm. We find, via numerical simulation, that very small amounts of coherent noise in VQE can cause substantially large errors that are difficult to suppress by conventional mitigation methods, and yet our proposed mitigation strategy is able to significantly reduce these errors. The proposed strategy is a combination of previously reported techniques, namely randomized compiling (RC) and zero-noise extrapolation (ZNE). Intuitively, randomized compiling turns coherent errors in the circuit into stochastic Pauli errors, which facilitates extrapolation to the zero-noise limit when evaluating the cost function. Our numerical simulation of VQE for small molecules shows that the proposed strategy can mitigate energy errors induced by various types of coherent noise by up to two orders of magnitude.",
    "authors": [
        {
            "affiliations": [],
            "name": "Tomochika Kurita"
        },
        {
            "affiliations": [],
            "name": "Hammam Qassim"
        },
        {
            "affiliations": [],
            "name": "Masatoshi Ishii"
        },
        {
            "affiliations": [],
            "name": "Hirotaka Oshima"
        },
        {
            "affiliations": [],
            "name": "Shintaro Sato"
        },
        {
            "affiliations": [],
            "name": "Joseph Emerson"
        }
    ],
    "id": "SP:5daf3df46e2224bdd916c4a509076082ed33a1d9",
    "references": [
        {
            "authors": [
                "Sam McArdle",
                "Suguru Endo",
                "Al\u00e1n Aspuru-Guzik",
                "Simon C Benjamin",
                "Xiao Yuan"
            ],
            "title": "Quantum computational chemistry",
            "venue": "Reviews of Modern Physics",
            "year": 2020
        },
        {
            "authors": [
                "Hari P Paudel",
                "Madhava Syamlal",
                "Scott E Crawford",
                "Yueh-Lin Lee",
                "Roman A Shugayev",
                "Ping Lu",
                "Paul R Ohodnicki",
                "Darren Mollot",
                "Yuhua Duan"
            ],
            "title": "Quantum Computing and Simulations for Energy Applications: Review and Perspective",
            "venue": "ACS Engineering Au",
            "year": 2022
        },
        {
            "authors": [
                "Julia E Rice",
                "Tanvi P Gujarati",
                "Mario Motta",
                "Tyler Y Takeshita",
                "Eunseok Lee",
                "Joseph A Latone",
                "Jeannette M Garcia"
            ],
            "title": "Quantum computation of dominant products in lithium\u2013sulfur batteries",
            "venue": "The Journal of Chemical Physics 154,",
            "year": 2021
        },
        {
            "authors": [
                "Austin G Fowler",
                "Matteo Mariantoni",
                "John M Martinis",
                "Andrew N Cleland"
            ],
            "title": "Surface codes: Towards practical large-scale quantum computation",
            "venue": "Physical Review A",
            "year": 2012
        },
        {
            "authors": [
                "Alberto Peruzzo",
                "Jarrod McClean",
                "Peter Shadbolt",
                "Man-Hong Yung",
                "Xiao-Qi Zhou",
                "Peter J Love",
                "Al\u00e1n Aspuru-Guzik",
                "Jeremy L"
            ],
            "title": "O\u2019brien. \u201cA variational eigenvalue solver on a photonic quantum processor",
            "venue": "Nature communications",
            "year": 2014
        },
        {
            "authors": [
                "Jarrod R McClean",
                "Jonathan Romero",
                "Ryan Babbush",
                "Al\u00e1n Aspuru-Guzik"
            ],
            "title": "The theory of variational hybrid quantum-classical algorithms",
            "venue": "New Journal of Physics",
            "year": 2016
        },
        {
            "authors": [
                "Peter JJ O\u2019Malley",
                "Ryan Babbush",
                "Ian D Kivlichan",
                "Jonathan Romero",
                "Jarrod R McClean",
                "Rami Barends",
                "Julian Kelly",
                "Pedram Roushan",
                "Andrew Tranter",
                "Nan Ding"
            ],
            "title": "Scalable Quantum Simulation of Molecular Energies",
            "venue": "Physical Review X",
            "year": 2016
        },
        {
            "authors": [
                "Abhinav Kandala",
                "Antonio Mezzacapo",
                "Kristan Temme",
                "Maika Takita",
                "Markus Brink",
                "Jerry M Chow",
                "Jay M Gambetta"
            ],
            "title": "Hardware-efficient variational quantum eigensolver for small molecules and quantum magnets",
            "venue": "Nature 549,",
            "year": 2017
        },
        {
            "authors": [
                "James I Colless",
                "Vinay V Ramasesh",
                "Dar Dahlen",
                "Machiel S Blok",
                "Mollie E Kimchi- Schwartz",
                "Jarrod R McClean",
                "Jonathan Carter",
                "Wibe A de Jong",
                "Irfan Siddiqi"
            ],
            "title": "Computation of Molecular Spectra on a Quantum Processor with an Error-Resilient Algorithm",
            "venue": "Physical Review X",
            "year": 2018
        },
        {
            "authors": [
                "Abhinav Kandala",
                "Kristan Temme",
                "Antonio D C\u00f3rcoles",
                "Antonio Mezzacapo",
                "Jerry M Chow",
                "Jay M Gambetta"
            ],
            "title": "Error mitigation extends the computational reach of a noisy quantum processor",
            "venue": "Nature 567,",
            "year": 2019
        },
        {
            "authors": [
                "Yangchao Shen",
                "Xiang Zhang",
                "Shuaining Zhang",
                "Jing-Ning Zhang",
                "Man-Hong Yung",
                "Kihwan Kim"
            ],
            "title": "Quantum implementation of the unitary coupled cluster for simulating molecular electronic structure",
            "venue": "Physical Review A 95,",
            "year": 2017
        },
        {
            "authors": [
                "Yunseong Nam",
                "Jwo-Sy Chen",
                "Neal C Pisenti",
                "Kenneth Wright",
                "Conor Delaney",
                "Dmitri Maslov",
                "Kenneth R Brown",
                "Stewart Allen",
                "Jason M Amini",
                "Joel Apisdorf"
            ],
            "title": "Ground-state energy estimation of the water molecule on a trapped-ion quantum computer",
            "venue": "npj Quantum Information 6,",
            "year": 2020
        },
        {
            "authors": [
                "Jarrod R McClean",
                "Sergio Boixo",
                "Vadim N Smelyanskiy",
                "Ryan Babbush",
                "Hartmut Neven"
            ],
            "title": "Barren plateaus in quantum neural network training landscapes",
            "venue": "Nature communications",
            "year": 2018
        },
        {
            "authors": [
                "Jules Tilly",
                "Hongxiang Chen",
                "Shuxiang Cao",
                "Dario Picozzi",
                "Kanav Setia",
                "Ying Li",
                "Edward Grant",
                "Leonard Wossnig",
                "Ivan Rungger",
                "George H Booth"
            ],
            "title": "The Variational Quantum Eigensolver: A review of methods and best practices",
            "venue": "Physics Reports 986,",
            "year": 2022
        },
        {
            "authors": [
                "Suguru Endo",
                "Zhenyu Cai",
                "Simon C Benjamin",
                "Xiao Yuan"
            ],
            "title": "Hybrid Quantum- Classical Algorithms and Quantum Error Mitigation",
            "venue": "Journal of the Physical Society of Japan",
            "year": 2021
        },
        {
            "authors": [
                "Ying Li",
                "Simon C Benjamin"
            ],
            "title": "Efficient Variational Quantum Simulator Incorporating Active Error Minimization",
            "venue": "Physical Review X",
            "year": 2017
        },
        {
            "authors": [
                "Kristan Temme",
                "Sergey Bravyi",
                "Jay M Gambetta"
            ],
            "title": "Error Mitigation for Short- Depth Quantum Circuits",
            "venue": "Physical review letters 119,",
            "year": 2017
        },
        {
            "authors": [
                "Andre He",
                "Benjamin Nachman",
                "Wibe A de Jong",
                "Christian W Bauer"
            ],
            "title": "Zero-noise extrapolation for quantum-gate error mitigation with identity insertions",
            "venue": "Physical Review A 102,",
            "year": 2020
        },
        {
            "authors": [
                "Shuaining Zhang",
                "Yao Lu",
                "Kuan Zhang",
                "Wentao Chen",
                "Ying Li",
                "Jing-Ning Zhang",
                "Kihwan Kim"
            ],
            "title": "Error-mitigated quantum gates exceeding physical fidelities in a trapped-ion system",
            "venue": "Nature communications 11,",
            "year": 2020
        },
        {
            "authors": [
                "Jarrod R McClean",
                "Mollie E Kimchi-Schwartz",
                "Jonathan Carter",
                "Wibe A De Jong"
            ],
            "title": "Hybrid quantum-classical hierarchy for mitigation of decoherence and determination of excited states",
            "venue": "Physical Review A 95,",
            "year": 2017
        },
        {
            "authors": [
                "Joel J Wallman",
                "Joseph Emerson"
            ],
            "title": "Noise tailoring for scalable quantum computation via randomized compiling",
            "venue": "Physical Review A 94,",
            "year": 2016
        },
        {
            "authors": [
                "Akel Hashim",
                "Ravi K Naik",
                "Alexis Morvan",
                "Jean-Loup Ville",
                "Bradley Mitchell",
                "John Mark Kreikebaum",
                "Marc Davis",
                "Ethan Smith",
                "Costin Iancu",
                "Kevin P O\u2019Brien"
            ],
            "title": "Randomized Compiling for Scalable Quantum Computing on a Noisy Superconducting Quantum Processor",
            "venue": "Physical Review X 11,",
            "year": 2021
        },
        {
            "authors": [
                "Jean-Loup Ville",
                "Alexis Morvan",
                "Akel Hashim",
                "Ravi K Naik",
                "Marie Lu",
                "Bradley Mitchell",
                "John-Mark Kreikebaum",
                "Kevin P O\u2019Brien",
                "Joel J Wallman",
                "Ian Hincks"
            ],
            "title": "Leveraging randomized compiling for the quantum imaginary-time-evolution algorithm",
            "venue": "Physical Review Research",
            "year": 2021
        },
        {
            "authors": [
                "Youngseok Kim",
                "Christopher J Wood",
                "Theodore J Yoder",
                "Seth T Merkel",
                "Jay M Gambetta",
                "Kristan Temme",
                "Abhinav Kandala"
            ],
            "title": "Scalable error mitigation for noisy quantum circuits produces competitive expectation values",
            "venue": "Nature Physics 19,",
            "year": 2023
        },
        {
            "authors": [
                "Chao Song",
                "Jing Cui",
                "H Wang",
                "J Hao",
                "H Feng",
                "Ying Li"
            ],
            "title": "Quantum computation with universal error mitigation on a superconducting quantum processor",
            "venue": "Science advances 5,",
            "year": 2019
        },
        {
            "authors": [
                "Matthew Ware",
                "Guilhem Ribeill",
                "Diego Riste",
                "Colm A Ryan",
                "Blake Johnson",
                "Marcus P Da Silva"
            ],
            "title": "Experimental Pauli-frame randomization on a superconducting qubit",
            "venue": "Physical Review A 103,",
            "year": 2021
        },
        {
            "authors": [
                "Samuele Ferracin",
                "Akel Hashim",
                "Jean-Loup Ville",
                "Ravi Naik",
                "Arnaud Carignan-Dugas",
                "Hammam Qassim",
                "Alexis Morvan",
                "David I Santiago",
                "Irfan Siddiqi",
                "Joel J Wallman"
            ],
            "title": "Efficiently improving the performance of noisy quantum computers",
            "year": 2022
        },
        {
            "authors": [
                "Nick S Blunt",
                "Laura Caune",
                "R\u00f3bert Izs\u00e1k",
                "Earl T Campbell",
                "Nicole Holzmann"
            ],
            "title": "Statistical phase estimation and error mitigation on a superconducting quantum processor",
            "year": 2023
        },
        {
            "authors": [
                "Samson Wang",
                "Enrico Fontana",
                "Marco Cerezo",
                "Kunal Sharma",
                "Akira Sone",
                "Lukasz Cincio",
                "Patrick J Coles"
            ],
            "title": "Noise-induced barren plateaus in variational quantum algorithms",
            "venue": "Nature communications 12,",
            "year": 2021
        },
        {
            "authors": [
                "Michael A Nielsen",
                "Isaac Chuang"
            ],
            "title": "Quantum Computation and Quantum Information",
            "year": 2002
        },
        {
            "authors": [
                "Seunghoon Lee",
                "Joonho Lee",
                "Huanchen Zhai",
                "Yu Tong",
                "Alexander M Dalzell",
                "Ashutosh Kumar",
                "Phillip Helms",
                "Johnnie Gray",
                "Zhi-Hao Cui",
                "Wenyuan Liu"
            ],
            "title": "Evaluating the evidence for exponential quantum advantage in ground-state quantum chemistry",
            "venue": "Nature communications",
            "year": 1952
        },
        {
            "authors": [
                "J\u00e9r\u00f4me F Gonthier",
                "Maxwell D Radin",
                "Corneliu Buda",
                "Eric J Doskocil",
                "Clena M Abuan",
                "Jhonathan Romero"
            ],
            "title": "Measurements as a roadblock to near-term practical quantum advantage in chemistry: Resource analysis",
            "venue": "Physical Review Research",
            "year": 2022
        },
        {
            "authors": [
                "Ophelia Crawford",
                "Barnaby van Straaten",
                "Daochen Wang",
                "Thomas Parks",
                "Earl Campbell",
                "Stephen Brierley"
            ],
            "title": "Efficient quantum measurement of Pauli operators in the presence of finite sampling error",
            "venue": "Quantum 5,",
            "year": 2021
        },
        {
            "authors": [
                "Tomochika Kurita",
                "Mikio Morita",
                "Hirotaka Oshima",
                "Shintaro Sato"
            ],
            "title": "Pauli String Partitioning Algorithm with the Ising Model for Simultaneous Measurement",
            "venue": "The Journal of Physical Chemistry A 127,",
            "year": 2023
        },
        {
            "authors": [
                "Pauli Virtanen",
                "Ralf Gommers",
                "Travis E. Oliphant",
                "Matt Haberland",
                "Tyler Reddy",
                "David Cournapeau",
                "Evgeni Burovski",
                "Pearu Peterson",
                "Warren Weckesser",
                "Jonathan Bright"
            ],
            "title": "SciPy 1.0: Fundamental algorithms for scientific computing in Python",
            "venue": "Nature Methods",
            "year": 2020
        },
        {
            "authors": [
                "Michael JD Powell"
            ],
            "title": "The BOBYQA algorithm for bound constrained optimization without derivatives",
            "venue": "Technical report",
            "year": 2009
        },
        {
            "authors": [
                "Jarrod R. McClean",
                "Ian D. Kivlichan",
                "Damian S. Steiger",
                "Yudong Cao",
                "E. Schuyler Fried",
                "Craig Gidney",
                "Thomas H\u00e4ner",
                "Vojt\u0115ch Havl\u00ed\u010dek",
                "Zhang Jiang",
                "Matthew Neeley"
            ],
            "title": "OpenFermion: The Electronic Structure Package for Quantum Computers",
            "venue": "Accepted in Quantum 2023-10-04,",
            "year": 2023
        }
    ],
    "sections": [
        {
            "text": "Synergetic quantum error mitigation by randomized compiling and zero-noise extrapolation for the variational quantum eigensolver Tomochika Kurita1, Hammam Qassim2, Masatoshi Ishii1, Hirotaka Oshima1, Shintaro Sato1, and Joseph Emerson2\n1Quantum Laboratory, Fujitsu Research, Fujitsu Limited. 10-1 Morinosato-wakamiya, Atsugi, Kanagawa, Japan 243-0197 2Keysight Technologies Canada, 137 Glasgow St, Kitchener, ON, Canada, N2G 4X8\nWe propose a quantum error mitigation strategy for the variational quantum eigensolver (VQE) algorithm. We find, via numerical simulation, that very small amounts of coherent noise in VQE can cause substantially large errors that are difficult to suppress by conventional mitigation methods, and yet our proposed mitigation strategy is able to significantly reduce these errors. The proposed strategy is a combination of previously reported techniques, namely randomized compiling (RC) and zero-noise extrapolation (ZNE). Intuitively, randomized compiling turns coherent errors in the circuit into stochastic Pauli errors, which facilitates extrapolation to the zero-noise limit when evaluating the cost function. Our numerical simulation of VQE for small molecules shows that the proposed strategy can mitigate energy errors induced by various types of coherent noise by up to two orders of magnitude."
        },
        {
            "heading": "1 Introduction",
            "text": "Quantum computing is an emerging technology with the potential to solve classically intractable computational problems. One of its most promising applications is simulation of quantum chemistry [1, 2, 3]. Standard approaches for solving quantum chemistry problems on a quantum computer require a fault-tolerant implementation [4], which unfortunately remains a distant future prospect. The variational quantum eigensolver (VQE) algorithm was proposed as a near-term alternative [5, 6]. VQE is based on the hybrid quantum-classical computational paradigm, where a classical computer guides a parameterized quantum circuit towards the correct solution. In recent years, proof-of-principle demonstrations of VQE were successfully conducted on current, noisy intermediate-scale quantum (NISQ) computers [3, 5, 7, 8, 9, 10, 11, 12].\nScaling VQE to larger system sizes seems to pose serious challenges. For example it is known that variational algorithms suffer from the barren plateau phenomenon, where the energy landscape is exponentially flat in most of the Hilbert space [13]. Additionally, when the circuit ansatz contains too many parameters the classical optimization step could become too slow to converge [14]. These problems are greatly exacerbated in the presence\nTomochika Kurita: kurita.tomo@fujitsu.com\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 1\nar X\niv :2\n21 2.\n11 19\n8v 3\n[ qu\nan t-\nph ]\n1 3\nN ov\n2 02\n3\nof noise. Studying the complex interplay in VQE between noise, classical optimization, and circuit ansatz is a major motivation of this work. As the error tolerance required for useful chemistry calculations is very small (< 1.6 mHa), it is highly desirable to find ways to suppress and mitigate the effect of different noise processes in VQE.\nTo address the problem of noise on near-term devices, several quantum error mitigation schemes have been proposed to suppress the effect of quantum noise and correct the expectation values of observables of interest [15]. Unlike quantum error correction, error mitigation schemes do not require additional qubits, but generally require additional circuit runs and possibly some increase in circuit depth. Most critically, the accuracy of these methods depends on very strong, physically unmotivated or difficult-to-verify assumptions about the nature of the error model affecting the computation. Overcoming the latter limitation is another major motivation of the current work.\nA few variants of quantum error mitigation are known, some of which specifically target VQE applications. For example, zero-noise extrapolation (ZNE) [10, 16, 17, 18] and probabilistic error cancellation (PEC) [17, 18, 19] are effective for mitigating Pauli-stochastic noise. The quantum subspace expansion (QSE) [9, 20] was suggested to mitigate errors in VQE, and was argued to be especially effective for mitigating the effect of decoherence. However, these methods are not effective in the presence of coherent noise, and while some kinds of coherent noise can be reduced by better calibration of the hardware, other kinds, such as coherent crosstalk, pose significant challenges with current calibration technology. Furthermore, even a small miscalibration can result in significant error in the algorithm\u2019s output if the computation is relatively long. Randomized compiling (RC) [21] is a compilation technique with an important noise-tailoring effect, in which coherent noise processes in a noisy circuit are transformed into effective incoherent noise processes, with a marked reduction in the worst-case error rate. The benefit of RC for practical algorithms has been demonstrated in experiment [22], as well as methods that combine RC with quantum error mitigation protocols [23, 24, 25, 26, 27, 28]. To the best of our knowledge the effect of combining RC with quantum error mitigation on the accuracy of a VQE algorithm has not been reported thus far.\nIn this work we numerically simulate noisy VQE experiments and show significant improvement in their performance under an error mitigation strategy that combines RC and ZNE. We give evidence that this improvement is generic by performing simulations under varied conditions, such as different target molecules, noise models, and classical optimizers. We use a structured variational ansatz, namely the unitary coupled cluster ansatz with single and double excitations (UCC-SD) [6]. The main advantage from using a structured ansatz is that it explores a small subset of the Hilbert space, in which there is good reason to believe the ground state lies \u2013 thus it requires fewer circuit parameters and is less likely to exhibit a vanishing gradient in the error-free case [29].\nIn our simulations we use an error model in which single-qubit gates are perfect and two-qubit gates are noisy, where the noise is described by a small unitary error, possibly entangling the target qubits with other qubits. In particular, decoherence and relaxation noise is assumed to be negligible. This represents a situation where the circuit can be executed without loss of coherence, but still suffers from systematic noise due to small calibration errors or small amounts of crosstalk. Such errors can quickly add up in a long circuit and result in a poor output state, greatly harming the performance of VQE. In addition, coherent noise of this form can be harmful if the variational ansatz is highly specialized to explore a small subset of the full Hilbert space. In this case coherent noise can take the state outside of the relevant manifold, resulting in unphysical results.\nOur findings suggest that the application of both RC and ZNE to deep, structured\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 2\nVQE algorithms can provide a drastic synergetic effect in terms of the accuracy of the molecular energy extracted from VQE under these conditions. Interestingly, under all coherent noise models we consider, we find that the effects of RC and ZNE when applied separately are rather limited, but combining them reduces the energy error by up to two orders of magnitude.\nThe circuits we simulate are in a regime where the depth is challenging for NISQ devices, but much smaller than the depth required for non-variational methods such as quantum phase estimation (QPE) [30]. There are two motivations for studying this regime. First, deep VQE algorithms may become practical in a post NISQ era where the error rates are much smaller than in NISQ devices, but still too high for QPE. Second, QPE requires as input a good approximation to the ground state, and it has been recently argued that this requirement severely limits the usefulness of QPE for chemistry simulations [31]. Here we note one strategy that could circumvent the aforementioned argument: when successful, a quantum variational algorithm (such as VQE) could find a circuit that efficiently prepares a state with high overlap with the ground state, which can then be used as input to QPE.\nThe outline of the paper is as follows. In Section 2, we explain background theory of VQE and the error-mitigation method employed in this work, as well as our noise models and simulation methodology. In Section 3, we present and discuss our simulation results. In Section 4, we conclude and discuss future perspectives."
        },
        {
            "heading": "2 Variational quantum eigensolver simulation and noise models",
            "text": ""
        },
        {
            "heading": "2.1 Variational quantum eigensolver",
            "text": "VQE is a hybrid classical-quantum algorithm for simulating properties of a Hamiltonian H. In this work H represents the electronic structure Hamiltonian of some small molecule. VQE is based on using a classical optimizer to minimize the expected energy over some parameterized family of quantum circuits, where the cost function is evaluated within the optimization loop using a quantum computer. When successful, this algorithm finds a circuit that prepares an approximation to the ground state of the molecule, as well as an estimate of its ground state energy.\nIn this work we study a family of VQE experiments designed to compute the dependence of the ground state energy on the positions of the nuclei in the molecule, reproducing the socalled potential energy surface of the molecule (or a one-dimensional slice of it, commonly known as a disassociation curve). To embed H into qubits, we use the standard techniques of second quantization and the Jordan-Wigner transform. For a variational ansatz, we use the unitary coupled cluster ansatz with single- and double-excitations (UCC-SD) . The\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 3\nparameterized states have the form\n|\u03c8(\u03b8)\u27e9 = U(\u03b8)|\u03c8HF\u27e9 (1)\nwhere \u03b8 = \u03b81, . . . , \u03b8m are the variational parameters, and |\u03c8HF\u27e9 is a computational basis state encoding the Hartree-Fock approximation to the ground state. The circuit U(\u03b8) is a Trotterized version of the exponential eT (\u03b8)\u2212T (\u03b8)\u2020 where T (\u03b8) is the cluster operator with parameters \u03b8. For a given value \u03b8, the cost function is the expected energy, \u27e8\u03c8(\u03b8)|H|\u03c8(\u03b8)\u27e9, which can be computed efficiently on the quantum computer. See Appendix A.1 for more details."
        },
        {
            "heading": "2.2 Noise models",
            "text": "We choose a noise model in which entangling gates are noisy and single-qubit gates are perfect. The motivation is that we are mainly concerned with simulating residual calibration errors, and single-qubit gates can typically be calibrated to orders-of-magnitude higher fidelity than two-qubit gates. We choose an error rate of roughly 10\u22123. In comparison the circuits we simulate have up to 103 noisy two-qubit gates. In our work U(\u03b8) is compiled using a gateset consisting of CNOT gates and arbitrary single-qubit gates. We consider four kinds of coherent and time stationary noise models affecting the CNOT: (i) over-rotation by a small amount \u03f5 (that is U 7\u2192 UU \u03f5), (ii) small X-axis rotation on the control qubit prior to the CNOT gate (we call it XI rotation noise hereafter), (iii) small Z-axis rotation on the target qubit prior to the CNOT gate (we call it IZ rotation noise hereafter), and (iv) coherent crosstalk where a small unwanted ZZ interaction couples each of the two qubits involved in a CNOT gate and its nearest neighbours, where the qubits are assumed to be arranged in a 1D chain with periodic boundaries. Other sources of noise, such as relaxation processes and state-preparation and measurement (SPAM) errors are not considered in this work."
        },
        {
            "heading": "2.3 Simulation details",
            "text": "Computing the cost function for a given value of \u03b8\u20d7 can be done using one of two methods: 1) by direct computation of the average energy tr(\u03c1\u03b8H), where \u03c1\u03b8 is the output state of\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 4\nthe circuit, or 2) by computing an empirical average based on a finite number of simulated samples. In the latter case we expand the Hamiltonian as a sum of n-qubit Pauli operators\nH = M\u2211\nj=1 ajPj (2)\nand estimate each term tr(\u03c1\u03b8Pj) separately by simulating a measurement of the observable Pj using a finite number of shots. Note that the second method represents how VQE has to be implemented in practice, but makes the simulation much slower, since M can be large and shot noise can harm the performance of the classical optimizer. We present results using both methods, showing that the improvement from our error mitigation strategy persists even under the more realistic, but slower, second method. We remark that the measurement overhead is a major bottleneck for VQE algorithms, and in the present work we do not attempt to improve it in our simulations (see [6, 32, 33, 34] for various ways to reduce this overhead).\nWe perform and compare VQE simulations under various conditions: with no quantum error mitigation, with RC alone, with ZNE alone, and with RC and ZNE combined. The theoretical details of RC and ZNE are described in appendices A.2 and A.3. The overall VQE scheme with RC and ZNE is depicted in Figure 1. In this work we utilize the following python modules: True-Q [35] for quantum circuit simulation and compilation, SciPy [36] and BOBYQA [37] for classical parameter optimization, and OpenFermion [38] for qubit-mapping of electronic structure Hamiltonians.\nFor a given value of \u03b8\u20d7, computing the mitigated expected energy under randomized compiling is performed by the following steps (see Figure 2): (i) create noise-magnified version of the ansatz circuit by identity-insertion method (e.g., CNOT 7\u2192 CNOT3). (ii) apply randomized compiling to both circuits. (iii) calculate the expectation values for both circuits, and (iv) apply post-processing to obtain zero-noise estimates of the average energy.\nIn Step (ii), randomized compiling is applied in simulation either by replacing the circuit with Nrand randomized compilations (we set Nrand = 20 in our experiments, because we find this number to be sufficient for converting coherent errors to Pauli stochastic errors in our simulations [22]), or by twirling the noise on each noisy clock-cycle, which transforms it to an effective noise process described by a Pauli channel [21]. The latter method has the same effect as performing an exact average of 4nk circuits, where n is the number of qubits and k is the number of clock-cycles with two-qubit gates (we abuse terminology and refer to this as the infinite randomization limit), see Appendix A.3 and Ref. [21] for more details. In our simulations noise affects only two-qubit gates, which are non-parameterized in our circuit ansatz. Hence we can pre-compute the twirled noise operators outside of the VQE loop, which significantly improves the runtime of the simulation. We present results using both methods and show that the improvement due to our error mitigation strategy holds in both cases."
        },
        {
            "heading": "3 Results and discussion",
            "text": "Our results indicate significant gains in terms of accuracy by combining RC and ZNE in deep VQE algorithms. This is true even though applying each separately is much less effective. Figure 3 shows an example of the effect of error mitigation on simulating a molecular disassociation curve. In all of the numerical experiments we performed a similar behaviour is observed, which seems to be robust to changing various details in the implementation of VQE, such as using different classical optimizers, as well as details\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 5\nof our numerical simulations, such as simulating measurements by sampling vs. directly computing expectation values.\nFigure 4 shows the error on the simulated dissociation curve of the H2 molecule via noisy VQE experiments, with and without error mitigation. In this figure (and similar figures below) the energy error is defined as the simulated energy value minus the exact energy value obtained by the full configuration interaction (FCI) method [1], and the violin plots are with respect to 35 \u2013 60 VQE trials with random initial parameters, each trial requiring roughly 100 \u2212 400 evaluations of the objective function to reach convergence. Figure 5 shows similar results for the LiH molecule. In Figure 5 the improvement from combining RC & ZNE is quite significant when considering the minimum energy amongst a number of VQE trials with random initial parameters. We note that taking the minimum energy amongst a number of trials with random initial points is likely to be the best strategy in any real life application of VQE, since the starting point in parameter space will likely have a significant impact on the convergence of the algorithm. The results in Figures 4 and 5 clearly show that the energy error induced by coherent noise can be significantly mitigated by combining randomized compiling with zero-noise extrapolation. The magnitude of the error reduction depends on the noise model and strength. In our simulation, the energy error can be reduced by 1 \u2013 2 orders of magnitude.\nIn the simulations in Figures 4 and 5, the cost function is evaluated within the VQE loop by computing the expectation value of the energy exactly for each desired value of the variational parameters (see Section 2.1 for more details.) In real-life implementations of VQE one must estimate the expectation value of the Hamiltonian empirically. We provide results in the appendix (Figure 9) based on measurement by simulated sampling, and find that a similar improvement from our error mitigation strategy persists. Here we use the simplest measurement strategy where each Pauli term in the Hamiltonian is measured separately. As mentioned previously, we do not attempt to improve the performance of VQE by optimizing the measurement strategy in this work.\nWe also study the effect of this error mitigation strategy on the energy landscape; that is, the value of the expected energy as a function of the variational parameters. Figure 6\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 6\nshows two-dimensional slices of the energy landscape under over-rotation noise and their deviation from the ideal energy. The figure shows that we can drastically reduce the errors induced by coherent noise over the entire energy surface by combining RC and ZNE. Similar data demonstrating the improvement in the error-mitigated energy landscape with other noise models is included in Appendix C (Figures 10 and 11). Figure 12 in the same appendix shows that noise magnification by identity insertion not only globally flattens the energy landscape but also modifies its characteristic shape. Figure 13 shows the analogous situation under randomized compiling. Contrary to the previous case (Figure 12), with RC noise magnification does not significantly alter the characteristic shape of the landscape. This is a clear manifestation of the noise suppression effect of RC. Adding ZNE to the simulations unleashes the full benefit of our error mitigation strategy, as shown for three different error models in Figures 6, 10 and 11, which demonstrate a remarkable restoration of the energy landscape by combining RC and ZNE.\nOur main results show significant improvement in accuracy of the mitigated ground energy, as measured by the minimum optimal value amongst a number of VQE trials with random initial points. In terms of precision, we observe a notable effect where the\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 7\nspread of the optimal values (over random initial points, at any fixed nuclear separation) is significantly increased when using RC and ZNE, most apparently in the violin plots in Figure 5. This spread indicates the consistency with which the classical optimizer converges to the same solution given random starting points. Figure 14 shows that this spread strongly depends on the particular classical optimizer, and hence it is in part due to sensitivity of the optimizer to initial conditions. This sensitivity is likely due to a complex interplay between the particular classical optimization routine, the error mitigation method used, and the type and strength of the noise. Indeed, this sensitivity is greatly reduced in our simulation of the infinite-randomization, infinite-shot limit, where each noise source is replaced by its associated Pauli channel under twirling, and the expected energy is computed exactly, see Figure 15 in the appendix. In this latter figure the variance is almost entirely eliminated by combining ZNE & RC. This indicates that the performance of the classical optimizers in VQE can be greatly enhanced by carefully choosing hyperparameters in the error mitigation strategy, such as the number randomizations used in RC.\nTo eliminate the influence of the classical optimizer in the above discussion, we fix the variational parameters to some value and consider the energy error in the output state\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 8\nof the resulting circuit. In Figure 16 the variance of the estimated energy depends on the error rate and the number of randomizations, with a clear reduction in variance as the number of randomizations increases. We include similar results in Appendix C which demonstrate the same behaviour with other coherent noise models. Figures 17 and 18 show histograms of energy deviations from the ideal values for the H2 ansatz for some fixed parameter values. Figure 16(d-f), Figure 17(d-f), and Figure 18 (d-f), show that the precision of the energy is proportional to 1/ \u221a Nrand, where Nrand denotes the number of random circuits, confirming a theoretical result [21]. Finally, to provide some intuition for the significant synergy effect of RC and ZNE, we simulate expectation values of the 14 Pauli terms comprising the H2 Hamiltonian, and we vary the CNOT infidelity by repeating it an odd number of times, see Figures 19 to 21 in Appendix C. Without RC the resulting expectation values show strong nonlinear dependence on the number of CNOT repetitions. This is due to the nature of coherent noise, where errors can accumulate quadratically [21] and in a way that depends on the state. When we apply RC in each simulation the dependence of the resulting expectation values on the number of repetitions becomes almost linear, facilitating extrapolation to the zero-noise limit. Related ideas have recently been suggested [27] and demonstrated in experiment [24, 39]."
        },
        {
            "heading": "4 Conclusion and future perspective",
            "text": "We propose a quantum error mitigation technique for the VQE algorithm to reduce energy errors induced by coherent noise by using RC and ZNE. We demonstrate that, with this strategy, energy errors in VQE simulations induced by coherent noise are reduced by up to two orders of magnitude. Accordingly, our analysis of the energy landscape shows large improvements when RC and ZNE are combined. This can be explained by the noise-\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 9\ntwirling effect of RC, in which coherent noise is converted to stochastic noise, resulting in a more linearized dependence of expectation values with gate infidelities, enabling ZNE to successfully extrapolate to the zero-noise limit. This proposed error mitigation technique can be used for other quantum algorithms which involve calculating expectation values of observables.\nIn future research, more general quantum noise (including relaxation and measurement noise) will be applied to investigate the efficacy of this error mitigation strategy in a more practical setting. Also, the identity insertion method which we employed here is not suitable for experiments with current NISQ devices because the insertion increases the depth of the corresponding circuit by a factor of three or more. This problem may be solved by randomly choosing some entangling gates to magnify their noises instead of magnifying all the entangling gates [18]."
        },
        {
            "heading": "A Background theory",
            "text": "A.1 Variational quantum eigensolver and unitary coupled cluster ansatz The VQE algorithm is a quantum-classical hybrid algorithm. The quantum part is used to evaluate the cost function by measuring certain expectation values in candidate parameterized quantum states, and the classical part performs the optimization, updating the parameters and calling the quantum part as a subroutine. The goal of VQE experiments is to approximate the ground state energy of a Hamiltonian H. In this work H represents the electronic structure Hamiltonian of some molecule. More specifically, the nuclei in the molecule are represented by stationary, classical point charges (the Born-Oppenheimer approximation). Under this approximation we obtain a second quantized Hamiltonian of the form\nH = \u2211 p,q hpqapa \u2020 q + \u2211 p,q,r,s hpqrsapaqa \u2020 ra \u2020 s, (3)\nwhere ai and a \u2020 i denote particle-annihilation and -creation operators on the i-th spin orbital, the summation indices {p, q, r, s} run over a set of electronic spin-orbitals, and hpq and hpqrs are coefficients that can be obtained by standard chemistry calculations. The goal of the VQE experiments in this paper is to study the dependence of the ground state energy on the positions of the nuclei, and reproduce the so-called potential energy surface of the molecule (or a one-dimensional slice of it, commonly known as a disassociation curve).\nIn this paper, we employ the STO-3g basis set and the unitary coupled-cluster ansatz with single- and double-excitations (UCC-SD) [6]. UCC-SD is a structured ansatz which takes advantage of the details of the Hamiltonian and the physics describing the system, associating to each variational parameter a particle excitation from a reference state, such as the Hartree-Fock (HF) state, to capture additional electronic correlations not present in HF. In contrast to unstructured ansatz, such as the hardware-efficient ansatz [8], UCC-SD requires much fewer parameters, but requires additional circuit depth. This is preferable for our purpose since it avoids energy errors caused by optimization failure due to the number of parameters being too large \u2013 classical optimization with fewer parameters is likely to result in more exact outcomes. For this ansatz, we choose an initial quantum state which encodes the Hartree-Fock solution |\u03c8HF\u27e9, and apply a quantum circuit which approximates the state\n|\u03c8(\u03b8)\u27e9 = eT (\u03b8)\u2212T (\u03b8)\u2020 |\u03c8HF\u27e9 (4)\nby Trotterization, where\nT (\u03b8) = \u2211\ni\u2208Svirt \u2211 k\u2208Socc \u03b8i,ka \u2020 iak + \u2211 i,j\u2208Svirt \u2211 k,\u2113\u2208Socc \u03b8i,j,k,\u2113a \u2020 ia \u2020 jaka\u2113, (5)\nwhere a\u2020i denotes a particle-creation operator on the i-th spin-orbital, and ak denotes a particle-annihilation operator on the k-th spin-orbital. Here the sets Svirt and Socc denote the subsets of occupied and unoccupied spin-orbitals in some reference Slater determinant, which we take to be the Hartree-Fock state. The first term in eq. (5) denotes singleparticle excitation operators with amplitude \u03b8i,k, and the second term denotes two-particle excitation operators with amplitude \u03b8i,j,k,l. We regard \u03b8i,k and \u03b8i,j,k,l as the parameters for optimization. For example, when the target molecule is H2, there are two parameters for single-particle excitation (which we denote \u03b80, \u03b81), and one parameter for two-particle\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 14\nexcitation (which we denote \u03b82). Under the Jordan-Wigner transformation, a \u2020 i and ak is transformed to (1/2)Z0 \u00b7 \u00b7 \u00b7Zi\u22121(Xi \u2212 iYi) and (1/2)Z0 \u00b7 \u00b7 \u00b7Zk\u22121(Xk + iYk), respectively. We employ Trotter decomposition to implement this Hamiltonian evolution eT \u2212T \u2020 as a quantum operation circuit.\nA.2 Zero-noise extrapolation Here we provide an overview of ZNE [16, 17, 18]. Suppose the gate error rate is \u03f5, and the expectation value calculated with the gate error \u03f5 is E(\u03f5). We can magnify such gate error to r\u03f5 (where r > 1) by lengthening the duration of target operation or inserting operations equivalent to identities (U \u2020U) prior to the target operation (U). We suppose E(r\u03f5) can be polynomial of r\u03f5:\nE(r\u03f5) = E(0) + \u03bb1r\u03f5+ \u03bb2(r\u03f5)2 +O((r\u03f5)3) (6)\nWhen we observe E with two noise magnification coefficients r1, r2 (typically r1 = 1), we can do first-order correction of E:\nE\u2217(0) = r2/(r2 \u2212 r1)E(r1\u03f5) \u2212 r1/(r2 \u2212 r1)E(r2\u03f5) +O(\u03f52) (7)\nSuch extrapolation method is valid when \u03f5 is sufficiently small. The accuracy of E\u2217(0) naturally depends on that of E(r1\u03f5) and E(r2\u03f5), which technically depend on the number of shots. Also, large absolute values of r2/(r2 \u2212 r1) and r1/(r2 \u2212 r1) increase the accuracy of E\u2217(0).\nA.3 Randomized compiling As briefly described in Section 1, RC is a quantum error mitigation technique that utilizes Pauli twirling. To execute randomized compiling properly, we describe the overall quantum operation U as\nU\u03c1 = CnDnCn\u22121Dn\u22121Cn\u22122 \u00b7 \u00b7 \u00b7 C1D1C0\u03c1 (8)\nby employing Pauli transfer matrix representation, where \u03c1 is a 4N \u00d71 vector which denotes the initial quantum state (N : the number of qubits) and D1, \u00b7 \u00b7 \u00b7 ,Dn and C0, C1, ..., Cn are 4N \u00d7 4N matrices which denote the ideal quantum gate operations. We assume that D1, \u00b7 \u00b7 \u00b7 ,Dn causes more noise than C0, C1, \u00b7 \u00b7 \u00b7 , Cn when implemented. As a typical approach to satisfy this assumption, we categorize D1, \u00b7 \u00b7 \u00b7 ,Dn \u2208 D as the operations with entangling gates, and C0, C1, \u00b7 \u00b7 \u00b7 , Cn \u2208 C as the operations with single-qubit gates [21]. To execute RC, we make several equivalent circuits with Pauli twirling, where we change Ck to C\u2032k \u2208 C while Dk is unchanged. To do this, for each k \u2208 {1, \u00b7 \u00b7 \u00b7 , n}, we insert random Pauli operation Tk prior to Dk and compensation operation T \u2032k posterior to Dk so that Dk = TkDkT \u2032k . When we make a new quantum circuit equivalent to the original one with Pauli twirling, we can describe it as\nU\u03c1 = CnTnDnT \u2032nCn\u22121Tn\u22121Tn\u22121Dn\u22121T \u2032n\u22121Cn\u22122 \u00b7 \u00b7 \u00b7 C1T1D1T \u20321 C0\u03c1 = C\u2032nDnC\u2032n\u22121Dn\u22121C\u2032n\u22122 \u00b7 \u00b7 \u00b7 C\u20321D1C\u20320\u03c1, (9)\nwhere we denote C\u2032k = T \u2032k+1CkTk(k = 1, \u00b7 \u00b7 \u00b7 , n \u2212 1), C\u20320 = T \u20321 C0, and C\u2032n = CnTn. The requirement that C\u2032k \u2208 C for any k and Tk is satisfied if Dk is an operation composed of Clifford entangling gates.\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 15\nWhen we describe noisy version of the quantum circuit, it can be written as\nU\u0303\u03c1 = C\u0303nD\u0303nC\u0303n\u22121D\u0303n\u22121C\u0303n\u22122 \u00b7 \u00b7 \u00b7 C\u03031D\u03031C\u03030\u03c1 = CnNCnNDnDnCn\u22121NCn\u22121 \u00b7 \u00b7 \u00b7 C1NC1ND1D1C0NC0\u03c1 (10)\nwhere NCk(k = 0, \u00b7 \u00b7 \u00b7 , n) and NDk (k = 1, \u00b7 \u00b7 \u00b7 , n) denote the noise operators corresponding to Ck and Dk, and C\u0303k = CkNCk and D\u0303k = NDkDk. Here, we can set NCk = NC for any Ck \u2208 C with the assumption that the noise amplitude fluctuations among Ck \u2208 C are negligible compared to the noise amplitudes of ND1 , \u00b7 \u00b7 \u00b7 ,NDn .\nWe can similarly describe the noisy version of Pauli-twirled circuit (eq. (9)) as\nU\u0303PT\u03c1 = C\u2032nNCNDnDnC\u2032n\u22121NC \u00b7 \u00b7 \u00b7 C\u20321NCND1D1C\u20320NC\u03c1 = CnTnNCNDnDnT \u2032nCn\u22121Tn\u22121NC \u00b7 \u00b7 \u00b7 C1T1NCND1D1T \u20321 C0NC\u03c1. (11)\nBy approximating the resultant quantum states for all possible twirling operations T1, . . . , Tn \u2208 T , we obtain\n1 |T n| \u2211 T1,...,Tn\u2208T U\u0303PTT (\u03c1) = 1 |T n|  \u220f k=n,...,1 Ck  \u2211 Tk\u2208T TkNCNDkTk  Dk  C0NC\u03c1. (12)\nThis means that every noisy operator NCNDk is twirled by Tk so that the noise corresponding to Dk is converted to stochastic Pauli noise. Although eq. (12) means applying RC requires |T |n compiled circuits, we can obtain such effect with fewer compiled circuits [22, 23, 24] by sacrificing the precision of the resultant expectation values [23].\nIn this study, we compile the ansatz circuits so that all Dk are composed of CNOT gates for the following reasons: (i) CNOT is one of the Clifford gates, so if Tk is an operation with Pauli gates, T \u2032k is also one with Pauli gates. (ii) CNOT is Hermitian, so, for applying ZNE, we can magnify the gate noises by inserting two CNOT as an identity. We can also choose Clifford but non-Hermitian gates (such as iSWAP) as Dk. In this case, we need more than two gate insertions to magnify gate noises (for example, four iSWAPs are needed to insert as an identity).\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 16"
        },
        {
            "heading": "B Simulation results with more realistic noise models",
            "text": "In the main text, the simulation data with only coherent noises which are affected on entangling gates are shown. However, the realistic noise model can be including (i) singlequbit gate noise and (ii) incoherent noise. In this section, we examine how our errormitigation protocol works in the condition above.\nB.1 Simulations with noisy single-qubit gates While error rates on single-qubit gates are typically much smaller than that of entangling gates in most types of hardware, their overall contribution will not be negligible when the number of single-qubit gates becomes large. Furthermore, since randomized compiling will introduce additional single-qubit gates, it is important to investigate how our error mitigation strategy performs when the single-qubit gates are themselves noisy. In this section, we include simulation results that show the resilience of the proposed error mitigation method with noisy single-qubit gates subject to crosstalk. As shown in Figure 7, the error mitigation effect with our protocol is still significant when the error rate of single-qubit gates is at most 1/2 that of entangling gates. As the error rate of single-qubit gates gets larger, we find that the resulting energy error cannot be reduced with RC and ZNE.\nB.2 Simulations with incoherent noise In the main text, we show simulation results with coherent noise only. In this section we include simulations with incoherent noise, in the form of a generalized qubit relaxation process described by a Choi matrix\nC =  1 \u2212 p(1 \u2212 e\u2212t/T1) 0 0 e\u2212t/T2 0 (1 \u2212 p)e\u2212t/T1 0 0 0 0 pe\u2212t/T1 0\ne\u2212t/T2 0 0 1 \u2212 (1 \u2212 p)e\u2212t/T1  (13) with T1 = 10, T2 \u2208 [1.73, 5.00] and p = 0. In these simulations we choose gate times t = 6 \u00d7 10\u22124. Since RC works only on coherent noise, we expect less error-reduction effect by employing RC alone when the contribution of coherent noises gets smaller. To confirm this, we show the simulation results under the existence of both coherent (crosstalk) and incoherent (generalized relaxation) noise. As shown in Figure 8, when we employ only ZNE, the resulting errors are reduced as the contribution of coherent noise decreases. However, the results show that the error mitigation effect with both RC and ZNE exists even when the contribution of coherent noise is only 10% of the overall error rate.\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 17\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 18\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 19"
        },
        {
            "heading": "C Figures and simulation results",
            "text": "Accepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 20\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 21\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 22\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 23\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 24\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 25\nAccepted in Quantum 2023-10-04, click title to verify. Published under CC-BY 4.0. 26"
        }
    ],
    "title": "Synergetic quantum error mitigation by randomized compiling and zero-noise extrapolation for the variational quantum eigensolver",
    "year": 2023
}