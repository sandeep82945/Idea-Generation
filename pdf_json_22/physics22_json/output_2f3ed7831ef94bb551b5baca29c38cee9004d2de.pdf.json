{
    "abstractText": "Apopular intermediary in the theory of artificial satellites is obtained after the elimination of parallactic terms from the J2-problem Hamiltonian. The resulting quasi-Keplerian system is in turn converted into the Kepler problem by a torsion. When this reduction process is applied to unbounded orbits, the solution is made of Keplerian hyperbolae. For this last case, we show that the torsion-based solution provides an effective alternative to theKeplerian approximation customarily used in flyby computations. Also, we check that the extension of the torsion-based solution to higher orders of the oblateness coefficient yields the expected convergence of asymptotic solutions to the true orbit.",
    "authors": [
        {
            "affiliations": [],
            "name": "Martin Lara"
        },
        {
            "affiliations": [],
            "name": "Alessandro Masat"
        },
        {
            "affiliations": [],
            "name": "Camilla Colombo"
        }
    ],
    "id": "SP:feb8893f7ae12c9a041e43f7fd0249551379ccdb",
    "references": [
        {
            "authors": [
                "N.N. Bogoliubov",
                "Y.A. Mitropolski"
            ],
            "title": "Asymptotic methods in the theory of non-linear oscillations",
            "venue": "Gordon and Breach Science Publishers Inc, New York",
            "year": 1961
        },
        {
            "authors": [
                "D. Brouwer"
            ],
            "title": "Solution of the problem of artificial satellite theory without drag",
            "venue": "Astro. J. 64, 378\u2013397",
            "year": 1959
        },
        {
            "authors": [
                "S. Coffey",
                "K.T. Alfriend"
            ],
            "title": "An analytical orbit prediction program generator",
            "venue": "J. Guid. Control Dyn. 7(5), 575\u2013581",
            "year": 1984
        },
        {
            "authors": [
                "S.L. Coffey",
                "H.L. Neal",
                "A.M. Segerman",
                "J.J. Travisano"
            ],
            "title": "An analytic orbit propagation program for satellite catalog maintenance",
            "venue": "Alfriend, K.T., Ross, I.M., Misra, A.K., Peters, C.F. (eds.) AAS/AIAA astrodynamics conference 1995 advances in the astronautical sciences, pp. 1869\u20131892. American Astronautical Society, San Diego, CA",
            "year": 1996
        },
        {
            "authors": [
                "C. Colombo"
            ],
            "title": "Planetary orbital dynamics (PlanODyn) suite for long term propagation in perturbed environment",
            "venue": "In Proceedings of the 6th International Conference on Astrodynamics Tools and Techniques, ICATT, pp. 1\u20137. ESA,",
            "year": 2016
        },
        {
            "authors": [
                "Z. Dang",
                "J. Luo",
                "P. Shi",
                "H. Zhang"
            ],
            "title": "General characteristics of the motion on J2-perturbed equatorial orbits",
            "venue": "J. Guid. Control Dyn. 42(10), 2319\u20132324",
            "year": 2019
        },
        {
            "authors": [
                "C.E. Delaunay"
            ],
            "title": "La Th\u00e9orie du Mouvement de la Lune, Premier volume",
            "venue": "M\u00e9moires de l\u2019Academie des Sciences de l\u2019Institut Imp\u00e9rial de France, vol. 28. Mallet-Bachellier, Paris",
            "year": 1860
        },
        {
            "authors": [
                "A. Deprit"
            ],
            "title": "Canonical transformations depending on a small parameter",
            "venue": "Celest. Mech. 1(1), 12\u201330",
            "year": 1969
        },
        {
            "authors": [
                "A. Deprit"
            ],
            "title": "The elimination of the parallax in satellite theory",
            "venue": "Celest. Mech. 24(2), 111\u2013153",
            "year": 1981
        },
        {
            "authors": [
                "A. Deprit",
                "A. Rom"
            ],
            "title": "The main problem of artificial satellite theory for small and moderate eccentricities",
            "venue": "Celest. Mech. 2(2), 166\u2013206",
            "year": 1970
        },
        {
            "authors": [
                "E. Deprit",
                "A. Deprit"
            ],
            "title": "Poincar\u00e9\u2019s m\u00e9thode nouvelle by skew composition",
            "venue": "Celest. Mech. Dyn. Astron. 74(3), 175\u2013197",
            "year": 1999
        },
        {
            "authors": [
                "S. Di Nino",
                "A. Luongo"
            ],
            "title": "Nonlinear dynamics of a baseisolated beam under turbulent wind flow",
            "venue": "Nonlinear Dyn. 107(2), 1529\u20131544",
            "year": 2022
        },
        {
            "authors": [
                "A.J. Dragt",
                "J.M. Finn"
            ],
            "title": "Lie series and invariant functions for analytic symplectic maps",
            "venue": "J. Math. Phys. 17, 2215\u20132227",
            "year": 1976
        },
        {
            "authors": [
                "S. Ferrer",
                "M. Lara"
            ],
            "title": "Families of canonical transformations byHamilton\u2013Jacobi\u2013Poincar\u00e9 equation.Application to rotational and orbital motion",
            "venue": "J. Geom. Mech. 2(3),",
            "year": 2010
        },
        {
            "authors": [
                "L. Floria"
            ],
            "title": "A simple derivation of the hyperbolic Delaunay variables",
            "venue": "Astron. J. 110, 940\u2013942",
            "year": 1995
        },
        {
            "authors": [
                "P. Gurfil",
                "M. Lara"
            ],
            "title": "Satellite onboard orbit propagation using Deprit\u2019s radial intermediary",
            "venue": "Celest. Mech. Dyn. Astron. 120(2), 217\u2013232",
            "year": 2014
        },
        {
            "authors": [
                "D. Hautesserres",
                "M. Lara"
            ],
            "title": "Intermediary LEO propagation including higher order zonal harmonics",
            "venue": "Celest. Mech. Dyn. Astron. 127, 505\u2013526",
            "year": 2017
        },
        {
            "authors": [
                "L.M. Healy"
            ],
            "title": "The main problem in satellite theory revisited",
            "venue": "Celest. Mech. Dyn. Astron. 76(2), 79\u2013120",
            "year": 2000
        },
        {
            "authors": [
                "J. Henrard"
            ],
            "title": "Periodic orbits emanating from a resonant equilibrium",
            "venue": "Celest. Mech. 1, 437\u2013466",
            "year": 1970
        },
        {
            "authors": [
                "Hori",
                "G.-I."
            ],
            "title": "The motion of a hyperbolic artificial satellite around the oblate earth",
            "venue": "Astron. J. 66, 258\u2013263",
            "year": 1961
        },
        {
            "authors": [
                "Hori",
                "G.-I."
            ],
            "title": "Theory of general perturbation with unspecified canonical variables",
            "venue": "Publ. Astron. Soc. Jpn. 18(4), 287\u2013296",
            "year": 1966
        },
        {
            "authors": [
                "D.J. Jezewski"
            ],
            "title": "An analytic solution for the J2 perturbed equatorial orbit",
            "venue": "Celest. Mech. 30(4), 363\u2013371",
            "year": 1983
        },
        {
            "authors": [
                "A.A. Kamel"
            ],
            "title": "Perturbationmethod in the theory of nonlinear oscillations",
            "venue": "Celest. Mech. 3, 90\u2013106",
            "year": 1970
        },
        {
            "authors": [
                "Y. Kozai"
            ],
            "title": "Secular perturbations of asteroids with high inclination and eccentricity",
            "venue": "Astron. J. 67, 591\u2013598",
            "year": 1962
        },
        {
            "authors": [
                "M. Kruskal"
            ],
            "title": "Asymptotic theory of Hamiltonian and other systems with all solutions nearly periodic",
            "venue": "J. Math. Phys. 3(4), 806\u2013828",
            "year": 1962
        },
        {
            "authors": [
                "N. Krylov",
                "N.N. Bogoliubov"
            ],
            "title": "Introduction to nonlinear mechanics",
            "venue": "PrincetonUniversity Press, Princeton,NewYork",
            "year": 1947
        },
        {
            "authors": [
                "M. Lara"
            ],
            "title": "A Hopf variables view on the libration points dynamics",
            "venue": "Celest. Mech. Dyn. Astron. 129(3), 285\u2013306",
            "year": 2017
        },
        {
            "authors": [
                "M. Lara"
            ],
            "title": "Solution to the main problem of the artificial satellite by reverse normalization",
            "venue": "Nonlinear Dyn. 101(2), 1501\u2013 1524",
            "year": 2020
        },
        {
            "authors": [
                "M. Lara"
            ],
            "title": "Brouwer\u2019s satellite solution redux",
            "venue": "Celest. Mech. Dyn. Astron. 133, 47",
            "year": 2021
        },
        {
            "authors": [
                "M. Lara"
            ],
            "title": "Hamiltonian Perturbation Solutions for Spacecraft Orbit Prediction",
            "venue": "The method of Lie Transforms, volume 54 of De Gruyter Studies inMathematical Physics. De Gruyter, Berlin/Boston, 1 edition,",
            "year": 2021
        },
        {
            "authors": [
                "M. Lara",
                "J.F. Palaci\u00e1n"
            ],
            "title": "Hill problem analytical theory to the order four: application to the computation of frozen orbits around planetary satellites",
            "venue": "Math. Probl. Eng. 2009(753653), 1\u201318",
            "year": 2009
        },
        {
            "authors": [
                "M. Lara",
                "J.F. Palaci\u00e1n",
                "R.P. Russell"
            ],
            "title": "Mission design through averaging of perturbed Keplerian systems: the paradigm of an Enceladus orbiter",
            "venue": "Celest. Mech. Dyn. Astron. 108(1), 1\u201322",
            "year": 2010
        },
        {
            "authors": [
                "M. Lara",
                "I. P\u00e9rez",
                "R. L\u00f3pez"
            ],
            "title": "Higher order approximation to the Hill problem dynamics about the Libration points",
            "venue": "Commun.Nonlinear Sci. Numer. Simul. 59, 612\u2013628",
            "year": 2018
        },
        {
            "authors": [
                "M. Lara",
                "J.F. San-Juan",
                "D. Hautesserres"
            ],
            "title": "HEOSAT: a mean elements orbit propagator program for highly elliptical orbits",
            "venue": "CEAS Space J. 10, 3\u201323",
            "year": 2018
        },
        {
            "authors": [
                "M. Lara",
                "J.F. San-Juan",
                "L.M. L\u00f3pez-Ochoa"
            ],
            "title": "Delaunay variables approach to the elimination of the perigee in artificial satellite theory",
            "venue": "Celest. Mech. Dyn. Astron. 120(1), 39\u201356",
            "year": 2014
        },
        {
            "authors": [
                "M. Lara",
                "J.F. San-Juan",
                "L.M. L\u00f3pez-Ochoa"
            ],
            "title": "Proper averaging via parallax elimination",
            "venue": "Broschart, S.B., Turner, J.D., Howell, K.C., Hoots, F.R. (eds.) Astrodynamics 2013, volume 150 of advances in the astronautical sciences, pp. 315\u2013331. American Astronautical Society, Univelt, Inc, San Diego",
            "year": 2014
        },
        {
            "authors": [
                "M.L. Lidov"
            ],
            "title": "Evolution of artificial planetary satellites under the action of gravitational perturbations due to external bodies",
            "venue": "Iskusstv. Sput. Zemli 8, 5\u201345",
            "year": 1961
        },
        {
            "authors": [
                "V. Martinusi",
                "P. Gurfil"
            ],
            "title": "Analytical solutions for J2perturbed unbounded equatorial orbits",
            "venue": "Celest. Mech. Dyn. Astron. 115(1), 35\u201357",
            "year": 2013
        },
        {
            "authors": [
                "W.D. McClain"
            ],
            "title": "A Recursively Formulated First-Order Semianalytic Artificial Satellite Theory Based on the Generalized Method of Averaging, Volume 1: The Generalized Method ofAveragingApplied to theArtificial Satellite Problem",
            "venue": "NASA CR-156782. NASA, Greenbelt, Maryland, 2nd edition,",
            "year": 1977
        },
        {
            "authors": [
                "G. M\u00e9tris",
                "P. Exertier"
            ],
            "title": "Semi-analytical theory of the mean orbital motion",
            "venue": "Astron. Astrophys. 294, 278\u2013286",
            "year": 1995
        },
        {
            "authors": [
                "D.P. Stern"
            ],
            "title": "Kruskal\u2019s perturbation method",
            "venue": "J. Math. Phys. 11(9), 2771\u20132775",
            "year": 1970
        },
        {
            "authors": [
                "H. von Zeipel"
            ],
            "title": "Research on the Motion of Minor Planets",
            "venue": "NASATTF-9445, 1965.",
            "year": 1918
        },
        {
            "authors": [
                "Zhang",
                "R.-F.",
                "S. Bilige"
            ],
            "title": "Bilinear neural network method to obtain the exact analytical solutions of nonlinear partial differential equations and its application to p-gBKP equation",
            "venue": "Nonlinear Dyn. 95(4), 3041\u20133048",
            "year": 2019
        },
        {
            "authors": [
                "Zhang",
                "R.-F",
                "Li",
                "M.-C",
                "Gan",
                "J.-Y",
                "Q. Li",
                "Lan",
                "Z.-Z"
            ],
            "title": "Novel trial functions and roguewaves of generalized breaking soliton equation via bilinear neural networkmethod.ChaosSolitons",
            "venue": "Fractals 154,",
            "year": 2022
        }
    ],
    "sections": [
        {
            "text": "Keywords Hamiltonian mechanics \u00b7 Canonical perturbation theory \u00b7 Perturbed Keplerian motion \u00b7 Torsion \u00b7 Unbounded orbits \u00b7 Flyby\nM. Lara (B) Scientific Computation and Technical Innovation Center, University of La Rioja, 26006 Logro\u00f1o, Spain e-mail: mlara0@gmail.com\nA. Masat \u00b7 C. Colombo Department of Aerospace Science and Technology, Politecnico di Milano, 20156 Milan, Italy e-mail: alessandro.masat@polimi.it\nC. Colombo e-mail: camilla.colombo@polimi.it"
        },
        {
            "heading": "1 Introduction",
            "text": "The adoption of techniques for the removal of highfrequency modes of the motion has been common in the study of nonlinear dynamical problems, since the seminal investigations of planetary motions of the 18th and 19th centuries. With these techniques, the solution is decomposed into secular, long-, and short-period perturbations, facilitating the description of the long-term dynamics. Other than ad-hoc procedures for approaching particular problems, Poincar\u00e9\u2019s theory of asymptotic expansions built the foundations for the use of perturbation approaches [41] to solve this now decomposed problem. Nevertheless, Poincar\u00e9\u2019s method gives the solution in implicit form. This fact notably complicates the computation of high-order terms [11], which are however needed in different applications and, in particular, in the theory of artificial satellites. The generalized method of averaging introduced the concept of near-identity transformation [1,26] and helped in the automatization of the computation of higher orders, yet effectively reverting the solution series remained a problem to be solved [25,42].\nThe theory of Lie transforms provided a possible solution to the inversion problem, yielding explicit solutions [21], and became the reference approach, to this day, because of the efficient and versatile algorithms that it introduces [8,13,19]. For the application to the theory of artificial satellites, first-order orbital perturbation solutions suffice in some contexts [5,39], yet considering at least the second-order termofEarth\u2019s\n9378 M. Lara et al.\noblateness becomesmandatory in long-termorbit propagation suites [3,4,34,40]. Still, some missions may require the analytical computation of higher orders of orbits of different kinds [27,31,33].\nThe most successful application of perturbation approaches remains the case of conditionally periodic motion, i.e. the common orbits of artificial satellites. On the other hand, the dynamics of interplanetary orbits often features a multi-body environment and, locally, may also be dominantly hyperbolic. These cases normally foresee numerical approaches or simple analytical solutions based on the Keplerian dynamics. However, more accurate analytical solutions would provide clear benefits to the design and planning of close flybys.\nThe hyperbolic regime of an artificial satellite of an oblate body was solved in closed form by Hori [20], who showed that the perturbation approach may be useful without restriction to the typical case of quasi-periodic motion.1 However, differently from the classical elliptical regime, the perturbed hyperbolic motion features strict boundary conditions that must be imposed. More precisely, the effect of the oblateness perturbation vanishes when the artificial satellite approaches infinity in its hyperbolic-type motion. Consequently, the transformation between mean and osculating variables that encapsulates the perturbation solution must become the identity, when evaluated at infinity.\nIn Hori\u2019s first-order approach, the J2-problem Hamiltonian is directly reduced to the Kepler Hamiltonian in (mean) hyperbolic Delaunay variables. Consequently, the solution of the mean-to-osculating transformation that yields the complete Hamiltonian reduction depends on non-periodic terms of the true anomaly. Nonetheless, the explicit appearance of the true anomaly in Hori\u2019s solution is not of concern, since its value is bounded by the asymptotes of a Keplerian hyperbola. Therefore, these non-periodic terms do not play any secular role. After the application of these boundary conditions to Hori\u2019s transformation, these terms appear always like coefficients involving the difference between the instantaneous true anomaly and the constant true anomaly of the asymptote of the Keplerian hyperbola. Despite non-periodic, this type of coefficients resembles the equation of the center, given\n1 As in the case of boundedmotion [22], the invariantmanifold of equatorial orbits of themain problem is integrable for unbounded motion as well [38]; see Ref. [6] for a general discussion.\nby the difference between the true and mean anomalies, which comprises essential short-period terms of the elliptic motion. But the resemblance goes beyond a formal likeness, and we find that these terms can be handled advantageouslywith known techniques, to efficiently deal with the equation of the center.\nIn particular, the equation of the center does not play any role in the elimination of the parallax simplification, which, conversely, depends only on trigonometric functions of the true anomaly, cf. \u00a76.2.1 of Ref. [30]. This last feature is not exclusively the case of bounded perturbed Keplerian motion, but also applies to unbounded motion. This becomes evident using Deprit\u2019s original formulation of the elimination of the parallax in polar variables [9]. Furthermore, Deprit\u2019s radial intermediary,which is obtained after the elimination of the parallax up to first-order effects of the oblateness coefficient, provides an integrable solution of the J2-problem, also called themain problem in the theory of artificial satellites [2], and is valid for both bounded and unbounded orbits. Nevertheless, the nature of the solution is different in the two regimes. Deprit\u2019s reduction of the main problem to a quasi-Keplerian system must be amended in the second case, in order to consider the boundary conditions that characterize the hyperbolic-like motion.\nWe compute the additional terms that are needed in the elimination of the parallax, for the transformation of the hyperbolic regime of the main problem into a quasi-Keplerian system, which, in turn, is converted into a pure Keplerian system by the standard torsion transformation [9]. The new transformation provides simpler equations than the Hori\u2019s case, when mapping the mean to the osculating hyperbolic Delaunay variables. Still, the new transformation shares analogous deficiencies to those of Hori\u2019s solution. Namely, it fails in the limit case of parabolic orbits, and the accuracy of the perturbation solution deteriorates for values of the eccentricity close to 1. In this regard, it is worth mentioning that existing perturbation solutions of bounded motion suffer analogous limitations too.\nMoreover, we show that the reduction to a quasiKeplerian hyperbola is easily extended to higher orders, despite the nowunavoidable appearance of nonperiodic functions of the true anomaly in the transformation. While these higher-order terms may not have relevant effects in practice (for flyby design or gravity assist maneuvers), they dramatically reduce the errors of the perturbation solution nearby the pericenter and\nA torsion-based solution to the hyperbolic regime of the J2-problem 9379\nhelp showing how the perturbation approach follows the expected convergence beyond its common application to the case of quasi-periodic motion. Needless to say, analogous improvements are expected if Hori\u2019s perturbation solution was eventually extended beyond the first order of the oblateness coefficient.\nDue to the hyperbolic character of the unbounded perturbed Keplerian motion, one might expect high sensitivity of the main problem dynamics with respect to initial conditions. However, for common values of the J2 coefficient of solar system bodies, the perturbation solution succeeds in capturing the dynamics and can even predict the qualitative features of the branches of the classical Newtonian rosetta when the energy becomes positive.2 Indeed, high-order terms of the perturbation solution are required in these extreme cases. Certainly, while the perturbation approach is useful in dealing with an ample diversity of nonlinear problems (see Ref. [12], for instance), it is not the only possibility in dealing with differential equations of the kind approached in this paper. Trying alternative methods in the literature specially adapted for dealing formally with nonlinearities of partial differential equations, as, for instance [44\u201346], may motivate future efforts"
        },
        {
            "heading": "2 Deprit\u2019s radial intermediary",
            "text": "The main problem of the artificial satellite admits Hamiltonian formulation. When using polar canonical variables, it is written in the form\nM = 1 2\n( R2 + \u0398 2\nr2\n) \u2212 \u03bc\nr\n\u22121 4 J2 \u03bc r\n\u03b12 r2\n( 2 \u2212 3 sin2 I + 3 sin2 I cos 2\u03b8 ) ,\n(1)\nwhere the physical parameters \u03bc, \u03b1, and J2 characterize the gravitational field of the attracting body and denote the gravitational parameter, equatorial radius, and oblateness coefficient, respectively. The polar canonical coordinates (r, \u03b8) stand for the radius and the polar angle, and their conjugate momenta (R,\u0398) for the radial velocity and the specific angular momentum; I = arccos(N/\u0398) is the inclination of the instantaneous orbital plane, and the canonical pair (\u03bd, N ) represents the right ascension of the ascending node and\n2 In the case of zero energy, these branches are sometimes called \u201cfish\u201d orbits [38]\nthe third component of the angular momentum vector per mass unit. Because \u03bd does not appear in the Hamiltonian (1)M,we immediately infer that N is an integral of the main problem dynamics.\nUp to first-order effects of J2,M (1) can be reduced to the integrable quasi-Keplerian Hamiltonian in new prime variables\nM = 1 2\n( R\u20322 + \u0398 \u20322\nr \u20322\n) \u2212 \u03bc\nr \u2032\n\u22121 2\n\u0398 \u20322\nr \u20322 1 2 J2\n\u03b12 (\u0398 \u20322/\u03bc)2 [ 2 \u2212 3 sin2 I (\u0398 \u2032, N ) ] ,\n(2)\nwhich is known as Deprit\u2019s radial intermediary [9]. In the case of bounded motion, this intermediary has been proposed for different applications [3,16,17]. The reduction of the main problem to Deprit\u2019s radial intermediary is achieved by an infinitesimal contact transformation (r, \u03b8, \u03bd, R,\u0398, N , J2) \u2192 (r \u2032, \u03b8 \u2032, \u03bd\u2032, R\u2032, \u0398 \u2032, N ) with generating function\nU1 = \u2212\u0398 1 8\n\u03b12 p2\n[ (4\u03ba + 3) s2 sin 2\u03b8\n+(4 \u2212 6s2 \u2212 2s2 cos 2\u03b8)\u03c3 ]\n+ C0, (3) Here, s abbreviates the sine of the inclination, p = \u03982/\u03bc is the parameter of the conic, and the nondimensional functions\n\u03c3 = pR \u0398 , \u03ba = p r \u2212 1, (4)\nrepresent the projections of the eccentricity vector in the orbital frame. Explicitly, \u03c3 = e sin f and \u03ba = e cos f , with e and f denoting eccentricity and true anomaly, respectively. Then, from the last of the equalities in Eq. (4), we readily obtain limr\u2192\u221e cos f = \u22121/e.\nOn one hand, the differences between Eq. (3) and the equivalent term in Ref. [9] are a consequence of a distinct arrangement of the involved functions, and, on the other, of the addition of the \u201cintegration constant\u201d C0. The latter must not explicitly depend on \u03b8 , when it is formulated in the specific algebra of the functions\nC = (\u03ba cos \u03b8 + \u03c3 sin \u03b8)\u0398/p, S = (\u03ba sin \u03b8 \u2212 \u03c3 cos \u03b8)\u0398/p, (5)\nused in Ref. [9]. However, their use may hide the real nature of this integration constant, which is nothing\n9380 M. Lara et al.\nbut being free from short-period effects [36]. For this reason, and also for simplicity, eliminating the parallax in Delaunay variables is nowadays encouraged, rather than in the set of polar variables [35].\nDelaunay variables are denoted with ( , g, h, L , G, H), and represent the mean anomaly, the argument of the periapsis, the longitude of the ascendingnode, the so-calledDelaunay action, the specific angularmomentum, and the third component of the angularmomentum vector per mass unit, respectively. When the generating function U1 in Eq. (3) is reformulated in Delaunay variables, one must distinguish between bounded and unbounded motion. The classical set of elliptic Delaunay variables is used [7,10,14] in the former, whereas hyperbolic Delaunay variables are used for the latter instead [15,20]. Nonetheless, in both cases Eq. (3) becomes\nU1 = \u2212G 1 8\n\u03b12 p2\n{ s2[3e sin( f + 2g) + 3 sin(2 f + 2g)\n+e sin(3 f + 2g)] \u2212 (6s2 \u2212 4)e sin f }\n+C0(g, L ,G, H), (6) Still, the meaning of the symbols is slightly different, i.e., despite p = G2/\u03bc and I = arccos H/G have the same meaning in both regimes of motion, the eccentricity is e = (1 \u2212 \u03b72)1/2 < 1, with \u03b7 = G/L , for bounded motion, whereas e = (1 + \u03b72)1/2 > 1 and \u03b7 = \u2212G/L in the hyperbolic case. The true anomaly f is an implicit function of the mean anomaly and the eccentricity, whose computation requires the preliminary solution of Kepler\u2019s equation. For unbounded motion, Kepler equation takes the form\n= e sinh u \u2212 u, (7)\nwhere the hyperbolic anomaly u is related to the true anomaly by\n\u221a e + 1 tanh\n( 1\n2 u\n) = \u221ae \u2212 1 tan ( 1\n2 f\n) . (8)"
        },
        {
            "heading": "3 Polar variables mapping to the quasi-Keplerian system",
            "text": "In his approach, Hori chose the new Hamiltonian to simply be the Keplerian part of the perturbation problem. That is, the transformed Hamiltonian in the prime hyperbolic Delaunay variables reads M\u2032 = +\u03bc/(2a),\nwhere a = L \u20322/\u03bc is the semi-major axis of the osculating hyperbola. Because of this choice, nontrigonometric functions of the true anomaly appear in the generating function, which Hori solved up to an integration constant, as we did in Eq. (6). Differently from the elliptical case, the latter is in no way arbitrary, and Hori determined it by imposing the required boundary conditions at infinity to his transformation of the hyperbolic Delaunay variables.3\nHori had not yet invented his perturbation method based on Lie series [21] and relied on von Zeipel\u2019s algorithm for computing his first-order solution [43]. We resort to the method of Lie transforms [8] in following derivations, whose basic equations are summarized in Appendix A for the convenience of interested readers. Moreover, in contrast with Hori\u2019s choice of the Keplerian, we are satisfied with finding the transformation that yields Deprit\u2019s radial intermediary, in this way simplifying the computation of the mapping.\nFinally, the quasi-Keplerian system (2) is transformed into a pure Keplerian system by a torsion transformation [9]. Since the torsion is performed in polar variables, we find advantageous to derive the transformation equations of the polar variables, rather than the hyperbolic Delaunay ones, directly from Eq. (6). That is, to the first order\n\u03be = \u03be \u2032 + J2\u03be0,1|\u03be=\u03be \u2032 (9)\nwhere \u03be \u2261 (r, \u03b8, \u03bd, R,\u0398, N )\u03c4 , \u03c4 means transposition, \u03be0,1 \u2261 {\u03be,U1}, and the curly braces denote the Poisson bracket operator. Still, since the boundary conditions are naturally formulated in terms of the true anomaly, we find it convenient to write the transformation in terms of the hyperbolic Delaunay variables. Because of this, the partial derivatives of the polar variables with respect to the hyperbolic Delaunay ones are needed. They are listed in Table 1. While mostly analogous to the case of elliptic Delaunay variables, sign changes appear in the partial derivatives with respect to the hyperbolic Delaunay action, cf. Table 5.1 of Ref. [30].\nWe readily find that the correction to the radial velocity automatically fulfills the boundary condition\n3 Note a typo in Hori\u2019s final transformation equation for the longitude of the node,where the exponent ofG \u2032 in thefirst coefficient must be 4 instead of 3, as readily shown by checking dimensions.\nA torsion-based solution to the hyperbolic regime of the J2-problem 9381\n{R,U1}|\u221e \u2261 0. Next, we compute\n{\u0398,U1}|\u221e = G 1 4\n\u03b12 p2 s2 e2\n[ 2\u03b73 sin 2g \u2212 (3\u03b72 + 1) cos 2g ]\n\u2212\u2202C0 \u2202g ,\nfrom which C0 is solved to make the right hand of the equation to vanish. We obtain\nC0 = \u2212G 1 8\n\u03b12 p2 s2 e2\n[ 2\u03b73 cos 2g + (3e2 \u2212 2) sin 2g ]\n+C1(L ,G, H), This is the same as the function Z computed by Hori except for a sign due to the different convention in the Hamiltonian formulation used by Hori. It follows the computation of\n{\u03bd,U1}|\u221e = 3 2 c \u03b12 p2 \u03b7 + \u2202C1 \u2202H , where c = H/G. The constant C1 is then solved after imposing the vanishing of the right side. We obtain\nC1 = \u2212G 3 4\n\u03b12 p2 \u03b7(1 \u2212 s2) + C2(L ,G).\nAnalogously,\n{\u03b8,U1}|\u221e = 1 2 \u03b7\n\u03b12 p2 + \u2202C2 \u2202G ,\nfrom which, recalling that \u03b7 = \u2212G/L and p = G2/\u03bc, we obtain\nC2 = G 1 4\n\u03b12 p2 \u03b7 + C3(L).\nFinally, we check that the choice C3 = 0 fulfills the last condition {r,U1}|\u221e = 0. In summary,\nC0 = G 1 4\n\u03b12 p2\n{ (3s2 \u2212 2)\u03b7\n\u2212 s 2\ne2\n[ \u03b73 cos 2g + 1\n2 (3e2 \u2212 2) sin 2g\n]} , (10)\nthus making Eq. (6) fully determined.\nIt is worth noting that Eq. (10) can be rewritten in polar variables using the alternative form\nC0 = \u0398 1 4\n\u03b12 p2\n{ (3s2 \u2212 2)\u03b7\n\u2212 p 2s2\ne4\u03982\n[ \u03b73 ( C2 \u2212 S2 ) + ( 3e2 \u2212 2 ) CS ] } ,\nwith e = (p/\u0398)\u221aC2 + S2,whereasC \u2261 C(r, \u03b8, R,\u0398) and S \u2261 S(r, \u03b8, R,\u0398) are given in Eq. (5). In this way, we show that C0 is free from the explicit appearance of \u03b8 , as it must be when using Deprit\u2019s algebra based on these functions [9].\nOnce the generating function has been fully determined, we compute the corrections\nr0,1 = p 14 \u03b12 p2\n{ (3s2 \u2212 2) ( 1 + e\n\u03b7 sin f\n) + s 2\n2e3 [ (e2 \u2212 4)\n\u00d7\u03b7 sin( f \u2212 2g) \u2212 3e2\u03b7 sin( f + 2g) + (3e2 \u2212 4) \u00d7 cos( f \u2212 2g) + 3e2 cos( f + 2g) +2e3 cos(2 f + 2g)]} (11)\n\u03b80,1 = 116 \u03b12 p2 ( 1 \u03b7 [ 12(5s2 \u2212 4) \u2212 6(7s2 \u2212 6)e2 + 8e\n\u00d7(3s2 \u2212 2) cos f + 2e2(3s2 \u2212 2) cos 2 f ] + \u03b7 e3 { (e2 \u2212 4)es2 cos(2 f \u2212 2g) + 4(e2 \u2212 4)s2\n\u00d7 cos( f \u2212 2g) + 2e[e2(7s2 \u2212 4) \u2212 4(4s2 \u2212 1)] \u00d7 cos 2g \u2212 12e2s2 cos( f + 2g) \u2212 3e3s2 \u00d7 cos(2 f + 2g)} + 1 e3 { (4 \u2212 3e2)es2 \u00d7 sin(2 f \u2212 2g) \u2212 4(3e2 \u2212 4)s2 sin( f \u2212 2g) + 2e \u00d7 [ 3e2(5s2 \u2212 2) \u2212 4(4s2 \u2212 1) ] sin 2g \u2212 8e4(6s2 \u22125) sin f + 4e2 [ e2(5s2 \u2212 3) \u2212 3s2 ] sin( f + 2g)\n+e3(11s2 \u2212 12) sin(2 f + 2g) + 4e4(s2 \u2212 1) \u00d7 sin(3 f + 2g)}) (12)\n\u03bd0,1 = c 14 \u03b12 p2 { 1 e2 [ (3e2 \u2212 2) sin 2g + 2\u03b73 cos 2g ] \u2212 6\u03b7\n\u22126e sin f + 3e sin( f + 2g) + 3 sin(2 f + 2g) +e sin(3 f + 2g) } (13)\n9382 M. Lara et al.\nR0,1 = Gp 1 32\n\u03b12 p2 { e \u03b7 (3s2 \u2212 2)[2e2 cos 3 f + 8e cos 2 f\n+(6e2 + 8) cos f + 8e] + \u03b7 s2 e3 [ (e2 \u2212 4)e2 \u00d7 cos(3 f \u2212 2g) + 4(e2 \u2212 4)e cos(2 f \u2212 2g) \u2212 (e4 +4e2 + 16) cos( f \u2212 2g) \u2212 8(e2 + 2)e cos 2g \u2212(5e2 + 16)e2 cos( f + 2g) \u221212e3 cos(2 f + 2g) \u2212 3e4 cos(3 f + 2g)]\n\u2212 s 2\ne3\n[ (3e2 \u2212 4)e2 sin(3 f \u2212 2g)\n+4(3e2 \u2212 4)e sin(2 f \u2212 2g) +(3e4 + 4e2 \u2212 16) sin( f \u2212 2g) +4(e4 + 4)e sin 2g + (19e2 + 16) \u00d7e2 sin( f + 2g) +4(2e2 + 7)e3 sin(2 f + 2g) +19e4 sin(3 f + 2g) + 4e5 sin(4 f + 2g) ] } (14)\n\u03980,1 = \u0398 14 \u03b12 p2 s2 { 1 e2 [ (3e2 \u2212 2) cos 2g \u2212 2\u03b73 sin 2g ]\n+3e cos( f + 2g) + 3 cos(2 f + 2g) +e cos(3 f + 2g) } . (15)\nThe appearance of \u03b7 in denominators of r0,1, \u03b80,1 and R0,1 deteriorates the accuracy of these corrections for orbits close to parabolic. Note that Eqs. (11)\u2013(15) depend on the true anomaly only through trigonometric functions, opposite to Hori\u2019s corrections [20]. On the other hand, the explicit appearance of f in Hori\u2019s solution is not criticizable, as far as the possible values of the true anomaly are bounded by the values taken by the asymptotes of the Keplerian hyperbola.\nWe complete the analytical solution by applying a torsion to the quasi-Keplerian Hamiltonian (2). Disregarding the prime notation without risk of confusion, Eq. (2) is rearranged like\nM = 1 2\n( R2 + \u0398\u0303 2\nr2\n) \u2212 \u03bc\nr , (16)\nwhere \u0398\u03032 = \u03982 [ 1 \u2212 1\n2 J2\n\u03b12 p2 (3c2 \u2212 1)\n] (17)\nis only function of \u0398 and the parameters of the simplified problem, i.e. the integral N and the physical parameters defining the gravitational field. The objective of the torsion is to find a canonical transformation (\u03b8, \u03bd,\u0398, N ) \u2192 (\u03b8\u2217, \u03bd\u2217,\u0398\u2217, N\u2217) such that \u0398\u0303 = \u0398\u2217\nin the new variables. That is, Eq. (16) turns into the Kepler problem Hamiltonian in the asterisk variables.\nThere is nodistinctionbetweenboundedor unbounded motion when working with polar variables; thus, the torsion transformation coincides with the elliptic case, originally described in \u00a79 of [9]. Rather, we follow the notation proposed in [17] and denote\u03a6 = \u03a6(\u0398, N ) \u2261 \u0398\u0303/\u0398 , = (\u0398) \u2261 \u2212 12 J2(\u03b1/p)2 < 0, and define the torsion by the sequence: \u0398\u2217 = \u0398\u03a6, (18)\n\u03b8\u2217 = \u03b8\u03a6 ( \u03a62 \u2212 2 \u2202\u03a6 2\n\u2202 \u2212 1 2 c \u2202\u03a62 \u2202c\n)\u22121 , (19)\n\u03bd\u2217 = \u03bd \u2212 1 2\n\u03b8\u2217\n\u03a6\n\u2202\u03a62\n\u2202c , (20)\nNote that not only N remains unaltered, but r and R as well. The inverse transformation requires first to solve \u0398 = \u0398(\u0398\u2217, N ) from the implicit function (18), which is then replaced in Eqs. (19) and (20) to be trivially solved in \u03b8 and \u03bd. Alternatively to the numerical solution by root-finding procedures, Eq. (18) can be inverted analytically in the form of a power series in . If we limit to the first order of J2 of the perturbation solution computed hitherto, we obtain \u0398 = \u0398\u2217 [ 1 \u2212 1\n2 (3c2 \u2212 1)\n] , (21)\nwhere, now, c = N/\u0398\u2217, and p = \u0398\u22172/\u03bc must be replaced in the definition of .\nIf written in asterisk variables, Eq. (16) becomes a Kepler Hamiltonian, that is next completely reduced by the exact transformation from polar to hyperbolic Delaunay variables. Thus, M = +\u03bc2/(2L2), from which = 0 + nt g = g0 h = h0 L = L0 G = G0 H = H0 with n = \u2212\u03bc2/L3.\nNote that the Keplerian orbit obtained with the torsion may have no physical sense, showing complex values of the inclination. This fact is clearly observed in the limit case obtained when making \u0398 = N in Eq. (21). Namely, N \u0398\u2217 \u2261 c = 1 \u2212 (3c2 \u2212 1) ,\nA torsion-based solution to the hyperbolic regime of the J2-problem 9383\nthis is a quadratic equation in c that may have real solutions only in the interval \u2212 12 + 1\u221a6 \u2264 < 0, in which c > 1 always.Regardless themeaning that cmay have in Eq. (21) in these particular cases, the torsion transformation remains valid."
        },
        {
            "heading": "4 Higher-order extensions",
            "text": "A second-order solution of the main problem based on a quasi-Keplerian Hamiltonian would be harmed by the appearance of secular terms in the transformation equations, in the bounded orbit case. However, this kind of terms are not of concern in the case of unbounded motion, where their variation is limited by the asymptotes of the hyperbola. Therefore, we can safely extend the first-order solution to higher orders following exactly the same approach. In particular, we first compute themapping that yields a quasi-Keplerian Hamiltonian while accepting the boundary conditions at infinity, and we then apply a torsion to obtain the final Keplerian.\nThus, from the known terms obtained at the second order of the elimination of the parallax, we select the terms that are free from the true anomaly, but also from the argument of the periapsis and the eccentricity. The latter, we recall, is a function of the radius and radial velocity, in addition to the specific angular momentum. We thus obtain\nM0,2 = \u2212\u0398 2 r2 \u03b14 p4 1 16 (21s4 \u2212 42s2 + 20), (22)\nThe simple consideration of this additional term in the reduction of the quasi-Keplerian Hamiltonian M = M0,0 + J2M0,1 + 12 J 22M0,2 yields additional refinements in the computation of the final Keplerian mean motion, as well as in the solution of the torsion transformation given by Eqs. (18)\u2013(20). Here, now \u03a6 = [ 1 \u2212 (3c2 \u2212 1) \u2212 1\n4 2(21c4 \u2212 1)\n]1/2 . (23)\nIn addition, the analytical inversion of Eq. (18) provided by Eq. (21) must be replaced by the second-order solution of J2, given by \u0398 = \u0398\u2217 [ 1 \u2212\n2 (3c2 \u2212 1) \u2212 3\n2\n4 (2c2 \u2212 1)(5c2 \u2212 1)\n] ,\n(24)\nwhere c, and p are now functions of the asterisk variables.\nMajor improvements are expected ifwe complement the analytical solution with the second-order corrections of the elimination of the parallax. That is, Eq. (9) is replaced by\n\u03be = \u03be \u2032 + J2\u03be0,1|\u03be=\u03be \u2032 + 12 J 2 2 \u03be0,2|\u03be=\u03be \u2032, (25)\nwhere \u03be0,2 \u2261 {\u03be0,1,U1} + {\u03be,U2}. To do that, we need to compute the generating function term U2 of the Lie transformation that yields M0,2. This is obtained in the usual way, up to an arbitrary constant, say Q0 \u2261 Q0(g, h, L ,G, H).\nThe new corrections need to match the boundary condition at infinity as well. Analogously to the first order, we readily find that R0,2|\u221e \u2261 0, and hence that the boundary conditions are automatically fulfilled by the corrections to the radial velocity. On the contrary, the equality \u03980,2|\u221e = 0 involves the partial derivative \u2202Q0/\u2202g, which we solve by indefinite integration to obtain\nQ0 = G \u03b1 4 p4 1 256e2\n{ \u2212 2s2[3e4(17s2 \u2212 18)\n+8e2(75s2 \u2212 68) + 8(s2 + 6) +96\u03b73(5s2 \u2212 4)(arctan \u03b7 + \u03c0)] sin 2g \u22123(3e4 + 6e2 \u2212 16)s4 sin 4g +4s 2\n\u03b72\n{ 6\u03b72[e4(15s2 \u2212 14)\n+4(3e2 \u2212 2)(5s2 \u2212 4)](arctan \u03b7 + \u03c0) +\u03b7[e4(278 \u2212 329s2) + e2(298s2 \u2212 284) +4(s2 + 6)]} cos 2g + 6\u03b7(e2 + 8)s4 cos 4g} +Q1.\nWeget thenew integration constantQ1 \u2261 Q1(L ,G, H) from \u03bd0,2|\u221e=0, which only involves the partial derivative \u2202Q1/\u2202H . We obtain\nQ1 = G \u03b1 4 p4 3 128\u03b7 (1 \u2212 s2)[2e2\u03b7(5s2 + 13)(arctan \u03b7 + \u03c0)\n\u2212e2(11s2 + 75) \u2212 85s2 + 107] + Q2. Analogously, the integration constant Q2 \u2261 Q2(L ,G) is solved from \u03b80,2|\u221e = 0, which only involves the partial derivative \u2202Q2/\u2202G. We obtain Q2 = G \u03b1 4\np4 1 128\u03b7\n[ 81e2 \u2212 30e2\u03b7(arctan \u03b7 + \u03c0) \u2212 49 ]\n9384 M. Lara et al.\n+Q3. We take Q3 \u2261 Q3(L) = 0 for simplicity, and finally obtain U2 = G \u03b1 4\np4 3 64e2 {[2e4(15s2 \u2212 14) + 8(3e2 \u2212 2)(5s2 \u2212 4)]\n\u00d7s2 cos 2g \u2212 16\u03b73(5s2 \u2212 4)s2 sin 2g \u2212e4(5s4 + 8s2 \u2212 8)}\u03c8 +G \u03b1 4\np4 1 256e3\u03b7 2\u2211 k=0 s2k { 5\u2211 j= j0 3\u2211 i=0 qk,i, j\n\u00d7e2i+1\u2212( j mod 2) cos( j f + 2kg) +\u03b7 j1\u2211\nj= j0 2\u2211 i=0 pk,i, j e 2i+1\u2212( j mod 2) sin( j f + 2kg) } ,\n(26)\nwhere j0 = \u22122(k mod 2) \u2212 1, j1 = 6 \u2212 2(k mod 2), \u03c8 = \u03c0 \u2212 f + arctan \u03b7, and the inclination polynomials pk,i, j and qk,i, j are listed in Tables 2 and 3. The second-order corrections \u03be0,2 to the polar variables are then obtained from the straightforward evaluation of the corresponding Poisson brackets.\nNote that the appearance of the function \u03c8 , which also exists in Hori\u2019s first-order solution, was only delayed to the second order of our approach. This postponement resembles analogous effect in the case of bounded motion, where the elimination of the parallax delays by one order the need of integrating by parts the terms involving the equation of the center, in the computation of the generating function [18,29]."
        },
        {
            "heading": "5 Performance of the analytical solution",
            "text": "We choose the physical parameters of the Earth (\u03bc = 398600.44 km3/s2, \u03b1 = 6378.1363 km, J2 = 0.001082634) in the first two examples. For Earth gravity assists, the flyby altitude typically ranges from about 300km, as in the case of NASA\u2019s Galileo mission,4 to the more common several thousands of km, as for instance for NASA\u2019s Stardust mission.5 Accordingly, we choose a perigee altitude of 1000km over the Earth\u2019s surface, low enough to experience the oblateness perturbing effect.\n4 https://solarsystem.nasa.gov/missions/galileo/in-depth/ solarsystem.nasa.gov/missions/galileo/in-depth Retrieved July 18, 2022. 5 https://solarsystem.nasa.gov/stardust/news/ega/index.html/ solarsystem.nasa.gov/stardust/news/ega Retrieved July 18, 2022.\nWe test first a high-eccentricity hyperbolic-type orbit, where the flyby happens in a relatively short time. Both the Kepler approach and the first order of the perturbation solution are expected to provide acceptable results in this case. The second example deals with a quasi-parabolic orbit, where the spacecraft remains longer in the close vicinity of Earth. We expect this case to be a more challenging benchmark for the analytical solution.\nIn the first case, we choose the following initial orbital elements: a = 2459.38 km, e = 4, I = 23.5\u25e6, \u03a9 = 60\u25e6, \u03c9 = 90\u25e6, M = \u221221400\u25e6. They correspond, approximately, to the entrance of a test satellite into Earth\u2019s sphere of influence (SOI). We obtain The \u201ctrue\u201d reference solution from the numerical simulation of these initial conditions in the main problem dynamics, ensuring the preservation of both the energy integral and the third component of the angularmomentum, within at least 14 digits along the 36h propagation interval. The reference orbit is shown in Fig. 1.\nThen, we analytically propagate the initial conditions: first in the Keplerian dynamics, next in the \u201ccommon\u201d interpretation of Deprit\u2019s radial intermediary (abbreviated DRI in the following). Here, Eqs. (16)\u2013\nA torsion-based solution to the hyperbolic regime of the J2-problem 9385\n(17) are assumed to remain valid in osculating elements. Finally, we propagate them in the \u201cnatural\u201d interpretation of DRI [9], i.e., in the approximation of the main problem dynamics provided by the new perturbation solution. We show the Root Sum Square (RSS) errors of each analytical solution with respect to the true orbit in Fig. 2. The Keplerian propagation starts with zero error and, because the disturbing effect of J2 is very small at the SOI entrance, then grows slowly, reaching the one-meter level at a distance of approximately 25 Earth\u2019s radii, just a few hours before\nthe closest approach. The RSS error grows notably during the perigee passage and, due to the different mean Keplerian and J2-perturbed motions, increases almost linearly after that. At the end of the propagation, the RSS error of the Keplerian approximation reaches several hundreds of km.\nWhen using the \u201ccommon\u201d version of DRI, we get closer to the J2 dynamics, although of a slightly different orbit, because of the lack of transformation between original and prime variables. For this reason, the errors in the arrival branch of the predicted orbit grow faster\n9386 M. Lara et al.\nthan the Keplerian approximation, until the accumulation of nonlinear effects due to the J2 perturbation is significant enough (which happens at about 1.5 Earth\u2019s radius for this orbit). Then, the better representation of the main problem dynamics by DRI results in clearly smaller errors than theKeplerian approximation during the flyby, and also in the departure branch of the orbit, as illustrated with the dashed gray lines in both plots of Fig. 2. The computational burden of DRI is notably alleviated when the root-finding procedure needed in the solution of the implicit function Eq. (18) is replaced by the direct evaluation of Eq. (21). In this case, the analytical propagation starts with an initial error of half a meter, which is however negligible at the precision of the analytical propagation.\nThe accuracy notably improveswhen using the natural version of DRI, labelled \u201cfirst order\u201d in Fig. 2. Here,\nwe unavoidably deal with the mandatory transformation of the initial osculating state to the mean elements that initialize the constants of the perturbation solution, using the corrections in Eqs. (11)\u2013(15) with opposite signs, and the consequent recovery of osculating elements using Eqs. (11)\u2013(15) in order to compute the RSS error.6 Errors provided by the first-order solution grow fast at perigee passage, but their following almost linear increase is, approximately, J2 times smaller than in the Keplerian and DRI cases due to the much better approximation provided by the perturbation solution, and barely reaches 100m at the end of the propagation.\n6 Recall that, while direct and inverse transformations are just opposite for first-order corrections, they are fed with different sets of elements, either mean or osculating, and hence their composition is affected by the truncation error of the perturbation theory.\nA torsion-based solution to the hyperbolic regime of the J2-problem 9387\nFig. 2 RSS position error of the flyby in Fig. 1 when using the Keplerian dynamics, DRI-common, and the first order of the perturbation solution. Note the logarithmic scale\nFor the second case, we choose the quasi-parabolic orbit a = 1.47563 \u00d7 106 km, e = 1.005, I = 23.5\u25e6, \u03a9 = 60\u25e6, \u03c9 = 90\u25e6, M = \u22121\u25e6, which flies about 1000km over Earth\u2019s surface, but for a longer time compared to the previous example. The reference orbit, shown in Fig. 3, has been numerically integrated in the main problem dynamics for a 24h interval. On one hand, we compare it with the equivalent solutions provided by the Keplerian approximation, and, on the other, the torsion-based solution of the main problem, both in the common and natural versions.\nNow the spacecraft undergoes the disturbing effects of the oblateness perturbation for a much longer time than in the previous flyby, and hence, the improvements of DRI over the Keplerian approximation are much more evident in this example, as shown in Fig. 4\u2014 where the approximate inversion in Eq. (21) has been\nFig. 3 Quasi-parabolic flyby 1000km above Earth\u2019s surface. Distance in km\nused and hence the apparent initial error of the torsionbased solution. Also, analogous improvements to the previous example are also obtained by the first-order perturbation solution in this case, for which the errors remainO(J2)with respect to corresponding ones of the Keplerian approximation. However, as shown in Fig. 4, the errors of the first-order solution now clearly peak along the close visit to Earth reaching a RSS error of about 700m at perigee (about 10%of theminimumdistance to the Earth\u2019s surface), which immediately falls byoneorder ofmagnitude, finally reaching about 200m at the end of the propagation. The latter figure means a O(J2) improvement when compared to about the same number of km, instead of m, provided by the Keplerian approach. The peak, we recall, is due to the appearance of \u03b7 in denominators of some of the first-order corrections, which in this more challenging case takes the value \u03b7 \u2248 0.1. On the other hand, it deserves mentioning that the fact that the errors of the first-order solution decrease form the initial 10m level to just a few meters when approaching Earth is just an apparent paradox that is easily explained by the approximate truncation of the inversion of the torsion to the first order of J2, and the decreasing value of \u03b8 in Eq. (19). Eventually, errors in the dynamical modeling provided by the natural version of DRI overcome those due to the approximation in Eq. (21) and grow again irrespective of the \u03b8 value.\nAs in the case of boundedmotion, a general improvement of the first-order solution is obtainedwhen including second-order terms in the mean elements propagation, a strategy that negligibly increases the computational burden [2,3]. In our case, this means including\n9388 M. Lara et al.\nFig. 4 RSS position errors of the flyby in Fig. 3 when using the Keplerian dynamics and the first order of the perturbation solution. Note the logarithmic scale\nthe term in Eq. (22) in the quasi-Keplerian Hamiltonian, as well as Eqs. (23) and (24) in the solution of the torsion transformation. As shown in Fig. 5, while these additional terms generally reduce the errors of the analytical propagation (labelled \u201cfirst order +\u201d), they do not show improvements during the close approach to the Earth. Certainly, computing the second-order corrections derived from Eq. (26) makes a full secondorder solution that, as expected, generally improves the accuracy to O(J 22 ), as we also show in Fig. 5 (blackdashed curve labelled \u201csecond order\u201d). The fact that the expected improvement does not happen at perigee to the whole extent, is due to the appearance in denominators of the second-order corrections of higher powers of \u03b7 than in the first-order approach, which now reach the fourth power in the case of \u03b80,2 and R0,2. Still, the error of the second-order solution at perigee\nFig. 5 RSS position errors of the flyby in Fig. 3 when using higher orders of the perturbation solution. Note the logarithmic scale\npassage remains at least 20 times smaller than those of the first-order solution. Finally, the RSS error curve labelled \u201csecond order +\u201d includes third-order secular terms obtained from the elimination of the parallax in the perturbation solution. Like in the first-order case, these additional terms slightly improve the computation of the \u201cmean\u201d mean motion\u2014the mean motion of the quasi-Keplerian Hamiltonian\u2014yet their effects are only noted in the departure branch of the orbit.\nBecause perturbation theories of this kind are rather uncommon, the final example is intended to show that the convergence of the successive orders of the perturbation solution, commonly observed in the case of bounded perturbed Keplerian motion (see [28,32], for instance), also happens in the current case of perturbed hyperbolic Keplerian motion. To do that, we test our solution with the challenging case of a fish-type orbit [38]. However, since parabolic orbits are necessarily excluded from the current perturbation solution due to the \u03b7 divisor that affects the elimination of the parallax transformation, we rather base our tests on an equivalent hyperbolic branch of the Newtonian rosetta.\nThus, for the gravitational parameters of Jupiter (\u03bc = 1.268 \u00d7 108 km3/s2, \u03b1 = 71492 km, J2 = 0.01475), we choose the initial conditions of an equatorial orbit with a = 724920 km, e = 1.1, g = 270\u25e6, and = \u2212120\u25e6. The fact that this orbit would impact Jupiter is not of concern for our validation purposes. The results are summarized in Fig. 6, where the true orbit, computed numerically, is represented by a black curve, approaching Jupiter from the top-left corner, surrounding the attraction center by a more than 180\u25e6 angle, to first cross the approaching branch of the\nA torsion-based solution to the hyperbolic regime of the J2-problem 9389\norbit, and then leave the scene by the left side of the picture. The Keplerian approximation (gray curve in Fig. 6) only mimics the true trajectory in the approaching part and then takes a clearly divergent path. DRI (gray-dashed curve) is able to turn the departure branch toward the true solution, a result that is clearly improved by the first-order theory (gray dotted curve), yet not enough enhanced to produce the crossing between the approaching and departing branches of the orbit. This intersection is obtained with the second-order solution (black dotted curve of Fig. 6), yet it happens out of the frame of Fig. 6, clearly far away from the true event. The third-order approximation (black dot-dashed curve of Fig. 6) notably improves the results, and the crossing now occurs inside the displayed area in Fig. 6. Finally, the black-dashed curve, which was computed with a fifth-order truncation of the elimination of the parallax complemented with additional secular terms coming from a sixth-order truncation of the quasi-Keplerian Hamiltonian, reasonably approximates the true orbit. We expect that higher-order truncations would continue to converge slowly to the true solution, yet we did not compute them due to the important growth in the size of the perturbation series and the corresponding exponential increase in the computational burden. We are satisfied with these results, which show the correctness of Hori\u2019s approach for dealing with unbounded perturbed Keplerian motion."
        },
        {
            "heading": "6 Remarks on the boundary condition: the third-body perturbation case",
            "text": "Similarly to Hori\u2019s approach, the transformation that yields Deprit\u2019s radial intermediary depends on the choice made for the integration constant. The main problem straightforwardly suggests to impose null perturbing effects at infinity, as at great distances from the primary the non-uniform gravity field of the planet flown by is negligible.\nYet, in practical examples for the Solar or a planetary system, the great distances from the flyby body are characterized by stronger effects of the main attractor of the whole system. We therefore proceed at assessing whether perturbation approaches of this kind, with Keplerian boundary condition, are suitable to study the perturbed hyperbolic Kepler problem with third-body effects only.\nIdentifyingwith the subscript B the perturbing body, the full Hamiltonian of the third-body perturbation case is\nM = M0 +MB = \u2212 \u03bc 2a\n\u2212\u03bcB (\n1 |r \u2212 rB | \u2212 r \u00b7 rB r3B\n) .\n(27)\nFollowing Lidov and Kozai [24,37], we replace r \u00b7 rB = rrB cos\u03c8 and model the perturbing potential MB as a series expansion on the Legendre polynomials of cos\u03c8 :\nMB = \u2212\u03bcB rB +\u221e\u2211 j=2 \u03b5 j j ! j ! r j r jB Pj (cos\u03c8). (28)\nFor instance, P0(x) = 1, P1(x) = x , P2(x) = 1 2 (3x\n2 \u2212 1), P3(x) = 12 (5x3 \u2212 3x), and so on. The small parameter \u03b5 is just a token to identify the strength of the perturbation effects with the ratio r/rB , that is, retaining few orders only provides an accurate approximation if r rB . More generally, the series converges if r < rB . Note the absence of the first two orders, consequence of P0 leading to the constant expression \u03bcB/rB and the first-order term canceling with the tidal part of the perturbing potential.\n9390 M. Lara et al.\nFollowing the same principle of Hori\u2019s approach for the main problem, we seek a condition where the thirdbody perturbation vanishes by itself. We approximate\nMB \u2248 \u2212\u03bcB rB\n2 r2\nr2B\n1\n2\n( 3 cos2 \u03c8 \u2212 1), (29)\nand observe that cos2 \u03c8 = 1/3 makes the second term vanish.We could be tempted to use this particular point to set the Keplerian boundary condition, however, this unique setting corresponds to the second-order term only being null, rather than the full original potential. In addition, trajectories such that cos2 \u03c8 = 1/3 is never verified may exist. Considering the higher-order terms, we do not find a value of cos\u03c8 that makes all terms in the expansion vanish.\nThese considerations suggest that the boundary condition derived from a Keplerian hyperbola may not be suitable for the third-body perturbation case. This aspect remarks that this method remains valid for the main problem only or more in general for vanishing perturbations at infinity. We strengthen our claim with a numerical proof of the just mentioned observation, whose analytical equations of motion in prime variables we obtained with the help of a symbolic processor, following the same steps of Hori\u2019s approach but applying the Lie transform method. We do not include them in this article for the sake of brevity. We study the case of a planetary flyby of Venus modeling the third-body perturbation of the Sun, within Venus\u2019 SOI. We consider the SOI entrance state, with position rT = [\u2212104551.25,\u2212597237.74,\u2212110314.51], km, and velocity vT = [3.25, 17.76, 3.67], km/s, at the time t0 = 8119.84 MJD2000, in the Ecliptic J2000 reference frame centered on Venus. We simulate the flyby motion using an ephemeris model that includes the Solar System planets, the Moon and general relativity effects up to the \u201ccritical\u201d point where cos\u03c8 = \u22121/\u221a3.Then,we compare inFig. 7 the consequent forward simulations, starting from this critical point and up to the SOI exit, of the Lie transform-based approach, the numerical simulation of the second-order term only of the third-body potential, the Keplerian integration, and the full third-body effect (not expanded).\nIn clear contrast with the improvements obtained for the main problem case, we observe from Fig. 7 the divergent behavior of the analytical perturbation solution. Setting the boundary condition as the Keple-\nrian solution where the perturbing potential vanishes, in analogy with Hori\u2019s approach, the so obtained analytical solution provides even worse predictions than the Keplerian only case, without converging toward the numerically simulated trajectory for the same physical model. Other types of boundary conditions should be explored in dedicated works, for instance the magnitude difference between the perturbation and the Keplerian term in specific regions of the hyperbolic trajectory."
        },
        {
            "heading": "7 Conclusions",
            "text": "Most main problem intermediaries in the theory of artificial satellites were originally computed in polar variables and, hence, are not constrained to the case of bounded orbits. Therefore, the improvements they provide in their common realization over the Keplerian approximation encompass the case of unbounded motion as well and are clearly leveraged in their naturalized versions. However, in the latter case, the integration \u201cconstant\u201d on which the perturbation theory depends upon can no longer remain arbitrary. On the contrary, it must be determined in such a way that the perturbation solution fulfills the boundary conditions at infinity derived from the Keplerian hyperbola.\nIn particular, we have shown that Deprit\u2019s radial intermediary provides an efficient alternative to the Keplerian approximation commonly used in flyby design. Moreover, because the appearance of secular terms is not at all of concern for hyperbolic-type motion, higher-order refinements of Deprit\u2019s quasiKeplerian approach are readily computed. Because of that, the analytical computation of unbounded perturbed Keplerian motion can take full advantage of the convergence to the true solution provided by the computation of consecutive higher orders of the perturbation approach, where the accuracy of the analytical solution is notably increased.\nInclusion of the third-body perturbation in the analytical solution is under study in order to apply it to real scenarios.\nAcknowledgements The research has received funding from the European Research Council under the European Union\u2019s Horizon 2020 research and innovation program (Grant Agreement 679086 - COMPASS). ML also acknowledges partial support from the Spanish State Research Agency and the European\nRegional Development Fund (Projects PID2020-112576GBC22 and PID2021-123219OB-I00, AEI/ERDF, EU).\nAuthor contributions All authors contributed to the study conception and design. Material preparation, data collection and analysis were performed by AM and ML. The first draft of the manuscript was written by ML, and all authors commented on previous versions of the manuscript. All authors read and approved the final manuscript.\nFunding Information Open Access funding provided thanks to the CRUE-CSIC agreement with Springer Nature.\nData Availability The output generated with the analytical perturbation solution is available upon request from the corresponding author.\nDeclarations\nConflict of interest The authors declare that they have no conflict of interest.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in anymedium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third partymaterial in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to thematerial. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/ by/4.0/."
        },
        {
            "heading": "A Deprit\u2019s perturbation algorithm. Basic formulas",
            "text": "A Lie canonical transformation (x, X) \u2192 ( y,Y ; ), where x, y, are canonical coordinates, X , Y , their conjugate momenta, respectively, and is a small parameter, is defined as the solution of the differential system\ndx d = \u2202W \u2202X , dX d = \u2212\u2202W \u2202x , (30)\nfor the initial conditions x( y,Y ; 0) = y, X( y,Y ; 0) = Y . The scalar function W = \u2211m\u22650( m/m!)Wm+1(x, X), is the generator of the Lie transformation.\nFor an analytic function F = F(x, X, ) given by its Taylor series expansion\nF = \u2211 m\u22650 m m! Fm,0(x, X), (31)\nDeprit [8] devised an efficient algorithm for the direct computation of the Taylor series expansion of F in the new variables. Namely, F\u2217 = F(x( y,Y ), x( y,Y ), ) \u2261 \u2211 m\u22650 m m! F0,m( y,Y),\nwhere the coefficients F0,m are iteratively computed from the recursion\nFm,q+1 = Fm+1,q + m\u2211 i=0\n( m\ni\n) {Fm\u2212i,q ,Wi+1}, (32)\nin which curly brackets denote the Poisson bracket operator.\n9392 M. Lara et al.\nWhen F = H \u2261 H0 +D is a perturbation Hamiltonian, inwhichH0 is integrable and themagnitude of the disturbing functionD is small compared toH0, Eq. (32) is definitively useful in computing a perturbation solution to H. Indeed, after arranging the perturbation Hamiltonian in the form of Eq. (31), the coefficients H0,m of a transformed Hamiltonian with some desired characteristics are computed from Eq. (32) starting fromH0,m = H1,m\u22121+{H0,m\u22121,W1}. Repeated iterations of Deprit\u2019s recursion yield the homological equation\n{Wm,H0,0} = H\u03030,m \u2212 H0,m, (33) where terms H\u03030,m are known from previous computations, termsH0,m are selected according to some simplification criterion (commonly making cyclic one of the canonical variables), and terms Wm , from which the perturbation solution arises, must be solved from a partial differential equation. Complete solutions of the homological equation depend on arbitrary functions of the variables,whichwenormally can choose at our convenience. However, when boundary conditions apply to the perturbation problem, these arbitrary functions must be fixed to determine the particular solution of the homological equation that strictly adheres to the dynamics of the problem. This is precisely the case of hyperbolic-type motion dealt with in this paper.\nThe usefulness of Deprit\u2019s recursion and Deprit\u2019s perturbation approach is not constrained to Hamiltonian perturbation problems. Quite on the contrary, they apply to the much more general case of perturbations of vectorial flows after minormodifications of the algorithms [19,23]."
        }
    ],
    "title": "A torsion-based solution to the hyperbolic regime of the -problem",
    "year": 2023
}