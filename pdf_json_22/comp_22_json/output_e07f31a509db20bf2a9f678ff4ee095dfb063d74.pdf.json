{
    "abstractText": "Classifying emotional states is critical for brain\u2013computer interfaces and psychology-related domains. In previous studies, researchers have tried to identify emotions using neural data such as electroencephalography (EEG) signals or brain functional magnetic resonance imaging (fMRI). In this study, we propose a machine learning framework for emotion state classification using EEG signals in virtual reality (VR) environments. To arouse emotional neural states in brain signals, we provided three VR stimuli scenarios to 15 participants. Fifty-four features were extracted from the collected EEG signals under each scenario. To find the optimal classification in our research design, three machine learning algorithms (XGBoost classifier, support vector classifier, and logistic regression) were applied. Additionally, various class conditions were used in machine learning classifiers to validate the performance of our framework. To evaluate the classification performance, we utilized five evaluation metrics (precision, recall, f1-score, accuracy, and AUROC). Among the three classifiers, the XGBoost classifiers showed the best performance under all experimental conditions. Furthermore, the usability of features, including differential asymmetry and frequency band pass categories, were checked from the feature importance of XGBoost classifiers. We expect that our framework can be applied widely not only to psychological research but also to mental health-related issues.",
    "authors": [
        {
            "affiliations": [],
            "name": "Shang-Ming Zhou"
        },
        {
            "affiliations": [],
            "name": "Dawoon Jung"
        },
        {
            "affiliations": [],
            "name": "Junggu Choi"
        },
        {
            "affiliations": [],
            "name": "Seoyoung Cho"
        },
        {
            "affiliations": [],
            "name": "Sanghoon Han"
        }
    ],
    "id": "SP:0563ec949c27154ce3f1320b6f3a6e711b745f00",
    "references": [
        {
            "authors": [
                "S.S. Yoo",
                "T. Fairneny",
                "N.K. Chen",
                "S.E. Choo",
                "L.P. Panych",
                "H. Park",
                "F.A. Jolesz"
            ],
            "title": "Brain-computer interface using fMRI: Spatial navigation by thoughts",
            "venue": "Neuroreport",
            "year": 2004
        },
        {
            "authors": [
                "C. Guger",
                "A. Schlogl",
                "C. Neuper",
                "D. Walterspacher",
                "T. Strein",
                "G. Pfurtscheller"
            ],
            "title": "Rapid prototyping of an EEG-based braincomputer interface (BCI)",
            "venue": "IEEE Trans. Neural Syst. Rehabil. Eng",
            "year": 2001
        },
        {
            "authors": [
                "G.E. Fabiani",
                "D.J. McFarland",
                "J.R. Wolpaw",
                "G. Pfurtscheller"
            ],
            "title": "Conversion of EEG activity into cursor movement by a braincomputer interface (BCI)",
            "venue": "IEEE Trans. Neural Syst. Rehabil. Eng",
            "year": 2004
        },
        {
            "authors": [
                "J. Kevric",
                "A. Subasi"
            ],
            "title": "Comparison of signal decomposition methods in classification of EEG signals for motor-imagery BCI system",
            "venue": "Biomed. Signal Process. Control",
            "year": 2017
        },
        {
            "authors": [
                "G. Rota",
                "G. Handjaras",
                "R. Sitaram",
                "N. Birbaumer",
                "G. Dogil"
            ],
            "title": "Reorganization of functional and effective connectivity during real-time fMRI-BCI modulation of prosody processing",
            "venue": "Brain Lang",
            "year": 2011
        },
        {
            "authors": [
                "X. Gu",
                "Z. Cao",
                "A. Jolfaei",
                "P. Xu",
                "D. Wu",
                "T.P. Jung",
                "C.T. Lin"
            ],
            "title": "EEG-based brain-computer interfaces (BCIs): A survey of recent studies on signal sensing technologies and computational intelligence approaches and their applications",
            "venue": "IEEE/ACM Trans. Comput. Biol. Bioinform",
            "year": 2021
        },
        {
            "authors": [
                "R.N. Duan",
                "J.Y. Zhu",
                "B.L. Lu"
            ],
            "title": "Differential entropy feature for EEG-based emotion classification",
            "venue": "In Proceedings of the 2013 6th International IEEE/EMBS Conference on Neural Engineering (NER), San Diego, CA, USA,",
            "year": 2013
        },
        {
            "authors": [
                "A. Secerbegovic",
                "S. Ibric",
                "J. Nisic",
                "N. Suljanovic",
                "A. Mujcic"
            ],
            "title": "Mental Workload vs. Stress Differentiation Using Single-Channel EEG",
            "venue": "CMBEBIH",
            "year": 2017
        },
        {
            "authors": [
                "D. Wen",
                "J. Yuan",
                "Y. Zhou",
                "J. Xu",
                "H. Song",
                "Y. Liu",
                "T.P. Jung"
            ],
            "title": "The EEG Signal Analysis for Spatial Cognitive Ability Evaluation Based on Multivariate Permutation Conditional Mutual Information-Multi-Spectral Image",
            "venue": "IEEE Trans. Neural Syst. Rehabil. Eng",
            "year": 2020
        },
        {
            "authors": [
                "T.L. Kim",
                "K. Kim",
                "C. Choi",
                "J.Y. Lee",
                "J.H. Shin"
            ],
            "title": "FOPR test: A virtual reality-based technique to assess field of perception and field of regard in hemispatial neglect",
            "venue": "J. Neuroeng. Rehabil",
            "year": 2021
        },
        {
            "authors": [
                "E.S. Stevens",
                "K.J. Bourassa",
                "A.M. Norr",
                "G.M. Reger"
            ],
            "title": "Posttraumatic Stress Disorder Symptom Cluster Structure in Prolonged Exposure Therapy and Virtual Reality Exposure",
            "venue": "J. Trauma. Stress",
            "year": 2021
        },
        {
            "authors": [
                "D.D. Torrico",
                "C. Sharma",
                "W. Dong",
                "S. Fuentes",
                "C.G. Viejo",
                "F.R. Dunshea"
            ],
            "title": "Virtual reality environments on the sensory acceptability and emotional responses of no-and full-sugar chocolate",
            "venue": "LWT",
            "year": 2021
        },
        {
            "authors": [
                "M. Yu",
                "S. Xiao",
                "M. Hua",
                "H. Wang",
                "X. Chen",
                "F. Tian",
                "Y. Li"
            ],
            "title": "EEG-based emotion recognition in an immersive virtual reality environment: From local activity to brain network features",
            "venue": "Biomed. Signal Process. Control",
            "year": 2022
        },
        {
            "authors": [
                "S. Tamburin",
                "D. Dal Lago",
                "F. Armani",
                "M. Turatti",
                "R. Sacc\u00e0",
                "S. Campagnari",
                "C. Chiamulera"
            ],
            "title": "Smoking-related cue reactivity in a virtual reality setting: Association between craving and EEG measures",
            "venue": "Psychopharmacology",
            "year": 2021
        },
        {
            "authors": [
                "J. Li",
                "J.E. Kim"
            ],
            "title": "The Effect of Task Complexity on Time Estimation in the Virtual Reality Environment: An EEG Study",
            "venue": "Appl. Sci",
            "year": 2021
        },
        {
            "authors": [
                "J. Kisker",
                "L. Lange",
                "K. Flinkenfl\u00fcgel",
                "M. Kaup",
                "N. Labersweiler",
                "F. Tetenborg",
                "B. Sch\u00f6ne"
            ],
            "title": "Authentic Fear Responses in Virtual Reality: A Mobile EEG Study on Affective, Behavioral and Electrophysiological Correlates of Fear",
            "venue": "Front. Virtual Real. 2021,",
            "year": 2021
        },
        {
            "authors": [
                "M.B. Qureshi",
                "M. Afzaal",
                "M.S. Qureshi",
                "M. Fayaz"
            ],
            "title": "Machine learning-based EEG signals classification model for epileptic seizure detection",
            "venue": "Multimed. Tools Appl. 2021,",
            "year": 2021
        },
        {
            "authors": [
                "V.J. Geraedts",
                "M. Koch",
                "M.F. Contarino",
                "H.A.M. Middelkoop",
                "H. Wang",
                "J.J. van Hilten",
                "M.R. Tannemaat"
            ],
            "title": "Machine learning for automated EEG-based biomarkers of cognitive impairment during Deep Brain Stimulation screening in patients with Parkinson\u2019s Disease",
            "venue": "Clin. Neurophysiol",
            "year": 2021
        },
        {
            "authors": [
                "G.L. Sterlini",
                "R.A. Bryant"
            ],
            "title": "Hyperarousal and dissociation: A study of novice skydivers",
            "venue": "Behav. Res. Ther",
            "year": 2002
        },
        {
            "authors": [
                "J.H. Kwon",
                "J. Powell",
                "A. Chalmers"
            ],
            "title": "How level of realism influences anxiety in virtual reality environments for a job interview",
            "venue": "Int. J. Hum. Comput. Stud",
            "year": 2013
        },
        {
            "authors": [
                "M.E. Owens",
                "D.C. Beidel"
            ],
            "title": "Can Virtual Reality Effectively Elicit Distress Associated with Social Anxiety Disorder",
            "venue": "J. Psychopathol. Behav. Assess",
            "year": 2015
        },
        {
            "authors": [
                "I.R. Price",
                "C. Bundesen"
            ],
            "title": "Emotional changes in skydivers in relation to experience",
            "venue": "Personal. Individ. Differ",
            "year": 2005
        },
        {
            "authors": [
                "J. McCarthy",
                "R. Goffin"
            ],
            "title": "Measuring Job Interview Anxiety: Beyond Weak Knees and Sweaty Palms",
            "venue": "Pers. Psychol",
            "year": 2004
        },
        {
            "authors": [
                "H.H. Jasper"
            ],
            "title": "The ten-twenty electrode system of the international federation",
            "venue": "Electroencephalogr. Clin. Neurophysiol. 1958,",
            "year": 1958
        },
        {
            "authors": [
                "J.J. Bird",
                "L.J. Manso",
                "E.P. Ribeiro",
                "A. Ek\u00e1rt",
                "D.R. Faria"
            ],
            "title": "A Study on Mental State Classification using EEG-based Brain-Machine Interface",
            "venue": "In Proceedings of the 2018 International Conference on Intelligent Systems (IS), Funchal, Portugal,",
            "year": 2018
        },
        {
            "authors": [
                "A. Delorme",
                "S. Makeig"
            ],
            "title": "EEGLAB: An open source toolbox for analysis of single-trial EEG dynamics including independent component analysis",
            "venue": "J. Neurosci. Methods",
            "year": 2004
        },
        {
            "authors": [
                "M.H. Alomari",
                "A. Samaha",
                "K. AlKamha"
            ],
            "title": "Automated Classification of L/R Hand Movement EEG Signals using Advanced Feature Extraction and Machine Learning",
            "venue": "Int. J. Adv. Comput. Sci. Appl. 2013,",
            "year": 2013
        },
        {
            "authors": [
                "J. Rodrigues",
                "M. Wei\u00df",
                "J. Hewig",
                "J.J.B. Allen"
            ],
            "title": "EPOS: EEG Processing Open-Source Scripts",
            "venue": "Front. Neurosci. 2021,",
            "year": 2021
        },
        {
            "authors": [
                "H. Hassanpour",
                "M. Shahiri"
            ],
            "title": "Adaptive Segmentation Using Wavelet Transform",
            "venue": "In Proceedings of the 2007 International Conference on Electrical Engineering, Lahore, Pakistan,",
            "year": 2007
        },
        {
            "authors": [
                "A.C.N. Chen",
                "W. Feng",
                "H. Zhao",
                "Y. Yin",
                "P. Wang"
            ],
            "title": "EEG default mode network in the human brain: Spectral regional field powers",
            "year": 2008
        },
        {
            "authors": [
                "S. Jaiswal",
                "S.-Y. Tsai",
                "C.-H. Juan",
                "N.G. Muggleton",
                "W.-K. Liang"
            ],
            "title": "Low delta and high alpha power are associated with better conflict control and working memory in high mindfulness, low anxiety individuals",
            "venue": "Soc. Cogn. Affect. Neurosci",
            "year": 2019
        },
        {
            "authors": [
                "K. Nakashima",
                "H. Sato"
            ],
            "title": "The Effects of Various Mental Tasks on Appearance of Frontal Midline Theta Activity in EEG",
            "venue": "J. Hum. Ergol. 1992,",
            "year": 1992
        },
        {
            "authors": [
                "M. Xing",
                "R. Tadayonnejad",
                "A. MacNamara",
                "O. Ajilore",
                "J. DiGangi",
                "K.L. Phan",
                "H. Klumpp"
            ],
            "title": "Resting-state theta band connectivity and graph analysis in generalized social anxiety disorder",
            "year": 2016
        },
        {
            "authors": [
                "R.J. Barry",
                "A.R. Clarke",
                "R. McCarthy",
                "M. Selikowitz",
                "J.A. Rushby",
                "E. Ploskova"
            ],
            "title": "EEG differences in children as a function of resting-state arousal level",
            "venue": "Clin. Neurophysiol",
            "year": 2004
        },
        {
            "authors": [
                "H.M. D\u00edaz",
                "F.M. Cid",
                "J. Ot\u00e1rola",
                "R. Rojas",
                "O. Alarc\u00f3n",
                "L. Ca\u00f1ete"
            ],
            "title": "EEG Beta band frequency domain evaluation for assessing stress and anxiety in resting, eyes closed, basal conditions",
            "venue": "Procedia Comput. Sci",
            "year": 2009
        },
        {
            "authors": [
                "A.K. Engel",
                "P. Fries",
                "W. Singer"
            ],
            "title": "Dynamic predictions: Oscillations and synchrony in top\u2013down processing",
            "venue": "Nat. Rev. Neurosci",
            "year": 2001
        },
        {
            "authors": [
                "A.A. Benasich",
                "Z. Gou",
                "N. Choudhury",
                "K.D. Harris"
            ],
            "title": "Early cognitive and language skills are linked to resting frontal gamma power across the first 3 years",
            "venue": "Behav. Brain Res",
            "year": 2008
        },
        {
            "authors": [
                "A. Arsalan",
                "M. Majid",
                "A.R. Butt",
                "S.M. Anwar"
            ],
            "title": "Classification of Perceived Mental Stress Using a Commercially Available EEG Headband",
            "venue": "IEEE J. Biomed. Health Inform",
            "year": 2019
        },
        {
            "authors": [
                "C.K. Loo",
                "A. Samraj",
                "G.C. Lee"
            ],
            "title": "Evaluation of Methods for Estimating Fractal Dimension in Motor Imagery-Based Brain Computer Interface",
            "venue": "Discrete Dyn. Nat. Soc",
            "year": 2011
        },
        {
            "authors": [
                "X. Hou",
                "Y. Liu",
                "O. Sourina",
                "Y.R.E. Tan",
                "L. Wang",
                "W. Mueller-Wittig"
            ],
            "title": "EEG Based Stress Monitoring",
            "venue": "In Proceedings of the 2015 IEEE International Conference on Systems,",
            "year": 2015
        },
        {
            "authors": [
                "I. Wijayanto",
                "A. Rizal",
                "A. Humairani"
            ],
            "title": "Seizure Detection Based on EEG Signals Using Katz Fractal and SVM Classifiers",
            "venue": "In Proceedings of the 2019 5th International Conference on Science in Information Technology (ICSITech), Yogyakarta,",
            "year": 2019
        },
        {
            "authors": [
                "S.A. Akar",
                "S. Kara",
                "F. Latifo\u011flu",
                "V. Bilgi\u00e7"
            ],
            "title": "Investigation of the noise effect on fractal dimension of EEG in schizophrenia patients using wavelet and SSA-based approaches",
            "venue": "Biomed. Signal Process. Control",
            "year": 2015
        },
        {
            "authors": [
                "M.J. Katz"
            ],
            "title": "Fractals and the analysis of waveforms",
            "venue": "Comput. Biol. Med",
            "year": 1988
        },
        {
            "authors": [
                "R. Tibshirani"
            ],
            "title": "Regression shrinkage and selection via the lasso",
            "venue": "J. R. Stat. Soc. Ser. B",
            "year": 1996
        },
        {
            "authors": [
                "D.W. Marquardt",
                "R.D. Snee"
            ],
            "title": "Ridge regression in practice",
            "venue": "Am. Stat. 1975,",
            "year": 1975
        },
        {
            "authors": [
                "J.P. Tauscher",
                "F.W. Schottky",
                "S. Grogorick",
                "P.M. Bittner",
                "M. Mustafa",
                "M. Magnor"
            ],
            "title": "Immersive EEG: Evaluating Electroencephalography in Virtual Reality",
            "venue": "In Proceedings of the 2019 IEEE Conference on Virtual Reality and 3D User Interfaces (VR),",
            "year": 2019
        },
        {
            "authors": [
                "C. Tremmel",
                "C. Herff",
                "T. Sato",
                "K. Rechowicz",
                "Y. Yamani",
                "D.J. Krusienski"
            ],
            "title": "Estimating cognitive workload in an interactive virtual reality environment using EEG",
            "venue": "Front. Hum. Neurosci",
            "year": 2019
        },
        {
            "authors": [
                "M. Alimardani",
                "A. Hermans",
                "A.M. Tinga"
            ],
            "title": "Assessment of empathy in an affective VR environment using EEG signals. arXiv 2020, arXiv:2003.10886",
            "venue": "Available online: https://arxiv.org/abs/2003.10886 (accessed on",
            "year": 2021
        },
        {
            "authors": [
                "R. Stevens",
                "T. Galloway",
                "C. Berka"
            ],
            "title": "Integrating EEG models of cognitive load with machine learning models of scientific problem solving. Augment",
            "venue": "Cogn. Past Present Future 2016,",
            "year": 2016
        },
        {
            "authors": [
                "J. Gross",
                "H. Baumgartl",
                "R. Buettner"
            ],
            "title": "A Novel Machine Learning Approach for High-Performance Diagnosis of Premature Internet Addiction Using the Unfolded EEG Spectra",
            "venue": "In Proceedings of the 26th Americas Conference on Information Systems,",
            "year": 2020
        },
        {
            "authors": [
                "H. Baumgartl",
                "P. Roessler",
                "D. Sauter",
                "R. Buettner"
            ],
            "title": "Measuring Social Desirability Using a Novel Machine Learning Approach Based on EEG Data",
            "venue": "In Proceedings of the Pacific Asia Conference on Information Systems, Dubai, United Arab Emirates,",
            "year": 2020
        },
        {
            "authors": [
                "X.W. Wang",
                "D. Nie",
                "B.L. Lu"
            ],
            "title": "Emotional state classification from EEG data using machine learning approach",
            "venue": "Neurocomputing",
            "year": 2014
        },
        {
            "authors": [
                "O. Bazgir",
                "Z. Mohammadi",
                "S.A.H. Habibi"
            ],
            "title": "Emotion recognition with machine learning using EEG signals",
            "venue": "In Proceedings of the 2018 25th National and 3rd International Iranian Conference on Biomedical Engineering (ICBME), Qom, Iran,",
            "year": 2018
        },
        {
            "authors": [
                "R. Jenke",
                "A. Peer",
                "M. Buss"
            ],
            "title": "Feature extraction and selection for emotion recognition from EEG",
            "venue": "IEEE Trans. Affect. Comput. 2014,",
            "year": 2014
        },
        {
            "authors": [
                "N. Jatupaiboon",
                "S. Pan-ngum",
                "P. Israsena"
            ],
            "title": "Emotion classification using minimal EEG channels and frequency bands",
            "venue": "In Proceedings of the 2013 10th International Joint Conference on Computer Science and Software Engineering (JCSSE), Khon Kaen, Thailand,",
            "year": 2013
        },
        {
            "authors": [
                "M. Li",
                "H. Xu",
                "X. Liu",
                "S. Lu"
            ],
            "title": "Emotion recognition from multichannel EEG signals using K-nearest neighbor classification",
            "venue": "Technol. Health Care 2018,",
            "year": 2018
        }
    ],
    "sections": [
        {
            "text": "Citation: Jung, D.; Choi, J.; Kim, J.;\nCho, S.; Han, S. EEG-Based\nIdentification of Emotional Neural\nState Evoked by Virtual Environment\nInteraction. Int. J. Environ. Res. Public\nHealth 2022, 19, 2158. https://\ndoi.org/10.3390/ijerph19042158\nAcademic Editor: Shang-Ming Zhou\nReceived: 14 January 2022\nAccepted: 11 February 2022\nPublished: 14 February 2022\nPublisher\u2019s Note: MDPI stays neutral\nwith regard to jurisdictional claims in\npublished maps and institutional affil-\niations.\nCopyright: \u00a9 2022 by the authors.\nLicensee MDPI, Basel, Switzerland.\nThis article is an open access article\ndistributed under the terms and\nconditions of the Creative Commons\nAttribution (CC BY) license (https://\ncreativecommons.org/licenses/by/\n4.0/).\nKeywords: electroencephalography; virtual reality; emotion recognition; machine learning"
        },
        {
            "heading": "1. Introduction",
            "text": "The identification of neural states plays an important role in a variety of domains including brain\u2013computer interaction (BCI) and psychological research [1\u20133]. In several previous studies, diverse methodologies have been applied to measure neural state variations among participants. Kevric and Subasi [4] proposed a motor imagery BCI model using electroencephalography (EEG) signals. Giuseppina et al. [5] utilized brain functional magnetic resonance imaging (fMRI) data to construct a BCI system. Among several brain imaging techniques used in associated research, the EEG-based approach is primarily used to analyze neural activities. In Xiaotong et al. [6], the authors suggested high temporal resolution reaching the millisecond level as advantages of EEG signals in associated research. Additionally, the signal reliability and mobility of recently used EEG collection devices have been positively evaluated for real-world BCI and clinical usage. Based on the aforementioned advantages of EEG signals, several researchers collected EEG signals and used them to compare or classify the psychological states of participants. Duan et al. [7] attempted to classify the emotional states of participants using EEG signals. Fluctuations in EEG signals were recorded with movie clips used as stimuli. Secerbegovic et al. [8] used a single-channel EEG signal to differentiate between mental workload and stress in student groups. To investigate the different neural state variations in stress and workload, two scenarios were provided for distinct groups. The student group conducted\nInt. J. Environ. Res. Public Health 2022, 19, 2158. https://doi.org/10.3390/ijerph19042158 https://www.mdpi.com/journal/ijerph\n3-back visual tasks with high difficulty in the first scenario. For the other group, the same visual tasks (i.e., 3-back visual task) and Lumosity games were offered sequentially. Dong et al. [9] evaluated the spatial cognitive ability based on EEG signal analysis. They recorded and compared EEG signals before and after a spatial navigation training program. Navigation tasks for visible/hidden routes in a virtual city street environment were used for evaluation. In recent research, virtual reality (VR) has been widely used as an experimental or therapeutic material. Kim et al. [10] proposed a human perception test framework for Hemispatial neglect based on VR. The test framework consists of screens with targets in 3D environments. Selections of participants about the target were recorded to assess their perception abilities. Elizabeth et al. [11] utilized VR tools to investigate the efficacy of exposure therapy for posttraumatic stress disorder (PTSD). Exposure therapy with imaginal exposure was offered in the display of VR devices. To compare the level of PTSD, clinician interviews were conducted before and after treatment. Torrico et al. [12] examined the emotional responses to chocolate in VR environments. Three environments, including traditional booths and VR devices, were used to identify differences in the effects of sensory responses. Various virtual environments with EEG signals have been considered as research methods in the associated research. To check neural state variations in VR conditions, the measured EEG signals were analyzed by reaction from participants. Yu et al. [13] organized research designs using VR emotion recognition tasks and EEG measurements. Three different categories of stimuli (positive, neutral, and negative) were included in the tasks to compare emotional responses in experimental conditions. Functional brain network indices were calculated to detect the influence of tasks in a virtual environment. Tamburin et al. [14] used VR settings in their research to check the associations between craving and EEG measurements. Among diverse craving situations, the authors evaluated smoking-related cue reactivities in smokers and non-smokers. The participant groups (i.e., smokers and non-smokers) were exposed to two VR scenarios (mountain landscape and office). Band-pass power values were processed from EEG signals collected in virtual scenarios to distinguish the effects of the cues. Li and Kim [15] evaluated the effects of task complexity in a VR environment using EEG signals. They calculated descriptive statistics from the behavioral responses. To compare responses between conditions, the authors conducted a repeated-measures ANOVA test. Kisker et al. [16] gathered electrophysiological correlates of fear and avoidance tendencies from EEG signals. Subsequently, Shapiro\u2013Wilk tests were used to check the normality of the variables. Moreover, ANOVA and t-tests were applied to investigate the differences between responses and EEG analysis results. Various studies have applied machine or deep learning algorithms to find latent patterns in EEG data. Qureshi et al. [17] utilized K-nearest neighbor (KNN) and fuzzy rough nearest neighbor (FRNN) algorithms to classify epileptic seizures from EEG signals. They suggested EEG feature extraction algorithms based on discrete wavelet transformation (DWT) methods. Additionally, the classification performances of fuzzy function-based algorithms were compared with traditional algorithms (such as decision tree and random forest). Furthermore, Geraedts et al. [18] proposed a fully automated EEG-based machinelearning pipeline to identify patients with PD. The proposed pipeline showed a better classification performance than the other frameworks. Based on previous studies, we proposed a machine learning framework for neural state classification in a virtual environment based on EEG analysis. EEG signals were collected from 15 participants before and after the tasks to investigate the influences of VR tasks. A total of three virtual environments (high, low arousal, and social anxiety) were provided to participants for the evaluation of emotional responses. To identify optimal classification algorithms for our framework, three machine learning models (k-nearest neighbors, support vector machine, and random forest) were applied to the experiments in\nour study. Furthermore, we checked the important features of the classification models to interpret our experimental results. The main contributions of our research are as follows. First, regarding the external environment during EEG signal collection, we provided various virtual situations in VR devices to investigate the influence of virtual content on neural state variation. Second, for checking suitable classification algorithms in our research scheme, we found the appropriateness of the XGBoost classifier based on comparisons between three machine learning classifiers. Third, as regards identification of important features in classification tasks, we verified the usability of fourteen features for classification among fifty-four features widely used in previous studies. Finally, we proposed a machine learning-based emotion classification framework with EEG signals in a virtual environment. This framework can contribute to future research in the field of mental states-related health issues (such as PTSD, obsessive-compulsive disorder, autism spectrum disorder, and attention deficit hyperactivity disorder)."
        },
        {
            "heading": "2. Materials and Methods",
            "text": ""
        },
        {
            "heading": "2.1. Overview",
            "text": "Our experimental design comprised six steps. First, we collected VR-evoked EEG signals from participants in three virtual environment conditions. Second, EEG signals were preprocessed to perform feature extraction. Third, 54 features were extracted from the preprocessed EEG signals. Fourth, lasso and ridge regression models were used to select the proper features from the 54 extracted features. Fifth, we applied three machine learning classifiers to classify emotional neural states based on EEG signal features. Finally, the classification performance was evaluated using five evaluation indices. The detailed steps are shown in Figure 1."
        },
        {
            "heading": "2.2. Participants",
            "text": "Fifteen participants (eight men and seven women; age range, 19\u201338 years; mean = 26.27, standard deviation = 5.38) participated in the study. None of the participants reported any mental illness. The experiments were designed and conducted in accordance with the institutional review board approval at Yonsei University. In the experiment, participants were required to experience three types of 360-degree VR content on YouTube to induce different neural states [19\u201321]. Oculus Quest 2, a VR head-mounted display, was used to experience the VR content."
        },
        {
            "heading": "2.3. EEG Data Acquisition and Experimental Procedure",
            "text": "The three types of VR content\u2014low arousal, high arousal, and social anxiety\u2014were provided as stimuli. In the low-arousal condition, a virtual calm sea view was shown to experience a low-arousal state. In contrast, environments with skydiving were shown to experience a high-arousal state in high-arousal conditions. A previous study validated that skydiving experiences elicited a hyperarousal state [22]. To arouse a relatively higher emotional state than the aforementioned two conditions, we conducted group interviews under social anxiety conditions. Evoked social anxiety through VR content has been revealed in previous studies [23,24]. Participants were instructed to look around their surroundings in high- and lowarousal conditions. In social anxiety conditions, interviews with three interviewers were conducted. The level of arousal could be similar in conditions of high arousal and social anxiety. However, high arousal and social anxiety were distinct in that the condition of social anxiety involved interactions with the interviewer. In addition, the two conditions differed in valence of emotions. Skydiving is a positive experience associated with fun, happiness, and pleasure [25]. The social anxiety condition can induce more negative feelings than the high-arousal condition, since the interview can evoke anxiety and distress on account of the fact that the participants are evaluated by the interviewer [26]. Examples of virtual content are shown in Figure 2.\nThe portable EEG device, which is the MUSE2 headset band from InteraXon, Inc., recorded brain activity. It has seven electrodes: four active electrodes located at AF7, AF8, TP9, and TP10, which are included in the prefrontal and temporoparietal lobe regions, a ground electrode located at FPz in the center, and two reference electrodes to the left and right of the ground (Figure 3). EEG data were acquired using a 256 Hz sampling frequency.\nPrior to the experiment, we explained the EEG signal collection procedure to the participants and asked each participant to sign a consent form. Once the consent form was signed, eyes-open resting state EEG was recorded for 5 min while the participant sat in a relaxed position to obtain baseline activity. Following the baseline EEG recording, the emotional states following each VR experience were examined for each participant. A block diagram of the collection procedure is presented in Figure 4."
        },
        {
            "heading": "2.4. EEG Preprocessing",
            "text": "The VR-evoked EEG signals from the participants were preprocessed using the EEGLAB (interactive MATLAB toolbox) [29]. First, baseline correction was accomplished by subtracting the mean baseline value from each epoch to reduce baseline differences across the EEG channels and temporal drifts. Second, the band-pass filter was applied from 0.5 to 70 Hz in order to minimize artifacts such as direct current shifts and filtering artifacts at epoch boundaries [30]. Third, the continuous resting state EEG data were segmented into a 2 s epoch, the length of which is advisable in order to remove short artifacts and improve non-stationarity [31,32]. Finally, 2 s lengths of epochs with noise or artifacts such as eye movements, eye blinks, and muscle activity were removed manually based on their signal shape (e.g, sudden spikes and similar patterns with cardiac cycles). In addition, an independent component analysis (ICA) algorithm, which identifies maximal temporally independent EEG signals, was used to remove deliberate noise in the EEG signals. As a result, an average of 54.27 epochs remained and was applied for analysis from 150 epoch sets after removal."
        },
        {
            "heading": "2.5. EEG Feature Extraction",
            "text": "We extracted a total of fifty-four features for the analysis. The power spectral density was calculated by averaging the power for the frequency band in each epoch and then averaging it for all epochs. The frequency bands were divided into delta (0.5\u20134 Hz), theta (4\u20138 Hz), alpha (8\u201312 Hz), beta (12\u201330 Hz), and gamma (30\u201350 Hz). Twenty frequency power features, that is, five frequency bands for the four electrodes, were extracted. Previous findings have suggested that frequency power analysis of resting-state EEG provides insight into the neural correlates of emotional mental state. For example, frontal delta power is presented during reduced alertness, such as at rest [33]. Lower delta activity in the posterior temporal and occipital areas before target onset is related to a more alert state [34]. Resting state theta activity has been linked to anxiety states, including social anxiety [35,36]. Alpha power is an index of the resting state with reduced cortical arousal. Lower alpha power in the posterior region has been reported in the high-arousal group [37], and high beta power is related to stress and anxiety [38]. Resting state gamma power is associated with high-arousal states, such as higher cognitive and emotional processes [39]. Resting frontal gamma power is associated with early cognition and language [40]. Differential asymmetry (DASM) is the difference in the frequency band power of symmetrical electrode pairs (TP9&TP10 and AF7&AF8), and there are ten DASMs comprising five frequency band powers for the two electrode pairs used [41]. Rational asymmetry (RASM) is the ratio of the frequency band power of symmetrical electrode pairs (TP9&TP10 and AF7&AF8) [42]. A total of ten RASM features, comprising five frequency band powers for two electrode\npairs, were used. Correlation coefficients of frequency band power on pairs of electrodes, TP9&TP10 and AF7&AF8, were also used [43]. Thus, a total of ten correlation coefficient features, comprising five frequency bands for two electrode pairs, were used. The fractal dimension (FD) is a measure of the complexity of a key feature of fractals. The nonlinear property of the EEG signal in the time domain can be analyzed using the FD. A low FD corresponds to a regular signal; conversely, a high FD corresponds to an irregular signal. The FD could distinguish the EEG data of subjects in different states [44,45]. The Katz FD was used in this study based on previous results that showed superior performance in the classification of EEG data [46]. The FDs of the four electrodes are calculated in this study. In summary, the EEG frequency power analysis was performed using a fast Fourier transform. Frequency bands were divided into delta (0\u20134 Hz), theta (4\u20137 Hz), alpha (8\u201312 Hz), beta (12\u201330 Hz), and gamma (30\u201350 Hz). The absolute power of each frequency band was estimated for each EEG channel. A total of 20 values (four EEG channels \u00d7 five frequency bands) was estimated. DASM and rational asymmetry (RASM) are the differences and ratios of symmetrical electrode pairs, which are TP10-TP9 and AF8-AF7. Each pair from five frequency bands (two pairs of EEG channels \u00d7 five frequency bands) was measured in the DASM and RASM. The correlation coefficient between paired regions was calculated for the five frequency domains (two pairs of EEG channels \u00d7 five frequency bands). The fractal dimension, which measures the fractal complexity, was calculated for each electrode (four channels). The 54 features mentioned above were analyzed in this study. Detailed extracted features were listed in Table 1."
        },
        {
            "heading": "2.6. Feature Selection",
            "text": "Fifty-four features extracted from EEG signals may have two problems. First, a high correlation can be observed between features included in the same categories (multicollinearity or redundancy for classification). Second, irrelevant features for classification can be included in the features (low correlation). To identify the proper features for classification tasks, we applied lasso and ridge regression for feature selection [47,48].\nIn this step, we fitted the lasso and ridge regression models based on a dataset consisting of EEG feature values. Fifty-four features were applied as independent variables and emotional states were used as dependent variables for regression models. The coefficients were checked for individual features and sorted by scale. After sorting features by their coefficients, we selected and compared the top 20 features between the lasso and ridge regression conditions. As a result, 14 common features were selected from 54 features. The selected features are listed in Table 2.\n1 CC, correlation coefficient; 2 DASM, differential asymmetry; 3 FP, frequency band power; 4 RASM, rational asymmetry."
        },
        {
            "heading": "2.7. Machine Learning Classification Algorithm",
            "text": "To classify emotional neural states based on EEG signals, we utilized three machine learning classifiers with 14 EEG features. The first classifier was the XGBoost classifier, which is based on an ensemble of multiple decision tree models. A given dataset with n samples and m features (D = {( xi, yj\n) \u2223\u2223 xi \u2208 Rm, yj \u2208 R}) was used to train the classifier. In our study, we applied a dataset of 60 rows and 14 features. Gradient boosting methods with regularized objective functions constitute the basis for the algorithm.\nL(\u03c6) = \u2211 i\nl ( yi, y\u2032i ) + \u2211\nk \u2126( fk) (1)\nwhere \u2126( f ) = \u03b3T + 1 2 \u03bb||\u03c9||2 (2)\ny\u2032i = \u03c6(xi) = K\n\u2211 k=1 fk(xi), fk \u2208 F (3)\nTo optimize the XGBoost classifier with a dataset, we minimize the objective function with regularized terms in (1), where y\u2032i denotes the predicted values from decision tree models and fk indicates individual tree models. Differentiable convex loss functions that compare the difference between the predicted value (y\u2032i) and target value (yi) were included in (1) as function l. Penalization term was added as function \u2126 in the second term. In this study, we set yi as class labels to which emotional neural state levels were assigned (such as baseline, low, high arousal, and social anxiety level).\nThe second classifier was a support vector classifier (SVC) with nonlinear kernels. This classification algorithm classifies the feature space using hyperplanes to separate class labels. We applied a non-linear kernel (radial basis function kernel) to evaluate the performance under more diverse class conditions. In addition, we trained and evaluated the algorithm performance using completely participant-separated datasets to avoid overfitting when non-linear kernels were used. The third classifier was the logistic regression model (LR). A maximum likelihood estimation method is used to estimate the coefficients of the regression model. Consequently, the classifier calculates the likelihood value L(x), where 0 \u2264 L(x) \u2264 1. This likelihood value indicates associations between class labels and input vectors. We considered the basic form of the logistic regression model with our EEG features and neural state classes as follows:\nF(z) = E( Y X ) = 1 1 + e\u2212(\u03b1+\u2211 \u03b2iXi)\n(4)\nwhere z = \u03b1 + \u03b21X1 + \u03b22X2 + . . . + \u03b2kXk (5)\nwhere Y indicates the emotional neural state level as a class label. In summary, logistic regression classifiers suggested the probability of categorizing each class under various conditions. To determine the optimal hyperparameters of the three classification algorithms, we conducted a random search. The detailed hyperparameters are presented in Table 3."
        },
        {
            "heading": "2.8. Evaluation Metrics",
            "text": "We evaluated the classification performance of the three classifiers by comparing five evaluation metric values. The true positive (TP), true negative (TN), false positive (FP), and false negative (FN) values were calculated from the confusion matrix. The TP and TN values indicate the ratio of correctly classified samples. In addition, the FP and FN values indicate incorrectly classified samples. Finally, four metric values were obtained from the aforementioned four values: precision, recall, f1-score, and accuracy. Additionally, to establish the receiver operating characteristic (ROC) curve, the true positive rate (TPR) and false positive rate (FPR) values were calculated. The area under the ROC curve (AUROC) was determined using an ROC curve.\nPrecision = TP\nTP + FP (6)\nRecall = TP\nTP + FN (7)"
        },
        {
            "heading": "F1\u2212 score = 2\u00d7 Precision\u00d7 Recall",
            "text": "Precision + Recall\n(8)\nAccuracy = TP + TN\nTP + FP + TN + FN (9)\nTrue Positive Rate = TP\nTP + FN (10)\nFalse Positive Rate = FP\nFP + TN (11)\nA fivefold cross-validation was used to evaluate machine learning algorithms in robust settings. Trained data for the classification used 80% of the data, while the remaining 20% were used for testing. The classification scores were averaged across the iterations to estimate the performance of the classifier."
        },
        {
            "heading": "2.9. Tools",
            "text": "All codes for ML classifiers and data preprocessing were written using Python (version 3.7.1; scikit-learn, version 2.4.1) and R (version 4.0.3) programming languages."
        },
        {
            "heading": "3. Results",
            "text": ""
        },
        {
            "heading": "3.1. Classification Performance of Machine Learning Classifiers",
            "text": "To identify optimal classification algorithms, we utilized three machine learning classifiers (XGBoost, SVC, and LR) for emotional neural state classification. Classification performance was evaluated based on five evaluation metrics (precision, recall, f1-score, accuracy, and AUROC). In the experimental results, the XGBoost classifiers showed the best classification performance under different conditions. We found the same trends in performance in both binary-class and multi-class conditions. The detailed classification performances and ROC curves are listed in Tables 4 and 5.\n1 AUROC: area under the ROC curve, 2 SVC: support vector classifier, 3 LR: logistic regression."
        },
        {
            "heading": "3.2. Importance of Features for Classification of Emotional Neural States",
            "text": "We compared the important features of machine learning classifiers to find proper feature categories for classification. Among the three classifiers (XGBoost, SVC, and LR) used in the analysis, the feature importance of XGBoost classifiers was selected based on their classification performance. The top five important features were compared in the binary and multi-class conditions. In five feature categories (FP, DASM, RASM, CC, and FD), features of differential asymmetry (DASM), and frequency band power (FP) categories were mainly found in the experimental results. The detailed important features are listed in Tables 6 and 7.\n1 AUROC, area under the ROC curve; 2 SVC, support vector classifier; 3 LR, logistic regression; 4 low, lowarousal condition.\n1 low: low-arousal condition, 2 high: high-arousal condition, 3 social anxiety condition.\n1 low: low-arousal condition, 2 high: high-arousal condition, 3 social anxiety condition."
        },
        {
            "heading": "4. Discussion",
            "text": "In this study, we attempted to identify emotional neural states based on VR-evoked EEG signals using machine learning classification algorithms. A total of 15 participants were involved in our study to collect EEG signals from four virtual environments. To detect the difference in neural variation between virtual stimuli, fifty-four features including five categories, were extracted. In addition, 14 features were selected based on the coefficients of the lasso and ridge regression models. After consisting of datasets with EEG features, three classification algorithms were used to classify the emotional states. The XGBoost classifier showed the best classification performance for our study design. Furthermore, the feature importance of the XGBoost classifiers was compared to validate the usability of the features for classification. Among the five feature categories, the rank of the DASM and FP features was higher than that of the other categories. To suggest reasonable evidence of our research topics (i.e., VR evoked emotional EEG signals, classification through machine learning algorithms), we found associated previous research. First, related to the collection of EEG signals based on VR content, Tauscher et al. [49] compared EEG signal quality between VR content and traditional displays. They concluded that an improvement in signal quality was found with the fixation of VR contents and straps. Tremmel et al. [50] estimated the\ncognitive workload in an interactive virtual reality environment using EEG signals. The authors evaluated the feasibility of monitoring cognitive workload via EEG signals while performing a classical n-back test in VR devices. Alimardani et al. [51] assessed empathy levels in an effective virtual environment using EEG signals. The relationships between empathy scores and frontal alpha asymmetry were examined in the experimental results. Second, in terms of analysis with machine learning algorithms, Stevens et al. [52] conducted an analysis of the relationship between EEG and distraction and engagement contents based on machine learning models. An artificial neural network (ANN) model was utilized to determine the influence of various contents on EEG signal values. In Gross et al. [53], researchers attempted to diagnose premature Internet addiction using EEG spectra with machine learning algorithms. A random forest classifier was utilized for the classification of addiction. Baumgartl et al. [54] proposed a measurement system for social desirability based on EEG data. They utilized random forest models to classify social desirability levels. Based on the aforementioned previous studies, we concluded that our research topic regarding emotional neural state analysis evoked by VR through machine learning algorithms was reasonable. In addition, we designed our study based on related previous research to compare or validate the experimental results. Wang et al. [55] attempted to find detailed relationships between different emotional states and various EEG features. To stimulate participants\u2019 emotions, researchers provided a set of movie clips, including two target emotional states (i.e., positive and negative emotions). EEG signals were collected from six health participants while watching movie clips. Three analysis methods (power spectrum, wavelet, and nonlinear dynamical analysis) were used to extract the features. With regard to extracted features, feature dimensionality reduction was conducted using principal component analysis, linear discriminant analysis, and correlation-based feature selector. Support vector machine models were applied to binary classification tasks for the two emotions. The performances of the algorithms were compared under various parameter conditions. Bazgir et al. [56] developed an emotion recognition system using EEG signals. EEG signals were measured with consecutive 1 min length music videos from the participants. The discrete wavelet transform method was used to extract the gamma, beta, alpha, and theta frequency band features. A principal component analysis was applied to maintain the same dimensionality of features. Three classification algorithms (support vector machine, k-nearest neighbor, and artificial neural network) were utilized to classify emotional states. Among the various frequency band features, the beta frequency band condition showed the best classification performance. Similar to the previously mentioned studies, the study design of our research comprised similar steps. First, the EEG dataset was collected in a VR content stimulus from 15 participants. Second, fifty-four EEG features were extracted to evaluate the effects of each feature. Third, we applied a lasso and ridge regression model to select the proper features from fifty-four features. Fourth, XGBoost, SVC, and LR models were used to classify the emotional neural variations. Finally, we compared the classification performances using five evaluation metrics. In our experimental procedure, we compared four levels of emotional neural states in the virtual environment. To set a baseline of the emotional state, we measured the EEG signals without any stimulus materials. Additionally, in low- and high-arousal conditions, EEG signals were collected in virtual environmental stimuli without interaction. Furthermore, neural states in social anxiety were investigated with relatively higher emotional conditions than other conditions in virtual interaction materials. To check the optimal algorithms for our research topic, we validated the classification performances under various comparison conditions. XGBoost classifiers showed the best classification performance among the three algorithms and all experimental conditions. To examine the influence of the features, we compared the feature importance results of XGBoost under all conditions. Differential asymmetry and frequency band power features were frequently found in high rank (i.e., top five importance). This trend can be verified in previous studies. Jenke et al. [57] suggested the utility of differential asymmetry in the emotion classification of EEG. In\naddition, Jatupaiboon et al. [58] and Li et al. [59] validated the influence of frequency band power values as features for emotion classification."
        },
        {
            "heading": "5. Conclusions",
            "text": "We collected and analyzed EEG signals in virtual environments to identify emotional states based on neural variations. To compare emotional influences in virtual content, we set four levels of emotional arousal (baseline, low, high arousal, and social anxiety) in our experimental materials. Three machine learning classification algorithms (XGBoost classifier, support vector classifier, and logistic regression) were applied to classify the neural fluctuations evoked by VR stimuli. Additionally, 54 features in five feature categories were applied to compare the usability for classification. Among the three classifiers, the XGBoost algorithm showed the best classification performance under all experimental conditions. Furthermore, we found the effectiveness of features, including differential asymmetry and frequency band power categories, to classify emotional states in our study design. The first strength of this study was the application of machine learning classification algorithms to identify emotional neural states evoked by VR content. Second, the efficiency of the features was investigated through the feature importance of machine learning algorithms. Third, we collected EEG signals in VR content to examine the influence of the virtual environment on emotion. Finally, our framework can utilize an emotional state classification framework for various objectives. Our study has some limitations. First, we extracted and compared several features, including five feature categories. Other features or indices may be valuable for classification. However, we selected 54 features widely used in previous studies. Second, various methodologies, including deep learning algorithms, can be used in our research topics. In our study, we utilized machine learning models to check the importance of the features in the models. Third, additional validation is required in future studies with more participants to generalize our framework and results.\nAuthor Contributions: Conceptualization: S.H. and D.J.; methodology: S.H.; validation: S.H.; formal analysis: D.J. and J.C.; investigation: D.J., J.K., and S.C.; writing\u2014original draft preparation, D.J. and J.C.; writing\u2014review and editing D.J. and J.C.; visualization, D.J. and J.K.; supervision, S.H.; project administration, S.H. All authors have read and agreed to the published version of the manuscript.\nFunding: This research was supported by the Brain Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Science and ICT (2017M3C7A1029485) and partially supported by a National Research Foundation of Korea (NRF) grant funded by the Korean government (NRF-2019R1A2C1007399).\nInstitutional Review Board Statement: The study was conducted in accordance with the guidelines of the Declaration of Helsinki and approved by the institutional review board of Yonsei University (7001988-202104-HR-659-06).\nInformed Consent Statement: Informed consent was obtained from all subjects involved in the study.\nData Availability Statement: Not applicable.\nConflicts of Interest: The authors declare no conflict of interest."
        }
    ],
    "title": "EEG-Based Identification of Emotional Neural State Evoked by Virtual Environment Interaction",
    "year": 2022
}