{
    "abstractText": "The COVID-19 pandemic has seen dramatic demand surges for hospital care that have placed a severe strain on health systems worldwide. As a result, policy makers are faced with the challenge of managing scarce hospital capacity so as to reduce the backlog of non-COVID patients whilst maintaining the ability to respond to any potential future increases in demand for COVID care. In this paper, we propose a nation-wide prioritization scheme that models each individual Contributed Equally Contributed Equally Corresponding author: ww@imperial.ac.uk 1 patient as a dynamic program whose states encode the patient\u2019s health and treatment condition, whose actions describe the available treatment options, whose transition probabilities characterize the stochastic evolution of the patient\u2019s health and whose rewards encode the contribution to the overall objectives of the health system. The individual patients\u2019 dynamic programs are coupled through constraints on the available resources, such as hospital beds, doctors and nurses. We show that the overall problem can be modeled as a grouped weakly coupled dynamic program for which we determine near-optimal solutions through a fluid approximation. Our case study for the National Health Service in England shows how years of life can be gained by prioritizing specific disease types over COVID patients, such as injury & poisoning, diseases of the respiratory system, diseases of the circulatory system, diseases of the digestive system and cancer.",
    "authors": [
        {
            "affiliations": [],
            "name": "Josh C. D\u2019Aeth"
        },
        {
            "affiliations": [],
            "name": "Shubhechyya Ghosal"
        },
        {
            "affiliations": [],
            "name": "Fiona Grimm"
        },
        {
            "affiliations": [],
            "name": "David Haw"
        },
        {
            "affiliations": [],
            "name": "Esma Koca"
        },
        {
            "affiliations": [],
            "name": "Krystal Lau"
        },
        {
            "affiliations": [],
            "name": "Huikang Liu"
        },
        {
            "affiliations": [],
            "name": "Stefano Moret"
        },
        {
            "affiliations": [],
            "name": "Dheeya Rizmie"
        },
        {
            "affiliations": [],
            "name": "Peter C Smith"
        },
        {
            "affiliations": [],
            "name": "Giovanni Forchini"
        },
        {
            "affiliations": [],
            "name": "Marisa Miraldo"
        },
        {
            "affiliations": [],
            "name": "Wolfram Wiesemann"
        },
        {
            "affiliations": [],
            "name": "Abdul Latif Jameel"
        }
    ],
    "id": "SP:dc38c9f74c5a250db3b849108dfd4d58f4fb4f92",
    "references": [
        {
            "authors": [
                "D. Adelman",
                "A.J. Mersereau"
            ],
            "title": "Relaxations of weakly coupled stochastic dynamic programs",
            "venue": "Operations Research 56 (3), 712\u2013727.",
            "year": 2008
        },
        {
            "authors": [
                "M. Argenziano",
                "K. Fischkoff",
                "C.R. Smith"
            ],
            "title": "Surgery scheduling in a crisis",
            "venue": "New England Journal of Medicine 382 (23), e87.",
            "year": 2020
        },
        {
            "authors": [
                "M. Armony",
                "C. Maglaras"
            ],
            "title": "On customer contact centers with a call-back option: Customer decisions, routing rules, and system design",
            "venue": "Operations Research 52 (2), 271\u2013292.",
            "year": 2004
        },
        {
            "authors": [
                "R. Bekker",
                "P.M. Koeleman"
            ],
            "title": "Scheduling admissions and reducing variability in bed demand",
            "venue": "Health Care Management Science 14 (3), 237\u2013249.",
            "year": 2011
        },
        {
            "authors": [
                "M. Bena\u00efm",
                "J.-Y. Le Boudec"
            ],
            "title": "A class of mean field interaction models for computer and communication systems",
            "venue": "Performance Evaluation 65 (11\u201312), 823\u2013838.",
            "year": 2008
        },
        {
            "authors": [
                "D.P. Bertsekas"
            ],
            "title": "Dynamic programming and optimal control, Volume 1",
            "venue": "Athena Scientific.",
            "year": 1995
        },
        {
            "authors": [
                "D. Bertsimas",
                "D. Gamarnik",
                "J. Sethuraman"
            ],
            "title": "From fluid relaxations to practical algorithms for high-multiplicity job-shop scheduling: The holding cost objective",
            "venue": "Operations Research 51 (5), 798\u2013813.",
            "year": 2003
        },
        {
            "authors": [
                "D. Bertsimas",
                "G. Lukin",
                "L. Mingardi"
            ],
            "title": "COVID-19 mortality risk assessment: An international multi-center study",
            "venue": "PLOS ONE",
            "year": 2020
        },
        {
            "authors": [
                "D. Bertsimas",
                "V.V. Mi\u0161i\u0107"
            ],
            "title": "Decomposable Markov decision processes: A fluid optimization approach",
            "venue": "Operations Research 64 (6), 1537\u20131555.",
            "year": 2016
        },
        {
            "authors": [
                "D. Bertsimas",
                "J. Pauphilet",
                "J. Stevens"
            ],
            "title": "Predicting inpatient flow at a major hospital using interpretable analytics. medRxiv 2020.05.12.20098848v2",
            "year": 2020
        },
        {
            "authors": [
                "D.B. Brown",
                "J.E. Smith"
            ],
            "title": "Index policies and performance bounds for dynamic selection problems",
            "venue": "Management Science 66 (7), 3029\u20133050.",
            "year": 2020
        },
        {
            "authors": [
                "D.B. Brown",
                "J. Zhang"
            ],
            "title": "Dynamic programs with shared resources and signals: Dynamic fluid policies and asymptotic optimality",
            "venue": "Available at SSRN 3728111 .",
            "year": 2020
        },
        {
            "authors": [
                "T.K. Burki"
            ],
            "title": "Cancer guidelines during the COVID-19 pandemic",
            "venue": "The Lancet Oncology 21 (5), 629\u2013630.",
            "year": 2020
        },
        {
            "authors": [
                "F. Caro",
                "J. Gallien"
            ],
            "title": "Dynamic assortment with demand learning for seasonal consumer goods",
            "venue": "Management Science 53 (2), 276\u2013292.",
            "year": 2007
        },
        {
            "authors": [
                "C.W. Chan",
                "V.F. Farias",
                "N. Bambos"
            ],
            "title": "Optimizing intensive care unit discharge decisions with patient readmissions",
            "venue": "Operations Research",
            "year": 2012
        },
        {
            "authors": [
                "P. Christen",
                "J. D\u2019Aeth",
                "A. Lochen"
            ],
            "title": "The J-IDEA pandemic planner: A framework for implementing hospital provision interventions during the COVID-19 pandemic",
            "year": 2021
        },
        {
            "authors": [
                "F. Ciocchetta",
                "A. Degasperi",
                "J. Hillston",
                "M. Calder"
            ],
            "title": "Some investigations concerning the CTMC and the ODE model derived from Bio-PEPA",
            "venue": "Electronic Notes in Theoretical Computer Science 229 (1), 145\u2013163.",
            "year": 2009
        },
        {
            "authors": [
                "J. D\u2019Aeth",
                "S. Ghosal",
                "F. Grimm"
            ],
            "title": "Optimal national prioritization policies for hospital care during the SARS-CoV-2 pandemic",
            "venue": "Nature Computational Science",
            "year": 2021
        },
        {
            "authors": [
                "C. Davis",
                "M. Gao",
                "M. Nichols"
            ],
            "title": "Predicting hospital utilization and inpatient mortality of patients tested for COVID-19",
            "venue": "medRxiv",
            "year": 2020
        },
        {
            "authors": [
                "D.P. De Farias",
                "B. Van Roy"
            ],
            "title": "On constraint sampling in the linear programming approach to approximate dynamic programming",
            "venue": "Mathematics of Operations Research 29 (3), 462\u2013478.",
            "year": 2004
        },
        {
            "authors": [
                "J. D\u00e9ry",
                "A. Ruiz",
                "F. Routhier"
            ],
            "title": "A systematic review of patient prioritization tools in nonemergency healthcare services",
            "venue": "Systematic Reviews",
            "year": 2020
        },
        {
            "authors": [
                "DIVI"
            ],
            "title": "Entscheidungen \u00fcber die Zuteilung von Ressourcen in der Notfall und der Intensivmedizin im Kontext der COVID-19-Pandemie",
            "venue": "https://www.divi.de/joomlatools-files/docman-files/ publikationen/covid-19-dokumente/200325-covid-19-ethik-empfehlung-v1.pdf. Accessed on 1 December 2021.",
            "year": 2020
        },
        {
            "authors": [
                "D.G. Eichberg",
                "A.H. Shah",
                "E.M. Luther"
            ],
            "title": "Letter: Academic neurosurgery department response to COVID-19 pandemic: the University of Miami/Jackson",
            "venue": "Memorial Hospital model. Neurosurgery",
            "year": 2020
        },
        {
            "authors": [
                "K. Fujita",
                "T. Ito",
                "Z. Saito"
            ],
            "title": "Impact of COVID-19 pandemic on lung cancer treatment scheduling",
            "venue": "Thoracic Cancer",
            "year": 2020
        },
        {
            "authors": [
                "Y. Gao",
                "G.-Y. Cai",
                "W. Fang"
            ],
            "title": "Machine learning based early warning system enables accurate mortality risk prediction for COVID-19",
            "venue": "Nature Communications",
            "year": 2020
        },
        {
            "authors": [
                "T. Gardner",
                "C. Fraser"
            ],
            "title": "Elective care in England: Assessing the impact of COVID",
            "venue": "Peytrignet",
            "year": 2020
        },
        {
            "authors": [
                "L.V. Green",
                "S. Savin",
                "N. Savva"
            ],
            "title": "Nursevendor problem\u201d: Personnel staffing in the presence of endogenous absenteeism",
            "venue": "Management Science 59 (10), 2237\u20132256.",
            "year": 2013
        },
        {
            "authors": [
                "D. Haw",
                "P. Christen",
                "G. Forchini"
            ],
            "title": "DAEDALUS: An economic-epidemiological model to optimize economic activity while containing the SARS-CoV-2 pandemic",
            "year": 2020
        },
        {
            "authors": [
                "J.T. Hawkins"
            ],
            "title": "A Langrangian decomposition approach to weakly coupled dynamic optimization problems and its applications",
            "venue": "Ph. D. thesis, Massachusetts Institute of Technology.",
            "year": 2003
        },
        {
            "authors": [
                "J.E. Helm",
                "S. AhmadBeygi",
                "M.P. Van Oyen"
            ],
            "title": "Design and analysis of hospital admission control for operational effectiveness",
            "venue": "Production and Operations Management 20 (3), 359\u2013374.",
            "year": 2011
        },
        {
            "authors": [
                "W. Hu",
                "P.I. Frazier"
            ],
            "title": "An asymptotically optimal index policy for finite-horizon restless bandits",
            "venue": "arXiv preprint arXiv:1707.00205 .",
            "year": 2017
        },
        {
            "authors": [
                "S. Joebges",
                "N. Biller-Andorno"
            ],
            "title": "Ethics guidelines on COVID-19 triage\u2014an emerging international consensus",
            "venue": "Critical Care 24 (1), 201.",
            "year": 2020
        },
        {
            "authors": [
                "Kim",
                "S.-H",
                "C.W. Chan",
                "M. Olivares"
            ],
            "title": "ICU Admission control: An empirical study of capacity allocation and its implication for patient outcomes",
            "venue": "Management Science",
            "year": 2015
        },
        {
            "authors": [
                "A.D. MacCormick",
                "W.G. Collecutt",
                "B.R. Parry"
            ],
            "title": "Prioritizing patients for elective surgery: A systematic review",
            "venue": "ANZ Journal of Surgery 73 (8), 633\u2013642.",
            "year": 2003
        },
        {
            "authors": [
                "C. Maglaras"
            ],
            "title": "Discrete-review policies for scheduling stochastic networks: Trajectory tracking and fluid-scale asymptotic optimality",
            "venue": "The Annals of Applied Probability 10 (3), 897\u2013929.",
            "year": 2000
        },
        {
            "authors": [
                "C. Maglaras",
                "J. Meissner"
            ],
            "title": "Dynamic pricing strategies for multiproduct revenue management problems",
            "venue": "Manufacturing & Service Operations Management 8 (2), 136\u2013148.",
            "year": 2006
        },
        {
            "authors": [
                "J. Marklund"
            ],
            "title": "Lower bounds and heuristics for supply chain stock allocation",
            "venue": "Rosling",
            "year": 2012
        },
        {
            "authors": [
                "R. McCabe",
                "N. Schmit",
                "P. Christen"
            ],
            "title": "Adapting hospital capacity to meet changing demands during the COVID-19 pandemic",
            "venue": "BMC Medicine",
            "year": 2020
        },
        {
            "authors": [
                "F. Meng",
                "J. Qi",
                "M. Zhang"
            ],
            "title": "A robust optimization model for managing elective admission in a public hospital",
            "venue": "Operations Research",
            "year": 2015
        },
        {
            "authors": [
                "S. Miao",
                "S. Jasin",
                "X. Chao"
            ],
            "title": "Asymptotically optimal Lagrangian policies for multi-warehouse multi-store systems with lost sales",
            "venue": "Operations Research, Forthcoming .",
            "year": 2021
        },
        {
            "authors": [
                "D. Moris",
                "E. Felekouras"
            ],
            "title": "Surgery scheduling in a crisis: Effect on cancer patients",
            "venue": "Journal of BUON 25 (4), 2123\u20132124.",
            "year": 2020
        },
        {
            "authors": [
                "M. Nambiar",
                "D. Simchi-Levi",
                "H. Wang"
            ],
            "title": "Dynamic inventory allocation with demand learning for seasonal goods",
            "venue": "Production and Operations Management 30 (3), 750\u2013765.",
            "year": 2021
        },
        {
            "authors": [
                "D. Negopdiev",
                "C. Collaborative",
                "E. Hoste"
            ],
            "title": "Elective surgery cancellations due to the COVID",
            "year": 2020
        },
        {
            "authors": [
                "NHS"
            ],
            "title": "Bed Availability and Occupancy",
            "venue": "https://www.england.nhs.uk/statistics/statisticalwork-areas/bed-availability-and-occupancy/. Accessed on 1 December 2021.",
            "year": 2020
        },
        {
            "authors": [
                "NHS"
            ],
            "title": "COVID-19 Hospital Activity",
            "venue": "https://www.england.nhs.uk/statistics/statisticalwork-areas/covid-19-hospital-activity/. Accessed on 1 December 2021.",
            "year": 2020
        },
        {
            "authors": [
                "NHS"
            ],
            "title": "Critical Care Bed Capacity and Urgent Operations Cancelled",
            "venue": "https://www.england.nhs. uk/statistics/statistical-work-areas/critical-care-capacity/. Accessed on 1 December 2021.",
            "year": 2020
        },
        {
            "authors": [
                "NHS"
            ],
            "title": "Important and Urgent: Next Steps on NHS Response to COVID-19",
            "venue": "https://www.england. nhs.uk/coronavirus/wp- content/uploads/sites/52/2020/03/urgent- next- steps- on- nhsresponse -to-covid-19-letter-simon-stevens.pdf. Accessed on 1 December 2021.",
            "year": 2020
        },
        {
            "authors": [
                "NHS Digital"
            ],
            "title": "Hospital Episode Statistics (HES)",
            "venue": "https://digital.nhs.uk/data-and-information /data-tools-and-services/data-services/hospital-episode-statistics. Accessed on 1 December 2021.",
            "year": 2020
        },
        {
            "authors": [
                "NICE"
            ],
            "title": "COVID-19 Rapid Guideline: Critical Care in Adults",
            "venue": "https://www.nice.org.uk/guidance/ ng159. Accessed on 1 December 2021.",
            "year": 2020
        },
        {
            "authors": [
                "Office for National Statistics"
            ],
            "title": "Past and Projected Period and Cohort Life Tables, 2018-based, UK",
            "venue": "https://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/ lifeexpectancies / bulletins / pastandprojecteddatafromtheperiodandcohortlifetables / 1981to2068. Accessed on 1 December 2021.",
            "year": 2019
        },
        {
            "authors": [
                "H. Ouyang",
                "N.T. Argon",
                "S. Ziya"
            ],
            "title": "Allocation of intensive care unit beds in periods of high demand",
            "venue": "Operations Research 68 (2), 591\u2013608.",
            "year": 2020
        },
        {
            "authors": [
                "P.N. Perez-Guzman",
                "A. Daunt",
                "S. Mukherjee"
            ],
            "title": "Clinical characteristics and predictors of outcomes of hospitalized patients with COVID-19 in a multi-ethnic London NHS Trust: A retrospective cohort study. Clinical Infectious Diseases: An Official Publication of the Infectious Diseases Society of America ciaa1091",
            "year": 2020
        },
        {
            "authors": [
                "J. Phua",
                "L. Weng",
                "L. Ling"
            ],
            "title": "Intensive care management of coronavirus disease 2019 (COVID-19): challenges and recommendations",
            "venue": "The Lancet Respiratory Medicine",
            "year": 2020
        },
        {
            "authors": [
                "M.L. Puterman"
            ],
            "title": "Markov Decision Processes: Discrete Stochastic Dynamic Programming",
            "venue": "John Wiley & Sons.",
            "year": 2014
        },
        {
            "authors": [
                "RCP London"
            ],
            "title": "Safe medical staffing",
            "venue": "https://www.rcplondon.ac.uk/projects/outputs/safemedical-staffing. Accessed on 1 December 2021.",
            "year": 2020
        },
        {
            "authors": [
                "L. Riccioni",
                "G. Bertolini",
                "A. Giannini"
            ],
            "title": "Raccomandazioni di etica clinica per l\u2019ammissione a trattamenti intensivi e per la loro sospensione, in condizioni eccezionali di squilibrio tra necessit\u00e0 e risorse disponibili",
            "venue": "Recenti Progressi in Medicina",
            "year": 2020
        },
        {
            "authors": [
                "D. Rizmie",
                "M. Miraldo",
                "R. Atun"
            ],
            "title": "The effect of extreme temperature on emergency admissions across vulnerable populations in England: An observational study",
            "venue": "The Lancet 394 (Special Issue",
            "year": 2019
        },
        {
            "authors": [
                "Royal College of Nursing"
            ],
            "title": "Staffing levels | Advice guides | Royal College of Nursing",
            "venue": "https://www. rcn.org.uk/get-help/rcn-advice/staffing-levels. Accessed on 1 December 2021.",
            "year": 2020
        },
        {
            "authors": [
                "P. Shi",
                "J. Helm",
                "J. Deglise-Hawkinson"
            ],
            "title": "Timing it right: Balancing inpatient congestion versus readmission risk at discharge",
            "year": 2019
        },
        {
            "authors": [
                "A. Soltany",
                "M. Hamouda",
                "A. Ghzawi"
            ],
            "title": "A scoping review of the impact of COVID-19 pandemic on surgical practice",
            "venue": "Annals of Medicine and Surgery",
            "year": 2020
        },
        {
            "authors": [
                "A. Sud",
                "M.E. Jones",
                "J. Broggio"
            ],
            "title": "Collateral damage: the impact on outcomes from cancer surgery of the COVID-19 pandemic",
            "venue": "Annals of Oncology",
            "year": 2020
        },
        {
            "authors": [
                "The Nuffield Council on Bioethics"
            ],
            "title": "Statement: The Need for National Guidance on Resource Allocation Decisions in the COVID-19 Pandemic",
            "venue": "https://www.nuffieldbioethics.org/news/statementthe- need- for- national- guidance- on- resource- allocation- decisions- in- the- covid- 19pandemic. Accessed on 1 December 2021.",
            "year": 2020
        },
        {
            "authors": [
                "J.N. Tsitsiklis",
                "K. Xu"
            ],
            "title": "On the power of (even a little) resource pooling",
            "venue": "Stochastic Systems 2 (1), 1\u201366.",
            "year": 2012
        },
        {
            "authors": [
                "Tzeng",
                "C.-W. D",
                "M. Teshome",
                "M.H. Katz"
            ],
            "title": "Cancer surgery scheduling during and after the COVID-19 first wave: the MD Anderson cancer center experience",
            "venue": "Annals of Surgery",
            "year": 2020
        },
        {
            "authors": [
                "A. Vaid",
                "S. Somani",
                "A. Russak"
            ],
            "title": "Machine learning to predict mortality and critical events in COVID-19 positive New York City patients: A cohort study",
            "venue": "Journal of Medical Internet Research",
            "year": 2020
        },
        {
            "authors": [
                "D.H. Yoon",
                "S. Koller",
                "P.M.N. Duldulao"
            ],
            "title": "COVID-19 impact on colorectal daily practice\u2014how long will it take to catch up",
            "venue": "Journal of Gastrointestinal Surgery",
            "year": 2020
        },
        {
            "authors": [
                "G. Zayas-Cab\u00e1n",
                "S. Jasin",
                "G. Wang"
            ],
            "title": "An asymptotically optimal heuristic for general nonstationary finite-horizon restless multi-armed, multi-action bandits",
            "venue": "Advances in Applied Probability 51 (3), 745\u2013772.",
            "year": 2019
        }
    ],
    "sections": [
        {
            "text": "The COVID-19 pandemic has seen dramatic demand surges for hospital care that have placed a severe strain on health systems worldwide. As a result, policy makers are faced with the challenge of managing scarce hospital capacity so as to reduce the backlog of non-COVID patients whilst maintaining the ability to respond to any potential future increases in demand for COVID care. In this paper, we propose a nation-wide prioritization scheme that models each individual\n\u2217Contributed Equally \u2020Contributed Equally \u2021Corresponding author: ww@imperial.ac.uk\npatient as a dynamic program whose states encode the patient\u2019s health and treatment condition, whose actions describe the available treatment options, whose transition probabilities characterize the stochastic evolution of the patient\u2019s health and whose rewards encode the contribution to the overall objectives of the health system. The individual patients\u2019 dynamic programs are coupled through constraints on the available resources, such as hospital beds, doctors and nurses. We show that the overall problem can be modeled as a grouped weakly coupled dynamic program for which we determine near-optimal solutions through a fluid approximation. Our case study for the National Health Service in England shows how years of life can be gained by prioritizing specific disease types over COVID patients, such as injury & poisoning, diseases of the respiratory system, diseases of the circulatory system, diseases of the digestive system and cancer.\nKeywords: COVID, Care Prioritization, Grouped Weakly Coupled Dynamic Programs,\nFluid Approximation."
        },
        {
            "heading": "1 Introduction",
            "text": "Across health systems globally, hospitals struggle to meet the demand surges caused by the SARSCoV-2 (hereafter COVID) pandemic. Despite the expansion of hospital capacity (e.g., through field hospitals; McCabe et al. 2020 and Christen et al. 2021) and the implementation of lockdown measures to smooth over time the pressures on care provision, policy makers face an unprecedented challenge in managing scarce hospital capacity and treating non-COVID patients whilst maintaining the ability to respond to any potential future increases in demand for COVID care.\nIn this context, care prioritization policies become vital to mitigate the morbidity and mortality associated with surges of demand overflowing the existing capacity. Prioritization policies are common in health systems where the available resources are insufficient to cope with significant seasonal demand peaks (Rizmie et al., 2019). While those pressures are normally short-lived and do not require a drastic change in care prioritization or investments in extra capacity, the pressures of the COVID pandemic are more severe due to its prolonged duration, the uncertainty in the number of COVID patients that require care, the timing of the demand surges, the intensity of resource usage required to address the needs of COVID patients and the fact that the pandemic impacts the entire population. In response, several countries have deployed a wide range of prioritization policies to delay access to care for some patients who are perceived as requiring less urgent treatment\n(NHS, 2020d; NICE, 2020). The National Health Service (NHS) in England, for example, provided national level guidance on the cancellation of non-urgent elective (i.e., planned) procedures as well as a prioritization to intensive care of COVID patients below the age of 65 and with a high capacity to benefit (Gardner et al., 2020). The ethical guidelines published by the German Interdisciplinary Association for Intensive Care and Emergency Medicine discuss the prioritization to intensive care of COVID patients who do not suffer from severe respiratory illness (DIVI, 2020). The Italian College of Anesthesia, Analgesia, Resuscitation and Intensive Care advised the prioritization to intensive care of COVID patients above 70 years of age that do not have more than one admission per year for a range of diseases (Riccioni et al., 2020). We refer the reader to Joebges and Biller-Andorno (2020) for a review of the prioritization guidelines applied in different countries during 2020.\nThe aforementioned blanket policies tend to prioritize COVID patients in detriment to patients with other diseases without systematically accounting for the trade-offs between the provision of COVID and non-COVID care. For example, non-prioritized patients that see their planned care postponed or canceled might have a higher capacity to benefit from treatment than those prioritized; also, these patients\u2019 diseases might progress considerably while they wait for care, and they may subsequently require emergency or more complex treatment, thus creating further pressures on hospital capacity. As a result, blanket policies are likely to impact morbidity and mortality as well as increase the financial burden on health systems. Against this backdrop, the Nuffield Council on Bioethics, the UK\u2019s main health and healthcare ethics authority, has recently urged policy makers to develop optimal tools and national guidance to best allocate scarce hospital capacity to minimize the detrimental impact the pandemic has on population health (The Nuffield Council on Bioethics, 2020).\nIn this paper, we develop an optimization-based prioritization scheme that schedules patients into general & acute (G&A1) as well as critical care (CC2) so as to minimize overall years of life lost (YLL).3 We consider a national-level scale (rather than an individual hospital) in order to inform strategic public health policy-making, which is particularly relevant in the case of a pandemic affecting an entire country. Our optimization scheme is dynamic and considers weekly patient cohorts subdivided into different patient groups (defined by disease, age group and admission type: elective 1G&A consists of beds allocated for curative care, such as relieving symptoms and managing illnesses or injuries, managing labor, performing surgeries, performing diagnostics and other medical procedures. 2CC refers to a specialized and separate area in a hospital, often called intensive care unit or intensive therapy unit, which is adequately staffed and equipped to manage and monitor patients with life-threatening conditions. 3YLL quantifies the years of life lost due to premature deaths, accounting for the age at which deaths occur.\nand emergency) over a 56-weeks time horizon. We model each patient as a dynamic program (DP) whose states encode the patient\u2019s health status (proxied by the categorization elective/emergency, recovered or deceased) and treatment condition (waiting for treatment, in G&A or in CC), whose actions describe the treatment options (admit or move to G&A or to CC, deny care or discharge from hospital), whose transition probabilities characterize the stochastic evolution of the patient\u2019s health and whose rewards amount to the years of life gained. Our model simultaneously optimizes the treatment of all patients while accounting for capacity constraints on the supply side, including the availability of G&A as well as CC beds and staff (senior doctors, junior doctors and nurses). By clustering the patients into groups (defined through the same arrival time, disease type, age group and admission type) that can each be described through the same DP, we obtain a grouped weakly coupled DP that records for each patient group how many patients are in a particular state, and how many times which action is applied to those patients. We show that the classical fluid relaxation of ordinary weakly coupled DPs applies to grouped weakly coupled DPs as well and gives rise to a linear program (LP) that scales in the number of groups (as opposed to the number of constituent DPs). Moreover, the solutions to this LP allow us to recover near-optimal solutions to the grouped weakly coupled DP with high probability. We demonstrate the power of our modeling framework in a case study of the NHS in England, where we cluster approximately 10 million patients (the entire population in need of care) into 3,360 patient groups whose admission we manage over the course of one year in weekly granularity.\nThe contributions of this paper may be summarized as follows.\n(i) We propose a class of weakly coupled DPs\u2014the grouped weakly coupled DPs\u2014which admit\na fluid relaxation that scales gracefully with the problem data. The fluid relaxation allows us to recover provably high-quality solutions to the grouped weakly coupled DP.\n(ii) We apply our findings to a case study of the NHS in England, where we show how grouped\nweakly coupled DPs allow to prioritize access to elective and emergency care. Our case study appears to be one of the largest and most detailed applications of weakly coupled DPs to date.\n(iii) We publish the data of our case study as well as the source code of our prioritization scheme, so\nthat it is available for researchers, practitioners and policy makers to develop further research and/or inform prioritization policies.\nThis paper is part of two related publications. The accompanying paper (D\u2019Aeth et al., 2021) details our data collection and epidemiological modelling and uses the methodology developed in this paper to assess the effects of policies implemented by the English government to derive policy recommendations for the NHS in England. In contrast, the present paper develops the theoretical foundations of the applied analysis by D\u2019Aeth et al. (2021): we develop the concept of grouped weakly coupled DPs, we propose their approximation via fluid DPs and the subsequent solution via LPs, and we show how to recover provably high-quality solutions to the original grouped weakly coupled DP from solutions to these LPs.\nThe methodology and application of our paper builds upon a rich body of medical and method-\nological literature, which we review in the remainder of this section.\nUnder normal operation, elective care is typically scheduled via prioritization schemes (MacCormick et al., 2003; D\u00e9ry et al., 2020). Recent months have seen a rapidly growing body of literature that discusses the scheduling of elective care surgeries in light of the COVID pandemic. In contrast to our work, which studies hospital care in a broader sense, the majority of that literature focuses on prioritization of COVID care (e.g., Phua et al. 2020) or surgeries (mostly for cancer), with most papers evaluating the impact of the pandemic on elective surgeries (Fujita et al., 2020; Negopdiev et al., 2020; Sud et al., 2020; Yoon et al., 2020), proposing guidelines based on best practices in individual hospitals (Argenziano et al., 2020; Eichberg et al., 2020; Tzeng et al., 2020) or reviewing the guidelines of national authorities (Burki, 2020). These guidelines are developed by domain experts and tend to be qualitative in nature (Moris and Felekouras, 2020; Soltany et al., 2020). In contrast, Bertsimas, Lukin et al. (2020), Bertsimas, Pauphilet et al. (2020), Davis et al. (2020), Gao et al. (2020) and Vaid et al. (2020) employ machine learning techniques (such as support vector machines, tree ensembles and neural networks) to estimate the mortality risk of COVID patients, which can subsequently be used as a proxy of need for patient prioritization. While these contributions are important, they highlight prioritization schemes within a specific disease or subgroup of patients or care settings within a single hospital, and they are static and thus consider neither the dynamic nature of surges in demand nor the complexity of the dynamic needs of patients. In contrast, we propose a national prioritization scheme across all disease groups that accounts for future demand surges and capacity fluctuations as well as the evolution of the patients\u2019 needs over the course of the pandemic, which to the best of our knowledge has not been proposed so far.\nAs an alternative to static prioritization schemes, the operations research literature has studied the dynamic management of G&A and CC capacity via admissions and discharge policies. For example, Bekker and Koeleman (2011) and Meng et al. (2015) propose capacity management policies for G&A beds using queueing theory and robust optimization, Chan et al. (2012), Kim et al. (2015) and Ouyang et al. (2020) develop capacity management policies for CC beds via queueing theory, DPs and simulation, and Helm et al. (2011) and Shi et al. (2019) study hospital-wide capacity management policies using DPs. These approaches aim to optimize the often conflicting goals of short-term and long-term patient welfare as well as hospital costs, subject to constraints on the available resources. In contrast to our work, these papers focus on individual hospitals, which allows them to model hospital operations and within-hospital patients\u2019 care pathways at a finer granularity: admissions and discharge decisions are often taken at an hourly granularity, and some models account for longer-term implications of decisions such as readmissions.\nFrom a methodological viewpoint, our work contributes to the rich theory of weakly coupled DPs, which aim to alleviate the curse of dimensionality that plagues classical DPs (Bertsekas, 1995; Puterman, 2014) by decomposing them into independently evolving constituent DPs that are coupled by a small number of resource constraints. The decomposition of generic weakly coupled DPs appears to have been pioneered by Hawkins (2003). The author shows that by dualizing the coupling constraints, a weakly coupled DP decomposes into set of constituent DPs whose optimal cost to-go functions can be determined efficiently. This insight is used to determine optimal Lagrange multipliers and cost to-go functions for the constituent DPs by an LP or a stochastic subgradient method, and to derive feasible (but suboptimal) policies for the weakly coupled DP via three different heuristics. Adelman and Mersereau (2008) present the problem dual to the LP relaxation proposed by Hawkins (2003), which in our context gives rise to what we term the \u2018fluid relaxation\u2019. They also compare the Lagrangian relaxation of Hawkins (2003) with an LP-based relaxation of the weakly coupled DP that imposes additively separable value functions for all constituent DPs, and they show that the LP-based relaxation, while substantially more challenging to solve due to its exponential number of constraints, provides weakly better bounds than the Lagrangian relaxation. Bertsimas and Mi\u0161i\u0107 (2016) build upon and extend the work of Hawkins (2003) and Adelman and Mersereau (2008) by studying weakly coupled DPs with generic action spaces that do not necessarily result from cross products of the action spaces of the constituent DPs intersected with resource constraints.\nThey show that the Lagrangian and the LP-based relaxations apply to their model as well, and they refine these relaxations by considering partially time-disaggregated formulations as well as higherorder formulations that account for the stochastic dependencies between the constituent DPs.\nThe aforementioned approaches have in common that they do not offer any bounds on the suboptimality incurred by the derived policies, except for their optimality in very specific settings that are mainly of theoretical interest. Indeed, most performance guarantees have been developed for specific classes of weakly coupled DPs. Caro and Gallien (2007) apply the Lagrangian relaxation principle to a finite horizon multi-armed bandit problem in which the decision maker can pull multiple arms in each time period. They use their approach to model a dynamic assortment optimization problem faced by fast fashion companies, who need to decide how to update their assortments throughout the sales season based on the observed demands. Their case study appears to be one of the largest and most detailed real-world applications of weakly coupled DPs to date. Hu and Frazier (2017) and Zayas-Cab\u00e1n et al. (2019) apply the Lagrangian relaxation principle to restless bandit problems where each bandit is governed by the same transition kernel, and they prove asymptotic optimality of the resulting policies as the number of arms approaches infinity. Brown and Smith (2020) study the dynamic selection problem, which is a generalization of the finite horizon restless bandit problem that allows for non-stationary dynamics, and use Lagrangian relaxation to derive a policy whose reward falls short of the optimal one by at most Oprr \u00b4 rs \u00a8 2T \u00a8 ? Nq, where r and r represent upper and lower bounds on the reward achievable by any arm in any time stage, T is the time horizon and N is the maximum number of arms that can be pulled in any time period. Under mild assumptions, this bound implies asymptotic optimality of the derived policy when the number of arms approaches infinity. Marklund and Rosling (2012) and Nambiar et al. (2021) study a supply chain stock allocation problem where an existing inventory is distributed to a number of retailers over a finite time horizon so as to serve stochastic demands. The authors develop a relaxation that aggregates the inventory constraints and enforces feasibility in expectation; this is reminiscent of the Lagrangian decomposition of weakly coupled DPs, which can be shown to enforce the coupling resource constraints in expectation. The authors dualize the remaining expected inventory constraint and thereby decouple the problem into individual problems for each retailer. Their approaches result in lower bounds and feasible policies which incur a suboptimality of OpT 5{2 \u00a8 ? Nq and OpT \u00a8 ? Nq, respectively, where N is the number of retailers and T is the time horizon; in par-\nticular, both the lower bounds and the feasible policies are asymptotically optimal as the number of retailers approaches infinity. These results have subsequently been strengthened by Miao et al. (2021) to a suboptimality of Op ? TN \u00a8 log TNq, who also extend the analysis to a multi-warehouse multi-retailer setting.\nTo our best knowledge, Brown and Zhang (2020) contribute the only prior work that offers suboptimality bounds for generic weakly coupled DPs in the sense of Hawkins (2003). In fact, the authors study a generalization of weakly coupled DPs where an observable signal, which is governed by an exogenous finite-state Markov process, affects the transitions, rewards and/or resource consumption of the constituent DPs. The authors decompose the weakly coupled DP via Lagrangian relaxation and develop an iterative primal-dual algorithm to solve the emerging large-scale fluid LP. They derive a feasible policy whose suboptimality, in the absence of the shared signal, is bounded by Oprr \u00b4 rs \u00a8 2T \u00a8 ? Nq, where r and r represent upper and lower bounds on the rewards achievable by any constituent DP in any time stage, N is the number of constituent DPs and T is the time horizon; in particular, the policy is asymptotically optimal as N approaches infinity.\nOur main methodological contribution is the introduction of grouped weakly coupled DPs, which are weakly coupled DPs whose constituent DPs form groups that share the same transition and reward structure. The existence of groups allows us to solve the fluid relaxations of weakly coupled DPs with millions of constituent DPs, which are beyond the reach of the existing solution approaches. Moreover, our fluid relaxation allows us to recover feasible solutions. As the number N of patients increases, the suboptimality of our feasible policy is bounded by OpT \u00a8 ? N logN ` p|T |2 \u00a8 |L|q{Nq in expectation as well as\u2014in any particular run of the grouped weakly coupled DP\u2014by OpT \u00a8 ? N logNq with high probability; here, T denotes the time horizon. These bounds compare favourably with the existing bounds, and to our best knowledge, similar high-probability bounds for any particular run of a weakly coupled DP have not been discussed in the existing literature.\nWhile the concept of grouped weakly coupled DPs was developed with the outlined healthcare application in mind, we emphasize its applicability in other applications as well, such as B2C marketing where current and prospective customers should be assigned to marketing campaigns based on their purchase likelihood. Here, customers can be modelled as DPs whose states encode the current product portfolio as well as preferences learnt from previous campaigns, and whose actions describe the inclusion to (or exclusion from) a particular campaign.\nBeyond the context of weakly coupled DPs, fluid relaxations have been used in different application domains to study asymptotic settings where the systems under consideration grow in size. Maglaras (2000), for example, studies the fluid relaxation of a multi-class queueing network and derives a policy from the relaxation that is asymptotically optimal as the backlog and the system observation time increase. Bertsimas et al. (2003) consider the fluid relaxation of a high-multiplicity job-shop scheduling problem and derive a policy from the relaxation that is asymptotically optimal as the numbers of jobs from each type increase. Armony and Maglaras (2004) study the optimal operation of contact centers with a real-time telephone service and a postponed call-back service. Using the concept of fluid scaled processes, they develop policies that are asymptotically optimal as the number of agents grows to infinity and the traffic intensity grows to one. Tsitsiklis and Xu (2012) study a multi-server queueing system in which the available resources can be split between centralized and distributed employment. The authors use a fluid relaxation to analyze the benefits of resource pooling, and they show that the behavior of the actual system converges to that of the fluid approximation as the available resources and the arrival rate of the requests increase. Maglaras and Meissner (2006) consider fluid relaxations of multi-product revenue management problems and propose policies for the associated pricing and capacity control problems that are asymptotically optimal as the potential demand and capacity increase. Fluid approximations of counting models have also been studied in performance analysis, where they are known as mean-field approximations (Bena\u00efm and Le Boudec, 2008), and in the analysis of biochemical networks (Ciocchetta et al., 2009).\nThe remainder of the paper proceeds as follows. Section 2 introduces grouped weakly coupled DPs, which will serve as our model of the health system. Section 3 shows that grouped weakly coupled DPs are amenable to a similar fluid approximation as non-grouped weakly coupled DPs, and that this fluid approximation allows us to obtain high-quality solutions to the grouped weakly coupled DP in polynomial time. Section 5 discusses our case study of the NHS in England. Section 6 concludes with a discussion of the limitations of our healthcare model. For ease of exposition, all proofs are relegated to the appendix.\nNotation. For a finite set X \u201c t1, . . . , Xu, we denote by \u2206pX q the set of all probability\ndistributions supported on X , that is, all functions p : X \u00d1 R` satisfying \u0159 xPX ppxq \u201c 1. For a logical expression E , we let 1rEs \u201c 1 if E is true and 1rEs \u201c 0 otherwise."
        },
        {
            "heading": "2 Grouped Weakly Coupled Dynamic Programs",
            "text": "We first review how multiple DPs, each of which competes for the same set of resources, can be aggregated to a weakly coupled DP. We subsequently introduce the notion of a grouped weakly coupled DP, which stipulates that some of the DPs within a weakly coupled DP share the same characteristics. Section 3 will develop a fluid approximation for grouped weakly coupled DPs whose tightness is directly related to the sizes of these groups. Our healthcare application in Section 5, finally, will model individual patients as DPs, and patients with similar characteristics (arrival time, age group and disease type) will naturally form groups.\nWe model individual patients, which form the basis of our healthcare model, as DPs whose states record the patient\u2019s health (elective/emergency, recovered or deceased) and treatment state (waiting for treatment, in G&A or in CC), whose actions describe the treatment options (admit or move to G&A or to CC, deny care or discharge from hospital), whose transition probabilities characterize the stochastic evolution of the patient\u2019s health and whose rewards amount to the years of life gained.\nDefinition 1 (DP). For a finite time horizon T \u201c t1, . . . , T u, a DP is specified by the tuple pS,A, q, p, rq, where S \u201c t1, . . . , Su denotes the finite state space, A \u201c t1, . . . , Au is the finite action space with Atpsq \u010e A the admissible actions in state s P S at time t P T , q P \u2206pSq are the initial state probabilities, p \u201c tptut with pt : S \u02c6 A \u00d1 \u2206pSq, t P T , are the Markovian transition probabilities, and r \u201c trtut with rt : S \u02c6 A \u00d1 R, t P T , are the expected rewards.\nIn a DP, a policy \u03c0 \u201c t\u03c0tut with \u03c0t : S \u00d1 A specifies for each time period t P T and each state\ns P S what action \u03c0tpsq P A is taken. A feasible policy \u03c0 must satisfy \u03c0tpsq P Atpsq for all t P T and s P S. Under the policy \u03c0, a DP evolves as follows. The initial state s\u03031 is random and satisfies Prs\u03031 \u201c ss \u201c qpsq for s P S. For t P T ztT u, the transitions are governed by\nP \u201c s\u0303t`1 \u201c s1 \u2030 \u201c \u00ff sPS ptps1 | s, \u03c0tpsqq \u00a8 P rs\u0303t \u201c ss @s1 P S.\nThe expected total reward of a policy \u03c0 is E r \u0159 tPT rtps\u0303t, \u03c0tps\u0303tqqs.\nExample 1 (DP). Figure 1 illustrates a DP with the states 1 and 2 and the actions A (admissible in both states) and B (admissible in state 2 only). Under action A, the system transitions to either\nstate with probability 1/2, whereas the system remains in state 2 if action B is taken. The expected rewards are rtp1,Aq \u201c 0 and rtp2,Aq \u201c rtp2,Bq \u201c 1. As a result, the unique optimal policy \u03c0 takes action A in state 1 and action B in state 2, respectively.\nOur healthcare model combines all individual patient DPs to a single DP that records the state of each patient while also restricting the admissible policies to those that satisfy certain resource constraints (e.g., the availability of G&A and CC beds, nurses and doctors).\nDefinition 2 (Weakly Coupled DP). For a finite set of DPs pSi,Ai, qi, pi, riq, i P I \u201c t1, . . . , Nu, over the same time horizon T \u201c t1, . . . , T u, the weakly coupled DP ptSi,Ai, qi, pi, riuiq is the DP pS,A, q, p, rq with state space S \u201c \u015a\niPI Si, action space A \u201c \u015a iPI Ai with Atpsq \u201c \u015a iPI Aitpsiq,\ns P S, and\nACt psq \u201c # a P Atpsq : \u00ff\niPI ctlipsi, aiq \u010f btl @l P L\n+\n,\ninitial state probabilities qpsq \u201c \u015b iPI qipsiq for s P S, transition probabilities ptps1 | s, aq \u201c \u015b iPI pitps1i | si, aiq for s, s1 P S and a P A and expected rewards rtps, aq \u201c \u0159 iPI ritpsi, aiq.\nWeakly coupled DPs have been studied, among others, by Hawkins (2003) and Adelman and Mersereau (2008). In a weakly coupled DP, the admissible actions a P ACt psq in state s P S must satisfy the constraints ai P Aitpsiq of the individual DPs i P I as well as the coupling resource constraints a P ACt psq. In particular, the feasibility of an action ai P Ai for the i-th constituent DP is not just determined by the state si P Si, but it depends (through the resource constraints) on the states si1 P Si1 , i1 P Iztiu, of the other constituent DPs as well. The constraints in ACt allow us to model the resource consumption of individual patients (such as a G&A or CC bed, as well as fractions of doctor and nurse times \u2013 each of which can be modeled as a distinct resource l P L). Throughout the paper, we assume that ctli \u011b 0 as well as btl \u0105 0 for all t P T , l P L and i P I.\nIn a weakly coupled DP, a policy \u03c0 \u201c t\u03c0tut with \u03c0t : S \u00d1 A specifies for each time period t P T ,\neach DP i P I and each state s P S what action r\u03c0tpsqsi P Ai is selected. A feasible policy \u03c0 must satisfy \u03c0tpsq P ACt psq for all t P T and s P S. We emphasize that the policy can choose the action r\u03c0tpsqsi P Ai for the i-th DP in view of the states of all other constituent DPs, rather than just the state si; this is important in view of satisfying the coupling constraints. Under \u03c0, a weakly coupled DP evolves as follows. The initial state s\u03031 is random and satisfies Prs\u03031 \u201c ss \u201c \u015b iPI qipsiq \u201c qpsq for s P S. For t P T ztT u, the transitions are governed by\nP \u201c s\u0303t`1 \u201c s1 \u2030 \u201c \u00ff\nsPS\n\u00ab\n\u017a iPI pitps1i | si, r\u03c0tpsqsiq\nff\n\u00a8P rs\u0303t \u201c ss \u201c \u00ff sPS ptps1 | s, \u03c0tpsqq\u00a8P rs\u0303t \u201c ss @s1 P S.\nThe expected total reward of a policy \u03c0 is E r \u0159 tPT rtps\u0303t, \u03c0tps\u0303tqqs.\nExample 2 (Weakly Coupled DP). Figure 3 combines the DP from Example 1 with the DP from Figure 2 to a weakly coupled DP that is subjected to the resource constraint 1rs1 \u201c 2 ^ a1 \u201c\nBs ` 1rs2 \u201c 4 ^ a2 \u201c Ds \u010f 1, that is, at most one of the actions B and D can be selected in any period. As a result, every optimal policy \u03c0 selects one of the actions B or D (but not both) whenever they are admissible.\nSince it offers a lossless aggregation of its constituent DPs, the state and action spaces of a\nweakly coupled DP exhibit an undesirable scaling behavior:\n|S| \u201c \u017a\niPI |Si| and |A| \u201c\n\u017a iPI |Ai|\nThe health system that we intend to model contains approximately 10 million patient DPs with 15 possible states and 6 possible actions each, thus resulting in a weakly coupled DP with approximately 1510,000,000 states and 610,000,000 actions. Clearly, such a weakly coupled DP is not by itself amenable to an exact solution via one of the standard approaches such as value or policy iteration. In fact, even its approximate solution via Lagrangian relaxation (Hawkins, 2003; Adelman and Mersereau, 2008) remains challenging since the numbers of variables and constraints in the associated fluid relaxation scale linearly in the number of constituent DPs.\nOur proposed fluid approximation for weakly coupled DPs relies on the following assumption,\nwhich stipulates that many of the DPs in the weakly coupled DP share the same dynamics.\nAssumption 1 (Grouped Weakly Coupled DP). For the weakly coupled DP of Definition 2, we assume that there are J ! N groups such that each DP i P I belongs to exactly one of the groups j P J \u201c t1, . . . , Ju, and any two DPs of the same group share the same state and action spaces, initial state and transition probabilities as well as expected rewards.\nAssumption 1 implies that there exists a bijection between the set I of all DPs in the weakly coupled DP and the pairs pj, iq P J \u02c6t1, . . . , nju that index the DPs i P t1, . . . , nju belonging to the same group j P J . This bijection is unique up to reorderings of the groups as well as the DPs within each group. In the following, we fix any such bijection and refer to individual DPs of the grouped weakly coupled DP via their index pairs pj, iq, and we denote the common description of the DPs in group j P J by pSj ,Aj , qj , pj , rjq. Our healthcare application will comprise approximately 10 million patients that form 3,360 patient groups characterized by the same arrival time t P T as well as the same age group and disease type. It will then be natural to assume that the patients of the same patient group follow similar dynamics, as specified by the initial state and transition\nprobabilities, and lead to similar conditional health outcomes, as specified by the expected rewards."
        },
        {
            "heading": "3 Fluid Approximation",
            "text": "Grouped weakly coupled DPs lend themselves to a linear programming approximation which is particularly suitable when the number N of DPs is large relative to the number J of groups, as is the case in our healthcare application. In the following, Section 3.1 develops and motivates this approximation, and Section 3.2 shows that the approximation allows us to recover high-quality solutions to the weakly coupled DP with high probability."
        },
        {
            "heading": "3.1 Linear Programming Formulation",
            "text": "Fix a weakly coupled DP ptSi,Ai, qi, pi, riuiq satisfying Assumption 1. In any time period t P T and state st P S, the feasible policies \u03c0 \u201c t\u03c0\u03c4uT\u03c4\u201ct that maximize the expected total reward over the remaining time horizon \u03c4 P tt, . . . , T u are precisely the maximizers of the value equation\nVtpstq \u201c max \u03c0\n#\nE\n\u00ab\nT \u00ff\n\u03c4\u201ct\n\u00ff\njPJ\nnj \u00ff i\u201c1 rj\u03c4 ps\u0303\u03c0\u03c4,pj,iq, a\u0303 \u03c0 \u03c4,pj,iqq \u02c7 \u02c7 \u02c7 s\u0303\u03c0t \u201c st\nff\n:\n\u03c0\u03c4 : S \u00d1 A with \u03c0\u03c4 psq P AC\u03c4 psq @s P S, @\u03c4 \u201c t, . . . , T + ,\nwhere s\u0303\u03c0\u03c4,pj,iq and a\u0303 \u03c0 \u03c4,pj,iq denote the random state and action of the i-th DP in group j at time \u03c4 under the policy \u03c0, respectively. We next consider a Lagrangian relaxation that penalizes violations of the resource constraints with a non-negative penalty \u03bb \u201c t\u03bb\u03c4lu\u03c4,l:\nV \u03bbt pstq \u201c max\u03c0\n#\nE\n\u00ab\nT \u00ff\n\u03c4\u201ct\n\u00ff\njPJ\nnj \u00ff i\u201c1 rj\u03c4 ps\u0303\u03c0\u03c4,pj,iq, a\u0303 \u03c0 \u03c4,pj,iqq `\nT \u00ff\n\u03c4\u201ct\n\u00ff lPL \u03bb\u03c4l\n\u02dc\nb\u03c4l \u00b4 \u00ff\njPJ\nnj \u00ff i\u201c1 c\u03c4ljps\u0303\u03c0\u03c4,pj,iq, a\u0303 \u03c0 \u03c4,pj,iqq\n\u00b8\n\u02c7 \u02c7 \u02c7 s\u0303\u03c0t \u201c st\nff\n: (1)\n\u03c0\u03c4 : S \u00d1 A with \u03c0\u03c4 psq P A\u03c4 psq @s P S, @\u03c4 \u201c t, . . . , T + ,\nwhere we denote by c\u03c4lj , \u03c4 P T , l P L and j P J , the common resource consumption function c\u03c4li shared by all DPs pj, iq, i \u201c 1, . . . , nj , of group j. In contrast to the previous value equation, (1)\nonly requires the policy \u03c0 to satisfy the constraints r\u03c0\u03c4 psqsi P Ai\u03c4 psiq for the individual DPs i P I, whereas violations of the coupling resource constraints are tolerated (but penalized).\nThe following statement is well-known and summarized for convenience only.\nProposition 1. The Lagrange value function (1) satisfies the following.\n(i) Weak Duality. We have V \u03bbt pstq \u011b Vtpstq for all t P T and st P S.\n(ii) Decomposition. We have\nV \u03bbt pstq \u201c T \u00ff\n\u03c4\u201ct\n\u00ff lPL \u03bb\u03c4lb\u03c4l ` \u00ff jPJ\nnj \u00ff i\u201c1 V \u03bbt,pj,iqpst,pj,iqq @t P T , @st P S, (2)\nwhere the DP-wise value functions V \u03bbt,pj,iq, pj, iq P J \u02c6 t1, . . . , nju and t P T , satisfy\nV \u03bbt,pj,iqpsq \u201c max aPAjtpsq\n$ &\n%\nrjtps, aq \u00b4 \u00ff\nlPL \u03bbtlctljps, aq `\n\u00ff\ns1PSj\npjtps1 | s, aq \u00a8 V \u03bbt`1,pj,iqps 1q\n, .\n-\n@s P Sj\nand V \u03bbT`1,pj,iqpsq \u201c 0, s P Sj.\nThe first property of Proposition 1 follows immediately from the fact the Lagrangian value equation results from a relaxation of the original value equation. The second property shows that by relaxing the coupling resource constraints, the Lagrangian value function decomposes into a sum of individual value functions for each constituent DP pj, iq P J \u02c6 t1, . . . , nju. Note that in our case, all DP-wise value functions V \u03bbt,pj,iqpsq, i P t1, . . . , nju, of the same group j P J are identical by construction, and they can thus be replaced by a single function V \u03bbtj satisfying\nV \u03bbtj psq \u201c max aPAjtpsq\n$ &\n%\nrjtps, aq \u00b4 \u00ff\nlPL \u03bbtlctljps, aq `\n\u00ff\ns1PSj\npjtps1 | s, aq \u00a8 V \u03bbt`1,jps1q\n, .\n-\n@s P Sj ,\nt P T , with V \u03bbT`1,jpsq \u201c 0, s P Sj . Following standard results from the literature on weakly coupled DPs (see, e.g., p. 5 of Adelman and Mersereau, 2008), we can then formulate the problem that\nmaximizes the Lagrangian relaxation over all non-negative penalties as the following LP:\nminimize \u03bb, V \u03bb\n\u00ff\ntPT\n\u00ff lPL \u03bbtlbtl ` \u00ff jPJ \u00ff sPSj nj \u00a8 qjpsq \u00a8 V \u03bb1jpsq\nsubject to V \u03bbtj psq \u011b rjtps, aq \u00b4 \u00ff\nlPL \u03bbtlctljps, aq `\n\u00ff\ns1PSj\npjtps1 | s, aq \u00a8 V \u03bbt`1,jps1q @t P T , @j P J ,\n@s P Sj , @a P Ajtpsq\n\u03bbtl \u011b 0 @t P T , @l P L V \u03bbT`1,jpsq \u201c 0 @j P J , @s P Sj (3)\nWe emphasize that the numbers of decision variables and constraints in this LP scale with the number of time periods T , the number of DP groups J , the number of resources L as well as the sizes of the individual state and action spaces, but they do not depend on the number N of constituent DPs anymore. This is an immediate consequence of Assumption 1 and Proposition 1, and it will be fundamental to the tractability of our approach.\nFor the subsequent analysis it is more convenient to work with the problem dual to the La-\ngrangian relaxation (3).\nProposition 2 (Fluid LP). The strong linear programming dual of problem (3) is\nmaximize \u03c3, \u03c0\n\u00ff\ntPT\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nrjtps, aq \u00a8 \u03c0tjps, aq\nsubject to \u03c31jpsq \u201c nj \u00a8 qjpsq @j P J , @s P Sj \u03c3t`1,jps1q \u201c \u00ff\nsPSj\n\u00ff\naPAj\npjtps1 | s, aq \u00a8 \u03c0tjps, aq @j P J , @s1 P Sj , @t P T ztT u\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nctljps, aq \u00a8 \u03c0tjps, aq \u010f btl @l P L, @t P T\n\u00ff\naPAj\n\u03c0tjps, aq \u201c \u03c3tjpsq @j P J , @s P Sj , @t P T\n\u03c0tjps, aq \u201c 0 @j P J , @s P Sj , @a P AjzAjtpsq, @t P T \u03c3tjpsq, \u03c0tjps, aq \u011b 0 @j P J , @ps, aq P Sj \u02c6 Aj , @t P T . (4)\nThe dual LP comprises O \u00b4 |T | \u00a8 \u0159 jPJ |Sj ||Aj | \u00af decision variables and O \u00b4 |T | \u00a8 max ! \u0159 jPJ |Sj |, |L| )\u00af\nconstraints. Our healthcare model comprises |T | \u201c 56 time periods (one year in weekly granularity, plus 4 weeks to alleviate end-of-horizon effects), |J | = 3,360 groups (56 arrival times, 3 age groups and 20 disease groups) with |Sj | \u201c 15 states and |Aj | \u201c 6 each, as well as |L| \u201c 8 resources (senior\nand junior doctors, nurses as well as beds for both G&A and CC separately). The resulting LP, while nontrivial in size, can be solved quickly and reliably on standard hardware with off-the-shelf LP solvers.\nThe fluid LP (4) has a natural interpretation. The decision variables \u03c3tjpsq record for each DP group j P J the expected number of DPs pj, iq that are in state s P Sj in time period t P T , and the decision variables \u03c0tjps, aq determine how often each admissible action a P Ajtpsq is applied in expectation to the DPs accounted for by \u03c3tjpsq. The objective function of (4) maximizes the expected total rewards, and the first four constraints (in order) ensure that \u03c31j adheres to the initial state distributions qj , the one-step evolutions respect the transition probabilities pjt as well as the selected policy \u03c0tj , the resource constraints are met and that no DPs \u2018disappear\u2019 in any time period, respectively."
        },
        {
            "heading": "3.2 Approximation Guarantees and Feasible Policies",
            "text": "By construction, the fluid LP (4) constitutes a relaxation of the grouped weakly coupled DP in the sense that the optimal objective value of (4) bounds the largest achievable expected total reward in the grouped weakly coupled DP from above, and a feasible solution to (4) does not necessarily correspond to a feasible policy for the grouped weakly coupled DP. We now investigate how tight the approximation offered by the fluid LP (4) is, and how optimal solutions to (4) allow us to construct near-optimal policies for the grouped weakly coupled DP.\nRecall that a deterministic policy \u03c0 \u201c t\u03c0tut, \u03c0t : S \u00d1 A, for the grouped weakly coupled DP assigns an action a P A to each possible state s P S in each time period t P T . We now utilize an optimal solution p\u03c3LP, \u03c0LPq to the fluid LP (4) to construct a randomized policy \u03c0\u2039 \u201c t\u03c0\u2039t ut, \u03c0\u2039t : S \u00d1 \u2206pAq, for the grouped weakly coupled DP that assigns a probability distribution over all actions a P A to each possible state s P S for each time period t P T as follows:\nr\u03c0\u2039t psqspaq \u201c \u017a\njPJ\nnj \u017a\ni\u201c1\n\u03c0LPtj pspj,iq, apj,iqq \u03c3LPtj pspj,iqq\n@t P T , @ps, aq P S \u02c6 A (5)\nHere, we adopt the convention that 0{0 \u201c 0. Intuitively speaking, \u03c0\u2039 considers each constituent DP pj, iq P J \u02c6 t1, . . . , nju independently, and it employs each action apj,iq P Apj,iq with a probability that equals the fraction of times this action is selected for DPs in group j that reside in the same\nstate spj,iq as the DP pj, iq at time period t in the fluid LP (4). One readily verifies from the constraints of the fluid LP (4) that for all t P T and s P S, the policy \u03c0\u2039t indeed defines a probability distribution over A.\nUnder \u03c0\u2039, the grouped weakly coupled DP evolves as follows. The initial state s\u03031 is random and\nsatisfies Prs\u03031 \u201c ss \u201c qpsq for s P S. For t P T ztT u, the transitions are governed by\nP \u201c s\u0303t`1 \u201c s1 \u2030 \u201c \u00ff\nsPS\n\u00ff aPA r\u03c0\u2039t psqspaq \u00a8 ptps1 | s, aq \u00a8 P rs\u0303t \u201c ss @s1 P S.\nThe expected total reward of \u03c0\u2039 is E r \u0159 tPT \u0159 aPAr\u03c0\u2039t ps\u0303tqspaq \u00a8 rtps\u0303t, aqs.\nWe now study the performance of \u03c0\u2039 in the grouped weakly coupled DP. Our results make use of the random state s\u0303t,pj,iq of the pj, iq-th DP and the random action a\u0303t,pj,iq applied to this DP in time period t, respectively. Recall that N \u201c \u0159\njPJ nj denotes the total number of constituent DPs\nin the grouped weakly coupled DP.\nTheorem 1 (Infeasible Randomized Policy; Expected Total Reward). Denote by \u03b8\u2039 and \u03b8DP the expected total reward of the randomized policy \u03c0\u2039 and an optimal policy for the grouped weakly coupled DP, respectively. We then have\n\u03b8\u2039 \u011b \u03b8DP\nas well as, with probability at least 1 \u00b4 |T | \u00a8 |L| {N2,\n\u00ff\njPJ\nnj \u00ff i\u201c1 ctljps\u0303t,pj,iq, a\u0303t,pj,iqq \u010f btl ` a N logN \u00a8 max jPJ \u2225ctlj\u22252 @t P T , @l P L,\nwhere the 2-norm is taken over the components ctljps, aq, ps, aq P Sj \u02c6 Aj, of ctlj.\nTheorem 2 (Infeasible Randomized Policy; Worst-Case Total Reward). Denote by \u03b8\u0303\u2039 the random total reward of the randomized policy \u03c0\u2039 and by \u03b8DP the expected total reward of an optimal policy for the grouped weakly coupled DP, respectively. Then, jointly with probability at least 1\u00b4|T |p|L|`1q{N2,\n\u03b8\u0303\u2039 \u011b \u03b8DP \u00b4 |T | \u00a8 a\nN logN \u00a8 max tPT , jPJ \u2225rjt\u22252 ,\nwhere the 2-norm is taken over the components rjtps, aq, ps, aq P Sj \u02c6 Aj, of rjt, as well as\n\u00ff\njPJ\nnj \u00ff i\u201c1 ctljps\u0303t,pj,iq, a\u0303t,pj,iqq \u010f btl ` a N logN \u00a8 max jPJ \u2225ctlj\u22252 @t P T , @l P L,\nwhere the 2-norm is taken over the components ctljps, aq, ps, aq P Sj \u02c6 Aj, of ctlj.\nWhile Theorem 1 shows that the expected total reward \u03b8\u2039 of the randomized policy weakly exceeds the expected total reward of an optimal policy for the grouped weakly coupled DP, Theorem 2 shows that the actually realized total reward \u03b8\u0303\u2039 of the randomized policy falls significantly short of the expected total reward of an optimal policy for the grouped weakly coupled DP with low probability only. We are not aware of such worst-case bounds in the literature.\nTo interpret the above performance guarantees in light of our healthcare model, consider an asymptotic setting where N \u00d1 8 and where the available resources btl 9N scale in the number of patients to be treated. This corresponds to a healthcare system where the number of patients increases and where the available resources increase proportionately. In contrast, we assume that the number |T | of time periods, the number |J | of patient groups as well as the number of states |Sj | and actions |Aj | per patient group remain constant. In this setting, the probabilities 1\u00b4|T |\u00a8|L| {N2 and 1 \u00b4 |T |p|L| ` 1q{N2 in Theorems 1 and 2 approach 1. Since N \u00a8 |T | \u00a8 mintrjtps, aq : j P J , t P T and ps, aq P Sj \u02c6 Aju \u010f \u03b8DP \u010f N \u00a8 |T | \u00a8 maxtrjtps, aq : j P J , t P T and ps, aq P Sj \u02c6 Aju, the expected total reward \u03b8DP of the grouped weakly coupled DP under any optimal policy scales with N \u00a8 |T |. Since maxjPJ \u2225ctlj\u22252 and maxtPT , jPJ \u2225rjt\u22252 remain constant, the resource violations grow according to ? N logN and hence sublinearly in the number N of patients, that is, they vanish on a relative scale. The same applies for the suboptimality in the case of the worst-case bound, which however involves the additional factor |T |. The results also reveal the price to be paid when moving from a guarantee in expectation (cf. Theorem 1) to a guarantee in terms of the worst case (cf. Theorem 2): while the expected total reward \u03b8\u2039 of the randomized policy \u03c0\u2039 weakly exceeds the optimal expected total reward \u03b8DP, with high probability the worst-case total reward \u03b8\u0303\u2039 falls short of \u03b8DP by a quantity that only grows sublinearly in the number N of patients. Note that in our application, the number |T | of time periods impacts the number |J | of patient groups as patients arriving at different times are assigned to different patient groups, even if they are otherwise homogeneous. Thus our approximation guarantees depend on the selected time granularity (e.g.,\nweekly vs. daily time periods). We note that the bounds of Theorems 1 and 2, as well as the results below that build upon those theorems, can be refined by replacing maxjPJ \u2225ctlj\u22252 and maxtPT , jPJ \u2225rjt\u22252 with maxjPJ \u2225ctlj \u00b4 c\u0302tlj\u22252 and maxtPT , jPJ \u2225rjt \u00b4 r\u0302jt\u22252, where c\u0302tlj and r\u0302jt can be arbitrary constants, such as the means of the costs c\u0302tlj \u201c 1|Sj |\u00a8|Aj | \u0159 sPSj \u0159 aPAj ctljps, aq and expected rewards r\u0302jt \u201c 1|Sj |\u00a8|Aj | \u0159 sPSj \u0159 aPAj rjtps, aq, respectively. Indeed, Lemma 2 in the appendix\u2014which provides the foundation of both theorems\u2014considers this more general formulation.\nThe randomized policy constructed thus far will likely violate the resource constraints. As long as the resource violations are small, as is guaranteed to be the case with high probability by Theorems 1 and 2, they are likely to be acceptable in our healthcare application since the resource limits are themselves uncertain and subject to measurement inaccuracies, and the resources in our healthcare application tend to be, within certain limits, expandable. That said, we next construct a near-optimal randomized policy \u03c0F \u201c t\u03c0Ft ut, \u03c0Ft : S \u00d1 \u2206pAq, for the grouped weakly coupled DP that is guaranteed to be feasible. To this end, we first reduce the resource limits btl in the fluid LP to\nbredtl \u201c \u201e btl \u00b4 a\nN logN \u00a8 max jPJ \u2225ctlj\u22252\n\u0237\n` @t P T , @l P L, (6)\nwhere rxs` \u201c maxtx, 0u. We then construct an auxiliary policy \u03c0red from an optimal solution to the fluid LP with the updated resource limits bredtl as in equation (5). Theorems 1 and 2 guarantee that \u03c0red satisfies all resource constraints across all time periods with probability at least 1\u00b4|T |\u00a8|L| {N2. In order to construct a policy \u03c0F that is feasible with certainty, we require for each time period t P T and each state s P S of the grouped weakly coupled DP the existence of an action a P ACt psq that satisfies the original resource constraints with right-hand sides btl. A sufficient condition is the existence of designated \u2018do-nothing\u2019 actions as per the following assumption.\nAssumption 2 (\u2018Do-Nothing\u2019 Actions). We assume that for each DP group j P J there is a \u2018donothing\u2019 action a0j P Aj that is feasible (although, possibly, heavily penalized) in every state sj P Sj and that does not consume any resources.\nIn the context of our healthcare application, the do-nothing action could imply that a waiting patient has to wait for another week for her treatment, or that a patient currently under treatment is sent home. We then construct the feasible policy \u03c0F from the auxiliary policy \u03c0red as follows: in each time period t P T and for each state-action pair ps, aq P S\u02c6A with positive probability r\u03c0redt psqspaq \u0105\n0, if action a violates the resource limits tbtlut,l, then we shift the probability mass assigned to action a to any alternative actions a1 that satisfy them. If do-nothing actions (cf. Assumption 2) exist, then the alternative actions can be constructed, for example, by assigning do-nothing actions to random patients until the original resource limits btl are met.\nProposition 3 (Feasible Randomized Policy; Expected Total Reward). Denote by \u03b8F and \u03b8DP the expected total reward of the feasible randomized policy \u03c0F and an optimal policy for the grouped weakly coupled DP, respectively. We then have\n\u03b8F \u011b \u03b8DP \u00b4 c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u2225ctlj\u22252\n*\n\u00a8 p\u03b8DP \u00b4 N \u00a8 |T | \u00a8 rq \u00b4 |T | 2 \u00a8 |L| \u00a8 pr \u00b4 rq\nN ,\nwhere the 2-norm is taken over the components ctljps, aq, ps, aq P Sj \u02c6Aj, of ctlj, r \u201c mintrjtps, aq : j P J , t P T and ps, aq P Sj \u02c6 Aju and r \u201c maxtrjtps, aq : j P J , t P T and ps, aq P Sj \u02c6 Aju.\nProposition 4 (Feasible Randomized Policy; Worst-Case Total Reward). Denote by \u03b8\u0303F the random total reward of the feasible randomized policy \u03c0F and by \u03b8DP the expected total reward of an optimal policy for the grouped weakly coupled DP, respectively. We then have\n\u03b8\u0303F \u011b \u03b8DP \u00b4 c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u2225ctlj\u22252\n*\n\u00a8 p\u03b8DP \u00b4 N \u00a8 |T | \u00a8 rq\n\u00b4 |T | \u00a8 a\nN logN \u00a8 max tPT , jPJ \u2225rjt\u22252\nwith probability at least 1 \u00b4 |T | \u00a8 p|L| ` 1q{N , where we use the notation of Proposition 3 and where the second 2-norm is taken over the components rjtps, aq, ps, aq P Sj \u02c6 Aj, of rjt.\nNote that the expected total reward in Proposition 3 decreases by\nc\nlogN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u2225ctlj\u22252\n*\n\u00a8 p\u03b8DP \u00b4 N \u00a8 |T | \u00a8 rq ` |T | 2 \u00a8 |L| \u00a8 pr \u00b4 rq\nN\nwhen compared to its infeasible counterpart from Theorem 1. The first term upper bounds the reduction in the optimal value of the fluid LP (4) caused by reducing the resource limits from tbtlut,l to tbredtl ut,l, whereas the second term upper bounds the reduction in expected total reward caused by moving from the infeasible auxiliary policy \u03c0red to the feasible randomized policy \u03c0F. In contrast,\nthe worst-case total reward in Proposition 4 only decreases by\nc\nlogN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u2225ctlj\u22252\n*\n\u00a8 p\u03b8DP \u00b4 N \u00a8 |T | \u00a8 rq\nwhen compared to its infeasible counterpart from Theorem 2. Indeed, while the event that the auxiliary policy \u03c0red is infeasible must be accounted for in the expected total reward bound (cf. Proposition 3), it can be disregarded in the consideration of the random total reward (cf. Proposition 4) since it occurs with low probability, and the bound on the random total reward is only guaranteed to hold with high probability (as opposed to almost surely).\nIn order to judge the extent to which the policy \u03c0F sacrifices optimality in favor of feasibility, consider again an asymptotic setting where N \u00d1 8 as well as btl 9N . Since N \u00a8|T |\u00a8r \u010f \u03b8DP \u010f N \u00a8|T |\u00a8 r, we have \u03b8DP 9N \u00a8 |T |. Thus, the additional decrease in expected total reward (cf. Proposition 3) scales according to |T | \u00a8 ? N logN `|T |2 \u00a8 |L| {N , whereas the additional decrease in worst-case total reward (cf. Proposition 4) grows according to |T | \u00a8 ? N logN . In conclusion, the suboptimality of \u03c0F continues to grow sublinearly in N , and \u03c0F is asymptotically optimal as well. Table 1 summarizes the performance guarantees of the policies \u03c0\u2039 and \u03c0F offered by Theorems 1 and 2 as well as Propositions 3 and 4.\nRemark 1. Our construction of the feasible policy \u03c0F relies on reducing the available resources from\ntbtlut,l to tbredtl ut,l. This construction is inspired by the work of Zayas-Cab\u00e1n et al. (2019), who apply a similar idea in the context of a restless bandit problem where all bandits are governed by the same transition kernel. The main differences are that Zayas-Cab\u00e1n et al. (2019) consider a single class of bandits (whereas we model multiple groups of patients), and they consider a single resource constraint for each time period that imposes an upper bound on the number of applied actions (whereas we allow for multiple resource constraints per time period that can weigh actions differently).\nRemark 2. If the number N of constituent DPs in the grouped weakly coupled DP is small or moderate, then the resource reduction from tbtlut,l to tbredtl ut,l can be significant, and the feasible randomized policy \u03c0F may under-utilize the factually existing resources tbtlut,l. In such cases, a better performance may be obtained if we modify the feasible randomized policy \u03c0F by shifting probability mass from actions that under-utilize the factual resource limits tbtlut,l to other actions that \u2018make better use\u2019 of the available resources. Here, the interpretation of a \u2018better use\u2019 of resources is heuristic and dependent on the application: we will outline a simple heuristic in the context of our synthetic experiment (Section 4), whereas we find that our feasible randomized policy \u03c0F does not require any adaptation in the context of our healthcare case study (Section 5). Note that the modified policy outlined in this remark no longer enjoys the a priori guarantees of Propositions 3 and 4; one can nevertheless compute its performance on a specific problem instance a posteriori using simulation."
        },
        {
            "heading": "4 Synthetic Experiment",
            "text": "To obtain further insights into our randomized policy from Section 3.2, we compare our policy with some standard weakly coupled DP policies from the literature on a stylized problem. To this end, consider a multi-armed bandit problem with a finite time horizon T P t5, 25, 50u where N P t10,000, 100,000, 1,000,000u bandits are spread equally across J \u201c 10 different groups. Across all groups j P J , each bandit has the same number of states |Sj | P t2, 3, 4, 5u and actions |Aj | \u201c 2 (\u2018pull arm\u2019 and \u2018do nothing\u2019). For each group j, we sample the initial state probabilities qj as well as the (non-stationary) transition probabilities pjt under the \u2018pull arm\u2019 action uniformly at random, whereas each bandit deterministically resides in its current state under the \u2018do nothing\u2019 action. Likewise, the rewards rjt are state-dependent and drawn uniformly at random from the interval r0, 1s under the \u2018pull arm\u2019 action, whereas they are zero under the \u2018do nothing\u2019 action. We have a single resource constraint which requires that in each time period at most b P t1% \u00a8N, 5% \u00a8N, 10% \u00a8\nN, 25% \u00a8Nu arms can be pulled. The goal is to find a policy that decides which arms to pull in each time period so as to maximize the expected total reward. This problem is known in the literature as the ordinary (or regular) multi-armed bandit problem, as opposed to the restless multi-armed bandit problem where inactive arms passively transition to new states. While the optimal policy is known for the ordinary multi-armed bandit problem in the discounted infinite horizon case with b \u201c 1 (this is the Gittins index), the problem is known to be hard in our finite horizon setting where multiple arms can be pulled in every time stage. Note that our bandit problem is characterized by a large number of bandits, each equipped with a small number of states and actions, that are spread across a relatively small number of groups and subjected to a fairly tight resource constraint. These properties are reminiscent of our healthcare case study in Section 5.\nWe compare our feasible randomized policy from Section 3.2 (with the adaptation outlined in Remark 2) against the Lagrangian relaxation-based feasible policy of Brown and Smith (2020) as well as the approximate LP-based feasible policy of Adelman and Mersereau (2008). Details of the three formulations are relegated to the appendix. In all three approaches, we exploit the group structure inherent in the bandit problem, which implies that the associated LP formulations scale in the number of groups (as opposed to the number of bandits) and can thus be solved within seconds with standard solvers. We report the suboptimality of all three approaches relative to the optimal value of the Lagrange relaxation (which itself overestimates the achievable expected total reward).\nTable 2 compares the performance of the three policies. All results are reported as averages over 100 randomly constructed test instances, where the expected total reward of each feasible policy is computed based on 10,000 sample paths. The results show that the Lagrangian relaxationbased feasible policy of Brown and Smith (2020) and our feasible randomized policy perform quite similarly, where The approximate LP-based feasible policy of Adelman and Mersereau (2008) is not competitive on the considered instances. Further investigations revealed that this is due to the fact that an unrealistically large number of constraints would have to be sampled for the LP-based relaxation to provide reasonably accurate approximations of the true reward to-go."
        },
        {
            "heading": "5 Elective Care Scheduling in England",
            "text": "In this section, we apply our framework to the COVID pandemic management in England. In particular, we discuss the overall setup of our case study (Section 5.1), the employed data sources\n10 ,0\n00 ba\nnd it\ns 10\n0, 00\n0 ba\nnd it\ns 1,\n00 0,\n00 0\nba nd\nit s\n1% 5%\n10 %\n25 %\n1% 5%\n10 %\n25 %\n1% 5%\n10 %\n25 %\n2 st\nat es\nT \u201c\n5 R\nP 0.\n00 %\n0. 10\n% 0.\n06 %\n0. 11\n% 0.\n00 %\n0. 02\n% 0.\n02 %\n0. 19\n% 0.\n00 %\n0. 00\n% 0.\n01 %\n0. 09 % B & S 0 .0 1 % 0 .0 2 % 0 .0 2 % 0 .0 3 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % A L P 0. 09 % 0. 51 % 1. 06 % 3. 25 % 0. 04 % 0. 55 % 1. 15 % 3. 26 % 0. 03 % 0. 38 % 1. 09 % 3. 25 %\n2 st\nat es\nT \u201c\n2 5\nR P\n0. 09\n% 0.\n26 %\n0. 17\n% 0.\n22 %\n0. 01\n% 0.\n07 %\n0. 05\n% 0.\n12 %\n0. 01\n% 0.\n02 %\n0. 02\n% 0.\n10 %\nB &\nS 0 .0 2 %\n0 .0 4 %\n0 .0 3 %\n0 .0 3 %\n0 .0 1 %\n0 .0 2 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\nA L P\n0. 48\n% 2.\n10 %\n3. 92\n% 7.\n27 %\n0. 12\n% 1.\n61 %\n3. 01\n% 6.\n46 %\n0. 19\n% 1.\n57 %\n3. 02\n% 6.\n39 %\n2 st\nat es\nT \u201c\n5 0\nR P\n0. 10\n% 0.\n29 %\n0. 19\n% 0.\n24 %\n0. 03\n% 0.\n09 %\n0. 06\n% 0.\n11 %\n0. 01\n% 0.\n03 %\n0. 02\n% 0.\n10 %\nB &\nS 0 .0 2 %\n0 .0 5 %\n0 .0 4 %\n0 .0 3 %\n0 .0 1 %\n0 .0 2 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\nA L P\n1. 13\n% 3.\n65 %\n4. 93\n% 8.\n23 %\n0. 36\n% 2.\n39 %\n4. 02\n% 8.\n24 %\n0. 27\n% 2.\n26 %\n4. 23\n% 8.\n36 %\n3 st\nat es\nT \u201c\n5 R\nP 0.\n03 %\n0. 10\n% 0.\n21 %\n0. 16\n% 0.\n00 %\n0. 02\n% 0.\n04 %\n0. 05\n% 0.\n00 %\n0. 00\n% 0.\n01 %\n0. 02 % B & S 0 .0 1 % 0 .0 2 % 0 .0 3 % 0 .0 2 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % A L P 0. 04 % 0. 59 % 1. 12 % 3. 79 % 0. 02 % 0. 48 % 1. 15 % 3. 38 % 0. 03 % 0. 39 % 1. 03 % 3. 27 %\n3 st\nat es\nT \u201c\n2 5\nR P\n0. 15\n% 0.\n33 %\n0. 29\n% 0.\n31 %\n0. 04\n% 0.\n11 %\n0. 09\n% 0.\n08 %\n0. 01\n% 0.\n03 %\n0. 03\n% 0.\n03 %\nB &\nS 0 .0 2 %\n0 .0 4 %\n0 .0 4 %\n0 .0 4 %\n0 .0 1 %\n0 .0 2 %\n0 .0 2 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\nA L P\n0. 62\n% 2.\n58 %\n4. 16\n% 7.\n86 %\n0. 22\n% 1.\n72 %\n3. 42\n% 7.\n14 %\n0. 23\n% 1.\n62 %\n3. 10\n% 7.\n38 %\n3 st\nat es\nT \u201c\n5 0\nR P\n0. 21\n% 0.\n41 %\n0. 36\n% 0.\n26 %\n0. 06\n% 0.\n12 %\n0. 11\n% 0.\n09 %\n0. 02\n% 0.\n04 %\n0. 03\n% 0.\n04 %\nB &\nS 0 .0 2 %\n0 .0 6 %\n0 .0 5 %\n0 .0 4 %\n0 .0 1 %\n0 .0 2 %\n0 .0 2 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\nA L P\n1. 13\n% 3.\n62 %\n5. 13\n% 8.\n47 %\n0. 40\n% 2.\n47 %\n4. 22\n% 9.\n14 %\n0. 33\n% 2.\n29 %\n4. 46\n% 9.\n05 %\n4 st\nat es\nT \u201c\n5 R\nP 0.\n03 %\n0. 08\n% 0.\n19 %\n0. 17\n% 0.\n02 %\n0. 04\n% 0.\n03 %\n0. 06\n% 0.\n01 %\n0. 01\n% 0.\n01 %\n0. 01 % B & S 0 .0 1 % 0 .0 2 % 0 .0 2 % 0 .0 2 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % A L P 0. 09 % 0. 67 % 1. 24 % 3. 60 % 0. 10 % 0. 29 % 0. 97 % 3. 16 % 0. 08 % 0. 39 % 0. 95 % 3. 34 %\n4 st\nat es\nT \u201c\n2 5\nR P\n0. 20\n% 0.\n35 %\n0. 35\n% 0.\n34 %\n0. 05\n% 0.\n12 %\n0. 10\n% 0.\n09 %\n0. 02\n% 0.\n04 %\n0. 04\n% 0.\n03 %\nB &\nS 0 .0 2 %\n0 .0 4 %\n0 .0 4 %\n0 .0 4 %\n0 .0 1 %\n0 .0 2 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\nA L P\n0. 66\n% 2.\n41 %\n3. 88\n% 7.\n44 %\n0. 24\n% 1.\n64 %\n3. 13\n% 6.\n89 %\n0. 19\n% 1.\n44 %\n2. 96\n% 7.\n18 %\n4 st\nat es\nT \u201c\n5 0\nR P\n0. 26\n% 0.\n47 %\n0. 43\n% 0.\n33 %\n0. 09\n% 0.\n15 %\n0. 13\n% 0.\n09 %\n0. 03\n% 0.\n05 %\n0. 04\n% 0.\n03 %\nB &\nS 0 .0 3 %\n0 .0 5 %\n0 .0 5 %\n0 .0 4 %\n0 .0 1 %\n0 .0 2 %\n0 .0 2 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\nA L P\n1. 30\n% 3.\n44 %\n5. 03\n% 8.\n49 %\n0. 41\n% 2.\n23 %\n4. 06\n% 8.\n81 %\n0. 35\n% 2.\n13 %\n4. 19\n% 8.\n85 %\n5 st\nat es\nT \u201c\n5 R\nP 0.\n09 %\n0. 21\n% 0.\n15 %\n0. 19\n% 0.\n00 %\n0. 03\n% 0.\n05 %\n0. 06\n% 0.\n00 %\n0. 01\n% 0.\n01 %\n0. 02 % B & S 0 .0 1 % 0 .0 2 % 0 .0 2 % 0 .0 2 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % 0 .0 1 % A L P 0. 10 % 0. 45 % 0. 89 % 3. 51 % 0. 07 % 0. 38 % 0. 94 % 3. 82 % 0. 04 % 0. 40 % 1. 02 % 3. 50 %\n5 st\nat es\nT \u201c\n2 5\nR P\n0. 23\n% 0.\n45 %\n0. 44\n% 0.\n38 %\n0. 08\n% 0.\n14 %\n0. 13\n% 0.\n10 %\n0. 02\n% 0.\n04 %\n0. 04\n% 0.\n03 %\nB &\nS 0 .0 2 %\n0 .0 4 %\n0 .0 4 %\n0 .0 3 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\nA L P\n0. 69\n% 2.\n42 %\n3. 76\n% 7.\n62 %\n0. 31\n% 1.\n52 %\n3. 04\n% 7.\n05 %\n0. 22\n% 1.\n49 %\n2. 80\n% 6.\n89 %\n5 st\nat es\nT \u201c\n5 0\nR P\n0. 36\n% 0.\n58 %\n0. 48\n% 0.\n37 %\n0. 10\n% 0.\n15 %\n0. 16\n% 0.\n10 %\n0. 04\n% 0.\n05 %\n0. 05\n% 0.\n03 %\nB &\nS 0 .0 3 %\n0 .0 5 %\n0 .0 5 %\n0 .0 4 %\n0 .0 1 %\n0 .0 2 %\n0 .0 2 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\n0 .0 1 %\nA L P\n1. 23\n% 3.\n53 %\n4. 93\n% 8.\n36 %\n0. 47\n% 2.\n19 %\n3. 86\n% 8.\n35 %\n0. 31\n% 2.\n08 %\n3. 82\n% 8.\n39 %\nT ab\nle 2.\nO pt\nim al\nit y\nga ps\nof ou\nr fe\nas ib\nle ra\nnd om\niz ed\npo lic\ny (R\nP ),\nth e\nLa gr\nan gi\nan re\nla xa\nti on\n-b as\ned fe\nas ib\nle po\nlic y\nof B\nro w n an d Sm it h (2 02 0) (B & S) an d th e fe as ib le po lic y de ri ve d fr om th e ap pr ox im at e LP -b as ed re la xa ti on (A LP ), re po rt ed fo r di ffe re nt nu m be rs of st at es an d ti m e ho ri zo ns (r ow s) as w el la s nu m be rs of ba nd it s an d re so ur ce re st ri ct io ns (c ol um ns ).\n(Section 5.2), the DPs that model the patients of our healthcare model (Section 5.3) and the numerical results (Section 5.4)."
        },
        {
            "heading": "5.1 Experimental Setup",
            "text": "As a case study, we aim to optimally schedule elective procedures for the NHS in England over a 56-week planning horizon (52 reported weeks plus an additional 4 weeks to avoid end-of-timehorizon effects), starting from March 2, 2020, with the objective of minimizing YLL. We consider a total of 10.45 million non-COVID patients that are subdivided into (i) electives (3.9 millions) and emergencies (6.55 millions), (ii) 20 disease groups and (iii) 3 age groups (under 25 years, 25\u201364 years, over 64 years). We also consider 349,279 COVID patients, all of whom are emergencies.\nOur model has a weekly granularity. At the beginning of each week, a new inflow of patients in need of elective and emergency care (hereafter denoted as elective and emergency patients, respectively) enters the system. Strictly speaking, our model distinguishes between different medical procedures, and thus one and the same patient in need of several procedures is included as multiple different patients in our model. For ease of exposition, however, we continue to talk about patients in the following. Patients are then admitted to hospital, and they evolve over the duration of the week. Emergencies are always admitted to hospital upon arrival (if capacity permits). Elective patients who are not immediately admitted to hospital wait in a queue. While in the queue, an elective patient\u2019s condition might worsen and hence require emergency admission. Based on the severity of their conditions and resource availability, patients are first admitted to G&A or to CC and can transition between G&A and CC in the following weeks of hospitalization until they are eventually discharged from hospital (recovered or deceased). Transitions between G&A and CC are decided upon at the beginning of each week, and they are based on transition probabilities that are specific to the different patient groups and admission types (elective or emergency)."
        },
        {
            "heading": "5.2 Data Sources",
            "text": "We combine a large set of modeling and administrative data to create a comprehensive dataset4 for the NHS in England that includes elective and emergency patient inflows, transition probabilities, availability and requirement of resources. To this end, we leverage several data sources. In the 4The source code for the data analysis will be made available open source shortly. The data used in our case study is not freely available, but it is accessible to researchers on condition of NHS approval.\nfollowing, we indicate how these data sources map to the primitives of the fluid LP model presented in Section 3 and refer to specific sections of the accompanying paper (D\u2019Aeth et al., 2021) for a comprehensive presentation of the data pre-processing.\nWe model the patient inflows, which determine the initial state probabilities qt (for patients arriving in week 1) as well as the transition probabilities pjt (for patients arriving in later weeks), via historical data (for non-COVID patients) as well as a projection method (for COVID patients). In particular, we forecast non-COVID patient inflows using individual level patient records across all hospitals in England from the Hospital Episode Statistics (HES), see NHS Digital (2020). HES contain patient level data with diagnoses, individual characteristics, care received, date of admission and time and mode of discharge from hospital. Weekly inflows of COVID patients are generated using the integrated epidemic/economic model Daedalus (Haw et al., 2020), fitting four parameters to English hospital occupancy data (NHS, 2020b) from March 20, 2020 to June 30, 2020: epidemic onset, basic reproductive number, lockdown onset, and reduction in transmission during lockdown due to pandemic mitigation strategies. The model divides the population into four age groups (0-4, 5-19, 20-64, over 65), which are then mapped into our three age groups using a linear transformation. In our numerical studies, we consider an epidemiological scenario defined by a lockdown enforced on January 1, 2021 and the maximum value of the reproductive number Rmax \u201c 1.2 attained during the post-lockdown period. The details of our non-COVID and COVID patient inflow models are described in the Supplementary Sections 3 and 4 of D\u2019Aeth et al. (2021), respectively.\nThe transition probabilities pjt that characterize the evolution of hospitalized non-COVID and COVID patients are modeled with multinomial logits conditional on the length of stay in hospital using HES data and individual clinical data from patients who received care at the Imperial College Healthcare NHS Trust (Perez-Guzman et al., 2020), see Supplementary Section 5 of D\u2019Aeth et al. (2021).\nFor the resources L, staff availability is calculated from recent NHS datasets (NHS, 2020a,c), see D\u2019Aeth et al. (2021), while staff-to-bed ratios are estimated using the Royal College of Physicians guidance (RCP London, 2020; Royal College of Nursing, 2020). As for the rewards rjt, we calculate the YLL using standard life tables data provided by the Office for National Statistics (Office for National Statistics, 2019). We note that in this setting, which corresponds to the base case setting of the accompanying paper (D\u2019Aeth et al., 2021), only the two resources \u2018G&A beds\u2019 and \u201cCC beds\u2019\nout of the eight considered resources are binding.\nTable 3. Availability of resources and staff-to-bed ratios.\nCapacity Staff-to-bed Ratio Beds Senior Doctors Junior Doctors Nurses Senior Doctors Junior Doctors Nurses\nG&A 102,186 10,764 8,539 43,214 15 15 5 CC 4,122 1,013 963 18,856 15 8 1\nMarch 2020 April 2020 May 2020 June 2020 July 2020 August 2020 September 2020 October 2020 November 2020 December 2020 January 2021 Februrary 2021 March 2021\n50000\n100000\n150000\nMarch 2020 April 2020 May 2020 June 2020 July 2020 August 2020 September 2020 October 2020 November 2020 December 2020 January 2021 Februrary 2021 March 2021\n20000\n40000\n60000\n80000\n100000\n120000\n140000\nICD11 ICD02 ICD13 ICD07 ICD14 Others\n<latexit sha1_base64=\"C9XW4Fzj8Z6b7or2DASmawIfVQs=\">AAAB8nicbVC7SgNBFJ2NrxhfUUubwSCkCrsp1DJgYxnBPGCzhNnJ3WTIPJaZWSEs+QwbC0Vs/Ro7/8ZJsoUmHhg4nHMvc8+JU86M9f1vr7S1vbO7V96vHBweHZ9UT8+6RmWaQocqrnQ/JgY4k9CxzHLopxqIiDn04undwu89gTZMyUc7SyESZCxZwiixTgpBgB6DpAzMsFrzG/4SeJMEBamhAu1h9WswUjQTIC3lxJgw8FMb5URbRjnMK4PMQErolIwhdFQSASbKlyfP8ZVTRjhR2j1p8VL9vZETYcxMxG5SEDsx695C/M8LM5vcRjmTaWZdrtVHScaxVXiRH4+YBmr5zBFCNXO3YjohmlDrWqq4EoL1yJuk22wE1w3/oVlr1Ys6yugCXaI6CtANaqF71EYdRJFCz+gVvXnWe/HevY/VaMkrds7RH3ifP45rkVg=</latexit> emergencies\n<latexit sha1_base64=\"xtHON7s1aw5eU4/81CyGZGI7xQA=\">AAAB8XicbVC7SgNBFL0bXzG+opY2g0FIFXZTqGXAxjKCeWCyhNnJTTJkdnaZmQ2EJX9hY6GIrX9j5984m2yhiQcGDufcy9xzglhwbVz32ylsbe/s7hX3SweHR8cn5dOzto4SxbDFIhGpbkA1Ci6xZbgR2I0V0jAQ2Ammd5nfmaHSPJKPZh6jH9Kx5CPOqLHSEwpkhs9QlwbliltzlyCbxMtJBXI0B+Wv/jBiSYjSMEG17nlubPyUKsOZwEWpn2iMKZvSMfYslTRE7afLixfkyipDMoqUfdKQpfp7I6Wh1vMwsJMhNRO97mXif14vMaNbP+UyTgxKtvpolAhiIpLFJ0OubGIxt4Qyxe2thE2ooszYkrISvPXIm6Rdr3nXNfehXmlU8zqKcAGXUAUPbqAB99CEFjCQ8Ayv8OZo58V5dz5WowUn3zmHP3A+fwBNA5CV</latexit> electives\nCOVID19 ICD18 ICD10 ICD19 ICD09 Others\nFigure 4. Weekly inflows of elective (top) and emergency (bottom) patients categorized by disease group (ICD02: neoplasms; ICD07: diseases of the eye and adnexa; ICD09: diseases of the circulatory system; ICD10: diseases of the respiratory system; ICD11: diseases of the digestive system; ICD13: diseases of the musculoskeletal system and connective tissue; ICD14: diseases of the genitourinary system; ICD18: symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified; ICD19: injury, poisoning and certain other consequences of external causes).\nTable 3 and Figure 4 summarize the main input data for our case study. Table 3 reports the availability of beds and staff in G&A and CC across the NHS in England (btl), together with the corresponding staff-to-bed ratios (ctlj). Figure 4 shows the weekly inflows of elective and emergency patients from March 2020 to February 2021 (qj and pjt), categorized by disease type according to the International Classification of Diseases (ICD) standard. The figure only displays the five largest patient groups individually, whereas the smaller remaining groups are collective referred to as \u201cOthers\u201d."
        },
        {
            "heading": "5.3 Dynamic Programming Model of an Individual Patient",
            "text": "Recall that the patients in our healthcare model are partitioned into 3,360 groups, each of which is characterized by an arrival time in the system (56 weeks), one out of 20 disease types and one out of 3 age groups. We associate a DP with each of these patient groups. All DPs share the same state and action sets, but the DPs of different patient groups differ in their admissible actions per time period and state, their initial state and transition probabilities as well their expected rewards.\nFigure 5 offers a schematic representation of a patient DP. Apart from the patients that enter our healthcare model in the first week, each patient is Dormant until the beginning of week t \u201c t0, at which point she enters the system either as to be admitted for a planned procedure (Elective) or as emergency (Emergency). Emergency patients are admitted to hospital immediately if capacity permits; we assume that emergency patients who are denied admission die, which is represented by the Dead state. Elective patients that are not immediately admitted to hospital, on the other hand, remain waiting and run a risk of requiring emergency care in subsequent weeks.\nUpon admission to hospital as elective or emergency, a patient requires either G&A (Initially requires G&A state) or CC (Initially requires CC state). A patient in need of G&A is admitted to G&A (G&A state), whereas a patient requiring CC can be assigned to either CC (CC state) or, in case of capacity shortages, to G&A. In the latter case, the transition into a designated G\u02da state implies that the patient subsequently evolves according to a different set of transition probabilities that account for an increased mortality risk associated with the denial of CC.\nIn the following weeks, depending on her response to the treatment, the patient can either require the same care regime or be moved to another one (cf. the Requires G&A and Requires CC states). Depending on resource availability, the patient then transitions between the three states G&A, CC or G\u02da until she eventually reaches the corresponding Last Week state, after which she is discharged from hospital (Recovered or Dead). We assume that a patient in a Last Week state only consumes half of the hospital resources, which mimics a half-week stay at the hospital. The inclusion of designated Last Week states allows us to account for the empirical fact that for some disease types, a large fraction of the patients require hospitalization for a few days only."
        },
        {
            "heading": "5.4 Results",
            "text": "We next present the numerical results of our NHS England case study (Section 5.4.1) and compare our optimized schedule (hereafter OS) against a COVID prioritization policy (hereafter CP) that resembles the one implemented in England during the pandemic (Section 5.4.2). All experiments were run on a 2.7GHz quad-core Intel i7 processor with 16GB RAM using IBM ILOG CPLEX Optimization Studio 20.1. The runtimes of the fluid LP (4) ranged between 1.5 and 2 minutes."
        },
        {
            "heading": "5.4.1 Optimized Schedule",
            "text": "Figure 6 shows the weekly elective admissions and emergency denials of the OS. Over the 52-week planning horizon, the OS admits to hospital 6,939,573 emergency patients (not shown), while 654,308 elective patients are admitted to hospital from week 1 to week 43 (upper part of Figure 6). Among the admitted elective patients, the most numerous groups are cancer patients (230,928), patients affected by diseases of the circulatory system (107,048) and diseases of the skin and subcutaneous\ntissue (101,790). In the last weeks of the planning horizon, due to the high inflow of COVID patients during the second wave of the pandemic, the available resources are insufficient to cope with the surge in demand. As a result, admission to hospital is denied to 125,346 emergency patients during weeks 38-52 (lower part of Figure 6). All of these patients are above 65 years of age, and most of them are COVID (40,962), cancer (30,069) and injury & poisoning (24,870) patients. The OS denies admission to hospital to these elderly patients as they have the lowest chances of benefiting from care.\n<latexit sha1_base64=\"shASUTD1pi5hXVamPYvcpzniOXc=\">AAAB9XicbVDLSgNBEJyNrxhfUY9eBoOQU9jNQT0GvHiMYB6QrGF2tjcZMo9lZlYJIf/hxYMiXv0Xb/6Nk2QPmljQUFR1090VpZwZ6/vfXmFjc2t7p7hb2ts/ODwqH5+0jco0hRZVXOluRAxwJqFlmeXQTTUQEXHoROObud95BG2Ykvd2kkIoyFCyhFFinfQgMxGBxirBEcRmUK74NX8BvE6CnFRQjuag/NWPFc0ESEs5MaYX+KkNp0RbRjnMSv3MQEromAyh56gkAkw4XVw9wxdOiXGitCtp8UL9PTElwpiJiFynIHZkVr25+J/Xy2xyHU6ZTDMLki4XJRnHVuF5BDhmGqjlE0cI1czdiumIaEKtC6rkQghWX14n7XotuKz5d/VKo5rHUURn6BxVUYCuUAPdoiZqIYo0ekav6M178l68d+9j2Vrw8plT9Afe5w8cQZIr</latexit>\nFigure 7 shows the bed occupancy in CC. A large share of CC beds is occupied by COVID patients (40.2% average occupancy over the planning horizon), while 9.4% of the available CC beds are assigned (on average) to elective patients. During both the first and the second wave of the pandemic, capacity is insufficient, and CC is denied to some patients. The affected patients are almost exclusively COVID patients above 65 years of age, who are transferred to G\u2039 due to their longer hospital stays as well as their lower capacity to benefit from treatment. G&A resources (not shown in the Figure) are fully utilized over the entire planning horizon, and the share of elective patients in G&A is on average 6.6%. Overall, the OS results in 8,233,216 YLL over the 52 weeks planning horizon, with COVID patients contributing to 64% of the YLL.\nWe now investigate the performance of the infeasible and feasible randomized policies from Section 3.2. Recall that the expected total reward of the infeasible randomized policy coincides with the objective value of the fluid LP and the resource violations of the infeasible randomized policy are small with high probability, whereas the expected total reward of the feasible randomized policy may fall short of the objective value of the fluid LP by a small quantity. For our case study, the infeasible randomized policy results in a YLL decrease of 0.01% (from 8,233,216 to 8,232,570) as well as average resource violations of 0.33% for G&A beds (ranging between 0% and 4.01% across weeks) and 1.94% for CC beds (ranging between 0% and 12.09% across weeks), respectively. The feasible randomized policy, on the other hand, is derived from the fluid LP (4) under the reduced resource limits tbredtl ut,l and a subsequent random assignment of \u2018do-nothing\u2019 actions (which amount to sending patients home; cf. Assumption 2) until all original resource limits tbtlut,l are met (cf. Section 3.2). The feasible randomized policy results in a YLL increase of 1.03% (from 8,233,216 to 8,318,049), while\u2014by construction\u2014all resource constraints are satisfied. Since only two of the eight resources were binding, we also ran a separate experiment where we reduced the staff-to-bed ratio by 33% (reflecting the fact that the pandemic caused more stress on the system and that COVID patients required more time/attention) and assumed that up to 25% of the staff was absent during the pandemic (with the absenteeism varying weekly with the COVID numbers). Under this new experiment, junior and senior doctors in G&A as well as junior doctors in CC became additional binding resources. In this revised experiment, the optimality gap of our randomized feasible policy increased to 4.09%. Better results could potentially be obtained if we refined our randomized feasible policy along the lines of Remark 2."
        },
        {
            "heading": "5.4.2 Comparison with COVID Prioritization Policies",
            "text": "The results from the previous subsection suggest that denying G&A or CC admission to COVID patients might be beneficial in case of capacity shortages. This contrasts with current practice, where many countries prioritize COVID patients to the detriment of other patients. In the following, we thus compare our OS against a CP policy that always admits COVID patients and that strongly penalizes CC denial to COVID patients in the objective. Other than that, the CP policy coincides with the OS; in particular, within the aforementioned restrictions, the CP policy optimally schedules care across all patients groups.\nFigure 8 shows that, while the total number of elective admissions is similar to the OS (655,415), emergency admission denials are significantly higher under the CP policy (153,092, +22.1% compared to the OS). Specifically, while all COVID patients are admitted to hospital, emergency admission is denied to patients above 65 years of age affected by injury & poisoning (55,130), cancer (35,663) and diseases of the respiratory system (26,784). The higher numbers of emergency admission denials are due to the longer treatment of COVID patients, relative to patients affected by other diseases. Under the CP policy, an average 71.6% of the CC beds are occupied by COVID patients (+75.6% compared to the OS), and the CC occupancy reaches 100% during the second wave of the pandemic (weeks 42-52). The share of electives in CC and G&A is reduced to 4.4% (-53.2% compared to the OS) and 6.5% (-1.5% compared to the OS), respectively.\nOverall, the prioritization of COVID patients in admission to G&A and CC leads to an 8.7% increase in the total YLL under the CP policy compared to the OS. Figure 9 shows a breakdown of these total 719,868 YLL across the different disease groups. Significant gains in years of life are seen\nfor patients affected by injury & poisoning (318,955), diseases of the respiratory system (259,012), diseases of the circulatory system (108,085), diseases of the digestive system (85,134) and cancer (78,464), to the detriment of elderly COVID patients (275,691)."
        },
        {
            "heading": "6 Discussion",
            "text": "Our numerical case study from the previous section offers initial evidence on how the ongoing pandemic could be managed in a more effective way. That said, our model inevitably makes a number of simplifying assumptions that likely lead to a gap between the expected and the actually observed results if our optimized schedule was implemented in practice. This section reviews some of these assumptions as well as their potential impact on the real-life performance of our policy.\nDisease progression and homogeneity within patient groups. With the exception of the\npatients in state G\u2039 (which records a previous denial to CC), the transitions in our model\u2014such as the weekly probability of an elective patient turning into an emergency or the weekly probability of a hospitalized patient recovering or dying\u2014are Markovian and hence memoryless. In reality, disease progression may exhibit a more complicated dependence on waiting time, and this dependency can differ across patient groups. Non-Markovian transitions could be modeled by adding memory to the states of the patient DPs (e.g., how many weeks a patient has been waiting for her surgery, and how many weeks a patient has spent in hospital), at the expense of a larger problem size as well as a more challenging parameter estimation. We also assume that patients within each group are homogenous in terms of clinical severity and disease progression. Our data do not allow us to determine whether accounting for such factors would increase or reduce the benefits of the OS compared to the CP policy.\nGeographical aggregation. Our model disregards geographical differences in patient numbers, hospital resources and treatment efficacy. While this appears to be an acceptable approximation when informing the development of national guidance, a more elaborate model could subdivide the country into different regions and impose that patients can only be treated in hospitals that are sufficiently close. Computationally, a geographic disaggregation would lead to a larger and hence less tractable model. On the other hand, since the outperformance of the OS over the CP policy appears to increase when resource constraints are tight, we would expect to obtain better results in a model that imposes further constraints through a geographical disaggregation.\nData uncertainty and learning. Our model requires the estimation of a large number of input parameters, such as patient inflows, transition probabilities and resource limits, all of which are inevitably affected by significant uncertainty. The impact of this uncertainty could be analyzed further via a sensitivity analysis (as done in the accompanying paper D\u2019Aeth et al. 2021) or by formulating and solving a robust version of the grouped weakly coupled DP. Data uncertainty impacts our model in at least two ways. Firstly, the transition probabilities for COVID patients, which are calculated based on hospital records dating between March and June 2020, likely underestimate chances of survival of COVID patients in later stages of the pandemic. The ramifications of this are not clear: on the one hand, the OS may perform better in reality since COVID patients face a higher chance of survival even outside CC, while on the other hand a better treatment in CC may imply that COVID patients should indeed be prioritized as they enjoy a higher capacity to benefit.\nSecondly, our model ignores the important issue of learning: the CP policy, which aggressively prioritizes COVID patients, has led to a much better understanding of effective COVID treatments and has hence improved the transition probabilities of COVID patients, whereas our OS prioritizes non-COVID patients and hence foregoes the opportunity to learn more effective treatments. Ignoring the learning aspect likely leads to an underestimation of the benefits of the CP policy.\nHealth inequalities. Our model does not account for health inequalities. While YLL accounts for the principle that one year of life gained is of equal value regardless of who receives it, our model currently disregards inequity aversion in the population distribution of healthcare utilization and/or health outcomes. As an example, policy makers might be willing to sacrifice some years of life gained in favor of providing people of different age, gender, ethnicity and medical history with equal chances of survival. From a performance viewpoint, we expect our OS to fare well in this setting since equity considerations constitute additional constraints. From a tractability perspective, some of these restrictions may require the imposition of logical constraints in the fluid LP and thus result in less tractable mixed-integer linear programs. Moreover, it is unclear whether our performance guarantees for the randomized policies can be extended to this case.\nCapacity and hospital acquired infections. Our model assumes that the timing and the magnitude of the patient inflows as well as the availability of staff is independent of the hospital occupancy rates. Since COVID is highly infectious, however, both non-COVID patients and hospital staff may be exposed to the virus and\u2014in absence of protective behavior\u2014may spread it to the community. It would therefore be instructive to study the impact of hospital occupancy rates, which are immediate consequences of the admissions decisions in our model, on hospital acquired infections, changes in care seeking behavior, ward closures as well as workload-dependent staff absenteeism (Green et al., 2013). Our model also assumes that capacity can be re-assigned between COVID and non-COVID cases on short notice. Since COVID patients require isolation and dedicated staff to reduce the risk of infections, this is not the case in practice, and our model may therefore overestimate the available capacity. We believe that this issue is attenuated by the fact that we are modeling the health system of an entire nation, as opposed to an individual hospital.\nDespite the aforementioned limitations, which are to some extent inevitable when modeling complex real-world systems, our findings provide encouraging evidence that our model can help\nto inform strategic public health policy decisions. Specifically, our optimization framework, by considering the entire patient population as well as prioritizing care based on capacity to benefit, could contribute to an improvement of the current practice which seldom looks at the health system from a global perspective and therefore likely results in suboptimal decisions.\nAcknowledgements. The authors would like to sincerely thank the department editor, the associate editor as well as the two referees for their constructive and insightful feedback that has led to substantial improvements of the manuscript."
        },
        {
            "heading": "Appendix A: Implementation Details for the Synthetic Experiment",
            "text": "Our feasible randomized policy is based on the solution p\u03c3LP, \u03c0LPq to the fluid LP (4) with the reduced resource limits tbredtl ut,l defined in (6). The solution p\u03c3LP, \u03c0LPq allows us to construct the infeasible auxiliary policy \u03c0red according to equation (5). We next construct the feasible randomized policy \u03c0F from \u03c0red as discussed in Section 3.2: In each time period t P T and for each state-action pair ps, aq P S \u02c6 A with positive probability r\u03c0redt psqspaq \u0105 0, if action a violates the budget b then we shift the probability mass to an action a1 that \u2018un-pulls\u2019 arms of each bandit group j P J in state s P Sj in order of ascending probabilities \u03c0LPtj ps, \u2018pull arm\u2019q{\u03c3LPtj psq as indicated by equation (5). Likewise, as pointed out in Remark 2, if action a under-utilizes the budget b then we shift the probability mass to an action a1 that pulls additional arms of each bandit group j P J in state s P Sj in order of descending probabilities \u03c0LPtj ps, \u2018pull arm\u2019q{\u03c3LPtj psq as indicated by equation (5). In other words, bandits of group j P J in state s P Sj are more (less) likely to be activated in the final policy than in \u03c0F if their associated probabilities \u03c0LPtj ps, \u2018pull arm\u2019q{\u03c3LPtj psq are higher (lower). Any possible ties are broken according to the bandit group index j P J and the index i P t1, . . . , nju of the bandit within the group.\nThe Lagrangian relaxation-based feasible policy of Brown and Smith (2020) utilizes the La-\ngrangian relaxation (3) dual to our fluid LP (4). For each time period t P T , bandit group j P J and bandit state s P Sj , we approximate the expected excess reward of pulling an arm via\nftjpsq \u201c rjtps, \u2018pull arm\u2019q ` \u00ff\ns1PSj\npjtps1 | s, \u2018pull arm\u2019q\u00a8V \u03bbt`1,jps1q \u00b4 V \u03bbt`1,jpsq ` \u03f5\u00a8B \u00ab \u03c0LPtj ps, \u2018pull arm\u2019q \u03c3LPtj psq ff ,\nwhere V \u03bb and p\u03c3LP, \u03c0LPq denote optimal solutions to the primal Lagrangian relaxation (3) and the dual fluid LP (4), respectively, \u03f5 is a sufficiently small positive constant (we choose \u03f5 \u201c 10\u00b45 in our numerical experiments), and B denotes a Bernoulli random variable that takes value 1 with the probability given as its argument. The first three terms in ftjpsq approximate the difference in expected total reward between activating a bandit of group j P J that is in state s P Sj at time t P T and not activating the bandit, whereas the last term is a tiebreaker that leverages the probability of pulling the arm under the fluid LP solution. In each time period, the Lagrangian relaxation-based feasible policy of Brown and Smith (2020) only considers arms whose corresponding expected excess rewards ftjpsq are non-negative, and it pulls up to b of those arms in order of descending expected\nexcess rewards (less than b arms are pulled if all other arms have negative expected excess rewards). Any possible ties are broken according to the bandit group index j P J and the index i P t1, . . . , nju of the bandit within the group.\nThe approximate LP-based feasible policy of Adelman and Mersereau (2008), finally, considers\nthe following LP approximation of the grouped weakly coupled DP,\nminimize V\n\u00ff\njPJ\n\u00ff\nsPSj\nnj \u00a8 qjpsq \u00a8 V1jpsq\nsubject to \u00ff\njPJ\nnj \u00ff i\u201c1 Vtjpsjiq \u011b \u00ff jPJ nj \u00ff i\u201c1 rjtpsji, ajiq ` \u00ff jPJ nj \u00ff i\u201c1 \u00ff s1PSj pjtps1 | sji, ajiq \u00a8 Vt`1,jps1q\n@t P T , @ps, aq P \u0105 jPJ rSnjj s \u02c6 \u0105 jPJ rAnjj s : ps, aq P S \u02c6 A C t psq,\nwhere ps, aq P S \u02c6 ACt psq denotes the resource-feasible state-action pairs in period t. Since the number of constraints in this problem scales exponentially in the problem dimensions, we follow the constraint sampling approach of De Farias and Van Roy (2004) and randomly sample 10,000 constraints. For each time period t P T , bandit group j P J and bandit state s P Sj , we approximate the expected excess reward of pulling an arm via\nftjpsq \u201c rjtps, \u2018pull arm\u2019q ` \u00ff\ns1PSj\npjtps1 | s, \u2018pull arm\u2019q \u00a8 Vt`1,jps1q \u00b4 Vt`1,jpsq,\nwhere V denotes an optimal solution the above LP approximation. In each time period, the approximate LP-based feasible policy of Adelman and Mersereau (2008) only considers arms whose corresponding expected excess rewards ftjpsq are non-negative, and it pulls up to b of those arms in order of descending expected excess rewards (less than b arms are pulled if all other arms have negative expected excess rewards). Any possible ties are broken according to the bandit group index j P J and the index i P t1, . . . , nju of the bandit within the group."
        },
        {
            "heading": "Appendix B: Proofs",
            "text": "Proof of Proposition 1. Proofs of this statement can be found, among others, in the papers of Hawkins (2003), Adelman and Mersereau (2008) and Brown and Zhang (2020).\nProof of Proposition 2. We introduce the non-negative dual variables \u03c0 \u201c t\u03c0tjut,j with \u03c0tj : Sj \u02c6 Aj \u00d1 R`, t P T and j P J , and we set\n\u03c0tjps, aq \u201c 0 @t P T , @j P J , @ps, aq P Sj \u02c6 AjzAjtpsq\nsince the first constraint in the Lagrangian relaxation (3) only needs to be satisfied for the admissible actions a P Ajtpsq. The Lagrangian function is then given by\nLpV \u03bb, \u03bb;\u03c0q \u201c T \u00ff\nt\u201c1\n\u00ff lPL \u03bbtlbtl ` \u00ff jPJ \u00ff sPSj nj \u00a8 qjpsq \u00a8 V \u03bb1jpsq ` \u00ff tPT \u00ff jPJ \u00ff sPSj \u00ff aPAj \u03c0tjps, aq\n\u00a8 \u02ddrjtps, aq \u00b4 \u00ff\nlPL \u03bbtlctljps, aq `\n\u00ff\ns1PSj\npjtps1 | s, aq \u00a8 V \u03bbt`1,jps1q \u00b4 V \u03bbtj psq\n\u02db\n\u201a\n\u201c \u00ff\ntPT\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\n\u03c0tjps, aq \u00a8 rtjps, aq ` T \u00ff\nt\u201c1\n\u00ff lPL \u03bbtl\n\u00a8 \u02ddbtl \u00b4 \u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nctljps, aq \u00a8 \u03c0tjps, aq\n\u02db\n\u201a\n` \u00ff\njPJ\n\u00ff\nsPSj\nV \u03bb1jpsq\n\u00a8 \u02ddnj \u00a8 qjpsq \u00b4 \u00ff\naPAj\n\u03c01jps, aq\n\u02db\n\u201a\n` \u00ff\ntPT\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\n\u03c0tjps, aq \u00ff\ns1PSj\npjtps1 | s, aq \u00a8 V \u03bbt`1,jps1q \u00b4 \u00ff\ntPT zt1u\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\n\u03c0tjps, aq \u00a8 V \u03bbtj psq\nReplacing t by t ` 1 and s by s1 in the last term, we obtain\n\u00ff\ntPT zt1u\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\n\u03c0tjps, aq \u00a8 V \u03bbtj psq \u201c \u00ff\ntPT ztT u\n\u00ff\njPJ\n\u00ff\ns1PSj\n\u00ff\naPAj\n\u03c0t`1,jps1, aq \u00a8 V \u03bbt`1,jps1q.\nSince V \u03bbT`1,jpsq \u201c 0 for all j P J and s P Sj , the Lagrangian function LpV \u03bb, \u03bb;\u03c0q simplifies to\nLpV \u03bb, \u03bb;\u03c0q \u201c \u00ff\ntPT\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\n\u03c0tjps, aq \u00a8 rjtps, aq ` T \u00ff\nt\u201c1\n\u00ff lPL \u03bbtl\n\u00a8 \u02ddbtl \u00b4 \u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nctljps, aq \u00a8 \u03c0tjps, aq\n\u02db\n\u201a\n` \u00ff\njPJ\n\u00ff\nsPSj\nV \u03bb1jpsq\n\u00a8 \u02ddnj \u00a8 qjpsq \u00b4 \u00ff\naPAj\n\u03c01jps, aq\n\u02db\n\u201a\n` \u00ff\ntPT ztT u\n\u00ff\njPJ\n\u00ff\ns1PSj\nV \u03bbt`1,jps1q\n\u00a8\n\u02dd\n\u00ff\nsPSj\n\u00ff\naPAj\n\u03c0tjps, aq \u00a8 pjtps1 | s, aq \u00b4 \u00ff\naPAj\n\u03c0t`1,jps1, aq\n\u02db\n\u201a\nMinimizing the Lagrangian function LpV \u03bb, \u03bb;\u03c0q over V \u03bb \u201c tV \u03bbtjut,j , t P T and j P J , with V \u03bbtj : Sj \u00d1 R and \u03bb \u201c t\u03bbtlut,l, t P T and l P L, with \u03bbtl \u011b 0 results in the dual fluid LP (4), where we have introduced the auxiliary variables \u03c3tjpsq \u201c \u0159\naPAj \u03c0tjps, aq to aid exposition. Strong duality\nbetween the LPs (3) and (4) holds since both problems are feasible by construction: In (3), for example, we can choose \u03bbtl \u201c 0 for all t P T and l P L as well as V \u03bbtj psq \u201c pT \u00b4 t`1q \u00a8maxtrjtps, aq : j P J , t P T , ps, aq P S \u02c6 Au \u0103 `8, t P T , j P J and s P Sj .\nThe proofs of Theorems 1 and 2 rely on the following two auxiliary results, which we prove first.\nLemma 1. The following equations hold for all t P T , pj, iq P J \u02c6 t1, . . . , nju and ps, aq P Sj \u02c6 Aj:\nP \u201c s\u0303t,pj,iq \u201c s ^ a\u0303t,pj,iq \u201c a \u2030 \u201c \u03c0LPtj ps, aq\nnj .\nProof of Lemma 1. According to our definition of the randomized policy \u03c0\u2039, we have\nP \u201c a\u0303t,pj,iq \u201c a | s\u0303t,pj,iq \u201c s \u2030 \u201c \u03c0LPtj ps, aq \u03c3LPtj psq\n@ps, aq P Sj \u02c6 Aj\nfor each t P T and pj, iq P J \u02c6 t1, . . . , nju, which in turn implies that\nP \u201c s\u0303t,pj,iq \u201c s ^ a\u0303t,pj,iq \u201c a \u2030 \u201c P \u201c a\u0303t,pj,iq \u201c a | s\u0303t,pj,iq \u201c s \u2030 \u00a8P \u201c s\u0303t,pj,iq \u201c s \u2030 \u201c \u03c0LPtj ps, aq \u03c3LPtj psq \u00a8P \u201c s\u0303t,pj,iq \u201c s \u2030 .\n(7)\nIn the remainder of the proof, we show via induction on t P T that P \u201c s\u0303t,pj,iq \u201c s \u2030 \u201c \u03c3LPtj psq {nj for all t P T , pj, iq P J \u02c6 t1, . . . , nju and s P Sj , which concludes the proof.\nFor t \u201c 1, the definition of the weakly coupled DP implies that P \u201c s\u0303t,pj,iq \u201c s \u2030 \u201c qjpsq, and the\nfirst constraint of the fluid LP (4) ensures that \u03c3LP1j psq \u201c nj \u00a8qjpsq. Assume now that P \u201c s\u0303t,pj,iq \u201c s \u2030 \u201c \u03c3LPtj psq {nj for some t P T ztT u. We then have\nP \u201c s\u0303t`1,pj,iq \u201c s1 \u2030 \u201c \u00ff\nsPSj\n\u00ff\naPAj\npjtps1|s, aq \u00a8 P \u201c s\u0303t,pj,iq \u201c s ^ a\u0303t,pj,iq \u201c a \u2030\n\u201c \u00ff\nsPSj\n\u00ff\naPAj\npjtps1|s, aq \u00a8 \u03c0LPtj ps, aq \u03c3LPtj psq \u00a8 P \u201c s\u0303t,pj,iq \u201c s \u2030\n\u201c \u00ff\nsPSj\n\u00ff\naPAj\npjtps1|s, aq \u00a8 \u03c0LPtj ps, aq\nnj \u201c \u03c3LPt`1,jps1q nj ,\nwhere the first identity follows from the definition of the weakly coupled DP, the second identity is due to (7), the third identity follows from the induction hypothesis, and the last identity is due to the second constraint of the fluid LP (4).\nLemma 2. Let \u03b1\u0303\u2039tjps, aq \u201c \u0159nj i\u201c1 1 \u201c s\u0303t,pj,iq \u201c s ^ a\u0303t,pj,iq \u201c a \u2030 record the number of DPs in the j-th group that are in state s and to which action a is applied at time t. Then\nE \u201c \u03b1\u0303\u2039tjps, aq \u2030 \u201c \u03c0LPtj ps, aq @t P T , @j P J , @ps, aq P Sj \u02c6 Aj .\nFurthermore, with probability at least 1 \u00b4 |T | {N2, we have\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\n\u03c9tjps, aq \u00a8 \u201c \u03b1\u0303\u2039tjps, aq \u00b4 \u03c0LPtj ps, aq \u2030 \u010f a\nN logN \u00a8 max jPJ \u2225\u03c9tj \u00b4 \u03c9\u0302tj \u00a8 e\u22252 @t P T ,\nwhere \u03c9tj : Sj \u02c6 Aj \u00d1 R are (arbitrary) weighting functions and \u03c9\u0302tj P R are arbitrary constants, t P T and j P J , e : Sj \u02c6Aj \u00d1 R is the all-one function satisfying eps, aq \u201c 1 for all ps, aq P Sj \u02c6Aj and the 2-norm is taken over the components ps, aq P Sj \u02c6 Aj of \u03c9tj \u00b4 \u03c9\u0302tj \u00a8 e.\nProof of Lemma 2. In view of the first statement, we note that\nE \u201c \u03b1\u0303\u2039tjps, aq \u2030\n\u201c nj \u00ff\ni\u201c1 P\n\u201c s\u0303t,pj,iq \u201c s ^ a\u0303t,pj,iq \u201c a \u2030 \u201c nj \u00ff\ni\u201c1\n\u03c0LPtj ps, aq nj \u201c \u03c0LPtj ps, aq,\nwhere the first and second identity follow from the definition of \u03b1\u0303\u2039tjps, aq and Lemma 1, respectively.\nAs for the second statement, note that\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\n\u03c9tjps, aq\u00a8 \u201c \u03b1\u0303\u2039tjps, aq \u00b4 \u03c0LPtj ps, aq \u2030 \u201c \u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nr\u03c9tjps, aq \u00b4 \u03c9\u0302tj \u00a8 es\u00a8 \u201c \u03b1\u0303\u2039tjps, aq \u00b4 \u03c0LPtj ps, aq \u2030\nP-a.s., where the identity holds because\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nr\u03c9\u0302tj \u00a8 es \u00a8 \u201c \u03b1\u0303\u2039tjps, aq \u00b4 \u03c0LPtj ps, aq \u2030 \u201c \u00ff\njPJ \u03c9\u0302tj \u00a8\n\u00a8\n\u02dd\n\u00ff\nsPSj\n\u00ff\naPAj\n\u03b1\u0303\u2039tjps, aq \u00b4 \u00ff\nsPSj\n\u00ff\naPAj\n\u03c0LPtj ps, aq\n\u02db\n\u201a\n\u201c \u00ff\njPJ \u03c9\u0302tj \u00a8 pnj \u00b4 njq \u201c 0\nP-a.s. Moreover, each \u03b1\u0303\u2039tjps, aq is a sum of i.i.d. random variables; Hoeffding\u2019s inequality thus implies\nP\n\u00bb\n\u2013\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nr\u03c9tjps, aq \u00b4 \u03c9\u0302tjs \u00a8 \u201c \u03b1\u0303\u2039tjps, aq \u00b4 \u03c0LPtj ps, aq \u2030 \u010f \u03b3\nfi\nfl \u011b 1\u00b4exp\n\u00a8\n\u02da \u02da \u02dd\n\u00b4 2\u03b3 2 \u00ff\njPJ nj\n\u00ff\nsPSj\n\u00ff\naPAj\nr\u03c9tjps, aq \u00b4 \u03c9\u0302tjs2\n\u02db\n\u2039 \u2039 \u201a\nfor all t P T and \u03b3 \u0105 0. Since\n\u00ff jPJ nj \u00ff sPSj \u00ff aPAj r\u03c9tjps, aq \u00b4 \u03c9\u0302tjs2 \u010f N \u00a8 max jPJ \u2225\u03c9tj \u00b4 \u03c9\u0302tj \u00a8 e\u22252 ,\nthe statement follows from the choice \u03b3 \u201c ? N logN \u00a8maxjPJ \u2225\u03c9tj \u00b4 \u03c9\u0302tj \u00a8 e\u22252 and the union bound.\nProof of Theorem 1. In view of the bound on the expected total reward, we have\n\u03b8\u2039 \u201c E \u00ab \u00ff\ntPT\n\u00ff\njPJ\nnj \u00ff i\u201c1 rjtps\u0303t,pj,iq, a\u0303t,pj,iqq\nff\n\u201c E\n\u00bb\n\u2013\n\u00ff\ntPT\n\u00ff\njPJ\nnj \u00ff\ni\u201c1\n\u00ff\nsPSj\n\u00ff\naPAj\nrjtps, aq \u00a8 1 \u201c s\u0303t,pj,iq \u201c s ^ a\u0303t,pj,iq \u201c a \u2030\nfi\nfl\n\u201c \u00ff\ntPT\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nrjtps, aq \u00a8 E \u201c \u03b1\u0303\u2039tjps, aq \u2030\n\u201c \u00ff\ntPT\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nrjtps, aq \u00a8 \u03c0LPtj ps, aq\n\u201c \u03b8LP \u011b \u03b8DP,\nwhere the first identity holds by definition of \u03b8\u2039, the third identity follows from the definition of \u03b1\u0303\u2039tjps, aq in Lemma 2, the fourth identity is due to Lemma 2, the last identity holds by definition of \u03b8LP, and the inequality holds since the fluid LP (4) is a relaxation of the weakly coupled DP.\nAs for the resource violation, with probability at least 1 \u00b4 |T | {N2 we have\n\u00ff\njPJ\nnj \u00ff i\u201c1 ctljps\u0303t,pj,iq, a\u0303t,pj,iqq \u201c \u00ff jPJ nj \u00ff i\u201c1 \u00ff sPSj \u00ff aPAj ctljps, aq \u00a8 1 \u201c s\u0303t,pj,iq \u201c s ^ a\u0303t,pj,iq \u201c a \u2030\n\u201c \u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nctljps, aq \u00a8 \u03b1\u0303\u2039tjps, aq\n\u010f \u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nctljps, aq \u00a8 \u03c0LPtj ps, aq ` a\nN logN \u00a8 max jPJ \u2225ctlj\u22252\n\u010f btl ` a\nN logN \u00a8 max jPJ \u2225ctlj\u22252\nfor all t P T and any fixed l P L, where the second identity holds by definition of \u03b1\u0303\u2039tjps, aq in Lemma 2, the first inequality follows from the second part of Lemma 2 if we choose \u03c9tj \u201c ctlj and \u03c9\u0302tj \u201c 0, and the second inequality is implied by the third constraint of the fluid LP (4). The result then follows from an application of the union bound to the |L| resource constraints l P L.\nProof of Theorem 2. The bound on the resource violation is the same as in Theorem 1, and we refer to its proof for the justification of the bound. In view of the bound on the worst-case total\nreward, we observe that with probability at least 1 \u00b4 |T | {N2, we have\n\u03b8\u0303\u2039 \u201c \u00ff\ntPT\n\u00ff\njPJ\nnj \u00ff i\u201c1 rjtps\u0303t,pj,iq, a\u0303t,pj,iqq\n\u201c \u00ff\ntPT\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nrjtps, aq \u00a8 \u03b1\u0303\u2039tjps, aq\n\u011b \u00ff\ntPT\n\u00bb\n\u2013\n\u00ff\njPJ\n\u00ff\nsPSj\n\u00ff\naPAj\nrjtps, aq \u00a8 \u03c0LPtj ps, aq \u00b4 a\nN logN \u00a8 max jPJ \u2225rjt\u22252\nfi\nfl\n\u201c \u03b8LP \u00b4 \u00ff\ntPT\na\nN logN \u00a8 max jPJ \u2225rjt\u22252\n\u011b \u03b8DP \u00b4 |T | \u00a8 a\nN logN \u00a8 max tPT , jPJ \u2225rjt\u22252 ,\nwhere the first identity is due to the definition of \u03b8\u0303\u2039, the second identity follows from the definition of \u03b1\u0303\u2039tjps, aq in Lemma 2, the first inequality follows from the second part of Lemma 2 if we choose \u03c9tj \u201c \u00b4rjt and \u03c9\u0302tj \u201c 0, the last identity follows from the definition of \u03b8LP, and the second inequality holds since the fluid LP (4) is a relaxation of the weakly coupled DP. The result then follows if we apply the union bound to jointly bound (i) the probability of the total reward violating the above inequality and (ii) any of the resource constraints being violated.\nProof of Proposition 3. We prove the statement in two steps. We first show that the optimal value of the fluid LP (4) does not decrease significantly if we reduce the resource limits from tbtlut,l to tbredtl ut,l. Note that the expected total reward of any optimal policy for the grouped weakly coupled DP is bounded above by the optimal value of the fluid LP (4) under the original resource limits, and that the proof of Theorem 1 implies that the expected total reward of the auxiliary policy \u03c0red equals the optimal value of the fluid LP (4) under the updated resource limits. We then argue in a second step that the feasible randomized policy \u03c0F deviates from the auxiliary policy \u03c0red only with small probability, and that the impact of those deviations can be bounded.\nIn view of the first step, denote by \u03b8LP : RLT` \u00d1 R the function that maps resource limits to the optimal value of the corresponding fluid LP (4). Standard results from linear programming imply\nthat \u03b8LP is non-decreasing and concave. We thus observe that\n\u03b8LPpbredq \u011b \u03b8LP \u00a8\n\u02ddmin tPT , lPL\n\" bredtl btl * \u00a8 b\n\u02db\n\u201a \u011b min tPT , lPL\n\" bredtl btl * \u00a8 \u03b8LPpbq `\n\u00a8\n\u02dd1 \u00b4 min tPT , lPL\n\" bredtl btl *\n\u02db \u201a\u00a8 \u03b8LPp0q, (8)\nwhere b \u201c tbtlut,l and bred \u201c tbredtl ut,l represent the original and updated resource limits of the grouped weakly coupled DP, respectively. Here, the first inequality follows from the fact that \u03b8LP is non-decreasing, while the second equality is due to the concavity of \u03b8LP. Since\nmin tPT , lPL\n\" bredtl btl *\n\u201c min tPT , lPL\n\"\u201e\nbtl \u00b4 a\nN logN \u00a8 max jPJ \u2225ctlj\u22252\n\u0237\n` { btl\n*\n\u011b min tPT , lPL\n\"\u02c6\nbtl \u00b4 a\nN logN \u00a8 max jPJ \u2225ctlj\u22252\n\u02d9 { btl *\n\u201c 1 \u00b4 c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u00a8 \u2225ctlj\u22252\n*\nand \u03b8LPp0q \u011b N \u00a8 |T | \u00a8 r by construction, we thus obtain that\n\u03b8LPpbredq \u011b min tPT , lPL\n\" bredtl btl * \u00a8 \u201c \u03b8LPpbq \u00b4 \u03b8LPp0q \u2030 ` \u03b8LPp0q\n\u011b\n\u00a8 \u02dd1 \u00b4 c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u00a8 \u2225ctlj\u22252\n*\n\u02db \u201a\u00a8 \u201c \u03b8LPpbq \u00b4 \u03b8LPp0q \u2030 ` \u03b8LPp0q\n\u011b\n\u00a8 \u02dd1 \u00b4 c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u00a8 \u2225ctlj\u22252\n*\n\u02db \u201a\u00a8 \u03b8LPpbq (9)\n` c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u00a8 \u2225ctlj\u22252\n*\n\u00a8 N \u00a8 |T | \u00a8 r, (10)\nwhere the first inequality holds because of (8) and the second one holds since \u03b8LP is non-decreasing.\nAs for the second step, we note that the auxiliary policy \u03c0red (which was constructed under the updated resource limits bred) violates the original resource limits b with probability at most |T | \u00a8 |L| {N2. Indeed, for pt, lq P T \u02c6 L with bredtl \u0105 0, this follows from Theorem 1 and the construction of bred, whereas for pt, lq P T \u02c6 L with bredtl \u201c 0, this holds due to the fact that the optimal solution p\u03c3LP, \u03c0LPq to the fluid LP (4) with resource limits bred will satisfy \u03c0LPtj ps, aq \u201c 0\nfor all ps, aq P Sj \u02c6 Aj where ctljps, aq \u0105 0. The feasible randomized policy \u03c0F coincides with the auxiliary policy \u03c0red on state-action trajectories where \u03c0red satisfies all of the original resource limits, whereas the actually realized total reward of \u03c0F falls below that of \u03c0red by at most N \u00a8 |T | \u00a8 pr \u00b4 rq on state-action trajectories where \u03c0red violates some of the original resource limits. Thus, the expected total rewards \u03b8F and \u03b8red of the policies \u03c0F and \u03c0red, respectively, satisfy\n\u03b8F \u011b \u03b8red \u00b4 |T | \u00a8 |L| N2 \u00a8 rN \u00a8 |T | \u00a8 pr \u00b4 rqs \u201c \u03b8red \u00b4 |T | 2 \u00a8 |L| \u00a8 pr \u00b4 rq N .\nRecalling from the proof of Theorem 1 that \u03b8red \u201c \u03b8LPpbredq and using (9), we thus obtain\n\u03b8F \u011b \u03b8red \u00b4 |T | 2 \u00a8 |L| \u00a8 pr \u00b4 rq N \u201c \u03b8LPpbredq \u00b4 |T | 2 \u00a8 |L| \u00a8 pr \u00b4 rq N\n\u011b\n\u00a8 \u02dd1 \u00b4 c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u00a8 \u2225ctlj\u22252\n*\n\u02db \u201a\u00a8 \u03b8LPpbq\n` c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u00a8 \u2225ctlj\u22252\n*\n\u00a8 N \u00a8 |T | \u00a8 r \u00b4 |T | 2 \u00a8 |L| \u00a8 pr \u00b4 rq\nN .\nThe statement now follows from the fact that \u03b8LPpbq \u011b \u03b8DP.\nProof of Proposition 4 Denote by \u03b8\u0303red the random total reward of the auxiliary policy \u03c0red constructed from an optimal solution to the fluid LP (4) with the updated resource limits bred. According to the statement and proof of Theorem 2, we have\n\u03b8\u0303red \u011b \u03b8LPpbredq \u00b4 |T | \u00a8 a\nN logN \u00a8 max tPT , jPJ \u2225rjt\u22252 (11a)\nas well as\n\u00ff\njPJ\nnj \u00ff i\u201c1 ctljps\u0303t,pj,iq, a\u0303t,pj,iqq \u010f bredtl ` a N logN \u00a8 max jPJ \u2225ctlj\u22252 @t P T , @l P L, (11b)\nboth jointly with probability at least 1 \u00b4 |T | \u00a8 p|L| ` 1q{N2. The inequality (11a) implies that with\nprobability at least 1 \u00b4 |T | \u00a8 p|L| ` 1q{N2, we have\n\u03b8\u0303red \u011b \u03b8LPpbredq \u00b4 |T | \u00a8 a\nN logN \u00a8 max tPT , jPJ \u2225rjt\u22252\n\u011b\n\u00a8 \u02dd1 \u00b4 c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u00a8 \u2225ctlj\u22252\n*\n\u02db \u201a\u00a8 \u03b8LPpbq\n` c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u00a8 \u2225ctlj\u22252\n*\n\u00a8 N \u00a8 |T | \u00a8 r \u00b4 |T | \u00a8 a\nN logN \u00a8 max tPT , jPJ \u2225rjt\u22252\n\u011b\n\u00a8 \u02dd1 \u00b4 c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u00a8 \u2225ctlj\u22252\n*\n\u02db \u201a\u00a8 \u03b8DP\n` c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u00a8 \u2225ctlj\u22252\n*\n\u00a8 N \u00a8 |T | \u00a8 r \u00b4 |T | \u00a8 a\nN logN \u00a8 max tPT , jPJ \u2225rjt\u22252 ,\nwhere the second inequality is due to the proof of Proposition 3, and the third inequality holds since the fluid LP (4) constitutes a relaxation of the grouped weakly coupled DP. As for the inequality (11b), on the other hand, the definition of the updated resource limits bred implies that\nbredtl ` c logN\nN \u00a8 max tPT , lPL,\njPJ\n\"\nN btl \u00a8 \u2225ctlj\u22252\n*\n\u201c btl\nfor all pt, lq P T \u02c6 L satisfying bredtl \u0105 0, while\n\u00ff\njPJ\nnj \u00ff i\u201c1 ctljps\u0303t,pj,iq, a\u0303t,pj,iqq \u201c 0 \u010f btl\nfor all pt, lq P T \u02c6L satisfying bredtl \u201c 0 (cf. the proof of Proposition 3). In other words, the auxiliary policy \u03c0red adheres to the original resource limits b with high probability. The statement of the proposition now follows from the fact that the feasible randomized policy \u03c0F coincides with the auxiliary policy \u03c0red whenever the latter satisfies the original resource limits, which according to the above discussion happens with high probability."
        }
    ],
    "title": "Optimal Hospital Care Scheduling During the SARS-CoV-2 Pandemic",
    "year": 2022
}