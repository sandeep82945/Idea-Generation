{
    "abstractText": "We study the performance of Markov chains for the q-state ferromagnetic Potts model on random regular graphs. While the cases of the grid and the complete graph are by now well-understood, the case of random regular graphs has resisted a detailed analysis and, in fact, even analysing the properties of the Potts distribution has remained elusive. It is conjectured that the performance of Markov chains is dictated by metastability phenomena, i.e., the presence of \u201cphases\u201d (clusters) in the sample space where Markov chains with local update rules, such as the Glauber dynamics, are bound to take exponential time to escape, and therefore cause slow mixing. The phases that are believed to drive these metastability phenomena in the case of the Potts model emerge as local, rather than global, maxima of the so-called Bethe functional, and previous approaches of analysing these phases based on optimisation arguments fall short of the task. Our first contribution is to detail the emergence of the two relevant phases for the q-state Potts model on the d-regular random graph for all integers q, d \u2265 3, and establish that for an interval of temperatures, delineated by the uniqueness and a broadcasting threshold on the d-regular tree, the two phases coexist (as possible metastable states). The proofs are based on a conceptual connection between spatial properties and the structure of the Potts distribution on the random regular graph, rather than complicated moment calculations. This significantly refines earlier results by Helmuth, Jenssen, and Perkins who had established phase coexistence for a small interval around the so-called ordereddisordered threshold (via different arguments) that applied for large q and d \u2265 5. Based on our new structural understanding of the model, our second contribution is to obtain metastability results for two classical Markov chains for the Potts model. We first comA preliminary version of the manuscript (without the proofs) appeared in the proceedings of ICALP 2022 (Track A). For the purpose of Open Access, the author has applied a CC BY public copyright licence to any Author Accepted Manuscript version arising from this submission. All data is provided in full in the results section of this paper. 186 A. Coja-Oghlan, A. Galanis, L. A. Goldberg, J. B. Ravelomanana, D. \u0160tefankovi\u010d, E. Vigoda plement recent fast mixing results for Glauber dynamics by Blanca and Gheissari below the uniqueness threshold, by showing an exponential lower bound on the mixing time above the uniqueness threshold. Then, we obtain tight results even for the non-local and more elaborate Swendsen\u2013Wang chain, where we establish slow mixing/metastability for the whole interval of temperatures where the chain is conjectured to mix slowly on the random regular graph. The key is to bound the conductance of the chains using a random graph \u201cplanting\u201d argument combined with delicate bounds on random-graph percolation.",
    "authors": [
        {
            "affiliations": [],
            "name": "Amin Coja-Oghlan"
        },
        {
            "affiliations": [],
            "name": "Andreas Galanis"
        },
        {
            "affiliations": [],
            "name": "Leslie Ann Goldberg"
        },
        {
            "affiliations": [],
            "name": "Jean Bernoulli Ravelomanana"
        },
        {
            "affiliations": [],
            "name": "Daniel \u0160tefankovi\u010d"
        },
        {
            "affiliations": [],
            "name": "Eric Vigoda"
        }
    ],
    "id": "SP:81214fd6643ffe16f2364c4b7f74999d5eaf3ba5",
    "references": [
        {
            "authors": [
                "E. Abbe"
            ],
            "title": "CommunityDetection and Stochastic BlockModels: RecentDevelopments",
            "venue": "Journal ofMaching Learning Research 18(1), 6446\u20136531",
            "year": 2017
        },
        {
            "authors": [
                "D. Achlioptas",
                "A. Coja-Oghlan"
            ],
            "title": "Algorithmic barriers from phase transitions",
            "venue": "49th Annual IEEE Symposium on Foundations of Computer Science, pp. 793\u2013802",
            "year": 2008
        },
        {
            "authors": [
                "D. Achlioptas",
                "A. Naor",
                "Y. Peres"
            ],
            "title": "Rigorous location of phase transitions in hard optimization problems",
            "venue": "Nature 435(7043), 759\u2013764",
            "year": 2005
        },
        {
            "authors": [
                "N. Alon",
                "I. Benjamini",
                "A. Stacey"
            ],
            "title": "Percolation on finite graphs and isoperimetric inequalities",
            "venue": "Ann. Probab. 32(3), 1727\u20131745",
            "year": 2004
        },
        {
            "authors": [
                "V. Bapst",
                "A. Coja-Oghlan"
            ],
            "title": "Harnessing the Bethe free energy",
            "venue": "Random Struct. Algorithms 49, 694\u2013741",
            "year": 2016
        },
        {
            "authors": [
                "J. Barbier",
                "C.L.C. Chan",
                "N. Macris"
            ],
            "title": "Concentration of multi-overlaps for random dilute ferromagnetic spin models",
            "venue": "J. Stat. Phys. 180, 534\u2013557",
            "year": 2019
        },
        {
            "authors": [
                "A. Blanca",
                "A. Galanis",
                "L. Goldberg",
                "D. \u0160tefankovi\u010d",
                "E. Vigoda",
                "K. Yang"
            ],
            "title": "Sampling in uniqueness from the Potts and random-cluster models on random regular graphs",
            "venue": "SIAM J. Discrete Math. 34(1), 742\u2013793",
            "year": 2020
        },
        {
            "authors": [
                "A. Blanca",
                "R. Gheissari"
            ],
            "title": "Random-cluster dynamics on random regular graphs in tree uniqueness",
            "venue": "Commun. Math. Phys. 386(2), 1243\u20131287",
            "year": 2021
        },
        {
            "authors": [
                "A. Blanca",
                "A. Sinclair"
            ],
            "title": "Dynamics for the mean-field random-cluster model",
            "venue": "Approximation, Randomization, and Combinatorial Optimization. Algorithms and Techniques (APPROX/RANDOM), pp. 528\u2013543",
            "year": 2015
        },
        {
            "authors": [
                "A. Blanca",
                "A. Sinclair",
                "X. Zhang"
            ],
            "title": "The critical mean-field Chayes\u2013Machta dynamics",
            "venue": "Approximation, Randomization, and Combinatorial Optimization. Algorithms and Techniques (APPROX/RANDOM)",
            "year": 2021
        },
        {
            "authors": [
                "M. Bordewich",
                "C. Greenhill",
                "V. Patel"
            ],
            "title": "Mixing of the Glauber dynamics for the ferromagnetic Potts model",
            "venue": "Random Struct. Algorithms 48(1), 21\u201352",
            "year": 2016
        },
        {
            "authors": [
                "C. Carlson",
                "E. Davies",
                "N. Fraiman",
                "A. Kolla",
                "A. Potukuchi",
                "C. Yap"
            ],
            "title": "Algorithms for the ferromagnetic potts model on expanders (2022)",
            "year": 1923
        },
        {
            "authors": [
                "A. Coja-Oghlan",
                "O. Cooley",
                "M. Kang",
                "J. Lee",
                "J.B. Ravelomanana"
            ],
            "title": "The sparse parity matrix",
            "venue": "Proceedings of the 2022 Annual ACM-SIAM Symposium on Discrete Algorithms(SODA), pp. 822\u2013833",
            "year": 2022
        },
        {
            "authors": [
                "A. Coja-Oghlan",
                "C. Efthymiou",
                "S. Hetterich"
            ],
            "title": "On the chromatic number of random regular graphs",
            "venue": "J. Comb. Theory Ser. B 116, 367\u2013439",
            "year": 2016
        },
        {
            "authors": [
                "A. Coja-Oghlan",
                "C. Efthymiou",
                "N. Jaafari",
                "M. Kang",
                "T. Kapetanopoulos"
            ],
            "title": "Charting the replica symmetric phase",
            "venue": "Commun. Math. Phys. 359(2), 603\u2013698",
            "year": 2018
        },
        {
            "authors": [
                "A. Coja-Oghlan",
                "O. Gebhard",
                "M. Hahn-Klimroth",
                "P. Loick"
            ],
            "title": "Optimal group testing",
            "venue": "Comb. Probab. Comput. 30(6), 811\u2013848",
            "year": 2021
        },
        {
            "authors": [
                "A. Coja-Oghlan",
                "F. Krzakala",
                "W. Perkins",
                "L. Zdeborov\u00e1"
            ],
            "title": "Information-theoretic thresholds from the cavity method",
            "venue": "Adv. Math. 333, 694\u2013795",
            "year": 2018
        },
        {
            "authors": [
                "A. Coja-Oghlan",
                "P. Loick",
                "B.F. Mezei",
                "G.B. Sorkin"
            ],
            "title": "The Ising antiferromagnet and MaxCut on random regular graphs",
            "venue": "SIAM J. Discrete Math. 36(2), 1306\u20131342",
            "year": 2022
        },
        {
            "authors": [
                "M. Coulson",
                "E. Davies",
                "A. Kolla",
                "V. Patel",
                "G. Regts"
            ],
            "title": "Statistical physics approaches to Unique Games",
            "venue": "Proceedings of the 35th Computational Complexity Conference, CCC \u201920",
            "year": 2020
        },
        {
            "authors": [
                "P. Cuff",
                "J. Ding",
                "O. Louidor",
                "E. Lubetzky",
                "Y. Peres",
                "A. Sly"
            ],
            "title": "Glauber dynamics for the mean-field Potts model",
            "venue": "J. Stat. Phys. 149(3), 432\u2013477",
            "year": 2012
        },
        {
            "authors": [
                "A. Dembo",
                "A. Montanari"
            ],
            "title": "Ising models on locally tree-like graphs",
            "venue": "Ann. Appl. Probab. 20(2), 565\u2013592",
            "year": 2010
        },
        {
            "authors": [
                "A. Dembo",
                "A. Montanari",
                "A. Sly",
                "N. Sun"
            ],
            "title": "The replica symmetric solution for Potts models on d-regular graphs",
            "venue": "Commun. Math. Phys. 327(2), 551\u2013575",
            "year": 2014
        },
        {
            "authors": [
                "A. Dembo",
                "A. Montanari",
                "N. Sun"
            ],
            "title": "Factor models on locally tree-like graphs",
            "venue": "Ann. Probab. 41(6), 4162\u20134213",
            "year": 2013
        },
        {
            "authors": [
                "C. Efthymiou"
            ],
            "title": "On sampling symmetric Gibbs distributions on sparse random graphs and hypergraphs",
            "venue": "49th International ColloquiumonAutomata, Languages, and Programming(ICALP2022), pp. 57:1\u201357:16",
            "year": 2022
        },
        {
            "authors": [
                "N. Fountoulakis"
            ],
            "title": "Percolation on sparse random graphs with given degree sequence",
            "venue": "Internet Math. 4(4), 329\u2013356",
            "year": 2007
        },
        {
            "authors": [
                "A. Galanis",
                "D. \u0160tefankovi\u010d",
                "E. Vigoda"
            ],
            "title": "Swendsen\u2013Wang algorithm on the mean-field Potts model",
            "venue": "Random Struct. Algorithms 54(1), 82\u2013147",
            "year": 2019
        },
        {
            "authors": [
                "A. Galanis",
                "D. \u0160tefankovi\u010d",
                "E. Vigoda",
                "L. Yang"
            ],
            "title": "Ferromagnetic Potts model: refined#BIS-hardness and related results",
            "venue": "SIAM J. Comput. 45(6), 2004\u20132065",
            "year": 2016
        },
        {
            "authors": [
                "R. Gheissari",
                "E. Lubetzky"
            ],
            "title": "Mixing times of critical two-dimensional Potts models",
            "venue": "Commun. Pure Appl. Math. 71(5), 994\u20131046",
            "year": 2018
        },
        {
            "authors": [
                "R. Gheissari",
                "E. Lubetzky",
                "Y. Peres"
            ],
            "title": "Exponentially slow mixing in the mean-field Swendsen\u2013Wang dynamics",
            "venue": "Proceedings of the Twenty-Ninth Annual ACM-SIAMSymposium on Discrete Algorithms (SODA)",
            "year": 2018
        },
        {
            "authors": [
                "R. Gheissari",
                "A. Sinclair"
            ],
            "title": "Low-temperature Ising dynamics with random initializations",
            "venue": "Proceedings of the 54th Annual ACMSIGACT Symposium on Theory of Computing (STOC2022), pp. 1445\u20131458",
            "year": 2022
        },
        {
            "authors": [
                "V.K. Gore",
                "M.R. Jerrum"
            ],
            "title": "The Swendsen\u2013Wang process does not always mix rapidly",
            "venue": "J. Stat. Phys. 97(1), 67\u201386",
            "year": 1999
        },
        {
            "authors": [
                "O. H\u00e4ggstr\u00f6m"
            ],
            "title": "The random-cluster model on a homogeneous tree",
            "venue": "Probab. Theory Relat. Fields 104(2), 231\u2013253",
            "year": 1996
        },
        {
            "authors": [
                "T. Helmuth",
                "M. Jenssen",
                "W. Perkins"
            ],
            "title": "Finite-size scaling, phase coexistence, and algorithms for the random cluster model on random graphs (2020)",
            "year": 2006
        },
        {
            "authors": [
                "S. Janson",
                "M.J. Luczak"
            ],
            "title": "A new approach to the giant component problem",
            "venue": "Random Struct. Algorithms 34(2), 197\u2013216",
            "year": 2009
        },
        {
            "authors": [
                "S. Janson",
                "A. Rucinski",
                "T. \u0141uczak"
            ],
            "title": "Random Graphs",
            "venue": "Wiley",
            "year": 2011
        },
        {
            "authors": [
                "M. Krivelevich",
                "E. Lubetzky",
                "B. Sudakov"
            ],
            "title": "Asymptotics in percolation on high-girth expanders",
            "venue": "Random Struct. Algorithms 56(4), 927\u2013947",
            "year": 2020
        },
        {
            "authors": [
                "J. Lee"
            ],
            "title": "Energy landscape and metastability of Curie\u2013Weiss\u2013Potts model",
            "venue": "J. Stat. Phys. 187(1), 1\u201346",
            "year": 2022
        },
        {
            "authors": [
                "D.A. Levin",
                "Y. Peres"
            ],
            "title": "Markov Chains and Mixing Times",
            "venue": "American Mathematical Society",
            "year": 2009
        },
        {
            "authors": [
                "E. Lubetzky",
                "A. Sly"
            ],
            "title": "Critical Ising on the square lattice mixes in polynomial time",
            "venue": "Commun. Math. Phys. 313(3), 815\u2013836",
            "year": 2012
        },
        {
            "authors": [
                "M. Mezard",
                "A. Montanari"
            ],
            "title": "Information, Physics, and Computation",
            "venue": "Oxford University Press",
            "year": 2009
        },
        {
            "authors": [
                "M. M\u00e9zard"
            ],
            "title": "Mean-field message-passing equations in the Hopfield model and its generalizations",
            "venue": "Phys. Rev. E 95(2), 022117",
            "year": 2017
        },
        {
            "authors": [
                "M. M\u00e9zard",
                "G. Parisi"
            ],
            "title": "The Bethe lattice spin glass revisited",
            "venue": "Eur. Phys. J. B Condens. Matter Complex Syst. 20(2), 217\u2013233",
            "year": 2001
        },
        {
            "authors": [
                "M. M\u00e9zard",
                "G. Parisi"
            ],
            "title": "The cavity method at zero temperature",
            "venue": "J. Stat. Phys. 111(1), 1\u201334",
            "year": 2003
        },
        {
            "authors": [
                "M. Molloy",
                "B. Reed"
            ],
            "title": "The size of the giant component of a random graph with a given degree sequence",
            "venue": "Comb. Probab. Comput. 7(3), 295\u2013305",
            "year": 1998
        },
        {
            "authors": [
                "A. Nachmias",
                "Y. Peres"
            ],
            "title": "Critical percolation on random regular graphs",
            "venue": "RandomStruct. Algorithms 36(2), 111\u2013148",
            "year": 2010
        },
        {
            "authors": [
                "T. Richardson",
                "R. Urbanke"
            ],
            "title": "Modern Coding Theory",
            "venue": "Cambridge University Press",
            "year": 2008
        },
        {
            "authors": [
                "N. Ruozzi"
            ],
            "title": "The Bethe partition function of log-supermodular graphical models",
            "venue": "Advances in Neural Information Processing Systems, vol. 25",
            "year": 2012
        },
        {
            "authors": [
                "A. Sly"
            ],
            "title": "Computational transition at the uniqueness threshold",
            "venue": "51st Annual IEEE Symposium on Foundations of Computer Science (FOCS), pp. 287\u2013296",
            "year": 2010
        },
        {
            "authors": [
                "A. Sly",
                "N. Sun"
            ],
            "title": "The computational hardness of counting in two-spin models on d-regular graphs",
            "venue": "53rd Annual IEEE Symposium on Foundations of Computer Science (FOCS), pp. 361\u2013369",
            "year": 2012
        },
        {
            "authors": [
                "M. Ullrich"
            ],
            "title": "Swendsen\u2013Wang is faster than single-bond dynamics",
            "venue": "SIAM J. Discrete Math. 28(1), 37\u201348",
            "year": 2014
        },
        {
            "authors": [
                "P.O. Vontobel"
            ],
            "title": "Counting in graph covers: a combinatorial characterization of the Bethe entropy function",
            "venue": "IEEE Trans. Inf. Theory 59(9), 6018\u20136048",
            "year": 2013
        },
        {
            "authors": [
                "J.S. Yedidia",
                "W.T. Freeman",
                "Y. Weiss"
            ],
            "title": "Understanding belief propagation and its generalizations",
            "venue": "Explor. Artif. Intell. New Millenn. 8, 239\u2013269",
            "year": 2003
        }
    ],
    "sections": [
        {
            "text": "A preliminary version of the manuscript (without the proofs) appeared in the proceedings of ICALP 2022 (Track A). For the purpose of Open Access, the author has applied a CC BY public copyright licence to any Author Accepted Manuscript version arising from this submission. All data is provided in full in the results section of this paper.\nplement recent fast mixing results for Glauber dynamics by Blanca and Gheissari below the uniqueness threshold, by showing an exponential lower bound on the mixing time above the uniqueness threshold. Then, we obtain tight results even for the non-local and more elaborate Swendsen\u2013Wang chain, where we establish slow mixing/metastability for the whole interval of temperatures where the chain is conjectured to mix slowly on the random regular graph. The key is to bound the conductance of the chains using a random graph \u201cplanting\u201d argument combined with delicate bounds on random-graph percolation."
        },
        {
            "heading": "1. Introduction",
            "text": "1.1. Motivation. Spin systems on random graphs have turned out to be a source of extremely challenging problems at the junction ofmathematical physics and combinatorics [42,43]. Beyond the initial motivation of modelling disordered systems, applications have sprung up in areas as diverse as computational complexity, coding theory, machine learning and even screening for infectious diseases; e.g. [1,16,27,41,46,48,49]. Progress has been inspired largely by techniques from statistical physics, which to a significant extent still await a rigorous justification. The physicists\u2019 sophisticated but largely heuristic tool is the Belief Propagation message passing scheme in combination with a functional called the Bethe free energy [40]. Roughly speaking, the fixed points of Belief Propagation are conjectured to correspond to the \u2018pure states\u2019 of the underlying distribution, with the Bethe functional gauging the relative weight of the different pure states. Yet at closer inspection matters are actually rather complicated. For instance, the system typically possesses spurious Belief Propagation fixed points without any actual combinatorial meaning, while other fixed points need not correspond tometastable states that attract dynamics such as the Glauber Markov chain [13,17]. Generally, the mathematical understanding of the connection between Belief Propagation and dynamics leaves much to be desired.\nIn this paper we investigate the ferromagnetic Potts model on the random regular graph.Recall, for an integerq \u2265 3and real\u03b2 > 0, thePottsmodel on agraphG = (V, E) corresponds to a probability distribution \u03bcG,\u03b2 over all possible configurations [q]V , commonly referred to as the Boltzmann/Gibbs distribution; the weight of a configuration \u03c3 in the distribution is defined as \u03bcG,\u03b2(\u03c3 ) = e\u03b2HG (\u03c3 )/Z\u03b2(G) where HG(\u03c3 ) is the number of edges that are monochromatic under \u03c3 , and Z\u03b2(G) = \u2211\u03c4\u2208[q]V e\u03b2HG (\u03c4 ) is the normalising factor of the distribution. In physics jargon, \u03b2 corresponds to the socalled inverse-temperature of themodel,HG( \u00b7 ) is known as theHamiltonian, and Z\u03b2( \u00b7 ) is the partition function. Note, since \u03b2 > 0, the Boltzmann distribution assigns greater weight to configurations \u03c3 where many edges join vertices of the same colour; thus, the pairwise interactions between vertices are ferromagnetic.\nThe Potts model on the d-regular random graph has two distinctive features. First, the local geometry of the random regular graph is essentially deterministic. For any fixed radius , the depth- neighbourhood of all but a tiny number of vertices is just a dregular tree. Second, the ferromagnetic nature of the model precludes replica symmetry breaking, a complex type of long-range correlations [40]. Given these, it is conjectured that the model on the random regular graph has a similar behaviour to that on the clique (the so-called mean field case), and there has already been some preliminary evidence of this correspondence [6,22,23,27,33]. On the clique, the phase transitions are driven by a battle between two subsets of configurations (phases): (i) the paramagnetic/disordered phase, consisting of configurations where every colour appears roughly equal number\nof times, and (ii) the ferromagnetic/ordered phase, where one of the colours appears more frequently than the others. It is widely believed that these two phases also mark (qualitatively) the same type of phase transitions for the Potts model on the random regular graph, yet this has remained largely elusive.\nThe main reason that this behaviour is harder to establish on the random regular graph is that it has a non-trivial global geometry which makes both the analysis of the distribution and Markov chains significantly more involved (to say the least). In particular, the emergence of the metastable states in the distribution, which can be established by way of calculus in the mean-field case, is out of reach with single-handed analytical approaches in the random regular graph and it is therefore not surprising that it has resisted a detailed analysis so far. Likewise, the analysis of Markov chains is a far more complicated task since their evolution needs to be considered in terms of the graph geometry and therefore much harder to keep track of.\nOur main contribution is to detail the emergence of the metastable states, viewed as fixed points of Belief Propagation on this model, and their connection with the dynamic evolution of the two most popular Markov chains, the Glauber dynamics and the Swensen-Wang chain. We prove that these natural fixed points, whose emergence is directly connected with the phase transitions of the model, have the combinatorial meaning in terms of both the pure state decomposition of the distribution and the Glauber dynamics that physics intuition predicts they should. The proofs avoid the complicated moment calculations and the associated complex optimistion arguments that have become a hallmark of the study of spin systems on random graphs [3]. Instead, building upon and extending ideas from [5,18], we exploit a connection between spatial mixing properties on the d-regular tree and the Boltzmann distribution. Our metastability results for the Potts model significantly refine those appearing in the literature, especially those in [27,33] which are more relevant to this work, see Sect. 1.6 for a more detailed discussion.\nWe expect that this approach might carry over to other examples, particularly other ferromagnetic models. Let us begin by recapitulating Belief Propagation.\n1.2. Belief propagation. Suppose that n, d \u2265 3 are integers such that dn is even and let G = G(n, d) be the random d-regular graph on the vertex set [n] = {1, . . . , n}. For an inverse temperature parameter \u03b2 > 0 and an integer q \u2265 3 we set out to investigate the Boltzmann distribution \u03bcG,\u03b2 ; let us write \u03c3G,\u03b2 for a configuration drawn from \u03bcG,\u03b2 .\nA vital step toward understanding the Boltzmann distribution is to get a good handle on the partition function Z\u03b2(G). Indeed, according to the physicsts\u2019 cavitymethod,Belief Propagation actually solves both problems in one fell swoop [40]. To elaborate, with each edge e = uv of G, Belief Propagation associates two messages \u03bcG,\u03b2,u\u2192v, \u03bcG,\u03b2,v\u2192u , which are probability distributions on the set [q] of colours. The message \u03bcG,\u03b2,u\u2192v(c) is defined as the marginal probability of v receiving colour c in a configuration drawn from the Potts model on the graph G \u2212 u obtained by removing u. The semantics of \u03bcG,\u03b2,v\u2192u is analogous.\nUnder the assumption that the colours of far apart vertices of G are asymptotically independent, one can heuristically derive a set of equations that links the various messages together. For a vertex v, let \u2202v be the set of neighbours of v, and for an integer \u2265 1 let \u2202 v be the set of vertices at distance precisely from v. The Belief Propagation equations read\n\u03bcG,\u03b2,v\u2192u(c) = \u220f w\u2208\u2202v\\{u} 1 + (e\u03b2 \u2212 1)\u03bcG,\u03b2,w\u2192v(c) \u2211\n\u03c7\u2208[q] \u220f w\u2208\u2202v\\{u} 1 + (e\u03b2 \u2212 1)\u03bcG,\u03b2,w\u2192v(\u03c7) (uv \u2208 E(G), c \u2208 [q]).\n(1.1)\nThe insight behind (1.1) is that once we remove v from the graph, its neighbours w = u are typically far apart from one another because G contains only a negligible number of short cycles. Hence, we expect that in G \u2212 v the spins assigned to w \u2208 \u2202v\\ {u} are asymptotically independent. From this assumption it is straightforward to derive the sum-product-formula (1.1).\nA few obvious issues spring to mind. First, for large \u03b2 it is not actually true that far apart vertices decorrelate. This is because at low temperature there occur q different ferromagnetic pure states, one for each choice of the dominant colour. To break the symmetry between them one could introduce a weak external field that slighly boosts a specific colour or, more bluntly, confine oneself to a conditional distribution on subspace where a specific colour dominates. In the definitionof themessages and in (1.1)we should thus replace the Boltzmann distribution by the conditional distribution \u03bcG,\u03b2( \u00b7 | S) for a suitable S \u2286 [q]n . Second, even for the conditional measure we do not actually expect (1.1) to hold precisely. This is because for any finite n minute correlations between far apart vertices are bound to remain.\nNonetheless, precise solutions (\u03bcv\u2192u)uv\u2208E(G) to (1.1) are still meaningful. They correspond to stationary points of a functional called the Bethe free energy, which connects Belief Propagation with the problem of approximating the partition function [52]. Given a collection (\u03bcu\u2192v)uv\u2208E(G) of probability distributions on [q], the Bethe functional reads\nBG,\u03b2 ( (\u03bcu\u2192v)uv\u2208E(G) ) = 1 n\n\u2211\nv\u2208V (G) log\n[ \u2211\nc\u2208[q]\n\u220f\nw\u2208\u2202v 1 + (e\u03b2 \u2212 1)\u03bcw\u2192v(c)\n]\n\u2212 1 n\n\u2211\nvw\u2208E(G) log\n[\n1 + (e\u03b2 \u2212 1) \u2211\nc\u2208[q] \u03bcv\u2192w(c)\u03bcw\u2192v(c)\n]\n.\n(1.2) According to the cavity method the maximum of BG,\u03b2 ( (\u03bcu\u2192v)uv\u2208E(G) ) over all solutions (\u03bcu\u2192v)uv\u2208E(G) to (1.1) should be asymptotically equal to log Z\u03b2(G) with high probability.\nIn summary, physics lore holds that the solutions (\u03bcu\u2192v)uv\u2208E(G) to (1.1) are meaningful because they correspond to a decomposition of the phase space [q]n into pieces where long-range correlations are absent. Indeed, these \u201cpure states\u201d are expected to exhibit metastability, i.e., they trap dynamics such as the Glauber Markov chain for an exponential amount of time. Moreover, the relative probabilities of the pure states are expected to be governed by their respective Bethe free energy. In the following we undertake to investigate these claims rigorously.\nBefore proceeding, let us mention that ferromagnetic spin systems on random graphs have been among the first models for which predictions based on the cavity method could be verified rigorously. Following seminal work by Dembo and Montanari on the Ising model [21] vindicating the \u201creplica symmetric ansatz\u201d, Dembo et al. [23] studied, among other things, the Gibbs unique phase of the Potts ferromagnet on the random regular graph, andDembo,Montanari, Sly and Sun [23] established the free energy of the model for all \u03b2 (and d even). More generally, Ruozzi [47] pointed out how graph covers [51] can be used to investigate the partition function of supermodular models, of which\nthe Ising ferromagnet is an example. In addition, Barbier, Chan and Macris [6] proved that ferromagnetic spin systems on random graphs are generally replica symmetric in the sense that themulti-overlaps of samples from the Boltzmann distribution concentrate on deterministic values.\n1.3. The ferromagnetic and the paramagnetic states. Anobvious attempt at constructing solutions to the Belief Propagation equations is to choose identical messages \u03bcu\u2192v for all edges uv \u2208 E(G). Clearly, any solution (\u03bc(c))c\u2208[q] to the system\n\u03bc(c) = (1 + (e \u03b2 \u2212 1)\u03bc(c))d\u22121\n\u2211 \u03c7\u2208[q](1 + (e\u03b2 \u2212 1)\u03bc(\u03c7))d\u22121\n(c \u2208 [q]) (1.3)\nsupplies such a \u2018constant\u2019 solution to (1.1). LetFd,\u03b2 be the set of all solutions (\u03bc(c))c\u2208[q] to (1.3). The Bethe functional (1.2) then simplifies to\nBd,\u03b2 ( (\u03bc(c))c\u2208[q] ) = log [ \u2211\nc\u2208[q]\n( 1 + (e\u03b2 \u2212 1)\u03bc(c))d\n]\n\u2212 d 2 log\n[\n1 + (e\u03b2 \u2212 1) \u2211\nc\u2208[q] \u03bc(c)2\n]\n.\n(1.4)\nOne obvious solution to (1.3) is the uniform distribution on [q]; we refer to that solution as paramagnetic/disordered and denote it by \u03bcp. Apart from\u03bcp, other solutions to (1.3) emerge as \u03b2 increases for any d \u2265 3. Specifically, let \u03b2u > 0 be the supremum value of \u03b2 > 0 where \u03bcp is the unique solution to (1.3).1 Then, for \u03b2 = \u03b2u , one more solution \u03bcf emerges such that \u03bcf(1) > \u03bcf(i) = 1\u2212\u03bcf (1)q\u22121 for i = 2, . . . , q, portending the emergence of a metastable state and, ultimately, a phase transition. In particular, for any \u03b2 > \u03b2u , a bit of calculus reveals there exist either one or two distinct solutions \u03bc with \u03bc(1) > \u03bc(i) = 1\u2212\u03bc(1)q\u22121 for i = 2, . . . , q; we denote by \u03bcf the solution of (1.3) which maximises the value \u03bc(1) and refer to it as ferromagnetic/ordered. The value \u03b2u is the so-called uniqueness threshold for the Potts model on the d-regular tree, see, e.g., [27] for a more detailed discussion and related pointers.\nAt the critical value\n\u03b2p = max { \u03b2 \u2265 \u03b2u : Bd,\u03b2(\u03bcp) \u2265 Bd,\u03b2(\u03bcf) } = log q \u2212 2 (q \u2212 1)1\u22122/d \u2212 1 .\nthe ferromagnetic solution\u03bcf takes over from the paramagnetic solution\u03bcp as the global maximiser of the Bethe functional. For that reason, the threshold \u03b2p is also known in the literature as the ordered-disordered threshold. Yet, up to the threshold\n\u03b2h = log(1 + q/(d \u2212 2)) the paramagnetic solution remains a local maximiser of the Bethe free energy; later, in Sect. 2.3 we will see that \u03b2h has a natural interpretation as a tree-broadcasting threshold (and is also a conjectured threshold for uniqueness in the random-cluster representation for the Potts model, see [32] for details).\nThe relevance of these critical values has been demonstrated in [27] (see also [22] for d even, and [33] for q large), where it was shown that 1n log Z\u03b2(G) is asymptotically\n1 The value does not have a closed-form expression, but there is an equivalent formulation of it given by\nthe equality e\u03b2u = 1 + inf y>1 (y\u22121)(y d\u22121+q\u22121)\nyd\u22121\u2212y .\nequal tomax\u03bc Bd,\u03b2(\u03bc), themaximum ranging over\u03bc satisfying (1.3). In particular, at the maximum it holds that \u03bc = \u03bcp when \u03b2 < \u03b2p, \u03bc = \u03bcf when \u03b2 > \u03b2p and \u03bc \u2208 {\u03bcp, \u03bcf } when \u03b2 = \u03b2p.\n1.4. Slow mixing and metastability. To investigate the two BP solutions further and obtain connections to the dynamical evolution of themodel, we need to lookmore closely how these two solutions \u03bcp, \u03bcf manifest themselves in the random regular graph. To this end, we define for a given distribution \u03bc on [q] another distribution\n\u03bd\u03bc(c) = (1 + (e \u03b2 \u2212 1)\u03bc(c))d\n\u2211 \u03c7\u2208[q](1 + (e\u03b2 \u2212 1)\u03bc(\u03c7))d\n(c \u2208 [q]). (1.5)\nLet \u03bdf = \u03bd\u03bcf and \u03bdp = \u03bd\u03bcp for brevity; of course \u03bdp = \u03bcp is just the uniform distribution. The distributions \u03bdf and \u03bdp represent the expected Boltzmann marginals within the pure states corresponding to\u03bcf and\u03bcp. Indeed, the r.h.s. of (1.5) resembles that of (1.3) except that the exponents read d rather than d \u2212 1. This means that we pass from messages, where we omit one specific endpoint of an edge from the graph, to actual marginals, where all d neighbours of a vertex are present. For small \u03b5 > 0, it will therefore be relevant to consider the sets of configurations\nSf(\u03b5) = { \u03c3 \u2208 [q]n : \u2211\nc\u2208[q]\n\u2223 \u2223 \u2223 \u2223 \u2223\u03c3\u22121(c) \u2223 \u2223\u2212 n\u03bdf(c) \u2223 \u2223 \u2223 < \u03b5n\n}\n,\nSp(\u03b5) = { \u03c3 \u2208 [q]n : \u2211\nc\u2208[q]\n\u2223 \u2223 \u2223 \u2223 \u2223\u03c3\u22121(c) \u2223 \u2223\u2212 n\u03bdp(c) \u2223 \u2223 \u2223 < \u03b5n\n}\n,\nwhose colour statistics are about n\u03bdf and n\u03bdp, respectively; i.e., in Sp, all colours appear with roughly equal frequency, whereas in Sf colour 1 is favoured over the other q \u2212 1 colours (which appear with roughly equal frequency).\nWe are now in position to state our main result for Glauber dynamics. Recall that, for a graph G = (V, E), Glauber is initialised at a configuration \u03c30 \u2208 [q]V ; at each time step t \u2265 1, Glauber draws a vertex uniformly at random and obtains a new configuration \u03c3t by updating the colour of the chosen vertex according to the conditional Boltzmann distribution given the colours of its neighbours. It is a well-known fact that Glauber converges in distribution to \u03bcG,\u03b2 ; the mixing time of the chain is defined as the maximum number of steps t needed to get within total variation distance \u2264 1/4 from \u03bcG,\u03b2 , where the maximum is over the choice of the initial configuration \u03c30, i.e., the quantity max\u03c30 min{t : dTV(\u03c3t , \u03bcG,\u03b2) \u2264 1/4}.\nFor metastability, we will consider Glauber launched from a random configuration from a subset S \u2286 [q]V of the state space. More precisely, let us denote by \u03bcG,\u03b2,S = \u03bcG,\u03b2(\u00b7 | S) the conditional Boltzmann distribution on S. We call S a metastable state for Glauber dynamics on G if there exists \u03b4 > 0 such that\nP [ min{t : \u03c3t \u2208 S} \u2264 e\u03b4|V | | \u03c30 \u223c \u03bcG,\u03b2,S ] \u2264 e\u2212\u03b4|V |.\nHence, it will most likely take Glauber an exponential amount of time to escape from a metastable state.\nTheorem 1.1. Let d, q \u2265 3 be integers and \u03b2 > 0 be real. Then, for all sufficiently small \u03b5 > 0, the following hold w.h.p. over the choice of G = G(n, d).\n(i) If \u03b2 < \u03b2h, then Sp(\u03b5) is a metastable state for Glauber dynamics on G. (ii) If \u03b2 > \u03b2u, then Sf(\u03b5) is a metastable state for Glauber dynamics on G.\nFurther, for \u03b2 > \u03b2u, the mixing time of Glauber is e (n).\nThus, we can summarise the evolution of the Potts model as follows. For \u03b2 < \u03b2u there is no ferromagnetic state. As \u03b2 passes \u03b2u , the ferromagnetic state Sf emerges first as a metastable state. Hence, if we launch Glauber from Sf , the dynamics will most likely remain trapped in the ferromagnetic state for an exponential amount of time, even though the Boltzmann weight of the paramagnetic state is exponentially larger (as we shall see in the next section). At the point \u03b2p the ferromagnetic state then takes over as the one dominating the Boltzmann distribution, but the paramagnetic state remains as a metastable state up to \u03b2h . Note in particular that the two states coexist as metastable states throughout the interval (\u03b2u, \u03b2h).\nThemetastability for the Pottsmodelmanifests also in the evolution of the Swendsen\u2013 Wang (SW) chain, which is another popular and substantially more elaborate chain that makes non-local moves, based on the random-cluster representation of the model. For a graph G = (V, E) and a configuration \u03c3 \u2208 [q]V , a single iteration of SW starting from \u03c3 consists of two steps.\n\u2022 Percolation step: Let M = M(\u03c3 ) be the random edge-set obtained by adding (indepentently) each monochromatic edge under \u03c3 with probability p = 1 \u2212 e\u2212\u03b2 . \u2022 Recolouring step: Obtain the new \u03c3 \u2032 \u2208 [q]V by assigning each component2 of the graph (V, M) a uniformly random colour from [q]; for v \u2208 V , we set \u03c3 \u2032v to be the colour assigned to v\u2019s component.\nWe define metastable states for SW dynamics analogously to above. The following theorem establishes the analogue of Theorem 1.1 for the non-local SW dynamics. Note here that SW might change the most-frequent colour due to recolouring step, so the metastability statement for the ferromagnetic phase needs to consider the set Sf(\u03b5) with its q \u2212 1 permutations. Theorem 1.2. Let d, q \u2265 3 be integers and \u03b2 > 0 be real. Then, for all sufficiently small \u03b5 > 0, the following hold w.h.p. over the choice of G = G(n, d). (i) If \u03b2 < \u03b2h, then Sp(\u03b5) is a metastable state for SW dynamics on G. (ii) If \u03b2 > \u03b2u, then Sf(\u03b5) together with its q \u2212 1 permutations is a metastable state for\nSW dynamics on G.\nFurther, for \u03b2 \u2208 (\u03b2u, \u03b2h), the mixing time of SW is e (n).\n1.5. The relative weight of the metastable states. At the heart of obtaining the metastability results of the previous section is a refined understanding of the relative weight of the ferromagnetic and paramagnetic states. The following notion of non-reconstruction will be the key in our arguments; it captures the absence of long-range correlationswithin a set S \u2286 [q]n , saying that, for any vertex v, a typical boundary configuration on \u03c3 \u2202 v chosen according to the conditional distribution on S does not impose a discernible bias on the colour of v (for large , n; recall, \u2202 v is the set of all vertices at distance precisely\n2 Note, isolated vertices count as connected components.\nfrom v). More precisely, let\u03bc = \u03bcG,\u03b2 and \u03c3 \u223c \u03bc; the Boltzmann distribution exhibits non-reconstruction given a subset S \u2286 [q]n if for any vertex v it holds that lim\n\u2192\u221e lim supn\u2192\u221e\n\u2211\nc\u2208[q]\n\u2211 \u03c4\u2208S E [ \u03bc(\u03c4 | S) \u00d7 \u2223\u2223\u03bc(\u03c3 v = c | \u03c3 \u2202 v = \u03c4\u2202 v) \u2212 \u03bc(\u03c3 v = c | S) \u2223 \u2223 ] = 0,\nwhere the expectation is over the choice of the graph G.\nTheorem 1.3. Let d, q \u2265 3 be integers and \u03b2 > 0 be real. The following hold for all sufficiently small \u03b5 > 0 as n \u2192 \u221e. (i) For all \u03b2 < \u03b2p, E [ \u03bcG,\u03b2(Sp) ] \u2192 1 and, if \u03b2 > \u03b2u, then E [ 1 n log\u03bcG,\u03b2(Sf)\n] \u2192 Bd,\u03b2(\u03bcf) \u2212 Bd,\u03b2(\u03bcp).\n(ii) For all \u03b2 > \u03b2p, E [ \u03bcG,\u03b2(Sf) ] \u2192 1/q and, if \u03b2 < \u03b2h, then E [ 1 n log\u03bcG,\u03b2(Sp) ] \u2192 Bd,\u03b2(\u03bcp) \u2212 Bd,\u03b2(\u03bcf).\nFurthermore, the Boltzmann distribution given Sp exhibits non-reconstruction if \u03b2 < \u03b2h and the Boltzmann distribution given Sf exhibits non-reconstruction if \u03b2 > \u03b2u.\nTheorem 1.3 shows that for \u03b2 < \u03b2p the Boltzmann distribution is dominated by the paramagnetic state Sp for \u03b2 < \u03b2p. Nonetheless, at \u03b2u the ferromagnetic state Sf and its q \u2212 1 mirror images start to emerge. Their probability mass is determined by the Bethe free energy evaluated at \u03bcf . Further, as \u03b2 passes \u03b2p the ferromagnetic state takes over as the dominant state, with the paramagnetic state lingering on as a sub-dominant state up to \u03b2h . Finally, both states Sp and Sf are free from long-range correlations both for the regime of \u03b2 where they dominate and for those \u03b2 where they are sub-dominant.\n1.6. Discussion. Our slow mixing result for Glauber dynamics when \u03b2 > \u03b2u (Theorem1.1) significantly improves uponprevious results ofBordewich et al. [11] that applied to \u03b2 > \u03b2u + q(1). Similarly, our slow mixing result for Swendsen\u2013Wang dynamics when \u03b2 \u2208 (\u03b2u, \u03b2h) (Theorem 1.2) strengthens earlier results of Galanis et al. [27] which applied to \u03b2 = \u03b2p, and by Helmuth et al. [33] which applied for a small interval around \u03b2p; both results applied only for q sufficiently large. To obtain our result for all integers q, d \u2265 3, we need to carefully track how SW evolves on the random regular graph for configurations starting from the ferromagnetic and paramagnetic phases, by accounting for the percolation step via delicate arguments, whereas the approaches of [27,33] sidestepped this analysis by considering the change in the number of monochromatic edges instead.\nOur slow mixing results complement the recent fast mixing result of Blanca and Gheissari [8] for edge dynamics on the random d-regular graph that applies to all\u03b2 < \u03b2u . Roughly, edge dynamics is the analogue of Glauber dynamics for the random cluster representation of the Potts model (the random-cluster representation has nicer monotonicity properties). The result of [8] already implies a polynomial bound on the mixing time of SW when \u03b2 < \u03b2u (due to comparison results by Ullrich that apply to general graphs [50]), and conversely our exponential lower bound on the mixing time of SW for \u03b2 /\u2208 (\u03b2u, \u03b2h) implies an exponential lower bound on the mixing time of edge dynamics for \u03b2 /\u2208 (\u03b2u, \u03b2h). The main open questions remaining are therefore showing whether Glauber dynamics for the Potts model mixes fast when \u03b2 \u2264 \u03b2u and whether SW/edge-dynamics mixes fast when \u03b2 \u2265 \u03b2h . Extrapolating from the mean-field case (see discussion below), it is natural to conjecture that our slow mixing results are bestpossible, i.e., for \u03b2 \u2264 \u03b2u , Glauber mixes rapidly and similarly, for \u03b2 /\u2208 (\u03b2u, \u03b2h), SW mixes rapidly on the random regular graph.\nTheorem1.3, aside frombeing critical in establishing the aforementioned slowmixing and metastability results, is the first to establish for all q, d \u2265 3 the coexistence of the ferromagnetic and paramagnetic phases for all \u03b2 in the interval (\u03b2u, \u03b2h) and detail the logarithmic order of their relative weight in the same interval. Previous work in [27] showed coexistence for \u03b2 = \u03b2p (for all q, d \u2265 3) and [33] for \u03b2 in a small interval around \u03b2p (for large q and d \u2265 5).3 Together with Theorems 1.1 and 1.2, Theorem 1.3 delineates more firmly4 the correspondence with the (simpler) mean-field case, the Potts model on the clique. In the mean-field case, there are qualitatively similar thresholds \u03b2u, \u03b2p, \u03b2h and the mixing time for Glauber and SW have been detailed for all \u03b2, even at criticality, see [9,10,20,26,29,31,37]. As mentioned earlier, the most tantalising question remaining open is to establish whether the fast mixing of SW for \u03b2 = \u03b2u and \u03b2 \u2265 \u03b2h in the mean-field case translates to the random regular graph as well. Another interesting direction is to extend our arguments to the random-cluster representation of the Potts model for all non-integer q \u2265 1; note that the arguments of [7,33] do apply to non-integer q (q \u2265 1 and q large, respectively). The proof of Theorem 1.3 relies on a truncated second moment computation, an argument that was applied to different models in [15,18].\nWe further remark here that, from a worst-case perspective, it is known that sampling from the Potts model on d-regular graphs is #BIS-hard for \u03b2 > \u03b2p [27], and we conjecture that the problem admits a poly-time approximation algorithm when \u03b2 < \u03b2p. However, even showing that Glauber mixes fast on any d-regular graph in the uniqueness regime \u03b2 < \u03b2u is a major open problem, and Theorems 1.1 and 1.2 further demonstrate that getting an algorithm all the way to \u03b2p will require using different techniques. To this end, progress has been made in [12,19] where an efficient algorithm is obtained asymptotically up to \u03b2p for large q and d using cluster-expansion methods. More precise results have been shown on the random regular graph: [33] obtained an algorithm for d \u2265 5 and q large that applies to all \u03b2 by sampling from each phase separately based also on cluster-expansion methods; also, for \u03b2 < \u03b2p, Efthymiou [24] gives an algorithm with weaker approximation guarantees but which applies to all q, d \u2265 3 (see also [7]). In principle, and extrapolating again from the mean-field case, one could use Glauber/SW to sample from each phase on the random regular graph for all q, d \u2265 3 and all \u03b2. Analysing such chains appears to be relatively far from the reach of current techniques even in the case of the random regular graph, let alone worst-case graphs. In the case of the Ising model however, the case q = 2, the analogue of this fast mixing question has recently been established for sufficiently large \u03b2 in [30] on the random regular graph and the grid, exploiting certain monotonicity properties.\n3 We remark here that the approaches in [27,33] establish more refined estimates on the deviations from the limiting value of the log-partition function of the phases (in the corresponding regimes they apply), with [33] characterising in addition the limiting distribution using cluster-expansion methods. One can obtain analogous distributional characterisations for all q, d \u2265 3 from our methods, once combined with the small subgraph conditioning method of [27]. It should be noted though the approach of [33] which goes through cluster expansion is more direct in that respect. We don\u2019t pursue such distributional results here since Theorem 1.3 is sufficient for our slow mixing results.\n4 Note that the interval-behaviour on the random regular graph (and hence the correspondence with the mean-field case) is already implied to some extent by the interval-result of [33] (for q large and d \u2265 5). Note however that the interval therein is contained strictly inside (\u03b2u , \u03b2h) and, in particular, its endpoints do not have the probabilistic interpretation of \u03b2u , \u03b2h . Nevertheless, [33] obtains various probabilistic properties of the metastable phases, including a stronger form of correlation decay than that of reconstruction that we consider here.\nFinally, let us note that the case of the grid has qualitatively different behaviour than the mean-field and the random-regular case. There, the three critical points coincide and the behaviour at criticality depends on the value of q; the mixing time of Glauber and SW has largely been detailed, see [9,28,39]."
        },
        {
            "heading": "2. Overview",
            "text": "In this section we give an overview of the proofs of Theorems 1.1\u20131.3. Fortunately, we do not need to start from first principles. Instead, we build upon the formula for the partition function Z\u03b2(G) and its proof via the second moment method from [27]. Additionally, we are going to seize upon facts about the non-reconstruction properties of the Potts model on the random (d \u2212 1)-ary tree, also from [27]. We will combine these tools with an auxiliary random graph model known as the planted model, which also plays a key role in the context of inference problems on random graphs [17].\n2.1. Preliminaries. Throughout most of the paper, instead of the simple random regular graph G, we are going to work with the random d-regular multi-graph G = G(n, d) drawn from the pairing model. Recall that G is obtained by creating d clones of each of the vertices from [n], choosing a random perfect matching of the complete graph on [n]\u00d7[d] and subsequently contracting the vertices {i}\u00d7[d] into a single vertex i , for all i \u2208 [n]. It is well-known that G is contiguous with respect to G [35], i.e., any property that holds w.h.p. for G also holds w.h.p. for G.\nFor a configuration \u03c3 \u2208 [q]V (G) define a probability distribution \u03bd\u03c3 on [q] by letting\n\u03bd\u03c3 (s) = |\u03c3\u22121(s)|/n (s \u2208 [q]).\nIn words, \u03bd\u03c3 is the empirical distribution of the colours under \u03c3 . Similarly, let \u03c1G,\u03c3 \u2208 P([q] \u00d7 [q]) be the edge statistics of a given graph/colouring pair, i.e.,\n\u03c1G,\u03c3 (s, t) = 1 2|E(G)|\n\u2211\nu,v\u2208V (G) 1{uv \u2208 E(G), \u03c3u = s, \u03c3v = t}.\nWe are going to need the following elementary estimate of the number of d-regular multigraphs G that attain a specific \u03c1G,\u03c3 .\nLemma 2.1 ([14, Lemma 2.7]). Suppose that \u03c3 \u2208 [q]n. Moreover, suppose that \u03c1 = (\u03c1(s, t))s,t\u2208[q] is a symmetricmatrixwith positive entries such that dn\u03c1(s, t) is an integer for all s, t \u2208 [q], dn\u03c1(s, s) is even for all s \u2208 [q] and \u2211qt=1 \u03c1(s, t) = \u03bd\u03c3 (s) for all s \u2208 [q]. Let G(\u03c3, \u03c1) be the event that \u03c1G,\u03c3 = \u03c1.\nThen\nP [G(\u03c3, \u03c1)] = exp \u23a1 \u23a3dn\n2\nq\u2211\ns,t=1 \u03c1(s, t) log\n\u03bd\u03c3 (s)\u03bd\u03c3 (t)\n\u03c1(s, t) + O(log n/n)\n\u23a4\n\u23a6 .\n2.2. Moments andmessages. The routinemethod for investigating the partition function and theBoltzmanndistribution of randomgraphs is themethod ofmoments [3]. The basic strategy is to calculate, one way or another, the first twomomentsE[Z\u03b2(G)],E[Z\u03b2(G)2] of the partition function. Then we cross our fingers that the second moment is not much larger than the square of the first. It sometimes works. But potential pitfalls include a pronounced tendency of running into extremely challenging optimisation problems in the course of the second moment calculation and, worse, lottery effects that may foil the strategy altogether. While regular graphs in general and the Potts ferromagnet in particular are relatively tame specimens, these difficulties actually do arise once we set out to investigate metastable states. Drawing upon [5,18] to sidestep these challenges, we develop a less computation-heavy proof strategy.\nThe starting point is the observation that the fixed points of (1.3) are intimately related to the moment calculation. This will not come as a surprise to experts, and indeed it was already noticed in [27]. To elaborate, let \u03bd = (\u03bd(s))s\u2208[q] be a probability distribution on the q colours.Moreover, letR(\u03bd) be the set of all symmetricmatrices\u03c1 = (\u03c1(s, t))s,t\u2208[q] with non-negative entries such that\n\u2211 t\u2208[q] \u03c1(s, t) = \u03bd(s) for all s \u2208 [q]. (2.1)\nSimple manipulations (e.g., [14, Lemma 2.7]) show that the first moment satisfies\nlim n\u2192\u221e\n1 n logE[Z\u03b2(G)] = max \u03bd\u2208P([q]),\u03c1\u2208R(\u03bd) Fd,\u03b2(\u03bd, \u03c1), where\nFd,\u03b2(\u03bd, \u03c1) = (d \u2212 1) \u2211\ns\u2208[q] \u03bd(s) log \u03bd(s) \u2212 d\n\u2211\n1\u2264s\u2264t\u2264q \u03c1(s, t) log \u03c1(s, t)\n+ d\u03b2\n2\n\u2211 s\u2208[q] \u03c1(s, s). (2.2)\nThus, the first moment is governed by the maximum or maxima, as the case may be, of Fd,\u03b2 .\nWe need to know that the maxima of Fd,b are in one-to-one correspondence with the stable fixed points of (1.3). To be precise, a fixed point \u03bc of (1.3) is stable if the Jacobian of (1.3) at \u03bc has spectral radius strictly less than one. Let F+d,\u03b2 be the set of all stable fixed points \u03bc \u2208 Fd,\u03b2 . Moreover, let F1d,\u03b2 be the set of all \u03bc \u2208 F+d,\u03b2 such that \u03bc(1) = maxs\u2208[q] \u03bc(s). In addition, let us call a local maximum (\u03bd, \u03c1) of Fd,\u03b2 stable if there exist \u03b4, c > 0 such that\nFd,\u03b2(\u03bd \u2032, \u03c1\u2032) \u2264 Fd,\u03b2(\u03bd, \u03c1) \u2212 c ( \u2016\u03bd \u2212 \u03bd\u2032\u20162 + \u2016\u03c1 \u2212 \u03c1\u2032\u20162 ) (2.3)\nfor all \u03bd\u2032 \u2208 P([q]) and \u03c1\u2032 \u2208 R(\u03bd\u2032) such that \u2016\u03bd \u2212 \u03bd\u2032\u2016 + \u2016\u03c1 \u2212 \u03c1\u2032\u2016 < \u03b4. Roughly, (2.3) provides that the Hessian of Fd,\u03b2 is negative definite on the subspace of all possible \u03bd, \u03c1. Lemma 2.2 ([27, Theorem 8]). Suppose that d \u2265 3, \u03b2 > 0. The map \u03bc \u2208 P([q]) \u2192 (\u03bd\u03bc, \u03c1\u03bc) defined by\n\u03bd\u03bc(s) = (1 + (e \u03b2 \u2212 1)\u03bc(s))d\n\u2211 t\u2208[q](1 + (e\u03b2 \u2212 1)\u03bc(t))d\n, \u03c1\u03bc(s, t) = e \u03b21{s=t}\u03bc(s)\u03bc(t)\n1 + (e\u03b2 \u2212 1)\u2211s\u2208[q] \u03bc(s)2 (2.4)\nis a bijection fromF+d,\u03b2 to the set of stable local maxima of Fd,\u03b2 . Moreover, for any fixed point \u03bc we have Bd,\u03b2(\u03bc) = Fd,\u03b2(\u03bd\u03bc, \u03c1\u03bc).\nFor brevity, let (\u03bdp, \u03c1p) = (\u03bd\u03bcp , \u03c1\u03bcp) and (\u03bdf , \u03c1f) = (\u03bd\u03bcf , \u03c1\u03bcf ). The following result characterises the stable fixed points F1d,\u03b2 . Proposition 2.3 ([27, Theorem 4]). Suppose that d \u2265 3, \u03b2 > 0.\n(i) If \u03b2 < \u03b2u, then (1.3) has a unique fixed point, namely the paramagnetic distribution \u03bdp on [q]. This fixed point is stable and thus Fd,\u03b2 attains its global maximum at (\u03bdp, \u03c1p).\n(ii) If \u03b2u < \u03b2 < \u03b2h, then F1d,\u03b2 contains two elements, namely the paramagnetic distribution \u03bdp and the ferromagnetic distribution \u03bdf ; (\u03bdp, \u03c1p) is a globalmaximum of Fd,\u03b2 iff \u03b2 \u2264 \u03b2p, and (\u03bdf , \u03c1f) iff \u03b2 \u2265 \u03b2p.\n(iii) If \u03b2 > \u03b2h, then F1d,\u03b2 contains precisely one element, namely the ferromagnetic distribution \u03bdf , and (\u03bdf , \u03c1f) is a global maximum of Fd,\u03b2 .\nLike the first moment, the second moment boils down to an optimisation problem as well, albeit one of much higher dimension (q2 \u2212 1 rather than q \u2212 1). Indeed, it is not difficult to derive the following approximation (once again, e.g., via [14, Lemma 2.7]). For a probability distribution \u03bd \u2208 P([q]) and a symmetric matrix \u03c1 \u2208 R(\u03bd) let R\u2297(\u03c1) be the set of all tensors r = (r(s, s\u2032, t, t \u2032))s,s\u2032,t,t \u2032\u2208[q] such that\nr(s, s\u2032, t, t \u2032) = r(t, t \u2032, s, s\u2032) and \u2211\ns\u2032,t \u2032\u2208[q] r(s, s\u2032, t, t \u2032) =\n\u2211\ns\u2032,t \u2032\u2208[q] r(s\u2032, s, t \u2032, t)\n= \u03c1(s, t) for all s, t \u2208 [q]. (2.5) Then, with H(\u00b7) denoting the entropy function, we have\nlim n\u2192\u221e\n1 n logE[(Z\u03b2(G))2] = max \u03bd,\u03c1\u2208R(\u03bd),r\u2208R\u2297(\u03c1) F\u2297d,\u03b2(\u03c1, r), where\nF\u2297d,\u03b2(\u03c1, r) = (d \u2212 1)H(\u03c1) + d\n2 H(r)\n+ d\u03b2\n2\n\u2211\ns,s\u2032,t,t \u2032\u2208[q]\n( 1{s = t} + 1{s\u2032 = t \u2032}) r(s, s\u2032, t, t \u2032). (2.6)\nA frontal assault on this optimisation problem is in general a daunting task due to the doubly-stochastic constraints in (2.5), i.e., the constraint r \u2208 R\u2297(\u03c1). But fortunately, to analyse the global maximum (over \u03bd and \u03c1), these constraints can be relaxed, permitting an elegant translation of the problem to operator theory. In effect, the second moment computation can be reduced to a study of matrix norms. The result can be summarised as follows.\nProposition 2.4 ([27, Theorem 7]). For all d, q \u2265 3 and \u03b2 > 0 we have max\u03bd,\u03c1\u2208R(\u03bd),r\u2208R\u2297(\u03c1) F\u2297d,\u03b2(\u03c1, r) = 2max\u03bd,\u03c1 Fd,\u03b2(\u03bd, \u03c1) and thus E[Z\u03b2(G)2] = O (E[Z\u03b2(G)]2). Combining Lemma 2.2, Proposition 2.3 and Proposition 2.4, we obtain the following reformulation of [27, Theorem 7], which verifies that we obtain good approximations to the partition function by maximising the Bethe free energy on Fd,\u03b2 . Theorem 2.5. For all integers d, q \u2265 3 and real \u03b2 > 0, we have lim\nn\u2192\u221e n \u22121 log Z\u03b2(G) =\nmax \u03bc\u2208Fd,\u03b2\nBd,\u03b2(\u03bc) in probability.\n2.3. Non-reconstruction. While the global maximisation of the function F\u2297d,\u03b2 and thus the proof of Theorem 2.5 boils down to matrix norm analysis, in order to prove Theorems 1.1 and 1.3 via the method of moments we would in addition need to get a good handle on all the local maxima. Unfortunately, we do not see a way to reduce this more refined question to operator norms. Hence, it would seem that we should have to perform a fine-grained analysis of F\u2297d,\u03b2 after all. But luckily another path is open to us. Instead of proceeding analytically, we resort to probabilistic ideas. Specifically, we harness the notion of non-reconstruction on the Potts model on the d-regular tree.\nTo elaborate, let Td be the infinite d-regular tree with root o. Given a probability distribution\u03bc \u2208 {\u03bcp, \u03bcf }we define a broadcasting process \u03c3 = \u03c3 d,\u03b2,\u03bc onTd as follows. Initially we draw the colour \u03c3 o of the root o from the distribution \u03bd\u03bc. Subsequently, working our way down the levels of the tree, the colour of a vertex v whose parent u has been coloured already is drawn from the distribution\nP [\u03c3 v = c | \u03c3 u] = \u03bc(c)e \u03b21{c=\u03c3 u}\n\u2211 c\u2032\u2208[q] \u03bc(c\u2032)e\u03b21{c \u2032=\u03c3 u} .\nNaturally, the colours of different vertices on the same level are mutually independent conditioned on the parent\u2019s colour. Let \u2202 o be the set of all vertices at distance precisely from o. We say that the broadcasting process has the strong non-reconstruction property if\n\u2211\nc\u2208[q] E\n[\u2223 \u2223P [ \u03c3 o = c | \u03c3 \u2202 o ]\u2212 P [\u03c3 o = c] \u2223 \u2223 ] = exp(\u2212 ( )),\nwhere the expectation is over the random configuration \u03c3 \u2202 o (distributed according to the broadcasting process). In words, this says that the information of the spin of the root decays in the broadcasting process; the term \u201cstrong\u201d refers that the decay is exponential with respect to the depth .\nProposition 2.6 ([27, Theorem 50]). Let d, q \u2265 3 be integers and \u03b2 > 0 be real. (i) For \u03b2 < \u03b2h, the broadcasting process \u03c3 d,\u03b2,\u03bcp has the strong non-reconstruction\nproperty. (ii) For \u03b2 > \u03b2u, the broadcasting process \u03c3 d,\u03b2,\u03bcf has the strong non-reconstruction\nproperty.\nIn order to prove Theorems 1.1\u20131.3 we will combine Proposition 2.6 with reweighted random graph models known as planted models. To be precise, we will consider two versions of planted models, a paramagnetic and a ferromagnetic one. Then we will deduce from Proposition 2.6 that the Boltzmann distribution of these planted models has the non-reconstruction property in a suitably defined sense. In combination with some general facts about Boltzmann distributions this will enable us to prove Theorems 1.1\u2013 1.3 without the need for complicated moment computations.\n2.4. Planting. We proceed to introduce the paramagnetic and the ferromagnetic version of the planted model. Roughly speaking, these are weighted versions of the common random regular graphGwhere the probability mass of a specific graph is proportional to\nthe paramagnetic or ferromagnetic bit of the partition function. To be precise, for \u03b5 > 0, recall the subsets Sp = Sp(\u03b5), Sf = Sf(\u03b5) of the configuration space [q]n . Letting\nZf(G) = \u2211\n\u03c3\u2208Sf e\u03b2HG (\u03c3 ) and Zp(G) =\n\u2211 \u03c3\u2208Sp e\u03b2HG(\u03c3 ), (2.7)\nwe define random graph models G\u0302f , G\u0302p by\nP [ G\u0302f = G ] = Zf(G)P [G = G] E[Zf(G)] , P [ G\u0302p = G ] = Zp(G)P [G = G] E[Zp(G)] . (2.8)\nThus, G\u0302f and G\u0302p are d-regular random graphs on n vertices such that the probability that a specific graph G comes up is proportional to Zf(G) and Zp(G), respectively.\nWe need to extend the notion of non-reconstruction to G\u0302p, G\u0302f . Specifically, we need to define non-reconstruction for the conditional Boltzmann distributions \u03bcG,\u03b2( \u00b7 | Sp), \u03bcG,\u03b2( \u00b7 | Sf). We thus say that for a graph/configuration pair (G, \u03c3 ), an event S \u2286 [q]n , a positive real \u03be > 0, a real number \u03b3 \u2208 [0, 1], an integer \u2265 1 and a probability distribution \u03bc on [q] the conditional (\u03b3, \u03be, , \u03bc)-non-reconstruction property holds if\n1\nn\n\u2211\nv\u2208[n]\n\u2211\nc\u2208[q]\n\u2223 \u2223\u03bd\u03bc(c) \u2212 \u03bcG,\u03b2(\u03c3G,\u03b2,v = c | S, \u03c3G,\u03b2,\u2202 v = \u03c3\u2202 v) \u2223 \u2223 < \u03be (2.9)\nholds with probability 1\u2212 \u03b3 . In words, (2.9) provides that on the average over all v the conditional marginal probability \u03bcG,\u03b2(\u03c3G,\u03b2,v = c | S, \u03c3G,\u03b2,\u2202 v = \u03c3\u2202 v) that v receives colour c given the boundary condition induced by \u03c3 on the vertices at distance from v and given the event S is close to \u03bd\u03bc(\u03c9).\nFurther, while (2.9) deals with a specific graph/configuration pair (G, \u03c3 ), we need to extend the definition to the random graph models G\u0302f and G\u0302p. For a graph G let \u03c3G,f denote a sample from the conditional distribution \u03bcG,\u03b2( \u00b7 | Sf). Also define \u03c3G,p similarly for Sp.We say that for the randomgraph G\u0302f has the (\u03b7, \u03be, )-non-reconstruction property if\nE [ \u03bcG\u0302f ,\u03b2 ({ (G\u0302f , \u03c3 G\u0302f ,f ) fails to have the (\u03be, , \u03bcf )-non-reconstruction property conditional on Sf })] < \u03b7.\n(2.10)\nThus, we ask that (2.9) holds for a typical graph/configuration pair obtained by first drawing a graph G\u0302f from the planted model and then sampling \u03c3 G\u0302f ,f from \u03bcG\u0302f ( \u00b7 | Sf). We introduce a similar definition for G\u0302p.\nThe following proposition shows that the non-reconstruction statements from Proposition 2.6 carry over to the planted random graphs. This is the key technical statement toward the proofs of Theorems 1.1\u20131.3.\nProposition 2.7. Let d \u2265 3. (i) Assume that \u03b2u < \u03b2. Then G\u0302f has the (o(1), 1/ log log n, log log n )-non-\nreconstruction property. Moreover, for any \u03b4 > 0 there exist = (d, \u03b2, \u03b4) > 0 and \u03c7 = \u03c7(d, \u03b2, \u03b4) > 0 such that (G\u0302f , \u03c3 G\u0302f ,f) has the (exp(\u2212\u03c7n), \u03b4, , \u03bcf )-nonreconstruction property.\n(ii) Assume that\u03b2 < \u03b2h. Then G\u0302p has the (o(1), 1/ log log n, log log n )-non-reconstruction property. Moreover, for any \u03b4 > 0 there exist = (d, \u03b2, \u03b4) > 0 and \u03c7 = \u03c7(d, \u03b2, \u03b4) > 0 such that (G\u0302p, \u03c3 G\u0302p,p)has the (exp(\u2212\u03c7n), \u03b4, , \u03bcp)-non-reconstruction property.\nTogether with a few routine arguments for the study of Boltzmann distributions that build upon [5], we can derive from Proposition 2.7 that for \u03b2 > \u03b2u two typical samples from the ferromagnetic Boltzmann distribution have overlap about \u03bdf \u2297 \u03bdf . This insight enables a truncated second moment computation that sidesteps a detailed study of the function F\u2297d,\u03b2 from (2.6). Indeed, the only observation about F \u2297 d,\u03b2 that we need tomake is that F\u2297d,\u03b2(\u03bdf\u2297\u03bdf , \u03c1f\u2297\u03c1f) = 2Fd,\u03b2(\u03bdf , \u03c1f). Similar arguments apply to the paramagnetic case. We can thus determine the asymptotic Boltzmann weights of Sp, Sf on the random regular graph as follows.\nCorollary 2.8. Let d, q \u2265 3 be arbitrary integers. (i) For\u03b2 > \u03b2u, for all sufficiently small \u03b5 > 0, we havew.h.p. 1n log Zf(G) = Bd,\u03b2(\u03bcf)+\no(1). (ii) For\u03b2 < \u03b2h, for all sufficiently small \u03b5 > 0, we havew.h.p. 1n log Zp(G) = Bd,\u03b2(\u03bcp)+\no(1).\nFinally, combining Corollary 2.8 with the definition (2.8) of the planted models and the non-reconstruction statements from Proposition 2.7, we obtain the following conditional non-reconstruction statements for the plain random regular graph.\nCorollary 2.9. Let d, q \u2265 3 be arbitrary integers. (i) For\u03b2 > \u03b2u, theBoltzmanndistribution\u03bcG,\u03b2 given Sf exhibits the non-reconstruction\nproperty. (ii) For\u03b2 < \u03b2h, theBoltzmanndistribution\u03bcG,\u03b2 given Sp exhibits the non-reconstruction\nproperty.\nTheorem 1.3 is an immediate consequence of Corollaries 2.8 and 2.9."
        },
        {
            "heading": "3. Quiet Planting",
            "text": "In this section we prove Proposition 2.7 along with Corollaries 2.8 and 2.9. We begin with an important general observation about the planted model called the Nishimori identity, which will provide an explicit constructive description of the planted models.\n3.1. The Nishimori identity. We complement the definition (2.8) of the planted random graphs G\u0302f , G\u0302p by also introducing a reweighted distribution on graphs for a specific configuration \u03c3 \u2208 [q]n . Specifically, we define a random graph G\u0302(\u03c3 ) by letting\nP [ G\u0302(\u03c3 ) = G ] = P [G = G] e \u03b2HG(\u03c3 )\nE[e\u03b2HG(\u03c3 )] . (3.1) Furthermore, for \u03b5 > 0, recalling the truncated partition functions Zf , Zp from (2.7), we introduce reweighted random configurations \u03c3\u0302 f = \u03c3\u0302 f(\u03b5) \u2208 [q]n and \u03c3\u0302 p = \u03c3\u0302 p(\u03b5) \u2208 [q]n with distributions\nP [ \u03c3\u0302 f = \u03c3 ] = 1 {\u03c3 \u2208 Sf}E[e \u03b2HG(\u03c3 )]\nE[Zf(G)] , P [ \u03c3\u0302 p = \u03c3\n] = 1 { \u03c3 \u2208 Sp } E[e\u03b2HG(\u03c3 )]\nE[Zp(G)] . (3.2)\nWe have the following paramagnetic and ferromagnetic Nishimori identities.\nProposition 3.1. For any integers d, q \u2265 3 and real \u03b2, \u03b5 > 0, we have (G\u0302p, \u03c3 G\u0302p,p) d= (G\u0302(\u03c3\u0302 p), \u03c3\u0302 p), (G\u0302f , \u03c3 G\u0302f ,f) d= (G\u0302(\u03c3\u0302 f), \u03c3\u0302 f). (3.3)\nProof. Let G be a d-regular graph on n vertices and \u03c3 \u2208 [q]n . We have P\n[ (G\u0302p, \u03c3 G\u0302p,p) = (G, \u03c3 ) ] = P [ \u03c3 G\u0302p,p = \u03c3 \u2223 \u2223 \u2223G\u0302p = G ] P [ G\u0302p = G ]\n= \u03bcG,\u03b2 ( \u03c3 \u2223 \u2223 \u2223Sp ) Zp(G)P [G = G]\nE[Zp(G)] . (3.4)\nMoreover, by the definition of the Boltzmann distribution \u03bcG,\u03b2 ,\n\u03bcG,\u03b2 ( \u03c3 |Sp ) = e \u03b2HG(\u03c3 )1 { \u03c3 \u2208 Sp }\nZ(G) \u03bcG,\u03b2 ( Sp ) , \u03bcG\n( Sp ) = Zp(G)\nZ(G) . (3.5)\nCombining (3.4) and (3.5), we obtain\nP [ (G\u0302p, \u03c3 G\u0302p,p) = (G, \u03c3 ) ] = e \u03b2HG(\u03c3 )P [G = G] E [ e\u03b2HG(\u03c3 ) ] \u00b7 E [ e\u03b2HG(\u03c3 ) ] 1 { \u03c3 \u2208 Sp }\nE[Zp(G)] = P [ G\u0302 ( \u03c3\u0302 p ) = G \u2223 \u2223 \u2223\u03c3\u0302 p = \u03c3 ] P [ \u03c3\u0302 p = \u03c3 ] = P [ (G\u0302(\u03c3\u0302 p) = G, \u03c3\u0302 p = \u03c3) ] ,\nas claimed. The very same steps apply to G\u0302f .\nNishimori identities were derived in [17] for a broad family of planted models which, however, does not include the planted ferromagnetic models G\u0302p, G\u0302f . Nonetheless, the (simple) proof of Proposition 3.1 is practically identical to the argument from [17].\nWhile the original definition (2.8) of the plantedmodelsmay appear unwieldy, Proposition 3.1 paves the way for a more hands-on description. But as a preliminary step we need to get a handle on the empirical distribution of the colours under the random con-\nfigurations \u03c3\u0302 f , \u03c3\u0302 p. Additionally, we also need to determine the edge statistics \u03c1 G\u0302p,\u03c3\u0302 p\nand \u03c1 G\u0302f ,\u03c3\u0302 f . The following two lemmas solve these problems for us.\nLemma 3.2. Suppose that 0 \u2264 \u03b2 < \u03b2h. Then E[Zp(G)] = exp(nFd,\u03b2(\u03bdp, \u03c1p) + O(log n)).\nProof. To obtain a lower bound on E[Zp(G)] let \u03c30 \u2208 [q]n be a configuration such that |\u03c3\u221210 (s)| = nq + O(1) for all s \u2208 [q]. Let \u03bd(s) = |\u03c3\u221210 (s)|/n. Then\n\u03c1\u03bd(s, t) = e \u03b21{s=t}\nq(q \u2212 1 + e\u03b2) + O(1/n) = \u03c1p(s, t) + O(1/n) (s, t \u2208 [q]).\nTherefore, Lemma 2.1 yields\nE[Zp(G)] \u2265 \u2211 \u03c3\u2208[q]n 1 { \u2200s \u2208 [q] : |\u03c3\u22121(s)| = n\u03bd(s) } P [G(\u03c3, \u03c1\u03bd)]\nexp\n( \u03b2e\u03b2dn 2(q \u2212 1 + e\u03b2) + O(1) )\n\u2265 qn exp (\n\u03b2e\u03b2dn 2(q \u2212 1 + e\u03b2) + O(log n) ) = exp (nFd,\u03b2(\u03bdp, \u03c1p) + O(log n) ) .\n(3.6)\nConversely, since there are only nO(1) choices of \u03bd, \u03c1, Lemma 2.2 and Proposition 2.3 imply that\nE[Zp(G)] \u2264 exp ( nFd,\u03b2(\u03bdp, \u03c1p) + O(log n) ) . (3.7)\nThe assertion follows from (3.6) and (3.7).\nLemma 3.3. Suppose that \u03b2 > \u03b2u. Then E[Zf(G)] = exp(nFd,\u03b2(\u03bdf , \u03c1f) + O(log n)). Proof. As in the proof of Lemma 3.2 let \u03c30 \u2208 [q]n be a configuration such that |\u03c3\u221210 (s)| = n\u03bdf(s) + O(1) for all s \u2208 [q]. Letting \u03bd(s) = |\u03c3\u221210 (s)|/n we see that \u03c1\u03bd(s, t) = \u03c1f(s, t) + O(1/n) for all s, t \u2208 [q]. Therefore, Lemma 2.1 yields\nE[Zf (G)] \u2265 ( n\n\u03bdn\n)\nexp\n(\n\u2212dn 2 DKL ( \u03c1\u03bd\u2016\u03bd \u2297 \u03bd) + \u03b2e\n\u03b2dn \u2211\ns\u2208[q] \u03bcf (s)2\n2 ( 1 + (e\u03b2 \u2212 1)\u2211s\u2208[q] \u03bcf (s)2 ) + O(log n)\n)\n= exp (nFd,\u03b2 (\u03bdf , \u03c1f ) + O(log n) ) . (3.8)\nAs for the upper bound, once again because there are only nO(1) choices of \u03bd, \u03c1, Lemma 2.2 and Proposition 2.3 yield\nE[Zf(G)] \u2264 exp ( nFd,\u03b2(\u03bdf , \u03c1f) + O(log n) ) . (3.9)\nCombining the lower and upper bounds from (3.8) and (3.9) completes the proof.\nLemma 3.4. For any integers d, q \u2265 3 and real \u03b2 \u2208 (0, \u03b2h), there exist c, t0 > 0 such that\nP [ dTV ( \u03bd\u03c3\u0302 p , \u03bdp ) + dTV ( \u03c1 G\u0302(\u03c3\u0302 p),\u03c3\u0302 p, \u03c1p ) > t ]\n\u2264 exp(\u2212ct2n + O(log n)) for all 0 \u2264 t < t0. Proof. Suppose that \u03bd is a probability distribution on [q] such that n\u03bd(s) is an integer for all s \u2208 [q]. Moreover, suppose that \u03c1 = (\u03c1(s, t))s,t\u2208[q] is a symmetric matrix such that dn\u03c1(s, t) is an integer for all s, t \u2208 [q], dn\u03c1(s, s) is even for all s \u2208 [q] and\u2211q\nt=1 \u03c1(s, t) = \u03bd(s) for all s \u2208 [q]. Retracing the steps of the proof of Lemma 3.3, we see that\n\u2211\n\u03c3\u2208[q]n 1 { \u03bd\u03c3 = \u03bd}P [G(\u03c3, \u03c1)] exp\n( \u03b2dn\n2\nq\u2211 s=1 \u03c1(s, s)\n)\n= exp (nFd,\u03b2(\u03bd, \u03c1) + O(log n) ) .\n(3.10)\nTherefore, the assertion follows from Proposition 2.3 and the definition (2.3) of stable local maxima.\nLemma 3.5. For any integers d, q \u2265 3 and real \u03b2 > \u03b2u, there exist c, t0 > 0 such that\nP [ dTV ( \u03bd\u03c3\u0302 f , \u03bdf ) + dTV ( \u03c1 G\u0302(\u03c3\u0302 f ),\u03c3\u0302 f , \u03c1f ) > t ]\n\u2264 exp(\u2212ct2n + O(log n)) for all 0 \u2264 t < t0. Proof. The argument from the proof of Lemma 3.4 applies mutatis mutandis.\nAt this point we have handy, constructive descriptions of the models G\u0302p, G\u0302f . Indeed, Lemmas 3.4 and 3.5 provide that the planted configurations \u03c3\u0302 p and \u03c3\u0302 f have colour statistics approximately equal to \u03bdp and \u03bdf w.h.p., respectively. Moreover, because the random graph models are invariant under permutations of the vertices, \u03c3\u0302 p and \u03c3\u0302 f are uniformly random given their colour statistics. In addition, the edge statistics of the random graphs G\u0302(\u03c3\u0302 p) and G\u0302(\u03c3\u0302 f) concentrate about \u03c1f and \u03c1p. Once more because of permutation invariance, the random graphs G\u0302(\u03c3\u0302 p) and G\u0302(\u03c3\u0302 f) themselves are uniformly random given the planted assignment \u03c3\u0302 p or \u03c3\u0302 f and given the edge statistics.\nThus, let Sf and Sp be the \u03c3 -algebras generated by \u03c3\u0302 f , \u03c1 G\u0302f ,\u03c3\u0302 f and \u03c3\u0302 p, \u03c1 G\u0302p,\u03c3\u0302 p , respectively. Then we can use standard techniques from the theory of random graphs to derive typical properties of G\u0302(\u03c3\u0302 p) givenSp and of G\u0302(\u03c3\u0302 f) givenSf , which are distributed precisely as G\u0302p and G\u0302f by Proposition 3.1. Using these characterisations, we are now going to prove Proposition 2.7.\n3.2. Proof of Proposition 2.7. Lemma 3.4 gives sufficiently accurate information as to\nthe distribution of \u03c3\u0302 p, \u03c1 G\u0302p,\u03c3\u0302 p for us to couple the distribution of the colouring produced by the broadcasting process and the colouring that \u03c3\u0302 p induces on the neighbourhood of some particular vertex of G\u0302p, say v.\nLemma 3.6. Let d, q \u2265 3 be integers and \u03b2 \u2208 (0, \u03b2h) be real. Then, for any vertex v and any non-negative integer = o(log n), given Sp w.h.p. we have\ndTV(\u03c3\u0302 p,\u2202 v, \u03c4\u2202 o) = O ( d ( dTV(\u03bd \u03c3\u0302 p , \u03bdp) + dTV(\u03c1 G\u0302(\u03c3\u0302 p),\u03c3\u0302 p , \u03c1p) + O(n \u22120.99) )) .\nProof. Proceeding by induction on , we construct a coupling of \u03c3\u0302 p,\u2202 v and \u03c4\u2202 o. Let\n\u03b6 = dTV(\u03bd\u03c3\u0302 p , \u03bdp) + dTV(\u03c1 G\u0302(\u03c3\u0302 p),\u03c3\u0302 p , \u03c1p). (3.11) In the case = 0 the set \u2202 v consists of v only, while \u2202 o comprises only the root vertex o itself. Hence, the colours \u03c3\u0302 p(v) and \u03c4(o) can be coupled to coincide with probability at least 1\u2212 \u03b6 . As for \u2265 1, assume by induction that \u2202 \u22121v is acyclic and that \u03c3\u0302 p,\u2202 \u22121v and \u03c4\u2202 \u22121o coincide. Given \u2202\n\u22121v and \u03c3\u0302 p,\u2202 \u22121v every vertex u at distance precisely \u2212 1 from v in G\u0302p then requires another d \u2212 1 neighbours outside of \u2202 \u22121v. Because G\u0302p is uniformly random givenSp, for each u these d \u22121 neighbours are simply the endpoints of edges eu,1, . . . , eu,d\u22121 drawn randomly from the set of all remaining edges with one endpoint of colour \u03c3\u0302 p(u). Since = o(log n), the subgraph \u2202 v consumes no more than no(1) edges. As a consequence, for each neighbour w \u2208 \u2202 \u22121v the colour \u03c3\u0302 p(w) has distribution \u03c1\u03bd(\u03c3\u0302 p(u), \u00b7 ), up to an error of no(1)\u22121 in total variation. Finally, the\nprobability that two vertices at distance precisely from v are neighbours is bounded by no(1)\u22121 as well.\nBy comparison, in the broadcasting process onTd the colours of the children of y are always drawn independently from the distribution \u03c1p(\u03c3 d,\u03b2,\u03bdp(y), \u00b7 ). Hence, the colours of the vertices at distance in the two processes can be coupled to completely coincide with probability 1 \u2212 O(d (\u03b6 + no(1)\u22121)), as claimed.\nIn addition, since we work with the conditional Boltzmann distributions where we \u201ccut off\u201d a part of the phase space,we need to verify that the configuration is very unlikely to hit the boundary of Sp. To see this, recall from Proposition 2.3 that, for \u03b2 \u2208 (0, \u03b2h), (\u03bdp, \u03c1p) is a stable local maxima of Fd,\u03b2 i.e. there exist \u03b4, c > 0 such that\nFd,\u03b2(\u03bd \u2032, \u03c1\u2032) \u2264 Fd,\u03b2(\u03bdp, \u03c1p) \u2212 c ( \u2016\u03bdp \u2212 \u03bd\u2032\u20162 + \u2016\u03c1p \u2212 \u03c1\u2032\u20162 ) (3.12)\nfor all \u03bd\u2032 \u2208 P([q]) and \u03c1\u2032 \u2208 R(\u03bd\u2032) such that \u2016\u03bdp\u2212\u03bd\u2032\u2016+\u2016\u03c1p\u2212\u03c1\u2032\u2016 < \u03b4. Now, choose \u03b5 in the definition of Sp(\u03b5) such that \u03b5 > \u03b4 and define Tp(\u03b4) = { \u03c3 \u2208 [q]n : 1n \u2211 c\u2208[q] \u2223 \u2223\u03c3\u22121(c) \u2223 \u2223 = \u03bdp + \u03b4 } for some > 0. Moreover, define a probability distribution \u03bd\u2032p on the q colours by \u03bd\u2032p(c) = 1q + \u03b4\nq for all c \u2208 [q] and let \u03c1\u2032p \u2208 R(\u03bd\u2032p) the corresponding maximizer for Fd,\u03b2(\u03bd\u2032p, \u00b7) (as in 2.4). Furthermore, choose sufficiently small so that \u2016\u03bdp \u2212 \u03bd\u2032p\u2016 + \u2016\u03c1p \u2212 \u03c1\u2032p\u2016 < \u03b4. Thus, by (3.12) and Lemma 3.2 we have\nP [ \u03c3\u0302 p \u2208 Tp(\u03b4) ] = \u2211\n\u03c3\u2208Tp(\u03b4)\n1 { \u03c3 \u2208 Sp } E[e\u03b2HG(\u03c3 )] E[Zp(G)] \u2264 exp ( nFd,\u03b2(\u03bd\u2032p, \u03c1\u2032p) ) exp ( nFd,\u03b2(\u03bdp, \u03c1p) + O(log n) )\n\u2264 exp (( \u2212c ( \u03b42 + \u2016\u03c1p \u2212 \u03c1\u2032\u20162 ) + o(1) ) n )\n\u2264 exp ((\u2212K + o(1)) n) for some sufficiently large constant K , as desired.\nThe colouring of the neighbourhood of v1 in G\u0302f admits a similar coupling with the ferromagnetic version of the broadcasting process.\nLemma 3.7. Let d, q \u2265 3 be integers and \u03b2 > \u03b2u be real. Then, for any vertex v and any non-negative integer = o(log n), given Sf w.h.p. we have\ndTV(\u03c3\u0302 f,\u2202 v, \u03c4\u2202 o) = O ( d ( dTV(\u03bd \u03c3\u0302 f , \u03bdf) + dTV(\u03c1 G\u0302(\u03c3\u0302 f ),\u03c3\u0302 f , \u03c1f) + n \u22120.99)) .\nProof. The argument from the proof of Lemma 3.6 carries over directly.\nProof of Proposition 2.7. We prove the first statement concerning G\u0302f ; the proof of the second statement for G\u0302p is analogous. Due to Proposition 3.1 we may work with the random graph G\u0302(\u03c3\u0302 f) with planted configuration \u03c3\u0302 f . Fix an arbitrary vertex v and = log log n . For the first assertion, by the Nishimori identity, it suffices to prove that\n\u2211\nc\u2208[q] E\n\u2223 \u2223 \u2223\u03bdf(c) \u2212 \u03bcG\u0302(\u03c3\u0302 f ),\u03b2(\u03c3 v = c | \u03c3 \u2202 v = \u03c3\u0302 f ,\u2202 v) \u2223 \u2223 \u2223 < \u22123, (3.13)\nwhere the expectation is over the choice of the pair (G\u0302(\u03c3\u0302 f), \u03c3\u0302 f). Indeed, the desired (o(1), \u22121, )-non-reconstruction property follows from (3.13) andMarkov\u2019s inequality.\nTo obtain (3.13) we first apply Lemma 3.5, which implies that with probability 1 \u2212 o(1/n),\ndTV ( \u03bd\u03c3\u0302 f , \u03bdf ) + dTV ( \u03c1 G\u0302(\u03c3\u0302 f ),\u03c3\u0302 f , \u03c1f ) \u2264 n\u22121/4. (3.14)\nFurther, assuming (3.14), we obtain from Lemma 3.7 that\ndTV(\u03c3 f,\u2202 v, \u03c4\u2202 o) = o(n\u22121/5). (3.15)\nHence, the colourings \u2202 v and \u03c4\u2202 o can be coupled such that both are identical with probability 1 \u2212 o(n\u22121/5). Consequently, (3.13) follows from Proposition 2.6.\nThus, we are left to prove the second assertion concerning (exp(\u2212\u03c7n), \u03b4, , \u03bcf )-nonreconstruction. Hence, given \u03b4 > 0 pick a large enough = (d, \u03b2, \u03b4) > 0, a small enough \u03b6 = \u03b6(\u03b4, ) > 0 and even smaller \u03be = \u03be(\u03b4, , \u03b6 ) > 0, \u03c7 = \u03c7(d, \u03b2, \u03be) > 0. Then in light of Lemma 3.5 we may assume that\ndTV ( \u03bd\u03c3\u0302 f , \u03bdf ) + dTV ( \u03c1 G\u0302(\u03c3\u0302 f ),\u03c3\u0302 f , \u03c1f ) < \u03be. (3.16)\nFurther, let X be the number of vertices u such that\n\u2211\nc\u2208[q]\n\u2223 \u2223 \u2223\u03bdf(c) \u2212 \u03bcG\u0302(\u03c3\u0302 f ),\u03b2(\u03c3 u = c | \u03c3 \u2202 u = \u03c3\u0302 f ,\u2202 u) \u2223 \u2223 \u2223 > \u03b6.\nThen Proposition 2.6, (3.16) and Lemma 3.7 imply that E[X] < \u03b6n. Moreover, X is tightly concentrated about its mean. Indeed, adding or removing a single edge of the random d-regular graph G\u0302(\u03c3\u0302 f) can alter the -th neighbourhoods of no more than d vertices. Therefore, the Azuma\u2013Hoeffding inequality shows that\nP [X > E[X | Sf ] + \u03b6n | Sf ] < exp(\u2212\u03c7n), (3.17) as desired.\n3.3. Proof of Corollary 2.8. We derive the corollary from Proposition 2.7, the Nishimori identity from Proposition 3.1 and the formula (2.6) for the second moment. As a first step we derive an estimate of the typical overlap of two configurations drawn from the Boltzmann distribution. To be precise, for a graph G = (V, E), the overlap of two configurations \u03c3, \u03c3 \u2032 \u2208 [q]V is defined as the probability distribution \u03bd(\u03c3, \u03c3 \u2032) \u2208 P([q]2) with\n\u03bdc,c\u2032(\u03c3, \u03c3 \u2032) = 1\nn\n\u2211\nv\u2208V (G) 1 { \u03c3v = c, \u03c3 \u2032v = c\u2032 } (c, c\u2032 \u2208 [q]).\nThus, \u03bd(\u03c3, \u03c3 \u2032) gauges the frequency of the colour combinations among vertices.\nLemma 3.8. Let d, q \u2265 3 be integers and \u03b2 < \u03b2h be real. Let \u03c3 G\u0302p,p, \u03c3 \u2032G\u0302p,p be independent samples from \u03bcG\u0302p,\u03b2( \u00b7 | Sp). Then E [ dTV ( \u03bd(\u03c3 G\u0302p,p , \u03c3 \u2032 G\u0302p,p ), \u03bdp \u2297 \u03bdp ) ] = o(1).\nProof. Due to the Nishimori identity (3.3) it suffices to prove that w.h.p. for a sample \u03c3 G\u0302(\u03c3\u0302 p) from \u03bcG\u0302(\u03c3\u0302 p),\u03b2( \u00b7 | Sp) it holds that\ndTV ( \u03bd(\u03c3\u0302 p, \u03c3 G\u0302(\u03c3\u0302 p),p ), \u03bdp \u2297 \u03bdp ) = o(1) (3.18)\nTo see (3.18), for colours s, t \u2208 [q], we consider the first and second moment of the number of vertices u with \u03c3\u0302 p(u) = s and \u03c3 G\u0302(\u03c3\u0302 p),p(u) = t . To facilitate the analysis of the second moment, it will be convenient to consider the following configuration \u03c3 \u2032 G\u0302(\u03c3\u0302 p),p\n. Let v,w be two random vertices such that \u03c3\u0302 p(v) = \u03c3\u0302 p(w) = s. Also let = (n) = log log n . Now, draw \u03c3 \u2032\u2032\nG\u0302(\u03c3\u0302 p),p from \u03bcG\u0302(\u03c3\u0302 p),\u03b2( \u00b7 | Sp) and subsequently\ngenerate \u03c3 \u2032 G\u0302p,p by re-sampling the colours of the vertices at distance less than from v,w given the colours of the vertices at distance precisely from v,w and the event Sp. Then \u03c3 \u2032G\u0302(\u03c3\u0302 p),p has distribution \u03bcG\u0302(\u03c3\u0302 p),\u03b2( \u00b7 | Sp). Moreover, since for two random vertices v,w their -neighbourhoods are going to be disjoint, Proposition 2.7 implies that w.h.p.\nP\n[\n\u03c3 \u2032 G\u0302p,p (v) = \u03c7, \u03c3 \u2032 G\u0302p,p\n(w) = \u03c7 \u2032 | \u03c3\u0302 p, G\u0302(\u03c3\u0302 p), v,w ]\n= \u03bdp(\u03c7)\u03bdp(\u03c7 \u2032) + o(1) for all \u03c7, \u03c7 \u2032 \u2208 [q]. (3.19) Hence, for a colour t \u2208 [q] let X(s, t) be the number of vertices u with \u03c3\u0302 p(u) = s and \u03c3 \u2032 G\u0302p,p (u) = t . Then (3.19) shows that w.h.p.\nE [ X(s, t) | \u03c3\u0302 p, G\u0302(\u03c3\u0302 p) ] \u223c n\nq2 , E\n[ X(s, t)2 | \u03c3\u0302 p, G\u0302(\u03c3\u0302 p) ] \u223c n 2\nq4 .\nThus, (3.18) follows from Chebyshev\u2019s inequality.\nLemma 3.9. Let d, q \u2265 3 be integers and \u03b2 > \u03b2u be real. Let \u03c3 G\u0302f ,f , \u03c3 \u2032G\u0302f ,f be independent samples from \u03bcG\u0302f ,\u03b2( \u00b7 | Sf). Then E [ dTV ( \u03bd(\u03c3 G\u0302f ,f , \u03c3 \u2032 G\u0302f ,f ), \u03bdf \u2297 \u03bdf )] = o(1).\nProof. The same argument as in the proof of Lemma 3.8 applies.\nWe proceed to apply the second moment method to truncated versions of the paramagnetic and ferromagnetic partition functions Zp, Zf where we expressly drop graphs that violate the overlap bounds from Lemmas 3.8 and 3.9. Thus, we introduce\nYp(G) = Zp(G) \u00b7 1 { E [ dTV(\u03bd(\u03c3G,p, \u03c3 \u2032 G,p), \u03bdp \u2297 \u03bdp) ] = o(1) } , (3.20) Yf(G) = Zf(G) \u00b7 1 { E [ dTV(\u03bd(\u03c3G,f , \u03c3 \u2032 G,f), \u03bdf \u2297 \u03bdf)\n] = o(1)} . (3.21) Estimating the second moments of these two random variables is a cinch because by construction we can avoid an explicit optimisation of the function F\u2297d,\u03b2 from (2.6). Indeed, because we drop graphs G whose overlaps stray far from the product measures \u03bdp \u2297 \u03bdp and \u03bdf \u2297 \u03bdf , respectively, we basically just need to evaluate the function F\u2297d,\u03b2 at \u03bdp \u2297 \u03bdp and \u03bdf \u2297 \u03bdf . Corollary 3.10. Let d \u2265 3.\n(i) If \u03b2 < \u03b2h, then E[Yp(G)] \u223c E[Zp(G)] and E[Yp(G)2] \u2264 exp(o(n))E[Zp(G)]2. (ii) If \u03b2 > \u03b2u, then E[Yf(G)] \u223c E[Zf(G)] and E[Yf(G)2] \u2264 exp(o(n))E[Zf(G)]2. Proof. Assume that \u03b2 < \u03b2h . Let Ep = {G : E [ dTV(\u03bd(\u03c3G,p, \u03c3 \u2032G,p), \u03bdp \u2297 \u03bdp)\n] = o(1)}. Combining Lemma 3.8 with the Nishimori identity (3.3), we obtain\nE[Yp(G)] E[Zp(G)] = P [ G\u0302p \u2208 Ep ] \u223c 1 (3.22)\nand thus E[Yp(G)] \u223c E[Zp(G)]. Regarding the second moment, consider the set Pp(n) of all probability distributions \u03bd on [q] \u00d7 [q] such that n\u03bd(\u03c7, \u03c7 \u2032) is an integer for all \u03c7, \u03c7 \u2032 \u2208 [q] and such that dTV(\u03bd, u) = o(1). Let Rp(\u03bd, n) be the set of all distributions \u03c1 on [q]4 such that\n\u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) = \u03c1(\u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032, \u03c7, \u03c7 \u2032) for all \u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032 \u2208 [q] and (3.23) \u2211 \u03c7 \u2032\u2032,\u03c7 \u2032\u2032\u2032\u2208[q] \u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) = \u03bd(\u03c7, \u03c7 \u2032) for all \u03c7, \u03c7 \u2032 \u2208 [q] (3.24)\nand such that n\u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) is an integer for all \u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032 \u2208 [q]. Using the definition (3.20) of Yp, Lemma 2.1 and the linearity of expectation, we bound\nE [ Yp(G)2 ] \u2264 (1 + o(1)) \u2211 \u03c3,\u03c3 \u2032\u2208[q]n 1 { dTV(\u03bd(\u03c3, \u03c3 \u2032), \u03bdp \u2297 \u03bdp) = o(1) } E [ e\u03b2(HG(\u03c3 )+HG(\u03c3 \u2032)) ]\n\u2264 \u2211\n\u03bd\u2208Pp(n)\n( n\n\u03bdn\n) \u2211\n\u03c1\u2208Rp(\u03bd,n) exp [dn 2\nq\u2211\n\u03c7,\u03c7 \u2032,\u03c7 \u2032\u2032,\u03c7 \u2032\u2032\u2032=1 \u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) log \u03bd(\u03c7, \u03c7\n\u2032)\u03bd(\u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) \u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032)\n+ \u03b2 ( 1 { \u03c7 = \u03c7 \u2032\u2032} + 1 {\u03c7 \u2032 = \u03c7 \u2032\u2032\u2032}) + O(log n) ] . (3.25)\nFor any given \u03bd the term inside the square brackets is a strictly concave function of \u03c1. Therefore, for any \u03bd there exists a unique maximiser \u03c1\u2217\u03bd . Moreover, the set Rp(\u03bd, n) has size |Rp(\u03bd, n)| = nO(1). Hence, using Stirling\u2019s formula we can simplify (3.25) to\nE [ Yp(G)2 ] \u2264 \u2211 \u03bd\u2208Pp(n) exp [ \u2212 n q\u2211 \u03c7,\u03c7 \u2032=1 \u03bd(\u03c7, \u03c7 \u2032) log \u03bd(\u03c7, \u03c7 \u2032)\n+ dn\n2\nq\u2211\n\u03c7,\u03c7 \u2032,\u03c7 \u2032\u2032,\u03c7 \u2032\u2032\u2032=1 \u03c1\u2217\u03bd (\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) log \u03bd(\u03c7, \u03c7 \u2032)\u03bd(\u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) \u03c1\u2217\u03bd (\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032)\n+ \u03b2 ( 1 { \u03c7 = \u03c7 \u2032\u2032} + 1 {\u03c7 \u2032 = \u03c7 \u2032\u2032\u2032}) + O(log n) ] . (3.26)\nTo further simplify the expression notice that the maximiser \u03c1\u2217\u03bd is the unique solution to a concave optimisation problem subject to the linear constraints (3.23)\u2013(3.24). Since the constraints (3.24) themselves are linear in \u03bd, by the inverse function theorem the maximiser \u03c1\u2217\u03bd is a continuous function of \u03bd. In effect, since |Pp(n)| = nO(1), we can bound (3.26) by the contribution of the uniform distribution \u03bdp\u2297\u03bdp only. We thus obtain\nE [ Yp(G)2 ] \u2264 qn exp [dn\n2\nq\u2211\n\u03c7,\u03c7 \u2032,\u03c7 \u2032\u2032,\u03c7 \u2032\u2032\u2032=1 \u03c1\u2217\u03bdp\u2297\u03bdp(\u03c7, \u03c7\n\u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) log \u03bdp(\u03c7, \u03c7 \u2032)\u03bdp(\u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032)\n\u03c1\u2217\u03bdp\u2297\u03bdp(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032)\n+ \u03b2 ( 1 { \u03c7 = \u03c7 \u2032\u2032} + 1 {\u03c7 \u2032 = \u03c7 \u2032\u2032\u2032}) + o(n) ] . (3.27)\nFinally, the maximiser \u03c1\u2217\u03bdp\u2297\u03bdp in (3.27) works out to be \u03c1 \u2217 \u03bdp\u2297\u03bdp = \u03c1p\u2297\u03c1p. To see this, recall from Lemma 3.8 that \u03bdp is the uniform distribution on [q]. It therefore remains to show that subject to (3.23)\u2013(3.24), the function\ng(\u03c1) = q\u2211\n\u03c7,\u03c7 \u2032,\u03c7 \u2032\u2032,\u03c7 \u2032\u2032\u2032=1 \u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) log\n\u03bdp(\u03c7)\u03bdp(\u03c7 \u2032)\u03bdp(\u03c7 \u2032\u2032)\u03bdp(\u03c7 \u2032\u2032\u2032)\n\u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032)\n+ \u03b2 ( 1 { \u03c7 = \u03c7 \u2032\u2032} + 1 {\u03c7 \u2032 = \u03c7 \u2032\u2032\u2032})\n= \u22124 log q \u2212 q\u2211\n\u03c7,\u03c7 \u2032,\u03c7 \u2032\u2032,\u03c7 \u2032\u2032\u2032=1 \u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) log ( \u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) )\n\u2212 \u03b2 (1 {\u03c7 = \u03c7 \u2032\u2032} + 1 {\u03c7 \u2032 = \u03c7 \u2032\u2032\u2032})\nattains its maximum at the distribution \u03c1 = \u03c1p \u2297 \u03c1p. Since g is strictly concave, the unique maximum occurs at the unique stationary point of the Lagrangian\nLp = g(\u03c1) + \u2211\n\u03c7,\u03c7 \u2032,\u03c7 \u2032\u2032,\u03c7 \u2032\u2032\u2032 \u03bb\u03c7,\u03c7 \u2032,\u03c7 \u2032\u2032,\u03c7 \u2032\u2032\u2032\n( \u03c1 ( \u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032 )\u2212 \u03c1 (\u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032, \u03c7, \u03c7 \u2032))\n+ \u2211\n\u03c7,\u03c7 \u2032 \u03bb\u03c7,\u03c7 \u2032\n\u239b\n\u239d \u2211\n\u03c7 \u2032\u2032,\u03c7 \u2032\u2032\u2032\u2208[q] \u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) \u2212 \u03bd(\u03c7, \u03c7 \u2032)\n\u239e\n\u23a0 .\nSince the derivatives work out to be\n\u2202Lp \u2202\u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) = \u22121 \u2212 log \u03c1(\u03c7, \u03c7 \u2032, \u03c7 \u2032\u2032, \u03c7 \u2032\u2032\u2032) + \u03bb\u03c7,\u03c7 \u2032,\u03c7 \u2032\u2032,\u03c7 \u2032\u2032\u2032 \u2212 \u03bb\u03c7 \u2032\u2032,\u03c7 \u2032\u2032\u2032,\u03c7 \u2032,\u03c7 \u2032 + \u03bb\u03c7,\u03c7 \u2032 + \u03b21{\u03c7 = \u03c7 \u2032\u2032} + \u03b21{\u03c7 \u2032 = \u03c7 \u2032\u2032\u2032},\nfor the choice\u03c1 = \u03c1p\u2297\u03c1p there exist Lagrangemultipliers such that all partial derivatives vanish.\nThe proof of (ii) proceeds analogously.\nProof of Corollary 2.8. Thecorollary is nowan immediate consequenceofCorollary 3.10, the Paley-Zygmund and Azuma inequalities.\n3.4. Proof of Corollary 2.9. To prove Corollary 2.9 we derive the following general transfer principle from the estimate of the Boltzmann weights of Sf and Sp from Corollary 2.8.\nLemma 3.11. Let d \u2265 3. (i) If\u03b2 < \u03b2h, then for any eventE withP [ G\u0302p \u2208 E ] \u2264 exp(\u2212 (n))wehaveP [G \u2208 E] =\no(1).\n(ii) If\u03b2 > \u03b2u, then for any eventE withP [ G\u0302f \u2208 E ] \u2264 exp(\u2212 (n))wehaveP [G \u2208 E] =\no(1).\nProof. This follows from a \u201cquiet planting\u201d argument akin to the one from [2]. Specifically, Theorem 2.5 and Proposition 2.3 show that for \u03b2 < \u03b2h the event Zp = {Zp(G) = E[Zp(G)] exp(o(n))}occursw.h.p. Therefore, recalling the definition (2.8) of the planted model, we obtain\nP [G \u2208 E] \u2264 P [G \u2208 E \u2229 Zp ] + P [ G \u2208 Zp ] \u2264 E[1{G \u2208 E}Zp(G)] exp(o(n)) E[Zp(G)] + o(1)\n\u2264 exp(o(n))P [ G\u0302p \u2208 E ] + o(1) = o(1). (3.28)\nSince the simple random regular graph G is contiguous with respect to G, assertion (i) follows from (3.28). The proof of (ii) is identical.\nProof of Corollary 2.9. The assertion follows from Lemma 3.11 and Proposition 2.7."
        },
        {
            "heading": "4. Metastability and Slow Mixing",
            "text": "In this section, we prove Theorems 1.1 and 1.2. Recall from Sect. 1.3 the paramagnetic and ferromagnetic states Sp(\u03b5) and Sf(\u03b5) for \u03b5 > 0. For the purposes of this section we will need to be more systematic of keeping track the dependence of these phases on \u03b5. In particular, we will use the more explicit notation Z \u03b5p(G) and Z \u03b5 f (G) to denote the quantities Zp(G) and Zf(G), respectively, from (2.7). The following lemma reflects the fact that \u03bdp and \u03bdf are local maxima of the first moment.\nLemma 4.1. Let q, d \u2265 3 be integers and \u03b2 > 0 be real. Then, for all sufficiently small constants \u03b5\u2032 > \u03b5 > 0 and any constant \u03b8 > 0, there exists constant \u03b6 > 0 such that w.h.p. over G \u223c G, it holds that (1) If \u03b2 < \u03b2h, then Z \u03b5p(G) = eo(n)E[Z \u03b5p(G)] and Z \u03b5\u2032p (G) \u2264 (1 + e\u2212\u03b6n)Z \u03b5p(G). (2) If \u03b2 > \u03b2u, then Z \u03b5f (G) = eo(n)E[Z \u03b5f (G)] and Z \u03b5 \u2032 f (G) \u2264 (1 + e\u2212\u03b6n)Z \u03b5f (G).\nProof. We first prove Item (1), let \u03b2 < \u03b2h . Recall from (2.2) the function F(\u03bd, \u03c1) := Fd,\u03b2(\u03bd, \u03c1) for \u03bd \u2208 P([q]) and \u03c1 \u2208 R(\u03bd). By Corollary 2.8, for all sufficiently small constant \u03b5 > 0, we have that\nE[ 1n log Z \u03b5p(G)] = Bd,\u03b2(\u03bcp) + o(1) = F(\u03bdp, \u03c1p) + o(1), where the last equality holds by Lemma 2.2. Applying Azuma\u2019s inequality to the random variable log Z \u03b5p(G) by revealing the edges of G one-by-one, we therefore obtain that w.h.p. it holds that Z \u03b5p(G) = enF(\u03bdp,\u03c1p)+o(n). Also, from Lemma 3.2 we have that E[Z \u03b5p(G)] = enF(\u03bdp,\u03c1p)+o(n), so we obtain that Z \u03b5p(G) = eo(n)E[Z \u03b5p(G)] proving the first inequality of Item (1). For the second inequality, recall from Proposition 2.3 that (\u03bdp, \u03c1p) is a local maximum of F for \u03b2 < \u03b2h , cf. (2.3). Therefore, for all sufficiently small constants \u03b5\u2032 > \u03b5 > 0, there exists constant \u03b6 > 0 such that\nF(\u03bd, \u03c1) \u2264 F(\u03bdp, \u03c1p) \u2212 4\u03b6 (4.1)\nfor all \u03bd \u2208 P([q]) and \u03c1 \u2208 R(\u03bd) with \u03b5 \u2264 \u2225\u2225\u03bd \u2212 \u03bdp \u2225 \u2225 + \u2225 \u2225\u03c1 \u2212 \u03c1p \u2225 \u2225 \u2264 \u03b5\u2032. (4.2)\nUsing (3.10), we see that\nE [ Z \u03b5 \u2032 p (G) \u2212 Z \u03b5p(G) ] \u2264 \u2211\n\u03bd,\u03c1\nexp(nF(\u03bd, \u03c1) + O(log n))\nwhere the sum ranges over \u03bd \u2208 P([q]) and \u03c1 \u2208 R(\u03bd) satisfying (4.2) such that n\u03bd(s), dn\u03c1(s, t) are integers for all s, t \u2208 [q], and dn\u03c1(s, s) is even. Since there are at most nO(1) choices for such colour statistics \u03bd, \u03c1, we obtain that E [ Z \u03b5 \u2032 p (G)\u2212 Z \u03b5p(G)\n] \u2264 en(F(\u03bdp,\u03c1p)\u22123\u03b6 ) for all sufficiently large n. By Markov\u2019s inequality, we therefore have that w.h.p. Z \u03b5 \u2032 p (G) \u2212 Z \u03b5p(G) \u2264 enF(\u03bdp,\u03c1p)\u22122\u03b6n . As we showed above, w.h.p. Z \u03b5p(G) = enF(\u03bdp,\u03c1p)+o(n), so combining theseweobtain thatw.h.p. Z \u03b5p(G) \u2265 e\u03b6n ( Z \u03b5 \u2032 p (G)\u2212Z \u03b5p(G) ) , completing the proof of Item (1) of the lemma. For the second item of the lemma, the proof is completely analogous, using the fact\nfrom Proposition 2.3 that (\u03bdf , \u03c1f) is a local maximum of F(\u03bd, \u03c1) for \u03b2 > \u03b2u .\nTheorem 1.1 will follow by way of a conductance argument. Let G = (V, E) be a graph, and P be the transition matrix for the Glauber dynamics defined in Sect. 1.4. For a set S \u2286 [q]V define the bottleneck ratio of S to be\n(S) = \u2211\n\u03c3\u2208S, \u03c4 \u2208S \u03bcG,\u03b2(\u03c3 )P(\u03c3, \u03c4 ) \u03bcG,\u03b2(S)\n(4.3)\nThe following lemma provides a routine conductance bound (e.g., [38, Theorem 7.3]). For the sake of completeness the proof is included in Appendix A.\nLemma 4.2. Let G = (V, E) be a graph. For any S \u2286 [q]V such that \u03bcG(S) > 0 and any integer t \u2265 0 we have \u2225\u2225\u03bcG,S Pt \u2212 \u03bcG,S \u2225 \u2225 T V \u2264 t (S).\nProof of Theorem 1.1. We prove the statement for the pairing model G, the result for G follows immediately by contiguity. Let \u03b5\u2032 > \u03b5 > 0 and \u03b6 > 0 be small constants such that Lemma 4.1 applies, and let G \u223c G be a graph satisfying the lemma. Set for convenience \u03bc = \u03bcG,\u03b2 ; we consider first the metastability of Sf(\u03b5) for \u03b2 > \u03b2u .\nSince Glauber updates one vertex at a time it is impossible in one step to move from \u03c3 \u2208 Sf(\u03b5) to \u03c4 \u2208 [q]n\\Sf(\u03b5\u2032), i.e., P(\u03c3, \u03c4 ) = 0, and therefore\n( Sf(\u03b5) ) = \u2211 \u03c3\u2208Sf (\u03b5) \u2211\n\u03c4 /\u2208Sf (\u03b5) \u03bc(\u03c3 )P(\u03c3, \u03c4 ) \u03bc ( Sf(\u03b5)\n) = \u2211 \u03c3\u2208Sf (\u03b5) \u2211\n\u03c4\u2208Sf (\u03b5\u2032)\\Sf (\u03b5) \u03bc(\u03c3 )P(\u03c3, \u03c4 ) \u03bc ( Sf(\u03b5) )\nBy reversibility of Glauber, for any \u03c3, \u03c4 \u2208 [q]n we have \u03bc(\u03c3)P(\u03c3, \u03c4 ) = \u03bc(\u03c4)P(\u03c4, \u03c3 ), and therefore\n\u2211\n\u03c3\u2208Sf (\u03b5)\n\u2211\n\u03c4\u2208Sf (\u03b5\u2032)\\Sf (\u03b5) \u03bc(\u03c3 )P(\u03c3, \u03c4 )\n= \u2211\n\u03c4\u2208Sf (\u03b5\u2032)\\Sf (\u03b5) \u03bc(\u03c4)\n\u2211\n\u03c3\u2208Sf (\u03b5) P(\u03c4, \u03c3 ) \u2264\n\u2211\n\u03c4\u2208Sf (\u03b5\u2032)\\Sf (\u03b5) \u03bc(\u03c4) = \u03bc(Sf(\u03b5\u2032)\\Sf(\u03b5) )\nHence, ( Sf(\u03b5) ) \u2264 \u03bc ( Sf (\u03b5\u2032)\\Sf (\u03b5) )\n\u03bc ( Sf (\u03b5)\n) = Z\u03b5 \u2032\nf (G)\u2212Z\u03b5f (G) Z\u03b5f (G) \u2264 e\u2212\u03b6n , where the last inequality follows from the fact that G satisfies Lemma 4.1. Lemma 4.2 therefore ensures that for all nonnegative integers T \u2264 e\u03b6n/3\n\u2225 \u2225 \u2225\u03bc ( \u00b7 | Sf(\u03b5) ) PT \u2212 \u03bc( \u00b7 | Sf(\u03b5) )\u2225\u2225 \u2225 T V \u2264 T \u00b7 (Sf) \u2264 e\u22122\u03b6n/3. (4.4)\nNow, consider the Glauber dynamics (\u03c3t )t\u22650 launched from \u03c30 drawn from \u03bcG,\u03b2,Sf (\u03b5), and denote by Tf = min {t > 0 : \u03c3t /\u2208 Sf(\u03b5)} its escape time from Sf(\u03b5). Observe that \u03c3t has the same distribution as \u03bc( \u00b7 | Sf(\u03b5))Pt , so (4.4) implies that for all nonnegative integers T \u2264 e\u03b6n/3\n\u2223 \u2223P [\u03c3T \u2208 Sf(\u03b5)] \u2212 1 \u2223 \u2223 < e\u22122\u03b6n/3, or equivalently P [\u03c3T /\u2208 Sf(\u03b5)] \u2264 e\u22122\u03b6n/3.\nBy a union bound over the values of T , we therefore obtain that P[Tf \u2264 e\u03b6n/3] \u2264 e\u2212\u03b6n/3, thus proving that Sf(\u03b5) is a metastable state for \u03b2 > \u03b2u . Analogous arguments show that Sp(\u03b5) is a metastable state for \u03b2 < \u03b2h .\nThe slow mixing of Glauber for \u03b2 > \u03b2u follows from the metastability of Sf(\u03b5). In particular, from Theorem 1.3 we have that \u2225 \u2225\u03bc ( \u00b7 | Sf(\u03b5) )\u2212 \u03bc\u2225\u2225 \u2265 3/5 and therefore, from (4.4), \u2225 \u2225\u03bc ( \u00b7 | Sf(\u03b5) ) PT \u2212 \u03bc\u2225\u2225 \u2265 1/2, yielding that the mixing time is e (n).\nThe final ingredients to establish Theorem 1.2 are the following results, bounding the probability that Swendsen\u2013Wang escapes Sp(\u03b5) and Sf(\u03b5). More precisely, for a graph G, a configuration \u03c3 \u2208 [q]n , and S \u2286 [q]n , let PGSW (\u03c3 \u2192 S) denote the probability that after one step of SW on G starting from \u03c3 , we end up in a configuration in S.\nThe following proposition shows that for almost all pairs (G, \u03c3 ) from the paramagnetic planted distribution ( G\u0302 ( \u03c3\u0302 p(\u03b5) ) , \u03c3\u0302 p(\u03b5) ) , the probability that SW leads to a configuration in the paramagnetic phase, slightly enlarged, is 1 \u2212 e\u2212 (n). Proposition 4.3. Let q, d \u2265 3 be integers and \u03b2 \u2208 (\u03b2u, \u03b2h) be real. Then, for all sufficiently small constants \u03b5\u2032 > \u03b5 > 0, there exists constant \u03b7 > 0 such that with probability 1\u2212e\u2212\u03b7n over the planted distribution (G, \u03c3 ) \u223c (G\u0302(\u03c3\u0302 p(\u03b5) ) , \u03c3\u0302 p(\u03b5) ) , it holds that PGSW ( \u03c3 \u2192 Sp(\u03b5\u2032)\n) \u2265 1 \u2212 e\u2212\u03b7n. The following establishes the analogue of the previous proposition for the ferro-\nmagnetic planted distribution ( G\u0302 ( \u03c3\u0302 f(\u03b5) ) , \u03c3\u0302 f(\u03b5) ) . Note here that SW might change the dominant colour due to recolouring step, so, for \u03b5 > 0, we now need to consider the set of configurations S\u0303f(\u03b5) that consists of the ferromagnetic phase Sf(\u03b5) together with its q \u2212 1 permutations, and the probability that SW escapes from it, starting from a ferromagnetic state.\nProposition 4.4. Let q, d \u2265 3 be integers and \u03b2 \u2208 (\u03b2u, \u03b2h) be real. Then, for all sufficiently small constants \u03b5\u2032 > \u03b5 > 0, there exists constant \u03b7 > 0 such that with probability 1\u2212 e\u2212\u03b7n over the planted distribution (G, \u03c3 ) \u223c (G\u0302(\u03c3\u0302 f(\u03b5) ) , \u03c3\u0302 f(\u03b5) ) , it holds that PGSW ( \u03c3 \u2192 S\u0303f(\u03b5\u2032)\n) \u2265 1 \u2212 e\u2212\u03b7n. Proof of Theorem 1.2. We prove the statement for the pairing model G, the result forG follows immediately by contiguity. We consider first the metastability for the ferromagnetic phase when \u03b2 > \u03b2u . Let \u03b5\u2032 > \u03b5 > 0 and \u03b7, \u03b6 > 0 be small constants such that Lemma 4.1 and Propositions 4.3, 4.4 all apply. Let \u03b8 = 110 min{\u03b7, \u03b6 }.\nLet Q be the set of d-regular (multi)graphs that satisfy\nZ \u03b5f (G) \u2265 e\u2212\u03b8nE[Z \u03b5f (G)] and Z \u03b5 \u2032 f (G) \u2264 (1 + e\u2212\u03b6n)Z \u03b5f (G), and note that by Item (2) of Lemma 4.1 it holds that P[G \u2208 Q] = 1 \u2212 o(1). Moreover, let Q\u2032 be the set of d-regular (multi)graphs G such that the set of configurations where SW has conceivable probability of escaping S\u0303f(\u03b5\u2032) has small weight, i.e., the set\nSBad(G) = { \u03c3 \u2208 S\u0303f(\u03b5) \u2223 \u2223 PGSW ( \u03c3 \u2192 S\u0303f(\u03b5\u2032) ) < 1 \u2212 e\u2212\u03b7n}\nhas aggregate weight ZBad(G) = \u2211\u03c3\u2208SBad(G) e\u03b2H(G) less than e\u2212\u03b8n Z \u03b5f (G). We claim that for a d-regular graph G such that G \u2208 Q\u2229Q\u2032, it holds that SW ( S\u0303f(\u03b5)\n) \u2264 10e\u2212\u03b7n , where SW (\u00b7) denotes the bottleneck ratio for the SW-chain. Indeed, we have\nSW ( S\u0303f(\u03b5) ) = \u2211 \u03c3\u2208S\u0303f (\u03b5) \u03bc(\u03c3 )P G SW (\u03c3 \u2192 [q]n\\S\u0303f(\u03b5))\n\u03bc ( S\u0303f(\u03b5) )\n\u2264 \u03bc ( SBad(G) ) + \u2211 \u03c3\u2208S\u0303f (\u03b5)\\SBad(G) \u03bc(\u03c3 )P G SW (\u03c3 \u2192 [q]n\\S\u0303f(\u03b5))\n\u03bc ( S\u0303f(\u03b5) )\nWe can decompose the sum in the numerator of the last expression as\n\u2211\n\u03c3\u2208S\u0303f (\u03b5)\\SBad(G) \u03bc(\u03c3 )PGSW\n( \u03c3 \u2192 [q]n\\S\u0303f (\u03b5\u2032) ) +\n\u2211\n\u03c3\u2208S\u0303f (\u03b5)\\SBad(G) \u03bc(\u03c3 )PGSW\n( \u03c3 \u2192 S\u0303f (\u03b5\u2032)\\S\u0303f (\u03b5) ) .\nFor \u03c3 \u2208 S\u0303f(\u03b5)\\SBad(G), we have PGSW ( \u03c3 \u2192 [q]n\\S\u0303f(\u03b5\u2032) ) \u2264 e\u2212\u03b7n and therefore the first sum is upper bounded by e\u2212\u03b7n\u03bc ( S\u0303f(\u03b5) ) . The second sum, using the reversibility of the SW chain, is upper bounded by \u03bc ( S\u0303f(\u03b5\u2032)\\S\u0303f(\u03b5) ) . Using these, we therefore have that\nSW ( S\u0303f(\u03b5) ) \u2264 \u03bc ( SBad(G) ) + e\u2212\u03b7n\u03bc ( S\u0303f(\u03b5) ) + \u03bc ( S\u0303f(\u03b5\u2032)\\S\u0303f(\u03b5) )\n\u03bc ( S\u0303f(\u03b5)\n) \u2264 10e\u2212\u03b8n,\nsince \u03bc ( SBad(G) )\n\u03bc ( S\u0303f (\u03b5) ) = ZBad(G)qZ\u03b5f (G) \u2264 e \u2212\u03b8n from the assumption G \u2208 Q\u2032 and \u03bc\n( S\u0303f (\u03b5\u2032)\\S\u0303f (\u03b5) )\n\u03bc ( S\u0303f (\u03b5) ) = q(Z\u03b5\n\u2032 f (G)\u2212Z\u03b5f (G)) qZ\u03b5f (G)\n\u2264 e\u2212\u03b8n from Lemma 4.1. By arguments analogous to those in the proof of Theorem 1.1, we have that S\u0303f(\u03b5) is a metastable state for graphs G \u2208 Q \u2229 Q\u2032. Therefore, to finish the metastability proof for the random graph, it suffices to show that P[G \u2208 Q \u2229 Q\u2032] = 1 \u2212 o(1).\nTo do this, let G(n, d) be the set of all multigraphs that can be obtained in the pairing model and d,\u03b2(n) = { (G, \u03c3 ) \u2223 \u2223G \u2208 G(n, d), \u03c3 \u2208 S\u0303f(\u03b5) } . Let E be the pairs (G, \u03c3 ) \u2208 d,\u03b2(n) where one step of SW starting from G, \u03c3 stays within S\u0303f(\u03b5\u2032) with probability 1 \u2212 e\u2212 (n), more precisely\nE = { (G, \u03c3 ) \u2208 d,\u03b2(n) \u2223 \u2223 PGSW ( \u03c3 \u2192 S\u0303f(\u03b5\u2032) ) \u2265 1 \u2212 e\u2212\u03b7n } .\nThe aggregate weight corresponding to pairs (G, \u03c3 ) that do not belong to E can be lower-bounded by\n\u2211\n(G,\u03c3 )\u2208 d,\u03b2\\E e\u03b2HG (\u03c3 ) \u2265\n\u2211\n(G,\u03c3 )\u2208 d,\u03b2\\E; G\u2208Q\\Q\u2032\ne\u03b2HG (\u03c3 )\n= \u2211\nG\u2208Q\\Q\u2032\n\u2211\n\u03c3\u2208 Bad(G) e\u03b2HG (\u03c3 ) \u2265 e\u2212\u03b8n\n\u2211\nG\u2208Q\\Q\u2032 Z \u03b5f (G).\nFor graphs G \u2208 Q we have Z \u03b5f (G) \u2265 e\u2212\u03b8nE[Z \u03b5f (G)], and therefore \u2211 (G,\u03c3 )\u2208 d,\u03b2\\E e\u03b2HG (\u03c3 ) \u2265 e\u22122\u03b8n\u2223\u2223Q\\Q\u2032\u2223\u2223E[Z \u03b5f (G) ] = e\u22122\u03b8n\u2223\u2223Q\\Q\u2032\u2223\u2223 \u2211 (G,\u03c3 )\u2208 d,\u03b2 e \u03b2HG (\u03c3 ) \u2223 \u2223G(n, d)\u2223\u2223 (4.5) From the definition of ( G\u0302 ( \u03c3\u0302 f(\u03b5) ) , \u03c3\u0302 f(\u03b5) ) , cf. (3.1),(3.2), observe that\n\u2211 (G,\u03c3 )\u2208 d,\u03b2\\E e \u03b2HG (\u03c3 ) \u2211\n(G,\u03c3 )\u2208 d,\u03b2 e\u03b2HG (\u03c3 ) = P[(G\u0302(\u03c3\u0302 f(\u03b5)), \u03c3\u0302 f(\u03b5) ) \u2208 d,\u03b2\\E ] \u2264 e\u2212\u03b7n \u2264 e\u221210\u03b8n,\nwhere the penultimate inequality follows from Proposition 4.4 and the last from the choice of \u03b8 . Combining this with (4.5), we obtain P[G \u2208 Q\\Q\u2032] = o(1). Since P[G \u2208 Q] = 1 \u2212 o(1) from Lemma 4.1, it follows that\nP[G \u2208 Q \u2229 Q\u2032] \u2265 P[G \u2208 Q] \u2212 P[G \u2208 Q\\Q\u2032] \u2265 1 \u2212 o(1). This concludes the proof for the metastability of the ferromagnetic phase S\u0303f(\u03b5) when \u03b2 > \u03b2u .\nA similar bottleneck-ratio argument shows that Sp(\u03b5) is a metastable state for \u03b2 < \u03b2h . The slow mixing of SW for \u03b2 \u2208 (\u03b2u, \u03b2h) follows from the metastability of S\u0303f(\u03b5) when \u03b2 \u2208 (\u03b2u, \u03b2p] and the metastability of Sp(\u03b5) when \u03b2 \u2208 [\u03b2p, \u03b2h). In particular, let S \u2208 {S\u0303f(\u03b5), Sp(\u03b5)} be such that \u2225 \u2225\u03bc ( \u00b7 | S)\u2212 \u03bc\u2225\u2225 \u2265 1/2, then Lemma 4.2 gives that for T = e (n), it holds that \u2225\u2225\u03bc( \u00b7 | S)PTSW \u2212 \u03bc \u2225 \u2225 \u2265 1/2 \u2212 1/10, yielding that the mixing time is e (n)."
        },
        {
            "heading": "5. Remaining Proofs for Swendsen\u2013Wang",
            "text": "To analyse the Swendsen\u2013Wang dynamics on the d-regular random graph G, we will need to consider the component structure after performing edge percolation with probability p \u2208 (0, 1). Key quantities we will be interested in are the size of the largest compoment, which will allow us to track whether we land in the paramagnetic or ferromagnetic phases, as well as the sum of squares of component sizes; the first will signify whether we land in the paramagnetic or ferromagnetic phases, and the second will allow us to track the random fluctuations caused by the colouring step of SW. Both of these ingredients have been worked out in detail for the mean-field case; here the random regular graph makes all the arguments more involved technically, even for a single iteration (recall that the reason it suffices to analyse a single iteration is because of the quiet planting idea of Sects. 3 and 4).\n5.1. Percolation on random regular graphs. For a graphG and p \u2208 (0, 1), we denote by Gp the random graph obtained by keeping every edge of G with probability p. Working in the configuration model, we will denote by G p := G p(n, d) the multigraph obtained by first choosing a randommatching of the points in [n]\u00d7[d], then keeping each edge of the matching with probability p, and finally projecting the edges onto vertices in [n]. It will also be relevant to consider themultigraph G\u0303 p := G\u0303 p(n, d)where in the second step we instead keep a random subset of exactly m = [pdn/2] edges. To help differentiate between the twomodels, we will refer to G p as the binomial-edge model, whereas to G\u0303 p as the exact-edge model. Note that for an n-vertex multigraph G of maximum degree d with m edges, the two models are related by\nP [ G p = G | E(G p) = m ] = P[G\u0303 p\u0303 = G], where p\u0303 = 2m/nd.\nsee for example [25, Lemma 3.1]. Based on this, it is standard to relate the two models for events that are monotone under edge inclusion.5\nLemma 5.1. Let d \u2265 3 be an integer and p\u2217 \u2208 (0, 1) be a constant. There exists a constant c > 0 such that, for any constant \u03b4 \u2208 (0, 1), for any increasing property E and any decreasing property F on multigraphs of maximum degree d, it holds that\n1 2P[G\u0303 p\u2217\u2212\u03b4 \u2208 E] \u2264 P[G p\u2217 \u2208 E] \u2264 P[G\u0303 p\u2217+\u03b4 \u2208 E] + e\u2212c\u03b4 2n, 1 2P[G\u0303 p\u2217+\u03b4 \u2208 F] \u2264 P[G p\u2217 \u2208 F] \u2264 P[G\u0303 p\u2217\u2212\u03b4 \u2208 F] + e\u2212c\u03b4 2n .\nProof. Let A be the event that E(G p\u2217) has (p\u2217 \u00b1 \u03b4)dn/2 edges. By standard Chernoff bounds we obtain that there exists a constant c > 0 such that P(A) \u2265 1 \u2212 e\u2212c\u03b42n . Further, conditioned on |E(G p\u2217)| = pdn/2 for some p, the graph G p\u2217 has the same distribution as G\u0303 p, and therefore, using the fact that E is an increasing property, we have that P[G\u0303 p\u2217+\u03b4 \u2208 E] \u2265 P[G\u0303 p\u2217 \u2208 E | A] \u2265 P[G\u0303 p\u2217\u2212\u03b4 \u2208 E], and the inequalities are reversed for F , yielding the lemma.\nIt is a classical result [4] that for percolation on random d-regular graphs there is a phase transition at p = 1/(d\u22121)with regards to the emergence of a giant component, see also [34,36,44,45]. To prove Propositions 4.3 and 4.4, we will need to control the sizes of the components in the strictly subcritical and supercritical regimes with probability bounds that are exponentially close to 1, which makes most of these results not directly applicable.\nFor a graph G and an integer i \u2265 1, we denote by Ci (G) the i-th largest component of G (in terms of vertices); |Ci (G)| and |E(Ci (G))| denote the number of vertices and edges in Ci (G). The following proposition gives the desired bound on the component sizes in the subcritical regime.\nProposition 5.2. Let d \u2265 3 be an integer and p0 < 1/(d \u2212 1) be a positive constant. There exists constants c, M > 0 such that the following holds for all integers n. For any positive p < p0, with probability at least 1\u2212 e\u2212cn over the choice of either G \u223c G p or G \u223c G\u0303 p, it holds that\u2211i\u22651 |Ci (G)|2 \u2264 Mn.\n5 A set of multigraphs E is an increasing (resp. decreasing) property if for any G = (V, E) \u2208 E , we have that G\u2032 = (V, E \u2032) \u2208 E for all G\u2032 with E \u2032 \u2286 E (resp. E \u2286 E \u2032).\nProof. The proof is fairly standard and actually holds for percolation on an arbitrary graph of maximum degree d. We argue initially for the binomial-edge case G \u223c G p. Consider the process where we consider the vertices of G in an arbitrary order, and we explore by breadth-first-search the components of those vertices that have not been discovered so far. Suppose that we have already explored the components C1, . . . , Ck and we are exploring the component Ck+1 starting from vertex v. Since the graph has maximum degree d, the size of Ck+1 is stochastically dominated above by a branching process where the root has offspring distribution Bin(d, p0) and every other vertex has Bin(d \u2212 1, p0). Since p0 < 1/(d \u2212 1), the latter process is subcritical and therefore there exist constants c\u2032, K > 0 (depending only on d and p0) such that for all t > K , it holds that\nP [|Ck+1| > t | C1, . . . , Ck ] \u2264 e\u2212c\u2032t . (5.1) Wehave that \u2211 i\u22651 |Ci (G)|2 = \u2211 k\u22651 |Ck |2 \u2264 K 2n+ \u2211 k\u22651 |Ck |21{Ck \u2265 K }. From (5.1), we have that the sum in the last expression is stochastically dominated by the sum of n i.i.d. random variables with exponential tails, and therefore there exists constants c, M \u2032 > 0, depending only on p0, such that with probability 1 \u2212 e\u2212cn the sum is bounded by M \u2032n, yielding the result with M = M \u2032 + K 2. The exact-edge case G \u223c G\u0303 p follows by applying Lemma 5.1, noting that the graph property \u2211 i\u22651 |Ci (G)|2 \u2264 Mn is decreasing under edge-inclusion.\nThe supercritical regime is more involved since we need to account for the giant component using large deviation bounds. While there is not an off-the-self result we can use, we can adapt a technique by Krivelevich et al. [36] that was developed in a closely related setting (for high-girth expanders, refining previous results of Alon, Benjamini and Stacey [4]).\nFor d \u2265 3 and p \u2208 ( 1d\u22121 , 1), let \u03c6 = \u03c6(p) \u2208 (0, 1) be the probability that a branching process with offspring distribution Bin(d \u2212 1, p) dies out, i.e., \u03c6(p) \u2208 (0, 1) is the (unique) solution of\n\u03c6 = (p\u03c6 + 1 \u2212 p)d\u22121, and define \u03c7 = \u03c7(p), \u03c8 = \u03c8(p) from \u03c7 = 1 \u2212 (p\u03c6 + 1 \u2212 p)d , \u03c8 = 12dp(1 \u2212 \u03c62). (5.2)\nIn Appendix B, we show the following adapting the argument from [36].\nLemma 5.3. Let d \u2265 3 be an integer, p \u2208 ( 1d\u22121 , 1) be a real, and \u03c7 = \u03c7(p), \u03c8 = \u03c8(p) be as in (5.2). Then, for any \u03b4 > 0, with probability 1\u2212 e\u2212 (n) over the choice of either G \u223c G p or G \u223c G\u0303 p, it holds that\n|C1(G)| = (\u03c7 \u00b1 \u03b4)n, |E(C1(G))| = (\u03c8 \u00b1 \u03b4)n. With this and a bit of algebra, we can derive the analogue of Proposition 5.2 in the\nsupercritical regime.\nProposition 5.4. Let d \u2265 3 be an integer. Consider arbitrary p0 \u2208 ( 1d\u22121 , 1) and let \u03c70 = \u03c7(p0) be as in (5.2). Then, for all \u03b4 > 0, there exist \u03b5, c, M > 0, such that the following holds. For all sufficiently large integers n and any p = p0 \u00b1 \u03b5, with probability at least 1\u2212 e\u2212cn over the choice of either G \u223c G p or G \u223c G\u0303 p, it holds that |C1(G)| = (\u03c70 \u00b1 \u03b4)n and\u2211i\u22652 |Ci (G)|2 \u2264 Mn.\nTo prove Proposition 5.4, the following inequality between \u03c7 and \u03c8 will be useful; it will allow us to conclude that once we remove the giant component, the remaining components are in the subcritical regime.\nLemma 5.5. Let d \u2265 3 be an integer and p \u2208 ( 1d\u22121 , 1). Then, 2( 12 dp\u2212\u03c8) d(1\u2212\u03c7) < 1 d\u22121 .\nProof. Using (5.2), we have\nd(1\u2212\u03c7) d\u22121 \u2212 2( 12dp \u2212 \u03c8) = dd\u22121 (p\u03c6 + 1 \u2212 p)d \u2212 dp\u03c6(p\u03c6 + 1 \u2212 p)d\u22121 = dd\u22121 (p\u03c6 + 1 \u2212 p)d\u22121(1 \u2212 p \u2212 (d \u2212 2)p\u03c6),\nso it suffices to show that 1 \u2212 p \u2212 (d \u2212 2)p\u03c6 > 0. Let g(y) = y \u2212 (py + 1 \u2212 p)d\u22121 and note that g(\u03c6) = 0. Then, we have that g(0) < 0 and g(1) = 0. Moreover, g\u2032(y) = 1 \u2212 (d \u2212 1)p(py + 1 \u2212 p)d\u22122 and hence g\u2032(1) < 0. It follows that g(y) > 0 for y \u2191 1, and therefore there is y \u2208 (0, 1) such that g(y) = 0. Note that g is strictly concave and therefore cannot have three zeros in the interval (0, 1], so y = \u03c6, and therefore g\u2032(\u03c6) > 0. It remains to observe that g\u2032(\u03c6) = 1\u2212p\u2212(d\u22122)p\u03c6p\u03c6+1\u2212p , from where the desired inequality follows.\nProof of Proposition 5.4. Let \u03c80 = \u03c8(p0) and consider an arbitrarily small \u03b4 > 0. Since \u03c7(p) and\u03c8(p) are continuous functions of p in the interval ( 1d\u22121 , 1), we can pick \u03b5 > 0 so that, for all p = p0\u00b1\u03b5 it holds that d|p\u2212 p0|, |\u03c7(p)\u2212\u03c70|, |\u03c8(p)\u2212\u03c80| \u2264 \u03b4/10 and, by Lemma 5.5, 2( 12 dp\u2212\u03c8)+4\u03b4 d(1\u2212\u03c7)\u2212\u03b4 < 1 d\u22121 \u2212 \u03b4. Consider now an arbitrary p = p0 \u00b1 \u03b5\nand consider random G sampled from either of the distributions G p or G\u0303 p. Using the monotonicity of the events {|C1(G)| \u2265 t}, {|E(C1(G))| \u2265 t}, we obtain from Lemmas 5.1 and 5.3 (as well as a standard Chernoff bound for the number of edges in G) that there exists a constant c\u2032 > 0, depending only on d, p0, \u03b5 (but not on p), such that with probability at least 1\u2212e\u2212c\u2032n over the choice ofG it holds that |E(G)| = 12dpn\u00b1\u03b4n,|C1(G)| = (\u03c70 \u00b1 \u03b4)n, and |E(C1(G))| = (\u03c80 \u00b1 \u03b4)n. Let E denote this event.\nNote that conditioned on |C1(G)|, |E(C1(G))| and |E(G)|, the remaining components of G are distributed according to those in the exact-edge model G\u0303 p\u0303(n\u0303, d) with n\u0303 = n \u2212 |C1(G)| and p\u0303 = 2dn\u0303 (|E(G)| \u2212 |E(C1(G))|), conditioned on the event F that all components have size less than |C1(G)|. Hence, conditioned on E , we have that p\u0303 \u2264 2( 12 dpn\u2212\u03c8n)+4\u03b4n2(n\u2212\u03c7n)\u2212\u03b4n < 1d\u22121 \u2212 \u03b4 where the last inequality follows from the choice of \u03b5, i.e., G\u0303 p\u0303(n\u0303, d) is in the subcritical regime. Therefore, the probability of F is 1\u2212 e\u2212 (n) and hence the conditioning on F when considering G\u0303 p\u0303(n\u0303, d) can safely be ignored. From Proposition 5.2, we have that there exist constants M, c\u2032\u2032 > 0, depending only on d and p0, so that with probability at least 1 \u2212 e\u2212c\u2032\u2032n over the choice of G \u2032 \u223c G\u0303 p\u0303(n\u0303, d), it holds that \u2211 i\u22651 |Ci (G \u2032)|2 \u2264 Mn\u0303. Therefore, we have \u2211 i\u22652 |Ci (G)|2 \u2264 Mn.\n5.2. Percolation in the planted model. Recall the edge-empirical distributions \u03c1G,\u03c3 , \u03c1p, \u03c1f , cf. (2.4). The following lemma will allow us to deduce the regime (subcritical or supercritical) that dictates the percolation step of SWwhen we start from the paramagnetic and ferromagnetic phases.\nLemma 5.6. For \u03b2 < \u03b2h, any colour s \u2208 [q] in the paramagnetic phase satisfies (1 \u2212 e\u2212\u03b2)\u03c1p(s,s)\n\u03bdp(s) < 1d\u22121 . For \u03b2 > \u03b2u, any colour s \u2208 [q] in the ferromagnetic phase\nsatisfies (1 \u2212 e\u2212\u03b2)\u03c1f (s,s) \u03bdf (s) = (e\u03b2\u22121)\u03bcf (s) 1+(e\u03b2\u22121)\u03bcf (s) ; this is larger than 1 d\u22121 for the colour s = 1, and less than 1d\u22121 for all the other q \u2212 1 colours. Proof. For the paramagnetic phase and any colour s \u2208 [q], it follows from (2.4) that\n\u03bdp(s) = 1q , \u03c1p(s, s) = e \u03b2 qe\u03b2+(q2\u2212q) ,\nso (1 \u2212 e\u2212\u03b2)\u03c1p(s,s) \u03bdp(s) < 1d\u22121 is equivalent to (1 \u2212 e\u2212\u03b2) e \u03b2 e\u03b2+q\u22121 < 1\nd\u22121 which is true iff \u03b2 < \u03b2h , since \u03b2h = log(1 + qd\u22122 ).\nFor the ferromagnetic phase, recall from Sect. 1.3 that x = \u03bcf(1) is the largest number in the interval (1/q, 1) that satisfies\nx = (1 + (e \u03b2 \u2212 1)x)d\u22121\n(1 + (e\u03b2 \u2212 1)x)d\u22121 + (q \u2212 1)(1 + (e\u03b2 \u2212 1) 1\u2212xq\u22121 )d\u22121 . (5.3)\nLet t = 1+(e\u03b2\u22121)x 1+(e\u03b2\u22121) 1\u2212xq\u22121 and note that t > 1 since x > 1/q and \u03b2 > 0. Moreover, (5.3) can be written as x = td\u22121 td\u22121+(q\u22121) , and hence t\nd\u22121 = (q\u22121)x1\u2212x . Then, it follows from (2.4) that for colour s = 1 we have\n\u03bdf(1) = t d td + (q \u2212 1) = t x t x + 1 \u2212 x , \u03c1f(1, 1) = e\u03b2x2\n1 + (e\u03b2 \u2212 1)(x2 + (1\u2212x)2q\u22121 )\n= e \u03b2 t x2\n(t x + 1 \u2212 x)(1 + (e\u03b2 \u2212 1)x) , (5.4)\nwhereas for colours s = 1 we have\n\u03bdf(s) = 1 td + (q \u2212 1) =\n1\u2212x q\u22121 t x + 1 \u2212 x , \u03c1f(s, s) = e\u03b2 ( 1\u2212x q\u22121 )2\n1 + (e\u03b2 \u2212 1)(x2 + (1\u2212x)2q\u22121 )\n= e \u03b2 t ( 1\u2212x q\u22121 )2\n(t x + 1 \u2212 x)(1 + (e\u03b2 \u2212 1)x) .\nUsing these expressions, it is amatter of fewmanipulations to verify that (1\u2212e\u2212\u03b2)\u03c1f (s,s) \u03bdf (s) = (e\u03b2\u22121)\u03bcf (s)\n1+(e\u03b2\u22121)\u03bcf (s) for all colours s \u2208 [q]. Using this, for s = 1, we have that the inequality (1\u2212e\u2212\u03b2)\u03c1f (1,1)\n\u03bdf (1) > 1d\u22121 is equivalent\nto (e\u03b2 \u2212 1)x > 1d\u22122 . Plugging x = t d\u22121 td\u22121+(q\u22121) into t = 1+(e \u03b2\u22121)x\n1+(e\u03b2\u22121) 1\u2212xq\u22121 and solving for\n(e\u03b2 \u22121) yields that e\u03b2 \u22121 = (t\u22121)(td\u22121+q\u22121) td\u22121\u2212t . Therefore the desired inequality becomes\n(t \u2212 1)td\u22121 td\u22121 \u2212 t > 1 d\u22122 , or equivalently (d \u2212 2)td\u22121 \u2212 (d \u2212 1)td\u22122 + 1 > 0,\nwhich is true for any t > 1. For a colour s = 1, the inequality (1\u2212e\u2212\u03b2)\u03c1f (s,s) \u03bdf (s) < 1d\u22121 can be proved analogously. We have in particular the equivalent inequality (e\u03b2 \u2212 1) 1\u2212xq\u22121 < 1\nd\u22122 , which further reduces to t\u22121 td\u22121\u2212t < 1 d\u22122 ; the latter again holds for any t > 1."
        },
        {
            "heading": "5.3. Tracking one step of SW\u2014Proof of Propositions 4.3 and 4.4.",
            "text": "Proposition 4.3. Let q, d \u2265 3 be integers and \u03b2 \u2208 (\u03b2u, \u03b2h) be real. Then, for all sufficiently small constants \u03b5\u2032 > \u03b5 > 0, there exists constant \u03b7 > 0 such that with probability 1\u2212e\u2212\u03b7n over the planted distribution (G, \u03c3 ) \u223c (G\u0302(\u03c3\u0302 p(\u03b5) ) , \u03c3\u0302 p(\u03b5) ) , it holds that PGSW ( \u03c3 \u2192 Sp(\u03b5\u2032)\n) \u2265 1 \u2212 e\u2212\u03b7n. Proof. Let \u03b5 > 0 be a sufficiently small constant so that by Lemma 3.4, for any constant \u03b4 > 0, with probability 1\u2212 e\u2212 (n) over the choice of (G, \u03c3 ) \u223c (G\u0302(\u03c3\u0302 p(\u03b5)), \u03c3\u0302 p(\u03b5) ) , we have \u2225 \u2225\u03bd\u03c3 \u2212 \u03bdp \u2225 \u2225 \u2264 \u03b4 and \u2225 \u2225 \u2225\u03c1G,\u03c3 \u2212 \u03c1p \u2225 \u2225 \u2225 \u2264 \u03b4. (5.5)\nLet \u03b5\u2032 be an arbitrary constant such that \u03b5\u2032 > \u03b5. We will show that there exists a constant \u03b7 > 0 such that for arbitrary \u03bd and\u03c1 \u2208 R(\u03bd) satisfying\u2225\u2225\u03bd \u2212 \u03bdp \u2225 \u2225 \u2264 \u03b4 and\u2225\u2225\u03c1 \u2212 \u03c1p \u2225 \u2225 \u2264 \u03b4, for (G, \u03c3 ) \u223c (G\u0302(\u03c3\u0302 p(\u03b5)), \u03c3\u0302 p(\u03b5) ) , it holds that\nP [ PGSW ( \u03c3 \u2192 Sp(\u03b5\u2032) ) \u2265 1 \u2212 e\u2212\u03b7n \u2223\u2223 \u03bd\u03c3 = \u03bd, \u03c1G,\u03c3 = \u03c1 ]\n\u2265 1 \u2212 e\u2212\u03b7n (5.6) and therefore the conclusion follows by aggregating over \u03bd and \u03c1, using the law of total probability and the probability bound for (5.5).\nChoose (G, \u03c3 ) \u223c (G\u0302(\u03c3\u0302 p(\u03b5)), \u03c3\u0302 p(\u03b5) ) conditioned on \u03bd\u03c3 = \u03bd and \u03c1G,\u03c3 = \u03c1. Observe\nthat G\u0302(\u03c3 ) is a uniformly randomgraph conditioned on the sizes of the vertex/edge classes prescribed by \u03bd, \u03c1. For i \u2265 1, let Ci (G\u03c3,SW ) be the components of G (in decreasing order of size) starting from the configuration \u03c3 after the percolation step of the SW dynamics with parameter p = 1\u2212 e\u2212\u03b2 , when starting from the configuration \u03c3 . We will show that there exists a constant M > 0 such that\nP\n[\u2211\ni\u22651 |Ci (G\u03c3,SW )|2 \u2264 Mn\n\u2223 \u2223 \u2223 \u03bd\u03c3 = \u03bd, \u03c1G,\u03c3 = \u03c1\n]\n\u2265 1 \u2212 e\u2212 (n). (5.7)\nAssuming this for the moment, for a colour s \u2208 [q], let Ns be the number of vertices with colour s \u2208 [q] after the recoloring step of SW. Note that the expectation of Ns is n/q, and whenever the event in (5.7) holds, by Azuma\u2019s inequality we obtain that 1n Ns is within an additive \u03b5\u2032 from its expectation with probability 1 \u2212 e\u2212 (n). By a union bound over the q colours, we obtain (5.6).\nFor a colour s \u2208 [q], let G(\u03c3\u22121(s)) be the induced graph on \u03c3\u22121(s), and note that since G is uniformly random conditioned on \u03bd and \u03c1, G(\u03c3\u22121(s)) has the same distribution as the exact-edge model H(s) \u223c G\u0303r\u0303(s)(n\u0303(s), d) where n\u0303(s) = n\u03bd(s) and r\u0303(s) = \u03c1(s,s)\n\u03bd(s) . Percolation on this graph with parameter p is therefore closely related to the binomial-edge model Gr(s)(n\u0303(s), d) with r(s) = pr\u0303(s). More precisely, note that for all sufficiently small \u03b4 > 0, Lemma 5.6 guarantees that the percolation parameter r(s) is bounded by a constant strictly less than 1/(d\u22121), so by Theorem 5.2 there exists a constant M > 0 such that\nP\n[\u2211\ni\u22651 |Ci (Gr(s))|2 \u2264 Mn\u0303(s)\n] \u2265 1 \u2212 e\u2212 (r\u0303n(s)) \u2265 1 \u2212 e\u2212 (n). (5.8)\nNote that, for any p \u2208 (0, 1), the property {G : P[\u2211i\u22651 |Ci (Gp)|2 \u2264 Mn ] \u2265 1 \u2212 e\u2212 (n) } is a decreasing graph property, i.e., if G is a subgraph of G \u2032, we can couple the random graphs Gp and G \u2032p so that \u2211 i\u22651 |Ci (Gp)|2 \u2264 \u2211\ni\u22651 |Ci (G \u2032p)|2. Viewing the event in (5.8) as a property of the binomial-edge model Gr\u0303(s)(n\u0303(s), d), it follows from Lemma 5.1 that with probability 1 \u2212 e\u2212 (n) over the choice of the exact-edge model H(s) \u223c G\u0303r\u0303(s)(n\u0303(s), d) it holds that\nP\n[\u2211\ni\u22651 |Ci (Hp(s))|2] \u2264 Mn\u0303(s)\n] \u2265 1 \u2212 e\u2212 (n).\nApplying this for colours s = 1, . . . , q and H(s) = G(\u03c3\u22121(s)), we obtain by the union bound that with probability 1\u2212 e\u2212 (n) over the choice of (G, \u03c3 ) \u223c (G\u0302(\u03c3\u0302 p(\u03b5)), \u03c3\u0302 p(\u03b5) ) conditioned on \u03bd\u03c3 = \u03bd and \u03c1G,\u03c3 = \u03c1, the components of G after the percolation step of SW satisfy (5.7), as claimed, therefore finishing the proof.\nProposition 4.4. Let q, d \u2265 3 be integers and \u03b2 \u2208 (\u03b2u, \u03b2h) be real. Then, for all sufficiently small constants \u03b5\u2032 > \u03b5 > 0, there exists constant \u03b7 > 0 such that with probability 1\u2212e\u2212\u03b7n over the planted distribution (G, \u03c3 ) \u223c (G\u0302(\u03c3\u0302 p(\u03b5) ) , \u03c3\u0302 p(\u03b5) ) , it holds that PGSW ( \u03c3 \u2192 Sp(\u03b5\u2032)\n) \u2265 1 \u2212 e\u2212\u03b7n. Proof of Proposition 4.4. The first part of the proof is analogous to that of Theorem 4.3. Let \u03b5 > 0 be a sufficiently small constant, so that by Lemma 3.5, for any constant \u03b4 > 0, with probability 1 \u2212 e\u2212 (n) over the choice of (G, \u03c3 ) \u223c (G\u0302(\u03c3\u0302 f(\u03b5)), \u03c3\u0302 f(\u03b5) ) , we have\n\u2225 \u2225\u03bd\u03c3 \u2212 \u03bdf \u2225 \u2225 \u2264 \u03b4 and \u2225 \u2225 \u2225\u03c1G,\u03c3 \u2212 \u03c1f \u2225 \u2225 \u2225 \u2264 \u03b4. (5.9)\nWe will show that there exists a constant \u03b7 > 0 such for arbitrary \u03bd and \u03c1 \u2208 R(\u03bd) satisfying \u2016\u03bd \u2212 \u03bdf\u2016 \u2264 \u03b4 and \u2016\u03c1 \u2212 \u03c1f\u2016 \u2264 \u03b4, for (G, \u03c3 ) \u223c ( G\u0302(\u03c3\u0302 f(\u03b5)), \u03c3\u0302 f(\u03b5) ) it holds that\nP [ PGSW ( \u03c3 \u2192 S\u0303f(\u03b5\u2032) ) \u2265 1 \u2212 e\u2212\u03b7n \u2223\u2223 \u03bd\u03c3 = \u03bd, \u03c1G,\u03c3 = \u03c1 ]\n\u2265 1 \u2212 e\u2212\u03b7n (5.10) and therefore the conclusion follows by aggregating over \u03bd and \u03c1.\nChoose (G, \u03c3 ) \u223c (G\u0302(\u03c3\u0302 f(\u03b5)), \u03c3\u0302 f(\u03b5) ) conditioned on \u03bd\u03c3 = \u03bd and \u03c1G,\u03c3 = \u03c1, and observe once again that G\u0302(\u03c3 ) is uniformly random conditioned on \u03bd, \u03c1. For i \u2265 1, let Ci (G\u03c3,SW ) be the components of G (in decreasing order of size) starting from the configuration \u03c3 after the percolation step of the SW dynamics with parameter p = 1 \u2212 e\u2212\u03b2 , when starting from the configuration \u03c3 . We will show that there exists a constant M > 0 such that\nP [ C1(G\u03c3,SW ) = n ( 1 \u2212 q(1\u2212\u03bdf (1))q\u22121 )\u00b1 \u2032n, \u2211\ni\u22652 |Ci (G\u03c3,SW )|2\n\u2264 Mn \u2223 \u2223 \u2223 \u03bd\u03c3 = \u03bd, \u03c1G,\u03c3 = \u03c1 ] \u2265 1 \u2212 e\u2212 (n). (5.11)\nWe first complete the proof of the theorem assuming this for the moment, and return to the proof of (5.11) later. In particular, assume w.l.o.g. that C1(G\u03c3,SW ) gets colour\n1. For a colour s \u2208 [q], let Ns be the number of vertices outside C1(G\u03c3,SW ) that get colour s \u2208 [q] after the recoloring step of SW.Note that in the final configuration after the recolouring step, the number of verticeswith colour s \u2208 [q] is Ns+1{s = 1}|C1(G\u03c3,SW )|. Now, the expectation of Ns is n\u2212|C1(G\u03c3,SW )| q , and whenever the event in (5.7) holds, by Azuma\u2019s inequality we obtain that 1n Ns is within an additive \u03b5 \u2032 from its expectation with probability 1 \u2212 e\u2212 (n). Therefore, by a union bound over the q colours, the Potts configuration obtained after one step of SWbelongs to S\u0303f (\u03b5\u2032)with probability 1\u2212e\u2212 (n), which establishes the claim in (5.10).\nIt remains to prove (5.11). As in the proof of Proposition 4.3, for a colour s \u2208 [q], let G(\u03c3\u22121(s)) be the induced graph on \u03c3\u22121(s), and note that G(\u03c3\u22121(s)) has the same distribution as the exact-edge model H(s) \u223c G\u0303r\u0303(s)(n\u0303(s), d) where n\u0303(s) = n\u03bd(s) and r\u0303(s) = \u03c1(s,s)\n\u03bd(s) . By considering again the binomial-edgemodel Gr(s)(n\u0303(s), d)with r(s) = pr\u0303(s), and using the inequalities in Lemma 5.6 for the ferromagnetic phase, we obtain that for all colours s = 1 the parameter r(s) is bounded by a constant strictly less than 1d\u22121 and hence the model is in the subcritical regime. In fact, by the same line of arguments as in Theorem 4.3, we therefore have that there exists a constant M0 > 0 (depending only on d, \u03b2 but not on \u03bd or\u03c1) such that, for all colours s = 1with probability 1 \u2212 e\u2212 (n) over the choice of H(s) \u223c G\u0303r\u0303(s)(n\u0303(s), d), it holds that\nP\n[\u2211\ni\u22651 |Ci (Hp(s))|2 \u2264 M0n\u0303(s)\n] \u2265 1 \u2212 e\u2212 (n) (5.12)\nBy contrast, for s = 1, the binomial-edge model Gr(s)(n\u0303(s), d) is in the supercritical regime since r(s) = rf \u00b1 \u03b5 where rf = (1 \u2212 e\u2212\u03b2)\u03c1f (1,1)\u03bdf (1) = (e\u03b2\u22121)\u03bcf (1) 1+(e\u03b2\u22121)\u03bcf (1) is a constant larger than 1d\u22121 (by Lemma 5.6). Let \u03c7f = \u03c7(rf) be as in (5.2), so by Proposition 5.4 there exists a constant M1 > 0 such that\nP [\u2223 \u2223C1(Gr(s)) \u2223 \u2223 = n\u0303(s)(\u03c7f \u00b1 \u20322 ) ] , P\n[\u2211\ni\u22652 |Ci (Gr(s))|2 \u2264 M1n\u0303(1)\n]\n\u2265 1 \u2212 e\u2212 (n). (5.13)\nWe will shortly show that\n1 \u2212 q(1 \u2212 \u03bdf(1)) q \u2212 1 = \u03c7f\u03bdf(1) or equivalently \u03c7f = q\u03bdf(1) \u2212 1 (q \u2212 1)\u03bdf(1) . (5.14)\nAssuming this for now, note that since |C1(G)| and P [\u2211 i\u22652 |Ci (Gp)|2 ] are monotone under edge-inclusion, we can again use Lemma 5.1 to go back to the percolation model for the colour s = 1. So, we conclude that with probability 1 \u2212 e\u2212 (n) over the choice of H(s) \u223c G\u0303r\u0303(s)(n\u0303(s), d), it holds that\nP [ \u2223 \u2223C1(Hp(s)) \u2223 \u2223 = n\u0303(s)(\u03c7f \u00b1 \u2032), \u2211\ni\u22651 |Ci (Hp(s))|2 \u2264 M1n\u0303(s)\n]\n\u2265 1 \u2212 e\u2212 (n).\nCombining (5.12) and (5.13) with a union bound over the q colours, we obtain (5.11) with M = maxM0, M1.\nIt only remains to prove (5.14). Recall from (5.4) that \u03bdf(1) = tdtd+(q\u22121) where t = 1+(e\u03b2\u22121)x\n1+(e\u03b2\u22121) 1\u2212xq\u22121 and x = \u03bcf(1). So, \u03c7f = q\u03bdf (1)\u22121(q\u22121)\u03bdf (1) is equivalent to showing that\n\u03c7f = 1 \u2212 (1/t)d . (5.15)\nNow, recall from (5.2) that \u03c7f = 1 \u2212 ( 1 \u2212 rf + rf\u03c6f )d , where \u03c6f = \u03c6(rf). So (5.15) reduces to showing that\n1/t = 1 \u2212 rf + rf\u03c6f ,which using t = 1+(e\u03b2\u22121)x 1+(e\u03b2\u22121) 1\u2212xq\u22121\nand rf = (e\u03b2\u22121)x1+(e\u03b2\u22121)x is equivalent to \u03c6f = 1\u2212x(q\u22121)x . (5.16)\nFrom (5.2), y = \u03c6f is the unique solution in (0, 1) of the equation\ny = (1 \u2212 rf + rf y )d\u22121 , (5.17)\nand note that 1\u2212x (q\u22121)x \u2208 (0, 1) since x > 1/q. So, to prove the equality \u03c6f = 1\u2212x(q\u22121)x in (5.16), it suffices to show that setting y = 1\u2212x (q\u22121)x satisfies (5.17). This follows from the fact that x = \u03bcf(1) satisfies the Belief propagation equations; in particular, from (5.3) we have\nx = (1 + (e \u03b2 \u2212 1)x)d\u22121\n(1 + (e\u03b2 \u2212 1)x)d\u22121 + (q \u2212 1)(1 + (e\u03b2 \u2212 1) 1\u2212xq\u22121 )d\u22121 ,\nfrom which it follows that y = 1\u2212x (q\u22121)x =\n( 1+(e\u03b2\u22121)x)\n1+(e\u03b2\u22121) 1\u2212xq\u22121\n)d\u22121 = (1 \u2212 rf + rf y )d\u22121. This\nfinishes the proof of (5.14) and therefore the proof of Proposition 4.4.\nFunding A. Coja-Oghlan supported by DFG CO 646/3 and 646/4. J.B. Ravelomanana supported by DFG CO 646/4. D. \u0160tefankovic\u030c supported by NSF CCF-2007287. E. Vigoda supported by NSF CCF-2007022.\nDeclarations\nConflict of interest The authors have no competing interests to declare that are relevant to the content of this article.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/.\nPublisher\u2019s Note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations."
        },
        {
            "heading": "A. Proof of Lemma 4.2",
            "text": "Lemma 4.2. Let G = (V, E) be a graph. For any S \u2286 [q]V such that \u03bcG(S) > 0 and any integer t \u2265 0 we have \u2225\u2225\u03bcG,S Pt \u2212 \u03bcG,S \u2225 \u2225 T V \u2264 t (S).\nProof. We adapt the argument from [38, proof of Theorem 7.3]. For \u03c3, \u03c4 \u2208 [q]V and A, B \u2286 [q]V let\nQ(\u03c3, \u03c4 ) = \u03bcG(\u03c3 )P(\u03c3, \u03c4 ) and Q(A, B) = \u2211\n\u03c3\u2208A,\u03c4\u2208B Q(\u03c3, \u03c4 ).\nMoreover, for a set S \u2286 [q]V , let \u03bcG,\u03b2,S = \u03bcG,\u03b2 (\u00b7|S). We have\n\u03bcG(S) \u2225 \u2225\u03bcG,\u03b2,S P \u2212 \u03bcG,\u03b2,S \u2225 \u2225 T V = \u03bcG(S)\n\u2211\n\u03c3\u2208[q]Vn \u03bcG,\u03b2,S P(\u03c3 )\u2265\u03bcG,\u03b2,S(\u03c3 )\n( \u03bcG,\u03b2,S P(\u03c3 ) \u2212 \u03bcG,\u03b2,S(\u03c3 ) ) .\n(A.1) Now, by definition, \u03bcG,\u03b2,S(\u03c4 ) = \u03bcG ({\u03c4 } \u2229 S)/\u03bcG (S) so \u03bcG,\u03b2,S(\u03c4 ) = 0 if \u03c4 /\u2208 S and \u03bcG,\u03b2,S(\u03c4 ) = \u03bcG(\u03c4 )/\u03bcG (S) otherwise. Hence,\n\u03bcG(S)\u03bcG,\u03b2,S P(\u03c3 ) = \u2211\n\u03c4\u2208[q]V \u03bcG(S)\u03bcG,\u03b2,S(\u03c4 )P(\u03c4, \u03c3 )\n= \u2211\n\u03c4\u2208S \u03bcG(\u03c4 )P(\u03c4, \u03c3 ) \u2264\n\u2211\n\u03c4\u2208[q]V \u03bcG(\u03c4 )P(\u03c4, \u03c3 ) = \u03bcG(\u03c3 ) (A.2)\nwhere the last equality in (A.2) holds because \u03bcG is the stationary distribution. Next, dividing (A.2) through by \u03bcG(S) and using the fact that \u03bcG,\u03b2,S(\u03c4 ) = \u03bcG(\u03c4 )/\u03bcG (S) for \u03c4 \u2208 S, we have \u03bcG,\u03b2,S P(\u03c4 ) \u2264 \u03bcG,\u03b2,S(\u03c4 ) for \u03c4 \u2208 S. (A.3) Furthermore, since \u03bcG,\u03b2,S(\u03c4 ) = 0 for \u03c4 \u2208 Sc,\n\u03bcG,\u03b2,S P(\u03c4 ) \u2265 \u03bcG,\u03b2,S(\u03c4 ) = 0 for \u03c4 \u2208 Sc. (A.4) Combining (A.3), (A.4) and again the fact that \u03bcG,\u03b2,S(\u03c3 ) = 0 for \u03c3 \u2208 Sc we see that Equation (A.1) becomes\n\u03bcG(S) \u2225 \u2225\u03bcG,\u03b2,S P \u2212 \u03bcG,\u03b2,S \u2225 \u2225 T V = \u2211\n\u03c3\u2208Sc \u03bcG(S)\u03bcG,\u03b2,S P(\u03c3 ). (A.5)\nOnce more, since \u03bcG,\u03b2,S(\u03c4 ) = 0 if \u03c4 \u2208 Sc and \u03bcG,\u03b2,S(\u03c4 ) = \u03bcG(\u03c4 )/\u03bcG(S) if \u03c4 \u2208 S we have\n\u2211 \u03c3\u2208Sc \u03bcG(S)\u03bcG,\u03b2,S P(\u03c3 ) = \u2211 \u03c3\u2208Sc \u2211 \u03c4\u2208S \u03bcG(S)\u03bcG,\u03b2,S(\u03c4 )P(\u03c4, \u03c3 )\n= \u2211 \u03c3\u2208Sc \u2211 \u03c4\u2208S \u03bcG(\u03c4 )P(\u03c4, \u03c3 ) = Q(S, Sc) (A.6)\nCombining (A.5) and (A.6), we obtain\n\u03bcG(S) \u2225 \u2225\u03bcG,\u03b2,S P \u2212 \u03bcG,\u03b2,S \u2225 \u2225 T V = Q(S, Sc), and hence \u2225 \u2225\u03bcG,\u03b2,S P \u2212 \u03bcG,\u03b2,S \u2225 \u2225 T V = (S, Sc).\nIn addition, for any u \u2265 0, it is easy to see that we have \u2225 \u2225 \u2225\u03bcG,\u03b2,S P\nu+1 \u2212 \u03bcG,\u03b2,S Pu \u2225 \u2225 \u2225 T V \u2264 \u2225\u2225\u03bcG,\u03b2,S P \u2212 \u03bcG,\u03b2,S \u2225 \u2225 T V = (S, Sc).\nTherefore, the result follows using the triangle inequality on the telescoping sum\n\u03bcG,\u03b2,S P t \u2212 \u03bcG,\u03b2,S =\nt\u22121\u2211 u=0 \u03bcG,\u03b2,S P u+1 \u2212 \u03bcG,\u03b2,S Pu ."
        },
        {
            "heading": "B. Proof of Lemma 5.3",
            "text": "The proof follows closely the approach in [36] that was carried out for high-girth expanders. While the random regular graph is an expander itself, it contains a few small cycles and we only need to adapt the argument in order to account for their presence.\nLemma 5.3. Let d \u2265 3 be an integer, p \u2208 ( 1d\u22121 , 1) be a real, and \u03c7 = \u03c7(p), \u03c8 = \u03c8(p) be as in (5.2). Then, for any \u03b4 > 0, with probability 1\u2212 e\u2212 (n) over the choice of either G \u223c G p or G \u223c G\u0303 p, it holds that\n|C1(G)| = (\u03c7 \u00b1 \u03b4)n, |E(C1(G))| = (\u03c8 \u00b1 \u03b4)n. Proof. Let \u03b4 > 0 be an arbitrarily small constant, and set \u03b7 = \u03b4/(100dp). It suffices to prove the result for the binomial-edge model G p, the result for the exact-edge model G\u0303 p follows from Lemma 5.1 since |C1(G)| and |E(C1(G))| are monotone under edgeinclusion. Let \u03b5 \u2208 (0, p) be an arbitrarily small constant to be chosen later, and let p\u0302 := p\u2212\u03b51\u2212\u03b5 ; note that \u03b5 = p\u2212 p\u03021\u2212 p\u0302 . We can think of the construction of G p into the following steps: (i) sample a random d-regular graph G = (V, E) \u223c G from the pairing model, (ii) keep each of the edges in E independently with probability p\u0302, to obtain the edge set E\u0302 , (iii) keep each of the edges in E independently with probability \u03b5 > 0, to obtain the edge set E\u03b5, (iv) the final graph has vertex set V and edge set E\u0302 \u222a E\u03b5. For a large integer R > 0 to be chosen later, let\u03c6R be the probability that a branching process with offspring distribution Bin(d \u2212 1, p\u0302) has died out after R generations, and let \u03c7R = 1\u2212 (1\u2212 p\u0302+ p\u0302\u03c6R)d ,\u03c8R = 12d p\u0302 ( 1\u2212\u03c62R ) . Then, by choosing \u03b5 > 0 sufficiently small, for all sufficiently large R we have that |\u03c7R \u2212 \u03c7 | \u2264 \u03b7, |\u03c8R \u2212 \u03c8 | \u2264 \u03b7. It is a well-known fact that the random regular graph G = (V, E) \u223c G, i.e.,\nthe graph after step (i), is an expander and the local neighbourhoods of all but a small fraction of the vertices are trees. More precisely, there is a constant \u03b6 > 0 such that for any integer R > 0 the following hold with probability 1 \u2212 e\u2212 (n): (1) the (2R)-neighbourhoods of all but \u03b7n vertices will be isomorphic to the (2R)-\nneighbourhood of the root of a d-regular tree. Let Z = Z(R) denote the set of these vertices, and ZE = ZE (R) be the set of edges whose both endpoints are in Z ; we have |Z | = (1 \u00b1 \u03b7)n and |ZE | = (1 \u00b1 2\u03b7) d2 n (since we lose at most d edges for every vertex in V \\Z ). (2) every set S \u2286 V with \u03b7n \u2264 |S| \u2264 n/2 has at least \u03b6 |S| edges with exactly one endpoint in S.\nItem (1) follows by the Azuma-Hoeffding inequality (since for any R > 0, E[n \u2212 Z ] = O(1) and adding or removing a single edge of G can change the (2R)-neighbourhoods of atmost dR vertices), whereas Item (2) follows from a standard union-bound argument. For the rest of the proof, fix G to be any d-regular graph satisfying Items (1) and (2). Consider the graph after the percolation step (ii), i.e., the graph (V, E\u0302). For v \u2208 Z , let 1v be the indicator that there is a neighbour u \u2208 \u2202v such that vu \u2208 E\u0302 and u has a simple path of length R that starts from it and does not include v; if 1v = 1, we will say that v belongs to a large component. Since v \u2208 Z , it has d-neighbours whose R-neighbourhoods look like trees, so E[1v] = 1 \u2212 (1 \u2212 p\u0302 + p\u0302\u03c6R)d = \u03c7R . For an edge e \u2208 ZE , let 1e be the indicator that e \u2208 E\u0302 and that there is a simple path of length R starting from either of the endpoints of e which does not include e. Since e \u2208 ZE , we have E[1e] = p\u0302(1 \u2212 \u03c62R). If 1e = 1, we will say that e belongs to a large component. By Azuma\u2019s inequality, the random variables X = \u2211v\u2208Z 1v and Y = \u2211e\u2208ZE 1e are within \u03b7n from their expectation with probability 1 \u2212 e\u2212 (n). We have E[X ] = (1 \u00b1 \u03b7)n\u03c7R = (\u03c7 \u00b1 2\u03b7)n and E[Y ] = (1 \u00b1 2\u03b7)n\u03c8R = (\u03c8 \u00b1 3\u03b7)n. Therefore, after percolation step (ii), with probability 1 \u2212 e\u2212 (n), we have a set VL of vertices from Z and a set EL of edges from ZE which belong to large components, with |VL | = X = (\u03c7 \u00b1 4\u03b7)n and |EL | = Y = (\u03c8 \u00b1 4\u03b7)n. We also conclude that there are at most n/R components with size \u2265 R, which we denote by C1, . . . , Ck for some k \u2264 n/R.\nNow consider the graph after the percolation step (iii), i.e., the graph (V, E\u03b5). We claim that with probability 1 \u2212 e\u2212 (n), every partition of C1, . . . , Ck into two parts A, B with |A|, |B| \u2265 \u03b7n has a path joining them. Indeed, by Menger\u2019s theorem and the expansion property in Item (2), for any disjoint vertex sets A, B with |A|, |B| \u2265 \u03b7n, there are at least \u03b6\u03b7n edge-disjoint paths from A to B. Of these paths, at least half of them have at most d\n\u03b6\u03b7 edges (otherwise |E\u03b5| > 12dn), so the probability that none of\nthem is present after the percolation step is at most (1 \u2212 \u03b5d/(\u03b6\u03b7))\u03b6\u03b7n/2. Since k \u2264 n/R, there are at most 22n/R ways to partition C1, . . . , Ck into A, B, so by a union bound the probability that a partition exists is upper bounded by 22n/R(1\u2212 \u03b5d/(\u03b6\u03b7))\u03b6\u03b7n/2 \u2264 e\u2212 (n) by choosing R large with respect to \u03b5, \u03b7, \u03b6 . It follows from the above that the final graph (V, E\u0302 \u222a E\u03b5) contains a connected component C with at least (\u03c7 \u2212 6\u03b7)n vertices from Z ; otherwise, for the first i such that |C1 \u222a \u00b7 \u00b7 \u00b7 Ci | \u2265 \u03b7n, we must have |C1 \u222a \u00b7 \u00b7 \u00b7 Ci | \u2264 (\u03c7 \u2212 5\u03b7)n, and from |C1 \u222a \u00b7 \u00b7 \u00b7 Ck | \u2265 (\u03c7 \u2212 4\u03b7)n, we obtain two disconnected parts A, B with |A|, |B| \u2265 \u03b7n. This component C must contain at least Y \u2212 10d\u03b7n \u2265 (\u03c8 \u2212 14d\u03b7)n edges since we lose at most d edges per vertex of VL\\C. Note that the vertices in V (C) \u2229 Z belong to VL and therefore |V (C) \u2229 Z | \u2264 |VL | \u2264 (\u03c7 + 4\u03b7)n. There can be at most \u03b7n vertices in V (C)\\Z (by Item (1)). Therefore |C| = (\u03c7 \u00b1 6\u03b7)n. Similarly, the edges in E(C) \u2229 ZE belong to EL and analogously to above we obtain that |E(C)| = (\u03c8 \u00b1 14d\u03b7)n. It only remains to show that C is the largest component with probability 1\u2212 e (n). For large K , an Azuma-Hoeffding bound shows that the number of vertices that belong to components of size \u2264 K in the graph (V, E\u0302 \u222a E\u03b5) is at least (1 \u2212 \u03c7 \u2212 4\u03b7)n with probability 1 \u2212 e\u2212 (n). Therefore, via a union bound, we obtain that every component in (V, E\u0302 \u222a E\u03b5) other than C has at most 20\u03b7n vertices with probability 1 \u2212 e (n), and therefore is smaller than C.\nThis finishes the proof of Lemma 5.3."
        }
    ],
    "title": "Metastability of the Potts Ferromagnet on Random Regular Graphs",
    "year": 2023
}