{
    "abstractText": "In this paper, we consider a downlink (DL) massive multiple-input multiple-output (MIMO) system, where different users have different mobility profiles. To support this system, we propose to use a hybrid orthogonal time frequency space (OTFS)/orthogonal frequency division multiplexing (OFDM) modulation scheme, where OTFS is applied for high-mobility users and OFDM is used for low-mobility users. Two precoding designs, namely full zero-forcing (FZF) precoding and partial zero-forcing (PZF) precoding, are considered and analyzed in terms of per-user spectral efficiency (SE). With FZF, interference among users is totally eliminated at the cost of high computational complexity, while PZF can be used to provide a trade-off between complexity and performance. To apply PZF precoding, users are grouped into two disjoint groups according to their mobility profile or channel gain. Then, zero-forcing (ZF) is utilized for high-mobility or strong channel gain users to completely cancel the inter-group interference, while maximum ratio transmission (MRT) is applied for low-mobility users or users with weak channel gain. To shed light on the system performance, the SE for high-mobility and low-mobility users with a minimum-meansquare-error (MMSE)-successive interference cancellation (SIC) detector is investigated. Our numerical results reveal that the PZF precoding with channel gain grouping can guarantee a similar quality of service for all users. In addition, with mobility-based grouping, the hybrid OTFS/OFDM modulation outperforms the conventional OFDM modulation for high-mobility users.",
    "authors": [
        {
            "affiliations": [],
            "name": "Ruoxi Chong"
        },
        {
            "affiliations": [],
            "name": "Mohammadali Mohammadi"
        },
        {
            "affiliations": [],
            "name": "Hien Quoc Ngo"
        },
        {
            "affiliations": [],
            "name": "Simon L. Cotton"
        },
        {
            "affiliations": [],
            "name": "Michail Matthaiou"
        }
    ],
    "id": "SP:c2c189278ad0cf91e69f3d81de900c86fe9e42c6",
    "references": [
        {
            "authors": [
                "Z. Wei",
                "W. Yuan",
                "S. Li",
                "J. Yuan",
                "G. Bharatula",
                "R. Hadani",
                "L. Hanzo"
            ],
            "title": "Orthogonal time-frequency space modulation: A promising next-generation waveform",
            "venue": "IEEE Wireless Commun., vol. 28, no. 4, pp. 136\u2013144, Aug. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "S. Li",
                "J. Yuan",
                "Z. Wei",
                "B. Bai",
                "D.W.K. Ng"
            ],
            "title": "Performance analysis of coded OTFS systems over high-mobility channels",
            "venue": "IEEE Trans. Wireless Commun., vol. 20, no. 9, pp. 6033\u20136048, Sept. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "R. Chong",
                "S. Li",
                "J. Yuan",
                "D.W.K. Ng"
            ],
            "title": "Achievable rate upperbounds of uplink multiuser OTFS transmissions",
            "venue": "IEEE Wireless Commun. Lett., vol. 11, no. 4, pp. 791\u2013795, Jan. 2022.",
            "year": 2022
        },
        {
            "authors": [
                "R. Chong",
                "S. Li",
                "W. Yuan",
                "J. Yuan"
            ],
            "title": "Outage analysis for OTFS-based single user and multi-user transmissions",
            "venue": "Proc. IEEE ICC, Jul. 2022, pp. 746\u2013751.",
            "year": 2022
        },
        {
            "authors": [
                "R. Hadani"
            ],
            "title": "Orthogonal time frequency space modulation",
            "venue": "Proc. IEEE WCNC, Mar. 2017, pp. 1\u20136.",
            "year": 2017
        },
        {
            "authors": [
                "S. Li",
                "W. Yuan",
                "Z. Wei",
                "R. Schober",
                "G. Caire"
            ],
            "title": "Orthogonal time frequency space modulation\u2014Part II: Transceiver designs",
            "venue": "IEEE Commun. Lett., vol. 27, no. 1, pp. 9\u201313, 2023.",
            "year": 2023
        },
        {
            "authors": [
                "P. Raviteja",
                "K.T. Phan",
                "Y. Hong",
                "E. Viterbo"
            ],
            "title": "Interference cancellation and iterative detection for orthogonal time frequency space modulation",
            "venue": "IEEE Trans. Wireless Commun., vol. 17, no. 10, pp. 6501\u2013 6515, Oct. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "Z. Ding",
                "R. Schober",
                "P. Fan",
                "H.V. Poor"
            ],
            "title": "OTFS-NOMA: An efficient approach for exploiting heterogenous user mobility profiles",
            "venue": "IEEE Trans. Commun., vol. 67, no. 11, pp. 7950\u20137965, Nov. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "R. Chong",
                "M. Mohammadi",
                "H.Q. Ngo",
                "S.L. Cotton",
                "M. Matthaiou"
            ],
            "title": "On the spectral efficiency of MMSE-based MIMO OTFS systems",
            "venue": "Proc. IEEE ISWCS, Oct. 2022, pp. 1\u20136.",
            "year": 2022
        },
        {
            "authors": [
                "Y. Liu",
                "S. Zhang",
                "F. Gao",
                "J. Ma",
                "X. Wang"
            ],
            "title": "Uplink-aided high mobility downlink channel estimation over massive MIMO-OTFS system",
            "venue": "IEEE J. Sel. Areas Commun., vol. 38, no. 9, pp. 1994\u20132009, Sept. 2020.",
            "year": 1994
        },
        {
            "authors": [
                "D. Shi",
                "W. Wang",
                "L. You",
                "X. Song",
                "Y. Hong",
                "X. Gao",
                "G. Fettweis"
            ],
            "title": "Deterministic pilot design and channel estimation for downlink massive MIMO-OTFS systems in presence of the fractional doppler",
            "venue": "IEEE Trans. Wireless Commun., vol. 20, no. 11, pp. 7151\u20137165, Nov. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M. Li",
                "S. Zhang",
                "F. Gao",
                "P. Fan",
                "O.A. Dobre"
            ],
            "title": "A new path division multiple access for the massive MIMO-OTFS networks",
            "venue": "IEEE J. Sel. Areas Commun., vol. 39, no. 4, pp. 903\u2013918, Apr. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M. Mohammadi",
                "H.Q. Ngo",
                "M. Matthaiou"
            ],
            "title": "Cell-free massive MIMO meets OTFS modulation",
            "venue": "IEEE Trans. Commun., vol. 70, no. 11, pp. 7728\u20137747, Nov. 2022.",
            "year": 2022
        },
        {
            "authors": [
                "P. Raviteja",
                "Y. Hong",
                "E. Viterbo",
                "E. Biglieri"
            ],
            "title": "Practical pulse-shaping waveforms for reduced-cyclic-prefix OTFS",
            "venue": "IEEE Trans. Veh. Technol., vol. 68, no. 1, pp. 957\u2013961, Jan. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "Y. Hong",
                "T. Thaj",
                "E. Viterbo"
            ],
            "title": "Chapter 4 - delay-Doppler modulation",
            "venue": "Delay-Doppler Communications, Y. Hong, T. Thaj, and E. Viterbo, Eds. Academic Press, 2022, pp. 47\u201391.",
            "year": 2022
        },
        {
            "authors": [
                "S. Blandino",
                "C. Desset",
                "A. Chiumento",
                "A. Bourdoux",
                "L. Van der Perre",
                "S. Pollin"
            ],
            "title": "Link adaptation in massive MIMO: Throughput-fairness trade-off",
            "venue": "Proc. IEEE SCVT, 2017, pp. 1\u20136.",
            "year": 2017
        },
        {
            "authors": [
                "T.C. Mai",
                "H.Q. Ngo",
                "T.Q. Duong"
            ],
            "title": "Downlink spectral efficiency of cell-free massive MIMO systems with multi-antenna users",
            "venue": "IEEE Trans. Commun., vol. 68, no. 8, pp. 4803\u20134815, Aug. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "S. Li",
                "W. Yuan",
                "Z. Wei",
                "J. Yuan"
            ],
            "title": "Cross domain iterative detection for orthogonal time frequency space modulation",
            "venue": "IEEE Trans. Wireless Commun., vol. 21, no. 4, pp. 2227\u20132242, Sept. 2021.",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "I. INTRODUCTION Beyond fifth-generation (B5G) wireless communication systems are envisioned to provide reliable communication services under high-mobility environments. In high-mobility scenarios, wireless channels experience doubly dispersive manifestations in the time-frequency (TF) domain. More specifically, time dispersion is caused by the effect of multipath propagation, while frequency dispersion is caused by Doppler shifts. Conventional OFDM systems show great resilience against time dispersion by introducing a cyclic prefix (CP). Unfortunately, the severe Doppler shifts, which appear in high mobility conditions, raise the likelihood of severe inter-carrier interference (ICI). As OFDM systems rely heavily on the orthogonality between different sub-carriers, the performance of currently deployed OFDM systems can be significantly compromised.\nIn this context, the recently proposed OTFS modulation has been considered as a possible solution to provide reliable communication services under high-mobility conditions, with\nThis work was supported by a research grant from the Department for the Economy Northern Ireland under the US-Ireland R&D Partnership Programme. The work of M. Matthaiou was supported by a research grant from the European Research Council (ERC) under the European Union\u2019s Horizon 2020 research and innovation programme (grant No. 101001331). The work of H. Q. Ngo was supported by the U.K. Research and Innovation Future Leaders Fellowships under Grant MR/X010635/1.\nnumerous studies discussing its performance improvement [1]\u2013 [4]. The advantage of OTFS modulation comes from the introduction of the delay-Doppler (DD) domain signal processing [5], [6]. The DD domain can be transformed to and from the TF domain using inverse symplectic finite Fourier transform (ISFFT) and SFFT respectively. Thus, under the current OFDM system setup, applying OTFS will entail extra domain transformation processes, resulting in higher computational complexity [7]. In this context, combining OTFS and OFDM, by viewing OTFS as complementary to OFDM, in high-mobility conditions results in a performance-complexity trade-off.\nTo serve a large number of users, employing different multiple access (MA) schemes for MIMO-OTFS systems has also become a popular topic [8], [9]. The coexistence of non-orthogonal MA and OTFS has been investigated in [8], while the performance of an orthogonal MA scheme was investigated in [9]. Moreover, the massive MIMO technology offers the potential for supporting multi-user scenarios with a substantial increase in the SE of OTFS systems [10]\u2013 [13]. More specifically, Liu et al. [10] and Shen et al. [11] studied OTFS modulation for massive MIMO systems, but only considered channel estimation. Li et al. [12] proposed a path division MA scheme for both uplink (UL) and DL transmission for a massive MIMO-OTFS architecture. The achievable DL and UL SEs of cell-free massive MIMO-OTFS systems were analyzed in [13]. However, to the best of our knowledge, the combination of OTFS and OFDM along with different precoding or grouping schemes has not yet been thoroughly studied in the massive MIMO space.\nIn this paper, we consider a DL massive MIMO system with users from different mobility profiles. We consider a hybrid OTFS/OFDM transmission protocol with different precoding designs. Specifically, we apply OTFS for high-mobility users and OFDM for low-mobility users, while the precoding design type is determined according to the required performance and tolerable complexity. Two different precoding designs are considered at the base station (BS), referred to as FZF and PZF. The former precoding completely suppresses the interuser interference at the cost of high computational complexity, while the latter balances the complexity and performance at the cost of inter-user interference for some users. The main technical contributions of this paper can be summarized as follows:\n\u2022 To apply PZF, we consider two user grouping strategies\nar X\niv :2\n31 0.\n09 06\n8v 1\n[ cs\n.I T\n] 1\n3 O\nct 2\n02 3\nbased on two different criteria, 1) mobility profile, referred to as high/low-mobility (HL) user grouping, 2) smallscale channel gain, referred to as strong/weak (SW) user grouping. Then, ZF is applied at the BS to suppress the inter-group interference at high-mobility or strong user groups, while MRT is used for low-mobility or weak user groups. For each user grouping, ZF and MRT precoding designs are developed, considering hybrid OTFS/OFDM modulation for high/low-mobility users. \u2022 By considering MMSE-SIC detection, we derive new analytical expressions for the DL SE of high- and lowmobility users for different precoding designs as a function of different system parameters. \u2022 Our numerical results reveal that by applying PZF with HL user grouping, high-mobility users achieve significantly higher SE than low-mobility users, while by employing PZF with SW user grouping yields similar SEs for all users.\nNotations: The notations (\u00b7)H and (\u00b7)T denote the Hermitian transpose and transpose of a matrix, respectively; FN denotes the normalized discrete Fourier transform (DFT) matrix of size N \u00d7N ; IM and 0M\u00d7N represent the M \u00d7M identity matrix and zero matrix of size M \u00d7 N , respectively; \u201c\u2297\u201d denotes the Kronecker product operator; det(\u00b7) and Tr(\u00b7) denote the determinant and trace operations of a matrix, respectively; E{\u00b7} denotes the statistical expectation."
        },
        {
            "heading": "II. SYSTEM MODEL",
            "text": "Let us consider a DL massive MIMO system consisting of one BS with Nt antennas and K single-antenna users. We consider a general scenario, in which users have heterogeneous mobility profiles e.g., some users are moving at high speeds, denoted by Kh \u2282 {1, . . . ,K}, and some users have lowmobility, denoted by Kl \u2282 {1, . . . ,K}. Note that Kh\u2229Kl = \u2205, Kh = |Kh|, Kl = |Kl| and Kh + Kl = K. To achieve a fair balance between complexity and performance, we use the classical OFDM modulation for low-mobility users, whilst OTFS is utilized for high-mobility users.\nAt the transmitter side, the information symbols for the khth high-mobility user skh , kh \u2208 Kh will first be accommodated onto a DD domain grid of size M \u00d7N , where M denotes the number of subcarriers and N is the number of time slots for each frame. Therefore, the DD domain transmitted signal for the kh-th user, xDDkh , can be expressed as xDDkh = Wkhskh , (1) where skh and x DD kh\nare column vectors of length MN and NtMN , respectively; Wkh is the precoding matrix of size NtMN \u00d7 MN , and its detailed structure will be exploited later.\nAccording to the OTFS principle, the time domain transmitted symbol vector for the kh-th user, xTDkh , can be obtained by applying the ISFFT and the inverse fast Fourier transform (IFFT) [14], according to\nxTDkh = ( INt \u2297 FHN \u2297 IM ) xDDkh . (2)\nSimilarly, for low mobility users kl, kl \u2208 Kl, the information symbols skl will be accommodated and precoded onto an\nequivalent TF domain grid of size M\u00d7N .1 Therefore, we have xTFkl = Wklskl . The time domain transmitted symbol vector for the kl-th user, xTDkh can then be obtained by applying IFFT, which is given by xTDkl = ( INt \u2297 IN \u2297 FHM ) xTFkl . Hence, the time domain transmitted signal sent by the BS for each frame can then be denoted by\nxTD = \u221a Es ( \u2211 kh\u2208Kh \u221a \u03b7khx TD kh + \u2211 kl\u2208Kl \u221a \u03b7klx TD kl ) , (3) where Es is the transmit signal power, while \u03b7kh and \u03b7kl are the power allocation coefficients for the kh-th and kl-th user, respectively.\nWe assume that the channel has perfect reciprocity and a total of P independent resolvable paths exist between the BS and each user. Furthermore, we assume that the BS antenna is a uniform linear array with half wavelength interelement spacing, and define \u03d5k(i) as the angle of arrival for the i-th resolvable path of the k-th user. The steering vector \u03b8k(i) of size 1 \u00d7 Nt can then be denoted by \u03b8k(i) =[ 1, exp(\u2212j\u03c0 (1) sin\u03d5k(i)), . . . , exp(\u2212j\u03c0 (Nt \u2212 1) sin\u03d5k(i)) ] . With a reduced-CP structure, the time domain channel response between the BS and the k-th user can be represented as [12]\nHTDk \u225c P\u2211\ni=1\n\u03b8k(i)\u2297HTDk(i)= \u221a \u03b2k P\u2211 i=1 \u03b8k(i)\u2297 ( hk(i)\u03a0 lk(i)\u2206kk(i) ) , (4)\nwhere \u03b2k is the large-scale fading coefficient for the k-th user; hk(i) is the small-scale fading coefficient of the i-th path, which follows the Gaussian distribution with zero mean and 1/(2P ) variance per real dimension; \u03a0 is a permutation matrix (forward cyclic shift) of size MN \u00d7MN characterizing the delay effect, i.e., \u03a0 = circ{[0, 1, 0, . . . , 0]TMN\u00d71}, and \u2206 = diag{\u03b10, \u03b11, . . . , \u03b1MN\u22121} is a diagonal matrix characterizing the Doppler effect with \u03b1 \u2206= e j2\u03c0 MN [14]. Furthermore, the terms lk(i) and kk(i) in (4) are the indices of delay and Doppler associated to the i-th path, respectively.2\nTherefore, the received signal in the time domain for the k-th user can be denoted by\nyTD(k) = H TD k x TD k + K\u2211 k\u2032=1,k\u2032 \u0338=k HTDk x TD k\u2032 + zk, (5)\nwhere zk is the additive white Gaussian noise (AWGN) sample vector, with E { zkzk H } = IMN . Without loss of generality, we assume that \u03b2k\u03b7k = 1, which corresponds to the inverse power control scheme [16]. We now define the DD domain and TF domain equivalent channel matrices as follows\nHDDk =(FN \u2297 IM )HTDk ( INt \u2297 FHN \u2297 IM ) , (6)\nHTFk =(IN \u2297 FM )HTDk ( INt \u2297 IN \u2297 FHM ) . (7)\nThe equivalent DD domain received signal for the kh-th highmobility user, and the equivalent TF domain received signal for the kl-th low-mobility user are shown in (8) and (9), respectively, at the top of the next page. For notation simplicity, we further define\nH\u0304DDk =(FN \u2297 IM )HTDk ( INt \u2297 IN \u2297 FHM ) , (10)\nH\u0304TFk =(IN \u2297 FM )HTDk ( INt \u2297 FHN \u2297 IM ) . (11)\n1Since a CP is naturally required for OFDM, part of the information symbols for OFDM would be dedicated for CP.\n2Note that (4) gives a tight approximation when the system has fractional Doppler indices [15].\nyDD(kh) = (FN \u2297 IM )y TD (kh)\n= \u221a EsH\nDD kh Wkhskh\ufe38 \ufe37\ufe37 \ufe38\nDesired signal\n+ \u2211\nk\u2032 h \u2208Kh, k\u2032 h \u0338=kh\n\u221a EsH\nDD kh Wk\u2032hsk \u2032 h\n\ufe38 \ufe37\ufe37 \ufe38 Intra-group interference\n+ \u2211\nkl\u2208Kl\n\u221a Es(FN \u2297 IM )HTDkh ( INt \u2297 IN \u2297 F H M ) Wklskl\ufe38 \ufe37\ufe37 \ufe38\nInter-group interference\n+zkh ,\n(8)\nyTF(kl) = (IN \u2297 FM )y TD (kl)\n= \u221a EsH\nTF kl Wklskl\ufe38 \ufe37\ufe37 \ufe38\nDesired signal\n+ \u2211\nk\u2032 l \u2208Kl, k\u2032 l \u0338=kl\n\u221a EsH\nTF kl Wk\u2032lsk \u2032 l\n\ufe38 \ufe37\ufe37 \ufe38 Intra-group interference\n+ \u2211\nkh\u2208Kh\n\u221a Es(IN \u2297 FM )HTDkl ( INt \u2297 F H N \u2297 IM ) Wkhskh\ufe38 \ufe37\ufe37 \ufe38\nInter-group interference\n+zkl .\n(9)"
        },
        {
            "heading": "III. PERFORMANCE ANALYSIS",
            "text": "We consider an MMSE-SIC detector at the receiver side and analyze the SE performance of different precoding designs for different user grouping strategies. The DL achievable SE can be obtained as [17]\nSEk = \u03b1SElog2 det ( IMN + D\u0304 H kk (\u03a8k) \u22121 D\u0304kk ) , (12)\nwhere D\u0304kk = E {Dkk}, and Dkk = \u221a EsHkWk, (13a)\n\u03a8k = IMN + E { K\u2211\nk\u2032=1\nDkk\u2032D H kk\u2032 } \u2212 D\u0304kkD\u0304Hkk, (13b)\nwith Dkk\u2032 = \u221a EsHkWk\u2032 , and Hk represents the MIMO channel for the k-th user. The specific Hk for each case (i.e., HDDk , H\u0304 DD k , H TF k , and H\u0304 TF k ) will be made explicit later according to the user grouping strategy and modulation scheme. Moreover, \u03b1SE is a normalization coefficient, where \u03b1SE = \u03b1 DD SE = 1 MN for OTFS users, and \u03b1SE = \u03b1 TF SE =\n1 MN MN\u2212Lcp MN for OFDM users. We notice that (12) results in a tight approximation to the real system SE due to the channel hardening effect provided by the massive MIMO system.\nA. FZF precoding Let us first consider FZF for all users. With the grouping method based on users\u2019 mobility, we further define HFZFH = [(HDD1 ) T,(HDD2 ) T,. . .,(HDDKh )T,(H\u0304TF1 ) T,(H\u0304TF2 ) T,. . .,(H\u0304TFKl )T]T, and HFZFL =[(H TF 1 ) T,(HTF2 ) T,. . .,(HTFKl )T,(H\u0304DD1 ) T,(H\u0304DD2 ) T,. . .,(H\u0304DDKh )T]T. Note that the sizes of HFZFH and H FZF L are both\nKMN\u00d7NtMN . Besides, we have ( (b (kh) K ) H\u2297IMN ) HFZFH = HDDkh , where b (kh) K is a column vector of length K, with only the kh-th entry being one and others being zero. Therefore, we can see that ( (b\n(kh) K ) H \u2297 IMN )\nhelps to pick out the kh-th matrix from the block matrix HFZFH . Then, for the high-mobility user, we have WFZFkh =\u03b1FZF,H(H FZF H ) H ( HFZFH (H FZF H ) H )\u22121( b (kh) K \u2297 IMN ) , (14) where \u03b1FZF,H = \u221a MN\u221a\nE {\u2225\u2225\u2225(HFZFH )H(HFZFH (HFZFH )H)\u22121(b(kh)K \u2297IMN)\u2225\u2225\u22252}\nis the normalization coefficient, with E {\u2225\u2225(HFZFH )H (HFZFH (HFZFH )H)\u22121 (b(kh)K \u2297 IMN)\u2225\u22252} = E { Tr [ ( (b\n(kh) K ) H \u2297 IMN )( HFZFH (H FZF H ) H )\u22121 HFZFH\n(HFZFH ) H ( HFZFH (H FZF H ) H )\u22121 ( b (kh) K \u2297 IMN ) ]} = 1 K E { Tr [( HFZFH (H FZF H ) H )\u22121]} . (15)\nThe normalization coefficient \u03b1FZF,H can be further expressed as\n\u03b1FZF,H =\n\u221a KMN\u221a\nE { Tr [ (HFZFH (H FZF H ) H) \u22121 ]} . (16) Similarly, for the kl-th low-mobility user, we have WFZFkl =\u03b1FZF,L(H FZF L ) H ( HFZFL (H FZF L ) H )\u22121( b (kl) K \u2297IMN ) , (17) with \u03b1FZF,L = \u221a KMN\u221a\nE { Tr [ (HFZFL (HFZFL )H) \u22121 ]} . Given the Inde-\npendence of the different users\u2019 channel responses and the unitary characteristics of the domain transformation, we have \u03b1FZF \u2206 = \u03b1FZF,H = \u03b1FZF,L. Proposition 1: With FZF, the SE for the kh-th high-mobility and the kl-th low-mobility user can be obtained in closed-form as SEFZFkh =MN\u03b1 DD SE log2 ( 1 + \u03b12FZFEs ) , (18a)\nSEFZFkl =MN\u03b1 TF SE log2 ( 1 + \u03b12FZFEs ) . (18b)\nProof. See Appendix A.\nFrom Proposition 1, we observe that with the help of the FZF, all the intra-group interference and inter-group interference can be canceled at the cost of high computational complexity for both high-mobility and low-mobility users.\nB. PZF Precoding with High/Low-mobility Grouping\nEnabling FZF requires high complexity, alternatively, we now consider a precoding design with lower complexity. Specifically, we consider ZF precoding for high-mobility users and MRT precoding for low-mobility users.\nFor the high-mobility users, the precoding matrix WPZFkh can be denoted by WPZFkh =\u03b1PZF(H PZF)H ( HPZF(HPZF)H )\u22121 ( b (kh) Kh \u2297 IMN ) , (19) where HPZF = [(HDD1 ) T, (HDD2 ) T, . . . , (HDDKh ) T]T of size KhMN \u00d7NtMN , and \u03b1PZF = \u221a MN\u221a\nE {\u2225\u2225(HPZF)H (HPZF(HPZF)H)\u22121 (b(kh)Kh \u2297 IMN)\u2225\u22252} ,\n(20) is the normalization coefficient. Therefore, for PZF, we have,\nE {\u2225\u2225(HPZF)H (HPZF(HPZF)H)\u22121 (b(kh)Kh \u2297 IMN)\u2225\u22252} = E { Tr [ ( (b\n(kh) Kh\n)H \u2297 IMN )( HPZF(HPZF)H )\u22121 HPZF\n\u00d7 (HPZF)H ( HPZF(HPZF)H )\u22121 ( b (kh) Kh \u2297 IMN ) ]}\n= 1 Kh E { Tr [( HPZF(HPZF)H )\u22121]} , (21)\nand the normalization coefficient can be denoted by\n\u03b1PZF =\n\u221a MNKh\u221a\nE { Tr [ (HPZF(HPZF)H) \u22121 ]} . (22)\nFrom (14) and (19), we can see that the main complexity for computing the FZF and PZF precoding designs can be approximated by O((KMN)3) and O((KhMN)3), respectively. Therefore, the complexities of FZF and PZF are dependent on K and Kh, respectively, with PZF having lower complexity.\nFor low-mobility users, to apply the MRT precoding, we have\nWMRTkl = \u03b1MRT(H TF kl\n) H , (23)\nwhere \u03b1MRT = \u221a MN\u221a E {\u2225\u2225HTFkl \u2225\u22252} , while\nE {\u2225\u2225HTFkl \u2225\u22252} = E{Tr [HTFkl (HTFkl )H]} = E { Tr [ (IN \u2297 (FHMFM ))HTDkl ( INtN \u2297 (F H MFM ) )( HTDkl\n)H ]} = E\n{ P\u2211 i=1 Tr [( \u03b8kl(i)\u03b8 H kl(i) ) \u2297 ( HTDkl(i)(H TD kl(i) )H )]}\n+ E { P\u2211\ni=1 P\u2211 j=1,j \u0338=i Tr [( \u03b8kl(i)\u03b8 H kl(j) ) \u2297 ( HTDkl(i)(H TD kl(j) )H )]}\n(a) = P\u2211 i=1 E { Tr [ hkl(i)h \u2217 kl(i) NtIMN ]} = NtMN, (24)\nwhere (a) in (24) follows the fact that the zero-mean channel coefficients for different paths are independent from each other. Therefore, the normalization coefficient becomes\n\u03b1MRT = 1\u221a Nt . (25)\nProposition 2: With PZF precoding and HL grouping, for the kh-th high-mobility user, the SE can be represented as\nSEPZFkh =\u03b1 DD SE log2det ( IMN+Es\u03b1 2 PZF ( 1+ KlEs\u03b1 2 MRT\nP 2\n\u00d7 P\u2211 i=1 P\u2211 j=1 E { |\u03b8kh(i)\u03b8 H k\u2032l(j) |2 })\u22121 IMN ) . (26)\nProof. See Appendix B. Proposition 3: With PZF precoding and HL grouping, the SE for the kl-th low-mobility user is given by SEMRTkl = \u03b1 TF SE log2 det ( IMN + EsNt ( IMN \u2212 EsNtIMN\n+KhE { Dklk\u2032hD H klk \u2032 h } + E { Dklk\u2032lD H klk \u2032 l } + Es\u03b1 2 MRT\nP 2 \u2211 k\u2032 l \u0338=kl P\u2211 i=1 P\u2211 j=1 E { |\u03b8kl(i)\u03b8 H k\u2032 l (j)| 2 } IMN )\u22121) , (27)\nwhere E { Dklk\u2032hD H klk \u2032 h } = Es\u03b1 2 PZFE { H\u0304TFkl (H PZF)H ( HPZF(HPZF)H )\u22121 \u00d7 ( b (k\u2032h) Kh (b (k\u2032h) Kh )H\u2297IMN )( HPZF(HPZF)H ) \u22121HPZF(H\u0304TFkl )\nH}, (28)\nE { Dklk\u2032lD H klk \u2032 l } = Es\u03b1 2 MRT\n( P + 1\nP N2t\n+ 1\nP 2 P\u2211 i=1 P\u2211 j=1 j \u0338=i E { |\u03b8kl(i)\u03b8 H kl(j) |2 }) IMN . (29)\nProof. By invoking (23) and (25), for the kl-th low mobility user, we have\nD\u0304klkl = \u221a EsE { HTFkl W MRT kl } = \u221a NtEsIMN . (30)\nThen, similar to (44), for the intra-group interference from user k\u2032l, where k \u2032 l \u2208 Kl, k\u2032l \u0338= kl, we have\nE { Dklk\u2032lD H klk\u2032l } = EsE { HTFkl W MRT k\u2032l (WMRTk\u2032l )H(HTFkl ) H }\n= Es\u03b1\n2 MRT\nP 2 P\u2211 i=1 P\u2211 j=1 E { |\u03b8kl(i)\u03b8 H k\u2032l(j) |2 } IMN . (31)\nSimilar as in (31), with k\u2032l = kl, E { DklklD H klkl } is expressed as in (29), which is derived based on the independency between different paths. To this end, after computing \u03a8k according to (13b) and then plugging the result into (12) we arrive at the final result in (27).\nCorollary 1. The achievable SE with PZF precoding and HL grouping in (26) and (27) can be further approximated as\nSEPZFkh \u2248 log2 ( 1 +Es\u03b1 2 PZF ( 1+KlEs\u03b1 2 MRTNt )\u22121) . (32)\nSEMRTkl \u2248 \u03b1 TF SE log2 det ( IMN + EsNt\n\u00d7 ( KhE { Dklk\u2032hD H klk\u2032h } + \u03c8IMN ) \u22121 ) , (33)\nwith \u03c8=1+ ( Nt+ Nt\u22121 P +Kl ) Es\u03b1 2 MRTNt\u2212EsNt. Note that the\napproximation comes from E { \u03b8Hk\u2032l(j) \u03b8k\u2032l(j) } \u2248 IMN .\nAccording to Propositions 2 and 3, with the help of the PZF, intra-group interference for high-mobility users can be eliminated. Yet, high-mobility users still suffer from intergroup interference, while low-mobility users will experience both intra-group and inter-group interference.\nC. PZF Precoding with Strong/Weak User Grouping\nFrom (26) and (27), we can see that under the HL user grouping strategy, low-mobility users always experience more interference than high-mobility users. To guarantee a satisfactory performance for both high-mobility and low-mobility users, based on (8) and (9), we consider further grouping the users based on their channel gain as strong users Ks \u2282 {1, . . . ,K} and weak users Kw \u2282 {1, . . . ,K}, with Ks \u2229 Kw = \u2205, Ks = |Ks|, Kw = |Kw| and Ks +Kw = K. Therefore, each user\u2019s modulation protocol is decided by its mobility, and its corresponding precoding design is determined based on its channel conditions. Based on the SW grouping strategy, we apply PZF precoding for strong users and MRT precoding for weak users.\nWithout loss of generality, we again focus on one highmobility and one low-mobility user. With the SW user grouping, the input-output relationship can be denoted as in (34) and (35) at the top of the next page. From (34), we can see that, if the kh-th user is also a strong user, the desired signal is in the first term when k\u2032h = kh, or if the kh-th user is a weak user, the desired signal is in the second term when k\u2032h = kh. Similar to before, with PZF, the intra-group interference from the weak users to the strong users can be eliminated. However, strong\nyDD(kh)= \u2211\nk\u2032 h \u2208Kh\u222aKs\n\u221a EsH DD kh W PZF k\u2032 h sk\u2032 h + \u2211 k\u2032 h \u2208Kh\u222aKw \u221a EsH DD kh W MRT k\u2032 h sk\u2032 h + \u2211 k\u2032 l \u2208Kl\u222aKs \u221a EsH\u0304 DD kh W PZF k\u2032 l sk\u2032 l + \u2211 k\u2032 l \u2208Kl\u222aKw \u221a EsH\u0304 DD kh W MRT k\u2032 l sk\u2032 l +zkh , (34)\nyTF(kl)= \u2211\nk\u2032 h \u2208Kh\u222aKs\n\u221a EsH\u0304 TF kl W PZF k\u2032 h sk\u2032 h + \u2211 k\u2032 h \u2208Kh\u222aKw \u221a EsH\u0304 TF kl W MRT k\u2032 h sk\u2032 h + \u2211 k\u2032 l \u2208Kl\u222aKs \u221a EsH TF kl W PZF k\u2032 l sk\u2032 l + \u2211 k\u2032 l \u2208Kl\u222aKw \u221a EsH TF kl W MRT k\u2032 l sk\u2032 l +zkl . (35)\nFig. 1: Per-user SEs for FZF and PZF precoding with different modulation schemes ( Kh = Kl = Ks = Kw = 3).\nusers still experience inter-group interference from weak users. Weak users are affected by both intra-group and inter-group interference. With the help of the SW grouping strategy, as each user can be a strong or a weak user with equal probability, the performance gap between the high-mobility and low-mobility users can be narrowed. Due to space limitations, this result will only be verified with simulations in Section IV."
        },
        {
            "heading": "IV. NUMERICAL RESULTS",
            "text": "We now simulate the per-user SE with different modulation and precoding designs, adopting the Monte Carlo approach. We set Nt = 100, M = 8, N = 8, and P = 2. The channel fading coefficient is generated with a uniform power delay profile. Similar to [2], [18], the delay lk(i) and Doppler indices kk(i) are generated with equal probability within the range of [0, lmax] and [\u2212kmax, kmax], where the maximum delay index lmax=4 and the maximum Doppler index kmax=2 for lowmobility users, lmax=4 and kmax=4 for high-mobility users, respectively. Note that in the simulations, we consider nonfractional delay indices and fractional Doppler indices, which resemble practical channel conditions. Besides, we consider 20% of the overall transmitted symbols as CP for OFDM.\nFigure 1 shows the simulation results for per-user SE achieved by FZF and PZF precoding designs with the hybrid OTFS/OFDM transmission under the HL and SW user grouping strategies and for Kh = Kl = Ks = Kw = 3. From this figure, it can be seen that the performance enhancement of FZF over PZF in terms of SE, especially when the SNR increases. Moreover, with PZF precoding design and HL user grouping, low-mobility users experience a worse overall performance as they suffer from more interference. On the other hand, for the SW user grouping, it can be observed that the SE performance is similar for both high- and low-mobility users. Therefore, users who experience a weak channel gain, are protected at the\nFig. 2: Per-user SEs for PZF precoding and HL user grouping and for different numbers of users per each group (K = 6).\ncost of the strong users\u2019 performance. Moreover, the results validate our theoretical analysis. Note that the theoretical values in the figure are calculated via (32) and (33). Finally, to show the benefit of using the hybrid OTFS/OFDM system, we compare the performance of FZF and PZF with OTFS/OFDM to that with OFDM, respectively. The results show that there is a performance improvement for the hybrid OTFS/OFDM system over the OFDM system.\nTo better study the trade-off between the complexity and performance of the PZF scheme, in Fig. 2, we show the peruser SE for high/low-mobility users with different numbers of high-mobility users, Kh, for a given number of users K = 6, and Kl = K \u2212 Kh. We can see that with the increase of Kh, higher SE can be achieved by the high-mobility users. This is because, with smaller Kl, high-mobility users suffer from less inter-group interference. However, the SE for low-mobility users remains the same, as they are affected by both intra-group and inter-group interference. We recall that for high-mobility users, extra complexity is required to implement OTFS modulation. Moreover, the complexity of PZF is dependent on Kh. With larger Kh, higher computational complexity is required for high-mobility users."
        },
        {
            "heading": "V. CONCLUSION",
            "text": "We investigated the performance of a DL massive MIMOOTFS/OFDM system with different precoding designs, in terms of SE. We considered FZF and PZF precoding design under HL and SW user grouping strategies. We showed that the FZF eliminates all the interference at the cost of high complexity. We investigated the PZF precoding with two different grouping strategies: one based on high and low mobility user grouping, and the other based on strong and weak user grouping. Our simulation results validated our discussions and demonstrated the trade-off between performance and complexity. For our\nE { Dkhk\u2032lD H khk \u2032 l } = EsE { H\u0304DDkh W MRT k\u2032 l (WMRTk\u2032 l )H(H\u0304DDkh ) H }\n= Es\u03b1 2 MRTE { H\u0304DDkh (INt \u2297 IN \u2297 FM ) (H TD k\u2032 l )H(IN \u2297 (FHMFM ))HTDk\u2032 l ( INt \u2297 IN \u2297 F H M ) (H\u0304DDkh ) H }\n(a) = Es\u03b1 2 MRT(FN\u2297IM ) P\u2211 i=1 P\u2211 j=1 E { \u03b8kh(i)\u03b8 H k\u2032 l (j)\u03b8k\u2032l(j)\u03b8 H kh(i) } \u2297 E { HTDkh(i)(H TD k\u2032 l (j)) HHTDk\u2032 l (j)(H TD kh(i) )H } (FHN \u2297 IM )\n(b) =\nEs\u03b1 2 MRT\nP 2 P\u2211 i=1 P\u2211 j=1 E { |\u03b8kh(i)\u03b8 H k\u2032 l (j)| 2 } IMN (44)\nfuture work, the performance with large-scale fading and imperfect channel state information can be investigated."
        },
        {
            "heading": "APPENDIX A PROOF OF PROPOSITION 1",
            "text": "By invoking (12) and (14), for the kh-th high-mobility user, we derive Dkhk\u2032 as\nHkhW FZF k\u2032 =\u03b1FZFHkh(H FZF H ) H ( HFZFH (H FZF H ) H )\u22121( b (k\u2032) K \u2297 IMN ) = \u03b1FZF ( (b (kh) K ) H \u2297 IMN ) HFZFH (H FZF H ) H\n\u00d7 ( HFZFH (H FZF H ) H )\u22121 ( b (k\u2032) K \u2297 IMN ) = \u03b1FZF (( (b (kh) K ) Hb (k\u2032) K ) \u2297 IMN\n) = { 0MN , k\n\u2032 \u0338= kh \u03b1FZFIMN , k \u2032 = kh . (36)\nTherefore, D\u0304khkh = \u03b1FZF \u221a EsIMN , (37)\nE { DkkD H kk } = \u03b12FZFEsIMN , (38)\nand \u03a8kh=IMN+E { DkkD H kk } +(K \u2212 1)0MN\u2212D\u0304kkD\u0304Hkk = IMN . (39) Hence, by substituting (37) and (39) into (12), the SE for kh-th high-mobility user can be obtained as (18a). Similarly, for the kl-th low-mobility user, we have HklW FZF k\u2032 =\u03b1FZFHkl(H FZF H ) H ( HFZFH (H FZF H ) H )\u22121( b (k\u2032) K \u2297 IMN\n) = { 0MN , k\n\u2032 \u0338= kl \u03b1FZFIMN , k \u2032 = kl . (40)\nThen, the SE for the kl-th low-mobility user can be obtained as (18b)."
        },
        {
            "heading": "APPENDIX B PROOF OF PROPOSITION 2",
            "text": "Focusing on the kh-th high-mobility user, similar as in (36) and (40), we have HDDkh W PZF k\u2032 h =\u03b1PZFH DD kh (H PZF)H ( HPZF(HPZF)H )\u22121 ( b (k\u2032h) Kh \u2297 IMN )\n=\n{ 0MN , k \u2032 h \u0338= kh, k\u2032h \u2208 Kh\n\u03b1PZFIMN , k \u2032 h = kh\n. (41)\nTherefore, D\u0304khkh = \u221a EsE { HDDkh W PZF kh } = \u221a Es\u03b1PZFIMN . (42) Then, for the intra-group interference from user k\u2032h, where k \u2032 h \u2208\nKh, k\u2032h \u0338= kh, we have E { Dkhk\u2032hD H khk \u2032 h } = E { EsH DD kh W PZF k\u2032 h (WPZFk\u2032 h )H(HDDkh ) H} = 0MN . (43)\nMoreover, for the inter-group interference from user k\u2032l, with kl \u2208 Kl, E { Dkhk\u2032lD H khk\u2032l } can be derived as in (44) at the top of the page. Note that (a) in (44) is based on (4) and the\nproperties of Kronecker product, while (b) in (44) is based on the independence of the channel responses of different paths."
        }
    ],
    "title": "How to Combine OTFS and OFDM Modulations in Massive MIMO?",
    "year": 2023
}