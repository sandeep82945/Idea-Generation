{
    "abstractText": "Lucius Bushnaq, 5 ,\u2217 Isabel Campos, Marco Catillo, Alessandro Cotellucci, Madeleine Dale, Jens L\u00fccke, Marina Krsti\u0107 Marinkovi\u0107, Agostino Patella, Mike Peardon 5 and Nazario Tantalo Institut f\u00fcr Theoretische Physik, ETH Z\u00fcrich, Wolfgang-Pauli-Str. 27, 8093 Z\u00fcrich, Switzerland Instituto de F\u00edsica de Cantabria & IFCA-CSIC, Avda. de Los Castros s/n, 39005 Santander, Spain Humboldt Universit\u00e4t zu Berlin, Institut f\u00fcr Physik & IRIS Adlershof, Zum Gro\u00dfen Windkanal 6, 12489 Berlin, Germany Universit\u00e0 di Roma Tor Vergata, Dip. di Fisica, Via della Ricerca Scientifica 1, 00133 Rome, Italy INFN, Sezione di Tor Vergata, Via della Ricerca Scientifica 1, 00133 Rome, Italy 5 School of Mathematics, Trinity College Dublin, College Green, Dublin 2, Ireland DESY, Platanenallee 6, D-15738 Zeuthen, Germany Department of Physics, University of Cyprus, 1 Panepistimiou Street, 2109 Aglantzia, Nicosia, Cyprus E-mail: bushnaql@tcd.ie, isabel@campos-it.es,",
    "authors": [
        {
            "affiliations": [],
            "name": "Isabel Campos"
        },
        {
            "affiliations": [],
            "name": "Marco Catillo"
        },
        {
            "affiliations": [],
            "name": "Alessandro Cotellucci"
        },
        {
            "affiliations": [],
            "name": "Madeleine Dale"
        },
        {
            "affiliations": [],
            "name": "Jens L\u00fccke"
        },
        {
            "affiliations": [],
            "name": "Marina Krsti\u0107 Marinkovi\u0107"
        },
        {
            "affiliations": [],
            "name": "Agostino Patella"
        },
        {
            "affiliations": [],
            "name": "Mike Peardon"
        },
        {
            "affiliations": [],
            "name": "Lucius Bushnaq"
        }
    ],
    "id": "SP:090da172976e5c5fb34c8080b264e2494c3b6b2e",
    "references": [
        {
            "authors": [
                "M. Peardon",
                "J. Bulava",
                "J. Foley",
                "C. Morningstar",
                "J. Dudek",
                "R.G. Edwards"
            ],
            "title": "Novel quark-field creation operator construction for hadronic physics in lattice QCD",
            "venue": "Physical Review D",
            "year": 2009
        },
        {
            "authors": [
                "T. DeGrand",
                "S. Schaefer"
            ],
            "title": "Improving meson two-point functions in lattice QCD",
            "venue": "Computer Physics Communications",
            "year": 2004
        },
        {
            "authors": [
                "L. Giusti",
                "P. Hernandez",
                "M. Laine",
                "P. Weisz",
                "H. Wittig"
            ],
            "title": "Low-energy couplings of QCD from current correlators near the chiral limit",
            "venue": "Journal of High Energy Physics",
            "year": 2004
        },
        {
            "authors": [
                "L. Wu",
                "E. Romero",
                "A. Stathopoulos"
            ],
            "title": "Primme_svds: A high-performance preconditioned SVD solver for accurate large-scale computations, CoRR abs/1607.01404",
            "year": 2016
        },
        {
            "authors": [
                "P. Fritzsch",
                "F. Knechtli",
                "B. Leder",
                "M. Marinkovic",
                "S. Schaefer",
                "R. Sommer"
            ],
            "title": "The strange quark mass and lambda parameter of two flavor QCD",
            "venue": "Nuclear Physics B",
            "year": 2012
        },
        {
            "authors": [
                "M.D. Morte",
                "A. Francis",
                "V. G\u00fclpers",
                "G. Herdo\u00edza",
                "G. von Hippel",
                "H. Horch"
            ],
            "title": "The hadronic vacuum polarization contribution to the muon g-2 from lattice QCD",
            "venue": "Journal of High Energy Physics",
            "year": 2017
        },
        {
            "authors": [
                "C. Morningstar",
                "J. Bulava",
                "J. Foley",
                "K.J. Juge",
                "D. Lenkner",
                "M. Peardon"
            ],
            "title": "Improved stochastic estimation of quark propagation with laplacian heaviside smearing in lattice QCD",
            "venue": "Physical Review D",
            "year": 2011
        }
    ],
    "sections": [
        {
            "text": "P o S ( L A T T I C E 2 0 2 1 ) 3 6 3\nImplementing noise reduction techniques into the OpenQ*D package\nLucius Bushnaq, 5 ,\u2217 Isabel Campos,1 Marco Catillo,0 Alessandro Cotellucci,2\nMadeleine Dale,3,4,\u210e Jens L\u00fccke,2,6 Marina Krsti\u0107 Marinkovi\u0107,0 Agostino Patella,2,6\nMike Peardon 5 and Nazario Tantalo3,4 0Institut f\u00fcr Theoretische Physik, ETH Z\u00fcrich, Wolfgang-Pauli-Str. 27, 8093 Z\u00fcrich, Switzerland 1Instituto de F\u00edsica de Cantabria & IFCA-CSIC, Avda. de Los Castros s/n, 39005 Santander, Spain 2Humboldt Universit\u00e4t zu Berlin, Institut f\u00fcr Physik & IRIS Adlershof, Zum Gro\u00dfen Windkanal 6, 12489 Berlin, Germany 3Universit\u00e0 di Roma Tor Vergata, Dip. di Fisica, Via della Ricerca Scientifica 1, 00133 Rome, Italy 4INFN, Sezione di Tor Vergata, Via della Ricerca Scientifica 1, 00133 Rome, Italy 5 School of Mathematics, Trinity College Dublin, College Green, Dublin 2, Ireland 6DESY, Platanenallee 6, D-15738 Zeuthen, Germany \u210eDepartment of Physics, University of Cyprus, 1 Panepistimiou Street, 2109 Aglantzia, Nicosia, Cyprus E-mail: bushnaql@tcd.ie, isabel@campos-it.es, Marco.Catillo@physik.uni-muenchen.de,\nalessandro.cotellucci@physik.hu-berlin.de, m.dale@stimulate-ejd.eu,\nfritzsch@uni-muenster.de, jens.luecke@hu-berlin.de,\nmarinama@phys.ethz.ch, agostino.patella@physik.hu-berlin.de,\nmjp@maths.tcd.ie, nazario.tantalo@roma2.infn.it\nWe present the results of testing a new technique for stochastic noise reduction in the calculation of propagators by implementing it in OpenQ*D for two ensembles with O(a) improved Wilson fermion action, with periodic boundary conditions and pion masses of 437 MeV and 331 MeV, for the connected vector and pseudoscalar correlators. We find that the technique yields no speedup compared to traditional methods, owning to the failure of its underlying assumption that the spectra of the spatial Laplacian and Dirac operators are sufficiently similar for the technique\u2019s purposes.\nThe 38th International Symposium on Lattice Field Theory, 2021 Zoom/Gather@Massachusetts Institute of Technology, LATTICE2021 26th-30th July\n\u2217Speaker\n\u00a9 Copyright owned by the author(s) under the terms of the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License (CC BY-NC-ND 4.0). https://pos.sissa.it/\nP o S ( L A T T I C E 2 0 2 1 ) 3 6 3"
        },
        {
            "heading": "1. Introduction",
            "text": "The distillation operator [1] has seen great success as a smearing tool. This might lead one to suspect that the low-lying spectrum of the spatial Laplacian has substantial overlap with the low-lying spectrum of the Dirac operator. Since the spatial Laplacian is considerably smaller, its spectrum is easier to calculate than that of the full Dirac operator. Thus, if the overlap between the two operator\u2019s spectra were good enough, it could make sense to substitute the Distillation spectrum for the Dirac spectrum in many applications.\nA potential practical use case and test of this notion would be distillation low-mode averaging. In conventional low-mode averaging, one attempts to reduce the stochastic noise on numeric calculations of propagators by calculating the lowest modes of the Dirac operator explicitly, which are assumed to give the dominant contribution to the observable. The propagator is then broken up into a contribution projected into the space of low-lying modes, which is now available directly, and a space of high-lying modes, which is calculated stochastically [2] [3].\nHere, the idea is to do the same, but using the distillation operator instead. The distillation operator is formed out of the eigenmodes of the spatial Laplacian\n52<B,=B\u2032 (C) = \u22126XBB\u2032X<= + XBB\u2032 3\u2211 9=1 ( * 9 (<, C)X<+ 9\u0302 ,= +* \u2020 9 (< \u2212 9\u0302 , C)X<\u2212 9\u0302 ,= ) (C) = + (C)+\u2020(C) =\n#\u2211 :=1 E (:) (C)E (:)\u2020(C) ,\n(1)\nwhere E (:) (C) are the eigenvectors, # is the number of eigenvectors calculated, and + (C) is a matrix with the eigenvectors as column entries. Since the operator does not affect the spin space, the eigenvectors come in degenerate sets of four. We chose the spin-orthogonal basis for these degenerate states.\nTo implement this method for the calculation of the connected vector correlator, we begin by splitting the Hilbert space into the low-lying space of the Laplacian modes, and the \"rest-space\" at both source and sink by inserting 1 \u2212 (C) + (C)\n\u3008k (C)W`k (C)k (C \u2032)Wak (C \u2032)\u3009\n=\u3008k (C)W` (1 \u2212 (C) + (C)) k (C)k (C \u2032)Wa (1 \u2212 (C \u2032) + (C \u2032)) k (C \u2032)\u3009\n=\u3008k (C)W` (1 \u2212 (C)) k (C)k (C \u2032)Wa (1 \u2212 (C \u2032)) k (C \u2032)\u3009\n+ 2\u3008k (C)W` (C)k (C)k (C \u2032)Wa (1 \u2212 (C \u2032)) k (C \u2032)\u3009\n+ \u3008k (C)W` (C)k (C)k (C \u2032)Wa (C \u2032)k (C \u2032)\u3009\n=: A4BC (C) + 2 <8G43 (C) + 38BC (C) .\n(2)\nWe have used time reversal symmetry to combine the two mixed contributions into one. If we were working with conventional low-mode averaging, and (C) consisted of eigenmodes of the Dirac operator, <8G43 (C) would vanish since and the propagator would commute. But here, we need to calculate it on top of the other two contributions.\nP o S ( L A T T I C E 2 0 2 1 ) 3 6 3\nNow we perform a one-end insertion to introduce the stochastic sources\n38BC (C) = tr[W5W`+\u2020(C) \u22121(C, C \u2032)+ (C \u2032)WaW5+\u2020(C \u2032) \u22121 \u2020(C \u2032, C)+ (C)] A4BC (C) = 1 #A tr[W5W` (1 \u2212 (C)) \u22121(C, C \u2032)[ (A ) (C \u2032)[\u2020 (A ) (C \u2032)WaW5 (1 \u2212 (C \u2032)) \u22121 \u2020(C \u2032, C)] <8G43 (C) = 1 #A tr[W5W` (C) \u22121(C, C \u2032)[ (A ) (C \u2032)[\u2020 (A ) (C \u2032)WaW5 (1 \u2212 (C \u2032)) \u22121 \u2020(C \u2032, C)] .\n(3)\nThus, to calculate 38BC (C) we need the vectors q (:) := \u22121(C, C \u2032)E (:) (C \u2032) which then form the perambulator [1]. Thus, we need to solve the Dirac equation with the eigenvectors of the spatial Laplacian at the desired source time as sources.\nTo calculate A4BC (C) and <8G43 (C), we need\nq (A ) := \u22121(C, C \u2032)[ (A ) (C \u2032)\nq (A ) := \u22121(C, C \u2032) (1 \u2212 (C \u2032)))[ (A ) (C \u2032) ,\n(4)\nmaking for # + 2' needed solutions to the Dirac equation in total. Any two-point correlation function can then be formed through the contraction of these solutions by calculating the spin structure explicitly, as detailed in [4] adjusted for the distillation-low-mode-averaging method.\nIn order for the technique to be worth the cost of the increased number of solutions needed per stochastic source, as well as the cost of calculating the distillation modes themselves, <8G43 (C) and A4BC (C) need to be small relative to 38BC (C)."
        },
        {
            "heading": "2. Implementation and Simulation setup",
            "text": "The technique was implemented for the connected vector correlator and pseudoscalars in OpenQ*D, using the PRIMME eigensolver [5] to obtain the distillation eigenmodes.\nThe spatial covariant laplacian is passed to PRIMME as a black-box operator, parallelized with MPI. The solver then returns the specified number of low-lying eigenmodes. This is repeated for the spatial Laplacian on every timeslice of the lattice, for every configuration. No preconditioning for the operator is employed.\nWe tested the performance of the method on two CLS data sets with two flavours of dynamical O(a) improvedWilson fermions. The computation used periodic boundary conditions and stochastic wall sources. The determinations of the lattice spacing as well as the other configuration parameters were taken from Refs. [6] [7].\nP o S ( L A T T I C E 2 0 2 1 ) 3 6 3\n(a) E5 (b) A5\nFigure 1: Vector correlator, 160x4 eigenvectors, 24 wall sources\nFigure 2: E5 vector correlator by parts, 160x4 eigenvectors, 24 sources"
        },
        {
            "heading": "3. Results",
            "text": "The error analysis for all results was performed with jackknifing. Correlations between the errors at different time slices were not corrected for. Figures 1a and 1b compare the vector correlator calculatedwith distillation-low-mode-averaging andwithout, on the E5 andA5 ensembles respectively, with six independent color and even-odd diluted wall sources and 640 Laplacian modes. The results are in good agreement inside the error bars. Figure 2 shows the three individual contributions to the total distilled result in the E5 data set. As onewould hope, the A4BC contribution quickly falls off in importance relative to 38BC . However, <8G43 does not fall off to the same extent, and stays close to 38BC in size even in the long distance part of the correlator. This is a fundamental problem for the technique. If <8G43 does not fall off quickly, the method is not efficient in terms of the computing costs invested. This would seem to indicate that our guess was incorrect, and the spectra of the distillation and Dirac operators are not similar enough to make\nP o S ( L A T T I C E 2 0 2 1 ) 3 6 3\n(a) E5 (b) A5\nFigure 3: Vector correlator, 38BC by number of distillation modes, 24 sources\n(a) E5 (b) A5\nFigure 4: Vector correlator, f , 160x4 eigenmodes, 24 sources\nthis idea less numerically expensive after all. To show this clearly, plots 3a and 3b graph 38BC , the contribution of the distillation sub-space to the whole correlator on the two data sets for different numbers of distillation modes. At low numbers of modes, 38BC scales linearly with the size of the subspace. But this scaling quickly falls off, and even a computational investment of 1280 distillation modes falls short of the 0.8 mark on both ensembles. The A5 ensemble also exhibits worse scaling overall than E5. We speculate that this is due to the larger size of the physical volume increasing the number of distillation modes below any given threshold [8]. Figures 4a and 4b plot the relative errors f of the total correlators with and without the distillation technique applied, for 160 degenerate distillation modes. As might be expected from the analysis above, there is a factor of about 1\u221a\n2 between the two, which is consistent with reducing\nthe stochastic noise on half of the total correlator to approximately zero, since f = \u221a f2 38BC + f2 \u2212 38BC .\n(5)\nThis means that if the contribution of f \u2212 38BC to the total stochastic error budget simply scaled linearly with the size of \u2212 38BC , one would expect a 1\u221a2 factor for 38BC = 0.5, which is what\nP o S ( L A T T I C E 2 0 2 1 ) 3 6 3\nFigure 5: A5 Pseudoscalar correlator, 38BC by number of distillation modes, 24 sources\nwe observe. Similar results are observed for the pseudoscalar correlator, except that the scaling of 38BC\nwith the number of modes is even more unfavourable. This is pictured in figure 5"
        },
        {
            "heading": "3.1 Computational costs",
            "text": "To compare computational costs, table 2 shows the time needed to calculate the distillation eigenmodeswith Primme, and 38BC withOpenQ*D, on a single configuration, for different numbers of eigenmodes. At low numbers of distillation modes, the computational cost is dominated by the\n#38BC 38BC Dirac solver Lap. solver Lap. solver Ortho. Lap. solver MatVec 20G4 1.18e+02 s 46.3 s 3.5 s 31.1 s 40G4 2.53e+02 s 1.04e+02 s 10.8 s 68.7 s 80G4 4.84e+02 s 2.43e+02 s 41.8 s 1.52e+02 s 160G4 1.12e+03 s 7.77e+02 s 2.51e+02 s 3.46e+02 s 320G4 2.82e+03 s 2.14e+03 s 1.14e+03 s 7.40e+02 s\nTable 2: Computational costs\nDirac solver. However, as the number of modes is increased, the time needed by the Primme Laplacian solver for orthogonalisation increases quadratically. This represents another fundamental obstacle for the technique. Since a very large number of eigenmodes seems needed for 38BC to dominate <8G43 in the correlator, the time needed to solve for all the eigenmodes of the laplacian will eventually scale quadratically with the number of modes, potentially destroying the supposed advantage over normal low-mode-averaging that individual modes take less time to calculate. If we were to use the computation time invested in distillation for additional stochasic sources instead, we would expect\nC # 4 ,; + C# , + 2C'1, = C'0, , (6)\nwhere '1 is the number of stochastic sources with distillation, '0 the number possible for the same cost without distillation, C# , the time required to solver the Dirac equation for the given number\nP o S ( L A T T I C E 2 0 2 1 ) 3 6 3\nof distillation modes # , C', the time required to do the same for the stochastic sources and C # 4 ,; the time required to run the Laplacian solver for the given number of distillation modes # . The factor of 2 reflects the fact that introducing distillation forces us to solve the Dirac equation for the stochastic sources twice, with different preconditionings. Assuming roughly equal time needed to solve the equation for any kind of Dirac source, this implies\n'0 > 2'1 + # , (7)\nsince the relative variance of the correlator scales as\nf 2\n\u221d 1 ' , (8)\nwe would thus need 1 \u2212 38BC\n\u2264 '1 '0 \u2264 '1 2'1 + # = 1 # '1 + 2 , (9)\neven in the limit of assuming the time needed to find the Laplacian modes is negligible, which is clearly not the case.\nIn our existing tests plotted in figures 3a and 3b, this relation is never fulfilled."
        },
        {
            "heading": "4. Conclusion",
            "text": "We conclude that distillation-low-mode-averaging does not seem computationally efficient for the connected vector and pseudoscalar correlators. Contrary to our hopes, the similarity between the low-lying spectra of the spatial Laplacian and the Dirac operator was not strong enough to allow efficiently substituting the eigenmodes of the former for the later. Since the eigenmodes of the spatial Laplacian become more dense at larger lattice volumes, we would expect the efficiency of the technique to fall off further if the physical lattice volume were increased. If the underlying idea of finding a more computationally friendly substitute for the Dirac operator in low-mode-averaging were to be pursued further, a possible next step could be testing operators with a non-trivial spin structure."
        },
        {
            "heading": "5. Acknowledgements",
            "text": "This project has received funding from the European Union\u2019s Horizon 2020 research and innovation programme under theMarie Sk\u0142odowska-Curie grant agreement No 813942. The research of AC, JL and AP is funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) - Projektnummer 417533893/GRK2575 \u201cRethinking Quantum Field Theory\u201d. The work was supported by the North-German Supercomputing Alliance (HLRN) with the project bep00085. The work was supported by the Poznan Supercomputing and Networking Center (PSNC) through grant numbers 450 and 466. The authors acknowledge access to Piz Daint at the Swiss National Supercomputing Centre, Switzerland under the ETHZ\u2019s share with the project IDs go22 and go24. Computations were also performed on the Seagull cluster maintained by the Trinity Centre for High Performance Computing (TCHPC).\nP o S ( L A T T I C E 2 0 2 1 ) 3 6 3"
        }
    ],
    "year": 2021
}