{
    "abstractText": "This study aimed to develop a robust predictive model for tetracycline (TC) adsorption onto biochar (BC) by employing machine learning techniques to investigate the underlying driving factors. Four machine learning algorithms, namely Random Forest (RF), Gradient Boosting Decision Tree (GBDT), eXtreme Gradient Boosting (XGBoost) and Artificial Neural Networks (ANN), were used to model the adsorption of TC on BC using the data from 295 adsorption experiments. The analysis revealed that the RF model had the highest predictive accuracy (R2 = 0.9625) compared to ANN (R2 = 0.9410), GBDT (R2 = 0.9152), and XGBoost (R2 = 0.9592) models. This study revealed that BC with a specific surface area (S (BET)) exceeding 380 cm3\u00b7g\u22121 and particle sizes ranging between 2.5 and 14.0 nm displayed the greatest efficiency in TC adsorption. The TC-to-BC ratio was identified as the most influential factor affecting adsorption efficiency, with a weight of 0.595. The concentration gradient between the adsorbate and adsorbent was demonstrated to be the principal driving force behind TC adsorption by BC. A predictive model was successfully developed to estimate the sorption performance of various types of BC for TC based on their properties, thereby facilitating the selection of appropriate BC for TC wastewater treatment.",
    "authors": [
        {
            "affiliations": [],
            "name": "Pengyan Zhang"
        },
        {
            "affiliations": [],
            "name": "Chong Liu"
        },
        {
            "affiliations": [],
            "name": "Dongqing Lao"
        },
        {
            "affiliations": [],
            "name": "Xuan Cuong Nguyen"
        },
        {
            "affiliations": [],
            "name": "Balasubramanian Paramasivan"
        },
        {
            "affiliations": [],
            "name": "Xiaoyan Qian"
        },
        {
            "affiliations": [],
            "name": "Adejumoke Abosede Inyinbor"
        },
        {
            "affiliations": [],
            "name": "Xuefei Hu"
        },
        {
            "affiliations": [],
            "name": "Yongjun You"
        },
        {
            "affiliations": [],
            "name": "Fayong Li"
        }
    ],
    "id": "SP:3922e2dfedc0b96b5efcdf0536e4588e4ed692bd",
    "references": [
        {
            "authors": [
                "G. Gopal",
                "S.A. Alex",
                "N. Chandrasekaran",
                "A. Mukherjee"
            ],
            "title": "A review on tetracycline removal from aqueous systems by advanced treatment techniques",
            "venue": "RSC Adv",
            "year": 2020
        },
        {
            "authors": [
                "Phoon",
                "B. L"
            ],
            "title": "Conventional and emerging technologies for removal of antibiotics from wastewater",
            "venue": "J. Hazard. Mater",
            "year": 2020
        },
        {
            "authors": [
                "M. Bilal",
                "S. Mehmood",
                "T. Rasheed",
                "Iqbal",
                "H.M. Antibiotics traces in the aquatic environment"
            ],
            "title": "Persistence and adverse environmental impact",
            "venue": "Curr. Opin. Environ. Sci. Health 13, 68\u201374. https:// doi. org/ 10. 1016/j. coesh. 2019. 11. 005",
            "year": 2020
        },
        {
            "authors": [
                "X. Zhang",
                "S. Yan",
                "J. Chen",
                "R. Tyagi",
                "Li",
                "J. 3-Physical",
                "chemical",
                "biological impact (hazard) of hospital wastewater on environment"
            ],
            "title": "Presence of pharmaceuticals, pathogens, and antibiotic-resistance genes",
            "venue": "Biotechnol. Bioeng. https:// doi. org/ 10. 1016/ B978-0- 12- 819722- 6. 00003-1",
            "year": 2020
        },
        {
            "authors": [
                "T Zhu"
            ],
            "title": "Insights into the fate and removal of antibiotics and antibiotic resistance genes using biological wastewater treatment technology",
            "venue": "Sci. Total",
            "year": 2021
        },
        {
            "authors": [
                "Akhil",
                "D. et al. Production",
                "characterization",
                "activation",
                "environmental applications of engineered biochar"
            ],
            "title": "A review",
            "venue": "Environ. Chem. Lett. 19, 2261\u20132297. https:// doi. org/ 10. 1007/ s10311- 020- 01167-7",
            "year": 2021
        },
        {
            "authors": [
                "B. Thangaraj",
                "Solomon",
                "P.R. Immobilization of lipases\u2014A review. Part I"
            ],
            "title": "Enzyme immobilization",
            "venue": "ChemBioEng Rev. 6, 157\u2013166. https:// doi. org/ 10. 1002/ cben. 20190 0016",
            "year": 2019
        },
        {
            "authors": [
                "T Chen"
            ],
            "title": "Sorption of tetracycline on H3PO4 modified biochar derived from rice straw and swine",
            "venue": "manure. Bioresour. Technol",
            "year": 2018
        },
        {
            "authors": [
                "H.M. Jang",
                "E. Kan"
            ],
            "title": "Engineered biochar from agricultural waste for removal of tetracycline in water",
            "venue": "Bioresour. Technol",
            "year": 2019
        },
        {
            "authors": [
                "C Liu"
            ],
            "title": "Response surface methodology for the optimization of the ultrasonic-assisted rhamnolipid treatment of oily sludge",
            "venue": "Arab. J. Chem",
            "year": 2020
        },
        {
            "authors": [
                "X Zhu"
            ],
            "title": "Machine learning for the selection of carbon-based materials for tetracycline and sulfamethoxazole adsorption",
            "venue": "Chem. Eng. J",
            "year": 2020
        },
        {
            "authors": [
                "N Taoufik"
            ],
            "title": "The state of art on the prediction of efficiency and modeling of the processes of pollutants removal based on machine learning",
            "venue": "Sci. Total",
            "year": 2021
        },
        {
            "authors": [
                "L Lijian"
            ],
            "title": "Machine learning predicting wastewater properties of the aqueous phase derived from hydrothermal treatment of biomass",
            "venue": "Bioresour. Technol",
            "year": 2022
        },
        {
            "authors": [
                "Y Yang"
            ],
            "title": "Artificial intelligence-enabled detection and assessment of Parkinson\u2019s disease using nocturnal breathing",
            "venue": "signals. Nat. Med",
            "year": 1932
        },
        {
            "authors": [
                "N. Nguyen",
                "Y. Guo"
            ],
            "title": "Comparisons of sequence labeling algorithms and extensions",
            "venue": "J. ACM. https:// doi",
            "year": 2007
        },
        {
            "authors": [
                "S.K. Kiangala",
                "Z. Wang"
            ],
            "title": "An effective adaptive customization framework for small manufacturing plants using extreme gradient boosting-XGBoost and random forest ensemble learning algorithms in an Industry 4.0 environment",
            "venue": "Mach. Vis. Appl",
            "year": 1016
        },
        {
            "authors": [
                "H.M. Jang",
                "S. Yoo",
                "Choi",
                "Y.-K",
                "S. Park",
                "E. Kan"
            ],
            "title": "Adsorption isotherm, kinetic modeling and mechanism of tetracycline on Pinus taeda-derived activated biochar",
            "venue": "Bioresour. Technol",
            "year": 2018
        },
        {
            "authors": [
                "H Wang"
            ],
            "title": "Sorption of tetracycline on biochar derived from rice straw and swine manure",
            "venue": "RSC. Adv",
            "year": 2018
        },
        {
            "authors": [
                "P. Zhang",
                "Y. Li",
                "Y. Cao",
                "L. Han"
            ],
            "title": "Characteristics of tetracycline adsorption by cow manure biochar prepared at different pyrolysis temperatures",
            "venue": "Bioresour. Technol",
            "year": 2019
        },
        {
            "authors": [
                "Choi",
                "Y.-K"
            ],
            "title": "Adsorption behavior of tetracycline onto Spirulina sp. (microalgae)-derived biochars produced at different temperatures",
            "venue": "Sci. Total",
            "year": 2019
        },
        {
            "authors": [
                "Kim",
                "J. E"
            ],
            "title": "Adsorptive removal of tetracycline from aqueous solution by maple leaf-derived biochar",
            "venue": "Bioresour. Technol",
            "year": 2020
        },
        {
            "authors": [
                "Q Shen"
            ],
            "title": "Removal of tetracycline from an aqueous solution using manganese dioxide modified biochar derived from Chinese herbal medicine residues",
            "venue": "Environ. Res",
            "year": 1016
        },
        {
            "authors": [
                "F Shisuo"
            ],
            "title": "Preparation of tea residue biochar and its removal characteristics of tetracycline in solution",
            "venue": "Environ. Sci. Technol",
            "year": 2020
        },
        {
            "authors": [
                "D Xu"
            ],
            "title": "Application of biochar derived from pyrolysis of waste fiberboard on tetracycline adsorption in aqueous solution",
            "venue": "Front. Chem",
            "year": 2020
        },
        {
            "authors": [
                "Chen",
                "Y. et al. Preparation of Eucommia ulmoides lignin-based high-performance biochar containing sulfonic group"
            ],
            "title": "Synergistic pyrolysis mechanism and tetracycline hydrochloride adsorption",
            "venue": "Bioresour. Technol. 329, 124856. https:// doi. org/ 10. 1016/j. biort ech. 2021. 124856",
            "year": 2021
        },
        {
            "authors": [
                "Z Zheng"
            ],
            "title": "Preparation of mesoporous batatas biochar via soft-template method for high efficiency removal of tetracycline",
            "venue": "Sci. Total",
            "year": 2021
        },
        {
            "authors": [
                "Wilschut",
                "R.A. et al. Combined effects of warming",
                "drought on plant biomass depend on plant woodiness",
                "community type"
            ],
            "title": "A meta-analysis",
            "venue": "Proc. R. Soc. B 289, 20221178. https:// doi. org/ 10. 1098/ rspb. 2022. 1178",
            "year": 2022
        },
        {
            "authors": [
                "X. Zhu",
                "X. Wang",
                "Y.S. Ok"
            ],
            "title": "The application of machine learning methods for prediction of metal sorption onto biochars",
            "venue": "J. Hazard. Mater",
            "year": 1207
        },
        {
            "authors": [
                "S Oh"
            ],
            "title": "Effects of biochar addition on the fate of ciprofloxacin and its associated antibiotic tolerance in an activated sludge microbiome",
            "venue": "Environ. Pollut",
            "year": 1194
        },
        {
            "authors": [
                "Matloob",
                "F. et al. Software defect prediction using ensemble learning"
            ],
            "title": "A systematic literature review",
            "venue": "IEEE. Access 9, 98754\u201398771. https:// doi. org/ 10. 1109/ ACCESS. 2021. 30955 59",
            "year": 2021
        },
        {
            "authors": [
                "J.L. Speiser",
                "M.E. Miller",
                "J. Tooze",
                "E. Ip"
            ],
            "title": "A comparison of random forest variable selection methods for classification prediction modeling",
            "venue": "Expert Syst",
            "year": 2019
        },
        {
            "authors": [
                "C. Persson",
                "P. Bacher",
                "T. Shiga",
                "H. Madsen"
            ],
            "title": "Multi-site solar power forecasting using gradient boosted regression trees",
            "venue": "Sol. Energy",
            "year": 2017
        },
        {
            "authors": [
                "A. Alabdrabalnabi",
                "R. Gautam",
                "S.M. Sarathy"
            ],
            "title": "Machine learning to predict biochar and bio-oil yields from co-pyrolysis of biomass and plastics",
            "venue": "Fuel 328,",
            "year": 1016
        },
        {
            "authors": [
                "X Chen"
            ],
            "title": "Adsorption of copper and zinc by biochars produced from pyrolysis of hardwood and corn straw in aqueous solution",
            "venue": "Bioresour. Technol",
            "year": 2011
        },
        {
            "authors": [
                "H. Chen"
            ],
            "title": "Biogenic silica nanoparticles derived from rice husk biomass and their applications",
            "venue": "Ceram. Int. 41,",
            "year": 2013
        },
        {
            "authors": [
                "J Yu"
            ],
            "title": "Influence of temperature and particle size on structural characteristics of chars from Beechwood pyrolysis",
            "venue": "J. Anal. Appl. Pyrol",
            "year": 2018
        },
        {
            "authors": [
                "Windeatt",
                "J.H. et al. Characteristics of biochars from crop residues"
            ],
            "title": "Potential for carbon sequestration and soil amendment",
            "venue": "J. Environ. Manag. 146, 189\u2013197. https:// doi. org/ 10. 1016/j. jenvm an. 2014. 08. 003",
            "year": 2014
        },
        {
            "authors": [
                "Fang",
                "Y. et al. Concentrated solar thermochemical gasification of biomass"
            ],
            "title": "Principles, applications, and development",
            "venue": "Renew. Sustain. Energy Rev. 150, 111484. https:// doi. org/ 10. 1016/j. rser. 2021. 111484",
            "year": 2021
        },
        {
            "authors": [
                "Eduah",
                "J. O"
            ],
            "title": "Nonlinear sorption of phosphorus onto plant biomass-derived biochars at different pyrolysis temperatures",
            "venue": "Environ. Technol. Innov",
            "year": 2020
        },
        {
            "authors": [
                "M Ahmad"
            ],
            "title": "Trichloroethylene adsorption by pine needle biochars produced at various pyrolysis temperatures",
            "venue": "Bioresour. Technol",
            "year": 2013
        },
        {
            "authors": [
                "Usman",
                "A.R. et al. Biochar production from date palm waste"
            ],
            "title": "Charring temperature induced changes in composition and surface chemistry",
            "venue": "J. Anal. Appl. Pyrol. 115, 392\u2013400. https:// doi. org/ 10. 1016/j. jaap. 2015. 08. 016",
            "year": 2015
        },
        {
            "authors": [
                "Hamza",
                "M. A"
            ],
            "title": "Gaussian process regression and machine learning methods for carbon-based material adsorption",
            "venue": "Adsorp. Sci. Technol",
            "year": 2022
        }
    ],
    "sections": [
        {
            "text": "1 Vol.:(0123456789) Scientific Reports | (2023) 13:11512 | https://doi.org/10.1038/s41598-023-38579-8\nwww.nature.com/scientificreports"
        },
        {
            "heading": "Unveiling the drives",
            "text": "behind tetracycline adsorption capacity with biochar through machine learning Pengyan Zhang 1,2, Chong Liu 1,2, Dongqing Lao 1,3*, Xuan Cuong Nguyen 4,"
        },
        {
            "heading": "Balasubramanian Paramasivan 5, Xiaoyan Qian 1,2, Adejumoke Abosede Inyinbor 6, Xuefei Hu 1,2, Yongjun You 1,2 & Fayong Li 1,2",
            "text": "This study aimed to develop a robust predictive model for tetracycline (TC) adsorption onto biochar (BC) by employing machine learning techniques to investigate the underlying driving factors. Four machine learning algorithms, namely Random Forest (RF), Gradient Boosting Decision Tree (GBDT), eXtreme Gradient Boosting (XGBoost) and Artificial Neural Networks (ANN), were used to model the adsorption of TC on BC using the data from 295 adsorption experiments. The analysis revealed that the RF model had the highest predictive accuracy (R2 = 0.9625) compared to ANN (R2 = 0.9410), GBDT (R2 = 0.9152), and XGBoost (R2 = 0.9592) models. This study revealed that BC with a specific surface area (S (BET)) exceeding 380 cm3\u00b7g\u22121 and particle sizes ranging between 2.5 and 14.0 nm displayed the greatest efficiency in TC adsorption. The TC-to-BC ratio was identified as the most influential factor affecting adsorption efficiency, with a weight of 0.595. The concentration gradient between the adsorbate and adsorbent was demonstrated to be the principal driving force behind TC adsorption by BC. A predictive model was successfully developed to estimate the sorption performance of various types of BC for TC based on their properties, thereby facilitating the selection of appropriate BC for TC wastewater treatment."
        },
        {
            "heading": "Abbreviations",
            "text": "ML Machine learning RF Random forest RMSE Root mean square error PCC Pearson correlation coefficient GBDT Gradient boosting decision tree XGBoost XExtreme gradient boosting D Particle size S (BET) (m2\u00b7g\u22121) Brunauer\u2013Emmett\u2013Teller surface area V (cm3\u00b7g\u22121) Total pore volume C0 (mmol\u00b7g\u22121) Initial concentration ratio of tetracycline to biochar Qe (mg\u00b7g\u22121) Equilibrium adsorption capacity of tetracycline on biochar TC Tetracycline BC Biochar PDP Partial dependence plots C Total carbon in the biochar pH_H2O pH of the biochar in water\nOPEN\n1Key Laboratory of Tarim Oasis Agriculture (Tarim University), Ministry of Education, Xinjiang 843300, China. 2College of Water Resources and Architectural Engineering, Tarim University, Xinjiang 843300, China. 3College of Information Engineering, Tarim University, Xinjiang 843300, China. 4Institution of Research and Development, Duy Tan University, Da Nang 550000, Vietnam. 5Department of Biotechnology and Medical Engineering, National Institute of Technology Rourkela, Odisha, 769008, India. 6Department of Physical Sciences, Industrial Chemistry Programme, Landmark University, Omu-Aran, Kwara State, Nigeria. *email: 120100054@ taru.edu.cn\n2 Vol:.(1234567890) Scientific Reports | (2023) 13:11512 | https://doi.org/10.1038/s41598-023-38579-8\npH_sol Solution pH (O + N)/C Molar ratio of oxygen and nitrogen to carbon H/C Molar ratio of hydrogen to carbon Ash Ash content ANN Artificial neural networks\nTetracycline (TC) is extensively employed as an antimicrobial agent and feed supplement in agriculture and animal husbandry1. However, researchers have recently paid significant attention to the issues of incomplete metabolism and TC emissions2,3. Due to its persistence as an organic pollutant, TC is frequently detected in surface water, groundwater, and drinking water. TC can induce endocrine disruption in target organisms and can also contribute to the dissemination of antibiotic resistance genes, thereby posing serious human health concerns and environmental hazards4,5. Given the inhibitory effect of TC on microorganisms, the removal of TC from water bodies using conventional biological water treatment methods proves challenging6.\nCurrently, the principal methods for treating TC in wastewater include chemical oxidation, biological treatment, and physical removal2. Adsorption, on account of its inherent advantages, such as simplicity, low cost, and high efficiency, is viewed as an excellent technology for the treatment of TC. Among the various adsorbents, biochar (BC) has been extensively researched as an adsorbent for removing pollutants from wastewater due to its unique characteristics, such as a large specific surface area, uniform pore distribution, and high concentration of surface functional groups7.\nThe uptake of tetracycline onto biochar mainly involves physical interactions such as van der Waals forces and hydrogen bonding, as well as chemical reactions including covalent and ionic bonding8. Therefore, the adsorption process primarily depends on the properties of biochar, adsorption conditions, and the ratio of adsorbate to absorbent. Several traditional kinetic and isothermal adsorption models have been extensively evaluated in previous studies9\u201311. Findings suggest that the possible adsorption mechanisms include \u03c0\u2013\u03c0 interactions, electrostatic interactions, and chemisorption. Although a typical controlled-variable experimental approach can determine the relationship between each influencing factor and the amount of sorption within the same framework, traditional batch sorption experiments are time-consuming and inefficient when selecting suitable biochar12. Therefore, there is an urgent need to develop practical tools for predicting adsorption efficiency, optimizing process parameters, and comprehending the adsorption mechanism.\nMachine learning (ML)-assisted modeling has been proposed as a potential approach to reduce the cost and time associated with laboratory contaminant removal processes. Previous research has utilized machine learning (ML) algorithms on selected carbon-based materials to adsorb tetracycline (TC)13,14, yet the accuracy of the models could be enhanced. Zhu et\u00a0al.\u2019s13 study employed carbon-based materials such as activated carbon and biochar, which have distinct compositions. Thus, developing prediction models for both materials represents a significant challenge due to the high variability; in addition, the study has a limited database, and the highest achieved R2 value was only 0.8944, highlighting the necessity to optimize the machine learning (ML) model15,16. This study will also use the results of the machine learning model to explore the driving factors for the adsorption of tetracycline on biochar. To evaluate the prediction effectiveness, generalized adsorption models must be utilized to predict TC adsorption on a single biochar, particularly integrated learning models. Ensemble learning is a typical ML algorithm that integrates the modeling outcomes of all models by building multiple models from the data17. The most typical ensemble learning algorithms used in assessing TC adsorption on biochar include random forest (RF), gradient boosting decision tree (GBDT), and eXtreme gradient boosting (XGBoost)18. In addition to ensemble learning, this study will also incorporate the most popular deep learning algorithms as a point of comparison.\nThe integration of machine learning as an advanced algorithm within the field of environmental remediation employing biochar remains in its nascent stage, considering the widespread occurrence, substantial ecological risk, and unique properties of toxic compounds (TC) in the environment. This research was conducted with the aims of: (i) devising universal machine learning models to forecast the sorption capacity of TC on biochar (BC), contingent on BC attributes and sorption conditions; (ii) investigating the primary factors contributing to BC adsorption of TC; (iii) assessing the impact of various factors on the relative significance of BC sorption capacity and ascertaining the combined effect of each factor on BC sorption capacity; and (iv) constructing an accessible web-based user interface for engineers. The machine learning-driven model devised in this investigation establishes a theoretical foundation for the pragmatic treatment of TC, delivering an all-encompassing comprehension of TC sorption on biochar relative to its features and sorption milieu."
        },
        {
            "heading": "Materials and methods",
            "text": "Cum biochar sorption capacity predictions layout. Experimental data for the adsorption of tetracycline by biochar were collected from ten papers, including 22 biochar species and 295 sets of experimental adsorption data9,19\u201328. Without author bias, the related articles were selected randomly and data were extracted from published papers using Plot Digitizer v3 (https:// plotd igiti zer. com/# downl oad)29. Detailed data are provided in the supplementary materials (Tables\u00a0S1, S2).\nTo predict the sorption capacity of BC for TC, expressed as the equilibrium sorption capacity Qe (mg\u00b7g\u22121), 12 critical factors were considered and divided into three categories: (i) biochar properties: Brunauer\u2013Emmett\u2013Teller surface area [S (BET), m2\u00b7g\u22121], pH of the biochar in water (pH_H2O), total carbon in the biochar (C, w%), molar ratio of oxygen and nitrogen to carbon [(O + N)/C], molar ratio of oxygen to carbon (O/C), molar ratio of hydrogen to carbon (H/C), ash content (Ash, w%), pore volume (V, cm3\u00b7g\u22121), and biochar pore diameter (D, nm); (ii) adsorption conditions: adsorption temperature (T, \u00b0C) and solution pH (pH_sol); and (iii) initial concentration ratio of tetracycline to biochar (C0, mmol\u00b7g\u22121). In the ML section, data not provided in the published paper were\n3 Vol.:(0123456789) Scientific Reports | (2023) 13:11512 | https://doi.org/10.1038/s41598-023-38579-8\nreplaced with K-Nearest Neighbor (KNN) Algorithm, while pH_H2O and ash were missing more often than the other values and was decided to remove them. The TC characteristics are listed in Table\u00a0S3.\nThe following equation was used to obtain C030:\nwhere CTC (mg\u00b7L\u22121) is the initial concentration of TC and CBC (g\u00b7L\u22121) is the initial concentration of BC.\nPre-processing of data. The linear correlation between any two randomly selected variables or between variables and target values was measured using the Pearson correlation coefficient using the following equation30,31:\nwhere x and y denote the mean of variable x or y.\nConstruction of ML models. Ensemble learning\u00a0is a popular machine-learning algorithm that integrates multiple models (base estimators) to form an ensemble estimator that solves complex problems with specific rules17,32. Integrated models act as an integrated platform to automatically manage the weaknesses and enhancements of individual models to achieve higher prediction accuracy. Three integration algorithms exist: bagging, boosting, and stacking.\nRF is a representative bagging integration algorithm and is the most commonly used algorithm for predicting poorly understood processes33. The outcome of an RF prediction is a combination of the predicted outcomes of each decision tree, so the critical step in Random Forest prediction is the formation of a decision tree and a forest. This principle is depicted in Fig.\u00a0S1.\nThe Gradient Boosted Decision Tree (GBDT) algorithm, an iterative decision tree algorithm, consists of multiple decision trees, and the conclusions of all the trees are summed to arrive at the final answer. As shown in Fig.\u00a0S2, the GBDT algorithm uses the negative gradient value of the loss function of the base model in round i as an approximation of the loss value of the base model in that round34. The next step is to construct round i + 1 of base models based on this approximation to make the solution of the objective function more convenient34.\nXGBoost is an improved version of GBDT. It has an engineering goal of pushing the computational power of boosting trees to a limit to achieve fast computation and superior performance35. With many improvements over traditional gradient boosting algorithms, XGBoost can be performed faster than other comprehensive algorithms that use gradient boosting and is recognized as an advanced evaluator with ultrahigh performance in both classification and regression.\nIn this study, Artificial Neural Network (ANN) was utilized due to its ability to simulate the connections and signal propagation between neurons, allowing the adjustment of weights using the backpropagation algorithm to learn patterns and relationships in the data. ANN consists of an input layer, hidden layers, and output layer, making it suitable for various tasks such as prediction, classification, and pattern recognition.\nAll machine-learning algorithm codes were obtained from the open-source Scikit-learn library. All datasets were divided into training and test data at a ratio of 70:30, with the random state set to 40. Tenfold crossvalidation was used to select the best hyperparameters from the data. The test data were used to evaluate model performance. All data were normalized before training. All input and output parameters in this study are listed in Table\u00a0S4.\nModeling performance evaluation. The performance of the model was assessed using the coefficient of determination (R2) and the root mean squared error (RMSE)13,30,35.\nwhere Yexpi and Y pred i are the experimental and predicted values, and Y exp ave is the average of the experimental values."
        },
        {
            "heading": "Results and discussion",
            "text": "Statistical results of biochar characteristics. This study utilized a combination of box plots and normal distribution curves to illustrate the distribution patterns of continuous data (see Fig.\u00a01). The composite plot comprises two sections\u2014the left segment illustrates the box plot, whereas the right segment manifests the normal distribution curve of the data. The box plot depicts the median, signified by a white dot, the interquartile range, denoted by the box, and the whiskers, which represent the remaining data. Outliers are designated by circular points or alternative symbols. The probability density of data at each value is displayed on the right portion of the plot, with elevated values indicating a comparatively higher probability of data occurrence at that point. Please refer to Table\u00a0S5 for specific values.\n(1)C0= CTC/444.4CBC ,\n(2)rxy = \u2211n i=1(xi\u2212x) \u2211n i=1(yi\u2212y) \u221a\n\u2211n i=1(xi\u2212x) 2\n\u221a\n\u2211n i=1(yi\u2212y)\n2 ,\n(3)R2 = 1\u2212 \u2211N i=1\n(\nY exp i \u2212Y pred i\n)2\n\u2211N i=1\n(\nY exp i \u2212Y exp ave\n)2 ,\n(4)RMSE = \u221a\n1 N \u2211N i=1\n(\nY exp i \u2212 Y pred i\n)2\n,\n4 Vol:.(1234567890) Scientific Reports | (2023) 13:11512 | https://doi.org/10.1038/s41598-023-38579-8\nThe majority of biochars exhibit alkalinity in water, a phenomenon predominantly correlated with the depletion of acidic functional groups and an augmentation in aromatic carbon at elevated temperatures, but also linked to the accumulation of alkaline ions such as Na+, Ca2+, K+, and Mg2+ in the biochar30. The mean pH of all biochar samples was 9.14. Nevertheless, a minority displayed weak acidity, which can be accounted for by the incomplete liberation of alkali salts from the biochar matrix at lower pyrolysis temperatures36,37. Given that pH exerts a significant impact on the adsorption of tetracycline onto biochar, the pH of the solution was adjusted using either an acid or a base in all experiments selected for this investigation. Consequently, subsequent analyses will disregard the pH of the biochar in an aqueous solution (pH_H2O) and instead utilize the pH of the solution (pH_sol) during batch adsorption studies.\nAs depicted in Fig.\u00a01, biochar exhibits a high carbon content, with an estimated average of approximately 60% and a maximum value of 92%. Existing research has demonstrated that the carbon content escalates in correlation with increasing pyrolysis temperatures within a specified range20,23,38. Consequently, the pyrolysis process concentrates carbon within the biomass feedstock39,40. The H/C, O/C, and (N + O)/C ratios serve as indicators of aromaticity, hydrophilicity, and polarity indices, respectively39,40. The H/C, O/C, and (N + O)/C ratios indicate the aromaticity, hydrophilicity, and polarity indices, respectively41. A lower H/C ratio in BC corresponds to higher aromaticity; a lower O/C ratio indicates reduced hydrophilicity; and an elevated (N + O)/C ratio signifies increased polarity42,43. The median O/C and H/C ratios were 0.14 and 0.2, respectively. According to the International Biochar Initiative (IBI) Standards, the H/C ratio for biochar should be less than 0.7. Therefore, values exceeding 0.7 in the dataset can be eliminated to enhance the accuracy of biochar data analysis. Nevertheless, Table\u00a0S2 contains only limited data.\nIt has been posited that an increased S (BET) is advantageous for TC adsorption onto biochar, while D and V exhibit minimal direct influence, though an optimal range for each exists. The ash content of biochar samples exhibited a broad range, spanning from 1.50% to 55.27%, attributable to variations in feedstock type and pyrolysis conditions, which alter the physicochemical properties and spatial distribution of organic matter30. However, the role of ash in TC adsorption onto biochar remains a subject of debate.\nFigure\u00a01. Visualization of biochar properties through box plots and normal distribution curves.\n5 Vol.:(0123456789) Scientific Reports | (2023) 13:11512 | https://doi.org/10.1038/s41598-023-38579-8\nStatistical outcomes of data correlation analysis. Figure\u00a02 demonstrates that there exists a significant positive correlation between C0, S (BET), and V with respect to Qe. This relationship can be elucidated by the transfer equation: when the adsorption value remains constant, an increase in the amount of adsorbent leads to a higher adsorption capacity per unit mass of adsorbed material. Research conducted by Wang et\u00a0al., Zhu et\u00a0al., and Kim et\u00a0al.20,23,30 substantiates the connection between S (BET) and Qe, suggesting that an elevated specific surface area permits more adsorbates to be adsorbed per unit mass of the adsorbent. Additionally, a higher number of pores per unit of adsorbent contributes to an increased adsorption capacity, as evidenced by the correlation between V and Qe.\nMoreover, in accordance with prior research findings30, S (BET) displays a positive correlation with carbon content, yet a negative correlation with ash content. This observation implies that elevated carbon content results from the removal of volatile substances, while a higher ash content can cause micropore filling, consequently reducing the surface area6,13. Furthermore, the inverse correlation between S (BET) and D lends support to previous studies suggesting that an increase in S (BET) corresponds to a decrease in D. The correlation coefficient between ash and carbon was \u2212 0.91, and the correlation coefficients between (O + N)/C and O/C were 1. Thus, one variable from each pair must be excluded to prevent collinearity.\nSelection of machine models for tetracycline adsorption on biochar. In order to assess the potential of machine learning in predicting the adsorption of tetracycline on biochar, a tenfold cross-validation was executed to determine hyperparameters. Figure\u00a0 3 depicts the two most significant parameter combinations,\nFigure\u00a02. Correlation coefficients and corresponding significant levels.\n6 Vol:.(1234567890) Scientific Reports | (2023) 13:11512 | https://doi.org/10.1038/s41598-023-38579-8\n\u2018n_estimators\u2019 and \u2018max_depth\u2019 (\u2018hidden layer\u2019 and \u2018learning rate\u2019) with the color on the surface model representing the model\u2019s performance quality. The redder the color, the higher the model\u2019s accuracy, as per the hyperparameter selection principle. The parameters selected in this study were determined to be equal to or greater than the threshold value of two.\nAs shown in Table\u00a0S4, the highest mean R2 value of 0.9625 was achieved by Random Forest (RF), followed by XGBoost at 0.9592, while Gradient Boosted Decision Trees (GBDT), had the lowest score of 0.9152, and the artificial neural network (ANN) had the second-to-last score of 0.9410. The RMSE values for RF, GBDT, ANN, and XGBoost were 18.02, 25.97, 22.42, and 20.99, respectively. As illustrated in Fig.\u00a04, both the training and test sets exhibited R2 and RMSE values of 0.9703, 0.9625, and 14.91, and 18.02, respectively, for RF and XGBoost. The model did not appear to be overfitted. Although XGBoost is generally regarded as the superior model, in this study, RF outperformed XGBoost. One possible explanation is that the results were influenced by the features and the nature of the problem. Therefore, while XGBoost is among the better models, it may not always be the optimal choice, exemplifying the \u201cno free lunch theorem\u201d.\nAccording to Fig.\u00a03, the predicted values for all data ranged from 0 to 350\u00a0mmol\u00b7g\u22121. The RMSE of the RF model (18.02\u00a0mmol\u00b7g\u22121) accounted for 0.0542 of the predicted range (0 to 350\u00a0mmol\u00b7g\u22121), indicating a high level of accuracy. Combining the accuracy of R2 and RMSE, the RF model was selected for subsequent analysis since it provided higher accuracy than the XGDT and XGBoost models. The best parameters for each model are listed in Table\u00a0S4.\nFeature importance analysis. This section is based on the RF model. Feature importance analysis serves as a potent instrument for discerning the relevance of input features in target prediction. Employing machine learning to comprehend tetracycline (TC) adsorption on biochar (BC) can substantially curtail the time-consuming and costly experimental design process by leveraging feature importance to select a limited number of features for model training, thereby reducing time and cost while enhancing accuracy44,45. Although machine learning models are formidable tools for generating precise predictions, they frequently function as \u201cblack box\u201d models, rendering the comprehension of their inner mechanisms and decision-making processes arduous. Nev-\nFigure\u00a03. Schematic illustration of hyperparameter selection (a RF, b GBDT, c XGBoost, d ANN).\n7 Vol.:(0123456789) Scientific Reports | (2023) 13:11512 | https://doi.org/10.1038/s41598-023-38579-8\nertheless, feature importance analysis offers an efficacious approach for pinpointing the most crucial input variables in a model and comprehending their contributions to the output.\nA primary advantage of employing SHAP (SHapley Additive exPlanations) for feature importance analysis is its ability to furnish a visual representation of each feature\u2019s contribution to the output prediction. Figure\u00a05a exhibits a SHAP feature importance visualization, supplying an in-depth dissection of the weight and influence\nFigure\u00a04. Scatter plot of RF-model-predicted adsorption values and experimental data (a training data, b testing data).\nFigure\u00a05. Relative importance of input variables on sorption capacity using SHAP (a SHAP value; b feature importance).\n8 Vol:.(1234567890) Scientific Reports | (2023) 13:11512 | https://doi.org/10.1038/s41598-023-38579-8\nexerted by each input feature on the predicted outcome. This information can be harnessed to identify vital control parameters, optimize the experimental design process, and bolster model accuracy.\nFigure\u00a05b displays the specific values of feature importance derived from SHAP. The results suggest that C0 (0.695) is the most critical factor affecting Qe, signifying that BC\u2019s adsorption capacity for TC predominantly depends on the TC-to-BC ratio. This phenomenon, referred to as the value transfer process, implies that the concentration gradient between the adsorbate and the adsorbent constitutes the principal driving force for TC adsorption by BC.\nIn examining the biochar characteristics, surface area (S (BET)), (O + N)/C, and H/C ratios displayed notably significant effects (0.162, 0.036, and 0.032, respectively), suggesting that S (BET) is the most crucial factor influencing biochar\u2019s adsorption properties. It can be deduced that the sites provided by S (BET) also play a vital role as driving factors in the adsorption of target compounds (TC) by biochar (BC). Concerning adsorption conditions, temperature (T) and pH_sol contributed to 0.14 and 0.06 of the characteristic importance, respectively. The impact of each factor on Qe is discussed in \u201cAnalysis of partial dependence plots (PDP)\u201d section.\nAnalysis of partial dependence plots (PDP). Figure\u00a0 6(A1) presents the single-factor PDP, which reveals a partial dependence of the initial concentration (C0) on the equilibrium adsorption capacity (Qe), demonstrating an initial increase in the adsorption rate followed by stabilization. This trend can be attributed to the gradual filling of adsorption sites on the biochar surface as the relative content of TC increases. Upon reaching C0 = 2\u00a0mmol\u00b7g\u22121, the adsorption sites on the biochar surface become fully occupied, resulting in maximum adsorption capacity. The saturation of adsorption sites limits any further increase in the removal rate. These findings highlight the critical role of biochar surface area and capacity in effective pollutant removal21.\nBiochar\u2019s adsorption efficacy is contingent upon its specific surface area (S (BET)). As depicted in Fig.\u00a06(A2), a rapid rise in adsorption capacity is observed, followed by a gradual increase. The enhancement in the number of sorption sites with an increase in S (BET) leads to a higher sorption uptake capacity of biochar. Nonetheless, the adsorption efficacy of biochar is constrained by other factors, such as the initial concentration of the target compound (C0), when there is a certain increase in the number of adsorption sites20,21. S (BET) predominantly affects the driving force of chemisorption occurring between BC and TC. A larger S (BET) results in a more significant number of chemisorption sites, thus leading to higher adsorption efficiency. Furthermore, the indirect influence of biochar\u2019s specific surface area on physical adsorption should not be overlooked. The adsorption of the target compound (TC) on biochar is the result of various driving forces. Based on Fig.\u00a06(A2), it can be inferred that biochar with an S (BET) greater than 380 cm3\u00b7g\u22121 offers superior adsorption efficiency.\nThe distribution of tetracycline (TC) species is influenced by the pH value. Table\u00a0S3 presents the dissociation constants (pKas) of TC as 3.3, 7.7, and 9.7. Within the pH range of 2\u20133.3, TC+ is the predominant form of TC; at pH 3.3\u20137.7, TC0 is prevalent; at pH 7.7\u20139.7, TC\u2212 dominates, and at pH above 9.7, TC converts to TC2\u2212. Figure\u00a05(B1) illustrates that the adsorption of TC on biochar (BC) is most favorable when the solution pH (pH_sol) is approximately 5.5. Intriguingly, these findings contradict a report by Ref.21, which posited that biochar and tetracycline primarily undergo electrostatic adsorption. Despite the biochar\u2019s negative charge, it assumed a positive charge when the pH ranged between 3 and 3.3. Figure\u00a06(A3) indicates that, in addition to electrostatic adsorption, hydrogen bonding and \u03c0\u2013\u03c0 electron donor\u2013acceptor interactions influence TC adsorption on biochar19\u201321.\nThe adsorption efficacy of biochar is also partially dependent on the D value. Figure\u00a06(B2) indicates that adsorption efficiency increases, stabilizes, and then significantly decreases. Biochar with a D value of 2.5\u201314.0\u00a0nm demonstrates a higher tendency to adsorb TC. Nonetheless, this change is insignificant when compared to other factors. This study affirms the findings of Zhang et\u00a0al.21 that the adsorption performance of adsorbents is optimal when the molecular size of the adsorbent\u2019s D is 1.7\u20133.0 times larger than that of the adsorbate. However, these outcomes should be interpreted with caution.\nData for this investigation were gathered at temperatures between 15 and 40\u00a0\u00b0C (Fig.\u00a06(C1)), with temperature fluctuations displaying minor, partially dependent variations from 15 to 35\u00a0\u00b0C. The adsorption efficiency\u2019s partial dependence on temperature increases substantially within a higher temperature range of 35\u201340\u00a0\u00b0C, which aligns with previous findings that the adsorption process is thermodynamically favorable at elevated temperatures6,24,25. This phenomenon may be attributed to the diffusion of TC and enhanced interfacial chemistry.\nThe adsorption efficiency\u2019s partial dependence on the chemical composition factors C, H/C, and (O + N)/C is relatively insignificant (Fig.\u00a06(C2\u2013D2)) and exhibits considerably less variation compared to changes in other factors. Consequently, this aspect will not be further explored in the present study.\nA two-factor analysis was also employed to investigate the impact on TC adsorption, a representative depiction of which is provided in Fig.\u00a07. (i) At a fixed specific surface area (S (BET)), the partial dependence increases with initial concentration (C0) and tends to stabilize when C0 > 2\u00a0mmol\u00b7g\u22121. (ii) The effect of pH_sol was less pronounced when comparing the partial dependences of C0 and pH_sol. (iii) At a fixed C0, the partial dependence tends to rise sharply when the temperature exceeds 35\u00a0\u00b0C.\nSignificance and drawbacks of this study. The investigation of biochar preparation for tetracycline (TC) adsorption employing cost-effective biomass has recently emerged as a focal point of research, owing to its robust capacity to eliminate organic contaminants from aqueous media. Typically, controlled-variable experimental methodologies are employed to ascertain factors such as material characteristics and adsorption conditions. Nonetheless, conventional batch experiments are labor-intensive, expensive, and lack generalizability. In this study, Random Forest (RF) was demonstrated as a beneficial machine learning (ML) instrument for predicting the quantity of TC adsorbed by biochar, thereby showcasing its potential to directly forecast experimental outcomes based on pre-established conditions. Moreover, discerning the most crucial factors impacting TC sorption and their influence on the process offers invaluable insights for selecting or devising TC removal tech-\n9 Vol.:(0123456789) Scientific Reports | (2023) 13:11512 | https://doi.org/10.1038/s41598-023-38579-8\nniques. Consequently, the requisite number of experiments can be considerably diminished, and the exploration of biochar (BC) applications for TC adsorption can be markedly expedited.\nThis research revealed that the RF algorithm provides a reasonable prediction of TC adsorption quantities by biochar. However, the predictive performance of ML was hindered by data imbalance and scarcity, and several considerations must be addressed. The data utilized for model training solely predicted the sorption of TC by biochar, without accounting for the sorption of other antibiotics by the same material.\nFigure\u00a06. The PDP of TC adsorption on significant variables (spikes on the x-axis represent data density).\n10\nVol:.(1234567890)\nScientific Reports | (2023) 13:11512 | https://doi.org/10.1038/s41598-023-38579-8"
        },
        {
            "heading": "Conclusion",
            "text": "This study successfully established a model for biochar adsorption of tetracycline (TC) using a comprehensive learning-based approach. The principal findings are as follows:\n(1) The Random Forest (RF) algorithm proved to be an accurate and effective predictor of TC adsorption by biochar (BC), achieving a coefficient of determination (R2) value of 0.9625, slightly outperforming the GBDT, ANN, and XGBoost algorithms. (2) The ratio of tetracycline to biochar significantly influenced the sorption process, with a weight of 0.595. (3) The primary driving force for the adsorption of TC by BC is the concentration gradient between the adsorbate and the adsorbent. (4) Biochar with initial concentration (C0) greater than 2\u00a0mmol\u00b7g\u22121, specific surface area (S (BET)) exceeding\n380 cm3\u00b7g\u22121, and adsorbent diameter (D) ranging from 2.5 to 14.0\u00a0nm exhibited the highest propensity for adsorbing TC.\nThe model developed in this study has significant implications for minimizing redundant experimentation and facilitating the selection of appropriate biochar. Moreover, it will guide the proper application of biochar in tetracycline wastewater treatment technologies."
        },
        {
            "heading": "Data availability",
            "text": "All data generated or analysed during this study are included in this published article and its Supplementary Information files.\nFigure\u00a07. Bivariate PDP of TC adsorption on any two significant input variables and the interaction between the two variables.\n11\nVol.:(0123456789)\nScientific Reports | (2023) 13:11512 | https://doi.org/10.1038/s41598-023-38579-8\nReceived: 5 April 2023; Accepted: 11 July 2023"
        },
        {
            "heading": "Acknowledgements",
            "text": "The authors thank all our colleagues and students involved in this study for their unremitting efforts. They thank Editage for the providing language help. They also thank anonymous reviewers for their comments and suggestions."
        },
        {
            "heading": "Author contributions",
            "text": "P.Z.: experiments, data analysis, writing. C.L.: experiments, data analysis, writing. D.L.: data analysis, project funding. X.Q., X.H. and Y.Y.: writing, reviewing and editing. L.F.: project management, funding acquisition, writing, review and editing. X.C.N., B.P. and A.A.I.: review and guidance."
        },
        {
            "heading": "Funding",
            "text": "This work was supported by the President\u2019s Foundation of Tarim University (TDZKSS202152; TDZKSS202156; TDZKCQ202002), Bingtuan Science and Technology Program (2021DB019; 2022CB001-01). National Natural Science Foundation of China (42275014)."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Supplementary Information The online version contains supplementary material available at https:// doi. org/ 10. 1038/ s41598- 023- 38579-8.\nCorrespondence and requests for materials should be addressed to D.L.\nReprints and permissions information is available at www.nature.com/reprints.\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or\nformat, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http:// creat iveco mmons. org/ licen ses/ by/4. 0/.\n\u00a9 The Author(s) 2023"
        }
    ],
    "title": "Unveiling the drives behind tetracycline adsorption capacity with biochar through machine learning",
    "year": 2023
}