{
    "authors": [
        {
            "affiliations": [],
            "name": "Chong Liu"
        },
        {
            "affiliations": [],
            "name": "Kai Chang"
        },
        {
            "affiliations": [],
            "name": "Ke Zou"
        }
    ],
    "id": "SP:22406ac749291dae468f840ced4994d85fdaebb7",
    "references": [],
    "sections": [
        {
            "text": "Realistic simulation of reflection high-energy\nelectron diffraction patterns for two-dimensional\nlattices using Ewald construction\nRunning title: Simulation of RHEED patterns using Ewald construction Running Authors: Liu et al."
        },
        {
            "heading": "Chong Liu,1,2,a) Kai Chang,1 and Ke Zou2,3",
            "text": "1Beijing Academy of Quantum Information Sciences, Beijing 100193, China 2Quantum Matter Institute, University of British Columbia, Vancouver, British Columbia V6T 1Z4, Canada 3Department of Physics & Astronomy, University of British Columbia, Vancouver, British Columbia V6T 1Z1, Canada\na)Electronic mail: liuchong@baqis.ac.cn\nReflection high-energy electron diffraction (RHEED) is a powerful tool for characterizing crystal surface structures. However, the setup geometry leads to distorted and complicated patterns, which are not straightforward to link to the real-space structures. A program with a graphical user interface is provided here to simulate the RHEED patterns. Following the Ewald construction in the kinematic theory, we find out the exact geometric transformation in this model that determines the positions of diffraction spots. The program can deal with many forms of surface structures, including surface reconstructions or domains. The simulations exhibit great agreement with the experimental results in various cases. This program will benefit the structure analysis in thin film growth and surface science studies.\nI. INTRODUCTION\nReflection high-energy electron diffraction (RHEED) is a widely used technique in\nvacuum systems for thin-film growth such as molecular beam epitaxy (MBE) and pulsed laser deposition (PLD). The incident electron beam with the energy of 10\u2013100 keV comes to the crystal surface at a grazing angle and the forward scattering electrons are detected on a screen. It provides information about the surface crystal structure, flatness, domains, phase separation, film growth mode, layer period and so on.1 For the single scattering process, the RHEED pattern can be viewed as a projection of the reciprocal lattice, yet heavily distorted due to the grazing geometry. As a result, it is difficult to extract the lattice structure immediately from the experimental data.2 In practice, one usually needs simulation of candidate structures to predict or compare with the actual RHEED results.\nSimulating the RHEED pattern is relatively complicated and could be CPU costly\nfor computers. As a compromise, for instance, a previous approach had to simplify the Ewald sphere as a plane.3 Consequently, the simulation only captured the diffractions in the zeroth Laue zone and displayed as long streaks in contrast to spotted patterns as they should be. It is necessary to preserve the Ewald sphere in the model, essentially taking the complete reciprocal array into account, to properly reflect the detailed lattice structure and the more complicated reconstructions and domains. In this article, we provide an opensource program that utilizes the exact Ewald construction and accomplishes realistic RHEED simulation for two-dimensional (2D) crystal surfaces. Written in Wolfram Mathematica, the program has a graphical user interface (GUI) and is time-efficient on personal computers (see supplementary material at [URL will be inserted by AIP Publishing] for the program, source code and Manual). The core theoretical model and potential applications will be displayed."
        },
        {
            "heading": "II. EXPERIMENT",
            "text": "The experimental data were acquired with a RHEED gun from STAIB Instruments,\ninstalled on a Veeco GenXplor MBE system. The beam energy was 10 keV, the emission current was 0.2 \u03bcA and the grazing angle was around 2.5\u00b0. The MgO film was grown on a\nMgO(001) substrate at 600\u00b0C by depositing Mg atoms at the oxygen pressure of 1.2 \u00d7 10\u2013\n6 Torr. The Ge(111) substrate was etched in 20% HCl solution for 20 minutes and then loaded in the MBE chamber. After annealing at 490\u00b0C in vacuum for 30 minutes, Ge atoms\nwere deposited on the substrate until clear RHEED patterns were obtained. SrTiO3(001) substrate was etched in boiled water for 1 hour and 10% HCl for 45 minutes, and then annealed in a tube furnace in flowing oxygen gas at 1120\u00b0C for 4 hours. After loading in\nthe MBE chamber, it was degassed at 620\u00b0C for 30 minutes to obtain the clean surface."
        },
        {
            "heading": "III. THEORETICAL MODEL",
            "text": ""
        },
        {
            "heading": "A. Ewald construction",
            "text": "The kinematic theory of the RHEED has been well established.4,5 Considering a 2D\nlattice in the x-y plane whose primitive cell is described by basis vectors a and b, the corresponding reciprocal vectors are\n\ud835\udc1a\u2217 = 2\ud835\udf0b \ud835\udc1b\u00d7?\u0302?\n|\ud835\udc1a\u00d7\ud835\udc1b| (1)\n\ud835\udc1b\u2217 = 2\ud835\udf0b \ud835\udc1a\u00d7?\u0302?\n|\ud835\udc1a\u00d7\ud835\udc1b| (2)\nwhere ?\u0302? is the unit vector normal to the lattice plane. A reciprocal vector is obtained as\n\ud835\udc06(\u210e\ud835\udc58) = \u210e\ud835\udc1a\u2217 + \ud835\udc58\ud835\udc1b\u2217. (3)\nh and k are Miller indices.\nFor elastic scattering, energy conservation requires |\ud835\udc8cd| = |\ud835\udc8c0|, where \ud835\udc8c0 and \ud835\udc8cd\nare the wave vectors of the incident and diffracted beam, respectively. Hence, the end of any possible \ud835\udc8cd falls on a sphere in the reciprocal space with the radius equal to |\ud835\udc8c0|, which is called Ewald sphere, as shown in Figure 1. Furthermore, based on the Laue condition, the diffraction must satisfy\n\u0394\ud835\udc8c\u2225 = \ud835\udc8cd \u2225 \u2212 \ud835\udc8c0 \u2225 = \ud835\udc06. (4)\nThe 2D reciprocal lattice extends along the z direction continuously, known as\nreciprocal rods. If we place the tip of \ud835\udc8c0 on one of the rods, according to Eq. (4), \ud835\udc8cd should also lie on the rods. Then the intersection of the Ewald sphere and reciprocal rods determine which diffraction angles are allowed. The diffracted beams in those angles shoot on a screen that is perpendicular to the lattice plane, forming the RHEED patterns.\nWith the Ewald construction as illustrated in Fig.1, the diffraction process becomes\na geometrical problem: a two-step projection of the reciprocal array from the x-y plane to\nthe Ewald sphere and then to the xd-yd plane on the screen. 6 Accordingly, we have derived the coordinate transformation:\n\ud835\udc65 = \ud835\udc580\ud835\udc65d\n\u221a\ud835\udc512+\ud835\udc65d 2+\ud835\udc66d\n2 (5)\n\ud835\udc66 = \ud835\udc580 (\u2212 \ud835\udc51\n\u221a\ud835\udc512+\ud835\udc65d 2+\ud835\udc66d\n2 + cos\ud835\udf03), (6)\nwhere d is the distance between the sample and the screen and \u03b8 is the grazing angle of the incident beam. This transformation is the key operation in the model and the code, which guarantees realistic simulations of RHEED patterns."
        },
        {
            "heading": "B. STRUCTURE FACTOR",
            "text": "The Ewald construction determines the position of the diffracted spots while the\nstructure factor determines the intensity of each diffraction. In most real crystals, there are multiple atoms in the unit cell, and the interference between them will modulate the intensity of the diffracted beam. The structure factor is obtained as\n\ud835\udc39(\ud835\udc6e) = \u2211 \ud835\udc53\ud835\udc5a \u2219 \ud835\udc52 \ud835\udc56\ud835\udc6e\u2219\ud835\udc93\ud835\udc5a \ud835\udc5a , (7)\nwhere \ud835\udc53\ud835\udc5a is the electron scattering factor for the atom, 7 \ud835\udc93\ud835\udc5a is the position of the atom and the sum is over all atoms in the unit cell. The diffraction intensity is \ud835\udc3c(\ud835\udc6e) = |\ud835\udc39(\ud835\udc6e)|2.\nIn experiments, the reciprocal rods are broadened due to finite coherence length\nand finite domain size. We use 2D Gaussian function with the intensity proportional to \ud835\udc3c(\ud835\udc6e) to model the intensity distribution of every reciprocal rod.\nIV. PROGRAM STURCTURE\nThe program runs in the following workflow: (1) Create single or multiple lattices based on the user\u2019s settings. Assign two basis\nvectors to each lattice.\n(2) From user-input coordinates of the basis vectors, calculate the reciprocal basis\nvectors and generate a reciprocal array \ud835\udc6e(\u210e\ud835\udc58) [Eqs. (1)-(3)]. If an azimuthal rotation is required, then a rotational transformation is applied to all vectors.\n(3) From user-input \ud835\udc93\ud835\udc5a and \ud835\udc53\ud835\udc5a , calculate the diffraction intensity \ud835\udc3c(\u210e\ud835\udc58) =\n|\ud835\udc39(\u210e\ud835\udc58)|2 based on Eq. (7).\n(4) Create a 2D intensity distribution function \ud835\udc3f(\ud835\udc65, \ud835\udc66) in the x-y plane by summing\nup 2D Gaussian functions centered at every \ud835\udc6e(\u210e\ud835\udc58) with intensity \ud835\udc3c(\u210e\ud835\udc58) . If multiple superposed lattices are defined in the beginning, their \ud835\udc3f(\ud835\udc65, \ud835\udc66) maps are calculated independently and summed up. The map of \ud835\udc3f(\ud835\udc65, \ud835\udc66) is approximately a simulation of low energy electron diffraction (LEED) pattern.\n(5) Apply broadening along x and y directions of the Gaussian functions at all\n\ud835\udc6e(\u210e\ud835\udc58). Transform the intensity map \ud835\udc3f(\ud835\udc65, \ud835\udc66) to the (\ud835\udc65d, \ud835\udc66d) coordinates by Eqs. (5)-(6). The resulting map is plotted as the simulation of the RHEED pattern."
        },
        {
            "heading": "V. APPLICATIONS AND DISCUSSION",
            "text": "The program contains a GUI for fully interacting operations. Besides the lattice\nstructures, many experimental parameters are free to customize, such as beam energy, incident angle, sample azimuth, spot broadening and overall intensity. Furthermore, it supports multiple sets of lattices in a single simulation, so that the simulation can cover more complicated cases in practice, including reconstruction, phase separation and\nrotational domains. For instruction on the use of the program, refer to the Manual in the supplementary material at [URL will be inserted by AIP Publishing].\nHere we display various examples to demonstrate the capability and flexibility of\nthe program. The input parameters for all examples are displayed in Table S1 in the supplementary material at [URL will be inserted by AIP Publishing].\nFor some crystals, the structure factors could vanish for certain Miller indices,\nleading to zero intensity. MgO has a face-centered cubic (fcc) structure. The condition to have non-zero diffraction intensity is that the Miller indices are all odd or all even. As shown in Figs. 2(a, b), the (00), (20) and (11) diffractions are visible while (10) is missing. Our simulations give the same results [Figs. 2(c, d)] when considering the structure factors.\nAn atomically flat surface often has reconstructions. Fig. 3(a) is the RHEED pattern\nof Ge(111) surface. One can tell from the half-order diffraction spots that the surface is reconstructed, but it\u2019s insufficient to pin down the exact reconstruction type since the image only contains one row of the reciprocal lattice.8 By rotating the sample azimuth, the reciprocal rods are scanned over by the Ewald sphere (Fig. 1), thus the full structure information could be reflected in RHEED. A correct model should reproduce the diffraction exclusively for arbitrary azimuth angles such as that in Fig. 3(b). We create a hexagonal lattice overlaid with a 2\u00d72 lattice in our program. The simulation results [Figs. 3(c, d)] agree with the experimental ones very well. To verify the uniqueness of the explanation, we also create and simulate 2\u00d71 and 2\u00d73 reconstructions for these angels (see Fig. S1 in supplementary material at [URL will be inserted by AIP Publishing]). Although all 2\u00d7n reconstructions possess similar half-order diffractions in the 0th Laue zone in \u232911\u03050\u232a\ndirection, they are distinguished by the number of spots in the intermediate Laue zones, which are better manifested in the asymmetric angle at \u232911\u03050\u232a + 15\u00b0 . Hence, the experimental phase is unambiguously proved to be 2\u00d72 reconstruction, which usually occupies small partial areas on the Ge(111) surface 9 unless it is stabilized by highly dense steps.10,11 This testing shows that the program works for any incident directions and hence is useful for recognizing uncommon surface structures.\nThe multi-lattice functionality makes it suitable for modelling domains. The \u221a13 \u00d7\n\u221a13 reconstruction of SrTiO3(001) has a large supercell that is not aligned with the original 1\u00d71 lattice. The supercell rotates 33.7\u00b0 or \u221233.7\u00b0 with respect to the 1\u00d71 lattice with equal probability, forming domains that induce complex patterns in the RHEED [Fig. 4(a)].12 Based on the aforementioned two rotated lattices, our program yields a decent simulation for the reconstruction, which gives a 2D map including the full spot arrays in the intermediate Laue zones [Fig. 4(b)]. Every single spot is reproduced at the exact position, exhibiting high precision of the simulation.\nWith such good performance of the program, it will be able to determine unknown\nreconstruction types in a definite way. Despite the complication in calculation and visualization, the evaluation of this simulation only costs a few seconds on a personal computer (see supplementary material at [URL will be inserted by AIP Publishing] for information of testing system and running time). A similar example yielded by the same algorithm has been involved in previous research work.13 In the same way, it also works for domains consisting of multiple phases or rotations.14\nThis program only considers 2D layer meshes, which represent well for most flat\nsurfaces, as has been demonstrated above, since the number of penetrating elastic electrons decays exponentially with increasing depth. Still, this simplification will miss some fine features that originate from multiple-layer diffraction, finite coherent area, islands, steps, defects and disorders. Three-dimensional models and interlayer interference might be included in future updates. More features, although more challenging, remain to be modeled, such as Kikuchi lines that are caused by multiple scatterings of the electrons.\nApplying machine learning on RHEED data is a rising trend in surface and thin-\nfilm sciences.15-18 One potential application of this program is to generate predictive RHEED images for machine learning codes. For instance, a large number of various artificial RHEED images can be generated to feed into training for a neural network, which can then be used for data identification or classification."
        },
        {
            "heading": "VI. CONCLUSIONS",
            "text": "In summary, we developed a program to realize the simulation of RHEED patterns\nof 2D crystal surfaces. Based strictly on the Ewald construction, the algorithm works for single crystal, reconstructions and multiple domains. Most experimental parameters are taken into account so that the best agreement can be achieved. With both high performance and efficiency, the program will enhance the power of RHEED technique and have wide application in research."
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "The authors thank Bruce Davidson at UBC for the discussions on the principles of\nRHEED. This work was undertaken, thanks in part to funding from the Max Planck-UBCUTokyo Centre for Quantum Materials and the Canada First Research Excellence Fund, Quantum Materials and Future Technologies Program. The work at UBC was also supported by the Natural Sciences and Engineering Research Council of Canada (NSERC) and the Canada Foundation for Innovation (CFI). K. C. acknowledges the funding from National Natural Science Foundation of China under Grant No. 12074038 and No. 92165104."
        },
        {
            "heading": "AUTHOR DECLARATIONS",
            "text": ""
        },
        {
            "heading": "Conflict of Interest",
            "text": "The authors have no conflicts to disclose."
        },
        {
            "heading": "DATA AVAILABILITY",
            "text": "The data that supports the findings of this study are available within the article and\nits supplementary material."
        },
        {
            "heading": "Supplementary Material for",
            "text": "Realistic simulation of reflection high-energy electron diffraction\npatterns for two-dimensional lattices using Ewald construction\nChong Liu,1,2,a) Kai Chang,1 and Ke Zou2,3\n1Beijing Academy of Quantum Information Sciences, Beijing 100193, China 2Quantum Matter Institute, University of British Columbia, Vancouver, British Columbia V6T 1Z4, Canada 3Department of Physics & Astronomy, University of British Columbia, Vancouver, British Columbia V6T 1Z1, Canada a)Electronic mail: liuchong@baqis.ac.cn\nTABLE S1. Input parameters for the simulations displayed in main text.\nMgO(001) Ge(111)-(2\u00d72) STO(001)-(\u221a \u00d7 \u221a )\nNumber of lattices 1 2 2\nLattice base vectors:\n(x1,y1), (x2,y2) (1,0), (0,1)\n(\u221a3/2,-1/2), (0,1) (2,3), (3,-2)\n(\u221a3,-1), (0,2) (3,2), (2,-3)\nStructure factors:\n(ra,rb,f)\n(0,0,1) (0,0,1) (0,0,1)\n(0.5,0.5,1)\nLattice unit (\u00c5) 4.2 4 3.9 Grazing angle (\u00b0) 3 3 2.6\nRotation (\u00b0) <100>: 0\n<110>: 45\n<11 0>: 0\n<11 0>+15\u00b0: 15 <100>: 0\nBeam E (keV) 10 10 10\nBroaden x, y 1, 1.5 1, 1 0.8, 0.7\nFIG. S1. (a, b) Simulated patterns of 2\u00d71 reconstructed Ge(111) surface with the incident beam along \u232911 0\u232a direction and 15\u00b0 azimuth from \u232911 0\u232a direction, respectively. (c, d) Simulated patterns of 2\u00d73 reconstructed Ge(111) surface with the incident beam along \u232911 0\u232a direction and 15\u00b0 azimuth from \u232911 0\u232a direction, respectively."
        },
        {
            "heading": "Running time tests",
            "text": "The code running time increases with increasing number of lattices and reciprocal spots in the plotting range. Taking the most complicated case in this article, \u221a13 \u00d7 \u221a13 reconstruction of STO(001), as an example, the computer system information and testing results are as following. CPU: Intel(R) Core\u2122 i5-10210U CPU @ 1.60GHz RAM: 16 GB, 2133 MHz Operation system: Windows 11 Open up main program interface: 1.0 second Update reciprocal lattice plot: 9.1 seconds (For preview only. Unnecessary for RHEED simulation) Generate RHEED simulation and display in a new window: 7.7 seconds Update the simulation after changing parameters: 2.9 seconds"
        }
    ],
    "title": "Realistic simulation of reflection high-energy electron diffraction patterns for two-dimensional lattices using Ewald construction",
    "year": 2022
}