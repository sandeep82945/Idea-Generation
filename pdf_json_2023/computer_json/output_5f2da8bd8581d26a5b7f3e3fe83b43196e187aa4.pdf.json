{
    "abstractText": "Mathias Kraus FAU Erlangen-N\u00fcrnberg, Lange Gasse 20, 90403 N\u00fcrnberg, Germany, mathias.kraus@fau.de, Stefan Feuerriegel Munich Center for Machine Learning & LMU Munich, Geschwister-Scholl-Platz 1, 80539 Munich, Germany, feuerriegel@lmu.de, Maytal Saar-Tsechansky Department of Information, Risk and Operations Management, McCombs School of Business, University of Texas at Austin, 2110 Speedway, B6000 Austin, TX 78712, USA, maytal@mail.utexas.edu,",
    "authors": [
        {
            "affiliations": [],
            "name": "Mathias Kraus"
        },
        {
            "affiliations": [],
            "name": "Stefan Feuerriegel"
        },
        {
            "affiliations": [],
            "name": "Maytal Saar-Tsechansky"
        }
    ],
    "id": "SP:e4f918bb056ed8340674035654da5e951337823f",
    "references": [
        {
            "authors": [
                "A Abbasi",
                "AS Sahlqvist",
                "L Lotta",
                "JM Brosnan",
                "P Vollenweider",
                "P Giabbanelli",
                "DJ Nunez"
            ],
            "title": "2016) A systematic review of biomarkers and risk of incident type 2 diabetes: An overview of epidemiological, prediction and aetiological research literature",
            "venue": "PLOS ONE 11(10):e0163721",
            "year": 2016
        },
        {
            "authors": [
                "A Allam",
                "S Feuerriegel",
                "M Rebhan",
                "M Krauthammer"
            ],
            "title": "Analyzing patient trajectories with artificial intelligence",
            "venue": "Journal of Medical Internet Research 23(12):e29812",
            "year": 2021
        },
        {
            "authors": [
                "E Ascarza"
            ],
            "title": "Retention futility: Targeting high-risk customers might be ineffective",
            "venue": "Journal of Marketing Research",
            "year": 2018
        },
        {
            "authors": [
                "MUS Ayvaci",
                "ME Ahsen",
                "S Raghunathan",
                "Z Gharibi"
            ],
            "title": "Timing the use of breast cancer risk information in biopsy decision-making. Production and Operations Management 26(7):1333\u20131358",
            "year": 2017
        },
        {
            "authors": [
                "MUS Ayvaci",
                "O Alagoz",
                "ES Burnside"
            ],
            "title": "The effect of budgetary restrictions on breast cancer diagnostic decisions. Manufacturing & Service Operations Management 14(4):600\u2013617",
            "year": 2012
        },
        {
            "authors": [
                "KR Azelton",
                "AP Crowley",
                "N Vence",
                "K Underwood",
                "G Morris",
                "J Kelly",
                "MJ Landry"
            ],
            "title": "Digital health coaching",
            "year": 2021
        },
        {
            "authors": [
                "I Bardhan",
                "JH Oh",
                "Z Zheng",
                "K Kirksey"
            ],
            "title": "diabetes: Randomized controlled trial of healthy at home. Frontiers in Digital Health",
            "year": 2015
        },
        {
            "authors": [
                "D Bertsimas",
                "A O\u2019Hair",
                "S Relyea",
                "J Silberholz"
            ],
            "title": "An analytics approach to designing combination chemother",
            "year": 2016
        },
        {
            "authors": [
                "I Bica",
                "AM Alaa",
                "C Lambert",
                "M van der Schaar"
            ],
            "title": "apy regimens for cancer",
            "venue": "Management Science",
            "year": 2021
        },
        {
            "authors": [
                "M Bjarnadottir",
                "D Anderson",
                "L Zia",
                "K Rhoads"
            ],
            "title": "Pharmacology & Therapeutics",
            "year": 2018
        },
        {
            "authors": [
                "PR Breeze",
                "C Thomas",
                "H Squires",
                "A Brennan",
                "C Greaves",
                "PJ Diggle",
                "E Brunner"
            ],
            "title": "The impact of type",
            "year": 2017
        },
        {
            "authors": [
                "M Cevik",
                "T Ayer",
                "O Alagoz",
                "BL Sprague"
            ],
            "title": "A cost-effectiveness analysis. Diabetic Medicine 34(5):632\u2013640",
            "venue": "Breiman L",
            "year": 2001
        },
        {
            "authors": [
                "L Chaker",
                "S Ligthart",
                "TI Korevaar",
                "A Hofman",
                "OH Franco",
                "RP Peeters",
                "A Dehghan"
            ],
            "title": "Production and Operations Management",
            "year": 2016
        },
        {
            "authors": [
                "NV Chawla",
                "KW Bowyer",
                "LO Hall",
                "WP Kegelmeyer"
            ],
            "title": "risk of type 2 diabetes: A population-based prospective cohort study",
            "venue": "BMC Medicine",
            "year": 2002
        },
        {
            "authors": [
                "E Choi",
                "A Schuetz",
                "WF Stewart",
                "J Sun"
            ],
            "title": "Nature Reviews Endocrinology",
            "year": 2017
        },
        {
            "authors": [
                "JT Cohen",
                "PJ Neumann",
                "MC Weinstein"
            ],
            "title": "Statistical Society: Series B (Statistical Methodology",
            "year": 2008
        },
        {
            "authors": [
                "presidential candidates"
            ],
            "title": "The New England Journal of Medicine 358(7):661\u2013663",
            "venue": "Cuesta JI, Noton C, Vatter B",
            "year": 2019
        },
        {
            "authors": [
                "T Dai",
                "S Tayur"
            ],
            "title": "Healthcare operations management: A snapshot of emerging research",
            "year": 2020
        },
        {
            "authors": [
                "M De-Arteaga",
                "S Feuerriegel",
                "M Saar-Tsechansky"
            ],
            "title": "Algorithmic fairness in business analytics: Directions",
            "venue": "Service Operations Management",
            "year": 2022
        },
        {
            "authors": [
                "D Frauen",
                "T Hatt",
                "V Melnychuk",
                "S Feuerriegel"
            ],
            "title": "Estimating average causal effects from patient",
            "venue": "surveillance. Manufacturing & Service Operations Management",
            "year": 2023
        },
        {
            "authors": [
                "T Garg",
                "M Bhardwaj",
                "S Deo"
            ],
            "title": "Role of community health workers in improving cost efficiency in an active",
            "year": 2020
        },
        {
            "authors": [
                "LS Geiss",
                "C James",
                "EW Gregg",
                "A Albright",
                "DF Williamson",
                "CC Cowie"
            ],
            "title": "Diabetes risk reduction behaviors",
            "year": 2010
        },
        {
            "authors": [
                "MR Gold",
                "JE Siegel",
                "MC Weinstein",
                "LB Russell"
            ],
            "title": "Cost-effectiveness in health and medicine",
            "year": 1996
        },
        {
            "authors": [
                "S Gu",
                "Z Tang",
                "L Shi",
                "M Sawhney",
                "H Hu",
                "H Dong"
            ],
            "title": "Cost-minimization analysis of metformin and acarbose in treatment of type 2 diabetes",
            "venue": "Value in Health Regional Issues",
            "year": 2015
        },
        {
            "authors": [
                "R Guo",
                "L Cheng",
                "J Li",
                "PR Hahn",
                "H Liu"
            ],
            "title": "A survey of learning causality with data: Problems and methods",
            "venue": "ACM Computing Surveys",
            "year": 2020
        },
        {
            "authors": [
                "T Hastie",
                "R Tibshirani",
                "JH Friedman"
            ],
            "title": "The elements of statistical learning: Data mining, inference, and prediction (New York NY: Springer), 2nd edition",
            "year": 2009
        },
        {
            "authors": [
                "JE Helm",
                "S AhmadBeygi",
                "MP van Oyen"
            ],
            "title": "Design and analysis of hospital admission control for operational effectiveness. Production and Operations Management 20(3):359\u2013374",
            "year": 2011
        },
        {
            "authors": [
                "JE Helm",
                "A Alaeddini",
                "JM Stauffer",
                "KM Bretthauer",
                "TA Skolarus"
            ],
            "title": "Reducing hospital readmissions by integrating empirical prediction with resource optimization",
            "venue": "Production and Operations Management",
            "year": 2016
        },
        {
            "authors": [
                "AE Hoerl",
                "RW Kennard"
            ],
            "title": "Ridge regression: Biased estimation for nonorthogonal problems",
            "year": 1970
        },
        {
            "authors": [
                "R Ibrahim",
                "B Kucukyazici",
                "V Verter",
                "M Gendreau",
                "M Blostein"
            ],
            "title": "Designing personalized treatment: An application to anticoagulation therapy. Production and Operations Management 25(5):902\u2013918",
            "year": 2016
        },
        {
            "authors": [
                "GW Imbens",
                "DB Rubin"
            ],
            "title": "Causal inference in statistics, social, and biomedical sciences (New York, NY",
            "year": 2015
        },
        {
            "authors": [
                "J Jakubik",
                "S Feuerriegel"
            ],
            "title": "Data-driven allocation of development aid toward Sustainable Development Goals: Evidence from HIV/AIDS. Production and Operations Management 31(6):2739\u20132756",
            "year": 2022
        },
        {
            "authors": [
                "HS Kahn",
                "YJ Cheng",
                "TJ Thompson",
                "G Imperatore",
                "EW Gregg"
            ],
            "title": "Two risk-scoring systems for predicting incident diabetes mellitus in U.S. adults age 45 to 64 years",
            "venue": "Annals of Internal Medicine",
            "year": 2009
        },
        {
            "authors": [
                "H Kamalzadeh",
                "V Ahuja",
                "M Hahsler",
                "ME Bowen"
            ],
            "title": "An analytics-driven approach for optimal individualized diabetes screening. Production and Operations Management 30(9):3161\u20133191",
            "year": 2021
        },
        {
            "authors": [
                "DS KC",
                "S Scholtes",
                "C Terwiesch"
            ],
            "title": "Empirical research in healthcare operations: Past research, present understanding, and future opportunities. Manufacturing & Service Operations Management 22(1):73\u201383",
            "year": 2020
        },
        {
            "authors": [
                "A Khademi",
                "DR Saure",
                "AJ Schaefer",
                "RS Braithwaite",
                "MS Roberts"
            ],
            "title": "The price of nonabandonment: HIV",
            "year": 2015
        },
        {
            "authors": [
                "HK Koh",
                "KG Sebelius"
            ],
            "title": "Promoting prevention through the affordable care act",
            "year": 2010
        },
        {
            "authors": [
                "Y LeCun",
                "Y Bengio",
                "G Hinton"
            ],
            "title": "Deep learning. Nature",
            "year": 2015
        },
        {
            "authors": [
                "X Liu",
                "M Hu",
                "JE Helm",
                "MS Lavieri",
                "TA Skolarus"
            ],
            "title": "Missed opportunities in preventing hospital readmissions",
            "venue": "Diabetes",
            "year": 2018
        },
        {
            "authors": [
                "SM Lundberg",
                "SI Lee"
            ],
            "title": "A unified approach to interpreting model predictions",
            "venue": "Endocrinology",
            "year": 2017
        },
        {
            "authors": [
                "JH May",
                "WE Spangler",
                "DP Strum",
                "LG Vargas"
            ],
            "title": "The surgical scheduling problem: Current research",
            "year": 2011
        },
        {
            "authors": [
                "B Paulweber",
                "P Valensi",
                "J Lindstr\u00f6m",
                "NM Lalic",
                "CJ Greaves",
                "M McKee",
                "K Kissimova-Skarbek"
            ],
            "title": "A European evidence-based guideline for the prevention of type 2 diabetes",
            "venue": "Hormone and Metabolic Research",
            "year": 2010
        },
        {
            "authors": [
                "LC Rosella",
                "DG Manuel",
                "C Burchill",
                "TA Stukel"
            ],
            "title": "A population-based risk algorithm for the development of diabetes: Development and validation of the diabetes population risk tool DPoRT",
            "venue": "Journal of Epidemiology and Community Health 65(7):613\u2013620",
            "year": 2011
        },
        {
            "authors": [
                "DB Rubin"
            ],
            "title": "Causal inference using potential outcomes: Design, modeling, decisions",
            "venue": "Journal of the American Statistical Association",
            "year": 2005
        },
        {
            "authors": [
                "S Schallmoser",
                "T Zueger",
                "M Kraus",
                "M Saar-Tsechansky",
                "C Stettler",
                "S Feuerriegel"
            ],
            "title": "Machine learning for predicting micro-and macrovascular complications in individuals with prediabetes or diabetes: Retrospective cohort study",
            "venue": "Journal of Medical Internet Research 25:e42181",
            "year": 2023
        },
        {
            "authors": [
                "J Senoner",
                "T Netland",
                "S Feuerriegel"
            ],
            "title": "Using explainable artificial intelligence to improve process quality: Evidence from semiconductor manufacturing",
            "venue": "Management Science",
            "year": 2022
        },
        {
            "authors": [
                "C Shi",
                "D Blei",
                "V Veitch"
            ],
            "title": "Adapting neural networks for the estimation of treatment effects",
            "venue": "Advances in Neural Information Processing Systems",
            "year": 2019
        },
        {
            "authors": [
                "K Tachkov",
                "K Mitov",
                "Y Koleva",
                "Z Mitkova",
                "M Kamusheva",
                "M Dimitrova",
                "V Petkova"
            ],
            "title": "Life expectancy and survival analysis of patients with diabetes compared to the non diabetic population in Bulgaria",
            "venue": "PLOS ONE 15(5):e0232815",
            "year": 2020
        },
        {
            "authors": [
                "R Tibshirani"
            ],
            "title": "Regression shrinkage and selection via the lasso",
            "venue": "Journal of the Royal Statistical Society",
            "year": 1996
        },
        {
            "authors": [
                "MJ van der Laan",
                "D Rubin"
            ],
            "title": "Targeted maximum likelihood learning",
            "venue": "The International Journal of Biostatistics",
            "year": 2006
        },
        {
            "authors": [
                "S Wager",
                "S Athey"
            ],
            "title": "Estimation and inference of heterogeneous treatment effects using random forests",
            "venue": "Journal of the American Statistical Association",
            "year": 2018
        },
        {
            "authors": [
                "PWF Wilson",
                "JB Meigs",
                "L Sullivan",
                "CS Fox",
                "DM Nathan",
                "RB D\u2019Agostino"
            ],
            "title": "Prediction of incident diabetes mellitus in middle-aged adults: The Framingham offspring study",
            "venue": "Archives of Internal Medicine",
            "year": 2007
        },
        {
            "authors": [
                "DJ Zhang",
                "I Gurvich",
                "JA Van Mieghem",
                "E Park"
            ],
            "title": "Young RS, Williams MV (2016) Hospital readmissions reduction program: An economic and operational analysis",
            "venue": "Management Science",
            "year": 2016
        },
        {
            "authors": [
                "X Zhou",
                "KR Siegel",
                "BP Ng",
                "S Jawanda",
                "KK Proia",
                "X Zhang",
                "AL Albright"
            ],
            "title": "Cost-effectiveness of diabetes prevention interventions targeting high-risk individuals and whole populations: A systematic review. Diabetes Care 43(7):1593\u20131616",
            "year": 2020
        },
        {
            "authors": [
                "T Zueger",
                "S Schallmoser",
                "M Kraus",
                "M Saar-Tsechansky",
                "S Feuerriegel",
                "C Stettler"
            ],
            "title": "Machine learning for predicting the risk of transition from prediabetes to diabetes",
            "venue": "Diabetes Technology & Therapeutics",
            "year": 2022
        },
        {
            "authors": [
                "Glaeser"
            ],
            "title": "We now provide empirical evidence supporting this choice. For this purpose, we compare the performance of our decision model under different machine learning models in stage 2 while the rest of the decision model remains the same. Our comparison includes linear (lasso and ridge regression) and nonlinear (random forest and deep neural network) models. All estimation details are provided in Supplement G",
            "venue": "Senoner et al",
            "year": 2019
        },
        {
            "authors": [
                "Cinelli",
                "Hazlett"
            ],
            "title": "2020) and use a linear regression. Informed by clinical research (e.g., the Framingham risk score), we use a linear regression with the following patient variables, i.e., y= treatment+ age+ sex+weight+ body mass index+ systolic bp+ diastolic bp+height",
            "year": 2020
        },
        {
            "authors": [
                "Chaker"
            ],
            "title": "The height and weight of the patient are also among the ten most important predictors, yet with less importance. This is likely due to the fact that the predictive power of these variables as individual predictors is limited, and only their combination (as in the BMI) leads to an important predictor",
            "year": 2016
        }
    ],
    "sections": [
        {
            "text": "Accepted by Manufacturing & Service Operations Management manuscript MSOM-21-251\nData-Driven Allocation of Preventive Care With Application to Diabetes Mellitus Type II\nMathias Kraus FAU Erlangen-Nu\u0308rnberg, Lange Gasse 20, 90403 Nu\u0308rnberg, Germany, mathias.kraus@fau.de,\nStefan Feuerriegel Munich Center for Machine Learning & LMU Munich, Geschwister-Scholl-Platz 1, 80539 Munich, Germany, feuerriegel@lmu.de,\nMaytal Saar-Tsechansky Department of Information, Risk and Operations Management, McCombs School of Business, University of Texas at Austin, 2110\nSpeedway, B6000 Austin, TX 78712, USA, maytal@mail.utexas.edu,\nProblem Definition. Increasing costs of healthcare highlight the importance of effective disease prevention.\nHowever, decision models for allocating preventive care are lacking.\nMethodology/Results. In this paper, we develop a data-driven decision model for determining a cost-\neffective allocation of preventive treatments to patients at risk. Specifically, we combine counterfactual\ninference, machine learning, and optimization techniques to build a scalable decision model that can exploit\nhigh-dimensional medical data, such as the data found in modern electronic health records. Our decision\nmodel is evaluated based on electronic health records from 89,191 prediabetic patients. We compare the\nallocation of preventive treatments (metformin) prescribed by our data-driven decision model with that of\ncurrent practice. We find that if our approach is applied to the U. S. population, it can yield annual savings\nof $1.1 billion. Finally, we analyze the cost-effectiveness under varying budget levels.\nManagerial Implications. Our work supports decision-making in health management, with the goal of\nachieving effective disease prevention at lower costs. Importantly, our decision model is generic and can thus\nbe used for effective allocation of preventive care for other preventable diseases.\nKey words : preventive care; disease prevention; healthcare analytics; machine learning\nHistory :"
        },
        {
            "heading": "1. Introduction",
            "text": "Millions of people die each year of diseases that could have been prevented. Common examples of preventable diseases include certain infectious diseases, such as human immunodeficiency virus (HIV); respiratory diseases, such as pneumonia; and cardiovascular diseases, such as diabetes mellitus. Over one quarter of all deaths in OECD countries are premature and could have been avoided through better preventive efforts (OECD 2019). Furthermore, the prevalence of preventable diseases is likely to rise\n1\nar X\niv :2\n30 8.\n06 95\n9v 1\n[ cs\n.L G\n] 1\n4 A\nug 2\n02 3\nas a result of current lifestyle choices (World Health Organization 2018c). Preventable diseases reduce individuals\u2019 quality of life and also entail substantial costs. The cost of treating preventable diseases in the United States now totals $730.4 billion annually, which corresponds to 27.0% of total healthcare spending (Bolnick et al. 2020).\nPreventive care aims at managing risk factors before the onset of a disease (World Health Organization 2018b). A prominent example of preventive care for diabetes mellitus type II is metformin, which is a preventive drug aimed at controlling impaired glucose tolerance (Knowler et al. 2002). However, many effective preventive treatments are often costly, and the effectiveness varies by risk factors (Zhou et al. 2020). Consequently, healthcare managers face the challenge of cost-effective allocation of potentially limited or costly preventive treatments to patients. Indeed, with the growing importance of preventive care, effective allocation is essential in improving the quality of lives of billions of people worldwide. However, decision models for informing allocations in preventive care are lacking.\nPrior research has considered decision support for health management with the goal of achieving effective healthcare at lower costs. For instance, research has proposed optimizing periodic checkups (e. g., Ayvaci et al. 2012, 2017, Kamalzadeh et al. 2021, Liu et al. 2018), as well as the selection of treatment designs (e. g., Ibrahim et al. 2016). However, these works use generative models that are computationally prohibitive in the analysis of high-dimensional data to accurately predict future disease onsets. In contrast, discriminative machine learning models effectively scale to large datasets involving millions of observations and thousands of variables (e. g., Choi et al. 2017), which is common in modern healthcare settings. However, these models have not been adapted for allocation problems among patient populations in preventive care; this adaption is the objective of our work.\nOur work contributes to health management by proposing a data-driven decision model that provides decision support for allocation problems in preventive care. For this aim, we combine counterfactual inference, machine learning, and optimization techniques to exploit high-dimensional medical data from electronic health records (EHRs). To our knowledge, this work contributes along three paths: (i) we propose a data-driven decision model for allocating preventive treatments; (ii) we demonstrate the value of scalable machine learning from rich, high-dimensional data in electronic health records for preventive care; and (iii) we establish the (cost-)effectiveness of data-driven allocations.\nWe evaluate our decision model for allocating preventive treatments for the case of diabetes mellitus type II. Diabetes is a chronic disease that can significantly reduce patients\u2019 quality of life and that comes with substantial long-term costs to treat its many complications (Lee et al. 2018). For our evaluation, we use EHRs from 89,191 patients with a prediabetic condition and analyze the allocation of preventive care in a dynamic setting spanning a period of 10 years. A simple, yet effective preventive\ntreatment for diabetes type II is metformin. However, applying metformin comes at a cost, thus raising the question of what a cost-effective allocation is in practice. We compare our decision model for preventive care allocation against a clinical baseline that stratifies preventive care according to the Framingham diabetes risk score. We find that our decision model prevents over 25% more cases of diabetes mellitus type II. Further, we find that, if our approach is applied to the U. S. population, it can yield annual savings of $1.1 billion because of a more effective allocation.\nOur decision model is directly relevant for healthcare organizations aimed at allocating preventive care under resource constraints. This is the case for vertically integrated healthcare organizations (IHOs) worldwide, where hospitals and health insurances exchange patient data with the aim of achieving better coordination, efficiency, and quality of care for patients (World Health Organization 2016). Examples of countries with IHOs are Israel, Singapore, many European countries, and partially the U. S. through health maintenance organizations (World Health Organization 2016).\nOur work promises to have a direct effect on both practice and research. For healthcare practice, our research demonstrates that using a data-driven decision model based on scalable machine learning and EHRs can substantially improve the performance of preventive care programs and reduce the risk of disease onset. As such, our decision model supports health management in primary preventive care by offering a cost-effective path toward reduced health-related spending while improving patients\u2019 outcomes and quality of life. For research, our new decision model, incorporating counterfactual inference, offers a widely applicable solution for allocation problems in preventive care and for other allocation problems that require data-driven approaches in management science.\nThe remainder of our paper is structured as follows. Section 2 provides an overview of preventive care, revealing a scarcity of decision models for this purpose. Section 3 details our research setting, which focuses on allocating preventive treatments to patients at risk of developing diabetes mellitus type II. In Section 4, we develop our data-driven decision model, combining counterfactual inference, machine learning, and optimization techniques to determine a cost-effective allocation of preventive care to patients at risk. We report our empirical results in Section 5. Finally, we discuss implications of our work for health management in Section 6."
        },
        {
            "heading": "2. Background",
            "text": "Our work builds on literature in the fields of preventive care, machine learning, counterfactual inference, and resource allocation in health management. We review this work in the following sections."
        },
        {
            "heading": "2.1. Preventive Care",
            "text": "Preventive care refers to measures taken to reduce people\u2019s risk of developing a disease or suffering from a severe course of illness. Preventive care can be divided into three categories: primary prevention,\nsecondary prevention, and tertiary prevention (Goetzel 2009). Primary prevention aims at averting the onset of a disease altogether. Examples include vaccines, smoking cessation, weight loss, and other measures that address risk factors through the promotion of good health (World Health Organization 2018c). Secondary prevention focuses on the early stages of a disease after its onset. Here, the objective is to prevent a disease from developing into a critical or acute condition. Such approaches include screening (e. g., mammography) and other forms of early diagnosis. Tertiary prevention targets the progression associated with the disease. Here, the aim is to reduce the severity of symptoms. Examples include mental, physical, and social rehabilitation, such as in cardiac rehabilitation programs. In this work, we focus on primary prevention\u2014specifically, on preventing patients from developing diabetes mellitus type II.\nPreventive care can be a valuable economic investment; when it is provided early to patients, it can reduce the need for more expensive treatment after the onset of an illness (World Health Organization 2018b). Of note, the main aim in preventive care is to improve the health benefit for patients. Hence, optimization is measured against the overall health outcomes relative to costs, rather than against cost minimization alone, for ethical and legal reasons (see Gold et al. (1996), National Institute for Health and Care Excellence (2015), and World Health Organization (2018b)). However, not all patients provided with preventive care would necessarily have developed the disease in question. Given this premise, the cost-effectiveness of preventive care depends on two factors: (1) the expected number of people for whom diseases could be prevented relative to the population at risk and (2) the cost of providing preventive treatments. Preventive treatments, such as metformin, can have low costeffectiveness in cases where only a very small proportion of the population would have become ill without preventive care (Cohen et al. 2008). In this case, targeting patients who are at high risk of developing a disease and for whom there is a large differential effectiveness of preventive efforts could potentially improve the overall cost-effectiveness.\nPrevious research has assessed the cost-effectiveness of preventive care by comparing different preventive treatments or by comparing a preventive treatment against a placebo group (e. g., Breeze et al. 2017, Cohen et al. 2008, Zhou et al. 2020); but in these cases, the allocation rule was ex ante given and thus not the focus of the study. For instance, in the context of prediabetic patients, the cost-effectiveness of preventive care (here, lifestyle coaching) was studied by allocating the preventive treatment to patients aged 40\u201365, with a body mass index (BMI) higher than 35 and with blood glucose higher than 6% (Breeze et al. 2017). However, the allocation rule used to determine when a prediabetic patient would receive the preventive care was devised by expert assessments and was not optimized through rigorous modeling. To fill this void, our work proposes a data-driven decision model."
        },
        {
            "heading": "2.2. Machine Learning in Health Management",
            "text": "Machine learning is widely used to predict health outcomes and to adapt the decision-making in health management accordingly. Given the extensive body of research, we provide only a short summary in the following paragraphs and point toward Keskinocak and Savva (2020) for a detailed overview. In health operations, predictions make widespread use of EHRs as input. EHRs have emerged as part of the recent digitalization of healthcare operations (KC et al. 2020); they encode a digital version of a patient\u2019s health trajectory, including a variety of risk variables, such as socio-demographics, body measurements (e. g., blood pressure), lab measurements, disease codes, and drug prescriptions. As a result, EHRs allow researchers to describe between-patient heterogeneity in health outcomes and, thereby, also enable a personalized view of a patient\u2019s individualized risk profile. Based on EHRs, health management can then predict different health outcomes. Examples of outcomes include the 30-day readmission risk as a performance indicator in hospital operations (e. g., Bardhan et al. 2015), mortality (e. g., Bjarnadottir et al. 2018), the onset of a disease (Choi et al. 2017), or complications (e. g., Schallmoser et al. 2023). In this work, we use machine learning for predicting a patient\u2019s risk of developing diabetes mellitus type II.\nTo predict the onset of diseases, research has used a variety of machine learning methods (e. g., Allam et al. 2021, Bertsimas et al. 2016, Zueger et al. 2022). Examples include lasso (Tibshirani 1996), ridge regression (Hoerl and Kennard 1970), random forests (Breiman 2001), neural networks (LeCun et al. 2015), and gradient boosted decision trees (Friedman 2001). Throughout this work, we use gradient boosted decision trees as our main model because this machine learning model has shown promising results in other management applications (e. g., Glaeser et al. 2019, Senoner et al. 2022). We later assess other machine learning methods as part of a sensitivity analysis."
        },
        {
            "heading": "2.3. Counterfactual Inference in Health Management",
            "text": "In health management, counterfactual inference is used to estimate the effects of different treatment options on health outcomes. Such estimates, in turn, inform the treatment choice, so that the treatment with the best expected effect on a patient\u2019s trajectory is chosen (Bica et al. 2021). The gold standard for estimating treatment effects is a randomized controlled trial, although it also has several shortcomings (Imbens and Rubin 2015). First, treatment effects may vary across patient populations, meaning that randomized controlled trials must be tailored to the patient population of interest. Second, randomized controlled trials are costly. Because of the immense upfront costs, performing such trials was not a viable course of action for our partnering IHO. Third, randomized controlled trials typically build on only two (or very few) treatment arms. As such, the estimated treatment effects typically are population-wide averages, with little personalization. Recent works (e. g., Bica et al. 2021) offer a remedy for these\nshortcomings by using machine learning for estimating treatment effects from observational data, such as EHRs.\nPrevious works in counterfactual inference have pursued varying objectives (Guo et al. 2020). On the one hand are studies that make inferences at the group level and thus estimate average treatment effects (e.g., Frauen et al. 2023a, van der Laan and Rubin 2006, Shi et al. 2019). On the other hand are studies that estimate heterogeneous treatment effects based on a patient\u2019s risk score (Bica et al. 2021). Here, the assumption is that there is no global treatment effect of similar size for all patients but a differential treatment effectiveness\u2014that is a heterogeneous treatment effect that varies across patients. As such, these studies may consider heterogeneous treatment effects related to, for instance, age, sex, or other risk scores. In the case of diabetes, preventive treatments such as metformin are known to have a differential effectiveness (Knowler et al. 2002). Thus, in our work, we use counterfactual inference to estimate heterogeneous treatment effects of metformin from EHRs.\nWe build on a recent method called causal forest (Wager and Athey 2018). The causal forest is a non-parametric method that extends the widely used random forest algorithm, by Breiman (2001), for estimating heterogeneous treatment effects. Causal forests inherit several favorable properties from random forests in that they are expressive, require little tuning, and have a low risk of overfitting, thus offering a robust performance in practice. Further, under common mathematical assumptions, causal forests have been shown to be pointwise consistent for the true treatment effect and thus lead to provably valid inferences (Wager and Athey 2018)."
        },
        {
            "heading": "2.4. Resource Allocation in Health Management",
            "text": "Research on health management examines allocation problems related to various resources. For an overview, we refer to Dai and Tayur (2020) and Keskinocak and Savva (2020). Examples include beds (e. g., Helm et al. 2011), drugs (Khademi et al. 2015), aid (Jakubik and Feuerriegel 2022), and medical devices (Deo and Sohoni 2015). Other studies have used data-driven modeling for scheduling the admission of patients, so that available resources are used effectively but without exceeding surge capacities (e. g., May et al. 2011). Importantly, such problems generally optimize allocations according to patient needs (rather than focusing only on monetary aspects), so that providing (cost-)effective care is intended to improve patient health and not only to minimize costs. Analogously, we also focus on (cost-)effective care.\nAllocation decisions have been extensively modeled in the context of secondary prevention, with the goal of optimizing screening or check-up policies. Examples include biopsy referral (Ayvaci et al. 2017), colonoscopy screening (Erenay et al. 2014), mammography (Cevik et al. 2018), and post-discharge monitoring (Helm et al. 2016, Liu et al. 2018). In this work, the main question is the optimal timing\nfor patient examinations (Kamalzadeh et al. 2021). Therefore, Markov decision processes or variants thereof typically are used in which (i) decisions for an individual patient are made and (ii) where states represent the patient\u2019s current health status. However, our problem setup for primary preventive care is different in both aspects: (i) decisions are made for a cross-sectional sample (i.e., determining which patients out of a cohort should be selected for treatment), and (ii) the future health trajectory should be used for decision-making, which requires machine learning models for prediction.\nEthical and legal frameworks around the world mandate whom to allocate treatments, including preventive treatments, given scarce resources (e. g., National Institute for Health and Care Excellence 2015). Accordingly, the core principle for health management is to focus on the best health benefit for patients, relative to the estimated costs, as opposed to prioritizing cost minimization alone. Hence, decisions in medicine are mainly benchmarked according to their cost-effectiveness (Gold et al. 1996): Decision models should optimize against the largest improvement in health outcomes, given budget constraints (typically set by policymakers or healthcare organizations)."
        },
        {
            "heading": "3. Research Setting",
            "text": ""
        },
        {
            "heading": "3.1. The Case of Diabetes Prevention",
            "text": "Our research aims at allocation of preventive care to patients at risk of developing diabetes mellitus type II. Diabetes mellitus is a chronic condition and, although widespread, is often preventable. In the United States, 88 million adults, or 34.5% of the adult population, are classified as prediabetic and thus at risk of developing diabetes if it is not prevented (U.S. Centers for Disease Control and Prevention 2020). According to the World Health Organization (2018a), diabetes mellitus not only is among the top 10 leading causes of death, but also can seriously imped the quality of life for patients in the long run. However, the risk of diabetes mellitus can be effectively mitigated with preventive treatments, including the drug metformin (Knowler et al. 2002). Once metformin has been prescribed and then taken for diabetes prevention, patients generally must remain on the medication for the rest of their lives.\nIn this research, we partnered with a national health insurer from Israel serving more than 1.1 million patients. In Israel, health insurers are vertically integrated healthcare organizations, which enables our partnering health insurer to have direct access to a wealth of medical data from EHRs, as well as to work collaboratively with healthcare providers to deliver care to patients. We later discuss the applicability of our model to vertically integrated healthcare organizations from other countries (see Section 6) and, for that reason, refer to our partner company simply as IHO.\nOur IHO has set a goal of improving primary preventive care for patients at risk of developing diabetes mellitus type II to mitigate individuals\u2019 risk of onset. For this, we develop and evaluate a data-driven allocation of preventive care using metformin. Formally, the IHO is confronted by a\ndecision-making problem: which of its patients i= 1, . . . ,N should be enrolled in preventive treatment (ti = 1) and which ones should not (ti = 0)? If patient i is enrolled in preventive care, her risk of developing diabetes is reduced by a treatment effect, which we later estimate from historical EHRs. However, the IHO has limited the overall budget available for preventive care to k\u2264N treatments.\nFor primary prevention, the objective is to find a cost-effective allocation\u2014that is, to maximize the number of prevented disease onsets, given a particular budget (World Health Organization 2018b). As with other research in health management (e. g., Ayvaci et al. 2012, Helm et al. 2011, 2016), the question is how to offer effective care at lower costs and thus to allocate resources for improving patient outcomes (as opposed to a goal of pure cost minimization, without considering health outcomes). Therefore, the objective in our work is to identify an allocation of preventive treatments to patients that maximizes the expected number of prevented onsets. To support the IHO in this task, we develop a data-driven decision model.\nIn addition to looking at the number of prevented disease onsets, we also report costs, thus allowing us to study cost-effectiveness. Note that we intentionally refrain from having only a cost minimization focus because of ethical and legal principles (National Institute for Health and Care Excellence 2015) and, as is common in medicine (Gold et al. 1996), we focus on cost-effectiveness. Depending on the success of preventive treatments, the IHO incurs different costs. A preventive treatment incurs an annual cost of Cprevent per patient. By enrolling all N patients in the preventive program, the IHO would experience a total cost of N\u00d7Cprevent, which generally would exceed available financial resources. If the disease is not prevented, the IHO faces annual costs of treating a patient with diabetes, Cdiab, which depends both on the age of the patient and on any concomitant diseases caused by the developed diabetes. The cost for treatment usually is substantially larger than the cost for prevention\u2014that is, Cdiab \u226bCprevent. However, not all prediabetic patients actually develop diabetes; hence, the cost Cdiab occurs only for a subset of the overall study population."
        },
        {
            "heading": "3.2. Electronic Health Records",
            "text": "Our work builds on an extensive longitudinal dataset. Specifically, our partnering IHO provided us with the EHRs of all patients classified as prediabetic and thus at risk of developing diabetes mellitus type II. Our sample comprises 89,191 patients and exhibits considerable between-patient heterogeneity in risk profiles. For purposes of this research, access to the EHRs was granted for the time period of 2003 through 2012.\nFor each patient, the EHRs comprise variables from the following categories: (i) socio-demographics; (ii) body measurements; (iii) lab tests; (iv) disease codes; and (v) drug prescriptions. Disease codes provide data on other co-occurring conditions and are encoded based on the International Classification\nof Diseases (ICD) system of diagnostic codes. Table 1 shows examples for each category (i)\u2013(v). These variables present potential risk factors that describe heterogeneity in disease onsets among patients, and we thus leverage them later for machine learning.\nPatients were classified into (a) prediabetic or (b) diabetic as follows: (a) Prediabetic is the precursor stage before the onset of diabetes mellitus type II. Following established criteria, patients are considered prediabetic when the fasting glucose level is between 6.1 mmol/L and 6.9 mmol/L (World Health Organization 2006). The IHO used this inclusion criterion when compiling our patient data. (b) Diabetic corresponds to a fasting glucose level above 6.9 mmol/L (World Health Organization 2006). Later, during machine learning, our target variable denotes whether a patient has transitioned from prediabetic to diabetic (= 1) or not (= 0)."
        },
        {
            "heading": "3.3. Summary Statistics",
            "text": "Our dataset comprises 89,191 prediabetic patients. Of these patients, 77,036 remain prediabetic throughout the study period, whereas 12,155 develop diabetes mellitus. Hence, only 13.62% of patients transition from prediabetes to diabetes during the study period. Table 2 lists summary statistics for key variables for the first record of each patient in our dataset. In our study population, the average age is 47.07, and the average body mass index (BMI) is 29.05. These observations are in line with earlier findings from medical research, according to which (pre-)diabetes is especially prevalent in elderly patients and patients with high BMI (U.S. Centers for Disease Control and Prevention 2020).\nFurther differences arise when comparing patients who developed diabetes vs. patients who stayed prediabetic. We find that the average age is lower among patients who did not experience onset (46.84 years), compared to patients who developed diabetes (50.62 years). Similarly, the average BMI is larger for patients who developed diabetes (30.52 kg/m2) compared to patients who stayed prediabetic (28.95 kg/m2). Both observations are in line with medical research, which has identified age and BMI as important risk factors for the onset of diabetes (U.S. Centers for Disease Control and Prevention 2020)."
        },
        {
            "heading": "3.4. Current Practice in Diabetes Prevention",
            "text": "In clinical practice, preventive care for diabetes is allocated as follows (Breeze et al. 2017): First, a health practitioner determines the patient\u2019s risk profile ri and then calculates a risk scoring to assess her risk of developing diabetes. In practice, the risk score is computed using a simple charting tool (e. g., the Framingham diabetes risk score). Such charting tools have an obvious limitation in that only a few variables from the risk profile are considered; a holistic assessment with complete EHRs is absent. Afterward, the patient is enrolled in preventive care if the risk score exceeds a certain threshold \u03c8, i. e.,\nti = { 1, if ri \u2265\u03c8, 0, otherwise. (1)\nThe threshold \u03c8 is typically determined by experts in the field. To this end, we compute the threshold \u03c8 for enrolling patients in preventive care, such that the number of patients enrolled is set to k per year\u2014that is, the k patients with the highest risk scores are eligible for the preventive care program.\nIn our evaluation, the Framingham diabetes risk score typically is used to assess diabetes risk. The Framingham diabetes risk score was developed by the U. S. National Institutes of Health (Wilson et al. 2007) and represents the quasi-standard in clinical practice (Long and Fox 2016). The score is calculated using the charting tool shown in Table 3. Note that only a few risk factors are considered (i. e., fasting glucose level, BMI, cholesterol, parental history of diabetes mellitus, triglycerides, and blood pressure); all other variables from a patient\u2019s EHR are ignored. The failure to account for other variables thereby points toward opportunities for more effective risk assessment and prevention."
        },
        {
            "heading": "3.5. Performance Metrics",
            "text": "We measure the operational performance of preventive care in such a way that the measure captures current practice at our IHO. Recall that preventive care aims to maximize the success of its preventive efforts (World Health Organization 2018b). In other words, given a certain budget, the expected number of disease onsets should be minimized. In medical decision-making, this measure is the quasi-standard in which outcome optimization is prioritized over cost minimization alone because of ethical and legal principles (National Institute for Health and Care Excellence 2015). In accordance with this standard, the expected number of prevented onsets represents our primary evaluation metric. Because health management also is interested in the economic value of implementing preventive care programs, we further report the projected cost savings but emphasize their secondary role.\nWe evaluate the performance of our decision model in a dynamic setting. Formally, we apply our decision model over a horizon of l = 1, . . . ,L time steps (here, years 2003 through 2012). Each year allows access only to historical data to assign patients to preventive care. We denote that patient i was treated in year l by ti,l = 1. The preventive treatment of patient i reduces the risk of developing diabetes in the future\u2014that is, the treatment effect is \u03b3i,l. However, the outcomes of preventive treatment are not observable until months after the treatment. Let yi,l+1 = 1 denote the presence of diabetes for patient i in the following year, whereas yi,l+1 = 0 describes the absence of diabetes. To be realistic, we consider censoring analogously to how it occurs in practice. On the one hand, we account for patients who have died and exclude them from being targeted for preventive treatment. On the other hand, we do not discount patients where a follow-up was missed (and also do not exclude them from being targeted for a preventive treatment) because these patients can incur a cost in subsequent years. To this end, our performance metrics are as follows:\nPrevented onsets.We evaluate our decision model by computing the expected number of prevented onsets, which directly corresponds to the objective of our decision model and of preventive care in practice. Hence, it is our prime metric of interest. The expected number of prevented onsets in the patient cohort amounts to\nPreventedOnsets = 1\nL L\u2211 l=1 N\u2211 i=1 \u03b3i,l ti,l yi,l+1, (2)\nwhere \u03b3i,l ti,l yi,l+1 gives the expected reduction in the risk of a diabetes onset for patient i in year l, which is then averaged over the complete study horizon 1, . . . ,L.\nCost savings. We calculate the expected cost savings of our allocation for our IHO as follows. The cost savings depend on the cost of enrolling patients in preventive care and the cost of treating diabetes. A preventive treatment (here: metformin) incurs an annual cost of Cprevent = $1,380 per patient (Gu et al. 2015). After a potential onset, the annual cost of treating diabetes depends on the\nage of the patient, as well as additional comorbid conditions\u2014that is, Cdiab =C0+C1+ . . .+C5, where C0 describes base costs that depend on the age of the patient, and C1, . . . ,C5 describe costs that can arise from comorbid conditions. In our case, we use C0 = $15,000\n1+exp(\u2212age/10) for base costs and consider\nfive common comorbid conditions of diabetes: acute myocardial infarction (C1 = $5,000), intracerebral hemorrhage (C2 = $5,000), acquired hypothyroidism (C3 = $5,000), angina pectoris (C4 = $15,000), and heart failure (C5 = $15,000).\nWe then calculate the expected cost for patient i in year l when being treated using\nC (t) i,l = yi,l+1 (1\u2212 \u03b3i,l)Cdiab +Cprevent, (3)\nand when not being treated using\nC (nt) i,l = yi,l+1Cdiab. (4)\nBy summing over the patients and the study horizon, we compute the cost savings as\nCostSavings = L\u2211\nl=1 N\u2211 i=1\nC (nt) i,l\ufe38 \ufe37\ufe37 \ufe38\nCost for no preventive treatments\n\u2212 L\u2211\nl=1 N\u2211 i=1 ti,lC (t) i,l +(1\u2212 ti,l)C\n(nt) i,l\ufe38 \ufe37\ufe37 \ufe38\nCost when allocating patients to preventive program\n. (5)\nOf note, some costs are ongoing and thus are incurred beyond the study horizon covered by our dataset. To account for this extension, we calculate the expected costs using an expected lifetime of 75 (Tachkov et al. 2020). For older patients, we take into account a minimum of three additional years of life, and for younger patients, we consider a maximum of ten years. In doing so, we reflect that the longer remaining lifetime of younger patients means that diabetes is likely to lead to larger overall costs for treatment."
        },
        {
            "heading": "4. Model Development",
            "text": ""
        },
        {
            "heading": "4.1. Problem Formulation",
            "text": "The objective of our partnering IHO is to dynamically allocate preventive care to patients so as to maximize the number of prevented cases of diabetes mellitus, given the available budget. Let i = 1, . . . ,N+ refer to the customers of the IHO\u2014that is, to the patients in our dataset. The plus symbol indicates that some of the patients have already received preventive treatments, whereas the majority has not been treated. Let the first N <N+ customers denote patients who have not been treated yet and therefore potentially benefit from being enrolled in the preventive care program. Simply enrolling all patients in preventive care is not economically feasible because of budget constraints. Instead, in each year l= 1, . . . ,L, a decision must be made as to whether preventive care is warranted to patient i (ti,l = 1) or is not warranted (ti,l = 0).\nFor the purpose of decision-making, our IHO has access to additional information on patients\u2019 risk profiles through their EHR. EHR systems, similar to the one providing data for our evaluations, are\nused worldwide, thus ensuring the broad applicability of our model. For simplicity, we refer to the variables in the EHR by xi,l \u2208Rn, i= 1, . . . ,N+, l= 1, . . . ,L. These variables encode the heterogeneity among patients and are used as predictors in our data-driven approach. Specifically, we use the EHRs for identifying patients at risk of developing diabetes, which is relevant in clinical practice because only a small subset of prediabetic patients actually develop diabetes. Hence, by accurately identifying patients who will experience an onset, preventive treatments can be allocated to patients who would most benefit from them.\nThe objective is to maximize the expected effect of the preventive treatments. In other words, the expected number of disease onsets should be minimized within our time frame. As such, the decision of whether to enroll a specific patient in preventive care is driven only by the expected risk reduction of the preventive treatment for the patient (Paulweber et al. 2010). IHOs also might have to consider additional budget restrictions\u2014not at the patient level, but at the population level. Hence, the decision problem is given by\nmin t1,1,...,t1,L\n... tN,1,...,tN,L\nL\u2211 l=1 ( N\u2211 i=1 ti,lE [y |xi,l, ti,l = 1]+ N\u2211 i=1 (1\u2212 ti,l)E [y |xi,l, ti,l = 0] ) (6a)\ns.t.\nN\u2211 i=1 ti,l \u2264 k, \u2200l \u2208 {1, . . . ,L}, (6b)\nti,l \u2208 {0,1}, \u2200i\u2208 {1, . . . ,N}\u2200l \u2208 {1, . . . ,L}. (6c)\nEquation (6a) encodes the objective whereby the expected number of disease onsets is minimized. Here, the expectation E [y |xi,l, ti,l = 1] denotes the probability of developing diabetes, conditional on the EHR of patient i in year l and in the presence of preventive treatment (ti,l = 1). The expectation E [y |xi,l, ti,l = 0] denotes the probability of an onset, conditional on the EHR of patient i in absence of a preventive treatment (ti,l = 0). Neither expectation is known, implying that the treatment effect must be estimated from data\u2014for example, from electronic health records or, alternatively, by conducting randomized controlled trials. Equation (6b) introduces a budget constraint on the number of patients that can be enrolled in preventive care, thus allowing the treatment of k patients per year. Equation (6c) makes this problem an integer problem.\nOur decision problem focuses on the expected number of diabetes onsets, similar to clinical practice; therefore, the cost of preventive treatments is not considered. Nevertheless, we can show that minimizing onsets also minimizes the overall cost of treatment (comprising both preventive treatments and treatments after a possible onset of the disease), given mild assumptions. This mathematical property is of direct relevance for health management because it underscores that improving the effectiveness of preventive care through better allocations also has financial value for healthcare organizations.\nProposition 1 (Link of prevented diseases to cost minimization).\nLet t1,l, . . . , t1,L, . . . , tN,1, . . . , tN,L be a solution to the decision problem in Equation (6), let Cprevent denote the costs for prescribing preventive treatments, and let Cdiab denote the costs for treating the disease after onset. Then, if\nti,l (CdiabE [y |xi,l, ti,l = 1]+Cprevent)\u2264 ti,l (CdiabE [y |xi,l, ti,l = 0]) , \u2200i\u2208 {1, . . . ,N}\u2200l \u2208 {1, . . . ,L},\n(7)\nit follows that the solution t1,l, . . . , t1,L, . . . , tN,1, . . . , tN,L also minimizes costs for the health insurer.\nProof See Appendix A."
        },
        {
            "heading": "4.2. Proposed Decision Model",
            "text": "We develop a data-driven decision model for allocating preventive care\u2014that is, a decision model that receives EHRs from patients as input and for which the output is a cost-effective allocation of preventive care resources (Figure 1). Our decision model uses a combination of causal inference, machine learning, and optimization, structured in three consecutive stages: (1) The first stage uses counterfactual inference to estimate the effectiveness of preventive treatments using EHRs (i. e., the heterogeneous treatment effect). Thus, we quantify how the personalized diabetes risk of a patient with a specific risk profile changes when a preventive treatment is prescribed. Here, we serve needs in practice, where the treatment effectiveness is often unknown but must be estimated from EHRs. Later, we also discuss an alternative approach that can be used when the treatment effect is known (e. g., from a randomized controlled trial). (2) The second stage estimates the personalized risk of a diabetes onset for an individual patient. Specifically, we apply machine learning to a patient\u2019s EHR to predict the probability of an onset. (3) The third stage uses the predicted risk together with the treatment effect to optimize the allocation of preventive care to patients under the given budget constraint.\n4.2.1. Stage 1: Estimating the Treatment Effect. In the first stage, we estimate the heterogeneous treatment effect of metformin\u2014that is, the expected reduction in the probability of a diabetes onset when prescribing metformin to patients, given a specific patient risk profile. To account for heterogeneity in the treatment effectiveness across different patients, we introduce the following notation:\nLet {1, . . . ,N+} be the set of patients in our sample, including patients who already received preventive treatment through metformin, as well as patients who have not received preventive treatments. Let I = {(i, l) : i\u2208 {1, . . . ,N+}, l \u2208 {1, . . . ,L}} be the set of 2-tuples for indexing patient-level observations throughout our study period.\nWe then estimate the treatment effect for each patient i in year l via\n\u03b3i,l =E [y |xi,l, ti,l = 0]\u2212E [y |xi,l, ti,l = 1] . (8)\nAs a result, we allow the treatment effect to vary across patients who have different risk profiles. Building on the potential outcomes framework, it can further be shown that the treatment effects are identifiable from observational data (Rubin 2005).\nTo estimate the heterogeneous treatment effects, we use an established method: the causal forest (Wager and Athey 2018). The causal forest is a non-parametric method that extends the widely used random forest algorithm by Breiman (2001) for estimating heterogeneous treatment effects. This approach comes with many benefits. First, the causal forest is an ensemble method, which means it combines the predictions of multiple simpler models to improve its performance. As a result, the causal forest works well in settings where the treatment effect is subject to complex, nonlinear relationships. Second, under common mathematical assumptions, the causal forest has been shown to be pointwise consistent for the true treatment effect and thus leads to provably valid inferences. Third, the causal forest is capable of handling high-dimensional and mixed data types with little risk of overfitting, making it a robust choice that requires minimal preprocessing. Mathematically, one of these characteristics is its honesty property, where the trees in the causal forest are grown using one subsample of the dataset, while the predictions at the leaves of the tree are estimated using a different subsample (Wager and Athey 2018). By ensuring that each tree is only fit to a portion of the data, the honesty property helps to mitigate the risk of overfitting and to produce accurate and reliable treatment effect estimates. We report details on our implementation in Section G.\nAs part of our robustness checks, we perform a causal sensitivity analysis (Cinelli and Hazlett 2020) in which we study the effect of potential unobserved confounding variables on the estimated treatment effects. We find that, for unobserved confounding variables that are even strongly associated with our treatment, the treatment effects remain robust (see Supplement D). Furthermore, we study how errors in the treatment effect estimation influence the overall performance of our decision model, and we find that the results remain largely robust. Finally, we provide an extension to settings where the treatment effect is not estimated from historical data but is given ex ante (e. g., where treatment effect is obtained through a randomized controlled trial instead), and we show how our decision model is applicable to such cases (see Supplement H).\n4.2.2. Stage 2: Estimating the Patient Risk of Diabetes Onset. In the second stage, we rely on machine learning to estimate the heterogeneous risk of diabetes onset (in the absence of preventive treatment). For this purpose, we first filter out patients who already received preventive treatment. Let the first N <N+ customers be patients who have not already been enrolled in a preventive care program. We then train a machine learning model h\u03b80 with parameters \u03b8 \u2208\u0398 as follows. The machine learning model uses EHRs, xi,l, to predict the risk of the individuals\u2019 developing the disease. Formally, this is given by E [y |xi,l, ti,l = 0], i\u2208 {1, . . . ,N}, l \u2208 {1, . . . ,L}. Hence, we have h\u03b80(xi,l) = 1 if there is an onset in the following year, and h\u03b80(xi,l) = 0 if the condition for patient i is absent in the following year. Given h\u03b80 and the estimated treatment effect \u03b3i,l from stage 1, we can then compute the probability of onset, conditional on a preventive treatment. Then, the risk of a diabetes onset under preventive treatment amounts to (1\u2212 \u03b3i,l)h\u03b80(xi,l).\nMathematically, h\u03b80 is estimated as follows. Let \u03b8 \u2208 \u0398 refer to a set of parameters in the machine\nlearning model h\u03b80. For estimation, we minimize the empirical risk; that is,\nh\u22170 = argmin \u03b8\u2208\u0398 L\u2211 l=1 N\u2211 i=1 L(h\u03b80(xi,l), yi,l+1), (9)\nwhere L denotes a loss function that measures the error of h\u03b80 in forecasting the onset of a disease. We further calibrate the output probabilities of h\u03b80 using Platt scaling (see Supplement F).\nWe later report results from our decision model using gradient-boosted decision trees. Gradientboosted decision trees (Friedman 2001) belong to the category of ensemble methods, which are known to perform well on complex datasets and have been used in other operational applications (e. g., Glaeser et al. 2019). Nevertheless, we also perform an extensive series of robustness checks, repeating the analysis with other machine learning methods (e. g., lasso, ridge regression, random forest, and deep neural network). For all machine learning models, hyperparameters were tuned using 10-fold crossvalidation. The tuning procedure is reported in Supplement G.\n4.2.3. Stage 3: Selecting Patients for Preventive Care. To accommodate budgetary constraints, we model the maximum number of preventive treatments as k patients per year. Our objective is to identify a cost-effective allocation that minimizes the expected number of onsets of the disease. Hence, we formulate our optimization problem as\nmin t1,1,...,t1,L\n... tN,1,...,tN,L\nL\u2211 l=1 ( N\u2211 i=1 ti,l (1\u2212 \u03b3i,l) h\u22170(xi,l)+ N\u2211 i=1 (1\u2212 ti,l)h\u22170(xi,l) ) (10a)\ns.t.\nN\u2211 i=1 ti,l \u2264 k, \u2200l \u2208 {1, . . . ,L}, (10b)\nti,l \u2208 {0,1}, \u2200i\u2208 {1, . . . ,N}\u2200l \u2208 {1, . . . ,L}. (10c)\nThis optimization problem extends Equations (6a) to (6c), in that we replace the (unknown) expected values with their corresponding predictions from the machine learning methods.\nIn the case of metformin, the solution to the previous optimization problem is the subset of k patients per year for which the estimated reduction in expected onset is higher than the reduction for patients not in the subset. We show this property in the following proposition.\nProposition 2 (Optimal allocation). Let h\u22170 be an oracle for the risk of an onset, and let \u03b3i,l be the true heterogeneous treatment effect of patient i in year l. The allocation that minimizes the expected number of onsets in the population {1, . . . ,N} provides preventive treatments in year l to patients {1, . . . , k}, where\n(1\u2212 \u03b3i,l)h\u22170(xi,l)\u2265 (1\u2212 \u03b3j,l)h\u22170(xj,l), \u2200i\u2208 {1, . . . , k}\u2200j \u2208 {k+1, . . . ,N}. (11)\nProof See Supplement B.\nIn our implementation, we follow best practices and assess uncertainty in our model using a bootstrap procedure (Hastie et al. 2009). Specifically, we use 100 samples with replacement and then report both the mean and the standard deviation."
        },
        {
            "heading": "5. Empirical Results",
            "text": ""
        },
        {
            "heading": "5.1. Performance of Data-Driven Allocation",
            "text": "In this section, we evaluate our decision model and compare its performance against the clinical baseline, which we use to mimic healthcare practitioners who base their decision-making on the Framingham diabetes risk score (see Section 3.4). In addition, we report a na\u0308\u0131ve baseline, in which the allocation of preventive treatments is not optimized but, instead, a subset of k patients from the population is randomly chosen for each year. By comparing the na\u0308\u0131ve baseline with our decision model, we can directly quantify the relative gain from stratifying the allocation to high-risk patients through a data-driven approach. The results are in Table 4.\nThe na\u0308\u0131ve baseline (i. e., random allocation) is estimated to prevent 489 onsets when treating k=10,000 patients per year. For the same budget allowing for k=10,000 preventive treatments, the clinical baseline is estimated to prevent 701 onsets. Meanwhile, our decision model would prevent 882 onsets\u2014an improvement of more than 25 percent. The results for other budgets lead to similar conclusions. In sum, our decision model is considerably more effective than current practice in disease prevention.\nThe use of our decision model offers considerable cost savings. A random allocation of preventive treatments leads to cost savings of $6.319 million at k=1,000 and $11.988 million at k=10,000. This\noutcome shows that preventive care can be economical, in that the cost for treating a diabetes onset is substantially larger than the cost for preventive treatments. The clinical baseline improves cost savings further: to $7.340 million at k=1,000 and to $15.350 million at k=10,000. In comparison, our decision model demonstrates consistent cost savings over both the na\u0308\u0131ve baseline and the clinical baseline across all budgets k. For k=1,000 and k=10,000, our IHO could generate additional savings, beyond that of the clinical baseline, of $0.710 million and $2.987 million, respectively. As a result, the cost savings in our decision model are substantially larger than those of the clinical baseline and, based on a comparison with t-tests, are statistically significant at common significance thresholds."
        },
        {
            "heading": "5.2. Comparison of Patient Characteristics",
            "text": "In this section, we provide a quantitative assessment of the difference between the allocations from the clinical baseline and from our decision model. For this work, we report descriptive statistics for patients who were enrolled in preventive care (see Table 5). The clinical baseline based on the Framingham diabetes risk score allocates preventive care to patients who, on average, are 41.36 years old, whereas our decision model allocates preventive care to patients who are, on average, 53.60 years old and thus substantially older. This increase is in line with medical research (Knowler et al. 2002), which shows that a larger treatment effect from metformin is observed in people above age 45. Here, we note that the clinical baseline based on the Framingham diabetes risk score does not consider age to be a predictor of diabetes onset (Wilson et al. 2007), and for this reason, following current practice does not explicitly stratify the allocation of preventive care to older age groups. Furthermore, the clinical baseline based on the Framingham diabetes risk score selects patients with an average BMI of 31.31, while our decision model gives preference to patients with a larger BMI (average: 34.55). We discussed our observations with medical professionals specializing in diabetes care, who explained that the stratification from our decision model is beneficial because, in their experience, metformin leads to reduction in body weight;\nthey noted that such preventive efforts are especially effective when offered to overweight patients. In terms of gender, both allocations exhibit a similar distribution among men and women."
        },
        {
            "heading": "5.3. Cost-Effectiveness Analysis",
            "text": "In our cost-effectiveness analysis (similar to Ayvaci et al. 2012), we estimate the number of prevented disease onsets and cost savings across varying budgets\u2014that is, for a varying number of patients being enrolled in preventive care.\nWith increasing budgets, the relative proportion of prevented disease onsets also increases (see Figure 2). However, the improvement is more pronounced for our decision model, compared to both the na\u0308\u0131ve baseline and the clinical baseline. Hence, for the same budget increase, our decision model is estimated to be more effective in preventing disease onsets. For instance, when enrolling 10% of the prediabetic population in preventive care, we estimate that the clinical baseline can prevent 2.21% of diabetes onsets. Using our decision model, this proportion increases to 2.89%.\nThe cost savings over no preventive care are shown in Figure 3. As expected, the na\u0308\u0131ve baseline and the clinical baseline based on the Framingham diabetes risk score achieve lower cost savings than our decision model, confirming again the superiority of our decision model. This finding is consistent across different budgets (i. e., different numbers of patients enrolled in preventive treatments). Our decision\nmodel leads to annual cost savings of up to $20.31 per prediabetic patient. The cost savings per patient reach a maximum when 47.58% of the population is enrolled in preventive treatments."
        },
        {
            "heading": "5.4. Application to a U. S.-Wide Population",
            "text": "For better comparability, we now repeat the previous analysis for a population-wide setting, where we estimate the results of applying our decision model to the entire U. S. population. The U. S. population includes about 300 million adults, of whom 88 million are considered prediabetic. As previously noted, we assume that costs for preventive treatment are $1,380 per patient and that model costs are dependent on age and potential comorbid conditions of a patient (see Section 3.5). We further assume the same machine learning performance in identifying high-risk patients as in the previous analyses.\nOn the basis of this setting, we obtain the following findings: Using the clinical baseline, allocating preventive treatments to 10% of patients (equal to 8.8 million people) leads to cost savings of $913 million annually. This outcome corresponds to annual cost savings of $10.38 per prediabetic patient. In comparison, our decision model offers larger benefits. When providing 10% of patients with preventive treatments, our decision model allows for annual cost savings of $1.1 billion, equivalent to $12.50 per prediabetic patient. Because the prevalence of diabetes in the United States is increasing (Chen et al. 2011), the cost savings are likely to continue to grow in the coming years."
        },
        {
            "heading": "5.5. Robustness Checks",
            "text": "5.5.1. Sensitivity analyses. We performed an extensive series of additional empirical analyses that add to the robustness of our findings: (1) We tested our decision model with varying machine learning models (e.g., random forest, deep neural network). Details are in Supplement C.1. We find that all machine learning models perform well, and furthermore, the results favor our choice of gradientboosted decision trees. (2) We tested alternative risk scores (see Supplement C.2). Here, we find that our proposed decision model consistently leads to a larger number of prevented diseases and larger cost\nsavings. (3) We evaluated the robustness of the decision model to estimation errors in the treatment effect (see Supplement C.3). We again find that our decision model shows robust results\u2014in particular, when there is a larger number of patients in the treatment group. (4) We demonstrate the applicability of our approach to personalized coaching as another form of preventive care (Supplement H).\n5.5.2. Explainability. We further build on explanation methods to analyze how our machine learning model arrives at predictions of diabetes onsets. To identify the most important predictors in our prediction model, we calculated SHapley Additive exPlanations (SHAP) values (Lundberg and Lee 2017). We find that the variables of age, BMI, and HbA1c are the most important predictors for our machine learning model when assessing the risk of a diabetes onset. Larger values for these variables result in the machine learning model\u2019s calculating a larger probability of diabetes onset. We discussed the results with medical professionals, who confirmed that our findings not only match their own experience but also are in line with medical research. Details are in Supplement E.\n5.5.3. Alternative Model Specifications. We further benchmark different variations of our\ndecision model to confirm the effectiveness of our model specification:\n1. Main model. We report the decision model from the main analysis. Here, the machine learning\nstage uses 307 input variables (see Table 1), and the optimization stage stratifies the allocation on the basis of risk reduction. 2. Sparse model I/II. For Sparse Model I, we vary the input as follows: The model uses only\na subset of input variables\u2014namely, those from the Framingham diabetes risk score (see Table 3). For Sparse Model II, we also use the risk factors of age and the current glycated hemoglobin level (HbA1c). This addition allows us to quantify the performance gain from using modern, high-dimensional EHRs. 3. Linear model. Here, we vary the machine learning stage by using only a linear model (with lasso\nregularization). By comparing this model against our main decision model (with gradientboosted decision trees), we can assess the gains from modeling complex, nonlinear relationships (e. g., from comorbidities and other co-occurring conditions). 4. Risk-stratified model. For the risk-stratified model, we vary the optimization stage, stratifying\nthe allocation only by patient risk. That is, we select the patients for preventive care based on the highest risk of an onset, without considering heterogeneous treatment effects.\nTable 6 presents the results for the five different model specifications. (1) We find that the decision model from the main analysis performs best. (2) We find that using high-dimensional patient data from modern EHRs is beneficial, but only to a relatively small degree. Replacing the 307 input variables with the variables from the Framingham diabetes risk score, together with age and HbA1c, can still\nlead to large improvements over the clinical baseline. In particular, the sparse model II is ranked second overall, even though it has only seven input variables. Hence, the use of advanced machine learning, together with an optimization stage that accounts for heterogeneous treatment effects of preventive care, is more important than having access to rich EHR data. (3) We find that nonlinear machine learning outperforms a linear model. The finding confirms the value of modeling complex, nonlinear relationships through nonlinear machine learning models. (4) We obtain large benefits from including heterogeneous treatment effects in the objective. Hence, the optimization stage is more effective when allocation decisions take into account risk reduction, rather than only patient risk."
        },
        {
            "heading": "6. Discussion",
            "text": ""
        },
        {
            "heading": "6.1. Implications for Research",
            "text": "Our novel decision model for data-driven allocation of preventive care integrates counterfactual inference, machine learning, and optimization. Specifically, the model allocates a given budget toward primary preventive care for patients at risk of developing a disease, so as to maximize the expected number of patients whose disease onset is prevented. We evaluate our decision model in a dynamic setting using a large, longitudinal dataset of 89,191 patients at risk of developing diabetes mellitus type II, thereby confirming its effectiveness.\nWe study the operational value of incorporating high-dimensional health data, machine learning, and optimization toward preventive treatment allocation decision-making. Through our experiments using a large, longitudinal dataset, we examined the performance gap between our proposed decision model and alternative model specifications (see Section 5.5.3). Overall, the largest performance gain in prevented diseases and cost savings comes from targeting patients based on risk reduction rather than only on risk. Hence, a crucial implication of our work is the importance of a rigorous modeling framework for decision-making. Also crucial is the use of advanced machine learning to accommodate\ncomplex, nonlinear relationships. A comparatively smaller gain comes for the use of high-dimensional EHRs. In fact, a decision model that uses machine learning and targets patients on the basis of risk reduction, but that has access only to a small subset of patient variables (sparse model II), can even achieve a performance that is close to that of our main model. Our findings imply that using datadriven decision models to inform resource allocation in healthcare may be practical, even in cases where relatively little information is available about a patient.\nProactively reducing individuals\u2019 risk of developing preventable diseases is a top priority in healthcare not only because it can improve patients\u2019 quality of life but also because it reduces healthcare costs. Our analysis shows that a large number of onsets can be prevented by using a data-driven decision model. In practice, allocation of patients to preventive care programs is often solely based on the risk of disease onset for the patients\u2014that is, patients with the highest risk of onset are assigned to preventive treatments. However, prior medical literature has shown that preventive treatments can have a differential effectiveness (Knowler et al. 2002). By exploiting this differential effectiveness, our method allocates preventive treatments in a more cost-effective manner, including prioritizing patients who have a lower risk of onset but who can benefit from preventive care more than patients who have a higher risk of onset. Similar observations have been made for targeting customers in marketing, where interventions can benefit when they consider not only the risk that a customer is about to churn, but also the incremental effectiveness of marketing interventions (Ascarza 2018).\nIn our decision model, we also address the problem of unobserved confounders using a powerful statistical framework (Cinelli and Hazlett 2020). Unobserved confounders simultaneously influence both the probability of being assigned to preventive treatment and the likelihood of developing diabetes. Thus, if unobserved confounders are not accounted for, the estimates of the treatment effect can be biased (Frauen et al. 2023b). Such confounders are common in medicine and can include such variables as patients\u2019 socioeconomic status, healthcare coverage, and race. Often, these variables either cannot be directly observed or cannot be collected and used because of anti-discrimination laws. In light of this limitation, statistical frameworks that can address the potential effects of unobserved confounders can offer significant practical value in operations management."
        },
        {
            "heading": "6.2. Implications for Health Management",
            "text": "Healthcare managers have had to confront rising costs for care in recent years (KC et al. 2020). To counteract these costs, regulatory initiatives, such as the Affordable Care Act (\u00a74001(f)(3)), dictate a greater focus on disease prevention (Koh and Sebelius 2010). Health management research has long studied the efficient provision of care for patients after they develop a medical condition (e. g., Garg et al. 2020, Zhang et al. 2016); in contrast, our work charts a different path, where care is allocated\nprior to any disease onset, with the goal of preventing it. To support health management in this task, we develop a novel data-driven decision model.\nCurrent practice in allocating preventive care is based on risk scores and has several significant shortcomings. First, traditional risk scores (e. g., charting tools) are limited to a small subset of relevant patient variables that are commonly available in contemporary EHRs. Here, leveraging a few key variables from modern EHRs can offer better predictive power in identifying patients at risk of developing diabetes. Second, traditional risk scores also are limited to simplified linear models thus neglecting complex, nonlinear relationships between risk factors. Yet, such nonlinear relationships are particularly common in the presence of comorbidities and other co-occurring conditions. Third, traditional risk scores allocate preventive care according to a patient\u2019s risk level but without considering the heterogeneous treatment effects of preventive treatments across patients\u2014that is, the differential effectiveness in reducing the risk of onset for a patient. Our work\u2019s contributions address these three key limitations."
        },
        {
            "heading": "6.3. Practical Considerations",
            "text": "Our decision model can be readily developed and integrated into existing health management practices. Specifically, the approach we develop here is a general-purpose framework that can produce costeffective intervention programs by healthcare systems that have access to EHRs; our approach can be applied to maximize prevention of any preventable disease for which preventive treatment exists, such as cardiovascular diseases or respiratory diseases, and for a given preventive care budget. As such, our approach is neither limited to a particular preventable disease nor does it rely on having access to a specific kind of information. In this work, we present empirical evaluations when using real healthcare data commonly recorded in practice by standard EHR systems worldwide. Therefore, our decision model is applicable to other IHOs in which similar standard EHR systems are used.\nIn recent years, there has been a transition in healthcare from reactive to proactive care, underscoring the importance of preventive practices. Proactive care is a comprehensive approach that focuses on identifying and mitigating risk factors to prevent the onset of diseases, in contrast to only treating diseases and conditions once they arise. By proactively reducing individuals\u2019 risks of developing preventable diseases, health management can improve patient outcomes and reduce the long-term cost and resource burden on the healthcare system (Zhou et al. 2020). This approach aligns with the objectives of IHOs in many countries, including several European countries, Israel, Singapore, and others. (World Health Organization 2016). In the U. S., some healthcare systems have goals that are consistent with cost-effective interventions to benefit the long-term well-being of patients; they include health maintenance organizations (e.g., the Kaiser group, with over 12 million members (e.g., Kaiser Permanente\n2021)) and Accountable Care Organizations, which merge patient data from different providers, with the goal of promoting cost-effective care. Generally, IHOs aim to improve coordination and efficiency among healthcare services and typically prioritize preventive care and patients\u2019 long-term well-being more broadly. By having access to comprehensive patient information from different health providers, IHOs can make informed decisions to optimize the allocation of resources for preventive care. Our decision model is directly applicable in such contexts and thus facilitates proactive care in two ways: (1) by providing a data-driven, cost-effective allocation of limited preventive care resources, and (2) by supporting health managers with the goal of improving patient outcomes and mitigating the burden of preventable debilitating diseases. Worldwide, evidence on the value of care and the use of datadriven care have led to an increasing trend toward integration in the healthcare sector (e.g., World Health Organization 2016, Cuesta et al. 2019). In contrast, in countries where IHOs are not available, our decision model can motivate and promote collaboration among providers and insurers to enable cost-effective preventive care.\nOperationally, the frequency of risk assessment and subsequent (re)allocation of a preventive treatment to patients ought to reflect the particular context. For instance, the onset risk of many preventable chronic diseases, including metabolic diseases such as diabetes mellitus type II, can vary over time, and a periodic estimation of risks and allocation of treatments, as we have done in this work, would be prudent. We have demonstrated how annual reallocation of preventive treatments can meaningfully reduce the number of patients affected by diabetes mellitus. In other contexts, the updating frequency ought to reflect the rate at which patients\u2019 risk is likely to change. As we have demonstrated here, our decision model can be applied to yield updated risk updates and to reallocate the preventive treatments accordingly.\nPrimary prevention considers all patients and prioritizes offering intervention treatments to patients based on their respective expected risk reduction. Thus, preventive care can yield the greatest benefits when it is not limited to considering only a subset of patients who initiate a physician\u2019s visit; instead, it could be proactively offered to patients for whom preventive care can be most effective, including patients who may be unaware of their own risk and thus do not seek treatment. In particular, given that nine in ten U. S. adults are unaware of their high-risk status (Geiss et al. 2010), proactive efforts are paramount for effective diabetes prevention.\nImplementing a decision model for the allocation of preventive care is subject to several practice challenges. One challenge is to ensure the availability of EHRs, which is a crucial requirement for identifying patients at risk of disease onset and for estimating heterogeneous treatment effects. Another challenge is the quality of EHR data, especially with respect to completeness and accuracy, both of\nwhich can affect the performance of the decision model. Finally, there may be regulatory challenges in implementing the decision model, such as privacy and data protection regulations that restrict access to patient data. As in any data-driven approach, establishing that the use of information to allocate disease prevention is consistent with local privacy and regulatory frameworks is important. Future work may also extend our analysis through the use of algorithmic fairness (De-Arteaga et al. 2022)."
        },
        {
            "heading": "6.4. Concluding Remarks",
            "text": "In an effort to reduce costs and improve quality of life, health management places an increasing focus on disease prevention. However, healthcare organizations lack the decision support necessary to facilitate effective allocation of preventive treatments to patients, given that population-wide access of preventive care is often prohibitively costly. To aid health management in this task, we have developed in this work a data-driven decision model for the cost-effective allocation of preventive care."
        },
        {
            "heading": "Acknowledgments",
            "text": "Stefan Feuerriegel acknowledges funding from the Swiss National Science Foundation (SNSF) via Grant 186932.\nMathias Kraus acknowledges funding from the Federal Ministry of Education and Research (BMBF) on \u201dWhite-\nBox-AI\u201d (Grant 01IS22080)."
        },
        {
            "heading": "Appendix A: Link of Prevented Diseases to Cost Minimization",
            "text": "Proof of Proposition 1. Without loss of generality, we study year l within our study period, and let\n{1, . . . , k} \u2282 {1, . . . ,N} denote the patients that were enrolled for preventive treatment according to our decision\nmodel, i.e., which describe a solution to the decision problem (Equation (6)). For simplicity, we neglect the\nindex denoting the year. Then, the first part of this proof shows that the solution {1, . . . , k} minimizes costs\namong all subsets containing k patients. The second part proves that there is no subset with fewer patients\n({1, . . . , k\u2212 1} \u2282 {1, . . . ,N}) that yields lower costs.\n1st Part. Because {1, . . . , k} \u2282 {1, . . . ,N} is a solution to the decision problem, we can assume that\nE [y |xi, ti = 0]\u2212E [y |xi, ti = 1]\u2265E [y |xj , tj = 0]\u2212E [y |xj , tj = 1] ,\n\u2200i\u2208 {1, . . . , k}\u2200j \u2208 {k+1, . . . ,N}. (12)\nWe take a random patient i\u2217 \u2208 {1, . . . , k} and a random patient j\u2217 \u2208 {k+1, . . . ,N} and exchange the treatment\n(i. e., we provide preventive treatment to patient j\u2217 but not to patient i\u2217). We compute the expected costs Cafter\nafter this exchange and compare it to the expected costs Cbefore before the exchange. The computation yields\nthe following:\nCafter \u2212Cbefore (13)\n=Cdiab  k\u2211 i=1 i \u0338=i\u2217 E [y |xi, ti = 1]+ N\u2211 j=k+1 j \u0338=j\u2217 E [y |xj , tj = 0]+E [y |xj\u2217 , tj\u2217 = 1]+E [y |xi\u2217 , ti\u2217 = 0]  + kCprevent \u2212Cdiab ( k\u2211\ni=1\nE [y |xi, ti = 1]+ N\u2211\nj=k+1\nE [y |xj , tj = 0] ) \u2212 kCprevent (14)\n=Cdiab  k\u2211 i=1 i \u0338=i\u2217 E [y |xi, ti = 1]+ N\u2211 j=k+1 j \u0338=j\u2217 E [y |xj , tj = 0]+E [y |xj\u2217 , tj\u2217 = 1]+E [y |xi\u2217 , ti\u2217 = 0]\n\u2212 k\u2211\ni=1\nE [y |xi, ti = 1]\u2212 N\u2211\nj=k+1\nE [y |xj , tj = 0]  (15) =Cdiab ( E [y |xi\u2217 , ti\u2217 = 0]\u2212E [y |xi\u2217 , ti\u2217 = 1]+E [y |xj\u2217 , tj\u2217 = 1]\u2212E [y |xj\u2217 , tj\u2217 = 0] ) (16)\n\u2265 0 (17)\n2nd Part. We now show that no subset comprising fewer patients ({1, . . . , k\u2212 1} \u2282 {1, . . . ,N}) yields lower\ncosts. For this computation, we assume that:\nCdiabE [y |xi, ti = 1]+Cprevent \u2264CdiabE [y |xi, ti = 0] \u2200i\u2208 {1, . . . , k}. (18)\nThat an exchange of patients between the treatment group and the non-treatment group leads to increased costs\ndirectly follows from part 1. Thus, without loss of generality, we consider subgroups {1, . . . , k\u22121} of our original\nsolution {1, . . . , k} to the decision problem. We compute costs Ck\u22121 when providing preventive care to k \u2212 1\npatients and compare Ck\u22121 to the original costs Ck:\nCk\u22121 \u2212Ck (19)\n=Cdiab ( k\u22121\u2211 i=1 E [y |xi, ti = 1]+ N\u2211 j=k E [y |xj , tj = 0] ) +(k\u2212 1)Cprevent\n\u2212Cdiab\n( k\u2211\ni=1\nE [y |xi, ti = 1]+ N\u2211\nj=k+1\nE [y |xj , tj = 0] ) \u2212 kCprevent (20)\n=Cdiab ( k\u22121\u2211 i=1 E [y |xi, ti = 1]+ N\u2211 j=k E [y |xj , tj = 0]\u2212 k\u2211 i=1 E [y |xi, ti = 1]\u2212 N\u2211 j=k+1 E [y |xj , tj = 0] ) \u2212Cprevent (21)\n=Cdiab ( E [y |xk, tk = 0]\u2212E [y |xk, tk = 1] ) \u2212Cprevent (22)\n=Cdiab ( E [y |xk, tk = 0] ) \u2212Cdiab (E [y |xk, tk = 1])\u2212Cprevent (23)\n\u2265 0 (24)\n\u25a1"
        },
        {
            "heading": "Appendix B: Proof for Optimal Allocation",
            "text": "Proof of Proposition 2. Let nonsets denote the number of expected onsets. Assume h \u2217 0(xi,l) to be a perfect model for E [y |xi,l, ti,l = 0] and assume \u03b3i,l to be the true treatment effect for i \u2208 {1, . . . ,N}. Let {1, . . . , k} be\nthe subset of patients who are prescribed preventive care, and let {k+1, . . . ,N} be the subset of patients who are\nnot prescribed preventive care in year l. Let this allocation follow our described approach to allocating patients;\nthus,\n(1\u2212 \u03b3i,l)h\u22170(xi,l)\u2265 (1\u2212 \u03b3j,l)h\u22170(xj,l), \u2200i\u2208 {1, . . . , k}\u2200j \u2208 {k+1, . . . ,N}, (25)\nwhich is equal to\nh\u22170(xi,l)+ \u03b3j,l h \u2217 0(xj,l)\u2265 h\u22170(xj,l)+ \u03b3i,l h\u22170(xi,l), \u2200i\u2208 {1, . . . , k}\u2200j \u2208 {k+1, . . . ,N}. (26)\nIn the following computation, we take a random patient i\u2217 \u2208 {1, . . . , k} and a random patient j\u2217 \u2208 {k+1, . . . ,N}\nand exchange the treatment\u2014that is, we provide preventive treatment to patient j\u2217 but not to patient i\u2217. From\nthis exchange, we arrive at the following:\nnonsets = k\u2211 i=1 i \u0338=i\u2217 E [y |xi,l, ti,l = 1]+ N\u2211 j=k+1 j \u0338=j\u2217 E [y |xj,l, tj,l = 0]+E [y |xj\u2217,l\u2217 , tj\u2217,l\u2217 = 1]+E [y |xi\u2217,l\u2217 , ti\u2217,l\u2217 = 0] (27)\n= k\u2211 i=1 i \u0338=i\u2217 (1\u2212 \u03b3i,l) h\u22170(xi,l)+ N\u2211 j=k+1 j \u0338=j\u2217 h\u22170(xj,l)+ (1\u2212 \u03b3j\u2217,l\u2217) h\u22170(xj\u2217,l\u2217)+h\u22170(xi\u2217,l\u2217) (28)\n\u2265 k\u2211\ni=1 i \u0338=i\u2217\n(1\u2212 \u03b3i,l) h\u22170(xi,l)+ N\u2211\nj=k+1 j \u0338=j\u2217\nh\u22170(xj,l)+ (1\u2212 \u03b3i\u2217,l\u2217)h\u22170(xi\u2217,l\u2217)+ h\u22170(xj\u2217,l\u2217) (29)\n= k\u2211 i=1 (1\u2212 \u03b3i,l) h\u22170(xi,l)+ N\u2211 j=k+1 h\u22170(xj,l) (30)\n= k\u2211 i=1 E [y |xi,l, ti,l = 1]+ N\u2211 j=k+1 E [y |xj,l, tj,l = 0] (31)\nThus, exchanging the treatments of patients i\u2217 and j\u2217 leads to the same or a larger number of expected onsets.\nConsequently, our original allocation minimizes the number of expected onsets. \u25a1"
        },
        {
            "heading": "Appendix C: Robustness Checks",
            "text": "C.1. Choice of Machine Learning Model\nFor the analysis in the main paper, the machine learning in stage 2 of the decision model was set to gradient\nboosted decision trees (Friedman 2001). Gradient boosted decision trees belong to the category of tree ensem-\nble methods, which have been applied successfully in other operational applications (e. g., Glaeser et al. 2019,\nSenoner et al. 2022). We now provide empirical evidence supporting this choice. For this purpose, we compare\nthe performance of our decision model under different machine learning models in stage 2 while the rest of the\ndecision model remains the same. Our comparison includes linear (lasso and ridge regression) and nonlinear\n(random forest and deep neural network) models. All estimation details are provided in Supplement G.\nResults are shown in Table 7. While the lasso performs well among the linear models, nonlinear machine\nlearning models consistently outperform linear models. This may be because nonlinear models are better able\nto exploit complex patterns in the data, particularly with regard to between-patient heterogeneity. However,\nnonlinear models can also be prone to overfitting, which may explain why the deep neural network underperformed\ncompared to the gradient boosted decision trees. Overall, the decision model using gradient boosted decision\ntrees achieves the best performance.\nrisk scores from clinical practice\u2014namely, Lindstroem and Tuomilehto (2003), Wilson et al. (2007), Kahn et al.\n(2009), and Rosella et al. (2011). Consistent with our previous findings, our proposed decision model outperforms\nall alternative risk scores.\nfor noise of \u03c3 = 0.1, our decision model still outperforms current practice for k = 10,000 and is only slightly\noutperformed by current practice for noise of \u03c3= 0.5.\nOur population comprises N =100,000 patients. The budget constraint allows us to enroll k=10,000 patients\ninto preventive care. Figure 4 shows the number of prevented diseases for varying training sample sizes Ntrain.\nIt confirms that our decision model converges to the optimal allocation. Moreover, we already yield a close-to-\noptimum performance for a relatively small number of training samples (i. e., fewer than 3,000)."
        },
        {
            "heading": "Appendix D: Causal Sensitivity Analysis",
            "text": "In the following, we analyze how potential unobserved confounders would affect the estimated treatment effects.\nUnobserved confounders refer to unmeasured variables that affect both treatment assignment and the health\noutcome (Cinelli and Hazlett 2020). A prominent example is the socioeconomic status of patients, as wealthier\npatients are often more likely to enroll in preventive care and, furthermore, can afford a healthier lifestyle that\nis responsible for a lower diabetes risk, which thus may underestimate the treatment effect of metformin. Since\nthese confounders are unobserved, we cannot control for them when estimating the effect of a treatment. As a\nremedy, we follow the so-called causal sensitivity analysis from Cinelli and Hazlett (2020) and analyze the effect\nthat an unobserved confounder would have on the treatment effect estimation, if it existed. More precisely, we\nselect an observed variable which affects both treatment assignment and the health outcome and now assume\nthat an unobserved confounder exists with the same strength as the observed one. Then, we check that the\ntreatment effect cannot be explained away and thus remains robust.\nThe age of a patient is generally associated with the likelihood of being prescribed with metformin (e.g., Rosella\net al. 2011) and has also been shown to be strongly associated with the risk of diabetes onset (e.g., Knowler et al.\n2002). Thus, we use the strength of the variable \u201cage\u201d in the following as our reference to make comparisons of\nwhether the treatment effect can be explained away.\nWe follow Cinelli and Hazlett (2020) and use a linear regression. Informed by clinical research (e.g., the\nFramingham risk score), we use a linear regression with the following patient variables, i.e.,\ny= treatment+ age+ sex+weight+ body mass index+ systolic bp+ diastolic bp+height. (38)\nWe then perform causal sensitivity analysis for all patients and first test for the sensitivity of the main effect.\nAfterward, to account for heterogeneity in the treatment effect, we repeat the causal sensitivity analysis for\ndifferent patient subgroups. For this, we segment the patients by their estimated treatment effects into four\ngroups \u2013 A, B, C, D \u2013 using a decision tree regressor, and then perform the causal sensitivity analysis for each\nsubgroup.\nTable 10 shows the results of our causal sensitivity analysis. The results confirm that the estimated treatment\neffect is robust to unobserved confounders. The results are also consistent across all subgroups. Note that the\npatient\u2019s age is considered to be one of the strongest predictors for diabetes (American Diabetes Association\n2022), and, thus, it is very unlikely to have an unobserved confounder of a similar strength. In other words,\nthe treatment effect cannot be explained away by unobserved confounding. In sum, we do not see evidence that\nunobserved confounders may undermine our estimates of treatment effectiveness, which is in line with many\nexisting works using randomized control trials that have already confirmed the effectiveness of metformin (e.g.,\nKnowler et al. 2002)."
        },
        {
            "heading": "Appendix E: Machine Learning Explainability",
            "text": "To determine the most influential predictors, we calculated SHAP values. SHAP values are a unified method for\nmeasuring how much a predictor contributes to the overall model output and, therefore, rank the importance of\nthe features. Moreover, they indicate whether higher (lower) values of a predictor are associated with an increased\nrisk of diabetes onset.\nFigure 5 shows the ten most important predictors for the gradient boosted decision tree when predicting dia-\nbetes onset. The most important predictors are age, body mass index (BMI), and the current glycated hemoglobin\nlevel (HbA1c). Age and BMI are well known risk factors for diabetes, and both were accordingly among the\nmost important predictors for our gradient boosted decision tree (Abbasi et al. 2016). Also among the ten most\nimportant predictors are the red cell distribution width and thyroid stimulating hormone tests, which have both\nbeen found in the medical literature to be predictors for diabetes (e. g., Chaker et al. 2016). The height and\nweight of the patient are also among the ten most important predictors, yet with less importance. This is likely\ndue to the fact that the predictive power of these variables as individual predictors is limited, and only their\ncombination (as in the BMI) leads to an important predictor.\nWe discussed our results with medical experts from diabetes care, who confirmed to us that these predictors\nare well-established risk factor for diabetes."
        },
        {
            "heading": "Appendix F: Calibration of Machine Learning Model",
            "text": "We use two techniques to improve the calibration of our machine learning model. Here, the aim is that the\ndistribution of the predicted probability is similar to the distribution of the observed probability in the training\ndata. First, we use the synthetic minority over-sampling technique (SMOTE) (Chawla et al. 2002) to oversample\nobservations from patients who develop diabetes. Second, we use Platt scaling to calibrate the predicted class\nprobabilities (Niculescu-Mizil and Caruana 2005). Figure 6 shows the calibration plot for our gradient boosted\ndecision trees after resampling. The calibration plot shows a good calibration."
        },
        {
            "heading": "Appendix G: Hyperparameter Tuning",
            "text": "We determined the hyperparameters using Bayesian optimization with 100 iterations of optimization. Table 11\nlists the tuning ranges for each parameter. In the Bayesian optimization, the initial parameters are sampled\nfrom a uniform distribution. We implemented and evaluated all decision models in Python. The lasso, ridge\nregression, and random forest machine learning models are implemented using scikit-learn. The deep neural\nnetwork is implemented using Pytorch. We train the deep neural network using the Adam optimizer. We use\nReLU activation in the hidden layers and sigmoid in the output layer. The objective of the optimizer is to\nminimize the binary cross-entropy. The gradient boosted decision trees are implemented using LightGBM. For\nthe causal forest, we keep all parameters at their default values. That is, we set the number of estimators to 10,\nthe number of features to consider when looking for the best split to 10, the maximum depth of the trees to 5,\nthe minimum number of samples required to be split at a leaf node to 100, and the minimum number of samples\nrequired of the experiment group to be split at a leaf node to 10."
        },
        {
            "heading": "Appendix H: Applicability for Settings with Known Treatment Effects",
            "text": "Here, we aim to demonstrate the applicability of our model in settings where the treatment effect of preventive\ncare is known. In such a case, there is no need for healthcare organizations to perform counterfactual inference\nfor treatment effect estimation, as the treatment effect can the be directly entered in the decision model.\nTo show the applicability of our decision model, we build upon a different setting. Recall that we examined\nmetformin in the main paper. The reason was that it represents the quasi-standard for preventive care aimed at\nindividuals at risk of developing diabetes in current medical practice (Long and Fox 2016). Several studies also\nsuggest a risk reduction if patients are enrolled in personalized coaching toward a healthier lifestyle; however, such\npersonalized coaching is currently not covered by health insurers in many countries (e. g., Germany, Switzerland,\nand Medicare in the United States). Nevertheless, it may be interesting to study the cost-effectiveness of lifestyle\ncoaching for diabetes prevention.\nIn the case of personalized coaching, the goal of preventive treatment is to achieve lifestyle changes of the\npatients. Lifestyle changes have not been prescribed to the customers of our partnering health insurer. Thus, the\ntreatment effect cannot be estimated through stage 1 of our decision model. Instead, we rely on prior literature\nthat has estimated the treatment effect of personalized coaching through randomized controlled trials (Knowler\net al. 2002).\nWe assume a treatment effect due to personalized coaching of \u03b3i,l\u2217 = 0.58 (Knowler et al. 2002) that is expo-\nnentially decreasing over time, i. e.,\n\u03b3i,l = \u03b3i,l\u2217+1 exp(l \u2217 \u2212 l), for l\u2265 l\u2217. (39)\nWe set the annual cost of personalized coaching to Cprevent = 1,600 (Azelton et al. 2021).\nTable 12 shows the empirical results. Here, we again compare the data-driven allocations from our decision\nmodel against that from current practice. Our findings are line with the results from the main paper: our decision\nmodel outperforms current practice across all metrics.\nTo sum up, there are different benefits of whether the treatment effect is (a) known or (b) estimated through\nstage 1 of our decision model. A benefit of (a) is that healthcare organizations can leverage known treatment\neffects from randomized controlled trials, which represent the gold standard for measuring treatment effects.\nIn particular, there is no bias due to unobserved confounders. A benefit of (b) is that randomized controlled\ntrials are not always available or otherwise costly, because of which our estimation may be preferred in prac-\ntice. Moreover, using counterfactual inference in our decision model offers a mathematical approach to directly\nlearn heterogeneous treatment effects and thus account for the differential effectiveness of preventive care across\npatients."
        }
    ],
    "title": "Data-Driven Allocation of Preventive Care With Application to Diabetes Mellitus Type II",
    "year": 2023
}