{
    "abstractText": "This is an exciting era for e xo-planetary e xploration. The recently launched JWST, and other upcoming space missions such as Ariel, Twinkle, and ELTs are set to bring fresh insights to the convoluted processes of planetary formation and evolution and its connections to atmospheric compositions. Ho we ver, with ne w opportunities come ne w challenges. The field of exoplanet atmospheres is already struggling with the incoming volume and quality of data, and machine learning (ML) techniques lands itself as a promising alternati ve. De veloping techniques of this kind is an inter-disciplinary task, one that requires domain knowledge of the field, access to rele v ant tools and expert insights on the capability and limitations of current ML models. These stringent requirements have so far limited the developments of ML in the field to a few isolated initiatives. In this paper, We present the Atmospheric Big Challenge Database (ABC Database), a carefully designed, organized, and publicly available data base dedicated to the study of the inverse problem in the context of exoplanetary studies. We have generated 105 887 forward models and 26 109 complementary posterior distributions generated with Nested Sampling algorithm. Alongside with the data base, this paper provides a jargon-free introduction to non-field experts interested to dive into the intricacy of atmospheric studies. This data base forms the basis for a multitude of research directions, including, but not limited to, developing rapid inference techniques, benchmarking model performance, and mitigating data drifts. A successful application of this data base is demonstrated in the NeurIPS Ariel ML Data Challenge 2022.",
    "authors": [
        {
            "affiliations": [],
            "name": "Quentin Changeat"
        },
        {
            "affiliations": [],
            "name": "Kai Hou Yip"
        }
    ],
    "id": "SP:2854a5ad588b9b7d4ae248e43c381526962cd901",
    "references": [],
    "sections": [
        {
            "text": "RASTAI 2, 45\u201361 (2023) https://doi.org/10.1093/rasti/rzad001 Advance Access publication 2023 January 23\nESA-Ariel Data Challenge NeurIPS 2022: introduction to exo-atmospheric studies and presentation of the Atmospheric Big Challenge (ABC) Database\nQuentin Changeat 1 , 2 \u2039\u2020 and Kai Hou Yip 2 1 European Space Agency (ESA), ESA Office, Space Telescope Science Institute (STScI), 3700 San Martin Drive, Baltimore, MD 21218, USA 2 Department of Physics and Astronomy, Gower St., London WC1E 6BT, UK\nAccepted 2023 January 10. Received 2023 January 5; in original form 2022 June 29\nA B S T R A C T This is an exciting era for e xo-planetary e xploration. The recently launched JWST, and other upcoming space missions such as Ariel, Twinkle, and ELTs are set to bring fresh insights to the convoluted processes of planetary formation and evolution and its connections to atmospheric compositions. Ho we ver, with ne w opportunities come ne w challenges. The field of exoplanet atmospheres is already struggling with the incoming volume and quality of data, and machine learning (ML) techniques lands itself as a promising alternati ve. De veloping techniques of this kind is an inter-disciplinary task, one that requires domain knowledge of the field, access to rele v ant tools and expert insights on the capability and limitations of current ML models. These stringent requirements have so far limited the developments of ML in the field to a few isolated initiatives. In this paper, We present the Atmospheric Big Challenge Database (ABC Database), a carefully designed, organized, and publicly available data base dedicated to the study of the inverse problem in the context of exoplanetary studies. We have generated 105 887 forward models and 26 109 complementary posterior distributions generated with Nested Sampling algorithm. Alongside with the data base, this paper provides a jargon-free introduction to non-field experts interested to dive into the intricacy of atmospheric studies. This data base forms the basis for a multitude of research directions, including, but not limited to, developing rapid inference techniques, benchmarking model performance, and mitigating data drifts. A successful application of this data base is demonstrated in the NeurIPS Ariel ML Data Challenge 2022.\nKey words: planets and satellites: atmospheres \u2013 telescopes \u2013 methods: data analysis.\n1\nT fi o C 2 S h m d B t d ( a t e p s\n\u2020\nP t f m\nt f e S W B C C S e i r t f a\n\u00a9 P C p\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024 C O N T E X T he field of exoplanet has come a long way since the discovery of the rst exoplanet in 1994 (Wolszczan & Frail 1992 ). With the launch f dedicated telescopes for the detection of exoplanets, such as the onvection, Rotation et Transits plan \u0301etaires ( CoRoT ; P \u0308atzold et al. 012 ), the Kepler (Borucki et al. 2010 ), and the Transiting Exoplanet urvey Satellite ( TESS ; Ricker et al. 2015 ) space telescopes, we now ave basic characteristics, such as planetary radii or masses, for ore than 5000 alien worlds. From the observed population, we educed that, while exoplanets are ubiquitous (Cassan et al. 2012 ; atalha 2014 ), the architecture of our Solar system does not appear\no be a typical outcome of planetary formation. For instance, the first etected exoplanet around a sun-like star is classified as a hot Jupiter Mayor & Queloz 1995 ), a planet of a similar size to Jupiter (e.g. bout 10 times the size of Earth) but orbiting so close to its host star hat it completes a full revolution in about 4 d. Such planet does not xist in our Solar system and so are the majority of the observed lanets, referred as sub-Neptunes due to their size being between the ize of Earth and Neptune (Howard et al. 2010 ; Fulton et al. 2017 ;\nE-mail: quentin.changeat.18@ucl.ac.uk ESA Research Fellow.\nb w T M\nThe Author(s) 2023. ublished by Oxford University Press on behalf of Royal Astronomical Society. Th ommons Attribution License ( http://cr eativecommons.or g/licenses/by/4.0/), whic rovided the original work is properly cited.\netigura et al. 2022 ). To answer the most fundamental questions of he field, such as \u2018what are exoplanets made of?\u2019 or \u2018how do planets orm?\u2019, one must obtain complementary information to planetary asses and radii. In the last decade, astronomers have therefore turned their attention o exoplanetary atmospheres, or exo-atmospheres, in the quest for urther constraints on these worlds (Charbonneau et al. 2002 ; Tinetti t al. 2007 ; Swain, Vasisht & Tinetti 2008 ; Kreidberg et al. 2014 ; chwarz et al. 2015 ; Sing et al. 2016 ; Stevenson et al. 2017 ; de it et al. 2018 ; Hoeijmakers et al. 2018 ; Tsiaras et al. 2018 , 2019 ; rogi & Line 2019 ; Welbanks et al. 2019 ; Edwards et al. 2020 ; hangeat & Edwards 2021 ; Roudier et al. 2021 ; Yip et al. 2021a ; hangeat et al. 2022 ; Chen et al. 2022 ; Edwards et al. 2022 ; Estrela, wain & Roudier 2022 ; Mikal-Evans et al. 2022 ). The study of xoplanet atmospheres has been enabled by the use of space-based nstrumentation, such as the Hubble Space Telescope ( HST ), the etired Spitzer Space Telescope , and ground-based facilities such as he Very Large Telescope (VLT). Many discoveries were made. We, or instance, know that water vapour is present in many hot Jupiter tmospheres, and we have recently reco v ered evidence for links etween atmospheric chemistry and formation pathways. Ho we ver, ith the recent launch of the N ASA/ESA/CSA J ames Webb Space elescope ( JWST ; Greene et al. 2016 ), and the upcoming ESA Ariel ission (Tinetti et al. 2021 ) and BSSL Twinkle Mission (Edwards\nis is an Open Access article distributed under the terms of the Creative h permits unrestricted reuse, distribution, and reproduction in any medium,\nR\ne r m\ne c s r u t r f u S L 2 H t s p p d d c a t 1 m i e o a E s i o a e 2\na p c m c t M F t b ( 2 e H f i e\nD r t t\ni h\nt a o o\nr f a s r r\nt c\nm n\nw p d a m ( i e c A\n2\nF 2 r l t s t d e s\n2\nT w t T d p d\nl c T f a o\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024\nt al. 2019b ), the field of exoplanetary atmosphere will undergo a evolution. The quality and quantity of atmospheric data will be ultiplied exponentially, bearing many new challenges. One of the main challenge in the study of exo-atmospheres, ven today, concerns with the reliable extraction of information ontent from observed data. Atmospheres are complex dynamical ystems, involving many physical processes (chemical and cloud eactions, energy transport, fluid dynamics) that are coupled, poorly nderstood, and difficult to reproduce on Earth. Astronomers have herefore attempted to interpret observations of atmospheres using etrie v al techniques: simplified models (or reduced order models) or which the parameter space of possible solutions is explored sing a statistical framework (Irwin et al. 2008 ; Madhusudhan & eager 2009 ; Line et al. 2012 , 2013 ; Waldmann et al. 2015a,b ; avie et al. 2017 ; Gandhi & Madhusudhan 2018 ; Molli \u0300ere et al. 019 ; Zhang et al. 2019 ; Min et al. 2020 ; Al-Refaie et al. 2021 ; arrington et al. 2022 ). With current observational data, state-ofhe-art retrie v al models use sampling based Bayesian techniques, uch as MCMC or Nested Sampling, with non-informative (uniform) riors to obtain the posterior distributions of between 10 and 30 free arameters (Changeat et al. 2021a ). The number of free parameters epends on the information content available in the observational ata and the chosen atmospheric model. As of today, there is no onsensus on the most appropriate atmospheric model to employ, nd we cannot obtain in-situ observations (e.g. we cannot travel here). Sampling-based techniques typically require between 10 5 and 0 8 forward model calls to reach convergence, meaning that only odels providing spectra of the order of seconds are viable. With the ncrease in data quality, thanks to JWST , Ariel, and Twinkle, it will nable a wider range of atmospheric processes to be probed by the bservations, implying that forward models must grow in complexity nd so does the dimensionality of the problem (The JWST Transiting xoplanet Community Early Release Science Team et al. 2022 ). As uch, interpreting next-generation telescope data is currently a real ssue, which has been highlighted multiple times by studies relying n simulations, that will require a revolution in both our models nd information extraction techniques (Rocchetto et al. 2016 ; Caldas t al. 2019 ; Changeat et al. 2019 ; Taylor et al. 2020 , 2021 ; Yip et al. 020 ; Changeat et al. 2021a ; Al-Refaie et al. 2022a ; Yip et al. 2022a ). In recent years, the community started to e xplore alternativ e pproaches to circumvent the bottleneck with sampling based aproaches. Machine learning (ML) models land itself as a promising andidate with its high flexibility and rapid inference time. Waldann ( 2016 ) pioneered the use of deep learning network in the ontext of atmospheric retrie v al, training a Deep Belief Network o identify molecules from simulated spectra. On the other end,  \u0301arquez-Neila et al. ( 2018 ) led the first attempt to train a Random orest re gressor to predict planetary parameters directly. Since then, he field has started to look at different ML methodologies to ypass the lengthy and computationally intensi ve retrie v al process Soboczenski et al. 2018 ; Zingales & Waldmann 2018 ; Cobb et al. 019 ; Hayes et al. 2020 ; Nixon & Madhusudhan 2020 ; Oreshenko t al. 2020 ; Ardevol Martinez et al. 2022 ; Haldemann et al. 2022 ; imes et al. 2022 ; Yip et al. 2022a ). Pushed by astronomers\u2019 need or explainable solutions, other groups have also looked into the nformation content of exoplanetary spectra with AI (Guzm \u0301an-Mesa t al. 2020 ; Yip et al. 2021b ).\nThe publicly available Atmospheric Big Challenge (ABC) atabase of forward models and retrie v als aims to provide the esources to address aforementioned issue via participation of exernal communities and encourage no v el, cross-disciplinary soluions. It is constructed as a permanent data repository for further\nASTAI 2, 45\u201361 (2023)\nnvestigations. The data base is accessible at the following link: ttps:// doi.org/ 10.5281/ zenodo.6770103 . Since the creation of similar data base constitutes a major barrier o anyone interested in applying ML in the domain of exoplanet tmospheres, we emphasize on its release as a community asset. The rganization and creation of this data set poses a challenge on its wn because of the following:\n(i) It requires a cross-disciplinary collaboration. The problem equires domain knowledge (atmospheric chemistry, radiative transer, atmospheric retrie v als) to ensure the data product represents meaningful science case rather than a trivial example. At the ame time, it requires ML expertise to ensure the data product is epresentative of the problem at hand, and ideally, one that adequately eflects the reality.\n(ii) It requires access to the rele v ant tools which is often e xclusiv e o communities in exoplanet: atmospheric retrie v al and chemistry odes as well as instrument noise simulators.\n(iii) It requires significant computing resources. For this project, ore than 2000 000 CPUh were used. Simulations of this scale have\never been attempted before.\nThis paper is written to (1) provide non-field experts with a lighteighted introduction to the science behind the data generation rocess, (2) document the steps involved in the creation of the ABC ata base, and (3) to provide a carefully curated, well-organized, nd scientifically rele v ant data set for any research community. This anuscript complements the data challenge proposal description Yip et al. 2022b ) accepted as a NeurIPS 2022 data challenge. It s intended to provide the required domain knowledge for non-field xperts. We present a simplified jargon-free introduction to the most ommonly employed techniques in the field of exo-atmospheres in ppendix A .\nDA TA G E N E R A T I O N\nor the data generation, we employed ALFNOOR (Changeat et al. 021a ), a tool built to expand the forward model and atmospheric etrie v al capabilities of TauREx 3 (Al-Refaie et al. 2021 ) to arge populations of exo-atmospheres. ALFNOOR allows to automatize he generation or telescope simulations and perform large-scale tandardized atmospheric retrie v als. A lightweight description of he main concepts behind atmospheric studies of exoplanets are escribed in Appendix A . In the context of ESA-Ariel, we genrated 105 887 simulated forward observations as well as 26 109 tandardized retrie v al outputs.\n.1 Source of input parameters\no model those extrasolar systems, some preliminary assumptions ere required. In particular, all the parameters that are not linked\no the atmospheric chemistry needed to be fixed to realistic values. hose parameters include, but are not limited to, stellar radius ( R s ), istance to Earth ( d ), star magnitude K ( K mag ), planetary radius ( R p ), lanetary mass ( M p ), planet equilibrium temperature ( T ), and transit uration ( t 14 ). The planetary objects in this data base were selected from the ist of confirmed known exoplanets and the list of TESS exoplanet andidates (TOIs). This list was constructed as part of the ESA-Ariel arget list initiative (Edwards et al. 2019a ; Edwards & Tinetti 2022 ), rozen to 2022 March 1 for this data base. For the TOIs, we are ware that some of those objects will not be exoplanets; ho we ver, the bservation of their transit by TESS and the first preliminary checks\nFigure 1 Size of the considered planets versus the mass of their host star. We exclude planets that have radii below 1.5 R \u2295 marked in grey and approximately corresponding to the lower limit on the Radius Valley.\no o o r s o r i t t M c t n d t p\np a v H W p s s t m\n2\nW d K l g t s l\nf\nt C 2 & e 2 e 2 o d c c t c b I o a m w a i f i h D g e a t C\nt f R\nc e o a s m R 1 o h t n s w n\n1 Spectra have to be computed at high-resolution ( R ) since instrumental binning is done on the received photons, e.g. the recorded transit depth . In our case, we used R = \u03bb/ \u03bb = 10 000.\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024\nf their inferred properties make them compelling objects. Follow-up bservations will allow us to classify their nature, but for the purpose f building this data base, they are as close as possible to what the eality looks like. As radial velocity follow-ups cannot and is not ystematically conducted for all targets, the mass of some of those bjects is unknown. In this case, as in Edwards & Tinetti ( 2022 ), we eplace the planetary mass by an estimate from the relation described n Chen & Kipping ( 2017 ). To those lists of objects, we filtered all he planets with radius below 1.5 R \u2295, the conserv ati ve v alue for he middle of the Radius Valley (Fulton et al. 2017 ; Cloutier & enou 2020 ; Petigura et al. 2022 ). This is because the atmospheric omposition of small planets would require a much more complex reatment (e.g. the assumption of hydrogen-dominated atmosphere is ot theoretically sound) than is proposed here. In total, we obtained ata for 2972 confirmed exoplanets and 2928 candidate exoplanets, hus bringing our total to 5900 unique objects. The list of selected lanets for this database is shown in Fig. 1 . Fig. 2 shows the distributions of nine selected stellar and planetary arameters. These values are taken from the actual planetary system nd therefore follows the current observed demographics, these alues remains unchanged thorough the data generation process. o we ver, relying on currently known planets is a double-edged knife. hile it saved us from making unverified assumptions, our data are rone to selection bias stemmed from the observation technique, trategy, and instrument specification. These biases can be easily pot from Fig. 2 . For instance, the distribution of orbital period tends o be shorter (peaks around \u223c3 d) as their proximity to the host star akes them easier to disco v er. .2 The atmospheric forward model setup\ne produce batches of randomized observations for the population escribed in the previous section. For each planet, the stellar ( R s , d , mag ), orbital ( t 14 ), and bulk parameters ( R p , M p , T ) are fixed to their iterature values, while the chemistry of the atmosphere is randomly enerated. The thermal profile is assumed to be isothermal (constant emperature) at the equilibrium temperature of the planet, and we imulate the planet\u2019s atmosphere from 10 to 10 \u221210 bar using 100 ayers (divided uniformly in log-pressure space).\nFor the chemistry, we assume a primary atmosphere made mainly rom hydrogen and helium (He/H 2 = 0.17), to which we add\nrace gases. The trace gases are H 2 O (Polyansky et al. 2018 ), H 4 (Yurchenko et al. 2017 ; Chubb et al. 2021 ), CO (Li et al. 015 ), CO 2 (Yurchenko et al. 2020 ), and NH 3 (Coles, Yurchenko Tennyson 2019 ), selected based on our current understanding of xoplanetary chemistry (Ag \u0301undez et al. 2012 ; Venot & Ag \u0301undez 015 ; Drummond et al. 2016 ; Madhusudhan et al. 2016 ; Stock t al. 2018 ; Woitke et al. 2018 ; Venot et al. 2020 ; Baeyens et al. 022 ; Al-Refaie et al. 2022a ). The mixing ratio, or trace abundance, f those gases is randomly chosen using a Log Uniform law and epends on the molecule considered. The Log Uniform law is hosen rather than a more informative law (such as equilibrium hemistry) because we are looking for solutions that are unbiased o our current, most likely limited, understanding of atmospheric hemistry. Such training set is suitable to produce ML solutions ehaving in a similar way to the so-called free chemistry retrie v als. f correlation exists in a real population (e.g. between the chemistry f the atmosphere and its thermal structure), such method should llow the extraction of this trend without the need to implicitly ake a physical assumption. Note that this is required in the cases here data have undergone a data shift (in this case, when the data re generated using a different atmospheric assumption). Another mportant point to consider involves the detection capabilities of Ariel or each molecule and the de generac y between molecular species. For nstance, CO shares similar features to CO 2 in Ariel but it is a much arder molecule to detect due to its weaker absorption properties. ue to those differences in the strength of spectral features and uided by the Ariel Tier-2 detection limits investigated in Changeat t al. ( 2020a ), we select different bounds for the randomized chemical bundances. This process allows us to balance our data set and ensure hat a significant fraction of the planets have detectable amount of O. The bounds employed for this data set are as follows:\n(i) H2O: RandomLogUniform(min = \u22129, max = \u22123). (ii) CO: RandomLogUniform(min = \u22126, max = \u22123). (iii) CO2: RandomLogUniform(min = \u22129, max = \u22124). (iv) CH4: RandomLogUniform(min = \u22129, max = \u22123). (v) NH3: RandomLogUniform(min = \u22129, max = \u22124). For each parametrized atmosphere, we compute the radiative ransfer (see Appendix A) layer by layer, including the contributions rom molecular absorption, Collision Induced Absorption (CIA), and ayleigh Scattering. Each spectrum is first computed at a high resolution, 1 before being onvolved with an Ariel instrument simulation. For each planet, we mployed the TauREx plugin for ARIELRAD (Mugnai et al. 2020 ), the fficial Ariel noise simulator, to estimate the noise on observation t each wavelength. With ARIELRAD , we force each observation to atisfy the criteria for Ariel Tier 2 observations (Tinetti et al. 2021 ), eaning that the observations have a specific resolution profile (e.g: \u2248 10 for 1.10 < \u03bb < 1.95 \u03bcm; R \u2248 50 for 1.95 <\u03bb < 3.90 \u03bcm; R \u2248 5 for 3.90 < \u03bb < 7.80 \u03bcm) and that the signal-to-noise ratio (SNR) f the observations must be higher than 7 on average. The SNR is ere defined on the atmospheric signal (e.g. the second part of equaion A2 ). To produce the simulated spectra, we select the minimum umber of transit that allow to reach this threshold, meaning that our ample of observations contains a wide range of final SNR. Since e used real objects for those simulations and that all planets are ot fa v ourable targets for Ariel, this means that some targets require\nRASTAI 2, 45\u201361 (2023)\nR\nFigure 2 Distribution of nine stellar and planetary parameters used to generate the synthetic spectra. These distributions follow closely to the actual demographic of the currently known population of exoplanets, and therefore they are also subject to biases presented in the original population.\na o p\no s w\n2\nF a u\nt f H i 1 1 O p\nt t m p t t\nd m\n2\nF e O a S\nw a T s c t o a s i t s\n2 Latest studies show that Super-Earth sized planets are pre v alent while there is a deficiency in the population of sub-Neptunes. 3 Transit technique tends to fa v our larger planets.\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024\nn un-realistic number of observations to reach the SNR condition f Tier 2. Ho we ver, this does not af fect the purpose of this data set, roviding independent instances of realistic noise profiles. Following those steps, we obtain a realistic Ariel simulated bservation for each planet and each randomized chemistry. We how an example of such simulated observation in Fig. 3 . In total, e produced 105 887 simulated observations for the ABC Database. .3 The atmospheric retrieval setup or 26 109 (25 per cent) of the simulated observations generated t the previous step, we perform the traditional inversion technique sing ALFNOOR . For the model to optimize, we kept the same setup as presented in he previous section and performed parameter search on the following ree parameters: isothermal temperature (T), log abundances for 2 O, CO 2 , CH 4 , CO, and NH 3 . The priors are made wide and un-\nnformative, with the atmospheric temperature being fitted between 00 and 5500 K and the chemical abundances between 10 \u221212 and 0 \u22121 in Volume Mixing Ratios. The widely used Nested Sampling ptimizer, MULTINEST (Feroz, Hobson & Bridges 2009 ), was emloyed with 200 live points and an evidence tolerance of 0.5. For a single example on Ariel data, we provide the best-fitting specrum in Fig. 3 . From the optimization process, we are able to extract he traces of each parameters and the weights of the corresponding\nodels. This allows to construct the posterior distribution of the free arameters with, for instance, corner . The posterior distribution of he same example is shown in Appendix B, Fig. C1 . Processing of he posterior distribution also allows to extract statistical indicators\nASTAI 2, 45\u201361 (2023)\nescribing the chemical properties of the planet, such as mean, edian, and quantiles for each of the investigated parameters.\n.4 Data o v er view\nollowing the data generation process outlined above, we have genrated a total of 105 887 forward models in Ariel Tier-2 resolution. f them, 26 per cent of them are complemented with results from tmospheric retrie v al (follo wing a generic setting as described in ection 2.3 ). Fig. 4 shows the distribution of mean transit depth (red) o v erlapped ith the distribution of feature height (orange). The former served s a proxy of the diverse planetary classes present in the data set. he characteristic dichotomy stemmed from current demographics tudies 2 and selection bias in our observation technique. 3 The latter is alculated from the difference between the maximum and minimum ransit depth of each spectrum, it served as a proxy of the \u2018strength\u2019 f the spectroscopic features presented in the spectra, e.g. the peaks nd troughs as seen in Figs A2 and 3 . We note that an SED with linear lope will also produce a non-negligible feature height value, which s still considered as spectroscopic feature in our case. The two quanities are closely linked to our targets of interest, which means that any uccessfully model not only need to account for the inter-variation\nFigure 4 Distribution of the mean transit depth (red) o v erlapped with the distribution of the feature height (orange), both measured in a logarithm scale. The dichotomy displayed in mean transit depth distribution stemmed from the observational demographics of planet radius, showing the diversity of currently known exoplanets in our data set. On the other hand, the feature height documents the \u2018strength\u2019 of spectroscopic features in each spectrum (such as absorption features or strong trends induced by Rayleigh Scattering). Any successful model must be able to account for the variations in both scales.\nb v o\no i s o i t s r r d F\n4\np\nc T i o C r t l f f\np\n2\nT f c\n2\nL p b f B\nw\na\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024\netween different spectra, it also needs to take into account the intraariation across wavelength channels, which is always one to three rders of magnitude smaller than the variation in mean transit depth. Next we will look at results from atmospheric retrie v al. The quality\nf the retrieved product is closely related to the information content of ndividual spectrum, which is a function of the wavelength coverage, ize of the spectral bin, observational uncertainties and the abundance f the molecule. Fig. 5 compares the retrie v al results against the nput values of the six targets of interest (H 2 O, CO 2 , CH 4 , CO, NH 3 , emperature). Each data point in every subplot represents a single pectrum and is coloured in accordance to the size of the inter-quartile ange (IQR). 4 Points lying along the diagonal line \u2013 those that are etrieved correctly \u2013 tend to have tighter constraint, while points that eviate from the diagonal line tend to entail larger uncertainties. or most gases there is a transition region where molecules at\nHere we define IQR as the difference between the 84th and the 16th ercentile.\nt t\nertain abundance level starts to depart from the diagonal line. he extent and onset of the transition region is a function of the nstrument specification (e.g. its detection limits), the composition f the atmosphere and the strength of the molecular absorption. hangeat et al. ( 2020a ) pioneered an initial study of this transition egion and derived the detection limit for each gas based on the size of he errorbar obtained. Here, we find similar results, and the detection imits of Ariel correspond to the region where all the retrieved values rom Fig. 5 deviate from the diagonal line (associated with colours rom green to red).\nAppendix D continues our discussion into other aspects of the data roduct.\n.5 Structure of the ABC data base\nhe data base contains two levels of data product: The first level is or general use and the second level is designed specifically for the ompetition. We will describe each level next.\n.5.1 Level 1: cleaned data\nevel 1 contains data products for general use. As TauREx 3 erforms forward modelling and retrie v al on a planet-by-planet asis. The data are pre-processed to provide an unified structure or ef fecti ve data navigation and a foundation for further processing. elow is the list of operations we performed:\n(i) Remo v ed an y spectra with NaN values. (ii) Remo v ed spectra with transit depth larger than 0.1 in any\navelength bins. (iii) Remo v ed spectra with transit depth smaller than 1 \u00d7 10 \u22128 in\nn y wav elength bins. (iv) Standardized units and data formats. (v) Extracted all Stellar, Planetary and Instrumental metadata. (vi) Combined all instances into a single, unified file.\nLevel 1 data are organized into all data.csv , observaions.hdf5 and all target.hdf5 . all data.csv con-\nains information on the planetary system and the input values for\nRASTAI 2, 45\u201361 (2023)\nR\nFigure 5 Comparison of the retrieved values against the input values for six different targets. Each data point represents a single instance and is colour-coded according to the respective size of the IQR. Ariel data at Tier-2 resolution are able to place tight constrain on the temperature and most molecules down to a certain abundance. Beyond that, the retrie ved v alues starts to deviate from the diagonal and becomes less constrained, highlighting the limitations of the telescope.\nt t t a 2 N\n2\nT o t w m s r p\ni\ni\n5\ns p\np\n9 r c i d a\n2\nP p J s d a r t\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024\nhe generation process, observations.hdf5 contains informaion on indi vidual observ ations and all target.hdf5 contains he corresponding retrie v al results (posterior distributions of each tmospheric targets). In total, there are 105 887 planet instances, 5 per cent of them (26 109) has complementary retrie v als from ested Sampling. .5.2 Level 2: curated data for model training he following section is designed for statistical model training. In rder to allow for the broadest possible participation and minimize he o v erhead for non-field e xperts, we pre-processed the data set ith our domain knowledge so that the end product is ready for odel development. At the same time, we have tailored the train/test plit procedure in order to allow a diverse array of solutions and esearch directions. Here we outlined the list of operations we erformed:\n(i) Remo v ed data with less than 1500 points in the tracedata. This s to allow for more accurate comparison.\n(ii) Remo v ed un-informativ e and duplicated astrophysical and nstrumental features. 5\nASTAI 2, 45\u201361 (2023)\nIncluding star magnitudeK, star metallicity, star type, planet type, tar type, star mass kg, star radius m, planet albedo, planet impact param, lanet mass kg, planet radius m, planet transit time, instrument nobs.\n3\nW c c\n(iii) Split data into training and test sets (more details in Apendix E ).\nAfter performing the abo v e operations, the training data has 1 392 planet instances with 21 988 of them has complementary etrie v als results. The test data have 2997 instances, all of which are omplemented with retrie v al results. There is a notable difference n terms of the volume of data between Level 1 and Level 2 data ue to the pre-processing step and train/test split . We have devoted section in Appendix E to describe the Level 2 data in details.\n.6 Additional r esour ces\nublished along with the data base, we provide a series of comlementary resources. In particular the data base is provided with a upyter Notebook describing the data structure, how to load the data et, and demonstrating its main characteristics. We also include a edicated TauREx 3 tutorial for those eager to learn the practical spects of building forward models and performing atmospheric etrie v als. All those resources are available under the same link as he data base.\nOPEN C H A L L E N G E S\nith the constructed data set, we intended to accelerate and inenti vize dedicated ef forts to tackle a number of open challenges ommon to both the exoplanet field and the ML field.\n3\nO a d c m 2 p\n3\nM t p B\nl a a w t m\nd t c f P M o e c r h t\n3\nA c t t f S q t u s t &\n3\nT T o s w s a\nS e\n4\nT m t o r\nm m c c n W y a c\nd m\ne w\nm e 2 c i a m e\no c a e & e t a r e 2 H H\n5\nW g i t c c\n6 The main simulation code, TAUREX 3 , is open-source and publicly available at: ht tps://github.com/ucl-exoplanet s/TauREx3 public .\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024\n.1 Fast and accurate Bayesian Inference\nne of the aims of the data base is to enable the development of dvanced inference methods that are (1) able to produce posterior istrib utions, b ut at the same time, will not require as much omputational resources compared to conventional sampling-based ethods. This activity is proposed as part of the goal of the NeurIPS 022 competition with simplified atmospheric cases and has already ro v en v ery successful (Yip et al. in preparation).\n.2 Estimating and mitigating the effect of data shifts\nL models are prone to potential performance degradation when he incoming data are different from the training distribution. This henomenon is commonly known as data shifts (e.g. Lu et al. 2018 ; ayram, Ahmed & Kassler 2022 ). Any ML application to the study of exoplanetary atmosphere are ikely to experience data shifts. Most ML models in the literature re currently limited to simulation-based inference as the amount of ctual spectroscopic observations are fall short for model training, hich has to be supplemented by simulations. The discrepancy beween our simplistic atmospheric models and the actual atmosphere eans that data shift is inevitable (Humphrey et al. 2022 ). To emulate this situation, the test set in level 2 data are specifically esigned to include chemical equilibrium forward models for which he provided ground truth from atmospheric retrie v als assumed free hemistry. In some cases, clouds are included in the forward model to orce degenerate behaviours in the test set (Line & Parmentier 2016 ; inhas & Madhusudhan 2017 ; Mai & Line 2019 ; Barstow 2020 ; ukherjee, Batalha & Marley 2021 ; Changeat et al. 2021b ). Those ffsets between training and test sets were voluntarily introduced to v aluate whether the performance of ML solutions remain robust and onsistent under \u2018unseen\u2019 distributions (this is typically the case in eal life since we know little about real exo-atmospheres) and if they ad correctly learned to faithfully reproduce the Bayesian retrie v al echnique.\n.3 Adaptation to other atmospheric assumptions\ntmospheric models are physical models built on varying level of omplexities and modelling assumptions. ML models, ho we ver, are rained to optimize their performance with respect to the provided raining set/training assumptions. In this data set, we have included orward models built from two different modeling assumptions, imple chemsitry and Equilibrium Chemistry. It remains an open uestion as to how easy one can \u2018switch\u2019 from one model assumption o another. In terms of ML terminology, this kind of learning falls nder the umbrella of transfer learning/domain adaptation, where one trives to adopt to from source domain (original training set) to the arget domain with a limited number of training examples (Wilson Cook 2020 ).\n.4 Benchmarking different retrieval techniques\nhe built data set can be used for more traditional code comparisons. he TauREx retrie v al code was rigorously benchmarked against ther established codes (Barstow et al. 2020 , 2022 ). With this data et, the exoplanet community now has access to a wide range of ell-referenced forward models and retrie v al runs that can be used for tandard benchmarking of atmospheric models (e.g. forward models) nd a diverse array of retrieval techniques (e.g. MCMC, Nested\nampling, Normalizing Flows: F oreman-Macke y et al. 2013 ; Feroz t al. 2009 ; Buchner 2021 ; Yip et al. 2022a ).\nF U T U R E EXPA NSI ON O F A B C DATA BA SE\nhe data base currently builds on highly simplified atmospheric odel assumptions (constant or equilibrium chemistry, isothermal\nemperature, clear atmosphere). This is done to (1) gauge the success f such initiatives and (2) provide a rich data set to complete the equired task.\nFuture iterations could explore more complex atmospheres with uch more limited amount of training examples. This is because, as ore complexity is embedded into the model (e.g. GCMs, complex\nhemistry, stellar acti vity ef fects), the computation of a single sample an take months. In this instance traditional parameter sampling is ot an option, and faster AI accelerated techniques will be required. e therefore plan to further extend this data base over the coming ears and provide new training/test sets to develop both exoplanet nd ML activities. For example, future instances of this data base ould feature the following:\n(i) JWST and HST complementary data sets: This would allow to evelop telescope-independent ML techniques and evaluate inforation content between the different data sets. (ii) Other classes of exoplanets: The current set focuses on gaseous xoplanets. Future data releases could include small rocky exoplanets ith secondary atmospheres, or water worlds. (iii) More complex processes: Alternative chemical model (with ore complete species sets, with dis-equilibrium processes: Stock t al. 2018 ; Woitke et al. 2018 ; Venot et al. 2020 ; Al-Refaie et al. 022b ) could be provided to study retrie v al biases and develop hemistry robust ML methods. Similarly, complementary sets could nclude stellar activity, for which the relevance of AI methods has lready been shown (Nikolaou et al. 2020 ), or even complex cloud odels (Ackerman & Marley 2001 ; Kawashima & Ikoma 2018 ; Gao t al. 2020 ; Ma et al. 2022 ). (iv) More complex models: Eclipse observations or phase-curve bservations produced using Global Climate Model could be inluded. This would allow to extend this to new observations as well s studying three-dimensional effects (Cho et al. 2003 ; Rauscher t al. 2008 ; Dobbs-Dixon, Cumming & Lin 2010 ; Showman, Cho Menou 2010 ; Cho, Polichtchouk & Thrastarson 2015 ; Caldas t al. 2019 ; Komacek & Showman 2020 ; Skinner & Cho 2022 ) and o develop fast recovery techniques for phase-curve data. Current pproaches to retrieve phase-curve data are limited by computational esources (Feng, Line & F ortne y 2020 ; Irwin et al. 2020 ; Cubillos t al. 2021 ; Changeat et al. 2021a ; Changeat 2022 ; Chubb & Min 022 ) and can require up to 10 million samples (e.g. weeks on PC facilities) to fully explore the parameter space of solution with ubble data (Changeat et al. 2021a ).\nC O N C L U S I O N S\ne present here the publicly available ABC Database ( https://doi.or / 10.5281/ zenodo.6770103 ), a data base of atmospheric forward and nverse models dedicated to the development of ML approaches in he field of exoplanets. In this paper, we introduce, for a non-expert ommunity, the basic physical and chemical processes involved in the reation of such data base, describing the utilized tools, 6 and clearly\nRASTAI 2, 45\u201361 (2023)\nR\ns 1 c a r b C t f p a o\nA\nT C a S S Q E W u t\nf C p E E o\nD\nT R\nR\nA A\nA\nA A\nA\nA B\nB B B\nB\nB B\n7\nB B B B C\nC C C C C\nC\nC\nC\nC C\nC C\nC\nC C\nC\nC C C C C C d D D\nE E E E E E F F F\nF G G G G\nG\nG H H H H\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024\ntating the adopted hypothesis. The constructed set includes about 05 887 forward models and 26 109 atmospheric retrie v als from onventional sampling techniques, and should serve as a community sset to explore novel techniques to solve the inverse problem of etrieving chemical composition from spectroscopic data. This data ase was used to support the third instalment of the Ariel Data hallenge, conducted as part of the NeurIPS Conference, 7 which led o new inno vativ e ML-based solutions to infer posterior distributions rom Ariel spectra. With this effort, and with future updates of this ermanent data base, we hope to facilitate the development and doption of ML solutions to a pressing issue for the next generation f space telescopes.\nC K N OW L E D G E M E N T S\nhis project has received funding from the European Research ouncil (ERC) under the European Union\u2019s Horizon 2020 research nd innovation programme (grant agreement No 758892, ExoAI), the cience and Technology Funding Council grants ST/S002634/1 and T/T001836/1, and the UK Space Agency grant ST/W00254X/1. C is funded by the European Space Agency under the 2022 SA Research Fellowship Program. The author thanks Ingo P. aldmann, Giovanna Tinetti, and Ahmed F. Al-Refaie for their seful recommendations and discussions. The authors wish to thank wo anonymous referees for their useful comments.\nThis work utilized resources provided by the Cambridge Service or Data Driv en Disco v ery (CSD3) operated by the University of ambridge Research Computing Service ( www.csd3.cam.ac.uk), rovided by Dell EMC and Intel using Tier-2 funding from the ngineering and Physical Sciences Research Council (capital grant P/P020259/1), and DiRAC funding from the Science and Technolgy Facilities Council ( www.dirac.ac.uk).\nATA AVAILABILITY\nhe data underlying this paper are available as a Zenodo Digital epository, at https:// doi.org/ 10.5281/ zenodo.6770103 .\nE FERENCES\nckerman A. S., Marley M. S., 2001, ApJ , 556, 872 g \u0301undez M., Venot O., Iro N., Selsis F., Hersant F., H \u0301ebrard E., Dobrijevic\nM., 2012, A&A , 548, A73 g \u0301undez M., Mart \u0301\u0131nez J. I., de Andres P. L., Cernicharo J., Mart \u0301\u0131n-Gago J.\nA., 2020, A&A , 637, A59 l-Refaie A. F., Changeat Q., Waldmann I. P., Tinetti G., 2021, ApJ , 917, 37 l-Refaie A. F., Changeat Q., Venot O., Waldmann I. P., Tinetti G., 2022a,\nApJ , 932, 123 l-Refaie A. F., Venot O., Changeat Q., Edwards B., 2022b, preprint\n( arXiv:2209.11203) rdevol Martinez F., Min M., Kamp I., Palmer P. I., 2022, A&A , 662, A108 aeyens R., Konings T., Venot O., Carone L., Decin L., 2022, MNRAS , 512,\n4877 aker J., Fearnhead P., Fox E. B., Nemeth C., 2019, Stat. Comput. , 29, 599 arstow J. K., 2020, MNRAS , 497, 4183 arstow J. K., Changeat Q., Garland R., Line M. R., Rocchetto M., Waldmann\nI. P., 2020, MNRAS , 493, 4884 arstow J. K., Changeat Q., Chubb K. L., Cubillos P. E., Edwards B.,\nMacDonald R. J., Min M., Waldmann I. P., 2022, Exp. Astron. , 53, 447 atalha N. M., 2014, Proc. Natl. Acad. Sci. , 111, 12647 ayes T., Price n., 1763, Phil. Trans. R. Soc. A, 53, 370\nASTAI 2, 45\u201361 (2023)\nhttps:// neurips.cc/Conferences/2022/ CompetitionTrack.\nH H H\nayram F., Ahmed B. S., Kassler A., 2022, Knowl.-Based Syst. , 245, 108632 orucki W. J. et al., 2010, Science , 327, 977 rogi M., Line M. R., 2019, AJ , 157, 114 uchner J., 2021, preprint ( arXiv:2101.09675) aldas A., Leconte J., Selsis F ., W aldmann I. P., Bord \u0301e P., Rocchetto M.,\nCharnay B., 2019, A&A , 623, A161 assan A. et al., 2012, Nature , 481, 167 hangeat Q., 2022, AJ , 163, 106 hangeat Q., Edwards B., 2021, ApJ , 907, L22 hangeat Q., Edwards B., Waldmann I. P., Tinetti G., 2019, ApJ , 886, 39 hangeat Q., Al-Refaie A., Mugnai L. V., Edwards B., Waldmann I. P.,\nPascale E., Tinetti G., 2020a, AJ , 160, 80 hangeat Q., Edwards B., Al-Refaie A. F., Morvan M., Tsiaras A., Waldmann\nI. P., Tinetti G., 2020b, AJ , 160, 260 hangeat Q., Al-Refaie A. F., Edwards B., Waldmann I. P., Tinetti G., 2021a,\nApJ , 913, 73 hangeat Q., Edwards B., Al-Refaie A. F., Tsiaras A., Waldmann I. P., Tinetti\nG., 2021b, Exp. Astron. , 53, 391 hangeat Q. et al., 2022, ApJS , 260, 3 harbonneau D., Brown T. M., Noyes R. W., Gilliland R. L., 2002, ApJ , 568,\n377 hen J., Kipping D., 2017, ApJ , 834, 17 hen T., Fox E., Guestrin C., 2014, Proc. 31st International Conference on\nMachine Learning, Vol. 32. PMLR, Bejing, p. 1683 hen C., Carlson D., Gan Z., Li C., Carin L., 2016, Proc. 19th International\nConference on Artificial Intelligence and Statistics, Vol. 51. PMLR, Cadiz, p. 1051 hen G., Wang H., van Boekel R., Pall \u0301e E., 2022, AJ , 164, 173 ho J. Y.-K., Menou K., Hansen B. M. S., Seager S., 2003, ApJ , 587,\nL117 ho J. Y.-K., Polichtchouk I., Thrastarson H. T., 2015, MNRAS , 454,\n3423 hubb K. L., Min M., 2022, A&A , 665, A2 hubb K. L. et al., 2021, A&A , 646, A21 loutier R., Menou K., 2020, AJ , 159, 211 obb A. D. et al., 2019, AJ , 158, 33 oles P. A., Yurchenko S. N., Tennyson J., 2019, MNRAS , 490, 4638 ubillos P. E. et al., 2021, ApJ , 915, 45 e Wit J. et al., 2018, Nat. Astron. , 2, 214 obbs-Dixon I., Cumming A., Lin D. N. C., 2010, ApJ , 710, 1395 rummond B., Tremblin P., Baraffe I., Amundsen D. S., Mayne N. J., Venot\nO., Goyal J., 2016, A&A , 594, A69 dwards B., Tinetti G., 2022, AJ , 164, 15 dwards B., Mugnai L., Tinetti G., Pascale E., Sarkar S., 2019a, AJ , 157, 242 dwards B. et al., 2019b, Exp. Astron. , 47, 29 dwards B. et al., 2020, AJ , 160, 8 dwards B. et al., 2022, preprint ( arXiv:2211.00649) strela R., Swain M. R., Roudier G. M., 2022, ApJ , 941, L5 eng Y. K., Line M. R., F ortne y J. J., 2020, AJ , 160, 137 eroz F., Hobson M. P., Bridges M., 2009, MNRAS , 398, 1601 oreman-Macke y D., Hogg D. W., Lang D., Goodman J., 2013, PASP , 125,\n306 ulton B. J. et al., 2017, AJ , 154, 109 al Y., Ghahramani Z., 2015, preprint ( arXiv:1506.02142) andhi S., Madhusudhan N., 2018, MNRAS , 474, 271 ao P. et al., 2020, Nat. Astron. , 4, 951 reene T. P., Line M. R., Montero C., F ortne y J. J., Lustig-Yae ger J., Luther\nK., 2016, ApJ , 817, 17 uo C., Pleiss G., Sun Y., Weinberger K. Q., 2017, Proc. 34th International\nConference on Machine Learning, Vol. 70. PMLR, p. 1321 uzm \u0301an-Mesa A. et al., 2020, AJ , 160, 15 aldemann J. et al., 2022, preprint ( arXiv:2202.00027) arrington J. et al., 2022, Planet. Sci. J. , 3, 80 ayes J. J. C. et al., 2020, MNRAS , 494, 4492 imes M. D. et al., 2022, Planet. Sci. J. , 3, 91 oeijmakers H. J. et al., 2018, Nature , 560, 453 oman M. D., Gelman A., 2014, J. Mach. Learn. Res., 15, 1593 oward A. W. et al., 2010, Science , 330, 653\nH\nI I\nI\nK K K L\nL L\nL L\nL L\nM M\nM\nM M\nM M M\nM M M\nM\nM\nM N\nN N N O P P\nP P P\nP R\nR R\nR\nR\nS\nS S\nS S S S S S S\nS T\nT\nT\nT T T T T\nV V\nW W\nW\nW W\nW\nW W\nW X Y\nY Y\nY\nY\nY\nY\nY\nZ\nZ\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024\numphre y A., K uberski W., Bialek J., Perrakis N., Cools W., Nuyttens N., Elakhrass H., Cunha P., 2022, MNRAS , 517, L116 rwin P. G. J. et al., 2008, J. Quant. Spec. Radiat. Transf. , 109, 1136 rwin P. G. J., Parmentier V., Taylor J., Barstow J., Aigrain S., Lee E. K. H.,\nGarland R., 2020, MNRAS , 493, 106 zmailov P., Vikram S., Hoffman M. D., Wilson A. G., 2021, preprint\n( arXiv:2104.14421) awashima Y., Ikoma M., 2018, ApJ , 853, 7 omacek T. D., Showman A. P., 2020, ApJ , 888, 2 reidberg L. et al., 2014, Nature , 505, 69 akshminarayanan B., Pritzel A., Blundell C., 2017, Proc. 31st International\nConference on Neural Information Processing Systems, NIPS\u201917. Curran Associates Inc., Red Hook, NY, p. 6405 avie B. et al., 2017, AJ , 154, 91 i G., Gordon I. E., Rothman L. S., Tan Y., Hu S.-M., Kassi S., Campargue\nA., Medvedev E. S., 2015, ApJS , 216, 15 ine M. R., Parmentier V., 2016, ApJ , 820, 78 ine M. R., Zhang X., Vasisht G., Natraj V., Chen P ., Y ung Y. L., 2012, ApJ ,\n749, 93 ine M. R. et al., 2013, ApJ , 775, 137 u J., Liu A., Dong F ., Gu F ., Gama J., Zhang G., 2018, IEEE Trans. Knowl.\nData Eng. , 31, 2346 a Y., Ma Y.-A., Chen T., Fox E. B., 2015, NIPS a S., Ito Y., Al-Refaie A. F., Changeat Q., Edwards B., Tinetti G., 2022,\npreprint ( arXiv:2301.13708 ) addox W. J., Garipov T., Izmailov P ., V etrov D., Wilson A. G., 2019,\nA Simple Baseline for Bayesian Uncertainty in Deep Learning. Curran Associates Inc., Red Hook, NY adhusudhan N., Seager S., 2009, ApJ , 707, 24 adhusudhan N., Ag \u0301undez M., Moses J. I., Hu Y., 2016, Space Sci. Rev. ,\n205, 285 ai C., Line M. R., 2019, ApJ , 883, 144 andt S., Hoffman M. D., Blei D. M., 2017, J. Mach. Learn. Res., 18, 1  \u0301arquez-Neila P., Fisher C., Sznitman R., Heng K., 2018, Nat. Astron. , 2,\n719 ayor M., Queloz D., 1995, Nature , 378, 355 ikal-Evans T. et al., 2022, Nat. Astron. , 6, 471 in M., Ormel C. W., Chubb K., Helling C., Kawashima Y., 2020, A&A ,\n642, A28 olli \u0300ere P., Wardenier J. P., van Boekel R., Henning T., Molaverdikhani K.,\nSnellen I. A. G., 2019, A&A , 627, A67 ugnai L. V., Pascale E., Edwards B., Papageorgiou A., Sarkar S., 2020,\nExp. Astron. , 50, 303 ukherjee S., Batalha N. E., Marley M. S., 2021, ApJ , 910, 158 eal R., 2011, Handbook of Markov Chain Monte Carlo. Chapman & Hall,\nNew York emeth C., Fearnhead P., 2019, preprint ( arXiv:1907.06986) ikolaou N. et al., 2020, preprint ( arXiv:2010.15996) ixon M. C., Madhusudhan N., 2020, MNRAS , 496, 269 reshenko M. et al., 2020, AJ , 159, 6  \u0308atzold M. et al., 2012, A&A , 545, A6 earce T., Leibfried F., Brintrup A., Zaki M., Neely A., 2020, 23rd Inter-\nnational Conference on Artificial Intelligence and Statistics, AISTATS 2020 etigura E. A. et al., 2022, AJ , 163, 179 inhas A., Madhusudhan N., 2017, MNRAS , 471, 4355 olyansky O. L., Kyuberis A. A., Zobov N. F., Tennyson J., Yurchenko S. N.,\nLodi L., 2018, MNRAS , 480, 2597 otthast R., 2006, Inverse Probl. , 22, R1 auscher E., Menou K., Cho J. Y.-K., Seager S., Hansen B. M. S., 2008, ApJ ,\n681, 1646 icker G. R. et al., 2015, J. Astron. Telesc. Instrum. Syst. , 1, 014003 itter H., Botev A., Barber D., 2018, 6th International Conference on\nLearning Representations, ICLR 2018-Conference Track Proceedings, Vol. 6 occhetto M., Waldmann I. P ., V enot O., Lagage P. O., Tinetti G., 2016, ApJ , 833, 120\noudier G. M., Swain M. R., Gudipati M. S., West R. A., Estrela R., Zellem R. T., 2021, AJ , 162, 37 chwarz H., Brogi M., de Kok R., Birkby J., Snellen I., 2015, A&A , 576, A111 harma S., 2017, ARA&A , 55, 213 howman A. P., Cho J. Y.-K., Menou K., 2010, in Seager S., ed., Atmospheric\nCirculation of Exoplanets. Space Science Series of the Univ. Arizona Press, Tucson, AZ ing D. K. et al., 2016, Nature , 529, 59 killing J., 2006, Bayesian Anal., 1, 833 kinner J. W., Cho J. Y.-K., 2022, MNRAS , 511, 3584 oboczenski F. et al., 2018, preprint ( arXiv:1811.03390) peagle J. S., 2020, MNRAS , 493, 3132 tevenson K. B. et al., 2017, AJ , 153, 68 tock J. W., Kitzmann D., Patzer A. B. C., Sedlmayr E., 2018, MNRAS , 479,\n865 wain M. R., Vasisht G., Tinetti G., 2008, Nature , 452, 329 aylor J., Parmentier V., Irwin P. G. J., Aigrain S., Lee E. K. H., Krissansen-\nTotton J., 2020, MNRAS , 493, 4342 aylor J., Parmentier V., Line M. R., Lee E. K. H., Irwin P. G. J., Aigrain S.,\n2021, MNRAS , 506, 1309 he JWST Transiting Exoplanet Community Early Release Science Team,\n2022, preprint ( arXiv:2208.11692) inetti G. et al., 2007, Nature , 448, 169 inetti G. et al., 2021, preprint ( arXiv:2104.04824) rotta R., 2017, preprint ( arXiv:1701.01467) siaras A. et al., 2018, AJ , 155, 156 siaras A., Waldmann I. P., Tinetti G., Tennyson J., Yurchenko S. N., 2019,\nNat. Astron. , 3, 1086 enot O., Ag \u0301undez M., 2015, Exp. Astron. , 40, 469 enot O., Cavali \u0301e T., Bounaceur R., Tremblin P., Brouillard L., Lhoussaine\nBen Brahim R., 2020, A&A , 634, A78 aldmann I. P., 2016, ApJ , 820, 107 aldmann I. P., Rocchetto M., Tinetti G., Barton E. J., Yurchenko S. N.,\nTennyson J., 2015a, ApJ , 813, 13 aldmann I. P., Tinetti G., Rocchetto M., Barton E. J., Yurchenko S. N.,\nTennyson J., 2015b, ApJ , 802, 107 ang M., Deng W., 2018, Neurocomputing, 312, 135 elbanks L., Madhusudhan N., Allard N. F., Hubeny I., Spiegelman F.,\nLeininger T., 2019, ApJ , 887, L20 elling M., Teh Y. W., 2011, Proceedings of the 28th International Con-\nference on International Conference on Machine Learning, ICML\u201911. Omnipress, Madison, WI, p. 681 ilson G., Cook D. J., 2020, ACM Trans. Intell. Syst. Technol. , 11, 51 oitke P., Helling C., Hunter G. H., Millard J. D., Turner G. E., Worters M.,\nBlecic J., Stock J. W., 2018, A&A , 614, A1 olszczan A., Frail D. A., 1992, Nature , 355, 145 ing C., Arpit D., Tsirigotis C., Bengio Y., 2018, preprint ( arXiv:1802.08770) ao J., Pan W., Ghosh S., Doshi-Velez F., 2019, Proceedings at the Inter-\nnational Conference on Machine Learning: Workshop on Uncertainty & Robustness in Deep Learning (ICML). ip K. H., Tsiaras A., Waldmann I. P., Tinetti G., 2020, AJ , 160, 171 ip K. H., Changeat Q., Edwards B., Morvan M., Chubb K. L., Tsiaras A.,\nWaldmann I. P., Tinetti G., 2021a, AJ , 161, 4 ip K. H., Changeat Q., Nikolaou N., Morvan M., Edwards B., Waldmann I.\nP., Tinetti G., 2021b, AJ , 162, 195 ip K. H., Changeat Q., Al-Refaie A., Waldmann I., 2022a, preprint\n( arXiv:2205.07037) ip K. H. et al., 2022b, The Thirty-Sixth Annual Conference on Neural\nInformation Processing Systems (NeurIPS 2022) urchenko S. N., Amundsen D. S., Tennyson J., Waldmann I. P., 2017, A&A ,\n605, A95 urchenko S. N., Mellor T. M., Freedman R. S., Tennyson J., 2020, MNRAS ,\n496, 5282 hang M., Chachan Y., Kempton E. M. R., Knutson H. A., 2019, PASP , 131,\n034501 ingales T., Waldmann I. P., 2018, AJ , 156, 268\nRASTAI 2, 45\u201361 (2023)\nR\nFigure A1 Diagram of an observation of the transiting exoplanet KEL T -11 b (top panel) and the corresponding normalized flux from a real observation, also called a light curve (bottom panel). The phase, which labels the x -axis, is the position of the planet in its orbit with 0 (by convention) being the middle of the transit ( t mid ). The transit starts at the event t 1 and finishes at the event t 4 , spanning the transit duration t 14 . The transit depth ( ) is the observed normalized flux between in and out of transit situations. The observation is adapted from Changeat et al. ( 2020b ).\nA A\nT t f\nA\nE p p t t r t A q b v l\nT t o i w t\nw\no\n8\nt t\ns e s\nH\nw m\np t a a h t ( m d t a p d m t\no p o\nA\nO o a c ( c t c o t o m c t l a b A\ns e T\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024 PPENDIX A : I N T RO D U C T I O N TO TMO SPH ER IC STUDIES O F EXOPLANETS his section provides a summary of the domain knowledge required o properly exploit the ABC Database. It is written as an introduction or non-exoplanet audience. 1 Obser v ations of transiting exoplanets xoplanets are detected using various methods, but the two most opular techniques used today are radial velocity and transit. In articular, transit is an indirect technique that relies on monitoring he host star\u2019s variations in brightness. A transit event occurs when he planet passes in front of the star, blocking a fraction of the light eceived here on Earth. Transit events can be observed, thus revealing he presence of the planet and its important properties, such as radius. typical transit observation is described, along with the rele v ant uantities, in Fig. A1 . Transit events are periodic, so they can easily e disentangled from other astrophysical sources of noise (stellar ariations, 8 instrument systematics and observing conditions) when ong-term monitoring is employed. For most observatories, absolute measurements are challenging. his is especially true when the required precision is high, as it is he case for e xoplanets. As such, for e xoplanets, we prefer to rely n differential quantities such as transit depth ( ). The transit depth s the normalized difference between the flux received from the star hen the planet is out-of-transit ( F out ) and when the planet is inransit ( F in ):\n= F out \u2212 F in F out\n= ( R p\nR s\n)2 , (A1)\nhere R p is the radius of the planet and R s is the radius of the star. To first order, to account for the contribution of an atmosphere, ne can simply replace the planetary radius R p by R p + h , where h is\nASTAI 2, 45\u201361 (2023)\nF or e xample, stars\u2019 brightness could vary from time to time. 9\nhe ef fecti v e size of the atmosphere. Ne glecting second order terms, his gives\n= ( R p\nR s\n)2 + 2 R p h\nR 2 s . (A2)\nNow , crudely , the size of the atmosphere depends on the atmopheric scaleheight H such that h = NH , where N is a scaling factor ncoding information regarding the atmospheric compositions. The caleheight is defined as\n= k b T \u03bcg , (A3)\nhere k b is the Boltzmann constant, T is the temperature, \u03bc is the ean molecular weight, and g is the gravity. From those simple expressions, which here serve an illustrative\nurpose and are an o v ersimplification of the model used to build he ABC Database, we can deduce some standard behaviours of tmospheric properties. First, to extract information on the planet nd its atmosphere, we will al w ays require some knowledge of the ost star. This is because the planet is not observed directly and he observed quantities ( ) are a function of the stellar parameters here the stellar radius R s ). In addition, we observe that for the more assive planet (larger g ) the contribution of the atmosphere will be iminished, as the atmosphere contracts under gravity. In contrast, if he temperature increases the atmosphere will be inflated and thus the tmospheric signal will be larger. The chemistry of the atmosphere lays a part in the scaling factor N but their relation cannot be easily educed here. Intuitively, molecules with larger abundance tend to ake the atmosphere opaque at higher altitudes, therefore increasing he apparent size of the atmosphere. 9\nThose concepts, while useful to acquire an intuitive understanding f the behaviour of planetary atmospheres, are rather limiting and roper modelling is required to correctly interpret exo-atmospheric bservations.\n2 Modelling exoplanet atmospheres\nbserving exoplanetary transits at various wavelengths, meaning btaining as a function of \u03bb, provides information about the tmospheric properties. This is because a planetary atmosphere ontributes to the transit depth by absorbing the incoming stellar light slightly) differently at different wavelengths (e.g. the atmospheric ontribution is wavelength-dependent). The absorption profile of he atmosphere depends on its constituents (molecular species, louds, hazes) and properties (thermal structure). To model the bserved signal as a function of wavelengths, also called a specrum, astronomers use simplified models of the rele v ant processes ccurring in exoplanet atmospheres. In Appendix B , we describe the athematical formulation of one such model for the transit geometry, ommonly used as a parametrized 1D forward model. Put simply, he light from the host star is propagated through an atmosphere ayer by layer and impacted according to the absorption of the tmosphere. In our case, the absorptions considered are absorptions y molecular species, Rayleigh Scattering, and Collision Induced bsorption (CIA). Through this process, from a parametrized one-dimensional decription of an atmosphere controlled by a finite number of paramters, one can compute the theoretical spectrum of an exoplanet. his process, called forward modelling, can be made relatively\nwe cannot observe any non-opaque (transparent) part of the atmosphere.\nf e b t a s\nr t a w t (\nm ( b t ( h t t G E s\n1\nt\nd R\np\nr\na o i w a t c e j t\nC r w s C\n1\nt h J w A\na 2 b t O w 1 a d h a\nA\nT t o p ( m o t s s i u c e o r\nt T p o d d ( ( i\np d t c\nP\nw m i\nc M\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024\nast (on the order of seconds), but due to the non-linearity of the quations and the input spectroscopic data (cross-sections), it cannot e directly inverted. In the next section, we explain how traditional echniques (e.g. Bayesian sampling) are used to perform model fitting nd retrieve the properties of an exo-atmosphere from its observed pectrum.\nBefore explaining the use of inversion techniques, or atmospheric etrie v als, applied in the context of exoplanet atmospheres, we wish o present a series of simple models to illustrate further the sensitivity nalysis made in the previous section. We have created a mock planet ith a non-negligible atmosphere, and we will show how changing he values of some of the model parameters affects the observation e.g. the spectrum).\nFor simplicity, we set the planet with an isothermal atmosphere, eaning the temperature of the atmosphere is constant with altitude e.g. constant at all pressure levels) and therefore can be defined y a single parameter ( T ). To this atmosphere, we add a single race molecule (H 2 O) defined by its absolute abundance in volume volume mixing ratio), and we fill the rest remaining atmosphere with ydrogen and helium in standard solar ratios (H 2 /He = 0.17). 10 On op of the molecular absorption from water vapour, we also consider hree additional absorption processes: CIA, Rayleigh scattering, and rey Clouds (not considered in this version of the ABC data base). quipped with this model, we set the following cases for which the pectra are available in Fig. A2 :\n(i) Case 1 (black): planetary radius R p = 1.0 R J , temperature T = 200 K, nixing ratio of H 2 O = 10 \u22123 , and no clouds. (ii) Case 2 (blue): same as Case 1 but the temperature is decrease o T = 500 K. (iii) Case 3 (purple): same as Case 1 but the water content is ecrease to H 2 O = 10 \u22125 , while the planetary radius is increased to p = 1.0085. (iv) Case 4 (red): same as Case 1 but with clouds (cloud top ressure is set at 0.01 bar). (v) Case 5 (green): same as Case 2 but with an increased planetary adius to R p = 1.013 R J . From those specifically designed case, one can compare Case 1 nd 2, for which only the temperature is changed. As a consequence f this change, the size of the atmosphere is decreased as explained n Section 2.1 , and the atmospheric features are smaller, bringing the hole spectrum down. In this case, distinguishing between Case 1 nd Case 2 would be relatively easy. For Cases 3, 4, and 5, ho we ver, he story can be a little more complicated as multiple parameters are hanged, but those can be used to highlight degeneracies typically ncountered in the interpretation of exoplanet spectra, therefore ustifying the need for more sophisticated atmospheric retrie v al echniques.\nFor those cases, the spectral features are reduced compared to ase 1, but they appear much closer in the 1\u20132 \u03bcm wavelength\nange. This is because Case 3 has less water compared to Case 1, hich we expect to decrease the spectral features but thanks to the lightly larger radius, the spectrum is brought back to a similar level. ase 4 has opaque clouds, which \u2018cuts\u2019 the spectral features abo v e\n0 The trace molecules (like H 2 O only accounts for a very tiny portion of he atmospheric composition, the rest is filled by gases like hydrogen and elium, this kind of atmosphere is also known as Primary Atmosphere (e.g. upiter has a Primary Atmosphere) as opposed to Secondary Atmosphere, hich is principally made of heavier elements (e.g. Earth has a Secondary tmosphere).\nE\n1\ncertain pressure level, making it look exactly like Case 3 in the 1\u2013 \u03bcm range. Finally, Case 5 has a lower temperature (600 K) and is rought back to the same level by an increased in radius. With current elescopes, such as HST , the wav elength co v erage is relativ ely small. ne typical instrument onboard HST is the Wide Field Camera 3 ith its G141 Grism, which has a wavelength coverage from 1.1 to .6 \u03bcm and reaches errors of the order of 30 ppm. 11 Highlighting typical observation with HST on the same figure, we show how ifficult it would be to distinguish between Cases 3, 4, and 5. This ighlight the requirement to next-generation space telescopes such s Ariel to constrain atmospheric properties.\n3 Solving the inverse problem for exo-atmospheres\nhe study of exo-atmosphere relies on spectroscopic observations o infer fundamental atmospheric properties that cannot be directly bserved. This kind of problem is broadly described as the inverse roblem (Potthast 2006 ), where one tries to unco v er the cause atmospheric properties) from the effect (observations). However, ore often than not, the full effect is seldom observed, instead, bservers often received a corrupted form of the effect, which is he observations. In terms of exoplanetary spectra, there are several ources of corruption, such as the presence of noise and limited pectroscopic co v erage. The loss of information often means that the nverse mapping function M \u22121 is unknown and may no longer be niquely defined, which generally give rise to more than one plausible auses, also known as model de generac y (see section abo v e). In some xtreme cases, sev ere loss in information (like e xtremely low S/N bserv ations) ef fecti vely means that the cause may no longer be eco v erable. See Fig. A3 for a typical setup of an inverse problem.\nOur goal is to estimate the set of parameters that best explains he observed spectrum D under a given atmospheric model M . here are different ways to approach this \u2018atmospheric retrieval\u2019 roblem, but most of them involve a forward model (which includes ur atmospheric assumptions) and an optimizer. Here we will briefly escribe the problem in terms of Bayesian framework, for a more etailed discussion on Bayesian statistics, one can refer to Skilling 2006 ), Feroz et al. ( 2009 ), F oreman-Macke y et al. ( 2013 ), Sharma 2017 ), Trotta ( 2017 ), Speagle ( 2020 ), and Buchner ( 2021 ) for more nformation.\nOur goal is to find the conditional distribution of the model arameters given the observation, also known as the posterior istribution ( P ( | D, M ) = P ( D| , M ) P ( ) / P ( D) ) in Bayes\u2019 heorem (Bayes & Price 1763 ). The posterior distribution can be omputed via the following formulation:\n( | D, M ) = P ( D| , M ) P ( ) P ( D) , (A4)\nhere P ( D| , M ) represents the likelihood function under a given odel, P ( ) represents the prior, and P ( D ) represents the normalizng constant, or the Bayesian Evidence. The (log-) Gaussian likelihood function is commonly used to ompare the observation D with the output from the forward model , i.e.\n[ log P ( D| , M ] = E [ log ( N ( D| S, \u03c3 )] (A5)\n= E [ log ( 1 \u221a\n2 \u03c0\u03c3 2 exp\n( \u22121\n2 ( D \u2212 S) 2 \u03c3 2\n))] ,\n(A6)\nRASTAI 2, 45\u201361 (2023)\n1 Parts per million, 10 \u22126 .\nR\nFigure A2 Spectra illustrating the sensitivity of atmospheric models to input parameters. In black: Model 1, in blue: Model 2, in purple: Model 3, in red: Model 4, and in green: Model 5. We also show in dashed grey line a model similar to Model 1 but without absorption of water, leaving only the continuum contribution of Rayleigh Scattering (short wavelengths) and CIA (long wavelengths). The red and yellow points represent a simulated observation with Hubble Space Telescope ( HST ) at 30 parts per million (ppm), highlighting the difficulty of constraining atmospheric properties from current data.\nw M t p\nS\ns\nD\nw m\nt t p\na = b i\nt e o e S i\nForward\nInverse\nFigure A3 Schematic of a typical inverse problem setup. The forward process produces an effect (full spectrum, S ) from a hidden cause (e.g. atmospheric parameters, ). Ho we ver, the full ef fect is often unavailable to the observer due to the loss of information (such as instrument systematics, limitation in spectroscopic co v erage, etc. ). Instead, observers can only receive the partial effect (or otherwise known as the observation, D ). The aim of the inverse problem is to recover the hidden cause that produces them in the first place.\ns M s c & a i B w\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024 here S is a simulated spectrum generated using the forward model and \u03c3 represents the observation uncertainty/noise. Thanks to he forward model M , we have an unique mapping from a set of arameters to a simulated spectrum S such that = M ( ) . (A7) The relation between the observed spectrum D and the simulated pectrum S is \u2248 S + , (A8) here = N (0, \u03c3 2 ). The approximation sign reflects the fact that the odel remains an approximation of the real phenomena. As for the prior function P ( ), it represents our prior belief on he distribution of the random variables. With limited knowledge on he exo-atmosphere, the community al w ays opt for an uninformative rior ( also known as an uniform prior). Unfortunately, in most cases, equation ( A4 ) cannot be computed nalytically. The main reason lies with the Bayesian Evidence, P ( D ) \u222b P ( D , )d , the integral demands e v aluation of the probaility for every possible combinations, which makes the quantity ntractable for any meaning cases.\nA common strategy is to sample the parameter space, and use he distribution of the samples to compute the maximum likelihood stimation (MLE) and the Bayesian Evidence. There are many ptimizing strategies available, including grid sampling, optimal stimation, Markov chain Monte Carlo models (MCMC), and Nested ampling, amongst others. Those are ho we ver computationally ntensive and require evaluation of millions of forward models. There have been efforts from the ML community to develop\nASTAI 2, 45\u201361 (2023)\ncalable sampling algorithms. Stochastic Gradient MCMC (SGCMC) is a popular class of algorithms that utilizes data subampling techniques to reduce computational time to construct the hain (Welling & Teh 2011 ; Ma et al. 2015 ; Baker et al. 2019 ; Nemeth Fearnhead 2019 ). Stochastic Gradient Descent (SGD)\u2019s link to pproximate Bayesian Inference has prompted further investigation nto its statistical properties (Chen et al. 2016 ; Mandt, Hoffman & lei 2017 ; Xing et al. 2018 ); it has since been shown that SGD ith constant step size (Constant-SGD) can approximate Bayesian\nP C p G a t\np s b P K (\nn s o c I\nA M\nI u s p s\nb w\nw a t\nw F d i i n l\na s a\n\u03c0\nw c m t\nF R s z\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6\nosterior Distribution. Other algorithms, such as Hamiltonian Monte arlo (HMC), incorporated information on the gradient within the roposal to impro v e the sampling efficiency (Neal 2011 ; Homan & elman 2014 ). Chen, Fox & Guestrin ( 2014 ) introduced SG-HMC, fusion between SG-MCMC and HMC, to provide further speed up o the algorithm.\nOther approaches focuses on architectural design or postrocessing techniques to incorporate elements of Bayesian Inference, uch as Dropout (Gal & Ghahramani 2015 ), Neural Network Ensemles (Lakshminarayanan, Pritzel & Blundell 2017 ; Cobb et al. 2019 ; earce et al. 2020 ), SWA-Gaussian (SWAG Maddox et al. 2019 ), F-Laplace (Ritter, Botev & Barber 2018 ), and temperature-scaling Guo et al. 2017 ). The availability of many state-of-the-art algorithms prompts the eed to benchmark their performances under different data sets and cenarios (Yao et al. 2019 ; Izmailov et al. 2021 ). Aligned with this bjective, the aim of this data base and the machine learning (ML) hallenge is to leverage recent developments in scalable Bayesian nference and identify potential solutions forward.\nPPENDIX B: ATMO SPH ER IC TRANSMIS SI ON O D E L IN TauREx\nn this section, we describe the simplified transit (forward) model sed in the code TauREx 3 . The atmosphere of the planet is eparated in N L homogeneous layers following a one-dimensional lane-parallel geometry (see Fig. B1 ). The light rays from the host tar are propagated through the atmospheric layers, being impacted\nigure B1 Illustration of the transmission of stellar radiation (left-hand side) throu 0 is the reference radius at which the atmosphere becomes fully opaque. A ligh eparated in N L layers for size z , which are labelled by the index l = j + k , where j l corresponds to the altitude at the lower boundary of the layer l .\ny extinction processes (absorption and scattering) at the different avelengths ( \u03bb). The normalized differential flux ( \u03bb) or the transit depth at avelength \u03bb reaching the observer is simply the ratio of the surface rea of the planet to the host star, which can be further simplified to he planet-to-star radius squared:\n\u03bb = F out ,\u03bb \u2212 F in ,\u03bb F out ,\u03bb\n= ( \u03c0R p ( \u03bb)\n\u03c0R s\n)2 = ( R p ( \u03bb)\nR s\n)2 , (B1)\nhere F out, \u03bb is the total flux received from the system out-of-transit, in, \u03bb is the total flux received in-transit, R p ( \u03bb) is the wavelengthependent radius that includes the atmospheric contribution, and R s s the stellar radius. In our case, the atmospheric contribution consists n the absorption of the star light from the atmosphere (e.g. we do ot include scattering processes), which follows the Beer\u2013Lambert aw.\nThe wa velength-dependent contrib ution of the atmosphere starts t the surface labelled R 0 . Note that for gaseous planets (e.g. without olid surface), R 0 is a reference radius at which we consider the tmosphere is fully opaque at all wavelengths. We obtain\nR p ( \u03bb) 2 = C sur + C atm\n= 2 \u03c0 \u222b R 0\n0 rd r + 2 \u03c0 \u222b \u221e R 0 r ( 1 \u2212 e \u2212\u03c4 ( r,\u03bb) ) d r, (B2)\nhere C sur is the contribution to the planet surface, C atm is the ontribution from the atmosphere, and r is the radial coordinate. In ost cases, the former term is assumed to be completely opaque and herefore can be simply e v aluated as the surface area of the planet at\nRASTAI 2, 45\u201361 (2023)\ngh an exoplanet atmosphere (transit) towards an observer (right-hand side). t ray at altitude z propagates along the line-of-sight x . The atmosphere is refers to the z- component and k to the x -component. The discretized altitude\n998590 by Indian Institute of Technology Patna user on 18 January 2024\nR\nr o f\nf\n\u03c4\nH t s m\na r P a a i r\nb\nw a\nw\n\u03c4\nC\na s i r\nC e t h h i fi r a\nt t .\nA A\nF a s\nf a c b i u t ( p a t m\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024\nadius R 0 , the latter term involves the computation of the optical depth f the atmosphere at each layer, which summarizes the contribution rom various processes happening within the atmosphere.\nThe optical depth \u03c4 ( r , \u03bb) is computed along the line of sight as ollows: ( r, \u03bb) = 2 \u222b x f\n0 N G \u2211 i \u03c7i ( r \u2032 ) \u03c1( r \u2032 ) \u03c3i ( r \u2032 , \u03bb)d x. (B3)\nere, \u03c7 i is the mixing ratio (or abundance) of the i th species, \u03c1 is he number density, and \u03c3 i is the absorption cross-section of the i th pecies. The number of gases is noted N G . The variable x f is the aximum distance considered for the numerical integration. Considering the one-dimensional geometry, the integration of \u03c4 long the x axis can be decomposed in unit elements \u03c4 ( j , k ), where j epresents the y -axis inde x es and k are the inde x es along the x -axis. hysical quantities (e.g. the altitude z , the mixing ratio \u03c7 ) defined t a layer l can then be related to the j , k inde x es using l = j + k , nd noting that k can only span the values from j to N L . These are nde x ed with an additional subscript, for instance, \u03c7 i , l is the mixing atio of the i th species at layer l .\nIt follows that the unit path integral, labelled x ( j , k ) and identified y the red element in Fig. B1 , can be expressed as\nx ( j,k) = \u221a ( R 0 + z j+ k+ 1 )2 \u2212 (R 0 + z j + z j\n2\n)2\n\u2212 \u221a ( R 0 + z j+ k )2 \u2212 (R 0 + z j + z j\n2\n)2 , (B4)\nhere z l is the altitude at layer l and z l are the changes in altitude t layer l .\nSince the layer are equally spaced in log-pressure, we also have z l = \u2212H l log (\nP l+ 1 P l\n) , (B5)\nhere H l is the scaleheight at layer l and P l is the pressure at layer l . Expressing the optical layer element as\n( j,k) = N G \u2211 i \u03c7i,j+ k \u03c1j+ k \u03c3i,j+ k ( \u03bb) x ( j, k) , (B6)\none obtains the final contribution for the atmosphere as\nASTAI 2, 45\u201361 (2023)\natm = 2 \u03c0 N L \u2211 j= 0\n( R 0 + z j ) ( 1 \u2212 exp [ \u22122\nN L \u2212j \u2211 k= 0 \u03c4( j,k)\n] ) z j , (B7)\nnd the transit depth as a function of wavelengths or the transmision spectrum can be computed following equation ( B1) . In this nvestigation, we produced a grid of transmission spectra through a andomized and uniform grid of free parameters.\nThe absorbing properties of the different molecules (H 2 O, CO, O 2 , CH 4 and NH 3 ) and processes (Rayleigh Scattering, CIA) are ncoded in the cross-sections ( \u03c3 i in equation B3 ). Cross-sections are emperature-, pressure-, and wavelength-dependent, and have a ighly non-linear behaviour. In most codes, including the one used ere, since the computation of cross-sections is a computationally ntensive and complex process, they are pre-computed in tabulated les that are then interpolated to obtain the absorbing profile of the ele v ant molecules and processes at a given temperature, pressure, nd wavelength.\nFor a more complete description of the employed code, we refer he reader to the original papers (Al-Refaie et al. 2021 , 2022a ) and he NeurIPS TauREx tutorial available at Zenodo: https:// doi.org/ 10 5281/zenodo.6770103 .\nPPENDI X C : POSTERI OR DI STRI BU TI ON O F TMO SPH ER IC RETRI EVAL\nig. C1 shows an example of posterior distribution resulting from TauREx atmospheric retrie v al. This posterior distribution correponds to the data shown in Fig. 3 .\nThe posterior distribution shows the correlation between the ree parameters of the model (here atmospheric temperatures and bundances of five gases). In particular, this inverse problem is hallenging for ML solutions as, due to the high level of degeneracies etween the parameters of interest, the exoplanet community is nterested in obtaining full probability distributions rather than a nique guess. Solutions to this inverse problem would be required o (i) correctly identify the abundances of detectable molecules see CO 2 , CH 4 , and CO); (ii) characterize the correlation between arameters (see e.g. the ne gativ e correlation between temperature and bundance of CH 4 ); (iii) constrain upper limits for the parameters hat cannot be determined (see e.g. NH 3 distribution); and (4) identify\nultimodal solutions (not shown in this example).\nFigure C1 Example of posterior distribution obtained with TauREx 3 on a simulated Ariel observation. This correlation map is constructed using the Nested Sampling traces and weights, with the corner library.\nA\nA c P a a w t r\nv a\nT d f t t o t 5 d a a t\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024"
        },
        {
            "heading": "PPENDIX D : DATA OV ERVIEW \u2013 C O N T I N U E D",
            "text": "strength of this large-scale data generation lies with the use of urrently known demographics as the source of planetary candidates. lanet formation and evolution remains an actively researched area nd there are contrasting theories as to how and why certain planets re more pre v alent than others. By relying solely on observed planets e a v oided producing fictitious planets that are otherwise impossible o form. Furthermore, the bi-model distribution of planet mass and adius contributes to the dichotomy seen in Fig. 4 .\nDue to the extremely low S/N ratio with exoplanetary obseration and non-linear instrument systematics, actual observations re usually accompanied with non-negligible measurement errors.\nhese errors are specific to the brightness of the host star, the ata reduction process, the instrument onboard, and its separation rom us. ArielRad , an official radiometric simulator dedicated to he Ariel Space Mission, is designed specifically to account for he aforementioned effects and provide realistic estimation of the bservational uncertainties (Mugnai et al. 2020 ). Fig. D1 shows he distribution of (log-) observational uncertainties across the 2 wavelength channels. All of them displayed a non-Gaussian istribution, some even presented a bi-model distribution. There re also noticeable difference in terms of the shape and magnitude cross different channels. For instance, uncertainties associated with he blue end of the spectrum tend to be smaller than the red end\nRASTAI 2, 45\u201361 (2023)\nR\nFigure D1 Distribution of (log-) uncertainty across different wavelength channels used by Ariel-Tier 2 resolution. These uncertainties are generated using ARIELRAD , which accounts for the different instrumentation onboard Ariel, stellar properties, as well as planetary properties. Since the SNR requirement of Ariel Tier-2 data is on the atmospheric signal, those distribution are approximately offset by one order of magnitude compared to the \u2018Feature height\u2019 distribution in Fig. 4 .\no p\nA D\nE\nL t I s e\np\ns\ng\nE\nW c n b k\nTable E1. Summary of the different configurations of the four subsets.\nSubset 1 Subset 2 Subset 3 Subset 4\nPlanetary configuration In-Range Out-Range In-Range Out-Range Atmospheric properties In-Range In-Range Out-Range Out-Range\n& t u p\na m I R R f s u\nt s t d u b p i\nd d s S A t\no c\nD ow nloaded from https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024 f the spectrum, as the blue end of the spectrum is coming from a hotometer. PPENDIX E: LEVEL 2 DATA \u2013 D ETAILED E SCRIPTIONS 1 Structure evel 2 data are designed originally for the NeurIPS 2022 competiion, but the data structure can be re-used for general model training. t is consisting of a training and test set. The two sets shares the ame structure and the aim is to allow better readability to non-field xperts: (i) AuxillaryTable.csv: contains supplementary astrohysical parameters. (ii) SpectralData.hdf5: contains details of the spectrocopic observations (iii) Ground Truth Package: contains the ground truth tarets for the competition. (a) TraceData.hdf5 records the traces of the empirical distribution obtained from Nested Sampling; it is primarily used for the Regular Track. (b) QuartilesTable.csv records the 16th, 50th, and 84th percentile of the posterior distribution; it is mainly used as a target for the Light Track.\n(c) FM Parameter Table.csv records the model values that generate the spectra in the first place. While it could be different from the ground truth; it can be used as a soft label.\n2 Train-test split\nith our long separation from an y e xoplanets and limitations from urrent technologies, it is almost impossible to ascertain the true ature of the target exo-atmosphere. In other words, our test distriution will always be different from the training distribution, also nown as domain shift in ML literature (Wang & Deng 2018 ; Wilson\nASTAI 2, 45\u201361 (2023)\nCook 2020 ) To reflect this limitation, the train/test split is designed o unco v er solutions that can maintain their performance ev en under nknown situations (unseen atmospheric behaviour and/or unseen lanets). To support this goal, we abandoned the usual practice of dividing\ndata set randomly into training and test set, which tests the odel\u2019s ability to generalize under a homo g eneous distribution. nstead, the test set is designed to contain In-Training Parameter anges (In-Range) and Out-of-Training Range Parameters (Outange) components. In-Range samples represent examples that come rom the same distribution as the training data. Out-Range represent amples that are unseen by the model during training, this includes nseen planetary and atmospheric properties. As a result, some of the planets are purposely remo v ed from the raining set to create unseen planetary properties, any theoretical pectra created using from those planets are also tak en aw ay from he training, causing a slight drop in the amount of available training ata, as compared to Level 1 data. We further generated 5461 spectra nder equilibrium chemistry scheme (Ag \u0301undez et al. 2012 , 2020 ) y assuming solar elemental ratios to create unseen atmospheric roperties. As stated abo v e, these spectra are unseen and thus are not ncluded in the training set.\nThe test set is stratified into four subsets, each representing varying egree of similarity to the training data. Table E1 summarizes the ifferent configurations of the four subsets. Subset 1 is the most imilar to the training set as all the components are In-Range, while ubset 4 is the most dissimilar as all the components are Out-Range. ll of them contain roughly the same proportion ( \u223c25 per cent )in he test set. All e xamples, re gardless of their initial atmospheric assumptions r planetary properties, are homogeneously retrieved using the free hemistry settings outlined in Section 2.3 . By doing so, our retrie v als\nw c s\ns e d e t d\ni d\no h c i\ns t a a o\nT\nill be, on purpose, biased and will not be retrieving the input hemistry (ground truth). Participants are tasked to reproduce the ame results from our biased retrie v als.\nThe combined effect of these two changes means that any proposed olution will have to maintain reliable and consistent behaviour when xposed to distributions that are unknown and unseen to their training istribution. We explicitly did not include any spectra generated with quilibrium chemistry assumption in the training set, as a proxy of he actual situation \u2013 our atmospheric models cannot adequately escribe the actual atmosphere. The stratification of test examples provides flexibility to future nvestigation. The test set can be used to test the trained model under ifferent testing conditions, for instance, one can test their models\nn set 1 examples to understand the model\u2019s performance under omogeneous cases. In any cases, spectra generated with either free hemistry and/or equilibrium chemistry is available online for any nterested parties to construct their own training and test set.\nThe data set for NeurIPS 2022 competition contains a similar data tructure, but featured more diverse, unseen atmospheric assumptions han the one presented here. A discussion of these atmospheric ssumption is outside the scope of this paper, and the readers are dvised to refer to Yip et al. ( 2022b ) for a more detailed description f the respective test set for the data challenge.\nhis paper has been typeset from a T E X/L A T E X file prepared by the author.\nRASTAI 2, 45\u201361 (2023)\nD ow nloaded fro m https://academ ic.oup.com /rasti/article/2/1/45/6998590 by Indian Institute of Technology Patna user on 18 January 2024"
        }
    ],
    "title": "ESA-Ariel Data Challenge NeurIPS 2022: introduction to exo-atmospheric studies and presentation of the Atmospheric Big Challenge ABC Database",
    "year": 2023
}