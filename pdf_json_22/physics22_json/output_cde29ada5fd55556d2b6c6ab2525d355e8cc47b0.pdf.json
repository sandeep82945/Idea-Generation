{
    "abstractText": "The Compact Muon Solenoid Experiment Phase 1 Hadron Calorimeter upgrade implemented the first large-scale application of VTRxs modules, radiation and magnetic field tolerant optical transceivers. During Run 2 of the Large Hadron Collider, the CMS Hadron Calorimeter endcap experienced a failure of control communication that revealed a variable manufacturing weakness in the VTRx and affected nearly half of the communication links in the Hadron Calorimeter endcaps. The CMS Hadron Calorimeter team provided the first observation of this phenomenon, linked the loss to the VTRx, revealed its temperature dependence, and pioneered the mitigation tactic adopted by other LHC experiments. We will present these aspects of the larger VTRx investigation. Presented at TWEPP2021 TWEPP 2021 Topical Workshop on Electronics for Particle Physics Prepared for submission to JINST Topical Workshop on Electronics for Particle Physics 20-24 September 2021 Online CMS HCAL VTRx-induced communication loss and mitigation G. Cummings on behalf of the CMS Collaboration University of Virginia, 382 McCormick Rd, Charlottesville, VA, United States E-mail: gecummings@virginia.edu Abstract: The Compact Muon Solenoid Experiment Phase 1 Hadron Calorimeter upgrade implemented the first large-scale application of VTRxs modules, radiation and magnetic field tolerant optical transceivers. During Run 2 of the Large Hadron Collider, the CMS Hadron Calorimeter endcap experienced a failure of control communication that revealed a variable manufacturing weakness in the VTRx and affected nearly half of the communication links in the Hadron Calorimeter endcaps. The CMS Hadron Calorimeter team provided the first observation of this phenomenon, linked the loss to the VTRx, revealed its temperature dependence, and pioneered the mitigation tactic adopted by other LHC experiments. We will present these aspects of the larger VTRx investigation. The Compact Muon Solenoid Experiment Phase 1 Hadron Calorimeter upgrade implemented the first large-scale application of VTRxs modules, radiation and magnetic field tolerant optical transceivers. During Run 2 of the Large Hadron Collider, the CMS Hadron Calorimeter endcap experienced a failure of control communication that revealed a variable manufacturing weakness in the VTRx and affected nearly half of the communication links in the Hadron Calorimeter endcaps. The CMS Hadron Calorimeter team provided the first observation of this phenomenon, linked the loss to the VTRx, revealed its temperature dependence, and pioneered the mitigation tactic adopted by other LHC experiments. We will present these aspects of the larger VTRx investigation.",
    "authors": [],
    "id": "SP:3adafad0a313d5086499ef6b98ba4035f5d0a572",
    "references": [
        {
            "authors": [
                "CMS Collaboration"
            ],
            "title": "The CMS experiment at the CERN LHC",
            "venue": "JINST 3 ",
            "year": 2008
        },
        {
            "authors": [
                "CMS Collaboration"
            ],
            "title": "CMS Technical Design Report for the Phase 1 Upgrade of the Hadron Calorimeter",
            "venue": "Tech Rep. CERN-LHCC-2012-015. CMS-TDR-10, CERN, Geneva, Sept.",
            "year": 2012
        },
        {
            "authors": [
                "F. Vasey"
            ],
            "title": "The Versatile Link common project: feasibility report, JINST vol",
            "year": 2012
        },
        {
            "authors": [
                "O. Groettvik"
            ],
            "title": "Installation, integration, and first operating experiences of the ALICE ITS Upgraded Readout System, at",
            "venue": "Topical Workshop on Electronics for Particle Physics,",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "Presented at TWEPP2021 TWEPP 2021 Topical Workshop on Electronics for Particle Physics\nPrepared for submission to JINST\nTopical Workshop on Electronics for Particle Physics"
        },
        {
            "heading": "20-24 September 2021 Online",
            "text": "CMS HCAL VTRx-induced communication loss and mitigation"
        },
        {
            "heading": "G. Cummings on behalf of the CMS Collaboration",
            "text": "University of Virginia, 382 McCormick Rd, Charlottesville, VA, United States\nE-mail: gecummings@virginia.edu\nAbstract: The Compact Muon Solenoid Experiment Phase 1 Hadron Calorimeter upgrade implemented the first large-scale application of VTRxs modules, radiation and magnetic field tolerant optical transceivers. During Run 2 of the Large Hadron Collider, the CMS Hadron Calorimeter endcap experienced a failure of control communication that revealed a variable manufacturing weakness in the VTRx and affected nearly half of the communication links in the Hadron Calorimeter endcaps. The CMS Hadron Calorimeter team provided the first observation of this phenomenon, linked the loss to the VTRx, revealed its temperature dependence, and pioneered the mitigation tactic adopted by other LHC experiments. We will present these aspects of the larger VTRx investigation.\nKeywords: Optical detector readout concepts, Front-end electronics for detector readout, Control and monitor systems online, Calorimeters"
        },
        {
            "heading": "1 Introduction",
            "text": "During the Phase 1 Upgrade of the Compact Muon Solenoid (CMS) experiment\u2019s Hadron Calorimeter (HCAL) [1], the HCAL endcap (HE) and HCAL barrel (HB) were refitted with entirely new front-end electronics. The new electronics increased the sampling calorimeter\u2019s readout depth segmentation, and replaced the original Phase 0 hybrid photodiodes with more sensitive Silicon Photomultipliers [2]. With a staged installation schedule, the upgraded HE participated in the final data-taking year of Run 2 of the LHC, and offered the first evidence of a control path problem, termed \u201cRSSI drift\u201d, that would eventually effect multiple LHC experiments. The HCAL control path begins with optical links that connect the on-detector Next Generation Clock, Control and Monitor (ngCCM) module to the back-end of CMS [2]. Within the endcap ngCCM, there are two control cards, each with a multimode (MM) VTRx optical transceiver [3] and a Microsemi Igloo FPGA, and two cards for clock distribution and power. The control cards provide redundant back-end communication links, with the primary card decoding clock and directing communication, and the secondary card serving passively. The HCAL upgraded featured the first large-scale use of the VTRx, which is a CERN designed radiation hard and magnetic field tolerant optical transceiver. During the 2018 data-taking, control communication was lost with one ngCCM, resulting in the loss of data from twenty degrees in \ud835\udf19 of one of the endcaps. Data taking was able to resume with a switch to the redundant control link, but the issue became a pattern when communication was lost for a second time in the opposite endcap during a commissioning run in 2019. Prior to the two instances of communication loss, the only indications of an unhealthy system were atypical changes in RSSI. The \u201cRSSI drift\u201d is the observed gradual reduction in the Received Signal Strength Indicator (RSSI) over time in VTRxs which preceded the communication loss with the front end. The RSSI is a current output of a current mirror with the PIN diode bias circuit within the Receiver Optical Sub-Assembly (ROSA) on the VTRx."
        },
        {
            "heading": "2 Details of communication loss",
            "text": ""
        },
        {
            "heading": "2.1 Description and extent of the phenomenon",
            "text": "The RSSI current is proportional to the amount of light incident on the PIN diode in the ROSA. As received light decreases, the RSSI decreases as well. During the 2018 data-taking period, the average RSSI value in HE was 350 \ud835\udf07A, with all modules in the 250 \ud835\udf07A to 450 \ud835\udf07A range. Prior to both communication loss events, the RSSI current decreased over time to the 10\u22123 \ud835\udf07A range, equivalent to a dark optical fiber. Immediately upon module extraction, the fiber plant was checked, and no fiber damage was detected. This led to a deeper investigation into the HCAL telemetry of RSSI and the interplay between the custom HCAL electronics and the VTRx. Upon close inspection, forty-five percent of all HE links, defined as one VTRx paired with one control card (two links per ngCCM), exhibited some level of RSSI instability, defined as an RSSI loss greater than 20 \ud835\udf07A from the initial value. This instability manifested in different patterns, but over time, two main patterns emerged: first, at power-on, RSSI starts at an expected value, then decreases with an exponential fall until it stabilizes; and second, at power-on, the RSSI exhibits the same exponential decrease, but then recovers to an expected value (between 250 \ud835\udf07A and 450 \ud835\udf07A).\n\u2013 2 \u2013\nThe two communication failures occurred with the first type of drift, with the \u201cstabilization\u201d value being too low to sustain communication. Variable among the instabilities is the timescale of the drift. For the 2018 and 2019 communication failures, the time scales were four months and three days, respectively. The non-critical drift structures stabilize within four to twelve hours. Notably, cavern conditions for 2019 and after were more variable, since CMS was in a shut down period."
        },
        {
            "heading": "2.2 Localization to VTRx",
            "text": "Localizing the issue proved to be challenging due to the difficulty of reproducing the behavior. Once modules with problematic links were removed from the CMS cavern to above-ground teststands, the RSSI trends were nearly impossible to replicate; a phenomenon that is now understood due to the revelations in section 4. A VTRx teststand capable of operating and monitoring outside of the HCAL ngCCM hardware was built, and this setup was able to replicate the drift features observed on-detector."
        },
        {
            "heading": "2.3 HCAL inclusive comparisons",
            "text": "The use of VTRxs in the CMS HCAL endcap is not unique within the HCAL subdetectors. In addition to the 72 links in HE, there are 144 identical control cards installed in the HCAL barrel, and at the time of these studies, 16 single mode (SM) VTRxs in the HCAL forward (HF). The isolation of the issue to the VTRx implies that the VTRxs in HB, some of which are from the same batch as HE, should also experience RSSI drift. The ALICE collaboration discovered that SM VTRxs drift [4], implying that HF could also be affected. The HCAL barrel had been extensively operated on the primary link in commissioning runs, and during this period, no RSSI drift was observed. HF had been operating without RSSI drift since the VTRx installation in 2016. The control electronics in HE and HB are both situated on-detector in water-cooled aluminum housings, with the water temperature held to around 18 \u00b0C. The HE and HB ngCCM share the same control card PCB design, making the primary difference between the ngCCMs the use of one clock card in HB instead of two, and the addition of a copper heat sink, termed a cooling fin. This heat sink is installed on the VTRxs. Figure 1 shows the cooling fin implementation. The HB upgrade was done after HE, allowing the cooling fin to be added after in-situ temperature studies revealed that the VTRx was operating around 45\u00b0C, roughly 20\u00b0C hotter than the surrounding mechanics, and higher than expected during ngCCM design. The HF ngCCMs operate in an entirely different regime, installed on a mezzanine on a blade in an air-cooled rack off-detector, connected to the optical link via a pigtail within the body of the blade. The HF VTRxs operate around 38\u00b0C."
        },
        {
            "heading": "3 In situ mitigation",
            "text": "A survey of the secondary links in HB revealed a single HB link with RSSI loss. Only losing 10 \ud835\udf07A a day in RSSI, this slow drifter was only observed during the first two continuous weeks of detector operation after the COVID-19 lockdowns at CERN. Upon extraction from the detector, the suspect link was discovered to lack the cooling fin due to an assembly error. This fortuitous discovery indicated that the cooling fins mitigated drift in HB. The cooling fins have three properties:\n1. They provide conductive cooling\n\u2013 3 \u2013\n2. They are electrically grounded\n3. They apply a mechanical pressure\nTests were performed that isolated each of the properties of the cooling fin, and it was found that the temperature regulating aspect of the fin mitigated drift. The discrepancy between the operating temperatures of HE/HB and HF hint that the absolute temperature is not the only governing factor. A more advanced VTRx teststand with multiple temperature measurements and controls on the VTRx and optical plant was created to study the temperature landscape of VTRx operation."
        },
        {
            "heading": "4 Problem origin and understanding",
            "text": "The modularity of the VTRx teststand allowed for the first observation of the condensation of a material on the face of the incoming fiber to the ROSA. Over time, material outgassing from the ROSA would condense on the fiber face, obscuring the transmission of light to the VTRx. The results of the outgassing are pictured in figure 2. This mechanism explains how the decrease in RSSI correlates with the loss of communication. Two processes determine whether the VTRx will drift: the outgassing process itself, and the condensation reaction. This offers two solutions to the RSSI-drift-correlated communication loss. First, one could limit the outgassing (which is beyond the scope of this proceeding), or one could stop the condensation. Figure 3 shows the RSSI trend phase space of the temperature differential between the VTRx ROSA and the incoming fiber ferrule for one VTRx. By maintaining\n\u2013 4 \u2013\nthe temperature difference between the incoming fibers and the ROSA to around 10\u00b0C, and more broadly, minimizing that difference as much as possible, the RSSI stabilizes. Speculatively, the lack of reproducibilty of the drift in the initial studies was likely due to the season of the year. The measurements were done in the summer, and the ambient temperature of the fibers in the laboratory were higher than the fibers in the CMS cavern.\n\u2013 5 \u2013"
        },
        {
            "heading": "5 Conclusions",
            "text": "The communication losses suffered in the CMS HCAL upgrade were due to outgassing in the VTRx ROSA. The outgassed material condenses on the face of the fiber, blocking transmitted light. This effect can be mitigated without direct intervention to the VTRx by minimizing the difference in temperature between the incoming fiber and the VTRx ROSA, implemented in the CMS HCAL by the addition of a heat sink on the VTRx. While the CMS HCAL was the first to observe this phenomenon as the first large scale user of the VTRx, we were not the last, and other LHC experiments have started implementing heat sinks inspired by our design when other solutions are not possible. Since this is a mitigation tactic, and not a VTRx-native solution, the CMS HCAL maintains the risk of data loss if temperature control is lost. With our solution, we believe we are capable of stable operation for the remainder of LHC operation."
        },
        {
            "heading": "Acknowledgments",
            "text": "This work required the engagement of the entire CMS HCAL team, but with particular emphasis on the contributions of Jay Dittmann, Xuli (Sebastian) Yan, Jon Wilson, and the online software team. The ALICE Inner Tracking System (ITS) lent us the VTRx with which outgassing was first observed. Detailed studies of the source of the outgassing were done by the CERN-ESE team. COVID-19 restrictions made the powering and operation of the detector challenging in summer 2020, and without the dedicated advocacy of the CMS Run and Technical Coordination teams, and the volunteerism of the shift-eligible persons available onsite at CERN, we would not have been able to complete the necessary monitoring campaigns, interventions, and ultimate rework of the CMS HE."
        }
    ],
    "year": 2021
}