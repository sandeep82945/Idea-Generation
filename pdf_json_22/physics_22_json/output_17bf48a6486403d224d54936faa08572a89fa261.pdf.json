{
    "abstractText": "Resonances are omnipresent in physics and essential for the description of wave phenomena. We present an approach for computing eigenfrequency sensitivities of resonances. The theory is based on Riesz projections and the approach can be applied to compute partial derivatives of the complex eigenfrequencies of any resonance problem. Here, the method is derived for Maxwell\u2019s equations. Its numerical realization essentially relies on direct differentiation of scattering problems. We use a numerical implementation to demonstrate the performance of the approach compared to differentiation using finite differences. The method is applied for the efficient optimization of the quality factor of a nanophotonic resonator. https://doi.org/10.1038/s42005-022-00977-1 OPEN",
    "authors": [
        {
            "affiliations": [],
            "name": "Felix Binkowski"
        },
        {
            "affiliations": [],
            "name": "Fridtjof Betz"
        },
        {
            "affiliations": [],
            "name": "Martin Hammerschmidt"
        },
        {
            "affiliations": [],
            "name": "Philipp-Immanuel Schneider"
        },
        {
            "affiliations": [],
            "name": "Lin Zschiedrich"
        },
        {
            "affiliations": [],
            "name": "Sven Burger"
        }
    ],
    "id": "SP:1d2d29bc78f44d734c45069baf5a2eb0ad985a72",
    "references": [
        {
            "authors": [
                "L. Novotny",
                "N. van Hulst"
            ],
            "title": "Antennas for light",
            "venue": "Nat. Photonics",
            "year": 2011
        },
        {
            "authors": [
                "A.I. Kuznetsov",
                "A.E. Miroshnichenko",
                "M.L. Brongersma",
                "Y.S. Kivshar",
                "B. Luk\u2019yanchuk"
            ],
            "title": "Optically resonant dielectric nanostructures",
            "venue": "Science 354,",
            "year": 2016
        },
        {
            "authors": [
                "P. Senellart",
                "G. Solomon",
                "A. White"
            ],
            "title": "High-performance semiconductor quantum-dot single-photon sources",
            "venue": "Nat. Nanotechnol",
            "year": 2017
        },
        {
            "authors": [
                "Anker",
                "J. N"
            ],
            "title": "Biosensing with plasmonic nanosensors",
            "venue": "Nat. Mater",
            "year": 2008
        },
        {
            "authors": [
                "Ma",
                "R.-M",
                "R.F. Oulton"
            ],
            "title": "Applications of nanolasers",
            "venue": "Nat. Nanotechnol",
            "year": 2019
        },
        {
            "authors": [
                "Ma",
                "X.-C",
                "Y. Dai",
                "L. Yu",
                "Huang",
                "B.-B"
            ],
            "title": "Energy transfer in plasmonic photocatalytic composites",
            "venue": "Light Sci. Appl. 5,",
            "year": 2016
        },
        {
            "authors": [
                "Y Zhang"
            ],
            "title": "Surface-plasmon-driven hot electron photochemistry",
            "venue": "Chem. Rev. 118,",
            "year": 2018
        },
        {
            "authors": [
                "P Lalanne"
            ],
            "title": "Light interaction with photonic and plasmonic resonances",
            "venue": "Laser Photonics Rev",
            "year": 2018
        },
        {
            "authors": [
                "T. Wu",
                "M. Gurioli",
                "Lalanne",
                "P. Nanoscale light confinement"
            ],
            "title": "The Q\u2019s and V\u2019s",
            "venue": "ACS Photonics 8, 1522\u20131538",
            "year": 2021
        },
        {
            "authors": [
                "West",
                "P. R"
            ],
            "title": "Searching for better plasmonic materials",
            "venue": "Laser Photonics Rev",
            "year": 2010
        },
        {
            "authors": [
                "Wang",
                "B. et al. High-Q plasmonic resonances"
            ],
            "title": "Fundamentals and applications",
            "venue": "Adv. Opt. Mater. 9, 2001520",
            "year": 2021
        },
        {
            "authors": [
                "P Lalanne"
            ],
            "title": "Quasinormal mode solvers for resonators with dispersive materials",
            "venue": "J. Opt. Soc. Am. A 36,",
            "year": 2019
        },
        {
            "authors": [
                "D. Bindel",
                "A. Hood"
            ],
            "title": "Localization theorems for nonlinear eigenvalue problems",
            "venue": "SIAM J. Matrix Anal. Appl",
            "year": 2013
        },
        {
            "authors": [
                "S. G\u00fcttel",
                "F. Tisseur"
            ],
            "title": "The nonlinear eigenvalue problem",
            "venue": "Acta Numer",
            "year": 2017
        },
        {
            "authors": [
                "J.S. Jensen",
                "O. Sigmund"
            ],
            "title": "Topology optimization for nano-photonics",
            "venue": "Laser Photonics Rev",
            "year": 2011
        },
        {
            "authors": [
                "Bouhlel",
                "M. A"
            ],
            "title": "A python surrogate modeling framework with derivatives",
            "venue": "Adv. Eng. Softw. 135,",
            "year": 2019
        },
        {
            "authors": [
                "D.G. Cacuci",
                "M. Ionescu-Bujor",
                "I.M. Navon"
            ],
            "title": "Sensitivity and Uncertainty Analysis, Volume II: Applications to Large-Scale Systems 1st edn",
            "year": 2005
        },
        {
            "authors": [
                "T. Kato"
            ],
            "title": "Perturbation Theory for Linear Operators 2nd edn (Springer-Verlag",
            "year": 1995
        },
        {
            "authors": [
                "J.J. Sakurai",
                "J. Napolitano"
            ],
            "title": "Modern Quantum Mechanics 3rd edn",
            "year": 2020
        },
        {
            "authors": [
                "N. Bursch\u00e4pers",
                "S. Fiege",
                "R. Schuhmann",
                "A. Walther"
            ],
            "title": "Sensitivity analysis of waveguide eigenvalue problems",
            "venue": "Adv. Radio Sci",
            "year": 2011
        },
        {
            "authors": [
                "M.A. Swillam",
                "M.H. Bakr",
                "X. Li",
                "M.J. Deen"
            ],
            "title": "Efficient sensitivity analysis of the time independent Schr\u00f6dinger equation with application to quantum lasers",
            "venue": "Opt. Commun. 281,",
            "year": 2008
        },
        {
            "authors": [
                "W. Yan",
                "P. Lalanne",
                "Qiu",
                "M. Shape deformation of nanoresonator"
            ],
            "title": "A quasinormal-mode perturbation theory",
            "venue": "Phys. Rev. Lett. 125, 013901",
            "year": 2020
        },
        {
            "authors": [
                "R. Alam",
                "S.K. Safique Ahmad"
            ],
            "title": "Sensitivity analysis of nonlinear eigenproblems",
            "venue": "SIAM J. Matrix Anal. Appl",
            "year": 2019
        },
        {
            "authors": [
                "F. Binkowski",
                "L. Zschiedrich",
                "S. Burger"
            ],
            "title": "A Riesz-projection-based method for nonlinear eigenvalue problems",
            "venue": "J. Comput. Phys. 419,",
            "year": 2020
        },
        {
            "authors": [
                "F. Betz",
                "F. Binkowski",
                "Burger",
                "S. RPExpand"
            ],
            "title": "Software for Riesz projection expansion of resonance phenomena",
            "venue": "SoftwareX 15, 100763",
            "year": 2021
        },
        {
            "authors": [
                "L Zschiedrich"
            ],
            "title": "Riesz-projection-based theory of light\u2013matter interaction in dispersive nanoresonators",
            "venue": "Phys. Rev. A 98,",
            "year": 2018
        },
        {
            "authors": [
                "J. Pomplun",
                "S. Burger",
                "L. Zschiedrich",
                "F. Schmidt"
            ],
            "title": "Adaptive finite element method for simulation of optical nano structures",
            "venue": "Phys. Status Solidi B 244,",
            "year": 2007
        },
        {
            "authors": [
                "U. Hohenester",
                "A. Tr\u00fcgler"
            ],
            "title": "MNPBEM\u2014A Matlab toolbox for the simulation of plasmonic nanoparticles",
            "venue": "Comput. Phys. Commun. 183,",
            "year": 2012
        },
        {
            "authors": [
                "N.K. Nikolova",
                "J.W. Bandler",
                "M.H. Bakr"
            ],
            "title": "Adjoint techniques for sensitivity analysis in high-frequency structure CAD",
            "venue": "IEEE Trans. Microw. Theory Technol",
            "year": 2004
        },
        {
            "authors": [
                "S. Burger",
                "L. Zschiedrich",
                "J. Pomplun",
                "F. Schmidt",
                "B. Bodermann"
            ],
            "title": "Fast simulation method for parameter reconstruction in optical metrology",
            "venue": "Proc. SPIE 8681,",
            "year": 2013
        },
        {
            "authors": [
                "L.N. Trefethen",
                "J.A.C. Weideman"
            ],
            "title": "The exponentially convergent trapezoidal rule",
            "venue": "SIAM Rev. 56,",
            "year": 2014
        },
        {
            "authors": [
                "K Koshelev"
            ],
            "title": "Subwavelength dielectric resonators for nonlinear nanophotonics",
            "venue": "Science 367,",
            "year": 2020
        },
        {
            "authors": [
                "I.H. Malitson"
            ],
            "title": "Interspecimen comparison of the refractive index of fused silica",
            "venue": "J. Opt. Soc. Am",
            "year": 1965
        },
        {
            "authors": [
                "H.S. Sehmi",
                "W. Langbein",
                "Muljarov",
                "E.A. Optimizing the Drude\u2013Lorentz model for material permittivity"
            ],
            "title": "Method, program, and examples for gold, silver, and copper",
            "venue": "Phys. Rev. B 95, 115444",
            "year": 2017
        },
        {
            "authors": [
                "F Binkowski"
            ],
            "title": "Source code and simulation results for Computation of eigenfrequency sensitivities using Riesz projections for efficient optimization of nanophotonic resonators. Zenodo https://doi.org/10.5281/zenodo.6614951 (2022)",
            "venue": "in Fig. 2a. ARTICLE COMMUNICATIONS PHYSICS | https://doi.org/10.1038/s42005-022-00977-1",
            "year": 2005
        },
        {
            "authors": [
                "M. Pelikan",
                "D.E. Goldberg",
                "Cant\u00fa-Paz",
                "E. BOA"
            ],
            "title": "The Bayesian optimization algorithm",
            "venue": "GECCO\u201999: Proc. Gen. Ev. Comp. Conf. 1, 525",
            "year": 1999
        }
    ],
    "sections": [
        {
            "heading": "ARTICLE",
            "text": "Computation of eigenfrequency sensitivities using Riesz projections for efficient optimization of nanophotonic resonators Felix Binkowski 1, Fridtjof Betz 1, Martin Hammerschmidt 2, Philipp-Immanuel Schneider2,\nLin Zschiedrich2 & Sven Burger 1,2\u2709\nResonances are omnipresent in physics and essential for the description of wave phenomena.\nWe present an approach for computing eigenfrequency sensitivities of resonances. The\ntheory is based on Riesz projections and the approach can be applied to compute partial\nderivatives of the complex eigenfrequencies of any resonance problem. Here, the method is\nderived for Maxwell\u2019s equations. Its numerical realization essentially relies on direct differ-\nentiation of scattering problems. We use a numerical implementation to demonstrate the\nperformance of the approach compared to differentiation using finite differences. The method\nis applied for the efficient optimization of the quality factor of a nanophotonic resonator.\nhttps://doi.org/10.1038/s42005-022-00977-1 OPEN\n1 Zuse Institute Berlin, 14195 Berlin, Germany. 2 JCMwave GmbH, 14050 Berlin, Germany. \u2709email: burger@zib.de\nCOMMUNICATIONS PHYSICS | (2022) 5:202 | https://doi.org/10.1038/s42005-022-00977-1 | www.nature.com/commsphys 1\n12 34\n56 78\n9 0 () :,;\nResonance phenomena are ubiquitous in nanophotonics andplay an important role for tailoring light\u2013matterinteractions1,2. They are exploited in, e.g., single-photon sources for quantum technology3, biosensors4, nanolasers5, or solar energy devices6,7. All these applications rely on the highly localized electromagnetic field energies in the vicinity of the underlying nanoresonators8. A central figure of merit for the description of resonance effects is the quality (Q) factor, which quantifies, in the case of low-loss systems, the relation between stored and radiated field energies of the resonances9. Nanoresonators with low energy dissipation, i.e., with high Q-factors, have been proposed to improve the efficiencies of nanophotonic devices2,10. For example, high-Q resonators can boost the brightness of quantum emitters, the sensitivity of sensors, or the emission processes in plasmonic lasers11. Designing devices with numerical optimization is a time and cost-effective approach. The resonances are numerically computed by solving the source-free Maxwell\u2019s equations equipped with open boundary conditions12. This yields non-Hermitian eigenproblems and the solutions are eigenmodes with complex-valued eigenfrequencies. In this context, the Q-factor is defined as the scaled ratio of the real and imaginary parts of the eigenfrequency.\nNanoresonators with high Q-factors have been theoretically presented, but fabrication of these resonators is a limiting task11. The sensitivity analysis of eigenfrequencies can show a way to reduce the sensitivities of the Q-factors. This can support the nanofabrication processes. Furthermore, the sensitivity analysis of eigenfrequencies is essential for numerical simulation. For example, the numerical accuracies of the calculated eigenfrequencies are strongly influenced by the sensitivities of the eigenfrequencies when the systems are subject to small perturbations13,14. In particular, for high-Q resonators, the accuracy requirements are demanding since the real and imaginary parts of the eigenfrequencies differ by several orders of magnitude. Sensitivities are also directly exploited in numerical optimization algorithms using gradients15, for gradient-enhanced surrogate modeling16, and for local sensitivity analyses17. The computation of eigenfrequency sensitivities is usually based on perturbation theory18,19, where the sensitivity of the underlying operator, the left and the right eigenmodes, and a proper normalization of the eigenmodes are required. The solution of the perturbed systems, on the other hand, is not necessary. For resonance problems, left and right eigenmodes are in general not identical, which increases the computational effort, and normalization requires additional attention. There are specialized approaches that, e.g., exploit magnetic fields for extracting the left eigenmodes20, introduce an adjoint system for computing sensitivities21, or that rely on internal and external electric fields at the boundaries of the nanoresonators22. It is also possible to completely omit the use of eigenmodes for sensitivity analysis23. A further approach is the straightforward application of finite differences. However, this also includes the solution of the perturbed resonance problems, which increases the computational effort.\nIn this work, we present an approach for computing eigenfrequency sensitivities that completely avoids solving resonance problems. The approach is based on Riesz projections given by contour integrals in the complex frequency plane. The contour integrals are numerically accessed by solving Maxwell\u2019s equations with a source term enabling an efficient numerical realization using direct differentiation. The numerical experiments show a significant reduction in computational effort compared to applying finite differences. A Bayesian optimization algorithm with the incorporation of eigenfrequency sensitivities is used to optimize a resonator hosting a resonance with a high Q-factor."
        },
        {
            "heading": "Results",
            "text": "Theoretical background and numerical realization. We start with an introduction of the theoretical background on resonance phenomena occurring in nanophotonics. Based on this, Riesz projections for computing eigenfrequency sensitivities and an efficient approach for its numerical realization are presented.\nResonances in nanophotonics. In nanophotonics, in the steadystate regime, light\u2013matter interactions can be described by the time-harmonic Maxwell\u2019s equations in second-order form,\n\u2207 \u00b4 \u03bc 10 \u2207 \u00b4E\u00f0r;\u03c90\u00de \u03c920\u03f5\u00f0r;\u03c90\u00deE\u00f0r;\u03c90\u00de \u00bc i\u03c90J\u00f0r\u00de; \u00f01\u00de\nwhere E\u00f0r;\u03c90\u00de 2 C3 is the electric field, r 2 R3 is the position, \u03c90 2 R is the angular frequency, and J\u00f0r\u00de 2 C3 is the electric current density corresponding to a light source. In the optical regime, the permeability tensor \u03bc(r, \u03c90) typically equals the vacuum permeability \u03bc0. The permittivity tensor \u03f5(r,\u03c90)= \u03f5r(r, \u03c90)\u03f50, where \u03f5r(r,\u03c90) is the relative permittivity and \u03f50 the vacuum permittivity, describes the spatial distribution of material and the material dispersion. Solutions to Eq. (1) are called scattering solutions as light from a source is scattered by a material system.\nResonances are solutions to Eq. (1) without a source term, i.e., J(r)= 0, and with transparent boundary conditions. The boundary conditions lead to non-Hermitian eigenproblems, and, if material dispersion is also present, the eigenproblems become nonlinear. The electric field distribution of an eigenmode is denoted by ~E\u00f0r\u00de 2 C3 and the corresponding complex-valued eigenfrequency by ~\u03c9 2 C. The Q-factor of a resonance is defined by\nQ \u00bc Re\u00f0~\u03c9\u00de 2Im\u00f0~\u03c9\u00de and describes its spectral confinement. In the limiting case of vanishing losses, this definition agrees with the energy definition, according to which the Q-factor quantifies the relation between stored and dissipated electromagnetic field energy of a resonance9.\nIn the following, a nanophotonic resonator supporting a resonance with a high Q-factor is investigated. We compute the eigenfrequency sensitivities with respect to various parameters to optimize the Q-factor of the nanoresonator. Figure 1 sketches the applied framework for an exemplary problem, a one-dimensional resonator defined by layers with different permittivities. Changes \u03b4p of the parameter p lead to changes in the eigenmode ~E and in the corresponding eigenfrequency ~\u03c9, which describes the sensitivity of ~E and ~\u03c9 with respect to the parameter p. To compute the eigenfrequency sensitivity, we introduce a contourintegral-based approach using Riesz projections, where physical observables are extracted from scattering problems. Solving the scattering problems, which are linear systems, can be regarded as a blackbox24,25.\nRiesz projections for eigenfrequency sensitivities. To derive a Rieszprojection-based approach for computing eigenfrequency sensitivities, which are the partial derivatives of the eigenfrequency, we consider the electric field E\u00f0r;\u03c90 2 R\u00de as a solution of Eq. (1) and E\u00f0r;\u03c9 2 C\u00de as an analytical continuation of E(r, \u03c90) into the complex frequency plane. The field E(r, \u03c9) is a meromorphic function with resonance poles at the eigenfrequencies. To simplify the notation, we omit the spatial and frequency dependency of the electric field and write E when we mean E(r, \u03c9).\nLet L\u00f0E\u00de be a physical observable, where L : C3 ! C is a linear functional, and ~C be a contour enclosing the pole ~\u03c9 of the order m and no other poles. Then, the Laurent expansion of L\u00f0E\u00de\n2 COMMUNICATIONS PHYSICS | (2022) 5:202 | https://doi.org/10.1038/s42005-022-00977-1 | www.nature.com/commsphys\nabout ~\u03c9 is given by\nL\u00f0E\u00de \u00bc \u2211 1\nk\u00bc m ak\u00f0\u03c9 ~\u03c9\u00dek;where\nak\u00f0~\u03c9\u00de \u00bc 1 2\u03c0i\nI\n~C\nL\u00f0E\u00f0\u03c9\u00de\u00de \u00f0\u03c9 ~\u03c9\u00dek\u00fe1 d\u03c9 2 C:\n\u00f02\u00de\nThe coefficient a 1\u00f0~\u03c9\u00de is the so-called residue of L\u00f0E\u00de at ~\u03c9. Using Eq. (2) with the assumption that ~\u03c9 has the order m= 1 and applying Cauchy\u2019s integral formula yieldI\n~C\n\u03c9L\u00f0E\u00de d\u03c9 \u00bc I\n~C\n\u03c9 \u03c9 ~\u03c9 a 1\u00f0~\u03c9\u00de d\u03c9 \u00bc ~\u03c9 I\n~C\nL\u00f0E\u00de d\u03c9;\nwhere, due to the closed integral in the complex plane, the regular terms in the expansion vanish. With this, the eigenfrequency ~\u03c9 is given by\n~\u03c9 \u00bc\nH ~C\n\u03c9L\u00f0E\u00de d\u03c9 H ~C L\u00f0E\u00de d\u03c9 : \u00f03\u00de\nThe contour integrals in this equation are essentially Riesz projections for L\u00f0E\u00de and ~C24. Partial differentiation with respect to a parameter p directly gives the desired expression for the eigenfrequency sensitivity,\n\u2202~\u03c9 \u2202p \u00bc \u2202u \u2202p v u \u2202v \u2202p 1 v2 ; where\nu \u00bc I\n~C\n\u03c9L\u00f0E\u00de d\u03c9; v \u00bc I\n~C\nL\u00f0E\u00de d\u03c9;\n\u2202u \u2202p\n\u00bc I\n~C\n\u03c9L \u2202E \u2202p d\u03c9; \u2202v \u2202p\n\u00bc I\n~C\nL \u2202E \u2202p d\u03c9:\n\u00f04\u00de\nFor the interchangeability of integral and derivative, E and \u2202E/ \u2202p are assumed to be continuously differentiable with respect to the frequency \u03c9 and the parameter p. The eigenmode ~E and its sensitivity \u2202~E=\u2202p can be represented by the contour integrals\n~E \u00bc I\n~C\nE d\u03c9 and \u2202~E \u2202p\n\u00bc I\n~C\n\u2202E \u2202p d\u03c9;\nrespectively, which are Riesz projections applied to Maxwell\u2019s equations given by Eq. (1). This approach can be generalized for multiple eigenfrequencies inside a contour as well as for higher order poles; cf. Binkowski et al.24. Note that Riesz projections can also be used to compute modal expansions of physical\nobservables, where scattering solutions are expanded into weighted sums of eigenmodes26.\nNumerical realization and direct differentiation. For the numerical realization of the presented approach, the finite element method (FEM) is applied. Scattering problems are solved by applying the solver JCMSUITE27. The FEM discretization of Eq. (1) leads to the linear system of equations AE= f, where A 2 Cn \u00b4 n is the system matrix, E 2 Cn is the scattered electric field in a finite-dimensional FEM basis, and f 2 Cn contains the source term. The solver employs adaptive meshing and higher order polynomial ansatz functions. In all subsequent simulations, it is ensured that sufficient accuracies are achieved with respect to the FEM discretization parameters. Note that also other methods can be used for numerical discretization. In the field of nanophotonics, common approaches are, e.g., the finite-difference timedomain method, the Fourier modal method, or the boundary element method12,28.\nIn order to calculate eigenfrequencies ~\u03c9 and their sensitivities \u2202~\u03c9=\u2202pi with respect to parameters pi, the electric fields E and their sensitivities \u2202E/\u2202pi are computed for complex frequencies \u03c9 2 C on the contours given in Eqs. (3) and (4). For the calculation of \u2202E/\u2202pi, we apply an approach based on directly using the FEM system matrix29,30. With this direct differentiation method, the sensitivities of scattering solutions can be computed by\n\u2202E \u2202pi \u00bc A 1 \u2202f \u2202pi \u2202A \u2202pi E : \u00f05\u00de\nIn a first step, instead of directly computing A\u22121, an LUdecomposition of A, which can be seen as the matrix variant of Gaussian elimination, is computed to efficiently solve the linear system AE= f. In the FEM context, this step is usually a computationally expensive step in solving scattering problems, so reusing an LU-decomposition can significantly reduce computational costs. In a second step, the partial derivatives of the system matrix, \u2202A/\u2202pi, and of the source term, \u2202f/\u2202pi, are obtained quasi analytically, i.e., with negligible computational effort. Then, A= LU, E, \u2202A/\u2202pi, and \u2202f/\u2202pi are used to compute \u2202E/\u2202pi in Eq. (5). The LUdecomposition can be used to obtain both E and \u2202E/\u2202pi.\nFor the calculation of the contour integrals, a numerical integration with a circular integration contour and a trapezoidal rule is used, which leads to an exponential convergence behavior with respect to the integration points31. At each integration point, we calculate E and \u2202E/\u2202pi by solving Eq. (1) with oblique incident plane waves as source terms. The linear functional L\u00f0E\u00de corresponds to a spatial point evaluation of one component of the electric field, which can be understood as physical observable. Note that, with Eqs. (3) and (4), an eigenfrequency ~\u03c9 and its\nyields the eigenfrequency sensitivity \u2202~\u03c9=\u2202p. Solving the linear systems is considered as a blackbox.\nCOMMUNICATIONS PHYSICS | (2022) 5:202 | https://doi.org/10.1038/s42005-022-00977-1 | www.nature.com/commsphys 3\nsensitivity \u2202~\u03c9=\u2202pi can be calculated without solving resonance problems \u2207 \u00b4 \u03bc 1\u2207 \u00b4 ~E ~\u03c92\u03f5~E \u00bc 0 directly. Instead, scattering problems, where Eq. (5) can be exploited, are solved. We call the described approach, which combines Riesz projections and direct differentiation (DD), the Riesz projection DD method. Equation (4) and its numerical implementation exploiting Eq. (5) are the main results of this work and represent the difference from previous works on Riesz projections; cf. Zschiedrich et al.26.\nNote that the Riesz projection DD method is not limited to the field of nanophotonics, but can be applied to other eigenproblems as well. Maxwell\u2019s equations can be replaced by another partial differential equation, and then instead of the analytical continuation of the electric field E, the analytical continuation of another quantity is evaluated for the contour integration."
        },
        {
            "heading": "Application",
            "text": "Eigenfrequency sensitivities of a nanophotonic resonator. We investigate an example from the literature, a dielectric nanoresonator of cylindrical shape placed on a three-layer substrate, where constructive and destructive eigenmode interference has been used to engineer a bound state in the continuum (BIC)32. The nanoresonator has been designed taking into account various parameters to suppress radiation losses: The radius, the layer thicknesses, and the layer materials have been chosen to obtain a high-Q resonance. The nanoresonator is made of the high-index material aluminum gallium arsenide (AlGaAs) with 20% aluminum. A silicon dioxide (SiO2) spacer is placed between the nanoresonator and a film of indium tin oxide (ITO) on a SiO2 substrate. A sketch of the designed system is shown in Fig. 2a. For this specific configuration, a high-Q resonance with a Q-factor of Q= 188 \u00b1 5 has been experimentally observed, and numerical simulations have resulted in Q= 197, where the real part of the resonance wavelength is in the telecommunication wavelength\nregime, close to 1600 nm. The nanophotonic resonator has been exploited as a nanoantenna for nonlinear nanophotonics32.\nIn the following simulations, we consider the constant relative permittivities \u03f5r= 10.81 and \u03f5r= 2.084 for AlGaAs and for SiO2, respectively, which are extracted from experimental data32,33. For the ITO layer, the Drude model \u03f5r\u00f0\u03c90\u00de \u00bc \u03f5inf \u03c92p=\u00f0\u03c920 \u00fe i\u03c90\u03b3\u00de is chosen, where \u03f5inf \u00bc 3:8813, \u03c9p= 3.0305 \u00d7 1015 s\u22121, and \u03b3= 1.2781 \u00d7 1014 s\u22121. This Drude model is obtained by a rational fit34 to experimental data32 and describes the material dispersion of the system. We further exploit the rotational symmetry of the geometry. On the one hand, this reduces the computational effort and, on the other hand, the eigenmodes can be easily distinguished by their azimuthal quantum numbers m, which correspond to the number of oscillations in the radial and axial directions. When the light sources used for computing Riesz projections are not rotationally symmetric, such as oblique incident plane waves, the source fields can be expanded into Fourier modes in the angular direction. Considering Fourier modes with certain quantum numbers, only the eigenmodes, eigenfrequencies, and corresponding sensitivities associated with these quantum numbers are accessed.\nWe start with computing a Riesz projection to obtain the eigenfrequency ~\u03c9 of the high-Q resonance. Figure 2b shows the complex frequency plane with the calculated eigenfrequency, ~\u03c9 \u00bc \u00f01:17309 0:00296i\u00de \u00b4 1015 s 1, and the corresponding circular integration contour ~C for the computation of the Riesz projection. The center and the radius of the contour are selected based on a-priori knowledge from Koshelev et al.32. Alternatively, without a-priori knowledge, a larger integration contour can be used25. The simulations are performed using eight integration points on the contour ~C, where a sufficient accuracy with respect to the integration points is ensured. The computations are based on a FEM mesh consisting of 306 triangles. To compare the size of the contour with the distances between the eigenfrequencies\n4 COMMUNICATIONS PHYSICS | (2022) 5:202 | https://doi.org/10.1038/s42005-022-00977-1 | www.nature.com/commsphys\nwithin the spectrum of the nanoresonator, the two eigenfrequencies which are closest to ~\u03c9 are also shown. We obtain a Q-factor of Q= 198 for the high-Q resonance, which is in good agreement with the experimental and numerical results from Koshelev et al.32. The corresponding electric field intensity j~Ej2 is shown in Fig. 2c. The eigenmode ~E has the quantum number m= 0 and is strongly localized in the vicinity of the nanoresonator.\nNext, the eigenfrequency sensitivities \u2202~\u03c9=\u2202pi with respect to the parameters p1, p2,\u2026, p5 sketched in Fig. 2a are computed. In order to validate the approach, a convergence study for the polynomial degree d of the FEM ansatz functions is performed. Figure 2d, e shows the relative errors for the real and imaginary parts, respectively. Exponential convergence can be observed for all sensitivities with increasing d. The computed sensitivities for d= 5 are shown in Table 1. Exemplary source code for the Riesz projection DD method and simulation results are presented in Binkowski et al.35.\nPerformance benchmark. The computational effort of the numerical realization of the Riesz projection DD method is compared with the computational effort of the finite difference method. We choose the central difference scheme \u2202~\u03c9=\u2202pi ~\u03c9\u00f0pi \u00fe \u03b4pi\u00de ~\u03c9\u00f0pi \u03b4pi\u00de = 2\u03b4pi\nfor the comparison. Computing central differences is more computationally expensive than computing forward or backward differences. However, more accurate results can be achieved as the error decreases with \u00f0\u03b4pi\u00de2. To achieve an adequate accuracy, sufficiently small step sizes \u03b4pi are selected. For example, for the radius of the nanoresonator, we choose \u03b4p1= 0.1 nm. Note that, also for the finite difference method, we compute the eigenfrequencies by using the contourintegral-based formula in Eq. (3).\nWe increase the degrees of freedom of the system shown in Fig. 2a by deforming the cylindrical nanoresonator to an ellipsoidal nanoresonator. This breaks the rotational symmetry yielding a full three-dimensional system with new parameters, the radius of the nanoresonator in x direction and the radius in y direction. Figure 3 shows, for the three-dimensional implementation and for the rotational symmetric implementation, the normalized computational effort for different numbers of computed sensitivities. We compute the eigenfrequency ~\u03c9 and then we add the sensitivities, starting with \u2202~\u03c9=\u2202p1, one after the other. It can be observed that the Riesz projection DD method requires less computational effort than the finite difference method, for any number of computed sensitivities, i.e., for all N \u2265 1. In the case of using finite differences, the computational effort has a slope of about 200% because for each sensitivity two additional problems with typically the same dimension as the unperturbed problem have to be solved. In the three-dimensional case, a linear regression for the computational effort gives a slope of about 4% for the Riesz projection DD method. The computational effort needed for the LU-decomposition is significant compared to the matrix assembly and to the other solution steps, so the possibility of exploiting Eq. (5) gives a great benefit for the Riesz projection DD method. For N= 5, the CPU\ntime required to solve the linear system of equations, which includes the LU-decomposition, takes 81% of the accumulated CPU time. In the rotational symmetric case, the time for solving the linear system is negligible. However, the trend is the same for the three-dimensional and for the computationally cheaper rotational symmetric case: The advantage of using Riesz projections significantly increases with an increasing number of computed sensitivities.\nNote that contour integral methods are well suited for parallelization because the scattering problems can be solved in parallel on the integration contour. However, as total CPU times are considered for Fig. 3, this is not reflected by the time measurements.\nQ-factor optimization. The Riesz projection DD method is applied to further optimize the Q-factor of the high-Q resonance of the nanophotonic resonator from Koshelev et al.32 shown in Fig. 2a. A rotational symmetric nanoresonator is considered because simulations show that an ellipsoidal shape does not lead to a significant increase of the Q-factor. We use a Bayesian optimization algorithm36 with the incorporation of sensitivity information. This global optimization algorithm is well suited for problems with computationally expensive objective functions and benchmarks show that providing sensitivities can significantly reduce computational effort37. However, other optimization approaches could be used as well.\nFor the optimization, we choose the parameter ranges 435 nm \u2264 p1 \u2264 495 nm, 575 nm \u2264 p2 \u2264 695 nm, 150 nm \u2264 p3 \u2264 550 nm, 100 nm \u2264 p4 \u2264 500 nm, and 60\u2218 \u2264 p5 \u2264 90\u2218. To ensure that the optimized nanoresonator can also be used as nanoantenna in the telecommunication wavelength regime, like the original system, we add the constraint that the optimized eigenfrequency must lie in the circular contour with the center \u03c90= 2\u03c0c/(1600 nm) and the radius r0= 4 \u00d7 1013 s\u22121. In each optimization step, the Riesz\nTable 1 Computed eigenfrequency sensitivities.\ni Re\u00f0\u2202~\u03c9=\u2202pi\u00de \u00b4 10 10 Im\u00f0\u2202~\u03c9=\u2202pi\u00de \u00b4 10 10 1 \u2212128.750 (s nm)\u22121 \u22120.324 (s nm)\u22121 2 \u221284.568 (s nm)\u22121 2.660 (s nm)\u22121 3 \u22127.192 (s nm)\u22121 \u22121.955 (s nm)\u22121 4 \u22120.065 (s nm)\u22121 0.208 (s nm)\u22121 5 15.047 (s deg)\u22121 0.039 (s deg)\u22121\nThe sensitivities \u2202~\u03c9=\u2202pi correspond to the high-Q resonance of the nanoresonator shown in Fig. 2a and are computed at the shown parameter reference values.\neffort is the total CPU time normalized to the CPU time spent for computing the eigenfrequency ~\u03c9, which corresponds to N= 0. The time is measured with JCMSUITE using four threads on a machine with a 24-core Intel Xeon Processor running at 3.3 GHz. For all calculations, to ensure high accuracies, eight integration points at the integration contour ~C depicted in Fig. 2b are used. The degree of the FEM ansatz functions is fixed with d= 5. The mesh of the three-dimensional system consists of 4160 prisms and the mesh of the rotational symmetric system consists of 306 triangles.\nCOMMUNICATIONS PHYSICS | (2022) 5:202 | https://doi.org/10.1038/s42005-022-00977-1 | www.nature.com/commsphys 5\nprojection DD method is used to compute the eigenfrequency with a quantum number of m= 0 lying inside the contour and to calculate the corresponding sensitivities.\nA nanoresonator with a Q-factor of Q= 292 is obtained after 61 iterations of the optimizer yielding an increase of about 47.5% over the original resonator. More iterations yield only a negligible increase of the Q-factor. The optimized nanoresonator with a sketch of the electric field intensity of its high-Q resonance and the values for all underlying parameters are shown in Fig. 4. The corresponding eigenfrequency is given by ~\u03c9opt \u00bc \u00f01:176897 0:002015i\u00de \u00b4 1015 s 1. Note that, in the optimization domain, the average sensitivity of the Q-factor with respect to the ITO layer thickness p4 is negligible."
        },
        {
            "heading": "Conclusions",
            "text": "An approach for computing eigenfrequency sensitivities of resonance problems was presented. The numerical realization of the Riesz projection DD method relies on computing scattering solutions and their sensitivities by solving Maxwell\u2019s equations with a source term, i.e., solving linear systems of equations. This enables direct differentiation for the efficient calculation of eigenfrequency sensitivities. Although sensitivities of resonances are computed, no eigenproblems have to be solved directly. The performance of the approach was demonstrated by a comparison with the finite difference method. The Riesz projection DD method was incorporated into a gradient-based optimization algorithm to maximize the Q-factor of a nanophotonic resonator.\nThe savings in computational effort are particularly significant for optimization with respect to several parameters, which is a common task in nanophotonics. Therefore, we expect the approach to prove especially useful when many sensitivities are to be calculated. The Riesz projection DD method can not only be applied to problems in nanophotonics, but to any resonance problem."
        },
        {
            "heading": "Data availability",
            "text": "All relevant data generated or analyzed during this study are included in this published article. Tabulated data files are included in a corresponding data publication35."
        },
        {
            "heading": "Code availability",
            "text": "Source code for performing the numerical experiments can be found in Binkowski et al.35.\nReceived: 7 April 2022; Accepted: 19 July 2022;"
        },
        {
            "heading": "Acknowledgements",
            "text": "We acknowledge funding by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany\u2019s Excellence Strategy - The Berlin Mathematics Research Center MATH+ (EXC-2046/1, project ID: 390685689) and the German Federal Ministry of Education and Research (BMBF Forschungscampus MODAL, project 05M20ZBM). This project has received funding from the EMPIR program co-financed by the Participating States and from the European Union\u2019s Horizon 2020 research and innovation program (project 20FUN02 POLIGHT). We further thank Kirill Koshelev for providing the experimental material data for the physical system investigated in this work."
        },
        {
            "heading": "Author contributions",
            "text": "F.Bi., L.Z., and S.B. conceived and designed the research; F.Bi. and F.Be. performed the numerical simulations with input from M.H. and P.-I.S.; All authors discussed the results; F.Bi. wrote the manuscript with input from all authors."
        },
        {
            "heading": "Funding",
            "text": "Open Access funding enabled and organized by Projekt DEAL."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s42005-022-00977-1.\nCorrespondence and requests for materials should be addressed to Sven Burger.\nPeer review information Communications Physics thanks Zhiyuan Fan and the other anonymous reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.\nReprints and permission information is available at http://www.nature.com/reprints\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing,\nadaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/ licenses/by/4.0/.\n\u00a9 The Author(s) 2022\nCOMMUNICATIONS PHYSICS | (2022) 5:202 | https://doi.org/10.1038/s42005-022-00977-1 | www.nature.com/commsphys 7"
        }
    ],
    "title": "Computation of eigenfrequency sensitivities using Riesz projections for efficient optimization of nanophotonic resonators",
    "year": 2022
}