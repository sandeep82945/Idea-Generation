{
    "abstractText": "In this contribution, advanced modeling of thermo-mechanical effects in machine tools with nonlinear machine components is investigated using the example of a feed axis. Strategies of model order reduction for this coupled thermo-mechanical model with nonlinear subsystem are presented. Numerical investigations of the performance of the resulting reduced-order model compared to the original one conclude this article.",
    "authors": [
        {
            "affiliations": [],
            "name": "Julia Vettermann"
        },
        {
            "affiliations": [],
            "name": "Alexander Steinert"
        },
        {
            "affiliations": [],
            "name": "Christian Brecher"
        },
        {
            "affiliations": [],
            "name": "Peter Benner"
        },
        {
            "affiliations": [],
            "name": "Jens Saak"
        },
        {
            "affiliations": [],
            "name": "Kompakte thermomechanische"
        }
    ],
    "id": "SP:c66dc105fc3894ee59620a621fb04c717ed62351",
    "references": [
        {
            "authors": [
                "C. Brecher",
                "A. Broos",
                "F. Butz",
                "A. Epple",
                "M. Fey",
                "M. Kaever",
                "W. Koehler",
                "M. Koenigs",
                "M. Lange",
                "S. Neus",
                "M. Queins",
                "M. Weigold",
                "F. Wellmann",
                "H. Wille",
                "B. Zapf"
            ],
            "title": "Nutzen und Potenziale modellbasierter Datenanalyse",
            "venue": "Apprimus Verlag,",
            "year": 2017
        },
        {
            "authors": [
                "K. Gro\u00dfmann",
                "G. Jungnickel"
            ],
            "title": "Simulation des thermischen Verhaltens von Werkzeugmaschinen",
            "venue": "Adv. Des. Control, addprint AG, Dresden",
            "year": 2010
        },
        {
            "authors": [
                "M. Ess"
            ],
            "title": "Simulation and compensation of thermal errors of machine tools",
            "venue": "Ph. D. thesis, Institute of Machine Tools and Manufacturing, ETH Zu\u0308rich. https://doi.org/10.3929/ethz-a7357121",
            "year": 2012
        },
        {
            "authors": [
                "C. Brecher",
                "S. Ihlenfeldt",
                "S. Neus",
                "A. Steinert",
                "A. Galant"
            ],
            "title": "Thermal condition monitoring of a motorized milling spindle",
            "venue": "Production Engineering. Res. Dev",
            "year": 2019
        },
        {
            "authors": [
                "Y. Altintas",
                "C. Brecher",
                "M. Weck",
                "S. Witt"
            ],
            "title": "Virtual machine tool. CIRP Ann",
            "year": 2005
        },
        {
            "authors": [
                "C. Brecher",
                "M. Fey",
                "C. Tenbrock",
                "M. Daniels"
            ],
            "title": "Multipoint constraints for modeling of machine tool dynamics",
            "venue": "J. Manuf. Sci. Eng",
            "year": 2016
        },
        {
            "authors": [
                "C. Brecher",
                "A. Steinert",
                "S. Neus",
                "M. Fey"
            ],
            "title": "Metrological investigation and simulation of thermo-mechanical interactions in externally driven spindles",
            "venue": "Special Interest Group Meeting: Thermal Issues,",
            "year": 2020
        },
        {
            "authors": [
                "P. Benner",
                "S. Gugercin",
                "K. Willcox"
            ],
            "title": "A survey of projection-based model reduction methods for parametric dynamical systems",
            "venue": "SIAM Rev",
            "year": 2015
        },
        {
            "authors": [
                "C. Brecher",
                "M. Fey",
                "S. Neus",
                "Y. Shneor"
            ],
            "title": "Influences on the thermal behavior of linear guides and externally driven spindle systems",
            "venue": "Prod. Eng. Res. Dev",
            "year": 2014
        },
        {
            "authors": [
                "T. Harris"
            ],
            "title": "Essential Concepts of Bearing Technology. CRC Press Inc., Boca Raton",
            "year": 2006
        },
        {
            "authors": [
                "C. Brecher",
                "B. E\u00dfer",
                "J. Falker",
                "F. Kneer",
                "M. Fey"
            ],
            "title": "Modelling of ball screw drives rolling element contact characteristics",
            "venue": "CIRP Ann",
            "year": 2018
        },
        {
            "authors": [
                "S. Voormeeren"
            ],
            "title": "Dynamic substructuring methodologies for integrated dynamic analysis of wind turbines",
            "venue": "Ph.D. thesis, Precision and Microsystem Engineering,",
            "year": 2012
        },
        {
            "authors": [
                "A.C. Antoulas"
            ],
            "title": "Approximation of Large-Scale Dynamical Systems",
            "venue": "Adv. Des. Control,",
            "year": 2005
        },
        {
            "authors": [
                "U. Baur",
                "P. Benner",
                "L. Feng"
            ],
            "title": "Model order reduction for linear and nonlinear systems: A system-theoretic perspective",
            "venue": "Arch. Comput. Methods Eng",
            "year": 2014
        },
        {
            "authors": [
                "A.C. Antoulas",
                "C.A. Beattie",
                "S. G\u00fc\u011fercin"
            ],
            "title": "Interpolatory Methods for Model Reduction, Computational Science and Engineering",
            "venue": "SIAM Publications,",
            "year": 2020
        },
        {
            "authors": [
                "A. Lutowska"
            ],
            "title": "Model order reduction for coupled systems using low-rank approximations",
            "venue": "Ph. D. thesis, Department of Mathematics and Computer Science, Eindhoven University of Technology",
            "year": 2012
        },
        {
            "authors": [
                "A. Vandendorpe",
                "P. Van Dooren"
            ],
            "title": "Model reduction of interconnected systems",
            "year": 2008
        },
        {
            "authors": [
                "A. Schneider",
                "P. Benner"
            ],
            "title": "Reduced representation of power grid models. In: (P. Benner, ed) System Reduction for Nanoscale IC Design, Mathematics in Industry",
            "year": 2017
        },
        {
            "authors": [
                "P. Benner",
                "L. Feng"
            ],
            "title": "Model order reduction for coupled problems (survey)",
            "year": 2015
        },
        {
            "authors": [
                "M. Cruz Varona",
                "R. Gebhart",
                "J. Suk",
                "B. Lohmann"
            ],
            "title": "Practicable simulation-free model order reduction by nonlinear moment matching",
            "year": 2019
        },
        {
            "authors": [
                "P. Benner",
                "T. Stykel"
            ],
            "title": "2017. Model order reduction for differential-algebraic equations: A survey",
            "year": 2017
        },
        {
            "authors": [
                "N. Lang",
                "J. Saak",
                "P. Benner"
            ],
            "title": "Model order reduction for systems with moving loads. Automatisierungstechnik",
            "year": 2014
        },
        {
            "authors": [
                "P. Benner"
            ],
            "title": "Modellordnungsreduktion f\u00fcr strukturmechanische FEM-Modelle von Werkzeugmaschinen",
            "venue": "Project Report, TU Chemnitz. https://nbn-resolving.org/urn:",
            "year": 2009
        },
        {
            "authors": [
                "J. Fehr"
            ],
            "title": "Automated and error controlled model reduction in elastic multibody systems",
            "venue": "Ph. D. Thesis,",
            "year": 2011
        },
        {
            "authors": [
                "P. Holzwarth"
            ],
            "title": "Modellordnungsreduktion f\u00fcr substrukturierte mechanische systeme. In (P. Eberhard, ed) Schriften aus dem",
            "venue": "Institut fu\u0308r Technische und Numerische Mechanik der Universita\u0308t Stuttgart",
            "year": 2017
        },
        {
            "authors": [
                "P. Benner",
                "M. K\u00f6hler",
                "J. Saak"
            ],
            "title": "Matrix equations, sparse solvers: M-M.E.S.S.-2.0.1 \u2013 philosophy, features and application for (parametric) model order reduction",
            "venue": "Dynamical Systems. International Series of Numerical Mathematics 171. Birkha\u0308user, Cham. pp. 369\u2013392",
            "year": 2021
        },
        {
            "authors": [
                "J. Vettermann",
                "J. Saak",
                "A. Steinert"
            ],
            "title": "Code and data for numerical experiments in \u201ccompact thermo-mechanical models for the fast simulation of machine tools with nonlinear component behavior",
            "year": 2022
        }
    ],
    "sections": [
        {
            "text": "Keywords: thermo-mechanical model, machine tool, model order reduction, nonlinear subsystem\nZusammenfassung: In diesem Beitrag wird die erweiterte Modellierung thermomechanischer Effekte in Werkzeugmaschinenmit nichtlinearenMaschinenkomponenten am Beispiel einer Vorschubachse untersucht. Es werden Strategien zur Modellordnungsreduktion f\u00fcr dieses gekoppelte thermomechanische Modell mit nichtlinearem Teilsystem vorgestellt. Numerische Untersuchungen der Leistungsf\u00e4higkeit des resultierendenModells reduzierterOrdnung im Vergleich zum urspr\u00fcnglichen Modell schlie\u00dfen den Artikel ab.\n*Corresponding author: Julia Vettermann, Faculty of Mathematics, Technische Universit\u00e4t Chemnitz, Reichenhainer Stra\u00dfe 39/41, 09126 Chemnitz, Germany, e-mail: julia.vettermann@mathematik.tu-chemnitz.de Alexander Steinert, Christian Brecher, Laboratory for Machine Tools and Production Engineering (WZL), RWTH Aachen University, Steinbachstra\u00dfe 19, 52074 Aachen, Germany, e-mails: a.steinert@wzl.rwth-aachen.de, c.brecher@wzl.rwth-aachen.de Peter Benner, Jens Saak, Computational Methods in Systems and Control Theory, Max Planck Institute for Dynamics of Complex Technical Systems, Sandtorstra\u00dfe 1, 39106 Magdeburg, Germany, e-mails: benner@mpi-magdeburg.mpg.de, saak@mpi-magdeburg.mpg.de\nSchlagw\u00f6rter: thermomechanisches Modell, Werkzeugmaschine, Modellordnungsreduktion, nichtlineares Teilsystem"
        },
        {
            "heading": "1 Introduction",
            "text": "Machine tools are permanently exposed to complex static, dynamic and thermal loads. An undesirable displacement of the tool center point (TCP) limiting the achievable work piece quality at given productivity is the consequence. The technical complexity of machine tools requires advanced modeling approaches to describe static, dynamic and thermal effects accurately, since bothmachine structural parts and machine components affect the overall behavior.\nThe finite element method (FEM) is a powerful and vastly used tool to model static, dynamic and thermal effects in machine tools, which is reflected in a wide range of scientific work in this field. Yet, current research impulses in the context of model-based data analytics strive for process parallel solutions processing machine internal data [1]. In order to combine existing modeling capabilities with modern data-driven approaches, a massive reduction of calculation times is a fundamental requirement. At this point,model order reduction (MOR) becomes crucial. Sophisticated MOR strategies enable the computation of compact low-dimensional models for fast simulations of entire machine tool models while preserving a certain model accuracy.\nWithin the scope of this paper, a thermo-mechanical FE model of a feed axis is set up. As integral part of a modern 5-axismachine tool, this assembly group includes the relevant characteristics of machine tools mentioned above. Nonlinear boundary conditions, which are challenging in the field of MOR, are considered. Furthermore, novel preprocessing techniques allow classic linear MOR to be applied and, thus, enable for drastically reduced\nOpen Access. \u00a9 2022 the author(s), published by De Gruyter. This work is licensed under the Creative Commons Attribution 4.0 International License.\ncomputing times. Transient thermo-mechanical interactions of the feed axis are calculated in a final investigation."
        },
        {
            "heading": "2 Modeling of coupled thermo-mechanical systems",
            "text": ""
        },
        {
            "heading": "2.1 Thermo-mechanical behavior of machine tools",
            "text": "To date, the areas of thermal [2, 3, 4] andmechanical [5, 6] simulation have been widely studied. For subsystems like the main spindle unit, interactions between both thermal and mechanical domain were investigated and respective simulation models were derived [7].\nFor a body of homogeneous and temporally constant material properties (density \u03c1, heat capacity cp and conductivity \u03bb), the thermal behavior can be expressed analytically, resulting in a partial differential equation for the temperature field T (1). Here, the external thermal load q\u0307 (head flux density) has a spatial (\u03b4) and temporal (t) dependency,where \u03b4denotes the three-dimensional position coordinates,\n\u03c1cp \u00e0 \u00e0t T \u2212 \u03bb\u2207(\u2207T) = q\u0307(\u03b4, t). (1)\nElastostatic equilibrium for solid bodies can be expressed by Navier-Cauchy equation\n(\u03bb + \u03bc)\u2207(\u2207\u03b4) + \u03bc\u22072\u03b4 = \u2212F. (2)\nAgain, constant material parameters (Lam\u00e9 parameters \u03bb and \u03bc) are considered and F represents a volumedistributed force. Although we restrict our considerations\nto constant material parameters, the approach is not limited to this assumption.Note that in the case of variable parameters methods of MOR for parameter-varying systems, see [8], would have to be applied to (21) in Sec. 3.2.\nCombined thermo-elastic behavior of solid bodies is often assumed tobe linear. Althoughmachine toolsmainly consist of large structural parts, machine components like bearings, linear guideways or ball screws represent functionally relevant elements that usually act as coupling elements between the structural parts. Due to their nonlinear mechanical characteristics, thermal expansion of structural parts, for example,may affectmechanical conditions in machine components as displayed in Fig. 1.\nIn general, machine components act as significant heat sources in thermally sensitive regions of a machine tool. While bearings of the main spindle, for example, are characterized by the installation in structures of high power density, linear guideways induce heat along large structural parts that significantly contribute to the overall TCP error [9]. In reaction, transient temperature fields cause thermal expansion and thermal stress that ultimately result in reactive forces. These forces, in turn, influence contact pressings in machine components affecting their frictional behavior that initially caused the heat generation.\nIn order to investigate the effects of cross-domain behavior, an FE-based coupled model for a feed axis of a 5-axis machine tool is designed (Fig. 2).\nBesides two structural parts (P1 and P2) that represent the slide and the headstock, the assembly group contains two linear guideways, arranged in parallel, with two carriages each, i. e. four machine components in total (C1 to C4). While the structural parts are modeled via FEM, the components are represented as spring damper elements with nonlinear, load-dependent characteristics. A more detailed description is given below."
        },
        {
            "heading": "2.2 Modeling of structural parts",
            "text": "The given thermo-elastic partial differential equations in (1) and (2) are solved numerically. By discretizing in space and time, for each structural part of the assembly, a matrix equation\n(CP + dt \u22c5 KP)\u0398Pt = C P \u22c5 \u0398Pt\u22121 + dt \u22c5 B Put , (3)\nwith BPut denoting the external influences on the system, can be derived.\nHere, the heat capacity matrix CP only contains nonzero entries for thermal degrees of freedom (DOFs). In con-\ntrast, thematrixKP is composed of a thermal heat conduction partKPth, an elastic stiffness partK P el and a part considering thermal elongation KPel,th. Due to the different time scales of the thermal and mechanical system, dynamic effects in the mechanical part are negligible. Thus, the mechanical system ismodeled as static, and also the coupling from elastic to thermal degrees of freedom is neglected, in this paper. The resulting structure of each system matrix is visualized in Fig. 3, highlighting the asymmetric structure.\nThe machine structure is meshed with tetrahedral, quadratic SOLID227 coupled-field elements using ANSYS. As a result, for each node four DOFs\n\u0398P = [\u0394P TP] T = [\u03b4x \u03b4y \u03b4z T] T (4)\nfollow. The vector \u0398P contains structural DOFs \u0394P (translatoric displacements \u03b4 in x-, y-, and z-direction) and one thermal DOF TP (nodal temperature)."
        },
        {
            "heading": "2.3 Modeling of machine components",
            "text": "On the one hand, linear guideways are designed to ensure backlash- and friction-free motion in feed direction (z-direction in Fig. 2). On the other hand, the other DOFs except the linear feed direction are supposed to be locked. Since dynamic effects are not considered in this paper, linear guideways are modeled as nonlinear spring elements with 7 DOFs\n\u0398c = [\u0394c \u03d5c Tc] T\n= [\u03b4x \u03b4y \u03b4z \u03c6x \u03c6y \u03c6z T] T . (5)\nIn addition to the considered DOFs for structural parts (4), \u0398c does also contain respective rotations \u03c6 around all three coordinate axes in \u03d5c.\nSince the stiffness matrix\nKc = [[[[[\n[\nK\u03b4x\u03b4x \u22c5 \u22c5 \u22c5 0 0 ...\n. . . 0 0 0 0 K\u03c6z\u03c6z 0 0 0 0 KT ]]]]] ]\n(6)\nrefers to the geometric center, only direct stiffness entries on the main diagonal are included.\nThe scalar entries K\u03b4x\u03b4x to KT represent mechanical elasticity and thermal heat conductivity of the respective machine component. Since these values depend on the conditions in each rolling contact inside the component, they are updated explicitly based on previous calculation results. In general, contact stiffness can be calculated analytically, with Hertzian theory [10], based on the relative positioning of the contact partners to each other. Furthermore, the equilibrium of external forces and internal contact forces of each roller element is calculated iteratively in each time step. In [11], respective analytic-numerical models for machine components like linear guideways, ball\nscrews and bearings were developed. Based on these existing models, the nonlinear behavior of the components is calculated apriori for different operatingpoints andprovided in tables. Explicitly calculated nonlinear stiffness of guideways can be expressed as follows:\nKct = f (\u0398 C t\u22121); \u0398 C t\u22121 = f (K c t\u22121, Ft\u22121,Tt\u22121). (7)\nOne spring element of seven DOFs connects two socalled condensation nodes of same dimension each. Thus, the resulting stiffnessmatrix describing onemachine component has the dimension 14 \u00d7 14 and the structure\nKC = [ K c \u2212Kc\n\u2212Kc Kc ] . (8)"
        },
        {
            "heading": "2.4 General assembly of the coupled system",
            "text": "Based on thermal and mechanical modeling of structural parts and machine components, the coupled system can be assembled. In this procedure, the following steps are performed: 1. Definition of boundary conditions (BC) and couplings\nbetween structural parts 2. Formulation of multi-point constraints (MCs) 3. Assembly of coupled system.\nIn step one, relevant machine components as couplings between structural parts are identified. For each coupling, an initial stiffness matrix and condensation nodes are set up. After that, multi-point constraints connect contact regions on structural parts with previously defined condensation nodes. For this purpose, an RBE3 formulation is used [6]. Based on the principle of virtual work, (9) represents the equations that couple seven DOFs of a condensation node with all N coupling nodes of the associated contact area of the structural part. The formulation formechanical energy used to couple structural DOFs is therefore expanded to an equivalent thermal formulation containing the heat flux Q\u0307 and temperatures T.\n[[\n[\nFc Mc\nQ\u0307c ]]\n]\n\u22c5 [[\n[\n\u0394c \u03d5c\nTc ]]\n]\n= N \u2211 n=1 ([ FPn Q\u0307Pn ] \u22c5 [ \u0394Pn TPn ]) . (9)\nFurthermore, condensation nodemomentsMC are put in equilibriumwithmoments coming from coupling forces FPn with corresponding lever arms \u0394 P n , expressed as the cross-product\nMC = N \u2211 n=1 (\u0394Pn \u00d7 F P n ). (10)\nIn matrix notation,\nLMC [ \u0394P\n\u0394C ] = 0 (11)\nprovides the connection of condensation and coupling DOFs.\nBased on this formulation, the global coupling matrix L for one structural part and one condensation node to be coupled can be assembled as follows:\nL = [[[[[\n[\nI 0 0 0\n0 I 0 0 0 0 \u2212LMC 0 0 0 0 I\n]]]]]\n]\n. (12)\nBy applying dual assembly based on theory of dynamic substructuring [12], the system represented by the uncoupled stiffness matrix K is coupled by multiplying with the matrix L from both sides. A priori,K is assembled by stacking the individual subsystems KPi and K C j diagonally,\nKcoupled = L TKL. (13)\nAlthough forces FC and moments MC of condensation nodes, as well as coupling forces FP, were added as additional DOFs to the system of equations, only respective condensation node forces andmoments remain, hereinafter referred to as Lagrange multiplier \u03bb. The overall vector of DOFs \u0398 now consist of structural part DOFs \u0398P, machine component DOFs \u0398C and Lagrange multiplier \u03bb,\n\u0398 = [[ [\n\u0398P \u0398C\n\u03bb\n]]\n]\n= [[[[[[[[[[[\n[\n\u0394P TP \u0394C \u03d5C TC\n\u03bb\n]]]]]]]]]]]\n]\n. (14)\nThe considered feed axis is composed of twoparts and four components. The coupled stiffness matrix is\nKcoupled = [[\n[\nKPi 0 KPiCj\n0 KCj \u2212I KPiCj \u2212I 0 ]]\n]\n. (15)\nFig. 4 shows the global stiffness matrix with its three different sub-blocks. The first, by far largest block represents part-DOFs with constant entries. The second block with condensation-DOFs contains variable entries that need to be updated every time step. However, this block"
        },
        {
            "heading": "2 parts 4 components + TCP Lagrange multiplier",
            "text": "only covers 56 DOFs while the assembled model has 340,034 DOFs in total (see Tab. 1). In addition, block three realizes the coupling of part and component blocks. For static assemblieswithout relativemotion, this block is also constant. In case of a relative motion, this block needs to be updated based on the current position of the feed axis. This could be achieved through the discretization of the rails of linear guideways into discrete sections. Then, for each section a multi-point constraint has to be modeled and the corresponding matrix LMC has to be set up. As a result, a coupling blockKPiCj containing connections to respective couplingnodes exists for each rail section andhas to be updated position-based within the model."
        },
        {
            "heading": "3 MOR for a coupled system with nonlinear subsystem",
            "text": "MOR aims at finding a low-dimensional surrogate model approximating the high-dimensional dynamical system, which, as in the case at hand, is often obtained by a spatial discretization, e. g. by FEM. Then, the reduced order model (ROM) replaces the original model in applications, where fast and repeated model evaluations are required, such as real-time predictions, optimization or control. In\nthe scope of this paper, the much smaller ROMs are utilized to speed up the thermo-mechanical simulation of a feed axis."
        },
        {
            "heading": "3.1 MOR for linear time-invariant (LTI) systems",
            "text": "We aim to separate the linear part of the above simulation model and reintegrate a much smaller surrogate into the coupled simulation.Hence, herewe consider the representation of a linear time-invariant (LTI) system in generalized state-space form\nEx\u0307(t) = Ax(t) + Bu(t), y(t) = Cx(t) + Du(t)\n(\u03a3)\nwith constant systemmatrices E,A \u2208 \u211dn\u00d7n, which describe the dynamics of the system, the input map B \u2208 \u211dn\u00d7m, the output map C \u2208 \u211dp\u00d7n and the feedthrough matrix D \u2208 \u211dp\u00d7m, respectively. The vector x \u2208 \u211dn denotes the state, which includes the DOFs in the considered model and the outputs y \u2208 \u211dp contain values in points of interest, like temperatures in sensor positions or the TCPdisplacement. The vector u together with the input map B describe the external influences on the system, e. g., in our case, the heat fluxes induced to the linear parts from the ambient temperature or the nonlinear components of the machine.\nThe goal of our projection-based MOR is the computation of truncation matrices V,W \u2208 \u211dn\u00d7r, which restricts the model to an r-dimensional subspace with r \u226a n, while the essential information on the input-to-output dynamics of the system is preserved. The ROM is of the form\nE\u0303 \u0307x\u0303(t) = A\u0303x\u0303(t) + B\u0303u(t), y\u0303(t) = C\u0303x\u0303(t) + Du(t)\n(\u03a3\u0303)\nwith the reduced matrices E\u0303 := WTEV, A\u0303 := WTAV, B\u0303 := WTB and C\u0303 := CV, the reduced state x\u0303(t) \u2208 \u211dr and the approximated outputs y\u0303(t) \u2248 y(t) \u2208 \u211dp. The output error ||y \u2212 y\u0303|| is required to be small in a suitable norm.\nThere are several well known MOR techniques for LTI systems (\u03a3), which differ in the way the truncation matrices V andW are determined. Besides the energy-based reductionmethods, like balanced truncation (BT), which we use to demonstrate our approach in this paper, also methods based on Krylov subspaces, e. g. moment matching techniques and rational interpolation, enjoy great popularity in the field of MOR. Another class of MOR methods are the training-based approaches, which rely on repeated\nsystem simulations, like proper orthogonal decomposition (POD) and reduced basis (RB) methods. More information on the various MOR techniques, especially concerning the basic principles, algorithms, stability and error estimation can be found in, e. g. [13, 14, 15, 16] and the references therein. In principle, all these methods could be used for the reduction of the linear part in our framework."
        },
        {
            "heading": "3.2 MOR for fixed relative positions",
            "text": "We consider the fixed pose in Fig. 5 of the feed axis model described in Section 2. In order to develop a strategy to compute a ROM for this system, we have to analyze, and make use of, the structure. After the spatial discretization by the FEM and the assembly of the coupled system (Section 2.4) we set\nx1 = \u0398 P , x2 = [\n\u0398C\n\u03bb ] ,\nA11 = \u2212K P , A12 = [0 \u2212KPC] ,\nA21 = [ 0 \u2212KPC ] , A22(x2) = [ f (x2) \u2212I \u2212I 0 ] ,\nto obtain the following coupled system \u03a3 in generalized state-space form\n[ E11 0 0 0 ] [ x\u03071 x\u03072 ] = [ A11 A12 A21 A22 ] [ x1 x2 ] + [ B1 B2 ] u,\ny = [C1 C2] [ x1 x2 ] .\n(16)\nThe system consists of a linear thermo-elastic part \u03a3lin of dimension n1, which is coupled to a nonlinear system \u03a3nl of dimension n2 through the couplingmatricesA12 andA21. A22 is the nonlinear subsystem consisting of the stiffness of each linear guide and respective condensation DOFs. Since A22 realizes the coupling of the structural machine parts, it is responsible for relative displacements and rotations of the rigid bodies, on the one hand, and heat exchange between the bodies, on the other hand. In consequence, the impact of flexible bodies is extended by the rigid body behavior. f (x2) \u2208 \u211d n2 2 \u00d7 n2 2 represents the nonlinear part of the stiffnessmatrix and equalsKCj in (15),which is dependent on theDOFs of themulti-point constraints x2. In the simulation this part has to be updated after every time step. Thereby for every component submatrix (one submatrix for each carriage) a factor is calculated, which depends on the difference between the displacementDOFs in x-direction of the respective carriage and a product specific parameter representing the linear guideways. Thematrix E11 consists of the heat capacity matrix in the thermal part and zeros in the elastic part, which is considered to be static (see Section 2), and thus E11 is singular.\nTo achieve an efficient reduction process, the linear andnonlinear parts of the systemare separated, in order to treat each with the most appropriate method. This is done by a decomposition of the coupling blocks A12 and A21 in the form A12 = BlinCnl and A21 = BnlClin, analogous to [17]. Both can be achieved by the (economy-size) singular value decomposition (SVD). For large sparse matrices, the required subset of singular values and vectors can be computed efficiently, by first determining the structural rank of the matrix and then running the sparse SVD with that number of desired values and vectors. Afterwards the system can be reformulated as an interconnected system [18] with an explicit coupling in the form of additional internal input matrices Blin,Bnl and output matrices Clin,Cnl:\n\u03a3lin : {{{{{{ {{{{{{ { E11x\u03071 = A11x1 + [B1 Blin] [ u ynl ] , [ y1 ylin ] = [ C1 Clin ] x1.\n(17a)\n\u03a3nl : {{{{{{ {{{{{{ {\n0 = A22(x2)x2 + [B2 Bnl] [ u ylin ] ,\n[ y2 ynl ] = [ C2 Cnl ] x2.\n(17b)\nFor systems with a large number of coupled DOFs it is recommended to use a low-rank approximation of the coupling blocks [17, Ch. 8], to keep the numbers of inputs and\noutputs small, compared to the original system dimension. Systems with many inputs and outputs may require special, numerically more expensive, MOR techniques, e. g. [19], introducing an additional outer approximation step, and consequently additional approximation errors. For a general overview of MOR for coupled dynamical systems, see e. g. [20].\nDue to the small dimension of the nonlinear subsystem compared to that of the linear one, we decided to reduce only the linear part and preserve the full nonlinear subsystem. In case the dimension of \u03a3nl gets too large, suitable techniques for the reduction of nonlinear systems can be found e. g. in [14, Sec. 3], [21] and the references therein.\nWith a grouping of the states by thermal and elastic degrees of freedom, xth = T and xel = [\u03b4x \u03b4y \u03b4z]T, and the combined input uel,th = [u ynl]T from external inputs u and internal inputs ynl from the nonlinear subsystem, we can write \u03a3lin as\n[ 0 0 0 Eth ] [ x\u0307el x\u0307th ] = [ Ael Ael,th 0 Ath ] [ xel xth ] + [ Bel Bth ] uel,th, (18)\nyel,th = Celxel + Cthxth, (19)\nwhere the subscripts el and th denote the parts of the elastic and the thermal system and thematrixAel,th represents the coupling of the temperature field xth in direction of the displacement field xel. Note that the influence of the deformation on the temperature field is considered negligible and, thus, set to the zero matrix 0.\nThis representation takes the form of a semi-explicit differential-algebraic equation (DAE) of index 1 [22, Ch. 5.1], andallows for an index-reductionas itwas applied to a thermo-elasticmachine tool assembly in [23]. From the first block-row of (18), we get\nxel = \u2212A \u22121 el Ael,thxth \u2212 A \u22121 el Beluel,th. (20)\nAt this point it has to be guaranteed that Ael has to be invertible, whichwill be addressed inmore detail in Sec. 3.3. Inserting (20) into the second block row and the output equation (19) leads to a representation of the same system dynamics by a set of ordinary differential equations together with an updated output equation\nEthx\u0307th = Athxth + Bthuel,th,\ny = Cel(\u2212A \u22121 el Ael,thxth \u2212 A \u22121 el Beluel,th) + Cthxth\n= (Cth \u2212 CelA \u22121 el Ael,th)xth \u2212 CelA \u22121 el Beluel,th. (21)\nNow defining E = Eth, A = Ath, x = xth, B = Bth, C = Cth\u2212CelA\u22121el Ael,th andD = \u2212CelA \u22121 el Bel,we receive a standard LTI state-space system (\u03a3). If both thermal and elastic\ndegrees of freedom use the same mesh and ansatz functions in the FE-formulation and for a three-dimensional problem, as in our case, the system dimension in (21) is already reduced to 14 of the state-dimension in (18), while the information of the elasticity system is completely captured in the output equation of (21). Note that for a twodimensional problem the system dimension would be reduced to 13 by the index-reduction. Now, we can further reduce (21), which represents the index-reduced formulation of the linear subsystem \u03a3lin in (17a), using standard MOR methods for LTI systems. Finally, the resulting ROM \u03a3\u0303lin is recombined with the nonlinear part \u03a3nl. Here, special attention has to be drawn to the structure of the new feedthrough matrix D, since it also contains parts including the artificial internal inputs and outputs, which have to be considered in the newly coupled system. The specific structure of D can be split into four parts containing the feedthrough for the coupled system, but also describes the influence of the inputs u on the nonlinear states, the interaction of the linear and nonlinear states, as well as the influence of the nonlinear states on the output:\nD = [ D1,ext D1,nl Dlin,ext Dlin,nl ] . (22)\nConsequently, a reduced coupled system of the form\n[ E\u030311 0 0 0 ] [ \u0307x\u03031 x\u03072 ] = [ A\u030311 B\u0303linCnl BnlC\u0303lin Aup ] [ x\u03031 x2 ] + [ B\u03031 Bup ] u,\ny\u0303 = [C\u03031 Cup] [ x\u03031 x2 ] + D1,extu\n(23)\nwith the updated matrices\nAup = A22(x2) + BnlDlin,nlCnl, Bup = B2 + BnlDlin,ext, Cup = C2 + D1,nlCnl\nis obtained."
        },
        {
            "heading": "3.3 Freed rigid body modes",
            "text": "An important fact, which has to be considered in the context of decoupling an interconnected system containing a mechanical part, is the problem of freed rigid bodymodes. In our case, the nonlinear part of the system represents the carriages, which connect the slide with the headstock. Thus, in the considered use case, decoupling the linear and nonlinear part of the system also leads to 6 rigid body modes in the headstock model.\nDue to zero eigenvalues, Ael is not invertible, but the invertibility is a prerequisit for the application of (20). In the following we want to discuss some strategies to tackle this problem.\nAn obvious idea is a change in the FE-model itself based on an additional fixing of the concerned assemblies. However, this could be disadvantageous due to an excessive stiffness in the FE-model and restrictions in the modeling process.\nA second possibility results from a numerical perturbation of the model, leading to a shift of the eigenvalues. We follow this strategy in the numerical experiments in this contribution. To this end, we introduce an \u03f5-perturbation of the form A\u0302el = Ael \u2212 \u03f5I in (18), analogous to [24], in our case using \u03f5 = 10\u22125. In that case we have to condone the loss of error bounds of the MOR method as a drawback.\nA third opportunity will be part of future investigations. Here a change from the stationary elasticity model to a dynamic second-order elasticity model including the massmatrix enables the treatment of the rigid bodymodes as part of MOR methods used in the context of elastic multibody simulation, see [25, 26]."
        },
        {
            "heading": "4 Numerical experiments",
            "text": "The model was established in ANSYS and the matrices needed for the representation (16) were exported for the nonlinear simulation and MOR in MATLAB\u00ae. The FE model consists of 340,034 DOFs, 20 inputs and 63 outputs. The simulated loadcase includes a nodal heat flux at TCP of 50W, a nodal heat flux of 20W at each carriage and rail, as well as a surface heat flux of 30Wm\u22122 on the slide, taking the effects of the z-motor into account. The decoupled and index-reduced system (21) was reduced with balanced truncation and the ROM was again coupled with the nonlinear part as described in (23). For the MOR of the linear part we used the BT implementation for large sparse systems, included in the open sourceMATLAB toolM-M.E.S.S. \u2014 the MATLAB Matrix Equation Sparse Solvers [27]. The truncation tolerance and thus the BT error bound was set to 10\u22122. With that tolerance we obtain a recoupled ROM of the form (23) with a reduced order of 207, inwhich the nonlinear part is of order 126. Consequently, the linear part of the model was reduced from 339,908 DOFs to 81 reduced DOFs. First we want to have a look at the reduction error for a completely linear simulation (A22 = const.) and afterwards with active nonlinearity (A22 = A22(x2)). Hence, we\ncan classify the errors resulting from the reduction process and from the nonlinearity.\nData and code availability All MATLAB codes for execution of the experiments reported here are available as a code package authored by J. Vettermann, J. Saak and A. Steinert [28]. The data matrices for a testmodel are provideddiffering in systemdimension and used parameters to the here presentedmodel and thus generating slightly different results."
        },
        {
            "heading": "4.1 Results",
            "text": "The generation of the ROM and all simulations have been executed on a compute server, whose hardware and software specifications are described in Tab. 2, at TU Chemnitz. Since we did not have exclusive access to the machine, timings beloware expected tobe representative, but mayhavebeenaffectedbyother computationson the same machine.\nFrom a physical point of view, relevant comparison variables are the relative x-displacement between shoes and rails of the linear guideways and the absolute z-displacement of the TCP. While the former effect has significant influence on the component stiffness and thus on the absolute displacement under static load, the latter effect directly affects the achievable working accuracy.\nWeobserve a very goodconformity between the results of the original full ordermodel (FOM) and the ROMboth in the linear andnonlinear case, as Fig. 6, 7 and8 showexemplary for the positionpictured in Fig. 5. The simulationwas executed with the implicit Euler method for a time span of 100 s with a constant time step size of 0.1 s, thus we have a total number of 1,000 time steps. The plots in Fig. 6 and 7 show the errors of the difference between the temperature DOFs as well as the displacement DOFs in x-direction of\nthe carriages. A good match of these displacement values is of particular importance, due to the fact, that the update of the nonlinear part of the system depends on them.With average relative displacement errors of order 10\u22122 and thus a reduction error smaller than the expected FE-modeling error, the model accuracy is preserved. We aim at a good approximation of the displacement and temperature results in the ROM at our point of interest \u2014 the TCP. A reliable approximation especially of the TCP displacement in the ROM is crucial for, e. g. real-time error correction of the thermally induced TCP error during themanufacturing process. As Fig. 8 shows, a very good reproduction of the FOM trajectory with the ROM simulation with a relative error of order 10\u22123 can be achieved for the z-displacement, the temperature results are even better with a relative error of order 10\u22124.\nIn Tab. 3 the order of the models as well as the times needed for the reduction and simulation process for the investigated simulation models are summarized. Note that we achieve a speedup of the simulation time in the fully linear case, for FOM and ROM, by the reuse of the LUdecomposition in the linear solver for the step, which is possible due to the linearity of the system and the use of\na constant time step size in the integration step. This explains the large difference between the simulation times for the FOM in the linear and nonlinear cases.\nWe see that the simulation of the ROM comes up with a formidable speedup of the simulation times compared to the FOM. Even in the case that just one simulation is required, the sum of the time needed for the reduction and simulation process of the ROM is smaller than one simulation cycle of the FOM. Furthermore, a comparison of the storage amount of the FOM and ROM might be an important fact, which plays a major role if a model has to be saved directly on the numerical control system of the machine tool.We cannot only observe a drastical reduction of the simulation time, but also of the memory requirements for the ROM.While the FOMneeds 212.81MB, the ROM just requires 0.23MB."
        },
        {
            "heading": "5 Conclusions",
            "text": "This contribution combines advanced modeling techniques to consider nonlinear component behavior in a classical FE-model and a MOR strategy tailored to the particular needs of the resulting differential-algebraic machine tool model with geometrically local nonlinearities. The numerical investigations showed a drastic reduction of the simulation times achieved by the use of a suitable ROM while preserving a certain model accuracy.\nIn a further step, an approach to handle the problem of relative movement and thus moving loads in the model will be investigated. For this task a switched system shall be compared to a formulation as a parameter-varying system, see e. g. [23, 29]. Furthermore, the ROM will be used\nas surrogate model in different use-cases, for example the computation of transient thermo-mechanical interactions affecting the life time of the feed axis, as well as computations for data driven approaches, e. g. the generation of training data for artificial neural networks.\nFunding: Funded by the German Research Foundation \u2013 Project-ID 174223256 \u2013 TRR 96."
        }
    ],
    "title": "Compact thermo-mechanical models for the fast simulation of machine tools with nonlinear component behavior",
    "year": 2022
}