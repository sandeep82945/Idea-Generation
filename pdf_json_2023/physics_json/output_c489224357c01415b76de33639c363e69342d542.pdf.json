{
    "abstractText": "Time-dependent density functional theory continues to draw a large number of users in a wide range of fields exploring myriad applications involving electronic spectra and dynamics. Although in principle exact, the predictivity of the calculations is limited by the available approximations for the exchange-correlation functional. In particular, it is known that the exact exchange-correlation functional has memory-dependence, but in practise adiabatic approximations are used which ignore this. Here we review the development of non-adiabatic functional approximations, their impact on calculations, and challenges in developing practical and accurate memory-dependent functionals for general purposes.",
    "authors": [
        {
            "affiliations": [],
            "name": "Lionel Lacombe"
        },
        {
            "affiliations": [],
            "name": "Neepa T. Maitra"
        }
    ],
    "id": "SP:fdad30ffd04ed4a2ab9dc596eb84e862e59e3f83",
    "references": [
        {
            "authors": [
                "E. Runge",
                "E.K.U. Gross"
            ],
            "title": "Density-functional theory for time-dependent systems",
            "venue": "Phys. Rev. Lett. 52,",
            "year": 1984
        },
        {
            "authors": [
                "C.A. Ullrich"
            ],
            "title": "Time-Dependent Density-Functional Theory: Concepts and Applications (Oxford",
            "year": 2011
        },
        {
            "authors": [
                "Maitra",
                "N.T. Perspective"
            ],
            "title": "Fundamental aspects of time-dependent density functional theory",
            "venue": "J. Chem. Phys. 144, 220901",
            "year": 2016
        },
        {
            "authors": [
                "X. Li",
                "N. Govind",
                "C. Isborn",
                "A.E. DePrince",
                "K. Lopata"
            ],
            "title": "Real-time time-dependent electronic structure theory",
            "venue": "Chem. Rev. 120,",
            "year": 2020
        },
        {
            "authors": [
                "C. Shepard",
                "R. Zhou",
                "D.C. Yost",
                "Y. Yao",
                "Y. Kanai"
            ],
            "title": "Simulating electronic excitation and dynamics with real-time propagation approach to tddft within planewave pseudopotential formulation",
            "venue": "J. Chem. Phys. 155,",
            "year": 2021
        },
        {
            "authors": [
                "O. Gunnarsson",
                "B.I. Lundqvist"
            ],
            "title": "Exchange and correlation in atoms, molecules, and solids by the spin-density-functional formalism",
            "venue": "Phys. Rev. B",
            "year": 1976
        },
        {
            "authors": [
                "A. G\u00f6rling"
            ],
            "title": "Density-functional theory beyond the hohenberg-kohn theorem",
            "venue": "Phys. Rev. A 59,",
            "year": 1999
        },
        {
            "authors": [
                "Theophilou",
                "A.K. The energy density functional formalism for excited states. J. Phys. C"
            ],
            "title": "Solid State Phys",
            "venue": "12, 5419",
            "year": 1979
        },
        {
            "authors": [
                "E.K.U. Gross",
                "L.N. Oliveira",
                "W. Kohn"
            ],
            "title": "Density-functional theory for ensembles of fractionally occupied states. I",
            "venue": "Basic formalism. Phys. Rev. A",
            "year": 1988
        },
        {
            "authors": [
                "E.K.U. Gross",
                "L.N. Oliveira",
                "W. Kohn"
            ],
            "title": "Rayleigh-ritz variational principle for ensembles of fractionally occupied states",
            "venue": "Phys. Rev. A",
            "year": 1988
        },
        {
            "authors": [
                "F. Cernatic",
                "B. Senjean",
                "V. Robert",
                "E. Fromager"
            ],
            "title": "Ensemble density functional theory of neutral and charged excitations",
            "venue": "Top. Curr. Chem. 380,",
            "year": 2021
        },
        {
            "authors": [
                "S.A. Sato"
            ],
            "title": "First-principles calculations for attosecond electron dynamics in solids",
            "venue": "Comput. Mater. Sci. 194,",
            "year": 2021
        },
        {
            "authors": [
                "R. Ullah",
                "E. Artacho",
                "A.A. Correa"
            ],
            "title": "Core electrons in the electronic stopping of heavy ions",
            "venue": "Phys. Rev. Lett. 121,",
            "year": 2018
        },
        {
            "authors": [
                "F Mauger"
            ],
            "title": "Charge migration and attosecond solitons in conjugated organic molecules",
            "venue": "Phys. Rev. Res",
            "year": 2022
        },
        {
            "authors": [
                "M. Jacobs",
                "J. Krumland",
                "C. Cocchi"
            ],
            "title": "Laser-controlled charge transfer in a twodimensional organic/inorganic optical coherent nanojunction",
            "venue": "ACS Appl. Nano Mater",
            "year": 2022
        },
        {
            "authors": [
                "I. Schelter",
                "S. K\u00fcmmel"
            ],
            "title": "Accurate evaluation of real-time density functional theory providing access to challenging electron dynamics",
            "venue": "J. Chem. Theory Comput",
            "year": 1910
        },
        {
            "authors": [
                "M.S. Mrudul",
                "N. Tancogne-Dejean",
                "A. Rubio",
                "G. Dixit"
            ],
            "title": "High-harmonic generation from spin-polarised defects in solids",
            "venue": "NPJ Comput. Mater. 6,",
            "year": 2020
        },
        {
            "authors": [
                "I Floss"
            ],
            "title": "Ab initio multiscale simulation of high-order harmonic generation in solids",
            "venue": "Phys. Rev. A 97,",
            "year": 2018
        },
        {
            "authors": [
                "S. Yamada",
                "M. Noda",
                "K. Nobusada",
                "K. Yabana"
            ],
            "title": "Time-dependent density functional theory for interaction of ultrashort light pulse with thin materials",
            "venue": "Phys. Rev. B",
            "year": 2018
        },
        {
            "authors": [
                "L. Bhan",
                "C. Covington",
                "K. Varga"
            ],
            "title": "Signatures of atomic structure in subfemtosecond laser-driven electron dynamics in nanogaps",
            "venue": "Phys. Rev. B 105,",
            "year": 2022
        },
        {
            "authors": [
                "P. Mai Dinh",
                "M. Vincendon",
                "J. Heraud",
                "E. Suraud",
                "Reinhard",
                "P.-G"
            ],
            "title": "Far off equilibrium dynamics in clusters and molecules",
            "venue": "Front. Phys. 8,",
            "year": 2020
        },
        {
            "authors": [
                "J.K. Dewhurst",
                "P. Elliott",
                "S. Shallcross",
                "E.K.U. Gross",
                "S. Sharma"
            ],
            "title": "Laser-induced intersite spin transfer",
            "venue": "Nano Lett. 18,",
            "year": 2018
        },
        {
            "authors": [
                "M Lucchini"
            ],
            "title": "Controlling floquet states on ultrashort time scales",
            "venue": "Nat. Commun",
            "year": 2022
        },
        {
            "authors": [
                "Draeger",
                "E. W"
            ],
            "title": "Massively parallel first-principles simulation of electron dynamics in materials",
            "venue": "J. Parallel Distrib. Comput. 106,",
            "year": 2017
        },
        {
            "authors": [
                "M.E. Casida"
            ],
            "title": "Time-dependent density functional response theory for molecules",
            "venue": "(World Scientific,",
            "year": 1995
        },
        {
            "authors": [
                "M. Petersilka",
                "U.J. Gossmann",
                "E.K.U. Gross"
            ],
            "title": "Excitation energies from timedependent density-functional theory",
            "venue": "Phys. Rev. Lett. 76,",
            "year": 1996
        },
        {
            "authors": [
                "T. Grabo",
                "M. Petersilka",
                "E. Gross"
            ],
            "title": "Molecular excitation energies from timedependent density functional theory",
            "venue": "J. Mol. Struct. THEOCHEM 501,",
            "year": 2000
        },
        {
            "authors": [
                "P. Huo",
                "D.F. Coker"
            ],
            "title": "Consistent schemes for non-adiabatic dynamics derived from partial linearized density matrix propagation",
            "venue": "J. Chem. Phys. 137,",
            "year": 2012
        },
        {
            "authors": [
                "C. Adamo",
                "D. Jacquemin"
            ],
            "title": "The calculations of excited-state properties with time-dependent density functional theory",
            "venue": "Chem. Soc. Rev. 42,",
            "year": 2013
        },
        {
            "authors": [
                "M.E. Casida",
                "T.A. Wesolowski"
            ],
            "title": "Generalization of the kohn-sham equations with constrained electron density formalism and its time-dependent response theory formulation",
            "venue": "Int. J. Quantum Chem. 96,",
            "year": 2004
        },
        {
            "authors": [
                "J. Neugebauer"
            ],
            "title": "Couplings between electronic transitions in a subsystem formulation of time-dependent density functional theory",
            "venue": "J. Chem. Phys. 126,",
            "year": 2007
        },
        {
            "authors": [
                "M. Pavanello"
            ],
            "title": "On the subsystem formulation of linear-response time-dependent dft",
            "venue": "J. Chem. Phys. 138,",
            "year": 2013
        },
        {
            "authors": [
                "J. T\u00f6lle",
                "M. B\u00f6ckers",
                "J. Neugebauer"
            ],
            "title": "Exact subsystem time-dependent densityfunctional theory",
            "venue": "J. Chem. Phys. 150,",
            "year": 2019
        },
        {
            "authors": [
                "C. Huang",
                "F. Libisch",
                "Q. Peng",
                "E.A. Carter"
            ],
            "title": "Time-dependent potential-functional embedding theory",
            "venue": "J. Chem. Phys. 140,",
            "year": 2014
        },
        {
            "authors": [
                "M.A. Mosquera",
                "D. Jensen",
                "A. Wasserman"
            ],
            "title": "Fragment-based time-dependent density functional theory",
            "venue": "Phys. Rev. Lett. 111,",
            "year": 2013
        },
        {
            "authors": [
                "R. Baer",
                "D. Neuhauser",
                "E. Rabani"
            ],
            "title": "Self-averaging stochastic kohn-sham densityfunctional theory",
            "venue": "Phys. Rev. Lett. 111,",
            "year": 2013
        },
        {
            "authors": [
                "X. Zhang",
                "G. Lu",
                "R. Baer",
                "E. Rabani",
                "D. Neuhauser"
            ],
            "title": "Linear-response timedependent density functional theory with stochastic range-separated hybrids",
            "venue": "J. Chem. Theory Comput. 16,",
            "year": 2020
        },
        {
            "authors": [
                "R. van Leeuwen"
            ],
            "title": "Mapping from densities to potentials in time-dependent density-functional theory",
            "venue": "Phys. Rev. Lett",
            "year": 1999
        },
        {
            "authors": [
                "M. Ruggenthaler",
                "M. Penz",
                "R. van Leeuwen"
            ],
            "title": "Existence, uniqueness, and construction of the density-potential mapping in time-dependent density-functional theory",
            "venue": "J. Phys. Condens. Matter",
            "year": 2015
        },
        {
            "authors": [
                "S. Fournais",
                "J. Lampart",
                "M. Lewin",
                "T.O. S\u00f8rensen"
            ],
            "title": "Coulomb potentials and Taylor expansions in time-dependent density-functional theory",
            "venue": "Phys. Rev. A",
            "year": 2016
        },
        {
            "authors": [
                "F. Wilken",
                "D. Bauer"
            ],
            "title": "Adiabatic approximation of the correlation function in the density-functional treatment of ionization processes",
            "venue": "Phys. Rev. Lett",
            "year": 2006
        },
        {
            "authors": [
                "F. Wilken",
                "Bauer",
                "D. Momentum distributions in time-dependent densityfunctional theory"
            ],
            "title": "product-phase approximation for nonsequential double ionization in strong laser fields",
            "venue": "Phys. Rev. A 76, 023409",
            "year": 2007
        },
        {
            "authors": [
                "N. Henkel",
                "M. Keim",
                "H.J. L\u00fcdde",
                "T. Kirchner"
            ],
            "title": "Density-functional-theory investigation of antiproton-helium collisions",
            "venue": "Phys. Rev. A 80,",
            "year": 2009
        },
        {
            "authors": [
                "D.J. Tozer",
                "N.C. Handy"
            ],
            "title": "On the determination of excitation energies using density functional theory",
            "venue": "Phys. Chem. Chem. Phys",
            "year": 2000
        },
        {
            "authors": [
                "R.J. Cave",
                "F. Zhang",
                "N.T. Maitra",
                "K. Burke"
            ],
            "title": "A dressed TDDFT treatment of the 21ag states of butadiene and hexatriene",
            "venue": "Chem. Phys. Lett. 389,",
            "year": 2004
        },
        {
            "authors": [
                "S. Raghunathan",
                "M. Nest"
            ],
            "title": "Critical examination of explicitly time-dependent density functional theory for coherent control of dipole switching",
            "venue": "J. Chem. Theory Comput",
            "year": 2011
        },
        {
            "authors": [
                "R. Ramakrishnan",
                "M. Nest"
            ],
            "title": "Control and analysis of single-determinant electron dynamics",
            "venue": "Phys. Rev. A 85,",
            "year": 2012
        },
        {
            "authors": [
                "S. Raghunathan",
                "M. Nest"
            ],
            "title": "The lack of resonance problem in coherent control with real-time time-dependent density functional theory",
            "venue": "J. Chem. Theory Comput",
            "year": 2012
        },
        {
            "authors": [
                "B.F. Habenicht",
                "N.P. Tani",
                "M.R. Provorse",
                "C.M. Isborn"
            ],
            "title": "Two-electron rabi oscillations in real-time time-dependent density-functional theory",
            "venue": "J. Chem. Phys. 141,",
            "year": 2014
        },
        {
            "authors": [
                "H.O. Wijewardane",
                "C.A. Ullrich"
            ],
            "title": "Real-time electron dynamics with exactexchange time-dependent density-functional theory",
            "venue": "Phys. Rev. Lett. 100,",
            "year": 2008
        },
        {
            "authors": [
                "Gao",
                "C.-Z",
                "P.M. Dinh",
                "Reinhard",
                "P.-G",
                "E. Suraud"
            ],
            "title": "Towards the analysis of attosecond dynamics in complex systems",
            "venue": "Phys. Chem. Chem. Phys. 19,",
            "year": 2017
        },
        {
            "authors": [
                "E.V. Bostr\u00f6m",
                "A. Mikkelsen",
                "C. Verdozzi",
                "E. Perfetto",
                "Stefanucci",
                "G. Charge separation in donor-c60 complexes with real-time green functions"
            ],
            "title": "the importance of nonlocal correlations",
            "venue": "Nano Lett. 18, 785",
            "year": 2018
        },
        {
            "authors": [
                "J. Krumland",
                "A.M. Valencia",
                "S. Pittalis",
                "C.A. Rozzi",
                "C. Cocchi"
            ],
            "title": "Understanding real-time time-dependent density-functional theory simulations of ultrafast laser-induced dynamics in organic molecules",
            "venue": "J. Chem. Phys. 153,",
            "year": 2020
        },
        {
            "authors": [
                "Gao",
                "C.-Z",
                "J. Wang",
                "F. Wang",
                "Zhang",
                "F.-S"
            ],
            "title": "Theoretical study on collision dynamics of h+ + ch4 at low energies",
            "venue": "J. Chem. Phys. 140,",
            "year": 2014
        },
        {
            "authors": [
                "B Da"
            ],
            "title": "Virtual substrate method for nanomaterials characterization",
            "venue": "Nat. Commun",
            "year": 2017
        },
        {
            "authors": [
                "S. Botti",
                "A. Schindlmayr",
                "R.D. Sole",
                "L. Reining"
            ],
            "title": "Time-dependent densityfunctional theory for extended systems",
            "venue": "Rep. Prog. Phys. 70,",
            "year": 2007
        },
        {
            "authors": [
                "N.T. Maitra"
            ],
            "title": "Charge transfer in time-dependent density functional theory",
            "venue": "J. Phys. Condens. Matter 29,",
            "year": 2017
        },
        {
            "authors": [
                "K\u00fcmmel",
                "S. Charge-transfer excitations"
            ],
            "title": "a challenge for time-dependent density functional theory that has been met",
            "venue": "Adv. Energy Mater. 7, 1700440",
            "year": 2017
        },
        {
            "authors": [
                "P. Hessler",
                "N.T. Maitra",
                "K. Burke"
            ],
            "title": "Correlation in time-dependent densityfunctional theory",
            "venue": "J. Chem. Phys. 117,",
            "year": 2002
        },
        {
            "authors": [
                "M. Thiele",
                "E.K.U. Gross",
                "S. K\u00fcmmel"
            ],
            "title": "Adiabatic approximation in nonperturbative time-dependent density-functional theory",
            "venue": "Phys. Rev. Lett. 100,",
            "year": 2008
        },
        {
            "authors": [
                "M. Thiele",
                "S. K\u00fcmmel"
            ],
            "title": "Photoabsorption spectra from adiabatically exact timedependent density-functional theory in real time",
            "venue": "Phys. Chem. Chem. Phys",
            "year": 2009
        },
        {
            "authors": [
                "R. Requist",
                "O. Pankratov"
            ],
            "title": "Adiabatic approximation in time-dependent reduced-density-matrix functional theory",
            "venue": "Phys. Rev. Lett. 81,",
            "year": 2010
        },
        {
            "authors": [
                "J.I. Fuks",
                "Maitra",
                "N.T. Challenging adiabatic time-dependent density functional theory with a Hubbard dimer"
            ],
            "title": "the case of time-resolved long-range charge transfer",
            "venue": "Phys. Chem. Chem. Phys. 16, 14504",
            "year": 2014
        },
        {
            "authors": [
                "J.I. Fuks",
                "Maitra",
                "N.T. Charge transfer in time-dependent density-functional theory"
            ],
            "title": "Insights from the asymmetric Hubbard dimer",
            "venue": "Phys. Rev. A 89, 062502",
            "year": 2014
        },
        {
            "authors": [
                "L. Lacombe",
                "N.T. Maitra"
            ],
            "title": "Density-matrix coupled time-dependent exchangecorrelation functional approximations",
            "venue": "J. Chem. Theory Comput",
            "year": 2019
        },
        {
            "authors": [
                "S.E.B. Nielsen",
                "M. Ruggenthaler",
                "R. van Leeuwen"
            ],
            "title": "Many-body quantum dynamics from the density",
            "venue": "EPL 101,",
            "year": 2013
        },
        {
            "authors": [
                "J.I. Fuks",
                "L. Lacombe",
                "S.E.B. Nielsen",
                "N.T. Maitra"
            ],
            "title": "Exploring non-adiabatic approximations to the exchange-correlation functional of TDDFT",
            "venue": "Phys. Chem. Chem. Phys. 20,",
            "year": 2018
        },
        {
            "authors": [
                "D.S. Jensen",
                "A. Wasserman"
            ],
            "title": "Numerical density-to-potential inversions in timedependent density functional theory",
            "venue": "Phys. Chem. Chem. Phys. 18,",
            "year": 2016
        },
        {
            "authors": [
                "J. Brown",
                "J. Yang",
                "J.D. Whitfield"
            ],
            "title": "Solver for the electronic v-representation problem of time-dependent density functional theory",
            "venue": "J. Chem. Theory Comput",
            "year": 2020
        },
        {
            "authors": [
                "P. Elliott",
                "J.I. Fuks",
                "A. Rubio",
                "N.T. Maitra"
            ],
            "title": "Universal dynamical steps in the exact time-dependent exchange-correlation potential",
            "venue": "Phys. Rev. Lett. 109,",
            "year": 2012
        },
        {
            "authors": [
                "J.I. Fuks",
                "P. Elliott",
                "A. Rubio",
                "N.T. Maitra"
            ],
            "title": "Dynamics of charge-transfer processes with time-dependent density functional theory",
            "venue": "J. Phys. Chem. Lett. 4,",
            "year": 2013
        },
        {
            "authors": [
                "Y. Suzuki",
                "L. Lacombe",
                "K. Watanabe",
                "N.T. Maitra"
            ],
            "title": "Exact time-dependent exchange-correlation potential in electron scattering processes",
            "venue": "Phys. Rev. Lett. 119,",
            "year": 2017
        },
        {
            "authors": [
                "D. Dar",
                "L. Lacombe",
                "J. Feist",
                "N.T. Maitra"
            ],
            "title": "Exact time-dependent densityfunctional theory for nonperturbative dynamics of the helium atom",
            "venue": "Phys. Rev. A 104,",
            "year": 2021
        },
        {
            "authors": [
                "D. Dar",
                "L. Lacombe",
                "Maitra",
                "N.T. The exact exchange-correlation potential in time-dependent density functional theory"
            ],
            "title": "choreographing electrons with steps and peaks",
            "venue": "Chem. Phys. Rev. 3, 031307",
            "year": 2022
        },
        {
            "authors": [
                "N.T. Maitra",
                "F. Zhang",
                "R.J. Cave",
                "K. Burke"
            ],
            "title": "Double excitations within timedependent density functional theory linear response",
            "venue": "J. Chem. Phys. 120,",
            "year": 2004
        },
        {
            "authors": [
                "G. Giuliani",
                "G. Vignale"
            ],
            "title": "Quantum Theory of the Electron Liquid (Cambridge",
            "year": 2005
        },
        {
            "authors": [
                "E. Gross",
                "N. Maitra"
            ],
            "title": "Introduction to TDDFT",
            "year": 2012
        },
        {
            "authors": [
                "D.R. Gulevich",
                "Y.V. Zhumagulov",
                "V.K. Kozin",
                "I.V. Tokatly"
            ],
            "title": "Excitonic effects in time-dependent density functional theory from zeros of the density response",
            "venue": "Phys. Rev. B 107,",
            "year": 2023
        },
        {
            "authors": [
                "M. Thiele",
                "S. K\u00fcmmel"
            ],
            "title": "Frequency dependence of the exact exchangecorrelation kernel of time-dependent density-functional theory",
            "venue": "Phys. Rev. Lett. 112,",
            "year": 2014
        },
        {
            "authors": [
                "M.T. Entwistle",
                "R.W. Godby"
            ],
            "title": "Exact exchange-correlation kernels for optical spectra of model systems",
            "venue": "Phys. Rev. B",
            "year": 2019
        },
        {
            "authors": [
                "N.D. Woods",
                "M.T. Entwistle",
                "R.W. Godby"
            ],
            "title": "Insights from exact exchangecorrelation kernels",
            "venue": "Phys. Rev. B 103,",
            "year": 2021
        },
        {
            "authors": [
                "D.J. Carrascal",
                "J. Ferrer",
                "J.C. Smith",
                "Burke",
                "K. The hubbard dimer"
            ],
            "title": "a density functional case study of a many-body problem",
            "venue": "J. Phys. Condens. Matter 27, 393001",
            "year": 2015
        },
        {
            "authors": [
                "R.M. Martin",
                "L. Reining",
                "Ceperley",
                "D.M. Interacting Electrons"
            ],
            "title": "Theory and Computational Approaches (Cambridge University Press, 2016)",
            "venue": "L. Lacombe and N.T. Maitra 12 npj Computational Materials",
            "year": 2023
        },
        {
            "authors": [
                "D.J. Carrascal",
                "J. Ferrer",
                "N. Maitra",
                "K. Burke"
            ],
            "title": "Linear response time-dependent density functional theory of the Hubbard dimer",
            "venue": "Eur. Phys. J. B 91,",
            "year": 2018
        },
        {
            "authors": [
                "R. Baer"
            ],
            "title": "On the mapping of time-dependent densities onto potentials in quantum mechanics",
            "venue": "J. Chem. Phys. 128,",
            "year": 2008
        },
        {
            "authors": [
                "Y. Li",
                "C.A. Ullrich"
            ],
            "title": "Time-dependent v-representability on lattice systems",
            "venue": "J. Chem. Phys. 129,",
            "year": 2008
        },
        {
            "authors": [
                "Verdozzi",
                "C. Time-dependent density-functional theory",
                "strongly correlated systems"
            ],
            "title": "insight from numerical studies",
            "venue": "Phys. Rev. Lett. 101, 166401",
            "year": 2008
        },
        {
            "authors": [
                "S. Kurth",
                "G. Stefanucci",
                "E. Khosravi",
                "C. Verdozzi",
                "E.K.U. Gross"
            ],
            "title": "Dynamical coulomb blockade and the derivative discontinuity of time-dependent density functional theory",
            "venue": "Phys. Rev. Lett. 104,",
            "year": 2010
        },
        {
            "authors": [
                "I.V. Tokatly"
            ],
            "title": "Time-dependent current density functional theory on a lattice",
            "venue": "Phys. Rev. B",
            "year": 2011
        },
        {
            "authors": [
                "Fuks",
                "J.I. et al. Time-dependent exchange-correlation functional for a hubbard dimer"
            ],
            "title": "quantifying nonadiabatic effects",
            "venue": "Phys. Rev. A 88, 062512",
            "year": 2013
        },
        {
            "authors": [
                "M. Farzanehpour",
                "I.V. Tokatly"
            ],
            "title": "Time-dependent density functional theory on a lattice",
            "venue": "Phys. Rev. B",
            "year": 2012
        },
        {
            "authors": [
                "P. Schmitteckert",
                "M. Dzierzawa",
                "P. Schwab"
            ],
            "title": "Exact time-dependent density functional theory for impurity models",
            "venue": "Phys. Chem. Chem. Phys. 15,",
            "year": 2013
        },
        {
            "authors": [
                "N. Dittmann",
                "J. Splettstoesser",
                "N. Helbig"
            ],
            "title": "Nonadiabatic dynamics in singleelectron tunneling devices with time-dependent density-functional theory",
            "venue": "Phys. Rev. Lett. 120,",
            "year": 2018
        },
        {
            "authors": [
                "S. Kurth",
                "Stefanucci",
                "G. Time-dependent i-dft exchange-correlation potentials with memory"
            ],
            "title": "applications to the out-of-equilibrium anderson model",
            "venue": "Eur. Phys. J. B 91, 118",
            "year": 2018
        },
        {
            "authors": [
                "A. Kartsev",
                "D. Karlsson",
                "A. Privitera",
                "C. Verdozzi"
            ],
            "title": "Three-dimensional dynamics of a fermionic mott wedding-cake in clean and disordered optical lattices",
            "venue": "Sci. Rep",
            "year": 2013
        },
        {
            "authors": [
                "L. Mancini",
                "J.D. Ramsden",
                "M.J.P. Hodgson",
                "R.W. Godby"
            ],
            "title": "Adiabatic and local approximations for the Kohn-Sham potential in time-dependent Hubbard chains",
            "venue": "Phys. Rev. B",
            "year": 2014
        },
        {
            "authors": [
                "V. Turkowski",
                "T.S. Rahman"
            ],
            "title": "Nonadiabatic time-dependent spin-density functional theory for strongly correlated systems",
            "venue": "J. Phys. Condens. Matter 26,",
            "year": 2014
        },
        {
            "authors": [
                "R. Requist",
                "O. Pankratov"
            ],
            "title": "Generalized Kohn-Sham system in one-matrix functional theory",
            "venue": "Phys. Rev. B",
            "year": 2008
        },
        {
            "authors": [
                "D.J. Carrascal",
                "J. Ferrer"
            ],
            "title": "Exact Kohn-Sham eigenstates versus quasiparticles in simple models of strongly correlated electrons",
            "venue": "Phys. Rev. B",
            "year": 2012
        },
        {
            "authors": [
                "J.I. Fuks",
                "K. Luo",
                "E.D. Sandoval",
                "Maitra",
                "N.T. Time-resolved spectroscopy in time-dependent density functional theory"
            ],
            "title": "an exact condition",
            "venue": "Phys. Rev. Lett. 114, 183002",
            "year": 2015
        },
        {
            "authors": [
                "K. Luo",
                "J.I. Fuks",
                "N.T. Maitra"
            ],
            "title": "Studies of spuriously shifting resonances in timedependent density functional theory",
            "venue": "J. Chem. Phys. 145,",
            "year": 2016
        },
        {
            "authors": [
                "L. Lacombe",
                "N.T. Maitra"
            ],
            "title": "Minimizing the time-dependent density functional error in ehrenfest dynamics",
            "venue": "J. Phys. Chem. Lett. 12,",
            "year": 2021
        },
        {
            "authors": [
                "L. Lacombe",
                "N.T. Maitra"
            ],
            "title": "Developing new and understanding old approximations in TDDFT",
            "venue": "Faraday Discuss. 224,",
            "year": 2020
        },
        {
            "authors": [
                "P. Elliott",
                "N.T. Maitra"
            ],
            "title": "Propagation of initially excited states in time-dependent density-functional theory",
            "venue": "Phys. Rev. A 85,",
            "year": 2012
        },
        {
            "authors": [
                "J.I. Fuks",
                "S. Nielsen",
                "M. Ruggenthaler",
                "N.T. Maitra"
            ],
            "title": "Time-dependent density functional theory beyond Kohn-Sham Slater determinants",
            "venue": "Phys. Chem. Chem. Phys. 18,",
            "year": 2016
        },
        {
            "authors": [
                "K. Luo",
                "J.I. Fuks",
                "E.D. Sandoval",
                "P. Elliott",
                "N.T. Maitra"
            ],
            "title": "Kinetic and interaction components of the exact time-dependent correlation potential",
            "venue": "J. Chem. Phys",
            "year": 2014
        },
        {
            "authors": [
                "L. Lacombe",
                "Y. Suzuki",
                "K. Watanabe",
                "N.T. Maitra"
            ],
            "title": "Electron scattering in timedependent density functional theory",
            "venue": "Eur. Phys. J. B 91,",
            "year": 2018
        },
        {
            "authors": [
                "L.O. Wagner",
                "Yang",
                "Z.-H",
                "K. Burke"
            ],
            "title": "Exact conditions and their relevance in TDDFT",
            "year": 2012
        },
        {
            "authors": [
                "E.K.U. Gross",
                "J.F. Dobson",
                "Petersilka",
                "M. Density functional theory of timedependent phenomena. In Density Functional Theory II"
            ],
            "title": "Relativistic and Time Dependent Extensions (ed",
            "venue": "Nalewajski, R. F.) 81\u2013172",
            "year": 1996
        },
        {
            "authors": [
                "J. Sun",
                "A. Ruzsinszky",
                "J.P. Perdew"
            ],
            "title": "Strongly constrained and appropriately normed semilocal density functional",
            "venue": "Phys. Rev. Lett. 115,",
            "year": 2015
        },
        {
            "authors": [
                "R. Pederson",
                "K. Burke"
            ],
            "title": "Reassessing the role of exact conditions in density functional theory",
            "year": 2023
        },
        {
            "authors": [
                "M. Mundt",
                "S. K\u00fcmmel",
                "R. van Leeuwen",
                "Reinhard",
                "P.-G"
            ],
            "title": "Violation of the zeroforce theorem in the time-dependent Krieger-Li-Iafrate approximation",
            "venue": "Phys. Rev. A 75,",
            "year": 2007
        },
        {
            "authors": [
                "H. Ou-Yang",
                "M. Levy"
            ],
            "title": "Theorem for exact local exchange potential",
            "venue": "Phys. Rev. Lett. 65,",
            "year": 1990
        },
        {
            "authors": [
                "G. Vignale"
            ],
            "title": "Sum rule for the linear density response of a driven electronic system",
            "venue": "Phys. Lett. A 209,",
            "year": 1995
        },
        {
            "authors": [
                "G. Vignale"
            ],
            "title": "Center of mass and relative motion in time dependent density functional theory",
            "venue": "Phys. Rev. Lett. 74,",
            "year": 1995
        },
        {
            "authors": [
                "Y. Kurzweil",
                "R. Baer"
            ],
            "title": "Adapting approximate-memory potentials for timedependent density functional theory",
            "venue": "Phys. Rev. B",
            "year": 2008
        },
        {
            "authors": [
                "J. Sun",
                "Lee",
                "C.-W",
                "A. Kononov",
                "A. Schleife",
                "C.A. Ullrich"
            ],
            "title": "Real-time exciton dynamics with time-dependent density-functional theory",
            "venue": "Phys. Rev. Lett. 127,",
            "year": 2021
        },
        {
            "authors": [
                "R. Van Leeuwen"
            ],
            "title": "Key concepts in time-dependent density-functional theory",
            "venue": "Int. J. Mod. Phys. B",
            "year": 1969
        },
        {
            "authors": [
                "R. D\u2019Agosta",
                "G. Vignale"
            ],
            "title": "Non-v-representability of currents in time-dependent many-particle systems",
            "venue": "Phys. Rev. B",
            "year": 2005
        },
        {
            "authors": [
                "N.T. Maitra",
                "K. Burke",
                "H. Appel",
                "E. Gross"
            ],
            "title": "Ten topical questions in timedependent density functional theory",
            "venue": "Rev. Mod. Quantum Chem",
            "year": 2002
        },
        {
            "authors": [
                "P. Schaffhauser",
                "S. K\u00fcmmel"
            ],
            "title": "Using time-dependent density functional theory in real time for calculating electronic transport",
            "venue": "Phys. Rev. B",
            "year": 2016
        },
        {
            "authors": [
                "M. Thiele",
                "S. K\u00fcmmel"
            ],
            "title": "Hydrodynamic perspective on memory in timedependent density-functional theory",
            "venue": "Phys. Rev. A 79,",
            "year": 2009
        },
        {
            "authors": [
                "G. Vignale",
                "Kohn",
                "W. Current-density functional theory of linear response to time-dependent electromagnetic fields. In Electronic Density Functional Theory"
            ],
            "title": "Recent Progress and New Directions (eds Dobson, J",
            "venue": "F., Vignale, G. & Das, M. P.) 199\u2013216",
            "year": 1998
        },
        {
            "authors": [
                "Dobson",
                "J.F. Harmonic-potential theorem"
            ],
            "title": "implications for approximate manybody theories",
            "venue": "Phys. Rev. Lett. 73, 2244",
            "year": 1994
        },
        {
            "authors": [
                "E.K.U. Gross",
                "W. Kohn"
            ],
            "title": "Local density-functional theory of frequencydependent linear response",
            "venue": "Phys. Rev. Lett. 55,",
            "year": 1985
        },
        {
            "authors": [
                "P. Hohenberg",
                "W. Kohn"
            ],
            "title": "Inhomogeneous electron gas",
            "venue": "Phys. Rev. 136,",
            "year": 1964
        },
        {
            "authors": [
                "E.K.U. Gross",
                "W. Kohn"
            ],
            "title": "Time-dependent density functional theory",
            "venue": "Adv. Quantum Chem. 21,",
            "year": 1990
        },
        {
            "authors": [
                "N. Iwamoto",
                "E.K.U. Gross"
            ],
            "title": "Correlation effects on the third-frequency-moment sum rule of electron liquids",
            "venue": "Phys. Rev. B",
            "year": 1987
        },
        {
            "authors": [
                "L.A. Constantin",
                "J.M. Pitarke"
            ],
            "title": "Simple dynamic exchange-correlation kernel of a uniform electron gas",
            "venue": "Phys. Rev. B",
            "year": 2007
        },
        {
            "authors": [
                "C.F. Richardson",
                "N.W. Ashcroft"
            ],
            "title": "Dynamical local-field factors and effective interactions in the three-dimensional electron liquid",
            "venue": "Phys. Rev. B",
            "year": 1994
        },
        {
            "authors": [
                "M. Corradini",
                "R. Del Sole",
                "G. Onida",
                "M. Palummo"
            ],
            "title": "Analytical expressions for the local-field factor g(q) and the exchange-correlation kernel Kxc(r) of the homogeneous electron gas",
            "venue": "Phys. Rev. B",
            "year": 1998
        },
        {
            "authors": [
                "B. Dabrowski"
            ],
            "title": "Dynamical local-field factor in the response function of an electron gas",
            "venue": "Phys. Rev. B",
            "year": 1986
        },
        {
            "authors": [
                "A. Ruzsinszky",
                "N.K. Nepal",
                "J.M. Pitarke",
                "J.P. Perdew"
            ],
            "title": "Constraint-based wave vector and frequency dependent exchange-correlation kernel of the uniform electron gas",
            "venue": "Phys. Rev. B 101,",
            "year": 2020
        },
        {
            "authors": [
                "A.D. Kaplan",
                "N.K. Nepal",
                "A. Ruzsinszky",
                "P. Ballone",
                "J.P. Perdew"
            ],
            "title": "Firstprinciples wave-vector- and frequency-dependent exchange-correlation kernel for jellium at all densities",
            "venue": "Phys. Rev. B 105,",
            "year": 2022
        },
        {
            "authors": [
                "G. Onida",
                "L. Reining",
                "Rubio",
                "A. Electronic excitations"
            ],
            "title": "density-functional versus many-body green\u2019s-function approaches",
            "venue": "Rev. Mod. Phys. 74, 601",
            "year": 2002
        },
        {
            "authors": [
                "M. Panholzer",
                "M. Gatti",
                "Reining",
                "L. Nonlocal",
                "nonadiabatic effects in the charge-density response of solids"
            ],
            "title": "a time-dependent density-functional approach",
            "venue": "Phys. Rev. Lett. 120, 166402",
            "year": 2018
        },
        {
            "authors": [
                "K. Burke"
            ],
            "title": "Perspective on density functional theory",
            "venue": "J. Chem. Phys. 136,",
            "year": 2012
        },
        {
            "authors": [
                "J.P. Perdew",
                "S. Kurth"
            ],
            "title": "Density functionals for non-relativistic coulomb systems in the new century",
            "venue": "In A Primer in Density Functional Theory (eds Fiolhais,",
            "year": 2003
        },
        {
            "authors": [
                "G. Vignale"
            ],
            "title": "Time-dependent current density functional theory. In Fundamentals of Time-Dependent Density Functional Theory",
            "year": 2012
        },
        {
            "authors": [
                "J.F. Dobson",
                "M.J. B\u00fcnner",
                "Gross",
                "E.K.U. Time-dependent density functional theory beyond linear response"
            ],
            "title": "an exchange-correlation potential with memory",
            "venue": "Phys. Rev. Lett. 79, 1905",
            "year": 1997
        },
        {
            "authors": [
                "G. Vignale",
                "W. Kohn"
            ],
            "title": "Current-dependent exchange-correlation potential for dynamical linear response theory",
            "venue": "Phys. Rev. Lett. 77,",
            "year": 1996
        },
        {
            "authors": [
                "G. Vignale",
                "C.A. Ullrich",
                "S. Conti"
            ],
            "title": "Time-dependent density functional theory beyond the adiabatic local density approximation",
            "venue": "Phys. Rev. Lett",
            "year": 1997
        },
        {
            "authors": [
                "S.K. Ghosh",
                "A.K. Dhara"
            ],
            "title": "Density-functional theory of many-electron systems subjected to time-dependent electric and magnetic fields",
            "venue": "Phys. Rev. A 38,",
            "year": 1988
        },
        {
            "authors": [
                "G. Vignale"
            ],
            "title": "Mapping from current densities to vector potentials in timedependent current density functional theory",
            "venue": "Phys. Rev. B",
            "year": 2004
        },
        {
            "authors": [
                "Z. Qian",
                "G. Vignale"
            ],
            "title": "Dynamical exchange-correlation potentials for an electron liquid",
            "venue": "Phys. Rev. B",
            "year": 2002
        },
        {
            "authors": [
                "R. Nifos\u00ed",
                "S. Conti",
                "M.P. Tosi"
            ],
            "title": "Dynamic exchange-correlation potentials for the electron gas in dimensionality d= 3 and d= 2",
            "venue": "Phys. Rev. B",
            "year": 1998
        },
        {
            "authors": [
                "S. Conti",
                "R. Nifos\u00ed",
                "M.P. Tosi"
            ],
            "title": "The exchange-correlation potential for currentdensity functional theory of frequency-dependent linear response",
            "venue": "J. Phys. Condens. Matter 9,",
            "year": 1997
        },
        {
            "authors": [
                "S. Conti",
                "G. Vignale"
            ],
            "title": "Elasticity of an electron liquid",
            "venue": "Phys. Rev. B",
            "year": 1999
        },
        {
            "authors": [
                "J. Tao",
                "G. Vignale"
            ],
            "title": "Time-dependent density-functional theory beyond the local-density approximation",
            "venue": "Phys. Rev. Lett. 97,",
            "year": 2006
        },
        {
            "authors": [
                "J. Tao",
                "G. Vignale",
                "Tokatly",
                "I.V. Time-dependent density functional theory"
            ],
            "title": "derivation of gradient-corrected dynamical exchange-correlational potentials",
            "venue": "Phys. Rev. B 76, 195126",
            "year": 2007
        },
        {
            "authors": [
                "C.A. Ullrich",
                "Vignale",
                "G. Linewidths of collective excitations of the inhomogeneous electron gas"
            ],
            "title": "application to two-dimensional quantum strips",
            "venue": "Phys. Rev. B 58, 7141",
            "year": 1998
        },
        {
            "authors": [
                "C.A. Ullrich",
                "Vignale",
                "G. Collective intersubband transitions in quantum wells"
            ],
            "title": "a comparative density-functional study",
            "venue": "Phys. Rev. B 58, 15756",
            "year": 1998
        },
        {
            "authors": [
                "C.A. Ullrich",
                "G. Vignale"
            ],
            "title": "Theory of the linewidth of intersubband plasmons in quantum wells",
            "venue": "Phys. Rev. Lett. 87,",
            "year": 2001
        },
        {
            "authors": [
                "R. D\u2019Agosta",
                "G. Vignale"
            ],
            "title": "Relaxation in time-dependent current-densityfunctional theory",
            "venue": "Phys. Rev. Lett. 96,",
            "year": 2006
        },
        {
            "authors": [
                "Ullrich",
                "C.A. Time-dependent density-functional theory beyond the adiabatic approximation"
            ],
            "title": "insights from a two-electron model system",
            "venue": "J. Chem. Phys. 125, 234108",
            "year": 2006
        },
        {
            "authors": [
                "V.U. Nazarov",
                "J.M. Pitarke",
                "Y. Takada",
                "G. Vignale",
                "Chang",
                "Y.-C. Including nonlocality in the exchange-correlation kernel from time-dependent current density functional theory"
            ],
            "title": "application to the stopping power of electron liquids",
            "venue": "Phys. Rev. B 76, 205103",
            "year": 2007
        },
        {
            "authors": [
                "I. D\u2019Amico",
                "C.A. Ullrich"
            ],
            "title": "Dissipation through spin coulomb drag in electronic spin transport and optical excitations",
            "venue": "Phys. Rev. B",
            "year": 2006
        },
        {
            "authors": [
                "M. van Faassen",
                "P.L. de Boeij",
                "R. van Leeuwen",
                "J.A. Berger",
                "Snijders",
                "J.G. Ultranonlocality in time-dependent current-density-functional theory"
            ],
            "title": "application to conjugated polymers",
            "venue": "Phys. Rev. Lett. 88, 186401",
            "year": 2002
        },
        {
            "authors": [
                "M. van Faassen",
                "P.L. de Boeij",
                "R. van Leeuwen",
                "J.A. Berger",
                "J.G. Snijders"
            ],
            "title": "Application of time-dependent current-density-functional theory to nonlocal exchange-correlation effects in polymers",
            "venue": "J. Chem. Phys. 118,",
            "year": 2003
        },
        {
            "authors": [
                "C.A. Ullrich",
                "K. Burke"
            ],
            "title": "Excitation energies from time-dependent densityfunctional theory beyond the adiabatic approximation",
            "venue": "J. Chem. Phys. 121,",
            "year": 2004
        },
        {
            "authors": [
                "P.L. de Boeij",
                "F. Kootstra",
                "J.A. Berger",
                "R. van Leeuwen",
                "Snijders",
                "J.G. Current density functional theory for optical spectra"
            ],
            "title": "a polarization functional",
            "venue": "J. Chem. Phys. 115, 1995",
            "year": 2001
        },
        {
            "authors": [
                "J.A. Berger",
                "P.L. de Boeij",
                "R. van Leeuwen"
            ],
            "title": "Analysis of the Vignale-Kohn current functional in the calculation of the optical spectra of semiconductors",
            "venue": "Phys. Rev. B",
            "year": 2007
        },
        {
            "authors": [
                "J.A. Berger"
            ],
            "title": "Fully parameter-free calculation of optical spectra for insulators, semiconductors, and metals from a simple polarization functional",
            "venue": "Phys. Rev. Lett. 115,",
            "year": 2015
        },
        {
            "authors": [
                "H.O. Wijewardane",
                "C.A. Ullrich"
            ],
            "title": "Time-dependent Kohn-Sham theory with memory",
            "venue": "Phys. Rev. Lett. 95,",
            "year": 2005
        },
        {
            "authors": [
                "I.V. Tokatly",
                "Pankratov",
                "O. Local exchange-correlation vector potential with memory in time-dependent density functional theory"
            ],
            "title": "the generalized hydrodynamics approach",
            "venue": "Phys. Rev. B 67, 201103",
            "year": 2003
        },
        {
            "authors": [
                "Y. Kurzweil",
                "R. Baer"
            ],
            "title": "Quantum memory effects in the dynamics of electrons in gold",
            "venue": "clusters. Phys. Rev. B",
            "year": 2006
        },
        {
            "authors": [
                "R. van Leeuwen"
            ],
            "title": "Causality and symmetry in time-dependent density-functional theory",
            "venue": "Phys. Rev. Lett. 80,",
            "year": 1998
        },
        {
            "authors": [
                "I.V. Tokatly"
            ],
            "title": "Time-dependent deformation functional theory",
            "venue": "Phys. Rev. B 75,",
            "year": 2007
        },
        {
            "authors": [
                "G. Vignale"
            ],
            "title": "Real-time resolution of the causality paradox of time-dependent density-functional theory",
            "venue": "Phys. Rev. A 77,",
            "year": 2008
        },
        {
            "authors": [
                "Y. Kurzweil",
                "R. Baer"
            ],
            "title": "Time-dependent exchange-correlation current density functionals with memory",
            "venue": "J. Chem. Phys. 121,",
            "year": 2004
        },
        {
            "authors": [
                "Tokatly",
                "I.V. Quantum many-body dynamics in a Lagrangian frame"
            ],
            "title": "I",
            "venue": "Equations of motion and conservation laws. Phys. Rev. B 71, 165104",
            "year": 2005
        },
        {
            "authors": [
                "Tokatly",
                "I.V. Quantum many-body dynamics in a Lagrangian frame"
            ],
            "title": "II",
            "venue": "Geometric formulation of time-dependent density functional theory. Phys. Rev. B 71, 165105",
            "year": 2005
        },
        {
            "authors": [
                "I.V. Tokatly"
            ],
            "title": "Time-dependent deformation functional theory. In Fundamentals of Time-Dependent Density Functional Theory",
            "year": 2012
        },
        {
            "authors": [
                "C.A. Ullrich",
                "I.V. Tokatly"
            ],
            "title": "Nonadiabatic electron dynamics in time-dependent density-functional theory",
            "venue": "Phys. Rev. B",
            "year": 2006
        },
        {
            "authors": [
                "V.U. Nazarov",
                "I.V. Tokatly",
                "S. Pittalis",
                "G. Vignale"
            ],
            "title": "Antiadiabatic limit of the exchange-correlation kernels of an inhomogeneous electron gas",
            "venue": "Phys. Rev. B",
            "year": 2010
        },
        {
            "authors": [
                "J. Tao",
                "X. Gao",
                "G. Vignale",
                "I.V. Tokatly"
            ],
            "title": "Linear continuum mechanics for quantum many-body systems",
            "venue": "Phys. Rev. Lett. 103,",
            "year": 2009
        },
        {
            "authors": [
                "X. Gao",
                "J. Tao",
                "G. Vignale",
                "Tokatly",
                "I.V. Continuum mechanics for quantum many-body systems"
            ],
            "title": "linear response regime",
            "venue": "Phys. Rev. B 81, 195106",
            "year": 2010
        },
        {
            "authors": [
                "T. Gould",
                "G. Jansen",
                "I.V. Tokatly",
                "J.F. Dobson"
            ],
            "title": "Quantum continuum mechanics made simple",
            "venue": "J. Chem. Phys. 136,",
            "year": 2012
        },
        {
            "authors": [
                "A. Wasserman",
                "N.T. Maitra",
                "K. Burke"
            ],
            "title": "Accurate Rydberg excitations from the local density approximation",
            "venue": "Phys. Rev. Lett. 91,",
            "year": 2003
        },
        {
            "authors": [
                "M. Hellgren",
                "E.K.U. Gross"
            ],
            "title": "Effect of discontinuities in Kohn-Sham-based chemical reactivity theory",
            "venue": "J. Chem. Phys. 136,",
            "year": 2012
        },
        {
            "authors": [
                "C.A. Ullrich",
                "U.J. Gossmann",
                "E.K.U. Gross"
            ],
            "title": "Time-dependent optimized effective potential",
            "venue": "Phys. Rev. Lett. 74,",
            "year": 1995
        },
        {
            "authors": [
                "A. G\u00f6rling"
            ],
            "title": "Time-dependent Kohn-Sham formalism",
            "venue": "Phys. Rev. A 55,",
            "year": 1997
        },
        {
            "authors": [
                "A. G\u00f6rling"
            ],
            "title": "Exact exchange-correlation kernel for dynamic response properties and excitation energies in density-functional theory",
            "venue": "Phys. Rev. A",
            "year": 1998
        },
        {
            "authors": [
                "M. Hellgren",
                "U. von Barth"
            ],
            "title": "Linear density response function within the timedependent exact-exchange approximation",
            "venue": "Phys. Rev. B",
            "year": 2008
        },
        {
            "authors": [
                "M. Hellgren",
                "von Barth",
                "U. Exact-exchange kernel of time-dependent density functional theory"
            ],
            "title": "frequency dependence and photoabsorption spectra of atoms",
            "venue": "J. Chem. Phys. 131, 044110",
            "year": 2009
        },
        {
            "authors": [
                "A. He\u00dfelmann",
                "A. Ipatov",
                "A. G\u00f6rling"
            ],
            "title": "Charge-transfer excitation energies with a time-dependent density-functional method suitable for orbital-dependent exchange-correlation kernels",
            "venue": "Phys. Rev. A 80,",
            "year": 2009
        },
        {
            "authors": [
                "M. Hellgren",
                "Gross",
                "E.K.U. Discontinuous functional for linear-response timedependent density-functional theory"
            ],
            "title": "the exact-exchange kernel and approximate forms",
            "venue": "Phys. Rev. A 88, 052507",
            "year": 2013
        },
        {
            "authors": [
                "N.T. Maitra"
            ],
            "title": "Double and charge-transfer excitations in time-dependent density functional theory",
            "venue": "Annu. Rev. Phys. Chem. 73,",
            "year": 2022
        },
        {
            "authors": [
                "J.P. Perdew"
            ],
            "title": "Size-consistency, self-interaction correction, and derivative discontinuity in density functional theory",
            "venue": "Adv. Quantum Chem. 21,",
            "year": 1990
        },
        {
            "authors": [
                "D. Hofmann",
                "T. K\u00f6rzd\u00f6rfer",
                "S. K\u00fcmmel"
            ],
            "title": "Kohn-Sham self-interaction correction in real time",
            "venue": "Phys. Rev. Lett. 108,",
            "year": 2012
        },
        {
            "authors": [
                "A. Seidl",
                "A. G\u00f6rling",
                "P. Vogl",
                "J.A. Majewski",
                "M. Levy"
            ],
            "title": "Generalized Kohn-Sham schemes and the band-gap problem",
            "venue": "Phys. Rev. B",
            "year": 1996
        },
        {
            "authors": [
                "A. G\u00f6rling",
                "Levy",
                "M. Hybrid schemes combining the Hartree-Fock method",
                "density-functional theory"
            ],
            "title": "underlying formalism and properties of correlation functionals",
            "venue": "J. Chem. Phys. 106, 2675",
            "year": 1997
        },
        {
            "authors": [
                "R. Garrick",
                "A. Natan",
                "T. Gould",
                "L. Kronik"
            ],
            "title": "Exact generalized Kohn-Sham theory for hybrid functionals",
            "venue": "Phys. Rev. X 10,",
            "year": 2020
        },
        {
            "authors": [
                "W. Yang",
                "A.J. Cohen",
                "P. Mori-S\u00e1nchez"
            ],
            "title": "Derivative discontinuity, bandgap and lowest unoccupied molecular orbital in density functional theory",
            "venue": "J. Chem. Phys. 136,",
            "year": 2012
        },
        {
            "authors": [
                "R. Baer",
                "E. Livshits",
                "U. Salzner"
            ],
            "title": "Tuned range-separated hybrids in density functional theory",
            "venue": "Ann. Rev. Phys. Chem. 61,",
            "year": 2010
        },
        {
            "authors": [
                "L. Kronik",
                "T. Stein",
                "S. Refaely-Abramson",
                "R. Baer"
            ],
            "title": "Excitation gaps of finite-sized systems from optimally tuned range-separated hybrid functionals",
            "venue": "J. Chem. Theory Comput",
            "year": 2012
        },
        {
            "authors": [
                "T. Stein",
                "L. Kronik",
                "R. Baer"
            ],
            "title": "Reliable prediction of charge transfer excitations in molecular complexes using time-dependent density functional theory",
            "venue": "J. Am. Chem",
            "year": 2009
        },
        {
            "authors": [
                "T. K\u00f6rzd\u00f6rfer",
                "Br\u00e9das",
                "J.-L. Organic electronic materials"
            ],
            "title": "recent advances in the DFT description of the ground and excited states using tuned range-separated hybrid functionals",
            "venue": "Acc. Chem. Res. 47, 3284",
            "year": 2014
        },
        {
            "authors": [
                "A. Karolewski",
                "L. Kronik",
                "K\u00fcmmel",
                "S. Using optimally tuned range separated hybrid functionals in ground-state calculations"
            ],
            "title": "consequences and caveats",
            "venue": "J. Chem. Phys. 138, 204115",
            "year": 2013
        },
        {
            "authors": [
                "K\u00fcmmel",
                "S. Charge-transfer excitations"
            ],
            "title": "a challenge for time-dependent density functional theory that has been met",
            "venue": "Adv. Energy Mater. 7, 1700440",
            "year": 2017
        },
        {
            "authors": [
                "Maitra",
                "N.T. Undoing static correlation"
            ],
            "title": "long-range charge transfer in timedependent density-functional theory",
            "venue": "J. Chem. Phys. 122, 234104",
            "year": 2005
        },
        {
            "authors": [
                "Liao",
                "S.-L",
                "Ho",
                "T.-S",
                "H. Rabitz",
                "Chu",
                "S.-I"
            ],
            "title": "Time-local equation for the exact optimized effective potential in time-dependent density functional theory",
            "venue": "Phys. Rev. Lett. 118,",
            "year": 2017
        },
        {
            "authors": [
                "Liao",
                "S.-L",
                "Ho",
                "T.-S",
                "H. Rabitz",
                "Chu",
                "S.-I"
            ],
            "title": "Exact-exchange optimized effective potential and memory effect in time-dependent density functional theory",
            "venue": "Eur. Phys. J. B 91,",
            "year": 2018
        },
        {
            "authors": [
                "J.B. Krieger",
                "Y. Li",
                "Iafrate",
                "G.J. Systematic approximations to the optimized effective potential"
            ],
            "title": "application to orbital-density-functional theory",
            "venue": "Phys. Rev. A 46, 5453",
            "year": 1992
        },
        {
            "authors": [
                "C.A. Ullrich",
                "Reinhard",
                "P.-G.",
                "Suraud",
                "E. Electron dynamics in strongly excited sodium clusters"
            ],
            "title": "a density-functional study with self-interaction correction",
            "venue": "J. Phys. B Mol. Opt. Phys. 31, 1871",
            "year": 1998
        },
        {
            "authors": [
                "J. Heslar",
                "D.A. Telnov",
                "Chu",
                "S.-I"
            ],
            "title": "Time-dependent density-functional theory with optimized effective potential and self-interaction correction and derivative L",
            "venue": "Lacombe and N.T. Maitra 14 npj Computational Materials",
            "year": 2013
        },
        {
            "authors": [
                "R. van Leeuwen"
            ],
            "title": "The Sham-Schl\u00fcter equation in time-dependent density-functional theory",
            "venue": "Phys. Rev. Lett",
            "year": 1996
        },
        {
            "authors": [
                "L.J. Sham",
                "M. Schl\u00fcter"
            ],
            "title": "Density-functional theory of the energy gap",
            "venue": "Phys. Rev. Lett. 51,",
            "year": 1983
        },
        {
            "authors": [
                "L.J. Sham"
            ],
            "title": "Exchange and correlation in density-functional theory",
            "venue": "Phys. Rev. B 32,",
            "year": 1985
        },
        {
            "authors": [
                "I.V. Tokatly",
                "Pankratov",
                "O. Many-body diagrammatic expansion in a KohnSham basis"
            ],
            "title": "implications for time-dependent density functional theory of excited states",
            "venue": "Phys. Rev. Lett. 86, 2078",
            "year": 2001
        },
        {
            "authors": [
                "G. Baym"
            ],
            "title": "Self-consistent approximations in many-body systems",
            "venue": "Phys. Rev. 127,",
            "year": 1962
        },
        {
            "authors": [
                "G. Baym",
                "L.P. Kadanoff"
            ],
            "title": "Conservation laws and correlation functions",
            "venue": "Phys. Rev. 124,",
            "year": 1961
        },
        {
            "authors": [
                "U. von Barth",
                "N.E. Dahlen",
                "R. van Leeuwen",
                "G. Stefanucci"
            ],
            "title": "Conserving approximations in time-dependent density functional theory",
            "venue": "Phys. Rev. B",
            "year": 2005
        },
        {
            "authors": [
                "R. Stubner",
                "I.V. Tokatly",
                "Pankratov",
                "O. Excitonic effects in time-dependent density-functional theory"
            ],
            "title": "an analytically solvable model",
            "venue": "Phys. Rev. B 70, 245119",
            "year": 2004
        },
        {
            "authors": [
                "F. Bruneval",
                "F. Sottile",
                "V. Olevano",
                "R. Del Sole",
                "Reining",
                "L. Many-body perturbation theory using the density-functional concept"
            ],
            "title": "beyond the gw approximation",
            "venue": "Phys. Rev. Lett. 94, 186402",
            "year": 2005
        },
        {
            "authors": [
                "L. Reining",
                "V. Olevano",
                "A. Rubio",
                "G. Onida"
            ],
            "title": "Excitonic effects in solids described by time-dependent density-functional theory",
            "venue": "Phys. Rev. Lett. 88,",
            "year": 2002
        },
        {
            "authors": [
                "F. Sottile",
                "V. Olevano",
                "L. Reining"
            ],
            "title": "Parameter-free calculation of response functions in time-dependent density-functional theory",
            "venue": "Phys. Rev. Lett. 91,",
            "year": 2003
        },
        {
            "authors": [
                "G. Adragna",
                "R. Del Sole",
                "A. Marini"
            ],
            "title": "Ab initio calculation of the exchangecorrelation kernel in extended systems",
            "venue": "Phys. Rev. B",
            "year": 2003
        },
        {
            "authors": [
                "A. Marini",
                "R. Del Sole",
                "Rubio",
                "A. Bound excitons in time-dependent densityfunctional theory"
            ],
            "title": "optical and energy-loss spectra",
            "venue": "Phys. Rev. Lett. 91, 256402",
            "year": 2003
        },
        {
            "authors": [
                "M. Gatti",
                "V. Olevano",
                "L. Reining",
                "Tokatly",
                "I.V. Transforming nonlocality into a frequency dependence"
            ],
            "title": "a shortcut to spectroscopy",
            "venue": "Phys. Rev. Lett. 99, 057401",
            "year": 2007
        },
        {
            "authors": [
                "S. Cavo",
                "J.A. Berger",
                "P. Romaniello"
            ],
            "title": "Accurate optical spectra of solids from pure time-dependent density functional theory",
            "venue": "Phys. Rev. B 101,",
            "year": 2020
        },
        {
            "authors": [
                "M. Ruggenthaler",
                "D. Bauer"
            ],
            "title": "Local Hartree-exchange and correlation potential defined by local force equations",
            "venue": "Phys. Rev. A 80,",
            "year": 2009
        },
        {
            "authors": [
                "J.D. Ramsden",
                "R.W. Godby"
            ],
            "title": "Exact density-functional potentials for timedependent quasiparticles",
            "venue": "Phys. Rev. Lett. 109,",
            "year": 2012
        },
        {
            "authors": [
                "C. Jamorski",
                "M.E. Casida",
                "Salahub",
                "D.R. Dynamic polarizabilities",
                "excitation spectra from a molecular implementation of time-dependent density-functional response theory"
            ],
            "title": "N2 as a case study",
            "venue": "J. Chem. Phys. 104, 5134",
            "year": 1996
        },
        {
            "authors": [
                "P. Elliott",
                "S. Goldson",
                "C. Canahui",
                "N.T. Maitra"
            ],
            "title": "Perspectives on doubleexcitations in TDDFT",
            "venue": "Chem. Phys. 391,",
            "year": 2011
        },
        {
            "authors": [
                "M.E. Casida"
            ],
            "title": "Propagator corrections to adiabatic time-dependent densityfunctional theory linear response theory",
            "venue": "J. Chem. Phys. 122,",
            "year": 2005
        },
        {
            "authors": [
                "P Romaniello"
            ],
            "title": "Double excitations in finite systems",
            "venue": "J. Chem. Phys. 130,",
            "year": 2009
        },
        {
            "authors": [
                "O.V. Gritsenko",
                "E. Jan Baerends"
            ],
            "title": "Double excitation effect in non-adiabatic time-dependent density functional theory with an analytic construction of the exchange-correlation kernel in the common energy denominator approximation",
            "venue": "Phys. Chem. Chem. Phys",
            "year": 2009
        },
        {
            "authors": [
                "G. Mazur",
                "R. W\u0142odarczyk"
            ],
            "title": "Application of the dressed time-dependent density functional theory for the excited states of linear polyenes",
            "venue": "J. Comput. Chem. 30,",
            "year": 2009
        },
        {
            "authors": [
                "M. Huix-Rotllant",
                "A. Ipatov",
                "A. Rubio",
                "M.E. Casida"
            ],
            "title": "Assessment of dressed time-dependent density-functional theory for the low-lying valence states of 28 organic chromophores",
            "venue": "Chem. Phys. 391,",
            "year": 2011
        },
        {
            "authors": [
                "D. Dar",
                "S. Roy",
                "N.T. Maitra"
            ],
            "title": "Curing the divergence in time-dependent density functional quadratic response theory",
            "venue": "J. Phys. Chem. Lett. 14,",
            "year": 2023
        },
        {
            "authors": [
                "S.M. Parker",
                "S. Roy",
                "F. Furche"
            ],
            "title": "Unphysical divergences in response theory",
            "venue": "J. Chem. Phys. 145,",
            "year": 2016
        },
        {
            "authors": [
                "N. Dittmann",
                "N. Helbig",
                "Kennes",
                "D.M. Dynamics of the Anderson impurity model"
            ],
            "title": "benchmarking a nonadiabatic exchange-correlation potential in timedependent density-functional theory",
            "venue": "Phys. Rev. B 99, 075417",
            "year": 2019
        },
        {
            "authors": [
                "V. Turkowski",
                "T.S. Rahman"
            ],
            "title": "Nonadiabatic exchange-correlation kernel for strongly correlated materials",
            "venue": "J. Phys. Condens. Matter 29,",
            "year": 2017
        },
        {
            "authors": [
                "S.R. Acharya",
                "V. Turkowski",
                "G.P. Zhang",
                "Rahman",
                "T.S. Ultrafast electron correlations",
                "memory effects at work"
            ],
            "title": "femtosecond demagnetization in ni",
            "venue": "Phys. Rev. Lett. 125, 017202",
            "year": 2020
        },
        {
            "authors": [
                "W. Tarantino",
                "C.A. Ullrich"
            ],
            "title": "A reformulation of time-dependent Kohn-Sham theory in terms of the second time derivative of the density",
            "venue": "J. Chem. Phys. 154,",
            "year": 2021
        },
        {
            "authors": [
                "M. Vanzini",
                "A. Aouina",
                "M. Panholzer",
                "M. Gatti",
                "L. Reining"
            ],
            "title": "Connector theory for reusing model results to determine materials properties",
            "venue": "NPJ Comput. Mater. 8,",
            "year": 2022
        },
        {
            "authors": [
                "X. Gonze",
                "P. Ghosez",
                "R.W. Godby"
            ],
            "title": "Density-polarization functional theory of the response of a periodic insulating solid to an electric field",
            "venue": "Phys. Rev. Lett. 74,",
            "year": 1995
        },
        {
            "authors": [
                "N.T. Maitra",
                "K. Burke",
                "C. Woodward"
            ],
            "title": "Memory in time-dependent density functional theory",
            "venue": "Phys. Rev. Lett. 89,",
            "year": 2002
        }
    ],
    "sections": [
        {
            "text": "REVIEW ARTICLE OPEN\nNon-adiabatic approximations in time-dependent density functional theory: progress and prospects"
        },
        {
            "heading": "Lionel Lacombe1 and Neepa T. Maitra2\u2709",
            "text": "Time-dependent density functional theory continues to draw a large number of users in a wide range of fields exploring myriad applications involving electronic spectra and dynamics. Although in principle exact, the predictivity of the calculations is limited by the available approximations for the exchange-correlation functional. In particular, it is known that the exact exchange-correlation functional has memory-dependence, but in practise adiabatic approximations are used which ignore this. Here we review the development of non-adiabatic functional approximations, their impact on calculations, and challenges in developing practical and accurate memory-dependent functionals for general purposes.\nnpj Computational Materials (2023) 9:124 ; https://doi.org/10.1038/s41524-023-01061-0"
        },
        {
            "heading": "INTRODUCTION",
            "text": "Over the past almost 40 years, time-dependent density functional theory (TDDFT) has enabled the calculation of electronic spectra and dynamics in systems that would have been otherwise out of reach to treat quantum-mechanically1\u20136. While ground-state density functional theory (DFT) is the mainstay of electronic structure, being itself the most widely-used method for materials and molecules as well as the starting point of almost all other treatments of materials, it does not give excitations, or more generally the response to a time-dependent external field whether weak or strong. DFT-flavored methods that do provide excitation energies include \u0394SCF7 which, while originally justified only for the lowest state of a given symmetry, was later shown to have a rigorous basis through the generalized adiabatic connection approach of ref. 8; the method however is usually used in a very approximate way with ground-state DFT functionals replacing approximations to the orbital-dependent excited state functionals appearing in the theory. Ensemble-DFT9\u201311, recently extensively reviewed in ref. 12, provides another in-principle exact route to excitation energies, but existing formulations of either ensembleDFT or \u0394SCF do not give access to other response properties such as spectral oscillator strengths. Alternative methods based on approximations to the true wavefunction, or on other reduced quantities such as the one-body Green\u2019s function or reduced density-matrices, require more computational resources. There are simply no computationally feasible alternatives to TDDFT for some of the applications on complex systems particularly when driven away from their ground states. Some examples over the past 5 years are described in recent reviews5,6,13, and range from simulations of electronic stopping power14, charge transport in complex molecules15, across nano-junctions16 and in light harvesting systems17, attosecond electron dynamics and highharmonic generation in solids13,18\u201320, laser-driven dynamics in nanogaps of thousand-atom systems21, angle-resolved photoemission from large clusters22, ultrafast spin transfer23, Floquet engineering24, and conductivity in a disordered Al system that treated almost 60,000 electrons explicitly25. On the other hand, in the vast majority of cases, TDDFT is applied in the linear response regime, where weak perturbations of the ground-state formulated\nin the frequency-domain provide excitation spectra and oscillator strengths26\u201330; the favorable system-size scaling of TDDFT has been further enhanced with the use of embedding methods31\u201336 or stochastic orbitals37,38. The computational efficiency of TDDFT is all the more appreciated considering the climate crisis we face today. Instead of simulating the many-electron interacting TDSE, the Runge\u2013Gross theorem1\u20133 assures us that we can, in theory, find the exact time-dependent density and all observables from solving the time-dependent Kohn\u2013Sham (KS) equation:\n\u22072=2\u00fe vS\u00f0r; t\u00de \u03d5i\u00f0r; t\u00de \u00bc i\u2202\u03d5i\u00f0r; t\u00de=\u2202t (1) (in atomic units) where the KS potential is:\nvS\u00f0r; t\u00de \u00bc vext\u00f0r; t\u00de \u00fe vH\u00bdn \u00f0r; t\u00de \u00fe vXC\u00bdn;\u03a80;\u03a60 \u00f0r; t\u00de (2) Here:\nvH\u00bdn \u00f0r; t\u00de \u00bc Z d3r0w\u00f0jr r0j\u00den\u00f0r0; t\u00de (3)\nis the Hartree potential,\nn\u00f0r; t\u00de \u00bc N P\n\u03c3;\u03c32::\u03c3N\nZ d3r2::rNj\u03a8\u00f0r\u03c3; r2\u03c32::rN\u03c3N\u00dej2\n\u00bc PN i j\u03d5i\u00f0r; t\u00dej2\n(4)\nis the one-body density, and w\u00f0jr r0j\u00de the electron-electron interaction. The last term in Eq. (2) is the time-dependent exchange-correlation (xc) potential, vXC[n; \u03a80,\u03a60](r, t): a functional of the density, the initial interacting wavefunction \u03a80 and initial choice of KS wavefunction \u03a60. Solving for N single-particle orbitals scales far better with system-size than solving for \u03a8, the correlated wavefunction of N electrons. In linear response applications, a perturbative limit of these equations gives the density response, from which excitation spectra can be extracted; there, instead of vXC, its functional derivative, the xc kernel f XC\u00bdn0 \u00f0r; r0; t t0\u00de is required. What makes this reformulation of many-electron dynamics possible is the Runge\u2013Gross theorem proving the one-to-one mapping between the density and potential for a fixed initial state1, and the assumption of non-\n1Laboratoire des Solides Irradi\u00e9s, \u00c9cole Polytechnique, Institut Polytechnique de Paris, F-91128 Palaiseau, France. 2Department of Physics, Rutgers University, Newark, NJ 07102, USA. \u2709email: neepa.maitra@rutgers.edu\nwww.nature.com/npjcompumats\nPublished in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences\n1 2 3 4 5 6 7 8 9 0 () :,;\ninteracting v-representability39. (We note that the rigorous mathematical foundations of both aspects are somewhat unsettled40,41). The Runge\u2013Gross theorem guarantees that all observables, beyond just the time-dependent density, can be accessed with knowledge of the corresponding functional of the density and initial KS state. However, the identification of these functionals for observables not directly expressed in terms of the density is a challenging problem that has only been examined in a limited number of studies42\u201344. In practice, an approximation is made by using the KS wavefunction directly. We also note that the theorem holds for the density, but can be generalized to spin-densities, and in practice spin-densities are often used especially when properties related to magnetization are of interest. A key element in these calculations is the xc potential, vXC[n;\u03a80,\u03a60](r, t), which is unknown and needs to be approximated. Almost all the calculations today use an adiabatic approximation; that is, a ground-state xc potential evaluated on the instantaneous density. Digging into the theory however reveals that the exact xc potential has memory-dependence: it depends on the history of the density, n\u00f0r; t0 t\u00de as well as the initial interacting and KS states, \u03a80 and \u03a60. In the linear response regime, memory-dependence endows the xc kernel with a frequency-dependence. Ever since the early days of TDDFT, researchers have been striving to build approximations which include this memory-dependence. Here, we review these efforts and their successes, reasons for why they are not widely used, and discuss prospects of future developments. Before doing so, we demonstrate, using an exactly-solvable model system, the implications of memory-dependence for both dynamics and excitations, and discuss some exact conditions related to memory dependence."
        },
        {
            "heading": "SIGNIFICANCE OF MEMORY-DEPENDENCE",
            "text": "The lack of memory-dependence in adiabatic TDDFT has been held responsible for errors in their predictions for many real systems, and sometimes significant failures, e.g. refs. 44\u201357. In practise, an adiabatic approximation has two sources of error: one coming from the choice of the ground-state approximation, and one from making the adiabatic approximation itself. In some cases, the spatial non-local property of the xc functional is more important, and is lacking in the commonly used local or semi-local approximations, e.g., for excitons58, and some charge-transfer excitations59,60, and including long-range dependence yields good results even within an adiabatic approximation. But in other cases, memory-dependence is essential in both real-time non-perturbative dynamics and in linear response, as in refs. 22,44\u201357. In the real-time regime, adiabatic functionals cannot describe resonantly-driven dynamics, or dissipation and relaxation from electron-electron interaction in large systems, for example. To isolate the effect of the lack of memory-dependence alone, a useful tool is to consider the adiabatically-exact approximation4,61,62, which consists of using the exact ground-state (g.s.) approximation:\nvA exXC \u00bdn;\u03a80;\u03a60 \u00f0r; t\u00de \u00bc v exact g:s: XC \u00bdn\u00f0t\u00de \u00f0r\u00de (5)\nThe \u201cbest\u201d adiabatic approximation possible is then to propagate with vA exXC \u00f0r; t\u00de, which would require finding the exact g.s. xc potential at each instant in time. This is numerically quite demanding for all but the simplest systems but very instructive when carried out62\u201366, especially when the resulting density and xc potential can be compared with the exact time-dependent density and xc potential. Finding the latter for a given target density can be generally achieved through iteration procedures40,67\u201371, or more simply for two-electron cases with only one doubly-occupied KS orbital, e.g. refs. 72\u201376. Section \u201cExample: asymmetric Hubbard dimer\u201d gives an example on a very simple\nsystem, comparing propagation with the adiabatically-exact xc potential against the exact propagation. In the linear response regime, the KS spectrum is corrected toward that of the true spectrum through the xc kernel which is the density-functional-derivative of the xc potential26,27 (section \u201cNon-adiabatic approximations in TDDFT\u201d). The adiabatic approximation yields a frequency-independent kernel, but the frequencydependence of the exact xc kernel is crucial to capture certain properties: for example, states of double-excitation character in molecules45,77, corrections to the band gap in semiconductors to which the mere KS gap gives an underestimate78,79 unless hybrid functionals within generalized KS are used, and the excitonic Rydberg series in semiconductors80. The exact xc kernel has been found by inversion in a few works81\u201383, and recently, the general pole structure of the kernel was related to zeros in the density response from counterbalancing behavior of neighboring oscillatory modes, allowing a parametric reconstruction of the kernel80.\nExample: asymmetric Hubbard dimer To demonstrate the impact of the adiabatic approximation, we consider one of the simplest interacting two-electron systems, the Hubbard dimer:\nH \u00bc t X \u03c3\u00bc\";# \u00f0ay1\u03c3a2\u03c3 \u00fe a y 2\u03c3a1\u03c3\u00de \u00fe U X i n\u0302i\"n\u0302i# \u00fe X i vi n\u0302i (6)\nwhere t is a site-to-site hopping parameter, U is an on-site interaction strength, and \u0394v= \u2223v1\u2212 v2\u2223 controls the asymmetry of the two-site system. This has been thoroughly studied in the ground state, see ref. 84 for a review which also provides a parametrization of the exact ground-state xc potential for this system, tuning the correlation, and examines limiting cases such as the symmetric limit, and the weakly- or strongly-correlated limits. As emphasized in ref. 84, while the study of lattice models is insightful and shares features similar to real-space systems, it is not representative of most TDDFT applications which are done in real-space. Depending on the physical system at hand, the reduction of dimensionality and local nature of the interaction may be valid approximations85. The key parameter in determining the degree of correlation is the ratio of the asymmetry to the onsite interaction, \u0394v/U84,86; even for large interaction strengths U, the system is weakly correlated (meaning, the next lowest energy determinants to the KS ground-state determinant are not \u201cnearby\u201d) if the asymmetry \u0394v is large enough that two electrons essentially sit on the same site in the ground state. Ref. 86 focuses on the exact features of the xc kernel in the same system. Since only three singlet states span the Hilbert space, the ground-state Levy constrained search over all wavefunctions can be readily performed numerically given a target density64\u201366,87\u2013101. This means that, at each time-step, it is straightforward to find the adiabatically-exact xc potential and use it to propagate to the next time-step. In this way, we can directly isolate the effect of making the adiabatic approximation on the dynamics, without any approximation to the ground-state functional. Figure 1 shows the dynamics driven out of the ground-state by a \u03c0-pulse resonant with the lowest excitation, for parameters t= 1/2, \u0394v=\u2212 15, and either U= 10, or U= 20 in the strong correlation case. In either case, this excitation has a charge transfer character with respect to the ground state: for U= 10 the ground state has close to two electrons sitting on the lower site, while the lowest excitation has one electron transferred to the other site, while for U= 20 (Mott\u2013Hubbard regime), the ground-state has close to one electron on each state while the lowest excitation has close to two electrons on the lower site. Driving the Hubbard dimer initially in its ground state with a weak \u03c0-pulse at this lowest excitation energy thus shows a large change in the site occupation \u0394n= n1\u2212 n2 as shown in the left panels of Fig. 1. In both cases, the adiabatically-exact evolution shows only a small partial charge\nnpj Computational Materials (2023) 124 Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences\n1 2 3 4 5 6 7 8 9 0 () :,;\ntransfer (particularly small in the strongly correlated case) before returning to oscillate around the ground state density. This failure can be traced to the inability of the adiabatically-exact xc potential to capture dynamical step features72, in particular, a non-adiabatic step feature associated with charge-transfer59,65,66,73, evident in the oscillations and large change in the xc potentials shown on the right-hand-side; a full discussion of the xc potentials and densities in similar dynamics (using a continuous wave flat envelope driving instead of a \u03c0-pulse) can be found in refs. 65,66. The dynamics seen here is very similar to that found in real molecules47 where adiabatic approximations also began to charge transfer and then appeared to give up (see also Fig. 3) shortly; the fact that even the adiabatically-exact fails indicates it is an issue with memory-dependence. As mentioned above, the problem can be traced to the lack of dynamical steps and peaks in the xc potential, and this appears to especially drastically affect resonant-driving because it leads to spurious pole-shifting: when driven away from its groundstate, the resonant frequencies of a system predicted by adiabatic TDDFT are detuned from the values predicted from linear response of the ground-state50,102 but excitation energies of a system should not shift with the instantaneous state (see also Fig. 3 shortly). The density-dependence of the KS potential results in the response of a general state having spuriously shifted poles, while the exact generalized xc kernel acquires a frequency-dependence that corrects this shift102,103. Adiabatic TDDFT is trying to predict resonantly-driven dynamics but keeps being driven out of resonance by the density-dependence. In fact, one could obtain a larger charge-transfer by instead applying a \u201cchirped\u201d laser that has a time-dependent frequency that adjusts to the instantaneous resonant frequency of the adiabatic approximation during the driving103. In general, the spurious pole-shifting can muddy the interpretation of the underlying dynamics of molecules when properties of the timeresolved dynamics are measured by a probe; the shifts of peaks in the experimental time-resolved spectrum correspond to different nuclear configurations, while in an adiabatic TDDFT simulation it would be hard to disentangle this from the spurious peak-shifting. Ref. 104 argued for the case of using the linear-response TDDFT formulation of Ehrenfest dynamics rather than a real-time\nformulation due to this problem when simulating coupled electron-nuclear dynamics. This was demonstrated using a model system to compute the errors in predicting the underlying nuclear dynamics when the spectra are calculated in either formulation. An analog of this molecular dynamics situation for the Hubbard molecule is demonstrated in Fig. 2, where the system under the same \u03c0-pulse as in Fig. 1 is probed at various times during the pulse by a weak pulse that measures the spectrum at that time. Note that the field is off during the probe measurement, so the exact absorption spectrum should have peaks at the same frequency each time, albeit with different oscillator strength. This condition is not respected by the adiabatically-exact propagation, as evident in the middle panel. The table gives the values of the peak frequencies at the times indicated during the evolution, exact and predicted from the adiabatically-exact evolution, and the external potential vext(\u03c9AE) whose linear response from the ground-state lies at the dominant peak in the exact and adiabatically-exact calculations. At T \u00bc 0, there is a small difference between the adiabatically-exact and exact transition frequency. Even though the targeted single excitation is far from the doubly-excited state, a small amount of mixing still occurs and its contribution is hidden in the frequency-dependent part of the xc kernel that is neglected in the adiabatic propagation. Leaving now the Hubbard playground and returning to real systems, Fig. 3 shows a sampling of results on molecular or solidstate systems where errors due to the adiabatic approximation lead to significant errors in their predictions of dynamics or spectra. The results here appear to paint a bleak picture for the adiabatic approximation, and yet the TDDFT calculations in e.g. refs. 5,6,13\u201323,25 have been accurate enough to reveal useful information about electron dynamics. Why this is so, is only partially understood; it is likely that few-electron, few-state systems are the most challenging cases for TDDFT and that often real systems are complex and large enough that e.g., peaks have significant widths and blur some of the problems discussed here. It is also true that in some applications the dominant effect driving the dynamics is the external potential, and the essential role of the xc potential is to partially counter self-interaction in the Hartreepotential and that a ground-state description of this is adequate. Further, often the observables of interest in real systems involve\nFig. 1 Hubbard dimer driven by a \u03c0-pulse resonant with the lowest excitation: adiabatically-exact (AE) dynamics compared with the exact, in the weak correlation (top panels) and strong correlation (lower panel) cases. The left-hand side shows the analog of the dipole, the site-occupation difference, \u0394n= n1\u2212 n2 while the right-hand-side shows the xc potential difference \u0394vXC.\nPublished in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences npj Computational Materials (2023) 124\naveraged quantities (e.g., the dipole moment rather than the spatially-resolved electron density) that can forgive even relatively large local errors in the density105. In situations where the system does not begin in a ground-state, it has been argued that the adiabatic approximation is likely to work best when the KS initial state is chosen to have a similar configuration as that of the true initial state105\u2013107, and that if, in the true problem the natural orbital occupation numbers do not significantly evolve even as the natural orbitals themselves may evolve significantly, then the adiabatic approximation can be justified to do a reasonable job even for strongly perturbed dynamics105. A final consideration is that the adiabatic approximation, by virtue of not having any memory-dependence, in fact satisfies a number of exact conditions that are related to memory (section \u201cMemory-related exact conditions\u201d)."
        },
        {
            "heading": "Memory-related exact conditions",
            "text": "We note that some insight into the structure of the exact xc potential can be gained from an exact expression resulting from equating the Heisenberg equation of motion for the second timederivative of the density of the KS system to that of the interacting system39,67,69,105,108:\nvXC \u00bc vWXC \u00fe vTC (7) where the interaction component vWXC satisfies: \u2207 \u00f0n\u00f0r; t\u00de\u2207vWXC\u00f0r; t\u00de\u00de \u00bc \u2207 n\u00f0r; t\u00de Z nXC\u00f0r0; r; t\u00de\u2207w\u00f0jr0 rj\u00ded3r0 ; (8)\nand the kinetic component vTC satisfies:\n\u2207 \u00f0n\u00f0r; t\u00de\u2207vTC\u00f0r; t\u00de\u00de \u00bc \u2207 D\u00f0\u03c11\u00f0r0; r; t\u00de \u03c11;S\u00f0r0; r; t\u00de\u00dejr0\u00bcr ; (9)\nFig. 2 Time-resolved spectroscopy in the Hubbard dimer (U= 10 case): at the times T indicated during the dynamics in the top panels of Fig. 1, the field is turned off and the system is probed to measure its absorption spectrum. The top figure shows the exact, the middle shows the predictions from the adiabatically-exact approximation demonstrating the peak-shifting, while the table shows the predictions of the external potential values that would be deduced by comparing the peak position to frequencies predicted from linear response.\nnpj Computational Materials (2023) 124 Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences\nwith D \u00bc 14 \u00f0\u2207 0 \u2207\u00de\u00f0\u22072 \u220702\u00de;\u2207 \u00bc \u2207r and \u22070 \u00bc \u2207r0 . Here nXC is the time-dependent xc hole defined as:\nnXC\u00f0r; r0\u00de \u00bc \u03c12\u00f0r; r0; r; r0\u00de=n\u00f0r0\u00de n\u00f0r\u00de; (10) where the two-body reduced density-matrix (2RDM) is: \u03c12\u00f0r1; r2; r01; r02\u00de \u00bc N\u00f0N 1\u00de Z dr3::drN\u03a8 \u00f0r01; r02; r3; ::; rN\u00de\u03a8\u00f0r1; r2; r3; ::; rN\u00de:\n(11)\nThe one-body reduced density matrix (1RDM) is: \u03c11\u00f0r; r0\u00de \u00bc N Z dr2::drN\u03a8 \u00f0r0; r2; ::; rN\u00de\u03a8\u00f0r; r2; ::; rN\u00de; (12)\nand \u03c11,S is the 1RDM of the KS system. Through Eqs. (7)\u2013(9), the dependence on the history of the density n\u00f0t0< t\u00de and the full interacting and KS initial states \u03a8(0) and \u03a6(0) is transformed into a more time-local dependence on the KS 1RDM, the true 1RDM, and the xc hole. It has been argued that adiabatic approximations tend to make less error on vWXC because the spatial integral appearing there is somewhat forgiving, while vTC is responsible for the dominant non-adiabatic effects, including the dynamical steps and peak structures69,74,105,109. Further, the\nchoice of initial KS state has a key effect on the size of vTC, as evident from its dependence on the difference between the interacting and KS 1RDMs; as mentioned earlier, a judicious choice can ease the job of the xc functional approximation. Attempts to build a memory-dependent functional based on this decomposition will be discussed in the section \u201cDensity-matrix coupled approximations\u201d. Several of the known exact conditions for the ground-state xc functional have analogs in the time-dependent case, e.g., oneelectron self-interaction-free conditions (vX[n](r, t)=\u2212 vH(r, t), vC[n] (r, t)= 0), while others are nested in the energy-minimization principle and cannot be extended to the time-dependent case (e.g., Lieb-Oxford bound). But there are also exact conditions that are inherently associated with the time-dependence of the system, and these typically have implications for memorydependence of the functional. Here we briefly discuss two of the conditions that have been key ingredients in the development of non-adiabatic approximations, and refer the reader to refs. 110,111 and Fig. 4 for discussion of others. As in the groundstate112,113, including the ingredients sketched in Fig. 4 in functional approximations leads to increased accuracy and reliability of the TDDFT predictions: Although their importance\n2.5 3 3.5 4 4.5 5 5.5 (eV)\n50\n40\n30\n20\n10\n0\nPure RPA Experiment\n2 3 4 5 6 \u03c9 (eV)\n0\n10\n20\n30\n40\n50\n60 Exp.\nBSE DFT-T1-T2 GW-RPA LRC TDLDA\n6 7 8 9 10 0\n5\n10\n15\n20\n-0.001\n-0.0005\n0\n0.0005\n0.001\n0.0015\n-0.06\n-0.04\n-0.02\n0\n0.02\n0.04\n0.06\n0 20 40 60 80 100\ndi po\nle m\nom en\nt ( a.\nu. )\na) b) c)\nd)\ne)\nFig. 3 Examples of errors in predictions of dynamics in real systems due to the adiabatic approximation. a Charge transfer dynamics in the LiCN molecule driven by a \u03c0-pulse, from ref. 47: time evolution of the dipole moment and energies computed with different methods. The frequency and strength of the pulse are adjusted to represent a resonant single-photon absorption in each case. The adiabatic LDA and PBE functionals are not able to transfer a significant amount of the charge in contrast to the configuration-interaction singles (CIS) and CISdoubles (CISD) calculations. Analysis on a model system showed that the exact xc potential develops non-adiabatic step and peak features essential in the charge-transfer process73; the lack of these is further related to the spurious pole-shifting49,50,102, demonstrated explicitly in the next panel. Reprinted (adapted) with permission from Raghunathan and Nest47, Copyright 2011 American Chemical Society. b Spurious pole-shifting in the electronic structure when LiCN is left in different superposition states after a pulse is applied, from ref. 49: a sequence of short pulses excite the system and the dipole moment between each pulse is recorded whose spectrum is obtained through Fourier transform. The position of the peaks should not change in the exact system, but peak shifting happens due to the adiabatic nature of LDA and X3LYP functionals. (see also section \u201cSignificance of memory-dependence\u201d) Reprinted (adapted) with permission from Raghunathan and Nest49, Copyright 2012 American Chemical Society. Predictions of the optical response of non-metallic systems underestimate the onset of continuous absorption (i.e., underestimate the gap) as illustrated here from ref. 223 in (c) and ref. 219 in (d), via the imaginary part of the dielectric function of bulk silicon. The onset of absorption is at a too low frequency in both the random phase approximation (RPA) calculation in which the xc kernel is put to zero and the adiabatic LDA (labeled TDLDA), and both miss the excitonic structure evident here in the twopeak shape of the experiment, correctly reproduced by the Bethe\u2013Salpeter equation (BSE) approach216,217. Although the excitonic feature can be captured by long-range-corrected (LRC) kernels (see also section \u201cBootstrapping many-body perturbation theory\u201d), the opening of the gap requires a frequency-dependent kernel79,212 and is related to the derivative discontinuity. Often this is effectively hiding in a \u201cscissors shift\u201d240 using quasiparticle energies from GW, as done in the \u201cDFT-T1-T2\u201d of ref. 219, but ref. 223 derived a \u201cPure\u201d approximation for the discontinuity, obtained entirely from ground-state KS and TDDFT quantities, with an underlying frequency-dependent kernel. Reprinted figure with permission from Cavo et al.223, Copyright 2020 by the American Physical Society. Reprinted figure with permission from Sottile et al.219, Copyright 2003 by the American Physical Society. e Relaxation dynamics of the dipole moment in a doped GaAs/Al0.3Ga0.7As quantum well, from ref. 166: an initial uniform electric field (0.01 mV/nm in the top subpanel, and 0.5 mV/nm lower subpanel) is turned off at t= 0. Damping is only present when memory is included, via the Vignale\u2013Kohn (VK) functional (section \u201cTime-dependent current-density functional theory\u201d) shown in solid lines, in contrast to the adiabatic LDA in dashed lines. Reprinted figure with permission from Wijewardane and Ullrich166, Copyright 2005 by the American Physical Society.\nPublished in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences npj Computational Materials (2023) 124\ndepends on the type of system of interest (e.g., finite-sized molecule versus extended solid) and the type of dynamics (mere spectra versus far from equilibrium), they can be responsible for errors in functionals that do not satisfy them, and can lead to violation of basic quantum principles e.g., unphysical selfexcitation114, spurious pole-shifting in non-equilibrium spectroscopy102,103.\nZero force theorem. The zero force theorem111,115\u2013117 (ZFT) ensures that the xc potential does not exert a net force:Z\nn\u00f0r; t\u00de\u2207vXC\u00bdn;\u03a80;\u03a60 \u00f0r; t\u00ded3r \u00bc 0: (13)\nSince the net force exerted by the Hartree potential vanishes, Eq. (13) ensures that the inter-electron Coulomb interaction does not exert any force on the system (as in Newton\u2019s third law of classical mechanics). This also holds in the ground-state, but in the timedependent case violation of this condition has a particularly severe consequence, leading to numerical instabilities due to the system self-exciting over time114,118,119. The linear response limit of Eq. (13) reveals a deep connection between spatial- and timenon-local density-dependence, which we will return to in the section \u201cFinite-frequency LDA\u201d. A related theorem is the net torque theorem111,116,117,120:Z n\u00f0r; t\u00der \u00b4\u2207vXC\u00f0r; t\u00ded3r \u00bc Z r \u00b4 \u2202tjXC\u00f0r; t\u00ded3r (14)\nwhere jXC= j\u2212 jS is the difference in the current-density of the true system and the KS system75,121\u2013124.\nGeneralized translational invariance. Translational invariance requires the wavefunction in an accelerated, or \u201cboosted\u201c, frame to transform as:\n\u03a8b\u00f0r1:::rN; t\u00de \u00bcYN\nj\u00bc1 e irj _b\u00f0t\u00de \u03a8\u00f0r1 \u00fe b\u00f0t\u00de:::rN \u00fe b\u00f0t\u00de; t\u00dej i (15)\nwhere b(t) is the position of the accelerated observer and b\u00f00\u00de \u00bc _b\u00f00\u00de \u00bc 0 such that the accelerated and inertial systems coincide at the initial time. The boosted density transports rigidly:\nnb\u00f0r; t\u00de \u00bc n\u00f0r\u00fe b\u00f0t\u00de; t\u00de: (16)\nRef. 117 proved that in order to fulfill Eq. (16) the xc potential must transform as:\nvbXC\u00bdn;\u03a80;\u03a60 \u00f0r; t\u00de \u00bc vXC\u00bdn;\u03a80;\u03a60 \u00f0r\u00fe b\u00f0t\u00de; t\u00de : (17)\nIn fact, a vXC that fulfills Eq. (17) automatically fulfills the ZFT Eq. (13)117. The generalized translational invariance (GTI) and ZFT are closely related, particularly in the linear response regime125. A special case of Eq. (17) is the harmonic potential theorem (HPT), which states that for a system confined by a harmonic potential and subject to a uniform time-dependent electric field, the density transforms rigidly following Eq. (16) where b(t) is the position of the center of mass2,111,117,126."
        },
        {
            "heading": "NON-ADIABATIC APPROXIMATIONS IN TDDFT",
            "text": "From soon after the birth of TDDFT to today, non-adiabatic approximations have been derived and tested. We review these, in roughly chronological order, below. The earliest ones focussed on the linear response regime, where instead of needing an approximation for the full xc potential vXC[n;\u03a80,\u03a60](r, t), an approximation for the xc kernel f XC\u00bdn0 \u00f0r; r0; t t0\u00de \u00bc \u03b4vXC\u00f0r;t\u00de\u03b4n\u00f0r0;t0\u00de , or its frequency Fourier transform is needed26,27,127. The TDDFT linear response formalism is based on the density-density response function, \u03c7\u00f0r; r0;\u03c9\u00de which describes the linear density response of the system at frequency \u03c9 to a perturbation \u03b4v: \u03b4n\u00f0r;\u03c9\u00de \u00bc R dr0\u03c7\u00f0r; r0;\u03c9\u00de\u03b4v\u00f0r0;\u03c9\u00de. In TDDFT:\n\u03c7\u00f0r; r0;\u03c9\u00de \u00bc \u03c7S\u00f0r; r0;\u03c9\u00de \u00fe Z dr1dr2\u03c7S\u00f0r; r1;\u03c9\u00defHXC\u00f0r1; r2;\u03c9\u00de\u03c7\u00f0r2; r0;\u03c9\u00de (18)\nwhere \u03c7S is the KS density-response function, giving the densityresponse to a perturbation of the KS potential vS, and fHXC\u00f0r1; r2;\u03c9\u00de \u00bc 1jr1 r2j \u00fe f XC\u00bdn0 \u00f0r1; r2;\u03c9\u00de. Being evaluated at the ground-state density eliminates the initial-state dependence, due to the Hohenberg\u2013Kohn theorem of ground-state DFT128, and memory-dependence corresponds to frequency-dependence of the xc kernel, since \u03b4vXC\u00f0r;t\u00de\u03b4n\u00f0r0;t0\u00de is not merely proportional to a deltafunction in the time-difference which gives a constant in the frequency Fourier transform. The instantaneous dependence of the xc potential with respect to the density in the adiabatic approximation yields a frequency-independent kernel."
        },
        {
            "heading": "Finite-frequency LDA",
            "text": "The Gross\u2013Kohn (GK) approximation127,129 is a straightforward first attempt to extend the LDA into the dynamical regime, retaining the spatially-local dependence on the density while introducing time-nonlocal dependence via the finite-frequency response of a uniform electron gas. That is, the xc kernel is approximated by:\nfGKXC \u00bdn0 \u00f0r; r0;\u03c9\u00de \u00bc \u03b4\u00f0r r0\u00def unif XC \u00bdn0\u00f0r\u00de \u00f0q \u00bc 0;\u03c9\u00de (19)\nwhere f unifXC \u00bdn \u00f0q;\u03c9\u00de \u00bc R f unifXC \u00bdn \u00f0r; r0;\u03c9\u00deeiq \u00f0r r\n0\u00dedr0 is the xc kernel of a uniform electron gas of ground-state density n at wavevector q and frequency \u03c9. The time-nonlocal dependence of the GK approximation is explicit when considering the response xc potential in the linear response regime corresponding to Eq. (19): vGKXC \u00bdn \u00f0r; t\u00de \u00bc R f unifXC \u00bdn0\u00f0r\u00de \u00f0t t0\u00de\u03b4n\u00f0r; t0\u00dedt0.\nThe uniform electron gas xc kernel, f unifXC \u00bdn \u00f0q;\u03c9\u00de is known exactly for a range of densities in some limits, e.g., in the longwavelength limit q= 0,\u03c9 \u2260 0 in refs. 127,130, and the static limit q \u2260 0, \u03c9= 0 in refs. 131,132 where parameterizations based on quantum Monte Carlo have been developed in ref. 133. An early interpolation between the two limits was given in ref. 134 focussing on the metallic density range. More recently, ref. 135 developed an interpolation over a wide range of densities while\nFig. 4 Exact conditions in TDDFT. Ingredients for a wholesome functional approximation are some known conditions satisfied by the exact xc potential and xc kernel of TDDFT: the zero force condition and generalized translational invariance111,116,117,126, symmetry and reciprocity relations125, causality (with Kramers\u2013Kronig relations for the kernel)110,169, memory condition tying together initial-state dependence and history-dependence75,241, scaling relations242, selfinteraction free property69, and the reduction to the ground-state functionals in the adiabatic limit for systems with a gap110.\nnpj Computational Materials (2023) 124 Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences\nincorporating first-principles constraints, with ref. 136 building upon this, embracing even lower densities and more exact conditions. We note that taking the limit \u03c9\u2192 0 first then q\u2192 0 of the kernel reduces to the adiabatic local density approximation (ALDA). The order in which the limits q\u2192 0 and \u03c9\u2192 0 are taken is crucial, as the outcome depends on their order78,125. It should also be noted that a fundamental difference between the uniform gas kernel and that of inhomogenous systems is the long-wavelength finite-frequency behavior as q\u2192 0, where f unifXC \u00f0q ! 0;\u03c9\u00de tends to a finite constant, while for non-metallic systems, the kernel diverges as \u03b1(\u03c9)/q2 which has important consequences for the optical response of solids3,58,137 (see also section \u201cBootstrapping many-body perturbation theory\u201d). Finally, we note that ref. 138 tabulated f unifXC \u00bdn \u00f0q;\u03c9\u00de for a wide range of wave-vectors and frequencies through a correlated equations of motion approach including single-particle-hole and two-particle two-hole excitations, within a correlated basis functions formalism for computing matrix elements. This revealed a double-plasmon excitation for which such a non-adiabatic kernel is essential (c.f. section \u201cSpecific cases\u201d), and ref. 138 further showed the possibility of using these results to obtain such features in spectra of inhomogeneous systems. Returning to the GK approximation, Eq. (19) can be viewed as a \u201cdouble LDA\u201d, in that both the ground-state density of the system n0(r) varies slowly enough in space that the density-functional argument can be replaced by the local density considered as part of a homogeneous system, and also that the response of the system varies slowly enough that only the zero wavevector component is used. A question is whether an approximation may still be reasonably accurate well beyond the situation for which it was derived, as is the case for the ground-state LDA. In the ground-state case, a key reason often given for why LDA gives useful results for nonuniform densities of molecules and solids is its satisfaction of exact conditions139,140 such as sum-rules on the xc hole. Unfortunately, the GK approximation violates several of the exact conditions discussed in the section \u201cMemory-related exact conditions\u201d that are important for the time-dependent problem. Refs. 117,126 pointed out that it violates the HPT: instead of yielding a rigid sloshing of the density in a uniform field-driven harmonic well with a center that follows the classical center of mass motion, GK results in a density-dependent shift in the frequency of this motion, and a damping of the oscillations. The problem is that a potential vXC(r, t) that sees only the density at that point r over time cannot tell whether the change over time is from a sloshing motion or a compression/expansion motion. In fact, GK\u2019s violation of the GTI condition, of which HPT is a special case, was shown in refs. 116,117 to imply that the xc kernel for a non-uniform system at finite frequency has a densitydependence that is long-range in space such that a local-density or gradient expansion approximation simply does not exist. The ZFT also demonstrates this: taking the linear-response limit of Eq. (13) by writing n(r,\u03c9)= n0(r)+ n1(r, \u03c9) and vXC\u00f0r;\u03c9\u00de \u00bc vXC\u00bdn0 \u00f0r\u00de\u00feR f XC\u00f0r; r0;\u03c9\u00den1\u00f0r0;\u03c9\u00ded3r0, one arrives at:Z f XC\u00bdn0 \u00f0r; r0;\u03c9\u00de\u2207n0\u00f0r0\u00ded3r0 \u00bc \u2207vXC\u00bdn0 \u00f0r\u00de (20)\nInputting the GK kernel Eq. (19) yields \u2207n0\u00f0r\u00def unifXC \u00bdn0\u00f0r\u00de \u00f0q \u00bc 0;\u03c9\u00de on the left-hand-side, which is a clearly frequency-dependent quantity, quite incompatible with the right-hand-side which is frequency-independent! The argument can be generalized to show that even a short-ranged xc kernel violates the condition when applied to slowly-varying ground-state densities, and thatR f XC\u00f0r; r0;\u03c9\u00ded3r0 must diverge. In fact, Eq. (20) implies that spatial and time non-local density-dependence are intimately related in the exact xc kernel, since the spatial integral of the frequencydependence must yield a frequency-independent quantity. Thus\nthe ZFT, which is a seemingly natural statement embodying simply a Newton\u2019s third law type of physics leads to quite an extraordinary result: time non-local density-dependence implies spatially non-local dependence, and that a local-density approximation, or gradient expansion, with memory simply does not exist125,141. Since this is true even in the limit of slowly-varying densities, the effect has been dubbed \u201cultra-nonlocality\u201d. The effect of the violation of the GTI and ZFT by the GK approximation on dynamics was shown to yield unphysical behavior on dynamics in sodium clusters in ref. 118, including the appearance of spurious low-frequency modes and instabilities. Ref. 118 also presented a way to directly impose these conditions through constraints on the potentials, applicable in principle to any xc kernel or potential approximation.\nTime-dependent current-density functional theory While ref. 126 pointed out GK\u2019s violation of the HPT theorem, it also suggested an avenue for a remedy: to separate out the translational motion of the density from that of the compression/ expansion and to use the finite-frequency uniform-gas kernel only for the latter. Ref. 142 further developed this notion that memory resides with a \u201cfluid element\u201d and that, although there is no spatially-local time-nonlocal description in terms of n(r, t), we can search for such a description in terms of n\u00f0R\u00f0t0\u00de\u00de where R\u00f0t0\u00de \u00bc R\u00f0t0jrt\u00de is the position of the fluid element at time t0 which at t is at position r. In this way, the current-density naturally enters the picture because this is what dictates the trajectory R(t), through \u2202t0R\u00f0t0jr; t\u00de \u00bc J\u00f0R; t0\u00de=n\u00f0R; t0\u00de with the boundary condition R(t\u2223r, t)= r. The Dobson\u2013B\u00fcnner\u2013Gross functional thus applies the GK functional in a frame that moves with the local velocity J\u00f0R; t0\u00de=n\u00f0R; t0\u00de, resulting in a functional that satisfies the HPT and GTI142. At around the same time (in fact the \u201creceived\u201d date is earlier for ref. 142 than for ref. 143 although the \u201cpublished\u201d date is after), the Vignale\u2013Kohn current-density functional was developed, which elevated the current-density from simply assisting to actually being the basic variable of the functional125,143,144. Timedependent current-density functional theory (TDCDFT) is based on the one-to-one mapping between the current-density and the vector potential acting on the system, for a given initial state, which had been proven earlier in refs. 145,146. The KS equation has the form:\n\u00f0 i\u2207\u00fe aS\u00f0r; t\u00de\u00de2\n2 \u00fe vS\u00f0r; t\u00de\n! \u03d5i\u00f0r; t\u00de \u00bc i\u2202t\u03d5i\u00f0r; t\u00de (21)\nwhere there is a gauge-freedom between the longitudinal part of the KS vector potential and scalar potential, e.g., putting all the time-dependent external fields and xc fields into the vector potential would yield aS(r, t)= aext(r, t)+ aXC(r, t), vS(r, t)= vext,0(r)+ vH(r, t)+ vXC,0(r), but other gauge choices can be made. Even if only a scalar potential is applied to an interacting system, the resulting current-density is typically only reproducible by a non-interacting system with a vector potential; the TDDFT KS current-density usually differs from the physical current-density by a rotational component, even when the exact xc functional is used75,121\u2013124. A key motivation for using TDCDFT is that the current-density at a given point in space contains spatially non-local density-dependence, which can be seen from inverting the continuity equation: \u2207 j\u00f0r; t\u00de \u00bc \u2202tn\u00f0r; t\u00de ! jL\u00f0r; t\u00de \u00bc R \u2202tn\u00f0r0; t\u00de\u2207r 14\u03c0jr r0 j d\n3r0, which implies that spatially local functionals of the current-density have spatially non-local density-dependence. In fact a local approximation in terms of the current-density does exist, and, when considered through the linear current response of a slowly spatially-varying electron gas, forms the basis of the Vignale\u2013Kohn (VK) approximation125,141,143,144. The central role is played by the tensorial xc kernel\nPublished in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences npj Computational Materials (2023) 124\nwhich is the functional derivative of the xc vector potential with respect to the current-density, for the ground-state of a slowlyvarying periodically modulated electron gas. This functional is constructed in the linear response regime, built up from both longitudinal and transverse responses of the uniform electron gas147\u2013150 together with the imposition of several exact conditions: the zero force and zero torque identities (section \u201cMemory-related exact conditions\u201d), the Ward identity and symmetry/reciprocity relations125. The resulting functional for the linear response xc vector potential takes the following form125,143,144:\ni\u03c9 c aXC1;i \u00bc \u2207ivALDAXC1 \u00f0r\u00de \u00fe 1 n0\u00f0r\u00de X j \u2202\u03c3XC;ij\u00f0r;\u03c9\u00de \u2202rj\n(22)\nwhere:\n\u03c3XC;ij \u00bc ~\u03b7XC \u2202ui \u2202rj \u00fe \u2202uj \u2202ri 2 3 \u2207 u\u03b4ij \u00fe ~\u03beXC\u2207 u\u03b4ij (23)\nwhere u= j(r)/n0(r) is the velocity field, and ~\u03b7 and ~\u03beXC are complex viscosity coefficients, expressible in terms of the longitudinal and transverse response kernels of the uniform electron gas, and functions of the frequency and ground-state density125,143,144. Although the original form looked more complicated, it was shown to be equivalent to the form above in ref. 144, giving a physical interpretation in terms of a Navier\u2013Stokes form for the current-density where a hydrodynamical viscoelastic stress tensor has complex viscosity coefficients of the electron liquid. The VK approximation becomes exact in the limit that the length scale of the variations of the ground-state density q\u22121 and perturbing potential k\u22121 are such that k, q < <\u03c9/vF, kF where kF, vF are the local Fermi momentum and velocity . Therefore, this theory is applicable to the study of high frequency phenomena, but due to its satisfaction of some exact conditions and spatially-non-local density-dependence, it has also been successfully applied in the static regime where long-range effects are important (more shortly). It has also been extended to the non-linear regime in ref. 144. Building on the VK approach, refs. 151,152 derived a GGA and meta-GGA to move beyond the slowly spatially-varying assumption. The Vignale\u2013Kohn approximation has memory-dependence and spatially nonlocal density-dependence (local in current). Due to these features, it has successfully predicted linewidths of collective modes in two-dimensional quantum strips and quantum wells153\u2013155 absent in LDA or GGA, time-resolved dissipation from electron-electron interaction in large or periodic systems156,157 missed in LDA or GGA or with any adiabatic functional, stopping power in metals158, spin-Coulomb drag159, and static polarizabilities in long polymer chains160,161 (routinely underestimated by adiabatic LDA or GGA). However, it has been shown to generate unphysical damping of excitations and dissipation in finite systems162, does not provide a significant correction to the band-gap, and does not work well for the optical response of semiconductors unless either an empirical factor is used163,164 or it is combined with other non-empirical polarization functionals where it corrects for bound exciton widths in insulators and semiconductors and Drude tails in metals165. Even if only applied to metallic extended systems, some caution should be applied since the longitudinal and transverse electron gas response functions entering the Vignale\u2013Kohn functional are not wellknown for all frequencies and wavevectors147,149. The non-linear extension of the Vignale\u2013Kohn approximation has also been used to study decoherence and energy relaxation of charge-density oscillations in quantum wells166. A different nonlinear nonadiabatic functional based on Landau Fermi liquid theory was presented in ref. 167 and was the precursor of deformation functional theory which will be shortly discussed."
        },
        {
            "heading": "TDCDFT via an action functional",
            "text": "TDCDFT was also the framework for a general formulation where memory is included through an action functional defined on the Keldysh contour in order to preserve causality168: vXC should depend only on the past-density, not the future, which means its functional derivative f XC\u00bdn \u00f0r; t t0\u00de should be zero for t>t0169 and this property would be violated if vXC was the functional derivative of an action defined in physical time rather than on the Keldysh contour. (We note that some caution is needed when using the Keldysh contour in TDDFT: the Runge\u2013Gross one-to-one mapping on the Keldysh contour has not yet been proven120 but the contour can be still be used rigorously in variational formulations e.g., as demonstrated in ref. 170). Regarding a real-time resolution of the causality paradox, we refer the reader to ref. 171. The use of Lagrangian coordinates in the action functional resulted in xc potentials that again preserve the GTI and ZFT172; the Lagrangian description arises naturally when thinking of the convective fluid element motion in TDCDFT. The same authors developed a computationally simpler approach that avoids Lagrangian frames, and instead constructs a family of translationally invariant actions on the Keldysh contour which automatically satisfy GTI and ZFT, and they derive a memory-correction to ALDA built using the uniform electron gas kernel of refs. 127,130 in this framework168. The effect of memory in this approximation was highlighted in creating viscous effects in both the linear and nonlinear regime in plasmon dynamics and absorption in spherical jellium gold clusters.\nTime-dependent deformation functional theory When TDCDFT is recast in the Lagrangian frame, the natural spatial coordinate to use at time t becomes the initial point \u03be= \u03be(r, t) of the trajectory which at time t is at position r. Refs. 170,173\u2013175 showed that by separating the convective motion of the \u201celectron fluid elements\u201d from their relative motion, the many-body effects are contained in an xc stress tensor which depends on the timedependent metric tensor of the r\u2192 \u03be transformation; since this tensor corresponds to Green\u2019s deformation tensor of classical elasticity theory, the approach is called time-dependent deformation functional theory (TDdefFT). This framework is fully non-linear from the start and offers a distinct starting point for approximations. The local deformation approximation is based on uniform time-dependent deformations of the uniform gas, giving a stress tensor with spatially-local but time-non-local dependence on the metric tensor; this does not violate the ZFT and GTI since the convective non-locality is treated exactly through its dependence on the Lagrangian coordinate \u03be(r, t). Ref. 176 compared TDdefFT and TDCDFT in both linear and nonlinear models of chargedensity oscillations. In the limit of small deformations, the local approximation in TDdefFT reduces to the VK TDCDFT approximation174. Another limit is an elastic one, valid for very fast variations of the deformation tensor. This is spatially-nonlocal and related to the \u201cantiadiabatic\u201d limit of the xc kernel177. In \u201cquantum continuum mechanics\u201d178\u2013180, the hydrodynamic picture has been applied directly to the many-body system without being propped up by a KS system."
        },
        {
            "heading": "Orbital functionals",
            "text": "Hydrodynamic methods that are based on xc effects of uniform or slowly-varying electron gases are problematic for finite systems, since they introduce spurious dissipation. A consequence in the linear response regime is that the predicted excitation energies of atoms and molecules attain an unphysical lifetime162. A different direction to incorporate memory and also spatial nonlocality is to develop explicit functionals of the KS orbitals vXC[{\u03d5i}](r, t). Since each orbital itself depends on the density in a spatially and time non-local way, an explicit local functional of the orbital is an\nnpj Computational Materials (2023) 124 Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences\nimplicit non-local functional of the density. Some common orbital functionals are meta-GGAs, which are have semi-local spatial dependence on the orbitals, hybrids incorporating a fraction of exact exchange, and self-interaction corrected LDA; the latter two have non-local spatial dependence from Coulomb integrals between orbitals and so are computationally more expensive. The spatial non-locality enables various properties in TDDFT to be better reproduced for reasons unrelated to memory, e.g., capturing the \u22121/r asymptotic decay of vXC which reclaims the Rydberg series of excitations in the bound spectrum that are otherwise lost in the continuum181, particle-number discontinuities in the xc kernel that are important in capturing chargetransfer excitations182, and ionization62. One advantage of these approaches is that self-interaction error is more easily dealt with, unlike in the hydrodynamic approaches in the section \u201cTimedependent current-density functional theory\u201d. There are two fundamentally different but formally rigorous ways in which to treat orbital functionals. In one, as in KS theory with explicit density-functionals, the xc potential is the same function for all orbitals, and, when the approximation enters through an xc action AXC[{\u03d5i}], possibly on the Keldysh contour169, vXC\u00bdf\u03d5ig \u00f0r; t\u00de \u00bc \u03b4AXC\u00bdf\u03d5ig \u03b4n\u00f0r;t\u00de is obtained through the time-dependent orbital effective potential equations (TDOEP)183. Exact exchange has been computed in this way184\u2013188 primarily in the linear response regime for the computation of excitation energies. For example, for long-range charge-transfer excitations between closed-shell fragments, the importance of derivative discontinuities of the xc kernel with respect to particle number was shown to play a key role, and the exact exchange kernel, due to its orbital dependence captures these, and yields the correct asymptotic behavior of these excitation energies when used in its fully nonadiabatic form182,189,190. A finite derivative discontinuity is related to correcting the self-interaction from the Hartree functional191, and self-interaction corrected LDA has also been applied within TDOEP192. The second way to treat orbital functionals resulting from an action functional (or in the ground-state case an energy functional), is through the so-called generalized KS approach193\u2013195, resulting in orbital-specific xc potentials. This avoids having to solve the numerically challenging TDOEP equation, and is the most common treatment of hybrid functionals where a fraction of Hartree\u2013Fock exchange is mixed in. Hybrid functionals have some advantage in the ground-state in that the delocalization error of semi-local functionals is partially compensated by the localization error of Hartree\u2013Fock196, but perhaps most interesting for TDDFT is that the meaning of the predicted excitations is fundamentally different for the pure KS treatment than for the generalized KS treatment. In the former, excitations are those of the neutral system, while in the latter, they have a character in between neutral and addition (or affinity) energies, depending on the amount of Hartree\u2013Fock mixed in. This has proved particularly useful for charge-transfer excitation energies when range-separated hybrids are used59,190,197\u2013202. However, coming back to the theme of non-adiabaticity, without frequency-dependence, a general treatment of chargetransfer excitations in response and charge-transfer dynamics in real-time, are out of reach for hybrid functionals whether treated in generalized or pure KS. This can be most easily seen with the two-electron example, where ground-state exact exchange and Hartree\u2013Fock exchange coincide, equaling minus half the Hartree potential: a frequency-independent xc kernel cannot properly describe excitations when there are KS determinants lying near the ground-state (also section \u201cSpecific cases\u201d) as in the case of a stretched heteroatomic diatomic molecule203, and the nonadiabatic dynamical steps and peaks mentioned in the section \u201cSignificance of memory-dependence\u201d necessary to achieve the transfer of an electron in real time are missing59,73.\nThere have been far fewer applications of orbital functionals in the nonlinear regime, largely because of the computational expense51,192,204,205. Applying the KLI approximation206 simplifies the TDOEP calculation183,207,208 but becomes problematic because of its violation of the ZFT which can result in unphysical selfexcitation114.\nBootstrapping many-body perturbation theory Noting that the density is the diagonal of the one-body Green\u2019s function in the equal-time limit, an exact integral expression for the time-dependent xc potential can be found through the Dyson equation for the interacting Green\u2019s function when referred to the KS Green\u2019s function209. Taking place on a Keldysh pseudotime contour, this is the time-dependent generalization of the Sham\u2013Schl\u00fcter approach210,211, and connects vXC(r, t) to the twopoint self-energy \u03a3XC\u00f0r; t; r0; t0\u00de of many-body theory. Approximations derived from many-body diagrammatic expansions can thus be transformed into equivalent approximations for the TDDFT xc potential. These often result in orbital functionals with implicit density-dependence (section \u201cOrbital functionals\u201d). The first order in perturbation theory is the Hartree\u2013Fock approximation for \u03a3XC which, through the time-dependent Sham\u2013Schl\u00fcter equation yields the time-dependent exact exchange potential, while higher order perturbation theory introduces correlation. A diagrammatic expansion of the equation using the KS Green\u2019s functions as the bare propagators showed that the spatial nonlocality of the xc kernel is strongly frequency-dependent, and related the longranged divergence at frequencies of excitation energies to the discontinuity of the xc potential212. To ensure that the selection of diagrams respects fundamental conservation laws such as particle number, energy, momentum, and angular momentum conservations, instead a variational formalism similar to many-body perturbation theory213,214 has been developed215. One defines a universal functional of the Green\u2019s function for the non-classical electron interaction, of which the self-energy is the functional derivative. The total action (or energy, in the ground-state case) as a functional of the Green\u2019s function then has its stationary point at the Green\u2019s function that solves the Dyson equation with the consistent self-energy, and restricting the functional domain to that of Green\u2019s functions arising from non-interacting Schr\u00f6dinger equations with local multiplicative potentials, results in a procedure to obtain TDDFT approximations215. The linearized Sham\u2013Schl\u00fcter equation, in which the Green\u2019s function is replaced by the KS Green\u2019s function everywhere, can be derived from such an approach. Other work where TDDFT approximations have been derived from connections with many-body perturbation theory have been within the linear response regime, and largely focussed on nonmetallic extended systems, using Bethe\u2013Salpeter formalism58,137. The latter involves the four-point reducible polarizability which needs to be contracted to the two-point density-response function to relate to TDDFT; we refer the reader to ref. 58 for a review on different ways in which this has been achieved by different groups. In particular, for semiconductors, the exact xc kernel can be considered as a sum of two terms216,217: one that changes the KS band gap to the larger quasiparticle one, and the other that accounts for the electron-hole interaction responsible for excitonic effects. The first term is usually just accounted for by using the quasiparticle gap, without explicitly finding the kernel that opens the gap; non-adiabaticity is needed for the kernel to achieve this (see an argument by Vignale described in ref. 79). For the second term, an expression was derived involving contractions over the quasiparticle polarizability, one-body interacting Green\u2019s function and screened Coulomb interaction, and various approximations considered and tested58,216,218\u2013221. From the point of view of non-adiabaticity, frequency-dependence was shown to arise out of the contractions over spatial indices, even when the\nPublished in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences npj Computational Materials (2023) 124\nmany-body quantities being integrated over are frequencyindependent222. The calculation of the two-particle matrix elements is expensive, and instead the separation has been exploited to define a two-part procedure to calculate accurate optical spectra of semiconductors and insulators from firstprinciples without any empirical parameters and without any calculations or input needed outside TD(C)DFT223: first, a modified KS response function is defined through an implicit kernel that accounts for the derivative discontinuity giving rise to gapopening and second, a polarization functional from TDCDFT is applied for the part of the kernel that captures excitonic effects165. While spatially long-ranged behavior is essential for the latter, time-nonlocality (frequency-dependence) is implicitly contained in the former to open the gap."
        },
        {
            "heading": "Density-matrix coupled approximations",
            "text": "Another approach focusses on building approximations to the one-body and two-body reduced density-matrix (1RDM, 2RDM) that appear in an exact expression for the xc potential, Eq. (7). If the interacting 2RDM could be somehow modeled, it would provide the two ingredients in the exact vXC of Eq. (7) that are not directly accessible from the TDKS evolution, \u03c11 and nXC. A particular class of such approximations, denoted \u201cdensity-matrix coupled approximations\u201d, couples the TDKS equations to the first equation in the BBGKY density-matrix hierarchy67,105. Unlike most of the previously-discussed approaches, this approach respects initial-state dependence in the sense that the xc potentials for identical density evolutions arising from different initial states will differ. The simplest approximation would be to replace \u03c11 and nXC by their KS counterparts69,74,107,109,204,224, an approximation that we dub vSXC. Although v S XC generally approximates the exact v W XC well, the kinetic component vTXC vanishes, but it is the kinetic component that contains the large dynamical step and peak features76 (section \u201cSignificance of memory-dependence\u201d) that are crucial to accurately capture dynamics in a number of situations, e.g., electron scattering74,109, charge-transfer out of a ground state73 (see the example in the section \u201cSignificance of memory-\ndependence\u201d), quasiparticle propagation through a wire225. Ref. 69 explored various \u201cfrozen\u201d approximations, while ref. 67 presented an approach based on coupling the KS evolution to the first equation in the BBGKY hierarchy for the interacting 1RDM; the two equations \u201cpass\u201d back and forth an approximation for a fictitious ~\u03c12 as a functional of the 1RDM evolving from the BBGKY equation and the KS 1RDM evolving from the KS equation. This was shown to capture the dynamical steps and peaks, to satisfy the ZFT and GTI, and be self-interaction-free, however it becomes numerically unstable after too short times to be practical67,105. Whether instead a paradigmatic system can be found from which the interacting 1RDM can be obtained as a functional of KS-accessible quantities remains an open exploration. Even if the choices made so far for the 2RDM have led to a\nnumerically unstable approach, a question is whether they capture non-adiabatic features in the linear response domain related to phenomena such as double excitations. In particular, whether the kernel resulting from the functional derivative of vTC gives an approximation to the pole in the exact kernel77 that is responsible for the interaction of the singly and doubly-excited KS states underlying a state of double-excitation character (section \u201cSpecific cases\u201d). This can be answered by deriving the linear response of the system starting with Eqs. (9) and (8) and transforming to the frequency-domain. In the KS basis, this creates a set of equations to solve to obtain a kernel fHXC(\u03c9) that can be used in Casida equations. Testing this approach on the model studied in ref. 77, a one-dimensional harmonic oscillator with delta-interacting electrons, with the choice of ~\u03c12 as the timedependent KS one, yields mixed results as seen in Fig. 5. A pole does indeed appear in the kernel, showing a strong nonadiabaticity in the matrix element of fHXC associated with the state of double excitation character (upper panel). However, it has the wrong position, sign, and amplitude of the divergence. Moreover, a spurious pole also appears in the matrix element where the physical system only has a single excitation (lower panel). This shows the limitations of using ~\u03c12 \u00bc \u03c12S within the density-matrix coupled scheme.\nFig. 5 Frequency-dependence of the diagonal part of fHXC in a model system (see ref. 77) for the exact (orange) and density-matrix coupled approximation (blue). Upper panel shows the matrix element corresponding to a single excitation that couples to a double excitation, leading to a pole in the exact fHXC. Lower panel the matrix element corresponding to an uncoupled single excitation in the exact system.\nnpj Computational Materials (2023) 124 Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences\nSpecific cases While the previous sections propose universal xc functional approximations with memory, there have also been approximations derived for specific cases where memory is known to be important. We briefly mention some of these here. As just discussed, the adiabatic approximation in linear response is unable to capture states with double excitation character45,46,77,138,190,226\u2013230. These states can enter the spectrum even at low energies, e.g., in conjugated polyenes where they mix with the single excitations46, and they are typically sprinkled throughout the spectrum in geometries away from equilibrium. This poses a problem for the general reliability of TDDFT predictions of photoinduced dynamics where nuclei are driven to sample a range of configurations due to their coupling to the electronic motion. Inspired by the form of the exact xc kernel when a double excitation lies near a (group of) single excitation, ref. 77 derived a frequency-dependent approximation to be applied for this case. This \u201cdressed\u201d kernel has a pole in a frequency-range near the double excitation, and gave reasonable predictions for these states in a range of molecules46,231,232. In a related spirit, a frequency-dependent quadratic response kernel was recently derived in ref. 233, which cures unphysical divergences arising in adiabatic TDDFT when the difference between two excitation energies equals another one234. A non-adiabatic approximation was derived for the singleimpurity Anderson model95,235, capturing the dynamical step feature missing in the adiabatic approximation, and applied to quantum transport. This functional depended only on the site occupation and its first time-derivative. Going from approximations on a lattice to real-space systems however is highly nontrivial: as mentioned in the section \u201cSignificance of memorydependence\u201d even the basic theorems and v-representability issues are distinct on a lattice than in real-space, and whether the former can be consistently converged to the latter is unclear. Focussing on models where the ground-state is stronglycorrelated, refs. 236,237 derived an xc functional approximation for the xc kernel of Hubbard model systems from dynamical mean field theory; these could be applied to a real system with Hubbard parameters chosen somehow from experiment. The non-adiabatic part of the resulting kernel is completely local in space but has memory-dependence, placing it at risk of violating the zero force and Galilean invariance principles discussed earlier."
        },
        {
            "heading": "OUTLOOK",
            "text": "This review has focussed on non-adiabatic approximations to the xc potential or kernel, but other ingredients needed in TDDFT are functionals for the observables when the observables are not directly related to the density itself. For example, ionization probabilities42, momentum-distributions43, even simply the current-density whose rotational component is not generally reproduced by the TDKS system even if an exact xc functional is used75,79,121,123,124. Usually these observables are extracted simply by taking expectation values of their usual operators in the KS state, which inherently entails an approximation additional to that of the xc functional. Corrections to such observable-functionals and their memory-dependent properties are largely unexplored. The studies in the past years on the exact xc potential and its properties, and the different efforts in development of memorydependent functionals summarized here show that the search for an accurate and practical non-adiabatic approximation is a challenging one. The search is on-going and creative: several recent new directions not mentioned yet in this review have been proposed for time-dependent functional development which are still at a very preliminary stage, including coupling-constant integral transforms105,184, re-casting TDDFT using the second-time-derivative of the density as basic variable238, and extensions of the connector\ntheory approach138,239 to the time-domain. Whether one of these will yield an elixir remains to be seen, but even if not, they reveal interesting physics about the dynamics of electron correlation."
        },
        {
            "heading": "DATA AVAILABILITY",
            "text": "The data that support the findings of this study are available from the corresponding author upon reasonable request.\nReceived: 7 February 2023; Accepted: 9 June 2023;"
        },
        {
            "heading": "ACKNOWLEDGEMENTS",
            "text": "Financial support from the National Science Foundation Award CHE-2154829 (N.T.M.) and from the Department of Energy, Office of Basic Energy Sciences, Division of Chemical Sciences, Geosciences and Biosciences under Award No. DESC0020044, and the European Union\u2019s Horizon 2020 research and innovation programme under the Marie Sk\u0142odowska-Curie grant agreement No. 101030447 (L.L.) are gratefully acknowledged."
        },
        {
            "heading": "AUTHOR CONTRIBUTIONS",
            "text": "N.T.M. conceived the project, summarized the literature, and wrote the majority of the manuscript. L.L. performed the calculations, analyzed the results, co-wrote sections \u201cSignificance of memory-dependence\u201d and \u201cDensity-matrix coupled approximations\u201d and contributed to the writing of all sections. Both authors reviewed and edited the manuscript.\nCOMPETING INTERESTS The authors declare no competing interests.\nADDITIONAL INFORMATION Correspondence and requests for materials should be addressed to Neepa T. Maitra.\nReprints and permission information is available at http://www.nature.com/ reprints\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing,\nadaptation, distribution and reproduction in anymedium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http:// creativecommons.org/licenses/by/4.0/.\n\u00a9 The Author(s) 2023\nPublished in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences npj Computational Materials (2023) 124"
        }
    ],
    "title": "Non-adiabatic approximations in time-dependent density functional theory: progress and prospects",
    "year": 2023
}