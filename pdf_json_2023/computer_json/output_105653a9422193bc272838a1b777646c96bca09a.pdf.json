{
    "abstractText": "This paper extends the unified observer design problem to the class of Nonlinear Parameter Varying (NLPV) systems with parameter dependence in both the dynamics and the control input matrices. First, parameterization of the observer matrices, herein generalized for the NLPV case, allows us to decouple the input disturbance from the estimation error. Then, the vanishing disturbance caused by the nonlinearity is bounded by the Lipschitz property and the effect of measurement noise on the error is minimized using the generalized H2 condition. Both objectives are combined into a single framework thanks to the S-procedure. Furthermore, the asymptotic stability of the error is tackled using a parameter-dependent Lyapunov function, then a grid-based Linear Matrix Inequalities (LMIs) solution is provided, which reduces conservatism. The efficiency of this observer is illustrated and compared with an LPV observer through the damper force estimation problem, a crucial topic in semi-active suspensions.",
    "authors": [
        {
            "affiliations": [],
            "name": "Gia Quoc Bao Tran"
        },
        {
            "affiliations": [],
            "name": "Olivier Sename"
        }
    ],
    "id": "SP:5b8a4a1b54c2b18abcdc02c07577a958206c0498",
    "references": [
        {
            "authors": [
                "J. Mohammadpour",
                "C.W. Scherer"
            ],
            "title": "Control of Linear Parameter Varying Systems with Applications",
            "venue": "Springer Science & Business Media,",
            "year": 2012
        },
        {
            "authors": [
                "O. Sename",
                "D. Rotondo"
            ],
            "title": "Emerging Approaches for Nonlinear Parameter Varying Systems",
            "venue": "International Journal of Robust and Nonlinear Control, vol. 31, no. 17, pp. 8121\u20138123, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "T.-P. Pham",
                "O. Sename",
                "L. Dugard"
            ],
            "title": "A Nonlinear Parameter Varying Observer for Real-time Damper Force Estimation of an Automotive Electro-rheological Suspension System",
            "venue": "International Journal of Robust and Nonlinear Control, vol. 31, no. 17, pp. 8183\u20138205, 06 2021.",
            "year": 2021
        },
        {
            "authors": [
                "G.O. Gordillo",
                "M. Darouach",
                "C.M. Astorga-Zaragoza",
                "L. Boutat- Baddas"
            ],
            "title": "Generalized Dynamic Observer Design for Lipschitz Nonlinear Descriptor Systems",
            "venue": "IET Control Theory and Applications, vol. 13, no. 14, pp. 2270\u20132280, Sept. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "M.-H. Do",
                "D. Koenig",
                "D. Theilliol"
            ],
            "title": "H\u221e Observer Design for Singular Nonlinear Parameter-varying System",
            "venue": "2020 59th IEEE Conference on Decision and Control (CDC), 2020, pp. 3927\u20133932.",
            "year": 2020
        },
        {
            "authors": [
                "Y. Wang",
                "R. Rajamani",
                "D.M. Bevly"
            ],
            "title": "Observer Design for Parameter Varying Differentiable Nonlinear Systems, With Application to Slip Angle Estimation",
            "venue": "IEEE Transactions on Automatic Control, vol. 62, no. 4, pp. 1940\u20131945, 2017.",
            "year": 1940
        },
        {
            "authors": [
                "A. P\u00e9rez-Estrada",
                "G.-L. Osorio-Gordillo",
                "M. Alma",
                "M. Darouach",
                "V. Olivares Peregrino"
            ],
            "title": "H\u221e Generalized Dynamic Unknown Inputs Observer Design for Discrete LPV Systems. Application to Wind Turbine",
            "venue": "European Journal of Control, 09 2018.",
            "year": 2018
        },
        {
            "authors": [
                "A.J. Perez-Estrada",
                "G.L. Osorio Gordillo",
                "M. Alma",
                "M. Darouach",
                "V.H. Olivares-Peregrino"
            ],
            "title": "Generalized Dynamic Observers for quasi- LPV Systems with Unmeasurable Scheduling Functions",
            "venue": "International Journal of Robust and Nonlinear Control, vol. 28, no. 17, pp. 5262\u2013 5278, Nov. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "N. Gao",
                "M. Darouach",
                "H. Voos",
                "M. Alma"
            ],
            "title": "New Unified H\u221e Dynamic Observer Design for Linear Systems with Unknown Inputs",
            "venue": "Automatica, vol. 65, pp. 43\u201352, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "T.-P. Pham",
                "O. Sename",
                "L. Dugard"
            ],
            "title": "Unified H\u221e Observer for a Class of Nonlinear Lipschitz Systems: Application to a Real ER Automotive Suspension",
            "venue": "IEEE Control Systems Letters, vol. 3, no. 4, pp. 817\u2013822, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "G.Q.B. Tran",
                "T.-P. Pham",
                "O. Sename"
            ],
            "title": "Multi-objective Unified qLPV Observer: Application to a Semi-active Suspension System",
            "venue": "IFAC-PapersOnLine, vol. 54, no. 8, pp. 136\u2013141, 2021, 4th IFAC Workshop on Linear Parameter Varying Systems.",
            "year": 2021
        },
        {
            "authors": [
                "R. Rajamani",
                "W. Jeon",
                "H. Movahedi",
                "A. Zemouche"
            ],
            "title": "On the Need for Switched-gain Observers for Non-monotonic Nonlinear Systems",
            "venue": "Automatica, vol. 114, p. 108814, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "A. Zemouche",
                "M. Boutayeb"
            ],
            "title": "On LMI Conditions to Design Observers for Lipschitz Nonlinear Systems",
            "venue": "Automatica, vol. 49, no. 2, pp. 585\u2013591, 2013.",
            "year": 2013
        },
        {
            "authors": [
                "D. Koenig"
            ],
            "title": "Observers Design for Unknown Input Nonlinear Descriptor Systems via Convex Optimization",
            "venue": "IEEE Transactions on Automatic Control, vol. AC-51, no. 06, pp. 1047\u20131052, June 2006.",
            "year": 2006
        },
        {
            "authors": [
                "M. Darouach",
                "L. Boutat-Baddas",
                "M. Zerrougui"
            ],
            "title": "H\u221e Observers Design for a Class of Nonlinear Singular Systems",
            "venue": "Automatica, vol. 47, pp. 2517\u20132525, 2011.",
            "year": 2011
        },
        {
            "authors": [
                "F. Nemati",
                "S.M.S. Hamami",
                "A. Zemouche"
            ],
            "title": "A Nonlinear Observerbased Approach to Fault Detection, Isolation and Estimation for Satellite Formation Flight Application",
            "venue": "Automatica, vol. 107, pp. 474\u2013482, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "F. Wu"
            ],
            "title": "Control of Linear Parameter Varying Systems",
            "venue": "Ph.D. dissertation, University of California, Berkeley, 1995.",
            "year": 1995
        },
        {
            "authors": [
                "T.-P. Pham",
                "O. Sename",
                "L. Dugard",
                "V.T. Vu"
            ],
            "title": "LPV Force Observer Design and Experimental Validation from a Dynamical Semi-active ER Damper Model",
            "venue": "IFAC-PapersOnLine, vol. 52, no. 17, pp. 60\u201365, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "G. Phanomchoeng",
                "R. Rajamani"
            ],
            "title": "Observer Design for Lipschitz Nonlinear Systems using Riccati Equations",
            "venue": "Proceedings of the 2010 American Control Conference, 2010, pp. 6060\u20136065.",
            "year": 2010
        },
        {
            "authors": [
                "A. Zemouche",
                "M. Boutayeb"
            ],
            "title": "On LMI Conditions to Design Observers for Lipschitz Nonlinear Systems",
            "venue": "Automatica, vol. 49, p. 585\u2013591, 02 2013.",
            "year": 2013
        },
        {
            "authors": [
                "S. Savaresi",
                "C. Poussot-Vassal",
                "C. Spelta",
                "O. Sename",
                "L. Dugard"
            ],
            "title": "Semi-Active Suspension Control for Vehicles",
            "year": 2010
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014Nonlinear parameter varying systems, observers, suspension systems.\nI. INTRODUCTION\nIT has been known from the literature that under par-ticular conditions and assumptions, the Linear Parameter Varying (LPV) representation of a nonlinear system is interesting thanks to its linear-like stability analysis and controller/observer design, including as well the H\u221e and/or generalized H2 (gH2) performance criteria [1].\nHowever, \u201clinearizing\u201d nonlinear systems using the LPV language, known as the quasi-LPV representation, comes with the cost of reducing the generality of the system representation. Recall that to be assigned as a scheduling parameter, a (nonlinear) function of the state x must be known or estimated and bounded at least in the region where x remains. This condition, even if it can be satisfied, would certainly increase conservatism. Often, by strategically choosing to maintain a certain level of nonlinearity in the system representation (rather than render it linear thanks to the LPV technique), we can benefit from interesting properties of nonlinear functions, e.g., Lipschitz conditions, which reduce conservatism and lead to more realistic results.\nThis idea leads to the so-called Nonlinear Parameter Varying (NLPV) class of systems that has emerged as a potential\nGia Quoc Bao Tran was with Univ. Grenoble Alpes, CNRS, Grenoble INP, GIPSA-Lab, 38000 Grenoble, France. He is now with Centre Automatique et Syste\u0300mes (CAS), Mines Paris, Universite\u0301 PSL, 75006 Paris, France (e-mail: gia-quoc-bao.tran@minesparis.psl.eu).\nThanh-Phong Pham is with the University of Danang\u2014University of Technology and Education, 550000 Danang, Vietnam (e-mail: ptphong@ute.udn.vn).\nOlivier Sename is with Univ. Grenoble Alpes, CNRS, Grenoble INP, GIPSA-Lab, 38000 Grenoble, France (e-mail: olivier.sename@grenobleinp.fr).\nThis research is funded by Funds for Science and Technology Development of the University of Danang under project number B2020-DN06-21.\nresearch trend in the LPV community [2]. In the literature, the observers of this new class take various structures, from the classical form [3], the descriptor form [4], [5] to the two-DOF [6] or the generalized one [7], [8]. The main objective of this work is to extend the unified formulation of unknown input observers [9], [10] for NLPV systems. Such unified observers are indeed interesting since they provide a general parameterization of a set of observers while ensuring the decoupling of the input disturbance or its minimization through the H\u221e condition. Here, the effect of the system\u2019s nonlinearity on the estimation error is still considered and bounded by the Lipschitz condition, thus decreasing conservatism compared to merely bounding it by a constant such as in [11]. This condition has also been well studied for nonlinear observer design such as [12], [13], [14], [15], or [16].\nIn this paper, we propose a unified gH2 observer to the state estimation problem for a class of NLPV systems including a Lipschitz nonlinearity, where the state and input matrices do depend on the parameter vector. The solution is obtained by solving a set of Linear Matrix Inequalities (LMIs). Our main contributions are as follows:\n\u2022 Observer parameterization is generalized from the timeinvariant case [10] into a parameter-dependent form (as in Section III), maximizing the adaptability of the scheduled observer with respect to the system\u2019s variation. This generalization also allows us to have parameter dependence even in the system\u2019s dynamics matrix (as in (1)); \u2022 Compared to [8] where the authors assumed the existence of constant arbitrary matrices satisfying all the rank conditions and where the problem was solved using a polytopic approach, which can be overly conservative, parameter-dependent arbitrary matrices and the gridbased methodology [17] are used instead throughout this work, for which these rank conditions are assumed almost everywhere but verified at the grid points only; \u2022 The gH2 condition is used to minimize the effects of the measurement noise on the estimation error whereas it was the H\u221e condition in [10]. As sensor noise usually appears in the high-frequency domain, the gH2 norm is more effective to handle this issue; \u2022 For illustration, the method is applied for damper force estimation in vehicle semi-active (SA) suspensions with the nonlinear model in [18] and compared with the LPV observer there, in both the frequency and time domains.\nThis paper is outlined as follows. In Section II, the observer design problem is formulated. Section III presents the observer parameterization. The design method is detailed in Section IV. The application is illustrated in Section V. Finally, the conclusion is drawn in Section VI.\nNotations. Let w (resp. w) denote the minimum (resp. maximum) value of the variable w. Let W\u22a4 be the transpose of the matrix W and W+ be its Moore-Penrose inverse. Last, let W\u22121 denote the inverse of the invertible square matrix W ."
        },
        {
            "heading": "II. PROBLEM FORMULATION",
            "text": "Consider an NLPV system of the form{ x\u0307 = A(\u03c1)x+B(\u03c1)\u03a6(x, u) +D1\u03c9r\ny = Cx+D2\u03c9n, (1)\nwhere x \u2208 Rnx is the state; u \u2208 Rnu is the control input; \u03c9r \u2208 Rnr is the unknown input disturbance; \u03c9n \u2208 Rnn is the measurement noise; y \u2208 Rny is the measured output; \u03c1 \u2208 Rn\u03c1 is the vector of continuous-time varying parameters. As usually assumed for LPV systems, \u03c1 is known and bounded, i.e., \u03c1 \u2208 [\u03c1, \u03c1] element-wise; all matrices A(\u03c1), B(\u03c1), D1, C, and D2 are known and defined (continuous) for any value of \u03c1 \u2208 [\u03c1, \u03c1]. As input disturbance and measurement noise usually enter NLPV systems through constant matrices, without loss of generality, we consider D1 and D2 to be constant. The control input is always bounded, i.e., u \u2208 [u, u] element-wise.\nAssumption 1: The map \u03a6 : Rnx \u00d7Rnu \u2192 Rn\u03a6 (where n\u03a6 is the dimension of the codomain of \u03a6) is globally Lipschitz over the set of the state vector x [19], [20], i.e.,\n\u2225\u03a6(x, u)\u2212\u03a6(x\u0302, u)\u2225\u2264 \u2225\u0393(x\u2212 x\u0302)\u2225,\u2200(x, x\u0302) \u2208 Rnx \u00d7Rnx , (2)\nwhere \u0393 is the known Lipschitz constant matrix that is defined and computed assuming a bounded input u \u2208 [u, u]. For the interested readers, the even more general case where \u03a6 is only locally Lipschitz is analyzed later in Remark 4.\nConsider a self-scheduled NLPV observer of the form z\u0307 = N(\u03c1)z + J(\u03c1)y +H(\u03c1)\u03a6(x\u0302, u) +M(\u03c1)v v\u0307 = P (\u03c1)z +Q(\u03c1)y +G(\u03c1)v\nx\u0302 = R(\u03c1)z + S(\u03c1)y,\n(3)\nwhere x\u0302 \u2208 Rnx is the estimated state and z, v \u2208 Rnx are the state and auxiliary vectors of the observer. By designing the observer, we determine all the parameter-dependent matrices N(\u03c1), J(\u03c1), H(\u03c1), M(\u03c1), P (\u03c1), Q(\u03c1), G(\u03c1), R(\u03c1), and S(\u03c1) such that all the conditions related to decoupling the bounded unknown input disturbance and minimizing the effects of random measurement noise on the estimation error (under Assumption 1) detailed later are satisfied.\nDefine the dynamic error as \u03f5 = z \u2212 T (\u03c1)x \u2208 Rnx , where T (\u03c1) \u2208 Rnx\u00d7nx is a parameter-dependent arbitrary matrix. Differentiating \u03f5 with respect to time, using (1) and (3), and denoting \u03b6 = (\u03f5 v)\u22a4 \u2208 R2nx , we obtain \u03b6\u0307 = ( N(\u03c1) M(\u03c1) P (\u03c1) G(\u03c1) ) \u03b6 + ( H(\u03c1)\u2212 T (\u03c1)B(\u03c1) 0 ) \u03a6(x\u0302, u) + ( T (\u03c1)D1 0 ) \u03c9r + ( N(\u03c1)T (\u03c1)\u2212 T (\u03c1)A(\u03c1) + J(\u03c1)C P (\u03c1)T (\u03c1) +Q(\u03c1)C ) x + ( \u2212T (\u03c1)B(\u03c1) 0 ) \u2206\u03a6+ ( J(\u03c1)D2 Q(\u03c1)D2 ) \u03c9n x\u0302 = ( R(\u03c1) 0 ) \u03b6 + (R(\u03c1)T (\u03c1) + S(\u03c1)C)x+ S(\u03c1)D2\u03c9n,\n(4) where \u2206\u03a6 = \u03a6(x, u)\u2212 \u03a6(x\u0302, u) satisfies (2).\nIf the algebraic conditions\nN(\u03c1)T (\u03c1)\u2212 T (\u03c1)A(\u03c1) + J(\u03c1)C = 0, (5) T (\u03c1)D1 = 0, (6)\nH(\u03c1)\u2212 T (\u03c1)B(\u03c1) = 0, (7) P (\u03c1)T (\u03c1) +Q(\u03c1)C = 0, (8) R(\u03c1)T (\u03c1) + S(\u03c1)C = I, (9)\nare satisfied for all \u03c1 \u2208 [\u03c1, \u03c1], the system in (4) is reduced to \u03b6\u0307 = ( N(\u03c1) M(\u03c1) P (\u03c1) G(\u03c1) ) \u03b6 + ( \u2212T (\u03c1)B(\u03c1) 0 ) \u2206\u03a6 + ( J(\u03c1)D2 Q(\u03c1)D2 ) \u03c9n e = ( R(\u03c1) 0 ) \u03b6 + S(\u03c1)D2\u03c9n, (10)\nwhere e = x\u0302 \u2212 x is the estimation error. It is worth noting from (10) that the disturbance \u03c9r has been decoupled from the error e.\nThe observer design problem is, therefore, under Assumption 1, to find the matrices N(\u03c1), J(\u03c1), H(\u03c1), M(\u03c1), P (\u03c1), Q(\u03c1), G(\u03c1), R(\u03c1), and S(\u03c1) of the observer (3) such that\n\u2022 The system (10) is asymptotically stable for \u03c9n(t) = 0; \u2022 \u2225e(t)\u2225\u221e < \u03b3\u2225\u03c9n(t)\u22252 for \u03c9n(t) \u0338= 0; \u03b3 is minimized."
        },
        {
            "heading": "III. OBSERVER PARAMETERIZATION",
            "text": "It is worth noting that solving equations (5)-(9) with parameter variations is not an easy task. In this Section, the grid-based methodology is used for observer parameterization, which means the algebraic and rank conditions are assumed almost everywhere but checked only at the (high enough number) of frozen values (detailed in Remark 2). Therefore, \u03c1 will be considered here only at these grid points. This means, when there is no confusion, \u03c1 denotes its frozen values at Ng grid points in a finite set of values in [\u03c1, \u03c1].\nIn order to determine the observer matrices N(\u03c1), J(\u03c1), H(\u03c1), M(\u03c1), P (\u03c1), Q(\u03c1), G(\u03c1), R(\u03c1), and S(\u03c1) satisfying all the conditions (5)-(9), parameterization [9], [10] is performed using the general solution of (5)-(9).\nFirst, (8) and (9) are rewritten as( P (\u03c1) Q(\u03c1) R(\u03c1) S(\u03c1) )( T (\u03c1) C ) = ( 0 I ) . (11)\nNote that (11) is solvable if and only if\nrank ( T (\u03c1) C 0 I )\u22a4 =\nrank ( T (\u03c1) C )\u22a4 = nx,\u2200\u03c1 \u2208 [\u03c1, \u03c1]. (12)\nLet E(\u03c1) \u2208 Rnx\u00d7nx be a full row rank parameter-dependent arbitrary matrix such that\nrank ( E(\u03c1) C )\u22a4 = rank ( T (\u03c1) C )\u22a4 = nx,\u2200\u03c1 \u2208 [\u03c1, \u03c1].\n(13) Then, there always exists a parameter matrix K(\u03c1) such that( T (\u03c1) C ) = ( I \u2212K(\u03c1) 0 I )( E(\u03c1) C\n) \u21d0\u21d2 T (\u03c1) = E(\u03c1)\u2212K(\u03c1)C. (14)\nAs a result, (11) becomes( P (\u03c1) Q(\u03c1) R(\u03c1) S(\u03c1) )( I \u2212K(\u03c1) 0 I )( E(\u03c1) C ) = ( 0 I ) ,\nwhose exact solution is( P (\u03c1) Q(\u03c1) R(\u03c1) S(\u03c1) ) = ( ( 0 I ) \u03a3+(\u03c1)\n\u2212 Ym(\u03c1)(I \u2212 \u03a3(\u03c1)\u03a3+(\u03c1))) ( I K(\u03c1) 0 I ) ,\nwhere \u03a3(\u03c1) = ( E(\u03c1) C ) and Ym(\u03c1) is a free matrix of appropriate dimension. This is equivalent to\nP (\u03c1) = \u2212Ym1(\u03c1)\u03b21(\u03c1), Q(\u03c1) = \u2212Ym1(\u03c1)\u03b22(\u03c1), R(\u03c1) = \u03b11(\u03c1)\u2212 Ym2(\u03c1)\u03b21(\u03c1), S(\u03c1) = \u03b12(\u03c1)\u2212 Ym2(\u03c1)\u03b22(\u03c1),\n(15)\nwhere Ym1(\u03c1) = ( I 0 ) Ym(\u03c1), Ym2(\u03c1) = ( 0 I ) Ym(\u03c1),\n\u03b11(\u03c1) = \u03a3 +(\u03c1) ( I 0 ) , \u03b12(\u03c1) = \u03a3+(\u03c1) ( K(\u03c1) I ) ,\n\u03b21(\u03c1) = (I \u2212 \u03a3(\u03c1)\u03a3+(\u03c1)) ( I 0 ) , and \u03b22(\u03c1) =\n(I \u2212 \u03a3(\u03c1)\u03a3+(\u03c1)) ( K(\u03c1) I ) .\nNext, from (6) and (14), we obtain\nK(\u03c1)CD1 = E(\u03c1)D1, (16)\nwhich is solvable if and only if\nrank ( E(\u03c1)D1 CD1 ) = rank( ( E(\u03c1) C ) D1)\n= rankD1 = rank(CD1),\u2200\u03c1 \u2208 [\u03c1, \u03c1], (17)\nand then the exact solution of (16) is\nK(\u03c1) = E(\u03c1)D1(CD1) +.\nFrom (7), one obtains\nH(\u03c1) = T (\u03c1)B(\u03c1) = (E(\u03c1)\u2212K(\u03c1)C)B(\u03c1) = (E(\u03c1)\u2212 E(\u03c1)D1(CD1)+C)B(\u03c1). (18)\nThen, substituting (14) into (5), we obtain\nN(\u03c1)(E(\u03c1)\u2212K(\u03c1)C)\u2212(E(\u03c1)\u2212K(\u03c1)C)A(\u03c1)+J(\u03c1)C = 0 \u21d0\u21d2 ( N(\u03c1) J(\u03c1)\u2212N(\u03c1)K(\u03c1) ) \u03a3(\u03c1)\n= (E(\u03c1)\u2212 E(\u03c1)D1(CD1)+C)A(\u03c1),\nwhich can be parameterized as( N(\u03c1) K1(\u03c1) ) \u03a3(\u03c1) = \u0398(\u03c1), (19)\nwhere\nK1(\u03c1) = J(\u03c1)\u2212N(\u03c1)K(\u03c1), \u0398(\u03c1) = (E(\u03c1)\u2212 E(\u03c1)D1(CD1)+C)A(\u03c1),\n(20)\nand the solution of (19) is given by( N(\u03c1) K1(\u03c1) ) = \u0398(\u03c1)\u03a3+(\u03c1)\u2212 Ym3(\u03c1)(I \u2212 \u03a3(\u03c1)\u03a3+(\u03c1)),\nwhich is equivalent to\nN(\u03c1) = \u03b13(\u03c1)\u2212 Ym3(\u03c1)\u03b21, K1(\u03c1) = \u03b14(\u03c1)\u2212 Ym3(\u03c1)\u03b23(\u03c1),\n(21)\nwhere Ym3(\u03c1) is a free matrix of appropriate dimension,\n\u03b13(\u03c1) = \u0398(\u03c1)\u03a3 +(\u03c1) ( I 0 ) , \u03b14(\u03c1) = \u0398(\u03c1)\u03a3+(\u03c1) ( 0 I ) , and\n\u03b23(\u03c1) = (I \u2212 \u03a3(\u03c1)\u03a3+(\u03c1)) ( 0 I ) .\nRemark 1: If P (\u03c1), Q(\u03c1), R(\u03c1), S(\u03c1), H(\u03c1), N(\u03c1), and J(\u03c1) can be chosen according to (15), (18), (21), and (20), respectively, then all the decoupling conditions (5)-(9) are satisfied. As a result, the system (4) is rewritten as (10) and the disturbance \u03c9r is effectively decoupled from the error e.\nRemark 2: All the rank conditions in this Section, namely (12), (13), and (17), are assumed for almost all parameter values. The set of values of \u03c1 that violate these, if any, must be strictly finite and isolated. As a result, these conditions are satisfied for all the grid points used for observer design.\nAfter parameterization, the error system (10) is rewritten as{ \u03b6\u0307 = A(\u03c1)\u03b6 +W(\u03c1)\u2206\u03a6 + B(\u03c1)\u03c9n e = C(\u03c1)\u03b6 + D(\u03c1)\u03c9n, (22)\nwhere, from the results of the parameterization above: A(\u03c1) = ( N(\u03c1) M(\u03c1) P (\u03c1) G(\u03c1) ) = A1(\u03c1)\u2212 Z(\u03c1)A2(\u03c1),\nW(\u03c1) = ( \u2212T (\u03c1)B(\u03c1)\n0\n) ,\nB(\u03c1) = ( J(\u03c1)D2 Q(\u03c1)D2 ) = B1(\u03c1)\u2212 Z(\u03c1)B2(\u03c1),\nC(\u03c1) = ( R(\u03c1) 0 ) = ( \u03b11(\u03c1)\u2212 Ym2(\u03c1)\u03b21(\u03c1) 0 ) , D(\u03c1) = S(\u03c1)D2 = (\u03b12(\u03c1)\u2212 Ym2(\u03c1)\u03b22(\u03c1))D2,\nwhere A1(\u03c1) = ( \u03b13(\u03c1) 0 0 0 ) , A2(\u03c1) = ( \u03b21(\u03c1) 0 0 \u2212I ) ,\nB1(\u03c1) = \u0398(\u03c1)\u03a3+(\u03c1)(K(\u03c1)Iny ) D2\n0\n, B2(\u03c1) = (\u03b22(\u03c1)D20 ) ,\nand Z(\u03c1) = ( Ym3(\u03c1) M(\u03c1) Ym1(\u03c1) G(\u03c1) ) .\nAll the matrices A1(\u03c1), A2(\u03c1), W(\u03c1), B1(\u03c1), B2(\u03c1), C(\u03c1), and D(\u03c1) are known and computing all the observer matrices reduces to finding Z(\u03c1), which is discussed in Section IV."
        },
        {
            "heading": "IV. OBSERVER DESIGN",
            "text": "Following the problem formulation in Section II, with \u2206\u03a6 bounded by Assumption 1, the observer design problem is now to find Z(\u03c1) such that\n\u2022 The system (22) is asymptotically stable for \u03c9n(t) = 0; \u2022 \u2225e(t)\u2225\u221e < \u03b3\u2225\u03c9n(t)\u22252 for \u03c9n(t) \u0338= 0; \u03b3 is minimized. First, to apply the gH2 condition, the parameterized error system has to be strictly proper, i.e., D(\u03c1) = 0,\u2200\u03c1 \u2208 [\u03c1, \u03c1]. We can then choose Ym2(\u03c1) for example as\nYm2(\u03c1) = (\u03b12(\u03c1)D2)(\u03b22(\u03c1)D2) +. (23)\nConsequently, we have C(\u03c1) =( \u03b11(\u03c1)\u2212 (\u03b12(\u03c1)D2)(\u03b22(\u03c1)D2)+\u03b21(\u03c1) 0 ) .\nNow, since a parameter-dependent Lyapunov function is used later in this Section for the stability proof, Assumption 2 is added for the scheduling parameter derivative.\nAssumption 2: The scheduling parameter\u2019s time derivative is bounded, i.e., there are constants \u03bdi such that |\u03c1\u0307i|\u2264 \u03bdi, i = 1, 2, . . . , n\u03c1.\nBased on Theorem 1, the observer design problem is then solved using LMIs.\nTheorem 1: Under Assumptions 1 and 2, the observer design problem is solved if there exist matrices X(\u03c1) = X\u22a4(\u03c1) > 0, Y (\u03c1), and a scalar \u03b5l > 0 minimizing \u03b3 and satisfying for all \u03c1 \u2208 [\u03c1, \u03c1], the set of LMIs\u212611a(\u03c1) + \u03b5lC\u22a4(\u03c1)\u0393\u22a4\u0393C(\u03c1) X(\u03c1)W(\u03c1) \u212613(\u03c1)W\u22a4(\u03c1)X(\u03c1) \u2212\u03b5lI 0\n\u2126\u22a413(\u03c1) 0 \u2212I  < 0, ( X(\u03c1) I I \u03b32I ) > 0,\nwhere \u212611a(\u03c1) = A\u22a41 (\u03c1)X(\u03c1)+X(\u03c1)A1(\u03c1)\u2212A\u22a42 (\u03c1)Y \u22a4(\u03c1)\u2212 Y (\u03c1)A2(\u03c1) \u00b1 \u2211n\u03c1 i=1 \u03bdi \u2202X(\u03c1) \u2202\u03c1i\nand \u212613(\u03c1) = X(\u03c1)B1(\u03c1) \u2212 Y (\u03c1)B2(\u03c1). Then, Z(\u03c1) = X\u22121(\u03c1)Y (\u03c1).\nProof: Considering the parameter-dependent Lyapunov function candidate V (e, \u03c1) = e\u22a4X(\u03c1)e where X(\u03c1) = X\u22a4(\u03c1) > 0, we denote \u03b7 = ( e \u2206\u03a6 \u03c9n )\u22a4 and derive\nV\u0307 (e, \u03c1) = e\u0307\u22a4X(\u03c1)e+ e\u22a4X(\u03c1)e\u0307+ e\u22a4 ( n\u03c1\u2211 i=1 \u03c1\u0307i \u2202X(\u03c1) \u2202\u03c1i ) e\n= e\u22a4 [ A\u22a4(\u03c1)X(\u03c1) +X(\u03c1)A(\u03c1) + n\u03c1\u2211 i=1 \u03c1\u0307i \u2202X(\u03c1) \u2202\u03c1i ] e\n+ e\u22a4X(\u03c1)W(\u03c1)\u2206\u03a6 +\u2206\u03a6\u22a4W\u22a4(\u03c1)X(\u03c1)e + e\u22a4X(\u03c1)B(\u03c1)\u03c9n + \u03c9\u22a4n B\u22a4(\u03c1)X(\u03c1)e\n= \u03b7\u22a4  \u212611b(\u03c1) X(\u03c1)W(\u03c1) \u212613(\u03c1)W\u22a4(\u03c1)X(\u03c1) 0 0 \u2126\u22a413(\u03c1) 0 0  \u03b7 := \u03b7\u22a4Q1(\u03c1)\u03b7,\nwhere, by using A(\u03c1) = A1(\u03c1) \u2212 Z(\u03c1)A2(\u03c1) and B(\u03c1) = B1(\u03c1)\u2212Z(\u03c1)B2(\u03c1) then introducing the intermediate variable Y (\u03c1) = X(\u03c1)Z(\u03c1), we obtain \u212611b(\u03c1) = A\u22a41 (\u03c1)X(\u03c1) + X(\u03c1)A1(\u03c1)\u2212A\u22a42 (\u03c1)Y \u22a4(\u03c1)\u2212Y (\u03c1)A2(\u03c1)+ \u2211n\u03c1 i=1 \u03c1\u0307i \u2202X(\u03c1) \u2202\u03c1i\nand \u212613(\u03c1) = X(\u03c1)B1(\u03c1)\u2212 Y (\u03c1)B2(\u03c1).\nFrom Assumption 1, the Lipschitz condition (2) gives\n\u2206\u03a6\u22a4\u2206\u03a6 \u2264 e\u22a4C\u22a4(\u03c1)\u0393\u22a4\u0393C(\u03c1)e. (24)\nThis condition (independent of \u03c9n) is then rewritten as\n\u03b7\u22a4Q2(\u03c1)\u03b7 \u2264 0, (25)\nwhere Q2(\u03c1) = \u2212C\u22a4(\u03c1)\u0393\u22a4\u0393C(\u03c1) 0 00 I 0 0 0 0 . Now, define the following terms\nJ1 = \u2212\u03c9\u22a4n \u03c9n = \u03b7\u22a4 0 0 00 0 0 0 0 \u2212I  \u03b7 := \u03b7\u22a4Q3\u03b7, J2(\u03c1) = \u03b3 2 2e\n\u22a4X(\u03c1)e\u2212 e\u22a4e = e\u22a4 (\u03b32X(\u03c1)\u2212 I)\ufe38 \ufe37\ufe37 \ufe38 Q4(\u03c1) e.\nThe gH2 condition then gives (note that the system (22) is now strictly proper){\nV\u0307 (e, \u03c1) + J1 < 0 J2(\u03c1) > 0. (26)\nAs we apply the S-procedure [21] to the Lipschitz constraint (25) and the conditions (26), V\u0307 (e, \u03c1) < 0 if there exists a scalar \u03b5l > 0 such that{\nV\u0307 (e, \u03c1)\u2212 \u03b5l\u03b7\u22a4Q2(\u03c1)\u03b7 + J1 < 0 J2(\u03c1) > 0\n\u21d0\u21d2 { \u03b7\u22a4(Q1(\u03c1)\u2212 \u03b5lQ2(\u03c1) +Q3)\u03b7 < 0 e\u22a4Q4(\u03c1)e > 0\n\u21d0\u21d2 { Q1(\u03c1)\u2212 \u03b5lQ2(\u03c1) +Q3 < 0 Q4(\u03c1) > 0,\nwhich is equivalent to\u212611b(\u03c1) + \u03b5lC\u22a4(\u03c1)\u0393\u22a4\u0393C(\u03c1) X(\u03c1)W(\u03c1) \u212613(\u03c1)W\u22a4(\u03c1)X(\u03c1) \u2212\u03b5lI 0 \u2126\u22a413(\u03c1) 0 \u2212I  < 0, \u03b32X(\u03c1)\u2212 I > 0.\nSchur\u2019s lemma is then applied to the second condition, making it an LMI. Under Assumption 2, these resulting LMIs are satisfied if and only if the ones in Theorem 1 are satisfied [17]. Finally, (26) implies the gH2 performance, which is \u2225e(t)\u22252\u221e < \u03b32\u2225\u03c9n(t)\u222522. The proof is completed. \u25a1\nRemark 3: When the error system (22) has no external inputs, we get V\u0307 (e, \u03c1) < 0, which guarantees the asymptotic stability of (22). Then, with X(\u03c1) admitting positive bounds on the compact set [\u03c1, \u03c1], the error e asymptotically converges to 0 since \u2206\u03a6 vanishes as x\u0302 approaches x.\nThe LMIs in Theorem 1 must be satisfied for an infinite number of constraints over the trajectories of \u03c1. To relax this, the grid-based methodology [17] is considered here where these inequalities are solved for a set of a high enough number Ng of frozen values of \u03c1 assumed belonging to a gridded domain of the varying parameter under Assumption 2, followed by post-analysis of the asymptotic stability of the solution using a much denser grid. The observer is designed by applying Theorem 1 to get Z(\u03c1) then obtaining the frozen observers at the grid points. In its implementation, grid-based gain scheduling is performed using interpolation methods.\nRemark 4: When \u03a6 is only locally Lipschitz, we assume that the system solution x to be estimated remains in a compact set X \u2282 Rnx (remember that the control input u is always bounded in [u, u] \u2282 Rnu ) and replace the \u03a6 in the observer with \u03a6\u0303 : Rnx \u00d7 Rnu \u2192 Rn\u03a6 such that \u03a6\u0303 = \u03a6 on X\u0303 \u00d7 [u, u] where X\u0303 = X + c for some c > 0 (the set of points lying within a distance c from all the points in X , which is also compact) and \u03a6\u0303 is bounded outside. This way, there exists \u0393 > 0 such that \u2225\u03a6(x, u)\u2212 \u03a6\u0303(x\u0302, u)\u2225\u2264 \u2225\u0393(x\u2212 x\u0302)\u2225,\u2200(x, x\u0302) \u2208 X \u00d7 Rnx ,\u2200u \u2208 [u, u]. Therefore, by repeating all the steps until the system (4) and letting \u2206\u03a6 = \u03a6(x, u)\u2212 \u03a6\u0303(x\u0302, u), we can bound this nonlinearity exactly as above. The assumption on x is feasible as, in practice, the state is always limited by operating conditions, e.g., system dimensions and constraints.\nNote that using Theorem 1 implies imposing parameterized forms of X(\u03c1) and Y (\u03c1) in terms of \u03c1, e.g., the polynomial form as seen later in Section V. Algorithm 1 summarizes the proposed observer design method.\nAlgorithm 1 Observer design Input: The matrices A(\u03c1), B(\u03c1), C, D1, and D2, \u03a6(x, u), and the Ng gridded values of \u03c1 \u2208 [\u03c1, \u03c1] Output: The observer matrices N(\u03c1), J(\u03c1), H(\u03c1), M(\u03c1), P (\u03c1), Q(\u03c1), G(\u03c1), R(\u03c1), and S(\u03c1) at the grid points Assumptions: The Lipschitz matrix \u0393 and the bound \u03bd on |\u03c1\u0307|\nStep 1: Choose a structure for E(\u03c1), then grid it and check (13) at the grid points Step 2: Find K(\u03c1), T (\u03c1), and \u0398(\u03c1) at the grid points, according to [9], (14), and (20) Step 3: Find H(\u03c1) at the grid points using (18) Step 4: Deduce \u03b11(\u03c1), \u03b12(\u03c1), \u03b13(\u03c1), \u03b14(\u03c1), \u03b21(\u03c1), \u03b22(\u03c1), \u03b23(\u03c1), (15), and (21) Step 5: Deduce Ym2(\u03c1) according to (23), getting C(\u03c1), D(\u03c1), R(\u03c1), and S(\u03c1) Step 6: Find A1(\u03c1), A2(\u03c1), W(\u03c1), B1(\u03c1), and B2(\u03c1) Step 7: Fix the form of X(\u03c1) and Y (\u03c1) and solve for Z(\u03c1) using Theorem 1, getting M(\u03c1), G(\u03c1), Ym1(\u03c1), and Ym3(\u03c1) Step 8: From Ym1(\u03c1), get P (\u03c1) and Q(\u03c1) using (15); from Ym3(\u03c1), get N(\u03c1) and J(\u03c1) using (21) and (20)"
        },
        {
            "heading": "V. APPLICATION TO AUTOMOTIVE SA SUSPENSIONS",
            "text": "To illustrate the proposed observer design method, we consider the damper force estimation problem in the SA suspension. Consider the quarter-car model made of the sprung and unsprung masses ms and mus [22]. From Newton\u2019s law of motion, the system dynamics around its equilibrium are{\nmsz\u0308s = \u2212Fs \u2212 Fd musz\u0308us = Fs + Fd \u2212 Ft,\n(27)\nwhere the spring force Fs = kszdef with zdef = zs \u2212 zus called the suspension deflection and z\u0307def its velocity; the tire force Ft = kt(zus \u2212 zr). The damper force Fd consists of a passive part Fpassive and a controlled part Fer [10] as Fd = k0zdef + c0z\u0307def\ufe38 \ufe37\ufe37 \ufe38 Fpassive +Fer\nF\u0307er = \u22121 \u03c4(u)Fer + fc \u03c4(u) \u00b7 u \u00b7 tanh (k1zdef + c1z\u0307def ) ,\n(28) where c0, c1, k0, k1, and fc are constant parameters; u \u2208 [u, u] is the PWM control input signal. In the nonlinear damper model [18], \u03c4(u) depends on the input u as\n\u03c4(u) = 0.3643u2 + 0.1124u. (29)\nChoosing the state x = (zs \u2212 zus, z\u0307s, zus \u2212 zr, z\u0307us, Fer)\u22a4, the measured output y as (z\u0308s, z\u0308us)\u22a4 (note that measuring accelerations has cost and mounting advantages over measuring deflections [3]) with measurement noise \u03c9n, the input disturbance \u03c9r = z\u0307r, and \u03c1 = 1\u03c4(u) \u2208 [ 1 \u03c4(u) , 1 \u03c4(u) ] s\n\u22121 where 0 < u < u, we get \u03a6(x, u) = u \u00b7 tanh (k1zdef + c1z\u0307def ) =\nu \u00b7 tanh(\u039bx) where \u039b = ( k1 c1 0 \u2212c1 0 ) . Therefore, the system can be written in the form (1), \u03a6 being Lipschitz. In this work, the parameters for observer design and simulation correspond to a 1/5-scale vehicle [10]. Also, for operation safety, the control bounds are taken as u = 0.1 and u = 0.5."
        },
        {
            "heading": "A. Application of Algorithm 1",
            "text": "We choose here E(\u03c1) = E0 + \u03c1E1, whereas more complex forms can be used in other applications. For LMI solving, we choose the first-order forms X(\u03c1) = X0 + \u03c1X1 > 0 and Y (\u03c1) = Y0 + \u03c1Y1 for the variables, and then solve the LMIs for the coefficients X0, X1, Y0, and Y1. LMI solution with 14 evenly spaced grid points and parameter variation bound \u03bd = 2600 s\u22122 using the LMI Lab toolbox has given \u03b3 = 0.4230. Post-analysis using a grid consisting of 140 evenly spaced points in the same range has shown that the maximum real part of the poles of the error system varies between \u22122.7408 \u00b710\u22126 at \u03c1 and \u22121.1049 \u00b7 10\u22126 at \u03c1. Therefore, we conclude that the obtained solution guarantees the error\u2019s asymptotic stability."
        },
        {
            "heading": "B. Observer Synthesis Results",
            "text": "Let us compare our observer with the polytopic LPV one designed in [18]. Figure 1 shows the upper bound \u03c3(e/\u03c9n) on the singular values of the transfer functions of the error systems frozen at the grid points, which decreases rapidly in the region of high-frequency noise, emphasizing the effectiveness of our observer in terms of noise attenuation.\nFrom Figure 2, it is evident that for each state component, the proposed observer gives a significantly better maximal attenuation level of sensor noise than the LPV one."
        },
        {
            "heading": "C. Damper Force Estimation Results",
            "text": "Both observers are then simulated with the nonlinear damper model above. We use two simulation scenarios with: \u2022 An ISO road profile of type C (see [3] for a figure) and\nthen a bump road profile of 2 cm (occurring at 0.5 s); \u2022 A skyhook controller that gives the PWM signal; \u2022 White noise only in the second scenario.\nDamper force estimation results are shown in Figures 3 and 4. In the first scenario, the proposed observer converges slightly slower than the LPV one. But, with a bump road profile and realistic measurement noise, the proposed one gives an estimation error that is smaller and not noisy. Indeed, the proposed observer can minimize the effect of the measurement noise, while that of the road input is decoupled from the error."
        },
        {
            "heading": "VI. CONCLUSION",
            "text": "This paper designs a unified observer specifically for a class of NLPV systems with parameter dependence in both the dynamics and the input matrices and with a Lipschitz nonlinearity in the input. Following the grid-based methodology, parameterization is extended for the case of parameter dependence in the system\u2019s dynamics matrix, decoupling the effects of the input disturbance from the estimation error. The objectives of bounding the nonlinear disturbance term using the Lipschitz condition and bounding the measurement noise using the gH2 condition are combined into a single LMI framework thanks to the S-procedure. Application to the SA suspension has illustrated the method in both the frequency and time domain and compared it with an LPV observer."
        }
    ],
    "title": "Unified Generalized H2 Nonlinear Parameter Varying Observer: Application to Automotive Suspensions",
    "year": 2023
}