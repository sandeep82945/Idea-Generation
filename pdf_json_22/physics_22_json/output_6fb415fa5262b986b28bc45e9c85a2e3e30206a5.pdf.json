{
    "abstractText": "HAL is a multi-disciplinary open access archive for the deposit and dissemination of scientific research documents, whether they are published or not. The documents may come from teaching and research institutions in France or abroad, or from public or private research centers. L\u2019archive ouverte pluridisciplinaire HAL, est destin\u00e9e au d\u00e9p\u00f4t et \u00e0 la diffusion de documents scientifiques de niveau recherche, publi\u00e9s ou non, \u00e9manant des \u00e9tablissements d\u2019enseignement et de recherche fran\u00e7ais ou \u00e9trangers, des laboratoires publics ou priv\u00e9s. Efficient kinetic simulation of two-phase flows Wei Li, Yihui Ma, Xiaopei Liu, Mathieu Desbrun",
    "authors": [
        {
            "affiliations": [],
            "name": "Wei Li"
        },
        {
            "affiliations": [],
            "name": "Yihui Ma"
        },
        {
            "affiliations": [],
            "name": "Xiaopei Liu"
        },
        {
            "affiliations": [],
            "name": "Mathieu Desbrun"
        },
        {
            "affiliations": [],
            "name": "WEI LI"
        },
        {
            "affiliations": [],
            "name": "XIAOPEI LIU"
        }
    ],
    "id": "SP:d170a39855e3d969aedc6cdfa7833857075f86f2",
    "references": [
        {
            "authors": [
                "Mridul Aanjaneya",
                "Ming Gao",
                "Haixiang Liu",
                "Christopher Batty",
                "Eftychios Sifakis."
            ],
            "title": "Power Diagrams and Sparse Paged Grids for High Resolution Adaptive Liquids",
            "venue": "ACM Trans. Graph. 36, 4 (2017), 140:1\u201312.",
            "year": 2017
        },
        {
            "authors": [
                "Ryoichi Ando",
                "Nils Thuerey",
                "Chris Wojtan."
            ],
            "title": "A stream function solver for liquid simulations",
            "venue": "ACM Trans. Graph. 34, 4 (2015), 53:1\u20139.",
            "year": 2015
        },
        {
            "authors": [
                "Vinicius C. Azevedo",
                "Christopher Batty",
                "Manuel M. Oliveira."
            ],
            "title": "Preserving geometry and topology for fluid flows with thin obstacles and narrow gaps",
            "venue": "ACM Trans. Graph. 35, 4, Article 97 (2016), 97:1\u201312 pages.",
            "year": 2016
        },
        {
            "authors": [
                "Yan Ba",
                "Haihu Liu",
                "Qing Li",
                "Qinjun Kang",
                "Jinju Sun."
            ],
            "title": "Multiple-relaxation-time color-gradient lattice Boltzmann model for simulating two-phase flows with high density ratio",
            "venue": "Physical Review E 94, 2 (2016), 023310:1\u201315.",
            "year": 2016
        },
        {
            "authors": [
                "Vittorio E Badalassi",
                "Hector D Ceniceros",
                "Sanjoy Banerjee."
            ],
            "title": "Computation of multiphase systems with phase field models",
            "venue": "J. Comput. Phys. 190, 2 (2003), 371\u2013397.",
            "year": 2003
        },
        {
            "authors": [
                "Stefan Band",
                "Christoph Gissler",
                "Markus Ihmsen",
                "Jens Cornelis",
                "Andreas Peer",
                "Matthias Teschner."
            ],
            "title": "Pressure Boundaries for Implicit Incompressible SPH",
            "venue": "ACM Trans. Graph. 37, 2 (2018), 14:1\u201311.",
            "year": 2018
        },
        {
            "authors": [
                "Christopher Batty",
                "Robert Bridson."
            ],
            "title": "Accurate viscous free surfaces for buckling, coiling, and rotating liquids",
            "venue": "Symposium on Computer Animation. 219\u2013228.",
            "year": 2008
        },
        {
            "authors": [
                "Jan Bender",
                "Dan Koschier."
            ],
            "title": "Divergence-free SPH for incompressible and viscous fluids",
            "venue": "IEEE Trans. Vis. & Comp. Graph. 23, 3 (2016), 1193\u20131206.",
            "year": 2016
        },
        {
            "authors": [
                "Prabhu Lal Bhatnagar",
                "Eugene P. Gross",
                "Max Krook."
            ],
            "title": "A Model for Collision Processes in Gases",
            "venue": "I. Small Amplitude Processes in Charged and Neutral OneComponent Systems. Phys. Rev. 94, 3 (1954), 511\u2013525.",
            "year": 1954
        },
        {
            "authors": [
                "Morten Bojsen-Hansen",
                "Chris Wojtan."
            ],
            "title": "Liquid surface tracking with error compensation",
            "venue": "ACM Trans. Graph. 32, 4 (2013), 79:1\u201379:10.",
            "year": 2013
        },
        {
            "authors": [
                "Morten Bojsen-Hansen",
                "Chris Wojtan."
            ],
            "title": "Generalized Non-reflecting Boundaries for Fluid Re-simulation",
            "venue": "ACM Trans. Graph. 35, 4 (July 2016), 96:1\u201396:7.",
            "year": 2016
        },
        {
            "authors": [
                "Landon Boyd",
                "Robert Bridson."
            ],
            "title": "MultiFLIP for energetic two-phase fluid simulation",
            "venue": "ACM Trans. Graph. 31, 2, Article 16 (2012).",
            "year": 2012
        },
        {
            "authors": [
                "Oleksiy Busaryev",
                "Tamal K. Dey",
                "Huamin Wang",
                "Zhong Ren."
            ],
            "title": "Animating bubble interactions in a liquid foam",
            "venue": "ACM Trans. Graph. 31, 4 (2012), 1\u20138.",
            "year": 2012
        },
        {
            "authors": [
                "Chaos."
            ],
            "title": "V-Ray renderer",
            "venue": "(2022). https://www.chaos.com/",
            "year": 2022
        },
        {
            "authors": [
                "Yixin Chen",
                "Wei Li",
                "Rui Fan",
                "Xiaopei Liu."
            ],
            "title": "GPU Optimization for High-Quality Kinetic Fluid Simulation",
            "venue": "IEEE Trans. Vis. & Comp. Graph. Preprint (2021).",
            "year": 2021
        },
        {
            "authors": [
                "Yi-Lu Chen",
                "Jonathan Meier",
                "Barbara Solenthaler",
                "Vinicius C Azevedo."
            ],
            "title": "An extended cut-cell method for sub-grid liquids tracking with surface tension",
            "venue": "ACM Trans. Graph. 39, 6 (2020), 1\u201313.",
            "year": 2020
        },
        {
            "authors": [
                "Nuttapong Chentanez",
                "Matthias M\u00fcller",
                "Miles Macklin",
                "Tae-Yong Kim."
            ],
            "title": "Fast grid-free surface tracking",
            "venue": "ACM Trans. Graph. 34, 4 (2015), 48:1\u201348:11. ACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.",
            "year": 2015
        },
        {
            "authors": [
                "Sauro Succi"
            ],
            "title": "Lattice Boltzmann models for nonideal fluids with arrested",
            "year": 2008
        },
        {
            "authors": [
                "Douglas Enright",
                "Steve Marschner",
                "Ron Fedkiw"
            ],
            "title": "Lagrangian particle level set method",
            "venue": "Comput. & Structures",
            "year": 2005
        },
        {
            "authors": [
                "Abbas Fakhari",
                "Diogo Bolster",
                "Li-Shi Luo"
            ],
            "title": "2017a. A weighted multiple-relaxation",
            "venue": "ratios. J. Comput. Phys",
            "year": 2017
        },
        {
            "authors": [
                "Abbas Fakhari",
                "Martin Geier",
                "Diogo Bolster"
            ],
            "title": "A simple phase-field model for",
            "venue": "coalescence cascades. J. Comput. Phys",
            "year": 2019
        },
        {
            "authors": [
                "Sauro Succi"
            ],
            "title": "Lattice Boltzmann models with mid-range interactions",
            "year": 2007
        },
        {
            "authors": [
                "Nick Foster",
                "Demetri Metaxas"
            ],
            "title": "Computer Graphics and Interactive Techniques (ACM SIGGRAPH)",
            "year": 1996
        },
        {
            "authors": [
                "Chenfanfu Jiang"
            ],
            "title": "Animating fluid sediment mixture in particle-laden flows",
            "year": 2018
        },
        {
            "authors": [
                "Geier",
                "Abbas Fakhari",
                "Taehun Lee"
            ],
            "title": "Conservative phase-field lattice",
            "venue": "ACM Trans. Graph. 37,",
            "year": 2018
        },
        {
            "authors": [
                "063309:1\u201311. Sebastian Geller",
                "Sonja Uphoff",
                "Manfred Krafczyk"
            ],
            "title": "Turbulent jet computations",
            "year": 2013
        },
        {
            "authors": [
                "Ryan Goldade",
                "Mridul Aanjaneya",
                "Christopher Batty"
            ],
            "title": "Constraint bubbles",
            "year": 2013
        },
        {
            "authors": [
                "G Gruszczy\u0144ski",
                "Travis Mitchell",
                "Christopher Leonardi",
                "Tracie Barber."
            ],
            "title": "A cascaded phase-field lattice Boltzmann model for the simulation of incompressible, immiscible fluids with high density contrast",
            "venue": "Computers & Mathematics with Applications 79, 4 (2020), 1049\u20131071.",
            "year": 2020
        },
        {
            "authors": [
                "Andrew K. Gunstensen",
                "Daniel H. Rothman",
                "St\u00e9phane Zaleski",
                "Gianluigi Zanetti."
            ],
            "title": "Lattice Boltzmann model of immiscible fluids",
            "venue": "Physical Review A 43, 8 (1991), 4320\u20134327.",
            "year": 1991
        },
        {
            "authors": [
                "Yulong Guo",
                "Xiaopei Liu",
                "Xuemao Xu."
            ],
            "title": "A unified detail-preserving liquid simulation by two-phase lattice Boltzmannmodeling",
            "venue": "IEEE Trans. Vis. & Comp.Graph. 23, 5 (2017), 1479\u20131491.",
            "year": 2017
        },
        {
            "authors": [
                "Xiaoyi He",
                "Shiyi Chen",
                "Gary D Doolen."
            ],
            "title": "A novel thermal model for the lattice Boltzmann method in incompressible limit",
            "venue": "J. Comput. Phys. 146, 1 (1998), 282\u2013300.",
            "year": 1998
        },
        {
            "authors": [
                "Xiaoyi He",
                "Raoyang Zhang",
                "Shiyi Chen",
                "Gary D Doolen."
            ],
            "title": "On the threedimensional Rayleigh\u2013Taylor instability",
            "venue": "Physics of Fluids 11, 5 (1999), 1143\u20131152.",
            "year": 1999
        },
        {
            "authors": [
                "Nambin Heo",
                "Hyeong-Seok Ko."
            ],
            "title": "Detail-preserving fully-Eulerian interface tracking framework",
            "venue": "ACM Trans. Graph. 29, 6 (2010), 176:1\u2013176:8.",
            "year": 2010
        },
        {
            "authors": [
                "David J. Holdych",
                "Dimitrios Rovas",
                "John G. Georgiadis",
                "Richard O. Buckius."
            ],
            "title": "An improved hydrodynamics formulation for multiphase flow lattice-Boltzmann models",
            "venue": "International Journal of Modern Physics C 9, 08 (1998), 1393\u20131404.",
            "year": 1998
        },
        {
            "authors": [
                "Jeong-Mo Hong",
                "Chang-Hun Kim."
            ],
            "title": "Discontinuous fluids",
            "venue": "ACM Trans. Graph. 24, 3 (2005), 915\u2013920.",
            "year": 2005
        },
        {
            "authors": [
                "Yang Hu",
                "Decai Li",
                "Qiang He."
            ],
            "title": "Generalized conservative phase field model and its lattice Boltzmann scheme for multicomponent multiphase flows",
            "venue": "International Journal of Multiphase Flow 132 (2020), 103432.",
            "year": 2020
        },
        {
            "authors": [
                "Takaji Inamuro",
                "Nobuharu Konishi",
                "Fumimaru Ogino."
            ],
            "title": "A Galilean invariant model of the lattice Boltzmann method for multiphase fluid flows using free-energy approach",
            "venue": "Computer Physics Communications 129, 1-3 (2000), 32\u201345.",
            "year": 2000
        },
        {
            "authors": [
                "David Jacqmin."
            ],
            "title": "Calculation of Two-Phase Navier-Stokes Flows Using Phase-Field Modeling",
            "venue": "J. Comput. Phys. 155, 1 (1999), 96\u2013127.",
            "year": 1999
        },
        {
            "authors": [
                "Alexandros N. Kalarakis",
                "Vasilis N. Burganos",
                "Alkiviades C. Payatakes."
            ],
            "title": "Galilean-invariant lattice-Boltzmann simulation of liquid-vapor interface dynamics",
            "venue": "Physical Review E 65, 5 (2002), 056702.",
            "year": 2002
        },
        {
            "authors": [
                "Myungjoo Kang",
                "Ronald P Fedkiw",
                "Xu-Dong Liu."
            ],
            "title": "A boundary condition capturing method for multiphase incompressible flow",
            "venue": "Journal of Scientific Computing 15, 3 (2000), 323\u2013360.",
            "year": 2000
        },
        {
            "authors": [
                "Qinjun Kang",
                "Dongxiao Zhang",
                "Shiyi Chen."
            ],
            "title": "Immiscible displacement in a channel: simulations of fingering in two dimensions",
            "venue": "Advances in Water Resources 27, 1 (2004), 13\u201322.",
            "year": 2004
        },
        {
            "authors": [
                "Po-Hao Kao",
                "Ruey-Jen Yang."
            ],
            "title": "An investigation into curved and moving boundary treatments in the lattice Boltzmann method",
            "venue": "J. Comput. Phys. 227, 11 (2008), 5671\u20135690.",
            "year": 2008
        },
        {
            "authors": [
                "Vivien M Kendon",
                "Michael E Cates",
                "Ignacio Pagonabarraga",
                "J-C Desplat",
                "Peter Bladon."
            ],
            "title": "Inertial effects in three-dimensional spinodal decomposition of a symmetric binary fluidmixture: a lattice Boltzmann study",
            "venue": "Journal of Fluid Mechanics 440 (2001), 147\u2013203.",
            "year": 2001
        },
        {
            "authors": [
                "Byungmoon Kim."
            ],
            "title": "Multi-phase fluid simulations using regional level sets",
            "venue": "ACM Trans. Graph. 29, 6 (2010), 175:1\u20138.",
            "year": 2010
        },
        {
            "authors": [
                "Byungmoon Kim",
                "Yingjie Liu",
                "Ignacio Llamas",
                "Xiangmin Jiao",
                "Jarek Rossignac."
            ],
            "title": "Simulation of bubbles in foam with the volume control method",
            "venue": "ACM Trans. Graph. 26, 3 (2007), 98.",
            "year": 2007
        },
        {
            "authors": [
                "Doyub Kim",
                "Oh-Young Song",
                "Hyeong-Seok Ko."
            ],
            "title": "A Practical Simulation of Dispersed Bubble Flow",
            "venue": "ACM Trans. Graph. 29, 4 (2010), 70:1\u20135.",
            "year": 2010
        },
        {
            "authors": [
                "Theodore Kim",
                "Jerry Tessendorf",
                "Jils Thurey."
            ],
            "title": "Closest point turbulence for liquid surfaces",
            "venue": "ACM Trans. Graph. 32, 2 (2013), 15:1\u201315:13.",
            "year": 2013
        },
        {
            "authors": [
                "Dan Koschier",
                "Jan Bender."
            ],
            "title": "Density Maps for Improved SPH Boundary Handling",
            "venue": "Symposium on Computer Animation. Article 1.",
            "year": 2017
        },
        {
            "authors": [
                "E. Dinesh Kumar",
                "Sannasi Annamalaisamy Sannasiraj",
                "Vallam Sundar."
            ],
            "title": "Phase field lattice Boltzmann model for air-water two phase flows",
            "venue": "Physics of Fluids 31, 7 (2019), 072103.",
            "year": 2019
        },
        {
            "authors": [
                "Anthony J.C. Ladd."
            ],
            "title": "Numerical simulations of particulate suspensions via a discretized Boltzmann equation",
            "venue": "Part 1. Theoretical foundation. Journal of Fluid Mechanics 271 (1994), 285\u2013309.",
            "year": 1994
        },
        {
            "authors": [
                "Timothy R. Langlois",
                "Changxi Zheng",
                "Doug L. James."
            ],
            "title": "Toward Animating Water with Complex Acoustic Bubbles",
            "venue": "ACM Trans. Graph. 35, 4 (2016), 95:1\u201313.",
            "year": 2016
        },
        {
            "authors": [
                "Jonas Latt."
            ],
            "title": "Hydrodynamic limit of lattice Boltzmann equations",
            "venue": "Ph. D. Dissertation. University of Geneva.",
            "year": 2007
        },
        {
            "authors": [
                "Jonas Latt."
            ],
            "title": "Technical report: How to implement your DdQq dynamics with only q variables per node (instead of 2q)",
            "venue": "Tufts University (2007), 1\u20138.",
            "year": 2007
        },
        {
            "authors": [
                "S\u00e9bastien Leclaire",
                "Marcelo Reggio",
                "Jean-Yves Tr\u00e9panier."
            ],
            "title": "Isotropic color gradient for simulating very high-density ratios with a two-phase flow lattice Boltzmann model",
            "venue": "Computers & Fluids 48, 1 (2011), 98\u2013112.",
            "year": 2011
        },
        {
            "authors": [
                "Hyun Geun Lee",
                "Junseok Kim."
            ],
            "title": "Numerical simulation of the three-dimensional Rayleigh\u2013Taylor instability",
            "venue": "Computers & Mathematics with Applications 66, 8 (2013), 1466\u20131474.",
            "year": 2013
        },
        {
            "authors": [
                "Taehun Lee",
                "Ching-Long Lin."
            ],
            "title": "A stable discretization of the lattice Boltzmann equation for simulation of incompressible two-phase flows at high density ratio",
            "venue": "J. ACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.",
            "year": 2005
        },
        {
            "authors": [
                "Qing Li",
                "Kaihong Luo",
                "YJ Gao",
                "YL He."
            ],
            "title": "Additional interfacial force in lattice Boltzmann models for incompressible multiphase flows",
            "venue": "Physical Review E 85, 2 (2012), 026704.",
            "year": 2012
        },
        {
            "authors": [
                "Wei Li",
                "Kai Bai",
                "Xiaopei Liu."
            ],
            "title": "Continuous-Scale Kinetic Fluid Simulation",
            "venue": "IEEE Transactions on Visualization and Computer Graphics 25, 9 (2019), 2694\u20132709. https://doi.org/10.1109/TVCG.2018.2859931",
            "year": 2019
        },
        {
            "authors": [
                "Wei Li",
                "Yixin Chen",
                "Mathieu Desbrun",
                "Changxi Zheng",
                "Xiaopei Liu."
            ],
            "title": "Fast and Scalable Turbulent Flow Simulation with Two-Way Coupling",
            "venue": "ACM Trans. Graph. 39, 4 (2020).",
            "year": 2020
        },
        {
            "authors": [
                "Wei Li",
                "Daoming Liu",
                "Mathieu Desbrun",
                "Jin Huang",
                "Xiaopei Liu."
            ],
            "title": "KineticBased Multiphase Flow Simulation",
            "venue": "IEEE Trans. Vis. & Comp. Graph. 27, 7 (2021), 3318\u20133334.",
            "year": 2021
        },
        {
            "authors": [
                "Hong Liang",
                "Jiangrong Xu",
                "Jiangxing Chen",
                "Huili Wang",
                "Zhenhua Chai",
                "Baochang Shi."
            ],
            "title": "Phase-field-based lattice Boltzmann modeling of large-density-ratio two-phase flows",
            "venue": "Physical Review E 97, 3 (2018), 033309.",
            "year": 2018
        },
        {
            "authors": [
                "Frank Losasso",
                "Frederic Gibou",
                "Ron Fedkiw."
            ],
            "title": "Simulating water and smoke with an octree data structure",
            "venue": "ACM Trans. Graph. 457\u2013462.",
            "year": 2004
        },
        {
            "authors": [
                "Frank Losasso",
                "Tamar Shinar",
                "Andrew Selle",
                "Ronald Fedkiw."
            ],
            "title": "Multiple interacting liquids",
            "venue": "ACM Trans. Graph. 25, 3 (2006), 812\u2013819.",
            "year": 2006
        },
        {
            "authors": [
                "Daniel Lycett-Brown",
                "Kai H. Luo",
                "Ronghou Liu",
                "Pengmei Lv."
            ],
            "title": "Binary droplet collision simulations by a multiphase cascaded lattice Boltzmann method",
            "venue": "Physics of Fluids 26 (2014), 023303:1\u201326.",
            "year": 2014
        },
        {
            "authors": [
                "Chaoyang Lyu",
                "Wei Li",
                "Mathieu Desbrun",
                "Xiaopei Liu."
            ],
            "title": "Fast and versatile fluid-solid coupling for turbulent flow simulation",
            "venue": "ACM Trans. Graph. 40, 6 (2021), 1\u201318.",
            "year": 2021
        },
        {
            "authors": [
                "Michael E McCracken",
                "John Abraham."
            ],
            "title": "Multiple-relaxation-time latticeBoltzmann model for multiphase flow",
            "venue": "Physical Review E 71, 3 (2005), 036701.",
            "year": 2005
        },
        {
            "authors": [
                "Viorel Mihalef",
                "Dimitris Metaxas",
                "Mark Sussman."
            ],
            "title": "Animation and Control of Breaking Waves",
            "venue": "Symposium on Computer Animation. 315\u2013324.",
            "year": 2004
        },
        {
            "authors": [
                "Viorel Mihalef",
                "Betul Unlusu",
                "Dimitris Metaxas",
                "Mark Sussman",
                "M Yousuff Hussaini."
            ],
            "title": "Physics based boiling simulation",
            "venue": "Symposium on Computer Animation. 317\u2013 324.",
            "year": 2006
        },
        {
            "authors": [
                "Marek Krzysztof Misztal",
                "Kenny Erleben",
                "Adam Bargteil",
                "Jens Fursund",
                "Brian Bunch Christensen",
                "Jakob Andreas B\u00e6rentzen",
                "Robert Bridson."
            ],
            "title": "Multiphase flow of immiscible fluids on unstructured moving meshes",
            "venue": "IEEE Trans. Vis. & Comp. Graph. 20, 1 (2013), 4\u201316.",
            "year": 2013
        },
        {
            "authors": [
                "Shiladitya Mukherjee",
                "John Abraham."
            ],
            "title": "Lattice Boltzmann simulations of two-phase flow with high density ratio in axially symmetric geometry",
            "venue": "Physical Review E 75, 2 (2007), 026701.",
            "year": 2007
        },
        {
            "authors": [
                "Shiladitya Mukherjee",
                "John Abraham."
            ],
            "title": "A pressure-evolution-based multirelaxation-time high-density-ratio two-phase lattice-Boltzmann model",
            "venue": "Computers & Fluids 36, 6 (2007), 1149\u20131158.",
            "year": 2007
        },
        {
            "authors": [
                "Matthias M\u00fcller",
                "David Charypar",
                "Markus Gross."
            ],
            "title": "Particle-based fluid simulation for interactive applications",
            "venue": "Symposium on Computer Animation. 154\u2013159.",
            "year": 2003
        },
        {
            "authors": [
                "Seyed Nabavizadeh",
                "Mohsen Eshraghi",
                "Sergio Felicelli."
            ],
            "title": "A Comparative Study of Multiphase Lattice Boltzmann Methods for Bubble-Dendrite Interaction during Solidification of Alloys",
            "venue": "Appl. Sci. 9, 1 (2018), 57:1\u201324.",
            "year": 2018
        },
        {
            "authors": [
                "Xiao-Dong Niu",
                "You Li",
                "Yi-Ren Ma",
                "Mu-Feng Chen",
                "Xiang Li",
                "Qiao-Zhong Li."
            ],
            "title": "Amass-conserving multiphase lattice Boltzmannmodel for simulation of multiphase flows",
            "venue": "Physics of Fluids 30, 1 (2018), 013302:1\u201313.",
            "year": 2018
        },
        {
            "authors": [
                "Enzo Orlandini",
                "Michael R Swift",
                "JM Yeomans."
            ],
            "title": "A lattice Boltzmann model of binary-fluid mixtures",
            "venue": "Euro-Physics Letters 32, 6 (1995), 463.",
            "year": 1995
        },
        {
            "authors": [
                "Saket Patkar",
                "Mridul Aanjaneya",
                "Dmitriy Karpman",
                "Ronald Fedkiw."
            ],
            "title": "A hybrid Lagrangian-Eulerian formulation for bubble generation and dynamics",
            "venue": "Symp. Comp. Anim. 105\u2013114.",
            "year": 2013
        },
        {
            "authors": [
                "Saket Patkar",
                "Parag Chaudhuri."
            ],
            "title": "Wetting of Porous Solids",
            "venue": "IEEE Trans. Vis. & Comp. Graph. 19, 9 (2013), 1592\u20131604.",
            "year": 2013
        },
        {
            "authors": [
                "Bo Ren",
                "Chenfeng Li",
                "Xiao Yan",
                "Ming C Lin",
                "Javier Bonet",
                "Shi-Min Hu."
            ],
            "title": "Multiple-fluid SPH simulation using a mixture model",
            "venue": "ACM Trans. Graph. 33, 5 (2014), 171:1\u201311.",
            "year": 2014
        },
        {
            "authors": [
                "Shimpei Saito",
                "Alessandro De Rosis",
                "Alessio Festuccia",
                "Akiko Kaneko",
                "Yutaka Abe",
                "Kazuya Koyama."
            ],
            "title": "Color-gradient lattice Boltzmann model with nonorthogonal central moments: Hydrodynamic melt-jet breakup simulations",
            "venue": "Physical Review E 98, 1 (2018), 013305.",
            "year": 2018
        },
        {
            "authors": [
                "Robert Saye."
            ],
            "title": "Interfacial gauge methods for incompressible fluid dynamics",
            "venue": "Science Advances 2, 6 (2016), e1501869.",
            "year": 2016
        },
        {
            "authors": [
                "Robert Saye."
            ],
            "title": "Implicit mesh discontinuous Galerkin methods and interfacial gauge methods for high-order accurate interface dynamics, with applications to surface tension dynamics, rigid body fluid\u2013structure interaction, and free surface flow: Part I",
            "venue": "J. Comput. Phys. 344 (2017), 647\u2013682.",
            "year": 2017
        },
        {
            "authors": [
                "Mauro Sbragaglia",
                "Roberto Benzi",
                "Luca Biferale",
                "Sauro Succi",
                "Kazu Sugiyama",
                "Federico Toschi."
            ],
            "title": "Generalized lattice Boltzmann method with multirange pseudopotential",
            "venue": "Physical Review E 75, 2 (2007), 026702.",
            "year": 2007
        },
        {
            "authors": [
                "Hagit Schechter",
                "Robert Bridson."
            ],
            "title": "Ghost SPH for Animating Water",
            "venue": "ACM Trans. Graph. 31, 4 (2012).",
            "year": 2012
        },
        {
            "authors": [
                "Xiaowen Shan",
                "Hudong Chen."
            ],
            "title": "Lattice Boltzmann model for simulating flows with multiple phases and components",
            "venue": "Physical review E 47, 3 (1993), 1815.",
            "year": 1993
        },
        {
            "authors": [
                "Xiaowen Shan",
                "Hudong Chen."
            ],
            "title": "Simulation of nonideal gases and liquid-gas phase transitions by the lattice Boltzmann equation",
            "venue": "Physical Review E 49, 4 (1994), 2941.",
            "year": 1994
        },
        {
            "authors": [
                "J.Y. Shao",
                "C. Shu",
                "H.B. Huang",
                "Y.T. Chew."
            ],
            "title": "Free-energy-based lattice Boltzmann model for the simulation of multiphase flows with density contrast",
            "venue": "Physical Review E 89, 3 (2014), 033309:1\u201314.",
            "year": 2014
        },
        {
            "authors": [
                "Barbara Solenthaler",
                "Renato Pajarola."
            ],
            "title": "Density Contrast SPH Interfaces",
            "venue": "Symposium on Computer Animation. 211\u2013218.",
            "year": 2008
        },
        {
            "authors": [
                "Barbara Solenthaler",
                "Renato Pajarola."
            ],
            "title": "Predictive-Corrective incompressible SPH",
            "venue": "ACM Trans. Graph. 28, 3 (2009), 40:1\u20136.",
            "year": 2009
        },
        {
            "authors": [
                "Oh-Young Song",
                "Hyuncheol Shin",
                "Hyeong-Seok Ko."
            ],
            "title": "Stable but nondissipative water",
            "venue": "ACM Trans. Graph. 24, 1 (2005), 81\u201397.",
            "year": 2005
        },
        {
            "authors": [
                "Haozhe Su",
                "Tao Xue",
                "Chengguizi Han",
                "Chenfanfu Jiang",
                "Mridul Aanjaneya."
            ],
            "title": "A unified second-order accurate in time MPM formulation for simulating viscoelastic liquids with phase change",
            "venue": "ACM Trans. Graph. 40, 4 (2021), 1\u201318.",
            "year": 2021
        },
        {
            "authors": [
                "Kazuhiko Suga",
                "Yoshiaki Kuwata",
                "K Takashima",
                "R Chikasue."
            ],
            "title": "A D3Q27 multiple-relaxation-time lattice Boltzmann method for turbulent flows",
            "venue": "Computers & Mathematics with Applications 69, 6 (2015), 518\u2013529.",
            "year": 2015
        },
        {
            "authors": [
                "Michael R Swift",
                "E Orlandini",
                "WR Osborn",
                "JM Yeomans."
            ],
            "title": "Lattice Boltzmann simulations of liquid-gas and binary fluid systems",
            "venue": "Physical Review E 54, 5 (1996), 5041.",
            "year": 1996
        },
        {
            "authors": [
                "Michael R Swift",
                "WR Osborn",
                "JM Yeomans."
            ],
            "title": "Lattice Boltzmann simulation of nonideal fluids",
            "venue": "Physical Review Letters 75, 5 (1995), 830\u2013833.",
            "year": 1995
        },
        {
            "authors": [
                "Nils Thuerey",
                "Filip Sadlo",
                "Simon Schirm",
                "Matthias M\u00fcller-Fischer",
                "Markus Gross."
            ],
            "title": "Real-time simulations of bubbles and foam within a shallow water framework",
            "venue": "Symposium on Computer Animation. 191\u2013198.",
            "year": 2007
        },
        {
            "authors": [
                "H.L. Wang",
                "Z.H. Chai",
                "B.C. Shi",
                "H. Liang."
            ],
            "title": "Comparative study of the lattice Boltzmann models for Allen-Cahn and Cahn-Hilliard equations",
            "venue": "Physical Review E 94, 3 (2016), 033304.",
            "year": 2016
        },
        {
            "authors": [
                "Chris Wojtan",
                "Matthias M\u00fcller-Fischer",
                "Tyson Brochu."
            ],
            "title": "Liquid simulation with mesh-based surface tracking",
            "venue": "ACM SIGGRAPH Course Notes (2011).",
            "year": 2011
        },
        {
            "authors": [
                "Xiao Yan",
                "Yun-Tao Jiang",
                "Chenfeng Li",
                "Ralph R. Martin",
                "Shi-Min Hu."
            ],
            "title": "Multiphase SPH simulation for interactive fluids and solids",
            "venue": "ACM Trans. Graph. 35, 4, Article 79 (2016).",
            "year": 2016
        },
        {
            "authors": [
                "Shuqi Yang",
                "Shiying Xiong",
                "Yaorui Zhang",
                "Fan Feng",
                "Jinyuan Liu",
                "Bo Zhu."
            ],
            "title": "Clebsch gauge fluid",
            "venue": "ACM Trans. Graph. 40, 4 (2021), 1\u201311.",
            "year": 2021
        },
        {
            "authors": [
                "Tao Yang",
                "Jian Chang",
                "Ming C. Lin",
                "Ralph R. Martin",
                "Jian J. Zhang",
                "Shi min Hu."
            ],
            "title": "A unified particle system framework for multi-phase, multi-material visual simulations",
            "venue": "ACM Trans. Graph. 36, 6 (2017), 224:1\u201313.",
            "year": 2017
        },
        {
            "authors": [
                "Xuewen Yin",
                "Junfeng Zhang."
            ],
            "title": "An improved bounce-back scheme for complex boundary conditions in lattice Boltzmann method",
            "venue": "J. Comput. Phys. 231, 11 (2012), 4295\u20134303.",
            "year": 2012
        },
        {
            "authors": [
                "Yonghao Yue",
                "Breannan Smith",
                "Christopher Batty",
                "Changxi Zheng",
                "Eitan Grinspun."
            ],
            "title": "Continuum foam: A material point method for shear-dependent flows",
            "venue": "ACM Trans. Graph. 34, 5 (2015), 160:1\u201320.",
            "year": 2015
        },
        {
            "authors": [
                "Fan Zhang",
                "Xiong Zhang",
                "Kam Yim Sze",
                "Yanping Lian",
                "Yan Liu."
            ],
            "title": "Incompressible material point method for free surface flow",
            "venue": "J. Comput. Phys. 330 (2017), 92\u2013110.",
            "year": 2017
        },
        {
            "authors": [
                "Yizhong Zhang",
                "Huamin Wang",
                "Shuai Wang",
                "Yiying Tong",
                "Kun Zhou."
            ],
            "title": "A Deformable Surface Model for Real-Time Water Drop Animation",
            "venue": "IEEE Trans. Vis. & Comp. Graph. 18, 8 (2012), 1281\u20131289.",
            "year": 2012
        },
        {
            "authors": [
                "HW Zheng",
                "Chang Shu",
                "Yong-Tian Chew."
            ],
            "title": "A lattice Boltzmann model for multiphase flows with large density ratio",
            "venue": "J. Comput. Phys. 218, 1 (2006), 353\u2013371.",
            "year": 2006
        },
        {
            "authors": [
                "Wen Zheng",
                "Jun-Hai Yong",
                "Jean-Claude Paul."
            ],
            "title": "Simulation of bubbles",
            "venue": "Graphical Models 71, 6 (2009), 229\u2013239.",
            "year": 2009
        },
        {
            "authors": [
                "Yongning Zhu",
                "Robert Bridson."
            ],
            "title": "Animating sand as a fluid",
            "venue": "ACM Trans. Graph. 24, 3 (2005), 965\u2013972.",
            "year": 2005
        },
        {
            "authors": [
                "Yingqing Zu",
                "Shuisheng He."
            ],
            "title": "Phase-field-based lattice Boltzmann model for incompressible binary fluid systems with density and viscosity contrasts",
            "venue": "Physical Review E 87, 4 (2013), 043301. ACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.",
            "year": 2013
        }
    ],
    "sections": [
        {
            "text": "HAL Id: hal-03828392 https://hal.science/hal-03828392\nSubmitted on 25 Oct 2022\nHAL is a multi-disciplinary open access archive for the deposit and dissemination of scientific research documents, whether they are published or not. The documents may come from teaching and research institutions in France or abroad, or from public or private research centers. L\u2019archive ouverte pluridisciplinaire HAL, est destin\u00e9e au d\u00e9p\u00f4t et \u00e0 la diffusion de documents scientifiques de niveau recherche, publi\u00e9s ou non, \u00e9manant des \u00e9tablissements d\u2019enseignement et de recherche fran\u00e7ais ou \u00e9trangers, des laboratoires publics ou priv\u00e9s.\nEfficient kinetic simulation of two-phase flows Wei Li, Yihui Ma, Xiaopei Liu, Mathieu Desbrun\nTo cite this version: Wei Li, Yihui Ma, Xiaopei Liu, Mathieu Desbrun. Efficient kinetic simulation of two-phase flows. ACM Transactions on Graphics, 2022, 41 (4), pp.114. 10.1145/3528223.3530132. hal-03828392\nEfficient Kinetic Simulation of Two-Phase Flows WEI LI, Inria YIHUI MA, ShanghaiTech University XIAOPEI LIU, ShanghaiTech University MATHIEU DESBRUN, Inria / Ecole Polytechnique\nReal-life multiphase flows exhibit a number of complex and visually appealing behaviors, involving bubbling, wetting, splashing, and glugging. However, most state-of-the-art simulation techniques in graphics can only demonstrate a limited range of multiphase flow phenomena, due to their inability to handle the real water-air density ratio and to the large amount of numerical viscosity introduced in the flow simulation and its coupling with the interface. Recently, kinetic-based methods have achieved success in simulating large density ratios and high Reynolds numbers efficiently; but their memory overhead, limited stability, and numerically-intensive treatment of coupling with immersed solids remain enduring obstacles to their adoption in movie productions. In this paper, we propose a new kinetic solver to couple the incompressible Navier-Stokes equations with a conservative phase-field equation which remedies these major practical hurdles. The resulting two-phase immiscible fluid solver is shown to be efficient due to its massively-parallel nature and GPU implementation, as well as very versatile and reliable because of its enhanced stability to large density ratios, high Reynolds numbers, and complex solid boundaries. We highlight the advantages of our solver through various challenging simulation results that capture intricate and turbulent air-water interaction, including comparisons to previous work and real footage.\nCCS Concepts: \u2022 Computing methodologies\u2192 Physical simulation.\nAdditional Key Words and Phrases: Multiphase flow, turbulent flow simulation, lattice Boltzmann method\nACM Reference Format: Wei Li, Yihui Ma, Xiaopei Liu, and Mathieu Desbrun. 2022. Efficient Kinetic Simulation of Two-Phase Flows. ACM Trans. Graph. 41, 4, Article 114 (July 2022), 17 pages. https://doi.org/10.1145/3528223.3530132\nAuthors\u2019 addresses: W. Li, M. Desbrun, Inria Saclay, Institut Polytechnique de Paris, 1 rue Honor\u00e9 d\u2019Estienne d\u2019Orves, 91120 Palaiseau, France; Y. Ma, X. Liu, Shanghaitech University, 393 Huaxia Middle Road, Shanghai 201210, China.\nThis is the author\u2019s version of the work."
        },
        {
            "heading": "1 INTRODUCTION",
            "text": "With recent advances in fluid simulation, visually-realistic digital representations of liquid motion have become commonplace in movie productions. While the early use of single-phase simulation [Foster and Fedkiw 2001; Zhu and Bridson 2005; Solenthaler and Pajarola 2009; Wojtan et al. 2011] offered only limited realism since the air surrounding the fluid was assumed to exert no pressure, multiphase flow simulation can exhibit a far richer palette of behaviors: the air-water and water-solid interactions often generate bubbles, splashes, glugging, and even the intricate wetting patterns that a fluid forms over hydrophilic or hydrophobic surfaces.\nOver the last decade, the animation of immiscible multiphase flows in graphics has successfully demonstrated complex behaviors of bubbles [Kim et al. 2010; Boyd and Bridson 2012; Ando et al. 2015], surface tension effects [Patkar et al. 2013; Da et al. 2016] and wetting [Zhang et al. 2012; Patkar and Chaudhuri 2013]. However, cinematic realism of complex water-air interactions calls for large density ratios (around 800 for the most common case of air vs. water) and high Reynolds numbers (Re>4, 000 for turbulent flows) to display the type of visual complexity that natural multiphase flow phenomena have to offer. These numerical requirements have been out of reach for state-of-the-art CG solvers, and remain a challenge even in computational fluid dynamics (CFD) [Lycett-Brown et al. 2014; Geier et al. 2015]. Recently, Li et al. [2021] introduced a kinetic approach which, for the first time, can simulate most of the typical multiphase flow phenomena, and for a range of fluid viscosity and density ratio that solvers in graphics strive to simulate in order to visually rival reality. This new solver relies on the lattice Boltzmann method (LBM) and uses a phase-field (PF) model to handle interfacial computations. However, their low-order collision model and boundary handling via simple bounce-back severely lack stability\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\n114:2 \u2022 Li, W. et al.\nwhen complex or fast air-fluid interactions occur, see Fig. 8. Moreover, its large memory footprint (in particular due to the encoding of the phase field via twenty-seven distribution functions) is a major impediment to its use in industrial applications.\nOverview. In this paper, we introduce a kinetic approach to multiphase fluid simulation particularly well suited to capture efficiently and robustly the intricate and visually-appealing behaviors of multiphase flows. We show that our LBM-PF numerical scheme offers a unified framework to simulate the wide gamut of multiphase flow behaviors as demonstrated for instance in Fig. 1. It is not only much more efficient in simulation time than many existing CG simulation techniques, but as accurate as (and more stable than) existing CFD approaches to multiphase flows as well, through the use of an accurate collision model (based on a non-orthogonal central-moment formulation) and a robust discretization of the Neumann boundary conditions on solid obstacles. Finally, its reduced memory footprint compared to previous kinetic two-phase flow solvers renders it particularly practical for CG applications."
        },
        {
            "heading": "2 PREVIOUS WORK",
            "text": "Before introducing our solver, it is instructive to briefly review existing work in multiphase fluid simulation to note the strengths and weaknesses of previous methods."
        },
        {
            "heading": "2.1 Free surface fluids",
            "text": "Lagrangian discretizations of fluid based on SPH were initially favored for their efficiency [Desbrun and Gascuel 1996; M\u00fcller et al. 2003]. The resulting visual blobbiness for low to medium particle counts was a major drawback of this family of approaches, even if various palliative treatments were formulated [Desbrun and CaniGascuel 1998; Zhu and Bridson 2005]. Improvements in incompressibility [Solenthaler and Pajarola 2009; Bender and Koschier 2016] and in the numerical treatment of free surface and solid boundaries [Schechter and Bridson 2012; Koschier and Bender 2017; Band et al. 2018] quickly followed. For viscous fluids, Particle-In-Cell [Foster and Metaxas 1996] (PIC) and Fluid-Implicit-Particle [Zhu and Bridson 2005; Batty and Bridson 2008; Cornels et al. 2014; Azevedo et al. 2016; Fu et al. 2017] (FLIP) techniques (or hybrid methods, such as [Cornels et al. 2014] mixing FLIP and SPH) were also successfully used. Nevertheless, a representation of the interface and its motion based on the level set method proved to be an attractive alternative to particle methods [Foster and Fedkiw 2001]. An improved control over local volume change [Enright et al. 2002, 2005; Kim et al. 2007]\nand adaptive sampling [Losasso et al. 2004; Heo and Ko 2010] allowed for detailed and realistic simulation of fluid flows, potentially post-processed to further enhance the visual appearance of small wrinkles on the fluid surface [Kim et al. 2013]. Other approaches to interface tracking, based on volume-of-fluid [Mihalef et al. 2004, 2006] or explicit mesh representations [Wojtan et al. 2011; BojsenHansen and Wojtan 2013; Chentanez et al. 2015; Bojsen-Hansen and Wojtan 2016; Da et al. 2016], have also been demonstrated; some hybrid methods can even capture sub-grid features such as thin liquid splashes, narrow air spaces, and droplets using cut-cells [Chen et al. 2020]. This whole family of free-surface methods is, however, limited by the fact that the air surrounding the fluid being simulated is always assumed to be exerting no pressure on the interface. Consequently, common fluid features such as bubbles cannot be directly simulated: a small amount of air trapped within the fluid will immediately collapse."
        },
        {
            "heading": "2.2 Navier-Stokes-based multiphase fluids",
            "text": "Ad-hoc inclusions of bubbles within a fluid can be performed efficiently [Kim et al. 2010; Thuerey et al. 2007; Goldade et al. 2020], but simulating the full spectrum of behaviors that multiphase flows exhibit has attracted increased attention over the past decade. A number of particle-based approaches were formulated: first, adapting SPH to handle multiple immiscible fluids of different densities using Navier-Stokes equations was introduced [Solenthaler and Pajarola 2008; Ren et al. 2014; Yan et al. 2016; Yang et al. 2017], followed by FLIP-based [Boyd and Bridson 2012] and MPM-based [Zhang et al. 2017; Yue et al. 2015; Gao et al. 2018] formulations. Exact volume preservation and improved treatment of surface tension and local momentum preservation near the interface were formulated using power particles [de Goes et al. 2015; Aanjaneya et al. 2017]. However, the blobbiness of these approaches limits their accuracy unless a huge number of particles is employed, which once again renders the use of interface tracking appealing. Both levelset (see, e.g., [Kim 2010] for the case of more than two immiscible fluids) and volume-of-fluid (VOF; see, e.g., [Cho and Ko 2013; Langlois et al. 2016]) discretizations have been used to encode the interface. Most related methods [Boyd and Bridson 2012; Kim et al. 2007; Losasso et al. 2006; Mihalef et al. 2006] rely on a variable density pressure projection [Kang et al. 2000] and the ghost fluid method [Hong and Kim 2005] to treat discontinuous jumps in fluid density and pressure at the interface, but a few authors proposed the use of a diffuse interface instead where the density is rapidly but smoothly changing [Song et al. 2005; Zheng et al. 2009].While this interface-tracking\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\nEfficient Kinetic Simulation of Two-Phase Flows \u2022 114:3\nfamily of approaches to multiphase flow simulation has been most popular, notable alternatives emerged too: an MPM formulation was introduced in [Su et al. 2021] to simulate viscoelastic liquids with phase change; a Lagrangian mesh-based approach to animate multiphase flow of immiscible fluid using unstructured moving meshes was also proposed for viscous fluids [Misztal et al. 2013]; and hybrid solvers using different numerical coupling between fluid velocity, pressure, and interface position were also explored [Saye 2016, 2017; Yang et al. 2021]. However, rare are the methods able to handle density ratios above 100, and none have demonstrated convincing results for turbulent flows. Additionally, many can only exhibit a subset of the typical multiphase flow phenomena such as bubbling, guggling, or wetting. Finally, just as argued in the single-phase case [Li et al. 2020], the efficiency of most of these incompressible Navier-Stokes solvers are hampered by their pressure projection step which does not parallelize well; moreover, capturing turbulent flows and proper interfacial forces both prevent the use of large time steps via stable semi-Lagrangian integration."
        },
        {
            "heading": "2.3 Kinetic multiphase fluids",
            "text": "While Navier-Stokes solvers are mainstream in graphics, the computational fluid dynamics (CFD) community has also explored so-called kinetic solvers for multiphase flow simulation, based on statistical physics where fluid dynamics is modeled through the evolution of a large number of microscopic fluid particles, moving and colliding: even at rest, fluid is not merely considered as a static continuum, but is teeming with molecules moving around. In the kinetic theory of statistical physics, these microscopic particles are efficiently encoded via a mesoscopic probability distribution of fluid particles. Formally, it employs a distribution function, \ud835\udc53 (\ud835\udc99, \ud835\udc97, \ud835\udc61), that indicates the probability for a microscopic particle to be at position \ud835\udc99 at time \ud835\udc61 and with velocity \ud835\udc97. Note that \ud835\udc97 denotes the possible velocity of a microscopic fluid particle, not the usual macroscopic fluid velocity u; for example, even for a fluid at rest (i.e., \ud835\udc96 = 0), the velocity \ud835\udc97 of a fluid particle may be arbitrarily away from zero: local fluid velocities just average to zero locally. The mesoscopic evolution of \ud835\udc53 is governed by the continuous Boltzmann equation,\n\ud835\udf15\ud835\udc53 \ud835\udf15\ud835\udc61 + \ud835\udc97 \u00b7 \u2207\ud835\udc53 = \u03a9(\ud835\udc53 \u2212 \ud835\udc53 eq) + \ud835\udc6d \u00b7 \u2207\ud835\udc97 \ud835\udc53 , (1)\nwhere \ud835\udc6d encapsulates all forcing terms (body and surface tension forces), while \u03a9 is the so-called collision term modeling the change\nof distribution function \ud835\udc53 (\ud835\udc99, \ud835\udc97, \ud835\udc61) due to particle collisions. This operator effectively models the relaxation process of \ud835\udc53 (\ud835\udc99, \ud835\udc97, \ud835\udc61) towards its local equilibrium state \ud835\udc53 eq, as a fluid over time tends to become distributed homogeneously if no external forces are applied. While this approach, called the lattice Boltzmannmodel (LBM), is used as is to simulate the motion of single-phase fluids, kineticmultiphase flow simulation requires introducing additional parameters to LBM that account for phase separation and interfacial tension. There exist six main families of approaches to that effect, derived from interparticlepotential models [Shan and Chen 1993, 1994; Chin 2002; Kang et al. 2004], multirange interaction models [Falcucci et al. 2007; Sbragaglia et al. 2007; Chibbaro et al. 2008], color-gradient models [Gunstensen et al. 1991; Grunau et al. 1993; Leclaire et al. 2011; Ba et al. 2016; Saito et al. 2018], pseudo-potential models [Swift et al. 1995; Shao et al. 2014; Niu et al. 2018], mean-field theory [He et al. 1998; Lee and Lin 2005; McCracken and Abraham 2005; Mukherjee and Abraham 2007a,b], or free-energy models [Orlandini et al. 1995; Swift et al. 1996; Holdych et al. 1998; Inamuro et al. 2000; Kalarakis et al. 2002; Zheng et al. 2006]. This last family is widely accepted as the current state-of-the-art approach for multiphase flows [Nabavizadeh et al. 2018]: it substitutes boundary conditions at the interface by a partial differential equation for the evolution of an auxiliary field called the phase field, based on a double-well potential describing the free energy density of the bulk of each phase. Yet, even if combining a phase field with an LBM simulation of the fluids can handle large density ratios or high Reynolds numbers, none of the existing CFD methods can handle these two required characteristics concurrently on a fixed grid resolution [Falcucci et al. 2011; Fakhari et al. 2017a]. Works in graphics usually have the same limitations (see, for instance, the two-phase kinetic method of [Guo et al. 2017] which only supports density ratios up to 20), with the notable exception of [Li et al. 2021] which has demonstrated stability over the widest range of density ratios and Reynold numbers thus far. However, this most recent work cannot handle thin obstacles and relies on a full D3Q27 lattice for the momentum and phase fields which imposes a much higher memory consumption (121 real numbers per grid node (Tab. 3) to store the current and previous time steps), hampering its wide adoption in practice since high-resolution simulations are usually sought after.\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\n114:4 \u2022 Li, W. et al."
        },
        {
            "heading": "2.4 Discussion",
            "text": "There appears to be a dichotomy between efficiency and memory usage in the current state-of-the-art methods in multiphase flow simulation: while LBM-based approaches have clearly an edge on efficiency (owing to their massively-parallel implementation and absence of pressure projection), they require up to ten times more memory than the traditional macroscopic solvers focusing on the macroscopic equations of motion. However, kinetic approaches have proven to be very accurate; in particular, they are able to simulate a range of turbulence and density ratios that is out of reach for the solvers currently used in graphics. Yet, the robustness with which one can hope to simulate complex air-water interactions leaves a lot to be desired: classical boundary treatments in LBM, based on bounce-back and/or the immersed boundary method, often generate spurious pressure fluctuations or phase leakage near solid boundaries in most challenging examples. Therefore, developing an efficient kinetic solver for multiphase flows that can accurately capture intricate behaviors such as wetting and guggling with a reasonable memory footprint would offer a valuable simulation tool likely to be adopted by the graphics industry."
        },
        {
            "heading": "3 OUR MULTIPHASE FLUID SOLVER",
            "text": "This section presents the core of our contributions to offer an efficient and versatile incompressible multiphase flow simulator."
        },
        {
            "heading": "3.1 Overview",
            "text": "We begin with a brief overview of our approach, before delving into the details of each component in the remainder of this section.\nFluid equations. The momentum and continuity equations for incompressible multiphase flows are often described macroscopically as [Kendon et al. 2001; Badalassi et al. 2003; Li et al. 2012]: \ud835\udf15\ud835\udf0c \ud835\udf15\ud835\udc61 + \u2207 \u00b7 (\ud835\udf0cu) = 0, \ud835\udf15(\ud835\udf0cu) \ud835\udf15\ud835\udc61 + \u2207\u00b7 (\ud835\udf0cuu) = \u2212\u2207\ud835\udc5d + \u2207\u00b7\u03a0 + F\ud835\udc60 + F\ud835\udc4f , \u2207 \u00b7 u = 0, (2a) (2b) (2c)\nwhere \ud835\udf0c and \ud835\udc96 are respectively the spatially-varying fluid density and velocity of the two fluids, \ud835\udc5d is the hydrodynamic pressure enforcing the incompressibility condition (2c), \u03a0 is the viscous stress tensor, while Fb and Fs are body and surface tension forces.\nOur approach at a glance. Given the clear benefits of kinetic solvers discussed in Sec. 2, we adopt a lattice Boltzmann approach for our multiphase flow solver, with a phase field model of the interface location. The phase field \ud835\udf19 (\ud835\udc65, \ud835\udc61) will be used to indicate density changes in space and time, with a steep change where the interface between the two fluids lies. Boundary conditions at the interface will be handled via this phase field, simplifying the simulation of flows with complex topology changes. However, we note that recent developments in computational multiphase flows have traded memory for stability: early works using a D3Q7 discretization for the phase field [Liang et al. 2018; Fakhari et al. 2019; Gruszczy\u0144ski et al. 2020] were often unstable for typical values of mobility, which recently prompted Li et al. [2021] to go with a D3Q27 lattice to palliate these issues, at the cost of a nearly four-fold increase in memory. Instead, we propose to keep a D3Q27 lattice to capture the\nvelocity field, but return to a D3Q7 lattice for the phase field, and increase the coupling accuracy \u2014 and thus stability \u2014 through a higher-order collision model and improved boundary treatments. Therefore, we perform an LBM-based integration of Eqs. (2) where the velocity and pressure fields are computed via a D3Q27-based distribution function \ud835\udc54 (Sec. 3.2), while the phase field encoding the density field (and thus, the interface between the two fluids) is handled via a D3Q7-based distribution function \u210e (Sec. 3.3). The collision operators for both distribution functions are computed in central moment space to offer improved accuracy, while coupling between the two distributions is achieved via forces derived from their respective moments."
        },
        {
            "heading": "3.2 Velocity-based fluid evolution",
            "text": "LBM solvers for single-phase fluids typically use a distribution function whose zeroth-order moments is the local fluid density. However, for multiphase flow simulations, a dedicated phase field is used to encode the spatially-varying density. Consequently, Fakhari et al. [2017b] proposed a change of variable (which we review in Sec. A of the supplemental material) such that the zeroth-order moment of the modified distribution function \ud835\udc54 is now proportional to the pressure, and for which the velocity can be deduced from the first-order moment and the forcing terms. We adopt this so-called\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\nEfficient Kinetic Simulation of Two-Phase Flows \u2022 114:5\n\u201cvelocity-based\u201d distribution function1 \ud835\udc54 in our multiphase fluid simulation. After this change of variable, discretizing time (with LBM-normalized time steps \ud835\udeff\ud835\udc61 =1), space (using the nodes of a regular grid with LBM-normalized \ud835\udeff\ud835\udc65 =1) and velocity directions (using discrete velocities {c\ud835\udc56 }0\u2264\ud835\udc56\u226426 at each grid node forming a D3Q27 lattice in 3D, see Fig. 6 (left)) turns Eq. (1) into the lattice-Boltzmann equations (LBE) of the form, for \ud835\udc56 =0...26:\n\ud835\udc54\ud835\udc56 (x + c\ud835\udc56 , \ud835\udc61 + 1) \u2212 \ud835\udc54\ud835\udc56 (x, \ud835\udc61) = \u03a9\ud835\udc54\ud835\udc56 (x, \ud835\udc61) +\ud835\udc3a\ud835\udc56 (x, \ud835\udc61), (3) where \ud835\udc54\ud835\udc56 represents the component of the distribution function in direction c\ud835\udc56 , while \u03a9 \ud835\udc54\n\ud835\udc56 and \ud835\udc3a\ud835\udc56 account for the collision and forcing\nterms respectively in this direction. The equilibrium distribution \ud835\udc54eq for this velocity-based formulation is now expressed as:\n\ud835\udc54 eq \ud835\udc56 = \u0393\ud835\udc56 + (\ud835\udc5d\u2217 \u2212 1)\ud835\udc64\ud835\udc50\ud835\udc56 \u2212 \ud835\udc3a\ud835\udc56\n2 , (4)\nwhere \ud835\udc5d\u2217 is the LBM-normalized pressure (i.e., the dimensionless pressure \ud835\udc5d equals \ud835\udf0c\ud835\udc502\ud835\udc5d\u2217 with \ud835\udc50 being the D3Q27 speed of sound equal to 1/ \u221a 3 in 3D),\ud835\udc64\ud835\udc50\n\ud835\udc56 is the lattice weight for direction c\ud835\udc56 , and\nthe distribution function \u0393 is expressed as:\n\u0393\ud835\udc56 = \ud835\udc64 \ud835\udc50\n\ud835\udc56\n( 1 + \ud835\udc84\ud835\udc56 \u00b7 \ud835\udc96\n\ud835\udc502 + (\ud835\udc84\ud835\udc56 \u00b7 \ud835\udc96)\n2\n2\ud835\udc504 \u2212 \ud835\udc96 \u00b7 \ud835\udc96 2\ud835\udc502\n) . (5)\nFinally, note that all the terms on the right-hand side of Eq. (2b) are counted as forcing terms in our multiphase context; that is, the components\ud835\udc3a\ud835\udc56 are the projections of the total force F composed of\nF = F\ud835\udc5d + F\ud835\udf07 + F\ud835\udc60 + F\ud835\udc4f , (6) where F\ud835\udc5d and F\ud835\udf07 correspond, respectively, to the pressure gradient and viscosity forces. Aside from the last term (which embodies body forces in the fluid), these forces depend on the phase field \ud835\udf19 so as to properly handle the interfacial coupling between the two fluids; we thus postpone discussing their expressions to Sec. 3.3.\nMacroscopic variables. In order to solve Eqs. (3), we proceed through Strang splitting by applying the traditional two-step (collisionstreaming) sequence, where the evaluation of the collision operator and forcing terms will be detailed next. The macroscopic hydrodynamic variables can be updated locally and independently through the moments of \ud835\udc54 and the forcing terms via:\n\ud835\udc5d\u2217 (x, \ud835\udc61) = \u2211\ufe01 \ud835\udc56 \ud835\udc54\ud835\udc56 (x, \ud835\udc61), u(x, \ud835\udc61) = \u2211\ufe01 \ud835\udc56 \ud835\udc54\ud835\udc56 (x, \ud835\udc61) \ud835\udc84\ud835\udc56 + F(x, \ud835\udc61) 2 . (7) While our multiphase framework so far is a mix of existing formulations (each chosen for their stability and accuracy properties), we differ significantly in our estimation of collision and forcing terms, as we extend a high order approximation (based on a centralmoment formulation) which has only been used for single-phase LBM [De Rosis et al. 2019; Li et al. 2020].\nHigh-order central-moment collision model. Early LBMworks used the Bhatnagar-Gross-Krook (BGK [Bhatnagar et al. 1954]) collision model, where the distribution function g is relaxed towards its equilibrium with a relaxation time \ud835\udf0f directly proportional to the kinematic viscosity through \ud835\udf0f = \ud835\udf08/\ud835\udc502. In our two-phase flow context, each flow has its own potentially different viscosity \u2014 but we will see in Eq. (12) that the local viscosity can be directly inferred from the value of the phase field, making this relaxation 1This naming stems from the fact that the first-order moment (described later in Eqs. (7)) is related to the velocity, instead of the momentum in single-phase LBM works.\ntime easily evaluated at each grid node. However, the poor numerical stability and results generated by this lattice BGK approximation due to truncation errors have led in the last decade to the proliferation of moment-based collision models: recent multiphase flow solvers have typically been using the multiple-relaxation-time (MRT) model [Fakhari et al. 2017a,b; Li et al. 2021], demonstrating far improved accuracy and stability over previous treatments. In our work, we adapt the high-order non-orthogonal central-moment multiple-relaxation-time (CM-MRT) model [Li et al. 2020] to our multiphase context instead to further enhance accuracy and stability. The idea is to project the \ud835\udc54\ud835\udc56 \u2212 \ud835\udc54eq\ud835\udc56 term first in a central moment space via a projection matrix, then relax each moment at a different time scale, then go back to the distribution space. We thus assemble the current vector g = (\ud835\udc540, \ud835\udc541, ..., \ud835\udc5426) of all distribution components at a given node and the vector geq of all equilibrium distribution components for this same node; to determine the equilibrium distribution geq, we take, instead of Eq. (5), the highest-order Hermite expansion of the distribution \u0393 (provided for the reader\u2019s convenience in Eq. (g) of the supplemental material). We then evaluate the vector \u03a9\ud835\udc54 = (\u03a9\ud835\udc540,\u03a9 \ud835\udc54 1, ...,\u03a9 \ud835\udc54\n26) containing all collision terms at the same node through:\n\u03a9\ud835\udc54 = \u2212M\u22121\ud835\udc50 S\ud835\udc50M\ud835\udc50 (g \u2212 geq), (8) where M\ud835\udc50 is the projection matrix to the central-moment space and the relaxation matrix S\ud835\udc50 is a diagonal matrix for which some of the diagonal values are related to the local kinematic viscosity \ud835\udf08 as detailed in [De Rosis et al. 2019]. We follow the approach of [Li et al. 2020] to compute the projection to and from the central moment space to improve computational efficiency. Note that this central moment based approach to collision is significantly more accurate than BGK: the dam break example from Fig. 5, for instance, cannot be completed with the BGKmodel unless the density ratio is lowered to 10. It is also better than the usual MRT treatment from [Suga et al. 2015; Fakhari et al. 2017b; Li et al. 2021] as Fig. 5 demonstrates: the spurious velocity artifacts present in the MRT approach are no longer visible when non-orthogonal central moment MRT is used.\nForce terms in central moment space. The highest-order Hermite expansion (sixth order in 3D) of the forcing terms\ud835\udc3a\ud835\udc56 yields a rather long expression [De Rosis et al. 2019]; see Eq. (h) of the supplemental material. Fortunately, one realizes that the projections ?\u0303?\ud835\udc56 of the \ud835\udc3a\ud835\udc56 terms onto the non-orthogonal central moment space greatly simplifies as many components vanish, leaving only a few nonzero components:\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\n114:6 \u2022 Li, W. et al.\n?\u0303?1 = \ud835\udc6d\ud835\udc65 \ud835\udf0c , ?\u0303?2 = \ud835\udc6d\ud835\udc66 \ud835\udf0c , ?\u0303?3 = \ud835\udc6d\ud835\udc67 \ud835\udf0c ,\n?\u0303?10 = 2\ud835\udc502 \ud835\udc6d\ud835\udc65 \ud835\udf0c , ?\u0303?11 = 2\ud835\udc502 \ud835\udc6d\ud835\udc66 \ud835\udf0c , ?\u0303?12 = 2\ud835\udc502 \ud835\udc6d\ud835\udc67 \ud835\udf0c ,\n?\u0303?23 = \ud835\udc50 4 \ud835\udc6d\ud835\udc65 \ud835\udf0c , ?\u0303?24 = \ud835\udc50 4 \ud835\udc6d\ud835\udc66 \ud835\udf0c , ?\u0303?25 = \ud835\udc50 4 \ud835\udc6d\ud835\udc67 \ud835\udf0c .\n(9)\nTherefore, starting from the 3D force vector \ud835\udc6d including all four terms (see Eq. (6)), we compute the terms ?\u0303?\ud835\udc56 from Eq. (9), assemble them into a vector G\u0303, then the final distribution components \ud835\udc3a\ud835\udc56 are found as the 27 coordinates of the vector G=M\u22121\ud835\udc50 G\u0303. Note that the original weighted MRT approach of Fakhari et al. [2017b] used an approximation to these forcing terms because they did not witness a noticeable difference with the proper MRT projection. This is not the case when central moments are used: the resulting increased accuracy is significant as our results will demonstrate."
        },
        {
            "heading": "3.3 Phase field evolution",
            "text": "In order to simulate a mixture of two immiscible, incompressible fluids with respective density \ud835\udf0c\ud835\udc3b and \ud835\udf0c\ud835\udc3f and respective viscosity \ud835\udf08\ud835\udc3b and \ud835\udf08\ud835\udc3f (where the subscripts \ud835\udc3b and \ud835\udc3f are used to differentiate the high-density fluid from the low-density fluid in our exposition), the diffuse phase field model [Kendon et al. 2001; Badalassi et al. 2003] proposes to introduce a time-varying phase function \ud835\udf19 (\ud835\udc65, \ud835\udc61) \u2208 [0, 1] as an order parameter to identify the regions occupied by the two fluids through:\n\ud835\udf19 (\ud835\udc65, \ud835\udc61) = {\n1 inside high-density fluid, 0 inside low-density fluid,\n(10)\nwith a smooth, thin transition layer of thickness \ud835\udf09 between the two fluids. A sharp location of the interface may thus be defined as the surface where the phase field takes the value \u00bd, but the purposely-continuous transition of the phase field allows to substitute boundary conditions at the interface by a partial differential equation for the evolution of the phase function to reproduce the correct interfacial dynamics. The density field \ud835\udf0c is then defined in space and time as:\n\ud835\udf0c (x, \ud835\udc61) = \ud835\udf0c\ud835\udc3f + (\ud835\udf0c\ud835\udc3b \u2212 \ud835\udf0c\ud835\udc3f)\ud835\udf19 (x, \ud835\udc61) . (11) The viscosity \ud835\udf08 is similarly expressed in space and time as:\n1 \ud835\udf08 (x) = 1 \ud835\udf08\ud835\udc3f + \ud835\udf19 (x) ( 1 \ud835\udf08\ud835\udc3b \u2212 1 \ud835\udf08\ud835\udc3f ) . (12)\nEquation of motion. A phase field model is usually constructed based on a free energy for the system, often involving a GinzburgLandau double-well potential describing the free energy density of the bulk of each phase and an interfacial Dirichlet energy. A conservative form of such an interface evolution was proposed in [Geier et al. 2015], resulting in a modified Allen-Cahn equation written as:\n\ud835\udf15\ud835\udf19 \ud835\udf15\ud835\udc61 + \u2207 \u00b7 (\ud835\udf19u) = \u2207 \u00b7\n[ \ud835\udc40 ( \u2207\ud835\udf19 \u2212 4\n\ud835\udf09 \ud835\udf19 (1 \u2212 \ud835\udf19)n\n) ] , (13)\nwhere n = \u2207\ud835\udf19/|\u2207\ud835\udf19 | represents the unit vector field aligned with the gradient of the phase function (thus orthogonal to the isovalue surfaces of the phase field), while the mobility parameter\ud835\udc40 controls the degree of interface splitting, i.e., small \ud835\udc40 implies greater ease for the interface to split due to a smaller influence of the interfacial Dirichlet energy. This equation is in divergence form, with the first divergence termmaking the phase field advected by the macroscopic fluid velocity u, while the right-hand side term is the sum of a\ndiffusive flux density\ud835\udc40\u2207\ud835\udf19 and a separation flux density that favors a predefined interface profile in 3D [Geier et al. 2015] of the form:\n\ud835\udf19 (x, \ud835\udc61) = 1 2\n[ 1 \u2212 tanh ( 2\ud835\udc51\ud835\udf19 (x) \ud835\udf09 )] . (14)\nwhere \ud835\udc51\ud835\udf19 (x) = \u00b1|x \u2212 x\u0304| is the signed distance of any point x to its orthogonal projection x\u0304 on the interface with \ud835\udf19 (x\u0304) = 1/2, while \ud835\udf09 controls the interfacial thickness.\nLBM discretization. In order to integrate Eq. (13) in time, we also base our approach on statistical physics to simplify the coupling between phase and fluid motion, but we use a D3Q7 lattice to dramatically reduce memory consumption compared to [Li et al. 2021]. Therefore, while we employ the same regular grid for the spatial discretization as for the fluid simulation, a set of only 7 lattice velocities in 3D (d0, ..., d6, see Fig. 6) are used, with associated quadrature weights {\ud835\udc64\ud835\udc51\n\ud835\udc56 }\ud835\udc56 and a speed of sound \ud835\udc51 =1/2. A distribution function\n\u210e is then used to find the phase field as its zeroth-order moment, i.e., we can evaluate the phase field at any node and any time through:\n\ud835\udf19 (x, \ud835\udc61) = \ud835\udc56=6\u2211\ufe01 \ud835\udc56=0 \u210e\ud835\udc56 (x, \ud835\udc61). (15)\nSolving the phase-field equation. The phase field equation (13) can then be solved using the distribution function \u210e whose components satisfy the lattice Boltzmann equations [Gruszczy\u0144ski et al. 2020]: \u210e\ud835\udc56 (x + d\ud835\udc56 , \ud835\udc61 + 1) \u2212 \u210e\ud835\udc56 (x, \ud835\udc61) = \u03a9\u210e\ud835\udc56 (x, \ud835\udc61) + \ud835\udc3b\ud835\udc56 (x, \ud835\udc61), (16) where the only force H acting on the phase field corresponds to the conservative term in the right-hand side of the phase equation [Wang et al. 2016], counteracting the diffusion of the phase-field and driving it to reach the predefined hyperbolic-tangent interface profile (Eq. (14)) in the equilibrium state. i.e.,:\nH = \ud835\udc512 4\ud835\udf19 (1 \u2212 \ud835\udf19)\n\ud835\udf09\n\u2207\ud835\udf19 |\u2207\ud835\udf19 | . (17)\nThe phase gradient\u2207\ud835\udf19 is evaluated using the second-order weighted estimate from [Li et al. 2021], i.e., we use:\n\u2207\ud835\udf19 = 2 3 \u2207 [\ud835\udc4e]\ud835\udf19 + 1 3 \u2207 [\ud835\udc4f ]\ud835\udf19, (18)\nusing the two rotationally-symmetric gradient approximations: \u2207 [\ud835\udc4e]\ud835\udf19 (x) = \u2211\ud835\udc56 3\ud835\udc64\ud835\udc50\ud835\udc56 c\ud835\udc56\ud835\udf19 (x + c\ud835\udc56 ),\n\u2207 [\ud835\udc4f ]\ud835\udf19 (x) = \u2211\ud835\udc56 3\ud835\udc64\ud835\udc50\ud835\udc56 c\ud835\udc56 4\ud835\udf19 (x+c\ud835\udc56 )\u2212\ud835\udf19 (x+2c\ud835\udc56 )2 . This phase-field force is projected in distribution space via:\n\ud835\udc3b\ud835\udc56 (x, \ud835\udc61) = \ud835\udc64\ud835\udc51\ud835\udc56 \ud835\udc85\ud835\udc56 \u00b7 H(x, \ud835\udc61)/\ud835\udc51 2 . (19)\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\nEfficient Kinetic Simulation of Two-Phase Flows \u2022 114:7\nCollision operator. While the forcing terms of Eq. (16) do not need any particular treatment due to their limited amplitude, a high accuracy for the collision term \u03a9\u210e\n\ud835\udc56 is key to the stability of the phase\nfield given the purposely-chosen low-order lattice.We thus employ a high-order (non-orthogonal) central-moment MRT model as we did for the fluid velocity. Concretely, the collision terms are evaluated as the component of a vector \u03a9\u210e = (\u03a9\u210e0 ,\u03a9 \u210e 1 , ...,\u03a9 \u210e 6 ) through\n\u03a9\u210e = \u2212M\u22121 \ud835\udc51 S\ud835\udc51M\ud835\udc51 (\u210e\ud835\udc56 \u2212 \u210e eq \ud835\udc56 ), (20)\nwhere the projection matrix M\ud835\udc51 is described in Sec. E of the supplemental material, the diagonal relaxation matrix S\ud835\udc51 is set as diag(1, 1/(4\ud835\udc40 + \u00bd), 1/(4\ud835\udc40 + \u00bd), 1/(4\ud835\udc40 + \u00bd), 3/2, 3/2, 3/2), while the phase-field equilibrium distribution functions are expressed as:\n\u210e eq \ud835\udc56\n= \ud835\udf19 \u0393\u210e\ud835\udc56 \u2212 \ud835\udc3b\ud835\udc56/2, (21) based on trapezoidal integration as described in Sec. A of the supplemental material, where \u0393\u210e\n\ud835\udc56 = \ud835\udc64\ud835\udc51 \ud835\udc56\n( 1 + \ud835\udc85\ud835\udc56 \u00b7\ud835\udc96\n\ud835\udc512\n) . The first four relaxation\ntimes in S\ud835\udc51 are physically imposed by the interface mobility; the two highest-order relaxation rates were chosen experimentally to maximize accuracy and stability. Other choices, like a regression-based selection [Li et al. 2020], could be used as well.\nCoupling forces. Finally, the fluid simulation from Sec. 3.2 requires an evaluation of forces allowing the proper coupling of the two phases, which we can now describe based on the phase field. For the surface tension force F\ud835\udc60 , we follow [Fakhari et al. 2017a] in using: F\ud835\udc60 = \ud835\udf12\ud835\udf19\u2207\ud835\udf19, (22) where the gradient is computed as in Eq. 18, while we use the definition of the chemical potential \ud835\udf12\ud835\udf19 proposed in [Jacqmin 1999]:\n\ud835\udf12\ud835\udf19 = 4\ud835\udefd\ud835\udf19 (\ud835\udf19 \u2212 1) (\ud835\udf19 \u2212 12 ) \u2212 \ud835\udf05\u2207 2\ud835\udf19, (23)\nwhere the second-order Laplacian of the phase is approximated as: \u22072\ud835\udf19 (x) = 6 \u2211\ufe01 \ud835\udc56 \ud835\udc64\ud835\udc50\ud835\udc56 (\ud835\udf19 (x + c\ud835\udc56 ) \u2212 \ud835\udf19 (x)) . (24) For the pressure force F\ud835\udc5d , we use the expression: F\ud835\udc5d = \u2212\ud835\udc5d\u2217 \ud835\udc502 \u2207\ud835\udf0c, (25) while the viscosity force F\ud835\udf07 is expressed as:\nF\ud835\udf07 = \ud835\udf08 [\u2207u + (\u2207u)\ud835\udc47 ]\u2207\ud835\udf0c, (26) where \ud835\udf08 is the spatially-varying kinematic viscosity from Eq. (12) while the gradient of density is easily rewritten as a rescaled gradient of\ud835\udf19 using Eq. (11). Note that these two last coupling forces, proposed by [Zu and He 2013], use terms like \ud835\udc5d\u2217 and u, thus depend on the zeroth and first moments of the other distribution functions \ud835\udc54\ud835\udc56 ."
        },
        {
            "heading": "3.4 Stable boundary treatment",
            "text": "While the description given thus far simulates a multiphase fluid flow very reliably over a large range of Reynolds numbers and density ratios, the treatment of obstacles is notorious for being particularly difficult to handle robustly: a poor treatment of the interaction between obstacles, fluid, and phase field can ruin stability, preventing the simulation of anything but trivial examples with grid-aligned boundaries. We present a series of measures that we have adopted, both for numerical stability and for efficiency of implementation, to ensure fool-proof stability and parallel efficiency while maintaining accuracy at an acceptable level for visual realism, both for thick and thin obstacles.\n3.4.1 Detecting and setting up cut-cells. Because we need to alter the updates of distribution functions near obstacles, we preprocess the simulation scene by first identifying cut cells, i.e., cells of the regular grid (used to discretize space) that straddle the boundary of at least one of the embedded obstacles. Contrary to [Lyu et al. 2021] that proceeds with samples spread over boundaries, we find the lattice links which cross a boundary directly through ray intersections with the triangle mesh(es) defining the obstacle boundaries in a preprocessing phase (see Fig. 7, left). Note that ray intersections allow us to deal with both thin shell obstacles and thick obstacles seamlessly. Any cell containing one of these straddling links is then tagged as a \u201ccut cell\u201d. A dedicated data structure is then assembled for each cut-cell node (i.e., each node belonging to one or more cut cells), so that we can efficiently process all such nodes adjacent to boundaries to reduce warp divergence due to branching for a massively-parallel implementation on GPU. For each cut-cell node x\ud835\udc58 , we store the indices of its boundary-crossing links (among the 26 links, which also include the 6 links used for the phase field, see Fig. 6), as well as the closest projection p\ud835\udc58 of this grid node onto the embedded boundary (computed by finding the closest triangle first through a GPU-based K-d tree, then finding the closest point of x\ud835\udc58 in that triangle). Our boundary handling can then be efficiently applied for all cull-cell nodes based on these precomputed elements. Note that our treatment can handle even very fine geometric features (see Fig. 3), while sample-based approaches such as [Lyu et al. 2021] would require an inordinate sample density to avoid leakage issues.\n3.4.2 Hybrid bounce-equilibrium streaming near boundaries. Integrating in time Eqs. (3) and (16) for the distribution functions \ud835\udc54 and \u210e involves a streaming stage, which needs to account for the \u201creflection\u201d of the fluid or phase particles against boundaries. A prominent approach to handling the streaming of distribution functions near boundaries is to use the bounce-back method [Ladd 1994], which performs a direction reversal of streaming on crossing links: the distribution value \ud835\udc54\ud835\udc56 (resp. \u210e\ud835\udc56 ) along the lattice direction c\ud835\udc56 is transferred to the distribution value \ud835\udc54\ud835\udc56\u2212 (resp. \u210e\ud835\udc56\u2212 ) for the direction c\ud835\udc56\u2212 =\u2212c\ud835\udc56 at the same node \u2014 with also a momentum transfer for moving boundary, which we do not consider here. This low-order approach is perfectly adequate for the phase field, as we only use the zeroth-order moment of \u210e. However, for \ud835\udc54, this bounce-back process is well-known to create spurious pressure fluctuations for large fluid velocity. These pressure artifacts trigger numerical instability, preventing simulations that involve complex boundaries or turbulent multiphase flows; see Fig. 8(a) for instance, where highfrequency artifacts in the velocity field of a dam-break simulation\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\ncan be seen extending up to the domain boundary. Higher-order accuracy has been proposed through interpolated bounce-backs [Kao and Yang 2008; Yin and Zhang 2012], but they involve a larger set of nodes near solid boundaries, which makes it more difficult to handle narrow boundary gaps. In our visual computing context, we stay with a first-order approximation so that we can keep our boundary handling treatment limited to cut cells for efficiency purposes, but we hybridize it with the use of the equilibrium distribution of the obstacle to significantly reduce pressure overshoots. Our approach can be understood as a modified version of the boundary treatment proposed in the single-phase flow simulation method of [Filippova and H\u00e4nel 1998]. In this work, the authors noted that the incoming distribution function coming from the boundary towards a fluid node along a boundary-crossing link can be partially approximated by the equilibrium distribution function of a point at the intersection of the link and the boundary, see Fig. 7(right). This approximation, also first-order accurate, is far less subject to numerical fluctuations and thus to instability as they directly rely on the relaxed state for which truncation errors have very little impact. In our context of fluid simulation with static obstacles, we can use a Neumann-pressure and zero-velocity boundary condition imposed on the obstacle to evaluate local values of f\u0302eq. Because our tests show improved stability with this approach compared to the original bounce-back streaming when the pressure near a boundary is small, we blend both approximations based on the amount of local pressure to promote stability while maintaining accuracy: it amounts to adapting the relaxation rate to reliably prevent overshoots. In practice, this means that we use the following streaming step for all cut-cell nodes:\n\ud835\udc54\ud835\udc56 (\ud835\udc61 + 1, x\ud835\udc58 ) = (1 \u2212 \ud835\udefc\ud835\udc58 ) \ud835\udc54\ud835\udc56\u2212 (\ud835\udc61, x\ud835\udc58 ) + \ud835\udefc\ud835\udc58 \ud835\udc53 eq \ud835\udc56\u2212 u=0,\ud835\udc5d\u2217=\ud835\udc5d\u2217 (x\ud835\udc58) , (27) where the blending coefficient is set to \ud835\udefc\ud835\udc58 = 3\u2225\ud835\udc5d\u2217x\ud835\udc58 \u2225 to safely suppresses pressure fluctuations near obstacles, see Fig. 8. Note that one can also use an equilibrium distribution based on \ud835\udc5d\u2217=0 to further dampen any spurious pressure artifact due to violent splashes on walls or obstacles, but now at the cost of decreased accuracy.\n3.4.3 Phase gradient near boundary and wetting control. Besides its obvious relevance to the phase field motion as discussed in Sec. 3.3, approximating the gradient \u2207\ud835\udf19 of the phase field is required in several force terms such as the surface, pressure, and viscosity forces,\nrespectively, Fs, Fp and F\ud835\udf07 . When evaluation is needed away from boundaries (and thus, not on cut-cell nodes), we use the weighted rotationally-symmetric evaluation proposed in [Li et al. 2021] as described in Eq. (18). However, the presence of obstacles nearby renders this approximation inappropriate, and thus, unstable in practice: it uses values of the phase field on the other side of the boundary, failing to account for the presence of the obstacle and for the implied Neumann condition. Using sided finite differences would not be able to impose the proper boundary conditions either. We thus reverse to the simple centered finite difference approximation of the gradient where extrapolated (ghost) values of the phase field \ud835\udf19 are used for the nodes on the other side of a boundary. Fig. 9 shows a 2D example where to calculate \u2207\ud835\udf19 on the fluid node x\ud835\udc58 , we need to deduce a ghost value of \ud835\udf19 on the node x\ud835\udc59 (which is on the other side of the boundary) so as to enforce boundary conditions. While one usually imposes zero Neumann boundary condition on the phase field of the form n \u00b7\u2207\ud835\udf19 =0 where n is the unit vector normal pointing outwards from the boundary, capturing the degree of wetting (the ability of a liquid to maintain contact with a solid surface, resulting from the balance between adhesive and cohesive intermolecular forces) requires to impose an arbitrary contact angle. A contact angle of less than 90\u25e6 between a liquid and a boundary implies that the fluid will tend to spread over a large area (hydrophilic behavior), whereas a greater contact angle indicates that the fluid will try to minimize contact with the boundary, forming instead compact liquid droplets (hydrophobic behavior). To impose a specified contact angle \ud835\udf03 at a solid boundary, the following wetting condition [Fakhari and Bolster 2017] has been formulated, stating that one should enforce at every point p on the boundary:\nn(p) \u00b7 \u2207\ud835\udf19 (p) = \u0398\ud835\udf19 (p) (1 \u2212 \ud835\udf19 (p)) for \u0398 = \u2212 \u221a\ufe01\n2\ud835\udefd/\ud835\udf05 cos\ud835\udf03 . Given a desired contact angle \ud835\udf03 , we can now find the \u201cghost\u201d value \ud835\udf19 (x\ud835\udc59 ) that imposes this condition at point p\ud835\udc59 , see Fig. 9. Indeed, from the closest point p\ud835\udc59 of x\ud835\udc59 (precomputed as explained in Sec. 3.4.1), we first find the intersection point q\ud835\udc59 on the line x\ud835\udc58x\ud835\udc5a in 2D, and we deduce its phase field from \ud835\udf19 (x\ud835\udc58 ) and \ud835\udf19 (x\ud835\udc5a) through barycentric coordinates \u2014 the same numerical approach is used in 3D. We then use the normal derivative imposed by the wetting condition to directly extrapolate the ghost value we seek, leading to:\n\ud835\udf19 (x\ud835\udc59 ) = \ud835\udefc + \ud835\udefd 2\ud835\udefc2\u0398\n( 1 + \ud835\udefc\u0398 \u2212 \u221a\ufe03 (1+\ud835\udefc\u0398)2 \u2212 4\ud835\udefc\u0398\ud835\udf19 (q\ud835\udc59 ) ) \u2212 \ud835\udefd \ud835\udefc \ud835\udf19 (q\ud835\udc59 ), (28)\nwhere \ud835\udefc and \ud835\udefd are shown in Fig. 9. When \ud835\udf03 = 90 (neutral wetting, i.e., zero Neumann condition), one uses simply: \ud835\udf19 (x\ud835\udc59 )=\ud835\udf19 (q\ud835\udc59 ).\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\nEfficient Kinetic Simulation of Two-Phase Flows \u2022 114:9\n3.4.4 Controlling norms. Another safety measure to enforce stability concerns the norms of the gradient of \ud835\udf19 and of forces. In the previous paragraph, we described how the phase gradient is computed so as to account for the boundary presence and the extended Neumann condition for wetting. To further combat possible numerical inaccuracies, we leverage the property that the profile of the phase field should remain close to the form of Eq. 14. Thus, given the macroscopic phase field value \ud835\udf19 at a cut-cell node, we know that its ideal gradient norm should thus be |\u2207\ud835\udf19\u2217 |=4\ud835\udf19 (1\u2212\ud835\udf19)/\ud835\udf09 . If we find out that the actual vector value of \u2207\ud835\udf19 has a norm larger than this ideal norm by 60%, we simply rescale the gradient vector. In practice, our tests show that this rescaling is triggered only in less than 5% of the cut-cell nodes on average \u2014 but this normalization often prevents blow-ups. A last modification we perform is that if one of the force magnitudes is more than 60 times larger than gravity and that the density of the light fluid is very low, we threshold forces where the phase \ud835\udf19 is below 0.1. In this specific case (which happens for strong splashes like in Fig. 4), instead of using the adaptive temporal method proposed in [Li et al. 2020], we can reduce the magnitude of the pressure, viscosity, and surface tension forces by 40% without affecting the motion: thresholding large \u201cimpulse\u201d forces does not affect the visual behavior significantly since it affects only the light fluid; this last safety measure improves stability without having to reduce time steps."
        },
        {
            "heading": "3.5 Discussion",
            "text": "Now that we have reviewed the details of our approach, we can discuss its most salient differences with the recent work of [Li et al. 2021]. First, our LBM formulation is different: we use a velocitybased lattice Boltzmann formulation instead of their moment-based formulation. This has already important consequences: since density is discontinuous in multiphase flows, the moment \ud835\udf0cu is much more prone to face instability at the interface [Kumar et al. 2019]; moreover, the forces F\ud835\udc5d and F\ud835\udf07 are evaluated calculated directly instead of being included implicitly in the distribution function, making the coupling between flow and interface more explicit. Additionally, the higher-order collision model we use for both \ud835\udc54 and \u210e brings numerical accuracy whose induced stability allows for more turbulent multiphase simulation, with density ratios of up to 1000 for a thinner phase interface than in [Li et al. 2021]. Another key difference is our treatment of boundaries which can handle complex obstacles that are either thick or thin, without suffering from possible leakages due to our proper one-sided approach to bounce-back. Memory requirements are also drastically reduced by our use of D3Q7 lattice for the phase field vs. the original D3Q27 lattice \u2014 we will also note in the implementation details listed in Sec. 4.2 that we employ the \u201cswap\u201d strategy from [Latt 2007a], bringing a memory usage reduction to around 60%. Moreover, we will leverage\nthe recent GPU parallel optimizations of [Chen et al. 2021], which will result in a typical four-fold speedup for resolutions around 400 \u00d7 200 \u00d7 200. Finally, all the safety measures listed in Sec. 3.4 to improve stability allow for larger effective time steps (typically, 50% larger), thus far improved efficacy; note that a reduced physical time step would remove the need for these numerical measures, but for computer graphics applications, efficiency (even at the cost of minor inaccuracy) is paramount."
        },
        {
            "heading": "4 RESULTS AND LIMITATIONS",
            "text": "We now cover the numerical experiments we conducted with our solver, to illustrate its accuracy, efficiency, and robustness via benchmark tests, complex scenarios, and comparisonswith existing solvers or real-life fluid motions."
        },
        {
            "heading": "4.1 Benchmark tests",
            "text": "We begin our tests with three classical benchmark examples.\nAdvection of phase field in prescribed velocity field. In order to test our kinetic phase field solver alone, we perform a passive advection of spherical shape in a prescribed vector field forming a typical shear flow as proposed in various previous works [Geier et al. 2015; Liang et al. 2018; Zu and He 2013]. The phase field (with \ud835\udc40 = 0.0035) is initialized on a regular grid of size 100\u00d7100\u00d7100 so that the interface forms a sphere of radius \ud835\udc45 = 20 centered at x0 = (30, 30, 50). The predefined vector field is defined on a grid node (\ud835\udc56, \ud835\udc57, \ud835\udc58) through:\nu = 0.02 \u00a9\u00ab cos\n[ \ud835\udc56\u221250 100 \ud835\udf0b ] ( sin [ \ud835\udc58\u221250 100 \ud835\udf0b ] \u2212 sin [ \ud835\udc57\u221250 100 \ud835\udf0b ] ) cos ( \ud835\udf0b \ud835\udc61 \ud835\udc47 ) cos [ \ud835\udc57\u221250 100 \ud835\udf0b ] ( sin [ \ud835\udc56\u221250 100 \ud835\udf0b ] \u2212 sin [ \ud835\udc58\u221250 100 \ud835\udf0b ] ) cos ( \ud835\udf0b \ud835\udc61 \ud835\udc47\n) cos [ \ud835\udc58\u221250 100 \ud835\udf0b ] ( sin [ \ud835\udc57\u221250 100 \ud835\udf0b ] \u2212 sin [ \ud835\udc56\u221250 100 \ud835\udf0b ] ) cos ( \ud835\udf0b \ud835\udc61 \ud835\udc47 ) \u00aa\u00ae\u00ae\u00ae\u00ae\u00ae\u00ae\u00ac . (29)\nWe visualize the phase field evolution by extracting its isovalue \u00bd in Fig. 10 Note that the sphere is supposed to be most deformed at \ud835\udc61 =\ud835\udc47 /2, before returning to its initial position after a period \ud835\udc47 . The \ud835\udc3f2 relative error \ud835\udf00 with respect to the initial value of the phase field after a full period, defined as\n\ud835\udf00 = \u221a\ufe04\u2211 \ud835\udc56 [\ud835\udf19 (x\ud835\udc56 ,\ud835\udc47 ) \u2212 \ud835\udf19 (x\ud835\udc56 , 0)]2\u2211\n\ud835\udc56 \ud835\udf19 2 (x\ud835\udc56 , 0)\n, (30)\nis listed in Tab. 1 along with other D3Q7-based [Fakhari et al. 2019] and D3Q19-based [De Rosis and Enan 2021] methods to evaluate its accuracy. We see that we improve upon the existing D3Q7 phase field by 33%, and reach an error equivalent to the 27-link lattice \u2014 but with the reduced memory size of the 7-link lattice.\nDroplet oscillation. Fig. 12 shows a three-dimensional elliptical droplet (density ratio 1000) which, due to the surface tension of the interface, oscillates around its spherical equilibrium shape. The\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\n114:10 \u2022 Li, W. et al.\nfluids inside and outside the droplet are slightly viscid, so the droplet eventually converges to a sphere.\nThree-dimensional Rayleigh Taylor instability. We also tested our solver on the classical Rayleigh-Taylor instability, where a heavy fluid is placed on top of a lighter fluid. The interface between the immiscible fluids should deform and exhibit Kelvin\u2013Helmholtz instabilities as the heavier fluid moves down and the lighter material is displaced upwards. We simulated this canonical case on a grid of size 64\u00d7256\u00d764, and for an interface width set to \ud835\udf09 =5. In order to compare our results to existing published examples, we initialize the two immiscible fluids as follows:\n\ud835\udf19 (x) = { 1, if \ud835\udc66 > 128 + 3.2 [ cos ( 2\ud835\udf0b \ud835\udc6564 ) + cos ( 2\ud835\udf0b \ud835\udc6764 ) ] ,\n0, otherwise, (31)\nand set the various dimensionless governing parameters as follows: Atwood number \ud835\udc34\ud835\udc61 = 0.5, capillarity number \ud835\udc36\ud835\udc4e = 960 and P\u00e9clet number \ud835\udc43\ud835\udc52 =256. The downwards vertical gravity g is set to have a magnitude |g|=\ud835\udc48 20 /64 for a reference velocity\ud835\udc480=0.04, and the gravitational force is defined as Fg= (\ud835\udf0c \u2212 \ud835\udf0c)g. Finally, the viscosity of both fluids is set to \ud835\udf08 =64 \u221a\ufe01 64|g|/\ud835\udc45\ud835\udc52 . We run this experiment for three different Reynolds numbers (\ud835\udc45\ud835\udc52 = 256, 3,000, and 30,000) as shown in Fig. 13, where the vertical walls are set to have periodic boundary conditions. As time goes on, the heavy and light fluids intertwine, forming mushroom-shaped downward spikes as the heavy fluid grows into the light fluid, and bubbles as the light fluid grows into the heavy fluid. Using time scale \ud835\udc47 = \u221a\ufe01 64/|g|, a first rollup of the heavy fluid occurs around \ud835\udc61 =2\ud835\udc47 at the four edges of the fluid field box. This roll-up interface becomes stronger in time.While there are no analytical solutions with which to compare, our results are consistent with published data for \ud835\udc45\ud835\udc52 =256 [He et al. 1999]: the accuracy of our results, measured by the vertical positions of the lowest point of the downward spike at different times, is shown in Tab. 2 and compared to previous works [De Rosis and Coreixas 2020; Lee and Kim 2013]. Note that with larger Reynolds numbers, we observe more vortical features near the four sides of the box as expected; but we were unable to compare our spike heights on these more inviscid cases despite results recently published in [De Rosis and Enan 2021] as we realized that their code is missing a division by \ud835\udf0c for the gravitational acceleration, rendering their heights in this turbulent case inconsistent."
        },
        {
            "heading": "4.2 Implementation details",
            "text": "While the overall structure of our solver is relatively simple (see the pseudocode in Alg. 1), a number of important implementation points deserve further discussions.\nMemory usage. Compared to recent LBM-based works in computer graphics, we reduce memory usage significantly. First, we employ the \u201cswap\u201d approach proposed in [Latt 2007b] and extend it to our GPU implementation. The basic idea is that the neighboring data copy in the streaming step is replaced by a swap operation with another existing variable, where no temporary memory is needed \u2014 thus reducing the amount of memory used for the distribution functions \ud835\udc54 and \u210e by a factor two. Moreover, using a D3Q7 lattice further reduces memory compared to the approach of [Li et al. 2021]. In the end, we save 73 variables per grid node in 3D compared to this latest work, for a total memory usage reduction of around 60%, see Tab. 3. Furthermore, we use a cut-cell buffer array to store precomputed closet points and intersection link flags as described in Sec. 3.4.1. When dealing with a cut-cell node, we access the necessary values from this cut-cell buffer array directly through an index array that saves the cut-cell node index in the cut-cell buffer array. Hence, memory consumption is limited to a size proportional to the area of the obstacle boundaries, which remain small in all of our examples.\nGPU-based implementation. Our multiphase flow solver uses only local computations, and can thus be easily implemented in amassivelyparallel fashion on a GPU. We adopt the structure-of-arrays (SoA) memory layout to improve cache utilization \u2014 and thus improve performance \u2014 as recommended for single-phase flow simulation in [Chen et al. 2021]. Moreover, we also employ the LU decomposition of\ud835\udc40\u22121\ud835\udc50 to speed up projections in and out of central-moment space as proposed in [Lyu et al. 2021]. For \ud835\udc54\ud835\udc52\ud835\udc5e in Eq. (4), we use an analytical expression that we derived directly in central-moment space (see Sec. F of the supplemental material) which saves further collision computations. Finally, prefetching distribution functions \ud835\udc54\ud835\udc56 from global to GPU shared memory significantly speeds up performance as threads can repeatedly access data much faster.\nEfficiency. While [Li et al. 2021] proposed a parallel implementation of their approach, we leverage all code accelerations mentioned in [Chen et al. 2021] which drastically improved efficiency. Due to our improved stability, our new approach also supports 25% larger\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\nEfficient Kinetic Simulation of Two-Phase Flows \u2022 114:11\ntime steps, meaning that our solver can use fewer iteration numbers for the same simulation sequence. As a consequence of all the differences we summarized in Sec. 3.5, we show in Fig. 14 that our approach is faster: based on a basic 3D dam break with obstacle from Fig. 8 and using the same GPU card, we improve upon their recent solver by almost a factor seven for low resolutions, and nearly four-fold for resolutions above 400\u00d7200\u00d7200."
        },
        {
            "heading": "4.3 Simulation results",
            "text": "All the examples of multiphase flows in the paper were run on a workstation equipped with a 16-core Intel(R) Xeon(R) Silver CPU, 128 GB of memory, and a NVIDIA RTX A6000 GPU. We used VRay [Chaos 2022] to render Figs. 1, 3, 22, and 17, while the other results were generated using our own renderer. We now discuss our results for various liquid simulations with complex, thin and/or thick static solids in order to illustrate the various properties of our solver. All of our simulation sequences involve a transparent container, and water splashes reaching these transparent walls thus form droplets that slide and merge, creating wetting patterns \u2014 the only exception being Fig. 17 where we set open boundary conditions for the phase field on the box to allow the water drops to fly off the domain in order not to obstruct the view. Note also that we use the Smagorinsky turbulence model to resolve flow details due to the limited grid resolution we use: an eddy viscosity \ud835\udf08 \u2032 is evaluated\naccording to [Geller et al. 2013] at each fluid node and added to the fluid viscosity \ud835\udf08 .\nALGORITHM 1: Pseudocode of our kinetic two-phase flow solver.\nCutCellsPreprocessing(); \u22b2 Secs. 3.4 and 4.2 \ud835\udc61 \u2190 0; while \ud835\udc61 < \ud835\udc47 do\nPerformCollisionForFlow(); \u22b2 Sec. 3.2 PerformCollisionForPhase(); \u22b2 Sec. 3.3 StreamingInRegular&CutCells(); \u22b2 Secs. 3.2 & 3.4.2 ComputeLow-OrderMoments(); \u22b2 Sec.3.2 CalculateForces(); \u22b2 Secs. 3.2 & 3.4.3 UpdateMacroscopicVariablesWithForces(); \u22b2 Eqs. (7) \ud835\udc61 \u2190 \ud835\udc61 + 1;\nend\nDam breaks. Testing the fall of a column of water and the subsequent breaking wave is a common test used in single- and multiphase flow solvers alike. We tested a simple 3D dam break with a rectangular box obstacle in Fig 5, showing that a low-order collision model like MRT creates spurious velocity artifacts (visualized via a 2D cut showing color-coded velocity magnitude), while the weighted MRT model used in [Li et al. 2021] leads to slightly noisy velocity field and does not capture very fine instability around the interface; our improved treatment using the central-moment space to compute the collision operator removes all these numerical issues. The same example is used again in Fig. 8 to demonstrate that the usual bounce-back approach to deal with streaming near obstacle boundaries can create severe artifacts, again in the form of oscillatory patterns which can make the simulation crash rather easily. Instead, our hybrid bounce-back prevents such artifacts. For this example, we also note that our new solver can support higher Reynolds numbers (by more than a factor six) and larger density ratios (by 25%) compared to [Li et al. 2021]. We also tested a dam break where a thin plate with a 30-degree incline is placed along the path; it exhibits a strong crown splash as the water hits the obstacle, see Fig. 4. This sort of thin crown water sheet cannot be captured by solvers with small to moderate numerical viscosity or\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\n114:12 \u2022 Li, W. et al.\nTable 4. Profiling. Timings of each key LBM step for [Li et al. 2021] and our algorithm. Collision refers to the computation of the collision operator for velocity and phase field, Streaming refers to the streaming update,Moments refers to the computation of the low-order moments, Forces represents the time needed to evaluate the various forces, and Updates refers to the macroscopic variables updates using forces.\nGrid [Li et al. 2021] Our solver resolution Collision Streaming Moments Forces Collision Streaming Moments Forces Updates 200\u00d7100\u00d7100 9.53ms 16.25ms 0.59ms 12.44ms 3.23ms 1.81ms 0.37ms 4.65ms 0.63ms 300\u00d7150\u00d7150 42.7ms 74.23ms 2.58ms 55.99ms 14.58ms 7.57ms 1.71ms 21.68ms 2.75ms 400\u00d7200\u00d7200 86.12ms 142.78ms 5.14ms 109.21ms 30.44ms 16ms 3.44ms 43.03ms 5.6ms 500\u00d7250\u00d7250 192.24ms 324.99ms 12.21ms 237.86ms 68.68ms 37.03ms 8.44ms 96.42ms 13.13ms 600\u00d7300\u00d7300 281.71ms 492.71ms 18.56ms 376.28ms 108.41ms 58.13ms 11.99ms 147.35ms 22.92ms\nwithout a very accurate treatment of the collision operator. Bubbles and splashing foam form when the water reaches the right wall, while wetting patterns are also appearing as water spills onto the four transparent walls of the container. Note that our boundary treatment allows for such thin obstacles without instability issues, and does not suffer from the leakage problems that are typical of the immersed boundary method used in common LBM solvers. A different type of 3D dam break, this time with a thicker obstacle in the shape of a car, is demonstrated in Fig. 15. Clear wetting is visible on the car surface after the initial splash, while bubbles are also present as the flow subsides. Finally, we provide a last dam break example where we imitate the setup proposed in [Chen et al. 2020], where a dam break is set up to force the water to go through a fixed comb-like structure with narrow slits: we show in Fig. 16 that the liquid flows through the slits realistically, not only on the\nFig. 16. Comparison with [Chen et al. 2020]. While current singlephase flow solvers have demonstrated the ability to capture liquids flowing through narrow slits (left), our approach can not only simulate similar scenarios, but exhibits also bubbles and wetting.\nway down but also after the wave reflects back and forth in the container. We also demonstrate in Fig. 21 that the grid resolution for this simulation has obvious effects on how small the details of a flow can be captured; however, the overall motion is well captured even with five times fewer degrees of freedom. Chen et al. [2020] reported a computational time per frame of 90s. using a NVIDIA GeForce GTX 1080Ti; a slightly higher resolution takes 18s. for our solver on the same card, and only 7.5s. on our current machine.\nMultiphase flows with complex obstacles. We also tested our solver robustness by simulating very complex obstacles as well. Fig. 3 shows a flow through a pumice-like porous rock, which is a very challenging scenario to simulate due to the large number of cut-cells. The water goes through all the irregular holes and tunnels, at times forming bubbles, while water filaments and drops appear at the bottom of the rock as the water exits. We also show an example of water going through a colander in Fig. 1: water is dropped suddenly inside the colander, and goes through the little interstices at high speed, creating a crown-like structure; some of the water hits the inside and regroups before going through the same interstices in a second wave. We also demonstrate robustness to complex objects in Fig. 18, where a water column comes crashing down on a loosely woven basket. Here again, the complexity of the shape and topology of the basket made out of thin structures is a great stress test for\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\nEfficient Kinetic Simulation of Two-Phase Flows \u2022 114:13\nboundary handling, and our solver is able to handle the simulation both robustly and efficiently.\nTurbulent air-driven flows. Finally, we show a few examples of flows entirely driven by air motion, another stress test for any multiphase flow solver. Fig. 2 shows air being blown through a straw immersed in a water container. We impose a sine-wave speed on the inlet at the top of the straw; bubbles form below the straw as the air makes its way down the straw, then go up before bursting on top of the liquid surface. Fig. 17 shows, instead, a still pool over which four very strong air jets blow horizontally, lifting water up in the air, and generating a very turbulent motion. Note that this case uses open boundaries for the phase field, so that droplets that fly off are simply disappearing instead of crashing onto the transparent walls: this allows for a much more obvious visualization, unobstructed by a multitude of wetting patterns."
        },
        {
            "heading": "4.4 Comparisons",
            "text": "Finally, we provide a few comparisons, both with previous work and with real video-recorded flows. Fig. 16 was inspired by an example found in [Chen et al. 2020], where water is flowing through narrow slits. Not only we are able to handle this challenging scenario at a similar resolution, but we provide a full two-phase simulation instead of their single-phase result: the presence of bubbles and more realistic behavior of the flow ensues. We also compared our solver to\nthe recent multiphase solver of [Li et al. 2021] in Fig. 5 as discussed earlier: while oscillations can be easily triggered when strong interaction with boundaries occur in their results, our approach has no such behavior \u2014 even for Reynolds numbers six times higher than\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\n114:14 \u2022 Li, W. et al.\nwhat they can support \u2014 and yet, as discussed in Sec. 4.2, our solver requires less memory and less time. Fig. 19 also demonstrates that the increased accuracy of our higher-order collision model leads to simulations much less sensitive to grid resolution, and allows for much less viscous fluids. We note additionally that the complex obstacles like Fig. 3 or thin shells like Figs. 1, 4, and 18 would not be possible to handle with their solver either: their boundary treatment prevents the use of thin shells, and obstacles have to be voxelized. As a last example, we show in Fig. 20 that a real colander exhibits a very similar behavior to what we showed in Fig. 1: while the shape of the strainer is a bit different (in particular, its curvature at the bottom) and it is placed on top of a glass, one can see a number of qualitative similarities, for instance, the same two-crown splashing behavior as the water falls through the interstices."
        },
        {
            "heading": "4.5 Limitations and future work",
            "text": "While our work overcomes a number of numerical hurdles in the simulation of binary fluids and allows for the simulation of everyday\u2019s phenomena where two fluids commingle, it is not without limitations. First, we remain limited in the highest Reynold number we can handle: extremely turbulent fluids would require higher accuracy to be captured precisely; thankfully, this limitation is not\nquite stringent for graphics as it is less relevant to our typical applications. Second, the ratio of fluid density is also limited \u2014 but here again, the fact that we can, at last, capture typical intricate air-water interactions is largely sufficient in most cases. Third, like other purely Eulerian methods, phase fields on very coarse grids can lead to disappearing droplets. Our conservative treatment limits this issue quite drastically, but rapid motions can still generate numerical diffusion resulting in a spurious shift of the fluid/air interface; a mix of phase field and particles (\u00e0 la particle-levelset) could prevent this issue at the cost of constant reseeding of particles near the interface, offering a robust solution for coarse grids. Fourth, applying adaptive mesh refinement in 3D would also allow for a better capture of boundary layers than our current use of a fixed regular grid; an approach based on multiple grid resolutions as described in [Li et al. 2019] or [Fakhari et al. 2017a] could lead to much finer details, at the cost of memory and computational time increase. Fifth, it could be useful to extend our approach to many fluids instead of just two, as was done for Navier-Stokes solvers with an implicit encoding of the interface [Kim et al. 2010]; the recent work of Hu et al. [2020] could help in this regard. Sixth, our smeared interface is not able to properly handle bubble foam; mixing our work with an ad-hoc representation of foam [Kim et al. 2007; Busaryev et al. 2012] would be an interesting improvement. Finally, we only demonstrated the motion of binary fluids interacting with complex, but static obstacles. Offering stable one-way and two-way dynamic coupling in this multiphase flow context would open the door to many additional simulation scenarios. Note that it is, in fact, relatively easy to handle dynamic immersed solids: one needs to update the list of cut cells and cut-cell nodes at each time step, and could use the kernel-based penalty force (\u00e0 la immersed boundary method) and dimension scaling proposed in [Li et al. 2020] to couple fluids and solids. This obviously incurs additional overhead, but allows us to seamlessly extend our work for non-trivial cases as shown in Figs. 22 and 23, where we show propellers inducing bubbles and waves, as well as a rotating tire splashing water. However, the typical \u201cleakage\u201d issue of the immersed boundary method renders this approach limited and\nACM Trans. Graph., Vol. 41, No. 4, Article 114. Publication date: July 2022.\nEfficient Kinetic Simulation of Two-Phase Flows \u2022 114:15\nbrittle. Moreover, the cases we show do not use high velocities: such a simple one-way coupling treatment is nowhere near as stable as what we proposed in this paper for static obstacles: our contributions to ensure robustness for static obstacles do not suffice in the case of fast-evolving solid objects. We leave a proper extension of one- or two-way coupling for future work, as the same level of stability for full coupling in LBM-based multiphase flow simulation would offer an exciting framework for more advanced simulation scenarios."
        },
        {
            "heading": "5 CONCLUSION",
            "text": "While computer animation has generated exquisite simulations of viscous fluids (from dough to syrupy fluids) using the (macroscopic) Navier-Stokes equations, simulating nearly inviscid incompressible fluids such as water remains a major challenge. Moreover, capturing the fine interaction between water and air that we encounter in our daily lives requires a solver that can handle large density ratios, adding more numerical difficulty. In this paper, we proposed\na kinetic solver that offers an effective and unified computational framework to capture most of the salient multiphase flow behaviors seen in everyday life. Through a higher-order collision operator and a number of contributions to handle boundary conditions robustly, our two-phase immiscible fluid solver can simulate real-life density ratios (800 for air-water) and Reynolds numbers (\ud835\udc45\ud835\udc52 > 4000 for interesting turbulent flows) both faithfully and efficiently, for complex obstacles \u2014 be they thin or thick. Its statistical mechanics nature allows for a massively-parallel implementation on GPU, ensuring an efficiency superior to existing methods, while reducing the memory usage compared to other kinetic solvers. For future work, we plan on removing the limitations listed in Sec. 4.5. Improving the resolution of the phase field through the use of adaptive grids is a particularly interesting research direction. Finally, addressing the case of coupling fluids with deformable solids would bring a whole slew of interesting applications such as blood flow simulation."
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "Meshes are courtesy of Technische Universit\u00e4t M\u00fcnchen (Figs. 15 and 23), Dhanasekar Vinayagamoorthy (Fig. 22), and kathzerrato (Fig. 18). The colander video is from Chu Huarong (Fig. 20). The authors would like to thank the reviewers for their constructive comments. XPL acknowledges grant no. 62072310 from the National Natural Science Foundation of China; MD acknowledges the generous support of a Choose France Inria chair, and of Ansys, Inc."
        }
    ],
    "title": "Efficient kinetic simulation of two-phase flows",
    "year": 2024
}