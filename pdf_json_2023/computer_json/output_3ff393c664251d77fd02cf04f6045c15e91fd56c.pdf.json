{
    "abstractText": "Procuring flexibility services from energy consumers has been a potential solution to accommodating renewable generations in future power system. However, efficiently and securely coordinating the behaviors of diverse market participants within a privacy-preserving environment remains a challenge. This paper addresses this issue by introducing a game-theoretic market framework for real-time energy balancing. The competition among energy consumers is modeled as a Generalized Nash Game (GNG), which enables the analysis of their strategic decisionmaking. To mitigate the market power exerted by active energy consumers, we employ a supply function-based bidding method in this market design. We incorporate physical constraints to ensure the secure operation of the distribution network. Previous approaches to steering consumers towards the Generalized Nash Equilibrium (GNE) of this game often necessitate the sharing of private information, either in full or in part, which may not be practically feasible. To overcome this limitation, we propose a preconditioned forward-backward algorithm, with analytical convergence guarantees, that only requires participants to share limited, non-private sensitive information with others. Finally, numerical simulations on the enhanced IEEE 33-bus test case validate the effectiveness of our proposed market mechanism and algorithm.",
    "authors": [
        {
            "affiliations": [],
            "name": "Xiupeng Chen"
        },
        {
            "affiliations": [],
            "name": "Koorosh Shomalzadeh"
        },
        {
            "affiliations": [],
            "name": "Jacquelien M. A. Scherpen"
        },
        {
            "affiliations": [],
            "name": "Nima Monshizadeh"
        }
    ],
    "id": "SP:384f1f00f92d1fd7468520951c634adf9fb0a23b",
    "references": [
        {
            "authors": [
                "S.R. Sinsel",
                "R.L. Riemke",
                "V.H. Hoffmann"
            ],
            "title": "Challenges and solution technologies for the integration of variable renewable energy sources\u2014a review",
            "venue": "renewable energy, vol. 145, pp. 2271\u20132285, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "L. Silva-Rodriguez",
                "A. Sanjab",
                "E. Fumagalli",
                "A. Virag",
                "M. Gibescu"
            ],
            "title": "Short term wholesale electricity market designs: A review of identified challenges and promising solutions",
            "venue": "Renewable and Sustainable Energy Reviews, vol. 160, p. 112228, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "A. Vicente-Pastor",
                "J. Nieto-Martin",
                "D.W. Bunn",
                "A. Laur"
            ],
            "title": "Evaluation of flexibility markets for retailer\u2013dso\u2013tso coordination",
            "venue": "IEEE Transactions on Power Systems, vol. 34, no. 3, pp. 2003\u20132012, 2018.",
            "year": 2003
        },
        {
            "authors": [
                "S. Bahramara",
                "M. Yazdani-Damavandi",
                "J. Contreras",
                "M. Shafie-Khah",
                "J.P. Catal\u00e3o"
            ],
            "title": "Modeling the strategic behavior of a distribution company in wholesale energy and reserve markets",
            "venue": "IEEE Transactions on Smart Grid, vol. 9, no. 4, pp. 3857\u20133870, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "T. Morstyn",
                "A. Teytelboym",
                "M.D. McCulloch"
            ],
            "title": "Designing decentralized markets for distribution system flexibility",
            "venue": "IEEE Transactions on Power Systems, vol. 34, no. 3, pp. 2128\u20132139, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "T. Jiang",
                "C. Wu",
                "R. Zhang",
                "X. Li",
                "H. Chen",
                "G. Li"
            ],
            "title": "Flexibility clearing in joint energy and flexibility markets considering tso-dso coordination",
            "venue": "IEEE Transactions on Smart Grid, vol. 14, no. 2, pp. 1376\u20131387, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "W. Saad",
                "Z. Han",
                "H.V. Poor",
                "T. Basar"
            ],
            "title": "Game-theoretic methods for the smart grid: An overview of microgrid systems, demand-side management, and smart grid communications",
            "venue": "IEEE Signal Processing Magazine, vol. 29, no. 5, pp. 86\u2013105, 2012.",
            "year": 2012
        },
        {
            "authors": [
                "W. Tushar",
                "T.K. Saha",
                "C. Yuen",
                "D. Smith",
                "H.V. Poor"
            ],
            "title": "Peer-topeer trading in electricity networks: An overview",
            "venue": "IEEE Transactions on Smart Grid, vol. 11, no. 4, pp. 3185\u20133200, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "M.K. Mishra",
                "S. Parida"
            ],
            "title": "A game theoretic horizon decomposition approach for real-time demand-side management",
            "venue": "IEEE Transactions on Smart Grid, vol. 13, no. 5, pp. 3532\u20133545, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "X. Li",
                "C. Li",
                "G. Chen",
                "Z.Y. Dong"
            ],
            "title": "A data-driven joint chanceconstrained game for renewable energy aggregators in the local market",
            "venue": "IEEE Transactions on Smart Grid, vol. 14, no. 2, pp. 1430\u20131440, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "H. Chen",
                "Y. Li",
                "R.H. Louie",
                "B. Vucetic"
            ],
            "title": "Autonomous demand side management based on energy consumption scheduling and instantaneous load billing: An aggregative game approach",
            "venue": "IEEE transactions on Smart Grid, vol. 5, no. 4, pp. 1744\u20131754, 2014.",
            "year": 2014
        },
        {
            "authors": [
                "M. Hupez",
                "J.-F. Toubeau",
                "I. Atzeni",
                "Z. De Gr\u00e8ve",
                "F. Vall\u00e9e"
            ],
            "title": "Pricing electricity in residential communities using game-theoretical billings",
            "venue": "IEEE Transactions on Smart Grid, vol. 14, no. 2, pp. 1621\u20131631, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "K. Ma",
                "G. Hu",
                "C.J. Spanos"
            ],
            "title": "Distributed energy consumption control via real-time pricing feedback in smart grid",
            "venue": "IEEE Transactions on Control Systems Technology, vol. 22, no. 5, pp. 1907\u20131914, 2014.",
            "year": 1907
        },
        {
            "authors": [
                "A. Cherukuri",
                "J. Cort\u00e9s"
            ],
            "title": "Iterative bidding in electricity markets: rationality and robustness",
            "venue": "IEEE Transactions on Network Science and Engineering, vol. 7, no. 3, pp. 1265\u20131281, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "J. Wang",
                "H. Zhong",
                "Z. Yang",
                "X. Lai",
                "Q. Xia",
                "C. Kang"
            ],
            "title": "Incentive mechanism for clearing energy and reserve markets in multi-area power systems",
            "venue": "IEEE Transactions on Sustainable Energy, vol. 11, no. 4, pp. 2470\u20132482, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "P.D. Klemperer",
                "M.A. Meyer"
            ],
            "title": "Supply function equilibria in oligopoly under uncertainty",
            "venue": "Econometrica: Journal of the Econometric Society, pp. 1243\u20131277, 1989. x",
            "year": 1989
        },
        {
            "authors": [
                "R.J. Green",
                "D.M. Newbery"
            ],
            "title": "Competition in the british electricity spot market",
            "venue": "Journal of political economy, vol. 100, no. 5, pp. 929\u2013953, 1992.",
            "year": 1992
        },
        {
            "authors": [
                "Y. Chen",
                "C. Zhao",
                "S.H. Low",
                "S. Mei"
            ],
            "title": "Approaching prosumer social optimum via energy sharing with proof of convergence",
            "venue": "IEEE Transactions on Smart Grid, vol. 12, no. 3, pp. 2484\u20132495, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "Z. Wang",
                "F. Liu",
                "Z. Ma",
                "Y. Chen",
                "M. Jia",
                "W. Wei",
                "Q. Wu"
            ],
            "title": "Distributed generalized nash equilibrium seeking for energy sharing games in prosumers",
            "venue": "IEEE Transactions on Power Systems, vol. 36, no. 5, pp. 3973\u20133986, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "Y. Chen",
                "C. Zhao",
                "S.H. Low",
                "A. Wierman"
            ],
            "title": "An energy sharing mechanism considering network constraints and market power limitation",
            "venue": "IEEE Transactions on Smart Grid, vol. 14, no. 2, pp. 1027\u20131041, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "N. Li",
                "L. Chen",
                "M.A. Dahleh"
            ],
            "title": "Demand response using linear supply function bidding",
            "venue": "IEEE Transactions on Smart Grid, vol. 6, no. 4, pp. 1827\u20131838, 2015.",
            "year": 1827
        },
        {
            "authors": [
                "Y. Xu",
                "N. Li",
                "S.H. Low"
            ],
            "title": "Demand response with capacity constrained supply function bidding",
            "venue": "IEEE Transactions on Power Systems, vol. 31, no. 2, pp. 1377\u20131394, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "A.A. Kulkarni",
                "U.V. Shanbhag"
            ],
            "title": "On the variational equilibrium as a refinement of the generalized nash equilibrium",
            "venue": "Automatica, vol. 48, no. 1, pp. 45\u201355, 2012.",
            "year": 2012
        },
        {
            "authors": [
                "L. Pavel"
            ],
            "title": "Distributed gne seeking under partial-decision information over networks via a doubly-augmented operator splitting approach",
            "venue": "IEEE Transactions on Automatic Control, vol. 65, no. 4, pp. 1584\u20131597, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "G. Belgioioso",
                "S. Grammatico"
            ],
            "title": "Semi-decentralized generalized nash equilibrium seeking in monotone aggregative games",
            "venue": "IEEE Transactions on Automatic Control, vol. 68, no. 1, pp. 1584\u20131597, 2023.",
            "year": 2023
        },
        {
            "authors": [
                "G. Belgioioso",
                "W. Ananduta",
                "S. Grammatico",
                "C. Ocampo-Martinez"
            ],
            "title": "Operationally-safe peer-to-peer energy trading in distribution grids: A game-theoretic market-clearing mechanism",
            "venue": "IEEE Transactions on Smart Grid, vol. 13, no. 4, pp. 2897\u20132907, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "G. Belgioioso",
                "S. Grammatico"
            ],
            "title": "Projected-gradient algorithms for generalized equilibrium seeking in aggregative games are preconditioned forward-backward methods",
            "venue": "2018 European Control Conference (ECC). IEEE, 2018, pp. 2188\u20132193.",
            "year": 2018
        },
        {
            "authors": [
                "J. Villar",
                "R. Bessa",
                "M. Matos"
            ],
            "title": "Flexibility products and markets: Literature review",
            "venue": "Electric Power Systems Research, vol. 154, pp. 329\u2013 340, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "J. Yang",
                "N. Zhang",
                "C. Kang",
                "Q. Xia"
            ],
            "title": "A state-independent linear power flow model with accurate estimation of voltage magnitude",
            "venue": "IEEE Transactions on Power Systems, vol. 32, no. 5, pp. 3607\u20133617, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "F. Facchinei",
                "J.-S. Pang"
            ],
            "title": "Finite-dimensional variational inequalities and complementarity problems",
            "year": 2003
        },
        {
            "authors": [
                "D. Paccagnan",
                "R. Chandan",
                "J.R. Marden"
            ],
            "title": "Utility and mechanism design in multi-agent systems: An overview",
            "venue": "Annual Reviews in Control, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "S.H. Dolatabadi",
                "M. Ghorbanian",
                "P. Siano",
                "N.D. Hatziargyriou"
            ],
            "title": "An enhanced ieee 33 bus benchmark test system for distribution system studies",
            "venue": "IEEE Transactions on Power Systems, vol. 36, no. 3, pp. 2565\u2013 2572, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "S. Boyd",
                "E. Ryu"
            ],
            "title": "A primer on monotone operator methods (survey)",
            "venue": "Applied and Computational Mathematics, vol. 15, no. 1, pp. 3\u201343, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "D.S. Bernstein"
            ],
            "title": "Matrix mathematics",
            "venue": "Matrix Mathematics. Princeton university press, 2009.",
            "year": 2009
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014Flexibility services, generalized Nash game, supply function bidding, balancing market.\nNOMENCLATURE\nAbbreviations, sets, operators GNG Generalized Nash Game GNE Generalized Nash Equilibrium v-GNE variational Generalized Nash Equilibrium NE Nash Equilibrium DSO Distribution System Operator BRP Balance Responsible Party PoA Price of Anarchy N set of active consumers M set of passive consumers B set of buses Bbout set of out-neighbors of bus b Bbin set of in-neighbors of bus b Mb set of passive consumers connected at bus b N b set of active consumers connected at bus b L set of lines R,R+ real number set, nonnegative real number set proj(\u00b7) projection operator col(\u00b7) stacked vector obtained from \u00b7\nXiupeng Chen, Koorosh Shomalzadeh, Jacquelien M. A. Scherpen, and Nima Monshizadeh are with Jan C. Willems Center for Systems and Control, ENTEG, University of Groningen, Groningen, 9747 AG, The Netherlands. (email: {xiupeng.chen, k.shomalzadeh, j.m.a.scherpen, n.monshizadeh}@rug.nl)\ndiag(\u00b7) diagonal matrix with \u00b7 on its diagonal \u03bbmin(\u00b7) minimum eigenvalue of a symmetric matrix \u00b7 \u03bbmax(\u00b7) maximum eigenvalue of a symmetric matrix \u00b7 Parameters N number of active consumers M number of passive consumers B number of buses L number of lines I identity matrix 1(0) vector with all elements equal to 1 (0) \u03b1 slope of supply function xtot total mismatch between supply and demand x\u0302n maximum available flexibility of active consumer n \u03ba Lipschitz constant dn predicted net active power load of consumer n u(b,s) conductance of line (b, s) w(b,s) susceptance of line (b, s) z(b,s) maximum capacity of line (b, s) \u03b8, \u03b8 bounds of the voltage phase angles v, v bounds of the voltage phase magnitudes Variables \u03b2n bid of active consumer n xn flexibility of active consumer n \u03bb uniform market clearing price pb, qb active and reactive power injections at bus b vb, \u03b8b voltage magnitude and angle of bus b p(b,s) active power flow through line (b, s) q(b,s) reactive power flow through line (b, s)\nI. INTRODUCTION\nTHE increasing integration of variable and unpredictablerenewable energy sources poses an unprecedented challenge for power system operators in ensuring the immediate stability of power systems in a cost-effective manner[1], [2]. However, the widespread adoption of advanced communication and metering technologies in distribution systems offers a potential solution to this challenge by enabling the flexibility procurement from energy consumers through the utilization of various distributed energy resources [3]. Energy consumers are turned into active participants in electricity market and could make strategic decisions for the sake of their financial benefits [4]. However, the outcomes of these trading activities can have adverse effects on market efficiency and potentially jeopardize the stability of system operation [5]. Moreover, system operators typically establish market equilibrium in a centralized manner or require access to private information from market participants [6]. Taking into consideration the ar X\niv :2\n30 6.\n17 47\n5v 1\n[ ee\nss .S\nY ]\n3 0\nJu n\n20 23\nii\naforementioned concerns, this paper aims to develop a gametheoretic market that efficiently and securely coordinates the flexible resources of consumers for real-time energy balancing.\nThe study of competitive behaviors among strategic energy consumers naturally lends itself to applications of game theory [7], [8]. Previous research has focused on examining the bidding strategies of different types of flexibility providers within a noncooperative game framework, utilizing various pricing models [9], [10] and billing models [11], [12]. However, the current quantity-based bidding method is limiting since it requires additional pricing conditions to ensure that the resulting Nash Equilibrium (NE) meets specific demand requirements [13]. Moreover, these studies do not address the market efficiency loss resulting from consumers\u2019 strategic behaviors [7]-[13]. In an attempt to maximize social welfare, a pricebased bidding method was proposed in [14], though its implementation is restricted by the requirement that each bus of the distribution network must be connected to either no generators or at least two generators. Moreover, the Vickrey-ClarkeGroves mechanism, which has been employed in demand-side management [12] and multi-area power systems coordination [15], can achieve a socially optimal solution. However, this mechanism necessitates the sharing of participants\u2019 economic and technical characteristics with system operators. Given the shortcomings of existing mechanisms, there is a pressing need to design a more flexible and efficient approach.\nIn this work, we design a market by adopting a linear supply function as the bidding format for energy consumers. The concept of a supply function-based bidding method was initially introduced in [16] and its application in the wholesale electricity market was first explored in [17]. More recently, there has been a growing body of literature that employs linear supply functions to characterize the bidding behavior of energy consumers. The energy sharing games among consumers are formulated in [18], [19], where the decision variable of consumers can be interpreted as the intercept of the linear supply function. This energy sharing mechanism is extended to incorporate DC power flow approximation model in [20].\nTo address power supply deficits or surpluses in demand response management, [21], [22] propose two different forms of supply function bids and demonstrate limited efficiency loss under the proposed mechanisms. While these mechanisms offer significant advantages in terms of economic efficiency improvements, they do not consider the potential impact of energy consumption or production adjustments on system stability. In practice, dispatchable generator outputs may be constrained by feeder capacity, and a significant increase in demand could lead to lower voltage levels and necessitate additional reactive compensation. Therefore, our proposed mechanism integrates flow constraints, voltage limitations, and local flexibility constraints to ensure secure market operation.\nWe formulate our market model as a Generalized Nash Game (GNG), where both the objective function and the feasible strategy set of an energy consumer depend on other consumers\u2019 strategies [23]. To achieve market equilibrium, a suitable market clearing protocol needs to be developed to identify the Generalized Nash Equilibrium (GNE), which ensures that each active consumer maximizes its profit and\nno consumer has an incentive to unilaterally deviate. In [11], [12], different projected-gradient algorithms and proximalpoint algorithms are implemented to find NE of the formulated demand side management games. However, these algorithms are not applicable for GNGs with coupling constraints. In an effort to address this, authors of [10] utilize the NikaidoIsoda function to calculate the GNE for GNGs involving coupled distribution networks. Nevertheless, this approach requires a coordinator to collect privacy-sensetive information from all participants. Advanced GNE-seeking algorithms have been proposed in the control community [24], [25], but their direct application to our market model incorporating complex distribution network constraints and information constraints is not straightforward. For instance, from a system operation perspective, the distribution network parameters are typically known only to the Distribution System Operator (DSO) and are not disclosed to the market operator or consumers. For the energy sharing market, [26] proposes a game-theoretic quantity bidding mechanism, where the DSO is treated as an independent player, and all players need to solve their local optimization problems iteratively. In the current manuscript, we propose a game-theoretic algorithm for the flexibility market to guide consumers towards the GNE of the game, allowing participants to access only non-sensitive information. From the technical perspective, the GNE-seeking algorithm is obtained from a preconditioned forward-backward splitting method [27].\nTo sum up, in this study, we examine the balancing market characterized by an energy supply surplus or deficit between the transmission network and the distribution network. To address this mismatch, the market operator seeks flexibility services from energy consumers who possess flexible resources. Recognizing that these active energy consumers act rationally and are driven by self-interest, we employ game theory to analyze their competitive behaviors. The presence of information sharing limitations and physical constraints within the distribution network pose several challenges in the market design and clearance. The main contribution of this work is to develop a market mechanism for procuring flexibility with the following key features:\n\u2022 Efficient market design: We propose a game-theoretic market for flexibility procurement, where energy consumers use a supply function-based bidding format. We formulate their competition as a GNG and characterize the market equilibrium, referred to as the variational Generalized Nash Equilibrium (v-GNE), which represents the best bidding strategies of the energy consumers. We establish the existence and uniqueness of this equilibrium. Moreover, we derive an upper bound on the efficiency loss of v-GNE and show that this market achieves approximate social welfare maximization in a practical case study. \u2022 Secure market operation: Our proposed market operation incorporates local flexibility constraints as well as distribution network constraints such as line capacities and voltage limits. Numerical results demonstrate the significance of integrating such constraints in the design.\niii\n\u2022 Privacy-aware market clearance: We address the information sharing limitations in a privacy-preserving environment and develop a preconditioned forward-backward algorithm to steer consumers towards the market equilibrium. In this algorithm, non-sensitive information is shared among market participants, including the market operator, system operator, and energy consumers. We analytically establish the convergence of this algorithm and demonstrate its scalability through a case study.\nThis paper is structured as follows. In Section II, we present the system model for real-time energy balancing, including the proposed market model as well as the physical network. In Section III, we formulate the competition among energy consumers as a game and evaluate the efficiency of the proposed bidding scheme. Section III introduces the algorithm for seeking the GNE in the game. Section IV provides a comprehensive case study to demonstrate the practical implications and effectiveness of our proposed market mechanism. The paper closes with key findings and conclusions in Section V."
        },
        {
            "heading": "II. SYSTEM MODEL",
            "text": ""
        },
        {
            "heading": "A. Balancing market model",
            "text": "In a balancing market, fairly accurate predictions of energy supply and demand are available. These predictions often deviate from the previous energy schedules determined via day-ahead ones, leading to a mismatch of real-time supply and demand (i.e., supply deficit or surplus) at the interface between the transmission and distribution network. The Balance Responsible Party (BRP) is responsible for accommodating this mismatch and acts as the operator in the balancing market [28]. To this end, the BRP utilizes the flexible resources of consumers in the distribution network. We consider two types of consumers, namely active and passive ones denoted by N = {1, 2, . . . , N} and M = {N + 1, N + 2, . . . , N +M}, respectively. An active consumer is equipped with at least one flexible resource, such as a dispatchable generator or an adjustable load. Hence, it can adjust its energy generation or consumption locally to respond to the energy mismatch. On the other hand, a passive consumer has a fixed demand and no dispatchable generation units. Moreover, each consumer n \u2208 N \u222a M is connected to the distribution network. The Distribution System Operator (DSO) ensures the secure operation of the distribution network. Fig. 1 illustrates the interactions between all these market participants.\nWe consider the market operation as follows:\n\u2022 Each active consumer n \u2208 N bids a linear function xn = \u03b1n\u03bb+ \u03b2n, (1)\nto the BRP, which describes its desire to provide flexibility xn as a function of a price \u03bb \u2208 R that it is expected to be paid by the BRP. The ultimate aim of the submitted bid is to maximize the consumer\u2019s net revenue, that is, to minimize Jn(xn) = Cn(xn)\u2212 \u03bbxn, (2) where Cn(xn) is the cost or disutility of providing flexibility and \u03bbxn is the payment from the BRP. More-\nover, the flexibility of each consumer should satisfy the following constraint: 0 \u2264 xn \u2264 x\u0302n, (3) where x\u0302n is the maximum available flexibilty. \u2022 The BRP collects the bids and clears the market based on a pay-as-clear procedure such that\u2211\nn\u2208N xn = xtot. (4)\nwhere xtot \u2208 R+ denotes the total flexibility that is required to fulfill the mismatch between total supply and demand in the distribution network. \u2022 The allocated flexibility xn resulting from this market should be feasible for the distribution system. The DSO performs this validation and modifies the allocation, if necessary, to meet the physical network constraints.\nIn the next subsection, we elaborate on the physical network constraints model that are relevant in the validation phase conducted by the DSO as stated above."
        },
        {
            "heading": "B. Physical network model",
            "text": "Here, we give the mathematical model of the distribution network where all the consumers are physically connected. We represent the distribution network D(B,L) as a simple directed graph where the buses and lines are represented by B = {1, 2, ..., B} and L \u2286 B \u00d7 B, respectively. That is, if \u2113 = (b, s) \u2208 L, then line \u2113 originates from bus b \u2208 B and ends in bus s \u2208 B. Note that the direction of lines can be chosen arbitrarily. We denote the set of out-neighbors and inneighbors of b by Bbout := {s | (b, s) \u2208 L}, Bbin := {s | (s, b) \u2208 L}, respectively. Furthermore, we define the incidence matrix E = [e\u2113,b] \u2208 R|L|\u00d7|B| as\ne\u2113,b =  +1 if line \u2113 leaves bus b, \u22121 if line \u2113 enters bus b, 0 otherwise.\nWe assume that the transmission and distribution networks are connected via a single bus, which we take without loss of generality as bus 1. Finally, we use Mb and N b to denote the set of passive and active consumers connected to each bus b \u2208 B \\ {1}. An example of the physical network is depicted in Fig. 2.\nTo ensure the secure operation of the power system, the DSO imposes the physical constraints of the distribution\niv\nnetwork, namely, power-flow constraints. In what follows, we incorporate the flexibility provision into power-flow equations and write these equations along the distribution network security constraints in a compact form.\nBy adopting the linear lossless power flow equations in [29], the active and reactive power flow p(b,s) and q(b,s) through line (b, s) \u2208 L are given by\np(b,s) = \u2212w(b,s)(\u03b8b \u2212 \u03b8s) + u(b,s)(vb \u2212 vs), q(b,s) = \u2212u(b,s)(\u03b8b \u2212 \u03b8s)\u2212 w(b,s)(vb \u2212 vs),\n(5)\nwhere u(b,s) and w(b,s) denote the conductance and susceptance of line (b, s), and vb and \u03b8b indicate the voltage magnitude and angle of bus b \u2208 B, respectively. Furthermore, for each bus b \u2208 B, the power balance must hold, namely\u2211\ns\u2208Bbout p(b,s) \u2212 \u2211 s\u2208Bbin\np(s,b) = pb,\u2211 s\u2208Bbout q(b,s) \u2212 \u2211 s\u2208Bbin q(s,b) = qb. (6)\nwhere pb and qb are the net active and reactive power injections at bus b \u2208 B. Note that bus 1 is considered as the slack bus in the power flow equations above. As a result, we have v1 = 1, \u03b81 = 0, and p1 and q1 are variables.\nNext, we impose the security constraints for each bus b \u2208 B and line (b, s) \u2208 L as [26]\np2(b,s) + q 2 (b,s) \u2264 z 2 (b,s),\n\u03b8 \u2264 \u03b8b \u2264 \u03b8, v \u2264 vb \u2264 v,\n(7)\nwhere the first inequality represents the line capacity constraint at each line, with the maximum line capacity denoted by z(b,s), and the last two inequalities represent the safe limits of the voltage phase angles and magnitudes.\nWe write the power flow and security constraints (5), (6) and (7) as follows.\nPL = \u2212WE\u03b8 + UEv, QL = \u2212UE\u03b8 \u2212WEv, E\u22a4PL = PB, E \u22a4QL = QB,\nPL \u2299 PL +QL \u2299QL \u2264 Z \u2299 Z, \u03b81 \u2264 \u03b8 \u2264 \u03b81, v1 \u2264 v \u2264 v1,\n(8)\nwhere \u2299 is the Hadamard product, E is the incidence matrix of the distribution network and\nPB = col(pb), QB = col(qb),\nPL = col(p(b,s)), QL = col(q(b,s)),\nW = diag(w(b,s)), U = diag(u(b,s)),\nZ = col(z(b,s)), \u03b8 = col(\u03b8b), v = col(vb),\nwith b \u2208 B and (b, s) \u2208 L. Now, let the constant dn \u2208 R be the predicted net active load of the consumer n \u2208 N \u222a M in the balancing market. Then, as a result of the net active loads and flexibility, we have\npb = \u2212 ( \u2211 n\u2208Mb dn + \u2211 n\u2208N b (dn \u2213 xn) ) , (9)\nfor each b \u2208 B \\ {1}. The flexibility xn appears with a minus (plus) sign if there is a supply deficit (surplus) in the distribution network, leading the consumers to inject (withdraw) additional power to/from the network. We note that the flexibility xn contributes only to the compensation of the active power. Throughout the rest of this paper, we indicate the DSO security constraints by (8) and (9)."
        },
        {
            "heading": "III. GAME FORMULATION AND ANALYSIS",
            "text": "We consider the situation where each active consumer in the distribution network is rational and makes a strategic decision to provide flexibility services in the balancing market. The aim of this section is to formulate the competition among these consumers as a game and characterize the resulting (generalized) Nash equilibrium. At this equilibrium, no consumer is willing to unilaterally deviate from its bid and, moreover, the physical network constraints are satisfied."
        },
        {
            "heading": "A. Game formulation",
            "text": "First, we complement the market structure proposed in Section II-A by introducing a price clearing mechanism. Recall that each active consumer n \u2208 N bids its available flexibility as a linear function in (1). Upon gathering the bids of all active consumers by the BRP, the market clears based on a pay-as-clear mechanism such that the matching condition in (4) holds. In the sequel, we assume that \u03b1n = \u03b1 > 0 for all n \u2208 N , a constraint which will be imposed by the BRP [20].\nConsequently, from (1) and (4), the BRP computes the clearing price \u03bb = (xtot \u2212 1\u22a4\u03b2)/(\u03b1N), (10) and the corresponding allocated flexibility as xn = (xtot \u2212 1\u22a4\u03b2)/N + \u03b2n, (11) where \u03b2 = col(\u03b2n)n\u2208N . The vector of allocated flexibilities x = col(xn)n\u2208N can also be compactly written as x = A\u03b2 + b, (12) where A = I \u2212 1N 11\n\u22a4 and b = xtotN 1. Next, we shift our attention to the consumers\u2019 side. Since \u03b1n = \u03b1 for all n \u2208 N , \u03b2n can be interpreted as the decision variable of the active consumer n in submitting its bid, which aims to minimize its cost/disutility Cn(xn) in (2). Throughout the paper, we make the following assumption on this function.\nAssumption 1. The cost function Cn(xn) is convex, twice continuously differentiable, Cn(0) \u2265 0 and Cn(xn) > 0 for xn > 0. Moreover, C \u2032n := \u2207Cn is Lipschitz continuous with \u03ba > 0, i.e., \u2225C \u2032n(x\u2032n)\u2212C \u2032n(xn)\u2225 \u2264 \u03ba\u2225x\u2032n\u2212xn\u2225,\u2200 0 \u2264 xn, x\u2032n \u2264 x\u0302n. (13)\nv The fact that the price \u03bb is set by the BRP according to (10) is considered public knowledge, which implies that the active consumers can submit their bids strategically. In particular, one can substitute \u03bb and xn from (10) and (11) in (2) and rewrite it as\nJ\u0304n(\u03b2n, \u03b2\u2212n) = Cn ( (xtot \u2212 1\u22a4\u03b2)/N + \u03b2n ) \u2212 (xtot \u2212 1\u22a4\u03b2 +N\u03b2n)(xtot \u2212 1\u22a4\u03b2)/(\u03b1N2), (14) where \u03b2\u2212n = col(\u03b2m)m\u2208N\\{n}. Similarly, we can rewrite the constraint in (3) as\n(xtot \u2212 1\u22a4\u03b2)/N + \u03b2n \u2264 x\u0302n, (15) (xtot \u2212 1\u22a4\u03b2)/N + \u03b2n \u2265 0, (16)\nfor all n \u2208 N , and the one in (9) as pb = \u2212 \u2211 n\u2208N bp\u222aN ba dn \u00b1 \u2211 n\u2208N b ( (xtot \u2212 1\u22a4\u03b2)/N + \u03b2n ) , (17) for all b \u2208 B \\ {1}. As a result, each active consumer n \u2208 N aims to minimize J\u0304n(\u03b2n, \u03b2\u2212n) subject to the flexibility capacity constraints (15) and (16). Augmenting the latter optimization with the security constraints (8) and (17) enforced by the DSO, we arrive at the following optimization problem\nmin \u03b2n\nJ\u0304n(\u03b2n, \u03b2\u2212n)\ns.t. \u03b2n \u2208 Kn(\u03b2\u2212n), (18)\nwhere the parametric set Kn(\u03b2\u2212n) is defined as {\u03b2n \u2208 R | (15), (16), (17) hold, and (8) holds for some v and \u03b8}. From (18), we note that both the objective function and constraints of each active consumer depend on its own strategy as well as the strategies of other consumers.\nWe now write the noncooperative game among active consumers in a compact form as the triple: G = {N ,K, col(J\u0304n(\u03b2n, \u03b2\u2212n))n\u2208N }, (19) where K =\n\u220f n\u2208N Kn(\u03b2\u2212n) is the set of feasible strategies for\nthe consumers. Noting that convexity is preserved under affine transformations, it is easy to verify that the set K is convex. Furthermore, to satisfy Slater\u2019s constraint qualifications [30], we assume that K has at least one strictly feasible point.\nThe competition among consumers in the game G gives rise to a GNG since their objective functions and the feasible strategy sets are coupled. Next, we analyze the GNE of this game. A point \u03b2\u2217 \u2208 K is a GNE of the game, if for all n \u2208 N , the following holds,\nJ\u0304n(\u03b2n, \u03b2 \u2217 \u2212n) \u2265 J\u0304n(\u03b2\u2217n, \u03b2\u2217\u2212n), \u2200 \u03b2n \u2208 Kn(\u03b2\u2217\u2212n).\nOur interest in the GNE of the game is due to the fact that at this point none of the consumers would unilaterally deviate from its strategy. In this paper, we focus on a specific subclass of GNE, namely v-GNE. Specifically, each player in the game is penalized equally for deviating from coupling constraints at the v-GNE, which also corresponds to the solution of a variational inequality problem 1 [23].\nTo characterize the v-GNE of the game G and verify its existence and uniqueness, we define the pseudo-gradient mapping of the game as\nF := col(fn(\u03b2n, \u03b2\u2212n))n\u2208N , (20)\n1Given a mapping F : X \u2192 Rn, the variational inequality problem VI(X ,F) is to find the point x\u0304 \u2208 X such that (x\u2212 x\u0304)\u22a4F (x\u0304) \u2265 0, \u2200x \u2208 X .\nwhere\nfn(\u03b2n, \u03b2\u2212n) := \u2202\n\u2202\u03b2n J\u0304n(\u03b2n, \u03b2\u2212n)\n= C \u2032n(xn) N \u2212 1 N + (1\u22a4\u03b2 \u2212 xtot)(N \u2212 2) +N\u03b2n \u03b1N2 .\nThe map F is strongly monotone and Lipschitz continuous as stated in the following lemma:\nLemma 1. The pseudo-gradient mapping F in (20) is\ni) strongly monotone if \u03b1 < 2\u03ba(N\u22121) , namely, for any \u03b2\u0304, \u03b2\u0303 \u2208 K, (\u03b2\u0304 \u2212 \u03b2\u0303)\u22a4(F (\u03b2\u0304)\u2212 F (\u03b2\u0303)) \u2265 \u03b7F \u2225\u03b2\u0304 \u2212 \u03b2\u0303\u22252, where\n\u03b7F = 1 \u03b1N \u2212 \u03ba(N \u2212 1) 2N ,\nii) Lipschitz continuous with constant\n\u03baF = N \u2212 1 N (\u03ba+ 1 \u03b1 ).\nThe proof of Lemma 1 is provided in Appendix. Now, we state the main result of this subsection.\nProposition 1. Assume that \u03b1 < 2\u03ba(N\u22121) .Then the game G has a unique v-GNE, which is given by the unique solution \u03b2\u2217 \u2208 K to the variational inequality\n(\u03b2 \u2212 \u03b2\u2217)\u22a4F (\u03b2\u2217) \u2265 0, \u2200\u03b2 \u2208 K. (21)\nProof. The mapping F is strongly monotone by Lemma 1 item i. Note that the set K is convex and closed. It follows from [31, Theorem 2.3.3] that VI ( K,F ) has a unique solution which corresponds to the unique v-GNE of the game G [23].\nRemark 1. One can show that the condition assumed in Proposition 1 is not required for proving uniqueness of the v-GNE. In other words, the v-GNE, if exists, is unique. We resort to this assumption since, in any case, the convergence results of Section IV hinges on the strong monotonicity of the map F (\u00b7) established in Lemma 1."
        },
        {
            "heading": "B. Efficiency analysis",
            "text": "The self-interested behaviors of energy consumers can lead to market inefficiency. To analyze this efficiency loss in the game G, we first introduce a social welfare maximization problem as the benchmark. From a social point of view, it is desirable to utilize the available flexible resources in such a way that the total cost/disutility of active energy consumers is minimized. If consumers are willing to cooperate and reveal their actual economic and technical characteristics to the BRP and DSO, then the efficient flexibility schedule can be found as the solution to the following social welfare optimization problem:\nmin x \u2211 n\u2208N Cn(xn) s.t. (3), (4), (8) and (9), (22)\nThe following lemma relates the aforementioned social welfare optimization problem with the allocated feasibility at the v-GNE of the game G.\nLemma 2. Let \u03b2\u2217 be the v-GNE of the game G, i.e, the unique solution to the VI in (21), and x\u2217 be the corresponding allocated flexibility at this point, namely x\u2217 = A\u03b2\u2217 + b.\nvi\nThen, x\u2217 is the unique solution of the following optimization problem:\nmin x \u2211 n\u2208N Dn(xn) s.t. (3), (4), (8) and (9), (23)\nwhere Dn(xn) := Cn(xn) + x2n\n2\u03b1(N\u22121) .\nThe proof of Lemma 2 is provided in Appendix.\nRemark 2. The above lemma indicates that the allocated flexibility at the v-GNE of the game G, i.e. x\u2217, is different from the solution to the social welfare optimization (22). The additional nonnegative term x 2 n\n2\u03b1(N\u22121) is due to the strategic bidding behavior of self-interested consumer n and Dn(xn) can be regarded as a fake cost function that consumer n submits to the BRP to gain more profit.\nWe use Price of Anarchy (PoA) [32] to measure the efficiency loss of the game G, which indicates how the overall efficiency of a game degrades due to the strategic behavior of consumers. PoA is defined as the ratio of the total cost between the Nash Equilibrium and the social optimum. In our case, this gives rise to\nPoA :=\n\u2211 n\u2208N Cn(x\n\u2217 n)\u2211\nn\u2208N Cn(x\u0304n) , (24)\nwhere x\u0304 is the solution to the social welfare optimization problem (22), and x\u2217 is the allocated flexibility at v-GNE of the game G. We then have the following result.\nProposition 2. The price of anarchy in (24) satisfies\nPoA < 1 + 1\n2\u03b1(N \u2212 1)\n\u2211 n\u2208N x\u0304\n2 n\u2211\nn\u2208N Cn(x\u0304n) . (25)\nProof. We observe that\u2211 n\u2208N Cn(x \u2217 n) < \u2211 n\u2208N Dn(x \u2217 n) \u2264 \u2211 n\u2208N Dn(x\u0304n), where the first inequality follows from the positivity of\u2211 n\u2208N (x\u2217n) 2 2\u03b1(N\u22121) , 2 and the second inequality follows from the fact that x\u2217 is the solution to the optimization problem (23). Hence, by using the definition of Dn(\u00b7), we obtain that\u2211\nn\u2208N Cn(x\n\u2217 n) < \u2211 n\u2208N ( Cn(x\u0304n) + x\u03042n 2\u03b1(N \u2212 1) ) ,\nwhich leads us to (25).\nRemark 3. The result of the above proposition provides an upper bound for PoA. This bound largely depends on the number of active energy consumers N and the parameter \u03b1. For sufficiently large quantity \u03b1(N\u22121), the upper bound gets close to 1 and the market power of each individual consumer decreases."
        },
        {
            "heading": "IV. ALGORITHM DESIGN",
            "text": "Next, we present a practical protocol to compute the v-GNE of the game G discussed in the previous section, and establish analytical convergence guarantees for the proposed algorithm."
        },
        {
            "heading": "A. Algorithm description",
            "text": "Before presenting our algorithm, we explain the restrictions in sharing information and knowledge available to each party\n2Note that due to (3) and (4), there exists n \u2208 N with x\u2217n > 0.\nin the market mechanism. As for the consumers, they are not willing to reveal their economic and technical specifications, including the cost function Cn(xn) and the maximum available flexibility x\u0302n, to the BRP, DSO or any other consumer. The BRP, as the buyer of flexibility and the market operator, is not willing to share the required total flexibility xtot with the consumers. Finally, the physical specifications of the system, such as network topology and line parameters are only known to the DSO.\nMotivated by the above sharing limitations, to prepare for the algorithm, we split the feasible set K in (19), as K = \u039b \u2229 \u03a8, where \u039b := {\u03b2 \u2208 RN | (15) holds} and \u03a8 := {\u03b2 \u2208 RN | (8), (16) and (17) hold}. Note that the former contains the private information of consumers {x\u0302n}n\u2208N and will be handled by the consumers themselves in the algorithm. However, the latter set involves the nonprivate information of consumers alongside the DSO security constraints and will be handled by the DSO. Now, the proposed protocol is provided in Algorithm 1.\nAlgorithm 1 v-GNE Seeking Algorithm Initialization and preparation: 1) Each n \u2208 N sets initial conditions \u03b20n \u2208 R and \u03b30n \u2208 R+\nand positive step sizes \u03c1n and \u03bdn. 2) Each n \u2208 N : \u03b20n, \u03b30n \u2212\u2192 BRP 3) BRP computes \u03bb0 from (10), given the value of \u03b20. 4) BRP : \u03bb0,1\u22a4\u03b30 \u2212\u2192 N Iterate until convergence: 1) Bid modification and communication: each n \u2208 N\n(a) calculates hkn defined as\nhkn := C \u2032 n(\u03b1\u03bb k + \u03b2kn) N \u2212 1 N + \u03b1\u03bbk(2\u2212N) + \u03b2kn \u03b1N\n\u2212 1 N 1\u22a4\u03b3k + \u03b3kn,\nwhere k indexes the time step of the algorithm. (b) modifies its bid as\n\u03b2\u0303kn = \u03b2 k n \u2212 \u03c1nhkn. (26)\n(c) \u03b2\u0303kn \u2212\u2192 BRP 2) Bid update and communication:\n(a) BRP : \u03b2\u0303k \u2212\u2192 DSO (b) DSO enforces the security constraints: \u03b2k+1 = argminz\u2208\u03a8 ||z \u2212 \u03b2\u0303k|| (27) (c) DSO : \u03b2k+1 \u2212\u2192 BRP\n3) Price update and communication: (a) BRP computes \u03bbk+1 from (10), given the value of \u03b2k+1. (b) BRP : \u03b2k+1n , \u03bb\nk+1 \u2212\u2192 N 4) Dual variable update and communication:\n(a) each n \u2208 N updates \u03b3n based on \u03b3k+1n = projR+(\u03b3 k n + \u03bdn(2x k+1 n \u2212 xkn \u2212 x\u0302n)). (28) (b) each n \u2208 N : \u03b3k+1n \u2212\u2192 BRP (c) BRP : 1\u22a4\u03b3k+1 \u2212\u2192 N\nIn the proposed algorithm, \u03c1n and \u03bdn are the step sizes which should be sufficiently small to ensure convergence as shown in the next subsection. The variable \u03b2\u0303n is an interme-\nvii\ndiate variable and can be interpreted as the primary bid of consumer n. The DSO performs the validation and necessary corrections of all the primary bids (i.e., \u03b2\u0303 = col(\u03b2\u0303n)n\u2208N ) according to (27). Note that \u03b2 = \u03b2\u0303 if the primary bids are feasible for DSO; otherwise the bids are modified to the \u201cclosest\u201d physically feasible ones. The dual variable \u03b3n is associated with the coupling constraint (15). It should be noted that the updates of \u03b2\u0303n in (26) require the price \u03bb and shared aggregative quantity 1\u22a4\u03b3, with \u03b3 = col(\u03b3n)n\u2208N , whereas \u03b3n in (28) can be updated using only the consumer n\u2019s local information. Although some global information, such as \u03b1 and the number of active consumers N are required to execute the algorithm, such parameters are often not private and do not change frequently."
        },
        {
            "heading": "B. Convergence analysis",
            "text": "The following result provides upper bounds for the step sizes \u03c1n and \u03bdn in Algorithm 1 such that convergence to vGNE of the game is guaranteed.\nProposition 3. Consider the monotonicity and Lipschitz continuity constants \u03b7F and \u03baF given in Lemma 1. If\n\u03ba2F 2\u03b7F < 1 \u03c1\u0304 \u2212 \u03bd\u0304, (29)\nwith \u03c1\u0304 := max{\u03c1n}n\u2208N and \u03bd\u0304 := max{\u03bdn}n\u2208N , then the vector \u03b2 in Algorithm 1 converges to the v-GNE of the game.\nProof. First, we write our algorithm in a compact form. Bearing in mind (10) and (11), we can rewrite (26) and (28) as\n\u03b2\u0303kn = \u03b2 k n \u2212 \u03c1n ( fn(\u03b2 k n, \u03b2 k \u2212n)\u2212 1/N1\u22a4\u03b3k + \u03b3kn ) , (30)\n\u03b3k+1n = projR+ ( \u03b3kn + \u03bdn ( 21\u22a4(\u03b2k \u2212 \u03b2k+1)/N\n+ (2\u03b2k+1n \u2212 \u03b2kn)\u2212 x\u0302n + xtot/N )) .\n(31)\nBy letting R := diag(\u03c1n)n\u2208N , V := diag(\u03bdn)n\u2208N and noting that proj\u03a8(\u03b2\u0303) = argminz\u2208\u03a8 ||z\u2212 \u03b2\u0303||, the above dynamics can be written as \u03b2k+1 = proj\u03a8 ( \u03b2k \u2212R(F (\u03b2k) +A\u22a4\u03b3k) ) , (32)\n\u03b3k+1 = projR+N\n( \u03b3k + V (2A\u03b2k+1 \u2212A\u03b2k \u2212 x\u0302+ b) ) , (33)\nwhere A = I \u2212 1N 11 \u22a4 as before. Note that \u03a8 is closed and convex, the mapping F is \u03b7F -monotone and \u03baF -Lipschitz continuous by Lemma 1. In addition, we have \u03bbmax(A) = 1. The above dynamics then have the similar structure as the Preconditioned Forward Backward algorithm in [27]. Therefore, by following the footsteps of the proofs of [27, Proposition 1 and Therorem 1], we can show that if the step sizes \u03c1n and \u03bdn are sufficiently small, in particular satisfying (29), then the sequence (\u03b2k, \u03b3k) converges to (\u03b2\u2217, \u03b3\u2217) where \u03b2\u2217 is the v-GNE. We omit the details for brevity."
        },
        {
            "heading": "V. CASE STUDY",
            "text": "We perform an extensive numerical study on the modified IEEE 33 bus distribution network [33] to validate the proposed market mechanism. This network is shown in Fig. 3. For practical reasons, this benchmark network is enhanced in several aspects. In particular, the ratio of lines\u2019 reactance to resistance is decreased, reactive power compensators are\nintegrated and more strict voltage limits are imposed. The energy generation and consumption profiles are also based on [33].\nWe consider linear-quadratic cost functions for consumers as Cn(xn) = 12anx 2 n + bnxn. The parameters an and bn are arbitrarily selected in the intervals [0.003, 0.005]$/(kWh)2 and [0.35, 0.45]$/kWh, respectively. These cost functions satisfy Assumption 1 with \u03ba = 0.005. The maximum available flexibilities, {x\u0302n}n\u2208N are also arbitrarily selected with\u2211\nn\u2208N x\u0302n \u2265 xtot = 100kWh. The BRP can choose the parameter in the interval \u03b1 = \u03b4 2\u03ba(N\u22121) with \u03b4 \u2208 (0, 1). Note that the latter choice satisfies the condition in Proposition 1. The step sizes \u03c1n and \u03bdn are chosen such that (29) holds. In the following, we first show the economic efficiency of our mechanism. Next, we evaluate the importance of having physical constraints in our model. Finally, we test the effectiveness of our proposed algorithm."
        },
        {
            "heading": "A. Efficiency analysis",
            "text": "In this part, we mainly focus on the advantages of our market mechanism in terms of market efficiency. We do not incorporate the physical network constraints in our model here, to make it consistent with the setup in [21] and [22] where the physical network is neglected. We study three cases as follows. Case 1: Each consumer reveals its true cost function and constraints to the BRP. In this case, we solve the social welfare maximization problem (22). Case 2: Each consumer chooses the supply function in [21] and [22] as its bidding strategy. Case 3: As in our market mechanism, each consumer chooses the y-intercept of its linear supply function (\u03b2n) as its bidding strategy.\nMoreover, we study two scenarios for each case. In Scenario 1, we consider only the nonnegative lower bound on the available flexibility xn to be consistent with [21], whereas in Scenario 2 we consider also the upper bound x\u0302n consistent with [22].\nFig. 4 and Fig. 5 show the clearing prices and PoAs in Scenario 1 and Scenario 2, respectively. From the plots, we can see that in Case 1, which is a perfectly competitive market, as the number of active consumers increases, the clearing prices decrease and PoAs are always equal to 1. In the next two cases, the clearing prices also decrease. This is due to the fact that in an imperfectly competitive market, the market power of individuals decreases with the increase of market participants. Moreover, we observe that in both scenarios, the clearing\nviii\nprices and PoAs in Case 3 (corresponding to the proposed results) are closer to the outcomes of Case 1 (corresponding to the social welfare maximization). In particular, when upper bounds on local flexibility constraints are imposed, the price and PoA becomes very high in Case 2 (see Fig. 5), which can reduce economic efficiency of the market operation. Bearing in mind that \u03b1 scales linearly with respect to the parameter \u03b4, we observe that the proposed mechanism performs quite well in terms of market efficiency, especially when \u03b1 becomes larger."
        },
        {
            "heading": "B. Security analysis",
            "text": "Next, we highlight the importance of including physical (security) constraints by comparing the results with and without including such constraints in our model. We consider 12 consumers providing flexibility services for BRP. For the sake of simplicity, we assume only one consumer is connected to each bus and we label each active consumer by the bus number it is connected to. We investigate two scenarios: Scenario 1: There is an energy surplus. In this scenario, to consume the extra energy from the transmission system, an active consumer with flexible loads is rewarded to consume more energy. Scenario 2: There is an energy deficit. In this scenario, an active consumer with distributed generators is getting paid to provide extra energy for the BRP.\nFig. 6 shows the flexibility allocation and the corresponding voltage magnitudes in Scenario 1. We can see if the restriction\non the voltage magnitudes is not considered, the voltage magnitude of bus 30 drops below the (standard) lower bound v = 0.95. On the other hand, when security constraints are incorporated in the design, the consumers 28, 31 and 33 provide less flexibility while consumers 20, 22, 24 and 25 provide more, thereby avoiding the voltage collapse at bus 30. The flexibility allocations and the corresponding power flows in Scenario 2 are shown in Fig. 7. These results illustrate that to avoid line 17 being congested, consumer 18 should decrease its flexibility significantly. In practice, this means active consumer 18 cannot provide more flexibility since it has provided a large amount of energy in day-ahead market. In general, incorporating the physical constraints might extensively alter the flexibility allocation results, and clearing the market without considering the physical constraints can jeopardize the system\u2019s secure operation."
        },
        {
            "heading": "C. Convergence properties of Algorithm 1",
            "text": "We use the same setup as in Scenario 2 of the previous subsection. Fig. 8 shows the evolution of the bids \u03b2 and the dual variables \u03b3, where the latter are associated with the maximum availability constraints. As it can be seen from the figure, the algorithm converges in 400 iterations. In addition,\nix\nthe dual variable corresponding to consumer 28 takes positive values as soon as (\u223c Iteration 200) its allocated flexibility reaches its maximum available flexibility. In addition, due to the line capacity constraints as shown in Fig. 7, consumer 18\u2019s strategy is restricted to \u22126.21, which leads to a few flexibility allocation for this consumer.\nIn order to better see the transient performance of the algorithm, we also show in Fig. 9 the normalized error of the flexibility profile, i.e. \u2225xk \u2212 x\u2217\u22252/\u2225x\u2217\u22252, where the x\u2217 is the flexibility allocation at the v-GNE of the game G. As can be seen from the figure, the error signal converges to zero after a short transient response.\nFinally, we investigate the scalability of our algorithm by observing the required number of iterations for convergence as we increase the number of active consumers. To this end, we consider the stopping criterion\n\u2225\u03b2k+1 \u2212 \u03b2k\u22252 + \u2225\u03b3k+1 \u2212 \u03b3k\u22252 < 10\u22125. We assign active consumers to the buses of distribution arbitrarily. Table I shows that the required number of iterations increases linearly with respect to the number of active consumers, demonstrating the scalability of our method."
        },
        {
            "heading": "VI. CONCLUSION",
            "text": "We present a game-theoretic market framework for procuring flexibility services within the distribution network. To address the privacy concerns of market participants and the associated information sharing limitations, we adapt a semidecentralized GNE-seeking algorithm to solve the formulated game. Through numerical experiments, we assess the performance of our proposed mechanism in terms of both economic efficiency and operational security. Future research avenues include incorporating uncertainties into the model, such as the uncertain maximum flexibility of consumers, as well as devising mechanisms for achieving social welfare maximization through efficient profit sharing. Furthermore, there is a need to address the challenges posed by non-continuous cost functions."
        }
    ],
    "title": "Secure and Efficient Flexibility Service Procurement: A Game-Theoretic Approach",
    "year": 2023
}