{
    "abstractText": "Graph neural networks (GNNs) have been widely used in graph-structured data computation, showing promising performance in various applications such as node classification, link prediction, and network recommendation. Existing works mainly focus on node-wise correlation when doing weighted aggregation of neighboring nodes based on attention, such as dot product by the dense vectors of two nodes. This may cause conflicting noise in nodes to be propagated when doing information propagation. To solve this problem, we propose a General Information Propagation Algorithm (GIPA), which exploits more fine-grained information fusion including bit-wise and feature-wise correlations based on edge features in their propagation. Specifically, the bit-wise correlation calculates the element-wise attention weights through a multi-layer perceptron (MLP) based on the dense representations of two nodes and their edge; The feature-wise correlation is based on the one-hot representations of node attribute features for feature selection. We evaluate the performance of GIPA on the Open Graph Benchmark proteins (OGBNproteins) dataset and the Alipay dataset of Alibaba Group. Experimental results reveal that GIPA outperforms the state-of-the-art models in terms of prediction accuracy, e.g., GIPA achieves an average ROC-AUC of 0.8917\u00b1 0.0007, which is better than that of all the existing methods listed in the OGBN-proteins leaderboard.",
    "authors": [
        {
            "affiliations": [],
            "name": "Houyi Li"
        },
        {
            "affiliations": [],
            "name": "Zhihong Chen"
        },
        {
            "affiliations": [],
            "name": "Zhao Li"
        },
        {
            "affiliations": [],
            "name": "Qinkai Zheng"
        },
        {
            "affiliations": [],
            "name": "Peng Zhang"
        },
        {
            "affiliations": [],
            "name": "Shuigeng Zhou"
        }
    ],
    "id": "SP:214d51449a5361cbd917325be6e78a0338fe21d7",
    "references": [
        {
            "authors": [
                "S. Abu-El-Haija",
                "B. Perozzi",
                "A. Kapoor",
                "N. Alipourfard",
                "K. Lerman",
                "H. Harutyunyan",
                "G. Ver Steeg",
                "A. Galstyan"
            ],
            "title": "Mixhop: Higher-order graph convolutional architectures via sparsified neighborhood mixing",
            "venue": "ICML",
            "year": 2019
        },
        {
            "authors": [
                "D. Bahdanau",
                "K. Cho",
                "Y. Bengio"
            ],
            "title": "Neural machine translation by jointly learning to align and translate",
            "venue": "ICLR",
            "year": 2015
        },
        {
            "authors": [
                "G. Brauwers",
                "F. Frasincar"
            ],
            "title": "A general survey on attention mechanisms in deep learning",
            "venue": "IEEE Transactions on Knowledge and Data Engineering",
            "year": 2021
        },
        {
            "authors": [
                "J. Chen",
                "T. Ma",
                "C. Xiao"
            ],
            "title": "Fastgcn: fast learning with graph convolutional networks via importance sampling",
            "venue": "ICLR",
            "year": 2018
        },
        {
            "authors": [
                "M. Chen",
                "Z. Wei",
                "Z. Huang",
                "B. Ding",
                "Y. Li"
            ],
            "title": "Simple and deep graph convolutional networks",
            "venue": "ICML",
            "year": 2020
        },
        {
            "authors": [
                "H.T. Cheng",
                "L. Koc",
                "J. Harmsen",
                "T. Shaked",
                "T. Chandra",
                "H. Aradhye",
                "G. Anderson",
                "G. Corrado",
                "W. Chai",
                "M. Ispir",
                "R. Anil",
                "Z. Haque",
                "L. Hong",
                "V. Jain",
                "X. Liu",
                "H. Shah"
            ],
            "title": "Wide & deep learning for recommender systems",
            "venue": "DLRS",
            "year": 2016
        },
        {
            "authors": [
                "H. Dai",
                "B. Dai",
                "L. Song"
            ],
            "title": "Discriminative embeddings of latent variable models for structured data",
            "venue": "ICML",
            "year": 2016
        },
        {
            "authors": [
                "Y. Dong",
                "N.V. Chawla",
                "A. Swami"
            ],
            "title": "metapath2vec: Scalable representation learning for heterogeneous networks",
            "venue": "SIGKDD",
            "year": 2017
        },
        {
            "authors": [
                "A. Grover",
                "J. Leskovec"
            ],
            "title": "node2vec: Scalable feature learning for networks",
            "venue": "SIGKDD",
            "year": 2016
        },
        {
            "authors": [
                "W. Hamilton",
                "Z. Ying",
                "J. Leskovec"
            ],
            "title": "Inductive representation learning on large graphs",
            "venue": "NeurIPS",
            "year": 2017
        },
        {
            "authors": [
                "W. Hu",
                "M. Fey",
                "M. Zitnik",
                "Y. Dong",
                "H. Ren",
                "B. Liu",
                "M. Catasta",
                "J. Leskovec"
            ],
            "title": "Open graph benchmark: Datasets for machine learning on graphs",
            "venue": "NeurIPS",
            "year": 2020
        },
        {
            "authors": [
                "Z. Hu",
                "Y. Dong",
                "K. Wang",
                "Y. Sun"
            ],
            "title": "Heterogeneous graph transformer",
            "venue": "WWW",
            "year": 2020
        },
        {
            "authors": [
                "W. Huang",
                "T. Zhang",
                "Y. Rong",
                "J. Huang"
            ],
            "title": "Adaptive sampling towards fast graph representation learning",
            "venue": "NeurIPS",
            "year": 2018
        },
        {
            "authors": [
                "Y. Ji",
                "M. Yin",
                "H. Yang",
                "J. Zhou",
                "V.W. Zheng",
                "C. Shi",
                "Y. Fang"
            ],
            "title": "Accelerating large-scale heterogeneous interaction graph embedding learning via importance sampling",
            "venue": "TKDD",
            "year": 2020
        },
        {
            "authors": [
                "T.N. Kipf",
                "M. Welling"
            ],
            "title": "Semi-supervised classification with graph convolutional networks",
            "venue": "ICLR",
            "year": 2016
        },
        {
            "authors": [
                "G. Li",
                "M. M\u00fcller",
                "B. Ghanem",
                "V. Koltun"
            ],
            "title": "Training graph neural networks with 1000 layers",
            "venue": "ICML",
            "year": 2021
        },
        {
            "authors": [
                "G. Li",
                "C. Xiong",
                "A. Thabet",
                "B. Ghanem"
            ],
            "title": "Deepergcn: All you need to train deeper gcns",
            "venue": "arXiv preprint arXiv:2006.07739",
            "year": 2020
        },
        {
            "authors": [
                "H. Li",
                "Y. Liu",
                "Y. Li",
                "B. Huang",
                "P. Zhang",
                "G. Zhang",
                "X. Zeng",
                "K. Deng",
                "W. Chen",
                "C. He"
            ],
            "title": "Graphtheta: A distributed graph neural network learning system with flexible training strategy",
            "year": 2021
        },
        {
            "authors": [
                "L. Liao",
                "X. He",
                "H. Zhang",
                "T.S. Chua"
            ],
            "title": "Attributed social network embedding",
            "venue": "IEEE Transactions on Knowledge and Data Engineering 30(12), 2257\u20132270",
            "year": 2018
        },
        {
            "authors": [
                "M. Liu",
                "H. Gao",
                "S. Ji"
            ],
            "title": "Towards deeper graph neural networks",
            "venue": "SIGKDD",
            "year": 2020
        },
        {
            "authors": [
                "Z. Liu",
                "C. Chen",
                "L. Li",
                "J. Zhou",
                "X. Li",
                "L. Song",
                "Y. Qi"
            ],
            "title": "Geniepath: Graph neural networks with adaptive receptive paths",
            "venue": "AAAI",
            "year": 2019
        },
        {
            "authors": [
                "I. Loshchilov",
                "F. Hutter"
            ],
            "title": "Decoupled weight decay regularization",
            "venue": "ICLR",
            "year": 2019
        },
        {
            "authors": [
                "M.T. Luong",
                "H. Pham",
                "C.D. Manning"
            ],
            "title": "Effective approaches to attention-based neural machine translation",
            "venue": "EMNLP",
            "year": 2015
        },
        {
            "authors": [
                "T. Mikolov",
                "I. Sutskever",
                "K. Chen",
                "G.S. Corrado",
                "J. Dean"
            ],
            "title": "Distributed representations of words and phrases and their compositionality",
            "venue": "Advances in neural information processing systems. vol. 26, pp. 3111\u20133119",
            "year": 2013
        },
        {
            "authors": [
                "Z. Niu",
                "G. Zhong",
                "H. Yu"
            ],
            "title": "A review on the attention mechanism of deep learning",
            "venue": "Neurocomputing 452, 48\u201362",
            "year": 2021
        },
        {
            "authors": [
                "A. Paszke",
                "S. Gross",
                "F. Massa",
                "A. Lerer",
                "J. Bradbury",
                "G. Chanan",
                "T. Killeen",
                "Z. Lin",
                "N. Gimelshein",
                "L Antiga"
            ],
            "title": "Pytorch: An imperative style, highperformance deep learning library",
            "venue": "NeurIPS",
            "year": 2019
        },
        {
            "authors": [
                "J. Pavlopoulos",
                "P. Malakasiotis",
                "I. Androutsopoulos"
            ],
            "title": "Deeper attention to abusive user content moderation",
            "venue": "EMNLP",
            "year": 2017
        },
        {
            "authors": [
                "B. Perozzi",
                "R. Al-Rfou",
                "S. Skiena"
            ],
            "title": "Deepwalk: Online learning of social representations",
            "venue": "SIGKDD",
            "year": 2014
        },
        {
            "authors": [
                "M. Schlichtkrull",
                "T.N. Kipf",
                "P. Bloem",
                "R. Van Den Berg",
                "I. Titov",
                "M. Welling"
            ],
            "title": "Modeling relational data with graph convolutional networks",
            "venue": "European Semantic Web Conference",
            "year": 2018
        },
        {
            "authors": [
                "T. Shen",
                "J. Jiang",
                "T. Zhou",
                "S. Pan",
                "G. Long",
                "C. Zhang"
            ],
            "title": "Disan: Directional self-attention network for rnn/cnn-free language understanding",
            "venue": "AAAI",
            "year": 2018
        },
        {
            "authors": [
                "Y. Shi",
                "Z. Huang",
                "S. Feng",
                "H. Zhong",
                "W. Wang",
                "Y. Sun"
            ],
            "title": "Masked label prediction: Unified message passing model for semi-supervised classification",
            "venue": "arXiv preprint arXiv:2009.03509",
            "year": 2020
        },
        {
            "authors": [
                "C. Sun",
                "G. Wu"
            ],
            "title": "Adaptive graph diffusion networks with hop-wise attention",
            "venue": "arXiv preprint arXiv:2012.15024",
            "year": 2020
        },
        {
            "authors": [
                "A. Vaswani",
                "N. Shazeer",
                "N. Parmar",
                "J. Uszkoreit",
                "L. Jones",
                "A.N. Gomez",
                "L. Kaiser",
                "I. Polosukhin"
            ],
            "title": "Attention is all you need",
            "venue": "Advances in Neural Information Processing Systems",
            "year": 2017
        },
        {
            "authors": [
                "P. Veli\u010dkovi\u0107",
                "G. Cucurull",
                "A. Casanova",
                "A. Romero",
                "P. Lio",
                "Y. Bengio"
            ],
            "title": "Graph attention networks",
            "venue": "ICLR",
            "year": 2018
        },
        {
            "authors": [
                "G. Wang",
                "R. Ying",
                "J. Huang",
                "J. Leskovec"
            ],
            "title": "Direct multi-hop attention based graph neural network",
            "venue": "arXiv preprint arXiv:2009.14332",
            "year": 2020
        },
        {
            "authors": [
                "M. Wang",
                "L. Yu",
                "D. Zheng",
                "Q. Gan",
                "Y. Gai",
                "Z. Ye",
                "M. Li",
                "J. Zhou",
                "Q. Huang",
                "C Ma"
            ],
            "title": "Deep graph library: Towards efficient and scalable deep learning on graphs",
            "venue": "ICLR",
            "year": 2019
        },
        {
            "authors": [
                "X. Wang",
                "H. Ji",
                "C. Shi",
                "B. Wang",
                "Y. Ye",
                "P. Cui",
                "P.S. Yu"
            ],
            "title": "Heterogeneous graph attention network",
            "venue": "WWW",
            "year": 2019
        },
        {
            "authors": [
                "Y. Wang"
            ],
            "title": "Bag of tricks of semi-supervised classification with graph neural networks",
            "venue": "arXiv preprint arXiv:2103.13355",
            "year": 2021
        },
        {
            "authors": [
                "K. Xu",
                "W. Hu",
                "J. Leskovec",
                "S. Jegelka"
            ],
            "title": "How powerful are graph neural networks",
            "year": 2018
        },
        {
            "authors": [
                "K. Xu",
                "C. Li",
                "Y. Tian",
                "T. Sonobe",
                "Kawarabayashi",
                "K.i.",
                "S. Jegelka"
            ],
            "title": "Representation learning on graphs with jumping knowledge networks",
            "venue": "ICML",
            "year": 2018
        },
        {
            "authors": [
                "Z. Yang",
                "D. Yang",
                "C. Dyer",
                "X. He",
                "A. Smola",
                "E. Hovy"
            ],
            "title": "Hierarchical attention networks for document classification",
            "venue": "Proceedings of the 2016 conference of the North American chapter of the association for computational linguistics: human language technologies. pp. 1480\u20131489",
            "year": 2016
        },
        {
            "authors": [
                "R. Ying",
                "R. He",
                "K. Chen",
                "P. Eksombatchai",
                "W.L. Hamilton",
                "J. Leskovec"
            ],
            "title": "Graph convolutional neural networks for web-scale recommender systems",
            "venue": "SIGKDD. pp. 974\u2013983",
            "year": 2018
        },
        {
            "authors": [
                "S. Yun",
                "M. Jeong",
                "R. Kim",
                "J. Kang",
                "H.J. Kim"
            ],
            "title": "Graph transformer networks",
            "venue": "NeurIPS",
            "year": 2019
        },
        {
            "authors": [
                "C. Zhang",
                "D. Song",
                "C. Huang",
                "A. Swami",
                "N.V. Chawla"
            ],
            "title": "Heterogeneous graph neural network",
            "venue": "SIGKDD",
            "year": 2019
        },
        {
            "authors": [
                "C. Zhang",
                "A. Swami",
                "N.V. Chawla"
            ],
            "title": "Shne: Representation learning for semanticassociated heterogeneous networks",
            "venue": "WSDM",
            "year": 2019
        },
        {
            "authors": [
                "D. Zou",
                "Z. Hu",
                "Y. Wang",
                "S. Jiang",
                "Y. Sun",
                "Q. Gu"
            ],
            "title": "Layer-dependent importance sampling for training deep and large graph convolutional networks",
            "venue": "NeurIPS",
            "year": 2019
        }
    ],
    "sections": [
        {
            "text": "Keywords: Graph neural networks, Fine-grained information fusion, Bit-wise and feature-wise attention."
        },
        {
            "heading": "1 Introduction",
            "text": "Graph representation learning typically aims to learn an informative embedding for each graph node based on the graph topology (link) information. Generally,\n? Contributed to this work when the author worked in Ant and Alibaba Group. ?? Shuigeng Zhou is the corresponding author.\nar X\niv :2\n30 1.\n08 20\n9v 2\n[ cs\n.L G\n] 6\nthe embedding of a node is represented as a low-dimensional feature vector, which can be used to facilitate downstream applications. This research focuses on homogeneous graphs that have only one type of nodes and one type of edges. The purpose is to learn node representations from the graph topology [9,28,7]. Specifically, given a node u, either breadth-first search, depth-first search or random walk is used to identify a set of neighboring nodes. Then, u\u2019s embedding is learnt by maximizing the co-occurrence probability of u and its neighbors. Early studies on graph embedding have limited capability to capture neighboring information from a graph because they are based on shallow learning models such as SkipGram [24]. Moreover, transductive learning is used in these graph embedding methods, which cannot be generalized to new nodes that are absent in the training graph.\nGraph neural networks [15,10,34] are proposed to overcome the limitations of traditional graph embedding models. GNNs employ deep neural networks to aggregate feature information from neighboring nodes and thereby have the potential to gain better aggregated embeddings. GNNs can support inductive learning and infer the class labels of unseen nodes during prediction [10,34]. The success of GNNs is mainly due to the neighborhood information aggregation. However, GNNs face two challenges: which neighboring nodes of a target node are involved in message passing? and how much contribution each neighboring node makes to the aggregated embedding?. For the former question, neighborhood sampling [10,42,4,13,46,14] is proposed for large dense or power-law graphs. For the latter, neighbor importance estimation is used to attach different weights to different neighboring nodes during feature propagation. Importance sampling [4,46,14] and attention [34,21,37,43,12] are two popular techniques. Importance sampling is a special case of neighborhood sampling, where the importance weight of a neighboring node is drawn from a distribution over nodes. This distribution can be derived from normalized Laplacian matrices [4,46] or jointly learned with GNNs [14]. With this distribution, at each step a subset of neighbors is sampled, and aggregated with the importance weights. Similar to importance sampling, attention also attaches importance weights to neighbors. Nevertheless, attention differs from importance sampling. Attention is represented as a neural network and is always learned as a part of a GNN model. In contrast, importance sampling algorithms use statistical models without trainable parameters.\nExisting attention mechanisms consider only the correlation of node-wise, ignoring the suppression of noise information in transmission, and the information of edge features. In real world applications, only partial users authorize the system to collect theirs profiles. The model cannot learn the node-wise correlation between a profiled user and a user we know nothing about. Therefore, existing models will spread noise information, resulting in inaccurate node representations. However, two users who often transfer money to each other and two users who only have a few conversations have different correlation.\nIn this paper, to solve the problems mentioned above, we present a new graph neural network attention model, namely General Information Propagation\nAlgorithm (GIPA). We design a bit-wise correlation module and a feature-wise correlation module. Specifically, we believe that each dimension of the dense vector represents a feature of the node. Therefore, the bit-wise correlation module filters at the dense representation level. The dimension of attention weights is equal to that of density vector. In addition, we represent each attribute feature of the node as a one-hot vector. The feature-wise correlation module performs feature selection by outputting the attention weights of similar dimensionality and attribute features. It is worth mentioning that to enable the model to extract better attention weights, edge features that measure the correlation between nodes are also included in the calculation of attention. Finally, GIPA inputs sparse embedding and dense embedding into the wide end and deep end of the deep neural network for learning specific tasks, respectively. Our contributions are summarized as follows:\n1) We design the bit-wise correlation module and the feature-wise correlation module to perform more refined information weighted aggregation from the element level and the feature level, and utilize the edge information. 2) Based on the wide & deep architecture [6], we use dense feature representation and sparse feature representation to extract deep information and retain shallow original information respectively, which provides more comprehensive information for the downstream tasks. 3) Experiments on the Open Graph Benchmark (OGB) [11] proteins dataset (OGBN-proteins) demonstrate that GIPA achieves better accuracy with an average ROC-AUC of 0.8917 \u00b1 0.0007 7 than the state-of-the-art methods listed in the OGBN-proteins leaderboard 8. In addition, GIPA has been tested on billion-scale industrial Alipay dataset."
        },
        {
            "heading": "2 Related Work",
            "text": "In this section, we review existing attention primitive implementations in brief. [2] proposes an additive attention that calculates the attention alignment score using a simple feed-forward neural network with only one hidden layer. The alignment score score(q, k) between two vectors q and k is defined as score(q, k) = uT tanh(W [q; k]), where u is an attention vector and the attention weight \u03b1q,k is computed by normalizing score\u0303q,k over all q, k values with the softmax function. The core of the additive attention lies in the use of attention vector u. This idea has been widely adopted by several algorithms [41,27] for natural language processing. [23] introduces a global attention and a local attention. In global attention, the alignment score can be computed by three alternatives: dot-product (qT k), general (qTWk) and concat (W [q; k]). In contrast, local attention computes the alignment score solely from a vector (Wq). Likewise, both global and local attention normalize the alignment scores with the softmax function. [33] proposes a self-attention mechanism based on scaled dot-product. This\n7 The reproducible code is open source: https://github.com/houyili/gipa wide deep 8 https://ogb.stanford.edu/docs/leader nodeprop/#ogbn-proteins\nself-attention computes the alignment score between any q and k as follows: score\u0303q,k = q T k /\u221a\ndk. This attention differs from the dot-product attention [23] by only a scaling factor of 1\u221a\ndk . The scaling factor is used because the authors\nof [33] suspected that for large values of dk, dot-product is large in magnitude, which thereby pushes the softmax function into regions where it has extremely small gradients. More attention mechanisms, like feature-wise attention [30] and multi-head attention [33], can be referred to some surveys [3,25].\nIn addition, these aforementioned attention primitives have been extended to heterogeneous graphs. HAN [37] uses a two-level hierarchical attention that consists of a node-level attention and a semantic-level attention. In HAN, the node-level attention learns the importance of a node to any other node in a meta-path, while the semantic-level one weighs all meta-paths. HGT [44] weakens the dependency on meta-paths and instead uses meta-relation triplets as basic units. HGT uses node-type-aware feature transformation functions and edge-type-aware multi-head attention to compute the importance of each edge to a target node. It is worthy of mentioning that heterogeneous models must not always be superior to homogeneous ones, and vice versa. In this paper, unlike the node-wise attention in existing methods that ignores noise propagation, our proposed GIPA introduces two MLP-based correlation modules, the bit-wise correlation module and the feature-wise correlation module, to achieve fine-grained selective information propagation and utilize the edge information."
        },
        {
            "heading": "3 Methodology",
            "text": ""
        },
        {
            "heading": "3.1 Preliminaries",
            "text": "Graph Neural Networks. Consider an attributed graph G = {V, E}, where V is the set of nodes and E is the set of edges. GNNs use the same model framework as follows [10,39]:\nh\u0303ki = \u03c6(h\u0303 k\u22121 i ,Fagg({h\u0303 k\u22121 j , j \u2208 N (i)})) (1)\nand where Fagg represents an aggregation function, \u03c6 represents an update function, h\u0303ki represents the node embedding based on node feature x k i , and N (i) represents the neighbor node set. The objective of GNNs is to update the embedding of each node by aggregating the information from its neighbor nodes and the connections between them."
        },
        {
            "heading": "3.2 Model Architecture",
            "text": "In this section, we present the architecture of GIPA in Fig. 1, which extracts node features and edge features in a more general way. Consider a node i with feature embedding h\u0303i and its neighbor nodes j \u2208 N (i) with feature embedding h\u0303j . e\u0303i,j represents the edge feature between node i and j. The problem is how to generate an expected embedding for node i from its own node feature embedding h\u0303i, its neighbors\u2019 node features embedding {h\u0303j} and the related edge features\n{e\u0303i,j}. The workflow of GIPA consists of three major modules (or processes): attention, propagation and aggregation. First, GIPA computes the dense embedding h\u0303di , h\u0303 d j , and e\u0303i,j , and sparse embedding h\u0303 s i , h\u0303 s j from raw features. Then, the attention process calculates the bit-wise attention weights by using fullyconnected layers on h\u0303di , h\u0303 d j , and e\u0303i,j and feature-wise by using fully-connected layers on h\u0303si , h\u0303 s j , and e\u0303i,j . Following that, the propagation process focuses on propagating information of each neighbor node j by combining j\u2019s node embedding h\u0303j with the associated edge embedding e\u0303i,j . Finally, the aggregation process aggregates all messages from neighbors to update the embedding of i. The following subsections introduce the details of each process in one layer.\nEmbedding Layer. The GIPA (wide & deep) is more suitable for these scenarios: each node in GNN is not composed of text or images, but represents objects such as users, products, and proteins, whose features are composed of category features and statistical features. For example, the category feature in ogbn-proteins dataset is what species the proteins come from. And the statistical features in Alipay dataset are similar to the total consumption of users in a year.\nFor dense embedding, each integer number can express a category, each floating-point number can express a statistical value, thus a one-dimensional embedding can represent one feature. However, the sparse embedding of one feature requires more dimensions. For each category feature, one-hot encoding is required. For example, a certain \u201ccategory feature\u201d has a total of K possible categories, and an K+ 1 dimensional vector is required to represent the feature. And each \u201dstatistical feature\u201d is cut into K categories (using equal-frequency or equal-width cutting method), and then K + 1 dimensional one-hot encoding\nAlgorithm 1 The optimization strategy of GIPA\n1: Input: Graph G = {V, E}; input features {xv,\u2200v \u2208 V }; Number of layer K 2: Note: h\u0303\u2217v \u2208 {h\u0303sv, h\u0303dv} 3: h\u0303d 0\nv \u2190 DenseEmb(xv), \u2200v \u2208 V 4: h\u0303s 0\nv \u2190 SparseEmb(xv), \u2200v \u2208 V 5: while not end of epoch do 6: Select a subgraph Gt = {Vt, Et} \u2208 G 7: for each k \u2208 [1,K] do 8: if k > 1 9: h\u0303\u2217k\u22121i \u2190 o \u2217k\u22121 i , \u2200vi \u2208 Vt\n10: a\u0303\u2217ki,j \u2190 Fact(F\u2217att(h\u0303\u2217k\u22121i , h\u0303 \u2217k\u22121 j , e\u0303i,j |W \u2217 att)), \u2200vi \u2208 Vt 11: m\u2217ki,j \u2190 a\u0303\u2217ki,j \u2217 F\u2217prop(h\u0303\u2217k\u22121j , e\u0303i,j |W \u2217 prop), \u2200vi \u2208 Vt\n12: o\u2217ki \u2190 F\u2217agg( \u2211 j\u2208N (i) m \u2217k i,j , h\u0302 \u2217k\u22121 i |W \u2217 agg), \u2200vi \u2208 Vt 13: y\u0302i = Deep(o dk i ) + Wwide(o sk i )\n14: L\u2190 \u2211 \u2200vi\u2208Vt l(yi, y\u0302i) 15: Update all parameters by gradient of L\nis performed. Thus, the concatenations of dense and sparse embeddings are the inputs of deep part and wide part respectively.\nAttention Process. Different from the existing attention mechanisms like selfattention or scaled dot-product attention, we use MLP to realize a bit-wise attention mechanism and a feature-wise attention mechanism. The bit-wise and feature-wise attention process of GIPA can be formulated as follows:\nadi,j = Fdatt(h\u0303di , h\u0303dj , e\u0303i,j |W datt) = MLP([h\u0303di ||h\u0303dj ||e\u0303i,j ]|W datt) (2)\nasi,j = Fsatt(h\u0303si , h\u0303sj , e\u0303i,j |W satt) = MLP([h\u0303si ||h\u0303sj ||e\u0303i,j ]|W satt) (3)\nwhere adi,j \u2208 Rn is bit-wise attention weight and its dimension is the same as that of h\u0303di , a s i,j \u2208 Rm is feature-wise attention weight and its dimension is the same as the number of node features, the attention function F\u2217att is realized by an MLP with learnable weights W \u2217att (without bias). Its input is the concatenation of the node embeddings h\u0303\u2217i and h\u0303 \u2217 j as well as the edge embedding e\u0303i,j . As the edge features e\u0303i,j measuring the correlation between nodes are input into MLP, this attention mechanism could be more representative than previous ones simply based on dot-product. The final attention weight is calculated by an activation function for bit-wise part and feature-wise part:\na\u0303\u2217i,j = Fact(a\u2217i,j) (4)\nwhere Fact represents the activation function, such as softmax, leaky-relu, softplus, etc. Based on the experimental results, we finally define the activation function as softplus. Details can be seen in Section 4.3.\nPropagation Process. Unlike GAT [34] that considers only the node feature of neighbors, GIPA incorporates both node and edge embeddings during the propagation process:\npdi,j = Fdprop(h\u0303dj , e\u0303i,j |W dprop) = MLP([h\u0303dj ||e\u0303i,j ]|W dprop), (5)\npsi,j = Fsprop(h\u0303sj , e\u0303i,j |W sprop) = MLP([h\u0303sj ||e\u0303i,j ]|W sprop), (6)\nwhere the propagation function F\u2217prop is also realized by an MLP with learnable weights W \u2217prop. Its input is the concatenation of a neighbor node dense and sparse embeddings h\u0303\u2217j and the related edge embedding e\u0303i,j . Thus, the propagation is done bit-wise and feature-wise rather than node-wise.\nCombining the results by attention and propagation by bit-wise and featurewise multiplication, GIPA gets the message mdi,j and m s i,j of node i from j:\nmdi,j = a\u0303 d i,j \u2217 pdi,j msi,j = a\u0303si,j \u2297 psi,j (7)\nAggregation Process. For each node i, GIPA repeats previous processes to get messages from its neighbors. The aggregation process first gathers all these messages by a reduce function, summation for example:\nm\u2217i = \u2211\nj\u2208N (i)\nm\u2217i,j (8)\nThen, a residual connection between the linear projection h\u0302\u2217i and the message of mi is added through concatenation:\nh\u0302di = W d proj h\u0303 d i h\u0302 s i = W s proj h\u0303 s i (9)\nodi = Fdagg(mdi , h\u0303di |W dagg) = MLP([mdi ||h\u0303di ]|W dagg)\u2295 h\u0302di (10)\nosi = Fsagg(msi , h\u0303si |W sagg) = MLP([msi ||h\u0303si ]|W sagg)\u2295 h\u0302si (11)\nwhere an MLP with learnable weights W \u2217agg is applied to get the final dense output odi and sparse output o s i . Finally, we would like to emphasize that the process of GIPA can be easily extended to multi-layer variants by stacking the process multiple times. After we get the aggregated output of the node, odi and o s i respectively input the depth side and wide side of the Deep&Wide architecture for downstream tasks. See algorithm 1 for details."
        },
        {
            "heading": "4 Experiments",
            "text": ""
        },
        {
            "heading": "4.1 Datasets and Settings",
            "text": "Datasets. In our experiments, we choose two edge-attribute dataset: the ogbnproteins dataset from OGB [11] and Alipay dataset[18]. The ogbn-proteins dataset is an undirected and weighted graph, containing 132,534 nodes of 8 different species and 79,122,504 edges with 8-dimensional features. The task is a multilabel binary classification problem with 112 classes representing different protein functions. The Alipay dataset is an edge attributed graph, containing 1.40 billion nodes with 575 features and 4.14 billion edges with 57 features. The task is a multi-label binary classification problem. It is worth noting that due to the high cost of training on Alipay data set, we only conduct ablation experiments on the input features of Fatt and Fprop in the industrial data set, as Table 3. Baselines. Several representative GNNs including SOTA GNNs are used as baselines. For semi-supervised node classification, we utilize GCN [15], GraphSAGE [10], GAT [34], MixHop [1], JKNet [40], DeeperGCN [17], GCNII [5], DAGNN [20], MAGNA [35], UniMP [31], GAT+BoT [38], RevGNN [16] and AGDN [32]. Note that DeeperGCN, UniMP, RevGNN, and AGDN are implemented with random partition. GAT is implemented with neighbor sampling. Except for our GIPA, results of other methods are from their papers or the OGB leaderboard. Evaluation metric. The performance is measured by the average ROC-AUC scores. We follow the dataset splitting settings as recommended in OGB and test the performance of 10 different trained models with different random seeds. Hyperparameters. For the number of layers K, we search the best value from 1 to 6. As for the activation function of attention process, we consider common activation functions. For details, please refer to Section 4.3. Running environment. For ogbn-proteins dataset, GIPA is implemented in Deep Graph Library (DGL) [36] with Pytorch [26] as the backend. Experiments are done in a platform with Tesla V100 (32G RAM). For Alipay dataset, GIPA is implemented in GraphTheta [18], and runs on private cloud of Alibaba Group."
        },
        {
            "heading": "4.2 Performance Comparison",
            "text": "Table 1 shows the average ROC-AUC and the standard deviation for the test and validation set. The results of the baselines are retrieved from the ogbn-proteins leaderboard8. Our GIPA outperforms all previous methods in the leaderboard and reaches an average ROC-AUC higher than 0.89 for the first time. Furthermore, GIPA only with 3 layer achieved the SOTA performance on ogbn-proteins dataset. This result shows the effectiveness of our proposed bit-wise and featurewise correlation modules, which can leverage the edge features to improve the performance by fine-grained information fusion and noise suppression.\nTo further investigate the impact of each component in our proposed GIPA, we conduct the ablation study on the ogbn-proteins dataset. As shown in Table 2, compare with GIPA w/o bit-wise module, GIPA w/o feature-wise module. And\nthe combination of these components (i.e., GIPA) yields the best performance, which indicates the necessity of bit-wise and feature-wise correlation modules.\nThe average training times per epoch on ogbn-proteins with GIPA, 3-Layer GIPA, AGDN are 8.2 seconds (s), 5.9s, and 4.9s, respectively. The average inference times on whole graph of ogbn-proteins with GIPA, 3-Layer GIPA, AGDN are 11.1s, 9.3s, and 10.7s, respectively. Compared with ADGN, GIPA is slower in training speed, but has advantages in inference speed."
        },
        {
            "heading": "4.3 Hyperparameter Analysis and Ablation Study",
            "text": "Effect of the number of layers K. To study the impact of the number of layers K on performance, we vary its value to {1, 2, 3, 4, 5, 6}. As shown in Fig. 2a, with the increase of layers, the performance of the model on the test set gradually converges. However, in the comparison between the five layers and the six layers, the increase in the performance of the model on the verification set is far greater than that on the test set. This result shows that with the increase of complexity, the performance of the model can be improved, but there will be an over-fitting problem at a bottleneck. Therefore, we finally set K to 6. Analysis on Attention Process with Correlation Module. Because the bit-wise correlation module and the feature-wise correlation module are the most important parts of GIPA, we make a detailed analysis of their architecture, including activation function and edge feature.\n1) Activation function: as shown in Fig. 2b, by comparing these activation functions: the performance of tanh and relu are even worse than the one without activator. The model using softmax as the activation function achieves the best performance, but the performance of model using softplus is close to it. This phenomenon indicates that the attention module of GIPA can adaptively learn the correlation weight between nodes. Cause \u2211 j\u2208N(i) aij is needed to be calculated firstly by aggregation from all neighbors, the normalization operation of softmax is a costly operation in GNN. On the other hand, GIPA with softplus trains faster than that with softmax on ogbn-proteins. Considering the trade-off between cost and performance, softplus is adopted on billion-scale Alipay dataset. 2) Edge feature: As shown in Table 2, we find that the performance of GIPA is better than that of GIPA w/o edge feature, which means that the edge feature contains the correlation information between two nodes. Therefore, it is an indispensable feature in attention processing and can help the two correlation modules get more realistic attention weights."
        },
        {
            "heading": "5 Conclusion",
            "text": "We have presented GIPA, a new graph attention network architecture for graph data learning. GIPA consists of a bit-wise correlation module and a feature-wise correlation module, to leverage edge information and realize the fine granularity information propagation and noise filtering. Performance evaluation on the ogbnproteins dataset has shown that our method outperforms the state-of-the-art methods listed in the ogbn-proteins leaderboard. And it has been tested on the billion-scale industrial dataset."
        }
    ],
    "title": "GIPA: A General Information Propagation Algorithm for Graph Learning",
    "year": 2023
}