{
    "abstractText": "Reconfigurable intelligent surfaces (RISs) are one of the most promising technological enablers of the next (6th) generation of wireless systems. In this paper, we introduce a novel use-case of the RIS technology in radio localization, which is enabling the user to estimate its own position via transmitting orthogonal frequency-division multiplexing (OFDM) pilots and processing the signal reflected from the RIS. We demonstrate that user localization in this scenario is possible by deriving Cram\u00e9rRao lower bounds on the positioning error and devising a lowcomplexity position estimation algorithm. We consider random and directional RIS phase profiles and apply a specific temporal coding to them, such that the reflected signal from the RIS can be separated from the uncontrolled multipath. Finally, we assess the performance of our position estimator for an example system, and show that the proposed algorithm can attain the derived bound at high signal-to-noise ratio values.",
    "authors": [
        {
            "affiliations": [],
            "name": "Kamran Keykhosravi"
        },
        {
            "affiliations": [],
            "name": "Gonzalo Seco-Granados"
        },
        {
            "affiliations": [],
            "name": "George C. Alexandropoulos"
        },
        {
            "affiliations": [],
            "name": "Henk Wymeersch"
        }
    ],
    "id": "SP:8d41e101c6e737551402d39d9222a43a52a42c69",
    "references": [
        {
            "authors": [
                "Q. Wu",
                "R. Zhang"
            ],
            "title": "Towards smart and reconfigurable environment: Intelligent reflecting surface aided wireless network",
            "venue": "IEEE Commun. Mag., vol. 58, no. 1, pp. 106\u2013112, Jan. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "G.C. Alexandropoulos",
                "N. Shlezinger",
                "P. del Hougne"
            ],
            "title": "Reconfigurable intelligent surfaces for rich scattering wireless communications: Recent experiments, challenges, and opportunities",
            "venue": "IEEE Commun. Mag., vol. 59, no. 6, pp. 28\u201334, Jun. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "E. Calvanese Strinati",
                "G.C. Alexandropoulos",
                "H. Wymeersch"
            ],
            "title": "Reconfigurable, intelligent, and sustainable wireless environments for 6G smart connectivity",
            "venue": "IEEE Commun. Mag., to appear, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "H. Wymeersch",
                "J. He",
                "B. Denis",
                "A. Clemente",
                "M. Juntti"
            ],
            "title": "Radio localization and mapping with reconfigurable intelligent surfaces: Challenges, opportunities, and research directions",
            "venue": "IEEE Veh.Technol. Mag., vol. 15, no. 4, pp. 52\u201361, Dec. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "D. Dardari",
                "N. Decarli",
                "A. Guerra",
                "F. Guidi"
            ],
            "title": "Localization in NLOS conditions using large reconfigurable intelligent surfaces",
            "venue": "Proc. IEEE SPAWC, Sep. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "S. Hu",
                "F. Rusek",
                "O. Edfors"
            ],
            "title": "Beyond massive MIMO: The potential of positioning with large intelligent surfaces",
            "venue": "IEEE Trans. Signal Processing, vol. 66, no. 7, pp. 1761\u20131774, Apr. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "Z. Abu-Shaban",
                "K. Keykhosravi",
                "M.F. Keskin",
                "G.C. Alexandropoulos",
                "G. Seco-Granados",
                "H. Wymeersch"
            ],
            "title": "Near-field localization with a reconfigurable intelligent surface acting as lens",
            "venue": "Proc. IEEE ICC, Montreal, Canada, Jun. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M. Rahal",
                "B. Denis",
                "K. Keykhosravi",
                "B. Uguen",
                "H. Wymeersch"
            ],
            "title": "RIS-enabled localization continuity under near-field conditions",
            "venue": "Proc. IEEE SPAWC, Jun. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "A. Fascista",
                "A. Coluccia",
                "H. Wymeersch",
                "G. Seco-Granados"
            ],
            "title": "RIS-aided joint localization and synchronization with a single-antenna mmwave receiver",
            "venue": "Proc. IEEE ICASSP, Jun. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "K. Keykhosravi",
                "M.F. Keskin",
                "G. Seco-Granados",
                "H. Wymeersch"
            ],
            "title": "SISO RIS-enabled joint 3D downlink localization and synchronization",
            "venue": "Proc. IEEE ICC, Montreal, Canada, Jun. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "K. Keykhosravi",
                "M.F. Keskin",
                "S. Dwivedi",
                "G. Seco-Granados",
                "H. Wymeersch"
            ],
            "title": "Semi-passive 3D positioning of multiple RIS-enabled users",
            "venue": "IEEE Trans. Vehicular Tech., to appear, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "H. Zhang",
                "H. Zhang",
                "B. Di",
                "K. Bian",
                "Z. Han",
                "C. Xu",
                "D. Zhang",
                "L. Song"
            ],
            "title": "RSS fingerprinting based multi-user outdoor localization using reconfigurable intelligent surfaces",
            "venue": "Proc. IEEE ISMICT, Apr. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "A. Elzanaty",
                "A. Guerra",
                "F. Guidi",
                "M.-S. Alouini"
            ],
            "title": "Reconfigurable intelligent surfaces for localization: Position and orientation error bounds",
            "venue": "IEEE Trans. Signal Process., vol. 69, pp. 5386\u20135402, Aug. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "Y. Liu"
            ],
            "title": "Reconfigurable intelligent surface aided wireless localization",
            "venue": "Proc. IEEE ICC, Montreal, Canada, Jun. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "S. Buzzi",
                "E. Grossi",
                "M. Lops",
                "L. Venturino"
            ],
            "title": "Radar target detection aided by reconfigurable intelligent surfaces",
            "venue": "IEEE Signal Process. Lett., vol. 28, pp. 1315\u20131319, Jun. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "W. Lu",
                "B. Deng",
                "Q. Fang",
                "X. Wen",
                "S. Peng"
            ],
            "title": "Intelligent reflecting surface-enhanced target detection in MIMO radar",
            "venue": "IEEE Sensors Lett., vol. 5, no. 2, Feb. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "J.V. Alegr\u0131\u0301a",
                "F. Rusek"
            ],
            "title": "Cram\u00e9r-rao lower bounds for positioning with large intelligent surfaces using quantized amplitude and phase",
            "venue": "Proc. Asilomar CSSC, Pacific Grove, USA, Nov. 2019, pp. 10\u201314.",
            "year": 2019
        },
        {
            "authors": [
                "K. Keykhosravi",
                "H. Wymeersch"
            ],
            "title": "Multi-RIS discrete-phase encoding for interpath-interference-free channel estimation",
            "venue": "[Online] https://arxiv.org/abs/2106.07065, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "S.M. Kay"
            ],
            "title": "Fundamentals of statistical signal processing: Estimation Theory",
            "venue": "Prentice Hall PTR,",
            "year": 1993
        },
        {
            "authors": [
                "W. Tang",
                "M.Z. Chen",
                "X. Chen"
            ],
            "title": "Wireless communications with reconfigurable intelligent surface: Path loss modeling and experimental measurement",
            "venue": "IEEE Trans. Wireless Commun., vol. 20, no. 1, pp. 421\u2013 439, Jan. 2021.",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "RIS-Enabled Self-Localization: Leveraging Controllable Reflections With Zero Access Points\nKamran Keykhosravi\u2217, Gonzalo Seco-Granados\u2020, George C. Alexandropoulos\u2021, and Henk Wymeersch\u2217\n\u2217 Department of Electrical Engineering, Chalmers University of Technology, Sweden \u2020 Department of Telecommunications and Systems Engineering, Universitat Autono\u0300ma de Barcelona, Spain \u2021Department of Informatics and Telecommunications, National and Kapodistrian University of Athens, Greece\nemails: {kamrank, henkw}@chalmers.se, gonzalo.seco@uab.es, alexandg@di.uoa.gr\nAbstract\u2014Reconfigurable intelligent surfaces (RISs) are one of the most promising technological enablers of the next (6th) generation of wireless systems. In this paper, we introduce a novel use-case of the RIS technology in radio localization, which is enabling the user to estimate its own position via transmitting orthogonal frequency-division multiplexing (OFDM) pilots and processing the signal reflected from the RIS. We demonstrate that user localization in this scenario is possible by deriving Crame\u0301rRao lower bounds on the positioning error and devising a lowcomplexity position estimation algorithm. We consider random and directional RIS phase profiles and apply a specific temporal coding to them, such that the reflected signal from the RIS can be separated from the uncontrolled multipath. Finally, we assess the performance of our position estimator for an example system, and show that the proposed algorithm can attain the derived bound at high signal-to-noise ratio values.\nIndex Terms\u2014Radio localization, reconfigurable intelligent surface, maximum likelihood estimation, radar.\nI. INTRODUCTION\nReconfigurable intelligent surfaces (RISs) are expected to revolutionize wireless systems by enabling smart radio environments, where the propagation channel can also be programmed to improve the Quality of Service (QoS) [1], [2]. In general, an RIS can be modeled as a planar array of subwavelength unit cells, each of which can scatter the impinging signal after modulating its phase in a controlled fashion [3]. The RIS phase profile can then be designed for optimal beamforming, localization, or interference management. Recently, a large body of research has been devoted to study the modeling, control, phase-profile design, and potential use-cases of RISs for both communications and radio localization [4]. With radio localization (which is the main topic of this paper) RISs can enable or boost the accuracy of user equipment (UE) positioning by providing: i) a strong reflected signal path towards the UE, and ii) a reference position [5]. Being costand energy-efficient, RISs have the potential to boost/enable radio localization in a wide variety of situations, specifically in those where GPS signal is unavailable or weak, e.g., in city canyons, indoor environments, and tunnels.\nMany studies have been conducted to investigate RIS-aided localization in different scenarios, which can be categorized in terms of the operating regime (near-field [6]\u2013[9], far-field [10]\u2013[12]), RIS placement (at the base station (BS) side [7],\n[8], at the UE side [12], or as a separate reflector [13], [14]), wireless settings (multiple-input multiple-output (MIMO) [14], [15], multiple-input single-output (MISO) [10], and singleinput single-output (SISO) [9], [11]), etc. Furthermore, RISs can be used to assist the radar systems to improve the target detection capabilities [16], [17]. In [7], Crame\u0301r-Rao lower bounds (CRB) on the localization error were established for the near-field of a continuous RIS and the effects of the RIS size were studied. For the same scenario, the effects of limited RIS phase resolution was investigated in [18]. In [8], localization with an RIS acting as a lens has been considered and an estimation algorithm was proposed. Nearfield localization with one BS and an RIS has been studied in [6], [9], where it is shown that the wavefront curvature can be used to localize the UE, even if the direct path from the BS to UE is blocked. Specifically, the authors in [6] illustrated that by using a large stripe-like RIS, positioning can be performed even if the RIS is severely obstructed. For a generic MIMO setting equipped with an RIS, the CRBs have been developed on location and orientation errors in [14]. In [15], the authors considered an RIS-aided MIMO scenario, derived the CRBs, and used the bounds to optimize the RIS phase profile for localization. Furthermore, it has been shown that localization and UE synchronization can be performed in a MISO [10] and even in a SISO [11] setup with the help of a single RIS, when far-field conditions hold.\nIn this paper, we present a novel use-case for RIS-enabled\nar X\niv :2\n20 2.\n11 15\n9v 1\n[ ee\nss .S\nP] 2\n2 Fe\nb 20\n22\nlocalization, where an RIS is used to reflect the signal transmitted from the UE back to the UE itself, and there are no access points or BSs present (see Fig. 1). We establish the channel model for orthogonal frequency-division multiplexing (OFDM) transmission by taking into account the undesired multipath from the surrounding environment. This multipath is then removed via a specific RIS profile design and a postprocessing step at the UE side. Next, we estimate the user position by first obtaining a coarse estimate and then refining it to maximize the likelihood function. Finally, we evaluate our estimation method and compare its accuracy to our derived CRBs. It is shown that the proposed estimator attains the bounds at high signal-to-noise ratios (SNRs).\nNotations: Vectors are shown by bold lower-case letters and matrices by bold upper-case ones. We use [a]i to indicate the ith element of the vector a and [A]i,j to denote the element at the ith row and the jth column of matrix A. Furthermore, the subindex i : j is used to specify all the elements between i and j. All vectors are column vectors by default. Transpose, Hermitian, and complex-conjugate operations are denoted by (\u00b7)>, (\u00b7)H, and (\u00b7)\u2217, respectively. The Hadamard product is indicated by ."
        },
        {
            "heading": "II. SYSTEM AND CHANNEL MODEL",
            "text": "We consider a single-antenna full-duplex UE with unknown location pu \u2208 R3 and a single RIS with known center location pr \u2208 R3 and orientation R \u2208 SO(3). We assume that the RIS is handled by a dedicated controller with whom the UE can communicate for establishing synchronization [4]. The UE location relative to the RIS is defined as pur = pu \u2212 pr. The RIS has M elements in a square configuration. We indicate the location of the mth RIS element by pr,m. The UE transmits T OFDM signals with N subcarriers and receives the backscattered signals from the RIS and from some other scatterers in the environment. We assume that the UE-RIS (or RIS-UE) channel has negligible non line-of-sight (NLOS) components. Furthermore, we assume that all the transmitted pilot symbols are equal to \u221a Es, with Es being the symbol energy. Then, the received signal at the UE at the discrete time t = 1, 2, . . . , T can be modeled as follows:\nyt , \u221a Es\u03b20d(\u03c40)a(pur) >\u2126ta(pur)\n+ \u221a Es L\u2211 l=1 \u03b2ld(\u03c4l) + nt. (1)\nHere, \u03c40 , 2\u2016pur\u2016/c is the transmission delay, where c is the speed of light. The delay steering vector is defined as\nd(\u03c4) , [1, e\u22122\u03c0\u03c4\u2206f , . . . , e\u22122\u03c0\u03c4(N\u22121)\u2206f ]>, (2)\nwhere \u2206f is the subcarrier spacing. The complex channel gain is denoted by \u03b20 \u2208 C. The vector a(pur) \u2208 CM indicates the RIS response, having the elements for m = 1, 2, . . . ,M :\n[a(pur)]m = exp\n(  2\u03c0\n\u03bb (\u2016pu \u2212 pr\u2016 \u2212 \u2016pu \u2212 pr,m\u2016)\n) , (3)\nwhere \u03bb , c/fc is the wavelength with fc being the carrier frequency. Furthermore, we have \u2126t , diag(\u03c9t), where \u03c9t \u2208 CM is the RIS phase profile, i.e., for each m, the amplitude of [\u03c9t]m is one and its phase indicates the phase shift applied by the mth element of RIS to the impinging signal. The noise term nt is assumed to be spatially and temporally white with covariance \u03c32nIN . The number of uncontrolled multipath components is denoted by L. The path loss and the delay for the `th path are denoted by \u03b2` and \u03c4`, respectively. By using the following definition:\nb(pur) , a(pur) a(pur), (4)\nwe can rewrite (1) in the more compact form:\nyt = \u221a Es\u03b20d(\u03c40)b(pur) >\u03c9t + \u221a Es L\u2211 l=1 \u03b2ld(\u03c4l) + nt. (5)\nWe assume that the UE has the knowledge of the RIS location and orientation and also the RIS phase profiles \u2126t, which change over time; this information can be communicated by the RIS controller. This controller also coordinates the start of the pilot transmission with the UE. Using these system control settings, the UE\u2019s goal is to estimate its position via its received signal yt. We next establish the requirement for the RIS element spacing in order to avoid ambiguities in the UE position estimation.\nRemark 1. To avoid grating lobes, which causes ambiguity in the position estimation at the far field, the RIS element spacing should be at least \u03bb/4. To show this, we rewrite the far-field approximation of the vector b(pu) in (4) for a twodimensional (2D) case with an 1 \u00d7M uniform linear array (ULA) RIS, as [bff(\u03b8)]m = exp( 4\u03c0\u03bb md sin \u03b8), where \u03b8 is the angle between pur and the RIS normal. Since we assume that the UE is placed in the front side of the RIS, we have that \u03b8 = [\u2212\u03c0/2, \u03c0/2], and hence, sin(\u03b8) = [\u22121, 1]. Therefore, the phase difference between two consecutive entries of the vector bff(\u03b8) is between [\u22124\u03c0d/\u03bb 4\u03c0d/\u03bb]. Consequently, it must hold 8\u03c0d/\u03bb \u2264 2\u03c0, resulting in d \u2264 \u03bb/4, to be able to find \u03b8 without ambiguity."
        },
        {
            "heading": "III. RIS PHASE PROFILE DESIGN",
            "text": "In this section, we study the design of the RIS phase profile \u03c9t. First, we describe how to design \u03c9t to remove the uncontrolled multipath at the UE\u2019s receiver, and then, we introduce the random and directional RIS phase profiles, which are used in simulation results in Section VI."
        },
        {
            "heading": "A. Multipath Removal",
            "text": "To remove the multipath from the received signal in (5), using the method presented in [19]. First, we design the RIS phase profiles for half of the transmission time and denote them by \u03c9\u0303t\u0303 \u2208 CM , where t\u0303 = 1, 2, . . . , T/2 (T is assumed even). The vectors \u03c9\u0303t\u0303 can be chosen based on a random codebook (explained later on in Section III-B), a directional one (explained in Section III-C), or any other strategy. Then,\nwe let \u03c92t\u0303\u22121 = \u03c9\u0303t\u0303 and \u03c92t\u0303 = \u2212\u03c9\u0303t\u0303. Consequently, at the UE receiver, we compute the following quantity:\ny\u0303t\u0303 = 1\n2 (y2t\u0303\u22121 \u2212 y2t\u0303) (6) = \u221a Es\u03b20d(\u03c40)b(pur) >\u03c9\u0303t\u0303 + n\u0303t, (7)\nwhere (7) follows from (5) and n\u0303t is a white complex Gaussian noise with covariance matrix \u03c32n/2IN . It can be seen that the multipath contribution has been disappeared in (7)."
        },
        {
            "heading": "B. Random Codebook",
            "text": "The random codebook is used when there exists no prior knowledge of the UE location. With this codebook, we have [\u03c9\u0303t]m = exp(\u03b8m,t), where \u03b8m,t \u2200m, t are chosen randomly according to the uniform distribution over the interval [0, 2\u03c0), each one independently from each other."
        },
        {
            "heading": "C. Directional Codebook",
            "text": "We use the directional codebook when there exists a prior knowledge about the UE position. We assume that an approximate location qu is available, which is distributed uniformly within the sphere S(pu, \u03b4), with \u03b4 being the uncertainty radius, and for any c \u2208 R3 and r \u2208 R+ holds:\nS(c, r) = {x \u2208 R3 \u2223\u2223\u2016c\u2212 x\u2016 \u2264 r}. (8)\nTo generate a directional codebook, we first select T/2 points qu,t\u0303 \u2208 R3, with t\u0303 = 1, 2, . . . , T/2, randomly and uniformly within the sphere S(qu, \u03b4). Then, we design the RIS phase profiles as:\n\u03c9\u0303t\u0303 = b(qu,t\u0303 \u2212 pr)\u2217. (9)\nIt can be seen that by assigning the RIS phase profile according to the latter expression, the reflected signal power is directed towards the points qu,t\u0303."
        },
        {
            "heading": "IV. FISHER INFORMATION ANALYSIS",
            "text": "In this section, we present an analytical lower bound on the estimation error based on the Fisher information matrix (FIM) analysis. For all unbiased estimators, the estimation error is lower-bounded by the position error bound (PEB), that is\nPEB , \u221a tr ([J(\u03b7)\u22121]3:5,3:5). (10)\nHere, \u03b7 \u2208 R5+3L is the vector of unknowns that is\n\u03b7 , [\u03c10, \u03d50,p > u , \u03c11, \u03d51, \u03c41, . . . , \u03c1L, \u03d5L, \u03c4L] >, (11)\nwhere \u03c1l = |\u03b2l| and \u03d5l = \u2220\u03b2l for l = 0, 1, . . . , L. Furthermore, J(\u03b7) is the FIM, which is defined as [20]\nJ(\u03b7) , 2Es \u03c32n <  T\u2211 t=1 ( \u2202\u00b5t \u2202\u03b7 )H \u2202\u00b5t \u2202\u03b7  , (12) where \u00b5t , \u03b20d(\u03c40)b(pur)>\u03c9t + \u2211L l=1 \u03b2ld(\u03c4l). Next, we study the structure of the FIM when the temporal sum of the utilized RIS phase profiles (i.e., \u2211 t \u03c9t) becomes the all-zero\nvector. This includes (but is not restricted to) the codebooks discussed in Section III.\nProposition 1. In the FIM expression given by (12), any element of the form:\nT\u2211 t=1 ( \u2202\u00b5t \u2202\u03b7LOS )H \u2202\u00b5t \u2202\u03b7NLOS\n(13)\nfor any \u03b7LOS \u2208 \u03b7LOS , [\u03c10, \u03d50,p>u ]> and any \u03b7NLOS \u2208 [\u03c11, \u03d51, \u03c41, . . . , \u03c1L, \u03d5L, \u03c4L]\n> evaluates to zero, provided that\u2211 t \u03c9t = 0 holds.\nProof. Any term of the form \u2202\u00b5t/\u2202\u03b7LOS depends linearly on \u03c9t, while any term \u2202\u00b5t/\u2202\u03b7NLOS is independent of \u03c9t. Since\u2211 t \u03c9t = 0, the corresponding entry in the FIM will evaluate to zero.\nBased on Proposition 1, the FIM has the following structure:\nJ(\u03b7) =\n[ J(\u03b7LOS) 0\n0 J(\u03b7NLOS)\n] , (14)\nwhere 0 indicates the all-zero matrix and J(\u03b7LOS) and J(\u03b7NLOS) are defined similar to (12). Using the Schur\u2019s complement method, we have that\n[J(\u03b7)\u22121]1:5,1:5 = J(\u03b7LOS) \u22121. (15)\nHence, we can limit our discussion to the LOS path to be able to calculate the the PEB in (10). The partial derivatives needed in (12) can be expressed as\n\u2202\u00b5t \u2202\u03c10 = ej\u03d50b(pur) >\u03c9t d(\u03c40), (16) \u2202\u00b5t \u2202\u03d50 = j\u03b20b(pur) >\u03c9t d(\u03c40), (17)\n\u2202\u00b5t \u2202pu = 2\u03b20b(pur) >\u03c9t c d\u0307(\u03c40)u > ur + \u03b20d(\u03c40)\u03c9 > t B\u0307(pur),\n(18)\nwhere we have used the following definitions:\nd\u0307(\u03c40) , \u2202d(\u03c40)\n\u2202\u03c4 = \u2212j2\u03c0\u2206f n d(\u03c40), (19)\nB\u0307(pur) , \u2202b(pu)\n\u2202pu (20)\n= \u2212j 4\u03c0 \u03bb\n( diag (b(pur))K> \u2212 b(pur)u>ur ) (21)\nwith uur , pur/\u2016pur\u2016, K , [u0,u1, . . . ,uM\u22121], um , (pu\u2212 pr,m)/\u2016pu\u2212 pr,m\u2016, and n , [0, 1, . . . , N \u2212 1]. Putting all of the above together, the FIM for the LOS path is\nJ(\u03b7LOS) = 2Es \u03c32n  NG 0 <{z>}0 N |\u03b20|2G |\u03b20|={z>} <{z} |\u03b20|={z} H  , (22) where we have used the definitions:\nG , \u2211 t |b(pur)>\u03c9t|2, (23)\n(24)\nz> , 2|\u03b20| c GdHd\u0307u>ur +N |\u03b20|bHCB\u0307, (25)\nH , 4|\u03b20|2\nc2 G\u2016d\u0307\u20162uuru>ur\n+ |\u03b20|2N< { B\u0307HCB\u0307 } + 2|\u03b20|2 c < { U +UH } . (26)\nIn the latter expressions, we have dropped the dependencies on \u03c40 and pur for notation simplification. Furthermore, we used:\nC , \u2211 t (\u03c9\u2217t\u03c9 > t ), (27)\nU , ( d\u0307Hd ) uurb HCB\u0307. (28)\nBy using Schur\u2019s complement, we can calculate the equivalent FIM (EFIM) of pu as\nJ(pu) = 8|\u03b20|2EsG c2\u03c32n\n( \u2016d\u0307\u20162 \u2212 |d\u0307 Hd|2\nN\n) uuru > ur (29)\n+ 2Es|\u03b20|2N\n\u03c32n\n( <{B\u0307HF B\u0307} \u2212 1\nG <{B\u0307HFbbHFB\u0307}\n) .\nThen, the PEB in (10) can be computed as PEB = \u221a tr (J(pu)\u22121). (30)\nRemark 2. In far-field conditions, the vector b(pur) can be approximated by bff , having the elements:\n[bff(pur)]m = exp\n(  4\u03c0\n\u03bb u>ur(pr,m \u2212 pr)\n) . (31)"
        },
        {
            "heading": "In addition, the matrix B\u0307(pur) is approximated by",
            "text": "B\u0307ff(pur) = \u2202bff(pur)\n\u2202pur (32)\n=  4\u03c0\n\u03bb\u2016pur\u2016 diag(bff(pur))M > (I \u2212 uuru>ur) , where the matrix M is given by\nM = [pr,0 \u2212 pr,pr,1 \u2212 pr, . . . ,pr,M\u22121 \u2212 pr] , (33)\nand contains the relative positions of the RIS elements with respect to the surface\u2019s center. This implies that the EFIM in (29) consists of two components. The first one is proportional to uuru>ur, and it is scaled by the signal bandwidth (due to the term \u2016d\u0307(\u03c40)\u2016) and the energy reflected by the RIS towards the UE. The second component is proportional to I\u2212uuru>ur, which means that it is in the two-dimensional subspace orthogonal to the first component. Moreover, this second component decreases with the UE distance as 1/\u2016pur\u20162 (without accounting here for any possible dependence of \u03b20 with the distance), and it is independent of the bandwidth. Note that the first component represents the contribution of the estimation of the propagation delay to the EFIM, while the second component corresponds to the contribution of the estimation of the direction of the UE (i.e., the angles of arrival and departure on/from the RIS). We next consider the case where the uur is orthogonal to the RIS normal nr. Note that since M>nr = 0, we have that\nM> ( I\u2212 uuru>ur ) = M> ( I\u2212 uuru>ur \u2212 nrn>r ) . (34)\nTherefore, if u>urnr = 0 holds, the term I \u2212 uuru>ur \u2212 nrn>r becomes a one-dimensional subspace, which yields an illconditioned FIM."
        },
        {
            "heading": "V. LOW-COMPLEXITY LOCALIZATION",
            "text": "In this section, we present a low-complexity localization method for the considered RIS-aided wireless system. The proposed estimator has three steps: i) we first obtain a coarse estimate of the delay \u03c40, then ii) we compute a coarse estimate of the relative UE position pur, and finally iii) we refine our estimation via maximizing the likelihood function."
        },
        {
            "heading": "A. Coarse Estimation of \u03c40",
            "text": "The delay can be estimated by performing the inverse FFT (IFFT) of each vector y\u0303t and non-coherently accumulating the results. Specifically, we calculate the quantity:\nyf , T/2\u2211 t=1 \u2016F y\u0303t\u20162, (35)\nwhere F is the N \u2032 \u00d7N IFFT matrix with elements [F ]r,s = exp (2\u03c0rs/N \u2032) / \u221a N \u2032, where N \u2032 is a design parameter. Next, we estimate the delay as\n\u03c4\u03020 = 1\nN \u2032\u2206f arg max n |[yf ]n|. (36)\nB. Coarse Estimation of pur Once the estimation \u03c4\u03020 is available, we can generate the following sequence:\nz , d(\u03c4\u03020) H [y\u03031, . . . , y\u0303T/2] , (37)\nand formulate the cost function P (p) , |s(p)zH|2/\u2016s(p)\u20162, where s(p) = b(p)> [ \u03c9\u03031, \u03c9\u03032, . . . , \u03c9\u0303T/2 ] .Using this cost function, we can estimate the UE position as p\u0302ur , arg maxp P (p).The evaluation of P (p) is relatively simple since the vectors s(p) can be precomputed on a grid of points, which can be stored at the RIS controller and made available to the UE. Moreover, P (p) does not need to be evaluated in the full three-dimensional (3D) grid of points, but only in a 2D subgrid of points that fulfill c\u03c4\u03020/2\u2212 \u2264 \u2016p\u2016 \u2264 c\u03c4\u03020/2 + , where accounts for the range of errors in \u03c4\u03020 and the density of the position grid."
        },
        {
            "heading": "C. Maximum Likelihood Position Estimation",
            "text": "We use the estimated p\u0302ur in Sec. V-B as a starting point to optimize the maximum likelihood (ML) function via a quasiNewton algorithm. Based on (7), the ML estimator can be written as\np\u0302ur , arg min pur min \u03b20 T/2\u2211 t=1 \u2016\u03b20\u03b6t(pur)\u2212 y\u0303t\u20162 (38)\n= arg min pur T/2\u2211 t=1 \u2016\u03b20(pur)\u03b6t(pur)\u2212 y\u0303t\u20162, (39)\nwhere \u03b6t(pur) , d (2\u2016pur\u2016/c) b(pur)>\u03c9\u0303t, and \u03b20(pur) ,\u2211 t \u03b6t(pur) Hy\u0303t/(\u03b6t(pur) H\u03b6t(pur)). Finally, the UE position can be estimated as p\u0302u = p\u0302ur + pr."
        },
        {
            "heading": "VI. NUMERICAL RESULTS",
            "text": "In this section, we measure the accuracy of the proposed estimation method and calculate the PEBs for an example system whose parameters are listed in Table I, where N and \u2206F are chosen based on the 5G NR numerology. Furthermore, we set N \u2032 = 10N . We assume that the RIS is located at the origin of the coordinate system with elements in the z = 0 plane. The channel gain is calculated as [21, Eq. (3)]\n\u03b20 = \u03bb2 cos(\u03c6)\n16\u03c01.5\u2016pur\u20162 , (40)\nwhere \u03c6 = cos\u22121(u>urnr) indicates the angle between the RIS normal (nr) and pur. The distance between adjacent RIS elements was set to d = \u03bb/4 based on Remark 1.\nIn Fig. 2 (a), we compare the positioning error of the proposed estimation method in Section V with the PEB in (10). The UE is located at [d, d, d]/ \u221a 3 meters, where d \u2208 [1, 50]. We consider the two RIS phase profile designs mentioned in Section III, specifically, the random and directional with \u03b4 = 1 m. For each UE location the results are the average over 100 realizations of RIS phase profiles, for each of which 10 noise realizations were generated to calculate the positioning error. It can be seen that the proposed estimator can attain the theoretical lower bound for up to d = 18 m for the random phase design and d = 29 m for the directional one (with one exception point, which will be discussed later). With higher values of d, we can see from the PEBs that sub-meter UE localization is still possible, however, our low-complexity localization cannot achieve the bounds due to the low SNR.\nIn Fig. 2 (a), for directional profiles, there exists an exception point, which is at d = 11 m, where the estimation error is considerably higher than the PEB. This is due to the existence of one outlier. As mentioned in Section III-C, the directional codebook is generated by directing the beam towards random points inside the uncertainty area. If none of these points are in the close vicinity of the UE, then the received SNR is low and the estimator fails to localize. The probability of this event depends on the uncertainty area and the RIS beamwidth. Nonetheless, for the parameters considered in this paper, we can see that it is low. Figure 2 (b) shows the cumulative distribution function (CDF) for the PEB (solid lines) and estimation errors (dashed lines) for the point at\nd = 11 m. It can be seen that the estimation error follows the PEB closely. Furthermore, it is shown that, due to the aforementioned outlier, the CDF of the estimation error for the directional profiles is saturated close to 1 (at 0.99).\nIn Fig. 2 (c), we illustrate the effects of the RIS size on the PEB at the UE location pu = [10, 10, 10]/ \u221a 3. It can be seen that, for the directional phase profile, the PEB reduces with M faster than for the the random one. This is due to the fact that the SNR grows faster with M when directional beamforming is used. Furthermore, with very low values of M , different beams in directional codebook becomes almost identical (due to the very large beamwidths), which reduces the estimation accuracy. Hence, the directional codebook performs worse than the random one at (very) low values of M .\nIn Fig. 3 (a), we show the PEB for the UE position at [x, y, y], where x \u2208 [\u221220, 20] and y \u2208 [0, 20]. We consider one realization of random RIS phases. It can be seen that the PEB is almost symmetrical with respect to the y axis. Lower PEBs are obtained for lower values of \u03b8, (partly) because of the RIS unit-cell directional pattern, which is incorporated in (40). As demonstrated, submeter localization is possible almost all across the considered area. In Fig. 3 (b), we study the PEB by setting \u03b20 to be the same for all the UE positions. They are set to the \u03b20 calculated at [10, 10, 10]/ \u221a 3. By doing so, we can remove the effects of the SNR on PEB and focus on the geometrical effects. It can be seen that PEB increases with the UE distance and also \u03b8; this behavior was explained in Remark 2.\nVII. CONCLUSION\nWe presented the concept of 3D UE self-localization with only one RIS, where the UE transmits multiple OFDM signals and processes the reflected signal from the RIS. The positioning was performed by i) separating the signal reflected from the RIS from the undesired multipath, ii) establishing a coarse estimate of the position, and iii) refining the estimation via ML. We assessed the performance of the estimator in terms of the positioning error and compared it to an analytical lower bound. Our results provides a novel example where RISs become an enabling technology for radio localization. Note that, if in the proposed scenario, the RIS is replaced by a generic scatterer with a known location, then we could only estimate the distance \u2016pur\u2016 (even in the absence of multipath). This of course would not be enough to find out the location of the UE. Future work includes the investigation of the effects of RIS impairments, NLOS components, and the UE mobility on the proposed system model and estimation approach.\nAcknowledgments: This work was supported, in part, by the Swedish Research Council under grant 2018-03701, the EU H2020 RISE-6G project under grant 101017011, the Spanish Ministry of Science and Innovation PID2020-118984GB-I00 and by the Catalan ICREA Academia Programme."
        }
    ],
    "title": "RIS-Enabled Self-Localization: Leveraging Controllable Reflections With Zero Access Points",
    "year": 2022
}