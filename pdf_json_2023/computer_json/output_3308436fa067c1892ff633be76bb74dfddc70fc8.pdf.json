{
    "abstractText": "Accurate knowledge of the three-dimensional (3D) orientations and 3D locations of the user devices, such as wearable glasses, is of paramount importance in different extended reality (XR) use cases and applications. In this article, we address the corresponding six degrees-of-freedom (6DoF) tracking challenge of 5G-empowered XR devices. We describe a new uplink (UL) carrier phase measurements based estimation approach, allowing for low-latency 3D orientation and 3D location tracking directly at the 5G network base-stations or gNodeBs (gNBs). Extended Kalman filter (EKF) based practical signal processing algorithms are described while also the applicable Cram\u00e9r-Rao lower-bounds (CRLBs) are derived and presented. Also, the related aspect of over-the-air estimation of the XR headset antenna constellation or antenna geometry is addressed. Additionally, the important practical challenges related to user equipment (UE) clock drifting as well as integer ambiguities in carrier phase based methods are both considered. Finally, an extensive set of numerical results is provided in an example indoor factory like environment, covering both 3.5 GHz and 28 GHz network deployments. The obtained results demonstrate the feasibility of continuous 6DoF tracking through the proposed approach, with root mean squared error (RMSE) accuracies below one degree for the 3D orientation and below one centimeter for the 3D location, respectively. The results also demonstrate that UE clock drifting and carrier phase integer ambiguities can both be efficiently estimated and tracked, as part of the overall proposed concept and methods.",
    "authors": [
        {
            "affiliations": [],
            "name": "Jukka Talvitie"
        },
        {
            "affiliations": [],
            "name": "Mikko S\u00e4ily"
        },
        {
            "affiliations": [],
            "name": "Mikko Valkama"
        }
    ],
    "id": "SP:8d4b64276dc2485673528bb6d43664df28bb9332",
    "references": [
        {
            "authors": [
                "E. Dahlman",
                "S. Parkvall"
            ],
            "title": "Skold, 5G NR: The Next Generation Wireless Access Technology, 2nd ed",
            "year": 2020
        },
        {
            "authors": [
                "F. Tang",
                "X. Chen",
                "M. Zhao",
                "N. Kato"
            ],
            "title": "The Roadmap of Communication and Networking in 6G for the Metaverse",
            "venue": "IEEE Wireless Commun., pp. 1\u201315, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "3GPP",
                "TR 26.928 V18.0.0"
            ],
            "title": "Extended Reality (XR) in 5G",
            "venue": "Mar. 2023. [Online]. Available: www.3gpp.org",
            "year": 2023
        },
        {
            "authors": [
                "A. Clemm",
                "M.T. Vega",
                "H.K. Ravuri",
                "T. Wauters",
                "F.D. Turck"
            ],
            "title": "Toward truly immersive holographic-type communication: Challenges and solutions",
            "venue": "IEEE Commun. Mag., vol. 58, no. 1, pp. 93\u201399, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "R. Ju"
            ],
            "title": "Ultra wide view based panoramic VR streaming",
            "venue": "Proc. ACM Workshop Virtual Real. Augmented Real. Netw., 2017, p. 19\u201323.",
            "year": 2017
        },
        {
            "authors": [
                "R. Mendrzik",
                "F. Meyer",
                "G. Bauch",
                "M.Z. Win"
            ],
            "title": "Enabling Situational Awareness in Millimeter Wave Massive MIMO Systems",
            "venue": "IEEE J. Sel. Topics Signal Process., vol. 13, no. 5, pp. 1196\u20131211, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "N. Garcia"
            ],
            "title": "Direct Localization for Massive MIMO",
            "venue": "IEEE Trans. Signal Process., vol. 65, no. 10, pp. 2475\u20132487, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "3GPP",
                "TR 38.855 V16.0.0"
            ],
            "title": "Study on NR positioning support (Release 16)",
            "venue": "March 2019. [Online]. Available: www.3gpp.org",
            "year": 2019
        },
        {
            "authors": [
                "3GPP",
                "TS 22.261 V19.1.0"
            ],
            "title": "Service requirements for the 5G system (Release 19)",
            "venue": "Dec. 2022. [Online]. Available: www.3gpp.org",
            "year": 2022
        },
        {
            "authors": [
                "J. Jang",
                "Y. Jo",
                "M. Shin",
                "J. Paik"
            ],
            "title": "Camera orientation estimation using motion-based vanishing point detection for advanced driver-assistance systems",
            "venue": "IEEE Trans. Intell. Transp. Syst., vol. 22, pp. 6286\u20136296, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "R. Frohlich",
                "L. Tamas",
                "Z. Kato"
            ],
            "title": "Absolute pose estimation of central cameras using planar regions",
            "venue": "IEEE Trans. Pattern Anal. Mach. Intell., vol. 43, no. 2, pp. 377\u2013391, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M. Nazarahari",
                "H. Rouhani"
            ],
            "title": "40 years of sensor fusion for orientation tracking via magnetic and inertial measurement units: Methods, lessons learned, and future challenges",
            "venue": "Information Fusion, vol. 68, pp. 67\u201384, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "J. Wu",
                "Z. Zhou",
                "H. Fourati",
                "Y. Cheng"
            ],
            "title": "A super fast attitude determination algorithm for consumer-level accelerometer and magnetometer",
            "venue": "IEEE Trans. Consum. Electron., vol. 64, no. 3, pp. 375\u2013381, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "W. Zheng",
                "N. Gonz\u00e1lez-Prelcic"
            ],
            "title": "Joint Position, Orientation and Channel Estimation in Hybrid mmWave MIMO Systems",
            "venue": "Proc. Asilomar Conf. Signals, Syst., Computers, 2019, pp. 1453\u20131458.",
            "year": 2019
        },
        {
            "authors": [
                "Z. Abu-Shaban"
            ],
            "title": "Error Bounds for Uplink and Downlink 3D Localization in 5G Millimeter Wave Systems",
            "venue": "IEEE Trans. Wireless Commun., vol. 17, no. 8, pp. 4939\u20134954, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "A. Shahmansoori"
            ],
            "title": "Tracking Position and Orientation Through Millimeter Wave Lens MIMO in 5G Systems",
            "venue": "IEEE Signal Process. Lett., vol. 26, no. 8, pp. 1222\u20131226, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "R. Mendrzik",
                "H. Wymeersch",
                "G. Bauch",
                "Z. Abu-Shaban"
            ],
            "title": "Harnessing NLOS Components for Position and Orientation Estimation in 5G Millimeter Wave MIMO",
            "venue": "IEEE Trans. Wireless Commun., vol. 18, no. 1, pp. 93\u2013107, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "Z. Abu-Shaban",
                "H. Wymeersch",
                "T. Abhayapala",
                "G. Seco-Granados"
            ],
            "title": "Single-Anchor Two-Way Localization Bounds for 5G mmWave Systems",
            "venue": "IEEE Trans. Veh. Technol., vol. 69, no. 6, pp. 6388\u20136400, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "J. Talvitie"
            ],
            "title": "High-Accuracy Joint Position and Orientation Estimation in Sparse 5G mmWave Channel",
            "venue": "Proc. IEEE ICC, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "J. Talvitie",
                "M. Valkama",
                "G. Destino",
                "H. Wymeersch"
            ],
            "title": "Novel Algorithms for High-Accuracy Joint Position and Orientation Estimation in 5G mmWave Systems",
            "venue": "Proc. IEEE Globecom Workshops, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "A. Shahmansoori",
                "G.E. Garcia",
                "G. Destino",
                "G. Seco-Granados",
                "H. Wymeersch"
            ],
            "title": "Position and Orientation Estimation Through Millimeter- Wave MIMO in 5G Systems",
            "venue": "IEEE Trans. Wireless Commun., vol. 17, no. 3, pp. 1822\u20131835, 2018.",
            "year": 1822
        },
        {
            "authors": [
                "M. Kok",
                "T.B. Sch\u00f6n"
            ],
            "title": "A Fast and Robust Algorithm for Orientation Estimation Using Inertial Sensors",
            "venue": "IEEE Signal Process. Lett., vol. 26, no. 11, pp. 1673\u20131677, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "W. Ding",
                "W. Sun",
                "Y. Gao",
                "J. Wu"
            ],
            "title": "Carrier Phase-Based Precise Heading and Pitch Estimation Using a Low-Cost GNSS Receiver",
            "venue": "Remote Sensing, vol. 13, no. 18, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "3GPP",
                "TR 38.859 V18.0.0"
            ],
            "title": "Study on expanded and improved NR positioning (Release 18)",
            "venue": "Dec. 2022. [Online]. Available: www.3gpp.org",
            "year": 2022
        },
        {
            "authors": [
                "M. S\u00e4ily"
            ],
            "title": "Positioning Technology Trends and Solutions Toward 6G",
            "venue": "Proc. IEEE PIMRC, 2021, pp. 1\u20137.",
            "year": 2021
        },
        {
            "authors": [
                "3GPP",
                "RP-223549"
            ],
            "title": "Expanded and Improved NR Positioning Work Item Description (Release 18)",
            "venue": "Dec. 2022. [Online]. Available: www.3gpp.org",
            "year": 2022
        },
        {
            "authors": [
                "O.L.A. L\u00f3pez",
                "D. Kumar",
                "A. T\u00f6lli"
            ],
            "title": "Polarization Diversity-enabled LOS/NLOS Identification via Carrier Phase Measurements",
            "venue": "IEEE Trans. Commun., pp. 1\u20131, 2023.",
            "year": 2023
        },
        {
            "authors": [
                "L. Chen"
            ],
            "title": "Carrier Phase Ranging for Indoor Positioning With 5G NR Signals",
            "venue": "IEEE Internet Things J., vol. 9, pp. 10 908\u201310 919, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "S. Fan"
            ],
            "title": "Carrier Phase-Based Synchronization and High-Accuracy Positioning in 5G New Radio Cellular Networks",
            "venue": "IEEE Trans. Commun., vol. 70, no. 1, pp. 564\u2013577, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "3GPP",
                "TR 38.901 V17.0.0"
            ],
            "title": "Study on channel model for frequency spectrum from 0.5 to 100 GHz (Release 17)",
            "venue": "Mar. 2022. [Online]. Available: www.3gpp.org",
            "year": 2022
        },
        {
            "authors": [
                "A. Kim",
                "M. Golnaraghi"
            ],
            "title": "A quaternion-based orientation estimation algorithm using an inertial measurement unit",
            "venue": "Proc. IEEE PLANS, 2004, pp. 268\u2013272.",
            "year": 2004
        },
        {
            "authors": [
                "S.M. Kay"
            ],
            "title": "Fundamentals of Statistical Signal Processing, Volume I: Estimation Theory, 1st ed",
            "year": 1993
        },
        {
            "authors": [
                "P. Tichavsky",
                "C. Muravchik",
                "A. Nehorai"
            ],
            "title": "Posterior Cramer-Rao bounds for discrete-time nonlinear filtering",
            "venue": "IEEE Trans. Signal Process., vol. 46, no. 5, pp. 1386\u20131396, 1998.",
            "year": 1998
        },
        {
            "authors": [
                "T.K.Y. Bar-Shalom",
                "X. Rong Li"
            ],
            "title": "Estimation with Applications to Tracking and Navigation: Theory, Algorithms and Software",
            "venue": "Wiley Interscience,",
            "year": 2001
        },
        {
            "authors": [
                "S. S\u00e4rkk\u00e4"
            ],
            "title": "Bayesian Filtering and Smoothing, ser. Institute of Mathematical Statistics Textbooks",
            "year": 2013
        },
        {
            "authors": [
                "E. Bastug",
                "M. Bennis",
                "M. Medard",
                "M. Debbah"
            ],
            "title": "Toward interconnected virtual reality: Opportunities, challenges, and enablers",
            "venue": "IEEE Commun. Mag., vol. 55, no. 6, pp. 110\u2013117, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "M. Koivisto"
            ],
            "title": "Joint device positioning and clock synchronization in 5G ultra-dense networks",
            "venue": "IEEE Trans. Wireless Commun., vol. 16, no. 5, pp. 2866\u20132881, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "H. Kim",
                "X. Ma",
                "B.R. Hamilton"
            ],
            "title": "Tracking low-precision clocks with time-varying drifts using Kalman filtering",
            "venue": "IEEE/ACM Trans. Netw., vol. 20, no. 1, pp. 257\u2013270, 2012.",
            "year": 2012
        },
        {
            "authors": [
                "D.B. Cox Jr.",
                "J.D.W. Brading"
            ],
            "title": "Integration of LAMBDA ambiguity resolution with Kalman filter for relative navigation of spacecraft",
            "venue": "NAVIGATION, vol. 47, no. 3, pp. 205\u2013210, 2000.",
            "year": 2000
        },
        {
            "authors": [
                "J. Khalife",
                "Z.M. Kassas"
            ],
            "title": "Differential framework for submeteraccurate vehicular navigation with cellular signals",
            "venue": "IEEE Trans. Intell. Veh., vol. 8, no. 1, pp. 732\u2013744, 2023.",
            "year": 2023
        },
        {
            "authors": [
                "P. Teunissen"
            ],
            "title": "The least-squares ambiguity decorrelation adjustment: A method for fast GPS integer ambiguity estimation",
            "venue": "Journal of Geodesy, vol. 70, pp. 65\u201382, Nov. 1995.",
            "year": 1995
        },
        {
            "authors": [
                "K. Berntorp",
                "A. Weiss",
                "S.D. Cairano"
            ],
            "title": "Integer ambiguity resolution by mixture Kalman filter for improved GNSS precision",
            "venue": "IEEE Trans. Aerosp. Electron. Syst., vol. 56, no. 4, pp. 3170\u20133181, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "T. Bailey",
                "J. Nieto",
                "J. Guivant",
                "M. Stevens",
                "E. Nebot"
            ],
            "title": "Consistency of the EKF-SLAM Algorithm",
            "venue": "Proc. 2006 IEEE/RSJ Int. Conf. Intelligent Robots and Systems, 2006, pp. 3562\u20133568.",
            "year": 2006
        },
        {
            "authors": [
                "Z. Hu",
                "A. Bulling",
                "S. Li",
                "G. Wang"
            ],
            "title": "EHTask: Recognizing user tasks from eye and head movements in immersive virtual reality",
            "venue": "IEEE Trans. Vis. Comput. Graphics, vol. 29, no. 4, pp. 1992\u20132004, 2023. This article has been accepted for publication in IEEE Journal of Selected Topics in Signal Processing. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JSTSP.2023.3309463 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/",
            "year": 1992
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u20143D orientation estimation, 3D positioning, 5G NR, 6G, Bayesian filtering, carrier phase, clock drifting, extended reality, integer ambiguity, six degrees-of-freedom, tracking.\nI. INTRODUCTION\nMOBILE communication networks, most notably the fifthgeneration (5G) New Radio (NR) standardized by the 3rd Generation Partnership Project (3GPP), offer improved bit rates and largely reduced latencies compared to earlier cellular systems [1], [2]. Extended reality (XR) is one of the timely new use cases of 5G and 5G-Advanced, paving the way eventually towards the future metaverse in the sixth generation (6G) era [3]. XR is generally an umbrella term, covering different variants of augmented reality (AR), virtual reality (VR), and mixed reality (MR), with wide variety of consumer-scale and industrial applications.\nThe requirements and technical aspects of XR service characteristics in 5G NR are generally well defined and summarized in [4]. One of the distinct features is the requirement for continuous and highly accurate XR device orientation and location estimation, commonly referred to as six degrees-of-freedom (6DoF) tracking [5], [6]. Depending on the more specific XR application, such 6DoF pose information \u2013 illustrated conceptually in Fig. 1 \u2013 is needed at the network side even at millisecond-level update intervals while the accuracy\nThis work was supported by Academy of Finland and Nokia Bell Labs. J. Talvitie and M. Valkama are with Tampere University, Finland. M. Sa\u0308ily is with Nokia Standards, Espoo, Finland.\nrequirements can be in the order of centimeters [4], [5], [7]. While user equipment (UE) positioning \u2013 and more broadly radio-based situational awareness [8], [9] \u2013 are generally inherent features of 5G and 5G-Advanced, the accuracy of the existing uplink (UL) or downlink (DL) based methods is far below the XR requirements, especially when it comes to the 3D orientation estimation of the XR device [10], [11]. Terminology-wise, we use the terms UE and XR device interchangeably in the rest of this article, as the XR device operates as a UE from the cellular network perspective.\nUE orientation estimation is conventionally performed at the UE side by using antenna array measurements, camera-based methods [12], [13] or inertial sensors such as accelerometers, gyros and magnetometers [14], [15] When using antenna arrays, the orientation can be estimated directly as part of the channel parameter estimation, where the orientation is specifically linked to the angle-of-arrival (AoA) observations or measurements. Such methods have been developed and described, e.g, in [16]\u2013[23]. However, in order to reach high orientation estimation accuracy, large array sizes are commonly required, which increases implementation cost and potentially introduces also additional reference signal overheads and increased latency. Furthermore, and very importantly, most of the existing angle-based methods build on UE side processing and DL measurements, hence, the orientation information has to be separately communicated from the XR device to the network via applicable messages. Such signaling or message protocols are always subject to latency while also consuming the UL bandwidth.\nIn general, inertial measurement sensors are able to provide accurate UE orientation estimation locally, see for example [14], [24] and the references therein. This applies, however, only under appropriate calibration conditions. For example, accelerometers are able to measure orientation displacement over time, but when time evolves, also the errors accumulate larger and larger [14]. Furthermore, fusing camera-based or\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n2 other optical data with inertial measurement unit (IMU) data can facilitate the orientation tracking but in case of, e.g., new environments, variable lightning condition and/or UE mobility, the camera- and IMU-based orientation tracking may cause loss of absolute orientation information, thus making the XR content rendering challenging. Use of local sensors is generally a valid approach, but in this paper we deliberately pursue pure cellular radio based 6DoF tracking solutions.\nTo this end, in this article, we focus on the 6DoF XR device tracking through cellular carrier phase measurements. However, the proposed methods can be applied also in the context of other applications calling for 6DoF tracking. While carrier phase based methods are conceptually known and broadly utilized in global navigation satellite system (GNSS) system context, see for example [25] and the references therein, they are currently also considered in 3GPP standardization for enhanced positioning capabilities in 5G-Advanced evolution [26]\u2013[28]. Compared to the existing state-of-the-art in cellular orientation estimation, we show that the proposed carrier phased -based approach enables accurate orientation estimation with small numbers of antennas \u2013 as an extreme example, even a single antenna element can be exploited during orientation tracking. Additionally, and importantly, the UE orientation estimation can be performed based on UL signals, which enables real-time UE orientation estimation also at the gNodeB (gNB) or the network transmission and reception point (TRP) side. Hence, the proposed approach enables an effective over-the-air (OTA) inertial sensor like functionality, with minimum latency, while avoiding the error accumulation problems of local IMUs and offering support for full 6DoF tracking.\nFor clarity, it is noted that the utilization of 5G/cellular carrier phase measurements has been addressed in the recent literature, e.g., in [29]\u2013[31]. In [29], carrier phase measurements are utilized for line-of-sight (LoS)/non-line-of-sight (NLoS) identification in complex propagation environments. Actual carrier phase -based ranging and indoor positioning are addressed in [30] where the time-of-arrival (ToA) estimates obtained using already standardized DL reference signals are further enhanced through carrier phase -based processing. The work in [31], in turn, focuses on improved UE clock synchronization through carrier phase measurements, and thereon for improved localization accuracy through time-based positioning methods. However, none of these works consider the important 6DoF challenge and the related 3D orientation estimation \u2013 the main technical problem addressed in this article.\nIn relation to the existing literature, the contributions and novelty of this article can be stated and summarized as follows:\n\u2022 We describe a new carrier phase ranging based 6DoF tracking concept for continuous estimation of XR device 3D orientation and 3D location in 5G and beyond cellular systems; \u2022 We provide applicable Crame\u0301r-Rao lower-bounds (CRLBs), and assess how the carrier phase based measurement accuracy impacts the 6DoF estimation performance; \u2022 We formulate extended Kalman filter (EKF) based state models and tracking algorithms for practical signal processing implementations;\nThe rest of this article is organized as follows: Section II describes the assumed system model in terms of the 6DoF geometry, XR device and network TRP antenna systems as well as the carrier phase measurement model. Section III provides the proposed 6DoF tracking methods while also addressing the performance bounds in the form of CRLBs. Also applicable UL-based and DL-based variants of the proposed scheme are discussed. In Section IV, important extensions to UE clock drifting and integer ambiguity tracking are provided. A large collection of numerical results is provided in Section V, while the conclusions are drawn in Section VI. Finally, selected mathematical details are provided in the Appendix.\nNotations: Vectors are denoted by bold lowercase letters (i.e., a), bold uppercase letters are used for matrices (i.e., A) and scalars are denoted by normal font (i.e., a). The operators (\u00b7)T , Ex{\u00b7}, and \u2225 \u00b7 \u2225 denote the transpose, expectation with respect to random variable x, and Euclidian norm, respectively."
        },
        {
            "heading": "II. SYSTEM MODEL",
            "text": "In this work, we consider standalone wearable XR devices with built-in 5G NR modem and computing capabilities, such as the device types XR5G-A4 or XR5G-A5 defined in [4]. Specifically, we consider the 6DoF scenario including the estimation of the 3D position and 3D orientation of the XR device, with the basic system geometry being illustrated in Fig. 2. Our emphasis is on the utilization of 5G NR carrier phase-based ranging measurements that can be obtained from physical signals as described, e.g., in [30], [31]. Hence, our emphasis in this article is on the concepts and signal processing on top of the raw carrier phase measurements \u2013 instead of\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n3 individual ranging algorithms. For clarity, it is noted that the basic system model considered in this section excludes UE clock drifting and carrier phase integer ambiguity challenges. However, these are addressed explicitly in Section IV.\nTo this end, the estimated unknown 6DoF state vector s\u0303 is defined as s\u0303 = [ \u03b8T pTUE ]T , (1)\nwhere \u03b8 = [\u03b1, \u03b2, \u03b3]T describes the 3D UE orientation given in rotations \u03b1, \u03b2 and \u03b3, which refer to yaw, pitch (zero at horizon) and roll of the device, respectively. Furthermore, pUE = [xUE, yUE, zUE]\nT is the UE position, defined as the center point of rotation, where xUE, yUE, zUE are the xcoordinate, y-coordinate and z-coordinate of the UE, respectively. Furthermore, for presentation simplicity, we consider a system with a single UE (i.e., the XR device) and M active TRPs located at pTRP,m for m = 0, . . . ,M \u2212 1. The UE is equipped with N antennas with distinct transmit and receive RF chains. In this article, to support a straightforward generalization of the provided system model on scenarios with multiple gNBs and arbitrary antenna configurations, the TRP is defined as a single antenna element. Therefore, it is possible to consider arbitrary-shaped antenna arrays at the gNB side by simply deploying nearby TRPs according to the desired antenna array structure, and similarly, to define different gNB transceivers by deploying TRPs far away from each other. In practice, the TRP can also be implemented, e.g., as a phased antenna array as long as there is an unambiguous reference position or reference point for determining the range estimate.\nBy utilizing antenna-level carrier phase measurements, the range rn,m between the nth UE antenna and the mth TRP, can in general be measured either at the TRP based on UL signals, or at the UE based on DL signals. Considering M TRPs and N UE antennas, the measurement model for the carrier phase -based range measurements is defined as\ny = h(s\u0303) + n, (2)\nwhere h : R6 \u2192 RMN is the measurement function, n \u2208 RMN is measurement noise, which determines the ranging error as n \u223c N (0,\u03a3), and \u03a3 \u2208 RMN\u00d7MN is the measurement covariance matrix. Moreover, the measurement function can be further divided into TRP-wise models as\nh(s\u0303) = [ h0(s\u0303) T h1(s\u0303) T \u00b7 \u00b7 \u00b7 hM\u22121(s\u0303)T ]T , (3)\nwhere the measurement function of the mth TRP hm(s\u0303) : R6 \u2192 RN is given as\nhm(s\u0303) = [ h0,m h1,m \u00b7 \u00b7 \u00b7 hN\u22121,m ]T . (4)\nFinally, the measurement function, describing the range rn,m between the mth TRP and nth antenna element of the UE/XR device can be written as\nhn,m(s\u0303) = rn,m = \u2225pUE +R(\u03b8)\u03c1n \u2212 pTRP,m\u2225, (5)\nwhere R(\u03b8) \u2208 R3\u00d73 is the 3D rotation matrix, which applies the rotation determined by the UE orientation \u03b8. The rotation matrix is defined according to 5G NR specifications in [32], and is also provided in the Appendix for presentation completeness and readers\u2019 convenience. Furthermore, \u03c1n \u2208 R3, with n =\n0, . . . , N\u22121, is the position of the nth antenna element relative to pUE (UE local coordinates) without rotation (i.e., \u03b1 = \u03b2 = \u03b3 = 0). An alternative method for representing orientations is to employ quaternions [33], which in specific use cases are able to introduce potential advantage, such as improved numerical stability. However, we follow the approach determined by the 3GPP [32], and therefore utilize the rotation matrix -based representation for the orientation in this work. Terminologywise, we call the set \u03c1n, n = 0, 1, . . . , N \u2212 1, the XR device antenna constellation in the following.\nIn Fig. 2, the considered system geometry is illustrated for a scenario with a single TRP and a single UE equipped with three antennas. The reference coordinate frame is defined by the TRP as (x, y, z), which determines the positions of the UE antennas \u03c1n with zero rotation. By applying specific rotation R(\u03b8), the UE orientation can be altered, resulting in a new UE coordinate frame of (x\u2032, y\u2032, z\u2032). The UE orientation is defined based on yaw \u03b1, pitch \u03b2 and roll \u03b3 , which describe rotations of z-axis, y-axis and x-axis in respective order. By measuring the ranges rn,m, as shown conceptually in Fig. 2, the UE 3D orientation and 3D position can be estimated and tracked through the proposed methods, described next in Section III."
        },
        {
            "heading": "III. PROPOSED METHODS AND BOUNDS",
            "text": "In this section, we describe the actual 6DoF estimation and tracking methods, while also provide the corresponding performance bounds in the form of CRLBs. Also selected UL-based and DL-based variants of the proposed scheme are discussed.\nA. 6DoF Performance Bounds\nIn order to analyze the performance of carrier phase -based 3D UE orientation and 3D position estimation at a theoretical level, we derive the CRLB, which provides a theoretical lowerbound for the covariance matrix of an unbiased estimator \u02c6\u0303s, expressed formally as [34]\nCRLB(s\u0303) = J\u22121(s\u0303) \u2264 E{(\u02c6\u0303s\u2212 s\u0303)(\u02c6\u0303s\u2212 s\u0303)T }, (6)\nwhere J(s\u0303) \u2208 R6\u00d76 is the Fisher Information Matrix (FIM). The FIM element at the ith row and jth column is defined as\n[J(s\u0303)]i,j = \u2212Es\u0303 { \u22022\u2113(y|s\u0303) \u2202s\u0303i\u2202s\u0303j } , (7)\nwhere \u2113(y|s\u0303) is the log-likelihood function of the measurements given the estimated state vector s\u0303, s\u0303i denotes the ith element of the state vector s\u0303, while the state vector s\u0303 is defined in (1).\nConsidering the Gaussian measurement model defined in (2), the FIM can be conveniently obtained as [34]\nJ(s\u0303) = H\u0303(s\u0303)T\u03a3\u22121H\u0303(s\u0303), (8)\nwhere H\u0303(s\u0303) \u2208 RMN\u00d76 is the Jacobian matrix of the measurement function, defined with respect to the state vector s\u0303. Furthermore, the Jacobian matrix is constructed from two sub-matrices as\nH\u0303(s\u0303) = [ H\u03b8(\u03b8) Hp(pUE) ] (9)\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n4 where H\u03b8(\u03b8) \u2208 RMN\u00d73 relates to the UE orientation state and Hp(pUE) \u2208 RMN\u00d73 relates to the UE position state. The Jacobian matrix related to the UE orientation state is given as\nH\u03b8 =  \u2202h0,0 \u2202\u03b1\n\u2202h0,0 \u2202\u03b2 \u2202h0,0 \u2202\u03b3... ... ...\n\u2202hN\u22121,0 \u2202\u03b1\n\u2202hN\u22121,0 \u2202\u03b2\n\u2202hN\u22121,0 \u2202\u03b3\n\u2202h0,1 \u2202\u03b1\n\u2202h0,1 \u2202\u03b2 \u2202h0,1 \u2202\u03b3... ... ...\n\u2202hN\u22121,M\u22121 \u2202\u03b1 \u2202hN\u22121,M\u22121 \u2202\u03b2 \u2202hN\u22121,M\u22121 \u2202\u03b3\n , (10)\nwhere the partial derivatives, derived based on the fundamental system geometry and measurement function in (5), read as\n\u2202hn,m \u2202\u03b1\n= (pUE +R(\u03b8)\u03c1n \u2212 pTRP,m)TR\u03b1(\u03b8)\u03c1n\n\u2225pUE +R(\u03b8)\u03c1n \u2212 pTRP,m\u2225 \u2202hn,m \u2202\u03b2 = (pUE +R(\u03b8)\u03c1n \u2212 pTRP,m)TR\u03b2(\u03b8)\u03c1n\n\u2225pUE +R(\u03b8)\u03c1n \u2212 pTRP,m\u2225 \u2202hn,m \u2202\u03b3 = (pUE +R(\u03b8)\u03c1n \u2212 pTRP,m)TR\u03b3(\u03b8)\u03c1n \u2225pUE +R(\u03b8)\u03c1n \u2212 pTRP,m\u2225 .\n(11)\nThe matrices R\u03b1(\u03b8), R\u03b2(\u03b8), R\u03b3(\u03b8) \u2208 R3\u00d73 represent the partial derivatives of the rotation matrix R(\u03b8) with respect to \u03b1, \u03b2 and \u03b3 in respective order, expressed formally as\nR\u03b1(\u03b8)= \u2202R(\u03b8)\n\u2202\u03b1 , R\u03b2(\u03b8)=\n\u2202R(\u03b8)\n\u2202\u03b2 , R\u03b3(\u03b8)=\n\u2202R(\u03b8)\n\u2202\u03b3 , (12)\nwhose detailed descriptions are provided for readers\u2019 convenience in the Appendix. The corresponding Jacobian matrix related to the UE position state can, in turn, be given as\nHp = [ \u2202h0,0 \u2202pUE \u00b7 \u00b7 \u00b7 \u2202hN\u22121,0\u2202pUE \u2202h0,1 \u2202pUE \u00b7 \u00b7 \u00b7 \u2202hN\u22121,M\u22121\u2202pUE ]T . (13)\nMoreover, based on the considered measurement function in (5), the partial derivatives can be expressed as\n\u2202hn,m \u2202pUE = pUE +R(\u03b8)\u03c1n \u2212 pTRP,m \u2225pUE +R(\u03b8)\u03c1n \u2212 pTRP,m\u2225 . (14)\nAt last, utilizing (6) and (8), the CRLBs for the unknown 6DoF state parameters can be stated as follows:\nCRLB(\u03b1\u0302) = J\u22121(s\u0303)[1,1], CRLB(x\u0302UE) = J\u22121(s\u0303)[4,4] CRLB(\u03b2\u0302) = J\u22121(s\u0303)[2,2], CRLB(y\u0302UE) = J\u22121(s\u0303)[5,5] (15) CRLB(\u03b3\u0302) = J\u22121(s\u0303)[3,3], CRLB(z\u0302UE) = J\u22121(s\u0303)[6,6].\nThe above CRLBs can be further exploited for obtaining the orientation error bound (OEB) and positioning error bound (PEB) [17] as\nOEB = \u221a J\u22121(s\u0303)[1,1] + J\u22121(s\u0303)[2,2] + J\u22121(s\u0303)[3,3] (16)\nPEB = \u221a J\u22121(s\u0303)[4,4] + J\u22121(s\u0303)[5,5] + J\u22121(s\u0303)[6,6], (17)\nwhere the OEB represents the lower bound for the root mean squared error (RMSE) of the 3D orientation estimation, and PEB represents the lower bound for the 3D positioning RMSE.\nFurthermore, when there is a-priori information on the estimated parameters, or the parameters are estimated recursively in time so that the preceding estimates provide information on\nthe current estimate, the FIM can be (re-)expressed with two additive components as [35]\nJpost(s) = Jprior(s) + Jmeas(s). (18)\nIn (18), the state vector notation is deliberately changed to s to allow for including also rate-of-change parameters in the state definition \u2013 as shown concretely in (22). Additionally, Jpost(s) is the FIM of the a-posteriori estimate, Jprior(s) is the FIM of the a-priori estimate, and Jmeas(s) is the FIM obtained from the measurements, calculated conceptually similar to (8). The prior information of the state is determined as\n[Jprior(s)]i,j = \u2212Es { \u22022 logP(s) \u2202si\u2202sj } , (19)\nwhere P(s) denotes the prior probability distribution of state s. Considering a system with dynamic parameters, which are estimated and tracked recursively over time steps k, the aposteriori FIM can be re-expressed as\nJpost[k] = Jprior[k] + Jmeas[k], (20)\nwherein for presentation convenience, we have omitted the state vector from the FIM notations while emphasizing time k. Furthermore, the a-priori FIM is defined as\nJprior[k] = FJ \u22121 post[k \u2212 1]FT +Q[k], (21)\nwhere F describes the state-transition matrix, and Q[k] is the process covariance, which are both defined and further described along the upcoming EKF formulations in Section III-B, specifically Equations (25) and (26). Furthermore, numerical results of the stated bounds are provided in Section V.\nB. 6DoF Tracking Through Extended Kalman Filtering\nIn the following, we next formulate an efficient EKFbased approach for estimating and tracking the desired 6DoF parameters of an XR device in a time-varying mobile scenario. To this end, we first extend and redefine the static state vector, given in (1), to support the desired mobility, and define the time-varying state vector at the kth time step as\ns[k] = [ \u03b8[k]T \u2206\u03b8[k]T pUE[k] T vUE[k] T ]T \u2208 R12 (22)\nwhere \u03b8[k] = [\u03b1[k], \u03b2[k], \u03b3[k]]T is the 3D UE orientation, and \u2206\u03b8[k] = [\u2206\u03b1[k],\u2206\u03b2[k],\u2206\u03b3[k]]T is the rotational rate-of-change, including distinct rates-of-change of rotation angles \u03b1, \u03b2 and \u03b3, respectively. In addition, pUE[k] = [xUE[k], yUE[k], zUE[k]]\nT denotes the 3D UE position, and vUE[k] = [vx[k], vy[k], vz[k]]\nT is the 3D UE velocity, defined relative to the x-axis, y-axis and z-axis, respectively.\nFor the proposed EKF formulation, we assume that the UE velocity, as well as the rate-of-change of the UE rotation, are almost constant over a small time period. Consequently, we utilize a linear constant white-noise acceleration (CWNA) state-transition model [36], and accordingly define the statespace model, consisting of the state-transition model and measurement model as\ns[k] = Fs[k \u2212 1] +w[k] (23) y[k] = h(s\u030c[k]) + n[k], (24)\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n5 where F \u2208 R12\u00d712 is the state-transition matrix, and w[k] \u223c N (0,Q[k]) \u2208 R12 is the driving noise of the state-transition model. Furthermore, the state-transition matrix is expressed as\nF = [ F\u0304\u2297 I3 06\u00d76 06\u00d76 F\u0304\u2297 I3 ] , where F\u0304 = [ 1 \u2206t 0 1 ] , (25)\nand \u2206t is the time duration between two consecutive time steps. According to CWNA state-transition model [36], the process covariance matrix can be given as\nQ[k]=\n[ \u03c32\u2206\u03b8Q\u0304[k]\u2297I3 06\u00d76\n06\u00d76 \u03c3 2 v Q\u0304[k]\u2297I3\n] \u2208 R12\u00d712, where (26)\nQ\u0304[k] =\n[ \u2206t3\n3 \u2206t2\n2 \u2206t2\n2 \u2206t\n] . (27)\nThe magnitude of process covariance can be scaled with \u03c32\u2206\u03b8 and \u03c32v , which describe the power spectral density of angular acceleration of each rotation angle (\u03b1, \u03b2 and \u03b3), and the power spectral density of UE acceleration with respect to each component axis (xUE, yUE, zUE), respectively. The measurement model in (24) follows the formulation provided in (2). Accordingly, y[k] \u2208 RMN denotes the measurement vector, which is build on the measurement function h : R6 \u2192 RMN , defined in (3), and on the measurement noise n[k] \u223c N (0,\u03a3[k]). For the measurement function input, parameters of velocity and rotational rate-of-change are omitted from the EKF state vector so that s\u030c[k] = [ \u03b8[k]T , pUE[k] T ]T \u2208 R6.\nGiven the state-space model in (23) and (24), the EKFbased estimation and tracking proceeds through iterations of a prediction step and an update step. First, at time index k, the prediction step of the EKF is expressed as\ns\u0302\u2212[k] = Fs\u0302+[k \u2212 1]\nP\u0302 \u2212 [k] = FP\u0302 + [k \u2212 1]FT +Q[k]\n(28)\nwhere s\u0302\u2212[k] \u2208 R12 and P\u0302 \u2212 [k] \u2208 R12\u00d712 are the a-priori estimates of the mean and covariance of the state s[k], respectively. After this, the a-posteriori estimates of the mean and the covariance, denoted as s\u0302+[k] \u2208 R12 and P\u0302+[k] \u2208 R12\u00d712, respectively, can be obtained by the update step of the EKF as\ns\u0302+[k] = s\u0302\u2212[k] +K[k](y\u0302[k]\u2212 h(\u02c6\u030cs\u2212[k])) P\u0302+[k] = (I12 \u2212K[k]H[k])P\u0302\u2212[k],\n(29)\nwhere the Kalman gain K[k] \u2208 R12\u00d7MN is defined as\nK[k] = P\u0302\u2212[k]H[k]T (H[k]P\u0302\u2212[k]H[k]T +\u03a3[k])\u22121. (30)\nIn addition, y\u0302[k] denotes the obtained measurements at time index k, and \u02c6\u030cs\u2212[k] is the estimated a-priori state vector without the velocity and rotational rate-of-change parameters, as given in (24). Furthermore, H[k] \u2208 RMN\u00d712 is the Jacobian matrix for attaining the linear approximation of the non-linear measurement function. For the considered EKF formulation, the Jacobian matrix can written as\nH[k] = [ H\u03b8[k] 0NM\u00d73 Hp[k] 0NM\u00d73 ] , (31)\nwhere H\u03b8[k] and Hp[k] are evaluated at the a-priori mean estimate s\u0302\u2212[k] as derived and expressed in (10) and (13), respectively.\nFinally, it is noted and highlighted that the considered nonlinear filtering problem could be solved through other alternative methods, such as the unscented Kalman filter (UKF) or the cubature Kalman filter (CKF), that also build on Gaussian density approximations. However, since the underlying models are differentiable and because the EKF is shown through the numerical results to essentially reach the respective posterior bounds, EKF is a well-argued nonlinear filtering approach and thus adopted in this article. In general, the main advantage of extended Kalman filter over alternative nonlinear filtering solutions, such as the UKF or the particle filter, is its relatively low computational complexity compared to its filtering performance [37]. We have also verified through concrete numerical evaluations that UKF and CKF yield essentially the same performance as the EKF-based solutions."
        },
        {
            "heading": "C. Uplink vs. Downlink Aspects",
            "text": "In general, the proposed methods can be utilized for either DL-based or UL-based measurements, depending primarily on which reference signals are available and utilized for carrier phase ranging. Furthermore, depending on the more specific approach, there is need to report certain parameters or measurements between the TRPs and the UE. This directly affects the estimation latency and the amount of the sideinformation signaling, and the used approach for a given XR application should be eventually selected based on the underlying performance requirements defined in [4].\nIn the UL-based approach, a feasible physical estimation resource is the uplink sounding reference signal (SRS) [1], [10] and hence the TRPs can obtain the ranging estimates through the corresponding carrier phase measurements. If the actual 6DoF UE tracking is then also pursued at the network, information about the UE antenna constellation needs to be communicated as side-information \u2013 or alternatively, estimated over-the-air as described in Section III-D. As a further alternative, the ranging measurements can be communicated from the network towards the UE, together with the TRP locations, after which UE can execute the 6DoF tracking.\nIn the DL-based approach, in turn, the most feasible estimation resource is the downlink positioning reference signal (PRS) [1], [10] with which the UE can calculate the antenna-level range estimates through the carrier phase measurements. If the 6DoF tracking is then also pursued at the UE, side-information about the TRP locations is needed through DL signaling. As an alternative, the DL PRS based ranging measurements can be communicated towards the network, together with the UE antenna constellation information, which then allow the 6DoF tracking to run at the network.\nOverall, given the strict latency requirements for photorealistic rendering in different XR use cases [4], [7], the ULbased approach with UE antenna configuration or constellation signaling allows for lowest latency. Such an approach can be seen as an effective over-the-air inertial sensor like functionality with support for full 6DoF tracking without error accumulation problems commonly observed with, e.g., IMUs [14]. Finally, it is noted that the provided EKF formulation provides also information about the prevailing rate-of-change of the XR device orientation, due to the adopted state variable formulation\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n6 in (22). When such information is available in the network, with minimum latency through the UL-based approach, viewpoint prediction, proactive rending and other similar schemes discussed, e.g., in [38], become basically technically feasible.\nWhile the baseline approach for acquiring the headset antenna configuration or constellation at the network is through uplink feedback signaling, we next describe a novel OTA measurement and estimation approach for obtaining such knowledge directly from the uplink radio signals."
        },
        {
            "heading": "D. Extension to Over-the-Air Estimation or Calibration of",
            "text": "Headset Antenna Constellation\nThe 6DoF tracking through EKF, presented in Section III-B, assumes a known headset antenna constellation. That is, the position of each antenna element, \u03c1n, with respect to the UE position with zero-rotation were assumed to be known during the tracking process. However, in certain practical scenarios, such information on the antenna constellation might be unavailable, or the information is not desired to be shared with the entity performing the 6DoF tracking. In such cases, it is possible to extend the proposed EKF to enable over-the-air estimation of the antenna constellation.\nConsidering that the headset antenna constellation, described by the relative antenna element positions \u03c1n, is not known, it is unfeasible to jointly estimate and track the antenna constellation, the device position pUE and device orientation \u03b8 \u2013 all simultaneously. As defined in the measurement function in (5), the element positions \u03c1n are determined with respect to the device position (center point-of-rotation) and zero-orientation, which results in implicit relation between the unknown antenna constellation and the unknown device position and orientation. Nonetheless, although the absolute joint estimates of the above parameters are out of reach, it is possible to estimate and track the constellation so that the antenna elements are positioned with respect to each other, revealing the fundamental geometric structure of the antenna constellation. The estimated antenna constellation is then connected to the true constellation through specific rotation and position offset.\nFor the proposed over-the-air calibration of the XR headset antenna constellation, we consider four separate approaches:\n1) Unknown Movement and Rotation. In the first approach, the XR device is moving and rotating in the area without any prior knowledge of the device positions or orientations. Consequently, the EKF state vector is given as [\u03b8\u030c[k]T , \u2206\u03b8[k]T , p\u030cUE[k] T , vUE[k]T , \u03c1\u030c0[k] T , . . . ,\n\u03c1\u030cN\u22121[k]] T \u2208 R12+3N , where the \u03b8\u030c[k], p\u030cUE[k] and \u03c1\u030cn[k] are the position and orientation of the UE/XR device, and the relative position of the nth antenna element, respectively. These state values are connected to the corresponding true values through a specific rotation and position offset. 2) Unknown Rotation at a Fixed Known Position. In the second considered approach, the XR device is rotating at a fixed and known position without knowing the orientations. Since the position of the UE/XR device is known, the EKF state vector is reduced to [\u03b8\u030c[k]T , \u2206\u03b8[k]T , \u03c1\u030c0[k] T , . . . , \u03c1\u030cN\u22121[k]] T \u2208 R6+3N , thus including only\ntracking of the orientation and antenna constellation.\n3) Unknown Movement and Fixed Known Rotation. In the third approach, the XR device is moving in the area with a fixed and known orientation. In this case, the EKF state vector is given as [p\u030cUE[k] T , vUE[k]T , \u03c1\u030c0[k] T , . . . ,\n\u03c1\u030cN\u22121[k]] T \u2208 R6+3N , and therefore considering only\ntracking of the position and antenna constellation. 4) Known Movement and Rotation. In the fourth approach,\nthe XR device is moving and rotating in the area by assuming perfect knowledge of the device positions and orientations at each time instant. As both the position and orientation of the UE/XR device are known, the EKF state vector includes only the unknown antenna constellation given as [\u03c1\u030c0[k] T , . . . , \u03c1\u030cN\u22121[k]] T \u2208 R3N .\nOut of these, the approach or scenario 4) serves as the performance benchmark, while items 1), 2) and 3) are more realistic in practical applications.\nFor all the considered approaches defined above, the estimation and tracking of the headset antenna constellation can be carried out by using the EKF formulations, presented in Section III-B. However, the Jacobian matrix, shown in (31), must be extended according to the unknown antenna constellation parameters. To this end, considering measurements from the mth TRP, the Jacobian matrix H\u03c1,m \u2208 RN\u00d73N for the antenna constellation \u03c1n with n = 0, . . . , N \u2212 1 can be written as\nH\u03c1,m=  \u2202h0,m \u2202\u03c10 01\u00d73 \u00b7 \u00b7 \u00b7 01\u00d73 01\u00d73 \u2202h1,m \u2202\u03c11 . . . ... ... . . . . . . 01\u00d73\n01\u00d73 \u00b7 \u00b7 \u00b7 01\u00d73 \u2202hN\u22121,m\u2202\u03c1N\u22121  , where (32) \u2202hn,m \u2202\u03c1n = R(\u03b8)T pUE +R(\u03b8)\u03c1n \u2212 pTRP,m \u2225pUE +R(\u03b8)\u03c1n \u2212 pTRP,m\u2225 . (33)\nFor example, regarding the first approach with unknown movement and rotation, the Jacobian matrix can be constructed as [H\u03b8, 0NM\u00d73, Hp, 0NM\u00d73, [HT\u03c1,0, \u00b7 \u00b7 \u00b7 , HT\u03c1,M\u22121]T ], which is an extension of the original Jacobian matrix shown in (31).\nAfter the estimation and tracking procedure, or at any time instant during the procedure, the estimated antenna constellation can be transformed into the desired frame of reference as\n\u03c1\u0302n = R(\u03b8REF) T ( R(\u03b8\u030c)\u03c1\u030cn + p\u030cUE \u2212 pUE,REF ) (34)\nwhere \u03c1\u0302n is the estimated relative position of the m th antenna while \u03b8REF and pUE,REF are the orientation and position of the XR device, all in the desired frame of reference. By defining the frame of reference according to the original definition of \u03c1n (i.e., antenna elements defined relative to the device position with zero rotation), it is possible to evaluate the estimation accuracy for the antenna constellation. Furthermore, since the described procedure involves setting a specific reference orientation and position, it can also be considered as one kind of a calibration process, where the estimated frame of reference is associated with the used global frame of reference.\nThe theoretical estimation accuracy for the antenna constellation can be derived by applying (32) to the derivations presented in Section III-A. In Fig. 3, the behavior of the corresponding CRLB for estimating the antenna constellation is illustrated using single-shot measurements from three TRPs,\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n7 -10 -5 0 5 10\nx-coordinate [m]\n-10\n-8\n-6\n-4\n-2\n0\n2\n4\n6\n8\n10\ny -c\no o rd\nin at\ne [m\n]\n10\n20\n30\n40\n50\n60\n70\nC R\nL B\n[ m\nm ]\nFig. 3. Illustration of the CRLB for estimating the antenna constellation \u03c1n, n=0, . . . , N\u22121, at different UE positions with three TRPs. The CRLB refers to the average of the single-shot measurement bounds of individual antennas.\nwhose exact locations are provided in Section V. The figure presents the average CRLB over all antennas at different XR device locations, and shows that the estimation accuracy is the highest when the device is located close to a TRP. Although not visible in the figure, at a fixed location, the device orientation does not significantly affect the calibration bound. However, minor variations due to orientation can be observed, as different orientations alter the distance between the antenna elements and TRPs. The figure also clearly illustrates that the calibration performance is favorable when the device is located inside the convex hull composed by the three TRPs. This is due to the more favorable geometry in the corresponding area, compared to being located outside. Additional concrete numerical examples will be provided in Section V."
        },
        {
            "heading": "IV. ADDRESSING INTEGER AMBIGUITY AND CLOCK CHALLENGES",
            "text": "In this section, we extend the problem definition to cover carrier phase measurements with integer ambiguity as well as unknown UE clock drifting. Furthermore, we formulate a joint EKF-based tracking solution for UE position, UE orientation, integer ambiguities, and UE clock. After this, we describe the corresponding tracking method with differential measurements."
        },
        {
            "heading": "A. Carrier Phase Measurements with Unknown Integer Ambiguity and UE Clock Drifting",
            "text": "The carrier phase measurement for the nth antenna element, obtained at the mth TRP, can be written as [31]\n\u03d5n,m = rn,m + c\u03b4 \u2212N intn,m\u03bb+ \u03bdn,m, (35)\nwhere rn,m is the range between the nth antenna element and the mth TRP, as described in (5). In addition, c is the speed of light, \u03b4 is the clock error between the UE and TRPs, \u03bb is the carrier wavelength, and \u03bdn,m \u223c N (0, \u03c32\u03bd) is measurement noise. Moreover, N intn,m denotes the integer ambiguity for the pseudorange between nth antenna element and mth TRP, where the pseudorange refers to the range with a clock error as rn,m+c\u03b4. The unknown UE clock \u03b4 is considered time-varying and can be modeled at time instant k as [39], [40]\n\u03b4[k] = \u03b4[k \u2212 1] + \u2206\u03b4[k]\u2206t \u2206\u03b4[k] = \u2206\u03b4[k \u2212 1] + \u03be[k],\n(36)\nwhere \u2206\u03b4[k] denotes a time-varying clock skew, and \u03be[k] \u223c N (0, \u03c32\u03be ).\nB. 6DoF Tracking under Integer Ambiguities and UE Clock Errors\nFor joint tracking of position, orientation, integer ambiguities, and clock error, the state vector shown in (22) is extended with new state variables incorporating the integer ambiguities and clock error as\nsint&clk[k]=[s[k] T s\u0304int&clk[k] T ]T \u2208 R14+2NM , where s\u0304int&clk[k]=[N\nint 0,0[k] \u00b7 \u00b7 \u00b7 N intN,M [k] \u2206N int0,0[k] \u00b7 \u00b7 \u00b7 \u2206N intN,M [k] \u03b4[k] \u2206\u03b4[k]] T \u2208 R2+2NM . (37)\nIn (37), \u03b4[k], \u2206\u03b4[k] and N intn,m[k] are as defined above, while \u2206N intn,m[k] denotes the integer ambiguity rate-of-change for the nth antenna element and mth TRP. Compared to conventional approaches in the literature such as [41], [42], where integer ambiguity resolution is performed outside of the Kalman filter, we estimate all parameters within the EKF. By this way, we pursue towards more computationally attractive solution for practical signal processing implementations \u2013 especially with multiple UE antennas and TRPs.\nFor tracking purposes, the state-transition models of integer ambiguity and clock are assumed to follow a CWNA model similar to the device position and orientation. Consequently, to obtain the a-priori estimates of the mean and covariance, denoted as s\u0302\u2212int&clk[k] and P\u0302 \u2212 int&clk[k], respectively, the EKF prediction step considering integer ambiguities and clock bias can be performed by following the same approach as shown in (28). However, the state transition matrix and process covariance matrix are extended to block-diagonal matrices Fint&clk = diag(F, F\u0304\u2297INM , F\u0304) \u2208 R14+2NM and Qint&clk[k] = diag(Q[k], \u03c32\u2206N intQ\u0304[k] \u2297 INM , \u03c3 2 \u2206\u03b4Q\u0304[k]) \u2208 R14+2NM , respectively. In the covariance matrix Qint&clk[k], the parameters \u03c32\u2206N int and \u03c3 2 \u2206\u03b4 denote the power spectrum densities of process acceleration for integer ambiguity and clock in respective order. Furthermore, the a-posteriori estimates of the mean and the covariance, denoted as s\u0302+int&clk[k] and P\u0302 + int&clk[k], can be obtained according to (29) by considering modified state variables and measurement model. To this end, by considering the measurement model with integer ambiguity and clock bias in (35), the Jacobian matrix for the EKF update phase is extended with partial derivatives with respect to the tracked integer ambiguities and clock as \u2202\u03d5n,m/\u2202N intn,m = \u2212\u03bb and \u2202\u03d5n,m/\u2202\u03b4 = c in respective order. Since the partial derivatives with respect to the orientation \u03b8 and position pUE are identical to the ones presented in Section III-A, the Jacobian matrix for tracking with integer ambiguities and clock is given as Hint&clk[k] = [H[k], \u2212\u03bb INM , 0NM\u00d7NM , c1NM , 0NM\u00d71], where 1NM is a vector of all-ones with NM elements, and H[k] is as described in (31).\nAs defined in (37), the proposed EKF formulation with unknown integer ambiguity and UE clock considers all state variables as real numbers, which does not reflect the true behaviour of integer ambiguities. Therefore, we propose using an additional EKF update phase, where the real-valued integer ambiguity estimates from s\u0302+int&clk[k] are rounded and fed back\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n8\nto the EKF in form of virtual integer ambiguity measurements. This approach enables estimation of rounded (integer precision) integer ambiguities inside the same EKF without introducing supplementary algorithms for integer ambiguity resolution. Accordingly, the additional EKF update step can be defined as\ns\u0302++int&clk[k] = s\u0302 + int&clk[k]+Kint[k](y\u0302 int[k]\u2212HintN s\u0302 + int&clk[k])\nP\u0302++int&clk[k] = (I14+2NM \u2212Kint[k]H int N )P\u0302 + int&clk[k],\n(38)\nwhere the Kalman gain Kint[k] \u2208 R(14+2NM)\u00d7MN reads as\nKint[k]=P\u0302 + int&clk[k]H int N T (HintN P\u0302 + int&clk[k]H int N T +\u03a3intN [k]) \u22121,\nand y\u0302int[k] = [y\u0302int0,0[k], \u00b7 \u00b7 \u00b7 , y\u0302intN,M [k]]T \u2208 RMN is the measurement vector including the rounded integer estimates. Furthermore, HintN = [0NM\u00d712, INM , 0NM\u00d7(NM+2)] and \u03a3intN [k] \u2208 RNM\u00d7NM are the constant measurement matrix and the covariance matrix for the virtual integer ambiguity measurements, respectively. To obtain the rounded integer ambiguity measurements for the additional update step, we consider a simple rounding function y\u0302intn,m[k] = round(N\u0302 int n,m[k]), where N\u0302 intn,m[k] is the real-valued integer ambiguity estimate from s\u0302+int&clk[k]. Alternatively, one could also consider the least-squares ambiguity decorrelation adjustment (LAMBDA) method [43], where with the estimated a-posteriori covariance P\u0302+int&clk[k], all integer ambiguities can be jointly estimated based on the least squares principle. Compared to the simple rounding scheme, the LAMBDA method can provide increased estimation robustness in challenging operation environments at the cost of higher computational complexity. This is because the LAMBDA method includes possibility to scale the integer ambiguity search space, and thus improves integer ambiguity resolution under challenging cycle slips. However, since the search space grows exponentially when increasing the number of UE antennas and TRPs, the resulting computational complexity must be carefully considered in practical scenarios with real-time processing. An illustration of the proposed EKF processing steps is shown in Fig. 4.\nC. 6DoF Tracking Through Differential Carrier Phase Measurements\nConsidering the carrier phase measurement of the nthref antenna element and mthref TRP as a reference, a differential phase measurement is described for (n,m) \u0338= (nref,mref) as\n\u03d5diffn,m = \u03d5n,m \u2212 \u03d5nref,mref = rn,m \u2212 rnref,mref \u2212N diffn,m\u03bb+\u2206\u03bdn,m,\n(39)\nwhere N diffn,m = N int n,m\u2212N intnref,mref denotes the integer ambiguity difference between a specific measurement and the corresponding reference. Moreover, \u2206\u03bdn,m = \u03bdn,m \u2212 \u03bdnref,mref is the effective measurement noise of the differential measurement. Compared to the formulations and approach in Section IV-B, the differential measurement approach allows to suppress the UE clock offset impact without explicit clock tracking.\nThe tracked state vector with differential phase measurements can now be written as\nsdiff[k] = [ s[k]T s\u0304diff[k] T ]T \u2208 R12+2(NM\u22121), (40)\nwhere s\u0304diff[k] \u2208 R2(NM\u22121) for (n,m) \u0338= (nref,mref) reads\ns\u0304diff[k]=[N diff 0,0 [k] \u00b7 \u00b7 \u00b7 N diffN,M [k] \u2206N diff0,0 [k] \u00b7 \u00b7 \u00b7 \u2206N diffN,M [k]]T ,\nand N diffn,m[k] and \u2206N diff n,m[k] are the integer ambiguity difference and its rate-of-change. Again, assuming the CWNAbased state-transition model, the EKF prediction step to obtain the a-priori estimates of the mean s\u0302\u2212diff[k] and covariance P\u0302\u2212diff[k] can be performed based on (28) by considering the following modifications. Firstly, the state-transition matrix and the process covariance matrix for tracking with differential carrier phase measurements are described as block-diagonal matrices Fdiff = diag(F, F\u0304 \u2297 INM\u22121) and Qdiff[k] = diag(Q[k], \u03c32\u2206N diffQ\u0304[k] \u2297 INM\u22121), respectively. Moreover, \u03c32\u2206N diff denotes the process acceleration for integer ambiguity difference.\nFor the EKF update step with differential carrier phase measurements, the a-posteriori estimates of the mean and covariance, denoted as s\u0302+diff[k] and P\u0302 + diff[k], can be obtained based on (29) by appropriately modifying the state variables and measurement model. Accordingly, given the measurement model in (39), the Jacobian matrix for differential phase measurements includes additional terms of integer ambiguity differences, given as \u2202\u03d5diffn,m/\u2202N diff n,m=\u2212\u03bb, and can be further described as Hdiff[k]= [H\u0304diff[k], \u2212\u03bb INM\u22121, 0(NM\u22121)\u00d7(NM\u22121)]. Moreover, H\u0304diff[k] \u2208 R(NM\u22121)\u00d712 is defined according to (31) by replacing the partial derivatives with respect to the position pUE and rotation \u03b1, and similarly for \u03b2 and \u03b3, as \u2202\u03d5diffn,m/\u2202pUE = \u2202hn,m/\u2202pUE \u2212 \u2202hnref,mref/\u2202pUE, and \u2202\u03d5diffn,m/\u2202\u03b1= \u2202hn,m/\u2202\u03b1 \u2212 \u2202hnref,mref/\u2202\u03b1, respectively, when (n,m) \u0338=(nref,mref). The descriptions of the partial derivatives are presented in Section III-A.\nSince also the integer ambiguity differences \u2206N diffn,m[k] are integer values, the additional EKF update step, described in (38), is also performed for the differential measurements to obtain the a-posteriori estimates of the mean and covariance as s\u0302++diff [k] and P\u0302 ++ diff [k], respectively. Regarding the additional EKF update step with differential measurements, the constant measurement model and the measurement covariance matrix are given as HdiffN = [0(NM\u22121)\u00d712, INM\u22121, 0(NM\u22121)\u00d7(NM\u22121)] and \u03a3diffN [k] \u2208 R(NM\u22121)\u00d7(NM\u22121) in respective order. Moreover, y\u0302diff[k] = [y\u0302diff0,0[k], \u00b7 \u00b7 \u00b7 , y\u0302diffN,M [k]]T \u2208 RMN is the measurement vector including the estimates of rounded integer ambiguity differences, where y\u0302diffn,m[k] = round(N\u0302 diff n,m[k]) for (n,m) \u0338= (nref,mref). The EKF processing steps illustrated in Fig. 4 are conceptually also valid for the differential measurements.\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n9"
        },
        {
            "heading": "D. Further Discussion",
            "text": "The key driver towards the proposed EKF processing with integer ambiguity estimation is feasible computational complexity to enable practical real-time processing which can scale up to several user device antennas. The utilized rounding approach to handle the integer ambiguities is simple, but effective when utilized with the EKF through virtual integer ambiguity measurements, as shown in Fig. 4. However, the proposed overall concept with antenna-level measurements allows, as such, estimating integer ambiguities also with more advanced methods, such as the LAMBDA method, with further details available e.g. in [31], [41], [42], [44]. In [41] and [42], a Kalman filter is processed independently using real (float) numbers, and a subsequent estimation method is used separately to resolve the integer ambiguity. In [42], a separate batch weighted nonlinear least-squares method is used to jointly estimate the UE position and real valued integer ambiguities, but eventually both [41] and [42] utilize the LAMBDA method for integer ambiguity solution. Moreover, a mixture Kalman filter is proposed in [44] for elegant, but computationally fairly evolved solution involving particle sampling.\nIn practical setups with measurement outliers, or with longer measurement intervals, the mixture Kalman filter can provide robustness against cycle slips. Furthermore, by dynamically scaling the computational complexity according to underlying estimation uncertainty, for example, by varying the number of used particles, the mixture Kalman filter could provide a favorable trade-off between computational complexity and robustness for the considered XR scenario."
        },
        {
            "heading": "V. NUMERICAL RESULTS",
            "text": ""
        },
        {
            "heading": "A. Scenario and Assumptions",
            "text": "The performance of the proposed concept and methods is next numerically assessed in an indoor factory like setting, following the 3GPP evaluation guidelines and assumptions stated in [26], [32]. The size of the factory area within which a person wearing the XR headset is moving is limited 10 m\u00d710 m while both 3.5 GHz and 28 GHz network deployments with three TRPs are considered. In the baseline evaluations, the XR headset is assumed to contain five antenna points, while the number is also later varied. The considered gNB or TRP deployment locations are illustrated in Fig. 5, where the exact TRP positions are pTRP,0=[0,\u22126, 3.5]T , pTRP,1=[\u22128, 7, 3]T and pTRP,2 = [7, 6, 2.5]\nT . In addition to TRP locations, the antenna configuration of the XR device is illustrated for a device position at pUE = [0, 0, 1]\nT . Accordingly, the antenna positions relative to the device position are \u03c10= [0.1, 0, 0]\nT , \u03c11=[\u22120.1,\u22120.15,\u22120.05]T , \u03c12=[\u22120.1, 0.15,\u22120.05]T , \u03c13= [\u22120.1,\u22120.15, 0.05]T and \u03c14=[\u22120.1, 0.15, 0.05]T , comprising the so-called antenna constellation.\nTo account for different practical aspects and limitations, such as oscillator impairments, antenna reference point errors and antenna phase center offsets, we utilize the extensive carrier phase estimation accuracy results, collected and reported in [26], while also vary the corresponding ranging estimation error variance to understand how the antenna-level ranging performance impacts the corresponding performance of the\nproposed 6DoF estimation and tracking concept. Furthermore, all numerical results are evaluated based on 100 separate UE test tracks with varying UE position and orientation. Within any individual UE test track, carrier phase measurements are obtained at intervals of \u2206t = 10ms, which is the duration of one radio frame in 5G NR. In practice, the required update interval depends on the expected maximum velocities (or rate-ofchange) of tracked parameters and varies according to different system parameters, such as measurement noise. With certain considered simulation setups, larger intervals could be used, especially in ones with low measurement noise. Nonetheless, in 5G NR, it is possible to transmit PRSs or SRSs even with less than 1 ms intervals, and thereon impact the update interval. For the test tracks, the true UE movement and the true evolution of orientation angles are modeled using a non-linear kinematic model, which builds on the 3D-extension of the model presented in [45]. Each user track is 30 s long, and bounded within the 10 m\u00d710 m\u00d72.5 m operation area as illustrated in Fig. 5. Moreover, the values of orientation angles are limited to \u2212180 deg \u2264 \u03b1 < 180 deg and \u221260 deg \u2264 \u03b2, \u03b3 \u2264 60 deg to reflect physically feasible XR headset rotation. Inside a track, the UE velocity and the rate-of-change per orientation angle vary up to 4 km/h and 90 deg/s, respectively. Such a velocity corresponds essentially to human walking speed while the orientation rate of change is well inline with the human head moving rates reported, e.g., in [46]. An example of a considered 3D UE track with varying 3D UE orientation is illustrated in Fig. 6 by showing separate antenna positions as functions of time. For visual clarity, only the positions of 3 antenna elements are shown, instead of all 5. In addition, to assist with perception of 3D space, projections of the antenna positions are shown in the XY-plane, XZ-plane and YZ-plane.\nAssuming uncorrelated measurements, the covariance matrix of the measurement noise is defined as \u03a3 = \u03c32r IMN , where \u03c3r is the standard deviation of the ranging error. By following the reported carrier phase-based positioning and ranging results in [26], we evaluate results for the theoretical 6DoF bounds in Section V-B by varying the ranging error from \u03c3r = 0.1mm to \u03c3r = 50mm. Such fairly large range covers well the individual accuracy results reported and discussed in [26], reflecting different practical assumptions. Moreover, for the 6DoF tracking results in Section V-C, we consider two fixed ranging error deviations, given as \u03c3r = 50mm and \u03c3r = 5mm, which reflect to 3.5 GHz and 28 GHz network deployments, respectively. These stem from the comprehensive ranging performance results provided in [26], serving as realistic practical example scenarios. These ranging standard deviation values are in the order of half the wavelength of the considered frequency bands, hence, one can argue that the ranging accuracy assumptions are even somewhat pessimistic \u2013 or at least not overly optimistic and thus safe.\nIn order to provide statistical variation for the 6DoF tracking results in Section V-C, each track is further run over 100 trials with different measurement noise realizations. In the beginning of each track realization, the used EKF is initialized without assuming any prior information on the UE position, UE orientation, or related motion. The initial UE position and UE orientation as well as their covariance, are obtained based\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n10\non Gauss-Newton algorithm [34] by exploiting the derived Jacobian matrix in (9). Moreover, the initial UE velocity and the rotational rate-of-change are set to zero with very large covariance. Regarding the state-transition model, the power spectral densities of angular acceleration and UE acceleration of the process covariance Q[k] are defined as \u03c32\u2206\u03b8=9 \u00b710\u22124 and \u03c32v = 4 \u00b710\u22124, respectively. Throughout the evaluations we assume a known measurement covariance matrix \u03a3[k]. However, in practice the measurement covariance can be estimated on the run, or learned in advance based on training data. Finally, the baseline results build on the assumption of known XR headset antenna geometry, however, results related to over-the-air estimation of the antenna constellation are also provided towards the end. Similarly, the extended problem scope with unknown integer ambiguities and drifting UE clock is considered towards the end of the numerical results.\nB. 6DoF Bounds\nIn the following, we first study the measurement-related (no prior) bounds and their behavior as functions of the standarddeviation of the carrier phase -based ranging error, \u03c3r. The behaviors of the corresponding posterior bounds are illustrated and studied along the actual EKF-based tracking results in the next subsection.\nFirst, CRLBs are evaluated and shown separately for the orientation parameters \u03b1, \u03b2 and \u03b3 in Fig. 7. The RMSE curves are obtained based on the derived expressions in (15) as\u221a\nCRLB(\u03b1\u0302), \u221a CRLB(\u03b2\u0302) and \u221a CRLB(\u03b3\u0302), respectively. As\ncan be observed, highly accurate estimation of the orientation parameters is theoretically feasible, with 1 degree RMSE of an individual parameter calling for approximately 3...5 mm ranging accuracy in the considered system geometry. Based on [26], such ranging accuracies are feasible \u2013 especially at the millimeter-wave bands. We can also observe that the estimation of \u03b1 is somewhat more accurate, theoretically, stemming from the favourable TRP geometry in horizontal plane, in which the \u03b1 directly operates.\nThe corresponding no-prior bounds for the x-coordinate, y-coordinate and z-coordinate are illustrated in Fig. 8. The RMSE curves are evaluated based on the derived expressions in (15), as \u221a CRLB(x\u0302UE), \u221a CRLB(y\u0302UE) and \u221a CRLB(z\u0302UE), respectively. Based on the bounds and their numerical behavior, below centimeter level positioning accuracy is theoretically feasible with the 10 mm ranging performance. It can also be observed from the figure that the estimation of the z-coordinate is less accurate, at least to some extent, stemming from the fact that all the network TRPs are deployed at mutually similar antenna heights as described in the previous subsection. Hence, taking this aspect into account in the TRP or gNB deployment is essential to maximize the 6DoF estimation performance.\nNext, the average OEB behavior, as defined and expressed in (16), is evaluated and shown in Fig. 9 as a function of the ranging error standard deviation \u03c3r. Besides the assumed XR device antenna configuration, results include also two additional configurations, where the dimensions of the device and thereon the antenna geometry are either halved or doubled. This provides further insight to the error and performance dependency on the assumed antenna separations at the XR device. The shaded areas in the figure show the OEB domains between the 1st and 99th percentiles over all time steps and test tracks. In can clearly be observed that for a given antennalevel ranging standard deviation, the performance is very stable across the different paths and points along the tracks. We can also observe that in order to reach a true one degree 3D orientation RMSE, the ranging accuracy should be just a few millimeters. The figure also clearly shows that increasing the device size has a clear positive impact on the 3D orientation estimation accuracy, due to the improved antenna geometry.\nFinally, the average PEB behavior, as defined and expressed in (17), is evaluated and shown in Fig. 10 while again varying the ranging error standard deviation \u03c3r. Regarding the PEB, the RMSE values with half-sized array or double-sized array are\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n11\npractically identical for the considered system configuration, and are thus not shown in the figure. The results in Fig. 10 again highlight the consistency of the estimation performance along the tracks and points of the individual tracks, assuming a given ranging standard deviation. Concretely, in order for the 3D location RMSE to be below 1 centimeter with high probability, antenna ranging accuracies in the order of 5 mm are required in the considered scenario.\nC. 6DoF Tracking Results\nNext, we study and present the performance of the proposed EKF and the corresponding posterior bounds derived and expressed in (20). We consider two alternative ranging error standard deviations, \u03c3r = 5 mm and \u03c3r = 50 mm = 5 cm, chosen based on the extensive carrier phase estimation studies in [26], and corresponding to 28 GHz and 3.5 GHz network deployments, respectively. As noted earlier, the results build on 100 independent UE tracks with time-varying position and orientation, while each track is also sampled 100 times with different measurement noise realizations for statistical purposes.\nFirst, the average orientation estimation RMSEs for the proposed EKF as functions of time are shown in Fig. 11 with the two considered ranging error standard deviations. The figure also shows the corresponding posterior OEBs for reference. It can be clearly observed that after the initial transient, the proposed EKF yields performance very close to the respective posterior bound, hence implying an efficient estimator. Application-wise, it can also be observed that below one degree 3D orientation tracking is feasible, especially at the millimeter-wave frequencies.\nSimilarly, the average positioning RMSEs for the proposed EKF as functions of time are shown in Fig. 12, together with the\napplicable posterior PEBs, for the two considered ranging error standard deviations. The results high-light again the efficiency of the EKF solution, while also evidence close to one centimeter 3D location tracking RMSE at the millimeter-waves.\nThe actual cumulative distributions of the absolute estimation errors with the proposed EKF for orientation angles \u03b1, \u03b2 and \u03b3 are shown in Fig. 13, again considering the two antennalevel ranging error standard deviations of 5 mm and 50 mm. Similarly, the corresponding cumulative distributions of the absolute estimation errors for x-coordinate, y-coordinate and z-coordinate are shown in Fig. 14. The cumulative distributions demonstrate, overall, highly consistent tracking performance across the tracks and noise realizations. Additionally, similar to the no-prior performance findings in the previous subsection, the EKF performance is relatively better for \u03b1, compared to other orientation parameters, due to the more favourable horizontal geometry of the TRPs. The distributions also show that tracking the device z-coordinate is more challenging, as noted earlier, due to the fact that the antennas of all three TRPs are located essentially at the same height.\nFinally, we summarize selected key performance measures in Table I, covering both the frequency range 1 (FR1, 3.5 GHz) and FR2 (28 GHz) deployments. The table shows the 3D orientation and 3D position RMSEs with the proposed EKF formulation together with the RMSEs of the corresponding static estimator which refers to the Gauss-Newton based estimation utilized as the EKF initialization approach. Additionally, the respective bounds are shown for comparison purposes. The results in the table clearly high-light the added value of a true tracking solution that incorporates information also from the preceding\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n12\nestimates. Specifically, as shown by the results in Table I, essentially one order of magnitude RMSE improvements can be obtained through EKF-based tracking compared to static estimation. Overall, the results demonstrate the feasibility of extremely accurate 6DoF XR device tracking, with below one degree and below one centimeter orientation and position RMSEs available at the millimeter-wave bands.\nBesides the proposed EKF-based approach, corresponding CKF and UKF based solutions were also implemented and tested. However, the obtained results with CKF and UKF are practically identical with the EKF, and thus they are omitted from the numerical results shown in this paper. It should be emphasized that under the condition of similar performance between EKF, CKF and UKF, the EKF is preferred from the computational complexity perspective."
        },
        {
            "heading": "D. Results with Reduced Headset Antenna Counts",
            "text": "Next, we shortly study how reducing the antenna count in the XR headset, from 5 down to 4 and 3, impacts the 6DoF tracking performance. For the considered 4 antenna scenario, we employ the antenna elements with indices 0, 1, 2 and 3 from the original antenna constellation which was earlier illustrated in Fig. 5. Furthermore, for the 3 antenna scenario we remove yet an additional element, and thus employ only the antenna elements with indices 0, 1 and 2.\nThe average EKF tracking RMSEs of 3D positioning and 3D orientation estimation with reduced antenna counts are shown in Table II for both the FR1 (3.5 GHz) and FR2 (28 GHz) deployments. In addition to the EKF tracking results, the corresponding performance bounds (PEB, OEB) are again provided. All results are evaluated based on the same test\ntracks and parameters as with the original 5 antenna setup. According to the shown RMSEs, it is visible that reducing the antenna count at the FR2 deployment has a rather small effect. Specifically, when reducing the antenna count from 5 to 3, the EKF RMSE for the 3D orientation increases from 0.83 deg to 1.14 deg, and correspondingly for the 3D position from 3.05 mm to 3.76 mm. However, the performance drop is more notable at FR1, where the RMSE of 3D orientation estimation is roughly doubled, and the RMSE of 3D positioning almost tripled, when reducing the antenna count from 5 to 3. The reason for this is that in the FR1 deployment, the assumed 50 mm ranging error standard deviation inflicts antenna-level measurement errors that are already at the level of antenna separation distances, which in turn introduces challenges to the estimator when the antenna count is reduced towards to the critical number of 3 antennas. Nevertheless, the proposed EKF is still able to achieve RMSEs close to the theoretical bounds, and thus proving its feasibility to the considered tracking of XR device orientation and location even with only 3 headset antenna points. These findings also clearly motivate for clever XR headset design in terms of optimizing the antenna positions."
        },
        {
            "heading": "E. Results with OTA Calibration of Headset Antennas",
            "text": "We next demonstrate and evaluate the proposed over-theair estimation or calibration of the XR headset antenna constellation. The evaluations are performed using the original antenna constellation with 5 antenna elements according to Fig. 5, including the four different OTA estimation approaches,\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n13\ndescribed in Section III-D. The RMSEs of the antenna constellation estimates as functions of time for the four considered approaches are shown in Fig. 15. For all the approaches, we assume the FR2 deployment with 5 mm ranging standard deviation, and evaluate the performances by exploiting the same test tracks and orientations as described in Section V-A. Besides the EKF tracking results, the corresponding theoretical posterior bounds are derived and shown to illustrate the EKF performance with respect to an estimator with optimum performance.\nIn the first approach, namely the Unknown Movement and Rotation case, the XR device is moving and rotating in the operation area, while the EKF tracks jointly the device position and device orientation as well as the antenna constellation. It should be emphasized that during the tracking process the estimated parameters do not reflect the true parameters due to the implicit relation between the position, orientation and relative antenna coordinates. Thus, the accuracy of the antenna constellation estimation can be evaluated only after the estimated antenna constellation is transformed to the original frame of reference, as discussed and defined in (34). As seen in Fig. 15, from the four considered approaches, the approach with unknown movement and rotation is the most challenging, reaching to antenna constellation estimation RMSE of below 4 mm. However, it can also be seen that the proposed EKF gets close to the posterior performance bound found to be approximately at 3 mm at the end of the tracking process.\nIn the second approach of estimating the antenna constellation, namely the Unknown Rotation at a Fixed Known Position scenario, the XR device is rotating at a fixed known position, while the EKF tracks jointly the device orientation and the antenna constellation. For these evaluations, the XR device is located at a fixed position in the center of the area (pUE = [0, 0, 1.5] T ), while the orientation changes according to\nthe orientation of the earlier considered test tracks. As seen in Fig. 15, compared to the first approach, the estimation RMSE is improved due to the reduced process covariance through known device position, reaching antenna constellation accuracy of below 2 mm already. In the third approach, namely the Unknown movement and fixed known rotation., the orientation is known instead and fixed at \u03b8 = [0, 0, 0]T , while the device is moving with unknown position. Due to an interchangeable relationship between the antenna constellation and the device position, this approach results in lower estimation accuracy compared to the one with known position, eventually reaching around 3 mm accuracy.\nWhereas the first three approaches can be considered more essential and relevant for practical scenarios and applications, the fourth approach, namely the Known Movement and Rotation reference case, works as a performance benchmark for estimating the antenna constellation. In this approach, similar to the first and third ones, the XR device is moving and rotating in the operation area, but assuming now that the device position and orientation are perfectly know at each time instant. Thus, the EKF tracks now only the unknown antenna constellation. As seen in Fig. 15, the RMSE of antenna constellation estimation reaches accuracies that are only fractions of a millimeter. Moreover, unlike with the other considered OTA calibration approaches, the estimation accuracy is now able to continuously improve in time due to the absence of process noise related to the device position and/or the orientation."
        },
        {
            "heading": "F. Results with Integer Ambiguity and UE Clock Drifting",
            "text": "For the results with integer ambiguity and clock bias, as well as with differential carrier phase measurements, we consider the same general parameters described in Section V-A, except that the filter update interval is reduced to 1 ms to support tracking of integer ambiguities. The standard deviation of the clock skew noise \u03be[k] is defined as \u03c3\u03be = 10\u221210, which can result in clock variations corresponding to tens of meters of ranging error during one track. Moreover, the considered true integer ambiguities stem directly from the time-varying position, orientation and clock of the UE. For the standard deviation of\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n14\ncarrier phase measurement error we vary three different values, including \u03c3\u03bd = 0.01\u03bbm, \u03c3\u03bd = 0.05\u03bbm, and \u03c3\u03bd = 0.1\u03bbm, where \u03bb is the carrier wavelength. These correspond to standard deviations of carrier phase errors of 3.6 deg, 18 deg, and 36 deg in respective order.\nIn the EKF process model, the additional parameters related to clock drift and integer ambiguities have been chosen based on brief testing over different parameter combinations. Regarding the approach with tracking the clock and integer ambiguities, we define the power spectrum density of clock acceleration as \u03c32\u2206\u03b4=10\n\u221220. Furthermore, the power spectrum density of process acceleration for integer ambiguity is defined \u03c32\u2206N int =10 8 for FR1, and \u03c32\u2206N int =10 10 for FR2. The relatively large process noise is adopted in order to allow fast integer updates with the considered simple rounding scheme. However, the process noise magnitude can be considerably decreased when using more advanced integer resolution methods, such as the LAMBDA method. Then, regarding the approach with differential carrier phase measurements, the power spectrum density of process acceleration for integer ambiguity difference is defined \u03c32\u2206N diff = 10 10 for FR1, and \u03c32\u2206N diff = 10 12 for FR2. The covariance matrix for the virtual integer ambiguity measurements in the additional EKF update step is given as \u03a3intN [k] = 10\n\u22128 \u00b7 INM for tracking with clock, and \u03a3diffN [k] = 10\n\u22128 \u00b7 INM\u22121 for differential measurements. For all results with integer ambiguity, we initialize the EKF using differential measurements at FR1 (defined in (39)) and a non-linear least squares estimation based on the Gauss-Newton method with multiple initial starting points for the iterations. With the differential measurements, the initial clock error can be removed, allowing accurate UE position estimation. The initialization of the EKF is accomplished using 100 samples before proceeding to the proposed EKF processing steps, shown in Fig. 4. In practice, the computational burden and latency of such brute force approach could be mitigated by exploiting additional initial positioning methods supported in 5G NR, such as multi-round-trip-time (Multi-RTT), time-difference-of-arrival (TDoA), or AoA.\nIn Fig. 16, cumulative distributions of absolute 3D positioning errors are presented for both FR1 and FR2, considering tracking with integer ambiguities and unknown clock as well as two separate standard deviations of carrier phase measurement error. When comparing the positioning accuracy between FR1 and FR2, at FR2 higher accuracy is achieved due to the shorter wavelength. At FR1, EKF-based tracking with integers and clock (\u201dInt&Clock\u201d), presented in Section IV-B, performs similarly compared to the corresponding tracking with differential measurements (\u201dDifferential\u201d), presented in Section IV-C. However, at FR2, tracking with integers and clock becomes more challenging due to more frequent integer ambiguity cycle slips. The 90% error percentiles with measurement standard deviation of \u03c3\u03bd=0.01\u03bb are below 12 mm at FR1 and below 4 mm at FR2, while with \u03c3\u03bd=0.05\u03bb, below 40 mm at FR1 and below 14 mm at FR2. The corresponding cumulative distributions for absolute 3D orientation errors are shown in Fig. 17. On contrary to the positioning results, there are no visible differences between tracking with integers and clock vs. tracking with differential measurements. This is due to fact\nthat orientation estimation is based on relative measurements between different antennas, and is thus insensitive to common clock error between the antennas. With measurement standard deviation of \u03c3\u03bd=0.01\u03bb, the 90% error percentiles are below 0.27 deg at FR1 and below 0.06 deg at FR2, whereas with \u03c3\u03bd = 0.05\u03bb, the percentiles are below 0.89 deg at FR1 and below 0.19 deg at FR2.\nCumulative distributions of the clock estimation error are shown in Fig. 18 for the tracking with integers and clock. Again, the estimation accuracy at FR2 is higher compared to FR1. Considering the measurement standard deviation of \u03c3\u03bd=0.05\u03bb, the 90% error percentiles for the clock estimation are below 0.03 ns for FR1 and below 0.02 ns at FR2.\nAs shown earlier in Fig. 14, the positioning performance is limited due to poor TRP geometry from the z-coordinate (altitude) point of view. Thus, for final evaluation, we introduce an additional TRP to the position pTRP,3 = [0, 0, 4]\nT , which can be considered to be placed on the ceiling in the middle of the operation area. In Fig. 19, cumulative distributions of positioning errors are compared between 3 TRPs and 4 TRPs for tracking with integers and clock (\u201dInt&Clock\u201d), while assuming FR1 and two measurement standard deviations of \u03c3\u03bd = 0.01\u03bb and \u03c3\u03bd = 0.10\u03bb. Moreover, the cumulative distributions are shown separately for horizontal 2D error defined in xy-plane (\u201dHor.\u201d), and altitude error defined in direction of z-axis (\u201dAlt.\u201d). From the figure, it can be seen that\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\n15\nwith 3 TRPs the altitude error is considerably larger compared to the horizontal error, especially with \u03c3\u03bd =0.10\u03bb. However, with 4 TRPs the horizontal and altitude errors are at the same range, and most importantly, there is a significant improvement in the altitude estimation accuracy compared to the original 3 TRP case. In addition, with 4 TRPs the 90% error percentiles for both the horizontal and altitude errors reach below 4 mm with \u03c3\u03bd = 0.10\u03bb. Finally, in Fig. 20, the corresponding cumulative distributions for 3D orientation error are shown for the 3 TRP and 4 TRP scenarios. It can be seen that introducing the fourth TRP does not provide similar increase in accuracy with orientation estimation as with positioning. Thus, orientation estimation accuracy is not as sensitive to the TRP geometry as positioning accuracy. Nonetheless, overall, when applying 6DoF tracking in the considered 5G NR scenario, it is essential to ensure an appropriate TRP geometry."
        },
        {
            "heading": "VI. CONCLUSIONS",
            "text": "In this article, the so-called six degrees-of-freedom tracking challenge of XR headset was addressed, in the context of 5G and beyond cellular networks. The proposed approach builds on antenna-level carrier phase measurements, obtained through either uplink and downlink reference signals, combined with Bayesian filtering in the form of EKF to continuously track the XR headset 3D orientation and 3D location. The EKF formulation also allows for tracking the device velocity and orientation rate-of-chance that can provide added value in mobile XR applications, e.g., for viewpoint and/or field-ofview prediction and proactive rendering with minimum latency\nwhen operating in the uplink-based mode. Also applicable noprior and posterior Crame\u0301r-Rao lower-bounds were stated and derived to assess the 6DoF performance limits. Furthermore, over-the-air estimation concepts and algorithms were proposed for acquiring the XR headset antenna geometry. Additionally, extended problem definitions and corresponding EKF solutions were provided to account for the important integer ambiguity and UE clock drifting challenges. An extensive set of numerical results were provided, evaluating and assessing the performance of the proposed methods and the corresponding performance bounds, covering results for both 3.5 GHz and 28 GHz network deployments. To obtained results clearly demonstrate that especially in millimeter-wave networks, the proposed concept can facilitate highly accurate 3D orientation and 3D location tracking \u2013 with the best numerical examples showing RMSE accuracies below one degree and below one centimeter, respectively. Also, estimating the XR headset antenna constellation at RMSEs closing towards one millimeter as well as accurate tracking of the carrier phase integer ambiguities and UE clock drifting were shown to be technically feasible.\nAPPENDIX DEFINITIONS OF 3D ROTATION MATRICES\nWe consider the 3D rotation matrix R(\u03b8) \u2208 R3\u00d73 defined in [32], and reproduced in (41), applying rotation in z-, yand x-axis in respective order according to the rotation angles \u03b8 = [\u03b1, \u03b2, \u03b3]T , where \u03b1, \u03b2 and \u03b3 are the yaw, pitch and roll. The partial derivatives of the rotation matrix R(\u03b8) with respect to distinct rotation angles \u03b1, \u03b2 and \u03b3, given as R\u03b1(\u03b8) = \u2202R(\u03b8)/\u2202\u03b1, R\u03b2(\u03b8) = \u2202R(\u03b8)/\u2202\u03b2 and R\u03b3(\u03b8) = \u2202R(\u03b8)/\u2202\u03b3, are stated in (42), (43) and (44), in respective order."
        }
    ],
    "title": "Orientation and Location Tracking of XR Devices: 5G Carrier Phase-Based Methods",
    "year": 2023
}