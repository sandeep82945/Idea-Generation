{
    "abstractText": "This work introduces a multi-stage CMOS OTA design technique that allows cascading identical gain stages (for arbitrarily scalable high DC gain) while driving an ultra-wide range of capacitive loads (CLs). At the heart of the proposed design is a new frequency compensation technique (FCT) that relies on low-frequency left-half-plane zeros to allow the proposed OTA to operate for a desired closed-loop behavior. In this work, classical gain-stages (i.e., differential pair and common source transistors) are used to design fully-differential 2-, 3-, 4and 5-stage CMOS OTAs. The proposed 2-to-4-stage designs have been fabricated in TSMC 65 nm CMOS process and the measurement results show that the 2-stage OTA is achieving a DC gain of 50 dB with a CL-drivability ratio (i.e., CL,max/CL,min) of 10,000\u00d7, the 3-stage OTA is achieving a DC gain of 70 dB with a CL-drivability of 1,000,000\u00d7, and the 4-stage OTA is achieving a DC gain of 90 dB with a CL-drivability of 1,000,000\u00d7. This is a 10-to-1000-time improvement in the state-of-the-art, as the highest CL-drivability reported to date is 1000\u00d7. Accordingly, the proposed OTAs can cover a wider range of applications than any other reported works.",
    "authors": [
        {
            "affiliations": [],
            "name": "Mahmood A. Mohammed"
        },
        {
            "affiliations": [],
            "name": "Gordon W. Roberts"
        }
    ],
    "id": "SP:3ce534069a9e8d0527f8f82485c61662215b2280",
    "references": [
        {
            "authors": [
                "N. Aghaee",
                "Z. Peng",
                "P. Eles"
            ],
            "title": "Temperature-gradient-based burn-in and test scheduling for 3-D stacked ICs",
            "venue": "IEEE Trans. VLSI, vol. 23, no. 12, pp. 2992\u20133005, Dec. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "M. Mohammed",
                "S. Kawar",
                "K. Abugharbieh"
            ],
            "title": "Methodology for designing and verifying switched-capacitor sample and hold circuits used in data converters",
            "venue": "IET Circuits, Devices Syst., vol. 8, no. 4, pp. 252\u2013262, Jul. 2014.",
            "year": 2014
        },
        {
            "authors": [
                "A.S. Emara"
            ],
            "title": "An area-efficient high-resolution segmented - DAC for built-in self-test applications",
            "venue": "IEEE Trans. Very Large Scale Integr. (VLSI) Syst., vol. 29, no. 11, pp. 1861\u20131874, Nov. 2021.",
            "year": 1861
        },
        {
            "authors": [
                "V. Dhanasekaran",
                "J. Silva-Martinez",
                "E. Sanchez-Sinencio"
            ],
            "title": "Design of three-stage class-AB 16 headphone driver capable of handling wide range of load capacitance",
            "venue": "IEEE J. Solid-State Circuits, vol. 44, no. 6, pp. 1734\u20131744, Jun. 2009.",
            "year": 2009
        },
        {
            "authors": [
                "F. Xiao",
                "P.K. Chan"
            ],
            "title": "A performance-aware low-quiescent headphone amplifier in 65-nm CMOS",
            "venue": "IEEE J. Solid-State Circuits, vol. 52, no. 2, pp. 505\u2013516, Feb. 2017.",
            "year": 2017
        },
        {
            "authors": [
                "W.-J. Huang",
                "S. Nagayasu",
                "S.-I. Liu"
            ],
            "title": "A rail-to-rail class-B buffer with DC level-shifting current mirror and distributed Miller compensation for LCD column drivers",
            "venue": "IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 58, no. 8, pp. 1761\u20131772, Aug. 2011.",
            "year": 2011
        },
        {
            "authors": [
                "B. Li",
                "W. Wang",
                "J. Liu",
                "W.-J. Liu",
                "Q. Yang",
                "W.-B. Ye"
            ],
            "title": "A 1 pF-to- 10 nF generic capacitance-to-digital converter using zero-crossing modulation",
            "venue": "IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 65, no. 7, pp. 2169\u20132182, Jul. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "C. Stagni"
            ],
            "title": "CMOS DNA sensor array with integrated A/D conversion based on label-free capacitance measurement",
            "venue": "IEEE J. Solid- State Circuits, vol. 41, no. 12, pp. 2956\u20132964, Dec. 2006.",
            "year": 2006
        },
        {
            "authors": [
                "K.N. Leung",
                "P.K.T. Mok"
            ],
            "title": "A capacitor-free CMOS low-dropout regulator with damping-factor-control frequency compensation",
            "venue": "IEEE J. Solid-State Circuits, vol. 38, no. 10, pp. 1691\u20131702, Oct. 2003. MOHAMMED AND ROBERTS: SCALABLE MULTI-STAGE CMOS OTAs WITH A WIDE CL-DRIVABILITY RANGE 87",
            "year": 2003
        },
        {
            "authors": [
                "W. Oh",
                "B. Bakkaloglu"
            ],
            "title": "A CMOS low-dropout regulator with current-mode feedback buffer amplifier",
            "venue": "IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 54, no. 10, pp. 922\u2013926, Oct. 2007.",
            "year": 2007
        },
        {
            "authors": [
                "M.A. Mohammed",
                "G.W. Roberts"
            ],
            "title": "Generalized relationship between frequency response and settling time of CMOS OTAs: Toward many-stage design",
            "venue": "IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 68, no. 12, pp. 4993\u20135006, Dec. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M.A. Mohammed",
                "G.W. Roberts"
            ],
            "title": "A scalable many-stage CMOS OTA for closed-loop applications",
            "venue": "Proc. IEEE Int. Symp. Circuits Syst. (ISCAS), May 2021, pp. 1\u20135.",
            "year": 2021
        },
        {
            "authors": [
                "K.H. Mak",
                "K.N. Leung"
            ],
            "title": "A signal- and transient-current boosting amplifier for large capacitive load applications",
            "venue": "IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 61, no. 10, pp. 2777\u20132785, Oct. 2014.",
            "year": 2014
        },
        {
            "authors": [
                "Z. Yan",
                "P.-I. Mak",
                "M.-K. Law",
                "R.P. Martins",
                "F. Maloberti"
            ],
            "title": "Nestedcurrent-mirror rail-to-rail-output single-stage amplifier with enhancements of DC gain, GBW and slew rate",
            "venue": "IEEE J. Solid-State Circuits, vol. 50, no. 10, pp. 2353\u20132366, Oct. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "K.H. Mak"
            ],
            "title": "A 0.7 V 24 \u03bcA hybrid OTA driving 15 nF capacitive load with 1.46 MHz GBW",
            "venue": "IEEE J. Solid-State Circuits, vol. 50, no. 11, pp. 2750\u20132757, Nov. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "S.-W. Hong",
                "G.-H. Cho"
            ],
            "title": "A pseudo single-stage amplifier with an adaptively varied medium impedance node for ultra-high slew rate and wide-range capacitive-load drivability",
            "venue": "IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 63, no. 10, pp. 1567\u20131578, Oct. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "Z. Yan",
                "P.-I. Mak",
                "R. Martins"
            ],
            "title": "Two stage operational amplifiers: Power and area efficient frequency compensation for driving a wide range of capacitive load",
            "venue": "IEEE Circuits Syst. Mag., vol. 11, no. 1, pp. 26\u201342, Jan./Mar. 2011.",
            "year": 2011
        },
        {
            "authors": [
                "Z. Yan",
                "P. Mak",
                "R.P. Martins"
            ],
            "title": "A 0.0045-mm2 32.4-\u03bcW twostage amplifier for pF-to-nF load using CM frequency compensation",
            "venue": "IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 62, no. 3, pp. 246\u2013250, Mar. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "M. Ho"
            ],
            "title": "A two-stage large-capacitive-load amplifier with multiple cross-coupled small-gain stages",
            "venue": "IEEE Trans. Very Large Scale Integr. (VLSI) Syst., vol. 24, no. 7, pp. 2580\u20132592, Jul. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "M.A. Mohammed",
                "G.W. Roberts"
            ],
            "title": "Conventional CMOS OTAs driving nF-range capacitive loads",
            "venue": "Proc. IEEE Int. Symp. Circuits Syst. (ISCAS), May 2021, pp. 1\u20135.",
            "year": 2021
        },
        {
            "authors": [
                "S. Guo",
                "H. Lee"
            ],
            "title": "Dual active-capacitive-feedback compensation for low-power large-capacitive-load three-stage amplifiers",
            "venue": "IEEE J. Solid- State Circuits, vol. 46, no. 2, pp. 452\u2013464, Feb. 2011.",
            "year": 2011
        },
        {
            "authors": [
                "Z. Yan",
                "P.I. Mak",
                "M.K. Law",
                "R.P. Martins"
            ],
            "title": "A 0.016-mm2 144-\u03bcW three-stage amplifier capable of driving 1-to-15 nF capacitive load with >0.95-MHz GBW",
            "venue": "IEEE J. Solid-State Circuits, vol. 48, no. 2, pp. 527\u2013540, Feb. 2013.",
            "year": 2013
        },
        {
            "authors": [
                "D. Marano",
                "A.D. Grasso",
                "G. Palumbo",
                "S. Pennisi"
            ],
            "title": "Optimized active single-Miller capacitor compensation with inner half-feedforward stage for very high-load three-stage OTAs",
            "venue": "IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 63, no. 9, pp. 1349\u20131359, Sep. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "A.D. Grasso",
                "D. Marano",
                "G. Palumbo",
                "S. Pennisi"
            ],
            "title": "Highperformance three-stage single-miller CMOS OTA with no upper limit of CL",
            "venue": "IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 65, no. 11, pp. 1529\u20131533, Nov. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "K.H. Mak"
            ],
            "title": "A 0.7 V 24 \u03bcA hybrid OTA driving 15 nF capacitive load with 1.46 MHz GBW",
            "venue": "IEEE J. Solid-State Circuits, vol. 50, no. 11, pp. 2750\u20132757, Nov. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "J. Riad",
                "J.J. Estrada-Lopez",
                "I. Padilla-Cantoya",
                "E. Sanchez-Sinencio"
            ],
            "title": "Power-scaling output-compensated three-stage OTAs for wide load range applications",
            "venue": "IEEE Trans. Circuits Syst. I, Reg. Papers, vol. 67, no. 7, pp. 2180\u20132192, Jul. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "M. Tan",
                "W.-H. Ki"
            ],
            "title": "A cascode Miller-compensated three-stage amplifier with local impedance attenuation for optimized complex-pole control",
            "venue": "IEEE J. Solid-State Circuits, vol. 50, no. 2, pp. 440\u2013449, Feb. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "W. Qu",
                "S. Singh",
                "Y. Lee",
                "Y.S. Son",
                "G.H. Cho"
            ],
            "title": "Design-oriented analysis for Miller compensation and its application to multistage amplifier design",
            "venue": "IEEE J. Solid-State Circuits, vol. 52, no. 2, pp. 517\u2013527, Feb. 2017.",
            "year": 2017
        },
        {
            "authors": [
                "X. Peng",
                "W. Sansen",
                "L. Hou",
                "J. Wang",
                "W. Wu"
            ],
            "title": "Impedance adapting compensation for low-power multistage amplifiers",
            "venue": "IEEE J. Solid-State Circuits, vol. 46, no. 2, pp. 445\u2013451, Feb. 2011.",
            "year": 2011
        },
        {
            "authors": [
                "S. Pourashraf",
                "J. Ramirez-Angulo",
                "A.J. Lopez-Martin",
                "R. Gonz\u00e1lez-Carvajal"
            ],
            "title": "A highly efficient composite class-AB-AB Miller op-amp with high gain and stable from 15 pF up to very large capacitive loads",
            "venue": "IEEE Trans. Very Large Scale Integr. (VLSI) Syst., vol. 26, no. 10, pp. 2061\u20132072, Oct. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "M. Mojarad",
                "M. Yavari"
            ],
            "title": "A low-power four-stage amplifier for driving large capacitive loads",
            "venue": "Int. J. Circuit Theory Appl., vol. 42, no. 9, pp. 978\u2013988, Sep. 2014.",
            "year": 2014
        },
        {
            "authors": [
                "S.A. Fordjour",
                "J. Riad",
                "E. Sanchez-Sinencio"
            ],
            "title": "A 175.2-mW 4-stage OTA with wide load range (400 pF\u201312 nF) using active parallel compensation",
            "venue": "IEEE Trans. Very Large Scale Integr. (VLSI) Syst., vol. 28, no. 7, pp. 1621\u20131629, Jul. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "M.A. Mohammed",
                "G.W. Roberts"
            ],
            "title": "Investigating the developments on the frequency compensation techniques of the two-stage OTAs\u2014A brief guide and updated review",
            "venue": "Proc. 31st Int. Conf. Microelectron. (ICM), Dec. 2019, pp. 219\u2013222.",
            "year": 2019
        },
        {
            "authors": [
                "B.Y. Kamath",
                "R.G. Meyer",
                "P.R. Gray"
            ],
            "title": "Relationship between frequency response and settling time of operational amplifiers",
            "venue": "IEEE J. Solid-State Circuits, vol. SC-9, no. 6, pp. 347\u2013352, Dec. 1974.",
            "year": 1974
        },
        {
            "authors": [
                "A. Sedra",
                "K. Smith"
            ],
            "title": "Microelectronic Circuits, 7th ed",
            "year": 2015
        },
        {
            "authors": [
                "R.J. Reay",
                "G.T.A. Kovacs"
            ],
            "title": "An unconditionally stable two-stage CMOS amplifier",
            "venue": "IEEE J. Solid-State Circuits, vol. 30, no. 5, pp. 591\u2013594, May 1995.",
            "year": 1995
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014 Capacitive load, compensation circuit, lowfrequency zeros, Miller R-C circuit, multi-stage, operational transconductance amplifiers, pole-zero pair, unity-gain frequency.\nI. INTRODUCTION\nOPERATIONAL Transconductance Amplifiers (OTAs)have enormous applications in analog and mixed-signal circuit design. Driving a wide range of Capacitive Loads (CL) (i.e., in the range of pF-to-\u03bcF) is one of these well-known applications where robust high Gain-Bandwidth Product (GBW) OTAs are required. Fig. 1(a) shows some applications where such wide range of CL is required [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11]. These applications have a set of different requirements that the CMOS OTAs must satisfy. For example, the approximated settling time requirements vs. CL of these applications [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11] can be seen in the shaded areas of Fig. 1(a). Other important parameters are also required, such as OTA\u2019s DC gain, power consumption, silicon area, etc.\nOn the other hand, since these applications are being fabricated using advanced nanometer CMOS technology nodes,\nManuscript received 17 March 2022; revised 24 June 2022 and 20 August 2022; accepted 15 October 2022. Date of publication 2 November 2022; date of current version 25 January 2023. This work was supported in part by the Natural Sciences and Engineering Research Council (NSERC) Discovery Grant and in part by the James McGill Research Chair Grant. This article was recommended by Associate Editor A. M. A. Ali. (Corresponding author: Mahmood A. Mohammed.)\nThe authors are with the Integrated Microsystems Laboratory, Department of Electrical and Computer Engineering, McGill University, Montreal, QC H3A 0E9, Canada (e-mail: mahmood.mohammed@mail.mcgill.ca; gordon.roberts@mcgill.ca).\nColor versions of one or more figures in this article are available at https://doi.org/10.1109/TCSI.2022.3216201.\nDigital Object Identifier 10.1109/TCSI.2022.3216201\nOTAs are facing challenges to achieve high DC gain values. Consequently, many CMOS OTA architectures have been proposed in the literature to meet the various design requirements to drive a wide range of CL while achieving adequate DC gain.\nDespite having stability challenges once configured in closed loop, cascading gain stages is believed by the authors to be the preferred method to achieve sufficient DC gain in modern CMOS technology processes operating with low voltage supply levels [12], [13]. Fig. 1(b) shows the cascading scheme of N gain-stages to achieve high DC gain. Ultimately, such OTAs are configured in a closed loop as also seen in Fig. 1(b), where the output voltage (VO(t)) must remain bounded. To easily discuss the previously reported works, one can categorize them based on the number of gain stages placed in cascade and evaluate their CL-drivability ratio (i.e., CL,max/CL,min).\nSingle-stage and 2-stage CMOS amplifiers are relatively easy to stabilize, but their DC gain is limited in advanced node CMOS technologies. Many works have managed to demonstrate single- and 2-stage CMOS amplifiers with wide CLs [14], [15], [16], [17], [18], [19], [20], [21]. However, they all make use of additional circuit techniques to achieve adequate DC gain while handling such CL. In the case of single-stage amplifiers, the maximum-reported CL-drivability ratio is 150\u00d7 [17]. In the case of 2-stage OTAs, the maximum CL-drivability ratio is 1000\u00d7 [18].\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\nMOHAMMED AND ROBERTS: SCALABLE MULTI-STAGE CMOS OTAs WITH A WIDE CL-DRIVABILITY RANGE 75\nConsequently, to achieve both the load driving capability and the DC gain requirement, most works found in the literature deploy 3-stage amplifiers [22], [23], [24], [25], [26], [27], [28], [29], [30], [31]. With these extensive works on 3-stage amplifiers, stability is ensured through different Frequency Compensation Techniques (FCTs), such as nestedMiller compensation (NMC) [22], single-Miller capacitor (SMC) [23], [24], [25], and capacitor-free compensation techniques [26], [27], to name just a few. However, the maximum CL-drivability ratio that has been reported in literature with 3-stage amplifiers is 555.5\u00d7 [27].\nAs for 4-stage CMOS amplifiers, they can provide higher DC gains, but once they are configured in closed-loop, they are a challenge to stabilize. Therefore, only a few works have proposed 4-stage designs to drive a wide range of CLs, such as [32] and [33]. However, the maximum CL-drivability ratio was limited to 30\u00d7 [33]. To the best of the author\u2019s knowledge, there is no reported 5-stage OTA with a wide CL-drivability.\nLooking at the previously reported works on OTAs/ amplifiers driving a wide range of CLs [14], [15], [16], [17], [18], [19], [20], [21], [22], [23], [24], [25], [26], [27], [28], [29], [30], [31], [32], [33], and regardless of the number of stages, one can conclude the following: (1) previously reported works are proposing FCTs which are suitable for OTAs with specific number of stages and/or circuit topologies, and (2) the proposed OTAs\u2019 maximum CL is limited to the nF-range. Thus, the proposed FCTs have the following limitations: (1) they are specific to the chosen topology, and/or the number of stages placed in cascade, consequently, they cannot offer different choices for DC gain and power consumption and (2) they cannot be used in applications with capacitive loads CL in the \u03bcF-range.\nTherefore, in this work a new FCT is proposed to enable cascading multiple gain-stages while driving an ultra-wide range of capacitive loads. The proposed FCT is ideally applicable to N-stage CMOS OTAs, which offers wider design choices for DC gain and power consumption. However, for simplicity and as a proof of concept, 2-, 3-, 4- and 5-stage CMOS OTAs are demonstrated in this work. Furthermore, the proposed FCT uses a multi-Miller R-C compensation circuit across the gain stage to position the Pole-Zero Pair (P-ZP) created by the R-C compensation networks below the unity-gain frequency (\u03c9t ) of the compensated OTAs. On doing so, the P-ZP will increase \u03c9t of the compensated OTA once the zeros are positioned at low frequencies. The additional increase in \u03c9t can be traded off for higher CL by placing the dominant pole at higher frequencies.\nThis paper is structured as follows: the overall proposed idea is presented in Section II. In Section III, the design choice for the gain-stages is introduced. In Section IV and V, the detailed implementation of the proposed FCT is discussed. In Section VI, verification of the proposed technique is discussed based on schematic and post-layout simulations. Section VII shows the experimental results and robustness of the proposed FCT, while Section VIII compares the proposed 2-, 3-, and 4-stage OTAs with the state-of-the-art works. Finally, Section V concludes the work presented in this paper."
        },
        {
            "heading": "II. CASCADING MULTI-STAGE CMOS OTAS AND INCREASING THEIR CL-DRIVABILITY: THE OVERALL PROPOSED IDEA",
            "text": "The proposed design of the scalable multi-stage CMOS OTA, shown in Fig. 1(b), consists of cascaded-gain stages\nwhich can achieve an overall DC gain (ADC,N) of\nADC,N = N\u220f\ni=1 (Ai ), (1)\nwhere Ai is the gain provided by the i th gain stage and N is the number of gain-stages. On the other hand, and since this is a CMOS-based OTA, poles and zeros will be part of the OTA\u2019s realization. Usually, in such OTAs, in addition to the 3-dB frequency, each gain stage will produce a P-Z Pair. Therefore, the open-loop input-output Transfer Function (TF) takes on a cascade of bilinear forms as follows\nA (s) = ADC,N( 1 + s\u03c9P0 ) \u00d7 N\u22121\u220f i=1\n( 1 + s\u03c9Zi ) (\n1 + s\u03c9Pi ) , (2)\nwhere \u03c9P0 is the 3-dB frequency, \u03c9Pi and \u03c9Zi are the openloop P-Z pairs which are produced by the compensation circuit of each stage.\nThe diagram of Fig. 1(b) and its bilinear TF of Eqn. (2) can be realized by using the differential-ended circuit level implementation of Fig. 2. The gm-blocks will be responsible for achieving the required DC gain, while the R-C compensation networks (which are connected across each stage) will properly place the open-loop P-Z pairs at the required frequencies.\nThe purpose of the proposed architecture is to provide a uniform scalable DC gain while driving a wide-range of capacitive loads. Therefore, all gain-stage will be designed to achieve the same Ai. However, for such cascading of multi gain-stages to be stable and to allow the OTA to drive a wide range of CLs (regardless of the number of gain stages) a new FCT is proposed in this work using low-frequency zeros. It is the application of these low frequency zeros that make this work unique in the field of OTA design."
        },
        {
            "heading": "A. The Use of Low-Frequency Compensation Zeros",
            "text": "The objective of the proposed FCT is to identify the placement of the proposed scalable multi-stage OTA\u2019s poles and zeros, so that the load-drive capability and unity-gain bandwidth are maximized (while the OTA is exhibiting a stable closed-loop response). This is further constrained by requiring the settling time of a unity-gain closed-loop configuration be bounded by some desired value denoted by TDS . This can be mathematically expressed as follows:\nmaximize: subject to:\n{\u03c9t and CL} \u2192 {TS < TDS }. (3) Solving this problem will lead to an OTA with a higher GBW and greater CL driving capability. It is important to"
        },
        {
            "heading": "76 IEEE TRANSACTIONS ON CIRCUITS AND SYSTEMS\u2014I: REGULAR PAPERS, VOL. 70, NO. 1, JANUARY 2023",
            "text": "note that this problem includes both small and large-signal effects. Eqn. (3) contains a two-dimensional objective function involving \u03c9t and CL, which are inversely inter-dependent. That is, if CL increases, \u03c9t decreases. This makes it difficult to identify the maximum. Instead, this optimization problem is performed in two steps using the following sequential, noniterative procedure. The first step is to solve the problem expressed as\nmaximize: subject to:\n{\u03c9t } \u2192 {CL,min = 0.5 pF}. (4) This can be performed using a small-signal AC analysis, so it takes very little time to perform with a transistorlevel simulation. This step places the poles and zeros at desired frequency locations for maximum unity-gain frequency while having the minimum required capacitive load, CL,min, (say 0.5 pF). Next, a transient analysis is performed on the OTA in a closed-loop configuration subject to an input step Vin with different load conditions, i.e.\nmaximize: subject to: {CL} \u2192 {TS < TDS for input step = Vin} (5) While this approach can be executed in a sequential, noniterative manner, the result may not be optimal but orders of magnitude simpler to implement with excellent results.\nConsequently, to satisfy Eqn. (4) and (5), the proposed FCT positions the open-loop P-Z pairs of Eqn. (2) at frequencies below \u03c9t and above \u03c9P0, without being excluded or canceled (i.e., unlike conventional FCTs [34]), such that\n\u03c9P0 < \u03c9z1 < \u03c9P1 < . . . < \u03c9zi < \u03c9Pi < \u03c9t . (6)\nBased on the P-Z pair arrangement in Eqn. (6), \u03c9t can now be maximized (to satisfy Eqn. (4)) where it is no longer equal to the GBW (as it is usually the case in conventional FCTs) but it is now given by\n\u03c9t = ADC,N \u00d7 \u03c9P0 \u00d7 N\u22121\u220f i=1\n( \u03c9Pi\n\u03c9Zi\n) . (7)\nAccording to Eqn. (7), the lower the zeros\u2019 frequencies the higher \u03c9t is; hence the higher CL is for a desired settling time.\nInterestingly, having open-loop P-Z pairs below \u03c9t creates P-Z doublets in closed-loop. It was shown [35] that the closedloop P-Z doublet deteriorates the OTA\u2019s settling time. Therefore, such P-Z pairs\u2019 arrangement has not been introduced in the literature before. However, a fundamental theory has been introduced in [12] revealing that the impact of the P-Z doublets on the settling time of CMOS OTAs can be minimized by positioning the open-loop zeros (i.e., \u03c9Zi ) at low frequencies provided there is sufficient DC gain. Consequently, this theory revealed untapped opportunities to cascade many gain stages, which will be exploited in this work.\nSince the objective of the proposed FCT is to identify the positions of the OTA\u2019s poles and zeros according to Eqn. (6), it is required to identify what governs these poles and zeros from the circuit level realization\u2019s perspective. Once these relationships are identified, the detailed steps of implementing the proposed FCT can be easily revealed."
        },
        {
            "heading": "III. THE CIRCUIT LEVEL IMPLEMENTATION OF THE PROPOSED SCALABLE MULTI-STAGE CMOS OTAS",
            "text": "The proposed design of the scalable multi-stage CMOS OTA, shown in Fig. 2, consists of a differential input-stage, cascaded by many identical gain-stages. Fig. 3 shows the transistor level implementation of the differential stage, which serves as the first stage (i.e. M1 \u2013 M5), followed by identical common-source (CS) gain-stages (the second stage consists of M6,2 and M7,2 while subsequent stages consist of transistors identical to them, i.e., M6,3 and M7,3, \u2026, M6,N and M7,N).\nHaving a differential pair followed by CS gain stages is a conventional way to configure OTAs. However, when N = 2, this particular OTA has long been assumed to be limited to applications with pF-range loads [36]. Here, through employing the proposed FCT on this circuit, it will be shown that it can increase its CL-drivability up to the nF-range. Also, when N = 3, similar architectures have been described in the literature having a Nested-Miller Capacitor (NMC), as in [22], to help stabilize the OTA. Interestingly, this NMC is of no use in the proposed design technique, and this will contribute to having an area-efficient OTA design. Moreover, using this conventional architecture will show that the proposed FCT is unconstrained by a specific OTA circuit topology.\nAs mentioned earlier, the purpose of the proposed architecture is to provide a uniform scalable DC gain, where each gain-stage will produce the same DC gain. Hence, all gain\nMOHAMMED AND ROBERTS: SCALABLE MULTI-STAGE CMOS OTAs WITH A WIDE CL-DRIVABILITY RANGE 77\nstages will be biased at the same voltage, and all transistors\u2019 sizes of the CS gain stages will be identical. However, one can design the gain stages to have different DC gains and get a non-uniform increase in ADC without increasing the compensation effort.\nThese gain stages are biased with the current mirror transistors MCM, M5 and M7,i. However, to ensure proper biasing of the output voltages, the Common-Mode Feedback (CMFB) circuits of Fig. 4 have been included in the design. These CMFB circuits are based on standard techniques as described in [36] and [37]. If the 2-stage OTA is to be designed, then the CMFB circuit of Fig. 4(a) is to be used, and the CMFB voltage (VCMFB) is to be created at the drain of MC1. But if N = 3 (i.e., the 3-stage OTA is to be designed), VCMFB is created at the drain of MC2 (in Fig. 4(a)). When more than three gain-stages are required, the DC gain will significantly increase, thus, the CMFB circuit of Fig. 4(a) will not be able to hold the biasing voltages at the output of all gainstages. Therefore, an extra CMFB circuit will be used to keep the biasing voltages of these additional gain-stages within the required values. Fig. 4(b) shows the extra CMFB circuit that will be included when N \u2265 4. In this case, the CMFB circuit of Fig. 4(a) will be connected at the differential output of the 3rd gain-stage, while the CMFB circuit of Fig. 4(b) will be connected at the differential output of each new gain-stage (i.e., N \u2265 4).\nNow, to identify the exact DC gain equation of the proposed OTA, the small signal model is to be discussed."
        },
        {
            "heading": "A. The Small-Signal Model of the Proposed OTA",
            "text": "Fig. 5 shows the ideal single-ended small-signal model of the circuit level realization seen in Fig. 2. From circuit theory, one can identify that the small-signal low-frequency gain of each stage is (gm \u00b7RO ). Therefore, the overall DC gain, ADC,N , can be expressed as\nADC,N = N\u220f\ni=1 (gm,i RO,i ) (8)\nwhere gm,i is the transconductance of each stage, RO,i is the output resistance of each stage.\nThe first step in the proposed design technique involves setting the voltage gain of the OTA to some desired value. This will pin-down the required sizes of all transistors to meet power consumptions and overdrive voltage requirements. Also, this step will define the values of the small-signal parameters (i.e., gm,i and RO,i ) of all stages.\nOnce gm,i and RO,i are defined, the multi-Miller R-C compensation circuits will control the positions of the openloop P-Z pairs. Interestingly, positioning the poles and zeros is not limited to the use of Miller R-C compensation circuits, as other compensation schemes can also be used for this purpose.\nAccording to the TF of Eqn. (2), the OTA will have a different number of poles and zeros based on the designer\u2019s choice for N . For example, if N = 2, one can identify that the 2-stage OTA has three poles and one zero. Typically, only twopoles of this circuit are of concern, as the third is assumed to be at a frequency much higher than \u03c9t . As a result, the frequency locations of the two-poles and the zero are approximated based on some assumptions as follows [36], [37]:\n\u03c9P0 \u2248 gm,2CC1 CO,1CL + CC ( CO,1 + CL ) \u2248 gm,2 CL\n(9)\n\u03c9P1 \u2248 1 gm,2 RO,1 RO,2CC1\n(10)\n\u03c9Z1 \u2248 \u2212 (\ngm,2 CC1\n) 1(\n1 \u2212 gm,2 RC,1 ) (11)\nThe third pole at \u03c9P_par - typically ignored in the analysis - has an important design value in the proposed theory and needs to be considered here. It can be approximated by [37]:\n\u03c9Ppar \u2248 1 RC1CO,1\n(12)\nwhere CO,1 represents the total shunt capacitance to ground on the output node of the first stage of the OTA and it consists of numerous parasitic elements.\nSince the R-C compensation circuits are creating paths between the inputs and outputs of all gain-stages, coupling between stages and correlation between the poles and zeros\u2019 positions will occur. Therefore, apart from the two-stage OTA, identifying the exact positions of poles and zeros and/or deriving their exact expressions (using the R-C compensation circuit of Fig. 3) is limited. Also, due to the existence of the parasitic capacitances (i.e., CO,1, CO,2, \u2026, and CO,N-1), parasitics poles will also exist and they will also correlate with the open-loop P-Z pairs. In addition, relying on the exact equations of poles and zeros will require re-defining them whenever a new stage is added, hence re-designing the R-C compensation circuit with the addition of each new gain-stage. This will highly complicate the design process. Moreover, adding the CMFB circuits of Fig. 4 to the small-signal model to derive the exact poles and zeros\u2019 equations will add a new complexity dimension.\nConsequently, to avoid the complexity of using the exact poles and zeros\u2019 equations, a scalable FCT is proposed in this work. The proposed FCT starts by designing the compensation circuit of the 2-stage OTA first to satisfy Eqn. (4). This is achieved by adjusting RC1,(2\u2212stage.) and CC1,(2\u2212stage.) such that \u03c9Z1 is positioned at low frequency (LF) so that \u03c9t is increased, provided it meets certain conditions (to be described later)."
        },
        {
            "heading": "78 IEEE TRANSACTIONS ON CIRCUITS AND SYSTEMS\u2014I: REGULAR PAPERS, VOL. 70, NO. 1, JANUARY 2023",
            "text": "Then, the proposed FCT will scale the R-C compensation circuit for higher stages while maintaining sufficient values for \u03c9t . Finally, the proposed FCT follows Eqn. (5) to increase CL-drivability of the proposed OTAs for a desired settling time. These steps will be clarified in the following sections.\nIV. IMPLEMENTATION OF THE PROPOSED FCT - STEP (1): INCREASE \u03c9t UNDER SMALL CL USING LF-ZEROS\nConventional FCTs are usually applicable for specific number of stages and/or specific OTAs\u2019 circuit topologies. However, the proposed FCT has the advantage of being ideally applicable to N-stage CMOS OTAs, as well it is not constrained by any specific circuit topology, and it is technology independent. Therefore, the key idea of this work is to accurately perform the proposed FCT which is described by Eqn. (4) and Eqn. (5). In this section we shall start by following the technique described by Eqn. (4) to design the 2-stage OTA of Fig. 3, then scale it for higher stages.\nA. Implementation of the Proposed FCT Having N = 2 The starting point in implementing the proposed FCT is to begin with a two-stage OTA, thus, Eqs. (9) - (12) will govern the positions of \u03c9P0, \u03c9P1, \u03c9Z1, and \u03c9P_par , respectively.\nUsually, in conventional 2-stage OTAs, where Miller R-C compensation networks are used, stability is ensured by positioning \u03c9P1 at low frequencies (by increasing the value of CC1) and placing \u03c9P0 and \u03c9Z1 at frequencies above \u03c9t or by positioning them at the exact same frequency to achieve a pole-zero cancellation [34]. Thus, \u03c9t in such conventional designs is the GBW, and will be referred to (here) as: \u03c9t,re f . Fig. 6(a) shows the magnitude response (i.e., black-dashed line) of such conventional designs, where \u03c9t,re f is given by\n\u03c9t,re f = ADC,2\u03c9P1. (13) However, relying on large values of CC1 to compensate for the 2-stage OTA will slow down the OTA\u2019s response, increase the silicon area, and most importantly, prevent the R-C compensation circuit from being scaled for higher stages as will be discussed in the next subsection.\nConsequently, the proposed FCT adapts a different arrangement of poles and zeros to enhance \u03c9t while having\na small CL (CL,min) (i.e., say 0.5 pF); hence, Eqn. (13) will be extended to accurately express the new proposed arrangement of the poles and zeros. Then, the additional increase in \u03c9t can be traded off for higher CL.\nAccording to Eqn. (13), it should be obvious that the value of \u03c9t,re f can be increased by increasing ADC,2 and/or \u03c9P1. However, ADC,2 has already been pre-defined, consequently, increasing \u03c9t,re f is simply achieved by increasing \u03c9P1, or in other words; by reducing the value of CC1 according to Eqn. (9). The new position of \u03c9P1 after reducing CC1 is shown (in blue) in Fig. 6(a). Interestingly, pushing \u03c9P1 to higher frequencies, by reducing CC1 will allow \u03c9P0 to become the 3-dB pole of the OTA instead of \u03c9P1 (i.e., \u03c9P0 mainly depends on gm,2 and CL). This will become useful when increasing the CL-drivability in the next section. However, reducing the value of CC1 alone is a bad design practice because it will alter the stability of the OTA as \u03c9P1 will move towards \u03c9P0, and at the same time, \u03c9Z1 will be shifted to higher frequencies (i.e., as depicted by Eqn. (11)). Therefore, the gain roll-off will drop to values around \u221240 dB/dec, and thus, the Phase Margin (PM) will also drop. But, if one can properly re-position \u03c9Z1 (after reducing CC1) according to Eqn. (6), \u03c9Z1 will counteract the effect of the two poles on the gain-roll off and the PM. As a result, the stability issue can be controlled and the new expression of \u03c9t can be seen in Eqn. (7).\nTo re-position \u03c9Z1 according to Eqn. (6) and shift it from higher to lower frequencies as seen in Fig. 6(a), one can use a large RC (i.e., \u223c k ). As a result, the impact of the proposed FCT in this 1st step, compared to the conventional design, is shown in the AC response of Fig. 6(a).\nSince ADC,2 is pre-defined, and \u03c9P0 is almost independent of the R-C network, Eqn. (7) indicates that the maximum value of \u03c9t (i.e., near-optimum) can be achieved, ideally, by increasing \u03c9P1 while decreasing \u03c9Z1. However, the limitation of the upper value of \u03c9t is \u03c9Ppar , seen in Eqn. (12) and Fig. 6(a); as there is no full-design control over this parasitic pole. Also, increasing \u03c9P1 while decreasing \u03c9Z1 should be done so that the PM is greater than some desired value. For example, to obtain a PM of 60\u25e6, one can arrange the poles and zeros as shown in the AC phase response of Fig. 6(b). Here, the PM is\nP M = 180 \u2212 N\u22121\u2211 i=1 \u03b8P,i + N\u22121\u2211 i=1 \u03b8Z ,i , (14)\nwhere \u03b8P,i is the phase of the i th-pole and \u03b8Z ,i is the phase of the i th-zero.\nTo achieve this at the circuit level, one can start with the minimum possible value of CC1 given by a certain CMOS technology (i.e., slightly higher than CO,1). Then, RC (\u223c k ) is increased in value to achieve the required PM so that \u03c9t \u2264 \u03c9Ppar , or until the value of RC becomes impractical in the given CMOS technology. This will allow the R-C circuit to occupy a small-silicon area. Accordingly, with this, the 1st step of the design process, described by Eqn. (4), would have now been completed for N = 2."
        },
        {
            "heading": "B. Scaling the Two-Stage R-C Compensation Circuit for",
            "text": "N \u2265 3 Under CL ,min\nTo design the 3-stage OTA, a new gain-stage is added to the 2-stage OTA as depicted in Fig. 2 and Fig. 3. Also, to design a 4-stage OTA, two gain-stages are added to the 2-stage OTA, and so on. Each new gain-stage comes with its own compensation circuit. Consequently, a new P-Z pair\nMOHAMMED AND ROBERTS: SCALABLE MULTI-STAGE CMOS OTAs WITH A WIDE CL-DRIVABILITY RANGE 79\nwill be added to the TF with each new stage as described in Eqn. (2). Also, according to Eqn. (7), \u03c9t will significantly increase, as ADC,N will also increase. However, this new value of \u03c9t will most likely exceed the previously defined upper limit of \u03c9t , and parasitic pole at \u03c9Ppar will impact the OTA\u2019s PM. Therefore, it would be necessary to re-adjust the value of \u03c9t by re-positioning the poles and the zeros, according to Eqn. (6), whenever a new stage is added to keep \u03c9t \u2264 \u03c9Ppar . This can be done by re-sizing the R-C circuit with the addition of each new stage.\nInstead of deriving new equations for the poles and zeros for each stage separately, and by knowing that the P-Z pairs have an inverse relationship with RC and CC, the values for CC which was found for the 2-stage OTA can be adjusted according to the constraint equations listed below [12]:\nCC(i\u22121),(N\u2212stage) = CC(i\u22122),[(N\u22121)\u2212stage], 3 \u2264 i \u2264 N (15)\nand\nCCi,(N\u2212stage) > CCi,[(N\u22121)\u2212stage], 1 \u2264 i \u2264 N \u2212 1. (16) While the RCs can be sized in the opposite manner described by the following two constraint equations [12]:\nRCi,(N\u2212stage) \u2264 RCi,[(N\u22121)\u2212stage], 1 \u2264 i \u2264 N \u2212 1 (17) and\nRC(N\u22121),(N\u2212stage) \u2264 RC(N\u22122),(N\u2212stage). (18) Thus, the new compensation capacitor (CC(N\u22121),(N\u2212stage)) is sized to the minimum capacitance value, which was found for the 2-stage OTA (i.e., CC(N\u22121),(N\u2212stage) = CC1,(2\u2212stage)). This highlights the difference between the proposed technique and the conventional methods that rely on large CC1 values to realize 2-stage CMOS OTAs.\nSince the constraint equations in (15)-to-(18) show an intuitive technique of sizing the R-C compensation circuits for N \u2265 3, and since there is no need for exact positioning of the poles and zeros, one can slightly tweak these patterns to\nenhance the open-loop and closed-loop responses if necessary. For example, such tweaking can be done if an exact PM of 60\u25e6 is required under CL,min of 0.5 pF. Although such re-sizing of the R-C circuits is not considered systematic, an algorithm can be applied to meet the pole-zero constraints of Eqn. (6).\nAt this point the proposed scalable N-stage CMOS OTA is compensated to drive CL,min under the required PM.\nV. IMPLEMENTATION OF THE PROPOSED FCT - STEP (2): MAXIMIZE CL FOR A DESIRED SETTLING TIME\nSince the design achieved through Step (1) is transferring the dependency of the dominant pole to \u03c9P0 (i.e., CL,min), one should distinguish between compensating the OTAs with CL only and the proposed FCT. Interestingly, one can remove the R-C compensation circuit and rely only on CL to position \u03c9P0 below \u03c9t while leaving the P-Z pairs (i.e., \u03c9P1, \u03c9Z1, \u03c9P2, \u03c9Z2 \u2026\u03c9Pi and \u03c9Zi ) uncontrolled. On doing so, the stability can be achieved once CL,min is increased such that \u03c9t is shifted to frequencies much lower than the P-Z pairs. However, this technique is associated with some important drawbacks. First, this technique is technology dependent, in other words; leaving the P-Z pairs uncontrolled, will allow the parasitic capacitances (which are technology dependent) to decide their frequency positions. Second, this technique will work, if and only if, a large CL,min is required (i.e., in the range of tens of nano-Farads). Also, this large CL,min is increasing with the addition of extra gain stages, due to the increase in ADC,N (i.e., \u03c9t ). For these reasons and others, this dependency of the dominant pole on CL has been claimed to be a bad design practice in [38]. Nevertheless, this will not be an issue in the proposed FCT, since the P-Z pairs have already been positioned at the required frequencies. Consequently, one can define the range of CL that prevents the P-Z pairs from alternating the OTA\u2019s stability. To easily capture the shortage of relying on CL only to compensate the OTA, and to clearly discuss the advantages of the proposed FCT in increasing CL-drivability of the proposed OTA, Fig. 7 introduces the relationship between the PM and CL."
        },
        {
            "heading": "80 IEEE TRANSACTIONS ON CIRCUITS AND SYSTEMS\u2014I: REGULAR PAPERS, VOL. 70, NO. 1, JANUARY 2023",
            "text": "The PM is an open-loop parameter that can indicate the closed-loop step response behavior. Fig. 7 shows how the PM is changing with the increase in CL based on different scenarios of positioning the OTA\u2019s poles and zeros in the proposed FCT. Accordingly, it indicates the behavior of the closed-loop step response. Also, one can use Gain Margin (GM) to indicate the closed-loop behavior as will be done while verifying the proposed OTA designs.\nSince the design achieved through Step (1) was still loaded with a very small CL (i.e., CL,min = 0.5 pF) and achieved a sufficient PM (say 60\u25e6), one can carry on from this point and investigate the impact of increasing CL on the PM. According to Eqn. (9), increasing CL,min will result in shifting \u03c9P0 to lower frequencies, thus, shifting \u03c9t to lower frequencies as well. As can be seen in Fig. 7, this will create three different regions based on the new positions of \u03c9t with respect to the P-Z pairs. In each region the impact of increasing CL on the PM will depend on the position of \u03c9Zi with-respect-to \u03c9Pi , thus, three cases will be created in each region. To clarify this, let\u2019s consider the cases when N = 2, and discuss the PM behavior in these three regions based on the position of \u03c9Z1 and \u03c9P1."
        },
        {
            "heading": "A. Region (1): \u03c9t > P-Z Pairs",
            "text": "This region starts at CL,min, where the OTA exhibits a stable response (as discussed in Step (1) of the proposed FCT) and the P-Z pairs are positioned below \u03c9t . As CL increases, \u03c9t moves towards the P-Z pair and a slight drop in the PM will occur. However, this will not affect the closed-loop response as the PM \u2265 45\u25e6. Therefore, the impact of positioning \u03c9Z1 with-respect-to \u03c9P1 will not impact the OTA\u2019s stability in this region. Nonetheless, it is recommended to achieve sufficient values for PM in Step (1) (i.e., PM \u2265 60\u25e6) to expand this region as much as possible. This can be done by positioning \u03c9Z1 at low frequencies.\nIn this region, one can clearly distinguish between the proposed FCT and the conventional techniques that depend on CL only (i.e., the dashed-dotted black line in Fig. 7), where stability cannot be ensured at small values of CL."
        },
        {
            "heading": "B. Region (2): \u03c9t \u223c P-Z Pairs",
            "text": "Once increasing CL to higher values, such that \u03c9t will be located slightly above, in between, or slightly below the P-Z pair, the impact of positioning \u03c9Z1 with-respect-to \u03c9P1 will become significant. In other words, according to Eqn. (14), if \u03c9Z1 is positioned at low frequency (i.e., Case (1): \u03c9Z1 < \u03c9P1), it will compensate the PM drop that will be caused by \u03c9P1, and the PM will be kept above 45\u25e6 (i.e., the solid-blue line in Fig. 7 is always within the blue shaded area). However, \u03c9Z1 will have less impact on the PM if it is positioned slightly above \u03c9P1 (i.e., Case (2): \u03c9Z1 \u2265 \u03c9P1). Consequently, the PM might drop to values below 45\u25e6 and above 10\u25e6 (i.e., the dashed-red line is entering the light-redshaded area in Fig. 7). Nonetheless, the step response will exhibit a stable underdamped behavior, which will be seen as an increase in settling time. However, if \u03c9Z1 \u03c9P1 (i.e., Case (3)), the PM drop (with the increase in CL) might reach values below 10\u25e6, hence, the step response will become unstable within a specific range of CL (i.e., the dotted-green line will enter the green-shaded area between CL,1 and CL,2 in Fig. 7). Consequently, Case (3) shows the worst case of stability with the proposed technique. Although the step\nresponse might exhibit a stable response for 0\u25e6 \u2264 PM \u2264 10\u25e6, it is assumed unusable in Fig. 7 (i.e., the dark-red shaded area) as it will be associated with excessive ringing [39].\nInterestingly, further increase in CL, within Region (2), will allow \u03c9t to be at frequencies lower than the P-Z pair, thus, the PM will start increasing toward 90\u25e6.\nDespite having a stable response for 10\u25e6 \u2264 PM \u2264 45\u25e6, the amount of ringing might introduce untolerated noise for some applications. Therefore, the P-Z pairs must be optimized for such applications by setting the local minimum PM (PM,min) to a given value (say 45\u25e6) for a range of CLs. If the PM,min cannot be achieved, then the proposed OTA might not be suitable for the given application."
        },
        {
            "heading": "C. Region (3): \u03c9t P-Z Pairs",
            "text": "Once the PM reaches 90\u25e6, the proposed FCT reaches its definition for the maximum capacitive load (CL,max), because at PM = 90\u25e6, the R-C compensation circuits will have no more impact on the PM, and CL will compensate the OTA. Accordingly, one can define CL-drivability ratios as\nCL\u2212drivabilit y = \u23a7\u23aa\u23aa\u23a8 \u23aa\u23aa\u23a9 CL ,max CL ,min , Case (1) and (2)\nCL ,max CL ,min \u00d7 CL ,1 CL ,2 , Case (3).\n(19)\nSince the P-Z pairs will have no impact on \u03c9t in this region, the unity-gain frequency will be referred to as \u03c9t, f inal (seen in Fig. 7) and it can be written as: (ADC,N\u03c9P0). Also, the step response will follow a single-time-constant behavior.\nApparently, the proposed OTA will exhibit a stable response once increasing CL beyond CL,max, where the PM will always be \u223c 90\u25e6, but it will not be included in the discussion to avoid confusing the proposed FCT with conventional ones."
        },
        {
            "heading": "D. Settling Time Requirements",
            "text": "According to Eqn. (5), the objective of this section is to define the range of CL that corresponds to a desired settling time. Since the design achieved through Step (1) was still loaded with a very small capacitance (i.e., CL,min = 0.5 pF), the settling time (TS,initial) of the closed-loop amplifier would be very short. Indeed, it is assumed to be much shorter than the desired settling time T DS , and hence an increase in settling time can be traded-off for a higher CL. Knowing that T DS is widely varying based on the required application, as seen in Fig. 1(a), one can define a range of CL\u2019s that corresponds to a range of different settling time values by searching on the step response of the closed-loop amplifier beginning with CL,min. This can be simply done by increasing CL, starting from CL,min, until the desired settling time is reached, as long as CL \u2264 CL,max. At this point, the desired CL (CL,desired) can be identified. Here, Vin can be driven with a step input whose magnitude can be in the small or large-signal range. There are no constraints on the input condition.\nIncreasing CL, starting from CL,min, will result in different closed-loop responses based on the P-Z pair\u2019s positions, as can be seen on the right-hand side of Fig. 7. Therefore, Fig. 8 builds on these different cases for positioning the P-Z pairs and indicates the relationship between settling time and CL. Here one sees three curves of settling time TS vs. CL\nMOHAMMED AND ROBERTS: SCALABLE MULTI-STAGE CMOS OTAs WITH A WIDE CL-DRIVABILITY RANGE 81\nfor different P-Z pairs\u2019 positions and maximum CL conditions. It should be noted here that curves of TS vs. CL are nonlinear.\nFor all scenarios of positioning the P-Z pairs, settling time is increasing with the increase in CL, however, when \u03c9Z1 < \u03c9P1 the OTA will exhibit faster closed-loop response as the region of underdamped behavior will not be entered (this is shown in the solid-blue line in Fig. 7 and also seen as the solid-blue line of Fig. 8). As for \u03c9Z1 \u2265 \u03c9P1 and \u03c9Z1 \u03c9P1, the closed-loop response will be partially experiencing stable-underdamped response (as seen in Fig. 7); which will result in slower settling times. Consequently, for the same T DS the case of positioning \u03c9Z1 at low frequencies will achieve higher CL-drivability, as CL,desired will be larger (i.e., CL,desired,3 > CL,desired,2 > CL,desired,1 in Fig. 8). But, for the case when \u03c9Z1 \u03c9P1 (i.e., green-dotted line of Fig. 8) the OTA will not be stable between CL,2 and CL,1 as the PM might drop to values below 10\u25e6 (the green-shaded area of Fig. 7). Clearly, the benefit of adding zeros at LFs is to boost \u03c9t and PM. This will also allow increasing CL while still achieving sufficient GBW. However, it is the GBW that will define the speed of the proposed OTAs and not necessarily the boosted \u03c9t .\nIf the CL range between CL,min and CL,max does not meet the requirements on T DS , one can re-adjust the reference design of the OTA by optimizing the biasing voltages and the transistors\u2019 aspect ratios. Consequently, the R-C compensation circuits are to be re-designed according to the proposed FCT. If this still does not allow the proposed technique to meet the requirements on T DS , then the proposed OTA is not suited for the given application.\nVI. VERIFICATION OF THE PROPOSED DESIGN TECHNIQUE\nFollowing the steps in Eqs. (4) and (5), and the detailed procedure of section IV and V, the OTA of Fig. 3 has been designed to achieve a scalable DC gain while driving a wide range of CLs. The standard TSMC 65 nm CMOS process has been used to design this OTA with a supply voltage (VDD) of 1 V. Lower VDD values can still be used to drive the proposed OTAs while still achieving sufficent open-loop and closed-loop performances. However, since the goal here is to verifiy the proposed design technique, a nominal VDD value of 1 V will be used. Also, Cadence CAD tools have been used for all simulation investigations. Despite being applicable to N-stage OTAs, the proposed FCT will be verified using 2-, 3-, 4- and 5-stage OTAs.\nFirst, each gain stage has been designed to achieve a DC gain of about 25 dB, thus, the 2-, 3-, 4- and 5-stage OTAs of Fig. 3 are providing a post-layout ADC of 51.18 dB, 77.2 dB, 92 dB, and 110 dB, respectively. To achieve this, the gain stages have been biased with gate voltages at about 0.5 V (i.e, VD D / 2) and the CS gain stages are designed\nto be identical (but different than the Diff. Stage) with the sizes shown in Fig. 3. Also, the current source transistors (i.e., M5 and M7,i) are biased at IB I AS \u2248 6 \u03bcA. Consequently, simulation results show that gm,M2 = 112.2 \u03bcA/V, gm,M4 = 113.6 \u03bcA/V, gm,M6 = 540.9 \u03bcA/V, gm,M7 = 695.7 \u03bcA/V, rO,M2 = 70.23 k , rO,M4 = 68.4 k , rO,M6 = 11.96 k , and rO,M7 = 12 k .\nFor the 2- and 3-stage OTA, the CMFB circuit of Fig. 4(a) has been used, while the CMFB circuit of Fig. 4(b) has also been added for the 4-stage OTAs with IBIAS_1 \u2248 3 \u03bcA, while VBIAS_2 has been connected to VB I AS to reduce the number of pins once fabricating the chip. As for the 5-stage OTA, an extra CMFB circuit has been added with IBIAS_1 \u2248 3 \u03bcA, and VBIAS_2 \u2248 0.37 V. Due to the loading effect of the CMFB circuit of Fig. 4(b), the 4-stage OTA has achieved an ADC,4 of 92 dB instead of values around 100 dB. The same can be said for the 5-stage OTA. The ADC values for all stages are shown in Fig. 9(a).\nAfter designing the OTA for the required DC gain, the focus will now be on verifying the proposed FCT by designing the compensation circuits according to Step (1) and (2) (i.e., Eqn. (4) and (5)), so that \u03c9t is enhanced to a nearoptimum value to allow the OTA to drive a wide CL range.\nA. Verification of Step (1): Increase \u03c9t Under CL = 0.5 pF The proposed FCT starts by designing the 2-stage OTA\u2019s R-C compensation circuit (according to Step (1)) having CL,min = 0.5 pF. Therefore, the value of CC1,(2\u2212stage) has been selected to be almost 5 times the value of the parasitic capacitance given by the technology (i.e. CC1 = 50 fF). For RC1,(2\u2212stage), the value has been swept starting from 1 k , and increased till RC1,(2\u2212stage) reached a value of 21 k . Thus, ft becomes 293.2 MHz. This value of ft is near optimum as PM = 70.9 \u25e6, which is a reasonable value to indicate stability.\nThe frequency positions of the P-Z pair after designing the 2-stage OTA\u2019s R-C circuit according to Step (1) are: fZ1 = 166 MHz and fP1 = 180.5 MHz. Clearly, these values satisfy Eqn. (6) and the parasitic pole constraint at 787 MHz, which is twice the value of ft .\nFollowing the scalable technique given by Eqs. (15)-to-(18), the R-C compensation circuits of the 3-, 4-, and 5-stage OTAs are designed as shown in Table I. Based on these values, Eqn. (6) is not satisfied as some P-Z pairs have poles frequencies \u03c9Pi that are less than the zero frequencies \u03c9Zi . However, this is not a concern. For example, in the 3- stage OTA, fZ1 = 15.03 MHz and fP1 = 10.06 MHz (i.e., \u03c9Z1 > \u03c9P1), while for the 4-stage OTA, fZ1 = 14.58 MHz, fP1 = 1.8 MHz, fZ2 = 29.1 MHz, and fP2 = 12.4 MHz (i.e., \u03c9Z1 \u03c9P1 and \u03c9Z2 > \u03c9P2). Nevertheless,"
        },
        {
            "heading": "82 IEEE TRANSACTIONS ON CIRCUITS AND SYSTEMS\u2014I: REGULAR PAPERS, VOL. 70, NO. 1, JANUARY 2023",
            "text": "the PM has reached values around 60\u25e6. Also, \u03c9t is at high frequencies and \u03c9Ppar are still higher than \u03c9t .\nFig. 9 summarizes all schematic and post-layout results for open-loop and closed-loop configurations after implementing Step (1) of the proposed FCT under CL = 0.5 pF. A summary of the most important metrics that can be drawn from these simulations are shown on the right-bottom corner of Fig. 9.\nClearly, all stages are achieving the required DC gain while exhibiting a stable response. However, the 4-stage post-layout magnitude response is affected by the parasitics after extraction, and its gain roll-off at \u03c9t is less than - 20 dB/dec. As a result, the 4-stage OTA step response (under Vin = 100 mV) is showing some ringing, which is translated as an increase in its settling time compared to other stages.\nAlso, one can notice a dip in the 4- and 5-stage phase responses. Therefore, for further tests of stability, the output swing of the proposed 5-stage OTA has been simulated for different peak-to-peak input voltages as can be seen in Fig. 9(e). The results indicate no unforeseen stability issues. Also, the proposed OTAs have been tested having a closed-loop gain of 10 dB and the results exhibit a stable response as well.\nAlso, as can be seen in Fig. 9\u2019s summary of results, the Average Slew Rate (Avg. SR) is decreasing as the number of gain stages is increasing, where the Avg. SR of the proposed OTAs can be approximated by Avg. S R \u2248 min (\nIM4_AV G CC,1_eq , IM6,2_AV G CC,2_eq , . . . , IM6,N_AV G CC,N_eq\n)\n(20)\nwhere IM,4_AVG, IM6,2_AVG, \u2026, IM6,N_AVG are the average currents (i.e., average of the rising and falling edges) flowing at the output node of each gain stage, while CC,1_eq, CC,2_eq, \u2026, CC,N_eq are the equivalent compensation capacitances which are seen at these output nodes. For instance, (CC,1_eq \u2248 CC1), (CC,2_eq \u2248 CC1 + CC2), \u2026, and (CC,N_eq \u2248 CC,(N-1) + CL). The simulations are showing that IM,4_AVG is 7.1 \u03bcA, while\nIM6,N_AVG (for N = 2 to 5) is 358.5 \u03bcA. Since IM,4_AVG IM6,N_AVG, the output node of the 1st stage is dominating the SR behavior of the proposed OTAs given that the OTAs are driving pF-range CL. Thus, since CC1 is the capacitance seen at the output node of 1st-stage, and according to the proposed FCT, CC1 is increasing as the number of stages is increasing; hence, the Avg. SR is decreasing as the number of stages is increasing.\nIf a very large CL is required (i.e., in the nF-range), the dependency of the SR will be transferred to the output node of the last gain-stage. Consequently, one can increase the value of IM6,N to keep the SR within sufficient values. However, by designing the OTA to have a high IM6,N, the power consumption will increase. This will become a trade-off between CL, SR, and power consumption. Interestingly, some designs in the literature have adapted alternative class AB implementations that preserve SR with lower power consumption as in [31]. However, adding such class AB output stage might affect the proposed poles/zeros arrangement, which might require further optimization. The post-layout power consumption in the proposed designs is 106 \u03bcW, 180.1 \u03bcW, 276.7 \u03bcW, and 387 \u03bcW, for the 2-, 3-, 4-, and 5-stage OTAs, respectively. Also, one should consider that this value is for a fully differential-ended topology.\nEven though many resistors are being used in the proposed OTAs, the noise has not been affected that much, because the resistors mainly affect the noise of the output stage, while the 1st stage noise is the dominant noise. Therefore, the postlayout input referred noise at 10 kHz is 82.2 nV/ \u221a Hz for the\n2- and 3-stage OTAs and 78.1 nV/ \u221a Hz, for the 4-stage OTA.\nB. Verification of Step (2): Maximize CL for a Desired TS After designing the proposed OTAs to properly drive CL,min of 0.5 pF, the goal now is to define the range of CL under which the 2-, 3-, 4- and 5-stage OTAs\u2019 closed-loop responses are stable, and to find the corresponding settling time for this\nMOHAMMED AND ROBERTS: SCALABLE MULTI-STAGE CMOS OTAs WITH A WIDE CL-DRIVABILITY RANGE 83\nrange of CL. Therefore, similar steps of creating Fig. 7 and Fig. 8 (i.e., investigating the PM and the settling time variations vs. the increase in CL) are being followed here.\nConsequently, Fig. 10(a) shows the simulation results of PM vs. CL. Apparently, the proposed 2-stage OTA (solid-blue line with circles) is stable with PM \u2265 45\u25e6, for all values of CL, except between 10 pF to 100 pF where it goes slightly below 45\u25e6. Therefore, it mainly follows Case (1) of Fig. 7, which is the expected response since \u03c9Z1 < \u03c9P1. To define CL,max, one can observe the CL value of Fig. 10(a) at which the PM becomes 90\u25e6. Clearly, CL,max is 10 nF; thus, CL-drivability ratio according to Eqn. (19) is 20,000\u00d7.\nAs for the proposed 3-stage OTA, the closed-loop response is always stable as the PM doesn\u2019t reach the instability region (i.e., green-shaded area of Fig. 10(a)) with the increase in CL. Clearly, the PM follows Case (2) of Fig. 7, which is an expected response since \u03c9Z1 > \u03c9P1 of the 1st P-Z pair as mentioned earlier. Interestingly, with CL,max of 10 \u03bcF, CLdrivability ratio of the proposed 3-stage OTA is 20,000,000x.\nAs for the proposed 4-stage OTA, the PM behavior follows Case (3) of Fig. 7, where it goes below 10\u25e6 in between CL,1 = 40 pF and CL,2 = 100 nF. Again, this is an expected behavior due to the 1st and 2nd P-Z pairs\u2019 arrangement, where \u03c9Z1 \u03c9P1. Nonetheless, the proposed 4-stage OTA is operating properly under all other values and exhibiting a CL-drivability ratio of 80,000x. The same can be said for the proposed 5-stage OTA\u201e where the PM goes below 10\u25e6 in between CL,1 = 5 pF and CL,2 = 10 \u03bcF, exhibiting a CL-drivability ratio of 5000x, with CL,max = 5 mF.\nSince the PM might not always reflect the actual closedloop step response, and since the open-loop AC response of Fig. 9(a) shows a dip in the phase response below \u03c9t for the 4- and 5-stage OTAs, one can use the GM test to ensure its full agreement with the PM and there will be no multiple phase crossover points with \u2212180\u25e6. Fig. 10(b) shows the simulation results of GM vs. CL. Clearly, the GM is \u2265 0 dB in the stability regions which have been defined by the PM in Fig. 10(a).\nTo clearly measure the improvement that has been done by the proposed FCT on CL-drivability of CMOS OTAs, one can compensate the proposed OTAs with the conventional FCT (i.e., which relies on CL only to compensate the OTA) and compare the results. Fig. 10(c) shows the PM behavior once conventional techniques are used to compensate for the proposed 2-, 3-, 4- and 5-stage OTAs. Clearly, the conventional technique might only work for 2-stage OTA, but it cannot be scaled for higher number of stages (i.e., it is not suitable for scaled-down CMOS technologies) unless large CLs are only required, which is not the case in most applications as depicted in Fig. 1(a).\nThe results in Fig. 10(a)-(c) pave the way to verify the unity-gain closed-loop step-response of the proposed OTAs to find the relationship between settling time and CL. Since the settling time is expected to vary based on the different cases of positioning the open-loop P-Z pairs as stated in Fig. 8, the 2-stage OTA is expected to have the fastest response as it mostly follows Case (1). Fig. 10(d) verifies this for all CL values above 100 pF. However, although the 3-stage OTA is following Case (2), it exhibits faster response for CL values"
        },
        {
            "heading": "84 IEEE TRANSACTIONS ON CIRCUITS AND SYSTEMS\u2014I: REGULAR PAPERS, VOL. 70, NO. 1, JANUARY 2023",
            "text": "below 100 pF. The reason for this can be indicated from Fig. 10(a), where the 3-stage OTA is having higher PM values than the 2-stage OTA in between 1 pF to 100 pF.\nAll other open-loop and closed-loop parameters are being considered as the value of CL is increasing; but for simplicity and to avoid repetition, these parameters will be shown as the proposed OTAs are being validated with measurement results in the following section."
        },
        {
            "heading": "VII. EXPERIMENTAL RESULTS AND ROBUSTNESS TESTS",
            "text": "The standard TSMC 65 nm CMOS process is used to fabricate the differential-ended 2-, 3- and 4-stage CMOS OTAs of Fig. 3 with the devices\u2019 sizes shown in Fig. 3, Fig. 4, and Table I. However, the proposed 5-stage OTA has not been fabricated. Fig. 11 shows the fabricated chip\u2019s microphotograph. Since a wide range of CL is required, each proposed OTA has been fabricated twice (i.e., with CL on-chip for a small CL = 1 pF and CL off-chips for higher values). To illustrate the area and the elements in fabricating the proposed differentialended 2-, 3-, and 4-stage CMOS OTAs, the layout drawing of the 2-stage OTA is embedded and enlarged in Fig. 11, where the overall dimensions is 53.9 \u03bcm \u00d7 39.7 \u03bcm, resulting in an area of 0.0021 mm2. As seen in the layout drawing, RC1 dominates the chip\u2019s size and occupies almost half the chip\u2019s silicon area. But, as CC1 is set just above the parasitic level, the overall silicon area remains quite small (total area = 0.0021 mm2). The RC used here is the standard N-well resistor with sheet resistance 316 /square. As for the CC1, a mimcap with the same length and width of 4.8 \u03bcm is used for a CC1 value of 50 fF. The same can be said for the 3- and 4-stage OTAs, except more silicon area is required as seen in Fig. 11."
        },
        {
            "heading": "A. Measurements\u2019 Results",
            "text": "This chip has been tested in a unity-gain closed-loop configuration to obtain the closed-loop and open-loop performance metrics of each OTA. Table II lists the critical OTA biasing parameters from a step response test involving a 100 mV step input. Subsequently, Fig. 12 show the output step response of the 2-, 3-, and 4-stage OTAs under different values of CL (i.e., starting from CL,min up to CL,max) as captured by an Agilent DSA80000B oscilloscope. The closed-loop performance metrics (i.e. settling time and SR), for different values of CL, are included on each time plot shown in Fig. 12. Also, Table III shows the DC gain of the proposed OTAs, along with a summary of the open-loop measurements\u2019 results for the proposed 2-, 3-, and 4-stage CMOS OTAs under CL,min and CL,max for each OTA.\nBy comparing these measurement results with the schematic and post-layout simulation results we found during the verification, one can conclude that these results are in general agreement with one another. Thus, the proposed FCT is being applied properly. It should be noted, however, that the 4-stage OTA has a CL,1 and CL,2 values that is slightly different than what was predicted by simulation, i.e., 40 pF versus 100 pF for CL,1, and 100 nF versus 10 nF for CL,2."
        },
        {
            "heading": "B. Robustness Tests",
            "text": "To ensure the robustness of the proposed design, process corners and Monte-Carlo (MC) simulations have been conducted for different OTAs\u2019 parameters, under different CL\u2019s, in open-loop and closed-loop configurations. This was conducted for both schematic-based and post-layout-based designs. Table IV shows a test for the design robustness using the schematic-based MC simulations for the 2-, 3-, 4- and 5- stage CMOS OTAs. Here, the Process Variation Coefficient (PVC) [(\u03c3D/\u03bc) \u00d7 100%] for all 2-, 3-, and 4-stage OTAs\u2019 parameters is less than 5 %. However, PVC increases to values slightly above 10 % for the proposed 5-stage OTA\u2019s parameters, except for the DC gain, where the PVC is 4.3 %.\nMoreover, to test the proposed OTAs robustness under PVT variations, the post layout-based process corners of the proposed 2-, 3-, 4- and 5-stage OTAs under CL of 1 pF are conducted. Fig. 13 reports the results of different performance metrics\u2019 behavior under these process corners. As can be seen in Fig. 13, all process corners, for all metrics, indicates no unforeseen sensitivity issues. Consequently, using the results shown in Table IV and Fig. 13, one can conclude that the proposed OTA designs are robust under PVT variations.\nMOHAMMED AND ROBERTS: SCALABLE MULTI-STAGE CMOS OTAs WITH A WIDE CL-DRIVABILITY RANGE 85\nClearly, the 5-stage OTA shows less robustness compared to other stages. With ft = 89.9 MHz, positioning the 5-stage OTA P-Z pairs becomes tight, which increases the sensitivity to the PVT variations. This indicates that the proposed technique will reach a limit in the number of cascaded gain-stages, which was found to be 8 stages in [12], given that each stage is achieving 25 dB per stage."
        },
        {
            "heading": "VIII. COMPARISON",
            "text": "To clearly highlight the achieved advancements of this work, the proposed 2-, 3-, 4- and 5-stage OTA designs have been compared with previously reported OTA designs. For fair comparison, measurement-based works, where CMOS OTAs can drive a wide range of CLs have been reported in Table V. Therefore, op-amps, simulation-based works (including the proposed 5-stage OTA), and OTAs with a single CL driving capability have been excluded from Table V.\nReferring back to Fig. 1(a) where the settling time requirements vs. CL for different applications are shown, one can appreciate the need for an OTA with a wide-ranging drivability features, even if the OTA settles in seconds. Fig. 14 superimposes a load-drivability summary of the OTA results of this work with the best results found in the literature [27] and [33], as it compares with the applications reported in Fig. 1(a). As is clearly evident, the proposed OTAs cover more applications than any other reported work.\nIn addition to the simplicity of the proposed design which uses conventional gain stages with multi-Miller R-C compensation circuits across gain stages, the proposed FCT is applicable to 2-, 3-, 4- and 5-stage OTAs. This is a feature\nthat is not available in any of the previously published works. This offers wider design choices for DC gain and power consumption for different applications.\nTo set the comparison in a conventional way, the following well-established figures of merit (FOMs) have been used [27]:\nFO M S = GBW.CL Power.Area \u00d7 CL\u2212drivabilit y (21)\nSI FO M L = GBW.CL Power.Area \u00d7 CL\u2212drivabilit y TS\n(22)\nTable V shows that the proposed OTAs outperform all other reported works in FOMS, where the highest values is reported for the proposed 3-stage OTA, followed by the proposed 4-stage OTA and then comes the proposed 2-stage"
        },
        {
            "heading": "86 IEEE TRANSACTIONS ON CIRCUITS AND SYSTEMS\u2014I: REGULAR PAPERS, VOL. 70, NO. 1, JANUARY 2023",
            "text": "OTA. Also, the proposed OTAs outperform all other reported works in SIFOML, where the highest values is reported for the proposed 4-stage OTA (at CL = 100 pF), followed by the proposed 3-stage OTA and then comes the proposed 2- stage OTA. However, the proposed 4-stage OTA has a low SIFOML at CL,max = 100 \u03bcF due to the long settling time of such large CL. Also, looking at the OTAs\u2019 metrics individually, one can see that the proposed 4-stage OTA has the highest CL,max of 100 \u03bcF. Moreover, the proposed 4- and 3-stage OTAs have the maximum CL drivability of 1,000,000x, followed by the proposed 2-stage OTA with a CL-drivability of 10,000x. Moreover, the proposed differential-ended 2-stage OTA occupies the smallest silicon area of 0.0021 mm2. Finally, despite using the smallest CMOS technology node of 65 nm and achieving a slightly lower DC gain than other reported works in Table V, the proposed technique can be scaled for higher number of stages and achieve higher DC gain as shown in the post-layout results of the proposed 5-stage OTA with a DC gain of \u223c 110 dB."
        },
        {
            "heading": "IX. CONCLUSION",
            "text": "A new frequency compensation technique that allows cascading multi-stage CMOS OTAs and driving a very wide range of CL (i.e., pF- to \u03bcF-range) was introduced. The proposed technique involves positioning the OTA\u2019s zeros at low frequencies to increase \u03c9t of the OTA. The additional increase in \u03c9t can be traded off for higher CL by transferring the dependency of the dominant pole to CL. To achieve this, the OTA was designed using multi-Miller R-C compensation circuits across the OTA\u2019s gain-stages. Also, the proposed technique was shown to be unconstrained by the OTA\u2019s circuit topology. Hence, conventional gain-stages (i.e., differential pair and common source transistors) were used to design fully-differential 2-, 3-, 4-, and 5-stage CMOS OTAs with a CL-drivability of 10,000\u00d7, 1,000,000x, 1,000,000x, and\n5,000x, respectively. This is 10-to-1000-time improvement in the state-of-the-art. Accordingly, the proposed OTAs can cover a wider range of applications than any other reported works. The proposed 2-, 3-, and 4-stage OTA designs have been fabricated in the standard TSMC 65 nm CMOS process and the measurement results validate the claims made in this work."
        }
    ],
    "title": "Scalable Multi-Stage CMOS OTAs With a Wide C<sub>L</sub>-Drivability Range Using Low-Frequency Zeros",
    "year": 2023
}