{
    "abstractText": "Avoiding over\u2010pressurization in subsurface reservoirs is critical for applications like CO 2 sequestration and wastewater injection. Managing the pressures by controlling injection/extraction are challenging because of complex heterogeneity in the subsurface. The heterogeneity typically requires high\u2010fidelity physics\u2010based models to make predictions on CO 2 fate. Furthermore, characterizing the heterogeneity accurately is fraught with parametric uncertainty. Accounting for both, heterogeneity and uncertainty, makes this a computationally\u2010intensive problem challenging for current reservoir simulators. To tackle this, we use differentiable programming with a full\u2010physics model and machine learning to determine the fluid extraction rates that prevent over\u2010pressurization at critical reservoir locations. We use DPFEHM framework, which has trustworthy physics based on the standard two\u2010point flux finite volume discretization and is also automatically differentiable like machine learning models. Our physics\u2010informed machine learning framework uses convolutional neural networks to learn an appropriate extraction rate based on the permeability field. We also perform a hyperparameter search to improve the model\u2019s accuracy. Training and testing scenarios are executed to evaluate the feasibility of using physics\u2010informed machine learning to manage reservoir pressures. We constructed and tested a sufficiently accurate simulator that is 400 000 times faster than the underlying physics\u2010 based simulator, allowing for near real\u2010time analysis and robust uncertainty quantification.",
    "authors": [
        {
            "affiliations": [],
            "name": "Aleksandra Pachalieva"
        },
        {
            "affiliations": [],
            "name": "Daniel O\u2019Malley"
        },
        {
            "affiliations": [],
            "name": "Dylan Robert Harp"
        },
        {
            "affiliations": [],
            "name": "Hari Viswanathan"
        }
    ],
    "id": "SP:95391e74c751590ab3c9a543967478f28a9f8557",
    "references": [
        {
            "authors": [
                "M.D. Zoback"
            ],
            "title": "Managing the seismic risk posed by wastewater disposal",
            "venue": "Earth 57,",
            "year": 2012
        },
        {
            "authors": [
                "K.M. Keranen",
                "M. Weingarten",
                "G.A. Abers",
                "B.A. Bekins",
                "S. Ge"
            ],
            "title": "Sharp increase in central Oklahoma seismicity since 2008 induced by massive wastewater injection",
            "venue": "Science 345,",
            "year": 2014
        },
        {
            "authors": [
                "McNamara",
                "D. E"
            ],
            "title": "Earthquake hypocenters and focal mechanisms in central Oklahoma reveal a complex system of reactivated subsurface strike-slip faulting",
            "venue": "Geophys. Res. Lett. 42,",
            "year": 2015
        },
        {
            "authors": [
                "M Baer"
            ],
            "title": "Earthquakes in Switzerland and surrounding regions during",
            "venue": "Swiss J. Geosci. 100,",
            "year": 2006
        },
        {
            "authors": [
                "N Deichmann"
            ],
            "title": "Earthquakes in Switzerland and surrounding regions during 2007",
            "venue": "Swiss J. Geosci. 101,",
            "year": 2008
        },
        {
            "authors": [
                "B. Dyer",
                "U. Schanz",
                "F. Ladner",
                "M. Haring",
                "T. Spillman"
            ],
            "title": "Microseismic imaging of a geothermal reservoir stimulation",
            "venue": "Lead. Edge 27,",
            "year": 2008
        },
        {
            "authors": [
                "N. Deichmann",
                "D. Giardini"
            ],
            "title": "Earthquakes induced by the stimulation of an enhanced geothermal system below Basel (Switzerland)",
            "venue": "Seismol. Res. Lett. 80,",
            "year": 2009
        },
        {
            "authors": [
                "Majer",
                "E. L"
            ],
            "title": "Induced seismicity associated with enhanced geothermal systems",
            "venue": "Geothermics 36,",
            "year": 2007
        },
        {
            "authors": [
                "B. Metz",
                "O. Davidson",
                "H. De Coninck",
                "M. Loos",
                "L. Meyer"
            ],
            "title": "IPCC Special Report on Carbon Dioxide Capture and Storage (Cambridge",
            "year": 2005
        },
        {
            "authors": [
                "Buscheck",
                "T.A. et al. Combining brine extraction",
                "desalination",
                "residual-brine reinjection with CO2 storage in saline formations"
            ],
            "title": "Implications for pressure management, capacity, and risk mitigation",
            "venue": "Energy Proc. 4, 4283\u20134290",
            "year": 2011
        },
        {
            "authors": [
                "A. Cihan",
                "J.T. Birkholzer",
                "M. Bianchi"
            ],
            "title": "Optimal well placement and brine extraction for pressure management during CO2 sequestration",
            "venue": "Int. J. Greenh. Gas Control",
            "year": 2015
        },
        {
            "authors": [
                "Harp",
                "D. R"
            ],
            "title": "Development of robust pressure management strategies for geologic CO2 sequestration",
            "venue": "Int. J. Greenh. Gas Control",
            "year": 2017
        },
        {
            "authors": [
                "Viswanathan",
                "H.S. et al. From fluid flow to coupled processes in fractured rock"
            ],
            "title": "Recent advances and new frontiers",
            "venue": "Rev. Geophys. 60, e2021RG000744",
            "year": 2022
        },
        {
            "authors": [
                "B. Chen",
                "D.R. Harp",
                "Y. Lin",
                "E.H. Keating",
                "Pawar",
                "R.J. Geologic CO2 sequestration monitoring design"
            ],
            "title": "A machine learning and uncertainty quantification based approach",
            "venue": "Appl. Energy 225, 332\u2013345",
            "year": 2018
        },
        {
            "authors": [
                "N.A. Menad",
                "A. Hemmati-Sarapardeh",
                "A. Varamesh",
                "Shamshirband",
                "S. Predicting solubility of CO2 in brine by advanced machine learning systems"
            ],
            "title": "Application to carbon capture and sequestration",
            "venue": "J. CO2 Util. 33, 83\u201395",
            "year": 2019
        },
        {
            "authors": [
                "S Sinha"
            ],
            "title": "Normal or abnormal? Machine learning for the leakage detection in carbon sequestration projects using pressure field data",
            "venue": "Int. J. Greenh. Gas Control 103,",
            "year": 2020
        },
        {
            "authors": [
                "Z. Wang",
                "R.M. Dilmore",
                "W. Harbert"
            ],
            "title": "Inferring CO2 saturation from synthetic surface seismic and downhole monitoring data using machine learning for leakage detection at CO2 sequestration sites",
            "venue": "Int. J. Greenh. Gas Control 100,",
            "year": 2020
        },
        {
            "authors": [
                "M.N. Amar",
                "A.J. Ghahfarokhi"
            ],
            "title": "Prediction of CO2 diffusivity in brine using white-box machine learning",
            "venue": "J. Petrol. Sci. Eng. 190,",
            "year": 2020
        },
        {
            "authors": [
                "R. Liu",
                "Misra",
                "S. Machine learning assisted exploration",
                "production of subsurface energy",
                "carbon geo-sequestration"
            ],
            "title": "A review",
            "venue": "Earth Space Sci. Open Arch. 56",
            "year": 2020
        },
        {
            "authors": [
                "B. Ahmmed",
                "S. Karra",
                "V.V. Vesselinov",
                "M.K. Mudunuru"
            ],
            "title": "Machine learning to discover mineral trapping signatures due to CO2 injection",
            "venue": "Int. J. Greenh. Gas Control 109,",
            "year": 2021
        },
        {
            "authors": [
                "B. Yan",
                "B. Chen",
                "D.R. Harp",
                "W. Jia",
                "R.J. Pawar"
            ],
            "title": "A robust deep learning workflow to predict multiphase flow behavior during geological CO2 sequestration injection and post-injection periods",
            "venue": "J. Hydrol. 607,",
            "year": 2022
        },
        {
            "authors": [
                "B. Yan",
                "D.R. Harp",
                "B. Chen",
                "H. Hoteit",
                "R.J. Pawar"
            ],
            "title": "A gradient-based deep neural network model for simulating multiphase flow in porous media",
            "venue": "J. Comput. Phys. 463,",
            "year": 2022
        },
        {
            "authors": [
                "B. Yan",
                "D.R. Harp",
                "B. Chen",
                "R. Pawar"
            ],
            "title": "A physics-constrained deep learning model for simulating multiphase flow in 3D heterogeneous porous media",
            "venue": "Fuel 313,",
            "year": 2022
        },
        {
            "authors": [
                "H.V. Thanh",
                "Q. Yasin",
                "W.J. Al-Mudhafar",
                "Lee",
                "K.-K"
            ],
            "title": "Knowledge-based machine learning techniques for accurate prediction of CO2 storage performance in underground saline aquifers",
            "venue": "Appl. Energy 314,",
            "year": 2022
        },
        {
            "authors": [
                "F. Krasnov",
                "N. Glavnov",
                "A. Sitnikov"
            ],
            "title": "A machine learning approach to enhanced oil recovery prediction",
            "venue": "In International Conference on Analysis of Images, Social Networks and Texts,",
            "year": 2017
        },
        {
            "authors": [
                "J You"
            ],
            "title": "Assessment of enhanced oil recovery and CO2 storage capacity using machine learning and optimization framework",
            "venue": "In SPE Europec featured at 81st EAGE Conference and Exhibition (OnePetro,",
            "year": 2019
        },
        {
            "authors": [
                "Y. Cheraghi",
                "S. Kord",
                "V. Mashayekhizadeh"
            ],
            "title": "Application of machine learning techniques for selecting the most suitable enhanced oil recovery method; challenges and opportunities",
            "venue": "J. Petrol. Sci. Eng. 205,",
            "year": 2021
        },
        {
            "authors": [
                "M. Pirizadeh",
                "N. Alemohammad",
                "M. Manthouri"
            ],
            "title": "A new machine learning ensemble model for class imbalance problem of screening enhanced oil recovery methods",
            "venue": "J. Petrol. Sci. Eng. 198,",
            "year": 2021
        },
        {
            "authors": [
                "B. Chen",
                "R.J. Pawar"
            ],
            "title": "Characterization of CO2 storage and enhanced oil recovery in residual oil zones",
            "venue": "Energy 183,",
            "year": 2019
        },
        {
            "authors": [
                "J. You",
                "W. Ampomah",
                "Q. Sun"
            ],
            "title": "Development and application of a machine learning based multi-objective optimization workflow for CO2-EOR projects",
            "venue": "Fuel 264,",
            "year": 2020
        },
        {
            "authors": [
                "J You"
            ],
            "title": "Machine learning based co-optimization of carbon dioxide sequestration and oil recovery in CO2-EOR project",
            "venue": "J. Clean. Prod",
            "year": 2020
        },
        {
            "authors": [
                "D.L. Siler",
                "J.D. Pepin",
                "V.V. Vesselinov",
                "M.K. Mudunuru",
                "Ahmmed",
                "B. Machine learning to identify geologic factors associated with production in geothermal fields"
            ],
            "title": "A case-study using 3D geologic data, Brady geothermal field",
            "venue": "Nevada. Geotherm. Energy 9, 1\u201317",
            "year": 2021
        },
        {
            "authors": [
                "Y. Li",
                "E. J\u00fal\u00edusson",
                "H. P\u00e1lsson",
                "H. Stef\u00e1nsson",
                "A. Valfells"
            ],
            "title": "Machine learning for creation of generalized lumped parameter tank models of low temperature geothermal reservoir systems",
            "venue": "Geothermics 70,",
            "year": 2017
        },
        {
            "authors": [
                "S. Rezvanbehbahani",
                "L.A. Stearns",
                "A. Kadivar",
                "J.D. Walker",
                "van der Veen",
                "C.J. Predicting the geothermal heat flux in Greenland"
            ],
            "title": "A machine learning approach",
            "venue": "Geophys. Res. Lett. 44, 12\u2013271",
            "year": 2017
        },
        {
            "authors": [
                "B.K. Holtzman",
                "A. Pat\u00e9",
                "J. Paisley",
                "F. Waldhauser",
                "D. Repetto"
            ],
            "title": "Machine learning reveals cyclic changes in seismic source spectra in Geysers geothermal field",
            "venue": "Sci. Adv. 4,",
            "year": 2018
        },
        {
            "authors": [
                "F.S. Tut Haklidir",
                "Haklidir",
                "M. Prediction of reservoir temperatures using hydrogeochemical data",
                "Western Anatolia geothermal systems (Turkey"
            ],
            "title": "A machine learning approach",
            "venue": "Nat. Resour. Res. 29, 2333\u20132346",
            "year": 2020
        },
        {
            "authors": [
                "B. Ahmmed",
                "V.V. Vesselinov"
            ],
            "title": "Machine learning and shallow groundwater chemistry to identify geothermal prospects in the Great Basin, USA",
            "venue": "Renew. Energy 197,",
            "year": 2022
        },
        {
            "authors": [
                "C. Hegde",
                "K. Gray"
            ],
            "title": "Use of machine learning and data analytics to increase drilling efficiency for nearby wells",
            "venue": "J. Nat. Gas Sci. Eng",
            "year": 2017
        },
        {
            "authors": [
                "K.M. Hanga",
                "Kovalchuk",
                "Y. Machine learning",
                "multi-agent systems in oil",
                "gas industry applications"
            ],
            "title": "A survey",
            "venue": "Comput. Sci. Rev. 34, 100191",
            "year": 2019
        },
        {
            "authors": [
                "Y. Hajizadeh"
            ],
            "title": "Machine learning in oil and gas; a SWOT analysis approach",
            "venue": "J. Petrol. Sci. Eng. 176,",
            "year": 2019
        },
        {
            "authors": [
                "A. Sircar",
                "K. Yadav",
                "K. Rayavarapu",
                "N. Bist",
                "H. Oza"
            ],
            "title": "Application of machine learning and artificial intelligence in oil and gas industry",
            "venue": "Petroleum Res",
            "year": 2021
        },
        {
            "authors": [
                "N Mohamadian"
            ],
            "title": "A geomechanical approach to casing collapse prediction in oil and gas wells aided by machine learning",
            "venue": "J. Petrol. Sci. Eng. 196,",
            "year": 2021
        },
        {
            "authors": [
                "G. Axelsson",
                "V. Stef\u00e1nsson",
                "G. Bj\u00f6rnsson",
                "J. Liu"
            ],
            "title": "Sustainable management of geothermal resources and utilization for 100\u2013300 years",
            "venue": "In Proceedings World Geothermal Congress,",
            "year": 2005
        },
        {
            "authors": [
                "M. Weingarten",
                "S. Ge",
                "J.W. Godt",
                "B.A. Bekins",
                "J.L. Rubinstein"
            ],
            "title": "High-rate injection is associated with the increase in us midcontinent seismicity",
            "venue": "Science 348,",
            "year": 2015
        },
        {
            "authors": [
                "D.R. Harp",
                "D. O\u2019Malley",
                "B. Yan",
                "R. Pawar"
            ],
            "title": "On the feasibility of using physics-informed machine learning for underground reservoir pressure management",
            "venue": "Expert Syst. Appl. 178,",
            "year": 2021
        },
        {
            "authors": [
                "Q Cao"
            ],
            "title": "Data driven production forecasting using machine learning",
            "venue": "In SPE Argentina Exploration and Production of Unconventional Resources Symposium (OnePetro,",
            "year": 2016
        },
        {
            "authors": [
                "S.D. Mohaghegh"
            ],
            "title": "Data-Driven Reservoir Modeling (SPE, 2017)",
            "venue": "Scientific Reports |",
            "year": 2022
        },
        {
            "authors": [
                "K Balaji"
            ],
            "title": "Status of data-driven methods and their applications in oil and gas industry",
            "venue": "In SPE Europec Featured at 80th EAGE Conference and Exhibition (OnePetro,",
            "year": 2018
        },
        {
            "authors": [
                "F. Xiong",
                "J. Ba",
                "D. Gei",
                "J.M. Carcione"
            ],
            "title": "Data-driven design of wave-propagation models for shale-oil reservoirs based on machine learning",
            "venue": "J. Geophys. Res. Solid Earth 126,",
            "year": 2021
        },
        {
            "authors": [
                "M Claprood"
            ],
            "title": "Workflow using sparse vintage data for building a first geological and reservoir model for CO2 geological storage in deep saline aquifer A case study in the St. Lawrence Platform,Canada",
            "venue": "Greenh. Gases Sci. Technol",
            "year": 2012
        },
        {
            "authors": [
                "S Mishra"
            ],
            "title": "Maximizing the value of pressure monitoring data from CO2 sequestration projects",
            "venue": "Energy Proc. 37,",
            "year": 2013
        },
        {
            "authors": [
                "Y. Yang",
                "P. Perdikaris"
            ],
            "title": "Adversarial uncertainty quantification in physics-informed neural networks",
            "venue": "J. Comput. Phys. 394,",
            "year": 2019
        },
        {
            "authors": [
                "X. Meng",
                "Z. Li",
                "D. Zhang",
                "Karniadakis",
                "G.E. PPINN"
            ],
            "title": "Parareal physics-informed neural network for time-dependent PDEs",
            "venue": "Comput. Methods Appl. Mech. Eng. 370, 113250",
            "year": 2020
        },
        {
            "authors": [
                "M. Raissi",
                "P. Perdikaris",
                "Karniadakis",
                "G.E. Physics-informed neural networks"
            ],
            "title": "A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations",
            "venue": "J. Comput. Phys. 378, 686\u2013707",
            "year": 2019
        },
        {
            "authors": [
                "K. Pruess"
            ],
            "title": "TOUGH2-A general-purpose numerical simulator for multiphase fluid and heat flow",
            "venue": "Lawrence Berkeley National Laboratory, LBNL Report Number",
            "year": 1991
        },
        {
            "authors": [
                "M. White",
                "Oostrom",
                "M. STOMP subsurface transport over multiple phases"
            ],
            "title": "Users guide",
            "venue": "Tech. Rep., Pacific Northwest National Lab.(PNNL), Richland, WA (United States)",
            "year": 1997
        },
        {
            "authors": [
                "A.W. Harbaugh"
            ],
            "title": "MODFLOW-2005, the US Geological Survey modular ground-water model: The ground-water flow process (US Department of the Interior, US Geological Survey",
            "year": 2005
        },
        {
            "authors": [
                "G. Zyvoloski"
            ],
            "title": "FEHM: A control volume finite element code for simulating subsurface multi-phase multi-fluid heat and mass transfer",
            "year": 2007
        },
        {
            "authors": [
                "CMG G"
            ],
            "title": "Advanced compositional and unconventional reservoir simulator Version 2018",
            "venue": "CMG Ltd., CM Group, Editor",
            "year": 2018
        },
        {
            "authors": [
                "A.G. Baydin",
                "B.A. Pearlmutter",
                "A.A. Radul",
                "Siskind",
                "J.M. Automatic differentiation in machine learning"
            ],
            "title": "A survey",
            "venue": "J. Mach. Learn. Res. 18, 1\u201343",
            "year": 2018
        },
        {
            "authors": [
                "H. Wu",
                "S. Greer",
                "O\u2019Malley",
                "D. Physics-embedded inverse analysis with automatic differentiation for the Earth\u2019s subsurface. arXiv preprint arXiv"
            ],
            "title": "2208",
            "venue": "04426",
            "year": 2022
        },
        {
            "authors": [
                "D. O\u2019Malley",
                "D.R. Harp",
                "V.V. Vesselinov"
            ],
            "title": "DPFEHM.jl. accessed from https:// github. com/ Orcha rdLANL/ DPFEHM",
            "year": 2022
        },
        {
            "authors": [
                "C.V. Theis"
            ],
            "title": "The relation between the lowering of the piezometric surface and the rate and duration of discharge of a well using ground-water storage",
            "venue": "EOS Trans. Am. Geophys. Union 16,",
            "year": 1935
        },
        {
            "authors": [
                "S Srinivasan"
            ],
            "title": "A machine learning framework for rapid forecasting and history matching in unconventional reservoirs",
            "venue": "Sci. Rep. 11,",
            "year": 2021
        },
        {
            "authors": [
                "Y LeCun"
            ],
            "title": "Backpropagation applied to handwritten zip code recognition",
            "venue": "Neural Comput",
            "year": 1989
        },
        {
            "authors": [
                "K. Simonyan",
                "Zisserman",
                "A. Very deep convolutional networks for large-scale image recognition. arXiv preprint arXiv"
            ],
            "title": "1409",
            "venue": "1556",
            "year": 2014
        },
        {
            "authors": [
                "Innes",
                "M. Flux"
            ],
            "title": "Elegant machine learning with Julia",
            "venue": "J. Open Source Softw. 3, 602",
            "year": 2018
        },
        {
            "authors": [
                "Innes",
                "M. Don\u2019t unroll adjoint"
            ],
            "title": "Differentiating SSA-form programs",
            "venue": "arXiv preprint arXiv: 1810. 07951",
            "year": 2018
        },
        {
            "authors": [
                "M. Giles",
                "D. Ghate",
                "M.C. Duta"
            ],
            "title": "Using automatic differentiation for adjoint CFD code development",
            "venue": "Post SAROD Workshop-2005",
            "year": 2005
        },
        {
            "authors": [
                "Innes",
                "M. et al. A differentiable programming system to bridge machine learning",
                "scientific computing. arXiv preprint arXiv"
            ],
            "title": "1907",
            "venue": "07587",
            "year": 2019
        },
        {
            "authors": [
                "Duguid",
                "A. et al. CO2 well construction"
            ],
            "title": "Lessons learned from United States Department of Energy sponsored projects",
            "venue": "In 14th Greenhouse Gas Control Technologies Conference Melbourne, 21\u201326",
            "year": 2018
        },
        {
            "authors": [
                "D. Riestenberg"
            ],
            "title": "Survey of existing wellbores in and around Kemper County, Mississippi (Deliverable 4.1)",
            "venue": "Tech. Rep., Southern States Energy Board, Peachtree Corners, GA (United States)",
            "year": 2018
        },
        {
            "authors": [
                "J. Bezanson",
                "A. Edelman",
                "S. Karpinski",
                "Shah",
                "V.B. Julia"
            ],
            "title": "A fresh approach to numerical computing",
            "venue": "SIAM Rev. 59, 65\u201398",
            "year": 2017
        },
        {
            "authors": [
                "A. Charnes",
                "W.W. Cooper",
                "E. Rhodes"
            ],
            "title": "Measuring the efficiency of decision making units",
            "venue": "Eur. J. Oper. Res",
            "year": 1978
        },
        {
            "authors": [
                "L. Geng",
                "Z. Chen",
                "C.W. Chan",
                "G.H. Huang"
            ],
            "title": "An intelligent decision support system for management of petroleum-contaminated sites",
            "venue": "Expert Syst. Appl. 20,",
            "year": 2001
        },
        {
            "authors": [
                "Y. Ben-Haim"
            ],
            "title": "Info-Gap Decision Theory: Decisions",
            "venue": "Under Severe Uncertainty (Elsevier,",
            "year": 2006
        }
    ],
    "sections": [
        {
            "text": "1 Vol.:(0123456789) Scientific Reports | (2022) 12:18734 | https://doi.org/10.1038/s41598-022-22832-7\nwww.nature.com/scientificreports"
        },
        {
            "heading": "Physics\u2011informed machine learning",
            "text": "with differentiable programming for heterogeneous underground reservoir pressure management Aleksandra Pachalieva1,2*, Daniel O\u2019Malley2, Dylan Robert Harp2 & Hari Viswanathan2\nAvoiding over\u2011pressurization in subsurface reservoirs is critical for applications like CO 2 sequestration and wastewater injection. Managing the pressures by controlling injection/extraction are challenging because of complex heterogeneity in the subsurface. The heterogeneity typically requires high\u2011fidelity physics\u2011based models to make predictions on CO\n2 fate. Furthermore, characterizing the heterogeneity\naccurately is fraught with parametric uncertainty. Accounting for both, heterogeneity and uncertainty, makes this a computationally\u2011intensive problem challenging for current reservoir simulators. To tackle this, we use differentiable programming with a full\u2011physics model and machine learning to determine the fluid extraction rates that prevent over\u2011pressurization at critical reservoir locations. We use DPFEHM framework, which has trustworthy physics based on the standard two\u2011point flux finite volume discretization and is also automatically differentiable like machine learning models. Our physics\u2011informed machine learning framework uses convolutional neural networks to learn an appropriate extraction rate based on the permeability field. We also perform a hyperparameter search to improve the model\u2019s accuracy. Training and testing scenarios are executed to evaluate the feasibility of using physics\u2011informed machine learning to manage reservoir pressures. We constructed and tested a sufficiently accurate simulator that is 400 000 times faster than the underlying physics\u2011 based simulator, allowing for near real\u2011time analysis and robust uncertainty quantification.\nReservoir pressure management is essential for injection/extraction operations in the subsurface for resource extraction, carbon sequestration, climate change mitigation, and renewable energy. However, when mishandled, the pressure management strategy can cause induced seismicity, examples of which are the seismic events due to large-scale wastewater re-injection in central Oklahoma1\u20133. Another example of a failed pressure management strategy is the seismic events that followed the injection of large quantities of water at high pressure at the geothermal reservoir in Basel, Switzerland4\u20136. The incident led to public distrust and, finally, the cancellation of the enhanced geothermal systems (EGS) project altogether7, which was just one out of multiple EGS projects canceled due to induced seismicity concerns8.\nAnother application that can benefit from a better understanding of pressure management is Geologic CO2 sequestration (GCS). GCS at a large scale is necessary to reduce anthropogenic CO2 emissions enough to combat global warming and climate change. To do this efficiently, it is crucial to choose a well-suited reservoir in which 99% of the geologically sequestered carbon will remain sequestered for over 1000 years9. This requires a pressure management strategy that minimizes the risk of leakage and potential induced seismicity through wells, faults, and fractures10\u201312. This requires solving complex physics models with sufficient fidelity and enough realizations to understand and forecast the system behavior. This is only feasible if we use methods to speed up the process while keeping the results accurate.\nAn overwhelming amount of research is focused on using machine learning (ML) to improve the efficiency and accuracy of subsurface energy-related fluid-flow applications13. Machine learning has been used to create reduced order models for geologic CO2 sequestration14\u201324, CO2 enhanced oil recovery25\u201328, geothermal energy25,29\u201332, geothermal energy33\u201337, and oil and gas extraction38\u201342 as summarized in Table\u00a01. For each of these applications, an effective pressure management strategy is required to mitigate the risks associated with injection/\nOPEN\n1Center for Non-Linear Studies, Los Alamos National Laboratory, Los Alamos, NM 87545, USA. 2Earth and Environmental Sciences Division, Los Alamos National Laboratory, Los Alamos, NM 87545, USA. *email: apachalieva@lanl.gov\n2 Vol:.(1234567890) Scientific Reports | (2022) 12:18734 | https://doi.org/10.1038/s41598-022-22832-7\nextraction operations1,10\u201312,43\u201345. However, the use of machine learning to manage the pressures in a subsurface injection scenario has not been investigated in depth.\nModeling reservoir pressure management is challenging considering the complex heterogeneity of the reservoirs and the uncertainties of the systems\u2019 input parameters. This complex heterogeneity typically requires high-fidelity physics-based models to make CO2 predictions. Furthermore, characterizing the heterogeneity accurately is fraught with parametric uncertainty. Accounting for both heterogeneity (which contributes to the complexity and high computational cost of the physics model) and uncertainty demands many realizations. Performing many realizations makes this a computationally-intensive problem that is challenging for current reservoir simulation workflows. For some applications, such as the oil and gas industry, tens of thousands of wells have been drilled, resulting in large amounts of data and the development and usage of data-driven machine learning models40,46\u201349. However, this is not the case for applications such as GCS, where few wells are in use, data is scarce, expensive, and time-consuming to obtain14,50,51. For such data-limited applications, physics constraints are often introduced into the machine learning algorithms to regularize the neural networks training and thus augment the lack of data52,53. This approach is called physics-informed neural networks (PINN)54. A limitation of the PINN approach is that if the physics are not trustworthy \u2013 there are no guarantees that the computation will quickly (or at all) converge to the correct solution. An incorrect solution could misguide the pressure management machine learning model. A major limitation of most traditional numerical models is the calculation of parameter gradients from high-fidelity physics reservoir simulations. Most fluid and transport simulators, which can simulate subsurface fluid injection/extraction rely on finite-difference gradients to evaluate many physicsbased parameters55\u201359. This is why such simulators are built without the use of differentiable programming (DP) and automatic differentiation (AD) techniques which are standard in machine learning approaches such as PINNs. Computing finite-difference gradients for highly-dimensionalized models (e.g., those with heterogeneous permeability fields) is computationally inefficient and often prevents the traditional physical models from being included in machine learning workflows. A solution to this problem is using DP and AD that takes advantage of the chain rule to evaluate complex derivatives more efficiently60, including for implementing trustworthy numerical models based on traditional methods such as finite difference/element/volume45,61.\nWe developed a physics-informed machine learning (PIML) framework that determines the fluid extraction rates for dedicated wells to maintain the pressure at a critical location during water injection. Our framework uses physics-informed machine learning with differentiable programming, and solves a full-physics model that is used for the training and testing of the machine learning process. We identify the following four significant differences between our approach and the prior studies: (1) we consider a full-physics model using the DPFEHM framework62 that accounts for the permeability field\u2019s heterogeneity, which was overlooked or deemed too expensive by previous studies as discussed in45; (2) our physics model is differentiable, which in alternative approaches, such as PINNs, do not rigorously guarantee that the physical constraints will be satisfied; (3) we use a steady-state equation that looks at the long-term impact of the injection/extraction. Harp et\u00a0al.45 considered only a fixed time in the future, which limited the ability to evaluate the sustainability of the injection process; and (4) DPFEHM allows us to combine a rigorous, trustworthy physics model with Convolutional Neural Networks (CNN) that have built-in AD. In addition, DPFEHM minimizes the time for code development by automatically creating the execution code from a short description of the equations of interest.\nTable 1. Summary of the main prior studies and their application field.\nStudy Year\nApplication\nCO2 Sequestration CO2 enhanced oil recovery Geothermal energy Oil and gas extraction\nInjection/ extraction\nCihan et\u00a0al.11 (2015) X\nHarp et\u00a0al.12 (2017) X\nKrasnov et\u00a0al.25 (2017) X X\nHegde et\u00a0al.38 (2017) X\nChen et\u00a0al.14 (2018) X\nMenad et\u00a0al.15 (2019) X\nYou et\u00a0al.26 (2019) X\nChen et\u00a0al.29 (2019) X\nHanga et\u00a0al.39 (2019) X\nYou et\u00a0al.30,31 (2020) X\nSinha et\u00a0al.16 (2020) X\nHarp et\u00a0al.45 (2021) X\nPirizadeh et\u00a0al.28 (2021) X\nSircar et\u00a0al.41 (2021) X\nMohamadian et\u00a0al.42 (2021) X\nAhmmed et\u00a0al.20 (2021) X\nAhmmed et\u00a0al.37 (2022) X\nYan et\u00a0al.21\u201323 (2022) X\n3 Vol.:(0123456789) Scientific Reports | (2022) 12:18734 | https://doi.org/10.1038/s41598-022-22832-7\nOne way to develop a full-physics model for pressure management in the context of CO2 sequestration would require the completion of the following steps: (1) development of a simple pressure management PIML framework solving the analytical Theis model63 as shown by Harp et\u00a0al.45; (2) development of a pressure management PIML framework using a full-physics model with heterogeneous permeability field, which we demonstrate in the current study; and (3) adding a multi-phase model. Our single-phase pressure management model is more relevant to wastewater injection. However, including a full-physics model in the ML workflow and accounting for heterogeneity are essential steps towards pressure management for multi-phase injection scenarios such as CO2 sequestration. Furthermore, without this PIML framework, we would be unable to do uncertainty quantification (UQ) in real-time since thousands (or more) partial differential equation-constrained optimization problems would be required."
        },
        {
            "heading": "Methods",
            "text": "Operators at underground reservoir sites require pressure management systems to make informed decisions for the injection/extraction rates to minimize the risk of leakage and induced seismicity and maximize the reservoir\u2019s performance (e.g., maximize the net fluid injected). The traditional approach to constructing pressure management systems uses full-order physics models that do not allow for UQ in real-time. Existing alternatives, such as the work of Harp et\u00a0al.45, used a highly simplified homogeneous model which neglects heterogeneity. In reality, the subsurface is highly heterogeneous, so for the model to be trustworthy, heterogeneity must be accounted for. Our PIML framework uses a full-physics model and ML combined with DP, making this approach computationally and practically feasible.\nA schematic representation of the proposed PIML framework is shown in Fig.\u00a01. We use this framework to determine the fluid extraction rates at an extraction well to maintain the pressure at a critical location in a reservoir with a heterogeneous permeability field. We achieve this by using a neural network model (NNM) trained on a set of permeability fields that, along with the NNM-predicted extraction rate, act as an input to the full-physics DPFEHM model. The NNM is trained to determine the extraction rates for a heterogeneous permeability field. The physics constraints needed for the training process are incorporated through the DPFEHM framework, which provides the physics information in our PIML framework. Our framework has similarities to the works of Harp et\u00a0al.45 and Srinivasan et\u00a0al.64, that use physics-informed neural networks with physical constraints used during the NNM training. A significant difference in our approach is that instead of using a differentiable, simple analytical solution, we use a differentiable numerical physics model. Alternative approaches such as PINNs do not have rigorous guarantees that the physical constraints will be satisfied.\nWe executed a suite of training scenarios using a single-phase model with heterogeneous permeability fields randomly generated using a Gaussian distribution function. Since the model has many parameters, computing finite-difference gradients become infeasible, and the only efficient approach to solve the problem is by using reverse-mode automatic differentiation. We perform a hyperparameter search by varying the batch size (i.e., the number of training samples included in each gradient calculation) and the learning rate (i.e., the step size controlling the rate at which each iteration moves towards the minimum of the loss function).\nPhysics model. We consider the pressure change during injection/extraction of a single-phase fluid flow in a heterogeneous permeability field. Such subsurface reservoirs are modeled using the following equation\nwhere k(x) are heterogeneous permeability fields depending on the position x, h is the pressure head and f is the injection/extraction. This is a steady-state equation which allows us to evaluate the long-term impact of the injection and the extraction on the pressure head.\nThe equation is solved using DPFEHM62. DPFEHM uses the standard two-point flux finite volume approximation, which results in a trustworthy solution to the physics model. In addition, DPFEHM has built-in AD that makes the transition between the physics model and the machine learning model seamless.\n(1)\u2207 \u00b7 ( k(x) \u00b7 \u2207h ) = f ,\nFigure\u00a01. (Color online) Workflow diagram of physics-informed machine learning framework for managing reservoir pressures at a critical location during subsurface fluid injection. The key innovation of the surrogate model is the automatically-differentiable full-order model that allows for heterogeneity.\n4 Vol:.(1234567890) Scientific Reports | (2022) 12:18734 | https://doi.org/10.1038/s41598-022-22832-7\nPIML framework. As shown in Fig.\u00a0 1, our PIML framework trains an NNM to estimate the extraction rates at dedicated extraction wells to maintain predefined pressures at critical locations during fluid injection. This is necessary near faults with high induced seismicity risk or at abandoned wellbores with leakage potential. To make the model more realistic, we randomly initialized heterogeneous permeability fields using a Gaussian distribution function. The PIML framework is part of the DPFEHM package, which is available at https:// github. com/ Orcha rdLANL/ DPFEHM. jl.\nThe PIML workflow consists of the following steps:\n1. Generate a training dataset that consists of Nb batches and Ns samples per batch. We use heterogeneous permeability samples, randomly initialized using a Gaussian distribution function. 2. Construct a CNN with an input layer that accepts a permeability field and an output layer that estimates the fluid extraction rates at the extraction well. 3. Calculate a loss function that quantifies the error between the model\u2019s overpressure and the target overpressure at a critical location. 4. Train the CNN to determine the extraction rates that minimize the error between the model\u2019s overpressure and the target overpressure at a critical location by adjusting the CNN model parameters based on the lossfunction parameter gradients.\nIn step 2, the PIML framework trains a CNN based on LeNet-565 to determine the extraction rates at an extraction well to maintain pressure at critical locations, such as faults with induced seismicity risk or abandoned wellbores with leakage potential, during fluid injection at dedicated injection wells with heterogeneous permeability fields. LeNet-5\u2019s architecture consists of a convolutional encoder with two convolutional layers and a dense block with three fully-connected layers. For this work, we use a slightly modified LeNet-5 CNN with the following architecture:\nWe use two convolutional layers, two subsampling layers, a flattening operation, and a fully connected dense block. Each convolutional layer uses a 5x5 kernel and a max pooling subsampling layer which calculates the maximum of the values present in each kernel. The first convolutional layer has 6 output channels, and the second one has 16. The activation function with a stride of 2 reduces the dimensionality through downsampling by a factor of 4. We flatten the output of the convolutional block by taking the four-dimensional input and transforming it into two-dimensional input to be compatible with the fully-connected dense block. The dense block has three fully-connected layers, with 120, 84, and 1 outputs, respectively. Relu activation functions are used for all hidden layers as \u03c3(x) = max(0, x) , with x being the input and \u03c3(x) being the output of the neuron. The last dense layer outputs a single value associated with the extraction rate, Qext.\nDuring preliminary investigations, we explored the use of more complex deep neural networks (such as the VGG1666) with a larger number of neurons and/or more hidden layers; however, they did not improve the convergence speed and thus the performance of the PIML framework. On the contrary, in some cases, they led to slower convergence and worse overall results. The reason for this is most likely that larger networks are more prone to complex response surfaces, which increases the chance for the training to become trapped in local minima. By contrast, our empirical results suggest that LeNet-5 provides a good balance between strong performance and ease of training. As we transition to more complex physics models, the ease of training becomes more critical when the data sets become smaller. Nonetheless, the optimal architecture for these problems remains an exciting area for research.\nIn step 3, the loss function is defined as the sum of the squared errors between the simulated and the target overpressures at a critical location as\nwith Nb being the number of batches, Ns the number of samples per batch, and htarget the target overpressure. The predicted overpressure h is a function of the injection rate QNN and the permeability kj(x) at a specific position. QNN is calculated using the LeNet-5 CNN model and takes two parameter, \u03b8 being the model parameters and kj(x) permeability. From the loss function we calculate the root-mean-square error (RMSE) as\n(2)L (\u03b8) = Nb \u2211\ni\nNs \u2211\nj\n[\n\ufffdh ( QNN ( \u03b8 , kj(x) ) , kj(x) ) \u2212\ufffdhtarget ]2 ,\n5 Vol.:(0123456789) Scientific Reports | (2022) 12:18734 | https://doi.org/10.1038/s41598-022-22832-7\nIn step 4, the NNM is trained to minimize the loss function L (\u03b8) as\nusing an Adam optimizer from the Julia Flux package67. We use the DPFEHM package to solve the full-physics model as shown in Eq.1. Within the DPFEHM framework, we automatically differentiate the physics model using Julia\u2019s Zygote package68.\nDifferentiable programming. Traditional physics models are rarely automatically differentiable and require the usage of finite difference methods to compute parameter gradients55\u201359. This is computationally inefficient and makes incorporating these models in a machine learning workflow infeasible when the number of parameters is large. When looking at a large number of physics-model parameters in a PIML framework, choosing the most efficient way to calculate gradients is essential for the algorithm\u2019s success. This is because computing the gradient of the loss function is central to training machine learning models.\nIn computational fluid dynamics, finite-differences or numerical differentiation are often used to compute gradients, but that could be computationally expensive, especially when the number of input parameters grows. The number of model runs required to compute the gradient is proportional to the number of input parameters. When using finite difference (FD), the quality of the solution is also greatly influenced by the truncation and round-off errors associated with different finite difference formulas. An alternative is using differentiable programming (DP), and in particular, reverse-mode AD, which utilizes the chain rule to calculate complex derivatives. It breaks a computer program down into elementary operations, which allows the derivatives to be evaluated accurately to working precision. Reverse-mode AD becomes more efficient when the number of model inputs is large (e.g., the parameters of a neural network) and the number of model outputs is small (e.g., the loss), which can be demonstrated with the following example: The LeNet-5 model uses approximately 1 million model parameters, which gradients can be obtained using AD in a single forward and backward model pass regardless of the number of model parameters; in comparison, using a central finite-difference model, we would have to calculate two forward simulations per model parameter which results in 2 million forward calls. In AD, the advantage of using reverse-mode AD (akin to adjoint methods) comes from its computational cost being independent of the number of design variables. By contrast, the cost of the forward sensitivity analysis increases linearly with the number of design variables69. Depending on the simulator and the application, the AD adjoint simulations can be more expensive than the forward simulations; however, the discrepancies in execution time have been decreasing with the development of DP60,70. For a physics simulator, which typically involves a solution of a system of equations, the backward pass requires only the solution of a linear system of equations (even if the underlying equations are nonlinear). So in this setting, the backward pass is rarely more expensive than the forward pass."
        },
        {
            "heading": "Results",
            "text": "The physics model includes an injection well, an extraction well, and a critical location. The injection well injects water at a rate of 1.0MMT/y (million metric tons per year), which is equivalent to 0.031688m3/s . The extraction well protects the critical location where a target overpressure (change in pressure from pre-injection conditions) is set to 0.0 MPa. The permeability field is randomly initialized using a multivariate Gaussian distribution function with a correlation length of 50 m and log standard deviation equal to 1. A schematic representation of the simulation configuration is shown in Fig.\u00a02, where we indicate the positions of the injection, extraction, and critical location. The permeability field is illustrated using a color map, where blue and red denote low and high permeability, respectively. The size of the simulated domain is 400 meters on each side. Our PIML framework trains the neural network to achieve the target overpressure at the critical location for a given permeability field. We solve a steady-state equation that captures the long-term impact of the injection/extraction. The background reservoir pressure in our simulation is equal to 19.0\u00a0MPa, which is in line with MPC 26-5 well located in Kemper County, Mississippi. MPC 26-5 well is part of the ECO2 S project and its depth is 1791 meters71,72.\nThe PIML algorithm uses 512, 1024, 2048, or 4096 training and disjoint testing samples per epoch depending on the batch size, where the batch size ranges from 32 to 256. The testing data is sampled only once from a multivariate Gaussian distribution, while the training data is sampled in every epoch. Our PIML model solves a the physics problem using a unique permeability field for each random sample in each epoch and uses that information to compare the predicted and the target overpressure in the loss function as given in Eq.\u00a02. This characteristic of our framework ensures that the ML model has an (almost) infinite supply of unique datasets, formally called synthetic datasets. That is, the model never sees the same data point twice, so there is little risk of overfitting, a unique characteristic of the DP that allows for data to be generated on the fly compared to other ML models that use just a fixed set of data obtained from simulations or/and measurements. This is possible because our DP approach has the physics model in the training loop. Therefore, generating the training data (synthetic data) and running the model is unnecessary before the training begins. The total number of executed epochs is 10,000, but similar results could be obtained using a much smaller number of epochs on the order of 4,000. The training samples are randomly initialized before training each epoch, making the total number of unique training samples for the batch size of 256 equal to 40,960,000 throughout the ML training. The test samples are initialized only once before starting the first epoch. We ran the training on a central processing unit (CPU) with an AMD EPYC 7702P 64-Core processor without parallelization paradigms. The smallest training ran for about\n(3)RMSE(\u03b8) =\n\u221a\nL (\u03b8) NbNs .\n(4)min\u03b8 = L (\u03b8).\n6 Vol:.(1234567890) Scientific Reports | (2022) 12:18734 | https://doi.org/10.1038/s41598-022-22832-7\n6 hours on a CPU, while the training with 256 batch size took about 48 hours for 10,000 epochs. We could have stopped the training at epoch 4,000 since we do not see significant improvement of the results. This would have reduced the time for the ML training by more than half.\nWe perform a hyperparameter search in which we test the RMSE for a variety of batch sizes ( bsize \u2208 [32, 64, 128, 256] ), and learning rates ( lr \u2208 [1e\u22123, 3e\u22124, 1e\u22124] ) as shown in Table\u00a02. The hyperparameter search shows that by decreasing the learning rate from lr = 1e\u22123 to lr = 1e\u22124 , the RMSE decreases three to four times for each batch size. The best results are achieved using a batch size and learning rate equal to 256 and 1e\u22124 , respectively. The results can be potentially improved by further decreasing the learning rate. However, we did not expand the search since the model was producing results that were within acceptable limits.\nFigure\u00a03 illustrates the rate at which the RMSE decreases with the number of epochs. The results are for the best hyperparameters we tested during PIML training, which uses a batch size of 256 and a learning rate equal to\nFigure\u00a02. (Color online) Diagram of a single-phase pressure management with heterogeneous permeability field including one injection and one extraction wells, and a critical location. This figure was created using Julia Version 1.6.273,74, and the DPFEHM framework62.\nbsize = 32 bsize = 64 bsize = 128 bsize = 256\nlr = 1e\u22123 0.018658 0.013856 0.010190 0.009823\nlr = 3e\u22124 0.005779 0.015159 0.005228 0.006147\nlr = 1e\u22124 0.005332 0.003719 0.002852 0.002786\nFigure\u00a03. (Color online) RMSE for the best training set from the hyperparameter search ( bsize = 256 , and lr = 1e\u22124 ). The minimum RMSE is equal to 0.002786\u00a0MPa overpressure at the critical location. This figure was created using Julia Version 1.6.273,74, and the DPFEHM framework62.\n7 Vol.:(0123456789) Scientific Reports | (2022) 12:18734 | https://doi.org/10.1038/s41598-022-22832-7\n1e\u22124 . The figure shows the training RMSE error in blue and the testing RMSE in red. We observe a rapid decrease in the RMSE at the beginning of the training. In later epochs (after approximately 4000 epochs), the RMSE starts to decrease much slower, reaching a plateau around 8000 epochs with an overall error reduction of 99%. The minimum RMSE reached using the testing data samples is 0.002786\u00a0MPa, which is small in comparison to the overpressure caused by the injection and makes the model sufficiently accurate to be used in practice. That is, other factors beyond errors in the injection rate, such as uncertainty about the heterogeneity, will impact the decision-making process for the extraction rate, and this model could be used to help find an appropriate extraction rate given uncertainty by predicting an ensemble of extraction rates for a variety of permeability fields.\nAfter training the PIML frameworks, we can use them to generate extraction rates and overpressures at the critical location given a heterogeneous permeability field. In Fig.\u00a04, we illustrate the resulting pressures and overpressures for a random permeability field within the domain. We used the same permeability field as shown in Fig.\u00a02, and the PIML framework for which we achieved the lowest RMSE ( bsize = 256 and lr = 1e\u22124 ). The background pressure of the MPC 26-5 well is 19.0\u00a0MPa, which is reflected in the total pressure of the well depicted in Fig.\u00a04a. Fig.\u00a04b shows that the prescribed pressure at the critical location, 0.0\u00a0MPa, is obtained by the PIML framework with good accuracy and, despite the small deviation, still falls into an acceptable range. As expected, the overpressure rates at the injection well are considerably larger, up to 6\u00a0MPa. At the same time, at the extraction well, we achieve negative overpressure, which protects the critical location from exceeding the prescribed 0.0\u00a0MPa.\nNext, we look at the distribution of extraction rates and overpressures at the critical location after running 10,000 random heterogeneous field samples through our PIML framework as shown in Fig.\u00a05. The distribution function of the extraction rate, depicted in Fig.\u00a05a, is skewed and shows that most of the samples require an extraction rate in the range of \u22120.009\u00a0m3/s to \u22120.001\u00a0m3/s in 90% of the time. Compared to our injection rate of 1.0\u00a0MMT/year, the extraction rate is equal to \u22120.283824\u00a0MMT/year, and \u22120.031536\u00a0MMT/year, respectively. Fig.\u00a05b illustrates that the overpressure at the critical location deviates very slightly from the prescribed overpressure, specifically in the range of \u22120.003\u00a0MPa to 0.006\u00a0MPa in 90% of the time. These results confirm that the PIML framework can provide useful information for the operators of pressure management systems.\nOverall, solving the physics model on a CPU (AMD EPYC 7702P 64-Core) takes 5.9e\u22123\u00a0seconds, and obtaining the extraction rates using the trained PIML model on a GPU (NVIDIA RTX A6000) takes only 1.4e\u22128\u00a0seconds (equivalent to 14 nanoseconds) per sample. Our framework solves the constrained optimization model more than 400\u00a0000 times faster than solving the physics model allowing for near real-time analysis and robust uncertainty quantification. We obtained these results using a total number of 50\u00a0000 to fully utilize the GPU, and we excluded the time needed to train the PIML model, since this is done a priori and does not affect the reservoir operators."
        },
        {
            "heading": "Discussion",
            "text": "We have demonstrated that the PIML framework can successfully manage subsurface pressures by controlling fluid extraction in heterogeneous permeability fields. Such operations are relevant for resource extraction (oil and gas), climate mitigation (CO2 sequestration), and production of renewable energy (geothermal energy). A similar PIML approach has already been evaluated by45 using homogeneous permeability. We have added a significantly more complex physics model using the DPFEHM framework to ensure a seamless transition\nFigure\u00a04. (Color online) (a) Resulting pressure distribution within the reservoir. The positions of the injection/ extraction and critical locations are indicated; (b) Overpressure values within the prescribed domain extracted from the PIML framework. The blue and red triangles denote respectively the position of the extraction and the injection wells, respectively, while the circle depicts the critical location at which a target pressure is set. These figures were created using Julia Version 1.6.273,74, and the DPFEHM framework62.\n8 Vol:.(1234567890) Scientific Reports | (2022) 12:18734 | https://doi.org/10.1038/s41598-022-22832-7\nbetween the execution of the physics model and the machine learning model. We show that a PIML framework with built-in AD can train an NNM to determine the fluid extraction needed to achieve pressure management goals while injecting large amounts of fluid into the subsurface. This has the potential to help operators at sites effectively manage reservoir pressures and can be coupled with decision-making strategies to attain operational efficiencies75\u201379.\nThe computational cost is modest enough that it can be run on a single CPU with AMD EPYC7702P 64-Core processor without parallelization. However, the full-physics model and the heterogeneity add complexity to the model that is only feasible because of the DPFEHM framework and its built-in AD. The number of training epochs can be reduced depending on the accuracy demands, which can be a helpful strategy when considering a more complex physics model. Our results showed that, though we trained for 10,000 epochs, a much smaller number could be used to obtain accuracy consistent with realistic operational goals. This could be important when using more complex physics models (such as multi-phase flow) to keep the computational cost manageable. Parallelization could also be exploited in these cases.\nWe tested different convolutional neural networks, one of them was the VGG Net, a very deep CNN often used for image recognition66. To execute the VGG Net more efficiently, we used a hybrid approach, in which the ML model was executed on the GPU while the physics model was executed on the CPU. Even though the VGG Net is significantly deeper, it did not improve the RMSE of the training and sometimes performed worse. However, such a neural network could be more efficient when training on even more complex physics models such as multi-phase models needed for investigating climate mitigation and, in particular CO2 sequestration. These models might require a more complex network to deal with the more complex physics present in these cases, but this is a topic for future research.\nIn addition, we batch-parallelized the model using Julia\u2019s parallel map operation implemented as a pmapfunction. Since our physics model is only modestly expensive, the communication between processes was longer than the time needed for the computation. Therefore, the pmap did not improve the performance. However, this technique could be used more effectively when investigating more complex physics models, such as multi-phase flow. Again, this is a topic for future research.\nWe anticipate that other machine learning models such as support vector regression, random forest, or supervised machine learning, will not outperform the proposed PIML model with DP. Taking into account the definition of our problem \u2013 learning an extraction rate from given permeability data (resembling a 400 x 400 pixel image), injection rates and a fixed pressure at a critical location, we think that using CNNs is a natural choice. They are able to handle a large number of images (in our case permeability fields) and have the flexibility to train using a large number of model parameters. SVR, random forest and supervised ML would not exploit the image structure of the problem. In addition, we would not get better performance with either of these techniques. For the level of full-physics and ML model complexity, the performance we get is really good. We would like to mention that previous works were unable to solve in reasonable time much simpler problems and having a heterogeneous PIML model for pressure management was often infeasible.\nHere, we would like to emphasize some of the advantages and the limitations of our PIML framework:\n+ the framework is able to predict extraction rates to manage subsurface pressures in heterogeneous permeability fields; + the framework can use a large number of ML model parameters due to the built-in AD in DPFEHM;\nFigure\u00a05. (Color online) (a) Extraction rates in cubic meters per second [ m3/s ]; (b) Overpressure at the critical location in pressure units [MPa]. These figures were created using Julia Version 1.6.273,74, and the DPFEHM framework62.\n9 Vol.:(0123456789) Scientific Reports | (2022) 12:18734 | https://doi.org/10.1038/s41598-022-22832-7\n+ the framework uses a well-know LeNeT-5 CNN, that has a simple architecture, it is fast and predicts the extraction rates with an acceptable accuracy; + the framework uses a dataset which is produced by solving the full-physics model. Solving the physics model is fully integrated in the training loop, which allows for data to be generated on the fly compared to other ML models that use just a fixed set of data; + the framework gives a direct solution on how to control subsurface pressures; + the physics model can be batch-parallelized using Julia\u2019s parallel map operation implemented as a pmapfunction, while the ML model can be executed using GPUs. Both of these have been already implemented and tested. For the current problem we did not see significant speed-up, since the physics and the ML models are only modestly expensive; \u2013 the framework does not address issues such as maximizing storage capacity by tuning the injection/extraction rates; \u2013 the full-physics model solves a single-phase steady-state fluid flow with heterogeneity, and currently cannot be used to solve multi-phase flows, which are essential for CO2 sequestration and other applications.\u201d\nIn order to extend the framework to multi-physics fluid flows, we would need to perform the following steps: (1) implement a multi-phase full-physics model as part of the DPFEHM framework, (2) use more sophisticated ML model to be able to capture the complexity coming from the physics model and increase the number of parameters and the depth of the network, (3) use CPU and GPU parallelization paradigms to improve the performance and ensure the feasibility of the problem. We plan to pursue this problem in the future."
        },
        {
            "heading": "Conclusions",
            "text": "We applied a PIML framework to a subsurface pressure management problem that considers the pressure change during injection/extraction. We considered a single-phase steady-state fluid flow with heterogeneity that looks at the long-term impact of the injection/extraction on the reservoir. In our PIML framework, a convolutional NNM is trained to determine fluid extraction rates at a dedicated critical reservoir location during the injection. We performed a hyperparameter search, which showed that decreasing the learning rate while increasing the batch size improves the results. In conclusion, we would emphasize the following observations:\n\u2022 A PIML framework can train a convolutional NNM to manage reservoir pressures with heterogeneous permeability fields resulting in small deviations from the target overpressure. We accomplished this by combining a differentiable full-physics simulator with a convolutional neural network. \u2022 This problem is only feasible because of the DPFEHM framework, which has a built-in AD. To solve the physics model, we use the DPFEHM framework as part of the PIML framework. \u2022 DPFEHM allows us to bridge the gap between numerical models and machine learning techniques because both are compatible with the same AD frameworks \u2022 The hyperparameter search shows that decreasing the learning rate and increasing the batch size is beneficial for bringing down the RMSE of the ML training. Our results can be potentially improved by further decreasing the learning rate. \u2022 We tested a hybrid implementation of the PIML framework using a deeper convolutional neural network (VGG Net). In that case, the physics model is solved on a CPU, while the machine learning model is solved on a GPU. The results showed no improvement in the ML training, concluding that the relatively simple LeNet network suffices for this problem. \u2022 We also batch-parallelized the combined NNM and physics model using Julia\u2019s parallel map operation (pmap). However, for the single-phase steady-state flow problem with heterogeneity, the added communication costs outweigh the benefits of parallelization. This is because the physical model, in this case, is relatively inexpensive. We anticipate that for more complex physics models, such as introducing a multi-phase flow, will benefit from such parallelization. \u2022 A natural next step in this line of research is to study this problem in the context of multi-phase flows, which are essential for CO2 sequestration, among other applications."
        },
        {
            "heading": "Data availability",
            "text": "All data in this paper is synthetically generated. The computer code for generating and analyzing the data are available at https:// github. com/ Orcha rdLANL/ DPFEHM. jl.\nReceived: 21 June 2022; Accepted: 19 October 2022"
        },
        {
            "heading": "Acknowledgements",
            "text": "AP acknowledges funding from Center for Nonlinear Studies (CNLS) at Los Alamos National Laboratory. DO acknowledges support from Los Alamos National Laboratory\u2019s Laboratory Directed Research and Development Early Career Award (20200575ECR). The authors acknowledge support from the US Department of Energy\u2019s Science-informed Machine-learning for Accelerating Real-Time decisions (SMART) initiative."
        },
        {
            "heading": "Author contributions",
            "text": "A.P.: Data curation, Formal analysis, Investigation, Methodology, Software, Validation, Visualization, Writing\u2014 original draft, Writing\u2014review and editing. D.O.: Conceptualization, Formal analysis, Software, Methodology, Writing\u2014review and editing. D.R.H.: Software, Writing\u2014review and editing. H.V.: Funding acquisition, Writing\u2014review and editing."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Correspondence and requests for materials should be addressed to A.P.\nReprints and permissions information is available at www.nature.com/reprints.\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\n12\nVol:.(1234567890)\nScientific Reports | (2022) 12:18734 | https://doi.org/10.1038/s41598-022-22832-7\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or\nformat, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http:// creat iveco mmons. org/ licen ses/ by/4. 0/.\n\u00a9 The Author(s) 2022"
        }
    ],
    "title": "Physics\u2010informed machine learning with differentiable programming for heterogeneous underground reservoir pressure management",
    "year": 2022
}