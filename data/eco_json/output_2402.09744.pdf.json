{
    "abstractText": "We propose a new framework for assessing Granger causality in quantiles in unstable environments, for a fixed quantile or over a continuum of quantile levels. Our proposed test statistics are consistent against fixed alternatives, they have nontrivial power against local alternatives, and they are pivotal in certain important special cases. In addition, we show the validity of a bootstrap procedure when asymptotic distributions depend on nuisance parameters. Monte Carlo simulations reveal that the proposed test statistics have correct empirical size and high power, even in absence of structural breaks. Finally, two empirical applications in energy economics and macroeconomics highlight the applicability of our method as the new tests provide stronger evidence of Granger causality.",
    "authors": [
        {
            "affiliations": [],
            "name": "Alexander Mayer"
        },
        {
            "affiliations": [],
            "name": "Dominik Wied"
        },
        {
            "affiliations": [],
            "name": "Victor Troster"
        }
    ],
    "id": "SP:a06725c10d5e98df8386310cbf5648b383c86eae",
    "references": [
        {
            "authors": [
                "D.W. Andrews"
            ],
            "title": "Tests for Parameter Instability and Structural Change with Unknown Change Point,",
            "venue": "Econometrica: Journal of the Econometric Society,",
            "year": 1993
        },
        {
            "authors": [
                "D.W.K. Andrews"
            ],
            "title": "Optimal Tests when a Nuisance Parameter is Present only under the Alternative,",
            "venue": "Ploberger",
            "year": 1994
        },
        {
            "authors": [
                "B. Candelon"
            ],
            "title": "A Nonparametric Test for Granger Causality in Distribution With Application to Financial Contagion,",
            "venue": "Tokpavi",
            "year": 2016
        },
        {
            "authors": [
                "M. Caporin"
            ],
            "title": "Time-varying Granger Causality Tests in the Energy Markets: A Study on the DCC-MGARCH Hong test,",
            "venue": "Costola",
            "year": 2022
        },
        {
            "authors": [
                "Chen",
                "Y.-C",
                "K.S. Rogoff",
                "B. Rossi"
            ],
            "title": "Can Exchange Rates Forecast Commodity Prices?",
            "venue": "The Quarterly Journal of Economics,",
            "year": 2010
        },
        {
            "authors": [
                "Chuang",
                "C.-C",
                "C.-M. Kuan",
                "H.-Y"
            ],
            "title": "Causality in Quantiles and Dynamic Stock Return-Volume Relations,",
            "venue": "Journal of Banking & Finance,",
            "year": 2009
        },
        {
            "authors": [
                "T.E. Clark",
                "M.W. McCracken"
            ],
            "title": "The Predictive Content of the Output Gap for Inflation: Resolving In-Sample and Out-of-Sample Evidence,",
            "venue": "Journal of Money, Credit and Banking,",
            "year": 2006
        },
        {
            "authors": [
                "H. Ding",
                "H.-G. Kim",
                "S.Y. Park"
            ],
            "title": "Crude Oil and Stock Markets: Causal Relationships in Tails?",
            "venue": "Energy Economics,",
            "year": 2016
        },
        {
            "authors": [
                "A.F. Galvao",
                "G. Montes-Rojas",
                "S.Y. Park"
            ],
            "title": "Quantile Autoregressive Distributed Lag Model with an Application to House Price Returns,",
            "venue": "Oxford Bulletin of Economics and Statistics,",
            "year": 2013
        },
        {
            "authors": [
                "R. Giacomini",
                "B. Rossi"
            ],
            "title": "Forecast Comparisons in Unstable Environments,",
            "venue": "Journal of Applied Econometrics,",
            "year": 2010
        },
        {
            "authors": [
                "C.W. Granger"
            ],
            "title": "Investigating Causal Relations by Econometric Models and Cross-Spectral Methods,",
            "venue": "Econometrica: Journal of the Econometric Society,",
            "year": 1969
        },
        {
            "authors": [
                "B.E. Hansen"
            ],
            "title": "Stochastic Equicontinuity for Unbounded Dependent Heterogeneous Arrays,",
            "venue": "Econometric Theory,",
            "year": 1996
        },
        {
            "authors": [
                "K. Jeong",
                "W.K. H\u00e4rdle",
                "S. Song"
            ],
            "title": "A Consistent Nonparametric Test for Causality in Quantile,",
            "venue": "Econometric Theory,",
            "year": 2012
        },
        {
            "authors": [
                "R. Koenker",
                "J.A.F. Machado"
            ],
            "title": "Goodness of Fit and Related Inference Processes for Quantile Regression,",
            "venue": "Journal of the American Statistical Association,",
            "year": 1999
        },
        {
            "authors": [
                "R. Koenker",
                "S. Portnoy",
                "P.T. Ng",
                "A. Zeileis",
                "P. Grosjean",
                "B.D. Ripley"
            ],
            "title": "Package \u2018quantreg\u2019,\u201d Reference manual available at R-CRAN: https://cran",
            "venue": "rproject. org/web/packages/quantreg/quantreg. pdf",
            "year": 2018
        },
        {
            "authors": [
                "Lee",
                "T.-H",
                "W. Yang"
            ],
            "title": "Money-Income Granger-Causality in Quantiles,",
            "venue": "Anniversary Edition (Advances in Econometrics,",
            "year": 2012
        },
        {
            "authors": [
                "T. Oka",
                "Z. Qu"
            ],
            "title": "Estimating Structural Changes in Regression Quantiles,",
            "venue": "Journal of Econometrics,",
            "year": 2011
        },
        {
            "authors": [
                "J.L. Powell"
            ],
            "title": "Estimation of monotonic regression models under quantile restrictions,",
            "year": 1991
        },
        {
            "authors": [
                "Z. Qu"
            ],
            "title": "Testing for Structural Change in Regression Quantiles,",
            "venue": "Journal of Econometrics,",
            "year": 2008
        },
        {
            "authors": [
                "B. Rossi"
            ],
            "title": "Optimal Tests for Nested Model Selection with Underlying Parameter Instability,",
            "venue": "Econometric Theory,",
            "year": 2005
        },
        {
            "authors": [
                "B. Rossi",
                "Y. Wang"
            ],
            "title": "Vector Autoregressive-Based Granger Causality Test in the Presence of Instabilities,",
            "venue": "The Stata Journal,",
            "year": 2019
        },
        {
            "authors": [
                "C. Rothe",
                "D. Wied"
            ],
            "title": "Misspecification Testing in a Class of Conditional Distributional Models,",
            "venue": "Journal of the American Statistical Association,",
            "year": 2013
        },
        {
            "authors": [
                "F. Sowell"
            ],
            "title": "Optimal Tests for Parameter Instability in the Generalized Method of Moments Framework,",
            "venue": "Econometrica: Journal of the Econometric Society,",
            "year": 1996
        },
        {
            "authors": [
                "J.H. Stock",
                "M. Watson"
            ],
            "title": "Forecasting Output and Inflation: The Role of Asset Prices,",
            "venue": "Journal of Economic Literature,",
            "year": 2003
        },
        {
            "authors": [
                "J.H. Stock",
                "M.W. Watson"
            ],
            "title": "Evidence on Structural Instability in Macroeconomic Time Series Relations,",
            "venue": "Journal of Business & Economic Statistics,",
            "year": 1996
        },
        {
            "authors": [
                "V. Troster"
            ],
            "title": "Testing for Granger-Causality in Quantiles,",
            "venue": "Econometric Reviews,",
            "year": 2018
        },
        {
            "authors": [
                "D. Wied",
                "W. Kr\u00e4mer",
                "H. Dehling"
            ],
            "title": "Testing for a Change in Correlation at an Unknown Point in Time Using an Extended Functional Delta Method,",
            "venue": "Econometric Theory,",
            "year": 2012
        },
        {
            "authors": [
                "Z. Yang",
                "A. Tu",
                "Y. Zeng"
            ],
            "title": "Dynamic Linkages between Asian Stock Prices and Exchange rates: New Evidence from Causality in Quantiles,",
            "venue": "Applied Economics,",
            "year": 2014
        },
        {
            "authors": [
                "Koenker",
                "Machado"
            ],
            "title": "Proof of Thm 1) for the partitioning. Moreover, some algebra reveals",
            "year": 1999
        },
        {
            "authors": [
                "Im \u2212 P (\u03c4) = RR"
            ],
            "title": "Moreover, if T (\u03c4) is the inverse of the m\u00d7m matrix of eigenvectors of Im \u2212P (\u03c4), then, by the Jordan decomposition",
            "venue": "(see e.g. Abadir and Magnus,",
            "year": 2005
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n40 2.\n09 74\n4v 1\n[ ec\non .E\nM ]\nWe propose a new framework for assessing Granger causality in quantiles in unstable environments, for a fixed quantile or over a continuum of quantile levels. Our proposed test statistics are consistent against fixed alternatives, they have nontrivial power against local alternatives, and they are pivotal in certain important special cases. In addition, we show the validity of a bootstrap procedure when asymptotic distributions depend on nuisance parameters. Monte Carlo simulations reveal that the proposed test statistics have correct empirical size and high power, even in absence of structural breaks. Finally, two empirical applications in energy economics and macroeconomics highlight the applicability of our method as the new tests provide stronger evidence of Granger causality. Keywords: Granger causality, Quantile regression, Parameter instability, Structural breaks, Bootstrap. JEL classification: C12, C22, C52.\n\u2217Corresponding author. E-mail address: alexandersimon.mayer@unive.it. We would like to thank Lukas Hoesch for helpful comments and highly appreciate the suggestions and comments made by participants at the Econometrics Workshop 2024 at the Goethe University Frankfurt."
        },
        {
            "heading": "1 Introduction",
            "text": "The definition of Granger (1969) causality is a fundamental concept in time series econometrics. Accordingly, let zi denote a series contained within an information set that gathers all relevant information available up to time i, then zi is said to Granger-cause yi if zi provides information relevant to predicting yi. Although Granger causality is uncovered by the conditional distributions of yi, applied research focuses often on Granger causality in mean because it entails easily testable implications. However, by solely testing the significance of zi in a conditional mean regression of yi on zi, one runs the risk of neglecting possible tail relationships or nonlinearities.\nIt is for this reason that more recent research is also concerned with Granger causality in quantiles, which allows for an equivalent characterization of Granger causality in distribution. This implies that the conditional quantile function of yi depends on zi for some quantiles of interest, given all the available information until time i. For instance, Lee and Yang (2012) found fragile evidence of Granger causality between augmenting monetary policies and national income at the conditional mean; nevertheless, the authors reported strong evidence of Granger causality at extreme quantiles of the distribution.\nOne way to elicit potential evidence for Granger causality is by means of quantile regressions. Koenker and Machado (1999) developed a parametric significance test of quantile regression coefficients, which is frequently employed in empirical work to test for Granger causality in quantile regressions (see e.g. Chuang et al., 2009 or Yang et al., 2014). Troster (2018) extended the method of Koenker and Machado (1999) by providing a semiparametric omnibus test for Granger causality in quantiles that allows for nonlinear specifications of the quantile regressions under the null hypothesis of no Granger causality. On the other hand, Jeong et al. (2012), Taamouti et al. (2014) and Candelon and Tokpavi (2016) derived nonparametric tests for Granger causality in quantiles. Bouezmarni et al. (2024) proposed such a test for expectiles.\nWhat all these papers have in common, is, however, that they implicitly assume the pattern of Granger (non)causality to be stable over time. In this paper, we\ntherefore propose tests for Granger causality in quantiles that are robust against temporal instabilities. This is of importance because financial and macroeconomic data structures, where Granger causality is frequently tested, are subject to strong fluctuations and volatility (Clark and McCracken, 2006; Rossi, 2005, 2013; Rossi and Wang, 2019; Stock and Watson, 1996, 1999, 2003, 2006). Rossi (2006), for instance, provides evidence of failure of traditional Granger causality tests to detect Granger causality from certain macroeconomic fundamentals to exchange rate fluctuations due to parameter instabilities in the models over time. Chen et al. (2010), on the other hand, do report evidence of Granger causality from exchange rates to commodity prices, when applying Granger causality tests that allow for structural breaks. Caporin and Costola (2022) have made similar arguments. In addition, Giacomini and Rossi (2010), Rossi (2013), and Rossi (2021), among others, show that instabilities in the parameters of the models can affect the performance of Granger causality tests in different ways; hence, these authors recommend incorporating structural breaks in Granger causality tests rather than testing for instability in the parameters. Following this idea, it is important to apply methods that are robust to structural breaks or instabilities for correctly performing a Granger causality analysis in macroeconomic or financial time series.\nTo address potential temporal instabilities, we resort to the work of Rossi (2005), who\u2013by extending the earlier work by Sowell (1996)\u2013developed tests for nested model selection with underlying parameter instability. Although the methods of Rossi (2005) and, in particular, Rossi and Wang (2019) can be used to test for Granger causality in mean between two time series, they fall short to capture Granger causality in the tails or other parts of the conditional distribution not captured by the mean. The same is true for the time-varying Granger causality in-mean tests like the one employed, for example, by Chen et al. (2010) or Caporin and Costola (2022).\nWe thus extend the method of Rossi (2005) and Rossi and Wang (2019) in a consolidated way for testing for Granger causality in quantiles under structural instabilities. We do so by drawing from results on structural break testing in quantile regressions by Qu (2008) and Oka and Qu (2011). To our knowledge, no test for Granger causality in quantiles with structural instability has been developed so\nfar in the literature.\nMore specifically, the main idea is to consider under the null the intersection of two sub-hypotheses: First, we hypothesize that the effect of the potential Grangercausing variate is constant over time and over quantiles. Second, we assume that this effect is zero. Likewise, the alternative in a local neighbourhood around the null consists of two parts: one that specifies local deviations from the null hypothesis of no Granger causality in quantiles and another that specifies local deviations from the null hypothesis of constant parameters (over all quantiles of the distribution). Thus, we construct our test statistics in such a way that ensure non-trivial local power against the union of these two alternative hypotheses. For this reason, we do not require a priori knowledge of whether any of the two alternative subhypotheses holds (or whether both hold). Finally, we propose tests that neither involve trimming over time nor require the specification of tuning parameters.\nThis idea goes back to, inter alia, Sowell (1996) and Rossi (2005) who have developed similar test procedures in a general generalized method of moments (GMM) framework. Our extension is non-trivial. Unlike the GMM framework considered by Rossi (2005), we demonstrate, for example, that the limiting distribution might not be pivotal in certain cases. It is pivotal in certain important special cases such as homoskedasticity or conditional mean independence between regressors. In cases where the limiting distribution depends on nuisance parameters, we propose alternatives, including a new bootstrap procedure whose validity is established. This extends the semiparametric bootstrap used in Rothe and Wied (2013), where the estimated quantile functions are applied to uniformly distributed random variables. Therefore, we provide (bootstrap) test statistics with correct asymptotic size, which are consistent against fixed alternatives and possess nontrivial power against local alternative hypotheses. This is also corroborated by our Monte Carlo simulations; the finite-sample evidence shows that the test has appealing size and power properties in finite samples. In all cases (structural breaks and no structural breaks under the alternative), our tests are more powerful than the existing sup Wald test.\nWe illustrate the applicability of our tests by performing two empirical applica-\ntions. First, we revisit an analysis about the causal relationships between crude oil and stock returns from Ding et al. (2016), who consider the interplay between stock returns and crude oil returns. Further, following Stock and Watson (2001) and Rossi and Wang (2019), we investigate potential Granger causality between inflation, the unemployment rate, and the interest rate. In both applications, we find several scenarios which demonstrate the higher efficiency of the new test.\nThe rest of the paper proceeds as follows. In Section 2, we propose our test statistics for jointly testing for Granger causality in quantiles and parameter instability. In Section 3, we derive the asymptotic distribution of our test statistics; we also propose and justify a bootstrap method for implementing our test statistics. In Section 4, we perform Monte Carlo simulations to validate the finite-sample performance of our test statistics. In Section 5, we present two empirical applications of our proposed tests. Finally, we conclude the paper in Section 6.\nThroughout the paper, we use the following notation: Bm(\u03bb), \u03bb \u2208 [0, 1], is a vector of m independent Brownian motions, and BBm(\u03bb) := Bm(\u03bb) \u2212 \u03bbBm(1) is a vector of m independent Brownian bridges. For a positive definite matrix A, A\u22121/2 is defined as the Cholesky factor of its inverse A\u22121, so that A\u22121 = (A\u22121/2)\u2032A\u22121/2. Notation \u201c\u21d2\u201d and \u201c\u2192d\u201d indicates weak convergence and convergence in distribution, respectively. Notation T represents a closed interval such that T \u2282 [0, 1]. For an m\u00d7 1 vector z, we define \u2016z\u2016\u221e := max\n1\u2264j\u2264m |zj |."
        },
        {
            "heading": "2 Granger Causality",
            "text": "Suppose we suspect that the p\u00d71 vector zi Granger causes the dependent variable yi, and, at the same time, we have reasons to question temporal stability. In other words, we expect Granger causality, but we are unsure whether its pattern persists over time.\nWithin the framework of a linear quantile regression, these considerations amount to parameterise the \u03c4 quantile of yi via\nQyi (\u03c4 | xi) := x\u2032i\u03b2i(\u03c4), xi := (z\u2032i, w\u2032i)\u2032, \u03b2i(\u03c4) := (\u03b3i(\u03c4)\u2032, \u03b1(\u03c4)\u2032)\u2032 \u2208 Rm, (1)\nwhere w is a k \u00d7 1 vector of additional controls so that m = p + k, \u03b3i(\u03c4) 6= 0 for some \u03c4 \u2208 [0, 1], and i \u2208 {1, . . . , n} under Granger causality. For simplicity, we assume that all the available information up to time i can be represented by vector xi. Two important models, which lead to such a structure, are the locationscale model, yi = x \u2032 i\u03b4 + (x \u2032 i\u03c1)\u03b5i, and the random coefficient model, yi = x \u2032 i\u03b2(Ui), with a standard uniformly distributed random variable Ui that includes, among others, quantile autoregressive distributed lag models (see e.g. Koenker (2005) and Galvao et al., 2013).\nWe formulate the following (joint) null hypothesis H0 := H0,1 \u2229H0,2:\nH0,1 := {\u03b3i(\u03c4) = \u03b30(\u03c4), \u2200 i \u2208 {1, . . . , n}, \u03c4 \u2208 T } H0,2 := {\u03b30(\u03c4) = 0p, \u2200 \u03c4 \u2208 T }\nagainst the alternative hypothesis H1 := {\u00acH0,1} \u222a {\u00acH0,2}. More specifically, in a local neighbourhood around H0 in the direction of H1, the following sequence of local alternatives is investigated\n\u03b3i,n(\u03c4) := \u03b30,n(\u03c4) + \u03b4(\u03c4)\u221a n g ( i n ) , \u03b30,n(\u03c4) := \u2206(\u03c4)\u221a n , (2)\nwhere \u03c4 7\u2192 \u2206(\u03c4) and \u03c4 7\u2192 \u03b4(\u03c4) are deterministic continuous vector-valued and scalar-valued functions, respectively, and v 7\u2192 g(v) is a deterministic vector-valued Riemann\u2013Stieltjes integrable function.\nOur setup is essentially similar to the approach of Rossi (2005) that extends the earlier procedure of Sowell (1996), in which the null hypothesis consists of two different restrictions. On the one hand, the parameter \u03b3i(\u03c4) is constant over i and \u03c4 ; on the other hand, this constant is equal to 0. Analogously, the alternative hypothesis also consists of two parts. The alternative H1,1 := \u00acH0,1 specifies local deviations from the null hypothesis of constant parameters, whereas the alternative H1,2 := \u00acH0,2 specifies local deviations from the null hypothesis of no Granger causality in quantiles. Our tests are constructed in such a way that they have power against the union of these alternatives. For this purpose, it is not required to know a priori which of the two alternatives (or both) holds."
        },
        {
            "heading": "3 Test Statistics",
            "text": "Consider the following sequential process based on the subgradient of the unconstrained quantile regression\nSn(\u03bb, \u03c4, t) := n \u22121/2\n\u230a\u03bbn\u230b\u2211\ni=1\nxi\u03c8\u03c4 (yi \u2212 x\u2032it), t \u2208 Rm, (3)\nwhere \u03bb \u2208 [0, 1] indexes the time fraction, and \u03c8\u03c4 (u) := 1{u \u2264 0} \u2212 \u03c4 . Moreover, introduce the (constrained) estimator \u03b2\u0303n(\u03c4) := (0, \u03b1n(\u03c4) \u2032)\u2032, where\n\u03b1n(\u03c4) := arg min \u03b1\u2208Rk\nn\u2211\ni=1\n\u03c1\u03c4 (yi \u2212 w\u2032i\u03b1), (4)\nwhere \u03c1\u03c4 (u) := u(1{u \u2264 0} \u2212 \u03c4). Our tests are based on the following process\nHn(\u03bb, \u03c4, t) := (X \u2032 nXn/n) \u22121/2Sn(\u03bb, \u03c4, t), \u03bb, \u03c4 \u2208 [0, 1], t \u2208 Rm, (5)\nwhere Xn := (x \u2032 1, . . . , x \u2032 n) \u2032 is n \u00d7 m. As pointed out by Qu (2008), the process in (5) is asymptotically pivotal when evaluated at the true parameter vector; see also Parzen et al. (1994) for a similar argument. This allows us to construct tests that do not require trimming over time.\nThe main idea behind our test statistic is to combine two detectors that are respectively designed to find deviations from H0,1 and H0,2. More specifically, a CUSUM-type statistic\nLM1(\u03bb, \u03c4) := \u2225\u2225\u2225\u2206Hn(\u03bb, \u03c4, \u03b2\u0303n(\u03c4)) \u2225\u2225\u2225 \u221e ,\nwith\n\u2206Hn(\u03bb, \u03c4, \u03b2\u0303n(\u03c4)) := Hn(\u03bb, \u03c4, \u03b2\u0303n(\u03c4)) \u2212 \u03bbHn(1, \u03c4, \u03b2\u0303n(\u03c4))\nis used to test H0,1, while the restriction of H0,2 is verified using the LM (Lagrange Multiplier) statistic\nLM2(\u03c4) := \u2225\u2225\u2225Hn(1, \u03c4, \u03b2\u0303n(\u03c4)) \u2225\u2225\u2225 \u221e .\nSince LM1 has no power against constant deviations from the null, and LM2 lacks\npower if Granger causality is unstable, our tests will be of the form\n\u03d5 ( LM1 + LM2 ) , (6)\nfor some weighting function \u03d5 : [0, 1] \u00d7 [0, 1] 7\u2192 R specified below.\nIn what follows, we distinguish between situations where our interest lies in detecting deviations from the null (i) at a given quantile or (ii) across various quantiles. To derive the properties of theses tests, we impose the following assumptions that are similar to those in Qu (2008) and Oka and Qu (2011).\nAssumption A Let ui,n(\u03c4) := yi \u2212\u03b2i,n(\u03c4)\u2032xi. Then 1{ui(\u03c4) \u2264 0} \u2212 \u03c4 is a martingale difference array with respect to Fi\u22121 := \u03c3({yj\u22121, xj : j \u2264 i}) for any \u03c4 \u2208 [0, 1].\nLet fi(\u00b7), Fi(\u00b7) and F\u22121i (\u00b7) denote the conditional density, conditional distribution, and conditional quantile function, respectively, of yi given wi.\nAssumption B .\nB.1 The distribution functions Fi(\u00b7) are absolutely continuous, with continuous densities fi(\u00b7) satisfying 0 <\n\u00af u \u2264 fi(F\u22121i (\u03c4)) \u2264 u\u0304 < \u221e for all i.\nB.2 For any \u01eb > 0, there exists a \u03c3(\u01eb) > 0 such that |fi(F\u22121i (\u03c4)+s)\u2212fi(F\u22121i (\u03c4))| \u2264 \u01eb for all |s| < \u03c3(\u01eb) and all 1 \u2264 i \u2264 n.\nAssumption C The regressors are assumed to satisfy: .\nC.1 The vector w contains a constant.\nC.2 plimn\u2192\u221e 1 n \u2211\u230a\u03bbn\u230b i=1 fi(F \u22121 i (\u03c4))xix \u2032 i = \u03bbH(\u03c4) uniformly in \u03bb \u2208 [0, 1], where H(\u03c4)\nis a m\u00d7m non-random positive definite matrix.\nC.3 There exists a > 0 and A < \u221e such that E[\u2016xi\u20164+a] \u2264 A.\nC.4 There exists b > 0 and B < \u221e such that for any n:\n1 n\nn\u2211\ni=1\nE[\u2016xi\u20163(1+b)] \u2228 E[ 1\nn\nn\u2211\ni=1\n\u2016xi\u20163]1+b \u2264 B.\nC.5 plimn\u2192\u221e 1 n \u2211\u230a\u03bbn\u230b i=1 xix \u2032 i = \u03bbJ uniformly in \u03bb \u2208 [0, 1], where J is a m\u00d7 m non-\nrandom positive definite matrix.\nThese assumptions are standard in the context of tests for structural breaks in quantile models and of tests for Granger causality in quantiles. Assumption A restricts the dependence over time. Serial independence is not required, instead we have a martingale difference assumption on the innovations. Assumption B introduces positivity and smoothness assumptions on the conditional density of yi given xi. Assumption C imposes restrictions on the regressors xi, in particular on the existence of moments. This assumption rules out trends in the regressors, but it allows for heteroscedasticity."
        },
        {
            "heading": "3.1 Granger Causality at a Given Quantile",
            "text": "Let \u03b20(\u03c4) := (0 \u2032 p, \u03b10(\u03c4) \u2032)\u2032 be the true coefficient under the null, define\nR :=   Ip 0k\u00d7p   , R\u0304 :=  0p\u00d7k Ik   , (7)\nand set C(\u03c4) := J\u22121/2H(\u03c4). Note that C(\u03c4) is a square root of the inverse of the variance-covariance matrix of the limiting distribution of the estimator that solves the unrestricted quantile regression problem (Koenker, 2005).\nProposition 1 Assume that Assumptions A, B, and C hold. For a given \u03c4 \u2208 T , it holds uniformly in \u03bb \u2208 [0, 1] that\nHn(\u03bb, \u03c4, \u03b2\u0303n(\u03c4)) = J \u22121/2Sn(\u03bb, \u03c4, \u03b20(\u03c4)) \u2212 \u03bbP (\u03c4)J\u22121/2Sn(1, \u03c4, \u03b20(\u03c4)) + op(1)\nfor P (\u03c4) := C(\u03c4)R\u0304(R\u0304\u2032C(\u03c4)R\u0304)\u22121R\u0304\u2032, with\nh(\u03c4)J\u22121/2Sn(\u03bb, \u03c4, \u03b20(\u03c4)) \u21d2 Bm(\u03bb) + h(\u03c4)C(\u03c4)R ( \u03bb\u2206(\u03c4) + \u03b4(\u03c4) \u222b \u03bb\n0 g(v)dv\n) .\nwhere h2(\u03c4) := 1/(\u03c4(1 \u2212 \u03c4)).\nFrom the result above, we can directly deduce the limiting distribution of the two test statistics as summarized by Corollary 1.\nCorollary 1 For a given \u03c4 \u2208 T , it holds under the assumptions of Proposition 1 uniformly in \u03bb \u2208 [0, 1]\nh(\u03c4)R\u2032\u2206Hn(\u03bb, \u03c4, \u03b2\u0303n(\u03c4))\n\u21d2 BBp(\u03bb) + h(\u03c4)\u03b4(\u03c4)R\u2032C(\u03c4)R ( (1 \u2212 \u03bb) \u222b \u03bb\n0 g(v)dv \u2212 \u03bb\n\u222b 1\n\u03bb g(v)dv\n) =: Z(1)(\u03bb, \u03c4)\nand\nh(\u03c4)R\u2032Hn(1, \u03c4, \u03b2\u0303n(\u03c4))\n\u21d2 B\u0303p(1, \u03c4) + h(\u03c4)R\u2032T (\u03c4)C(\u03c4)R ( \u2206(\u03c4) + \u03b4(\u03c4) \u222b 1\n0 g(v)dv\n) =: Z(2)(\u03c4)\nwhere B\u0303m(\u03bb, \u03c4) := T (\u03c4)Bm(\u03bb), with T (\u03c4) denoting the inverse of the m\u00d7m matrix of eigenvectors of I \u2212 P (\u03c4).\nInterestingly, and contrary to the corresponding GMM result in Rossi (2005), the limiting distribution of the LM statistic Hn(1, \u03c4, \u03b2\u0303n(\u03c4)) is not pivotal because the projection matrix P (\u03c4) is oblique (i.e. idempotent of rank k but not symmetric). An important exception is given if the following additional condition is satisfied:\nAssumption D The p \u00d7 k matrix Q(\u03c4) := R\u2032C(\u03c4)R\u0304H\u22121\u03b1 (\u03c4)J1/2\u03b1 is zero, where H\u03b1(\u03c4) and J\u03b1 denote the lower-right k \u00d7 k sub-matrix of H(\u03c4) and J, respectively, partitioned according the k \u00d7 1 subvector \u03b1(\u03c4) of \u03b2(\u03c4) = (\u03b3(\u03c4)\u2032, \u03b1(\u03c4)\u2032)\u2032.\nAssumption D ensures that the oblique projection matrix P (\u03c4) defined in Proposition 1 is equal to the orthogonal projection R\u0304(R\u0304\u2032R\u0304)\u22121R\u0304\u2032 = R\u0304R\u0304\u2032, which follows from observing that P (\u03c4) decomposes into an orthogonal projection perturbed by a nilpotent matrix\nP (\u03c4) = C(\u03c4)R\u0304(R\u0304\u2032C(\u03c4)R\u0304)\u22121R\u0304\u2032 = R\u0304R\u0304\u2032 +\n 0p\u00d7p Q(\u03c4)\n0k\u00d7p 0k\u00d7k\n  . (8)\nA sufficient condition for Assumption D is Hc(\u03c4) = J(\u03c4) for some scalar c(\u03c4) \u2208 (0,\u221e), which holds under homoscedasticity. Alternatively, Assumption D is satisfied if w is just a constant or, more generally, under conditional mean independence of z with respect to w (i.e. E[z|w] = E[z]) as both of theses conditions ensure under\nthe null Q(\u03c4) = 0p\u00d7k.\nCorollary 2 Under the null hypothesis and Assumptions A\u2013D, we get for a given \u03c4 \u2208 T and uniformly in \u03bb \u2208 [0, 1]\nh(\u03c4)Hn(\u03c4, \u03bb, \u03b2\u0303n(\u03c4)) \u21d2   Bp(\u03bb) BBk(\u03bb)   ,\nwhere BBk(\u00b7) and Bp(\u00b7) are independent.\nThe p-dimensional Brownian motion Bp and the k-dimensional Brownian bridges BBk arise due to the restricted and unrestricted components of the process towparameter process Hn(\u03bb, \u03c4, \u03b2(\u03c4)), respectively. The limiting random variable under the null is independent of \u03c4 . While this is true if Assumption D holds, violations from this assumption introduce dependence on nuisance parameters (cf. Proposition 3).\nBased on the previous result, we will now introduce our first test statistic, suited to test H0 at a given quantile \u03c4\nLM(\u03c4) := h(\u03c4) ( sup\n\u03bb\u2208[0,1] LM1(\u03bb, \u03c4) + LM2(\u03c4)\n) .\nFor fixed \u03c4 , the test statistic essentially consists of the sum of two individual test statistics, which reflect the two parts of the alternative hypothesis. Both statistics are based on the standardized subgradient of the unconstrained quantile regression through the process Hn(\u03bb, \u03c4, t) from (5). The first part, LM1(\u03bb, \u03c4), is the CUSUM part that detects structural breaks in the parameter \u03b3i(\u03c4). Typically, for CUSUM statistics, one considers the supremum over the potential breakpoints \u03bb \u2208 [0, 1]. The second part, LM2(\u03c4), is essentially the LM statistic for the hypothesis H0,2.\nCorollary 1 states why it makes sense to consider the sum of the two individual test statistics: The first statistic does have local power against structural breaks, but it has no power if there is Granger causality with constant parameters. The second part has power if there is Granger causality with constant parameters, but it has no power if \u2206(\u03c4) = 0 and \u222b 1\n0 g(v)dv = 0. The interpretation of the latter\nwould be that there are structural breaks that lie in opposite directions over time.\nCorollary 3 For a given \u03c4 \u2208 T , we get under the assumptions of Proposition 1\nLM(\u03c4) \u2192d sup \u03bb\u2208[0,1]\n\u2225\u2225\u2225Z(1)(\u03bb, \u03c4) \u2225\u2225\u2225 \u221e + \u2225\u2225\u2225Z(2)(\u03c4) \u2225\u2225\u2225 \u221e ,\nwhile under the null\nLM(\u03c4) \u2192d sup \u03bb\u2208[0,1]\n\u2016BBp(\u03bb)\u2016\u221e + \u2225\u2225\u2225B\u0303p(1, \u03c4) \u2225\u2225\u2225 \u221e .\nwhere BBp and B\u0303p(\u03bb, \u03c4) are independent. If Assumption D holds, then B\u0303p(\u03bb, \u03c4) = Bp(\u03bb).\nThus, unless Assumption D is satisfied, the limiting distribution is not pivotal due to the second element LM2 of our test statistic that induces dependence on the quantile level \u03c4 via Q(\u03c4). More specifically, it can be shown that\nLM2(\u03c4) = \u2225\u2225\u2225(I \u2212 P (\u03c4))J\u22121/2Sn(1, \u03c4, \u03b20(\u03c4)) \u2225\u2225\u2225 \u221e + op(1),\nwhere the oblique projection P (\u03c4) causes quantile dependece because it cannot be diagonalized; cf. Eq. (8). The distribution of LM2 can be viewed as a maximum of p-scaled absolute standard normals, where\u2013similar to the discussion in Hansen (2021)\u2013the scaling differs in general from unity, thereby capturing deviations from Assumption D (e.g. from homoskedasticity to heteroskedasticity)."
        },
        {
            "heading": "3.2 Granger Causality at all Quantiles",
            "text": "To avoid multiple testing issues when performing inference across various quantiles, we extend the test statistics from the previous section to allow uniform inference across both \u03bb and \u03c4 . Following Andrews and Ploberger (1994) and Hansen (1996),\nwe consider the following test statistics:\nsupLM := sup \u03c4\u2208T\n( sup\n\u03bb\u2208[0,1] LM1(\u03bb, \u03c4) + LM2(\u03c4)\n) ,\nexpLM := \u222b\nT exp\n[ 1\n2\n( sup\n\u03bb\u2208[0,1] LM1(\u03bb, \u03c4) + LM2(\u03c4)\n)] d\u03c4.\n(9)\nWhile both weighting schemes (over \u03c4) direct power against relatively distantly located alternatives, expLM can be considered optimal (see also Rossi, 2005).\nSimilar to Proposition 1, we first derive the properties of the process Eq. (5) that serves as the building block of our test statistics.\nProposition 2 Assume that Assumptions A, B, and C hold uniformly in \u03c4 . Then, uniformly in (\u03c4, \u03bb) \u2208 T \u00d7 [0, 1], we have R\u2032\u2206Hn(\u03bb, \u03c4, \u03b2\u0303n(\u03c4)) \u21d2 SSp(\u03bb, \u03c4) + \u03b4(\u03c4)R\u2032C(\u03c4)R ( (1 \u2212 \u03bb) \u222b \u03bb\n0 g(v)dv \u2212 \u03bb\n\u222b 1\n\u03bb g(v)dv\n)\n=: Y (1)(\u03bb, \u03c4)\nand\nR\u2032Hn(1, \u03c4, \u03b2\u0303n(\u03c4)) \u21d2 S\u0303p(1, \u03c4) +R\u2032T (\u03c4)C(\u03c4)R ( \u2206(\u03c4) + \u03b4(\u03c4) \u222b 1\n0 g(v)dv\n) =: Y (2)(\u03c4),\nwhere S\u0303m(\u03c4, \u03bb) := T (\u03c4)Sm(\u03c4, \u03bb) for Sm(\u03bb, \u03c4) := (S1m(\u03bb, \u03c4), . . . ,Smm(\u03bb, \u03c4))\u2032 is an m\u00d7 1 vector of independent Gaussian processes with\ncov[Sim(\u03bb1, \u03c41),Sim(\u03bb2, \u03c42)] = (\u03bb1 \u2227 \u03bb2)(\u03c41 \u2227 \u03c42 \u2212 \u03c41\u03c42)\nand SSm(\u03bb, \u03c4) := Sm(\u03bb, \u03c4) \u2212 \u03bbSm(1, \u03c4) so that\ncov[SS im(\u03bb1, \u03c41),SS im(\u03bb2, \u03c42)] = (\u03bb1 \u2227 \u03bb2 \u2212 \u03bb1\u03bb2)(\u03c41 \u2227 \u03c42 \u2212 \u03c41\u03c42).\nAgain, the weak limit of Hn(1, \u03c4, \u03b2\u0303(\u03c4)) is affected by nuisance parameters unless Assumption D holds, in which case S\u0303p(\u03bb, \u03c4) = Sp(\u03bb, \u03c4). Moreover, note that S(1, \u03c4) = B(\u03c4), while the Gaussian process SS(\u03bb, \u03c4) is also referred to as a Brown-\nian pillow or a pinned Brownian sheet; see also Qu (2008, Sec 4). From the above, the limiting distribution of the test statistics follows readily by the continuous mapping theorem:\nCorollary 4 Uniformly in (\u03c4, \u03bb) \u2208 T \u00d7 [0, 1], we have under the conditions of Proposition 2\nsupLM \u2192d sup \u03c4\u2208T\n( sup\n\u03bb\u2208[0,1]\n\u2225\u2225\u2225Y (1)(\u03bb, \u03c4) \u2225\u2225\u2225 \u221e + \u2225\u2225\u2225Y (2)(\u03bb, \u03c4) \u2225\u2225\u2225 \u221e\n) ,\nexpLM \u2192d \u222b\nT exp\n[ 1\n2\n( sup\n\u03bb\u2208[0,1]\n\u2225\u2225\u2225Y (1)(\u03bb, \u03c4) \u2225\u2225\u2225 \u221e + \u2225\u2225\u2225Y (2)(\u03bb, \u03c4) \u2225\u2225\u2225 \u221e\n)] d\u03c4,\nwhile, under the null, Y (1)(\u03bb, \u03c4) = SSp(\u03bb, \u03c4) and Y (2)(\u03bb, \u03c4) = S\u0303p(1, \u03c4). If Assumption D holds, then S\u0303p(\u03bb, \u03c4) = Sp(\u03bb, \u03c4)."
        },
        {
            "heading": "3.3 Practical Implementation",
            "text": "If Assumption D is satisfied, then it is easy to simulate the limiting distributions because they are free of unknown nuisance parameters (cf. Corollaries 3 an 4). More specifically, using numerical techniques we can arbitrarily well approximate the Brownian motion B(\u00b7) and the Brownian bridge BB(\u00b7) for the fixed-\u03c4 case or, if instead a continuum of quantiles is considered, the limiting processes S(\u00b7) and SS(\u00b7) (see the discussion in Andrews (1993) and Qu (2008) for details on the numerical computation).\nIf Assumption D is violated, then we could still simulate the limiting distributions. But since the weak limits depend in this case on the characteristics of the dgp (cf. Corollaries 3 an 4), we need to tabulate critical values for each application separately. In principle, one could proceed as follows: Firstly, based on a consistent estimator Hn(\u03c4), say, of H(\u03c4), we estimate Q(\u03c4) using Qn(\u03c4) := J \u22121/2 n Hn(\u03c4)Hn,\u03b1(\u03c4)J 1/2 n,\u03b1, with Jn := X \u2032X/n, and where Hn,\u03b1(\u03c4) and Jn,\u03b1 denote, respectively, the sample analogues of H\u03b1(\u03c4) and J\u03b1 from Assumption D. For instance, a consistent estimator can be obtained via\nHn(\u03c4) = 1\n2ncn\nn\u2211\ni=1\n1{u\u0302i(\u03c4) \u2264 cn}xix\u2032i,\nwhere cn \u2192 0, \u221a ncn \u2192 \u221e (see Powell, 1991 and Koenker, 2005, Sec 3.4). Secondly, we obtain from Qn(\u03c4) and Eq. (8) the inverse matrix of eigenvectors Tn(\u03c4), which, by the continuous mapping theorem, is a consistent estimator. Finally, we simulate the limiting stochastic processes similarly to the case where Assumption D is met, but we substitute B(\u00b7) (S(\u00b7)) with B\u0303(\u00b7) (S\u0303(\u00b7)). Clearly, this procedure becomes very time-consuming when testing at many quantiles. Nevertheless, an important exception is given for p = 1 < k,1 where proper scaling of the test statistics ensures a pivotal limiting distribution; e.g. for a given \u03c4 \u2208 T\nh(\u03c4) LM2(\u03c4)\u221a\n1 +Qn(\u03c4)Qn(\u03c4)\u2032 \u2192d |B1(1)| \u2261\n\u221a \u03c72(1).\nUnfortunately, a similar re-scaling does not work for other values p > 1. Therefore, we propose an additional resampling procedure that especially for the \u2018many-\u03c4 \u2019 case is significantly less time consuming.\nIn particular, we propose a bootstrap procedure which is inspired by Rothe and Wied (2013) and that is valid both in the \u2018fixed-\u03c4 \u2019 case and the \u2018many-\u03c4 \u2019 case. Note, however, that we actually need the bootstrap only in the former case because the computational burden of the procedure described above for the \u2018fixed-\u03c4 \u2019 case is manageable. The algorithm for obtaining one bootstrap sample {(y\u0302i,b, xi,b), 1 \u2264 i \u2264 n}, b \u2208 {1, . . . , B}, for a large value of B is as follows:\nStep 1 Draw with replacement {xi,b, 1 \u2264 i \u2264 n} from the realized regressors {xi, 1 \u2264 i \u2264 n}\nStep 2 For each 1 \u2264 i \u2264 n, set y\u0302i,b = \u03b1n(Ui,b) \u2032wi,b,\nwhere {Ui,b, 1 \u2264 i \u2264 n} is a simulated IID sequence of standard uniformly distributed random variables on the interval (0, 1), \u03b1n is the restricted quantile estimator and xi,b = (z \u2032 i,b, w \u2032 i,b) \u2032 with the same dimensions as in the realized data.\nStep 3 Use the bootstrap data {(y\u0302i,b, xi,b), 1 \u2264 i \u2264 n} to obtain bootstrap esti1Note that the case k = 1 is trivial because then w = 1 and assumption D is automatically\nsatisfied.\nmates Hn,b(\u03bb, \u03c4, \u03b2\u0303n,b(\u03c4)), say, of Hn(\u03bb, \u03c4, \u03b2\u0303n(\u03c4)) and construct the corresponding test statistics for \u03c4 \u2208 T .\nStep 4 Our tests reject if they exceed the corresponding bootstrap critical values\nc\u0302(\u03b1), say, for some \u03b1 \u2208 (0, 1).\nThe algorithm above means that, for generating a bootstrap sample, we first draw with replacement from the regressors, where random sampling is justified by Assumption A (i.e. Corollary 3 and Corollary 4 are unaffected by the temporal dependence of xi). The corresponding y-values are obtained by applying the estimated quantile function on randomly chosen standard uniformly distributed random variables. Thus, it is ensured that, under the null hypothesis, we asymptotically generate data from the distribution of (y, x) with Qy(\u03c4 |x) = x\u2032\u03b2(\u03c4) so that, in Step 3, no centring of Hn,b(\u03bb, \u03c4, \u03b2\u0303n,b(\u03c4)) is needed. Here, it is crucial to draw from a uniform distribution on the whole interval (0, 1) in Step 2 to get simulated data from the whole conditional distribution of y given x, although the interval T is a strict subset of (0, 1). So, the restriction is stronger than actually necessary, but the null distribution is still enforced. Under the alternative hypothesis, the critical values remain stochastically bounded as the validity of the null hypothesis is enforced within the generation of the bootstrap sample.\nThese considerations are summarized in Proposition 3. For simplicity, consider the \u2018many-\u03c4 \u2019 case and let us generically represent our test statistics in Eq. (9) as \u03d5(LM1 + LM2) using the weighting function \u03d5 : [0, 1] \u00d7 T 7\u2192 R from (6).\nProposition 3 . Let \u03b1 \u2208 (0, 1) and assume that Assumptions A, B, and C hold uniformly in \u03c4 \u2208 T .\n(i) Under the null hypothesis\nP(\u03d5(LM1 + LM2) \u2265 c\u0302(\u03b1)) \u2192 \u03b1.\n(ii) Under fixed alternatives\nP(\u03d5(LM1 + LM2) \u2265 c\u0302(\u03b1)) \u2192 1."
        },
        {
            "heading": "4 Monte Carlo Simulations",
            "text": "In the small sample simulations, we consider a location-scale model\nyi =wi + \u03b3izi + (1 + \u03b1wi)\u03b5i,\nwhere (w1, z1, \u03b51), . . . , (wn, zn, \u03b5n) are IID copies of\nw \u223c \u03c72(3), z, \u03b5 \u223c N (0, 1), and \u03b5 \u22a5 (w, z).\nFirst, we investigate the size properties setting \u03b3i = 0 for all i. We distinguish between homoscedasticity (\u03b1 = 0) and heteroscedasticity (\u03b1 = 3). In the latter case, Assumption D will only be satisfied if E[z|w] = E[z]. Therefore, we consider three scenarios: (1) \u03b1 = 0 & z \u22a5 w, (2) \u03b1 = 3 & z \u22a5 w, (3) \u03b1 = 3 & cov[z, w] \u2243 \u22123/4. Thus, it is only in scenario (3) where the asymptotic critical values based on the asymptotic approximation under Assumption D are wrong.\nWe perform tests at five selected quantiles \u03c4 \u2208 {0.05, 0.25, 0.50, 0.75, 0.95} as well as across the complete interval [0.05, 0.95]. We consider the case where test statistics are compared to critical values obtained under Assumption D (labelled \u2018asy\u2019). Alternatively, we adjust the statistics as explained in Section 3.3 when testing at a given \u03c4 or, when testing across all \u03c4 \u2208 [0, 1], use the bootstrap (both labelled \u2018adj\u2019). For comparison, we compute also the supWald test of Koenker and Machado (1999) given by\nsupWald = sup \u03c4\u2208T\nnh2(\u03c4)\u03b3n(\u03c4) \u2032\u2126\u22121n (\u03c4)\u03b3n(\u03c4) H0\u2192d sup \u03c4\u2208T h2(\u03c4)BBp(\u03c4)\u2032BBp(\u03c4) (10)\nwhere we equip the statistic with (pairs) bootstrap standard errors \u2126n(\u00b7) implemented using the quantreg package of R (Koenker et al., 2018). Critical values are easily obtained from a discrete approximation of the Bessel limiting process (see also Andrews (1993, Tab 1)). For all bootstrap procedures we use B = 499 replications. All test decision are carried out at the five per cent significance level.\nTable 1 contains the Monte Carlo results under the null hypothesis of Granger noncausality based on 2,000 Monte Carlo repetitions. As can be seen from panel a) and\nb) of Table 1, size is controlled if n is moderately large irrespective of conditional homoscedasticity/heteroscedasticity because conditional mean independence and thus Assumption D is satisfied. As suggested by our theory, the performance of the tests using the asymptotic approximation derived under Assumption D deteriorates if cov[z, w] 6= 0 (cf. panel c) of Table 1). However, in this case the adjustment/bootstrap alternatives do their job by effectively keeping size. The empirical size of the supWald test is in all scenarios in line with the nominal significance level.\nTurning to the power properties, we consider the following three break scenarios:\nA : \u03b3i =    \u03b3 i \u2264 \u230an/2\u230b \u2212\u03b3 otherwise\nB : \u03b3i =    0 i \u2264 \u230an/2\u230b \u03b3 otherwise\nC : \u03b3i = \u03b3.\nThis means that, in Scenario A, we have a structural break in the Granger parameter and the parameters sum up to zero over time (i.e. \u222b 1\n0 g(v)dv = 0). Also\nin Scenario B, there is a structural break, but the sum over time is not zero. In Scenario C, the Granger parameter is constant and equal to \u03b3 (i.e. \u2206(\u03c4) 6= 0).\nFor a better comparison, we focus on the dgp, where \u03b1 = 0 and z \u22a5 w (i.e. Assumption D is satisfied) and focus on the tests over the whole quantile interval [0.05, 0.95]. That is, we consider our two statistics supLM, expLM (bootstrapped version) and the supWald test. It is expected that our tests have power against all alternatives, which increases in n, while supWald has no power in Scenario A, also for large n because \u222b 1\n0 g(v)dv = 0. This is indeed the empirical result. Somewhat\nsurprisingly, in all scenarios, the break-robust tests are more powerful than the supWald, in particular also in Scenario C, where no break is present. Among our new tests, the expLM test has more power than the supLM test."
        },
        {
            "heading": "5 Empirical Illustrations",
            "text": "Illustration 1: Crude Oil and Returns\nWe revisit an analysis about the causal relationships between crude oil and stock returns from Ding et al. (2016) to illustrate the advantages of our new test. Ding et al.\n18\n(2016) consider the daily returns of West Texas Intermediate (WTI) and Dubai crude oil as well as five major (mainly Asian) stock index returns, S&P 500, Nikkei, Hang Seng, Shanghai, and KOSPI, from January 1, 1996, to October 12, 2012.\nOne of their main findings is a considerable Granger influence in quantiles of the WTI returns on the stock returns, which is much stronger compared with the other direction (stocks on WTI). The application of our test supports this finding and, in particular, gives substantially stronger evidence for this kind of relationship. We consider the settings of their Table 4, where eight different quantile-level intervals are employed.\nTable 2 presents the p-values of our bootstrapped expLM and supLM tests, as well as the supWald test in Eq. (10) equipped with bootstrap standard errors, each computed over different quantile intervals using a step size of 0.01 for the grids. In simulations, these three bootstrap-based tests display best size and power properties. In particular, the latter test equipped with bootstrap standard errors outperforms the test equipped with a kernel based plug-in estimator for the asymptotic covariance matrix used by Ding et al. (2016), so that refrain from using that test. We consinder the same quantile autoregressive distributed lag model with the same number of lags (which is obtained by a sequential procedure and is different for the individual specifications; see Ding et al. (2016, Tab 4)).\nOut of 80 scenarios in total, the p-values of our test are smaller than or equal to these in Ding et al. (2016) in 68 times. The cases in which our p-values are higher, mostly concern the index KOSPI, where our p-values are larger seven out of 16 times. But this mainly concerns cases, where the p-values are large anyway. So, we have a robust finding that, if there is some evidence for Granger causality, our test strengthens this evidence.\nWe corroborate our findings with an analysis about the structural stability of the correlation \u03c1(i) = corr[yi, zi\u22121] between the lagged WTI (z) and the stock index returns (y). An application of the test for constant correlations from Wied et al. (2012), whose assumptions are typically plausible in the context of (stock) returns, shows that all five p-values are small. For Hang Seng and Nikkei, they are substantially smaller than 0.001. For KOSPI, the p-value is larger (0.014), which fits to the observation in the previous paragraph that the advantage of our new test might be smaller in such cases.\nIllustration 2: Phillips Curve\nFollowing Stock and Watson (2001) and Rossi and Wang (2019), we investigate potential Granger causality between inflation (\u03c0t), measured by the quarterly GDP deflator, the unemployment rate (ut), and federal funds rate (Rt). The quarterly data cover the time span from the first quarter in 1959 to the fourth quarter in 2000. Similarly as in Illustration 1, we consider a quantile autoregressive distributed lag\nTest [.05;.95] [.05;.5] [.5;.95] [.05;.5] [.2;.4] [.4;.6] [.6;.8] [.8;.95]\nShanghai\nexpLM .026 .000 .046 .020 .000 .010 .028 .188 supLM .046 .012 .112 .008 .004 .014 .070 .080 supWald .288 .127 .379 .206 .066 .102 .038 .263\nHang Seng\nexpLM .000 .000 .000 .000 .000 .000 .000 .046 supLM .000 .000 .000 .000 .000 .000 .000 .046 supWald .002 .001 .235 .001 .000 .039 .140 .275\nKOSPI\nexpLM .018 .004 .713 .002 .002 .056 .307 .669 supLM .028 .022 .447 .010 .006 .084 .431 .818 supWald .042 .015 .525 .005 .001 .465 .987 .367\nNikkei\nexpLM .000 .000 .000 .000 .000 .000 .000 .004 supLM .000 .000 .000 .000 .000 .000 .000 .004 supWald .000 .000 .045 .000 .000 .005 .056 .684\nS&P 500\nmodel and test for Granger causality separately with each one of the three variables as a dependent variable. Each of the other two variables is restricted separately, the lag length is 4 and we consider the same quantile levels as in Illustration 1.\nTable 3 displays the Granger causality test results. The overall picture is similar to that of Illustration 1, in most cases (90 out of 96 times), the p-values of the robust tests are equal or lower. In general, the p-values are lowest in the combination of R and u. This is an observation which is also made in Rossi and Wang (2019), who focus on Granger causality in mean."
        },
        {
            "heading": "6 Conclusion",
            "text": "We have proposed new tests for Granger causality that are robust against structural breaks and compete very well against existing tests. For future research, it might be interesting to consider nonlinear quantile models such as in Troster (2018) instead of pure linear ones. Moreover, one could consider systems of equations: In our setting, we have one cross-section regression equation and test for restrictions in this equation. In our empirical application on stock returns, this leads to five different tests for each interval of quantile levels. Merging the information to one\nsystem of equations might increase the power even further because cross-sectional dependence would be taken into account then."
        },
        {
            "heading": "A Proofs",
            "text": "Lemma A.1 Recall \u03b20(\u03c4) = (0 \u2032 p, \u03b10(\u03c4) \u2032)\u2032 is the parameter value under H0, and suppose Assumptions A-C are satisfied.\n(i) For a given \u03c4 \u2208 T it holds uniformly in \u03bb \u2208 [0, 1]\nh(\u03c4)Hn(\u03bb, \u03c4, \u03b20(\u03c4)) \u21d2 Bm(\u03bb) + J\u22121/2H(\u03c4)R ( \u03bb\u2206(\u03c4) + \u03b4(\u03c4) \u222b \u03bb\n0 g(v)dv\n) .\n(ii) If Assumptions A-C hold uniformly in \u03c4 , then uniformly in (\u03c4, \u03bb) \u2208 T \u00d7 [0, 1]\nHn(\u03bb, \u03c4, \u03b20(\u03c4)) \u21d2 Sm(\u03bb) + J\u22121/2H(\u03c4)R ( \u03bb\u2206(\u03c4) + \u03b4(\u03c4) \u222b \u03bb\n0 g(v)dv\n) .\nProof of Lemma A.1. To begin with, we note that (by Qu, 2008, Lem A.1,A.2) the process Sn(\u03bb, \u03c4, \u03b20(\u03c4)) is stochastically equicontinuous on [0, 1] \u00d7 T equipped with the norm \u03c1({\u03bb1, \u03c41}, {\u03bb2, \u03c42}) = |\u03bb2 \u2212 \u03bb1| + |\u03c42 \u2212 \u03c41|. We now prove first part (i). Fix some \u03c4 \u2208 T , and let \u03b2i,n(\u03c4) := (\u03b3i,n(\u03c4)\u2032, \u03b10(\u03c4)\u2032)\u2032 denote the m \u00d7 1 parameter vector under the local alternatives given by Eq. (2). Now, under the sequence of local alternatives in Eq. (2), one gets\nSn(\u03bb, \u03c4, \u03b20(\u03c4))\n= 1\u221a n\n\u230a\u03bbn\u230b\u2211\ni=1\nxi\u03c8\u03c4 (yi \u2212 x\u2032i\u03b20(\u03c4))\n= 1\u221a n\n\u230a\u03bbn\u230b\u2211\ni=1\nxi\u03c8\u03c4 (yi \u2212 x\u2032i\u03b2i,n(\u03c4))\n+ 1\u221a n\n\u230a\u03bbn\u230b\u2211\ni=1\nxi [ 1{yi \u2264 x\u2032i\u03b20(\u03c4)} \u2212 1{yi \u2264 x\u2032i\u03b2i,n(\u03c4)}\n\u2212 Fi(x\u2032i\u03b20(\u03c4)) + Fi(x\u2032i\u03b2i,n(\u03c4)) ]\n+ 1\u221a n\n\u230a\u03bbn\u230b\u2211\ni=1\nxi(Fi(x \u2032 i\u03b2i,n(\u03c4)) \u2212 Fi(x\u2032i\u03b20(\u03c4))) =: I + II + III, (A.1)\nsay. We know that, by Assumption A, xi\u03c8\u03c4 (yi\u2212x\u2032i\u03b2i,n(\u03c4)) is a martingale difference\narray under the local alternatives so that by the FCLT h(\u03c4)J\u22121/2I \u21d2 Bm(\u03bb). Moreover, the stochastic equicontinuity of Sn(\u00b7) yields II = op(1) (cf. Qu, 2008, Lem A.1/A.2). Finally, using a Taylor-series expansion and Eq. (2), yields\nIII = 1\u221a n\n\u230a\u03bbn\u230b\u2211\ni=1\nxix \u2032 ifi(x \u2032 i\u03b2i,n(\u03c4))R\u03b3i,n(\u03c4) + op(1) \u21d2 \u03bbHR\u2206(\u03c4) + \u03b4(\u03c4)HR\n\u222b \u03bb\n0 g(v)dv,\nwhich, as X \u2032nXn/n = J + op(1) (cf. Ass. B), proves the claim. Part (ii) follows analogously noting that J\u22121/2I \u21d2 Bm(\u03bb) \u21d2 S(\u03bb, \u03c4).\nProof of Proposition 1. Recall that \u03b1n(\u03c4) denotes a solution to the constrained optimization defined in Eq. (4) (i.e. assuming \u03b3i(\u03c4) = 0). Moreover, recall that R\u0304 is an m\u00d7 k selection matrix such that\nR\u0304\u03b10(\u03c4) = \u03b20(\u03c4) =   0p \u03b10(\u03c4)   .\nNow, using the same argument that lead to Eq. (A.1), we get\nSn(\u03bb, \u03c4, \u03b2\u0303n(\u03c4)) = Sn(\u03bb,\u03c4, \u03b20(\u03c4))\n+ 1\u221a n\n\u230a\u03bbn\u230b\u2211\ni=1\nxi(Fi(w \u2032 i\u03b1n(\u03c4) \u2212 Fi(w\u2032i\u03b10(\u03c4))) + op(1)\n(1) = Sn(\u03bb, \u03c4, \u03b20(\u03c4))\n+ 1\nn\n\u230a\u03bbn\u230b\u2211\ni=1\nxiw \u2032 ifi(w \u2032 i\u03b10(\u03c4)) \u221a n(\u03b1n(\u03c4) \u2212 \u03b10(\u03c4)) + op(1)\n(2) = Sn(\u03bb, \u03c4, \u03b20(\u03c4))\n+ 1\nn\n\u230a\u03bbn\u230b\u2211\ni=1\nxix \u2032 ifi(x \u2032 i\u03b20(\u03c4))(R\u0304 \u221a n(\u03b1n(\u03c4) \u2212 \u03b10(\u03c4))) + op(1)\n(3) = Sn(\u03bb, \u03c4, \u03b20(\u03c4)) + \u03bbH(\u03c4) \u221a n(\u03b2\u0303n(\u03c4) \u2212 \u03b20(\u03c4)) + op(1),\nwhere \u03b2\u0303n(\u03c4) = R\u0304\u03b1n(\u03c4) = (0 \u2032 p, \u03b1 \u2032 n(\u03c4)) \u2032. Equation (1) uses a first order Taylor-series expansion (see Qu, 2008, proof of lem. 1), (2) is due to xix \u2032 iR\u0304 = xiw \u2032 i, and (3) is due to Ass. C that also defines the m\u00d7m matrix H(\u03c4). Moreover, let H\u03b1(\u03c4) and\nJ\u03b1, denote the lower-right k \u00d7 k block of H(\u03c4) and J, respectively, and partition\nSn(\u03bb, \u03c4, t) = (Sn,\u03b3(\u03bb, \u03c4, t\u03b3) \u2032, Sn,\u03b1(\u03bb, \u03c4, t\u03b1) \u2032)\u2032, t\u03b3 \u2208 Rp, t\u03b1 \u2208 Rk\nto conform with the partitioning \u03b20(\u03c4) = (\u03b30(\u03c4) \u2032, \u03b10(\u03c4) \u2032)\u2032 for \u03b30(\u03c4) = 0p. Then,\n\u221a n(\u03b2\u0303n(\u03c4) \u2212 \u03b20(\u03c4)) = \u2212   0p H\u22121\u03b1 Sn,\u03b1(1, \u03c4, \u03b10(\u03c4))  + op(1),\nsee also Koenker and Machado (1999, Proof of Thm 1) for the partitioning. Moreover, some algebra reveals\n  0p H\u22121\u03b1 Sn,\u03b1(1, \u03c4, \u03b20(\u03c4))  \n=\n 0p\u00d7p 0p\u00d7k\n0k\u00d7p H \u22121 \u03b1 (J \u22121/2 \u03b1 ) \u22121     0p J\u22121/2\u03b1 Sn,\u03b1(1, \u03c4, \u03b10(\u03c4))  \n=\n 0p\u00d7p 0p\u00d7k\n0k\u00d7p H \u22121 \u03b1 (J \u22121/2 \u03b1 ) \u22121\n  J\u22121/2Sn(1, \u03c4, \u03b10(\u03c4)) =: A(\u03c4)J\u22121/2Sn(1, \u03c4, \u03b10(\u03c4)),\nsay, where the m\u00d7m matrix A(\u03c4) has been implicitly defined. Hence,\nHn(\u03bb, \u03c4, \u03b2\u0303(\u03c4)) = J \u22121/2Sn(\u03bb, \u03c4, \u03b20(\u03c4)) \u2212 \u03bbC(\u03c4)A(\u03c4)J\u22121/2Sn(1, \u03c4, \u03b20(\u03c4)) + op(1),\nwhere we recall C(\u03c4) = J\u22121/2H(\u03c4). The matrix, P (\u03c4) = C(\u03c4)A(\u03c4) is idempotent of rank k; cf. Eq (8) so that, by Lemma A.1, the claim follows.\nProof of Corollary 1.\nBy lemma A.1\nh(\u03c4)R\u2032H\u0303n(\u03bb, \u03c4,\u03b2\u0303(\u03c4) \u21d2 BBp(\u03bb)\n+ h(\u03c4)\u03b4(\u03c4)R\u2032C(\u03c4)R ( (1 \u2212 \u03bb) \u222b \u03bb\n0 g(v)dv \u2212 \u03bb\n\u222b 1\n\u03bb g(v)dv\n) .\nIn particular, if \u03bb = 1, then\nHn(1, \u03c4, \u03b2\u0303(\u03c4)) = J \u22121/2Sn(1, \u03c4, \u03b20(\u03c4))\n\u2212 C(\u03c4)A(\u03c4)J\u22121/2Sn(1, \u03c4, \u03b20(\u03c4)) + op(1) = (I \u2212 P (\u03c4))J\u22121/2Sn(1, \u03c4, \u03b20(\u03c4)) + op(1),\n(A.2)\nwhere we recall that under Ass. D, Im \u2212 P (\u03c4) = RR\u2032.\nMoreover, if T (\u03c4) is the inverse of the m\u00d7m matrix of eigenvectors of Im \u2212P (\u03c4), then, by the Jordan decomposition (see e.g. Abadir and Magnus, 2005, Ex 8.60), Im \u2212 P (\u03c4) = RR\u2032T (\u03c4) (where T (\u03c4) = Im if Ass. A holds). Therefore, h(\u03c4)Hn(1, \u03c4, \u03b2\u0303(\u03c4)) \u21d2  T (\u03c4)Bp(1)\n0k\n + h(\u03c4)  R \u2032T (\u03c4)C(\u03c4)R(\u2206(\u03c4) \u2212 \u03b4(\u03c4) \u222b 10 g(v)dv) 0k   .\nNoting that B(1) and BB(\u03bb) are independent because cov[B(1),BB(\u03bb)] = 0 by construction, this completes the proof.\nProof of Corollary 2. Follows immediately from Corollary 1.\nProof of Corollary 3. The claim follows from the continuous mapping theorem and Corollary 1.\nProof of Proposition 2. The proof follows analogously to that of Proposition 1 and Corollary 3 using Lemma A.1 (ii) and noting that\n1\u221a n\n\u230a\u03bbn\u230b\u2211\ni=1\nxi\u03c8\u03c4 (yi \u2212 x\u2032i\u03b2i,n(\u03c4)) \u21d2 Sm(\u03bb, \u03c4)\nuniformly on \u2113\u221e([0, 1] \u00d7 T ) as mentioned in the proof of Lemma A.1.\nProof of Corollary 4. The claim follows from the continuous mapping theorem and Proposition 2.\nProof of Proposition 3. Set Xn := {(yi, xi), 1 \u2264 i \u2264 n} and let P\u2217(\u00b7) denote the probability measure induced by the empirical distribution of Xn. Begin by observing that \u03b1n,b(\u03c4) solves the constrained quantile regression problem Eq. (4)\nbased on the rescaled data\n{(\u03c0i,bw\u2032i\u03b1n(Ui,b), \u03c0i,bwi), 1 \u2264 i \u2264 n},\nfor bootstrap weights \u03c0i,b IID\u223c \u03c0 =d Multinomial(n, 1/n). Based on this observation, we show first\n\u221a n(\u03b1n,b(\u03c4) \u2212 \u03b1n(\u03c4)) = \u221a n(\u03b1n(\u03c4) \u2212 \u03b1(\u03c4)) + oP\u2217(1). (A.3)\nTo see that this is true, observe that\n\u221a n(\u03b1n,b(\u03c4) \u2212 \u03b1n(\u03c4)) = \u2212 H\u22121\u03b1 (\u03c4)Sn,b,\u03b1(\u03c4, \u03b1n(\u03c4)) + oP\u2217(1),\nwhere the sub-gradient of the constrained quantile regression problem is given by\nSn,b,\u03b1(\u03bb, \u03c4, t\u03b1) := 1\u221a n\n\u230a\u03bbn\u230b\u2211\ni=1\nwi,b(1{y\u0302i,b \u2264 w\u2032i,bt\u03b1} \u2212 \u03c4), t\u03b1 \u2208 Rp.\nNote that Sn,b,\u03b1(\u03bb, \u03c4, \u03b1n(\u03c4)) is centred\nE[Sn,b,\u03b1(\u03bb, \u03c4, \u03b1n(\u03c4)) | Xn] = 1\u221a n\n\u230a\u03bbn\u230b\u2211\ni=1\nE[wi,b(1{y\u0302i,b \u2264 w\u2032i,bt\u03b1} \u2212 \u03c4) | Xn]\n= 1\u221a n\n\u230a\u03bbn\u230b\u2211\ni=1\nE[\u03c0]wi(E[1{w\u2032i\u03b1n(Ui,b) \u2264 w\u2032i\u03b1n(\u03c4)} | Xn] \u2212 \u03c4).\nNow, using E[\u03c0] = 1 and that w\u2032i\u03b1n(\u03c4) is the \u03c4 -quantile of yi conditional on Xn, one gets E[Sn,b,\u03b1(\u03bb, \u03c4, \u03b1n(\u03c4)) | Xn] = 0. Similarly, it follows\ncov[Sn,b,\u03b1(\u03bb1, \u03c41, \u03b1n(\u03c41)), Sn,b,\u03b1(\u03bb2, \u03c42, \u03b1n(\u03c42)) | Xn] = (\u03bb1 \u2227 \u03bb2)(\u03c41 \u2227 \u03c42 \u2212 \u03c41\u03c42).\nWe can conclude by the FCLT for IID data that, uniformly in (\u03bb, \u03c4) \u2208 [0, 1] \u00d7 T ,\nSn,b,\u03b1(\u03bb, \u03c4, \u03b1n(\u03c4)) = \u2212H\u03b1(\u03c4)Sp(\u03bb, \u03c4) + oP\u2217(1).\nThis proves Eq. (A.3). Next, define\nSn,b(\u03bb, \u03c4, \u03b2\u0303n,b(\u03c4)) = 1\u221a n\n\u230a\u03bbn\u230b\u2211\ni=1\nxi,b\u03c8\u03c4 (y\u0302i,b \u2212 x\u2032i,b\u03b2\u0303n,b(\u03c4)),\nwhere \u03b2\u0303n,b(\u03c4) = (0 \u2032 p, \u03b1n,b(\u03c4) \u2032)\u2032. We can then follow the proof of Proposition 1, using the above argument in conjunction with the stochastic equicontinuity of the two-parameter process Eq. (5) in (\u03bb, \u03c4) \u2208 [0, 1] \u00d7 T , and obtain\nSn,b(\u03bb, \u03c4, \u03b2\u0303n,b(\u03c4)) = Sn,b(\u03bb, \u03c4, \u03b2\u0303n(\u03c4)) + \u03bbH(\u03c4) \u221a n(\u03b2\u0303n,b(\u03c4) \u2212 \u03b2\u0303n(\u03c4)) + oP\u2217(1).\nBy Eq. (A.3), \u221a n(\u03b2\u0303n,b(\u03c4) \u2212 \u03b2\u0303n(\u03c4)) = \u221a n(\u03b2\u0303n(\u03c4) \u2212 \u03b2\u0303(\u03c4)) + oP\u2217(1) and, using similar arguments, Sn,b(\u03bb, \u03c4, \u03b2\u0303n(\u03c4)) = Sn(\u03bb, \u03c4, \u03b2\u0303(\u03c4))+oP\u2217(1). In view of Proposition 2 and Corollary 4, this proves Part (i). For Part (ii), note that under fixed alternatives c\u0302(\u03b1) = Op(1) because the way the bootstrap sample is generated enforces the null hypothesis. Therefore, following the same argument used in the proof of Theorem 3 (ii) in Rothe and Wied (2013), Part (ii) is proven."
        }
    ],
    "title": "Quantile Granger Causality in the Presence of Instability",
    "year": 2024
}