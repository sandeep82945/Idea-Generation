{
    "abstractText": "Protein-ligand (un)binding simulations are a recent focus of biased molecular dynamics simulations. Such binding and unbinding can occur via different pathways in and out of a binding site. We here present a theoretical framework how to compute kinetics along separate paths and to combine the path-specific rates into global binding and unbinding rates for comparison with experiment. Using dissipation-corrected targeted molecular dynamics in combination with temperature-boosted Langevin equation simulations [Nat. Commun. 11, 2918 (2020)] applied to a two-dimensional model and the trypsin-benzamidine complex as test systems, we assess the robustness of the procedure and discuss aspects of its practical applicability to predict multisecond kinetics of complex biomolecular systems.",
    "authors": [
        {
            "affiliations": [],
            "name": "Steffen Wolf"
        },
        {
            "affiliations": [],
            "name": "Matthias Post"
        },
        {
            "affiliations": [],
            "name": "Gerhard Stock"
        }
    ],
    "id": "SP:664954744cb59be8890d5fcee0be5746848db39e",
    "references": [],
    "sections": [
        {
            "text": "Path separation of dissipation-corrected targeted molecular dynamics simulations of protein-ligand unbinding\nSteffen Wolf\u2020,1 Matthias Post\u2020,1 and Gerhard Stock1 Biomolecular Dynamics, Institute of Physics, Albert Ludwigs University, 79104 Freiburg, Germanya)\n(Dated: 27 March 2023)\nProtein-ligand (un)binding simulations are a recent focus of biased molecular dynamics simulations. Such binding and unbinding can occur via different pathways in and out of a binding site. We here present a theoretical framework how to compute kinetics along separate paths and to combine the path-specific rates into global binding and unbinding rates for comparison with experiment. Using dissipation-corrected targeted molecular dynamics in combination with temperature-boosted Langevin equation simulations [Nat. Commun. 11, 2918 (2020)] applied to a two-dimensional model and the trypsin-benzamidine complex as test systems, we assess the robustness of the procedure and discuss aspects of its practical applicability to predict multisecond kinetics of complex biomolecular systems.\nI. INTRODUCTION\nReaction paths (or pathways) constitute a central concept to describe biophysical processes such as protein folding, allostery, and the binding and unbinding of biomolecular complexes.1 When we consider the free energy landscape \u2206G(x) along a (in general multidimensional) reaction coordinate x describing such a process, the minima correspond to metastable states reflecting the stationary distribution, while the valleys and saddle points connecting the minima account for the flux and thus the transfer rates between the states.2 The connection between two minima is in general not unique, i.e., various folding or unbinding pathways can exist. Hence biophysical processes can be described via path integrals,3 sampling schemes such as transition path sampling,4 or weighed ensemble methods.5 The knowledge of reaction paths is also useful to construct biasing coordinates, along which the sampling of rare transition events can be enhanced.6\u201311\nIn this work, we further exploit the concept of reaction paths to facilitate the general applicability of dissipation-corrected targeted molecular dynamics (dcTMD),12\u201314 a recently developed method to calculate slow (say, second-long) biomolecular kinetics from atomistic simulations.15\u201317 Combining enhanced sampling techniques with Langevin modeling, dcTMD applies a constant velocity constraint to drive an atomistic system from an initial state into a target state, say, the bound and unbound states of a protein-ligand complex. To extract the equilibrium free energy from these nonequilibrium simulations, dcTMD exploits Jarzynski\u2019s identity18\u201320\n\u03b2\u2206G = \u2212 ln \u2329 e\u2212\u03b2W \u232a , (1)\nwhich estimates the free energy difference \u2206G between the two states from the amount of work W done on the\na)Electronic mail: steffen.wolf@physik.uni-freiburg.de; stock@physik.uni-freiburg.de; \u2020These authors contributed equally to this work\nsystem to enforce the nonequilibrium process. Here \u3008. . .\u3009 denotes an ensemble average over statistically independent nonequilibrium simulations starting from a common equilibrium state, and \u03b2 = 1/kBT is the inverse temperature. To avoid problems associated with the poor convergence behavior of the exponential average,21,22 we may exploit the second-order cumulant expansion of Jarzynski\u2019s identity,\n\u2206G \u2248 \u3008W \u3009 \u2212 \u03b2 2\n\u2329 \u03b4W 2 \u232a , (2)\nwhere the first term represents the averaged external work, while the second term (with \u03b4W = W \u2212 \u3008W \u3009) corresponds to the mean dissipated work \u3008Wdiss\u3009 of the process (and explains the name \u2019dissipation-corrected\u2019 TMD). Since the knowledge of Wdiss allows us to calculate the friction coefficient \u0393 , in a second step the equilibrium dynamics of the process can be studied by propagating a Langevin equation, which is based on the free energy \u2206G and the friction \u0393 obtained from dcTMD.13\nIf the distribution of the external work W is well approximated by a Gaussian, the cumulant approximation in Eq. (2) is known to become exact. Since this approximation is indispensable for the efficient treatment of large molecular systems, the assumption of a normal work distribution is in fact the main (and formally only) condition underlying dcTMD. We expect such a distribution in the limit of slow pulling, where the response of the system is linear and the work is given as sum of many independent contributions,12,19 as required by the central limit theorem.23 In practice, though, this consideration is mainly of academic interest, because the computational effort is inversely proportional to the pulling velocity. By extending the argument to independent contributions in space, Post et al.14 argued that a Gaussian work distribution is also found for fluids. On the other hand, the assumption was shown to break down in the case of ligand-protein dissociation processes that provide several exit pathways of the ligand13 or ion diffusion through a membrane channel coupled to a conformational change of the protein.24 ar X iv :2 21 2. 07 15\n4v 3\n[ co\nnd -m\nat .s\nof t]\n2 4\nM ar\n2 02\n3\n2\nTo explain the origin of this breakdown, we consider a minimal model of ligand-protein dissociation, given by a two-dimensional (2D) potential energy landscape V (r, \u03b8) and corresponding friction profile \u0393 (r, \u03b8) (see the Supplementary Material and Fig. S1 for details). As shown in Fig. 1a, the initial bound state is located at the origin (r= 0), and the dissociated state is reached via external pulling along the radial coordinate r to rD = 1.75 nm. While in most directions (defined by the angle \u03b8), the ligand encounters high energy barriers mimicking the steric hindrance of the surrounding protein, two well-separated paths (\u20191\u2019 and \u20192\u2019) of relatively low energy exist, along which dissociation may occur. In general, these paths will exhibit different free energy curves as well as different friction factors, but both end at the same energy, accounting for the dissociated state.\nAiming to model the dissociation process via dcTMD, we pull the ligand along the radial coordinate r accounting for the ligand-protein distance, giving rise to the free energy profile\n\u03b2\u2206G(r) = \u2212 ln [ \u222b \u221e\n0\nr\u2032 dr\u2032\u03b4(r \u2212 r\u2032) \u222b 2\u03c0\n0\nd\u03b8 e\u2212\u03b2V (r \u2032,\u03b8)\n]\n= \u2212 ln [ \u222b 2\u03c0\n0\nd\u03b8 e\u2212\u03b2V (r,\u03b8) ] \u2212 ln r, (3)\nwhere the factor \u2212 ln r represents the configurational entropy arising from the Jacobian of the projection.25 As shown in Fig. 1c, the exact free energy \u2206G(r) calculated from Eq. (3) exhibits (by design) two maxima at r \u223c 0.36 and 1.03 nm, before the ligand dissociates for large r. Performing dcTMD simulations in combination with Jarzynski\u2019s identity (1), the reference results for \u2206G(r) are only accurately reproduced for small r, but deteriorate at larger distances due to sampling problems.\nInvoking the cumulant approximation, on the other hand, only the first barrier is reproduced, while the free energy goes to nonphysically low values (\u223c \u221230 kBT ) for longer ligand-protein distances. Figure 1b reveals the reason for this drastic breakdown of the cumulant approximation by clearly showing a non-Gaussian shape of the corresponding work distribution, which leads to an overestimation of the variance of the work and thus also of the dissipated work.\nTo present a remedy for this problem, we note that in our simple model the dissociation can occur exclusively through either path 1 or 2. Hence we may consider trajectories following one of these paths separately, and calculate the work distribution associated with this path. To define a simple separatrix of the two paths, we use the diagonal r1 = r2 in Fig. 1a for 0.44 nm\u2264 r \u2264 0.88 nm. Interestingly, Fig. 1b reveals that the work distributions of the individual paths are both well approximated by a Gaussian, although of different means and widths (for an illustration of the sampling per path, see Figs. S1d-f). Adding these distributions (weighted by the probability that the corresponding path is taken), we by design recover the total work distribution, which readily explains its bimodal appearance. Most importantly, the finding of normal work distributions for each path suggests that we may apply the cumulant approximation for each path separately, in order to obtain the correct free energy profiles for the two paths, as is shown in Fig. 1c. The theory of path separation including the calculation of observables from various paths is a central goal of this work and will be developed in Sec. II D.\nWhile the discussion above seems to concern a technical problem of dcTMD, we note that it represents in fact a quite general issue. It occurs whenever we perform enhanced sampling along a 1D biasing coordinate, although the considered process in fact takes place on a\n3 multidimensional energy landscape with several reaction channels. As an illustration, Fig. S2 shows various thermodynamic integration protocols to calculate the free energy profile \u2206G(r) of the 2D model. Although thermodynamic integration is in principle exact, it is found to typically fail in this example. This is a consequence of incomplete sampling of the two paths by the biasing due to the absence of jumps over the path-separating energy barrier, which should also occur for other 1D biasing techniques such as umbrella sampling.\nMotivated by this simple example, in this work we present general theoretical considerations under which conditions a separation of the total reaction flux in several pathways is possible, in the sense that it ensures the validity of the cumulant approximation and thus the applicability of dcTMD. We also discuss the question which paths are most important (i.e., exhibits the highest reaction rates), and which paths can be safely neglected. In practical calculations, the definition and detection of paths represent a nontrivial issue. To this end, we consider nonequilibrium principal component analysis1 as a generic dimensionality reduction approach, which allows to determine and characterize various paths in a low-dimensional space. Employing the trypsinbenzamidine complex27,28 as a well-established model problem to test enhanced sampling techniques,15\u201317,29\u201331 the performance and the potential of the proposed path separation scheme is discussed."
        },
        {
            "heading": "II. THEORY",
            "text": ""
        },
        {
            "heading": "A. Dissipation-corrected targeted molecular dynamics",
            "text": "For further reference, we first briefly summarize the theoretical foundation of dcTMD, which was given in Refs. 12\u201314. To pull two molecules apart (e.g., protein and ligand), TMD as developed by Schlitter et al.32 uses a constraint force f that results in a moving distance constraint x = x0 + vt with a constant velocity v. Pulling from x0 to x, the mean external work performed on the system is given by\n\u3008W (x)\u3009 = \u222b x\nx0\ndx\u2032 \u3008f(x\u2032)\u3009 , (4)\nwhere \u3008. . .\u3009 again denotes the average over all nonequilibrium trajectories. Evaluating the second cumulant of the work in Eq. (2), we obtain the dissipated work12\n\u3008Wdiss(x)\u3009 = \u03b2\n2\n\u222b x\nx0\ndx\u2032 \u222b x\nx0\ndx\u2032\u2032 \u3008\u03b4f(x\u2032)\u03b4f(x\u2032\u2032)\u3009 , (5)\nwhich is defined via the autocorrelation function of the constraint force \u03b4f = f \u2212 \u3008f\u3009.\nExploiting that the cumulant approximation neglects higher orders of the force autocorrelation function and due the simplification arising from the constraint x = x0 + vt, we can \u2013without further approximation\u2013 derive\na generalized Langevin equation of the nonequilibrium process,14\nmx\u0308(t) = \u2212\u2202G \u2202x \u2212 \u222b t\n0\nd\u03c4K(t, \u03c4) x\u0307(\u03c4)+\u03b7(t)+f(t) = 0 , (6)\nwhich includes the mean force\u2212\u2202G/\u2202x, a non-Markovian friction force with memory function K(t, \u03c4), a stochastic force \u03b7(t) due to the associated colored noise with zero mean, and the external pulling force f(t). The memory kernel is given by the autocorrelation function of the constraint force,\nK(t2, t1) = \u03b2 \u3008\u03b4f(t2)\u03b4f(t1)\u3009 . (7)\nIt obeys the fluctuation dissipation theorem\nK(t2, t1) = \u03b2 \u3008\u03b7(t2)\u03b7(t1)\u3009 , (8)\nwhich states that non-white noise \u03b7 causes a finite decay time of the memory kernel K. Nevertheless, by using x\u0307(\u03c4) = v, Eq. (6) can be written in the form of a Markovian Langevin equation\nmx\u0308(t) = \u2212\u2202G \u2202x \u2212 \u0393 (x(t)) x\u0307(t) + \u03b7(t) + f(t) = 0, (9)\nalthough the noise \u03b7(t) is not delta-correlated due to Eq. (8). Here\n\u0393 (x) =\n\u222b t(x)\n0\ndt\u2032K(t, t\u2032) (10)\nrepresents the position-dependent friction \u0393 (x) associated with the pulling process. Employing Eq. (5), the friction can also be directly calculated from the dissipated work via14\n\u0393 (x) = \u03b2\n2 v\n\u2202\n\u2202x\n\u2329 \u03b4W 2(x) \u232a , (11)\nwhich is numerically advantageous compared to Eq. (10), as it avoids the computationally expensive calculation of autocorrelation functions. Data analysis was performed using Python packages NumPy,33 SciPy,34 and Pandas.35 Matplotlib36 and Gnuplot37 were used for generating plots. Calculations with the 2D model were carried out using a Jupyter notebook.38"
        },
        {
            "heading": "B. Calculation of reaction rates",
            "text": "The Langevin model may be used to discuss the nonequilibrium process in terms of the memory function K(t2, t1) and the associated friction \u0393 (x), which both are directly obtained from dcTMD. What is more, we can employ the free energy \u2206G(x) and the friction \u0393 (x) from dcTMD to simulate the unbiased dynamics via the free Langevin equation [Eq. (S12) with f = 0]. While Jarzynski\u2019s identity [Eq. (1)] states that this is correct for the free energy, the friction determined by dcTMD\n4 in general depends on the pulling velocity v, see Ref. 14. Since this velocity dependence affects the overall transition rates (typically by a factor of \u223c 2) clearly less than errors in the estimate of the energy barrier, the usage of dcTMD friction factors in equilibrium Langevin simulations nevertheless represents a promising strategy to estimate transition rates of slow processes.13\nThe theoretical formulation of dcTMD given above can be nicely illustrated by a simple model proposed by Zwanzig,39 which couples a general 1D system (in general nonlinearly) to a harmonic bath. In the unbiased case (with constraint force f = 0), it is well established that the model gives rise to an exact general Langevin equation as in Eq. (S12). As shown in the Appendix, the formulation readily generalizes to the case of constrained dynamics used in dcTMD, revealing that both biased and unbiased dynamics can be described by the same Langevin model. Moreover, we derive explicit expressions for the resulting external force f(t) and the associated work W . Starting from a Boltzmann distribution (as required for Jarzynski\u2019s identity), in particular, we obtain a Gaussian distribution of the work, which renders the cumulant approximation exact.\nWhen we intend to model very slow processes such as ligand-protein dissociation that can take seconds to hours, there is one more practical issue to overcome. That is, since the numerical integration of the Langevin equation typically require time steps of a few femtoseconds, we would need to propagate Eq. (S12) for & 100 \u00b7 1015 steps to sufficiently sample a process occurring on a timescale of seconds. As a remedy, we employ the method of \u201cT -boosting\u201d which exploits the fact that temperature is the driving force of the Langevin dynamics.13 That is, when we consider a process described by a transition rate k and increase the temperature from T1 to T2, the corresponding rates k1 and k2 are related by the Kramers-type expression\nk2 = k1e \u2212\u2206G 6=(1/(kBT2)\u22121/(kBT1)) , (12)\nwhere \u2206G6= denotes the transition state energy of the process. Hence, by increasing the temperature we also increase the number n of observed transition events according to n2/n1 = k2/k1. Unlike methods like temperatureaccelerated MD,40 where \u2206G(x) is first calculated at a high temperature and subsequently rescaled to a desired low temperature (whereupon \u2206G(x) in general changes), T -boosting does not need to assume that \u2206G(x) is independent of T , because by using dcTMD we calculate \u2206G(x) right away at the desired temperature. See Ref. 13 for a discussion of the performance of T -boosting for the trypsin-benzamidine complex.\nC. Validity of the cumulant approximation\nSince the main presumption of dcTMD is that the distribution of the work W resembles a Gaussian to justify the cumulant approximation (2), it is important to study the validity of this assumption. To this end, we integrate\nEq. (S12) from the initial position x0 to the end position x, yielding\nW (x) = \u2206G(x) + v\n\u222b x\nx0\ndx\u2032\u0393 (x\u2032)\u2212 \u222b x\nx0\ndx\u2032\u03b7(x\u2032), (13)\nwhere we defined \u03b7(t) = \u03b7((x\u2212x0)/v) \u2261 \u03b7(x). Upon averaging, the stochastic force term cancels out (since \u3008\u03b7(x)\u3009 = 0), which again leads to the relation \u2206G = \u3008W \u3009 \u2212 \u3008Wdiss\u3009 discussed above. On the other hand, when we consider the work W associated with a single trajectory, we find that the first two terms on the right-hand-side of Eq. (13) are identical for all trajectories, due to the constraint x = x0 + vt. Hence the distribution of the work, P (W ), is completely determined by the distribution P (\u03b4Wdiss) of the integrated noise \u03b4Wdiss(x) \u2261 \u222b x\nx0 dx\u2032\u03b7(x\u2032). In other words, if P (\u03b4Wdiss)\nis normal distributed, so is the work distribution P (W ). Given as a sum of many small noise increments \u03b7(x), the central limit theorem generally assures that P (\u03b4Wdiss) is a normal distribution. Importantly, this holds even if the noise \u03b7 arising in the Langevin equation is not Gaussian distributed; only the integrated noise \u03b4Wdiss needs to be Gaussian. Moreover this conclusion holds for position-dependent noise and friction, as long as the noise integral is not dominated by some singularly high noise increments, for which the central limit theorem breaks down.23 Given these conditions and the special case that the problem can be properly described by a single reaction coordinate x, we therefore expect a Gaussian work distribution and thus the validity of the cumulant approximation.\nThe situation becomes considerably more involved, when the system cannot be described by a single reaction coordinate x, but requires another (in general multidimensional) coordinate y for an appropriate description. Assuming for simplicity a 2D model, this means that the system is pulled along coordinate x, but additionally can freely evolve along coordinate y. Potential implications of the additional degree of freedom on the resulting work distribution have been illustrated in Fig. 1 for a simple model problem, where the motion along y = \u03b8 gives rise to a splitting of the 2D energy landscape into two 1D pathways (See also Fig. S3). While the work distributions of the individual paths are well approximated by a Gaussian, their means and widths are different, such that the sum of the Gaussians exhibits a bimodal appearance. As a consequence, we cannot simply apply the cumulant approximation to the full problem, but need to resort to a treatment of the individual paths.\nWe note in passing that in practice it is not obvious how to test the Gaussianity of the work distribution, in order to ensure that the cumulant approximation works. While well-established normality tests exist,41 we found their results rather inconclusive for the problem at hand, especially for the small number of trajectories that are available for atomistic protein-ligand models. As a qualitative means to study the shape of the work distribution\n5 P (W ), especially its tail for low W , we may compare P (W ) to a normal distribution whose mean and variance matches the sampled mean and variance. In practice, we compare the points of the computed work to the quantiles of the corresponding normal distribution, such that the deviations reveal a non-Gaussian shape. This has the advantage that the comparison explicitly shows all data points and does not depend on the choice of bins. The test is demonstrated in Fig. S4 for the 2D model, which exhibits deviations from normality in the full trajectory set that become resolved in the path-separated sets."
        },
        {
            "heading": "D. Path separation",
            "text": "To study under which conditions a separation of the total reaction flux into several non-interacting pathways is possible and helpful for practical calculations, we now present a mathematical description of the path separation scheme discussed above. To this end, we again assume that the considered process is well represented as a function of the pulling coordinate x and of a further coordinate y, along which the system can evolve freely. Given the resulting free energy landscape \u2206G(x,y), we wish to define a reaction path k as a class of similar trajectories (x,y) (t), whose distribution can be characterized by a 1D free energy curve \u2206Gk(x), which describes this specific path from an initial (e.g., bound) state to a final (e.g., unbound) state. This definition corresponds to the assumption of distinct \u201dvalleys\u201d in \u2206G(x,y) connecting x0 and xend. For simplicity, we for now assume that trajectories of different paths should be mutually exclusive, i.e., the paths should not overlap. As the latter condition may be difficult to satisfy in practice, we will discuss in Sec. II G a procedure to relax this condition.\nGiven the free energy landscapes \u2206G(x,y) and \u2206G(x), we first introduce the probabilities\nP (x,y) = e\u2212\u03b2\u2206G(x,y)/Z, (14)\nP (x) = e\u2212\u03b2\u2206G(x)/Z =\n\u222b\ndy e\u2212\u03b2\u2206G(x,y)/Z, (15)\nZ =\n\u222b\ndx e\u2212\u03b2\u2206G(x) =\n\u222b\ndx\n\u222b\ndy e\u2212\u03b2\u2206G(x,y). (16)\nTo partition the probability P (x) into paths labeled by k= 1, . . . ,K, we define regions Y k(x) of the free energy landscape \u2206G(x,y), such that they only include trajectories of path k, i.e., Y k(x) = {y | (x,y) \u2208 path k}. This allows us to write\nP (x) = \u2211 k P (x, k), (17)\nP (x, k) = 1\nZ\n\u222b\ny\u2208Y k(x) dy e\u2212\u03b2\u2206G(x,y), (18)\nwhere P (x, k) represents the joint probability to be on path k and at position x. Additional regions of the free energy landscape \u2206G(x,y) not covered by the reaction\npaths (such as hardly accessible high-energy regions) can formally be included via additional terms of the sum, but are not of interest here, as they have a negligible impact on the integral in Eq. (17). Alternatively, we may write\nP (x, k) = pkP (x|k), (19)\nwhere pk is the probability to be on path k and P (x|k) is the resulting conditional probability to be at position x if path k is followed. In this way, specified by adding the subscript or superscript \u201ceq\u201d, we may interpret the partitioning in Eqs. (17) and (19) in terms of the free energy as\nPeq(x, k) \u2261 peqk e\u2212\u03b2\u2206Gk(x)/Z, (20)\nwhich yields the equilibrium path probabilities peqk and path free energy curves \u2206Gk(x). Both quantities are needed when we want to calculate the reaction rates of the system via a Langevin model as will be described in Sec. II E.\nSince we typically cannot calculate these quantities directly (due to the MD simulation time limits mentioned before), we perform nonequilibrium dcTMD simulations. Let us assume that we have in total N nonequilibrium trajectories labeled by n = 1, . . . , N , which are divided into the K different paths, each containing Nk trajectories labeled by nk = 1, . . . , Nk. Due to the initial preparation of the system and the nature of the paths, each path occurs in the dcTMD simulations with an observed probability pneqk = Nk/N . Expressing the ensemble average \u3008. . .\u3009 as a sum over all nonequilibrium trajectories n with work Wn(x), we obtain from Jarzynski\u2019s identity [Eq. (1)]\ne\u2212\u03b2\u2206G(x) = 1\nN N\u2211 n=1 e\u2212\u03b2Wn(x) = K\u2211 k=1 Nk N 1 Nk Nk\u2211 nk=1 e\u2212\u03b2Wnk(x)\n= \u2211 k pneqk \u2329 e\u2212\u03b2W (x) \u232a k \u2261 \u2211 k pneqk e \u2212\u03b2\u2206Gk(x) ,\n\u2261 Z \u2211 k Pneq(x, k), (21)\nwhere \u3008. . .\u3009k denotes the average over all trajectories of path k, and \u2206Gk(x) represents the energy profile along this path. Note that the latter can per se not be identified with the free energy curves \u2206Gk(x) in Eq. (20), because the path energy curves \u2206Gk(x) as well as the path probabilities pneqk are nonequilibrium quantities that depend on the protocol of the dcTMD simulations such as the pulling velocity v.\nSince Jarzynski\u2019s identity can be generalized1 to estimate the free energy landscape \u2206G(x,y), we may project the corresponding joint probability P (x,y) onto each path k along coordinate x, yielding Pneq(x, k) = Peq(x, k). This equivalence can be used to calculate the equilibrium path probabilities peqk from the nonequilib-\n6 rium simulations via\npeqk \u2261 \u222b dxPeq(x, k) (22)\n= pneqk Z\n\u222b\ndx e\u2212\u03b2\u2206Gk(x), (23)\nwhere the partition function\nZ = \u2211 k pneqk \u222b dx e\u2212\u03b2\u2206Gk(x) (24)\nis obtained from the the path estimates in Eq. (21). (To derive Eq. (23), we used that Z = \u222b\ndx e\u2212\u03b2\u2206G(x) = \u222b\ndx e\u2212\u03b2\u2206Gk(x) for any path k, which is a consequence\nof the normalization condition \u222b dxP (x|k) = 1.) Moreover, the equivalence shows that the free energy curves \u2206Gk(x) in Eq. (21) and the corresponding nonequilibrium energy curves \u2206Gk(x) in Eq. (23) simply differ by a constant shift of the energy\n\u2206Gk(x) = \u2206Gk(x) + \u03b2\u22121 ln (peqk /p neq k ) . (25)\nAs a consequence, both energy curves give rise to the same mean force fPMF = \u2212\u2202G/\u2202x in Langevin equation (S12), and can therefore both be considered as potentials of mean force.\nJust as for the general Jarzynski identity (1), the direct evaluation of the exponential average \u2329 e\u2212\u03b2W (x) \u232a k of path k in Eq. (21) is numerically cumbersome. However, when we assume that the work associated with each individual path is normal distributed, the potential of mean force along path k can be calculated using the cumulant approximation,\n\u2206Gk(x) \u2248 \u3008W (x)\u3009k \u2212 \u03b2\n2\n\u2329 \u03b4W 2(x) \u232a k , (26)\nwhich was the main motivation to perform the path separation in the first place."
        },
        {
            "heading": "E. Path importance",
            "text": "When studying ligand-protein dissociation, a natural indicator for the importance of a reaction path is the reaction rate at equilibrium. This is because the total dissociation rate ktot is given as the sum over all equilibrium rates contributing to the considered process. Assuming that path k occurs in an equilibrium simulation with probability peqk , the total rate can be written as\nktot = \u2211 k peqk kk , (27)\nwhere kk is the rate associated with the path. We note that Eq. (27) corresponds to the well-known sum42 ktot =\u2211 k k\u0303k of weighted first-order reaction rates k\u0303k = p eq k kk. The weights peqk account for the correct partitioning of\nthe process into paths, because the calculation of a rate along a single path does not include the possibility to switch between various paths. Since a single path with an extraordinary high rate may completely dominate the reaction, it is clearly of interest to identify the most important pathways of a reaction. In this way, several paths of similar importance may exist and therefore all contribute to ktot.\nAs an illustrative example, we again consider the simple model discussed in Fig. 1, which shows two reaction paths (k = 1, 2) with nonequilibrium energy curves \u2206Gk(r). Using these curves and the associated path probabilities pneq1 \u2248 0.81 and pneq2 \u2248 0.19 from dcTMD, Fig. 1c shows that the correct overall free energy \u2206G(r) is indeed nicely recovered from Eq. (21). (As discussed in Sec. II G, we exclude dcTMD trajectories that initially cross between paths 1 and 2 (about 4 %) from the analysis.) The corresponding equilibrium path probabilities peq1 \u2248 0.79 and peq2 \u2248 0.21 obtained from Eq. (23) are quite similar to the nonequilibrium results, which indicates that x is a suitable reaction coordinate.\nTo obtain the dissociation and association rates of the model, we perform 10 \u00d7 1 ms-long unbiased Langevin simulations [Eq. (S12) with f=0] independently for each 1D path (see the Supplementary Material for details). As shown in Tab. I, the two paths differ in their importance for both binding and unbinding. While path 2 exhibits larger rates for both processes, path 1 is accessed in 80 % of all attempts, such that path 1 has the largest impact on the overall binding and unbinding rate. Using Eq. (27), we also calculated the total dissociation and association rates, i.e., averaged over the two paths. This is of particular interest, because for the simple 2D model the total rate can also be directly calculated by performing Langevin simulations on the \u2019full-dimensional\u2019 potential energy landscape, i.e., without performing a separation into 1D paths (see Fig. S3 for details). Table I shows perfect agreement of path-based rates and 2D results for dissociation, while the association rates are found to differ by 14 %.\nThe above example demonstrates that even for a ap-\n7 parently simple model problem, the interpretation of the various pathways contributing to the reaction rate may be not straightforward. Rather than resorting to approximate theories such as Kramers\u2019 relation (which, e.g., assumes a single barrier of parabolic shape and constant friction), we therefore recommend the calculation of reaction rates via the numerical propagation of the unbiased Langevin equation."
        },
        {
            "heading": "F. Path detection",
            "text": "In our introductory example shown in Fig. 1, the two paths of the model are readily identified via visual inspection of the 2D potential energy landscape. When we consider an all-atom MD simulation of a protein-ligand complex, however, this is typically not possible because the trajectories evolve in a 3N\u22126-dimensional space of the N atoms of the complex. Hence in a first step, we need to employ some dimensionality reduction approach to identify collective variables that appropriately describe the unbinding dynamics in a low-dimensional space,43,44 and allow to cluster the unbinding trajectories into different reaction pathways.\nWhile various techniques to identify ligand unbinding paths have been suggested,6,8\u201310,30 here we employ a principal component analysis (PCA) of protein-ligand contacts,45 which assumes that these contacts are suitable features to represent the unbinding process. Considering an equilibrium MD simulation with coordinates q = {qi}, the basic idea is to construct the covariance matrix\n\u03c3eqij = \u3008\u03b4qi\u03b4qj\u3009eq , (28)\nwhere \u03b4qi = qi\u2212\u3008qi\u3009eq. PCA represents a linear transformation that diagonalizes \u03c3 and thus removes the instantaneous linear correlations among the variables. Ordering the eigenvalues of eigenvectors eeqn decreasingly, the first principal components V eqn = e eq n \u00b7 \u03b4q account for the directions of largest variance of the data, and are therefore often used as collective variables.46,47\nWhen we consider dcTMD simulations that enforce the unbinding of a complex along the pulling coordinate x, we wish to identify the directions of largest variance of the dcTMD data, in order to separate the unbinding trajectories into different paths. Hence we calculate the covariances directly from the dcTMD simulations, and average over x to obtain the nonequilibrium covariance matrix1\n\u03c3neqij = 1\nxend \u2212 x0\n\u222b xend\nx0\ndx \u3008\u03b4qi(x)\u03b4qj(x)\u3009neq . (29)\nThis leads to principal components V neqn that map out an energy landscape \u2206G associated with the nonequilibrium distribution generated by dcTMD. In practice, this simply means to perform a PCA of the concatenated TMD trajectories. Performing the PCA on contact distances, the first principal component by design correlates with the pulling coordinate. This connection may not be given\nif other input features, such as dihedral angles, are employed. In this case, we can consider the content of eigenvectors to identify their respective dynamics in Cartesian space.\nNote that this nonequilibrium PCA is well defined, because the nonequilibrium principal components are related to their equilibrium counterparts via Jarzynski\u2019s identity. That is, when we replace the equilibrium average in Eq. (28) by a Jarzynski-type average over the nonequilibrium data, we obtain1,48\n\u03c3eqij =\n\u222b dx \u2329 \u03b4qi(x)\u03b4qj(x) e \u2212\u03b2W (x)\u232a neq\n\u222b dx\u2032 \u2329 e\u2212\u03b2W (x\u2032) \u232a neq\n, (30)\nwhich is an equilibrium covariance matrix constructed via the reweighting of the nonequilibrium data. We note that the dimensionality reduction of nonequilibrium dcTMD data proposed in Ref. 1 is not restricted to PCA, but may as well be used in combination with nonlinear or machine learning empowered approaches.49,50"
        },
        {
            "heading": "G. Applicability and practical considerations",
            "text": "When we apply the above introduced path separation approach to all-atom MD simulations of ligand unbinding, various general as well as practical problems may arise. As so often, the key issue is the appropriate choice of coordinates to define the free energy landscape \u2206G(x,y) of the system. Most importantly, the pulling coordinate x should represent a suitable 1D reaction coordinate of the unbiased system, such that equilibrium and nonequilibrium path weights are similar. The collective variables {yj} = y, on the other hand, should allow for a low-dimensional representation of the free motion of the system \u201caround\u201d coordinate x. In particular, the purpose of coordinate y is to facilitate the detection of reaction pathways. As discussed above, a straightforward choice for y are the first principal components of a PCA of protein-ligand contacts. Representing an internal coordinate system of the protein-ligand complex, these coordinates may describe unbinding routes through 3D space along which the ligand can minimize steric clashes with the protein, thereby managing to find a low-energy exit path from the binding pocket. Other candidates for y are protein backbone dihedral angles (in case that the unbinding is connected to a protein conformational change24,51) and intra-ligand hydrogen bonds (whose change affect the ligand\u2019s conformational flexibility52).\nGiven these coordinates, the subsequent clustering of unbinding trajectories into distinct reaction paths is based on the assumption that these paths are well separated on the free energy landscape \u2206G(x,y). If the energy landscape between two paths is flat, however, trajectories may cross between the paths and thus hamper a clear path separation. Even for the simple 2D model discussed in Fig. 1, we find crossing trajectories at the beginning of both paths, which constitute \u223c 4 % of all per-\n8 formed simulations (see Fig. S1c). In principle, we could cut crossing trajectories into segments that are attributed to different paths. However, similarity measures between crossing and other trajectories are typically inconclusive, and the calculation of path energy curves [Eq. (26)] using a varying number of trajectories for each position x turns out to be quite inefficient. Considering an atomistic description of ligand unbinding, on the other hand, crossings between various exit paths may naturally occur also during the unbinding process. In the limiting case that the free energy landscape is overall flat, most trajectories will cross and a path separation ansatz does not make sense from the outset. On the other hand, if only some smaller part of the trajectories cross, and if we assume that they do not change the path energy curves, we may remove these trajectories from the analysis.\nProceeding with more practical aspects of path separation, we note that the occurrence of crossing trajectories also depends sensitively on the pulling velocity v. In general, we want to choose v low enough to ensure that motions described by coordinate y have sufficient time to relax. This corresponds to a slow adiabatic change,53 which leaves the system virtually at equilibrium at all positions x. On the other hand, if v is chosen too slow, the constraint can artificially facilitate transitions over barriers along y; a process that might not happen in the unconstrained case. In this way, low pulling velocities may lead to an increase of crossing trajectories. To find a balance between these conflicting conditions, in practice we will try to find a sweet spot of the pulling velocity, which typically is around 1 m/s for ligand-protein complexes (see Fig. S4 of Ref. 13).54 We note in passing that fast pulling velocities may also result in a jamming of the ligand in an unfavorable position of the binding pocket, which in consequence leads to a sharp peak of the constraint force when unbinding is enforced. Since this effect would not occur at equilibrium, however, jammed trajectories can be safely neglected."
        },
        {
            "heading": "III. APPLICATION: THE TRYPSIN-BENZAMIDINE COMPLEX",
            "text": "The inhibitor benzamidine bound to trypsin27,28 is a well-established model problem to test enhanced sampling techniques.15\u201317,29\u201331 As the unbinding process is well characterized and occurs on a millisecond timescale,27 the complex represents an ideal system to study the virtues and shortcomings of the path separation scheme."
        },
        {
            "heading": "A. Computational details",
            "text": "MD and dcTMD simulations of the trypsinbenzamidin complex were described in detail in Ref. 13. In brief, all simulations were performed using Gromacs 2018 (Ref. 55) in combination with the Amber99SB force field56,57 for the protein. Ligand parameters were obtained from Antechamber58 with GAFF atomic parameters.59 Atomic charges were obtained from quan-\ntum calculations at the HF/6-31G* level using Orca60 followed by RESP charge calculations in Multiwfn.61 The TIP3P model62 was used for the solvent water, and the 1.7 A\u030a crystal structure28 (PDB 3PTB) as starting condition. dcTMD calculations were carried out using the PULL code implemented in Gromacs. The constraint was defined via the distance between the centers of mass of the heavy atoms of benzamidine and the C\u03b1 atoms of the central \u03b2-sheet of the protein. Sampling from an equilibrium simulation at 290 K, 400 statistically independent starting points were obtained, for which dcTMD simulations were performed using a pulling velocity v = 1 m/s. Using 400 simulations, the least populated path is taken by 52 simulations, which is typically suitable to obtain sufficiently accurate PMF and path weight estimates.12,13 The accumulated simulation time of 0.8 \u00b5s required a total wall clock time of 640 hours on a workstation with an Intel i7-3930K processor and a NVIDIA GeForce GTX 670.\nFor path separation we employed a nonequilibrium PCA1 on protein-ligand contacts, see Sec. II F. Concatenating all 400 dcTMD runs into a single pseudotrajectory, we determined all residues that exhibit a minimal distance \u2264 4.5 A\u030a between the heavy atoms of benzamidine and the protein.45 Using these contacts and the fastpca program,63 the nonequilibrium covariance matrix [Eq. (29)] and the associated principal components were obtained (Fig. S5). For the calculation of binding and unbinding rates, free energy and friction fields obtained from dcTMD were employed to run unbiased Langevin equation simulations, see the Supplementary Material for details. To enhance the sampling, we employ the T -boosting technique described in Sec. II B, using five independent simulations of 200 \u00b5s length each at 13 different temperatures between 380 and 900 K."
        },
        {
            "heading": "B. Results and Discussion",
            "text": "Figure 2 displays the structure of trypsin and indicates the direction of the three observed dissociation paths of benzamidine by colored arrows. Using the same colors, we also show the resulting nonequilibrium energy landscape \u2206G(x, y), represented as a function of the pulling coordinate x and the second principal component y of a contact PCA. We note that coordinate x is highly correlated with the first principal component (Fig. S5), which therefore could also be used instead of x. On the other hand, coordinate y encodes the dissociation path by reporting on the direction along which benzamidine moves over the protein surface after unbinding. As shown in Fig. S5, the 2D representation already explains 78% of the total variance of the unbinding process.\nAll unbinding simulations start with a common rupture of the benzamidine-Asp189 salt bridge at x \u223c 0.5 nm, which allows the ligand to exit the binding pocket.13 Subsequently, the diffusion of benzamidine away from the binding site funnel is found to follow different routes along the protein surface. As can be de-\n9\nrived from the contributions of individual contacts to y in Fig. S5, the \u201dtop\u201d pathway (i.e., corresponding to high values in y) leads to a motion along residues Asn74, Ser150 and Gln192, which are highlighted in orange in Fig. 2. The \u201dbottom\u201d pathway, on the other hand, corresponds to diffusion close to residues Cys58, Asn95 and Glu175 highlighted in blue. Finally, the \u201dmiddle\u201d pathway describes unbinding directly into the bulk water. For all paths, P (W ) exhibits a normal distribution, see Fig. S4. However, we note that the shifts of the mean \u3008W \u3009 are small compared to the distributions\u2019 widths, rendering this type of analysis difficult.\nFigure 2c shows the resulting free energy profiles \u2206Gk(x) of the three paths. In line with the 2D energy landscape, all paths show the same increase of the free energy until the transition state at x \u223c 0.5 nm, which reflects the rupture of the benzamidine-Asp189 salt bridge. Following this main energy barrier, the free energy of the \u201dtop\u201d pathway drops to a subsequent deep minimum at x \u223c 1.0 nm, which is indicative of an unspecific binding site on the surface of the protein involving Tyr151. This binding site was also discussed in Ref. 29, therein named S3. The \u201dmiddle\u201d path, on the other hand, rapidly levels off to the free energy value of the unbound state. This agrees with the path leading directly into the bulk water, which was also found in Ref. 64. The \u201dbottom\u201d pathway exhibits a second minimum at x \u223c 0.7 nm, followed by a 2nd energy barrier at x \u223c 1.2 nm. This unspecific binding site close to, e.g., Glu175 has also been observed in Ref. 29 (therein named S2). Moreover, our transition state agrees with the findings of Ref. 15.\nLet us now turn to the analysis of the kinetics predicted for the various pathways. Comprising the nonequilibrium and equilibrium weights as well as the dissociation and association rates of the three paths, Tab. II reveals that\nthe \u201dmiddle\u201d path is the most populated (148 trajectories out of 400), while the two other paths each have less than 40 % population. We additionally encounter a significant number of crossing trajectories (139 out of 400), which were discarded in the analysis. Apart from being the most accessed path, the middle pathway provides also the fastest way in and out of the protein, and results in rates that are surprisingly similar to the experimental findings.27 For these reasons, we focused in our previous work13 on the main path and did not further investigate the remaining paths. In the present more elaborated study, however, we find that the unbinding rate koff is nearly identical for the three paths. This may be related to the fact that all paths coincide on the 1D and 2D energy landscapes in Fig. 2 until the transition state. Concerning the binding process, we find that the top path is by two orders of magnitude slower than the other two paths, which is due to the deep minimum of\n10\nthe free energy at x \u2248 1.0 nm. When we finally compare to experiment, we find that the calculated total unbinding rates reproduces the observed rate within its error margin, while the binding rate is underestimated by a factor of \u223c6. Consequently, the equilibrium dissociation constant KD = koff/kon is overestimated by a factor of \u223c6 as well. We note that this corresponds to an underestimation of the standard free energy of binding \u2206G0 = \u2212kBT lnKD by \u223c1.8 kBT , which is well below the mean error (\u223c3 kBT ) of current prediction methods of absolute binding free energy.65 Furthermore, we note that ignoring the existence of paths and employing the free energy and friction profiles from all 400 simulations will cause rate estimates to deteriorate by a factor of \u223c3 and the dissociation constant by a factor of \u223c7 (see Tab. II). This comparatively small offset comes from the fact that the friction overestimation artifact in trypsin is particularly small around the sweet spot velocity of 1 m/s."
        },
        {
            "heading": "IV. CONCLUSIONS",
            "text": "When we employ dcTMD pulling simulations to calculate free energy profiles and reaction rates of slow processes, the practical implementation of the method rests on the cumulant approximation of Jarzynski\u2019s identity [Eq. (2)], which is valid given a normal distribution of the work done on the system. By exploiting the central limit theorem, this is found to be the case if the integrated noise \u222b\ndt \u03b7(t) associated with the process is Gaussian distributed, see Eq. (13). While this condition was shown to be valid, e.g., for simple and complex fluids,14 it typically breaks down when the system cannot be properly described by a single 1D pulling coordinate x, but requires another (in general multidimensional) coordinate y for an appropriate description. The problem was illustrated for a simple 2D model (Fig. 1), where the motion along y gives rise to a splitting of the 2D energy landscape into two 1D pathways. While the work distributions of the individual paths are well approximated by a Gaussian, their sum may exhibit a bimodal appearance, thus hampering the direct application of the cumulant approximation. We note that the pathway sampling problem is not specific to dcTMD, but generally occurs in enhanced sampling methods along a 1D biasing coordinate, see Fig. S2 for the case of thermodynamic integration.\nAs a main result of this paper, we have developed in Sec. II D the theoretical formulation underlying the separation of the total reaction flux in several pathways. In particular, we have established for each path k the relation between the nonequilibrium energy curves \u2206Gk(x) [Eq. (21)] and their weights pneqk obtained from dcTMD and their equilibrium counterparts, the free energy curves \u2206Gk(x) [Eq. (20)] and equilibrium weights p eq k [Eq. (22)]. Combined with the friction factors \u0393k(x) obtained from dcTMD, the free energy profiles \u2206Gk(x) can be used to run unbiased Langevin simulations separately for each\npath. This yields the reaction rates for all paths, which are then weighted by peqk and added to obtain the total rate [Eq. (27)], thus revealing the relative importance of the individual paths. The implementation and the performance of the path separation procedure has been demonstrated in detail for the 2D model in Fig. 1, where exact reference calculations of all quantities are available.\nAs an application to all-atom MD data, we have considered the (un)binding of the trypsin-benzamidine complex, which represents a well-established model to test enhanced sampling techniques.15\u201317,29\u201331 By using a recently proposed nonequilibrium PCA on contacts between the ligand and the protein,1 we have identified three binding and unbinding pathways, which are defined in terms of their free energy \u2206Gk(x), friction \u0393k(x) and weight peqk , and can be characterized via the protein residues encountered by the ligand along the path. In this way, we reproduced the experimentally measured millisecond reaction times within an error of \u223c 10 % for unbinding and within a factor of \u223c 6 for binding. Moreover, we have used this well-studied but nontrivial model problem to discuss various practical issues of the path separation scheme, such as the assessment of the Gaussianity of the work distribution (Fig. S4) and the treatment of trajectories that cross between various paths.\nIn future work, we want to extend the dcTMD path separation approach to the description of more involved processes. First studies on the unbinding of an inhibitor from the N-terminal domain of Hsp9013 and the ion diffusion through a membrane channel24 have indicated that the detection of independent paths with normal work distributions represents a challenging task. This includes the definition of suitable collective coordinates characterizing these paths using machine learning techniques52,66\u201369 as well as the definition of distance measures between various trajectories.70 In particular, we currently explore the potential of MosSAIC,71 a recently proposed correlation-based feature selection procedure to classify nonequilibrium trajectories into different paths."
        },
        {
            "heading": "Appendix A: Harmonic bath model",
            "text": "Zwanzig39 considered a system-bath Hamiltonian that can be written as72\nH = p2\n2m + U(x) +HB(x, q,p), (A1)\nHB = N\u2211 i=1\n[ p2i\n2mi +\n1 2 mi\u03c9 2 i\n( qi \u2212 \u03b3ig(x)\nmi\u03c92i\n)2] . (A2)\nHere the system is described by mass m, coordinate x, momentum p and potential energy U(x), the bath by masses mj , coordinates q = {qi}, momenta p = {pi}, and harmonic frequencies \u03c9i, and the system-bath coupling is characterized by constants \u03b3i and the function\n11\ng(x). Because the bath consists of driven harmonic oscillators with explicitly known solutions {qi(t), pi(t)}, the equation of motion for the system\nmx\u0308 = \u2212\u2202U \u2202x \u2212 \u2202HB \u2202x (A3)\ncan be expressed as a generalized Langevin equation of the form72\nmx\u0308 = \u2212\u2202U \u2202x \u2212 \u222b t\n0\nd\u03c4K(t, \u03c4)x\u0307(\u03c4) + \u03b7(t) , (A4)\nK(t, \u03c4) = \u2211 i \u03b32i mi\u03c92i g\u2032(t) cos(\u03c9i(t\u2212 \u03c4))g\u2032(\u03c4) , (A5)\n\u03b7(t) = g\u2032(t) \u2211 i ( \u03b3i\u03b4qi(0) cos(\u03c9it) + \u03b3i\u03c0i(0) mi\u03c9i sin(\u03c9it) ) ,\n(A6)\nwhere \u03b4qi(t) = qi(t) \u2212 \u03b3ig(x(t))mi\u03c92i , g \u2032 = \u2202g\u2202x , and the memory kernel K and the fluctuating force \u03b7 are related by a fluctuation-dissipation relation. Recognizing that the free energy is given by\nG(x) = \u2212\u03b2\u22121 ln [ 1\nZ\n\u222b dpdqdp e\u2212\u03b2H(x,p,q,p) ]\n= U(x) + const. , (A7)\nwe find that potential energy U(x) and free energy G(x) coincide up to a constant.\nWe now want to extend the model to the nonequilibrium regime encountered by dcTMD, which uses the constraint x(t) = x0 + vt. Considering the associated Lagrangean L = T \u2212 V of Hamiltonian H = T + V in Eq. (A2) (with T and V being the kinetic and potential energy), we can eliminate the system variable x due to the constraint. When we transform back to the Hamiltonian description, we obtain an explicitly time-dependent Hamiltonian of the bath degrees of freedom,\nH(t) = \u22121 2 mv2 + U(t) +HB(t) , (A8)\nwhere U(t) and HB(t) denote the potential and the bath energy evaluated at x = x(t), and the first term is an irrelevant constant. Describing driven harmonic motion, the resulting equations of motion of the bath oscillators are again readily solved to give\n\u03b4qi(t) = \u03b4q (0) i (t)\u2212\n\u03b3iv\nmi\u03c92i Ci(t) , (A9)\npi(t) = p (0) i (t) +\n\u03b3iv\n\u03c9i Si(t) , (A10)\nwhere \u03b4q (0) i (t) = \u03b4qi(0) cos\u03c9it+ \u03c0i(0) mi\u03c9i sin\u03c9it and p (0) i (t) = \u2212mi\u03c9i\u03b4qi(0) sin\u03c9it + \u03c0i(0) cos\u03c9it denote the free harmonic solutions, and Ci(t) = \u222b t\n0 d\u03c4g\u2032(\u03c4) cos(\u03c9i(t\u2212\u03c4)) and\nSi(t) = \u222b t 0 d\u03c4g\u2032(\u03c4) sin(\u03c9i(t\u2212 \u03c4)).\nAiming to calculate the work performed on the system due to the pulling along the constraint x(t) = x0 + vt, we need to evaluate the corresponding constraint force f . To this end, we add f to the system\u2019s equation of motion (A3), and solve the equation using x\u0308 = 0 resulting from the constraint. This yields\nf(t) = \u2202U\n\u2202x \u2223\u2223\u2223\u2223 x(t) \u2212 g\u2032(t) \u2211 i \u03b3i \u03b4qi(t) , (A11)\nfrom which the work W [Eq. (4)] evaluates as\nW (t) = \u2206U(x(t)) + v2 \u2211 i \u03b32i mi\u03c92i Ii(t)\n\u2212 v \u2211 i [ \u03b3i\u03b4qi(0)C\u0302i(t) + \u03b3i\u03c0i(0) mi\u03c9i S\u0302i(t) ] , (A12)\nwhere Ii(t) = 1 2 ( C\u03022i (t) + S\u0302 2 i (t) ) , C\u0302i(t) = Si(t) sin\u03c9it + Ci(t) cos\u03c9it, and S\u0302i(t) = Ci(t) sin\u03c9it \u2212 Si(t) cos\u03c9it. To obtain the distribution of the work, we construct the characteristic function\n\u03c8W (x)(\u03b1) = \u2329 ei\u03b1W (x) \u232a\n(A13)\n= exp { i\u03b1 [ \u2206U(x) + v2\n\u2211 i \u03b32i mi\u03c92i Ii(t)\n]\n\u2212\u03b1 2\n2\n[ 2v2\n\u03b2 \u2211 i \u03b32i mi\u03c92i Ii(t)\n]} , (A14)\nwhere \u3008. . .\u3009 denotes the Boltzmann average over the initial bath degrees of freedom. Equation (A14) represents the characteristic function of a Gaussian with two nonzero first cumulants. From the second cumulant, we obtain the mean dissipated energy\n\u3008Wdiss(t)\u3009 = v2 \u2211 i \u03b32i mi\u03c92i Ii(t) (A15)\n= \u2211 i\n\u2329 p2i (t) \u232a 2mi + 1 2 mi\u03c9 2 i \u2329 \u03b4q2i (t) \u232a \u2212N/\u03b2 ,\nwhich reflects the increase of the bath energy. Finally, we note that the nonequilibrium generalized Langevin equation (6) describing dcTMD is directly obtained from the system\u2019s equation of motion (A3) by adding the constraint force f . Using Eq. (A11), the constraint force autocorrelation is evaluated as\n\u03b2 \u3008\u03b4f(t1)\u03b4f(t2)\u3009 = \u2211 i \u03b32i mi\u03c92i g\u2032(t1) cos\u03c9i(t1\u2212t2) g\u2032(t2) ,\n(A16)\nwhich equals the expression for the memory kernel K in Eq. (A5), thus describing a dissipation-fluctuation relation. Hence, for the harmonic model, the memory kernel measured via a constrained simulation is of the same form as the kernel obtained from the free motion.\n12\nAuthor\u2019s contributions\nAll authors contributed equally to this work."
        },
        {
            "heading": "Acknowledgments",
            "text": "The authors thank Simon Bray, Miriam Ja\u0308ger, Moritz Scha\u0308ffler and Viktor Ta\u0308nzel for helpful comments and discussions. This work has been supported by the Deutsche Forschungsgemeinschaft (DFG) within the framework of the Research Unit FOR 5099 \u201dReducing complexity of nonequilibrium\u201d (project No. 431945604), the High Performance and Cloud Computing Group at the Zentrum fu\u0308r Datenverarbeitung of the University of Tu\u0308bingen, the state of Baden-Wu\u0308rttemberg through bwHPC and the DFG through grant no INST 37/935-1 FUGG (RV bw16I016), the Black Forest Grid Initiative, and the Freiburg Institute for Advanced Studies (FRIAS) of the Albert-Ludwigs-University Freiburg.\nData availability\nPython scripts for dcTMD data evaluation as well as the Jupyter notebook used for the 2D model calculations can be obtained at https://github.com/moldyn. Here also a tutorial for the usage of dcTMD with the trypsinbenzamidine complexes including simulation start structure, topologies and Gromacs command input files is available, as well as the fastpca program package for nonequilibrium PCA.\n1C. Chipot and A. Pohorille, Free Energy Calculations, Springer, Berlin, 2007. 2D. J. Wales, Energy Landscapes, Cambridge University Press, Cambridge, 2003. 3P. Faccioli, M. Sega, F. Pederiva, and H. Orland, Dominant pathways in protein folding, Phys. Rev. Lett. 97, 108101 (2006). 4C. Dellago and P. Bolhuis, Transition path sampling and other advanced simulation techniques for rare events, Adv. Polymer Sci. 221 (2016). 5D. M. Zuckerman and L. T. Chong, Weighted ensemble simulation: Review of methodology, applications, and software, Annu. Rev. Biophys. 46, 43 (2017). 6R. Capelli, P. Carloni, and M. Parrinello, Exhaustive Search of Ligand Binding Pathways via Volume-Based Metadynamics, J. Phys. Chem. Lett. , 3495 (2019). 7R. Capelli, A. Bochicchio, G. Piccini, R. Casasnovas, P. Carloni, and M. Parrinello, Chasing the Full Free Energy Landscape of Neuroreceptor/Ligand Unbinding by Metadynamics Simulations., J. Chem. Theory Comput. 15, 3354 (2019). 8J. Rydzewski and O. Valsson, Finding multiple reaction pathways of ligand unbinding, J. Chem. Phys. 150, 221101 (2019). 9M. Bianciotto, P. Gkeka, D. B. Kokh, R. C. Wade, and H. Minoux, Contact Map Fingerprints of Protein-Ligand Unbinding Trajectories Reveal Mechanisms Determining Residence Times Computed from Scaled Molecular Dynamics., J. Chem. Theory Comput. 17, 6522 (2021). 10A. Nunes-Alves, D. B. Kokh, and R. C. Wade, Ligand unbinding mechanisms and kinetics for T4 lysozyme mutants from \u03c4RAMD simulations, Curr. Res. Struct. Biol. 3, 106 (2021). 11J. He\u0301nin, T. Lelie\u0300vre, M. R. Shirts, O. Valsson, and L. Delemotte, Enhanced sampling methods for molecular dynamics simulations, LiveCoMS 4, 1583 (2022).\n12S. Wolf and G. Stock, Targeted molecular dynamics calculations of free energy profiles using a nonequilibrium friction correction, J. Chem. Theory Comput. 14, 6175 (2018). 13S. Wolf, B. Lickert, S. Bray, and G. Stock, Multisecond ligand dissociation dynamics from atomistic simulations, Nat. Commun. 11, 2918 (2020). 14M. Post, S. Wolf, and G. Stock, Molecular origin of drivingdependent friction in fluids, J. Chem. Theory Comput. 18, 2816 \u2013 2825 (2022). 15P. Tiwary, V. Limongelli, M. Salvalaglio, and M. Parrinello, Kinetics of protein\u2013ligand unbinding: Predicting pathways, rates, and rate-limiting steps, Proc. Natl. Acad. Sci. USA 112, E386 (2015). 16N. Plattner and F. Noe\u0301, Protein conformational plasticity and complex ligand-binding kinetics explored by atomistic simulations and Markov models, Nat. Commun. 6, 7653 (2015). 17I. Teo, C. G. Mayne, K. Schulten, and T. Lelievre, Adaptive Multilevel Splitting Method for Molecular Dynamics Calculation of Benzamidine-Trypsin Dissociation Time, J. Chem. Theory Comput. 12, 2983 (2016). 18C. Jarzynski, Nonequilibrium equality for free energy differences, Phys. Rev. Lett. 78, 2690 (1997). 19D. A. Hendrix and C. Jarzynski, A \u201cfast growth\u201d method of computing free energy differences, J. Chem. Phys. 114, 5974 (2001). 20C. Dellago and G. Hummer, Computing equilibrium free energies using non-equilibrium molecular dynamics, Entropy 16, 41 (2014). 21F. M. Ytreberg and D. M. Zuckerman, Efficient use of nonequilibrium measurement to estimate free energy differences for molecular systems, J. Comput. Chem. 25, 1749 (2004). 22I. Echeverria and L. M. Amzel, Estimation of Free-Energy Differences from Computed Work Distributions: An Application of Jarzynski\u2019s Equality, J. Phys. Chem. B 116, 10986 (2012). 23P. Billingsley, Probability and Measure, Wiley, 1995. 24M. Ja\u0308ger, T. Koslowski, and S. Wolf, Predicting Ion Channel Conductance via Dissipation-Corrected Targeted Molecular Dynamics and Langevin Equation Simulations, J. Chem. Theory Comput. 18, 494 (2022). 25S. Doudou, N. A. Burton, and R. H. Henchman, Standard Free Energy of Binding from a One-Dimensional Potential of Mean Force, J. Chem. Theory Comput. 5, 909 (2009). 26M. Post, S. Wolf, and G. Stock, Principal component analysis of nonequilibrium molecular dynamics simulations, J. Chem. Phys. 150, 204110 (2019). 27F. Guillain and D. Thusius, Use of proflavine as an indicator in temperature-jump studies of the binding of a competitive inhibitor to trypsin, J. Am. Chem. Soc. 92, 5534 (1970). 28M. Marquart, J. Walter, J. Deisenhofer, W. Bode, and R. Huber, The geometry of the reactive site and of the peptide groups in trypsin, trypsinogen and its complexes with inhibitors, Acta Crystallogr. B 39, 480 (1983). 29I. Buch, T. Giorgino, and G. De Fabritiis, Complete reconstruction of an enzyme-inhibitor binding process by molecular dynamics simulations, Proc. Natl. Acad. Sci. USA 108, 10184 (2011). 30L. W. Votapka, B. R. Jagger, A. Heyneman, and R. E. Amaro, SEEKR: simulation enabled estimation of kinetic rates, a computational tool to estimate molecular kinetics and its application to trypsin\u2013benzamidine binding, J. Phys. Chem. B 121, 3597 (2017). 31R. M. Betz and R. O. Dror, How Effectively Can Adaptive Sampling Methods Capture Spontaneous Ligand Binding?, J. Chem. Theory Comput. 15, 2053 (2019). 32J. Schlitter, M. Engels, and P. Kru\u0308ger, Targeted molecular dynamics - a new approach for searching pathways of conformational transitions, J. Mol. Graph. 12, 84 (1994). 33C. R. Harris et al., Array programming with NumPy, Nature 585, 357 (2020). 34P. Virtanen et al., SciPy 1.0: fundamental algorithms for scientific computing in Python, Nat. Methods 17, 261 (2020). 35W. McKinney, Data structures for statistical computing in python., in Proceedings of the 9th Python in Science Confer-\n13\nence., edited by S. van der Walt and J. Millman, pages 51\u201356, 2010. 36J. D. Hunter, Matplotlib: A 2D graphics environment, Comput. Sci. Eng. 9, 90 (2007). 37J. Racine, gnuplot 4.0: a portable interactive plotting utility, J. Appl. Econ. 21, 133 (2006). 38T. Kluyver et al., Jupyter Notebooks-a publishing format for reproducible computational workflows., in Positioning and Power in Academic Publishing, edited by F. Loizides and B. Schmidt, pages 87\u201390, IOP Press, 2016. 39R. Zwanzig, Nonlinear generalized Langevin equations, J. Stat. Phys. 9, 215 (1973). 40M. R. S\u00f8rensen and A. F. Voter, Temperature-accelerated dynamics for simulation of infrequent events, J. Chem. Phys. 112, 9599 (2000). 41A. R. Henderson, Testing experimental data for univariate normality., Clin. Chim. Acta 366, 112 (2006). 42S. R. Logan and D. Wilmer, Fundamentals of chemical kinetics, volume 10, Longman London, 1996. 43F. Noe\u0301 and C. Clementi, Collective variables for the study of longtime kinetics from molecular trajectories: theory and methods, Curr. Opin. Struct. Biol. 43, 141 (2017). 44F. Sittel and G. Stock, Perspective: Identification of collective coordinates and metastable states of protein dynamics, J. Chem. Phys. 149, 150901 (2018). 45M. Ernst, F. Sittel, and G. Stock, Contact- and distance-based principal component analysis of protein dynamics, J. Chem. Phys. 143, 244114 (2015). 46A. Amadei, A. B. M. Linssen, and H. J. C. Berendsen, Essential dynamics of proteins, Proteins 17, 412 (1993). 47A. Altis, M. Otten, P. H. Nguyen, R. Hegger, and G. Stock, Construction of the free energy landscape of biomolecules via dihedral angle principal component analysis, J. Chem. Phys. 128, 245102 (2008). 48G. Hummer, A. E. Garcia, and S. Garde, Helix nucleation kinetics from molecular simulations in explicit water, Proteins 42, 77 (2001). 49M. A. Rohrdanz, W. Zheng, and C. Clementi, Discovering mountain passes via torchlight: Methods for the definition of reaction coordinates and pathways in complex macromolecular reactions, Annu. Rev. Phys. Chem. 64, 295 (2013). 50A. Glielmo, B. E. Husic, A. Rodriguez, C. Clementi, F. Noe\u0301, and A. Laio, Unsupervised learning methods for molecular simulation data, Chem. Rev. 121, 9722 (2021). 51M. Amaral, D. B. Kokh, J. Bomke, A. Wegener, H. P. Buchstaller, H. M. Eggenweiler, P. Matias, C. Sirrenberg, R. C. Wade, and M. Frech, Protein conformational flexibility modulates kinetics and thermodynamics of drug binding., Nat. Commun. 8, 2276 (2017). 52S. Bray, V. Ta\u0308nzel, and S. Wolf, Ligand Unbinding Pathway and Mechanism Analysis Assisted by Machine Learning and Graph Methods, J. Chem. Inf. Model. 62, 4591 (2022). 53J. Servantie and P. Gaspard, Methods of calculation of a friction coefficient: application to nanotubes, Phys. Rev. Lett. 91, 185503 (2003). 54As practical guideline, we recommend to first perform a set of \u223c100 simulations for a pulling velocity of v = 1 m/s and check if a path separation with contact distances is possible. If this does not lead to a successful removal of the friction overestimation artifact (see Fig. 1c), a similar study should be done for v = 0.1 m/s. If the simulations then become dominated by crossing trajectories (see Ref.13, Fig. S4c), the system may be not suited for a dcTMD analysis. We note that in all our investigations carried out so far,12\u201314,24,52 the systems were treatable with dcTMD, but the major challenge was finding a suitable orthogonal coordinate y. 55M. J. Abraham, T. Murtola, R. Schulz, S. Pall, J. C. Smith, B. Hess, and E. Lindahl, Gromacs: High performance molecular simulations through multi-level parallelism from laptops to supercomputers, SoftwareX 1, 19 (2015).\n56V. Hornak, R. Abel, A. Okur, B. Strockbine, A. Roitberg, and C. Simmerling, Comparison of multiple Amber force fields and development of improved protein backbone parameters, Proteins 65, 712 (2006). 57R. B. Best and G. Hummer, Optimized molecular dynamics force fields applied to the helix-coil transition of polypeptides, J. Phys. Chem. B 113, 9004 (2009). 58J. Wang and R. Bru\u0308schweiler, 2D entropy of discrete molecular ensembles, J. Chem. Theory Comput. 2, 18 (2006). 59J. M. Wang, R. M. Wolf, J. W. Caldwell, P. A. Kollman, and D. A. Case, Development and testing of a general amber force field, J. Comput. Chem. 25, 1157 (2004). 60F. Neese, The ORCA program system, WIREs Comput. Mol. Sci. 2, 73 (2012). 61T. Lu and F. Chen, Multiwfn: A multifunctional wavefunction analyzer, J. Comput. Chem. 33, 580 (2012). 62W. L. Jorgensen, J. Chandrasekhar, J. D. Madura, R. W. Impey, and M. Klein, Comparison of simple potential functions for simulating liquid water, J. Chem. Phys. 79, 926 (1983). 63F. Sittel, T. Filk, and G. Stock, Principal component analysis on a torus: Theory and application to protein dynamics, J. Chem. Phys. 147, 244101 (2017). 64H. Wu, F. Paul, C. Wehmeyer, and F. Noe\u0301, Multiensemble Markov models of molecular thermodynamics and kinetics, Proc. Natl. Acad. Sci. USA 113, E3221 (2016). 65H. Fu, Y. Zhou, X. Jing, X. Shao, and W. Cai, Meta-Analysis Reveals That Absolute Binding Free-Energy Calculations Approach Chemical Accuracy, J. Med. Chem. 65, 12970 (2022). 66J. M. L. Ribeiro, P. Bravo, Y. Wang, and P. Tiwary, Reweighted autoencoded variational bayes for enhanced sampling (rave), J. Chem. Phys. 149, 072301 (2018). 67J. M. L. Ribeiro, D. Provasi, and M. Filizola, A combination of machine learning and infrequent metadynamics to efficiently predict kinetic rates, transition states, and molecular determinants of drug dissociation from G protein-coupled receptors, J. Chem. Phys. 153, 124105 (2020). 68M. Bertazzo, D. Gobbo, S. Decherchi, and A. Cavalli, Machine Learning and Enhanced Sampling Simulations for Computing the Potential of Mean Force and Standard Binding Free Energy., J. Chem. Theory Comput. 17, 5287 (2021). 69M. Badaoui et al., Combined Free-Energy Calculation and Machine Learning Methods for Understanding Ligand Unbinding Kinetics., J. Chem. Theory Comput. 18, 2543 (2022). 70G. Yuan, P. Sun, J. Zhao, and D. Li, A review of moving object trajectory clustering algorithms, Artif. Intel.l Rev. 47, 123 \u2013 144 (2017). 71G. Diez, D. Nagel, and G. Stock, Correlation-based feature selection to identify functional dynamics in proteins, J. Chem. Theory Comput. 18, 5079 \u2013 5088 (2022). 72G. R. Haynes, G. A. Voth, and E. Pollak, A theory for the activated barrier crossing rate constant in systems influenced by space and time dependent friction, J. Chem. Phys. 101, 7811 (1994).\nS1\nSUPPLEMENTARY MATERIAL"
        },
        {
            "heading": "Appendix S1: 2D ligand-protein dissociation model",
            "text": "We constructed a 2D potential energy function\n\u03b2V (r1, r2) = 140.3\u00d7N(r1, 0, 0.5)N(r2, 0, 0.5) \u2212 31.3\u00d7N(r1, 0, 0.25)N(r2, 0, 0.25) \u2212 11.0\u00d7N(r1, 0.5, 0.3)N(r2, 0, 0.15) \u2212 9.8\u00d7N(r1, 0, 0.15)N(r2, 0.5, 0.25) , with (S11)\nN(r, \u00b5, \u03c3) = 1\u221a\n2\u03c0\u03c32 exp\n{ \u2212 (r \u2212 \u00b5) 2\n2\u03c32\n} ,\nfor r21 + r 2 2 < 1.75 2 (lengths are in units of nm), and V (r1, r2) = +\u221e elsewise, see Fig. 1a of the main text. This potential represents a 2D \u201dflatland\u201d globular protein in implicit solvent with a central binding cavity and two unbinding pathways 1 (\u03b8 \u223c 180\u25e6) and 2 (\u03b8 \u223c 270\u25e6), see Fig. S1a."
        },
        {
            "heading": "1. MC/LE simulations",
            "text": "For constraint simulations with anisotropic friction profiles \u0393 , we used a combined Monte Carlo/Langevin equation approach instead of a direct integration of the Langevin equation, as it is more robust, does not require to define a suitable system mass or range of \u0393 to perform a stable numerical integration of a Langevin equation, and allows to tune \u0393 for demonstration purposes in such a way that P (W ) becomes clearly multimodal. Introducing polar (r, \u03b8) coordinates, the potential V (r, \u03b8) as shown in Fig. S1a. We also display the position-dependent friction profile (Fig. S1b), with \u0393 = 0.05 kBT \u2206t nm\n\u22122 for r \u2208 [0.1, 1.0] nm along path 1, \u0393 = 0.15 kBT \u2206t nm\u22122 for path 2 and elsewhere between 0.1 nm and 1.0 nm, and \u0393 = 0.01 kBT \u2206t nm\n\u22122 for r /\u2208 [0.1, 1.0] nm, i.e., at all other positions. The motion along r = r0 +vt is defined via the constant velocity v. For motions in \u03b8, we used a step size of \u2206\u03b8 = 100\n\u25e6R/r with a random number R drawn from a normal distribution with \u00b5 = 0 and \u03c3 = 1, and a Jacobian term of 1/r to compare MC calculations in (r1, r2) and in (r, \u03b8). From the position along (r, \u03b8), force profiles f were constructed according to\nf(r, \u03b8) = \u2212 ( \u2202V\n\u2202r ) \u03b8 \u2212 v\u0393 (r, \u03b8) + \u221a 2\u0393 (r, \u03b8)kBT R. (S12)\nSampling along \u03b8 was carried out via MC simulations using the Metropolis acceptance criterion. 5000 constraint simulations were initialized at randomized positions along \u03b8 and r = 0.01 nm. Pulling was carried out with a velocity v = 2.5 \u00b7 10\u22124 nm / MC step for constraint pulling, and v = 0 for thermodynamic integration (TI) calculations. Trajectory work profiles W from constraint pulling were calculated from W = \u222b dr f(r). For TI calculations, mean\nforces \u3008f(ri)\u3009\u03b8 at position ri were calculated as \u3008f(ri)\u3009\u03b8 = \u222b\nd\u03b8 f(ri, \u03b8)P (\u03b8|ri), and free energies estimated as \u2206GTI \u2248\u2211 i \u3008f(ri)\u3009\u03b8 \u2206r.\nS2\nFIG. S1. 2D model of ligand-protein dissociation. (a) Potential energy landscape V (r, \u03b8) including borders for path discrimination at r \u2208 [0.44, 0.875] nm. (b) Friction field \u0393 (r, \u03b8). (c) Representative examples of crossing trajectories, exhibiting jumps at the beginning of the path separation domain. (d) Sampling of the density obtained from 5000 trajectories for the full system, and for (e) path 1 and (f) path 2. (g) Friction estimate \u0393 from targeted MD simulations, smoothed by a window average filter with 0.0125 nm width. Before path separation, \u0393 is estimated as a mean of the two true path friction coefficients. After path separation, estimates of \u0393 fluctuate around the correct value.\nS3\n0 0.5 1.0 1.5\n0\n5\n10\n15\nG /\nk B T\npart. funct. ideal TI TI path 1 TI path 2\nr / nm\nFIG. S2. Thermodynamic integration study of the 2D model of ligand-protein dissociation. (Left) Free energy profiles obtained for various TI protocols: In \u201cideal TI\u201d, we sampled over all angles for each r. Apart from numerical issues, this result should therefore agree with the exact result obtained from the partition function. Moreover, two Monte Carlo TI calculations are shown, which were started at path 1 and 2, respectively. Since TI is in principle exact, these curve should also coincide with the exact result. However, both calculations fail, due to jumps between the two path. (Right) 2D representation of the energy landscape of the model, reflecting the jumps of the Monte Carlo TI calculations starting at path 1 (\u223c 180\u25e6) and 2 (\u223c 270\u25e6). Note that for each value of r, the Monte Carlo moves can only go vertically."
        },
        {
            "heading": "2. Rate estimation",
            "text": "To compare the kinetics of the 2D model defined by the potential V (r1, r2) [Eq. (S11)], and the path-separated 1D models using the respective pathway free energies \u2206Gk(r), we performed standard Langevin simulations governed by\n2D: mr\u0308 = \u2212\u2202V \u2202r \u2212 \u0393 r\u0307 + \u03b7 , (S13)\npath 1: mr\u0308 = \u2212\u2202G1 \u2202r \u2212 \u0393r + \u03b7 , path 2: mr\u0308 = \u2212\u2202G2 \u2202r \u2212 \u0393r + \u03b7 , (S14)\nwhere \u03b7 = \u221a\n2kBT \u0393R. We used a mass m = 0.8 kg/mol, constant friction \u0393k = 20 kg/(mol ps) and temperature T = 300 K.\nIn the 2D case, we used a simple Euler integration scheme to propagate 10\u00d7 1\u00b5s-long trajectories, where 42 start in the associated and 8 in the dissociated state, employing an integration time-step of 1 fs. We saved the positions (r1, r2) for every ns. At r = 1.75 nm, we introduced a reflective wall by a flip of the position and velocity components perpendicular to the wall. We calculated the waiting times of the associated and dissociated state, by tracking the number of frames in a state until leaving, using geometrical cores at r = 0.2 nm and 1.4 nm, respectively. The rates koff and kon are then estimated by the inverse of the average waiting time, for each trajectory individually. We report their average and standard deviation in Table I of the main text.\nWe also performed biased simulations of the 2D system by constraining the distance to the center as r = r0 + vt, where we use r0 = 0.01 nm and v = 0.01 m/s. In particular, we integrate the constrained Langevin dynamics by transforming the equations of motion to polar coordinates, calculating the forces acting on r and \u03b8 as usual, but then updating r to conform to its constraint and recording the forces on r as the constraint force. We finally compute the work by integrating these forces. Sampling from an initial unbiased distribution in \u03b8 and \u03b8\u0307 at fixed r0, we pull 10000 trajectories towards r = 1.75 nm. By separating the trajectories using pathway 1 and 2, respectively, we use Jarzynski\u2019s equality to calculate the pathway free energy.\nUsing these estimates of the pathway free energy, we performed one-dimensional Langevin simulations using the mass and friction given above. We simulated 10 \u00d7 1 ms long simulations for both pathway 1 (45 starting in the associated, 5 in the dissociated state) and pathway 2 (40, 10), again with \u03b4t = 1 fs and a reflective wall at 1.75 nm. We computed the rates and weigh them by the probabilities obtained by Eq. (26) of the main text, reported in Table I of the main text.\nS4\nr 2 /\nn m\n\u22121.5\n\u22121\n\u22120.5\n0\n0.5\n1\n1.5\n\u22121.5\u22121\u22120.5 0 0.5 1 1.5\n\u03b2\u2206G\nr1 / nm \u22121.5\u22121\u22120.5 0 0.5 1 1.5\n\u03b2\u2206GV\n\u03b8 /\nra d\n\u2212\u03c0\n\u2212\u03c02\n\u03c0 2\n\u03c0\n0\n0 0.5 1 1.5 r / nm\n0 0.5 1 1.5 0 5 10 15 20 25 30 35 40 \u03b2\u2206 G\na b\nd\ne f c r 2 / n m\nr1 / nm\n\u22121\n0\n1\n\u22121 0 1\n\u03b8 /\nra d\nr / nm\n\u2212\u03c0\n\u2212\u03c02\n\u03c0 2\n\u03c0\n0\n0 0.5 1 1.5 0\n5\n10\n15\n20\n25\n30\n35\n40\n\u03b2\u2206 G\nFIG. S3. Sampling of the 2D potential energy landscape in nonequilibrium pulling. (a) Distribution in (r1, r2) of all pulled trajectories as a biased density V, estimated by a histogram. (b) Corresponding reweighed potential V using Eq. (11) of Ref. 1. (c) Same data but projected onto (r, \u03b8) coordinates. (d) Corresponding reweighed density. (e) Biased trajectories separated by pathways superimposed on unbiased potential in the (r1, r2) plane, visualized by isolines of same biased density. (f) Same data but in (r, \u03b8).\nS5"
        },
        {
            "heading": "Appendix S2: Normality test of the work distribution P (W )",
            "text": "In addition to estimating the probability distribution P (W ) via a histogram of the sampled work W at a specific value of coordinate x, we can evaluate the normal probability plot of that sample. To this end, we employ the scipy. stats function probplot, which compares the points of the computed work to the quantiles of the corresponding normal distribution (the probit), such that the deviations reveal a non-Gaussian shape. In particular, we sort the work sample in increasing order and plot them against equidistant points of the inverse of the cumulative distribution function. Deviations from a straight line reveal an underlying non-Gaussian distribution.\nP (\u03b2 W\n)\n\u03b2W\n0\n0.01\n0.02\n0.03\n0.04\n0 10 20 30 40 50 60 70\na\n\u22123 \u22122 \u22121 0\n1\n2\n3\n\u22123 \u22122 \u22121 0 1 2 3\nsc al ed\nw or k d at a\nN(0, 1)\nall path 1 path 2\nb\n0\n0.01\n0.02\n0.03 toptopt\nP (W\n) [m\nol /k\nJ ]\n0\n0.01\n0.02\n0.03 middlei lei lddi lei l\n0\n0.01\n0.02\n0.03 bottomtto ob tt\nW [kJ/mol]\n0\n0.01\n0.02\n0.03\n0 20 40 60 80 100 120 140\nallllalllll\n\u22122 \u22121 0 1 2\nsc al ed\nw o rk\nd at a \u22122 \u22121 0 1 2\n\u22122 \u22121 0 1 2\nstandard normal\n\u22122 \u22121 0 1 2\n\u22122\u22121 0 1 2\nFIG. S4. Normality test of P (W ) obtained for (top panels) the 2D model and (bottom panels) for trypsin. (a) P (W ) for complete and path-separated trajectory sets. (b) Normality tests for these sets. The complete trajectory set displays clear deviations in the tails from the ideal diagonal, while the path-separated sets display better agreement. (Bottom panels) Results for trypsin, showing (left) P (W ) for complete and path-separated trajectory sets and (right) normality tests for these sets. Both the path-separated the complete trajectory sets display rather good agreement with a normal distribution.\nS6"
        },
        {
            "heading": "Appendix S3: Trypsin-benzamidine complex: PCA on ligand-protein contacts",
            "text": "0.00 0.25 0.50 0.75 1.00 1.25 1.50 1.75 2.00 x / nm\n5\n0\n5\n10\n15\n20\nPC 1\n/ n m\n5\n4\n3\n2\n1\n0\n/ k B\nT\n0 2 4 6 8 10 eigenvector No.\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nre l.\ncu m\n. E Vs\nPC 1\nPC 2\nFIG. S5. Results from a contact PCA, obtained for the trypsin-benzamidine complex. (Top left) Correlation between pulling distance x and 1st principal component. (Top right) Cumulative fluctuations obtained from the principal components. The first two components already explain 78% of the variance of the data. (Bottom) Eigenvector contributions from single contacts. Residues defining pathways displayed in Fig. 2 of the main text are indicated by accordingly colored arrows.\nS7\nSUPPORTING REFERENCES\n1M. Post, S. Wolf, and G. Stock, Principal component analysis of nonequilibrium molecular dynamics simulations, J. Chem. Phys. 150, 204110 (2019)."
        }
    ],
    "title": "Path separation of dissipation-corrected targeted molecular dynamics simulations of protein-ligand unbinding",
    "year": 2023
}