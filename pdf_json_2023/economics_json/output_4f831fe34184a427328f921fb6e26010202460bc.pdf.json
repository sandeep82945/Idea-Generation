{
    "abstractText": "Treatment effect estimation can assist in effective decisionmaking in e-commerce, medicine, and education. One popular application of this estimation lies in the prediction of the impact of a treatment (e.g., a promotion) on an outcome (e.g., sales) of a particular unit (e.g., an item), known as the individual treatment effect (ITE). In many online applications, the outcome of a unit can be affected by the treatments of other units, as units are often associated, which is referred to as interference. For example, on an online shopping website, sales of an item will be influenced by an advertisement of its co-purchased item. Prior studies have attempted to model interference to estimate the ITE accurately, but they often assume a homogeneous interference, i.e., relationships between units only have a single view. However, in real-world applications, interference may be heterogeneous, with multi-view relationships. For instance, the sale of an item is usually affected by the treatment of its copurchased and co-viewed items. We hypothesize that ITE estimation will be inaccurate if this heterogeneous interference is not properly modeled. Therefore, we propose a novel approach to model heterogeneous interference by developing a new architecture to aggregate information from diverse neighbors. Our proposed method contains graph neural networks that aggregate same-view information, a mechanism that aggregates information from different views, and attention mechanisms. In our experiments on multiple datasets with heterogeneous interference, the proposed method significantly outperforms existing methods for ITE estimation, confirming the importance of modeling heterogeneous interference.",
    "authors": [
        {
            "affiliations": [],
            "name": "Xiaofeng Lin"
        },
        {
            "affiliations": [],
            "name": "Guoxi Zhang"
        },
        {
            "affiliations": [],
            "name": "Xiaotian Lu"
        },
        {
            "affiliations": [],
            "name": "Han Bao"
        },
        {
            "affiliations": [],
            "name": "Koh Takeuchi"
        },
        {
            "affiliations": [],
            "name": "Hisashi Kashima"
        }
    ],
    "id": "SP:37c1e9424cd67492f95c059e136be45700420bf1",
    "references": [
        {
            "authors": [
                "P.M. Aronow",
                "C. Samii"
            ],
            "title": "Estimating average causal effects under general interference, with application to a social network experiment",
            "venue": "The Annals of Applied Statistics 11, 1912\u20131947",
            "year": 2017
        },
        {
            "authors": [
                "Z. Chu",
                "S.L. Rathbun",
                "S. Li"
            ],
            "title": "Graph infomax adversarial learning for treatment effect estimation with networked observational data",
            "venue": "Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery and Data Mining. pp. 176\u2013184",
            "year": 2021
        },
        {
            "authors": [
                "L. Forastiere",
                "E.M. Airoldi",
                "F. Mealli"
            ],
            "title": "Identification and estimation of treatment and interference effects in observational studies on networks",
            "venue": "Journal of the American Statistical Association 116(534), 901\u2013918",
            "year": 2021
        },
        {
            "authors": [
                "X. Fu",
                "J. Zhang",
                "Z. Meng",
                "I. King"
            ],
            "title": "Magnn: Metapath aggregated graph neural network for heterogeneous graph embedding",
            "venue": "Proceedings of the Web Conference 2020. pp. 2331\u20132341",
            "year": 2020
        },
        {
            "authors": [
                "T. Gao",
                "X. Yao",
                "D. Chen"
            ],
            "title": "SimCSE: Simple contrastive learning of sentence embeddings",
            "venue": "Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing",
            "year": 2021
        },
        {
            "authors": [
                "A. Gretton",
                "O. Bousquet",
                "A. Smola",
                "B. Sch\u00f6lkopf"
            ],
            "title": "Measuring statistical dependence with hilbert-schmidt norms",
            "venue": "Proceedings of the 16th International Conference on Algorithmic Learning Theory. pp. 63\u201377",
            "year": 2005
        },
        {
            "authors": [
                "R. Guo",
                "J. Li",
                "H. Liu"
            ],
            "title": "Learning individual causal effects from networked observational data",
            "venue": "Proceedings of the 13th International Conference on Web Search and Data Mining. pp. 232\u2013240",
            "year": 2020
        },
        {
            "authors": [
                "R. He",
                "J. McAuley"
            ],
            "title": "Ups and downs: Modeling the visual evolution of fashion trends with one-class collaborative filtering",
            "venue": "Proceedings of the 2016 World Wide Web Conference. pp. 507\u2013517",
            "year": 2016
        },
        {
            "authors": [
                "M.G. Hudgens",
                "M.E. Halloran"
            ],
            "title": "Toward causal inference with interference",
            "venue": "Journal of the American Statistical Association 103(482), 832\u2013842",
            "year": 2008
        },
        {
            "authors": [
                "D. Jin",
                "C. Huo",
                "C. Liang",
                "L. Yang"
            ],
            "title": "Heterogeneous graph neural network via attribute completion",
            "venue": "Proceedings of the Web Conference 2021. pp. 391\u2013400",
            "year": 2021
        },
        {
            "authors": [
                "F. Johansson",
                "U. Shalit",
                "D. Sontag"
            ],
            "title": "Learning representations for counterfactual inference",
            "venue": "Proceedings of the 33rd International Conference on Machine Learning. vol. 48, pp. 3020\u20133029",
            "year": 2016
        },
        {
            "authors": [
                "T.N. Kipf",
                "M. Welling"
            ],
            "title": "Semi-supervised classification with graph convolutional networks",
            "venue": "International Conference on Learning Representations",
            "year": 2017
        },
        {
            "authors": [
                "Q. Li",
                "Z. Wang",
                "S. Liu",
                "G. Li",
                "G. Xu"
            ],
            "title": "Deep treatment-adaptive network for causal inference",
            "venue": "The International Journal on Very Large Data Bases pp. 1\u201316",
            "year": 2022
        },
        {
            "authors": [
                "X. Liang",
                "Y. Ma",
                "G. Cheng",
                "C. Fan",
                "Y. Yang",
                "Z. Liu"
            ],
            "title": "Meta-path-based heterogeneous graph neural networks in academic network",
            "venue": "International Journal of Machine Learning and Cybernetics 13(6), 1553\u20131569",
            "year": 2022
        },
        {
            "authors": [
                "L. Liu",
                "M.G. Hudgens"
            ],
            "title": "Large sample randomization inference of causal effects in the presence of interference",
            "venue": "Journal of the American Statistical Association 109(505), 288\u2013301",
            "year": 2014
        },
        {
            "authors": [
                "J. Ma",
                "M. Wan",
                "L. Yang",
                "J. Li",
                "B. Hecht",
                "J. Teevan"
            ],
            "title": "Learning causal effects on hypergraphs",
            "venue": "Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining. pp. 1202\u20131212",
            "year": 2022
        },
        {
            "authors": [
                "Y. Ma",
                "V. Tresp"
            ],
            "title": "Causal inference under networked interference and intervention policy enhancement",
            "venue": "Proceedings of the 24th International Conference on Artificial Intelligence and Statistics. vol. 130, pp. 3700\u20133708",
            "year": 2021
        },
        {
            "authors": [
                "R. Nabi",
                "J. Pfeiffer",
                "D. Charles",
                "E. K\u0131c\u0131man"
            ],
            "title": "Causal inference in the presence of interference in sponsored search advertising",
            "venue": "Frontiers in Big Data 5",
            "year": 2022
        },
        {
            "authors": [
                "M. Qu",
                "J. Tang",
                "J. Shang",
                "X. Ren",
                "M. Zhang",
                "J. Han"
            ],
            "title": "An attention-based collaboration framework for multi-view network representation learning",
            "venue": "Proceedings of the 2017 ACM on Conference on Information and Knowledge Management. pp. 1767\u20131776",
            "year": 2017
        },
        {
            "authors": [
                "Z. Qu",
                "R. Xiong",
                "J. Liu",
                "G. Imbens"
            ],
            "title": "Efficient treatment effect estimation in observational studies under heterogeneous partial interference",
            "venue": "arXiv preprint arXiv:2107.12420",
            "year": 2021
        },
        {
            "authors": [
                "V. Rakesh",
                "R. Guo",
                "R. Moraffah",
                "N. Agarwal",
                "H. Liu"
            ],
            "title": "Linked causal variational autoencoder for inferring paired spillover effects",
            "venue": "Proceedings of the 27th ACM International Conference on Information and Knowledge Management. pp. 1679\u2013 1682",
            "year": 2018
        },
        {
            "authors": [
                "S.W. Raudenbush",
                "D. Schwartz"
            ],
            "title": "Randomized experiments in education, with implications for multilevel causal inference",
            "venue": "Annual Review of Statistics and Its Application 7(1)",
            "year": 2020
        },
        {
            "authors": [
                "P.R. Rosenbaum",
                "D.B. Rubin"
            ],
            "title": "The central role of the propensity score in observational studies for causal effects",
            "venue": "Biometrika 70(1), 41\u201355",
            "year": 1983
        },
        {
            "authors": [
                "D.B. Rubin"
            ],
            "title": "Randomization analysis of experimental data: The fisher randomization test comment",
            "venue": "Journal of the American statistical association 75(371), 591\u2013593",
            "year": 1980
        },
        {
            "authors": [
                "M.E. Schnitzer"
            ],
            "title": "Estimands and estimation of COVID-19 vaccine effectiveness under the test-negative design: Connections to causal inference",
            "venue": "Epidemiology 33(3), 325",
            "year": 2022
        },
        {
            "authors": [
                "U. Shalit",
                "F.D. Johansson",
                "D. Sontag"
            ],
            "title": "Estimating individual treatment effect: generalization bounds and algorithms",
            "venue": "Proceedings of the 34th International Conference on Machine Learning. vol. 70, pp. 3076\u20133085",
            "year": 2017
        },
        {
            "authors": [
                "C. Shi",
                "J. Ding",
                "X. Cao",
                "L. Hu",
                "B. Wu",
                "X. Li"
            ],
            "title": "Entity set expansion in knowledge graph: a heterogeneous information network perspective",
            "venue": "Frontiers of Computer Science 15(1), 1\u201312",
            "year": 2021
        },
        {
            "authors": [
                "Y. Song",
                "X. Yang",
                "C. Xu"
            ],
            "title": "Self-supervised calorie-aware heterogeneous graph networks for food recommendation",
            "venue": "ACM Transactions on Multimedia Computing, Communications, and Applications",
            "year": 2022
        },
        {
            "authors": [
                "W. Sun",
                "P. Wang",
                "D. Yin",
                "J. Yang",
                "Y. Chang"
            ],
            "title": "Causal inference via sparse additive models with application to online advertising",
            "venue": "Proceedings of the 29th AAAI Conference on Artificial Intelligence. p. 297\u2013303",
            "year": 2015
        },
        {
            "authors": [
                "L. Tang",
                "X. Wang",
                "H. Liu"
            ],
            "title": "Uncovering groups via heterogeneous interaction analysis",
            "venue": "Proceedings of IEEE International Conference on Data Mining. pp. 503\u2013 512",
            "year": 2009
        },
        {
            "authors": [
                "L. Tang",
                "X. Wang",
                "H. Liu"
            ],
            "title": "Uncoverning groups via heterogeneous interaction analysis",
            "venue": "2009 Ninth IEEE International Conference on Data Mining. pp. 503\u2013 512. IEEE",
            "year": 2009
        },
        {
            "authors": [
                "E.J.T. Tchetgen",
                "T.J. VanderWeele"
            ],
            "title": "On causal inference in the presence of interference",
            "venue": "Statistical Methods in Medical Research 21(1), 55\u201375",
            "year": 2012
        },
        {
            "authors": [
                "E.J. Tchetgen Tchetgen",
                "I.R. Fulcher",
                "I. Shpitser"
            ],
            "title": "Auto-g-computation of causal effects on a network",
            "venue": "Journal of the American Statistical Association 116(534), 833\u2013844",
            "year": 2021
        },
        {
            "authors": [
                "A. Vaswani",
                "N. Shazeer",
                "N. Parmar",
                "J. Uszkoreit",
                "L. Jones",
                "A.N. Gomez",
                "\u0141. Kaiser",
                "I. Polosukhin"
            ],
            "title": "Attention is all you need",
            "venue": "Advances in Neural Information Processing Systems 30",
            "year": 2017
        },
        {
            "authors": [
                "P. Veli\u010dkovi\u0107",
                "G. Cucurull",
                "A. Casanova",
                "A. Romero",
                "P. Li\u00f2",
                "Y. Bengio"
            ],
            "title": "Graph attention networks",
            "venue": "Proceedings of the 6th International Conference on Learning Representations",
            "year": 2018
        },
        {
            "authors": [
                "D. Viviano"
            ],
            "title": "Policy targeting under network interference",
            "venue": "arXiv preprint arXiv:1906.10258",
            "year": 2019
        },
        {
            "authors": [
                "P. Wang",
                "W. Sun",
                "D. Yin",
                "J. Yang",
                "Y. Chang"
            ],
            "title": "Robust tree-based causal inference for complex ad effectiveness analysis",
            "venue": "Proceedings of the 8th ACM International Conference on Web Search and Data Mining. pp. 67\u201376",
            "year": 2015
        },
        {
            "authors": [
                "X. Wang",
                "D. Bo",
                "C. Shi",
                "S. Fan",
                "Y. Ye",
                "S.Y. Philip"
            ],
            "title": "A survey on heterogeneous graph embedding: methods, techniques, applications and sources",
            "venue": "IEEE Transactions on Big Data",
            "year": 2022
        },
        {
            "authors": [
                "X. Wang",
                "H. Ji",
                "C. Shi",
                "B. Wang",
                "Y. Ye",
                "P. Cui",
                "P.S. Yu"
            ],
            "title": "Heterogeneous graph attention network",
            "venue": "Proceedings of the 2019 World Wide Web Conference. pp. 2022\u20132032",
            "year": 2019
        },
        {
            "authors": [
                "X. Wang",
                "L. Tang",
                "H. Liu",
                "L. Wang"
            ],
            "title": "Learning with multi-resolution overlapping communities",
            "venue": "Knowledge and information systems 36, 517\u2013535",
            "year": 2013
        },
        {
            "authors": [
                "M. Welling",
                "T.N. Kipf"
            ],
            "title": "Semi-supervised classification with graph convolutional networks",
            "venue": "Proceedings of the 4th International Conference on Learning Representations",
            "year": 2016
        },
        {
            "authors": [
                "L. Yao",
                "Z. Chu",
                "S. Li",
                "Y. Li",
                "J. Gao",
                "A. Zhang"
            ],
            "title": "A survey on causal inference",
            "venue": "ACM Transactions on Knowledge Discovery from Data 15(5), 1\u201346",
            "year": 2021
        },
        {
            "authors": [
                "L. Yao",
                "S. Li",
                "Y. Li",
                "M. Huai",
                "J. Gao",
                "A. Zhang"
            ],
            "title": "Representation learning for treatment effect estimation from observational data",
            "venue": "Advances in Neural Information Processing Systems. vol. 31",
            "year": 2018
        },
        {
            "authors": [
                "C. Zhang",
                "D. Song",
                "C. Huang",
                "A. Swami",
                "N.V. Chawla"
            ],
            "title": "Heterogeneous graph neural network",
            "venue": "Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery & data mining. pp. 793\u2013803",
            "year": 2019
        },
        {
            "authors": [
                "J. Zhao",
                "X. Wang",
                "C. Shi",
                "B. Hu",
                "G. Song",
                "Y. Ye"
            ],
            "title": "Heterogeneous graph structure learning for graph neural networks",
            "venue": "Proceedings of the 35th AAAI Conference on Artificial Intelligence. vol. 35, pp. 4697\u20134705",
            "year": 2021
        },
        {
            "authors": [
                "Z. Zhao",
                "K. Kuang",
                "R. Xiong",
                "F. Wu"
            ],
            "title": "Learning individual treatment effects under heterogeneous interference in networks",
            "venue": "arXiv preprint arXiv:2210.14080",
            "year": 2022
        }
    ],
    "sections": [
        {
            "text": "Keywords: Causal Inference\u00b7 Treatment Effect Estimation\u00b7 Heterogeneous Graphs\u00b7 Interference\n1 Introduction\nIn recent years, treatment effect estimation has been performed to enable effective decision-making in many fields, such as medicine [25], education [22], and e-commerce [18,29,37]. For example, estimating treatment effects helps us understand whether an advertisement affects the sales of the advertised products. The\nar X\niv :2\n30 9.\n13 88\n4v 1\n[ cs\n.L G\n] 2\n5 Se\n2 X. Lin et al.\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer z1 z2 z3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph\no-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover\nross-View Interference Interference Spillover Computer Node-Level ttention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCov r ate Representations Int rference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (Vi w 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nC variate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2 Estimating Treatment Effects Under Heterogeneous Inter erence 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6\nCovariates\nHeterogeneous Edges in v1\nHeterogeneous Edges in v2\n(View 1)\n(View 2)\nCross-View Spillover\nCross-View Interference\nInterference\nSpillover\nComputer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8\n\u03c6\nCovariates\nHeterogeneous Edges in v1\nHeterogeneous Edges in v2\n(View 1)\n(View 2)\nCross-View Spillover\nCross-View Interference\nInterference\nSpillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Repr sentations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2 Estimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mous 2 14 Lin et al. Sensitivity analysis To investigate whether HINITE is sensitive to \u03b1, we conducted experiments with different \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This reveals that HINITE is n t particularly sensitive to the value of \u03b1. 5 Related work In the literature, efforts have been made to estim te treatment effect without interference [2,7,11,13,23,24,26,42,43] and with interference on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heterogeneous graphs. For example, Qu et al. [20] assumed a partial interference and could only estimate ATE. Zhao et al. [46] proposed a method to construct a heterogeneous graph from a homogeneous graph by learning a set of weights for each edge using an attention mechanism, but their method cannot capture interference between multi-view graph structures. We offer the first approach for handling interference on multi-view graphs. Meanwhile, heteroge eous graphs have been the subject of recent graph analy is studies, focusing on tasks such as node classification, link prediction, and graph classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares some similarities with the h t rogen ous g aph attention network (HAN) [39]. However, HAN aggregates information from each view at the end of forward propagation only once, whil the proposed HINITE does aggregation layer-bylayer, which is essential f r capturing cross-view interference. In addition, we use LeakyRelu (for view-level attention) instead of the tanh function as an activation function to address the vanishing gradient issue, and we use single-head instead of multi-head attention f r better efficiency. 6 Conclusion In this paper, we described the problem of heterogeneous interference and the difficulty of treatment effect estimations under hete og neous interference. This paper proposed HINITE to model the propagation of het roge eou i terference using HIA layers that contain node-level aggregation, view-level aggregation, and attention mechanisms. We conducted extensive experiments to verify the performance of the proposed HINITE, where the results validate the effectiveness of the HINITE in ITE estimat on u der h terogeneous interference. Concat(u, g) Advertisement HSIC x1 x2 x3 u1 u2 Estimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-View d Gra h \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (Vi w 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer N de-Level Attention N de-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors\nMouse 1\nMouse 2\nEstimating Treatment Effects Under Het rogeneous Interfere ce 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6\nCovariates\nHeterogeneous Edges in v1\nHeterogeneous Edges in v2\n(View 1)\n(View 2)\nCross-View Spillover\nCross-View Interference\nInterference\nSpillover\nComputer\nNode-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors M use 1 Mouse 2\n16 Lin et al.\nMultiply Trea ment Assignment\nAcknowledgements\nThis work was supported by JST, the establishment of university fellowships towards th creation of science technology innovation, Grant Number JPMJFS2123, and supported by JSPS KAKENHI Grant Number 20H04244.\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p \u2032 2\n2\np v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cr ss-View Interference I terference Spillover Computer Node-Level Attention Node-Level Aggregation\nView-Level Attention\nView-Level Aggregation\nOutcome Predictors\nMouse 1\nMouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g g3 Project HIA Layer\nz1 z2 z3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph\no-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover\nross-View Interference Interference Spillover\nComputer\nNode- e el ttention\nNode-Level Aggregation\nView-Level Attention\nView-Level Aggregation\nOutcome Predictors\nMouse 1\nMouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Cov r ate Representations Int rference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (Vi w 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover\nComputer\nNode-Level Attention\nNode-Level Aggregation\nView-Level Attention\nView-Level Aggregation\nOutcome Predictors\nMouse 1\nMouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference\nSpillover\nComputer\nNode-Level Attention\nNode-Level Aggregation\nView-Level Attention\nView-Level Aggregation\nOutcome Predictors\nMouse 1\nMouse 2\nEstimating Treatment Effects Under Heteroge eous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Repres ations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) C ntrol (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2\n(View 1)\n(View 2)\nCross-View Spillover\nCross-View Interference\nInterference\nSpillover\nComputer\nNode-Level Attention\nNode-Level Agg gation\nView-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer z1 z2 z3 p p2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Rep sentations If t 0 If t = 1 fy0 fy1 Treated (t 1) ontrol (t = 0) o-Purchased Graph Co-Vi wed Graph \u03c8 \u03c6 Covariates eterogeneous dges in v1\nHeterogeneous Edges in v2\n( ie 1)\n(View 2)\nross- ie Spillover\nCross-View Interference\nInterference\nSpillover\nComputer\node-Level tt ntion\nNode-Level ggregation\ni -L vel ttention Vi w-L vel Aggr gation Outcome Predictors\nouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representation Interfe ence Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-View d Graph \u03c8 \u03c6 Covariates Het rogeneous Edges in v1 Het rogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover\nCross-View Interference\nInterference\nSpillover\nComputer\nNode-Level Attention\nNode-Level Aggregation\nView-Level Attention\nView-Level Aggregation\nOutcome Predictors\nMouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interfe ence Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-View d Graph \u03c8 \u03c6 Covariates Het rogeneous Edges in v1 Het rogeneous Edges in v2 (Vi w 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover\nComputer\nNode-Level Attention\nNode-Level Aggr gation\nView-Level Attention\nView-Lev l Aggregation\nOutcome Predictor\nMouse 1\nMouse 2\n14 Lin et al. Sensitivity analysis To investigate whether HINITE is sensitive to \u03b1, we conducted experiments with different \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Related work\nIn the literature, efforts have been made to estimate treatment effect without interference [2,7,11,13,23,24,26,42,43] and with interference on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heterogeneous graphs. For example, Qu et al. [20] assumed a partial interference and could only estimate ATE. Zhao et al. [46] pro osed a method to construct a heterogeneous graph from a homogeneous graph by learning a set of weights for each edge using an attention mechanism, but their method cannot capture interference between multi-view graph structures. We offer the first approach for handling interference on multi-vi w graphs.\nMeanwhile, heterogeneous graphs have b en he subject of recent graph analy is studies, focusing on tasks such as node classification, link prediction, and graph classification [4,10,14,27,28,38,39,44,45]. The oposed HINITE shares some similarities with the heterogeneous graph att ntion n twork (HAN) [39]. However, HAN aggregates information from each view at the end of forward propagation only once, while the proposed HINITE does aggregation layer-bylayer, which is essential for capturing cross-view interference. In addition, we use LeakyRelu (for view-level attention) instead of the tanh function as an activation function to address the vanishing gradient issue, and we use single-head instead of multi-head attention for better efficiency.\n6 nclusio\nIn this paper, we described the problem of heterogeneous interference and the difficulty of treatment effec estimations under heterogeneous i terference. This paper proposed HINITE to m d l the propagation of heterogeneous interference using HIA layers that contain node-level aggrega ion, view-level aggregation, and attention mechanisms. We conducted extensive experiments to verify the performance of the proposed HINITE, wher the results validate the effectiveness of the HINITE in ITE estimation under h t rogeneous nterference.\nConcat(u, g) Advertisement\nHSIC\nx1\nx2\nx3\nu1\nu2\n14 Lin et al. Sensitivity a alysis To investigate whether HINITE is sensitive to \u03b1, we conduc ed xperiments with different \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Related work In he literature, efforts have been made to estimate treatment effect withou interference [2,7,11,13,23,24,26,42,43] and with interference on homogeneous graphs [1,3,9,15,17,32,33,36] o hyper-graphs [16]. A few studies have considered heterogen ous graphs. For example, Qu et al. [20] assumed a partial interference and could only estimate ATE. Zhao et al. [46] proposed a method to construct a heterog neous graph from a omogeneous graph by learning a set of weights for each edg using an attention mechanism, but their method cannot capture interference between multi-view graph structures. We offer the first approach for handling interference on multi-view graphs.\nMeanwhile, h t rogeneous graphs have been the subject of recent graph analysis studies, focusing on tasks such as node classification, link prediction, and grap classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares som similarities with the heterogeneous graph attention network (HAN) [39]. Howe er, HAN aggreg tes info mation from each view at the end of forward propagation only once, whil the proposed HINITE does aggregation layer-bylayer, which is essential for capturing cross-view interference. In addition, we use LeakyRelu (for view-level attention) instead of the tanh function as an activation function to address t vanishing gradient issue, and we use single-head instead of multi-head attention for better efficiency.\n6 Conclusio\nIn this paper, w described the problem of heterogeneous interference and the difficulty of treatm nt effect estimations under heterogeneous interference. This pap proposed HINITE to model the propagation of heterogeneous interference using HIA layers that cont in ode-level aggregation, view-level aggregation, and att ntion mechanisms. We conducted extensive experiments to verify the pe formance of he proposed HINITE, where the results validate the effectiveness f th HINITE in ITE estimation under heterogeneous interference.\nConcat(u, g) Advertisement HSIC x1 x2 x3 u1 u2\n14 Lin et al. Sensitivity analysis To investigate whether HINITE is sensitive to \u03b1, we conducted experime ts with different \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This re eals th t HINITE is not particularly sensitive to the value of \u03b1. 5 Related work\nIn the literatur , efforts have been made to estimate treatment effect without i terfere ce [2,7,11,13,23,24,26,42,43] and with interference on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heterogeneous g aphs. For example, Qu et al. [20] assumed a partial interference and could only estimate ATE. Zhao et al. [46] proposed a method to construct\neterogeneous graph from a homogeneous graph by learning a set of weights for each edge using an attention mechanism, but their method cannot capture interference b tween multi-view graph structures. We offer the first approach for handling interference on multi-view graphs.\nMeanwhile, heterogeneous graphs have been the subject of recent graph analysis studies, focusing on tasks such as node classification, link prediction, and graph classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares som similari ies with the heterogeneous graph attention network (HAN) [39]. However, HAN aggreg tes information from each view at the end of forward propagation only once, while the proposed HINITE does aggregation layer-bylayer, which is essential for capturing cross-view interference. In addition, we use L akyRelu (for view-level attention) instead of the tanh function as an activation function to address the va ishing gradient issue, and we use single-head instead of multi-head attention for better efficiency.\n6 Conclusion\nIn this paper, we des ribe t e problem of heterogeneous interference and the difficulty of treatment eff ct estimations under heterogeneous interference. This pap prop s d HINITE to model the propagation of heterogeneous interference using HIA layers that contain node-level aggregation, view-level aggregation, and attention mechanisms. We conducted extensive experiments to verify the performance of the proposed HINITE, where the results validate the effectiveness of the HINITE i ITE estimation under heterogeneous interference.\nConcat(u, g) Advertisement\nHSIC\nx1\nx2\nx3\nu1\nu2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2\np3\np v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 C variate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogen ous Edges in v2\n(View 1)\n(View 2)\nCross-Vi w Spillover\nCross-View Interf rence\nInterference\nSpillover\nComputer\nNode-Level Attention\nNode-Level Aggregation\nView-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under H terogeneous Interference 15\n3\ng1 g2 g3 Pr ject HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations\nInterfe ence Representations\nIf t = 0\nIf t = 1\nfy0\nfy1\nTreated (t = 1)\nControl (t = 0)\nCo-Purchased Graph\nCo-View d Graph\n\u03c8\n\u03c6 Covariates Het roge eous Edges in v1 H t r geneous Edges in v2 (Vi w 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\n16 in et al.\nMultiply\nTreatment Assignment\nAcknowledgements\nThis work as supported by JST, the establishment of university fellowships\ntowards th creation of science technology innovatio , Grant Number JP-\nMJFS2123, and supported by JSPS KAKENHI Grant Number 20H04244.\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1\np2 p3\np v\u20321 1 p v\u20321 2 p v\u20322 2 v\u20322 3\novariat Repres ntations Representations\nIf t = 0 If t = 1 fy0 fy1 Tr ated (t = 1) Control (t = 0) Co-Purcha ed Graph C -Viewed Graph \u03c8 \u03c6\nvariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference\nInt rference\nSpillover\nomput r\nNode-Level Attentio\nNode-L vel Aggregation\nView-Level Attention\nView-Level Aggregation\nOutcome Predictors\nMouse 1\nMouse 2\nEstimating Treatment Effec s Under H terogeneous Interfer nce 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cr s -View Spillover\nCross-View Interference\nInterference\nCompu er\nNode-Level Attention\nNode-Level Aggregation\nView-Level Attention\nView-Level Aggregation\nOutcome Predictors\nMouse 1 Mouse 2\n2 F. Author et al. Table 1. Table captions should be placed above the tables. Heading level Example Font size and style Title (centered) Lecture Notes 14 point, bold 1st-level heading 1 Introduction 12 point, bold 2nd-level heading 2.1 Printing Area 10 point, bold 3rd-level heading Run-in Heading in Bold. Text follows 10 point, bold 4th-level heading Lowest Level Heading. Text follows 10 point, italic\nFig. 1. A figure caption is always placed below the illustration. Please n te that short captions are centered, while long ones are justified by the macro package automatically.\nProof. Pro fs, examples, and remarks have the initial word in italics, whil the following text appears in normal font.\nFor citations of references, we prefer the use of square brackets and consecutive numbers. Citations using labels or the author/year convention are also acceptable. The following bibliography rovides a sample reference list with entries for journal articles [ ], an LNCS chapter [2], a b ok [3], proceedings without editors [4], and a homepage [5]. Multiple citations are grouped [1\u20133], [1, 3\u20135].\nAcknowledgements Please place your acknowledgments at the end of the paper, pr ceded by an u numbered run-in heading (i.e. 3rd-level hea ing).\nEdges in Co-Purchased Graph Edges in Co-viewed Graph\nRefe nces\n1. Author, F.: Article title. Journal 2(5), 99\u2013110 (2016) 2. Author, F., Author, S.: Title of a proceedings paper. In: Editor, F., Editor, S.\n(eds.) CONFERENCE 2016, LNCS, vol. 9999, pp. 1\u201313. Springer, Heidelberg (2016). https://doi.org/10.10007/1234567890\n2 . uthor et al. a le 1. able captions should be placed above the tables. eading level xa ple ont size and style itle (centered) 14 point, bold 1st-level heading I tr ti 12 point, bold 2nd-le el heading 2.1 ri ti g rea 10 point, bold 3rd-level heading -i ea i g i ol . ext follo s 10 point, bold 4th-level heading o est evel eading. ext follo s 10 point, italic\nig. 1. figure caption is al ays placed belo the illustration. lease note that short captions are centered, hile long ones are justified by the acro package auto atically.\nroof. roofs, exa les, a re arks ave t e i itial or i italics, il t e follo i g text a ears i or al fo t.\nor citati of refer ces, e refer t e se of sq are rackets a co sec tive rs. itatio s si g la el or t e a t or/year co ve tio are also acce ta le. e follo i g i liogra y rovi es a sa le refere ce lis it e tries for jo r al articles [1], a c a ter [2], a ok [3], rocee i gs it o t e itors [4], a a o e age [5]. lti le citatio s are gro e [1\u20133], [1, 3\u20135].\nc le e ts l ase lace yo r ack o le g e ts at t e of t e a er, r ce e y a e e r -i ea i g (i.e. 3r -level eadi g).\nges i o- rc ase ra ges i o-vie e a\nf r s\n1. uthor, .: rticle title. Journal 2(5), 99\u2013110 (2016) 2. uth r, ., uthor, S.: itle of a proceedings paper. In: ditor, ., ditor, S.\n(eds.) 2016, S, v l. 9999, pp. 1\u201313. Springe , eidelberg (2016). https://doi.org/10.10007/1234567890\nEstimating Treatment Effects Under Heterogeneous Int rference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interf rence Repr sentations If t = 0 If t = 1 fy0 fy1 Tr ated (t = 1) Control (t = 0)\nVie ed ph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interferenc Interfer nce Spill ver\nComputer\nNode-Level Attention\nN de-Level Aggr gation\nView-Level Attention\nView-Level Aggregation\nOutcome Predictors\nMouse 1\nMouse 2\n(a) Int f renc on a homogeneous graph\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Represent tions Inte ference Repr sentatio s If t = 0 If t = 1 fy0 fy1 Treated (t = 1) C ntrol (t = 0) Co-Purcha ed Grap Co-Viewe G aph \u03c8 \u03c6 Covariates Het rogeneous Edges in v1 Het rogeneous Edges in v2 (View 1) (Vi w 2) Cross-View Spillover Cross-View Int rference Int rference Spillover Computer Node-Level A tentio Node-Level A gregation View-Level Attention View-Level A gregation Outcom Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer z1 z2 z3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Repres ntations Interference Represent tions If t = 0 If t = 1 fy0 fy1 Treated (t = 1) C ntrol (t = 0) Co-Purchased Graph\no-Viewed Graph \u03c8 \u03c6 Covariates H t rogeneous Edges in v1 Het rogeneous Edges in v2 (View 1) (Vi w 2) Cross-View Spillover\nr ss-View Int rference Int rference Spillover Computer Node-Level ttention Node-Level A gregation View-Level Attention View-Level A gregation Outcom Predictors Mouse 1 Mouse 2\nstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nC v r a Representations Int rference epr sentatio s If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Cova iat s Heterogeneous Edges i v1 He erogeneous Edg s in v2 (Vi w 1) (Vi w 2) Cross-View Spillov r C ss-View I f Int rference Spillover Computer Node-Level Attention Node-Level Aggregation Vi w-Level Attention Vi w-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nC variate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Trea ed (t = 1) Control (t = 0) Co-Purchased Graph\n-Viewed Graph \u03c8 \u03c6 C variat s Heterog neous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Int rference Int rference pillover Computer Node-Level Attention Node-Level Aggregation Vi w-Level Attention Vi w-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Pu chased Graph Co-Viewed Graph \u03c8 \u03c6 Cov riate Het rogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2)\nCross-View Spillover\nCross-View Interference\nI erference\nSpillover\nComputer\nNode-Level Attention\nNode-Level Aggregation\nView-Level Attention\nView-Level Aggregation\nOutcome Predictors\nMouse 1 Mouse 2\nEstimating Treatment Effects Under Heter s Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Co trol (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Het rogeneous Edges in v2 (Vi w 1) (View 2) C ss-View Spillo er Cro s-Vi w I terference Interfer nce Spillover Computer Node-Level Attention Node-Level Aggregation\niew-Lev l Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Proj ct HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations I t rfere ce Representations If t = 0 If t = 1 fy0 fy1 Treat d (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2\n(View 1)\n(View 2)\nCross-View Spillover\nCross-View Interference\nInterference\nSpillover\nComputer\nNode-Level Attention\nNode-Level Aggregation\nView-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Und r Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covaria e Repr sentations Interference Representations If = 0 If t = 1 fy0 fy1 Treated (t = 1) Co trol (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 He erogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cro s-View Interference Interference Spillover\nComputer\nNode-Level Attention\nNode-Level Aggregation\niew-Lev l Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Repre ntations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph C -Vi wed Graph \u03c8\n\u03c6\nCovariates\nH terog n u Edges in v1\nHet roge eous Edges in v2\n(Vi w 1)\n(Vi w 2)\nCross-View Spillover\nCross-Vi w Int rf rence\nInterf rence\nSpillover Computer Nod -Level Attention Node-Level Aggregation Vi w-Level Att ntion View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Cov riate Representations Interference Representati ns If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-V ewed Graph\n\u03c8\n\u03c6\nCovariates\nHet ogeneous Edges in v1\nHeterogeneous Edges in v2\n(Vi w 1)\n(Vi w 2)\nCr ss-View Spillover\nCross-View Interference\nInterference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Int rference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covari t Representations Int rf ce Represe tations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Contr l (t = 0) C -Pur hased G Co-Viewed Graph \u03c8 \u03c6 Covari tes H t rogeneo s E ges in v1 Heterogen ous Edges in v2 (View 1) (Vi w 2) Cross-Vi w Spillover Cross-Vi w Interference Interfer nce Spillover Computer Node-Level Attention Nod -Level Aggr gation View-Level Att ntion View-Level A gregation\nOutcome Predictors\nMouse 1\nMouse 2\nEstimating Treatment Effects Under Heteroge eous Interference 15 u3 g1 g2 g3 Project HIA Layer z1 z2 z3 p1 p2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t 0 If t = 1 fy0 fy1 Treated (t 1) ntrol (t = 0) o-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates eterogen ous dges in v1 Heterog neo s Edges in v2 ( ie 1) (View 2) ross- i Spillover Cross- i I terferenc Interfer n e Spillover C mpu r ode-Level t ention Nod -L vel ggregation ie -Le el tt ntion\nView-Level A grega ion\nOutcome Predictors\nouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Proj ct HIA Lay r Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Cov riate Representations Int rference Representations If t = 0 If t = 1 fy0 fy1 Tr ated (t = 1) C trol (t = 0) Co-Purchased Graph Co-Vi wed Graph \u03c8 \u03c6 Cov riates Heterogeneous Edg s in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Int ference I t fer nce Spillover Computer Node-Level Attenti n Nod -Level Ag regation View-Level Attention View-Level A regation Outcome Predictors Mouse 1 Mouse 2 Estimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Vi wed Graph \u03c8 \u03c6 Cov riates Heterog n ous Edges in v1 Heter neous Edges in v2 (Vi w 1) (Vi w 2) Cross-View Spillover C o s-View Int ference Int fer nce Spillover Computer Node-Level A tention Nod -Level Aggregation View-Level Att ntion View-Lev l A gregation Outcome Predic ors Mouse M use 2 14 Lin et al. Sensitivity analysis To investigate wheth r HINITE is se sitive o \u03b1, we co - ducted experiments with different \u03b1 and present the results in Figure 5. No significant change in p rformance was obs ved with differe t valu s of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Related work In the literature, efforts have been made to estimate tr atment effect without interference [2,7,11,13,23,24,26,42,43] and with int rference on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heterogeneous graphs. For example, Qu et al. [20] assumed a artial interference and could only estimate ATE. Zhao et al. [46] pro osed a method to construct a heterogeneous graph from a homogeneous graph by learning a set of weights for each edge using an attention mechanism, but their method cannot capture interference between multi-view graph structures. We off r th first approach for handling interfer nce on multi-vi w graphs. Meanwhile, h terogeneous grap s have b en he subj ct of recent graph naly is studies, focusing on tasks such as node classification, link prediction, and graph classification [4,10,14,27,28,38,39,44,45]. Th oposed HINITE shares s me similarities wit t het rogeneous graph at ntio n twork (HAN) [39]. However, HAN ag regates information from ach view at th end of forward p opagatio nly onc , while the roposed HINITE does a regation layer-bylayer, w ich is ssential for capturing cross-view interfer nce. In addition, we use LeakyRelu (for view-level attentio ) instead of the tanh function as n activation function to address th vanishing gradient issue, a d we us singl -h ad i stead of multi-he d at ention for b tt r efficiency. 6 Conclusi n In this paper, w described the problem of heterogen ous int rfer nce nd the difficulty of treatment effec stimations u der he er gen ous i erfer nc . This pe proposed HINITE to m d l the ropaga i n of heterogeneous interfer nce using HIA layers that contain node-level ag rega ion, view-l vel ag regation, and at ention mechani ms. We conduct d xt nsive experiments to verify the pe formance of the roposed HINITE, wher th esults validate the effectiveness of the HINITE in ITE estima io under h t geneous nterfer nce. Concat(u, g) Advertis ment HSIC x1 x2 x3 u1 u2 Estimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 p3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations In rferenc Repre entations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Gra h \u03c8 \u03c6 Covariates H terogeneou Edges in v1 H terogen ou Edges in v2 (View 1) (Vi w 2) Cro s-View Spillover Cross-View nterference Interfer nc Spillover Computer N de-Lev l Att ti n N d -Level Aggregation View-Level Att ntion View-Level A gr gation\nOutcome Predictors\nMouse 1\nMous 2\nEstimating Treatment Effects Under H terogeneous Interference 15 u3 g1 g2 g3 Pr jec HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 v\u20322 3\nCov riate Representations Int ference Representations If t = 0 If t = 1 fy0 fy1 T eated (t = 1) Contr (t = 0) Co-Purchased Graph Co-Vi wed Graph \u03c8 \u03c6\nCov riates\nHeterogeneous Edges in v1\nHeterogeneous Edges in v2\n(View 1)\n(V ew 2)\nCross-View Spillover\nCross-View Int ference\nInt fer nce\nSpillover\nComputer\nNode-Level Attention Nod -Level Ag regation View-Level Attention View-Level A regation Outcome Predictors Mouse 1 Mouse 2\n16 Lin et al.\nMultiply Treatment Assignment\nAcknowledg ments\nThis work was supported by JST, the establishment of university fellowships towards th creation of science technology innovatio , Grant Number JPMJFS2123, and supported by JSPS KAKENHI Grant Number 20H04244.\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Represent tions Int rference Representatio s If t = 0 If t = 1 y0 fy1 Treated (t = 1) C ntrol (t = 0) Co-Purchased Graph Co-Viewed G aph \u03c8 \u03c6 Covariates Het rogeneous Edges in v1 Het rogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cro s-View Int rference Int rference Spillover Computer Node-Level Attentio Node-Level A gregation\nView-Level Attention\nView-Level A gregation\nOutcom Predictors\nMouse 1\nMouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g g3 Project HIA Layer z1 z2 z3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Repr sentations Int rference Repr t tions If t = 0 If t = 1 fy0 fy1 Treated (t = 1) C ntrol (t = 0) Co-Purchased Grap o-Viewed Graph \u03c8 \u03c6 Cova iates Het roge eo s Ed s in v1 Het rog neous Ed s in v2 (View 1) (View 2) C oss-Vie Spillover\nr ss-View Int rfer ce Int rference Spillover\nComputer\nNode- e el ttention\nNode-Level A gregation\nView-Level Attention\nView-Level A gregation\nOutcom Predictors\nMouse 1\nMouse 2\nstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g g3 Project HIA Layer Wz1 Wz2 Wz3 Wp Wp2 W 3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Cov r ate Repr sentations Int rference epr sentatio s If t = 0 If t = 1 fy0 y1 Trea e (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Het rogeneous Edges in v1 Heter geneous Edges in v2 (Vi w 1) (View 2) Cross-View Spillover Cross-View Int rference Int rference Spillover\nComputer\nNode-Level Attention\nNode-Level Aggregation\nVi w-Level Attention\nVi w-Level Aggregation\nOutcome Predictors\nMouse 1\nMouse 2\nEs imating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Represen ations Int rference Representations If t = 0 If t = 1 fy0 fy1 Trea ed (t = 1) Control (t = ) Co-Purchased Graph -Viewed Gr ph \u03c8 \u03c6 Covariat s Heteroge e s Edges in v1 Heterogen ous Edg s in v2 (View 1) (View 2) Cross-Vi w Spill v r Cross-View Int rference Int rference\npillover\nComputer\nNode-Level Attent on\nNode-Level Aggregati n\nVi w-Level Attenti n\nVi w-Level Aggregation\nOutcome Predictors\nMouse 1\nMouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g 3 Pr j ct HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nC variate Rep esentations Interference Representations If t = 0 If t = 1 fy0 fy1\nTreated (t = 1)\nControl (t = 0)\nCo-Purchased Graph\nCo-Viewed Graph\n\u03c8\n\u03c6\nCovariates\nHeterogen ous Edges in v1\nHeterogen ous Edges n v2\n( 1) ( 2) Cross-Vi w Spillover Cr ss-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Rep esentations Interference Representations If t = 0 If t = 1 fy0 fy1 T eated (t = 1) Co trol (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6\nCovariates\nHeterogen ous Edges in v1\nHet rogen ous Edges n v2\n( 1)\n( 2)\nCross-Vi w Spillover\nCr s-View Interference\nInterferenc\nSpillover\nComputer Nod -Level Attention Node-L vel Aggregation\niew-Lev l Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatmen Effects Under Heterogeneous Interference 15\nu3 g1 g g3 Proj ct HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations I t rfere ce Representations If t = 0\nIf t = 1\nfy0\nfy1\nTreat d (t = 1)\nControl (t = 0)\nCo-Purchased Graph\nCo-Viewed Graph\n\u03c8\n\u03c6\nCovariates\nHeterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariat Representations I t rference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Co trol (t = 0) Co-Purchased Graph\nCo-Viewed Graph\n\u03c8\n\u03c6\nCovariates\nHeterogeneous Edges in v1\nHeterogeneous Edges in v2\n(View 1)\n(View 2)\nCross-View Spillover\nCro s-View Interference\nInterference Spillover Computer Node-Level Attention Node-Level Aggregation\niew-Lev l Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects U der Het ogene us Int rference 15\nu3 g1 g2 g3 Project HIA La er Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u2032\n1\np v\u20321 2 p v\u20322 2 p \u2032 2\n3\nCovariate Represe tations Interfer nce Represe tations If t = 0 If t = 1 fy0 fy1 Treated (t = 1)\nntrol (t = 0) o-Pu chased Graph\nCo- ie ed Graph \u03c8 \u03c6 C variates Het rogeneous Edges in v1 Het rogeneous Ed es i v2\n(View 1)\n(View 2)\nCr s -View Spillover\nCross-View Interference\nInterferenc\nSpillover\nComp t r\nNode-Level A te tion\nNode-Level A gregation\nView-Level A te tion View-Level A gregation Outcom Predictors Mouse 1 Mouse 2\nEstimating Tr atment Effects Under Heterogeneous Interf rence 15\nu3 g g2 g3 Project HIA L y r\nz1 z2 z3 p1 p2 p3\np v\u20321 1 p v\u20321 2 p v\u20322 2 p \u2032 2\n3\novariate Repres ntations Interference R pres ntations If t 0 If t = 1 fy0 fy1 Treated (t 1)\nntrol (t = 0) o-Pu c ased Graph o-Vi wed Graph\n\u03c8 \u03c6 C variat s\net rogeneous dges in v1\nHet rogeneous Ed es i v2\n( ie 1)\n(View 2)\nr s - ie Spillover Cross-View Interference Interference Spillover Computer\node-Level te tion\nNode-Level gregation\nie -Level te tion View-Level A gregation Outcom Predictors\nouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representation Int rference Representat ons If t = 0 If t = 1 fy0 fy1 Treated (t = 1)\nntrol (t = 0) Co-Pu hased Graph C -Viewed Graph \u03c8 \u03c6 C variates Het rogeneous Edg s in v1 Het rogeneous Ed es i v2 (View 1) (View 2) Cr s -View Spillover\nCross-View Int rference\nInt rference\nSpillover\nComputer\nNode-Level A te tion\nNode-Level A gregation\nView-Level A te tion\nView-Level A gregation\nOutcom Predictors\nMouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1\np2 p3\np v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Represent tio s If t = 0 If t = 1 fy0 fy1 Treated (t = 1)\nntrol (t = 0) Co-Pu h s d Graph C -Viewed Graph \u03c8 \u03c6 C variates Het rogen ous Edges in v1 Het rogeneous Ed es i v2 (Vi w 1) (Vi w 2) Cros -View Spillover C oss-View I terf renc Interference Spillov r\nComput r\nNode-Level A te tio\nNode-Level A gre atio\nView-Level A te tion\nVi w-L v l A gregation\nOutcom P dictors\nMouse 1\nMouse 2\n14 Lin et al. Sensitivity analysis To investigate wheth r HINITE is se itive o \u03b1, we co - duct d experiments wi h differ nt \u03b1 and pres nt the results in Figure 5. No sig ificant ch g in p formance was observed with different values of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Related work\nIn the literature, efforts have been made to estimate t eatmen effect without interference [2,7,11,13,23,2 ,26,42,43] and with int rference n homogeneous graphs [1,3,9,15,17, 2,33,36] or hyper-graphs [16]. A few studies have considered het rogeneous graphs. For example, Qu et al. [20] assumed a artial int rference and could only estimate ATE. Zhao et al. [46] pro osed a method to construct a het rogeneous graph from a homogeneous graph by learning a set of weights for each edge usi n attention mechanism, but their method cannot capture int rference b tween multi-view graph structures. We off r th first approach for handling int rference on multi-vi w graphs.\nMeanw ile, het rogeneous graphs have b en he subj ct of recent graph naly is studies, focusi g on tasks such as node classification, link prediction, and graph cl ssification [4,10,14,27,28,38,39,44,45]. Th oposed HINITE shares some similarities with th het rogen ous gr ph att ntio n twork (HAN) [39]. However, HAN a gr gates information from each view at the end of forward propagation only once, while the proposed HINITE does a gregation la er-bylayer, which is ssential for capturing cross-view int rference. In addition, we use LeakyRelu (for view-level attent on) instead of the tanh fu ction as an ctivation functi n to address th va ishing grad ent issue, a d we us single-h ad i stead of multi-head attention for better fficiency.\n6 Conclusion\nIn this paper, we described the problem of heterogen ous int rfer nce nd the difficulty of treatment effec es matio s u der he er gen ous i rferenc . This paper proposed HINITE to m d l the propaga ion of heterogeneous int rference u ing HIA layers that con ain nod -level a grega ion, view-l vel aggregation, nd attention mechanisms. We conducted ext nsive exp riments to verify the performance of the proposed HINITE, wher th esults validate the ff ctiveness of the HINITE in ITE e matio under h te geneous t rference.\nConcat(u, g) Adv rtisement\nHSIC\nx1\nx2\nx3\nu1\nu2\n14 Lin et al. Sens tivity nalysis To inve tigat whether HINITE is sensitive to \u03b1, we conducted experime ts with different \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This reveals th t HINITE is not particularly sensitive to the value of \u03b1. 5 Related work In the literatur , efforts have been made to estimate treatment effect without i terfere ce [2,7,11,13,23,24,26,42,43] and with interference on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heterogeneous g aphs. For example, Qu et al. [20] assumed a partial interference and could only estimate ATE. Zhao et al. [46] proposed a method to construct eterogeneous graph from a homogeneous graph by learning a set of weights for each edge u ing an attention mechanism, but their method cannot capture interference between multi-view graph structures. We offer the first approach for handling interference on multi-view graphs.\nMeanw ile, heterogeneous graphs have been the subject of recent graph analysis studies, focusi g on tasks such as node classification, link prediction, and graph classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares som similari ies with the heterogeneous gr ph attention network (HAN) [39]. Howev r, HAN aggreg tes informati n from each view at the end of forward propagation only once, while the proposed HINITE does aggregation la er-bylayer, which is essential for capturing cross-view int rference. In addition, we use L akyRelu (fo view-level attention) instead of the ta h fu ction as an ctivation fu ction to address the va ishing gradient issue, and we use single-head instead of multi-head attention for better fficiency.\n6 C nclusi\nIn this paper, we des ribe t e problem of heterogeneous interf re ce and the difficulty of treatment eff ct s matio s under heterogeneous interf rence. This pap prop s d HINITE to mod l the propagation of heterogeneous interf rence usi g HIA layers that contain nod -level aggregation, view-level aggregation, nd attentio mechanisms. We conducted ext nsive experiments to verify the performance of the proposed HINITE, where the results validate the eff ctiveness of the HINITE i ITE es mation under heterogeneous interf rence.\nConca (u, g) Adv rtisement HSIC x1 x2 x3 u1 u2\n14 Lin et al. Sens tivity nalysis To inve tigat whether HINITE is sensitive to \u03b1, we conducted experime ts with different \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This re eals th t HINITE is not particularly sensitive to the value of \u03b1. 5 R lat d work\nIn the literatur , efforts have been made to estimate treatment effect without i terfere ce [2,7,1 ,13,23,2 ,26,42,43] and with interfere ce on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heterogeneous g aphs. For example, Qu et al. [20] assumed a partial interf rence and could only estimate ATE. Zhao et al. [46] proposed a method to construct\neterogeneous graph from a homogeneous graph by learning a set of weights for each edge usi g an attention mechanism, but their method canno capture int rference b tween multi-view graph structures. We off r the first approach for handling int rference on multi-view graphs.\nMeanw ile, heterogeneous graphs have be n the subject of recent graph analysis studies, focusi g on t sks such as ode classification, link prediction, and g aph classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE hares om sim lari ies with the heterogeneous gr ph attention network (HAN) [39]. Ho ev r, HAN aggreg tes informati n from each view at the end of forward propagation only once, while the proposed HINITE does aggregation la er-bylayer, which is esse tial for capturing cross-view int rference. In addition, we use L akyRelu (fo view-level attention) instead of the ta h fu ction as an ctivation fu c ion to address the v ishing gradient issue, and we use single-head instead of multi-head attention for better fficiency.\n6 Conclusion\nI this paper, we des rib t e problem of heterogeneous interf re ce and the difficulty of r atment effect es mations under heterogeneous interf rence. This pap prop s d HINITE to mod l the propagation of heterogeneous interf rence using HIA layers that c tain nod -level aggregation, view-level aggregation, nd attention mechanisms. We conduct d ext nsive experiments to verify the perform nce of th propo ed HINITE, where the results validate the eff ctiveness of the HINITE i ITE es mation under heterogeneous interf rence.\nConca (u, g) Adv rtisem nt\nHSIC\nx1\nx2\nx3\nu1\nu2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Proj ct HIA Layer Wz1 Wz2 Wz3 Wp1\np2 p3\np v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations In rference Representations If t = 0 If t = 1 fy0 fy1 Tr ated (t = 1)\nntrol (t = 0) Co-Pu chased Graph C -Viewed Gr ph \u03c8 \u03c6\nvariates Het rogeneous Edges in v1 Het roge e us Ed s i v2\n(View 1)\n(View 2)\nCr s -View Spill er\nCross-Vi w I terfer nce\nInterf rence\nSp llover\nomputer\nNod -Level A t tio\nNode-L vel A gregation\nView-Level A tion View-Level A gregation Outcom Predictors M use 1 Mouse 2\nEs imating Treatment Effects Under H terogeneous Int rference 15\nu g1 g2 g3 Pr je t HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations\nInterference Representations\nIf t = 0\nIf = 1\nfy0\nfy1\nTreated (t = 1)\nntrol (t = 0)\nCo-Pu hased Graph\nC -Viewed Graph\n\u03c8 \u03c6 C variates Het rogeneous Edges in v1 Het rogeneous Ed es i v2 (View 1) (View 2) Cr s -View Spillover Cross-View Int rference Interference Spillover Computer Node-Level Atte tion Node-Level A gregation View-Level Atte tion View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\n16 Lin et al.\nMultiply Treatment Assig ment\nAckno l dg m nt\nThis work was supported by JST, the establishment of university fellowships t wards th creati n of s ience technology innovation, Grant Number JPMJFS2123, and support d by JSPS KAKENHI Grant Number 20H04244.\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1\np2 p3\np v\u20321 1 p v\u20321 2 p v\u20322 2 v\u20322 3\novariate Rep sentations Int rference Re resentatio s If t = 0 If t = 1 fy0 fy1 Treat d ( = 1) C ntrol (t = 0)\n-Purchased Graph Co-Viewed Gra h \u03c8 \u03c6\nvariates H t rogeneous Edges in v1 Het rogene us Edges in v2 (View 1) (Vi w 2)\nross-Vi w Spillover Cross-V ew Interference\nIn rference\nSpillover\nomp t r\nNode-L vel A tentio\nNode-L vel A gregation\nView-Level A te tion\nView-Level A gregation\nOutcom Predicto s\nMouse 1\nMouse 2\nEstimating Treatment Effec s Under H terogeneous Interfer nce 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 W 2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Represe tati ns If t = 0 If t = 1 fy0 fy1 Treated (t = 1) C ntrol (t = 0)\n-Purchased Graph Co-Vi wed Gra h \u03c8 \u03c6 Covariates Het rogeneous Edges in v1 He rogeneous Edges in v2 (View 1) (Vi w 2)\nross-Vi w Spillover\nCross-View Interference\nInterference\nComp r\nNode-Level A te tion\nNode-Level A gregation\nView-Level A te tion\nView-L vel A gregation\nOutcom Predictors\nMous 1 Mouse 2\n(b) Interference on heterogeneou graphs\nFig. 1: A xampl of the differ nce b tween interference on a homog neous graph and h t r g neous graphs. An edge in a o-purchas d raph represents the relationship that both it ms are bought together by many custom s, while an edge n a c -v ewe graph r pr s nt the rela ionshi that both items are viewed on an e-c merc pl tfo m toget er by many customers. Edges in differ nt views or graph constit e mul i-view or het ogeneous edges.\neffect of a tr atme t ( .g., advertisement) for a particular unit (e.g., product) is known as the individual tr atment effect (ITE) [42], while that for a given group is known a the average treatme t effect (ATE) [42].\nThis study aims to estimate treatment effects from observational graph data, which contain records f covariates of units, relationships between units (i.e., graph structure), and treatment assignments with their outcomes. For example, data from an e-commerce pla form typically include the logs of information regarding assignments f advertisements, sales of items, item profiles, and relationships between items, e.g., a co-purchased relationship.\nAs units are associated in these graphs, the outcome for a unit will be influenced by the treatments assigned to its neighboring units. This phenomenon is referred to as interference [17,21], an example of which is shown in Figure 1a. In a co-purchased graph, many customers buy the Mouse when they buy the Computer. In this case, advertising the Computer may also influence the sales of the Mouse, whose sales can no longer be independent of the advertisement, making it challenging to estimate the ITE accurately. Previous works have attempted to accurately estimate ITE given graph data by modeling interference, such as group-level interference [9,15,32], which is a partial interference and models interference within subgroups of units but ignores inter-group interference; pairwise interference [1,3,21,36], which considers interference from immediate neighbors only; and networked interference [17], which can model interference from distant neighbors. All these methods assume single-view interference, such that a graph is homogeneous and can only represent the same relationship among units, such as a co-purchased graph.\nHowever, real-world graphs are rarely homogeneous, e.g., YouTube dataset [31], and Amazon dataset [8]. Therefore, we consider addressing interference on heterogeneous graphs that have multi-view edges, such as co-viewed and co-purchased item-to-item graphs of the Amazon dataset [8]. In this case, units are influenced by treatments of their heterogeneous neighbors via the multi-view\nEstimating Treatment Effects Under Heterogeneous Interference 3\nedges, which is referred to as heterogeneous interference and often leads to crossview interference, an example of which is shown in Figure 1b. Although there is no direct edge between the Computer and the Mouse 2, the advertisement of the Computer still affects sales of the Mouse 2 via the edge between the Computer and the Mouse 1 in the co-purchased graph and the edge between the Mouse 1 and the Mouse 2 in the co-viewed graph. Without properly modeling the heterogeneous interference, the cross-view interference cannot be addressed, which will result in inaccurate ITE estimation.\nTo overcome the difficulty caused by heterogeneous interference, we propose a novel method called Individual Treatment Effects Estimator Under Heterogeneous Interference (HINITE; see Figure 2). The core idea of HINITE is to model the propagation of heterogeneous interference across units and views. To this end, inspired by Wang et al. [39], we design a heterogeneous information aggregation (HIA) layer, as shown in Figure 3. In the HIA layer, multiple single-layered graph neural networks (GNNs) [12] are used to capture information within the same views, and a view-level information aggregation mechanism is then used to combine information from different views. To properly model heterogeneous interference, the HIA layer also infers importances of different edges and views of heterogeneous graphs by applying attention mechanisms [34,35,39]. A single HIA layer can help units aggregate information from their 1-hop or direct neighbors across all views of heterogeneous graphs, enabling the HINITE to model the propagation of cross-view interference by stacking multiple HIA layers. Other components of the HINITE are explained in Section 3.\nThe contributions of this study can be summarized as follows: \u2013 This study describes a new issue of interference on heterogeneous (multi-\nview) graphs. Moreover, we formalize the problem of estimating ITE under heterogeneous interference.\n\u2013 This study proposes a method to address interference on heterogeneous graphs with multi-view edges.\n\u2013 Results of extensive experiments reveal that the proposed method outperforms existing methods for estimating ITE under heterogeneous interference while confirming the importance of modeling heterogeneous interference.\n2 Problem setting\nIn this study, we aim to estimate ITE from observational heterogeneous graphs. Herein, we use xi \u2208 Rd to denote the covariates of a unit i (e.g., brand), ti \u2208 {0, 1} to denote the treatment assigned to a unit i (e.g., an advertisement), yi \u2208 R to denote the observed outcome of a unit i (e.g., the observed sales of a unit i), and non-bold, italicized, and capitalized letters (e.g., Xi) to denote random variables. Moreover, a unit with t = 1 is treated, and t = 0 is controlled.\nHomogeneous graphs. Homogeneous graphs have only a single view of edges. We use an adjacency matrix A \u2208 {0, 1}n\u00d7n to represent the structure of a homogeneous graph, where n is the number of nodes (units). If there is an edge between units j and i, Aij = 1; otherwise, Aij = 0. We let Aii = 0.\n4 X. Lin et al.\nHeterogeneous graphs. This study considers heterogeneous graphs1 that have multiple views of edges [30], which are called heterogeneous or multi-view edges. We use the H = {Av}mv=1 to denote all the multi-view graph structures, where Av \u2208 {0, 1}n\u00d7n denotes the adjacency matrix of the v-th view, and m is the number of views. We use Nvi to denote the set of neighboring units of the unit i in the v-th view, Ni = {Nvi }mv=1 to denote the set of neighbors of the unit i across all views. Here, the units in Ni are heterogeneous neighbors of the unit i.\nITE estimation without interference. In traditional treatment effect estimation [24,42], non-graph data are given and it is assumed that there is no interference between units [24,42]. In this case, the potential outcomes y1i and y0i of a unit i are defined as the real value of outcome for a unit i with treatment value t = 1 and t = 0,2 respectively [42]. Additionally, the ITE is defined as \u03c4i = E[Y 1i |Xi = xi]\u2212 E[Y 0i |Xi = xi] [42].\nITE estimation under heterogeneous interference. This study aims to estimate the ITE from observational heterogeneous graph data. The data can be denoted by (X,T,Y,H), where X = {xi}ni=1, T = {ti}ni=1, and Y = {yi}ni=1. We assume that there exists interference between units in heterogeneous graphs. In this case, the outcome of a unit is not only influenced by its own treatments and covariates but also influenced by those of its neighbors [17,21]. In heterogeneous graphs, every unit can receive interference from its heterogeneous neighbors through multi-view edges, so the interference in heterogeneous graphs is referred to as heterogeneous interference. Such heterogeneous interference contains two types of interference: same-view interference and cross-view interference. The former is that interference occurs within the same views, and the latter happens when interference propagates across different views through multi-view edges. To formalize the ITE under heterogeneous interference, we use si to denote a summary vector of X\u2212i and T\u2212i on heterogeneous graphs H, where the subscript \u2212i denotes all other units except i. The potential outcomes of the unit i in heterogeneous graphs, denoted by y1i (si) and y0i (si), are real outcomes for the unit i under si and treatment value t = 1 and t = 0, respectively. Then, we define the ITE under heterogeneous interference as follows:\n\u03c4i = E[Y 1i (Si = si)|Xi = xi]\u2212 E[Y 0i (Si = si)|Xi = xi]. (1)\nConfounder. The existence of confounders is a well-known issue when estimating the ITE from observational data [26]. Confounders are parts of covariates, which can simultaneously affect the treatment assignment and outcome [42], resulting in an imbalance in the distributions of different treatment assignments. For instance, we consider that the treatment is whether a product is advertised. Famous brands have more promotion funds to advertise their products. Meanwhile, 1 Heterogeneous graphs can be classified into two types: those with multiple types of\nnodes and multiple types (views) of edges [30], and those with a single type of node and multiple types of edges [30]. In this study, we focus on the latter type.\n2 Outcomes with 1\u2212 t are called counterfactual outcomes [42].\nEstimating Treatment Effects Under Heterogeneous Interference 5\ncustomers tend to buy a product (e.g., a computer) from a famous brand (e.g., Apple). In this case, the brand is a confounder. Without accurately addressing confounders, ITE estimation will be biased.\nAssumption 1. Following the previous studies [16,17], we assume that there exists an aggregation function that can aggregate information of other units on heterogeneous graphs while outputting a vector s, i.e., si = AGG(T\u2212i,X\u2212i,H). Here, we extend the neighbor interference assumption [3] to heterogeneous interference, for \u2200i, \u2200T\u2212i,T\u2032\u2212i,\u2200X\u2212i,X\u2032\u2212i, and \u2200H,H\u2032: when si = AGG(T\u2212i,X\u2212i,H) = AGG(T\u2032\u2212i,X \u2032 \u2212i,H \u2032) = s\u2032i, Y ti (Si = si) = Y ti (Si = s\u2032i) holds.\nAssumption 2. We extend consistency assumption [3] to heterogeneous interference setting. We assume Yi = Y tii (Si = si) on the heterogeneous graphs H for the unit i with ti and si.\nAssumption 3. To address confounders, we extend the unconfoundedness assumption [3,16] to the heterogeneous interference setting. For any unit i, given the covariates, the treatment assignment and output of the aggregation function are independent of potential outcomes, i.e., Ti, Si \u22a5\u22a5 Y 1i (si), Y 0i (si)|Xi.\nTheoretical analysis. To model potential outcomes using observed data under heterogeneous interference, we prove the identifiability of the expected potential outcome Y ti (si) (t = 1 or t = 0) based on the above assumptions as follows:\nE[Yi|Xi = xi, Ti = t,X\u2212i = X\u2212i, T\u2212i = T\u2212i, H = H] =E[Yi|Xi = xi, Ti = t, Si = si] (Assumption 1 ) =E[Y ti (si)|Xi = xi, Ti = t, Si = si] (Assumptions 1 and 2 ) =E[Y ti (si)|Xi = xi] (Assumption 3)\nBased on the above proof, once we aggregate X\u2212i and T\u2212i on heterogeneous graphs H into si, we can estimate the potential outcomes Y 1i (si) and Y 0i (si). This enables us to estimate the ITE using Eq. (1).\n3 Proposed Method: Individual Treatment Estimator Under Heterogeneous Interference\nThis study proposes HINITE, a method that can estimate the ITE from observed data (X,T,Y,H) under heterogeneous interference. Figure 2 shows the architecture of HINITE. As can be seen, HINITE consists of three components to address confounders, model heterogeneous interference, and predict outcomes, respectively. Specifically, the first component addresses confounders by learning balanced representations of covariates with the Hilbert-Schmidt Independence Criterion (HSIC) regularization [6]. The second component aggregates interference by modeling the propagation of interference across units and views, and generates representations of units, which are referred to as interference representations. The last component consists of two outcome predictors that infer potential outcomes using the covariate and interference representations.\n6 X. Lin et al.\n14 Lin et al. Sensitivity analysis To investigate whether HINITE is sensitive to \u03b1, we conducted experiments with different \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Related work In the literature, efforts have been made to estimate treatment effect without interference [2,7,11,13,23,24,26,42,43] and with interference on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heterogeneous graphs. For example, Qu et al. [20] assumed a partial interference and could only estimate ATE. Zhao et al. [46] proposed a method to construct a heterogeneous graph from a homogeneous graph by learning a set of weights for each edge using an attention mechanism, but their method cannot capture interference between multi-view graph structures. We offer the first approach for handling interference on multi-view graphs. Meanwhile, heterogeneous graphs have been the subject of recent graph analysis studies, focusing on tasks such as node classification, link prediction, and graph classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares some similarities with the heterogeneous graph attention network (HAN) [39]. However, HAN aggregates information from each view at the end of forward propagation only once, while the proposed HINITE does aggregation layer-bylayer, which is essential for capturing cross-view interference. In addition, we use LeakyRelu (for view-level attention) instead of the tanh function as an activation function to address the vanishing gradient issue, and we use single-head instead of multi-head attention for better efficiency.\n6 Conclusion\nIn this paper, we described the problem of heterogeneous interference and the difficulty of treatment effect estimations under heterogeneous interference. This paper proposed HINITE to model the propagation of heterogeneous interference using HIA layers that contain node-level aggregation, view-level aggregation, and attention mechanisms. We conducted extensive experiments to verify the performance of the proposed HINITE, where the results validate the effectiveness of the HINITE in ITE estimation under heterogeneous interference.\nConcat(u, g) Advertisement HSIC x1 x2 x3 u1 u2\n14 Lin et al. Sensitivity analysis To investigate wh ther HINITE is sensitive to \u03b1, we conducted experiments with diff rent \u03b1 and present the results in Figure 5. No significant change in performance w s observed with different values of . This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Related work In the literatur , efforts have been made to estimate treatment effect without interference [2,7, 1, 3,23,24,2 ,42,43] and wit interference on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have consider d heteroge eous graphs. For example, Qu et al. [20] assumed a partial interference and could only estimate ATE. Zhao et al. [46] proposed a method to construct a heterogeneous graph from a homoge eous graph by learning a set of weights for each edg using an attention m chanism, but their method cannot capture interference between multi-view graph structures. We offer the first approach for handling int rferenc on multi-view graphs. Meanwhile, h ter geneous graphs have been the subject of recent gra h analysis studies, focusing on tasks such as node classification, link rediction, and graph classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares some similarities with the heteroge eous graph attention net ork (HAN) [39]. However, HAN aggregates information from each view at th end of forward propagation only onc , while the proposed HINITE does aggregatio layer-bylayer, which is ssential for capturing cr ss-view interfer nce. In addition, we use LeakyRelu (f r view-lev l att ntion) instead of the tanh fu ction as an activation function to address the vanishing gradient issue, and we use single-head instead of multi-head attention for better efficiency.\n6 Conclusion\nIn this paper, we described the proble of heterog neous interference and the difficulty of treatment effect estimations under heteroge eous interf rence. This paper proposed HINITE to model the pr pagation of h terogeneous interferenc using HIA lay rs that contain node-level aggr gation, vi w-level aggregation, and attention mechanisms. We conducted extensive xperiments to verify the performanc of the proposed HINITE, where the r sults validate the eff ctiveness of the HINITE in ITE estimation under heterogeneous interference.\nConcat(u, g) Advertisement HSIC x1 x2 x3 u1 u2\n14 Lin et al. Sensitivity analysis To investigate whether HINITE is sensitive to \u03b1, we conducted experiments with different \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Related work In the literature, efforts have been made to estimate treatment effect without interference [2,7,11,13,23,24,26,42,43] and with interference on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heterogeneous graphs. For example, Qu et al. [20] assumed a partial interference and could only estimate ATE. Zhao et al. [46] proposed a method to construct a heterogeneous graph from a homogeneous graph by learning a set of weights for each edge using an attention mechanism, but their method cannot capture interference between multi-view graph structures. We offer the first approach for handling interference on multi-view graphs. Meanwhile, heterogeneous graphs have been the subject of recent graph analysis studies, focusing on tasks such as node classification, link prediction, and graph classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares some similarities with the heterogeneous graph attention network (HAN) [39]. However, HAN aggregates information from each view at the end of forward propagation only once, while the proposed HINITE does aggregation layer-bylayer, which is essential for capturing cross-view interference. In addition, we use LeakyRelu (for view-level attention) instead of the tanh function as an activation function to address the vanishing gradient issue, and we use single-head instead of multi-head attention for better efficiency.\n6 Conclusion\nIn this paper, we described the problem of heterogeneous interference and the difficulty of treatment effect estimations under heterogeneous interference. This paper proposed HINITE to model the propagation of heterogeneous interference using HIA layers that contain node-level aggregation, view-level aggregation, and attention mechanisms. We conducted extensive experiments to verify the performance of the proposed HINITE, where the results validate the effectiveness of the HINITE in ITE estimation under heterogeneous interference.\nConcat(u, g) Advertisement HSIC x1 x2 x3 u1 u2\n14 Lin et al. Sensitivity analysis To investigate whether HINITE is sensitive to \u03b1, we conducted experiments with different \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This reveals that HINITE is not particularly s nsitive to the value of \u03b1. 5 Related work In the literature, efforts have been made to estimate treatment effect without interference [2,7,11,13,23,24,26,42,43] and with interference on homogeneous graphs [1,3,9,15,17,3 ,3 ,36] or hyper-g aphs [16]. A few studies have considered heterogeneous graphs. For example, Qu et al. [20] ssumed a partial interference and could only estimate ATE. Zhao et al. [46] proposed a method to construct a heterogeneous graph from a homogeneous graph by learning a set of weights for each edge using an attention mechanism, but their method cannot capture interference between multi-view graph struc ures. We ffer the first approach for handling interference on multi-view graphs. Mea while, heterogeneous graphs have been the subject of recent graph analysis studi s, focusing on tasks such as node classification, link prediction, and graph classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares some similarities with the heterogeneous graph attention network (HAN) [39]. Ho ever, HAN aggregates informa ion from each view at the end of forward propagation only once, while the proposed HINITE does agg egation layer-bylayer, whic is essential for capturing cr s -view interferenc . In addition, we use LeakyRelu (for view-level attentio ) inst ad of the tanh function as an activation function to address the vanishing gr dient issue, nd we use single-head instead of multi-head attention for better efficiency.\n6 Conclusion\nIn this paper, we described the problem of heterogeneous interference and the difficulty of treatment ffect estimations nder heterog neous interference. This pap r proposed HINITE to model he propagation of heterogeneous interference using HIA layers that c ntain node-level a gr gatio , view-level aggregation, and attention mechanisms. We conducted ext nsive experiments to verify the p rform nce of the proposed HINITE, where th results valida e the effectiveness of the HINITE in ITE estimation under heterogen ous interference.\nConca (u, g) Advertisement HSIC x1 x2 x3 u1 u2\n14 Lin et al. Sensitivity analysis To investigate whether HINITE is sensitive to \u03b1, we conducted experiments with different \u03b1 and present the results in Fig re 5. No significant change in performance was observed with different values of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Related work In the literature, efforts have been made to estimate treatm nt ff ct without interference [2,7,11,13,23,24,26,42,43] and with interf rence on homog neous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have co sidered heterogeneous graphs. For example, Qu et al. [20] assu ed a partial interference and could only estimate ATE. Zhao et al. [46] proposed a method to construct a heterogeneous graph from a homogeneous graph by learning a set of weights for each edge using an attention mechanism, but their method cannot capture i terference between multi-view graph structures. We ffer the first approach for handling interference on multi-view graphs. Meanwhile, heterogeneous graphs have been the subject of recent graph analysis studies, focusing on tasks such as ode classification, link prediction, and g a h classification [4,10,14,27,28,38,39,44,45]. The pr pose HINITE shares some sim lar ti ith the heteroge eous graph attention ne work (HAN) [39]. However, HAN aggregates i formatio from each vi w at the e d of forward propagation only once, while the proposed HINITE oes aggreg tion l yer-bylayer, which is ess al for capturing cross-view interference. In addition, we use LeakyRelu (for view-level attention) instead of the tanh function as an activation function to address the vanishing gradient issue, and we use single-head instead of multi-head atte tion for better efficiency.\n6 Conclusion\nIn this paper, we described the problem of heterogeneous interference and the difficulty of treatment effect estimations under heterogene us int rference. This paper proposed HINITE to model the propagation of heterogeneous interf r nce using HIA layers that co tain node-lev l aggregation, view-l v l aggrega ion, and attention echanisms. We n ucted extensiv expe iments to verify th performance of the proposed HINITE, w re the resu ts validate the eff ctiveness of the HINITE in ITE estimation und heter geneous interf rence.\nConcat(u, g) Advertisement HSIC x1 x2 x3 u1 u2\n14 Lin et al. Sensitivity an lysis To nvestigat w ether HINITE is sensitive to \u03b1, we conducted experiments with different \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Related work In the literature, efforts have been made to estimate treatment effect without interference [2,7,11,13,23,24,26,42,43] and with interference on omoge eous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have consid red heterogene us graphs. For example, Qu et al. [20] assum par ial in erference nd could only estimate ATE. Zha et al. [46] proposed a method to construct a heterog neous graph from a homogeneou graph by learnin a set of weigh s for e ch edge using an at ention mec anism, but their m thod cannot capture int rference b t en mul i-view graph structur s. We offe the first approach for ha dling interference on multi-view graphs. Meanwhile, heteroge eous grap s have been the subject of recent graph a alysis studies, focusing on tasks such as node classificat on, link prediction, and graph classification [4,10,1 ,27,28,38,39,44,45]. The proposed HINITE shares some similarities with the heterogeneous graph attention network (HAN) [39]. However, HAN aggregates information from each view at the end of forward propagation only once, while the proposed HINITE does aggregation layer-bylayer, which is esse tial for capturing cross-view i terference. In addition, we use LeakyRelu (for view-level attention) instead of the tan function as an activation functi t address the vanishing gradient issue, and we use single-head instead of multi-head attention for better efficiency.\n6 Conclus on\nIn this paper, we described the problem of het rogen ous interfer nce and the difficulty of treatment effect estimations under heterogeneous i t rference. This paper proposed HINITE t model th propagation of heterogeneous in erference using HIA layers that contain node-level aggreg tion, view-level aggregation, and attention mechanisms. We conducted extensive experiments to verify the performance of the proposed HINITE, where the results validate the effectiveness of the HINITE in ITE estimation under heterogeneous interference.\nConcat(u, g) dvertise ent I\n1\n14 Lin et al. Sensitivity analysis To investigate whether HINITE is sensitive to \u03b1, we conducted experiments with different \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Related work In the literature, efforts have been made to estimate treatment effect without interference [2,7,11,13,23,24,26,42,43] and with interference on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heterogeneous graphs. For xa pl , Qu et al. [20] assu d a partial interference and could o ly estimate ATE. Zh o et al. [46] propos d a method t construct a heterogeneous graph from a ho ogeneous graph by learning a set of weights for each edg using an ttent on m chanism, but their method cannot capture interferenc betw n ulti-vi w graph ructures. W offer the first approach for ha dling interfer nce on ulti-view graphs. Meanwhile, h ro e e us graphs have n th subje f recent graph analysis s dies, focus g on sks such as nod classificatio , link rediction, and raph classification [4,10,14,27,28,38,39,44,45]. T proposed HINITE shares so similariti s wi h the heterogen ous graph attention network (HAN) [39]. However, HAN aggr gates information from c view at the e d of forward propag ti only nce, w le the propo ed HINITE does aggregation layer-byyer, which is ess ntial f r capt ring cross-view i t rference. In addition, we use Le kyRelu (for vi w-l vel i ) instead of the tan fu cti n as an activation function t address the vanishing gradi nt issue, and w use single-head instead of multi-h ad attention for better efficiency. 6 Conclusio\nIn this paper, we described the problem of heterogeneous interference and the diffic lty of treatment effect estimations under heterogeneous interference. This paper proposed HINITE to model the propagation of heterogeneous interference using HIA layers that contain node-level aggregation, view-level aggregation, and att nti mechanis s. We co ucted xt sive exp rim ts to verify the performance of the propos d HINITE, where t results validate th ffectiveness of the HINITE in ITE estimation under heterogen ous interference.\nCo cat(u, g) Adv rtisement HSIC x1 x2 x3 u1 u2\ni st e e l a e\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3\nProject\nHIA Layer\nWz1\nWz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations I terference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer\nNode-Level Attention\nNode-Level Aggregation\nView-Level Attention\nView-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA L yer z1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Rep esentations Interf rence Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) nt ol (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6\novariat s Heterogeneous Edges in v1 Heterog eous Edges in v2 (V ew 1) (View 2)\nCross View Spillover\nCross View Inte ference\nInterfer nce\nSpillover Comput r Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nsti ating reat ent ects nder eterogeneous Interference 15 3 1 2 3 roject I ayer 1 2 3 1\n2\n3 v\u20321 1 v\u20321 2 v\u20322 2 v\u20322 3\novariate e rese tatio s Interfere ce e rese tatio s If t 0 If t 1 fy0 fy1 reate (t 1) o trol (t 0) o- rc ase ra o- ie e ra\novariates eteroge eo s ges i v1 eteroge eo s ges i v2\n( ie 1) ( ie 2)\nross- ie illover ross- ie I terfere ce\nI terfere ce illover\no ter\no e- evel tte tio\no e- evel ggregatio\nie - evel tte tio\nie - evel ggregatio tco e re ictors o se 1 o se 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0\nfy1\nTreated (t = 1)\nC ntrol (t = 0)\nCo-Purchased Graph\nCo-Viewed Graph \u03c8 \u03c6 C variates Heterogeneous Edges in v1 Heterogeneous Ed es i v2 (View 1) (View 2) Cros -View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nsti ti r t t ts r t r s I t rf r\nr j t I r\n\u2032 1 \u2032 1 \u2032 2 \u2032 2\nri t r s t ti s I t rf r r s t ti s If t If t\n0\n1\nr t (t )\no tr l (t )\n- r s r\n- i r\nri t s t r s s i t r s g s in\n( i ) ( i )\nr ss- i ill r r ss- i I t rf r\nI t rf r ill r\nt r - l tt ti - l r ti i - l tt ti i - l r ti t r i t rs s s\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer\nz z z p1 p2 p3\np v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations In erf rence Representations If t = 0 If = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph C -View d Graph \u03c8 \u03c6 Covariates Heterogeneous Edges n v1 Heterogeneous Edg s in v2 (View 1) (View 2) Cross-View Spillover\nCross-View Interference\nInterf r nce\nSpillover\nmputer N de-L l Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Ou come Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference\nInterference\nSpillover\nComputer\nNode-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\n14 Lin et al. Sensitivity analysis To investigate whether HINITE is sensitive to \u03b1, we conducted experiments wi different \u03b1 and pres nt the r sults in Figure 5. No significant change in performance was observed with different values of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Relate work In the literature, efforts have been made to estimate treatment effect without interference [2,7,11,13,23,24,26,42,43] and with int rference on homogeneous graphs [1,3,9,15,17,32, 3,36] or hyper-graphs [16]. A few studies have considered heterogeneous graphs. For example, Qu e al. [20] assumed a partial interference nd could only estimat ATE. Zhao et al. [46] propos d a method to construct a he erogeneous g aph from a hom geneous graph by learning a set of weights for each edge using an at ention m chanis , but th ir met od cannot capture i terfere ce b tween multi-view gr ph s ructures. We offer he first approach for ha dling int rference on m lti-view graphs. Meanwhil , heterogene us gr phs have bee he subject of recent graph analysis studies, foc i g on tasks such as node classification, link prediction, and graph clas ification [4,10,14,27,28,38,39,44,45]. T propose HINITE shares some similarities with the heterog ne us graph attention network (HAN) [39]. H we er, HAN aggregates information from each view at the end of forward propag tion only once, while the p oposed HINITE does aggregation layer-bylayer, which is essenti l fo ca uri g cross-view interf rence. In addition, we use LeakyRelu (for view-level attention) instead of the tanh fu ction as an activation functi n to address th vanishing gradient issue, and we use single-head instead of multi-head attention for better efficien y. 6 C clusio In this paper, we described the problem of heterogeneous interference and the difficulty of r atment effect stimations under heterogeneous interference. This paper proposed HINITE to mod l the propagation of heterogeneous interference using HIA layers that cont in ode-level aggregation, vi w-level aggregation, and attention echanisms. We conduct d extensive xperiments to verify the performance of the propos d HINITE, wher the results validat the effectiveness f th HINITE i ITE estimation nd r heterogen ous interference.\nConc t(u, g) Adv rtisement HSIC x1 x2 x3 u1 u2\n14 Lin et al. Se sitivity analysis To investigate whether HINITE is sensitive to \u03b1, we conducted experiments with different \u03b1 and present the results in Figure 5. No significant change in performa ce w s obse ved with different l s of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Relat work In the li eratur , efforts ha e been made to estimate treatment ffect withut inte ference [2 7 1 3 23 24 2 ,42,43] and wit interference on homogeneous g aphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies h ve consider d hete ogeneous graphs. For example, Qu et al. [20] assumed a partial interference and could only stimate ATE. Zhao t al. [46] pr pose a method to cons ruct a heter geneous graph f om a ho ogen ous gr ph by learning a set of weights for each dg using a attention m chanism, but h ir method cannot captu e interf ence between ulti-view graph structures. We ffer the first approach for h ndling int rferenc on mul i-view r s. Meanwh le, het r geneous graphs have been h subjec of rece t graph analysis studies, focus ng on task such as n e classifi tion, link prediction, and graph class fication [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares some similarities with the heteroge eous graph attention n twork (HAN) [39]. owever, HAN aggregates i formation from each view at th end of forward propag tion only onc while the prop sed HINITE does aggregatio layer-bylayer, which is ssential fo capturing cr s-vi w interfer ce. In add tion, we use L akyRelu (f view-level at ention) i stead of the ta h function as a activation function to addr ss the vanishing gradie t issue, and we use single-head instead of multi-head attenti n for better efficiency. 6 Concl sion\nIn this paper, we describ d the proble of heterogeneous interference and the difficulty of treatment effect estimations under heteroge eous interf r nce. This paper proposed HINITE o model the pr pagation of heterogeneous interferenc using HIA lay rs that conta n nod -level aggregation, vi w-level aggregation, and attention echanisms. W co ducted e nsiv experime ts to verify the\nrforma c of th proposed HINITE, wh r the results validate the ff ctiveness of th HINITE in ITE stimation u der h te geneous interference.\nConcat(u, g) Adv rtisement HSIC x1 x2 x3 u1 u2\n14 Lin et al. S nsitivity an lysis To investigate whether HINITE is sensitive to \u03b1, w c nducted experiments with different \u03b1 and pr sent he r ults in Figure 5. No significant change in perf rm nce w s observed with differe t values of \u03b1. This reveals that HINITE is not par icularly sen itive to the value of \u03b1. 5 Relat d work In the literature, efforts have been mad to estimate treatme t ffect without interference [2,7,11,13,23,24,26,42,43] and with interferenc on homogen ous graphs [1,3,9,15,17,32,33,36] or hyper-gr phs 16 . A few studies h v consid red heter gen us raphs. For xample, Qu et al. [20] assumed a partial interf ren e nd could only stimat ATE. Z a et al. [46] prop sed a method o construct a h te o n o grap from a o ogeneous grap by l ar ing a set of weights for ac e ge usi g an a t ntion mech nism, bu thei m t od cannot c pture nterfe ence bet e n multi-view graph structure . We off r the first approach for andling interf r nce n lti-view gr p s. Meanwhile, h terogeneous gr p s have b en he subject of ecent graph analysis s udie , focusing on asks uch as nod cl s ific ti n, link pr diction, nd graph clas ification [4,10,14,27,28,38,39,44,45]. Th roposed HINITE shares som similariti with th het g ne us graph a tention etwork (HAN) [39]. H wever, HAN aggregates inform tion from each view at th end of forward propagat on on y once, whil the prop ed I I does aggr ga layer-bylay , whi h is ess ntial f r capturing cross-vi w in erf re ce. In addition, w use LeakyRelu (for view-lev l te ion) instead of th ta h functio as n activation function o add ess h v nish g grad t issue, and we use single-head instead of multi-head att ntion for better efficiency. 6 Conclusion\nIn this paper, we d scribed the problem of hetero e eous i terf ence and he difficulty of treat ent effect estimations und r het rog ne us int rference. This pape propos d HINITE to model the pr p a ion of h tero neous interference using HIA lay rs tha contain n de-lev l a gr ga ion, view-level aggregation, and ti n mechan sms. We co du ted ext ns v exp rim s to verify the performance f the pr pose HINITE where th result validate th effectiveness f th HINITE i ITE estimation und r het rogeneous in erference.\nConcat(u, g) Adv tisem nt HSIC 1\n2\nx3 1\nu2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covaria e Represen ati ns Interference R pr sentatio s If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2)\nCross-View Spillover\nCross-View Interference\nInterference\nSpillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2\ng3\nProject\nHIA Layer\nWz1 Wz2 Wz3 Wp1 Wp2 Wp3\np v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates H terogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover C mputer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer\nWz1\nWz2\nWz3\nWp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEsti ating Treat ent Effects nder eterogeneous Interference 15\nu3 g1 g2 g3 Project\nI Layer z1\nz2\nz3\np1 p2 p3\np v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\novariate epresentations Interference epresentations If t 0 If t 1 fy0 fy1 reated (t 1) ontrol (t 0) o-Purchased raph o- ie ed raph\n\u03c8 \u03c6\novariates eterogeneous Edges in v1 eterogeneous Edges in v2\n( ie 1) ( ie 2)\nross- ie Spillover ross- ie Interference\nInterference Spillover\no puter ode-Level ttention ode-Level ggregation ie -Level ttention ie -Level ggregation utco e Predictors ouse 1 ouse 2\nEstimating reatment Effects Under Heterogeneous Interference 15\n3 g1 g2 g3\nroject HIA Layer Wz1\nWz2\nWz3\nWp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co- urchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous dges in v1 Heterogeneous dges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome redictors Mouse 1 Mouse 2\nEs tim\nat ing\nTr ea tm en t E ffe cts Un de r H ete ro ge ne ou s I nt erf ere nc e 15\nu 3 g 1 g 2 g 3\nPr oje\nct\nHI A\nLa er\nW z 1\nW z 2\nW z 3\nW p 1\nW p 2\nW p 3\np v \u2032 1 1\np v \u2032 1 2\np v \u2032 2 2\np v \u2032 2 3\nCo va\nria te\nRe pr\nese nt ati\no s\nInt erf\nere nc\ne R ep\nres en\ntat on\ns\nIf t =\n0\nIf t =\n1\nf y0\nf y1 Tr ea\nted (t = 1)\nCo nt rol\nt = 0)\nCo -P\nur ch\nase d G\nrap h\nCo -V\niew ed\nGr ap\nh\n\u03c8\n\u03c6\nCo va\nria tes\nHe ter\nog\nen\neo us\nEd ge\ns i n v\n1\nHe ter\nog ne\nou s E\ndg es\nin v 2\n(V\niew\n1)\n(V iew\n2)\nCr oss\n-V\niew\nSp illo\nve r\nCr oss\n-V iew\nInt\nerf\nere nc\ne\nInt erf\nere nc\ne\nSp illo\nve r Co mp ut er\nNo de\n-L ev\nel At\nten tio\nn\nNo de\n-L ev\nel Ag\ngre ga\ntio n\nVi ew\n-L ev\nel At\nten tio\nn\nVi ew\n-L ev\nel Ag\ngre ga\ntio n\nOu tco\nme Pr\ned ict\nors\nM ou\nse 1\nM ou\nse 2\nEstimating Treatment Effects Under Heterogeneous Interference\n15\nu 3g\n1g 2g\n3Project HIA L\nyer\nW z 1\nW z 2\nW z 3\nW p 1\nW p 2\nW p 3\np v \u2032 11p v \u2032\n12p v \u2032 22p v \u2032\n23Covariate Representations\nInterference Representations\nIf t = 0 If t = 1 f y 0f y 1Treated (t =\n1)\nControl (t =\n0)\nCo-Purchased\nGraph\nCo-Viewed\nGraph\n\u03c8\n\u03c6\nCovariates\nHeterogeneous Edges in\nv 1\nHeterogen\nous Edges in\nv 2\n(View 1)\n(View 2)\nCross-View Spillover Cross-View Interference Interference Spillover Computer\nNode-Level Attention Node-Level Aggregation View-Level Attention\nView-Level Aggregation Outcome Predictors M ouse 1 M ouse 2\nEstimating T eatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 W 1 W 2 Wp3 p \u2032 1\n1\np v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference R presentations If t = 0 If t = 1 fy0 fy1 Treated (t 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8\n\u03c6\nCovariates\nHeterogeneous Edges i v1\nHeterogeneous E ges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Int rf renc Interference Spillover Computer Node-Level Att tion Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimati g Tr atment Effects Under Heterogeneous Interference 15 u3 1\ng2 g3 Project HIA Layer\n1 z2 z3 1 Wp2 Wp3 p \u2032 1\n1\np v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations n erference Representations If t = 0 If t = 1 fy0 f 1 Treated (t = 1)\nntrol (t = 0) Co-Purchased Graph\nCo-Viewed Graph\n\u03c8\n\u03c6\nCova iates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover C mputer Node Node View-Level Att ntion View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\n14 Lin et al. Sensitivity analysis To investig te whether HINITE is nsitive to \u03b1, w conducted xperiments with different \u03b1 and present the results in Figure 5. No significant change in perform nce was observed with different values of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Related work In the literature, efforts have been made to estimate treatment effect without interference [2,7,11 13,2 ,24,26, 2,43] and with interference on homo eneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heteroge eous gr phs. For ex mple, Qu et al. [20] assumed a partial interfer nce and co d only estimat ATE. Zhao et al. [46] proposed a method to construct a heterogene us graph from a homoge eous graph by learning a set of weights for each edge using an attentio mechanism, but their method cannot capt re interference between multi-view graph structures. We offer the first approach for handl ng terfe ence on multi-view graphs.\nMeanwhile, heterogeneous graphs have been the subject of recent graph analysis studies, focusing on tasks such as node classification, link prediction, and graph classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares some similarities with the h erogeneous g aph att n ion network (HAN) [39]. However, HAN aggregates information from each view at the end of forward propagation only once, while th propos d HINITE does aggregation layer-bylayer, which is essential for ca turing cross-view interference. In addition, we use LeakyRelu (for view-lev l a tenti n) instead of the tanh function as an activation functi n to address the vanishing gradient issue, and w us si gl -head instead of multi-head att ntion for better efficie cy.\n6 Conclusion\nIn this paper, we d scribed the problem of heterog eous int rf ence and the diffic lty of treatment effect estimations under heterogeneous interference. This paper proposed HINITE to model the propagation of heterog neous i rferenc using HIA layers that contain node-level aggregation, vi w-level aggregation, and attention mechanisms. We conducted extensive experiments to verify the performance of the proposed HINITE, where th re ults validat the effectiveness of the HINITE in ITE estimation under heteroge eous interference.\nConcat(u, g) Advertisement HSIC x1 x2 x3\nu1\nu2\n14 Lin et al. Sensitivity nalysis To invest gate whether HINITE is sensitive to \u03b1, we conducted experim nts with differe t \u03b1 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b1. This reveals that HINITE is not particularly sensitive to the value of \u03b1. 5 Relat d work In the lit ratur , efforts have been made to estimate treatment effect without nterference [2,7,11,13,23,24,26,42,43] and with interference on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heterogeneous graphs. For example, Qu et al. [20] assumed a partial interference and could only estimate ATE. Zhao et al. [46] proposed a method to construct a heterogeneous graph from homogeneous gr ph by le rning a s t of weights for ch dge usi g an t en io m c nism, b t the r m t od ca not capture interference betw multi-view graph structur s. We offer t first approach for ha dling interference on multi-view graphs.\nMeanwhile, heterogeneous graph have been the subject of recent graph analysis studies, focusing on ta ks such as node classification, link prediction, and graph classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares ome imilarities with the heteroge eous graph attention network (HAN) [39]. However, HAN aggregates information from each view at the end of forward pr pagation only once, while the proposed HINITE does aggregation layer-bylayer, which is essential for capturing cross-view interference. In addition, we use LeakyRelu (for view-level attention) instead of the tanh function as an activation fu c io to add ess the va ishi g rad e t issue, a d w use singl -head instead f multi-head atte ion for b tter efficiency.\n6 C nclusion\nIn this paper, we d scribed th problem of heterogeneous interference and the difficulty of treatme t effect estimations under heterogeneous interference. This paper proposed HINITE to model the propagation of heterogeneous interference using HIA layers that contain node-level aggregation, view-level aggregation, and attention mechanisms. We conduct d extensive experiments to verify the performance of the proposed HINITE, where the results validate the effectiveness of the HINITE in ITE estimation und r heterogeneous interference.\nConcat(u, g) Advertisem nt HSIC x1\nx2\nx3\nu1 u2\n2 F. Auth r et l. Table 1. Table captions should be placed above the tables. Head g level Exa ple Font size an style Title (center d) L cture Not s 14 point, bold 1st-level heading 1 Introduction 12 point, bold 2nd-level heading 2.1 Printing Area 10 point, bold 3r -l vel heading Run-i Heading in Bold. Text follows 10 point, bold 4th-level heading Lowest Level Heading. Text follows 10 point, italic\nFig. 1. A figure c tion is always placed below the illustration. Please note that hort captions are centered, wh le long ones are justified by the macro package auto atically.\nProof. Proofs, examples, an remarks have the initial word in italics, whil the following text ppears in ormal font.\nFor citations of r ferences, we prefer he use f squar brackets a d consecutive numbers. Citations usi g labels or the author/year convention are also acceptable. The following bibliography provides a sample refe nce li t with entries for journal articles [ ], an LNCS chapter [2], a book [3], proce dings without editors [4], and a homepage [5]. Mul iple citation ar group d [1\u20133], [1, 3\u20135].\nAcknowledgements Please place your acknowledgments at the end of the paper, preceded by an unnumbered run-in heading (i.e. 3rd-level heading).\nConfounder Addressi g I terference Modeling Outcome Prediction\nReferences\n1. Author, F.: Article title. Journal 2(5), 99\u2013110 (2016) 2. Author, F., Author, S.: Title of a proceedings paper. In: Editor, F., Editor, S.\n(eds.) CONFERENCE 2016, LNCS, vol. 9999, pp. 1\u201313. Spring , Heidelberg (2016). https://doi.org/10.10007/1234567890\n2 F. Auth r et al. Table 1. Table c ptions should be placed above the tables. Heading level Example Font size and style Titl (centered) Lect No es 14 point, bold 1st-level heading 1 Introduction 12 point, bold 2nd-level heading 2.1 Printing Ar a 10 poi t, b ld 3rd-level heading Run-in Heading in Bold. Text follows 10 point, bold 4th-level heading Lowest Level Heading. Text follows 10 point, italic\nFig. 1. A figure caption is always placed below the llustration. Please note that short ptions are centered, while long ones are justified by the macro package automatically.\nProof. Proofs, examples and remark have the initi l wo d in italic , while the following t xt appears in or al fo .\nFor citations of references, we prefer the use of square bracke s and consecutive numbers. Citati s using lab ls or the author/year convention a als acceptable. The following bibliography provides a sample reference list with entries f r jo rnal article [1], an LNCS chapter [2], a book [3], proce di gs without editors [4], and a home age [5]. Mul iple citations a e grouped [1\u20133], [1, 3\u20135].\nAckno ledgements Pl as place y ur cknowl dgme s at th d of the paper, preceded by an unnumbered run-in heading (i.e. 3rd-level heading).\nConfo der Ad ressing Interference Modeling Outcome Prediction\nReferences\n1. Author, F.: Article title. Journal 2(5), 99\u2013110 (2016) 2. Author, F., Author, S.: Title of a proceedings paper. In: Editor, F., Edito , S.\n(eds.) CONFERENCE 2016, LN S, vol. 9999, pp. 1\u201313. Springer, Heidelberg (2016). https://doi.org/10 10007/1234567890\n2 F. Author et al. Table 1. Table captions should be pla ed ab ve the tables. Heading level Exa le Font size and style Title (center d) L ctu e Notes 14 poin , bold 1st-level h ading 1 I troduction 12 point, bold 2nd-level heading 2.1 Printing Area 10 point, bold 3rd-level headin Run-in Heading in Bold. Tex f llows 10 point, bold 4th-level heading Lowest Level Heading. Text follows 10 point, italic\nFig. 1. A figure caption is always placed below the illustration. Please note that short capt ons are centered, while long es are justifi d by the macro package aut matically.\nProof. Proofs, examples, and remarks have the initial word in italics, while the following text ppears i no mal fo t.\nFor citations of r ferences, we prefer the use of square brackets and consecutive umbers. Citations using labels or the auth r/year convention are also acceptable. The followi g bibliography rovid a sample ef r ce list with ntries fo journal articles [1], an LNCS chapter [2], a book [3], proceedings without editors [4], nd a omepage [5]. Multiple citations ar grouped [1\u20133], [1, 3\u20135].\nAcknowledgemen Please place your acknowl dgments at the end of the p per, pr ceded by an unnumber d run-in heading (i.e. 3rd-level heading).\nConfound r A dressing Interference Modeling Outcome Prediction\nR f rences\n1. Author, F.: Article title. Journal 2(5), 99\u2013110 (2016) 2. Author, F., Author, S.: Title of a proce dings paper. In: Editor, F., Editor, S.\n(eds.) CONFERENCE 2016, LNCS, vol. 9999, pp. 1\u201313. Springer, Heidelberg (2016). https://d i.org/10.10007/1234567890\nFig. 2: An example of the model architecture of HINITE. In this cas , he e are two views, i.e., v1 and v2.\n3.1 Learning Balanced Covariate Repr sentation\nTo address the imbalance in distribu ions of different treatm nt gr ups caused by confounders, HINITE learns balanced covariate representati ns using an existing approach [17]. The key idea is to find a representation space in which the treatment assignments and covariate representations b come approximately independent [17]. This goal can be achieved by applying the HSIC regularization [6], which is an independe ce test criterion of two random variables. The value of HSIC is 0 when two random variables are independent. Thus, minimizing the HSIC can achieve the abovementioned goal.\nSpecifically, we learn a balanced covariate representation ui for the xi using a map function \u03d5 that consists of multiple feed-forward (FF) layers, i.e., ui = \u03d5(xi), resulting in covariate representations for all units, denoted as U. We train \u03d5 by minimizing the HSIC between u and t, which is denoted as HSIC\u03d5 and designed as follows:\nHSIC\u03d5(U,T) = 1\nN2 tr(KMLM), M = IN \u2212\n1\nN 1N1\n\u22a4 N , (2)\nwhere N is the number of training unit , \u00b7\u22a4 re res nts the transposition operation, IN is the identity matrix, and 1N s the v ctor of all ones. K and L represent the Gaussian kernel applied to U a d T, respectively, i.e.,\nKij = exp\n( \u2212\u2225ui \u2212 uj\u2225 2 2\n2\n) , ij = exp ( \u2212 (ti \u2212 tj) 2\n2\n) . (3)\n3.2 Learning Heterogeneous Interference Representations\nTo properly model heterogeneous interference, it is necessary to capture both same-view and cross-view interference. To this end, we model the propagation of the same-view and cross-view interference. Inspired by Wang et al. [39], we design an HIA layer, as shown in Figure 3, which contains node-level and view-level aggregation mechanisms. The node-level aggregation mechanism aggregates sameview interference received by units. It utilizes m single-layered GNNs [12,35] to perform aggregations within each view. The view-level aggregation mechanism\nEstimating Treatment Effects Under Heterogeneous Interference 7\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations\nInterference Representations\nIf t = 0\nIf t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1\nTreated (t = 1)\nControl (t = 0)\nCo-Purchased Graph\nCo-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3\n\u2032 1 1\u2032 1\n\u2032 2\n2\np v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0\nfy1\nTreated (t = 1)\nControl (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nsti ti re t e t ects er eter e e s I terfere ce\n3\n1\n2\n3 r j t I r\n1\n2\n3\n1\n2\n3\np v\u20321 1 p v\u20321 2 p v\u20322 2 v\u20322 3\nri t r s t ti s I t rf r r s t ti s If t If t y0\ny1\nr t (t )\ntr l (t )\n- r s r - i r\nri t s t r s s i 1 t r s s i 2\n( i ) ( i )\nr ss- i ill r r ss- i I t rf r\nI t rf r ill r\nt r - l tt ti - l r ti i - l tt ti i - l r ti t r i t rs s s\nEstimating Tr atment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer\nz1 z2 z3 Wp1 Wp2 Wp3\n\u2032\n1\u2032 1\np \u2032\n2\np v\u20322 3 Covariate Representations Interference Representations If t = 0\nIf t = 1\nfy0\nfy1\nTreated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level ttention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Hete geneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1\nfy0\nfy1\nTreated (t = 1)\nControl (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0\nIf t = 1\nfy0\nfy1\nTreated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer z1 z2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations\nInterference Representations\nIf t = 0\nIf t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) -Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edg s in v2 (Vi w 1) (V ew 2)\nross-View Spillover Cross-View Interfere ce Interfer nce Spillover Computer Node-Level Attention N de-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer\nz1 z2 Wz3 Wp1 Wp2 Wp3 v\u20321 1 p v\u20321 2 p v\u20322 2\np\nv\u20322\n3\nCovariate Representations\nInterference Representations\nIf t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0)\no-Purchased Graph Co-View d Graph \u03c8 \u03c6 Covariates Heterogeneous Edg s in v1 Heterogeneous Edges in v2 (Vi w 1) (View 2)\nross-Vi w Spillover Cross-View Interfere ce Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimati atment Effects Under Heterogeneous Interfere ce 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference R presentations If t = 0\nIf t = 1\nfy0\nfy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Int rf r nce Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0\nIf t = 1\nfy0\nfy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edg s in v1 Heterogeneous Edg s in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outco e Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 W 3 p v\u20321 1 p v\u20321 2 p v\u20322 2\np\nv\u20322\n3\nCovariate Representations\nInterference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edge in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interfer nce Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heter geneous Interf rence 15 u3 g1 g2 g3 Project HIA Layer z1 z2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2\np\nv\u20322\n3\nCovariate R presentations\nInterf rence R presentations If t = 0 If t = 1 fy0 fy1 Trea ed (t = 1) Con ol (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edg s in v2 (View 1) (View 2) Cross-View Spi lo Cross-View Interf rence Interf rence Spillover Computer Node-Level Attention Node-Level Aggregation Vi w-Level Attention Vi w-Level Aggregation Outcom Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321\n1\np\nv\u20321\n2\np\nv\u20322\n2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1\np\nv\u20321\n2\np\nv\u20322\n2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 1\n2\ng3 Project HIA Layer\n1\n2\nz3 1\n2\nWp3\np\nv\u20321\n1\np\nv\u20321\n2 p v\u20322 2 p v\u20322 3 Covariate Repres nta ions n erference Representations\n0 If t = 1\n0\nfy1 Treated 1\nntrol (t = 0) Purchased Graph\nCo-Viewed Graph \u03c8 \u03c6 Covariates\n1\nHeterogeneous Edges in v2 1\n(View 2) Spillover\nCross-View Interference Interference Spillover C mputer\nttention Node- l ggregation\nttention View-Level Aggregation Outcome Predictors\n1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15\nu3 g1 g2 g3 Project HIA Layer\nz1 z2 z3 p1 p2 p3\np\nv\u20321\n1\np\nv\u20321\n2\np v\u20322 2 p v\u20322 3 Covariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Co puter Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outco e Predictors\nouse 1 ouse 2\n16 Lin et al.\nMultiply Treatment Assignment\nAcknowledgements\nThis work was supported by JST, the establishment of university fellowships towards the creation of science technology innovation, Grant Number JPMJFS2123, and supported by JSPS KAKENHI Grant Number 20H04244.\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-Vi w Interference Interference Spillover Comput r No e-Lev l Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mous 2\nEstimating Treatment Effects Under Heterog neous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCov riate Representations Int rference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillov r C oss-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation V ew-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interfere ce Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Het rogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interfer nce Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer z1 z2 Wz3 Wp1 Wp2 Wp3 \u2032 1 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Tre ted (t = 1) Control (t = 0) Co-Purchased Graph Co-Vi wed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heter g neous Edg s in v2 (View 1) (View 2) Cross-View Spillover Cross-Vi w Interfer ce Interference Spillov r Computer Node-Level Attention Node-Lev l Aggregation View-Level Attenti n View-Level Aggregation Outcome Predictors Mouse 1\nMous 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer z1 z2 Wz3 Wp1 Wp2 Wp3 \u2032 1 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edge in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interferenc Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention Vi w-L vel Aggregation Outcome Predictors\nMouse 1\nMouse 2\nEstimating Treatment Effects Under Heterog neous Interference 15 u3 g1 g2 g3 Project HIA Layer z1 z2 Wz3 Wp1 Wp2 Wp3 1 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCov riate Representations Int rference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover C oss-View Interference Inte ference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1\nMouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer z1 z2 Wz3 Wp1 Wp2 Wp3 1 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interfere ce Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogen ous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attentio Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors Mouse 1\nMouse 2\nE stim ating T reatm ent\nE\nffects\nU nder H eterogeneous Interference\n15\nu 3 g 1 g 2 g 3 P roject H IA Layer W z 1 W z 2 W z 3 W p 1 W p 2 W p 3 p v \u20321 1 p v \u20321 2 p v \u20322 2 p v \u20322 3 C ovariate R epresentations Interference R epresentations If t = 0 If t = 1 f y 0 f y 1 T reated (t = 1) C ontrol(t = 0) C o-P urchased G raph C o-V iew ed G raph \u03c8\u03c6C ovariates H eterogeneous E dges in v 1 H eterogeneous E dges in v 2 (V iew 1) (V iew 2) C ross-V iew Spillover C ross-V iew Interference Interference Spillover C om puter N ode-LevelA ttention N ode-LevelA ggregation V iew -LevelA ttention V iew -LevelA ggregation O utcom e P redictors M ouse 1 M ouse 2\nE stim ating\nT\nreatm\nent E ffects U nder H eterogeneous Interference\n15\nu 3 g 1 g 2 g 3 P roject H IA Layer W z 1 W z 2 W z 3 W p 1 W p 2 W p 3 p v \u20321 1 p v \u20321 2 p v \u20322 2 p v \u20322 3 C ovariate R\nepresentations Interference R epresentations If t = 0 If t = 1 f y 0 f y 1 T reated (t = 1) C ontrol(t = 0) C o-P urchased G raph C o-V iew ed G raph \u03c8\u03c6C ovariates H eterogeneous E dges in v 1 H eterogeneous E dges in v 2 (V iew 1) (V iew 2) C ross-V iew Spillover C ross-V iew Interference Interference Spillover C om puter N ode-LevelA ttention N ode-LevelA ggregation V iew -LevelA ttention V iew -LevelA ggregation O utcom e P redictors M ouse 1 M ouse 2\nE stim ating T reatm\nent\nE\nffects\nU nder H eterogeneous Interference\n15\nu 3 g 1 g 2 g 3 P roject H IA Layer W z 1 W z 2 W z 3 W p 1 W p 2 W p 3 p v \u20321 1 p v \u20321 2 p v \u20322 2 p v \u20322 3 C ovariate R epresentations Interference R epresentations If t = 0 If t = 1 f y 0 f y 1 T reated (t = 1) C ontrol(t = 0) C o-P urchased G raph C o-V iew ed G raph \u03c8\u03c6C ovariates H eterogeneous E dges in v 1 H eterogeneous E dges in v 2 (V iew 1) (V iew 2) C ross-V iew Spillover C ross-V iew Interference Interference Spillover C om puter N ode-LevelA ttention N ode-LevelA ggregation V iew -LevelA ttention V iew -LevelA ggregation O utcom e P redictors M ouse 1 M ouse 2\nE stim ating\nT\nreatm\nent E ffects U nder H eterogeneous Interference\n15\nu 3 g 1 g 2 g 3 P roject H IA Layer W z 1 W z 2 W z 3 W p 1 W p 2 W p 3 p v \u20321 1 p v \u20321 2 p v \u20322 2 p v \u20322 3 C ovariate R\nepresentations\nInterference R\nepresentations\nIf t = 0 If t = 1 f y 0 f y 1 T reated (t = 1) C ontrol(t = 0) C o-P urchased G\nraph\nC o-V iew ed G raph \u03c8\u03c6C ovariates H eterogeneous E dges in v 1 H eterogeneous E dges in v 2 (V iew 1) (V iew 2) C ross-V iew Spillover C ross-V iew Interference Interference Spillover C om puter N ode-LevelA ttention N ode-LevelA ggregation V iew -LevelA ttention V iew -LevelA ggregation O utcom e P redictors M ouse 1 M ouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Vi wed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-Level Aggregation Outcome Predictors M u e 1 Mouse 2\nEstimating Treatment Effects Under Heterogeneous Interference 15 u3 g1 g2 g3 Project HIA Layer Wz1 Wz2 Wz3 Wp1 Wp2 Wp3 p v\u20321 1 p v\u20321 2 p v\u20322 2 p v\u20322 3\nCovariate Representations Interference Representations If t = 0 If t = 1 fy0 fy1 Treated (t = 1) Control (t = 0) Co-Purchased Graph Co-Viewed Graph \u03c8 \u03c6 Covariates Heterogeneous Edges in v1 Heterogeneous Edges in v2 (View 1) (View 2) Cross-View Spillover Cross-View Interference Interference Spillover Computer Node-Level Attention Node-Level Aggregation View-Level Attention View-L vel Aggregation Outcome Predictors Mouse 1 Mouse 2\nE stim ating T reatm ent E ffects U nder H eterogeneous Interference\n15\nu 3 g 1 g 2 g 3 P roject H IA Layer W z 1 W z 2 W z 3 W p 1 W p 2 W p 3 p v \u20321 1 p v \u20321 2 p v \u20322 2 p v \u20322 3 C ovariate R epresentations Interference R epresentations If t = 0 If t = 1 f y 0 f y 1 T reated (t = 1) C ontrol(t = 0) C o-P urchased G raph C o-V iew ed G raph \u03c8\u03c6C ovariates\nH eterogeneous E dges in v\n1\nH eterogeneous E dges in v\n2\n(V iew 1) (V iew 2) C ross-V iew Spillover C ross-V iew Interference Interference Spillover C om puter N ode-LevelA ttention N ode-LevelA ggregation V iew -LevelA ttention V iew -LevelA ggregation O utcom e P redictors M ouse 1 M ouse 2\nE stim\nating T reatm\nent E\nffects U\nnder H\neterogeneous Interference\n15\nu 3 g 1 g 2 g 3 P roject H IA Layer W z 1 W z 2 W z 3 W p 1 W p 2 W p 3 p v \u20321 1 p v \u20321 2 p v \u20322 2 p v \u20322 3 C ovariate\nR epresentations\nInterference R epresentations If t = 0 If t = 1 f y 0 f y 1 T reated (t = 1) C ontrol(t = 0) C o-P urchased G raph C o-V iew ed G raph \u03c8\u03c6C ovariates H eterogeneous E dges in v 1 H eterogeneous E dges in v 2 (V iew 1) (V iew 2) C ross-V iew Spillover C ross-V iew Interference Interference Spillover C om puter N ode-LevelA ttention N ode-LevelA ggregation V iew -LevelA ttention V iew -LevelA ggregation O utcom e P redictors M ouse 1 M ouse 2\nFig. 3: The architecture of the HIA layer. This layer consists of node-level and view-level aggr gation m ch nisms with their attention mechanisms.\ncombines (i.e., sums up) the results aggregated by the node-level aggregations to g nerate new representations of units. Therefore, by employing an HIA laye , uni s r able to aggregate interference received from their one-hop heterogeneous neighbors. This enables capturing cross-view interference by stacking HIA layers. Similarly, same-view interference from multi-hop neighbors can also be captur d by stacking HIA layers.\nConsider again the co-purchased and co-view d graphs in Figure 1b. Suppose that w fe d units and their co-purchased and co-viewed graphs to a network stacked by two HIA layers. For the Mouse 1, th first HIA layer perf rms two od -l v l aggregations. One aggregation hel s the Mouse 1 aggregate interfer-\nence ithin the co-purchased graph, while the oth r helps the Mouse 1 aggregate interference within he co-viewed graph, resulting in two aggregated results. Then, the view-lev l aggregation mechanism combines th se results obtained by node-lev l aggregations to generate the Mouse 1\u2019s n w represe tation, while updating th new represe tation in all views. This enables the Mouse 1 to aggregate interfer nce from the Computer. Similarly, the first HIA layer also generates new representations for o her units. Then, by taking these new representations f all units as inputs of the second HIA layer, the second HIA layer enables the Mouse 2 to capture interference from the Mouse 1, which contains interference from the Computer. Therefore, the cross-view interference from the Computer to the\nouse 2 can be captured by stacking two HIA layers. Apart from cross-view interference, another challenge is that the importance\nof edges and views may differ in heterogeneous graphs [39]. For example, in a co-viewed graph, the importance of products in the same category tends to be higher than that of products in different categories. Here, the weights of edg s in the same view can be different. Furthermore, a co-purchased graph may ha e more significant importance than a co-viewed graph in terms of interference, leading to different importance for each view. To overcome these difficulties and properly model the propagation of interference, we infer different weights for every edge via a graph attention mechanism [35] (called node-level attention)\n8 X. Lin et al.\nbefore node-level aggregations, and learn different importance for every view via an attention mechanism [34,39] (called view-level attention) before view-level aggregations.\nMore specifically, given covariate representations U, treatment assignments T, and structures of heterogeneous graphs H, we aim to obtain interference representations G using a function \u03c8 that consists of multiple HIA layers, i.e., G = \u03c8(U,T,H). For a unit i, its interference representation gi is supposed to capture the interference from its heterogeneous neighbors. Let p be a representation of a unit, which is the input of the current HIA layer and the output of the previous HIA layer. For the first HIA layer, p is the concatenation of u and t. Let z denote a new representation for the unit i computed by the current HIA layer, \u03b1vij denote the inferred weight of the edge between units j and i at the v-th view, wvi denote the learned importance of the v-th view for the unit i, and \u03b2vi denote the normalized value for wvi .\nNow, we describe the architecture of the HIA layer in detail. First, the HIA layer infers the edge weight \u03b1vij by the node-level attention mechanism as follows:\n\u03b1vij = exp(LeakyReLU(a\u22a4[Wpi\u2225Wpj ]))\u2211\nk\u2208Nvi \u22c3 {i} exp(LeakyReLU(a \u22a4[Wpi\u2225Wpk])) , (4)\nwhere a and W represent a learnable parameter vector and matrix, respectively, and \u2225 represents the concatenation operation. Next, it performs node-level aggregations. The node-level aggregation at the v-th view is computed as follows:\npv \u2032\ni = \u03c3  \u2211 j\u2208Nvi \u22c3 {i} \u03b1vijWpj  , (5) where \u03c3 is an activation function, such as ReLU. Next, the view-attention mechanism is applied to learn the importance of different views as follows:\nwvi = 1\nn n\u2211 i=1 q\u22a4LeakyReLU(Wpv \u2032 i + b), \u03b2 v i = exp (wvi )\u2211m v=1 exp (w v i ) , (6)\nwhere b is a bias vector, and q is a learnable parameter vector. Finally, the viewlevel aggregation is applied to aggregate the information from different views as follows:\nzi = m\u2211 v=1 \u03b2vi p v\u2032 i . (7)\n3.3 Outcome Predictions and ITE estimation\nGiven the covariate representations U, interference representations G, and treatment assignments T, we train two predictors that consist of multiple FF layers to infer the outcomes with different t. Specifically, let fy0 and fy1 denote the predictor for t = 0 and t = 1, respectively. We optimize the two predictors by\nEstimating Treatment Effects Under Heterogeneous Interference 9\nminimizing the following mean square error (MSE) between prediction outcomes and observed outcomes with the HSIC regularization:\nL = 1 N N\u2211 i=1 ( fyti (ui, gi)\u2212 yi )2 + \u03b3HSIC\u03d5, (8)\nwhere the \u03b3 is a regularization hyperparameter. Finally, we can estimate the ITE using \u03c4\u0302i = fy1(ui, gi)\u2212 fy0(ui, gi).\n4 Experiments\n4.1 Datasets\nWe used three heterogeneous graph datasets: Amazon Software (AMZ S) [8], Youtube [31], and Flicker [40]. Following prior studies on ITE/ATE [17,16,26], we simulated outcomes3 as the ground-truth values for counterfactual outcomes are not available. Outcome Simulation: Similar to the outcome simulation in Ma et al. [16], we used available data and heterogeneous graph structures to simulate outcomes under heterogeneous interference of the unit i:\nyi = f0(xi) + ft(ti,xi) + fs(T,X,Ni) + \u03f5i, (9)\nwhere f0(xi) = w\u22a40 xi simulates the outcome of a unit i under treatment ti = 0 without interference, and every element of w0 follows a Gaussian distribution or uniform distribution (i.e., N (0, 1) or U(0, 1)). ft(ti,xi) = ti \u00d7 w\u22a41 xi simulates the ITE of the unit i, where w1 \u223c N (0, I) or U(0, I). In the literature, the effect caused by interference is known as spillover effect [21]. We simulate it through fs(T,X,Ni) = o (1) i + o (2) i , where o (1) i = Agg(Concat(X,T),Ni) represents a spillover effect from 1-hop heterogeneous neighbors for the unit i, o (2) i = Agg(O\n(1),Ni) represents the spillover effect of 2-hop heterogeneous neighbors, and O(1) represents the spillover effects from 1-hop heterogeneous neighbors for all units. Here, the aggregation function is defined as Agg(C,Ni) =\u2211m\nv=1 e v (\n1 |Nvi | \u2211 j\u2208Nvi w\u22a4ijcj ) , where ev and every element of wij follow N (0, 1)\nor U(0, 1). Lastly, \u03f5i \u223c N (0, 1) is a random noise. Amazon Software dataset [8]: The Amazon dataset [8] is collected from Amazon4. In the graphs of the Amazon dataset, each node is a product. To study causal effects, we chose the co-purchased and co-viewed graphs from the software category of the Amazon dataset. After removing nodes with missing values, there are 11,089 items with 11,813 heterogeneous edges. The covariates consist of reviews and the number of customer reviews of items. We put reviews into the SimCSE [5] model to generate 768-dimensional sentence embeddings. 3 The simulated outcomes and the codes of the HINITE are available at https://\ngithub.com/LINXF208/HINITE. 4 https://www.amazon.com/\n10 X. Lin et al.\nThe review rating of items is considered as a treatment: an item is treated (t = 1) when the average review rating is at least 3, and an item is controlled (t = 0) when the average review rating is less than 3. The causal problem in this dataset is whether review rating has a role in influencing the sales of items. Due to the heterogeneous edges among items, the sales of an item might be influenced by its heterogeneous neighbors\u2019 treatments. YouTube dataset [31]: Tang et al. [31] used YouTube Data API5 to crawl the information of contacts, subscriptions, and favorites of users from YouTube6, while extending them to a contact graph, co-subscription graph, co-subscribed graph, and favorite graph. Every node in the graphs is a user of YouTube. In this case, we consider a causal problem: \u201chow much recommendation of a video (treatment) to a user will affect the user\u2019s experience of this video (outcome)?\u201d Moreover, users might share the recommended video with heterogeneous neighbors, which constitutes heterogeneous interference. We took 5,000 users with their heterogeneous graphs containing 3,190,622 heterogeneous edges to simulate outcomes and study heterogeneous interference. As detailed information about each user is missing, we simulated the covariates via xi \u223c N (0, I) (100-dimensional vector), and simulated treatment ti as follows, following most existing works, such as Ma et al. [16]:\nti \u223c Ber(sigmoid(x\u22a4i wt) + \u03f5ti), (10)\nwhere Ber(\u00b7) represents a Bernoulli distribution, wt is a 100-dimensional vector in which every element follows U(\u22121, 1), and \u03f5ti is random Gaussian noise. Flicker dataset [40]: Flicker7 is an online social website where users can share their images. Qu et al. [19] constructed a dataset with multi-view graphs, i.e., friendship view and similarity view, from the Flicker dataset [40]. Every node in the graphs is a user of Flicker. Following Qu et al. [19], we also consider friendship-view and similarity-view graphs that have 7,575 users with approximately 1,236,976 heterogeneous edges. Here, the causal question is: \u201chow much recommending a hot photo (treatment) to a user will affect the user\u2019s experience (outcome) of this photo?\u201d In this case, users might share recommended photos with their heterogeneous neighbors, which constitutes heterogeneous interference. We used the 1206-dimensional embeddings that are provided by Guo et al. [7], generated using a list of users\u2019 interest tags, and simulated the treatments using Eq. (10).\n4.2 Baselines\nBNN [11]: Balancing Neural Network [11] (BNN) addresses confounders by minimizing the discrepancy of distributions of units belonging to different groups, without considering interference. Following Johansson et al. [11], we considered two structures: BNN-4-0 and BNN-2-2. The former has four representation layers 5 https://developers.google.com/youtube/?csw=1 6 https://www.youtube.com/ 7 https://www.flickr.com/\nEstimating Treatment Effects Under Heterogeneous Interference 11\nbut no prediction layers, and the latter has two representation layers and two prediction layers. Both have one linear output layer. CFR [26]: Counterfactual Regression (CFR) [26] minimizes the maximum mean discrepancy (MMD) and Wasserstein distance between different distributions of two groups. Similar to BNN, it also ignores interference. Following Shalit et al. [26], we considered two different schemes: CFRMMD and CFRWass. The former minimizes the MMD of two different distributions, while the latter minimizes the Wasserstein distance. TARNet [26]: TARNet consists of the same model architecture as the CFR model but removes the balance term (MMD or Wasserstein distance). GCN-based methods [17]: Ma et al. [17] proposed methods to address interference on a homogeneous graph using graph convolutional networks (GCNs) [41]. The GCN-based method can use only a single view rather than all views of heterogeneous graphs. To overcome it, we consider two schemes. The first scheme is to replace heterogeneous graphs with a projection graph AProj and apply the GCN-based method to the AProj, denoted as GCNProj. If two units have an edge in either of the original heterogeneous graphs, there will be an edge in this projection graph. The second scheme is to augment the GCNbased method with mixing operations, which includes two variants: MGCNC and MGCNM. The MGCNC concatenates interference representations from different views into a single vector, while the MGCNM computes the mean vector of these interference representations.\n4.3 Experiment Settings\nFor all datasets, we calculated \u03f5PEHE/\u03f5ATE to evaluate the error on ITE/ATE estimations as follows:\n\u03f5PEHE = 1\nn n\u2211 i=1 (\u03c4i \u2212 \u03c4\u0302i)2, \u03f5ATE = \u2223\u2223\u2223\u2223\u2223 1n n\u2211 i=1 \u03c4i \u2212 1 n n\u2211 i=1 \u03c4\u0302i \u2223\u2223\u2223\u2223\u2223 . (11) Following Ma et al. [17], the entire X, T, and heterogeneous graph structures\nwere given during the training, validation, and testing phases. However, only the observed outcomes of the units in the training set were provided during the training phase. We randomly split all datasets into training/validation/test splits with a ratio of 70%/15%/15%. Results on the Youtube and Flicker datasets were averaged over ten realizations, while the results on the AMZ S dataset were averaged over three repeated executions. We trained all models with the NVIDIA RTX A5000 GPU. All methods utilized the Adam optimizer with 2,000 training iterations for all datasets. In addition, dropout and early stopping were applied for all methods to avoid overfitting.\nFor all datasets, we set the learning rate to 0.001 with a weight decay of 0.001, set the training batch size to 512, and searched \u03b3 in the range of {0.01, 0.1, 0.5, 1.0, 1.5} using the validation sets. We used ReLU as activation function for \u03d5, fyti , and node-level aggregations. The hidden layers of \u03d5 were set to (128, 64, 64)-dimensions, \u03c8 are set to (64, 64, 32)-dimensions, fyti are set\n12 X. Lin et al.\nTARNet 40.75\u00b17.95 0.51\u00b10.23 24.20\u00b16.79 0.30\u00b10.26 112.37\u00b111.54 103.91\u00b112.78 BNN-2-2 93.03\u00b116.02 0.26\u00b10.23 27.91\u00b17.53 0.13\u00b10.07 199.37\u00b10.20 196.36\u00b10.20 BNN-4-0 105.38\u00b122.50 0.26\u00b10.23 29.22\u00b17.53 0.13\u00b10.07 206.03\u00b10.08 203.12\u00b10.08 CFRMMD 42.02\u00b19.96 0.43\u00b10.36 24.44\u00b17.49 0.29\u00b10.17 103.18\u00b125.02 89.76\u00b132.13 CFRWASS 39.36\u00b18.76 0.51\u00b10.41 24.02\u00b16.71 0.35\u00b10.17 109.91\u00b124.49 99.40\u00b130.40 GCNProj 42.37\u00b17.45 0.61\u00b10.39 24.59\u00b15.11 0.21\u00b10.13 139.14\u00b120.63 135.57\u00b122.86 MGCNC 53.10\u00b111.83 0.29\u00b10.27 26.87\u00b16.43 0.25\u00b10.20 95.14\u00b18.25 72.08\u00b113.47 MGCNM 53.99\u00b113.46 0.37\u00b10.33 29.48\u00b17.17 0.29\u00b10.25 87.33\u00b13.40 60.81\u00b13.27\nHINITE 14.43\u00b13.27 0.21\u00b10.20 18.45\u00b14.42 0.15\u00b10.11 76.16\u00b13.82 15.21\u00b13.89\nto (128, 64, 32)-dimensions, and the dimensions of view-level attention were set to (128, 128, 64)-dimensions. Moreover, we searched for hyperparameters for all baseline methods from the search range suggested in the corresponding literature.\n4.4 Results\nTreatment effect estimation performance. Table 1 lists the results of ITE and ATE estimations on test sets of all datasets. It can be seen that the HINITE outperforms all baseline methods in ITE estimation, while there are significant gaps (p-values of the t-test are far less than 0.05) in ITE estimation between the proposed and baseline methods. It can also be seen that HINITE outperforms most baseline methods in ATE estimation, at least, achieving comparative performance of ATE estimation to those of the baseline methods. These results reveal that HINITE has a powerful ability to address heterogeneous interference. Moreover, the GCNProj and MGCN with some simple mixers cannot always achieve better performance than other baseline methods. This implies that modeling cross-view interference using the HIA layers is important.\nAblation study. To further investigate the importance of each component of HINITE, we conducted ablation experiments. Let us start by introducing some variants of HINITE: (i) HINITE-PG applies the HINITE to the projection graph AProj, which was described when introduced the GCN-based method. (ii) HINITE-NHG replaces the HIA layers with GCN layers [12] while using the AProj. (iii) HINITE-NB removes the HSIC regularization by setting \u03b3 to 0.\nFigure 4 presents the results of the ablation experiments. A clear performance gap can be seen in ITE and ATE estimation between the HINITE-PG/HINITENHG and HINITE. This implies that it is important to model the heterogeneous interference using the information of heterogeneous graphs and the proposed HIA layer. Comparing the results of HINITE and HINITE-NB, we can also observe\nEstimating Treatment Effects Under Heterogeneous Interference 13\n14 X. Lin et al.\nthat removing the HSIC regularization results in performance degradation. This reveals that it is also important to balance the different distributions.\nSensitivity analysis. To investigate whether HINITE is sensitive to \u03b3, we conducted experiments with different \u03b3 and present the results in Figure 5. No significant change in performance was observed with different values of \u03b3. This reveals that HINITE is not particularly sensitive to the value of \u03b3.\n5 Related work\nIn the literature, efforts have been made to estimate treatment effect without interference [2,7,11,13,23,24,26,42,43] and with interference on homogeneous graphs [1,3,9,15,17,32,33,36] or hyper-graphs [16]. A few studies have considered heterogeneous graphs. For example, Qu et al. [20] assumed a partial interference and could only estimate ATE. Zhao et al. [46] proposed a method to construct a heterogeneous graph from a homogeneous graph by learning a set of weights for each edge using an attention mechanism, but their method cannot capture interference between multi-view graph structures. We offer the first approach for handling interference on multi-view graphs.\nMeanwhile, heterogeneous graphs have been the subject of recent graph analysis studies, focusing on tasks such as node classification, link prediction, and graph classification [4,10,14,27,28,38,39,44,45]. The proposed HINITE shares some similarities with the heterogeneous graph attention network (HAN) [39]. However, HAN aggregates information from each view at the end of forward propagation only once, while the proposed HINITE does aggregation layer-bylayer, which is essential for capturing cross-view interference. In addition, we use LeakyReLU (for view-level attention) instead of the tanh function as an activation function to address the vanishing gradient issue, and we use single-head instead of multi-head attention for better efficiency.\n6 Conclusion\nIn this paper, we described the problem of heterogeneous interference and the difficulty of treatment effect estimations under heterogeneous interference. This paper proposed HINITE to model the propagation of heterogeneous interference using HIA layers that contain node-level aggregation, view-level aggregation, and attention mechanisms. We conducted extensive experiments to verify the performance of the proposed HINITE, where the results validate the effectiveness of the HINITE in ITE and ATE estimation under heterogeneous interference.\nAcknowledgements\nThis work was supported by JST, the establishment of university fellowships towards the creation of science technology innovation, Grant Number JPMJFS2123, and supported by JSPS KAKENHI Grant Number 20H04244.\nEstimating Treatment Effects Under Heterogeneous Interference 15\nEthics\nThis study only involved public datasets that are freely available for academic purposes.\nReferences\n1. Aronow, P.M., Samii, C.: Estimating average causal effects under general interference, with application to a social network experiment. The Annals of Applied Statistics 11, 1912\u20131947 (2017)\n2. Chu, Z., Rathbun, S.L., Li, S.: Graph infomax adversarial learning for treatment effect estimation with networked observational data. In: Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery and Data Mining. pp. 176\u2013184 (2021)\n3. Forastiere, L., Airoldi, E.M., Mealli, F.: Identification and estimation of treatment and interference effects in observational studies on networks. Journal of the American Statistical Association 116(534), 901\u2013918 (2021)\n4. Fu, X., Zhang, J., Meng, Z., King, I.: Magnn: Metapath aggregated graph neural network for heterogeneous graph embedding. In: Proceedings of the Web Conference 2020. pp. 2331\u20132341 (2020)\n5. Gao, T., Yao, X., Chen, D.: SimCSE: Simple contrastive learning of sentence embeddings. In: Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing (2021)\n6. Gretton, A., Bousquet, O., Smola, A., Sch\u00f6lkopf, B.: Measuring statistical dependence with hilbert-schmidt norms. In: Proceedings of the 16th International Conference on Algorithmic Learning Theory. pp. 63\u201377 (2005)\n7. Guo, R., Li, J., Liu, H.: Learning individual causal effects from networked observational data. In: Proceedings of the 13th International Conference on Web Search and Data Mining. pp. 232\u2013240 (2020)\n8. He, R., McAuley, J.: Ups and downs: Modeling the visual evolution of fashion trends with one-class collaborative filtering. In: Proceedings of the 2016 World Wide Web Conference. pp. 507\u2013517 (2016)\n9. Hudgens, M.G., Halloran, M.E.: Toward causal inference with interference. Journal of the American Statistical Association 103(482), 832\u2013842 (2008)\n10. Jin, D., Huo, C., Liang, C., Yang, L.: Heterogeneous graph neural network via attribute completion. In: Proceedings of the Web Conference 2021. pp. 391\u2013400 (2021)\n11. Johansson, F., Shalit, U., Sontag, D.: Learning representations for counterfactual inference. In: Proceedings of the 33rd International Conference on Machine Learning. vol. 48, pp. 3020\u20133029 (2016)\n12. Kipf, T.N., Welling, M.: Semi-supervised classification with graph convolutional networks. In: International Conference on Learning Representations (2017)\n13. Li, Q., Wang, Z., Liu, S., Li, G., Xu, G.: Deep treatment-adaptive network for causal inference. The International Journal on Very Large Data Bases pp. 1\u201316 (2022)\n14. Liang, X., Ma, Y., Cheng, G., Fan, C., Yang, Y., Liu, Z.: Meta-path-based heterogeneous graph neural networks in academic network. International Journal of Machine Learning and Cybernetics 13(6), 1553\u20131569 (2022)\n16 X. Lin et al.\n15. Liu, L., Hudgens, M.G.: Large sample randomization inference of causal effects in the presence of interference. Journal of the American Statistical Association 109(505), 288\u2013301 (2014) 16. Ma, J., Wan, M., Yang, L., Li, J., Hecht, B., Teevan, J.: Learning causal effects on hypergraphs. In: Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining. pp. 1202\u20131212 (2022) 17. Ma, Y., Tresp, V.: Causal inference under networked interference and intervention policy enhancement. In: Proceedings of the 24th International Conference on Artificial Intelligence and Statistics. vol. 130, pp. 3700\u20133708 (2021) 18. Nabi, R., Pfeiffer, J., Charles, D., K\u0131c\u0131man, E.: Causal inference in the presence of interference in sponsored search advertising. Frontiers in Big Data 5 (2022) 19. Qu, M., Tang, J., Shang, J., Ren, X., Zhang, M., Han, J.: An attention-based collaboration framework for multi-view network representation learning. In: Proceedings of the 2017 ACM on Conference on Information and Knowledge Management. pp. 1767\u20131776 (2017) 20. Qu, Z., Xiong, R., Liu, J., Imbens, G.: Efficient treatment effect estimation in observational studies under heterogeneous partial interference. arXiv preprint arXiv:2107.12420 (2021) 21. Rakesh, V., Guo, R., Moraffah, R., Agarwal, N., Liu, H.: Linked causal variational autoencoder for inferring paired spillover effects. In: Proceedings of the 27th ACM International Conference on Information and Knowledge Management. pp. 1679\u2013 1682 (2018) 22. Raudenbush, S.W., Schwartz, D.: Randomized experiments in education, with implications for multilevel causal inference. Annual Review of Statistics and Its Application 7(1) (2020) 23. Rosenbaum, P.R., Rubin, D.B.: The central role of the propensity score in observational studies for causal effects. Biometrika 70(1), 41\u201355 (1983) 24. Rubin, D.B.: Randomization analysis of experimental data: The fisher randomization test comment. Journal of the American statistical association 75(371), 591\u2013593 (1980) 25. Schnitzer, M.E.: Estimands and estimation of COVID-19 vaccine effectiveness under the test-negative design: Connections to causal inference. Epidemiology 33(3), 325 (2022) 26. Shalit, U., Johansson, F.D., Sontag, D.: Estimating individual treatment effect: generalization bounds and algorithms. In: Proceedings of the 34th International Conference on Machine Learning. vol. 70, pp. 3076\u20133085 (2017) 27. Shi, C., Ding, J., Cao, X., Hu, L., Wu, B., Li, X.: Entity set expansion in knowledge graph: a heterogeneous information network perspective. Frontiers of Computer Science 15(1), 1\u201312 (2021) 28. Song, Y., Yang, X., Xu, C.: Self-supervised calorie-aware heterogeneous graph networks for food recommendation. ACM Transactions on Multimedia Computing, Communications, and Applications (2022) 29. Sun, W., Wang, P., Yin, D., Yang, J., Chang, Y.: Causal inference via sparse additive models with application to online advertising. In: Proceedings of the 29th AAAI Conference on Artificial Intelligence. p. 297\u2013303 (2015) 30. Tang, L., Wang, X., Liu, H.: Uncovering groups via heterogeneous interaction analysis. In: Proceedings of IEEE International Conference on Data Mining. pp. 503\u2013 512 (2009) 31. Tang, L., Wang, X., Liu, H.: Uncoverning groups via heterogeneous interaction analysis. In: 2009 Ninth IEEE International Conference on Data Mining. pp. 503\u2013 512. IEEE (2009)\nEstimating Treatment Effects Under Heterogeneous Interference 17\n32. Tchetgen, E.J.T., VanderWeele, T.J.: On causal inference in the presence of interference. Statistical Methods in Medical Research 21(1), 55\u201375 (2012)\n33. Tchetgen Tchetgen, E.J., Fulcher, I.R., Shpitser, I.: Auto-g-computation of causal effects on a network. Journal of the American Statistical Association 116(534), 833\u2013844 (2021)\n34. Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A.N., Kaiser, \u0141., Polosukhin, I.: Attention is all you need. Advances in Neural Information Processing Systems 30 (2017)\n35. Veli\u010dkovi\u0107, P., Cucurull, G., Casanova, A., Romero, A., Li\u00f2, P., Bengio, Y.: Graph attention networks. In: Proceedings of the 6th International Conference on Learning Representations (2018)\n36. Viviano, D.: Policy targeting under network interference. arXiv preprint arXiv:1906.10258 (2019)\n37. Wang, P., Sun, W., Yin, D., Yang, J., Chang, Y.: Robust tree-based causal inference for complex ad effectiveness analysis. In: Proceedings of the 8th ACM International Conference on Web Search and Data Mining. pp. 67\u201376 (2015)\n38. Wang, X., Bo, D., Shi, C., Fan, S., Ye, Y., Philip, S.Y.: A survey on heterogeneous graph embedding: methods, techniques, applications and sources. IEEE Transactions on Big Data (2022)\n39. Wang, X., Ji, H., Shi, C., Wang, B., Ye, Y., Cui, P., Yu, P.S.: Heterogeneous graph attention network. In: Proceedings of the 2019 World Wide Web Conference. pp. 2022\u20132032 (2019)\n40. Wang, X., Tang, L., Liu, H., Wang, L.: Learning with multi-resolution overlapping communities. Knowledge and information systems 36, 517\u2013535 (2013)\n41. Welling, M., Kipf, T.N.: Semi-supervised classification with graph convolutional networks. In: Proceedings of the 4th International Conference on Learning Representations (2016)\n42. Yao, L., Chu, Z., Li, S., Li, Y., Gao, J., Zhang, A.: A survey on causal inference. ACM Transactions on Knowledge Discovery from Data 15(5), 1\u201346 (2021)\n43. Yao, L., Li, S., Li, Y., Huai, M., Gao, J., Zhang, A.: Representation learning for treatment effect estimation from observational data. In: Advances in Neural Information Processing Systems. vol. 31 (2018)\n44. Zhang, C., Song, D., Huang, C., Swami, A., Chawla, N.V.: Heterogeneous graph neural network. In: Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery & data mining. pp. 793\u2013803 (2019)\n45. Zhao, J., Wang, X., Shi, C., Hu, B., Song, G., Ye, Y.: Heterogeneous graph structure learning for graph neural networks. In: Proceedings of the 35th AAAI Conference on Artificial Intelligence. vol. 35, pp. 4697\u20134705 (2021)\n46. Zhao, Z., Kuang, K., Xiong, R., Wu, F.: Learning individual treatment effects under heterogeneous interference in networks. arXiv preprint arXiv:2210.14080 (2022)"
        }
    ],
    "title": "Estimating Treatment Effects Under Heterogeneous Interference",
    "year": 2023
}