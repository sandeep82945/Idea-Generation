{
    "abstractText": "We propose a hybrid Finite Volume (FV) Spectral Element Method (SEM) for modelling aeroacoustic phenomena based on the Lighthill\u2019s acoustic analogy. First the fluid solution is computed employing a FV method. Then, the sound source term is projected onto the acoustic grid and the inhomogeneous Lighthill\u2019s wave equation is solved employing the SEM. The novel projection method computes offline the intersections between the acoustic and the fluid grids in order to preserve the accuracy. The proposed intersection algorithm is shown to be robust, scalable and able to efficiently compute the geometric intersection of arbitrary polyhedral elements. We then analyse the properties of the projection error, showing that if the fluid grid is fine enough we are able to exploit the accuracy of the acoustic solver and we numerically assess the obtained theoretical estimates. Finally, we address two relevant aeroacoustic benchmarks, namely the corotating vortex pair and the noise induced by a laminar flow around a squared cylinder, to demonstrate in practice the effectiveness of the projection method when dealing with high order solvers. The flow computations are performed with OpenFOAM [50], an open-source finite volume library, while the inhomogeneous Lighthill\u2019s wave equation is solved with SPEED [34], an opensource spectral element library.",
    "authors": [
        {
            "affiliations": [],
            "name": "Alberto Artoni"
        },
        {
            "affiliations": [],
            "name": "Paola F. Antonietti"
        },
        {
            "affiliations": [],
            "name": "Ilario Mazzieri"
        },
        {
            "affiliations": [],
            "name": "Nicola Parolini"
        },
        {
            "affiliations": [],
            "name": "Daniele Rocchi"
        }
    ],
    "id": "SP:5b6ebc3e12a14483df056610c13246e837624c2c",
    "references": [
        {
            "authors": [
                "M. Ali",
                "M. Sukri",
                "C. Doolan",
                "V. Wheatley"
            ],
            "title": "Aeolian tones generated by a square cylinder with a splitter plate",
            "venue": "In: Journal of Sound and Vibration ",
            "year": 2010
        },
        {
            "authors": [
                "F. Alipour",
                "C. Br\u00fccker",
                "D.D. Cook",
                "A. Gommel",
                "M. Kaltenbacher",
                "W. Mattheus",
                "L.G. Mongeau"
            ],
            "title": "Eric A",
            "venue": "Nauman, R\u00fcdiger Schwarze, I. T. Tokuda, and S. Z\u00f6rner. \u201cMathematical Models and Numerical Schemes for the Simulation of Human Phonation\u201d. In: Current Bioinformatics 6 ",
            "year": 2011
        },
        {
            "authors": [
                "P. Antonietti",
                "P. Houston",
                "G. Pennesi",
                "E. S\u00fcli"
            ],
            "title": "An agglomeration-based massively parallel nonoverlapping additive Schwar precondition er for high-order discontinuous Galerkin methods on polytopic grids",
            "venue": "In: Mathematics of Computation 89 ",
            "year": 2019
        },
        {
            "authors": [
                "P. Antonietti",
                "I. Mazzieri",
                "M. Muhr",
                "V. Nikoli\u0107",
                "B. Wohlmuth"
            ],
            "title": "A high-order discontinuous Galerkin method for nonlinear sound waves",
            "venue": "In: Journal of Computational Physics 415 ",
            "year": 2020
        },
        {
            "authors": [
                "P.F. Antonietti",
                "P. Houston",
                "G. Pennesi"
            ],
            "title": "Fast Numerical Integration on Polytopic Meshes with Applications to Discontinuous Galerkin Finite Element Methods",
            "venue": "In: Journal of Scientific Computing 77.3 ",
            "year": 2018
        },
        {
            "authors": [
                "C.G. Canuto",
                "Mohammed Hussaini",
                "A. Quarteroni",
                "T. Zang"
            ],
            "title": "Spectral Methods: Evolution to Complex Geometries and Applications to Fluid Dynamics",
            "venue": "Ed. by Springer",
            "year": 2007
        },
        {
            "authors": [
                "S. Caro",
                "Y. Detandt",
                "J. Manera",
                "F. Mendon\u00e7a",
                "R. Toppinga"
            ],
            "title": "Validation of a New Hybrid CAA Strategy and Application to the Noise Generated by a Flap in a Simplified HVAC Duct",
            "venue": "In: 15th AIAA/CEAS Aeroacoustics Conference (30th AIAA Aeroacoustics Conference) ",
            "year": 2009
        },
        {
            "authors": [
                "E.B. Chin",
                "J.B. Lasserre",
                "N. Sukumar"
            ],
            "title": "Numerical integration of homogeneous functions on convex and nonconvex polygons and polyhedra",
            "venue": "In: Computational Mechanics 56.6 ",
            "year": 2015
        },
        {
            "authors": [
                "Tim Colonius",
                "Sanjiva K. Lele"
            ],
            "title": "Computational aeroacoustics: progress on nonlinear problems of sound generation",
            "venue": "Progress in Aerospace Sciences",
            "year": 2004
        },
        {
            "authors": [
                "N. Curle",
                "M.J. Lighthill"
            ],
            "title": "The influence of solid boundaries upon aerodynamic sound",
            "venue": "In: Proceedings of the Royal Society of London. Series A. Mathematical and Physical Sciences 231.1187 ",
            "year": 1955
        },
        {
            "authors": [
                "V. D\u2019Alessandro",
                "M. Falone",
                "L. Giammichele",
                "S. Montelpare"
            ],
            "title": "A low\u2014storage Runge\u2014Kutta OpenFOAM solver for compressible low\u2014Mach number flows: aeroacoustic and thermo\u2014fluid dynamic applications",
            "venue": "E3S Web of Conferences",
            "year": 2019
        },
        {
            "authors": [
                "C.J. Doolan"
            ],
            "title": "Flat-Plate Interaction with the Near Wake of a Square Cylinder",
            "venue": "In: AIAA Journal 47.2 ",
            "year": 2009
        },
        {
            "authors": [
                "D. Eberly"
            ],
            "title": "Robust and Error-Free Geometric Computing",
            "venue": "London: CRC Press",
            "year": 2020
        },
        {
            "authors": [
                "B. Engquist",
                "A. Majda"
            ],
            "title": "Absorbing boundary conditions for the numerical simulation of waves",
            "venue": "English (US). In: Mathematics of Computation 31.139 ",
            "year": 1977
        },
        {
            "authors": [
                "M. Escobar"
            ],
            "title": "Finite Element Simulation of Flow-Induced Noise using Sighthill\u2019s Acoustic Analogy",
            "venue": "In: Ph.D. Thesis ",
            "year": 2007
        },
        {
            "authors": [
                "R. Ewert",
                "W. Schr\u00f6der"
            ],
            "title": "Acoustic perturbation equation based on flow decomposition via source filtering",
            "venue": "In: Journal of Computational Physics 188 ",
            "year": 2003
        },
        {
            "authors": [
                "S. Falk",
                "S. Kniesburges",
                "S. Schoder",
                "B. Jakuba\u00df",
                "P. Maurerlehner",
                "M. Echternach",
                "M. Kaltenbacher",
                "M. D\u00f6llinger"
            ],
            "title": "3D-FV-FE Aeroacoustic Larynx Model for Investigation of Functional Based Voice Disorders",
            "venue": "In: Frontiers in Physiology 12 ",
            "year": 2021
        },
        {
            "authors": [
                "Joel H. Ferziger",
                "Milovan Peri\u0107"
            ],
            "title": "Computational Methods for Fluid Dynamics",
            "venue": "2nd. Berlin: Springer,",
            "year": 1999
        },
        {
            "authors": [
                "J.E. Ffowcs Williams",
                "D.L. Hawkings",
                "M.J. Lighthill"
            ],
            "title": "Sound generation by turbulence and surfaces in arbitrary motion",
            "venue": "In: Philosophical Transactions of the Royal Society of London. Series A, Mathematical and Physical Sciences 264.1151 ",
            "year": 1969
        },
        {
            "authors": [
                "H.M. Frank",
                "C.D. Munz"
            ],
            "title": "Direct aeroacoustic simulation of acoustic feedback phenomena on a side-view mirror",
            "venue": "In: Journal of Sound and Vibration 371 ",
            "year": 2016
        },
        {
            "authors": [
                "P. Hachenberger",
                "L. Kettner"
            ],
            "title": "3D Boolean Operations on Nef Polyhedra",
            "venue": "In: CGAL User and Reference Manual. 5.4. CGAL Editorial Board",
            "year": 2022
        },
        {
            "authors": [
                "A. Huppe"
            ],
            "title": "Spectral Finite Elements for Acoustic Field Computation",
            "venue": "In: Ph.D. Thesis ",
            "year": 2012
        },
        {
            "authors": [
                "Thomas H\u00fcttl"
            ],
            "title": "Introduction\u201d. In: Large-Eddy Simulation for Acoustics",
            "year": 2007
        },
        {
            "authors": [
                "O. Inoue",
                "M. Mori",
                "N. Hatakeyama"
            ],
            "title": "Aeolian tones radiated from flow past two square cylinders in tandem",
            "venue": "In: Physics of Fluids 18.4 ",
            "year": 2006
        },
        {
            "authors": [
                "H. Jasak"
            ],
            "title": "Error Analysis and Estimation for the Finite Volume Method with Applications to Fluid Flows",
            "venue": "In: Ph.D. Thesis, Imperial College ",
            "year": 1996
        },
        {
            "authors": [
                "B. Kaltenbacher",
                "M. Kaltenbacher",
                "I. Sim"
            ],
            "title": "A modified and stable version of a perfectly matched layer technique for the 3D second order wave equation in time domain with an application to aeroacoustics",
            "venue": "In: Journal of computational physics 235 ",
            "year": 2013
        },
        {
            "authors": [
                "M. Kaltenbacher"
            ],
            "title": "Numerical simulation of mechatronic sensors and actuators",
            "venue": "Vol. 2. Springer",
            "year": 2007
        },
        {
            "authors": [
                "M. Kaltenbacher",
                "M. Escobar",
                "S. Becker",
                "I. Ali"
            ],
            "title": "Computational Aeroacoustics based on Sighthill\u2019s Acoustic Analogy",
            "venue": "In: Computational Acoustics of Noise Propagation in Fluids - Finite and Boundary Element Methods. Berlin, Heidelberg: Springer Berlin Heidelberg",
            "year": 2008
        },
        {
            "authors": [
                "M. Kaltenbacher",
                "M. Escobar",
                "S. Becker",
                "I. Ali"
            ],
            "title": "Numerical simulation of flow-induced noise using LES/SAS and Sighthill\u2019s acoustic analogy",
            "venue": "In: International Journal for Numerical Methods in Fluids 63.9 ",
            "year": 2010
        },
        {
            "authors": [
                "D.J. Lee",
                "S.O. Koo"
            ],
            "title": "Numerical study of sound generation due to a spinning vortex pair",
            "venue": "In: AIAA Journal 33.1 ",
            "year": 1995
        },
        {
            "authors": [
                "M.J. Lighthill",
                "M.H.A. Newman"
            ],
            "title": "On sound generated aerodynamically I",
            "venue": "General theory\u201d. In: Proceedings of the Royal Society of London. Series A. Mathematical and Physical Sciences 211.1107 ",
            "year": 1952
        },
        {
            "authors": [
                "Y.S.K. Liow",
                "B.T. Tan",
                "M.C. Thompson",
                "K. Hourigan"
            ],
            "title": "Sound generated in laminar flow past a two-dimensional rectangular cylinder",
            "venue": "In: Journal of Sound and Vibration 295.1 ",
            "year": 2006
        },
        {
            "authors": [
                "P. Mart\u0301\u0131nez-Lera",
                "C. Schram"
            ],
            "title": "Correction techniques for the truncation of the source field in acoustic analogies",
            "venue": "The Journal of the Acoustical Society of America",
            "year": 2008
        },
        {
            "authors": [
                "I. Mazzieri",
                "M. Stupazzini",
                "R. Guidotti",
                "C. Smerzini"
            ],
            "title": "SPEED: SPectral Elements in Elastodynamics with Discontinuous Galerkin: a non-conforming approach for 3D multi-scale problems",
            "venue": "In: International Journal for Numerical Methods in Engineering 95.12 ",
            "year": 2013
        },
        {
            "authors": [
                "B.E. Mitchell",
                "S.K. Lele",
                "P. Moin"
            ],
            "title": "Direct computation of the sound from a compressible co-rotating vortex pair",
            "venue": "In: Journal of Fluid Mechanics 285 ",
            "year": 1995
        },
        {
            "authors": [
                "E.A. Muller",
                "F. Obermeier"
            ],
            "title": "The spinning vortices as a source of sound",
            "venue": "In: AGARD CP-22 22 ",
            "year": 1967
        },
        {
            "authors": [
                "A.A. Oberai",
                "F. Roknaldin",
                "T.J.R. Hughes"
            ],
            "title": "Computational procedures for determining structuralacoustic response due to hydrodynamic sources",
            "venue": "In: Computer Methods in Applied Mechanics and Engineering 190.3 ",
            "year": 2000
        },
        {
            "authors": [
                "A. Okajima"
            ],
            "title": "Strouhal numbers of rectangular cylinders",
            "venue": "In: Journal of Fluid Mechanics 123 ",
            "year": 1982
        },
        {
            "authors": [
                "A. Quarteroni"
            ],
            "title": "Numerical models for differential problems; 1st ed",
            "venue": "Milano: Springer",
            "year": 2009
        },
        {
            "authors": [
                "M. Schlottke-Lakemper"
            ],
            "title": "A direct-hybrid method for aeroacoustic analysis",
            "venue": "In: Ph.D. Thesis ",
            "year": 2017
        },
        {
            "authors": [
                "M. Schlottke-Lakemper",
                "M. Meinke",
                "W. Schr\u00f6der"
            ],
            "title": "A Hybrid Discontinuous Galerkin-Finite Volume Method for Computational Aeroacoustics",
            "venue": "In: New Results in Numerical and Experimental Fluid Mechanics X. Cham: Springer International Publishing",
            "year": 2016
        },
        {
            "authors": [
                "S. Schoder",
                "M. Kaltenbacher"
            ],
            "title": "Hybrid Aeroacoustic Computations: State of Art and New Achievements",
            "venue": "In: Journal of Theoretical and Computational Acoustics 27.04 ",
            "year": 2019
        },
        {
            "authors": [
                "S. Schoder",
                "A. Wurzinger",
                "C. Junger",
                "M. Weitz",
                "C. Freidhager",
                "K. Roppert",
                "M. Kaltenbacher"
            ],
            "title": "Application Limits of Conservative Source Interpolation Methods Using a Low Mach Number Hybrid Aeroacoustic Workflow",
            "venue": "In: Journal of Theoretical and Computational Acoustics 29.01 ",
            "year": 2021
        },
        {
            "authors": [
                "Christoph Schwab"
            ],
            "title": "P- and hp- finite element methods : theory and applications in solid and fluid mechanics",
            "year": 1998
        },
        {
            "authors": [
                "Michael Scully"
            ],
            "title": "Computation of helicopter rotor wake geometry and its influence on rotor harmonic airloads",
            "year": 1975
        },
        {
            "authors": [
                "A. Sohankar",
                "C. Norberg",
                "L. Davidson"
            ],
            "title": "Simulation of three-dimensional flow around a square cylinder at moderate Reynolds numbers",
            "venue": "In: Physics of Fluids 11.2 ",
            "year": 1999
        },
        {
            "authors": [
                "Michael E. Taylor"
            ],
            "title": "Partial Differential Equations I",
            "venue": "Basic Theory. New York: Springer,",
            "year": 1996
        },
        {
            "authors": [
                "Y.S. Wang",
                "L.N. Sui",
                "Z.Y. Yin",
                "X.L. Wang",
                "N.N. Liu",
                "H. Guo"
            ],
            "title": "A hybrid prediction for wind buffeting noises of vehicle rear window based on LES-LAA method",
            "venue": "In: Applied Mathematical Modelling 47 ",
            "year": 2017
        },
        {
            "authors": [
                "H.G. Weller",
                "G. Tabor",
                "H. Jasak",
                "C. Fureby"
            ],
            "title": "A tensorial approach to computational continuum mechanics using object-oriented techniques",
            "venue": "In: Computers in Physics 12.6 ",
            "year": 1998
        },
        {
            "authors": [
                "W. Zheng",
                "H. Qi"
            ],
            "title": "On Friedrichs\u2013Poincar\u00e9-type inequalities",
            "venue": "In: Journal of Mathematical Analysis and Applications 304 ",
            "year": 2005
        },
        {
            "authors": [
                "P. \u0160idlof",
                "S. Z\u00f6rner",
                "A. H\u00fcppe"
            ],
            "title": "A hybrid approach to the computational aeroacoustics of human voice production",
            "venue": "In: Biomechanics and modeling in mechanobiology 14 ",
            "year": 2014
        }
    ],
    "sections": [
        {
            "text": "We propose a hybrid Finite Volume (FV) - Spectral Element Method (SEM) for modelling aeroacoustic phenomena based on the Lighthill\u2019s acoustic analogy. First the fluid solution is computed employing a FV method. Then, the sound source term is projected onto the acoustic grid and the inhomogeneous Lighthill\u2019s wave equation is solved employing the SEM. The novel projection method computes offline the intersections between the acoustic and the fluid grids in order to preserve the accuracy. The proposed intersection algorithm is shown to be robust, scalable and able to efficiently compute the geometric intersection of arbitrary polyhedral elements. We then analyse the properties of the projection error, showing that if the fluid grid is fine enough we are able to exploit the accuracy of the acoustic solver and we numerically assess the obtained theoretical estimates. Finally, we address two relevant aeroacoustic benchmarks, namely the corotating vortex pair and the noise induced by a laminar flow around a squared cylinder, to demonstrate in practice the effectiveness of the projection method when dealing with high order solvers. The flow computations are performed with OpenFOAM [50], an open-source finite volume library, while the inhomogeneous Lighthill\u2019s wave equation is solved with SPEED [34], an opensource spectral element library."
        },
        {
            "heading": "1 Introduction",
            "text": "Aeroacoustics studies the propagation of noise generated by fluid flows. A typical problem of interest can be the noise induced by a car side view mirror. For a car moving at 40ms\u22121, the corresponding Reynolds number is of the order of 106. The typical mesh size required to capture the fluid length scales (even when working with turbulence models) are of the order of 10\u22123m or 10\u22124m [49], far from the involved acoustic scales that range from 0.05m\nar X\niv :2\n30 2.\n03 37\n0v 3\n[ m\nat h.\nN A\nup to 5m, see for instance [20]. Due to the multiscale nature of the involved length scales, a widely employed class of Computational Aeroacoustics (CAA) methodologies separate the flow field from the acoustic computations, in a hybrid approach, see for instance the recent reviews in [42] or [9]. Those methods are based on aeroacoustic analogies, namely rearrangement of the mass and momentum conservation laws of the flow, and are well suited for hybrid computations. The main idea is to feed in a one-way coupling the sound noise source induced by the flow field to an acoustic transport problem, see for instance Figure 1. Since the first development of aeroacoustics, hybrid methods have been established as a practical method for fast and accurate predictions for certain flow problems.\nIn this work, we consider problems with high speed flow velocity, low Mach number and in which we assume that there is no interaction between the fluid pressure and the acoustic pressure, namely, where the one-way coupling hypothesis holds. Examples of physical relevance where such assumptions are verified and where recently hybrid methods have been successfully applied are [28, 26] for subsonic flows, [2, 52, 17] for human phonation and [16] for airframe noise at low Mach. The greatest advantage of hybrid computational strategies for aeroacoustic problems is the possibility of choosing the optimal computational grids and optimal numerical methods for both the acoustic problem and the flow problem. In the flow problem, sufficiently fine computational grid to resolve the turbulence or wall scales must be employed in order to properly describe the underlying physics of the flow. For the acoustic problem, the domain is usually much bigger and the involved acoustic pressure length scales are larger. Moreover, the sound generation mechanism can be often confined only to the fluid region, allowing the acoustic problem to be modelled as a pure wave propagation problem. With this setting, optimal computational methods can be chosen for each problem independently. In this work, we propose to employ Finite Volumes (FV) schemes for the fluid problem, since it is largely employed in the industrial framework. The corresponding FV solution is then employed to compute the source term for the acoustic wave propagation problem, which is then solved employing Spectral Element Methods (SEM). High order approximations have already been employed in computational aeroacoustic, see for instance [22] and [41]. A critical step in hybrid methods is the coupling between the fluid and the acoustic domain, and how the noise source field is interpolated between the computational grids. We remark that the fluid and acoustic grids might have very different granularities in order to capture the underlying (different) physics. While simple nearest\nneighbour interpolation fails to compute the acoustic sources accurately [7], conservative interpolation schemes lack of important analytical framework, although have been successfully employed, see for instance [29]. The L2-projection method has been employed in [41] limited to nested Cartesian. In this work, we generalize the method to arbitrary polyhedral grids, proposing an efficient algorithm to compute the intersections between the fluid and acoustic elements. We then compute the projection of the sound source term computed as a post-process of the flow solution onto the acoustic grid by employing a quadrature free method on polyhedral elements. The proposed coupling strategy is flexible and acts as a black box, requiring only the sound source term at the cell centre of the fluid cell and hence it is well suited to be plugged onto any finite volume solver. Furthermore, it is naturally fitted for high order approximations since the employed quadrature formula integrates exactly arbitrary polynomials. We provide a rigorous theoretical analysis quantifying the effect of the projection error. This allows us to state that if the fluid grid is fine enough, we can exploit the accuracy of the spectral solver. The theoretical results are then validated by means of numerical experiments. The flow computations are performed with OpenFOAM [50], an open-source finite volume library, while the inhomogeneous acoustic wave equation is solved with SPEED [34], an open-source spectral element library. The paper is structured as follows. In Section 2 we introduce the aeroacoustic hybrid problem, and we propose our strategy to solve the inhomogeneous Lighthill\u2019s wave equation. We focus our attention on the coupling between the fluid and acoustic problem. We develop in Section 3 the theoretical analysis on the projection method and we then discuss in Section 4 the challenging implementation aspects. In Section 5 we test the proposed intersection algorithm and we verify in Section 6 the theoretical estimates for the projection error. In Section 7 we apply the proposed computational strategy on benchmark aeroacoustic problems."
        },
        {
            "heading": "2 The aeroacoustic model problem",
            "text": "It is possible to find in literature a wide variety of aeroacoustic models: from semi-analytical strategies based on employing suitable Green functions that led to the popular Curle [10] and Ffowcs Williams Hawkings analogies [19], to more recent models that aim to solve the acoustic perturbed equations (APE), see for instance [16]. Most of the approximation methods proposed for these models rely on a hybrid strategy: first, they compute the fluid flow solution and then, they solve the acoustic problem using the latter to compute the sound source. This is the principle upon which the Lighthill\u2019s wave equation is based on."
        },
        {
            "heading": "2.1 Lighthill\u2019s wave equation",
            "text": "Let \u2126 \u2282 R3, be a connected open bounded domain with sufficiently smooth boundary \u2202\u2126. We denote by x \u2208 \u2126 the vector of spatial coordinates, and by t \u2208 (0, T ] the time coordinate, being T > 0 a final observation time. We consider in \u2126 \u00d7 (0, T ] the compressible unsteady Navier-Stokes equations:\n\u2202\u03c1 \u2202t +\u2207 \u22c5 (\u03c1u) = 0, (1)\n\u2202\u03c1u\n\u2202t +\u2207 \u22c5 (\u03c1u\u2297 u) = \u2212\u2207p +\u2207 \u22c5\u03c3, (2)\n\u2202\u03c1E\n\u2202t +\u2207 \u22c5 [(\u03c1E + p)u] = \u2207 \u22c5 (\u03c3u \u2212 q), (3)\nsupplemented with suitable boundary, initial conditions and a state equation that will be detailed later on. Equations (1), (2) and (3) are the mass, momentum and energy balance equations, respectively, where \u03c3 denotes the viscous stress tensor, \u03c1 is the fluid density, p is the pressure, u is the fluid velocity, \u03c1E is the total energy and q is the heat flux. The Navier-Stokes equations (1)-(3) could, in principle, be adopted to describe the full model for aeroacoustic problems. However, due to the different scales in the acoustic and flow problems, directly solving the system of equations (1)-(3) is still computationally unaffordable for far field noise resolution, see for instance [23]. Hence, we need to propose a different strategy. We define the adimensional Mach (Ma) and Reynolds (Re) numbers as\nMa = U c0 , Re = UL \u03bd ,\nwhere U is the characteristic speed of the flow, c0 is the speed of sound, L is the characteristic length of the flow problem, and \u03bd is the kinematic viscosity. We derive the Lighthill\u2019s wave equation, see [31], by taking the time derivative of (1) and subtracting the divergence of the momentum equation (2). Then, we have\n\u22022\u03c1 \u2202t2 = \u2207 \u22c5 \u2207 \u22c5 (\u03c1u\u2297 u + pI \u2212\u03c3).\nSumming and subtracting in the above equation the term c20\u2206\u03c1, we obtain the following wave equation:\n\u22022\u03c1 \u2202t2 \u2212 c20\u2206\u03c1 = \u2207 \u22c5 \u2207 \u22c5T, (4)\nwhere the right-hand side has been reformulated by introducing the so-called Lighthill\u2019s tensor T = \u03c1u\u2297 u + (p \u2212 c20\u03c1)I \u2212\u03c3, (5) being I the identity tensor. The model (4)-(5) can be further simplified depending on the problem of interest. For a sufficiently high Reynolds number, it is possible to neglect the viscous source term in the Lighthill\u2019s tensor. Assuming a low Mach number and no combustion effects, the fluid can be considered isentropic, leading to p = c20\u03c1. Under these assumptions, the Lighthill\u2019s tensor in (5) reduces to T = \u03c10u \u2297 u, where \u03c10 is a reference density for the fluid. This leads to the following wave equation:\n\u22022\u03c1 \u2202t2 \u2212 c20\u2206\u03c1 = \u2207 \u22c5 \u2207 \u22c5 (\u03c10u\u2297 u), (6)\nwhich describes the evolution of a density wave in a quiescent material where the speed of propagation is given by c0, the fluid reference density is given by \u03c10 and the sound source is given by the approximation of the Lighthill\u2019s stress tensor. Equation 6 is then supplemented with suitable initial and boundary conditions, as detailed in the following."
        },
        {
            "heading": "2.2 The hybrid coupled model problem",
            "text": "With the aim of studying aeroacoustic problems related to the noise generated by external flows around bodies, we consider the following setup. We assume acoustic compactness, which means that the size of the flow source structures that generate the acoustic field are small compared to the acoustic generated wavelength. This hypothesis is inherently fulfilled for low Mach number applications. Next, we consider a connected domain \u2126f, having\nsufficiently regular boundary \u2202\u2126f, embedded in a connected domain \u2126a, with sufficiently regular boundary \u2202\u2126a, see Figure 2.\nThe hybrid algorithm requires to solve the following sequence of problems: a. Flow Problem. For the flow problem we consider the incompressible Navier-Stokes equations, that read as for t \u2208 (0, T ], find u(x, t) \u2236 \u2126f \u00d7 (0, T ] \u2192 R3 and p(x, t) \u2236 \u2126f \u00d7 (0, T ] \u2192 R such that\n\u2202u \u2202t +\u2207 \u22c5 (u\u2297 u) \u2212\u2207 \u22c5 (\u03bd\u2207u) + 1 \u03c10 \u2207p = 0, in \u2126f \u00d7 (0, T ],\n\u2207 \u22c5 u = 0, in \u2126f \u00d7 (0, T ], u(x,0) = 0, in \u2126f,\nu = 0, on \u0393b, u = g, on \u0393in,\n\u03bd\u2207u \u22c5 n \u2212 pn = 0, on \u0393out, u \u22c5 n = 0, on \u0393sym,\n\u2207(u \u2212 (u \u22c5 n)n) \u22c5 n = 0, on \u0393sym,\n(7)\nwhere n is the outward unit normal vector to \u2202\u2126f, \u03bd is the kinematic viscosity, \u03c10 is the fluid density and g is the inlet Dirichlet datum. Here, we suppose the fluid boundary can be decomposed in the pairwise disjoint portions \u0393in,\u0393out,\u0393b,\u0393sym, such that \u2202\u2126f = \u0393in \u222a \u0393out \u222a \u0393b \u222a \u0393sym. \u0393in \u2229 \u0393out \u2229 \u0393b \u2229 \u0393sym = \u2205,. b. Acoustic Source. From the fluid velocity u we define the Lighthill\u2019s tensor as\nT = \u23a7\u23aa\u23aa\u23a8\u23aa\u23aa\u23a9 \u03c10u\u2297 u if x \u2208 \u2126f, 0 if x \u2208 \u2126a/\u2126f.\n(8)\nThe Lighthill\u2019s tensor has support only on the fluid domain \u2126f \u2286 \u2126a, and it depends on the solution u of problem (7), being the coupling term between the flow problem (7) and the acoustic problem (9).\nc. Acoustic Problem. We consider in \u2126a the following non-homogeneous acoustic problem based on the Lighthill\u2019s wave equation, cf. Section 2.1: for t \u2208 (0, T ], find \u03c1(x, t) \u2236 \u2126a \u00d7\n(0, T ]\u2192 R such that\n\u22022\u03c1 \u2202t2 \u2212 c20\u2206\u03c1 = \u2207 \u22c5 \u2207 \u22c5T, in \u2126a \u00d7 (0, T ),\nc20 \u2202\u03c1\n\u2202n = 0, on \u0393b \u00d7 (0, T ),\n1\n\u03c10\n\u2202\u03c1 \u2202n = \u2212 1\n\u03c10c0\n\u2202\u03c1 \u2202t (x, t), on \u0393abs \u00d7 (0, T ),\n\u03c1(x,0) = 0, x \u2208 \u2126a, \u2202\u03c1 \u2202t (x,0) = 0, x \u2208 \u2126a,\n(9)\nwhere c0 is the speed of propagation of the wave and \u03c10 is the fluid density. The boundary \u2202\u2126a has been split as \u2202\u2126a = \u0393abs\u222a\u0393b. On the external boundary \u0393abs, cf. Figure 1, we apply non-reflective boundary conditions, see [14], while on \u0393b we set a sound hard boundary condition, modelling a rigid wall. Initial conditions are set to zero. We are aware that the validity of this hybrid strategy and the underlying one-way coupling assumption is strongly problem-specific, depending on the geometry of the problem and the flow features. However, this approach is widely used in the context of aeroacoustics simulations, see for instance [28, 26, 52, 16]."
        },
        {
            "heading": "2.3 Discretization of the incompressible Navier-Stokes equations",
            "text": "The fluid flow problem is solved by employing the library OpenFOAM [50], an open-source library based on the cell centered finite volume method [18]. We consider a polyhedral tessellation Tf of the domain \u2126f and we indicate with x0 the barycentre of the convex polyhedral cell Kf \u2208 Tf. Then, we introduce the space of piecewise constant functions Vf = {vf \u2208 L2(\u2126f) \u2236 vf\u2223Kf \u2208 P0(Kf),\u2200Kf \u2208 Tf}, where P0(Kf) is the space of the constant functions on the element Kf, and with Nf = dimVf and we denote with V f = [Vf]3 the vector valued discrete space. In order to obtain a finite volume discretization of problem (7), we integrate the momentum equation over the polyhedron Kf \u2208 Tf, getting\n\u222b Kf\n\u2202u \u2202t dx + \u222b Kf \u2207 \u22c5 (u\u2297 u)dx \u2212 \u222b Kf \u2207 \u22c5 (\u03bd\u2207u)dx + \u222b Kf \u2207( p \u03c10 )dx = 0, (10)\n\u222b Kf \u2207 \u22c5 udx = 0, (11)\nand then proceed by discussing the discretization of each term, introducing uh \u2208 V f and ph \u2208 Vf. The spatial approximation of the first integral in (10) is straightforward, namely,\n\u222b Kf\n\u2202u \u2202t dx \u2248 \u222b\nKf\n\u2202uh \u2202t dx = \u2223Kf\u2223 \u2202uh \u2202t (x0, (12)\nwhere \u2223Kf\u2223 is the volume of the element Kf and where a mid-point quadrature rule is employed. Next, being \u03bd constant, we approximate the third term of (10) as follows\n\u222b Kf \u2207 \u22c5 (\u03bd\u2207u)dx = \u222b \u2202Kf (\u03bd\u2207u)nds \u2248 \u2211 F \u2208\u2202Kf \u03bd\u2207uFn\u2223F \u2223, (13)\nwhere \u2207uF = \u2207u(xF ), being xF the face cell barycenter. Note that in the last step, we use a mid-point quadrature rule on the face F . Now, if the face cell F is shared by two elements\nK+f and K \u2212 f , we reconstruct linearly \u2207uFn, (see appendix A, eq. (53)). Concerning the convective term in (10), integrating by parts, we get:\n\u222b Kf \u2207 \u22c5 (u\u2297 u)dx = \u222b \u2202Kf u(u \u22c5 n)ds \u2248 \u2211 F \u2208\u2202Kf uF (uF \u22c5 n)\u2223F \u2223, (14)\nwhere we applied a mid-point quadrature rule on the face F . The flux term is discretized with a linear upwind scheme (see appendix A, eq. (54)). Finally, the pressure gradient term is discretized similarly, by observing that \u2207p = \u2207 \u22c5 (pI) and by applying the Gauss theorem. For the time discretization, we first divide the temporal interval (0, T ] into N subintervals, such that T = N\u2206t, setting tn = n\u2206t, with n = 0, . . . ,N . We consider a backward differentiation formula of second order (BDF2) discretization scheme for (12), namely \u2202uh \u2202t \u2248 3u n+1 h \u2212 4unh + un\u22121h 2\u2206t . Finally, we remark that we compute at any time tn the aeroacoustic sound source term as a post-process of the fluid solution unh, i.e., \u2207 \u22c5T \u2248 \u2207 \u22c5 (\u03c10unh \u2297 unh), see (15) and also (14)."
        },
        {
            "heading": "2.4 Discretization of the Lighthill\u2019s wave equation",
            "text": "We start by considering the variational formulation of the acoustic problem (9): for t \u2208 (0;T ], find \u03c1(x, t) \u2208H1(\u2126a) such that \u2200w \u2208H1(\u2126a):\n(\u2202 2\u03c1\n\u2202t2 ,w)\n\u2126a\n+ c20(\u2207\u03c1,\u2207w)\u2126a + c0\u222b \u0393abs\n\u2202\u03c1 \u2202t w ds = \u2212(\u2207 \u22c5T,\u2207w)\u2126a , (15)\nwith initial conditions \u03c1 = \u2202\u03c1 \u2202t = 0 in \u2126a\u00d7{0}, being (\u22c5, \u22c5)\u2126a the L2 product over the domain \u2126a. We remark that we integrated by parts the term (\u2207\u22c5\u2207 \u22c5T,w)\u2126a and the resulting boundary terms are null both on \u0393abs and on \u0393b, as it discussed in [29]. Next, we discretize problem (15) by means of the SEM as follows. We introduce a conforming decomposition Ta of the domain \u2126a made by hexahedral elementsKa. We denote by K\u0302 the reference element [\u22121,1]3, and we suppose that for any mesh element Ka \u2208 Ta there exists a suitable trilinear invertible map \u03b8Ka \u2236 K\u0302 \u2192Ka with positive Jacobian JKa . We define the characteristic mesh dimension as ha = max\nKa\u2208Ta hKa , being hKa the diameter of the element Ka. Next, we introduce the\nfinite-dimensional space: Va = {v \u2208 C0(\u2126a) \u2229H1(\u2126a) \u2236 v\u2223Ka \u25cb \u03b8\u22121Ka \u2208 Qr(K\u0302),\u2200Ka \u2208 Ta}, where Qr(K\u0302) is the space of polynomials of degree less than or equal to r \u2265 1 in each coordinate direction, and we denote by Na the dimension of Va. Next, for any u,w \u2208 Va, we introduce the following bilinear form by means of the Gauss-Legendre-Lobatto (GLL) quadrature rule:\n(u,w)NIKa = r\n\u2211 i,j,k=0 u(\u03b8Ka(\u03beGLLi,j,k ))w(\u03b8Ka(\u03beGLLi,j,k ))\u03c9GLLi,j,k \u2223det(J)\u2223 \u2248 (u,w)Ka (16)\nwhere \u03beGLL are the GLL quadrature nodes, and \u03c9GLL their corresponding weights, defined in [\u22121,1]3 (cf. [39]) and NI stands for numerical integration. Moreover, we define\n(u,w)NITa = \u2211 Ka\u2208Ta (u,w)NIKa \u2200u,w \u2208 Va.\nThe semi-discrete spectral element formulation of problem (15) with numerical integration (SEM-NI) reads: for any time t \u2208 (0;T ] find \u03c1h \u2208 Va such that:\n(\u2202 2\u03c1h \u2202t2 ,wh)NITa + c20(\u2207\u03c1h,\u2207wh)NITa + c0\u222b \u0393abs \u2202\u03c1h \u2202t wh ds = \u2212(\u2207 \u22c5T,\u2207wh)NITa \u2200wh \u2208 Va, (17)\nwith \u03c1h = \u2202\u03c1h \u2202t = 0 in \u2126a \u00d7 {0}. We recall that the term \u2207 \u22c5T is an external source that in our case is obtained from a numerical solution of problem (7) as described in Section 2.3. In the next section, we detail how to compute effectively the right-hand side of eq.(17), i.e., how to approximate a field defined on the fluid mesh Tf with a field defined on the acoustic grid Ta."
        },
        {
            "heading": "2.5 L2\u2212projection of the acoustic source",
            "text": "Let qf \u2208 Vf be a function defined on the fluid grid Tf such that qf = \u2211Nfi=1 q\u0302f,i\u03d5f,i, where {\u03d5f,i} Nf i is the set of Nf basis functions associated to Vf, and q\u0302f,i are the corresponding expansion coefficients. We define the L2-projection of the field qf into Va as\nqa = argmin q\u2208Va \u2225qf \u2212 q\u2225L2(Ta), (18)\nwhere qf has been extended by zero also on \u2126a. Problem (18) is equivalent to the following: find qa \u2208 Va s.t.\n(qa, \u03d5a,i)Ta = (qf, \u03d5a,i)Ta \u2200\u03d5a,i \u2208 Va, (19)\nwhere qa \u2208 Va is a function defined on the acoustic grid Ta such that qa = \u2211Nai=1 q\u0302a,i\u03d5a,i, where {\u03d5a,i} Na\ni is the set of Na basis functions, and q\u0302a,i are the corresponding expansion\ncoefficients. Motivated by the solution method used in Section 2.3 we address the case where qf is a piecewise constant function over Tf , namely qf \u2208 Vf. Then, problem (19) can be recast as follows:\n\u2211 Ka\u2208Ta (qa, \u03d5a,i)Ka = \u2211 Ka\u2208Ta ( Nf \u2211 \u2113=1 q\u0302f,\u2113\u03d5f,\u2113, \u03d5a,i)Ka = \u2211 Ka\u2208Ta Nf \u2211 \u2113=1 q\u0302f,\u2113(1, \u03d5a,i)Ka\u2229Kf,\u2113 , (20)\nwhere we have used that Kf,\u2113 = supp(\u03d5f,\u2113). The discrete algebraic counterpart of (20) becomes Maaq\u0302a =Mafq\u0302f, (21) where Maa \u2208 RNa\u00d7Na is the acoustic mass matrix, i.e.,\nMaai,j = \u2211 Ka\u2208Ta (\u03d5a,j, \u03d5a,i)Ka , i, j = 1, . . . ,Na, (22)\nwhile Maf \u2208 RNa\u00d7Nf is the coupling mass defined as\nMafi,\u2113 = \u2211 Ka\u2208Ta\nNf \u2211 \u2113=1 (1, \u03d5a,i)Ka\u2229Kf,\u2113 , \u2113 = 1, . . . ,Nf. (23)\nThe coupling mass has been computed with a suitable quadrature formula that will be described in Section 4.2. The vector q\u0302a in (21) collects all the expansion coefficients of the acoustic field qa, while q\u0302f collects all the expansion coefficients of the fluid field qf."
        },
        {
            "heading": "3 Error analysis for the acoustic source",
            "text": "It is evident that the accuracy of the numerical solution \u03c1h in (17) strongly depends on the approximation of the acoustic source, namely, \u2207 \u22c5T. In our case the latter is obtained as a\npost-process of the numerical solution uh of the flow problem. Quantifying the projection error between the acoustic and fluid grids is therefore of paramount importance.\nHowever, before presenting the main result of the section we need to introduce some preliminary results. Lemma 3.1 (Interpolation error on GLL nodes). Given f \u2208 Hs(\u2126) for some s \u2265 1, consider the Lagrangian interpolant IGLLa f at the Gauss Legendre Lobatto nodes, where r denotes the polynomial degree of the interpolant function and h is the mesh size of T h tessellation of \u2126. Assuming h to be quasi uniform, we have that:\n\u2225f \u2212 IGLLa f\u2225L2(\u2126) \u2272 h min(r+1,s) (1 r ) s \u2225f\u2225 Hs(\u2126). (24)\nFor more details The proof of Lemma 3.1 can be found in [6, Section (5.4.3)]. Lemma 3.2 (hp-inverse inequality) Assume now that K = \u03b8K(K\u0302) is a hexahedral element s.t. K \u2282 R3, where \u03b8K is a suitable trilinear map. Then we have that:\n\u2225\u2207v\u2225 L2(K) \u2272\nr2\nhK \u2225v\u2225 L2(K), \u2200v \u25cb \u03b8 \u22121 K \u2208 Qr(K\u0302), (25)\nwhere hK is diam (K). For more details For the proof, see [44, Theorem 4.76]. Finally, we recall this Poincare\u0301Friedrich like inequality: Lemma 3.3 Given u \u2208 H1(K), where K is an open bounded convex domain in Rd and u \u2208 L20(K) = {v \u2208 L2(K) \u2236 \u222b\nK v = 0 dx} then we have that:\n\u2225u\u2225 L2(K) \u2272 diam(K)1+d/2 \u2223K \u22231/2 \u2225\u2207u\u2225L2(K). (26)\nWe refer the reader to [51, Corollary 3.4] and to [3, Remark 5.8] for further details on the proof.\nNext, for the sake of the presentation, we consider the following setup: let \u2126 = \u2126f = \u2126a be a polygonal domain and let Tf and Ta be two nested grids of \u2126 as shown in Figure 3, namely for all elements Ka \u2208 Ta we assume that there exists a set of index LKa such that Ka = \u22c3\nl\u2208LKa Kf,l.\nWe now introduce the following projection operators: \u03a00,hf \u2236 L2(\u2126)\u2192 Vf and \u03a0r,ha \u2236 L2(\u2126)\u2192 Va, and we define the following functions:\nff = \u03a00,hff, (27)\nthat is the L2 projection of f \u2208 L2(\u2126) onto the space Vf,\nfp = \u03a0r,haf, (28)\nthat is the L2 projection of f \u2208 L2(\u2126) onto the space Va,\nfa = \u03a0r,haff, (29)\nthat is the L2 projection of ff \u2208 Vf onto the space Va, see Figure 3. Now, we can state the following result.\nTheorem 3.4 (Approximation Theorem). Let Ta and Tf be two grids of the same computational domain \u2126f = \u2126a = \u2126 made by hexahedral elements, such that Tf is nested to Ta, namely, for every element Kf there exists Ka such that Kf \u2282 Ka. Given f \u2208 Hs(\u2126) with s \u2265 1, let ff = \u03a00,hff be the projection of f onto the space Vf and let fa = \u03a0r,haff, namely the projection of ff onto the space Va. Then, it holds:\n\u2225f \u2212 fa\u2225L2(\u2126) \u2272 h min(r+1,s) a ( 1 r ) s \u2225f\u2225 Hs(\u2126) + h2f ha r2\u2225f\u2225 Hs(\u2126). (30)\nProof. Let fp = \u03a0r,haf , see for instance Figure 3. By triangular inequality we have that\n\u2225f \u2212 fa\u2225L2(\u2126) \u2264 \u2225f \u2212 fp\u2225L2(\u2126) + \u2225fp \u2212 fa\u2225L2(\u2126). (31)\nThe first term on the right hand side can be estimated by employing Lemma 3.1, i.e.:\n\u2225f \u2212 fp\u2225L2(\u2126) =min\u03c6\u2208Va \u2225f \u2212 \u03c6\u2225L2(\u2126) \u2272 \u2225f \u2212 I GLL a f\u2225L2(\u2126) \u2272 h\nmin(r+1,s) a ( 1 r ) s \u2225f\u2225 Hs(\u2126). (32)\nNext, we observe that by definition of the L2-projection we get\n(fa, \u03d5)L2(\u2126) = (ff, \u03d5)L2(\u2126) \u2200\u03d5 \u2208 Va, (33)\n(fp, \u03d5)L2(\u2126) = (f, \u03d5)L2(\u2126) \u2200\u03d5 \u2208 Va. (34) Then, by subtracting (33) to (34), we obtain\n(fp \u2212 fa, \u03d5)L2(\u2126) = (f \u2212 ff, \u03d5)L2(\u2126), \u2200\u03d5 \u2208 Va.\nFurthermore, since fp \u2212 fa \u2208 Va, we can write\n\u2225fp \u2212 fa\u2225 2\nL2(\u2126) = \u222b\u2126(f \u2212 ff)(fp \u2212 fa) dx =\u2211Kf \u222b Kf (f \u2212 ff)(fp \u2212 fa) dx.\nand notice that (f \u2212 ff, \u03c6)L2(Kf) = 0 \u2200\u03c6 \u2208 P0(Kf),\nwhere P0(Kf) is the space of the constant functions over Kf. By taking \u03c6 = \u03a00,hf(fp \u2212 fa) in the above equation yields to\n\u2211 Kf \u222b Kf (f \u2212 ff)(fp \u2212 fa) dx =\u2211 Kf \u222b Kf (f \u2212 ff)(fp \u2212 fa \u2212\u03a00,hf(fp \u2212 fa)) dx.\n\u2272\u2211 Kf \u2225f \u2212 ff\u2225L2(Kf)\u2225fp \u2212 fa \u2212\u03a00,hf(fp \u2212 fa)\u2225L2(Kf) \u2272 h2f \u2211 Kf \u2225\u2207f\u2225 L2(Kf)\u2225\u2207(fp \u2212 fa)\u2225L2(Kf),\n(35)\nwhere in the last inequality we employ Lemma 3.3. By linearity of the integral, noticing that by hypothesis Kf \u2282Ka and using that \u2225\u2207f\u2225L2(Kf) \u2264 \u2225\u2207f\u2225L2(Ka) we obtain\n\u2211 Kf h2f \u2225\u2207f\u2225L2(Kf)\u2225\u2207(fp \u2212 fa)\u2225L2(Kf) \u2272\u2211 Ka h2f \u2225\u2207f\u2225L2(Ka)\u2225\u2207(fp \u2212 fa)\u2225L2(Ka)\n\u2272\u2211 Ka\nh2f r 2\nha \u2225\u2207f\u2225 L2(Ka)\u2225fp \u2212 fa\u2225L2(Ka)\n\u2272 h 2 f r 2\nha \u2225\u2207f\u2225 L2(\u2126)\u2225fp \u2212 fa\u2225L2(\u2126),\nwhere in the last step we used the inverse inequality of Lemma 3.2. Finally, we get\n\u2225fp \u2212 fa\u2225 2 L2(\u2126) \u2272 h2f r 2\nha \u2225\u2207f\u2225 L2(\u2126)\u2225fp \u2212 fa\u2225L2(\u2126),\nor equivalently,\n\u2225fp \u2212 fa\u2225L2(\u2126) \u2272 h2f r 2\nha \u2225\u2207f\u2225 L2(\u2126) (36)\nand, since \u2225\u2207f\u2225 L2(\u2126) \u2272 \u2225f\u2225Hs(\u2126), that concludes the proof. 2"
        },
        {
            "heading": "4 Implementation aspects",
            "text": "An accurate solution of the projection problem (20) requires computing the intersection between the elements Ka \u2208 Ta and Kf \u2208 Tf. This operation is in general very expensive, but in many applications, it is crucial to compute it accurately in order to have reliable solutions. In this section, we consider Ta and Tf (not necessary nested), and we present our strategy to compute the intersection between two elements Ka and Kf and we show that it is robust and scalable. We recall that the intersection K = Ka \u2229Kf is in general a polyhedron in the three-dimensional space. Moreover, we describe the employed quadrature-free algorithm to compute the integral of polynomials functions over K, cf. Equation (23)."
        },
        {
            "heading": "4.1 Intersection algorithm",
            "text": "The benefits of computing explicitly the intersection elements when projecting have been already explored in the context of low-order finite elements for aeroacoustics on tetrahedral meshes, see for instance [43]. The new grid obtained after the intersection is nested both with respect to the fluid grid and with respect to the acoustic grid, hence we can apply the analysis of Section 3. Here, we propose a geometrical algorithm for computing the intersections between generic polyhedral grids. In particular, we consider a polyhedral\n\u03baa \u2208 Ta\n\u03baf \u2208 Tf\n(a) Example of acoustic Ta and fluid Tf tessellations made of hexahedral and polyhedral elements, respectively, for the domain \u2126 = \u2126a = \u2126f.\n(b) Bounding Box search. Left, overview on the whole domain. Right, zoom on a selected acoustic element Ka. At this stage, all the bounding box of the fluid elements intersecting B(Ka) are selected and collected in the set Ka. We show some of the selected fluid elements (yellow \u25cf, red \u25cf and blue \u25cf) and their respective bounding box.\nFigure 4: Schematic representation of Algorithm 1. (\u25cf) Acoustic element Ka. (\u25cf) Example of a fluid element Kf \u2208 Ia. (\u25cf) Example of a fluid element Kf \u2208 Ka but not intersecting with the selected element Ka. (\u25cf) Example of a fluid element Kf \u2208 Ca.\ntessellation Tf for the fluid domain \u2126f, while a hexahedral tessellation Ta for the acoustic domain \u2126a, see for instance Figure 4a. This choice is inherited from the numerical scheme that we apply to the aeroacoustic problem (see Section 2.3- 2.4), even if the proposed algorithm is valid for generic polyhedral grids. Depending on the characteristic wave-length of the problem and on the numerical schemes considered, we assume that the number of fluid elements Kf is greater than the number of acoustic ones Ka and that the elements are all convex polyhedra. Considering polyhedra elements allows us to use the Separating Axis Theorem (SAT) for detecting if two elements have non-empty intersection. The main idea of the SAT is that, if two elements have empty intersection, then there exists a plane that separates them. Only a few directions depending on the normals to the faces of the elements and the edge elements have to be checked. A detailed description of the SAT algorithm can be found in [13, Chapter 8]. Before presenting the algorithm for computing the intersections between Ka and Kf we introduce some definitions and notations. Definition 4.1 (Cartesian Bounding Box) Given a polyhedral element K \u2282 R3, we denote with vi = (xi, yi, zi) with i = 1, . . . , nv the nv vertices of K. We indicate with B(K) his Cartesian bounding box: B(K) = \u03a0\u03b1\u2208{x,y,z}[\u03b1min, \u03b1max], (37) where \u03b1min = min\ni=1,...,nv \u03b1i, \u03b1max = max i=1,...,nv \u03b1i and where \u03b1i \u2208 {xi, yi, zi}. We indicate with B(K)\nhis Cartesian bounding box:\nB(K) = [xmin, xmax] \u00d7 [ymin, ymax] \u00d7 [zmin, zmax], (38)\nwhere xmin = min i=1,...,nv xi, xmax = max i=1,...,nv xi, ymin = min i=1,...,nv yi, ymax = max i=1,...,nv yi, zmin = min i=1,...,nv zi, zmax = max i=1,...,nv zi.\nFor any element Ka \u2208 Ta, we define:\n\u2022 the set Ka collecting all the fluid elements Kf whose bounding box B(Kf) intersects the bounding box B(Ka), i.e., B(Kf) \u2229 B(Ka) \u2260 \u2205;\n\u2022 the set Ca collecting all the fluid elements Kf whose bounding box B(Kf) is strictly contained inside Ka, i.e. B(Kf) \u2282Ka;\n\u2022 the set Ia collecting all the fluid elements Kf that have to be explicitly intersected with Ka.\n\u2022 the set Ia collects all the remaining fluid elements intersecting with Ka. The fluid elements Kf do intersect with Ka, but their bounding box is not fully contained inside Ka and hence the intersection has to be computed explicitly.\nWe remark that the cardinality of Ka is strictly greater than the cardinality of Ca \u222a Ia. Furthermore, note that not all the elements intersecting withKa are in Ia, since part of them is contained in Ca. Algorithm 1 computes the intersections between Ta and Tf proceeding as follows: for any element Ka \u2208 Ta,\n1. Bounding Box search: search over the intersecting bounding boxes of the fluid elements B(Kf) and the bounding box B(Ka) of the acoustic element Ka. If the intersection is not empty, the element Kf is added to the set Ka, see Figure 4b.\n2. Bounding Box selection: map the vertices of B(Kf) via a Newton-Raphson algorithm by employing the trilinear map \u03b8Ka . If all the vertices are inside the reference element K\u0302A, then Kf is added to Ca, see Figure 5a.\n3. Separating Axis Theorem selection: apply the SAT collision detection algorithm in order to understand if the intersections have to be computed. In fact, there might be fluid elements in Ka that are not effectively intersecting Ka, see for instance Figure 5b. The intersecting elements are added to Ia.\n4. Intersection computation: compute explicitly the intersection between the fluid elements in Ia and the acoustic element Ka, cf. Figure 5c.\nWe remark that Step 2. of the algorithm is justified by the assumption that fluid elements are much smaller then the acoustic ones. The final intersection (Step 4.) is computed by employing the Computational Geometry Algorithms Library (CGAL) [48], and it is based on the Nef implementation [21] that allows performing Boolean operations between solids."
        },
        {
            "heading": "4.2 A quadrature-free method for integral evaluation",
            "text": "In this section, we explain how to compute numerically the integrals defined on the righthand side of (20). In the aeroacoustic solver this technique is used for computing the right-hand side of (17). We remark that if in Va we consider only linear polynomials in each space direction, i.e., r = 1, and if the maps \u03b8Ka are linear for any Ka \u2208 Ta, then it is convenient to use a mid-point quadrature method. In this case, (21) becomes\n\u2211 Ka\u2208Ta (qa, \u03d5a,i)Ka = \u2211 Ka\u2208Ta\nNf \u2211 \u2113=1 q\u0302f,\u2113(1, \u03d5a,i)Ka\u2229Kf,\u2113 = \u2211 Ka\u2208Ta Nf \u2211 \u2113=1 q\u0302f,\u2113\u03d5a,i(xb)\u2223Ka \u2229Kf,\u2113\u2223, (39)\nwhere xb is the barycentre of the intersection element Ka\u2229Kf,\u2113, and \u2223Ka\u2229Kf,\u2113\u2223 is the volume of the intersection. The cut-volume cell-based interpolation that was proposed in [43] can be interpreted exactly as this mid point quadrature projection method. In fact in the latter work, the projection is evaluated by computing the intersections between a tetrahedral\nAlgorithm 1 Algorithm to compute the intersection Ta \u2229 Tf between the grids Ta and Tf. [Ta \u2229 Tf] = compute intersection(Ta,Tf)\n1: for Ka \u2208 Ta do 2: Compute B(Ka). 3: for Kf \u2208 Tf do 4: Compute B(Kf). 5: if B(Ka) \u2229 B(Kf) then 6: Add Kf in Ka. 7: if B(Kf) \u2282Ka then 8: Kf \u2229Ka =Kf and Kf \u2208 Ca. 9: Add Kf to Ta \u2229 Tf. 10: break 11: end if 12: if Ka \u2229Kf then 13: Add Kf in Ia. 14: else 15: Elements are not intersecting. 16: end if 17: end if 18: end for 19: for ( Kf \u2208 Ia ) do 20: Compute intersection (Ka \u2229Kf) with CGAL. 21: Add Kf \u2229Ka to Ta \u2229 Tf. 22: end for 23: end for\nacoustic grid and a tetrahedral fluid grid and then using a mid-point quadrature rule on the intersected elements. However, when considering higher-order polynomials, i.e., r > 1 in Va, or generic trilinear maps, leads to inexact quadrature integration that deteriorates the quality of the projection, as it will be numerically assessed in Sec. 6. For this reason, we look for a quadrature formula that is able to integrate high-order polynomials on generic polyhedral elements (intersection of fluid and acoustic elements). When integrating polynomials over a polyhedral domain, one of the most popular choices is to sub-tessellate the polyhedral domain and then apply therein a standard quadrature formula over the tetrahedral mesh. This is in general computationally expensive. For that reason we employed a Laserre-like integration [8], that has already been successfully applied in the context of discontinuous Galerkin methods, see for instance [5]. The employed quadrature formula is able to integrate exactly homogeneous functions over general polyhedra K. We report here for completeness the main feature of the quadrature method, and refer to [5] for further details. Let the polyhedron K \u2282 R3 be a closed polytope, whose boundary \u2202K is defined by m faces Fi \u2208 R2, with i = 1, . . . ,m. To each face Fi we associate a normal vector ni. Also, each face Fi lies on a hyperplane Hi, and hence to each face Fi we associate a scalar bi such that \u2200x \u2208 Hi we have that ni \u22c5 x = bi. Moreover, we split the polyhedron boundary as the union of m faces, i.e., \u2202K = m\n\u22c3 i Fi, and the boundary of each face Fi as the union of mi edges,\ni.e., \u2202Fi = mi\n\u22c3 j\nFij. Finally, the mij vertices of each edge Fij are denoted by \u2202Fij = mij\n\u22c3 k Fijk.\nLet g to be homogeneous of degree q > 0, namely,\nqg(x) = \u2207g(x) \u22c5 x \u2200x \u2208 K, (40)\nand recall the generalized Stokes\u2019 theorem, see [47]:\n\u222b K (\u2207 \u22c5V(x))g(x)dx + \u222b K \u2207g(x) \u22c5V(x)dx = \u222b \u2202K V(x) \u22c5 ng(x)d\u03c3, (41)\nwhere V \u2236K \u2192 R3 is a generic vector field. By selecting V(x) = x, and by applying (40) we have\n\u222b K g(x)dx = 1 3 + q \u222b\u2202K x \u22c5 ng(x)d\u03c3 = 1 3 + q m \u2211 i=1 bi\u222b Fi g(x)d\u03c3. (42)\nNext, by applying recursively integration by parts on (42), we obtain the following quadrature formula for computing the integral of a homogeneous function over a polyhedron K:\n\u222b K g(x)dx = 1 q + 3 m \u2211 i=1 bi 2 + q ( mi \u2211 j=1 dij \u222b Fij g(x)d\u03bd + \u222b Fi x0,i \u22c5 \u2207g(x)d\u03c3) ,\n\u222b Fij g(x)d\u03bd = 1 1 + q (\nmij \u2211 k=1 dijk \u222b Fijk g(x)d\u03be + \u222b Fij\nx0,ij \u22c5 \u2207g(x)d\u03bd) , (43)\nwhere dij is the Euclidean distance between the arbitrary point x0,i and the edge Fij and dijk is the Euclidean distance between the arbitrary point x0,ij \u2208 Fij and the vertex Fijk. We now apply the quadrature free rule described by Equation (43) to (20). since the integrated function is a polynomial, namely, it is a homogeneous function of degree r . Each polynomial can be seen as sum of monomials, that are homogeneous function in the sense of eq. (40). Moreover, since we are employing spectral element methods, we usually integrate over a family of monomials. To speed up the whole algorithm, the integrated monomials over K are stored and reused upon need. For further details on the implementation, we refer to Algorithm 2 in [5]."
        },
        {
            "heading": "5 Computational aspect of the intersection algorithm",
            "text": "In this section, we investigate some computational aspects of the algorithm presented in Section 4.1. First, we verify the intersection algorithm in terms of accuracy and scalability. Then, we use Algorithm 1 together with the quadrature-free method in Section 4.2 to compute integrals of polynomials over the domain \u2126.\nTo check the accuracy of the proposed intersection algorithm we consider the following mesh configurations. In the first test, we set \u2126 = \u2126f = \u2126a = (\u22122,2) \u00d7 (\u22122,2) \u00d7 (\u22120.05,0.05) and define the acoustic grid T 1a (resp. fluid grid T 1f ) by extruding in the vertical direction distorted quadrilaterals (resp. polygons), cf. Figure 6. The acoustic grid has 64 elements and the original Cartesian mesh size was ha = 0.5, while the fluid grid has 109 elements and hf = 0.5. In the second test, we consider \u2126 = \u2126f = \u2126a = (\u22120.5,0.5)3 and use a Cartesian grid T 2a with 64 elements and ha = 0.25 in \u2126a, while a Voronoi polyhedral grid T 2f with 1000 elements and hf = 0.1 in \u2126f, see Figure 7. The computed intersections are shown in Figures 6 and 7 (right). To have a quality check of the performed algorithm we color the resulting grid T 1a \u2229T 1f in the following way. All the intersections between elements in T 1f and a single element in T 1a have the same color. It is possible to notice that even small elements are intersected properly by the proposed intersection algorithm, cf. Figures 6 and 7 (right). To show the accuracy of the proposed intersection algorithm, we consider the following verification test that computes the integral of polynomial functions over the intersection grid Ta \u2229 Tf. In Tables 1 and 2 we report the relative errors\nErel(f) = \u2223(\u222b\u2126 fdx \u2212 \u222bT fdx)\u2223 \u2223(\u222b\u2126 fdx)\u2223 , (44)\ncomputed by employing the quadrature free method in Section 4.2, by varying the mesh T of the domain \u2126. Here, \u03d5 is a generic monomial function. Since the quadrature-free algorithm is exact for homogeneous functions, from the results it is possible to conclude that the intersection computation does not introduce any additional error.\nTo assess the scalability of the algorithm we consider \u2126 = \u2126f = \u2126a = (\u22120.5,0.5)3. We tessellate the domain \u2126a (resp. \u2126f) with a grid made by 323 (resp. 653) elements. The total number\nof computed intersections is 884736, with \u2211Ka\u2208Ta card(Ca) = 39304 and \u2211Ka\u2208Ta card(Ia) = 845432, see Section 4.1, that is where most of the computational time is spent by the algorithm concerns the evaluation of actual intersections, i.e., lines 17-19 of Algorithm 1.\nWe perform a strong scalability test on the G100 cluster located at Cineca, by keeping the same computational grids while varying the number of available cores. From Figure 8 it is possible to notice that the algorithm scales well up to 128 cores. Then, since the partitioning of the acoustic mesh is independent of the underlying fluid grid, the number of intersecting elements for larger decompositions might vary largely between the processors, leading to unbalance in the intersection computations. To verify this, we design a larger test where an acoustic Cartesian grid with 643 elements and a fluid grid with 653 elements are considered. The total number of computed intersections is \u2211Ka\u2208Ta card(Ia) = 7077888. On this latter test, where more elements are employed, the balance of the intersection is good and the scalability is almost ideal.\n6 Convergence results for the L2-projection method\nIn this section, we inquire about the convergence properties of the developed projection method. In particular, we verify the theoretical estimate in Theorem 3.4 for the approximation error \u2225f \u2212 fa\u2225L2(\u2126) and compare our approach with the one presented in [43]."
        },
        {
            "heading": "6.1 Verification and validation test cases",
            "text": "We consider a cubic domain \u2126 = \u2126a = \u2126f = (\u22120.5,0.5)3 and two Cartesian nested tessellation Ta and Tf, being the acoustic mesh size ha a multiple of fluid one hf. Next, we consider f = cos(2\u03c0x) cos(2\u03c0y) cos(\u03c0z) and compute Ea = \u2225f \u2212 fa\u2225L2(\u2126), where fa is the projection defined as in Figure 3 and computed as described in Eq. 20 employing the quadrature method discussed in Sec. 4.2. In Figure 9 we report the projection error Ea, by varying hf for fixed values of ha and the polynomial degree r. It is clear that the error Ea saturates as\nwe refine hf. Indeed, by triangle inequality, we observe that\nEa \u2264 \u2225f \u2212 fp\u2225L2(\u2126) + \u2225fp \u2212 fa\u2225L2(\u2126), (45)\nand that \u2225f \u2212 fp\u2225L2(\u2126) is the leading term of the error independent of hf. This is confirmed by the plots reported in Figure 10 where we show the trend of the error \u2225fp \u2212 fa\u2225L2(\u2126) as a function of hf. The latter is proportional to h2f as predicted by (36). On the other hand, the error \u2225f \u2212 fp\u2225L2(\u2126) remains constant, cf. (32). Moreover, we notice that increasing the polynomial degree r, keeping fixed ha, reduces the saturation value reached by the error \u2225f \u2212fa\u2225L2(\u2126). Finally, in Figure 11 (left), we plot the error \u2225f \u2212fp\u2225L2(\u2126) versus the mesh size ha while in Figure 11 (right) the same quantity is shown as a function of r. The expected convergence rate given by estimate (32) is confirmed by the numerical results.\nWe provide the following rule of thumb to decide how to relate the acoustic and fluid grid in terms of mesh sizes ha, hf, and polynomial degree r. Lower projection errors would be generally obtained if both grids have a similar number of degrees of freedom. As seen from estimate (30), the approximation error Ea is lower employing for the acoustic problem a low order polynomial degree and a spatial resolution comparable to the fluid grid, namely hf \u2248 ha. However, this choice deteriorates the convergence error estimates provided by the Strang Lemma for the SEM-NI method, see e.g., [39, Lemma 10.1]. The numerical tests presented above show that the dependency on the polynomial degree is not so severe as stated in eq. (30), encouraging the use of high-order basis functions.\nWe now consider the mid-point projection defined in Eq. (39). As already discussed, the difference between the projection fa defined in Eq. (20) and Eq. (39) is the employed quadrature method. We first observe that if the underlying map \u03b8Ka is linear for all Ka \u2208 Ta, for r = 1 the two methods coincide. However, as we increase the polynomial degree or if we employ a trilinear map, the quadrature error increases showing that the projection computed with an exact quadrature formula is clearly more accurate, see Fig. 12. In fact, if we want to employ high order polynomials on the acoustic grid, as already discussed before, it is crucial to minimize the projection error to exploit the accuracy provided by the spectral solver. From the numerical tests, it can be seen that the use of the midpoint projection method still provides accurate results since the convergence rate is h2f . However, the number of fluid elements required to have an accurate projection that does not interfere with the discretization error of the acoustic solver increases considerably. The latter makes the computational cost for the computation of the fluid solution, which is the real bottleneck of the workflow, very high."
        },
        {
            "heading": "7 Aeroacoustic Applications",
            "text": "In this section we apply the developed aeroacoustic hybrid strategy to relevant aeroacoustic benchmark problems. First, we test our strategy on a benchmark having an analytical solution, namely, the corotating vortex pair. This problem has been largely employed as a\nbenchmark for aeroacoustic problems, see for instance [35], [30] or [28]. Next, we consider the noise induced by the two-dimensional laminar flow around a squared cylinder."
        },
        {
            "heading": "7.1 Corotating vortex pair",
            "text": "We apply our hybrid aeroacoustic computational strategy to the corotating vortex pair problem. For this test case the fluid solution can be computed analytically based on potential flow theory. Furthermore, an analytical expression for the pressure fluctuations is obtained at the far field, for a detailed derivation of the analytical solution see [36] or [35]. We assume that the flow field induced by the corotating vortex pair is inviscid and incompressible. This assumption allows us to employ a complex potential function \u03a6(z, t) \u2236 C \u00d7 (0, T ] \u2192 C to describe the flow field, namely:\n\u03a6(z, t) = \u0393 2\u03c0i ln(z \u2212 b(t)) + \u0393 2\u03c0i ln(z + b(t)), (46)\nwhere \u0393 is the circulation, i is the imaginary unit and b = r0 exp(i\u03c9t) \u2208 C are the rotating centres of the vortexes, where \u03c9 is the rotational speed defined as \u03c9 = \u0393/(4\u03c0r20) and r0 is the distance with respect to the origin axes, see Figure 13. We introduce the rotating Mach number Mr = \u0393/(4\u03c0r0c0), where c0 is the speed of the wave. The period of the rotating monopoles is Tf = 8\u03c02r20/\u0393, while the emitted period of the acoustic wave is Ta = Tf/2. From the complex potential in (46) we compute the two-dimensional fluid flow velocity u = [u; v] as\nu \u2212 iv = \u2202 \u2202z \u03a6(z, t), (47)\nand then we compute the Lighthill\u2019s stress tensor. We report the far field solution for the pressure fluctuations p\u2032 = p \u2212 p, see for instance [40]:\np\u2032(z, t) = \u2212 \u03c10c 2 0 64\u03c03 ( \u0393 r0c0 ) 4 [J2(kr) sin(2(\u03b8 \u2212 \u03c9t) + Y2(kr) cos(2\u03b8 \u2212 \u03c9t)], (48)\nwhere J2 and Y2 are respectively the first and second type Bessel functions, k = 2\u03c9/c0 and z = r exp (i\u03b8). As already showed in [30], a desingularization model is required in order to avoid numerical issues in representing the source vortexes. Here, we employ the Scully model [45] getting\nu\u03b8(rv) = \u0393rv\n2\u03c0(r2c + r2v) , (49)\nwhere rc is the desingularized core radius, u\u03b8(rv) is the tangential velocity and rv is the distance with respect to the vortex core center.\nFluid Setup\nWe consider the corotating vortex pair problem with the parameters summarized in Table 3. The fluid domain is a circle \u2126f with radius 15r0. The flow solution is computed by employing the complex velocity in (47) and then the Lighthill\u2019s tensor \u2207 \u22c5T = \u03c10\u2207 \u22c5 (u\u2297 u) as a postprocess of the flow velocity, see Section 2.3. The solutions are saved at each time instant with time step \u2206tf = 0.02. Since the solution is periodic, we store the solutions up to Ta.\nAcoustic Setup\nThe acoustic domain \u2126a is a circle of radius 150r0. A circular domain has been chosen since the employed absorbing boundary conditions work better when the incident plane is parallel to the boundary, see [14]. On the external boundary \u0393abs absorbing conditions are imposed. We employ a polynomial degree r = 2 for the SE discretization. We consider a structured grid meshing strategy with a total of 57500 elements. Each vortex has around at least 15 elements. For the time discretization, an implicit Newmark method is used, see for instance [27] or [4], with \u03b2 = 0.5, \u03b1 = 0.25 and \u2206ta = 0.02. In order to avoid spurious oscillation due to the non-consistent initial conditions, see [15] or [32], the following time ramp is multiplied by the source term f(t) = 1 2 (1 \u2212 cos(\u03c0 t Tend )), where Tend = Ta, up to Tend.\nNumerical results\nThe acoustic field generated by a pair of corotating vortices is a rotating acoustic quadrupole as can be seen from Figure 15. The numerical solution obtained through the proposed algorithm matches the analytical solution as it is shown in Figure 14, where we sampled the pressure fluctuations p\u2032 along the line y = 0 with x > 0 at T = 380 s. The results obtained with the analytical solution have been normalized to a reference pressure pref = max(p\u2032) in order to take into account the desingularization effect in (49), see for instance [41]."
        },
        {
            "heading": "7.2 Flow around a squared cylinder at low Reynolds number",
            "text": "Finally, we consider the case of a laminar flow around a square cylinder, see for instance the Direct Numerical Simulation (DNS) performed by [24] or the solution obtained with a Curle analogy in [1]. When a rigid squared cylinder is placed in a uniform flow, it exhibits strong vortex shedding, resulting in fluctuating forces due to the alternating pressure highs and drops at the wake. These forces and the turbulence in the wake generate noise. For\nlaminar flows, the main frequency radiated from the body is associated with the Strouhal number and the intensity of the observed noise is proportional to the fluctuation of the forces. The flow solution has been computed by employing the Pressure Implicit Splitting Operator (PISO) method implemented in OpenFOAM [50].\nFluid Setup\nA laminar two-dimensional incompressible simulation of a fluid flow around a square cylinder is performed. Let D = 3.28 \u00d7 10\u22125 m be the length of the square cylinder, U = 68.7ms\u22121 be the inlet velocity and \u03bd = 1.5 \u00d7 10\u22125m2 s\u22121 the kinematic viscosity. The Reynolds number is Re = 150 and the Mach number is Ma = 0.2. The fluid computational domain \u2126f is (\u221220.5D,100.5D) \u00d7 (\u221220.5D,20.5D), see Figure 16. A fixed velocity U is prescribed at the\ninlet. On the upper and lower wall symmetry conditions are employed. No slip conditions are applied on the cylinder walls. Zero gradient pressure conditions are applied at the wall of the cylinder and at the inlet. On the outlet, the pressure is set to zero, while a zero gradient condition is imposed for the velocity. A block structured h-grid around the square cylinder is used, employing 970000 elements. In Fig. 17 a zoom of the fluid grid is shown. The computational time step is \u2206t = 10\u22129s.\nAcoustic Setup\nTo minimize spurious reflections, the acoustic domain \u2126a is a circle of radius 150D, with an internal square hole of side D, see Figure 16. On the external boundary \u0393abs, absorbing conditions are employed. On the solid wall \u0393b Neumann boundary conditions are imposed. The coupling region is given by \u2126a \u2229 \u2126f = \u2126f. A smoothing function is employed in order to let the sound source term decay to avoid the well known spurious noise generation due to the abrupt domain cut on the wake, see for instance [37] or [33]. We used the following spatial smoothing function:\ng(x) = \u23a7\u23aa\u23aa\u23aa\u23a8\u23aa\u23aa\u23aa\u23a9 1 x < ri, 1 2 (1 + cos(\u03c0 x \u2212 ri ro \u2212 ri )) x \u2265 ri,\nwhere ri is the initial filtering position, while ro is the end of the fluid domain. In this case, it is sufficient to apply the smooth function only downstream and along the x direction, so that ri = 65D and ro = 105.5D. The fluid solution is sampled every 10 fluid time steps, meaning that \u2206ta = 10\u22128s = 10\u2206tf. The expected main frequency is the Strouhal frequency. The acoustic discretization close to the square is h-type, with ha = D/10. Then the grid is unstructured and a o-type grid is employed. The polynomial degree chosen is r = 4. The whole acoustic grid has around 1261500 degrees of freedom. The main wavelength associated to the lift force is \u03bb \u2248 32.5D and around 40 nodes per wavelength where placed in the far field. The acoustic simulation was run for 0.00005s, starting from a fluid time of tf = 0.0001 s, hence with a fully developed flow field. A zoom of the acoustic grid is shown in Fig 17. Note that the acoustic element size is larger than the size of the fluid elements.\nNumerical results\nCD = FD\n1 2\u03c10U\n2A and CL = FL 1 2\u03c10U 2A , where FD and FL are the drag and lift forces respectively,\nwith A =D\u00d7H, being H the width of the domain and having chosen H =D, we plot CL and CD in Figure 18. We introduce the Strouhal number St = f D\nU , with f being the frequency\nof the CL. In Table 4 we compare our results with those available in the literature. The obtained Strouhal number matches the results obtained by [12] and they are aligned with the experiments [38, 46] and the compressible DNS performed by [24]. The intensity of the noise emitted by the square cylinder depends mainly on the fluctuations of the forces. Hence, during the flow computation it is critical to match the root means squared (rms) values. By defining CD as the average of CD, respectively CL, we compute the rms values as\nCL,rms = \u221a (CL \u2212CL)2 and we also identify CL,peak =max(\u2223CL\u2223). Again, from Table 4 we see that out results are in agreement with the ones available in literature. Finally, we compute the acoustic field, namely the noise induced by the flow around the square cylinder. From Figure 19, we see the characteristic dipole pattern, that is mainly due to the lift force acting\non the cylinder. The obtained results are comparable with the compressible simulations, see for instance [11] and [24]. To further validate the obtained acoustic results, we computed the directivity from p\u2032rms = \u221a (p \u2212 p)2. The obtained directivity pattern is in good agreement with the references, see [24] and [1]."
        },
        {
            "heading": "8 Conclusion",
            "text": "We proposed a hybrid computational strategy that couples a finite volume flow solver with a high order acoustic solver for aeroacoustic simulations. First, the fluid flow solution is computed employing the open-source finite volume library OpenFOAM. Then, a postprocessing of the flow solution computes the sound source term on the fluid grid, by means of the Lighthill\u2019s acoustic analogy. Next, a projection method is used to map the flow source term from the fluid to the acoustic grid. Finally, an inhomogeneous wave equation is solved by employing a high-order spectral element method. The employed projection method exploited a robust intersection algorithm that is able to perform the intersection between the two computational grids. Furthermore, we employed a quadrature free method to integrate polynomial functions over the generic polyhedral elements stemming after the intersections computation. We explored the computational aspects of the proposed intersection algorithm both from a theoretical and numerical point of view. Finally, we applied the developed computational strategy to different aeroacoustic problems, showing the effectiveness of the proposed method."
        },
        {
            "heading": "9 Acknowledgements",
            "text": "The authors thank prof. M. Verani, prof. R. Corradi and Dr. P. Schito for the insightful discussions on the topic. We also thank the anonymous reviewers for carefully reading the manuscript and for the insightful comments and suggestions. The simulations have been partly run at Cineca thanks to the computational resources made available through the HO-AERO HP10C9XBN9 ISCRA-C project. A.A., P.F.A., I.M. e N.P. are members of the INdAM Research Group GNCS. P.F.A. has been partially funded by the research projects PRIN n. 201744KLJL, funded by MIUR, and P.F.A. and N.P. have been partially supported by PRIN n. 20204LN5N5 research grant funded by MIUR. P.F.A., I.M. and N.P. have been partially supported by ICSC\u2014Centro Nazionale di Ricerca in High Performance Computing, Big Data, and Quantum Computing funded by European Union\u2014NextGenerationEU."
        },
        {
            "heading": "A Appendix: finite volume approximation",
            "text": "Let us introduce some further geometrical notation, necessary to handle the discretization of the finite volume method on non-structured grids, see Fig. 21. Given two neighbouring cells K+ and K\u2212, we denote with F their common face. Also, let x+ and x\u2212 be the barycentres of the polyhedrons K+,K\u2212, with xF the barycentre of the face, and with n the unit normal to the face F , outward with respect to the element K+. Now, let h be the vector connecting the cell barycentres h = x+ \u2212 x\u2212, and let h = \u2223h\u2223. Now, let x\u2229 be the intersection point between the face F and the vector h. We introduce the interpolation weights w:\nw = h+ h+ + h\u2212 , (50)\nwhere h+ = \u2223x\u2229\u2212x+\u2223 and h\u2212 = \u2223x\u2229\u2212x\u2212\u2223. First, recall the following Gauss gradient reconstruction on the barycentre of the fluid element. Given an element K, its Gauss gradient at the cell centre is approximated by:\n\u2207u \u2248 1\u2223K \u2223 \u2211F \u2208\u2202K uFnF \u2223F \u2223, (51)\nwhere nF is the outward normal face to F , and the value of uF is computed with a linear interpolation: uF = wu+ + (1 \u2212w)u\u2212, (52) where u\u00b1 is the velocity field evaluated at the center of the cells K\u00b1. The gradient \u2207uFn coming from the discretization of the diffusion term in eq. (13) is computed linear approximation including a non-orthogonal correction (see [25]):\n\u2207uFn \u2248 u+ \u2212 u\u2212 h \u22c5 n + (w\u2207u+ + (1 \u2212w)\u2207u\u2212) (n \u2212 h h \u22c5 n) , (53)\nwhere \u2207u\u00b1 are the gradients computed with a Gauss formula at the cell centres of the elements K\u00b1, see eq. (51). Note that in the case of structured orthogonal grids, the formula simply reduces to \u2207uFn \u2248 u+ \u2212 u\u2212\nh .\nConcerning the convective term in (10), the usual algorithms employed by OpenFOAM treat the convective term in an explicit way. So, we assume that the flux u \u22c5n is known, we denote it with b \u22c5 n, and we discretize the convective term with a linear upwind:\n\u2211 F \u2208\u2202Kf uF (b \u22c5 n)\u2223F \u2223 = \u2211 F \u2208\u2202Kf au+ + (1 \u2212 a)u\u2212 +\u2207uup(xF \u2212 xup) (54)\nwhere the weight a is defined as\na = \u23a7\u23aa\u23aa\u23a8\u23aa\u23aa\u23a9 1 if b \u22c5 n \u2265 0, 0 if b \u22c5 n < 0,\n(55)\nand the index up is\nup = \u23a7\u23aa\u23aa\u23a8\u23aa\u23aa\u23a9 + if b \u22c5 n \u2265 0, \u2212 if b \u22c5 n < 0,\n(56)\nwhere \u2207u\u00b1 is computed with a Gauss formula."
        }
    ],
    "title": "A hybrid finite volume - spectral element method for aeroacoustic problems",
    "year": 2023
}