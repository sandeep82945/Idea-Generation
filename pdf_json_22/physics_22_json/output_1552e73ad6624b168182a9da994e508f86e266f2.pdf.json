{
    "abstractText": "Attacks on networks is a very important issue in developing strategies of eradicating spreads of malicious phenomena in networks, such as epidemics and fake information. This field of research is referred to as networks immunization. The traditional approach to evaluating the effectiveness of attacks on networks focuses on measuring macro parameters related to the entire attack, such as the critical probability of a percolation occurrence in the network pc and the relative size of the largest component in the network, known as the giant component, but not considering the attack on a micro perspective, which is the analysis of node removals, during an attack, themselves, their characteristics and results. In this paper we present and apply the last method of focusing on the micro scale of an attack. Based on the theory of percolation in networks, we analyze the phenomenon of an avalanche which results due to a single node removal from a network. An avalanche is a state in which a removal of a single node from the giant component of a network leads to the disconnection of additional nodes. This process significantly contributes to the fragmentation (immunization) of the network, comparing to the impact of the initial node removal alone. Specifically, we focus on the size parameter of an avalanche, which is the number of nodes that are disconnected from the giant component due to a single node removal. Relating to a random attack on a network of the type of Cayley tree, we derive analytically the distribution of the sizes of avalanches that occur during the entire attack on it, until the network is dismantled (immunized) and the attack is terminated.",
    "authors": [
        {
            "affiliations": [],
            "name": "Amikam Patron"
        }
    ],
    "id": "SP:9cd37d5889bde3b9e9ba37bc33984c880178f961",
    "references": [
        {
            "authors": [
                "R. Cohen",
                "S. Havlin"
            ],
            "title": "Complex Networks: Structure, Robustness and Function",
            "year": 2010
        },
        {
            "authors": [
                "S. Shao",
                "X. Huang",
                "H.E. Stanley",
                "S. Havlin"
            ],
            "title": "Percolation of localized attack on complex networks",
            "venue": "New J. Phys. 17,",
            "year": 2015
        },
        {
            "authors": [
                "T. Nie",
                "Z. Guo",
                "K. Zhao",
                "Lu",
                "Z.-M"
            ],
            "title": "New attack strategies for complex networks",
            "venue": "Phys. A Stat. Mech. Appl. 424,",
            "year": 2015
        },
        {
            "authors": [
                "M. Bellingeri",
                "D. Cassi",
                "S. Vincenzi"
            ],
            "title": "Efficiency of attack strategies on complex model and real-world networks",
            "venue": "Phys. A Stat. Mech. Appl. 414,",
            "year": 2014
        },
        {
            "authors": [
                "R. Albert",
                "H. Jeong",
                "Barab\u00e1si",
                "A.-L"
            ],
            "title": "Error and attack tolerance of complex networks",
            "venue": "Nature 406,",
            "year": 2000
        },
        {
            "authors": [
                "B. Shargel",
                "H. Sayama",
                "I.R. Epstein",
                "Y. Bar-Yam"
            ],
            "title": "Optimization of robustness and connectivity in complex networks",
            "venue": "Phys. Rev. Lett. 90,",
            "year": 2003
        },
        {
            "authors": [
                "Kim",
                "J.-H.",
                "Goh",
                "K.-I.",
                "B. Kahng",
                "Kim",
                "D. Probabilistic prediction in scale-free networks"
            ],
            "title": "Diameter changes",
            "venue": "Phys. Rev. Lett. 91, 058701",
            "year": 2003
        },
        {
            "authors": [
                "A.E. Motter",
                "Lai",
                "Y.-C"
            ],
            "title": "Cascade-based attacks on complex networks",
            "venue": "Phys. Rev. E",
            "year": 2002
        },
        {
            "authors": [
                "R. Albert",
                "I. Albert",
                "G.L. Nakarado"
            ],
            "title": "Structural vulnerability of the North American power grid",
            "venue": "Phys. Rev. E",
            "year": 2004
        },
        {
            "authors": [
                "P. Holme",
                "J. Zhao"
            ],
            "title": "Exploring the assortativity-clustering space of a network\u2019s degree sequence",
            "venue": "Phys. Rev. E 75,",
            "year": 2007
        },
        {
            "authors": [
                "H.J. Herrmann",
                "C.M. Schneider",
                "A.A. Moreira",
                "J.S. Andrade",
                "S. Havlin"
            ],
            "title": "Onion-like network topology enhances robustness against malicious attacks",
            "venue": "J. Stat. Mech. Theory Exp. 2011,",
            "year": 2011
        },
        {
            "authors": [
                "Y Lin"
            ],
            "title": "Design of survivable networks in the presence of aging",
            "venue": "Europhys. Lett. 122,",
            "year": 2018
        },
        {
            "authors": [
                "A. Patron",
                "R. Cohen"
            ],
            "title": "Optimal resource allocation for network functionality",
            "venue": "New J. Phys",
            "year": 2020
        },
        {
            "authors": [
                "M. Molloy",
                "B. Reed"
            ],
            "title": "A critical point for random graphs with a given degree sequence",
            "venue": "Random Struct. Algorithms 6,",
            "year": 1995
        },
        {
            "authors": [
                "R. Cohen",
                "K. Erez",
                "D. Ben-Avraham",
                "S. Havlin"
            ],
            "title": "Resilience of the internet to random breakdowns",
            "venue": "Phys. Rev. Lett",
            "year": 2000
        },
        {
            "authors": [
                "P. Erd\u0151s",
                "A. R\u00e9nyi"
            ],
            "title": "On random graphs I",
            "venue": "Publ. Math. Debrecen 6,",
            "year": 1959
        },
        {
            "authors": [
                "P. Erd\u0151s",
                "A. R\u00e9nyi"
            ],
            "title": "On the evolution of random graphs",
            "venue": "Publ. Math. Inst. Hungar. Acad. Sci 5,",
            "year": 1960
        },
        {
            "authors": [
                "S. Redner"
            ],
            "title": "How popular is your paper? An empirical study of the citation distribution",
            "venue": "Eur. Phys. J. B Condens. Matter Complex Syst. 4,",
            "year": 1998
        },
        {
            "authors": [
                "R. Albert",
                "H. Jeong",
                "Barab\u00e1si",
                "A.-L"
            ],
            "title": "Diameter of the world-wide web",
            "venue": "Nature 401,",
            "year": 1999
        },
        {
            "authors": [
                "Barab\u00e1si",
                "A.-L",
                "R. Albert"
            ],
            "title": "Emergence of scaling in random networks",
            "venue": "Science 286,",
            "year": 1999
        },
        {
            "authors": [
                "M.E.J. Newman"
            ],
            "title": "The structure of scientific collaboration networks",
            "venue": "Proc. Natl. Acad. Sci. 98,",
            "year": 2001
        },
        {
            "authors": [
                "D. Stauffer",
                "A. Aharony"
            ],
            "title": "Introduction to Percolation",
            "venue": "Theory (Taylor & Francis,",
            "year": 1994
        },
        {
            "authors": [
                "G. Grimmett"
            ],
            "title": "Percolation, Grundlehren der Mathematischen Wissenschaften",
            "venue": "edn. (Springer,",
            "year": 1999
        },
        {
            "authors": [
                "G.A. Braga",
                "R. Sanchis",
                "T.A. Schieber"
            ],
            "title": "Critical percolation on a Bethe lattice revisited",
            "venue": "SIAM Rev. 47,",
            "year": 2005
        },
        {
            "authors": [
                "D.J. Watts",
                "S.H. Strogatz"
            ],
            "title": "Collective dynamics of \u2018small-world",
            "venue": "networks. Nature 393,",
            "year": 1998
        },
        {
            "authors": [
                "R. Pastor-Satorras",
                "A. Vespignani"
            ],
            "title": "Immunization of complex networks",
            "venue": "Phys. Rev. E 65,",
            "year": 2002
        },
        {
            "authors": [
                "Z. Dezs\u0151",
                "Barab\u00e1si",
                "A.-L"
            ],
            "title": "Halting viruses in scale-free networks",
            "venue": "Physi. Rev. E 65,",
            "year": 2002
        },
        {
            "authors": [
                "Y Liu"
            ],
            "title": "Efficient network immunization under limited knowledge",
            "venue": "Natl. Sci. Rev. 8,",
            "year": 2021
        },
        {
            "authors": [
                "D. Dhar",
                "S. Majumdar"
            ],
            "title": "Abelian sandpile model on the Bethe lattice",
            "venue": "J. Phys. A Math. Gen",
            "year": 1990
        },
        {
            "authors": [
                "S Buldyrev"
            ],
            "title": "Avalanches in the directed percolation depinning and self-organized depinning models of interface roughening",
            "venue": "Fractals 4,",
            "year": 1996
        },
        {
            "authors": [
                "A. Gabrielli",
                "G. Caldarelli"
            ],
            "title": "Invasion percolation on a tree and queueing models",
            "venue": "Phys. Rev. E 79,",
            "year": 2009
        },
        {
            "authors": [
                "Barab\u00e1si",
                "A.-L.",
                "S.V. Buldyrev",
                "H.E. Stanley",
                "Suki",
                "B. Avalanches in the lung"
            ],
            "title": "A statistical mechanical model",
            "venue": "Phys. Rev. Lett. 76, 2192",
            "year": 1996
        },
        {
            "authors": [
                "A.M. Alencar",
                "S.V. Buldyrev",
                "A. Majumdar",
                "H.E. Stanley",
                "B. Suki"
            ],
            "title": "Avalanche dynamics of crackle sound in the lung",
            "venue": "Phys. Rev. Lett. 87,",
            "year": 2001
        }
    ],
    "sections": [
        {
            "text": "1 Vol.:(0123456789) Scientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nwww.nature.com/scientificreports"
        },
        {
            "heading": "Avalanche\u2011size distribution",
            "text": "of Cayley tree"
        },
        {
            "heading": "Amikam Patron",
            "text": "Attacks on networks is a very important issue in developing strategies of eradicating spreads of malicious phenomena in networks, such as epidemics and fake information. This field of research is referred to as networks immunization. The traditional approach to evaluating the effectiveness of attacks on networks focuses on measuring macro parameters related to the entire attack, such as the critical probability of a percolation occurrence in the network pc and the relative size of the largest component in the network, known as the giant component, but not considering the attack on a micro perspective, which is the analysis of node removals, during an attack, themselves, their characteristics and results. In this paper we present and apply the last method of focusing on the micro scale of an attack. Based on the theory of percolation in networks, we analyze the phenomenon of an avalanche which results due to a single node removal from a network. An avalanche is a state in which a removal of a single node from the giant component of a network leads to the disconnection of additional nodes. This process significantly contributes to the fragmentation (immunization) of the network, comparing to the impact of the initial node removal alone. Specifically, we focus on the size parameter of an avalanche, which is the number of nodes that are disconnected from the giant component due to a single node removal. Relating to a random attack on a network of the type of Cayley tree, we derive analytically the distribution of the sizes of avalanches that occur during the entire attack on it, until the network is dismantled (immunized) and the attack is terminated.\nAn attack on networks, which is a scenario where a combination of nodes (or links) of a network are removed and become non-functional causing the entire network to be dismantled and non-functional, is an issue that has been studied widely1\u201323. There are two types of attacks on networks, on them the research has been focused: random attack and targeted attack1. In a random attack, the attacker has no information about the network and its topology. Therefore, the choice of the nodes to be attacked is implemented randomly, with no priority of each node to be attacked before or after another node. In each attack stage, the attacker selects a node at random from the set of nodes that have not been attacked until that stage, and attacks it. On the other hand, in a targeted attack the attacker has some information about the network and its characteristics, and according to it there are some priorities of attacking some nodes before other nodes. Therefore, in each attack stage the attacker attacks the node with the highest priority among the set of nodes were not attacked until then. An example of a widely studied targeted attack is where the attacker has information about the degree of each node in the network, and at each stage of the attack the node with the highest degree among the nodes that have not been attacked\u00a0yet, is selected to be attacked. Other traditional types of attacks on networks have also been studied, such as localized attack2 where the attack affects just a certain region of the network, removing nodes sequentially according to some node characteristics such as betweenness centrality3, a combination of the degree and betweenness centrality4, second neighbors degree5 and so on.\nA very important issue related to attacks on networks, is the robustness of a network, which refers to its capability to remain functional during an attack. There have been many studies about the way of parameterizing the robustness of networks. Some approaches are based on comparisons of network\u2019s parameters before and after the attack such as a change in the network diameter6\u20138, the relative size of the large component of the network9, change in the betweeness centrality3, connectivity loss10, and f-robustness11. Other methods are based on measuring the mean functionality level of a network during an entire attack such as the integral of the network\u2019s largest component with respect to time during the attack12\u201315.\nAn important method of measuring the robustness of a network is based on percolation theory24,25. The basic description of percolation theory is related to lattices. It presents a state where the sites (or the bonds) of a lattice are occupied with probability p, and unoccupied with probability 1\u2212 p . For each lattice structure (such as BCC, FCC, Honeycomb etc.) there is a critical probability denoted by pc . If p > pc , a cluster of occupied sites that spans the lattice from one side to the other, named\u00a0spanning cluster or infinite cluster, exists in the lattice.\nOPEN\nDepartment of Mathematics, Jerusalem College of Technology, 91160 Jerusalem, Israel. email: patron@g.jct.ac.il\n2 Vol:.(1234567890) Scientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nConversely, if p < pc there is no spanning cluster in the lattice24. When a spanning cluster exists in a lattice, we say that a percolation occurs in the lattice.\nThe same state could be presented in networks, where the nodes (or the edges) of a network are occupied with probability p and unoccupied with probability 1\u2212 p . However, for defining a percolation in random networks, where the linking of the set of nodes by edges is performed randomly, we cannot apply the criterion of a spanning cluster as in lattices, since due to the network structure there is no meaning of spanning the network from one side to the other. Instead, another criterion has been stated for percolation in random networks, which is the existence of a large component of occupied nodes whose size scales with the network\u2019s size, i.e. O(N), named giant component. That is, a typical property of a random network is a critical probability of node occupation pc , such that if p > pc , a giant component exists in the network, and if p < pc , the network is fragmented into small components and a giant component does not exist. A smaller pc implies a more robust network, as it requires removing a large fraction of 1\u2212 pc of the network\u2019s nodes to fragment it.\nIn16,17 it was shown that the criterion for percolation in random network, i.e. the existence of a giant component in the network, was generated by the configuration model, is \u03ba = \ufffdk\n2\ufffd \ufffdk\ufffd > 2 , where \u3008k\u3009 is the expectation of\nthe node degree and \u3008k2\u3009 is the expectation of the square of the node degree. According to this criterion, it was shown that for a\u00a0random network under random attack\nwhere \u03ba0 is the value of \u03ba before the attack on the network begun17. From this, the value of pc for two types of random networks are studied widely, was calculated: (i) For Erd\u0151s\u2013R\u00e9nyi networks18,19, where the node\u2019s degree k follows a Poisson distribution P(k) = e\u2212 k\nk! , it was shown that pc = 1 . (ii) For Scale-Free networks, a\ntopology that was found in many real networks20\u201323, where the node\u2019s degree k follows a power-law distribution P(k) \u223c k\u2212\u03b3 , such that most of the nodes have a very small degree but there is also a small fraction of nodes with a very high degree named hubs, it was shown that for \u03b3 > 3 , pc has a finite nonzero value, but for \u03b3 \u2264 3 , pc approaches 0 as N tends to infinity. That means that although almost all of the network\u2019s nodes are removed, there still exists a giant component in the network and the network is considered functional.\nAnother type of network that has been studied widely including its robustness and aspects of percolation, is the Bethe-Lattice (BL). The BL is a network of the type of an infinite tree (no cycles) where all its nodes have the same degree Z. Using Eq.\u00a0(1), it was shown1\u00a0that under random attack, the critical percolation threshold pc of the BL with Z neighbors per node is\nThis expression was also derived in26 and in27, applying other methods. Another type of network that is similar to the BL but not identical is the Cayley tree (CT), which is a BL but with a finite number of nodes arranged in a finite number of layers. That is, in a CT there is a unique node from it the tree begins. This node is linked to Z neighbors that form the first layer of the tree. Then each node of the first layer is linked to other Z \u2212 1 neighbors, all of which form the second layer of the tree. Each node of the second\u00a0layer is linked to other Z \u2212 1 neighbors, all of which form the third layer of the tree, and so on. This process is terminated in the last layer, where each node of this layer is not branched again to some other Z \u2212 1 nodes of some next layer. The critical probability pc of the CT is not the same as of BL, as its finite-size needs to be considered24. Below in this paper, we present a method for calculating the critical probability pc of a CT.\nIn general, the robustness of a network is a critical characteristics for its survivability under malicious attacks. However, there are typical states where an attack on a network is desirable, such as when an extinction of negative phenomena spreading within the network is required, as in the case of an epidemic, fake information, or damage. There are indeed many studies that address the issue of eradicating negative phenomena in networks28\u201331, which is known as network immunization.\nHowever, almost all the studies on network attacks from the perspective of percolation theory, focus on the network\u2019s macro-level properties, such as the percolation threshold pc and the size of the giant component relative to the network\u2019s size. They do not address the micro-scale aspects of the attack, such as the characteristics and outcomes of individual node removals.\nIn this paper, we present the approach of analyzing attacks on networks from a micro-scale perspective, as mentioned above. Our focus is on a phenomenon called an avalanche, which occurs when an attack on a node that is part of the giant component causes it to disconnect from the component. Consequently,\u00a0this disconnection, causes other nodes that were not directly attacked but are dependent on the attacked node to be\u00a0disconnected from the giant component\u00a0as well. The total number of nodes that are disconnected from the giant component due to an avalanche, is called the size of the avalanche. Specifically, we focus on a network of the CT type and develop analytical expressions for the probability distribution of the various sizes of avalanches that occur during a random attack on this network.\nWe note that in various studies,\u00a0certain phenomena have been modeled using a series of avalanches on BL and CT, such as avalanches of an Abelian sandpile32, avalanches in a depinning model that model the growth of rough interfaces33, avalanches of occupied sites modeled by queuing models34, and avalanches of a gas during its propagation in the opened alveolus of the lung35,36. However, the model and analysis of avalanches that occur during an attack on a\u00a0CT has not been studied\u00a0yet, which is also an innovative aspect of this work.\n(1)pc = 1\n\u03ba0 \u2212 1 ,\n(2)pc = 1\nZ \u2212 1 .\n3 Vol.:(0123456789) Scientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1"
        },
        {
            "heading": "The model",
            "text": "We define the CT structure as follows: The node from it the tree begins is referred to as the \u2018root\u2019. A \u2018neighbor\u2019 of a node is a node that is linked to it. Moving away from the root, going from a node to its neighbor is called \u2018walking down the tree\u2019, while moving towards the root is called \u2018walking up the tree\u2019. The \u2018sons\u2019 of a node are the node\u2019s neighbors when walking down the tree. The \u2018father\u2019 of a node is the node\u2019s neighbor when walking up the tree. The \u2018descendants\u2019 of a node are all the nodes that can be reached from it by walking down the tree (a node\u2019s son is also its descendant). The \u2018ancestors\u2019 of a node are all the nodes that can be reached from it by walking up the tree (a node\u2019s father is also its ancestor). The first layer of the tree is the set of all the sons of the root and is referred to as \u2018generation 1\u2019. The second layer of the tree is the set of all the sons of nodes in generation 1 and is called \u2018generation 2\u2019, and so on. The number of layers in the tree is represented by L. The nodes in the L\u2019th layer of the tree are the terminal nodes and are called the \u2018surface\u2019 of the tree. The set of these nodes is referred to as \u2018generation L\u2019. The network is attacked in stages, where each stage involves selecting a random node in the network to be attacked. Once a node has been attacked, it cannot be selected again. The attack continues until a sufficient number of nodes have been attacked, to cause a phase transition where the network is dismantled and the giant component is fragmented.\nDuring an attack on the network, a node can be in one of three modes: white, black, or grey. Initially, before the attack begins, all nodes are considered functional and are in the white mode. During the attack, if a white node is attacked, it becomes non-functional and is switched to the black mode. Additionally, all its descendants that are still functional and in the white mode are switched to the non-functional grey mode, as the attacked node cuts off their path up the tree to the root. It is important to note that grey nodes, although non-functional, have not been attacked and can still be chosen to be attacked in subsequent stages. If a grey node is attacked, it is switched to the black mode. According to these definitions of the three modes, it is guaranteed that the ancestors of a white node can be only white, and the descendants of a white node can be white or black. The ancestors of a grey node can be grey or black, and the descendants of a grey node can be grey or black. The ancestors of a black node can be white, grey, or black, and the descendants of a black node can be grey or black. Since the root of the tree has no father, it can be in white mode or black mode only.\n\u2018Avalanche\u2019 as defined above is a combination of nodes that become disconnected from the giant component due to the removal of a single node. In our model, an avalanche is a change in the mode of a set of white nodes resulting from an attack on a white node. The attacked node switches to black mode, and its white descendants switch to grey mode. The \u2018avalanche size\u2019 is the number of white nodes that change their mode during an avalanche. A \u2018complete avalanche\u2019 is an avalanche where all the descendants of the white attacked node are also white. This causes the attacked white node to switch to a\u00a0black mode, and all its descendants down the tree until the surface of the tree switched to a\u00a0grey mode. For example, in a CT with Z neighbors, attacking a white node in the Lth layer causes a complete avalanche of size 1. Attacking a white node in the L\u2212 1 layer, where its Z \u2212 1 sons of the Lth layer are in white mode, causes a complete avalanche of size 1+ (Z \u2212 1) = (Z\u22121)\n2\u22121 Z\u22122 = Z . Attacking a\nwhite node in the L\u2212 2 layer, where its Z \u2212 1+ (Z \u2212 1)2 descendants ( Z \u2212 1 of the L\u2212 1 layer and (Z \u2212 1)2 of the Lth layer) are in white mode, causes a complete avalanche of size 1+ (Z \u2212 1)+ (Z \u2212 1)2 = (Z\u22121)\n3\u22121 Z\u22122 , and\nso on. In general, attacking a white node in the L\u2212m+ 1 layer ( m = 1, 2, 3, . . . , L ), where all its descendants are in white mode, causes a complete avalanche of size (Z\u22121)\nm\u22121 Z\u22122 . An \u2018incomplete avalanche\u2019 is an avalanche that\nis not of the complete avalanche type. It occurs when the descendants of a white attacked node are not all in white mode (some of them were switched to a\u00a0black or a\u00a0grey mode before the current attack on their ancestor). According to the formal definition of an avalanche, attacking a grey node does not cause an avalanche (since it was already disconnected from the giant component before it was attacked). However, we define this state as a \u2018null avalanche,\u2019 meaning that a node was attacked but it does not contribute to the reduction of the giant component size. The null avalanche size is 0.\nFigure\u00a01 is an illustration of the model. It presents three stages of an attack on a\u00a0CT with Z = 3 neighbors and L = 3 layers, including presentations of a\u00a0complete avalanche, an\u00a0incomplete avalanche and a\u00a0null avalanche\u00a0that occur during the attack.\nCritical probability pc of a Cayley tree\nI. Definitions.\nWe define the following regarding random choices of nodes in the tree: the probability of randomly selecting a black node is denoted by pb . Since only one node is attacked and switched to a black mode at each attack stage, then\u00a0between stages k and k + 1 of an attack, pb = kN , where N is the size of the tree.\nWe denote the events of randomly selecting a node of white, grey or black mode as W, G and B, respectively. The events of selecting a node that is not of white, not of grey, or not of black mode are denoted as W , G and B , respectively. The events of randomly selecting a node of the first generation, second generation, and so on until the L\u2019th generation are denoted as g1 , g2 , and so on until gL , respectively.\nII. Critical probability pc.\nA defining property of a\u00a0CT, resulting from its structure as a tree with no cycles, is that there is only one path from any node to the root. Therefore, percolation in\u00a0a CT is defined as a state in which there is at least one path from a node on the surface of the tree to the root consisting of functional nodes, i.e., nodes of white mode only. As mentioned earlier, according to our model, descendants of nodes in grey or black mode could be of grey or black mode only, but not of white mode. This guarantees that for each node in white mode, all of its ancestors\n4 Vol:.(1234567890) Scientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nuntil the root are also in white mode. Specifically, the presence of a white node on the surface of the tree guarantees a path from it to the root composed of white nodes only, fulfilling the percolation condition. Therefore, to calculate pc of a\u00a0CT, we first calculate the probability of randomly selecting a white node, given that it belongs to the surface of the tree. We perform the calculation in several stages, as follows: For the first generation\u2014the event of selecting a node that is not in a\u00a0white mode, given that this node is of the first generation, occurs when the father of this node (i.e., the root) is in a\u00a0black mode, with probability pb , or when the chosen node itself is in a\u00a0black mode and its father (i.e., the root) is in a\u00a0white mode, with probability pb ( 1\u2212 pb )\n. Thus, the probability of the complementary event of choosing a white node, given that this node is of the first generation, is\nSimilarly for the second generation\u2014the event of selecting\u00a0a node that is in a non-white node given that it is of the second generation occurs when the ancestor of distance 2 of that node, i.e. the root, is black with probability pb , or when the father of that node is black and its ancestor of distance 2 is white with probability pb ( 1\u2212 pb )\n, or when the chosen node itself is black and both its father and its ancestor of distance 2 are white with probability pb ( 1\u2212 pb )2 . Thus, the probability of the complement event of choosing a white node given that it is of the second generation is\nThe above results can be generalized to any generation denoted by l, such that the probability of selecting a node that is white given that this node is of the l-th generation is\n(3)P ( W |g1 ) = 1\u2212 [ pb + pb ( 1\u2212 pb )] = ( 1\u2212 pb )2 .\n(4)P ( W |g2 ) = 1\u2212 [ pb + pb ( 1\u2212 pb ) + pb ( 1\u2212 pb )2 ] = ( 1\u2212 pb )3 .\n(5)P ( W |gl ) = ( 1\u2212 pb )l+1 ,\nFigure\u00a01. Illustration of the model on\u00a0a Cayley tree with Z = 3 neighbors and L = 3 layers: (a) CT before an attack begins. All the nodes are in white mode. The root of the tree and the three branches emanating from the root are marked in the sketch. For clarity, only the nodes belonging to the bottom branch are depicted. (b) Stage one of an attack\u2014Node A is attacked. As a result, node A switches to the black mode, and its six descendants switch to the grey mode. Prior to this stage, all descendants of node A were in the white mode, so the attack on node A causes a complete avalanche of size 7 (node A and its six descendants). (c) Stage two of an attack\u2014 Node B is attacked. As a result, it is switches to the black mode. Since node B was in the grey mode, indicating disconnection from the root before this stage, the attack on node B leads to a null avalanche. (d) Stage three of an attack\u2014Node C is attacked. Consequently, it is switches to the black mode. Since node A which is a son of node C was already attacked prior to this stage, the current stage has no impact on that sub-branch containing node A and its descendants. On the other hand, the nodes in the other sub-branch of node C, including node D and its descendants, which were in the white mode before this stage, all switch to the grey mode. As not all descendants of node C were in the white mode before this stage, the current stage results in an incomplete avalanche of size 8 (node C, node D and node D\u2019s six descendants).\n5 Vol.:(0123456789) Scientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nand in particular, the probability of selecting a white node given that it belongs to the tree surface, i.e., it belongs to the L-th generation, is ( 1\u2212 pb )L+1.\nIn a CT with Z neighbors, the number of nodes of the surface is Z(Z \u2212 1)L\u22121 . We number the nodes of the surface with the numbers 1, 2, 3, . . . ,Z(Z \u2212 1)L\u22121 . Let us define an indicator random variable Xj for the event of the existence of a path from the node of the surface numbered j to the root, consisting only of white nodes. That is, Xj represents the event of percolation due to the j-th node on the surface. We also define another random variable X that represents the number of paths from the surface to the root consisting only of white nodes. Therefore, we have X = \u2211Z(Z\u22121)L\u22121\nj=1 Xj . The expected number of such paths from the surface to the root can be calculated as\nThe condition for percolation is that the expected number of such paths from the surface to the root is at least 1, i.e., E[X] \u2265 1 . The transition occurs when E[X] = 1 . Therefore, we define p\u2217b as the critical value of pb at the transition, and obtain\nThus, the critical probability pc which is the fraction of nodes that were not attacked at the critical point of percolation can be expressed as\nNote that when L >> 1 , pc in Eq.\u00a0(8) tends to be approximated by\nwhich is the known percolation condition of BL. Therefore, we conclude that when L >> 1 , the critical probability pc of a\u00a0CT tends to be the same as that of the BL.\nIn this paper we analyze CTs with a\u00a0very large L, so we consider Eq.\u00a0(9) as the critical probability for percolation in CTs.\nAvalanche\u2011size distribution of a Cayley tree with Z neighbors per node Theory. Probability of a\u00a0null avalanche.\nI. Probability of choosing a grey node.\nRecall that a null avalanche occurs when a grey node is attacked, and that black nodes that have already been attacked are not chosen to be attacked again. Therefore, we first calculate the probability of randomly selecting a grey node given that the chosen node is not black. To calculate this probability, we first perform a simpler calculation of the probability of selecting a white node at random given that the chosen node is not black. We do this in stages as follows: for the first generation\u2014the event of selecting a node that is not white given that this node is of the first generation and is not black occurs when the father of this node (the root) is black, and its probability is pb . Thus, the probability of the complement event of selecting a white node given that this node is of the first generation and is not black is\nSimilarly, for the second generation, the event of selecting a node that is not white given it is of the second generation and is not black occurs when the ancestor of distance 2 of this node (the root) is black, with probability pb , or when the father of this node is black and its ancestor of distance 2 is white, with probability pb ( 1\u2212 pb )\n. Thus, the probability of the complement event of selecting a node that is white given that this node is of the second generation and is not black is\nSimilarly, the previous results can be generalized for any generation l, such that the probability of selecting a node that is white given that this node is of the l-th generation and is not black is\nAs a chosen node can only be white or grey, the probability of selecting a grey node that is in the l\u2019th generation and is not black is the complement of the probability of selecting a white node with those same characteristics. Therefore, we have\n(6) E[X] =\nZ(Z\u22121)L\u22121 \u2211\nj=0\nE [ Xj ] =\nZ(Z\u22121)L\u22121 \u2211\nj=0\n( 1\u2212 pb )L+1\n= Z(Z \u2212 1)L\u22121 ( 1\u2212 pb )L+1 .\n(7)Z(Z \u2212 1)L\u22121 ( 1\u2212 p\u2217b )L+1 = 1.\n(8)pc = 1\u2212 p\u2217b = (Z \u2212 1)\n1\u2212L 1+L\nZ 1 1+L\n.\n(9)pc = 1\nZ \u2212 1 ,\n(10)P ( W |g1 \u2229 B ) = 1\u2212 pb.\n(11)P ( W |g2 \u2229 B ) = 1\u2212 [ pb + pb ( 1\u2212 pb )] = ( 1\u2212 pb )2 .\n(12)P ( W |gl \u2229 B ) = ( 1\u2212 pb )l .\n6 Vol:.(1234567890) Scientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nUsing the total probability formula, we can calculate the probability of selecting a grey node in the l\u2019th generation that is not black as follows:\nSince the randomness of selecting the nodes to be attacked causes independence of the events of choosing a node of some generation and of choosing a node that is not black, we have P(gl|B) = P(gl) , which is the probability of choosing a node of the l\u2019th generation. This probability is the ratio between the number of nodes in the l\u2019th generation, which for a CT with Z neighbors is Z \u00b7 (Z \u2212 1)l\u22121 , and the total number of nodes in the tree, which for a CT with Z neighbors is 1Z\u22122 [Z(Z \u2212 1)\nL \u2212 2] . Assuming a very large L, this ratio is approximately (Z \u2212 2)(Z \u2212 1)\u2212(L\u2212l+1) . Thus, we get\nFollowing this result, we get that the probability of selecting a grey node given that it is not black, without considering the generation to which the node belongs, is given by:\nWe calculate the series and neglect some terms due to the assumption of a very large L, and obtain:\nSince between the stages k and k + 1 of an attack, pb = kN , we get for the probability of selecting grey node between these stages:\nII. Probability of a\u00a0null avalanche during an attack.\nEquation\u00a0(18) can be interpreted as the probability that on stage k + 1 of a random attack on the tree, a grey node is chosen to be attacked, i.e. the probability of the event of a\u00a0null avalanche on stage k + 1 . We define an indicator random variable Xk for the event of a\u00a0null avalanche in stage k + 1 , and a random variable X that is the number of null avalanches during an entire attack until the network collapses. Recall that for a\u00a0CT with a very large L and Z neighbors, pc = 1Z\u22121 (Eq.\u00a0(9) above), i.e. an attack on a fraction of Z\u22122 Z\u22121 of the network\u2019s nodes is\nrequired in order to dismantle the network, therefore, X = \u2211\nZ\u22122 Z\u22121N\u22121\nk=0 Xk . Accordingly, the expected number of null avalanches during an attack until the network collapses is\nWe approximate the last expression in the right-hand-side of Eq.\u00a0(19), by the following integral\n(13)P ( G|gl \u2229 B ) = 1\u2212 ( 1\u2212 pb )l .\n(14)P ( G \u2229 gl|B ) = P ( G|gl \u2229 B ) \u00b7 P ( gl|B ) .\n(15)P ( G \u2229 gl|B ) =\n[\n1\u2212 ( 1\u2212 pb )l ] \u00b7 (Z \u2212 2)(Z \u2212 1)\u2212(L\u2212l+1).\n(16)\nP ( G|B ) =\nL \u2211\nl=1\n[\n1\u2212 ( 1\u2212 pb )l ] \u00b7 (Z \u2212 2)(Z \u2212 1)\u2212(L\u2212l+1)\n= (Z \u2212 2)(Z \u2212 1)\u2212(L+1)\n\u00b7\n[\nL \u2211\nl=1\n(Z \u2212 1)l \u2212\nL \u2211\nl=1\n[\n(Z \u2212 1) ( 1\u2212 pb )l ]\n]\n.\n(17)P ( G|B ) = 1\u2212 (Z \u2212 2)\n( 1\u2212 pb )L+1\n(Z \u2212 2)\u2212 (Z \u2212 1)pb .\n(18)P ( G|B ) = 1\u2212 (Z \u2212 2)\n(\n1\u2212 kN\n)L+1\n(Z \u2212 2)\u2212 (Z \u2212 1) kN .\n(19)\nE[X] =\nZ\u22122 Z\u22121N\u22121 \ufffd\nk=0\nE[Xk]\n=\nZ\u22122 Z\u22121N\u22121 \ufffd\nk=0\n\n  1\u2212\n(Z \u2212 2) \ufffd\n1\u2212 kN\n\ufffdL+1\n(Z \u2212 2)\u2212 (Z \u2212 1) kN\n\n\n\n= Z \u2212 2\nZ \u2212 1 N \u2212\nZ\u22122 Z\u22121N\u22121 \ufffd\nk=0\n(Z \u2212 2) \ufffd\n1\u2212 kN\n\ufffdL+1\n(Z \u2212 2)\u2212 (Z \u2212 1) kN .\n(20) \u222b Z\u22122 Z\u22121N\u22121\n0\n(Z \u2212 2) (\n1\u2212 kN\n)L+1\n(Z \u2212 2)\u2212 (Z \u2212 1) kN dk.\n7 Vol.:(0123456789) Scientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nWe will now calculate the integral in Eq.\u00a0(20) using tools from combinatorics and probability theory. This will lead us to the final expression presented below in Eq.\u00a0(30). The detailed calculations and explanations can be found in the Supplementary Information, but we present here only the general outlines.\nBy substituting u = (Z \u2212 2)\u2212 (Z \u2212 1) kN and performing some algebraic operations, the integral in Eq.\u00a0(20) is transformed to the following integral\nPerforming the binomial formula of (1+ u)L+1 = \u2211L+1\nm=0 (L+1 m ) um yields\nEach value of m in the summation in Eq.\u00a0(22) yields a definite integral in which the antiderivative of the integrand is a polynomial in u, except for m = 0 , which yields a definite integral of the integrand 1u whose antiderivative is the natural logarithm of u. Therefore, the term for m = 0 is negligible relative to the terms for m = 0 , so we neglect it and calculate the summation for m = 1 to m = L+ 1 only. Accordingly, by solving the integral in Eq.\u00a0(22), we get\nSince we assume a very large value for N, we can neglect the term (\nZ\u22121 N\n)m , which is much smaller than (Z \u2212 2)m .\nThis leads to the following equation:\nBy substituting the approximated value of N for a\u00a0CT with a very large number of layers L, which is ZZ\u22122 (Z \u2212 1) L , into Eq.\u00a0(23), we get:\nApplying the binomial coefficient identity \u2211L+1 j=1 1 j ( j m ) = (L+1 m ) 1 m to Eq.\u00a0(24) gives:\nSince ( j m ) = 0 when m > j , we determine the upper limit of the second summation in Eq.\u00a0(25) to be j only. Also, (Z \u2212 1)j =\n\u2211j m=0 ( j m ) (Z \u2212 2)m = 1+ \u2211j m=1 ( j m ) (Z \u2212 2)m . Substituting it into Eq.\u00a0(25) gives the following formula:\nChanging the variable j to L\u2212 j + 1 , applying the identity 1L\u2212j+1 = 1 L+1 \u2211\u221e m=0\njm\n(L+1)m , and ignoring relatively\nsmall terms, approximates Eq.\u00a0(26) to:\nConsidering the size N of a CT with Z neighbors and a very large L that is ZZ\u22122 (Z \u2212 1) L , we have Z(Z \u2212 1)L\u22121 = Z\u22122Z\u22121N . Substituting it into Eq.\u00a0(27) gives:\nBy applying the series \u2211\u221e j=0 j0 (Z\u22121)j = Z\u22121Z\u22122 , \u2211\u221e j=0 j1 (Z\u22121)j = Z\u22121 (Z\u22122)2 , and \u2211\u221e j=0 j2 (Z\u22121)j = Z(Z\u22121) (Z\u22122)3 , we can obtain the first few terms of the asymptotic expansion of Eq.\u00a0(28) as:\n(21)\u2212 (Z \u2212 2)N\n(Z \u2212 1)L+2\n\u222b Z\u22121 N\nZ\u22122\n(1+ u)L+1\nu du.\n(22)\u2212 (Z \u2212 2)N\n(Z \u2212 1)L+2\nL+1 \u2211\nm=0\n(\nL+ 1\nm\n)\u222b Z\u22121 N\nZ\u22122 um\u22121du.\n\u2212 (Z \u2212 2)N\n(Z \u2212 1)L+2\nL+1 \u2211\nm=1\n(\nL+ 1\nm\n)\n1\nm\n[(\nZ \u2212 1\nN\n)m \u2212 (Z \u2212 2)m ] ,\n(23) (Z \u2212 2)N\n(Z \u2212 1)L+2\nL+1 \u2211\nm=1\n(Z \u2212 2)m ( L+ 1\nm\n)\n1 m .\n(24) Z\n(Z \u2212 1)2\nL+1 \u2211\nm=1\n(Z \u2212 2)m ( L+ 1\nm\n)\n1 m .\n(25) Z\n(Z \u2212 1)2\nL+1 \u2211\nj=1\n1\nj\nL+1 \u2211\nm=1\n(\nj\nm\n)\n(Z \u2212 2)m.\n(26) Z\n(Z \u2212 1)2\nL+1 \u2211\nj=1\n(Z \u2212 1)j \u2212 1\nj .\n(27)Z(Z \u2212 1) L\u22121\n\u221e \u2211\nm=0\n1\n(L+ 1)m+1\n\u221e \u2211\nj=0\njm\n(Z \u2212 1)j .\n(28) Z \u2212 2\nZ \u2212 1 N\n\u221e \u2211\nm=0\n1\n(L+ 1)m+1\n\u221e \u2211\nj=0\njm\n(Z \u2212 1)j .\n8 Vol:.(1234567890) Scientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nSimplifying the above expression by changing the base of the expansion to L, we get:\nSince we assume a very large L, we neglect the terms of O (\n1 L2\n)\nin Eq.\u00a0(29) and consider only the first term of NL . Therefore, we obtain the following final approximate expression for the integral in Eq.\u00a0(20):\nSubstituting Eq.\u00a0(30) into Eq.\u00a0(19) gives the expected number of null avalanches during an entire attack:\nAssume a random choice of one attack stage from the set of Z\u22122Z\u22121N attack stages. Let S0 be the event of a\u00a0null avalanche that occurs due to the node removal in the chosen stage. The probability of S0 is the ratio of the expectation of the number of null avalanches during an entire attack E[X] (calculated above in Eq.\u00a0(31)), and the number of attack stages Z\u22122Z\u22121N . Therefore, we get"
        },
        {
            "heading": "Probability of a\u00a0complete avalanche.",
            "text": "I. Definitions.\nWe state the following definitions: for this section, the event of randomly selecting a node of white mode from the l-th generation is denoted as Wl . W1l denotes the same event as Wl , with the added condition that the selected node is son no. 1 of its father. Similarly, W2l denotes the event of selecting a node that is son no. 2 of its father, W3l denotes the event of selecting a node that is son no. 3 of its father, and so on, until W Z\u22121 l denotes the event of selecting a node that is son no. Z \u2212 1 of its father. A \u2018complete cluster\u2019 is a set of nodes consisting of a father and all of its descendants, where all of them are in white mode. The father is referred to as the \u2018head\u2019 of the complete cluster. If a father of a complete cluster is attacked, than a complete avalanche occurs. The event of randomly selecting a node that is a head of a complete cluster is denoted as C. C1 denotes the same event as C, with the added condition that the selected node is son no. 1 of its father. Similarly, C2 denotes the same event as C with the added condition that the selected node is son no. 2 of its father, C3 denotes the event of selecting a node that is son no. 3 of its father, and so on, until CZ\u22121 denotes the event of selecting a node that is son no. Z \u2212 1 of its father.\nII. Conditional probability of a\u00a0complete avalanche of size (Z\u22121) m\u22121\nZ\u22122 (m = 1, 2, 3, . . . , L) in the k + 1 stage of an attack.\nWe define ql as the probability of randomly selecting a node that is a head of a complete cluster, given that this node is in white mode and is in the lth generation, i.e. ql = P(C|Wl).\nFor simplicity, we will develop the following principles for\u00a0a CT with Z = 3 neighbors, and later generalize the results to a CT with any number of neighbors Z. For a CT with Z = 3 , the probability ql can also be related to the events related to the two sons of the chosen node, as follows\nDue to the independence of the sons, the previous expression can be written as follows:\nWe will now develop the term P [( C1 \u2229W1l+1 ) |Wl ] . According to the conditional probability formula P(A \u2229 B|C) = P(A|B \u2229 C) \u00b7 P(B|C) , we have:\nZ \u2212 2 Z \u2212 1 N\n\u00b7\n\n\nZ\u22121 Z\u22122\nL+ 1 +\nZ\u22121 (Z\u22122)2\n(L+ 1)2 +\nZ(Z\u22121) (Z\u22122)3\n(L+ 1)3 +O\n\ufffd\n1\n(L+ 1)4\n\ufffd\n\n,\n(29)N\n\n\n1 L +\n3\u2212Z Z\u22122\nL2 +\nZ2\u22125Z+8 2(Z\u22122)2\nL3 +O\n\ufffd\n1\nL4\n\ufffd\n\n.\n(30) \u222b Z\u22122 Z\u22121N\u22121\n0\n(Z \u2212 2) (\n1\u2212 kN\n)L+1\n(Z \u2212 2)\u2212 (Z \u2212 1) kN dk \u2248\nN L .\n(31)E[X] = Z \u2212 2\nZ \u2212 1 N \u2212\nN L .\n(32)P(S0) = 1\u2212 Z\u22121 Z\u22122\nL .\n(33)ql = P [( C1 \u2229W1l+1 ) \u2229 ( C2 \u2229W2l+1 ) |Wl ] .\n(34)ql = P [( C1 \u2229W1l+1 ) |Wl ] \u00b7 P [( C2 \u2229W2l+1 ) |Wl ] .\n(35)P [( C1 \u2229W1l+1 ) |Wl ] = P ( C1|W1l+1 \u2229Wl ) \u00b7 P ( W1l+1|Wl ) .\n9 Vol.:(0123456789) Scientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nSince W1l+1 \u2282 Wl , we can write this as follows:\nSince P [( C1 \u2229W1l ) |Wl ] =P [( C2 \u2229W2l ) |Wl ] , we can write ql in Eq.\u00a0(34) using the following recursion relation:\nwhere l = 1, 2, 3, . . . L\u2212 1, L . When considering a complete cluster of size 1 that is a white node from the surface of the tree (i.e., the last tree layer L), the event of choosing a node that is a\u00a0head of a complete cluster given that this node is of the L\u2019th generation and of a\u00a0white mode is a sure event with probability 1. Therefore, combining this with the recursion relation of Eq.\u00a0(37), we also have the boundary condition qL = 1.\nThe recursion relation of Eq.\u00a0(37) can be generalized to a CT with any number Z of neighbors by applying the same rationales as in Eqs. (33)\u2013(36), which were presented for the case of Z = 3 . Thus, the recursion relation and boundary condition for the general case become\nUsing this relation, we can derive formulas for qL\u2212m+1 for any m \u2265 1 . For example,\nand in general\nTaking into consideration that between the stages k and k + 1 of an attack pb = kN , we can derive a general formula for the probability of randomly attacking a node that is a head of a\u00a0complete cluster at the k + 1 stage of an attack, given that the node is of white mode and of the L\u2212m+ 1 generation. This probability corresponds to the probability of attacking a node that causes a complete avalanche of size (Z\u22121)\nm\u22121 Z\u22122 at the k + 1 stage of an\nattack, given that this node is of a\u00a0white mode. Using the above expression, this probability can be expressed as\nwhere m = 1, 2, 3, . . . L .\nIII. Probability of a\u00a0complete avalanche of size (Z\u22121) m\u22121\nZ\u22122 (m = 1, 2, 3, . . . , L) in the k + 1 stage of an attack.\nWe define QL\u2212m+1 as the probability of randomly selecting a node that is a head of complete cluster and is in a\u00a0white mode and of generation L\u2212m+ 1 , given that the node is not black, i.e. QL\u2212m+1 = P ( C \u2229W \u2229 gL\u2212m+1|B )\n. Applying the conditional probability formula, we get\nSince W \u2282 B , then W \u2229 gL\u2212m+1 \u2229 B = W \u2229 gL\u2212m+1 . Therefore, P ( C|W \u2229 gL\u2212m+1 \u2229 B ) = P(C|W\u2229\ngL\u2212m+1 ) = qL\u2212m+1 . According to Eq.\u00a0(12), P ( W |gL\u2212m+1 \u2229 B ) = ( 1\u2212 pb )L\u2212m+1 . Since the randomness of the\nattack, the non-black network nodes are distributed between the network layers with the same proportions as between the layers\u2019 sizes, causing P ( gL\u2212m+1|B ) = P ( gL\u2212m+1 ) . The probability P ( gL\u2212m+1 )\nis the ratio between the size of layer L\u2212m+ 1 which is Z(Z \u2212 1)L\u2212m and the network size which is approximately ZZ\u22122 (Z \u2212 1)\nL . Substituting these considerations into Eq.\u00a0(41), and taking into account that between the stages k and k + 1 of an attack, pb = kN , gives\nwhere m = 1, 2, . . . L.\n(36) P ( C1|W1l+1 ) \u00b7 P ( W1l+1|Wl )\n= ql+1(1\u2212 pb).\n(37)ql = ( 1\u2212 pb )2 q2l+1,\n(38) ql =\n( 1\u2212 pb )Z\u22121 qZ\u22121l+1 .\nqL = 1.\nqL\u22121 = ( 1\u2212 pb )Z\u22121 qZ\u22121L = ( 1\u2212 pb )Z\u22121\nqL\u22122 = ( 1\u2212 pb )Z\u22121 qZ\u22121L\u22121 = ( 1\u2212 pb )(Z\u22121)2+(Z\u22121) ,\n(39) qL\u2212m+1 =\n( 1\u2212 pb )\n\u2211m\u22121 j=1 (Z\u22121) j\n= ( 1\u2212 pb )\n1 Z\u22122 ((Z\u22121) m\u2212Z+1) .\n(40)qL\u2212m+1 = ( 1\u2212 k\nN\n) 1 Z\u22122 ((Z\u22121) m\u2212Z+1)\n,\n(41)\nQL\u2212m+1\n= P ( C|W \u2229 gL\u2212m+1 \u2229 B ) \u00b7 P ( W |gL\u2212m+1 \u2229 B ) \u00b7\n\u00b7 P ( gL\u2212m+1|B ) .\n(42) QL\u2212m+1 =\n(\n1\u2212 k\nN\n) 1 Z\u22122 ((Z\u22121) m\u2212Z+1)+L\u2212m+1\n\u00b7 (Z \u2212 2)\n(\n1\nZ \u2212 1\n)m\n.\n10\nVol:.(1234567890)\nScientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nBy definition, QL\u2212m+1 is the probability of randomly attacking a white node in the k + 1 stage of an attack that causes a complete avalanche of size (Z\u22121)\nm\u22121 Z\u22122 .\nIV. Probability of a\u00a0complete avalanche of size (Z\u22121) m\u22121\nZ\u22122 during an entire attack.\nWe define an indicator random variable Xk for the event of a\u00a0complete avalanche of size (Z\u22121) m\u22121\nZ\u22122 in stage k + 1 of an attack, and a random variable X that is the number of complete avalanches of size (Z\u22121)\nm\u22121 Z\u22122 during an entire\nattack until the network collapses, i.e. X = \u2211\nZ\u22122 Z\u22121N\u22121\nk=0 Xk . Therefore, the expected number of complete avalanches of size (Z\u22121)\nm\u22121 Z\u22122 during an attack until the network collapses is\nTo calculate this term, we approximate it by the following integral\nBy changing variables with the formula u = 1\u2212 kN and performing some algebraic operations, we get\nSolving the integral and neglecting terms which are relatively very small, yields\nWe rewrite Eq.\u00a0(46) using an exponential term, and get\nAssume a random choice of one attack stage from the set of Z\u22122Z\u22121N attack stages. We denote by Sm the event of a\u00a0complete avalanche of size (Z\u22121)\nm\u22121 Z\u22122 occurs due to the node removal in the chosen stage. The probability of Sm\nis the ratio of the expected number of complete avalanches of size (Z\u22121) m\u22121\nZ\u22122 during an entire attack, calculated as E[X] in Eq.\u00a0(47) above, and the number of the attack stages Z\u22122Z\u22121N . Therefore, we have\nThe exponent in Eq.\u00a0(48) is dominated by the term (Z \u2212 1)m compared to the other terms. Thus, the term\ne \u2212 ln\n( 1+ (Z\u22121)m Z\u22122 \u2212 Z\u22121 Z\u22122 +2\u2212m\nL\n)\napproaches 1 when m is small relative to logZ\u22121 L and approaches 0 when m is large\nrelative to logZ\u22121 L , with a narrow transition region around logZ\u22121 L . Therefore, we can approximate this term as 1 for values of m less than or equal to logZ\u22121 L , and as 0 for values of m greater than logZ\u22121 L . Applying this\n(43)\nE[X] =\nZ\u22122 Z\u22121N\u22121 \u2211\nk=0\nE[Xk]\n=\nZ\u22122 Z\u22121N\u22121 \u2211\nk=0\n(\n1\u2212 k\nN\n) 1 Z\u22122 ((Z\u22121) m\u2212Z+1)+L\u2212m+1\n\u00b7 (Z \u2212 2)\n(\n1\nZ \u2212 1\n)m\n.\n(44)\nE[X] = (Z \u2212 2)\n(\n1\nZ \u2212 1\n)m\n\u222b Z\u22122 Z\u22121N\u22121\n0\n(\n1\u2212 k\nN\n) 1 Z\u22122 ((Z\u22121) m\u2212Z+1)+L\u2212m+1\ndk.\n(45)\nE[X] = (Z \u2212 2)\n(\n1\nZ \u2212 1\n)m\n\u222b 1 Z\u22121+ 1 N\n1 u\n1 Z\u22122 ((Z\u22121) m\u2212Z+1)+L\u2212m+1 \u00b7 (\u2212N)du.\n(46) E[X] = (Z \u2212 2)\n(\n1\nZ \u2212 1\n)m\nN \u00b7\n1 1\nZ\u22122 ((Z \u2212 1) m \u2212 Z + 1)+ L+ 2\u2212m\n.\n(47) E[X] = N(Z \u2212 2)\n(\n1\nZ \u2212 1\n)m 1\nL \u00b7\ne \u2212ln\n( 1+ (Z\u22121)m Z\u22122 \u2212 Z\u22121 Z\u22122 +2\u2212m\nL\n)\n.\n(48) P(Sm) =\n(\n1\nZ \u2212 1\n)m\u22121 1\nL \u00b7\ne \u2212ln\n( 1+ (Z\u22121)m Z\u22122 \u2212 Z\u22121 Z\u22122 +2\u2212m\nL\n)\n.\n11\nVol.:(0123456789)\nScientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\napproximation in Eq.\u00a0 (48) yields the following distribution of a complete avalanche of size (Z\u22121) m\u22121 Z\u22122 (m = 1, 2, 3, . . . , L):\n22 Probability of a\u00a0complete avalanche of any size during an entire attack.\nAssume a random choice of one attack stage from the set of Z\u22122Z\u22121N attack stages. We denote by SC the event of a\u00a0complete avalanche that occurs due to the node removal in the chosen stage. The probability of SC is the sum of the probabilities of the events Sm . Using Eq.\u00a0(49) accordingly gives:\nCalculation of the previous series gives\nUnder the assumption of a very large L, we neglect the term 1L in the brackets, and obtain the final expression:\nSummary of theory. The considerations and calculations detailed above provide the following conclusions about the distribution of avalanche sizes in a random attack on a CT with Z neighbors: Assuming a very large L, the probability of a null avalanche occurring in a randomly chosen stage of an attack is given by (Eq.\u00a0(32) above):\nThe probability of a complete avalanche of size (Z\u22121) m\u22121\nZ\u22122 (m = 1, 2, 3, . . . , L) occurring in a randomly chosen stage of an attack is given by (Eq.\u00a0(49) above):\nAssuming a very large L, the probability of a complete avalanche of any size occurring in a randomly chosen stage of an attack is given by (Eq.\u00a0(51) above):\nEquations\u00a0(52) and (54) present that the events SC of a\u00a0complete avalanche in a randomly chosen stage of an attack and S0 of a\u00a0null avalanche in a randomly chosen stage of an attack are complementary events, where P(SC)+ P(S0) = 1 . This leads to an interesting result, that during an attack on a CT with a very large L, either complete avalanches or null avalanches occur, and no incomplete avalanche occurs in either case.\nSimulations and results. Figure\u00a02 demonstrates the validity of the theory for a\u00a0CT with Z = 3 . For this CT the theory predicts as follows (following Eqs.\u00a0(52)\u2013(54)): Under the assumption of a very large L, the probability of a null avalanche event in a randomly chosen stage of an attack is\nThe probability of a complete avalanche event of size 2m \u2212 1 (m = 1, 2, 3, . . . , L) in a randomly chosen stage of an attack is\nUnder the assumption of a very large L, the probability of a complete avalanche event in a randomly chosen stage of an attack is\n(49)P(Sm) = { 1 L \u00b7 1 (Z\u22121)m\u22121 m \u2264 logZ\u22121 L\n0 m > logZ\u22121 L\nP(SC) =\nlogZ\u22121 L \u2211\nm=1\n1\nL\n(\n1\nZ \u2212 1\n)m\u22121\n.\n(50)P(SC) = Z\u22121 Z\u22122\nL\n(\n1\u2212 1\nL\n)\n.\n(51)P(SC) = Z\u22121 Z\u22122\nL .\n(52)P(S0) = 1\u2212 Z\u22121 Z\u22122\nL .\n(53)P(Sm) = { 1 L \u00b7 1 (Z\u22121)m\u22121 m \u2264 logZ\u22121 L\n0 m > logZ\u22121 L\n(54)P(SC) = Z\u22121 Z\u22122\nL .\nP(S0) = 1\u2212 2\nL .\nP(Sm) =\n{\n1 L \u00b7 1 2m\u22121\nm \u2264 log2 L 0 m > log2 L\nP(SC) = 2\nL .\n12\nVol:.(1234567890)\nScientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nAlso, for a\u00a0CT with Z = 3 , the number of stages of an attack until the network is dismantled is Z\u22122Z\u22121N = N 2 .\nThe figure presents simulations results for a\u00a0CT with Z = 3 and L = 12, 13, 14, . . . , 26 . In Fig.\u00a02a the graph presents the probability of a\u00a0null avalanche P(S0) , as predicted by the theory and obtained by simulations, versus 2 L . The x-axis scale marks of 2 26 , 2 25 , 2 24 , . . . , 2 12 correspond to\u00a0a CT with L = 26, 25, 24, . . . , 12 , respectively. For each value of 2L , at the top of the vertical dashed line belongs to it a red dot represents the value of 1\u2212 2 L which is the probability P(S0) as predicted by the theory, and a blue circle represents the value of P(S0) was\u00a0obtained from simulations and calculated as the average number of null avalanches in 1000 realizations that were simulated divided by the number of attack stages N2 . It is shown that as L increases from 12 to 26, i.e 2 L decreases from 2 12 to 2 26 , the blue circles tend to coincide with the red dots. For L = 25 and 26, there is indeed a good match between the blue circle and the red dot. This indicates that as L increases, P(S0) calculated from simulations approaches to the predicted value of 1\u2212 2L.\nIn Fig.\u00a02b the graph presents the probability of a complete avalanche P(SC) as\u00a0predicted by theory and obtained by simulations, versus 2L . As shown in panel (a) , for each 2 L value at the top of the vertical dashed line belongs to it, a red dot represents the value of P(SC) according to theory which is 2L , and a blue circle represents\n0.82\n0.84\n0.86\n0.88\n0.9\n0.92\n0.819\n0.843 0.860\n0.876 0.881\n12-14 15-17 18-20 21-23 24-26\nFigure\u00a02. (a,b) Presentation of the avalanche-size distribution for a\u00a0CT with Z = 3 neighbors. (a) Presentation of P(S0) as predicted by theory and obtained by simulations, versus 2L . The x-axis scale marks correspond to 2\n26 , 2 25 , 2 24 . . . , 2 12 representing CTs with L = 26, 25, 24 . . . , 12 layers, respectively. At the top of each vertical dashed line, which corresponds to a specific scale mark of 2\nL , a red dot represents the value of 1\u2212 2 L\nas\u00a0predicted by theory, and a blue circle represents the value of P(S0) as was\u00a0obtained from simulations. The red line represents the graph of the line 1\u2212 2\nL . (b) Presentation of P(SC) as predicted by theory and obtained\nby simulations, versus 2 L . At the top of each vertical dashed line, which corresponds to a specific scale mark of 2 L , a red dot represents the value of 2 L as\u00a0predicted by the theory, and a blue circle represents the value of P(SC) as was\u00a0obtained from simulations. The red line represents the graph of the line 2 L . Inset in panel (b) Bar graph showing the mean value of the ratio between P(SC) and 2L for five subsets of L values: 12\u201314, 15\u201317, 18\u201320, 21\u201323 and 24\u201326. The averages were calculated over 1000 realizations.\n13\nVol.:(0123456789)\nScientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nthe value of P(SC) obtained from simulations, which was calculated again as the average of the number of complete avalanches in 1000 realizations divided by the\u00a0number of attack stages N2 . It is observed that as L increases from 12 to 26, the blue circles approach the red dots. The inset of Fig.\u00a02b provides a more detailed illustration of this trend. For each of the fifteen CTs simulated, with L values ranging from 12 to 26, the ratio of P(SC) as obtained from the simulations and 2L was calculated. The L values were then divided into five subsets: 12\u201314, 15\u201317, 18\u201320, 21\u201323, and 24\u201326. The mean of the ratio between P(SC) and 2L was calculated for each subset, considering the three members of the subset. For example, for the subset of the L values 12,\u00a013 and 14, the following mean was calculated: 13 \u00b7 ( P(SC)12 2/12 + P(SC)13 2/13 + P(SC)14 2/14 )\n. Here, P(SC)12 represents the probability of a complete avalanche as was\u00a0obtained from simulations on the CT with L = 12 , and so on. The inset of Fig.\u00a02b shows a bar graph, where each of the five subsets is represented by one bar. The height of each bar corresponds to the mean of the ratio between P(SC) and 2L calculated for the subset\u00a0it represents, and the value of this ratio is marked on top of the bar. Recall that according to our theory, as L increases, P(SC) becomes greater and tends to 2L , that is P(SC) 2/L becomes greater and tends to 1. The bar graph shows that as L increases within the subsets, the mean of the ratio P(SC)2/L becomes greater, i.e. from 0.819 for the the subset 12\u2212 14 to 0.881 for the subset 24\u2212 26 , approaching towards the value of 1 as predicted by the theory. It is worth noting that to obtain values close to this limit, a network with an extremely large size (tending towards infinity mathematically) must be simulated. Another confirmation of the validity of the theory pertains to the prediction of the probability of a\u00a0complete avalanche of size 2m \u2212 1 as 1L \u00b7 1 2m\u22121\nif m \u2264 log2 L and 0 if m > log2 L . For instance, consider the first subset where L varies between 12 to 14, and the respective log2 L values range from log2 12 = 3.58 to log2 14 = 3.81 . The theory predicts that the probability of a\u00a0complete avalanche of size 2m \u2212 1 is 1L \u00b7 1 2m\u22121\nif m \u2264 3 and 0 if m > 3 . Therefore, for this subset, the probability of a\u00a0 complete avalanche of any size P(SC) is predicted to be 1 L ( 1 21\u22121 + 1 22\u22121 + 1 23\u22121 ) = 1.75L , and P(SC) 2/L is predicted to be 0.875. The inset of Fig.\u00a02b illustrates that the simulation\u2019s result of P(SC)2/L for this subset is 0.819, which corresponds to 93.6% of the predicted value 0.875. Similarly, let us consider the last subset where L varies between 24 and 26, and log2 L varies between log2 24 = 4.58 and log2 25 = 4.64 . According to the theory, the probability of a\u00a0complete avalanche of size 2m \u2212 1 for this subset is 1 L \u00b7 1 2m\u22121 if m \u2264 4 and 0 if m > 4 . Therefore, the probability of a complete avalanche of any size, P(SC) , is predicted to be 1L ( 1 21\u22121 + 1 22\u22121 + 1 23\u22121 + 1 24\u22121 ) = 1.875L , and consequently, P(SC) 2/L is predicted to be 0.9375. The inset of Fig.\u00a02b shows that the simulation\u2019s result of P(SC)2/L for this subset is indeed 0.881, which is 94% of the predicted value 0.9375. The results for the other subsets can be similarly analyzed.\nFigure\u00a03 provides further evidence of the validity of the theory for a\u00a0CT with Z = 4 . The theory predicts the following: Assuming a very large L, the probability of the event of a\u00a0null avalanche in a randomly chosen stage of an attack is given by\nThe probability of the event of a\u00a0complete avalanche of size 3 m\u22121 2 (m = 1, 2, 3, . . . , L) in a randomly chosen stage of an attack is given by\nAssuming a very large L, the probability of the event of a\u00a0complete avalanche in a randomly chosen stage of an attack is\nFor\u00a0a CT with Z = 4 , the number of stages of an attack until the network is dismantled is Z\u22122Z\u22121N = 2 3N.\nThe figure presents simulations results for a\u00a0CT with Z = 4 and L = 10, 11, 12, . . . , 16 . Its pattern is similar to Fig.\u00a02. In Fig.\u00a03a the graph presents the probability of a\u00a0null avalanche P(S0) as predicted by the theory and obtained by simulations, versus 3/2L . The scale marks of x-axis that are 3/2 16 , 3/2 15 , 3/2 14 . . . , 3/2 10 correspond to a\u00a0CT with L = 16, 15, 14 . . . , 10 , respectively. For each value of 3/2L , at the top of the vertical dashed line belongs to it a red dot represents the value of 1\u2212 3/2L which is the probability of a\u00a0null avalanche P(S0) as predicted by the theory, and a blue circle represents the value of P(S0) as was\u00a0obtained from simulations and calculated as the average number of null avalanches in 1000 realizations that were simulated divided by the number of attack stages 23N . It is shown that as L increases from 10 to 16, i.e 3/2 L decreases from 3/2 10 to 3/2 16 , the blue circles tend to coincide with the red dots. For L = 15 and 16, there is indeed a good match between the blue circles and the red dots. This indicates that as L increases, P(S0) calculated from simulations approaches to the predicted value of 1\u2212 3/2L . In Fig.\u00a03b the graph presents the probability of a\u00a0complete avalanche P(SC) , as predicted by theory and obtained by simulations versus 3/2L . For each 3/2 L value, at the top of the vertical dashed line belongs to it a red dot represents the value of P(SC) according to theory which is 3/2L , and a blue circle represents the value of P(SC) obtained from simulations, which was calculated again as the average of the number of complete avalanches in 1000 realizations divided by the\u00a0number of attack stages 23N . It is observed that as L increases from 10 to 16, the\nP(S0) = 1\u2212 3/2\nL .\nP(Sm) =\n{\n1 L \u00b7 1 3m\u22121\nm \u2264 log3 L 0 m > log3 L\nP(SC) = 3/2\nL .\n14\nVol:.(1234567890)\nScientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nblue circles approaches the red dots. The inset of Fig.\u00a03b provides a more detailed illustration of this trend. For each of the seven CTs simulated, the ratio of P(SC) obtained from the simulations and 3/2L was calculated. The L values were then divided to three subsets: 10\u201311, 12\u201314 and 15\u201316. The mean of the ratio between P(SC) and 3/2L was calculated for each subset, considering the members of the subset. The inset of Fig.\u00a03b shows a bar graph, where each of the three subsets is represented by one bar. The height of each bar corresponds to the mean of the ratio between P(SC) and 3/2L calculated for the subset\u00a0it represents, and the value of this ratio is marked on top of the bar. Recall that according to our theory, as L increases, P(SC) becomes greater and tends to 3/2L , that is\nP(SC) 3/2 L\nbecomes greater and tends to 1. The bar graph shows that as L increases within the subsets, the mean ratio of P(SC) 3/2 L\nbecomes greater, i.e. from 0.822 for the subset 10\u201311 to 0.863 for the subset 14\u201316, approaching towards the value of 1. Another confirmation of the validity of the theory pertains to the prediction of the probability of a\u00a0complete avalanche of size 3\nm\u22121 2 as 1 L 1 3m\u22121 if m \u2264 log3 L and 0 if m > log3 L . We consider, for example, the last\n0.84\n0.86\n0.88\n0.9\n0.92\n0.822 0.840\n0.863\n10-11 12-14 15-16\nFigure\u00a03. (a,b) Presentation of the avalanche-size distribution for\u00a0a CT with Z = 4 neighbors. (a) Presentation of P(S0) as predicted by theory and observed in simulations, versus 3/2L . The x-axis scale marks correspond to 3/2\n16 , 3/2 15 , 3/2 14 . . . , 3/2 10 representing CTs with L = 16, 15, 14 . . . , 10 layers, respectively. At the top of each\nvertical dashed line, which corresponds to a specific scale mark of 3/2 L , a red dot represents the value of 1\u2212 3/2 L as\u00a0predicted by theory, and a blue circle represents the value of P(S0) obtained from simulations. The red line represents the graph of the line 1\u2212 3/2\nL . (b) Presentation of P(SC) as predicted by theory and observed in\nsimulations, versus 3/2 L . At the top of each vertical dashed line, which corresponds to a specific scale mark of 3/2\nL , a red dot represents the value of 3/2 L as\u00a0predicted by theory, and a blue circle represents the value of P(SC)\nobtained from simulations. The red line represents the graph of the line 3/2 L . Inset in panel (b) Bar graph showing the mean value of the ratio between P(SC) and 3/2L for three subsets of L values: 10\u201311, 12\u201314 and 15\u201316. The averages were calculated over 1000 realizations.\n15\nVol.:(0123456789)\nScientific Reports | (2023) 13:11311 | https://doi.org/10.1038/s41598-023-38332-1\nsubset where L varies between 15 to 16, and the respective log3 L values range from log3 15 = 2.46 to log3 16 = 2.52 . The theory predicts that the probability of a\u00a0complete avalanche of size 3m\u22121 2 , is 1 L \u00b7 1 3m\u22121\nif m \u2264 2 and 0 if m > 2 . Therefore, for this subset, the probability of a\u00a0complete avalanche of any size P(SC) is predicted to be 1L ( 1 31\u22121 + 1 32\u22121 ) = 4/3 L , and P(SC) (3/2)/L is predicted to be 0.889. The inset of Fig.\u00a03b illustrates that the simula-\ntion\u2019s result of P(SC) (3/2)/L for this subset is 0.863, which corresponds to 97% of the predicted value 0.889. Similarly\nare the results for the other subsets too."
        },
        {
            "heading": "Discussion and summary",
            "text": "In this work, we applied a method of analyzing attacks on networks from the microscopic perspective, considering the impact and contribution of each node removal during an attack, to the fragmentation (immunization) of the network. This approach is in contrast to the traditional methods that analyze attacks on networks from a macroscopic perspective, characterizing the attack and its effectiveness using parameters related to the entire attack, such as the critical probability of percolation occurrence pc and the size of the giant component. We found that in the case of a random attack on a\u00a0CT with Z neighbors and a very large number of layers L, if we randomly choose one attack stage from the set of Z\u22122Z\u22121N attack stages (which is the number of node removals required to dismantle the network), the probability that the node removal in this chosen stage causes a null\navalanche is 1\u2212 Z\u22121 Z\u22122 L . Considering the assumption of a very large L, this probability is not significantly smaller than 1. Consequently, we conclude that almost all the nodes that are removed during the attack cause null avalanche, indicating that these nodes were not connected to the giant component even before they were attacked. This leads to the interesting finding, that in our case the majority of node removals during an attack have no effect or contribution to the destruction of the network. On the other hand, we found that the probability that\na node removal in a randomly chosen stage of an attack causes a complete avalanche is Z\u22121 Z\u22122 L . That is, the event of a complete avalanche is the complement of the event of a null avalanche. This leads to the other interesting conclusion, that besides the very large portion of null avalanches that occur during an attack, there is also a small fraction of non-null avalanches, but of the type of complete avalanche only. The other type of incomplete avalanche does not occur at all during the attack. The complete avalanches that do occur during an attack are the cause of the network collapse.\nWe hope that these findings will deepen our insights of how networks collapse and serve as a tool for improving network immunization processes.\nWe also note that the current work could serve as the foundation for future studies on the avalanche-size distribution of networks under attack. These studies could investigate networks with topologies other than the CT topology, such as scale-free networks, small-world networks and random networks. Additionally, they could explore different types of attacks, including targeted attacks, local attacks, etc., and compare the results with those obtained in CT networks. In general, the current work could serve as a foundation for researching attacks on networks from a micro perspective. This involves the impact of the local stages of an attack on some local parts of the targeted network and characterizing how networks dismantle step by step during an attack. An interesting issue of investigation would be a comparison between the micro and macro perspectives of attacks on networks. This field of research has substantial potential and significant implications."
        },
        {
            "heading": "Data availability",
            "text": "The datasets used and/or analysed during the current study are available from the corresponding author on reasonable request.\nReceived: 21 March 2023; Accepted: 6 July 2023"
        },
        {
            "heading": "Author contributions",
            "text": "A.P. designed and implemnted the research including the analytical derivations and numerical simulations, and wrote the paper."
        },
        {
            "heading": "Competing interests",
            "text": "The author declares no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Supplementary Information The online version contains supplementary material available at https:// doi. org/ 10. 1038/ s41598- 023- 38332-1.\nCorrespondence and requests for materials should be addressed to A.P.\nReprints and permissions information is available at www.nature.com/reprints.\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or\nformat, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http:// creat iveco mmons. org/ licen ses/ by/4. 0/.\n\u00a9 The Author(s) 2023"
        }
    ],
    "title": "Avalanche\u2010size distribution of Cayley tree",
    "year": 2023
}