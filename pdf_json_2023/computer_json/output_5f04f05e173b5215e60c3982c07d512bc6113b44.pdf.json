{
    "abstractText": "Electronically reprogrammable photonic circuits based on phase-change chalcogenides present an avenue to resolve the von-Neumann bottleneck; however, implementation of such hybrid photonic\u2013electronic processing has not achieved computational success. Here, we achieve this milestone by demonstrating an in-memory photonic\u2013electronic dot-product engine, one that decouples electronicprogrammingof phase-changematerials (PCMs) and photonic computation. Specifically, we develop non-volatile electronically reprogrammable PCMmemory cells with a record-high 4-bit weight encoding, the lowest energy consumption per unitmodulationdepth (1.7 nJ/dB) for Erase operation (crystallization), and a high switching contrast (158.5%) using nonresonant silicon-on-insulator waveguide microheater devices. This enables us to perform parallel multiplications for image processing with a superior contrast-to-noise ratio (\u226587.36) that leads to an enhanced computing accuracy (standard deviation \u03c3 \u22640.007). An in-memory hybrid computing system is developed in hardware for convolutional processing for recognizing images from the MNIST database with inferencing accuracies of 86% and 87%.",
    "authors": [
        {
            "affiliations": [],
            "name": "Wen Zhou"
        },
        {
            "affiliations": [],
            "name": "Bowei Dong"
        },
        {
            "affiliations": [],
            "name": "Nikolaos Farmakidis"
        },
        {
            "affiliations": [],
            "name": "Xuan Li"
        },
        {
            "affiliations": [],
            "name": "Nathan Youngblood"
        },
        {
            "affiliations": [],
            "name": "Kairan Huang"
        },
        {
            "affiliations": [],
            "name": "Yuhan He"
        },
        {
            "affiliations": [],
            "name": "C. David Wright"
        },
        {
            "affiliations": [],
            "name": "Wolfram H. P. Pernice"
        },
        {
            "affiliations": [],
            "name": "Harish Bhaskaran"
        }
    ],
    "id": "SP:7b5a4bbe67366ebce4ac09b72eda7d155f2178b4",
    "references": [
        {
            "authors": [
                "W Zhang"
            ],
            "title": "Neuro-inspired computing chips",
            "venue": "Nat. Electron",
            "year": 2020
        },
        {
            "authors": [
                "Q. Xia",
                "J.J. Yang"
            ],
            "title": "Memristive crossbar arrays for brain-inspired computing",
            "venue": "Nat. Mater. 18,",
            "year": 2019
        },
        {
            "authors": [
                "W. Zhang",
                "R. Mazzarello",
                "M. Wuttig",
                "E. Ma"
            ],
            "title": "Designing crystallization in phase-changematerials for universalmemory and neuroinspired computing",
            "venue": "Nat. Rev. Mater",
            "year": 2019
        },
        {
            "authors": [
                "C Li"
            ],
            "title": "Analogue signal and image processing with large memristor crossbars",
            "venue": "Nat. Electron",
            "year": 2018
        },
        {
            "authors": [
                "P Yao"
            ],
            "title": "Fully hardware-implementedmemristor convolutional neural network",
            "venue": "Nature 577,",
            "year": 2020
        },
        {
            "authors": [
                "C Wang"
            ],
            "title": "Scalable massively parallel computing using continuous-time data representation in nanoscale crossbar array",
            "venue": "Nat. Nanotechnol",
            "year": 2021
        },
        {
            "authors": [
                "J Feldmann"
            ],
            "title": "Parallel convolutional processing using an integrated photonic tensor core",
            "venue": "Nature 589,",
            "year": 2021
        },
        {
            "authors": [
                "Shastri",
                "B. J"
            ],
            "title": "Photonics for artificial intelligence and neuromorphic computing",
            "venue": "Nat. Photonics",
            "year": 2021
        },
        {
            "authors": [
                "X Xu"
            ],
            "title": "TOPS photonic convolutional accelerator for optical neural networks",
            "venue": "Nature 589,",
            "year": 2021
        },
        {
            "authors": [
                "W Zhou"
            ],
            "title": "Phase\u2010change materials for energy\u2010efficient photonic memory and computing",
            "venue": "MRS Bull. 47,",
            "year": 2022
        },
        {
            "authors": [
                "Atabaki",
                "A. H"
            ],
            "title": "Integrating photonics with silicon nanoelectronics for the next generation of systems on a chip",
            "venue": "Nature 556,",
            "year": 2018
        },
        {
            "authors": [
                "W Bogaerts"
            ],
            "title": "Programmable photonic circuits",
            "venue": "Nature 586,",
            "year": 2020
        },
        {
            "authors": [
                "D. P\u00e9rez-L\u00f3pez",
                "A. L\u00f3pez",
                "P. DasMahapatra",
                "J. Capmany"
            ],
            "title": "Multipurpose self-configuration of programmable photonic circuits.Nat",
            "venue": "Commun. 11,",
            "year": 2020
        },
        {
            "authors": [
                "Y Shen"
            ],
            "title": "Deep learning with coherent nanophotonic circuits",
            "venue": "Nat. Photonics 11,",
            "year": 2017
        },
        {
            "authors": [
                "H Zhang"
            ],
            "title": "An optical neural chip for implementing complexvalued neural network",
            "venue": "Nat. Commun. 12,",
            "year": 2021
        },
        {
            "authors": [
                "Zhu",
                "H. H"
            ],
            "title": "Space-efficient optical computing with an integrated chip diffractive neural network",
            "venue": "Nat. Commun",
            "year": 2022
        },
        {
            "authors": [
                "C Huang"
            ],
            "title": "A silicon photonic\u2013electronic neural network for fibre nonlinearity compensation",
            "venue": "Nat. Electron",
            "year": 2021
        },
        {
            "authors": [
                "F. Ashtiani",
                "A.J. Geers",
                "F. Aflatouni"
            ],
            "title": "An on-chip photonic deep neural network for image classification",
            "venue": "Nature 606,",
            "year": 2022
        },
        {
            "authors": [
                "W Zhang"
            ],
            "title": "Silicon microring synapses enable photonic deep learning beyond 9-bit precision",
            "venue": "Optica 9,",
            "year": 2022
        },
        {
            "authors": [
                "Tait",
                "A. N"
            ],
            "title": "Silicon photonicmodulator neuron",
            "venue": "Phys. Rev. Appl. 11,",
            "year": 2019
        },
        {
            "authors": [
                "X Lin"
            ],
            "title": "All-optical machine learning using diffractive deep neural networks",
            "venue": "Science 361,",
            "year": 2018
        },
        {
            "authors": [
                "T.W. Hughes",
                "M. Minkov",
                "Y. Shi",
                "S. Fan"
            ],
            "title": "Training of photonic neural networks through in situ backpropagation and gradient measurement",
            "venue": "Optica 5,",
            "year": 2018
        },
        {
            "authors": [
                "X Xu"
            ],
            "title": "Self-calibrating programmable photonic integrated circuits",
            "venue": "Nat. Photonics 16,",
            "year": 2022
        },
        {
            "authors": [
                "C Rios"
            ],
            "title": "Integrated all-photonic non-volatile multi-level memory",
            "venue": "Nat. Photonics",
            "year": 2015
        },
        {
            "authors": [
                "C Rios"
            ],
            "title": "In-memory computing on a photonic platform",
            "venue": "Sci. Adv. 5,",
            "year": 2019
        },
        {
            "authors": [
                "J Feldmann"
            ],
            "title": "Calculating with light using a chip-scale alloptical abacus",
            "venue": "Nat. Commun",
            "year": 2017
        },
        {
            "authors": [
                "de Lima",
                "T. F"
            ],
            "title": "Design automation of photonic resonator weights",
            "venue": "Nanophotonics 11,",
            "year": 2022
        },
        {
            "authors": [
                "C R\u00edos"
            ],
            "title": "Ultra-compact nonvolatile phase shifter based on electrically reprogrammable transparent phase change materials",
            "venue": "PhotoniX 3,",
            "year": 2022
        },
        {
            "authors": [
                "W Zhou"
            ],
            "title": "Artificial biphasic synapses based on nonvolatile phase-change photonic memory cells",
            "venue": "Phys. Status Solidi RRL 16,",
            "year": 2022
        },
        {
            "authors": [
                "X Li"
            ],
            "title": "On-chip phase change opticalmatrixmultiplication core",
            "venue": "IEEE International Electron Devices Meeting (IEDM)",
            "year": 2020
        },
        {
            "authors": [
                "C Wu"
            ],
            "title": "Programmable phase-change metasurfaces on waveguides for multimode photonic convolutional neural network",
            "venue": "Nat. Commun. 12,",
            "year": 2021
        },
        {
            "authors": [
                "X Li"
            ],
            "title": "Fast and reliable storage using a 5 bit, nonvolatile photonic memory cell",
            "venue": "Optica 6,",
            "year": 2019
        },
        {
            "authors": [
                "X Li"
            ],
            "title": "Experimental investigation of silicon and silicon nitride platforms for phase-change photonic in-memory computing",
            "venue": "Optica 7,",
            "year": 2020
        },
        {
            "authors": [
                "H Zhang"
            ],
            "title": "Miniaturemultilevel opticalmemristive switch using phase change material",
            "venue": "ACS Photonics",
            "year": 2019
        },
        {
            "authors": [
                "J Zheng"
            ],
            "title": "Nonvolatile electrically reconfigurable integrated photonic switch enabled by a silicon PIN diode heater",
            "venue": "Adv. Mater",
            "year": 2001
        },
        {
            "authors": [
                "R Chen"
            ],
            "title": "Broadband nonvolatile electrically controlled programmable units in silicon photonics",
            "venue": "ACS Photonics",
            "year": 2022
        },
        {
            "authors": [
                "Z Fang"
            ],
            "title": "Ultra-low-energy programmable non-volatile silicon photonics based on phase-change materials with graphene heaters",
            "venue": "Nat. Nanotechnol",
            "year": 2022
        },
        {
            "authors": [
                "C R\u00edos"
            ],
            "title": "Multi-level electro-thermal switching of optical phasechange materials using graphene",
            "venue": "Adv. Photonics Res",
            "year": 2000
        },
        {
            "authors": [
                "Z Fang"
            ],
            "title": "Non-volatile reconfigurable integrated photonics enabled by broadband low-loss phase change material",
            "venue": "Adv. Opt. Mater",
            "year": 2021
        },
        {
            "authors": [
                "N Farmakidis"
            ],
            "title": "Plasmonic nanogap enhanced phase-change devices with dual electrical-optical functionality",
            "venue": "Sci. Adv. 5,",
            "year": 2019
        },
        {
            "authors": [
                "N Farmakidis"
            ],
            "title": "Electronically reconfigurable photonic switches incorporating plasmonic structures and phase change materials",
            "venue": "Adv. Sci",
            "year": 2022
        },
        {
            "authors": [
                "C Rios"
            ],
            "title": "Controlled switching of phase-change materials by evanescent-field coupling in integrated photonics",
            "venue": "Opt. Mater. Express",
            "year": 2018
        },
        {
            "authors": [
                "Lee",
                "J.-M",
                "Cho",
                "S.-H",
                "Choi",
                "W.-Y"
            ],
            "title": "An equivalent circuit model for a Ge waveguide photodetector on Si",
            "venue": "IEEE Photon. Technol. Lett. 28,",
            "year": 2016
        },
        {
            "authors": [
                "Pintus",
                "P. et al. PWM\u2010driven thermally tunable silicon microring resonators"
            ],
            "title": "design, fabrication, and characterization",
            "venue": "Laser Photonics Rev. 13, 1800275",
            "year": 2019
        },
        {
            "authors": [
                "H. Xiao",
                "K. Rasul",
                "Vollgraf",
                "R. Fashion-mnist"
            ],
            "title": "a novel image dataset for benchmarking machine learning algorithms",
            "venue": "Preprint at https://arxiv.org/abs/1708.07747",
            "year": 2017
        },
        {
            "authors": [
                "J. Feldmann",
                "N. Youngblood",
                "C.D. Wright",
                "H. Bhaskaran",
                "W.H.P. Pernice"
            ],
            "title": "All-optical spiking neurosynaptic networks with selflearning capabilities",
            "venue": "Nature 569,",
            "year": 2019
        },
        {
            "authors": [
                "J. Choquette",
                "W. Gandhi",
                "O. Giroux",
                "N. Stam",
                "Krashinsky",
                "R. NVIDIA A100 Tensor Core GPU"
            ],
            "title": "performance and innovation",
            "venue": "IEEE Micro 41, 29\u201335",
            "year": 2021
        },
        {
            "authors": [
                "Jouppi",
                "N. P"
            ],
            "title": "In-datacenter performance analysis of a tensor processing unit",
            "venue": "in Proc. ISCA",
            "year": 2017
        },
        {
            "authors": [
                "Merolla",
                "P. A"
            ],
            "title": "Amillion spiking-neuron integrated circuit with a scalable communication network and interface",
            "venue": "Science 345,",
            "year": 2014
        }
    ],
    "sections": [
        {
            "text": "In-memory photonic dot-product engine with electrically programmable weight banks\nWen Zhou1,6, Bowei Dong1,6, Nikolaos Farmakidis 1, Xuan Li1, Nathan Youngblood1,5, Kairan Huang1, Yuhan He1, C. David Wright 2, Wolfram H. P. Pernice 3,4 & Harish Bhaskaran 1\nElectronically reprogrammable photonic circuits based on phase-change chalcogenides present an avenue to resolve the von-Neumann bottleneck; however, implementation of such hybrid photonic\u2013electronic processing has not achieved computational success. Here, we achieve this milestone by demonstrating an in-memory photonic\u2013electronic dot-product engine, one that decouples electronicprogrammingof phase-changematerials (PCMs) and photonic computation. Specifically, we develop non-volatile electronically reprogrammable PCMmemory cells with a record-high 4-bit weight encoding, the lowest energy consumption per unitmodulationdepth (1.7 nJ/dB) for Erase operation (crystallization), and a high switching contrast (158.5%) using nonresonant silicon-on-insulator waveguide microheater devices. This enables us to perform parallel multiplications for image processing with a superior contrast-to-noise ratio (\u226587.36) that leads to an enhanced computing accuracy (standard deviation \u03c3 \u22640.007). An in-memory hybrid computing system is developed in hardware for convolutional processing for recognizing images from the MNIST database with inferencing accuracies of 86% and 87%.\nNon-von Neumann computing architectures, which physically collocate the data storage and analogue signal processing functionalities, are exceptionally suited to artificial intelligence (AI) applications and outperform digital processors especially in computer vision, achieving higher energy efficiency and fidelity1\u20133. Notably, in-memory computing hardware in the electronic domain based on transistor-programmed memristive crossbar arrays can be massively scaled to form \u20181T1R\u2019 type architectures4, which enables selective access and precise multilevel conductance programming of non-volatile memory elements in largescale systems4\u20136. Recent interest has shifted towards in-memory photonic processing, where the clock frequency can be extended significantly beyond the GHz range7. In-memory photonic computing based on photonic integrated circuits (PICs) represents a paradigm shift in harnessing parallelised data processing with appealing features such as ultrahigh clock frequency, massive parallelism, picosecond signal latency and ultrabroad bandwidth in optical signal processing7\u20139. Compared with digital electronic accelerators, in-memory photonic computing systems promise 1\u22123 orders of magnitude improvement in both compute density and energy efficiency7,10, which are critical in dealing with the heavy workload associated with running deep learning algorithms. Leveraging a silicon optoelectronic platform offers an opportunity for system scale-up based on low-cost, wafer-scale, and complementary metal\u2013oxide\u2013semiconductor (CMOS) compatible manufacturing11. Recent progress in implementing photonic neural networks (PNNs) is\nReceived: 9 September 2022\nAccepted: 3 May 2023\nCheck for updates\n1Department of Materials, University of Oxford, Parks Road, Oxford OX1 3PH, UK. 2Department of Engineering, University of Exeter, Exeter EX4 4QF, UK. 3Institute of Physics, University of M\u00fcnster, Heisenbergstr. 11, 48149 M\u00fcnster, Germany. 4Kirchhoff-Institute for Physics, Heidelberg University, Im Neuenheimer Feld 227, 69120Heidelberg, Germany. 5Present address: Department of Electrical andComputer Engineering, University of Pittsburgh, Pittsburgh, PA 15261, USA. 6These authors contributed equally: Wen Zhou, Bowei Dong. e-mail: harish.bhaskaran@materials.ox.ac.uk\nNature Communications | (2023) 14:2887 1\n12 34\n56 78\n9 0 () :,;\n12 34\n56 78\n9 0 () :,;\nbased on reconfigurable photonic\u2013electronic hybrid PICs12,13, such as universal unitary networks and diffractive networks composed of Mach\u2013Zehnder interferometers (MZIs)14\u201316, broadcast-and-weight networks composed of microring resonators17, and deep optoelectronic networks18. These PNNs display key metrics including dense throughput and low latency using reliable electronic control of synapses with high-bit precision19 and spiking neurons20. Photonic\u2013electronic hybrid AI hardware implementations are more practical and competitive candidates than all-optical networks21 for efficient in situ training22 and self-calibration of weight banks23 so as to suppress error accumulation in deep PNNs with good reproducibility.\nIn contrast to volatile optoelectronic PICs12, photonic non-von Neumann architectures leverage non-volatile waveguide memory cells24 as functional layers integrated with silicon photonics to carry out computational tasks within the waveguide memory25. The key technology is developing a non-volatile photonic computing system using waveguide memory component that achieves multi-bit programming and thereby enables one to carry out in-memory computing with high precision. This has been done so far using phase-change materials (PCMs), mostly of the absorbing variety, such as Ge2Sb2Te5 (GST)7,25,26, which is more reliable for photonic computing than those relying on precise phase control27,28. The change in effective refractive indices of these PCM cells can be achieved using optical or electrical pulses to induce a phase transition between the crystalline and amorphous states10. Optical programming of PCMs has been widely studied24,26,29 and exploited for scalar and matrix-vector multiplication7,25,30,31 due to high encoding precisions and reliable operations32. All-optical in-memory tensor cores have been recently developed with the capability of processing trillions of multiplyaccumulate (MAC) operations per second using PCM-cladded Si3N4 waveguide crossbar arrays7. Due to the nonvolatility of the PCM cells, there is no additional energy consumption in weight holding, which is beneficial for convolutional operations with fixed kernels. For a smallscale silicon-on-insulator (SOI) tensor core, reconfigurable MZIs have been utilized for routing energetic optical pump pulses generated by a wall-plug or an integrated laser and an amplifier to optically programme individual PCM cells30. Yet, as reconfigurable circuits, operation of these all-optical systems relies on two sequential steps: (i) optical programming for weight bank setting, (ii) optical signal probing for computing, i.e., separating the programming and computing. This complicates the system architecture and the inherent working mode, hindering its programming flexibility and scalability for a largescale system. On the other hand, the mainstream SOI waveguide platform should be adopted for the CMOS-compatible optoelectronic integration with well-developed high-speed transceivers and mature ion-implantation technology. Considering all-optical programming on a SOI platform, itwould be difficult to realize a large switching contrast and high-bit operation. The reported contrast is merely 15% with a small-area (a few \u03bcm2) PCM switching and nearly 10 distinguishable memory levels33. To be more practical, it is conceivable to have a photonic processor that interfaces with electronic microcontrollers, and thus electrically programmable PCM cells are of paramount importance to set the multistate in a non-volatile manner for realizing the in-memory photonic computing.\nTo date, electrical pulse induced Joule heating has enabled the large-area phase switching of PCMs atop ion-implanted waveguide microheaters28,34\u201336, graphene microheaters37,38, ITO microheaters39, and plasmonic nanogap devices40,41. These device-level demonstrations have been exploited for optical switches34,35 and tunable optical couplers36. Their functionality for in-memory photonic computing is, however, absent due to a limited number of encoding levels addressable (\u22648) in the non-resonant straight waveguide microheater devices28,34\u201341, which substantially limits the precision. Crucially, the following metrics arguably remain key and are required for advancement from a single PCM device to a computing system:\n(i) Multi-bit non-volatile electrical programming on the SOI waveguide platform\n(ii) Low energy consumption per unit modulation depth (unit: nJ/dB) for energy-efficient electrical programming\n(iii) Large switching contrast to enhance the contrast-to-noise ratio (CNR) and the computing accuracy (iv) Non-resonant and broadband operation of a PCM device for parallel computing\nHere we report demonstration of an in-memory photonic\u2013electronic computing system, which consists of highperformance computational memory cells based on the PCMcladded microheaters with electrical control. Our PCM device and system resolve all the above critical issues, opening a promising avenue toward high-performance phase-change in-memory computing chips. The system features decoupled electronic programming of PCMs and optical probing of processed signals, which can be performed simultaneously. Specifically, the electronic circuits complete the weight bank setting and storage, and the optical circuits execute the scalar multiplication and MAC operation. This scenario could essentially combine the advantages of programming flexibility and scalability, high-speed optical signalling, and optoelectronic packaging synergies. Our electrically reprogrammable PCM cells achieve the following metrics: (i) a record-high 4-bit weight encoding, which outperforms 3-bit encoding of the previously developed SOI waveguide microheater devices28,34\u201337,39, (ii) the lowest energy consumption per unit modulation depth of 1.7 nJ/dB for the Erase operation (crystallization) of GST among waveguide microheater devices34\u201337,41, (iii) a very high switching contrast of 158.5% (modulation depth of 4.13 dB), which shows over ten times improvement compared with those using all-optical programming33, leading to enhanced CNRs (\u226587.36) and reduced computation error by 8.9 times achieved in our image processing experiment, (iv) parallel scalar multiplication using multiple wavelengthdivisionmultiplexing (WDM) channels in imageprocessing for brightness scaling, blurring andSobelfiltering. Lastly, a compact inmemory photonic\u2013electronic computing system was electrically programmed to achieve edge detection for the implementation of convolutional neural networks (CNNs). Our experiments demonstrated high inferencing accuracies of 86% and 87% for recognizing images from the MNIST database, which compare favourably with previous PNNs15,16,21. We further estimated a compute density of 7.3 TOPS/mm2 (Tera-operations per second per mm2 chip area), a compute efficiency of 10.0 TOPS/W, and the energy consumption per MAC operation of 0.2 pJ/MAC at a data rate of 25Gb/s and 16 WDM channels for an integrated in-memory photonic\u2013electronic chip. Thus, our prototype system provides a viable path for the in-memory photonic\u2013electronic computing with flexible programming, high-bit operation, low energy consumption, and high computational accuracy based on the SOI waveguide platform with prospective applications in intelligent edge devices for computer vision, speech recognition, autonomous driving, and signal processing."
        },
        {
            "heading": "Results",
            "text": ""
        },
        {
            "heading": "In-memory photonic\u2013electronic computing platform",
            "text": "Figure 1a illustrates a 3D schematic of an in-memory photonic\u2013electronic dot-product engine consisting of an array of electrical programmable non-volatile GST memory cells, which act as reconfigurable weight banks [w1,w2,\u2026wN] for dot-product operation. The input vector [x1, x2, \u2026 xN] is encoded in the amplitudes of probe light at different wavelengths (\u03bb1, \u03bb2,\u2026 \u03bbN) generated by a broadband light source. Such probe energy is well below the power required to induce a phase transition in the GST cells. After encoding, the optical signal is transmitted through the GST cell and is subsequently and partially absorbed. Mathematically, it performs scalar multiplication with output amplitude ofwi\u00b7xi, in which the multiplicandwi is mapped\nNature Communications | (2023) 14:2887 2\nto the transmittance of the i-th GST cell defined by its material state25. At the output ports of this dot-product engine, optical fields are combined incoherently in the optical domain to complete the summation of optical signals \u03a3wi\u00b7xi by using a N-to-1 wavelength division multiplexer (MUX), thus implementing a dot-product operation: [x1, x2, \u2026 xN]\u00b7[w1, w2, \u2026 wN]T. Crucially, our proposed scalable in-memory photonic\u2013electronic computing platform features decoupled electronic programming of weight banks and optical probing of weighted addition. As a critical component in this platform, a waveguide memory cell as shown in Fig. 1b is based on a boron-implanted SOI waveguide microheater (grey region) cladded with GST and SiO2 thin films for non-volatile electrical programming. It is designed with a narrow doping strip covering a portion of a straight waveguide for efficient local Joule heating. Chip fabrication includes 120-nm shallow etching of the 220-nm-thick silicon device layer, heavily P++ doping and aluminum (Al) pads (thickness = 300nm) deposition as ground-signal (GS) electrodes for probe contact or wire bonding. Current\u2013voltage (I\u2013V) scanning shows a linear response due to Ohmic contact between Al pads and doped silicon (see Supplementary Fig. 1). GST and SiO2 thinfilms (thickness= 30/50nm)were last depositedon topof a doped SOI waveguide by radiofrequency (RF) magnetron sputtering. A 50- nm-thick SiO2 capping was used to protect the GST thin film to avoid oxidation and delamination, thus enabling reliable operation (For detailed fabrication steps, see Methods and Supplementary Fig. 2). Top left of Fig. 1b shows our programming scheme using a single shot of short and high (long and low) amplitude electrical pulse for amorphization (crystallization) of a GST cell. As a result, transmission of the probe light can bemodulated due to varied attenuation of the GST cell after programming. Figures 1c, d, respectively, show top-view of a fabricated andwire bonded SOI photonic chip (1 cm\u00d7 1 cm), an optical micrograph of a small-scale in-memory photonic\u2013electronic dotproduct engine, a zoom-in optical micrograph and a scanning electron microscopic (SEM) image of an electrically reconfigurable GSTmemory cell with a measured doping length (Ldope) of 5.4 \u03bcm and a total resistance of 238 \u03a9. Measured length of the GST/SiO2 thin film (LGST) is 3.5 \u03bcm (For detailed geometric parameters of our design, see Supplementary Fig. 3). There is an offset of patterned electrodes with respect to the waveguide due to overlay misalignment in electronbeam lithography. After programming by electrical pulses, large amorphization areas embedded in the crystallinematrix can be clearly observed in Fig. 1d due to the difference in conductivity between aGST and cGST. And the weight (wi) is determined by the amorphous-tocrystalline ratio of the i-th GST cell, which can be electrically programmed by choosing proper electrical pulse parameters. Please note that only low-energy electrical pulses (<9 nJ) were applied to avoid ablation of GST cells34,42. Multilevel GST cells for scalar multiplication First, we demonstrated reversible binary and multilevel operations of GST cells based on an experimental setup elaborated in Supplementary Fig. 4. Figure 2a shows the temporal optical waveform when a GST cell is switched back and forth upon sending electrical pulses. A single 50-ns-wide rectangular pulse with pulse amplitudes of 6.1 V (orange), 6.4 V (blue) and 6.8 V (red) partially amorphized the GST cell with incremental amorphous-to-crystalline ratios. A single 200-ns 3 V rectangular pulse fully recrystallized the GST cell with transmission (T) back to the baseline (Tbase). Considering the photodetection noise25, Tbase is the measured and averaged transmission baseline for a fully crystallized GST cell, and T is measured and averaged transmission after a switching event for a partially amorphized GST cell. The switching contrast is defined as \u0394T/Tbase, where change in transmission is defined as \u0394T = T \u2212 Tbase. A switching contrast was measured as high as 158.5% for a microheater with a\n2 \u03bcm\nSiO2 P++ Si GST i-SicGST aGST\n(b)(a)\n(d)\nLGST Ldope\nWWG\n(1 cm\u00d7 1 cm) with a printed circuit board, and zoom-in optical micrographs of a small-scale in-memory photonic\u2013electronic dot-product engine and a non-volatile waveguide memory cell. d A SEM image of an ion-implanted SOI waveguide microheater (measured doping length = 5.4 \u03bcm)with GST/SiO2 (measured length = 3.5\u03bcmand thickness = 30/50 nm) thinfilms (blue) andaluminum(Al) ground-signal (GS) electrodes (yellow).\nNature Communications | (2023) 14:2887 3\ndoping length of 3 \u03bcm and 2.5-\u03bcm-long GST/SiO2 cell atop. Measured total resistance of the device is 261.5 \u03a9. Loss of 0.59 dB/\u03bcm was measured due to free carrier absorption in the heavily doped silicon waveguide (Supplementary Fig. 5). Hence, due to P++ doping, the insertion loss of a 3-\u03bcm-long waveguide microheater is 1.78 dB. Based on a 3D finite element method (FEM) modelling, we found that the heating area expands with increasing doping length (Ldope \u2264 10 \u03bcm) of the waveguide microheater, which can be used for switching a larger area of GST if required (Supplementary Fig. 6). However, we chose Ldope of 3 \u03bcm to balance the trade-off between switching contrasts and optical losses. Binary operation can be used for optical switching applications as demonstrated by previous works34,35,37,41. However, multi-bit programming of waveguide memory cells is a basic requirement for photonic computing to obtain a high numerical accuracy. We further evaluated the performance of addressing deterministic multiple states by exploiting pulse amplitude modulation (PAM). A sequence of 17 Write pulses was sent with monotonically decreased amplitudes from 6.8 V to 5.2 V and a fixed pulse width of 50 ns followed by a recrystallization pulse with fixed amplitude of 3 V and pulse width of 200 ns. PAM enables precise controlling of the amorphous-to-crystalline ratio of a GST cell. Figure 2b shows time traces of multilevel operation repeated by 3 cycles. 18 unique levels indicated by shaded green and red areas were resolved. Each level corresponds to a partially crystalline state, which was addressed with Write pulse energies between 5.2 and 8.8 nJ. And each 200-ns 3 V Erase pulse consumes 6.9 nJ. The capacitive energy consumption is negligible43,44. Energy consumptions of 6.9 nJ (Erase) and 8.8 nJ (Write) are lower than those of reported microheater devices10. Such over 4-bit data encoding and storage capability may provide a leap forward for the in-memory photonic computing with electrical control. Figure 2c shows switching dynamics of the GST cell. Upon sending electrical pulses, readout voltage of a high-speed photodetector first drops due to thermo-optical effect24. At the end of the pulse heating, transmittance of the GST cell reaches the minimum and subsequently rises to another equilibrium state. The post-excitation dead times were measured to be 232 and 356 ns for Write and Erase, respectively. In terms of operational speed, it here requires 282 ns and 556 ns for Write and Erase, respectively. Supplementary Fig. 7 also shows operation of our device with repetitive optical switching over 100 cycles and repetitive I\u2013V scanning of microheater. Supplementary Table 2 compares performances of our experimentally demonstrated devices with the previously reported non-resonant straight waveguide GST cells with electrical controlling34\u201337,41. Our GST cells exhibit the highest encoding/storage levels reported so far and the lowest energy consumption per unit modulation depth in the Erase (recrystallization) process. With these advantages, our devices can be applied to in-memory photonic computing, instead of only optical switching. Scalar multiplication is essential for neuromorphic computing due to heavy MAC workloads in PNNs14. We next demonstrated inmemory scalar multiplication operation of our GSTmemory cells with over 4-bit encoding precision. T is the measured absolute transmittance of a GST cell with 16 discrete values between Tbase and Tmax. Pin between 0 and Pmax (=0.35mW) is the input power generated by a continuous wave (CW) probe laser after VOA modulation, which was\n0 400 800 1200 1600 2000\n0.4\n0.5\n0.6\nTime (ns)\nPhotodetector readout 200 ns 3 V Erase\n0\n2\n4\n6\n8\n0.3\n0.4\n0.5\n0.6\nPhotodetector readout 50 ns 7 V Write\n0\n2\n4\n6\n8\n0 50 100 150 200 250 Time (s) 0 2 4 6 8 10 12\n0\n40\n80\n120 160 T /T ba se ) % \u0394 (\nTime (s)\n6.8 V 6.4 V 6.1 V\n0.0 0.2 0.4 0.6 0.8 1.0 0.0\n0.2\n0.4\n0.6\n0.8\n1.0\n-0.02 -0.01 0.00 0.01 0\n20\n40 60 SD= 0.0034) V( egatlov tuodae R P ulse am plitude (V )\nMean= \u22120.0034\n(a)\n(c) (d) (e)\nM ea\nsu re\nd\nExact\nC ou\nnt\nError\n6.8 Levels\n1\n5\n10\n15\n18\nP ul\nse a\nm pl\nitu de\nm od\nul at\nio n\n(V )\n6.4\n6.2\n5.9\n5.6\n5.3\n(b)\nFitting\nExact\nMeasured\nCountPCM x(t) w(i) \u00b7 x(t)\nw(i)\nFig. 2 | Electrically reprogrammable photonic waveguide memory cells with over4-bit encoding levels for scalarmultiplication. aReversible electrical binary programming of a GST/SiO2 cell (LGST = 2.5 \u03bcm, thickness = 30/50 nm and Ldope = 3 \u03bcm) by 6.8 V (red), 6.4 V (blue), and 6.1 V (orange) 50-ns Write pulses and fixed 3 V 200-ns Erase pulses. b Multilevel operation of a device showing over 4-bit nonvolatile memory levels using pulse amplitude modulation (PAM). c Temporal switching dynamics (red curves) showing amorphization to a higher transmission level achieved with a single 50-ns 7 V rectangular Write pulse (black curve), and recrystallization back to the baseline achieved by a single 200-ns 3 V rectangular\nErase pulse (black curve). d Measured scalar multiplication results versus exact results by performing 784 multiplication operations (w(i) \u00d7 x(t)) mapped by 16 different encoding levels (w(i), i = 1 to 16) of aGSTcell asmultiplicand (reachedwith write pulse energy between 5.2 nJ and 8.8 nJ), and 49 random input amplitudes of a probe light (x(t), t = (j \u2212 1)\u00b7\u0394t, \u0394t = 1ms, and j = 1 to 49) as multiplier modulated sequentially by a variable optical attenuator (VOA) at a frequency of 1 kHz. e A histogram of computational error calculated by subtracting the measured scalar multiplication from the exact. The histogram is fitted by a Gaussian distribution (red solid curve). SD standard deviation.\nNature Communications | (2023) 14:2887 4\nsent down to a GST cell. We calibrated and normalized input power (Pin/Pmax) of a VOA versus bias voltage and transmittance [(T\u2212Tbase)/ (Tmax\u2212Tbase)] of our GST cell versus Write pulse amplitude with a fixed pulse width of 50 ns (Supplementary Fig. 8) to obtain the exact x(t) \u00d7 w(i) (x(t) and w(i)\u2208 [0, 1]). Transmittance of a GST cell versus Write/ Erase event needs to be calibrated independently due to fabrication error ofmicroheater devices. In our testing, an electricWrite pulse was first sent to aGST cell to reach a transmission level (T) followedby light probing, which was encoded sequentially with 49 random values of Pin between 0 and 0.35mW. We noted that x(t) \u00d7w(i) can be also expressed as: (Pin\u00b7T \u2212 Pin\u00b7Tbase)/(Pmax\u00b7Tmax \u2013 Pmax\u00b7Tbase), in which absolute transmission through the device including Pin\u00b7T, Pin\u00b7Tbase, Pmax\u00b7Tmax, Pmax\u00b7 Tbase were recorded to calculate measured results of scalarmultiplication in a post-processing step. A subtraction of (Pin\u00b7T \u2212 Pin\u00b7Tbase) was performed on a digital computer to correct offset (Tbase \u22600). Instead, offset correction can be implemented by using the balanced photodetection method with estimated reduced energy consumption and signal processing time in the circuits (see Supplementary Note 10 for details). Accuracy of multiplication was then examined. Figure 2d shows a good matching between the exact and measured results of multiplication. The standard deviation (SD) of the residual error is as low as 0.0034, which is almost one order of magnitude lower than those reported in ref. 25, and the mean error is \u22120.0034 fitted by a Gaussian distribution as shown in Fig. 2e. In-memory parallel multiplication operations for image processing One of the predominant advantages of photonic computing is parallel data processing enabled by theWDM scheme. We therefore study this property in image processing applications. Figure 3a shows an experimental setup for four-channel parallel multiplication as a proofof-concept demonstration (see Methods). By this multiplexing, the processing time of an entire image can be reduced by a factor of four. As shown in Fig. 3b, an input imagewith a size of 128 \u00d7 128 showing the Clarendon Building at the University of Oxford (photographed by the authors) was decomposed into RGB channels, which were preprocessed to allow for re-arranging into a 4 by 12,288 (=128\u00d7 96) matrix for data flattening. In each timeframe of the computation, probe light at four separated wavelength channels (\u03bb1 to \u03bb4) generated by a broadband light source was encoded as one row of this flattened\nBroadband light source\nVOA\nVOA\nVOA\nM U X\nD E\nM U\nX\nVOA\nD A\nq an\nd D\nS P\nPDPC\nEncoding\n\u03bb2 \u03bb4\u03bb3\u03bb1\n\u03bb1\n\u03bb3\n\u03bb2 PCM\n\u03bb1 \u03bb2 \u03bb3 \u03bb4\nParallel multiplication using WDM w \u00b7 x1(t)\n1\n33\n65\nR\nG\nB\nx1(t)\n\u03bb4\nD E\nM U\nX\nData\nPlotting\n(a)\n(b) (c)\nx2(t)\nx3(t)\nx4(t)\nw \u00b7 x2(t)\nw \u00b7 x3(t)\nw \u00b7 x4(t)\nj = 1 to 12288\nCalculated\n0.5\n2\nBrightness scaling Data flattening Scaling (\u2206T1 / Tbase, \u2206T2 / Tbase)\n(8, 4)%\n(64, 128)%\n(128, 64)%\nw\n(d) (e) (f)\n-0.5 0.0 0.5 1.0 1.5 2.0 2.5 -0.5\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5 3.0 4% 8% 32%\nderusae M\nExpected -0.3 -0.2 -0.1 0.0 0.1 0.2 0.3\n0\n2000\n4000\n6000\n8000\n10000\n12000\n14000\ntnuo C\nNormalized error\n4% 8% 16% 32% 64%\n0 10 20 30 40 50 60 70 0.00\n0.01\n0.02\n0.03\n0.04\n0.05\n0.06\n0.07\nNormalized SD CNR\nContrast (%)\nD S dezila mro N\n0\n15\n30\n45\n60\n75\n90\nC N R\nt = (j\u22121)\u00b7\u2206t\n(4, 8)%\n\u03c3 = 0.060 \u03c3 = 0.007\n\u03c3 = 0.107 \u03c3 = 0.019\nFig. 3 | WDM enabled parallel multiplication for image processing. a An experimental setup for parallel multiplication by a GST cell. b Flattened pixel data of an RGB image encoded in amplitudes of four different wavelength channels by four VOAs. c Brightness scaling by performing light transceiving of all encoded pixels through a GST cell with varied switching contrast \u0394T1(2)/Tbase, followed by image plotting for visualization with labelled SD (\u03c3). (The original image showing the Clarendon Building in the University of Oxford was photographed by the\nauthors.) d\u2013f Examples of measured results for brightness scaling (scaling factor = 2) versus the exact results (d), histograms of normalized error fitted with Gaussian distributions (e), normalized SD and contrast-to-noise ratio (CNR), which is defined as (T \u2212 Tbase)/SD(T) and SD(T) is the standard deviation of the detected and normalized transmissionmixingwith photodetectionnoise, versus switching contrasts (\u0394T2/Tbase) of a GST cell (f).\nNature Communications | (2023) 14:2887 5\nmatrix using VOAs. These separated channels were multiplexed and combined to pass through a single GST cell. At the output of the device, channels were demultiplexed into four paths and detected by photodetectors simultaneously. Light in parallel channels was probed with nearly identical switching contrast after passing through the same GST cell upon electronic programming (Supplementary Fig. 10). Weight of the GST cell (w) was used to scale the amplitudes of signals (x1(t)\u2013x4(t), t = (j \u2212 1)\u00b7\u0394t,\u0394t = 1ms, and j = 1 to 12,288). The scaling factor (S) is defined as [(T1\u2212Tbase)/(T2\u2212Tbase)], where T1(2) is the transmittance of a GST cell after electrical programming. The scaling factor can be rewritten as \u0394T1/\u0394T2, and \u0394T1 can be set as 0.5\u00b7\u0394T2 or 2\u00b7\u0394T2 to achieve brightness scaling with scaling factors of 0.5 or 2, respectively. We also note that S \u00d7 xi(t) (i = 1 to 4) can be expressed as: [(T1\u2212Tbase)/ (T2\u2212Tbase)]\u00b7(Pin/Pmax) = (Pin\u00b7T1 \u2212 Pin\u00b7Tbase)/(Pmax\u00b7T2 \u2013 Pmax\u00b7Tbase), inwhich absolute transmission through the device including Pin\u00b7T1, Pin\u00b7Tbase, Pmax\u00b7T2, and Pmax\u00b7Tbase were recorded to calculate brightness scaling results in a post-processing step. In the experiment, the parallel multiplication process of an entire RGB image was repeated for various switching contrasts of a GST cell (\u0394T/Tbase = 0%, 4%, 8%, 16%, 32%, 64%, 128%) with multiplication results stored for post-processing and imaging plotting. As a direct comparison in Fig. 3c,we plotted images after applying brightness scaling (scaling factor = 0.5 or 2) using a GST cell with programmed (\u0394T1/Tbase, \u0394T2/Tbase) = (4%, 8%), (8%, 4%), (64%, 128%) or (128%, 64%). The measured images with higher contrasts of (64%, 128%) and (128%, 64%) match well with the theoretically calculated results, showing SDs of 0.019 and 0.007, respectively. However, the change of hue and noise are high in the measured images with contrasts of (4%, 8%) and (8%, 4%). Thus, a large \u0394T1(2)/Tbase, and therefore, a correspondingly high CNR, which is defined as (T \u2212 Tbase)/ SD(T), leads to a lower computational error. SD(T) is the standard deviation of the normalized detected transmission, attributed mainly to photodetection noise. To provide quantitative analysis on the computational error of brightness scaling, Fig. 3d shows three sets of measured results versus the exact results at switching contrasts (\u0394T2/ Tbase) of 4%, 8% and 32% for doubling the brightness. Figure 3e shows histograms of computational error calculated by subtracting the measured results from the exact results. Histograms were further fitted by Gaussian distributions to extract SD as shown in Fig. 3f. We observed a sharp decrease in SD versus switching contrast (\u0394T2/Tbase). SD is suppressed from0.060 to 0.007 and CNR is enhanced from 5.46 to 87.36 by increasing\u0394T2/Tbase from4% to64%. Errors aremainly from shot noise and thermal noise in photodetection (0.79%, 0.74%, 0.81% and 1.07% for the four channels) with a 3-dB bandwidth of 11.6 kHz and light source power drift over time (1.82%, 3.59%, 2.89% and 4.31% for the four channels) due to instability of our broadband light source (see Supplementary Note 12 for details). Boxcar averaging and error distributions of the three colour tones indicate that the change of hue is not caused by noise, but mainly caused by laser power drift (see Supplementary Note 13 for details).\nAs a further example, we exploited parallel multiplication for realizing advanced image filtering (Supplementary Note 14). Similarly, it exhibits good matching between the measured and theoretical results from applying kernels of blurring and edge detectionwith large switching contrasts. In the image blurring application, SD is reduced from 0.071 to 0.008 by increasing \u0394Tstep/Tbase from 4% to 64% (Supplementary Fig. 18). Thus, large switching contrasts achieved by electrical programming of PCMs using waveguidemicroheaters are crucial for image processing and feature extraction in CNNs based on the above comparison."
        },
        {
            "heading": "An in-memory photonic\u2013electronic dot-product engine for image recognition",
            "text": "Having demonstrated the parallel multiplication function for image processing, we next performed convolutional operations in the optical domain by exploiting a compact in-memory photonic\u2013electronic\nsystem consisting of four GST cells, which represent a 2 \u00d7 2 kernel matrix and can be addressed with flexible electronic programming. As shown in Fig. 4a, four different wavelength channels were demultiplexed from a broadband light source, and were separately encoded by VOAs to represent a 2 \u00d7 2 patch of a 14 \u00d7 14 8-bit grey-scale image in each timeframe of the computation. As a result, 169 (13 \u00d7 13 for valid padding) patches were generated and organized into a 4 \u00d7 169 matrix for data encoding in amplitudes of probe light. At outputs, probe signals were combined incoherently to obtain a time series of kernelpatchdot-product results (\u03a3wi\u00b7xi(t), i = 1 to 4, t = (j \u2212 1)\u00b7\u0394t,\u0394t = 1ms, and j = 1 to 169). Please note that four scalar multiplications w1\u00b7x1(t), w2\u00b7x2(t),w3\u00b7x3(t), andw4\u00b7x4(t) were performed in parallel in the optical domain. And 169 repetitions of dot products of \u03a3wi\u00b7xi(t) were implemented sequentially by updating xi(t) (i = 1 to 4). Thus, there are 169 \u00d7 4 MAC operations in total in the optical domain for convolving an image of 14 \u00d7 14 pixels. To map wi of \u00b11 onto a positive range of light transmittance, wi is defined as 2\u00b7(Ti\u2013Tave)/\u0394T and Ti\u2208[Tmin, Tmax], where Tave = (Tmin + Tmax)/2, \u0394T = Tmax \u2013 Tmin, and Tmax (Tmin) is themaximum (minimum) transmittance of aGSTcell by electrical programming. And the convolutional operation can be expressed as: \u03a3 [2(Ti\u2013Tave)/\u0394T]\u00b7(Pi/ Pmax), where Pi \u2208 [0, Pmax] (i = 1 to 4) and xi(t) = Pi/Pmax. With this mapping, 2-quadrant multiplication can be implemented and weights of GST cells represent bipolar signals by offsetting the background value of Tave.\nWe benchmarked our dot-product engine with classification tasks on elementary datasets such as MNIST fashion product45 and handwritten digits46 using a CNN architecture as shown in Fig. 4b. As an example, ten-class fashion products were fed into the input layer of a CNN for optical signal encoding. The data were then convolved with four 2 \u00d7 2 kernels with elements of \u00b11 to generate four activationmaps with an image size of 13 \u00d7 13 showing four detected edges. The computing accuracy and error distributionof the convolutional processing results are shown in Supplementary Fig. 20. The convolved data was then post-processed. After nonlinear activation by a rectified linear unit (ReLu) function, four activationmaps were flattened into a 676 \u00d7 1 vector, which was then fed into a fully connected layer with ten neurons to output a final 10 \u00d7 1 vector for showing classification results. 400 images of fashion products/handwritten digits were convolved with four different kernels using our photonic\u2013electronic dot-product engine, and their output data were used for training the 676 \u00d7 10 weight banks of a fully connected layer in our CNN by a digital computer. In this way, computational errors due to noise and drift were included in the training step to obtain a robust CNN. And another 100 images were fed into a trained CNN for generating a confusionmatrix. To elaborate, edge detection results of grey-scale images with labelled SDs were examined with visualized examples of T-shirt and digit zero as shown in Figs. 4c, d, respectively. These measured results of highlighted edges (bright outlines) match well with those of theoretically calculated results. Inferencing accuracies for fashion product and digit (Figs. 4e, f) show good agreement between experimental measurement (86% and 87%) and theoretical calculation (87% and 88%). Supplementary Fig. 21 shows detailed evolution of loss and accuracy versus epochduring neural network training for both Fashion-MNIST45 and digit-MNIST46 datasets. We noted that prediction accuracies were improved with the help of a convolutional layer compared with those of the fully connected neural networks without any convolutional layer. The computational load of the optical processing in the presented CNN is discussed in Supplementary Fig. 22. And our CNN exhibits oneof thehighest prediction accuracies for theMNIST fashion product compared with those of the start-of-the-art PNNs previously reported15,16,21 (see Supplementary Table 4 for details)."
        },
        {
            "heading": "Discussion",
            "text": "In summary, we have demonstrated an in-memory photonic\u2013electronic hybrid computing system based on the non-volatile GST memory cells,\nNature Communications | (2023) 14:2887 6\nwhich support flexible electrical programming and high-throughput optical computing. Our electrically reprogrammable GST cells show record-high 4-bit encoding levels, the lowest energy consumption per unit modulation depth for the crystallization process (1.7 nJ/dB), and a high switching contrast (158.5%) using non-resonant SOI waveguide microheater devices. We then exploited parallel scalar multiplication using a GST cell with a very low error (SD=0.007) and enhanced CNR for image processing. We have experimentally revealed the key role of enhancing the CNR in reducing the computation error by 8.9 times in image processing tasks. For neuromorphic computing, we implemented convolutional layers in CNNs based on an in-memory photonic\u2013electronic dot-product engine with inferencing accuracies of 87% and 86% for MNIST handwritten digit and fashion product recognition, respectively, whichwere comparablewith software calculation. In PNNs, a large switching contrast produces a wide variable range in summed energy to drive the cascaded artificial neuron crossing its threshold. An accumulated energy (Emin) estimated as 270.8 pJ, which is far below the switching threshold (420 pJ) of an integrate-and-fire artificial neuron47, can be reached based on Emin = Emax/(\u0394Tmax/Tbase + 1) when the contrast (\u0394Tmax/Tbase) is 1.585 and the maximally accumulated energy (Emax) is 700 pJ corresponding to the on-state of neuron. A large contrast enabled by electrical programming is a key advantage in the operation of PNNs with reliable cascading with neurons. Our results show that implementing the in-memory photonic\u2013electronic hybrid platformsoffer scalable and flexible programming, parallel optical signal processing, and CMOS-compatible wafer-scale fabrication. We believe that further advances may come from the following aspects: reducing insertion losses by optimizing design of ion implantation (e.g., using lightly doped microheaters), system scaling up using crossbar array networks7 or resonator-based broadcast and weight networks with low insertion losses17, and boosting data throughput by monolithic integrating the state-of-the-art silicon photonic modulators and germanium photodetectors, which may drive the system at tens of Gigabits per second (Gb/s) perWDMchannel. Our presented dot-product engine can be scaled up to photonic tensor cores that implementmatrix-matrix multiplication in a single clock, as described in Supplementary Note 16.\nMeasured\nCalculated\nInput Bottom RightTopLeft\nBottom\n14\u00d714\u00d71\nLeft\nRight\n13\u00d713\u00d74\n676\u00d71\nInput image\nConvolution + ReLU\nFlatten\n10\u00d71\nT-shit/top Trouser Pullover Dress Coat Sandal Shirt Sneaker Bag Ankle boot\nFully connected Results\nTop\nBroadband light source\n\u03a3wi \u00b7 xi (t)\n(a)\nD A\nq\nPC\nWeight of PCM = wi (wi = \u22121 or 1 and i = 1 to 4)\n4 PCMs\nD E\nM U\nX M U\nX\nVOA\nVOA\nVOA\nVOA\n\u03bb1 \u03bb2 \u03bb3 \u03bb4\n(b)\n(c) (d)\nEdge detection\n+1 \u22121\nEdge detection\nMeasured\nCalculated\nBottom RightTopLeft\nEdge detection\nInput\n(e) (f)\nx1(t)\nx2(t)\nx3(t)\nx4(t)\n\u03c3 = 0.055 \u03c3 = 0.052 \u03c3 = 0.039 \u03c3 = 0.123 \u03c3 = 0.024 \u03c3 = 0.019 \u03c3 = 0.068 \u03c3 = 0.024\nFig. 4 | Fashion product and digit recognition using CNNs. a An experimental setup for implementing the dot-product operation. b A CNN architecture for both fashion product and handwritten digit recognition. Insets of fashion products are shown for illustration purpose. The photonic\u2013electronic dot-product engine performs the convolution for MNIST fashion products45 and handwritten digits46 with an image size of 14 \u00d7 14. c, d Extracted features showing measured results with\nlabelled SDs compared with those of theoretically calculated ones using a 32-bit computer for a T-shirt (c) and digit zero (d). e, f Confusion matrices showing comparable inferencing accuracy for fashion product recognition with 86% from experiment and 87% from calculation (e), and digit recognition with 87% from experiment and 88% from calculation (f).\nNature Communications | (2023) 14:2887 7\nUsing thephotonic tensor core, assuming a data rate of 25Gb/s, 16WDM channels for parallel computation and an estimated chip area of 56.02 mm2, compute density of an in-memory photonic\u2013electronic chip is estimated to be 7.3 TOPS/mm2, which is significantly higher than those of current graphics processing units (GPUs), tensor processing units (TPUs) and application-specific integrated circuits (ASICs)48\u201351. The compute efficiency is estimated to be 10.0 TOPS/W and the energy per MAC operation is 0.2 pJ/MAC (see Supplementary Note 16 for details)."
        },
        {
            "heading": "Methods",
            "text": ""
        },
        {
            "heading": "Device fabrication",
            "text": "In-memory photonic\u2013electronic hybrid systems were fabricated on a SOI wafer (SOITECH)with a 220-nm-thick top silicon device layer and a 2-\u03bcm-thick buried oxide layer. The top silicon device layer was patterned by a JEOL JBX-5500 50kV electron-beam lithography (EBL) using a 400-nm-thick positive-tone resist (CSAR). The top silicon device layer was subsequently shallowly etched (etching depth = 120 nm) by inductively coupled plasma reactive ion etching (ICP-RIE, Oxford Instrument PlasmaPro) with SF6 and CHF3 gases, followed by O2 plasma etching of CSAR resist. Next, a 3-\u03bcm-thick positive tone electron-beam resist poly(methyl methacrylate) (PMMA) 950 A8 was spin-coated and patterned by EBL as ion implantation windows for the heavy borondoping. The ion implantation dosagewas 3 \u00d7 1015 ions/cm2 at 10KeV. After ion implantation, the SOI chips were immersed in acetone to remove the PMMA layer and the piranha solution to completely remove the resist residue. The SOI chips were then annealed at 950 \u00b0C for 3min in nitrogen atmosphere to activate the boron dopant by a Jipelec Jetfirst rapid thermal annealing processor. A 2-\u03bcm-thick double-layer PMMA (PMMA 495 A8 and PMMA 950 A8) were spincoated on the chip surface, and the third step of EBL was performed to define the evaporation windows of aluminum (Al) pads on top of the doped silicon. Buffered oxide etching was performed to completely remove native oxide layer for achieving a good Ohmic contact between Al pads and doped silicon. A 300-nm-thick Al was subsequently deposited using thermal evaporation followed by lifting off. And the fourth step of EBLwasperformed to define theGST sputtering windows on topof the doped siliconwaveguides. A stack of 30-nm/50nm GST/SiO2 was deposited using a magnetron sputtering system (PVD, AJA International Inc.) followedby a lift-off process. TheGST and SiO2 targets were respectively sputtered at 30WRF power with 3 sccm Ar flow and 40W RF power with 3 sccm Ar flow at a base pressure of 10\u22127 torr. Finally, the sputtered GSTwere lifted off followed by thermal annealing at 250 \u00b0C for 10mins to fully crystallize the GST."
        },
        {
            "heading": "Measurement setup",
            "text": "Opticalmeasurement was performed using a fibre-chip coupling setup as illustrated in Supplementary Fig. 4. The input light generated from a continuous wave (CW) laser (7711A, Keysight Technologies) was aligned to an apodized waveguide grating coupler for light coupling under anoff-vertical incident angle of 8\u00b0. Thewavelength andpower of theCW lightwere 1570.4 nmand3.55mW, respectively. Its polarization was optimized by a fibre polarization controller (Thorlabs, FPC032) to match the fundamental quasi-transverse-electric mode of the SOI waveguides. The input light power was controlled by a variable optical attenuator (Thorlabs V1550A) for data encoding at a modulation frequency of 1 kHz for demonstrating multiplication operation. Output light was split into two separated paths by a 1 \u00d7 2 fibre-optic coupler (TW1550R2A1) with a splitting ratio of 90:10. 10% of output light was collected by a low-noise photodetector (Newport 2011-FC) to obtain temporal trace of the GST cells upon phase transition for binary and multilevel operations. 90% of output light was collected by a highspeed photodetector (Newport 1811-FC) and a fast-sampling oscilloscope (TDS7404, Tektronix, Inc.) to characterize the thermo-optical response of the GST cells upon phase transition. In the electrical programming, RF electrical pulses were generated by a pulse generator\n(Tektronix AFG3102C) and DC electrical signals were generated by a source meter (Keithley 2614B), which were combined by using a bias tee (Mini-Circuits ZFBT-4R2GW+) and were applied to the Al pads through a ground-signal (GS) electrical probe (PicoProbe). DC current\u2013voltage (I\u2013V) sweeping was conducted to measure the total resistance of the waveguidemicroheater. To amorphize the GST cell, a single 50ns and 7 V rectangular voltage pulse was sent. For crystallization, a single 200ns 3 V rectangular voltage pulse was applied. To perform parallel multiplication, a broadband light source (SuperK COMPACT, NKT Photonics) was first filtered by a dual-channel passive filter (SuperK SPLIT, NKT Photonics) and was then demultiplexed by a 1 \u00d7 16 dense wavelength division multiplexing (DWDM) module to output multiple wavelength channels at the optical telecommunication wavelengths. These separated wavelength channels were modulated at a frequency of 1 kHz by VOAs (Thorlabs V1550A) to encode data of flattened pixels. After modulation, these channels were multiplexed again by another 1 \u00d7 16 DWDMmodule and were coupled into a single GST cell. At output port of the device, parallel channels were demultiplexed and detected by low-noise photodetectors (Newport 2011-FC). To perform convolutional operation for artificial CNNs, each wavelength channel demultiplexed from a broadband light source (SuperK COMPACT, NKT Photonics) was modulated at a frequency of 1 kHz by a VOA (Thorlabs V1550A) and a GST cell to perform scalar multiplication. At outputs, these wavelength channels were combined by another 1 \u00d7 16 DWDM module and detected by a photodetector (Newport 2011-FC). Data acquisition and equipment controlling were performed by amicrocontroller (National Instruments USB-6259 BNC, sampling rate of 1.25 MSamples/s) with analogue outputs connecting to VOAs and analogue inputs connecting with photodetectors."
        },
        {
            "heading": "CNN model",
            "text": "For both MNIST fashion product and handwritten digit recognition tasks, 500 images were taken from the MNIST database and compressed to 14 \u00d7 14 pixels. 80% of images (400 images) were used for training and 20% (100 images) for testing. The architecture of the employed CNN is shown in Fig. 4b. The input layer takes the pixel data (13 \u00d7 13 pixels for valid padding) and passes the data to a convolutional layer consisting of four pre-defined 2 \u00d7 2 kernels for edge detection, resulting in an output dimension of 13 \u00d7 13 \u00d7 4. The output is then flattened to 676 \u00d7 1 and activated by the rectified linear unit (ReLu) function. The activated 676 \u00d7 1 output is fed to a fully connected layer with 10 neurons, whose output is further converted to probabilities by a Softmax layer that shows the final classification results. The convolution layer was implemented using the in-memory photonic\u2013electronic dotproduct engine. The subsequent ReLu function, fully connected layer, and Softmax function were constructed by software using MATLAB R2021b Deep Learning Toolbox. Weights of the fully connected layer were trained by Adam optimizer. The loss and accuracy versus epoch were monitored to ensure that the CNN was successfully trained to classify ten categories of images."
        },
        {
            "heading": "Data availability",
            "text": "The data that support the findings of this study are available from the corresponding author upon request."
        },
        {
            "heading": "Code availability",
            "text": "The code used in the present work is available from the authors upon request."
        },
        {
            "heading": "Acknowledgements",
            "text": "H.B., C.D.W. and W.H.P.P. acknowledge support from the EU H2020 programme (Grant No. 780848, Fun-COMP Project and Grant No. 101017237, PHOENICS Project). This research was funded in part by the UKRI through grant numbers EP/T023899/1, EP/R001677/1 and EP/ W022931/1."
        },
        {
            "heading": "Author contributions",
            "text": "W.Z. designed the devices and fabricated the chips, performed simulation, measurement, and data analysis of devices. N.Y. did initial groundwork on the devices. W.Z. and B.D. performed the measurement and data analysis of photonic computing systems. N.F. performed SEM characterization. X.L. and N.Y. assisted development of the fabrication recipe. W.Z. and K.H. deposited the PCM thin films. Y.H. assisted the setup. All authors contributed to the discussion of experimental results. W.Z. wrote the manuscript with contributions from B.D., N.F., C.D.W., W.H.P.P. and H.B. H.B. conceived, supervised and coordinated all the work."
        },
        {
            "heading": "Competing interests",
            "text": "H.B. and W.H.P.P. hold shares in Salience Labs Ltd. Other authors declare no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41467-023-38473-x.\nCorrespondence and requests for materials should be addressed to Harish Bhaskaran.\nPeer review information Nature Communications thanks the anonymous reviewer(s) for their contribution to the peer review of this work.\nReprints and permissions information is available at http://www.nature.com/reprints\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/ licenses/by/4.0/.\n\u00a9 The Author(s) 2023\nNature Communications | (2023) 14:2887 10"
        }
    ],
    "title": "In-memory photonic dot-product engine with electrically programmable weight banks",
    "year": 2023
}