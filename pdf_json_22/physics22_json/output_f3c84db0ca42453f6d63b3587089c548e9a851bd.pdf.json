{
    "abstractText": "Establishing sharp and correctly positioned boundaries in spatial gene expression patterns is a central task in both developmental and synthetic biology. We consider situations where a global morphogen gradient provides positional information to cells but is insufficient to ensure the required boundary precision, due to different types of noise in the system. In a conceptual model, we quantitatively compare three mechanisms, which combine the global signal with local signaling between neighboring cells, to enhance the boundary formation process. These mechanisms differ with respect to the way in which they combine the signals by following either an AND, an OR, or a SUM rule. Within our model, we analyze the dynamics of the boundary formation process, and the fuzziness of the resulting boundary. Furthermore, we consider the tunability of the boundary position, and its scaling with system size. We find that all three mechanisms produce less fuzzy boundaries than the purely gradient-based reference mechanism, even in the regime of high noise in the local signals relative to the noise in the global signal. Among the three mechanisms, the SUM rule produces the most accurate boundary. However, in contrast to the other two mechanisms, it requires noise to exit metastable states and rapidly reach the stable boundary pattern.",
    "authors": [
        {
            "affiliations": [],
            "name": "Mareike Bojer"
        },
        {
            "affiliations": [],
            "name": "Stephan Kremser"
        },
        {
            "affiliations": [],
            "name": "Ulrich Gerland"
        }
    ],
    "id": "SP:5103b68f9dc60ea8af8262070983bf3363f7d14f",
    "references": [
        {
            "authors": [
                "C. Dahmann",
                "A.C. Oates",
                "M. Brand"
            ],
            "title": "Boundary formation and maintenance in tissue development",
            "venue": "Nature Reviews Genetics 12, 43 ",
            "year": 2011
        },
        {
            "authors": [
                "N. Barkai",
                "B.-Z. Shilo"
            ],
            "title": "Reconstituting tissue patterning",
            "venue": "Science (New York, N.Y.) 370,",
            "year": 2020
        },
        {
            "authors": [
                "L. Wolpert"
            ],
            "title": "Positional information and the spatial pattern of cellular differentiation",
            "venue": "Journal of Theoretical Biology 25, 1 ",
            "year": 1969
        },
        {
            "authors": [
                "T. Gregor",
                "D.W. Tank",
                "E.F. Wieschaus",
                "W. Bialek"
            ],
            "title": "Probing the Limits to Positional Information",
            "venue": "Cell 130, 153 ",
            "year": 2007
        },
        {
            "authors": [
                "M. Zagorski",
                "Y. Tabata",
                "N. Brandenberg",
                "M.P. Lutolf",
                "T. Bollenbach"
            ],
            "title": "J",
            "venue": "Briscoe, , and A. Kicheva, Decoding of position in the developing neural tube from antiparallel morphogen gradients, Science 356, 1379 10.1126/science.aam5887 ",
            "year": 2017
        },
        {
            "authors": [
                "M.D. Petkova",
                "G. Tka\u010dik",
                "W. Bialek",
                "E.F. Wieschaus",
                "T. Gregor"
            ],
            "title": "Optimal Decoding of Cellular Identities in a Genetic Network",
            "venue": "Cell 176, 10.1016/j.cell.2019.01.007 ",
            "year": 2019
        },
        {
            "authors": [
                "M. Aliee",
                "J.C. R\u00f6per",
                "K.P. Landsberg",
                "C. Pentzold",
                "T.J. Widmann",
                "F. J\u00fclicher",
                "C. Dahmann"
            ],
            "title": "Physical mechanisms shaping the Drosophila dorsoventral compartment boundary",
            "venue": "Current Biology 22, 10.1016/j.cub.2012.03.070 ",
            "year": 2012
        },
        {
            "authors": [
                "A.D. Lander"
            ],
            "title": "How cells know where they are",
            "venue": "Science 339, 923 ",
            "year": 2013
        },
        {
            "authors": [
                "T. Bollenbach",
                "P. Pantazis",
                "A. Kicheva",
                "C. B\u00f6kel",
                "M. Gonz\u00e1lez-Gait\u00e1n",
                "F. J\u00fclicher"
            ],
            "title": "Precision of the Dpp gradient",
            "venue": "Development 135, 1137 ",
            "year": 2008
        },
        {
            "authors": [
                "J. Jaeger",
                "D. Irons",
                "N. Monk"
            ],
            "title": "Regulative feedback in pattern formation: Towards a general relativistic theory of positional information",
            "venue": "Development 135, 3175 ",
            "year": 2008
        },
        {
            "authors": [
                "K. Exelby",
                "E. Herrera-Delgado",
                "L.G. Perez",
                "R. Perez- Carrasco",
                "A. Sagner",
                "V. Metzis",
                "P. Sollich",
                "J. Briscoe"
            ],
            "title": "Precision of tissue patterning is controlled by dynamical properties of gene regulatory networks",
            "venue": "Development (Cambridge) 148, 10.1242/dev.197566 ",
            "year": 2021
        },
        {
            "authors": [
                "N. Perrimon",
                "C. Pitsouli",
                "B.Z. Shilo"
            ],
            "title": "Signaling mechanisms controlling cell fate and embryonic patterning",
            "venue": "Cold Spring Harbor Perspectives in Biology 4, a005975 ",
            "year": 2012
        },
        {
            "authors": [
                "M. Levin"
            ],
            "title": "Bioelectric signaling: Reprogrammable circuits underlying embryogenesis",
            "venue": "regeneration, and cancer, Cell 184, 1971 ",
            "year": 2021
        },
        {
            "authors": [
                "S. Toda",
                "W.L. Mckeithan",
                "T.J. Hakkinen",
                "P. Lopez"
            ],
            "title": "Engineering synthetic morphogen systems that can program multicellular patterning",
            "venue": "Science 370, 327 ",
            "year": 2020
        },
        {
            "authors": [
                "K.S. Stapornwongkul",
                "M. De Gennes",
                "L. Cocconi",
                "G. Salbreux",
                "J.-P. Vincent"
            ],
            "title": "Patterning and growth control in vivo by an engineered GFP gradient",
            "venue": "Science 6514, 321 ",
            "year": 2020
        },
        {
            "authors": [
                "S. Toda",
                "N.W. Frankel",
                "W.A. Lim"
            ],
            "title": "Engineering cell \u2013 cell communication networks: programming multicellular behaviors",
            "venue": "Current Opinion in Chemical Biology 52, 31 ",
            "year": 2019
        },
        {
            "authors": [
                "I. Barbier",
                "R. Perez-Carrasco",
                "Y. Schaerli"
            ],
            "title": "Controlling spatiotemporal pattern formation in a concentration gradient with a synthetic toggle switch",
            "venue": "Molecular Systems Biology 16, 1 ",
            "year": 2020
        },
        {
            "authors": [
                "J. van Gestel",
                "T. Bareia",
                "B. Tenennbaum",
                "A. Dal Co",
                "P. Guler",
                "N. Aframian",
                "S. Puyesky",
                "I. Grinberg",
                "G.G. D\u2019Souza",
                "Z. Erez",
                "M. Ackermann",
                "A. Eldar"
            ],
            "title": "Shortrange quorum sensing controls horizontal gene transfer at micron scale in bacterial communities",
            "venue": "Nature Communications",
            "year": 2021
        },
        {
            "authors": [
                "P. Hillenbrand",
                "U. Gerland",
                "G. Tka\u010dik"
            ],
            "title": "Beyond the French Flag Model: Exploiting Spatial and Gene Regulatory Interactions for Positional Information",
            "venue": "PloS one 11, e0163628 ",
            "year": 2016
        },
        {
            "authors": [
                "N.E. Buchler",
                "U. Gerland",
                "T. Hwa"
            ],
            "title": "On schemes of combinatorial transcription logic",
            "venue": "Proceedings of the National Academy of Sciences of the United States of America 100, 5136 ",
            "year": 2003
        },
        {
            "authors": [
                "A.E. Mayo",
                "Y. Setty",
                "S. Shavit",
                "A. Zaslaver",
                "U. Alon"
            ],
            "title": "Plasticity of the cis-regulatory input function of a gene",
            "venue": "PLoS Biology 4, 555 ",
            "year": 2006
        },
        {
            "authors": [
                "S. Restrepo",
                "J.J. Zartman",
                "K. Basler"
            ],
            "title": "Coordination of patterning and growth by the morphogen DPP",
            "venue": "Current Biology 24, R245 ",
            "year": 2014
        },
        {
            "authors": [
                "A. Colman-Lerner",
                "A. Gordon",
                "E. Serra",
                "T. Chin",
                "O. Resnekov",
                "D. Endy",
                "C.G. Pesce",
                "R. Brent"
            ],
            "title": "Regulated cell-to-cell variation in a cell-fate decision system",
            "venue": "Nature 437, 699 ",
            "year": 2005
        },
        {
            "authors": [
                "H. Bolouri",
                "E.H. Davidson"
            ],
            "title": "Modeling transcriptional regulatory networks",
            "venue": "BioEssays 24, 1118 ",
            "year": 2002
        },
        {
            "authors": [
                "S. Kalir",
                "U. Alon"
            ],
            "title": "Using a quantitative blueprint to reprogram the dynamics of the flagella gene network",
            "venue": "Cell 117, 713 ",
            "year": 2004
        },
        {
            "authors": [
                "H. Inomata"
            ],
            "title": "Scaling of pattern formations and morphogen gradients",
            "venue": "Development Growth and Differentiation 59, 41 ",
            "year": 2017
        },
        {
            "authors": [
                "G.D. Field",
                "F. Rieke"
            ],
            "title": "Nonlinear Signal Transfer from Mouse Rods to Bipolar Cells and Implications for Visual Sensitivity photons",
            "venue": "Neuron 34, 773 ",
            "year": 2002
        },
        {
            "authors": [
                "W. Bialek"
            ],
            "title": "Biophysics: Searching for Principles (Princeton University Press",
            "venue": "New Jersey,",
            "year": 2012
        },
        {
            "authors": [
                "C.J. Bashor",
                "N. Patel",
                "S. Choubey",
                "A. Beyzavi",
                "J. Kondev",
                "J.J. Collins",
                "A.S. Khalil"
            ],
            "title": "Complex signal processing in synthetic gene circuits using cooperative regulatory assemblies",
            "venue": "Science (New York, N.Y.) 597, 593 ",
            "year": 2019
        }
    ],
    "sections": [
        {
            "text": "Robust boundary formation in a morphogen gradient via cell-cell signaling\nMareike Bojer,1 Stephan Kremser,1 and Ulrich Gerland1, \u2217\n1Department of Physics, Technische Universita\u0308t Mu\u0308nchen, D-85748 Garching, Germany\nEstablishing sharp and correctly positioned boundaries in spatial gene expression patterns is a central task in both developmental and synthetic biology. We consider situations where a global morphogen gradient provides positional information to cells but is insufficient to ensure the required boundary precision, due to different types of noise in the system. In a conceptual model, we quantitatively compare three mechanisms, which combine the global signal with local signaling between neighboring cells, to enhance the boundary formation process. These mechanisms differ with respect to the way in which they combine the signals by following either an AND, an OR, or a SUM rule. Within our model, we analyze the dynamics of the boundary formation process, and the fuzziness of the resulting boundary. Furthermore, we consider the tunability of the boundary position, and its scaling with system size. We find that all three mechanisms produce less fuzzy boundaries than the purely gradient-based reference mechanism, even in the regime of high noise in the local signals relative to the noise in the global signal. Among the three mechanisms, the SUM rule produces the most accurate boundary. However, in contrast to the other two mechanisms, it requires noise to exit metastable states and rapidly reach the stable boundary pattern.\nI. INTRODUCTION\nThe formation and maintenance of gene expression boundaries between neighboring groups of cells is a fundamental task in biology [1, 2]. In developmental biology, such boundaries form to spatially partition embryonic tissues into distinct cell fates. The position of a boundary can be controlled by a global morphogen, a substance that displays a concentration gradient over the tissue and permits cells to determine their position via a concentration measurement [3]. Classic questions about gene expression boundaries concern the accuracy and scaling of their positioning [4] and their sharpness [1]. Embryo-to-embryo variations of the boundary position have been quantitatively studied, for instance, in the vertebrate neural tube [5] and Drosophila embryos [6]. Studying boundary sharpness additionally requires measuring the boundary profile within each embryo, as was done in Ref. [7] for a mechanically maintained compartment boundary.\nEstablishing and maintaining sharp, precisely positioned boundaries that scale with tissue size is a challenging task, given the various sources of noise in these systems [8]. Despite much research, the interplay of mechanisms that performs this task in different organisms and tissues is only partially understood [8\u201311]. Local cell-cell signaling is well known to play a major role in development [12, 13], but its role in boundary formation remains underexplored. Recently, a quantitative exploration of tissue patterning principles has become feasible in synthetic biology [2]. In a bottom-up approach, synthetic morphogen gradients and different intracellular regulation networks were constructed to quantitatively characterize their interplay [14, 15]. These studies were able to recapitulate, in a controlled way, many patterning features of native systems, including boundary formation\n\u2217 gerland@tum.de\n[14]. However, the obtained boundaries were fuzzy rather than sharp, suggesting that additional mechanisms are required to recapitulate this feature of native systems [2].\nHere we focus on local cell-cell signaling as a candidate additional mechanism to enable sharp boundaries and take a theoretical approach to explore its interplay with a global morphogen signal. A theoretical exploration appears timely, given that engineered cell-cell communication networks have recently been demonstrated [16], and further experimental work can benefit from a theoretical comparison of different possible designs. Also, the same conceptual question arises in a completely different biological context, based on bacterial systems [17], where short-range signaling can now also be controlled [18].\nOur aim is to identify generic principles rather than to model a specific biological system. We therefore choose a simple class of models, permitting us to focus on the conceptual question and to perform a systematic exploration of the associated parameter space. A prior study in a similar spirit [19] analyzed the encoding of positional information in a one-dimensional equilibrium model (a variant of an Ising spin system), which combined a morphogen gradient with a local interaction between neighboring cells. Here we focus on the concrete task of boundary formation in a two-dimensional system, rather than the more abstract notion of positional information, and study both the dynamics and the steady-state properties of the boundary formation process. Furthermore, we compare three different rules with which cells combine the local and global signals they receive: the SUM, AND, and OR rule, which are common regulation schemes in biological signal processing [20, 21]. We investigate which signal processing rule best meets the following criteria in each noise regime: (i) reduction of the boundary fuzziness, (ii) short time to reach the stationary boundary position, (iii) tunability of the boundary to different positions, such that the same mechanism can produce variations of the pattern in related species, and (iv) scaling of ar X iv :2 20 6. 03 80\n5v 1\n[ ph\nys ic\ns. bi\noph\n] 8\nJ un\n2 02\n2\n2 the boundary position with system size, such that pattern proportions are conserved in systems of different sizes.\nWe find that combining global and local signaling outperforms a gradient-only mechanism in nearly all noise regimes, even though local signaling adds an additional source of noise to the system. Among the three different rules, the SUM rule performs best for larger noise levels but converges slowly to the correct boundary position at lower noise levels. The performance of the AND and OR rules is equivalent. The stationary boundary position is tunable within the system for all rules, by varying the threshold for global signaling. Also, the position scales linearly with system size."
        },
        {
            "heading": "II. MODEL AND OBSERVABLES",
            "text": "Our theoretical approach is based on a minimal model for the formation of a gene expression boundary in a single layer of cells. The model focuses on the interplay between a morphogen gradient and local cell-cell signaling. Consequently, it ignores all other processes occurring in developmental systems that might change the neighborhood relation of cells, such as cell migration, proliferation, cell death, and cell shape changes. Also, we treat the local coupling between cells completely on the level of information and do not consider additional physical mechanisms, such as differential cell adhesion and differential mechanical tension [1]. The role of the morphogen gradient is to activate the target gene in cells at positions where the morphogen level exceeds a threshold, thereby creating a gene expression boundary. By contrast, the local signaling provides a means for cells to exchange information about their gene expression state with their neighbors and to use this information to modulate their response to the morphogen gradient.\nOur model and the relevant observables are described in detail in the following two subsections. On a conceptual level, it may be helpful to think of the model as a two-dimensional (2D) kinetic Ising model, which has unusual couplings between neighboring spins and is subject to an inhomogeneous external magnetic field, see the supplementary material for a detailed comparison [22]. However, in the context of our study it is important that there are different sources of noise, not just a single thermal noise. First, there is noise from the global morphogen signal. In developmental systems, all processes involving the morphogen \u2014 morphogen production, morphogen transport, morphogen uptake, and signaling \u2014 contribute to this noise. For example, morphogen production is subject to stochastic variations in morphogen molecule synthesis and secretion [9, 23], morphogen transport by diffusion is a stochastic process itself and can moreover be hindered by barriers [24]. At the morphogen uptake stage, cell-cell variability in the number of receptors, binding of molecules to receptors and receptor occupancy are additional sources of noise [9, 10, 25]. Finally, activation of the signaling pathways and gene regulation are also noisy\nprocesses [23]. These latter processes are also the cause for noise in cell-cell signaling.\nModel\nWe consider a square grid of L \u00d7 L cells, see Fig. 1. The state of a cell is reduced to either \u2018On\u2019 or \u2018Off\u2019, c = + 12 or \u2212 12 . Along the axis of the gradient (index i) the boundary conditions of our grid are fixed to Off on the left (i = 0) and On on the right side of the grid (i = L). In the perpendicular direction (index j) we apply periodic boundary conditions. The cell state is updated according to a signal processing rule L, which we also refer to as signal integration rule. The state can change at discrete time steps. The rule processes two different signals: the global signal at the cells position (i, j), sGij(t), representing the morphogen gradient, and a local signal, sLij(t), encoding the state of the cells within cij \u2019s neighborhood,\ncij(t+ 1) = L [ sGij(t), s L ij(t) ] . (1)\nA Boolean logic is the common simplification of the biologically observed Hill type regulation, as the sigmoidal form becomes a sharp threshold in the limit of large Hill coefficients [26]. Global signal The stochastic global signal at a cell with index (i, j) is given as\nsGij(t) = m i+ \u03be G ij(t) , (2)\nwith m, m \u2208 [0, 1] \u2282 R, the morphogen gradient slope at i and \u03beG additive Gaussian white noise with mean zero and standard deviation \u03c3G.\nDuring embryogenesis, morphogen molecule concentration is commonly assumed to be exponentially decaying within the tissue. Inspired by Ref. [19], we interpret the logarithm of the molecule concentration as the actual signal (Weber-Fechner law), resulting in a linear morphogen gradient signal. French Flag mechanism We refer to a signal processing rule that only depends on the global signal and compares it to a global threshold a as pure gradient rule LGRAD [ sG ] . It is the analog of the French Flag mechanism [3]. More precisely\nLGRAD [ sGij(t) ] := \u0398 [ sGij(t)\u2212 a ] \u2212 1\n2 , (3)\nwith \u0398 denoting the Heaviside step function with convention \u0398 [0] = 0. The state of a cell at position i at t+1 is + 12 if the global signal exceeds the global threshold a and \u2212 12 else. Local signal The signal processing rules with correction ability additionally make use of a local signal sL that stems from nearest-neighbor cells communicating their state. We conservatively assume that the central\ncell cannot sense from which neighbor the signal came from and thus define sL to be the sum of these signals\nsLij(t) = \u2211\n(k,l) \u2208 neighbors(i,j) ckl(t) + \u03be\nL ij(t) . (4)\n\u2018neighbors\u2019 refers to the upper, lower, left and right neighbor (von Neumann\u2019s neighborhood). \u03beL is chosen to be Gaussian white noise with a mean of zero and standard deviation \u03c3L. Consequently, the noise realization is in R, and with that the local signal.\nCorrection mechanisms To implement a correction mechanism, each cell needs to combine the two noisy signals sL and sG. It is by no means clear how this combination is optimally performed. Straight forwardly, we can add up both signals and compare the result to the global threshold a. We will refer to this procedure as SUM rule LSUM,\nLSUM [ sLij(t), s G ij(t) ] = \u0398 [ sLij(t) + s G ij(t)\u2212 a ] \u2212 1\n2 . (5)\nNote that the contribution of the local signal to the full signal can take any value by rescaling m and a simultaneously. Alternatively, both signals could be processed separately and the results combined by an AND or OR rule, denoted by LAND and LOR, respectively. A NOR or XOR rule is not expected to perform well in our setting, as both signals are chosen to promote the On state, see also Appendix A for a more explicit discussion. Processing the local signal separately requires an additional thresh-\nold, aAND respectively aOR,\nLAND [ sLij(t), s G ij(t) ] = \u0398 [ sLij(t)\u2212 aAND ] \u0398 [ sGij(t)\u2212 a ] \u2212 1\n2 ,\nLOR [ sLij(t), s G ij(t) ] = \u0398 [ sLij(t)\u2212 aOR ] + \u0398 [ sGij(t)\u2212 a ]\n\u2212\u0398 [ sLij(t)\u2212 aOR ] \u0398 [ sGij(t)\u2212 a ] \u2212 1\n2 .\nIf we want the AND and the OR rule to be able to produce a boundary from an arbitrary initial grid for all noise levels, equivalently to the pure gradient mechanism, then we find that there is only one choice for the local thresholds, i.e., aAND = \u22121 and aOR = +1. For larger aAND values the AND rule cannot exit an initial all Off grid in the small noise scenario. On the other hand, smaller aAND values increase the fuzziness as they reduce the correction ability of the AND rule, as for aAND \u22121 we essentially have a pure gradient rule. A quantitative version of this argument and numeric confirmation are shown in Appendix B. Equivalent reasoning holds true for the OR rule when starting from an all On grid.\nFor a choice of local thresholds such that aAND = \u2212aOR we observe in simulations and can show, a direct \u2018particle-hole\u2019 correspondence between the AND and the OR rule, resulting in\n\u3008cANDij \u3009 \u2248 \u2212\u3008cORi\u0303j \u3009, with i\u0303 = 2 a\nm \u2212 i , (6)\nwith the approximate relation becoming exact in the limit of an infinite grid. The approximation generally works well for a boundary position that is distant from\n4 the grid boundary. Essentially, this relation follows because the local signal is antisymmetric with respect to exchanging On for Off states and linearity of the global signal, as made explicit in Appendix C.\nThese rules can also be motivated by common input functions to gene transcription [20, 21, 26]: Either both signals or their products within the signal processing pathway can occupy the same promoter, a regulation scheme modeled by the SUM rule, motivated by Ref. [27]. Or there is a different promoter for each signal such that either both have to be occupied to switch on gene transcription, representing the AND rule, or occupation of one is sufficient implying an OR rule. The global threshold a thereby corresponds to the binding affinity of the transcription factor stemming from the morphogen signal to its promoter and the local thresholds to the binding affinity of the transcription factor related to the local direct neighbor signaling. However, the model is not limited to regulation of a cell\u2019s transcriptional state by chemical signaling. It also applies to bioelectrical signaling during embryogenesis for patterning processes involving a long ranged electric gradient, where cell-cell signaling is performed via ion channels and gap junctions [13], for instance. Or to mechanical cues as long as the cell neighborhoods are not altered.\nTransforming and reducing the parameter set The parameters characterizing the model are the grid length L, morphogen gradient slope m, global threshold a, and the standard deviations of the global and local noise \u03c3G and \u03c3L. In order to arrive at a description in more natural parameters, we transform m, a to m, am as a m corresponds to the spatial position where the morphogen signal equals its global threshold. Also, we transform the independent noises to a total noise and the relative contributions. The total noise is defined as \u03be := \u03beL + \u03beG with standard deviation \u03c3 and local to total noise ratio \u03b1 defined as\n\u03c32 := ( \u03c3G )2 + ( \u03c3L )2 , and \u03b1 :=\n( \u03c3L )2\n\u03c32 . (7)\nIf not stated otherwise, then we set the local to total noise ratio \u03b1 to \u03b1 = 2mL+2 as 2 is the maximal deterministic local signal and mL the maximal global signal.\nSimulation scheme For simplicity and computational efficiency, we chose the dynamics to consist of synchronous updates of the complete grid at equidistant, discrete time steps. We checked that the stationary state results qualitatively agree with a random update of all grid cells for the boundary position and fuzziness, see the supplementary material [22].\nObservables\nWe are interested in a correctly positioned boundary between different cell types that is straight and sharp. To make these notions quantitative, we define the boundary position B(t) of a grid at time t to be the average number\nof cells in Off state, per row,\nB(t) := 1 L\n\u2211\ni,j\n\u03b4 ( cij ,\u2212 1\n2\n) , (8)\nwith \u03b4 the Kronecker delta. This definition is related to the magnetization in Ising models and circumvents problems of other measures as discussed in the supplementary material [22].\nThe fuzziness F(t) of a grid at time t is then defined as the number of sites in the wrong state with respect to the boundary position, rounded to its closest integer, in percentage of the total number of cells,\nF(t) := 1 L2\n \u2211\ni<B,j \u03b4\n( cij , 1\n2\n) + \u2211\ni>B,j \u03b4\n( cij ,\u2212 1\n2\n)  .\n(9) Note that this definition combines two notions characterizing the quality of a boundary, its roughness and its softness. Given a unique boundary line, i.e., a grid configuration without holes, the roughness quantifies the boundaries\u2019 deviation from a straight line. In case of frequent holes, the softness measures the width of the holey region that constitutes the boundary. In the system presented here, holes do occur, but are rare, and thus we do not account for them separately. The chosen definition of boundary fuzziness counts both types of boundary errors equivalently. Exemplary grids visualizing boundary position and fuzziness can be found in the supplementary material [22]. The ensemble averages of the boundary position \u3008B\u3009 and the fuzziness \u3008F\u3009 are approximated by their time averages in the stationary state."
        },
        {
            "heading": "III. RESULTS",
            "text": "For a boundary established by a global signal in the form of a gradient with slope m and local signaling between neighboring cells, we want to measure the dependence of the boundary position B and its fuzziness F on the total noise. The total noise with standard deviation \u03c3 sums independent Gaussian noise on the global and the local signal."
        },
        {
            "heading": "A. Kinetics of approaching the stationary state",
            "text": "We start our investigation of the correction mechanisms SUM, AND and OR by studying the boundary position B(t) and fuzziness F(t) as a function of time using a synchronous update scheme of the whole grid. Toward that end, we consider an arbitrary but fixed threshold a, morphogen slope m, and grid length L, here chosen such that the boundary position of the pure gradient mechanism is in the middle of the grid.\n5 (ii)zoom in (i)\n(iii)\nLL-6 L/2+5L/2-1\nL/2-1 L/2\n\u2026 (iii)\nj\nj+6 t=1 t=2 t=3\n(ii)(i)\n(a)\n(b)\nFIG. 2. Exemplary boundary position B and fuzziness F (in terms of number of wrong cells) time traces starting from different initial conditions at t = 0, depicted in different colors, for the AND rule in the upper panel (a) and the SUM rule in the lower panel (b) subject to a small (first column) and a large (second column) noise value. Note that for the AND rule time is measured in terms of grid length. The grid length L = 255 is odd and a = 64.5 and m = 0.5 are chosen such that the stable boundary is in the grid center, only t \u2265 1 are shown for better visibility. Inserts (i)-(iii) provide a zoom in of 6\u00d76 sites to the grid, for few time steps. For the AND rule, starting from an all Off initial grid, zoom in (i) sketches the first three time steps, while zoom in (ii) provides a potential time trace of reaching the stable boundary position, which is L/2 here. For the SUM rule, zoom in (iii) sketches boundary destabilization and transition to a straight and sharp boundary.\nAND and OR rule We characterize the evolution under the AND rule, plotted in Fig. 2(a) for three different initial conditions: a random initial grid, a grid of all cells in state Off (\u2018all Off\u2019), and a grid of all cells in state On (\u2018all On\u2019). The first column shows for an exemplary low noise level the boundary position in the first row and the fuzziness in the second row in dependence of time.\nStarting from an all Off grid the boundary position B moves roughly one cell per time step until it reaches its\nstationary value [see Fig. 2(a), first row]. The fuzziness F increases until it drops sharply when the stationary boundary position has been reached. Note that already for low noise the fuzziness time trace remains wiggly for all times, implying that the stationary boundary is fuzzy. Remarkably, for larger noise the boundary position moves at the same rate. Only the stationary boundary is more fuzzy compared to the boundary in the low noise regime [see right column of Fig. 2(a)]. Consequently, the transition time to the initial condition independent, stationary, boundary position does not depend on the noise level. We also observe that the transition time is on the order of magnitude of the stationary boundary position. The last row of Fig. 3 confirms this independence more generally. An intuitive picture, explained in more detail in the supplementary material [22], for the dynamics is the following: By definition, the AND rule only allows cells to switch on if they have at least one On neighbor and the gradient signal exceeds its threshold a. The second condition is satisfied for all cells to the right of position i = \u230a a m \u230b by the deterministic part of the gradient signal. When starting from an all Off grid, the first condition implies that only cells at the right boundary can switch on due to cells at i = L + 1 being On (fixed grid-boundary condition choice). Each boundary cell can move at most one cell forward per time step [see Figs. 2(i) and (ii)]. Quantitatively, a cell with exactly one On neighbor switches on with probability 1/2 independent of the total noise level. A cell with more than one On neighbor switches on with a probability close to 1. Note that our choice of grid-boundary conditions, c0,j = 0 and cL+1,j = 1 for all rows j, does not substantially simplify the patterning task for the rules. The AND rule (and also the OR and SUM rule as we will see later) cannot just shift the sharp cell state boundary at L to its stationary position. Even if we had only one cell in On state at i = L+1 the rules could still establish a boundary at the center of the grid. However, this choice of grid boundary would artificially destabilize the correct stationary pattern due to local signaling, as the correct pattern requires that cells at i = L are On. For the \u2018all On\u2019 initial grid, convergence to the stationary boundary position occurs within the first time step, as the deterministic part of the neighborhood signal exceeds aAND = \u22121 everywhere in the grid and the AND rule essentially reduces to the pure gradient mechanism. For a random initial grid, at t = 0, the neighborhood signal exceeds aAND for about 3/4th of the cells in each column, thus convergence is fast, as well.\nThe OR rule by definition can only switch off one cell width at a time when starting from an initial grid of On cells. Consequently, the time traces of the OR rule qualitatively correspond to the ones of the AND rule with OnOff inverted initial conditions, see Fig. 9 in the Appendix. This was to be expected from the AND-OR relationship, Eq. (6).\nSUM rule Figure 2(b) shows evolution under the SUM rule and exhibits qualitatively different dynamics.\n6 The right column shows the large noise regime. We see that already within 20 time steps the different boundary position traces have converged. We also note that the boundary is fuzzy in contrast to the low noise regime. For a low noise level, as depicted in the left column of Fig. 2(b), the dynamics is more complex. While for all initial conditions, the boundary quickly reaches a position close to its stationary value, full convergence is very slow. Thus, in contrast to the AND and OR rule the transition time strongly depends on the noise level. Starting from any initial condition, the boundary reaches a position close to its stationary value within few time steps. Movement toward its final position happens when noise induces a seed at the boundary linearly spreading until all cells within the same column have switched state. As sketched in Fig. 2(iii), one seed induces a switch of both of its neighbors in the next time step and so forth until the complete column of former boundary cells has switched state, in case of an odd grid height. Then the boundary remains straight until the next seed occurs. In case of an even grid length, the pattern with every second boundary cell switched on corresponds to a metastable\nstate, see Appendix D. The waiting time distribution for the next seed to destabilize the metastable boundary is strongly noise level dependent. In fact, the transition time until the stationary state at \u230a a m \u230b is reached can be approximated by\nT (\u03c3) \u2248 12 L exp\n(\u221a 3\n2\u03c32\n) (10)\nfor sufficiently small \u03c3, as shown in the supplementary material [22], and plotted in Fig. 3. This functional form clearly shows the nonlinear dependence of the transition time on the noise level. As expected, the transition time is inversely proportional to the system length as a seed is more likely the more sites in the column next to the boundary noise is acting on."
        },
        {
            "heading": "B. Characterizing the stationary state\u2019s dependence on the noise level",
            "text": "Figure 3 shows the characteristic stationary state properties of the three correction mechanisms SUM, AND, and OR as a function of the total noises\u2019 standard deviation \u03c3 for an exemplary threshold a and morphogen signal slope m choice. For direct comparison, the results without correction mechanism (pure gradient) are plotted in blue. Each row shows a different observable \u2014 the time-averaged boundary position B, fuzziness F , and, in the last column, the transition time T . For simplicity, we here use the maximal number of time steps until reaching the stationary state from an all On and an all Off grid as a measure of T . We will discuss the different phenomenologies starting from low noise levels and ending with large noise levels.\nL/2-1\nL/2\nL/2+1\n0.0\n0.5\n1.0\n[% ]\n0.0 0.5 1.0 1.5 2.0 2.5 noise level 3\n100 101 102 103 104 105 106 [s te ps ]\nPure Gradient AND\nOR SUM\nFIG. 3. Overview of different stationary state behavior of the pure gradient, SUM, AND, and OR rule depending on noise level regime, exemplary for L = 256, a = 64.5, m = 0.5. On the x-axis, we use noise level \u221a 3\u03c3 instead of \u03c3 for better intuition of the strength of the total noise: More than 90% of all noise realizations are within the interval [ \u2212 \u221a 3\u03c3,+ \u221a 3\u03c3 ] . Also, a uniform distribution within [ \u2212 \u221a 3\u03c3,+ \u221a 3\u03c3 ] has variance \u03c32. In the first row, the time-averaged boundary position B for each rule is shown, where dashes indicate that the lines overlap. The light green and red lines show the analytical estimate of the boundary position for the AND and OR rule. In the second row, time-averaged fuzziness F in % of the total number of grid sites is plotted. The last row shows the transition time T until the initial condition independent state was reached, where a value of 106 implies that it has not converged within the simulation time. The light yellow line depicts the T approximation for the SUM rule for small noise levels, see Eq. (10).\nSmall noise levels In the last row of Fig. 3 we observe that the SUM rule results have not converged to stationary state within the simulation time of 106 time steps in the regime of very low noise levels. This is expected from the previous transition time discussion. Loosely speaking, noise is needed to forget the initial grid state. In contrast, the AND and OR rule\u2019s transition time T scales linearly with the boundary position, irrespective of the noise level as discussed in Sec. III A. The transition time from a particular initial condition, e.g., \u2018all On\u2019, can be significantly smaller, see Fig. 2. Turning to the second row of Fig. 3, we note that the boundary fuzziness for the SUM rule is remarkably close to zero for small yet sufficiently large noise levels to allow for convergence of the SUM rule pattern. An effectively nonfuzzy regime is not observed for other rules. In the first row, we observe that the SUM\u2019s boundary position agrees well with the pure gradient rules\u2019 for zero noise, while the AND and\n7 OR rules\u2019 boundary position slightly deviate up to a cell width. Indeed, we can derive analytic approximations for the stationary boundary positions, as outlined below, and refer to Appendix E for further details. For the SUM rule, the stationary boundary position is given by\niSUMc = \u230a a m \u230b = iGradc , (11)\nwith b\u00b7c denoting the floor operator. Consequently, the stationary boundary will scale with system size in the same way as for the pure gradient rule for zero noise. The stationary boundary position of the AND rule includes an additional term linear in the noise level,\niANDc \u2248 \u230a a m \u230b + 0.25\n\u221a 3\u03c3\nm\n\u221a 1\u2212 2\n2 +mL . (12)\nWe see that iANDc \u2248 iGradc + \u221a 3\u03c3\n4m for mL 2 which agrees well with simulation results shown in Fig. 3. For the OR rule, it follows\niORc \u2248 \u230a a m \u230b \u2212 0.25\n\u221a 3\u03c3\nm\n\u221a 1\u2212 2\n2 +mL , (13)\nby the AND-OR equivalence established in Eq. 6. To derive those expressions for the stationary boundary positions, we started from the following observation: The probability for a defect to disturb the boundary at ic needs to be smaller than the one for a potential boundary one cell width to its left, at ic\u22121, or to its right, at ic+1. Those disturbances can be either an Off cell right of the boundary (Off-in-On defect) or an On cell left of the boundary (On-in-Off defect). For a sketch of an Off-inOn defect, see the first grid of Fig. 2(iii). Consequently, two conditions need to be satisfied such that the stationary boundary position is at cell index i = ic. To the left, the probability to destabilize a boundary at ic \u2212 1 by an Off-in-On defect has to be smaller or equal to the probability destabilizing a boundary at ic by an On-inOff defect. To the right, the probability to destabilize a boundary at ic by an On-in-Off defect has to be smaller or equal to the probability destabilizing a boundary at ic+1 by an Off-in-On defect. Solving these inequalities with probabilities approximated for the different rules yields the stationary boundary position; see Appendix E. From this calculation we can also see that the probabilities for an On-in-Off defect and an Off-in-On defect at ic depend only on m and am \u2212 \u230a a m \u230b . These findings suggest that the fuzziness in stationary state only depends on the deviation of am to the next integer value. This is also confirmed by numeric results. Intuitively, the morphogen changes at the same rate everywhere in the system and the local interaction is independent of the position per definition.\na. Intermediate noise levels For larger noise levels the AND and the OR rule qualitatively exhibit the same behavior as for low noise, in contrast to the SUM rule. In the second row of Fig. 3 we observe a rapid increase in fuzziness for the SUM rule. Time-averaged fuzziness seems to arise from alternating between time intervals\nof a straight, sharp boundary and time intervals with a disturbance, seeded by a single defect cell, that grows and shrinks for some time before it decays. The probability for a seed is highly nonlinearly, but smoothly, increasing with noise level [22]. b. Large noise levels In the regime of large noise we see in the second row in Fig. 3 that the SUM rule yields a less fuzzy boundary than the AND and OR rule, which behave similarly. Indeed, all correction mechanisms outperform the pure gradient rule. We will show that this result is robust for all a, m parameter combinations determining the three rules in Sec. III D, for all grid lengths (Sec. III C) and for a surprisingly large range of local to total noise ratios \u03b1 (Sec. III E).\nThe boundary position B resulting from the SUM rule agrees well with the boundary position from the pure gradient as analytically deduced in Appendix E. Although the boundary positions from the AND and OR rules deviate linearly with the standard deviation of the total noise \u03c3, we will show in Sec. III C that both nevertheless scale linearly with system size."
        },
        {
            "heading": "C. All rules conserve scaling of the boundary position with system size",
            "text": "In embryogenesis, proportions commonly remain the same irrespective of different embryo or compartment sizes (see [28] for a review). The pure gradient mechanism also exhibits this scaling behavior, provided that the maximal morphogen concentration and the threshold remain constant. In our model these conserved proportions translate to a fixed fraction of On to Off cells within grids of different size for a fixed maximal morphogen signal mL. In Fig. 3 we have observed that the stable boundary position formed by the AND and OR rule deviates from the position established by the pure gradient rule. Thus we need to investigate if also the AND and OR rule ensure this property, just with a different fraction. For an exemplary parameter set, a = 2, mL = 8 at a large noise level \u221a 3\u03c3 = 2, we can see in Fig. 4 that this is indeed the case. The reason that AND (OR) rules\u2019 boundary position tends to larger (smaller) B values is that it discourages (encourages) On cells. As the slope m becomes smaller and smaller (mL fixed) the regime around the boundary in which this effect plays a role increases linearly with system length. This leads to a constant boundary position B over grid length L ratio. The deviation of this value from the pure gradient rules\u2019 result can be approximated by Eq. (12) and Eq. (13), respectively. For small grid sizes, we see that the relative boundary position of any rule has not yet converged to its large grid limit. The reason is of technical nature: Our parameter choices imply that defect cells at the left of the boundary are more common than at its right, see Appendix F for a more detailed argument.\nFigure 4 shows that the fraction of sites in the wrong state converges to a stable value for large system lengths.\n8 0.25\n0.19\n0.31\n/L\n24 26 28 210 212 L\n0.0 1.4\n5.6\n10.2\n[% ]\na/M Pure Gradient SUM\nAND OR\nFIG. 4. Upper panel: Relative time-averaged boundary position B for all three rules and pure gradient for increasing grid lengths L for a fixed noise level of \u221a 3\u03c3 = 2, a = 2, mL = 8, and all Off initial grid. Bottom panel: Time-averaged boundary fuzziness F in percentage of the number of cells in the grid. For sufficiently large grids the relative fuzziness converges to a constant value that is smallest for the SUM rule, larger for the AND and OR rule and highest for the pure gradient rule.\nConsequently, the improved boundary sharpness is not only a finite grid size effect. The observation that the SUM rule performs best, the AND and OR rule not as well, but better than pure gradient, also holds true for all tested grid lengths."
        },
        {
            "heading": "D. Systematic exploration of the parameter space",
            "text": "We want to know how much smoother the boundary established by the correction mechanisms is compared to the boundary established by the pure gradient rule. Until now, we have shown results for isolated points in the parameter space. Now we want to study the whole parameter space spanned by threshold a and morphogen signal slope m. It is equivalent to varying m and am from\u230a a m \u230b to \u2308 a m \u2309 as discussed in Sec. III B.\nLet us fix a high noise level, \u221a\n3\u03c3 = 2. We measure the boundary smoothing capability of a correction rule in terms of the ratio of the boundary fuzziness resulting from a correction mechanism to the boundary fuzziness caused by the pure gradient rule, FLOGIC( \u221a 3\u03c3 = 2)/FGRAD( \u221a\n3\u03c3 = 2). In order to show the full range of fuzziness ratios caused by varying a and m in Fig. 5, we choose for each m to display the ratios\u2019 minimal and\n0.2 0.4 0.6 0.8 1.0 gradient slope m\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nLO GI\nC /\nGR AD\nSUM AND OR\nFIG. 5. For a fixed noise level \u221a\n3\u03c3 = 2 and grid length\nL = 256 the fuzziness F fraction of the boundary formed by a correction rule (SUM, AND, OR) and the boundary fuzziness due to pure gradient is shown in dependence of the gradient slope m. Single markers correspond to the average fuzziness fraction over all a values and are interpolated by a solid line. The shaded area is restricted by the interpolation of the minimal (lower edge) and maximal (upper edge) fuzziness fraction with respect to all threshold a values.\nmaximal value for any a (interpolated by the lower and upper edge of the shaded area), as well as the ratios\u2019 average over a (data points interpolated by sold line).\nWe observe that F ratios are below one and that the SUM ratio is smallest for all morphogen slopes m. This implies that all three rules perform better for every threshold a and gradient slope m than the pure gradient rule with respect to fuzziness reduction. The performance gap between the pure gradient and the correction rules is smaller for larger morphogen slopes, and thus the most conservative choice for m is m = 1.0. Intuitively, this is because the steepest gradient provides the largest signal differences between neighboring cells in i direction.\nE. Variation of local to total noise ratio\nThe magnitude and ratio of local to global noise representing a variety of different processes as mentioned in the Introduction is not known. Still, for a fixed maximum morphogen signal mL, we have only considered one particular ratio of the local noise \u03beL to total noise \u03beL + \u03beG ratio \u03b1, \u03b1 = (\u03c3 L)2\n(\u03c3L)2+(\u03c3G)2 = 22+mL so far. Intuitively, the\npure gradient rule should perform better than the correction mechanisms for large \u03b1. By definition, the pure gradient rule only experiences noise on the global signal, which approaches zero for the local to total noise ratio \u03b1 approaching 1. The correction mechanisms, however, process an additional highly error-prone signal, the local signal. To test this intuition, we vary the local to total noise ratio \u03b1 between 0.1 and 0.9, see Fig. 6 for all different am combinations with m = 1.0, depicted in different colors. The maximal slope m = 1.0 is chosen to ensure\n9 0.0 0.2 0.4 [%] (SUM)\n0.0\n0.2\n0.4 (AND)\n0.1 0.5 0.90.0\n0.2\n0.4 (OR)\n0\n1/6\n1/3\n1/2\n2/3\n5/6\n1 a/m = L/2+ Pure Gradient\nFIG. 6. Fuzziness F at \u221a\n3\u03c3 = 2 in dependence of the local\nto total noise variance, \u03b1 for m = 1.0, one row for each correction mechanism. The blue line depicts the pure gradient performance, while the differently colored lines correspond to the correction mechanism result for different a/m combinations, L = 256.\nthe best relative pure gradient performance, as discussed in Sec. III D.\nPer definition, the SUM rule (first row) is independent of \u03b1, as it adds up the Gaussian distributed local \u03beL \u223c N (0, (\u03c3L)2) and global noise \u03beG \u223c N (0, (\u03c3G)2), yielding \u03beL + \u03beG \u223c N (0, \u03c32). The AND and OR rule perform worse relative to the SUM rule the larger \u03b1 is. Surprisingly, the \u03b1 value, where pure gradient (blue line) performs equally well than the correction mechanisms (other colors) is well beyond one half. This implies that a correction mechanism can sharpen the boundary, even if it is subject to more than twice as much noise than the pure gradient rule."
        },
        {
            "heading": "IV. DISCUSSION",
            "text": "Precise boundary formation is a remarkable phenomenon in developing systems and aspiring goal in synthetic systems. Here our objective was not to study any specific system, but to systematically explore how different logical couplings of cell-cell communication with a gradient signal can aid boundary formation.\nIn a minimal model of boundary formation consisting of cells that are either signaling (On) or inactive (Off), we studied three different correction mechanisms using this nearest-neighbor interaction in addition to a global (grid spanning) signal gradient. Those three rules either sum both signals (SUM) and subsequently compare the result to a global threshold a or compare each signal to a local and global threshold separately (AND, OR).\nConsequently, for a signal processing cell to switch to or maintain an On state, in case of the SUM rule the sum of both signals has to exceed the global threshold. The AND rule requires both signals to exceed their respective thresholds independently, while the OR rule requires only one signal to exceed its threshold. We examined which rule performs best in which regime of total noise, consisting of additive Gaussian noise on the local and the global signal. As motivated in the Introduction, performance is measured in terms of (i) reduction in boundary fuzziness, (ii) short transition time to stationary boundary position, (iii) position tuneable by threshold, and (iv) scaling with system size.\nWe found that (i) the SUM rule achieves the strongest fuzziness reduction, while the AND and OR rule yield comparably less reduction. Only if the noise on the global signal is much smaller than the noise on the local signal, the pure gradient ensures a sharper separation of cells with different gene expression states. (ii) However, transition to stationary state takes more time for any correction mechanism than for the pure gradient rule, which establishes the stationary boundary within one time step. The SUM rule generates a boundary position that deviates by few sites within one time step for sufficiently steep morphogen slopes. Exact convergence strongly depends on the noise level \u2014 the smaller, the slower. Qualitatively different, convergence of the AND and OR rule does not depend on the noise level, but on the initial state of the grid. In the best case it happens within one time step, in the worst case in order of grid length L time steps. A short transition time is desirable in development, as boundary cells often act at organizing cells for the next patterning process [1]. Also, fast morphogenesis is favorable to protect against predators. (iii) The boundary position can be tuned by changing the global threshold value a in a similar manner than for the pure gradient mechanism. This programability is of biological significance, as the threshold a was motivated by the binding affinity of the signals\u2019 transcription factor to the promoter of the gene, that is switched on. Possibly, variations of same theme among related species, such as a stripe that differs in width, can be explained as variations of the binding affinity. (iv) For fixed threshold value a and morphogen signal slope m the SUM rule yields the same boundary position as the pure gradient, while the AND and OR rules\u2019 boundary positions deviate by a small amount. Nevertheless, the boundary position established by any rule scales linearly with system size. The scaling property ensures compatibility with the observation that embryos of the same species differ (slightly) in size, but pattern ratios are often conserved [28].\nWhat is the underlying reason that the SUM rule outperforms the AND and OR rule in terms of fuzziness reduction? We believe this is because the SUM rule first averages the involved noises allowing them to cancel, before applying the nonlinearity in the form of comparing to a threshold. The deterministic signal is summed,\n10\nwhile the Gaussian noise\u2019s standard deviations only add in quadrature. For the AND and OR rule it is the other way round: They threshold each signal separately before combining the pieces of information. However, there are biological problems where this signal processing scheme \u2014 first thresholding, and then combining \u2014 is actually optimal, for example in case of a rare signal. Rod cells in the retina specialized to detecting very dim light first threshold before transmitting information to their common bipolar cell, which consecutively sums those digitized signals [29]. If the bipolar cell would first sum the signal of its numerous rod cells, then the simultaneously summed up noise would make it likely for the bipolar cells to confuse total darkness (no photon) with dim light (three or more photons). Consistent with the system presented here, it has been found that only those rod cells specialized for dim light detection process signal by thresholding before summing [30].\nIn a synthetic setup it is feasible to experimentally test our predictions as all necessary components have already been designed. On the one hand, tuning of local interactions has been successfully realized in multicellular systems, for example, AND-like, OR-like and in between, graded, SUM-like, regulatory behavior in yeast [31]. A remarkably customizable signal processing scheme in the form of a synthetic Notch pathway is presented in Ref. [16], and also reviewed in Ref. [32] among other protein based synthetic circuits in eukaryotic cells. On the other hand, tuneable processing of synthetic gradients has been demonstrated, such as toggle switch processing of a signal gradient in Escherichia coli [17]. A setup close to developmental biology was constructed within Drosophila wing primordia [15]. A combination of a synthetic gradient and a signal processing pathway that can in principle be customized to the rules discussed in this paper is the synthetic GFP morphogen that regulates target gene expression by a synNotch circuit [14].\nRemarkably, the study presented in Ref. [15] raises the question of which additional mechanisms are required for sharp boundary formation as the explored setups did not give rise to sharp boundaries [2]. The toolboxes listed above might be able to test whether the three different rules studied in this paper are candidates for the actual boundary correction necessary to ensure the exact results observed in nature. Also, insights about the potential of local signaling as a correction mechanism might find applications in synthetic biology more generally, as boundary and stripe formation are fundamental tasks in patterning and morphogenesis. To better meet such applications, the presented model can be trivially extended to stripe generation by introducing extra thresholds accordingly. It can be further generalized or modified by including more complex rules or smoothing the hard threshold via Hill-type functions, by considering irregular and dynamic cell grids, or by including additional mechanisms such as cell sorting."
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "We thank Leo Stenzel, Gasper Tkacik, Nicolas Gompel and Hamid Seyed-Allaei for insightful discussions, as well as Cesar Lopez-Pastrana, Isabella Graf and Johannes Harth-Kitzerow for critical reading of the manuscript. This research was supported by the German Research Foundation via the collaborative research center SFB1032 via U.G. MB was supported by a DFG fellowship through the Graduate School of Quantitative Biosciences Munich (QBM).\n11"
        },
        {
            "heading": "Appendix A: Other rule functions",
            "text": "SUM, AND, and OR rules are not the only options to process two signals. Others are XOR and PROD, but we can argue that they are not suited for the boundary formation problem as we modeled it. Let us start from an all Off grid with an XOR logic. In the next time step without noise it would form the correct boundary. In the consecutive update step, all On cells except those at the boundary would switch Off though, as each is subject to a local neighbor signal greater than any (sensible) local threshold value. Consequently the boundary would not be stable. The product rule PROD in the presence of noise reads if (global signal(i) +\u03beG)\u00b7 (local signal(i,t) + \u03beL) > a2: cell(i, t+1) = On which implies that the noise would be multiplied by the signal. Consequently, we expect this rule to perform poorly in the presence of sufficiently large noise.\nAppendix B: alocal optimization\nWe want the AND and OR rules to be able to produce a boundary from an arbitrary initial grid for all noise levels, equivalently to the pure gradient mechanism. Here we show that the initial grids all Off and all On are sufficient to fix the additional local thresholds aAND and aOR.\nLet us consider an all Off initial grid. At the right border, i = L, the global signal exceeds the global threshold a (otherwise the pure gradient rule could not form a nontrivial boundary either). For the AND rule to exit the initial condition, we need aAND to be smaller or equal than the local signal sLij(t) = \u22121 + \u03beLij(t). Thus, we need aAND \u2264 \u22121. Similarly, for an all On initial grid it follows that aORl \u2265 1. The second condition to determine the optimal local threshold comes from demanding that it stabilizes a straight boundary. To this end, consider a straight boundary, implying that the global signal is close to a, but with one On cell left of the boundary. For the AND rule, we want aAND \u2265 \u22121 in order to switch Off the defect cell. Taken together this suggests choosing aAND = \u22121. The opposite scenario, one Off cell right of the boundary, yields aAND < 1, which is well satisfied by our choice. Equivalent reasoning yields aOR = 1.\nWe confirmed these analytic arguments numerically for an exemplary small and large noise level, see Fig. 7 and Fig. 8. We observe that the fuzziness decreases with increasing aAND values. In the small noise example, aAND = \u22121 is the largest aAND value such that the AND rule forms a nontrivial boundary (i.e., BL 6= 1 or 0) independent of starting from an all On grid (red line) or an all Off grid (green line). If we drop the initial grid independence condition, e.g., if it suffices that the AND rule only patterns when starting from an all On initial grid, then the optimal choice of aAND would depend on the magnitude of deviation of boundary position from the one generated by pure gradient rule (dashed gray line)\nwe are willing to accept. This is deviation is particularly pronounced for large noise as shown in Fig. 8. Results for the OR rule are depicted in the right column and findings are analogous.\n12\nAppendix C: Relationship of AND and OR rule for aAND = \u2212aOR\nThe choice of aAND = \u2212aOR implies close correspondence of the AND and the OR rule in the stationary state. For an infinite grid we have\n\u3008cANDij \u3009 = \u2212\u3008cORi\u0303j \u3009 with i\u0303 = 2 a\nm \u2212 i ,\nwhere \u3008\u3009 denotes an ensemble average. Visually speaking i\u0303 is the mirror reflection of i at the zero transition of the morphogen gradient minus its threshold at am . For a finite grid, this relation still holds true for parameter combinations a, m such that the boundary is distant from edges of the grid. Then we can assume that cells not covered by the i\u0303 index, which are cells close to the grid boundaries, do not change their state. We can derive the above relation as follows:\ncANDi,j = LAND ( sLij(t), s G ij(t) )\n= \u0398 ( sLij(t)\u2212 aAND ) \u0398 ( sGij(t)\u2212 a ) \u2212 1\n2 ,\nwhereas\n\u2212cOR i\u0303,j = \u2212LOR ( sL i\u0303j , sG i\u0303,j )\n= \u2212 { 1\u2212 [ 1\u2212\u0398 ( sLij(t)\u2212 aOR )] [ 1\u2212\u0398 ( sG i\u0303,j (t)\u2212 a )]} + 1\n2\n= \u0398 ( \u2212sLij(t) + aOR ) \u0398 ( \u2212sG i\u0303,j (t) + a ) \u2212 1\n2 ,\nusing that 1\u2212\u0398(x) = \u0398(\u2212x). Now observe that\n\u0398 ( \u2212sG\ni\u0303,j (t) + a\n) = \u0398 ( \u2212sG\ni\u0303,j (t) + a\n)\n= \u0398 ( \u2212i\u0303m\u2212 \u03beG i\u0303,j + a ) = \u0398 ( im\u2212 \u03beGij(t)\u2212 a ) ,\nwhere we can neglect the sign change for \u03beGij(t) as it is symmetric around its zero mean. Thus, the contribution by the global signal is by construction of i\u0303 the same as in the case of the AND rule. In the stationary state, we have on ensemble average that\n\u2329 \u2212\n\u2211\n(k,l)\u2208V (\u0303i,j) ck,l\n\u232a = \u2329 \u2211\n(k,l)\u2208V(i,j) ck,l\n\u232a (C1)\nas the global signal is mirror antisymmetric with respect to the vertical i = ic line and the local signal is independent of the absolute position.\nThus,\n\u2329 \u0398 ( \u2212sL\ni\u0303,j (t) + aOR\n)\u232a\n= \u2329 \u0398  \u2212\n\u2211\n(k,l)\u2208V (\u0303i,j) ck,l \u2212 \u03beLi\u0303,j + a OR\n  \u232a\n= \u2329 \u0398   \u2211\n(k,l)\u2208V(i,j) ck,l + \u03be\nL ij(t)\u2212 aAND\n  \u232a .\nInserting those observations yields the relation Eq. (6). Exemplary time traces from simulation are shown in Fig. 9."
        },
        {
            "heading": "Appendix D: Time traces for even system length",
            "text": "In Fig. 10 we show the time traces of the AND and OR logic as in Fig. 2 of the main text but for an even grid length of L = 256 instead of the odd L = 255. An even grid length introduces an additional metastable state for the SUM rule between each subsequent sharp boundaries: the half-filled state, as explained in the main text. For simplicity, we thus chose to show the closest odd state grid in the main text. Here, we display the even\n13\nL = 256 version for completeness to show that except for this additional intermediate metastable state nothing changes."
        },
        {
            "heading": "Appendix E: Analytics for the stationary boundary position",
            "text": "a. Condition for stationary boundary position We have two conditions to be satisfied such that the stationary boundary position is at cell index i = ic: The probability to destabilize a boundary at ic\u2212 1 by an Offin-On defect has to be smaller or equal to the probability destabilizing a boundary at ic by an On-in-Off defect. For a sketch, see the first grid of Fig. 2, insets (iii) and (iv), respectively. For the right-hand side of ic we can formulate the conditions as:\n(i) P(OffInOn |b = ic \u2212 1) > P(OnInOff |b = ic) (ii) P(OffInOn |b = ic) < P(OnInOff |b = ic + 1)\nwith, e.g., P(OffInOn |b = ic\u22121) denoting the probability of an Off-in-On defect, if the sharp boundary position is at b = ic + 1.\nb. Stationary boundary position for the SUM rule For the SUM rule the individual probabilities are given by\nP(OnInOff |b = i) = P(sG(i) + sL(i) \u2265 a)\n= P  mi+\n\u2211\n(k,l)\u2208V(i,j) ck,l + \u03be \u2265 a\n \n= P (\u03be \u2265 a+ 1\u2212mi) ,\nwith V(i, j) the Von Neumann neighborhood of the cell at (i, j), i.e., its upper, lower, right, and left neighbor and \u03be = \u03beL + \u03beG the total noise. We at first used that with a straight boundary at i a cell at (i, j) (j arbitrary) has one On and three Off neighbors. Further,\nP(OffInOn |b = i) = P(sG(i+ 1) + sL(i+ 1) < a)\n= P  m(i+ 1) +\n\u2211\n(k,l)\u2208V(i+1,j) ck,l + \u03be < a\n \n= P (\u03be < a\u2212m(i+ 1)\u2212 1) .\nInserting both into conditions (i) and (ii) and that \u03be has the same distribution as \u2212\u03be gives\n(i) P(\u03be < a\u2212mic \u2212 1) > P(\u03be \u2264 \u2212(a\u2212mic)\u2212 1) \u21d2 a\u2212mic \u2265 0 ,\n(ii) P(\u03be < a\u2212m(ic + 1)\u2212 1) < P(\u03be \u2264 \u2212(a\u2212m(ic + 1))\u2212 1) \u21d2 a\u2212m(ic + 1) < 0 .\nAs ic \u2208 N, these two inequalities are satisfied by\niSUMc = \u230a a m \u230b = iGradc . (E1)\nThe stationary boundary will scale with system size in the same way as for the pure boundary formation by gradient mechanism for zero noise. Note that in the stationary state, implying that i = ic, the probabilities for an On-In-Off defect and an Off-InOn defect only depend on the morpophogen slope m and the deviation of am from its subsequent integer:\nP(OffInOn |b = ic) = P (\u03be < a\u2212m(ic + 1)\u2212 1) = P ( \u03be < m\n( a m \u2212 \u230a a m \u230b + 1 ) \u2212 1 )\nand equivalently for P(OnInOff |b = ic). c. Stationary boundary position for the AND and OR rule Let us consider the AND rule. The individual\n14\nprobabilities are given by\nP(OnInOff |b = i)\n= P ( sGij(t) + \u03be G ij(t) > a ) P\n  \u2211\n(k,l)\u2208V(i,j) ck,l + \u03be\nL ij(t) \u2265 \u22121\n \n= P(sGij(t) + \u03be G ij(t) > a)P ( \u03beLij(t) \u2265 0 )\n= P(sGij(t) + \u03be G ij(t) > a)\n1 2 ,\nwhere we at first used that with a straight boundary at i a cell at i has one On and three Off neighbors. Then we observed that the for nonzero noise the probability of the local noise to exceed its mean 0 is 1/2, independent of its precise distribution (as long as it is symmetric). Further,\nP(OffInOn |b = i) = 1\u2212 P(sGi+1,j + \u03beGij(t) > a)\n\u00b7 P\n  \u2211\n(k,l)\u2208V(i+1,j) ck,l + \u03be\nL ij(t) \u2265 \u22121\n \n= 1\u2212 P(sGi+1,j + \u03beGij(t) > a)P ( \u03beLij(t) \u2265 \u22122 )\n\u2248 1\u2212 P((sGi+1,j) + \u03beGij(t) > a) Here we used that for an Off-in-On defect given the boundary is at i, we need to consider a cell at i + 1, which consequently has one Off and three On neighbors. For the noise level regime, \u221a 3\u03c3 \u2208 [0, 2.5] that we consider\nin this paper, P ( \u03beL \u2265 \u22122 ) \u2248 1 is a good approximation. With that follows from condition (i)\nP ( sGiANDc ,j + \u03be G ij(t) > a ) < 2 3 , (E2)\nwhich is easily satisfied for iGradc = \u230a a m \u230b as sG(iGradc ) \u2248 0. From condition (ii) follows\nP ( sGiANDc +1,j + \u03be G ij(t) > a ) \u2265 2 3 , (E3)\nwhich consequently determines iANDc . For the Gaussian noise distribution with mean zero and standard deviation\n\u03c3G = \u03c3 \u221a\n1\u2212 22+mL , it follows\niANDc = \u230a a m \u230b \u2212 \u221a 3\u03c3 m \u221a 1\u2212 2 2 +mL (\u221a 2 3 erfc\u22121 ( 4 3 ))\n\u2248 \u230a a m \u230b + 0.25\n\u221a 3\u03c3\nm\n\u221a 1\u2212 2\n2 +mL . (E4)\nWe see that iANDc \u2248 iGradc + \u221a 3\u03c3\n4m for mL 2, which agrees nicely with simulation results shown in Fig. 3. For the OR rule, it follows\niORc \u2248 \u230a a m \u230b \u2212 0.25\n\u221a 3\u03c3\nm\n\u221a 1\u2212 2\n2 +mL , (E5)\nrespectively by the AND-OR equivalence established in Eq. (6)."
        },
        {
            "heading": "Appendix F: Convergence during Scaling",
            "text": "The reason the boundary position and fuzziness for small lengths deviate from the values for large grids is of technical nature, as our parameter choice yields a boundary at \u230a a m \u230b = am = 1 4L. For the pure gradient rule, for instance, this choice implies\ncic,j = \u0398(mic + \u03be G ij(t) \u2265 a)\u2212\n1 2 = \u0398(\u03beGij(t) \u2265 0)\u2212 1 2 ,\nand thus on average the cell at ic is switched On every second time step due to noise. In contrast, for c(ic+1,j) these parameters more stably yield On as\ncic+1,j = \u0398(mic+1+\u03be G ic+1,j \u2265 a)\u2212\n1 2 = \u0398(\u03beG \u2265 \u2212m)\u2212 1 2 .\nThus defect cells at the left of the boundary are more common than at its right.\n15\n[1] C. Dahmann, A. C. Oates, and M. Brand, Boundary formation and maintenance in tissue development, Nature Reviews Genetics 12, 43 (2011). [2] N. Barkai and B.-Z. Shilo, Reconstituting tissue patterning., Science (New York, N.Y.) 370, 292 (2020). [3] L. Wolpert, Positional information and the spatial pattern of cellular differentiation, Journal of Theoretical Biology 25, 1 (1969). [4] T. Gregor, D. W. Tank, E. F. Wieschaus, and W. Bialek, Probing the Limits to Positional Information, Cell 130, 153 (2007). [5] M. Zagorski, Y. Tabata, N. Brandenberg, M. P. Lutolf, T. Bollenbach, J. Briscoe, , and A. Kicheva, Decoding of position in the developing neural tube from antiparallel morphogen gradients, Science 356, 1379 10.1126/science.aam5887 (2017). [6] M. D. Petkova, G. Tkac\u030cik, W. Bialek, E. F. Wieschaus, T. Gregor, Optimal Decoding of Cellular Identities in a Genetic Network, Cell 176, 10.1016/j.cell.2019.01.007 (2019). [7] M. Aliee, J. C. Ro\u0308per, K. P. Landsberg, C. Pentzold, T. J. Widmann, F. Ju\u0308licher, C. Dahmann, Physical mechanisms shaping the Drosophila dorsoventral compartment boundary, Current Biology 22, 10.1016/j.cub.2012.03.070 (2012). [8] A. D. Lander, How cells know where they are, Science 339, 923 (2013). [9] T. Bollenbach, P. Pantazis, A. Kicheva, C. Bo\u0308kel, M. Gonza\u0301lez-Gaita\u0301n, and F. Ju\u0308licher, Precision of the Dpp gradient, Development 135, 1137 (2008). [10] J. Jaeger, D. Irons, and N. Monk, Regulative feedback in pattern formation: Towards a general relativistic theory of positional information, Development 135, 3175 (2008). [11] K. Exelby, E. Herrera-Delgado, L. G. Perez, R. PerezCarrasco, A. Sagner, V. Metzis, P. Sollich, and J. Briscoe, Precision of tissue patterning is controlled by dynamical properties of gene regulatory networks, Development (Cambridge) 148, 10.1242/dev.197566 (2021). [12] N. Perrimon, C. Pitsouli, and B. Z. Shilo, Signaling mechanisms controlling cell fate and embryonic patterning, Cold Spring Harbor Perspectives in Biology 4, a005975 (2012). [13] M. Levin, Bioelectric signaling: Reprogrammable circuits underlying embryogenesis, regeneration, and cancer, Cell 184, 1971 (2021). [14] S. Toda, W. L. Mckeithan, T. J. Hakkinen, and P. Lopez, Engineering synthetic morphogen systems that can program multicellular patterning, Science 370, 327 (2020). [15] K. S. Stapornwongkul, M. De Gennes, L. Cocconi, G. Salbreux, and J.-P. Vincent, Patterning and growth control in vivo by an engineered GFP gradient, Science 6514, 321 (2020). [16] S. Toda, N. W. Frankel, and W. A. Lim, Engineering cell \u2013 cell communication networks: programming multicellular behaviors, Current Opinion in Chemical Biology 52, 31 (2019).\n[17] I. Barbier, R. Perez-Carrasco, and Y. Schaerli, Controlling spatiotemporal pattern formation in a concentration gradient with a synthetic toggle switch, Molecular Systems Biology 16, 1 (2020). [18] J. van Gestel, T. Bareia, B. Tenennbaum, A. Dal Co, P. Guler, N. Aframian, S. Puyesky, I. Grinberg, G. G. D\u2019Souza, Z. Erez, M. Ackermann, and A. Eldar, Shortrange quorum sensing controls horizontal gene transfer at micron scale in bacterial communities, Nature Communications 12, 2324 (2021). [19] P. Hillenbrand, U. Gerland, and G. Tkac\u030cik, Beyond the French Flag Model: Exploiting Spatial and Gene Regulatory Interactions for Positional Information, PloS one 11, e0163628 (2016). [20] N. E. Buchler, U. Gerland, and T. Hwa, On schemes of combinatorial transcription logic, Proceedings of the National Academy of Sciences of the United States of America 100, 5136 (2003). [21] A. E. Mayo, Y. Setty, S. Shavit, A. Zaslaver, and U. Alon, Plasticity of the cis-regulatory input function of a gene, PLoS Biology 4, 555 (2006). [22] Supplementary material for I. Details on boundary position and fuzziness definition; II. Comparison to an asynchronous update scheme; III. Kinetics of the correction mechanism in detail; IV. Comparison of the Ising model. (2022). [23] J. M. Raser and E. O\u2019Shea, Noise in Gene Expression, Science 309, 2010 (2005). [24] S. Restrepo, J. J. Zartman, and K. Basler, Coordination of patterning and growth by the morphogen DPP, Current Biology 24, R245 (2014). [25] A. Colman-Lerner, A. Gordon, E. Serra, T. Chin, O. Resnekov, D. Endy, C. G. Pesce, and R. Brent, Regulated cell-to-cell variation in a cell-fate decision system, Nature 437, 699 (2005). [26] H. Bolouri and E. H. Davidson, Modeling transcriptional regulatory networks, BioEssays 24, 1118 (2002). [27] S. Kalir and U. Alon, Using a quantitative blueprint to reprogram the dynamics of the flagella gene network, Cell 117, 713 (2004). [28] H. Inomata, Scaling of pattern formations and morphogen gradients, Development Growth and Differentiation 59, 41 (2017). [29] G. D. Field and F. Rieke, Nonlinear Signal Transfer from Mouse Rods to Bipolar Cells and Implications for Visual Sensitivity photons, Neuron 34, 773 (2002). [30] W. Bialek, Biophysics: Searching for Principles (Princeton University Press, New Jersey, 2012) p. 640. [31] C. J. Bashor, N. Patel, S. Choubey, A. Beyzavi, J. Kondev, J. J. Collins, and A. S. Khalil, Complex signal processing in synthetic gene circuits using cooperative regulatory assemblies, Science (New York, N.Y.) 597, 593 (2019). [32] Z. Chen and M. B. Elowitz, Programmable protein circuit design, Cell , 1 (2021).\nSupplementary material: Robust boundary formation in a morphogen gradient via cell-cell signaling\nMareike Bojer,1 Stephan Kremser,1 and Ulrich Gerland1\n1Department of Physics, Technische Universita\u0308t Mu\u0308nchen, D-85748 Garching, Germany"
        },
        {
            "heading": "I. BOUNDARY POSITION AND FUZZINESS DEFINITION",
            "text": "a. From exemplary grids In Fig. 1 we can observe in the first row for a small noise level an exemplary grid for each rule as well as a representation for large noise in the second row. We observe that all four rules construct the boundary at a similar position. To make this notion quantitative, we defined the boundary position B(t) of a grid at time t to be the number of cells in Off state and the average over time approximating the ensemble average for sufficiently long times as formalized in the main text. The other quality we want to quantify is the fuzziness of the boundary. In Fig. 1, for small noise levels, the SUM rule produces a sharp boundary, the AND, OR and GRAD rule show one to two misplaced cells. For a larger noise level, also the boundary produced by the SUM rule shows defects. The number of defects by the AND and OR rule is similar, although they seem to occur at different sites of the boundary. One might even note that the number of cells in the wrong state for the AND and OR rule is smaller than for the pure gradient. A definition of boundary fuzziness is in order to discuss this heuristic hints. The fuzziness F(t) of a grid at time t is defined as the number of sites in the wrong state with respect to the boundary position rounded to its closest integer, also called defect cells, in percent of the total number of cells in the grid, as stated in the main text. In Fig. 1 the instantaneous fuzziness F(t) is visualized in terms of cells in the wrong state as crossed out cells, for the pure gradient rule. For a random grid, the fuzziness reaches it\u2019s maximum value of 50%.\nFIG. 1. The first row shows an exemplary steady state grid for a small noise level of \u221a 2\u03c3\u03b7 = 0.5 for each rule, the second row for a large \u221a 2\u03c3 = \u03b7 = 2. L = 11, m = 1, a = 5.5.\nThe ensemble average of the time it takes for a system to reach its initial condition independent state is taken to be the Transition Time T . Consequently the transition time is a mean first passage time. As we are only interested in a rough estimate, we will use the maximum of the first passage time from two runs starting at an initial grid of purely Off cells and purely On cells as an approximation. b. Reasoning The definition of the boundary position definition circumvents complications due to \u2019holes\u2019 in the grid. Otherwise we would have to decide to either ignore them or introduce a left (most) and right (most) boundary and combining these in an arguable way. Another common definition that elegantly deals with \u2019holes\u2019 is fitting a tanh and using the x-value of it\u2019s zero crossing as the boundary position. Here, we want to work with grids ranging from 23 up to 213 cells. For the small grids, fitting a tanh gives poor results."
        },
        {
            "heading": "II. UPDATE SCHEME",
            "text": "a. Cellular automata simulations Cellular automata models are models that have discretized time, state and space. At every time step the discrete state of each cell is updated by a function depending only on the cells and it\u2019s nearest neighbors state. Updates are usually synchronous. Here we extended the model to allow for a global signal read out at the cells position, moreover the cells future state does not directly depend on its current state. b. Asynchronous updates yield qualitatively similar results to synchronous updates To make sure that our results do not depend on the exact updating procedure, we compared the overview plot produced by the synchronous update scheme to that of a random update scheme in Fig. 2. One time step in the random update scheme corresponds to L2 times drawing a cell from the grid at random and updating it according to the pure gradient, SUM, AND or OR rule. From Fig. 2, we observe that the results qualitatively agree for all rules. Convergence for small noises is different, which makes sense as an asynchronous update could help to exit the metastable boundary position more quickly. From a computational perspective the synchronous update scheme is by far more efficient than the asynchronous one. ar X iv :2 20 6. 03 80 5v 1 [ ph\nys ic\ns. bi\noph\n] 8\nJ un\n2 02\n2\n2 0 1 2 2 4 BP SUM\n0 1 2 0\n20\nFu zz\n[% ]\n0 1 2 010 0\n101 102 103 104 105\nTr an\nsit io\nn Ti\nm e\n0 1 2\nAND\n0 1 2\n0 1 2 noise level\n0 1 2\nOR\n0 1 2\n0 1 2\nL = 5, a = 1.86, m = 0.60\nGlobal signal \u00d7 logic: start Random\n\u00d7 logic: start all Off \u00d7 logic: start all On\n127.5\n130.0\nBP\nSUM\n0.0\n0.5\nFu zz\n[% ]\n0 1 2 101 102 103 104 105 106 Tr an sit io n Ti\nm e\nAND\n0 1 2 noise level\nOR\n0 1 2\nL = 256, a = 64.50, m = 0.50\nGlobal signal \u00d7 logic: start Random\n\u00d7 logic: start all Off \u00d7 logic: start all On"
        },
        {
            "heading": "III. KINETICS OF THE CORRECTION",
            "text": "When starting from an all Off initial grid, the local signal exceeds the local threshold only at the right grid boundary due to fixing the cells at L+1 to On. The AND rule consequently conserves the Off state everywhere else. Thus only cells at i = L can switch On at the first time step. They do so with probability one half, as the condi-\ntion of the global signal exceeding its threshold is nearly always fulfilled and with one On neighbor the deterministic local neighbor signal equals it threshold, thus the sign of the local noise with mean zero determines the cells state at the next time step:\nLAND ( sL, sG ) + 1\n2 = \u0398\n( sLij(t) + 1 ) \u0398 ( sGij(t)\u2212 a )\n\u2248 \u0398\n  \u2211\nj\u2208V(i) cj(t) + \u03be\nL ij(t) + 1\n  \u00b7 1\n= \u0398 ( \u03beLij(t) ) .\nIf a cell has more than one On neighbor, it will probably switch on, as long as the gradient signal exceeds its threshold. Note that both processes do not depend on the noise level, in good approximation. As the first process repeats, noise contributions sum up, so we observe an increase in boundary fuzziness until the On state has propagated to its stationary boundary position. The second process meanwhile reduces boundary fuzziness by filling wholes and is responsible for the fast convergence, once the first cell has reached to the stationary boundary position.\nSUM rule\nAt the first time step the global signal\u2019s contribution suffices to establish a boundary position close to its stationary position and the remaining deviation is due to the different initial conditions. Starting from a random initial grid the stationary boundary position is established so quickly that we can only observe a short peak in the fuzziness at the very beginning. Starting from a grid of all Off (or all On cells), we observe that the boundary position jumps very quickly from its initial value to the next straight line one cell width to its left (or right). During the boundary jump, the fuzziness in- and decreases roughly linearly with time with a maximum value close to half of the grid\u2019s width. This indicates that during the jump process only cells at this column change state and they do so in a consecutive, ordered manner. From resolving this boundary jump process more accurately in time for an ensemble of runs Fig.3, we conclude that for sufficiently small noise the stochastic switch of state of one cell of an otherwise straight boundary triggers the consecutive switch of the remaining boundary cells. This initial switch of state we refer to as a seed. As sketched in Fig. 2 of the main text, insert (iii) and (iv), one seed induces a switch of both of its neighbors in the next time step and so forth until the complete column of former boundary cells has switched state, in case of an odd boundary length.\nFor an even grid length, half filling of the column corresponds to an intermediate meta stable state. The next boundary jump takes significantly longer. Boundary jumping halts when the probability for a seed destabilizing the On state is equally high to the probability of\n3 FIG. 3. On an L = 11 grid for an ensemble of 5000 runs, the fuzziness time trace in number of cells is plotted in a separate panel for each boundary jump. At t = 0 we start from an all Off grid in the last panel and a boundary position at L = 11 and observe that the fuzziness on average within the first 50 time steps reaches its maximum at 4, before it drops again to zero, implying that a new sharp boundary at i = 10 has been established. Different colors indicate different runs. The full run time is limited to 105 time steps, consequently in the jump 7 to 6 and 6 to 5 panel there are significantly fewer runs plotted, as for most simulations those jumps haven\u2019t happened within the time simulated. The noise level was set to\u221a\n3\u03c3 = 0.3.\ndestabilizing the Off state modulo discretization. This is the case for i = ic := \u230a a m \u230b , which is identical to the position of the run starting from random initial conditions.\na. Quantitative take on transition time of SUM rule To get a better understanding of SUM rule dynamics, we quantitatively work out the transition time for (very) small noise. The scaling with noise level \u221a\n3\u03c3 of the resulting transition time approximation will moreover explain, why we cannot just simulate long enough get the SUM rules stationary state behavior in this noise regime. The probability density of the first passage time (FPT) from boundary position i to i+ 1 depends on the proba-\nbility of a seed for the jump, P (seed), as follows\nP (FPT of i\u2192 i\u2212 1 = t) = (1\u2212 P (seed))t\u22121P (seed)\n=\n( 1\n1\u2212 P (seed)\n)\u2212t P (seed)\n1\u2212 P (seed) \u2248 \u03bb exp(\u2212\u03bbt)\nwith \u03bb = P (seed) and using P (seed) 1. The approximation to an exponential distribution is also confirmed numerically, see 4 and Fig. 5.\nConsequently, the mean first passage time (MFPT) of the boundary jump from i to i \u2212 1 is given by \u03bb\u22121. P (seed) is the probability of a single cell at the boundary to switch to the wrong state, which we call a \u201ddefect\u201d. For an On defect at the left side of the boundary it is given by grid height L times the probability that any of the boundary cells switches state. The probability of a single cell to switch equals the cumulative Gaussian total noise distribution with standard deviation \u03c3 for noise realizations exceeding the threshold a reduced by the local signal sL and global signal sG = im contribution. A cell left of the boundary has three Off neighbors and one On neighbor, thus sL = \u22121. With that\nP (seed) = L\n\u221e\u222b\na+1\u2212im\n1 \u03c3 \u221a 2\u03c0 exp\n( 1\n2 (n \u03c3 )2) dn\n= L\n2 erfc ( 1\u221a 2 a+ 1\u2212 im \u03c3 ) . (1)\nWe can read off that the mean first passage time rapidly increases with decreasing i thus to get an estimation of the transition time towards the stationary boundary position, we can neglect all previous boundary jumps\nT (\u03c3) \u2248 MFPT(ic + 1\u2192 ic)\n\u2248 2 L\nerfc\u22121 (\n1\u221a 2 1 \u03c3\n)\n\u2248 12 L exp\n( 3\n2 1\u221a 3\u03c32\n)\nwhere in the last step we have used an approximation of the complementary error function valid for small \u03c3. We immediately see that simulating the stationary state of very small \u03c3 is not feasible.\n4 0 50000 100000 time jump 8 to 7 = 21135.8914 0 200 400 pd f jump 11 to 10 = 45.0166 0 1000 2000 jump 10 to 9 = 287.6628 0 10000 20000 time pd f jump 9 to 8 = 2286.256\nFIG. 4. Shown is the waiting time distribution \u03c4 until the next boundary jump for an ensemble of 5000 runs and maximal total simulation time of 105 time points. In orange the fit result for the distribution is shown, P (\u03c4, i) \u221d exp (\u2212\u03bb(i)\u03c4), with i denoting the boundary position. Results are for an L = 11 square grid and a noise level of \u221a 3\u03c3 = 0.3.\n0 1 2 3 jump i i 1\n102\n103\n104\nsc al\ne va\nlu e\nanalytic prediction simulation\nFIG. 5. Comparison of the simulation results for the scale \u03bb(i) of each boundary jump to the analytic prediction, \u03bb\u22121 = L\n2\nerfc\n(\n1\u221a\n2\na+1\u2212im\n\u03c3\n)\n. Jumps are numbered in order of their\noccurrence starting from 0, i.e. jump 0 corresponds to i = 11 \u2192 i = 10, jump 1 to i = 10 \u2192 i = 9, ect."
        },
        {
            "heading": "IV. COMPARISON TO ISING",
            "text": "\u2018Ising model\u2019 generally refers to an equilibrium model, whereas the CA model also describes dynamics. To nevertheless compare both models, we choose Monte Carlo updates for the Ising model and random updates (i.e. only one cell at a time) for the cellular automaton. For all possible grid configurations we need to compare transition probabilities. As the interaction is local and only one site is changed at a time, it is sufficient\nto compare P Ising\u22121\u21921 and P CA \u22121\u21921 for a configuration s such that sk(t) = \u22121 as well as P Ising1\u2192\u22121 and PCA1\u2192\u22121 for sk(t) = 1. P\u22121\u2192\u22121 and P1\u21921 follow as one minus the checked ones. Concretely we can pose the following question: is it possible to find a noise distribution for the cellular automaton s.t. the Ising MC-update probability P Ising\u22121\u21921 = P CA \u22121\u21921 , can P Ising 1\u2192\u22121 = P CA 1\u2192\u22121 also be fulfilled?\na. For the Ising model with an MC updating scheme: Choose a random site k in state sk: If r \u221dUni[0,1] < P = Min [ 1, exp ( \u2212\u2206ET )] : flip state, with kB set to 1, and Uni[0,1] referring to the uniform distribution within the Interval [0, 1] and\n\u2206E = \u2206H (sk(t+ 1), sk(t))\n= \u2212J \u2211\nj\u2208N (k) (sk(t+ 1)\u2212 sk(t)) sj(t) ,\nwith\nH = \u2212J \u2211\n\u3008i,j\u3009 sisj \u2212\n\u2211\ni\n(gxi + c)si .\nb. For the CA model choose a random site k If signal(k) + noise(n, k) > a: remain respectively switch On, with signal(k)=\n\u2211 j\u2208V(k) sj + km\n\u21d4 if noise(n, k) > \u2212 \u2211 j\u2208V(k) sj + km : sk(t+ 1) = 1 A comparison to the Ising model with MC updates suggests that if there exists a probability distribution noise(n, k) such that Ising corresponds to CA then it also exists for 0 external field and J = 1 and vice versa.\nLet us start with the actual comparison. Assume sk = \u22121, then for the Ising model\nP Ising\u22121\u21921 =    exp ( \u2212\u2206E T ) for \u2206E > 0\n= 1 for \u2206E < 0\n=    exp ( \u2212 \u22122\u2211j\u2208V(i) sj T ) for \u2212 \u2211 j\u2208V(i) sj > 0 = 1 for \u2212 \u2211\nj\u2208V(i) sj < 0\nIn case of the CA noise(n, k) is a random number r, r \u221d f(r) implying\nPCA\u22121\u21921 = P\n r > \u2212 \u2211\nj\u2208V(i) sj\n  =\n\u221e\u222b\n\u2212\u2211j\u2208V(i) sj\nrf(r)dr\n5 This form suggests the choice of an exponential distribution:\nPCA\u22121\u21921 =    exp ( \u2212 \u22122\u2211j\u2208V(i) sj \u03c3 ) for \u2212 \u2211 j\u2208V(i) sj > 0 = 1 for \u2212 \u2211\nj\u2208V(i) sj < 0\nConsequently PCA\u22121\u21921 = P Ising \u22121\u21921. But as P CA \u22121\u21921 = P CA 1\u21921 and P Ising1\u21921 = 1\u2212P Ising\u22121\u21921 the transition probabilities PCA1\u21921 and P Ising1\u21921 cannot coincide."
        }
    ],
    "title": "Robust boundary formation in a morphogen gradient via cell-cell signaling",
    "year": 2022
}