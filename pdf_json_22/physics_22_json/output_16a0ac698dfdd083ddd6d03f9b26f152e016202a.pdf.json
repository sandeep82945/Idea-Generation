{
    "abstractText": "This manual describes the PYTHIA 8.3 event generator, the most recent version of an evolving physics tool used to answer fundamental questions in particle physics. The program is most often used to generate high-energy-physics collision \u201cevents\u201d, i.e. sets of particles produced in association with the collision of two incoming high-energy particles, but has several uses beyond that. The guiding philosophy is to produce and reproduce properties of experimentally obtained collisions as accurately as possible. The program includes a wide ranges of reactions within and beyond the Standard Model, and extending to heavy ion physics. Emphasis is put on phenomena where strong interactions play a major role. The manual contains both pedagogical and practical components. All included physics models are described in enough detail to allow the user to obtain a cursory overview of used assumptions and approximations, enabling an informed evaluation of the program output. A number of the most central algorithms are described in enough detail that the main results of the program can be reproduced independently, allowing further development of existing models or the addition of new ones. Finally, a chapter dedicated fully to the user is included towards the end, providing pedagogical examples of standard use cases, and a detailed description of a number of external interfaces. The program code, the online manual, and the latest version of this print manual can be found on the PYTHIA web page: https://www.pythia.org/ Copyright C. Bierlich et al. This work is licensed under the Creative Commons Attribution 4.0 International License. Published by the SciPost Foundation. Received 07-04-2022 Accepted 12-08-2022 Published 10-11-2022 Check for updates doi:10.21468/SciPostPhysCodeb.8",
    "authors": [
        {
            "affiliations": [],
            "name": "Christian Bierlich"
        },
        {
            "affiliations": [],
            "name": "Smita Chakraborty"
        },
        {
            "affiliations": [],
            "name": "Nishita Desai"
        },
        {
            "affiliations": [],
            "name": "Leif Gellersen"
        },
        {
            "affiliations": [],
            "name": "Ilkka Helenius"
        },
        {
            "affiliations": [],
            "name": "Philip Ilten"
        },
        {
            "affiliations": [],
            "name": "Leif L\u00f6nnblad"
        },
        {
            "affiliations": [],
            "name": "Stephen Mrenna"
        },
        {
            "affiliations": [],
            "name": "Stefan Prestel"
        },
        {
            "affiliations": [],
            "name": "Christian T. Preuss"
        },
        {
            "affiliations": [],
            "name": "Torbj\u00f6rn Sj\u00f6strand"
        },
        {
            "affiliations": [],
            "name": "Peter Skands"
        },
        {
            "affiliations": [],
            "name": "Marius Utheim"
        },
        {
            "affiliations": [],
            "name": "Rob Verheyen"
        }
    ],
    "id": "SP:d57bc0228e512510613bd1b7101bb7a6e7d827b9",
    "references": [
        {
            "authors": [
                "T. Sj\u00f6strand"
            ],
            "title": "An introduction to PYTHIA 8.2",
            "venue": "Comput. Phys. Commun. 191,",
            "year": 2015
        },
        {
            "authors": [
                "T. Sj\u00f6strand"
            ],
            "title": "The Pythia event generator: Past",
            "venue": "present and future, Comput. Phys. Commun. 246, 106910 ",
            "year": 2020
        },
        {
            "authors": [
                "W. Bartel"
            ],
            "title": "Experimental study of jets in electron-positron annihilation",
            "venue": "Phys. Lett. B 101,",
            "year": 1981
        },
        {
            "authors": [
                "L. L\u00f6nnblad"
            ],
            "title": "Ariadne version 4 - A program for simulation of QDC cascades implementing the colour dipole model",
            "venue": "Comput. Phys. Commun. 71, 15 ",
            "year": 1016
        },
        {
            "authors": [
                "G. Ingelman"
            ],
            "title": "A",
            "venue": "Edin and J. Rathsman, LEPTO 6.5 - A Monte Carlo generator for deep inelastic lepton-nucleon scattering, Comput. Phys. Commun. 101, 108 ",
            "year": 1016
        },
        {
            "authors": [
                "H. Kharraziha",
                "L. L\u00f6nnblad"
            ],
            "title": "The linked dipole chain Monte Carlo",
            "venue": "J. High Energy Phys. 03, 006 ",
            "year": 1998
        },
        {
            "authors": [
                "B. Nilsson-Almqvist",
                "E. Stenlund"
            ],
            "title": "Interactions between hadrons and nuclei: The Lund Monte Carlo - FRITIOF version",
            "venue": "Comput. Phys. Commun. 43,",
            "year": 1987
        },
        {
            "authors": [
                "F. James",
                "L. Moneta"
            ],
            "title": "Review of high-quality random number generators",
            "venue": "Comput. Softw. Big Sci. 4, 2 ",
            "year": 2020
        },
        {
            "authors": [
                "G. Marsaglia",
                "B. Narasimhan",
                "A. Zaman"
            ],
            "title": "A random number generator for PC\u2019s",
            "venue": "Comput. Phys. Commun. 60, 345 (1990), doi:10.1016/0010-4655(90)90033-W. 261 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "M. L\u00fcscher"
            ],
            "title": "A portable high-quality random number generator for lattice field theory simulations",
            "venue": "Comput. Phys. Commun. 79, 100 ",
            "year": 1016
        },
        {
            "authors": [
                "K.G. Savvidy"
            ],
            "title": "The MIXMAX random number generator",
            "venue": "Comput. Phys. Commun. 196, 161 ",
            "year": 2015
        },
        {
            "authors": [
                "R. Kleiss",
                "R. Pittau"
            ],
            "title": "Weight optimization in multichannel Monte Carlo",
            "venue": "Comput. Phys. Commun. 83, 141 ",
            "year": 1016
        },
        {
            "authors": [
                "T. Sj\u00f6strand",
                "M. van Zijl"
            ],
            "title": "A multiple-interaction model for the event structure in hadron collisions",
            "venue": "Phys. Rev. D",
            "year": 1987
        },
        {
            "authors": [
                "T. Sj\u00f6strand"
            ],
            "title": "S",
            "venue": "Mrenna and P. Skands, PYTHIA 6.4 physics and manual, J. High Energy Phys. 05, 026 ",
            "year": 2006
        },
        {
            "authors": [
                "L. L\u00f6nnblad"
            ],
            "title": "Fooling around with the Sudakov veto algorithm",
            "venue": "Eur. Phys. J. C 73, 2350 ",
            "year": 2013
        },
        {
            "authors": [
                "S. Pl\u00e4tzer",
                "M. Sj\u00f6dahl"
            ],
            "title": "The Sudakov veto algorithm reloaded",
            "venue": "Eur. Phys. J. Plus 127, 26 ",
            "year": 2012
        },
        {
            "authors": [
                "R. Kleiss",
                "R. Verheyen"
            ],
            "title": "Competing Sudakov veto algorithms",
            "venue": "Eur. Phys. J. C 76, 359 ",
            "year": 2016
        },
        {
            "authors": [
                "P.A.W. Lewis",
                "G.S. Shedler"
            ],
            "title": "Simulation of nonhomogeneous poisson processes by thinning",
            "venue": "Nav. Res. Logist. 26, 403 ",
            "year": 1979
        },
        {
            "authors": [
                "L. Devroye"
            ],
            "title": "Non-uniform random variate generation",
            "venue": "Springer, New York, US, ISBN 9781461386438 ",
            "year": 2013
        },
        {
            "authors": [
                "S. Mrenna",
                "P. Skands"
            ],
            "title": "Automated parton-shower variations in Pythia 8",
            "venue": "Phys. Rev. D 94, 074005 ",
            "year": 2016
        },
        {
            "authors": [
                "F. James"
            ],
            "title": "Monte-Carlo phase space",
            "venue": "CERN Acad. Train. Lect. 23, CERN-68-15 ",
            "year": 1968
        },
        {
            "authors": [
                "R. Kleiss",
                "W.J. Stirling",
                "S.D. Ellis"
            ],
            "title": "A new Monte Carlo treatment of multiparticle phase space at high energies",
            "venue": "Comput. Phys. Commun. 40, 359 ",
            "year": 1016
        },
        {
            "authors": [
                "H. Brooks",
                "P. Skands",
                "R. Verheyen"
            ],
            "title": "Interleaved resonance decays and electroweak radiation in Vincia",
            "venue": "SciPost Phys. 12, 101 ",
            "year": 2022
        },
        {
            "authors": [
                "E. Norrbin",
                "T. Sj\u00f6strand"
            ],
            "title": "Production and hadronization of heavy quarks",
            "venue": "Eur. Phys. J. C 17, 137 ",
            "year": 2000
        },
        {
            "authors": [
                "J.F. Gunion",
                "Z. Kunszt"
            ],
            "title": "Lepton correlations in gauge-boson pair production and decay",
            "venue": "Phys. Rev. D 33, 665 ",
            "year": 1986
        },
        {
            "authors": [
                "G.T. Bodwin",
                "E. Braaten",
                "G.P. Lepage"
            ],
            "title": "Rigorous QCD analysis of inclusive annihilation and production of heavy quarkonium",
            "venue": "Phys. Rev. D 51, 1125 ",
            "year": 1995
        },
        {
            "authors": [
                "R. Baier",
                "R. R\u00fcckl"
            ],
            "title": "Hadronic collisions: A quarkonium factory",
            "venue": "Z. Phys. C 19, 251 (1983), doi:10.1007/BF01572254. 262 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "R. Gastmans",
                "W. Troost",
                "T.T. Wu"
            ],
            "title": "Cross sections for gluon + gluon\u2192 heavy quarkonium + gluon",
            "venue": "Phys. Lett. B 184, 257 ",
            "year": 2693
        },
        {
            "authors": [
                "P. Cho",
                "A.K. Leibovich"
            ],
            "title": "Color-octet quarkonia production",
            "venue": "II, Phys. Rev. D 53, 6203 ",
            "year": 1996
        },
        {
            "authors": [
                "F. Yuan",
                "C.-F. Qiao",
                "K.-T. Chao"
            ],
            "title": "D-wave heavy quarkonium production in fixed target experiments",
            "venue": "Phys. Rev. D 59, 014009 ",
            "year": 1998
        },
        {
            "authors": [
                "B. Humpert",
                "P. M\u00e9ry"
            ],
            "title": "\u03c8\u03c8 production at collider energies",
            "venue": "Z. Phys. C 20, 83 ",
            "year": 1983
        },
        {
            "authors": [
                "C.-F. Qiao"
            ],
            "title": "J/\u03c8 pair production at the Fermilab Tevatron",
            "venue": "Phys. Rev. D 66, 057504 ",
            "year": 2002
        },
        {
            "authors": [
                "M. Bargiotti",
                "V. Vagnoni"
            ],
            "title": "Heavy quarkonia sector in PYTHIA 6.324: Tuning, validation and perspectives",
            "year": 2007
        },
        {
            "authors": [
                "R. Aaij"
            ],
            "title": "Study of J/\u03c8 production in jets",
            "venue": "Phys. Rev. Lett. 118,",
            "year": 1920
        },
        {
            "authors": [
                "A.M. Sirunyan"
            ],
            "title": "Study of J/\u03c8meson production inside jets in pp collisions at p s = 8 TeV",
            "venue": "Phys. Lett. B",
            "year": 2020
        },
        {
            "authors": [
                "L. Carloni",
                "T. Sj\u00f6strand"
            ],
            "title": "Visible effects of invisible hidden valley radiation",
            "venue": "J. High Energy Phys. 09, 105 (2010), doi:10.1007/JHEP09",
            "year": 2010
        },
        {
            "authors": [
                "L. Carloni",
                "J. Rathsman",
                "T. Sj\u00f6strand"
            ],
            "title": "Discerning secluded sector gauge structures",
            "venue": "J. High Energy Phys. 04, 091 (2011), doi:10.1007/JHEP04",
            "year": 2011
        },
        {
            "authors": [
                "S. Dittmaier"
            ],
            "title": "Handbook of LHC Higgs cross sections: 1. Inclusive observables, CERN",
            "venue": "Yellow Rep.: Monogr.,",
            "year": 2011
        },
        {
            "authors": [
                "S.C. Park",
                "H.S. Song",
                "J. Song"
            ],
            "title": "Z boson pair production at CERN LHC in a stabilized Randall-Sundrum scenario",
            "venue": "Phys. Rev. D 65, 075008 ",
            "year": 2002
        },
        {
            "authors": [
                "K. Kova\u0159\u00edk",
                "P.M. Nadolsky",
                "D.E. Soper"
            ],
            "title": "Hadronic structure in high-energy collisions",
            "venue": "Rev. Mod. Phys. 92, 045003 ",
            "year": 2020
        },
        {
            "authors": [
                "V.N. Gribov",
                "L.N. Lipatov"
            ],
            "title": "Deep inelastic ep scattering in perturbation theory",
            "venue": "Sov. J. Nucl. Phys. 15, 438 ",
            "year": 1972
        },
        {
            "authors": [
                "Y.L. Dokshitzer"
            ],
            "title": "Calculation of the structure functions for deep inelastic scattering and e+e\u2212 annihilation by perturbation theory in quantum chromodynamics",
            "venue": "Sov. Phys. J. Exp. Theor. Phys. 46, 641 ",
            "year": 1977
        },
        {
            "authors": [
                "G. Altarelli",
                "G. Parisi"
            ],
            "title": "Asymptotic freedom in parton language",
            "venue": "Nucl. Phys. B 126, 298 ",
            "year": 1016
        },
        {
            "authors": [
                "M. Gl\u00fcck",
                "E. Reya",
                "I. Schienbein"
            ],
            "title": "Pionic parton distributions revisited",
            "venue": "Eur. Phys. J. C 10, 313 (1999), doi:10.1007/s100529900124. 263 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "M. Gl\u00fcck",
                "E. Reya",
                "A. Vogt"
            ],
            "title": "Pionic parton distributions",
            "venue": "Z. Phys. C 53, 651 ",
            "year": 1992
        },
        {
            "authors": [
                "M. Gl\u00fcck",
                "E. Reya",
                "M. Stratmann"
            ],
            "title": "Mesonic parton densities derived from constituent quark model constraints",
            "venue": "Eur. Phys. J. C 2, 159 ",
            "year": 1998
        },
        {
            "authors": [
                "T. Sj\u00f6strand",
                "M. Utheim"
            ],
            "title": "Hadron interactions for arbitrary energies and species",
            "venue": "with applications to cosmic rays, Eur. Phys. J. C 82, 21 ",
            "year": 2022
        },
        {
            "authors": [
                "V. Bertone",
                "R. Gauld",
                "J. Rojo"
            ],
            "title": "Neutrino telescopes as QCD microscopes",
            "venue": "J. High Energy Phys. 01, 217 (2019), doi:10.1007/JHEP01",
            "year": 2019
        },
        {
            "authors": [
                "V.V. Sudakov"
            ],
            "title": "Vertex parts at very high-energies in quantum electrodynamics",
            "venue": "Sov. Phys. J. Exp. Theor. Phys. 3, 65 ",
            "year": 1956
        },
        {
            "authors": [
                "T. Sj\u00f6strand"
            ],
            "title": "A model for initial state parton showers",
            "venue": "Phys. Lett. B 157, 321 ",
            "year": 2693
        },
        {
            "authors": [
                "G. Gustafson"
            ],
            "title": "Dual description of a confined colour field",
            "venue": "Phys. Lett. B 175, 453 ",
            "year": 2693
        },
        {
            "authors": [
                "G. Gustafson",
                "U. Pettersson"
            ],
            "title": "Dipole formulation of QCD cascades",
            "venue": "Nucl. Phys. B 306, 746 ",
            "year": 1016
        },
        {
            "authors": [
                "G. \u2019t"
            ],
            "title": "Hooft, A planar diagram theory for strong interactions",
            "venue": "Nucl. Phys. B 72,",
            "year": 1974
        },
        {
            "authors": [
                "S. H\u00f6che",
                "D. Reichelt",
                "F. Siegert"
            ],
            "title": "Momentum conservation and unitarity in parton showers and NLL resummation",
            "venue": "J. High Energy Phys. 01, 118 (2018), doi:10.1007/JHEP01",
            "year": 2018
        },
        {
            "authors": [
                "N. Baberuxki",
                "C.T. Preuss",
                "D. Reichelt",
                "S. Schumann"
            ],
            "title": "Resummed predictions for jetresolution scales in multijet production in e+e\u2212 annihilation",
            "venue": "J. High Energy Phys. 04, 112 (2020), doi:10.1007/JHEP04",
            "year": 2020
        },
        {
            "authors": [
                "M. Dasgupta",
                "F.A. Dreyer",
                "K. Hamilton",
                "P.F. Monni",
                "G.P. Salam"
            ],
            "title": "Logarithmic accuracy of parton showers: A fixed-order study",
            "venue": "J. High Energy Phys. 09, 033 (2018), doi:10.1007/JHEP09",
            "year": 2018
        },
        {
            "authors": [
                "K. Hamilton",
                "R. Medves",
                "G.P. Salam",
                "L. Scyboz",
                "G. Soyez"
            ],
            "title": "Colour and logarithmic accuracy in final-state parton showers",
            "venue": "J. High Energy Phys. 03, 041 (2021), doi:10.1007/JHEP03",
            "year": 2021
        },
        {
            "authors": [
                "Z. Nagy",
                "D.E. Soper"
            ],
            "title": "Summations of large logarithms by parton showers",
            "venue": "Phys. Rev. D 104, 054049 ",
            "year": 2021
        },
        {
            "authors": [
                "Z. Nagy",
                "D.E. Soper"
            ],
            "title": "Summations by parton showers of large logarithms in electronpositron annihilation, arXiv:2011.04777",
            "year": 2011
        },
        {
            "authors": [
                "M. Dasgupta",
                "F.A. Dreyer",
                "K. Hamilton",
                "P.F. Monni",
                "G.P. Salam",
                "G. Soyez"
            ],
            "title": "Parton showers beyond leading logarithmic accuracy",
            "venue": "Phys. Rev. Lett. 125, 052002 ",
            "year": 2020
        },
        {
            "authors": [
                "J.R. Forshaw",
                "J. Holguin",
                "S. Pl\u00e4tzer"
            ],
            "title": "Building a consistent parton shower",
            "venue": "J. High Energy Phys. 09, 014 (2020), doi:10.1007/JHEP09(2020)014. 264 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "W.T. Giele",
                "D.A. Kosower",
                "P.Z. Skands"
            ],
            "title": "Higher-order corrections to timelike jets",
            "venue": "Phys. Rev. D 84, 054003 ",
            "year": 2011
        },
        {
            "authors": [
                "S. Pl\u00e4tzer",
                "M. Sj\u00f6dahl"
            ],
            "title": "Subleading Nc improved parton showers",
            "venue": "J. High Energy Phys. 07, 042 (2012), doi:10.1007/JHEP07",
            "year": 2012
        },
        {
            "authors": [
                "S. Pl\u00e4tzer",
                "M. Sjodahl",
                "J. Thor\u00e9n"
            ],
            "title": "Color matrix element corrections for parton showers",
            "venue": "J. High Energy Phys. 11, 009 (2018), doi:10.1007/JHEP11",
            "year": 2018
        },
        {
            "authors": [
                "J. Bellm"
            ],
            "title": "Colour rearrangement for dipole showers",
            "venue": "Eur. Phys. J. C 78, 601 ",
            "year": 2018
        },
        {
            "authors": [
                "J. Holguin",
                "J.R. Forshaw",
                "S. Pl\u00e4tzer"
            ],
            "title": "Improvements on dipole shower colour",
            "venue": "Eur. Phys. J. C 81, 364 ",
            "year": 2021
        },
        {
            "authors": [
                "J. Isaacson",
                "S. Prestel"
            ],
            "title": "Stochastically sampling color configurations",
            "venue": "Phys. Rev. D 99, 014021 ",
            "year": 2019
        },
        {
            "authors": [
                "S. H\u00f6che",
                "D. Reichelt"
            ],
            "title": "Numerical resummation at subleading color in the strongly ordered soft gluon limit",
            "venue": "Phys. Rev. D 104, 034006 ",
            "year": 2021
        },
        {
            "authors": [
                "Z. Nagy",
                "D.E. Soper"
            ],
            "title": "Parton shower evolution with subleading color",
            "venue": "J. High Energy Phys. 06, 044 (2012), doi:10.1007/JHEP06",
            "year": 2012
        },
        {
            "authors": [
                "Z. Nagy",
                "D.E. Soper"
            ],
            "title": "Effects of subleading color in a parton shower",
            "venue": "J. High Energy Phys. 07, 119 (2015), doi:10.1007/JHEP07",
            "year": 2015
        },
        {
            "authors": [
                "J.R. Forshaw",
                "J. Holguin",
                "S. Pl\u00e4tzer"
            ],
            "title": "Parton branching at amplitude level",
            "venue": "J. High Energy Phys. 08, 145 (2019), doi:10.1007/JHEP08",
            "year": 2019
        },
        {
            "authors": [
                "M. De Angelis",
                "J.R. Forshaw",
                "S. Pl\u00e4tzer"
            ],
            "title": "Resummation and simulation of soft gluon effects beyond leading color",
            "venue": "Phys. Rev. Lett. 126, 112001 ",
            "year": 2021
        },
        {
            "authors": [
                "M. Bengtsson",
                "T. Sj\u00f6strand"
            ],
            "title": "Coherent parton showers versus matrix elements - Implications of PETRA/PEP data",
            "venue": "Phys. Lett. B 185, 435 ",
            "year": 2693
        },
        {
            "authors": [
                "M. Bengtsson",
                "T. Sj\u00f6strand"
            ],
            "title": "A comparative study of coherent and non-coherent parton shower evolution",
            "venue": "Nucl. Phys. B 289, 810 ",
            "year": 1016
        },
        {
            "authors": [
                "E. Norrbin",
                "T. Sj\u00f6strand"
            ],
            "title": "QCD radiation off heavy particles",
            "venue": "Nucl. Phys. B 603, 297 ",
            "year": 1016
        },
        {
            "authors": [
                "T. Sj\u00f6strand",
                "P.Z. Skands"
            ],
            "title": "Transverse-momentum-ordered showers and interleaved multiple interactions",
            "venue": "Eur. Phys. J. C 39, 129 ",
            "year": 2005
        },
        {
            "authors": [
                "R. Corke",
                "T. Sj\u00f6strand"
            ],
            "title": "Interleaved parton showers and tuning prospects",
            "venue": "J. High Energy Phys. 03, 032 (2011), doi:10.1007/JHEP03",
            "year": 2011
        },
        {
            "authors": [
                "B. Cabouat",
                "T. Sj\u00f6strand"
            ],
            "title": "Some dipole shower studies",
            "venue": "Eur. Phys. J. C 78, 226 ",
            "year": 2018
        },
        {
            "authors": [
                "G. Miu",
                "T. Sj\u00f6strand"
            ],
            "title": "W production in an improved parton-shower approach",
            "venue": "Phys. Lett. B 449, 313 (1999), doi:10.1016/S0370-2693(99)00068-4. 265 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "N. Desai",
                "P.Z. Skands"
            ],
            "title": "Supersymmetry and generic BSM models in Pythia 8",
            "venue": "Eur. Phys. J. C 72, 2238 ",
            "year": 2012
        },
        {
            "authors": [
                "J.R. Christiansen",
                "T. Sj\u00f6strand"
            ],
            "title": "Weak gauge boson radiation in parton showers",
            "venue": "J. High Energy Phys. 04, 115 (2014), doi:10.1007/JHEP04",
            "year": 2014
        },
        {
            "authors": [
                "B. Andersson",
                "G. Gustafson",
                "J. Samuelsson"
            ],
            "title": "The linked dipole chain model for DIS",
            "venue": "Nucl. Phys. B 467, 443 ",
            "year": 1016
        },
        {
            "authors": [
                "S. Catani",
                "B.R. Webber",
                "G. Marchesini"
            ],
            "title": "QCD coherent branching and semi-inclusive processes at large x",
            "venue": "Nucl. Phys. B 349, 635 ",
            "year": 1016
        },
        {
            "authors": [
                "G. Gustafson"
            ],
            "title": "Multiplicity distributions in QCD cascades",
            "venue": "Nucl. Phys. B 392, 251 ",
            "year": 1016
        },
        {
            "authors": [
                "S. Catani",
                "M.H. Seymour"
            ],
            "title": "A general algorithm for calculating jet cross sections in NLO QCD",
            "venue": "Nucl. Phys. B 485, 291 ",
            "year": 1016
        },
        {
            "authors": [
                "H. Brooks",
                "P. Skands"
            ],
            "title": "Coherent showers in decays of colored resonances",
            "venue": "Phys. Rev. D 100, 076006 ",
            "year": 2019
        },
        {
            "authors": [
                "T. Plehn",
                "D. Rainwater",
                "P. Skands"
            ],
            "title": "Squark and gluino production with jets",
            "venue": "Phys. Lett. B 645, 217 ",
            "year": 2007
        },
        {
            "authors": [
                "R. Corke",
                "T. Sj\u00f6strand"
            ],
            "title": "Improved parton showers at large transverse momenta",
            "venue": "Eur. Phys. J. C 69, 1 ",
            "year": 2010
        },
        {
            "authors": [
                "R.K. Ellis",
                "G. Marchesini",
                "B.R. Webber"
            ],
            "title": "Soft radiation in parton-parton scattering",
            "venue": "Nucl. Phys. B 286, 643 ",
            "year": 1016
        },
        {
            "authors": [
                "B. Andersson",
                "G. Gustafson",
                "T. Sj\u00f6strand"
            ],
            "title": "How to find the gluon jets in e+e\u2212 annihilation",
            "venue": "Phys. Lett. B 94, 211 ",
            "year": 2693
        },
        {
            "authors": [
                "Y.I. Azimov",
                "Y.L. Dokshitzer",
                "V.A. Khoze",
                "S.I. Troyan"
            ],
            "title": "The string effect and QCD coherence",
            "venue": "Phys. Lett. B 165, 147 ",
            "year": 2693
        },
        {
            "authors": [
                "B.R. Webber"
            ],
            "title": "Monte Carlo simulation of hard hadronic processes",
            "venue": "Annu. Rev. Nucl. Part. Sci. 36, 253 ",
            "year": 1986
        },
        {
            "authors": [
                "P. Ernstr\u00f6m",
                "L. L\u00f6nnblad"
            ],
            "title": "Generating heavy quarkonia in a perturbative QCD cascade",
            "venue": "Z. Phys. C 75, 51 ",
            "year": 1997
        },
        {
            "authors": [
                "L. Hartgring",
                "E. Laenen",
                "P. Skands"
            ],
            "title": "Antenna showers with one-loop matrix elements",
            "venue": "J. High Energy Phys. 10, 127 (2013), doi:10.1007/JHEP10",
            "year": 2013
        },
        {
            "authors": [
                "J.J. Lopez-Villarejo",
                "P. Skands"
            ],
            "title": "Efficient matrix-element matching with sector showers",
            "venue": "J. High Energy Phys. 11, 150 (2011), doi:10.1007/JHEP11",
            "year": 2011
        },
        {
            "authors": [
                "S. H\u00f6che",
                "S. Schumann",
                "F. Siegert"
            ],
            "title": "Hard photon production and matrix-element parton-shower merging",
            "venue": "Phys. Rev. D 81, 034026 ",
            "year": 2010
        },
        {
            "authors": [
                "M. Ritzmann",
                "D.A. Kosower",
                "P. Skands"
            ],
            "title": "Antenna showers with hadronic initial states",
            "venue": "Phys. Lett. B 718, 1345 (2013), doi:10.1016/j.physletb.2012.12.003. 266 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "H. Brooks",
                "C.T. Preuss",
                "P. Skands"
            ],
            "title": "Sector showers for hadron collisions",
            "venue": "J. High Energy Phys. 07, 032 (2020), doi:10.1007/JHEP07",
            "year": 2020
        },
        {
            "authors": [
                "R. Kleiss",
                "R. Verheyen"
            ],
            "title": "Final-state QED multipole radiation in antenna parton showers",
            "venue": "J. High Energy Phys. 11, 182 (2017), doi:10.1007/JHEP11",
            "year": 2017
        },
        {
            "authors": [
                "P. Skands",
                "R. Verheyen"
            ],
            "title": "Multipole photon radiation in the Vincia parton shower",
            "venue": "Phys. Lett. B 811, 135878 ",
            "year": 2020
        },
        {
            "authors": [
                "D.R. Yennie",
                "S.C. Frautschi",
                "H. Suura"
            ],
            "title": "The infrared divergence phenomena and highenergy processes",
            "venue": "Ann. Phys. 13, 379 ",
            "year": 1016
        },
        {
            "authors": [
                "A. Gehrmann-De Ridder",
                "M. Ritzmann",
                "P. Skands"
            ],
            "title": "Timelike dipoleantenna showers with massive fermions",
            "venue": "Phys. Rev. D 85, 014013 ",
            "year": 2012
        },
        {
            "authors": [
                "R. Kleiss",
                "R. Verheyen"
            ],
            "title": "Collinear electroweak radiation in antenna parton showers",
            "venue": "Eur. Phys. J. C 80, 980 ",
            "year": 2020
        },
        {
            "authors": [
                "A.J. Larkoski",
                "J.J. Lopez-Villarejo",
                "P. Skands"
            ],
            "title": "Helicity-dependent showers and matching with VINCIA",
            "venue": "Phys. Rev. D 87, 054033 ",
            "year": 2013
        },
        {
            "authors": [
                "N. Fischer",
                "A. Lifson",
                "P. Skands"
            ],
            "title": "Helicity antenna showers for hadron colliders",
            "venue": "Eur. Phys. J. C 77, 719 ",
            "year": 2017
        },
        {
            "authors": [
                "D.A. Kosower"
            ],
            "title": "Antenna factorization of gauge-theory amplitudes",
            "venue": "Phys. Rev. D 57, 5410 ",
            "year": 1998
        },
        {
            "authors": [
                "W.T. Giele",
                "D.A. Kosower",
                "P.Z. Skands"
            ],
            "title": "A simple shower and matching algorithm",
            "venue": "Phys. Rev. D 78, 014026 ",
            "year": 2008
        },
        {
            "authors": [
                "S. Catani",
                "M.H. Seymour"
            ],
            "title": "The dipole formalism for the calculation of QCD jet cross sections at next-to-leading order",
            "venue": "Phys. Lett. B 378, 287 ",
            "year": 2693
        },
        {
            "authors": [
                "S. Catani",
                "S. Dittmaier",
                "M.H. Seymour",
                "Z. Tr\u00f3cs\u00e1nyi"
            ],
            "title": "The dipole formalism for nextto-leading order QCD calculations with massive partons",
            "venue": "Nucl. Phys. B 627, 189 ",
            "year": 1016
        },
        {
            "authors": [
                "N. Fischer",
                "S. Prestel",
                "M. Ritzmann",
                "P. Skands"
            ],
            "title": "VINCIA for hadron colliders",
            "venue": "Eur. Phys. J. C 76, 589 ",
            "year": 2016
        },
        {
            "authors": [
                "R.J. Verheyen"
            ],
            "title": "Electroweak effects in antenna parton showers",
            "venue": "PhD thesis ",
            "year": 2020
        },
        {
            "authors": [
                "S. Schumann",
                "F. Krauss"
            ],
            "title": "A parton shower algorithm based on Catani-Seymour dipole factorisation",
            "venue": "J. High Energy Phys. 03, 038 ",
            "year": 2008
        },
        {
            "authors": [
                "M. Dinsdale",
                "M. Ternick",
                "S. Weinzierl"
            ],
            "title": "Parton showers from the dipole formalism",
            "venue": "Phys. Rev. D 76, 094003 ",
            "year": 2007
        },
        {
            "authors": [
                "S. Pl\u00e4tzer",
                "S. Gieseke"
            ],
            "title": "Coherent parton showers with local recoils",
            "venue": "J. High Energy Phys. 01, 024 (2011), doi:10.1007/JHEP01",
            "year": 2011
        },
        {
            "authors": [
                "S. H\u00f6che",
                "S. Prestel"
            ],
            "title": "The midpoint between dipole and parton showers",
            "venue": "Eur. Phys. J. C 75, 461 (2015), doi:10.1140/epjc/s10052-015-3684-2. 267 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "A. Daleo",
                "T. Gehrmann",
                "D. Ma\u00eetre"
            ],
            "title": "Antenna subtraction with hadronic initial states",
            "venue": "J. High Energy Phys. 04, 016 ",
            "year": 2007
        },
        {
            "authors": [
                "D.A. Kosower"
            ],
            "title": "Antenna factorization in strongly ordered limits",
            "venue": "Phys. Rev. D 71, 045016 ",
            "year": 2005
        },
        {
            "authors": [
                "A.J. Larkoski",
                "M.E. Peskin"
            ],
            "title": "Spin-dependent antenna splitting functions",
            "venue": "Phys. Rev. D 81, 054010 ",
            "year": 2010
        },
        {
            "authors": [
                "A.J. Larkoski",
                "M.E. Peskin"
            ],
            "title": "Antenna splitting functions for massive particles",
            "venue": "Phys. Rev. D 84, 034034 ",
            "year": 2011
        },
        {
            "authors": [
                "J.M. Campbell",
                "M.A. Cullen",
                "E.W.N. Glover"
            ],
            "title": "Four jet event shapes in electron-positron annihilation",
            "venue": "Eur. Phys. J. C 9, 245 ",
            "year": 1999
        },
        {
            "authors": [
                "A. Gehrmann-De Ridder",
                "T. Gehrmann",
                "E.W.N. Glover"
            ],
            "title": "Infrared structure of e+e\u2212 \u2192 2 jets at NNLO",
            "venue": "Nucl. Phys. B 691, 195 ",
            "year": 2004
        },
        {
            "authors": [
                "A. Gehrmann-De Ridder",
                "T. Gehrmann",
                "E.W.N. Glover"
            ],
            "title": "Quark-gluon antenna functions from neutralino decay",
            "venue": "Phys. Lett. B 612, 36 ",
            "year": 2005
        },
        {
            "authors": [
                "A. Gehrmann-De Ridder",
                "T. Gehrmann",
                "E.W.N. Glover"
            ],
            "title": "Gluon-gluon antenna functions from Higgs boson decay",
            "venue": "Phys. Lett. B 612, 49 ",
            "year": 2005
        },
        {
            "authors": [
                "A. Gehrmann-De Ridder",
                "T. Gehrmann",
                "E.W.N. Glover"
            ],
            "title": "Antenna subtraction at NNLO",
            "venue": "J. High Energy Phys. 09, 056 ",
            "year": 2005
        },
        {
            "authors": [
                "H.W. Kuhn"
            ],
            "title": "The Hungarian method for the assignment problem",
            "venue": "Springer, Berlin, Heidelberg, ISBN 9783540682790 ",
            "year": 2009
        },
        {
            "authors": [
                "J. Munkres"
            ],
            "title": "Algorithms for the assignment and transportation problems",
            "venue": "J. Soc. Ind. Appl. Math. 5, 32 ",
            "year": 1957
        },
        {
            "authors": [
                "R. Jonker",
                "A. Volgenant"
            ],
            "title": "A shortest augmenting path algorithm for dense and sparse linear assignment problems",
            "venue": "Computing 38, 325 ",
            "year": 1987
        },
        {
            "authors": [
                "J. Chen",
                "T. Han",
                "B. Tweedie"
            ],
            "title": "Electroweak splitting functions and high energy showering",
            "venue": "J. High Energy Phys. 11, 093 (2017), doi:10.1007/JHEP11",
            "year": 2017
        },
        {
            "authors": [
                "S. Catani"
            ],
            "title": "Yu",
            "venue": "L. Dokshitzer, M. H. Seymour and B. R. Webber, Longitudinally-invariant Kt -clustering algorithms for hadron-hadron collisions, Nucl. Phys. B 406, 187 ",
            "year": 1016
        },
        {
            "authors": [
                "S. H\u00f6che",
                "S. Prestel"
            ],
            "title": "Triple collinear emissions in parton showers",
            "venue": "Phys. Rev. D 96, 074017 ",
            "year": 2017
        },
        {
            "authors": [
                "S. H\u00f6che",
                "F. Krauss",
                "S. Prestel"
            ],
            "title": "Implementing NLO DGLAP evolution in parton showers",
            "venue": "J. High Energy Phys. 10, 093 (2017), doi:10.1007/JHEP10",
            "year": 2017
        },
        {
            "authors": [
                "F. Dulat",
                "S. H\u00f6che",
                "S. Prestel"
            ],
            "title": "Leading-color fully differential two-loop soft corrections to QCD dipole showers",
            "venue": "Phys. Rev. D 98, 074013 (2018), doi:10.1103/PhysRevD.98.074013. 268 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "S. Prestel",
                "M. Spannowsky"
            ],
            "title": "HYTREES: Combining matrix elements and parton shower for hypothesis testing",
            "venue": "Eur. Phys. J. C 79, 546 ",
            "year": 2019
        },
        {
            "authors": [
                "J.R. Andersen",
                "C. G\u00fctschow",
                "A. Maier",
                "S. Prestel"
            ],
            "title": "A positive resampler for Monte Carlo events with negative weights",
            "venue": "Eur. Phys. J. C 80, 1007 ",
            "year": 2020
        },
        {
            "authors": [
                "L. Gellersen",
                "S. Prestel",
                "M. Spannowsky"
            ],
            "title": "Coloring mixed QCD/QED evolution",
            "venue": "SciPost Phys. 13, 034 ",
            "year": 2022
        },
        {
            "authors": [
                "S. Dittmaier"
            ],
            "title": "A general approach to photon radiation off fermions",
            "venue": "Nucl. Phys. B 565, 69 ",
            "year": 1016
        },
        {
            "authors": [
                "L. Gellersen",
                "S. H\u00f6che",
                "S. Prestel"
            ],
            "title": "Disentangling soft and collinear effects in QCD parton showers",
            "venue": "Phys. Rev. D 105, 114012 ",
            "year": 2022
        },
        {
            "authors": [
                "M. Sch\u00f6nherr"
            ],
            "title": "An automated subtraction of NLO EW infrared divergences",
            "venue": "Eur. Phys. J. C 78, 119 ",
            "year": 2018
        },
        {
            "authors": [
                "F. Krauss",
                "P. Petrov",
                "M. Sch\u00f6nherr",
                "M. Spannowsky"
            ],
            "title": "Measuring collinear W emissions inside jets",
            "venue": "Phys. Rev. D 89, 114006 ",
            "year": 2014
        },
        {
            "authors": [
                "M. Rubin",
                "G.P. Salam",
                "S. Sapeta"
            ],
            "title": "Giant QCD K-factors beyond NLO",
            "venue": "J. High Energy Phys. 09, 084 (2010), doi:10.1007/JHEP09",
            "year": 2010
        },
        {
            "authors": [
                "A. Sch\u00e4licke",
                "F. Krauss"
            ],
            "title": "Implementing the ME+PS merging algorithm",
            "venue": "J. High Energy Phys. 07, 018 ",
            "year": 2005
        },
        {
            "authors": [
                "J.R. Christiansen",
                "S. Prestel"
            ],
            "title": "Merging weak and QCD showers with matrix elements",
            "venue": "Eur. Phys. J. C 76, 39 ",
            "year": 2016
        },
        {
            "authors": [
                "M.H. Seymour"
            ],
            "title": "Matrix-element corrections to parton shower algorithms",
            "venue": "Comput. Phys. Commun. 90, 95 ",
            "year": 1016
        },
        {
            "authors": [
                "M.H. Seymour"
            ],
            "title": "A simple prescription for first-order corrections to quark scattering and annihilation processes",
            "venue": "Nucl. Phys. B 436, 443 ",
            "year": 1016
        },
        {
            "authors": [
                "J. Andr\u00e9",
                "T. Sj\u00f6strand"
            ],
            "title": "Matching of matrix elements and parton showers",
            "venue": "Phys. Rev. D 57, 5767 ",
            "year": 1998
        },
        {
            "authors": [
                "N. Fischer",
                "S. Prestel"
            ],
            "title": "Combining states without scale hierarchies with ordered parton showers",
            "venue": "Eur. Phys. J. C 77, 601 ",
            "year": 2017
        },
        {
            "authors": [
                "S. Frixione",
                "B.R. Webber"
            ],
            "title": "Matching NLO QCD computations and parton shower simulations",
            "venue": "J. High Energy Phys. 06, 029 ",
            "year": 2002
        },
        {
            "authors": [
                "P. Nason"
            ],
            "title": "A new method for combining NLO QCD with shower Monte Carlo algorithms",
            "venue": "J. High Energy Phys. 11, 040 ",
            "year": 2004
        },
        {
            "authors": [
                "S. Frixione",
                "P. Nason",
                "C. Oleari"
            ],
            "title": "Matching NLO QCD computations with parton shower simulations: The POWHEG method",
            "venue": "J. High Energy Phys. 11, 070 ",
            "year": 2007
        },
        {
            "authors": [
                "S. H\u00f6che",
                "F. Krauss",
                "M. Sch\u00f6nherr",
                "F. Siegert"
            ],
            "title": "Automating the Powheg method in Sherpa",
            "venue": "J. High Energy Phys. 04, 024 (2011), doi:10.1007/JHEP04(2011)024. 269 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "J. Alwall"
            ],
            "title": "The automated computation of tree-level and next-to-leading order differential cross sections, and their matching to parton shower simulations",
            "venue": "J. High Energy Phys",
            "year": 2014
        },
        {
            "authors": [
                "S. H\u00f6che",
                "F. Krauss",
                "M. Sch\u00f6nherr",
                "F. Siegert"
            ],
            "title": "A critical appraisal of NLO+PS matching methods",
            "venue": "J. High Energy Phys. 09, 049 (2012), doi:10.1007/JHEP09",
            "year": 2012
        },
        {
            "authors": [
                "S. Alioli",
                "P. Nason",
                "C. Oleari",
                "E. Re"
            ],
            "title": "A general framework for implementing NLO calculations in shower Monte Carlo programs: The POWHEG BOX",
            "venue": "J. High Energy Phys. 06, 043 (2010), doi:10.1007/JHEP06",
            "year": 2010
        },
        {
            "authors": [
                "M.L. Mangano",
                "M. Moretti",
                "R. Pittau"
            ],
            "title": "Multijet matrix elements and shower evolution in hadronic collisions: W bb\u0304 + n jets as a case study",
            "venue": "Nucl. Phys. B 632, 343 ",
            "year": 1016
        },
        {
            "authors": [
                "M.L. Mangano",
                "M. Moretti",
                "F. Piccinini",
                "M. Treccani"
            ],
            "title": "Matching matrix elements and shower evolution for top-pair production in hadronic collisions",
            "venue": "J. High Energy Phys. 01, 013 ",
            "year": 2007
        },
        {
            "authors": [
                "S. Catani",
                "F. Krauss",
                "B.R. Webber",
                "R. Kuhn"
            ],
            "title": "QCD matrix elements + parton showers",
            "venue": "J. High Energy Phys. 11, 063 ",
            "year": 2001
        },
        {
            "authors": [
                "K. Hamilton",
                "P. Richardson",
                "J. Tully"
            ],
            "title": "A modified CKKW matrix element merging approach to angular-ordered parton showers",
            "venue": "J. High Energy Phys. 11, 038 ",
            "year": 2009
        },
        {
            "authors": [
                "L. L\u00f6nnblad"
            ],
            "title": "Correcting the colour-dipole cascade model with fixed order matrix elements",
            "venue": "J. High Energy Phys. 05, 046 ",
            "year": 2002
        },
        {
            "authors": [
                "L. L\u00f6nnblad",
                "S. Prestel"
            ],
            "title": "Matching tree-level matrix elements with interleaved showers",
            "venue": "J. High Energy Phys. 03, 019 (2012), doi:10.1007/JHEP03",
            "year": 2012
        },
        {
            "authors": [
                "H. Brooks",
                "C.T. Preuss"
            ],
            "title": "Efficient multi-jet merging with the Vincia sector shower",
            "venue": "Comput. Phys. Commun. 264, 107985 ",
            "year": 2021
        },
        {
            "authors": [
                "S. H\u00f6che",
                "F. Krauss",
                "S. Schumann",
                "F. Siegert"
            ],
            "title": "QCD matrix elements and truncated showers",
            "venue": "J. High Energy Phys. 05, 053 ",
            "year": 2009
        },
        {
            "authors": [
                "L. L\u00f6nnblad",
                "S. Prestel"
            ],
            "title": "Unitarising matrix element + parton shower merging",
            "venue": "J. High Energy Phys. 02, 094 (2013), doi:10.1007/JHEP02",
            "year": 2013
        },
        {
            "authors": [
                "S. Pl\u00e4tzer"
            ],
            "title": "Controlling inclusive cross sections in parton shower +matrix element merging",
            "venue": "J. High Energy Phys. 08, 114 (2013), doi:10.1007/JHEP08",
            "year": 2013
        },
        {
            "authors": [
                "N. Lavesson",
                "L. L\u00f6nnblad"
            ],
            "title": "Extending CKKW-merging to one-loop matrix elements",
            "venue": "J. High Energy Phys. 12, 070 ",
            "year": 2008
        },
        {
            "authors": [
                "L. L\u00f6nnblad",
                "S. Prestel"
            ],
            "title": "Merging multi-leg NLO matrix elements with parton showers",
            "venue": "J. High Energy Phys. 03, 166 (2013), doi:10.1007/JHEP03",
            "year": 2013
        },
        {
            "authors": [
                "J. Bellm",
                "S. Gieseke",
                "S. Pl\u00e4tzer"
            ],
            "title": "Merging NLO multi-jet calculations with improved unitarization",
            "venue": "Eur. Phys. J. C 78, 244 ",
            "year": 2018
        },
        {
            "authors": [
                "K. Hamilton",
                "P. Nason"
            ],
            "title": "Improving NLO-parton shower matched simulations with higher order matrix elements",
            "venue": "J. High Energy Phys. 06, 039 (2010), doi:10.1007/JHEP06(2010)039. 270 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "S. H\u00f6che",
                "F. Krauss",
                "M. Sch\u00f6nherr",
                "F. Siegert"
            ],
            "title": "NLO matrix elements and truncated showers",
            "venue": "J. High Energy Phys. 08, 123 (2011), doi:10.1007/JHEP08",
            "year": 2011
        },
        {
            "authors": [
                "T. Gehrmann",
                "S. H\u00f6che",
                "F. Krauss",
                "M. Sch\u00f6nherr",
                "F. Siegert"
            ],
            "title": "NLO QCD matrix elements + parton showers in e+e\u2212 \u2192 hadrons",
            "venue": "J. High Energy Phys. 01, 144 (2013), doi:10.1007/JHEP01",
            "year": 2013
        },
        {
            "authors": [
                "S. H\u00f6che",
                "F. Krauss",
                "M. Sch\u00f6nherr",
                "F. Siegert"
            ],
            "title": "QCD matrix elements+ parton showers",
            "venue": "The NLO case, J. High Energy Phys. 04, 027 (2013), doi:10.1007/JHEP04",
            "year": 2013
        },
        {
            "authors": [
                "R. Frederix",
                "S. Frixione"
            ],
            "title": "Merging meets matching in MC@NLO",
            "venue": "J. High Energy Phys. 12, 061 (2012), doi:10.1007/JHEP12",
            "year": 2012
        },
        {
            "authors": [
                "K. Hamilton",
                "P. Nason",
                "G. Zanderighi"
            ],
            "title": "MINLO: Multi-scale improved NLO",
            "venue": "J. High Energy Phys. 10, 155 (2012), doi:10.1007/JHEP10",
            "year": 2012
        },
        {
            "authors": [
                "R. Frederix",
                "K. Hamilton"
            ],
            "title": "Extending the Minlo method",
            "venue": "J. High Energy Phys. 05, 042 (2016), doi:10.1007/JHEP05",
            "year": 2016
        },
        {
            "authors": [
                "M. Mangano"
            ],
            "title": "Exploring theoretical systematics in the ME-to-shower MC merging for multijet process",
            "venue": "E-proceedings of matrix element/Monte Carlo tuning working group, Fermilab ",
            "year": 2002
        },
        {
            "authors": [
                "R. Frederix",
                "S. Frixione",
                "S. Prestel",
                "P. Torrielli"
            ],
            "title": "On the reduction of negative weights in MC@NLO-type matching procedures",
            "venue": "J. High Energy Phys. 07, 238 (2020), doi:10.1007/JHEP07",
            "year": 2020
        },
        {
            "authors": [
                "T. Je\u017eo",
                "P. Nason"
            ],
            "title": "On the treatment of resonances in next-to-leading order calculations matched to a parton shower",
            "venue": "J. High Energy Phys. 12, 001 (2015), doi:10.1007/JHEP12",
            "year": 2015
        },
        {
            "authors": [
                "S.F. Ravasio",
                "T. Je\u017eo",
                "P. Nason",
                "C. Oleari"
            ],
            "title": "Addendum to: A theoretical study of topmass measurements at the LHC using NLO+PS generators of increasing accuracy",
            "venue": "Eur. Phys. J. C 79, 859 ",
            "year": 2019
        },
        {
            "authors": [
                "S. Alioli",
                "C.W. Bauer",
                "C. Berggren",
                "A. Hornig",
                "F.J. Tackmann",
                "C.K. Vermilion",
                "J.R. Walsh",
                "S. Zuberi"
            ],
            "title": "Combining higher-order resummation with multiple NLO calculations and parton showers in GENEVA",
            "venue": "J. High Energy Phys. 09, 120 (2013), doi:10.1007/JHEP09",
            "year": 2013
        },
        {
            "authors": [
                "S. Alioli",
                "C.W. Bauer",
                "C. Berggren",
                "F.J. Tackmann",
                "J.R. Walsh",
                "S. Zuberi"
            ],
            "title": "Matching fully differential NNLO calculations and parton showers",
            "venue": "J. High Energy Phys. 06, 089 (2014), doi:10.1007/JHEP06",
            "year": 2014
        },
        {
            "authors": [
                "S. Alioli",
                "C.W. Bauer",
                "C. Berggren",
                "F.J. Tackmann",
                "J.R. Walsh"
            ],
            "title": "Drell-Yan production at NNLL\u2019+NNLO matched to parton showers",
            "venue": "Phys. Rev. D 92, 094020 ",
            "year": 2015
        },
        {
            "authors": [
                "S. Alioli",
                "C.W. Bauer",
                "S. Guns",
                "F.J. Tackmann"
            ],
            "title": "Underlying-event sensitive observables in Drell-Yan production using GENEVA",
            "venue": "Eur. Phys. J. C 76, 614 ",
            "year": 2016
        },
        {
            "authors": [
                "S. H\u00f6che",
                "S. Kuttimalai",
                "Y. Li"
            ],
            "title": "Hadronic final states in DIS at NNLO QCD with parton showers",
            "venue": "Phys. Rev. D 98, 114013 (2018), doi:10.1103/PhysRevD.98.114013. 271 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "L. Gellersen",
                "S. Prestel"
            ],
            "title": "Scale and scheme variations in unitarized NLO merging",
            "venue": "Phys. Rev. D 101, 114007 ",
            "year": 2020
        },
        {
            "authors": [
                "H.T. Li",
                "P. Skands"
            ],
            "title": "A framework for second-order parton showers",
            "venue": "Phys. Lett. B 771, 59 ",
            "year": 2017
        },
        {
            "authors": [
                "J.J. Lopez-Villarejo",
                "P. Skands"
            ],
            "title": "Efficient matrix-element matching with sector showers",
            "venue": "J. High Energy Phys. 11, 150 (2011), doi:10.1007/JHEP11",
            "year": 2011
        },
        {
            "authors": [
                "S. H\u00f6che",
                "S. Mrenna",
                "S. Payne",
                "C.T. Preuss",
                "P. Skands"
            ],
            "title": "A study of QCD radiation in VBF Higgs production with Vincia and Pythia",
            "venue": "SciPost Phys. 12, 010 ",
            "year": 2022
        },
        {
            "authors": [
                "S. Prestel"
            ],
            "title": "Matching N3LO QCD calculations to parton showers",
            "venue": "J. High Energy Phys. 11, 041 (2021), doi:10.1007/JHEP11",
            "year": 2021
        },
        {
            "authors": [
                "V.N. Gribov"
            ],
            "title": "A Reggeon diagram technique",
            "venue": "Zh. Eksp. Teor. Fiz. 53, 654 ",
            "year": 1967
        },
        {
            "authors": [
                "P.D.B. Collins"
            ],
            "title": "An introduction to Regge theory and High energy physics",
            "venue": "Cambridge University Press, Cambridge, UK, ISBN 9780521212458 ",
            "year": 1977
        },
        {
            "authors": [
                "J.R. Forshaw",
                "D.A. Ross"
            ],
            "title": "Quantum chromodynamics and the pomeron",
            "venue": "Cambridge University Press, Cambridge, UK, ISBN 9780511524387 ",
            "year": 2011
        },
        {
            "authors": [
                "S. Donnachie",
                "H.G. Dosch",
                "O. Nachtmann",
                "P. Landshoff"
            ],
            "title": "Pomeron physics and QCD",
            "venue": "Cambridge University Press, Cambridge, UK, ISBN 9780511534935 ",
            "year": 2002
        },
        {
            "authors": [
                "V. Barone",
                "E. Predazzi"
            ],
            "title": "High-energy particle diffraction",
            "venue": "Springer, Berlin, Heidelberg, ISBN 9783662047248 ",
            "year": 2002
        },
        {
            "authors": [
                "G. Antchev"
            ],
            "title": "First determination of the \u03c1 parameter at p s = 13 TeV: Probing the existence of a colourless C-odd three-gluon compound state, Eur",
            "venue": "Phys. J. C",
            "year": 2019
        },
        {
            "authors": [
                "M. Froissart"
            ],
            "title": "Asymptotic behavior and subtractions in the Mandelstam representation",
            "venue": "Phys. Rev. 123, 1053 ",
            "year": 1961
        },
        {
            "authors": [
                "G.A. Schuler",
                "T. Sj\u00f6strand"
            ],
            "title": "Hadronic diffractive cross sections and the rise of the total cross section",
            "venue": "Phys. Rev. D 49, 2257 ",
            "year": 1994
        },
        {
            "authors": [
                "C.O. Rasmussen",
                "T. Sj\u00f6strand"
            ],
            "title": "Models for total",
            "venue": "elastic and diffractive cross sections, Eur. Phys. J. C 78, 461 ",
            "year": 2018
        },
        {
            "authors": [
                "A. Donnachie",
                "P.V. Landshoff"
            ],
            "title": "Total cross sections",
            "venue": "Phys. Lett. B 296, 227 ",
            "year": 2693
        },
        {
            "authors": [
                "R. Ciesielski"
            ],
            "title": "MBR Monte Carlo simulation in PYTHIA8",
            "venue": "Proc. Sci. ICHEP2012, 301 (2013), doi:10.22323/1.174.0301. 272 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "R.B. Appleby",
                "R.J. Barlow",
                "J.G. Molson",
                "M. Serluca",
                "A. Toader"
            ],
            "title": "The practical Pomeron for high energy proton collimation",
            "venue": "Eur. Phys. J. C 76, 520 ",
            "year": 2016
        },
        {
            "authors": [
                "K.A. Olive"
            ],
            "title": "Review of particle physics",
            "venue": "Chin. Phys. C 40, 100001 ",
            "year": 2016
        },
        {
            "authors": [
                "A. Donnachie",
                "P.V. Landshoff"
            ],
            "title": "Dynamics of elastic scattering",
            "venue": "Nucl. Phys. B 267, 690 ",
            "year": 1016
        },
        {
            "authors": [
                "P. Aurenche",
                "F.W. Bopp",
                "A. Capella",
                "J. Kwiecinski",
                "M. Maire",
                "J. Ranft",
                "J.T.T. Van"
            ],
            "title": "Multiparticle production in a two-component dual parton model",
            "venue": "Phys. Rev. D 45, 92 ",
            "year": 1992
        },
        {
            "authors": [
                "M.L. Good",
                "W.D. Walker"
            ],
            "title": "Diffraction dissociation of beam particles",
            "venue": "Phys. Rev. 120, 1857 ",
            "year": 1960
        },
        {
            "authors": [
                "G.A. Schuler",
                "T. Sj\u00f6strand"
            ],
            "title": "A scenario for high-energy \u03b3\u03b3 interactions",
            "venue": "Z. Phys. C 73, 677 ",
            "year": 1997
        },
        {
            "authors": [
                "E.M. Levin",
                "L.L. Frankfurt"
            ],
            "title": "The quark hypothesis and relations between cross-sections at high-energies",
            "venue": "J. Exp. Theor. Phys. Lett. 2, 65 ",
            "year": 1965
        },
        {
            "authors": [
                "H.J. Lipkin"
            ],
            "title": "Quarks for pedestrians",
            "venue": "Phys. Rep. 8, 173 ",
            "year": 1573
        },
        {
            "authors": [
                "S. Okubo"
            ],
            "title": "\u03c6-meson and unitary symmetry model",
            "venue": "Phys. Lett. 5, 165 ",
            "year": 1016
        },
        {
            "authors": [
                "G. Zweig"
            ],
            "title": "An SU3 model for strong interaction symmetry and its breaking",
            "venue": "Version 1, CERN-TH-401 ",
            "year": 1964
        },
        {
            "authors": [
                "J. Iizuka"
            ],
            "title": "A systematics and phenomenology of meson family",
            "venue": "Prog. Theor. Phys. Suppl. 37, 21 ",
            "year": 1966
        },
        {
            "authors": [
                "T. Sj\u00f6strand",
                "M. Utheim"
            ],
            "title": "A framework for hadronic rescattering in pp collisions",
            "venue": "Eur. Phys. J. C 80, 907 ",
            "year": 2020
        },
        {
            "authors": [
                "S. Bass"
            ],
            "title": "Microscopic models for ultrarelativistic heavy ion collisions",
            "venue": "Prog. Part. Nucl. Phys. 41, 255 ",
            "year": 1016
        },
        {
            "authors": [
                "R. Garc\u00eda-Mart\u00edn",
                "R. Kami\u0144ski",
                "J.R. Pel\u00e1ez"
            ],
            "title": "J",
            "venue": "R. de Elvira and F. J. Yndur\u00e1in, Pion-pion scattering amplitude. IV. Improved analysis with once subtracted Roy-like equations up to 1100 MeV, Phys. Rev. D 83, 074004 ",
            "year": 2011
        },
        {
            "authors": [
                "J.R. Pelaez"
            ],
            "title": "A",
            "venue": "Rodas and J. R. de Elvira, Global parameterization of \u03c0\u03c0 scattering up to 2 GeV, Eur. Phys. J. C 79, 1008 ",
            "year": 2019
        },
        {
            "authors": [
                "J.R. Pelaez",
                "A. Rodas"
            ],
            "title": "Pion-kaon scattering amplitude constrained with forward dispersion relations up to 1.6 GeV",
            "venue": "Phys. Rev. D",
            "year": 2016
        },
        {
            "authors": [
                "L. Montanet"
            ],
            "title": "Review of particle properties",
            "venue": "Phys. Rev. D 50,",
            "year": 1994
        },
        {
            "authors": [
                "P. Koch",
                "C.B. Dover"
            ],
            "title": "K\u00b1",
            "venue": "p\u0304 and \u03a9\u2212 production in relativistic heavy ion collisions, Phys. Rev. C 40, 145 ",
            "year": 1989
        },
        {
            "authors": [
                "P.V. Landshoff",
                "J.C. Polkinghorne"
            ],
            "title": "Calorimeter triggers for hard collisions",
            "venue": "Phys. Rev. D 18, 3344 ",
            "year": 1978
        },
        {
            "authors": [
                "C. Goebel",
                "D.M. Scott",
                "F. Halzen"
            ],
            "title": "Double Drell-Yan annihilations in hadron collisions: Novel tests of the constituent picture",
            "venue": "Phys. Rev. D 22, 2789 ",
            "year": 1980
        },
        {
            "authors": [
                "V.A. Abramovsky",
                "V.N. Gribov",
                "O.V. Kancheli"
            ],
            "title": "Character of inclusive spectra and fluctuations produced in inelastic processes by multi-pomeron exchange",
            "venue": "Yad. Fiz. 18, 595 ",
            "year": 1973
        },
        {
            "authors": [
                "T. Sj\u00f6strand"
            ],
            "title": "Multiple parton-parton interactions in hadronic events",
            "venue": "FERMILAB-Pub- 85/119-T ",
            "year": 1985
        },
        {
            "authors": [
                "P. Bartalini",
                "J.R. Gaunt"
            ],
            "title": "Multiple parton interactions at the LHC",
            "venue": "World Scientific, Singapore, ISBN 9789813227750 ",
            "year": 2017
        },
        {
            "authors": [
                "T. Sj\u00f6strand"
            ],
            "title": "The development of MPI modeling in Pythia",
            "venue": "World Scientific, Singapore, ISBN 9789813227767 ",
            "year": 2018
        },
        {
            "authors": [
                "L. McLerran",
                "R. Venugopalan"
            ],
            "title": "Computing quark and gluon distribution functions for very large nuclei",
            "venue": "Phys. Rev. D 49, 2233 ",
            "year": 1994
        },
        {
            "authors": [
                "F. Gelis",
                "E. Iancu",
                "J. Jalilian-Marian",
                "R. Venugopalan"
            ],
            "title": "The color glass condensate",
            "venue": "Annu. Rev. Nucl. Part. Sci. 60, 463 ",
            "year": 2010
        },
        {
            "authors": [
                "R.D. Ball",
                "V. Bertone",
                "S. Carrazza",
                "L. Del Debbio",
                "S. Forte",
                "A. Guffanti",
                "N.P. Hartland",
                "J. Rojo"
            ],
            "title": "Parton distributions with QED corrections",
            "venue": "Nucl. Phys. B 877, 290 ",
            "year": 2013
        },
        {
            "authors": [
                "L. Gribov"
            ],
            "title": "Semihard processes in QCD",
            "venue": "Phys. Rep. 100, 1 ",
            "year": 1573
        },
        {
            "authors": [
                "A.H. Mueller",
                "J. Qiu"
            ],
            "title": "Gluon recombination and shadowing at small values of x",
            "venue": "Nucl. Phys. B 268, 427 ",
            "year": 1016
        },
        {
            "authors": [
                "R.J. Glauber"
            ],
            "title": "High-energy collision theory",
            "venue": "Lectures in theoretical physics I, Interscience, New York, US, 315 ",
            "year": 1959
        },
        {
            "authors": [
                "T.T. Chou",
                "C.N. Yang"
            ],
            "title": "Model of elastic high-energy scattering",
            "venue": "Phys. Rev. 170, 1591 ",
            "year": 1968
        },
        {
            "authors": [
                "C. Bourrely",
                "J. Soffer",
                "T.T. Wu"
            ],
            "title": "Impact-picture expectations for very high-energy elastic pp and pp\u0304 scattering",
            "venue": "Nucl. Phys. B 247, 15 ",
            "year": 1016
        },
        {
            "authors": [
                "P. L\u2019Heureux",
                "B. Margolis",
                "P. Valin"
            ],
            "title": "Quark-gluon model for diffraction at high energies",
            "venue": "Phys. Rev. D",
            "year": 1985
        },
        {
            "authors": [
                "L. Frankfurt",
                "M. Strikman",
                "C. Weiss"
            ],
            "title": "Small-\u03c7 physics: From HERA to LHC and beyond",
            "venue": "Annu. Rev. Nucl. Part. Sci. 55, 403 (2005), doi:10.1146/annurev.nucl.53.041002.110615. 274 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "R. Corke",
                "T. Sj\u00f6strand"
            ],
            "title": "Multiparton interactions with an x-dependent proton size",
            "venue": "J. High Energy Phys. 05, 009 (2011), doi:10.1007/JHEP05",
            "year": 2011
        },
        {
            "authors": [
                "J.R. Gaunt",
                "W.J. Stirling"
            ],
            "title": "Double parton distributions incorporating perturbative QCD evolution and momentum and quark number sum rules",
            "venue": "J. High Energy Phys. 03, 005 (2010), doi:10.1007/JHEP03",
            "year": 2010
        },
        {
            "authors": [
                "K. Konishi",
                "A. Ukawa",
                "G. Veneziano"
            ],
            "title": "Jet calculus: A simple algorithm for resolving QCD jets",
            "venue": "Nucl. Phys. B 157, 45 ",
            "year": 1016
        },
        {
            "authors": [
                "R. Kirschner"
            ],
            "title": "Generalized Lipatov-Altarelli-Parisi equations and jet calculus rules",
            "venue": "Phys. Lett. B 84, 266 ",
            "year": 2693
        },
        {
            "authors": [
                "N. Paver",
                "D. Treleani"
            ],
            "title": "Multiquark scattering and large-pT jet production in hadronic collisions",
            "venue": "Nuov. Cim. A 70, 215 ",
            "year": 1982
        },
        {
            "authors": [
                "N. Paver",
                "D. Treleani"
            ],
            "title": "Multiple parton interactions and multijet events at collider and tevatron energies",
            "venue": "Phys. Lett. B 146, 252 ",
            "year": 2693
        },
        {
            "authors": [
                "N. Paver",
                "D. Treleani"
            ],
            "title": "Multiple parton processes in the TeV region",
            "venue": "Z. Phys. C 28, 187 ",
            "year": 1985
        },
        {
            "authors": [
                "R. Corke",
                "T. Sj\u00f6strand"
            ],
            "title": "Multiparton interactions and rescattering",
            "venue": "J. High Energy Phys. 01, 035 (2010), doi:10.1007/JHEP01",
            "year": 2010
        },
        {
            "authors": [
                "E. Avsar",
                "G. Gustafson",
                "L. L\u00f6nnblad"
            ],
            "title": "Small-x dipole evolution beyond the large-N(c) limit",
            "venue": "J. High Energy Phys. 01, 012 ",
            "year": 2007
        },
        {
            "authors": [
                "C. Bierlich",
                "G. Gustafson",
                "L. L\u00f6nnblad",
                "A. Tarasov"
            ],
            "title": "Effects of overlapping strings in pp collisions",
            "venue": "J. High Energy Phys. 03, 148 (2015), doi:10.1007/JHEP03",
            "year": 2015
        },
        {
            "authors": [
                "C. Bierlich",
                "C.O. Rasmussen"
            ],
            "title": "Dipole evolution: Perspectives for collectivity and \u03b3\u2217A collisions",
            "venue": "J. High Energy Phys. 10, 026 (2019), doi:10.1007/JHEP10",
            "year": 2019
        },
        {
            "authors": [
                "T. Sj\u00f6strand",
                "P. Skands"
            ],
            "title": "Multiple interactions and the structure of beam remnants",
            "venue": "J. High Energy Phys. 03, 053 ",
            "year": 2004
        },
        {
            "authors": [
                "J.R. Christiansen",
                "P.Z. Skands"
            ],
            "title": "String formation beyond leading colour",
            "venue": "J. High Energy Phys. 08, 003 (2015), doi:10.1007/JHEP08",
            "year": 2015
        },
        {
            "authors": [
                "G. Ingelman",
                "P.E. Schlein"
            ],
            "title": "Jet structure in high mass diffractive scattering",
            "venue": "Phys. Lett. B 152, 256 ",
            "year": 2693
        },
        {
            "authors": [
                "T. Affolder"
            ],
            "title": "Diffractive dijets with a leading antiproton in p\u0304p collisions at p s = 1800",
            "venue": "GeV, Phys. Rev. Lett",
            "year": 2000
        },
        {
            "authors": [
                "G. Aad"
            ],
            "title": "Dijet production in p s = 7 TeV pp collisions with large rapidity gaps at the ATLAS experiment",
            "venue": "Phys. Lett. B 754,",
            "year": 2016
        },
        {
            "authors": [
                "C.O. Rasmussen",
                "T. Sj\u00f6strand"
            ],
            "title": "Hard diffraction with dynamic gap survival",
            "venue": "J. High Energy Phys. 02, 142 (2016), doi:10.1007/JHEP02",
            "year": 2016
        },
        {
            "authors": [
                "CMS Collaboration"
            ],
            "title": "Measurement of dijet production with a leading proton in protonproton collisions at p s = 8 TeV",
            "venue": "(2018). 275 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "R. Kleiss"
            ],
            "title": "Monte Carlos for electroweak physics, in LEP",
            "venue": "Physics Workshop",
            "year": 1989
        },
        {
            "authors": [
                "D. Schulte"
            ],
            "title": "Beam-beam simulations with GUINEA-PIG",
            "year": 1999
        },
        {
            "authors": [
                "T. Ohl"
            ],
            "title": "CIRCE Version 1.02: Beam spectra for simulating linear collider physics, Comput",
            "venue": "Phys. Commun. 101,",
            "year": 1997
        },
        {
            "authors": [
                "R.P. Feynman"
            ],
            "title": "Very high-energy collisions of hadrons",
            "venue": "Phys. Rev. Lett. 23, 1415 ",
            "year": 1969
        },
        {
            "authors": [
                "J.D. Bjorken",
                "E.A. Paschos"
            ],
            "title": "Inelastic electron proton and gamma proton scattering",
            "venue": "and the structure of the nucleon, Phys. Rev. 185, 1975 ",
            "year": 1969
        },
        {
            "authors": [
                "J.C. Collins",
                "D.E. Soper",
                "G. Sterman"
            ],
            "title": "Transverse momentum distribution in Drell-Yan pair and W and Z boson production",
            "venue": "Nucl. Phys. B 250, 199 ",
            "year": 1016
        },
        {
            "authors": [
                "R. Angeles-Martinez"
            ],
            "title": "Transverse momentum dependent (TMD) parton distribution functions: Status and prospects",
            "venue": "Acta Phys. Pol. B",
            "year": 2015
        },
        {
            "authors": [
                "A. Kerbizi",
                "L. L\u00f6nnblad"
            ],
            "title": "StringSpinner - Adding spin to the PYTHIA string fragmentation",
            "venue": "Comput. Phys. Commun. 272, 108234 ",
            "year": 2022
        },
        {
            "authors": [
                "F. Cornet",
                "P. Jankowski",
                "M. Krawczyk",
                "A. Lorca"
            ],
            "title": "New 5-flavor LO analysis and parametrization of parton distributions in the real photon",
            "venue": "Phys. Rev. D 68, 014010 ",
            "year": 2003
        },
        {
            "authors": [
                "C.F. v"
            ],
            "title": "Weizs\u00e4cker, Ausstrahlung bei St\u00f6\u00dfen sehr schneller Elektronen",
            "venue": "Z. Phys. 88,",
            "year": 1934
        },
        {
            "authors": [
                "E.J. Williams"
            ],
            "title": "Nature of the high energy particles of penetrating radiation and status of ionization and radiation formulae",
            "venue": "Phys. Rev. 45, 729 ",
            "year": 1934
        },
        {
            "authors": [
                "G.A. Schuler",
                "T. Sj\u00f6strand"
            ],
            "title": "Parton distributions of the virtual photon",
            "venue": "Phys. Lett. B 376, 193 ",
            "year": 2693
        },
        {
            "authors": [
                "I. Helenius"
            ],
            "title": "Simulations of photo-nuclear dijets with PYTHIA 8 and their sensitivity to nuclear PDFs",
            "venue": "Proc. Sci. DIS2018, 113 ",
            "year": 2018
        },
        {
            "authors": [
                "S. Chekanov"
            ],
            "title": "Diffractive photoproduction of dijets in ep collisions at HERA",
            "venue": "Eur. Phys. J. C 55,",
            "year": 2008
        },
        {
            "authors": [
                "V. Andreev"
            ],
            "title": "Diffractive dijet production with a leading proton in ep collisions at HERA",
            "venue": "J. High Energy Phys",
            "year": 2015
        },
        {
            "authors": [
                "I. Helenius",
                "C.O. Rasmussen"
            ],
            "title": "Hard diffraction in photoproduction with Pythia 8",
            "venue": "Eur. Phys. J. C 79, 413 ",
            "year": 2019
        },
        {
            "authors": [
                "T.H. Bauer",
                "R.D. Spital",
                "D.R. Yennie",
                "F.M. Pipkin"
            ],
            "title": "The hadronic properties of the photon in high-energy interactions",
            "venue": "Rev. Mod. Phys. 50, 261 ",
            "year": 1978
        },
        {
            "authors": [
                "M. Derrick"
            ],
            "title": "Measurement of elastic \u03c10 photoproduction at HERA",
            "venue": "Z. Phys. C 69,",
            "year": 1995
        },
        {
            "authors": [
                "M. Derrick"
            ],
            "title": "Measurement of elastic \u03c9 photoproduction at HERA",
            "venue": "Z. Phys. C 73,",
            "year": 1996
        },
        {
            "authors": [
                "M. Derrick"
            ],
            "title": "Measurement of elastic \u03c6 photoproduction at HERA",
            "venue": "Phys. Lett. B 377,",
            "year": 1996
        },
        {
            "authors": [
                "J. Breitweg"
            ],
            "title": "Measurement of elastic J/\u03c8 photoproduction at HERA",
            "venue": "Z. Phys. C 75,",
            "year": 1997
        },
        {
            "authors": [
                "S. Chekanov"
            ],
            "title": "Exclusive photoproduction of J/\u03c8 mesons at HERA",
            "venue": "Eur. Phys. J. C 24,",
            "year": 2002
        },
        {
            "authors": [
                "A. Aktas"
            ],
            "title": "Elastic J/\u03c8 production at HERA",
            "venue": "Eur. Phys. J. C 46,",
            "year": 2006
        },
        {
            "authors": [
                "C. Alexa"
            ],
            "title": "Elastic and proton-dissociative photoproduction of J/\u03c8 mesons at HERA",
            "venue": "Eur. Phys. J. C",
            "year": 2013
        },
        {
            "authors": [
                "M. Drees",
                "D. Zeppenfeld"
            ],
            "title": "Production of supersymmetric particles in elastic ep collisions",
            "venue": "Phys. Rev. D 39, 2536 ",
            "year": 1989
        },
        {
            "authors": [
                "V.M. Budnev",
                "I.F. Ginzburg",
                "G.V. Meledin",
                "V.G. Serbo"
            ],
            "title": "The two-photon particle production mechanism",
            "venue": "Physical problems. Applications. Equivalent photon approximation, Phys. Rep. 15, 181 ",
            "year": 1573
        },
        {
            "authors": [
                "J.D. Jackson"
            ],
            "title": "Classical electrodynamics",
            "venue": "Wiley, Hoboken, New Jersey, US, ISBN 9780471309321 ",
            "year": 1998
        },
        {
            "authors": [
                "C. Bierlich",
                "G. Gustafson",
                "L. L\u00f6nnblad",
                "H. Shah"
            ],
            "title": "The Angantyr model for heavy-ion collisions in Pythia8",
            "venue": "J. High Energy Phys. 10, 134 (2018), doi:10.1007/JHEP10",
            "year": 2018
        },
        {
            "authors": [
                "B. Andersson",
                "G. Gustafson",
                "B. Nilsson-Almqvist"
            ],
            "title": "A model for low-pT hadronic reactions with generalizations to hadron-nucleus and nucleus-nucleus collisions",
            "venue": "Nucl. Phys. B 281, 289 ",
            "year": 1016
        },
        {
            "authors": [
                "A. Bia\u0142\u0142as",
                "M. Bleszy\u0144ski",
                "W. Czy\u017c"
            ],
            "title": "Multiplicity distributions in nucleus-nucleus collisions at high energies",
            "venue": "Nucl. Phys. B 111, 461 ",
            "year": 1016
        },
        {
            "authors": [
                "C. Bierlich",
                "G. Gustafson",
                "L. L\u00f6nnblad"
            ],
            "title": "Diffractive and non-diffractive wounded nucleons and final states in pA collisions",
            "venue": "J. High Energy Phys. 10, 139 (2016), doi:10.1007/JHEP10",
            "year": 2016
        },
        {
            "authors": [
                "W. Broniowski",
                "M. Rybczy\u0144ski",
                "P. Bo\u017cek"
            ],
            "title": "GLISSANDO: GLauber Initial- State Simulation AND mOre",
            "venue": ". . , Comput. Phys. Commun. 180, 69 ",
            "year": 2009
        },
        {
            "authors": [
                "M. Rybczy\u0144ski",
                "G. Stefanek",
                "W. Broniowski",
                "P. Bo\u017cek"
            ],
            "title": "GLISSANDO 2: GLauber Initial- State Simulation AND mOre",
            "venue": ". . , ver. 2, Comput. Phys. Commun. 185, 1759 ",
            "year": 2014
        },
        {
            "authors": [
                "B. Andersson",
                "G. Gustafson",
                "B. S\u00f6derberg"
            ],
            "title": "A general model for jet fragmentation",
            "venue": "Z. Phys. C 20, 317 ",
            "year": 1983
        },
        {
            "authors": [
                "T. Sj\u00f6strand"
            ],
            "title": "Jet fragmentation of multiparton configurations in a string framework",
            "venue": "Nucl. Phys. B 248, 469 (1984), doi:10.1016/0550-3213(84)90607-2. 277 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "B. Andersson",
                "G. Gustafson",
                "B. S\u00f6derberg"
            ],
            "title": "A probability measure on parton and string states",
            "venue": "Nucl. Phys. B 264, 29 ",
            "year": 1016
        },
        {
            "authors": [
                "M.G. Bowler"
            ],
            "title": "e+e\u2212 production of heavy quarks in the string model",
            "venue": "Z. Phys. C 11, 169 ",
            "year": 1981
        },
        {
            "authors": [
                "X. Artru",
                "G. Mennessier"
            ],
            "title": "String model and multiproduction",
            "venue": "Nucl. Phys. B 70, 93 ",
            "year": 1016
        },
        {
            "authors": [
                "D.A. Morris"
            ],
            "title": "Heavy-quark fragmentation functions in a simple string model",
            "venue": "Nucl. Phys. B 313, 634 ",
            "year": 1016
        },
        {
            "authors": [
                "B. Andersson",
                "G. Gustafson",
                "G. Ingelman",
                "T. Sj\u00f6strand"
            ],
            "title": "Parton fragmentation and string dynamics",
            "venue": "Phys. Rep. 97, 31 ",
            "year": 1573
        },
        {
            "authors": [
                "C. Bierlich",
                "S. Chakraborty",
                "G. Gustafson",
                "L. L\u00f6nnblad"
            ],
            "title": "Hyperfine splitting effects in string hadronization",
            "venue": "Eur. Phys. J. C 82, 228 ",
            "year": 2022
        },
        {
            "authors": [
                "B. Andersson",
                "G. Gustafson",
                "T. Sj\u00f6strand"
            ],
            "title": "A model for baryon production in quark and gluon jets",
            "venue": "Nucl. Phys. B 197, 45 ",
            "year": 1016
        },
        {
            "authors": [
                "A. Casher",
                "H. Neuberger",
                "S. Nussinov"
            ],
            "title": "Chromoelectric-flux-tube model of particle production",
            "venue": "Phys. Rev. D 20, 179 ",
            "year": 1979
        },
        {
            "authors": [
                "B. Andersson",
                "G. Gustafson",
                "T. Sj\u00f6strand"
            ],
            "title": "Baryon production in jet fragmentation and \u03a5 -decay",
            "venue": "Phys. Scr. 32, 574 ",
            "year": 1985
        },
        {
            "authors": [
                "T. Sj\u00f6strand"
            ],
            "title": "The merging of jets",
            "venue": "Phys. Lett. B 142, 420 ",
            "year": 2693
        },
        {
            "authors": [
                "S. Ferreres-Sol\u00e9",
                "T. Sj\u00f6strand"
            ],
            "title": "The space-time structure of hadronization in the Lund model",
            "venue": "Eur. Phys. J. C 78, 983 ",
            "year": 2018
        },
        {
            "authors": [
                "T. Sj\u00f6strand",
                "P.Z. Skands"
            ],
            "title": "Baryon number violation and string topologies",
            "venue": "Nucl. Phys. B 659, 243 ",
            "year": 1016
        },
        {
            "authors": [
                "E. Norrbin",
                "T. Sj\u00f6strand"
            ],
            "title": "Production mechanisms of charm hadrons in the string model",
            "venue": "Phys. Lett. B 442, 407 ",
            "year": 2693
        },
        {
            "authors": [
                "J. Alwall"
            ],
            "title": "A standard format for Les Houches event",
            "venue": "files, Comput. Phys. Commun. 176,",
            "year": 2007
        },
        {
            "authors": [
                "H. Fritzsch"
            ],
            "title": "Producing heavy quark flavors in hadronic collisions: A test of quantum chromodynamics",
            "venue": "Phys. Lett. B 67, 217 ",
            "year": 2693
        },
        {
            "authors": [
                "A. Ali",
                "J.G. K\u00f6rner",
                "G. Kramer",
                "J. Willrodt"
            ],
            "title": "Nonleptonic weak decays of bottom mesons",
            "venue": "Z. Phys. C 1, 269 ",
            "year": 1979
        },
        {
            "authors": [
                "H. Fritzsch"
            ],
            "title": "How to discover the B mesons",
            "venue": "Phys. Lett. B 86, 343 ",
            "year": 2693
        },
        {
            "authors": [
                "C. Albajar"
            ],
            "title": "A study of the general characteristics of pp\u0304 collisions at p s = 0.2 TeV to 0.9 TeV",
            "venue": "Nucl. Phys. B 335,",
            "year": 1990
        },
        {
            "authors": [
                "T. Sj\u00f6strand",
                "V.A. Khoze"
            ],
            "title": "On colour rearrangement in hadronic W+W\u2212 evemts",
            "venue": "Z. Phys. C 62, 281 ",
            "year": 1994
        },
        {
            "authors": [
                "S. Schael"
            ],
            "title": "Electroweak measurements in electron-positron collisions at W-boson-pair energies at LEP",
            "venue": "Phys. Rep. 532,",
            "year": 2013
        },
        {
            "authors": [
                "M. Aaboud"
            ],
            "title": "Measurement of the top quark mass in the t t\u0304 \u2192 lepton+jets channel from p s = 8 TeV ATLAS data and combination with previous results",
            "venue": "Eur. Phys. J. C 79,",
            "year": 2019
        },
        {
            "authors": [
                "A.M. Sirunyan"
            ],
            "title": "Measurement of the top quark mass in the all-jets final state at p s = 13 TeV and combination with the lepton+jets channel",
            "venue": "Eur. Phys. J. C 79,",
            "year": 2019
        },
        {
            "authors": [
                "M. Sandhoff",
                "P.Z. Skands"
            ],
            "title": "Colour annealing - A toy model of colour reconnections",
            "venue": "4th Les Houches Workshop on Physics at TeV Colliders, FERMILAB-CONF-05-518-T ",
            "year": 2005
        },
        {
            "authors": [
                "P. Skands",
                "D. Wicke"
            ],
            "title": "Non-perturbative QCD effects and the top mass at the Tevatron",
            "venue": "Eur. Phys. J. C 52, 133 ",
            "year": 2007
        },
        {
            "authors": [
                "P.Z. Skands"
            ],
            "title": "Tuning Monte Carlo generators: The Perugia tunes",
            "venue": "Phys. Rev. D 82, 074018 ",
            "year": 2010
        },
        {
            "authors": [
                "S. Argyropoulos",
                "T. Sj\u00f6strand"
            ],
            "title": "Effects of color reconnection on t t\u0304 final states at the LHC",
            "venue": "J. High Energy Phys. 11, 043 (2014), doi:10.1007/JHEP11",
            "year": 2014
        },
        {
            "authors": [
                "L. L\u00f6nnblad"
            ],
            "title": "Reconnecting coloured dipoles",
            "venue": "Z. Phys. C 70, 107 ",
            "year": 1996
        },
        {
            "authors": [
                "T. Sj\u00f6strand",
                "V.A. Khoze"
            ],
            "title": "Does the W reconstruction survive QCD effects",
            "venue": "Phys. Rev. Lett. 72, 28 ",
            "year": 1994
        },
        {
            "authors": [
                "J.R. Christiansen",
                "T. Sj\u00f6strand"
            ],
            "title": "Color reconnection at future e+ e\u2212 colliders",
            "venue": "Eur. Phys. J. C 75, 441 ",
            "year": 2015
        },
        {
            "authors": [
                "A. Chodos",
                "R.L. Jaffe",
                "K. Johnson",
                "C.B. Thorn",
                "V.F. Weisskopf"
            ],
            "title": "New extended model of hadrons",
            "venue": "Phys. Rev. D 9, 3471 ",
            "year": 1974
        },
        {
            "authors": [
                "D. Wicke",
                "P.Z. Skands"
            ],
            "title": "Non-perturbative QCD effects and the top mass at the Tevatron",
            "venue": "Nuov. Cim. B 123, 1 ",
            "year": 2008
        },
        {
            "authors": [
                "G. Gustafson",
                "J. H\u00e4kkinen"
            ],
            "title": "Colour interference and confinement effects in W-pair production",
            "venue": "Z. Phys. C 64, 659 ",
            "year": 1994
        },
        {
            "authors": [
                "W. Buchm\u00fcller",
                "A. Hebecker"
            ],
            "title": "A parton model for diffractive processes in deep inelastic scattering",
            "venue": "Phys. Lett. B 355, 573 ",
            "year": 2693
        },
        {
            "authors": [
                "A. Edin",
                "G. Ingelman",
                "J. Rathsman"
            ],
            "title": "Soft colour interactions as the origin of rapidity gaps in DIS",
            "venue": "Phys. Lett. B 366, 371 ",
            "year": 2693
        },
        {
            "authors": [
                "A. Edin",
                "G. Ingelman",
                "J. Rathsman"
            ],
            "title": "Unified description of rapidity gaps and energy flows in DIS final states",
            "venue": "Z. Phys. C 75, 57 (1997), doi:10.1007/s002880050447. 279 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "R. Pasechnik",
                "R. Enberg",
                "G. Ingelman"
            ],
            "title": "Diffractive deep inelastic scattering from multiple soft gluon exchange in QCD",
            "venue": "Phys. Lett. B 695, 189 ",
            "year": 2011
        },
        {
            "authors": [
                "R. Enberg",
                "G. Ingelman",
                "N. T\u00eemneanu"
            ],
            "title": "Soft color interactions and diffractive hard scattering at the Fermilab Tevatron",
            "venue": "Phys. Rev. D 64, 114015 ",
            "year": 2001
        },
        {
            "authors": [
                "A. Edin",
                "G. Ingelman",
                "J. Rathsman"
            ],
            "title": "Quarkonium production at the Fermilab Tevatron through soft color interactions",
            "venue": "Phys. Rev. D 56, 7317 ",
            "year": 1997
        },
        {
            "authors": [
                "J. Rathsman"
            ],
            "title": "A generalised area law for hadronic string reinteractions",
            "venue": "Phys. Lett. B 452, 364 ",
            "year": 2693
        },
        {
            "authors": [
                "S. Gieseke",
                "C. R\u00f6hr",
                "A. Si\u00f3dmok"
            ],
            "title": "Colour reconnections in Herwig++",
            "venue": "Eur. Phys. J. C 72, 2225 ",
            "year": 2012
        },
        {
            "authors": [
                "S. Gieseke",
                "P. Kirchgae\u00dfer",
                "S. Pl\u00e4tzer",
                "A. Siodmok"
            ],
            "title": "Colour reconnection from soft gluon evolution",
            "venue": "J. High Energy Phys. 11, 149 (2018), doi:10.1007/JHEP11",
            "year": 2018
        },
        {
            "authors": [
                "J. Bellm",
                "C.B. Duncan",
                "S. Gieseke",
                "M. Myska",
                "A. Si\u00f3dmok"
            ],
            "title": "Spacetime colour reconnection in Herwig 7",
            "venue": "Eur. Phys. J. C 79, 1003 ",
            "year": 2019
        },
        {
            "authors": [
                "V.A. Khoze",
                "F. Krauss",
                "A.D. Martin",
                "M.G. Ryskin",
                "K.C. Zapp"
            ],
            "title": "Diffraction and correlations at the LHC: Definitions and observables",
            "venue": "Eur. Phys. J. C 69, 85 ",
            "year": 2010
        },
        {
            "authors": [
                "K. Zapp"
            ],
            "title": "JEWEL 2.0.0: Directions for use",
            "venue": "Eur. Phys. J. C 74,",
            "year": 2014
        },
        {
            "authors": [
                "S. Cao"
            ],
            "title": "Multistage Monte Carlo simulation of jet modification in a static medium",
            "venue": "Phys. Rev. C",
            "year": 2017
        },
        {
            "authors": [
                "K. Werner"
            ],
            "title": "Core-corona separation in ultrarelativistic heavy ion collisions",
            "venue": "Phys. Rev. Lett. 98, 152301 ",
            "year": 2007
        },
        {
            "authors": [
                "T. Pierog"
            ],
            "title": "Iu",
            "venue": "Karpenko, J. M. Katzy, E. Yatsenko and K. Werner, EPOS LHC: Test of collective hadronization with data measured at the CERN Large Hadron Collider, Phys. Rev. C 92, 034906 ",
            "year": 2015
        },
        {
            "authors": [
                "Y. Kanakubo",
                "Y. Tachibana",
                "T. Hirano"
            ],
            "title": "Unified description of hadron yield ratios from dynamical core-corona initialization",
            "venue": "Phys. Rev. C 101, 024912 ",
            "year": 2020
        },
        {
            "authors": [
                "V. Khachatryan"
            ],
            "title": "Observation of long-range, near-side angular correlations in proton-proton collisions at the LHC",
            "venue": "J. High Energy Phys",
            "year": 2010
        },
        {
            "authors": [
                "V. Khachatryan"
            ],
            "title": "Strange particle production in pp collisions at p s = 0.9 and 7 TeV",
            "venue": "J. High Energy Phys",
            "year": 2011
        },
        {
            "authors": [
                "R. Aaij"
            ],
            "title": "Measurement of prompt hadron production ratios in pp collisions at p s = 0.9 and 7 TeV",
            "venue": "Eur. Phys. J. C",
            "year": 2012
        },
        {
            "authors": [
                "K. Aamodt"
            ],
            "title": "Strange particle production in proton-proton collisions at p s = 0.9 TeV with ALICE at the LHC",
            "venue": "Eur. Phys. J. C 71,",
            "year": 2011
        },
        {
            "authors": [
                "B. Abelev"
            ],
            "title": "Multi-strange baryon production in pp collisions at p s = 7 TeV with ALICE",
            "venue": "Phys. Lett. B 712,",
            "year": 2012
        },
        {
            "authors": [
                "J. Adam"
            ],
            "title": "Enhanced production of multi-strange hadrons in high-multiplicity protonproton collisions",
            "venue": "Nat. Phys. 13,",
            "year": 2017
        },
        {
            "authors": [
                "A.O. Velasquez",
                "P. Christiansen",
                "E.C. Flores",
                "I.A.M. Cervantes",
                "G. Pai\u0107"
            ],
            "title": "Color reconnection and flowlike patterns in pp collisions",
            "venue": "Phys. Rev. Lett. 111, 042001 ",
            "year": 2013
        },
        {
            "authors": [
                "C. Bierlich",
                "J.R. Christiansen"
            ],
            "title": "Effects of color reconnection on hadron flavor observables",
            "venue": "Phys. Rev. D 92, 094010 ",
            "year": 2015
        },
        {
            "authors": [
                "C. Bierlich"
            ],
            "title": "Microscopic collectivity: The ridge and strangeness enhancement from string-string interactions",
            "venue": "Nucl. Phys. A 982, 499 ",
            "year": 2019
        },
        {
            "authors": [
                "V.A. Abramovsky",
                "E.V. Gedalin",
                "E.G. Gurvich",
                "O.V. Kancheli"
            ],
            "title": "Long range azimuthal correlations in multiple production processes at high-energies",
            "venue": "J. Exp. Theor. Phys. Lett. 47, 337 ",
            "year": 1988
        },
        {
            "authors": [
                "C. Bierlich"
            ],
            "title": "Soft modifications to jet fragmentation in high energy proton-proton collisions",
            "venue": "Phys. Lett. B 795, 194 ",
            "year": 2019
        },
        {
            "authors": [
                "C. Bierlich",
                "S. Chakraborty",
                "G. Gustafson",
                "L. L\u00f6nnblad"
            ],
            "title": "Setting the string shoving picture in a new frame",
            "venue": "J. High Energy Phys. 03, 270 (2021), doi:10.1007/JHEP03",
            "year": 2021
        },
        {
            "authors": [
                "P. Cea",
                "L. Cosmai",
                "F. Cuteri",
                "A. Papa"
            ],
            "title": "Flux tubes in the SU(3) vacuum: London penetration depth and coherence length",
            "venue": "Phys. Rev. D 89, 094505 ",
            "year": 2014
        },
        {
            "authors": [
                "T.S. Biro",
                "H.B. Nielsen",
                "J. Knoll"
            ],
            "title": "Colour rope model for extreme relativistic heavy ion collisions",
            "venue": "Nucl. Phys. B 245, 449 ",
            "year": 1016
        },
        {
            "authors": [
                "G.S. Bali"
            ],
            "title": "Casimir scaling of SU(3) static potentials",
            "venue": "Phys. Rev. D 62, 114503 ",
            "year": 2000
        },
        {
            "authors": [
                "S. Jeon",
                "R. Venugopalan"
            ],
            "title": "Random walks of partons in SU(Nc) and classical representations of color charges in QCD at small x",
            "venue": "Phys. Rev. D 70, 105012 ",
            "year": 2004
        },
        {
            "authors": [
                "P. Skands"
            ],
            "title": "S",
            "venue": "Carrazza and J. Rojo, Tuning PYTHIA 8.1: The Monash 2013 tune, Eur. Phys. J. C 74, 3024 ",
            "year": 2014
        },
        {
            "authors": [
                "N. Fischer",
                "T. Sj\u00f6strand"
            ],
            "title": "Thermodynamical string fragmentation",
            "venue": "J. High Energy Phys. 01, 140 (2017), doi:10.1007/JHEP01",
            "year": 2017
        },
        {
            "authors": [
                "A. Bialas"
            ],
            "title": "Fluctuations of the string tension and transverse mass distribution",
            "venue": "Phys. Lett. B 466, 301 ",
            "year": 2693
        },
        {
            "authors": [
                "C. Bierlich",
                "T. Sj\u00f6strand",
                "M. Utheim"
            ],
            "title": "Hadronic rescattering in pA and AA collisions",
            "venue": "Eur. Phys. J. A 57, 227 (2021), doi:10.1140/epja/s10050-021-00543-3. 281 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "R.H. Brown",
                "R.Q. Twiss"
            ],
            "title": "A test of a new type of stellar interferometer on Sirius",
            "venue": "Nature 178, 1046 ",
            "year": 1956
        },
        {
            "authors": [
                "N. Neumeister"
            ],
            "title": "Higher order Bose-Einstein correlations in pp collisions at p s = 630 and 900",
            "venue": "GeV, Phys. Lett. B 275,",
            "year": 1992
        },
        {
            "authors": [
                "G. Aad"
            ],
            "title": "Two-particle Bose-Einstein correlations in pp collisions at p s = 0.9 and 7 TeV measured with the ATLAS detector",
            "venue": "Eur. Phys. J. C 75,",
            "year": 2015
        },
        {
            "authors": [
                "V. Khachatryan"
            ],
            "title": "Measurement of Bose-Einstein correlations in pp collisions at p s = 0.9 and 7 TeV",
            "venue": "J. High Energy Phys",
            "year": 2011
        },
        {
            "authors": [
                "R. Aaij"
            ],
            "title": "Bose-Einstein correlations of same-sign charged pions in the forward region in pp collisions at p s = 7 TeV",
            "venue": "J. High Energy Phys. 12,",
            "year": 2017
        },
        {
            "authors": [
                "P.D. Acton"
            ],
            "title": "A study of Bose-Einstein correlations in e+e\u2212 annihilations at LEP",
            "venue": "Phys. Lett. B 267,",
            "year": 1991
        },
        {
            "authors": [
                "P.D. Acton"
            ],
            "title": "A study of Ks K 0 s Bose-Einstein correlations in hadronic Z 0 decays",
            "venue": "Phys. Lett. B 298,",
            "year": 1993
        },
        {
            "authors": [
                "D. Decamp"
            ],
            "title": "A study of Bose-Einstein correlations in e+e\u2212 annihilation at 91",
            "venue": "GeV, Z. Phys. C 54,",
            "year": 1992
        },
        {
            "authors": [
                "P. Abreu"
            ],
            "title": "Interference of neutral kaons in the hadronic decays of the Z0",
            "venue": "Phys. Lett. B 323,",
            "year": 1994
        },
        {
            "authors": [
                "L. L\u00f6nnblad",
                "T. Sj\u00f6strand"
            ],
            "title": "Bose-Einstein effects and W mass determinations",
            "venue": "Phys. Lett. B 351, 293 ",
            "year": 2693
        },
        {
            "authors": [
                "M. Gyulassy",
                "S.K. Kauffmann",
                "L.W. Wilson"
            ],
            "title": "Pion interferometry of nuclear collisions",
            "venue": "I. Theory, Phys. Rev. C 20, 2267 ",
            "year": 1979
        },
        {
            "authors": [
                "L. L\u00f6nnblad",
                "T. Sj\u00f6strand"
            ],
            "title": "Modeling Bose-Einstein correlations at LEP-2",
            "venue": "Eur. Phys. J. C 2, 165 ",
            "year": 1998
        },
        {
            "authors": [
                "F. Donato",
                "N. Fornengo",
                "P. Salati"
            ],
            "title": "Antideuterons as a signature of supersymmetric dark matter",
            "venue": "Phys. Rev. D 62, 043003 ",
            "year": 2000
        },
        {
            "authors": [
                "A. Andronic",
                "P. Braun-Munzinger",
                "J. Stachel",
                "H. St\u00f6cker"
            ],
            "title": "Production of light nuclei",
            "venue": "hypernuclei and their antiparticles in relativistic nuclear collisions, Phys. Lett. B 697, 203 ",
            "year": 2011
        },
        {
            "authors": [
                "A. Schwarzschild",
                "\u010c. Zupan\u010di\u010d"
            ],
            "title": "Production of tritons",
            "venue": "deuterons, nucleons, and mesons by 30-GeV protons on Al, Be, and Fe targets, Phys. Rev. 129, 854 ",
            "year": 1963
        },
        {
            "authors": [
                "J.I. Kapusta"
            ],
            "title": "Mechanisms for deuteron production in relativistic nuclear collisions",
            "venue": "Phys. Rev. C 21, 1301 ",
            "year": 1980
        },
        {
            "authors": [
                "L.A. Dal",
                "A.R. Raklev"
            ],
            "title": "Alternative formation model for antideuterons from dark matter",
            "venue": "Phys. Rev. D 91, 123536 (2015), doi:10.1103/PhysRevD.91.123536. 282 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "A. De R\u00fajula",
                "H. Georgi",
                "S.L. Glashow"
            ],
            "title": "Hadron masses in a gauge theory",
            "venue": "Phys. Rev. D 12, 147 ",
            "year": 1975
        },
        {
            "authors": [
                "D.J. Herndon",
                "P. S\u00f6ding",
                "R.J. Cashmore"
            ],
            "title": "Generalized isobar model formalism",
            "venue": "Phys. Rev. D 11, 3165 ",
            "year": 1975
        },
        {
            "authors": [
                "M. Ablikim"
            ],
            "title": "Dalitz plot analysis of the decay\u03c9\u2192 \u03c0+\u03c0\u2212\u03c00",
            "venue": "Phys. Rev. D",
            "year": 2018
        },
        {
            "authors": [
                "S. Rudaz"
            ],
            "title": "Anomalies",
            "venue": "vector mesons and the\u03c9\u2192 3\u03c0 contact term, Phys. Lett. B 145, 281 ",
            "year": 2693
        },
        {
            "authors": [
                "S. Jadach"
            ],
            "title": "Z",
            "venue": "Wa\u0327s, R. Decker and J. H. K\u00fchn, The \u03c4 decay library TAUOLA, version 2.4, Comput. Phys. Commun. 76, 361 ",
            "year": 1016
        },
        {
            "authors": [
                "H. Murayama",
                "I. Watanabe",
                "K. Hagiwara"
            ],
            "title": "HELAS: HELicity Amplitude Subroutines for Feynman diagram evaluations",
            "venue": "KEK Report 91-11 ",
            "year": 1992
        },
        {
            "authors": [
                "J.H. K\u00fchn",
                "A. Santamaria"
            ],
            "title": "\u03c4 decays to pions",
            "venue": "Z. Phys. C 48, 445 ",
            "year": 1990
        },
        {
            "authors": [
                "M. Finkemeier",
                "E. Mirkes"
            ],
            "title": "The scalar contribution to \u03c4\u2192 K\u03c0\u03bd\u03c4",
            "venue": "Z. Phys. C 72, 619 ",
            "year": 1996
        },
        {
            "authors": [
                "D.M. Asner"
            ],
            "title": "Hadronic structure in the decay \u03c4\u2212 \u2192 \u03bd\u03c4\u03c0\u03c0\u03c0 and the sign of the tau-neutrino helicity",
            "venue": "Phys. Rev. D",
            "year": 1999
        },
        {
            "authors": [
                "M. Finkemeier",
                "E. Mirkes"
            ],
            "title": "Tau decays into kaons",
            "venue": "Z. Phys. C 69, 243 ",
            "year": 1995
        },
        {
            "authors": [
                "R. Decker",
                "E. Mirkes",
                "R. Sauer",
                "Z. Was"
            ],
            "title": "Tau decays into three pseudoscalar mesons",
            "venue": "Z. Phys. C 58, 445 ",
            "year": 1993
        },
        {
            "authors": [
                "A.E. Bondar",
                "S.I. Eidelman",
                "A.I. Milstein",
                "T. Pierzcha\u0142a",
                "N.I. Root"
            ],
            "title": "Z",
            "venue": "Wa\u0327s and M. Worek, Novosibirsk hadronic currents for \u03c4 \u2192 4\u03c0 channels of \u03c4 decay library TAUOLA, Comput. Phys. Commun. 146, 139 ",
            "year": 1016
        },
        {
            "authors": [
                "J.H. Kuhn",
                "Z. Was"
            ],
            "title": "\u03c4 decays to five mesons in TAUOLA",
            "venue": "Acta Phys. Pol. B 39, 147 ",
            "year": 2008
        },
        {
            "authors": [
                "P. Golonka",
                "B. Kersevan",
                "T. Pierzchala"
            ],
            "title": "E",
            "venue": "Richter-Wa\u0327s, Z. Wa\u0327s and M. Worek, The tauolaphotos-F environment for the TAUOLA and PHOTOS packages, release II, Comput. Phys. Commun. 174, 818 ",
            "year": 2006
        },
        {
            "authors": [
                "J. Butterworth"
            ],
            "title": "Les Houches 2013: Physics at TeV colliders: Standard model working group report, arXiv:1405.1067",
            "year": 2013
        },
        {
            "authors": [
                "A. Buckley",
                "H. Hoeth",
                "H. Lacker"
            ],
            "title": "H",
            "venue": "Schulz and J. E. von Seggern, Systematic event generator tuning for the LHC, Eur. Phys. J. C 65, 331 (2009), doi:10.1140/epjc/s10052- 009-1196-7. 283 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "P. Ilten",
                "M. Williams",
                "Y. Yang"
            ],
            "title": "Event generator tuning using Bayesian optimization",
            "venue": "J. Instrum. 12, P04028 ",
            "year": 2017
        },
        {
            "authors": [
                "J. Bellm",
                "L. Gellersen"
            ],
            "title": "High dimensional parameter tuning for event generators",
            "venue": "Eur. Phys. J. C 80, 54 ",
            "year": 2020
        },
        {
            "authors": [
                "M. Krishnamoorthy"
            ],
            "title": "Apprentice for event generator tuning, Europhys",
            "venue": "J. Web Conf. 251,",
            "year": 2021
        },
        {
            "authors": [
                "J.M. Butterworth"
            ],
            "title": "The tools and Monte Carlo working group: Summary report",
            "venue": "from the Les Houches 2009 workshop on TeV colliders,",
            "year": 2009
        },
        {
            "authors": [
                "P. Skands"
            ],
            "title": "SUSY Les Houches accord: Interfacing SUSY spectrum calculators, decay packages, and event generators",
            "venue": "J. High Energy Phys",
            "year": 2004
        },
        {
            "authors": [
                "E. Bothmann"
            ],
            "title": "Event generation with Sherpa",
            "venue": "SciPost Phys. 7,",
            "year": 2019
        },
        {
            "authors": [
                "S. H\u00f6che",
                "S. Prestel",
                "H. Schulz"
            ],
            "title": "Simulation of vector boson plus many jet final states at the high luminosity LHC",
            "venue": "Phys. Rev. D 100, 014024 ",
            "year": 2019
        },
        {
            "authors": [
                "A. Buckley",
                "J. Ferrando",
                "S. Lloyd",
                "K. Nordstr\u00f6m",
                "B. Page",
                "M. R\u00fcfenacht",
                "M. Sch\u00f6nherr",
                "G. Watt"
            ],
            "title": "LHAPDF6: Parton density access in the LHC precision era",
            "venue": "Eur. Phys. J. C 75, 132 ",
            "year": 2015
        },
        {
            "authors": [
                "P. Artoisenet",
                "F. Maltoni",
                "T. Stelzer"
            ],
            "title": "Automatic generation of quarkonium amplitudes in NRQCD",
            "venue": "J. High Energy Phys. 02, 102 ",
            "year": 2008
        },
        {
            "authors": [
                "H.-S. Shao"
            ],
            "title": "HELAC-Onia 2.0: An upgraded matrix-element and event generator for heavy quarkonium physics",
            "venue": "Comput. Phys. Commun. 198,",
            "year": 2015
        },
        {
            "authors": [
                "D.J. Lange"
            ],
            "title": "The EvtGen particle decay simulation package",
            "venue": "Nucl. Instrum. Methods Phys. Res. A 462, 152 ",
            "year": 1016
        },
        {
            "authors": [
                "M. Dobbs",
                "J.B. Hansen"
            ],
            "title": "The HepMC C++ Monte Carlo event record for high energy physics",
            "venue": "Comput. Phys. Commun. 134, 41 ",
            "year": 1016
        },
        {
            "authors": [
                "A. Buckley",
                "P. Ilten",
                "D. Konstantinov",
                "L. L\u00f6nnblad",
                "J. Monk",
                "W. Pokorski",
                "T. Przedzinski",
                "A. Verbytskyi"
            ],
            "title": "The HepMC3 event record library for Monte Carlo event generators",
            "venue": "Comput. Phys. Commun. 260, 107310 ",
            "year": 2021
        },
        {
            "authors": [
                "R. Brun",
                "F. Rademakers"
            ],
            "title": "ROOT: An object oriented data analysis framework",
            "venue": "Nucl. Instrum. Methods Phys. Res. A 389, 81 (1997), doi:10.1016/S0168-9002(97)00048-X. 284 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "A. Buckley",
                "J. Butterworth",
                "D. Grellscheid",
                "H. Hoeth",
                "L. L\u00f6nnblad",
                "J. Monk",
                "H. Schulz",
                "F. Siegert"
            ],
            "title": "Rivet user manual",
            "venue": "Comput. Phys. Commun. 184, 2803 ",
            "year": 2013
        },
        {
            "authors": [
                "C. Bierlich"
            ],
            "title": "Robust independent validation of experiment and theory: Rivet version 3",
            "venue": "SciPost Phys. 8,",
            "year": 2020
        },
        {
            "authors": [
                "M.R. Whalley",
                "R.G. Roberts"
            ],
            "title": "A user guide to HEPData: The Durham/RAL HEP databases on the RAL CMS system",
            "venue": "RAL\u201388-003 ",
            "year": 1988
        },
        {
            "authors": [
                "E. Maguire",
                "L. Heinrich",
                "G. Watt"
            ],
            "title": "HEPData: A repository for high energy physics data",
            "venue": "J. Phys.: Conf. Ser. 898, 102006 ",
            "year": 2017
        },
        {
            "authors": [
                "C. Bierlich"
            ],
            "title": "Confronting experimental data with heavy-ion models: Rivet for heavy ions",
            "venue": "Eur. Phys. J. C 80,",
            "year": 2020
        },
        {
            "authors": [
                "M. Cacciari",
                "G.P. Salam",
                "G. Soyez"
            ],
            "title": "FastJet user manual",
            "venue": "Eur. Phys. J. C 72, 1896 ",
            "year": 2012
        },
        {
            "authors": [
                "J.D. Bjorken"
            ],
            "title": "Particle physics: Where do we go from here",
            "venue": "SLAC Beam Line 22, 8 ",
            "year": 1992
        },
        {
            "authors": [
                "B.L. Combridge",
                "J. Kripfganz",
                "J. Ranft"
            ],
            "title": "Hadron production at large transverse momentum and QCD",
            "venue": "Phys. Lett. B 70, 234 ",
            "year": 2693
        },
        {
            "authors": [
                "R. Cutler",
                "D. Sivers"
            ],
            "title": "Quantum chromodynamic gluon contributions to large pT reactions",
            "venue": "Phys. Rev. D 17, 196 ",
            "year": 1978
        },
        {
            "authors": [
                "H.-U. Bengtsson"
            ],
            "title": "The Lund Monte Carlo for high-pT physics",
            "venue": "Comput. Phys. Commun. 31, 323 ",
            "year": 1016
        },
        {
            "authors": [
                "E. Eichten",
                "I. Hinchliffe",
                "K. Lane",
                "C. Quigg"
            ],
            "title": "Supercollider physics",
            "venue": "Rev. Mod. Phys. 56, 579 ",
            "year": 1984
        },
        {
            "authors": [
                "B.L. Combridge"
            ],
            "title": "Associated production of heavy flavour states in pp and p\u0304p interactions: Some QCD estimates",
            "venue": "Nucl. Phys. B 151, 429 ",
            "year": 1016
        },
        {
            "authors": [
                "F.A. Berends",
                "R. Kleiss",
                "P. De Causmaecker",
                "R. Gastmans",
                "T.T. Wu"
            ],
            "title": "Single bremsstrahlung processes in gauge theories",
            "venue": "Phys. Lett. B 103, 124 ",
            "year": 2693
        },
        {
            "authors": [
                "F. Halzen",
                "D.M. Scott"
            ],
            "title": "Hadroproduction of photons and leptons",
            "venue": "Phys. Rev. D 18, 3378 ",
            "year": 1978
        },
        {
            "authors": [
                "V. Costantini",
                "B. De Tollis",
                "G. Pistoni"
            ],
            "title": "Nonlinear effects in quantum electrodynamics",
            "venue": "Nuov. Cim. A 2, 733 ",
            "year": 1971
        },
        {
            "authors": [
                "E.L. Berger",
                "E. Braaten",
                "R.D. Field"
            ],
            "title": "Large-pT production of single and double photons in proton-proton and pion-proton collisions",
            "venue": "Nucl. Phys. B 239, 52 ",
            "year": 1016
        },
        {
            "authors": [
                "D.A. Dicus",
                "S.S.D. Willenbrock"
            ],
            "title": "Photon pair production and the intermediate-mass Higgs boson",
            "venue": "Phys. Rev. D 37, 1801 ",
            "year": 1988
        },
        {
            "authors": [
                "G. Ingelman"
            ],
            "title": "Deep inelastic physics and simulation, in DESY Workshop 1987: Physics at HERA",
            "venue": "SciPost Phys. Codebases",
            "year": 1987
        },
        {
            "authors": [
                "D. Bardin",
                "M. Bilenky",
                "D. Lehner",
                "A. Olchevski",
                "T. Riemann"
            ],
            "title": "Semi-analytical approach to four-fermion production in e+e\u2212 annihilation",
            "venue": "Nucl. Phys. B Proc. Suppl. 37, 148 ",
            "year": 1016
        },
        {
            "authors": [
                "E. Gabrielli"
            ],
            "title": "The production of weak intermediate bosons in ep reactions",
            "venue": "Mod. Phys. Lett. A 01, 465 ",
            "year": 1986
        },
        {
            "authors": [
                "M.A. Samuel",
                "G. Li",
                "N. Sinha",
                "R. Sinha",
                "M.K. Sundaresan"
            ],
            "title": "Bounds on the magnetic moment of the W boson",
            "venue": "Phys. Rev. Lett. 67, 9 ",
            "year": 1991
        },
        {
            "authors": [
                "T. Barklow"
            ],
            "title": "Particle physics research at a 500 GeV e+e\u2212 linear collider",
            "venue": "Conf. Proc. C 9006252, 440 ",
            "year": 1990
        },
        {
            "authors": [
                "D.W. Duke",
                "J.F. Owens"
            ],
            "title": "Quantum-chromodynamic corrections to deep-inelastic Compton scattering",
            "venue": "Phys. Rev. D 26, 1600 ",
            "year": 1982
        },
        {
            "authors": [
                "M. Fontannaz",
                "B. Pire",
                "D. Schiff"
            ],
            "title": "Inclusive photoproduction cross sections of charmed mesons and baryons",
            "venue": "Z. Phys. C 11, 211 ",
            "year": 1981
        },
        {
            "authors": [
                "G. Bozzi",
                "B. Fuks",
                "B. Herrmann",
                "M. Klasen"
            ],
            "title": "Squark and gaugino hadroproduction and decays in non-minimal flavour violating supersymmetry",
            "venue": "Nucl. Phys. B 787, 1 ",
            "year": 2007
        },
        {
            "authors": [
                "B. Fuks",
                "B. Herrmann",
                "M. Klasen"
            ],
            "title": "Phenomenology of anomaly-mediated supersymmetry-breaking scenarios with nonminimal flavor violation",
            "venue": "Phys. Rev. D 86, 015002 ",
            "year": 2012
        },
        {
            "authors": [
                "K. Huitu",
                "J. Maalampi",
                "A. Pietil\u00e4",
                "M. Raidal"
            ],
            "title": "Doubly charged Higgs at LHC",
            "venue": "Nucl. Phys. B 487, 27 ",
            "year": 1016
        },
        {
            "authors": [
                "G. Barenboim",
                "K. Huitu",
                "J. Maalampi",
                "M. Raidal"
            ],
            "title": "Constraints on doubly charged Higgs interactions at linear collider",
            "venue": "Phys. Lett. B 394, 132 ",
            "year": 2693
        },
        {
            "authors": [
                "C. Ciobanu",
                "T. Junk",
                "G. Veramendi",
                "J. Lee",
                "G. De Lentdecker",
                "K. McFarland",
                "K. Maeshima"
            ],
            "title": "Z\u2019 generation with PYTHIA",
            "venue": "FERMILAB-FN-0773-E ",
            "year": 2005
        },
        {
            "authors": [
                "G. Altarelli",
                "B. Mele",
                "M. Ruiz-Altaba"
            ],
            "title": "Searching for new heavy vector bosons in pp\u0304 colliders",
            "venue": "Z. Phys. C 45, 109 ",
            "year": 1989
        },
        {
            "authors": [
                "J.L. Hewett",
                "S. Pakvasa"
            ],
            "title": "Scalar-leptoquark production at hadron colliders",
            "venue": "Phys. Rev. D 37, 3165 ",
            "year": 1988
        },
        {
            "authors": [
                "E.J. Eichten",
                "K.D. Lane",
                "M.E. Peskin"
            ],
            "title": "New tests for quark and lepton substructure",
            "venue": "Phys. Rev. Lett. 50, 811 ",
            "year": 1983
        },
        {
            "authors": [
                "U. Baur",
                "M. Spira",
                "P.M. Zerwas"
            ],
            "title": "Excited-quark and -lepton production at hadron colliders",
            "venue": "Phys. Rev. D 42, 815 ",
            "year": 1990
        },
        {
            "authors": [
                "J. Bijnens",
                "P. Eerola",
                "M. Maul",
                "A. M\u00e5nsson",
                "T. Sj\u00f6strand"
            ],
            "title": "QCD signatures of narrow graviton resonances in hadron colliders",
            "venue": "Phys. Lett. B 503, 341 (2001), doi:10.1016/S0370-2693(01)00238-6. 286 SciPost Phys. Codebases 8 ",
            "year": 2022
        },
        {
            "authors": [
                "G. Bella",
                "E. Etzion",
                "N. Hod",
                "Y. Oz",
                "Y. Silver",
                "M. Sutton"
            ],
            "title": "A search for heavy Kaluza- Klein electroweak gauge bosons at the LHC",
            "venue": "J. High Energy Phys. 09, 025 (2010), doi:10.1007/JHEP09",
            "year": 2010
        },
        {
            "authors": [
                "S. Ask",
                "J.H. Collins",
                "J.R. Forshaw",
                "K. Joshi",
                "A.D. Pilkington"
            ],
            "title": "Identifying the colour of TeV-scale resonances",
            "venue": "J. High Energy Phys. 01, 018 (2012), doi:10.1007/JHEP01",
            "year": 2012
        },
        {
            "authors": [
                "R. Franceschini",
                "P.P. Giardino",
                "G.F. Giudice",
                "P. Lodone",
                "A. Strumia"
            ],
            "title": "LHC bounds on large extra dimensions",
            "venue": "J. High Energy Phys. 05, 092 (2011), doi:10.1007/JHEP05",
            "year": 2011
        },
        {
            "authors": [
                "S. Ask"
            ],
            "title": "Simulation of Z plus graviton/unparticle production at the LHC",
            "venue": "Eur. Phys. J. C 60, 509 ",
            "year": 2009
        },
        {
            "authors": [
                "S. Ask",
                "I.V. Akin",
                "L. Benucci",
                "A. De Roeck",
                "M. Goebel",
                "J. Haller"
            ],
            "title": "Real emission and virtual exchange of gravitons and unparticles in Pythia8",
            "venue": "Comput. Phys. Commun. 181, 1593 ",
            "year": 2010
        }
    ],
    "sections": [
        {
            "text": "This manual describes the PYTHIA 8.3 event generator, the most recent version of an evolving physics tool used to answer fundamental questions in particle physics. The program is most often used to generate high-energy-physics collision \u201cevents\u201d, i.e. sets of particles produced in association with the collision of two incoming high-energy particles, but has several uses beyond that. The guiding philosophy is to produce and reproduce properties of experimentally obtained collisions as accurately as possible. The program includes a wide ranges of reactions within and beyond the Standard Model, and extending to heavy ion physics. Emphasis is put on phenomena where strong interactions play a major role. The manual contains both pedagogical and practical components. All included physics models are described in enough detail to allow the user to obtain a cursory overview of used assumptions and approximations, enabling an informed evaluation of the program output. A number of the most central algorithms are described in enough detail that the main results of the program can be reproduced independently, allowing further development of existing models or the addition of new ones. Finally, a chapter dedicated fully to the user is included towards the end, providing pedagogical examples of standard use cases, and a detailed description of a number of external interfaces. The program code, the online manual, and the latest version of this print manual can be found on the PYTHIA web page:\nhttps://www.pythia.org/\nCopyright C. Bierlich et al. This work is licensed under the Creative Commons Attribution 4.0 International License. Published by the SciPost Foundation.\nReceived 07-04-2022 Accepted 12-08-2022 Published 10-11-2022\nCheck for updates\ndoi:10.21468/SciPostPhysCodeb.8\nThis publication is part of a bundle: Please cite both the article and the release you used.\nDOI doi:10.21468/SciPostPhysCodeb.8 doi:10.21468/SciPostPhysCodeb.8-r8.3\nType Article Codebase release\nContents\nI Introduction 6"
        },
        {
            "heading": "1 Preliminaries 7",
            "text": "1.1 What is an \u201cevent generator\u201d ? 7 1.2 The structure of a simulated event 8 1.3 To what types of problems can PYTHIA be applied ? 10 1.4 Historical evolution of the PYTHIA program 11"
        },
        {
            "heading": "2 Program structure and basic algorithms 13",
            "text": "2.1 Program structure and overview 13 2.2 Monte-Carlo techniques 14\n2.2.1 Random-number generation 14 2.2.2 Some standard techniques 15 2.2.3 The veto algorithm 17 2.2.4 Phase space (M-generator and RAMBO) 21\n2.3 Process-generation basics 24 2.3.1 2\u2192 2 processes 25 2.3.2 2\u2192 3 processes 26 2.3.3 Processes involving resonances 27"
        },
        {
            "heading": "II Physics content 31",
            "text": ""
        },
        {
            "heading": "3 Internal process types 31",
            "text": "3.1 Hard QCD 31\n3.1.1 Light quarks and gluons 32 3.1.2 Heavy flavours 32 3.1.3 Three-parton processes 33\n3.2 Electroweak 33 3.2.1 Prompt photon production 33 3.2.2 Weak bosons 34 3.2.3 Photon collisions 36 3.2.4 Photon-parton scattering 36 3.3 Onia 36 3.4 Top production 39 3.5 Higgs 39 3.6 Supersymmetry 40 3.7 Hidden valley 41 3.8 Dark matter 42 3.9 Other exotica 43 3.10 Couplings and scales for internal processes 44\n3.11 Handling of resonances and their decays 45 3.12 Parton distribution functions 49 3.13 Phase-space cuts for hard processes 51 3.14 Second hard process 53"
        },
        {
            "heading": "4 Parton showers 56",
            "text": "4.1 The simple shower 64\n4.1.1 Basic shower branchings 65 4.1.2 The dipole evolution 70 4.1.3 Matrix-element and other corrections 72 4.1.4 QED, electroweak and other showers 75 4.1.5 Algorithms for automated shower variations and enhanced splittings 78\n4.2 The VINCIA antenna shower 82 4.2.1 Common features 83 4.2.2 QCD showers 87 4.2.3 QED showers 92 4.2.4 EW showers 94 4.3 The DIRE shower 96 4.3.1 Phase-space coverage and ordering 96 4.3.2 Transition rates 97 4.3.3 Weight handling aspects 100"
        },
        {
            "heading": "5 Matching and merging 102",
            "text": "5.1 PYTHIA methods for leading-order multi-jet merging 106 5.2 PYTHIA methods for matching 108 5.3 PYTHIA methods for NLO multi-jet merging 109 5.4 Matching and Merging in VINCIA 110\n5.4.1 Leading-order merging 111 5.4.2 NLO matching 111\n5.5 Matching and Merging in DIRE 112"
        },
        {
            "heading": "6 Soft and beam-specific processes 112",
            "text": "6.1 Total and semi-inclusive cross sections 113\n6.1.1 Proton total cross sections 115 6.1.2 Proton elastic cross sections 115 6.1.3 Proton diffractive cross sections 117 6.1.4 Other cross sections 118 6.1.5 Low-energy processes 120\n6.2 Multiparton interactions basics 122 6.2.1 The perturbative cross section 122 6.2.2 The impact-parameter model 124 6.2.3 The generation sequence 126 6.2.4 Momentum and flavour conservation 128 6.2.5 Interleaved and intertwined evolution 129 6.2.6 Spatial parton vertices 131 6.2.7 Other MPI aspects 132 6.3 Beam remnants 133 6.3.1 Flavour structure 133 6.3.2 Colour structure 133 6.3.3 Primordial k\u22a5 134 6.3.4 Longitudinal momentum 135\n6.4 Hadron-hadron collisions 135 6.4.1 Minimum-bias and related inclusive processes 135 6.4.2 Diffractive processes 136 6.4.3 Hard diffraction 137 6.5 Lepton-lepton collisions 138 6.5.1 Bremsstrahlung and lepton PDFs 138 6.5.2 Beamstrahlung 140 6.5.3 Processes 140 6.6 Lepton-hadron collisions 141 6.6.1 Parton distribution functions and structure functions 141 6.6.2 Deep inelastic scattering 141 6.7 Photon-hadron and photon-photon collisions 143 6.7.1 Parton distribution functions of resolved photons 143 6.7.2 Photoproduction 144 6.7.3 Photon-photon collisions 147 6.7.4 Ultra-peripheral collisions 148 6.8 Heavy ion collisions 149 6.8.1 Wounded nucleons 150 6.8.2 The ANGANTYR model 150"
        },
        {
            "heading": "7 Hadronization 153",
            "text": "7.1 The Lund String model 153\n7.1.1 Selection of flavour and transverse momentum 156 7.1.2 Joining two jets in qq events 157 7.1.3 Fragmentation of systems with gluons 157 7.1.4 Hadron vertices 158 7.1.5 Junction topologies 159 7.1.6 Small-mass systems 161\n7.2 Colour reconnections 161 7.2.1 The MPI-based model 164 7.2.2 QCD-based colour reconnections 165 7.2.3 The gluon-move scheme 167 7.2.4 The SK models 168 7.2.5 Other CR models 170 7.3 String interactions and collective effects 170 7.3.1 String shoving 171 7.3.2 Rope hadronization 173 7.3.3 The thermal model 174 7.4 Hadronic rescattering 175 7.5 Bose\u2013Einstein effects 177 7.6 Deuteron production 178"
        },
        {
            "heading": "8 Particles and decays 180",
            "text": "8.1 Particle properties 181\n8.1.1 Masses 182 8.1.2 Widths 183 8.1.3 Lifetimes 185\n8.2 Decays 186 8.2.1 Hadron decays with parton showers 187 8.2.2 Inclusive hadron decays 187 8.2.3 Variable-width hadrons 189\n8.2.4 Strong decays 189 8.2.5 Electromagnetic decays 191 8.2.6 Weak decays 192 8.2.7 Helicity decays 194 8.2.8 Tau decays 195"
        },
        {
            "heading": "III Using PYTHIA 8.3 197",
            "text": "9 Using PYTHIA stand-alone 197 9.1 Installation 198 9.2 Program setup 198 9.3 Settings 199\n9.3.1 Beams and PDFs 201 9.3.2 Process selection 202 9.3.3 Soft processes 203 9.3.4 Parton- and hadron-level settings 203 9.3.5 Particle data 204\n9.4 Analysis of generated event 205 9.4.1 The Vec4 class 205 9.4.2 The Particle class 205 9.4.3 The Event class 206 9.5 Program output 206 9.5.1 Messages, warnings, and errors 207 9.6 Advanced settings examples 208 9.6.1 Matching and merging settings 208 9.6.2 Variable energies and beam particles 212 9.7 Advanced usage 213 9.7.1 User-defined settings 214 9.7.2 User hooks 214 9.7.3 Semi-internal processes and resonances 215 9.7.4 Multithreading 217 9.8 Event weight handling 219 9.8.1 Overview of process specific weights 220 9.8.2 Automatic weight variations 220 9.9 Tuning PYTHIA 221 9.9.1 Comments on the tuning procedure 222 9.9.2 The default PYTHIA 8.3 tuning: MONASH 2013 222 9.9.3 The ATLAS A14 tune 223 9.9.4 Automatic tuning approaches 223"
        },
        {
            "heading": "10 Interfacing to external programs 224",
            "text": "10.1 Generation tools 224\n10.1.1 Les Houches Accord and Les Houches Event File functionality 224 10.1.2 SLHA 230 10.1.3 LHAHDF5 232 10.1.4 LHAPDF 233 10.1.5 POWHEG 234 10.1.6 MADGRAPH5_AMC@NLO 235 10.1.7 HELACONIA 237 10.1.8 EVTGEN 238\n10.1.9 External random-number generators 239 10.2 Output formats 240\n10.2.1 HEPMC versions 2 and 3 240 10.2.2 Histograms with the YODA package 241 10.2.3 Interfacing with ROOT 241\n10.3 Analysis tools 242 10.3.1 RIVET versions 2 and 3 242 10.3.2 FASTJET 243 10.4 Computing environments 243 10.4.1 PYTHON interface 243"
        },
        {
            "heading": "IV Summary and Outlook 246",
            "text": "Appendices 249"
        },
        {
            "heading": "A Full list of internal processes 249",
            "text": "A.1 Standard model processes 249 A.2 Beyond-the-Standard-Model processes 254\nIndex 260\nList of acronyms 260\nReferences 261\nPart I\nIntroduction This manual is organized into three major parts. This first part contains introductory material about event generators in general and the basic technical details of event generation. The second part presents a more detailed description of the physics implemented inside of PYTHIA. The physics is divided according to how it appears in the program flow itself, though the lines drawn can be fuzzy: the hard process (including external calculations); parton showering; multiparton interactions; beam remnants; and hadronization. There are also dedicated sections on the DIRE and VINCIA parton showers, as well as the treatment of heavy-ion collisions. Some of the details have not been thoroughly documented before, while others have appeared in prior publications. The third part is about how the user interacts with PYTHIA. In many applications, PYTHIA is part of a code stack or work flow, with other programs calling into PYTHIA or vice versa. This part describes both basic standalone usage and documents typical interfaces in detail."
        },
        {
            "heading": "1 Preliminaries",
            "text": "PYTHIA 8.3 [1] is a scientific code library that is widely used for the generation of events in high-energy collisions between particles, where effects of the strong nuclear force, governed by Quantum Chromodynamics (QCD), are of high importance. It is written mainly in C++ and interweaves a comprehensive set of detailed physics models for the evolution from a few-body hard-scattering process to a complex multi-particle final state. Parts of the physics have been rigorously derived from theory, while other parts are based on phenomenological models, with parameters to be determined from data. Currently, the largest user community comes from the Large Hadron Collider (LHC) experimental collaborations, but the program is also used for a multitude of other phenomenological or experimental studies in astro-, nuclear, and particle physics. Main tasks performed by the program include investigations of experimental consequences of theoretical hypotheses, interpretation of experimental data \u2014 including estimation of systematic uncertainties and unfolding \u2014 development of search strategies, and detector design and performance studies. It also plays an important role as a versatile vessel for exploring new theoretical ideas and new algorithmic approaches, ranging from minor user modifications to full-fledged developments of novel physics models."
        },
        {
            "heading": "1.1 What is an \u201cevent generator\u201d ?",
            "text": "In particle physics, the outcome of a collision between two incoming particles, or of the isolated decay of a particle, is called an \u201cevent\u201d. At the most basic level, an event therefore consists of a number of outgoing particles such as might be recorded in a snapshot taken by an idealized detector, with conservation laws implying that the total summed energies and momenta of the final-state particles should match those of the initial state, as should any discrete quantum numbers that are conserved by the physics process(es) in question.\nDue to the randomness of quantum processes, the number of outgoing particles and their properties vary from event to event. The probability distributions for these properties can be inferred by studying an ensemble of events in data. Conversely, given a set of theoretically calculated (or modelled) probability distributions, it is possible to produce ensembles of simulated events to compare to data.\nA numerical algorithm that can produce (or \u201cgenerate\u201d) random sequences of such simulated events, one after the other, is called an \u201cevent generator\u201d. The simulations can be based on known or hypothetical laws of nature. This allows for the exploration and comparison of competing paradigms, and studies of the sensitivity of proposed physical observables to the differences. Only rarely do the algorithms represent exact solutions however, so a common issue is to consider whether ans\u00e4tze and approximations made, and the level of detail offered by a given modelling, are adequate for the problem at hand. The detailed physics descriptions contained in the main parts of this report are intended to assist with this task.\nReturning to the structure of a high-energy physics event, in its crudest form, it is a list of the sub-atomic particles produced in a collision along with a measure of the probability for that event to occur. In PYTHIA, the list is referred to as the \u201cevent record\u201d, and it includes the four-momentum, production point, and many other properties of each particle, cf. section 9.4 for details. It typically also includes quite a bit of history information showing intermediate stages of the event modelling. The measure of the relative probability of a given event within a sample is given by the weight of that event relative to the sum of weights for the sample. For the typical case of unweighted events, this is just the inverse of the total number of events in the sample; cases that give rise to weighted events are summarized in section 9.8. The total cross section for the sample is also computed, allowing for the conversion of relative probabilities into cross sections.\nNote that, although the starting point is often a relatively simple cross section computed in fixed-order perturbation theory, the total probability distribution for simulated events, fully differentially in all relevant phase-space variables and quantum numbers of the produced set of final-state particles, can typically not be expressed analytically. Instead, it is evaluated directly, using numerical methods, with Markov Chain Monte Carlo (MCMC) algorithms based on pseudo-random number generators as the main ingredient. The mathematical basis of the main ones used in PYTHIA is covered in section 2.2.\nThe aim of the event generator is ambitious: to predict all of the observable properties of a high-energy collision or decay process. The full properties of an event, however, cannot currently be calculated from first principles alone. Many different, complex phenomena, which are likely related, are described by a proliferation of models that each focus on a limited dynamical range. As a result, the predictions of an event generator like PYTHIA 8.3 depend upon O(100) parameters. The values of these parameters are inferred from comparisons to data. A collection of such parameter values is referred to as a tune.\nEvent-generator predictions are useful, because they serve as a proxy for what an event would look like before interacting with any measurement devices. As such, it can be used to investigate the consequences of new and old phenomena, and study the loss, mismeasurement, and misidentification of particles in experiments. Thus, it is an important tool for interpreting collider data. Event generators are realized as computer codes. In modern times, most of the larger projects are developed in the C++ programming language."
        },
        {
            "heading": "1.2 The structure of a simulated event",
            "text": "The main goal of PYTHIA is to simulate particle production in high-energy collisions over the full range of energy scales accessible to experiments, in as much detail as possible. However, hadron collisions and hadroproduction in particular are exceedingly complex, and no comprehensive theory exists currently that can predict event properties over this full range. For practical purposes, the wide range of phenomena are factored into a number of components. A natural division for these components is a time-ordering or, equivalently, an energy or transverse momentum ordering, where the best understood physics is calculated at the shortest time scales and largest energies, and the least understood physics is modelled at the longest time scales and lowest energies. This division is well motivated and often underpinned by factorization theorems, but it is not entirely unambiguous and sometimes is open to corrections.\nThe ordering in time is not completely intuitive, at least not in a directional sense from past to future. We should rather speak of time windows centred on a hard collision that then expand forwards and backwards in time, introducing successive phenomena, until we are left with a pair of incoming protons from accelerator beams, for example, and a number of outgoing particles. In momentum space, we normally speak of the \u201chardness\u201d scale that characterizes each (sub)process, and often use a measure of transverse momentum p\u22a5 to quantify this.\nFor simplicity, we will here concentrate on the sufficiently complex case of hadron-hadron collisions, with an explicit schematic of a fully simulated pp \u2192 tt event given in fig. 1. The radial coordinate illustrates hardness scales, starting with the hardest subprocess near the centre (labelled d\u03c3\u03020), and ending with stable final-state particles and the incoming beam particles at the periphery.\nIn our hardness- or time-ordered picture, the components of a high-energy collision are:\n1. A hard scattering of two partons, one from each incoming hadron, into a few outgoing particles. The initial partons are selected using parton distribution functions for the incoming hadrons, and the kinematics of the outgoing particles are based on matrix elements calculated in perturbation theory. Such calculations introduce a factorization scale and a renormalization scale. Partons with momenta below these scales are not\nMPIMPI\nd\u03c3\u03020\n\u00b7 \u00b7\n\u00b7 \u00b7\n\u00b7\u00b7 Meson Baryon\nAntibaryon\n\u00b7 Heavy Flavour\nHard Interaction Resonance Decays MECs, Matching & Merging FSR ISR* QED Weak Showers Hard Onium Multiparton Interactions Beam Remnants* Strings Ministrings / Clusters Colour Reconnections String Interactions Bose-Einstein & Fermi-Dirac Primary Hadrons Secondary Hadrons Hadronic Reinteractions\n(*: incoming lines are crossed)\nFigure 1: Schematic of the structure of a pp \u2192 tt event, as modelled by PYTHIA. To keep the layout relatively clean, a few minor simplifications have been made: 1) shower branchings and final-state hadrons are slightly less numerous than in real PYTHIA events, 2) recoil effects are not depicted accurately, 3) weak decays of lightflavour hadrons are not included (thus, e.g. a K0S meson would be depicted as stable in this figure), and 4) incoming momenta are depicted as crossed (p\u2192\u2212p). The latter means that the beam remnants and the pre- and post-branching incoming lines for ISR branchings should be interpreted with \u201creversed\u201d momentum, directed outwards towards the periphery of the figure; this avoids beam remnants and outgoing ISR emissions having to criss-cross the central part of the diagram.\nincluded in the hard scattering, but will be introduced by other stages of the event generation. In the current usage of PYTHIA, it is common to import the results of parton-level calculations from external packages, though a number of simple processes are calculated internally. Hard-scattering predictions depend on a few, universal input parameters that are determined from data, such as the value of the strong coupling at the Z boson mass and parton distribution functions.\n2. The hard process may produce a set of short-lived resonances, such as Z or W\u00b1 gauge bosons or top quarks, whose decay to normal particles has to be considered in close association with the hard process itself.\n3. Fixed-order radiative corrections may be incorporated via (combinations of) matrixelement corrections, matching, and/or merging strategies, cf. section 5. In fig. 1, the violet shaded region surrounding the hard process represents the range of scales covered by a (generic) matrix-element merging strategy active above some given p\u22a5min scale.\n4. Initial\u2013State Radiation (ISR) of additional particles (partons, photons, and others) starting from the scattering initiators using numerical resummation of soft and collinear gluon emission. This (together with its final-state equivalent below) is commonly referred to as the parton shower.\n5. Final\u2013State Radiation (FSR) of additional particles from the hard scattering itself and also from any resonance decays.\n6. In competition with ISR and FSR, further scattering processes between additional partons from the incoming beams may take place, in a phenomenon known as Multiple Parton Interactions (MPI). This is not to be confused with \u201cpileup\u201d, which generally refers to several distinct hadron-hadron collisions recorded in the same detector snapshot.\n7. At some stage after the MPIs and perhaps before resonance decays, strings begin to form, as the non-perturbative limit of colour dipoles. These dipoles, however, are typically defined by colour connections that are assigned in the Nc \u2192\u221e limit, and are not unique for Nc = 3. As discussed further in section 7.2, the associated colour-space ambiguities can be modelled via Colour Reconnection (CR). It is also possible that long-range dynamical interactions could physically alter the colour flow and/or change the configuration of the expanding strings before they fragment. Depending on the characteristic timescales involved (often not specified explicitly in simple CR models), such effects may also be referred to as colour reconnections, but could also come under the rubric of string interactions.\n8. The strong interaction now results in the confinement of QCD partons into colour-singlet subsystems known as strings or, in small-mass limiting cases, clusters. What is currently left of the incoming hadron constituents are combined into beam remnants. In fig. 1, the transition between the partonic and hadronic stages of the event generation is highlighted by the concentric annuli shaded blue.\n9. The strings fragment into hadrons based on the Lund string model. Optionally, effects of overlapping strings may be taken into account, e.g. by collecting them into so-called \u201cropes\u201d and/or allowing interactions between them.\n10. Identical particles that are close in phase space may exhibit Bose-Einstein enhancements (for integer-spin particles) or Fermi-Dirac suppressions (for half-integer-spin particles).\n11. Unstable hadrons produced in the fragmentation process decay into other particles until only stable particles remain (with some user flexibility to define what is stable).\n12. In densely populated regions of phase space, the produced particles may rescatter, reannihilate, and/or recombine with one another.\nThe introduction of heavy-ion beams introduces an additional layer of complexity wrapped around this picture. Lepton-lepton collisions are much simpler, since they do not involve many of the complications arising from hadron beams."
        },
        {
            "heading": "1.3 To what types of problems can PYTHIA be applied ?",
            "text": "PYTHIA can be applied to a large set of phenomenological problems in particle physics, and to related problems in astro-particle, nuclear, and neutrino physics. Historically, the core of PYTHIA is the Lund string model of hadronization. This model is most appropriate when the invariant masses of the hadronizing systems are above 10 GeV or so. For lower-mass systems, the model is less firmly reliable. Low-mass systems may still occur in PYTHIA, typically then\nas subsystems within a larger event, e.g., produced by heavy-flavour decays, colour reconnections, and/or hadronic rescattering. For the very lowest-mass systems, which produce just one or two hadrons, a simple cluster-style model, called ministrings, is implemented, otherwise the normal string fragmentation is applied. In addition to string hadronization, PYTHIA of course also incorporates state-of-the-art models for a wide range of other particle-physics phenomena. Here, we provide a non-exclusive list of various applications of the PYTHIA machinery.\nWe emphasize that the majority of these models are based on dedicated original work done by authors, students, and sometimes external contributors, representing a significant and sustained intellectual effort. When quoting results obtained with PYTHIA, we therefore ask that users make an effort to cite, alongside this manual, such original works as would be deemed directly relevant to the study at hand, i.e. without whose implementation in PYTHIA the study could not have been done. Appropriate references can be found throughout the manual.\n\u2022 Lepton-lepton, lepton-hadron, and hadron-hadron collisions with configurable beam properties, such as beam energies and crossing angles, to simulate one or many Standard-Model processes encoded in PYTHIA. This is the standard application of PYTHIA, but not the only one.\n\u2022 The same as above, except using parton-level configurations for the hard process input from an external source.\n\u2022 Ordinary particle decays, where the particles are produced by another physics program. This includes the limiting case of a particle gun (i.e. a single particle with user-defined momentum).\n\u2022 Beyond Standard Model (BSM) particle decays, including decay chains.\n\u2022 Resonance decays including the effects of final-state parton showering and hadronization.\n\u2022 Hadronization of (colour-singlet) partonic configurations, as may arise from ordinary or exotic particle decays.\n\u2022 Generation of Les Houches Event (LHE) formatted files from the internal hard processes for other physics studies.\n\u2022 Ion-ion collisions for ion geometries well described with a Woods-Saxon potential (nondeformed, A> 16) for p sNN > 10 GeV.\n\u2022 Astro-particle phenomena like dark-matter annihilation into Standard-Model particles.\n\u2022 User-inspired modifications of standard PYTHIA modules as allowed by the UserHooks methods and those for semi-internal processes and/or semi-internal resonances.\nAs always, caveat emptor."
        },
        {
            "heading": "1.4 Historical evolution of the PYTHIA program",
            "text": "To bring some of the main development lines into context, we here provide a brief summary of the historical evolution of the PYTHIA program and its ancestor, JETSET. Detailed descriptions of the various physics components will be found in subsequent sections, including relevant references; a more elaborate review of the historical evolution of PYTHIA can be found in [2].\nIn the late seventies the Lund group began to study strong interactions, and notably the hadronization subsequent to a collision process. A linear confinement potential was assumed\nto be realized by a string stretched out between a pulled-apart colour\u2013anticolour pair, as a simple one-dimensional representation of a three-dimensional flux tube or vortex line. In order to allow detailed studies, two PhD students were entrusted to code up this model, and also include effects such as particle decays. This program was given the name JETSET. The model and code were gradually extended to encompass more physics, in particular with reference to e+e\u2212 physics. The key addition was a model for e+e\u2212 \u2192 qqg, wherein the colour field was assumed to stretch as one string piece from the q end to the g and then as a second piece on from the g to the q end, with no direct connection between the q and q. This model received experimental support at PETRA in 1980 [3], thereby starting the success story of the Lund event generators. The idea of subdividing the full colour topology into a set of colour\u2013 anticolour dipoles rapidly prompted extensions also to other collision processes, notably to pp ones, with the PYTHIA generator built on top of JETSET. Later, it also came to develop into the dipole picture of parton showers, and to foreshadow related techniques for higher-order matrix-element calculations.\nIn part, the continued evolution was driven by interactions with the experimental communities and their priorities. An early involvement in SSC studies led to an extension of the scope of PYTHIA from QCD physics to encompass a wide selection of Standard Model (SM) processes, notably those related to Higgs-boson signatures. At the same time, QCD processes needed to be modelled better, which led to the development of new concepts, such as backwards evolution to handle initial-state radiation, and multiparton interactions and colour reconnection to describe underlying events and minimum-bias physics. When LHC physics studies began in 1990, these capabilities helped PYTHIA play a prominent role in benchmarking the evolving design of the LHC detectors, and additionally many Beyond-the-Standard-Model scenarios were included to cater to the demands of the community.\nThe Large Electron\u2013Positron Collider (LEP) became the first operating collider where JETSET had been used from the early days of detector design, and the program came to play a key role in most physics analyses carried out there. QCD phenomena were a primary focus of experimental studies, and this led to an emphasis on issues such as parton-shower algorithms and matrix-element corrections to them. The ARIADNE dipole shower [4] offered a successful alternative to the more traditional internal JETSET one. With LEP 2, the emphasis shifted from QCD towards electroweak processes such as W+W\u2212 pair production, which had already been incorporated into PYTHIA. This led, naturally, to the integration of the JETSET capabilities into PYTHIA, with PYTHIA maintaining the project name and legacy.\nAlso at HERA, the Lund-based programs came to play a prominent role from the onset, with codes such as LEPTO [5], ARIADNE and LDC [6] built on top of JETSET. Photon physics was introduced into PYTHIA to handle \u03b3p at HERA and \u03b3\u03b3 at LEP 2.\nA further area of study is heavy-ion collisions, where early on the FRITIOF [7] program came to be widely used. Some of these ideas have been revived, updated, and implemented in the PYTHIA 8.3/ANGANTYR model. It is worth noting, also, that many heavy-ion collision models, used notably at the Relativistic Heavy Ion Collider (RHIC), have been based on PYTHIA.\nThe separation above, by collider, gives one way of describing the evolution of the code(s). Underlying it is a belief in universality, that many aspects of particle collisions are the same, independent of the beam type. Therefore, physics developments made in one context can also be applied to others. This is why one single code has found such widespread use.\nThe early codes were all written in FORTRAN 77. With the CERN decision to replace that language by C++ for LHC applications, PYTHIA underwent a similar transformation in 2004 \u2013 2008. A new organizational structure was put in place for the new PYTHIA 8, in an attempt to clean up blemishes incurred during the years of rapid expansion, but deep down most of the physics algorithms survived in a new shape.\nOne area where the evolution has overtaken PYTHIA is that of matrix elements. Before it\nwas possible for most users to perform matrix-element calculations on computers, such expressions were published in articles and hard-coded from these. Now, with the physics demand for higher final-state multiplicities and higher-order perturbative accuracy, that is no longer feasible. For all but the simplest processes, we therefore rely on separate, external matrixelement codes to provide the hard interactions themselves, e.g. via the Les Houches interfaces, to which we then can add parton showers, underlying events, and hadronization. Also parton distribution functions are obtained externally, even if a few of the more commonly used ones are distributed with the code.\nThe program has continued to expand also after the transition to C++. Some developments are done from the onset within the PYTHIA code, such as the machinery for matching and merging between matrix elements and parton showers, or the PYTHIA 8.3/ANGANTYR framework for heavy-ion collisions, or the space\u2013time picture of hadronization and hadronic rescattering. Other have come by the integration of externally developed packages, such as the VINCIA and DIRE alternatives to the existing simpler parton showers already in place.\nIn total, the JETSET/PYTHIA manuals have more than 35 000 citations by now, attesting to its widespread use. That use also includes possible future projects such as ILC, FCC, CLIC and EIC. The counting of code citations does not include the numerous articles describing the development and application of the physics content in the programs. This is harder to count, with many borderline cases, but the order of magnitude is comparable with the one for the code itself."
        },
        {
            "heading": "2 Program structure and basic algorithms",
            "text": "The PYTHIA 8.3 general-purpose Monte-Carlo event generator\u2019s structure reflects the different physics descriptions and models needed to generate fully exclusive final states as they can be detected at collider experiments. The first part of this section gives a brief overview of the program structure, while the latter parts describe basics of Monte Carlo (MC) techniques and process generation employed by PYTHIA 8.3."
        },
        {
            "heading": "2.1 Program structure and overview",
            "text": "Internally, PYTHIA 8.3 is structurally divided into three main parts: process level, parton level, and hadron level. This reflects the components of an event as introduced in section 1.1.\nThe process level represents the hard-scattering process, including the production of shortlived resonances. The hard process is typically described perturbatively, with a limited number of particles, typically at high-energy scales.\nThe parton level includes initial- and final-state radiation, where various shower models are available. Multiparton interactions are also included at this stage, along with the treatment of beam remnants and the possibility of the colour-reconnection phenomenon. At the end of the parton-level evolution, the event represents a realistic partonic structure, including jets and the description of the underlying event.\nThe hadron level then takes care of QCD confinement of partons into colour-singlet systems. In PYTHIA 8.3, the hadronization is described by QCD strings fragmenting into hadrons. Furthermore, other aspects like the decay of unstable hadrons and hadron rescattering are dealt with at the hadron level. The physics models of hadronization are typically non-perturbative, and thus require modelling and the tuning of parameters. The output of the hadron level is then a realistic event as it can be observed in a detector.\nOn top of this general structure, a significant number of shared objects and cross talk is passed between these levels: PDFs are relevant in both the process level and ISR, the matching and merging machinery works on the interface between parton showers and process level, and\nthe Info object is used throughout all levels to store and access central information. Under certain circumstances, like the analysis of heavy-ion collisions using the PYTHIA 8.3/ANGANTYR model, multiple parton-level objects can be used for separate subcollisions, which are then combined for hadronization.\nFrom the user\u2019s perspective, PYTHIA 8.3 is a C++ library. The actual executable is implemented by the user, based on the requirements regarding input, output, features, and analysis, and many examples come with the PYTHIA 8.3 package. For detailed information on how to install and use PYTHIA 8.3, both standalone and with external interfaces, see part III. Figure 2 gives a rough overview of the PYTHIA 8.3 program structure."
        },
        {
            "heading": "2.2 Monte-Carlo techniques",
            "text": "Real events observed in particle colliders are stochastic. To emulate this, event generators sample from probability distributions using pseudo-random numbers. Naively, a pseudo-random number (between 0 and 1) is compared to a cumulative distribution function to determine an effect, e.g. the angle of a particle in a decay, the type of particle produced in hadronization, etc. Since real cases are rarely this simple, we use this section to describe some of the technical details of how pseudo-random numbers are used within the program."
        },
        {
            "heading": "2.2.1 Random-number generation",
            "text": "At the core of all Monte-Carlo methods lies the access to a random number generator. Truly random numbers require special equipment and are difficult to obtain at the required pace, so in practice pseudo-random numbers are used, where deterministic computer algorithms are used to emulate a random behaviour. This also allows a user of the code to reproduce a given event sample, simply by setting the same random-number seed. Nevertheless, the numbers\nmust appear to be random, e.g. evenly distributed between 0 and 1, have no detectable correlations, and have a long period before they start to repeat. Many pseudo-random number generators once thought to exhibit no internal correlations, have later been revealed to have flaws, so care is needed.\nA review of several current generators is found in [8]. Common for them is that they can be viewed as having an N -dimensional state vector x , living in a N -dimensional hypercube with periodic boundary conditions such that each number is in the range between 0 and 1. A new state is obtained by a matrix multiplication x i+1 = A\u00d7 x i , where A is a N \u00d7 N matrix of integers. There is some sophisticated theory involved in the choice of A, involving concepts such as Kolmogorov\u2013Anosov mixing and the Lyapunov exponent. Some of the key results are that A should have determinant unity, with complex eigenvalues away from the unit circle, and additionally that multiplication with it should require a minimal amount of operations so as to keep speed up.\nThe RANMAR default in PYTHIA is based on the Marsaglia\u2013Zaman algorithm [9], but implemented in double precision with N = 97. There remains some tiny correlations 97 numbers apart, which could be fixed by multiplication by A several times between each set of 97 random numbers actually used [10], but this is not a necessity for event generators, where typically one is in a completely different part of the code 97 random numbers later. The RANMAR algorithm can be initialized to run one of more than 900 000 000 different sequences, each with a period of more than 1043. By default, the same sequence is always run, which is useful for checks and debug purposes.\nThe MIXMAX alternative [11] is also provided as an option, and additionally there is an interface allowing the user to link in an external algorithm of choice."
        },
        {
            "heading": "2.2.2 Some standard techniques",
            "text": "The Monte Carlo techniques employed in PYTHIA can be generally categorized into two types. Both use pseudo-random numbers to select or reject a value for some variable based on a probability distribution. In the methods described here, the only consequence of rejecting a variable is its effect on the efficiency for generating the desired distribution. In the veto algorithm, discussed in the following section, the rejection step is a key element.\nThe task considered here is to select a value for a variable x from a known distribution function f (x) such that the probability to select x in a small interval dx around a given x is \u221d f (x)dx . We require f (x) to be non-negative in the desired x range xmin \u2264 x \u2264 xmax.\nIn the simplest case, a primitive function F(x) can be found with an inverse F\u22121(x) that can be calculated analytically. In this case, x can be sampled using the following algorithm:\n\u222b x\nxmin\nf (x)dx = R\n\u222b xmax\nxmin\nf (x)dx ,\n=\u21d2x = F\u22121(F(xmin) + R (F(xmax)\u2212 F(xmin))) . (1)\nHere, and in the following, R denotes a (pseudo-)random number, evenly distributed between 0 and 1, obtained from the random number generator (cf. section 2.2.1). If a primitive function and its inverse can be obtained, using this method is desirable, as it is the most efficient generation method possible.\nIn most cases encountered, a primitive function or its inverse cannot be found. In this case, the simplest sampling method is known as hit-or-miss. It requires knowledge of a maximum fmax of f (x) in the considered x range. The hit-or-miss method requires two numbers, x and\ny , to be chosen according to:\nx = xmin + R1 (xmax \u2212 xmin) , y = R2 fmax . (2)\nThe process is repeated until a y fulfilling y < f (x) (where x is the selected x) is selected. Equivalently, the selected x can be accepted with probability f (x)/ fmax, without the explicit construction of a y . The accepted x value is then distributed uniformly in the area below f (x). On average, the acceptance probability for x (called the efficiency) is\n\u222b\nf (x)dx\nfmax(xmax \u2212 xmin) . (3)\nThis method can also be used to estimate the definite integral of f (x) in the desired range:\n\u222b xmax\nxmin\nf (x)dx \u2248 (xmax \u2212 xmin) 1\nntry\nntry \u2211\ni=1\nf (x i) , (4)\nwhere x i runs over all x values tried, whether accepted or not. This is the principle of Monte Carlo integration. Note that there is no restriction on the dimensionality of x , so that multidimensional integrals can be handled. The error on the integral decreases like 1/ p\nntry. Other numerical integration methods usually converge faster in one dimension, but slower in higher dimensions. A variable transformation of x can be applied to increase the efficiency of the algorithm when an integrand has peaks or, in some cases, even to find an fmax to allow for the use of simple hit-or-miss.\nThe importance sampling method is related to the idea of variable transformation. This method is beneficial when a function g(x) can be found that overestimates f (x) ( f (x)\u2264 g(x)) over the considered x range and has a primitive function G(x) with an inverse G\u22121(x). Then the methods above can be combined:\nx = G\u22121(G(xmin) + R1 (G(xmax)\u2212 G(xmin))) , y = R2 g(x) . (5)\nThis is repeated until a y < f (x) is selected. Note that the first step selects (x , y) uniformly in the area below g(x), whereas the second half is to accept those that also are below f (x). Using an acceptance probability f (x)/g(x) again removes the need to introduce an intermediate y .\nIn some cases, it is not possible to find a g(x) that both covers all spikes of f (x), and also has an invertible primitive function. In such cases, a multichannel sampling method [12] can be applied. Rather than relying on a single g(x), the overestimating function is picked as a sum of non-negative functions with invertible primitives g(x) = \u2211\ni gi(x), where still f (x) \u2264 g(x) over the considered interval. Multichannel sampling then extends on the importance-sampling prescription, by using the relative size of the integrals Ii = \u222b\ngi(x)dx to each time pick a new gi for the x selection in eq. (5). The y selection and the accept/reject works as before, since it is easy to see that the weighted usage of the different gi(x) adds up to g(x).\nIn addition to the methods presented above, it should be noted that it is sometimes possible to apply a particularly ingenious transformation, to allow selection from an otherwise tricky distribution. The textbook example is the Box\u2013Muller transformation, allowing sampling from a Gaussian. While a single Gaussian exp(\u2212x2) does not have a simple primitive or inverse, the product of two do, by transforming to plane-polar coordinates:\ne\u2212(x 2+y2) dx dy = e\u2212r 2 rdr d\u03d5\u221d e\u2212r 2 dr2 d\u03d5 , (6)\nwhich gives\nx = \u00c6\n\u2212 ln R1 cos(2\u03c0R2) ,\ny = \u00c6\n\u2212 ln R1 sin(2\u03c0R2) , (7)\ni.e. two Gaussian-distributed numbers are obtained from two random ones. Another such trick is that a judicious choice of convolutions can be used to show that f (x) = xn\u22121 e\u2212x/(n\u2212 1)! can be obtained by x = \u2212\n\u2211n i=1 ln Ri = \u2212 ln \u220fn i=1 Ri ."
        },
        {
            "heading": "2.2.3 The veto algorithm",
            "text": "A broad class of stochastic evolution algorithms, including ones describing radioactive decays, parton showers, and also PYTHIA\u2019s modelling of MPI, involve the generation of ordered sequences of state changes (transitions), where the ordering parameter is typically a measure of time and/or resolution scale.\nFor probability distributions (and/or domains) that are complicated to handle analytically, the veto algorithm offers a convenient and mathematically exact approach by which simple overestimates can be used instead of the original functions that are then reimprinted via a veto step. This circumvents the need for costly and delicate numerical integrations and root finding, and the overestimating functions and domains can be tailored to the problem at hand for maximum efficiency.\nBefore describing the algorithm itself, however, let us first clear up a point of semantics. In the context of parton showers, the veto algorithm is the main way by which Sudakov form factors (see below) and related quantities are calculated. One therefore occasionally sees the phrase \u201cSudakov veto algorithm\u201d, but this risks giving the mistaken impression that Sudakov invented the veto algorithm. To avoid this, the terms \u201cveto algorithm\u201d and \u201cSudakov (form) factor\u201d are kept separate in this work, with the former referring to the broad numerical sampling method described in this section and the latter being an (important) example of a physical quantity that can be calculated with it.\nConsider a stochastic process that is ordered in some measure of evolution scale. E.g. for nuclear decay, the ordering measure could be time (in the rest frame of the decaying nucleus), while for PYTHIA\u2019s evolution algorithms, which are formulated in momentum space, the ordering is normally done in a measure of transverse momentum, from high to low. This ensures that infrared and collinear divergences of the corresponding transition amplitudes are associated with vanishing resolution scales, or equivalently with asymptotically late times in the algorithmic sense.\nStarting from a given initial value, u, for the evolution scale, the probability for the next transition (e.g. a nuclear decay, or a shower branching) to happen at a lower scale t < u, is given by\np(t|u) = f (t)\u03a0(u, t) , (8)\nwhere f (t) is the probability (sometimes called the \u201cnaive\u201d probability) for a transition to occur at the scale t under the implicit condition that the state still exists at t. The latter is made explicit by the survival probability, \u03a0(u, t) \u2208 [0, 1], which represents the probability that the state remains unchanged over the interval [u, t]. Analogously to nuclear decay, \u03a0(u, t) is given by a simple exponential of the integrated naive transition rate,\n\u03a0(u, t) = exp \u2212 \u222b u\nt d\u03c4 f (\u03c4) , (9)\nsuch that\np(t|u) = \u2202\u03a0(u,\u03c4) \u2202 \u03c4 \u03c4=t . (10)\nThe survival probability \u03a0(u, t) is often referred to as the Sudakov form factor. We note that the two are only strictly identical for final-state showers, while for initial-state showers they are related via ratios of parton distribution functions, and in the context of MPI one can really only talk about a Sudakov-like factor. In this section, only the survival probability itself, which we denote by \u03a0(u, t), will be of interest.\nIt is worth pointing out that the ordered probability density p(t|u) remains well-behaved and bounded by unity even if the integrated naive transition rate exceeds unity. In fact, due to the aforementioned collinear and soft singularities, f (t) typically diverges for t \u2192 0, in which case the total probability for at least one-state change becomes\n\u222b u\n0\nd\u03c4 p(\u03c4|u) = 1\u2212 exp (F(0)\u2212 F(u))\u2192 1 . (11)\nThat is, since F(0)\u2192\u2212\u221e for a divergent kernel, the probability for at least one-state change simply saturates at unity. This reflects the unitarity of the shower algorithm, which is also manifest in eq. (10). If the naive probability does not diverge, or if the evolution is stopped at a finite cutoff tcut > 0, then there is a non-zero probability, given by \u03a0(u, tcut), to have no state change at all.\nStarting from eq. (8), probabilities for two or more ordered transitions can easily be constructed as well, e.g. for two successive branchings with t < u< v:\nP(t|u|v) = f2(t) f1(u)\u03a02(v, u)\u03a01(u, t) , (12)\nwhere f1(u) is the naive transition rate at the scale of the \u201cfirst\u201d transition, and that of the \u201csecond\u201d transition is f2(t). Note that we do not assume f1 = f2 since the state undergoes a change at the intermediate scale \u03c4 = u (and the phase space is generally also different). This is also emphasized by the presence of two separate survival probabilities with different subscripts instead of a single combined \u03a0(v, t).\nWe now turn to how to actually sample from eq. (8). The branching kernel f (t) is typically not simple enough to allow for the use of inversion sampling as described in the previous section. Fortunately, the veto algorithm [13\u201317] (and its antecedents, see the \u201cthinning algorithm\u201d [18, 19]) enables sampling from eq. (8) in a quite efficient and flexible manner. This algorithm relies on the existence of an overestimating \u201ctrial\u201d function g(t)\u2265 f (t) that is simple enough for samples to be drawn from eq. (8) directly, with f replaced by g. A flowchart representation of the veto algorithm in its simplest form is shown in fig. 3.\nTo confirm that this algorithm produces eq. (8), we follow along and write out its probability distribution q(t|u) to find\nq(t|u) = \u222b u\n0\ndt \u2032g(t \u2032)\u03a0g(u, t) f (t \u2032) g(t \u2032) \u03b4 t \u2212 t \u2032 + 1\u2212 f (t \u2032) g(t \u2032) p t|t \u2032 , (13)\nwhere the first term describes the probability to accept the proposed trial scale t \u2032, and the second term gives the probability to reject the trial scale. Note that eq. (13) explicitly displays the Markovian nature of the veto algorithm, with every recursive step only depending on the previous one. Equation (13) may be solved by considering the differential equation\n\u2202\n\u2202 u q(t|u) = f (u)\u03b4(t \u2212 u)\u2212 f (u)q(t|u) , (14)\nwhich is found by application of Leibniz\u2019s rule for differentiation to eq. (13). We can find a solution by using an ansatz q(t|u) = q\u0302(t|u)e\u2212F(u), which after integration leads to\nq(t|u) = f (t)\u03a0 f (u, t)\u0398(t \u2212\u03c3) + q0(t,\u03c3) . (15)\nThe scale \u03c3 in the step function \u0398(t \u2212\u03c3) and the function q0 appear because information is lost in converting eq. (13) to eq. (14), but they are easily understood by reconsidering the structure of the algorithm. Mathematically, no other scale \u03c3 was introduced at any point, so eq. (15) cannot depend on it. As a result, \u03c3 must equal zero and the function q0 must vanish, recovering eq. (8). In practice, however, the infrared cutoff on the shower evolution does introduce a scale \u03c3. In that case, the algorithm shown in fig. 3 is stopped whenever t drops below\u03c3. The function q0 then represents the superfluous probability of sampling a scale below the cutoff, which is not associated with any change of state.\nMany extensions of the veto algorithm are possible and are often used, of which we only discuss a few. Further details may be found in [13,15\u201317,20].\nOne can replace the acceptance probability f (t)/g(t) by some other r(t) \u2208 [0, 1] and compensate by modifying the event weight by a multiplicative factor f (t)/g(t)r(t) in case the scale is accepted and (1\u2212 f (t)/g(t))/(1\u2212r(t)) in case it is rejected. Writing out the probability distribution again, we find\nq(t|u) = \u222b u\n0\ndt \u2032g(t \u2032)\u03a0g(u, t \u2032) r(t \u2032)\u03b4 t \u2212 t \u2032 f (t \u2032)\ng(t \u2032)r(t \u2032) +\n1\u2212 r(t \u2032) p t|t \u2032 1\u2212 f (t \u2032)/g(t \u2032)\n1\u2212 r(t \u2032)\n,\n(16) where the weights appear as multiplicative factors. It is then straightforward to see that eq. (16) reduces to eq. (13). This modification enables sampling from eq. (8) in cases where it is difficult to find a g(t) \u2265 f (t), or even in cases where f (t) may be negative. However, in both cases events with negative weights will appear.\nApplying eq. (16), shower uncertainties can be efficiently incorporated as event weights. In that case, r(t) represents the baseline acceptance probability, while f (t) is a modified branching kernel that parameterizes the uncertainties through variations of the renormalization scale, its non-singular components, or choice of parton distribution function for initial state showers. If g(t) overestimates both the baseline and the modified branching kernels, the event weights stay positive. This is also the basis for generating biased emissions of rare splittings. More details can be found in section 4.1.5.\nWe complete this section by discussing some variations of the veto algorithm in the context of competition between channels. In most cases, multiple branching kernels fi(t) contribute to the total parton-shower probability distribution, which may then be written as\np\u0303(t|u) = f\u0303 (t)\u03a0 f\u0303 (t, u) where f\u0303 (t) = n \u2211\ni=1\nfi(t) . (17)\nOne way to handle competition is to apply the veto algorithm to all channels individually, and then select the channel with the highest scale t i . A flowchart representation of this procedure is shown in fig. 4.\nIt may be shown to yield eq. (17) as follows: n \u220f\ni=1\n\u222b u\n0\ndt i fi(t i)\u03a0 fi (u, t i)\nn \u2211\nj=1\n\u220f\nk 6= j\n\u0398 t j \u2212 tk \u03b4 t \u2212 t j\n= n \u2211\ni=1\n\n\n\u220f\nj 6=i\n\u222b t i\n0\ndt j f (t j)\u03a0 f j (u, t j)\n\n\n\u222b u\n0\ndt i fi(t i)\u03a0 fi (u, t i)\u03b4 (t \u2212 t i)\n= n \u2211\ni=1\nfi(t)\u03a0 fi (u, t) \u220f\nj 6=i\n\u03a0 f j (u, t) = p\u0303(t|u) . (18)\nEquivalently, the result of eq. (18) may be used with overestimates gi(t i) in place of fi(t i), then selecting the highest scale before proceeding to the acceptance step. A flowchart representation of this procedure is shown in fig. 5, and produces the same result. This algorithm is used to interleave initial-state and final-state radiation with multiple parton interactions. Furthermore, it is more efficient when branching-kernel evaluation is expensive, such as for matrix-element corrections. A third option is available, where instead a single scale is drawn according to the sum of overestimates g\u0303(t) and a channel is selected with probability gi(t)/ g\u0303(t) for the acceptance step. A flowchart representation of this procedure is shown in fig. 6 and again produces eq. (17). This procedure is used in a few specific places, in particular when the overestimates of several channels are very similar. Examples include quark-flavour\nselection in g\u2192 qq splittings and the efficient sampling of the large number of branchings in VINCIA\u2019s Electroweak (EW) shower. It is important to note that these algorithms may also be combined, for instance by grouping several channels for use with the algorithm depicted in fig. 6, and further combining them with the algorithms depicted in fig. 4 or fig. 5. In fact, the different shower models available in PYTHIA often use different procedures to optimize code structure and performance."
        },
        {
            "heading": "2.2.4 Phase space (M-generator and RAMBO)",
            "text": "One standard task is to distribute the momenta of final-state particles uniformly according to Lorentz Invariant Phase Space (LIPS), on top of which then later dynamical aspects can be added. (Non-uniform sampling methods, used e.g. when resonances are present, are discussed separately, in section 2.3.) The relevant phase-space density is\nd\u03a6n(P; p1, p2, . . . , pn) = (2\u03c0) 4 \u03b4(4)\nP \u2212 n \u2211\ni=1\npi\nn \u220f\ni=1 d3pi (2\u03c0)3 2p0i , (19)\nwhere P is the total four-momentum, and pi , i \u2265 1 are the n different outgoing four-momenta. Usually the process is initially considered in the rest frame of the system, P = (M ;0), and later boosted to the relevant frame of the whole event.\nA common special case is two-body final states, where the Centre of Mass (CM)-frame expression reduces to\nd\u03a62 = |p|\n16\u03c02M d\u2126= |p| 16\u03c02M d cos\u03b8 d\u03d5 . (20)\nThat is, the direction of one of the outgoing particles has to be picked uniformly on the unit sphere, with the other moving out in the opposite direction. The three-momentum length is\n|p|= |p1|= |p2|=\nq\n\u03bb M2, m21, m 2 2\n2M , (21)\nwhere the K\u00e4ll\u00e9n \u03bb function can be written in a number of equivalent ways\n\u03bb(a2, b2, c2) = a4 + b4 + c4 \u2212 2a2 b2 \u2212 2a2c2 \u2212 2b2c2\n= (a2 \u2212 b2 \u2212 c2)2 \u2212 4b2c2\n= (a2 \u2212 (b+ c)2)(a2 \u2212 (b\u2212 c)2) = (a+ b+ c)(a\u2212 b\u2212 c)(a\u2212 b+ c)(a+ b\u2212 c) . (22)\nThe energies are given by\np01 = q m21 + p2 = M2 +m21 \u2212m 2 2\n2M ,\np02 = q m22 + p2 = M2 +m22 \u2212m 2 1\n2M . (23)\nFor three or more final particles, PYTHIA implements two different generic methods, the older M-generator [21] and the newer RAMBO [22] one, but approaches tailor made for the specific situation are also common, e.g. in parton showers. RAMBO is the best choice for the case of massless products, whereas the situation is less obvious once the masses constitute a significant fraction of the full energy.\nThe basic idea of the M-generator strategy is to view the full event as arising from a sequence of fictitious two-body decays. Thus a four-body decay 0\u2192 1+2+3+4, as an example, is viewed as a sequence 0\u2192 123+4\u2192 12+3+4\u2192 1+2+3+4, where 123 and 12 represent intermediate states. By a suitable insertion of a unit factor\n1= \u03b4(4)(p12 \u2212 p1 \u2212 p2)d4p12\u03b4(m212 \u2212 p 2 12)dm 2 12 = \u03b4 (4)(p12 \u2212 p1 \u2212 p2) d3p12 2p012 dm212 , (24)\nand a similar one for p123, the four-body phase space can be reformulated as\nd\u03a64 P; p1, p2, p3, p4 \u221d d\u03a62 P; p123, p4 dm2123 d\u03a62 (p123; p12, p3) dm 2 12 d\u03a62 (p12; p1, p2) .\n(25) The mass-dependent parts can be collected and simplified to\nq\n\u03bb(m20, m 2 123, m 2 4)\nm0 dm123\nq\n\u03bb(m2123, m 2 12, m 2 3)\nm123 dm12\nq\n\u03bb(m212, m 2 1, m 2 2)\nm12 . (26)\nThe (m123, m12) phase space can easily be sampled within allowed borders, but the rest of the expression then becomes a weight that has to be taken into account by hit-and-miss Monte Carlo. This is where the algorithm can be slow. Once the intermediate masses have been selected, two-particle kinematics are constructed in a sequence of rest frames for 1+2, 12+3 and 123+ 4, interleaved with Lorentz boosts between them.\nThe RAMBO algorithm provides an alternative sampling of n-body phase space, which by construction has constant (uniform) weight for arbitrary n in the massless limit. The starting point is the following identity for massless four-vectors,\n\u222b d4q\u03b4(q2)exp(\u2212q0) = \u222b \u221e\n0\nq0\n2 exp(\u2212q0)\n\u222b\nd\u2126= 2\u03c0 . (27)\nA four-momentum q distributed according to the integrand of the left-hand side of this identity can be generated via the steps\nq0 = \u2212 log(R1R2), cos\u03b8 = 2R3 \u2212 1, \u03d5 = 2\u03c0R4 , (28)\n=\u21d2 q = (q0, q0 sin\u03b8 sin\u03d5, q0 sin\u03b8 cos\u03d5, q0 cos\u03b8 ) . (29)\nRAMBO repeats this process n times to produce a set of momenta qi that initially have \u2211\ni q \u00b5 i \u2261 Q \u00b5. The final momenta pi are then constructed by applying a boost \u039b \u00b5 \u03bd to the CM frame of Q and scaling by an overall factor x = M/ p\nQ2, so that P\u00b5 \u2261 \u2211\np\u00b5i = x(\u039b \u00b5 \u03bdQ\u03bd) = (M ,0).\nTo illustrate that this leads to momenta distributed according to eq. (19), we may start from n multiples of eq. (27) and unitarily transform the momenta as\n(2\u03c0)n = n \u220f\ni=1\n\u222b\nd4qi \u03b4(q 2 i )exp(\u2212q 0 i )\n\u00d7 d4Q\u03b44 Q\u2212 n \u2211\ni=1\nqi d x \u03b4\nx \u2212 M p\nQ2\n\u00d7 n \u220f\ni=1\nd4pi \u03b4 4(pi \u2212 x (\u039bqi)) . (30)\nIdentifying the phase-space measure eq. (19) in eq. (30) and integrating over the other variables then leads to\n\u222b\nd\u03a6n(P; p1, p2, . . . , pn) = \u03c0\n2\nn\u22121 M2n\u22124\n(n\u2212 1)!(n\u2212 2)! , (31)\nwhich is indeed the n-body massless phase-space volume [22]. RAMBO thus samples the massless phase space isotropically, with constant weight given by eq. (31).\nFor massive particles, no equivalent general expression for the phase-space volume exists. However, the massless RAMBO algorithm may be adapted to the massive case at the cost of introducing variable event weights, which translates to a reduced efficiency at the unweighted level. Starting from the massless momenta pi , massive momenta ki are obtained through\nki = ypi , k 0 i =\nq\n|ki|2 +m2i . (32)\nThe momenta ki are on-shell and preserve momentum conservation as long as the rescaling parameter y is given by the solution of the equation\nn \u2211\ni=1\nq\ny2|pi|2 +m2i = M . (33)\nSince eq. (33) is a monotonic function of y with a solution 0 \u2264 y \u2264 1, the value of y may be determined easily using the Newton\u2013Raphson method. Through a similar procedure as the one followed in eq. (30), the event weight may be determined to be\nw= \u03c0\n2 n\u22121 1 (n\u2212 1)!(n\u2212 2)!\nn \u220f\ni=1 |ki| k0i\nn \u2211\nj=1\n|k j|2\nk0j\n!\u22121 n \u2211\nj=1\n|k j|\n!2n\u22123\n, (34)\nwhich is bounded from above by the massless weight, eq. (31), so that the distribution can be unweighted by accepting the generated massive phase-space point with the probability\nPaccept =\n<1 \ufe37 \ufe38\ufe38 \ufe37\nn \u220f\ni=1 |ki| k0i\n\n \n\u2211\nj |k j| \u2211\nj |k j |2\nk0j\n\n \n<1 \ufe37 \ufe38\ufe38 \ufe37\n\u2211\nj |k j|\nM\n2n\u22124\n, (35)\nwhich (by construction) tends to unity in the massless limit."
        },
        {
            "heading": "2.3 Process-generation basics",
            "text": "Particle-physics cross sections can crudely be divided into two categories: perturbative and non-perturbative. Both kinds of processes play crucial roles in PYTHIA. The former can be computed order by order in perturbation theory, e.g. based on Feynman-diagram rules. For the electroweak sector, the couplings are sufficiently small that higher-order corrections should offer a rapidly converging series. The exception is the enhanced emission of soft or collinear photons, but this is a well-understood issue. For the strong sector, on the other hand, the large \u03b1s coupling leads to a slower convergence. It can still work well for QCD processes involving large momentum transfers. In the opposite limit, at low momentum transfers, the perturbative coupling diverges and perturbation theory breaks down. Therefore the total cross section in hadron-hadron collisions, which is dominated by such low scales, can only be described in terms of effective, phenomenological models. The same applies for its main components \u2014 elastic, diffractive and nondiffractive cross sections \u2014 which therefore are classified as nonperturbative processes.\nIn the current section, the focus will be on perturbative processes, introducing how these are defined and generated inside PYTHIA. Non-perturbative processes are discussed separately in section 6. There are also components that partly bridge the gap between the two, such as multiparton interactions (MPIs), hard diffraction, and photoproduction processes. These are also discussed in section 6, along with further aspects specific to simulating cross sections in heavy-ion collisions.\nTo begin the discussion of perturbative process generation, consider a process a+ b\u2192 fn, where a and b are two incoming particles that together create a final state f consisting of n particles. The differential cross section can then be written as\nd\u03c3\u0302 d\u03a6n = |M|2 2 q \u03bb(s\u0302, m2a, m 2 b) \u2248 |M|2 2s\u0302 , (36)\nwhere s\u0302 = (pa+ pb)2 is the squared invariant mass of the collision system. Usually ma and mb are negligible in comparison with p s\u0302, and then the last expression is obtained. The processspecific physics is encapsulated in the matrix element M, which we shall assume can be calculated perturbatively. The |M|2 expression also has to be averaged over incoming spin and colour configurations, and summed over outgoing spin and colour configurations, where relevant.\nIn some rare cases a and b are the actual incoming beam particles. Normally, however, a and b are constituents of the true beam particles, A and B. Then one needs to introduce parton distribution functions (PDFs), f Aa (x ,Q 2) (and f Bb (x ,Q 2)), that to leading order describe the probability to find a parton a inside the particle A, with a fraction x of the particle fourmomentum, if the hard-collision process probes the particle at a (factorization) scale Q2. The cross section then reads\n\u03c3 =\n\u222b\ndx1 f A a (x1,Q 2)\n\u222b\ndx2 f B b (x2,Q 2)\n\u222b\nd\u03c3\u0302(s\u0302,Q2) d\u03a6n d\u03a6n , (37)\nwhere s\u0302 = x1 x2s , with s = (pA+ pB) 2 . (38)\nThe nature of the PDFs varies depending on what kind of particle is concerned: hadrons, nuclei, leptons, photons, or pomerons. They will therefore be discussed further in the respective beam context. The most commonly used and best studied are the proton PDFs, cf. section 3.12, and for these we will omit the A and B superscripts."
        },
        {
            "heading": "2.3.1 2\u2192 2 processes",
            "text": "Massless Kinematics: In a massless 2 \u2192 2 subprocess a(p1) + b(p2) \u2192 c(p3) + d(p4) it is conventional to write the cross section in terms of the Mandelstam variables\ns\u0302 = (p1 + p2) 2 = (p3 + p4) 2 , (39) t\u0302 = (p1 \u2212 p3)2 = (p2 \u2212 p4)2 = \u2212 s\u0302 2 (1\u2212 cos \u03b8\u0302 ) , (40) u\u0302= (p1 \u2212 p4)2 = (p2 \u2212 p3)2 = \u2212 s\u0302 2 (1+ cos \u03b8\u0302 ) , (41)\nwhere \u03b8\u0302 is the scattering angle, defined as the polar angle of particle 3, in the rest frame of the collision. Since d\u03a62 \u221d dcos \u03b8\u0302 \u221d d t\u0302 (assuming a trivial flat \u03d5 dependence, as is the case unless the incoming beams are transversely polarized), it is common to recast eq. (37) accordingly. Furthermore, dx1 dx2 = d\u03c4dy , where \u03c4 = x1 x2 = s\u0302/s and y = (1/2) ln(x1/x2). It is also standard to use x f (x) rather than f (x). In total this gives\n\u03c3 =\n\u222b\u222b\u222b\nd\u03c4 \u03c4 dy d t\u0302 x1 f A a (x1,Q 2) x2 f B b (x2,Q 2) d\u03c3\u0302(s\u0302, t\u0302,Q2) d t\u0302 . (42)\nThe u\u0302 variable is redundant since s\u0302 + t\u0302 + u\u0302 = 0, but often symmetry properties of matrix elements are apparent if it is used judiciously. In a frame where a and b come in back-to-back, moving in the \u00b1z directions, p\u03022\u22a5 = t\u0302 u\u0302/s\u0302 is the squared transverse momentum of the outgoing c and d. A frequent choice is to put Q2 = p\u0302\u22a5 as the factorization scale.\nThe sampling ranges for each of the (\u03c4, y, t\u0302) variables depends on whether phase-space cuts are imposed at the process-generation level, cf. section 3.13. Generically, they are:\ns\u0302min s < \u03c4 < s\u0302max s , (43)\n\u2212 1 2 | ln\u03c4|< y(\u03c4) < 1 2 | ln\u03c4| , (44)\n\u221a \u221a \u221a\n1\u2212 4p\u03022\u22a5max \u03c4s < |z(\u03c4)|<\n\u221a \u221a \u221a\n1\u2212 4p\u03022\u22a5min \u03c4s , (45)\nwhere t\u0302 has been replaced by z = cos \u03b8\u0302 via eq. (40), and we emphasize that there are solutions for both positive and negative z. The phase-space boundaries are set via the (user-specifiable) parameters m\u0302min,max, p\u0302\u22a5min,max, and/or Q\u03022min, cf. section 3.13. To give some examples:\n\u2022 For processes containing an s-channel resonance, it may be desirable to only generate phase-space points within a specific range of m\u0302 values. Processes involving resonance production and decay are discussed in more detail in section 2.3.3.\n\u2022 A restriction like p\u0302\u22a5 > p\u0302\u22a5min, implying s\u0302min = max(m\u03022min, 4p\u0302 2 \u22a5min), is mandatory for\nmatrix elements that diverge in the p\u0302\u22a5 \u2192 0 limit; this includes in particular massless t-channel QCD processes. It may also be convenient for studies focusing on the high-p\u22a5 tail of \u201chard\u201d 2\u2192 2 processes.\n\u2022 The option to specify a Q2min value is intended for t-channel DIS-type processes with distinguishable final-state particles, cf. section 3.13, in which case s\u0302min \u2265Q2min and z(\u03c4)\u2264 1\u2212 2Q2min/(\u03c4s).\nThe selection of phase-space points (\u03c4, y, z) is described in detail in [14], and remains unchanged. The basic strategy is to use multichannel sampling in each of the three variables\nseparately. Thus, for instance, the \u03c4 dependence is modelled as a mix of sampling according to either 1/\u03c4 or 1/\u03c42. The normalization factors of the two possibilities are determined at initialization, and would depend on the process, the choice of PDFs and \u03b1s, and the p\u22a5min cut. That way an upper envelope is found for the real cross-section expression. The probability that a trial phase-space point is retained is given by the ratio of the full differential cross section to the multichannel overestimate, and the accepted events are assigned a standard weight of unity. There is always the risk that the intended upper estimate of the cross section is exceeded by the full expression in some corner of phase space, even if it is not common. Such points are associated with a weight correspondingly above unity.\nThe cross section for a process is obtained in parallel with the generation of events, using the multidimensional generalization of eq. (4). Thus the error decreases with the number of events generated.\nWhen several processes are to be generated simultaneously, an upper envelope is found for each differential cross section separately. The size of integrated envelopes, i.e. the upper estimate of the respective cross sections, is used as a relative weight when the next process is selected. If the trial phase-space point is rejected then a new process choice is made. That is, a larger overestimate will make a given process more likely to be picked, but then afterwards also more likely to be rejected. In the end, all processes are generated in proportion to their correct integrated cross sections.\nGeneration in (\u03c4, y, z) is only one possible choice. It has the advantage that additional \u03c4 terms can be used for the sampling of resonances in the cross section, cf. section 2.3.3. For the generation of MPIs, however, it is essential to use p\u03022\u22a5 rather than t\u0302, cf. section 6.2. Then one may instead note that\ndx1 x1 dx2 x2 d t\u0302 = d\u03c4 \u03c4 dy d t\u0302 = dy3 dy4 dp\u0302 2 \u22a5 , (46)\nwhere y3 and y4 are the rapidities of the two outgoing particles.\nMassive Kinematics: So far we have considered massless kinematics. It is quite common to have cases where one or both of the outgoing particles are massive, while the incoming ones still are assumed massless. In some cases, such as elastic scattering, both incoming and outgoing masses need to be taken into account. The fully general t\u0302 expression is\nt\u0302 = \u2212 s\u03022 \u2212 s\u0302(m21 +m 2 2 +m 3 3 +m 2 4) + (m 2 1 \u2212m 2 2)(m 2 3 \u2212m 2 4)\u2212\nq\n\u03bb(s\u0302, m21, m 2 2)\u03bb(s\u0302, m 2 3, m 2 4) cos \u03b8\u0302\n2s\u0302 ,\n(47) with u\u0302 obtained by m23\u2194 m 2 4 and cos \u03b8\u0302 \u2192\u2212 cos \u03b8\u0302 , resulting in\ns\u0302+ t\u0302 + u\u0302= m21 +m 2 2 +m 3 3 +m 2 4 . (48)\nThe limits t\u0302min < t\u0302 < t\u0302max (all negative or, for t\u0302max, zero) are obtained for cos \u03b8\u0302 = \u22131. Often t\u0302max is close to zero and a numerically safer recipe for it is obtained by noting that\nt\u0302min t\u0302max = (m 2 3 \u2212m 2 1)(m 2 4 \u2212m 2 2) +\n(m21 +m 2 4 \u2212m 2 2 \u2212m 2 3)(m 2 1m 2 4 \u2212m 2 2m 2 3)\ns\u0302 . (49)\nIf m21 = m 2 2 = 0 then t\u0302min t\u0302max = m 2 3m 2 4 and p\u0302 2 \u22a5 = ( t\u0302 u\u0302\u2212m 2 3m 2 4)/s\u0302."
        },
        {
            "heading": "2.3.2 2\u2192 3 processes",
            "text": "In pure s-channel 2\u2192 3 processes, say (unpolarized) e+e\u2212\u2192 \u03b3\u2217/Z\u2192 qqg, cross sections factorize into production and decay steps, and the decay phase space is easy to generate in terms\nof two energy variables and three angles. Such decays are not coded as explicit hard processes, however, but instead are handled during the parton-level shower evolution. Three-body final states such as e+e\u2212 \u2192 \u03b3\u2217/Z\u2192 qqg are then reached via showering from e+e\u2212 \u2192 \u03b3\u2217/Z\u2192 qq (cf. section 2.3.3 on resonances and section 4 on parton showers), with matrix-element corrections applied to the extent available and switched on, cf. section 5.\nFor 2\u2192 3 hard processes that do not factorize into resonance production and decay plus shower, it becomes much more messy to set up phase space, since there are more possibilities for peaks in different places. PYTHIA does not have a general-purpose machinery to handle generic cross sections. Instead, the main assumption is that such processes are provided via the Les Houches accord, cf. section 10.1.1, from external programs that have their own phasespace generators.\nThere are a few internal 2\u2192 3 processes, however, for very specific tasks. These are generated according to one of three different prescriptions, tailored to the squared amplitudes for massless QCD 2\u2192 3 processes, Vector Boson Fusion (VBF), and central diffractive processes, respectively. These were developed separately and employ somewhat different notation in the code, here relabelled for clarity. Note that all three assume a cylindrical symmetry with respect to the collision axis.\nMassless QCD a(p1)+b(p2)\u2192 c(p3)+d(p4)+e(p5) cross sections contain divergences when any of the final-state particles become collinear to the beam, collinear to each other, and/or soft. It is therefore important to choose a set of phase-space variables that allows for the isolation of these singularities. The parameterization used in PYTHIA is (y3, y4, y5, p2\u22a53, p 2 \u22a54,\u03d53,\u03d54). The rapidity sampling here is simple and consistent, while the p\u22a5 selection is not, unfortunately. The p\u22a55 is fixed opposite to the vector sum of the other two, and in the first instance gets a different p\u22a5 spectrum than them. Notably, a requirement for all p\u22a5 > p\u22a5min can be imposed with full efficiency for two, but is inefficient for the third. It is also important to avoid the collinear singularity by an additional cut on R= p\n(\u2206y)2 + (\u2206\u03d5)2 for all outgoing pairs. A process of special interest is vector-boson fusion to a Higgs boson, W+W\u2212\u2192 H and ZZ\u2192 H (and/or W+W+ \u2192 H++ in some BSM scenarios). Since the bosons are emitted from fermion lines this results in 2\u2192 3 processes of the character f1(p1) + f2(p2)\u2192 f3(p3) + f4(p4) +H(p5). The variables chosen in this case are (\u03c4, y, y5, p2\u22a53, p 2 \u22a54,\u03d53,\u03d54). Here, special care is taken in the modelling of p2\u22a53 and p 2 \u22a54 which, unlike the QCD cross sections, have no p\u22a5\u2192 0 divergence but instead are fairly flat out to the gauge-boson mass. Note that the physics of the process here naturally singles out the Higgs p\u22a5 as having a different shape than the other two, again different from the QCD case. The same machinery is also used for heavy-quark fusion to Higgs, qq\u2192 QQH and gg\u2192 QQH, where top masses are selected with a Breit\u2013Wigner shape.\nAnother special case is central diffraction, e.g. p(p1)+p(p2)\u2192 p(p3)+p(p4)+X (p5), where X is the central diffractive system. Here sampling in t1 = (p1\u2212p3)2 and t2 = (p2\u2212p4)2 is crucial to impose an exponential fall-off in these variables. The energy fractions x1 and x2 taken from the incoming proton defines m2X = p 2 5 = x1 x2s in the collinear limit t1, t2 \u2192 0. Away from it also the \u03d53 and \u03d54 angles play a role, and one requires a more elaborate definition of x1 and x2."
        },
        {
            "heading": "2.3.3 Processes involving resonances",
            "text": "The term \u201cresonance\u201d has a specific meaning in PYTHIA and refers to particles whose decays are considered to be part of the hard process. This enables PYTHIA to modify the total calculated cross section depending on which decay channels are open or closed (including effects of sequential decays, such as t \u2192 bW+ followed by W+ \u2192 e+\u03bde), and also provides a natural framework for incorporating process-specific aspects such as spin correlations and/or finite-width effects. Here, we focus aspects of phase-space generation common to all processes involving resonances. Details on cross-section considerations, process-specific features,\nand some further sophistications are explained in section 3.11, while user implementations of \u201csemi-internal\u201d resonances is described in section 9.7.3, and the handling of SUSY Les Houches Accord (SLHA) decay tables is covered in section 10.1.2.\nWe focus first on the simplest treatment available in PYTHIA, with partial widths and branching fractions fixed to their on-shell values. Technically, in the code this corresponds to decay channels that are assigned meMode = 100. Values of 101, 102, and 103 additionally include some simple kinematic threshold effects, also discussed below. Lastly, we emphasize that the default treatment often goes further than this, with most decay modes of SM resonances (and some BSM ones) assigned meMode = 0 implying the use of dedicated matrix-element expressions for branching fractions that can vary over a reasonably broad resonance peak; this is covered separately in section 3.11; see further section 9.7.3 for user implementations of such expressions.\nStarting from a cross section computed in the zero-width approximation, i.e. for stable final-state resonances, the simplest shape modelling available in PYTHIA is a relativistic Breit\u2013 Wigner substitution of the type\n1=\n\u222b\n\u03b4(m2 \u2212m20)dm 2\u2192\n\u222b m2max\nm2min\n1 \u03c0 m0\u03930 (m2 \u2212m20)2 +m 2 0\u0393 2 0 dm2 , (50)\nfor each final-state resonance, where m0 and \u03930 are the nominal (on-shell) mass and widths of the resonance, respectively, and m is allowed to vary in a range m \u2208 [mmin, mmax] that can be specified individually for each resonance in PYTHIA\u2019s particle data table. Note that choosing a small range will reduce the total cross sections accordingly.\nThe phase-space integral in eq. (42) is then extended to include integrations over m2 for each resonance, and the sampled values1 for these masses are used instead of the on-shell ones in the evaluation of d\u03c3\u0302/d t\u0302 and also in the relations between kinematic variables such as between t\u0302 and cos \u03b8\u0302 . This offers a crude level of approximation to the expected mass dependence of the full cross section, at least in the vicinity of the resonance(s) where the resonant amplitudes can still be assumed to dominate over any (non-resonant) background processes.\nA complication arises for processes that involve pair production of the same kind of particle, such as tt, W+W\u2212, or Z0Z0 production. For such processes, on-shell matrix elements are phrased in terms of a single pole-mass value, while the procedure above produces two different values, m3 and m4. For the specific case of double-vector-boson production, PYTHIA uses 4-fermion matrix elements that include the full mass dependence (as well as the full \u03b3\u2217/Z interference). However, for more general processes involving two of the same kind of resonance (such as tt production), the choice made in PYTHIA is to use an average squared mass,\nm\u03042 = m23 +m 2 4 2 \u2212 (m23 \u2212m 2 4) 2 4s\u0302 , (51)\nwhich is defined so that (s\u0302, m23, m 2 4) and (s\u0302, m\u0304 2, m\u03042) correspond to the same CM-frame threemomenta,\n|p\u2217(s\u0302, m\u03042, m\u03042)|2 = |p\u2217(s\u0302, m23, m 2 4)| 2 = 1 4s\u0302 s\u0302\u2212 (m3 +m4)2 s\u0302\u2212 (m3 \u2212m4)2 . (52)\nAnalogous modified values for the t\u0302 and u\u0302 variables are defined to correspond to the same\n1See [14, sec. 7.4.2] for details on the sampling procedure.\nCM-frame scattering angle,\n\u00af\u0302t = t\u0302 \u2212 (m23 \u2212m 2 4) 2\n4s\u0302 = \u2212 1 2 s\u0302\u2212 2m\u03042 \u2212 2|p\u2217| p s\u0302 cos \u03b8\u0302 , (53)\n\u00af\u0302u = u\u0302\u2212 (m23 \u2212m 2 4) 2\n4s\u0302 = \u2212 1 2 s\u0302\u2212 2m\u03042 + 2|p\u2217| p s\u0302 cos \u03b8\u0302 , (54)\nand these variables (m\u0304, \u00af\u0302t, and \u00af\u0302u) are then used in the evaluation of the on-shell cross-section formula. If in doubt whether full matrix elements or the mass-symmetrized approximation represented by eqs. (51) to (54) is used for a given process, the corresponding sigmaKin() method can be inspected in the code (with m\u03042 then typically denoted s34Avg). We note that, when gauge bosons are involved, the procedure is not guaranteed to be gauge invariant, nor positive definite, and breakdowns should be expected if any resonance masses are far from their on-shell values. The alternative would be to change to use full 4- or 6-body matrix elements instead (as already done for double-vector-boson production), e.g. by interfacing external hard-process generators, cf. section 10.1.\nBe aware that, if a decay mode has been assigned meMode = 100 and mmin is such that the decaying resonance can fluctuate down in mass to below the nominal threshold for the given decay mode (i.e., mmin < \u2211\nj m j with m j the on-shell daughter masses for the decay mode in question), it is assumed that at least one of the daughters could also fluctuate down to keep the channel open. Otherwise the program will hit an impasse.\nAlternatively, simple step functions \u0398(m \u2212 \u2211\nj m j) can be applied to impose kinematic thresholds; this is done for decay channels that are assigned meMode = 101. A slightly more sophisticated alternative is to use a smooth threshold factor,\n\u03b2 =\n\u221a \u221a \u221a\n1\u2212 m21 +m 2 2\nm2\n2\n\u2212 4 m21m 2 2\nm4 , (55)\nfor two-body decay modes, and \u221a\n\u221a \u221a\n1\u2212\n\u2211\nj m j m , (56)\nfor multi-body ones, again with m j equal to the on-shell masses of the decay products for the given mode. The former correctly encodes the shrinking size of the phase space near threshold (but would still miss any non-trivial matrix-element factors) while the latter is only a crude simplification. Two separate options exist for this, depending on whether the stored on-shell branching fraction should be considered to already include this factor (meMode = 103) or whether it should be modified by it (meMode = 102). In the former case (meMode = 103), the actual factor applied is the ratio of the above to the corresponding value for m = m0, with a safety limit imposed in case that denominator turns out to be very small, to avoid unintentionally large rescalings at large m.\nAmong the options discussed thus far, only the no-threshold one (meMode = 100) allows for purely off-shell decay modes, i.e. ones for which the on-shell daughter mass values exceed m0; as noted above one or more of the daughters must then be able to fluctuate down in mass, or there will be trouble. The remaining options (meMode = 101 \u2013 103) are all restricted to phase-space points satisfying \u2211\nm j < m, with m j the on-shell daughter-mass values. Currently, the only higher level of sophistication available in PYTHIA is to go all-in and implement dedicated decay-rate calculations specific to each given resonance and decay mode; this is obtained for meMode = 0. As mentioned above, this is the default for most SM resonance decays in PYTHIA as well as for some BSM ones, meaning that such code exists in the program (in the form of process-specific SigmaProcess::weightDecay() methods and\nresonance-specific ResonanceWidths::calcWidth() methods) and is used by default. See further section 3.11.\nFinally, note that both PYTHIA\u2019s simple shower as well as the VINCIA antenna shower allow for the insertion of resonance decays as 1\u2192 n branchings in the overall perturbative evolution, at decay-specific perturbative scales. This is called interleaved resonance decays [23] and is also further discussed in section 3.11.\nPart II\nPhysics content The PYTHIA event generator is the product of a physics development program in close touch with experimental reality. The two have often gone hand in hand, by making it possible to check which ideas work and which do not. Many of the concepts that today form the accepted picture of high-energy collisions can be traced directly to this undertaking, including string fragmentation, dipole showers, multiparton interactions, colour reconnection, and more. This part of the manual provides details on these and the other physics models encoded in PYTHIA. Many of these models still evolve to handle new experimental input, or to accommodate the progress in our theoretical understanding of the standard model of particle physics.\nThe first section describes the physics processes \u2014 sometimes denoted \u201chard processes\u201d \u2014 internal to PYTHIA. These processes are those that can be calculated in leading-order perturbation theory in the standard model or simple extensions. While some of the calculations are currently outclassed, and are more of interest as a cross check or for quick studies, others, particularly the treatment of jet production and BSM physics models, are still actively used for comparisons with data. Further sections describe the core of the PYTHIA engine: parton showers, multiparton interactions, hadronization, and particle decays. An important complement to these sections is the one on matching and merging, which documents the methods for interfacing external calculations (that are more precise in perturbation theory) with the PYTHIA engine.\nNotable additions to the PYTHIA 8.3 presentation here are the descriptions of two partonshower plugins \u2014 DIRE and VINCIA\u2014 and the heavy-ion collision machinery."
        },
        {
            "heading": "3 Internal process types",
            "text": "PYTHIA 8.3 includes a good selection of native hard processes at Leading Order (LO). The hard processes are generated by sampling the allowed phase space using matrix elements, and convoluted with the PDFs, as a weight. Usually the multichannel sampling strategy results in accepted events with a common unit weight, but there are exceptions to this rule, so it is wise to be prepared for non-unit weights in event-analysis programs. In addition to the internal processes, there are several ways to feed in externally generated hard processes for showering and hadronization, including several options for matching and merging of higher-order processes. These options are discussed in detail in section 5 and section 10. This section classifies and lists internally defined hard processes and discusses about special features and appropriate settings for given processes. All internally defined processes are listed in appendix A, where also references to the cross-section formulae are given. If a process is included for both quark and lepton initial or final particles, the process is written with an \u201cf\u201d (denoting fermion) whereas a \u201cq\u201d is used when only quarks are expected. Charge-conjugate processes are always implicitly included."
        },
        {
            "heading": "3.1 Hard QCD",
            "text": "The internal QCD processes can be classified in three categories: (1) 2 \u2192 2 scattering of light quarks and gluons, (2) production of heavy flavours (charm and bottom) in 2\u2192 2 processes, and (3) 2\u2192 3 processes involving light quarks and gluons. For hard processes suitable, process-dependent, phase-space cuts need to be applied to avoid soft and collinear singularities of perturbative QCD. In addition to these, soft QCD processes are included. These are discussed in section 6.1 and include also a unitarized version of the hard 2\u2192 2 cross sections,\nwhere the divergences in the p\u22a5\u2192 0 limit have been regulated with the screening parameter p\u22a50, see section 6.2 for more details. Normally the hard and soft QCD processes would not be used simultaneously, since typically they target different kinds of physics studies. If they are combined nevertheless, relevant phase-space cuts should be introduced to separate the regions handled by each machinery, to prevent double counting."
        },
        {
            "heading": "3.1.1 Light quarks and gluons",
            "text": "This subclass of processes contain all possible 2\u2192 2 scatterings of massless quarks and gluons. In total there are six possibilities:\n\u2022 gg\u2192 gg\n\u2022 gg\u2192 qq\n\u2022 qg\u2192 qg\n\u2022 qq\u2032\u2192 qq\u2032 where incoming and outgoing flavours are the same\n\u2022 qq\u2192 gg\n\u2022 qq\u2192 q\u2032q\u2032\nBy default the light flavours include u, d and s quarks but it is also possible to produce c and b quarks with the massless matrix elements."
        },
        {
            "heading": "3.1.2 Heavy flavours",
            "text": "These processes provide heavy-quark pair production where heavy flavours stand for c and b. In LO, there are two possible processes each:\n\u2022 gg\u2192 cc\n\u2022 qq\u2192 cc\n\u2022 gg\u2192 bb\n\u2022 qq\u2192 bb\nUnlike the case of massless partons, the finite mass also makes the matrix element expressions finite in the p\u22a5 \u2192 0 limit, so there is no need to introduce phase-space cuts to avoid divergences. However, it is also possible to generate these processes within the regularized soft QCD framework, though the mass effects are then not accounted for in the matrix elements. When considering heavy-quark production, one should keep in mind that especially c quarks are abundantly produced in the parton shower at LHC energies [24]. Therefore, to obtain e.g. inclusive D-meson spectra, these processes should be combined with the light-parton processes above. This combination will also provide the total QCD jet cross section in LO. Notice also that the qg\u2192 qg process is available only in the massless approximation above. (The massive matrix element for this process incorrectly sets the incoming quark on mass shell, so it is not a better alternative.)"
        },
        {
            "heading": "3.1.3 Three-parton processes",
            "text": "In addition to 2\u2192 2 QCD processes, LO expressions for processes with three final state partons are also included in PYTHIA. These contain only light partons, but if needed the massive quarks can be dealt with using the massless matrix elements. One should also keep in mind that, since three-jet events can be formed from two-parton final states in the parton showers, mixing these with the 2 \u2192 2 QCD processes would lead to double counting. So far this section is partly incomplete, e.g. colour flows are rather simple, so the purpose is rather to provide a way to check cross sections in specific kinematics where e.g. all three jets need to be above a certain p\u22a5. Included processes are listed below:\n\u2022 gg\u2192 ggg\n\u2022 qq\u2192 ggg\n\u2022 qg\u2192 qgg\n\u2022 qq\u2032\u2192 qq\u2032g where q and q\u2032 are different flavours\n\u2022 qq\u2192 qqg where incoming and outgoing flavours are the same\n\u2022 qq\u2192 q\u2032q\u2032g where q and q\u2032 are different flavours\n\u2022 qq\u2192 qqg where incoming and outgoing flavours are the same\n\u2022 gg\u2192 qqg\n\u2022 qg\u2192 qq\u2032q\u2032 where q and q\u2032 are different flavours\n\u2022 qg\u2192 qqq where incoming and outgoing flavours are the same"
        },
        {
            "heading": "3.2 Electroweak",
            "text": "The internally defined electroweak (EW) processes contain prompt photon production, processes with photons in the initial state, and processes including electroweak bosons as an intermediate state or in the final state."
        },
        {
            "heading": "3.2.1 Prompt photon production",
            "text": "These processes include parton-initiated production that have one or two photons in the final state. The partonic cross sections are at LO in QCD for massless partons and contain only 2 \u2192 2 processes. Thus, similarly as for light-flavour QCD, the expressions diverge in the p\u22a5\u2192 0 limit and require a minimum p\u22a5 cut to avoid QCD singularities. These processes are, however, also included in the eikonalized description of the soft QCD process class, where the divergences are regulated with the p\u22a50. Therefore this event class should be preferred when low p\u22a5 photons are considered. The available processes are\n\u2022 qg\u2192 q\u03b3\n\u2022 qq\u2192 g\u03b3\n\u2022 gg\u2192 g\u03b3\n\u2022 qq\u2192 \u03b3\u03b3\n\u2022 gg\u2192 \u03b3\u03b3\nNotice that the processes with two gluons in the initial state are box graphs. By default, it is assumed that the five massless quarks may form the loop, such that the expressions should be valid in a region where p\u22a5 is between the b and t quark masses. It is, however, possible to change the number of active flavours inside the loop if a different region is considered. In addition to the photons produced in the hard scattering (prompt photons), photons may also be formed in parton showers and hadron decays. Therefore QCD processes might be needed to obtain a realistic rates for photon production."
        },
        {
            "heading": "3.2.2 Weak bosons",
            "text": "This section includes processes with standard model EW gauge bosons, \u03b3\u2217/Z and W\u00b1. The processes are classified into single and pair production, where the single production is associated with a parton and as an intermediate particle in t-channel exchange between two fermions.\nAs a highly-virtual photon \u03b3\u2217 cannot be distinguished from a Z boson with equal quantum numbers, typically both contributions should be accounted for to include interference effects. It is, however, possible to consider these two components separately, without the interference. This applies for all of the following processes including neutral EW bosons.\nBoson exchange, DIS The EW boson t-channel exchange is mainly relevant in Deep Inelastic Scattering (DIS) processes in lepton-hadron collisions but may also be applied for other types of collisions. There are two different contributions, one with neutral and one with charged EW bosons, namely\n\u2022 f f \u2032 \u2192 f f \u2032 where a neutral \u03b3\u2217/Z boson is exchanged so that the initial- and final-state fermion pair remains the same.\n\u2022 f1 f2 \u2192 f3 f4 where a charged W\u00b1 boson is exchanged so that the initial- and final-state fermions are different. This includes charged current DIS with a charged-lepton beam and DIS with neutrino beams.\nIn pp collisions the factorization and renormalization scales are usually related to the transverse momentum, p\u22a5, of the final-state particles. However, in DIS a more appropriate hard scale is usually the virtuality of the intermediate particle, Q2. Therefore, when studying DIS with these processes, it is advised to set the renormalization and factorization scales appropriately, see section 3.10 for details. Similarly, rather than having a phase-space cut on p\u22a5 to avoid divergences, here it is more appropriate to set a minimum Q2 value to make sure that the relevant phase space is covered. Furthermore, since the default parton shower distributes the emission recoils globally, it is not well suited for DIS studies where the scattered lepton is expected to stay intact. Instead it is recommended to use either the dipole-recoil option or the DIRE shower, see section 4.1 and section 4.3 for further details.\nSingle boson production Two different options are included for the single EW-boson production (s-channel) processes. In the first case the process is described as 2 \u2192 1 scattering where the final state is either \u03b3\u2217/Z or W\u00b1:\n\u2022 ff\u2192 \u03b3\u2217/Z\n\u2022 ff\u2032\u2192W\u00b1\nThe decay products of the short-lived (or virtual) particles and their kinematics are then derived as described in section 2.3.\nThe other possibility is to consider single EW-boson production as a 2\u2192 2 process where the decay products can be predetermined. This is useful if only certain final states are studied\nand enables one to set phase-space cuts for the final state, e.g. for the p\u22a5 of the produced lepton. These overlap with the first class of single-boson processes so one should not mix these processes to avoid double counting. The possible processes are:\n\u2022 ff\u2192 \u03b3\u2217\u2192 f\u2032f \u2032\n\u2022 ff\u2192 \u03b3\u2217/Z\u2192 f\u2032f \u2032\n\u2022 f1f2\u2192W\u00b1\u2192 f3f4 The difference between the first two is that in the first, the final state can be any of three possible lepton generations or five possible quark flavours, whereas in the second, the decay channels are set by the Z-decay modes. In the former, only \u03b3\u2217 exchange is included and the process is part of the MPI framework. In the latter, it is also possible to select between pure \u03b3\u2217, Z, and the full interference modes. For the last, W\u00b1 production, the decay channels are always the same for W+ and W\u2212. These are set for W+ and charge-conjugated channels are applied for W\u2212. No quark-mass effects are included for the angular distribution of the decay products of the W\u00b1.\nBoson pair production These processes describe possible combinations of two EW-boson production, also including LO correlations for 4-lepton final states [25].\n\u2022 ff \u2032 \u2192 \u03b3\u2217/Z\u03b3\u2217/Z\n\u2022 ff \u2032 \u2192 Z W\u00b1\n\u2022 ff\u2192W+W\u2212\nNotice that for the second process, no contribution from a virtual photon is included. In addition, it is possible to produce EW bosons in the parton shower as described in section 4.1.4 and section 4.2.4. Therefore, a full EW-boson pair production might require a combination of different processes with some additional care to avoid possible double counting.\nBoson and parton production These processes produce events where an EW boson is produced in association with a parton, where the latter in this case refers either to a quark, gluon, photon, or lepton. The possible channels are:\n\u2022 qq\u2192 \u03b3\u2217/Z g\n\u2022 qg\u2192 \u03b3\u2217/Z q\n\u2022 ff\u2192 \u03b3\u2217/Z\u03b3\n\u2022 f\u03b3\u2192 \u03b3\u2217/Z f\n\u2022 qq\u2192W\u00b1 g\n\u2022 qg\u2192W\u00b1 q\n\u2022 ff\u2192W\u00b1 \u03b3\n\u2022 f\u03b3\u2192W\u00b1 f\nAgain, there will be overlap with the single-boson production channels and the appropriate process depends on the final state and considered kinematics. For fully inclusive EW-boson production, the single-boson class is the relevant one, but for the high-p\u22a5 tail these processes would provide more accurate kinematics. These processes should also be favoured when EWboson production is studied with an associated high-p\u22a5 jet or lepton."
        },
        {
            "heading": "3.2.3 Photon collisions",
            "text": "Many modern PDF sets include perturbatively-generated photons as a constituent of protons. In addition, all electrically-charged particles accelerated to high energies may emit photons that act as initiators for hard processes. The difference between these two cases is that in the former case, the beam hadron will be resolved, whereas in the latter case, the beam particle will stay intact. The following two-photon initiated processes are included in PYTHIA 8.3 and can be applied for resolved and unresolved beams:\n\u2022 \u03b3\u03b3\u2192 qq\n\u2022 \u03b3\u03b3\u2192 cc\n\u2022 \u03b3\u03b3\u2192 bb\n\u2022 \u03b3\u03b3\u2192 e+e\u2212\n\u2022 \u03b3\u03b3\u2192 \u00b5+\u00b5\u2212\n\u2022 \u03b3\u03b3\u2192 \u03c4+\u03c4\u2212"
        },
        {
            "heading": "3.2.4 Photon-parton scattering",
            "text": "A few processes with a photon and a parton as initiators have been included. These are mainly relevant for photoproduction in ep collisions but can also be applied to other collision types with beams that may provide photons and partons. Similarly as pure-QCD processes with light partons, these processes also contain collinear and soft divergences so a suitable phasespace cut, e.g. on partonic p\u22a5, must be applied to obtain finite cross sections. Unlike for the pure-QCD processes, no regularized description applicable at any p\u22a5 is present for any of the photon-initiated processes. The included processes for photon-parton collisions are:\n\u2022 g\u03b3\u2192 qq\n\u2022 g\u03b3\u2192 cc\n\u2022 g\u03b3\u2192 bb\n\u2022 q\u03b3\u2192 qg\n\u2022 q\u03b3\u2192 q\u03b3\nHere, the heavy-quark pair production processes contain the full mass dependence in the matrix elements. Similar to the case of pure-QCD processes, at high-enough collision energies heavy quarks, at least charm, may be produced via parton-shower emissions so several processes might need to be considered to obtain realistic heavy-quark production rates."
        },
        {
            "heading": "3.3 Onia",
            "text": "Hard processes involving charmonium and bottomonium are provided using Non\u2013Relativistic Quantum Chromodynamics (NRQCD) [26], which includes both colour-singlet and colouroctet contributions. The spectroscopic notation 2s+1 LJ specifies the necessary quantum numbers to define a state: spin s, orbital angular momentum L, and total angular momentum J . Processes are available for the 3S1, 3PJ , and 3DJ states containing cc or bb, given an arbitrary radial excitation n, e.g. any \u03a5 (nS) for the 3S1 bb onia states. Double onium production is also available for double-3S1 cc and bb processes, but only with colour-singlet contributions provided. Because of the long-standing discrepancy between polarization in data and NRQCD\npredictions, only unpolarized processes are provided, with isotropic decays, which can then be reweighted accordingly by the user for a given polarization model.\nWithin NRQCD, the inclusive cross-section for a heavy onium state, H, can be written as,\nd\u03c3(pp\u2192 H + X ) = \u2211\ns,L,J\nd\u03c3\u0302(pp\u2192 QQ[2s+1 LJ] + X )\u2329OH[2s+1 LJ]\u232a , (57)\nwhere the cross section is factorized into a sum of products between short-distance matrix elements, d\u03c3\u0302, and long-distance matrix elements \u2329OH[2s+1 LJ]\u232a. The short-distance matrix elements are calculated with perturbative QCD [27\u201332], while the long-distance matrix elements are determined from phenomenological fits to parameters [30,33,34]. Default settings for these parameters are provided for the J/\u03c8, \u03c8(2S), \u03c7c0, \u03c7c1, \u03c7c2, \u03c8(3770), \u03a5 (1S), \u03a5 (2S), \u03a5 (3S), \u03c7b0, \u03c7b1, and \u03c7b2 states.\nThe sum in eq. (57) for a given physical onium state H[2s+1 LJ]\nis over the expansion of its Fock states,\nH[2s+1 LJ] = O(1) QQ[2s+1 L(1)J ] \u00b6 +O(v) QQ[2s+1(L \u00b1 1)(8)J \u2032 ]g \u00b6\n+O(v2) QQ[2s+1(L \u00b1 1)(8)J \u2032 ]gg \u00b6 + . . . , (58)\nwhere the superscript (1) indicates a colour-singlet state, (8) a colour-octet state, and the expansion is in the velocity v of the heavy-quark system. Consequently, a long-distance and short-distance matrix element must be provided for each state in the expansion.\nFor the physical 3S1 states the following processes are available.\n\u2022 gg\u2192 QQ(3S1)[3S (1) 1 ]\n\u00b6\ng\n\u2022 gg\u2192 QQ(3S1)[3S (1) 1 ]\n\u00b6\n\u03b3\n\u2022 gg\u2192 QQ(3S1)[3S (8) 1 ]\n\u00b6\ng\n\u2022 qg\u2192 QQ(3S1)[3S (8) 1 ]\n\u00b6\nq\n\u2022 qq\u2192 QQ(3S1)[3S (8) 1 ]\n\u00b6\nq\n\u2022 gg\u2192 QQ(3S1)[1S (8) 0 ]\n\u00b6\ng\n\u2022 qg\u2192 QQ(3S1)[1S (8) 0 ]\n\u00b6\nq\n\u2022 qq\u2192 QQ(3S1)[1S (8) 0 ]\n\u00b6\nq\n\u2022 gg\u2192 QQ(3S1)[3P (8) J ]\n\u00b6\ng\n\u2022 qg\u2192 QQ(3S1)[3P (8) J ]\n\u00b6\nq\n\u2022 qq\u2192 QQ(3S1)[3P (8) J ]\n\u00b6\nq\nThe 3P(8)J Fock states are a summation of contributions for J = 0,1, 2. The 3P(8)1 and 3P(8)2 long-distance matrix elements are calculated from the 3P(1)0 long-distance matrix element.\nThe following processes are available for the physical 3PJ states, again with J = 0,1, 2.\n\u2022 gg\u2192 QQ(3PJ )[3P (1) J ]\n\u00b6\ng\n\u2022 qg\u2192 QQ(3PJ )[3P (1) J ]\n\u00b6\nq\n\u2022 qq\u2192 QQ(3PJ )[3P (1) J ]\n\u00b6\nq\n\u2022 gg\u2192 QQ(3PJ )[3S (8) 1 ]\n\u00b6\ng\n\u2022 qg\u2192 QQ(3PJ )[3S (8) 1 ]\n\u00b6\nq\n\u2022 qq\u2192 QQ(3PJ )[3S (8) 1 ]\n\u00b6\nq\nSimilar to the 3P(8)J states, the colour-singlet 3P(1)1 and 3P(1)2 long-distance matrix elements are calculated from the 3P(1)0 long-distance matrix element. For physical 3DJ production, the following processes are provided:\n\u2022 gg\u2192 QQ(3DJ )[3D (1) J ]\n\u00b6\ng\n\u2022 gg\u2192 QQ(3DJ )[3P (8) J ]\n\u00b6\ng\n\u2022 qg\u2192 QQ(3DJ )[3P (8) J ]\n\u00b6\nq\n\u2022 qq\u2192 QQ(3DJ )[3P (8) J ]\n\u00b6\nq\nThe colour-octet 3P(8)J contributions are treated in the same fashion as for the physical 3S1 state. Finally, double onium production is available for any arbitrary same-flavour 3S1 configuration.\n\u2022 gg\u2192 QQ(3S1)[3S (1) 1 ]\n\u00b6\nQQ(3S1)[3S (1) 1 ]\n\u00b6\n\u2022 qq\u2192 QQ(3S1)[3S (1) 1 ]\n\u00b6\nQQ(3S1)[3S (1) 1 ]\n\u00b6\nThe default configuration for double-onium production is to provide all possible combinations of the same-flavour physical 3S1 states.\nMany of the short-distance matrix elements diverge as p\u22a5 \u2192 0, and consequently must be regulated either with a hard cutoff or a smooth damping factor. Onium can be produced in a hard process, but also in multiparton interactions, except for double onium. In a hard process, a hard cutoff in p\u22a50 is used, although it is also possible to implement smooth damping through a user defined scheme, see section 9.7.2. In multiparton interactions, instead, a smooth damping is performed with a cutoff scale p\u22a50 for a given energy E0 with an evolution parameter. See section 6.2 for more details.\nThe colour-octet states are defined in the event record using a non-standard numbering scheme, 99nqnsnrnLnJ, where nq is the quark flavour of the state and ns is the colour-octet state type. Here, 0 is 3S1, 1 is 1S0, and 2 is 3PJ . All remaining numbers follow the standard Particle Data Group (PDG) numbering scheme [35, sec. 45]. As an example, 9941003 is the 1S(8)0 cc colour-octet state for the colour-singlet J/\u03c8. After the parton shower and hadronization, all colour-octet states are forced to isotropically decay into their corresponding physical colour-singlet state and a soft gluon. A user-configurable mass splitting is used to set the mass of the colour-octet states for a given colour-singlet. This determines the softness of the gluon emitted in the octet to singlet transition.\nColour-octet states are allowed to evolve under the timelike QCD parton shower, see section 4 for more details on parton showers. This is meant to account for the competing effects of unbound QQ states that emit additional gluons to become a semi-bound state, and semibound QQ states that are broken apart by additional gluon radiation. The combination is approximated by allowing the colour-octet states to radiate in the parton shower with twice the q\u2192 qg splitting probability. Both the probability of a colour-octet state being considered in the parton shower and the pre-factor for the splitting kernel can be configured.\nThis treatment of colour-octet production in the parton shower is a simplification. The colour-octet state can be treated as a gluon, and so a factor of 9/4 rather than 2 may be used. Using a q \u2192 qg splitting kernel, rather than g \u2192 gg, is roughly equivalent to always following the path of the harder gluon, resulting in harder final-state onia. Additionally, soft gluons producing heavy-quark will have little phase space to produce hard semi-bound states. However, after the g\u2192 QQ splitting, each heavy quark carries only approximately half the onium energy, reducing the energy of the gluon emissions. In principle, these two effects between softer and harder gluon emissions should approximately balance. However, comparisons to measurements of prompt J/\u03c8 production in jets from pp collisions indicate that this treatment underestimates the local radiation surrounding onia [36,37]."
        },
        {
            "heading": "3.4 Top production",
            "text": "Standard model top production has now been part of standard measurements for over two decades and state-of-the-art experimental observations now make use of higher-order calculations. However, we still maintain a minimum set of top-production processes that can be used either with a K-factor for quick testing or for designing searches for non-standard decay modes by modifying the top-decay table by hand.\nProduction processes available include:\n\u2022 gg\u2192 tt\n\u2022 qq\u2192 tt\n\u2022 ff\u2192 tt (via t-channel W or s-channel Z/\u03b3 separately)\n\u2022 \u03b3\u03b3\u2192 tt\n\u2022 g\u03b3\u2192 tt\n\u2022 qq\u2032\u2192 q\u2032\u2032t (single top via s-channel W)\nIt may be possible, for example, to test for the production of charged Higgses in top decays by adding the decay mode t \u2192 bH+ to the decay table and using the BSM Higgs sector (see the next section for details of setting BSM Higgs parameters)."
        },
        {
            "heading": "3.5 Higgs",
            "text": "Pythia includes the capability of simulating production of standard model or BSM Higgses via the Two\u2013Higgs Doublet Model (2HDM). The production processes for the SM Higgs include:\n\u2022 f\u0304f\u2192 H\n\u2022 gg\u2192 H (via 1-loop)\n\u2022 qg\u2192 Hq (via 1-loop)\n\u2022 \u03b3\u03b3\u2192 H (via 1-loop)\n\u2022 f\u0304f\u2192 ZH (via s-channel Z)\n\u2022 f\u0304f\u2192W\u00b1H (via s-channel W)\n\u2022 f\u0304f\u2192 Hf\u0304f (vector-boson fusion, ZZ and W\u00b1W\u00b1 can be selected separately)\n\u2022 f\u0304f\u2192 HQQ\u0304 where Q = b, t\nBSM Higgses can be produced using Higgs:useBSM = on. To allow for CP-violating cases, the neutral Higgses are named H1, H2, A3, which in the CP-conserving case refer to two scalar and one pseudoscalar Higgs, respectively. The neutral Higgses are ordered by mass. All processes mentioned above for the SM Higgs are also available for BSM ones by replacing H with the required BSM Higgs name. Further processes available for BSM Higgses are the pairproduction processes.\n\u2022 f\u0304f\u2192 H1,2A3\n\u2022 f\u0304f\u2192 H+H1,2\n\u2022 f\u0304f\u2192 H+H\u2212\nThe couplings of each Higgs boson to SM fermions can be set independently to account for all possible 2HDM structures. Further selection of the parity of each Higgs is also possible. We refer the user to the online manual for a description of each parameter.\nThe decay of the Higgses is also calculated automatically based on input parameters. The decay table can be overwritten by the user, either using the PYTHIA settings structure or using the SLHA interface (see section 10.1.2). Since the LHC cross-section working group recommends the usage of Next\u2013to\u2013Leading Order (NLO) decay widths, we use a multiplicative factor for all internally-calculated widths. The factor is calculated for mH = 125 GeV, but should be sensible for a range of masses. Furthermore, the Breit\u2013Wigner shape of the Higgs resonance is complicated due to a dependence on mass. For resonance searches, it may be useful to \u201cclip the wings\u201d of the Breit\u2013Wigner shape using Higgs:clipWings and Higgs:wingsFac (what factor of width beyond which to clip) parameters."
        },
        {
            "heading": "3.6 Supersymmetry",
            "text": "The implementation of the Minimal Supersymmetric Simplified Model (MSSM) allows fully general, complex 6 \u00d7 6 mixing in the squark sector, and up to five neutral gauginos (corresponding to next-to-minimal MSSM). We also allow all four kinds of R-parity violating couplings (one bi-linear and three tri-linear). Users are expected to input parameters via an SLHA file (see section 10.1.2). Typically, the Higgs sector of Supersymmetry (SUSY) is identical to a type-2 2HDM model and can be generated via the Higgs processes described above. PYTHIA is also capable of calculating decay widths in the standard channels for all SUSY particles. However, if a decay table is provided in the SLHA file, the internal calculation is turned off. For very low-width particles, the lifetime is set as the inverse of the total decay width. All particles with a decay width set to zero are set as stable.\nPair production of squarks (q\u0303i), gluinos ( g\u0303), and gauginos (\u03c7\u0303 0 j , \u03c7\u0303 \u00b1), including pairs like squark-gluino, squark-gaugino, and gluino-gaugino, are implemented with EW contributions. We also implement resonant production of squarks via R\u2013Parity Violating (RPV) \u03bb\u2032\u2032 couplings, with corresponding modification to showering and hadronization to include the new colour structure. Here follows a full list of the processes available.\n\u2022 squark-pair production (including anti-squarks and EW interference)\n\u2013 f\u0304f\u2192 q\u0303i q\u0303 (\u2217) j\n\u2013 gg\u2192 q\u0303i q\u0303 (\u2217) j\n\u2022 gluino pair and gluino-squark production\n\u2013 qq\u0304\u2192 g\u0303 g\u0303 \u2013 gg\u2192 g\u0303 g\u0303 \u2013 qig\u2192 q\u0303i g\u0303 (and charge conjugate)\n\u2022 electroweak-gaugino pair production\n\u2013 f\u0304f\u2192 \u03c7\u0303\u00b1\u03c7\u0303\u00b1\n\u2013 f\u0304f\u2192 \u03c7\u03030i \u03c7\u0303 0 j \u2013 f\u0304f\u2192 \u03c7\u0303\u00b1\u03c7\u03030j\n\u2022 gaugino-gluino and gaugino-squark production\n\u2013 f\u0304f\u2192 g\u0303\u03c7\u0303\u2213\n\u2013 f\u0304f\u2192 g\u0303\u03c7\u03030i \u2013 f\u0304f\u2192 q\u0303(\u2217)j \u03c7\u0303 \u2213 \u2013 f\u0304f\u2192 q\u0303(\u2217)j \u03c7\u0303 0 i\n\u2022 slepton or sneutrino-pair production\n\u2013 f\u0304f\u2192 \u02dc\u0300i\u02dc\u0300 (\u2217) j\n\u2022 resonant production of a squark via an R-parity violating process\n\u2013 qi q\u0304 j \u2192 q\u0303k (RPV)\nFurther selection of what processes to turn on is also possible by specifying individual PDG IDs of particles. All supersymmetric particles are given PDG codes greater than 1000000, with the superpartners generally carrying the corresponding code to their SM partner, e.g. an up quark is 2 and the two up squarks are named 1000002 and 2000002. The full list of PDG codes is available in the published review [35, sec. 45]."
        },
        {
            "heading": "3.7 Hidden valley",
            "text": "Hidden Valley (HV) refers to a range of scenarios characterized by a gauge-symmetric dark sector with various possibilities of portals into the \u201cvalley\u201d. PYTHIA currently is the only generalpurpose Monte Carlo code that implements a HV scenario, including running of gauge couplings, showering, and hadronization in the dark sector [38, 39]. There are multiple particle spectra and production modes available which together can cover a wide range of phenomenology.\nFirst, based on the rank N of the dark SU(N), radiation to either dark photons (i.e. U(1)) or dark gluons (i.e. SU(N)) is implemented. The matter content is modelled of in two separate ways \u2014 first via partners of the SM fermions (named dark-u, dark-d, dark-e and so on) that carry both the SM charges of their partner as well as fundamental of the dark SU(N), and second via a \u201cdark quark\u201d that carries only the dark charge but does not carry any SM charges. In the first case, dark sector particles can be produced via normal SM gauge bosons and radiate to both SM and dark bosons based on their mass and relative strengths of the dark and SM couplings. In the second case, we implement an extra Z \u2032 portal to produce said quarks via a\nkinetic mixing with the SM photon. The spin of the dark-sector particles (aside from the gauge bosons) can be set by the user to be either scalars, fermions, or vectors.\nTwo kinds of models are available in PYTHIA, depending on the charge of the new fermions. The first case is where the new fermions also carry some standard-model charge and can therefore be produced via one of the standard-model gauge bosons. The radiation of the final state-fermions then includes both dark-sector radiation as well as SM radiation. The processes that fall in this category include:\n\u2022 gg\u2192 Fv F\u0304v via intermediate gluon where Fv is the hidden sector quark \u2014 either one of the quarks Uv , Dv , Sv , Cv , Bv , Tv , or generic quark Qv\n\u2022 qq\u0304\u2192 Fv F\u0304v via intermediate gluon where Fv is the hidden sector fermion \u2014 either one of the quarks Uv , Dv , Sv , Cv , Bv , Tv , or generic quark Qv\n\u2022 f\u0304f\u2192 Fv F\u0304v via intermediate Z or \u03b3\u2217. Fv includes all the quarks above, plus the \u201cleptons\u201d Ev , \u03bdEv , and similarly for \u00b5 and \u03c4 flavours\nIt is possible to simulate a hidden sector where the new fermions do not carry any SM charges, but in this case, we need a new portal, which PYTHIA assumes is a new vector Z \u2032. This Z \u2032 is then expected to be able to decay to both SM fermions as well as dark-sector fermions. Pair production of dark-sector fermions via this portal can be done using:\n\u2022 qq\u0304\u2192 Zv followed by Zv \u2192 Fv F\u0304v\nAn important phenomenological effect is the running of the hidden-sector strong coupling which can make significant changes to the radiation pattern in the dark sector. This is by default taken into account by using the one-loop beta function of SU(N) once the number of colours and flavours of new fermions is set. The running can also be turned off by the user to use a fixed-coupling value instead. There is also an inherent ambiguity in the composition of the hadrons in the dark sector. PYTHIA allows the user to manually set the ratio of scalar to vector mesons as well as the parameters of the Lund symmetric fragmentation function or the dark sector (see section 7.1 for details of the fragmentation functions). The decay table of the hidden mesons back into the standard model (should this be desirable), can be done by the user at run time using the standard particle data scheme that PYTHIA uses for all particles."
        },
        {
            "heading": "3.8 Dark matter",
            "text": "Multiple models for Dark Matter (DM) are currently implemented in PYTHIA. They may be separated into two different categories \u2014 production via s-channel mediator and production via pair production of mediators (typically seen in co-annihilation or co-scattering scenarios of DM). In all cases, the DM is assumed to be fermionic. We provide the possibility to produce dark matter with one associated jet for the s-channel models (vector or axial-vector Z \u2032 and scalar or pseudoscalar A). For the mediator pair-production processes, all mediators are produced via Drell\u2013Yan production.\nThe PDG provides some standard codes for common DM particles and mediators, cf. [35, sec. 45]. Of these, the fermionic DM code 52, the s-channel scalar mediator (54) and vector mediator (55) are used in this implementation. The new mediators are either charged scalar (with PDG code 56), charged vector-like fermion (PDG code 57), and doubly charged fermion (PDG code 59). The neutral partner that accompanies the charged mediators is given the PDG code 58.\nThe singlet model contains a scalar singlet with quantum numbers identical to a righthanded lepton. Therefore, it couples via a Yukawa-like coupling to a SM right-handed lepton\nand the DM is a Dirac fermion. Both the scalar and the DM are odd under a Z2 symmetry to ensure the stability of the DM.\nL= \u2202\u00b5\u03c6\u2217\u2202 \u00b5\u03c6 + \u03c7\u0304(i\u03b3\u03bd\u2202\u03bd\u03c7)\u2212m2\u03c6 |\u03c6|2 \u2212m\u03c7\u0304\u03c7 \u2212 (y`\u00af\u0300\u03c6\u03c7 + h.c.) . (59)\nThe fermionic mediators are based on models that have mixing between a singlet and an n-plet vector fermion, both charged under a Z2 symmetry for which all of SM particles are even. The mixing between the singlet and n-plet is then calculated based on the value of n. The lightest neutral state is denoted as dark matter.\nL= \u03c7\u0304(i\u03b3\u03bd\u2202\u03bd\u03c7) + \u03c8\u0304(i\u03b3\u03bdD\u03bd\u03c8)\u2212m1\u03c7\u0304\u03c7 \u2212m2\u03c8\u0304\u03c8 . (60)\nThe mixing term depends on the representation of \u03c8. For example, for a triplet case, we have\nLmix = c \u039b2 \u03c7\u0304(\u03a6\u2020h\u03c4 a\u03a6h)\u03c8 a + h.c. , (61)\nwhere \u03a6h is the SM-Higgs doublet, \u03c8 is the triplet fermion, \u03c4 are the Pauli matrices and \u03c7 is the singlet fermion.\nProduction of DM can be studied in two ways \u2014 either by directly producing the s-channel mediator, which then decays to DM, or by producing the charged partner of DM via Drell\u2013Yan followed by the decay of the partner. The production processes therefore are\n\u2022 qq\u0304\u2192 Z \u2032\u2192 \u03c7\u0304\u03c7\n\u2022 gg\u0304\u2192 S\u2192 \u03c7\u0304\u03c7, note that 1-loop gg\u0304\u2192 S via top-loop is included in this production.\n\u2022 qq\u0304\u2192 Z \u2032g (mono-jet)\n\u2022 gg\u0304\u2192 Sg (also mono-jet, via 1-loop in production)\n\u2022 qq\u0304\u2192 Z \u2032H, i.e. mono-Higgs production (coupling of the SM to the new Z \u2032 has to be set by the user)\n\u2022 f\u0304f \u2192 \u03c8\u03c8\u0304 where \u03c8 = \u02dc\u0300\u00b1 (scalar with leptonic quantum numbers), \u03c7\u00b1 (singly charged fermion), or \u03c7\u00b1\u00b1 (doubly charged fermion), followed by decay of\u03c8 into DM (Drell\u2013Yan for charged partners)\nCouplings of quarks and leptons to the mediators are assumed to be generation universal, however vector and axial-vector components (or equivalently scalar and pseudoscalar components for the scalar mediator) can be set individually for up type, down type, charged lepton, neutrino, and dark-matter fermions. In case of Z \u2032, it is also possible to choose a kinetic-mixing parameter \u03b5 which then automatically sets the rest."
        },
        {
            "heading": "3.9 Other exotica",
            "text": "Finally, we mention other models of new physics that are implemented in PYTHIA, though they are perhaps not as popular as they once were. We refer the reader to the online manual for the detailed descriptions of the model parameters and only provide a list here.\n\u2022 Fourth generation includes production of fourth-generation quarks or leptons via the usual SM-mediated processes.\n\u2022 New gauge boson Z \u2032, W \u2032 and horizontal gauge boson production can be performed through ff\u2192 V production followed by decay. For Z \u2032, full interference with SM \u03b3, Z in the s-channel production is taken into account. It is possible to have both universal and non-universal models where couplings to each generation should be set by hand by the user.\n\u2022 The left-right symmetry model includes a right handed SU(2) sector. Along with the gauge bosons W \u2032 and Z \u2032, it also includes heavy right-handed neutrinos that can be used to study signatures of heavy neutral leptons.\n\u2022 Leptoquark production includes resonant single production or pair production of scalar leptoquarks via gluon-mediated diagrams. The flavour of the leptoquark should be set by the user by explicitly setting the decay table of the leptoquark.\n\u2022 Compositeness models include simple models of excited fermions and contact interactions that modify standard QCD dijet or Drell\u2013Yan production of leptons.\n\u2022 Extra dimensions includes production of the graviton or the extra Kaluza\u2013Klein gauge boson (e.g. KK-gluon) of the Randall\u2013Sundrum model. Further processes include modification of SM dijet/dilepton production due to extra KK-bosons in the TeV-scale or large extra dimension models. Finally, Unparticle emission is modelled associated with a jet or photon."
        },
        {
            "heading": "3.10 Couplings and scales for internal processes",
            "text": "The perturbatively calculated cross sections for QCD and Quantum Electrodynamics (QED) processes depend directly on the value of the relevant coupling evaluated at the scale at which the hard scattering occurs. The scale dependence of the couplings arises due to the renormalization procedure required to obtain finite cross sections and can be calculated by solving the renormalization group equations of the applied theory.\nIn PYTHIA 8.3 the running of the QCD coupling, \u03b1s(Q2), is implemented up to second order and applied at first order by default to match the precision of the internally-calculated cross sections. A fixed value can also be used, but the potential usage is limited to special cases and generally a running coupling should be applied for realistic cross-section estimates. The coefficients related to the value of the coupling are fixed by setting the \u03b1s(Q2) value at the mass of the Z boson.\nSimilarly, running of the QED coupling \u03b1em(Q2) has been implemented in PYTHIA 8.3. This, however, runs much slower than the QCD one and only first-order running is implemented. An option to use a fixed value for \u03b1em(Q2) is included, either by setting the value directly at the mass of the Z boson or by matching to its value at vanishing momentum transfer. In addition, it is possible to globally scale the cross sections with a K-factor if such behaviour is desired.\nThere are two relevant scales that needs to be set. The renormalization scale, Q2ren, arises from the renormalization procedure and defines at which scale the couplings are evaluated. The factorization scale Q2fact arises from factorizing the short-distance phenomena (hard scattering) from the large-distance (soft) structure of hadrons. This scale determines at which Q2 the PDFs of resolved beams are probed. As the scale dependencies arise from an approximated description of QCD, there is some amount of freedom in the scale choices. The only solid guideline is that the scales should be related to the hardness of the scattering process and therefore the optimal choice depends on the type of the studied process. Multiple options for the scale choices have been implemented into PYTHIA 8.3, and all options are available for both Q2ren and Q 2 fact. For 2\u2192 1 processes two options exist:\n\u2022 the squared invariant mass, s\u0302, i.e. the mass of the produced particle;\n\u2022 and a fixed scale.\nFor 2\u2192 2 a few more options are included:\n\u2022 the smaller of the squared transverse masses of the outgoing particles, min(m2\u22a5,3, m 2 \u22a5,4);\n\u2022 the geometric mean of the squared transverse masses of the outgoing particles, m\u22a5,3 \u00b7m\u22a5,4;\n\u2022 the arithmetic mean of the squared transverse masses of the outgoing particles, (m2\u22a5,3 +m 2 \u22a5,4)/2;\n\u2022 the squared invariant mass of the system, s\u0302, relevant for s-channel processes;\n\u2022 the squared invariant momentum transfer \u2212 t\u0302, relevant especially for DIS events as this coincides with the virtuality of the intermediate photon Q2;\n\u2022 and a fixed scale.\nFor 2\u2192 3 processes the possible choices are:\n\u2022 the smallest of the squared transverse mass of the outgoing particles, min(m2\u22a5,3, m 2 \u22a5,4, m 2 \u22a5,5);\n\u2022 the geometric mean of the two smallest squared transverse masses of the outgoing particles, \u00c7\nm2\u22a5,3 \u00b7m 2 \u22a5,4 \u00b7m 2 \u22a5,5/max(m 2 \u22a5,3, m 2 \u22a5,4, m 2 \u22a5,5);\n\u2022 the geometric mean of the squared transverse masses of the outgoing particles, (m2\u22a5,3 \u00b7m 2 \u22a5,4 \u00b7m 2 \u22a5,5) 1/3;\n\u2022 the arithmetic mean of the squared transverse masses of the outgoing particles, (m2\u22a5,3 +m 2 \u22a5,4 +m 2 \u22a5,5)/3;\n\u2022 the squared invariant mass of the system, s\u0302, relevant for s-channel processes;\n\u2022 and a fixed scale.\nFor vector-boson-fusion (VBF) processes, such as f1f2\u2192 f3Hf4, the virtualities of the intermediate bosons would not be accounted for with the above options and would likely underestimate the relevant scales. Therefore modified scale choices where, instead of the transverse mass of the final-state particle, a virtuality estimate m2\u22a5,Vi = m 2 V + p 2 \u22a5,i can be used in the options above when relevant. Traditionally, the theoretical uncertainties related to the truncated pQCD expansion are estimated by varying the QCD scales by a factor of two or so. To enable such variations, options to multiply the scales determined by the options above by constant factors have been implemented. In a basic form, these variations will, however, require to generate a completely new set of events, so mapping out all possible uncertainties might become computationally demanding. Therefore, options to calculate weights for each event based on different scale variations have been implemented in PYTHIA 8.3 for more efficient uncertainty estimation, see section 9.8 for details. Notice also that the couplings and scales can be set separately for MPIs and initial- and final-state showers."
        },
        {
            "heading": "3.11 Handling of resonances and their decays",
            "text": "By default, the SM electroweak gauge bosons, top quarks, the Higgs boson, and generally all BSM particles are classified as resonances. Note that all of these have on-shell masses above 20 GeV (with the exception of some hypothetical weakly interacting and stable particles such as the gravitino, which are also considered resonances).\nImportantly, neither hadrons nor any particles that can be produced in hadron decays, such as \u03c4 leptons, are included in this category. The decays of such particles are performed after hadronization, and changing their decay channels will not automatically affect the reported cross section. For example, allowing only the decay Z \u2192 \u00b5+\u00b5\u2212 will reduce the total cross section reported by PYTHIA for hard processes like pp\u2192 Z by the appropriate branching fraction, while allowing only the decay J/\u03c8 \u2192 \u00b5+\u00b5\u2212 will not change the cross section for gg \u2192 J/\u03c8g. The reason for this is that hadron and \u03c4 decays involve multistep chains that cannot be predicted beforehand: a hard process like gg \u2192 gg can develop a shower with a g\u2192 bb branching, where the b hadronizes to a B\u03040 that oscillates to a B0 that decays to a J/\u03c8. Any bias at the hard-process level would not affect these other production mechanisms and could thus be misleading. Instead, the user must consider all relevant production sources and perform their own careful bookkeeping.\nBoth types, \u201cresonances\u201d and \u201cunstable particles\u201d, can have Breit\u2013Wigner distributed mass spectra (at least when generated by internal PYTHIA processes); more on this below. For the remainder of this subsection we focus on the production and decay of those particles that are classified as resonances, referring to section 8 for the treatment of hadron and \u03c4 decays.\nNote that the cross-section reduction factors to account for decay modes that have been switched off are always evaluated at initialization, for nominal masses. For instance, in the example above, the Z\u2192 \u00b5+\u00b5\u2212 reduction factor is evaluated at the nominal Z mass, even when that factor is used, later on, say in the description of the decay of a 125 GeV Higgs boson, where at least one Z would be produced below this mass. We know of no case where this approximation has any serious consequences, however.\nNote also that, for the specific case of electroweak showers (cf. section 4.1.4 and section 4.2.4), the decays of any resonances that are produced by the shower (i.e. not by the hard process) are treated inclusively, ignoring any user restrictions on which channels should be open or closed. It is then up to the user to select the final states of interest and reject the rest.\nFinally, a word of caution: the above logic implies that switching off all of the decay channels of a resonance will result in cross sections evaluating to zero, precluding PYTHIA from being able to generate any events. Instead, to force a resonance to be treated as stable for a given run, set NN:mayDecay = false, with NN being its particle ID code.\nTotal and partial widths: For resonances, the partial widths to different decay channels are typically perturbatively calculable, given the parameters of the respective model. By default, during initialization PYTHIA therefore computes the hadronic widths of W, Z, t, and SM Higgs bosons at NLO in QCD, with\n\u0393NLOV\u2192qq =\n1+ \u03b1s(m2V )\n\u03c0\n\u0393 LOV\u2192qq ,\n\u0393NLOt\u2192bW =\n1\u2212 5\u03b1s(m2Z)\n2\u03c0\n\u0393 LOt\u2192bW , (62)\nwhere V is a generic vector boson. For H0, the default is a set of channel-specific numerical NLO rescaling factors recommended by the LHCXSWG [40], with current values given in table 1 valid for a reasonable range around the nominal Higgs mass of mH = 125 GeV. Note also that PYTHIA 8 computes the LO partial widths for H0 \u2192 \u03b3\u03b3 and H0 \u2192 gg using running quark-mass values in the loop integrals (evaluated at mH); this gives a non-negligible shift relative to PYTHIA 6 which used pole-mass values in the same expressions. For comparisons, the LHCXSWG rescaling factors can optionally be replaced by simple (1+\u03b1s/\u03c0) correction for the decays to quarks, and for the loop-induced decays the running mass values can be replaced by pole ones.\nFor BSM resonances, PYTHIA applies the (1+\u03b1s/\u03c0) factor to all integer-spin BSM particle decays to quark-antiquark pairs and to semi-leptonic decays of right-handed neutrinos, while the (1\u2212 5\u03b1s/(2\u03c0)) one is applied to t\u2032\u2192 qW decays.\nAt the technical level, these decay-rate calculations are performed by dedicated calcWidth() methods in the derived ResonanceWidths class for the given resonance. Note that this means that the tabulated widths for these particles stored in the program\u2019s particle data table are purely dummy values, overridden at initialization. To force a resonance with ID code NN to have a certain user-defined width, \u0393 , set NN:doForceWidth = on and NN:mWidth = \u0393 . Input of resonance widths via the SLHA interface is discussed separately below.\nBreit\u2013Wigner modelling: We now turn to PYTHIA\u2019s modelling of resonance shapes. Note that this applies to resonances that are produced by PYTHIA (i.e. in PYTHIA\u2019s internal hard processes and/or in decays performed by PYTHIA). For externally generated ones, cf. section 10.1, it is the responsibility of the external generator to model the shape of the produced resonances, though PYTHIA\u2019s modelling may still apply to any resonances produced by subsequent decays of particles that are kept stable in the external process.\nAn important note in the specific context that an external generator is responsible not only for resonance production, but also for one or more of their decays is that the total invariant mass of the resonance-decay products (and hence the resonance shape) is only guaranteed to be preserved during parton showering if an explicit resonance mother (with Les Houches status code 2) is present in the externally provided event record. This is particularly relevant for any coloured resonances (such as top quarks), for which the reconstructible resonance-mass distribution will otherwise be impacted by unphysically large QCD recoil effects to parton(s) outside the resonance-decay system. In principle, the same issue exists for QED recoil effects in decays of electrically charged resonances.\nThe basics of phase-space generation and Breit\u2013Wigner sampling in the context of processes involving resonances were covered in section 2.3.3. As already mentioned there, decay-rate calculations specific to each given resonance and decay mode are the default for most SM-resonance decays in PYTHIA as well as for some BSM ones, via process-specific SigmaProcess::weightDecay() methods and resonance-specific ResonanceWidths::calcWidth() methods, enabled for decay channels assigned meMode = 0. For resonances that include such channels, eq. (50) of section 2.3.3 is generalized to\n1 \u03c0\nm \u2211\nj \u0393 j(m)\n(m2 \u2212m20)2 +m2\u0393 2 tot(m)\n, (63)\nwhere both the partial widths \u0393 j and the total width \u0393tot are in principle allowed to depend on m. There are two main sources of m dependence:\n\u2022 Running couplings in the relevant matrix elements. This also applies e.g. to the NLO normalizations given by eq. (62), in which \u03b1s(m20) is replaced by \u03b1s(m\n2). The SM-Higgs resonance is sufficiently narrow that no appreciable running effects are expected, hence the partial widths given in table 1 are left unchanged.\n\u2022 Threshold effects. For bosonic resonances (Z, W, H, and particles that are trivially related to them such as Z\u2032, W\u2032, H+, and A bosons), decays to same-flavour fermion pairs are associated with the following threshold factors:\n\u0393 (m) = m\u03930 m0 \u0398(s\u0302\u2212 4m2f )\n\n \n  \u03b23 : scalar , \u03b2 : pseudoscalar , \u03b2(3\u2212 \u03b22)/2 : vector , \u03b23 : axial-vector ,\n(64)\nwhere \u03930 is the on-shell partial width and \u03b2 = q 1\u2212 4m2f /m2 is the fermion velocity in the rest frame of the decay. Resonances that have both vector and axial-vector (or both scalar and pseudoscalar) couplings use appropriate mixtures of these factors, and analogous but more complicated expressions are used for decays into unequal masses e.g. of the W+. For other decays, the m dependence is typically more complicated.\nWe refer to the corresponding implementations in the weightDecay() and calcWidth() methods in the code, which can be inspected for more details about the treatment of a given process and/or decay mode, respectively.\nDecay angular distributions: In many cases, non-trivial angular distributions are encoded in PYTHIA via process-specific LO matrix elements that include the relevant decays. For example, for the hard process ff\u2192W+W\u2212 (with f denoting a generic fermion), PYTHIA generates the angular distributions for the two W decays at the same time, using the full ff\u2192W+W\u2212 \u2192 4- fermion matrix elements.\nThis allows for an accounting of the effects of spin correlations between the production and decay stages. Note, however, that only diagrams with the same resonant structure as the production process are included; interference with background processes is not accounted for by this method.\nUsing V to denote a generic weak boson (W\u00b1 or Z0, with the latter typically including \u03b3\u2217/Z interference where relevant) and H to denote a generic neutral Higgs boson, processes for which such matrix-element-corrected resonance-decay distributions are generated by PYTHIA 8.3 include:\n\u2022 Decays of (unpolarized) top quarks: t\u2192 bW+\u2192 b2f.\n\u2022 Electroweak decays of neutral Higgs bosons: H\u2192 VV\u2192 4f and H\u2192 \u03b3Z\u2192 \u03b32f, in both cases allowing for generic (BSM) mixed-CP states.\n\u2022 Electroweak resonant s-channel processes 2f \u2192 V \u2192 2f. Note: this extends to BSM vector bosons such as V\u2032 and VR, and also includes the full \u03b3 \u2217/Z/Z\u2032 interference for Z\u2032\nones.\n\u2022 Electroweak resonant 2 \u2192 4 processes 2f \u2192 VV \u2192 4f and 2f \u2192 HV \u2192 4f. Also 2f\u2192 V\u2032\u2192 VV\u2192 4f.\n\u2022 W decays in ff\u2192 g/\u03b3W\u2192 g/\u03b32f.\n\u2022 BSM excited-graviton decays in 2f\u2192 G\u2217 and gg\u2192 G\u2217 processes, cf. [41].\n\u2022 BSM compositeness excited-fermion decays in 2\u2192 f\u2217 \u2192 g/\u03b3 f and 2\u2192 f\u2217 \u2192 V f, with V decaying isotropically for the latter.\nA prominent example of a process that is absent from this list is top-quark pair production, implying that internally generated tt events in PYTHIA do not exhibit non-trivial correlations between the two top decays. Note also that, for externally provided events (cf. section 10.1), only the top- and Higgs-decay correlations in the two first points above are applied. When interfacing external hard processes it is therefore important to consider whether, and how, resonance decays are treated by the external generator.\nAt the technical level, these process-specific angular distributions are implemented via dedicated weightDecay() methods in the derived SigmaProcess class for the given hard process.\nEffects of PDFs on resonance shapes: Often, the observable resonance shape results from a convolution with non-trivial parton distribution functions. For hadrons, these tend to be strongly peaked towards small x , with a typical asymptotic behaviour roughly like f (x)\u221d 1/x . When convoluted with the Breit\u2013Wigner shape, this tilts the overall resonance shape; the parton-parton luminosity is higher in the low-mass tail than it is in the high-mass tail.\nIf the low-mass enhancement is strong enough, the wide tails of the Breit\u2013Wigner can even lead to a secondary peaking of the cross section towards very low masses. This is obviously unphysical, as the resonant approximation is invalid that far from the resonance, and nonresonant background processes would anyway normally dominate in that region. The desire to cut away such behaviour is one reason for the default choices made in PYTHIA for the mmin limits in eq. (50). For non-standard PDFs, or when making user-defined modifications to the nominal mass and/or width values (e.g. for BSM particles), it is up to the user to check that sensible mmin limits are imposed.\nInterleaved resonance decays: Rounding off the discussion of resonance production and decays, PYTHIA also allows for interleaving resonance decays with the final-state shower evolution, as described in [23]. Currently, this is only done by default for the VINCIA shower model, while it exists as a non-default option for PYTHIA\u2019s simple showers.\nWhen interleaved resonance decays are enabled, resonance decays are inserted into the final-state shower evolution as 1\u2192 n branchings, at a scale which by default is given by the following measure of the off-shellness of the resonance propagator,\nQ2RES = (m2 \u2212m20) 2\nm20 , (65)\nwith median value \u2329QRES\u232a= \u0393 . (A few alternative choices are also offered, including an option to use a fixed scale QRES \u2261 \u0393 .) As part of the resonance-decay branching process, a \u201cresonance shower\u201d is also performed, in the region m0 > Q > QRES. This shower stage only involves the decaying resonance and its decay products, with no recoils to any other partons. Note that any nested resonance decays associated with intermediate scales (e.g. the W boson produced in a t\u2192 bW decay) are also performed during this stage, along with their corresponding resonance showers, while any decays associated with scales below QRES occur afterwards, sequentially.\nThe main consequence is that resonances are prevented from participating as emitters or recoilers for radiation at scales below QRES; only their decay products can do that. We refer to [23] for further details."
        },
        {
            "heading": "3.12 Parton distribution functions",
            "text": "Parton distribution functions provide number distributions of a parton flavour i at a given momentum fraction x when a hadron is probed at scale Q2, and are a necessary input for any hard\nprocess generation with hadron beams [42]. Here, we focus on PDFs for hadrons and nuclei \u2014 PDFs for other types of beams (including leptons, photons, and pomerons) are discussed separately in section 6. The scale evolution of the PDFs is provided by the Dokshitzer\u2013Gribov\u2013 Lipatov\u2013Altarelli\u2013Parisi (DGLAP) equations [43\u201345] and usually these are derived in a global QCD analysis where the non-perturbative input at an initial scale is fitted to a wide range of experimental data. Further constraints are provided by the momentum- and baryon-number sum rules. Nowadays, it is common that in addition to the best fit, the PDF sets also provide error sets that can be used to quantify how the uncertainties in the applied data propagate into other observables.\nIn the case of protons, the high-precision DIS data from HERA collider form the backbone of the PDF analyses. On top of this, the modern PDF sets incorporate a wealth of different LHC data to increase the kinematic reach of the analysis and to obtain further constraints for the flavour dependence. With this, in kinematic regions relevant for LHC studies, the proton structure is known with a percent-level accuracy, except for in a few regions like the very small-x region. PYTHIA comes with some 20 different proton PDF sets. There are a few (pre-HERA) sets that are out of date, e.g. GRV94L and CTEQ5L, but are kept in for historical reasons as some earlier tunes were based on these. In addition, there are a few sets that include HERA data but did not have any from LHC data (e.g. CTEQ6L) which mainly differ from the older ones due different small-x gluon behaviour. The more modern ones include several data sets from LHC experiments which provide further constraints for gluon PDFs and flavour separation between different quarks. Another recent development in the PDFs is the inclusion of QED evolution that enables inclusion of photons as a part of the hadron structure. The current default set is NNPDF2.3 QCD+QED LO, which does contain some datasets from LHC, but not the most recent ones. It is important to note, however, that the default Monash tune is based on this PDF set, so updating to a more recent PDF set would not lead to an improved description unless a complete retuning of pp parameters is performed. Many further sets are accessible via the LHAPDF interface, cf. section 10.1.4. This runs slightly slower than the built-in sets, but also offers further facilities such as error bands around the central PDF member. Notice also that there might be small differences between the internally defined PDFs sets and the corresponding LHAPDF grids due to different interpolation routines and different extrapolations beyond the provided interpolation grid.\nThe neutron PDF is obtained from the proton one by isospin conjugation. This is not quite correct for some recent sets where the QCD evolution is combined with a QED one, i.e. where the quarks can radiate off photons, but in practice it is good enough except for photon physics.\nFor pions, the main set is based on GRS 99 [46]. This work makes the ansatz that valence, gluon, and sea PDFs are of the form N xa(1 \u2212 x)b(1 + A p x + Bx) at an initial scale Q20 = 0.26GeV 2, with the parameters fitted to data. By choosing a small Q0, the distributions can be assigned a valence-quark-like shape at that scale, and strange and heavier quarks can be taken to vanish. An older set based on GRV 92 [47] is available, but is deprecated in favour of GRS 99. A similar PDF is also available for the kaon [48].\nFor other hadrons, rough estimates for PDFs have been made based on the form above, with A = B = 0. No data is available, so the parameters a and b have been chosen heuristically, based on the guiding principle that all valence quarks should have roughly the same velocity for the hadron to stay together over time, and thus heavier quarks must take a larger average momentum fraction. The N are fixed by the flavour and momentum sum relations. For details on this procedure, see [49]. These PDFs are referred to as the SU21 sets, and are stored in the LHAPDF format and distributed with PYTHIA 8.3. Specifically, the PDFs included this way are available for the following hadrons: p, \u03c0+, K+, \u03c60, \u03b7, D0, D+s , J/\u03c8, B +, B0s , B + c , \u03a5 , \u03a3\n+, \u039e+, \u2126\u2212, \u03a3++c , \u039e + c , \u2126 0 c , \u03a3 + b , \u039e \u2212 b , and \u2126 \u2212 b . The SU21 p and \u03c0 PDFs are less accurate than other available sets, so they should not to be used in real studies, but are included for completeness.\nHadrons with the same quark contents as the ones above are assumed to have the same PDFs. Furthermore, other cases can be defined using isospin conjugation, since no QED effects are included in the SU21 sets. Mixed cases such as \u03c00 and \u03a30 are assumed to have equal u and d contents, which are given by the averages for the corresponding implemented PDF (i.e. \u03c0+ and \u03a3+, respectively). Using such rules, all normal hadrons can be simulated, except for baryons with more than one charm or bottom quark. One final technical point is that in the SU21 LHAPDF files for flavour-diagonal mesons, the antiquark content represents the sea, in order to make it possible to separate valence and sea (e.g. for J/\u03c8, the c column represents the charm content, while the c column represents charm sea).\nAlso, a few nuclear PDF sets have been included internally. These can be used to estimate the leading nuclear effect for inclusive high-p\u22a5 observables, such as jet production, but for more involved studies it is recommended to use the full heavy-ion machinery, see section 6.8. More nPDFs are available as LHAPDF grids, but the advantage of the internally defined sets is that any proton baseline PDF can be applied and, if needed, the number of protons and neutrons can be redefined event-by-event.\nA fair fraction of the internal PDFs are LO ones. This ensures a sensible behaviour also for processes at low x and/or Q2 (discussed further below), but also some NLO and NNLO proton sets are available, for the modelling of hard processes. In this context, it can be mentioned that, at large x and Q2, NLO corrections to the PDF shape are often more important than those for the matrix elements, such that NLO PDFs and LO MEs can be a viable combination. Further, in the large-(x ,Q2) region where the behaviour is nowadays rather well understood, PDFs do not risk turning negative.\nFor showers and MPIs, the case is less clear; they both connect to low-p\u22a5 scales around or below 1 GeV, and especially MPIs can probe extremely small x values, down to around 10\u22128 at LHC energies, cf. section 6.2. In this region, all PDF components are poorly known, especially the dominant gluonic one. In an LO description, the PDFs are required to be non-negative, and HERA data in combination with Regge theory provide some reasonable constraints on the lowx behaviour. PDFs need not be positive definite at higher orders, NLO or NNLO, since it is only the convolution of NLO (NNLO) hard-process matrix elements with NLO (NNLO) PDFs that should be non-negative, up to NNLO (N3LO) terms. Actually, at scales p\u22a5 \u223c 1 GeV the whole perturbative expansion is poorly convergent, since \u03b1s is large. Some recent PDFs attempt a resummed description of the small-x behaviour to restore a guaranteed PDF positivity [50]. Nevertheless, in general, the criteria for what constitutes an optimal or at least sensible PDF choice for the hard process are not necessarily the same as for showers and MPIs; for this reason, PYTHIA 8.3 allows for the use of one PDF set for the hard process and a different set for showers and MPIs. This can also be useful to preserve shower- and underlying-event tuning properties while changing PDFs for the hard process.\nIt is also possible to pick different PDF sets for the two incoming beam particles, which may be convenient as a technical trick but has no physics motivation when colliding beams are the same."
        },
        {
            "heading": "3.13 Phase-space cuts for hard processes",
            "text": "Several different phase-space cuts have been implemented for the internal hard processes in PYTHIA 8.3. These serve two purposes: to properly set values that ensure the approximations in the theory description are valid, and to allow for more efficient event generation when only a certain part of the available phase space is considered. The principal example is the lower limit of the partonic p\u22a5 of 2\u2192 2 processes, that needs to be set to a high enough value such that the divergent behaviour of the massless matrix elements in the p\u22a5 \u2192 0 limit is avoided. Similarly, a suitable lower limit for p\u22a5 should be applied when considering e.g. jet production at higher values of p\u22a5, to avoid the inefficiency otherwise associated with a rapidly dropping\np\u22a5 spectrum. (But also see comment at the end of this subsection.) The number of implemented phase-space cuts for the hard scattering depends on the number of final-state particles of the process. For 2\u2192 1 only two options are included:\n\u2022 the minimum invariant mass mmin\n\u2022 the maximum invariant mass mmax\nIf the value of the latter is lower than the value of the former, the invariant mass will be limited from above by the collision energy. The same cuts also apply to 2\u2192 2 and 2\u2192 3 processes.\nFor 2 \u2192 2 processes some more options appear. The first three are related to invariant transverse momentum of the process:\n\u2022 the minimum transverse momentum p\u22a5min\n\u2022 the maximum transverse momentum p\u22a5max\n\u2022 an additional lower transverse-momentum cut p\u22a5diverge\nThe latter is to prevent divergences in the p\u22a5 \u2192 0 limit for processes where a particle has a mass smaller than the set p\u22a5diverge. In these cases, however, the larger of the p\u22a5min and p\u22a5diverge is always applied for the p\u22a5 selection. The next set of cuts is related to limits of Breit\u2013Wigner (BW) mass distributions. By default, the mass selection based on BW shapes is always applied for particles with a width above a certain threshold. There are two different thresholds that can be set:\n\u2022 the minimum width of a resonance for which the Breit\u2013Wigner shape can be deformed by the variation of the cross section across the peak;\n\u2022 and the minimum width of a resonance that is below the former threshold, for which a simplified treatment is applied instead, where a symmetric Breit\u2013Wigner selection is decoupled from the hard-process cross section.\nNotice that the allowed mass range of a given particle can be set by modifying the particle properties. In case of DIS, instead of p\u22a5, the most relevant phase-space cut is the lower limit for the allowed virtuality of the intermediate photon:\n\u2022 minimum Q2 for t-channel processes with non-identical particles\nNotice that the cuts for p\u22a5 will also be applied when a non-zero cut for Q 2 is applied.\nFor 2\u2192 3 processes that do not contain soft or collinear singularities, such as Higgs production in EW-boson fusion, the same cuts as in the 2\u2192 2 case can be applied. For QCD processes, where such singularities need to be accounted for, alternative cuts are defined. Also, since the outgoing partons are no longer back-to-back, cuts for individual partons can be used for a more detailed phase-space mapping:\n\u2022 the minimum transverse momentum for the highest-p\u22a5 parton\n\u2022 the maximum transverse momentum for the highest-p\u22a5 parton\n\u2022 the minimum transverse momentum for the lowest-p\u22a5 parton\n\u2022 the maximum transverse momentum for the lowest-p\u22a5 parton\n\u2022 the minimum separation R (= p (\u2206\u03b7)2 + (\u2206\u03c6)2) between any two outgoing partons\nThe last one needs to have a high-enough value to avoid collinear divergences associated with the outgoing partons.\nAs described above, the phase-space cuts can be used to improve the sampling efficiency by focusing on a particular phase-space volume, e.g. defined by cuts on partonic p\u22a5. In some cases this might, however, require several runs that need to be combined later on. Similar improvement in efficiency can also be achieved by reweighting the cross section of the hard process with a suitable kinematic variable. In PYTHIA 8.3 the events can easily be reweighted by p\u22a5\n\u2212\u03b1, where \u03b1 is a power that could e.g. approximate the p\u22a5 dependence of the hard cross section. This allows for a more uniform filling of the phase space, even when the cross section itself drops rapidly. The downside is that when reweighting is applied, each event comes with a weight that needs to be accounted for e.g. when filling histograms. In addition to this built-in reweighting of internally defined 2\u2192 2 hard processes, there are also more involved options for reweighting with different variables that can be enabled with the user hooks described in section 9.7.2.\nAn important aspect is that the described phase-space cuts are applied only for the hard scattering, i.e. before any showering or hadronization. As the shower emissions will modify the four-momentum of outgoing partons; a jet formed from the final particles will have a somewhat different transverse momentum than the parton that originated the jet. Final-state radiation and hadronization can reduce the energy of the jet, whereas initial-state radiation and multiparton interactions may enhance it. Therefore a \u201cfiducial phase-space volume\u201d is needed, i.e. hard processes must be generated in a larger volume than the volume of interest for final-state observables, at the unfortunate cost of generating many events that will be thrown away. The necessary amount of oversampling depends highly on the kinematics and beam configuration considered, so it needs to be checked case-by-case. For jet studies, this is usually done by plotting the hard-process p\u22a5 associated with accepted jets or events. If a non-negligible fraction of events near the p\u22a5min scale are accepted then p\u22a5min is too high."
        },
        {
            "heading": "3.14 Second hard process",
            "text": "The MPI framework in PYTHIA will generate a variable number of partonic 2\u2192 2 interactions in addition to the selected hard process itself. These, mainly QCD processes, will form the underlying event, typically consisting of rather soft particles. Occasionally, they may also contain a hard scattering but, due to power-law falloff of the relevant cross sections, such events are rare. There are, however, cases when the studied observable is such that more control over the kinematics of the second scattering can significantly improve the sampling efficiency (e.g. of four-jet final states), or the second process is not included as a part of current MPI generation (e.g. the production of an EW boson together with a jet). The machinery for a second hard process can be used in these situations. It can be viewed as an approach to generate so-called Double Parton Scattering (DPS) events, but with two key distinctions. First, the DPS framework as used for theoretical studies typically assumes that there are exactly two hard interactions in an event, while the second-hard setup allows there to be further MPIs just like when starting out from one hard interaction. Second, the MPI machinery uniquely fixes how two hard cross sections should be combined into a total, while this usually involves a free parameter in the DPS expressions.\nThe basic approach in the PYTHIA implementation for the generation of two hard processes in a single event is that, first, the two processes are selected completely independently and, afterwards, momentum conservation and the possible correlations in the PDFs are accounted for by the rejection of a fraction of the topologies. This makes the process sampling symmetric and thus the distinction between \u201cfirst\u201d and \u201csecond\u201d is used only for bookkeeping. Furthermore, as long as there is some overlap in phase space of the two processes, any of the two can be the hardest one. In principle, this construction would allow the generation of any two inter-\nnally (or externally) defined processes, but in practice there is no need for a very fine-grained control of both processes, and furthermore the combination of two rare processes would give a negligible cross section. Therefore a somewhat more limited set of second processes have been implemented. Still, the first process can be selected from the complete list of processes (appendix A), or even provided externally. The processes that can be enabled as a second hard one include:\n\u2022 standard QCD 2\u2192 2 processes, i.e. two-jet production\n\u2022 a prompt photon and a jet\n\u2022 two prompt photons\n\u2022 charmonium production, colour singlet and octet\n\u2022 bottomonium production, colour singlet and octet\n\u2022 \u03b3\u2217/Z production with full interference\n\u2022 single W\u00b1 production\n\u2022 production of a \u03b3\u2217/Z and a parton\n\u2022 production of a W\u00b1 and a parton\n\u2022 top-pair production\n\u2022 single-top production\n\u2022 bottom-pair production\nTechnically these can be combined freely, but some combinations would double count and therefore must be avoided. This includes a \u03b3\u2217/Z/W\u00b1 together with a jet or on its own, and bb production as part of the QCD 2 \u2192 2 processes or on its own. Also, since the last one will include only bb production explicitly in the hard scattering, the pairs produced by gluon splittings in the parton showers will not be present in that sample. Thus, depending on the kinematics, this might or might not be enough to give realistic cross-section estimates.\nBy default, the phase-space cuts, couplings, and scales for the second hard process are the same as for the primary scattering. It is, however, possible to set different cuts for the second one, and, due to fully symmetric treatment of the two processes, the cuts for the second process can be set higher or lower than for the primary one. The cuts that can be separately specified are the minimum and maximum values for the invariant mass and transverse momentum of the process.\nIt is instructive to consider some Poissonian statistics before showing how the cross sections of two processes should be combined. If the average number of subcollisions, \u2329n\u232a, is known, the probability for n of them to occur is given by\nPn = \u2329n\u232an e\u2212\u2329n\u232a\nn! . (66)\nIn case where \u2329n\u232a is small, as it is for hard processes, we can approximate e\u2212\u2329n\u232a = 1. The probability for one event to happen is then P1 = \u2329n\u232a, and correspondingly for two such events we find P2 = \u2329n\u232a2/2 = P21 /2. Now consider two independent event types a and b, such that \u2329n\u232a = \u2329na\u232a+ \u2329nb\u232a = P1a + P1b. The probability for any combination of two events a and b is then given by\nP2 = (P1a + P1b)2\n2 =\nP21a + 2P1aP1b + P 2 1b\n2 . (67)\nFrom this it can be read off that a probability for having two different-type events comes with a factor 2 relative to the same-type cases. If modelled in terms of increasing time, or decreasing hard scale (say p\u22a5), the mixed combination can occur in two ways, either where the event a happens before b, or the other way around, which explains the factor of 2.\nThe proper way to evaluate the resulting cross section thus depends on whether the two processes are the same, and on whether the phase-space regions overlap. The simplest case is when the two processes do not overlap, i.e. either the phase-space regions are completely separated or the two process are different. An example of the latter would be a combination of processes where the first produces two jets and the second two photons. When the a and b cross sections are small fractions of the total non-diffractive cross sections \u03c3ND, naively the probabilities Pa,b = \u03c3a,b/\u03c3ND enter multiplicatively. Thus their combined cross section is\n\u03c3naive2ab = Pa Pb\u03c3ND = \u03c31a\u03c31b \u03c3ND . (68)\nThis simplification neglects the dependence on collision geometry, however. The probability for a hard process is enhanced in central collisions, i.e. for small impact parameter, while it is depleted in peripheral ones. This leads to a so-called \u201ctrigger bias\u201d effect, where events containing a first hard process predominantly occur in central collisions, which thereby enhances the likelihood of a second hard process. In the context of traditional MPIs this is known as the \u201cpedestal effect\u201d, where a selected high-p\u22a5 process has more underlying-event activity than an average event, see more details in section 6.2.2. When the colliding matter profiles have been specified, along with the parameters that set the \u2329nMPI\u232a, a correction factor fimpact can be derived event-by-event within the MPI framework. Its average value gives a corrected combined cross section\n\u03c32ab = \u2329 fimpact\u232a \u03c31a\u03c31b \u03c3ND = \u03c31a\u03c31b \u03c3eff . (69)\nIn the last step we introduce\u03c3eff, which is the conventional parameter that many experimental results are expressed in terms of, but here it is a prediction of the model.\nThe cross section \u03c32aa of two identical processes follows the same pattern, except for the extra factor of 1/2 that has already been explained. Often a would itself be the sum of several subprocesses, e.g. the six main classes of 2 \u2192 2 QCD processes that contribute to two-jet production. If so, then a compensating factor of 2 will automatically occur for the mixedsubprocess configurations, in the same spirit as eq. (67).\nThe cross section calculation becomes somewhat more complicated in cases when there is partial overlap between the two processes. An example would be identical processes with different, but partly overlapping, cuts on p\u22a5. In such cases it is useful to split the problem into two completely independent processes a and b and a common process c. The first (second) process can be selected according to\u03c3a+\u03c3c (\u03c3b+\u03c3c). Half of the events should be discarded if both processes are chosen as c, and the combined cross section should be reduced accordingly.\nSo far it has been assumed that the generation of the two processes can be done independently, apart from the geometrical correction factor for the final cross sections. This obviously misses all possible correlations between the PDFs and, perhaps more importantly, may violate energy-momentum conservation. Part of the selected events will be discarded to account for these effects, even though each process would be acceptable on its own. The correlations in multiparton PDFs implemented in PYTHIA are described further in section 6.2.4. The PDF reduction factor is obtained as the average of the two possible orderings, where either the second or first PDF is corrected for the parton taken out either by the first or second process.\nIn the end, the cross sections provided by PYTHIA after the event generation do account for all these effects, including the correction factor \u2329 fimpact\u232a and the PDF rescaling. The error estimates provided by PYTHIA are statistical ones and do not cover the potentially large model uncertainties, as usual. When the first process is provided externally, PYTHIA does not have\nthe information whether there is an overlap between the first and the second process, and so will assume that this is not the case. The proper correction for an overlap then rests with the user."
        },
        {
            "heading": "4 Parton showers",
            "text": "The most violent pp collisions at the LHC may have five to ten easily separated jets. Zooming in on these, they display a substructure of jets-inside-jets-inside-jets, associated with the perturbative production of increasingly nearby partons. Such a fractal nature is expected to continue down to the hadronization scale, a bit below 1 GeV. At that scale, the event may contain up to a hundred partons, even if the full partonic structure is masked by the subsequent non-perturbative hadronization process. There is no way to perform matrix-element calculations to describe such complicated event topologies. Instead, the standard approach is to start out from a matrix-element calculation with only a few well-separated partons, and then apply a parton shower to that.\nParton showers attempt to describe how a basic hard process is dressed up by emissions at successively \u201csofter\u201d (longer-wavelength) and/or more \u201ccollinear\u201d (smaller-angle) resolution scales, to give an approximate but realistic picture of the (sub)structure of the partonic state across the full range of (perturbative) resolution scales. Such a shower is constructed in a recursive manner, from the large scale of the hard process down to a lower cutoff at around the hadronization scale. In each step, the number of partons is increased by one, or in very special cases two, and the random nature of the steps leads to a large variability of final states. It is worth emphasizing that, although often thought of in the context of QCD, parton (or more generally particle) showers are in fact common to any quantum field theory with several (quasi-)massless particles. Thus, showers are present in QCD, QED, and the EW theory above the symmetry breaking scale and as such, dedicated modules describing all of these are part of PYTHIA 8.3.\nOne starting point is to study the ratio of two differential matrix elements, d\u03c3n+1/d\u03c3n, where the numerator corresponds to the emission of one more gluon in the final state. It then turns out that this ratio is given by universal expressions, i.e. independent of which specific process is considered, if this gluon is either soft, or collinear with one of the already existing partons. This means that one can formulate a generic scheme that can be applied to any process of interest. Such schemes started to be developed in the late 1970s. A key ingredient has been the DGLAP evolution equations [43\u201345], which describe near-collinear emissions. Modern showers, like the three available with PYTHIA 8.3, are based on many subsequent developments, intended to make them cover the full phase space as well as possible. These aspects are described later, but initially we introduce the simpler, classical (collinear \u201cleadinglog\u201d) framework that helps in understanding the overall picture.\nHistorically, showers are split into two kinds, ISR and FSR, which occur respectively before or after the hard process. Alternatively, they may be referred to as spacelike and timelike showers, respectively, since their representation in terms of Feynman diagrams contain offshell intermediate particles that are either spacelike or timelike. The more virtual such a particle is, the shorter it may exist. Therefore, the highest virtualities occur in and closest to the hard interaction, and then showers with decreasing virtualities stretch backwards (for ISR) or forwards (for FSR) in time. LHC processes usually contain both ISR and FSR, and outside the strictly collinear limits the distinction can be blurred, just like interfering Feynman graphs of a different nature may contribute to a given final state. A decay \u03b3\u2217/Z \u2192 qq is pure FSR, however, while its production qq\u2192 \u03b3\u2217/Z can be discussed in terms of ISR only, so these are often used as textbook examples. (Conversely, ISR-FSR interference can be exemplified by\nt-channel colour-singlet exchange, such as in deep inelastic scattering or vector boson fusion.)\nFSR Starting from \u03b3\u2217/Z \u2192 qq, either the q or q may emit a g, e.g. q \u2192 qg. This produces a qqg state, after which either of the three partons may branch, and so on. The differential probability for a parton to branch can be written as\ndPa(z,Q2) = dQ2 Q2 \u03b1s(Q2) 2\u03c0 \u2211\nb,c\nPa\u2192bc(z)dz . (70)\nHere a is the mother that splits into partons b and c, where the momentum-energy of the mother is split such that b takes fraction z and c takes 1\u2212z. The Q scale, used to order emissions in a falling sequence, is a key distinguishing feature of different shower implementations, and may be chosen e.g. as mass, transverse momentum or energy-weighted emission angle. That is, z parameterizes the longitudinal and Q the transverse evolution of the shower. There is also an azimuthal angle \u03d5 that determines the orientation of the decay plane; typically, and for the purpose of this brief introduction, this is assumed to be distributed isotropically, though we note that PYTHIA does allow for non-uniform distributions as well, e.g. to reflect gluon polarization effects.\nA key issue that distinguishes parton showers from so-called analytic resummation approaches, is that the latter only maintain exact energy and momentum conservation in the strict soft and collinear limits while showers do so over all of phase space. This difference leads to the crucial aspect of recoil effects in parton showers, which will play an important role when we introduce dipole showers later on.\nThere are three different DGLAP splitting kernels,\nPq\u2192qg(z) = 4 3\n1+ z2\n1\u2212 z , (71)\nPg\u2192gg(z) = 3\n1\u2212 z(1\u2212 z) 2\nz(1\u2212 z) , (72)\nPg\u2192qq(z) = 1 2 z2 + (1\u2212 z)2 . (73)\nThese obey the trivial symmetry relations Pa\u2192cb(z) = Pa\u2192bc(1\u2212 z). The Pg\u2192qq kernel is normalized for one quark flavour only, and has to be summed over all kinematically allowed channels.\nThe same approach can also be used for other branchings, notably QED ones, where \u03b1s in eq. (70) is replaced by \u03b1em and the splitting kernels are\nPf\u2192f\u03b3(z) = e 2 f\n1+ z2\n1\u2212 z , (74)\nP \u03b3\u2192ff(z) = Nc e 2 f z2 + (1\u2212 z)2 , (75)\nwhere Nc = 3 if f is a quark and Nc = 1 if a charged lepton. The DGLAP kernels are often written with additional terms that modify the behaviour at z = 1 and 0, in order to conserve momentum-energy and flavour in analytic calculations. This is not necessary in event generators, partly because the 0 and 1 limits are never reached, and partly because conservation issues are handled explicitly: parton a is removed at the same time as b and c are inserted in the list of currently existing partons.\nThe branching probability in eq. (70) can be integrated over the kinematically allowed z range\ndPa(Q2) = dQ2 Q2 \u03b1s(Q2) 2\u03c0 \u2211\nb,c\n\u222b zmax(Q2)\nzmin(Q2) Pa\u2192bc(z)dz , (76)\nto express the infinitesimal probability that a branches in a dQ2 infinitesimal step. (Strictly speaking |dQ2| since Q2 is decreasing in the evolution.) The probability for a not to branch in the same step thus is 1\u2212 dPa(Q2). By multiplication of the no-emission probabilities (exponentiation), the probability for a not to branch between an initial scale Q21 and a final lower Q22 becomes the Sudakov factor [51]\n\u03a0a(Q 2 1,Q 2 2) = exp\n\u2212 \u222b Q21\nQ22\ndPa(Q2) ! . (77)\nThe differential probability for a to evolve from a Q2max to a Q 2 and then branch at the latter scale, thus is \u03a0a(Q2max,Q 2)dPa(Q2). Note that the introduction of a Sudakov factor ensures that the total probability for a to branch cannot exceed unity, something that is not guaranteed for dPa alone.\nWe observe that the Sudakov factor plays a crucial role in the selection of a branching scale. The veto-algorithm technology in section 2.2.3 is eminently suited to handle cases where the Q2 and z integrations cannot be done analytically. The Sudakov factor also is closely related to virtual corrections of matrix elements, i.e. loop corrections. This will play a key role for the matching and merging methods presented in the next section.\nISR The ISR description starts out from the evolution equation for Parton Distribution Function (PDF)s,\nd fb(x ,Q 2) =\ndQ2 Q2 \u03b1s(Q2) 2\u03c0 \u2211\na\n\u222b\nfa(x \u2032,Q2)dx \u2032\n\u222b\nPb/a(z)dz\u03b4(x \u2212 x \u2032z)\n= dQ2 Q2 \u03b1s(Q2) 2\u03c0 \u2211\na\n\u222b\ndz z fa x \u2032 = x z ,Q2 Pb/a(z) , (78)\nwhere fi(x ,Q2) is the probability to find a parton i inside a hadron, with i carrying a fraction x of the full hadron momentum if the hadron is probed at a scale Q2.\nAs for FSR, the evolution is driven by branchings a \u2192 bc but, where FSR is formulated in terms of the decay rate of a, ISR is given in terms of the production rate of b. The simple splitting kernels are easily related, Pb/a(z) = Pa\u2192bc(z), except that Pg/g(z) = 2Pg\u2192gg(z), since two gluons are produced for each gluon that decays.\nThe evolution of PDFs starts at some low scale Q20 and then proceeds towards the Q 2 scale of the hard process, where they enter into the cross-section expression. While eq. (78) describes the evolution of an inclusive distribution, an exclusive shower formulation similar to the FSR one is possible, although more complicated. A key problem is that the two incoming cascades, one from each side of the event, may not end up as the colliding partons one is interested in. For example, in gg\u2192 H the two incoming gluons must have an invariant mass that matches the Higgs mass.\nThe solution to this problem is backwards evolution [52]. In this method, the evolved PDFs are first used to select the hard process of interest, say qq\u2192 \u03b3\u2217/Z . Only afterwards are the incoming showers then constructed backwards in time, from the high Q2 scale down to the low Q20. To this end, we introduce\ndPb(x ,Q2) = d fb(x ,Q2) fb(x ,Q2) = dQ2 Q2 \u03b1s(Q2) 2\u03c0 \u2211\na\n\u222b zmax(Q2)\nzmin(Q2) dz x \u2032 fa(x \u2032,Q2) x fb(x ,Q2) Pb/a(z) , (79)\nwhere we have used that z = x/x \u2032. Here dPb is the probability that parton b becomes associated with a branching a \u2192 bc during the interval dQ2. A no-branching probability\n\u03a0b(x ,Q21,Q 2 2) can be defined in analogy with the Sudakov factor eq. (77). The corrected probability for a parton b that branches or interacts at Q2max to be assigned a mother a at Q 2 then is \u03a0b(x ,Q2max,Q 2)dPb(x ,Q2). This a in its turn must be evolved to yet lower Q2 to find its mother at an even higher x value.\nRecoils and dipoles An isolated parton cannot branch, if energy and momentum is to be preserved. Take as an example \u03b3\u2217/Z \u2192 qq \u2192 q\u2217q \u2192 qqg, where q\u2217 is the off-shell quark that branches as q\u2217 \u2192 qg. Initially, the q and q can split the energy equally, but the off-shell q\u2217 acquires a larger mass than q, and so it must have a larger energy while the q receives a smaller one. In this case we would call q the radiator (or emitter) and q the recoiler, but note that at the end, both may yield energy to create the g. Also, considering the existence of q \u2192 qg branchings, it may be simpler to say that it is the qq pair that jointly radiates the g. Note that q and q have opposite and compensating colours and thus form a colour dipole, hence the concept of dipole radiation.\nThis picture generalizes to the subsequent emission of further gluons [53,54]. In the limit of infinitely many colours, Nc \u2192 \u221e [55], the qqg system exactly splits into one qg dipole and one gq dipole. These can radiate independently, and the recoil is distributed within each dipole. It is still possible, but not necessary, to split the radiation inside each dipole as being associated with either dipole end.\nTo allow dipole showers to operate, unique colour indices (in the Nc \u2192 \u221e limit) are assigned to all coloured partons, both ones produced in the hard process and ones in the subsequent shower evolution. For the extension to ISR, and to decays like t \u2192 bW+, one should note that the hole left behind by a scattered or decayed colour parton can act like its anticolour.\nFormal basis of parton showers In the previous discussion, we have developed the basic idea of parton showers, similarly to the historical development. We now want to turn to a more in-depth treatment about the formal basis of modern shower algorithms as the three implemented in PYTHIA 8.3.\nWe have seen above that parton showers build upon the factorization of (squared) amplitudes in soft and collinear limits. Technically, this means that whenever either two (or more) particles become collinear or one (or more) particle becomes soft, the full (squared) amplitude can be well approximated by the (squared) matrix element without the unresolved particle times a universal radiation function. It is the latter, which takes the effect of the soft or collinear radiation into account. This factorization is reminiscent of the perturbative physics of the hard process and occurs, because an intermediate, almost on-shell, propagator can be replaced by a polarization sum, such that the amplitude may be split into two independent pieces. Vital for the construction of showers is that this factorization is universal in the sense that it is process and multiplicity independent. This means that the same radiation functions can be used for different squared matrix elements and at any multiplicity, as long as only single-unresolved radiation is concerned. The latter comment serves to emphasize that at higher multiplicities also multiple-unresolved limits occur, in which, for instance, two particles become simultaneously soft or three particles become simultaneously collinear. For such configurations, it should be obvious that higher-order radiation functions are needed and the ones describing single-soft or (double-)collinear radiation are not sufficient. At the same time, it is always possible to factorize phase-space integration measures into on-shell steps by introducing delta functions to factorize the decay system, and introducing recoiling systems to guarantee four-momentum conservation. Taking matrix-element and phase-space factorization together, it follows that cross sections can be factorized. This allows for iteration of the approximation, as long as the measure of \u201csoftness\u201d or \u201ccollinearity\u201d remains appropriate. In\nthis context, the requirement of an appropriate measure leads to the notion of strong ordering, which means that radiation of soft particles is yet softer and radiation of collinear particles is yet more collinear. Although different possibilities to factorize matrix elements exist, all inherit that the approximation should recover the singularities of fixed-order results. On the one hand, DGLAP evolution is driven by collinear radiation; on the other hand, factorizationbreaking (so-called non-global) logarithms are driven by soft radiation. These are the limits any parton shower resumming the leading, i.e. largest, logarithms should recover.\nBased on the above, we can start thinking about the construction of a shower model. It should be emphasized that the construction of showers is by no means unique. As the bare minimum, a shower algorithm must define the following.\n1. Radiation functions, i.e. the matrix-element factorization.\n2. A phase-space factorization and recoil procedure.\n3. An ordering variable, i.e. a measure of \u201csoftness\u201d and/or \u201ccollinearity\u201d.\nFor each of these points, different choices are possible and used, motivated by different desires to obtain certain objectives: simplicity, extendability, or simply to describe specific processes better at the cost of describing others worse.\nUsing somewhat general language for now, we can denote the radiation functions by K j/i\u0303 k\u0303, describing the radiation of particle j from the two parent particles i\u0303 and k\u0303, i.e. the branching i\u0303 k\u0303 7\u2192 i jk. Depending on the specifics of the shower algorithm, one of the two parents i\u0303 and k\u0303 may be distinguished as the \u201cemitter\u201d while the other, the \u201crecoiler\u201d, only ensures fourmomentum conservation, or both parents act as emitters and recoilers in an agnostic way. The former is how both PYTHIA\u2019s simple shower and DIRE are structured, whereas the latter describes the antenna picture employed in the VINCIA shower. No matter which specific choice of radiation functions is made, the sum of terms must reproduce all single-unresolved limits of the full real-emission cross section,\nd\u03c3n+1 single-unresolved \u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2192 \u2211\nj\nK j/i\u0303 k\u0303 d\u03a6+1 d\u03c3n =: Kn7\u2192n+1 d\u03a6+1 d\u03c3n , (80)\nwith the cross sections \u03c3 defined as in eq. (37). This factorization consists of two parts: the factorization of the squared matrix element and the factorization of the phase space.\nSpecifically, in the case of two particles i and j becoming collinear, the n+1-particle matrix element factorizes into a product of the n-particle matrix element and the DGLAP splitting kernels eqs. (71) to (75),\n|Mn+1|2 i\u2016 j \u2212\u2192 8\u03c0\u03b1 2pi \u00b7 p j Pi\u0303\u2192i j(z) |Mn|2 + angular terms . (81)\nGenerally, the collinear limit involves spin correlations between the factorized matrix element and the (spin-dependent) DGLAP kernels, here indicated by the additional \u201cangular terms\u201d. These terms vanish upon azimuthal integration and are therefore not necessarily implemented in a parton-shower algorithm. It is, however, vital to account for these terms in so-called NLO subtraction schemes to ensure point-wise cancellation of singularities. In the limit of a single gauge boson becoming soft, however, the emission of the soft boson can be described by a universal factor known as the soft eikonal. Different to the collinear limit, soft radiation is an intrinsically coherent phenomenon, meaning that the boson is emitted by the whole particle ensemble, introducing a sum over radiators:\n|Mn+1|2 E j\u21920 \u2212\u2212\u2212\u2192 8\u03c0\u03b1 \u2211\ni<k\nCik 2pi \u00b7 pk\n(2pi \u00b7 p j)(2p j \u00b7 pk) |Mn|2 , (82)\nwith charge factors Cik depending on the charges of the radiators i and k. Especially in the case of QCD, these charge factors introduce intricate colour correlations for soft gluon emissions. It is because of these complications that most parton showers only consider the leading-colour limit, i.e. neglect any contributions in the above sum that correspond to emissions from nonneighbouring partons.\nBesides the factorization of matrix elements, in eq. (80) we used that the n + 1-particle phase space exactly factorizes into a product of an n-particle phase space and the branching phase space d\u03a6+1, obtained through a formal insertion of an intermediate off-shell particle with mass m2i j = (pi + p j) 2,\nd\u03a6n+1(q; p1, . . . , pi , p j , pk, . . . , pn+1) = d\u03a6n(q; p1, . . . , pi\u0303 , pk\u0303, . . . , pn)\n\u00d7 J(pi\u0303 , pk\u0303; pi j , pk) dm2i j 2\u03c0 d\u03a62(pi j; pi , p j)\n\u2261 d\u03a6n(q; p1, . . . , pi\u0303 , pk\u0303, . . . , pn)d\u03a6+1(pi , p j , pk) . (83)\nIt must be emphasized that the n-particle phase-space measure is here written with on-shell momenta pi\u0303 and pk\u0303 instead of an off-shell intermediate momentum pi j . This means we here assume an on-shell phase-space factorization, i.e. that after each emission, all momenta are separately physical and momentum is conserved at each step in the shower,\npi\u0303 + pk\u0303 = pi + p j + pk . (84)\nThe change from the off-shell momenta {pi j , pk} to the on-shell momenta {pi\u0303 , pk\u0303} is represented by the Jacobian\nJ(pi\u0303 , pk\u0303; pi j , pk) . Specific forms of kinematic mappings {pi\u0303 , pk\u0303} 7\u2192 {pi , p j , pk} (or \u201crecoil schemes\u201d) are again shower specific. Presently, however, all showers in PYTHIA 8.3 employ an on-shell factorization as described here. While this might not generally be required, this is a key requirement for the matching and merging techniques utilized in PYTHIA 8.3, cf. section 5.\nThe branching phase space d\u03a6+1 accounts for the degrees of freedom entering through the emission of one particle from the n-particle configuration and can generally be expressed in terms of three \u201cshower variables\u201d t, z, and \u03c6,\nd\u03a6+1(pi , p j , pk) = |J(t, z,\u03c6)| d\u03a6+1(t, z,\u03c6) = 1\n16\u03c02 |J(t, z,\u03c6)| dt dz d\u03c6 . (85)\nUsually, t is interpreted as the ordering variable of the shower, z as some kind of energy-sharing variable, and \u03c6 as the angle about the branching plane in the i- j-k rest frame. However, different showers make different choices which may be more or less connected with this analogy.\nAddressing point 3 of the list above, it is instructive to start by noting that various choices of ordering variables are formally equivalent at the Leading Logarithmic (LL) level, as can be seen by comparing the differentials as they enter through the matrix-element and phase-space factorizations described above,\ndt t = dp2\u22a5, j p2\u22a5, j = dm2i j m2i j = d\u03b82i j \u03b82i j , (86)\nand by noting that in the collinear limit p2\u22a5, j \u223c z(1 \u2212 z)m 2 i j \u223c z 2(1 \u2212 z)2E2j \u03b8 2 i j . It is straightforward to see that all these choices represent a certain measure of softness or collinearity, as required above. The requirement that this measure remains appropriate during the shower evolution then translates into strong ordering of emissions, i.e. subsequent emissions evolve down in the ordering scale: t0 > t1 > t2 > . . . tn.\nPutting the above together, a no-branching probability, often also called Sudakov factor, can be defined:\n\u03a0n(tn, tn+1;\u03a6n) = exp\n\n\n\n\u2212\ntn \u222b\ntn+1\nKn7\u2192n+1(\u03a6n,\u03a6+1(t \u2032, z\u2032,\u03c6\u2032))d\u03a6+1(t \u2032, z\u2032,\u03c6\u2032)\n\n\n\n. (87)\nIt describes the evolution from an n-particle state at scale tn to an n+ 1-particle state at scale tn+1 < tn. By rewriting Kn7\u2192n+1 as the sum of radiation functions K j/i\u0303 k\u0303, \u03a0n can written as the product of i\u0303 k\u0303 7\u2192 i jk no-branching probabilities:\n\u03a0n(tn, tn+1;\u03a6n) = exp\n\n\n\n\u2212 \u2211\nj\ntn \u222b\ntn+1\nzmax \u222b\nzmin\n2\u03c0 \u222b\n0\n1 16\u03c02 K j/i\u0303 k\u0303(t \u2032, z\u2032,\u03c6\u2032) J(t \u2032, z\u2032,\u03c6\u2032)\nd\u03c6\u2032\n2\u03c0 dz\u2032 dt \u2032\n\n\n\n= \u220f\nj\nexp\n\n\n\n\u2212\ntn \u222b\ntn+1\nzmax \u222b\nzmin\n2\u03c0 \u222b\n0\n1 16\u03c02 K j/i\u0303 k\u0303(t \u2032, z\u2032,\u03c6\u2032) J(t \u2032, z\u2032,\u03c6\u2032)\nd\u03c6\u2032\n2\u03c0 dz\u2032 dt \u2032\n\n\n\n(88)\n= \u220f\nj\n\u03a0 j/i\u0303 k\u0303(tn, tn+1;\u03a6n) .\nWritten this way, it is also emphasized that each branching i\u0303 k\u0303 7\u2192 i jk comes with its own branching phase space and kinematic mapping. This is how the full no-branching probability \u03a0n 7\u2192n+1 is implemented in shower algorithms in practice.\nFor the calculation of the expected value of an observable O, the no-branching probabilities enter to describe the shower evolution as a Markov chain,\n\u2329O\u232aPSn = \u222b d\u03c3n d\u03a6n Sn(t, O)d\u03a6n , (89)\nwhich is generated by a \u201cshower operator\u201d Sn(t, O), defined recursively as\nSn(t, O) := \u03a0n(t, tc;\u03a6n)O(\u03a6n) + t \u222b\ntc\nKn7\u2192n+1\u03a0n(t, t \u2032;\u03a6n)Sn+1(t \u2032, O)d\u03a6+1(t \u2032, z\u2032,\u03c6\u2032) . (90)\nThis shower operator makes the unitarity of the shower explicit. The first term implicitly accounts for all unresolved radiation and virtual corrections between the shower starting scale t and the shower cutoff tc. The second term, on the other hand, describes the emission of a single particle, approximated by the sum of radiation functions Kn7\u2192n+1, and includes all unresolved and virtual corrections between the shower starting and cutoff scale.\nIt is instructive to make the form of the no-branching probability eq. (88) more explicit for QCD showers. Implicitly, the radiation functions K j/i\u0303 k\u0303 above contain the strong-coupling constant, a colour factor, and, for ISR, a ratio of PDFs,\nK j/i\u0303 k\u0303(t, z,\u03c6) = g 2 s (t)RPDF(t, z)C j/i\u0303 k\u0303 K\u0304 j/i\u0303 k\u0303(t, z,\u03c6) = 4\u03c0\u03b1s(t)RPDF(t, z)C j/i\u0303 k\u0303 K\u0304 j/i\u0303 k\u0303(t, z,\u03c6) ,\n(91) where we have introduced the coupling-, PDF-, and colour-factor-stripped radiation function K\u0304 j/i\u0303 k\u0303, which depends solely on the branching kinematics. For FSR, the PDF ratio is equal to\nunity, RPDF = 1, as the initial-state momenta do not change due to the branching. Differentially in the evolution variable t, the integral in the exponent of \u03a0 j/i\u0303 k\u0303 can thus be written as\ndPFSR j/i\u0303 k\u0303 (t)\ndt = \u03b1s(t) 2\u03c0 C j/i\u0303 k\u0303 2\nzmax \u222b\nzmin\n2\u03c0 \u222b\n0\nK\u0304 j/i\u0303 k\u0303(t, z \u2032,\u03c6\u2032) J(t, z\u2032,\u03c6\u2032)\nd\u03c6\u2032\n2\u03c0 dz\u2032 , (92)\ndP ISR j/i\u0303 k\u0303 (t)\ndt = \u03b1s(t) 2\u03c0 C j/i\u0303 k\u0303 2\nzmax \u222b\nzmin\n2\u03c0 \u222b\n0\nRPDF(t, z) K\u0304 j/i\u0303 k\u0303(t, z \u2032,\u03c6\u2032) J(t, z\u2032,\u03c6\u2032)\nd\u03c6\u2032\n2\u03c0 dz\u2032 , (93)\nfor FSR and ISR, respectively. Written this way, the connection to eqs. (76) and (79), respectively, is immediately evident. It is worthwhile to point out here that typically different shower algorithms are inconsistent as to whether colour factors are included or excluded in radiation functions. Moreover, depending on whether a shower aims at describing the evolution of a single initial-state leg at a time or both at the same time, the PDF ratios RPDF have to include one PDF ratio,\nRPDF(t, z) = x i fi(x i , t) x i\u0303 j f i\u0303(x i\u0303 , t) , (94)\nor two PDF ratios if both initial-state particles are evolved at the same time,\nRPDF(t, z) = x i fi(x i , t) x i\u0303 f i\u0303(x i\u0303 , t) xk fk(xk, t) x k\u0303 fk\u0303(x k\u0303, t) . (95)\nThe x-fractions pi = x i P, with P the incoming hadron momentum, depend on the shower variables t and z.\nA similar analysis can be done in the cases of QED or EW showers, where the QCD coupling has to be replaced by the electromagnetic/electroweak coupling and QCD colour factors by the appropriate QED/EW charges.\nFormal accuracy Despite their success in describing wide classes of observables with often impressive agreement with experimental data, parton showers commonly work with a number of approximations. It is not an easy task to formally assess the accuracy of a given shower model, i.e. to determine which exact terms of a perturbative series a shower includes. For a start, there are three expansions to be considered:\n1. the perturbative expansion in the coupling constant \u03b1n(t), determining the accuracy of the hard process, e.g. leading-order (LO), next-to-leading order (NLO), etc.;\n2. the perturbative expansion in large logarithms \u03b1n(t) logm(thard/t), determining the accuracy of the resummation, e.g. Leading Logarithmic (LL), Next\u2013to\u2013Leading Logarithmic (NLL), etc.;\n3. and for QCD showers, the expansion in the number of colours (Nc), determining the accuracy of the colour factors in the resummation, e.g. Leading Colour (LC), Next\u2013to\u2013 Leading Colour (NLC), etc.\nA baseline shower would for example start from a LO matrix element and (typically) generate the LL corrections arising from additional radiation under the LC assumption of planar colour flows. Such a shower could be assigned a LO+LL+LC accuracy. This can be expected from virtually all common shower models, although observables may exist for which a given shower does not correctly include the LL terms. It is more interesting, however, to determine if and\nfor which observables showers reach sub-leading, i.e. higher, accuracy than the LO+LL+LC minimum.\nIncreasing the accuracy on the fixed-order side can be addressed by matching and merging methods, which are described in detail in section 5. Matching and merging at LO and NLO have de-facto become state of the art for all showers and processes.\nAssessing and increasing the logarithmic accuracy of showers has become a highly-active field, where no general solution has yet been developed. Different approaches to assess the logarithmic accuracy of showers have been developed in the recent past, such as ones based on comparison of analytic and numerical resummation [56, 57], analytic examination of the logarithmic structure of showers [58, 59], or numerical checks of logarithmic terms [60, 61]. Moreover, for simple processes such as e+e\u2212 annihilation to jets, first shower models have been developed that can be shown to give NLL accuracy for a wider range of observables [62, 63]. Most common shower models currently only obtain a formal LL accuracy, with varying, observable-dependent subleading accuracy.\nLastly, the inclusion of sub-leading colour corrections in parton showers is an active field as well, with approaches based on matrix-element corrections [59, 64\u201368], sampling of colours [69, 70], quantum-probability density-matrix arguments [71, 72], or amplitude-level evolution [73, 74]. Sub-leading colour corrections are not in general universally applied in parton showers.\nShowers in PYTHIA 8.3 There are three different shower modules available in PYTHIA 8.3: the original/default simple shower, the VINCIA antenna shower, and DIRE. These will be discussed in detail below in section 4.1, section 4.2, and section 4.3, respectively."
        },
        {
            "heading": "4.1 The simple shower",
            "text": "The \u201csimple shower\u201d is the oldest parton-shower algorithm in PYTHIA 8 and is also the default shower model in PYTHIA 8.3. It has its origin in the mass-ordered showers in JETSET/PYTHIA [52,75\u201377], with the transition to p\u22a5 ordering [78] partly influenced by the Lund dipole picture [54] and partly by the desire to combine the ISR and FSR shower evolution with MPI in a single interleaved sequence [78].\nOver the years, significant revisions and extensions have been introduced, many of them only available in recent PYTHIA versions. This includes:\n\u2022 Full interleaving of ISR, FSR, and MPI [79].\n\u2022 Options for a dipole-style treatment of initial-final colour flows [80].\n\u2022 f\u2192 f\u03b3 and \u03b3\u2192 ff splittings (where f represents charged fermions).\n\u2022 Matrix element corrections for resonance decays and a few other processes [76,77,81].\n\u2022 Extensive facilities for matching and merging (cf. section 5).\n\u2022 Reweighted shower branchings and uncertainty bands [20].\n\u2022 A flexible treatment of showers in baryon-number-violating processes [82].\n\u2022 Weak showers [83].\n\u2022 Hidden-sector showers [38,39].\nThe name \u201csimple\u201d shower here refers to the limited aim of a consistent leading-logarithmic (and beyond) shower evolution, with several known shortcomings [58,59], as opposed to the more sophisticated goals of the alternative VINCIA (cf. section 4.2) and DIRE (cf. section 4.3) shower options, also available in PYTHIA 8.3. It should be emphasized that, by virtue of its longer history, many features are only available in the simple shower, and that as such the naming might be slightly misleading. As an example, the simple shower offers a much larger selection of matching and merging methods than does VINCIA or DIRE.\nThe shower machinery consists of one algorithm for FSR and one for ISR. These two are evolved together into one combined sequence of decreasing p\u22a5 scales. As an example, consider a partonic process a+b\u2192 c+d, where a and b are extracted from the beams A and B. It is then possible for c and d to undergo FSR branchings, and for a and b backwards-evolution ISR ones. Starting from some maximal scale p\u22a5max, downwards evolution gives a possible branching p\u22a5 scale for each of the four partons. The one with largest p\u22a5 is the winner that undergoes a branching, leading to a new state of five partons. The selected p\u22a5 value is taken as the new starting point for all five partons to evolve further down in p\u22a5, giving a new branching. This is applied iteratively until some lower cutoff is reached and the evolution is stopped. Also, MPIs will form part of this evolution, see section 6.2.5."
        },
        {
            "heading": "4.1.1 Basic shower branchings",
            "text": "The description of showers in the introduction of this section is valid for the simple shower framework. Notably the branching probabilities dPa of eq. (76) and dPb of eq. (79) play a central part, but with two key additions.\nOne is that evolution is performed in terms of transverse momenta, i.e. the generic Q2 scale in eq. (76) and eq. (79) is replaced by a p2\u22a5evol. The use of transverse momentum as an evolution variable has been shown to catch key coherence features and therefore is a preferred choice [53,54].\nThe other is that a dipole picture is being used, although with some exceptions. In it each coloured parton has a unique anticolour partner, and together the two form a dipole. Radiation is split into one contribution from each dipole end. When one end radiates, the other end has to take a recoil such that total energy and momentum is preserved.\nShower evolution To understand basic kinematics in a branching a \u2192 bc, expressions become especially simple using light-cone (LC) p\u00b1 = E \u00b1 pz , for which p+p\u2212 = m2\u22a5 = m\n2 + p2\u22a5. When a moves along the +z axis, with p+b = zLCp + a and p + c = (1\u2212zLC)p + a , p\n\u2212 conservation then gives\nm2a = m2b + p 2 \u22a5\nzLC +\nm2c + p 2 \u22a5\n1\u2212 zLC , (96)\nor equivalently p2\u22a5 = zLC(1\u2212 zLC)m 2 a \u2212 (1\u2212 zLC)m 2 b \u2212 zm 2 c = p 2 \u22a5LC . (97) For a timelike branching Q2 = m2a and mb = mc = 0, assuming massless partons, so then p2\u22a5LC = zLC(1\u2212 zLC)Q\n2. For a spacelike branching Q2 = \u2212m2b and ma = mc = 0, where b is the parton that will enter the hard interaction, so instead p2\u22a5LC = (1\u2212 zLC)Q\n2. We are inspired by these relations to define abstract evolution variables\np2\u22a5evol = z(1\u2212 z)Q 2 for FSR, (98) p2\u22a5evol = (1\u2212 z)Q 2 for ISR, (99)\nin which to order the sequence of shower emissions. The zLC definitions will be replaced by invariant-mass-based z for the final kinematics definitions, for better Lorentz invariance properties, and as a consequence p\u22a5evol 6= p\u22a5LC. Further details on this are given later.\nThe evolution is now carried out, downwards in p2\u22a5evol from some starting scale p 2 \u22a5evol,max, for FSR by parton a branching to b + c, for ISR by parton b being reconstructed as coming from the branching of an earlier a. The branching probabilities of eq. (76) and eq. (79), with the addition of no-branching probabilities \u03a0, eq. (77), gives\ndPFSR = \u03a0a(p2\u22a5evol,max, p2\u22a5evol)dPa(p2\u22a5evol) , (100) dPISR = \u03a0b(x , p2\u22a5evol,max, p2\u22a5evol)dPb(x , p2\u22a5evol) . (101)\nA p2\u22a5evol scale is selected for each existing dipole end, and the end with the largest value is chosen to branch.\nThe selection of a branching means that p2\u22a5evol and z are fixed. From these, one can derive the virtuality of the evolving parton\nm2a =Q 2 = p2\u22a5evol z(1\u2212 z) for FSR, (102)\n\u2212m2b =Q 2 = p2\u22a5evol (1\u2212 z)Q2 for ISR. (103)\nWhat now remains is to construct the kinematics of the branching. This works rather differently for FSR and for ISR, so the two cases are presented separately.\nFSR branching kinematics Study the radiation inside a dipole, consisting of a radiator a and a recoiler r, in the dipole rest frame, with a moving in the +z direction, and with m2ar = (pa + pr)\n2. For massless partons, the introduction of an off-shell Q2 = m2a increases Ea from mar/2 to\n(m2ar +Q 2)/2mar , with Er reduced by the same amount, or in terms of four-momenta\npa\u2032 = pa + Q2\nm2ar pr , pr \u2032 =\n1\u2212 Q2\nm2ar\npr . (104)\nThe two daughters share the energy according to Eb = zEa and Ec = (1\u2212 z)Ea. With the modified a still along the +z axis, the transverse momentum of the two daughters then becomes\np2\u22a5b,c = z(1\u2212 z)(m2ar +Q 2)2 \u2212m2arQ 2\n(m2ar \u2212Q2)2 Q2 \u2264 z(1\u2212 z)Q2 = p2\u22a5evol . (105)\nThe kinematics can now be completed, including a random \u03d5 orientation of the p\u22a5. Also, if the original dipole had to be boosted and rotated to its rest frame, the new system should be transformed back to the original frame.\nColours are also assigned in the branching, such that the new colour-dipole picture is set up. This is well defined in the Nc\u2192\u221e limit, except for g\u2192 gg branchings. Here a rewriting [54],\nPg\u2192gg(z) = 3\n1\u2212 z(1\u2212 z) 2\nz(1\u2212 z) = 3 2\n1+ z3\n1\u2212 z + 3 2\n1+ (1\u2212 z)3\nz ' 3\n1+ z3\n1\u2212 z , (106)\nallows the gluon that takes the (usually smaller) 1\u2212 z fraction to be the \u201cradiated\u201d gluon that connects the \u201cradiator\u201d gluon to the recoiler.\nOf note is that the light-cone sharing of momenta between daughters, suggested initially, here is replaced by an energy sharing. It has the advantage that p2\u22a5evol and this z together exactly match on to the singularity structure of matrix elements, such as the textbook\n\u03b3\u2217/Z\u2192 q(1) + q(2) + g(3) one, when q\u2192 qg and q\u2192 qg radiation from the two dipole ends is combined\ndp2\u22a5evol,q p2\u22a5evol,q dzq 1\u2212 zq + dp2\u22a5evol,q p2\u22a5evol,q dzq 1\u2212 zq = dx1 dx2 (1\u2212 x2)x3 + dx1 dx2 (1\u2212 x1)x3 = dx1 dx2 (1\u2212 x1)(1\u2212 x2) , (107)\nwith x i = 2Ei/Etot. Corrections to fully reproduce several important matrix elements therefore are easily implemented.\nIncidentally, note that 1 \u2212 x2 \u221d cos\u03b8qg and 1 \u2212 x1 \u221d cos\u03b8qg, so eq. (107) provides a prescription for how radiation from the full dipole smoothly can be split into radiation from the two ends as a function of the gluon emission angle. This split also decides which of the two original partons is the recoiler, the one that keeps its direction of motion.\nThe kinematics need to be modified when quark masses are included, with full expressions in [77]. There are two key points, however. First, if the branching parton a has an on-shell mass ma and off-shell mass ma\u2032 , then eq. (98) needs to be modified to\np2\u22a5evol = z(1\u2212 z)Q 2 = z(1\u2212 z)(m2a\u2032 \u2212m 2 a) , (108)\nto reproduce the singularities in matrix elements. Second, if the daughters are initially assigned four-momenta p(0)b and p (0) c as if they were massless, then massive four-vectors can be constructed as\npb = (1\u2212 kb)p (0) b + kc p (0) c , (109) pc = (1\u2212 kc)p(0)c + kbp (0) b , (110)\nkb,c = m2a \u2212\nq\n(m2a \u2212m 2 b \u2212m2c )2 \u2212 4m 2 bm 2 c \u00b1 (m 2 c \u2212m 2 b)\n2m2a . (111)\nThe p\u22a5b,c is also reduced in the process, by a factor 1\u2212 kb \u2212 kc .\nISR branching kinematics The handling of ISR branching kinematics is somewhat more complicated. At any scale p2\u22a5evol, two initial partons, one from each incoming beam particle, are identified by the ISR algorithm. These partons are taken to be massless and collinear with the beams, and are the mothers of the respective incoming ISR cascade.\nBy the backwards evolution, the resolution scale is gradually reduced, and then either of these two partons may be reconstructed as the daughter b of a previous branching a \u2192 bc. The other of the two partons takes on the role of recoiler r. The parton b, previously taken as massless, is now assigned a spacelike virtuality m2b = \u2212Q\n2, and the recoiler is needed for consistent reconstruction of the kinematics. The kinematics redefinition is performed such that the invariant mass of the b + r system is unaffected, since this mass is given by the set of produced particles, which in a case like gg \u2192 H must not be modified. The final-state system must be rotated and boosted, however, since b not only acquires a virtuality but also a transverse momentum. If previously b was assumed to travel along the event axis, now it is a that does so.\nThe current massless mothers should, at any step of the cascade, have four-momenta in the rest frame of the two incoming beam particles given by pi = x i ( p s/2) (1;0, 0,\u00b11), ensuring that s\u0302 = x1 x2s. This relation should be preserved in the a\u2192 bc branching, so the z = xb/xa should fulfil z = m2br/m 2 ar = (pb + pr) 2/(pa + pr)2. This constraint is used to construct the\nkinematics in the a+ r rest frame, with a moving along the +z axis, and if c is massless:\npa,r = mar 2 (1;0, 0,\u00b11) , (112)\npb = mar 2 z; p\u22a5b,c cos\u03d5, p\u22a5b,c sin\u03d5, mar 2 z + 2Q2\nm2ar\n, (113)\npc = mar 2 (1\u2212 z);\u2212p\u22a5b,c cos\u03d5,\u2212p\u22a5b,c sin\u03d5, mar 2 1\u2212 z \u2212 2Q2\nm2ar\n, (114)\np2\u22a5b,c = (1\u2212 z)Q 2 \u2212\nQ4\nm2ar < (1\u2212 z)Q2 = p2\u22a5evol . (115)\nThe p2\u22a5b,c and p 2 \u22a5evol measures agree well for small Q 2 values. With increasing Q2, the p2\u22a5b,c will gradually turn over and decrease again (for fixed z and mar). The maximum p 2 \u22a5b,c occurs for pzc = 0, and a decreasing p2\u22a5b,c is obtained for an increasingly negative pzc . Thus the drop of p2\u22a5b,c is deceptive. The p 2 \u22a5evol therefore makes more sense than p 2 \u22a5b,c as an evolution variable, in spite of its nontrivial kinematics interpretation. Furthermore, emissions with negative pzc should preferably be associated with radiation off the other incoming parton, where it is collinearly enhanced, so this region is less important.\nQuark-mass effects are less crucial for ISR than for FSR: nothing heavier than charm and bottom need be considered as beam constituents, and even those are suppressed. Kinematics have to be slightly modified if the outgoing parton c is not massless, e.g. in a g\u2192 qq branching. The main effect is a modified evolution p\u22a5, with eq. (99) replaced by\np2\u22a5evol = (1\u2212 z)(Q 2 +m2c ) , (116)\nand a reduced p\u22a5 in the branching, replacing eq. (115) by\np2\u22a5b,c = (1\u2212 z)Q 2 \u2212\nQ4\nm2ar \u2212m2c\nz + Q2\nm2ar\n=Q2 \u2212 z (Q2 +m2c )(m 2 br +Q 2)\nm2br . (117)\nCharm and bottom quarks raise another issue, namely what to do in the threshold region, i.e. around the Q2thr scale where g \u2192 cc or g \u2192 bb branchings are turned on in the PDF evolution. Normally, it is assumed that these quark PDFs vanish below Q2thr and then evolve above it as a massless quark would. Initially, thus fq(x ,Q2) \u221d ln(Q2/Q2thr). In backwards evolution of a c/b quark, this leads to a diverging dPb in eq. (79) for Q2 \u2192 Q2thr, and a vanishing no-branching probability. While such a behaviour is possible to handle by evolving with gradually smaller Q2 steps as the threshold is approached, the chosen solution is instead to rely on the known forwards-evolution PDF shape. Therefore, once p2\u22a5evol < f m 2 q, with f a parameter of the order of 2, a p2\u22a5evol is chosen logarithmically evenly between m 2 q and f m2q, and a z flat in the allowed range. Acceptance is based on the product of three factors, representing the running of \u03b1s, the splitting kernel (including the mass term) and the gluon density weight. At failure, a new p2\u22a5evol is chosen in the same range, i.e. is not required to be lower since no no-branching probability is involved.\nAs for FSR, the choices of p2\u22a5evol and z offers a possibility to match onto the singularity structure of common matrix elements, and thereby easily correct to matrix-element expressions. Consider e.g. qq\u2032\u2192 gW\u00b1 [81]. The q\u2192 qg branching gives a denominator t\u0302( t\u0302 + u\u0302) and q\u2032\u2192 q\u2032g a denominator u\u0302( t\u0302+ u\u0302), which combine to t\u0302 u\u0302, in agreement with the matrix element. This also illustrates how the full ISR radiation pattern can be subdivided into contributions from the two sides.\nOne special option in the ISR implementation, on by default, is the possibility to order the emissions in rapidity, or equivalently in angle, i.e. to veto any trial emission that leads to unordered emitted partons [79]. The backwards evolution is one towards smaller p\u22a5 and larger\nx values, so angular ordering is already implicit to first approximation, but the unordered emissions have a non-negligible impact that appears to be detrimental for some distributions. There are good arguments for a rapidity ordering to be a legitimate choice [84], to provide a consistent separation between ISR and FSR. But that was for a somewhat different algorithm, so this option should more be seen as one possible variation beyond the basic LL accuracy of the shower.\nStrong coupling By default a first-order running \u03b1s(p2\u22a5evol) is used, but alternatives are a fixed value or second-order running. Tuned \u03b1s(m2Z) values typically tend to come out somewhat above the PDG MS one [35]. This can be understood as absent higher-order effects, in splitting kernels and shower kinematics, being absorbed into effective values. Since these higher-order corrections differ between ISR and FSR, the \u03b1s(m2Z) are also set separately for the two.\nFurthermore, in the soft-gluon limit, it can be shown that the dominant O(\u03b12s ) splittingfunction term, which generates contributions starting from O(\u03b12s ln2) at the integrated level, can be absorbed into the LO splitting functions by translating to the so-called Catani\u2013 Marchesini\u2013Webber (CMW) (also known as MC) scheme [85]. This means that an MS \u03b1s(m2Z) = 0.1185 would translate into an MC \u03b1s(m 2 Z) = 0.126. This goes some of the way towards explaining the PYTHIA default \u03b1s(m2Z) = 0.1365. It is possible to switch on the usage of the CMW rescaling procedure to allow a lower input \u03b1s(m2Z), but physics is only mildly modified by this.\nAnother consequence of staying at leading order is that usage of LO parton distributions is vastly to be preferred. If not, the description of ISR branchings at low scales becomes quite unreliable, for physical and technical reasons. The former are covered elsewhere, the latter are reflected in the need to have positive PDFs in eq. (79), which is not guaranteed at NLO.\nShower cutoff A lower cutoff scale p\u22a5min is needed both for ISR and FSR, but the two need not be same. The FSR one is related to the transition from partons to hadrons, and LEP experience gives us some understanding that too high a value does affect event shapes detrimentally. The ISR case is less clear cut. Experimental signals, such as the p\u22a5 spectrum of Z bosons in pp/pp collisions, are affected by the non-trivial interplay with primordial k\u22a5, cf. section 6.3.3. A lower p\u22a5min means more p\u22a5 kicks to the Z, but a shower initiator with a larger x , which means more dilution of its k\u22a5 in the cascade. One reasonable strategy therefore is to assume the ISR is damped in the same way as MPIs are, i.e. the dp2\u22a5/p 2 \u22a5 divergence is replaced by a dp2\u22a5/(p 2 \u22a50 + p 2 \u22a5) one. Alternatively, it is also possible to use a sharp cutoff.\nInterleaving Multiparton interactions and ISR are in direct competition for the beam-remnant momentum. Therefore, a combined downwards evolution in p\u22a5 of the two gives precedence to the harder parts of the event activities. There is no corresponding competition requirement for FSR to be interleaved, and FSR can also be viewed as occurring after the other two components in time. Interleaving is allowed, however, since it can be argued that a high-p\u22a5 FSR occurs on shorter time scales than a low-p\u22a5 MPI, say. Backwards evolution of ISR is also an example that physical time is not the only possible ordering principle. Rather, one can work with conditional probabilities: given the partonic picture at a specific p\u22a5 resolution scale, what possibilities are open for a modified picture at a slightly lower p\u22a5 scale, either by MPI, ISR, or FSR? This is the default approach taken.\nIt is possible to switch off the interleaving, and consider FSR after MPI and ISR. In that case it is also possible to allow FSR dipoles to be formed between matching colour-anticolour pairs in two different MPIs, whereas normally dipoles are local to each MPI separately.\nAnother ordering issue is when resonance decays and their showers are considered. By default, this is done after the ISR/FSR/MPI evolution of the hard process, and also after the handling of beam remnants and colour reconnections (CR). An option for \u201cearly resonance decays\u201d allows for the resonance-decay to be handled before remnants and CR; this does not alter the perturbative evolution, but partons from resonance decays can then participate in CR on an equal footing with partons from the production process. The option for \u201cinterleaved resonance decays\u201d [23] moves the resonance-decay handling even earlier, interleaving it with the ISR/FSR/MPI evolution of the hard process, with a few different options for which value of the perturbative evolution scale to associate to resonance decays, the default being of order the width of the resonance. This effectively represents an alternative treatment of finite-width effects; it is not a big effect for the standard-model particles, none of which has widths much larger than the shower cutoff, but could be relevant for precision studies and/or in BSM scenarios."
        },
        {
            "heading": "4.1.2 The dipole evolution",
            "text": "The previous subsection described the kinematics of a single branching. The full evolution in an event requires some further consideration, in particular related to the overall colour flow and the resulting set of radiating dipoles. In hadronic collisions the dipole pattern can be quite complicated. Consider the example of gg\u2192 gg scattering, as shown in fig. 7a, which is one of the six possible colour topologies for this process in the Nc \u2192\u221e limit. Each radiation now is characterized by whether the radiator is in the initial (I) or final (F) state, combined with the same classification for the recoiler, so in general four different emission types need to be considered.\nFinal-final radiation To begin with, consider the simple e+e\u2212 \u2192 \u03b3\u2217/Z \u2192 qq event. The first emission of a gluon, to give qqg, follows the pattern already outlined. Now the Nc \u2192 \u221e limit is applied to split the event into two dipoles qg and gq. Each can be considered in its respective rest frame, with the p\u22a5evol scale of the branching setting the upper limit for the continued evolution. In this evolution, the full emission rate of g \u2192 gg has to be split between the two dipoles. Using eq. (106), the effective splitting kernel becomes Pg\u2192gg(z) = (3/2)(1+ z3)/(1\u2212 z). Here, the emitter gluon takes the fraction z and the emitted 1\u2212 z, where the latter is the one straddling the two new dipoles. The radiation function from the q (or q) and g ends of the dipole have almost the same shape, the main difference being between the colour factors 4/3 vs. 3/2, which are smoothly mixed around the middle of the dipole, as already discussed for the angular dependence of q \u2192 qg vs. q \u2192 qg. There are known shortcomings with this colour factor treatment [59, 86], but these are of order 1/N2c and are neglected here. On the kinematics side, note that an emission in one dipole also affects the kinematics of adjacent ones, by virtue of sharing one gluon with changed momentum.\nInitial\u2013Initial (II) radiation The ISR and FSR descriptions can be separated so long as colour does not flow between the initial and the final state, as for the first emission in qq\u2192 Z, which is pure II. But once a gluon has been emitted, cf. fig. 7b, the two dipoles now bypass the Z, and the Z does not receive any further p\u22a5 recoil during the subsequent evolution. This runs counter to standard perturbation- and resummation-theory results, which is the reason why traditionally ISR has only been handled as II dipoles. That is, as shown in fig. 7b, the emission of a second gluon is handled as occurring from the (new) qq dipole, with Z+g together taking the recoil. Similarly, as shown in fig. 7a, the two IF dipole ends are replaced by doubling the strength of the II dipole.\nrg gb rp\npb\nFI/IF\nFI/IF\nII\nFF\nFigure 1: Colour flow for the process g(rg) + g(gb) \u2192 g(rp) + g(pb). Here, we are working\nin the limit where the number of colours goes to infinity so that p stands for the new\ncolour purple. The dashed lines represent the colour lines stretching between the dipole\nends. The type of dipole is indicated.\nZ0\nFI/IF FI/IF\nq\ng\nq\nFigure 1: Colour flow for the process qq \u2192 Z0g. The dashed lines represent the colour lines stretching between the dipole ends.\np\n\u03b3\u2217\ne\u2212 e\u2212\nq q\nFI/IF\nFigure 1: Deep inelastic scattering: an incoming electron scatters one of the quark within\nthe incoming proton. The dashed line represents the colour line stretching between the\ntwo dipole ends.\n(a) (b) (c)\nFigure 7: (a) Colour flow for the process g(r g) + g(g b)\u2192 g(rp) + g(pb). Here, the Nc \u2192\u221e limit is used so that p stands for the new colour purple. The dashed lines represent the colour lines stretching between the dipole ends. The type of dipole is indicated. (b) qq\u2192 Zg, again with colour lines and dipole types. (c) Deeply inelastic scattering, again with colour lines and dipole types.\nFinal\u2013Initial (FI) radiation Normally it should be possible to replace the FI ends by FF ones, with an arbitrary matching of the dipole ends, and such an option exists for exploratory purposes, but this is not the default. Instead, the recoiler r is now the incoming colour-connected parton. In a branching, studied in the dipole rest frame, a fraction Q2/m2ar of the recoiler energy should be given from the recoiler to the emitter, as in eq. (104). But now the increase of a momentum is not compensated anywhere in the final state. Instead, it is the momentum of the incoming recoiler that is increased, by the same amount as the emitter. Thus its momentum fraction x is scaled up as\nxr \u2032 =\n1+ Q2\nm2ar\nxr . (118)\nThe direction along the incoming beam axis is not affected by this rescaling. The kinematics construction therefore is similar to that of Catani\u2013Seymour dipoles [87]. It leads to an increased dipole mass mar and increased squared subcollision mass s\u0302, the latter by the same factor as xr . The increased x value again leads to an extra PDF weight\nxr \u2032 fr(xr \u2032 , p2\u22a5)\nxr fr(xr , p2\u22a5) , (119)\nin the emission and no-emission probabilities, to maintain a proper damping of radiation in the xr \u2032 \u2192 1 limit. The splitting of the full dipole radiation pattern is not as well understood in this case as for an FF dipole, however. Some rough estimates of how to share the full dipoleemission rapidity range can be made [79]. Based on these, an extra damping factor is applied by default, of the form Q2hard/(Q 2+Q2hard), where Q 2 hard is the relevant hard scale of the process, like 4p2\u22a5 for QCD 2\u2192 2 processes.\nInitial\u2013Final (IF) radiation Finally, a non-default option exists, where IF dipole ends are treated in their own right [80]. It then suffers from the above-mentioned problems with p\u22a5Z resummation, but it enables handling e.g. of deeply inelastic scattering (DIS), cf. fig. 7c, where II radiation is not an option (using the e\u2212 as recoiler would upset DIS kinematics), and presumably offers a more realistic description e.g. of weak-gauge-boson fusion to a Higgs. The kinematics step from b + r, where r is the colour-connected recoiler in the final state, to a+ c + r \u2032, as a consequence of the a\u2192 bc step, is easiest constructed in the b+ r rest frame.\nThere\npa = 1 z pb , (120)\npc = 1 z \u2212 1 pb + pshift , (121)\npr \u2032 = pr \u2212 pshift , (122)\npshift =\n(2z \u2212 1)Q2\n2mbr + z m2c mbr ; p\u22a5 cos\u03d5, p\u22a5 sin\u03d5,\u2212 Q2 2mbr \u2212 z m2r mbr Q2 +m2c m2br \u2212m2r , (123)\np2\u22a5 = (1\u2212 z)(Q2 +m2c )\u2212m 2 c 1\u2212 z Q2 +m2c m2br \u2212m2r \u2212m2r z Q2 +m2c m2br \u2212m2r\n2\n. (124)\nThe same set of rotations and boosts as used to recover the b+r rest frame can then be inverted to bring c and r \u2032 back to the event rest frame.\nSpecial cases What remains is to combine IF and FI emissions consistently. In the specific case of the first gluon emission from a DIS process, it turns out that the IF-type branching q\u2192 qg exactly reproduces the soft- and collinear-singularity structure of the \u03b3\u2217q\u2192 qg matrix element on its own, with only a mild mismatch in the numerator (which vanishes in the softgluon limit). Therefore, it would be possible to leave aside FI emissions in this case, and the same holds for g \u2192 gg splittings, but not for g \u2192 qq ones. So in general. both IF and FI contributions have to be used. One simplifying factor is that the incoming parton must always be along the beam axis, so there will only be one common phase-space mapping, unlike the case of FF or II dipoles. Nevertheless, the details become technical and we refer to [80] for further discussion. One small comment, however: when an emission from a qg dipole is considered, the two ends radiate with different colour charges, 4/3 and 3/2, respectively. The colour factors of the two ends are then mixed in proportion to the 1/m2 values of the emitted parton to the two dipole ends.\nAnother set of problems occurs in the decays of coloured resonances, say t\u2192 bW. In this case the colour dipole is stretched between the b and the hole left behind by the decayed t. In order to conserve momentum-energy, the b uses the W as a recoiler, and this choice is unique. Once a gluon has been radiated, however, it is possible to either still have the unmatched colour (inherited by the gluon) recoiling against the W, or to let it recoil against the b for this dipole as well. The former could give unphysical radiation patterns, so the latter is chosen by default, although it is not perfect either. A more detailed discussion of this issue can be found in [88]. The same issue exists for a second emission of QED radiation, e.g. in W+\u2192 e+\u03bde, but is obviously less significant there."
        },
        {
            "heading": "4.1.3 Matrix-element and other corrections",
            "text": "In this subsection we give a survey of some methods used to make the shower reproduce, or at least better approximate, known matrix-element behaviours. The methods to match and merge external matrix-element input to the showers are covered separately in section 5, so here we mainly describe program elements internal to the simple shower. Included are also some other \u201ccorrection\u201d aspects, that should offer improvements to the shower, or at least provide increased understanding by controlled variations.\nMatrix-element corrections One key capability is the first-order correction to resonance decays a\u2192 bc, where a gluon is emitted to give an a\u2192 bcg final state. The foremost example of this is e+e\u2212 \u2192 \u03b3\u2217/Z\u2192 qq\u2192 qqg [75]. This works because eq. (107) provides a way that\nthe parton shower exactly can reproduce the singularity structure of the matrix element, i.e. of the generic ratio\n1 \u03c3a\u2192bc d\u03c3a\u2192bcg dx1 dx2 . (125)\nThe 1 + z2 numerator of the splitting kernels also combines to an expression that overestimates the numerator of the matrix elements, e.g. x21 + x 2 2 for e\n+e\u2212 annihilation. In the vetoalgorithmic downwards evolution of the shower, it is therefore trivial to use the ratio of the correct numerator to the shower-kernel numerator, as a probability that a trial emission will be retained. In fact, for the evolution down to the first branching, it is as simple as putting the numerator equal to 2 and correct down from that.\nThis approach has then been extended to all combinations of colours and spins for a, b and c that can occur within the SM and MSSM [77], and can be reused for other models where the same colour and spin combinations occur. The inclusion of b and c masses as in eq. (108) also reproduces the proper propagator poles 1/(m2b\u2032 \u2212 m 2 b) and 1/(m 2 c\u2032 \u2212 m 2 c ) that are found in the matrix elements, such that all correction factors are well behaved over the whole phase space. Although the matrix elements are calculated for a first emission only, they are reused in a suitably modified form to include mass effects also in subsequent steps.\nSimilarly, there are a few processes where the first branching of an ISR shower are corrected to the respective matrix element [81], based on a common singularity structure. These include qq\u2192 Vg, qg\u2192 Vq, ff\u2192 V\u03b3, and f\u03b3\u2192 Vf, where V = \u03b3\u2217/Z/W\u00b1/Z\u2032/ . . . is a colour-singlet vector boson. In the point-like-coupling approximation, also Higgs production gg\u2192 H and \u03b3\u03b3\u2192 H is handled.\nIt should be feasible to include a matrix element correction to DIS in the same fashion as already outlined, but this has not been done yet. A generic and more detailed discussion of matrix-element corrections is given in section 5.\nPower and wimpy showers In the cases above, the ISR/FSR showers are allowed to cover the full phase space, so-called power showers [89]. We have seen that they can reach the furthest corners no worse than being a factor two off, which then could be fixed by modest reweighting. One guess is that this would hold true also in other processes, where no matrixelement correction factors have been implemented. But there are counterexamples. Consider QCD jet production, say, starting out from 2 \u2192 2 partonic processes. Then a low-p\u22a5 2 \u2192 2 process could not be allowed to shower further partons at high p\u22a5, or else such high-p\u22a5 production would be double counted and the whole perturbative framework would be undermined. So the logical p\u22a5evol,max shower starting scale is the p\u22a5 scale of the 2 \u2192 2 process, i.e. the factorization scale, giving wimpy showers. Comparisons with 2\u2192 3 matrix elements confirm that such a scale choice is close to optimal [79].\nIn general, it is possible for the user to choose between power and wimpy showers, even separately for ISR and FSR. The default option involves a choice between the two based on the likelihood of double counting:\n\u2022 If the final state of the hard process (not counting subsequent resonance decays) contains at least one quark (u, d, s, c, b), gluon, or photon then p\u22a5evol,max is chosen to be the factorization scale for internal processes and the scale value for Les Houches input, i.e. wimpy showers.\n\u2022 Else, emissions are allowed to go all the way up to the kinematic limit, i.e. power showers.\nThe reasoning is that in the former set of processes, the ISR emission of yet another quark, gluon, or photon could lead to double counting, while no such danger exists in the latter case.\nIn cases where more is known about the context of a particular event sample, e.g. when doing matching and merging, it is important to make use of this knowledge to override the default behaviour. One example is to start out with power showers but then implement a user hook to reject those emissions that would double count the particular cuts of the event sample.\nDamped showers While there are processes where power or wimpy showers are appropriate, there are also ones where the actual behaviour lies in between. It is relevant to recall that the characteristic cross-section shape of a shower emission is dp2\u22a5/p 2 \u22a5, while that of QCD 2\u2192 2 process is dp2\u22a5/p 4 \u22a5. That is, the p\u22a5 spectrum of a parton ought to begin to drop faster around the scale where it goes from being a soft add-on to being a part of the core hard process. For top-pair production gg\u2192 ttg, e.g. the gluon emission can be approximated by a shape\ndP dp2\u22a5g \u221d 1 p2\u22a5g\nk2M2\nk2M2 + p2\u22a5g , (126)\nwhere M2 is a reasonable scale to associate with the hard process and k2 is a fudge factor of order unity. This generalizes into the possibility to use a power shower with an additional damping factor k2M2/(k2M2 + p2\u22a5evol). Studies [90] show that this is a reasonable approach for coloured final states, e.g. for pairs of supersymmetric coloured particles, whereas a simple power shower is more appropriate for pair production of uncoloured particles. This can be understood as reduced emission by a destructive interference between ISR and FSR when colours flow from the initial to the final state [91], but only if there is such flow.\nGluon splittings The pure s-channel nature of g\u2192 qq splittings motivates the introduction of an option with \u03b1s(m2qq) rather than \u03b1s(p 2 \u22a5evol), where mqq is the invariant mass of the qq pair. More importantly, the cuts on the allowed z range during the FSR evolution imply that the branching rate is reduced relative to expectations from matrix elements. Therefore, for this branching only, the default option is to weigh up the splitting kernel inside the allowed z range to give the correct integrated matrix-element weight. Furthermore, this range is afterwards remapped to cover the full range of decay angles, disregarding the normal p\u22a5 ordering. This treatment is especially important for charm and bottom quarks, where the mass is not negligible and mass corrections should be reproduced both in rate and in angular distributions. As a final twist, the matrix element for H\u2192 gg\u2192 gqq does reproduce the expected behaviour e.g. from e+e\u2212 \u2192 \u03b3\u2217 \u2192 qq, but times a factor (1\u2212m2qq/m 2 H)\n3. The default option uses this factor, with the radiating dipole mass replacing the Higgs one, to suppress high-mass branchings.\nDead cones For topologies where a gluon recoils against a massive quark (or another massive coloured particle) there are no suitable ME corrections implemented into PYTHIA. When the dipole radiation pattern is split into two ends, with a smooth transition between the two, this means that the gluon end can radiate into the quark hemisphere as if the quark were massless. The \u201cdead cone\u201d effect, that radiation collinear with a massive quark is strongly suppressed, thereby is not fully respected. (Unlike radiation from the quark end itself, where mass effects are included.) By default, a further suppression is therefore introduced for g\u2192 gg branchings, derived as the massive/massless ratio of the eikonal expression for dipole radiation, which eliminates radiation collinear with the quark. The g \u2192 qq branchings currently are not affected; the absence of a soft singularity implies that there is hardly any radiation into the recoiler hemisphere anyway.\nGlobal recoil The default ISR and FSR showers differ, in that the former uses a global recoil while the latter uses a dipole one. That is, the recoil from an emission is carried by all final-state\nparticles in ISR, but only by a single one in FSR. Then we introduced an option where dipole recoil can be used for ISR. As it turns out, there is also an option to obtain a global recoil in FSR. In such a scenario, the radiation pattern is unrelated to colour correlations, which could be seen as a disadvantage. It is convenient for some matching algorithms, however, where a full analytic knowledge of the shower radiation pattern is needed to avoid double counting, so it is by such user requests that the option is made available.\nTechnically, the radiation pattern is most conveniently represented in the rest frame of the final state of the hard subprocess. Then, for each parton at a time, the rest of the final state can be viewed as a single effective parton. This \u201cparton\u201d has a fixed invariant mass during the emission process, and takes the recoil without any changed direction of motion. The momenta of the individual new recoilers are then obtained by a simple common boost of the original ones. With the whole subcollision mass as \u201cdipole\u201d mass, the phase space for subsequent emissions is larger than for the normal dipole algorithm, which leads to a too steep multiplication of soft gluons. Therefore, the main application is for the first one or few emissions of the shower, where a potential overestimate of the emission rate is to be corrected by a matching to the relevant matrix elements. Thereafter, subsequent emissions should be handled as before, i.e. with dipoles spanned between nearby partons. Several process-dependent settings are needed to use this option.\nAzimuthal asymmetries Parton-shower branchings are assumed to occur isotropically in azimuthal angle \u03d5, in the rest frame of the respective dipole. The boost to the overall CM frame then gives rise to the familiar \u201cstring effect\u201d [92, 93] coherence phenomenon, where particle production is enhanced in the region between two colour-connected partons. But there are also azimuthal correlations arising from parton polarization [94]. Notably, gluons tend to be plane polarized, with the decay plane of g \u2192 gg branchings favourably aligned with the production plane, while g\u2192 qq ones tend to be aligned orthogonal to it. The former branching type is common but with small asymmetries, while the opposite holds for the latter branching type, so that net effects are small. They are included nevertheless, since they may have some effect in charm and bottom production.\nUser hooks There are also other user hooks that can be used to modify the shower evolution. The ones that allow an ISR or FSR emission to be vetoed play a key role in matching and merging schemes and therefore are described in section 5."
        },
        {
            "heading": "4.1.4 QED, electroweak and other showers",
            "text": "The simple shower includes several extensions beyond the QCD core discussed so far. Characteristic is that these form part of the same evolution in a common p\u22a5evol scale, although with some distinguishing features.\nQED shower The most obvious extension is to QED. The required branching kernels have been presented in eqs. (74) and (75). In the evolution equations \u03b1s(p2\u22a5evol) is replaced by \u03b1em(p2\u22a5evol), but otherwise most that has been written about q\u2192 qg and g\u2192 qq carries over. A dipole language is used also for QED emissions, but the dipoles may be different from the QCD ones. An example is e+e\u2212\u2192 \u03b3\u2217/Z\u2192 qq\u2192 qqg, where the last stage contains two colour dipoles qg and gq, but only one charge dipole qq, since the gluon carries no electrical charge. The complete multipole radiation pattern may be poorly represented by a set of simple dipoles in cases with multiple charges, since there is no confinement mechanism in QED to further a unique dipole setup. In reality, few events contain multiple QED charges to consider, and if\nso, often the event history suggests a reasonable division, e.g. when a new dipole arises from a \u03b3\u2192 ff branching.\nThe lower cutoff on QED radiation in a hadron beam is not bound to be the same as the QCD one, i.e. since there is no issue of \u03b1em diverging at low scales. Nevertheless it is plausible to assume that the QCD cutoff is related to the transition from quarks to hadrons, and thus should be applied to all radiation. For radiation off a lepton, there is no such restriction, and PYTHIA then by default sets p\u22a5evol,min = 10\u22126 GeV for FSR and 5 \u00b7 10\u22124 for ISR. These values are fully sufficient to cover the emission of any photons observable at a collider. They are also adjusted to be in a region where kinematic reconstruction still works well in double precision. It has been pointed out that they are not sufficiently low to generate the full observable-photon spectrum when PYTHIA is applied to whatever processes could give the highest-energy cosmic rays.\nThe branching of a photon, \u03b3\u2192 ff, does not fit well into the dipole picture. The choice of a recoiler is based on the history to the largest extent possible, i.e. based on what the photon was produced in association with. The photon branchings in part compete with the hard processes involving \u03b3\u2217/Z production. In order to avoid overlap it makes sense to correlate the maximum \u03b3mass allowed in showers with the minimum \u03b3\u2217/Z mass allowed in hard processes, by default at 10 GeV. In addition, the shower contribution only contains the pure \u03b3\u2217 contribution, i.e. not the Z part, so the mass spectrum above around 50 GeV would not be well described.\nElectroweak shower The emission of W\u00b1 and Z gauge bosons off fermions is an integrated part of the ISR and FSR frameworks, and is fully interleaved with QCD and QED emissions [83]. It is off by default, however, since it takes some time to generate trial emissions, whereof very few result in real emissions unless the fermion transverse momenta are much larger than the W/Z masses. These masses also have a considerable impact on the phase space of emissions, which the shower is not set up to handle with a particularly good accuracy. Therefore, the weak-shower emissions are always matched to the matrix element for emissions off an ff weak dipole, or some other 2\u2192 3 matrix element that resembles the topology at hand. Even if the match may not be perfect, at least the main features should be caught that way. Notably, the correction procedure is used throughout the shower evolution, not only for the emission closest to the hard 2\u2192 2 process. Also, the angular distribution in the subsequent V =W\u00b1/Z decay is matched to the matrix-element expression for ff\u2192 ffV\u2192 fff\u2032f \u2032 (FSR) and ff\u2192 g\u2217V\u2192 g\u2217f\u2032f \u2032 (ISR). Afterwards, the f\u2032f \u2032\nsystem undergoes showers and hadronization just like any W\u00b1/Z decay products would.\nSpecial for the weak showers is that couplings are different for left- and right-handed fermions. With incoming unpolarized beams this should average out, at least so long as only one weak emission occurs. In the case of several weak emissions off the same fermion, the correlation between them will carry a memory of the fermion helicity. Such a memory is retained for the affected dipole end. The flavour-changing character of W\u00b1 emissions also affects the tight relation between the real-emission evolution and Sudakov factors, so-called Bloch\u2013 Nordsieck violations. These effects are not expected to be large, but they are not properly included. Another restriction is that there is no simulation of the full \u03b3\u2217/Z interference: at low masses, the QED shower involves a pure \u03b3\u2217 component, whereas the weak shower generates a pure Z. Finally, it should be remembered that this is not a full (electro)weak shower, which would also have required interactions among gauge bosons, and even involved the Higgs boson. These interactions are included, e.g. in the VINCIA EW shower, cf. section 4.2.4.\nOnia Hard production of charmonium and bottomonium can proceed either through coloursinglet or colour-octet mechanisms. In the former case, the state does not radiate and the onium is therefore produced in isolation, while it is sensible to assume that a shower can\nevolve in the latter case, giving an onium state embedded in some amount of jet activity. Currently, both cases are initiated by 2 \u2192 2 interactions directly producing an onium state; the alternative mechanism of producing onia during the shower evolution itself [95] is not (yet) implemented. Emissions off an octet-onium state could easily break up a semi-bound quark pair, but might also create a new semi-bound state, and to some approximation these two effects should balance in the onium production rate. The showering implemented here therefore should not be viewed as an accurate description of the emission history step by step, but rather as an effective approach to build up the onium environment. The simulation of branchings is based on the assumption that the full radiation is provided by an incoherent sum of radiation off the quark and off the antiquark of the onium state. Thus, the splitting kernel is taken to be the normal q \u2192 qg one, multiplied by a factor of two. A number of corrections to this picture could be imagined; since they would come with opposite signs the assumption is that they cancel out. Further discussion is also included in section 3.3.\nBaryon-number-violating decays A complicated case for showering is baryon-number-violating decays, e.g. a neutralino decaying to three quarks. It is then not possible to assign an ordinary dipole configuration. Instead half-strength dipoles are constructed between each pair of quarks. That way the total emission rate from each quark is at normal strength, and the recoil can be taken by either of the other two quarks. Similar reduced-showering-rate dipoles can be selected also in a few other cases.\nHidden Valley processes The Hidden Valley (HV) scenario, introduced in section 3.7, has been developed specifically to allow the study of visible consequences of radiation in a hidden sector, either by recoil effects or by leakage back into standard-model particles. A key aspect therefore is that the normal timelike showering machinery has been expanded with a third kind of radiation, in addition to the QCD and QED(+EW) ones [38, 39]. These three kinds are fully interleaved, i.e. evolution occurs in a common p\u22a5-ordered sequence. This radiation may be described either within a (possibly broken) U(1) or an unbroken SU(N) gauge group, but not both simultaneously. Thus, one has either HV-photons or HV-gluons as interaction carriers, where the latter are non-Abelian and may branch into more HV-gluons. A set of 12 new particles mirrors the standard-model flavour structure, and is charged under both the SM and the HV symmetry groups, so that they can radiate both into the visible and invisible sector. There is also a new massive particle with only HV charge, sitting in the fundamental representation of the HV gauge group, denoted an HV-quark.\nHV particles are only produced in or after the hard process, so only FSR needs to be considered. The HV radiation defines its own set of dipoles, usually between opposite charges. Decays of massive particles can give rise to the same kind of issues as for top decays, i.e. that a dipole properly involves the hole of the decaying particle. Matrix-element corrections are implemented for a number of decay processes, with colour, spin, and mass effects included, as for SM processes. These were calculated within the context of the particle content of the MSSM, however, which does not include spin-1 particles with unit colour charge. In such cases spin 0 is assumed instead. By experience, the main effects come from mass and colour flow anyway, so this is not a bad approximation. In the case of a broken U(1) symmetry, the HV-photon is massive, which requires some kinematics corrections relative to ordinary QED radiation. If decays back to the SM occur, e.g. the HV-photon by mixing with the ordinary \u03b3, then also ordinary showers are allowed. By default the coupling strength is fixed, but running is allowed, given the gauge group and the contributing matter content."
        },
        {
            "heading": "4.1.5 Algorithms for automated shower variations and enhanced splittings",
            "text": "Several variations of the simple shower are available in an automated fashion, to help construct uncertainty bands for predictions [20]. That is, weights are constructed and associated with the shower evolution under different alternative conditions, at the same time as the normal showers (with unit weight) are evolved. The properties of an event only need to be analysed once, but can then be filled in one histogram for each distinct variation, with its associated event weight, and at the end these histograms can be combined to provide the uncertainty band. Variations can be set for the renormalization scale for ISR and FSR QCD emissions (separately), for the inclusion of non-singular terms in the ISR and FSR splitting kernels (separately), and for different PDF members.\nThe veto algorithm is used to generate parton-shower histories for the physics parameters chosen at initialization as normal. Using eq. (16), we can compute sets of weights (which we call variations) for each event reflecting the changed probability for that event under different possible choices of physics parameters. The number of variations calculated is limited only by finite computing and memory resources.\nWhile the proof of unitarity is more easily realized using eq. (16), the algorithm is employed discretely. Thus the factors\nf (t \u2032) g(t \u2032)r(t \u2032) (acc) and 1\u2212 f (t \u2032)/g(t \u2032) 1\u2212 r(t \u2032) (disc) , (127)\ncan be calculated at each discrete step and book-kept during the shower to calculate an event weight. The factors (acc) account for the effect in accepted splittings, while the factors (disc) preserve unitarity from the discarded trial splittings.\nParton-Shower Variations Parton-shower variations are calculated by considering an alternative shower algorithm with an alternative radiation kernel P \u2032(t, z). The physical trial-accept probability, P \u2032acc, for this alternative shower is the ratio of the alternative kernel to the unchanged oversampling kernel. An alternative radiation kernel could have a different treatment of \u03b1s, different non-singular terms in the splitting kernels, and/or different effective higher-order terms. In principle, one could also imagine varying the definition of the shower evolution scale, t, as was done in [96], or other shower aspects such as the splitting variable z or the recoil scheme, but calculations of weights for such variations are currently not available in PYTHIA. Suppressing the z dependence for clarity, the algorithm to compute the probability of an event generated by P \u2032 based on an event generated using P is [20,64]:\n1. Initialize all weights to the input value of the event w\u2032 = w.\n2. For an accepted branching, multiply the value of the parton-shower-variation weight w\u2032\nby the ratio of accept probabilities,\nR\u2032acc(t) = P \u2032acc(t)\nPacc(t) = P \u2032(t) P(t) . (128)\n3. For a rejected branching, multiply w\u2032 by the ratio of rejection probabilities,\nR\u2032disc(t) = P \u2032disc(t)\nPdisc(t) = 1\u2212 P \u2032acc(t) 1\u2212 Pacc(t) = P\u0302(t)\u2212 P \u2032(t) P\u0302(t)\u2212 P(t) , (129)\nwhere P\u0302 is the trial overestimate used for generating a branching.\nNote that steps 2 and 3 adjust the branching and no-branching probabilities, respectively, so that the set of weights w\u2032 represents a separately unitary event sample. In other words, the samples integrate to the same total cross section, i.e. w\u2032\n= \u2329w\u232a. The denominator of the relative discard-ratio, eq. (129), is given by the difference P\u0302\u2212P. If the trial overestimate, P\u0302, is very close to P, the denominator can become close to zero, producing large weights that may be numerically unstable. This occurs because the variation algorithm effectively uses failed trials to estimate the modifications to the no-branching probabilities, and if the algorightm is \u201ctoo efficient\u201d, with few failed trials, then each failed trial must represent a rather large correction, resulting in large fluctuations. A technical fix is to apply a \u201cheadroom factor\u201d to the trial functions when automated uncertainty variations are requested so that there is always a non-negligible probability for trials to be discarded. These enhanced rejections come at the cost of computational speed.\nEvery accepted trial emission contributes a factor R\u2032acc to the final event weight w \u2032 in the full shower evolution, while every discarded trial emission contributes a factor R\u2032disc, hence the total weight is just the product:\nw\u2032 = \u220f\ni\u2208accepted\nP \u2032i,acc Pi,acc\n\u220f\nj\u2208discarded\nP \u2032j,disc Pj,disc . (130)\nTechnically, a few limiting factors are imposed on the variation weights, as will be described further below, mainly in order to prevent large fluctuations from low-scale branchings that do not have much impact on (infrared and collinear safe) observable distributions.\nRenormalization-Scale Variations A standard method to estimate uncertainties from unknown higher-order contributions is to vary the QCD (and/or QED) renormalization scale(s). For a coherent shower algorithm based on p\u22a5, a judicious choice of a renormalization-scale prefactor \u2014 the so-called CMW scale factor \u2014 takes leading second-order corrections from soft-gluon emissions into account, and the framework for shower renormalization-scale variations in PYTHIA is constructed to preserve this property. This is done by including an (optional) explicit O(\u03b12s ) compensating term that restores the soft limit of the NLO expansion of the effective scale choice.\nSpecifically, for each shower kernel P(z), we define renormalization-scale variations by:\nP(t, z) = \u03b1s(p\u22a5) 2\u03c0 P(z) t \u2192 P \u2032(t, z) = \u03b1s(kp\u22a5) 2\u03c0 1+\u03b4soft(k) P(z) t , (131)\nwhere k is the renormalization-scale-variation factor (relative to the default argument p\u22a5) and \u03b4soft(k) is the soft compensation term, which we define as\n\u03b4soft(k) = (1\u2212 \u03b6) \u03b1s(\u00b5max)\n2\u03c0 \u03b20 ln k , (132)\nwith \u03b20 = (11Nc \u2212 2nF )/3, Nc = 3, and nF the number of active flavours at the scale \u00b5 = p\u22a5. The purpose of the factor (1\u2212 \u03b6) is to suppress the compensation term outside the soft limit. We define it via:\n\u03b6=\n\n\n\nz , for splittings with a 1/z singularity , 1\u2212 z , for splittings with a 1/(1\u2212 z) singularity ,\nmin(z, 1\u2212 z) , for splittings with a 1/(z(1\u2212 z)) singularity . (133)\nThe choice of renormalization scale for the \u03b1s factor in eq. (132) is beyond NLO accuracy. To be conservative and to avoid the risk of overcompensating, our choice is to use the largest local\nscale in the problem. Specifically, \u00b5max =max(mdip, kp\u22a5), where mdip is the invariant mass of the emitting colour dipole. Note, this compensation term is only applied to gluon emissions. For g \u2192 qq\u0304 splittings, the full (uncompensated) variation, \u03b1s(kp\u22a5)/\u03b1s(p\u22a5) is applied.\nA subtlety is that, if the choice of k causes the scale to cross any quark-mass thresholds, \u03b1s(kp\u22a5) will not be evaluated with the same number of active flavours nF as the nominal shower would. For reasonable values of k, this is a small effect since matching conditions are applied in PYTHIA to make the running continuous across thresholds. In principle, an additional term \u03b1s/(2\u03c0) ln(mq/(kp\u22a5))/3 could be added to compensate for the different \u03b20 coefficients used in the region. But since this would reduce the variation, we consider it more conservative to leave it out, which may then also partially reflect the additional ambiguity in the running in the vicinity of thresholds.\nThus, we arrive at the following form for the reweighting factor for accepted branchings,\nR\u2032acc(t, z) = P \u2032acc(t, z) Pacc(t, z) = \u03b1s(kp\u22a5) \u03b1s(p\u22a5) 1+ (1\u2212 \u03b6) \u03b1s(\u00b5max) 2\u03c0 \u03b20 ln k . (134)\nThe user has a wide range of options available for calculating parton-shower scale variations for ISR or FSR. Technically, to limit large weight fluctuations between events with and without a very soft branching near the end of the evolution, we impose an absolute limit on the allowed amount of \u03b1s variation. By default, |\u2206\u03b1s| \u2264 0.2. This choice is not a significant restriction on the range of variation for perturbative branchings (even when \u03b1s \u223c 0.5, a full 40% amount of variation is still allowed), but it does prevent variations corresponding to branchings very near the cutoff, which should not have a significant impact.\nFinite-Term Variations Another class of parton-shower variations is related to non-singular terms in the splitting kernels, also called \u201cfinite terms\u201d. The exact forms of the parton-shower branching kernels are only uniquely determined in the singular (infrared soft and/or collinear) limits. Away from these limits, one is in principle free to choose shower kernels that differ from, say, the DGLAP kernels, by non-singular contributions. (Notably, this freedom is exploited in the context of matrix-element corrections and in the POWHEG method, cf. section 5.) Setting the non-singular terms to zero is an arbitrary choice and is anyway not stable against reparameterizations [64, 97]. In the absence of matrix-element corrections, it therefore makes sense to vary the finite terms, e.g. provide an estimate for how significant the effects of the missing matrix-element corrections could be.\nThe effects of finite-term variations are qualitatively different from those of renormalization-scale variations. By construction, the latter are proportional to the shower kernels. But away from the singular limits, the pole terms in the radiation function are not enhanced, and may not bear much resemblance to a corresponding matrix-element based calculation for the process at hand. In exactly these regions, modest finite terms can produce larger variations than scale choices can. PYTHIA provides the possibility to explore such variations.\nTo account for non-singular terms, the radiation function based on DGLAP is modified as follows:\nP(z) Q2 dQ2 \u2192 P(z) Q2 + c m2dip dQ2 = P(z) + c Q2 m2dip d t t , (135)\nwhere mdip is the invariant mass of the dipole in which the splitting occurs and the finite-term variation parameter c is a dimensionless constant of order unity. This expression uses the identity dQ2/Q2 = dt/t, which holds for any t = f (z)Q2 and covers all the PYTHIA evolution\nvariables. The alternative splitting kernel is then\nP \u2032(t, z) = \u03b1s 2\u03c0 C P(z) + c Q2/m2dip t , (136)\nwhere C is the colour factor, leading to the acceptance factor:\nR\u2032acc = P \u2032acc Pacc = 1+ c Q2/m2dip P(z) . (137)\nFrom this expression, it is immediately apparent that the relative variation explicitly vanishes when Q2\u2192 0 or P(z)\u2192\u221e. For gluon emission off timelike massive quarks, Q2 is changed to the off-shellness of the massive quark, defined as Q2 = (pb + pg)2 \u2212m2b = 2pb \u00b7 pg [77], with pb the four-momentum of the massive quark and pg that of the emitted gluon.\nWe suggest variations on the order of unity (c \u2208 [\u22122,2] to be conservative) as a baseline. This is motivated by PYTHIA\u2019s Matrix Element Corrections (MEC) for Z-boson decays [75] and by explicit numerical studies [97] that found order-unity differences between different physical processes and different antenna-shower formalisms.\nVeto Algorithm with Biased Kernels The veto algorithm can also be modified to enhance the rate of some or all splittings in the shower. In this case, the event weight is modidified to account for the relative overpopulation of events with such splittings (and underpopulation of events without). This has applications, e.g. for enhancing the rate of relatively rare splittings, like q \u2192 q\u03b3 and g \u2192 bb\u0304. The biasing method implemented in PYTHIA 8.3 is described in [15,20] and is formally identical to that of [98].\nFor simplicity, assume that one of many splitting types is to be biased by an enhanced trial factor E > 1. The (new) oversampling kernel will be\nP\u0302biased = EP\u0302 , (138)\nso that more of the desired splittings are encountered in the veto algorithm. Keeping the (old) accept probability unchanged, the bias can be incorporated into a weight inversely proportional to the biasing factor:\nPacc = P\nP\u0302 ; Racc =\nP\u0302\nP\u0302biased = 1 E . (139)\nWith this modification, the original distribution for the desired splitting is recovered, since RaccPacc P\u0302biased = P. Similarly, when a biased trial branching is not accepted, a different weight is applied to the event:\nRdisc = 1\u2212 PaccRacc\n1\u2212 Pacc =\nP\u0302\nP\u0302 \u2212 P\n1\u2212 P\nP\u0302biased\nP P\u0302biased\u2192 P\u0302\nP\u0302 \u2212 P , (140)\nFor very large values of E, the reweighting factor becomes independent of the bias, but is still important for recovering the physical no-branching probability. Strictly speaking, E does not have to be a constant and could be allowed to depend upon the shower kinematics, but currently only a simple constant factor is implemented in PYTHIA, which can be specified independently for each type of shower splitting."
        },
        {
            "heading": "4.2 The VINCIA antenna shower",
            "text": "The VINCIA shower implements an interleaved p\u22a5-ordered evolution based on the so-called antenna formalism. In event-generator contexts, this type of shower was first pioneered by the ARIADNE model [4,54], which was widely used e.g. at LEP. For completeness, we note that the objects we call \u201cantennae\u201d here were actually called dipoles in that context, but today the term dipole has taken on a different meaning, see, e.g. section 4.3 on DIRE.\nEspecially for FSR QCD radiation, VINCIA shares many features with ARIADNE, including its evolution-variable definition and its antenna-style 2 7\u2192 3 approach to parton branchings in which both parents can acquire transverse recoil and the soft eikonal remains unpartitioned. These latter two properties are specific to antenna showers.\nFor ISR, VINCIA\u2019s treatment is quite different from that of ARIADNE, with VINCIA extending the concept of (interleaved) backwards evolution [52,78] to the antenna picture [99] via coherent II and IF antennae [100], as well as so-called Resonance\u2013Final (RF) ones [88]. The latter are relevant to the decays of coloured resonances, such as top quarks. They come with their own, dedicated kinematic mapping which is constructed to preserve the invariant mass of the decaying resonance. Since all of its building blocks are explicitly coherent (at least at leading colour) and interleaved in a single common sequence of decreasing p\u22a5 values, VINCIA should exhibit a quite reliable description of soft coherence effects across essentially all physical contexts.\nThis extends to QED, for which VINCIA\u2019s default antenna functions [101,102] include fully coherent (multipole) soft interference effects in addition to the collinear DGLAP structures. We are not aware of any other multipole QED treatment that can be interleaved with the QCD evolution. (e.g. the YFS formalism [103] is constructed purely as an \u201cafterburner\u201d, i.e. not interleaved with the QCD shower, and collinear logarithms can only be included order by order.)\nA further difference with respect to ARIADNE is that VINCIA\u2019s QCD and multipole QED showers are constructed as so-called \u201csector\u201d antenna showers, in which the phase space is divided into distinct (non-overlapping) colour and kinematics sectors, each of which only receives contributions from one specific antenna-branching kernel. This has a number of mainly technical consequences which will be elaborated on further below, to do with making the incorporation of higher-order corrections as straightforward and efficient as possible. For the time being, ARIADNE-style \u201cglobal\u201d showers also remain available as a non-default option.\nEffects of particle masses are systematically included, both via mass corrections to the antenna functions such that all relevant (quasi-)collinear limits are reproduced [100, 104], and by the use of exact massive phase-space factorizations. The current default behaviour is to treat bottom and heavier quarks, and muons and tau leptons, as massive in VINCIA, though this can be changed if desired. (Weak bosons are always treated as massive.) A subtlety arises in the treatment of incoming heavy-flavour quarks (and, potentially, muons). Kinematically, such partons are book kept as massless, similarly to the choice made in PYTHIA\u2019s simple shower. The consequence is that the treatment of mass effects for initial-state partons in VINCIA is less rigorous than for final-state ones. One should also be aware that there can be a non-trivial interplay with the flavour scheme employed by the chosen PDF set.\nAs a complementary option to the multipole QED shower, VINCIA also includes a module for full-fledged electroweak showers [23, 105]. This option includes the full set of EWbranching kernels, including both Higgs couplings and gauge-boson self-interactions, tallying to more than 1000 EW-antenna functions in total. The main limitation is that only the relevant (quasi-)collinear limits are implemented, not the full soft interference structure; thus, also the QED treatment is effectively reduced to a DGLAP-style treatment when using this option. Note also that the EW module is based explicitly on VINCIA\u2019s underlying formalism for helicity-dependent showers [106,107] (e.g. to tell left- and right-handed weak bosons apart).\nThis module therefore requires Born partons with assigned helicities, which is not the default in PYTHIA, and must be provided either via external LHEF events with helicity information, or via VINCIA\u2019s dedicated option for hard-process helicity selection. (The latter is based on PYTHIA\u2019s run-time interface to external matrix-element libraries; see the program\u2019s online manual and example programs for configuration and linking instructions.)\nA further feature that was originally introduced with VINCIA\u2019s electroweak-shower module, but is now applied independently of it, is a novel treatment of finite-width effects, called interleaved resonance decays [23], which are the default in VINCIA. This means that decays of short-lived resonances, such as top quarks, W/Z bosons, or BSM particles, are inserted in the shower evolution at an evolution scale of order the off-shellness of the resonance, instead of being treated sequentially, after the shower of the hard process. This reflects the physical picture that short-lived particles should not be able to radiate at frequencies lower than the inverse of their lifetime; only their decay products can do that. This can produce subtle changes in reconstructed invariant-mass distributions, relative to conventional (non-interleaved) resonance decays.\nAll of VINCIA\u2019s shower modules are fully interleaved with PYTHIA\u2019s treatment of multiparton interactions (MPI), in the same manner as for the simple-shower model."
        },
        {
            "heading": "4.2.1 Common features",
            "text": "Some aspects are common to all of VINCIA\u2019s shower modules. This includes the definition of the evolution variable as well as recoil schemes and phase-space factorizations. These common features are discussed in this subsection before going into further detail on each of the specific components of VINCIA\u2019s shower implementations.\nEvolution variables All showers in VINCIA, including the QED and EW ones, are evolved in a Lorentz-invariant scaled notion of off-shellness, based on a generalized version of the ARIADNE definition of transverse momentum. For a generic branching IK \u2192 i jk,\np2\u22a5 j = q\u03042i j q\u0304 2 jk\nsmax , (141)\nwhere the off-shellness for final-state partons is defined as\nq\u03042i j = (pi + p j) 2 \u2212m2I = m 2 i j \u2212m 2 I , i is final , (142)\nand that for initial-state partons is obtained via crossing (and an overall sign change to make it positive),\nq\u03042i j = \u2212(pi \u2212 p j) 2 +m2I , i is initial . (143)\nThese both involve the positive invariant 2pi \u00b7p j but differ in the signs of pre- vs. post-branching parton masses. This reflects the underlying crossing and sign change, combined with the propagator structure of backwards evolution. For convenience, we define the dimensionful invariant\nsi j \u2261 2pi \u00b7 p j , (144)\nregardless of whether particles i and j are massless or not. The maximal antenna invariant, smax, is then defined by\nsmax =\n\n   \n   \nsIK FF ,\nsa j + s jk IF & RF ,\nsab II ,\n(145)\nwhere initial-state partons are labelled with letters from the beginning of the alphabet (a and b) and final-state ones are labelled by i, j, k, . . .. Below, that labelling convention will be used systematically to distinguish initial- and final-state partons.\nWe also define dimensionless (scaled) invariants and masses,\nyi j = si j\nsmax ; \u00b52i = m2i smax . (146)\nFor massless kinematics, the scaled invariants have very simple relations to the z variables of DGLAP-style approaches. Thus, for final-final (FF) antennae, the CM energy fractions are\nxk = 2Ekp\nsIK = 1\u2212 yi j , (147)\nand similarly for the two other permutations of (i, j, k). For initial-initial (II) antennae, the incoming legs are always massless and the yAB invariant can be identified with the z variable, since\nyAB = sAB sab = xAxB xa xb = zazb , (148)\nwhere we have emphasized that, for antenna-II branchings, in general both x values change, with\nza = xA xa =\n\u221a \u221a \u221a\nyAB 1\u2212 y j b 1\u2212 ya j , and zb = xB xb =\n\u221a \u221a \u221a\nyAB 1\u2212 ya j 1\u2212 y j b . (149)\nThere is still the constraint that, in the a-collinear limit zb\u2192 1 and vice versa (for massless j). For initial-final (IF) ones, the exact relations are more involved but again the collinear limits can be examined via\nza = 1\u2212 y jk , zk = 1\u2212 ya j . (150)\nRecoil schemes In the antenna formalism, the branching recoil is shared between both antenna parents for FSR emissions in an on-shell kinematics map along the lines of [104,108,109] including full mass dependence. This is illustrated in the top row in fig. 8. In the collinear limits, any transverse momentum is fully absorbed within the collinear pair, and the anticollinear parent recoils purely longitudinally; therefore, in these limits the map agrees with the conventional dipole ones, cf. [87,110,111]. This means that the post-branching momenta are constructed as\np\u00b5i = (Ei , 0, 0, |~pi|) , (151) p\u00b5j = E j ,\u2212|~p j| sin\u03b8i j , 0, |~p j| cos\u03b8i j , (152)\np\u00b5k = (Ek, |~pk| sin\u03b8ik, 0, |~pk| cos\u03b8ik) , (153)\nin the rest frame of the parent I -K antenna. Here, the energies are given by\nEi = si j + sik + 2m2i\n2mIK , E j = si j + s jk + 2m2j 2mIK , Ek = sik + s jk + 2m2k 2mIK , (154)\nand the angles by\ncos\u03b8i j = 2Ei E j \u2212 si j 2|~pi||~p j| , cos\u03b8ik = 2Ei Ek \u2212 sik 2|~pi||~pk| . (155)\nThe branching plane is then rotated in the x-y plane, by an angle \u03c6, which is uniformly sampled in the range [0,2\u03c0]. The azimuthal rotation by \u03c6 is combined with a rotation by a polar angle \u03c8 whose value is only uniquely constrained in the two collinear limits. The case \u03c8\u2192 0 corresponds to parton i being oriented in the same direction as parton I . This limiting value is mandated in the K-collinear limit in which parton i must recoil purely longitudinally. In the I -collinear limit,\u03c8\u2192 \u03c0\u2212\u03b8ik ensures that parton k recoils longitudinally. A few different options are provided for how to interpolate between those limits, cf. [104,109].\nFor initial-state radiation, one (or both) parents must remain collinear to the beam axis, and instead the hard system can now acquire transverse recoil. This makes it more complicated to define a truly antenna-like recoil scheme, and VINCIA\u2019s choices [100, 112, 113] are more similar to dipole treatments such as the ones in [114\u2013117]. In the case of IF antennae, this amounts to constructing the post-branching momenta as\nxa = xA/yAK ( =\u21d2 p\u00b5a = 1\nyAK p\u00b5A) , (156)\np\u00b5j = (yak +\u00b52j \u2212\u00b5 2 k) + (yak \u2212 ya j)\u00b5 2 K \u2212 yAK yak\nyAK p\u00b5A + ya j p \u00b5 K +\n\u00c6\n\u0393a jk q \u00b5 \u22a5max , (157)\np\u00b5k = (ya j \u2212\u00b52j +\u00b5 2 k) + (ya j \u2212 yak)\u00b5 2 K \u2212 yAK ya j\nyAK p\u00b5A + yak p \u00b5 K \u2212\n\u00c6\n\u0393a jk q \u00b5 \u22a5max , (158)\nin the A-K rest frame, as illustrated in the second row in fig. 8. In this context, \u0393a jk = ya j y jk yak and q\u00b5\u22a5max denotes the transverse component in terms of a spacelike four-vector that is perpendicular to pA and pK and obeys q 2 \u22a5max = \u2212(sa j + sak).\nFor II antennae, both initial-state particles are evolved at the same time and therefore both momentum fractions change simultaneously [99, 118], cf. the third row in fig. 8 for an illustration. (Note that this is different to \u201cdipole\u201d kinematics, in which only one of the incoming x fractions can change in each branching.) Consequently, the post-branching momenta are constructed as\np\u00b5B , (159)\nxa = xA/za ( =\u21d2 p\u00b5a = p \u00b5 A/za) , (160) xb = xB/zb ( =\u21d2 p \u00b5 b = p \u00b5 B/zb) , (161)\np\u00b5j = y j bp \u00b5 a + ya j p \u00b5 b + \u00c7 ya j y j b \u2212\u00b52j q \u00b5 \u22a5max , (162)\np\u00b5r = p \u00b5 a + p\n\u00b5 b \u2212 p \u00b5 j , (163)\nwhere the za,b fractions are defined in eq. (149), q \u00b5\n\u22a5max is again a spacelike four-vector perpendicular to pA and pB with q 2 \u22a5max = \u2212sab, and r denotes the recoiling spectator system whose combined invariant mass and rapidity are both unchanged by the branching: p2r = p 2 R and yr = yR. In both IF and II antennae, all momenta are rotated about the branching plane by a uniformly distributed angle \u03c6 \u2208 [0,2\u03c0]. For RF antennae [88], the invariant mass of the resonance must be kept fixed, p2a = p 2 A = m 2 A. The post-branching kinematics are therefore constructed in the resonance rest frame with the z-axis defined along pK , so that\np\u00b5A = p \u00b5 a = (mA, 0, 0, 0) , (164) p\u00b5k = Ek, 0, 0, \u00c7 E2j \u2212m 2 k , (165)\np\u00b5j = E j , \u00c7 E2j \u2212m 2 j sin\u03b8 jk, 0, \u00c7 E2j \u2212m 2 j cos\u03b8 jk , (166)\np\u00b5r = mA\u2212 Ek \u2212 E j ,\u2212 \u00c7 E2j \u2212m 2 j sin\u03b8 jk, 0,\u2212 \u00c7 E2j \u2212m 2 k \u2212 \u00c7 E2j \u2212m 2 j cos\u03b8 jk , (167)\nwhere r denotes the remainder of the resonance decay system and\nE j = sa j\n2ma , Ek = sak 2ma , cos\u03b8 jk = 2EbEg \u2212 s jk 2 \u00c7\n(E2k \u2212m 2 k)(E 2 j \u2212m 2 j )\n. (168)\nThese momenta are rotated about the y axis such that the set of recoilers are along -z, so that only j and k receive transverse recoil. Again, the momenta are subsequently rotated by a uniformly sampled angle \u03c6 \u2208 [0, 2\u03c0] about the z axis. The original orientation of pK with respect to z is then recovered in a final step. This map is illustrated in the bottom row of fig. 8.\nHelicity Dependence All of VINCIA\u2019s QCD and EW (but not QED) antenna functions are implemented with full helicity dependence, i.e. decomposed into distinct terms for each set of contributing helicities. This facilitates helicity-dependent showering and matching, given a polarized Born state [107]. For brevity, the QCD antenna functions shown below are averaged over pre-branching helicities and summed over post-branching ones; see [100] for details on their individual helicity components.\nBiased branchings and uncertainty weights Just as for the simple shower, VINCIA contains several options for artificially increasing (or suppressing) the probabilities for different branching types to occur, accompanied by non-unity event weights to compensate for how over- or\nunder-represented each generated event becomes in the resulting sample. This can be especially useful to enhance the rate of rare splittings, such as g \u2192 bb\u0304. The general procedure is described in section 4.1.5 and follows the formalism presented in [20].\nAs a relatively minor extension, VINCIA also allows for \u201cenhancement\u201d factors smaller than unity, which then act to suppress the corresponding branchings. The intended use case is to focus on Sudakov-suppressed regions of phase space. In the algorithms described in [15,20], enhancement factors smaller than unity are not guaranteed to produce positive weights. In VINCIA\u2019s implementation, this issue is sidestepped by letting trial branchings be enhanced by a factor max(1, E),\nP\u0302biased =max(1, E)P\u0302 , (169)\nwhere P\u0302 is the unenhanced trial-generation probability density and E is the enhancement (or suppression) factor. Thus for E < 1 the trial probability is not modified. Conversely, each trial branching is accepted with a probability\nPacc = min(1, E)P\nP\u0302 , (170)\nwhere P/P\u0302 is the unbiased accept probability. The reweighting factor for an accepted trial branching remains Racc = 1/E (cf. section 4.1.5), while the reweighting factor for a discarded one generalizes to\nRdisc = P\u0302biased \u2212 P\nP\u0302biased \u2212 EP . (171)\nThus, in VINCIA\u2019s version of the enhancement algorithm, both Racc and Rdisc are positive definite for any E > 0 and P < P\u0302.\nAlthough automated shower-variation weights were a signature feature of early versions of VINCIA [64], such variations have not yet been incorporated into the current VINCIA implementation in PYTHIA 8.3 but remain planned for a future revision. See the program\u2019s online manual for updates."
        },
        {
            "heading": "4.2.2 QCD showers",
            "text": "In their present incarnation, VINCIA\u2019s QCD showers are fully developed within the so-called sector framework [97, 100, 106, 108, 119\u2013121], in which only a single branching contributes per phase-space point. This is enforced by dividing the phase space into sectors according to a decomposition of unity as given by the following sum of Heaviside step functions,\n1= \u2211\nj\n\u0398sctj (p 2 \u22a5 j ,\u03b6 j ,\u03c6 j) =\n\u2211\nj\n\u03b8 min k {Q2res,k} \u2212Q 2 res, j . (172)\nTo discriminate between the different sectors, a \u201csector resolution\u201d variable is used, which we define to be [97]\nQ2res, j =\n\n  \n  \np2\u22a5 j , if j a gluon ,\nq\u03042i j\n\u221a \u221a \u221a q\u03042jk smax , if (i, j) a quark\u2212 antiquark pair , (173)\nwith p2\u22a5 j and q\u0304i j as defined in eq. (141). The asymmetric choice for quark-antiquark pairs accounts for the fact that in gluon splittings with an arbitrary colour-connected recoiler X IgK 7\u2192 X iq jqk, there is no singularity associated to the i- j-collinear limit [97].\nThe shower evolution is given by the exponentiation of leading-order antenna functions [118\u2013126], specifically sector-antenna ones defined by the ratio of colour-ordered squared amplitudes,\nA j/IK = g 2 s C j/IK A\u0304 j/IK =\nMi jk(q; pi , p j , pk)\n2\n|MIK(q; pI , pK)|2 , (174)\nand the coupling- and colour-factor-stripped antenna function A\u0304 j/IK . Antenna functions for quark-antiquark, quark-gluon, and gluon-gluon parents can be derived from off-shell photon decays \u03b3 \u2192 qq [123], neutralino decays \u03c7\u03030 \u2192 g\u0303g [124], and Higgs decays H \u2192 gg [125], respectively. An antenna function derived in this way will include the full single-unresolved singularity structure of all colour dipoles in the given colour-ordered amplitude.\nWhen multiple colour dipoles are present in the three-particle state used to derive the function, these can be divided into sub-antenna functions,\nAg/qg(pi , p j , pk) = A gl g/qg(pi , p j , pk) + A gl g/qg(pi , pk, p j) , Ag/gg(pi , p j , pk) = A gl g/gg(pi , p j , pk) + A gl g/gg(pi , pk, p j) + A gl g/gg(p j , pi , pk) .\n(175)\nSuch functions build the basis for so-called global antenna showers, in which every antenna radiates over all of its branching phase space, and only the sum of all antennae recovers the full single-unresolved singularity structure. Denoting these by Aglj/IK , the specific choices for global final-state antenna functions in VINCIA are\nAglg/qq(sIK ; yi j , y jk,\u00b5 2 i ,\u00b5 2 k) = g2s Cg/qq sIK (1\u2212 yi j)2 + (1\u2212 y jk)2 yi j y jk + 1\u2212 2\u00b52i y2i j \u2212 2\u00b52k y2jk , (176)\nAglg/qg(sIK ; yi j , y jk,\u00b5 2 i ) = g2s Cg/qg sIK (1\u2212 yi j)3 + (1\u2212 y jk)2 yi j y jk + 2\u2212 yi j \u2212 y jk 2 \u2212 2\u00b52i y2i j , (177)\nAglg/gg(sIK ; yi j , y jk) = g2s Cg/gg\nsIK\n(1\u2212 yi j)3 + (1\u2212 y jk)3\nyi j y jk + 3\u2212 3 2 yi j \u2212 3 2 y jk , (178)\nAglq/gX(sIK ; yi j , y jk, yik,\u00b5 2 Q) = g2s Cq/Xg 2sIK\n1\nyi j + 2\u00b52Q\ny2ik + y 2 jk + 2\u00b52Q yi j + 2\u00b52Q . (179)\nThey only differ from the ones given in [118\u2013126] by non-singular terms. Below, we show how VINCIA\u2019s sector-antenna functions, Asctj/IK , are constructed from these building blocks.\nSingle-unresolved limits In the sector shower formalism, there is only a single branching kernel that contributes per phase-space point. In order to capture the correct leadinglogarithmic structure of QCD matrix elements, it is therefore vital that sector-antenna functions fully incorporate all single-unresolved limits of a given antenna/dipole. This means, that a single sector-antenna function has to reproduce the full eikonal in the soft-gluon limit,\nAsctj/IK(sIK ; yi j , y jk,\u00b5 2 i ,\u00b5 2 k) g j soft \u2212\u2212\u2212\u2192 g2s C j/IK 2sik si js jk \u2212 2m2i s2i j \u2212 2m2k s2jk , (180)\nwhile reproducing the full massive DGLAP splitting kernel PI\u2192i j(z,\u00b52i ) (or PI\u2192i j(z,\u00b5 2 i )/z for initial-state partons) in any (quasi-)collinear limit,\nAsctj/IK(sIK ; yi j , y jk,\u00b5 2 i ,\u00b5 2 k) i\u2016 j \u2212\u2192 g2s C j/IK\nPI\u2192i j(z,\u00b52i )\nsi j . (181)\nThis differs from conventional (non-sector) parton-shower algorithms, in which the soft and/or collinear singularity structures are partial fractioned onto different branching kernels. E.g. in DGLAP-based and dipole approaches, the soft eikonal is partial fractioned onto two separate kernels (which are associated with two different recoil maps), and the same is true of gluoncollinear singularities in both dipole and global-antenna showers. In the sector-antenna formalism, each antenna function reproduces both the full eikonal and the full DGLAP kernel in the respective limits, and double counting is avoided by allowing only one such antenna function to contribute per phase-space point.\nFSR antenna functions In VINCIA, final-final (FF) sector-antenna functions for gluon emissions are constructed from their global counterparts, eqs. (176) to (179), by symmetrizing over colour-connected gluons in the following way,\nAsctg/IK(sIK ; yi j , y jk,\u00b5 2 i ,\u00b5 2 k) = A gl g/IK(sIK ; yi j , y jk,\u00b5 2 i ,\u00b5 2 k)\n+\u03b4Ig A gl g/IK(sIK ; yi j , 1\u2212 y jk,\u00b5 2 i ,\u00b5 2 k) (182) +\u03b4Kg A gl g/IK(sIK ; 1\u2212 yi j , y jk,\u00b5 2 i ,\u00b5 2 k) ,\nwhere \u03b4Ig = 1 if I is a gluon and zero otherwise, and similarly for K . Note that the symmetrization is done on the CM energy fraction of the relevant gluon(s), as in (y jk = 1 \u2212 x i) \u2192 (1 \u2212 y jk = x i) in the symmetrization for I \u2192 i j, instead of via explicit permutations of the i and j momenta as in eq. (175), which would correspond to y jk \u2192 (yik = 1 \u2212 y jk \u2212 yi j). This slight difference (which vanishes in the relevant collinear limit yi j \u2192 0) is to ensure finiteness in phase-space regions close to the \u201chard\u201d boundary yik. Although the yik = 0 region will never belong to the j-emission sector, this damping of the singularity is important as it allows for the sampling of the sector-antenna function over all of phase space with a post-hoc imposed sector veto. Additionally, it ensures numerical stability whenever sector boundaries become close to the yik-singular region.\nFor gluon-splitting sector-antenna functions, an equivalent procedure yields\nAsctq/gX(sIK ; yi j , y jk, yik,\u00b5 2 Q) = 2 A gl q/gX(sIK ; yi j , y jk, yik,\u00b5 2 Q) . (183)\nAntenna functions for final-state partons that are colour-connected to incoming ones, as in initial-final (IF) or resonance-final (RF) colour flows, are discussed below.\nISR antenna functions As for final-state radiation, sector-antenna functions involving initial-state partons can be obtained by symmetrizing corresponding global ones over finalstate gluons. The reason initial-state legs do not need to be symmetrized is that there is no sector for \u201cemission into the initial state\u201d. (Analogously, while jet algorithms may decide to cluster final-state partons either with each other or with the beam, the beam itself is hard by definition and cannot be clustered away.)\nThis means that, even in the global-antenna approach, beam-collinear singularities do not need to be partial-fractioned. Hence, for II antennae, there is no difference between global and sector-antenna functions; while for initial-final gluon emissions, antenna functions with two final-state gluons are symmetrized as follows,\nAsct,IFg/AK(sAK ; ya j , y jk,\u00b5 2 a,\u00b5 2 k) = A sct,IF g/AK(sAK ; ya j , y jk,\u00b5 2 a,\u00b5 2 k)\n+\u03b4gK A sct,IF g/AK(sAK ; 1\u2212 ya j + y jk, y jk,\u00b5 2 a,\u00b5 2 k) . (184)\nFiniteness close to the spurious yak\u2192 0 singularity is here again ensured by adding y jk to the symmetrized argument. Initial-final antenna functions describing final-state gluon splittings are obtained in exactly the same way as in eq. (183).\nGlobal initial-final and initial-initial antenna functions are obtained from eqs. (176) to (179) by crossing partons from the final state into the initial state. For initialinitial antennae, the crossing (I , K , i, k)\u2192 (\u2212A,\u2212B,\u2212a,\u2212b) implies:\nyi j = si j sIK\n\u2192 \u2212sa j sAB = \u2212 ya j yAB ,\ny jk = s jk sIK\n\u2192 \u2212s j b sAB = \u2212 y j b yAB , (185)\nyik = sik sIK\n\u2192 sab sAB = 1 yAB ,\nwhile for initial-final antennae, the crossing (I , i)\u2192 (\u2212A,\u2212a) yields:\nyi j = si j sIK\n\u2192 \u2212sa j \u2212sAK = ya j yAK ,\ny jk = s jk sIK\n\u2192 s jk \u2212sAK = \u2212 y jk yAK , (186)\nyik = sik sIK\n\u2192 \u2212sak \u2212sAK = yak yAK .\nThe RF antenna functions are identical to the IF ones. The full set of VINCIA antenna functions, including their helicity contributions, can be found in [100].\nThe strong coupling VINCIA offers the same basic options for the strong coupling as the simple shower does, with up to 2-loop running matched across flavour thresholds and an option to use the CMW scheme. However, whereas the main tuneable parameters in the simple shower are the effective values of \u03b1ISRs (M 2 Z) and \u03b1 FSR s (M 2 Z) (which may then be interpreted as being given in a renormalization scheme not necessarily identical to MS), in VINCIA one instead specifies a single common value for \u03b1MSs (M 2 Z)\u2014 normally just set to agree with a reasonable global average value such as that given by the PDG [35]\u2014 with different effective values for different branching types obtained via user-specifiable renormalization-scale prefactors,\n\u03b1MSs (M 2 Z)\u2192\n\n      \n      \n\u03b1s( kFEp 2 \u22a5 j +\u00b5 2 0 ) , for FF and RF gluon emissions , \u03b1s( kFSp 2 \u22a5 j +\u00b5 2 0 ) , for final-state gluon splittings , \u03b1s( kIEp 2 \u22a5 j +\u00b5 2 0 ) , for II and IF gluon emissions , \u03b1s( kISp 2 \u22a5 j +\u00b5 2 0 ) , for initial-state gluon splittings , \u03b1s( kICp 2 \u22a5 j +\u00b5 2 0 ) , for initial-state gluon conversions ,\n(187)\nwhere the scheme can be either MS or CMW and \u00b50 \u223cO(\u039bQCD) is a fixed scale that forces the effective coupling to asymptote to \u03b1s(\u00b520) for p\u22a5 j \u2192 0. A maximum value can also be specified beyond which \u03b1s is not allowed to grow, effectively freezing the coupling at that value in the infrared.\nEvolution equations The differential branching probability as implemented by the sector shower is given as the sum of individual IK 7\u2192 i jk antenna branching probabilities,\ndP dp2\u22a5 j = \u2211 j dP j/IK dp2\u22a5 j , (188)\nwhich can be written in terms of the shower evolution variable p2\u22a5 j and an arbitrary complementary phase-space variable \u03b6 as\ndP j/IK dp2\u22a5 j = \u03b1s(p2\u22a5 j) 4\u03c0 C j/IK\n\u03b6max(p2\u22a5 j) \u222b\n\u03b6min(p2\u22a5 j)\n2\u03c0 \u222b\n0\nA\u0304sctj/IK(p 2 \u22a5 j ,\u03b6)RPDF F\u03a6 J(p2\u22a5 j ,\u03b6) \u0398sct(p2\u22a5 j ,\u03b6,\u03c6) d\u03c6 2\u03c0 d\u03b6 .\n(189) Here, the Jacobian J(p2\u22a5 j ,\u03b6) accounts for the change to the shower variables (yi j , y jk) 7\u2192 (p2\u22a5 j ,\u03b6), for which different choices are implemented in VINCIA, depending on the branching type, cf. [100, section 2.5]. Note that, since the starting point is an exact phase-space factorization and the Jacobian factor J(p2\u22a5 j ,\u03b6) accounts for the mapping to shower variables, there is no physical dependence on the choice of \u03b6 in VINCIA; it only affects how simple or complicated the trial integrals become, and the efficiency with which trial branchings can be generated. The phase-space factor\nF\u03a6 =\n\n          \n          \nsIK sIK q\n\u03bb(sIK , m2i , m 2 k)\nFF ,\nsAK +m2j +m 2 k \u2212m 2 K (1\u2212 y jk)3 sAK +m2j +m 2 k \u2212m 2 K q\n\u03bb(m2A, m 2 AK , m 2 K)\nRF ,\nsAK 1\u2212 y jk\nIF ,\nsAB 1\u2212 ya j \u2212 y j b\nII ,\n(190)\naccounts for the relative size of the post-branching phase space to the pre-branching phase space. For ISR, a PDF ratio is included for every initial-state parton,\nRPDF =\n\n       \n       \n1 FF & RF ,\nfa(xa, p2\u22a5 j) fA(xA, p2\u22a5 j) IF , fa(xa, p2\u22a5 j) fA(xA, p2\u22a5 j) fb(xb, p2\u22a5 j) fB(xB, p2\u22a5 j) II .\n(191)\nTwo things should be noted in eq. (189). First, the colour factor C j/IK is normalized such that the integral prefactor is always 1/4\u03c0 (as opposed to 1/2\u03c0), with the specific VINCIA choices being\nCg/qq = 2CF = 8 3 , (192) Cg/qg = 1 2 (2CF + CA) = 17 6 , (193) Cg/gg = CA = 3 , (194) Cq/Xg = 2TR = 1 , (195)\nwhere an interpolation between 2CF and CA,\nCg/qg = (1\u2212 yi j)2CF + (1\u2212 y jk)CA\n2\u2212 yi j \u2212 y jk , (196)\nis available for qg antennae. Second, the azimuthal integration is made explicit although the antenna functions have no azimuthal dependence. This is to emphasize a potentially nontrivial azimuthal dependence of the sector veto \u0398sct.\nMatching, merging, and matrix-element corrections A unique property of VINCIA\u2019s sectorbased approach to parton showers is that there is only a very small number of \u201cshower histories\u201d leading to each distinct parton configuration. For gluon emissions, VINCIA\u2019s sector shower is entirely bijective, i.e. there is only a single unique shower history leading from the Born to any given Born+n-gluon parton configuration. For g \u2192 qq\u0304 splittings, one has to sum over all possible same-flavour quark-antiquark pairings, but the number of contributing histories for a given phase-space point is still drastically reduced relative to conventional, non-sectorized, showers. We say that the sector shower is \u201cmaximally bijective\u201d, and this provides an optimal framework for high-multiplicity matching and merging, discussed further in section 5.4.\nInfrared cutoffs For p\u22a5 scales below 1 GeV or so, perturbative approximations become increasingly inaccurate as \u03b1s(p\u22a5) shoots towards divergence at \u039bQCD \u223c 200 \u2212 300 MeV. Like for the simple shower model, VINCIA\u2019s perturbative shower evolution is therefore also halted some distance above \u039bQCD, at which point the parton system is handed to PYTHIA\u2019s stringfragmentation model for hadronization. In VINCIA, the precise scale at which the shower is stopped can be set independently for FF, IF, and II antennae.\nThe shower cutoff for FF antennae in VINCIA is analogous to the FSR cutoff in the simpleshower model. It can be regarded as the effective factorization scale between the perturbative and non-perturbative parts of the overall fragmentation description. It therefore has the interpretation as the scale at which the parameters of the non-perturbative hadronization modelling are defined. Ideally, the hadronization parameters should \u201crun\u201d with the shower cutoff, but since the relevant running equations are not known, in practice the hadronization parameters simply have to be retuned for each new value of the cutoff. In other words, the FF-cutoff value can be considered part of the fragmentation tuning. In general, one would seek not to leave too much of a gap between the lowest p\u22a5 scales generated by shower branchings (down to the cutoff) and the highest p\u22a5 scales generated by string breaks (with typical size set by the fragmentation p\u22a5 width, cf. section 7.1.1).\nFor II antennae, the cutoff can be regarded as an effective colour-screening resolution scale, or a lowest scale for which partons inside hadrons can be said to be well represented by plane waves. This could possibly be tied to the physics of parton saturation, though no explicit such connection is made here. The practical considerations are similar as for the ISR shower cutoff in the simple-shower model, striking a balance between p\u22a5 kicks generated by the shower and contributions from so-called \u201cprimordial k\u22a5\u201d, cf. section 6.3.3.\nFor IF antennae, the fact that VINCIA\u2019s default recoil strategy is fully local, and does not impart p\u22a5 recoil to any partons outside of the 2\u2192 3 branching itself, leads to some pathologies. In particular, each IF branching dilutes the primordial k\u22a5, and does not add any perturbative p\u22a5 of its own, to the hard system. The non-smooth interplay between the II and IF recoil strategies can make it challenging to describe the soft peak of experimental signals such as the Drell\u2013Yan p\u22a5 spectrum, and can produce seemingly counter-intuitive scaling with the value of the IF cutoff."
        },
        {
            "heading": "4.2.3 QED showers",
            "text": "The VINCIA shower offers a number of options for the inclusion of electromagnetic and weak corrections. They all share common features, like the phase-space factorizations and ordering scale, with the QCD shower, cf. section 4.2.1. In this section, we describe the first (and default) option, which is a pure QED shower that incorporates a fully coherent multipole treatment of the simulation of photon radiation off systems of charged fermions, vectors, and scalar particles, as well as photon splittings to pairs of charged fermions [101,102]. We also include a simpler and somewhat faster alternative, in which the full multipole sum is replaced by\nindividual dipole terms according to a principle of maximal screening, analogous to how QED is handled in the simple-shower model.\nThe basic building block for VINCIA\u2019s treatment of photon radiation is the photon-emission antenna function for a single pair of final-state charged particles i and k,\nAsct \u03b3/IK(sIK ; yi j , y jk,\u00b5 2 i ,\u00b5 2 k) = 2g 2 Q IQK sIK 2 yik yi j y jk \u2212 2 \u00b52i y2i j \u2212 2 \u00b52k y2jk +\u03b4If yi j y jk +\u03b4Kf yi j y jk\n+\u03b4IW 4 3 yi j y jk yIK \u2212 y jk + y jk(yIK \u2212 y jk) y2IK +\u03b4KW 4 3 y jk yi j yIK \u2212 yi j + yi j(yIK \u2212 yi j) y2IK\n, (197)\nwhere the Kronecker deltas ensure the correct collinear terms are incorporated in the cases where I and K are fermions or W bosons. The factors Q I and QK represent the relative electromagnetic charges of I and K , respectively. The II and IF antennae may be found by crossing symmetry following eqs. (185) and (186). For notational convenience we define\nAsct \u03b3/IK(sIK ; yi j , y jk,\u00b5 2 i ,\u00b5 2 k) = g 2Q IQK A\u0304 sct \u03b3/IK(sIK ; yi j , y jk,\u00b5 2 i ,\u00b5 2 k) , (198)\nsimilar to the QCD equivalent eq. (174). While possibly counter intuitive, the definition of a coherent QED shower using eq. (198) is not as straightforward as for its (leading-colour) QCD shower counterpart. The reason is the absence of an equivalent of the leading-colour approximation, which in QCD allows one to discard the majority of the soft eikonal contributions that are subleading in colour. Conversely, in QED no eikonal is subleading to any other, and full coherence can only be accomplished by the inclusion of all of them simultaneously. VINCIA\u2019s most sophisticated photon emission algorithm accomplishes this by the definition of a single branching kernel\nA\u0304sct \u03b3/coh =\n\u2211\n{IK}\n\u03c3IQ I\u03c3KQK A\u0304 sct \u03b3/IK(sIK ; yi j , y jk,\u00b5 2 i ,\u00b5 2 k) , (199)\nwhere {IK} runs over all pairs of charged particles, and \u03c3I and \u03c3K are sign factors that have \u03c3I = 1 for final-state particles and \u03c3I = \u22121 for initial-state particles. This branching kernel includes all soft multipole terms, as well as the correct collinear limits [101], but its singular structure is highly complex. The coherent algorithm is able to sample it by sectorizing the phase space according to\ndP j,coh dp2\u22a5 j = \u2211 {ik}\n\u03b6max(p2\u22a5 j) \u222b\n\u03b6min(p2\u22a5 j)\n2\u03c0 \u222b\n0\n\u03b1em(p2\u22a5 j)\n4\u03c0 A\u0304sct \u03b3/coh(p 2 \u22a5,\u03b6)\n\u00d7 RPDF F\u03a6 J(p2\u22a5 j ,\u03b6) \u0398sctik (p 2 \u22a5 j ,\u03b6,\u03c6) d\u03c6 2\u03c0 d\u03b6 , (200)\nwhere \u0398sctik (p 2 \u22a5 j ,\u03b6,\u03c6) is given by eq. (172), but with a sum over charged-particle pairs, and the sector resolution is the same as that of a gluon emission as given by eq. (173). This procedure ensures the soft and collinear singularities are correctly regularized by the transverse momenta of the photon with respect to all pairs of charged particles. The coherent emission algorithm is the default choice, but in some specific high-multiplicity cases it may be slow due to the large number of sectors that need to be sampled.\nAs a backup, a faster, unsectorized alternative is implemented that rephrases the photon emission probability as\ndPpair dp2\u22a5 j = \u2211 [IK]\n\u03b6max(p2\u22a5 j) \u222b\n\u03b6min(p2\u22a5 j)\n2\u03c0 \u222b\n0\n\u03b1em(p2\u22a5 j)\n4\u03c0 Q2[IK]A\u0304 sct \u03b3/IK(p 2 \u22a5 j ,\u03b6)RPDF F\u03a6 J(p2\u22a5 j ,\u03b6) d\u03c6 2\u03c0 d\u03b6 , (201)\nwhere [IK] now runs over all pairings of charged particles with identical but opposite charge Q[IK]. The factors \u03c3I and \u03c3K have been absorbed into the definition of Q[IK], meaning that a final-state charged particle may be paired with a same-sign initial-state particle. That is, every charged particle now only appears once, and pairings are constructed to minimize the sum of dipole-antenna invariant masses as per the principle of maximum screening [102]. The task of pairing particles under such a constraint in O(n3) time complexity is accomplished using the Hungarian algorithm [127\u2013129]. While this algorithm is generally faster, it only approximates the complete multipole structure. Furthermore, it may not always be possible to pair up all charges. For instance, in a W+ \u2192 ud decay, no pairings are possible at all. In such cases, as many charges as possible are paired up, and the fully coherent algorithm is used for the remainder.\nThe QED shower also includes photon splittings to charged fermions, which use antennae that are kinematically identical to their gluon-splitting counterparts. Furthermore, while photon radiation off quarks is cut off at a scale of order the hadronization scale, leptonic photon radiation continues to much lower scales and has its own cutoff scale. Since the system of leptons is not necessarily charge conserving by itself, which is a requirement for the above algorithms, the pool of charges is supplemented with the colour-neutral strings that enter the hadronization stage. When acting as the recoiler of a lepton, the antenna function is replaced by a dipole function that only contains the singular limits relevant to the lepton.\nQED radiation off charged hadrons and/or in hadron decays, is not present in the current implementation but may be included in future work; see the program\u2019s online manual for updates."
        },
        {
            "heading": "4.2.4 EW showers",
            "text": "As an alternative to the coherent QED shower described above, VINCIA also offers the option to interleave the QCD shower with a full-fledged EW shower, in which all possible branchings from the EW sector are incorporated, albeit only in a collinear approximation without any attempt at incorporating soft-interference effects [23,105]. For each given application, one must therefore choose whether weak-shower corrections are more important than QED coherence effects for the study at hand, the default choice being the coherent-QED one.\nWhen enabled, VINCIA\u2019s EW option includes not only the branchings that are also available in the simple shower (heavy vector-boson emissions off initial- and final-state fermions) but also final-state triple vector-boson branchings, Higgs emissions, and decay-like splittings. Like the QED module, the EW one also shares the common features of the QCD shower, allowing for a sensible interleaving of the two. However, it is important to be aware that the EW shower relies on the helicity-dependent evolution described in section 4.2.1, which must therefore also be enabled. The resulting intermediate states of definite helicity are vital in the EW sector due to its chiral nature. Helicity-dependent antenna functions are present for all EW branchings, capturing their associated quasi-collinear limits. Due to the rich physics landscape of the EW sector of the SM and the many different helicity combinations, there are hundreds of distinct polarized collinear-splitting kernels. The antenna functions are therefore not included here, but they may be found in [23]. Note that, since the EW shower does not incorporate soft-\ninterference effects, the antenna functions are more like dipole functions, only including the single quasi-collinear limit of the branching particle, while the other just functions as a recoiler.\nA number of features unique to the EW sector are incorporated. For example, in a shower sequence like e\u2212 \u2192 e\u2212 Z/\u03b3\u2192 e\u2212W+W\u2212, the interference between the Z and the \u03b3 can be of O(1) [105,130]. A full treatment of this effect may for instance be accomplished by the evolution of density matrices, which can quickly become prohibitively expensive. VINCIA instead implements a simplified approach, in which the emission probability is corrected at first order by an event weight. This weight is computed using quasi-collinear amplitude-level branching amplitudes using the spinor-helicity formalism.\nThese same amplitudes are also used to determine recoilers for the quasi-collinear branchings of the EW shower. Unlike in the QCD sector, where recoilers are typically chosen to be a colour-connected parton, no such mechanism is available in the EW sector. Furthermore, because the EW shower only models quasi-collinear branchings without soft-interference effects, the choice of recoiler is formally arbitrary. One can however select the recoiler probabilistically such that the kinematic effects of recoil on previous branchings is minimized [105].\nAnother peculiar feature of the EW sector is the fact that branchings like t \u2192 bW+ and Z \u2192 qq appear both as shower branchings and as resonance decays. For off-shellness scales Q2 = m2 \u2212 m20 \u223c \u0393\n2, the physics is best described by a Breit\u2013Wigner distribution, while for scales above the electroweak scale Q2EW, the EW shower is most accurate. In the intermediate region a matching procedure is required. When the EW shower produces a heavy resonance like one of the EW gauge bosons, a top quark, or a Higgs boson, its mass is sampled from a helicity-dependent Breit\u2013Wigner distribution (see [23] for details)\nBW(Q2)\u221d m0\u0393 (m)\nQ4 +m20\u0393 (m)2 . (202)\nThis procedure mirrors the treatment of resonances that are part of the hard process as described in section 2.3.3, which can also be branched by the EW shower. The shower is matched to the Breit\u2013Wigner distribution by applying a suppression factor Q4/(Q2 + Q2EW)\n2, and the resonance is decayed when the evolution scale reaches the sampled resonance off-shellness without generating an EW branching. In that case, if the EW shower produced the resonance, the decay is distributed according to the appropriate helicity-dependent 1\u2192 2 matrix element. If instead the resonance was part of the hard process, the decay has already been generated and is inserted.\nFinally, double counting issues appear with the inclusion of EW branchings in the shower. For instance, the state pp\u2192 VVj may be reached by starting from pp\u2192 VV and performing an initial-state QCD emission, or from pp\u2192 Vj and performing an EW emission. To avoid double counting such phase-space points, VINCIA implements an overlap veto procedure that can be used when overlapping matrix elements are enabled. It is based on the kT jet algorithm [131] distance measures, generalized to account for the massive states that appear in the EW sector, given by\ndiB = k 2 T,i ,\ndi j =min(k 2 T,i , k 2 T, j) \u2206i j\nR + |m2i +m 2 j \u2212m 2 I | . (203)\nThe distance between the beam and final-state particle i is measured by diB, while di j measures the distance between two final-state particles i and j. If, for example, a gluon is emitted by the QCD shower, the distances with respect to its colour-connected partons are computed. Furthermore, the distances of all possible 2 \u2192 1 EW clusterings of the state after the gluon emission are also evaluated. If one of these distances is smaller than the QCD ones, then the current phase-space point should be populated by the EW shower rather than the QCD shower,\nand the gluon emission is vetoed. This procedure ensures no double counting occurs and the QCD and EW showers populate the regions of phase space they are most accurate in."
        },
        {
            "heading": "4.3 The DIRE shower",
            "text": "The DIRE parton shower, introduced in [117], offers another alternative showering model. It aims to combine aspects traditionally associated with 2 \u2192 3 dipole (antenna) showers with features of \u201cconventional\u201d 1 \u2192 2 parton showers. The goal of this hybrid is to inherit the modelling of soft-emission effects from dipole showers, while keeping an explicit association of splittings with specific collinear directions. This should, in principle, allow for an uncomplicated comparison to the ingredients in QCD factorization theorems. The physics aspects of DIRE have been developed in a series of articles [117, 132\u2013137], and we refer the reader to these publications for details. Below, we will summarize the most important choices, virtues and current limitations."
        },
        {
            "heading": "4.3.1 Phase-space coverage and ordering",
            "text": "DIRE employs an exact factorization of the single- and double-emission phase spaces. The single-emission phase space is adapted from [111, 138], and allows for any combination of masses in 2\u2192 3 branchings. The construction of post-emission momenta through the mapping M(1) can be sketched by\nM(1)   Radiator i\u03031\nRecoiler k\u0303\n\u2295 t(1), z(1),\u03c6(1)\n\n =\nRecoiler k\nRadiator i\nEmission 1\n, (204)\nwhere t(1) is the evolution variable, z(1) a momentum-sharing variable, and \u03c6(1) an azimuthal angle. Note that under the mapping M(1), the direction of the recoiler is not affected by the branching. Only its longitudinal momentum components change. This deliberate choice ensures that the collinear direction defined by the recoiler, and consequently its mapping onto factorization theorems, remains intact. A caveat to this approach \u2014 related to initial-state emissions \u2014 is discussed below.\nThe double-emission phase space \u2014 relevant for NLO parton evolution [132]\u2014 may similarly be illustrated by a map M(2)\nM(2)   Radiator i\u030312\nRecoiler k\u0303\n\u2295 t(12), z(12),\u03c6(12), s12, x ,\u03c6\u2032\n\n =\nRecoiler k\nRadiator i\nEmission 2\nE m\nis si\non 1\n. (205)\nHere, t(12) is the evolution variable assigned to the emission of the system (12), z(12) (\u03c6(12)) a momentum-sharing (azimuthal angle) variable, and s12 the virtuality of the system (12), while x and \u03c6\u2032 are related to the momentum sharing (azimuthal angle) between emissions 1 and 2. Again, the direction of the \u201crecoiler\u201d is preserved.\nThe momentum mappings M(1) and M(2) are (re)arranged to ensure that the phase-space coverage is fully symmetric between radiation from the \u201cradiator\u201d or the \u201crecoiler\u201d, i.e. given a fixed post-branching phase-space point and fixed branching variables, an identical pre-branching phase-space point is produced, independent of assigning the emissions to the radiator or recoiler. However, it should be noted that the momentum-sharing variables z are not symmetric under exchange of the \u201cemission\u201d for one of the other involved particles, since the\nlimit z\u2192 1 is associated with a soft emission. DIRE separates the generation of post-branching momenta into four distinct cases:\nFF, i.e. emission from a final-state particle, using a final-state recoiler: This case has the fewest kinematic constraints, but the richest set of combinations of possible masses. Thus, the mapping is constructed to ensure that regions of phase space in which mass-corrected transition rates would lead to negative contributions are outside the physical phase-space boundaries.\nFI, i.e. emission from a final-state particle, using an initial-state recoiler: This case again has few kinematic constraints, after the choice of keeping the recoiler direction intact. DIRE will, if not instructed otherwise, treat incoming particles as massless for the purpose of phase-space generation. This means that in this configuration, negative transition rates due to mass corrections may occur. This is handled by a weighted shower algorithm.\nIF, i.e. emission from an initial-state particle, using a final-state recoiler: This case has several kinematic constraints that need to be considered. In fact, the system is over-constrained if both the initial-state particle and the final-state recoiler should retain their directions. In this case, the transverse momentum generated in the branching can be balanced by extending the set of particles that may change their momentum. DIRE offers the possibility to employ a \u201cglobal\u201d-recoil strategy, in which the transverse momentum of the splitting is balanced by all final-state particles within the decaying system2. It is also possible to instruct DIRE to relax the condition that the final-state recoiler retains its direction. In this \u201clocal\u201d strategy, the system of particles that change their momentum does not need to be extended.\nII, i.e. emission from an initial-state particle, using an initial-state recoiler: This case also has several kinematic constraints, and is over constrained, since both initial-state particles should retain their directions. Here, no attempt is made to construct a \u201clocal\u201d-recoil strategy. Instead, the transverse momentum of the branching is collectively balanced by all final-state particles within the decaying system.\nIn general, the construction of post-branching momenta is subject to many choices. The choices above have foremost been guided by providing a simple procedure and Jacobian factors, such that analytic integrations of the emission patterns are as straight-forward as possible. This helps when improving the evolution with next-to-leading order corrections.\nThe evolution variables in DIRE are chosen to lead to a symmetric phase-space sampling and simple phase-space boundaries. Soft transverse momenta fulfil these criteria, if defined by\nt(a)\u221d (pi pa)(pkpa)\nQ2 \u221d p+a p \u2212 a , (206)\nwhere Q2 is a maximal scale, pa may be a sum of one or two emission momenta, and pi and pk are the radiator and recoiler post-branching momenta. Thus, in all of the four cases above, and for both single-emission and double-emission contributions, DIRE employs soft transverse momentum as ordering variable, see [117,132] for details."
        },
        {
            "heading": "4.3.2 Transition rates",
            "text": "The DIRE parton shower aims to model configurations containing soft particles or collinear configurations with high fidelity. As in a traditional parton shower, separate transition rates\n2Here, \u201cdecaying system\u201d refers to the particle content of a single 2\u2192 n scattering, in case several such scatterings exist due to the inclusion of multiparton interactions.\nare used in each collinear direction. It might be helpful to explain this choice with an example. Imagine a dipole stretched between a quark and a gluon. The primary contributions to radiation collinear to the quark should be proportional to the colour factor CF, while the radiation pattern collinear to the gluon should, up to small corrections, be proportional to CA. Similarly, higher-order corrections to the radiation pattern in either region differ.\nHowever, simultaneously radiating from both dipole \u201cends\u201d with the full rate expected in the collinear limit (given by the DGLAP splitting functions) will naively lead to an incorrect pattern in the soft limit. This problem is circumvented by replacing collinear-soft parts of DGLAP kernels by an improved description. The latter may be obtained by distributing the correct soft radiation pattern among all coherently radiating particles,\n(pi pk) (pi pa)(pk pa) = 1 (pi pa) \ufe38 \ufe37\ufe37 \ufe38\n(pi pk) (pi pa) + (pkpa) \ufe38 \ufe37\ufe37 \ufe38\n+ (i\u2194 k)\n2(1\u2212z) (1\u2212z)2+t/Q2 1 t\n2 1\u2212z\nrewrite in t and zcombine with Jacobian\ncollinear limit t \u2192 0 . (207)\nThe resulting soft-collinear pattern is supplemented with hard-collinear terms [87]. As an extension of [87], the 1/z-terms present in DGLAP kernels are also shifted 1z \u2192 z z2+t/Q2 to ensure that sum rules for the splitting kernels are maintained. Finally, mass-dependent corrections based on [111] are added. The exact splitting kernels used in DIRE are listed in [117]. The above chain of reasoning is used for all branching types in DIRE.\nQCD The above reasoning directly applies to QCD branchings at leading order, i.e. when increasing the multiplicity by one particle, and while not including explicit virtual corrections to single-parton emission. At leading order:\n\u2022 Dipoles are formed from radiator-recoiler pairs connected by a colour flow in the Nc \u2192\u221e limit. At the point of compiling this manual, the fixed-colour corrections discussed in [137] have not been included in the core PYTHIA code.\n\u2022 Colour factors due to colour-charge correlators in the Nc\u2192\u221e limit are given by:\n1. gluon-radiation off (anti)quarks\u221d CF, 2. gluon-radiation off gluons\u221d CA/#(possible recoilers) = CA/2, 3. and gluon branching to quark pairs\u221d TR.\n\u2022 Coupling-factors \u03b1s for all QCD splittings are evaluated with dynamic arguments, with the preferred scheme being \u03b1s(t). However, it should be noted that the emergence of the running coupling is driven by soft-gluon emissions, and thus, it is a priori not obvious if the evaluation \u03b1s(t) extends also to hard-collinear configurations. Thus, the user may instruct PYTHIA to use different arguments to evaluate \u03b1s: the running coupling may be evaluated using the \u201ccollinear transverse momenta\u201d k2\u22a5 defined as evolution variables in [114], i.e. \u03b1s(k2\u22a5), or it may be evaluated using the strict definition of the (inverse)\neikonal term, i.e. \u03b1s (pi pa)(pk pa) (pi pk) .\nThe usage of a running coupling effectively includes \u201cuniversal\u201d virtual corrections to the emission rates. For inclusive soft-gluon emission, it is possible to include further next-to-leading\norder corrections rescaling the soft-gluon emission rate:\n\u03b1s 2\u03c0 2(1\u2212 z) (1\u2212 z)2 + t/Q2 + (hard-collinear terms)\n\u2192 \u03b1s 2\u03c0 1+ K \u03b1s 2\u03c0 2(1\u2212 z) (1\u2212 z)2 + t/Q2 + \u03b1s 2\u03c0 \u00b7 (hard-collinear terms) . (208)\nThis may be considered as a conservative implementation of the conventional CMW (or MC) scheme [85]. Note that different strategies for the evaluation of running couplings will induce different higher-order corrections. Without better modelling, none of these ad hoc choices are completely satisfactory.\nHigher-order corrections to QCD evolution have been known for a long time. DIRE implements several aspects of QCD evolution at next-to-leading order:\n\u2022 Inclusive branching rates can be augmented with hard-collinear corrections by employing NLO DGLAP splitting functions. These improvements are available for both initialstate and final-state branchings. The benefit of such corrections is mainly in a more consistent treatment of PDF evolution in backwards initial-state evolution, since the latter relies on the parton shower distributing emissions according to the rates used to evolve externally pre-tabulated PDFs from low to high scales.\n\u2022 Correlated triple-collinear emissions, i.e. branchings of the form 1\u22951\u2192 3\u22951, have been included to yield NLO DGLAP (initial- or final-state) evolution in the collinear limit from fully differential double-emission matrix elements.\n\u2022 Correlated double-soft emissions and explicit real-virtual corrections, i.e. branchings of the form 2 \u2192 4 and 2 \u2192 3 at 1-loop, can be employed for final-state branchings. The inclusion of such NLO corrections is mainly a reduction of the renormalization-scale uncertainty of the parton shower. At the point of writing this manual, the consistent combination of triple-collinear and double-soft NLO corrections outlined in [139] has not been included in a public PYTHIA release.\nQED The description of QED in DIRE [135, 137] follows a very similar structure to that of QCD branchings, and is inspired by [140].\n\u2022 Dipoles are formed from all electrically charged radiator-recoiler pairs, much like the fixed-colour QCD dipole assignments discussed in [69,137].\n\u2022 Charge-factors due to electric-charge correlators are determined from\nQ2 = \u2212 \u03b7i\u03031\u03b7k\u0303Q i\u03031Q k\u0303\nQ2 i\u03031\n(photon emission) ,\nQ2 = 1\n#recoilers (photon splitting) , (209)\nwhere Q i\u03031 and Q k\u0303 are the charges of the radiator and recoiler, respectively, and \u03b7i = +1(\u22121) if i is a final- or initial-state particle. These correlators multiply the splitting functions in place of the QCD colour factors, and may readily lead to negative contributions to the transition rates. Thus, a weighted shower algorithm is crucial for the QED modelling in DIRE.\n\u2022 Coupling-factors \u03b1em for all QED splittings are evaluated in the Thompson limit, i.e. no running QED coupling is employed in the shower.\nKinetically mixed dark photons DIRE further implements kinetically mixed dark photon interactions, featuring dark photon emission from and decay into standard-model particles. These transitions are handled analogously to QED interactions, except that the dark photon may be massive. The decay width of the dark photon is currently ignored for both dark photon emission and decay.\nElectroweak effects Finally, DIRE allows for electroweak-boson radiation and fermionic weak-boson decay, using a simplistic model similar to the ideas of [83, 141]. Electroweak effects are mainly included because of the necessity for consistent matrix-element merging at LHC energies: to avoid an overly QCD-evolution biased scale setting for vector-boson plus jets configurations that exhibit giant K-factors [142], the inclusion of parton-shower histories containing electroweak clusterings are mandatory for some showers [143, 144]. Thus, DIRE implements electroweak evolution using:\n\u2022 Transition rates are determined from partial-fractioned massive dipole kernels [111].\n\u2022 Dipoles are formed from all pairs of particles that may emit the same electroweak vector bosons. Electroweak-boson decays employ the same recoiler selection as vector-boson radiation, much like the QED case [135,137].\n\u2022 Coupling factors are calculated under the assumption of chirality-summed evolution, cf. [141]. The coupling value is kept fixed, i.e. no running coupling is employed.\nThis overly simplified model may appropriately handle electroweak history effects in the context of multi-jet merging, especially for W\u00b1-boson plus multi-jet configurations at the LHC [136]. Beyond this, studies of weak-boson radiation with DIRE are discouraged."
        },
        {
            "heading": "4.3.3 Weight handling aspects",
            "text": "The transition rates outlined in section 4.3.2 may be relatively complex. This results in some technical requirements that need to be met to produce a sound simulation since:\n\u2022 it may not be possible to find efficient overestimates of complex transition kernels, such as for correlated double emission;\n\u2022 and it may not be possible to guarantee positivity, e.g. due to mass effects, electric charge correlators, or higher-order corrections.\nBoth of these points (as well as the automated renormalization scale variations available in DIRE) may be addressed with the help of a weighted veto algorithm, which was discussed in section 2.2.3. DIRE employs this method more heavily than the rest of PYTHIA. Thus, the relevant features and extensions beyond the literature will be discussed here.\nThe core realization of weighted shower algorithms is that acceptance rates in the veto algorithm may be factored into a contribution that is \u201cunweighted\u201d via the veto algorithm, and an event-by-event \u201cweight\u201d factor that encapsulates the effect of sign changes or underestimations of the transition rate. To preserve inclusive cross sections, this is naturally complemented by event-by-event weights that augment the rejection rate of the parton shower. Once acceptance and rejection weights have been introduced, it also becomes possible to only partially unweight the use of overestimates through the veto algorithm, and correct for the partial unweighting by amending the event weight. This allows for an enhancement of certain transitions beyond their natural rate, leading to an improved statistical error, at the expense of a larger weight variance. Finally, the veto algorithm may be implemented in a series of distinct\naccept-reject steps. Each such step can be upgraded to incorporate complex rates3. At present, DIRE employs a weighted shower when choosing a branching according to splitting kernels, and another, stacked weighted shower to incorporate matrix-element corrections. A weighted approach to the latter is necessary as matrix-element corrections may induce sign changes, or because matrix elements are underestimated by the (sum of all possible) splitting kernels.\nThe weighted shower algorithm in DIRE rests on the realization that the rate of producing one transition in the shower after n rejections (through the veto algorithm) is given by\nP(t) = g(t) f (t) g(t) exp\n\u2212 \u222b tn\nt d t\u0304 g( t\u0304)\nn \u220f\ni=1\ng(t i)\u2212 f (t i) g(t i) g(t i)exp\n\u2212 \u222b t0\nt i\nd t\u0304 g( t\u0304) . (210)\nThis equation is the formal requirement for the validity of the veto algorithm, and does not strictly constrain the transition rates f (t) by the \u201coverestimate\u201d g(t) through 0< f (t)< g(t). The numerical implementation of the equation does, however, require sensible acceptance probabilities. This may be achieved by introducing an auxiliary function h(t) that guarantees acceptance probabilities 0 < f (t)/h(t) < 1, see e.g. also the description at the end of section 2.2.3. Rewriting in terms of this auxiliary function leads to\nP(t) = g(t) f (t) h(t) exp\n\u2212 \u222b tn\nt d t\u0304 g( t\u0304)\nn \u220f\ni=1\n1\u2212 f (t i) h(t i) g(t i)exp\n\u2212 \u222b t0\nt i\nd t\u0304 g( t\u0304)\n\u2297 h(t) g(t)\nn \u220f\ni=1\nh(t i) g(t i) g(t i)\u2212 f (t i) h(t i)\u2212 f (t i) . (211)\nThe second line may be interpreted as a corrective factor due to disconnecting the sampling and rejection distributions. It does not have to be bounded, and is implemented as an event weight. It is important to note that the acceptance rates f (t)/h(t) only need to be bounded point-wise in t, i.e. they may be adjusted depending on the value of f (t). In particular, DIRE uses\nh(t) =\n\u00a8\nsign[ f (t)]g(t) , if g(t)> | f (t)| , k f (t) , if g(t)< | f (t)| (with k \u223c 1.1) .\n(212)\nAn artificially enhanced sampling may be achieved by shifting g \u2192 g \u2032 = C g, while keeping all rejection steps (i.e. the definition of h(t)) fixed to their original values. The compensating event weight will then be shifted to\n1 C h(t) g(t)\nn \u220f\ni=1\nh(t i) g(t i) g(t i)\u2212 f (t i)/C h(t i)\u2212 f (t i) . (213)\nOnce the weighted shower is in place, parton-shower variations may be included by keeping track of multiple weights of the form\nw[k] = 1 C h(t) g(t)\nn \u220f\ni=1\nh(t i) g(t i) g(t i)\u2212 f [k](t i)/C h(t i)\u2212 f (t i) , (214)\nwhere f [k](t i) is the value of the varied transition kernel. DIRE allows for renormalizationscale variations in the argument of running-coupling evaluations, as well as variations of parton distribution functions.\nFinally, DIRE stacks weighted-shower steps, especially to allow the incorporation of matrixelement corrections. The possibility for stacking relies on two realizations: weighted-shower\n3For example, the algorithm of [137] relies on a three-step (un)weighting.\ninduced event weights are multiplicative, and after applying the event weight of previous steps, the shower rate will be correctly determined from the full splitting rate. Thus, for subsequent weighted shower steps, the full splitting kernel that would be obtained after applying the weight is the new sampling rate \u2014 or \u201coverestimate\u201d \u2014 for the next, stacked, weighted-shower step.\nDIRE currently stacks two weighted-shower steps. Ignoring, for the sake of a simple presentation, splitting enhancements and variations, then the first weighted shower (used to exponentiate complicated splitting kernels) yields a weight\nw1 = h1(t) g1(t)\nn \u220f\ni=1\nh1(t i) g1(t i) g1(t i)\u2212 f1(t i) h(t i)\u2212 f (t i) , (215)\nwhile the stacked weighted shower (used within the context of matrix element corrections) further induces the weight\nw2 = h2(t \u2032) f1(t \u2032) m \u220f\ni=1\nh2(t \u2032i) f1(t \u2032i) f1(t \u2032i)\u2212 f2(t \u2032 i) h2(t \u2032i)\u2212 f2(t \u2032 i) , (216)\nwith\nf2(t \u2032 i) = f1(t \u2032 i)\u2297ME-correction and h2(t) =\n\u00a8\nsign[ f2(t)] f1(t) , if | f1(t)|> | f2(t)| , k2 f2(t) , if | f1(t)|< | f2(t)| , (217)\nwhere k2 \u223c 1.5. Since matrix-element corrections are applied only once a viable splitting has been selected, and the corresponding phase-space point generated. Thus, the set of all t \u2032 is different, and smaller, than the set of all t. Currently, DIRE does not implement enhancements or variations in the stacked weighted-shower step, since there does not seem to be a strong need for such complications. Variations may, in the future, be used to embed uncertainties due to the underlying Lagrangian entering the matrix elements.\nNote that only the product of all event weights is required. Thus, the stacked algorithm is identical to the original weighted-shower algorithm from an outside perspective."
        },
        {
            "heading": "5 Matching and merging",
            "text": "Matching and merging methods aim to augment the event generator with (multiple) calculations performed within fixed-order perturbation theory. This is rather straight forward for individual (and simple) hard-scattering calculations, which may be treated as the \u201chard process\u201d from which further event generation steps start. When the fixed-order calculation includes virtual and/or real corrections, a consistent treatment quickly becomes more complex, such that dedicated schemes of combining external calculations with the event generator need to be developed.\nNaive parton showers aim to reproduce the effect of many collinear or soft emissions, and thus require improvements when describing observables that depend on well-separated hard particles. Fixed-order perturbative calculations furnish, on the other hand, an appropriate description of events with a handful of well-separated particles, but may fail in the collinear and soft limits. At high-energy colliders, observables typically exhibit effects of both approximations. On top of that, both the bulk cross sections (of low jet multiplicity) and tails (depending on the correct rate of high jet multiplicities) are often equally important. Methods to perform a matching or a merging of the fixed-order calculations with parton showers aim to combine the strengths of both approaches.\nBefore going into the details of matching and merging methods, it is useful to discuss some aspects of fixed-order calculations. Higher-order calculations require the calculation of virtual and real corrections. The latter introduce additional final-state particles, so that the (next-to-)korder prediction for an observable O is\n\u2329O\u232a= \u222b\nd\u03a6n\nk \u2211\ni=0\nd\u03c3(i)n d\u03a6n O(\u03a6n) + \u222b d\u03a6n+1 k\u22121 \u2211\ni=0\nd\u03c3(i)n+1 d\u03a6n+1 O(\u03a6n+1) + \u222b d\u03a6n+1 k\u22122 \u2211\ni=0\nd\u03c3(i)n+2 d\u03a6n+2 O(\u03a6n+2)\n+ \u00b7 \u00b7 \u00b7+ \u222b d\u03a6n+k d\u03c3(0)n+k d\u03a6n+k O(\u03a6n+k) , (218)\nwhere the superscript (i) determines the loop order. The symbols d\u03a6n, d\u03a6n+1, . . . , d\u03a6n+k refer to the n-, (n + 1)-, . . . , (n + k)-particle phase-space measures defined in eq. (19). We will refer to a \u201cmatching method\u201d as a method to combine complete higher-order corrections (i.e. all terms for the order k) to a single inclusive process. A \u201cmerging method\u201d combines several calculations for a lowest-multiplicity base process and related processes with additional wellseparated jets (i.e. up to a certain multiplicity n + m, but possibly omitting some higher-(i) terms) with parton showering. The goals of these two approaches are often overlapping. Nextto-leading order matching methods aim to include the NLO prediction\n\u2329O\u232aNLO,in = \u222b d\u03a6n d\u03c3(0)n d\u03a6n + d\u03c3(1)n d\u03a6n O(\u03a6n) + \u222b d\u03a6n+1 d\u03c3(0)n+1 d\u03a6n+1 O(\u03a6n+1) , (219)\nwhile a leading-order merging combines the calculation\n\u2329O\u232aLO,in = \u222b d\u03a6n d\u03c3(0)n d\u03a6n O(\u03a6n)\u0398(Q(\u03a6n)\u2212QMS) + \u222b d\u03a6n+1 d\u03c3(0)n+1 d\u03a6n+1 O(\u03a6n+1)\u0398(Q(\u03a6n+1)\u2212QMS)\n+ \u00b7 \u00b7 \u00b7+ \u222b d\u03a6n+m d\u03c3(0)n+m d\u03a6n+k O(\u03a6n+k)\u0398(Q(\u03a6n+m)\u2212QMS) , (220)\nwith the parton shower. Here, QMS denotes the so-called merging scale, which separates the hard (fixed-order) region Q > QMS from the soft/collinear (resummation) region Q \u2264 QMS. This scale is in principle arbitrary, and merging algorithms should not develop a strong dependence on the exact choice, as long as it amounts to a reasonably small scale.\nBefore any combination is attempted, it is important to remember that virtual and real corrections are separately infrared divergent, and only their sum is free of singularities. This means that the individual contributions need to be regularized carefully, making the (unweighted) generation of events challenging. Matching and merging can help with this, as explained below. Furthermore, fixed-order calculations are inclusive, meaning that a calculation for the process ab \u2192 c + X includes real-emission corrections implicitly, as part of X . For example, a leading-order calculation for pp \u2192 e+e\u2212 + X implicitly includes the process pp\u2192 e+e\u2212g. Fixed-order calculations for different processes can thus not simply be added \u2014 they first have to be reorganized as exclusive cross sections. At fixed order, this is achieved by including all relevant virtual corrections. The parton shower employs Sudakov factors or noemission probabilities to produce exclusive all-order cross sections \u2014 a reminder that Sudakov factors resum virtual corrections to all orders. High-multiplicity fixed-order calculations and showered low-multiplicity predictions may overlap as well.\nThus, various sources of overlap between calculations should be handled when combining fixed-order calculations with parton showers. Matching and merging methods typically employ a mix of subtraction, phase-space division and (emission or event) vetoes for this task. The subtractions that are required in matched or merged calculations can occur at fixed perturbative order or at all perturbative orders.\nThe aim of additional fixed-order subtractions is to remove the parton-shower approximations of real and/or virtual corrections from the fixed-order calculation, such that the resulting remnant can be showered without introducing overlaps. At next-to-leading order, this leads to (NLO) matching formulas that schematically have the form\n\u2329O\u232aNLO+PS = \u222b d\u03a6n d\u03c3(0)n d\u03a6n + d\u03c3(1)n d\u03a6n \u2212 d\u03c3PS(1)n d\u03a6n S(O,\u03a6n)\n+\n\u222b\nd\u03a6n+1 d\u03c3(0)n+1 d\u03a6n+1 \u2212 d\u03c3PS(0)n+1 d\u03a6n+1 S(O,\u03a6n+1) , (221)\nwhere S is the shower operator defined in eq. (90). This also shows that these \u201cparton-shower subtractions\u201d are typically mandatory to allow for fixed-order event generation, since this would allow for the generation of the bracketed terms in eq. (221) as individual event samples. Additionally, this highlights that matrix-element-corrected parton showering can lead to simple NLO matching methods. Matrix-element corrections guarantee that the first emission in the parton shower is distributed according to the full tree-level rate by improving the splitting kernel eq. (80),\nK j/i\u0303 k\u0303\u2192 PMECK j/i\u0303 k\u0303 with PMEC =\nM(0)n+1\n2\n\u2211\nj K j/i\u0303 k\u0303\nM(0)n\n2 . (222)\nIt is straightforward to see that in the sum over all branchings this reproduces the full n+ 1- particle matrix element,\n\u2211\nj\nPMECK j/i\u0303 k\u0303 M(0)n\n2 = M(0)n+1\n2 . (223)\nIn practice, the correction factor PMEC is implemented via an additional multiplicative factor in the accept probability of the shower veto algorithm, cf. section 2.2.3. It is worth noting that matrix-element-correction methods historically appeared well before generic NLO matching methods [75,145\u2013147]. MECs identified\nd\u03c3PS(0)n+1 d\u03a6n+1 = d\u03c3(0)n+1 d\u03a6n+1 , (224) d\u03c3PS(1)n d\u03a6n = \u2212 \u222b d\u03a61 d\u03c3(0)n+1 d\u03a6n+1 , (225)\nleading to the POWHEG matching prescription\n\u2329O\u232aNLO+PS = \u222b d\u03a6n d\u03c3(0)n d\u03a6n + d\u03c3(1)n d\u03a6n + \u222b d\u03a61 d\u03c3(0)n+1 d\u03a6n+1\n\u03a6n\n!\nSMEC(O,\u03a6n) . (226)\nSince the matrix-element-corrected parton shower SMEC would now produce real-emission events, it is not possible to combine this calculation naively with further pre-calculated multiparton fixed-order predictions. It would, however, be possible to add new tree-level samples\nif the contributions are also subtracted in the overall result:\n\u2329O\u232aSTACKED = \u222b d\u03a6n d\u03c3(0)n d\u03a6n + d\u03c3(1)n d\u03a6n + \u222b d\u03a61 d\u03c3(0)n+1 d\u03a6n+1\n\u03a6n\n!\nO(\u03a6n)\n\u2212 \u222b d\u03a6nd\u03a61 d\u03c3(0)n+1 d\u03a6n+1\n\u03a6n\n\u0398(Q(\u03a6n+1)\u2212QMS)O(\u03a6n)\n+\n\u222b d\u03a6n+1 d\u03c3(0)n+1 d\u03a6n+1 \u0398(Q(\u03a6n+1)\u2212QMS)O(\u03a6n+1) . (227)\nThis somewhat academic exercise of \u201cstacking\u201d fixed-order calculations can be cast into a more familiar form related to the parton shower. For that, we introduce the \u201cparton-shower weight\u201d of an n-parton state wPSn as the exact parton-shower rate of the n-parton state, excluding the product of naive splitting probabilities. Thus,\nwPSn = f0(x(\u03a60),\u00b5 2 f PS)\nn\u22121 \u220f\ni=0\n\u03a0i(t i , t i+1;\u03a6i) \u03b1s(t i+1) 2\u03c0 fi+1(x(\u03a6i+1), t i+1) fi(x(\u03a6i), t i+1) . (228)\nSimilarly, we may collect all coupling and PDF factors used at fixed order into the fixed-order weight\nwFOn =\n\u03b1s(\u00b52r )\n2\u03c0\nn\nfn(x(\u03a6n),\u00b5 2 f ) . (229)\nApplying the ratio of the former to the latter weight, to an n-parton fixed-order calculation introduces appropriate parton-shower higher orders. With this, we may instead add and subtract all-order contributions, leading to\n\u2329O\u232aMERGED = \u222b d\u03a6n d\u03c3(0)n d\u03a6n + d\u03c3(1)n d\u03a6n + \u222b d\u03a61 d\u03c3(0)n+1 d\u03a6n+1\n\u03a6n\n!\nwPSn wFOn O(\u03a6n)\n\u2212 \u222b d\u03a6nd\u03a61 wPSn+1 wFOn+1 d\u03c3(0)n+1 d\u03a6n+1\n\u03a6n\n\u0398(Q(\u03a6n+1)\u2212QMS)O(\u03a6n)\n+\n\u222b d\u03a6n+1 wPSn+1 wFOn+1 d\u03c3(0)n+1 d\u03a6n+1 \u0398(Q(\u03a6n+1)\u2212QMS)O(\u03a6n+1)\n\u2248 \u222b\nd\u03a6n d\u03c3(0)n d\u03a6n + d\u03c3(1)n d\u03a6n + \u222b d\u03a61 d\u03c3(0)n+1 d\u03a6n+1\n\u03a6n\n!\nwPSn wFOn \u03a0n(tn, tcut ;\u03a6n;>QMS)O(\u03a6n)\n+\n\u222b d\u03a6n+1 wPSn+1 wFOn+1 d\u03c3(0)n+1 d\u03a6n+1 \u0398(Q(\u03a6n+1)\u2212QMS)O(\u03a6n+1) . (230)\nHere, the additional argument \u201c> QMS\u201d in the no-emission probability indicates that only emissions leading to states with Q(\u03a6n+1) > QMS should be considered \u2014 leading to what is sometimes called the \u201cvetoed shower\u201d no-emission probability. The lines after the approximate equality would be fully equivalent to the lines before if the shower correctly reproduced the rate d\u03c3(0)n+1/d\u03a6n+1.\nThis equation leads to an interesting interpretation: the inclusion of a no-emission probability \u03a0n on top of the fixed-order n-parton cross section is producing a subtraction that allows it to be combined the (n + 1)-parton event samples. Event samples that are made exclusive with the help of no-emission probabilities can be added without further complication. This\nrealization is the basis of merging methods, which extend the argument to the combination of several multiparton calculations. If the no-emission probabilities are approximated by jets after the complete evolution sequence, then the merging procedure can become independent of the shower details. This is the case for MLM jet matching. In the Catani\u2013Krauss\u2013Kuhn\u2013Webber\u2013 L\u00f6nnblad (CKKW-L) method, the second equation and the exact (partonic) no-emission probabilities of the parton shower are used to calculate the rescalings wPSn+1/w FO n+1. Incidentally, such ratios are often called the \u201cCKKW-L weight\u201d or \u201cmerging weight\u201d. Unitarized merging methods retain the explicit add-subtract structure to guarantee the correct inclusive cross sections even if the parton shower does not accurately reproduce the (higher-order) emission pattern.\nAs of today, a broad spectrum of matching and merging techniques has been developed. Historically, the first method were matrix-element corrections (MECs) [75], where the shower kernel itself is corrected to the full matrix element after the first emission. This method has later been extended to include higher orders as well [64, 97, 109, 112, 148]. For NLO matching, two general schemes exist, namely MC@NLO [149] and POWHEG [150\u2013152], with the former being automated in the MADGRAPH5_AMC@NLO [153] and SHERPA [154] eventgeneration frameworks and the latter available through the POWHEG BOX program [155]. Well-established tree-level merging methods are MLM [156,157] and CKKW [158,159], which utilize a simple jet-matching algorithm and analytic Sudakov factors, respectively. The CKKWL method [160\u2013162] and METS [163] extend the CKKW merging scheme to use numerical no-branching probabilities, generated by trial showers.\nThe Unitarised Matrix Element + Parton Shower (UMEPS) scheme [164, 165] improves the unitarity of tree-level merging and thereby addresses the issue that these change the inclusive cross section of the event samples. At NLO, multiple refinements of the aforementioned LO merging schemes exist. The NL3 technique [166] extends CKKW-L to NLO, just as UNLOPS [167, 168] does the same with UMEPS. At the same time, UNLOPS may be viewed as the unitarity-improved version of NL3. The MENLOPS scheme [169, 170] combines an NLO calculation for the lowest multiplicity with LO calculations for higher multiplicities in the METS scheme, while the full extension to NLO is treated in the MEPS@NLO scheme [171, 172]. The FxFx method [173] combines MC@NLO matching with MLM merging. The MiNLO scheme [174, 175] may be regarded as a scale-setting-improved NLO extension of the CKKW algorithm, with analytically calculated NLL Sudakov factors between the clustered states.\nBefore describing the matching and merging methods available in PYTHIA 8.3, it should be emphasized that (NLO) matching and merging methods introduce the stated fixed-order accuracy only up to the matched (merged) multiplicities. That is, an NLO-matched n-jet event sample has NLO accuracy only for n-jet observables, while (n+1)-jet observables will have LO accuracy, and (n+2)-jet as well as higher-multiplicity observables have parton-shower accuracy only. Similarly, a merged event sample with up to n jets at (N)LO accuracy, has (N)LO accuracy for m-jet observables with m\u2264 n. In the case of NLO merging, (n+1)-jet observables will have LO accuracy, while they will have parton-shower accuracy for LO merging. In either case, mjet observables with m > n + 1 have only parton-shower accuracy. Another question is the accuracy of the inclusive cross section. In NLO matching schemes, the inclusive cross section is accurate to NLO by design. In merging schemes, the inclusive cross section of n-jet cross sections are individually retained only if the merging scheme is constructed to be unitary, such as UMEPS or UNLOPS. In non-unitary merging schemes, inclusive cross sections are changed by the inclusion of higher-multiplicity event samples."
        },
        {
            "heading": "5.1 PYTHIA methods for leading-order multi-jet merging",
            "text": "As discussed above, PYTHIA offers a variety of leading-order merging schemes. This allows for a test of the robustness of merged predictions, beyond assessing the uncertainty due to scheme-specific parameters. The main task for a leading-order merging scheme is to produce\nan inclusive event sample that provides a simultaneous tree-level prediction for observables depending on any number of jets\u2264 n. This entails removing any overlap between the tree-level calculations for \u2264 n partons. The second main task is to provide a smooth transition between the \u201cwell-separated region\u201d (Q(\u03a6n) > QMS) described by (reweighted) tree-level results, and the \u201csoft/collinear region\u201d (Q(\u03a6n) < QMS) described by the parton-shower radiation pattern. Internal merging schemes in PYTHIA also ensure that the self-consistency of the PYTHIA eventgeneration chain is intact.\nCKKW-L multi-jet merging is the oldest tree-level merging scheme implemented in PYTHIA. It allows both standard-model and BSM core processes4, to which multiple several colourcharged partons or W bosons are added. Lepton and hadron-collider processes are accepted. The resulting tree-level samples are combined with each other and the default parton shower by employing the merging formula\n\u2329O\u232aCKKW\u2212L = N\u22121 \u2211\nn=0\n\u222b d\u03a6n d\u03c3(0)n d\u03a6n wPSn wFOn \u03a0n(tn, tcut ;\u03a6n;>QMS)\u0398(Q(\u03a6n)\u2212QMS) S(O,\u03a6n;<QMS)\n+\n\u222b d\u03a6N wPSN wFON d\u03c3(0)N d\u03a6N \u0398(Q(\u03a6N )\u2212QMS) S(O,\u03a6N ) , (231)\nwhere the showers S(O,\u03a6n;< QMS) of all but the highest-multiplicity event sample fill in emissions below the merging scale QMS. The main challenge of CKKW-L merging lies in the correct calculation of the weights wPSn . Their calculation in PYTHIA ensures that the value of the weights is identical to the all-order weight the shower would had attached to the state \u03a6n, had it produced the state internally. This requires the construction of all possible parton-shower histories, and an admixture of the (history-dependent) weight factors identical to that of the shower [161].\nA theoretical drawback of CKKW-L is that inclusive jet cross sections change upon inclusion of higher-multiplicity tree-level samples. The size of the change is determined by the value of the merging scale QMS, leading to unacceptable changes for QMS of O(1GeV). For low merging scales, the exact \u201csubtract what you add\u201d strategy highlighted in eq. (230) has to be employed. For this purpose, the UMEPS method has been introduced in PYTHIA. The UMEPS implementation can handle the same process classes as the CKKW-L scheme. The UMEPS merging formula reads\n\u2329O\u232aUMEPS = N\u22121 \u2211\nn=0\n\u222b\nd\u03a6n d\u03c3(0)n d\u03a6n wPSn wFOn \u0398(Q(\u03a6n)\u2212QMS)\n\u2212 \u222b d\u03a61 d\u03c3(0)n+1 d\u03a6n+1 wPSn+1 wFOn+1 \u0398(Q(\u03a6n+1)\u2212QMS) S(O,\u03a6n;<QMS)\n+\n\u222b d\u03a6N wPSN wFON d\u03c3(0)N d\u03a6N \u0398(Q(\u03a6N )\u2212QMS) S(O,\u03a6N ) , (232)\nThe subtractive samples in this formula are produced with the help of the parton-shower history employed to calculate the weights wPSn [164].\nAs a final remark on leading-order merging, it should be noted that PYTHIA offers detailed semi-internal UserHooks utilities for MLM jet matching [176]. This early approach to combining fixed-order matrix-element calculations with parton showers approximates the parton-shower no-emission probabilities necessary to remove overlap between samples with a\n4Note, though, that no attempt is made at diagram removal or subtraction for colour-changed BSM resonances that decay into SM quarks.\npragmatic event-veto procedure: the parton ensemble at fixed order is stored, and compared to jets after showering the ensemble. If each jet directions overlaps with one parton direction, the event is retained. The rate of rejected events mimics the application of no-emission probabilities. This convenient approach has the benefit of simplicity and computational efficiency, at the expense of sacrificing a formal understanding of the result."
        },
        {
            "heading": "5.2 PYTHIA methods for matching",
            "text": "The POWHEG NLO matching formalism as given in eq. (226) provides an elegant and universal method for the combination of NLO calculations and parton showers. It is universal, as it does not depend on the exact implementation of the parton shower to be matched. This is, because in addition to the NLO-corrected Born-level event, the first emission is generated according to a matrix-element corrected no-branching probability\n\u03a0\u0304(Q20,Q 2 1) = exp\n\n \n \n\u2212\nQ20 \u222b\nQ21\nd\u03a6+1 d\u03c3(0)n+1\nd\u03c3(0)n\n\n \n \n, (233)\nwhich is independent of the branching kernels used by the shower. In principle, an NLOmatched prediction could therefore be obtained with any given shower by starting the shower evolution at the scale of the first POWHEG emission. In practice, the ordering variable of the shower t will disagree with the ordering variable Q2 used in the POWHEG formalism. To avoid over- or under-counting emissions, it is hence preferable to start the shower at the phasespace maximum (i.e. using a \u201cpower shower\u201d, cf. section 4.1.3) and vetoing emissions that are harder than the POWHEG emission according to the POWHEG ordering variable. This method was outlined in [90] and since then PYTHIA 8.3 provides the relevant POWHEG hook to supply consistent showering of POWHEG BOX events with the simple showers. It is worth noting that this procedure leads to the somewhat awkward situation that the first, i.e. hardest, jet is produced from the kinematics and colour configuration of the Born+1-jet state. To circumvent this, a more complete treatment would involve clustering the first emission and running a vetoed truncated shower off the actual Born state for the first emission. This is currently not available in PYTHIA 8.3.\nIt might potentially be regarded as an inelegance that the POWHEG no-branching probability eq. (233) exponentiates the full matrix element, including process-specific non-singular terms, and that the value of Q20 is typically given by the (hadronic) phase-space limit, and not a scale that more adequately defines the transition between \u201chard\u201d and \u201csoft\u201d radiation. These concerns are avoided in the (historically first developed) MC@NLO method, in which the realradiation matrix element is separated into an infrared-singular (\u201csoft\u201d) and infrared-regular (\u201chard\u201d) part,\nd\u03c3(0)n+1 = d\u03c3 S(0) n+1 + d\u03c3 H(0) n+1 . (234)\nTherefore, only the singular part in the no-branching probability is retained,\n\u03a0\u0304S(Q20,Q 2 1) = exp\n\n \n \n\u2212\nQ20 \u222b\nQ21\nd\u03a6+1 d\u03c3S(0)n+1\nd\u03c3(0)n\n\n \n \n, (235)\nso that the MC@NLO matched expectation value of an observable O reads\n\u2329O\u232a(MC@NLO)NLO+PS = \u222b d\u03a6n d\u03c3(0)n d\u03a6n + d\u03c3(1)n d\u03a6n + \u222b d\u03a6+1 d\u03c3PS(0)n+1 d\u03a6n+1\n+\n\u222b\nd\u03a6+1 d\u03c3S(0)n+1 d\u03a6n+1 \u2212 d\u03c3PS(0)n+1 d\u03a6n+1\nS(O,\u03a6n)\n+\n\u222b d\u03a6n+1 d\u03c3H(0)n+1 d\u03a6n+1 . (236)\nAs evident from eq. (236), the MC@NLO method requires stringent consistency between the NLO calculation and the shower. Different to the POWHEG method, it therefore does not provide a universal scheme but needs to be implemented explicitly for each shower. To facilitate a simple implementation of the MC@NLO technique for PYTHIA\u2019s simple shower, PYTHIA 8.3 provides a global-recoil scheme, cf. section 4.1.3. A publicly available parton-level event generator supporting the generation of MC@NLO events for PYTHIA\u2019s simple shower is MADGRAPH5_AMC@NLO. Caution is, however, advised, as the global-recoil scheme might not be a suitable choice for each and every process.\nDifferent to the POWHEG formalism, the MC@NLO scheme explicitly employs negativeweighted events (in fact POWHEG was designed to remove negative weights from MC@NLO). While not posing a problem technically, negative weights reduce the efficiency of any simulation, simply because they have to compensated for in histograms with positive-weighted events, of which more are needed to obtain the same statistics as for simulations with a strict probability interpretation. The fraction of negative-weighted events can be reduced by the MC@NLO-\u2206 formalism [177], which regulates the divergent structure of real-emission matrix elements via shower-generated no-branching probabilities. In addition, the MC@NLO-\u2206 prescription introduces an independent shower starting scale for each colour line in the hard process. Such multi-scale treatment is also required in the POWHEG formalism, if resonanceaware matching is pursued, e.g. when using the POWHEG BOX RES generator [178]. In both cases, PYTHIA 8.3 offers the necessary machinery to deal with multiple scale definitions [179] through UserHooks (see section 9.7.2). While PYTHIA 8.3 offers in-house implementations for MC@NLO and POWHEG matching as alluded to above, other matching schemes can conveniently be implemented via user hooks, cf. section 9.7.2. A prominent example is the NNLO+PS matching framework GENEVA [180\u2013183]."
        },
        {
            "heading": "5.3 PYTHIA methods for NLO multi-jet merging",
            "text": "A number of schemes to combine several matched NLO (QCD) calculations with each other and parton showering are available in PYTHIA. As was the case for tree-level merging (cf. section 5.1), this allows for an exploration \u2014 through comparison within the same code base \u2014 of the benefits and limitations of various approaches, as well as NLO merged predictions more generally.\nHistorically, the first two NLO merging schemes embedded in PYTHIA were NL3 (an extension of the CKKW-L approach to NLO) and UNLOPS, the extension of UMEPS to NLO accuracy. Beyond the theoretical and computational challenges already present at leading order, NLO merging needs to ensure that the application of all-order weights wPSn /w FO n does not invalidate the NLO precision of the input samples due to overlapping virtual corrections. This can be achieved by subtracting the first-order expansion of the shower weights attached to treelevel events. Thus, the main complication in calculation is in generating terms in the shower expansion [184]. PYTHIA uses trial showering to generate the expansion of no-emission probabilities, and analytic results to calculate the expansion of running-coupling and PDF factors.\nOnce these technicalities are under control, the NLO extension of CKKW-L implements the matching formula\n\u2329O\u232aNL3 = N \u2211\nn=0\n\u222b d\u03a6n d\u03c3(0)n d\u03a6n wPSn wFOn \u03a0n(tn, tcut ;\u03a6n;>QMS)\u0398(Q(\u03a6n)\u2212QMS) S(O,\u03a6n;<QMS)\n+ N \u2211\nn=0\n\u222b\nd\u03a6n d\u03c3(1)n d\u03a6n + \u222b d\u03a61 d\u03c3(0)n+1 d\u03a6n+1\n\u03a6n\n\u2212 d\u03c3(0)n d\u03a6n wPSn wFOn \u03a0n(tn, tcut ;\u03a6n;>QMS)\nO(\u03b1s)\nS(O,\u03a6n;<QMS)\n+\n\u222b d\u03a6N+1 d\u03c3(0)N+1 d\u03a6N+1 wPSN+1 wFON+1 \u0398(Q(\u03a6N+1)\u2212QMS) S(O,\u03a6N+1) . (237)\nwhere square bracket with subscript O(\u03b1s) indicate that the O(\u03b1s) term of the expansion of the bracketed term is required. The first and last line of eq. (237) are identical to the CKKWL result. The second line incorporates the inclusive NLO correction, and the subtraction of double counting of virtual corrections. As was the case for CKKW-L, the calculation of all necessary terms in eq. (237) employs parton shower histories.\nHowever, the NL3 formula eq. (237) has the same theoretical drawback as the CKKW-L results: inclusive n-parton rates are changed when including corrections to m > n parton rates. The size of the effect is determined by QMS, and can easily be of a similar numerical size as NLO corrections for moderately small QMS. Thus, PYTHIA also extends the UMEPS method, which corrects this behaviour, to NLO accuracy. The resulting UNLOPS merging formula can be found in [184]. UNLOPS is the preferred NLO merging scheme in PYTHIA.\nBefore moving on, it is interesting to observe that any reweighting of the second line in eq. (237) with higher-order terms will neither affect the NLO fixed-order nor the shower accuracy of the combined calculation. Thus, variants of NLO merged methods can be obtained from reweighting these contributions. This freedom, and the resulting uncertainty, is exposed in PYTHIA by offering three different variants of UNLOPS [185]. Sensible uncertainties from NLO merged calculations should include the envelope of these variants as \u201cscheme uncertainty\u201d.\nAs part of its semi-internal implementation of MLM jet matching, PYTHIA also offers semiinternal utilities to combine input samples produced for FxFx merging [173]. This scheme extends the MLM method to NLO QCD accuracy, and handles the overlap between events of different multiplicity before showering in a hybrid scheme: fixed-order events are reweighted with analytic Sudakov form factors to produce results that are additive before showering. The overlap after showering is addressed in a pragmatic way, following along the lines of MLM jet matching. The resulting scheme is computationally efficient, especially since Sudakov form factors can directly be integrated into the fixed-order calculation code. However, this efficiency comes at the price of an unclear all-order structure of the prediction. Nevertheless, the scheme has found a large user base."
        },
        {
            "heading": "5.4 Matching and Merging in VINCIA",
            "text": "The unique \u201cmaximally bijective\u201d property of VINCIA\u2019s sector antenna showers, cf. section 4.2, make them well suited for incorporating corrections from fixed-order matrix elements, especially at high multiplicities. The focus so far has been on QCD corrections, although the sector nature of VINCIA\u2019s coherent QED shower should make adaptations to include QED corrections as well fairly straightforward.\nAt leading order, a dedicated CKKW-L merging scheme has been implemented which exploits the properties of VINCIA\u2019s sector showers. This is discussed below in section 5.4.1. Details on the general PYTHIA CKKW-L implementation can be found in section 5.1.\nNext-to-leading order matching in the antenna framework is so far not generally available, but VINCIA\u2019s QCD showers, including the resonance-final one, can be combined with NLO QCD calculations by shower-independent matching methods, such as POWHEG. This is described in section 5.4.2.\nAlthough VINCIA currently has no built-in NLO matching schemes, a generalization of the scheme developed in [96, 186] may become available in the future. In a similar vein, VINCIA does not offer the merging of multiple NLO-matched samples in the current version. Schemes extending the ones described in section 5.3 to sector showers may, however, be implemented in the future.\nVINCIA\u2019s NNLO matching approach presented in [187] is not yet part of the public PYTHIA 8.3 releases. We expect it to become available in a future release, once it has been applied and validated for a larger class of processes.\nA signature feature in early developments of VINCIA, iterated matrix-element corrections [64, 106, 148, 188] have not yet been made available in PYTHIA 8.3. Plans are underway to do so, building on the new matrix-element interfaces described in section 10.1.6. Note also that VINCIA\u2019s weak shower, described in section 4.2.4, is currently not sectorized and hence full-fledged EW merging would presumably require some work. Finally, note that dedicated matching and merging strategies for VINCIA\u2019s interleaved treatment of resonance decays have not yet been worked out. See the program\u2019s online manual for updates."
        },
        {
            "heading": "5.4.1 Leading-order merging",
            "text": "Tree-level merging with VINCIA is done in the CKKW-L scheme [158, 160, 161] according to eq. (231), properly extended to sector showers [162]. The phase-space sectorization particularly facilitates the merging at very high multiplicities and offers increased control over highly-complex final states. Most of the merging method is identical to the PYTHIA implementation described in section 5.1, with the difference only in the construction of shower histories needed for the Sudakov reweighting. The settings relevant to VINCIA\u2019s CKKW-L implementation can be found in section 9.6.1.\nIn the default CKKW-L scheme, all possible shower histories are constructed and the one maximizing the branching probability is chosen, cf. section 5.1. In the sector-shower CKKW-L implementation, however, the construction of all possible histories is replaced by a deterministic inversion of the shower evolution. This is possible because VINCIA\u2019s sector showers generate branchings only if these correspond to the minimal sector-resolution variable, cf. section 4.2.2. The sector-resolution variable can then be used to exactly invert any branching. The only subtlety in this algorithm stems from the treatment of multiple quark pairs, for which all possible quark-antiquark clusterings must be taken into account. To this end, the same procedure as in the default CKKW-L method is utilized and a shower history is constructed for all viable permutations of colour strings between quark pairs, and the one maximizing the branching probability is picked. This algorithm replaces the shower history tree by maximally a few linear history branches, which not only positively affects the CPU time needed for the computation, but more importantly reduces the prohibiting scaling in memory allocation intrinsic to the default CKKW-L algorithm."
        },
        {
            "heading": "5.4.2 NLO matching",
            "text": "If an NLO-matched calculation with VINCIA is desirable, the POWHEG method [150,151] with externally matched NLO event samples, as e.g. produced by the POWHEG BOX program [155,\n178], can be used [88]. To this end, the difference in the POWHEG BOX and VINCIA evolution variables are properly accounted for by increasing the shower starting scale and vetoing emissions above the POWHEG scale [90]. The usage of POWHEG BOX with VINCIA is described in detail in [189, appendix A]."
        },
        {
            "heading": "5.5 Matching and Merging in DIRE",
            "text": "At the time of compiling this manual, the matching and merging machinery with DIRE have not been validated within PYTHIA 8.3. Previous versions of DIRE + PYTHIA 8.2 included CKKW-L tree-level merging [135], UNLOPS NLO merging [136], iterated matrix-element corrections within the MOPS approach [135, 137], and TOMTE N3LO+PS matching [190]. We expect these previous developments to become accessible and validated in PYTHIA 8.3 in the future."
        },
        {
            "heading": "6 Soft and beam-specific processes",
            "text": "Hadrons and nuclei are composite objects, mainly made out of quarks and gluons. This requires the introduction of parton distribution functions (PDFs) f Aa (x ,Q\n2), expressing the probability density that parton a exists inside particle A with a momentum fraction x if the particle is probed at a resolution scale Q2. Given such PDFs, hard collisions between the constituent partons can be described by perturbation theory, see section 2.3. But in the limit p\u22a5 \u2192 0 the cross section for perturbative QCD scattering diverges, and traditional perturbation theory breaks down.\nThe alternative offered already since before the advent of QCD is so-called Regge\u2013Gribov theory [191\u2013195], wherein an effective field theory is formulated in terms of the exchange of reggeon (R ) and pomeron (P ) objects between the colliding hadrons, with propagators and vertex-coupling strengths, the latter both to hadrons and among themselves. A reggeon (pomeron) contribution represents the resummed effect from the exchange of (an infinite set of) mesons (glueballs) with a common set of flavour quantum numbers, but ordered in a linear relationship (a \u201ctrajectory\u201d) between increasing orbital angular momentum L and increasing m2. This language can be used to motivate expressions for total, elastic, and diffractive cross sections, even if today this is done in a pragmatic spirit, where not fully consistent adjustments of parameters can be made to better fit data.\nLeptons are fundamental particles, unlike hadrons, and it would seem like traditional perturbation theory can always be applied. But a charged lepton is surrounded by a cloud of virtual photons, and these carry some of the total momentum. It therefore becomes necessary to introduce PDFs also to describe the distribution of a lepton and photons inside the whole charged lepton, as a function of Q2. Either of these two components can then collide with constituents of the other beam. The photon, in its turn, can fluctuate further into a lepton or quark pair, and the latter again can have a non-perturbative behaviour. This requires a similar approach for photon interactions as for hadron ones, in fact with even more complexity. Since hadrons and nuclei also can contain or be surrounded by photons, by coupling to the charge of individual quarks or to the hadron as a whole, similar issues can arise in hadronic collisions.\nAlso fluxes of W\u00b1 and Z bosons can be defined, and have been used in the past, both for leptons and for protons. The large weak-gauge-boson masses suppress the rate in the p\u22a5 \u2192 0 limit, however, and so their contributions are better handled as propagators in Feynman graphs, like the top quark and the Higgs boson. This also implies that neutrinos can be considered point-like for our purposes.\nHeavy-ion collisions introduce further physics aspects, relative to hadronic collisions. Some of these are reasonably well understood, such as the role of the initial geometry, where models for the distribution of nucleons inside a nucleus can be used to find the \u201cwounded\u201d nucleons,\ni.e. those that interact. But most of the subsequent physics is still open to interpretation, and different approaches exist. One such is the PYTHIA 8.3/ANGANTYR model, presented here."
        },
        {
            "heading": "6.1 Total and semi-inclusive cross sections",
            "text": "Here we introduce the components of the total hadron-hadron cross section, and how these vary as a function of the collision energy. The intention is not to go into the modelling of the collision processes as such, which is the main topic for subsequent subsections, but some such information is necessary when the differential cross sections are the basic building blocks, and the integrated ones only a consequence thereof. See also the online manual, under the heading \u201cTotal Cross Sections\u201d.\nThroughout this section, we will discuss collisions between two high-energy hadrons A and B at a squared CM energy s = E2CM. By high energy, we mean roughly ECM > 10 GeV, where the perturbative model is valid. Low-energy non-perturbative processes are discussed in section 6.1.5. The (strong-interaction) total cross section for the collision of two high-energy hadrons is conveniently subdivided into several components, typically\n\u03c3ABtot(s) = \u03c3 AB el (s) +\u03c3 AB inel(s)\n= \u03c3ABel (s) +\u03c3 AB sd(X B)(s) +\u03c3 AB sd(AX )(s) +\u03c3 AB dd (s) +\u03c3 AB cd (s) +\u03c3 AB nd(s) . (238)\nThe components are:\n\u2022 Elastic scattering (el) AB \u2192 AB where the hadrons are scattered through an angle but are otherwise unharmed. Everything else, where the final state is not AB, is collectively called inelastic.\n\u2022 Single diffraction (sd) where either of the incoming hadrons becomes an excited system, while the other remains intact, AB \u2192 X B or AB \u2192 AX . Here, X represents the excited system that eventually will produce two or more hadrons.\n\u2022 Double diffraction (dd) where both hadrons are excited, AB \u2192 X1X2, but remain as separate objects.\n\u2022 Central diffraction (cd), where both hadrons survive but lose energy to a new central system, AB\u2192 AX B.\n\u2022 Non-diffractive interactions (nd), or more formally inelastic non-diffractive ones, where both hadrons break up and form a common system, AB\u2192 X , that is not (easily) subdivided into separate subsystems, unlike diffraction.\nIn principle, one could imagine higher diffractive topologies, say AB\u2192 X1X2X3, but these are expected to be small and are neglected here. For applications at low energies we will also introduce annihilation and resonance contributions.\nThe dividing line between these different components is unclear, notably between diffractive and non-diffractive events. Single- or double- diffractive systems X predominantly have low masses, and thus only produce a few particles at either end of the full rapidity range. In between, there is a large rapidity gap, i.e. a region in rapidity space without any particle production. That is unlike the non-diffractive events, where particle production is assumed to span the whole available rapidity range. But, since particles are discrete objects randomly produced, there will be a falling distribution of increasing gap sizes also in non-diffractive events. In contrast, the falling tail of large-mass diffractive systems can leave no obvious gap in a diffractive event. We therefore need to distinguish the theoretical modelling of cross-section classes and event properties presented here from the experimental-detector and analysis-dependent classification of observed events.\nIn modern nomenclature, where a pomeron is viewed as shorthand for a two-gluon system in a colour-singlet state, the different event classes can be illustrated in terms of the colour and momentum-energy transfers between the two incoming hadrons, see fig. 9. An elastic scattering requires a pomeron (or reggeon) to be exchanged, so that the scattered hadrons remain colour singlets, but with (modestly) changed outgoing momenta. If only one gluon is exchanged, a so-called cut pomeron, then the colour transfer turns the A and B hadrons into colour-octet objects, which means they will be connected by colour strings that can fragment into hadrons over the whole rapidity range, i.e. this gives a non-diffractive event. Single diffraction, e.g. AB \u2192 AX , can be viewed as a two-step process. First the emission of a P from A, carrying a fraction \u03be of the A momentum. And second the collision between the P and B, giving rise to a system with M2X = \u03bes. For the first step a pomeron flux f A P (\u03be, t) can be introduced in analogy with conventional PDFs, while the second step can be viewed as a non-diffractive-type PB subcollision, at least for large MX . Double and central diffraction can be described in a similar manner.\nThe hadronic cross sections that will be discussed late are for reasonably high hadronhadron CM energies, say ECM > 10 GeV, corresponding to a fixed-target proton-proton beam energy of Ebeam \u00a6 50 GeV. Separate from this, low-energy cross sections will be discussed in the context of hadronic rescattering, section 6.1.5. To a large extent the same language can be used, but at low energies the contribution from exclusive resonances, AB \u2192 R \u2192 AB or AB\u2192 R\u2192 C D, can give rise to rapid fluctuations in the cross section as a function of s."
        },
        {
            "heading": "6.1.1 Proton total cross sections",
            "text": "As already mentioned, pomeron and reggeon contributions play a large role in the modelling of cross sections. Both are expected to give an s\u03b4 energy dependence, where \u03b4 \u2265 0 for pomerons and \u03b4 < 0 for reggeons, such that high-energy cross sections are dominated by the pomeron term. The pomeron contribution is even, i.e. the same for AB and AB, while reggeons can be even or odd, the latter giving opposite-sign contributions for the two processes. A hypothetical odderon contribution would be odd, as the name indicates, and have \u03b4 \u2265 0 like the pomeron, so that \u03c3AB(s) \u2212 \u03c3AB(s) would not vanish in the s \u2192\u221e limit. Its existence is supported by recent TOTEM data [196], but is still not included in most models.\nThe simple s\u03b4 behaviour is obtained for the exchange of a single object, whereas multiple exchanges can come in with opposite signs and damp the rise of cross sections. The Froissart bound [197] shows that cross sections cannot rise faster than ln2 s asymptotically, but that limit is far off. Other bounds are more relevant, for instance that diffractive cross sections cannot become larger than the total one [198].\nThe most important hadronic cross sections are the pp and pp ones. Here, four different \u03c3tot(s) parameterizations are available for high-energy collisions in PYTHIA, plus one placeholder, see further the overview in [199]. They are roughly ordered in increasing number of free parameters tuned to data, with numbers corresponding to the options of the SigmaTotal:mode switch.\n0. A zero option allows the user to set any value at the currently studied energy, i.e. it does not model any energy dependence.\n1. The Donnachie\u2013Landshoff (DL) form [200], with one pomeron and one reggeon term,\n\u03c3ABtot(s) = X AB s0.0808 + Y AB s\u22120.4525 , (239)\nwith s in units of GeV and \u03c3 in mb. The coefficients X pp = X pp, as discussed above. There is no such symmetry for the Y AB, which can be viewed as having one even and one odd reggeon, but with the same power.\n2. The Minimum Bias Rockefeller (MBR) parameterization [201], which uses two different expressions. Below 1.8 TeV the form is given by one pomeron and two reggeon terms, whereof one odd and one even, with different \u03b4. Above it a common Froissart-inspired form like a ln2 s+ b ln s+ c is used.\n3. The ABMST model [202] includes a soft and a hard pomeron, i.e. lower or higher \u03b4 > 0, an even and an odd reggeon, plus terms for two-pomeron and triple-gluon exchange.\n4. The COMPAS/RPP parameterization [203] contains a total of six even and six odd terms, including pomeron, odderon, reggeon, and double-exchange ones.\nThe relevant cross section parameterizations are hard coded in options 1 \u2013 4, and cannot easily be changed."
        },
        {
            "heading": "6.1.2 Proton elastic cross sections",
            "text": "Elastic cross sections are related to total ones via the optical theorem:\nd\u03c3el dt (s, t = 0) =\n1+\u03c12\n16\u03c0 \u03c32tot(s) , (240)\nwhere t represents the squared momentum transfer between the initial and final proton on the same side of the event. For detailed modelling, a suitable starting point is the elastic scattering\namplitude T (s, t), from which one derives (d\u03c3el/dt)(s, t)\u221d |T (s, t)|2, \u03c3tot\u221d Im T (s, 0), and \u03c1 = Re T (s, 0)/Im T (s, 0). Typically \u03c1 is close to 0 and can be neglected to first approximation. The total elastic cross section is obtained by integration over t.\nFor the simple Regge-theory-motivated ansatz, that (d\u03c3el/dt)(s, t)\u221d exp(Bel t), one obtains\n\u03c3el(s) = 1+\u03c12\n16\u03c0 \u03c32tot Bel , (241)\nwhere, to a very good approximation at high energies, the t integration range has been extended to [\u2212\u221e, 0]. The ansatz also assumes that\nBABel (s) = 2bA+ 2bB + 2\u03b1 \u2032 ln(s/s0) , (242)\nwhere bA,B come from the respective hadronic form factors, with b = 2.3 GeV\u22122 for unflavoured baryons and 1.4 GeV\u22122 for mesons, \u03b1\u2032 = dL/dm2 = 0.25 GeV\u22122 is the slope of the pomeron trajectory, and s0 = 1/\u03b1\u2032 = 4 GeV2 is a typical hadronic scale [198,204].\nIn detail, the total-cross-section models above, as selected by SigmaTotal:mode, also handle elastic scattering as follows.\n0. It is possible for the user to set their own \u03c3el, Bel, and \u03c1 at the current energy.\n1. The original DL model was extended to Schuler and Sj\u00f6strand (SaS)/DL [198] by the simple Regge-theory ansatz above, but with the difference that the ln s dependence in eq. (242) is replaced by an s0.0808 term to ensure that \u03c3el does not grow faster than \u03c3tot asymptotically. There is no modelling of \u03c1, but a value can be set by hand.\n2. In MBR the ratio \u03c3el(s)/\u03c3tot(s) is parameterized, separately below and above 1.8 TeV, and separately for pp and pp below it. Then eq. (241) is used to derive a Bel(s) slope, with \u03c1 = 0.\n3. In ABMST the fundamental building block is a complex scattering amplitude T (s, t), containing the six terms of the total cross section, each with a separate t dependence, usually, but not always, of an exponential character. From this, both total and elastic cross sections are derived, including the \u03c1 parameter.\n4. Also the COMPAS/RPP parameterization starts out from a complex T (s, t), with the same comments as for ABMST, except that the number of terms now is larger.\nThere are no further free parameters in the code, beyond the ones mentioned above. So far, only strong interactions have been considered. But, since protons are charged particles, there are also electromagnetic (EM) interactions. These are given by the traditional Coulomb scattering cross section, d\u03c3el/dt \u221d \u03b12em/t\n2, which blows up in the t \u2192 0 limit, i.e. for vanishing scattering angle. Therefore, it is always necessary to specify a minimal angle or equivalently a tmax < 0. There are two aspects that make it possible to disregard the EM contributions at the LHC, except for special runs. Firstly, the EM contribution exceeds the strong one only below a |t| of order 10\u22123 GeV2, which corresponds to extremely small scattering angles. Secondly, owing to this, inelastic EM collisions are completely negligible. By default, Coulomb corrections therefore are not taken into account, but can be switched on.\nWhat complicates the issue is that the elastic scattering amplitude\nT (s, t) = Tn(s, t) + e i\u03b1em\u03c6(t) Tc(s, t) , (243)\ncontains a phase factor in front of the Coulomb Tc amplitude, relative to the definition of the real part of the nuclear/QCD Tn amplitude. Three different expressions are used, one for SaS/DL, and also for MBR and SigmaTotal:mode0, and one each for ABMST and COMPAS/RPP. Although written in slightly different ways, they give almost identical results."
        },
        {
            "heading": "6.1.3 Proton diffractive cross sections",
            "text": "Diffractive cross sections are differential in several variables: for single diffraction in t and MX ; for double diffraction in t, MX1 , and MX2; and for central diffraction in t1, t2, and MX . Here, MX represents the mass of the respective diffractive system. Alternatively the scaled variable \u03be = M2X/s is often used, but it is less intuitive when modelling contributions from low-mass resonances. The fundamental objects are the differential expressions, and the integrated rates in general do not have simple closed forms. Within Regge theory it is possible to relate the differential expressions to the ones for total and elastic ones, with minor extensions. Specifically, single diffraction is modelled with triple-Regge exchange graphs that involve the same pomeron (or reggeon) propagators as before, but requires the introduction of tripleRegge couplings. If only pomerons are considered, as could be reasonable at high energies, then mass spectra will behave roughly like dM2X/M 2 X and t spectra roughly like exp(Bt), where B = B(s, M2X ) depends on the process considered. In reality it is more complicated, for a number of reasons. At low masses the experimental MX spectrum is not smooth, but reflects the presence of well defined N and\u2206 resonance states. At high masses phase-space restrictions kick in, e.g. in the allowed t range, as well as a wish to minimize the overlap between diffractive and non-diffractive event topologies. In addition to the pomeron also reggeons should be considered, in various combinations, contributing to different mass distribution shapes and CM energy dependencies. Some terms increase faster with CM energy than the total cross section itself, implying that the description has to break down at some point. The solution to this is likely to involve the possibility of multiple exchanges of both a diffractive and non-diffractive nature, leading to a competition between the two [205].\nThree different diffractive models are implemented [199], matching the first three descriptions of total and elastic cross sections, plus again an additional placeholder, enumerated in the SigmaDiffractive:mode switch in the same way as in SigmaTotal:mode. It is possible to combine the choice of total plus elastic and diffractive models freely.\n0. One can set user defined single, double and central diffractive cross sections for the current energy. In this option there is a choice between seven possible M2X spectra, with related t shapes.\n1. The SaS model is based on pomeron contributions only, i.e. is of the form (dM2X/M 2 X ) exp(Bt) to first approximation. At low masses a smooth enhancement is\nadded, to provide a simple smeared-out further contribution from resonances. At large masses the rate is suppressed to reduce the rate of diffractive events with small rapidity gaps. The rise of the diffractive cross section with energy is given by integration. It turns out, however, that the initial ansatz gives a steeper rise than data, so energy-dependent damping factors have been introduced. Central diffraction is a rather recent addition, not included in many commonly used tunes, and therefore not on by default. The B slope is similar in spirit to eq. (242), but without any form factor contribution for protons that break up, and the logarithmic term is related to the rapidity gap size, e.g. ln(s/M2X ) for single diffraction.\n2. In the MBR model the single-, double- and central-diffractive cross sections are given as ratios of two integrals, one being the Regge cross section and the other a renormalized flux. These are matched so that the increase of diffractive cross sections is kept at an acceptably low rate. The differential distributions in M2X and t are given by somewhat lengthier expressions than in SaS, but qualitatively similar.\n3. The ABMST model is the most sophisticated one, in terms of number of components considered. The single-diffractive description is split into two parts, for high- and low-mass\ndiffraction. The former includes PPP, PPR, RRP and RRR graphs, plus pion exchange, each with a characteristic mass, t, and energy dependence. Four resonances are modelled in the low-mass regime, along with a background from the high-mass regime and a contact term matching the two regimes smoothly. The resonances are excited states of the proton, each a unit of angular momentum higher than the previous one. Taken together, the ABMST model gives a very good description of data at lower energies. Unfortunately the energy dependence of some terms is too steep, such that single diffraction at the LHC is overestimated by about a factor of two, and results at 100 TeV would be completely unphysical. A few different options have therefore been included in the PYTHIA implementation to damp this rise [199]. Another problem is that ABMST does not model double diffraction. One expects an approximate relationship [195]\nd3\u03c3dd dM2X1 dM 2 X2 dt \u2248 d2\u03c3sd dM2X1 dt d2\u03c3sd dM2X2 dt d\u03c3el dt \u22121 , (244)\nhowever, and this has been used to extend the modelling. Also central diffraction can be introduced by a similar ansatz.\n4. The COMPAS/RPP parameterization does not extend to diffraction, so there is no such option.\nEach of the models above contain a wide selection of modifiable parameters, specific to that diffraction model. Both the integrated and the differential cross sections can be modified, notably affecting the dependence on CM energy and the shape of the MX spectra.\nIn summary, the modelling of diffraction is highly nontrivial, and at a more primitive stage than that of total and elastic cross sections. There also exist alternative starting points to the Regge formalism we have worked with here, notably the Good\u2013Walker one [206]. In it, it is assumed that the interaction eigenstates do not agree with the mass ones. That is, an incoming proton can be viewed as a coherent sum of interaction eigenstates. During the collision process, parts of these eigenstates are absorbed to give rise to non-diffractive events. The remaining parts of the incoming wave function can be projected back on to a spectrum of possible masses for the outgoing object, including one component corresponding to elastic scattering. Actually the \u201cdiffraction\u201d name comes from the close analogue with optics, where an opaque disk put in a beam of light absorbs part of the light but also generates a quantum mechanical diffraction pattern in the remaining light. Such a picture implies that diffractive and elastic collisions are more peripheral than non-diffractive ones. The same also holds in the Regge-language-related MPI framework to be discussed in the next subsection, so even of the models seemingly are unrelated, there are many common traits."
        },
        {
            "heading": "6.1.4 Other cross sections",
            "text": "Except for the absence of Coulomb elastic scattering, collisions involving (anti)neutrons are assumed to have the same cross sections as (anti)protons in PYTHIA, and this similarity appears supported by data [200]. Therefore all of the models above can be used for pn, pn, nn and nn.\nFor other hadron combinations, the only alternative beyond the user-defined option is an extension of the SaS/DL setup. It encompasses the following collision types.\n\u2022 Combinations where \u03c3tot(s) were fitted by DL [200]: \u03c0+p, \u03c0\u2212p, K+p, K\u2212p, and \u03b3p.\n\u2022 SaS extensions [207]: \u03c10p, \u03c60p, J/\u03c8p, \u03c10\u03c10, \u03c10\u03c60, \u03c10J/\u03c8, \u03c60\u03c60, \u03c60J/\u03c8, and J/\u03c8J/\u03c8. Particles with identical flavour content are assumed to give identical cross sections. The prime example is \u03c00, \u03c10, and \u03c9. The emphasis on the interactions of vector mesons is related to the SaS modelling of \u03b3p and \u03b3\u03b3 physics, where an important\naspect is that a real photon can fluctuate into a vector meson like \u03c10, \u03c9, \u03c60, or J/\u03c8, and interact as such most of the time (Vector Meson Dominance (VMD), see section 6.6 and section 6.7). Total \u03b3\u03b3 cross sections are also provided.\n\u2022 Later extensions in the SaS/DL spirit [49]: K0p, \u03b7p, \u03b7\u2032p, D0,+p, D+s p, B 0,+p, B0s p, B + c p,\n\u03a5p, \u039bp, \u039ep, \u2126p, \u039bcp, \u039ecp, \u2126cp, \u039bbp, \u039ebp, and \u2126cp. Isospin symmetry is used to equate the cross sections of closely related particles, e.g. n with p and \u03a3+,0,\u2212,\u2217+,\u22170,\u2217\u2212 with \u039b. For the baryon-baryon processes, the corresponding baryon-antibaryon ones are also implemented. The purpose of these extensions is to allow the tracing of the evolution of cascades in matter, also in collisions with nuclei, meaning that essentially all hadronic collisions with protons or neutrons have to be included.\n\u2022 As a final case, a\u03c3Pptot(s) is defined for pomerons, but more for model studies of diffractive systems at a given mass than for comparisons with data.\nIn summary, by suitably mapping a particle onto one of equivalent flavour content, the possibilities above cover a fair fraction of all possible hadron collisions. The main exceptions are those involving baryons with more than one charm or bottom quark, and (most) collisions between two short-lived particles. Should the need arise, further extensions along the same lines would be possible for these cases.\nIt should be clear from the onset that the accuracy expected for these cross sections cannot compare with the pp and pp ones. As a rule of thumb, the rarer the particle, the more uncertain the assumptions that went into deriving related cross sections. For many applications, notably the evolution of a cascade in matter, it is the average collision rates that count rather than the individual ones, however, one may assume that it should still work out reasonably well.\nThe starting point in all these total cross sections is the pomeron plus reggeon ansatz of eq. (239). The X AB pomeron term strength appears to obey the Additive Quark Model (AQM) rule [208, 209], i.e. be proportional to the number ni of valence quarks in each hadron, but with a reduced contribution for strange and heavier quarks. Thus we have made the ansatz that X AB \u221d nAeff n B eff, with\nneff = nd + nu + 0.6ns + 0.2nc + 0.07nb . (245)\nThe prefactors for heavier quarks have been assumed roughly inversely proportional to their respective constituent quark masses, which could be viewed as a reflection of a reduced size of their spatial wave functions.\nThe modelling of the Y AB reggeon factors is considerably less systematic, since typically several reggeon trajectories may contribute. The mix of charge-even and charge-odd contributions gives Y AB 6= Y AB, while X AB = X AB. For baryon collisions Y AB > Y AB, which can be viewed as a reflection of possible contributions from qq annihilation graphs. This is supported by the observation that Y\u03c6p \u2248 0, consistent with the OZI rule [210\u2013212], and we assume that this suppression of couplings between light u/d quarks and s quarks extends to c and b. Thus, for baryons, the reggeon Y AB and Y AB values are assumed proportional to the number of u/d quarks only, scaled separately from the Y pp and Y pp reference values. Thereby baryons with the same flavour content, or only differing by the relative composition of u and d quarks, are taken to be equivalent, i.e. \u03c3\u039bp(s) = \u03c3\u03a3 +p(s) = \u03c3\u03a3 0p(s) = \u03c3\u03a3\n\u2212p(s). Another simplification is that D/B mesons are assigned the same cross sections as the respective D/B, taken to be some average.\nThe BABel slope for hadronic collisions is defined as in eq. (242), with a universal \u03b1 \u2032 but bA,B taken to be 1.4 for mesons and 2.3 for baryons, except that mesons made only out of c and b quarks are assumed to be more tightly bound and thus have lower values, in the spirit of the AQM factors. Given this, and assuming \u03c1 \u2248 0, the integrated elastic cross sections\nare given by eq. (241). For photon interactions, only the VMD part is assumed to undergo \u201celastic\u201d scatterings, so the fractions of fluctuations to \u03c10, \u03c9, \u03c60, or J/\u03c8 are combined with the expressions for these respective states to scatter elastically.\nDiffractive cross sections are again calculated using the SaS ansatz. It provides differential cross-section expressions for relevant collision processes, which are integrated numerically, with results suitably parameterized, including a special threshold-region form [213]. The ansatz for the pomeron-exchange hadronic form factor is taken to be \u03b2AP(t) = \u03b2AP(0) exp(bAt). With suitable normalization this translates to X AB = \u03b2AP(0)\u03b2BP(0). Thus \u03b2pP(0) = p X pp and other \u03b2AP(0) = X Ap/\u03b2pP(0). The \u03b2 numbers enter in the prefactor of single diffractive cross sections, e.g. \u03c3AB\u2192AX \u221d \u03b22AP(0)\u03b2BP(0) = X\nAB \u03b2AP(0). This expression can be viewed as a consequence of the optical theorem, wherein an (semi)elastic cross section is related to the square of a corresponding total one. Neither side is elastic in double diffraction AB \u2192 X1X2, and therefore the rate is directly proportional to X AB. For photons again only the VMD parts undergo diffractive scatterings.\nThe descriptions mentioned so far are intended for cross sections at high energies. Specifically, the original DL ansatz was tuned to data down to 6 GeV. At low energies, different descriptions are used, as outlined in the next subsection, most of which are not intended to be used much above 10 GeV. In cases where the full energy range from threshold upwards needs to be used, a smooth interpolation is therefore applied between the low- and high-energy descriptions. More precisely, the transition is linear in the range between\nEbeginCM = Emin +max(0., mA\u2212mp) +max(0., mB \u2212mp) , and (246)\nEendCM = E begin CM +\u2206E , (247)\nwhere Emin is 6 GeV and \u2206E is 8 GeV by default."
        },
        {
            "heading": "6.1.5 Low-energy processes",
            "text": "At low energies (below\u223c 10 GeV), the perturbative framework described in this section breaks down. In modern high-energy physics, experimental beam energies lie far above this threshold, but processes at these energies still have applications for example in hadronic rescattering (see section 7.4). PYTHIA provides a framework for simulating such low-energy collisions. This framework can be used explicitly by enabling LowEnergyQCD:* processes, and is used implicitly inside PYTHIA when rescattering is turned on. The following gives a summary of the available low-energy processes:\nElastic scattering AB \u2192 AB is implemented similarly to elastic scattering at high energies, except the cross section is calculated differently, as described below.\nDiffractive scattering (both single and double) is also similar to how it is implemented at high energies. Central diffractive (AX B) has a very small cross section at low energies, and is thus not implemented. In addition, at low energies the diffractive system can sometimes be viewed as a resonance excitation, for example pp\u2192 p\u2206+. In PYTHIA 8.3, these excitation processes are implemented only for nucleon-nucleon interactions.\nNon-diffractive scattering Works similarly in principle to high-energy non-diffractive interactions, but with extra steps to ensure the process does not reduce to an elastic scattering at energies very close to the threshold.\nAnnihilation processes Baryon-antibaryon interactions where one or two quarks annihilate.\nResonance formation A meson interacting with a baryon or another meson can form a resonance particle, e.g. p\u03c0+\u2192\u2206++ or \u03c0+\u03c0\u2212\u2192 \u03c10. While several of these processes correspond to similar high-energy processes, their cross sections are in most cases calculated differently, as perturbative calculations cannot be used at these energies. Only a short overview of how the cross sections are calculated is given here, and the reader is referred to [213] for further details.\nWhen PDG data is available5, total cross sections are calculated using parameterizations or by fitting to data. The HPR1R2 parameterization is used when available, as is the case for e.g. nucleon-nucleon interactions [214]. For baryon-antibaryon interactions, a parameterization due to UrQMD is used [215]. \u03c0 \u03c0 and \u03c0 K interactions use parameterizations by Pelaez et al. [216\u2013218]. For other processes involving mesons, if the pair can form resonances, the total cross section is calculated by summing the contributions from each resonance, possibly also adding an elastic contribution. While these cases describe the most common processes, there is also a large set that is not covered. For these remaining processes, the total cross section is calculated using the additive quark model (AQM) [208,209]with small modifications introduced to also include charm and bottom quarks [213]. Specifically, the total AQM cross section is given by\n\u03c3ABAQM = (40 mb) nAeff 3 nBeff 3 , (248)\nwhere neff is the \u201ceffective\u201d number of quarks in each hadron, given by eq. (245). With this, low-energy processes are available for all possible hadron-hadron types.\nIn our description, we define elastic interactions as processes where the hadrons exchange momenta without ever changing their types, e.g. through a pomeron exchange. We do not include for example \u201cpseudo-elastic\u201d scattering through a resonance, AB \u2192 R \u2192 AB. Note that this distinction usually cannot be made experimentally, so one often considers a process elastic as long as the outgoing hadrons are of the same type as the incoming ones. For nucleonnucleon and nucleon-pion interactions, the elastic cross section is found by fitting to data below 5 GeV [214], and by using the CERN/HERA parameterization above 5 GeV [219]. Elastic cross sections for baryon-antibaryon interactions are calculated using another parameterization by UrQMD [215], and for \u03c0 \u03c0 and \u03c0 K, we use parameterizations by Pelaez et al. [216\u2013218]. Other cross sections are given by an elastic AQM-style parameterization. The angular distribution of the outgoing hadrons is the same as for the high-energy case (section 6.1.2).\nDiffractive cross sections are calculated using the SaS model [198, 207], with two modifications. First, the basic model is designed to deal with processes involving only p, p, \u03c0, \u03c1, \u03c9, and \u03c6 hadrons. In the low-energy framework, the generic case is calculated by replacing each incoming hadron by the most similar among these particles (e.g. treating each baryon as a proton), then rescaling the calculated cross section by the appropriate AQM factor. The second modification is due to the fact that the basic SaS model is intended for collision energies above 10 GeV. This is compensated for by multiplying by an ad hoc factor below 10 GeV. At low energies, diffractive processes can lead to the formation of explicit resonances, e.g. pp \u2192 p\u2206+. This is implemented in PYTHIA 8.3 only for nucleon-nucleon interactions, using the description by UrQMD [215].\nNon-diffractive cross sections are calculated by subtracting all other partial cross sections from the total cross section. One important difference between non-diffractive interactions at low and high energies is that at low energies, the hadronization process might sometimes produce a hadron pair that is the same as the incoming pair, essentially reducing the interaction to an elastic process (AB \u2192 X1X2 \u2192 AB). This is a problem in cases where the calculated elastic cross section has already been adjusted to fit data. Several steps are taken to ensure\n5https://pdg.lbl.gov/2018/hadronic-xsections/hadron.html [214]\nthat this does not give unexpected contributions to the elastic cross section, and are outlined in section 7.1.6.\nAnnihilation processes in our framework refer to baryon-antibaryon interactions where one or two quark-antiquark pairs are annihilated. Strings are drawn between the remaining quarkantiquark pairs, and hadronize to form outgoing hadrons. The cross section for annihilation in pp is given by a parameterization by Koch and Dover [220],\n\u03c3ann = 120 s0 s A2s0 (s\u2212 s0)2 + A2s0 + 0.6 , (249)\nwhere s0 = 4m2p and A = 0.05 GeV. The cross section for other B B interactions is found by rescaling this value by an AQM factor. The only exception is when the quark-contents make annihilation impossible, e.g. like in a \u2206++ + \u03a3 \u2212 interaction, in which case the annihilation cross section is set to zero. Finally, resonance production refers to processes where the two hadrons combine to form one resonance particle. The cross section for the process AB\u2192 R is given by a non-relativistic Breit\u2013Wigner [214],\n\u03c3AB\u2192R = \u03c0\np2CM (2SR + 1) (2SA+ 1)(2SB + 1)\n\u0393R\u2192AB\u0393R\n(mR \u2212 p s)2 + 14\u0393 2 R , (250)\nwhere S is the spin of each particle, pCM is the CM momentum of the incoming particles, \u0393R\u2192AB is the mass-dependent partial width of the decay R\u2192 AB, and \u0393R is the mass-dependent total width of R. The full list of implemented resonances is given in [213]. For \u03c0 \u03c0 and \u03c0 K where the total cross section is calculated using the parameterization by Pelaez et al., the partial cross sections are rescaled to ensure their sum equals the total cross section."
        },
        {
            "heading": "6.2 Multiparton interactions basics",
            "text": "Hadrons are composite objects. A proton consists of three valence quarks, plus countless gluons and sea quarks. When two hadrons collide there is a possibility for several parton pairs to collide \u2014 multiparton interactions (MPIs). Processes with exactly two parton pairs, double parton scattering (DPS), was proposed in the early days of QCD, but then viewed as a rare perturbative process [221, 222]. Regge\u2013Gribov theory, on the other hand, allowed for events with multiple cut pomerons, i.e. several \u201cstrings\u201d crossing from one rapidity end of the event to the other, each generating its sequence of low-p\u22a5 hadrons [223]. The PYTHIA philosophy for the first time introduced a merger and extension of these two approaches [224]. In it, semiperturbative MPIs both generate multiple minijets, that contribute to the p\u22a5 flow, and multiple colour connections between the beam remnants, that leads to events with higher multiplicity. This picture is now generally accepted in its essentials. An overview of MPI theory and phenomenology can be found in [225], with the PYTHIA perspective described in [226], with many further references. See also the online manual under the \u201cMultiparton Interactions\u201d heading."
        },
        {
            "heading": "6.2.1 The perturbative cross section",
            "text": "The p\u22a5-differential perturbative QCD 2\u2192 2 cross section can, to leading order, be written as\nd\u03c3\ndp2\u22a5 = \u2211 i, j,k\n\u222b\u222b\u222b\nfi(x1,Q 2) f j(x2,Q 2) d\u03c3\u0302ki j d t\u0302 \u03b4 p2\u22a5 \u2212 t\u0302 u\u0302 s\u0302 dx1 dx2 d t\u0302 , (251)\nwith Q2 = p2\u22a5 as factorization and renormalization scale, partons assumed massless, and k running over processes with the same initial state but different final states (cf. eq. (37) and\neq. (42)). The partonic cross section d\u03c3\u0302/d t\u0302 is dominated by t-channel gluon exchange, i.e. qq\u2032 \u2192 qq\u2032, qg \u2192 qg and gg \u2192 gg. (Including those u-channel graphs that easily can be relabelled into t-channel ones.) This cross section has an approximate behaviour\nd\u03c3\u0302 d t\u0302 \u221d \u03b12s (Q 2) t\u03022 \u21d2 d\u03c3\u0302 dp2\u22a5 \u221d \u03b12s (p 2 \u22a5) p4\u22a5 . (252)\nEvidently this cross section is divergent in the limit p\u22a5\u2192 0, as shown in fig. 10. The integrated 2 \u2192 2 cross section above some p\u22a5min scale, \u03c3int(p\u22a5min), is increasing with the pp collision energy. But, taking p\u22a5min = 1 GeV as a scale where perturbation theory would be expected to hold, already at a collision energy of 200 GeV, the \u03c3int value exceeds the total pp cross section \u03c3tot at this energy.\nA further aspect is that \u03c3tot is subdivided into different components, as already discussed, and the 2 \u2192 2 partonic interactions primarily occur within the non-diffractive one, which is what we will assume next. They are absent in elastic scattering and low-mass diffraction, while they can occur in high-mass diffraction. This is a small fraction of the total cross section, however, so to first approximation we may neglect it. Later on we will correct the picture.\nPutting it together, one finds that\u03c3int(p\u22a5min) is around 60 mb for p\u22a5min \u2248 5 GeV at LHC energies, which is also the order of the non-diffractive pp cross section\u03c3nd. Going to lower p\u22a5min scales the cross section rapidly explodes, \u03c3int(2 GeV) \u2248 1000 mb \u2248 15\u03c3nd. In the context of MPIs, this is not as bad as it may sound, since we may interpret the ratio \u03c3int(p\u22a5min)/\u03c3nd as\nthe average number of MPIs above the p\u22a5min scale that occur in a non-diffractive collision. Nevertheless, an infinity of MPIs in the p\u22a5min\u2192 0 limit is not attractive.\nA damping of the cross section at low p\u22a5 can be viewed as a consequence of colour screening: in the p\u22a5\u2192 0 limit a hypothetical exchanged gluon would not resolve individual partons but only (attempt to) couple to the vanishing net colour charge of the hadron. By contrast, traditional perturbation theory is based on the assumption of asymptotically free incoming and outgoing partons. To be specific, a multiplicative damping factor\n\u03b1s(p2\u22a50 + p 2 \u22a5)\n\u03b1s(p2\u22a5)\np2\u22a5 p2\u22a50 + p 2 \u22a5\n2\n, (253)\nis introduced, with p\u22a50 a free parameter. This means a modification to eq. (252)\nd\u03c3\u0302 dp2\u22a5 \u223c \u03b12s (p 2 \u22a5) p4\u22a5 \u2212\u2192 \u03b12s (p 2 \u22a50 + p 2 \u22a5) (p2\u22a50 + p 2 \u22a5) 2 , (254)\nwhich is finite in the limit p\u22a5\u2192 0, cf. fig. 10b. The p\u22a50 value is not provided from first principles, although suggestions have been made to equate it with the saturation scale Qs in colour glass condensate models [227,228]. Fits to pp/pp data give a result that increases with energy, by default like\np\u22a50(ECM) = (2.28 GeV) ECM 7 TeV\n0.215\n, (255)\nbut alternatively a logarithmic rise could be assumed. It should be noted that results are sensitive to the choice of PDF set, and especially to the low-x behaviour of the gluon distribution at small Q2. The numbers are for the default NNPDF2.3 QCD+QED LO \u03b1s(MZ) = 0.130 set [229]. The choice of an LO PDF is deliberate, since the description of partonic collisions is also an LO one, but in particular since NLO PDFs tend to become unphysical at small x and Q2. This is why PYTHIA offers the possibility to use two different sets of PDFs, one for the hard processes, where these kinematic regions are not accessed, and one for MPIs and showers, where often they are.\nThe range of x values that can be accessed by MPI in PYTHIA is illustrated by the thick black lines in fig. 11, for hadronic CM energies ranging from 10 GeV (at the left-hand edge of the plot) to 100 TeV (at the right-hand edge). The shaded area emphasizes the region of low x \u2264 10\u22124 in which current PDFs are uncertain by a factor two or more. The red dashed line indicates the solution to x2s = 4p2\u22a50, for the default form of p\u22a50(ECM) given by eq. (255). Any partonic collision with p\u0302\u22a5 \u223c p\u22a50 will involve at least one x value below this line. Thus, especially at LHC energies and beyond, it is important to keep in mind that the effective MPI cross section (and hence any observables derived from it) around p\u0302\u22a5 \u223c p\u22a50 really depends on the combination of p\u22a50 and the shape of the low-x PDF parameterization. Since the latter can change drastically between different PDF sets, any \u201ctuned\u201d values of p\u22a50 should be considered valid only for the PDF set they were obtained with."
        },
        {
            "heading": "6.2.2 The impact-parameter model",
            "text": "A hadron is characterized not only by its longitudinal structure, as encoded in the PDFs, but also by its transverse one. That is, the \u201cimpact parameter\u201d plane overlap of partons in the two hadrons influences the possible collisions. The hadrons are Lorentz contracted to pancake shapes in high-energy collisions, such as the LHC, so the partons can be considered as frozen during the short collision time.\nAs a first approximation we will assume a common spatial distribution\u03c1(x)d3 x = \u03c1(r)d3 x for all parton types and momenta in a hadron. In the collision between two hadrons, passing by at an impact parameter b, the overlap between the two distributions is then given by\neO(b) = \u222b\u222b\nd3 x dt \u03c1boosted x \u2212 b 2 , y, z \u2212 vt \u03c1boosted x + b 2 , y, z + vt\n\u221d \u222b\u222b d3 x dt \u03c1(x , y, z)\u03c1(x , y, z \u2212 p b2 + t2) , (256)\nwhere the second line is obtained by suitable scale changes. A few different \u03c1 distributions have studied and made available as options. Using Gaussian distributions is especially convenient, since the convolution then becomes trivial. However, a single Gaussian does not give a good enough description of the data, and a better description is obtained with a sum of two Gaussians, with a small core region embedded in a larger hadron. This can be viewed as a manifestation of the \u201chot spot\u201d concept [230, 231], wherein partons may tend to cluster in a few small regions, typically associated with the three valence quarks, as a consequence of partons cascading from them. Another alternative, that is currently the default, is a one-parameter shape\neO(b)\u221d exp \u2212bd , (257)\nwhere d < 2 gives more fluctuations than a Gaussian and d > 2 less. The default value is d = 1.85, i.e. slightly more peaked than a Gaussian. Note that the expression is for the overlap, not for the individual hadrons, for which no related simple analytic form is available.\nIt is now assumed that the interaction rate, to first approximation, is proportional to the overlap \u2329enMPI(b)\u232a= k eO(b) . (258) Interactions are assumed to occur independently of each other for a given b, to first approximation, which leads to a Poissonian number distribution. Zero interactions means that the hadrons pass each other without interacting. The enMPI(b)\u2265 1 interaction probability therefore is\nPint(b) = 1\u2212 exp (\u2212\u2329enMPI(b)\u232a) = 1\u2212 exp \u2212k eO(b) . (259)\nWe notice that k eO(b) is essentially the same as the eikonal \u2126(s, b) = 2 Im\u03c7(s, b) of optical models [232\u2013235], but split into one piece eO(b) that is purely geometrical and one k = k(s) that carries the information on the parton-parton interaction cross section.\nSimple algebra shows that the average number of interactions in events, i.e. hadronic passes with nMPI \u2265 1, is given by\n\u2329n\u232a=\n\u222b\nk eO(b)d2 b \u222b\nPint(b)d2 b = k\u2329 eO\u232a= 1 \u03c3nd\n\u222b s/4\n0\nd\u03c3\ndp2\u22a5 dp2\u22a5 , (260)\nwhich fixes the absolute value of k (numerically). We have also taken the occasion to introduce \u2329 eO\u232a as the average overlap. Hence eO(b)/\u2329 eO\u232a represents the enhancement at small b and depletion at large b.\nSo far, we have assumed the transverse b-space profile to be decoupled from the longitudinal x one. This is not the expected behaviour, because low-x partons in a hadron should diffuse out towards larger r during the evolution down from higher-x ones [236]. Additionally, if r = 0 is defined as the centre of energy of a hadron, then by definition a parton with x \u2192 1 also implies r \u2192 0. In this spirit, there is a non-default PYTHIA option with correlated x and r [237]. It does not explicitly trace the evolution of cascades in x , but assumes that the r distribution of partons at any x can be described by a simple Gaussian, but with an x-dependent width:\n\u03c1(r, x)\u221d 1\na3(x) exp\n\u2212 r2\na2(x)\n, with a(x) = a0 1+ a1 ln 1 x , (261)\nwhere a0 and a1 are free parameters to be determined. The overlap is then given by\neO(b, x1, x2) = 1 \u03c0 1 a2(x1) + a2(x2) exp \u2212 b2 a2(x1) + a2(x2) . (262)\nIn principle one could argue that also a third length scale should be included, related to the transverse distance the exchanged propagator particle, normally a gluon, could travel. This distance should be made dependent on the p\u22a5 scale of the interaction. For simplicity, this further complication is not considered but, a finite effective radius is allowed also for x \u2192 1. The generation of events is more complicated with an x-dependent overlap, but largely involves the same basic principles. Until now, there is no evidence that this option provides a better description of data than the default, unfortunately."
        },
        {
            "heading": "6.2.3 The generation sequence",
            "text": "To introduce the MPI generation algorithm, leave aside the impact-parameter issue for a moment. The probability to have an MPI at a given p\u22a5 in a non-diffractive event is then given by (1/\u03c3nd)d\u03c3/dp\u22a5. If interactions occur independently of each other, the number of MPIs would be distributed according to a Poissonian, with the zero suppressed. There are a few ways to generate such a Poissonian.\nThe PYTHIA approach is inspired by the parton-shower paradigm. The generation of consecutive MPIs is formulated as an evolution downwards in p\u22a5, resulting in a sequence of n interactions with p s/2 > p\u22a51 > p\u22a52 > \u00b7 \u00b7 \u00b7 > p\u22a5n > 0. The probability distribution for p\u22a51 becomes dP\ndp\u22a51 = 1 \u03c3nd d\u03c3 dp\u22a51 exp\n\u2212 \u222b\np s/2\np\u22a51\n1 \u03c3nd d\u03c3 dp\u2032\u22a5 dp\u2032\u22a5 . (263)\nHere the naive probability is corrected by an exponential factor expressing that there must not be any interaction in the range between p s/2 and p\u22a51 for p\u22a51 to be the hardest interaction. The procedure can be iterated, to give\ndP dp\u22a5i = 1 \u03c3nd d\u03c3 dp\u22a5i exp \u2212 \u222b p\u22a5i\u22121\np\u22a5i\n1 \u03c3nd d\u03c3 dp\u2032\u22a5 dp\u2032\u22a5 . (264)\nThe exponential factors resemble Sudakov form factors of parton showers [51], or virtual corrections of \u201cuncut pomerons\u201d in the Regge\u2013Gribov framework, and fills the same function of ensuring that probabilities are bounded by unity. We will use the Sudakov terminology to stress this similarity. Summing up the probability for a scattering at a given p\u22a5 scale to happen at any step of the generation chain gives back (1/\u03c3nd)d\u03c3/dp\u22a5, and the number of interactions above any p\u22a5 is a Poissonian with an average of \u03c3int(p\u22a5)/\u03c3nd, as it should. The downwards evolution in p\u22a5 is handled by using the veto algorithm, like for showers. If no MPIs are generated in the evolution, a sequence is rejected and a new try made.\nWhen the impact-parameter variability is to be included as well, eq. (263) generalizes to\ndP d2 b dp\u22a51 = eO(b) \u2329 eO\u232a 1 \u03c3nd d\u03c3 dp\u22a51 exp \u2212 eO(b) \u2329 eO\u232a\n\u222b p s/2\np\u22a51\n1 \u03c3nd d\u03c3 dp\u2032\u22a5 dp\u2032\u22a5 . (265)\nThis expression can be integrated over p\u22a51 to give eq. (259). Once b has been chosen, the selection is similar to that in eq. (263), except that there is now a factor eO(b)/\u2329 eO\u232amultiplying the rate. The same factor enters in the extension of eq. (264), for the continued evolution, to\ndP dp\u22a5i = eO(b) \u2329 eO\u232a 1 \u03c3nd d\u03c3 dp\u22a5i exp \u2212 eO(b) \u2329 eO\u232a\n\u222b p\u22a5i\u22121\np\u22a5i\n1 \u03c3nd d\u03c3 dp\u2032\u22a5 dp\u2032\u22a5 . (266)\nThe usefulness of the doubly differential expression in eq. (265) is not so apparent in the generation of an inclusive non-diffractive event sample, where p\u22a51 can be integrated out before selecting b. But it gives important insights, especially since the MPI machinery is also intended to be used to generate the underlying event associated with other processes. Assume e.g. that we want to produce a hard jet sample, i.e. p\u22a51 > p\u22a5min. For a large p\u22a5min the steep fall of d\u03c3/dp\u22a5 ensures that the argument of the exponent is tiny, and so the exponent itself is close to unity and can be neglected. The b and p\u22a51 expressions then factorize. The former variable is selected proportional to eO(b), while the latter is selected according to the conventional differential cross section. Since eO(b) is more peaked at small b than Pint(b), it means that hard processes are selected at more central b values than inclusive non-diffractive events. The physics is quite clear: the probability to obtain a hard collision is proportional to the full parton-parton collision rate, \u2329enMPI(b)\u232a \u221d eO(b), and so it is strongly peaked at small b, while already a single MPI is enough to obtain a non-diffractive event, and so that probability saturates at unity in Pint(b). The consequence of picking a smaller b in hard processes is that the selection rate for subsequent MPIs, eq. (266), also is larger, thus giving a higher level of underlying activity than that of the full non-diffractive event sample, the \u201cpedestal effect\u201d.\nWhile the expression in eq. (265) provides for interpolation between hard and soft events, it is important to note that only the non-diffractive processes, i.e. the ones where the hardest interaction is selected by the MPI machinery, involve the full correlation. If one studies a hard process, be it hard QCD jets or something else, then in PYTHIA the selection of process kinematics is done with no reference to MPIs. It is only if and when, after the MPI machinery is invoked, that the p\u22a5 scale of the hard process is used to select a b value that takes into account the Sudakov factor.\nTherefore, in the study of hard QCD jets, one should not pick such a low p\u22a5min that the Sudakov factor deviates appreciably from unity. In practice, this means that one should have\np\u22a5min at least above 20 GeV at LHC energies. If one wants to study jets below that scale, one can as well start out from the full non-diffractive sample. When a hard process is fed into the MPI machinery, however, b is chosen according to eq. (265) in full, i.e. including the Sudakov. That is, if by mistake one were to generate LHC jets at or below 10 GeV, the Sudakov would not be used in the p\u22a5 selection, and thus the cross section would be overestimated, but it would be used in the b selection, and thereby provide the correct underlying-event activity.\nSo far, we have only considered 2\u2192 2 QCD processes in the MPI framework, but the list can be extended also to other ones. By default PYTHIA allows other 2\u2192 2 processes to be included in the Sudakov factor, and thereby also in the MPI generation: jet pairs via s-channel \u03b3\u2217 or tchannel \u03b3\u2217/Z/W\u00b1 exchange, events with one or two photons, or charmonium or bottomonium recoiling against a jet. Needless to say, these cross sections are much lower than the standard QCD ones, and therefore do not make much of a difference, but nevertheless help provide a richer non-diffractive or underlying-event structure.\nAnother issue is what upper limit to set for the selection of p\u22a52. If studying QCD jets, the ordering p\u22a51 > p\u22a52 is obvious; anything else would not reproduce the inclusive scattering cross section. But, if the hard process is single Z production, say, then this is not part of the MPI machinery, and so there is no double counting involved by allowing the underlying events to contain jets up to the kinematic limit. (The exception is if weak showers are switched on; then a hard QCD jet can emit a softer Z, and so such topologies could be double counted.) A few options are available, but the default strategy in PYTHIA is to split events into two types. If the final state of the hard process contains only (d,u, s, c or b) quarks, gluons, and photons then p\u22a5max is chosen to be the factorization scale for internal processes, and the scale value for external Les Houches input. If not, interactions are allowed to go all the way up to the kinematic limit."
        },
        {
            "heading": "6.2.4 Momentum and flavour conservation",
            "text": "As formulated so far, the same PDFs are used for all MPIs. This would allow more momentum to be taken out of a beam than there is, and also favour the repeated collisions of valence quarks that have already reacted. It is here that the ordering of the emissions becomes important. Standard PDFs can indeed be used for the first emission, which is the hardest one and therefore the one most visible and the one that standard PDFs have been tuned to describe. For subsequent emissions, the PDFs can gradually be modified to take into account the effects of the previous ones. An obvious modification is to rescale the x scale such that PDFs do not extend to higher values than left by the previous ones, i.e.\nx i < x i,max \u2261 X i = 1\u2212 i\u22121 \u2211\nj=1\nx j , (267)\nbut we will also want to consider flavour aspects. The beauty is that these successive modifications, that gradually let the PDFs diverge from the conventional ones, occur at falling p\u22a5 scales, where individual MPIs become less easily studied, so imperfections do not give large effects. The consecutive reduction of remaining momentum also means that the nMPI distribution, for a fixed b, will fall off faster than the assumed Poissonian. What does not change, fortunately, is the fraction of nMPI = 0 events that have to be thrown away, because that is entirely determined by whether a first MPI can be generated with standard PDFs or not.\nTo extend the PDF framework, to include not only a simple x rescaling but also flavour counting, it is assumed that quark distributions can be split into a valence and a sea part. In cases where this is not explicit in the PDF parameterizations, it is assumed that the sea is flavour-antiflavour symmetric, so that one can write e.g.\nu(x ,Q2) = uval(x ,Q 2) + usea(x ,Q 2) = uval(x ,Q 2) + u(x ,Q2) . (268)\nThe parameterized u(x ,Q2) and u(x ,Q2) distributions can then be used to find the relative probability for a kicked-out u quark to be either valence or sea.\nFor valence quarks two effects should be considered. One is the reduction in content by previous MPIs: if a u valence quark has been kicked out of a proton then only one remains, and if two then none remain. In addition, the constraint from momentum conservation should be included. Together this gives\nui,val(x ,Q 2) = Nu,val,remain Nu,val,original 1 X i uval x X i ,Q2 , (269)\nfor the u quark in the i\u2019th MPI, and similarly for the d. The 1/X i prefactor ensures that the ui integrates to the remaining number of valence quarks. The momentum sum is also preserved, except for the downwards rescaling for each kicked-out valence quark. The latter is compensated by a uniform scaling up of the gluon and sea PDFs.\nWhen a sea quark (or antiquark) qsea is kicked out of a hadron, it must leave behind a corresponding antisea parton in the beam remnant, by flavour conservation, which can then participate in another interaction. We can call this a companion antiquark, qcmp. In the perturbative approximation the pair comes from a gluon branching g\u2192 qsea + qcmp. This branching often would not be in the perturbative regime, but we choose to make a perturbative ansatz, and also to neglect subsequent perturbative evolution of the qcmp distribution. Even if approximate, this procedure should catch the key feature that a sea quark and its companion should not be expected too far apart in x . Given a selected xsea, the distribution in x = xcmp = y\u2212xsea then is\nqcmp(x; xsea) = C\n\u222b 1\n0\ng(y) Pg\u2192qseaqcmp(z)\u03b4(xsea \u2212 z y)dz\n= C g(xsea + x)\nxsea + x Pg\u2192qseaqcmp xsea xsea + x . (270)\nHere Pg\u2192qq(z) is the standard DGLAP branching kernel, g(y) an approximate gluon PDF, and C gives an overall normalization of the companion distribution to unity. Furthermore, an X i rescaling is necessary as for valence quarks. The addition of a companion quark does break the momentum sum rule, this times upwards, and so is compensated by a scaling down of the gluon and sea PDFs.\nIn summary, in the downwards evolution, the kinematic limit is respected by a rescaling of x . In addition, the number of remaining valence quarks and new companion quarks is properly normalized. Finally, the momentum sum is preserved by a scaling of gluon and (noncompanion) sea quarks. It is interesting to note that the joint PDFs for the first two MPIs behave rather similarly to the Gaunt\u2013Stirling DPS PDFs [238], whereas the PYTHIA approach currently is the only one that explicitly offers triple parton distributions and beyond."
        },
        {
            "heading": "6.2.5 Interleaved and intertwined evolution",
            "text": "So far we have only considered an MPI as a 2 \u2192 2 process, but it should be associated with ISR and FSR showers. In particular, ISR needs to take momentum from the beams, and can also change the \u201coriginal\u201d flavour taken out of the beam during the backwards evolution. This implies a more intricate competition between the MPI systems than already outlined. If all MPIs are first considered, then their number will be maximized, whereas there may be little room left for ISR. If instead ISR is added to each MPI before proceeding to the next, then there will be less room left for MPIs.\nTime ordering does not give any clear guidance what is the correct procedure. Incoming high-energy hadrons can be viewed as flat pancakes, such that all MPIs happen simultaneously\nat the collision moment, while ISR stretches backwards in time from it, and FSR forwards. But we have no clean way of separating the hard interactions themselves from the virtual ISR cascades that \u201calready\u201d exist in the colliding hadrons.\nInstead we choose the same guiding principle as we did when we originally decided to consider MPIs ordered in p\u22a5: it is most important to get the hardest part of the story \u201cright\u201d, and then one has to live with an increasing level of approximation for the softer steps. Since also showers are ordered in (some kind of) p\u22a5, it is meaningful to choose p\u22a5 as common evolution scale. Thus the scheme is characterized by one master formula\ndP dp\u22a5 = dPMPI dp\u22a5 + \u2211 dPISR dp\u22a5 + \u2211 dPFSR dp\u22a5\n\u00d7 exp \u2212 \u222b p\u22a5max\np\u22a5\ndPMPI dp\u2032\u22a5 + \u2211 dPISR dp\u2032\u22a5 + \u2211 dPFSR dp\u2032\u22a5 dp\u2032\u22a5 , (271)\nthat probabilistically determines what the next step will be. Here the ISR sum runs over all incoming partons, two per already produced MPI, the FSR sum runs over all outgoing partons (or dipoles), and p\u22a5max is the p\u22a5 of the previous step. Starting from the hardest interaction, eq. (271) can be used repeatedly to construct a complete parton-level event. The flavour and momentum used by previous MPIs or shower branchings are book kept in accordance with the principles outlined previously, with a few straightforward extensions. For ISR, e.g. the x and flavour of the own MPI does not count as used up.\nMPIs are not only related to each other by overall momentum and flavour conservation issues, but may be directly interacting with each other. Two such examples are joined interactions and partonic rescattering.\nIn the former, two partons participating in two separate MPIs may turn out to have a common ancestor when the backwards ISR evolution traces their prehistory. The joined interactions are well known in the context of the forwards evolution of multiparton densities [239, 240]. It can approximately be turned into a backwards evolution probability for a branching a\u2192 bc\ndPbc(xb, xc ,Q2)' dQ2 Q2 \u03b1s 2\u03c0 xa fa(xa,Q2) xb fb(xb,Q2) xc fc(xc ,Q2) z(1\u2212 z)Pa\u2192bc(z) , (272)\nwith xa = xb + xc and z = xb/(xb + xc). The main approximation is that the two-parton differential distribution has been been factorized as f (2)bc (xb, xc ,Q\n2)' fb(xb,Q2) fc(xc ,Q2), to put the equation in terms of more familiar quantities.\nJust like for the other processes considered, a form factor is given by integration over the relevant Q2 range and exponentiation. Associating Q ' p\u22a5, joined interactions can be included as a fourth term in eq. (271). But technical complications arise when the kinematics of joined branchings are reconstructed, notably in transverse momentum, and the code to overcome these was never written. One reason is that already the evolution itself showed that joinedinteraction effects are small and tend to occur at low p\u22a5 values [78].\nThe second intertwining possibility is rescattering, i.e. that a parton from one incoming hadron consecutively scatters against two or more partons from the other hadron. The simplest case, 3\u2192 3, i.e. one rescattering, has been well studied [241\u2013243]. The conclusion is that it should be less important than two separated 2\u2192 2 processes: 3\u2192 3 and 2\u00d7 (2\u2192 2) contain the same number of vertices and propagators, but the latter wins by involving one parton density more. The exception could be large p\u22a5 and x values, but there 2 \u2192 n, n \u2265 3 QCD radiation anyway is expected to be the dominant source of multi-jet events.\nFor rescattering, a detailed implementation is available as an option in PYTHIA [244], as follows. In order to allow a rescattering then a scattered parton has to be put back into the\nPDF, but now as a \u03b4 function. A hadron can therefore be characterized by a new PDF\nf (x ,Q2)\u2192 frescaled(x ,Q2) + \u2211\ni\n\u03b4(x \u2212 x i) = fun(x ,Q2) + f\u03b4(x ,Q2) , (273)\nwhere fun represents the unscattered part of the hadron and f\u03b4 the scattered one. The scattered partons have the same x values as originally picked, in the approximation that small-angle tchannel gluon exchange dominates, but more generally there will be shifts. The sum over delta functions runs over all partons that are available to rescatter, including outgoing states from hard or MPI processes and partons from ISR or FSR branchings. All the partons of this disturbed hadron can scatter, and so there is the possibility for an already extracted parton to scatter again. With the PDF written in this way, the MPI scattering rate can be seen as a sum of four terms, depending on whether the fun or the f\u03b4 is involved on either incoming side. Unfortunately, like for the joined interactions above, the kinematics become quite messy, specifically the propagation of recoils between systems that are partly intertwined but also partly separate.\nA third and more dramatic intertwining possibility is that the perturbative cascades grip into each other. An example is the \u201cswing\u201d mechanism, whereby two dipoles in the initial state can reconnect colours, which is a key aspect of the DIPSY generator [245, 246]. An implementation exists in a branch of PYTHIA 8.3 [247], but not yet in the public version."
        },
        {
            "heading": "6.2.6 Spatial parton vertices",
            "text": "While setting spatial production vertices of unstable hadrons and leptons is a standard task (see section 8.1.3), the corresponding task for parton vertices in MPIs (as well as for beam remnants and parton shower) is not. The main issue to tackle is, that as the MPI and shower models are formulated in momentum space only, no obviously correct correlation with an impactparameter picture exists. The plan is to further develop such an integrated framework, based on matching with dipole calculations on proton Fock states in impact-parameter space [247], but as such information is needed for string interactions (section 7.3) and hadronic rescattering (section 7.4), a basic framework is in place already now.\nThe basic framework includes four choices for the pp overlap region, from which vertices are sampled randomly. For all model choices, vertices of ISR and FSR partons are smeared relative to their mother by a Gaussian distribution, with a width of \u03c3v/k\u22a5, where k\u22a5 is the transverse momentum of the produced parton, and \u03c3v is a parameter to be set by the user.\nThe four possible choices for the overlap region are:\n\u2022 The proton profile is a Lorentz-contracted ball of uniform density. This gives an almondshaped overlap region, similar to heavy-ion collisions, favouring MPIs being displaced perpendicular to the collision plane. This option somewhat collides with impactparameter selection in the MPI model, as it does not allow any interactions of the impact parameter to be larger than twice the hadron radius.\n\u2022 The proton profile is a Lorentz-contracted three-dimensional Gaussian (motivated by the proton mass distribution), easily reduced to a two-dimensional one, as the z can be integrated out. The overlap region is taken as the product of the two displaced Gaussians, which is in itself a Gaussian.\n\u2022 A variation of the above Gaussian scheme, but elongated by a factor p\n(1+ \u03b5)/(1\u2212 \u03b5), where \u03b5 is a parameter determining whether production should be favoured in the collision frame or out of the collision frame.\n\u2022 Another variation of the Gaussian scheme, but with a modulation factor 1+\u03b5+cos(2\u03c6), and \u03c6 defined with respect to the collision plane.\nIt should be noted that the models for spatial parton vertices are at a very early stage of development, and subject to change in the future."
        },
        {
            "heading": "6.2.7 Other MPI aspects",
            "text": "There are several topics that concern MPIs, that will be described separately. One such is the issue of colour flow. The colours within each MPI, and its associated ISR and FSR, are initially assigned in the Nc \u2192\u221e limit. This implies that each parton taken out of a hadron, to go into a MPI, leaves its corresponding unique anticolours behind in the beam remnant. With many MPIs involved this gives an unrealistically complicated remnant, and so there is a machinery that attempts to associate an initial-parton colour from one MPI with an initialparton anticolour from another MPI. Remaining colour lines attach to the remnant partons, see further the beam remnants description. This still allows colour lines to be drawn criss-cross in the event. Colour reconnection (CR) is a mechanism whereby these colour lines may be reconnected, typically in such a way that the total string length is reduced, further described in section 7.2.\nIn this section we have reasoned around MPIs in the non-diffractive component in hadronhadron collisions, which is the prime, but not the only, application of the MPI framework. One extension is that photons have a resolved component, where they behave more-or-less like hadrons, and undergo MPIs in a similar manner. Another is that diffraction may be viewed as involving the collision of pomerons with hadrons or with each other, and that also pomerons can be associated with a hadronic structure that allows MPIs to occur. These aspects will be discussed further in their respective context.\nA standard task for PYTHIA is to generate one predetermined hard process and then add underlying-event activity to that, which means that most of the time the additional MPI activity will be too soft to give explicitly visible jets. This means that generation efficiency will be low if one is interested in studies of double parton scattering. But, there is a possibility to request two hard scatterings in an event, each of a given type and within given kinematic ranges. While one of the two processes can be selected from the full range of possibilities, the other must be chosen from a list of a dozen process groups. This is not a fundamental limitation, but covers all that we could see a possible application for, and if need be the list could be extended. Furthermore, as a non-standard extension to the Les Houches Accord, it is also possible to feed in external events with two hard processes for further handling in PYTHIA. See section 3.14 for further details.\nSince MPIs play such a key role for hadronic event properties, it is important to tune them as well as possible to describe minimum bias, i.e. predominantly non-diffractive, and underlying events alike. A number of settings and parameters are available to that end. Of special interest is the p\u22a50 parameter, that directly influences important properties such as the multiplicity distribution. Finally, it is worth mentioning that the MPI component normally is the most time-consuming task of the PYTHIA initialization step. In order to prepare the Monte Carlo sampling of the differential cross section, it is necessary to find an upper envelope of it in the (x1, x2, t\u0302) phase space. This envelope is based on multichannel sampling, where the relative importance of the channels should be optimized to allow a reasonably high sampling efficiency. The MPI cross section itself also needs to be integrated, as part of the p\u22a5-evolution formalism. The initialization of non-diffractive events therefore may take around a second, i.e. almost two orders more than it takes to generate an LHC event afterwards. If one had to repeat the MPI initialization for each new event, this step would form a bottleneck. That would be the case in diffractive events, where the mass of the diffractive system varies from one event to the next. To this end, diffraction is initialized for a number of logarithmically evenly spaced mass values, and then parameters for intermediate masses are obtained by interpolation. If the incoming beams have varying energies, also non-diffractive events can be\nset up for a range of collision energies. Thus initialization may take tens of seconds for the full set of inelastic processes, while the subsequent interpolation time is negligible compared to the event-generation one. If furthermore PYTHIA is initialized for multiple hadron types, the time needed becomes proportionately longer. An option therefore exists to save the MPI initialization data to a file, for reuse in subsequent runs, see section 9.6.2."
        },
        {
            "heading": "6.3 Beam remnants",
            "text": "What is left of a beam particle, after the partons initiating hard interactions and MPI have been removed from it (and showered), is called the beam remnant. By definition, the remnant itself does not participate in any momentum exchanges at scales larger than O(1 GeV). Hence, in PYTHIA, it is regarded as a purely non-perturbative object, which does not undergo a parton shower.\nThe general strategy is to add the minimal number of partons required to conserve the beam particle\u2019s quantum numbers (flavour, colour and baryon number), taking into account which valence and sea flavours have been scattered out of it. The remaining beam-particle momentum is then shared amongst those partons, as described below. Note that what is relevant to determining the remnant structure is not which partons initiated Born-level processes (or MPI) at the respective hard-process factorization scale(s), but instead the ones after initialstate radiation, at Q \u223c Qcutoff \u223c O(1GeV). For brevity, we henceforth refer to these low-scale partons as \u201cinitiator partons\u201d.\nBy default, also some \u201cintrinsic transverse momentum\u201d is added for the initiators and the remnant partons. Final momentum conservation is then ensured by rescaling the sampled momenta of the remnant partons appropriately. The procedure is discussed in more detail in [248] and outlined below for hadron beams and the more specialized cases of lepton and photon beams will be discussed in sections 6.5 to 6.7."
        },
        {
            "heading": "6.3.1 Flavour structure",
            "text": "The first step in beam remnant generation is to determine the number and flavours of the remnant partons. This begins by including the remaining valence quarks. For baryons, if two or more valence quarks are present, a randomly selected pair of these is turned into a diquark state. In this case, relative probabilities for different diquark spins are derived within the context of the non-relativistic SU(6) model, i.e. flavour SU(3)uds times spin SU(2). For instance, a ud diquark in a proton remnant is 3/4 spin-0 and 1/4 spin-1, while a uu diquark always has spin-1. If the initiator was a gluon, then the remnant is a colour-octet object, which is split into a triplet and an antitriplet, again using SU(6) to determine relative weights. For a proton remnant, P(u+ ud0) = 1 2 , P(u+ ud1) = 1 6 , and P(d + uu1) = 1 3 .\nOtherwise, the valence flavours are unambiguous assuming that valence content has been fixed beforehand. As sea quarks are created in pairs, for all sea quarks that have taken out from the beam particle a companion quark with an opposite flavour and colour is added if such have not been already found during partonic evolution. If no other remnants are needed, a gluon (photon) is added to carry the momentum of the hadron (lepton) beam, otherwise no gluons are added as remnant partons unless required to balance for the colour structure. For DIS events, it is also possible to collapse two remnant partons directly into a colour-singlet hadron."
        },
        {
            "heading": "6.3.2 Colour structure",
            "text": "Since the incoming hadrons (or, more generally, the incoming beam particles) are colourless, the combined set of initiator and beam-remnant partons must be colourless, too. In the very\nsimplest cases, such as when the remnant consists of a single triplet and/or antitriplet colour, there is no ambiguity. But when there are several such charges, the assignment of colour flow in the remnant (roughly, which remnant-parton colours to associate with which initiator-parton colours) is inherently ambiguous, and there is no first-principles solution. PYTHIA contains two distinct models that address this ambiguity, called \u201cold\u201d and \u201cnew\u201d, based on the time they were developed and implemented. Currently, the \u201cold\u201d one is the default.\nThe old model [248] is motivated by the way colour flow is treated in parton showers, and extends this to the beam remnant, as follows. Starting from the simplest representation of the colour structure of the valence quarks in the incoming beam particle (a quark-antiquark pair for a meson and a three-quark junction structure for a baryon, simplified to a quark-diquark structure when possible), initiator gluons are attached in random order to one of the valence quarks (selected at random if there are several), and quark-antiquark pairs are added as if they came from gluon splittings. Thus this model captures the qualitative behaviour that is expected from leading-colour QCD.\nThe new model [249] is motivated by SU(3) colour algebra, and essentially extends the QCD-based colour-reconnection model to the beam remnant, as follows. First, the set of initiator partons is considered. An SU(3) product determines the possible overall multiplets that can be formed from those partons. If one assumes they are uncorrelated, the naive probability for the set to be in any of those multiplets would be given simply by state counting. A free parameter allows for the application of an (exponential) weighting factor favouring small multiplets over larger ones. This is intended as a way to mimic correlations due to possible saturation effects which are not otherwise explicitly represented in PYTHIA. Having selected a multiplet for the set of initiator partons, the beam-remnant colour configuration has to be the inverse of that, to conserve the colour-singlet nature of the beam particle. The minimum amount of gluons are added to the beam remnant in order to obtain this colour configuration."
        },
        {
            "heading": "6.3.3 Primordial k\u22a5",
            "text": "As the hard processes and parton showers in PYTHIA are based on collinear factorization, only the longitudinal momenta are generated during the perturbative treatment. However, some transverse momentum of non-perturbative origin due to Fermi motion of partons inside a hadron is expected. Furthermore, studies on Z-boson transverse-momentum distributions have indicated that a significant amount of partonic p\u22a5 is required to reproduce these distributions in hadron-hadron collisions. In PYTHIA such partonic transverse momentum is modelled with primordial k\u22a5 that acts as a proxy for non-perturbative and possibly perturbative initial p\u22a5.\nIn PYTHIA the primordial k\u22a5 is generated from a two-dimensional Gaussian distribution. For hard-process initiators the width of the Gaussian is parameterized as\n\u03c3(Q) = \u03c3softQ1/2 +\u03c3hardQ (Q1/2 +Q) m (m+m1/2 ydamp) , (274)\nwhere Q is the renormalization scale for the hardest process and p\u22a5 for subsequent MPIs and m the mass ( p s\u0302) of the system. The Q-dependent factor provides an interpolation between a soft scale set by parameter \u03c3soft and a hard scale, set by \u03c3hard, and Q1/2 controls the midpoint between these two. The m-dependent factor on the right-hand side in turn provides damping for small-mass and/or large-rapidity systems. Such damping is introduced due to purely technical reasons so the controlling parameters m1/2 and ydamp = ( E m)\nrred , where rred controls the of amount rapidity damping, should not have much influence on related observables. For the remnant partons not directly connected to any hard process, the width of the k\u22a5-distribution is fixed by an another parameter \u03c3remn and does not depend on any scale related to hard\nscattering or MPIs. After sampling the k\u22a5 for each parton in the beam it is inevitable that the total transverse momentum of the beam becomes non-zero. To retrieve the original beam p\u22a5, the k\u22a5 of all partons will be rescaled with a common factor in such a way that the net four-momentum of the beam particles will be preserved."
        },
        {
            "heading": "6.3.4 Longitudinal momentum",
            "text": "In addition to the transverse momentum, the remnant partons should also carry the remaining longitudinal momentum of the beam particle, X . As a first step, a momentum fraction x < X is sampled for each remnant parton. In case of valence quarks, the value is sampled according to (1\u2212 x)a/ p x , where the power a can be adjusted for each parton flavour. Such a distribution approximates the valence quark PDFs around the initial scale O(1 GeV) at which the remnants are constructed. For the remaining companion quarks, the momentum fraction is sampled from the distribution defined in eq. (270) which takes into account that the sea quarks are always created in pairs, by definition, from gluon splittings. Gluons (and photons) are only added as remnants if no valence or companion quarks are remaining in the beam. As only one of these will be added as a remnant, it will carry all the remaining beam particle\u2019s momentum X .\nAfter the initial momentum fractions have been sampled for each remnant parton, these have be to rescaled to make sure that the total four-momentum is conserved in each event. As now both the initiator and the remnant partons carry also transverse momentum, the longitudinal-momentum fraction of the remnants cannot be simply rescaled with X but some momentum have to be shared between the two beams to balance the event, for details see [248, section 4.4]. In some special cases, such as DIS processes, only one remnant is required and no such balancing can be done. To account for momentum conservation, the final-state parton momenta are then boosted and rotated in such a way that the total four-momentum is conserved for the sampled remnant configuration."
        },
        {
            "heading": "6.4 Hadron-hadron collisions",
            "text": "In section 6.1 we introduced the main event types in hadron-hadron collisions, and how their total and differential cross sections are parameterized in PYTHIA 8.3. Elastic-scattering events are trivial to model, given the d\u03c3/dt cross-section expression; there are just two hadrons coming in and the same two coming out, with a momentum transfer t and a randomly-selected \u03d5 angle. See section 6.1.2 for the various options available for proton elastic-scattering cross sections, and section 6.1.4 for the less sophisticated expressions used for other hadrons. The subsequent test on MPIs and beam remnants are mainly concerned the non-diffractive component. It has the largest cross section, and especially it is the one where the bulk of hard processes occur, which makes it the most studied one experimentally. In this section we provide some further comments on this event class in section 6.4.1, but in particular describe additional aspects in the description of diffraction in sections 6.4.2 and 6.4.3."
        },
        {
            "heading": "6.4.1 Minimum-bias and related inclusive processes",
            "text": "The inelastic non-diffractive event type is often also called Minimum Bias (MB). Strictly speaking, however, MB refers to the smallest possible trigger bias that allows for the identification of non-empty events in a given experimental context. Depending on the detector acceptance, MB will typically also include contributions from processes that PYTHIA labels as diffractive. Thus, if the aim is to simulate an inclusive sample of \u201cminimum bias\u201d events, usually both diffractive and non-diffractive events must be included, and then subjected to the appropriate experimental trigger requirements.\nOther, related, experimental terms are zero bias (e.g. based on a bunch-crossing timing trigger, including some a priori unknown fraction of genuinely empty events), pileup (essentially also zero bias except in cases where pileup contamination may affect trigger variables such as calorimeter energies), inelastic\u2265 N events (inelastic events with at least N particles in some given fiducial region), and non-single-diffractive events (typically a \u201cdouble-sided\u201d MB trigger).\nRelated to this, note that the distinction between diffractive and non-diffractive processes is not without ambiguity. In experimental contexts, diffraction may be defined in terms of observable \u201crapidity gaps\u201d with no particle production detected in specific region(s) of the detector, while in theoretical contexts processes that are classified as diffractive typically produce a whole spectrum of gaps with small ones suppressed but not excluded, see section 6.4.2. Conversely, events that are modelled as non-diffractive in origin may produce large rapidity gaps, due to fluctuations in the fragmentation process and/or if colour reconnections \u2014 see section 7.2 \u2014 are allowed to produce such gaps, and in the transition region there could even be quantum interference between the two categories (not modelled by PYTHIA). Thus, for any given application it is important to phrase experimental measurements in terms of clearly defined physical observables, and consider which MC processes are going to be able to contribute to those.\nUsually hard processes, such as jet or gauge-boson production, are assumed to occur within the non-diffractive event class. This is not quite true, since it is possible also for diffractive topologies to contribute to hard cross sections, see section 6.4.3. That contribution typically is of the order of a per cent when modelled or measured experimentally, however, and is neglected by default. This means that the full parton distribution functions (PDFs) are associated with the non-diffractive component. They are used not only for the hard process itself but also for the associated MPI, ISR and FSR activity. See further section 3.12"
        },
        {
            "heading": "6.4.2 Diffractive processes",
            "text": "Diffractive event topologies are illustrated in fig. 9 on p. 114, and the differential cross sections are described in section 6.1.3. The choice of diffractive mass(es) and t values sets the overall kinematics of the events, but does not describe the hadronization of the diffractive system. To this end, the Ingelman\u2013Schlein approach is used [250], with details as described further in [199]. In this approach, a pomeron is viewed as a physical particle, akin to a glueball state, with an internal structure and notably with PDFs. Similarly, a reggeon is viewed as a mesonic state, but for the practical handling the two are not distinguished. Single diffraction therefore contains a pomeron-proton subcollision, double diffraction two such, and central diffraction a pomeron-pomeron subcollision. Each such subcollision is assumed to produce particles as in a normal inelastic non-diffractive hadron-hadron collision.\nAt high energies the modelling on the perturbative level is then given by the MPI machinery, augmented by ISR and FSR. There are a few issues that need to be clarified, however. Notably the MPI collision rate involves a combination of the pomeron-inside-proton flux with the parton-inside-pomeron PDF. What is measured, e.g. at HERA, is the convolution of the two, where the absolute normalization of each individually is not known. Historically, the flux normalization was specified, such that then the pomeron PDF does not have to obey the momentum sum rule. This may seem odd, but is in line with some theoretical arguments that the pomeron is not a real particle and therefore is not bound by such constraints. There are a dozen different pomeron PDFs that come with PYTHIA (plus three special-purpose ones), and most of these have a momentum sum of the order of 0.5. It is possible to scale them by a factor, to restore unit normalization. Whether that is done or not, the rescaling of remaining momentum for subsequent MPIs is done as for a normal hadron, however. That is, the normalization matters for the rate of MPI production, but not for the handling of those MPIs that\ndo occur. Further, the ordinary non-diffractive MPI rate is related not only to PDFs but also to the normalization with the non-diffractive total cross section \u03c3nd, cf. eq. (260) and other MPI expressions. This is an unknown number from first principles, and with the same pomeronflux-normalization uncertainty as the PDFs, so effectively it can be used to compensate for a non-unit momentum sum. The default value is 10 mb at a collision CM energy of 100 GeV, where it has been tuned (with default PDFs etc.) to produce about the same average charge multiplicity as ordinary pp non-diffractive collisions at the same energy. This value could be energy-dependent, cf. the pomeron term in eq. (239), but currently the default is a constant value.\nDiffraction tends to be peripheral, i.e. occur at high-to-intermediate impact parameter for the two protons. That aspect is implicit in the modelling of diffractive cross sections. For the simulation of the pomeron-proton subcollision itself, however, it is rather the impact-parameter distribution of that particular subsystem that should be modelled. That is, it also involves the transverse coordinate-space shape of a pomeron wave function. The outcome of the convolution with a proton wave function could be a different shape than for non-diffractive events, and therefore it can be set separately. The default is a simple Gaussian, for lack of any relevant data. The p\u22a50 scale is assumed the same as in non-diffractive events at the same collision energy, but also that is an assumption that could be questioned.\nThe diffractive mass spectrum extends down to the \u2206+ mass for pp collisions, and obviously a perturbative MPI description would not make sense at such low energies. Instead a separate low-mass description has been implemented. Up to 1 GeV above the hadron mass, the diffractive system is allowed to decay isotropically into a two-hadron state. Above that, a diffractively-excited hadron is modelled as if either a valence quark or a gluon is kicked out from it, along the collision axis with some \u201cprimordial k\u22a5\u201d smearing, cf. section 6.3.3.\nIn the former case this produces a simple string to the leftover remnant, in the latter it gives a hairpin arrangement where a string is stretched from one quark in the remnant, via the gluon, back to the rest of the remnant. The latter topology ought to dominate at higher mass MX of the diffractive system. Therefore an approximate behaviour like\nPq Pg = N M pX (275)\nis assumed, with N (= 5 by default) and p (= 1) as free parameters, and MX in GeV. There is a smooth transition between the low-mass non-perturbative and the high-mass perturbative descriptions. The probability for applying the latter is given by [251]\nPpert = 1\u2212 exp\n\u2212 max(0, MX \u2212mmin)\nmwidth\n, (276)\nwith mmin and mwidth free parameters, both by default 10 GeV. Note how Ppert vanishes when below mmin."
        },
        {
            "heading": "6.4.3 Hard diffraction",
            "text": "The model for hard diffraction is somewhat different from the soft (low- and high-mass) diffraction and it can be applied to any hard process, including e.g. high-p\u22a5 jets and EW bosons. The starting point is again the Ingelman\u2013Schlein picture where these interactions are mediated by a pomeron whose internal structure is given by the diffractive PDFs. It has been observed, however, that this factorization-based approach is broken as the predictions based on the diffractive PDFs determined in diffractive DIS overshoot the hard diffractive data in hadron-hadron collisions roughly by an order of magnitude [252,253]. In the PYTHIA framework this can be naturally explained by having several non-diffractive partonic interactions,\nMPIs, in the same hadron-hadron collisions on top of the diffractive process. These may then produce particles that fill up the rapidity gap used to select the diffractive events leading to seemingly a suppressed diffractive cross section. The details of this dynamical rapidity gap survival model are presented in [254], together with several data comparisons, and are briefly outlined below.\nAfter a hard process and its kinematics are sampled, the events of diffractive origin are first selected based on relative magnitude of the diffractive, f p,Di , and non-diffractive, f p,ND i , PDFs which together form the inclusive (the usual) hadronic PDFs\nf pi (x ,Q 2) = f p,NDi (x ,Q 2) + f p,Di (x ,Q 2) . (277)\nThe diffractive part, in turn, can be defined as a convolution between the pomeron flux f pP and pomeron PDF f Pi :\nf pi (x ,Q 2) =\n\u222b 1\nx\ndxP xP f pP (xP) f P i (x/xP,Q 2) , (278)\nwhich can be considered as parton-in-pomeron-in-proton PDFs, typically determined using diffractive DIS data from HERA. After this tentative selection of diffractive events corresponding to the Ingelman\u2013Schlein approach, the pomeron kinematics are sampled and the event is processed further. The essence of the PYTHIA model is then to perform a full parton-level evolution for the original hadron-hadron system and to check whether any MPIs, that would render the event to a non-diffractive one, has occurred. This allows for the generation of a sample where only events without such additional interactions remain and the rapidity gap has survived. It is also possible not to perform such a check and obtain the purely factorization-based result that serves as a baseline for the expected cross-section suppression. Notice, however, that MPIs in the pomeron-hadron system are still allowed as these would not fill up the rapidity gap between the excited hadron and the pomeron remnants. Remarkably, this model relies solely on the MPI model in PYTHIA and does not require any further parameters tuned to data. Yet, it can qualitatively explain the order-of-magnitude difference between the purely factorization-based predictions and Tevatron and LHC data, and reproduces the latest CMS data for diffractive dijets [255] with a good precision. Only single diffraction is currently implemented, and if both beams have been found to emit pomerons, the diffractive side is selected randomly with equal probabilities. It is possible to consider pomeron emissions from one side only which can be useful for non-symmetric collisions."
        },
        {
            "heading": "6.5 Lepton-lepton collisions",
            "text": "Lepton colliders have a reputation for providing the cleanest collisions possible, with e+e\u2212\u2192 Z\u2192 ff at LEP/SLC providing a prime example, where Z properties could be studied in minute detail. At lower energies, charm and beauty factories have advanced our understanding of the standard model, e.g. the weak unitarity triangle(s). The key argument for future lepton colliders often is precision Higgs physics. Nevertheless, lepton colliders also have their challenges, as will be discussed in this section."
        },
        {
            "heading": "6.5.1 Bremsstrahlung and lepton PDFs",
            "text": "A lepton is surrounded by a cloud of virtual photons. In a collision, such as e+e\u2212 annihilation, some of those photons survive in the final state as so-called bremsstrahlung, mainly travelling near the incoming lepton directions, and the annihilation energy is reduced correspondingly. Similarly to the traditional PDF evolution in Q2 of a hadron, one can here start from a low-Q2 f ee (x ,Q 2 0) = \u03b4(x \u2212 1) and evolve it with a splitting kernel\ndPe\u2192e\u03b3 = dQ2 Q2 \u03b1em 2\u03c0 1+ z2 1\u2212 z dz , (279)\nin close analogy with q \u2192 qg. The resummed effects of multiple photon emissions are described in PYTHIA by an NLO expression [256] of the approximate shape\nf ee (x ,Q 2)\u2248\n\u03b2 2 (1\u2212 x)\u03b2/2\u22121 , \u03b2 = 2\u03b1em \u03c0 ln Q2 m2e \u2212 1 . (280)\nThe form is divergent but integrable for x \u2192 1, i.e. the electron tends to keep most of the energy. To handle the numerical precision problems for x very close to unity, where 64-bit double precision would not be sufficient, the (electron) parton distribution is set to zero for x > 1\u2212 10\u221210, and is rescaled upwards in the range 1\u2212 10\u22127 < x < 1\u2212 10\u221210, in such a way that the total area under the parton distribution is preserved:\nf ee (x ,Q 2) mod =\n\n   \n   \nf ee (x ,Q 2) , 0\u2264 x \u2264 1\u2212 10\u22127 ,\n1000\u03b2/2\n1000\u03b2/2 \u2212 1 f ee (x ,Q 2) , 1\u2212 10\u22127 < x < 1\u2212 10\u221210 , 0 , x > 1\u2212 10\u221210 .\n(281)\nTurning to the photon flux, the evolution equation eq. (279) is deceptive in that it appears to treat the electron and photon on equal footing. But, there is no resummation of the photon spectrum, as there is for the one-and-only electron, only an increasing number of photons as the evolution continues. The typical kinematics is also different. When we consider f ee (x ,Q\n2), it is for an annihilating e\u00b1, where m2e Q\n2 \u223c s, and the radiated energy manifests itself in terms of massless photons. For the f e\u03b3 (x ,Q\n2), it is instead the electron that has to be on mass shell, a requirement that leads to a non-trivial Q2min, and the photon that is virtual. This gives a PDF like\nf e\u03b3 (x ,Q 2) = \u03b1em 2\u03c0\n1+ (1\u2212 x)2\nx ln\nQ2\nQ2min\n, Q2min \u2248 m2e x 2\n1\u2212 x , (282)\nwhich obviously should vanish if Q2 \u2264Q2min. In typical physics applications, it is conventional to set Q2 =Q2max \u223c 1 GeV\n2 to define a beam of quasi-real photons, that then can lead to \u03b3p and \u03b3\u03b3 collisions. A photon more virtual than that would rather be considered as the propagator of a deep inelastic scattering event, and one would not use PDF language to describe it. See further section 6.6 and section 6.7.\nThe above equations for an electron beam can easily be extended to a muon one, simply by replacing me by m\u00b5, and similarly for \u03c4. Neutrinos do not couple to photons and so there is no need to introduce a substructure for them.\nReturning to the issue of e+e\u2212 annihilation, the effects of bremsstrahlung are more easily illustrated if only one photon emission is considered, but from either side, in which case\nd\u03c3 dx\u03b3 = \u03b1em \u03c0 ln s m2e \u2212 1\n1+ (1\u2212 x\u03b3)2\nx\u03b3 \u03c30(s\u0302) , (283)\nwhere x\u03b3 is the photon energy fraction of the beam energy, s\u0302 = (1\u2212x\u03b3)s is the squared reduced hadronic CM energy, and \u03c30 is the ordinary annihilation cross section at the reduced energy. For e+e\u2212 \u2192 \u03b3\u2217 \u2192 ff, where \u03c30(s\u0302) \u221d 1/s\u0302 \u221d 1/(1 \u2212 x\u03b3), the bremsstrahlung spectrum thus is singular both for x\u03b3 \u2192 0 and x\u03b3 \u2192 1. The former is a true singularity, corresponding to infinitely soft photons, that fortunately also carry away infinitely little energy from the electron. The latter is cut off by the mass threshold for ff production.\nIf instead the e+e\u2212 collider is running on a peak in the cross section, like the Z one at LEP 1, and neglecting interference with \u03b3\u2217 for simplicity, then \u03c30(s\u0302) < \u03c30(s). While the soft-photon singularity remains, any non-negligible photon energy will push the Z propagator further offshell, which leads to a suppression of such photon emissions and of the total Z cross section.\nThe situation is even more extreme for charm and beauty factories when they run on a narrow \u03c8 or \u03a5 state, where the net effect is a loss of cross section. PYTHIA does not simulate such emissions, however, or indeed the production of onium states by e+e\u2212 colliders.\nFinally, note that leptons can be polarized both transversely and longitudinally, the former by plane polarization in circular rings and the latter by spin rotation thereof. This can lead to non-trivial effects on cross sections, since the standard model distinguishes between left- and right-handed fermions, and is therefore expected to be a main staple at future linear colliders. While PYTHIA 6.4 encoded spin-dependent cross sections for a few common processes, none of these have been ported to PYTHIA 8.3. If Les-Houches event input is used, such effects can be taken into account already at that level, and will not affect the continued handling of the event by PYTHIA."
        },
        {
            "heading": "6.5.2 Beamstrahlung",
            "text": "At potential future linear e+e\u2212 colliders, the beams will be so tightly collimated that the electrical field of one beam will significantly deflect the individual e\u00b1 of the other. This acceleration of charges leads to the emission of photons \u2014 beamstrahlung. Like bremsstrahlung, it gives a reduced collision energy, a disadvantage that has to be balanced against the gains of a higher luminosity. Beamstrahlung emits real photons and keeps the electrons real as well, so there is no Q2 dependence but only an x one. The f ee (x) spectrum is highly dependent on the beam parameters, and varies e.g. between the front and the tail of a bunch. It is therefore in the realm of machine physicists to provide relevant spectra, e.g. with the GUINEA-PIG program [257]. Simplified parameterizations are found in the CIRCE program [258].\nFor e+e\u2212 annihilation, the beamstrahlung and bremsstrahlung effects must be convoluted. Relevant code for handling such a convolution does not (yet) exist in PYTHIA 8.3. In case of need, a temporary solution is to split the energy remaining after beamstrahlung, but before bremsstrahlung, into small bins that are generated separately and combined in proportion to their respective cross section. This requires an initialization for each bin, but this is not such a big overhead since the MPI bottleneck is absent in e+e\u2212 annihilation."
        },
        {
            "heading": "6.5.3 Processes",
            "text": "PYTHIA contains many processes initiated by a fermion-antifermion pair, and these can almost all be used both for hadron and lepton colliders. The list includes electroweak processes, top production, Higgs physics, new gauge bosons, supersymmetry, and so on.\nMost prominent is e+e\u2212\u2192 \u03b3\u2217/Z\u2192 ff. It has been the main staple of all lepton colliders so far, possibly with the exception of LEP 2. In addition to precision electroweak physics, it has allowed the study of FSR and hadronization under the cleanest conditions that we can hope for. The simplest \u03b3\u2217/Z\u2192 qq process produces a single string between the q and q endpoints. One order up, \u03b3\u2217/Z\u2192 qqg offers access both to \u03b1s and to tests of string topologies, specifically to confirm that a string is drawn from the q via the g to the q. With four-jet events, mainly \u03b3\u2217/Z\u2192 qqgg, the non-Abelian nature of QCD could be established. Taken together, the measured particle composition can be used to tune flavour parameters, measured jet rates and correlations to tune showers, and measured particle spectra to tune longitudinal and transverse fragmentation properties.\nFor LEP 2, instead W+W\u2212 pair production was the most prominent process, although \u03b3\u03b3 physics contributed at an even higher rate. Apart from electroweak physics, of note is that e+e\u2212 \u2192 W+W\u2212 \u2192 q1q2q3q4 offers a test bed for colour reconnections, further described in section 7.2."
        },
        {
            "heading": "6.6 Lepton-hadron collisions",
            "text": "In lepton-hadron collisions the events are often classified in terms of virtuality of the intermediate photon, Q2. Events where the virtuality is large, or the mass of exchanged EW boson is large, and the target hadron breaks up are referred to as deep inelastic scattering (DIS). At low virtualities (Q2 \u00ae 1 GeV2), the events are in the photoproduction region where the photons can either interact directly as unresolved particles or fluctuate into a hadronic state with equal quantum numbers. In PYTHIA 8.3 these two event classes are handled in separate frameworks and the special features of the former class are discussed below. The photoproduction framework is, in turn, introduced in section 6.7."
        },
        {
            "heading": "6.6.1 Parton distribution functions and structure functions",
            "text": "In DIS the intermediate boson scatters off a parton in the target hadron in a relatively clean scattering process where the kinematics characterizing the scattering can be related to the four-momentum of the outgoing lepton. Therefore, such collisions can be used to study the structure of the hadron and the initial-state QCD dynamics. Let P denote the four-momentum of the incoming hadron, k the incoming lepton and k\u2032 the scattered lepton. Then it is possible to define the following Lorentz-invariant quantities\nQ2 = \u2212q2 = \u2212(k\u2212 k\u2032)2 ,\nW 2 = (P + q)2 ,\nx = Q2\n2 P \u00b7 q ,\ny = P \u00b7 q P \u00b7 k , (284)\npurely based on measured energy and scattering angle of the scattered lepton. In fully inclusive events, where the hadronic final state is integrated out, it is possible then to write down the cross section of such a scattering process in terms of these quantities without making further assumptions on the proton structure\nd2\u03c3 dxdy = N l y2 x F l1(x ,Q 2) + (1\u2212 y) F l2(x ,Q 2)\u2213 (y \u2212 y2 2 )x F l3(x ,Q 2) . (285)\nThe coupling factor N l is different for neutral- and charged-current DIS and the sign of the last term depends on whether the incoming lepton l is charged or neutral (neutrino) and if it is a particle or an antiparticle. The structure functions F li (x ,Q\n2) represent the partonic structure of the hadron. In the leading-order parton model [259,260] the structure functions are simply proportional to the sum of the parton distributions f (x ,Q2) but do depend also on beam lepton type. The x can be interpreted as the momentum-energy fraction of the parton with respect to the hadron momentum P and the Q2 dependency arise from the QCD corrections at higher orders. The goal of PYTHIA 8.3 is, however, to provide fully exclusive events for which the relevant treatment is described next."
        },
        {
            "heading": "6.6.2 Deep inelastic scattering",
            "text": "The DIS framework describes processes where the scattered lepton emits a highly-virtual (point-like) photon or a massive gauge boson that interacts with the constituents of the target hadron breaking it up. As there currently are no models for intermediate photon virtualities (Q2 \u223c 1 GeV2) where high-virtuality, point-like, and low-virtuality hadronic processes contribute to cross sections, the DIS framework provides a reliable description only at sufficiently\nlarge Q2 where the scattering is purely mediated by a point-like particle. As the resolvedphoton contribution fade continuously (roughly as \u223c 1/Q2), it is impossible to set a hard cut for such a region. In most applications, however, a limit of Q2 > 5 GeV2 has turned out to be sufficient to ensure negligible contributions from the hadronic fluctuations. As the model for intermediate virtualities implemented in PYTHIA 6 was based on several parameterizations mimicking the physical picture and turned out to be somewhat fragile with restricted predictability, we have decided to develop a completely new model for such processes that will be implemented in a future PYTHIA 8.3 release.\nHard processes In the LO DIS implemented in PYTHIA, the incoming lepton scatters off a quark from the target hadron by exchanging an EW boson. As described in section 3.2, this includes both neutral- and charged-current processes with charged leptons and neutrinos, and the interference between a virtual photon and the Z boson can be accounted for. The DISoptimized scale-setting options are listed in section 3.10 and the relevant phase-space cuts in section 3.13. It is also possible to provide the hard process as an input from an ME generator in the LHE format. However, no matching of higher-order processes and the default parton shower has been implemented. As the hard-processes are set up in the collinear approximation, no off-shellness is allowed for the initial lepton line. Thus no radiation should be allowed for the initial-state lepton and no PDFs for the lepton used. The phase-space sampling for DIS is inherited from generic massless 2 \u2192 2 scattering where the initiators are assumed massless but the final-state particles can have finite masses. This is not ideal for DIS, however, since the invariants typically studied in DIS, Bjorken x and Q2, are often derived from the fourmomentum of the scattered lepton. Due to a mismatch in masses, these variables might then not match the internally sampled values which can lead to unphysical configurations such as x > 1 when invariants are derived from the scattered lepton. To fix the issue, a new phasespace sampling optimized for t-channel exchange of bosons with (potentially varying) masses will be implemented. Heavy-quark pairs can be produced in two different ways: if the lepton scatters off a heavy quark, a companion will be added by ISR, or the heavy-quark pair can be formed from a gluon splitting by FSR. Similarly, DIS events with more than one jet can be formed via PS emissions but no explicit hard dijet processes have been included. The showers do, however, include matrix-element corrections for the first emissions. As the DIS process is a scattering of a single point-like particle, no MPIs are allowed.\nParton showers Both initial- and final-state radiation from deep-inelastic-scattering processes require a careful treatment of the branching kinematics. If emissions from the hadronic system disturb (via recoil) the lepton line, or vice versa, then both the x and the Q2 distribution are affected by showering. In this case, an intricate recalculation of the hard-scattering cross section after each parton-shower emission is required, making the strategy sub optimal6. The natural resolution is to ensure that any recoil due to the branching process is contained either in the hadronic or the leptonic system. For the hadronic system, this is most easily achieved by employing a \u201clocal dipole recoil\u201d strategy, in which the kinematic recoil is absorbed by a colourconnected partner. Such a strategy is employed by the DIRE section 4.3 and VINCIA section 4.2 showers, and is an option for the simple-shower methods [80]. To model the QED evolution of the leptonic line, this approach is insufficient, however, and more complex strategies are necessary, or the conservation of x and Q2 may need to be relaxed, e.g. for charged-current DIS events, where electric charge flows from the lepton to the hadron system. The latter is the case in the DIRE shower.\n6Similar concerns apply to any scattering via t-channel colour-singlet exchange, e.g. to Higgs production in vector-boson fusion.\nAnother important aspect of modelling radiation in DIS events is the phase-space boundary for emissions that involve incoming partons. The factorization scale (i.e. typically Q2) gives a natural phase-space boundary when using backward initial-state evolution [52]. However, the kinematic boundary is more accurately given by the invariant mass of the radiating dipole or the invariant mass of the hadronic system (W 2), which are often, and especially for low-x values, significantly larger than Q2. A natural resolution of this issue is to keep the tight Q2 constraint for the shower, and use (tree-level) merging to supplement the missing phase-space regions. Another approach is to abandon the DGLAP-based initial-state evolution [6]. In lieu of the latter, hard initial-state emission in the partons shower models of PYTHIA should be considered with caution.\nAs the DIS events are rather clean, they offer a very good environment to study partonshower dynamics. For example, since the parton shower produces p\u22a5 kicks for the initiator via emissions, it can be thought to resemble perturbative evolution of transverse-momentum dependent (TMD) PDFs [261, 262]. Thus one should obtain reasonable p\u22a5 distributions in Semi\u2013Inclusive DIS (SIDIS) from the parton-shower enabled PYTHIA simulations.\nHadronization The hadronization of DIS events is analogous to that of hadron-hadron scattering systems. The scattered lepton does not partake in hadronization and since no multiparton interactions are included in DIS events, no colour reconnection model is employed. At present, no DIS data has been used in the tuning of the hadronization model. The study of spin polarizations and the higher-dimensional structure of the hadron are typically important aspects of DIS analysis. In this context, it should be noted that the PYTHIA 8.3 hadronization model does not by default consider polarization, though external tools to model such effects have been proposed [263]."
        },
        {
            "heading": "6.7 Photon-hadron and photon-photon collisions",
            "text": "The possibility to turn a charged lepton into a photon using laser back scattering has been studied, but has not been realized in the current or foreseen colliders. Thus photon-induced collisions are usually studied in colliders with charged beam particles that may emit photons when accelerated to high energies. The shape of the photon flux and the virtuality spectra are, however, different for different beam types but, given an appropriate flux, the photon-induced processes can be treated in a single framework regardless of the original beam configuration. Here we focus on low-virtuality (quasi-real) photons and introduce the current simulation framework in PYTHIA 8.3 for processes involving such effective beams."
        },
        {
            "heading": "6.7.1 Parton distribution functions of resolved photons",
            "text": "In total there are three separate contributions for processes with low-virtuality photons: a photon can interact either as an unresolved particle, it can split perturbatively into quark-antiquark pair, or it can fluctuate into hadronic state non-perturbatively. The two latter contributions, where the partonic constituents act as initiators for hard scattering, can be described with DGLAP-evolved PDFs. As in the case of hadrons, the evolution equation for resolved photons do include a hadron-like component where a non-perturbative ansatz is evolved according the usual QCD DGLAP kernels. In addition to this, however, the evolution equation contains also a point-like component which feeds in more quark-antiquark pairs with increasing evolution scale that may evolve further by QCD splittings. The full evolution equation for resolved photons is\n\u2202 f \u03b3i (x ,Q 2) \u2202 log(Q2) = \u03b1em(Q2) 2\u03c0 e2i Pi\u03b3(x) + \u03b1s(Q2) 2\u03c0 \u2211\nj\n\u222b 1\nx\ndz z Pi j(z) f \u03b3 j ( x z ,Q2) , (286)\nwhere the \u03b3\u2192 qq splitting kernel in LO is Pi\u03b3(x) = 3(x2+(1\u2212 x)2) and Q2 is the factorization scale at which the partonic structure is probed. As in the case of proton PDFs, the parameters related to the non-perturbative ansatz at the initial scale are determined in a global QCD analysis comparing to experimental data. In PYTHIA 8.3, the default set for the resolved photon PDFs is from the CJKL analysis [264] which conveniently provides the hadron-like and pointlike parts separately, which can be used for finer classification of the events with resolved photons. No dependence on the photon virtuality is included in these PDFs, but all photons are taken as real with zero virtuality, which is the case also for the LO photon-initiated cross sections currently implemented in PYTHIA 8.3."
        },
        {
            "heading": "6.7.2 Photoproduction",
            "text": "Photoproduction typically refers to processes where a beam lepton emits a low-virtuality (quasi-real) photon that then collides with a hadron from the other beam. The following describes some special features of such collisions. These are not unique to ep colliders \u2013 similar processes can take place also in e+e\u2212, pp, pA, and AA collisions as will be discussed in the following.\nPhoton flux and kinematic limits When the emitted photons are quasi-real and almost collinear with the beam leptons, the cross section calculations can be simplified by factorizing the photon flux from the hard perturbatively calculated part. In case of lepton beams, the flux of quasi-real photons can be obtained from the well-known Weizs\u00e4cker\u2013Williams [265, 266] or Equivalent Photon Approximation (EPA). The flux differential in photon virtuality Q2 is\nf l\u03b3 (x\u03b3,Q 2) = \u03b1em 2\u03c0\ndQ2 Q2 1+ (1\u2212 x\u03b3)2 x\u03b3 , (287)\nwhere x\u03b3 is the momentum fraction carried by the (almost) collinear photon with respect to the parent lepton. Integration from the minimum allowed virtuality yields the photon-in-lepton PDF in eq. (282). In photoproduction, the upper limit Q2max is typically of the order 1 GeV\n2, depending on the considered experimental setup and detector acceptance. The lower limit is restricted by the requirement of physical kinematics (on-shell leptons) for the 1\u2192 2 splitting and depends on x\u03b3, the mass of the lepton, ml , and the energy of the beam in the CM frame, E\nQ2min(x\u03b3) = 2m2l x 2 \u03b3\n1\u2212 x\u03b3 \u2212m2l /E2 + q 1\u2212m2l /E2 q (1\u2212 x\u03b3)2 \u2212m2l /E2 \u2248\nm2l x 2 \u03b3 1\u2212 x\u03b3 . (288)\nFrom a similar consideration, one can find the kinematically allowed upper limit for x\u03b3\nxmax\u03b3 = 2\n1\u2212 Q 2 max 4E2 \u2212 m2l E2\n1+ s 1+ 4m2l Q2max 1\u2212 m2l E2\n, (289)\nwhich typically is very close to unity. The lower limit of x\u03b3 can be derived from the minimum considered W of the photon-hadron system. Similarly, as for hadron-hadron collisions, this should be large enough to justify the perturbative treatment that PYTHIA is largely based on. After the values for x\u03b3 and Q\n2 have been sampled from the allowed phase space, the full kinematics for the intermediate photon can be derived. The transverse and longitudinal\nmomentum, q\u22a5 and qz as shown in fig. 12, can be calculated from\nq\u22a5 =\n\u221a \u221a \u221a \u221a \u221a 1\u2212 x\u03b3 \u2212 Q2 4E2 Q2 \u2212 x2\u03b3 + Q2 E2 m2l\n1\u2212 m2l E2\n, (290)\nqz = E(x\u03b3 +\nQ2\n2E2 ) r\n1\u2212 m2l E2\n. (291)\nThe azimuthal angle is sampled from a flat distribution and the scattered lepton four-momentum can be obtained simply from k\u2032 = k \u2212 q. It is also possible to provide the photon flux externally in PYTHIA 8.3, but the sampling has been optimized for the form in eq. (287). The kinematics and the allowed phase-space region are independent from the applied flux.\nDirect and resolved photons If the (quasi-)real photon is the initiator of the hard scattering, i.e. an unresolved (or direct) photon, the photon flux acts essentially as a PDF and can be directly applied for sampling of the process kinematics. If the photon has fluctuated into a hadronic state, for which the partonic structure is given by the resolved photon PDFs described above, these PDFs have to be convoluted with the flux to define so-called parton-in-photon-inlepton PDFs\nf \u03b3i (x ,Q 2) =\n\u222b 1\nx\ndx\u03b3 x\u03b3 f p\u03b3 (x\u03b3) f \u03b3 i (x/x\u03b3,Q 2) , (292)\nwhere the photon virtuality has been integrated out and Q2 refers to the factorization scale at which the resolved photon is probed. Here, it is also assumed that the PDFs are independent of the photon virtuality, though alternatives containing such information exist, see e.g. [267]. The flux is also used to sample the intermediate photon kinematics required to reconstruct the full event including the remnants of the resolved photon and the kinematics of the scattered lepton. In PYTHIA 8.3 both of these contributions, direct and resolved, are included and can be generated simultaneously to obtain the correct mixture of the possible contributions for a given process at considered kinematics.\nISR with photon beams For direct photons, no ISR splittings have been implemented as in these cases the effect from additional QED emissions is typically small. For the resolved photons, however, some additional care needs to be taken when generating ISR due to the extra term in the PDF evolution, see eq. (286), compared to purely hadronic beam particles. As this term feeds in quark-antiquark pairs when evolving forwards with DGLAP, in backwards evolution, relevant for the ISR, this will collapse partons back into the original unresolved photon as illustrated in fig. 13. If such splittings are found during the PS evolution, one can think of these processes being of point-like origin and if not, the partons have originated from the hadron-like part of the PDFs. This dynamical selection of these two contributions have\nthen further implications for beam remnants and MPIs as discussed below. This is also one of the key differences between the old PYTHIA 6 implementation where such selection was done already when sampling the hard scattering, and no MPIs were allowed for the point-like contribution at any scale.\nMPIs with resolved photons Similarly as with resolved hadron beams, the resolved photons may also experience several partonic interactions in each collision. These MPIs are modelled in the same way as for hadrons as described in section 6.2, but some aspects require further attention. The first one follows from the ISR generation discussed above. If the photon has collapsed back to an unresolved state, it can not have further MPIs below the scale at which this splitting has occurred, in fig. 13 this scale is denoted with Qs. Such an ordering is possible thanks to the interleaved evolution of PS and MPIs, see eq. (271). Another potential difference is related to the screening parameter in semi-hard cross sections from which the MPI probabilities are calculated from. Since the partonic and spatial structure of resolved photons are quite different compared to protons, it would be expected that the value of this parameter should be separately tuned for collisions involving resolved photons. Indeed, first comparisons to HERA data [268] indicate that a somewhat larger screening parameter yielding a lower MPI probability is preferred but the constraints are still rather sparse and would benefit from further measurements of low-p\u22a5 hadron production. Also, the impact-parameter profile could be modified but this would require more experimental data sensitive to MPIs.\nRemnants Since the PDFs for resolved photons contain both a hadron- and a point-like part, the remnant construction also needs to be adjusted to handle both cases. The main difference to a purely hadronic state is that since the point-like contribution is of a perturbative nature, the collapse back to a pure photon state should also be handled perturbatively, namely with the parton showers. Unlike in PYTHIA 6 the distinction into a point-like and hadron-like part is not done when the (semi-)hard scattering is selected, but the term corresponding to \u03b3\u2192 qq\u0304 splitting in ISR algorithm will select the cases where the initiator has originated from a perturbative photon splitting. In cases where there are no MPIs in the event, ending up in such a configuration means that there is no need to add any non-perturbative remnants, as the necessary partons have been added perturbatively by the parton shower as illustrated in fig. 13. If the ISR generation will not end in a \u03b3 \u2192 qq\u0304 splitting, the resolved photon is taken to be hadron-like, and the remnants will be constructed similarly as for any hadrons. In this case, the valence flavour is sampled based on relative weights derived from the PDFs. The remnant construction becomes more complicated if the initiator is found to be of a point-like origin but the beam photon has encountered additional MPIs before (at scale Q2 >Q2s ) the resolved state is collapsed into an unresolved one. Then there are several initiators kicked out from the beam, so a single companion cannot make the beam configuration flavour and colour neutral.\nIn this case the remnant is again constructed as for any hadron, but the primordial k\u22a5 for the initiator of the hardest process and its companion are derived from the scale Q2s at which the \u03b3\u2192 qq\u0304 branching collapsing the photon to an unresolved state has occurred.\nHard processes and diffraction The hard diffraction with dynamical rapidity-gap survival model introduced in section 6.4.3 has been implemented also for photoproduction. For direct photons, the no-MPI requirement has zero effect since there are no MPIs with unresolved photons. However, as MPIs can still occur with resolved photons, some suppression is expected also for hard-parton initiated processes. Indeed, there are indications that diffractive dijet photoproduction cross sections are suppressed compared to pQCD predictions based on diffractive PDFs for the target proton. The observed suppression factor depends on the applied kinematic cuts and varies between 0.5\u20130.9 in different analyses [269, 270]. The milder suppression compared to hadron-hadron collisions at the Tevatron and LHC is explained by the presence of the direct component and the smaller invariant mass of the photon-proton system at HERA kinematics which both reduce MPI probability compared to hadronic collisions at higher energies. As demonstrated in [271], the MPI-based model in PYTHIA 8.3 provides a reasonable description for the various HERA data.\nSoft QCD processes Apart from the non-diffractive low-p\u22a5 2\u2192 2 scatterings that are generated with the regulated cross section from the MPI framework using photon PDFs, the soft processes with real photons are modelled according to the vector meson dominance (VMD) model. In this model the photon is described as a linear combination of different vectormeson states with prefactors derived from experimental data. In PYTHIA 8.3, the values are taken from the analysis presented in [272] that have also been used in an SaS fit [207] for total and elastic cross sections applied here. The included vector meson states are \u03c10, \u03c9, \u03c60, and J/\u03c8 but \u03a5 is currently neglected. In the VMD model for elastic and diffractive processes, the incoming photon will first transform into a vector-meson state sampled according to relative weights. Then, the interaction is handled similarly as for any other hadron-hadron case described in section 6.1.5. The elastic scattering process in photoproduction is often referred to as exclusive vector-meson production for which there are nowadays a good amount of data from HERA experiments, see e.g. [273\u2013279]. The SaS parameterization tends to provide a good description for low-mass vector-meson production, e.g. in case of \u03c10, but underestimates higher-mass states such as the J/\u03c8 by a large margin. This indicates the need for further, possibly pQCD based, modelling for high-scale elastic processes."
        },
        {
            "heading": "6.7.3 Photon-photon collisions",
            "text": "Similarly as photoproduction in ep collisions, the charged-lepton beams in e+e\u2212collisions may emit photons that can interact with each other leading to effective photon-photon collisions. If both of the photons have a low virtuality, there are a number of possible combinations that must be accounted for. In the most complex case, where both photons are resolved, the collisions are generated in a similar manner as in hadron-hadron collisions, including parton showers for the initial and final state, beam remnants, and, in particular, MPIs with the same special features as with photoproduction as discussed earlier. If one photon is unresolved and other resolved, the interactions are somewhat simpler, since the unresolved photon scatters off a parton from a resolved photon. In this case, no MPIs can take place and ISR and beam remnants are generated only for the hadron side. Both photons can also interact as unresolved particles when all particles are produced from the outgoing particles through FSR and hadronization, which are relevant also for other possible contributions.\nKinematics The initial phase-space sampling assumes that the incoming photons are collinear with respect to the beam particles. However, as kinematically allowed photons emitted from massive (on-shell) particles will always have a finite virtuality, they will also possess some transverse momentum given by eq. (290). The direction of this q\u22a5 is not a priori known and is sampled only after the hard process kinematics are determined. Thus the final invariant mass of the photon-photon system, W\u03b3\u03b3, will depend on the virtualities of the photons and their relative azimuthal angle, \u2206\u03c6 = \u03c61\u2212\u03c62. The resulting W can again be derived from the kinematics, giving\nW 2\u03b3\u03b3 = 2E1E2 x\u03b31 x\u03b32 \u2212Q 2 1 \u2212Q 2 2 + 2qz1qz2 \u2212 2q\u22a51q\u22a52 cos(\u2206\u03c6) , (293)\nwhere x i are the momentum fractions of the photons with respect to the beam leptons whose CM energies are Ei . To account for the possibly modified W\n2 (= s\u0302 for the direct-direct case), the cross section and relevant kinematic variables are recalculated after the virtualities and the direction of the photons are sampled. Typically the changes in the cross section and kinematics are negligible, but are needed in order to preserve the four-momentum of the event. An exception is, however, 2 \u2192 1 processes where it is important to keep the mass of the intermediate particle intact, a prime example being Higgs-boson production, where the photon momentum fractions are modified instead.\nPossible final states There are many topics that can be studied in photon-photon collisions and the relative importance of direct and resolved contributions varies by the process and considered kinematics. For example, Higgs production in \u03b3\u03b3 collisions is dominated by the direct-direct contribution but for QCD processes, such as jets or heavy quarks that contribute to the background of Higgs studies, the resolved photons may also have a significant contribution. Another interesting phenomenon is the MPIs in a photon-photon system which can be studied with low-p\u22a5 hadrons that arise almost completely from resolved-resolved interactions. Also QED processes, such as dilepton production, can be considered to calibrate the photon fluxes as they are not sensitive to QCD effects."
        },
        {
            "heading": "6.7.4 Ultra-peripheral collisions",
            "text": "As briefly mentioned earlier, other charged beam particles, including protons and heavy nuclei, may also emit photons that interact with the other beam or photons emitted by the other beam. When the beam particles do not interact hadronically but stay intact and emit photons that give rise to a hard interaction, the events are referred to as Ultra\u2013Peripheral Collisions (UPCs). Due to the requirement of beam particles with finite size not breaking up, the emitted photons have always a small virtuality and can therefore be handled with the photoproduction framework introduced above. The photon-induced processes where the beam hadron break ups can be simulated by using a PDF set that includes perturbatively generated photons from DGLAP evolution with the usual PYTHIA model for hadron-hadron collisions.\nThe key difference between photon fluxes from hadrons and charged leptons is that the finite size of the emitting particle needs to be accounted for. For protons, a good approximation is obtained with the electric dipole form factor, giving a Q2-differential flux of the form\nf p\u03b3 (x\u03b3,Q 2) = \u03b1em 2\u03c0\n1+ (1\u2212 x\u03b3)2\nx\u03b3\ndQ2\nQ2 1\n(1+Q2/Q20)4 , (294)\nwhere Q20 = 0.71 GeV 2. Integrating over the possible virtualities will provide the flux derived in [280]. Another flux has been implemented for protons that is based on work by Budnev et al. (see [281]). The downside in the latter is that since only a virtuality-integrated form is\nprovided, there is not enough information to sample the full kinematics of the intermediate photon and the virtuality sampling needs to be turned off. Therefore, this flux is not suited to study observables sensitive to the transverse momentum of the intermediate photon as the q\u22a5 is set to zero.\nFor heavy nuclei, it is possible to use form factors and derive the photon flux in a similar manner as for protons. Usually it is more convenient to work in the impact-parameter space since the heavy nuclei have a well-defined size and therefore it is possible to remove events where hadronic interactions dominate the particle production by rejecting events with small impact parameter. As shown in [282], it is possible to derive an analytic form for the flux differential in the impact parameter by assuming a point-like charge distribution. In fact, this provides a good approximation for the flux with a more realistic density profile when considering the region outside of the nucleus relevant for UPCs. Integrating this from the minimum allowed impact-parameter value bmin gives\nf A\u03b3 (x\u03b3) = \u03b1emZ\n2\n\u03c0 x\u03b3\n2\u03beK1(\u03be)K0(\u03be)\u2212 \u03be2 K21 (\u03be)\u2212 K 2 0 (\u03be) , (295)\nwhere Z is the electric charge (number of protons) of the nuclei A, \u03be = bmin x\u03b3mN . As the nuclear beams are typically defined in terms of per-nucleon energy, mN here also refers to average nucleon mass. A suitable value for bmin is given by the sum of the radii of the colliding nuclei. Such a flux is included in PYTHIA 8.3 but can only be enabled by providing this as a pointer to the Pythia object with a dedicated method. The shape and magnitude of this flux is very different from the flux for charged leptons, and therefore the phase-space sampling must be re-optimized for efficient event generation. A suitable over-estimate is included, but the parameters may have to be re-adjusted for different beam configurations. When using this flux, the virtuality sampling has to be disabled since the allowed virtualities have been essentially integrated over when converting to impact-parameter space by Fourier transform from the momentum space.\nThe current framework can already be applied to many processes studied in UPCs but have a few limitations as well. In proton-proton collisions it is possible to study both photon-photon and photon-proton collisions with fully reconstructed kinematics, when a Q2-dependent flux is used. This includes all hard processes initiated by photons or partons and also soft QCD processes apart from central- and double-diffractive events. These allows for the study of minimum-bias photon-proton collisions, inclusive and diffractive jet production, and photoninitiated dilepton production with all different contributions, to name a few. In case of heavy ions, the palette is somewhat more limited due to a Q2-independent photon flux and lack of model for photon-nucleus collisions, which will be addressed in future releases. In pA collisions, where the flux from the heavy nucleus is amplified by the Z2 factor so that \u03b3p component dominates the cross sections, almost all the same final states can be studied as in proton-proton collisions apart from observables highly sensitive to transverse momentum of the intermediate photon. For QCD observables, the effect from neglected Q2 dependence will be washed out by the QCD radiation. In AA collisions subsequent photon-nucleon interactions are not modelled, but high-p\u22a5 observables and direct-photon dominated processes can be generated with reasonable accuracy. Photon-photon interactions can also be considered, with the only limitation being the neglected Q2 dependence in the kinematics that again has an effect for the q\u22a5-dependent observables, e.g. the acoplanarity of dilepton pairs produced by two direct photons."
        },
        {
            "heading": "6.8 Heavy ion collisions",
            "text": "The Heavy Ion (HI) collider physics community has traditionally not had very close ties to the rest of the High\u2013Energy Physics (HEP) community. This has also been reflected in the event\ngenerator community, where the authors of HI event generators, although they some times make use of e.g. the string fragmentation in PYTHIA, did not interact much with the authors of the main general purpose event generators for pp, ep, and e+e\u2212collisions. However, with the arrival of the LHC, the situation has changed. Not only are HI and particle physicists now part of the same collaborations, the physics questions being asked are also starting to converge, and typical observables studied in HI collisions are being applied to pp, and vice versa. It should therefore not come as a surprise that PYTHIA 8.3 now also has some HI functionality implemented.\nThere are several ways to study HI collisions in PYTHIA 8.3. In section 6.7.4 we described how to study ultra-peripheral HI collisions, and there is also the possibility to use nuclear PDFs to study some observables. Here, we will concentrate on the modelling of complete exclusive hadronic final states using the so-called ANGANTYR model [283], which is the default way of handling HI collisions in PYTHIA 8.3."
        },
        {
            "heading": "6.8.1 Wounded nucleons",
            "text": "The ANGANTYR model in PYTHIA 8.3 can be said to be the successor of the old FRITIOF program [284] which used string fragmentation to generate final states in HI collisions, and was based on the so-called wounded nucleon model [285]. The basic assumption in the wounded nucleon model is that each nucleon that participates in a HI collisions contributes to the multiplicity of the full final state, according to a multiplicity function W (y) which has a triangular form in rapidity\nW (y)\u221d 1 2 1+ y\nymax\n, (296)\nwhere ymax is the rapidity of the nucleon in the collision rest frame. This would yield the following simple form of the rapidity distribution in an AA, for a given number of wounded nucleons (or participants), Npart,p, Npart,t in the projectile and target nuclei respectively,\nN(y) = Npart,pW (y) + Npart,tW (\u2212y) . (297)\nFRITIOF, in its simplest form, used the fact that the distribution of particles of a hadronizing string is flat in rapidity. For each wounded nucleon, a string was stretched out to an endpoint randomly positioned uniformly in rapidity, which then on average reproduces the form in eq. (296). Despite the simplistic nature of the model, FRITIOF was able to provide a fairly good description of collider data at the energies available in the 1980s. In fact, even pp collisions (with Npart,p = Npart,t = 1) were reasonably described.\nWith the energies achievable at RHIC and LHC, the basically non-perturbative FRITIOF model falls short of reproducing data, and the ANGANTYR model was developed to address these shortcomings."
        },
        {
            "heading": "6.8.2 The ANGANTYR model",
            "text": "In comparison to FRITIOF, the ANGANTYR model introduces two major new ingredients. First, rather than wounded nucleons only resulting in a string stretched out and being hadronized, a full diffractive excitation is generated using the full multiparton interaction machinery of PYTHIA where these are described in terms of a pomeron-proton collision. In addition, a more advanced version of the Glauber simulation is used where special attention is given to the fluctuations in the nucleon wave functions, making it possible to differentiate between different types of Nucleon\u2013Nucleon (NN) subcollisions.\nStarting with the new Glauber modelling, we rely on the Good\u2013Walker formalism [206] to connect the different types of NN semi-inclusive cross sections with fluctuations in the wave functions [286].\nFor a projectile particle with an internal substructure, the elastic scattering eigenstates may differ from the mass eigenstates. In the following we denote the eigenstates of the scattering amplitude T , with T\u03a6l = t l\u03a6l , and the mass eigenstates \u03a8i . The ground state (e.g. a nucleon) is denoted \u03a80.\nThe mass eigenstates can be written as linear combinations of the scattering eigenstates, \u03a8i = \u2211\nl cil\u03a6l , and a scattering is treated as a measurement, where one of the eigenvalues, t l , is chosen with probability |c0l |2.\nThe elastic amplitude for a ground state projectile is directly written as \u2329\u03a80|T |\u03a80\u232a= \u2211 l |c0l | 2 t l \u2261 \u2329T \u232a. The resulting \u2329T \u232a is then the expectation value of the amplitude T for the projectile. The elastic cross section then becomes\nd\u03c3el/d 2 b = \u2329T (b)\u232a2 . (298)\nIn impact-parameter space, the amplitude depends on b, and the total diffractive-scattering cross section, \u03c3diff, can be written as the sum of transitions to all \u03a6l :\nd\u03c3diff/d 2 b =\n\u2211\nl\n\u2329\u03a80|T |\u03a6l\u232a\u2329\u03a6l |T |\u03a80\u232a= \u2329\u03a80|T2|\u03a80\u232a , (299)\nsince \u03a6l form a complete set of eigenstates. The cross section for diffractive excitation only, can then be obtained by subtracting the elastic cross section from the above result. It directly becomes the fluctuations in the scattering amplitude:\nd\u03c3diff\u2212tot/d 2 b = \u2329T2\u232a \u2212 \u2329T \u232a2 . (300)\nIf both projectile and target are in flux, this leads to a number of options. This is the case for NN collisions. One can have single-diffractive excitation of the projectile (denoted subscript Dp) or the target (denoted subscript Dt), as well as both, i.e. double diffraction (denoted subscript DD). With elastic scattering (denoted subscript el), the remaining cross section is then the absorptive or inelastic non-diffractive cross section (denoted subscript abs). Denoting averages over projectile and target states by\u2329\u00b7 \u00b7 \u00b7\u232ap and \u2329\u00b7 \u00b7 \u00b7\u232at respectively, all the semi-inclusive different NN cross sections can be written as,\nd\u03c3tot/d 2 b = \u23292T (b)\u232ap,t , d\u03c3abs/d 2 b = 2T (b)\u2212 T2(b) p,t ,\nd\u03c3el/d 2 b = \u2329T (b)\u232a2p,t ,\nd\u03c3Dt/d 2 b =\n\u00ac \u2329T (b)\u232a2p \u00b6 t \u2212 \u2329T (b)\u232a2p,t ,\nd\u03c3Dp/d 2 b = \u2329T (b)\u232a2t p \u2212 \u2329T (b)\u232a 2 p,t ,\nd\u03c3DD/d 2 b = T2(b) p,t \u2212 \u00ac \u2329T (b)\u232a2p \u00b6 t \u2212 \u2329T (b)\u232a2t p + \u2329T (b)\u232a 2 p,t . (301)\nWe note that the diffractive excitation is directly related to fluctuations in the nucleon wave function.\nIn ANGANTYR, we use these cross sections in the Glauber modelling to determine not only which nucleons have been wounded, but also to differentiate if they were non-diffractively scattered or only diffractively excited. The fluctuations are by default modelled using a varying radius of the nucleons, according to a Gamma function,\nP(r) = rk\u22121e\u2212r/r0\n\u0393 (k)rk0 , (302)\nand in addition, introducing a varying opacity of the elastic amplitude, which depends on the radii of the projectile and target nucleons, rp and rt ,\nT (b, rp, rt) = T0(rp + rt)\u0398\n\u221a \u221a \u221a (rp + rt)2\n2T0(rp + rt) \u2212 b\n!\n, (303)\nwhere T0(rp + rt) = 1\u2212 exp \u2212\u03c0(rp + rt)2/\u03c3t \u03b1 . (304)\nWe then obtain the differential semi-inclusive cross sections in eq. (301) using \u2329\u00b7 \u00b7 \u00b7\u232ai = \u222b dri P(ri)(\u00b7 \u00b7 \u00b7 ), which gives e.g.\n\u00ac \u2329T (b)\u232a2p \u00b6 t =\n\u222b\nP(rt)\n\u222b\nP(rp)T (b, rp, rt)drp\n2\ndrt . (305)\nThree parameters (k, r0 and \u03c3t) depend on the NN collision energy, and need to be determined. By default this is done in the ANGANTYR initialization by fitting the integrated total and semi-inclusive NN cross sections to the parameterization in PYTHIA 8.3 (see section 6.1), using a simple genetic algorithm. If needed, the parameters can be specified by the user to avoid the somewhat time-consuming fitting procedure.\nThe Glauber calculation works as follows. First the 3D positions of the nucleons in the nuclei are modelled using a Woods\u2013Saxon parameterization (by default the parameterizations with a hard core from [287, 288] is used). Then, an impact parameter between the nuclei is generated according to a user-specified importance sampling (by default a 2D Gaussian). For each nucleon we then sample the wave function according to eq. (302). This gives us the probability that a projectile nucleon, i, scatters non-diffractively with target nucleon, j, as\n2T (b, ri , r j)\u2212 T2(bi j , ri , r j) , (306)\nwhere bi j is the impact parameter between the nucleons. But, we also want to obtain the probability of diffractive excitation, which involves the fluctuations. We do this by generating an additional radius, r \u2032, for each nucleon, thus sampling the fluctuations. In this way we obtain four statistically equivalent NN collisions and we can ensure that on the average we obtain the correct integrated non-diffractive and diffractive excitation cross sections, by shuffling the probabilities between the four combinations so for each the probability never exceeds unity, as explained in [283]. It should be noted that this trick does not allow us to determine the correct amount of elastic scattering, but these scattering are of less importance in a Glauber calculation.\nIn the end of the Glauber modelling, we have a long list of all potential NN subcollisions with an assigned type of interaction. These will now tell us how many, and of which kind of NN events we will generate using the normal pp minimum-bias framework in PYTHIA 8.3, to be merged together into a full HI collision event. The way this is done is as follows.\n\u2022 Order all non-diffractive subcollisions in the NN impact parameter, bi j , and iterate with increasing bi j .\n\u2022 If none of the nucleons has been involved in a non-diffractive subcollision with smaller bi j , generate a (primary) non-diffractive subevent.\n\u2022 If one of the nucleons has been involved in a previous subevent, generate a singlediffraction NN event corresponding to the diffractive excitation of the other nucleon (using a special modification as explained in [283]) and merge this with the corresponding previous subevent.\n\u2022 If both of the nucleons are already in a generated subevent, do nothing.\nWhen we merge a single diffraction subevent, we only add the diffractively excited subsystem, removing the elastically scattered nucleon. We also take some longitudinal momentum from the remnants of the primary event to ensure momentum-energy conservation.\nIn a similar way, we go through all double- and single-diffractive subcollisions, and add these to the full HI event. In the end, we take all non-interacting nucleons and collect them into projectile and target nucleus remnants, which each end up as a single entry in the event record with PDG-ID codes of the form 100ZZZAAA9, depending on the number of neutrons and protons, which in the PDG standard corresponds to a highly-excited nucleus.\nIt should be noted that all subevents above are generated on the parton level, which allows us to hadronize them together. This enables us the option to perform string shoving and rope formation (see sections 7.3.1 and 7.3.2) on the full HI partonic state.\nThe main use of the ANGANTYR model is to generate minimum-bias events. It is however, also possible to generate specific hard processes in HI events. If a hard process is specified by the user, the Glauber modelling will proceed as before, but (at least) one of the non-diffractive primary NN events will be replaced by a specific hard interaction event, and at the same the event will be reweighted by a factor given by\nNND\u03c3hard/\u03c3ND , (307)\nwhere NND is the number of non-diffractive subcollisions. Note that for the specified hard processes, ANGANTYR treats pp, pn, np, and nn subcollisions separately, which is not the case for the minimum bias, where isospin symmetry is assumed.\nBy default, PYTHIA 8.3 will automatically initialize the ANGANTYR machinery as soon as one of the beams is specified to be a nucleus (using the PDG ID of the form 100ZZZAAAI, where I indicates the excitation level). It is possible to use the ANGANTYR machinery also for minimum-bias pp collisions, by setting HeavyIon:mode = 2.\nFinally, it should be noted that only the most commonly used nuclei are defined by default in PYTHIA 8.3, but a user can easily define further nuclei. Note also that the beam energy of a nucleus is specified by giving the energy per nucleon, following the convention of the field."
        },
        {
            "heading": "7 Hadronization",
            "text": "Hadronization (often also referred to as fragmentation) is the process of turning the final outgoing, coloured partons into colourless hadrons. This transition is non-perturbative, and must be handled by models. In PYTHIA it is based on the Lund string model [289,290], which is also historically the core of the JETSET/PYTHIA programs. Even though the core methods for string hadronization are identical to previous versions of PYTHIA, the past years have seen significant activity in the area of fragmentation dynamics, guided by the discovery of heavyion-like effects in hadronic collisions. In PYTHIA, these efforts have culminated in a multitude of models modifying the original Lund strings in the presence of other strings in an event."
        },
        {
            "heading": "7.1 The Lund String model",
            "text": "Results from lattice QCD support viewing the confining force field between a colour and an anti-colour charge, such as a qq pair, as a flux tube with potential energy increasing linearly with the distance between the charge and the anti-charge. As the partons move apart, energy is transferred from the partons at the ends of the string to the string itself, by \u03ba \u2248 1 GeV/fm.\n1\nThis directly gives rise to the so-called \u201cyoyo\u201d modes of single qq dipoles in 1+1 dimensions7, as illustrated in fig. 14 (a). In the figure, an evolution starts at time t = 0, where all the energy is stored in the ends, and none in the string,\n(E, px)qq = 1 2 ( p s,\u00b1 p s), Estring = 0 . (308)\nThe string reaches its maximal extension at time t = p\ns/2\u03ba. Here, all energy has been transferred from the end-points to the string:\n(E, px)qq = (0, 0) , Estring = p s . (309)\nAt time t = p\ns/\u03ba, the string ends are back at their starting point, but with their momenta swapped compared to eq. (308), and finally at t = 2 p s/\u03ba, the string has been through a full period. In the string picture, yoyo modes like this are identified as mesons, with flavour determined by their quark content (see section 7.1.1). Longer strings will break into hadrons, with new qq pairs breaking up the original string. Aligning the string axis of the original string with the x axis, this process is depicted in fig. 14 (b). The qq pairs are produced around a hyperbola, and joins together to form the hadrons, depicted as arrows. A hadron produced on the string is then characterized by two adjacent vertices (i and i \u2212 1), with space-time coordinates (x and t) correlated through the hadron mass (m):\nm2i /\u03ba 2 = (x i \u2212 x i\u22121)2 \u2212 (t i \u2212 t i\u22121)2 . (310)\nIn general, a string will break into a state with n hadrons, which in the model is given by the probability [291]:\ndP\u221d n \u220f\ni=1\nNd2pi\u03b4(p 2 i \u2212m 2)\n\u03b4(2) \u2211\npi \u2212 Ptot exp (\u2212bA) , (311)\n7The following convention for spatial coordinates is used. When discussing the 1+1 dimensional string, x is taken as the spatial coordinate. When we move on to discuss 3+1 dimensional strings, the coordinate z is chosen to be the coordinate along the string axis, as this will often coincide with the coordinate along the beam axis, which is normally denoted z.\nwhere A is the area covered by the string before breakup in units of \u03ba, as shown in fig. 14 (b), and b is a parameter. If the string breaking is imagined as an iterative process, the consistency constraint that the same result should be obtained (on average) by fragmenting from the left or the right, one obtains the distribution of momentum fraction (z) of remaining light-cone momentum taken by each hadron as\nf (z)\u221d (1\u2212 z)a\nz exp\n\u2212 bm2\nz\n, (312)\nwhere a is a new parameter related to N and b in eq. (311). Once transverse momenta are introduced, the substitution m2\u2192 m2\u22a5 is performed, with the \u201ctransverse mass\u201d defined by\nm2\u22a5 = m 2 + p2\u22a5 . (313)\nThe resulting form of eq. (312) is known as the Lund symmetric fragmentation function. This simple picture of a qq system can be extended to topologies including gluons, without introducing new parameters, by viewing the gluon as a kink on the string in the Nc \u2192\u221e limit, with separate colour and anti-colour indices. A string can as such stretch from e.g. the quark end through a number of gluons, and end in the antiquark end [290].\nWhile the default behaviour of PYTHIA is to always use eq. (312) with given values for the parameters a and b, the a parameter can in principle be different for each flavour. This possibility is implemented for s quarks and diquarks. Going from an old flavour i to a new flavour j, the fragmentation function would thus be modified as:\nf (z)\u221d zai\nz 1\u2212 z z a j exp \u2212 bm2\u22a5 z . (314)\nFinally, the Bowler modification [292] done in the Artru\u2013Mennesier model [293] allows for massive endpoint quarks with mass mQ. This modified the symmetric fragmentation function, as the areas swept out by massive endpoint quarks is reduced compared to massless ones. Though using this modification is a break with the Lund-string philosophy, it is available as an option, where an effective a term for a discrete mass spectrum [294] is used:\nf (z)\u221d 1\nz1+rQ bm 2 Q\nza\u03b1 1\u2212 z z a\u03b2 exp \u2212 bm2\u22a5 z . (315)\nA common use case is to enable the Bowler modification for fragmentation for heavy quarks, as it can describe the somewhat harder spectrum better.\nThe derivation of eq. (312) also gives the probability distribution in proper time (\u03c4) of qq breakup vertices, i.e. a quantity that can be interpreted as (input to) a hadron production time. In terms of \u0393 = (\u03ba\u03c4)2 it is: P(\u0393 )d\u0393 \u221d \u0393 a exp(\u2212b\u0393 )d\u0393 . (316) From this distribution it is possible to calculate the average breakup time of a qq string:\n\u2329\u03c42\u232a= 1+ a b\u03ba2 . (317)\nDefault PYTHIA values for a and b give \u2329\u03c42\u232a \u2248 2 fm. The \u0393i values can be defined recursively\n\u0393i = (1\u2212 z) \u0393i\u22121 + m2\u22a5 z , (318)\nwith \u03930 = 0."
        },
        {
            "heading": "7.1.1 Selection of flavour and transverse momentum",
            "text": "In the previous section, the qq pairs in the string breaking were treated as massless and without transverse momenta. If the quark and antiquark has a transverse mass, they can no longer be produced in a single vertex, but must tunnel through a forbidden region of size m\u22a5/\u03ba. The tunnelling probability can be calculated in the WKB approximation, giving [289]:\n1 \u03ba dP d2p\u22a5 \u221d exp(\u2212\u03c0m2\u22a5/\u03ba) = exp(\u2212\u03c0m 2/\u03ba)exp(\u2212\u03c0p2\u22a5/\u03ba) . (319)\nHere m\u22a5 is the transverse mass of the quark, and the factorization of the result allows separation of the generation of m and p\u22a5.\nThe relative production of light quarks of different mass, and thus of different flavour, could in principle be obtained directly by inserting u, d and s quark masses in eq. (319). It is, however, not obvious what quark masses to use. Current quark masses lead to too little strangeness suppression, and constituent quark masses lead to too much. Instead, the suppression is viewed as a free parameter, and tuned to LEP data. The current default s suppression relative to u or d types is 0.217, which does not imply unreasonable effective quark masses in eq. (319). Heavier quark flavours are suppressed too heavily to be produced in string breakings, for any reasonable value of their masses.\nThe generation of p\u22a5 by eq. (319), can be implemented by giving the quark and antiquark Gaussian p\u22a5-kicks with\u03c3\n2 = \u03ba/\u03c0\u2248 (0.25 GeV)2. Fits to data have this number higher, around \u03c3 = 0.35 GeV, implying that a large fraction of the p\u22a5 kick comes from another source, such as soft gluon radiation below the parton shower cutoff.\nBesides production of the normal light-quark species, other hadron types can be produced through the same mechanism with a few modifications. Excited mesons are allowed by letting quarks and antiquarks combine to a total spin of either 0 or 1. Considering only pseudoscalar and vector multiplets, the expectation of the relative rate is 1 : 3, while data \u2013 at least in the case of \u03c0 : \u03c1 \u2013 prefers a ratio about 1. This difference between prediction and data can be explained as a result of differences in the hadronic wave function [295, 296], but this comes at the expense of many free parameters, which have to be tuned to data. Baryons can be produced using eq. (319) as well, by allowing diquark-antidiquark string breakings [297]. Compared to the production of s quarks, this process will be suppressed by a larger (effective) diquark mass. In such an approach, the produced baryon-antibaryon pair will be neighbours along the string, and share two flavours. This simple picture is modified by considering an underlying step-wise mechanism for baryon production, first suggested by Casher, Neuberger and Nussinov [298], and realized in the \u201cpopcorn\u201d model [299] in PYTHIA. In the popcorn model, diquarks are generated by first producing a qq pair as a vacuum fluctuation on the string, without breaking it. By producing more new qq pairs in between, meson production between the baryon-antibaryon pair is allowed. The whole process is illustrated in fig. 15. In principle, several mesons can be produced in between a baryon-antibaryon pair through the popcorn mechanism, but currently only the simplest case of a single meson is implemented in PYTHIA.\nWhile this explanation above suffices for an introduction of the physics behind the model, there are many important implementation details to be faced when going from a \u201cphysics level\u201d description of the Lund string to the actual implementation in PYTHIA, which must be able to handle arbitrarily complicated configurations of partons. In the next subsections we outline several of the more specialized features in PYTHIA string fragmentation, and the thought behind the implementation. While some are completely new models on top of the old hadronization framework, others remain the same as even the oldest version of the JETSET and PYTHIA 6.3 programs . Those specific parts of the discussion are therefore largely carried over from the PYTHIA 6.4 manual [14]."
        },
        {
            "heading": "7.1.2 Joining two jets in qq events",
            "text": "Keeping with the simple picture of a single qq pair, the iterative procedure obtained by successive application of eq. (312), is only valid when the remaining mass of the system, after fragmenting off a hadron, is large. If the algorithm implementing eq. (312) were to start from one end, and create hadrons successively until the other end is reached, the mass of the last hadron would be fully constrained by four-momentum conservation, and would therefore be off-shell.\nThe practical route taken in PYTHIA, is to randomly fragment off hadrons from either the q or q end in each step, with z taken to be either the positive or negative light-cone momentum respectively. To wit, if the step is on the q side, z is the remaining E + pz fraction, and if the step is on the q side, z is the remaining E\u2212 pz fraction. Once the mass of the remaining system has dropped below a certain value, with some smearing to avoid an unphysical sharp cutoff, the remaining system is fragmented into two \u201cfinal\u201d hadrons, and the chain ends."
        },
        {
            "heading": "7.1.3 Fragmentation of systems with gluons",
            "text": "Most of the preceding discussion has involved the simple system of a single string spanned between a qq pair. While sufficient to explain the basic features of the model and implementation, it is far from covering the complexity in hadronization of multiparton systems. A Lorentz covariant algorithm exists, however, and in this section the machinery employed for this task is outlined, noting that the complete machinery is complicated, and covered in detail in [290,300].\nThe basis of the algorithm is to divide multiparton systems to be fragmented into smaller string pieces, spanned between individual partons. Consider a long string spanned between a qq pair (labelled 1 and n in the following), with a number of gluons in between (labelled 2, ..., n\u2212 1). Such a string will contain n\u2212 1 separate pieces. The kinematics of those pieces are, as for simple qq strings, determined by the four-momenta of the endpoint partons. In the case of gluons, the four-momentum is shared between the two neighbouring string pieces, each taking half. It must furthermore be assumed that endpoint (anti-)quarks are massless, for the fragmentation algorithm to work. In practise this is done by attaching a fictitious string piece with a massless (anti-)quark to the string end, replacing the massive quark. This string piece in a later step becomes part of the massive hadron produced from the massive quark.\nIn summary, we have therefore n\u2212 1 string pieces defined by adjacent8 four-momentum pairs ( j, k), with the parton going towards the q end further indexed with a + and the parton going towards the q end with a \u2212. In general, a hadron is now created by taking a step from a region ( j1, k1) to ( j2, k2). A step may be taken within just a single region, or between two different regions. The resulting hadron four-momentum can be written as\np = j2 \u2211\nj= j1\nx ( j)+ p ( j) + +\nk2 \u2211\nk=k1\nx (k)\u2212 p (k) \u2212 + px1 e\u0302 ( j1k1) x + py1 e\u0302 ( j1k1) y + px2 e\u0302 ( j2k2) x + py2 e\u0302 ( j2k2) y , (320)\nwhere the four-momentum fraction of pi\u00b1 taken by the hadron is denoted x i \u00b1, and (px , py) are the transverse momenta produced at the string breaks according to eq. (319) with (e\u0302x , e\u0302y) spacelike unit four-vectors normal to the string direction in the respective region.\nThe only remaining degree of freedom is z, to be determined by eq. (312). The interpretation of z is, however, only well-defined for a step in the initial string regions. But via eq. (318) a z value can be translated into a new \u0393 = (\u03ba\u03c4)2 value, and \u0393 is well defined across region boundaries. Together with the p2 = m2 constraint on eq. (320) this is sufficient to find the relevant x ( j2)+ and x (k2) \u2212 values of the next breakup vertex."
        },
        {
            "heading": "7.1.4 Hadron vertices",
            "text": "While the production vertices of hadrons are impossible to detect experimentally, calculating them still has applications in other parts of the simulation, most notably hadronic rescattering. In this section we describe the space-time picture for qq pairs, based on methods developed in [301].\nFrom the linear potential V (r) = \u03bar, the equations of motion are\ndpz,q/q dt = dpz,q/q dz = dEq/q dt = dEq/q dz = \u03ba . (321)\nThe sign on each derivative is negative if the distance between the quark is increasing, and positive if the distance is decreasing. After sampling Ehi and phi for each hadron, these equations lead to simple relations between the space-time and momentum-energy pictures, zi\u22121 \u2212 zi = Ehi/\u03ba and t i\u22121 \u2212 t i = phi/\u03ba, where zi and t i denote the space-time coordinates of the ith breakup point (note that zi\u22121 > zi since points are enumerated from right to left). In the massless approximation, the endpoints are given by z0,n = t0,n = \u00b1 p s/2\u03ba. This specifies the breakup points, but there is still some ambiguity as to where the hadron itself is produced. The default in PYTHIA 8.3 is the midpoint between the two breakup points, but it is also possible to specify an early or late production vertex at the point where the light-cones from the two quark-antiquark pairs intersect.\nA complete knowledge of both the space-time and momentum-energy pictures violates the Heisenberg uncertainty principle. This is compensated for in part by introducing smearing factors for the production vertices, but outgoing hadrons are still treated as having a precise location and momentum. Despite not being a perfectly realistic model, there is no clear systematic bias in this procedure, and any inaccuracies associated with this violation are expected to average out.\nThere are several further complications to these process. One is more complicated topologies such as those involving gluons or junctions. Another is the fact that the massless approximation is poor for heavy qq pairs. For massive quarks, rather than moving along their\n8It is possible to have string regions spanned by non-adjacent pairs as well, created when a gluon loses all its energy to the string. These regions form an integral part of the formalism, and help ensure that string fragmentation is rather insensitive to soft and collinear gluon emissions in the parton-shower stage.\nlight-cones, the quarks move along hyperbolas E2\u2212 p2z = m 2+ p2\u22a5 = m 2 \u22a5. Both these issues are addressed in more detail in [301]."
        },
        {
            "heading": "7.1.5 Junction topologies",
            "text": "Junction topologies in their simplest form arise when three massless quarks in a colour-singlet state move out from a common production vertex, a textbook example of which is given by a baryon-number-violating super-symmetric decay \u03c70 \u2192 qqq. In that case it is assumed that each of them pull out a string piece, a \u201cleg\u201d, to give a Y-shaped topology, where the three legs meet in a common vertex, the junction. This junction is the carrier of the baryon number of the system: the fragmentation of the three legs from the quark ends inwards will each result in a remaining quark near to the junction, and these three will form a baryon around it.\nThe junction will be at rest in a frame where the pull of the three legs balance each other, which is when the angle between each quark pair is 120\u25e6. It is therefore convenient to handle the hadronization in such a frame. There is no first-principles description of junction-string fragmentation. Instead the process is split into a few steps, to make use of the existing string machinery in a credible manner [302], illustrated in fig. 16. First, the two lowest-energy legs are considered separately, each as if it were a qq string, with a fictitious q in the opposite direction to the q. All fragmentation is from the q end of the respective system, however, and keeps on going until almost all the original q energy is used up, resulting in the situation illustrated in the left-hand pane of fig. 16. At that stage the remaining unmatched two quarks (qA2 and qB3 in the figure) are combined into a diquark, carrying the unspent energy and momentum. This diquark now forms one end of the remaining string out to the third quark, which can be fragmented as a normal string system, illustrated in the right-hand pane of fig. 16. One criterion that the procedure works, e.g. that the fragmentation of the two first legs is\nstopped at about the right remaining energy, is that the junction baryon is formed with a low momentum and with minimal directional bias in the junction rest frame. Additional checks are also made to ensure that the final string mass is above the threshold for string fragmentation. Otherwise, repeated attempts are made, starting over with the first two strings.\nUnfortunately real-life applications introduce a number of complications. One such is that the pull is more complicated when the endpoints are not massless. Then, in a fraction of the events, there is no analytic solution. Typically this happens when a massive quark is almost at rest in the configurations that come closest to balance, and an approximate balance along these lines may be obtained. An even more complicated case is when a leg is stretched via a number of intermediate gluons between the junction and the endpoint quark, as would be a natural consequence of parton-shower evolution in the \u03c70 \u2192 qqq decay. Then the initial motion of the junction is set by the gluon nearest to it. But often this gluon has low energy and, once that is lost to the drawn-out string, it is the direction of the next-nearest gluon that sets a new net pull. Thus, there is no frame where the junction remains at rest throughout the whole fragmentation process. An effective average pull is then defined for each of the three legs, as a weighted sum of the respective parton momenta, where the weight drops exponentially as the energy sum of partons closer to the junction increases, cf. [302].\nThe absence of an exact solution for the junction rest frame leads to an approximate iterative procedure being used. One of the more common sources of PYTHIA warnings is that this procedure does not converge. If no fix can be found any other way, then ultimately the centre-of-mass frame of the system is taken as the junction rest frame.\nJunction fragmentation is not only a topic for exotic physics, but very much part of ordinary QCD hadronic physics. It appears if two valence quarks are kicked out of a baryon beam by the MPI machinery. Since these interactions typically involve colour exchange, two of the ends will stretch to partons from the other incoming beam, unless colour reconnection gives another result. The fragmentation follows the already outlined procedure, which can lead to the beam baryon number being transported in to the central region of the event, cf. [248].\nAlso antijunctions may exist, where the colour lines from three antiquarks meet, and such antijunctions carry a negative baryon number. A string system may contain both a junction and an antijunction, or even multiple of such. The simplest such topology is when one leg connects a junction to an antijunction, leaving two other junction legs to quarks and two antijunction legs to antiquarks. It is here assumed that the total string length (see section 7.2) is smaller for such a topology than for having two simple qq strings, or else the junction pair would annihilate to give the simple string topology, cf. [248,302]. Conversely, when the string length can be reduced, more-or-less parallel qq strings may colour reconnect into junctionantijunction systems, see further section 7.2.2.\nTo reduce the complexity of multijunction fragmentation, each system is split up into smaller ones that only contain (at most) one junction or antijunction each. Consider e.g. a junction-antijunction topology. If the leg connecting the two contains at least one gluon, it can be split up by a replacement g\u2192 qq. If not, a small amount of energy can be shuffled from the regular q and q legs into some energy (and momentum) for this connecting leg, so that it can be split.\nAnother subtlety concerns what spin state to choose for the diquark that is formed at the end of the fragmentation of the two first legs, the one labelled qqAB in fig. 16, which we will call the junction diquark. For conventional (non-junction) fragmentation, empirically one finds that S = 1 diquark states are heavily suppressed, interpreted as due to significantly higher masses and smaller binding energies. However, unlike in conventional string breaks, where diquark-antidiquark pairs are formed together in a single coherent tunnelling process (modulo fluctuations such as in the popcorn scenarios), the junction diquark is formed by combining the leftovers from two separate string breaks; PYTHIA 8 therefore allows for the\nS = 1 suppression factor for junction diquarks to be set independently of that for conventional diquarks. Moreover, analogously to in the meson sector, it can be set independently for b-, c-, s-, and light-flavoured junction diquarks, where the label always refers to the heaviest of the two constituents.\nIt is also worth emphasizing that, within the context of the current PYTHIA modelling, junctions represent the sole mechanism for producing baryons containing multiple heavy flavours, such as \u039ecc , \u2126cc , \u2126ccc , and their b-flavoured relatives. Note, however, that this will still be quite rare; since heavy flavours cannot be produced by string breaks, they can only appear as endpoints, say qA0 and qB0 in fig. 16. The only possibility to form a double-heavy-flavoured baryon involving these is if there is too little energy in both legs A and B for any other string breaks to occur, so that qA0 and qB0 are combined directly into the junction diquark, which is then doubly-heavy flavoured. We note that, so far, no dedicated emphasis has been placed on developing the heavy-quark aspects of junction fragmentation, though that may change with experimental interest. Predictions should therefore be regarded as tentative.\nIn summary, the full machinery for junction hadronization is convoluted and not without weaknesses, but overall it serves its purpose, and finds use in several physics contexts."
        },
        {
            "heading": "7.1.6 Small-mass systems",
            "text": "If the invariant mass of the qq system is small, a few complications to the fragmentation process can arise. For example, for an ss system at 0.9 GeV, the string cannot fragment as there is not enough energy to form an outgoing K K pair, nor can the quarks enter a \u201cyoyo motion\u201d as there is no hadron with compatible mass and flavour content. Furthermore, even if the string can fragment, at low energies the available phase space might be so small that the fragmentation algorithm becomes very inefficient. These situations can occur for instance towards the end of a parton shower by g\u2192 qq branchings or during hadronic rescattering, and are handled using approaches inspired by cluster fragmentation [303].\nTo improve the efficiency of the algorithm, the first step is to assume that the string will break at only a single point, and a few attempts are made to find possible outgoing twohadron states. If these attempts fail, next the algorithm tries to form a single hadron from the endpoints, then put that hadron on-shell by transferring momentum to or from a neighbouring string system. If no momentum rearrangement is possible, further attempts are made to find possible two-hadron states, but now only the lightest possible hadrons for the given flavour content are considered. If this still does not work, the string may collapse to the lightest possible hadron given the endpoints, and produce one additional \u03c00. Finally, if this is not possible either, the last resort is to collapse the string to the lightest possible hadron, and transfer momentum with a neighbouring parton or hadron.\nString systems are handled in order of increasing mass relative to the two-body threshold, so normally other systems are still unfragmented when addressing this kind of issue. Especially in (low-energy) hadronic rescattering there may two low-energy strings. Then, when the first string is handled, its collapse may reduce the mass of the other string. In this case, that system may also collapse to a single hadron, which is put on-shell by transferring momentum with a hadron from the previously fragmented string."
        },
        {
            "heading": "7.2 Colour reconnections",
            "text": "In PYTHIA (and other event generators), a simplified set of rules for colour flow is used to determine between which partons confining potentials should arise. In the context of the string model, this determines a unique string topology which sets the stage for the subsequent hadronization.\nSpecifically, all perturbative processes (including MPIs, ISR and FSR) are handled in a leading colour (LC) limit in which the probability for any two random colours to both be the same vanishes. Formally, this is done by taking the limit Nc\u2192\u221e with \u03b1sNc kept fixed [55] so that QCD amplitudes retain their Nc = 3 normalizations. This accomplishes two things: 1) it eliminates colour-interference effects which are suppressed by powers of 1/N2c \u2192 0, and 2) it allows for a particularly simple representation of gluons in colour space, as direct products of a colour and an anticolour, since the weight of the singlet in Nc \u2297 N\u0304c = (N2c \u2212 1)\u2295 1 vanishes as Nc\u2192\u221e.\nIn the LC limit, Feynman-diagram amplitudes in colour space are represented by products of independent \u201ccolour lines\u201d. Each of these expresses conservation of a distinct colour charge, and is represented by a \u03b4i j connection between partons carrying colours i and j (suitably crossed). We call this an LC dipole connection. Due to the orthogonality of the basis states and the lack of interference in this limit, each such line translates directly to a coherent coloursinglet structure at the colour-summed amplitude-squared level, which is confining at large distances. Thus, each LC dipole emerging from the perturbative stages of the event evolution can be uniquely mapped to a string piece (discussed further, e.g. in [53]). We use the term \u201ccolour reconnection\u201d (CR) to refer to any scenario that results in changes relative to this map in defining the starting configuration of hadronizing strings in an event.\nA simple illustration of the map between LC dipoles and string pieces, for an e+e\u2212 \u2192 \u03b3\u2217/Z \u2192 qq\u0304q\u2032q\u0304\u2032g g event, is shown in fig. 17. Matching colour (and anticolour) charges are represented by Les Houches colour (and anticolour) tags [304, 305] numbered from 101\u2013104 in this example and indicated by coloured lines in the diagram. In keeping with the Nc \u2192\u221e nature of the LC limit, the number of different tags is not limited to three, and each new tag is distinct from all others. This produces a unique set of colour connections which can be traced to form the LC string topology (shaded regions).\nIn hadronic collisions, the structure of the beam remnants is also to be modelled, after MPIs have extracted multiple coloured objects from them. Here it is useful define rules on how to equate some of these colours and anticolours with each other, so as to keep the total colour charge of a remnant within reasonable bounds. Note that this would still classify as \u201ccolour connection\u201d, insofar as it is the initial assignment of remnant colours, although the consequences propagate in from the remnants to the central perturbative interactions. This is discussed further in the section on beam remnants, section 6.3. As used in this section, the term CR applies to models that go beyond this, i.e. that allow for departures from the simple colour rules discussed above and/or address ambiguities that are left unresolved by them. CR may be classified as one example of a broader palette of string interactions, with other\nexamples presented in section 7.3. Note that, occasionally, \u201cjunction\u201d structures (see section 7.1.5) may also be present. Unlike dipole-type \u03b4i j connections, junctions (and antijunctions) represent \u03b5i jk structures in colour space; these are explicit Nc = 3 structures which have no analogy in the Nc\u2192\u221e limit. In PYTHIA, they can appear in the initial state in proton beams [248], in hard BSM processes (or decays) with baryon number violation [82, 302], and/or as a product of colour reconnections in the final state (in pairs of junctions and antijunctions to conserve overall baryon number) [249]. Due to the added technical complexity of dealing with junction structures, the latter possibility is, however, so far only invoked by the QCD-based CR model, cf. section 7.2.2.\nSeveral different scenarios are included in PYTHIA, as described in the following subsections, each with its own motivations and underpinnings. The unifying feature is that these models act only by reassigning colours, with no explicit momentum exchanges between the involved partons. The decisions whether and how to reassign still can depend both on momentum-energy and on space-time relations between partons. Also, the changes at the level of produced hadrons still can be dramatic, due to the changed lengths and orientations of the resulting hadronizing strings.\nHistorically, CR was first discussed in the context of charmonium production [306\u2013308], notably in weak B decay to J/\u03c8, e.g. B 0 = bd\u2192W\u2212cd\u2192 sccd\u2192 J/\u03c8K0. In such decays the c and c belong to two separate colour singlets, but ones that overlap in space-time, with the possibility of soft gluon exchange to create the new singlets.\nThe first large-scale application of CR was in the PYTHIA MPI model of hadronic collisions [13], notably to explain the increasing mean transverse momentum \u2329p\u22a5\u232a with increasing charged multiplicity nch observed at CERN\u2019s SppS collider [309]. If all MPIs draw out strings and fragment in the same manner, \u2329p\u22a5\u232a(nch) would be essentially flat. CR was therefore introduced in such a way that the total string length is reduced. Each further MPI then on the average increases nch less than the previous one, while giving the same p\u22a5 from (mini)jet production, resulting in an increasing \u2329p\u22a5\u232a(nch).\nLEP 2 offered a good opportunity to search for CR effects. Specifically, in a process e+e\u2212 \u2192 W+W\u2212 \u2192 q1q2q3q4, CR could lead to the formation of alternative \u201cflipped\u201d singlets q1q4 and q3q2, and correspondingly for more complicated string topologies, formed when parton showers are included. Such CR would be suppressed at the perturbative level, since it would force some W\u00b1 propagators off the mass shell [310]. This suppression would not apply in the soft region. Based on a combination of results from all four LEP collaborations, the noCR null hypothesis is excluded at a 99.5% CL [311]. Within the SK I scenario, described below, the best description is obtained for \u223c50% of the 189 GeV W+W\u2212 events being reconnected, in qualitative agreement with predictions.\nMore recently, Tevatron [312] and LHC [313,314]measurements of the top-quark mass in hadronic top-quark decays brought CR effects on precision observables to the fore again, with several new models geared towards the increased complexity of hadron collisions produced first in PYTHIA 6 [315\u2013317] and later in PYTHIA 8 [249,318]. Hadronic reconstruction of the top-quark mass remains an important impetus for further explorations of CR model space and for the development of systematic and exhaustive ways to constrain modelling ambiguities and parameters experimentally.\nThe importance of colour algebra versus dynamics differs widely between models. Taking the simple W+W\u2212 case above, there is a 1/9 probability that q1q4 and q3q2 are singlets purely by colour algebra. But such accidental singlets do not stop q1q2 and q3q4 from still being singlets as well; so nevertheless, a dynamics principle would be needed to decide which singlet set takes precedence when it is time to hadronize. Furthermore, once parton showers are included, the number of colour charges in an event increases, and the possibilities for CR with it. In the extreme limit, a string may be viewed as a chain of (non-perturbative) gluons\ninfinitesimally closely spaced, such that the string constantly flips colour, so there would be no suppression of CR for lack of nearby matching colours.\nIn several of the models below the concept of a \u201cstring-length\u201d \u03bb plays a prominent dynamics role. It is a measure of how many hadrons of some reference hadronic mass m0 there are room for (in phase space), if the hadrons are evenly spaced in rapidity along the string. For a simple qq string of mass mqq one possible definition is \u03bb= ln(m2qq/m 2 0). In principle, \u03bb is well defined also for more complicated string topologies [291], but in practice its construction is too complicated. Instead, approximate expressions are used, like\n\u03bb\u2248 n \u2211\ni=0\nln 1+ m2i,i+1\nm20\n, m2i,i+1 = (\u03b5i pi + \u03b5i+1pi+1) 2 , \u03b5q = 1 , \u03b5g = 1 2 , (322)\nfor a string q0g1g2 \u00b7 \u00b7 \u00b7gnqn+1, where \u03b5g = 1/2 because gluon momenta are shared between two string pieces. The addition of 1 is to ensure that a low-mass section does not give a negative contribution, and is not always used. More generally, if low masses are common, it probably signals that there is a larger underlying issue, e.g. having too low a cut-off for shower evolution.\nOne may think of \u03bb as the \u201cfree energy\u201d of a string system, available for particle production. More specifically, the classical (Nambu\u2013Goto) string action to be minimized is proportional to the worldsheet area spanned by the string motion. Here, \u03bb is then related to the average area spanned before hadron formation. Therefore, it is often assumed that nature prefers a low string length whenever possible.\nThis principle is significantly violated in the early stages of a collision, however. There the hard interaction and the MPIs turn two incoming beam-hadron states, each with minimal \u03bb, into a combined one of a significantly higher value. Consequently, we discuss here the aftermath, where strings begin to be pulled out and eventually fragment back to hadrons of low \u03bb.\nSimilarly, some general considerations of the space-time picture are necessary. One is that the spatial evolution of showers need not be traced. That is, parton showers occur at time scales sufficiently shorter than hadronization ones so that, to first approximation, all the final partons can be viewed as emerging from a common vertex. Furthermore, while the branching of a low-mass high-energy parton can be significantly displaced, the daughters will tend to be sufficiently close, by any distance measure, such that CR is unlikely to break them apart. Another issue is how the lifetime of intermediate resonances compares with the CR time. The W, Z, and t have intermediate decay time scales, about an order of magnitude shorter than typical hadronization times. (Whereas the H is much more long lived.) But the two would become more comparable if time is added for the decay products to expand and begin interacting with the environment given by the rest of the pp collision. Ideally, the situation should therefore be simulated dynamically, where different time orderings are possible outcomes, but that would be fraught with uncertainties and is typically not done. Instead, a more common option is to allow only early or only late resonance decays, i.e. before or after hadronization. In early decays, all partons can reconnect, while in late decays the resonance decay products cannot."
        },
        {
            "heading": "7.2.1 The MPI-based model",
            "text": "The first CR model implemented in PYTHIA 8, and currently still the default, attempts to reduce \u03bb by a complete merge of the partons of separate MPI systems. The probability for two MPIs to be reconnected this way is a function of the lower p\u22a5 scale of the two, of the form\nPrec(p\u22a5) = (Rrec p\u22a50)2\n(Rrec p\u22a50)2 + p2\u22a5 , (323)\nwhere p\u22a50 is the parameter introduced in eq. (253) to damp the p\u22a5 \u2192 0 infinity of the QCD 2\u2192 2 cross section, and Rrec is a phenomenological parameter. An Rrec of order unity would seem reasonable; empirically somewhat larger values are found. The reconnection probability is chosen to be higher for soft systems, reflecting that the latter are described by more extended wave functions, thus having a higher probability to overlap and interact with other systems.\nNow consider an event containing n MPIs, which have been generated in order of falling p\u22a5, p\u22a51 > p\u22a52 > . . . > p\u22a5n. The reconnections are then done in a two-step procedure, as follows.\nFirst, the MPI systems are tested for reconnection in sequence of increasing p\u22a5, i.e. starting with system n. For an arbitrary m, 2 \u2264 m \u2264 n, the reconnection probability Pm = Prec(p\u22a5m) is used to decide whether system m should be merged with m \u2212 1 or not. If not, the same relative probability holds for a merger with m\u2212 2, and so on to the top. That is, there is no explicit dependence on the higher p\u22a5 scale, but implicitly there is via the survival probability of not already having been merged with a lower-p\u22a5 system. In total, the probability for m not to merge therefore is (1 \u2212 Pm)m\u22121. Note that mergings may cascade: if m is merged with l, 1 < l < m, then l in its turn may be merged with an even-higher-p\u22a5 system k, 1 \u2264 k < l, and then also m counts as merged with k.\nSecond, once it has been decided which systems should be reconnected, the actual merging is carried out in the opposite direction. That is, first the hardest system is studied, and all colour dipoles (i, k) in it are found, as usual in the Nc \u2192\u221e limit. This includes those to the beam remnants, as defined by the holes of the incoming partons. Then consecutively, each softer system to be merged with it is considered in order of decreasing p\u22a5. For each such system, the gluons j are inserted, in order of decreasing gluon pT , into the dipole (i, k) that minimizes the increase in the \u03bb measure for the harder system\n\u2206\u03bb= \u03bb j;ik \u2261 \u03bbi j +\u03bb jk \u2212\u03bbik = ln (pi \u00b7 p j)(p j \u00b7 pk)\n(pi \u00b7 pk)m20 . (324)\nNote that the first term of eq. (322) is not required here, since an Ek \u2192 0 (for fixed relative angles) would affect all \u03bb j;ik the same way and thus not alter the choice of the winning (i, k) dipole. Although gluons dominate, MPIs may also contain quarks. Those qq pairs that originate from the splitting of a gluon can be inserted into the higher-p\u22a5 system by the same criterion as would have been used for such a gluon. The (few) other quarks are not affected by the CR procedure, but remain for the beam-remnant handling to address.\nThe CR procedure is carried out before resonance decays are considered by default, i.e. the late decay option introduced above. It is possible to switch to early decays, however."
        },
        {
            "heading": "7.2.2 QCD-based colour reconnections",
            "text": "As discussed in the introduction to section 7.2, during the perturbative stages of the event evolution, LC colour flow is used to keep track of which partons are colour connected to each other. In the LC limit, each colour tag is matched by only a single unique anticolour tag in the event (or a combination of two colour tags, if junctions are present). At the perturbative level, these connections represent LC dipoles/antennae, and they are one-to-one mapped to string pieces at the non-perturbative stage, enforcing colour confinement.\nBeyond the LC limit however, there should be a finite probability also for LC-unconnected partons to \u201caccidentally\u201d find themselves in a colour-singlet state, or in some other coherent state with a lower total colour charge than the scalar sum of their individual charges. This\nfollows from the SU(3) colour-algebra rules:\n3\u2297 3= 8\u2295 1 , (325)\n3\u2297 3= 6\u2295 3 , (326)\n3\u2297 8= 15\u2295 6\u2295 3 , (327)\n8\u2297 8= 27\u2295 10\u2295 10\u2295 8\u2295 8\u2295 1 , (328)\nwhere the representations that correspond to a coherent addition of charges (with lower total charge) are highlighted in red. In the LC limit, colour-unconnected quark-antiquark pairs are never allowed to form a singlet; they are always in an overall octet state, while quarkquark, quark-gluon, and gluon-gluon ones are in sextet, quindecuplet, and vigintiseptet states, respectively.\nThe starting point for the QCD-based CR scheme [249] is that slightly simplified versions of eqs. (325) to (328) can be used to compute probabilities for LC-unconnected partons to stochastically enter into coherent states with one another. This does not invalidate the LC colour topology, but it does allow for (potentially many) other viable mappings of the same parton system to different string configurations. Optionally, configurations that involve (re)connections between systems with large relative boosts can be excluded if deemed to be in conflict with causality, as discussed further below. The model then chooses between the remaining allowed configurations by selecting the one that minimizes the \u03bbmeasure, eq. (322). In principle, one could allow fluctuations around this, but that is not currently done in the model.\nA characteristic feature of this model is that it provides a qualitatively new mechanism for the creation of baryon-antibaryon pairs, in addition to the conventional mechanism of string breaks to diquark-antidiquark pairs. The 3 in eq. (326), the 6 in eq. (327), and the two decuplets in eq. (328) represent colour states that involve colour-epsilon structures. In the context of the string model, these map to string junctions (and antijunctions), around which baryons will form, cf. section 7.1.5 and [302]. As a consequence, the effective baryon-to-meson ratio increases with the amount of CR in this model, and hence more active events (e.g. with many MPI) will generally exhibit higher baryon fractions. Note that colour conservation implies that the model always creates equal numbers of baryons and antibaryons; these pairs can, however, be well separated in phase space, contrary to the more localized nature of the conventional diquark string breaks. Moreover, the model also allows for the formation of doubly-heavy-flavour baryons such as \u039ebc , a possibility that does not occur within the conventional diquark-type string breaks. In the current formulation of the model, however, no special attention has been devoted to questions specific to heavy quarks, hence this aspect should be considered to be associated with substantial uncertainty.\nAt the technical level, the model approximates the QCD probabilities expressed by eqs. (325) to (328) by randomly assigning an index between 0\u20138 to each Les-Houches colour tag, subject to the requirement that gluons must have different colour and anticolour indices. Any parton pairs with matching colour and anticolour indices are then considered to be in relative singlets and are candidates for dipole-type string pieces. (This mimics the representation first proposed in [319].) Stochastically, this reproduces the 19 probability of eq. (325) exactly.\nThe algorithm starts from the LC topology and considers each index group in turn, working its way down from high to low dipole invariant masses, at each step considering all allowed possibilities and executing a swap if that lowers the total \u03bb measure. Note that qq\u0304 pairs originating directly from g \u2192 qq\u0304 branchings are also excluded from having the same index. Consequently, quarkonium formation from such pairs is not expected in this model in its current formulation.\nIf junction-type reconnections are enabled, the algorithm then works its way through three\nseparate groups of indices: [0,3,6], [1,4,7], and [2,5,8] (chosen so that they are trivial to separate using the modulo 3 operation). Within each of these groups, any partons carrying two different colour indices (say, 0 and 3) are allowed to add coherently to the overall anticolour of the third (say, -6) and enter into corresponding junction-type reconnections if that reduces the \u03bb measure. This enables a decent (29) approximation to the probability for junction-type reconnections, but does underestimate the true QCD group weights somewhat, see [249]. This procedure (dipole-style reconnections followed by junction reconnections) is iterated until no more favourable reconnections are identified.\nIn addition to the colour rules, the dipoles also need to be causally connected in order to perform a reconnection. The definition of causally connected dipoles is not exact, and several different options are available. All the time-dilation modes introduce a tunable parameter, which provides a handle on the overall amount of CR.\nWhen the two strings are allowed to reconnect, they will reconnect if it lowers the total string length, as defined by an approximation to the \u03bb measure. Several options for different approximations are available. The \u03bb measure is not well understood, especially for junction structures, and a tunable parameter allows for the enhancement or suppression of junctiontype connections to dipole ones. This affects how many baryons are generated by the model. See also the description of junction fragmentation in section 7.1.5.\nAlthough the main objective of the model is to treat reconnections involving large invariant masses, there is of course a tail towards small masses as well. For very low masses<O(1GeV), string fragmentation becomes technically complicated (as each hadron needs to straddle several gluon \u201ckinks\u201d), especially when junctions are involved, and also the approximations made in the \u03bbmeasure are not particularly reliable. Therefore, reconnections involving string pieces with masses below m0, cf. eq. (322), are excluded from participating in the CR framework. (Technically, partons making up such low-mass systems are treated collectively as a single pseudo-particle for the purpose of reconnections.)"
        },
        {
            "heading": "7.2.3 The gluon-move scheme",
            "text": "In the effort to determine the top mass as accurately as possible, CR is one of the major sources of systematic error. To better understand the situation, a range of new models were developed and implemented in [318]. Many of these are crude straw-man models, or applicable only to top decay. They are therefore not integrated as standard options, but may be obtained by using the ColourReconnectionHooks.h plugin; see main29.cc for an example.\nIn the late resonance decays approach it is possible to use separate CR models for the underlying event and for the top decay products. Then two collections of gluons are constructed, one with the gluons radiated from the top decay products and the other with the gluons from the rest of the event. Iterating over the former set in random order, a random fraction of the gluons from the top are forced to exchange colours with a gluon from the rest of the event. The latter gluon can be picked according to one of five different criteria, (i) at random, (ii) giving the smallest invariant mass, (iii) giving the largest invariant mass, (iv) giving the smallest (with sign) \u2206\u03bb value, or (v) as (iv) but only if \u2206\u03bb < 0.\nFor early resonance decays, three possible operations were implemented, swap, move, and flip. The latter two are implemented in the main body of PYTHIA.\nThe swap model is similar to option (iv) above. In it, a random fraction of all final-state gluons are chosen for possible reconnection. For each gluon pair j and m in this set, on dipoles (i, k) and (l, n) respectively, one calculates the difference\u2206\u03bb resulting from a swap of the two gluon colours\n\u2206\u03bb( j, m) = \u03bbm;ik +\u03bb j;ln \u2212 \u03bb j;ik +\u03bbm;ln = \u03bbim +\u03bbmk +\u03bbl j +\u03bb jn \u2212 \u03bbi j +\u03bb jk +\u03bblm +\u03bbmn . (329)\nA corresponding reconnection is performed if min j,m\u2206\u03bb( j, m) \u2264 \u2206\u03bbcut. Here, \u2206\u03bbcut \u2264 0 is a free parameter that relates to the generated CR rate. The procedure is iterated over until no allowed swaps remain.\nThe closely related move model works as follows. Again a random fraction of all final-state gluons are selected. The change in the string length \u2206\u03bb is calculated for each such gluon j on a final-state dipole (i, k), if the gluon is moved to any other final-state dipole (l, n):\n\u2206\u03bb( j, ik\u2192 ln) = \u03bb j;ln \u2212\u03bb j;ik = \u03bbl j +\u03bb jn +\u03bbik \u2212 \u03bbi j +\u03bb jk +\u03bbln . (330)\nHere, the minimum is found as \u2206\u03bbmin = min j,l,n\u2206\u03bb( j, ik\u2192 ln), and the move is carried out if \u2206\u03bbmin \u2264\u2206\u03bbcut. This is then repeated as long as the latter criterion is fulfilled.\nThere is some fine print. If a colour-singlet subsystem consists of two gluons only, then it is not allowed to move any of them, since that would result in a colour-singlet gluon. Also, at most as many moves are made as there are gluons, which normally should be enough. A specific gluon may be moved more than once, however. Finally, a gluon directly connected to a junction cannot be moved, and also no gluon can be inserted between it and the junction. This is entirely for practical reasons, but should not be a problem, since junctions are rare in this model.\nNeither the swap nor move methods reconnect quarks. That is, a qq pair starting out at the opposite ends of a string will remain connected throughout. The intermediate gluons on this string can change, however, and in the move model even the number of such gluons. A flip step can be added after the swap or move ones, to also reconnect quarks. There, two string pieces, (i, k) and (l, n), are connected to(i, n) and (l, k). For any two separate colour-singlet subsystems this gives\n\u2206\u03bbmin = min i,k,l,n [\u03bbin +\u03bblk \u2212 (\u03bbik +\u03bbln)] . (331)\nThe system pair with smallest \u2206\u03bbmin is allowed to flip, as long as \u2206\u03bbmin \u2264 \u2206\u03bbcut. Singlet systems cannot undergo a second flip. Junction topologies are either included or excluded among the allowed flip possibilities. It is also possible to switch on/off move and flip separately."
        },
        {
            "heading": "7.2.4 The SK models",
            "text": "The SK I and SK II models [310, 320] were specifically developed for e+e\u2212 \u2192 W+W\u2212 \u2192 q1q2q3q4 at LEP 2, and work (almost) equally well for an (\u03b3\u2217/Z) (\u03b3\u2217/Z) intermediate state. They are not intended to handle hadronic collisions, however, except in special contexts. The prime example is Higgs decays of the same character as above, H \u2192 W+W\u2212/ZZ, since the Higgs is so long lived that its decay is decoupled from the rest of the event [321].\nThe labels I and II refer to the colour-confinement strings being modelled either by analogy with type I or type II superconductors. In the former case the strings are viewed as transversely extended \u201cbags\u201d [322]. The reconnection probability is then related to the space-timeintegrated overlap of the W+ and W\u2212 string pieces. In the latter model, strings are instead assumed to be analogous with vortex lines, where all the topological information is stored in a thin-core region. Then, reconnection only can occur when these cores pass through each other.\nThe imagined time sequence is as follows. The W+ and W\u2212 move apart from their common production vertex and decay at some distance. A perturbative parton shower evolves from an original qq pair produced at each decay vertex. The typical distance that a virtual parton travels before it branches is shorter than the fragmentation time, by a factor of five or more. Note that a Lorentz-boosted virtual parton gives rise to a string piece inheriting this boost factor. Thus, the branching-to-fragmentation time separation remains in all parts of an event, even if one part started hadronization while another part still is in the shower stage,\nif viewed e.g. in the event rest frame. To a decent first approximation, each W can therefore be viewed as instantaneously decaying into a string spanned between the partons at the end of the shower. The strings expand transversely and longitudinally, (at most) by the speed of light, and fragment into hadrons and disappear. The W+ and W\u2212 string pieces may overlap before that happens, however, and then a reconnection may occur in the overlap region.\nThe reconnection probability in scenario I is proportional to the integrated space-time overlap of the W+ and W\u2212 strings, with saturation at unit probability. In more detail, first consider a string piece expanding along the \u00b1z direction. Then the colour field strength is taken to be\n\u2126(x, t) = exp \u2212(x2 + y2)/2r2had\n\u03b8 (t \u2212 |x|) exp \u00a6 \u2212(t2 \u2212 z2)/\u03c42frag \u00a9 , (332)\nwhere x = (x , y, z). The first factor gives a Gaussian falloff in the transverse directions. The assumed string width rhad \u2248 0.5 fm corresponds to a hadron radius of p 3 rhad. The time retardation factor \u03b8 (t \u2212 |x|) ensures that information on the W decay spreads outwards with the speed of light. The last factor gives the no-fragmentation probability at a given proper time along the string axis, where \u03c4frag \u2248 1.5 fm follows from the default a and b fragmentationfunction parameter values. The combined field-strength expression must be appropriately rotated, boosted, and displaced to the respective W decay vertex for each string piece. A complication is that two string pieces from the same W may well overlap in a space-time point, by convoluted string drawings or by imperfections in the modelling at a gluon kink. Then the string field strength \u2126+max(x, t) is defined as the maximum of all the contributing \u2126\n+\u2019s at the relevant point. From this, the probability for a reconnection to occur is chosen to be\nPrecon = 1\u2212 exp \u2212kI\n\u222b\nd3xdt \u2126+max(x, t)\u2126 \u2212 max(x, t) , (333)\nwith kI a free parameter. The integral is approximated by Monte-Carlo methods. The exponentiation I \u2192 1 \u2212 exp(\u2212I) ensures that the probability saturates at unity. Once a reconnection occurs, however, its space-time location is selected according to the differential probability \u2126+max(x, t)\u2126 \u2212 max(x, t) without any saturation. This defines the string pieces involved, and the new colour singlets are obtained by a flip as described above (dipoles (i, k) + (l, n)\u2192 (i, n) + (l, k)).\nReconnections in scenario II can only take place when the cores of two string pieces cross each other. Then the transverse size of strings is irrelevant, which gives a much simpler algorithm than in scenario I. Now a string-piece core at time t is parameterized by a one-parameter set x(t,\u03b1), where 0 \u2264 \u03b1 \u2264 1. Two string pieces (i, k) and (l, n) from the W+ and W\u2212 decays cross when x+(i,k)(t,\u03b1 +) = x\u2212(l,n)(t,\u03b1 \u2212). This simple sytem of linear equations always has a unique solution in (t,\u03b1+,\u03b1\u2212), but the solution need not be in the physically allowed domain. Such false solutions are easily rejected. As an example, if there is no shower activity, so that the event only consists of the two q1q2 and q3q4 strings, it is easy to see that these are moving apart from each other already from their creation and will never meet. A solution will nevertheless be found, but with negative t and possibly either or both of the \u03b1\u00b1 outside their allowed range. Further, as in scenario I, neither string piece should have had time to fragment at crossing. This gives two extra suppression factors exp{\u2212\u03c42/\u03c42frag}, with \u03c4 the proper lifetime of each string piece at the point of crossing. Only the one that occurs first is chosen if several string crossings are possible. Reconnection is done with a flip, as in scenario I.\nIn models I and II the string length is not tested, so it may increase. The geometry of the process still tends to favour a reduced \u03bb. For the model variants I\u2032 and II\u2032, a reduced \u03bb is imposed as an additional requirement on allowed reconnections."
        },
        {
            "heading": "7.2.5 Other CR models",
            "text": "It is relevant to remember that many more CR models have been proposed, and several implemented in past PYTHIA versions. Some of these could be resuscitated using the existing colour-reconnection user hook, or an expanded version thereof, should the need arise.\nIn PYTHIA 6.4, several colour-annealing scenarios were available [315,323], again primarily intended to be useful for top-mass uncertainty studies in hadronic collisions. They start from the assumption that, at hadronization time, no information from the perturbative colour history of the event is relevant, so all existing colour tags are erased. Instead, what determines how hadronizing strings form between the partons is a minimization of the total potential energy stored in these strings, as represented by the \u03bb measure. The minimization is achieved by an iterative procedure, which unfortunately can be quite time consuming. The scenarios differ by details such as whether closed gluon loops are suppressed or not, or whether only free colour triplets are allowed to initiate string pieces.\nAlso in PYTHIA 6.4, the GH model [324] offered a simpler option for W+W\u2212 events, based on colour factors and string length reduction, without any space-time picture.\nIn the ARIADNE program for e+e\u2212 and e\u00b1p, CR was introduced based on \u03bb minimization [319], but CR could occur after each new parton-shower emission, and thereby affect the continued shower evolution. A similar idea is the dipole-swing mechanism for the initial-state evolution of incoming hadrons [245,247].\nWhen rapidity gaps were found in HERA DIS events, one early alternative to the Ingelman\u2013 Schlein pomeron picture [250] was that the gaps were a consequence of CR [325\u2013328]. The Uppsala group has subsequently expanded this soft colour interactions approach to encompass also hadronic events, for topics such as diffraction and other rapidity gaps [329], and charmonium production [330]. One important difference relative to many of the models above is the frequent use of an \u201carea law\u201d [331] rather than the \u03bb measure. The area that a string motion sweeps out is related to its m2. For a string consisting of several pieces, the total area is defined as A=\n\u2211n i=0 m 2 i,i+1, with masses calculated as in eq. (322). The probability of a reconnection is\nthen P = R0 [1\u2212 exp(\u2212b\u2206A)] = R0 [1\u2212 exp(\u2212b(Aold \u2212 Anew))]. The R0 \u2248 1/N2c is an assumed colour-factor suppression, and b is the same as in eq. (312). Note that, had A been defined as the product of masses rather than a sum, then ln A would have been closely related to \u03bb, and in particular a \u2206\u03bb and a \u2206A scan would find the same optimal reconnection region, but that is not the case now. The related code is available in some earlier PYTHIA versions.\nCR has also been studied in the context of other generators, such as HERWIG [332\u2013334] and SHERPA [335]. It is not possible to address CR in equivalent terms for cluster as for string fragmentation, so there is no straight correspondence, but some basic ideas nevertheless are shared."
        },
        {
            "heading": "7.3 String interactions and collective effects",
            "text": "Heavy-ion collision experiments have for decades studied the possible creation of a Quark\u2013 Gluon Plasma (QGP) in high-energy collisions of heavy nuclei. Monte-Carlo simulations of physics processes involving QGP creation, is mostly carried out in designated generators or generator frameworks such as JEWEL [336] or JETSCAPE [337] (both of which in fact use PYTHIA as a hard-process generator). Another approach is to segment individual events into \u201ccore\u201d and \u201ccorona\u201d parts [338], where the former are treated as QGP, and the latter in vacuum. This is the case for EPOS-LHC [339], which is an independent framework, as well as for other approaches built on top of PYTHIA [340].\nPYTHIA has thus, historically, played on a different field than generators focused on the special observables obtained in heavy-ion collisions. Instead, PYTHIA is often used as a generator supplying an initial state, with a focus on the hard process, parton shower, and hadronization\nas in lepton collisions, with no QGP produced or assumed. This clear division of tasks was questioned by data from LHC. First in 2010, with the discovery of long-range azimuthal correlations of final-state hadrons in high multiplicity pp collisions, referred to as \u201cthe near-side ridge\u201d [341], and later by observations of enhanced production of strange and multi-strange final-state hadrons, incompatible with model fits to LEP data [342\u2013345]. The latter culminated in the observation that not only is the observed strangeness production incompatible with model fits to LEP data, strange/non-strange ratios also increase with multiplicity, and the increase smoothly connects pp with pA and AA collision systems [346]. This clearly meant that PYTHIA could no longer assume that effects traditionally ascribed to QGP formation are only present in heavy-ion collisions. While CR models can account qualitatively for some of the observed effects [347, 348], they are wholly unsuitable in others [349]. Instead of introducing QGP formation into PYTHIA, as the approaches cited above in some sense have already done, the route taken is to expand the Lund string model to its furthest consequence, by allowing interactions between strings in densely populated regions of space. Whether interactions between strings are indeed responsible for all collective effects observed in pp and heavy-ion collisions, is still unknown. The models introduced here should thus clearly be understood as one possibility among several others, however unified by the underlying assumption that QGP is not formed. Furthermore, they are all work in progress at the time of writing, and subject to change. There is no clear demarcation between what constitutes a model of colour reconnection, as introduced above, and models of string interactions. In this manual we have drawn the line between models operating in momentum space (the colour reconnection models) and models operating in real space."
        },
        {
            "heading": "7.3.1 String shoving",
            "text": "In the original formulation of the Lund string model, strings are treated as massless relativistic strings, which presupposes that strings have no transverse extensions. In collisions with many strings occupying the available spatial volume, this approximation breaks down, and strings are allowed to interact with mainly repulsive forces. The realization of this picture is denoted the \u201cstring shoving model\u201d. While similar ideas were explored analytically already in 1988 [350], the modern version of the string shoving model is formulated to take into account input from lattice QCD, and is based more firmly on the correspondence with a superconductor. This model is rather new at the time of writing [283] and is still being extended with further consequences being explored [351,352]. The model contains three basic physics components: 1) the string shape, 2) the string transverse width, and 3) the interaction force between two strings.\nThe transverse shape of the colour-electric field of the flux tube (the string shape) is determined with input from lattice QCD [353], and can be well described by a Gaussian:\nE(\u03c1) = N exp \u2212 \u03c12\n2R\n, (334)\nwhere N is a normalization factor, \u03c1 is the radial coordinate, and R is the string equilibrium radius. The normalization constant is determined by assuming that the field energy per unit length \u222b\nd2\u03c1E2/2 is a constant fraction (g) of the string tension. This gives N2 = 2g\u03ba/(\u03c0R2). The strings expand from their time of formation with infinitesimal width, until they either attain the maximum width R, or until the string\u2019s fragmentation proper time, \u03c4had, has been reached. While the equilibrium width of a string can be argued either by lattice considerations or from models, the number is associated with such large uncertainty, that it is in practice kept as a free parameter of the model, with reasonable values between around 0.5 and 1.5 fm. The same holds for the parameter g. The string repulsion force can then be calculated from the energy of the colour-electric field of two overlapping, parallel strings \u222b\nd2\u03c1(~E1 + ~E2)2/2. If\nstrings are separated from each other by the transverse distance d\u22a5, the interaction energy becomes 2g\u03baexp(\u2212d2\u22a5/(4R 2)), which gives the interaction force per unit length:\nf (d\u22a5) = g\u03bad\u22a5\nR2 exp \u2212 d2\u22a5 4R2 . (335)\nThe above treatment leading to eq. (335), is made in terms of Abelian fields. As such, anti-parallel strings would attract each other rather than repel. In a non-Abelian theory like QCD, the picture is more complex, leading to repulsion being the dominant mechanism. As an example, consider the case of oppositely oriented triplet fields. One obtains an octet field with probability 8/9, which still leads to a repulsion, and a singlet field with probability 1/9, leading to attraction. Since singlets correspond to the total attenuation of fields, it can further be assumed that singlets are already handled by colour-reconnection mechanisms [352,352].\nThe technical implementation is concerned with two further questions, namely calculating d\u22a5 for two given string pieces, and distributing the resulting pushes in the event. For the former, a suitable Lorentz frame is defined, where a string pair always lies in parallel planes, called the parallel frame [352]. One can then boost a pair of strings from the lab frame to the parallel frame, where the string topology is specified with an opening angle between the two partons in the string ends and a skewness angle between the two strings \u2014 both of which are constrained by momentum-energy conservation. The angles can be expressed in terms of pseudorapidity and invariant masses si j for the string formed by partons i and j:\ncosh(\u03b7) = s14\n4p\u22a51p\u22a54 + s13 4p\u22a51p\u22a53 , and cos(\u03c6) = s14 4p\u22a51p\u22a54 \u2212 s13 4p\u22a51p\u22a53 . (336)\nFurthermore, the strings now evolve and interact in the proper time in the parallel frame. Calculating this interaction for every possible string pair is, among other aspects, a computational challenge, and to curb the possibility of running into being an extreme computing resource-consuming program, we for now neglect end-string effects which, for example, have been studied in [290].\nThe shoving force is distributed to the outgoing hadrons formed after string fragmentation, taking into account that the total applied push is a result of a time evolution. The integrated push \u2206 p\u22a5 is:\n\u2206p\u22a5 =\n\u222b\ndt\n\u222b\ndz f (d\u22a5(t)) , (337)\nwhere the integration limits in z are time dependent. Since the time ordering of pushes is important, \u2206p\u22a5 is split up into several (fixed) small pushes \u03b4p\u22a5, according to a probability distribution P(t). The total push is then:\n\u2206p\u22a5 =\n\u222b\ndtP(t)\u03b4p\u22a5 , with P(t) = 1 \u03b4p\u22a5\n\u222b\ndz f (d\u22a5) , (338)\nwhen \u03b4p\u22a5 is small. The pushes can then be ordered in time (in the parallel frame) using the veto algorithm. The resulting procedure corresponds to a time evolution with dynamical time stepping, where steps are large when pushes are small and vice versa.\nIn t, z space, this would look like hadrons flying out along the direction of their original pseudorapidity, even after the pushes are applied, spreading out in a light-cone that extends in such a way that it encloses all the hadrons which receive a share of this generated \u2206p\u22a5. This distribution of pushes is performed as shown in fig. 18."
        },
        {
            "heading": "7.3.2 Rope hadronization",
            "text": "A simple string drawn between a quark and an antiquark is an SU(3) triplet (or anti-triplet depending on direction of colour flow). When several strings overlap with each other at hadronization time, the rope-hadronization model posits that end-point colour charges will act together coherently to form a stronger field \u2014 a rope. This possibility was noted in the classic paper by Biro, Nielsen and Knoll from 1984 [354].\nThe new, stronger field is an SU(3) multiplet. According to lattice calculations [355], the energy density (and thus the string tension) scales as the second Casimir operator (C2) of the rope multiplet. When a rope is formed by ordinary triplet and anti-triplet strings, the net colour charge is obtained from the addition of random coloured triplets and anti-triplets [246, 354, 356]. A resulting multiplet is uniquely characterized by two quantum numbers p and q, with a specific state corresponding to p coherent triplets and q coherent anti-triplets (a normal triplet string is thus characterized as {p, q} = {1, 0}). The multiplicity of a multiplet is given by:\n2N = (p+ 1)(q+ 1)(p+ q+ 2) . (339)\nThis allows for an iterative addition of multiplets. Starting from a given multiplet {p, q}, adding a triplet gives the three possible multiplets [246]:\n{p+ 1, q}, {p\u2212 1, q\u2212 1} , and {p, q\u2212 1} , (340)\nwith weights given by eq. (339). The anti-triplet case is given directly from symmetry. Once it is established which triplets and anti-triplets are overlapping in an event, a random walk procedure can be carried out to find p and q for the rope multiplet. Since the energy density of the rope is proportional to C2, the relative tension of the multiplet to the triplet can be calculated directly as:\nC2({p, q}) C2{1,0} = 1 4 (p2 + pq+ q2 + 3p+ 3q) . (341)\nWhen the rope breaks up, it does so in a step-wise manner, one string at a time. By considering the change in available field energy in the transition {p, q} \u2192 {p \u2212 1, q}, neglecting the contribution from the vacuum pressure to the total energy, the energy available in a single string breaking becomes the effective string tension \u03ba\u0303:\n\u03ba\u0303= (2p\u2212 1)\u03ba . (342)\nWhile the string tension \u03ba does not enter explicitly9 into the PYTHIA implementation of string hadronization, it does enter implicitly through the parameters of eqs. (312) and (319). From the implicit dependence on \u03ba, transformation rules for all parameters can be defined, given the assumption that the PYTHIA default values of all parameters correspond to \u03ba\u0303 = \u03ba, as they are tuned to LEP data [357] where there are no overlapping strings, and thus p = 1 and q = 0. The most important affected parameters [246], are: those involved in suppression of strangeness (\u03c1), diquark production (\u03be), diquark with strange-quark content relative to diquarks without strange quarks (x), the suppression of spin-1 diquarks relative to spin-0 diquarks, and the width of the transverse momentum distribution in string breakings (\u03c3). Letting h= \u03ba\u0303/\u03ba, the transformation rules for \u03c1, x and y are similar:\n\u03c1 7\u2192 \u03c1\u0303 = \u03c11/h, x 7\u2192 x\u0303 = x1/h , and y 7\u2192 y\u0303 = y1/h , (343)\nwhile \u03c3 7\u2192 \u03c3\u0303 = \u03c31/h. The \u03be parameter is more complicated, and transforms like:\n\u03be 7\u2192 \u03be\u0303= \u03b1\u0303\u03b2\n\u03be\n\u03b1\u03b2\n1/h\n, (344)\nwith \u03b1 depending on all the above parameters, and \u03b2 a free parameter."
        },
        {
            "heading": "7.3.3 The thermal model",
            "text": "The thermal model [358], available as a non-default option, can partly be viewed as an alternative to the rope model, sharing similar objectives. Not all details have been fully developed, so its main purpose is for exploration. One motivation for it is that hadronic p\u22a5 spectra in low-energy collisions are reasonably well described by an exponential fit\nd\u03c3 d2p\u22a5 = N exp(\u2212m\u22a5had/T ) , with m\u22a5had = \u00c7 m2had + p 2 \u22a5 , (345)\nwhere N and T are (approximately) common for all hadron types. Another motivation is that local quantum-mechanical fluctuations in the string transverse profile translate into a fluctuating string tension \u03ba, which can broaden the Gaussian p\u22a5 into an exponential-like form [359]. (Compare with fluctuations in the proton size, which are commonly advocated and used e.g. in the ANGANTYR modelling of cross sections [283].) While traditionally T is associated with a temperature, in such a scenario it would rather be derived from \u03ba.\nThe thermal model is implemented as follows. In each string break the q and q receive opposite and compensating p\u22a5 values, chosen such that the p\u22a5 sum of two adjacent string breaks precisely gives an exp(\u2212p\u22a5/T ) spectrum. Starting from a known flavour in one string break, the next flavour and the resulting intermediate hadron is chosen among all possibilities according to a relative weight exp(\u2212m\u22a5had/T ). Assuming the production of two hadrons with different masses m1 and m2, this approach then implies the same production rate for p\u22a5 m1, m2, but more suppression of the heavier hadron at low p\u22a5. Thus, there is less production of heavier states, but they come with a larger \u2329p\u22a5\u232a, which is as intended.\n9The string tension does enter explicitly into the vertex positions in section 7.1.4, but the effect of rope formation has so far not been taken into account for hadron vertices.\nThere is some fine print, like that each particle should be weighted by the number of spin states, that flavour-diagonal mesons can mix, that baryons need SU(6) symmetry factors, that baryons receive a free overall normalization factor with respect to mesons, and so on. The number of flavour-related free parameters still is significantly reduced relative to the ordinary string fragmentation.\nOverall the particle composition comes out reasonably well, with some excess of the heavier baryons. This is in contrast to the normal string fragmentation, where it is difficult to produce enough of these particles. The larger \u2329p\u22a5\u232a for heavier particles also improves agreement with pp data, but resonance decays act to dilute the effects, so \u2329p\u22a5\u232a(mhad) still does not rise quite fast enough.\nAnother issue is what happens when several strings are close packed. In the rope model, this leads to a higher \u03ba, in quantised steps. An alternative is to assume a continuously increasing \u03ba as each string is squeezed into a decreasing effective area. Such an option is implemented as part of the thermal model, but can also be applied to the default Gaussian one. In this approach, the T or \u03ba parameter is rescaled by a power of the effective number of strings in the neighbourhood of a new hadron. Therefore a trial average step along the string is made before a new hadron is produced, giving a likely hadron rapidity and p\u22a5. Then, one may count the number of strings crossing that rapidity, as a simple measure of string density. A smooth damping is applied for particles produced at larger p\u22a5, which are likely to be produced in minijets sticking out from the denser-populated central region. The close-packing enhancement can be used e.g. to increase strangeness production in high-multiplicity pp events, similar to the rope model, but it has not been as extensively compared with data."
        },
        {
            "heading": "7.4 Hadronic rescattering",
            "text": "After hadrons have been produced, outgoing hadrons can interact in secondary collisions. This rescattering can be relevant when studying collective effects, but can lead to a significant slowdown of PYTHIA, and is therefore not on by default. It is enabled by setting HadronLevel:Rescatter = on. Here, we will outline the rescattering algorithm, then summarize some notable effects of rescattering of which the average user should be aware. A more detailed discussion of the rescattering framework is given in [213] in the context of pp collisions, while [360] discusses physics results for pA and AA collisions.\nThere are two aspects to the rescattering algorithm: first, describing how two hadrons interact with each other in their rest frame; and second, describing the evolution of the event as a whole.\nConsider two hadrons in their rest frame, with CM energy p\ns and impact parameter b. We assume that the probability of an interaction occurring is a function of b and the total cross section \u03c3tot. The cross section generally depends on p s and the specific hadron species, as described in section 6.1.5. There is no solid theory for how P depends of b, so two different models are implemented in PYTHIA 8.3. The default is a Gaussian dependency,\nP(b) = P0e \u2212b2/b20 , (346)\nwhere P0 is referred to as the opacity, a free parameter that is 0.9 by default, and the characteristic length scale is\nb0 = \u221a \u221a\u03c3tot P0\u03c0 . (347)\nThe alternative model is a disk model,\nP(b) = P0\u0398(b\u2212 b0) , (348)\nwhere \u0398 is the Heaviside step function. For P0 = 1, this corresponds to the black-disk model used by most existing hadronic rescattering frameworks. The two models are normalized such that if b is chosen uniformly on a disk with radius much larger than b0, then both models will give the same interaction probability. In practice, rescattering is more likely in dense regions where b tends to be biased towards lower values, so the narrower distributions like the black disk will lead to more rescattering activity. If it is determined that the hadrons should interact, the interaction time is defined as the time of closest approach in their rest frame.\nThe algorithm for performing rescattering for the whole event proceeds as follows:\n1. Start with an event right after hadronization.\n2. For each hadron pair, test whether they could interact, using the probability P defined above.\n3. If a pair could potentially interact, record the interaction time for that pair in a timeordered list.\n4. Choose the earliest interaction in the list where participants have not already interacted, and simulate the collision. Which process to simulate is chosen with probabilities proportional to the partial cross sections for each process.\n5. Check whether the newly produced hadrons can interact with existing ones, and if so, add the interaction times for those pairs to that list.\n6. Continue picking interactions from the list until there are no more potential rescatterings.\nShort-lived hadrons can also decay during the rescattering phase. To model this, the decay times of those hadrons are recorded in the list together with rescattering interaction times, and the decay occurs when it is chosen in step 3 above, if it has not already rescattered.\nEnabling rescattering has a few consequences for the shape of events. First, rescattering increases charged multiplicity, since only processes with two incoming hadrons are allowed, but inelastic processes can produce more than two outgoing ones. For PYTHIA 8.307 with default parameters and pp at 13 TeV, this can be compensated by setting MultipartonInteraction:pT0Ref = 2.345. For beams such as pPb and PbPb, other values might restore the multiplicity, but a more thorough retune is necessary in order to simultaneously obtain the correct multiplicity in all three cases. In such a retune, it would also be relevant to include other effects such as ropes (section 7.3.2) and shoving (section 7.3.1). For now, the user is advised to assume that rescattering will change the charged multiplicity.\nSimilarly, hadron composition will change. Baryon number in particular is reduced in rescattering through annihilation processes. For example, the process pp \u2192 \u03c0+\u03c0\u2212\u03c00 is possible, but not the reverse. Another way the composition changes is through resonance production, e.g. \u03c0K\u2192 K\u2217, but be aware that this resonance production is not easily detectable in experiment; for a resonance production followed by a decay, \u03c0K \u2192 K\u2217 \u2192 \u03c0K, the invariant mass of the outgoing system is the same as for the incoming one. In other words, this process produces a K\u2217 that is visible in the event record, without necessarily changing the observable \u03c0K mass spectrum.\nA particular consequence of the increased multiplicity is that each hadron will on average have lower p\u22a5, which could affect e.g. spectra that are sensitive to p\u22a5 cuts. At the same time, the mean p\u22a5 for particular hadron species may increase. This is the case for example with protons, which will move slower than pions with similar p\u22a5, and will therefore receive a push from behind. This phenomenon is referred to as the \u201cpion wind\u201d.\nRescattering has been shown to give rise to some collective effects, in particular azimuthal flow in PbPb collisions. PYTHIA 8.3/ANGANTYR with rescattering provides a good description of elliptic flow coefficients at large multiplicities, and a more modest contribution at low multiplicities. It can also lead to some jet modifications, but with the aforementioned p\u22a5 shift, it is not clear how to interpret these modifications. See [360] for further discussion."
        },
        {
            "heading": "7.5 Bose\u2013Einstein effects",
            "text": "Ideally, coloured partons could be formed into colourless final-state hadrons using amplitudebased quantum mechanics, but because these transitions are non-perturbative, phenomenological models of hadronization are employed. Due to the probabilistic nature of these hadronization models, coherence in final-state particles cannot be directly described. A classic example of such final state coherence is Bose\u2013Einstein effects, where correlations arise between identical bosons in an event from the symmetrization of the production amplitude. While these correlations are expected to have a negligible impact for most measurements in pp collisions, Bose\u2013Einstein effects10 have been observed in minimum bias pp and pp data [362\u2013365], as well as e+e\u2212data [366\u2013369]. Additionally, some precision measurements such as W -mass determination using hadronic final states may be sensitive to Bose\u2013Einstein effects [370].\nAssuming a geometric picture with a Gaussian distribution of production vertices in spacetime, two-particle correlations of identical bosons are enhanced by a unitless factor of,\nf2(Q) = 1+\u03bbe \u2212Q2Q\u221220 , (349)\nwith respect to a final state with no coherence effects [371]. Here, Q2 is (pi \u2212 p j)2 where pi and p j are the four-momenta of the two particles, \u03bb is the incoherence parameter, and Q0 is a reference Q related to the radius of the particle source as r \u2261 \u0127h/Q0. The incoherence parameter is limited between 0 where there is no effect, and 1 with a maximal effect.\nFor a high multiplicity event with multiple two-particle correlations, the event weight can be naively approximated as the product of f2(Q) for each particle pair. Note, this is a slight overestimate of the event weight for most event topologies. These event weights cannot modify the overall normalization, as this would increase the cross section for the final state. If the weights are normalized to unity, the total cross section is not modified, but the multiplicity distribution will be shifted to higher multiplicities. Neither of these behaviours is desirable, as both cross sections and multiplicity distributions are already well described without Bose\u2013 Einstein effects.\nInstead, in PYTHIA Bose\u2013Einstein effects are introduced by shifting the momenta inside particle pairs. Assuming the distribution of Q for particle pairs is given by flat phase space, then solving,\n\u222b Q\n0\ndq q2\np q2 + 4m2 =\n\u222b Q\u2032\n0\ndq f2(q) q2 p\nq2 + 4m2 , (350)\nfor Q\u2032 determines the new Q value needed to produce an enhancement of f2(Q) for that particle pair with individual particle mass m. The three-momentum for the two particles can then be shifted by, \u2206~pi, j = c(~pi \u2212 ~p j) , (351) where ~p \u2032i = ~pi+\u2206~pi, j ~p \u2032 j = ~p j\u2212\u2206~pi, j , and the constant coefficient c is determined from setting Q\u20322 = (p\u2032i \u2212 p \u2032 j)\n2. Because events may have more than one particle pair, the total shift for a given particle is then,\n~p \u2032i = ~pi + \u2211\nj 6=i\n\u2206~pi, j , (352)\n10Within the heavy-ion and astrophysics communities these effects are oftentimes discussed in the context of Hanbury-Brown\u2013Twiss interferometry [361].\nwhere the sign of \u2206~pi, j is such that the three-momenta of the event is conserved. Effectively, this shifting of momentum corresponds to pulling particle pairs closer together, and while three-momenta is conserved throughout this process, energy conservation is violated and the total energy of the event is reduced. The form of f2(Q) from eq. (349) arises from integrating the pair symmetrization term 1+cos(\u2206x \u00b7\u2206p) over a Gaussian distribution of production vertices in space-time. Consequently, any source distribution other than a Gaussian will result in an oscillatory behaviour of f2(Q), with alternating values of f2(Q) > 1, where Q\u2032 <Q results in the pair pulled together, and f2(Q)< 1, where Q\u2032 >Q results in the pair separated apart. With the appropriate damping of this oscillatory behaviour, for a given particle configuration, a form of f2(Q) can be found where both conservation of three-momenta and energy is achieved. Some pairs at low Q are pulled together, reducing the net energy, while other pairs at middle Q are separated apart, increasing the net energy.\nTo achieve this behaviour, a form of f2(Q) is selected to have one oscillation before damping. The ansatz of the BE32 algorithm [372],\nf2(Q) =\n1+\u03bbe\u2212Q 2Q\u221220 1+\u03b1\u03bbe\u2212Q 2Q\u221220 /9 1\u2212 e\u2212Q 2Q\u221220 /4 , (353)\nis chosen for \u03b1 < 0, where the new second factor effectively models the initial minimum of the oscillation as a smeared Gaussian [14]. This form does not have any deep physical meaning, but provides the necessary first oscillation while maintaining the initial Gaussian distribution form, and has the limiting behaviour of f2(0) = 1+ \u03bb. The factor \u03b1 is iteratively determined per event after calculating all relevant p\u2032i , such that energy is still conserved even after threemomentum shifting is performed for each relevant particle. Consequently, at least two particle pairs must be present for Bose\u2013Einstein effects to be introduced.\nBose\u2013Einstein correlations are performed after hadronization but prior to particle decays, and are not included by default. Effects may be switched on or off for different particle groupings: pions with \u03c00, \u03c0+, and \u03c0\u2212 pairs; kaons with K0S, K 0 L, K\n+, and K\u2212 pairs; and eta mesons with \u03b7 and \u03b7\u2032 pairs. Many of these particle species are produced not only from primary hadronization, but also from the decay of short-lived particles. Consequently, a configurable minimum decay width can be set so that any particles with a larger width are decayed prior to the application of Bose\u2013Einstein effects. The default minimum decay width is set at 0.02 GeV so that both \u03c1 and K\u2217 mesons are decayed before correlations are introduced. Both the shifted and unshifted versions of particles are kept in the event record for bookkeeping purposes. All shifted particles are assigned a status of 99 and are set as the children of their unshifted entry."
        },
        {
            "heading": "7.6 Deuteron production",
            "text": "The deuteron, D, is a bound proton and neutron state, which, similar to Bose\u2013Einstein effects (see section 7.5), must be formed after hadronization. Understanding deuteron production in the context of collider-based experiments can help efforts in modelling nuclei formation and reduce prediction uncertainties when searching for possible dark-matter induced excesses in cosmic ray flux ratios [373]. In heavy-ion physics, formation of loosely bound systems are often used to determine the chemical freeze-out temperature in statistical hadronization models [374]. In PYTHIA 8.3, two deuteron formation models are available, the coalescence model [375, 376] and the more sophisticated Dal\u2013Raklev model [377]. Both models are implemented through the same configurable framework, with the Dal\u2013Raklev model set as the default configuration. All deuteron production is switched off unless explicitly requested by the user. Note that while the discussion here is for the deuteron, anti-deuteron production is also performed following the exact same method, but with all particles swapped to antiparticles.\nIn the coalescence model, all possible p and n pair combinations are determined. For each pair the magnitude of their three-momenta difference,\nk = q\n(~pi \u2212 ~p j)2 , (354)\nis calculated in the rest frame of the pair, where ~pi and ~p j are the two three-momenta of the pair. If k is less than some cutoff value c0, the pair is bound into a deuteron, otherwise the nucleons remain unmodified. Spatial separation, in addition to momentum separation, could also be considered, although this has not been implemented in any of the models described here. The ordering of testing pairs for binding is randomized, and after each successful binding, any remaining pairs containing one of the bound nucleons are no longer considered for binding. For the coalescence model, this implies that the binding cross section is flat as a function of k. If there are two unique pairs each with k < c0, both pairs have an equal probability of being bound, even if one k is smaller than the other.\nAfter a nucleon pair is selected for binding, a deuteron is formed. In principle, the threemomentum of this deuteron could be calculated as ~pi+~p j , and while three-momentum for the event would be conserved, energy would not. Instead, an isotropic decay into a deuteron and photon is performed in the rest frame of the pair. Because the primary process for deuteron formation at the low momentum differences of the coalescence model is radiative capture, pn\u2192 \u03b3D, this provides a reasonable approximation of the process and conserves both energy and momentum. While spin correlations could be considered, these typically are negligible after boosting the deuteron and photon into the laboratory frame.\nThe Dal\u2013Raklev model expands upon the coalescence model by considering the following formation channels, other than just pn\u2192 D\u03b3.\n\u2022 pn\u2192 \u03b3D\n\u2022 pn\u2192 \u03c00D\n\u2022 pn\u2192 \u03c0\u2212\u03c0+D\n\u2022 pn\u2192 \u03c00\u03c00D\n\u2022 pp\u2192 \u03c0+D\n\u2022 nn\u2192 \u03c0\u2212D\n\u2022 pp\u2192 \u03c0+\u03c00D\n\u2022 nn\u2192 \u03c0\u2212\u03c00D\nChannels can be removed, modified, or added. Each channel must have a two-body initial state and an n-body final state where n> 1 and at least one of the outgoing particles is a deuteron. For each of these channels the kinematics of the final state are determined by an isotropic decay in the rest frame of the initial state pair. Additionally, the binding cross section is no longer considered as a uniform distribution up to a cutoff parameter, but is instead determined from fits of differential nucleon-scattering data from a number of experiments [377].\nFour cross-section parameterizations are available. For each channel, one of the following parameterizations must be selected, and the necessary coefficients ci provided.\n1. The coalescence model parameterization as previously described is a step function with two parameters, the cutoff parameter c0 and a normalization parameter c1. The normalization allows channels using this parameterization to be used in combination with other channels.\nd\u03c3(k) dk = c1\u0398(c0 \u2212 k) . (355)\n2. The pn \u2192 \u03b3D cross-section differential in k can be parameterized by a polynomial below a cutoff of c0, and with an exponential above. Due to Runge\u2019s phenomenon, the polynomial is fixed to its value at k = 0.1 GeV for k < 0.1 GeV.\nd\u03c3(k) dk =\n\n \n \nd\u03c3(0.1 GeV)/dk , for k < 0.1 GeV , \u221112\ni=1 cik i\u22122 , for 0.1 GeV \u2265 k < c0 ,\ne\u2212c13k\u2212c14k 2 , otherwise .\n(356)\n3. The two-body final states with a pion and deuteron are parameterized using a cross section differential in q, the momentum magnitude of the pion in the nucleon-pair rest frame, divided by the mass of the pion. Because the final state is two-body, the pion momentum magnitude is already known a priori.\nd\u03c3(q) dq = c0q\nc1\n(c2 \u2212 ec3q)2 + c4 . (357)\nIn the default Dal\u2013Raklev model, the pn \u2192 \u03c00D, pn \u2192 \u03c0+D, and pn \u2192 \u03c0\u2212D channels use this parameterization.\n4. The cross sections for the three-body final states with pions are differential in k and are parameterized with,\nd\u03c3(k) dk = \u2211\ni=0\nc5ik c5i+1\n(c5i+2 \u2212 ec5i+3k)2 + c5i+4 , (358)\nwhere the number of coefficients is variable but must be a multiple of 5. The default pn\u2192 \u03c0\u2212\u03c0+D, pn\u2192 \u03c00\u03c00D, pn\u2192 \u03c0+\u03c00D, and nn\u2192 \u03c0\u2212\u03c00D channels use this parameterization.\nNot only does the shape of the differential cross sections matter, but also the normalization, as this determines the relative rates between the channels. In the Dal\u2013Raklev model the \u03b3D channel dominates at low k. For k > 1 GeV the \u03c0D channels dominate except between roughly 1 and 2 GeV where the\u03c0\u03c0D channels dominate. An additional unitless normalization scale can be configured to increase or decrease the total deuteron production cross section. A number of fits for this normalization constant have been made using various data sets from the LHC, with the default normalization set from differential 7 TeV ALICE data [377]."
        },
        {
            "heading": "8 Particles and decays",
            "text": "There are several ways to classify unstable particles, and in PYTHIA at least three classifications are useful:\n\u2022 by lifetime, specifically for coloured particles whether above or below the hadronization time;\n\u2022 by if the partial and total widths of a particle are perturbatively calculable, such as for the \u00b5, \u03b3\u2217/Z, W\u00b1, top, Higgs bosons, and most BSM particles, or not, such as for hadrons;\n\u2022 by if a particle is part of the hard process, and cannot be produced anywhere else, such as in parton showers or hadronization, e.g. Z, W\u00b1, top, and Higgs bosons.\nThese classifications are necessary to understand how particles are technically treated. In PYTHIA a distinction is made between the following technical representations of particle states: resonances with an average lifetime shorter than the hadronization scale; particles with an average lifetime comparable to or longer than the hadronization scale; and partons that carry colour charge and must be hadronized. By default, any state with a nominal mass above 20 GeV is considered as a resonance, e.g. \u03b3\u2217/Z, W\u00b1, top, Higgs bosons, and most BSM states such as sfermions and gauginos. However, some light hypothetical weakly interacting or stable states, such as the gravitino, are also by default considered as resonances to ensure a full treatment of angular correlations in their decays. All remaining states without colour charge, primarily leptons and hadrons, are treated as particles, while quarks and gluons are\nconsidered as partons. There are some exceptions like colour-octet onia, which are treated as both partons carrying colour charge, and particles that decay after hadronization.\nResonance states are sequentially decayed during the hard process, see section 3.11 for details. For example, in the hard process gg\u2192 H\u2192 Z[\u2192 \u00b5+\u00b5\u2212]Z[\u2192 \u00b5+\u00b5\u2212] the decay of the Higgs into Z bosons is first performed, followed by the decays of the \u03b3\u2217Z resonances into muon pairs. The cross sections calculated for hard processes with resonances depend upon the available decay channels of the resonances; closing decay channels will reduce the cross section for the process while opening decay channels will increase the cross section. Consequently, when using the cross section calculated for a resonance produced in a hard process, the available branching fractions of the resonance are already included in the cross section. In most cases, angular correlations are included in the decay of the resonance. In some cases, mixed decays of the resonances are needed, e.g. gg \u2192 H \u2192 Z[\u2192 \u00b5+\u00b5\u2212]Z[\u2192 e+e\u2212]. In this example, both the muon and electron channels could be left open. However, in some cases this might result in inefficient generation of the required final state. Consequently, a special class is available in PYTHIA, ResonanceDecayFilterHooks, which can be used to select specific final states from the resonance decays.\nLighter states such as the J/\u03c8, which can be produced by the hard processes of section 3.3, are technically treated by PYTHIA as particles and not resonances. This is because the J/\u03c8 can be produced in both hadronization and particle decays, where the cross section of these J/\u03c8 production mechanisms is not known a priori. The reduced cross section of the J/\u03c8 due to closed decay channels can only be determined after the generation of full events, including J/\u03c8 production from the hard process, hadronization, and particle decays. Similarly, states that are only produced in the hadronization and particle decays, e.g. the \u03c1, are also considered particles and not resonances. An important exception to the treatment of resonances is the production of weak bosons in the parton shower, see section 4.1.4. Here, while closing the decay channels of the weak bosons will modify the hard-process cross section, the decays of the weak bosons in the parton shower will still remain inclusive. The decay channels of the weak bosons in the parton shower can be selected using the special IDs 93 and 94 for the Z and W, respectively. However, changing these decay channels will not affect the hard-process cross section and must be book kept carefully by the user."
        },
        {
            "heading": "8.1 Particle properties",
            "text": "For all states, a number of properties must be defined. Each state is uniquely identified by its PDG ID, or when a PDG convention is not available, a PYTHIA specific numbering convention, i.e. for BSM and colour-octet onium states. For each state a human readable name is stored, as well as an antiparticle name when relevant. The quantum numbers for each state must be defined: the spin, electric charge, and colour charge. Note that the spin information is duplicated for hadrons, where the spin can also be determined from the PDG ID. The experimentally observable properties of the state are also specified including a nominal mass, a nominal width, allowed limits of this width, and a nominal proper lifetime. Additionally, a number of decay related options can be specified including whether the state may decay, if the width is perturbatively calculable, and if the width should be forced to be rescaled. Each state may also have a list of decay channels which determine how the state is decayed. Each channel is configured with a flag specifying if the channel is available for the particle/antiparticle state, a branching ratio, a mode specifying a possible matrix element for the decay, and a list of the decay products."
        },
        {
            "heading": "8.1.1 Masses",
            "text": "The default masses for most particles in PYTHIA are taken from experimental observation as summarized by the PDG [378]. There are three exceptions: quarks and diquarks, unobserved or poorly studied hadrons, and hypothetical BSM particles. For hypothetical particles, e.g. BSM Higgs bosons, hidden valley hadrons, or fourth generation fermions, reasonable defaults are provided, see section 10.1.2 for details.\nDue to ill-defined quark masses, two types of quark masses are used in PYTHIA, kinematic and running. The kinematic masses are those defined in the PYTHIA particle database, and are used when generating phase space. For example, in the process gg\u2192 cc, the kinematic mass of the c quark is used. Similarly, the g\u2192 qq splittings of the parton shower use these kinematic masses. While these quark masses can be changed, their default values have been carefully chosen following a number of considerations [303]. Modifying these default values can lead to unintended consequences across all aspects of PYTHIA including hard process generation, the parton shower, hadronization, and even particle decays. Consequently, care should be taken when changing these quark masses from their default values.\nRunning quark masses are used when calculating mass-dependent couplings, which include couplings of the quarks to SM and BSM Higgs bosons. The running masses for the quarks are calculated at one loop in the MS normalization scheme using,\nm(Q) = m0 ln(Q0/\u039b) ln(Q/\u039b) 12/(33\u2212nf) , (359)\nwhere m0 is the input mass at the reference scale Q0, and nf is the number of active flavours in calculating \u03b1s. For the light quarks, Q0 is set at 2 GeV, while for the c, b, and t quarks Q0 is set at m0. The input masses can be configured with the parameters ParticleData:mXRun, where X is the quark name, i.e. either d, u, s c, b, or t, to be put equal to the MS mass of the quark. The reference value of \u03b1s used in calculating \u039b is defined at the scale mZ and set with the parameter ParticleData:alphaSvalueMRun.\nThe default masses of unobserved hadrons and diquarks have been set using the constituent mass model from PYTHIA 6 [14, 379], which considers the spin-spin couplings of the quark combinations. The semi-empirical formula for a hadron mass is given by,\nm= m0 + \u2211\ni\nmi + k m 2 d\n\u2211\ni< j\nSi j mi m j , (360)\nwhere the terms m0 and k are determined from known hadron masses and depend upon the multiplet of the hadron, mi are the constituent quark masses, and Si j are the spin-spin interactions for each quark-pair combination. The constituent quark masses are taken from PYTHIA 6 as 0.325 GeV for the u and d, 0.5 GeV for the s, 1.6 GeV for the c, and 5 GeV for the b. Since the t does not form narrow bound states, the t constituent mass is not needed.\nFor mesons and diquarks, there is only one quark pair, given by q1 and q2. For diquarks and meson multiplets with orbital angular momentum L = 0, the spin-spin term for S = 0 states is S12 = \u22123, while for the S = 1 states this term is S12 = 1. For both pseudoscalar and vector mesons, m0 is set to 0 GeV and k is fitted to be 0.16 GeV. For the excited multiplets with L = 1, the spin-spin terms vanish with k set to 0 GeV and m0 fitted to be 0.45 GeV, 0.5 GeV, 0.55 GeV, and 0.6 GeV for scalars, S = 0 axial-vectors, S = 1 axial-vectors, and tensors, respectively. The masses of diquarks are calculated using the same k value as for baryons, 0.048 GeV, and m0 = 0.077 GeV which is two-thirds the baryon m0 value.\nThere are three possible combinations for baryons, and the spin-spin terms depend not only upon the spin of the baryon, but also the quark composition. For S = 12 baryons the\nspin-spin term is given by,\n\u2211\ni< j\nSi j mi m j = 1 m1m2 \u2212 2 m1m3 \u2212 2 m2m3 , (361)\nif there are either two identical flavours, q1 and q2, or all the quark flavours are different and the two lighter quarks are in an anti-symmetric spin state. For this anti-symmetric case q3 is the heaviest quark, while q1 and q2 are the two lighter quarks. When all the quarks are all different flavours and the light quark pair is symmetric, the spin-spin term is given by\n\u2211\ni< j\nSi j mi m j = \u2212 3 m2m3 , (362)\nwhere q2 and q3 are the two lighter quarks when relevant. For the S = 3 2 baryons, the spin-spin term is given by, \u2211\ni< j\nSi j mi m j = 1 m1m2 + 1 m1m3 + 1 m2m3 , (363)\nwhere the ordering of the quarks does not matter. For all baryons, the fitted parameters are set as m0 = 0.11 GeV and k = 0.048 GeV. The default masses for a number of baryons in PYTHIA are calculated using these factors and eq. (360). These baryons include the double and triple-heavy \u039e and \u2126 baryons."
        },
        {
            "heading": "8.1.2 Widths",
            "text": "Widths are relevant for sampling the masses of both resonances and particles. For particles, widths are fixed when sampling a particle mass except for the case of hadronic rescattering, see sections 7.4 and 8.2.3 for further details. The parameter ParticleData:modeBreitWigner determines what type of distribution is used to select particle masses. Note that this parameter is set for all particle species; it is not possible to choose different mass shapes on a speciesby-species basis. For a value of 0 the fixed on-shell particle mass is used, while for 1 a nonrelativistic Breit\u2013Wigner is used,\nP(m)dm\u221d 1 (m\u2212m0)2 + \u0393 2/4 dm . (364)\nBy setting a value of 2 a mass dependent width can be included,\n\u0393 (m) = \u03930\n\u221a \u221a \u221a\nm2 \u2212m2thr m20 \u2212m 2 thr , (365)\nwhere m is the selected mass, m0 is the on-shell mass, and mthr is the average threshold mass. The threshold mass is the sum of the on-shell masses for the decay products, and is consequently channel dependent. However, to decouple mass selection and decay, the mass threshold is taken as the average mass threshold for all decay channels, weighted by branching fraction.\nA relativistic Breit\u2013Wigner can also be selected,\nP(m2)dm2\u221d 1 (m2 \u2212m20)2 +m 2 0\u0393 2 dm2 , (366)\nwith the option 3, where a fixed \u0393 is used just as for option 1. The relativistic Breit\u2013Wigner can also be used with the mass dependent width of eq. (365) with option 4. For all mass selection\noptions, relativistic or otherwise, the mass distribution is truncated via the NN::mMin and NN:mMax parameters set for each particle species; here, NN is the given particle species ID. The default mass shape in PYTHIA is option 4, a mass-dependent relativistic Breit\u2013Wigner.\nFor particles with broad mass distributions that are not treated as resonances, the mass selection models above can distort the particle branching ratios. Regardless of the selected mass of a particle, all decay channels, even those with an on-shell mass threshold above the selected mass, are considered. Only after the masses for the decay products are sampled, are channels eliminated if not kinematically available. In this way, decay channels can remain open if there are downward fluctuations in the selected masses of the decay products. However, if the mass distribution for a particle is truncated at a lower mass, decay channels with lower mass thresholds may be enhanced. A good example is the \u03c10 which, as a broad low-mass resonance, has any number of non-perturbative and threshold effects. The mass distribution for the \u03c10 is limited by the rare e+e\u2212 decay channel. However, truncating the mass distribution at this mass threshold can result in oversampling the lighter decay channels. Consequently, the mass threshold for the \u03c0\u03c0 channel is used instead for the default low-mass truncation of the \u03c10 mass distribution.\nFor resonances, widths are sampled using the relativistic Breit\u2013Wigner of eq. (366), but with a number of options available for determining the partial widths of the resonance at a given mass. This calculation method can be set by the user with the NN:meMode parameter when defining the decay channels for a particle. The default value is 0, where the partial width is calculated perturbatively for the resonance if already available in PYTHIA. If a given width is not available via a perturbative calculation, then this width is set to zero. However, a number of alternative partial width calculations are available.\n\u2022 NN:meMode = 100: The partial width is defined as the branching fraction for that decay channel, multiplied by the total width. This method results in mass-independent widths and does not account for mass-threshold effects, which may result in issues when a resonance is produced significantly off-shell with a mass below the on-shell mass. When this occurs, it is possible that no decay channels remain kinematically open, and the resonance can no longer be decayed. However, it is also possible that downward mass fluctuations may occur in the masses of the decay products, allowing some channels. Consequently, all decay channels are considered whenever a resonance is decayed, even if the on-shell masses of the products kinematically exclude the channel.\n\u2022 NN:meMode = 101: The partial widths are calculated in the same fashion as for NN:meMode = 100, but are now set to zero if the sum of the on-shell masses for the decay products is not kinematically allowed at the mass for which the partial width is being calculated. Consequently, the total width becomes mass dependent through the introduction of step functions at the kinematic limits for each decay channel.\n\u2022 NN:meMode = 102: This method builds upon the method of NN:meMode = 101 but uses a smooth threshold factor, rather than a step function. For two-body decays the partial width is multiplied by the factor,\n\u03b2 = q\n(1\u2212m21/m2 \u2212m 2 2/m 2)2 \u2212 4m21m 2 2/m 4 , (367)\nwhere mi are the masses of the decay products and m is the selected mass of the decaying resonance. While this correctly includes the phase-space suppression for an isotropic two-body decay, any channel specific modifications due to the matrix element for the decay are not included. For higher multiplicity decays, a less sophisticated factor of,\n\u03b2 = \u221a \u221a 1\u2212 \u2211\ni\nmi/m , (368)\nis used which roughly approximates the phase-space suppression. For this method, the branching ratio for each decay channel should be provided without a phase-space suppression factor, otherwise phase-space suppression for that channel will be double counted. When using this method, the branching fractions for the resonance as calculated by PYTHIA will not match those provided by the user.\n\u2022 NN:meMode = 103: The phase-space suppression of NN:meMode = 102 is used, but the branching fraction for the channel is divided by the \u03b2 factor calculated at the onshell mass of the resonance, \u03b2\u221210 . Consequently, the branching fractions no longer need to be adjusted for phase-space suppression, and the branching fractions calculated by PYTHIA will match those provided by the user. However, in some cases \u03b2\u221210 can be very large if a channel is very near threshold for the nominal mass of the resonance. The parameter ResonanceWidths:minThreshold defines the minimum allowed \u03b20 and limits the correction for resonance masses well above the on-shell mass.\nNote that it is possible to mix and match partial width calculation methods for a given resonance, i.e. some decay channels may have their partial width calculated perturbatively, while the methods outlined above are used for others."
        },
        {
            "heading": "8.1.3 Lifetimes",
            "text": "While the lifetime of a particle is inversely related to its width, decoupling the lifetime and width of a particle is oftentimes useful for practical purposes. Consequently, both the lifetime and the width of a particle species can be specified independently in PYTHIA. The lifetime is given as the nominal proper lifetime multiplied by the speed of light, c\u03c40, and has units of millimetres. For particles with a non-zero lifetime, a lifetime is sampled according to an exponential decay, P(\u03c4)d\u03c4\u221d exp(\u2212\u03c4/\u03c40)d\u03c4 , (369) where the \u03c40 used here is not calculated from the width, but rather specified independently. When the hadronic-rescattering framework is enabled and the independently provided \u03c40 is zero, the nominal proper lifetime is automatically calculated using the width, if the particle species has at least a single available decay channel. See section 7.4 for details. Similarly, missing lifetimes are calculated when vertex positions and rapid hadron decays are enabled in the hadronization. For resonances, \u03c40 is automatically determined from the calculated width of the resonance. However, in some cases very long lifetimes are necessary, which could result in such narrow widths that the calculation of the cross section becomes numerically unstable. Here, the width and lifetime for a resonance can be made independent by setting the flag NN:tauCalc = false for that resonance. This can be particularly useful when scanning lifetime space for BSM resonances.\nAfter the lifetime for a particle or resonance is selected, the decay vertex position is calculated as,\nxdec = xpro +\u03c4 p m , (370)\nwhere m is the mass of the particle, p the momentum, and xpro the production-vertex position that may be either the primary interaction point or from some previous decay. This treatment of the decay vertex assumes all particles travel without interaction, including no magnetic fields or interactions with detector materials. Consequently, decay chains can be stopped to allow the subsequent decays of the particles to be handed to a detector simulation. A number of criteria for stopping decays is available. Particles with a specified minimum nominal lifetime can be stopped from decaying with the flag ParticleDecays:limitTau0. Similarly, particles with a selected lifetime greater than a configurable minimum lifetime can be set stable\nwith the ParticleDecays:limitTau flag. Particles can also be limited from decaying geometrically, either within a sphere with ParticleDecays:limitRadius, or within a cylinder with ParticleDecays:limitCylinder."
        },
        {
            "heading": "8.2 Decays",
            "text": "Particle decays might at first appear to be one of the simpler components of PYTHIA, given the clear factorization between the production and decay of particles. The masses, widths, and decay channels for most particles can be set directly to experimentally observed values, and typically do not require sophisticated calculations. Once this information is provided, a particle can be decayed by randomly selecting a decay channel with a weight proportional to its branching fraction, and then distributing the products of the selected channel according to phase space. However, there are a number of complications which require modifications to this initial approach.\nThe technical generation of phase space for decays with more than three products can be non-trivial to perform efficiently, and requires the use of specialized algorithms such as the M-generator or RAMBO, which are introduced in section 2.2.4. After phase-space generation, a matrix-element weight can be applied to ensure the correct kinematic distribution, given the nature of the decay. For particles with non-zero spin, spin effects can change the kinematic distribution not only for a single decay, but also between correlated decays. Finally, additional photons need to be probabilistically included in radiative decays.\nAll these complications assume the decay channel is exclusive, i.e. the number and type of decay products is fixed. For many decays, such as those of charm and bottom hadrons, this is not the case. A full list of the available decays are provided in table 2. About 40% of decay channels in PYTHIA have dedicated matrix elements, corresponding to 50% of decays when weighted by branching fraction. The remainder of this section describes these decays."
        },
        {
            "heading": "8.2.1 Hadron decays with parton showers",
            "text": "The decays of many particles are not known in an exclusive hadronic form but instead, the relative rates between exclusive partonic channels is known. Consequently, it is necessary to evolve these exclusive partonic decays into final state hadrons. In PYTHIA there are two mechanisms for this evolution. In the first method, the partons are passed to the timelike parton shower of section 4, followed by the hadronization of section 7.1. This method is used for bb states, and typically the parton shower does not significantly modify the decay. By default, the partons produced in the decay are distributed uniformly in phase space, with the notable exception of NN:meMode = 92 detailed in section 8.2.4 and NN:meMode = 94 detailed in section 8.2.6.\nA number of parton and colour configurations are available for this type of inclusive decay via the parton shower as follows. Here, ci is used to indicate a colour index and c\u0304i anti-colour index.\n\u2022 qq: The quark carries c1 the antiquark c\u03041. This type of decay is set with NN:meMode = 91. Examples of decays using this matrix element mode are \u03a5 \u2192 qq. Hidden valley hadrons also heavily utilize this decay.\n\u2022 gg: The first gluon carries c1 and c\u03042 while the second gluon carries c2 and c\u03041. This decay is also specified by NN:meMode = 91 and is primarily used for quarkonia, e.g. \u03b7b\u2192 gg.\n\u2022 ggg: The first gluon carries c1 and c\u03042, the second c2 and c\u03043, and the third c3 and c\u03041. This configuration is intended for the decays of quarkonia, e.g. Upsilon\u2192 ggg, and set with NN:meMode = 92.\n\u2022 gg\u03b3: The first gluon carries c1 and c\u03042 and the second c2 and c\u03041. This decay is also intended for quarkonium decays, e.g. \u03a5 \u2192 \u03b3gg and is set with NN:meMode = 92.\n\u2022 qqX : This is the same as the colour-singlet qq decay mode, except with an additional colour singlet X , and is selected with NN:meMode = 93 for flat phase space, and NN:meMode = 94 for a weak decay.\nFor all of these decays, the ordering of the partons as passed to PYTHIA does not matter."
        },
        {
            "heading": "8.2.2 Inclusive hadron decays",
            "text": "The second method for inclusive hadronic decays is to first determine hadrons from the partons and then distribute these hadrons in phase space. This method is used primarily for multibody decays of hadrons such as the D and B mesons, where only a few channels are known experimentally. The flavours for a channel can then be dynamically built from the initial partonic content of a weak decay. For this type of decay, either one or two parton pairs can be specified in the decay, in addition to any non-parton particles. Here, a parton is either a quark or diquark. The number of final particles is determined from a Poisson distribution with a mean of,\n\u03bb= nknown + nspec\n2 + npartons 4 +\u03c1mult ln(mdiff/mmult) , (371)\nwhere nknown is the number of non-partonic particles in the specified decay, nspec is the number of spectator partons, and npartons is the number of partons. Here, the spectator partons are those partons that do not participate in the partonic weak decay. The mass mdiff is the difference between the decaying particle mass and the sum of the nominal decay-product masses. A reference mass mmult is set by the parameter ParticleDecays:multRefMass and can be used to tune the average decay multiplicity. An additional factor, \u03c1mult, also determines the average decay multiplicity and is set via the parameter ParticleDecays:multIncrease for all relevant matrix-element modes except NN:meMode = 23 where ParticleDecays:multIncreaseWeak is used instead. See section 8.2.6 for further details.\nThe method for selecting the final hadrons is as follows.\n1. The multiplicity is selected according to eq. (371) and is required to be less than 10. A minimum multiplicity can be required by setting the NN:meMode between 42 and 50, where the minimum multiplicity is given by meMode - 40. Alternatively, the multiplicity can be fixed by setting the NN:meMode between 62 and 70. Here the multiplicity is calculated as meMode - 60.\n2. The number of hadrons to form is the difference between the selected multiplicity from the previous step, and the number of non-parton particles in the decay.\n3. One of the partons is selected at random and a new parton and hadron is formed, following the flavour selection of section 7.1.1.\n4. The previous step is repeated until the number of remaining hadrons to select is the same as the number of parton pairs.\n5. The remaining parton pairs are formed into hadrons.\n6. If there are two pairs, they may be reshuffled, as determined by the probability ParticleDecays:colRearrange, i.e. for a value of 0 the pairs will never be reshuffled but for a value of 1 they will always be reshuffled.\n7. If the mass of the final decay products is less than the decaying particle, the hadron selection is kept, otherwise the process begins again with step 1.\nThis model is very similar to the hadronization model, but the momenta of the hadrons is now just determined with phase space. For most decays this approximation is valid as the decay-product momenta should be very low and on average reproduce the correct kinematic behaviour. While the flavour selection is the same as for hadronization, the mass constraint of step 7 will typically bias decays to the lighter pseudoscalar mesons, particularly for high multiplicity decays.\nFor these types of inclusive decays, the special particle ID 82 can be used to randomly select a light flavour pair, i.e. uu, dd, or ss. The suppression of selecting an ss pair with respect to uu and dd is configured by the parameter StringFlav:probStoUD which is also used in the flavour selection of the hadronization algorithm of section 7.1.1. When specifying decays with this ID, the channel should be given as an 82 -82 pair, where the ordering does not matter. A similar ID is 83 which is the same as 82, but intended for decays that proceed through a gluon loop. Since this loop will increase the average multiplicity of the decay, eq. (371) is modified by adding an additional constant specified by the parameter ParticleDecays:multGoffset. The primary decay of the J/\u03c8 into three gluons, as well as many of the other onium states, use this special ID.\nFor some particles, exclusive decays must be specified in addition to inclusive decays. Matrix-element modes are provided in PYTHIA to prevent double counting the exclusive decays\nin the inclusive decays. An NN:meMode between 52 and 60 reproduces the same behaviour as an NN:meMode between 42 and 50, but will exclude any generated final state that matches a non-partonic decay channel. An example of such a decay is \u03b7c\u2192 qq. Similarly, if NN:meMode is between 72 and 80, the behaviour for meModes between 42 and 50 is reproduced, but again excluding any generated final state that matches a non-partonic decay channel."
        },
        {
            "heading": "8.2.3 Variable-width hadrons",
            "text": "For standard particle decays, the probability used to select a decay channel is calculated using a fixed branching ratio, independent of the decaying particle mass. The hadronic rescattering framework (cf. section 7.4), however, includes mass-dependent partial widths for two-body decays of hadrons. For hadrons included in the rescattering framework, decay channels are picked using these partial widths. The partial width for the decay of a hadron resonance H into particles A and B, H \u2192 AB, is given by,\n\u0393H\u2192AB(m) = \u03930 m0 m \u03a6(2l + 1, m) \u03a6(2l + 1, m0)\n1.2\n1.0+ 0.2 \u03a6(2l,m)\u03a6(2l,m0) . (372)\nHere, \u03930 is the nominal partial width of the decaying hadron at its nominal mass m0, set from experiment. The angular momentum of the two-body decay is given by l. In PYTHIA, this angular momentum is specified by the user as l = meMode\u22123. At high masses the final multiplicative factor regulates the partial width. Similar to resonance production, see section 8.1.2, these partial widths define not only the branching fractions of the hadron but also production.\nThe phase space is given by\n\u03a6(l, m) =\n\u222b\ndmA\n\u222b\ndmB q l(m, mA, mB)BW(mA)BW(mB) , (373)\nwhere q(m, mA, mB) is the magnitude of the A and B momentum in the centre-of-mass frame,\nq(m, mA, mB) =\np\n(m2 \u2212 (mA+mB)2)(m2 \u2212 (mA\u2212mB)2) 2m . (374)\nFinally, the mass distribution for each of the two decay products is given by a Breit\u2013Wigner,\nBW(m) = 1 2\u03c0 \u0393 (m)\n(m2 \u2212m20)2 + 1 4\u0393\n2(m) . (375)\nWhile this mass distribution does include a mass-dependent width, phase-space considerations ensure these mass-dependent widths can be evaluated recursively from the lowest mass particle to the highest. Note that performing decays with variable partial widths only affects the branching ratios of the decay channels, and not the angular distribution of the decay products. By default, a number of hadrons are decayed using variable partial widths in PYTHIA. This includes many of the excited mesons as well as a number of the baryons. For technical reasons, variable partial width decays are never performed for the \u03c1 or f2 mesons."
        },
        {
            "heading": "8.2.4 Strong decays",
            "text": "Most decays proceeding via the strong force in PYTHIA are modelled with pure phase space. However, there are four special cases that are generated according to matrix elements: isoscalar vector mesons decaying into pseudoscalar mesons, pseudoscalar mesons decaying into a pseudoscalar and vector mesons, pseudoscalar mesons decaying into a photon and vector meson, and vector mesons decaying into a three gluon final state.\nThe \u03c9 meson decays predominantly into a three-pion final state of \u03c0+\u03c0\u2212\u03c00. This decay can be modelled using the isobar model [380], where the decay proceeds via the intermediate \u03c10\u03c00 or \u03c1\u00b1\u03c0\u2213 state. The matrix element for this decay is given by\n|M|2\u221d (m1m2m3) 2 \u2212 (m1p2p3)2 \u2212 (m2p1p3)2 \u2212 (m3p1p2)2 + 2(p1p2)(p1p3)(p2p3) |F |2 , (376) where mi and pi are the mass and momentum of decay product i. Here, \u03c0 + corresponds to i = 1, \u03c0\u2212 to i = 2, and \u03c00 to i = 3. The function F includes possible final-state interactions of the pions, and depends upon the full kinematics of the decay. When no final-state interactions are present, F = 1, which corresponds to P-wave distributed phase space. In PYTHIA, this assumption of no final-state interactions is made. However, there is experimental evidence that final-state interactions could play an important role in this decay [381].\nThe \u03c6 meson is also an isoscalar like the \u03c9 meson and has a non-negligible branching to the \u03c10\u03c00 and \u03c1\u00b1\u03c0\u2213 channels, where the larger \u03c6 mass provides sufficient phase space for a \u03c1 resonance. However, a contact \u03c0+\u03c0\u2212\u03c00 decay, without the \u03c1-resonance structure, is also possible [382], and is described by the same matrix element as for the \u03c9 meson. The \u03c10 itself can also decay into a \u03c0+\u03c0\u2212\u03c00 final state described by this matrix element, although this decay channel is heavily suppressed due to phase space. For both the\u03c6 and \u03c10 mesons, no final-state interactions are considered in these decay channels. The matrix element of eq. (376) can be selected by setting NN:meMode = 1.\nIn the decay chain P0 \u2192 P1V2[\u2192 P3P4], where P is a pseudoscalar meson and V a vector meson, the decay products P3 and P4 are distributed in the rest frame of V2 according to cos\n2 \u03b8 , where \u03b8 is the angle between P0 and P3. The corresponding matrix element, is given by\n|M|2\u221d (p0p2)(p2p3)\u2212m22(p0p3) , (377)\nwhere again i specifies the particle in the decay chain, mi is the mass of that particle, and pi is the momentum. Similarly, for the decay chain P0\u2192 \u03b3V2[\u2192 P3P4], the distribution of P3 and P4 is now given by sin 2 \u03b8 in the rest frame of V2. The matrix element for this decay is,\n|M|2\u221d m22 2(p2p3)(p0p2)(p0p3)\u2212m2(p2p3)2\u2212m22(p0p3) 2\u2212m23(p0p2) 2+(mm2m3) 2 . (378)\nWhile these two matrix elements are relevant for all appropriately produced vector-meson decays into a pseudoscalar-meson pair, in practice the relevant vector-meson decay channels are: \u03c1 \u2192 \u03c0\u03c0, \u03c9 \u2192 \u03c0+\u03c0\u2212, K\u2217 \u2192 K\u03c0, \u03c6 \u2192 KK, \u03c6 \u2192 \u03c0+\u03c0\u2212, and D\u2217 \u2192 D\u03c0. Note that when the vector meson is not produced in the decay chain P0\u2192 P1/\u03b3V2, these matrix elements are not used. As an example, in the decay chain D\u2192 \u03c0K\u2217[\u2192 K\u03c0], the decay products of the K\u2217 are distributed according to eq. (377). To use these matrix elements, NN:meMode = 2 must be set.\nFor the decays of vector-like onium states into a partonic final state of gluons, V0\u2192 g0g1g2, or gluons and a photon, V0\u2192 \u03b30g1g2, the matrix element,\n|M|2\u221d 1\u2212 x1 x2 x3\n2\n+ 1\u2212 x2 x1 x3\n2\n+ 1\u2212 x3 x1 x2\n2\n, (379)\nis used. Here, x i is twice the energy of particle i divided by the mass of the decayer in the rest frame of the decayer, 2Ei/m. For the two gluon and photon decay, the two-gluon system is required to have a minimum mass configured by the parameter StringFragmentation:stopMass to ensure that the system can properly hadronize. This matrix element is set using meMode = 92 as is done for the partonic decays \u03a5 \u2192 ggg and \u03a5 \u2192 \u03b3gg. Because eq. (379) is symmetric, ordering of the decay products when configuring PYTHIA does not matter."
        },
        {
            "heading": "8.2.5 Electromagnetic decays",
            "text": "The electromagnetic decay \u03c00 \u2192 \u03b3\u2217[\u2192 e+e\u2212]\u03b3 can be generated with a factorized approach. To begin, the \u03b3\u2217 mass is selected, using the decay matrix element integrated over the solid angle, but still dependent upon the \u03b3\u2217 mass, m1.\n|M|2\u221d 1 m21 1+ 2m22 m21\n\u221a \u221a \u221a\n1\u2212 4m22 m21 1\u2212 m21 (m\u2212mmax)2 3 1 (m2 \u03c10 \u2212m21)2 +m 2 \u03c10 \u0393 2 \u03c10 . (380)\nThe subscript i is 0 for the \u03c00, 1 for the virtual \u03b3\u2217, 2 for the e+, 3 for the e\u2212, and 4 for the real \u03b3; the mass for each particle is given by mi and mmax is the maximum mass of the offshell photon, i.e. mmax = m4 = 0 for this decay channel of the \u03c00. The final factor of this expression is the VMD propagator for the \u03c10, where m\u03c10 is the mass of the \u03c1\n0, and \u0393\u03c10 the width. This propagator is negligible for any decaying particle with a mass far from the \u03c10 mass, which includes the case of the \u03c00. Next, after the \u03b3\u2217 mass is selected, the two-body decay of \u03c00\u2192 \u03b3\u2217\u03b3 is performed. Finally, the angular distribution of the e+e\u2212pair is generated according to,\n|M|2\u221d (m21 \u2212 2m22) (qp2) 2 + (qp3) 2 + 4m22 (qp2)(qp3) + (qp2) 2 + (qp3) 2 , (381)\nwhere pi is the momentum of the corresponding particle with index i, and q = p0 \u2212 p1. For efficiency and simplicity, this angular distribution is generated in the rest frame of the decaying particle, which if highly boosted, can result in minor numerical induced violations in momentum-energy conservation. Consequently, the momentum of the final lepton is calculated as p3 = p1 \u2212 p2 in the laboratory frame.\nThe matrix element for this decay channel is also valid for similar processes where a lepton pair, `+`\u2212, is produced via an off-shell photon. Such decay channels include \u03b7 \u2192 `+`\u2212\u03b3, \u03c9 \u2192 `+`\u2212\u03c00, \u03c6 \u2192 `+`\u2212\u03b7, B \u2192 `+`\u2212K/K\u2217, B0s \u2192 `\n+`\u2212\u03c6, and \u03a30 \u2192 `+`\u2212\u039b0. This matrix element can also be used for the final state `+`\u2212qq. In this particular case, the qq is converted into a single hadron, following the inclusive decay selection of section 8.2.2 but with the multiplicity of the decay fixed to three. In all the cases described above, the matrix element for these decay channels is set with NN:meMode = 11.\nThe form of eq. (380) and (381) are also approximately valid for decay channels with the final state \u03b3\u2217[`+`\u2212]AB . . ., where there are two or more decay products in addition to the lepton pair. Such decays include \u03b7 \u2192 `+`\u2212\u03c0+\u03c0\u2212, K0S \u2192 `\n+`\u2212\u03c0+\u03c0\u2212, B0 \u2192 `+`\u2212\u03c00\u03c00, and B+ \u2192 `+`\u2212us. For this type of decay channel, eq. (380) is still used to select the mass, but with mmax = mA + mB + . . ., and eq. (381) is used without modification. The phase-space generation, after selecting m1, is now performed as a decay with multiplicity n\u22121> 2, where n is the final multiplicity of the decay. Setting NN:meMode = 12 selects this matrix element. If A and B are replaced with a qq\u0304 final state, the system is collapsed down into two hadrons, with the flavour selection again performed using the inclusive decay algorithm but with the multiplicity fixed at four.\nFinally, these matrix elements are also used to approximate \u03b3\u2217[`+`\u2212]\u03b3\u2217[`+`\u2212] decay channels. Following the same numbering convention, the mass of the first off-shell photon, m1 is selected using eq. (380) where mmax = m5 + m6, i.e. twice the mass of the second lepton flavour. Then, the mass of the second off-shell photon, m3, is selected again with eq. (380) but using indexing i\u22122 and setting mmax = m2+m3. After performing the two-body decay of the \u03b3\u2217\u03b3\u2217 system, the angular distributions for the two lepton pairs are generated independently using eq. (381). This type of decay channel is specified with NN:meMode = 13 and can be used for decays such as \u03c00 \u2192 e+e\u2212e+e\u2212. The technical implementation for all decays using eqs. (380) and (381) require that the lepton pair should always be set as the final two decay products when defining these decay channels."
        },
        {
            "heading": "8.2.6 Weak decays",
            "text": "The helicity averaged matrix element for the t-channel weak scattering of fermions, f0f1\u2192 f2f3, is, |M|2\u221d (p0p1)(p2prem) , (382) where pi is the momentum of particle with index i and prem = \u2211\ni=3 pi is the sum of the remaining momenta, which here is just p3. By crossing symmetry, this matrix element can also be used for weak decays. An example is the fully leptonic decay of the \u03c4 lepton, \u03c4\u2212\u2192 \u03bd\u0304``\u2212\u03bd\u0304\u03c4. The particle ordering determines the corresponding i for each particle in eq. (382), e.g. i = 1 for the anti-neutrino and i = 2 for the charged lepton. This matrix element can also be used to approximate semi-leptonic decays of D and B mesons, e.g. D0 \u2192 `+\u03bd`\u03c0\u2212 or B0 \u2192 \u03bd``+\u03c0\u2212, where the final fermion pair is collapsed into a single hadron. In this example, the ordering of the neutrino and charged anti-lepton is swapped between the two decays. This is because for D-meson decays, the partonic f0 is a c quark, while for the B-meson this is a b antiquark. Similarly, this matrix element can be used for the semi-leptonic decays of baryons, e.g. n\u2192 \u03bd\u0304e\u2212p, or the leptonic decays of charged leptons, e.g. \u00b5\u2212 \u2192 \u03bd\u0304ee\u2212\u03bd\u00b5. When not using the sophisticated \u03c4 decays of section 8.2.8, this helicity averaged matrix element can also be used for the leptonic decays of the \u03c4.\nSemi-leptonic decays can also be specified with their partonic content, e.g. D0 \u2192 `+\u03bd`du or B0 \u2192 \u03bd``+du, where the ordering of the quarks does not matter. Similarly, baryon decays of this nature like \u039e0c \u2192 e\n+\u03bdes(sd)0, can be decayed using this matrix element where one of the partons is a diquark, i.e. (sd)0. When partonic content is specified, the parton system is collapsed to a single hadron following the flavour-selection rules of section 7.1.1. The matrix element of eq. (382) is used for all the decays described above by setting either NN:meMode = 22 or NN:meMode = 23. For these types of decays there is no difference between these two matrix-element modes. The only technical requirement for these decays is that the first two particles of the decay are the neutrino/charged-lepton pair, followed by either a hadron or a parton pair, where ordering of the partons does not matter. In some cases it is convenient to use the special particle ID 81 to act as a place holder for the spectator quark or diquark, which is then automatically replaced with the correct spectator flavour. For baryons, an ambiguity can arise in this selection where the spin of the diquark cannot always be determined uniquely. For the example decay of the \u039e0c given here, the spectator flavour can either be (sd)0 or (sd)1, while the automatic flavour will always select the (sd)0 diquark.\nIn some cases, semi-leptonic decays with more than one final-state hadron are needed, e.g. D0\u2192 e+\u03bdeK0\u03c0\u2212. The additional hadrons can be physically interpreted as being produced from the fragmentation of the spectator parton, resulting in hadrons with a significantly softer momentum than the hadron containing the spectator quarks. This softer momentum is modelled by taking the product of eq. (382) and an exponential damping factor,\n|Mdamp|2\u221d |M|2 \u220f\ni=4\ne\u2212|pi | 2/\u03c32soft , (383)\nwhich is calculated in the rest frame of the decay, where the product is taken over all hadrons following the spectator hadron with momentum magnitude |pi|. Here, |M|2 is calculated with eq. (382) and \u03c3soft is the damping term which can be configured by the user with the parameter ParticleDecays:sigmaSoft. A single damping parameter is used for all decays and is expected to fall within the range 0.2 \u2013 2, where a smaller value increases the damping. For semi-leptonic decays with two or more final state hadrons, this matrix element can be used by setting NN:meMode = 22 or NN:meMode = 23. Again, there is no difference between these two matrix-element modes for decays of this type. As before, the ordering of the decay as passed to PYTHIA matters. The neutrino/charged-lepton pair must be specified first, in\nthe correct order as discussed above, followed by the hadron containing the spectator quark, followed by any remaining hadrons, which will then have their momentum damped.\nThe matrix element for weak decays into purely hadronic final states, where the decay is defined only by partonic content, is approximated by PYTHIA. An example of this class of decay is B0 \u2192 udcd which will result in a final state with a D meson. The partonic content should be set as q1q2q3q4 where q1 and q2 are colour connected, and either q3 or q4 is the spectator quark/diquark. The special particle code 81 can be used here to automatically determine the spectator flavour. Just like for the partonic semi-leptonic decays, the final two partons are collapsed into a single hadron following the flavour-selection rules of section 7.1.1. The first two partons are then fragmented into multiple hadrons, following the method of section 8.2.2.\nWhen NN:meMode = 22 is used, the mean number of final particles in the decay is calculated with eq. (371) using the \u03c1mult parameter ParticleDecays:multIncrease. When NN:meMode = 23 is used instead, the mean number of final particles is calculated using ParticleDecays:multIncreaseWeak. The former parameter is intended, although not required, to be smaller than the latter, since in weak decays only the mass of the off-shell W boson is available to the fragmenting partonic system, and not the entire parent mass. Additionally, for NN:meMode = 23 a minimum of three final particles are required in the decay after flavour selection. After the final particles are determined for each decay, the matrix element,\n|M|2\u221d 2E1 m 3\u2212 4E1 m , (384)\nis used where m is the mass of the decaying hadron and E1 is the energy of the hadron containing the spectator quark, in the rest frame of the decay. This matrix element can also be used for hadronic \u03c4 decays when the sophisticated treatment is not needed by specifying NN:meMode = 21. Here, the first decay product should always be the \u03bd\u03c4, which increases the energy of the neutrino with respect to flat phase space.\nPartonic radiative decays via the weak force are roughly approximated with the matrix element,\n|M|2\u221d 2E1 m\n3\n, (385)\nwhere m is the mass of the decaying hadron and E1 is the energy of the photon in the rest frame of the decay. Effectively, this increases the photon energy with respect to flat phase space. The partonic content for these decays should be set as a photon, the spectator quark, and the flavour-changing quark, e.g. B0 \u2192 ds\u03b3 where d is the spectator quark. Unlike the previous weak decays, where the spectator system is collapsed to a single hadron, the spectator system is fragmented into multiple hadrons following the inclusive selection of section 8.2.2. However, the multiplicity for the decay is selected with a geometric distribution,\nP(n) = 1\u2212 1 2 n\u22121 1 2 , (386)\nrather than a Poisson distribution, where a minimum multiplicity of 2 and a maximum multiplicity of 10 is required. This type of decay is specified by setting NN:meMode = 31, and the decay products can be assigned in an arbitrary order.\nIn all the decays above, the matrix element is applied to the final particles of the decay, not the partonic content. In some cases it is useful to apply the matrix element to the partonic content of the decay, and then perform a full parton shower followed by hadronization, using the parton-shower method of section 8.2.1. Specifying NN:meMode = 94 does this, where the matrix element of eq. (382) is used to distribute the phase space of the partons from the decay.\nIn addition to the weak decays described above, B systems may mix prior to decay. This mixing is controlled by the flag ParticleDecays:mixB and has a probability of,\nP = sin2 x\u03c4 2\u03c40 , (387)\nwhere \u03c4 is the selected lifetime of the particle, and \u03c40 the nominal proper lifetime. The mixing parameter x is set with ParticleDecays:xBdMix and ParticleDecays:xBsMix for the Bd and Bs systems, respectively."
        },
        {
            "heading": "8.2.7 Helicity decays",
            "text": "A generic helicity-density formalism is available in PYTHIA which can be used for \u03c4 decays as well as muon decays in lepton-flavour violating production. External tools have also used this framework for heavy-neutral-lepton decays. The weight for an n-body decay of an arbitrary particle is given by,\nW = \u03c1\u03bb0\u03bb\u20320M\u03bb0;\u03bb1...\u03bbnM \u2217 \u03bb\u20320;\u03bb \u2032 1...\u03bb \u2032 n\n\u220f\ni=1,n\nD(i) \u03bbi\u03bb \u2032 i . (388)\nThe decaying particle is given index 0 and the decay products are assigned indices i through n. The helicity for each particle is given by \u03bbi and summations are performed over each repeated helicity index. The helicity density matrix for the decaying particle is given by \u03c1, while the decay matrix for each decay product is given by D. The helicity matrix element for the decay is M and depends upon the helicity of the decaying particle as well as the decay products.\nFor a particle produced from a 2 \u2192 n hard process, the helicity-density matrix for an outgoing particle with index i is given by,\n\u03c1 (i) \u03bbi\u03bb \u2032 i = \u03c1(1) \u03ba1\u03ba \u2032 1 \u03c1 (2) \u03ba2\u03ba \u2032 2 M\u03ba1\u03ba2;\u03bb1...\u03bbnM \u2217 \u03ba\u20321\u03ba \u2032 2;\u03bb \u2032 1...\u03bb \u2032 n\n\u220f\nj 6=i\nD( j) \u03bb j\u03bb \u2032 j , (389)\nwhere \u03c1(1,2) are the helicity-density matrices for the incoming particles, M is the helicity matrix element for the process, and \u03ba1,2 are the helicities of the incoming particles. For incoming two-helicity-state beam particles with a known longitudinal polarizationPz the helicity-density matrix is diagonal with elements (1\u00b1Pz)/2.\nBefore any particles are decayed in a given sequence, all decay matrices in eq. (388) and eq. (389), D, are initialized to the identity matrix. In a 2\u2192 n process, a first outgoing particle is randomly selected and decayed using a helicity-density matrix determined with (389). The decay matrix for this first decay is calculated as\nD(0) \u03bb0\u03bb \u2032 0 =M\u03bb0;\u03bb1...\u03bbnM \u2217 \u03bb\u20320;\u03bb \u2032 1...\u03bb \u2032 n\n\u220f\ni=1,n\nD(i) \u03bbi\u03bb \u2032 i . (390)\nAfter the full decay tree for this first particle is determined, the remaining particles for the 2 \u2192 n process are then randomly selected and decayed using the helicity-density matrix of (389) with the updated decay matrices for the already decayed outgoing particles.\nWhen a particle from the hard process is selected for decay, the full decay tree of that particle is performed. A single branch of the decay tree is followed until a final stable particle is reached. The helicity-density matrices for particles produced from decays are calculated with,\n\u03c1 (i) \u03bbi\u03bb \u2032 i = \u03c1(0) \u03bb0\u03bb \u2032 0 M\u03bb0;\u03bb1...\u03bbnM \u2217 \u03bb\u20320;\u03bb \u2032 1...\u03bb \u2032 n\n\u220f\nj 6=i\nD( j) \u03bb j\u03bb \u2032 j , (391)\nwhere the \u03c1(0) is the helicity-density matrix of the parent particle. The algorithm then calculates the decay matrix for the last particle decayed with eq. (390) and the next undecayed\nbranch of the decay tree is traversed until all branches of the decay tree have been decayed. In this way the decays of the outgoing particles from the hard process are correlated. As implemented in PYTHIA, this full recursion is not necessary since the implemented \u03c4 decays are typically provided with stable final-state particles.\nThe hard-process generation of PYTHIA uses unpolarized matrix elements to generate the phase space of the hard process, and so dedicated 2\u2192 n helicity matrix elements are needed to determine the helicity density matrix after phase-space generation. For \u03c4 decays a number of helicity matrix elements are available. Correlated decays from \u03b3, Z, Z\u20320, \u03b3/Z/Z\u20320, neutral Higgs bosons, and t-channel \u03b3\u03b3\u2192 `` production are provided. Single \u03c4 decays from W, W\u2032, charged Higgs bosons, and B/D decays are also provided. For all these production mechanisms the relevant parameters that can be configured for the unpolarized production mechanisms are also used in the helicity matrix elements. This includes the axial and vector couplings for the new gauge bosons, as well as the parity of the Higgs bosons. When a particle used in the helicity decay framework is provided from outside of PYTHIA, the SPINUP digit is interpreted as the helicity of the particle in the laboratory frame. A number of options can be configured to fine tune the helicity treatment of \u03c4 decays in PYTHIA."
        },
        {
            "heading": "8.2.8 Tau decays",
            "text": "While unpolarized simplified models of\u03c4 decays are available in PYTHIA, see section 8.2.6, dedicated models which use the helicity-density framework are available. These models are based on those provided in TAUOLA [383], and are available for all decay channels with branching fractions greater than 0.04%, including up to six-body tau decays. The general helicity-density matrix for these decays used in eq. (388) is given by\nM\u221d u\u0304\u03bd\u03c4\u03b3\u00b5(1\u2212 \u03b3 5)u\u03c4J \u00b5 , (392)\nwhere only the current J\u00b5 needs to be specified. Here, u and u\u0304 are Dirac spinors, \u03b3\u00b5 are the Dirac matrices, and the Weyl basis as adopted in HELAS [384] is used throughout.\nHere, a brief description of the available \u03c4 decays is provided; more details can be found in [392] with a summary given in table 3. Note that the ordering of the particles matters, and whenever numerical indices are used, 0 is the decaying \u03c4\u2212 while nu\u03c4 has index 1. For two-body decays into a neutrino and pseudoscalar meson, tau\u2212 \u2192 \u03bd\u03c4P, the hadronic current is given by,\nJ\u00b5\u221d p\u00b52 . (393)\nThe current for the fully leptonic three-body decay \u03c4\u2212\u2192 \u03bd\u03c4`\u2212\u03bd\u0304` is\nJ\u00b5 = u\u03042\u03b3 \u00b5(1\u2212 \u03b35)v3 . (394)\nThree-body decays with hadronic states can proceed via vector and scalar currents,\nJ\u00b5\u221d cv \u2211\ni wv i\n(p3 \u2212 p2)\u00b5 \u2211\ni\nwv iBWp(m2, m3, s2, mv i , \u0393v i)\n\u2212 s1(p2 + p3)\u00b5 \u2211\ni\nwv iBWp(m2, m3, s2, mv i , \u0393v i)\nmv 2 i\n+ cs \u2211\nj ws j (p2 + p3)\n\u00b5 \u2211\nj\nws jBWs(m2, m3, s2, ms j , \u0393s j) ,\nwhere ws, v i are complex weights for each vector and scalar current, cs,v are the scalar and vector couplings, and BWp is a P-wave Breit\u2013Wigner. The final state determines the relevant couplings and weights to use. The general form of the hadronic current for four-body decays is given by,\nJ\u00b5\u221d g\u00b5\u03bd \u2212 q\u00b5q\u03bd\ns1\n(F3 \u2212 F2)p2 + (F1 \u2212 F3)p3 + (F2 \u2212 F1)p4 \u00b5\n+ F4q \u00b5 + iF5\u03b5 \u00b5(p2, p3, p4) ,\nwhere each Fi is a model specific form factor and \u03b5 is the permutation operator. The hadronic current for the decay \u03c4\u2212\u2192 \u03bd\u03c4\u03b3\u03c00,\u03c0\u2212 is given by [383]\nJ\u00b5\u221d F(s1, ~m\u03c1,~\u0393\u03c1, ~w\u03c1)F(0, ~m\u03c1, ~G\u03c1, ~w\u03c1)F(s4, ~m\u03c9, ~G\u03c9, ~w\u03c9)\n\" \u00b5 2 m2\u03c0\u2212p4\u03bdp \u03bd 2 \u2212 p3\u03bdp \u03bd 2(p4\u03bdp \u03bd 3 \u2212 p4\u03bdp \u03bd 2)\n\u2212 p3\u00b5 (p3\u03bd\" \u03bd 2)(p4\u03bdp \u03bd 2)\u2212 (p4\u03bd\" \u03bd 2)(p3\u03bdp \u03bd 2)\n\u2212 p2\u00b5 (p3\u03bd\" \u03bd 2)(p4\u03bdp \u03bd 3)\u2212 (p4\u03bd\" \u03bd 2)(m 2 \u03c0\u2212 + p3\u03bdp \u03bd 2) ,\nwhere F is a sum over the possible vector currents including \u03c1 and \u03c9 resonances. The fivebody decays depend on sub-currents for each allowed resonance [390,393],\nJ\u00b5 \u03c00\u03c00\u03c00\u03c0\u2212 \u221d J\u00b50,a1\u2192\u03c1\u03c0 + J \u00b5 0,a1\u2192\u03c3\u03c0 ,\nJ\u00b5 \u03c00\u03c0\u2212\u03c0\u2212\u03c0+ \u221d J\u00b5\u2212,a1\u2192\u03c1\u03c0 + J \u00b5 \u2212,a1\u2192\u03c3\u03c0 + J \u00b5 \u2212,\u03c9\u2192\u03c1\u03c0 ,\nand are based in the Novosibirsk model. The six-body decay model [391] can be written as a summation of a and b-type currents,\nJ\u00b5\u221d \u2211 J\u00b5a + \u2211 J\u00b5b , (395)\nwhere each term is one of the possible final state permutations. The a-type currents proceed through a a1 \u2192 \u03c9\u03c1 resonance structure, while the b-type proceed via a a1 \u2192 \u03c3a1[\u2192 \u03c1\u03c0] structure.\nPart III\nUsing PYTHIA 8.3 PYTHIA 8.3 provides comprehensive choices for modelling all kinds of physics effects in collision experiments, as can be seen from the bulk of this manual. It is often not necessary to know the details of all components to start using the program to calculate useful quantities, however. The descriptions provided in this section should allow a new user to set up and use PYTHIA for most standard model and new physics processes, using default settings for showers, MPIs, and hadronization that have been tested to work at the LEP and LHC experiments. By extension, it should also be useful in many other contexts. All settings corresponding to particular physics models or to changing the \u201ctunes\u201d (i.e. parameter fitting for showers, MPIs, and hadronization) are documented in the HTML online manual, which is also distributed in the share/Pythia8/htmldoc/ directory of the released source code. One can begin browsing from the Welcome.html home page of that directory.\nPYTHIA is under constant and active development. Therefore, any specific detail of this article can become obsolete soon after it is released. We therefore urge users seeking specific information to:\n\u2022 Make sure to read the most recent version of this manuscript, in conjunction with the most recent code version. Some information, which may have been correct when the manuscript was obtained, may be outdated when being read.\n\u2022 Consult the HTML manual, which always contains specific settings and reasonable defaults for all physics processes, as well as suggestions for analyses. It also contains a detailed change-log documenting updates between code versions.\n\u2022 Use the examples distributed with the working version of PYTHIA for inspiration. Examples are kept up to date, and should always correspond to the program version downloaded.\nPast and present code versions, documentation, some relevant presentations, and more can be found at the PYTHIA website:\nhttps://www.pythia.org/\nIt is continuously kept up to date. In section 9 we will describe the logic behind using PYTHIA as a library to write a standalone analysis, and in section section 10 we describe interfacing to external programs."
        },
        {
            "heading": "9 Using PYTHIA stand-alone",
            "text": "The default way of using PYTHIA, is to use it as a C++ library, and write \u201cmain\u201d programs performing the desired simulation tasks. This can be done completely stand-alone, as PYTHIA in principle contains everything needed for a complete physics analysis. Several such example main\u2019s are shipped with PYTHIA in the examples/ sub-directory. In the following we will describe and exemplify how such user code can be written, and then go on to give more advanced use cases, covering deeper interactions with the simulation than allowed from an example main."
        },
        {
            "heading": "9.1 Installation",
            "text": "The latest version of PYTHIA 8.3 (as well as older versions) can be downloaded from https: //www.pythia.org/ as a gzipped tarball pythia83XX.tgz. On Unix, Linux, or MacOS systems this can be unzipped with\ntar -xvfz pythia8307.tgz\n(On Windows systems, we recommend to install a virtual machine running Linux, cf. e.g., this tutorial.) The simplest installation can be made using the standard commands\n./configure make\nConfiguration options (especially for linking against external libraries) can be found by typing\n./configure help\nDetails can also be found in the README file distributed with PYTHIA 8.3. If an install location is specified with prefix, then make install will copy libraries, headers, and shared documentation to that location in the standard Unix/Linux hierarchy. Details of the configuration can be accessed either via the generated Makefile.inc file or the pythia8-config script in the bin directory.\nMost users would then change to the examples/ sub-directory, find a suitable example to use as a template for their analysis, modify the desired parts, and compile and run the examples (say, main01) by:\nmake main01 ./main01\nIt is, however, also possible to compile and run PYTHIA programs outside the examples/ directory. Three environment variables could be potentially useful, providing the paths to the compiled libraries, and to the settings and particle properties databases,\nPYTHIA8PATH = <set to head Pythia directory> PYTHIA8DATA = $PYTHIA8PATH/share/Pythia8/xmldoc LD_LIBRARY_PATH = $PYTHIA8PATH/lib:$LD_LIBRARY_PATH"
        },
        {
            "heading": "9.2 Program setup",
            "text": "The simplest PYTHIA 8.3 user code comprises three main sections \u2014 initialization, the event loop, and final statistics. A skeleton of a simple program is as below. Note that the skeleton program should compile but not produce any reasonable output, as no reasonable settings are read in.\n#include \"Pythia8/Pythia.h\" // access to Pythia objects. using namespace Pythia8; // allow simplified notation.\nvoid main() {\n// --- Initialization ---\nPythia pythia; // Define Pythia object. Event& event = pythia.event; // quick access to current event.\n// Read in settings pythia.readString(\"...\"); // line by line... pythia.readFile(\"cardfile.cmnd\"); // or via file.\n// Define histograms, external links, // local variables etc. here. E.g. int maxEvents = 1000; // The number of events to run.\npythia.init(); // Initialize\n// --- The event loop ---\nfor(int iEvent = 0; iEvent < maxEvents; iEvent++){\n// Generate next event; // Produce the next event, returns true on success. if(!pythia.next()) {\n// Any error handling goes here. }\n// Analyse event; fill histograms etc.\n} // End event loop.\n// --- Calculate final statistics --- pythia.stat();\n// Print histograms etc.\nreturn; }"
        },
        {
            "heading": "9.3 Settings",
            "text": "The internal PYTHIA 8.3 event generation is divided into three steps:\n\u2022 Process level, dealing with the hard process.\n\u2022 Parton level, dealing with showers, MPIs, colour reconnection, and beam remnants.\n\u2022 Hadron level, dealing with hadronization and further decays of the particles produced.\nNaturally, there are specific settings to control each of these levels. Aside from this, there are several classes of settings to address output during initialization and generation of each event. In the following, we give an overview of how these may be used. However, the reader should consult the online manual (also accessible from share/Pythia8/htmldoc/Welcome.html distributed with the release) for a full listing of all available settings and options. Note that all possible setting keys are indexed, and can be searched via the Search Docs box in the upper-right corner of the page.\nIt is possible to run PYTHIA 8.3 entirely with the default settings. The only minimal user input required is the choice of production process. As a default, the incoming beams are both protons with a centre-of-mass energy of 14 TeV with the parton distribution function set to the NNPDF2.3 QCD+QED LO \u03b1s(MZ) = 0.130 one [229]. Furthermore, initial- and final-state radiation is turned on, using the internal PYTHIA simple shower. MPIs and hadronization are both on by default, and all unstable hadrons with c\u03c40 < 1000 mm are decayed to stable ones. The default tune is the Monash 2013 one [357], see section 9.9.2.\nPYTHIA 8.3 collects settings performing related functions into groups (e.g. overarching parton-level settings are named PartonLevel:*). Input strings for changing settings have the form\nsettingGroup:nameOfSetting = value\nFor example, decays of all resonances can be turned off by setting\nProcessLevel:resonanceDecays = off\nPYTHIA 8.3 supports four different types of settings:\n\u2022 flag is a boolean true or false. Acceptable input alternatives include on/off, yes/no, and 1/0.\n\u2022 mode is an integer switch enumerating either available options or a wider range of values. Acceptable values are integers.\n\u2022 parm is a real number parameter.\n\u2022 word is a character string. It cannot contain single or double quotation marks, or curly braces, i.e. { }.\nIt is further possible to have a vector of each of these types. If necessary, users can define their own settings that can then be used in their code.\nThe user can read in settings in one of two ways: either line-by-line with pythia.readString() calls inside the user C++ code, or by providing a plain-text file that is read at run time. The latter has the advantage of not requiring a recompilation every time a change is made. It is triggered by\npythia.readFile(\"cardfile.cmnd\");\ninside the code. All settings have reasonable default values enabled, and can furthermore be defined with maximal and/or minimal values beyond which they cannot be changed. These can be studied in the online manual under the respective parameter. A parameter can be forced outside the allowed bound by using the keyword force, for example:\nPhaseSpace:pTHatMinDiverge force= 0.1\nwill force the parameter PhaseSpace:pTHatMinDiverge, which usually has a minimal value of 0.5 GeV, to 0.1 GeV. The force keyword should be used with extreme caution! The boundaries are there for a reason, and breaking them can make the program unstable or invalidate the physics model.\nIf nothing else is mentioned explicitly, dimensional parameters have units of GeV for energy, momentum, and mass, and mm for length and time, with the speed of light c = 1 implicit. Internal cross sections are book kept in mb, but communication with other programs may require conversion from/to other units."
        },
        {
            "heading": "9.3.1 Beams and PDFs",
            "text": "The incoming beams are set by providing the PDG code of the incoming particles to Beams:idA and Beams:idB (the default for both is proton i.e. 2212). For example, a pp collision can be set by changing the value of Beams:idB to\nBeams:idB = -2212\nAn e+e\u2212 collision can be set by idA = 11 and idB = -11. Currently available beams include protons (2212), neutrons (2112), pions (\u00b1211,111), most other light hadrons (but not necessarily all combinations of them), electrons (11), muons (13), photons (22), and several heavy-ion species. The collision energy can then be set by\nBeams:eCM = 2000.\nUnits of GeV are implicit, as already mentioned. For heavy-ion collisions, this is the energy per nucleon-nucleon collision, as per the usual heavy-ion conventions.\nBy default, collisions are assumed to be in the CM frame. Other options can be set with Beams:frameType. Using option Beams:frameType = 2 the beam energies can be set separately and e.g. a HERA-like beam configuration can be obtained with\nBeams:frameType = 2 Beams:idA = 2212 Beams:eA = 920. Beams:idB = -11 Beams:eB = 27.5\nFurthermore, the beams do not need to be back-to-back but option Beams:frameType = 3 allows for setting also some transverse momentum for the beams. A particularly useful setting to automatically set beam information when using external LHE files (see section 10.1.1 for details) is\nBeams:frameType = 4\nIt is also possible to specify a simple Gaussian spread of incoming beam momentum and of the interaction vertex position. These can be set by Beams:allowMomentumSpread and Beams:allowVertexSpread and their accompanying parameters in the x , y , and z directions for each beam.\nThe applied proton PDF set can be selected with setting PDF:pSet which is also applied for antiprotons and neutrons via isospin symmetry. By default, this sets PDFs to be the same for beam A and B but it is also possible to set the PDFs for beam B separately using option PDF:pSetB. The internal PDF sets can be selected by setting an integer value for the above options, e.g. the current default is set with\nPDF:pSet = 13\nTo use LHAPDF grids instead, PYTHIA needs either be linked to the LHAPDF library or one can use the internal implementation for the LHAPDF grid interpolation, see see section 10.1.4. In the first case, the set is defined with a string LHAPDF6:set/member, e.g.\nPDF:pSet = LHAPDF6:NNPDF23_lo_as_0130_qed/0\nwhich would correspond to the current default above. Also LHAPDF version 5 is supported and enabled with keyword LHAPDF5:set/member. The internal interpolation for the LHAPDF 6 format is enabled with LHAGrid1:filename and with this, the default PDF can be obtained with\nPDF:pSet = LHAGrid1:NNPDF23_lo_as_0130_qed_0000.dat\nThe grid file should be located in the folder share/Pythia8/xmldoc or an absolute path should be provided. These settings change the PDF used throughout the program, including hard-process generation, MPIs, and ISR. To keep the underlying event description intact, one can also change the PDFs only for the hard processes by setting PDF:useHard = on and selecting the hard PDFs with PDF:pHardSet. All the above options can be used to select the PDFs for hard processes and one can also include nuclear modifications for these with PDF:useHardNPDFA = on or PDF:useHardNPDFB = on. Similarly, one can select PDFs for other beam types including pions, pomerons, photons, and leptons, see the online manual and section 3.12 for further details."
        },
        {
            "heading": "9.3.2 Process selection",
            "text": "The minimal initialization information required by PYTHIA 8.3 to generate events is which process(es) are to be run. This is done by turning on the relevant flags. For example, to generate a gg\u2192 qq hard process, set\nHardQCD:gg2qqbar = on\nA full list of internally defined processes is available in appendix A. It is possible to turn on more than one process at a time. PYTHIA 8.3 will then generate events for each process in proportion to their cross sections. Some extra switches are also available for processes that are often grouped together, e.g.\nHardQCD:all = on\nwill turn on all QCD 2 \u2192 2 quark/gluon production processes. Since these processes are divergent in the p\u22a5\u2192 0 limit, it is necessary to introduce a lower transverse-momentum cutoff PhaseSpace:pTHatMin. Note that such a parton-level cut does not directly translate into a cut on jet properties, since intermediate parton showers, MPIs, hadronization effects, and jet finders will distort the original simple process. Further details are available in sections 3.1 and 3.13.\nSeveral choices of renormalization and factorization scale are available. For 2\u2192 2 processes, these can be set via SigmaProcess:renormScale2 and SigmaProcess:factorScale2, respectively. The default for the renormalization scale is the geometric mean of the squared\ntransverse masses of the two outgoing particles. The default of factorization scale is set at the smaller of the two squared transverse masses. The possible options are listed in section 3.10."
        },
        {
            "heading": "9.3.3 Soft processes",
            "text": "The bulk of the total cross section in high-energy hadronic collisions is not associated with a visible hard process. A reasonably complete and consistent description of these relevant processes is instead obtained with\nSoftQCD:all = on\nThis includes elastic, single- and double-diffractive, and non-diffractive processes, which alternatively could be switched on individually. The inelastic processes, i.e. the diffractive and non-diffractive ones, include a modelling of MPIs, which does include a tail of high-p\u22a5 processes. Thus HardQCD:all becomes a subset of the SoftQCD:all total cross section, and one should not mix SoftQCD and HardQCD processes. Colour screening ensures that the hard processes here are damped appropriately at low p\u22a5 values, as described in section 6.2.\nAt very low collision energies the perturbative processes are gradually phased out and only truly soft processes remain. This occurs e.g. in hadronic rescattering, or in the final stages of the evolution of a cosmic-ray cascade in the atmosphere. To simulate low-energy collisions directly, use\nLowEnergyQCD:all = on\nor related LowEnergyQCD:* flags to turn on only a subset of the available processes. These are assumed to be accurate below 10 GeV. It is possible to simultaneously turn on both LowEnergyQCD:* and SoftQCD:* processes, in which case a mix of the two is used at intermediate energies.\nA number of other processes are available, including numerous non-QCD processes which may not be applicable for proton beams. See appendix A.1 for a complete list of included standard-model processes, and appendix A.2 for a list of BSM processes."
        },
        {
            "heading": "9.3.4 Parton- and hadron-level settings",
            "text": "The primary switches for parton showers are\nPartonLevel:ISR = on|off PartonLevel:FSR = on|off\nPYTHIA 8.3 has two other showers available, aside from the \u201csimple showers\u201d. The choice of shower model can be performed with\nPartonShowers:model = 1|2|3\nwhere the default (1) corresponds to the \u201cold\u201d simple shower, (2) corresponds to VINCIA, and (3) to the DIRE shower. Finally, the primary switch for hadronization is\nHadronLevel:all = on|off"
        },
        {
            "heading": "9.3.5 Particle data",
            "text": "All known information regarding particles (mass, charge, decay width, branching fractions, etc.) is stored within the ParticleData class. Each particle has the following basic properties:\n\u2022 id holds the PDG identity number of the particle.\n\u2022 name is a string containing the name of the particle. Particle and antiparticle names are stored separately, with void returned when no antiparticle exists.\n\u2022 spinType in the form of an integer equal to (2s+ 1).\n\u2022 chargeType is three times the electric charge.\n\u2022 colType is the colour representation (0: uncoloured, (-1)1: (anti-) triplet, 2: octet, (-3)3: (anti-) sextet).\n\u2022 m0 is the nominal mass in GeV.\n\u2022 mWidth is the Breit\u2013Wigner width in GeV.\n\u2022 mMin, mMax are the limits for mass generated by the Breit\u2013Wigner.\n\u2022 tau0 is the proper lifetime in mm.\n\u2022 mayDecay sets whether the particle is allowed to decay.\n\u2022 isVisible sets whether the particle is to be considered visible by the detector.\nOther than these, there are a few special properties related to external decays which can be found in the online manual. Any property of a particle can be changed by setting:\nNN:Property = value\nwhere NN is the PDG ID of the particle. The next critical piece of information for a particle is its decay table. The decay table is comprised of decay modes (or decay channels), each of which has the following properties:\n\u2022 onMode sets whether this decay channel is open where 0 is off, 1 is on, 2 on for the particle but not for the antiparticle, and 3 is on for the antiparticle but not for particle.\n\u2022 bRatio sets the branching ratio for the channel.\n\u2022 meMode sets how this decay is handled, in particular whether internal matrix element reweighting is available to account for mass or angular correlations. The default is 0 and corresponds to flat phase space. See table 2 for available matrix-element modes for particles and section 8.1.2 for available matrix-element modes for resonances.\n\u2022 multiplicity sets the number of daughters, the maximum allowed is eight.\n\u2022 product(i) is an array that holds the PDG IDs of the daughter particles; empty slots are set to zero.\nSeveral shortcuts exist to quickly set up the decay table of a particle. For example, deleting the existing decay table to start anew can be done by using the following.\nNN:oneChannel = onMode bRatio meMode product1 product2 ... NN:addChannel = onMode bRatio meMode product1 product2 ...\nBranching fractions are automatically rescaled such that the sum is one. Certain modes can be turned on or off based on the identity of the products by using the following shortcuts\nNN:offIfAny = product1 product2 ... NN:onIfAny = product1 product2 ... NN:onPosIfAny = product1 product2 ... NN:onNegIfAny = product1 product2 ...\nThis turns on the mode if any of the products in the list matches one in the product(i) array. Note that onPos... (onNeg...) above means that setting only applies to the decays of the (anti)particle. Further shortcuts (to select based on matching all products etc.) can be found in the online manual.\nAdding new particles can be done either by directly calling ParticleData::addParticle from the program or by using the SLHA interface with a QNUMBERS block (cf. section 10.1.2)."
        },
        {
            "heading": "9.4 Analysis of generated event",
            "text": "A generated \u201cevent\u201d is essentially a list of particles \u2014 initial, final, or intermediate \u2014 that are generated sequentially based on probabilistic calculations. A user will mostly be interested in studying kinematic variables constructed from the momenta of initial or final-state particles. The following three classes will be useful in constructing such variables. The full list of available classes and methods for analysing an event is available in the online manual.\n9.4.1 The Vec4 class\nThe Vec4 class is designed to hold the four-momentum (or indeed any other four-vector quantity that may be needed) of the particles in the collision event. Some useful methods are\n\u2022 px(), py(), pz(), e() to access the individual components.\n\u2022 mCalc() for calculated mass q\nE2 \u2212 p2x \u2212 p2y \u2212 p2z .\n\u2022 pT() and pAbs() for the transverse momentum and the absolute value of the threemomentum, respectively.\n\u2022 theta(), eta(), phi() for the polar and azimuthal angles, rapidity and pseudorapidity, respectively.\n\u2022 rot(double theta, double phi) to rotate the three-momentum.\n\u2022 bst(const Vec4& p) and bstback(const Vec4& p) to boost the current vector by ~\u03b2 = \u00b1 ~pE .\n9.4.2 The Particle class\nThe Particle class forms the fundamental particle unit, multiples of which are assembled in the form of an \u201cevent\u201d. Each Particle has the following properties:\n\u2022 id() for the PDG code.\n\u2022 status() for the status of the current particle (initial, final, stable, or intermediate etc., see the online manual for the full status codes). For most users, the only relevant check is, if the number is greater than zero, which denotes a stable, final-state particle. This can also be determined directly by asking isFinal().\n\u2022 p() returns a four-vector whereas px(), py(), pz(), e() can be used directly to access components.\n\u2022 mother1(), mother2() refer to the indices of the first and last mother, with several special rules. motherList() returns a vector of all the mother indices, circumventing the need to know these rules.\n\u2022 daughter1(), daughter2() refer to the indices of the first and the last daughter, with several special rules (all contiguous indices in between are daughters of said particle). daughterList() returns a vector of all the daughter indices, circumventing the need to know these rules\n\u2022 vProd() for the production four-vertex.\n\u2022 tau() is the lab-frame lifetime in mm/c.\n9.4.3 The Event class\nFinally, we come to the main result of the program which is held in a class called Event, representing a collision event. It contains a dynamic array (vector) of particles along with helper methods that are useful to extract information from the array. A single Pythia instance contains two Events, called process and event. The first of these, process, contains only the hard process whereas the second event contains the full history of the collision event. The user usually does not need to manually add or remove particles from either of these arrays. The individual particles can be accessed simply by using their index in the event (e.g. pythia.event[i]). All methods corresponding to the particle then can be accessed e.g. pythia.event[i].phi() accesses the azimuthal angle \u03d5. Some useful methods beyond those given for individual particles are:\n\u2022 detaAbs(int i1, int i2) and dphiAbs(int i1, int i2) to obtain \u2206\u03b7 and \u2206\u03d5 between two particles in the event.\n\u2022 REtaPhi(int i1, int i2) for the R distance between two particles.\nwith more given in the online manual. Several useful functions that take an Event as in input are available to the user to construct important quantities, e.g. SlowJet is a sequential clustering algorithm that can be used to form jets from final-state particles whereas Sphericity and Thrust classes calculate these inclusive variable."
        },
        {
            "heading": "9.5 Program output",
            "text": "The most basic level of output that can be requested is a listing of the full event (when inside the event loop), which is done simply by\npythia.event.list()\nA printout of the statistics, i.e. number of tried and accepted events, as well as the number of events produced for each process and the resulting cross section can be obtained by using\npythia.stat()\nFor hard processes with e.g. p\u22a5 cuts, the cross section must be calculated by Monte-Carlo integration. This is done automatically as events are generated. After generation, the total cross section and its statistical error can be accessed by calling respectively:\npythia.info.sigmaGen() pythia.info.sigmaErr()\nPythia also provides rudimentary built-in histogramming via the Hist class. The main methods of interest are\n\u2022 Hist(string title, int numberOfBins, double xMin, double xMax, bool logX) the constructor, defining a histogram.\n\u2022 fill(double value, double weight = 1.0) to fill the histogram with an optional weight.\n\u2022 table(string fileName, bool printOverUnder = false, bool xMidBin = true) to output the histogram as a table.\nPiping the histogram object directly to the standard output (std::cout < < myhist; ) will also give a rudimentary ASCII output of the histogram. There are methods that will also generate PYTHON PYPLOT code for cleaner graphical representations."
        },
        {
            "heading": "9.5.1 Messages, warnings, and errors",
            "text": "PYTHIA 8.3 provides four basic levels of diagnostic output that are available in the Info class. All such generated output is provided in a summary at the end of each run and can be useful as a sanity check or as debug information. The main categories are:\nAbort means that something went seriously wrong, either in initialization or generation. In the former case, event generation cannot begin. In the latter case, the event is flawed, and should be skipped. In either case the respective method Pythia::init() or Pythia::next will return false, to allow the user to react. There are occasions where an abort may be deliberate, such as when a file of Les-Houches events is read and the end of the file is reached.\nError typically means that something went wrong during event generation, but the program will backup and try again. In cases where this is not possible, a separate Abort will be issued. A typical run can issue several errors, without it being a problem, unless the program aborts. If encountering unusually many errors, it can be a good idea to check if any run parameters are set to unreasonable values, making a calculation unable to converge. The user can set the maximum number of errors to allow before the entire run is aborted via the Main:timesAllowErrors parameter.\nWarning is less severe. Typically the program will try again with a good chance of success. Usually no action needs to be taken by the user.\nMessage represents informative outputs that confirm e.g. reading of an external file. Verbosity of messages can be set separately for each module that provides this function (e.g. SLHA:verbose can be set to zero for a silent read.)"
        },
        {
            "heading": "9.6 Advanced settings examples",
            "text": "The example use cases given above, are enough for performing simple tasks with PYTHIA 8.3. In most cases, however, when a user wants to apply specialized built-in physics capabilities, the application is more complicated, generally scaling with the complexity of the required tasks. For this purpose, PYTHIA 8.3 ships with a large number of examples (in the examples/ sub-directory), intended to showcase various applications.\nIn this section we provide a thorough explanation of two such advanced use cases, to highlight the versatility of the distributed code. Settings for matching and merging are presented in section 9.6.1, while section 9.6.2 discusses options for changing the beam configuration on an event-by-event basis."
        },
        {
            "heading": "9.6.1 Matching and merging settings",
            "text": "PYTHIA 8.3 offers implementations of a large variety of matching and merging schemes. This allows both flexibility, but crucially also cross-checks of the results of combining fixed-order perturbative calculations with the event-generator machinery.\nPOWHEG matching allows for the combination of specialized next-to-leading order calculations with PYTHIA 8.3. To facilitate the matching, PYTHIA 8.3 offers vetoed parton showers via so-called PowhegHooks. This tool is available for the default showers as well as VINCIA11 and prevents the over counting of emissions. It can be enabled with the setting:\nPOWHEG:veto = 0|1\nSince it is not strictly guaranteed that the first shower emission can be considered the hardest emission according to the POWHEG criteria, the number of emissions to be subjected to vetoed showering can be adjusted by:\nPOWHEG:vetoCount = value\nFurthermore, vetoed showering only needs to be applied to Born-type configurations, which can be tagged by the minimal number of partons in the process:\nPOWHEG:nFinal = value\nVetoed showering relies on comparing the hardness of an emission to an allowed maximal hardness. The definition of \u201chardness\u201d is determined by:\nPOWHEG:pTdef = 0|1|2\nValues other than 1 are discouraged. The definition of the \u201cmaximal hardness\u201d can be adjusted with:\nPOWHEG:pThard = 0|1|2\nwhere values other than 0 only serve testing purposes. Finally, the setting:\nPOWHEG:pTemt = 0|1|2\n11For VINCIA, PowhegHooks should be swapped for PowhegHooksVincia. All settings listed here retain their importance with VINCIA. More details can be found in [189, appendix A].\ndetermines for which sets of particles the hardness comparison should be applied, with a value of 0 strongly recommended. A few further, more advanced, settings are listed in the online manual.\nMC@NLO matching employs shower-specific fixed-order calculations, which handle the overlap between shower and fixed-order calculation by explicit subtraction. When interfacing these calculations, it is paramount to guarantee consistency of settings between the fixed-order calculation and the parton shower, for any aspects that might have an impact at the NLO level. No new settings need be introduced in PYTHIA. The relevant settings to produce consistent results depend on the shower and the MC@NLO provider. When using MC@NLO inputs with PYTHIA\u2019s simple showers, a minimal set of consistent settings is:\nSpaceShower:pTmaxMatch = 1 SpaceShower:pTmaxFudge = 1 TimeShower:pTmaxMatch = 1 TimeShower:pTmaxFudge = 1 SpaceShower:MEcorrections = off TimeShower:MEcorrections = off TimeShower:globalRecoil = on TimeShower:weightGluonToQuark = 1\nPlease refer to the online manual for further details.\nCKKW-L merging allows for the combination of several multi-jet tree-level fixed-order calculations with each other and the wider PYTHIA 8.3 environment. For example, calculations of Drell\u2013Yan lepton-pair production at hadron colliders in association with zero, one, two, or more additional jets can be combined. In this context, \u201cadditional jets\u201d refers to further QCD partons, as well as W and Z bosons, in the case of simple showers and DIRE.\nThe inputs for multi-jet merging need to be regularized to avoid soft/collinear configurations. The regularization cut also acts as the criterion to distinguish between fixed-order and parton-shower phase space regions \u2014 the so-called merging scale. If the input events are regulated by a k\u22a5 cut, the following flag can be used to interpret the merging scale in terms of the k\u22a5 definition:\nMerging:doKTMerging = on|off\nFor the simple showers, the merging scale definition may also be set in terms of the shower evolution variable p\u22a5 by setting:\nMerging:doPTLundMerging = on|off\nIt must be emphasized that this option is naturally not available within VINCIA\u2019s merging. The simple shower also offers further built-in merging scale definitions, and the option to supply a pointer to a user-defined MergingHooks class to implement new merging scale definitions. The value of the merging scale separating fixed-order and parton-shower regions must be specified via the parameter:\nMerging:TMS = value\nThe merging further requires the definition of the \u201cprocess\u201d through the string:\nMerging:Process = value\nwhere value should identify the particles of the lowest-multiplicity process partaking in the merging. The process is used under the assumption that each event will contain exactly the specified particles, and potentially further particles that are considered as additional radiation. Looser process definitions are possible through the use of \u201cparticle containers\u201d, and the \u201cguess\u201d option, see the online manual. Finally, the number of additional jets must be set via:\nMerging:nJetMax = nJets\nOther settings are documented in the online manual.\nSector merging The VINCIA antenna shower in PYTHIA 8.3 comes with its own implementation of the CKKW-L merging algorithm, which differs from the one implemented for the simple showers. The main difference is that VINCIA\u2019s sector showers are maximally bijective, i.e. possess a minimal number of possible histories that lead to any given multi-parton configuration. As such, they are specifically designed for merging with high-multiplicity matrix elements for which the complexity grows factorially with the number of possible shower histories, cf. section 5.4.\nSector merging may be enabled by using VINCIA with its sector shower option turned on12\nand switching on merging:\nPartonShowers:model = 2 Vincia:sectorShower = on Merging:doMerging = on\nBy default, it is then assumed that the merging scale is defined in terms of VINCIA\u2019s evolution variable, cf. section 4.2. Other definitions (such as a k\u22a5 regularization) may be used via the appropriate settings listed for the simple showers above.\nWhile the merging-scale value and the number of additional jets must be set in exactly the same way as listed for the simple showers above, an important difference pertains to the syntax of the process definition. Different to the Merging:Process setting in the default merging implementation, the whole string must be encased in curly braces when using VINCIA:\nMerging:Process = { value }\nIn addition, particles must be specified one at a time and be separated by a white-space character. The initial and final state should be separated by > and exactly two initial-state particles must be specified. It must be emphasized that a process string in the \u201cdefault\u201d syntax cannot be processed by VINCIA and will lead to an abort.\nMore advanced settings can be found in the online manual.\nUMEPS merging extends CKKW-L tree-level merging, by ensuring that inclusive cross sections for n additional jets are not changed by the inclusion of calculations for m> n extra jets. This is achieved by introducing subtractions that act to remove the effect of higher-multiplicity events from lower-multiplicity inclusive cross sections. As an extension to CKKW-L, UMEPS shares the settings of the former. Beyond these settings, the different stages of UMEPS merging can be invoked by:\n12The sector shower flag is listed only for completeness \u2014 sector showers are switched on in VINCIA by default.\nMerging:doUMEPSTree = on|off\nwhich yield CKKW-L-reweighted tree-level results (up to small differences in Sudakov reweighting), and by:\nMerging:doUMEPSSubt = on|off\nwhich produce the necessary subtractions. Depending on the example main program, these two stages may directly be mixed internally, so that only the first setting may be necessary.\nNLO merging extends the leading-order merging machinery of PYTHIA 8.3 with (externally generated) next-to-leading order QCD event samples. As an extension of LO machinery, NLO merging inherits many of the settings of LO merging. The result of NLO merging is an inclusive calculation that recovers NLO QCD accuracy for inclusive cross sections with n \u2264 nNLO additional partons, and LO (QCD) accuracy for inclusive cross sections with nNLO < m \u2264 nLO jets. The maximal number of jets for which NLO samples are available (n \u2264 nNLO) has to be set by using:\nMerging:nJetMaxNLO = value\nPYTHIA 8.3 offers two NLO merging schemes as part of its core code: NL3 and UNLOPS. Other NLO merging schemes (such as the FxFx scheme) can be embedded with the help of UserHooks. NL3 merging is a straight-forward extension of CKKW-L, and mixes augmented CKKW-L-reweighted tree-level events with events from NLO samples. The reweighted LO stage is enabled by using the flag:\nMerging:doNL3Tree = on|off\nwhile the processing of NLO samples requires setting the switch:\nMerging:doNL3Loop = on|off\nTypically, NLO input samples contain not only NLO corrections, but tree-level contributions as well. If this is the case, then explicit removal of tree-level contributions from the NLO sample is necessary to avoid double counting. This subtraction is enabled by using the flag:\nMerging:doNL3Subt = on|off\nNote that this subtraction is not related to any of the UMEPS subtractions, but rather a necessity due to the structure of available inputs. NL3 only supports the use of the Merging:doPTLundMerging merging scale definition.\nUNLOPS merging is an extension of UMEPS that \u2014 like UMEPS at leading order \u2014 ensures that NLO inclusive cross sections are exactly retained, with the help of unitarity subtractions. Due to this, UNLOPS merging proceeds in four phases. The reweighting of tree-level inputs is enabled by:\nMerging:doUNLOPSTree = on|off\nwhile the processing of NLO samples is produced when using:\nMerging:doUNLOPSLoop = on|off\nBoth of the former stages should then be accompanied by subtractions to ensure the correctness of the inclusive cross section. Subtractive leading-order samples are produced when using\nMerging:doUNLOPSSubt = on|off\nwhile subtractive NLO events are enabled by:\nMerging:doUNLOPSSubtNLO = on|off\nDepending on the example main program, these two tree-level-dependent stages, as well as the two NLO-dependent stages, may directly be mixed internally, so that only the first two settings may be necessary in practice. UNLOPS supports the use of the Merging:doPTLundMerging merging-scale definition natively. Other merging-scale definitions (embedded by custom MergingHooks classes) can be enabled by setting\nMerging:unlopsTMSdefinition = value\nto a non-zero value."
        },
        {
            "heading": "9.6.2 Variable energies and beam particles",
            "text": "By default, the beam configuration is initialized at one specified energy. In some cases, however, one may need to generate events across a range of energies. In PYTHIA 8.3, this feature is enabled by setting\nBeams:allowVariableEnergy = on\nWhen this is enabled, the MPI machinery for SoftQCD will be initialized at a grid of energies ranging from 10 GeV up to the maximum energy specified by Beams:eCM. This way, interpolation can be used to efficiently find the relevant coefficients at each particular energy. (The LowEnergyQCD code is intended for energies below 10 GeV where MPIs are irrelevant, and no specific initialization is needed.) Events can then be generated using one of the variant Pythia::next methods below, corresponding to the kinematics setup specified by Beams:frameType. In other cases, it is also necessary to change the beam particle types on an event-by-event basis. One example of a relevant use case is hadronic cascades in a medium like the Earth\u2019s atmosphere or a particle detector. A number of settings must be explicitly switched on to enable this feature:\nSoftQCD:all = on LowEnergyQCD:all = on Beams:allowVariableEnergy = on Beams:allowIDAswitch = on\nThis will initialize the MPI machinery for a set of some 20 different common hadrons. To switch beam configurations, use one or more of the following variants of the Pythia::set methods\npythia.setBeamIDs( idA, idB = 0) pythia.setKinematics( eCM) pythia.setKinematics( eA, eB) pythia.setKinematics( pxA, pyA, pzA, pxB, pyB, pzB) pythia.setKinematics( pAin, pBin)\nthat match the Beams:frameType set. After calling these methods, all subsequent events called with next will use the updated configuration, unless the set call was unsuccessful. The first method preserves the kinematics of the previous event, modulo the change of masses. In this framework, currently only p/n/p/n is supported for idB. An optional parameter procType can be passed to next, and is used to generate an event of a particular type, such as non-diffractive or single-diffractive on a specified side.\nFor applications such as cascades in a medium, the decision whether a variable-type interaction should occur or not must be based on the relevant cross section. To this end, the parameterizations outlined in section 6.1.4 and section 6.1.5 can be accessed by using the\npythia.getSigmaTotal( idA, idB, eCMAB, mixLoHi = 0) pythia.getSigmaPartial( idA, idB, eCMAB, procType, mixLoHi = 0)\nmethods. Here, the default mixLoHi = 0 gives a smooth interpolation between the low-and high-energy descriptions.\nTypically, the MPI initialization is the slowest step also in a normal LHC run setup, and with variable particles and energies it will take several minutes. It is possible to speed up the initialization process by saving the MPI parameterizations to disk. This is done using the MultipartonInteractions:reuseInit option, which can take the following values:\n\u2022 0 (default): MPIs are reinitialized every time.\n\u2022 1: MPIs are reinitialized and the parameterization is saved to disk.\n\u2022 2: The MPI parameterization is loaded from disk. If the data file does not exist, initialization fails.\n\u2022 3: The MPI parameterization is loaded if the file exists, otherwise it is reinitialized and saved to disk.\nWhen using non-zero values, the file name MultipartonInteractions:initFile to save/load from must be specified."
        },
        {
            "heading": "9.7 Advanced usage",
            "text": "Often, the user might want to use PYTHIA to simulate physics effects that are not already implemented in the standard release. We therefore provide several ways of extending PYTHIA capabilities. The event generation process can be interrupted at various points (e.g. after hard scattering, after first branching in the parton shower, etc.) by using \u201cuser hooks\u201d. These can be used to reweight (or veto) events and change distributions accordingly. Additionally, any extra production process or decay of a new particle can be implemented by inheriting from PYTHIA classes that provide cross section calculation or decay width calculation machinery. We refer to any processes implemented this way as \u201csemi-internal\u201d. Finally, when extending capabilities, one may wish to have run-time user-input information in the same way as PYTHIA settings. We therefore provide some placeholder settings as well as methods to add custom settings keys that can be used to accompany any new functionality."
        },
        {
            "heading": "9.7.1 User-defined settings",
            "text": "Should the user require additional settings be provided via a card file, some spares have been made available following the same schema as the normal PYTHIA settings: three each (N = 1, 2, 3) of boolean flags via Main:spareFlagN; integer modes via Main:spareModeN; floating point parameters via Main:spareParmN; and strings via Main:spareWordN. These can all be set in the card file and interpreted by the user to suit their needs. To add completely new settings keywords, the user can use corresponding methods in the Settings class, e.g.\naddFlag(string key, bool default)\nto add a boolean, i.e. a Flag, and\naddParm(string key, double default, bool hasMin, bool hasMax, double min, double max)\nto add a double-precision parameter. For further fine-grained control or using the commaseparated vector type settings, we advise the user to refer to the methods documented in the Settings Scheme section of the online manual."
        },
        {
            "heading": "9.7.2 User hooks",
            "text": "User hooks are placeholders where the user can interrupt normal PYTHIA program flow to customize behaviour. The behaviour of the hook (i.e. the position in program flow where it is designed to interrupt) is set by functions of the type canVetoX where X indicates one of the pre-defined locations. An accompanying doVetoX is then executed during every instance of the X. A user defines a hook by creating a class inheriting from UserHooks, overriding one or more of the hook methods, and passing an object of that class to a Pythia instance:\npythia.setUserHooksPtr(make_shared<MyUserHooksClass>());\nIt is also possible to add more than one UserHooks object as follows:\npythia.addUserHooksPtr(make_shared<AnotherUserHooksClass>());\nNote, however, that this may give rise to ambiguities if several objects have overridden the same hook function. For the standard doVetoX functions, X will be vetoed if any of the objects veto, while for some hook methods for which it is not possible to deduce a reasonable combination. In the latter case, PYTHIA will issue a warning during initialization.\nPYTHIA provides user hooks for ten cases: interruption while switching between maingeneration levels (e.g. process to parton); during parton-level evolutions based on pT or after a step; vetoes for ISR or FSR emissions; to modify cross section or phase space sampling; after resonance decays; to modify shower scales; to allow colour reconnections; to enhance certain rare splittings (e.g. g \u2192 bb\u0304); and finally, to modify hadronization. The details of each of these hooks can be found in the online manual. Using these hooks to modify parton level emissions (e.g. to match matrix-element contributions from different orders) is discussed in section 9.8. Here we discuss a simple case of modifying a resonance decay (e.g. to select certain kinematics or decay modes). The Pythia::process event contains the hard scattering process and decay of resonances produced in the hard scattering. Defining:\nbool MyHook::canVetoResonanceDecays() { // By default returns false. // Set to true to run following method // after each resonance decay return true;\n}\nbool MyHook::doVetoResonanceDecays(Event& process){ // Look through the process to check // for desired characteristics. // Return false to accept the event. // Return true to veto the event. return false;\n}\nthis method can be used e.g. with an LHE file (an LHE event is always stored in the process before migrating it to the full event) that already has decayed resonances that are decayed again by PYTHIA."
        },
        {
            "heading": "9.7.3 Semi-internal processes and resonances",
            "text": "While PYTHIA provides a large number of models, built-in production processes and resonances, it is oftentimes necessary to either modify existing processes or add new ones. The class structure provided by PYTHIA can be easily inherited from to include new processes. Any new particles produced can be implemented as new resonances.\nFor a resonance, there are three levels of methods used when calculating decay widths in various channels. The first, initConstants() is run once per resonance and can be used to set couplings or any other properties that do not depend on kinematics. The second calcPreFac() has access to the kinematic configuration (masses of particles and phase-space variables), whereas the third, calcWidth() has access to all information and usually contains a case-wise calculation of the decay width in all channels. When there is no flavour-dependent factor in the calculation, calcPreFac() can be used to set the internal variable widNow (inherited from ResonanceWidths) which serves as the calculated width for a given channel. The example program main22 provides a working example of a new resonance.\nclass NewResonance : public ResonanceWidths {\npublic:\n// Constructor. NewResonance(int idResIn) {initBasic(idResIn);}\nprivate:\n// Locally stored properties and couplings. double coupling1, coupling2;\n// Initialize constants. virtual void initConstants();\n// Calculate various common kinematic factors // for the current mass. virtual void calcPreFac(bool = false);\n// Calculate width for each channel. virtual void calcWidth(bool = false);\n};\nOnce the resonance is set up, it can be added to the PYTHIA particle data table before initializing using\nResonanceWidths* newResonance = new NewResonance(pid); // Where pid is the integer PDG id. pythia.setResonancePtr(newResonance);\nThis will automatically call the relevant width calculation functions on initialization and calculate the total width of the particle based on all open channels. The use may have to set up the decay table (i.e. a list of open channels) using the commands in section 9.3.5 if the particle is not part of the PDG standard [35].\nOnce all new particles are set up, production modes can be set up by inheriting from PYTHIA\u2019s SigmaProcess class and its derivatives. For 2\u2192 1, use SigmaProcess, for 2\u2192 2 use Sigma2Process, and use Sigma3Process for 2 \u2192 3. All relevant kinematic variables are already set up and will be filled event by event based on PYTHIA\u2019s phase-space generator. The production process should be set up before calling init() in the main Pythia class. The kind of incoming particles needed for the production are set by the return value of inFlux(); options are qqbar, qqbarSame (same flavour qq), qg (qg and qg), ffbar (includes quarks qq and leptons `\u00af\u0300), gg (gluons), and a few more.\nclass Sigma1qqbar2NewResonance : public SigmaProcess {\npublic:\n// Constructor. Sigma1qqbar2NewResonance() {}\n// Initialize process. virtual void initProc();\n// Calculate flavour-independent parts of cross section. virtual void sigmaKin();\n// Evaluate sigmaHat(sHat). // Assumed flavour-independent so simple. virtual double sigmaHat() {return sigma;}\n// Select flavour, colour and anticolour. virtual void setIdColAcol();\n// Info on the subprocess. virtual string name() const {return \"q qbar -> NewResonance\";} virtual int code() const {return 10000;} virtual string inFlux() const {return \"qqbarSame\";} virtual int resonanceA() const {return 1000025;}\n// Set internally shared variables (like couplings) // as protected or private ...\n}\nSimilar to the new resonance-width calculation, there are three progressive methods that can be used to optimize running time. First, initProc() is called once per run and can be used to set constants or couplings based on input parameters. Second, sigmaKin() can be used to set up kinematic factors for unresolved processes that do not rely on flavour information of the incoming and outgoing states. Third, sigmaHat() can be used to calculate the full contribution of the phase-space point, which is returned as a double-precision floating-point number. The return value should be the value of d\u03c3d t for 2 \u2192 2 and |M|2 for 2 \u2192 3 processes, respectively. If the user wishes to input the matrix element squared instead of d\u03c3d t , then they should also override bool convertM2() to return true (see include/Pythia8/SigmaProcess.h for full class definition and explanatory comments). Finally, an important step before the process is usable is to set the incoming and outgoing colours (i.e. colour topology) and flavours where necessary.\nvoid Sigma1qqbar2NewResonance::setIdColAcol() {\n// Flavours simply to be copied from incoming // quark ids i.e. id1, id2 setId( id1, id2, idNew);\n// Colour flow topologies. Swap when antiquarks. // Say NewResonance is an octet // col1, acol1, col2, acol2, colRes, acolRes setColAcol( 1, 0, 0, 2, 1, 2); if (id1 < 0) swapColAcol();\n}\nThe new process can now be added to the PYTHIA process array by declaring:\nSigmaProcess* sigma1Res = new Sigma1qqbar2NewResonance(); pythia.setSigmaPtr(sigma1Res);"
        },
        {
            "heading": "9.7.4 Multithreading",
            "text": "In most cases, events are generated independently of each other. This means that in principle, event generation can easily be split across multiple threads in order to speed up generation.\nIn practice, each Pythia object contains an internal state, and is therefore not thread-safe. A straightforward workaround is to create multiple Pythia objects, each initialized with its own random seed using Random:seed and Random:setSeedon.\nStarting from PYTHIA 8.307, the PythiaParallel class provides a framework for doing this. This class is intended to provide a lightweight solution to easily enabling parallelism for simple studies. Objects of this class are constructed and initialized similarly to normal Pythia objects, but rather than having a next() method that generates a single event, it provides the run method, which generates a number of events in parallel. The way this works is that the PythiaParallel object creates and keeps track of a number of Pythia sub-objects. These sub-objects create events in parallel. Whenever an event is generated, the Pythia object that generated it is passed to the user so that the resulting event can be analysed. This process then continues until a required number of events has been generated, as specified by the Main:numberOfEvents setting. The following snippet gives an example of how to generate events using this class.\n#include \"Pythia8/Pythia.h\" // PythiaParallel.h must be included explicitly. #include \"Pythia8/PythiaParallel.h\" using namespace Pythia8;\nvoid main() { // The PythiaParallel object is created // and initialized as normal. PythiaParallel pythia; pythia.readString(\"SoftQCD:nonDiffractive = on\"); pythia.readString(\"Main:numberOfEvents = 10000\"); pythia.init();\n// Example: plot charged multiplicity Hist nCh(\"Charged multiplicity\", 100, -0.5, 399.5);\n// This defines the callback that will analyse events. function<void(Pythia& pythiaNow)> callback = [&nCh](Pythia& pythiaNow) { int nChNow = 0; for (int i = 0; i < pythiaNow.event.size(); ++i) if (pythiaNow.event[i].isFinal() && pythiaNow.event[i].isCharged()) nChNow += 1;\nnCh.fill(nChNow); };\n// Generate events in parallel, using // the specified callback for analysis. pythia.run(callback);\n// Print histogram. cout << nCh;\n}\nIn this example, the callback is defined via an anonymous function (also known as a lambda\nfunction). It would also be possible to define it as a named function, e.g. with signature\nvoid callback(Pythia& pythiaNow) ...\nThe advantage of using an anonymous function is that it can directly access local variables such as the nCh histogram, which is captured by reference according to the [&nCh] specifier. It is not necessary to actually save this anonymous function in the callback local variable. They can instead be passed directly to run, which would make the structure of the code more similar to running with Pythia::next. Further examples on using the PythiaParallel class are included with the PYTHIA 8.307 distribution.\nBy default, the framework tries to identify the number of available hardware threads and use the maximum degree of parallelism. Alternatively, the number of threads can be fixed using the Parallelism:numThreads setting. This can be useful in order to limit the computational resources spent on generation, and is mandatory on systems where the number of threads cannot be detected.\nAlthough event generation is done in parallel, the analysis is synchronized by default so that only one event is processed at the same time. In the example above, this ensures that it is not possible for two threads to simultaneously write to the nCh histogram. An illustration of this is shown in fig. 19. Usually, the analysis is much faster than the actual event generation, and this does not have a significant impact on the run time. However, if the analysis is slow or if the number of threads is very large, the different threads may spend a non-negligible amount of time waiting for other threads to finish the processing. In this case, the run time can be improved by setting Parallelism:processAsync = on, which will cause the generated events to be also processed in parallel. It is then up to the user to ensure mutually exclusive access to thread-unsafe resources such as histograms.\nIt is also possible to use external libraries to perform naive parallelization. Several examples using OPENMP are available in the PYTHIA distribution."
        },
        {
            "heading": "9.8 Event weight handling",
            "text": "By default, PYTHIA produces unweighted events. This means that every event produced by the generator represents an equal share of the total cross section of the chosen processes. However, some settings and functionalities require the use of weighted events. Weighted events no longer represent equal shares of the total cross section, but are augmented with a corrective event weight that needs to be taken into account when filling histograms of physics\nobservables. Event weights are useful in different scenarios, which are listed below. One of the key advantages is the use of parameter or setting variations. Rather than regenerating events for different settings and choices of parameters, a vector of corrective event weights can be included in the event generation, reducing the total computation time significantly compared to the generation of separate event samples.\nA detailed list of available event weights, related settings and how to access them is available in the online manual. In the following, we provide an overview of process-specific weights and how they can be accessed. Furthermore, we describe the automated-variation weights and the weight container, which collects all weights in a common structure."
        },
        {
            "heading": "9.8.1 Overview of process specific weights",
            "text": "PYTHIA collects the available event weights in a single nominal event weight, which is accessible through the Info::weight() function. In a usual setting, this weight is set to 1 and thus uninteresting. Several functionalities and settings lead to a modification of this weight though, in which case the weight must be included when filling histograms.\n\u2022 Biased phase-space point selection allows for the reduction of statistical fluctuations for specific kinematic configurations. The corrective weight needs to be included to ensure that the overall distributions are not changed.\n\u2022 If Les-Houches events are used as input, some strategies allow for negative weights, which will be included in the event weight and need to be taken into account. For the strategies 4 and \u22124, the event weight has units pb, and is converted to mb upon output.\n\u2022 For heavy-ion collisions, PYTHIA allows a Gaussian sampling of the impact parameter space, leading to weighted events.\n\u2022 In rare cases, the initial over-estimate of the differential cross section might for specific phase-space points lie below the correct differential cross section. In these cases, a weight above 1 is provided to compensate for this violation.\n\u2022 Enhanced parton-shower emissions (cf. section 4.1.5) need to be corrected for with a weight to ensure that the distributions remain unchanged when improving the statistical relevance of rare emissions.\n\u2022 Multi-jet merging requires event weights to account for Sudakov factors and the running of coupling parameters. For the leading-order merging schemes CKKW-L and UMEPS, these are by default included in Info::weight(). For the next-to-leading-order multijet merging schemes NL3 and UNLOPS, the merging weight needs to be included and is available from Info::mergingWeightNLO()."
        },
        {
            "heading": "9.8.2 Automatic weight variations",
            "text": "In addition to the nominal weight, additional weights can be provided to take into account variations of settings and parameters. Filling histograms with these respective weights allows for an estimation of the corresponding distributions without rerunning PYTHIA. Additional variation weights are available from the parton shower, multi-jet merging and external LHEF input.\nThe parton shower currently allows for renormalization-scale variations and non-singular term variations in both initial- and final-state radiation, discussed further in section 4.1.5. Besides, it allows for the variation of PDF members of LHAPDF 6 families. Details on the\nusage of these variations can be found in the online manual. The physics background is described in [20].\nThe multi-jet merging schemes CKKW-L, UMEPS, NL3, and UNLOPS also allow for renormalization-scale variations. Furthermore, variations of the UNLOPS merging scheme itself are available. For details, see [185] and the online manual. The renormalization-scale variations in the merging are automatically combined with corresponding variations from LHEF input and the parton shower.\nWith the availability of variation weights from different sources, PYTHIA 8.3 introduces a common structure, the weight container, to make all these weights available to the user. This structure is also used for writing available event weights to HEPMC output. The naming conventions are based on [394, p. 162]. If multi-jet merging is activated, combined weights for renormalization-scale variations in LHEF input, parton shower, and merging are included. Custom weights from LHEF input or the parton shower are presented with a prefix to emphasize that further processing or combining might be necessary. While HEPMC output automatically contains these variation weights, the user can access them directly through the following methods:\nint Info::numberOfWeights() string Info::weightNameByIndex(int i) double Info::weightValueByIndex(int i) vector<string> Info::weigthNameVector() vector<double> Info::weightValueVector()\nThe first entry of this weight vector, or correspondingly the weight with index 0 is the nominal weight, including the weights from all the above-mentioned sources."
        },
        {
            "heading": "9.9 Tuning PYTHIA",
            "text": "By default, PYTHIA 8.3 operates using a particular set of run-time parameters that determine the behaviour of the physics models. A set of parameters that is chosen based on a comparison of PYTHIA 8.3 predictions to data is generically named a \u201ctune\u201d. As the name suggests, the procedure to obtain a tune is similar to adjusting the pegs on a stringed instrument to achieve a certain sound. However, there is no universal agreement on what constitutes a good tune in contrast to a good sound. The goal of tuning is to find an \u201coptimal\u201d set of physics parameters, p\u2217, that minimizes the difference between the experimental data and the simulated data from the event generator. In practice, this difference is defined as follows:\n\u03c72MC(p, ~w) = \u2211\nO\u2208SO\n\u2211 b\u2208O wOb (MCb(p)\u2212Ob)2 \u2206MCb(p)2 +\u2206O2b , (396)\nwhere SO is the set of observables used in the tune, b \u2208 O denotes the bins in a certain observable O, and ~w is a vector of weights wOb for each bin of each observable. The\u2206s are the uncertainties on the simulated data and the observable. The weights wOb \u2265 0 reflect how much an observable contributes to the tune, i.e. if wOb = 0 for some Ob, then this observable bin will not influence the tuning of p, whereas if ~wOb = 1 then all data is treated equally. The choice of SO and wOb determines a unique tune, and these choices are driven by both theoretical and experimental considerations. The variable in eq. (396) is called a \u201cchi-squared\u201d, but due to the presence of weights there is no guarantee that it will have the properties of a proper \u03c72 distribution."
        },
        {
            "heading": "9.9.1 Comments on the tuning procedure",
            "text": "There are several aspects of this problem that make it non-trivial. One is that the model, which is a mixture of theoretically- and phenomenologically-grounded sub-models, does not describe all data equally well. Related to this is that there is no systematic method for predicting a priori where the model will fail \u2014 the sub-models are often deeply entwined and are not factorizable, despite our original intention that they should be. If one had a numerical estimate of the uncertainty coming from a certain model (not just its sensitivity to parameter variations, but an estimate of where it fails), then that could be included in \u2206MCb, which usually includes only the uncertainty arising from a finite number of simulation runs. Another issue is how the tune will be applied \u2014 will it be used for generic simulations with lowest-order matrix elements or with matched and merged predictions with higher-order matrix elements?\nThere is more than one way to attack these problems. One, as suggested above, is to set ~wO = 0 for some set of observables or analyses. Such a decision is made at the beginning of tuning when one decides which data is most relevant, e.g. Tevatron data or LHC data from a lower-energy run, minimum bias or inclusive jet data, etc. Data can also be removed from the tune when it becomes obvious they do not fall within the envelope of the model predictions. In practice, it is sometimes found that even problematic data should be included, with reduced significance, to improve the overall quality of the tune. This can be accomplished by adjusting some of the ~wO values to emphasize or de-emphasize certain datasets. Obviously, such a posteriori manipulation of data is subject to bias and abuse. However, one should remember that tuning is not hypothesis testing \u2014 we do not allow for the possibility that the model is ruled out. To illustrate two different, but not exhaustive, approaches, we will describe the MONASH 2013 and the ATLAS A14 tuning exercises."
        },
        {
            "heading": "9.9.2 The default PYTHIA 8.3 tuning: MONASH 2013",
            "text": "The MONASH 2013 tune is currently the default one. It was performed using data from HEPDATA and the PDG. It was aimed at non-diffractive, high momentum-transfer collisions using the leading-order matrix elements coded in PYTHIA. It started from the hypothesis that hadronization was independent of the environment, and the related physics parameters could be best constrained using e+e\u2212 data, particularly from LEP (for most observables) and SLD (for b-hadron specific observables). Any modifications to hadronization predictions from the breakup of the proton, for example, would be handled by explicit models that modified the initial conditions, but not the mechanism of hadronization. Once the observables were selected, all with either ~wO = 0 or 1,; several inconsistent values of particle yields were adjusted based on common sense. Physics parameters related to final state radiation, hadronization, and particle decays were selected using eq. (396) as a guide, but without an explicit global minimization. An additional ad hoc \u201ctheory uncertainty\u201d of 5% was added per bin of each histogram used in the tune to prevent overfitting. These parameters were then frozen as a particular eetune. The tuning of the remaining parameters, specific to hadronic collisions, began with a choice of PDF, which is an integral part of any such tune. The central tune of the NNPDF2.3 PDF set was selected, as it was being used in many other theory calculations at the time. In particular, the choice was leading order with a value of \u03b1s closer to that found in the eetune. The tuning of initial-state parameters, such as those related to initial-state radiation, beam remnants, and multiparton interactions, proceeded in a similar fashion using LHC data at the highest energy available. Scaling of the multiparton-interaction parameter was obtained by including Tevatron data. Again, at no point was a global optimization of parameters made based on minimization of a \u03c72."
        },
        {
            "heading": "9.9.3 The ATLAS A14 tune",
            "text": "The ATLAS A14 tune took a different approach. First, it took the basic MONASH 2013 parameters as a starting point, with the goal of optimizing parameters for LHC physics studies. It relied heavily on the PROFESSOR [395] framework. The observables were selected and weighted to emphasize high-p\u22a5 radiation and some top-quark observables. It was designed to be used for BSM physics searches, where precision was not the main goal. To that end, it minimized eq. (396) for ten parameters, but in an iterative process to select weights that produced a \u201creasonable\u201d fit. Using PROFESSOR, it also produced eigentunes that could be used as alternative tunes to study sensitivity to the PYTHIA parameters. However, because of the inclusion of weights, and since the fit residuals do not appear to be \u03c72 distributed, an ad hoc criterion was used to determine these variations. In the process of selecting data, many observables were included that are obviously highly correlated. However, those correlations were not reported consistently by the experiments. As a result, some of the observables have a hidden weight."
        },
        {
            "heading": "9.9.4 Automatic tuning approaches",
            "text": "Automatic tuning approaches can be helpful to circumvent some of the challenges that manual tuning entails, like subjectivity based on expert knowledge of models, parameters, constraints, and data, and challenges due to a high amount of data sets and parameters to be taken into account. Automatic tuning aims at simplifying the tuning procedure and making it more systematic, which is especially helpful when many parameters are to be tuned.\nA brute force grid-based tuning approach is usually prohibited due to the high computational cost of generator runs, especially if many parameters are to be tuned. To circumvent this problem, one can use iterative optimization approaches, which can take time due to the serial running with different parameters, but focus well on relevant regions in parameter space. Alternatively, one can attempt to parameterize the generator response, and to then optimize based on an interpolation. After an initial generator run, which can be trivially parallelized, the actual optimization based on the interpolation is much more straight forward.\nAs outlined in [396], an iterated Bayesian optimization approach can be employed for event generator tuning. A \u03c72 value for different parameter values is obtained, and all information is used to find the next set of parameters iteratively. This approach thus goes beyond local gradient-based optimization, balancing exploration and exploitation.\nThe PROFESSOR toolkit employs a parameterization approach. After an initial parallelized MC event-generator run, the generator response is parameterized using a polynomial function. A \u03c72 optimization is then performed based on this interpolation. This approach allows for several parameters, but becomes prohibitive if the parameter space becomes too large. It is then beneficial to tune in successive steps based on model and data knowledge.\nThere are multiple efforts in improving the PROFESSOR tuning approach. The AUTOTUNES method [397] employs PROFESSOR, and goes beyond by automatically identifying subsets of correlated parameters that can be optimized successively. The weights are chosen correspondingly to constrain sub-tunes by the most relevant experimental data. The APPRENTICE method [398] goes beyond PROFESSOR by allowing for more general interpolations, a larger variety of optimization methods, and automated setting of weights.\nAutomatic tuning methods can be very useful, and are helpful when many parameters are to be optimized based on a large amount of experimental data. In combination with expert knowledge about the tuned models and the experimental data, pitfalls can be avoided, like too strong constraints due to single well-measured distributions or unphysical tuning results."
        },
        {
            "heading": "10 Interfacing to external programs",
            "text": "In most realistic use-cases, PYTHIA 8.3 is not used stand-alone, but rather as part of a large software stack capable of providing everything from calculation of Feynman rules from a Lagrangian, to detector simulation and analysis, including interfaces between all those steps. Technically, PYTHIA 8.3 is a C++ library, and only the users\u2019 technical proficiency limits the ways the program can be interfaced to other code, thus a manual section describing external interfaces, will by definition be incomplete. For practical purposes, however, PYTHIA 8.3 comes with a number of interfaces pre-written, and several more with an official or unofficial \u201cblessing\u201d by the developers. These are interfaces which should in general work, and where the PYTHIA 8.3 developers will at take some responsibility for helping users when setting up. Those interfaces are described here, along with an explanation of how PYTHIA 8.3 is expected to interact with them. The section is sub-divided in four. In section 10.1 we describe file-based or run-time based interfaces to external providers of input to PYTHIA 8.3, be it external matrix elements, PDFs, or random numbers. In section 10.2 we describe the most often used output formats, such as HEPMC events or ROOT \u201cn-tuples\u201d. In section 10.3 we describe run-time interfacing with the analysis tools RIVET and FASTJET, and finally in section 10.4 the use of PYTHIA 8.3 through the PYTHON interface and on multicore HPC architectures is discussed."
        },
        {
            "heading": "10.1 Generation tools",
            "text": "Several file-based or run-time interfaces exist. For file-based interfaces, generation steps must be run in a strict sequence. For run-time interfaces, we take a PYTHIA-centric view, i.e. that PYTHIA controls the overall event generation (unless stated otherwise)."
        },
        {
            "heading": "10.1.1 Les Houches Accord and Les Houches Event File functionality",
            "text": "The Les Houches Accord (LHA) format [304] allows a factorized event generation chain and is one of the most long-lived and successful interface agreements in particle physics. Using the LHA format, complex perturbative calculations can be factored out from the rest of the event generation chain, and performed by specialized tools. The basic idea of LHA is a run-time interface between two generator codes: the \u201cfixed-order generator\u201d stores the collision setup and cross-section information in memory for the \u201cevent generator\u201d to read upon initialization (see table 4). At generation time, the individual phase-space points used in the fixed-order generator are stored in memory for the event generator to read and process further, cf. table 5 for the format definition. Originally, the in-memory structures were FORTRAN common blocks (called HEPRUP for initialization and HEPEUP for event information). This original format is still used in modern applications, e.g. the interfaces to MADGRAPH or POWHEG BOX discussed below. An example of another in-memory structure is discussed in section 10.1.3.\nAlthough desirable from a computing perspective, run-time interfaces require programming language-specific in-memory representations. The Les Houches event file (LHEF) format [305] is a text-file-based update and extension of LHA, such that no run-time interface is necessary, making the results somewhat more portable. Les Houches Event files provide pre-tabulation and storage of phase-space points, thus enabling the reuse of computationally expensive results.\nThe LHEF format defines XML-like \u201ctag\u201d structures to store information. As such, all relevant information in a LHEF file is enclosed in:\n<LesHouchesEvents version=\"v\"> ... </LesHouchesEvents>.\nThe version can be v = 1.0 [305] or v = 3.0 [394].\nThe HEPRUP initialization information of the LHA is mirrored by a text block bracketed with <init> ... </init>, while the HEPEUP event information is captured in a text block enclosed in an <event> ... </event> tag. Auxiliary information pertaining to all events can also be stored in a block bracketed with a <header> ... </header> tag. The content of each tag may contain further tags, see tables 6 and 7 for a list of all recognized tags.\nA basic example <header> block is\n<header> Some auxiliary information that ... is not parsed. </header>\nSuch a header would be compliant with all versions of the format. Additional tags may appear in later versions (v. 3) of the format, as shown in the example below\n<header> Some auxiliary information that ... is not parsed. <initrwgt> <weightgroup type=\"alphasVariation\"> <weight id=\"A\"> nominal alphas </weight> <weight id=\"B\"> decreased alphas </weight> <weight id=\"C\"> increased alphas </weight> </weightgroup> </initrwgt> </header>\nIn this particular example, PYTHIA 8.3 will be instructed to expect each event to contain a <rwgt> block that contains three <wgt> entries.\nIn a slight extension of the accord, PYTHIA 8.3 will also parse the parts of the <header> block that are enclosed in <slha> .. </slha> as if the block contained an SLHA file. See section 10.1.2 for a description of SLHA files.\nThe <init> block is a mandatory part of any LHE file. A basic example will contain the two beam-particle identifiers, their two energies in GeV, two PDF-author-group identifiers, two PDF-set identifiers, and weighting information, followed, in a separate line, by cross section, statistical error, and unit weight information, followed by an integer process label:\n<init> 2212 2212 0.4E+04 0.4E+04 -1 -1 21100 21100 -4 1 0.50109086E+02 0.89185414E-01 0.50109093E+02 1234 </init>\nNowadays, the most common weighting-strategy information (given by\u22124 in the example) allows for both positive and negative event weights, where the average weight gives the cross section of the generated events. In later versions of the format, the optional generator tag may also be included:\n<init> 2212 2212 0.4E+04 0.4E+04 -1 -1 21100 21100 -4 1 0.50109086E+02 0.89185414E-01 0.50109093E+02 1234 <generator name=\"SomeGen1\" version=\"1.2.3\"> some additional comments </generator> <generator name=\"SomeGen2\" version=\"a.x.3\"> some other comments </generator> </init>\nThis tag mainly serves to convey information, and does not affect the file processing through PYTHIA 8.3.\nThe initialization information is then complemented with a large list of <event> blocks containing the phase-space points. It should be noted that PYTHIA 8.3 supports an arbitrary list of attributes of the <event> tag, and further allows \u201ccustom\u201d additions enclosed in <event> tags:\n\u2022 The identifier #pdf at the start of a line means the line contains information on PDFs. For example, the line #pdf 1 -1 0.11 0.3 100 0.5 0.3 will lead to reading/setting the values: ID(particle extracted from beam \u201cA\u201d) = 1, ID(particle extracted from beam \u201cB\u201d) = \u22121; momentum fraction of particle extracted from beam A xA = 0.11, momentum fraction of particle extracted from beam B xB = 0.3; factorization scale \u00b5F = 100 GeV; value of the parton distribution for beam A fA(xA,\u00b5F ) = 0.5; and value of the parton distribution for beam B fB(xB,\u00b5F ) = 0.3.\n\u2022 <event> tags are allowed to enclose two hard-scattering events, as is e.g. needed when interfacing to external double-parton scattering codes.\n\u2022 In the latter case, the identifier #scaleShowers at the start of a line leads to the two subsequent floating-point values being interpreted as parton-shower starting scales for the first and second hard scattering enclosed by <event> ... </event>, respectively.\n\u2022 Omitting the incoming particles in the content of the <event> tag can be permissible when interfacing with PYTHIA 8.3 to perform only hadronization of resonance-decay systems.\n\u2022 The event attributes npLO and npNLO are parsed, and employed when interfacing to MADGRAPH5_AMC@NLO.\nA simple event compliant with both versions of the standard will contain information about the number N of particles in the event, the process label, the \u201cscale\u201d, and QED and QCD coupling strengths, followed by N lines containing particle information:\n<event> 4 1234 5.0 300.0 7.861651E-03 1.084400E-01 2 -1 0 0 101 0 0.000E+00 0.000E+00 3.016E+02 3.016E+02 0.000E+00 0. 9. -2 -1 0 0 0 102 0.000E+00 0.000E+00 -2.964E+02 2.964E+02 0.000E+00 0. 9. 6 1 1 2 101 0 -1.358E+02 -1.671E+02 1.128E+02 3.000E+02 1.756E+02 0. 9. -6 1 1 2 0 102 1.358E+02 1.671E+02 -1.076E+02 2.980E+02 1.756E+02 0. 9. </event>\nFor each particle, its identity, status, pair of mothers, pair of colours, momentum, mass, production vertex, and spin are required information. In version 3.0 of the standard, further information may be added to an <event>. A more involved example is:\n<event type=\"undecayed_born_level_ttbar\"> 4 1234 5.0 300.0 7.861651E-03 1.084400E-01 2 -1 0 0 101 0 0.000E+00 0.000E+00 3.016E+02 3.016E+02 0.000E+00 0. 9. -2 -1 0 0 0 102 0.000E+00 0.000E+00 -2.964E+02 2.964E+02 0.000E+00 0. 9. 6 1 1 2 101 0 -1.358E+02 -1.671E+02 1.128E+02 3.000E+02 1.756E+02 0. 9. -6 1 1 2 0 102 1.358E+02 1.671E+02 -1.076E+02 2.980E+02 1.756E+02 0. 9. <rwgt> <wgt id=\"A\"> 5.0 </wgt> <wgt id=\"B\"> 4.5 </wgt> <wgt id=\"C\"> 5.5 </wgt> </rwgt> <weights> 1.0 0.7 1.3 </weights> <scales muf=\"175.0\" mur=\"175.0\" mups=\"300.0\" scale_3=\"1.0\" scale_4=\"1.0\"> content is not parsed </scales> </event>\nThis event contains three auxiliary event weights in the \u201cdetailed format\u201d, as well as three additional event weights in the \u201ccompressed format\u201d. These different ways to transmit event weights do typically not appear together. The \u201cdetailed format\u201d has become much more widely used. The example above further contains auxiliary scale information through the scales tag. This feature can be used to e.g. transfer multiple shower starting scales to PYTHIA 8.3. Starting scales for individual particles in the event can be set by including a scales attribute ending with _iPos, where iPos is the position of the particle (in the <event>) in question. This functionality is used for MLM jet matching with MADGRAPH, and for MC@NLO \u2206 matching using MADGRAPH5_AMC@NLO. At present, PYTHIA 8.3 does not support the use of sets of events enclosed in <eventgroup>. Such events sets were originally proposed in [399] to collect events that require correlated post-processing. Since the latter is not possible in PYTHIA 8.3, event files containing <eventgroup> tags will be treated as if the <eventgroup> tag was not present.\nFinally, note that PYTHIA 8.3 will perform momentum-conservation checks on each input <event>. If inconsistencies (e.g. due to rounding errors) are found, then actions will be taken to repair the event. This entails enforcing the correct value of particle rest masses, and ensuring that the incoming momentum matches the outgoing momentum."
        },
        {
            "heading": "10.1.2 SLHA",
            "text": "The SUSY Les Houches accord format! [400, 401] was designed as a plain-text interface between supersymmetric spectrum generators, decay packages, and event generators. However, it has since been generalized to contain information for any new physics model, cf. e.g. [402].\nThe current SUSY implementation in PYTHIA is fully general with support for flavour- and R-parity violation. The physical mass basis for each class of new particles (squarks, sleptons, charginos, and neutralinos, as well as Higgses) is ordered by mass alone. We refer the reader to the original SLHA2 documentation [401] for the full list of supersymmetric parameters supported by SLHA2. Here we give a summary of how new parameters can be passed to PYTHIA, and the modifications made to extend SLHA2 support to be able to read up to 3- dimensional matrix input.\nAn SLHA file contains a number of pre-formatted \u201cblocks\u201d. The three main blocks most often used for passing information about new particles are QNUMBERS, MASS, and DECAY. As an example, we show here how a new spin-1 particle in a colour-octet representation (\u201cheavy gluon\u201d) and a new fermion (\u201cheavy quark\u201d) can be defined in SLHA [402]. All characters following a # symbol are ignored as a comment, except the first two words after the particle ID code are assumed to be the name of the particle and, optionally, its antiparticle.\nBLOCK QNUMBERS 9000021 # HeavyGluon 1 0 # 3 times electric charge 2 3 # number of spin states (2S+1) 3 8 # colour rep (1:singlet, 3:triplet, 8:octet, 6:sextet) 4 0 # Particle/Antiparticle distinction (0=own anti)\nBLOCK QNUMBERS 9000006 # HeavyQuark HeavyQuarkbar 1 0 # 3 times electric charge 2 2 # number of spin states (2S+1) 3 3 # colour rep (1:singlet, 3:triplet, 8:octet, 6:sextet) 4 1 # Particle/Antiparticle distinction (0=own anti)\nNote that many of the particle ID codes below 3 million, and several above it, are already in use in PYTHIA (e.g. for hadrons, SM particles, and the MSSM particle spectrum). To avoid conflicts, it is strongly advised to only use codes above 3 million for new BSM particles, and to\ncheck in the particle data table that the codes are not already in use. See also the PDG list of standard particle ID codes [35, sec. 45]. Finally, note that PYTHIA is only able to handle colour singlets, triplets, octets, and sextets.\nThe mass block [400] contains the mass of the physical particles and is simply a list containing the particle ID code and its mass.\nBLOCK MASS 9000021 1000. # HeavyGluon 9000006 450. # HeavyQuark\nNote that some matrix-element generators export their complete list of particle masses in this block, including also those of SM particles, which may not agree with PYTHIA\u2019s internal values. This can wreak havoc in unintended places, e.g. by overwriting PYTHIA\u2019s constituentquark masses by far smaller current-quark masses. Therefore, for particles with ID codes less than one million, PYTHIA normally ignores SLHA input for any particle whose default mass in PYTHIA is smaller than SLHA:minMassSM = 100 GeV. This allows SLHA input to modify top and Higgs-boson properties, but not those of Z , W , and lighter particles.\nSeparate DECAY blocks [400] can be used to specify decay tables for both new and existing particles. (See further sections 2.3.3 and 3.11 for more on PYTHIA\u2019s modelling of resonance production and decays.) The sum of all branching fractions is normalized to one when read in. If a certain decay channel is needed for determining the total width, but is not desired to be generated in the context of a given run, this can be done by setting the branching fraction negative. Each line containing a branching ratio should also contain the number of daughter particles, followed by the ID codes of the daughters. Note that only a single decay table should be provided for each particle type; PYTHIA does not accept separate decay tables for antiparticles. However, if different open decay modes are required for a particle and its antiparticle, this can be accomplished by using the PYTHIA ParticleData settings NN:onIfPos and NN:onIfNeg which are allowed to override the initial SLHA settings if SLHA:allowUserOverride = true.\n# PID Width DECAY 9000021 0.01 # BR NDA ID1 ID2 0.67 2 9000006 -9000006 0.33 2 6 -6\nWhen the SLHA interface is used to modify particle data, the mmin and mmax limits used in PYTHIA\u2019s Breit\u2013Wigner sampling (see section 2.3.3) default to m0\u00b1min(5\u03930, m0/2). The mmin value is further required to also be above the sum of on-shell masses for the lightest decay channel. The default values can be modified by the user, if so desired.\nThe default Breit\u2013Wigner treatment for decay tables imported via the SLHA interface is the simple NN:meMode = 100 one with constant branching fractions, but this can also be changed if desired. The phase-space sampling is isotropic, since the SLHA tables do not convey any differential information. It is up to the user to ensure that the final behaviour is consistent with what is desired and/or to apply suitable post-facto reweightings. Plotting the generator-level resonance and decay-product mass distributions and e.g. mass differences, effective branching fractions, etc., may be of assistance to validate the program\u2019s behaviour for a given application.\nNote, finally, that the default in PYTHIA is to ignore SLHA input for all SM particles except top quarks and Higgs bosons; this protects PYTHIA\u2019s more sophisticated modelling of e.g. Z\nand W decays (as well as its definitions of quarks, hadrons, and leptons), cf. section 3.11, from being unintentionally overridden by the simpler SLHA treatment. Similar to the above, this choice can be changed by the user if desired, though care must be taken not to corrupt PYTHIA\u2019s hadron or light-quark particle data.\nFinally, we describe how user-defined blocks may be accessed via the SLHA class [82]. All unknown, i.e. user-defined blocks that can be stored in arrays of up to 3 dimensions are read in via the test SLHA file and saved under the name following the BLOCK keyword. Depending on the dimensions of the box, one of these methods can be used to access relevant information. This functionality can be used with e.g. the semi-internal processes described in section 9.7.3 to use SLHA files to read complex parameter information. Using the slhaPtr object available to all production processes inheriting from the SigmaProcess class, a block with blockName can be accessed using one of the following.\n# Single value bool slhaPtr->getEntry(string blockName, double& value);\n# 1D array bool slhaPtr->getEntry(string blockName, int index,\ndouble& value);\n# 2D array bool slhaPtr->getEntry(string blockName, int index1,\nint index2, double& value);\n# 3D array bool slhaPtr->getEntry(string blockName, int index1, int index2,\nint index3, double& value);"
        },
        {
            "heading": "10.1.3 LHAHDF5",
            "text": "In addition to plain-text based ASCII LHEF, PYTHIA 8.3 now also supports Les-Houches event input via the HDF5 data format, which some matrix-element generation frameworks, such as SHERPA [403], support as an alternative to LHEF event output.\nThe HDF5 format is an open-source binary data format, organized like a database within a single file. It allows for heterogeneous data storage, which is more compressed than ASCII files. Being indexed in an efficient way, it enables the possibility of data slicing, i.e. the reading of data subsets instead of the entire data at once. The HDF5 format is thus well suited for storing large numbers of LHA phase-space points in a more efficient way than text-based file formats, allowing for massively parallelized simultaneous access to a single event file [404].\nThe LHAHDF5 reader uses the HighFive header library to interface HDF5. Moreover, the HDF5 library tools must be installed and an MPI compiler, such as that shipped with MPICH, is needed. To use the LHAHDF5 reader with PYTHIA 8.3, an example configuration command is therefore given by:\n./configure --with-mpich[=path] --with-hdf5[=path] --with-highfive[=path]\nAs a relatively new event file format, the LHAHDF5 standard is still undergoing active development. PYTHIA 8.3 internally uses a three-digit numbering scheme to distinguish different LHAHDF5 versions, characterized as follows:\n0.1.0 The event file contains an index group, in which the indices of the particles in a single event are stored. The indices refer to the particle group. Weight variations are not supported and event weights are stored as a single floating-point number in the event group.\n0.2.0 The event file does not contain an index group. Weight variations are not supported, and event weights are stored as a single floating-point number in the event group.\n1.0.0 The event file does not contain an index group. Weight variations are supported, and event weights are stored in a (possibly one-dimensional) array in the event group.\nCurrently, not all event files may have their version number stored. Therefore, the version can be specified in the PYTHIA input file using e.g. LHAHDF5:version = 0.2.0. If a version number is present in the event file that is used, the user input will be ignored and the one in the event file is used instead."
        },
        {
            "heading": "10.1.4 LHAPDF",
            "text": "The LHAPDF package is the community standard for providing external parton distribution functions to event generators. Two versions of LHAPDF are supported by PYTHIA 8.3, version 5 [405], a legacy FORTRAN version, and version 6 [406], with a more performant modern C++ implementation. The use of LHAPDF 5 is discouraged and will be fully removed in the future, but is currently kept to provide PDFs for resolved photons that are not currently available in LHAPDF 6. Both versions act as interpolators and extrapolators, for x and Q2 PDF grids provided by fitting groups. The LHAPDF libraries do not perform DGLAP evolution, and are restricted in x and Q2 to the grids provided by each PDF set.\nSupport for LHAPDF can be enabled during PYTHIA 8.3 configuration by,\n./configure --with-lhapdf5[=path] --with-lhapdf6[=path]\nwhere the path can optionally be provided. If the executable lhapdf-config is available, the LHAPDF path will be automatically extracted. Plugin libraries are generated along with the Pythia library which are then loaded at run time when LHAPDF sets are requested by the user. With this interface, it is technically possible to simultaneously use both an LHAPDF 5 and LHAPDF 6 PDF, but this is strongly discouraged. For all PDFs, proton or otherwise, LHAPDF sets can be selected via setting the relevant configuration key to the value LHAPDF5:set/member or LHAPDF6:set/member, where set is the name of the PDF set to use and member is the numerical member of that set. If member is not supplied, the nominal member is assumed. The example main52 demonstrates this syntax, while the example main51 shows how PDF classes can be used independently of a main Pythia instance.\nEvery LHAPDF set has a range of validity, given by the minimum and maximum x and Q2 values of the grids provided. By default, PYTHIA 8.3 freezes these PDF sets at all boundaries for the set, i.e. for x < xmin the PDF value is fixed at xmin and for Q <Qmin the PDF value is fixed at Qmin. It is possible to enable extrapolation below xmin by setting the PDF:extrapolate flag. This flag applies universally to all PDF sets, both internal and external. Extrapolation should be enabled with care, as the extrapolation is PDF set and LHAPDF version dependent, and in many cases may return nonsensical results. Note that extrapolation for the remaining boundaries, xmax, Qmin, and Qmax, is never performed. These values are always frozen at the limits of validity.\nThe standardized LHAGrid1 format used by LHAPDF 6 allows for PYTHIA 8.3 to use grids from LHAPDF 6 sets without requiring the LHAPDF 6 library. Simple cubic interpolation is\nperformed in ln(x) and ln(Q2), where all Q2 sub-grids must have the same x-value structure. When less than four Q2 sub-grids are available, linear interpolation is used instead. All relevant PDF sets can use this interpolation by setting the relevant PDF configuration key to the value LHAGrid1:file, where file is the full name of the PDF set file. If file begins with /, then an absolute file path is used, otherwise the file is assumed to be in the share/Pythia8/pdfdata directory."
        },
        {
            "heading": "10.1.5 POWHEG",
            "text": "A large number of processes utilizing the POWHEG method (positive weight hardest emission generator) [150, 151, 155] are available via the POWHEG BOX package [178]. The physics behind the matching and merging of the hard processes generated by this package with the PYTHIA parton shower is detailed in section 5. Here, technical details on how results from POWHEG BOX matrix elements may be technically interfaced with PYTHIA are given.\nThe POWHEG BOX package uses a common FORTRAN code structure, which is then duplicated with process-specific modifications in individual matrix elements, e.g. dijets which produces NLO dijet events. These individual matrix elements are then compiled to create executables which when run, take input cards from the user and produce LHEF output, see section 10.1.1 for details on this format. This output file can then be directly read into PYTHIA via the Beams:LHEF setting. Direct POWHEG BOX input, without correctly setting up matching, will result in double counting of emissions. A special UserHooks class, PowhegHooks in Pythia8Plugins, provides a common interface for appropriately matching POWHEG BOX output with the PYTHIA parton shower. In main31 a full example is given, demonstrating how dijet events produced from the dijets POWHEG BOX matrix element can be correctly passed through PYTHIA to produce full events.\nIn some cases, particularly within large experimental frameworks, users may wish to directly access the FORTRAN common blocks of a POWHEG BOX executable, passing the event by memory to PYTHIA, rather than through LHEF output. By default, POWHEG BOX builds only executables. However, it is possible to modify the Makefile via the command,\nsed -i \"s/F77= gfortran/F77= gfortran -rdynamic -fPIE -fPIC -pie/g\" Makefile\nso that the executables can also be used as shared libraries. When modified accordingly, these executables can be linked against PYTHIA interface code to produce libraries that can be loaded directly by PYTHIA at run time. Run-time loading, rather than dynamic linking, is used so that multiple POWHEG BOX processes can be accessed by a single Pythia instance, without creating symbol collisions between executables that have common names for global functions and variables.\nAfter appropriately modifying the relevant POWHEG BOX Makefiles and compiling executables that can also be used as shared libraries, the PYTHIA interface libraries must be created. This can be configured with PYTHIA via,\n./configure --with-powheg-bin=path\nwhere path is the directory containing the POWHEG BOX executables. When building PYTHIA, a plugin library for each POWHEG BOX in the provided directory will automatically be created. These plugin libraries can then be used via the PowhegProcs class provided in Pythia8Plugins as demonstrated in the example main33. The program flow is as follows,\nPythia pythia; // Create a Pythia instance. PowhegProcs hvq(&pythia, \"hvq\"); // Load the \"hvq\" plugin library. hvq.readString(\"configure here\"); // Configure the \"hvq\" plugin hvq.init(); // Initialize the plugins. pythia.init(); // Initialize Pythia.\nwhere the heavy-quark process hvq has been loaded and configured. It is also possible to include another process,\nPowhegProcs dijet(&pythia, \"dijet\", \"dijetrun\");\nwhere the additional argument is needed to ensure that the integration grids from the first process are not overwritten by the second process.\nWhen using the PowhegProcs method for interfacing with POWHEG BOX a PowhegHooks instance is automatically created and passed to the main Pythia instance. The settings for this matching hook must be set by the user through either the readString or readFile methods of the Pythia instance. In many cases, sensible default values are set, but some settings are process dependent and must be correctly configured by the user, i.e. POWHEG:nFinal."
        },
        {
            "heading": "10.1.6 MADGRAPH5_AMC@NLO",
            "text": "MADGRAPH5_AMC@NLO [153] is a hard process generator, similar to POWHEG BOX, but rather than relying upon individually implemented processes, it can automatically generate arbitrary processes up to NLO. There are a number of ways through which MADGRAPH5_AMC@NLO can be interfaced with PYTHIA.\n1. MADGRAPH and AMC@NLO themselves can interface with PYTHIA and pass generated hard processes through PYTHIA to produce full events, all within the MADGRAPH5_AMC@NLO machinery.\n2. LHEF output from MADGRAPH5_AMC@NLO can be passed to PYTHIA 8.3, see section 10.1.1 for details on reading LHEF input.\n3. Source code for matrix-element libraries, inheriting from the internal SigmaProcess class in PYTHIA, can be generated by MADGRAPH.\n4. The MADGRAPH5_AMC@NLO executable can be called from within PYTHIA via the LHAupMadgraph class.\n5. Matrix-element plugins for the DIRE and VINCIA parton showers can be generated by MADGRAPH, compiled, and then loaded at run time.\nThe latter three methods are covered in more detail below. In all cases, it is important that appropriate matching and merging, see section 5, is configured to ensure there is no double counting between the generated hard process and the remainder of the event produced by PYTHIA 8.3.\nSemi-internal processes can be passed to PYTHIA 8.3 via inheriting from the SigmaProcess class. The primary method of this class is sigmaHat where the exact definition depends upon the final-state multiplicity of the process. Phase-space generation can be handled by PYTHIA 8.3 for 2\u2192 1, 2\u2192 2, and 2\u2192 3 processes, although the 2\u2192 3 phase-space sampler is not particularly sophisticated. When necessary, users can provide custom external\nphase-space samplers. Consequently, while 2\u2192 n processes can be externally supplied, phasespace generation must also be implemented by the user for n > 3. A full example is given in the example main22 but the general syntax is,\nSigmaProcess* userSigma = new UserSigma(); pythia.setSigmaPtr(userSigma);\nwhere UserSigma is a user-defined process inheriting from SigmaProcess. Semi-internal process source code can be generated from within the MADGRAPH PYTHON\ninterface as follows.\nimport model model_name generate mg5_process_syntax add process mg5_process_syntax output pythia8 [path_to_pythia]\nA directory containing the output for the process is placed in the PYTHIA 8.3 source directory specified by path_to_pythia and an example is placed in the examples directory.\nIt is also possible to call MADGRAPH from within PYTHIA 8.3 via the LHAupMadgraph class provided in Pythia8Plugins.\nshared_ptr<LHAupMadgraph> madgraph = make_shared<LHAupMadgraph>(&pythia, true, \"madgraphrun\",\nexe); madgraph->readString(\"generate mg5_process_syntax\"); pythia.setLHAupPtr(madgraph);\nThis interface generates the relevant MADGRAPH configuration cards, and then runs the MADGRAPH executable, specified by exe, to produce LHEF output that is then read in by PYTHIA 8.3. An attempt is made to automatically set up matching and merging, but this process should always be validated by the user. Random-number sequences are automatically handled, based on the PYTHIA 8.3 random-number generator. Whenever the LHEF input is exhausted, a new call is made to the MADGRAPH executable and a new LHEF output is generated.\nFinally, it is possible to use MADGRAPH to generate matrix-element plugins for use in the DIRE and VINCIA parton showers. A number of these plugins are already provided with the PYTHIA 8.3 distribution in the plugins/mg5mes directory. To enable this plugin support, configure PYTHIA 8.3 with\n./configure --with-mg5mes[=path]\nwhere the path to the matrix-element plugin source-code directories can optionally be specified. A plugin library for each directory in the path will be built, which can then be loaded at run time. Just as for POWHEG BOX, run-time loading of the matrix elements allows for multiple plugins to be used with the same instance of Pythia. For DIRE and VINCIA, the plugin library to be used can be specified with the settings Dire:MEplugin and Vincia:MEplugin respectively.\nNew matrix-element plugin libraries can be generated by using the generate command in the plugins/mg5mes directory. In its simplest form, the user just needs to specify the process,\n./generate --process=\"mg5_process_syntax\"\nbut may also specify a model to use, as well as the output directory. Advanced usage is also possible where a custom MADGRAPH card is passed by the user, or the interactive mode of MADGRAPH is enabled. Note that this feature requires the use of DOCKER to download and run a container with a custom version of MADGRAPH.\nThe most common interface to MADGRAPH5_AMC@NLO is through text files in LHEF format, cf. section 10.1.1. For easy interfacing between MADGRAPH5_AMC@NLO and PYTHIA 8.3, some custom additions to the file format are employed:\n\u2022 The event attributes npLO and npNLO are used to set the number of particles at lowest order for events with leading-order and next-to-leading order cross sections, respectively. For the former, npLO amounts to a simple final-state particle count. For the latter, npNLO gives the number of final-state particles necessary to define the scattering at Born level. It is assumed that npLO\u2265 0 \u2192 npNLO< 0 and npNLO\u2265 0 \u2192 npLO< 0, meaning that these attributes also act to signal if an event is a leading-order or next-to-leading-order contribution.\n\u2022 Several mechanisms to set the parton shower starting scales for individual particles exist. These rely on attributes of the <scales> tag defined in the LHEF 3.0 format.\n\u2022 For the case of MLM matching, the parton-shower starting scale information is also used to signal whether a particle should not be considered for the MLM jet matching procedure. Particles that have been assigned a starting scale \u00b5 > 2ECM will be considered exempt from the MLM jet matching criterion.\nMADGRAPH5_AMC@NLO further incorporates provisions for automatic NLO+PS matched calculations within the MC@NLO approach. The interface between AMC@NLO and PYTHIA 8.3 typically relies on phase-space points transmitted via LHEF. However, for special matching tasks, it is possible to invoke PYTHIA 8.3 from within AMC@NLO. This is the case for the MC@NLO \u2212\u2206 matching prescription. The relevant FORTRAN code, wrapping PYTHIA 8.3 functionality, is shipped within MADGRAPH5_AMC@NLO. PYTHIA 8.3 can be set up for use within MADGRAPH5_AMC@NLO by setting the configuration flag Merging:runtimeAMCATNLOInterface. This then allows MADGRAPH5_AMC@NLO direct access to select parts of PYTHIA 8.3\u2019s internal merging machinery, to e.g. enable the extraction of Sudakov form factors. A more detailed introduction may only be relevant to experts in MADGRAPH5_AMC@NLO, and may be found in the online manual."
        },
        {
            "heading": "10.1.7 HELACONIA",
            "text": "While PYTHIA 8.3 has a complete collection of expandable quarkonia processes, see section 3.3, it is sometimes necessary to generate quarkonia states at higher orders or with additional final-state partons. Previous versions of MADGRAPH were able to produce arbitrary tree-level quarkonia processes via MADONIA [407], but the current version of MADGRAPH no longer has this ability to generate bound heavy-quark resonances. However, the standalone HELACONIA [408] package is able to provide the same functionality of the MADONIA package, and beyond.\nThe program flow of HELACONIA is very similar to that of MADGRAPH. A PYTHON interface is used to generate source code which is then compiled and run to produce LHEF output. This output can then be provided to PYTHIA 8.3 to produce full events with parton showers, underlying event, and particle decays. The HELACONIA syntax is modelled after the MADGRAPH syntax, and consequently, the interface is similar. Unlike MADGRAPH, HELACONIA is not able to produce semi-internal matrix elements inheriting from the SigmaProcess class. Instead, HELACONIA can be interfaced either by directly providing LHEF output to PYTHIA 8.3, or using the LHAupHelaconia class provided in Pythia8Plugins.\nThe LHAupHelaconia interface is very similar to that of LHAupMadgraph,\nshared_ptr<LHAupHelaconia> helaconia = make_shared<LHAupHelaconia>(&pythia, true, \"helaconiarun\",\nexe); helaconia->readString(\"generate ho_process_syntax\"); pythia.setLHAupPtr(helaconia);\nwhere ho_process_syntax is the HELACONIA equivalent for the MADGRAPH process syntax. The HELACONIA executable must be available via the string exe. Every time a PYTHIA 8.3 event is generated, the plugin checks if an event is available from an LHEF file generated by HELACONIA. If not, it will automatically run another batch of events. Random-number seeds and sampling are consistently handled in the same way as for LHAupMadgraph."
        },
        {
            "heading": "10.1.8 EVTGEN",
            "text": "For many experimental collaborations, particularly those specializing in B-physics, more detailed hadron-decay models are needed than those provided by default in PYTHIA 8.3. The EVTGEN [409] package specializes in B-hadron decays, including sophisticated models, spin correlations, and the ability to implement new models. To include spin correlations EVTGEN does not just decay a single particle at a time, but instead performs the entire decay tree for each given initial particle. Consequently, decays from EVTGEN cannot be included in PYTHIA 8.3 via the provided DecayHandler class, called during the decay stage of the hadron level, but must rather be performed after full event generation. Such an interface for EVTGEN is supplied by the class EvtGenDecays provided in Pythia8Plugins.\nIn B-physics, particularly at hadron colliders, one oftentimes wishes to produce a large sample of events where each event contains one or more rare signal decays, e.g. B0s \u2192 \u00b5\n+\u00b5\u2212. The first step, of course, is to generate an event with at least one signal particle candidate, while the second step is to force the signal decay for one of these candidates. The weight for an event containing one candidate with a forced signal decay is simply the branching fraction for the signal decay. However, when multiple candidates are present, the event weight becomes slightly more complex, requiring non-trivial bookkeeping. Consequently, the EvtGenDecays class in PYTHIA 8.3 provides a generalized mechanism by which to force signal decays for given particle species, while still providing an appropriate event weight.\nSignal particle candidates, ci , do not all need to be the same particle species. Here, a particle species differentiates not only between particle types, e.g. B0s and \u03c4\n+, but also between particles and antiparticles, e.g. \u03c4+ and \u03c4\u2212. Additionally, the signal decay for a candidate, with branching fraction Bsig(ci), can include multiple channels. Consequently, arbitrarily complex signal decays can be forced. As an example, events can be required to contain one or more of the following decays: \u03c4+ \u2192 \u03bd\u0304\u03c4\u03c0+, \u03c4+ \u2192 \u03bd\u0304\u03c4\u03c00\u03c0+, B0s \u2192 \u00b5\n+\u00b5\u2212, and \u03c4\u2212 \u2192 \u03c4\u03bd\u03c0\u2212\u03c0\u2212\u03c0\u2212\u03c0+\u03c0+. Here, assuming equal production of the three particle species (which is almost certainly not the case), the decay \u03c4+\u2192 \u03bd\u0304\u03c4\u03c00\u03c0+ of the four signal decays will be the most commonly forced decay. Following this notation, the event weighting is performed as follows.\n1. An event is generated and all n signal particle candidates, ci , are found. If there are no candidates, n= 0, then an event weight, Wevent, of 0 is returned.\n2. If n> 0 then a candidate ci is randomly chosen with probability\nP(ci) = Bsig(ci)\n\u2211m j=1 1\u2212Bsig(c j) , (397)\nwhere Bsig(ci) is the signal branching fraction for each candidate ci .\n3. A channel is selected for the chosen candidate ci from one of the signal channels contributing to Bsig(ci).\n4. Channels for all remaining candidates are selected, using all allowed decay channels, not just the signal channels.\n5. The number of candidates with a selected signal channel, m, is determined. The channel selection for the candidates is then kept with probability 1/m. If the channel selection is rejected, the algorithm returns to step 2 and a new set of channels is selected.\n6. All candidates are decayed via their selected channel and\nWevent = 1\u2212 n \u220f\ni=1\n1\u2212Bsig(ci) , (398)\nis calculated as the event weight.\nAn unweighted sample of events can be obtained by randomly selecting events, each with probability Wevent/Wmax. The maximum possible event weight, Wmax, can be determined by the maximum weight from a sufficiently large sample of events.\nTo use EVTGEN in PYTHIA 8.3, configure PYTHIA 8.3 with\n./configure --with-evtgen[=path]\nwhere path optionally provides the path to the EVTGEN installation. Note that EVTGEN itself also links against PYTHIA 8.3, so in some cases it might be necessary to reconfigure PYTHIA 8.3 after installation of EVTGEN. A full example using EVTGEN is provided in main48. The general syntax is,\nEvtGenDecays evtgen(&pythia, dec, pdl); pythia.next(); evtgen->decay();\nwhere dec and pdl provide the paths to the EVTGEN decay and particle data files."
        },
        {
            "heading": "10.1.9 External random-number generators",
            "text": "When including PYTHIA in a larger software framework, using a single random-number generator across all components is oftentimes required to ensure reproducible results. Consequently, an external random-number-generator pointer may be passed for use by a given PYTHIA instance.\npythia.setRndmEnginePtr(rng)\nHere, rng is a pointer to an instance of a user-defined random number generator derived from the RndmEngine class. The only method that must be implemented by the user is flat which should return a uniform distribution between 0 and 1. The example below implements a linear congruential generator with a configurable seed, modulus, multiplier, and increment.\nclass RandomLCG : public RndmEngine { public: long int seed{1}, m{2147483648}, a{1103515245}, c{12345};\n// The only method that needs to be implemented. double flat() { seed = (a * seed + c) % m; return double(seed)/m;\n} };\nTypically, the RndmEngine class can be used to wrap some other random number generator. An example of this is the MixMadRndm class which is a wrapper for an implementation of the MIXMAX algorithm [11].\n#include \"Pythia8Plugins/MixMax.h\" MixMaxRndm rng(0, 0, 0, 123); pythia.setRndmEnginePtr(&rng);\nThe argument to the generator constructor is four seed values. While this functionality of providing an external random number generator is useful, it should be treated with care. Some pseudo-random-number generators implemented in standard packages are not sufficient for large scale generation, e.g. the CLHEP implementation of the RANLUX algorithm. Consequently, when possible, the default random number generator in PYTHIA, based on the RANMAR implementation of the Marsaglia-Zaman algorithm [9], is recommended and sufficient for most physics purposes, see section 2.2.1."
        },
        {
            "heading": "10.2 Output formats",
            "text": "PYTHIA comes with a set of example main programs, and in most of these the analysis of the produced event is performed directly in the code there. It is also possible to output the events to be analyzed by interfacing to external programs and code. For this purpose PYTHIA can communicate its events with different output formats as described in this subsection."
        },
        {
            "heading": "10.2.1 HEPMC versions 2 and 3",
            "text": "The standard format for communicating fully generated events is called HEPMC [410, 411] and defines a set of C++ classes to describe an event and all particles therein. Internally, the particles are connected by vertex objects using pointers.\nThe latest version of the HEPMC code is not yet adopted by all LHC collaboration and PYTHIA therefore has support for both version 2 (2.06 and later) and version 3. The interface as such is provided at the header file level using Pythia8Plugins/HepMC2.h or Pythia8Plugins/HepMC3.h, and the PYTHIA code itself does not have any dependencies on these. This means that the PYTHIA (shared) library can be built independently of which version of HEPMC should be used. However, if one wishes to use the example main programs that show how to use HEPMC13 the configuring of PYTHIA must be done according to\n./configure --with-hepmc3=/path/to/hepmc/installation\n13The example main programs can be found in the online manual under Getting Started \u2192 Examples by Keyword, search for Hepmc.\nor\n./configure --with-hepmc2=/path/to/hepmc/installation\nBesides the particles, other information will also be transferred to the HEPMC format, such as cross sections, parton density information, and different weights (see section 9.8). Note, however, that not all information in the Pythia8::Event is preserved in the HEPMC output. Notably, the status codes for particles in HEPMC are only set to 1 (final state particle), 2 (decayed standard model hadron or \u03c4 or \u00b5), 4 (incoming beam), or a number in the range 11\u2013200 (generator dependent status of an intermediate particle, given by the absolute value of the corresponding PYTHIA status code)."
        },
        {
            "heading": "10.2.2 Histograms with the YODA package",
            "text": "Even though the built-in histogram package might suffice for the most basic use cases, such as one-dimensional histograms, most users require more advanced capabilities. Since PYTHIA 8.3 is not a statistics or plotting package, we refer the user to external programs. For slightly more advanced use cases, we recommend interfacing to the YODA14 histogram package. If installed, PYTHIA 8.3 can be configured with --with-yoda=/path/to/yoda, which allows the user to create Makefile recipes with access to YODA histograms easily. The YODA package will then be accessible in PYTHIA 8.3 as any other C++ library can be accessed. Questions regarding the YODA histogram package should be addressed to the YODA authors."
        },
        {
            "heading": "10.2.3 Interfacing with ROOT",
            "text": "For more advanced analyses, many users prefer the ROOT [412] package. PYTHIA 8.3 provides several possibilities to interface with ROOT, version 6 or higher. Use cases can roughly be grouped into three categories:\n1. Using ROOT as a histogram package inside PYTHIA 8.3.\n2. Using PYTHIA 8.3 to generate ROOT events or \u201cn-tuples\u201d, which can be post-processed by ROOT.\n3. Steering PYTHIA 8.3 from inside a ROOT-based framework.\nWe will here briefly cover the first two use cases, but refer the user to the ROOT documentation for using the PYTHIA 8.3 interface in ROOT, where it is extensively documented.\nThe simplest use case is of the first category which, from a technical point of view, is not too different from using any other C++ library along with PYTHIA 8.3. In the example main91, it is shown how to declare a ROOT TApplication environment and ROOT TH1F histograms, to be filled by PYTHIA 8.3, and displayed on screen. The crucial part is the Makefile recipe. If PYTHIA 8.3 is configured --with-root, convenient variables pointing to the ROOT libraries and the root-config script can be used as shown, to compile a main program with the necessary linking to ROOT libraries. The generated histograms can then be saved to a .root file for later access.\nMost users already familiar with ROOT, would rather store event files generated with PYTHIA 8.3 (so-called \u201cn-tuples\u201d) on disk, which can then be post-processed with a ROOTcentric analysis framework, often with auxiliary packages, provided by a large experiment. In such cases, examples main92 and main93 can be of inspiration. The main92 example shows how to store full events into a ROOT TTree. For most realistic use cases, this is not very\n14See https://yoda.hepforge.org/.\npractical, as such files will quickly grow large, containing a significant amount of information which is of little relevance to the user. The main93 program provides a more streamlined interface. In the header file main93.h, two classes RootTrack and RootEvent are defined. Those classes define what information about each track (including track-level cuts, e.g. desired acceptance) as well as each event, should be stored in an output ROOT-file. If PYTHIA 8.3 has been configured with ROOT, the main93 example can be run with an input .cmnd file with the flag Main:writeRoot = on, and the desired information will be stored. If changes are made to the header file, main93 must be recompiled. For both main92 and main93, the compilation recipe in the Makefile is the most difficult part to set up, as both require generation of compiled and linked ROOT dictionary libraries with CINT. A user wishing to go beyond simple extensions of the given examples are encouraged to study the existing Makefile recipes, as well as the ROOT documentation on Linkdef.h. It is kindly requested that queries about ROOT dictionary library generation are directed to the ROOT authors."
        },
        {
            "heading": "10.3 Analysis tools",
            "text": "The tools included in PYTHIA are normally enough for doing simple analyses of the generated events, but for more complicated analyses, or if direct comparison with data is wanted, the user needs to interface to external tools. Here we describe some of these interfaces."
        },
        {
            "heading": "10.3.1 RIVET versions 2 and 3",
            "text": "The RIVET package [413, 414] is probably the most convenient way of comparing eventgenerator models to experimental data. The program includes a large collection of experimental analyses encoded (usually by the experiments themselves) in C++ classes that read HEPMC input and produce YODA files that can be plotted together with the experimental data points (also provided by the experiments through HEPDATA [415,416]).\nSince RIVET only needs HEPMC input, the only thing needed for PYTHIA is to write the events to a HEPMC file (see section 10.2.1) or a pipe (which is recommended to avoid creating unnecessarily large files), and have RIVET take this as input. Assuming a main PYTHIA program, mymain-hepmc, that simply writes HEPMC to the standard output, the commands to do this are\nmkfifo hepmc-pipe ./mymain-hepmc > hepmc-pipe & rivet -a SomeAnalysis hepmc-pipe rivet-mkhtml Rivet.yoda\nwhere the last command will produce formatted web pages in the rivet-plots subdirectory, with the comparisons to data.\nIn PYTHIA there is also a more direct way of calling RIVET from within a main program provided. This uses the header file Pythia8Plugin/Pythia8Rivet.h and provides simple shortcuts as shown in some of the provided example main programs.15 To enable this, PYTHIA must be configured using\n./configure --with-rivet=/path/to/rivet/installation\ntogether with the corresponding --with for the version of HEPMC that RIVET was configured with.\n15The example main programs can be found in the on-line manual under Getting Started \u2192 Examples by Keyword, search for Rivet.\nPYTHIA currently supports direct linking with both versions 2 and 3 of RIVET. The additional features in the later version includes the possibility of using different weights (see section 9.8), several heavy-ion specific features [417], and to provide options to the analyses. Support for version 2 of RIVET will likely be dropped in the future."
        },
        {
            "heading": "10.3.2 FASTJET",
            "text": "The fjcore code is distributed together with the PYTHIA 8.3 code by permission from the authors. There is also an interface that inputs PYTHIA 8.3 events into the full FASTJET library, for access to a wider set of methods, but then FASTJET must be linked by using\n./configure --with-fastjet=/path/to/fastjet/installation --with-fastjetlib=/path/to/ fastjet/library\nAmong PYTHIA 8.3 example main programs, main71.cc shows in the case of W plus jet production, how the FASTJET package can be used for analysis of the final state, and main80.cc performs CKKW-L merging with a merging scale defined in k\u22a5, with main80.cmnd and LHE files as input. Also, main72.cc compares QCD jet finding in SlowJet and FASTJET, using the header file FastJet3.h present in the directory Pythia8Plugins contributed by Gavin Salam [418]."
        },
        {
            "heading": "10.4 Computing environments",
            "text": "PYTHIA has been developed as a C++ library to write and compile programs to execute standalone on a generic \u2217nix operating system on a generic computer. However, we address here the rise in popularity of PYTHON as a development language and a powerful tool in machinelearning applications."
        },
        {
            "heading": "10.4.1 PYTHON interface",
            "text": "To meet the growing requirements of a large user base, PYTHIA includes a flexible PYTHON interface to most frequently used classes, and thus allows a user to write a PYTHIA main program entirely in PYTHON. This provides the user direct access to the wealth of analysis and visualization tools, available through PYTHON libraries, all at run time. A number of PYTHON examples are provided, each a direct translation of their corresponding C++ counterpart. The interface is generated with BINDER using the PYBIND11 template library. The specific version of BINDER and PYBIND11 needed to generate the interface is provided through a small DOCKER container.\nThe default interface is a simplified one, with only the core PYTHIA functionality available. This interface is a trade off between usability and remaining light weight. The top level Pythia class is available, as well as all relevant Event, ParticleData, and analysis tool related classes. An important feature of the interface is that it is bi-directional, derived classes in PYTHON can be passed back to PYTHIA. This is useful, for example, to create a UserHooks derived class (see section 9.7.2). All user interface classes, typically passed to the main Pythia object via pointers in the standard C++ code, are available through the simplified interface.\nA full PYTHON interface can also be generated by the user. Only DOCKER is required to enable the generation of a new PYTHON interface to PYTHIA. The following generates the full interface.\ncd plugins/python ./generate --full\nIt is also possible to generate a user-defined interface which is tailored to a specific use case via the flag --user=FILE instead. Here, FILE is a BINDER configuration file specified by the user. Note that whenever changes are made to the PYTHIA C++ headers, the PYTHON interface must be generated again, whether simplified, full, or user defined.\nInstallation of the PYTHON interface requires the Python.h header to be available. The python-config script can be used to find the relevant paths when configuring PYTHIA. An example configuration for PYTHIA with PYTHON 3.6 could then be:\n./configure --with-python-config=python3.6-config\nThis would configure PYTHIA to be built with the default interface, using PYTHON 3.6. After configuring, the compiled PYTHIA module is available in the lib/ directory under the top level PYTHIA directory. The PYTHON installation must have that directory made available, e.g. by setting:\nexport PYTHONPATH=$(PWD)/lib/:$PYTHONPATH\nfrom the top level PYTHIA directory. After compiling with make, the PYTHON interface should be available. The following example loads the PYTHIA PYTHON module and prints the internal documentation which includes the available classes, as well as some of the not-soobvious features.\n>>> import pythia8 >>> help(pythia8)\nOne of the main reasons for the PYTHON interface is the fast development of a standalone main program in PYTHON rather than C++, allowing for an environment of external tools, which the user might be more familiar with. As an example of such a program, consider the short PYTHON script below, which will run PYTHIA to produce a numpy histogram containing the distribution of charged hadron multiplicity at mid-pseudorapidity in proton collisions at LHC energies.\n# Wrapper around numpy histogram to allow fill functionality. import numpy as np class HistoFiller(object):\ndef __init__(self, bins): self.bins = bins self.hist, edges = np.histogram([], bins=bins,\nweights=[]) self.widths = [] for i in range(len(edges)-1):\nself.widths.append(edges[i+1] - edges[i])\ndef fill(self, val, w=1.0): hist, edges = np.histogram(val, bins=self.bins,\nweights=w) self.hist+=hist\ndef get(self): scale = 1./sum(self.hist) return [h/w*scale for h,w in zip(self.hist,self.widths)],\n[np.sqrt(h)*scale for h in self.hist]\n# Set up Pythia and declare histogram. import pythia8 pythia = pythia8.Pythia() pythia.readString(\"SoftQCD:all = on\") pythia.init() mult = HistoFiller([3.*x for x in range(20)])\n# Event loop. Find particles and fill histogram. for iEvent in range(1000000):\nif not pythia.next(): continue nCharged = 0 for p in pythia.event:\nif p.isFinal() and p.isHadron() and p.isCharged(): nCharged += 1\nmult.fill(nCharged)\n# Plot the histogram using the matplotlib library. import matplotlib.pyplot as plt fig = plt.figure() ax = fig.add_subplot(111) y, ye = mult.get() ax.errorbar(mult.xvals,y,xerr=[w/2. for w in mult.widths], yerr=ye, drawstyle='steps-mid',fmt='-',color='black') ax.set_xlabel(r'$dN_{ch}/d\\eta$') ax.set_ylabel(r'$P(dN_{ch}/d\\eta)$') plt.show()\nPart IV\nSummary and Outlook Our goal in writing this manual was to provide reference material for users and developers of PYTHIA 8.3. We provided some basic content that we considered mandatory, such as defining what is an event generator, how does our code structure reflect the physics, and what sorts of numerical methods we use in the program. This is covered in part I. The core of the manual, provided in part II, describes in detail the phenomenon that is simulated and our assumptions and approximations. Parton showers and hadronic or nuclear physics are covered in more detail because these have been the arenas of more recent development. Other topics are covered more liberally in the HEP literature, and we hope to have provided enough outside references. What is somewhat new compared to other PYTHIA manuals is part III, dedicated to the user of PYTHIA 8.3. Our aim was not to give the user an easy way to skip the description of physics, but to facilitate the use of the program in real analyses and investigations. This part of the manual is the most pragmatic, but also the one most susceptible to acronyms, initialisms, and jargon. It is also the most technical in describing our and others\u2019 computer code.\nThis manual is a snapshot of an evolving entity. Within a short period of our concluding statements, new developments will arise that are not covered in this manual. We hope this continues, even as we pass the torch to the next generation of PYTHIA authors and contributors.\nJames D. Bjorken (\u201cBJ\u201d to his generation) wrote of the \u201ctyranny\u201d of Monte Carlo in a short paragraph of a larger editorial on the future of particle physics in 1992 [419]. He lamented the fact that Monte-Carlo predictions were taken as the truth, event though most of the prediction was a black-box. Had he read this manual in 2022, we hope he would understand that the authors have provided a code that is more democratic, and allows users to liberally test ideas, but within well-defined boundaries. As such, there is no single PYTHIA prediction to compare to data."
        },
        {
            "heading": "Acknowledgements",
            "text": "A large number of people should be thanked for their contributions to the PYTHIA 8.3 event generator.\nFirst of all, Bo Andersson and G\u00f6sta Gustafson are the originators of the Lund model, and have strongly influenced the development of both early code versions and also recent model additions. Hans-Uno Bengtsson should furthermore be acknowledged as the originator of the PYTHIA program.\nSome made contributions dating way back in the programs\u2019 history, others more recently. While praise for the contributions should go to the contributors, blame for mistakes made in modifications to the original code, or failure to keep it up-to-date, should rest with the core authors.\nFormer authors\nFormer PYTHIA 8 authors, who are no longer active in the field, are: Stefan Ask, Jesper Roy Christiansen, Richard Corke, Nadine Fischer, and Christine O. Rasmussen. The merging of VINCIA into PYTHIA 8.3 brought with it further significant author contributions from Helen Brooks in particular.\nFurther contributions\nThe program has received many smaller and larger contributions and bug reports over time, from users to numerous to mention here. They are mentioned in the online update notes as the bug fixes go in, and are all gratefully acknowledged.\nIn particular, contributions from the following should be mentioned: Baptiste Cabouat for developing and implementing the initial-final dipole approach, Silvia Ferreres-Sol\u00e9 for implementing the space-time hadronic production points in string fragmentation, and Tomas Kasemets for implementation of new proton PDFs.\nCode contributions from the following collaborators and users are also gratefully acknowledged: O. Alvestad, S. Baker, B. Bellenot, R. Brun, A. Buckley, M. Cacciari, L. Carloni, S. Carrazza, R. Ciesielski, V. Hirschi, N. Hod, H. Hoeth, J. Huston, M. Kirsanov, A. Larkoski, B. Lloyd, J. Lopez-Villarejo, O. Mattelaer, M. Montull, A. Morsch, A. Naumann, S. Navin, P. Newman, M. Ritzmann, J. Rojo, G. Salam, K. Savvidy, G. Savvidy, A. Singh, G. Soyez, M. Sutton, R. Thorne, and G. Watt. We also thank J. Altmann and T. Garnett for correction of typos in this manuscript.\nFinally, vigilant code tests of PYTHIA releases by Mikhail Kirsanov, Dimitri Konstantinov, and Vittorio Zecca are gratefully acknowledged.\nFinancial support\nThe Lund and Monash groups have received financial support from the EU H2020 Marie Sk\u0142odowska-Curie Innovative Training Network MCnetITN3, grant agreement 722104.\nThe Lund group has also received funding from the European Research Council (ERC) under the European Union\u2019s Horizon 2020 research and innovation programme, grant agreement No 668679 (MorePheno), and from the Swedish Research Council, contract number 2016-05996.\nThe Jyv\u00e4skyl\u00e4 group (IH and MU) has been funded as a part of the CoE in Quark Matter of the Academy of Finland.\nCB and LL acknowledge support from the Knut and Alice Wallenberg foundation, contract number 2017.0036.\nSC and LL acknowledge support from the Swedish Research Council, contract number 2020- 04869.\nND acknowledges support from the Science and Engineering Research Board, Government of India under Ramanujan Fellowship SB/S2/RJN-070.\nSM is supported by the Fermi Research Alliance, LLC under Contract No. DE-AC02-07CH11359 with the U.S. Department of Energy, Office of Science, Office of High Energy Physics.\nPS acknowledges support from the Australian Research Council via Discovery Project DP170100708 \u2014 \u201cEmergent Phenomena in Quantum Chromodynamics\u201d.\nRV acknowledges support from the European Research Council (ERC) under the European Union\u2019s Horizon 2020 research and innovation programme (grant agreement No. 788223, PanScales), and from the Science and Technology Facilities Council (STFC) under the grant ST/P000274/1.\nCTP acknowledges support from the Swiss National Science Foundation (SNF) under contract 200021-197130, the Monash Graduate Scholarship, the Monash International Postgraduate Research Scholarship, and the J. L. William Scholarship.\nIH acknowledges support from the Academy of Finland, project numbers 308301 and 331545, and from the Carl Zeiss Foundation.\nMU acknowledges support from the Academy of Finland, project number 336419.\nPI acknowledges support from the United States National Science Foundation (NSF) via grant NSF OAC-2103889.\nAppendices"
        },
        {
            "heading": "A Full list of internal processes",
            "text": "A.1 Standard model processes\nA.2 Beyond-the-Standard-Model processes\nList of acronyms Below follows a list of standard acronyms used throughout the text, with a reference to the page where the acronym is first introduced.\n2HDM Two\u2013Higgs Doublet Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39 AQM Additive Quark Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .119 BSM Beyond Standard Model of Particle Physics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 CKKW-L Catani\u2013Krauss\u2013Kuhn\u2013Webber\u2013L\u00f6nnblad . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106 CM Centre of Mass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21 CMW Catani\u2013Marchesini\u2013Webber . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69 CR Colour Reconnection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10 DGLAP Dokshitzer\u2013Gribov\u2013Lipatov\u2013Altarelli\u2013Parisi . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50 DIS Deep Inelastic Scattering in the context of ep collisions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34 DL Donnachie\u2013Landshoff . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115 DM Dark Matter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42 DPS Double Parton Scattering . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53 EPA Equivalent Photon Approximation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144 EW Electroweak . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21 FI Final\u2013Initial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71 FSR Final\u2013State Radiation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .10 HEP High\u2013Energy Physics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149 HI Heavy Ion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149 HV Hidden Valley . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41 IF Initial\u2013Final . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71 II Initial\u2013Initial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .70 ISR Initial\u2013State Radiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 LC Leading Colour . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63 LEP Large Electron\u2013Positron Collider . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12 LHC Large Hadron Collider . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 LHA Les Houches Accord. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .224 LHE Les Houches Event also LHEF: Les Houches Event File. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .11 LO Leading Order . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 LIPS Lorentz Invariant Phase Space . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21 LL Leading Logarithmic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61 MB Minimum Bias . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135 MBR Minimum Bias Rockefeller . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115 MC Monte Carlo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13 MCMC Markov Chain Monte Carlo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .8 MEC Matrix Element Corrections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81 MPI Multiple Parton Interactions or Multi\u2013Parton Interactions. . . . . . . . . . . . . . . . . . . . . . . . . . . .10 MSSM Minimal Supersymmetric Simplified Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40 NLC Next\u2013to\u2013Leading Colour also NNLC etc. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63 NLL Next\u2013to\u2013Leading Logarithmic also NNLL etc. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .63 NLO Next\u2013to\u2013Leading Order also NNLO, N3LO etc. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40 NN Nucleon\u2013Nucleon. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .150 NRQCD Non\u2013Relativistic Quantum Chromodynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36\nPDF Parton Distribution Function. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .58 PDG Particle Data Group . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38 RF Resonance\u2013Final . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82 RHIC Relativistic Heavy Ion Collider. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .12 RPV R\u2013Parity Violating . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40 SaS Schuler and Sj\u00f6strand or DL/SaS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116 SIDIS Semi\u2013Inclusive DIS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143 SLHA SUSY Les Houches Accord . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 SM Standard Model (of Particle Physics) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .12 UMEPS Unitarised Matrix Element + Parton Shower. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .106 UPCs Ultra\u2013Peripheral Collisions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148 QCD Quantum Chromodynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 QED Quantum Electrodynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44 QGP Quark\u2013Gluon Plasma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170 SUSY Supersymmetry or Supersymmetric . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .40 VBF Vector Boson Fusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27 VMD Vector Meson Dominance. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .119"
        }
    ],
    "title": "A comprehensive guide to the physics and usage of PYTHIA 8.3",
    "year": 2022
}