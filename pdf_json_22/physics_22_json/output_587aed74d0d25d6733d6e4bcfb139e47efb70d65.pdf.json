{
    "abstractText": "This journal is \u00a9 The Royal Society of Chemistry 2022 Cite this: Energy Environ. Sci., 2022, 15, 2958 Identifying structure\u2013absorption relationships and predicting absorption strength of non-fullerene acceptors for organic photovoltaics\u2020 Jun Yan, \u2021 Xabier Rodr\u0131\u0301guez-Mart\u0131\u0301nez,\u2021* Drew Pearce, Hana Douglas, Danai Bili, Mohammed Azzouzi, Flurin Eisner, a Alise Virbule, Elham Rezasoltani, Valentina Belova, c Bernhard D\u00f6rling, Sheridan Few, Anna A. Szumska, Xueyan Hou, Guichuan Zhang, Hin-Lap Yip, Mariano Campoy-Quiles * and Jenny Nelson *",
    "authors": [
        {
            "affiliations": [],
            "name": "Jun Yan"
        },
        {
            "affiliations": [],
            "name": "Xabier Rodr\u0131\u0301guez-Mart\u0131\u0301nez"
        },
        {
            "affiliations": [],
            "name": "Drew Pearce"
        },
        {
            "affiliations": [],
            "name": "Hana Douglas"
        },
        {
            "affiliations": [],
            "name": "Danai Bili"
        },
        {
            "affiliations": [],
            "name": "Mohammed Azzouzi"
        },
        {
            "affiliations": [],
            "name": "Flurin Eisner"
        },
        {
            "affiliations": [],
            "name": "Alise Virbule"
        },
        {
            "affiliations": [],
            "name": "Elham Rezasoltani"
        },
        {
            "affiliations": [],
            "name": "Valentina Belova"
        },
        {
            "affiliations": [],
            "name": "Bernhard D\u00f6rling"
        },
        {
            "affiliations": [],
            "name": "Sheridan Few"
        },
        {
            "affiliations": [],
            "name": "Anna A. Szumska"
        },
        {
            "affiliations": [],
            "name": "Xueyan Hou"
        },
        {
            "affiliations": [],
            "name": "Guichuan Zhang"
        },
        {
            "affiliations": [],
            "name": "Hin-Lap Yip"
        },
        {
            "affiliations": [],
            "name": "Mariano Campoy-Quiles"
        }
    ],
    "id": "SP:97957240de4b56b1c254a71c3d973185ae049afb",
    "references": [
        {
            "authors": [
                "J. Nelson"
            ],
            "title": "The Physics of Solar Cells",
            "year": 2003
        },
        {
            "authors": [
                "R. Todeschini",
                "V. Consonni"
            ],
            "title": "Molecular Descriptors for Chemoinformatics",
            "venue": "edn,",
            "year": 2009
        }
    ],
    "sections": [
        {
            "text": "2958 | Energy Environ. Sci., 2022, 15, 2958\u20132973 This journal is \u00a9 The Royal Society of Chemistry 2022\nCite this: Energy Environ. Sci., 2022, 15, 2958\nIdentifying structure\u2013absorption relationships and predicting absorption strength of non-fullerene acceptors for organic photovoltaics\u2020\nJun Yan, \u2021a Xabier Rodr\u0131\u0301guez-Mart\u0131\u0301nez,\u2021*bc Drew Pearce,a Hana Douglas,a Danai Bili,a Mohammed Azzouzi,a Flurin Eisner, a Alise Virbule,a Elham Rezasoltani,a Valentina Belova, c Bernhard Do\u0308rling,c Sheridan Few,af Anna A. Szumska,a Xueyan Hou,a Guichuan Zhang,d Hin-Lap Yip,de Mariano Campoy-Quiles *c and Jenny Nelson *a\nNon-fullerene acceptors (NFAs) are excellent light harvesters, yet the origin of their high optical extinction is\nnot well understood. In this work, we investigate the absorption strength of NFAs by building a database of time-dependent density functional theory (TDDFT) calculations of B500 p-conjugated molecules. The\ncalculations are first validated by comparison with experimental measurements in solution and solid state using common fullerene and non-fullerene acceptors. We find that the molar extinction coefficient (ed,max) shows reasonable agreement between calculation in vacuum and experiment for molecules in solution,\nhighlighting the effectiveness of TDDFT for predicting optical properties of organic p-conjugated molecules.\nWe then perform a statistical analysis based on molecular descriptors to identify which features are important\nin defining the absorption strength. This allows us to identify structural features that are correlated with high\nabsorption strength in NFAs and could be used to guide molecular design: highly absorbing NFAs should\npossess a planar, linear, and fully conjugated molecular backbone with highly polarisable heteroatoms. We then exploit a random decision forest algorithm to draw predictions for ed,max using a computational framework based on extended tight-binding Hamiltonians, which shows reasonable predicting accuracy with\nlower computational cost than TDDFT. This work provides a general understanding of the relationship\nbetween molecular structure and absorption strength in p-conjugated organic molecules, including NFAs,\nwhile introducing predictive machine-learning models of low computational cost.\nBroader context Organic p-conjugated semiconductors (OSCs) work as the main light harvesters in organic photovoltaics (OPVs). Their synthetic versatility converts them onto suitable candidates for rational molecular design based on high-throughput screening techniques. Significant advances in the efficiency of OPVs (exceeding 19% in single junctions under 1 sun) have been made by trial-and-error with new but increasingly diverse materials, primarily non-fullerene acceptors (NFAs) and mostly owing to their high absorption strength. However, the reasons for that superior light harvesting performance remain elusive, thus preventing the molecular tailoring of NFAs with further enhanced light harvesting capabilities toward breakthrough OPV efficiencies. A statistical analysis of time-dependent density functional theory calculations and machine learning (ML) models reveal that molecular linearity, planarity, polarizability, and number of p-conjugated carbon atoms correlate strongly with the absorption strength of OSCs. A structure\u2013absorption strength relationship is established to introduce design rules for highly absorbing OSCs. ML models, in combination with extended tight-binding Hamiltonians, are shown to predict the absorption strength of OSCs. As a result, this work contributes to an improved understanding of the absorption strength of p-conjugated organic molecules in general while suggesting ways to design highly absorbing NFAs that maximize the light harvesting capabilities for solar energy conversion.\na Department of Physics, Imperial College London, SW7 2AZ, London, UK. E-mail: jenny.nelson@imperial.ac.uk b Electronic and Photonic Materials (EFM), Department of Physics, Chemistry and Biology (IFM), Linko\u0308ping University, Linko\u0308ping, SE 581 83, Sweden.\nE-mail: xabier.rodriguez.martinez@liu.se c Instituto de Ciencia de Materiales de Barcelona, ICMAB-CSIC, Campus UAB, Bellaterra 08193, Spain. E-mail: mcampoy@icmab.es d Institute of Polymer Optoelectronic Materials and Devices, State Key Laboratory of Luminescent Materials and Devices, South China University of Technology,\nGuangzhou 510640, P. R. China e Department of Materials Science and Engineering, City University of Hong Kong, Tat Chee Avenue, Kowloon, Hong Kong f Sustainability Research Institute, School of Earth and Environment, University of Leeds, LS2 9JT, Leeds, UK \u2020 Electronic supplementary information (ESI) available. See DOI: https://doi.org/10.1039/d2ee00887d \u2021 J. Y. and X. R.-M. contributed equally to this work.\nReceived 18th March 2022, Accepted 20th May 2022\nDOI: 10.1039/d2ee00887d\nrsc.li/ees\nEnergy & Environmental Science\nPAPER\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\nView Article Online View Journal | View Issue\nThis journal is \u00a9 The Royal Society of Chemistry 2022 Energy Environ. Sci., 2022, 15, 2958\u20132973 | 2959"
        },
        {
            "heading": "1. Introduction",
            "text": "Organic photovoltaic (OPV) energy conversion is a promising option among next generation renewable and sustainable energy technologies for a low-carbon energy future.1\u20133 OPV has shown promising potential for various applications, such as indoor photovoltaics (PV),4\u20136 semi-transparent solar windows,7,8 PV greenhouses,9 and off-grid power supply.10 Recent OPV devices 1based on non-fullerene acceptors (NFAs) have demonstrated certified power conversion efficiencies (PCEs) exceeding 19% in a single junction configuration,11 approaching the efficiencies observed in inorganic semiconductor PV technologies such as crystalline silicon and perovskite solar cells, and far higher than values thought attainable in OPV when using fullerene derivatives as the electron-acceptors.12 The startling progress led by NFAs can be attributed to various advantages over fullerene derivatives, such as band-gap tunability, sharp absorption onset, high emission, high absorption, and low energy losses.13\u201315 Among these advantages, the absorption strength of state-of-the-art NFAs is particularly outstanding, as exemplified in Fig. 1c (a detailed list of chemical names and nomenclatures is provided in Note S1, ESI\u2020).16 For instance, Y6 shows a maximum extinction coefficient (kmax) over 1.5 in the visible part of the electromagnetic spectrum, as compared to less than 0.75 for fullerene derivatives (PC61BM and PC71BM). A high extinction coefficient increases the chance of high quantum efficiency and photogenerated current density, and makes it possible to fabricate highly absorbing OPV films with just a few tens of nanometre-thick photoactive layers. In comparison with workhorse fullerene acceptors, OPV devices based on highly absorbing NFAs could be made comparably thinner than the former, which exponentially raises the output power per weight (i.e. the specific weight in W g 1) of OPV devices17 and might be an effective route toward lower production costs (as less material could employed to achieve an equivalent PCE) and even increase device thermal stability.18 Moreover, through detailed balance between photon absorption and emission,19,20 high absorption strength in principle should lead to high emission from the NFAs, while strong NFA emission is believed to be a key reason for NFAbased OPVs to possess low nonradiative voltage losses.21\u201325 Despite the clear advantage of strong photo-absorption of NFAs over fullerene derivatives, the phenomenon has attracted much less attention than other properties of NFAs.21\u201323,25\u201328 Conceptually, symmetry rules (i.e., the Laporte rule) can explain the qualitative difference between NFAs and fullerene derivatives in terms of absorption strength, yet such rules cannot predict differences in absorption strength among structures for which the lowest transitions are symmetry allowed. The features empirically and theoretically proposed29,30 to lead to strong absorption in p-conjugated polymers are molecular stiffness, linearity, extended p-conjugation and large molecular size. It is therefore of interest to establish whether the same (or other) molecular features are quantitatively associated or not with increased absorption strength in NFAs, while seeking molecular design rules to drive absorption and performance higher in new molecules.\nExcited state calculations based on quantum chemistry methods, such as time-dependent density functional theory\n(TDDFT),8,29,31\u201333 Hartree\u2013Fock method,34 ab initio Monte Carlo method,35 second order M\u00f8llier\u2013Plesset theory (MP2),36 and coupled cluster method,37 have been applied to predict the electronic and optical properties of molecules. Among them, TDDFT is the most widely applied method for excited state calculations, and has shown reasonable accuracy in calculating and predicting the trends in absorption strength of organic molecules,29,31 as also demonstrated in this work. However, the rapid scaling of computation time with molecular size has been the real obstacle limiting the applicability of TDDFT for excited state calculations on molecules with hundreds of atoms. Given the size and diverse structure of modern NFAs, faster and more efficient methods are therefore needed to establish the relationship between excited-state and molecular properties in NFAs.\nThe emergence of artificial intelligence (AI) has made it possible to study quantitative structure\u2013property relationships (QSPRs) in molecules with massively improved computational efficiency. As the most popular branch of AI, machine-learning (ML) has attracted much attention in materials science over the last decade, and has been widely applied for material property prediction and material discovery.38\u201341 Recently, ML has also gained popularity in OPV scenarios,42\u201352 yet existing ML studies related to OPVs have been primarily focused either on the energetics42,43,53\u201356 or directly on PCE,42,48,57\u201364 with little attention paid to the absorption strength of the photoactive materials.65,66 Moreover, there are no ML studies explicitly focused on the absorption strength of NFAs beyond the identification of moieties of frequent appearance in highly absorbing molecules.42 However, QSPR and ML models have been successfully applied to investigate the absorption strength of fluorophores or dyes typically employed in bioimaging, showing encouraging results.30,67,68 Therefore, it is appealing to apply ML methods in combination with QSPR models to investigate the origin of the large absorption strength in state-of-theart NFAs.\nHere, we present an experimental, TDDFT, QSPR, statistical and ML study of the absorption strength of NFAs to identify the key chemical and structural features that lead to high optical absorption in state-of-the-art NFAs. We exploit a database of nearly 500 unique organic molecules (or 3500 calculations) generated using DFT and TDDFT over several years. We obtain good quantitative agreement between TDDFT calculations of absorption strength and experimental values for state-of-the-art NFAs and fullerenes, which supports the use of TDDFT results for further statistical and QSPR modelling. Accordingly, we extract molecular information from the DFT-optimized geometries by computing nearly 6000 molecular descriptors and first looking for correlations with the absorption strength. The strongest correlations are found between experimentally measured maximum molar extinction coefficient (ed,max) and two main molecular descriptors from calculations: l1,p and C2SP2, which describe the size of the molecule in the direction of maximal atomic polarizability, and the number of sp2 hybridized carbon atoms that are bound to two other carbons (C2), respectively. These quantities can be related to a few key material features leading to high absorption strength: linearity,\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\n2960 | Energy Environ. Sci., 2022, 15, 2958\u20132973 This journal is \u00a9 The Royal Society of Chemistry 2022\nFig. 1 (a) Molecular structures of typical organic acceptors, including PC61BM, PC71BM, O-IDFBR, O-IDTBR, ITIC, IT-4F, IDIC, IEICO, IEICO-4F, Y5, Y6, and Y7. (b) Refractive index and (c) extinction coefficient of a larger set of typical organic acceptor thin films measured using VASE. (d) Experimental ed,max in solution versus calculated ed,max in vacuum using TDDFT of a set of B80 p-conjugated molecules. (e) Estimated experimental ed,max in film (solid state) versus that in solution using eqn (3). Panel (d) contains a subset of well-known NFA molecules that are highlighted in colour. All TDDFT results in panel (d) were performed using the functional B3LYP and basis set 6-311+G(d,p), except for the ones (grey squares) taken from ref. 69 that are based on the LRC-wPBEh functional and 6-311+G(d) basis set. We also note here that the side chains of molecules are replaced by H atoms or methyl groups in the calculations as they are computationally expensive and do not contribute to the p-conjugation, hence electronic transitions.29 The experimental data of ed,max in film are converted from maximum values of extinction coefficients shown in panel (c) using eqn (3), while solution data are collected from literature, noting that different values may be present for the same material as retrieved from different sources. Grey dashed lines indicate the perfect match between x and y axis. The data required for generating panels (d) and (e) in this figure are presented in the ESI.\u2020\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\nThis journal is \u00a9 The Royal Society of Chemistry 2022 Energy Environ. Sci., 2022, 15, 2958\u20132973 | 2961\nplanarity, and extension of the p-conjugation in the form of fused and closed-ring moieties, in good agreement with previous ML reports on fluorophores and dyes.30 We further identify several moieties and paired combinations thereof that are frequently found in highly absorbing NFAs, corresponding to thieno[3,2-b]thiophene (TT), thiophene (T), 2-(5,6-difluoro-3oxo-2,3-dihydro-1H-inden-1-ylidene)malononitrile (2FIC), 2-(3-oxo2,3-dihydro-1H-inden-1-ylidene)malononitrile (IC) and indaceno [1,2-b:5,6-b0]dithiophene (IDT). These form a catalogue of molecular design rules to further enhance the absorption strength of organic p-conjugated molecules, such as next-generation NFAs. We then train and test an ensemble learning method, namely a random decision forest (RF), to predict ed,max and provide further information about the most important features in the modelling of absorption strength in organic p-conjugated molecules. Finally, we explore the possibility to predict ed,max while using a cheaper molecular geometry optimization method based on semiempirical extended tight-binding (xTB) Hamiltonians instead of the expensive DFT approach. We do so by training a RF with our TDDFT database and proving its predictive properties in terms of ed,max when interpolated using xTB-optimized geometries. This approach shows application potential in highthroughput screening studies in combination with generative molecular models."
        },
        {
            "heading": "2. Results and discussion",
            "text": ""
        },
        {
            "heading": "2.1. Experimental validation of calculated absorption strength using TDDFT",
            "text": "Quantifying how well the TDDFT derived excited state properties agree with the experimental measurements in terms of absorption strength is of utmost importance to validate our theoretical calculations and support further conclusions extracted thereof. Accordingly, we first evaluate the agreement between TDDFT calculations and experimental data in terms of the absorption strength. We compare the absorption strength of a broad catalogue (B10 molecules) of NFA molecules and widely studied fullerene derivatives (PC61BM and PC71BM, with their molecular structures shown in Fig. 1a) as obtained from TDDFT calculations, with a variety of optical measurements in both solution and solid state. For the most representative NFAs examined, we verify that their frontier molecular orbital energy levels as retrieved from TDDFT calculations are properly aligned, relative to those of a set of common polymer donors, for the NFAs to act as electron acceptor in a bulk heterojunction blend with those donors (Fig. S1, ESI\u2020). The measured refractive index (n) and extinction coefficient (k) of those molecules in thin film obtained using our variable-angle spectroscopic ellipsometry (VASE) measurements are shown in Fig. 1b and c. Solution state data shown in Fig. 1d and e are collected from a variety of literature references as detailed in the ESI.\u2020 1\nAs a metric for absorption strength, we initially consider several candidates such as the oscillator strength ( fosc), the absorption coefficient (a) or the imaginary part of the dielectric function (e2). In this work, we eventually focus on the maximum\nmolar extinction coefficient (ed,max, M 1 cm 1) of NFAs as it shows the best agreement between experimental and theoretical data, as we demonstrate below. ed,max constitutes a typical experimental measurement in solution that can also be accessed from myriad literature references. Note that the usual calculations based on single molecules using TDDFT cannot account for solid state effects as they are performed for isolated molecules in vacuum or surrounded by an isotropic medium (such as a solvent using the polarizable-continuum-solventmodel, PCM, Fig. S2, ESI\u2020). The derivation of the theoretical ed is provided in the Methods section, which results in a mathematical expression for ed,max as\ned;max \u00bc 10 log10 e\u00f0 \u00deNA 2pe h\n3e0m0nrc fosc;max\n1\ns ffiffiffiffiffi 2p p ; (1)\nwhere NA is the Avogadro constant, e the elementary charge, h the reduced Planck constant, e0 the vacuum permittivity, m0 the electron mass, nr is the refractive index in solution (assumed to be 1.3 of a common organic solvent throughout this study), and c the speed of light. fosc,max is the oscillator strength of the strongest transition among the calculated states within the visible-IR part of the spectrum, and Emax is the energy of that transition. The brightest transition is very often the lowest-energy transition in commonly used p-conjugated molecules.29 We note here that the delta function in eqn (17) is replaced with a Gaussian distribution function with a peak intensity of 1\ns ffiffiffiffiffi 2p p , where s is the Gaussian width and assumed\nto be 0.1 eV for a common organic pi-conjugated molecule. The experimental ed,max from solution can be obtained using the optical density (OD) measurements performed using UV-visible spectroscopy, via\ned;max \u00bc ODmax\nrd ; (2)\nwhere ODmax is the maximum optical density, r is the molar concentration (M), and d the light path length of the cuvette (cm). Similarly, the experimental ed,max from film can be estimated assuming a mass concentration rM in the film of 1000 g L\n1 (as a typical value for conjugated polymers and small molecules),29 either from the maximum absorption coefficient acm,max (cm 1) or extinction coefficient (kmax) (Fig. 1c), via\ned;max \u00bc log10 e\u00f0 \u00deacm;max Mw\nrM \u00bc log10 e\u00f0 \u00de 4pkmax lmax Mw rM ; (3)\nwhere Mw is the molecular weight in g mol 1, and lmax the wavelength at kmax in centimetre. Fig. 1d presents the results of the comparison between experimental ed,max in solution and theoretical ed,max calculated from single molecules using TDDFT in vacuum. A brief discussion of the solvent effect on the absorption strength and the reasons why we choose a vacuum medium are provided in Fig. S2 (ESI\u2020). Despite the scattering of data points, we observe the occurrence of a monotonic relationship between solution and calculated ed,max with a Pearson correlation coefficient (r) of 0.77. Interestingly, such correlation is no longer observed when\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\n2962 | Energy Environ. Sci., 2022, 15, 2958\u20132973 This journal is \u00a9 The Royal Society of Chemistry 2022\nquantifying the absorption strength in terms of amax neither when adding further data points from literature on p-conjugated fluorophores to our statistical analysis (Fig. S3a (ESI\u2020), r = 0.30), which is believed to be caused by the differences in molecular weight; in that case, only ed,max is found to follow a monotonic trend (Fig. S3b, ESI\u2020). Some of the material assumptions on refractive index and density required to obtain amax values might be responsible for the observed mismatch. It is worth noting that, expectedly, the correlation between solid state (film) and solution (r = 0.66, Fig. 1e) or calculated ed,max (r = 0.61, Fig. 1e) is not as good as that from solution data versus calculated ed,max (r = 0.77, Fig. 1d, neither for amax as shown in Fig. S4, ESI\u2020). Such discrepancy is attributed to solid-state effects such as aggregation effects,15 intermolecular orientation,70,71 and side chain interactions,72 which are not considered in single molecule excited state calculations.29 The observed trend that a highly absorbing material in solution will produce highly absorbing films is, nonetheless, generally valid and thus solution data are relevant for devices. Since the NFAs analysed here have a rather similar number of p-electrons (np), the corresponding ed,max per p-electron (Fig. S6, ESI\u2020) shows a similar trend as that in Fig. 1d, e, and Fig. S4 (ESI\u2020). Despite the simplicity of single molecule excited state calculations, these data show that using TDDFT calculations of the excited state to deliver ed,max can provide a reasonably good approximation to experimental measurements. Moreover, dealing with TDDFT calculations gives us room to correlate key molecular properties, such as molecular size and shape (aspect ratio), linearity, planarity, grafted side chain positions, or functional groups, to the absorption strength using molecular descriptors. These observations provide a foundation from molecular structures to identify the origin and further extend the high optical extinction of NFAs through chemical design rules, as we show in the upcoming sections."
        },
        {
            "heading": "2.2. Statistical analysis of the TDDFT absorption strength dataset",
            "text": "The experimental validation of the TDDFT calculations in NFAs supports the use of such results to build an extended database of optimized molecular geometries and excited state properties. The dataset is built by collecting thousands of molecular geometries generated over the last years in our group, making up a total of 3515 calculations on small molecules and oligomers. The distribution of number of atoms in a molecule is shown in Fig. S7 (ESI\u2020) with a majority lying between 50 and 100 atoms. This database is sufficiently diverse to allow us to detect correlations and chemical/structural design rules that could explain and/or further enhance optical absorption in conjugated small molecules.\n2.2.1. Correlation analysis of molecular descriptors. In the simplest statistical analysis of our TDDFT database, we look for correlations of the absorption strength with respect to a catalogue of molecular descriptors. First, as described in Note S2 (ESI\u2020), we filter the pristine TDDFT database by identifying duplicate molecules (in terms of molecular weight) and selecting the lowest energy conformer (i.e., optimized geometries in the\nground state) among them. As a result, the curated TDDFT database employed in this work consists of 479 p-conjugated small molecules and oligomers with a distribution of moieties shown in Fig. S9 (ESI\u2020).\nThen, we introduce several target features related with absorption strength, starting from the maximum oscillator strength of any calculated transition ( fmax); the maximum oscillator strength of any transition in the visible electromagnetic window (herein constrained between 300\u20131200 nm or 1\u20134 eV for its relevance in solar energy harvesting applications) ( fmax,vis); and the sum of oscillator strengths of all transitions in the visible window, fsum,vis. These three features are also evaluated per np for the molecule, i.e., fmax/np, fmax,vis/np and fsum,vis/np. We then consider the maximum absorption coefficient (amax) obtained using eqn (1) and (3); the maximum of the imaginary part of the dielectric function (e2,max);\n29 and ed,max. Finally, we compute the spectral overlap between the OD (da(E), where d is set to a typical film thickness value of 100 nm and a(E) derives from the Gaussian-broadened spectrum of f in the visible spectral range taking a standard deviation of 0.1 eV) and the AM1.5G solar photon flux spectrum (FAM1.5G), namely foverlap \u00bc \u00d0 4 eV 1eVFAM1:5G\u00f0E\u00deda\u00f0E\u00dedE\u00d0 4 eV\n1eVFAM1:5G\u00f0E\u00dedE .\nThese features, together with their corresponding histograms (Fig. S14, ESI\u2020) in terms of Spearman\u2019s rank correlation coefficients (r), are explained in more detail in Note S2 (ESI\u2020). Molecular descriptors are calculated using up to four different open-source packages73\u201376 (Note S2, ESI\u2020) to generate a (curated) collection of 3239 entries (including 40 electronic descriptors derived from the TDDFT calculations, namely the energy of the molecular orbitals ranging from HOMO 19 to LUMO+19). Then, we scan for statistical correlations between those descriptors and all target features introduced above, from which we consider as highly correlated descriptors those showing r Z 0.7 as threshold. However, since some descriptors are calculated in groups or families where weighting factors are varied among atomic masses, van der Waals volumes, electronegativities, ionization potentials or polarizabilities, we usually encounter sets of multicollinear descriptors that show very similar trends with respect to the target feature. Accordingly, to drop redundant (collinear) descriptors we classify them into clusters to select the most representative candidate of each bundle (i.e., cluster). This serves us to simplify the identification of characteristic and well-correlated descriptors families. The clustering algorithm applied to analyse multicollinear descriptors based on r and r values is further described in Note S3 (ESI\u2020).\nAfter running the clusterization of descriptors on all target features, we identify strong correlations with molecular descriptors for fmax, fsum,vis and ed,max (i.e., implicitly fmax,vis). For the remaining target variables ( foverlap, amax, e2,max, fmax/np, fmax,vis/np and fsum,vis/np), we do not identify molecular descriptors with r above the threshold value (0.7) and they are generally below 0.6 units, see Fig. S14 (ESI\u2020). The lack of correlation for foverlap could be justified by the existence of a gas-to-solid shift in the corresponding absorption spectrum, which prevents proper\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\nThis journal is \u00a9 The Royal Society of Chemistry 2022 Energy Environ. Sci., 2022, 15, 2958\u20132973 | 2963\nmatching of the Gaussian-broadened absorption features with the solar photon flux. Regarding amax and e2,max, the estimation of these values from TDDFT calculations requires taking generalized assumptions on several materials properties (such as density or refractive index) that might be enough to disturb the underlying trends in our heterogeneous material database. For the quantities normalised by the number of pi electrons, i.e. fmax/np, fmax,vis/np and fsum,vis/np, the weak correlation is expected since normalization tends to deviate from linear correlations depending on the straightness of the molecule.29 Due to the strong correlation between size of the molecule and oscillator strength as discussed below based on C2SP2, the normalised quantity is believed to be a secondary factor, therefore not clear correlations are observed. In the successful correlation cases (i.e. fmax, fsum,vis and ed,max) and with the given thresholds of 0.7 units for r and r, we identify a single feature cluster lead by the l1,p descriptor in the case of fmax and ed,max (Fig. 2a). For fsum,vis, a threshold r of 0.68 reveals C2SP2 as a rather descriptive molecular feature (Fig. 2b). Interestingly, C2SP2 is also found in the main cluster represented by l1,p in fmax and ed,max, and we could not identify any strong correlations between the absorption strength (in any of its proposed metrics) and electronic descriptors (from HOMO 19 to LUMO+19 energy levels). Note that ed,max values in excess of 2.5 105 M 1 cm 1 in Fig. 2a and b are mostly attributed to artificially straight conjugated oligomers with 410 monomers contained in our database, for which the straightness, hence high ed,max, are unlikely to be maintained in the experimental solid state scenario. In fact, only the exemplary and asymmetric NFA known as BDTP-4F (inset of Fig. 2a)77,78 surpasses that threshold with a record ed,max in our NFA dataset (2.7 105 M 1 cm 1, and 2.4 105 M 1 cm 1 measured in CHCl3 solution).77 l1,p is part of a bundle of three-dimensional molecular size and shape descriptors known as weighted holistic invariant molecular (WHIM) descriptors.79\u201381 These can be interpreted as a generalized search for the principal axes with respect to a defined atomic property.82 In this particular case, l1,p is obtained by performing a principal component analysis (PCA) on the centred atomic coordinates of the molecule using a covariance matrix (sjk) that is weighted by the atomic polarizabilities ( pi): sjk \u00bc PA i\u00bc1 pi qij qj qik qk\u00f0 \u00de PA i\u00bc1 pi ; (4) where sjk is the weighted covariance between the jth and kth atomic coordinates; A is the total number of atoms; pi is the\nFig. 2 (a) Correlation between, as calculated from TDDFT, and l1,p as obtained in the database of 479 molecules. The DFT-optimized geometry of BDTP-4F is shown in the inset. (b) Correlation between ed,max (and fsum,vis in the secondary axis) and C2SP2 in that same database. (c) DFT-optimized geometries of archetypal NFAs ordered by increased values of l1,p from bottom to top (CBM o Y6 o IEICO-4F o NIBT). Dotted red lines tentatively indicate the overall curvature of the main conjugated backbone of the molecule. l1,p and C2SP2 describe the size of the molecule in the direction of maximal atomic polarizability, and the number of doubly bound carbon atoms (sp2 hybridized) bound to two other carbons (C2), respectively.\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\n2964 | Energy Environ. Sci., 2022, 15, 2958\u20132973 This journal is \u00a9 The Royal Society of Chemistry 2022\n(tabulated) polarizability of the ith atom; qij and qik represent the jth and kth coordinate of the ith atom ( j, k = x, y, z), respectively; and %q is their average value.82 After diagonalization of the polarizability-weighted covariance matrix, the first eigenvalue (l1,p) quantifies the size of the molecule in the direction of maximal polarizability variance. Interestingly, the third eigenvalue (l3,p) approaches zero in planar molecules as a result of absence of variance in the out-of-plane (z) direction.82 On the other hand, C2SP2, which is not in the WHIM group, accounts for the number of doubly bound carbon atoms (sp2 hybridized, SP2) bound to two other carbons (C2), thus constituting a twodimensional descriptor of fast computation. The correlation between C2SP2 and absorption strength can be relatively easier to understand, as C2SP2 to some extent represents the size of the conjugated molecule. Enlarging the size of the molecule increases the total number of p-electrons, which controls the total oscillator strength following the Thomas\u2013Reiche\u2013 Kuhn rule. For the molecules that are extended along one direction, such as linear oligomers, increasing the size should enhance the oscillator strength of the first transition,29 i.e. the dominant one.\nTo further interpret these two magnitudes (l1,p and C2SP2) as the main correlated descriptors with ed,max and fsum,vis, we inspect the DFT-optimized geometries of archetypal NFAs (Fig. 2c). The observed trend suggests that optical extinction monotonically increases with l1,p (Fig. 2a) in molecules having most of their polarizable atoms arranged along a main axis, i.e., linear molecules. While CBM shows large torsion angles mainly affecting the 2,1,3-benzothiadiazole (BT) moieties (thus making the molecule non-planar and increasing l3,p, see Fig. S15, ESI\u2020), Y6 shows a characteristic curved geometry that limits its ed,max despite showing improved planarity. The NFA with the highest l1,p (NIBT) shows both linearity and planarity, with most of the more polarizable atoms (mainly C and S) lying along the principal polarizable axis of the molecule. Thus, in terms of molecular geometry, the absorption strength of NFAs could be further enhanced by distributing most of the atomic polarizability along a main axis while keeping good planarity and minimizing curvature. However, l1,p is not the sole molecular descriptor governing absorption strength, as BDTP-4F shows ca. 40% lower l1,p (0.75 nm\n2) yet ca. 40% higher ed,max than NIBT (Fig. 2a), which suggests that the molecular symmetry of NFAs could be another important factor affecting ed,max. Our preliminary investigations on this issue indicate that molecular asymmetry, as quantified by the WHIM symmetry index Gu, might drive absorption strength higher (Fig. S16a, ESI\u2020), yet we require a larger NFA database including more asymmetric molecules to further explore such an observation. Also, we acknowledge that this observation might be biased by the systematic omission of side chains in the TDDFT calculations. By comparing l1,p in a selection of small molecule acceptors geometrically optimized with and without side chains (Fig. S17a, ESI\u2020), we observe that in most cases the addition of side chains either decreases l1,p slightly or keeps it invariant. Still, the positive correlation of l1,p with respect to ed,max is maintained (Fig. S17b, ESI\u2020). Furthermore, the presence of\nnaphthalene imide derivatives in the molecular structure of NIBT could be hindering further increase of the absorption strength with l1,p, as suggested by our statistical analysis of frequent moieties in the selection of good light harvesters (presented in the next section). On the other hand, an increase of np in the molecule in the form of closed-ring conjugated moieties will systematically increase C2SP2 and accordingly fsum,vis. These findings support the previously known design rules in terms of molecular linearity and p-conjugation enabling large oscillator strength in organic small molecules and polymers, and are consistent with a recent study on chromophores.30 In particular, trans-conjugated polymer stereoisomers are known to possess higher optical extinction due to their increased straightness and persistence length,29 which agrees with our observations on exemplary curved (Y6) and more linear (NIBT) NFAs.\nThe energy of the first optical transition (E1) is also of practical importance in light harvesters such as NFAs as the lower energy part of the solar spectrum, down to B1 eV, contains a higher photon flux density. Our results show the number of heteroatoms in the molecule as the most correlated feature with (r = 0.72, Fig. S18a, ESI\u2020) while forming a single feature cluster, yet neither l1,p nor C2SP2 show strong correlations with E1. This fact prevents the introduction of molecular design rules targeted at E1 using l1,p or C2SP2. However, we acknowledge a negative correlation between E1 and fosc,max among common NFAs that suggests further room for absorption strength increase as E1 is reduced (Fig. S19, ESI\u2020).\n2.2.2. Chemical insights into highly absorbing molecules. Beyond molecular descriptors, we investigate the relationship between the choice of moieties and absorption strength to provide further material design rules for highly absorbing conjugated small molecules. Our objective is to identify overrepresented moieties in the subset of high-absorbing molecules (which we arbitrarily define as those having fosc,max 4 2.5, thus setting a population of size p) with respect to the entire molecular dataset (population of size P). Accordingly, we identify the molecular motifs present in the molecules by comparing their structures (as derived from SMILES notation) with those of a previously built database of moieties (also SMILESbased). This database of moieties was partly inherited from a previous work42 and extended with further motifs present in our particular dataset (see Note S4 (ESI\u2020) and the spreadsheet included as ESI\u2020). Afterwards, we consider that a discrete hypergeometric distribution is adequate to model our molecular dataset and the fragments found therein42 to calculate the corresponding Z-scores as Z = (k %k)/sk, where k is the number of high-absorbing molecules containing certain moiety; is its expected value, defined as pK/P where K corresponds to the number of molecules in the entire dataset containing that same moiety; and sk \u00bc ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi pK P K\u00f0 \u00de P p\u00f0 \u00de= P2 P 1\u00f0 \u00de\u00f0 \u00de p is the standard deviation of the hypergeometric distribution. Z-scores will indicate (in units of sk) which moieties are overrepresented or underrepresented in the subset of high-performing molecules with respect to the expected values when looking at the entire dataset. Our results (Fig. 3) suggest that thieno[3,2-b]thiophene\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\nThis journal is \u00a9 The Royal Society of Chemistry 2022 Energy Environ. Sci., 2022, 15, 2958\u20132973 | 2965\n(TT), thiophene (T), 2-(5,6-difluoro-3-oxo-2,3-dihydro-1H-inden1-ylidene)malononitrile (2FIC), 2-(3-oxo-2,3-dihydro-1H-inden1-ylidene)malononitrile (IC), indaceno[1,2-b:5,6-b0]dithiophene (IDT), 2-methylene malononitrile, cyanide, and aniline are particularly frequent in highly absorbing molecules. Interestingly, four of those molecular fragments (TT, T, 2FIC and IC) are contained in the chemical structure of the workhorse NFA Y6 (Fig. 2c). Contrarily, naphthalene imide derivatives, as typically encountered in n-type small molecules and conjugated polymers; 4H,8H-benzo[1,2-c:4,5-c0]dithiophene-4,8-dione and benzo[1,2-b:4,5-b0]dithiophene fragments are mostly underrepresented in the selection of high-performing light harvesters.\nWe further study the existing correlation between pairs of moieties to understand in which way the different molecular fragments should (or should not) be combined to retrieve highly-absorbing molecules. Our analysis starts by creating molecular subsets determined by the presence of a given moiety, which acts as source node (coloured in black) in the network graph shown in Fig. 3b. Within that subset, we identify the high-absorbing molecules (fosc,max 4 2.5) and compute the Z-scores of their moieties (child nodes, coloured in grey in Fig. 3b) with respect to the molecules of the entire molecular subset. As per the network shown in Fig. 3b, the absolute Z-scores will determine the width of the edges connecting the nodes (moieties) and its sign the colour of the edge (green for positive Z-score [overrepresentation] and red for negative Z-score [underrepresentation]). Therefore, green and thick edges connect pairs of molecules that are more frequently found in high-absorbing molecules whereas thick and red edges indicate combinations of moieties that lead to less absorbing molecules. In this analysis, we set up 8 different source nodes corresponding to the most overrepresented moieties observed in Fig. 3a. As a result, Fig. 3b can be interpreted as a catalogue of design rules relating pairs of moieties with high oscillator strength in p-conjugated small molecules."
        },
        {
            "heading": "2.3. Machine-learning modelling of the absorption strength",
            "text": "Besides providing useful chemical insights from a material design perspective, molecular descriptors can be exploited to feed regression models and draw predictions on certain target features, forming the so-called quantitative structure\u2013property relationship (QSPR) and quantitative structure\u2013activity relationship (QSAR) models.79,80,82,83 In the present study, we train and test several ML models fed with molecular and electronic descriptors obtained from TDDFT calculations to predict the value of ed,max in conjugated small molecules and oligomers. Finally, we propose exploiting such ML model (trained with TDDFT data) to predict ed,max in molecules optimized using a semi-empirical quantum chemistry method, i.e. xTB.84 This renders possible thanks to the geometrical similarity of the TDDFT and xTB ground state conformers, which lead to similar (geometrical) descriptors values; and the calibration of their corresponding energy levels, as per the required inputs of the ML model herein employed. Therefore, further molecular candidates beyond the pristine dataset could be geometrically optimized using solely xTB Hamiltonians and their absorption strength predicted using such ML model. This approach effectively bypasses the use of TDDFT calculations when screening the absorption strength of novel molecules, which results in less demanding computations and higher throughput. The present ML workflow will open the possibility to accelerate the screening of high-performing molecular candidates with low-to-moderate computational requirements (further discussed in Note S5, ESI\u2020).\n2.3.1. Modelling ed,max with random decision forests. From the analysis of descriptors shown in Section 2.2.1, we identified two main feature clusters represented by l1,p and C2SP2. We tentatively consider these two descriptors as independent variables in baseline models (such as 1-nearest neighbour and linear regression) targeted to ed,max. For the model training and\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\n2966 | Energy Environ. Sci., 2022, 15, 2958\u20132973 This journal is \u00a9 The Royal Society of Chemistry 2022\ntesting, we split our pristine dataset onto two subsets, namely the training set (gathering 70% of the data, randomly selected) and the testing set (gathering the remaining 30% of the data). Such baseline models are picked according to a recently introduced catalogue of good practices in the ML field,85 to demonstrate the requirement of more advanced regressors (namely ML) in successful data modelling. The models are scored and quantitatively compared based on workhorse fitting metrics, such as their coefficient of determination (R2); their adjusted coefficient of determination (Radj\n2, which adds penalties as the number of parameters increases, see Note S2, ESI\u2020); and their Pearson correlation coefficient (r), as retrieved in the training (fitting) and test sets. The inherent mathematical simplicity of the baseline models results in poor fitting scorings (Fig. S20 and Table S1, ESI\u2020) yet they suggest that feature selection procedures could end up in higherperforming models.\nAccordingly, we deploy a state-of-the-art ML method, namely a RF, to aid in both aspects: feature selection and building of ed,max models of higher accuracy. RFs constitute one of the simplest and most widely applied ML methods in molecular screening and data mining studies.30,43,46,86 They are particularly appealing for their straightforward implementation through open-source Python libraries such as Scikit-Learn,87 and also for their inherent robustness against overfitting and fast optimization. RFs are formed by an ensemble of decision trees (estimators) that are executed in parallel and independently from each other. Decision trees serve to classify data by starting from a single root node that is subsequently divided into child nodes, the latter being chosen randomly among the input features. At every node splitting step (i.e., decision making), the algorithm selects the pathway that minimizes the mean square error (MSE). Eventually, when every tree reaches its maximum extension (which is set arbitrarily via model hyperparameters), the predictions of all trees are averaged (ensembled), hence constituting the final predicted value of the RF. At this stage, myriad cross-validation (CV) techniques exist to evaluate the quality of the model and help in the tuning of hyperparameters. CV methods can estimate the ML model performance, evaluate potential over- or underfitting, and quantify how accurate the model is on drawing predictions on unseen data. In this work, we adopt two common cross-validation schemes, namely a repeated holdout CV; and a leave-one-out cross-validation (LOOCV). On the one hand, in a repeated holdout CV the pristine dataset is randomly split onto two distinct subsets, namely the training (here gathering 70% of the data) and testing (the remaining fraction of data, i.e. 30%) subsets. The model is trained and tested on the respective subsets, and the corresponding statistical metrics (R2, r, MSE, etc.) annotated. Eventually, the process is repeated k times (10-fold in this work), and all metrics are averaged to evaluate the ML model performance (its CV score). On the other hand, in a LOOCV the holdout process is taken to the extreme as the testing subset consists of a single data point while the remaining data is used in the training step. The process runs recursively for all data, thus eventually all data points are used for training and testing in the LOOCV protocol. Yet being\ncomputationally expensive, a LOOCV results in a more accurate estimate of model performance.\nTable S1 (ESI\u2020) includes the performance of an out-of-thebox RF model trained and cross-validated using 300 trees (estimators). Exemplary comparisons between the two previous baseline models (1-nearest neighbor and linear regression) and the out-of-the-box RF model are found in Fig. S20 (ESI\u2020). The RF models indicate that scoring functions (R2, r) well above 0.6\u20130.8 are feasible upon careful feature selection and further optimization of the RF regressor. Feature selection in RFs is usually performed by filtering variables based on their feature importance, which is a metric that accounts for how much a feature decreases the weighted variance in the node splitting steps of the decision trees. This property enables feature ranking to then apply myriad algorithms to filter out the least important variables as seen by the RF regressor. In this work, we perform a recursive feature elimination (RFE) procedure to the initial library of 3239 descriptors as described in Note S2 (ESI\u2020). In a RFE protocol, a significant fraction of the initial population of features is dropped in successive training steps of the RF ensemble. Features are dropped based on their corresponding feature importance until reaching an arbitrarily low number of input variables, hence simplifying the original model. Our RFE analysis shows that a threshold average R2 of 0.70 is achieved using a 12-variable model (R2 = 0.70 0.05, r = 0.84 0.03), which outperforms the RF model presented earlier while including a drastic reduction in the number of variables (from 3239 to 12). The sweet spot in model accuracy and number of degrees of freedom is found for the 10-variable model, which shows the maximum average Radj\n2 (0.67 0.06). Notably, a threshold R2 of 0.60 is already achieved training a 3-parameter RF model (R2 = 0.63 0.06, Radj2 = 0.62 0.06, r = 0.80 0.03), which is particularly appealing given its simplicity. The resulting three-variable model includes one three-dimensional descriptor (l1,v or WHIM_45, as computed by the RDKit library, Fig. 4a), one two-dimensional descriptor (CIC3, as computed by PaDEL software, Fig. 4b) and one electronic descriptor, in this case the energy level of the second molecular orbital below the frontier HOMO (HOMO 2, Fig. 4c). l1,v refers to the first eigenvalue of the covariance matrix weighted by the atomic van der Waals volumes; thus, l1,v is included in the multicollinear feature cluster represented by l1,p that we previously and statistically identified, showing nearly perfect correlation (r = 0.99) with l1,p. Accordingly, l1,v can be exchanged by l1,p without loss of performance in the RF model. This finding confirms that the linearity of the molecule (either quantified in terms of polarizabilities or van der Waals volumes) plays a key role in determining its absorption strength in the form of ed,max. On the other hand, CIC3 is a graph-based, third-order neighbourhood symmetry index82 which lacks a straightforward interpretation due to its mathematical complexity. We observe, however, that it linearly scales as log2 A, with A being the total number of vertices (atoms) in the graph (molecule)82 thus likely reflecting the size of p-conjugation as per the characteristics of our dataset. The interpretation of HOMO 2 as an important descriptor is more challenging, and\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\nThis journal is \u00a9 The Royal Society of Chemistry 2022 Energy Environ. Sci., 2022, 15, 2958\u20132973 | 2967\nit is not possible to substitute it by a different descriptor without a noticeable drop in the model performance (excepting HOMO 1, which shows r = 0.96).\nInterestingly, electronic descriptors (in particular) are required for the RF models to achieve their highest potential and scoring despite we have not observed strong correlations in our earlier statistical analysis. To probe it, we have performed the same RFE protocol yet skipping the set of electronic descriptors among the input features. Our results show that the top performing RF models (selecting 29 variables and getting R2 = 0.58 0.06, Radj2 = 0.48 0.07, r = 0.78 0.04; or selecting 9 variables to obtain Radj\n2 = 0.52 0.06, see Fig. S13, ESI\u2020) are yet behind the scorings recorded when the electronic descriptors are included in the list of features. Note that the performance without electronic descriptors is lower than the 3-parameter model that includes HOMO 2 as descriptor, highlighting its positive effect on the performance of the RF regressor.\nMolecular fingerprints have also been extensively exploited as input vectorial descriptors in statistical and ML models focused on feature prediction.42,88\u201390 Molecular fingerprints are usually represented as bit activation vectors of arbitrary length and degree of complexity, representing the absence or presence of certain molecular (bonding) pattern, moiety, functional group, or atom. In this work, we exploit the RDKit library to generate moiety fingerprints, MACCS keys, Morgan fingerprints, path-based or topological fingerprints, E-state\nfingerprints, and Coulomb vectors. These fingerprints are quickly computed and serve to complement and improve the learning process of the ML models employed herein.\nTo better analyse the influence of the different fingerprint vectors in improving the RF scoring, we trained and crossvalidated the 3-parameter RF model previously found in combination with all fingerprint vectors generated. The results shown in Table S2 (ESI\u2020) indicate that by adding a Morgan fingerprint vector of 64 bits to the initial set of input features the model performance can be substantially improved: R2 increases by 10% (relative), and r by another (relative) 5% (see Fig. 4d). Therefore, Morgan fingerprints are particularly suitable to finetune the training and prediction accuracy of ed,max in RF models although lacking of a straightforward physical interpretation. Additional refinement of the RF hyperparameters results in further improved models. We performed this optimization through a randomized search (in 350 iterations) of the hyperparameters controlling the number of estimators in the RF, the minimum number of samples per leaf node and the minimum number of samples required to split an internal node, which constitute the main adjustable hyperparameters of the RF algorithm. These results are shown in Table S3 (ESI\u2020), together with the scoring obtained in a rigorous LOOCV of the optimized RF model (Fig. 4e). As an alternative ensemble of decision trees, we have also tested and optimized an Extra Trees (ET) regressor in Scikit-Learn. Its performance is, however, very close to that attained in the workhorse RF regressor (Table S3 and Fig. S21, ESI\u2020).\nFig. 4 Correlation plots for ed,max and the three most important descriptors retrieved by the RF model: (a) l1,v; (b) CIC3; and (c) HOMO 2. (d) Holdout cross-validation run of a RF ensemble to predict ed,max. 70% of the data is randomly selected for training and the remaining fraction is used for testing; the process is repeated 10 times and the statistical metrics averaged. The RF model is trained with three molecular descriptors (l1,v; CIC3; and HOMO-2) and a Morgan fingerprint vector of 64 bits. (e) Leave-one-out cross-validation (LOOCV) of that same RF model using the optimized hyperparameter of 1200 estimators.\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\n2968 | Energy Environ. Sci., 2022, 15, 2958\u20132973 This journal is \u00a9 The Royal Society of Chemistry 2022\n2.3.2. Bypassing TDDFT calculations through machinelearning and extended tight-binding. xTB Hamiltonians have recently emerged as semi-empirical and low computational cost quantum chemistry methods.84 These have a remarkable potential in molecular screening when implemented in multilevel workflows where xTB is exploited first to identify plausible candidates using a minimal fraction of computational resources, to then leave room for higher-level DFT methods in selected candidates.84 In this work, we propose exploiting a ML model trained with DFT data to predict ed,max in molecular geometries optimized using xTB (Fig. 5a). This is expected to enable faster molecular screening and geometrical optimization steps, as both being entirely run using xTB Hamiltonians; followed by absorption strength (ed,max) prediction in a TDDFTtrained RF model. Notably, our estimations show that the geometrical optimization step using GFN2-xTB is ca. 3000 times faster than using DFT with a hybrid functional (B3LYP/ 6-311+G(d,p)), as discussed in Note S5 and Table S4 (ESI\u2020).\nNevertheless, the dissimilarity between xTB- and DFT-optimized molecular geometries might have a direct impact on the value of the (three-dimensional) molecular descriptors, and hence on the final accuracy of the interpolated ML model if some of those are included. Accordingly, we have first quantitatively compared both sets of molecular (non-electronic) descriptors by computing r in all of them and found that the median of their distributions is very close to unity in all cases (Fig. S22, ESI\u2020). Based on this finding, we proceed by training the RF model with TDDFT-derived descriptors and exploring how well the model interpolates when fed with xTB-derived descriptors. Fig. S23a (ESI\u2020) shows a leaveone-out interpolation of a RF model trained using TDDFT data and interpolated on GFN2-xTB-optimized molecules, descriptors and energy levels.84,91,92 In this kind of model validation, all TDDFT data is used in the training step excepting that for a single molecule, for which we retrieve its corresponding xTB-optimized geometry and descriptors as the sole interpolation (testing) dataset; this procedure is subsequently repeated for all molecules. Thus, the model performance is assessed by comparing the actual\nTDDFT-derived ed,max of the molecules (x-axis in Fig. 5b) with that predicted by a RF model trained with TDDFT data and interpolated using xTB-derived descriptors (y-axis in Fig. 5b). This is useful to evaluate whether such RF model fed with TDDFT data could be exploited to predict ed,max in unseen molecules that are geometrically optimized through xTB Hamiltonians.\nOur first model takes as inputs the three molecular descriptors found previously to be the most important features in the RF model together with their corresponding (64-bit) Morgan fingerprints. The scoring of the LOOCV in this preliminary model (R2 = 0.53, r = 0.74) is limited due to the existence of a mismatch between the absolute energy levels retrieved by either DFT (B3LYP) or GFN2-xTB methods (Fig. S23b, ESI\u2020). Thus, the RF model trained on TDDFT data needs proper calibration of the energy levels obtained through GFN2-xTB, which we perform using either a linear regression, a support vector regressor (SVR) or an additional RF model (Fig. S23c, ESI\u2020). By applying such calibration on the HOMO 2 energy levels, we obtain the champion RF model (R2 = 0.61, r = 0.78) shown in Fig. 5b using three molecular descriptors and a 64-bit Morgan fingerprint vector. Hence, Fig. 5b shows that molecular databases of xTB-optimized geometries could be exploited in combination with TDDFT-trained ML models to predict the absorption strength (ed,max) at significantly lower computational cost and with reasonable accuracy. The statistical analysis and ML modelling framework introduced here is thus expected to show large potential in the high-throughput screening of highly absorbing molecular candidates in combination with generative models (autoencoders and neural networks) as part of future work in the group."
        },
        {
            "heading": "3. Conclusion",
            "text": "We have demonstrated that TDDFT calculations agree reasonably well with the experimental maximum molar extinction coefficient (ed,max) in solution state by exploiting a database of TDDFT-optimized small molecular acceptors (NFAs) and donor\nFig. 5 (a) ML workflow used in this work to draw ed,max predictions. A RF model is trained on TDDFT data and interpolated (validated) on xTB geometries, including also their corresponding molecular descriptors. To improve the accuracy of the model, energy levels obtained using the GFN2-xTB Hamiltonian require calibration with TDDFT values (Fig. S23, ESI\u2020). (b) Leave-one-out interpolation of the resulting RF model using three input molecular descriptors (including calibrated energy levels) and a 64-bit Morgan fingerprint vector.\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\nThis journal is \u00a9 The Royal Society of Chemistry 2022 Energy Environ. Sci., 2022, 15, 2958\u20132973 | 2969\noligomers collected over the years. This finding supports further analysis of the molecular dataset to identify structure\u2013 absorption relationships by means of statistical and machinelearning (ML) methods. Through the exploration of molecular descriptors, we identify two features that are strongly correlated with ed,max, namely the linearity and planarity of the molecule in the direction of maximum atomic polarizability variance; and the number of sp2-hybridized carbon atoms bonded to two other carbons included in the molecule. These further suggest design rules that highly absorbing organic p-conjugated molecules (such as NFAs) should follow, namely a fully conjugated, planar and linear molecular backbone with more polarisable heteroatoms. We further identify that moieties such as thieno[3,2-b]thiophene (TT), thiophene (T), 2-(5,6-difluoro-3-oxo-2,3dihydro-1H-inden-1-ylidene)malononitrile (2FIC), 2-(3-oxo-2,3dihydro-1H-inden-1-ylidene)malononitrile (IC) and indaceno[1,2-b:5,6-b0]dithiophene (IDT) appear more frequently in molecules with the highest absorption strength. Finally, we demonstrate the feasibility of random decision forests (RFs) trained with a few (3) molecular descriptors and 64-bit Morgan fingerprint vectors to predict in molecular geometries optimized by a computationally less demanding method such as extended tightbinding (xTB). This approach shows the ability to bypass thorough TDDFT calculations, thus facilitating high-throughput screening of absorption strength in organic p-conjugated molecules in combination with generative molecular models."
        },
        {
            "heading": "4. Outlook",
            "text": "This work was motivated by the search for molecular design rules to enable higher PCE in organic solar cells. Although maximizing light absorption for a given optical band gap is a key requirement to enable record PCE, many additional physical processes contribute to photovoltaic performance but are not considered directly in the present work, namely, exciton diffusion, charge transfer, charge separation, charge transport and charge recombination. To date, there is no holistic modelling framework nor are there sufficient data to relate these multiple processes to device performance via chemical structure. However, developments in AI and ML methods are likely to advance the status of models for multiple property\u2013device performance relationships in the coming years.\nNevertheless, understanding how light harvesting alone can be maximized by smart molecular design is significant for improving several different aspects of OPV performance. Light absorption is the primary step towards charge generation and is therefore strongly related to the macroscopic short-circuit current density of the device. According to the reciprocity relation between absorption and emission,20 high absorption should in principle lead to strong emission, therefore reducing the nonradiative energy losses, and benefitting the open-circuit voltage. In addition, high absorption allows the fabrication of thin devices, therefore facilitating charge extraction and enhancing fill factor.93 Moreover, based on the causality principle, high absorption strength would lead to higher refractive index,\nwhich takes the first interference maximum of electric field to lower thicknesses, resulting in large light harvesting potential in thinner devices. Therefore, designing highly absorbing organic p-conjugated molecules has the potential to enhance different aspects relating to the performance of OPVs in conjunction with the proposed predictive ML model.\nA separate aspect for future work is the impact of solid-state molecular interactions on light absorption. This paper concerns the optical absorption of isolated molecules while applications normally require thin films of molecules. Although intermolecular interactions can strongly impact the strength as well as the spectrum of thin film absorption,94 this has been neglected in the present study due to the lack of a suitable database of computations and the lack of solid state packing information. In the future, ML approaches could be used to better understand and predict how solid state interactions affect optical absorption, and thereby improve molecular design rules. Such advances may be enabled by the growing capability in computational structure prediction as well as improved understanding of the impact of intermolecular interactions on excited state properties."
        },
        {
            "heading": "5. Experimental and theoretical methods",
            "text": "Excited state calculation database and experimental ed,max database: TDDFT results in this study are based on the functional B3LYP and were performed by present and past group members in Prof. Jenny Nelson\u2019s group at Imperial College London, making up more than 3500 entries (corresponding to 479 unique molecules). The majority of experimental solid state thin film ed,max values for NFAs shown in Fig. 1a\u2013c were measured using variableangle spectroscopic ellipsometry (VASE) for the present study. Neat films were deposited from solution by either spin- or bladecoating on glass substrates at distinct thicknesses (typically ranging from 30 to 150 nm). Ellipsometry data were acquired at three to five angles of incidence (551\u2013751) using a Sopralab GES-5E rotating polarizer spectroscopic ellipsometer (SEMILAB) coupled to a charge-coupled device (CCD) detector. Experimental solution ed,max were mostly collected from literature with a majority of data taken from ref. 95, and Y5, Y6, and Y7 measured using UV-visible spectroscopy. The complete database and sources are presented in the ESI.\u2020\nTheoretical description of molar extinction coefficient (ed): to calculate the molar extinction coefficient ed, let us start with defining the absorption coefficient a in a quantum picture (we stay with SI units for the moment). The absorption coefficient for transition from state 1 to state 2 can be defined as19,96\ndI dx \u00bc a12I ; (5)\nwhere I is light intensity, determined by the energy density of an electromagnetic wave via\nI \u00bc 1 2 nce0 E0j j2; (6)\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\n2970 | Energy Environ. Sci., 2022, 15, 2958\u20132973 This journal is \u00a9 The Royal Society of Chemistry 2022\nwhere n is the refractive index, e0 vacuum permittivity, c the speed of light, and E0 the amplitude of the electric field. For an electromagnetic wave, the rate of intensity attenuation dI\ndx is\nequal to the rate of loss of energy density from the field dU dt , and the latter is the product of transition rate G12 and transition energy h o12, and we have\ndI dx \u00bc NG12 ho12; (7)\nwhere N is the volume density of molecules and h the reduced Planck constant. Substituting for dI\ndx and I in the definition of\na12 we get\na12 \u00bc 2N ho12G12 nce0 E0j j2\n(8)\nThe transition rate G12 can be defined by Fermi\u2019s Golden Rule and the perturbing Hamiltonian given by H = d12E0 using dipole approximation, where d12 is the transition dipole moment of the transition. Considering randomly oriented transition dipoles relative to the direction of the exciting electromagnetic field, we have\nG12 \u00bc 2p 3 h d12 2 E0j j2d ho E2 \u00fe E1\u00f0 \u00de (9)\nUsing E2 E1 = h o12, we get\na12 \u00bc 4pNo12 3nce0 h d12 2d o o12\u00f0 \u00de (10)\nFrom an arbitrary transition from state i to state j, we can express above equation using oscillator strength of the transition (fij):\naij \u00bc 2pNe2\n3e0m0nc fijd o oij ; (11)\nwhere e is the elementary charge, and fij \u00bc 2m0o12 e2 h dij 2. Integrating over all transitions, we have\na\u00f0o\u00de \u00bc 2pNe 2\n3e0m0nc\nX\nij\nfijd o oij\n(12)\nTo correlate the absorption coefficient (a) with the molar extinction coefficient (ed), we need the definition of optical density (OD) and optical depth (ad). Light is attenuated by passing through a depth d of material such that\nI(d) = I0e ad = I010 OD (13)\nAnd optical density, or called sometimes absorbance is defined as.\nOD = redd, (14)\nwhere r is concentration in molar (M or mol L 1), and d is sample length in cm. Consequently, we have\ned \u00bc log10\u00f0e\u00de\nr acm \u00bc acm 2:303r ; (15)\nnoting that we now write the absorption coefficient per cm to distinguish from the expression for a above, which we did assuming SI units, hence acm \u00bc\na 100\n. r is moles of molecules per dm3. We now have\ned\u00f0o\u00de \u00bc 10 log10\u00f0e\u00deNA 2pe2\n3e0m0nc\nX\nij\nfijd o oij\n(16)\nLet us recast this in terms of photon energy E in eV, i.e. E \u00bc ho e , rather than angular frequency, so it is easier to consider the magnitude, and finally we have ed in the unit of M 1 cm 1.\ned\u00f0E\u00de \u00bc 10 log10 e\u00f0 \u00deNA 2pe h\n3e0m0nc\nX\nij\nfijd E Eij\n(17)\nThis allows us to compute the theoretical ed using the calculated oscillator strength at different transitions. And the common method to calculate the oscillator strength is time-dependentdensity-functional-theory (aka TDDFT).\nConverting complex refractive index from solid state ellipsometry measurements to ed: using ellipsometry measurements from film (solid state), we can extract the complex refractive index, Z\nZ = n + ik (18)\nwhere n is the refractive index, and k the extinction coefficient. The absorption coefficient (acm) is then determined by\nacm \u00bc 4pk lcm\n(19)\nwhere lcm is the wavelength in centimetre. Using eqn (15), and the relationship between molar concentration r and mass concentration rM, i.e., r \u00bc\nrM Mw , we have\ned \u00bc log10\u00f0e\u00deacm Mw\nrM \u00bc log10\u00f0e\u00de 4pk lcm Mw rM (20)\nwhere Mw is the molecular weight, g mol 1, and rM has the unit of g L 1, and is typically assumed to be 1000 g L 1.\nAuthor contributions\nJ. Y. and X. R.-M. contributed equally to this work and drafted the paper. J. Y. performed DFT and TDDFT calculations, absorption strength analysis, and data collection. X. R.-M. performed the statistical analysis and machine-learning study. D. P., H. D., D. B., M. A., A. V., S. F., A. A. S., and X. H. shared their DFT/TDDFT calculation results. F. E. prepared thin films of NFAs for VASE measurements. X. R.-M., V. B., and B. D. did VASE measurements. E. R. did UV-vis measurements of Y5, Y6, and Y7 in solution. G. Z. and H.-L. Y. provided Y5, Y6, and Y7. All authors gave critical review on this work. J. N. and M. C.-Q. supervised this work.\nConflicts of interest\nThere are no conflicts to declare.\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 2\n0 M\nay 2\n02 2.\nD ow\nnl oa\nde d\non 1\n/1 8/\n20 24\n9 :5\n5: 01\nP M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io nN on C om m er\nci al\n3 .0\nU np\nor te\nd L\nic en\nce .\nThis journal is \u00a9 The Royal Society of Chemistry 2022 Energy Environ. Sci., 2022, 15, 2958\u20132973 | 2971"
        },
        {
            "heading": "Acknowledgements",
            "text": "J. N., J. Y., D. P., M. A., F. E., and E. R. thank the European Research Council for support under the European Union\u2019s Horizon 2020 research and innovation program (Grant Agreement No. 742708 and 648901). The authors at ICMAB acknowledge financial support from the Spanish Ministry of Science and Innovation through the Severo Ochoa\u2019\u2019 Program for Centers of Excellence in R&D (No. CEX2019-000917-S), and project PGC2018-095411-B-I00. E. R. is grateful to the Fonds de Recherche du Quebec-Nature et technologies (FRQNT) for a postdoctoral fellowship and acknowledges financial support from the European Cooperation in Science and Technology. M. A. thanks the Engineering and Physical Sciences Research Council (EPSRC) for support via doctoral studentships. F. E. thanks the Engineering and Physical Sciences Research Council (EPSRC) for support via the Post-Doctoral Prize Fellowship. X. R.-M. acknowledges Prof. Olle Ingana\u0308s and the Knut and Allice Wallenberg Foundation for funding of his current postdoctoral position. H.-L. Yip thanks the support from Guangdong Major Project of Basic and Applied Basic Research (2019B030302007). The TOC figure and Fig. 5a in the manuscript include freely available resources from Flaticon.com. J. Y. thank Xiaodan Ge for her support."
        }
    ],
    "title": "Identifying structure\u2013absorption relationships and predicting absorption strength of non-fullerene acceptors for organic photovoltaics\u2020",
    "year": 2022
}