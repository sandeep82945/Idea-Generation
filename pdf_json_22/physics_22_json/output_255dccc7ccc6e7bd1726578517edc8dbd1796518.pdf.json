{
    "abstractText": "The rapid development of high-speed railways (HSRs) puts forward high requirements on the corresponding communication system. Millimeter wave (mmWave) can be a promising solution due to its wide bandwidth, narrow beams, and rich spectrum resources. However, with the large number of antenna elements employed, energy-efficient solutions at mmWave frequencies are in great demand. Based on a mmWave HSR communication system with multiple mobile relays (MRs) on top of the train, a dynamic power-control scheme for train-ground communications is proposed. The scheme follows the regular movement characteristics of high-speed trains and considers three phases of train movement: the train enters the cell, all MRs are covered in the cell, and the train leaves the cell. The transmit power is further refined according to the number of MRs in the cell and the distance between the train and the remote radio head. By minimizing energy consumption under Copyright (c) 2015 IEEE. Personal use of this material is permitted. However, permission to use this material for any other purposes must be obtained from the IEEE by sending a request to pubs-permissions@ieee.org. This study was supported by the National Key Research and Development Program under Grant 2021YFB2900301; in part by National Key R&D Program of China (2020YFB1806903); in part by the National Natural Science Foundation of China Grants 61801016, 61725101, 61961130391, and U1834210; in part by the State Key Laboratory of Rail Traffic Control and Safety (Contract No. RCS2021ZT009), Beijing Jiaotong Universityand supported by the open research fund of National Mobile Communications Research Laboratory, Southeast University (No. 2021D09); in part by the Fundamental Research Funds for the Central Universities, China, under grant number 2022JBQY004 and 2022JBXT001; and supported by Frontiers Science Center for Smart High-speed Railway System; in part by the Fundamental Research Funds for the Central Universities 2020JBM089; in part by the Project of China Shenhua under Grant (GJNY-20-01-1). S. Mao\u2019s work is supported in part by the NSF Grant ECCS-1923717. Z. Han\u2019s work is partially supported by NSF CNS-2107216 and CNS-2128368. (Corresponding authors: B. Ai, Y. Niu.) L. Wang is with the State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University, Beijing 100044, China, and also with Beijing Engineering Research Center of High-speed Railway Broadband Mobile Communications, Beijing Jiaotong University, Beijing 100044, China (email: lleiwang@bjtu.edu.cn). B. Ai is with the State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University, Beijing 100044, China, and also with Peng Cheng Laboratory and Henan Joint International Research Laboratory of Intelligent Networking and Data Analysis, Zhengzhou University, Zhengzhou 450001, China (email: boai@bjtu.edu.cn). Y. Niu is with the State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University, Beijing 100044, China, and also with the National Mobile Communications Research Laboratory, Southeast University, Nanjing 211189, China (email: niuy11@163.com). Z. Zhong is with the State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University, Beijing 100044, China (e-mail: zhdzhong@bjtu.edu.cn). S. Mao is with the Department of Electrical and Computer Engineering, Auburn University, Auburn, AL 36949-5201 USA (email: smao@ieee.org). N. Wang is with the School of Information Engineering, Zhengzhou University, Zhengzhou, China, 450001 (email: ienwang@zzu.edu.cn). Z. Han is with the Department of Electrical and Computer Engineering at the University of Houston, Houston, TX 77004 USA, and also with the Department of Computer Science and Engineering, Kyung Hee University, Seoul, South Korea, 446-701 (email: zhan2@uh.edu). the constraints of the transmitted data and transmit power budget, the transmit power is allocated to multiple MRs through the multiplier punitive function-based algorithm. Comprehensive simulation results, where the velocity estimation error is taken into account, are provided to demonstrate the effectiveness of the proposed scheme over several baseline schemes.",
    "authors": [
        {
            "affiliations": [],
            "name": "Lei Wang"
        },
        {
            "affiliations": [],
            "name": "Bo Ai"
        },
        {
            "affiliations": [],
            "name": "Yong Niu"
        },
        {
            "affiliations": [],
            "name": "Zhangdui Zhong"
        },
        {
            "affiliations": [],
            "name": "Shiwen Mao"
        },
        {
            "affiliations": [],
            "name": "Ning Wang"
        }
    ],
    "id": "SP:fc6f7e42d8f695121d2c8720c529ba56541723ef",
    "references": [
        {
            "authors": [
                "T. Zhou",
                "C. Tao",
                "L. Liu"
            ],
            "title": "LTE-assisted multi-link MIMO channel characterization for high-speed train communication systems",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 68, no. 3, pp. 2044\u20132051, Mar. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "Y. Dong",
                "C. Zhang",
                "P. Fan",
                "P. Fan"
            ],
            "title": "Power-space functions in high speed railway wireless communications",
            "venue": "Journal of Communications and Networks, vol. 17, no. 3, pp. 231\u2013240, Jun. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "B. Ai",
                "A.F. Molisch",
                "M. Rupp",
                "Z. Zhong"
            ],
            "title": "5G key technologies for smart railways",
            "venue": "Proceedings of the IEEE, vol. 108, no. 6, pp. 856\u2013893, Jun. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "M. Xiao",
                "S. Mumtaz",
                "Y. Huang",
                "L. Dai",
                "Y. Li",
                "M. Matthaiou",
                "G.K. Karagiannidis",
                "E. Bjrnson",
                "K. Yang",
                "C. I",
                "A. Ghosh"
            ],
            "title": "Millimeter wave communications for future mobile networks",
            "venue": "IEEE Journal on Selected Areas in Communications, vol. 35, no. 9, pp. 1909\u20131935, Sept. 2017.",
            "year": 1909
        },
        {
            "authors": [
                "G. Yang",
                "M. Xiao"
            ],
            "title": "Performance analysis of millimeter-wave relaying: Impacts of beamwidth and self-interference",
            "venue": "IEEE Transactions on Communications, vol. 66, no. 2, pp. 589\u2013600, Feb. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "M. Giordani",
                "M. Mezzavilla",
                "M. Zorzi"
            ],
            "title": "Initial access in 5G mmWave cellular networks",
            "venue": "IEEE Communications Magazine, vol. 54, no. 11, pp. 40\u201347, Nov. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "P. Raviteja",
                "Y. Hong",
                "E. Viterbo"
            ],
            "title": "Millimeter wave analog beamforming with low resolution phase shifters for multiuser uplink",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 67, no. 4, pp. 3205\u20133215, Apr. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "S. Hu",
                "X. Chen",
                "W. Ni",
                "X. Wang",
                "E. Hossain"
            ],
            "title": "Modeling and analysis of energy harvesting and smart grid-powered wireless communication networks: A contemporary survey",
            "venue": "IEEE Transactions on Green Communications and Networking, vol. 4, no. 2, pp. 461\u2013496, June 2020.",
            "year": 2020
        },
        {
            "authors": [
                "A. Abrol",
                "R.K. Jha"
            ],
            "title": "Power optimization in 5G networks: A step towards green communication",
            "venue": "IEEE Access Journal, vol. 4, no. 1, pp. 1355\u20131374, Apr. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "H. Zhang",
                "H. Liu",
                "J. Cheng",
                "V.C.M. Leung"
            ],
            "title": "Downlink energy efficiency of power allocation and wireless backhaul bandwidth allocation in heterogeneous small cell networks",
            "venue": "IEEE Transactions on Communications, vol. 66, no. 4, pp. 1705\u20131716, Apr. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "S. Zhang",
                "N. Zhang",
                "S. Zhou",
                "J. Gong",
                "Z. Niu",
                "X. Shen"
            ],
            "title": "Energyaware traffic offloading for green heterogeneous networks",
            "venue": "IEEE Journal on Selected Areas in Communications, vol. 34, no. 5, pp. 1116\u20131129, May 2016.",
            "year": 2016
        },
        {
            "authors": [
                "Z. Kuang",
                "L. Zhang",
                "L. Zhao"
            ],
            "title": "Energy- and spectral-efficiency tradeoff with \u03b1-fairness in energy harvesting D2D communication",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 69, no. 9, pp. 9972\u2013 9983, Sept. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "F. Wang",
                "J. Xu",
                "S. Cui"
            ],
            "title": "Optimal energy allocation and task offloading policy for wireless powered mobile edge computing systems",
            "venue": "IEEE Transactions on Wireless Communications, vol. 19, no. 4, pp. 2443\u20132459, Apr. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "A. Shahid",
                "V. Maglogiannis",
                "I. Ahmed",
                "K.S. Kim",
                "E. De Poorter",
                "I. Moerman"
            ],
            "title": "Energy-efficient resource allocation for ultra-dense licensed and unlicensed dual-access small cell networks",
            "venue": "IEEE Transactions on Mobile Computing, vol. 20, no. 3, pp. 983\u20131000, Mar. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "J. Huang",
                "B. Yu",
                "C.-C. Xing",
                "T. Cerny",
                "Z. Ning"
            ],
            "title": "Online energy scheduling policies in energy harvesting enabled D2D communications",
            "venue": "IEEE Transactions on Industrial Informatics, vol. 17, no. 8, pp. 5678\u2013 5687, Aug. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "X. Wang",
                "Y. Zhang",
                "R. Shen",
                "Y. Xu",
                "F.-C. Zheng"
            ],
            "title": "DRL-based energy-efficient resource allocation frameworks for uplink NOMA systems",
            "venue": "IEEE Internet of Things Journal, vol. 7, no. 8, pp. 7279\u20137294, Aug. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "P. Yu",
                "M. Yang",
                "A. Xiong",
                "Y. Ding",
                "W. Li",
                "X. Qiu",
                "L. Meng",
                "M. Kadoch",
                "M. Cheriet"
            ],
            "title": "Intelligent-driven green resource allocation for industrial internet of things in 5G heterogeneous networks",
            "venue": "IEEE Transactions on Industrial Informatics, vol. 18, no. 1, pp. 520\u2013530, Jan. 2022.",
            "year": 2022
        },
        {
            "authors": [
                "S. Kim",
                "B. Shim"
            ],
            "title": "Energy-efficient millimeter-wave cell-free systems under limited feedback",
            "venue": "IEEE Transactions on Communications, vol. 69, no. 6, pp. 4067\u20134082, Jun. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "B. Li",
                "Y. Dai",
                "Z. Dong",
                "E. Panayirci",
                "H. Jiang",
                "H. Jiang"
            ],
            "title": "Energyefficient resources allocation with millimeter-wave massive MIMO in ultra dense HetNets by SWIPT and CoMP",
            "venue": "IEEE Transactions on Wireless Communications, vol. 20, no. 7, pp. 4435\u20134451, July 2021.",
            "year": 2021
        },
        {
            "authors": [
                "Z. Wang",
                "Q. Liu",
                "M. Li",
                "W. Kellerer"
            ],
            "title": "Energy efficient analog beamformer design for mmWave multicast transmission",
            "venue": "IEEE Transactions on Green Communications and Networking, vol. 3, no. 2, pp. 552\u2013564, Jun. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "J. Zhang",
                "Y. Huang",
                "J. Wang",
                "R. Schober",
                "L. Yang"
            ],
            "title": "Powerefficient beam designs for millimeter wave communication systems",
            "venue": "IEEE Transactions on Wireless Communications, vol. 19, no. 2, pp. 1265\u20131279, Feb. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "J.D. Oliva Snchez",
                "J.I. Alonso"
            ],
            "title": "A two-hop MIMO relay architecture using LTE and millimeter wave bands in high-speed trains",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 68, no. 3, pp. 2052\u20132065, Mar. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "G. Noh",
                "B. Hui",
                "I. Kim"
            ],
            "title": "High speed train communications in 5G: Design elements to mitigate the impact of very high mobility",
            "venue": "IEEE Wireless Communications, vol. 27, no. 6, pp. 98\u2013106, Dec. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "L. Yan",
                "X. Fang",
                "L. Hao",
                "Y. Fang"
            ],
            "title": "A fast beam alignment scheme for dual-band HSR wireless networks",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 69, no. 4, pp. 3968\u20133979, Apr. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "K. Xu",
                "Z. Shen",
                "Y. Wang",
                "X. Xia"
            ],
            "title": "Location-aided mMIMO channel tracking and hybrid beamforming for high-speed railway communications: An angle-domain approach",
            "venue": "IEEE Systems Journal, vol. 14, no. 1, pp. 93\u2013104, Mar. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "J. Bian",
                "C.-X. Wang",
                "X. Gao",
                "X. You",
                "M. Zhang"
            ],
            "title": "A general 3D non-stationary wireless channel model for 5G and beyond",
            "venue": "IEEE Transactions on Wireless Communications, vol. 20, no. 5, pp. 3211\u2013 3224, May 2021.",
            "year": 2021
        },
        {
            "authors": [
                "R. Ma",
                "J. Cao",
                "D. Feng",
                "H. Li",
                "S. He"
            ],
            "title": "FTGPHA: Fixed-trajectory group pre-handover authentication mechanism for mobile relays in 5G high-speed rail networks",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 69, no. 2, pp. 2126\u20132140, Feb. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "J. Zhang",
                "H. Du",
                "P. Zhang",
                "J. Cheng",
                "L. Yang"
            ],
            "title": "Performance analysis of 5G mobile relay systems for high-speed trains",
            "venue": "IEEE Journal on Selected Areas in Communications, vol. 38, no. 12, pp. 2760\u20132772, Dec. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "L. Yan",
                "X. Fang",
                "C. Wang"
            ],
            "title": "Position-based limited feedback scheme for railway MU-MIMO systems",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 65, no. 10, pp. 8361\u20138370, Oct. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "M. Gao",
                "B. Ai",
                "Y. Niu",
                "W. Wu",
                "P. Yang",
                "F. Lyu",
                "X. Shen"
            ],
            "title": "Efficient hybrid beamforming with anti-blockage design for high-speed railway communications",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 69, no. 9, pp. 9643\u20139655, Sept. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "T. Kim",
                "K. Ko",
                "I. Hwang",
                "D. Hong",
                "S. Choi",
                "H. Wang"
            ],
            "title": "RSRPbased doppler shift estimator using machine learning in high-speed train 13 systems",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 70, no. 1, pp. 371\u2013380, Jan. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "V. Va",
                "X. Zhang",
                "R.W. Heath"
            ],
            "title": "Beam switching for millimeter wave communication to support high speed trains",
            "venue": "Proc. IEEE VTC2015- Fall, Boston, MA, Sept. 2015, pp. 1\u20135.",
            "year": 2015
        },
        {
            "authors": [
                "L. Wang",
                "B. Ai",
                "Y. Niu",
                "X. Chen",
                "P. Hui"
            ],
            "title": "Energy-efficient power control of trainground mmwave communication for high-speed trains",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 68, no. 8, pp. 7704\u2013 7714, Aug. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "Qian Chen",
                "Xiaoming Peng",
                "Juan Yang",
                "F. Chin"
            ],
            "title": "Spatial reuse strategy in mmWave WPANs with directional antennas",
            "venue": "Proc. IEEE GLOBECOM 2012, Anaheim, CA, Dec. 2012, pp. 5392\u20135397.",
            "year": 2012
        }
    ],
    "sections": [
        {
            "text": "Copyright (c) 2015 IEEE. Personal use of this material is permitted. However, permission to use this material for any other purposes must be obtained from the IEEE by sending a request to pubs-permissions@ieee.org. This study was supported by the National Key Research and Development Program under Grant 2021YFB2900301; in part by National Key R&D Program of China (2020YFB1806903); in part by the National Natural Science Foundation of China Grants 61801016, 61725101, 61961130391, and U1834210; in part by the State Key Laboratory of Rail Traffic Control and Safety (Contract No. RCS2021ZT009), Beijing Jiaotong Universityand supported by the open research fund of National Mobile Communications Research Laboratory, Southeast University (No. 2021D09); in part by the Fundamental Research Funds for the Central Universities, China, under grant number 2022JBQY004 and 2022JBXT001; and supported by Frontiers Science Center for Smart High-speed Railway System; in part by the Fundamental Research Funds for the Central Universities 2020JBM089; in part by the Project of China Shenhua under Grant (GJNY-20-01-1). S. Mao\u2019s work is supported in part by the NSF Grant ECCS-1923717. Z. Han\u2019s work is partially supported by NSF CNS-2107216 and CNS-2128368. (Corresponding authors: B. Ai, Y. Niu.)\nL. Wang is with the State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University, Beijing 100044, China, and also with Beijing Engineering Research Center of High-speed Railway Broadband Mobile Communications, Beijing Jiaotong University, Beijing 100044, China (email: lleiwang@bjtu.edu.cn).\nB. Ai is with the State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University, Beijing 100044, China, and also with Peng Cheng Laboratory and Henan Joint International Research Laboratory of Intelligent Networking and Data Analysis, Zhengzhou University, Zhengzhou 450001, China (email: boai@bjtu.edu.cn).\nY. Niu is with the State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University, Beijing 100044, China, and also with the National Mobile Communications Research Laboratory, Southeast University, Nanjing 211189, China (email: niuy11@163.com).\nZ. Zhong is with the State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University, Beijing 100044, China (e-mail: zhdzhong@bjtu.edu.cn).\nS. Mao is with the Department of Electrical and Computer Engineering, Auburn University, Auburn, AL 36949-5201 USA (email: smao@ieee.org).\nN. Wang is with the School of Information Engineering, Zhengzhou University, Zhengzhou, China, 450001 (email: ienwang@zzu.edu.cn).\nZ. Han is with the Department of Electrical and Computer Engineering at the University of Houston, Houston, TX 77004 USA, and also with the Department of Computer Science and Engineering, Kyung Hee University, Seoul, South Korea, 446-701 (email: zhan2@uh.edu).\nthe constraints of the transmitted data and transmit power budget, the transmit power is allocated to multiple MRs through the multiplier punitive function-based algorithm. Comprehensive simulation results, where the velocity estimation error is taken into account, are provided to demonstrate the effectiveness of the proposed scheme over several baseline schemes.\nIndex Terms\u2014Energy efficiency, high-speed railway (HSR), millimeter wave (mmWave), mobile relay (MR).\nI. INTRODUCTION\nH IGH-SPEED railways (HSRs) are in high developmentdue to its high mobility, great comfort, and high reliability. Compared to traditional means of transportation, HSR is changing how people travel and brings huge economic benefits while being convenient [1]. The HSR network is rapidly expanding and will promote the development of various technologies, especially in the field of HSR communications [2]. To be in line with future smart rail, HSR communication systems are expected to provide both train control services and mobile multimedia services for train passengers. With the help of smart technologies, we will not only see faster highspeed trains, but also high-speed data services for passengers, fully automated train operation and real-time monitoring in smart railway systems. Nevertheless, it is challenging to enable these high data rate required applications using current railway communication systems. The data rate of the most widely used global system for mobile communications for railways is at kb/s-level, and that of the long term evolution for railways is at Mb/s-level, which is still insufficient for many smart railway wireless communication services [3]. As a result, millimeter wave (mmWave) communication systems attract significant interest.\nMmWave can support multi-gigabit wireless data transmission, thus becoming a strong candidate for HSR communication systems to fulfill the increasing capacity requirements [4]. However, it also brings about many new challenges. A major drawback is that mmWave communications suffer from blockage and increased path loss compared to communications in lower frequency bands [5]. The propagation conditions at mmWave are more severer since mmWave signals cannot penetrate most solid materials [6]. The solution to this problem is directional beamforming technique based on large-scale antenna arrays [7]. Beamforming allows signals to be transmitted in a specific direction through the transmitter (TX) and receiver (RX) antennas, by which a highly directional transmission link is established.\nar X\niv :2\n21 0.\n09 87\n3v 1\n[ cs\n.I T\n] 1\n8 O\nct 2\n02 2\n2 Traditionally, base stations (BSs) have been the major power consumers in wireless communication networks, even in the absence of data transmission. This problem is even more severe in the mmWave band. Due to the high bandwidth, high volume of traffic and high transmit power, the energy consumption of a single mmWave BS is significantly higher than that of an existing single sub-6 GHz BS. Moreover, mmWave small BSs are usually deployed with high-power macro BSs in heterogeneous networks (HetNets) to increase system capacity. This means that massive traffic growth comes at the cost of huge energy consumption and a much larger carbon footprint. However, it is not desirable to increase system capacity through higher energy levels [8]. Although mmWave technology can greatly improve the performance of HSR communication networks, these high data rate links also lead to increased device power consumption and a corresponding growth in system energy consumption. It is critical to overcome the energy consumption challenges of HSR mmWave communication networks due to the rising transmission rate demands.\nEnergy efficiency is a key performance metric for the fifth and future sixth generation communication systems, and has attracted extensive attention from both academia and industry [9]. The design of future wireless communication networks should take energy efficiency into account and meet more stringent energy efficiency requirements. HSR is widely recognized as a green transportation that requires an organic combination of energy efficiency and functional design [3]. It is of great practical importance to study the energy efficiency problem of train-ground mmWave communications for HSRs."
        },
        {
            "heading": "A. Related Work",
            "text": "A significant amount of work is focused on the resource allocation to improve the energy efficiency of wireless communication systems [10]\u2013[17]. With the goal of maximizing the energy efficiency of orthogonal frequency division multiple access HetNets employing wireless backhaul, Ref. [10] designs power and bandwidth allocation schemes by decoupling the joint optimization problem into two convex optimization problems. Zhang et al. in [11] consider a HetNet powered by harvested energy, on-grid energy or both, and derive a closed-form expression for the power saving gain. Traffic offloading schemes for a single SBS and multiple SBS scenarios are developed to minimize on-grid energy consumption under the quality of service (QoS) constraint. A multi-objective optimization problem subject to channel, time slot, transmission power and QoS constraints is formulated in [12] to exploit the trade-off between energy efficiency and spectral efficiency in device-to-device (D2D) communications supporting energy harvesting. Energy and task allocation in wireless-powered mobile edge computing networks are also solved by convex optimization techniques in [13]. In particular, the authors consider randomly arriving tasks and situations where future channel state information is unknown. A game theory-based approach is proposed for sub-channel and power allocation in ultra dense networks where long term evolution (LTE) and Wireless Fidelity (WiFi) coexist [14]. Ref. [15]\nstudies the energy scheduling problem of D2D communication with energy harvesting capability, especially considering the energy consumption of the device to process data. In recent years, deep reinforcement learning approaches have also been used to solve energy efficiency maximization problems [16], [17].\nThe energy consumption of mmWave communication systems is of particular concern due to the high frequency bands and the large number of antenna elements. Several optimization schemes have been proposed to achieve energy efficient mmWave communications [18]\u2013[21]. For mmWave cell-free systems, Ref. [18] selects several main paths in the angle domain and performs information feedback and transmission power allocation on these paths. Ref. [19] proposes to utilize the energy recovered from radio frequency signals and coordinate data transmission through multiple BSs to improve the energy efficiency of ultra-dense HetNets with mmWave massive multiple-input multiple-output (MIMO). In [20], the authors focus on the design of analog beamformers in mmWave multi-input single-output systems and propose a low-complexity solution under power constraints. Digital and hybrid mmWave beams are also designed in [21] through a hybrid mapping algorithm to maintain the dynamic balance between the energy efficiency and beam ripples.\nRecently, mmWave HSR communications have been extensively studied [22]\u2013[26]. The throughput performance of the HSR communication system with a two-hop architecture has been shown to outperform the performance of direct communication between BSs and passengers, and deploying multiple independent mobile relays (MRs) is superior to deploying a single MR [22]. In this two-hop network, the type of MR can be either amplify-and-forward or decode-and-forward, and there is a trade-off between the performance and cost of the MR. 5G New Radio (NR) is believed to further enhance the performance of HSR communication systems. Ref. [23] describes the performance requirements for deploying 5G NR systems in HSR scenarios and provides the physical layer design and initial access mechanism to support high-speed mobile scenarios. Conventional beam alignment methods may introduce large angular offsets in HSR systems, the authors in [24] propose a fast initial access scheme by taking advantage of learning results from historical beam training process. Moreover, a network structure which utilizes low frequency bands to improve the performance of mmWave frequencies is applied to guarantee the robustness of the entire network. Xu et al. in [25] consider a practical signal propagation environment, and propose a channel tracking scheme based on angle information, while a hybrid beamforming scheme is also designed to reduce overhead. A channel model for mmWave HSR systems is developed in [26], which is a threedimensional model that captures channel non-stationarity in time, space and frequency.\nNotably, most of these prior works do not consider the energy efficiency optimization for HSR communications. Although there have been some studies on energy efficiency related problems, there are not many discussions on energyefficient problem in the unique and challenging HSR scenario. Due to the fast moving speed of high-speed trains, HSR\n3 communications suffer from severe Doppler shift and penetration loss, and these problems are more severe at mmWave frequencies. In addition, frequent handovers are performed in HSR systems, which is launched by a large number of user equipment almost simultaneously and has to be completed in a short period of time [27]. To address these issues, the third Generation Partnership Project (3GPP) has adopted a two-hop architecture in HSR, where data from passengers to BSs is forwarded by roof MRs [22]. High-speed trains provide a lot of space for large-scale antennas, and hence roof-top MR can also provide high-speed data transmission services for HSR\npassengers with the help of high frequency bands such as mmWave [28]. Moreover, multiple MRs are expected to further enhance system throughput. However, different from single MR, multi-MRs consumes more energy. Providing maximum transmit power to each MR results in the system operating at a much lower efficiency than its optimal capability, and the power consumed by the system is not fully utilized and is greatly wasted. Therefore, how to achieve dynamic power allocation among multiple MRs to save the energy of HSR communication systems while meeting the data transmission requirements is a key issue."
        },
        {
            "heading": "B. Contributions and Organization",
            "text": "In this paper, we consider the train-ground mmWave communication for HSRs, where an mmWave remote radio head (RRH) can serve multiple MRs installed on the train simultaneously [29]. Directional beamforming is employed at the TX and RX, to compensate for the path loss at higher frequencies. Then an energy efficiency optimization problem is formulated and a power allocation scheme based on the multiplier punitive function algorithm is developed. The scheme considers three phases of train movement: (i) the train enters the cell, (ii) all the MRs are covered in the cell, and (iii) the train leaves the cell. The transmit power of the second phase is dynamically adjusted according to the distance between the train and the RRH, and the transmit power of the other two phases is allocated according to the number of MRs in the cell. Main contributions are as follows. \u2022 This paper investigates the energy efficiency problem of\nmmWave multi-MR HSR systems, where more than one MR is mounted on the roof of the train. A dynamic power allocation scheme is designed to support a number of RRH-MR links simultaneously. In particular, the process of the train entering or leaving the cell is divided into several stages depending on the number of MRs in the cell, and when all MRs are in the cell, the power is allocated sequentially in several consecutive location bins. \u2022 An optimization problem is formulated to achieve high energy efficiency of train-ground communications. The optimization problem imposes a strict constraint on the transmit power of the system, that is, the sum of the transmit powers of multiple MRs is less than the transmit power budget. In addition, energy consumption is minimized under the constraint that the total transmitted data is greater than the threshold.\nBBU Pool\nMR\nRRH\nMBS\nv\nThe remainder of this paper is organized as follows. Section II describes the system model and formulates the energy efficiency maximization problem into a non-convex nonlinear minimization problem. Section III proposes a multiplier punitive function-based algorithm to solve the optimization problem. Section IV presents performance evaluation and explores the effect of speed error. Finally, Section V concludes this paper."
        },
        {
            "heading": "II. SYSTEM MODEL AND PROBLEM FORMULATION",
            "text": ""
        },
        {
            "heading": "A. System Model",
            "text": "To meet the high-speed transmission demands of HSR passengers, a control/user-plane splitting network architecture is adopted in this paper [3], as shown in Fig. 1. Control signaling is carried on the control-plane, and data information from passengers is offloaded to the track-side mmWave RRH. The network is also a HetNet deployment, with the mmWave RRH deployed within the coverage of macro cell for high data rate transmission, and MBS operating in lower frequency bands for coverage and reliability. Due to the high cost, it is impractical to deploy continuous mmWave RRHs. This separation of user plane and control plane allows flexible deployment of mmWave RRHs to improve transmission rates in small areas while maintaining coverage performance.\nTo provide reliable connectivity for passengers, multiple MRs are deployed on top of the train, forming a two-hop architecture. MRs are mainly used for receiving and forwarding data, and all communications between RRHs and passengers are completed through MRs, thus avoiding severe train body penetration loss. Compared to a single MR, multiple MRs take advantage of space diversity gain to further improve system throughput. In the first hop, MRs establish connections with the RRH through radio access links, which can be both at frequency bands below 6 GHz and mmWave frequencies. In\n4 the second hop, MRs serve onboard passengers through the access points installed inside each carriage, where MRs and access points are connected by the wired cable or fiber. At the access links, various well-developed radio access technologies are enabled, like LTE and WiFi [30]. Another advantage of using this two-hop structure is that the data from passengers first arrives at MRs and then is forwarded to the low-frequency BSs via MRs, avoiding frequent handover when passengers directly communicate with BSs. Since communication requests and data information from passengers are aggregated at MRs, we only consider the RRH-MR links that support the trainground mmWave communications.\nAssume that all transceivers are equipped with adaptive antenna arrays and a beam switching method is employed to achieve effective beam alignment. Train position information from the train control system and train velocity measured by the train itself is exploited to compute the real-time train position to further assist beam switching. Then train position can be predicted by\nx(t) = v(t\u2212 t0) + x0, (1)\nwhere x(t) is the train position at time t, v is the train speed, x0 is the feedback location from the train control system at time t0. In practice, train speed information may not be perfect, and speed estimation errors may exist. The effect of velocity estimation error will be discussed in Section IV-D.\nLet d0 be the distance between the RRH and the rail, and dl is the coverage width of the RRH. Suppose the train has M MRs, and the distance between adjacent MRs is dMR which satisfies dl > (M \u2212 1) dMR, i.e., the movement of the train consists of three processes: the train enters the cell, all M relays of the train are covered in the cell, and the train leaves the cell.\nThe mmWave channel model in dB is expressed as\nhi(t) = \u2212PLi (t)\u2212 \u03be \u2212 \u03b3 (t) , (2)\nwhere hi(t) is the channel coefficient between the ith MR and the RRH at time t, the path loss is denoted by PLi (t) and is given by PLi (t) = 10nlog10 (4\u03c0di (t)/\u03bb), where n denotes the path loss exponent, \u03bb denotes the carrier wavelength, and di (t) denotes the distance between the track-side RRH and the MR i. \u03be is the shadowing margin, and \u03b3 (t) denotes the scaling fading factor incorporating Rician fading whose envelope is distributed as\nf(r) = r exp ( \u2212 ( r2 +A2 )/ 2\u03c32 ) \u00b7 I0 ( rA / \u03c32 ) /\u03c32. (3)\nTo mitigate the negative impact of Doppler shift on HSR mmWave communication systems, a machine learning-based Doppler shift estimation method is adopted [31]. With the powerful processing capability of MRs, a Doppler shift estimation model, which is a trained neural network, is deployed at one of the MRs.\nConsidering the regularity of train movement, the proposed model constructs the mapping relationship from reference signal received power (RSRP) values to Doppler shift by the pattern of RSRP. Specifically, the input set of the model\nconsists of 2L+ 1 RSRP values around position xa, which is given by\ns (xa) = {r (xa\u2212L) , \u00b7 \u00b7 \u00b7 , r (xa\u22121) , r (xa) , r (xa+1) , \u00b7 \u00b7 \u00b7 , r (xa+L)} ,\n(4) where s (xa) denotes the input set at position xa, r (xj) , j = a\u2212 L, \u00b7 \u00b7 \u00b7 , a, \u00b7 \u00b7 \u00b7 , a+ L denotes the RSRP value at position xj and is given by [32]\nr (xj) = PT +Gtx+Grx\u2212\u03be+10nlog10 (\u03bb/4\u03c0d (xj))\u2212\u03b3 (t) , (5) where PT is the transmit power budget; Gtx and Grx denote the TX and RX antenna gains, respectively; d (xj) is the distance of the MR from the RRH at position xj . Since different locations may correspond to the same RSRP value, if a single RSRP value is directly input to the model, it will result in the same Doppler shift value at different locations. Multiple input values avoid this one-to-many mapping problem.\nThe RSRP values are measured every xs meters, that is, every xs/v seconds, to generate the training data of the model. By training a neural network, a Doppler shift estimator is obtained. However, the model can only estimate the Doppler shift at the velocity parameter for which the model was trained. Estimates at other speeds require extensive training of the model at different speeds. To address this, the output of the model is redefined as the relative Doppler shift, denoted by freld (x), and is given by\nfreld (x) = fd (x)\nfd,max , (6)\nwhere fd (x) is the Doppler shift at position x, fd,max is the maximum Doppler shift which is computed by fd,max = fcv/c where fc is the carrier frequency and c is the speed of light.\nFinally, the Doppler shift can be estimated by\nf\u0302d (x) = freld (x) fcv\nc . (7)"
        },
        {
            "heading": "B. Problem Formulation",
            "text": "The energy efficiency optimization for HSR communications can be formulated as\nmax EE = D\nE , (8)\nwhere EE is the energy efficiency, D is the total transmitted data, and E denotes the total energy consumption.\nConsider the entire process from the first MR of the train entering the cell to the last MR leaving the cell, which consists of three stages: (i) MRs of the train enter the cell sequentially, (ii) all the M MRs are covered in the cell, and (iii) MRs leaves the cell in turn. The first stage can be further divided into M\u22121 parts according to the number of MRs that have entered the cell; so is the third stage. Moreover, the distance travelled by the train in the second stage is divided into N consecutive location bins of length [dl \u2212 (M \u2212 1) dMR]/N .\nLet the time when the first MR reaches the cell edge be time 0, i.e., t0 = 0, and then the running time of the train can be divided into 2M +N \u2212 2 segments according to the above approach.\n5 Let the time instances for the first MR to reach the endpoint of each segment be ti, given by\nti =  idMR v , i \u2208 [1, 2, . . . ,M \u2212 1] , aidMR + bidl v \u00b7N , i \u2208 [M,M + 1, . . . ,M +N \u2212 1] ,\ncidMR + dl v\n, i \u2208 [M +N, . . . , 2M +N \u2212 2] , (9)\nwhere ai = (N +M \u2212 i\u2212 1) (M \u2212 1) , bi = i\u2212M + 1, ci = (i\u2212M \u2212N + 1) .\n(10)\nWhen t \u2208 [0, tM\u22121), the train enters the cell during this interval, corresponding to the first stage. When t \u2208 [tM\u22121, tM+N ), all the M relays are covered in the cell, corresponding to the second stage. And when t \u2208 [tM+N , t2M+N\u22122), the train leaves the cell, corresponding to the third stage. In addition, when t \u2208 [ti\u22121, ti) , i \u2208 [1, 2, . . . ,M \u2212 1], there are i MRs covered in the cell; when t \u2208 [ti\u22121, ti) , i \u2208 [M +N, . . . , 2M +N \u2212 2], there are 2M +N \u2212 i\u2212 1 MRs covered in the cell.\nSince the length of location bins and the distance between MRs are both short, assume that the transmit power allocated to each MR during each interval [ti\u22121, ti) is constant. Let P = [Pi,j ] denote a M \u00d7 (2M +N \u2212 2) transmit power allocation matrix, where Pi,j denotes the transmit power allocated to the ith MR during [tj\u22121, tj). If the MR has not entered the cell or has left the cell, there is no transmit power allocated to it.\nThe total energy consumption E of the train-ground mmWave communications can be calculated as\nE = TP T I, (11)\nwhere (\u00b7)T denotes the transpose operator. I is a M\u00d71 matrix with elements 1. T is a time matrix and is expressed as\nT = [ dMR v , . . . , dMR v , dl \u2212 (M \u2212 1) dMR v \u00b7N , . . . ,\ndl \u2212 (M \u2212 1) dMR v \u00b7N , dMR v , . . . , dMR v\n] ,\n(12)\nwhere T consists of 2M + N \u2212 2 elements, the first M \u2212 1 and the last M \u2212 1 elements are dMR/v, and the middle N elements are (dl \u2212 (M \u2212 1) dMR) /v/N .\nThe received power of MR i during [tj\u22121, tj), denoted by Prx,i,j , is given by\nPrx,i,j(t) = Pi,j+Gtx+Grx\u2212\u03be+10nlog10 \u03bb\n4\u03c0di(t) \u2212\u03b3 (t) [dBm].\n(13) The received SNR of MR i at time t, denoted by \u0393i (t), is\nobtained as\n\u0393i (t) = Pi,j + 10nlog10 \u03bb\n4\u03c0di (t) + \u03b3 (t) + Ci, (14)\nwhere Ci = Gtx +Grx \u2212 \u03be \u2212 P dBmnoise, (15)\nPnoise = \u2212174 + 10 log10B + NF [dBm], (16)\nwhere Pnoise is the noise power, B is the system bandwidth, and NF is the noise figure.\nAccording to the Shannon capacity formula, the amount of transmitted data of MR i during [tj\u22121, tj), denoted by Di,[tj\u22121,tj), is given by\nDi,[tj\u22121,tj) = \u222b tj tj\u22121 log2 ( 1 + 10\u0393i(t)/10 ) dt. (17)\nThen the total amount of transmitted data D can be computed as\nD = M\u2211 i=1 i+M+N\u22122\u2211 j=i Di,[tj\u22121,tj). (18)\nEquations (11)-(18) provide a model for the energy efficiency EE. Since EE = D/E, we optimize EE through minimizing E under the constraint that D meets the preset threshold Dmin. Then the optimization problem can be modeled as\nmin E\ns.t. D \u2265 Dmin, (19)\nwhere Dmin is the minimum requirement for the amount of transmitted data.\nIn addition to the constraint on the total amount of transmitted data, the sum of the transmit powers allocated to the MRs in each period must be less than the transmit power budget PT .\nFinally, the energy efficiency optimization problem for HSR communications can be modeled as\nmin P E\ns.t. D \u2265 Dmin, (20a) \u2016P \u20161 \u2264 PT , (20b)\nwhere \u2016\u00b7\u20161 denotes the maximum absolute column sum norm and is given by \u2016A\u20161 = maxj=1,2,...,n m\u2211 i=1\n|Ai,j |. Accordingly, (20b) implies that\nM\u2211 i=1 Pi,j \u2264 PT ,\u2200j \u2208 [1, 2, . . . , 2M +N \u2212 2] , (21)\nThat is, the problem (20) actually has 2M+N\u22121 constraints with M \u00d7 (M +N \u2212 1) optimization variables. Since the constraint (20a) contains non-convex SNR parts, the problem is a non-convex non-linear optimization problem."
        },
        {
            "heading": "III. PROPOSED POWER-CONTROL ALGORITHM",
            "text": "Due to the non-linearity of the constraints (20a), it is not possible to transform this problem into an unconstrained problem by the elimination method. One approach is to form an auxiliary function from the objective function and the constraint functions, transforming the original constrained problem into an unconstrained problem that minimizes the auxiliary function.\nThe multiplier punitive function method combines the advantages of the Lagrange multiplier method and the penalty function method, that is, fast convergence and the ability to transform a constrained problem into an unconstrained one,\n6 and is therefore suitable for the above problem (20). However, directly solving the inequality constrained optimization problem requires the introduction of new variables to transform inequality constraints into equality constraints, which will undoubtedly greatly increase the complexity of the algorithm. Since the optimal solution can be obtained from the KarushKuhn-Tucker (KKT) conditions, we first analyze the KKT conditions here.\nThe Lagrange function for problem (20) is given by\nL(P ;\u03bb) = E \u2212 \u03bb1 (D \u2212Dmin) + \u03bb2 (\u2016P \u20161 \u2212 PT ) , (22)\nwhere \u03bbi(i \u2208 [1, 2]) are Lagrange multipliers. Construct corresponding KKT conditions as follows. \u2207pL (P ;\u03bb) = 0, \u03bb1 (D \u2212Dmin) = 0, \u03bb2 (\u2016P \u20161 \u2212 PT ) = 0, D \u2212Dmin \u2265 0, \u2016P \u20161 \u2212 PT \u2264 0,\n\u03bbi \u2265 0, i \u2208 [1, 2].\n(23)\nDue to the first constraint (20a) of problem (20) involves exponential and logarithmic operations, it is difficult to solve the KKT constraints directly. On the other hand, through analysis and calculation of (23), it is found that the solution to the optimization problem can be obtained when the constraints are all equal, and thus, the inequality constrained optimization problem (20) is transformed as follows\nmin P E\ns.t. D = Dmin, (24a) M\u2211 i=1 Pi,j = PT ,\u2200j \u2208 [1, 2, \u00b7 \u00b7 \u00b7 , 2M +N \u2212 2] . (24b)\nThe multiplier punitive method forms an augmented Lagrangian function to transform the constrained optimization into an unconstrained optimization, and algorithms for solving the unconstrained optimization problem can be directly used to solve the original problem. Since the method does not involve constraints at each iteration, it is suitable for solving non-linear constrained optimization problems. The augmented Lagrange function of problem (24) is given by\n\u03c6 (P ,\u03bb, \u03c3) = E \u2212 \u03bb1 (D \u2212Dmin)\n\u2212 2M+N\u22122\u2211\nj=1\n\u03bbj+1 ( M\u2211 i=1 Pi,j \u2212 PT ) + \u03c3(D \u2212Dmin)2\n+ \u03c3 2M+N\u22122\u2211 j=1 ( M\u2211 i=1 Pi,j \u2212 PT )2 ,\n(25)\nwhere \u03c3 is a penalty factor. To simplify the notation, the augmented Lagrange function can be rewritten as\n\u03c6 (P ,\u03bb, \u03c3) = E (P )\u2212 \u03bbTh (P ) + \u03c3h(P )Th (P ) , (26)\nAlgorithm 1 The Multiplier Punitive Function-based Power Control Algorithm\nInitialization: pick \u03c3(0) > 0, \u03bb(0) = 0, stepsize \u03b1, growth factor \u03b3 > 1, allowable error \u03b5 > 0, the number of cycles n ; Output: P\u0304 ;\n1: Set k = 0 ; 2: while k \u2264 n do 3: Set i = 1 and pick initial point P (1); 4: while true do 5: Compute descent direction d(i) =\n\u2212\u2207\u03c6 ( P (i),\u03bb(k), \u03c3(k) ) ;\n6: if \u2225\u2225\u2225d(i)\u2225\u2225\u2225 \u2264 \u03b5 then\n7: Break ; 8: else 9: P (i+1) = P (i) + \u03b1d(i), i = i+ 1;\n10: end if 11: end while 12: Set P (k) = P (i); 13: if max { hj ( P (k) ) |j = 1, \u00b7 \u00b7 \u00b7 , 2M +N \u2212 1 } \u2264 \u03b5 then 14: Break ; 15: else if \u2225\u2225\u2225h(P (k))\u2225\u2225\u2225 \u221e \u2265 \u2225\u2225\u2225h(P (k\u22121))\u2225\u2225\u2225 \u221e then\n16: \u03c3(k+1) = \u03b3\u03c3(k), \u03bb(k+1) = \u03bb(k), k = k + 1 ; 17: else if \u03c3(k) > \u03c3(k\u22121) or \u2225\u2225\u2225h(P (k))\u2225\u2225\u2225\n\u221e \u2264\n1\n4 \u2225\u2225\u2225h(P (k\u22121))\u2225\u2225\u2225 \u221e then\n18: \u03c3(k+1) = \u03c3(k), \u03bb(k+1) = \u03bb(k) \u2212 2\u03c3(k)h ( P (k) ) ,\nk = k + 1 ; 19: else 20: \u03c3(k+1) = \u03b3\u03c3(k), \u03bb(k+1) = \u03bb(k), k = k + 1 ; 21: end if 22: end while\nwhere \u03bb = [\u03bb1, \u03bb2, \u00b7 \u00b7 \u00b7 , \u03bb2M+N\u22121]T, h (P ) = [h1 (P ) , h2 (P ) , \u00b7 \u00b7 \u00b7 , h2M+N\u22121 (P )]T, h1 (P ) = D\u2212Dmin, hj+1 (P ) = \u2211M i=1 Pi,j \u2212 PT , j = 1, 2, . . . , 2M + N \u2212 2. The difference between \u03c6 (P ,\u03bb, \u03c3) and Lagrange function L(P ;\u03bb) is that \u03c6 (P ,\u03bb, \u03c3) adds a penalty term \u03c3h(P )Th (P ). This distinction makes the augmented Lagrange function have different properties from the Lagrange function. In contrast to the penalty function method, the penalty factor \u03c3 of multiplier punitive method does not have to tend to infinity, as long as a sufficiently large \u03c3 is taken, the optimal solution of the problem (24) can be obtained by minimizing \u03c6 (P ,\u03bb, \u03c3).\nSuppose that P\u0304 is a minimizer of \u03c6 ( P , \u03bb\u0304, \u03c3 ) , where \u03bb\u0304 is the optimal Lagrange multiplier. Then by the sufficient condition for the optimization problem, we have that \u2207\u03c6P ( P\u0304 , \u03bb\u0304, \u03c3 ) = 0, and for any direction d \u2208 Rn,\n7\ndT\u2207\u03c62P ( P\u0304 , \u03bb\u0304, \u03c3 ) d > 0. Since\n\u2207P\u03c6 ( P\u0304 , \u03bb\u0304, \u03c3 ) = \u2207E ( P\u0304 ) \u2212 2M+N\u22121\u2211 j=1 \u03bb\u0304j\u2207hj ( P\u0304 )\n+ 2\u03c3 2M+N\u22121\u2211 j=1 hj (P )\u2207hj (P ) = 0, (27)\ncombined with hj ( P\u0304 ) = 0, j = 1, 2, \u00b7 \u00b7 \u00b7 , 2M +N \u22121, yields\n\u2207E ( P\u0304 ) \u2212 2 2M+N\u22121\u2211 j=1 \u03bb\u0304j\u2207hj ( P\u0304 ) = 0. (28)\nThus, P\u0304 is a KKT point of the problem (24). By dT\u2207\u03c62P ( P\u0304 , \u03bb\u0304, \u03c3 ) d > 0, for any d \u2208 Rn such that\ndT\u2207hj ( P\u0304 ) = 0, j = 1, 2, \u00b7 \u00b7 \u00b7 , 2M +N \u2212 1, we have\ndT \u22072E (P\u0304 )\u2212 2 2M+N\u22121\u2211 j=1 \u03bb\u0304j\u22072hj ( P\u0304 )d > 0. (29)\nTherefore, P\u0304 is a local minimum of the original problem (20). Unfortunately, although the penalty factor can be sufficiently large, the value of the optimal Lagrange multiplier \u03bb\u0304 cannot be known until the optimal solution is obtained. Therefore, it is necessary to investigate how to determine \u03bb\u0304 and \u03c3. Typically, \u03bb is corrected during the iterative process based on a sufficiently large \u03c3 and an initial estimate of the Lagrange multiplier \u03bb, trying to make \u03bb converge to \u03bb\u0304.\nAssume that in the kth iteration, the optimal solution of \u03c6 ( P ,\u03bb(k), \u03c3 ) is attained at P (k) , the estimate of \u03bb in this iteration is \u03bb(k), and the penalty factor is \u03c3, then we have \u2207P\u03c6 ( P (k),\u03bb(k), \u03c3 ) = 0.\nFor the optimal solution P\u0304 of the problem (24), when \u2207h1 ( P\u0304 ) , \u2207h2 ( P\u0304 ) , . . ., \u2207h2M+N\u22121 ( P\u0304 )\nare linearly independent, P\u0304 satisfying (28).\nIf P (k) = P\u0304 , then \u03bb\u0304j = \u03bb (k) j \u2212 2\u03c3hj\n( P (k) ) . In general,\nP (k) 6= P\u0304 and (28) does not hold, but \u03bb can be corrected by\n\u03bb (k+1) j = \u03bb (k) j \u2212 2\u03c3hj\n( P (k) ) , j = 1, 2, . . . , 2M +N \u2212 1,\n(30) then perform the (k + 1)th iteration to find the minimizer of \u03c6 ( P ,\u03bb(k+1), \u03c3 ) . Repeat the process so that \u03bb(k) \u2192 \u03bb\u0304, and P (k) \u2192 P\u0304 . In this method, the penalty term is a penalty for the iteration point leaving the feasible region, which will force the iteration point to approach the feasible region during the minimization process. With the increase of the penalty factor, the distance between the iteration point and the optimal solution is closer. By adjusting the penalty factors continuously, the optimal solution can be found. The algorithm corrects the penalty factors and Lagrange multipliers based on the following considerations.\nIf \u2225\u2225h (P(k))\u2225\u2225\u221e \u2265 \u2225\u2225h (P(k\u22121))\u2225\u2225\u221e, the iteration point tends to be far away from the constrained surface, thus the penalty term should be increased in the next iteration.\nIf \u2225\u2225h (P(k\u22121))\u2225\u2225\u221e > \u2225\u2225h (P(k))\u2225\u2225\u221e \u2265 14\u2225\u2225h (P(k\u22121))\u2225\u2225\u221e and \u03c3(k) = \u03c3(k\u22121), the proximity of the iterative point to the\nconstrained surface is not significant, which is related to the unadjusted penalty factor. If \u2225\u2225h (P(k))\u2225\u2225\u221e < 14\u2225\u2225h (P(k\u22121))\u2225\u2225\u221e, the iterative point approaches the constrained surface significantly. In the next iteration, only the Lagrange multipliers need to be adjusted.\nIf \u2225\u2225h (P(k\u22121))\u2225\u2225\u221e > \u2225\u2225h (P(k))\u2225\u2225\u221e \u2265 14\u2225\u2225h (P(k\u22121))\u2225\u2225\u221e and \u03c3(k) > \u03c3(k\u22121), it means that in this iteration, increasing the penalty factor has an effect on the proximity of the current iteration point to the constrained surface, but the effect is not significant. In the next iteration, only the Lagrange multipliers are adjusted.\nThe proposed multiplier punitive function-based algorithm is presented in Algorithm 1, which can compute the approximate optimal solution to problem (20)."
        },
        {
            "heading": "IV. PERFORMANCE EVALUATION",
            "text": "In this section, the performance of the proposed energy efficiency scheme based on multiplier punitive function algorithm is evaluated with various critical parameters, including the number of MRs, the inter-RRH distance, and the velocity of the train. The train velocity estimation error, which is assumed to be zero in Section II-A, is also taken into account in the simulations. Specifically, we make a comparison of the proposed scheme with four baseline schemes to demonstrate the optimization gain."
        },
        {
            "heading": "A. Simulation Setup",
            "text": "The realistic directional antenna model supported in standards like IEEE 802.15.3c is adopted here similar to [33], where the linear scale of the main lobe is Gaussian and sidelobes are constant [34]. The directional antenna gain G(\u03b8) in dB is represented as\nG(\u03b8) =  G0 \u2212 3.01 \u00b7 ( 2\u03b8 \u03b8\u22123dB )2 , 0\u25e6 \u2264 \u03b8 \u2264 \u03b8ml/2,\nGsl, \u03b8ml/2 \u2264 \u03b8 \u2264 180\u25e6, (31)\nwhere \u03b8 denotes an arbitrary angle depends on the actual direction between the transceivers, \u03b8\u22123dB is the half-power beamwidth angle, and \u03b8ml is the main lobe beamwidth, which\n8 P 1,1 P 1,2 P 2,2 P 1,3 P 2,3 P 3,3 P 1,4 P 2,4 P 3,4 P 4,4 P 1,5 P 2,5 P 3,5 P 4,5 P 1,6 P 2,6 P 3,6 P 4,6\nP i,j\n0\n5\n10\n15\n20\n25\n30\nP ow\ner A\nllo ca\ntio n\nR es\nul ts\n( dB\nm )\nMaintain Constant Power Optimized Allocation Random Allocation Average Allocation CSI-based Allocation\nFig. 2. Power allocation results at each segment.\nsatisfies \u03b8ml = 2.6 \u00b7 \u03b8\u22123dB . In (31), G0 denotes the maximum antenna gain, given by\nG0 = 10 log\n( 1.6162\nsin (\u03b8\u22123dB/2)\n)2 . (32)\nwhile the sidelobe gain Gsl is written as\nGsl = \u22120.4111 \u00b7 ln(\u03b8\u22123dB)\u2212 10.579. (33)\nConsider the network model shown in Fig. 1, and main simulation parameters are given in Table I."
        },
        {
            "heading": "B. Comparison with Baseline Schemes",
            "text": "To evaluate performance of the proposed scheme and further illustrate the optimization gain, we choose the following four baseline schemes for comparison purpose: \u2022 Maintain constant transmit power: once the MR enters\nthe coverage area of the cell, a constant transmission power of PT /M is allocated to it, and the power is maintained until the MR leaves the cell. \u2022 Random transmit power allocation: since the optimal solution is obtained when the constraints are equal as in (24), it is reasonable to allocate transmit power randomly when the constraints (24b) are satisfied. \u2022 Average transmit power allocation: when the train enters or leaves the cell, PT is divided and allocated equally to the MRs in the cell, and when MRs are all traveling in the cell, PT is allocated equally to the M MRs. \u2022 Channel state information (CSI)-based power allocation: the transmit power is allocated according to the coefficient determined by the CSI. Specifically, the transmit power allocated to the ith MR during [tj\u22121, tj) is given\nby Pi.j = ( |hi,j |2 )\u2212\u03b1/\u2211M i=1 ( |hi,j |2 )\u2212\u03b1 PT ,\u2200j =\n1, 2, \u00b7 \u00b7 \u00b7 , 2M +N \u2212 1, where \u03b1 is a constant coefficient and is set to 0.2.\nThe Optimized transmit power allocation refers to transmit power allocation through the proposed multiplier punitive function-based algorithm.\nFig. 2 plots the power allocation results at each segment with dl = 200m, v = 300km/h, PT = 30dBm and M = 4, where Pi,j (j = 1, 2, 3) denotes the allocated power of the train entering the cell, and Pi,j (j = 4, 5, 6) denotes the allocated power when all MRs are covered in the cell. Only half of the results are shown in the figure considering the symmetry and only a random allocation result is provided. Comparing the optimized scheme and the average allocation scheme, the power allocation of the two is similar after the MRs are all covered in the cell. On the one hand, from the time MR enters the location bin to the time it leaves the location bin, the short length of each location bin results in a small change in the distance between the MR and the RRH. Based on the adopted channel model, the MR experiences similar channel conditions in different location bins and is allocated the same power level. On the other hand, the distance between adjacent MRs is also a small value. Similarly, multiple MRs with nearly similar channel gains are allocated equal levels of power. In particular, when the train gradually enters the cell, the first MR of the optimized scheme is usually allocated more power, since the first MR is closer to the RRH, more power allocated to the first MR helps transmit more data. It can also be found from Fig. 2 that for the CSI-based scheme, MRs with low channel gains are allocated to high transmit power levels, while MRs with high channel gains are allocated to low power levels.\nFig. 3 plots the energy consumption comparison of the five schemes under different M values with dl = 200m, v = 300km/h and PT = 40dBm. From the figure, it is observed that when the M increases, the energy consumption of the optimized scheme remains at a low level, and the average allocation scheme and the CSI-based allocation scheme exhibit similar performance. Compared with the average and CSI-based allocation scheme, the optimized scheme has better performance in reducing energy consumption. Due to the random power allocation, its energy consumption exhibits slight fluctuates. However, overall it is lower than the energy consumption value of the constant power scheme. Therefore, when the number of MRs is changed, the optimized, random,\n9 2 3 4 5 6 Number of MRs 2 3 4 5 6 7 8 9 10 11 12 13 E ne rg y C on su m pt io n (J ) Maintain Constant Power Optimized Allocation Random Allocation Average Allocation CSI-based Allocation\nFig. 3. Energy consumption comparison under different M values.\n2 3 4 5 6 Number of MRs\n0\n10\n20\n30\n40\n50\n60\n70\nE ne\nrg y\nE ff\nic ie\nnc y\n(b it/\nJ)\nMaintain Constant Power Optimized Allocation Random Allocation Average Allocation CSI-based Allocation\nFig. 4. Energy efficiency comparison under different M values.\naverage, and CSI-based allocation schemes all reduce the energy consumption of train-ground communications, while the proposed scheme can achieve better performance.\nThe results of energy efficiency varying with the number of MRs are shown in Fig. 4. By comparison, we can find that more installed MRs do help improve the energy efficiency of train-ground mmWave communications. The energy efficiencies of the constant, optimized, average and CSIbased allocation schemes are all improved as more MRs are used. The value of the random allocation scheme exhibits a generally increasing trend, although with fluctuations. It is worth noting that the proposed scheme achieves the highest energy efficiency, and the gap with the average allocation scheme and the CSI-based scheme is obvious. In particular, the energy efficiencies of random power allocation are similar to the values of the average allocation scheme, the random allocation scheme can also achieve good performance in some cases.\nFig. 5 shows the energy consumption performance of the five schemes under different dl values. We set the transmit power as 40 dBm, the speed of the train as 300km/h, and the number of MRs as 4. It is observed that the energy consumption of the constant power scheme rises quickly at a constant rate with increased dl. In contrast, the energy\n140 160 180 200 220 dl (m)\n2\n4\n6\n8\n10\n12\n14\nE ne\nrg y\nC on\nsu m\npt io\nn (J\n)\nMaintain Constant Power Optimized Allocation Random Allocation Average Allocation CSI-based Allocation\nFig. 5. Energy consumption comparison under different dl values.\n140 160 180 200 220 dl (m)\n5\n10\n15\n20\n25\n30\n35\n40\n45\n50\nE ne\nrg y\nE ff\nic ie\nnc y\n(b it/ J) Maintain Constant Power Optimized Allocation Random Allocation Average Allocation CSI-based Allocation\nFig. 6. Energy efficiency comparison under different dl values.\nconsumption values of the other four schemes don\u2019t change much with the increased dl. The proposed scheme outperforms the other four schemes in general. To be specific, the optimized scheme saves about 79.6% energy compared with the constant power scheme when dl = 200m. The energy consumption of the optimized scheme is also lower than that of the average allocation scheme, the CSI-based allocation scheme, and the random allocation scheme for the entire range of dl values examined.\nEnergy efficiencies of the five schemes under different dl values are shown in Fig. 6. The energy efficiency of the constant power scheme decreases with the increase of dl, while the energy efficiencies of the other four schemes, on the contrary, all grow as dl is increased. Similarly, the proposed scheme outperforms all the four baseline schemes for the entire range of dl values examined. In particular, compared with the CSI-based scheme, the proposed scheme improves the energy efficiency by 25.54% when dl = 140m. The CSIbased scheme performs slightly better compared to the average scheme.\nThe performance of the five schemes in terms of velocity with M = 4, dl = 200m, and PT = 40dBm is shown in Fig. 7. From the figure, the optimization scheme has lower energy consumption compared with the other four\n10\nbaseline schemes. The energy consumptions of five schemes all decrease with the increase of train speed. As the train velocity rises, the time it takes for the train to travel the same distance is reduced, and thus for the specific transmit power allocation method, the overall energy consumption is reduced. In particular, the energy consumption of the proposed optimization scheme is always lower than the value of the random allocation scheme, the average allocation scheme, and the CSI-based allocation scheme, and the optimization gain becomes more apparent as the train speed goes up.\nThe energy efficiencies with varying velocities is shown in Fig. 8. When the train speed is increased, the energy efficiencies of the optimized scheme, the random allocation scheme, the average allocation scheme, and the CSI-based allocation scheme all remain a high level. The energy efficiency of the proposed optimization scheme grows gradually and the value is higher than the other four baseline schemes. The difference between the optimization scheme and the CSI-based scheme is more apparent when v > 290km/h. Thus as the train speed rises, the energy efficiency optimization effect of the optimization scheme becomes better.\nIn addition to energy consumption and energy efficiency, we also compare the spectral efficiency of the five schemes. Fig. 9 provides the spectral efficiency performance curves as dl\nincreases and Fig. 10 shows the impact of velocity on spectral efficiency. The optimized, random, average, and CSI-based schemes have similar performance, and they all outperform the constant scheme. In Fig. 5, Fig. 6, Fig. 7, and Fig. 8, the proposed scheme achieves the highest energy efficiency and the lowest energy consumption, while in Fig. 9 and Fig. 10, the proposed scheme can only reach similar levels of spectral efficiency as the average scheme, the random scheme, and the CSI-based scheme. The results are related to the optimization model of this paper. Problem (20) optimizes the energy efficiency by minimizing the energy consumption under the constraints of the transmitted data volume and the transmit power. On the one hand, the proposed scheme achieves better EE for a given transmitted data volume Dmin by reducing the transmit power. On the other hand, precisely because of the strict constraints on the total transmitted data and transmit power, the system cannot achieve a higher spectral efficiency. Therefore, there is a trade-off between the energy efficiency and spectral efficiency of the system, which suggests that the optimal transmit power should be allocated with a full consideration of energy efficiency and spectral efficiency.\n11"
        },
        {
            "heading": "C. Computational Complexity Analysis",
            "text": "Computational complexity is an important indicator to measure the performance of the algorithm. This section compares the computational complexity of the proposed scheme with the four benchmark schemes.\nThe constant scheme allocates the fixed transmit power of PT /M for the ith MR in the cell, the random scheme allocates a random power value between 0 and PT to each MR subject to the constraints (24b), and the average scheme allocates an equal power to each MR in the cell. All three schemes are based on straightforward power allocation criteria that do not depend on channel conditions, and are therefore physically easier to implement. The formulated problem is to allocate transmit power to each MR during each interval [tj\u22121, tj), containing a total of M(M + N \u2212 1) variables, hence the computational complexity of all three schemes is O (M (M +N \u2212 1)).\nThe CSI-based scheme takes into account the channel fading. For a given i and j, finding Pi,j requires computing the\ncoefficients ( |hi,j |2 )\u2212\u03b1/\u2211M i=1 ( |hi,j |2 )\u2212\u03b1 . The complexity\nof computing \u2211M i=1 ( |hi,j |2 )\u2212\u03b1 is O (M), and therefore the complexity of computing Pi,j is also O (M). Considering all M(M + N \u2212 1) variables, the complexity of the CSI-based scheme is O ( M2 (M +N \u2212 1) ) .\nThe proposed algorithm first uses the gradient descent method to obtain the optimal solution of the augmented Lagrange function. The optimization problem (20) has M(M + N\u22121) optimization variables. Denote the number of iterations of gradient descent method as kGD, then the complexity of the gradient descent algorithm is O (kGDM (M +N \u2212 1)). Let the number of iterations of the multiplier punitive function algorithm be kMPF , thus the complexity of the proposed algorithm is O (kMPF kGDM (M +N \u2212 1)).\nIn contrast, the constant, random, and average schemes have the lowest computational complexity but fail to achieve similar energy consumption and energy efficiency performance as the proposed scheme. The computational complexity of the proposed scheme is comparable to that of the CSI-based scheme, while the proposed scheme outperforms the CSIbased scheme in terms of energy consumption and energy efficiency performance.\nD. Impact of Velocity Estimation Error\nDue to insufficient velocity information update as well as the additional latency for sending this information may cause velocity estimation error, now we take into account the velocity estimation error in our simulations. The velocity estimation error is assumed to follow Gaussian distribution here, i.e., v\u0302 = v + ve, where v\u0302 is the estimated velocity of the train, v is the actual velocity and estimation error ve \u223c N (0, \u03c32v) [32]. ve are generated as positive numbers in the simulation to correspond to the results in Fig. 7 and Fig. 8.\nFig. 11 plots the energy consumptions of the five schemes under different \u03c3v values. It can be obtained that when taking\nvelocity estimation error into account, the energy consumption trends of the five schemes are the same as in Fig. 7, and the proposed scheme achieves the lowest energy consumption. The optimized scheme is also the best choice.\nFig. 12 plots the energy efficiency comparison of the five schemes under different \u03c3v values. As we see, the energy efficiency of the proposed scheme continues to rise with increasing \u03c3v values and achieves the highest energy efficiency as in Fig. 8. This shows that the velocity estimation error has little effect on the energy efficiency optimization of the proposed scheme, and the performance of the proposed scheme is still optimal under different errors. Therefore, the proposed scheme has a stable optimization effect."
        },
        {
            "heading": "V. CONCLUSION",
            "text": "This paper studies the energy efficiency problem of a mmWave communication network for HSRs with multiple MRs on top of the train. To achieve green train-ground communications, an energy consumption minimization problem is formulated subject to the total transmitted data and transmit power budget constraints. Aimed at this non-convex nonlinear problem, a multiplier punitive function-based algorithm is proposed to allocated transmit power of MRs. Simula-\n12\ntion results have demonstrated that the proposed scheme can achieve higher energy efficiency compared to four baseline schemes under various parameters, including the number of MRs, the inter-RRH distance and the speed of the train. We also show the good performance of the proposed algorithm when considering the speed estimation error."
        }
    ],
    "title": "Energy Efficient Train-Ground mmWave Mobile Relay System for High Speed Railways",
    "year": 2022
}