{
    "abstractText": "Understanding the properties of charge dynamics is crucial to many practical applications, such as electrochemical energy devices and transmembrane ion channels. This work proposes a Maxwell--Amp\\`ere Nernst--Planck (MANP) framework for the description of charge dynamics. The MANP model with a curl-free condition on the electric displacement is shown to be energy dissipative with respect to a convex free-energy functional, and demonstrated to be equivalent to the Poisson--Nernst--Planck model. By the energy dissipation law, the steady state of the MANP model reproduces the charge conserving Poisson--Boltzmann (PB) theory, providing an alternative energy stable approach to study the PB theory. In order to achieve the curl-free condition, a companion local curl-free relaxation algorithm, which is shown to naturally preserve the discrete Gauss's law and converge robustly with linear computational complexity, is developed for the MANP model. One of the main advantages of our development is that it can efficiently deal with space-dependent permittivity instead of solving the variable-coefficient Poisson's equation. Many-body effects such as ionic steric effects and Coulomb correlations can be incorporated within the MANP framework to derive modified MANP models for problems in which the mean-field approximation fails. Numerical results on the charge dynamics with such beyond mean-field effects in inhomogeneous dielectric environments are presented to demonstrate the performance of the MANP models in the description of charge dynamics, illustrating that the proposed MANP model provides a general framework for modeling charge dynamics.",
    "authors": [
        {
            "affiliations": [],
            "name": "A MAXWELL--AMP"
        },
        {
            "affiliations": [],
            "name": "ERE NERNST--PLANCK"
        },
        {
            "affiliations": [],
            "name": "CHARGE DYNAMICS"
        },
        {
            "affiliations": [],
            "name": "ZHONGHUA QIAO\\dagger"
        },
        {
            "affiliations": [],
            "name": "ZHENLI XU\\ddagger"
        },
        {
            "affiliations": [],
            "name": "QIAN YIN\\ddagger"
        },
        {
            "affiliations": [],
            "name": "SHENGGAO ZHOU\\ddagger"
        }
    ],
    "id": "SP:b9f17f40e13cfa314b04d6102c52c8eed3be271f",
    "references": [
        {
            "authors": [
                "M. Baptista",
                "R. Schmitz"
            ],
            "title": "and B",
            "venue": "D\\\" unweg, Simple and robust solver for the Poisson-Boltzmann equation, Phys. Rev. E, 80 ",
            "year": 2009
        },
        {
            "authors": [
                "M.Z. Bazant",
                "M.S. Kilic",
                "B.D. Storey",
                "A. Ajdari"
            ],
            "title": "Towards an understanding of induced-charge electrokinetics at large applied voltages in concentrated solutions",
            "venue": "Adv. Colloid Interface Sci., 152 ",
            "year": 2009
        },
        {
            "authors": [
                "M.Z. Bazant",
                "K. Thornton",
                "A. Ajdari"
            ],
            "title": "Diffuse-charge dynamics in electrochemical systems",
            "venue": "Phys. Rev. E, 70 ",
            "year": 2004
        },
        {
            "authors": [
                "J.J. Bikerman"
            ],
            "title": "Structure and capacity of electrical double layer",
            "venue": "Lond. Edinb. Dublin Philos. Mag. J. Sci., 33 ",
            "year": 1942
        },
        {
            "authors": [
                "I. Borukhov",
                "D. Andelman",
                "H. Orland"
            ],
            "title": "Steric effects in electrolytes: A modified Poisson-Boltzmann equation",
            "venue": "Phys. Rev. Lett., 79 ",
            "year": 1997
        },
        {
            "authors": [
                "J. Che",
                "J. Dzubiella",
                "B. Li",
                "J.A. McCammon"
            ],
            "title": "Electrostatic free energy and its variations in implicit solvent models",
            "venue": "J. Phys. Chem. B, 112 ",
            "year": 2008
        },
        {
            "authors": [
                "G. Chen"
            ],
            "title": "L",
            "venue": "Chac\\' on, and D. C. Barnes, An energy- and charge-conserving, implicit, electrostatic particle-in-cell algorithm, J. Comput. Phys., 230 ",
            "year": 2011
        },
        {
            "authors": [
                "J.A. de la Torre",
                "P. Espa"
            ],
            "title": "nol, Coarse-graining Brownian motion: From particles to a discrete diffusion equation",
            "venue": "J. Chem. Phys.,",
            "year": 2011
        },
        {
            "authors": [
                "P. Degond",
                "F. Deluzet",
                "L. Navoret",
                "A.-B. Sun",
                "M.-H. Vignal"
            ],
            "title": "Asymptotic-preserving particle-in-cell method for the Vlasov-Poisson system near quasineutrality",
            "venue": "J. Comput. Phys., 229 ",
            "year": 2010
        },
        {
            "authors": [
                "J. Ding",
                "Z. Wang",
                "S. Zhou"
            ],
            "title": "Positivity preserving finite difference methods for Poisson- Nernst-Planck equations with steric interactions: Application to slit-shaped nanopore conductance",
            "venue": "J. Comput. Phys., 397 ",
            "year": 2019
        },
        {
            "authors": [
                "B. Eisenberg"
            ],
            "title": "Ionic channels in biological membranes-electrostatic analysis of a natural nanotube",
            "venue": "Contemp. Phys., 39 ",
            "year": 1998
        },
        {
            "authors": [
                "R.S. Eisenberg"
            ],
            "title": "Maxwell Equations Without a Polarization Field",
            "venue": "preprint, arXiv: 2009.07088",
            "year": 2020
        },
        {
            "authors": [
                "F. Fahrenberger",
                "C. Holm"
            ],
            "title": "Computing the Coulomb interaction in inhomogeneous dielectric media via a local electrostatics lattice algorithm",
            "venue": "Phys. Rev. E, 90 ",
            "year": 2014
        },
        {
            "authors": [
                "F. Fahrenberger",
                "Z. Xu",
                "C. Holm"
            ],
            "title": "Simulation of electric double layers around charged colloids in aqueous solution of variable permittivity",
            "venue": "J. Chem. Phys., 141 ",
            "year": 2014
        },
        {
            "authors": [
                "T. Horng",
                "S.R. Eisenberg",
                "C. Liu",
                "F. Bezanilla"
            ],
            "title": "Continuum gating current models computed with consistent interactions",
            "venue": "Biophys. J., 116 ",
            "year": 2019
        },
        {
            "authors": [
                "T. Horng",
                "T. Lin",
                "C. Liu",
                "R. Eisenberg"
            ],
            "title": "PNP equations with steric effects: A model of ion flow through channels",
            "venue": "J. Phys. Chem. B, 116 ",
            "year": 2012
        },
        {
            "authors": [
                "Y. Hyon",
                "B. Eisenberg",
                "C. Liu"
            ],
            "title": "A mathematical model for the hard sphere repulsion in ionic solutions",
            "venue": "Commun. Math. Sci., 9 ",
            "year": 2010
        },
        {
            "authors": [
                "J. Jiang",
                "D. Cao",
                "D. Jiang",
                "J. Wu"
            ],
            "title": "Time-dependent density functional theory for ion diffusion in electrochemical systems",
            "venue": "J. Phys. Condens. Matter., 26 ",
            "year": 2014
        },
        {
            "authors": [
                "M.S. Kilic",
                "M.Z. Bazant",
                "A. Ajdari"
            ],
            "title": "Steric effects in the dynamics of electrolytes at large applied voltages II Modified Poisson-Nernst--Planck equations",
            "venue": "Phys. Rev. E, 75 ",
            "year": 2007
        },
        {
            "authors": [
                "C. Lee"
            ],
            "title": "The charge conserving Poisson-Boltzmann equations: Existence",
            "venue": "uniqueness, and maximum principle, J. Math. Phys., 55 ",
            "year": 2014
        },
        {
            "authors": [
                "C. Lee",
                "H. Lee",
                "Y. Hyon",
                "T. Lin",
                "C. Liu"
            ],
            "title": "New Poisson-Boltzmann type equations: One-dimensional solutions",
            "venue": "Nonlinearity, 24 ",
            "year": 2010
        },
        {
            "authors": [
                "B. Li"
            ],
            "title": "Continuum electrostatics for ionic solutions with nonuniform ionic sizes",
            "venue": "Nonlinearity, 22 ",
            "year": 2009
        },
        {
            "authors": [
                "B. Li"
            ],
            "title": "Minimization of electrostatic free energy and the Poisson-Boltzmann equation for molecular solvation with implicit solvent",
            "venue": "SIAM J. Math. Anal., 40 ",
            "year": 2009
        },
        {
            "authors": [
                "B. Li",
                "P. Liu",
                "Z. Xu",
                "S. Zhou"
            ],
            "title": "Ionic size effects: Generalized Boltzmann distributions",
            "venue": "counterion stratification and modified Debye length, Nonlinearity, 26 ",
            "year": 2013
        },
        {
            "authors": [
                "T. Lin",
                "B. Eisenberg"
            ],
            "title": "A new approach to the Lennard-Jones potential and a new model: PNP-steric equations",
            "venue": "Commun. Math. Sci., 12 ",
            "year": 2014
        },
        {
            "authors": [
                "C. Liu",
                "C. Wang",
                "S.M. Wise",
                "X. Yue",
                "S. Zhou"
            ],
            "title": "A positivity-preserving",
            "venue": "energy stable and convergent numerical scheme for the Poisson-Nernst-Planck system, Math. Comput., 90 ",
            "year": 2021
        },
        {
            "authors": [
                "P. Liu",
                "X. Ji",
                "Z. Xu"
            ],
            "title": "Modified Poisson-Nernst--Planck model with accurate Coulomb correlation in variable media",
            "venue": "SIAM J. Appl. Math., 78 ",
            "year": 2018
        },
        {
            "authors": [
                "B. Lu",
                "Y. Zhou"
            ],
            "title": "Poisson-Nernst-Planck equations for simulating biomolecular diffusionreaction processes II: Size effects on ionic distributions and diffusion-reaction rates",
            "venue": "Biophys J., 100 ",
            "year": 2011
        },
        {
            "authors": [
                "M. Ma",
                "Z. Xu"
            ],
            "title": "Self-consistent field model for strong electrostatic correlations and inhomogeneous dielectric media",
            "venue": "J. Chem. Phys., 141 ",
            "year": 2014
        },
        {
            "authors": [
                "M. Ma",
                "Z. Xu",
                "L. Zhang"
            ],
            "title": "Ion transport in electrolytes of dielectric nanodevices",
            "venue": "Phys. Rev. E, 104 ",
            "year": 2021
        },
        {
            "authors": [
                "M. Ma",
                "Z. Xu",
                "L. Zhang"
            ],
            "title": "Modified Poisson-Nernst--Planck model with Coulomb and hard-sphere correlations",
            "venue": "SIAM J. Appl. Math., 81 ",
            "year": 2021
        },
        {
            "authors": [
                "A.C. Maggs"
            ],
            "title": "Dynamics of a local algorithm for simulating Coulomb interactions",
            "venue": "J. Chem. Phys., 117 ",
            "year": 2002
        },
        {
            "authors": [
                "A.C. Maggs"
            ],
            "title": "A minimizing principle for the Poisson-Boltzmann equation",
            "venue": "Europhys. Lett., 98 ",
            "year": 2012
        },
        {
            "authors": [
                "A.C. Maggs",
                "V. Rossetto"
            ],
            "title": "Local simulation algorithms for coulomb interactions",
            "venue": "Phys. Rev. Lett., 88 ",
            "year": 2002
        },
        {
            "authors": [
                "P.A. Markowich",
                "C.A. Ringhofer",
                "C. Schmeiser"
            ],
            "title": "Semiconductor Equations",
            "venue": "Springer Science \\& Business Media, New York",
            "year": 2012
        },
        {
            "authors": [
                "I. Pasichnyk",
                "B. D"
            ],
            "title": "unweg, Coulomb interactions via local dynamics: A moleculardynamics algorithm",
            "venue": "J. Phys. Condens. Matter,",
            "year": 2004
        },
        {
            "authors": [
                "J.S. Pujos",
                "A.C. Maggs"
            ],
            "title": "Convexity and stiffness in energy functions for electrostatic simulations",
            "venue": "J. Chem. Theory Comput., 11 ",
            "year": 2015
        },
        {
            "authors": [
                "R. Roth",
                "R. Evans",
                "A. Lang",
                "G. Kahl"
            ],
            "title": "Fundamental measure theory for hard-sphere mixtures revisited: The white bear version",
            "venue": "J. Phys. Condens. Matter, 14 ",
            "year": 2002
        },
        {
            "authors": [
                "J. Rottler",
                "A.C. Maggs"
            ],
            "title": "A continuum",
            "venue": "O (N) Monte Carlo algorithm for charged particles, J. Chem. Phys., 120 ",
            "year": 2004
        },
        {
            "authors": [
                "J. Rottler",
                "A.C. Maggs"
            ],
            "title": "Local molecular dynamics with coulombic interactions",
            "venue": "Phys. Rev. Lett., 93 ",
            "year": 2004
        },
        {
            "authors": [
                "R.B. Schoch",
                "J. Han",
                "P. Renaud"
            ],
            "title": "Transport phenomena in nanofluidics",
            "venue": "Rev. Mod. Phys., 80 ",
            "year": 2008
        },
        {
            "authors": [
                "Y. Tu",
                "Q. Pang",
                "H. Yang",
                "Z. Xu"
            ],
            "title": "Linear-scaling selected inversion based on hierarchical interpolative factorization for self Green's function for modified Poisson-Boltzmann equation in two dimensions",
            "venue": "J. Comput. Phys., 461 ",
            "year": 2022
        },
        {
            "authors": [
                "L. Wan",
                "S. Xu",
                "M. Liao",
                "C. Liu",
                "P. Sheng"
            ],
            "title": "Self-consistent approach to global charge neutrality in electrokinetics: A surface potential trap model",
            "venue": "Phys. Rev. X, 4 ",
            "year": 2014
        },
        {
            "authors": [
                "Z. Xu",
                "M. Ma",
                "P. Liu"
            ],
            "title": "Self-energy-modified poisson-Nernst-Planck equations: WKB approximation and finite-difference approaches",
            "venue": "Phys. Rev. E, 90 ",
            "year": 2014
        },
        {
            "authors": [
                "Y.-X. Yu",
                "J.-Z. Wu"
            ],
            "title": "Structures of hard-sphere fluids from a modified fundamental-measure theory",
            "venue": "J. Chem. Phys., 117 ",
            "year": 2002
        },
        {
            "authors": [
                "S. Zhou",
                "Z. Wang",
                "B. Li"
            ],
            "title": "Mean-field description of ionic size effects with non-uniform ionic sizes: A numerical approach",
            "venue": "Phys. Rev. E, 84 ",
            "year": 2011
        }
    ],
    "sections": [
        {
            "text": "Key words. Maxwell--Amp\\`ere Nernst--Planck equations, beyond mean field, energy dissipation, local curl-free relaxation, linear complexity\nMSC codes. 35K55, 82C21\nDOI. 10.1137/22M1477891\n1. Introduction. Charge dynamics plays a fundamental role in various realworld applications, e.g., electrochemical devices [3], semiconductors [35], microfluidics [41], and biological ion channels [11]. At the continuum level, charge dynamics is often explored by the well-known Poisson--Nernst--Planck (PNP) theory. Based on the mean-field approximation, the classical PNP theory treats ions as point charges, takes the screening effect of background medium into account as a continuum of certain dielectric coefficients, and neglects direct ion--ion interaction details, with ions interacting only through the mean electrostatic potential. With such approximations, the\n* Received by the editors February 14, 2022; accepted for publication (in revised form) November 21, 2022; published electronically March 20, 2023. https://doi.org/10.1137/22M1477891 Funding: This work was supported by the CAS AMSS-PolyU Joint Laboratory of Applied Mathematics. The work of the first author is partially supported by the Hong Kong Research Grants Council (RFS grant RFS2021-5S03 and GRF grants 15302919 and 15303121). The work of the second and third authors was partially supported by NSFC (grant 12071288), Shanghai Science and Technology Commission (grants 20JC1414100 and 21JC1403700), the Strategic Priority Research Program of CAS (grant XDA25010403), and the HPC center of Shanghai Jiao Tong University. The work of the fourth author was partially supported by the National Natural Science Foundation of China 12171319, Natural Science Foundation of Jiangsu Province (BK20200098), China, and Shanghai Science and Technology Commission (21JC1403700).\n\\dagger  Department of Applied Mathematics and Research Institute for Smart Energy, The Hong Kong Polytechnic University, Hung Hom, Hong Kong (zhonghua.qiao@polyu.edu.hk). \\ddagger  School of Mathematical Sciences, MOE-LSC, and CMA-Shanghai, Shanghai Jiao Tong University, Shanghai 200240, China (xuzl@sjtu.edu.cn, sjtu yinq@sjtu.edu.cn, sgzhou@sjtu.edu.cn).\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\n374\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nA MAXWELL--AMP\\`ERE NERNST--PLANCK MODEL 375\nNernst--Planck equations are used to describe the diffusion and convection of ions under the gradient of the electric potential which in turn is governed by the Poisson equation with charge sources arising from mobile ions and permanent charges in the system.\nDespite its great success in various applications, the PNP theory fails in cases, e.g., concentrated ionic solutions of high valences, where the mean-field approximations break down [2, 27]. To address these issues, ionic steric effects and Coulomb correlations are often incorporated in the framework of PNP theory. For instance, ionic steric effects can be included based on the lattice gas theory, by considering the entropy of solvent [5, 19, 22, 23, 28]. Hard-sphere interactions between ions can be modeled by the Lennard--Jones potential energy, which gives rise to a nonlocal modified PNP model [17]. To get a computationally tractable model, the nonlocal Lennard--Jones integrals are further approximated to obtain a type of local modified PNP models [16, 25]. The ionic steric effects can also be described by the fundamental measure density functional theory [18, 38, 45], which gives rise to a complicated model with modified nonlocal PNP equations. To account for Coulomb correlation effects, the self energy of ions governed by the generalized Debye--H\\\"uckel equation is taken into account in a modified PNP theory [27]. Such a theory further with ionic steric effects described by the fundamental measure density functional theory is able to accurately reproduce molecular simulation results on ionic distributions next to charged surfaces with dielectric mismatches [27, 31].\nIt is of interest to observe that the electric potential appears in the PNP equations in the form of its gradient, i.e., the electric field. This inspires us to use ionic concentrations and the electric field, rather than the electric potential, to describe the charge dynamics. The replacement of the Poisson equation by the Maxwell--Amp\\`ere equation and further coupling with the Nernst--Planck equation to describe charge dynamics have been first proposed in a series of works [12, 15] by Eisenberg and his collaborators. Also, it has been shown that the formulation based on concentrations and the electric field has several advantages [1, 40, 46]. For instance, the free-energy functional of a charged system is convex with respect to ionic concentrations [33]. The convexity is a valuable feature in the design of numerical methods for finding the steady state of a charged system via minimization [1, 33, 37]. In this work, we propose a Maxwell--Amp\\`ere Nernst--Planck (MANP) model in which the ionic concentrations and electric displacement, i.e., dielectric coefficient times the electric field, are the unknown variables. In order to overcome the drawbacks due to the mean-field approximations, ionic steric effects and Coulomb correlations are taken into account in the framework of the MANP model. We present modified MANP models with excess energies to account for steric effects, e.g., described by lattice-gas theories [5], and Coulomb correlations modeled by dielectric self energy of ions and ion--ion correlations [27].\nIt is also derived that the MANP model is energy dissipative with respect to a convex free-energy functional. By the energy dissipation law, the steady state of the MANP model reproduces the charge conserving PB theory [20, 21, 43]. Therefore, our MANP model provides an alternative energy-stable approach to study the charge conserving PB theory analytically and numerically. The electric displacement obtained from the discretized Maxwell--Amp\\`ere equation is updated with a local relaxation procedure to achieve the curl-free property. It is shown that the local curl-free relaxation algorithm is guaranteed to converge and is of linear computational complexity. Such a local relaxation idea was first proposed in [32, 34] to devise a local molecular simulation algorithm for the long-range Coulomb interactions. It is later coupled with the Maxwell equations to obtain the Maxwell equation molecular dynamics (MEMD) for dynamics simulations [36, 39, 40]. The algorithm has also been extended to deal\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\n376 Z. QIAO, Z. XU, Q. YIN, AND S. ZHOU\nwith inhomogeneous dielectrics [13, 14] and solve the PB equations [1] as well as the PB equations with steric effects [46].\nThe advantage of the MANP formulation is that it is a local formulation and avoids solving the Poisson's equation for which the dielectric coefficient could be inhomogeneous in cases of practical interests. In each time step, the electric displacement can be explicitly updated by the discretized Maxwell--Amp\\`ere equation with the updated ionic concentrations. Explicit formula for each local relaxation step is available in the local curl-free relaxation algorithm. Also, numerical tests demonstrate that the number of relaxation steps in the local relaxation algorithm is small and bounded. Therefore, the update algorithm for the electric displacement in each time step is of linear computational complexity. As aforementioned, the MANP model can efficiently deal with space-dependent permittivity instead of solving the variable-coefficient Poisson equation. In addition, due to the local nature of the algorithm for the electric displacement, the MANP model and corresponding numerical methods can be further extended to the efficient coarse-grained simulations of charge dynamics with fluctuations [8]. It also has great potential to apply the MANP model to other areas such as the particle-in-cell simulation of plasma [7, 9]. For example, a Vlasov--Amp\\`ere model, rather an earlier Vlasov--Poisson model, has been applied to particle-in-cell simulations of plasma [7]. In contrast to the one-dimensional simulations performed in the work [7], our MANP model with the local curl-free relaxation algorithm is promising to deal with high-dimensional cases.\nThe rest of this paper is organized as follows. In section 2, we derive the MANP model. In section 3, we present some properties and advantages of the MANP model. Section 4 presents numerical methods for the MANP model and some results. The paper ends with some conclusions in section 5.\n2. Model. This section begins with an overview of the PNP equations, then advances to a reformulated model, namely, the MANP equations, and finally shows the equivalence of the two models. In spite of the mathematical equivalence, we remark that the MANP framework has its advantages in the incorporation of manybody effects and the design of numerical schemes.\n2.1. PNP equations. Consider an electrolyte solution of M ionic species occupying a bounded and connected domain \\Omega with periodic boundary conditions. Let c\\ell (\\bfitr , t) be the ionic concentration for the \\ell th species (\\ell = 1, . . . ,M) at time t, and \\phi (\\bfitr , t) be the electric potential. The electrostatic free energy of the system is given by\n(2.1) F [c1, . . . , cM ] = \\int  \\Omega  \\Biggl[  \\varepsilon 0\\varepsilon r| \\nabla \\phi | 2 2 + kBT M\\sum  \\ell =1 c\\ell  \\bigl(  log(\\Lambda 3c\\ell ) - 1 \\bigr) \\Biggr]  d\\bfitr ,\nwhere \\varepsilon 0 is the vacuum permittivity, \\varepsilon r is the relative permittivity that can be spatially dependent, kBT is the thermal energy, and \\Lambda is the thermal de Broglie wavelength. The electrostatic free energy F consists of the electric field energy and entropic contribution of ions. Here, the electric potential \\phi is determined by the ionic concentrations through the Poisson equation\n(2.2)  - \\nabla \\cdot \\varepsilon 0\\varepsilon r\\nabla \\phi = \\rho , where \\rho = \\sum M\n\\ell =1 z \\ell ec\\ell + \\rho f is the total charge density, z\\ell is the valence, and\n\\rho f (\\bfitr ) : \\Omega \\rightarrow \\BbbR is a given function representing the distribution of fixed charges. Ion transport in the system is described by the conservation law\n(2.3) \\partial c\\ell \n\\partial t = - \\nabla \\cdot \\bfitJ \\ell ,\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\nA MAXWELL--AMP\\`ERE NERNST--PLANCK MODEL 377\nwhere the ionic flux \\bfitJ \\ell is given by\n\\bfitJ \\ell = - \\gamma  \\ell c\\ell \nkBT \\nabla \\mu \\ell ,\nand \\gamma \\ell > 0 is the diffusion coefficient. The chemical potential is given by the variation of the free energy, \\mu \\ell = \\delta F/\\delta c\\ell , which is\n(2.4) \\mu \\ell = z\\ell e\\phi + kBT log(\\Lambda  3c\\ell ).\nIt follows from periodic boundary conditions that the total ionic mass of each species conserves in the domain\nd\ndt \\int  \\Omega  c\\ell d\\bfitr = 0.\nTherefore, we have \\int  \\Omega  c\\ell (\\bfitr , t)d\\bfitr = \\int  \\Omega  c\\ell (\\bfitr ,0)d\\bfitr = N \\ell , where N \\ell is the total ionic mass of \\ell th ionic species. Coupling (2.3) with the Poisson equation (2.2) leads to the widely known PNP equations\n(2.5)\n\\left\\{  \\partial c\\ell \n\\partial t =\\nabla \\cdot \\gamma \\ell \n\\biggl(  \\nabla c\\ell + z \\ell ec\\ell  kBT \\nabla \\phi  \\biggr)  , \\ell = 1, . . . ,M,\n - \\nabla \\cdot \\varepsilon 0\\varepsilon r\\nabla \\phi = \\rho .\nWe introduce characteristic concentration c0, diffusion constant \\gamma 0, and lengths L and lc = [\\varepsilon 0kBT/(e 2c0)] 1/2. Define \\~\\bfitr = \\bfitr /L, \\~t= t\\gamma 0/(lcL), \\~\\nabla = L\\nabla , \\~\\rho f = \\rho f/(ec0), \\~\\gamma = lc\\gamma  l/(L\\gamma 0), \\varepsilon = \\varepsilon rl 2 c/L 2, \\~\\Lambda 3 = \\Lambda 3c0 \\~c \\ell = c\\ell /c0, \\~\\phi = e\\phi /(kBT ), \\~N\n\\ell = N \\ell /(L3c0), and \\~F = F/(kBTc0L\n3). After rescaling, we have the nondimensionalized PNP equations\n(2.6)\n\\left\\{  \\partial \\~c\\ell \n\\partial \\~t = \\~\\nabla \\cdot \\~\\gamma \\ell \n\\Bigl(  \\~\\nabla \\~c\\ell + z\\ell \\~c\\ell \\~\\nabla \\~\\phi  \\Bigr)  , \\ell = 1, . . . ,M,\n - \\~\\nabla \\cdot \\varepsilon \\~\\nabla \\~\\phi = M\\sum  \\ell  z\\ell \\~c\\ell + \\~\\rho f ,\nand the electrostatic free energy\n(2.7) \\~F [\\~c1, . . . , \\~cM ] = \\int  \\~\\Omega  \\Biggl[  \\varepsilon | \\~\\nabla \\~\\phi | 2 2 + M\\sum  \\ell =1 \\~c\\ell log \\~c\\ell  \\Biggr]  d\\~\\bfitr + (log \\~\\Lambda 3  - 1) M\\sum  \\ell =1 \\~N \\ell ,\nwith the second equation in (2.6) as the constraint. The last term in (2.7) is a constant that will be ignored for simplicity. Also, we will drop all the tildes and use the dimensionless equations for our discussion in the rest of the paper.\n2.2. MANP equations. In the PNP equations, charge dynamics of the system is described by the ionic concentrations and electric potential. Based on an observation that the electric potential appears in the PNP equations in the form of its gradient, we can alternatively work on ionic concentrations and the electric displacement \\bfitD = \\varepsilon \\bfitE  instead, where \\bfitE = - \\nabla \\phi is the electric field. The charge continuity equation reads\n(2.8) \\partial \\rho \n\\partial t +\\nabla \\cdot \\bfitj = 0,\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\n378 Z. QIAO, Z. XU, Q. YIN, AND S. ZHOU\nwhere the current density of charge is (2.9) \\bfitj = -  M\\sum  \\ell =1 z\\ell \\gamma \\ell c\\ell \\nabla \\mu \\ell .\nIt follows from the Gauss law \\nabla \\cdot \\bfitD = \\rho that\n(2.10) \\nabla \\cdot  \\biggl(  \\partial \\bfitD \n\\partial t + \\bfitj \n\\biggr)  = 0.\nSuch a derivation, combining the charge continuity equation and the Poisson equation, was first presented in [15]. It then leads to the Maxwell--Amp\\`ere equation\n(2.11) \\partial \\bfitD \n\\partial t + \\bfitj =\\Theta ,\nwhere \\Theta satisfies the Coulomb gauge condition \\nabla \\cdot \\Theta = 0. Also, it is introduced as a degree of freedom to enforce \\nabla \\times (\\bfitD /\\varepsilon ) = 0, which implies the existence of the electric potential satisfying the Poisson equation in a connected spatial domain. With the electric displacement \\bfitD , the charge dynamics can be described by the MANP equations\n(2.12)\n\\left\\{ \n\\partial c\\ell \n\\partial t =\\nabla \\cdot \\gamma \\ell \n\\biggl(  \\nabla c\\ell  - z \\ell c\\ell \\bfitD \n\\varepsilon \n\\biggr)  , \\ell = 1, . . . ,M,\n\\partial \\bfitD \n\\partial t = M\\sum  \\ell =1 z\\ell \\gamma \\ell  \\biggl(  \\nabla c\\ell  - z \\ell c\\ell \\bfitD  \\varepsilon  \\biggr)  +\\Theta ,\n\\nabla \\cdot \\Theta = 0,\n\\nabla \\times \\bfitD  \\varepsilon  = 0,\nwith certain initial concentrations c\\ell (\\bfitr ,0) and electric displacement \\bfitD (\\bfitr ,0). It is not difficult to show that the PNP equations are equivalent to the MANP equations (2.12). Taking divergence of both sides of the Maxwell--Amp\\`ere equation, we obtain (2.13) \\nabla \\cdot  \\biggl(  \\partial \\bfitD \n\\partial t\n\\biggr)  = M\\sum  \\ell =1 z\\ell  \\partial c\\ell  \\partial t .\nIntegrating it with respect to time results in the Gauss law (2.14) \\nabla \\cdot \\bfitD = M\\sum  \\ell =1 z\\ell c\\ell + a(\\bfitr ),\nwhere a(\\bfitr ) is a time-independent function. From the curl-free equation in (2.12), there exists a scalar function \\phi such that \\bfitD /\\varepsilon = - \\nabla \\phi , which can be combined with the Gauss law to recover the Poisson equation\n - \\nabla \\cdot (\\varepsilon \\nabla \\phi ) = M\\sum  \\ell =1 z\\ell c\\ell + a(\\bfitr ).\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\nA MAXWELL--AMP\\`ERE NERNST--PLANCK MODEL 379\nIf the initial electric displacement is prescribed by \\bfitD (\\bfitr ,0) = - \\varepsilon \\nabla \\phi (\\bfitr ,0) with \\phi (\\bfitr ,0) determined by\n - \\nabla \\cdot [\\varepsilon \\nabla \\phi (\\bfitr ,0)] = M\\sum  \\ell =1 z\\ell c\\ell (\\bfitr ,0) + \\rho f ,\nthen we can identify a(\\bfitr ) = \\rho f (\\bfitr ) as the distribution function of permanent charges. The Nernst--Planck equations can be readily recovered with \\bfitD = - \\varepsilon \\nabla \\phi .\n3. Properties of the MANP formulation.\n3.1. Energy dissipation. It follows from (2.7) that the electrostatic free energy can also be expressed as\n(3.1) \\scrF [c1, . . . , cM ] = \\int  \\Omega  \\Biggl(  | \\bfitD | 2 2\\varepsilon  + M\\sum  \\ell =1 c\\ell log c\\ell  \\Biggr)  d\\bfitr , with \\nabla \\cdot \\bfitD = M\\sum  \\ell =1 z\\ell c\\ell + \\rho f .\nObviously, \\scrF [c1, . . . , cM ] is a convex energy functional and the proposed MANP model can be shown to be energy dissipative.\nTheorem 3.1. The MANP equations (2.12) satisfy the energy dissipation law\n(3.2) d\\scrF [c1, . . . , cM ]\ndt = - \\omega \\leq 0,\nwhere the energy dissipation functional\n(3.3) \\omega = M\\sum  \\ell =1 \\int  \\Omega  \\gamma \\ell c\\ell  \\varepsilon 2 \\bigm| \\bigm| \\varepsilon \\nabla log c\\ell  - z\\ell \\bfitD \\bigm| \\bigm| 2 d\\bfitr .\nProof. Taking derivative of \\scrF with respect to time, we have\nd\\scrF  dt = \\int  \\Omega  \\Biggl[  \\bfitD  \\varepsilon  \\cdot \\partial \\bfitD  \\partial t + M\\sum  \\ell =1 \\partial c\\ell  \\partial t \\bigl(  log c\\ell + 1 \\bigr) \\Biggr]  d\\bfitr .\nIt follows from the MANP equations (2.12) that\nd\\scrF  dt = \\int  \\Omega  \\Biggl[  \\bfitD  \\varepsilon  \\cdot (\\Theta  - \\bfitj ) + M\\sum  \\ell =1 \\nabla \\cdot \\gamma \\ell  \\biggl(  \\nabla c\\ell  - z \\ell c\\ell \\bfitD  \\varepsilon  \\biggr) \\bigl(  log c\\ell + 1 \\bigr) \\Biggr]  d\\bfitr \n= \\int  \\Omega  \\Biggl[  M\\sum  \\ell =1 z\\ell \\gamma \\ell  \\bfitD  \\varepsilon  \\cdot  \\biggl(  \\nabla c\\ell  - z \\ell c\\ell \\bfitD  \\varepsilon  \\biggr)   -  M\\sum  \\ell =1 \\gamma \\ell  c\\ell  \\biggl(  \\nabla c\\ell  - z \\ell c\\ell \\bfitD  \\varepsilon  \\biggr)  \\cdot \\nabla c\\ell  \\Biggr]  d\\bfitr \n= -  M\\sum  \\ell =1 \\int  \\Omega  \\gamma \\ell  \\varepsilon 2c\\ell  \\bigm| \\bigm| \\varepsilon \\nabla c\\ell  - z\\ell c\\ell \\bfitD \\bigm| \\bigm| 2 d\\bfitr \n= - \\omega \\leq 0, where we have used the integration by parts, periodic boundary conditions, and the equality \\int  \\Omega  (\\bfitD /\\varepsilon ) \\cdot \\Theta d\\bfitr = 0. The latter equality can be shown by the facts that \\nabla \\times (\\bfitD /\\varepsilon ) = 0, \\nabla \\cdot \\Theta = 0, and periodic boundary conditions. Remark 3.1. When nonperiodic boundary conditions are considered, the energy evolution of the MANP formulation becomes\nd\\scrF  dt = - \\omega + \\int  \\partial \\Omega  \\Biggl(  \\phi  \\partial \\sigma  \\partial t + M\\sum  \\ell =1 \\gamma \\ell c\\ell \\mu \\ell  \\partial \\mu \\ell  \\partial \\bfitn  \\Biggr)  dS,\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\n380 Z. QIAO, Z. XU, Q. YIN, AND S. ZHOU\nwhere \\bfitn denotes the unit exterior normal at the boundary and \\sigma = - \\bfitD \\cdot \\bfitn represents the surface charge density at the boundary. Again, one can obtain energy dissipation d\\scrF /dt \\leq 0, if zero normal ionic flux boundary conditions are imposed for a closed system and time-independent surface charge density is prescribed as a boundary condition for the electric displacement.\nWith such an energy dissipative law, it is desirable to design numerical methods that are able to preserve energy dissipation at discrete level. Structure-preserving numerical methods for the MANP model will be studied in future works.\n3.2. Steady state. The convex free energy \\scrF [c1, . . . , cM ] can be shown to be bounded below by using the inequality x logx \\geq  - 1/e. Therefore, the existence of a steady state of the MANP equations can be established by the energy dissipation law; cf. Theorem 3.1. It follows from (3.2), (3.3), (2.12), and (2.14) that the steady state is characterized by equations\n(3.4)\n\\left\\{ \n\\varepsilon \\nabla c\\ell  - z\\ell c\\ell \\bfitD = 0, \\nabla \\cdot \\bfitD = M\\sum  \\ell =1 z\\ell c\\ell + \\rho f , \\nabla \\times \\bfitD  \\varepsilon  = 0.\nSuch a system is equivalent to the well-known PB equation. Indeed, from the curl-free condition we have that the electrostatic potential satisfies \\bfitD /\\varepsilon =  - \\nabla \\phi . By the first equation in (3.4), we obtain the Boltzmann distributions\nc\\ell = c\\ell Ne  - z\\ell \\phi ,\nwhere c\\ell N =N \\ell / \\int  \\Omega  e - z\n\\ell \\phi d\\bfitr is a normalization constant determined by the total ionic mass N \\ell . Substituting the expressions of \\bfitD and c\\ell into the second equation of system (3.4), we obtain the charge conserving PB (ccPB) equation [20, 21, 43] (3.5)  - \\nabla \\cdot (\\varepsilon \\nabla \\phi ) = M\\sum  \\ell =1 z\\ell N \\ell \\int  \\Omega  e - zl\\phi d\\bfitr  e - z l\\phi + \\rho f .\nNote that, if an open system is connected to a bulk ionic solution reservoir, the normalization constant can be determined with the bulk ionic concentrations c\\ell ,\\infty , leading to the classical Boltzmann distributions c\\ell = c\\ell ,\\infty e - z\n\\ell \\phi . Then, we can obtain the classical PB equation.\nAs the governing equation for the steady state, the ccPB equation can be solved from a variational perspective. The convex structure plays a crucial role in the design of efficient numerical methods for finding steady states via minimization [1, 37]. In literature, the energy functional of the electrostatic potential is known to be nonconvex [6]. In order to have a minimizing principle, rather a stationary principle, the Legendre transform was used to formulate a local, convex dual functional [33]. Our MANP formulation provides a promising approach to investigate the steady state. Energy dissipating numerical schemes that allow large time step sizes can be used to find the steady state robustly and efficiently, especially for the system with conserved total ionic mass.\n3.3. Beyond mean field. In mean-field approximations, ions are treated as point charges without direct ion--ion interactions, e.g., steric interactions of short range and Coulombic correlations of long range. Therefore, the MANP theory proposed\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\nA MAXWELL--AMP\\`ERE NERNST--PLANCK MODEL 381\nabove does not work well for concentrated ionic solutions of high valences, where the mean-field approximations break down. To overcome the defects, ionic steric effects and Coulomb correlations can be included within our MANP framework. Consider a free-energy functional\n(3.6) \\scrF [c1, . . . , cM ] = \\int  \\Omega  \\Biggl(  | \\bfitD | 2 2\\varepsilon  + M\\sum  \\ell =1 c\\ell log c\\ell  \\Biggr)  d\\bfitr +\\scrF st +\\scrF co,\nwhere \\scrF st describes the excess free energy due to steric effects of finite-size ions and \\scrF co represents the excess Coulomb interaction energy. Such two excess energies lead to the corresponding excess chemical potentials defined by\n\\mu \\ell ,st = \\delta F st\n\\delta c\\ell  and \\mu \\ell ,co =\n\\delta F co\n\\delta c\\ell  .\nThere are several models to describe the excess energy due to steric effects in literature. One popular model is based on the statistical mechanics of ions and solvent molecules on a cubic lattice of spacing in the continuum limit [2]. In such a model, the entropy of solvent molecules, in addition to the entropy of ions, accounts for the excess chemical potential [4, 5, 24, 28]\n\\mu \\ell ,st = - v\\ell  v0 ln (v0c0) ,\nwhere v\\ell and v0 are the volume of ions of the \\ell th species and solvent molecule, respectively, and c0 = c0(r, t) is the solvent concentration defined by\nc0(r, t) = v  - 1 0\n\\Biggl[  1 - \nM\\sum  \\ell =1 v\\ell c \\ell (r, t)\n\\Biggr]  .\nAlternatively, the steric effects due to hard-sphere interactions can be described by the Lennard--Jones potential energy, which gives rise to a nonlocal model [17]. Local approximations of nonlocal Lennard--Jones integrals can be employed to obtain local models by Fourier analysis [16, 25]. The excess chemical potential is then given by\n(3.7) \\mu \\ell ,st = M\\sum  j=1 \\omega \\ell jcj ,\nwhere (\\omega ij)M\\times M is a symmetric matrix to represent the cross-interactions between different species and self-interactions between ions of the same species [10]. Also, there are other complicated models to describe steric effects, such as the fundamental measure density functional theory [18, 38, 45].\nIn addition to ion--ion correlation, the Coulomb correlation includes the dielectric self energy of ions. The excess chemical potential due to Coulomb correlation is given by [27, 29, 31, 44]\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\n382 Z. QIAO, Z. XU, Q. YIN, AND S. ZHOU\n(3.8) \\mu \\ell ,co = (z\\ell )2\n2\n\\biggl[  1\n4\\pi a\\ell \n\\biggl(  1 \\varepsilon (\\bfitr )  - 1 \\biggr)  + lim \\bfitr \\prime \\rightarrow \\bfitr  \\biggl(  G (\\bfitr ,\\bfitr \\prime ) - 1 4\\pi \\varepsilon (\\bfitr )| \\bfitr  - \\bfitr \\prime |  \\biggr) \\biggr]  ,\nwhere a\\ell is the radius for ions of the \\ell th species, and G(\\bfitr ,\\bfitr \\prime ) is the Green function satisfying the generalized Debye--H\\\"uckel equation\n(3.9)  - \\nabla \\cdot \\varepsilon (\\bfitr )\\nabla G (\\bfitr ,\\bfitr \\prime ) + 2I(\\bfitr , t)G (\\bfitr ,\\bfitr \\prime ) = \\delta (\\bfitr  - \\bfitr \\prime ) .\nTo consider boundary effects, we consider inhomogeneous dielectric permittivity and the ionic strength profile given by\nI(\\bfitr , t) =\n\\left\\{  1\n2 M\\sum  \\ell =1 (z\\ell )2c\\ell (\\bfitr , t), \\bfitr \\in \\Omega , 0, \\bfitr /\\in \\Omega .\nWith the excess contributions from steric effects and Coulomb correlation, our MANP model becomes\n(3.10)\n\\left\\{ \n\\partial c\\ell \n\\partial t =\\nabla \\cdot \\gamma \\ell \n\\biggl(  \\nabla c\\ell  - z \\ell c\\ell \\bfitD \n\\varepsilon  + c\\ell \\nabla \\mu \\ell ,st + c\\ell \\nabla \\mu \\ell ,co\n\\biggr)  , \\ell = 1, . . . ,M,\n\\partial \\bfitD \n\\partial t = M\\sum  \\ell =1 z\\ell \\gamma \\ell  \\biggl(  \\nabla c\\ell  - z \\ell c\\ell \\bfitD  \\varepsilon  + c\\ell \\nabla \\mu \\ell ,st + c\\ell \\nabla \\mu \\ell ,co \\biggr)  +\\Theta ,\n\\nabla \\cdot \\Theta = 0,\n\\nabla \\times \\bfitD  \\varepsilon  = 0.\nRemark 3.2. Solving the generalized Debye--H\\\"uckel equation (3.9) is challenging due to the high-dimensional Green function G(\\bfitr ,\\bfitr \\prime ). For channel problems which are often studied in nanodevices, asymptotic solutions by using Wentzel--Kramers-Brillouin approximation can be employed; see [30, 31] for the recent work. Moreover, the Coulomb correlation (3.8) only requires the self-Green function. Numerically, this corresponds to the diagonal of the inverse of the operator matrix and can be calculated efficiently with linear scaling [42] by coupling the selective inversion with the hierarchical interpolative factorization.\n3.4. Local curl-free relaxation. One advantage of using the MANP model is featured by a local relaxation algorithm that is Gauss-law satisfying, which can solve the curl-free constraint in the MANP equations efficiently and robustly. The local curl-free relaxation algorithm is derived by considering the minimization of a convex electric field energy\n(3.11) \\scrF pot[\\bfitD ] := \\int  \\Omega  | \\bfitD | 2 2\\varepsilon  d\\bfitr \nwith \\bfitD subject to the Gauss law. Define the Lagrangian \\scrL [\\bfitD , \\lambda ] := \\int  \\Omega  | \\bfitD | 2 2\\varepsilon  d\\bfitr  -  \\int  \\Omega  \\lambda (\\nabla \\cdot \\bfitD  - \\rho )d\\bfitr ,\nwhere \\lambda is the Lagrange multiplier. By the Lagrange multiplier method, the minimizer of the constraint optimization problem satisfies\n\\bfitD = - \\varepsilon \\nabla \\lambda and \\nabla \\cdot \\bfitD = \\rho .\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\nA MAXWELL--AMP\\`ERE NERNST--PLANCK MODEL 383\nThis implies that the Lagrange multiplier \\lambda is the electrostatic potential and \\nabla \\times \\bfitD /\\varepsilon = 0. Therefore, in order to achieve the curl-free condition, one can design an algorithm that can decrease the electric field energy most in each update step for \\bfitD .\nAnother perspective is based on the general solution to the Gauss law: \\bfitD /\\varepsilon =  - \\nabla \\phi +\\nabla \\times \\bfitQ , where \\bfitQ is the rotational degrees of freedom. As such,\n\\scrF pot[\\bfitD ] = \\int  \\Omega  \\varepsilon  2 \\Bigl[  (\\nabla \\phi )2 + (\\nabla \\times \\bfitQ )2 \\Bigr]  d\\bfitr .\nThus, the minimization corresponds to the elimination of the rotational degrees of freedom in \\bfitD , which is dominated by a torque [34].\nSpecifically, we consider spatial discretization in a rectangular domain \\Omega = [0,L1]\\times [0,L2] with periodic boundary conditions. The domain is covered by a uniform grid with the grid spacing \\Delta x and \\Delta y in the two coordinate directions. Denote by \\Delta \\Omega =\\Delta x\\Delta y the area of a unit cell. Let Nx and Ny be the number of grid points along each dimension. Let \\bfitD = (Dx,Dy). In particular, c \\ell  i,j stands for the numerical approximation of c\\ell on the grid point (i\\Delta x, j\\Delta y), and Di+1/2,j stands for the numerical approximation of Dx on the grid point ((i+ 1/2)\\Delta x, j\\Delta y) for i = 1, . . . ,Nx and j = 1, . . . ,Ny. Analogously, Di,j+1/2 stands for the numerical approximation of Dy on the grid point (i\\Delta x, (j + 1/2)\\Delta y).\nWith central differencing, the electric field energy in the optimization problem (3.11) is approximated with second-order accuracy by\n(3.12) \\scrF hpot = \\Delta \\Omega \n2 \\sum  i,j\n\\Biggl(  D2\ni+ 12 ,j\n\\varepsilon i+ 12 ,j +\nD2 i,j+ 12 \\varepsilon i,j+ 12\n\\Biggr)  ,\nand the Gauss law is approximated by\n(3.13) (\\nabla \\cdot )h\\bfitD i,j := Di+ 12 ,j  - Di - 12 ,j\n\\Delta x + Di,j+ 12  - Di,j - 12 \\Delta y = \\sum  \\ell  z\\ell c\\ell i,j + \\rho  f i,j .\nOur relaxation starts from the solution to the discrete Maxwell--Amp\\`ere equation. Successive local updates of the electric displacements in each cell are proposed to minimize \\scrF hpot [34]; see a schematic diagram shown in Figure 3.1. For instance, consider a grid cell which has four nodes with indices (i, j), (i + 1, j), (i, j + 1), (i+ 1, j + 1), and four respective edges. Denote by Di+1/2,j , Di+1,j+1/2, Di+1/2,j+1, and Di,j+1/2 the four electric displacement components defined on the four edges. The arrows on the edges in Figure 3.1 indicate the predefined positive directions. In the update, a flux \\eta that rotates along four edges is introduced in such a way that the discrete energy \\scrF hpot is locally minimized. Specifically, the updates of displacements are given by\n(3.14)\nDi+ 12 ,j\\leftarrow Di+ 12 ,j + \\eta  \\Delta y , Di+1,j+ 12 \\leftarrow Di+1,j+ 12 + \\eta  \\Delta x , Di+ 12 ,j+1\\leftarrow Di+ 12 ,j+1  -  \\eta  \\Delta y ,\nDi,j+ 12 \\leftarrow Di,j+ 12  -  \\eta  \\Delta x .\nIt is remarkable that the Gauss law is still rigorously maintained at all four nodes with such an update scheme, i.e., the constraint of the discrete Gauss law (3.13) is satisfied\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\n384 Z. QIAO, Z. XU, Q. YIN, AND S. ZHOU\nDi+1 2 ,j+1 \u2212\n\u03b7\n\u2206y\nDi,j+1 2 \u2212\n\u03b7\n\u2206x\nDi+1 2 ,j +\n\u03b7\n\u2206y\nDi+1,j+1 2 + \u03b7 \u2206x\n(i, j + 1)\n(i, j) (i + 1, j)\n(i + 1, j + 1)\nFig. 3.1. Update diagram of the electric displacements in a single cell.\nfor each update. The associated change in the energy after updates in displacements reads\n(3.15)\n\\delta \\scrF hpot[\\eta ] = \\eta 2\n2\n\\Biggl[  \\Delta x\n\\Delta y\n\\Biggl(  1\n\\varepsilon i+ 12 ,j +\n1\n\\varepsilon i+ 12 ,j+1\n\\Biggr)  + \\Delta y\n\\Delta x\n\\Biggl(  1\n\\varepsilon i,j+ 12 +\n1\n\\varepsilon i+1,j+ 12\n\\Biggr) \\Biggr] \n+ \\eta  \\Biggl[  \\Delta x \\Biggl(  Di+ 12 ,j\n\\varepsilon i+ 12 ,j  - \nDi+ 12 ,j+1 \\varepsilon i+ 12 ,j+1\n\\Biggr)  +\\Delta y \\Biggl(  Di+1,j+ 12 \\varepsilon i+1,j+ 12  -  Di,j+ 12 \\varepsilon i,j+ 12 \\Biggr) \\Biggr]  ,\nwhich is minimized with\n(3.16) \\eta = -  \\Delta y(\\Delta x)2\n\\biggl(  D\ni+1 2 ,j\n\\varepsilon  i+1 2 ,j  - \nD i+1\n2 ,j+1\n\\varepsilon  i+1\n2 ,j+1\n\\biggr)  +\\Delta x(\\Delta y)2 \\biggl(  D i+1,j+1 2\n\\varepsilon  i+1,j+1\n2\n -  D i,j+1 2\n\\varepsilon  i,j+1\n2 \\biggr)  (\\Delta x)2 \\biggl(  1\n\\varepsilon  i+1 2 ,j + 1\\varepsilon  i+1 2 ,j+1\n\\biggr)  + (\\Delta y)2 \\biggl(  1\n\\varepsilon  i,j+1\n2\n+ 1\\varepsilon  i+1,j+1\n2\n\\biggr) .\nThis gives an optimal flux for the displacement changes in terms of minimizing the discrete energy. Such a local update loops over all the grid points for certain steps until a stopping criterion \\varepsilon tol is met. Since analytical expressions are available for each update step, it is clear that the complexity of the algorithm is \\scrO (N), where N =Nx \\cdot Ny.\nThis local curl-free relaxation uses the intrinsic dynamics of the electric field, i.e., the propogation of a retarded and diffusive vector field. The equilibrium of the local curl-free relaxation gives the electrostatic interactions essentially [32]. The whole relaxation can be regarded as a projection of the electric displacement from the non-curl-free space to the curl-free space, while maintaining in the Gauss law satisfying surface at the same time.\nRemark 3.3.\n(1) The convergence of the local relaxation algorithm with respect to iteration steps can be proved by the fact that \\scrF hpot is nonnegative and \\delta \\scrF hpot(\\eta ) \\leq 0 when \\eta is given by (3.16). (2) Taking the derivative of the updated electric field energy with respect to flux \\eta gives the torque which drives the circulatory dynamics. It explains why\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\nA MAXWELL--AMP\\`ERE NERNST--PLANCK MODEL 385\nthe curl-free condition is satisfied when the relaxation converges. In 2D, the discrete curl of \\bfitD /\\varepsilon is approximated by\n(\\nabla \\times )h \\Bigl( \\bfitD  \\varepsilon  \\Bigr)  i+ 12 ,j+ 1 2 = 1 \\Delta x \\biggl(  Di+1,j+ 12 \\varepsilon i+1,j+ 12  -  Di,j+ 12 \\varepsilon i,j+ 12 \\biggr)  + 1 \\Delta y \\biggl(  Di+ 12 ,j \\varepsilon i+ 12 ,j  -  Di+ 12 ,j+1 \\varepsilon i+ 12 ,j+1 \\biggr)  .\nIt follows from (3.15) and (3.16) that \\delta \\scrF hpot = 0 is achieved if and only if \\eta = 0, which is in turn equivalent to (\\nabla \\times )h(\\bfitD /\\varepsilon )i+1/2,j+1/2 = 0. Therefore, the curl-free constraint is achieved as the local relaxation algorithm converges. (3) Starting from \\bfitD \\ast , the local curl-free relaxation gives rise to the updated \\bfitD n+1 \\in \\bfitD \\ast +\\BbbV , where the space \\BbbV := \\{ \\bfitv | (\\nabla \\cdot )h\\bfitv = 0\\} . (4) It is easy to extend this relaxation algorithm to nonuniform grids by considering the integration of the Gauss law. (5) In each update step, an explicit expression for \\bfitD is available. Numerical tests in section 4.2 demonstrate that with a good guess for \\Theta using an extrapolation, the local curl-free relaxation only takes a few iteration steps. Thus, the local curl-free relaxation algorithm is expected to have linear complexity.\n4. Results. In this section, we shall present the whole numerical method for the MANP model and simulation results to demonstrate the attractive features of the model.\n4.1. Numerical method. Let \\Delta t be the time step size. Denote by c\\ell ,n and \\bfitD n the approximations to c\\ell and \\bfitD , respectively, at time tn := n\\Delta t for a nonnegative integer n. An Euler discretization of the time derivative leads to a semi-implicit scheme for the Nernst--Planck equations, c\\ell ,n+1 = c\\ell ,n  - \\Delta t\\nabla \\cdot \\bfitJ \\ell ,n, with the flux \\bfitJ \\ell ,n =  - \\gamma \\ell (\\nabla c\\ell ,n+1  - z\\ell c\\ell ,n+1\\bfitD n/\\varepsilon ). Similarly, the Maxwell--Amp\\`ere equation is discretized by\n(4.1) \\bfitD \\ast =\\bfitD n +\\Delta t \\Biggl(   - \nM\\sum  \\ell =1 z\\ell \\bfitJ \\ell ,n +\\Theta n\n\\Biggr)  ,\nwhere \\bfitD \\ast is an intermediate approximation to \\bfitD n+1. Then, \\bfitD \\ast is further corrected to satisfy the curl-free constraint in (2.12). See section 3.4 for the details. Notice that the numerical scheme (4.1) for the Maxwell--Amp\\`ere equation is explicit once c\\ell ,n+1 is obtained. There are several options for \\Theta n, as long as it satisfies the divergence-free condition. In our numerical simulations, we test the performance of the scheme by comparing results with the following choices:\n\\Theta n1 = 0,(4.2)\n\\Theta n2 = \\bfitD n  - \\bfitD n - 1\n\\Delta t + M\\sum  \\ell =1 z\\ell \\bfitJ \\ell ,n - 1,(4.3)\n\\Theta n3 = 3\n2\n\\Biggl(  \\bfitD n - \\bfitD n - 1\n\\Delta t + M\\sum  \\ell =1 z\\ell \\bfitJ \\ell ,n - 1\n\\Biggr)   - 1\n2\n\\Biggl(  \\bfitD n - 1 - \\bfitD n - 2\n\\Delta t + M\\sum  \\ell =1 z\\ell \\bfitJ \\ell ,n - 2\n\\Biggr)  .(4.4)\nNotice that an appropriate choice of \\Theta n can provide a better approximation \\bfitD \\ast to \\bfitD n+1 and reduce the relaxation steps needed in the correction from \\bfitD \\ast to \\bfitD n+1.\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\n386 Z. QIAO, Z. XU, Q. YIN, AND S. ZHOU\nAlgorithm 1 Numerical method for the MANP equations. Input: Final time T , stopping criterion \\varepsilon tol for the local curl-free relaxation, initial ionic distributions c\\ell ,0, and the corresponding displacement field \\bfitD 0 that satisfies the Gauss law; 1: Solve the Nernst--Planck equations to get c\\ell ,n+1, \\ell = 1, . . . ,M ; 2: Given a divergence-free \\Theta n shown in (4.2)--(4.4), solve the Maxwell--Amp\\`ere\nequation with the scheme (4.1) to obtain an intermediate displacement field \\bfitD \\ast ;\n3: Perform the local curl-free relaxation on \\bfitD \\ast to obtain \\bfitD n+1. 4: If T \\leq tn+1, stops; Otherwise, go to step 1.\nThe effect of different choices of \\Theta n+1 on relaxation steps will be thoroughly studied in next section. It follows from (4.1) that\n\\nabla \\cdot \\bfitD \\ast  - \\nabla \\cdot \\bfitD n = \\sum  \\ell  z\\ell (c\\ell ,n+1  - c\\ell ,n).\nThus, it is straightforward to verify that \\bfitD \\ast given by (4.1) satisfies the Gauss law, i.e., \\nabla \\cdot \\bfitD \\ast = \\sum  z\\ell c\\ell ,n+1 + \\rho f , provided that \\bfitD n satisfies the Gauss law.\nCentral differencing and upwinding schemes are employed to discretize the spatial derivatives. Our numerical method equipped with the curl-free relaxation for the MANP model is summarized in the following algorithm.\n4.2. Effect of \\Theta . We study the effect of different choices of \\Theta on the local relaxation algorithm, and conduct a series of simulations to demonstrate the performance of our MANP model in the description of charge dynamics.\nIn simulations, we consider binary electrolytes in a rescaled domain \\Omega = ( - 1,1)\\times  ( - 1,1) with periodic boundary conditions. The charge dynamics is described by the MANP equations \\left\\{ \n\\partial c\\ell \n\\partial t =\\nabla \\cdot \\gamma \\ell \n\\biggl(  \\nabla c\\ell  - z \\ell c\\ell \\bfitD \n\\varepsilon \n\\biggr)  , \\ell = 1,2,\n\\partial \\bfitD \n\\partial t = 2\\sum  \\ell =1 z\\ell \\gamma \\ell  \\biggl(  \\nabla c\\ell  - z \\ell c\\ell \\bfitD  \\varepsilon  \\biggr)  +\\Theta ,\n\\nabla \\cdot \\Theta = 0,\n\\nabla \\times \\bfitD  \\varepsilon  = 0.\nWe take the parameters \\gamma \\ell = 0.01, z1 = 1, and z2 = - 1. The permanent charge in the system is given by the distribution function\n\\rho f (x, y) = e  - 100\n\\Bigl[  (x+ 12 ) 2 +(y+ 12 ) 2 \\Bigr]   - e - 100 \\Bigl[  (x+ 12 ) 2 +(y - 12 ) 2 \\Bigr] \n - e - 100 \\Bigl[  (x - 12 ) 2 +(y+ 12 ) 2 \\Bigr]  + e  - 100 \\Bigl[  (x - 12 ) 2 +(y - 12 ) 2 \\Bigr]  .\nWe consider a rescaled dielectric coefficient given by\n\\varepsilon (x, y) = \\varepsilon w  - \\varepsilon m\n2 [tanh (100d - 25) + 1] + \\varepsilon m,\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\nA MAXWELL--AMP\\`ERE NERNST--PLANCK MODEL 387\nwhere \\varepsilon w and \\varepsilon m are the dielectric constants for solvent and solute, respectively, and\nd=\n\\left\\{  \\sqrt{} \\biggl(  x - 1\n2\n\\biggr) 2 + \\biggl(  y - 1\n2 \\biggr) 2 , 0<x\\leq 1,0< y\\leq 1,\\sqrt{} \\biggl( \nx - 1 2\n\\biggr) 2 + \\biggl(  y+ 1\n2 \\biggr) 2 , 0<x\\leq 1, - 1\\leq y\\leq 0,\\sqrt{} \\biggl( \nx+ 1\n2\n\\biggr) 2 + \\biggl(  y - 1\n2 \\biggr) 2 ,  - 1\\leq x\\leq 0,0< y\\leq 1,\\sqrt{} \\biggl( \nx+ 1\n2\n\\biggr) 2 + \\biggl(  y+ 1\n2\n\\biggr) 2 ,  - 1\\leq x\\leq 0, - 1\\leq y\\leq 0.\nThe initial concentrations are given by\nc\\ell (x, y,0) = 0.1, \\ell = 1,2,\nand the initial electric displacement is given by\\bfitD (x, y,0) = - \\varepsilon \\nabla \\phi , where \\phi is obtained by solving the Poisson equation\n - \\nabla \\cdot (\\varepsilon \\nabla \\phi ) = 2\\sum \n\\ell =1\nz\\ell c\\ell (x, y,0) + \\rho f (x, y).\nTo understand the effect of different choices of \\Theta on the convergence of our local curl-free relaxation algorithm, we study the number of relaxation steps, denoted by Rs, that are needed to meet the stopping criterion \\varepsilon tol in each time step. Numerical tests are performed with different choices of \\Theta , i.e., \\Theta n1 , \\Theta  n 2 , and \\Theta  n 3 in (4.2)--(4.4).\nFrom Figure 4.1, one can see that, with a stopping criterion \\varepsilon tol = 1E - 7, the number of relaxation steps Rs behaves significantly differently for different \\Theta . For the trivial choice \\Theta n1 , Rs grows rapidly in the first stage and levels off and oscillates in the late stage about 10. For \\Theta n3 , it requires less steps, and Rs grows to the same plateau value as that for \\Theta n1 in the late stage. It is of interest to find that Rs for \\Theta n2 only takes less than 5 steps in first a few steps and quickly decreases to 1 step. This can be explained by the fact that the first-order Euler discretization is used in the numerical method and \\Theta n2 is a first-order extrapolation of \\Theta . Overall, the study on the number of relaxation steps Rs reveals that, a better estimate of the \\Theta leads to \\bfitD \\ast that is closer to curl free, lowering the relaxation steps in the local relaxation algorithm. With \\Theta n2 , the relaxation steps can be as low as 1, indicating that the local relaxation algorithm is of linear computational complexity. It is expected that the local relaxation algorithm will be more efficient than the standard Poisson solvers for variable coefficients.\n4.3. Charge dynamics. In this section, we perform a series of numerical experiments to study the effects of inhomogeneous dielectrics, ionic sizes, and correlations on charge dynamics. We use a uniform mesh with Nx = Ny = 200 and a time step \\Delta t= 0.1\\Delta x. To understand various effects, we conduct systematic numerical tests on the following cases:\n\\bullet Case 1: \\varepsilon m = \\varepsilon w = 2E - 4; \\bullet Case 2: \\varepsilon m = \\varepsilon w = 2E - 4 with steric effects; \\bullet Case 3: \\varepsilon m = 2E - 4 and \\varepsilon w = 1.56E - 2 with Coulomb correlations.\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\n388 Z. QIAO, Z. XU, Q. YIN, AND S. ZHOU\n0 0.5 1 1.5\n0\n5\n10\n15\n20\n25\n30\n35\nFig. 4.1. The number of relaxation steps Rs against time in the local curl-free relaxation algorithm for different choices of \\Theta with a stopping criterion \\varepsilon tol = 1E - 7.\n\\bullet Case 4: \\varepsilon m = 2E - 4 and \\varepsilon w = 1.56E - 2 with both steric effects and Coulomb correlations.\nSolving the generalized Debye--H\\\"uckel equation (3.9) numerically is rather challenging in high dimensions. We here ignore the second term in (3.8) for simplicity when considering Coulomb correlations.\nIn Case 1, we consider a spatially uniform dielectric coefficient with \\varepsilon m = \\varepsilon w = 2E - 4. Figure 4.2 shows the snapshots of the electric displacement | \\bfitD | , potential \\phi , and concentrations at time T = 0.05, T = 0.1, and T = 2. One can see that the concentration of ions accumulates at the permanent charges of opposite signs due to the electrostatic attractions. Meanwhile, the magnitude of the electric displacement first develops ring peaks close to the four permanent charges and later gets screened quickly by the mobile ions as time evolves. Such results on the evolution of \\phi , c1, and c2 agree well with previously reported results that are calculated with the PNP equations [26]. To further understand ion dynamics, Figure 4.4(a) displays the evolution snapshots of cation concentrations at a cross section with y =  - 0.5. Clearly, the cations are attracted by electrostatic interactions to the negative fixed charges. Also, it is interesting to find that the distribution of cations is radially nonmonotonic in equilibrium, due to the charge conservation in the system.\nIn Case 2, we still study a uniform dielectric coefficient but with additional ionic steric effects. The results are presented in Figures 4.3(b) and 4.4(b). Comparing with the results of Case 1, one finds that the counterion concentration peaks at fixed charges lower due to the steric repulsion between ions. With less accumulated ions, the electric displacement is less screened and therefore its magnitude is much stronger than Case 1.\nTo further assess the Coulomb correlation effects, we perform numerical simulations with variable dielectric coefficients and Coulomb correlations, as shown in Case 3 and 4. In contrast to previous cases, the dielectric coefficient away from the four permanent charges is 78 times larger, enhancing the local screening effects, to mimic the big dielectric variation across sharp transition interfaces. The results are displayed in Figures 4.3(c)--(d) and 4.4(c)--(d). A salient difference between the plots in upper and lower panels is the emergence of the ring structures in both electric displacement and concentration distributions across the sharp dielectric\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\nA MAXWELL--AMP\\`ERE NERNST--PLANCK MODEL 389\nFig. 4.2. The snapshots of | \\bfitD | , \\phi , c1, and c2 at time T = 0.05, T = 0.1, and T = 2 for Case 1.\nFig. 4.3. The snapshots of | \\bfitD | and c1 at time T = 0.05, T = 0.1, and T = 2. Panels (a)--(d) correspond to Case 1--Case 4, respectively. The scales of colorbars are the same as Figure 4.2.\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\n390 Z. QIAO, Z. XU, Q. YIN, AND S. ZHOU\n-1 -0.75 -0.5 -0.25 0 0.25 0.5 0.75 1\n0\n0.2\n0.4\n0.6\n0.8\n1\n-1 -0.75 -0.5 -0.25 0 0.25 0.5 0.75 1\n0\n0.2\n0.4\n0.6\n0.8\n1\n-1 -0.75 -0.5 -0.25 0 0.25 0.5 0.75 1\n0\n0.2\n0.4\n0.6\n0.8\n1\n-1 -0.75 -0.5 -0.25 0 0.25 0.5 0.75 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nFig. 4.4. The snapshots of cation concentrations for Case 1--Case 4 at a cross section with y= - 0.5.\nvariations. Further detailed comparisons based on Figure 4.4 reveal that the Coulomb correlation drives ions to regions with higher dielectric coefficients, forming a marked depletion ring region. The cation concentration has an abrupt transition at the region where the dielectric coefficient has a sharp variation. The concentration snapshots at T = 0.01 and T = 0.02 also demonstrate that the Coulomb correlation comes into effect earlier than electrostatic interactions in ion dynamics. Moreover, it is observed from the snapshots that the system relaxes to the steady state faster with the inclusion of Coulomb correlations. Comparing the plots in left and right panels in Figure 4.4, one again can observe that the ionic steric effect lowers concentration peaks by ionic steric repulsions. Overall, the exhibited rich ion dynamics results from the competition among electrostatic interactions, steric effects, and Coulomb correlations. The magnitude of the electric displacement is relatively stronger with dielectric inhomogeneity. This can be ascribed to the less screening arising from the partly expelled counterions by the additional steric effects and Coulomb correlations, especially in the regions where counterions are almost depleted. This accounts for the eminent ring structures both for the electric displacement and concentration distributions.\nTo further understand the impact of various effects on ion dynamics, we investigate the evolution of discrete energies \\scrF h for Case 1 to Case 4. Figure 4.5 shows the discrete energies which are normalized by the difference between the initial and steady-state energies. From the curves, one can see that the free energy decreases monotonically, as proved in Theorem 3.1. Also, it is easy to find that the steric effects have minor impact on the evolution of the free energy. Nonetheless, the Coulomb correlations and dielectric inhomogeneity have significant impact on ion dynamics. Being\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\nA MAXWELL--AMP\\`ERE NERNST--PLANCK MODEL 391\n0 0.1 0.2 0.3 0.4 0.5\n0\n0.2\n0.4\n0.6\n0.8\n1\nCase 1\nCase 2\nCase 3\nCase 4\nFig. 4.5. The evolution of normalized discrete energies \\scrF h for Case 1 to Case 4.\nTable 4.1 The minimum concentration for both cations and anions on the computational grid for the whole time.\nCase 1 Case 2 Case 3 Case 4\n1.8139E - 3 9.5848E - 6 2.8764E - 18 1.5079E - 24\nconsistent with Figure 4.4, the system reaches the steady state much faster with additional Coulomb correlations. In addition, we also pay attention to the positivity of the numerical solutions to ionic concentrations. Table 4.1 lists the minimum ionic concentration values on the computational grid for the whole time. One can observe that the numerical concentrations remain positive all the time, and the cases with Coulomb correlations and dielectric inhomogeneity have extremely small minimum values due to strong convection caused by the Coulomb correlations and dielectric inhomogeneity.\n5. Conclusions. In this work, we have proposed an MANP framework, based on the ionic concentrations and electric displacement, for the description of charge dynamics. It has been shown that the MANP model with a curl-free condition on the electric displacement is equivalent to the PNP theory. The MANP formulation is proved to be energy dissipative with respect to a convex energy functional. According to the energy dissipation law, the steady state of the MANP formulation has been shown to be the charge conserving PB theory [20, 21, 43]. Thus, the MANP formulation offers an energy stable approach to investigate the PB-type theories analytically and numerically. To efficiently achieve the curl-free condition, the newly derived MANP formulation has been equipped with a companion local curl-free relaxation algorithm. It has been shown that the algorithm naturally preserves the discrete Gauss law, has robust convergence, and is of linear computational complexity. Our MANP formulation also provides a versatile modeling framework to derive models for charge dynamics. Modified MANP models beyond the mean-field theory have been presented to describe cases in which ionic steric effects and Coulomb correlations are not negligible. Results on the ion dynamics with steric effects, Coulomb correlations, and dielectric inhomogeneity have been presented to demonstrate the performance of the proposed MANP model.\nIt is expected that, with further refinement on the description of ionic interaction details, the proposed MANP model with the local curl-free relaxation algorithm\nCopyright \u00a9 by SIAM. Unauthorized reproduction of this article is prohibited.\nD ow\nnl oa\nde d\n09 /1\n5/ 23\nto 1\n58 .1\n32 .1\n61 .1\n80 .\nR ed\nis tr\nib ut\nio n\nsu bj\nec t t\no SI\nA M\nli ce\nns e\nor c\nop yr\nig ht\n; s ee\nh ttp\ns: //e\npu bs\n.s ia\nm .o\nrg /te\nrm s-\npr iv\nac y\n392 Z. QIAO, Z. XU, Q. YIN, AND S. ZHOU\ncan be extended to the efficient coarse-grained simulations of charge dynamics with fluctuating permanent charges [8]. Also, the MANP model equipped with the local curl-free relaxation algorithm exhibits promising potential in practical applications, especially for the cases involving the variable-coefficient Poisson equation. For instance, a Vlasov--Amp\\`ere model, instead of a Vlasov--Poisson model, has been applied to particle-in-cell simulations of plasma [7]. However, only one-dimensional simulations have been performed in the work. The proposed MANP model with the local curl-free relaxation algorithm is able to handle high-dimensional cases.\nAcknowledgments. The authors would like to thank the anonymous reviewers for their constructive comments and suggestions, which have helped them greatly improve this work."
        }
    ],
    "title": "A Maxwell\u2013Ampe\u0300re Nernst\u2013Planck Framework for Modeling Charge Dynamics | SIAM Journal on Applied Mathematics | Vol. 83, No. 2 | Society for Industrial and Applied Mathematics",
    "year": 2023
}