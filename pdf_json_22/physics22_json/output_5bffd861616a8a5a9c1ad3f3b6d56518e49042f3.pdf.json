{
    "abstractText": "Starting from recent advances in the first-principles modeling of polarons, variational polaron equations in the strong-coupling adiabatic approximation are formulated in Bloch space. In this framework, polaron formation energy as well as individual electron, phonon and electron-phonon contributions are obtained. We suggest an efficient gradient-based optimization algorithm and apply these equations to the generalized Fr\u00f6hlich model with anisotropic non-degenerate electronic bands, both in twoand three-dimensional cases. The effect of the divergence of Fr\u00f6hlich electronphonon matrix elements at \u0393-point is treated analytically, improving the convergence with respect to the sampling in reciprocal space. The whole methodology is validated by obtaining the known asymptotic solution of the standard Fr\u00f6hlich model in isotropic scenario and also by comparing our results with the Gaussian ansatz approach, showing the difference between the numerically exact and Gaussian trial wavefunctions. Additionally, decomposition of the energy into individual terms allows one to recover the Pekar\u2019s 1:2:3:4 theorem, which is shown to be valid even in the anisotropic case. We expect that the improvements in the formalism and numerical implementation will be applicable beyond the large polaron hypothesis inherent to Fr\u00f6hlich model.",
    "authors": [
        {
            "affiliations": [],
            "name": "Vasilii Vasilchenko"
        },
        {
            "affiliations": [],
            "name": "Andriy Zhugayevych"
        },
        {
            "affiliations": [],
            "name": "Xavier Gonze"
        }
    ],
    "id": "SP:c9d2cee27707dab47be4a2425dcd349a1912ac43",
    "references": [],
    "sections": [
        {
            "text": "Variational Polaron Equations Applied to the Anisotropic Fro\u0308hlich Model\nVasilii Vasilchenko,1 Andriy Zhugayevych,1 and Xavier Gonze1, 2\n1Skolkovo Institute of Science and Technology, Skolkovo Innovation Center, Nobel St. 3, Moscow, 143026, Russia. 2European Theoretical Spectroscopy Facility, Institute of Condensed Matter and Nanosciences,\nUniversite\u0301 catholique de Louvain, Chemin des e\u0301toiles 8, bte L07.03.01, B-1348 Louvain-la-Neuve, Belgium\nStarting from recent advances in the first-principles modeling of polarons, variational polaron equations in the strong-coupling adiabatic approximation are formulated in Bloch space. In this framework, polaron formation energy as well as individual electron, phonon and electron-phonon contributions are obtained. We suggest an efficient gradient-based optimization algorithm and apply these equations to the generalized Fro\u0308hlich model with anisotropic non-degenerate electronic bands, both in two- and three-dimensional cases. The effect of the divergence of Fro\u0308hlich electronphonon matrix elements at \u0393-point is treated analytically, improving the convergence with respect to the sampling in reciprocal space. The whole methodology is validated by obtaining the known asymptotic solution of the standard Fro\u0308hlich model in isotropic scenario and also by comparing our results with the Gaussian ansatz approach, showing the difference between the numerically exact and Gaussian trial wavefunctions. Additionally, decomposition of the energy into individual terms allows one to recover the Pekar\u2019s 1:2:3:4 theorem, which is shown to be valid even in the anisotropic case. We expect that the improvements in the formalism and numerical implementation will be applicable beyond the large polaron hypothesis inherent to Fro\u0308hlich model.\nPACS numbers: 71.38.-k, 78.20.Bh\nI. INTRODUCTION\nA polaron is a quasiparticle formed when an electron or a hole couple to the lattice vibrations of a system. Polaron formation leads to effective mass renormalization, lattice deformation and potential self-trapping of the carrier. This process occurs in various classes of materials: organic crystals1, perovskites2,3, oxides4, metal-ion storage materials5, 2D semiconductors6,7. Since many of these systems find their applications in electronics, and polarons in turn affect their optoelectronic properties, accurate prediction of polaronic effects is important. Indeed, many recent state-of-the-art experimental and theoretical studies are devoted to the polaron physics8 and encourage further investigations in this field.\nA polaron has several characteristics, like its formation energy, effective mass, mobility and optical response. The first approach for the determination of polaron properties was suggested by Landau and Pekar9. They made the hypothesis of large spatial extension of the quasiparticle compared to the lattice periodicity (large polaron), hence neglecting the atomic details of the crystal. They also treated the lattice deformation using classical mechanics, the deformation adjusting instantaneously and self-consistently to the charge carrier density. We will refer to this second hypothesis as the strong-coupling adiabatic approximation. In this approach a charge carrier can be trapped in the deformation field it induces, a phenomenon called \u201cself-trapping\u201d.\nTwo other noticeable approaches were introduced later by Fro\u0308hlich10 and Holstein11,12. The Fro\u0308hlich model takes into account coupling of a single electron to a dispersionless longitudinal optical (LO) phonon mode and also washes out the atomic details with a continuum ap-\nproximation, describing large polarons13,14, like Landau and Pekar approach, albeit with a quantum treatment of such phonon modes. The Fro\u0308hlich model has been the subject of sustained attention for several decades. One can treat rather easily two regimes, depending on the strength of the electron-phonon coupling: the abovementioned strong-coupling limit, yielding a self-trapped state, and the weak-coupling limit, that can be treated using perturbation theory15. Fro\u0308hlich polarons in the weak-coupling scenario can also be described with variational formalism based on canonical transformation as in Lee-Low-Pines theory16. The treatment of the intermediate regime is more challenging, and can be done approximately using e.g. Feynman\u2019s path integral approach17, or by diagrammatic Monte Carlo techniques18. The Holstein approach is a lattice model that considers local couplings to intramolecular vibrations describing small polarons and is commonly used to study polaronic properties of organic semiconductors19,20.\nThese models however are not able to describe the full complexity of real materials, with arbitrary degenerate electronic and phonon dispersion and complex electron-phonon interactions. Such features in general can only be taken into account by first-principles calculations, like Density Functional Theory (DFT). DFT-based calculations of polaron properties have already shown their predictive power for describing polarons either in weak-coupling21\u201332 or strong-coupling regimes33\u201339. In the weak-coupling regime, the polaron formation energy is often termed the zero-point renormalization of the electronic band edge energy. The electronic structure, i.e. Kohn-Sham (KS) states and eigenenergies in the DFT case, is affected by the atomic displacements, either perturbatively, in the weak-coupling case, ar X iv :2\n20 6.\n00 89\n8v 1\n[ co\nnd -m\nat .m\ntr l-\nsc i]\n2 J\nun 2\n02 2\n2 or self-consistently, in the strong-coupling case. However, first-principles calculations in the strong-coupling regime are rather limited in the number of atoms that can be treated. Besides, intermediate coupling strength region is more challenging to address with first-principles approaches, while a large number of interesting materials might resort to such regime.\nA step towards unified modeling of polarons in Bloch space, fully based on first principles, has recently been made by Sio, Verdi, Ponce\u0301 and Giustino (SVPG)33,40. Within some well-justified approximations, they derive from first principles a model Hamiltonian, in real space, then transform it into the basis of KS states and phonon modes. The SVPG approach is more general than both Fro\u0308hlich and Holstein ones in the sense that it is applicable to both small and large polarons. It includes electronic, phonon and electron-phonon terms, albeit for a single phonon-dressed charge carrier, like in these models. After having reduced the many-electron problem to a one-electron problem, Sio and coworkers solve this Hamiltonian in the strong-coupling adiabatic approximation. Another formalism applicable to first-principles Hamiltonians is based on canonical transformation allowing for efficient consideration of nonadiabatic effects41\u201343. Both aforementioned approaches can provide a foundation for further developments in the field of polaron physics.\nIn the present work, we reexamine the SVPG formalism, provide several improvements, and apply it to the generalized Fro\u0308hlich model, to compare with known reference data. The generalized Fro\u0308hlich model introduced by Miglio et al. in Ref. 31 and later examined by Guster et al. in Ref. 44 extends the original Fro\u0308hlich model by taking into account degeneracy and anisotropy of electronic bands and their coupling to several LO phonon branches. It can be considered in both weak and strong coupling limits, nevertheless retaining the large polaron hypothesis (ignoring atomic details). Such generalization captures the essential effects of electron-phonon interaction in oxides and II-VI materials as shown by Miglio et al. in Ref. 31. Guster and coworkers further investigated this model using a Gaussian ansatz approach for a set of cubic materials, determining effective masses and localization lengths of polarons in the weak-coupling and strong-coupling limits respectively. However, the trial Gaussian wavefunction used in the strong-coupling limit may not be sufficient for a polaron wavefunction approximation when electronic bands are highly anisotropic, and in this case self-consistent methods may yield more accurate results.\nThe present work utilizes the aforementioned SVPG theoretical framework33,40. By reformulating their approach we first derive general variational equations for polaronic energy, in the basis of KS states and vibrational eigenmodes, and suggest efficient minimization algorithms. Then we apply our approach to the generalized 2D and 3D Fro\u0308hlich model in the adiabatic strong-coupling limit considering only the anisotropic non-degenerate electronic bands as extension to the stan-\ndard Fro\u0308hlich model. We also provide special treatment for the Fro\u0308hlich electron-phonon matrix elements at \u0393point similar to Miglio et al., Ref. 31, as in common representation they diverge at band edges. The results are compared with the known asymptotic solution of the classic (isotropic) Fro\u0308hlich model in the strong-coupling limit as well as with the adiabatic Gaussian ansatz approach suggested in Ref. 44. In particular, we find that the Gaussian ansatz delivers an accurate polaron formation energy for the whole range of anisotropy parameter, be it in 2D or 3D. In passing, we perform the decomposition of the energy of the Fro\u0308hlich model in the strong-coupling limit into individual terms and recover the Pekar\u2019s 1:2:3:4 theorem, which we show to be valid even in the anisotropic case.\nThe paper is structured as follows. In the next section, we give some background material and also provide notations for the reminder of the paper. Explicitly, we recall the SVPG approach (with an additional discussion of the choice of phase), and give an account of the standard (isotropic) Fro\u0308hlich model with several well-established results. Then, in Sec. III, we present our methodological advances, namely (i) a generalization of SVPG approach which yields variational polaron equations in Bloch space, and is free of the phase convention on which SVPG relied, (ii) the formulation of the anisotropic Fro\u0308hlich model with these variational polaron equations, (iii) a treatment of the infrared divergence of the electron-phonon coupling, and (iv) the formulation of a preconditioned conjugate gradient algorithm to address the variational polaron equations in Bloch space. In Sec. IV, we deal with the 2D- and 3D-Fro\u0308hlich model, isotropic and anisotropic using the above-mentioned algorithm. We analyze numerical aspects of this treatment as well as the physical characteristics of the polaron. Three appendices focus on the choice of phase for electron-phonon equations, on Pekar\u2019s 1:2:3:4 theorem, and on the scaling of the minimization algorithm."
        },
        {
            "heading": "II. BACKGROUND",
            "text": ""
        },
        {
            "heading": "A. First-principles modeling of a polaron",
            "text": "The SVPG approach33,40 starts from the DFT total energy of a semiconductor or an insulator with the fully occupied valence bands and empty conduction bands. Upon addition or removal of a single electron from a system, the charge change is in one well-defined spin channel, the system is thus spin-polarized, but SVPG assumes that the change in the overall electronic density is negligible. The ground state total energy is expanded to the second order in displacements as\nE[{\u03c8nk}, {\u03c4\u03bap}] = E[{\u03c80nk}, {\u03c4 0\u03bap}]\n+ 1\n2 \u2211 \u03ba\u03b1p \u03ba\u2032\u03b1\u2032p\u2032 C0\u03ba\u03b1p,\u03ba\u2032\u03b1\u2032p\u2032\u2206\u03c4\u03ba\u03b1p\u2206\u03c4\u03ba\u2032\u03b1\u2032p\u2032 +O(\u2206\u03c43), (1)\n3 where \u03c8nk are the KS wavefunctions of the occupied states, and general ionic coordinate of an atom \u03ba in a p-th supercell along the \u03b1-direction \u03c4\u03ba\u03b1p = \u03c4 0 \u03ba\u03b1p + \u2206\u03c4\u03ba\u03b1p is written as displacement \u2206\u03c4\u03ba\u03b1p from the equilibrium atomic position \u03c40\u03ba\u03b1p, and C 0 \u03ba\u03b1p,\u03ba\u2032\u03b1\u2032p\u2032 is the matrix of interatomic force constants29,45. The wavefunctions at distorted geometries \u03c8nk are self-consistently optimized to minimize the total energy, so they are functions of \u03c4\u03bap, although this dependence is not mentioned explicitly in Eq. 1. The energy is defined for a Born-von Karman (BvK) supercell containing Np unit cells. The derivation of the formalism for electron and hole polarons is symmetrical and we will follow the authors\u2019 approach describing further only the electron polaron case.\nEq. (1) is then combined with the expression for the DFT total energy to obtain the DFT functional of a polaron with the associated wavefunction \u03c8, for which the change of electronic density is \u03c8\u2217\u03c8 = \u2206\u03c1, which is negligible by the author\u2019s assumption (\u2206\u03c1 \u03c1):\nEp[\u03c8, {\u2206\u03c4\u03ba\u03b1p}] = E[{\u03c80nk}, {\u03c4 0\u03bap}]\n+ 1\n2 \u2211 \u03ba\u03b1p \u03ba\u2032\u03b1\u2032p\u2032 C0\u03ba\u03b1p,\u03ba\u2032\u03b1\u2032p\u2032\u2206\u03c4\u03ba\u03b1p\u2206\u03c4\u03ba\u2032\u03b1\u2032p\u2032\n+ \u222b dr\u03c8\u2217(r)H\u0302KS[\u03c1, {\u03c4\u03bap}](r)\u03c8(r). (2)\nThe third term describes electron and electron-phonon parts of the energy and contains the KS Hamiltonian of the system without addition of an electron, expanded up to the first order in \u2206\u03c4\u03ba\u03b1p:\nH\u0302KS[\u03c1, {\u03c4\u03bap}] = H\u0302KS[\u03c10, {\u03c4 0\u03bap}]\n+ \u2211 \u03ba\u03b1p \u2202V 0KS \u2202\u03c4\u03ba\u03b1p \u2206\u03c4\u03ba\u03b1p, (3)\nwhere V 0KS denotes the KS self-consistent potential at equilibrium.\nThe formation energy of the polaron is then obtained from the minimization of Eq. (2) as\n\u2206Ep = minEp[\u03c8, {\u2206\u03c4\u03ba\u03b1p}] \u2212minEp[\u03c8, {\u2206\u03c4\u03ba\u03b1p = 0}].\n(4)\nThe SVPG minimization formalism in real space is not presented here and can be found in the original paper. This yields self-consistent equations for the electron wavefunction and the atomic displacements, with a Lagrange multiplier associated to the norm conservation of the electronic wavefunction. Then, these equations are transformed to the basis of the Bloch electronic wavefunctions (KS basis in the DFT case) and phonon normal modes.\nThe polaronic wavefunction in the basis of the Bloch (KS) electronic wavefunctions reads as\n\u03c8(r) = 1\u221a Np \u2211 nk Ank\u03c8 0 nk(r) (5)\nand must be normalized\u222b dr|\u03c8(r)|2 = 1, (6)\nso the electronic coefficients Ank satisfy the following condition\n1\nNp \u2211 nk |Ank|2 = 1. (7)\nFor an electron polaron, only unoccupied wavefunctions are used in Eq. (5), while for a hole polaron, only occupied states are used.\nAtomic displacements in turn are expressed in terms of the phonon coefficients Bq\u03bd that represent the contribution of the normal modes to the displacements:\n\u2206\u03c4\u03ba\u03b1p = \u2212 2\nNp \u2211 q\u03bd B\u2217q\u03bd ( 1 2M\u03ba\u03c9q\u03bd )1/2 e\u03ba\u03b1,\u03bd(q)e iq\u00b7Rp ,\n(8) where M\u03ba denotes the mass of the \u03ba atom, e\u03ba\u03b1,\u03bd(q) is the orthonormal eigenmode of the corresponding phonon branch and Rp is a vector of the unit cell p in real space. Np is the number of primitive cells in a BvK supercell that hosts a polaron. In Bloch space formulation this supercell is defined by the sampling of the Brillouin zone (BZ), namely, a uniform \u0393-centred k-point grid, with N being the linear size of the grid. In this sense for example a 10\u00d710\u00d710 k-point grid in reciprocal space corresponds to an equivalent 10\u00d7 10\u00d7 10 supercell in real space.\nElectronic Ank and phonon Bq\u03bd parts of the polaron formation are coupled through the electron-phonon matrix elements29 that represent the probability of scattering of an electron from the state \u03c80nk into the state \u03c8 0 mk+q through a phonon of the branch \u03bd with momentum q:\ngmn\u03bd(k,q) = \u2211 \u03ba\u03b1p ( 1 2M\u03ba\u03c9q\u03bd )1/2 e\u03ba\u03b1,\u03bd(q)e iq\u00b7Rp\n\u00d7 \u222b dr\u03c80\u2217mk+q(r)\n\u2202V 0KS \u2202\u03c4\u03ba\u03b1p \u03c80nk(r).\n(9)\nAt this point it is worth mentioning SVPG relies on the time-reversal symmetry of the electron-phonon matrix elements for the electron-phonon Hamiltonian to be hermitian:\ngmn\u03bd(\u2212k,\u2212q) = g\u2217mn\u03bd(k,q). (10)\nThis relation comes from the Born and Huang convention, Eq. (24.18) of Ref. 46, for the symmetry of eigenmodes:\ne\u03ba\u03b1,\u03bd(\u2212q) = e\u2217\u03ba\u03b1,\u03bd(q). (11)\nAlternatively, one can use Leibfried (p. 104 of Ref. 47) convention:\ne\u03ba\u03b1,\u03bd(\u2212q) = \u2212e\u2217\u03ba\u03b1,\u03bd(q). (12)\n4 The choice of convention affects the form of some relations in Section II B, see Ref. 48. In later sections dealing with the Fro\u0308hlich model, we will use Born and Huang convention. Nonetheless, gmn\u03bd(k,q) obtained from firstprinciples calculation have gauge arbitrariness due to the arbitrary phase factor of KS wavefunctions and phonon eigenmodes that enter Eq. (9), so none of the conventions remain valid, generally speaking. While SVPG suggests a computational framework to get a unique gauge for all these quantities and work with Born and Huang convention, in Section III A we use an alternative approach to explicitly make the Hamiltonian hermitian. Additionally, general discussion on how arbitrary phase factor of e\u03ba\u03b1,\u03bd affects electron-phonon equations is provided in Appendix A.\nFrom Eqs. (4)-(9) the following self-consistent eigenvalue problem in Bloch space is obtained:\n2\nNp \u2211 qm\u03bd Bq\u03bdg \u2217 mn\u03bd(k,q)Amk+q = (\u03b5nk \u2212 \u03b5)Ank, (13)\nBq\u03bd = 1\nNp \u2211 mnk A\u2217mk+q gmn\u03bd(k,q) \u03c9q\u03bd Ank. (14)\nParameters that enter these equations are eigenergies \u03b5nk of the relevant KS states, phonon frequencies \u03c9q\u03bd and electron-phonon matrix elements gmn\u03bd(k,q). All these quantities can be obtained from the first-principles calculations29 and their initialization allows one to start a self-consistent iterative procedure to solve Eqs. (13) and (14) for electron and phonon parts of the polaron wavefunction A and B (here we use italicized bold symbols to denote a set of coefficients, i.e. A \u2261 {Ank} ), and polaron eigenvalue \u03b5.\nResulting polaron eigenvalue \u03b5 can be interpreted as energy of the localized state in the bandgap once the polaron is formed, with \u03b5CBM being the conduction band minimum. Electron polaron formation energy in terms of A, B is given as\n\u2206Ep(A,B) = 1\nNp \u2211 nk |Ank|2(\u03b5nk \u2212 \u03b5CBM)\n\u2212 1 Np \u2211 q\u03bd |Bq\u03bd |2\u03c9q\u03bd . (15)\nThis equation is not variational and relies on iterative solution of Eqs. (13) and (14) with convergence criteria being the absolute difference between \u2206Ep at consequent steps becoming lower than a certain threshold.\nIn this paper we will derive a variational expression for \u2206Ep(A,B), allowing for an employment of various iterative minimization algorithms49\u201352, more efficient than the one suggested in the original paper."
        },
        {
            "heading": "B. Fro\u0308hlich model",
            "text": "The Fro\u0308hlich model, either standard or generalized, starts from the following Hamiltonian:\nH\u0302Fr = H\u0302Fre + H\u0302 Fr ph + H\u0302 Fr el-ph, (16)\nwhich, similar to Eq. (2), has electron, phonon and electron-phonon terms that contribute to the total energy of a system.\nThe original model suggested by Fro\u0308hlich implies the following approximations: (i) there is one isotropic electronic band with effective mass m\u2217, (ii) coupling is considered only to one dispersionless LO phonon mode with frequency \u03c9LO, (iii) the character of a crystal is ignored and one deals with continuum limit. In this simplified scenario the terms of Eq. (16) become\nH\u0302Fre = \u2211 k k2 2m\u2217 c\u0302\u2020kc\u0302k, (17) H\u0302Frph = \u2211 q \u03c9LOa\u0302 \u2020 qa\u0302q, (18)\nH\u0302Frel-ph = \u2211 kq gFr(q)c\u0302\u2020k+qc\u0302k(a\u0302q + a\u0302 \u2020 \u2212q), (19)\nwhere c\u0302k/c\u0302 \u2020 k and a\u0302q/a\u0302 \u2020 q are the electron and phonon creation/annihilation operators respectively. Electronphonon matrix elements are given as\ngFr3D(q) = 1\n|q| ( 2\u03c0\u03c9LO Np\u21260 \u2217\u22121 )1/2\n(20)\nin the three-dimensional case, and as\ngFr2D(q) = 1\n|q|1/2 ( \u03c0\u03c9LO Np\u21260 \u2217\u22121 )1/2\n(21)\nin the two-dimensional case.53 This definition of the 2D Fro\u0308hlich coupling has been the basis of several investigations, including e.g. a diagrammatic Monte Carlo reference study54. However, it corresponds to a idealized strictly 2D system. By contrast, the study of realistic systems with 2D characteristics embedded in 3D space, like free-standing monolayers or slabs, or even such systems deposited on surfaces, yield a different, much more complex, functional behaviour.55\u201359. As our purpose is to compare our approach to reference data, we stick to the idealized 2D functional form Eq. 21.\nIn Eqs. (20) and (21), we have followed the Born and Huang choice of phase, as explained in Appendix A, and in Ref. 48. Here \u2217 is the effective permittivity due only to the ionic movements, defined from the difference of inverse high-frequency and static permittivities \u221e and 0:\n( \u2217)\u22121 = ( \u221e)\u22121 \u2212 ( 0)\u22121. (22)\n5 Volume (area) of the 3D (2D) BvK supercell are denoted by Np\u21260, where \u21260 is the volume (area) of the corresponding primitive cell.\nIt is convenient to introduce the dimensionless parameter, the so-called Fro\u0308hlich coupling constant,\n\u03b1 =\n( m\u2217\n2\u03c9LO\n)1/2 ( \u2217)\u22121. (23)\nDepending on the value of \u03b1 the model has asymptotic solution. In the strong-coupling regime, one takes the limit \u03b1\u2192\u221e, and the polaron formation energy in 3D60 and 2D61 cases is expanded as\n\u2206E3Dp \u2248 \u2212\u03c9LO(0.1085\u03b12 + 2.836 +O(1/\u03b12)), (24)\n\u2206E2Dp \u2248 \u2212\u03c9LO(0.4047\u03b12 +O(\u03b10)). (25)\nThe strong-coupling case is also captured by the variational approach9, in which both electronic and phonon parts (displacements) of the polaron wavefunction are frozen self-consistently, and one works in the adiabatic approximation.\nAlternatively, Fro\u0308hlich model can be solved asymptotically in the weak-coupling regime (\u03b1 \u2192 0) with polaron formation energy showing leading linear dependence on \u03b162,63. Qualitative breakdown between the weak and strong coupling regimes occurs at \u03b1 \u2248 6, and treatment of such intermediate coupling requires more sophisticated approaches17,18.\nAlso, it has been shown64 that the 1:4 relation of the so-called 1:2:3:4 theorem of Pekar is valid for all ranges of \u03b1. In adiabatic regime this theorem establishes the ratio between the effective kinetic energy of the electron trapped inside a polaron Eel, the lattice distortion energy Eph, the energy of a localized polaronic state \u03b5 and the electron-phonon interaction energy Eel-ph:\nEel : Eph : \u2212\u03b5 : \u2212Eel-ph = 1 : 2 : 3 : 4. (26)\nFurther discussion on this relation is also provided in Appendix B.\nIn addition, some of the aforementioned restrictions can be bypassed by considering the generalized Fro\u0308hlich model31,44. It allows to take into account degeneracy and anisotropy of the electronic bands and their coupling to several possible LO phonon modes instead of only one. The electron-phonon coupling then becomes more complex, but reduces to Eq. (20) and (21) not only in the limit of standard approximations, but also when electronic bands are parabolic and non-degenerate."
        },
        {
            "heading": "III. THEORY AND IMPLEMENTATION",
            "text": "A. Variational polaron equations in Bloch space\nIn order to formulate a variational expression for \u2206Ep in Bloch space we start from Eq. (2), which is variational in real space under the normalization constraint Eq. (6).\nIt is convenient to split the polaron energy into four parts, namely constant ground-state term and electron, phonon and electron-phonon terms:\nEp = E 0 + Eel + Eph + Eel-ph, (27)\nwhere\nEel = \u222b dr\u03c8\u2217(r)H\u03020KS(r)\u03c8(r), (28)\nEph = 1\n2 \u2211 \u03ba\u03b1p \u03ba\u2032\u03b1\u2032p\u2032 C0\u03ba\u03b1p,\u03ba\u2032\u03b1\u2032p\u2032\u2206\u03c4\u03ba\u03b1p\u2206\u03c4\u03ba\u2032\u03b1\u2032p\u2032 , (29)\nEel-ph =\n\u222b dr\u03c8\u2217(r) \u2211 \u03ba\u03b1p \u2202V 0KS(r) \u2202\u03c4\u03ba\u03b1p \u2206\u03c4\u03ba\u03b1p\u03c8(r). (30)\nSuch splitting will allow us to separately reformulate each part in terms of A, B in Bloch space and later examine their individual contribution to the formation of a polaron.\nStarting first with the electron part, we rely on the expansion of the polaron wavefunction \u03c8 in basis of KS states given by Eq. (5), keeping in mind that they are orthonormalized eigenfunctions of the KS Hamiltonian. By combining Eqs. (5) and (28) one obtains\nEel = 1\nNp \u2211 nk |Ank|2\u03b5nk, (31)\nwhich is in agreement with Eq. (15). For the phonon term we use the explicit expression for the matrix of interatomic force constants,\nC0\u03ba\u03b1p,\u03ba\u2032\u03b1\u2032p\u2032 =\n(M\u03baM\u03ba\u2032) 1/2\nNp\n\u2211 q\u03bd e\u03ba\u03b1,\u03bd(q)\u03c9 2 q\u03bde \u2217 \u03ba\u2032\u03b1\u2032,\u03bd(q)e iq\u00b7(Rp\u2212Rp\u2032 ),\n(32) and Eq. (8) for the displacements \u2206\u03c4\u03ba\u03b1p. In order to be consistent with the Eq. (15) and obtain |Bq\u03bd |2 in the final result, we also note that \u2206\u03c4\u03ba\u03b1p = \u2206\u03c4 \u2217 \u03ba\u03b1p since the displacements are real quantities. Hence after combining Eqs. (8), (29) and (32) the phonon part of the polaron energy reads as\nEph = 1\nNp \u2211 q\u03bd |Bq\u03bd |2\u03c9q\u03bd . (33)\nThis term comes into the variational equation with a different sign than in Eq. (15) and clearly indicates an increase of the polaronic energy due to the lattice deformation.\nTo obtain the electron-phonon contribution to the energy, we substitute Eqs. (5) and (8) into Eq. (30) and\n6 use Eq. (9). After some algebra the resulting term will be as follows\nEel-ph = \u2212 2\nNp \u2211 nm\u03bd \u2211 kq A\u2217mk+qAnkB \u2217 q\u03bdgmn\u03bd(k,q). (34)\nAt this point we recall the gauge arbitrariness of gmn\u03bd(k,q) mentioned in the previous section. To tackle this problem we note that Eel-ph has to be real, so it might me expressed alternatively by its complex conjugate or their average\nEel-ph =\n\u2212 1 Np \u2211 nm\u03bd \u2211 kq ( A\u2217mk+qAnkB \u2217 q\u03bdgmn\u03bd(k,q) + (c.c.) ) .\n(35) This expression has advantage to always be real regardless of electron and phonon parts of the polaron wavefunction and gauge arbitrariness of matrix elements.\nNow from Eqs. (27), (31), (33) and (35) we get the sought variational expression for the total energy of polaron, also using Eq. (7) with the Lagrange multiplier term to impose the normalization condition on its wavefunction:\nEp = E 0 +\n1\nNp \u2211 nk |Ank|2\u03b5nk\n\u2212 \u03b5\n( 1\nNp \u2211 nk |Ank|2 \u2212 1\n) + 1\nNp \u2211 q\u03bd |Bq\u03bd |2\u03c9q\u03bd\n\u2212 1 Np \u2211 nm\u03bd \u2211 kq ( A\u2217mk+qAnkB \u2217 q\u03bdgmn\u03bd(k,q) + (c.c.) ) .\n(36) This is a central result of this paper.\nThis expression yields minimum conditions for the polaron formation energy \u2206Ep by differentiation for Ank, Bq\u03bd under constraint Eq. (7), with obvious notations for their real or imaginary parts, respectively:\n0 = \u2202Ep(A,B)\n\u2202 Re/Im(An\u2032k\u2032) =\n2\nNp Re/Im(An\u2032k\u2032)(\u03b5n\u2032k\u2032 \u2212 \u03b5)\n\u2212 2 N2p \u2211 n\u03bdq Re/Im(Ank\u2032\u2212qB \u2217 q\u03bdgn\u2032n\u03bd(k \u2032 \u2212 q,q) +Ank\u2032+qBq\u03bdg \u2217 nn\u2032\u03bd(k\n\u2032,q)), (37)\n0 = \u2202Ep(A,B)\n\u2202 Re/Im(Bq\u2032\u03bd\u2032) =\n2\nNp Re/Im(Bq\u2032\u03bd\u2032)\u03c9q\u2032\u03bd\u2032\n\u2212 2 N2p \u2211 nmk Re/Im(A\u2217mk+q\u2032Ankgmn\u03bd\u2032(k,q \u2032)). (38)\nFrom Eqs. (37), (38) one obtains the eigenvalue problem similar to the one defined by Eqs. (13), (14). However,\nthe result is more general, with Eq. (13) now becoming\n1\nNp \u2211 qm\u03bd (Bq\u03bdg \u2217 mn\u03bd(k,q)Amk+q+\nB\u2217q\u03bdgmn\u03bd(k\u2212 q,q)Amk\u2212q) = (\u03b5nk \u2212 \u03b5)Ank. (39)\nThis expression might be applied to situations when the phase choice breaks time-reversal symmetry or when noncollinear magnetism is present.\nB. Variational anisotropic Fro\u0308hlich model\nIn order to apply Eq. (36) to the Fro\u0308hlich case, this variational framework needs to be reformulated by imposing the model approximations. At this point one can waive some restrictions of the original model, e.g. consider the case of parabolic energy bands with anisotropic effective masses to get results beyond the classic solutions. The electronic part of the Fro\u0308hlich Hamiltonian Eq. (17) is then\nH\u0302Fre = \u2211 k \u03b5(k)c\u0302\u2020kc\u0302k, (40)\nwith\n\u03b5(k) = 1\n2 ( k2x m\u2217x + k2y m\u2217y + k2z m\u2217z ) . (41)\nWe now reformulate Eq. (36) by taking into account the anisotropic Fro\u0308hlich model approximations. In the electronic part of Eq. (36) we switch from the KS to the planewave basis, as these are eigenfunctions of the free electron Hamiltonian, so \u03c80nk(r) in Eq. (5) becomes\n\u03c80Gk(r) = 1\u221a Np\u21260 ei(k+G)\u00b7r, (42)\nwhere the band index n now refers to a 3-dimensional index ni that defines coordinates of a reciprocal lattice vector G. The associated energy given by Eq. (28) in this basis reads as\nEFrel = 1\nNp \u2211 Gk |AGk|2\u03b5(G + k). (43)\nTo approach the phonon part we recall that in the Fro\u0308hlich model only LO phonon mode couples with electrons and we work in the macroscoping limit, ignoring atomic details. The vibrational energy is then modeled by Einstein oscillators with frequency \u03c9LO. Taking these approximations into account, in Eq. (8) we switch from atoms to Einstein oscillators, each is indexed with \u03ba and have mass M0. An oscillator \u03ba is moved by a mode \u03bd only when \u03bd = \u03ba, and no coordinate index \u03b1 is needed, since transverse optical modes are neglected. Thus\n\u2206\u03c4\u03bap = \u2212 2\nNp \u2211 q B\u2217q\u03ba ( 1 2M0\u03c9LO )1/2 eiq\u00b7Rp , (44)\n7 and one can make an additional Fourier transform to work with the reciprocal lattice vectors G instead of each index \u03ba to characterize the B\u2217 coefficients, since the Einstein oscillators are homogeneously spread:\nB\u2217q\u03ba = 1\u221a NG \u2211 G ei(q+G)\u00b7\u03c4\u03baB\u2217Gq, (45)\nwhere NG = N\u03ba is the number of the oscillators, and their homogeneous spread is given by the sum rule\u2211\n\u03ba\nei(G\u2212G \u2032)\u03c4\u03ba = \u03b4GG\u2032N\u03ba. (46)\nFrom Eqs. (33), (45) and (46) the associated energy is obtained:\nEFrph = 1\nNp \u2211 Gq |BGq|2\u03c9LO. (47)\nLastly, the electron-phonon contribution defined by Eq. (34) after some renaming becomes\nEFrel-ph = \u2212 1\nN2p \u2211 Gk \u2211 G\u2032k\u2032 A\u2217GkAG\u2032k\u2032B \u2217 (G\u2212G\u2032+U)(k\u2212k\u2032\u2212U)\n\u00d7gFr(G\u2212G\u2032 + k\u2212 k\u2032) + (c.c), (48)\nwhere U \u2261 U(k,k\u2032) is the Umklapp vector of the reciprocal lattice that translates q = k\u2212 k\u2032 \u2212U into the first BZ (possibly U = 0). Electron-phonon matrix elements gFr(q) are given by Eq. (20) and (21) for a primitive unit cell, since Np is already present in the prefactor of Eq. (48).\nIn these equations we consider a simple cubic cell with a cubic symmetry and BvK periodic boundary conditions. One also needs to truncate the summation over (G,k) and (G,q) in the electron and phonon parts respectively. We note that a uniform k-grid and corresponding q-grid (q = k\u2212k\u2032\u2212U) are simply determined by the size of the BvK supercell. These grids have to always contain the \u0393-point, but in case when linear size of a grid is even the cubic symmetry will be broken. On the other hand, electron G-grid and corresponding phonon grid (G\u2212G\u2032+U) act as counterparts for definition of electronic bands and phonon modes in Eq. (36) and define reciprocal lattice points. In order to preserve the symmetry and always work with \u0393-centred grids, we utilize the straightforward planewave energy cutoff approach: on the infinite grid for the electron part we select (G,k) with non-zero value of AGk only when for a predefined value of \u03b5cut\n\u03b5cut \u2265 \u03b5Gk. (49)\nSimilarly, the phonon coefficients BGq are selected only when they connect non-zero electronic coefficients.\nKeeping in mind the aforementioned cutoff procedure and combining Eqs. (43), (47) an (48), we arrive at\nthe variational polaron expression applied to the Fro\u0308hlich model:\n\u2206EFrp (A,B) = 1\nNp \u2211 Gk |AGk|2\u03b5Gk + 1 Np \u2211 Gq |BGq|2\u03c9LO\n\u2212 1 N2p \u2211 Gk \u2211 G\u2032k\u2032 (A\u2217GkAG\u2032k\u2032B \u2217 (G\u2212G\u2032+U)(k\u2212k\u2032\u2212U)\n\u00d7 gFr(G\u2212G\u2032 + k\u2212 k\u2032) + (c.c)). (50)\nMinimization of this expression yields polaronic energy in adiabatic approximation, since A and B are correlated by Eqs. (37), (38), and strong-coupling scenario of the Fro\u0308hlich model is captured by this variational approach. In this case only the quadratic terms of \u2206Ep(\u03b1) expansions given by Eqs. (24), (25) can be obtained and serve as a benchmark for numerical minimization."
        },
        {
            "heading": "C. Special Treatment of the Fro\u0308hlich Electron-Phonon Matrix Elements",
            "text": "Before detailing the minimization algorithm, we note that gFr(q) diverges at \u0393-point. Instead of setting gFr(0) = 0, we average this quantity in the neighbourhood of \u0393-point similarly to the approach used in the Supporting Information of Ref. 31. For this purpose it is convenient to rewrite Eq. (48)\nEFrel-ph = \u2212 1\nN2p \u2211 Gq (\u2211 G\u2032k A\u2217(G+G\u2032\u2212U)(k+q+U)AG\u2032k ) B\u2217Gq\n\u00d7gFr(G + q) + (c.c). (51)\nSimilar to Eq. (15) we obtain the relation between BGq and AGk\nBGq = 1\nNp \u2211 Gk A\u2217(G\u2032+G\u2212U)(k+q+U) gFr(G\u2032 + q) \u03c9LO AGk.\n(52) We also note that exactly at \u0393-point (q = 0,G = 0) the term in parenthesis in Eq. (51) equals Np due to the normalization: \u2211\nG\u2032k\nA\u2217G\u2032kAG\u2032k = Np. (53)\nNow, combining Eqs. (51)-(53) we express the average contribution of the electron-phonon term of the total energy in the neighborhood of \u0393-point:\nEG=0,q\u21920el-ph \u223c= \u2212\n1\n\u2126q=0N2p\u03c9LO \u222b \u2126q=0 dq q2 (qgFr(q))2, (54)\nwhere the area of the spherical q = 0 neighborhood is denoted by\n\u2126q=0 = 4\n3 \u03c0q3c (55)\n8 with the cutoff radius\nqc = 2\u03c0\n( 3\n4\u03c0\u21260\n)1/3 N\u22121/3p . (56)\nThe term in parenthesis in Eq. (54) is roughly constant and after integration one obtains\nEG=0,q\u21920el-ph ' \u2212 limq\u21920 (qgFr(q))2\nN2p\u03c9LO\n3\n(2\u03c0)2\n( 3\n4\u03c0Np\u21260\n)\u22122/3 .\n(57) Alternatively the same contribution can be obtained if around \u0393-point gFr(q) is replaced by gFr(0), which is constant:\nE G=0,q\u21920 el-ph ' \u2212 1\nNp\ngFr(0)2\n\u03c9LO . (58)\nFrom Eqs. (57) and (58) one obtains the expression for gFr(0). The same procedure can be done in 2D case and corrections to the electron-phonon matrix elements at \u0393point become\ngFr3D(0) =\n\u221a 3\n2\u03c0\n( 4\u03c0Np\u21260\n3\n)1/3( 2\u03c0\u03c9LO Np\u21260 \u03b5\u2217\u22121 )1/2 , (59)\ngFr2D(0) = 1\u221a \u03c0 (\u03c0Np\u21260) 1/4 ( \u03c0\u03c9LO Np\u21260 \u03b5\u2217\u22121 )1/2 . (60)\nThese constants indeed tend to zero for infinitely large supercells, but to a large extent can remove the convergence error of a minimization algorithm at low-density grids."
        },
        {
            "heading": "D. Preconditioned Conjugate Gradient Algorithm",
            "text": "The major challenge of the variational approach is the large size of the real space supercell (or equivalently the number of k-points Np) required in the minimization procedure and associated computational complexity. Since the gradient of the Fro\u0308hlich variational expression can be easily obtained, see the general Eqs. (37) and (38), we can utilize an efficient conjugate gradient algorithm and suggest a possible preconditioner to improve the convergence50,65. In Appendix C we provide its scaling analysis and show that it has a more favorable scaling than the algorithm utilized by Sio et al. in Ref 33. The present section focuses on the implementation details.\nFirst of all, we note that A and B are linked, as in Eq. (14) of the original model:\nBG\u2032\u2032q =\n1\nNp \u2211 Gk \u2211 G\u2032k\u2032\ufe38 \ufe37\ufe37 \ufe38\nk\u2212k\u2032\u2212U=q G\u2212G\u2032+U=G\u2032\u2032\nA\u2217G\u2032k\u2032 gFr(G\u2212G\u2032 + k\u2212 k\u2032)\n\u03c9LO AGk. (61)\nThis allows one to perform the minimization only in the electronic subspace since the phonon part of the gradient can be always set to zero using Eq (61), whatever the value of A. The electronic part of the gradient, which we denote as D, is easily obtained from Eq. (50) to give the adaptation of Eq. (37) to the Fro\u0308hlich case:\nDG\u2032k\u2032 = 2\nNp AG\u2032k\u2032(\u03b5G\u2032k\u2032 \u2212 \u03b5)\u2212\n2\nN2p \u2211 Gk (AGkB \u2217 (G\u2032\u2212G+U)(k\u2032\u2212k\u2212U)g Fr(G\u2032 \u2212G + k\u2032 \u2212 k) +AGkB(G\u2212G\u2032+U)(k\u2212k\u2032\u2212U)g Fr\u2217(G\u2212G\u2032 + k\u2212 k\u2032)).\n(62) The iterative minimization process itself is as follows. Let at n-th step Dn be the electronic part of the gradient at a certain point. In order to retain the normalization condition imposed onA we apply the approach similar to Ref. 65. Firstly, using the Gram-Schmidt process from Dn a vector orthogonal to the An is obtained, which we refer to as D\u22a5n. The conjugate gradient direction is calculated as\nQn = D\u22a5n + \u03b3nQ \u22a5(n\u22121) (63)\nwith\n\u03b3n =  0 n = 0\n(D\u22a5n)\u2217 \u00b7 (D\u22a5n \u2212Q\u22a5(n\u22121)) |Q\u22a5(n\u22121)|2 otherwise (64)\nand orthogonalization is also performed to yield Q\u22a5n. Then the energy is minimized along the path\n\u2206EFr(\u03b8) = \u2206EFr ( An cos \u03b8 +Q\u22a5n sin \u03b8 ) (65)\nto find the starting point of the next iteration step\nA(n+1) = An cos \u03b8min +Q \u22a5n sin \u03b8min. (66)\nThe process terminates once the squared norm of the gradient ||D||2 becomes lower than a certain threshold.\nA natural preconditioner for the gradient comes from the first term of Eq. (37). By taking its inverse for the Fro\u0308hlich case one obtains the preconditioner\nPGk = Np(\u03b5Gk \u2212 \u03b5mod)\u22121, (67)\nwhere \u03b5mod is the fraction of \u03b5. While the optimal choice of \u03b5 can be a challenge in full first-principles calculations, since the target value of this quantity cannot be estimated before the minimization, Pekar\u2019s 1:2:3:4 theorem allows its precise definition for the standard Fro\u0308hlich model and gives qualitative estimation in case of generalized Fro\u0308hlich model. Hence instead of simple gradient D, one can use the preconditioned gradient DPC, with components DPCGk = PGkDGk, to reach the solution significantly faster.\n9 We also note that if Eq. (50) is minimized at A, it reaches the minimum at A\u2217 as well, which implies that electronic coefficients are real-valued. In addition the polaron wavefunction inherits the symmetries of the problem and this allows a reduction of computational time and memory by evaluating A, B and gFr(q) only in the irreducible part of the BZ defined by its symmetries.\nFinally, since the minimum of \u2206Ep is obtained for a finite supercell defined by the size of a k-grid, we make a series of optimizations for several grids and then perform an extrapolation similar to the Makov-Payne extrapolation66 to obtain the polaron formation energy in the infinite limit \u2206E\u221ep :\n\u2206Ep(Np) = \u2206E \u221e p + aN \u22121 p +O(N\u2212np ), (68)\nwhere N is the linear size of a grid and n = 2/3 in 2D/3D case. The leading size-dependent term is coherent with Eq. 58."
        },
        {
            "heading": "IV. RESULTS AND DISCUSSION",
            "text": "We begin the analysis of the variational Fro\u0308hlich model by comparing the efficiency of different gradient-based algorithms applied to the polaron energy minimization. Along with the preconditioned conjugate gradient (PCG) mentioned in Section III D we also consider conjugate gradient wihout preconditioning (CG) and steepest descent (SD), which are obtained from PCG by setting PGk = 1 and also \u03b3n = 0 in case of SD. Fig. 1 shows that PCG decreases the squared norm of the gradient ||D||2 most rapidly, and the other two methods are substantially slower. This behaviour is consistent for various range of the model parameters and thus PCG is the best choice for optimization. It should be noted that in the original SVPG paper40 authors employ a parallel SD method, but even in such general first-principles model, implementation of PCG can be a major improvement that increases convergence rates of the iterative minimization, see Appendix C.\nIn order to validate the optimization results we compare polaron formation energies obtained in the isotropic case with the asymptotic solution of the Fro\u0308hlich model. Fig. 2 shows that the extrapolation yields \u2206E\u221ep that is in agreement with the asymptotic solution with the small difference due to the finite size of the k-grids employed. It is the leading term \u03b3 = \u2206E\u221ep /(\u03b1\n2\u03c9LO) (strong-coupling coefficient) in Eqs. (24) and (25) that can be obtained in the adiabatic strong-coupling approximation, and calculations give \u03b3 = \u22120.4046 in 2D and \u03b3 = \u22120.1074 in 3D, while the reference values are \u22120.4047 and \u22120.1085 respectively. Corrections of gFr(q) at \u0393 do not affect the extrapolated energy value since they vanish when Np \u2192\u221e. However, at low-density k-point grids they allow to obtain formation energies much more accurate than the calculations done with gFr(0) = 0. Thus one can qualitatively estimate the value of \u2206E\u221ep already with a small\n1 5 10 15 20 Iterations\n10 12\n10 10\n10 8\n10 6\n10 4\n10 2\nSq ua\nre d\nno rm\no f t\nhe g\nra di\nen t |\n|D ||2\nSteepest Descent Conjugate Gradient Preconditioned Conjugate Gradient\nFIG. 1: Performance comparison of gradient-based optimization algorithms applied to the variational Fro\u0308hlich model. The model is 2D isotropic with m\u2217 = 1, \u03b5\u2217 = 1 and 20 \u00d7 20 k-point grid.\n0.0 0.1 0.2 0.3 0.4 Inverse linear size of a k-grid\n0.3\n0.2\n0.1\n0.0\nEn er\ngy (a\n.u .)\ngFr(0) = 0 -corrected gFr(q)\n0.00 0.05 0.10 0.15 Inverse linear size of a k-grid\n0.06\n0.04\n0.02\n0.00 (a) (b)2D 3D\nFIG. 2: Polaron formation energy \u2206Ep for the (a) 2D and (b) 3D isotropic Fro\u0308hlich model with m\u2217 = 1, \u2217 = 1, as a function of the inverse linear size of the wavevector sampling. The square markers denote \u2206Ep obtained after minimization for range of k-point grids of incrementally increasing density up to 30\u00d730 and 28\u00d728\u00d728 in 2D and 3D cases respectively. Black points are obtained by setting gFr(0) = 0, while Eq. 58 is used for the blue points. The dashed lines are the extrapolation and the red circles show asymptotic solutions of the original Fro\u0308hlich model. The grey regions indicate ranges of k-point grids for which no polaron is formed.\nk-grid without an extrapolation. Additionaly, there exist k-point grids or alternatively supercells of critical size up to which there is no polaron formation. This behavior is similar to the one that can be found in Ref. 33,40 and is explained by the transition from a delocalized electronic state to a localized (self-trapped) state, i.e. periodic images of the polaron interact and form an extended wavefunction if a supercell is too small, so the quasiparticle is fully delocalized.\nNext we examine the generalized 2D and 3D Fro\u0308hlich model when electronic bands are anisotropic and all the other approximations of the original Fro\u0308hlich model remain valid. We also compare our results with the ones obtained with the Gaussian ansatz approach used by Guster et al44, which treats polarons in the strong-coupling adiabatic approximation like in the current methodology. As shown in Fig. 3, the difference is rather small, and quite independent of the anisotropy in the shown anisotropy\n10\nparameter range, with the variational approach giving only up to 3 % more accurate results. Taking into account numerical errors, the ratio between the two methods is constant in 2D and 3D cases, which implies that numerically exact polaronic wavefunction deviates from the optimized Gaussian trial wavefunction in a consistent manner regardless of the effective mass ratio as shown in Fig. 4. However, the deviation may become more pro-\nnounced once further generalizations to the model are introduced (degeneracy, multiple phonon bands), but this requires additional investigation and is not in the scope of the current work.\nFinally, we look at the individual terms that contribute to the polaron formation energy (Eel, Eph, Eel-ph) as well as the eigenenergy of its localized state \u03b5. We observe that in both anisotropic and isotropic 2D and 3D cases Pekar\u2019s 1:2:3:4 theorem remains valid with only small deviations due to numerical inaccuracies. In Tables I and II, we report these values, divided by the corresponding Pekar coefficient: Eel, Eph/2, \u03b5/3 and Eel-ph/4. We call these quantities the \u201creduced\u201d energies. This behavior also supports accuracy of the obtained results and can be used as a convergence check when the extrapolation is performed: k-point grid density and energy cutoff \u03b5ecut are good enough if the Pekar\u2019s 1:2:3:4 theorem is fulfilled, and have to be increased otherwise. Additional discussion on the validity of this theorem in anisotropic case is also provided in Appendix B."
        },
        {
            "heading": "V. CONCLUSION",
            "text": "In this work, starting from recent advances in the firstprinciples modeling of polarons by Sio et al33,40 we derive variational polaron equations in the basis of Kohn-\n11\nSham states. We suggest an effective gradient-based optimization algorithm and apply it to the Fro\u0308hlich model in 2D and 3D. We compare obtained results with the known isotropic asymptotic solution, and observe an excellent agreement. We also investigate the case of the anisotropic Fro\u0308hlich model, showing that the full variational approach gives slightly more accurate solution than the Gaussian ansatz technique. Apart from that, the divergent Fro\u0308hlich electron-phonon matrix elements are corrected at the \u0393-point, reducing by a large factor the convergence error, and allowing for qualitative estimation of the polaron formation energy without any extrapolation. Our methodology also allows to obtain the energy of a localized polaronic state and decompose the formation energy into individual electronic, vibrational and electron-phonon contributions. We show that their ratio obey\u2019s Pekar\u2019s 1:2:3:4 rule regardless of anisotropy and dimensionality.\nWhile the main application of the current work is on the anisotropic Fro\u0308hlich model, further generalization can be performed using the suggested framework. Taking also into account possible degeneracy of electronic bands as well as several LO phonon modes one may study wide range of realistic materials in scope of the generalized Fro\u0308hlich model."
        },
        {
            "heading": "Acknowledgments",
            "text": "This work has been supported by the Fonds de la Recherche Scientifique (FRS-FNRS, Belgium) through PdR ALPS Grant No. T.0103.19 ."
        },
        {
            "heading": "Appendix A: Electron-phonon part of the Hamiltonian with arbitrary choice of phonon phase",
            "text": "The general phase relation for the phonon eigenmodes with opposite wavevectors, obtained from the diagonalization of dynamical matrix (e.g. by numerical means) reads as\ne\u03ba\u03b1,\u03bd(\u2212q) = ei\u03c6(q)e\u2217\u03ba\u03b1,\u03bd(q), (A1)\nwith \u03c6(q) being an arbitrary phase. This equation is valid for non-degenerate phonon states, and should be further generalized to unitary matrices for the degenerate case, although we will not treat this further generalization in the present appendix. Actually, the phase ei\u03c6(q) depends on the mode \u03bd, but for the sake of simplicity, we will not explicitly mention this dependence.\nThere are two convenient conventions for the choice of phase, namely \u03c6(q) = 0 as in Born and Huang46 and \u03c6(q) = \u03c0 as in Leibfried.47 The first, for example, is used in Ref. 29. However, without choosing any of these conventions, one can obtain a generalized expression for a linear coordinate transformation of the ionic displacements and the accompanying electron-phonon term in the Hamiltonian.\nFor this purpose, we follow Appendix B of Ref. 29, which delivers the following modified equations. Eq. (B15) of Ref. 29 becomes\nzq\u03bd = lq\u03bd(a\u0302q\u03bd + e \u2212i\u03c6(q)a\u0302\u2020\u2212q\u03bd). (A2)\nUsing this equation one gets atomic displacements\n\u2206\u03c4\u03ba\u03b1p =( M0\nNpM\u03ba )1/2\u2211 q\u03bd eiq\u00b7Rpe\u03ba\u03b1,\u03bd(q)lq\u03bd(a\u0302q\u03bd + e \u2212i\u03c6(q)a\u0302\u2020\u2212q\u03bd)\n(A3) and electron-phonon term of the Hamiltonian\nH\u0302el-ph =\n1\nN 1/2 p \u2211 kq mn\u03bd gmn\u03bd(k,q)c\u0302 \u2020 mk+qc\u0302nk(a\u0302q\u03bd + e \u2212i\u03c6(q)a\u0302\u2020\u2212q\u03bd),\n(A4) which are the sought generalized counterparts of Eqs. (20) and (37) of Ref. 29 respectively.\nEq. (A4) shows that the form of the Fro\u0308hlich Hamiltonian depends on the choice of phase. In the present paper \u03c6(q) = 0, but if Leibfrid convention were used, Eqs. (19)-(21) would read as\nH\u0302Frel-ph = \u2211 kq gFr(q)c\u0302\u2020k+qc\u0302k(a\u0302q \u2212 a\u0302 \u2020 \u2212q), (A5)\ngFr3D(q) = i\n|q| ( 2\u03c0\u03c9LO Np\u21260 \u2217\u22121 )1/2 , (A6)\ngFr2D(q) = i\n|q|1/2 ( \u03c0\u03c9LO Np\u21260 \u2217\u22121 )1/2 , (A7)\nwhich is coherent, e.g. with Refs. 26,67. See Ref. 48 for further information about this topic."
        },
        {
            "heading": "Appendix B: Pekar\u2019s 1:2:3:4 theorem",
            "text": "In order to derive the 1:4 relation of the Pekar\u2019s theorem in anisotropic case it is convenient to introduce the average effective mass m\u2217 = 3 \u221a m\u2217xm \u2217 ym \u2217 z, and rewrite the electronic energy given by Eq. (41) as follows :\n\u03b5(k) = 1\n2m\u2217 ( k2x m\u2217x,r + k2y m\u2217y,r + k2z m\u2217z,r ) , (B1)\nwhere m\u2217i,r = m \u2217 i /m \u2217 denotes reduced effective masses along each direction. These reduced effective masses will stay unchanged in what follows, which is a key point in the demonstration.\nThen one can follow the same reasoning provided in Ref. 64 for isotropic case. Assuming \u03c80 is the groundstate wavefunction of a polaron in the ground state,\n12\nwe use Fro\u0308hlich Hamiltonian defined by Eq. (16) and Feynman-Hellman theorem to obtain the derivative of the polaron formation energy with respect to inverse of the mass \u03bb = 1/m\u2217:\nd(\u2206Ep)\nd\u03bb = \u2329 \u03c80 \u2223\u2223\u2223\u2223dHFrd\u03bb \u2223\u2223\u2223\u2223\u03c80\u232a = 1\u03bbEel. (B2) After changing the Hamiltonian to dimensionless units similarly to Ref. 64, it can be shown that the polaron formation energy \u2206Ep is the function of \u03b1 only, which is the averaged anisotropic Fro\u0308hlich coupling constant:\n\u03b1 =\n( m\u2217\n2\u03c9LO\n)1/2 \u2217\u22121. (B3)\nThen using the average mass dependence of this constant and Eq. (B2), electronic contribution to the formation energy can be expressed as derivative of \u03b1:\nEel = \u03bb d(\u2206Ep)\nd\u03bb = \u03bb\nd(\u2206Ep)\nd\u03b1\nd\u03b1 d\u03bb = \u22121 2 \u03b1 d(\u2206Ep) d\u03b1 . (B4)\nThe electron-phonon interaction term, obtained in the same way, reads as\nEel-ph = 2\u03b1 d(\u2206Ep)\nd\u03b1 . (B5)\nCombining Eqs. (B4) and (B5) one obtains the 1:4 relation of the Pekar\u2019s theorem, that is valid regardless of the value of \u03b1:\nEel : \u2212Eel-ph = 1 : 4. (B6)\nSince the present work describes polaron in the strong coupling regime of adiabatic approximation, the 1:2 relation will always hold. This immediately follows from the fact that electron and phonon parts of the polaron wavefunctions are correlated, see Eq. (38). Taking this into account and using Eqs. (33), (35), one can show that\nEel-ph = \u22122Eph (B7)\nand, consequently, from the relation B6 it follows that\nEel : Eph = 1 : 2. (B8)\nLastly, adiabatic approximation implies that the formation energy of a self-trapped polaron can also be expressed as the sum of the energy of localized polaronic state and the energy of lattice deformation:\n\u2206Ep = \u03b5+ Eph. (B9)\nUsing Eq. (27) and the aforementioned ratios, one obtains the 1:3 relation:\nEel : \u2212\u03b5 = 1 : 3. (B10)\nIt should be emphasized that the 1:2 and 1:3 ratios are inherent to the adiabatic approximation and will always\nbe valid for the model of Ref. 33 irrespective of the form of the electron-phonon coupling. On the other hand, the 1:4 ratio comes from the dimensional analysis of the Fro\u0308hlich model, which arises when one takes derivatives of the formation energy with respect to a certain parameter. Hence in the present work the 1:4 result is only true when the convergence with respect to number of plane waves and number of k-points is reached.\nIn the weak-coupling regime, only the 1:4 relation remains. Vibrational energy Eph in this case will depend on the \u03b1 parameter, and energy of a localized polaronic state \u03b5 is not even defined, since there is no self-trapped polaron. In this sense we note that in Appendix B of Ref. 38 the authors erroneously state that the Pekar\u2019s theorem is valid for all ranges of the coupling parameter."
        },
        {
            "heading": "Appendix C: Scaling of the Minimization Algorithm",
            "text": "The computational complexity of the SVPG framework and, consequently, of the variational approach to the problem is determined by the large size of a k-point grid Np that may be required for the extrapolaton of energy. In the original papers authors rely on standard numerical eigensolvers to diagonalize electronic matrix defined by Eq. (13), which scale like O(N3p ), i.e. as the cube of the matrix size. In their approach only the lowest (largest) eigenvalue of the Hamiltonian is required, so to find this value and the corresponding eigenvector one can also benefit from iterative eigensolvers that scale like O(N2p ).\nComputation of the gradient at each minimization step defined by Eqs. (37), (38) scales as O(N2p ), which is also valid in the Fro\u0308hlich case, see Eqs. (61) and (62). This along with the efficiency of the PCG algorithm allowed us to handle the calculations on a laptop using Python68 scripts, while in Ref. 33 authors rely on a distributedmemory eigensolver from the ScaLAPACK library69 to deal with grids of similar size. Also, in the matrix methods setting up the Hamiltonian requires additional memory in comparison with the variational approach. Fig. C.1 shows performance of the minimization routines.\n13\n1 S. Giannini, A. Carof, M. Ellis, H. Yang, O. G. Ziogos, S. Ghosh, and J. Blumberger, Nat. Commun. 10, 3843 (2019). 2 M. Park, A. J. Neukirch, S. E. Reyes-Lillo, M. Lai, S. R. Ellis, D. Dietze, J. B. Neaton, P. Yang, S. Tretiak, and R. A. Mathies, Nat. Commun. 9, 2525 (2018). 3 D. Ghosh, E. Welch, A. J. Neukirch, A. Zakhidov, and S. Tretiak, J. Phys. Chem. Lett. 11, 3271 (2020). 4 G. Brunin, G.-M. Rignanese, and G. Hautier, Phys. Rev. Mater. 3, 064602 (2019). 5 G. K. P. Dathar, D. Sheppard, K. J. Stevenson, and G. Henkelman, Chem. Mater. 23, 4032 (2011). 6 M. Kang, S. W. Jung, W. J. Shin, Y. Sohn, S. H. Ryu, T. K. Kim, M. Hoesch, and K. S. Kim, Nat. Mater. 17, 676 (2018). 7 V. Vasilchenko, S. Levchenko, V. Perebeinos, and A. Zhugayevych, J. Phys. Chem. Lett. 12, 4674 (2021). 8 C. Franchini, M. Reticcioli, M. Setvin, and U. Diebold, Nat. Rev. Mater. 6, 560 (2021). 9 L. D. Landau and S. I. Pekar, Zh. Eksp. Teor. Fiz. 18, 419 (1948). 10 H. Fro\u0308hlich, H. Pelzer, and S. Zienau, Lond. Edinb. Dubl. Phil. Mag. 41, 221 (1950). 11 T. Holstein, Ann. Phys. 8, 325 (1959). 12 T. Holstein, Ann. Phys. 8, 343 (1959). 13 M. Sendner, P. K. Nayak, D. A. Egger, S. Beck, C. Mu\u0308ller,\nB. Epding, W. Kowalsky, L. Kronik, H. J. Snaith, A. Pucci, and R. Lovrinc\u030cic\u0301, Mater. Horiz. 3, 613 (2016). 14 F. Zheng and L. Wang, Energy Environ. Sci. 12, 1219 (2019). 15 H. Fro\u0308hlich, Adv. Phys. 3, 325 (1954). 16 T. D. Lee, F. E. Low, and D. Pines, Phys. Rev. 90, 297\n(1953). 17 R. P. Feynman, Phys. Rev. 97, 660 (1955). 18 A. Mishchenko, N. Prokof\u2019ev, A. Sakamoto, and B. Svis-\ntunov, Phys. Rev. B 62, 6317 (2000). 19 C. A. Perroni, A. Nocera, V. M. Ramaglia, and\nV. Cataudella, Phys. Rev. B 83, 245107 (2011). 20 A. Zhugayevych and S. Tretiak, Annu. Rev. Phys. Chem.\n66, 305 (2015). 21 A. Marini, Phys. Rev. Lett. 101, 106405 (2008). 22 F. Giustino, S. Louie, and M. Cohen, Phys. Rev. Lett.\n105, 265501 (2010). 23 X. Gonze, P. Boulanger, and M. Co\u0302te\u0301, Annalen der Physik\n(Leipzig) 523, 168 (2011). 24 G. Antonius, S. Ponce\u0301, P. Boulanger, M. Co\u0302te\u0301, and\nX. Gonze, Phys. Rev. Lett. 112, 215501 (2014). 25 S. Ponce\u0301, G. Antonius, P. Boulanger, E. Cannuccia,\nA. Marini, M. Co\u0302te\u0301, and X. Gonze, Computational Materials Science 83, 341 (2014). 26 C. Verdi and F. Giustino, Phys. Rev. Lett. 115, 176401 (2015). 27 S. Ponce\u0301, Y. Gillet, J. Laflamme Janssen, A. Marini, M. Verstraete, and X. Gonze, J. Chem. Phys. 143, 102813 (2015). 28 G. Antonius, S. Ponce\u0301, E. Lantagne-Hurtubise, G. Auclair, X. Gonze, and M. Co\u0302te\u0301, Phys. Rev. B 92, 085137 (2015). 29 F. Giustino, Rev. Mod. Phys. 89, 015003 (2017). 30 J. P. Nery, P. B. Allen, G. Antonius, L. Reining, A. Miglio,\nand X. Gonze, Phys. Rev. B 97, 115145 (2018). 31 A. Miglio, V. Brousseau-Couture, E. Godbout, G. Anto-\nnius, Y.-H. Chan, S. G. Louie, M. Co\u0302te\u0301, M. Giantomassi, and X. Gonze, npj Comput. Mater. 6, 167 (2020). 32 F. Brown-Altvater, G. Antonius, T. Rangel, M. Giantomassi, C. Draxl, X. Gonze, S. G. Louie, and J. B. Neaton, Phys. Rev. B 101, 165102 (2020). 33 W. H. Sio, C. Verdi, S. Ponce\u0301, and F. Giustino, Phys. Rev. Lett. 122, 246403 (2019). 34 A. M. Stoneham, J. Gavartin, A. L. Shluger, A. V. Kimmel, D. Ramo, H. M. R\u00f8nnow, G. Aeppli, and C. Renner, J. Phys.: Condens. Matter 19, 255208 (2007). 35 J. B. Varley, A. Janotti, C. Franchini, and C. G. V. de Walle, Phys. Rev. B 85, 081109(R) (2012). 36 B. Sadigh, P. Erhart, and D. Aberg, Phys. Rev. B 92, 075202 (2015). 37 G. Geneste, B. Amadon, M. Torrent, and G. Dezanneau, Phys. Rev. B 96, 134123 (2017). 38 S. Kokott, S. V. Levchenko, P. Rinke, and M. Scheffler, New J. Phys. 20, 033023 (2018). 39 C. Tantardini, S. Kokott, X. Gonze, S. Levchenko, and W. A. Saidi, Applied Materials Today 26, 101380 (2022). 40 W. H. Sio, C. Verdi, S. Ponce\u0301, and F. Giustino, Phys. Rev. Lett. 122, 246403 (2019). 41 K. Hannewald, V. M. Stojanovic\u0301, J. M. T. Schellekens, P. A. Bobbert, G. Kresse, and J. Hafner, Phys. Rev. B 69, 075211 (2004). 42 N.-E. Lee, H.-Y. Chen, J.-J. Zhou, and M. Bernardi, Phys. Rev. Mat. 5, 063805 (2021). 43 Y. Luo, B. K. Chang, and M. Bernardi, Phys. Rev. B 105, 155132 (2022). 44 B. Guster, P. Melo, B. A. A. Martin, V. BrousseauCouture, J. C. de Abreu, A. Miglio, M. Giantomassi, M. Co\u0302te\u0301, J. M. Frost, M. J. Verstraete, and X. Gonze, Phys. Rev. B 104, 235123 (2021). 45 X. Gonze and C. Lee, Phys. Rev. B 55, 10355 (1997). 46 M. Born and K. Huang, Dynamical theory of crystal lattices\n(Oxford University Press, Oxford, 1954). 47 G. Leibfried, Handbuch der physik. vol. 7, part I (Springer\nVerlag, Berlin, 1955). 48 B. Guster, P. Melo, B. A. A. Martin, V. Brousseau-\nCouture, J. C. de Abreu, A. Miglio, M. Giantomassi, M. Co\u0302te\u0301, J. M. Frost, M. J. Verstraete, and X. Gonze, Phys. Rev. B 105, 119902 (2022). 49 P. Pulay, Chem. Phys. Lett. 73, 393 (1980). 50 P. Pulay, J. Comp. Chem. 3, 556 (1982). 51 X. Gonze, Phys. Rev. B 54, 4383 (1996). 52 N. D. Woods, M. C. Payne, and P. J. Hasnip, J. Phys.\nCondens. Matter 31, 453001 (2019). 53 F. M. Peeters, W. Xiaoguang, and J. T. Devreese, Phys.\nRev. B 33, 3926 (1986). 54 T. Hahn, S. Klimin, J. Tempere, J. T. Devreese, and\nC. Franchini, Phys. Rev. B 97, 134305 (2018). 55 T. Sohier, M. Calandra, and F. Mauri, Phys. Rev. B 94,\n085415 (2016). 56 T. Sohier, M. Gibertini, M. Calandra, F. Mauri, and\nN. Marzari, Nano Letters (2017). 57 T. Sohier, M. Calandra, and F. Mauri, Phys. Rev. B 96,\n075448 (2017). 58 T. Deng, G. Wu, W. Shi, Z. M. Wong, J.-S. Wang, and\nS.-W. Yang, Phys. Rev. B 103, 075410 (2021). 59 W. H. Sio and F. Giustino, Phys. Rev. B 105, 115414\n(2022).\n14\n60 S. J. Miyake, J. Phys. Soc. Jpn 41, 747 (1976). 61 W. Xiaoguang, F. M. Peeters, and J. T. Devreese, Phys.\nRev. B 31, 3420 (1985). 62 M. A. Smondyrev, Teor. Math. Fiz. 38, 29 (1986). 63 V. M. Fomin and M. A. Smondyrev, Phys. Rev. B 49,\n12748 (1994). 64 L. Lemmens and J. Devresse, Solid State Commun. 12,\n1067 (1973). 65 M. P. Teter, M. C. Payne, and D. C. Allan, Phys. Rev. B\n40, 12255 (1989).\n66 G. Makov and M. C. Payne, Phys. Rev. B 51, 4014 (1995). 67 J. T. Devreese, \u201cPolarons,\u201d (2000), arXiv:cond-\nmat/0004497 [cond-mat.str-el] . 68 G. Van Rossum and F. L. Drake, Python 3 Reference Man-\nual (CreateSpace, Scotts Valley, CA, 2009). 69 J. Choi, J. Demmel, I. Dhillon, J. Dongarra, S. Ostrouchov,\nA. Petitet, K. Stanley, D. Walker, and R. Whaley, Comp. Phys. Commun. 97, 1 (1996)."
        }
    ],
    "title": "Variational Polaron Equations Applied to the Anisotropic Fro\u0308hlich Model",
    "year": 2022
}