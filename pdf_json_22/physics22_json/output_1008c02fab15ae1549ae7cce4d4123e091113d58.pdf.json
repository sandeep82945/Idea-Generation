{
    "abstractText": "The power output of Stirling engines can be optimized by several means. In this study, the focus is on potential performance improvements that can be achieved by optimizing the piston motion of an alpha-Stirling engine in the presence of dissipative processes, in particular mechanical friction. We use a low-effort endoreversible Stirling engine model, which allows for the incorporation of finite heat and mass transfer as well as the friction caused by the piston motion. Instead of performing a parameterization of the piston motion and optimizing these parameters, we here use an indirect iterative gradient method that is based on Pontryagin\u2019s maximum principle. For the varying friction coefficient, the optimization results are compared to both, a harmonic piston motion and optimization results found in a previous study, where a parameterized piston motion had been used. Thus we show how much performance can be improved by using the more sophisticated and numerically more expensive iterative gradient method.",
    "authors": [
        {
            "affiliations": [],
            "name": "Karl Heinz Hoffmann"
        }
    ],
    "id": "SP:6dc416140e1dd4205a511449441637d0da4beb8c",
    "references": [
        {
            "authors": [
                "R. Stirling"
            ],
            "title": "Inventions for Diminishing the Consumption of Fuel and in Particular an Engine Capable of Being Applied to the Moving of Machinery on a Principle Entirely New",
            "venue": "British Patent 4081,",
            "year": 1816
        },
        {
            "authors": [
                "G.H. Ladas",
                "O.M. Ibrahim"
            ],
            "title": "Finite-Time View of the Stirling Engine",
            "venue": "Energy",
            "year": 1994
        },
        {
            "authors": [
                "F. Wu",
                "L. Chen",
                "C. Wu",
                "F. Sun"
            ],
            "title": "Optimum performance of irreversible stirling engine with imperfect regeneration",
            "venue": "Energ. Convers. Manag",
            "year": 1998
        },
        {
            "authors": [
                "Y. Timoumi",
                "I. Tlili",
                "S.B. Nasrallah"
            ],
            "title": "Performance optimization of Stirling engines",
            "venue": "Renew. Energy",
            "year": 2008
        },
        {
            "authors": [
                "C.H. Chen",
                "Y.J. Yu"
            ],
            "title": "Combining dynamic and thermodynamic models for dynamic simulation of a beta-type Stirling engine with rhombic-drive mechanism",
            "venue": "Renew. Energy",
            "year": 2012
        },
        {
            "authors": [
                "M.H. Ahmadi",
                "M.A. Ahmadi",
                "F. Pourfayaz",
                "M. Bidi",
                "H. Hosseinzade",
                "M. Feidt"
            ],
            "title": "Optimization of powered Stirling heat engine with finite speed thermodynamics",
            "venue": "Energ. Convers. Manag",
            "year": 2016
        },
        {
            "authors": [
                "M.H. Briggs"
            ],
            "title": "Improving Free-Piston Stirling Engine Specific Power",
            "venue": "In Proceedings of the 12th International Energy Conversion Engineering Conference,",
            "year": 2014
        },
        {
            "authors": [
                "S. Kojima"
            ],
            "title": "Maximum Work of Free-Piston Stirling Engine Generators",
            "venue": "J. Non-Equilib. Thermodyn",
            "year": 2017
        },
        {
            "authors": [
                "M. Craun",
                "B. Bamieh"
            ],
            "title": "Optimal Periodic Control of an Ideal Stirling Engine Model",
            "venue": "J. Dyn. Syst. Meas. Control",
            "year": 2015
        },
        {
            "authors": [
                "M. Craun",
                "B. Bamieh"
            ],
            "title": "Control-Oriented Modeling of the Dynamics of Stirling Engine Regenerators",
            "venue": "J. Dyn. Syst. Meas. Control",
            "year": 2018
        },
        {
            "authors": [
                "R.R. Paul"
            ],
            "title": "Optimal Control of Stirling Engines",
            "venue": "Ph.D. Thesis,",
            "year": 2020
        },
        {
            "authors": [
                "R. Masser",
                "A. Khodja",
                "M. Scheunert",
                "K. Schwalbe",
                "A. Fischer",
                "R. Paul",
                "K.H. Hoffmann"
            ],
            "title": "Optimized Piston Motion for an Alpha-Type Stirling Engine",
            "venue": "Entropy",
            "year": 2020
        },
        {
            "authors": [
                "J. Pode\u0161va",
                "Z. Poruba"
            ],
            "title": "The Stirling engine mechanism optimization",
            "venue": "Perspect. Sci. 2016,",
            "year": 2016
        },
        {
            "authors": [
                "M.H. Briggs",
                "J. Prahl",
                "K. Loparo"
            ],
            "title": "Improving Power Density of Free-Piston Stirling Engines",
            "venue": "In Proceedings of the 14th International Energy Conversion Engineering Conference, Salt Lake City, UT, USA,",
            "year": 2016
        },
        {
            "authors": [
                "M. Nicol-Seto",
                "D. Nobes"
            ],
            "title": "Experimental evaluation of piston motion modification to improve the thermodynamic power output of a low temperature gamma Stirling engine",
            "venue": "E3S Web Conf",
            "year": 2021
        },
        {
            "authors": [
                "W.R. Martini"
            ],
            "title": "Stirling Engine Design Manual, 2nd ed.; CreateSpace Independent Publishing: Brook",
            "year": 2013
        },
        {
            "authors": [
                "A.J. Organ"
            ],
            "title": "Thermodynamic Design of Stirling Cycle Machines",
            "venue": "Proc. Inst. Mech. Eng",
            "year": 1987
        },
        {
            "authors": [
                "M.J. Craun"
            ],
            "title": "Modeling and Control of an Actuated Stirling Engine",
            "venue": "Ph.D. Thesis, University of California Santa Barbara,",
            "year": 2015
        },
        {
            "authors": [
                "R. Paul",
                "A. Khodja",
                "K.H. Hoffmann"
            ],
            "title": "An endoreversible model for the regenerators of Vuilleumier refrigerators",
            "venue": "Osaka, Japan,",
            "year": 2020
        },
        {
            "authors": [
                "K.H. Hoffmann",
                "J.M. Burzler",
                "A. Fischer",
                "M. Schaller",
                "S. Schubert"
            ],
            "title": "Optimal Process Paths for Endoreversible Systems",
            "venue": "J. Non-Equilib. Thermodyn",
            "year": 2003
        },
        {
            "authors": [
                "B. Andresen",
                "P. Salamon",
                "R.S. Berry"
            ],
            "title": "Thermodynamics in Finite Time",
            "venue": "Phys. Today",
            "year": 1984
        },
        {
            "authors": [
                "B. Andresen",
                "R.S. Berry",
                "A. Nitzan",
                "P. Salamon"
            ],
            "title": "Thermodynamics in Finite Time. I",
            "venue": "The Step-Carnot Cycle. Phys. Rev. A",
            "year": 1977
        },
        {
            "authors": [
                "P. Salamon",
                "B. Andresen",
                "R.S. Berry"
            ],
            "title": "Thermodynamics in Finite Time. II. Potentials for Finite-Time Processes",
            "venue": "Phys. Rev. A",
            "year": 1977
        },
        {
            "authors": [
                "B. Andresen",
                "P. Salamon",
                "R.S. Berry"
            ],
            "title": "Thermodynamics in finite time: Extremals for imperfect heat engines",
            "venue": "J. Chem. Phys",
            "year": 1977
        },
        {
            "authors": [
                "P. Salamon",
                "A. Nitzan",
                "B. Andresen",
                "R.S. Berry"
            ],
            "title": "Minimum Entropy Production and the Optimization of Heat Engines",
            "venue": "Phys. Rev. A",
            "year": 1980
        },
        {
            "authors": [
                "M. Esposito",
                "R. Kawai",
                "K. Lindenberg",
                "C. Van den Broeck"
            ],
            "title": "Efficiency at Maximum Power of Low-Dissipation",
            "venue": "Carnot Engines. Phys. Rev. Lett",
            "year": 2010
        },
        {
            "authors": [
                "P. Blaudeck",
                "K.H. Hoffmann"
            ],
            "title": "Optimization of the Power Output for the Compression and Power Stroke of the Diesel Engine",
            "year": 1995
        },
        {
            "authors": [
                "L. Chen",
                "F. Sun",
                "C. Wu"
            ],
            "title": "Optimal configuration of a two-heat-reservoir heat-engine with heat-leak and finite thermal-capacity",
            "venue": "Appl. Energy",
            "year": 2006
        },
        {
            "authors": [
                "H. Song",
                "L. Chen",
                "F. Sun"
            ],
            "title": "Endoreversible heat-engines for maximum power-output with fixed duration and radiative heattransfer law",
            "venue": "Appl. Energy",
            "year": 2007
        },
        {
            "authors": [
                "K.H. Hoffmann"
            ],
            "title": "An introduction to endoreversible thermodynamics",
            "venue": "AAPP\u2014Phys. Math. Nat. Sci",
            "year": 2008
        },
        {
            "authors": [
                "C. Lu",
                "L. Bai"
            ],
            "title": "Nonlinear Dissipation Heat Devices in Finite-Time Thermodynamics: An Analysis of the Trade-Off Optimization",
            "venue": "J. Non-Equilib. Thermodyn",
            "year": 2017
        },
        {
            "authors": [
                "M. Feidt",
                "M. Costea"
            ],
            "title": "From Finite Time to Finite Physical Dimensions Thermodynamics: The Carnot Engine and Onsager\u2019s Relations Revisited",
            "venue": "J. Non-Equilib. Thermodyn",
            "year": 2018
        },
        {
            "authors": [
                "Z. Ding",
                "Y. Ge",
                "L. Chen",
                "H. Feng",
                "S. Xia"
            ],
            "title": "Optimal Performance Regions of Feynman\u2019s Ratchet Engine with Different Optimization Criteria",
            "venue": "J. Non-Equilib. Thermodyn",
            "year": 2020
        },
        {
            "authors": [
                "S. Levario-Medina",
                "G. Valencia-Ortega",
                "M.A. Barranco-Jim\u00e9nez"
            ],
            "title": "Energetic Optimization Considering a Generalization of the Ecological Criterion in TraditionalSimple-Cycle and Combined-Cycle Power Plants",
            "venue": "J. Non-Equilib. Thermodyn",
            "year": 2020
        },
        {
            "authors": [
                "M.J. Ondrechen",
                "B. Andresen",
                "R.S. Berry"
            ],
            "title": "Thermodynamics in Finite Time: Processes with Temperature-Dependent Chemical Reactions",
            "venue": "J. Chem. Phys",
            "year": 1980
        },
        {
            "authors": [
                "D. Narducci"
            ],
            "title": "Efficiency at Maximum Power of Dissipative Thermoelectric Generators: A Finite-time Thermodynamic Analysis",
            "venue": "J. Mater. Eng. Perform",
            "year": 2018
        },
        {
            "authors": [
                "T.N.F. Roach",
                "P. Salamon",
                "J. Nulton",
                "B. Andresen",
                "B. Felts",
                "A. Haas",
                "S. Calhoun",
                "N. Robinett",
                "F. Rohwer"
            ],
            "title": "Application of finite-time and control thermodynamics to biological processes at multiple scales",
            "venue": "J. Non-Equilib. Thermodyn",
            "year": 2018
        },
        {
            "authors": [
                "K. Wagner"
            ],
            "title": "An Extension to Endoreversible Thermodynamics for Multi-Extensity Fluxes and Chemical Reaction Processes",
            "venue": "Ph.D. Thesis,",
            "year": 2014
        },
        {
            "authors": [
                "K. Wagner",
                "K.H. Hoffmann"
            ],
            "title": "Endoreversible modeling of a PEM fuel cell",
            "venue": "J. Non-Equilib. Thermodyn",
            "year": 2015
        },
        {
            "authors": [
                "K. Wagner",
                "K.H. Hoffmann"
            ],
            "title": "Chemical reactions in endoreversible thermodynamics",
            "venue": "Eur. J. Phys. 2016,",
            "year": 2016
        },
        {
            "authors": [
                "S.J. Watowich",
                "K.H. Hoffmann",
                "R.S. Berry"
            ],
            "title": "Intrinsically Irreversible Light-Driven Engine",
            "venue": "J. Appl. Phys",
            "year": 1985
        },
        {
            "authors": [
                "S.J. Watowich",
                "K.H. Hoffmann",
                "R.S. Berry"
            ],
            "title": "Optimal Paths for a Bimolecular, Light-Driven Engine",
            "venue": "Il Nuovo Cim. B",
            "year": 1989
        },
        {
            "authors": [
                "K. Ma",
                "L. Chen",
                "F. Sun"
            ],
            "title": "Optimal paths for a light-driven engine with a linear phenomenological heat transfer law",
            "venue": "Sci. China Chem. 2010,",
            "year": 2010
        },
        {
            "authors": [
                "M. Papageorgiou",
                "M. Leibold",
                "M. Buss"
            ],
            "title": "Optimierung\u2014Statische, Dynamische, Stochastische Verfahren f\u00fcr die Anwendung",
            "year": 2015
        },
        {
            "authors": [
                "R.S. Berry",
                "V.A. Kazakov",
                "S. Sieniutycz",
                "Z. Szwast",
                "A.M. Tsirlin"
            ],
            "title": "Thermodynamic Optimization of Finite-Time Processes",
            "year": 2000
        }
    ],
    "sections": [
        {
            "text": "Citation: Paul, R.; Khodja, A.; Fischer,\nA.; Masser, R.; Hoffmann, K.H.\nPower-Optimal Control of a Stirling\nEngine\u2019s Frictional Piston Motion.\nEntropy 2022, 24, 362. https://\ndoi.org/10.3390/e24030362\nAcademic Editor: Attila R. Imre\nReceived: 12 November 2021\nAccepted: 25 February 2022\nPublished: 3 March 2022\nPublisher\u2019s Note: MDPI stays neutral\nwith regard to jurisdictional claims in\npublished maps and institutional affil-\niations.\nCopyright: \u00a9 2022 by the authors.\nLicensee MDPI, Basel, Switzerland.\nThis article is an open access article\ndistributed under the terms and\nconditions of the Creative Commons\nAttribution (CC BY) license (https://\ncreativecommons.org/licenses/by/\n4.0/).\nKeywords: piston motion optimization; endoreversible thermodynamics; Stirling engine; irreversibility; friction; power; efficiency; optimization; optimal control"
        },
        {
            "heading": "1. Introduction",
            "text": "Stirling engines [1] are devices capable of transforming heat into mechanical work by utilizing almost any external heat source. Thus, they constitute an interesting alternative for power production in various scenarios, e.g., for waste heat or burnable waste gas utilization, or as part of electrothermal energy storage systems for renewable energies. The most essential parts of a Stirling engine are the hot working space, the cold working space, and the regenerator. The two working spaces are thermally connected to external heat baths through heat exchangers. The volumes of the working spaces are cyclically varied over time so as to compress the gas at low temperature, heat it up with help of the regenerator, expand it at high temperature and cool it down again using the regenerator. One technical configuration to realize this is referred to as alpha-Stirling engine, where the two working spaces are in separate cylinders and their volumes are changed by independently movable working pistons. To determine proper design parameters of a Stirling engine suitable for a specific application, parameter optimizations can be performed, see for example [2\u20136]. Then, the piston motions are often determined as harmonic functions or parametric functions representing specific piston drive mechanisms. In this theoretical study we focus on how the piston motion influences the engine performance by applying methods similar to previous optimizations of Stirling engines\u2019 piston motions [7\u201313]. Experimental studies [14,15] have shown that power output improvements of Stirling engines are feasible through altering the piston motion. In the current study we revisit [12], where we performed the optimization of an alpha-Stirling engine for a parameterized class of smooth piston motions. In contrast to this previous publication, we will not restrict ourselves to such a parameterized class\nEntropy 2022, 24, 362. https://doi.org/10.3390/e24030362 https://www.mdpi.com/journal/entropy\nof piston motions here, but we will use optimal control theory to obtain a more general solution of the optimal control problem. To this end we apply an indirect iterative gradient method [11] that exploits limit cycles in the state and costate problems to solve them for periodic boundary conditions. In order to make such optimizations feasible, models with few degrees of freedom and low numerical effort are required. Stirling engine models are often categorized as first, second, and third order [16,17]. Especially in the case of the more detailed third order models, relatively large numerical effort is typically connected to the description of the regenerator. Therefore, several attempts [10,11,18,19] have been made to develop reduced-order regenerator models that constitute proper tradeoffs between accuracy and numerical effort for optimal control problems. In the current study we use an ideal regenerator model [12] that is based on Endoreversible Thermodynamics. This model does not require additional differential equations to describe the regenerator dynamics. Instead, the regenerator is described as an endoreversible engine that instantaneously balances fluxes of particles, energy, and entropy. Hence, this model allows for a very-low-effort Stirling engine description including finite heat transfer between the working gas and the external heat baths, finite mass transfer through the regenerator as well as friction of the pistons."
        },
        {
            "heading": "2. Stirling Engine Model",
            "text": ""
        },
        {
            "heading": "2.1. Endoreversible Notation",
            "text": "Endoreversible Thermodynamics [20,21] is a sub-field of finite-time thermodynamics [22\u201326]. Generally, the common goal is to develop models that incorporate the system\u2019s most dominant loss phenomena for describing performance features more accurately than reversible models. The focus typically is on providing models that can be solved either analytically or with low numerical effort so as to facilitate optimizations, obtain general results, and understand the overall irreversible system behavior. The application of finitetime thermodynamics is by no means restricted to heat engines and refrigerators [27\u201335], but various kinds of systems [36\u201344] can be considered. In the endoreversible approach, physical systems are described as networks of reversible subsystems, which exchange extensities (entropy, volume, particles, . . . ) and energy through reversible or irreversible interactions. Hence, in endoreversible modeling all irreversibilities are typically captured by the interactions whereas the subsystems can be described with the convenient tools of equilibrium thermodynamics. The most basic kinds of subsystems are (in-)finite reservoirs that contain extensities on the one hand, and engines, which represent ideal energy conversion devices, on the other. A finite reservoir i is characterized by a state function E(X\u03b1i ) that determines its energy content depending on the amount of the extensities X\u03b1i contained in the reservoir. Here, the superscript \u03b1 specifies the extensity, e.g., entropy Si = X S i , volume Vi = X V i , and particle number ni = X n i . The corresponding intensity Y \u03b1 i follows as\nY\u03b1i = \u2202Ei(X\n\u03b1 i )\n\u2202X\u03b1i , (1)\nwhere YSi = Ti is the temperature, 9Y V i = pi is the pressure, and Y n i = \u00b5i is the chemical potential of the reservoir. When it comes to specifying the state of the finite reservoir one has some freedom in the choice of state variables. One way is to specify all extensities. The reservoir can have one or several contact points r, to each of which one interaction is attached. Through these interactions, the reservoir can take up or release extensities. According to the Gibbs relation every extensity flux J\u03b1i,r that enters (J \u03b1 i,r > 0) or leaves (J\u03b1i,r < 0) the reservoir at r carries an energy flux I \u03b1 i,r = Y \u03b1 i J \u03b1 i,r. If the interaction involves several extensity fluxes (see multi-extensity fluxes [39]) then the overall energy flux at r is Ii,r = \u2211\u03b1 I \u03b1 i,r.\nThe dynamics of the finite reservoir can then for example be defined by a number of ordinary differential equations (ODEs), each describing the balance equation for one of the respective extensities\nX\u0307\u03b1i = \u2211 r J\u03b1i,r. (2)\nIn contrast, if the reservoir is considered as infinite, it is characterized by prescribing the full set of intensities Y\u03b1i , which do not change\u2014regardless of the size of the extensity fluxes J\u03b1i,r. As stated above, engines represent energy conversion devices. They can either operate cyclically or continuously, where we solely consider the latter here. They do not contain extensities and energy but only pass them on. Correspondingly, engines are characterized by a set of balance equations for all extensities and energy:\n0 = \u2211 r J\u03b1i,r, (3)\n0 = \u2211 r \u2211 \u03b1 Y\u03b1i,r J \u03b1 i,r. (4)\nWhile the intensity values are equal at all contact points of a reservoir, with engines the intensity values generally differ from contact point to contact point so that all these balance equations are fulfilled. Interactions are the modeling objects in Endoreversible Thermodynamics which generally capture all irreversibilities. They are characterized by balance equations for the extensities and energy, as well as by transfer laws. We will here only consider bilateral interactions that connect two subsystems. A bilateral interaction is reversible if and only if the intensity values are equal at the two connected contact points. This is achievable with infinitely fast transfer laws, making sure that small intensity differences are balanced instantaneously. If the transfer laws are finite, the system might evolve in a way such that the intensity values at the bilateral interaction\u2019s two contact points deviate. Then the interaction becomes irreversible: now energy and all extensities but entropy are conserved in it. Any proper definition of transfer laws must assure that entropy can only be produced and never annihilated."
        },
        {
            "heading": "2.2. State Dynamics",
            "text": "The state dynamics of the endoreversible Stirling engine model is characterized by six coupled ODEs describing the dynamics of the working space volumes, particle numbers, and entropies:\nV\u03071 = \u03bdV \u03c4 (u1(t)\u2212V1) , V\u03072 = \u03bdV \u03c4 (u2(t)\u2212V2) , (5) n\u03071 = \u03b1(p2 \u2212 p1) + ntot \u2212 n1 \u2212 n2\n\u03bdn \u03c4 , n\u03072 = \u03b1(p1 \u2212 p2) + ntot \u2212 n1 \u2212 n2 \u03bdn \u03c4 , (6)\nS\u03071 = \u03ba(TH \u2212 T1)/T1 + S1 n1 n\u03071 , S\u03072 = \u03ba(TC \u2212 T2)/T2 + S2 n2 n\u03072 , (7)\nwhere 1 refers to the hot working space, 2 to the cold working space, H to the hot heat bath and C to the cold heat bath, as indicated in Figure 1. The heat bath temperatures are defined as TH = 400 K and TC = 300 K. The volume dynamics from Equation (5) is defined dependent on prescribed periodic control functions ui(t), i \u2208 {1, 2}. Here, \u03bdV is a large number (where we will use \u03bdV = 500) and \u03c4 is the cycle time. This volume dynamics is similar to an over-damped mass-springsystem with moving spring support. If \u03bdV (the \u201cspring constant\u201d) is chosen large, then Vi(t) will approach ui(t) for t\u2192 \u221e. This indirect way of controlling the volume through ui(t) allows the dynamics to approach the limit cycle independent from the chosen initial value for the volume.\nThe particle dynamics from Equation (6) essentially features two terms. The first term \u03b1(pj \u2212 pi) describes a pressure driven particle flux between the two working spaces i and j, where \u03b1 is a particle transfer coefficient. The second term was added in the current model to make sure that the particle dynamics features a limit cycle, which is essential for the application of the indirect optimization algorithm used in this study and\u2014as above\u2014gives freedom in choosing the initial values for the particle numbers. Here, ntot and \u03bdn are fixed parameters, where we will use ntot = 1 mol and \u03bdn = 20. For t \u2192 \u221e, n1 + n2 \u2192 ntot and then this term becomes an additive zero. The entropy dynamics from Equation (7) is the very same as in [12]. It also features two terms, the first one describing heat transfer from or to the corresponding external heat bath with the heat transfer coefficient \u03ba and the second one describing reversible entropy exchange with the ideal endoreversible regenerator.\nThe intensities in the two working spaces i \u2208 {1, 2} can be calculated as [12]:\nTi =\n( R T1+c\u0302V0\np0\nni Vi\ne ( Si ni R \u2212 S0n0 R )) 1c\u0302V , (8)\npi = ni R Vi Ti , (9)\n\u00b5i = ( c\u0302V R + R\u2212\nSi ni\n) Ti , (10)\nwhere we use c\u0302V = 5/2 for the dimensionless specific heat capacity, R is the ideal gas constant and S0/n0 is the working gas\u2019s molar entropy at reference conditions T0 and p0. Corresponding data can for example be found in [45]. In fact, apart from constant shifts in the entropies, the system dynamics is not influenced by the definition of this reference entropy. Hence we refrain from giving values here. Note that even though Equations (5)\u2013(10) describe the complete system dynamics, additional care has to be taken regarding the evaluation of output quantities like mechanical\npower. This is due to the use of the ideal endoreversible regenerator model and will be addressed next."
        },
        {
            "heading": "2.3. Performance Measures",
            "text": "As displayed in Figure 1, the ideal endoreversible regenerator is represented by the engine R. This engine has interactions with the working spaces 1 and 2. Moreover, in order to allow for the instantaneous balancing of energy and entropy fluxes that enter or exit R at the corresponding contact points, R is given additional interactions to a heat bath SR and a work reservoir WR. The heat bath SR is chosen to have the cold heat bath\u2019s temperature TC. Then from the energy and entropy balances follows that\nJSSR,R = 9J S 1,R \u2212 J S 2,R (11)\nand PR = 9T1 J S 1,R \u2212 \u00b51 J n 1,R \u2212 T2 J S 2,R \u2212 \u00b52 J n 2,R \u2212 TC J S SR,R . (12)\nIn this rather simple, ideal endoreversible regenerator model the integral surplus or deficit of the energy \u222b \u03c4 0 PR dt is then assumed to enter the overall work output:\nWout = \u222b \u03c4\n0 p1V\u03071 + p2V\u03072 \u2212 \u03b2\n( V\u030721 + V\u0307 2 2 ) + PR dt. (13)\nHere, \u03b2 is the friction coefficient of the pistons. Correspondingly, the average net power output of the Stirling engine is Pout = Wout/\u03c4. The heat taken from the hot heat bath during one cycle is\nQin = \u222b t0\n0 \u03ba(TH \u2212 T1)dt (14)\nand the efficiency of the Stirling engine results as \u03b7 = Wout/Qin. Note that detailed analyses of Stirling engines, as necessary during design development, require more detailed regenerator models than the ideal endoreversible regenerator model used here. Nevertheless, this model is considered useful when the behavior of regenerative systems is studied in a rather general manner, as it is the case here, and if additionally very low numerical effort is a key requirement."
        },
        {
            "heading": "3. Optimization",
            "text": "In this study we revisit a previous work [12] where we used a parametric optimization method to optimize the piston motion of the Stirling engine described above. This parametric optimization leads to a power-optimal piston motion that we will refer to as OS motion. In the following we will briefly introduce this parametric optimization method. Afterwards, we will describe the optimization method based on Optimal Control Theory, which we use in the present study to obtain a more general optimization result labeled COC motion."
        },
        {
            "heading": "3.1. Parametric Optimization (OS Motion)",
            "text": "In the study mentioned above [12] the piston motion of the alpha-Stirling engine was parametrized by the following function:\nVi(t) = Vmin + (Vmax \u2212Vmin) f (t/\u03c4, \u03c3i, \u03b4i), (15)\nf (t/\u03c4, \u03c3, \u03b4) = f1( f2(t/\u03c4, \u03c3), \u03b4), (16)\nf1(y, \u03c3) = (sin(2\u03c0y + \u03c3 sin(4\u03c0y)) + 1)/2, (17)\nf2(x, \u03b4) = x + \u03b4(1\u2212 cos(2\u03c0x)). (18)\nThis motion is dependent on the two parameters \u03c3 and \u03b4 which can be different for the two cylinders of the engine, hence we have \u03c3i, \u03b4i with i = 1, 2. The state dynamics\u2014and\nconsequently the power output\u2014is thus influenced by the parameters \u03c3i, \u03b4i. Then, using an iterative optimization algorithm \u03c3i, \u03b4i are adapted to maximize the power output. The resulting piston motion we refer to as OS motion. For more details see [12]. Note however that even though the OS motion might capture important features of the fully optimized motion, the possible shapes, which can be realized with this parametric approach, are quite limited. For example, the swept volume (Vmax \u2212Vmin) was not part of the optimization in [12]. Thus, it must be expected that the optimal power output obtained with the OS motion can be outmatched by using a more general parametrization Vi(t). In this study we will use Optimal Control Theory to optimize the piston motion, which will be described below. It does not require any kind of parametrization of the piston motion and will thus lead to a more general optimization result."
        },
        {
            "heading": "3.2. Optimal Control Theory (COC Motion)",
            "text": "The working volumes of the Stirling engine are here considered to result from \u03c4periodic control functions ui(t), i \u2208 {1, 2} in terms of differential equations:\nV\u0307i = \u03bdV \u03c4 (ui(t)\u2212Vi), (19)\nas described in Section 2.2. Now, for prescribed cycle time \u03c4, our goal is to choose ui(t) in a way such that the work output Wout is maximized for the solution of the system of ODEs\nx\u0307 = f (x, u) (20)\nin the time domain t \u2208 [0, \u03c4] under periodic boundary conditions: x(0) = x(\u03c4). Here, we use the following definitions of the state vector x := (V1, V2, n1, n2, S1, S2)\nT and the control vector u := (u1(t), u2(t))\nT as well as the state dynamics f defined as a vector function of the latter according to Equations (5)\u2013(10). This constitutes a cyclic optimal control problem. To set up the necessary conditions of optimality, we define the Hamilton function:\nH := \u03b6 + \u03bbT f (x, u), (21)\nwhere \u03bb is a costate vector and \u03b6 is the path target function:\n\u03b6 := p1V\u03071 + p2V\u03072 \u2212 \u03b2 ( V\u030721 + V\u0307 2 2 ) + PR \u2212 pen(V1, V2). (22)\nThis is in accordance with the definition of the overall work output from Equation (13). However, here a penalty term was added in order to account for minimum and maximum volume constraints:\npen(V1, V2) := \u03bdp0\n( e\u03bdp1 Vmin\u2212V1 \u2206V + e\u03bdp1 V1\u2212Vmax \u2206V + e\u03bdp1 Vmin\u2212V2 \u2206V + e\u03bdp1 V2\u2212Vmax \u2206V ) , (23)\nwhere the prefactors are defined as \u03bdp0 = 1 W and \u03bdp1 = 500, the maximum admissible swept volume is \u2206V = Vmax \u2212Vmin, and the minimum and maximum volumes are Vmin = 1 L and Vmax = 11 L, respectively. The actual swept volume \u2206VCOC that the optimized piston paths of the COC motion involve may also turn out to be smaller than \u2206V, as will be seen later.\nThen the first order necessary conditions of optimality are [46,47]:\nx\u0307 =\u2207\u03bbH , (24) \u03bb\u0307 =\u2212\u2207xH , (25) 0 =\u2207u H . (26)\nEquations (24)\u2013(26) need to be solved for periodic boundary conditions for both the state and the costate variables: x(0) = x(\u03c4), \u03bb(0) = \u03bb(\u03c4). This is here done with an indirect iterative gradient method described in [11], which exploits the existence of attractive and repulsive limit cycles in the state problem (Equation (24)) and the costate problem (Equation (25)) for obtaining the periodic solutions."
        },
        {
            "heading": "4. Results",
            "text": "In [12] the Stirling engine piston motion was power-optimized for a parameterized class of smooth piston motions. The optimized piston motion is referred to as OS, whereas the \u201cstandard harmonic piston motion\u201d with Vmin = 1 L, Vmax = 11 L and 90\u00b0 phase shift is referred to as STD and used as a benchmark. The alpha-Stirling engine model introduced in Section 2 is equivalent to that used in [12]. However, in the current study additional care was taken to make sure that the system dynamics feature a limit cycle in order to allow for the application of the abovementioned optimization method. The following set of parameter values we will refer to as \u201creference values\u201d in this study: \u03b20 = 10 5 Js/m6, \u03b10 = 100 mol/(s bar), \u03ba0 = 10 5 W/K, \u03c40 = 1 s. Here, the values \u03b10 and \u03ba0 were chosen so that the associated pressures and temperatures equilibrate very fast compared to the cycle time \u03c40. Correspondingly, the associated irreversibilities are relatively small. Hence, apart from the friction irreversibility the model can be considered near-ideal. The results obtained for these values are called \u201creference case\u201d. The piston motions obtained with the cyclic optimal control algorithm described in Section 3.2 will be referred to as the COC motion. In the following, we will compare it to the STD motion as well as the OS motion from [12]. In Figure 2 the volumes of the working spaces are plotted against time for the reference case. The STD motion is represented by dotted lines, the OS motion by dashed lines, and the COC motion by solid lines. The red lines represent the hot working space and the blue lines the cold working space. It can be seen that there are considerable deviations between all three types of piston motions. However, the OS and the COC motion do have in common that the pistons tend to spend more time close to their bottom and top dead centers than with the STD motion. Consequently, the average piston velocities are increased compared to the STD motion. The highest piston velocity occurs for the OS motion. For the COC motion the maximum piston velocity is lower but the velocity is almost constant during four clearly distinguishable strokes. This leads to large accelerations at the transitions between those strokes, especially at t/\u03c4 \u2248 5/8. This is connected to the fact that the path target function used here does contain friction as a function of the velocity (via V\u0307i), whereas it does not contain the acceleration (via V\u0308i) and thus there is no penalty on fast accelerations. We will come back to this sharp transition later.\nThe overall gas volume V1+2 := V1 + V2 is depicted in Figure 3 for all three types of piston motions by black curves. The cold working volume is again shown by blue lines. As indicated above, apart from the moderate irreversibility due to friction, the reference values lead to a near-ideal thermodynamic model. It is interesting that for the considered friction law and volume constraints corresponding to an alpha-type Stirling configuration, the COC motion does not contain isochoric strokes\u2013in contrast to the ideal Stirling cycle. Instead, the overall gas volume V1+2 changes with approximately constant absolute rate during almost the whole cycle, in order to minimize frictional losses. This may be different for beta- or gamma-Stirling configurations.\nIn Figure 4 the gas pressures in the working spaces are plotted against time for the reference case. The STD motion is represented by dotted lines, the OS motion by dashed lines, and the COC motion by solid lines. The red lines represent the hot working space and the blue lines the cold working space. Note that in this figure the blue lines lie on top of the respective red lines since there are only very small pressure differences between the two working spaces. This is due to the choice of a relatively large parameter value for the mass transfer coefficient \u03b1 = \u03b10. The optimizations raise the overall difference between the minimum and maximum cycle pressures. While the minimum pressure values approximately remain the same, the OS and COC motions lead to much higher maximum pressures than the STD motion. For the COC motion the pressure curves are much more peak-shaped than for the OS motion and their maximum values are about 18% higher than that of the OS motion. With the COC motion the pressure peak occurs at the minimum of the overall gas volume V1+2 at t/\u03c4 \u2248 5/8, which is much lower for COC than for OS, as can be seen in Figure 3. Obviously, the shape and maximum value of that peak strongly depend on the volume constraints. In the following we will discuss the influence of friction on the optimal piston motion and the resulting performance measures. As can be seen in Equations (13) and (22), friction is in this work modeled depending on the piston velocity in terms of \u03b2 V\u03072i with the friction coefficient \u03b2. We repeated the optimization for varying \u03b2. Here, we chose a range with \u03b2 \u2265 0.5\u00d7 105 Js/m6 (for the computation of the COC motions) since for very small friction the tendency to perform more than one reciprocating piston movement in the prescribed time period grows. Correspondingly, by choosing \u03b2 large enough as to prevent additional reciprocating movements, the results for the COC motion remain comparable to those for the STD and OS motions.\nIn Figure 5 the volumes of the working spaces of the COC motion are plotted against time for varying friction coefficient \u03b2. The hot working space is represented by solid lines, the cold working space by dotted lines. Obviously, for the increasing friction coefficient the piston\u2019s dwell times at the bottom dead center (maximum volume) reduce and above \u03b2 \u2248 2\u00d7 105 Js/m6, the curves eventually detach from the maximum volume bounds. At the highest considered value of \u03b2 = 8\u00d7 105 Js/m6, the swept volumes have reduced to about one half of the available volume. In contrast, the piston\u2019s dwell times at the top dead center (minimum volume) are only slightly reduced for increasing \u03b2. Remarkably, the sharp edge at t/\u03c4 \u2248 5/8 is not affected by increasing friction. Only the absolute values of the curvature around the volume maximums (bottom dead centers) become smaller and smaller. This behavior can be related to the path target function from Equation (22): The volumes are kept minimal as to decrease the effective dead volume and increase the pressure in the engine and thus the indicated work, which leads to the sharp edge at t/\u03c4 \u2248 5/8. On the other hand as friction becomes more dominant the quadratic average of the piston speeds (translating to friction) are reduced while trying to achieve swept volumes (indicated work) as high as possible. This results in the rounded volume maxima.\nFrom the temporal evolution of the state variables, the work output per cycle Wout is determined by integration, as defined in Equation (13). The cycle-averaged power output follows as Pout = Wout/\u03c4. In Figure 6 the average power output Pout of the Stirling engine is plotted against the friction coefficient \u03b2 for the STD, OS, and COC piston motions. For low friction coefficient the COC motion leads to about 10% power gain relative to the OS motion. For higher values of \u03b2 the power gain due to the COC motion becomes much larger than that of the OS motion. This is connected to different effects:\n\u2022 STD motion: As \u03b2 is increased for fixed piston motion, frictional losses increase linearly with \u03b2. Therefore, the average power output Pout decreases linearly with \u03b2. \u2022 OS motion: As \u03b2 changes, the piston motion adapts. Therefore, the average power output Pout decreases non-linearly with \u03b2. However, since the actual swept volume is fixed to the maximum admissible swept volume \u2206V, the net power output Pout decays at least with a rate of \u22122(2 \u2206V/\u03c4)2. This follows from Equation (13) for the pistons moving according to a triangle wave with V\u0307i = \u00b1(2 \u2206V/\u03c4). \u2022 COC motion: As \u03b2 changes, the piston motion adapts not only in its shape, but also in its actual swept volume \u2206VCOC. This can be seen in Figure 5. Starting from \u03b2 \u2248 2 the actual swept volume \u2206VCOC continuously decreases as \u03b2 is increased. Therefore, now the lower bound for the rate of decay of Pout is only \u22122(2 \u2206VCOC/\u03c4)\n2, which quadratically reduces with \u2206VCOC. Correspondingly, it can be seen in Figure 6 that the decay of Pout with increasing \u03b2 is much slower for the COC motion.\nTo make the latter point clearer we plot the optimization result of the COC motion already shown in Figure 6 (black line) against both the friction coefficient \u03b2 and the actual swept volume (of the cold piston) in Figure 7. The COC motion is here represented by the thick black line. The color surface apart from that line was obtained by varying \u03b2, while leaving the swept volume and the shape of the piston motion fixed. That is, in Figure 7 the swept volume is a proxy for the shape of the piston motion according to Figure 5. It can be seen that, starting in the upper corner, the net power output is reduced by both increasing the friction coefficient and decreasing the swept volume. If the swept volume is held constant as \u03b2 is increased, the decay of net power is very strong, not unlike it happens for the STD and OS motions. The COC motion (thick black line), however, avoids this strong decrease by reducing the swept volume for larger \u03b2. The influence of the friction coefficient \u03b2 on the Stirling engine\u2019s efficiency is shown in Figure 8. For small \u03b2 the efficiency approaches a value of 0.25 for all piston motions, which corresponds to Carnot efficiency. This is because the reference values \u03ba0 and \u03b10 of the heat and mass transfer coefficients were chosen relatively large, so that the corresponding irreversibilities are negligible.\nThe optimizations of the piston motion were performed for the target function being the power output in both cases, with the OS and the COC motion. Therefore, the efficiency resulting from the optimized motions will not necessarily be lager than that of the STD motion. In fact, for the OS motion it can be observed that its efficiency goes below that of the STD motion for \u03b2 below about 2.1\u00d7 105 Js/m6. For the COC motion this does not occur in the considered range with \u03b2 \u2265 0.5\u00d7 105 Js/m6. For large \u03b2 both, the OS and the COC motion lead to increased efficiency. However, the efficiency increase due to the COC motion is much more significant, which is again partially related to the reduction in the swept volumes."
        },
        {
            "heading": "5. Conclusions",
            "text": "In this study we applied cyclic optimal control theory to power-optimize the piston motion of an alpha-Stirling engine with dominating mechanical friction irreversibility. The\nunderlying endoreversible Stirling engine model additionally takes finite heat and mass transfer into account. However, we here used large transfer coefficients so that, apart from friction, a near-ideal thermodynamic model was obtained. The optimizations were repeated for the varying friction coefficient. The results for the optimized piston motions (COC) were compared to results of a previous study [12], where parameterized piston motions had been optimized (OS). Moreover, harmonic piston motions (STD) were resorted to as a benchmark. The optimized piston motions OS and COC lead to increased pressure variations during the cycle, which bring about significant gains in power. The COC motion obtained with cyclic optimal control theory in the current study, outmatches the OS motion from [12] regarding both power and efficiency. This especially holds true for high values of the friction coefficient. However, in the COC motion considerably higher accelerations of the pistons occur. This is connected to the used definition of frictional losses involving only the piston velocities, not accelerations. An interesting result is that for given engine parameters, there is a certain swept volume for which net power becomes optimal. Increasing swept volume beyond this value would result in reduction of net power. Moreover, it was shown that for the considered friction law and volume constraints corresponding to an alpha-Stirling configuration, the COC motion does not contain isochoric strokes, which is in contrast to the ideal Stirling cycle. For other Stirling configurations this might however be different. For more detailed analyses, as required in engineering, additional subsystems as well as transfer and friction laws describing a specific Stirling engine design can be included in the model. Moreover, in this case a more detailed irreversible regenerator model should be used. A low-order endoreversible regenerator model developed for this purpose is, for example, described, numerically validated and applied in [11].\nAuthor Contributions: Investigation, R.P., A.K., A.F., R.M. and K.H.H. All authors have read and agreed to the published version of the manuscript.\nFunding: Funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) project number 491193532 and Chemnitz University of Technology.\nConflicts of Interest: The authors declare no conflict of interest."
        }
    ],
    "title": "Power-Optimal Control of a Stirling Engine's Frictional Piston Motion",
    "year": 2022
}