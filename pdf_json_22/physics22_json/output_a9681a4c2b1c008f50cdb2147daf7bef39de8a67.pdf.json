{
    "abstractText": "We propose a divide-and-conquer algorithm to find recursively the Scattering matrix of general tight-binding structures. The Scattering matrix allows a direct calculation of transport properties in mesoscopic systems by using the Landauer formula. The method is exact, and by analyzing the performance of the algorithm in square, triangular and honeycomb lattices, we show a significant improvement in comparison to other state-of-the-art recursive and non-recursive methods.",
    "authors": [
        {
            "affiliations": [],
            "name": "Mauricio J. Rodr\u00edguez"
        },
        {
            "affiliations": [],
            "name": "Carlos Ram\u00edrez"
        }
    ],
    "id": "SP:61549916ecc24086f232910ff2954db66151dc8d",
    "references": [
        {
            "authors": [
                "J. Taylor",
                "H. Guo",
                "J. Wang"
            ],
            "title": "Ab initio modeling of quantum transport properties of molecular electronic devices",
            "venue": "Phys. Rev. B. 63 ",
            "year": 2001
        },
        {
            "authors": [
                "S. Tang"
            ],
            "title": "Inferring the energy sensitivity and band gap of electronic transport in a network of carbon nanotubes",
            "venue": "Sci. Rep. 12 ",
            "year": 2022
        },
        {
            "authors": [
                "M. Wencka",
                "M. Krnel",
                "A. Jelen",
                "S. Vrtnik",
                "J. Luzar",
                "P. Ko\u017eelj",
                "D. Ga\u010dnik",
                "A. Meden",
                "Q. Hu",
                "C. Wang",
                "S. Guo"
            ],
            "title": "J",
            "venue": "Dolin\u0161ek, Electronic transport properties of the Al0.5TiZrPdCuNi alloy in the high-entropy alloy and metallic glass forms, Sci. Rep. 12 ",
            "year": 2022
        },
        {
            "authors": [
                "H. Zhu",
                "T. Zhang",
                "Q. Wei",
                "S. Yu",
                "H. Gao",
                "P. Guo",
                "J. Li",
                "Y. Wang"
            ],
            "title": "Preparation of TiO2 electron transport layer by magnetron sputtering and its effect on the properties of perovskite solar cells",
            "venue": "Energy Reports. 8 ",
            "year": 2022
        },
        {
            "authors": [
                "S. Datta"
            ],
            "title": "Electronic Transport in Mesoscopic Systems",
            "venue": "Cambridge University Press",
            "year": 1995
        },
        {
            "authors": [
                "D. Ryndyk"
            ],
            "title": "Theory of Quantum Transport at Nanoscale",
            "venue": "Springer International Publishing, Cham",
            "year": 2016
        },
        {
            "authors": [
                "F. Sols"
            ],
            "title": "Recursive Tight-Binding Green\u2019s Function Method: Application to Ballistic and Dissipative Transport in Semiconductor Nanostructures",
            "year": 1995
        },
        {
            "authors": [
                "C. Ram\u00edrez",
                "L.A. Medina-Amayo"
            ],
            "title": "Scattering matrix of arbitrary tight-binding Hamiltonians",
            "venue": "Ann. Phys. (N. Y). 378 ",
            "year": 2017
        },
        {
            "authors": [
                "K. Kazymyrenko",
                "X. Waintal"
            ],
            "title": "Knitting algorithm for calculating Green functions in quantum systems",
            "venue": "Phys. Rev. B. 77 ",
            "year": 2008
        },
        {
            "authors": [
                "D. Mencarelli",
                "T. Rozzi",
                "L. Pierantoni"
            ],
            "title": "Scattering matrix approach to multichannel transport in many lead graphene nanoribbons",
            "venue": "Nanotechnology. 21 ",
            "year": 2010
        },
        {
            "authors": [
                "J.A. Torres",
                "J.J. S\u00e1enz"
            ],
            "title": "Improved Generalized Scattering Matrix Method: Conduction through Ballistic Nanowires",
            "venue": "J. Phys. Soc. Japan. 73 ",
            "year": 2004
        },
        {
            "authors": [
                "X. Mei",
                "Z. Wu"
            ],
            "title": "Electron transport properties of nanomaterials based on recursive Green\u2019s function method",
            "venue": "Funct. Mater. 26 ",
            "year": 2019
        },
        {
            "authors": [
                "C.V. Morfonios"
            ],
            "title": "P",
            "venue": "Schmelcher, Control of Magnetotransport in Quantum Billiards",
            "year": 2017
        },
        {
            "authors": [
                "M. Puschmann",
                "T. Vojta"
            ],
            "title": "Green\u2019s functions on a renormalized lattice: An improved method for the integer quantum Hall transition",
            "venue": "Ann. Phys. (N. Y). 435 ",
            "year": 2021
        },
        {
            "authors": [
                "L.R.F. Lima",
                "A. Dusko",
                "C. Lewenkopf"
            ],
            "title": "Efficient method for computing the electronic transport properties of a multiterminal system",
            "venue": "Phys. Rev. B. 97 ",
            "year": 2018
        },
        {
            "authors": [
                "T.P. Santos",
                "L.R.F. Lima",
                "C.H. Lewenkopf"
            ],
            "title": "An order N numerical method to efficiently calculate the transport properties of large systems: An algorithm optimized for sparse linear solvers",
            "venue": "J. Comput. Phys. 394 ",
            "year": 2019
        },
        {
            "authors": [
                "G. Thorgilsson",
                "G. Viktorsson",
                "S.I. Erlingsson"
            ],
            "title": "Recursive Green\u2019s function method for multi-terminal nanostructures",
            "venue": "J. Comput. Phys. 261 ",
            "year": 2014
        },
        {
            "authors": [
                "C.W. Groth",
                "M. Wimmer",
                "A.R. Akhmerov",
                "X. Waintal"
            ],
            "title": "Kwant: A software package for quantum transport",
            "venue": "New J. Phys. 16 ",
            "year": 2014
        },
        {
            "authors": [
                "C. Ram\u00edrez",
                "L.A. Medina-Amayo"
            ],
            "title": "Scattering matrix of arbitrary tight-binding Hamiltonians",
            "venue": "Ann. Phys. (N. Y). 378 ",
            "year": 2017
        },
        {
            "authors": [
                "C. Ram\u00edrez"
            ],
            "title": "Determining Transport Properties of Complex Multiterminal Systems: S- Matrix of General Tight-Binding Periodic Leads",
            "venue": "Ann. Phys. 530 ",
            "year": 2018
        },
        {
            "authors": [
                "C. Ram\u00edrez",
                "M.J. Rodr\u00edguez",
                "B.D. Gomez"
            ],
            "title": "Taylor series of Landauer conductance",
            "venue": "Phys. E Low-Dimensional Syst. Nanostructures. 124 ",
            "year": 2020
        }
    ],
    "sections": [
        {
            "text": "of general tight-binding structures. The Scattering matrix allows a direct calculation of transport properties in mesoscopic systems by using the Landauer formula. The method is exact, and by analyzing the performance of the algorithm in square, triangular and honeycomb lattices, we show a significant improvement in comparison to other state-of-the-art recursive and non-recursive methods.\nKEYWORDS: Quantum transport; Landauer conductance; scattering matrix; recursive methods; divide-and-conquer algorithm."
        },
        {
            "heading": "1. Introduction",
            "text": "Quantum transport is a wide field of study[1\u20134] for which there exist plenty of recursive methods to study it within the tight-binding approximation.[5\u201314] These methods are useful to calculate the Green\u2019s function, the transfer matrix, or the scattering matrix (S-matrix) of the system, which then\ncan be used to obtain the transmission function ( )T E at energy E .[5,6] The conductance G of a\nnanoscale conductor is given in terms of the transmission function, as stated by the celebrated Landauer formula,[5,6]\n( ) ( ) 2\nF F\ne G E T E\n = , (1)\nwhere FE is the Fermi energy. The transmission function depends strongly on the presence of impurities and defects, the geometry, and the lattice of the systems.\nRealistic systems consist of a large number of sites, therefore computational efficiency is\nan essential part of the recursive methods.[15,16] The transfer matrix can be found by multiplying transfer matrices of slices of the system. This simplicity of operations makes this method preferable, however, it is required that each slice connects to the same number of sites on the left as on the right, which restricts the kind of systems that can be addressed with transfer matrices. On the other hand, Green\u2019s function recursive methods are based on the Dyson equation[6,13] that relates the Green\u2019s function of a system to one with additional adjacent sites. Each iteration involves the inversion of a M M matrix, where M is the number of new sites. In the knitting algoritm[9] sites are added one by one, then this inversion is made on a scalar quantity. The circular slicing algorithm[17] adds groups of sites into rectangular slices which leads to a block tridiagonal Hamiltonian, which is convenient for the recursive method. In addition, an adaptative slicing scheme[15] has been proposed where the first sites to consider are those next to the leads, followed by their first neighbors, then the second neighbors, etc., also leading to a block tridiagonal Hamiltonian. For the case of a square lattice of L L sites, the time required to calculate the conductance using these methods scales as ( )4L , being an important improvement in comparison\nto the direct method, where a 2 2L L matrix is inverted, which scales as ( )6L . However, for\ntight-binding structures, almost all elements of the Hamiltonian matrix are zero, therefore it is sparse. By using numerical methods suitable for sparse matrices, it has been reported[18] that for\n310L the computational times scales as ( )3L . But the performance in the memory usage is\nstill better for recursive methods.\nIn the following, we present a divide-and-conquer algorithm based on the recursive\nscattering matrix method and we compare its computational efficiency with that of the transfer matrix method for increasingly larger scattering regions"
        },
        {
            "heading": "2. Recursive Scattering Matrix Method",
            "text": "The recursive S-matrix method (RSMM) allows us to compute the S-matrix of any tight-binding system by using the S-matrices of its subsystems.[19] Building blocks consist of a scattering region connected to auxiliary atomic chains (blue dash-dot-dash lines), as shown in Fig 1. Solutions in the auxiliary chains takes the form of incoming and outgoing waves. The S-matrix relates the amplitude coefficient of such waves, encoding all the effects of the scattering region on its surroundings. The essence of the RSMM is to set the first N incoming (outgoing) amplitude coefficients of a block A equal to the first N outgoing (incoming) amplitude coefficients of a block B . In this process, the corresponding auxiliary chains are removed, while the sites connected to these chains in each block overlap, adding their site-energies and hopping integrals. For example, in Fig. 1 the RSMM is used to obtain block C , whose S-matrix becomes\n( ) ( )\n( ) ( )\n1 1\n22 21 11 11 11 12 21 11 11 12\n1 1\n21 11 11 12 22 21 11 11 11 12\nA A B A B A A B A B\nC\nB A B A B B A B A B\n\u2212 \u2212\n\u2212 \u2212  + \u2212 \u2212  =  \n\u2212 + \u2212  \nS S I S S S S S I S S S S\nS I S S S S S I S S S S\n(2)\nbeing , A i jS and , B i jS submatrices of the S-matrices of blocks A and B , respectively, such that 1,1 A S and 1,1 B S are N N matrices. It is worth to mention that the S-matrix of an arbitrary tight-binding\nstructure can be computed starting from the S-matrices of the site and the bond building blocks, illustrated as blocks D and E in Fig. 1, whose S-matrices have a well-known analytic form.[19] The RSMM also allows to model multiterminal systems with general leads.[20] Moreover, an extension of the method gives us the exact order-N Taylor series of the S-matrix and of the transmission function.[21]\nFigure. 1. Examples of building blocks. S-matrix of block C can be obtained by using the RSMM on structures A and B with 2N = . D and E are the site and the bond building blocks.\nFollowing the same ideas than for the knitting algorithm, the RSMM can be run by adding\nsites one by one. In this scenario, computational time scales as ( )4O L for a square lattice with\nL L sites.[20] However, the RSMM allows other versatile ways to build up the system."
        },
        {
            "heading": "3. Divide-and-conquer algorithm",
            "text": "Our method is carried in a divide-and-conquer fashion as illustrated in Fig. 2. It consists in splitting the scattering region into two disconnected subregions, defining a block A. Hopping integrals that\nconnect these subregions form the block B. Observe that by using the RSMM with blocks A and B the original system is recovered. Now, each disconnected region in block A can be calculated independently by splitting again into two disconnected subregions, process that is repeated recursively until one reaches subregions that consist of only one site. Finally, one starts gluing together these regions using the RSMM and following the inverse order that was used to split them.\nFigure 2. Splitting of the scattering region into two disconnected subregions that define block A, while block B contains the bonds that join the subregions. Each subregion will be divided again into two subregions recursively until single site regions are reached.\nWe make the region\u2019s divisions by splitting in half along the horizontal or vertical direction\ndepending on which one is the largest, we do this as a rule of thumb. It is important to clarify that although in Fig. 2 we show a 10 10 square lattice attached to 1D chain leads, this is only an example, and this method is still appliable to an arbitrary shape of the scattering region, lattice,\nleads, hopping integrals and on-site energies. Furthermore, in case that all on-site energies are 0 and all hopping integrals are t then this symmetry allows us to only compute the S-matrix of equivalent regions once, which greatly decreases the computational time needed to calculate the S-matrix of the whole system. However, in this work we study the general case."
        },
        {
            "heading": "4. Performance of the divide-and-conquer algorithm",
            "text": "Now, to obtain an analytical estimation of the computational time required by this method,\nlet us consider a square lattice of L L sites. To determine the S-matrix of this system, first we have to calculate the S-matrices of four 2 2 L L subregions, and join them by applying Eq. (2) three times, where multiplications and inversions take a time that scales as ( )3L . Then, the time\nrequired to obtain the S-matrix of the L L structure, ( )t L , accomplish the following recursive\nformula,\n( ) ( ) 324 Lt L t L= + , (3)\nwhich leads us to,\n( ) ( ) ( ) 1 3 3\n2 2 0\n1 4 4 2\n2 N N\nN N NL L\nn n\nt L t L t L  \u2212\n=\n= +  + . (4)\nIf 2N L we reach the case were there is only one site per region. Therefore\n( ) 2 30 2t L t L L + , (5)\nwhere 0t is the time needed to compute the S-matrix of a site block, while 32 L is the time consuming during the whole gluing process through the RSMM. By comparing Eqs. (3) and (5) , notice that the total time consumed by this gluing process is about twice the time required by the last step, which has no effects on the scaling behavior.\nThe computational time required to calculate the conductance following the divide-and-\nconquer algorithm for a square lattice of L L sites as a function of L is shown in Fig. 3 with red squares. They fit onto the curve ( ) 2 3t L aL bL= + (red line) with 58.509 10a \u2212=  and\n83.046 10b \u2212=  . Observe that .b a To understand the effects of this inequality, let us consider the local scaling behavior by taking ( ) dt L cL= , where ( )d L is calculated by taking the derivative\nin logscale, obtaining that\nd log( ) 1 2 d log( )\n1\nt d\naL\nbL\n= = +\n+\n. (6)\nNote that for small L we get a local scaling of 2L , whereas for very large L it is of 3L , and the local scaling makes a soft transition between these two behaviors. For 1000L , the local scaling behavior goes as 2.26L , which represents an improvement in the performance of transport calculations. In terms of the total number of sites, 2N L= , this represents an almost ( )O N scaling\nfor 610N  sites, while keeping the calculations exact. On the other hand, for 2794L  one gets 2.5d  , which means that for approximately 8 million total sites our method scales like 2.5L , staying under the 3L mark of other state-of-the-art methods.\nFigure 3. Computational time to determine the conductance for a square (red squares), triangular (green triangles) and honeycomb (orange hexagons) lattices using the divide-and-conquer algorithm, and for a square lattice using the transfer matrix method (blue circles). The number of sites in each system is 2N L= . Lines correspond to fittings as detailed in the text.\nFor comparison, Fig. 3 also shows the time to find the conductance by using the transfer\nmatrix method (blue circles). Points for large L are fitted by 3.971L (blue line), with 91.517 10 \u2212=  . The very small value of  comes from the simplicity of operations, which makes the transfer matrix method faster than other recursive techniques. However, the divide-andconquer method has better performance when L is increased. Consequently, we observe that for\nL greater than 250 , computational time is improved by using the divide-and-conquer algorithm.\nAnd even for smaller systems, calculation time between both methods differ by less than one order\nof magnitude. However, the RSMM is not limited by the restrictions required in the transfer matrix method.\nTo explore the behavior of the divide-and-conquer algorithm with other lattices, Fig. 3\nfurther shows the computational times for squared areas of triangular (green triangles) and honeycomb lattices (orange hexagons). In these cases, L is related to the number of sites in the area by L N= . Computational times are fitted to ( ) 2 3t L aL bL= + , where 41.823 10a \u2212=  and\n71.513 10b \u2212=  for the triangular lattice (green line), while 55.662 10a \u2212=  and 81.236 10b \u2212=  for the honeycomb lattice (orange line). Notice that coefficients a and b are greater for the triangular lattice and smaller for the honeycomb lattice. This is expected given the nature of the RSMM, because matrices in Eq. (2) grow with the coordination number of the lattice. Beyond this, the scaling behavior is analogous to that of a square lattice, showing improved performance compared to other exact methods for calculating quantum transport properties.\nFinally, if we have a square lattice with L W sites, where W L , the divide-and-conquer\nalgorithm will leads us to calculate L W S-matrices of blocks of W W sites. Then the scaling of\nthe computational time goes as 2aLW bLW+ . Consequently, for fixed W , the divide-and-conquer algorithm is linear in L , which is on par with the other recursive methods."
        },
        {
            "heading": "5. Conclusions",
            "text": "In summary, we have developed a recursive divide-and-conquer algorithm to compute the\nS-matrix within the context of the RSMM, that allows us to address multiterminal tight-binding systems with general leads. For a square region with 2N L= sites, the computational time scales as ( )1 1.25N \u2212 for systems with 610N  sites, an almost linear scaling behavior on N . This is an\nimprovement to the ( )4L and ( )3L marks reported by other recursive and non-recursive state-\nof-the-art methods. Furthermore, the leading coefficients are small, so that even for small systems, the computational time difference between the transfer matrix method and the divide-and-conquer algorithm is less than an order of magnitude, while for 250L  , the latter has the better performance. The divide-and-conquer algorithm can be applied to scattering regions with general geometries and lattices, and its results are exact, since they do not add approximations beyond the tight-binding ones. Moreover, since each subregion is independent, their S-matrices can be calculated in parallel, which can make the algorithm even faster. We expect that this paper inspires a new generation of high-performance algorithms to study quantum transport properties in realsize systems.\nAUTHOR INFORMATION\nCorresponding Author\n*E-mail address: carlos@ciencias.unam.mx\nAuthor Contributions\nThe manuscript was written through contributions of all authors. All authors have given approval to the final version of the manuscript. Authors contributed equally."
        },
        {
            "heading": "ACKNOWLEDGMENT",
            "text": "This work has been supported by UNAM-DGAPA-PAPIIT IN109022. Computations were performed at Miztli under project LANCAD-UNAM-DGTIC-329."
        }
    ],
    "title": "Improved performance in quantum transport calculations: A divide-and-conquer method based on S-matrices",
    "year": 2022
}