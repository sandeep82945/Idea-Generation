{
    "authors": [
        {
            "affiliations": [],
            "name": "M. Prado Rodriguez"
        },
        {
            "affiliations": [],
            "name": "K. Hanson"
        }
    ],
    "id": "SP:9902eb11fb444ec3442c68f7e4272b50758530d6",
    "references": [],
    "sections": [
        {
            "text": "P o S ( I C R C 2 0 2 3 ) 1 1 2 9 P o S ( I C R C 2 0 2 3 ) 1 1 2 9\nThe IceCube Collaboration (a complete list of authors can be found at the end of the proceedings)\nE-mail: josh.peterson@icecube.wisc.edu, mvprado@icecube.wisc.edu, kael.hanson@wisc.edu\nIceCube DeepCore is an extension of the IceCube Neutrino Observatory designed to measure GeV scale atmospheric neutrino interactions for the purpose of neutrino oscillation studies. Distinguishing muon neutrinos from other flavors and reconstructing inelasticity are especially difficult tasks at GeV scale energies in IceCube DeepCore due to sparse instrumentation. Convolutional neural networks (CNNs) have been found to have better success at neutrino event reconstruction than conventional likelihood-based methods. In this contribution, we present a new CNN model that exploits time and depth translational symmetry in IceCube DeepCore data and present the model\u2019s performance, specifically for flavor identification and inelasticity reconstruction.\nCorresponding authors: J.H. Peterson1\u2217, M. Prado Rodriguez1, K. Hanson1 1 University of Wisconsin - Madison\n\u2217 Presenter\nThe 38th International Cosmic Ray Conference (ICRC2023) 26 July \u2013 3 August, 2023 Nagoya, Japan\n\u00a9 Copyright owned by the author(s) under the terms of the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License (CC BY-NC-ND 4.0). https://pos.sissa.it/\nP o S ( I C R C 2 0 2 3 ) 1 1 2 9 P o S ( I C R C 2 0 2 3 ) 1 1 2 9"
        },
        {
            "heading": "1. Introduction",
            "text": "The IceCube Neutrino Observatory is a neutrino detector located at the South Pole. When high energy neutrinos interact with the Antarctic ice they produce fast moving charged secondary particles that produce Cherenkov radiation. The IceCube detector consists of 86 strings of digital optical modules (DOMs) that detect this Cherenkov radiation [1]. IceCube DeepCore is an infill of the IceCube Neutrino Observatory that utilizes more densely instrumented strings to lower the energy threshold from hundreds of GeV to a few GeV [2]. Many of the IceCube experiment\u2019s physics goals require reconstructing observables such as neutrino direction, neutrino energy, and neutrino flavor.\nWhen a muon neutrino / antineutrino undergoes a charged current deep inelastic scattering it produces an energetic muon / antimuon that can travel a significant distance and produce a detectable track of light [3]. This is referred to as a track event. At lower energies, for neutral current deep inelastic scattering events, and for charged current deep inelastic scattering of electron neutrinos / antineutrinos and most tau neutrinos / antineutrinos, only the hadronic cascade will be visible [2]. This is referred to as a cascade event. Thus, muon neutrinos / antineutrinos can be seperated from the other flavors using the IceCube detector.\nThe inelasticity is the fraction of neutrino energy that is deposited in the hadronic cascade of a deep inelastic scattering. The average inelasticity for muon neutrinos and muon antineutrinos is different [4, 5]. This can allow us to separate neutrinos from antineutrinos statistically using the IceCube detector.\nBoth neutrino flavor and inelasticity are observables that require evaluating the morphology of individual events. For particle identification (PID), we look for the existence of an outgoing muon / antimuon track [3]. At the energies relevant for DeepCore, the energetic muon / antimuon is a minimum ionizing particle, and thus the average length the muon / antimuon travels scales linearly with the energy of the muon / antimuon. Thus we can look at the length of the outgoing track and the total light deposited in the hadronic cascade to determine the inelasticity [3]. The density of the DOMs in the ice means that events at lower energies have lower resolutions, making standard reconstruction techniques more difficult to use. It has been shown that machine learning based reconstruction methods are faster and more precise than the photon table based reconstruction methods that have been previously used in IceCube [6]. In this paper we describe a new convolutional neural network (CNN) developed to measure PID and inelasticity in IceCube DeepCore."
        },
        {
            "heading": "2. Methods",
            "text": ""
        },
        {
            "heading": "2.1 Monte Carlo Data and Selection",
            "text": "For training and testing the CNN we use simulated data that includes the following restrictions:\n\u2022 The energy must be between 3 GeV and 1 TeV for inelasticity reconstruction, 5 GeV to 1 TeV for PID reconstruction.\n\u2022 There must be at least eight photon hits and at most 250 photon hits in the event.\nP o S ( I C R C 2 0 2 3 ) 1 1 2 9 P o S ( I C R C 2 0 2 3 ) 1 1 2 9\n\u2022 The interaction must occur between 2106 meters and 2450 meters deep in the ice in a circle of radius 100 meters surrounding the center of DeepCore.\nWe elect to use relatively loose selection criteria so that we have more events to train the CNN with and so that in the future we can apply the trained CNN to existing data sets that have stricter selection criteria. The energy threshold was lowered from 5 GeV to 3 GeV for inelasticity to match existing matter dependant studies. For PID reconstruction, we need to select a sample that contains both tracks and cascades, so we take muon and electron neutrino / antineutrino events, including both neutral and charged current interactions. For inelasticity reconstruction we just need to focus on track events, so we only take muon neutrino / antineutrino charged current interactions. After imposing these restrictions our data has the composition shown in Table 1.\nTable 1: Composition of Monte Carlo data used for training the CNN. A track event is a muon neutrino / antineutrino CC interaction. Everything else is labelled a cascade event.\ntracks cascades PID 4,495,634 2,835,831\ninelasticity 4,827,397 0\nWe then split the data into three sets: 4% for a testing the CNN, 10% for a validating performance during training, and the rest is used as a training set."
        },
        {
            "heading": "2.2 Monte Carlo Data Preparation",
            "text": "Our data should have translational symmetry in both space and time. However, the strings in the DeepCore detector are non-uniformly spaced in the x-y plane, as shown in Figure 1, so exploiting the x-y translational symmetry cannot be easily done. The DOM spacing is uniform along the strings, so we can exploit the translational symmetry along depth and along time. Thus, for every event we compose a 2-dimensional image for each string in the DeepCore detector. The images consist of the DOMs ordered by depth on one axis and time sliced into 25 nanosecond time segments on the other axis. The charge of the photon hits seen by a particular DOM in an event is summed, and the pixel containing the earliest photon hit in a particular DOM is populated with the total charge. An example of such a string image is shown in Figure 2. There are two types of strings of DOMs in the DeepCore detector. Seven of the strings are identical to the strings that are used in the rest of the IceCube detector. We will refer to those strings as IceCube strings. There are eight strings that are more densely instrumented surrounding a single IceCube string. We will refer to those strings as DeepCore strings. We utilize all of the strings in the blue circle in Figure 1 in our CNN. For the inelasticity CNN we also incorporate the IceCube strings surrounding the DeepCore detector shown in Figure 1. This is done because it was found that we obtain better reconstruction results at higher energy. We will do the same for PID in the future, but the results shown in this paper for PID do not include those additional IceCube strings. We elect to only use DOMs that are below a particular dust layer at about 2000 meters to 2100 meters deep that reduces the optical quality of the ice [7]. This creates the complication that the string images constructed from DeepCore strings will have more rows than the images constructed from IceCube strings since there are more DOMs below the dust layer on the DeepCore strings\nP o S ( I C R C 2 0 2 3 ) 1 1 2 9 P o S ( I C R C 2 0 2 3 ) 1 1 2 9\nFigure 2: Example of a string image. Each row is a DOM, and the rows are ordered based on depth in the ice. The pixels are populated with the total charge that each DOM saw starting at a particular slice of time. Each event will have an image for every string in the DeepCore detector.\nthan on the IceCube strings [1]. Thus we pad the IceCube string images with empty DOM rows in such a way that IceCube string DOMs and DeepCore string DOMs with similar depths will be in the same row in the string images. We then stack the DeepCore string images and padded IceCube string images together to feed to the CNN."
        },
        {
            "heading": "2.3 Neural Network Architecture and Training",
            "text": "Our CNN includes four convolutional blocks followed by a two layer multi-layer perceptron (MLP). Each convolution block includes two 2-dimensional convolution layers with rectified liner unit (ReLU) activation functions. Then we apply a max pooling layer to the output of the convolutional layers. For the MLP we use a dropout rate of 25% to help regularize the CNN. A diagram of the neural network architecture is shown in Figure 3.\nFor the inelasticity CNN, we have a single output that is passed through a sigmoid activation function after the MLP. Inelasticity is bounded between 0 and 1, so the sigmoid activation function insures that the output of the CNN upholds these bounds.\nFor PID, we have two outputs: a label for the presence of a significant muon track and a label for a significant hadronic cascade. We use these labels to represent the fact that some events are dominated by the hadronic cascade, some are dominated by the muon track, and some events have a significant cascade and track. We use true inelasticity as a metric for when we identify an event as having a significant track and cascade. Table 2 shows how each event is assigned its labels. The cuts in the table are determined by training many networks with different cuts and picking the\nP o S ( I C R C 2 0 2 3 ) 1 1 2 9 P o S ( I C R C 2 0 2 3 ) 1 1 2 9\nFigure 3: Architecture of our 2D CNN. The \"out\" at the the end represents whatever output one might need, for this paper it would be inelasticity or a track or cascade confidence.\nconfiguration with the best performance.\nTable 2: The conditions used to label each event. Each event has a muon track and hadronic cascade label to indicate if there is a visible muon track or hadronic cascade.\nMuon Track label Hadronic Cascade label label condition label condition track \ud835\udf08\ud835\udf07 CC events cascade \ud835\udf08\ud835\udf07 NC events, \ud835\udf08\ud835\udc52 events, \ud835\udf08\ud835\udf07 CC events w/ \ud835\udc66 > 0.8\nno track \ud835\udf08\ud835\udf07 NC events, \ud835\udf08\ud835\udc52 events no cascade \ud835\udf08\ud835\udf07 CC events w/ \ud835\udc66 < 0.8\nFor training, we use the Adam algorithm [8] for optimization with a learning rate of 0.0001. We stop the training when the validation loss achieves a minimum and starts to increase upon following epochs.\nFor the inelasticity CNN, we use the following L1 loss:\n\ud835\udc3f\ud835\udc5c\ud835\udc60\ud835\udc60\ud835\udc56\ud835\udc5b\ud835\udc52\ud835\udc59\ud835\udc4e\ud835\udc60\ud835\udc61\ud835\udc56\ud835\udc50\ud835\udc56\ud835\udc61 \ud835\udc66 = |\ud835\udc66\ud835\udc5f\ud835\udc52\ud835\udc50\ud835\udc5c\ud835\udc5b\ud835\udc60\ud835\udc61\ud835\udc5f\ud835\udc62\ud835\udc50\ud835\udc61\ud835\udc52\ud835\udc51 \u2212 \ud835\udc66\ud835\udc61\ud835\udc5f\ud835\udc62\ud835\udc52 |. (1)\nThis choice was made because we find that we achieve better performance at higher energies with this loss compared to L2 loss. For the PID CNN we use the binary cross entropy (BCE) loss applied to both outputs:\n\ud835\udc3f\ud835\udc5c\ud835\udc60\ud835\udc60\ud835\udc43\ud835\udc3c\ud835\udc37 = 0.7 \u00d7 \ud835\udc35\ud835\udc36\ud835\udc38 (\ud835\udc5c\ud835\udc62\ud835\udc61\ud835\udc5d\ud835\udc62\ud835\udc61\ud835\udc61\ud835\udc5f\ud835\udc4e\ud835\udc50\ud835\udc58 ; \ud835\udc59\ud835\udc4e\ud835\udc4f\ud835\udc52\ud835\udc59\ud835\udc61\ud835\udc5f\ud835\udc4e\ud835\udc50\ud835\udc58) + \ud835\udc35\ud835\udc36\ud835\udc38 (\ud835\udc5c\ud835\udc62\ud835\udc61\ud835\udc5d\ud835\udc62\ud835\udc61\ud835\udc50\ud835\udc4e\ud835\udc60\ud835\udc50\ud835\udc4e\ud835\udc51\ud835\udc52; \ud835\udc59\ud835\udc4e\ud835\udc4f\ud835\udc52\ud835\udc59\ud835\udc50\ud835\udc4e\ud835\udc60\ud835\udc50\ud835\udc4e\ud835\udc51\ud835\udc52). (2)\nThe binary cross entropy loss for the track label is weighted by a factor of 0.7, which was found to improve performance via a grid scan.\nP o S ( I C R C 2 0 2 3 ) 1 1 2 9 P o S ( I C R C 2 0 2 3 ) 1 1 2 9"
        },
        {
            "heading": "3. Results and Discussion",
            "text": ""
        },
        {
            "heading": "3.1 Particle Identification",
            "text": "We find that the track and cascade labels provide very similar outputs, and so we only show here the output of the track label. However, we find that using this labelling scheme and loss gives better results than just using the cross entropy loss, which is why we keep it regardless of the unintended behavior.\nFigure 5: Receiving operating characteristic curve for the 2D CNN evaluated on a set of MC events with all three flavors of neutrinos. The 2D CNN classifies better than a BDT trained for the same task.\nFor Figure 4 and Figure 5, we use all muon, electron, and tau neutrino / antineutrino Monte Carlo (MC) events that pass the data selection criteria outlined in Section 2.1. After checking the normalized PID distributions for the test set and the training set, we find they are nearly identical, suggesting that overfitting has been well-regulated.\nFigure 4 is the distribution of PID outputs for the set of MC events described previously. There are three notable features of this distribution; the spike in track events near a PID score of 1, The collection of events around a PID score of 0.5, and the cascade rich tail below a PID score of 0.2. The spike in track events near a PID score of 1 and the central collection of cascade and track events are common features for other PID reconstruction algorithms for the DeepCore detector [9, 10]. The collection of cascade and track events around a PID score of 0.4 to 0.5 and the lack of a spike of cascade events around a PID score of 0 are a reflection of the fact that at low energies many track events look like cascades, and only when there is a definite muon track can we be confident in what a particle\u2019s identity is. The cascade rich tail is a feature that isn\u2019t seen in similar reconstruction methods, and suggests that the CNN has started to find features in the data unique to cascade events.\nFigure 5 shows the receiver operating characteristic curves for our CNN and a boosted decision tree (BDT) that is used in another analysis [9]. This plot demonstrates that the CNN method is\nP o S ( I C R C 2 0 2 3 ) 1 1 2 9 P o S ( I C R C 2 0 2 3 ) 1 1 2 9\n(a) (b)\n(c) (d)\nFigure 6: MC events binned by true inelasticity and inelasticity reconstructed by the CNN. The dashed black line indicates where events would be assuming a perfect reconstruction. Plot (a) contains all events in the test set, whereas (b), (c), and (d) show events separated by different true energy ranges.\nbetter at identifying tracks and cascades than the BDT based method, which relies on high level reconstructed inputs."
        },
        {
            "heading": "3.2 Inelasticity",
            "text": "Figure 6a is a two dimensional histogram of events binned by the true inelasticity and the inelasticity from CNN reconstruction. An ideal reconstruction would have all events in the bins along the dashed black line. There are two populations of events that can be seen here. The flat distribution are events that are hard to reconstruct, and so the network learns to assign roughly the mean inelasticity of those events. The second population of events can be seen faintly in the upper-right corner of the plot. These are events that are being reconstructed more effectively.\nA good proxy for the difficulty of reconstruction is the energy of the event. Lower energy events will have less photon hits and hence lower resolution. Thus, we can make cuts in the energy to separate the two populations.\nFigure 6b, Figure 6c, and Figure 6d are similar histograms to Figure 6a but with the events split\nP o S ( I C R C 2 0 2 3 ) 1 1 2 9 P o S ( I C R C 2 0 2 3 ) 1 1 2 9\ninto three populations based on energy (the specific energy ranges are shown in the plots). Figure 6b clearly shows the first population of events without the second. There is a slight asymmetry in the reconstructed inelasticity distribution which can be used to slightly separate neutrinos from antineutrinos. To quantify this separation power, we separate events with true energies of 3 GeV to 20 GeV into two bins, \ud835\udc66\ud835\udc5f\ud835\udc52\ud835\udc50\ud835\udc5c > 0.32 and \ud835\udc66\ud835\udc5f\ud835\udc52\ud835\udc50\ud835\udc5c < 0.32. Then we calculate the ratio of antineutrino events to all events in each bin and we find ratios of 0.34 and 0.31 respectively. Figure 6c shows a definite improvement in reconstruction when compared to Figure 6b, and Figure 6d even better reconstruction than Figure 6c. This is expected because the larger the energy of the event, the more DOMs will detect photons and thus it will be easier to resolve the event morphology. The second plot shows that we can push the inelasticity reconstruction down to roughly 30 GeV."
        },
        {
            "heading": "4. Conclusion",
            "text": "We have developed a new 2D CNN architecture as well as a new method for preparing IceCube DeepCore events that is effective for reconstruction tasks in IceCube DeepCore. We also show that when this CNN is applied to PID reconstruction it outperforms a BDT based method used in other DeepCore analyses, and when we apply the CNN to inelasticity reconstruction we can effectively measure inelasticity down to 30 GeV and gain some neutrino antineutrino separating power below 20 GeV. It is likely that this CNN will be developed further, perhaps with different loss functions or more optimized architectures. We will also incorporate the IceCube strings surrounding DeepCore into the PID CNN in the near future. We then hope to apply this CNN to inelasticity based studies and/or matter effect dependant oscillation studies, where separating neutrinos from anti-neutrinos can greatly benefit sensitivity [5]."
        },
        {
            "heading": "Acknowledgements",
            "text": "The authors gratefully acknowledge the support from the following agencies and institutions: USA \u2013 U.S. National Science FoundationOffice of Polar Programs, U.S. National Science Foundation-Physics Division, U.S. National Science Foundation-EPSCoR, Wisconsin Alumni Research Foundation, Center for High Throughput Computing (CHTC) at the University of Wisconsin\u2013Madison, Open Science\nP o S ( I C R C 2 0 2 3 ) 1 1 2 9 P o S ( I C R C 2 0 2 3 ) 1 1 2 9\nGrid (OSG), Advanced Cyberinfrastructure Coordination Ecosystem: Services & Support (ACCESS), Frontera computing project at the Texas Advanced Computing Center, U.S. Department of Energy-National Energy Research Scientific Computing Center, Particle astrophysics research computing center at the University of Maryland, Institute for Cyber-Enabled Research at Michigan State University, and Astroparticle physics computational facility at Marquette University; Belgium \u2013 Funds for Scientific Research (FRS-FNRS and FWO), FWO Odysseus and Big Science programmes, and Belgian Federal Science Policy Office (Belspo); Germany \u2013 Bundesministerium f\u00fcr Bildung und Forschung (BMBF), Deutsche Forschungsgemeinschaft (DFG), Helmholtz Alliance for Astroparticle Physics (HAP), Initiative and Networking Fund of the Helmholtz Association, Deutsches Elektronen Synchrotron (DESY), and High Performance Computing cluster of the RWTH Aachen; Sweden \u2013 Swedish Research Council, Swedish Polar Research Secretariat, Swedish National Infrastructure for Computing (SNIC), and Knut and Alice Wallenberg Foundation; European Union \u2013 EGI Advanced Computing for research; Australia \u2013 Australian Research Council; Canada \u2013 Natural Sciences and Engineering Research Council of Canada, Calcul Qu\u00e9bec, Compute Ontario, Canada Foundation for Innovation, WestGrid, and Compute Canada; Denmark \u2013 Villum Fonden, Carlsberg Foundation, and European Commission; New Zealand \u2013 Marsden Fund; Japan \u2013 Japan Society for Promotion of Science (JSPS) and Institute for Global Prominent Research (IGPR) of Chiba University; Korea \u2013 National Research Foundation of Korea (NRF); Switzerland \u2013 Swiss National Science Foundation (SNSF); United Kingdom \u2013 Department of Physics, University of Oxford."
        }
    ],
    "title": "2D Convolutional Neural Network for Event Reconstruction in IceCube DeepCore",
    "year": 2023
}