{
    "abstractText": "In the analysis of agricultural product price time series, the detection of abnormal fluctuation is the primary task. Accurately judging the abnormal fluctuation of agricultural product prices will give the policy support to the government and also assist farmers increase production and income. A deep convolutional neural network model based on time series image(TSI) is introduced to identify the abnormal fluctuation of agricultural prices under the improved standard deviation-Slope judgment. Markov Transfer Field(MTF) method is used to transform the pre-processed sparse one-dimensional time series of agricultural prices into two-dimensional dense images, and a deep convolutional neural network(CNN) model is used for automatic feature extraction and classification of time series images containing abnormal fluctuations. The empirical evaluation of China\u2019s corn and wheat price datasets are performed in our paper, and compared with other abnormal fluctuation judgment methods, the accuracy of the proposed algorithm is about 20% higher Wentao Jiang College of Mathematics and Informatics, South China Agricultural University Tel.: +86-18469187774 E-mail: Jiangwt2@163.com Dabin Zhang\u2217 College of Mathematics and Informatics, South China Agricultural University E-mail: zdbff@scau.edu.cn Liwen Ling College of Mathematics and Informatics, South China Agricultural University E-mail: linglw@scau.edu.cn Guotao Cai College of Mathematics and Informatics, South China Agricultural University E-mail: cai13662912770@163.com Lling Zeng College of Mathematics and Informatics, South China Agricultural University E-mail: aizengliling@163.com 2 Wentao Jiang et al. on average, which confirms the applicability of the standard deviation-slope time series Image-Resnet-34 (SDS-TSI-Resnet34) model in practical scenarios. Finally, some feasible suggestions for the efficient development of agricultural economy are proposed based on the abnormal fluctuation judgment method proposed in this paper.",
    "authors": [
        {
            "affiliations": [],
            "name": "Jiang Wentao"
        },
        {
            "affiliations": [],
            "name": "Dabin Zhang"
        },
        {
            "affiliations": [],
            "name": "Liwen Ling"
        },
        {
            "affiliations": [],
            "name": "Liling Zeng"
        },
        {
            "affiliations": [],
            "name": "Wentao Jiang"
        },
        {
            "affiliations": [],
            "name": "Dabin zhang"
        },
        {
            "affiliations": [],
            "name": "Guotao Cai"
        },
        {
            "affiliations": [],
            "name": "Lling Zeng"
        }
    ],
    "id": "SP:fd7c9e34537d88264d1f1d047337622b10645237",
    "references": [
        {
            "authors": [
                "H Zhao"
            ],
            "title": "Futures price prediction of agricultural products based on machine learning[J",
            "venue": "Neural Computing and Applications,",
            "year": 2020
        },
        {
            "authors": [
                "P Chen",
                "D Haboudane",
                "N Tremblay"
            ],
            "title": "New spectral indicator assessing the efficiency of crop nitrogen treatment in corn and wheat[J",
            "venue": "Remote Sensing of Environment,",
            "year": 2010
        },
        {
            "authors": [
                "R Lyon"
            ],
            "title": "Fifty years of pulsar candidate selection: from simple filters to a new principled real-time classification approach.[J",
            "venue": "Monthly Notices of the Royal Astronomical Society,",
            "year": 2016
        },
        {
            "authors": [
                "Wen",
                "Zhifeng"
            ],
            "title": "Robust least squares support vector machine based on recursive outlier elimination[J",
            "venue": "Soft Computing-A Fusion of Foundations,Methodologies&Applications,",
            "year": 2010
        },
        {
            "authors": [
                "R.S. Tsay"
            ],
            "title": "1988.Outliers, level shifts, and variance changes in time series[ J",
            "year": 1988
        },
        {
            "authors": [
                "J Ledolter"
            ],
            "title": "The effect of additive outliers on the forecasts from ARIMA models",
            "year": 1989
        },
        {
            "authors": [
                "F. Battaglia",
                "L. Orfei"
            ],
            "title": "Outlier detection and estimation in nonlinear time series",
            "venue": "J. Time Ser. Anal",
            "year": 2005
        },
        {
            "authors": [
                "FF Molinares",
                "Reisen V A",
                "F Cribari-Neto"
            ],
            "title": "Robust estimation in long-memory processes under additive outliers[J",
            "venue": "Journal of Statistical Planning&Inference,",
            "year": 2009
        },
        {
            "authors": [
                "C.L. Leduca",
                "H. Boistardb",
                "E. Moulinesc",
                "M.S. Taqqu",
                "V.A. Reisene"
            ],
            "title": "Robust estimation of the scale and of the auto covariance function of Gaussian short and longrange dependent processes",
            "venue": "J. Time Ser. Anal",
            "year": 2011
        },
        {
            "authors": [
                "N Loperfido"
            ],
            "title": "Kurtosis-based projection pursuit for outlier detection in financial time series[J",
            "venue": "The European Journal of Finance,",
            "year": 2020
        },
        {
            "authors": [
                "J. Ma",
                "S. Perkins"
            ],
            "title": "Online novelty detection on temporal sequences,",
            "venue": "Proceedings of the 9th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining (KDD",
            "year": 2003
        },
        {
            "authors": [
                "A.L.I. Oliveira",
                "S.R.L. Meira"
            ],
            "title": "Detecting novelties in time series through neural networks forecasting with robust confidence intervals,",
            "venue": "Neurocomputing, vol. 70,",
            "year": 2006
        },
        {
            "authors": [
                "E. Keogh",
                "J. Lin",
                "A.W. Fu",
                "H. Van Herle"
            ],
            "title": "Finding unusual medical time-series subsequences: algorithms and applications,",
            "venue": "IEEE Transactions on Information Technology in Biomedicine,",
            "year": 2006
        },
        {
            "authors": [
                "E. Keogh",
                "J. Lin",
                "A. Fu"
            ],
            "title": "HOT SAX: efficiently finding the most unusual time series subsequence,",
            "venue": "Proceedings of the 5th IEEE International Conference on Data Mining (ICDM",
            "year": 2005
        },
        {
            "authors": [
                "L. Wei",
                "E. Keogh",
                "X. Xi"
            ],
            "title": "SAXually explicit images: finding unusual shapes,",
            "venue": "Proceedings of the 6th International Conference on Data Mining (ICDM",
            "year": 2006
        },
        {
            "authors": [
                "J. Lin",
                "E. Keogh",
                "A. Fu",
                "H. van Herle"
            ],
            "title": "Approximations to magic: finding unusual medical time series,",
            "venue": "Proceedings of the 18th IEEE Symposium on Computer-Based Medical Systems,",
            "year": 2005
        },
        {
            "authors": [
                "Voort",
                "P.J.M. Havinga"
            ],
            "title": "Statistics-based outlier detection for wireless sensor networks,\u201dInternational",
            "venue": "Journal of Geographical Information Science,",
            "year": 2012
        },
        {
            "authors": [
                "R. Frieda",
                "B.I. Agueusopa"
            ],
            "title": "Bornkampb et al., \u201cBayesian outlier detection in INGARCH time series,",
            "venue": "Sonderforschungsbereich (SFB)",
            "year": 2012
        },
        {
            "authors": [
                "S.C. Bilen"
            ],
            "title": "Huzurbazar, \u201cWavelet-based detection of outliers in time series,",
            "venue": "Journal of Computational and Graphical Statistics,",
            "year": 2002
        },
        {
            "authors": [
                "Lovish Madaan"
            ],
            "title": "Price Forecasting & Anomaly Detection for Agricultural Commodities in India[J",
            "year": 2019
        },
        {
            "authors": [
                "Ge Y",
                "H Wu"
            ],
            "title": "Prediction of corn price fluctuation based on multiple linear regression analysis model under big data[J",
            "venue": "Neural Computing and Applications,",
            "year": 2019
        },
        {
            "authors": [
                "U Shi-Wei X",
                "Y Wang",
                "W Wang S"
            ],
            "title": "Research and application of real-time monitoring and early warning thresholds for multi-temporal agricultural products information[J",
            "venue": "Journal of Integrative Agriculture,",
            "year": 2020
        },
        {
            "authors": [
                "I Vorotnikov",
                "A Rozanov",
                "M Sidelnikova"
            ],
            "title": "Outlier Detection of the Agricultural Time Series[J",
            "venue": "IOP Conference Series: Earth and Environmental Science,",
            "year": 2021
        },
        {
            "authors": [
                "A.S. Campanharo",
                "M.I. Sirer",
                "R.D. Malmgren",
                "F.M. Ramos",
                "L.A.N. Amaral"
            ],
            "title": "Duality between time series and networks[J",
            "venue": "PloS one,",
            "year": 2011
        },
        {
            "authors": [
                "A Krizhevsky",
                "I Sutskever",
                "GE. Hinton"
            ],
            "title": "ImageNet Classification with Deep Convolutional Neural Networks",
            "venue": "KQ, editors. Advances in Neural Information Processing Systems",
            "year": 2012
        },
        {
            "authors": [
                "J Devlin",
                "MW Chang",
                "K Lee",
                "K. Toutanova"
            ],
            "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding",
            "year": 2019
        },
        {
            "authors": [
                "D Silver",
                "A Huang",
                "CJ Maddison",
                "A Guez",
                "L Sifre",
                "G van den Driessche"
            ],
            "title": "Mastering the game of Go with deep neural networks and tree search",
            "year": 2016
        },
        {
            "authors": [
                "J. Baxter"
            ],
            "title": "A Model of Inductive Bias Learning",
            "venue": "J Art if Int Res",
            "year": 2000
        },
        {
            "authors": [
                "A Courville",
                "P. Vincent"
            ],
            "title": "Representation Learning: A Review and New Perspectives",
            "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence",
            "year": 2013
        },
        {
            "authors": [
                "K He",
                "X Zhang",
                "S Ren"
            ],
            "title": "Deep Residual Learning for Image Recognition[J",
            "venue": "IEEE computer society,",
            "year": 2016
        },
        {
            "authors": [
                "S Egan",
                "W Fedorko",
                "A Lister"
            ],
            "title": "Long Short-Term Memory (LSTM) networks with jet constituents for boosted top tagging at the LHC[J",
            "year": 2017
        },
        {
            "authors": [
                "W Dai",
                "T Mrkvika",
                "Y Sun"
            ],
            "title": "Functional outlier detection and taxonomy by sequential transformations[J",
            "venue": "Computational Statistics & Data Analysis,",
            "year": 2020
        }
    ],
    "sections": [
        {
            "text": "Wentao Jiang College of Mathematics and Informatics, South China Agricultural University Tel.: +86-18469187774\nE-mail: Jiangwt2@163.com\nDabin Zhang\u2217 College of Mathematics and Informatics, South China Agricultural University E-mail: zdbff@scau.edu.cn\nLiwen Ling College of Mathematics and Informatics, South China Agricultural University E-mail: linglw@scau.edu.cn\nGuotao Cai College of Mathematics and Informatics, South China Agricultural University E-mail: cai13662912770@163.com\nLling Zeng College of Mathematics and Informatics, South China Agricultural University E-mail: aizengliling@163.com\non average, which confirms the applicability of the standard deviation-slope time series Image-Resnet-34 (SDS-TSI-Resnet34) model in practical scenarios. Finally, some feasible suggestions for the efficient development of agricultural economy are proposed based on the abnormal fluctuation judgment method proposed in this paper.\nKeywords standard deviation-Slope(SDS) \u00b7 time series image(TSI) \u00b7 convolutional neural network(CNN) \u00b7 abnormal fluctuation detection"
        },
        {
            "heading": "1 Introduction",
            "text": "Agricultural products are essential to people\u2019s daily life. As the basic price, the price of agricultural products[1] is related to the development of agriculture itself and the stability of the whole economic order, and the negative effect brought by the abnormal fluctuation of the price of agricultural products will affect the operation of social economy. For consumers, excessive price increases will put a great burden on people\u2019s food expenses. For agricultural producers, large price fluctuations[2] will increase the uncertainty of production and increase the unnecessary risks. Therefore, the control of the abnormal fluctuation of agricultural prices is one of the important issue urgently to be solved by governments. Accurate detection of the agricultural prices abnormal fluctuation[3] is very important for agricultural departments to make scientific decisions. The production and prices of agricultural commodities[4] tend to be random, as they are largely subject to happenings and are highly unpredictable in the event of natural disasters such as droughts, floods and pests and diseases. This leads to considerable risk and uncertainty in the modeling and forecasting process of price abnormal fluctuation detection. This is especially evident in the price changes of major food crops. Since food prices are an important component of eradicating hunger, policymakers need reliable forecasts of expected food prices to manage food security. Before liberalization and globalization began, governments controlled food prices, thus making food price forecasting a low-value-added activity[5]. But as the world becomes more open, food prices are set by domestic and international market forces. This leads to increased price variability and makes reliable price anomaly detection techniques important. Corn and wheat, as the main food crops in China, play an important role in China\u2019s economic and social development[6]. It is not only the main source of fuel power for the industrial sector, but also an important food for civilian use and has become an important export commodity. Currently, corn and wheat account for about 70 percent of China\u2019s total grain production and 75 percent of its total grain consumption[7]. In the long run, corn and wheat will remain the backbone of Chinese food. It will occupy an important strategic position in the national economy. The prices of major grains in China have fluctuated greatly over the past decades. Especially in recent years, the price of corn and wheat has aroused widespread concern in the society. As the basic grain, the\ndrastic fluctuation of corn and wheat price will inevitably affect the stability and development of the society. In this paper, the data of corn price in recent 40 years and wheat price in recent 20 years are collected and their abnormal fluctuations are analyzed. With limited information and expensive calculations, analyzing this data to identify unusual price movements is a challenge. Analysis can be organized at three different levels[8]: 1.Long-term analysis (with a timeframe of years) 2.Medium-term analysis (with a timeframe of months) 3.Short-term analysis (with a timeframe of weeks) The purpose of this paper is to analyze univariate time series agriculture price data in the third layer (i.e. short-term analysis) to detect abnormal changes in agricultural prices. At present, the most commonly used strategy to deal with massive data is to extract the features of price fluctuations based on expert knowledge. Experts do a lot of empirical research to elicit useful features for a particular context. However, domain experts cannot provide an optimal feature set because the environment can become very complex when the socioeconomic characteristics of price fluctuations (e.g., policies, climate, etc.) are different. Recently inspired by computer vision, the authors found that recombining time series data into images will perform classification tasks more accurately. In this paper, the agriculture price time series are transformed into two-dimensional images by Markov transfer field. The generated image has time correlation with one-dimensional time series. In the classification task, Resnet-34 network is selected to train the time series image, and softMax classifier is used for classification. The deep learning model is selected in this paper for the following reasons:\n\u2013 Avoid the complicated manual feature selection process and automatically extract time series features.\n\u2013 Deep learning has a high classification rate for data sets of image types.\nOur contributions in this work are four-fold. First, the SDS abnormal fluctuation judgment is designed, which can find out the implied abnormal fluctuations in the time series of agricultural prices more comprehensively. Second, Markov transition function is applied to transfer one dimensional agricultural price time series into 2D images and a CNN mechanism is designed to extract descriptive and representative feature from time series images automatically. In addition, the new time series of agricultural prices does not require any new abnormal fluctuation criterion judgment (standard deviation and slope between a large number of extreme points), but can be directly input into the trained abnormal fluctuation classifier in this paper, which greatly saves time and labor costs. Third, the SDS-TSI-Resnet34 has better performance compared with the existing state-of-the-art method such as Long Short-Term\nMemory(LSTM), support vector machines(SVM), K-Nearest Neighbor (KNN) and so on. Finally, the traditional abnormal fluctuations and outliers processing methods are usually deletion, modification, logarithmic conversion and so on. This paper uses the price time series of agricultural products, the deletion and modification of abnormal fluctuations will lose practical significance. Therefore, in this paper, we choose to detect and analyze the abnormal fluctuation of agricultural product prices as a policy analysis for agricultural development. The rest of the paper is organized as follows: The related methods are described in Section 2. The SDS-TSI-Resnet34 model is described in detail in Section 3. In Section 4, the experimental results are presented and then compare them to show our improvements. Finally, the section 5 gives conclusions. The flow chart of this paper is shown in Figure 1."
        },
        {
            "heading": "2 Methods",
            "text": "Abnormal fluctuations can be defined as \u201dobservations so different from other observations that one suspects it was produced by a different mechanism\u201d, or \u201dpatterns in the data do not conform to well-defined notions of normal behaviour\u201d.The main purpose of abnormal fluctuation detection is to identify objects that are significantly different from other data[9,10]. In recent decades, the research on abnormal fluctuation detection has attracted extensive research attention in statistical analysis, machine learning and artificial intelligence, because it has important applications in business, security, insurance, healthcare and engineering. Among them, the abnormal fluctuation detection plays a more important role in time series analysis. One kind of abnormal fluctuation detection in time series is mainly dynamic intervention model. Dynamic intervention model is an iterative method, which needs to iterate between abnormal fluctuation detection and model parameter estimation. Tsay(1988)[11] discussed the significance of abnormal fluctuations in horizontal displacement and the dynamics leading to changes in sequence variance. Chang et al.(1988)[12] introduced two new abnormal fluctuations on the basis of Tsay, namely, additive outliers (AO) and innovative outliers (IO). Subsequently, Chen and Liu(1993)[13] introduced temporary change (TC) and horizontal displacement (HD) abnormal fluctuations into time series and discussed their roles in modeling and estimating time series parameters. They further demonstrate that the sensitivity of the prediction interval is mainly caused by AO, and discuss the prediction problem when outliers appear near abnormal fluctuations or at the prediction starting point. Ledolter(1989)[14] solved the consequences of additional outliers in the prediction in the case of ARMA model. Battaglia and Orfei(2005)[15] discussed the problem of identifying outlier positions and estimating amplitude in nonlinear time series in their study. Molinaresa et al. (2009)[16] introduced another semi-parametric estimate of fractional difference parameters in the autoregressive fractional integral moving average (ARIMA) model, which is robust to additive outliers. In their study, Leduca et al. (2011)[17] considered the implementation of selfcovariance functions that are robust to additive outliers. Loperfido(2020)[18] discusses a method based on maximum kurtosis for abnormal fluctuation detection in multivariate and univariate time series models. However, the estimation process is based on the assumption that the model parameters are known, which may not always be the case, especially in the case of actual data. Another common method in time series abnormal fluctuation detection is based on prediction model[19,20,21]. This method first builds prediction models from historical values, which are then used to predict values. If the difference between the predicted and observed values exceeds a certain threshold, the abnormal fluctuation is displayed. The definition of abnormal fluctuation detection threshold is the main problem of abnormal fluctuation detection based on prediction. The difficulty of abnormal fluctuation detection based on prediction prompted people to propose the abnormal fluctuation detection technology based on similarity measure calculation between subsequences[22,23,24,25].\nKeogh et al.[22] proposed to use a nearest neighbor method to detect the most different subsequences in a long sequence (called inconsistency). By using various methods, such as heuristic reordering of candidate subsequences [23], locally sensitive hashing [24], Haar wavelet [25], and SAX with augmentation attempts [26], intelligent ordering of subsequence comparisons can be performed for effective pruning. In 2012, Zhang developed an average method based on time series analysis and geostatistics, and achieved satisfactory detection results in short snapshots [27]. However, if the abnormal fluctuations are closely clustered in the same short time period, they will fail. Therefore, the research in recent years mainly focuses on non-parametric abnormal fluctuation detection methods such as Bayesian method and discrete wavelet transform (DWT). Frieda proposed a Bayesian method for modeling abnormal fluctuations by applying the component Metropolis-Hastings algorithm [28] to approximate the posterior distribution of model parameters. In addition to the Bayesian method, Grane and Veiga[29] identified abnormal fluctuations as observed values in the original sequence based on wavelet transform detail coefficients greater than a certain threshold. They iterate through DWT and abnormal fluctuation correction until all detail coefficients are below the threshold. Based on the financial time series in the real world, their method obtained a lower average false abnormal fluctuation than Bilen and Huzurbazar\u2019s [30]. Abnormal fluctuation detection is also widely used in agricultural product price time series. Lovish Madaan et al.[31] evaluated a random forest binary classifier to operate on different feature sets built over a 43-day event window and proposed an anomaly detection model that reduces information asymmetry and finds anomalies that help regulate agricultural markets to operate more fairly. In 2013, Girish K. Jha A and Kanchan Sinha[32] proposed an artificial neural network (ANN) modeling method to predict the abnormal fluctuation of agricultural prices by taking the monthly wholesale price sequence of Soybeans and mustard in India as an example and taking into account the availability of data in developing economies, and proved the feasibility of this technology. In 2020, Yan Ge et al.[33] analyzed the changing trend of corn price and the factors affecting corn price, and established univariate nonlinear and multiple linear regression models respectively by using data and regression analysis to predict abnormal fluctuations of corn price. Subsequently, XU Shi-wei et al.[34] determined the early warning threshold of agricultural production, consumption and price by using a variety of statistical methods based on the data of the National Bureau of Statistics and survey data. Combined with Delphi expert judgment modification method, agricultural product information warning thresholds at multiple time points were finally determined, and early warning analysis was conducted on the fluctuation of agricultural product monitoring information in 2018. In 2021, I Vorotnikov et al.[35] introduced standard deviation in abnormal fluctuation detection of agricultural price time series to improve the reliability of data processing results of dynamic automatic monitoring of time series in agricultural activities. In recent years, standard deviation is the most commonly used method to judge\nthe abnormal fluctuation of agricultural price time series. However, standard deviation test often has some disadvantages. The reason is that the standard deviation method can only find abnormal fluctuations whose distance from the average value of the time series is beyond the three-fold standard deviation area, but cannot find the location where the price time series fluctuates violently within the standard deviation. Therefore, based on standard deviation, this paper proposes a standard deviation + slope abnormal fluctuation discrimination method. The experimental results show that this method can effectively identify abnormal fluctuation within the standard deviation and improve the accuracy of abnormal fluctuation recognition. Later, the 15 day agricultural product price time series is transformed into images and trained in the deep learning model to obtain the abnormal fluctuation classifier. When a new agricultural product price time series needs to judge the abnormal fluctuation, it can be directly input into our trained classifier."
        },
        {
            "heading": "3 Proposed model",
            "text": "The block diagram of abnormal fluctuation detection model of agricultural product price in Figure 1 includes three parts: 1.Data preprocessing 2.Imaging 3.Classifier Each component is described in detail in the following sections. The SS-TSIResnet-34 pseudocode proposed in this paper is as follows:\nAlgorithm 1\nTrain the classifier Given: O=s1, s2, ..., sn: Time series of agricultural prices at n time points; C: The selected CNN model(Resnet34); L: Dichotomous labels (normal and abnormal); I: Time series into images(MTF). Output: A trained outlier detection classifier. Data preprocessing: For i=1 to N 1. The daily data of time series O of agricultural price are divided into i segments according to every half month (15 days); 2. Divide the segmented time series xi into training period and test period; 3. Label L that determines the normal or abnormal status of each xi based on standard deviation-slope 4. Transform xi into images(MTF);\n5. Input the time series into the CNN; 6. Train the SoftMax classifier; Determine whether the new time series is normal or abnorma: Given: The trained classifier Output: Class labels from the new time series 7. xnew repeat step 2 and 3; 8. Let L(xnew) be the class of new time series, then the frame will be output to see if there are abnormal fluctuations.\n3.1 Data preprocessing\nIn this paper, the daily data of corn and wheat are used to verify the proposed algorithm. The sampling period of this series is about 15 days (half a month). A non-overlapping window is defined with a length of 15 to segment continuous time series data. This is a well proven method that is often used in the event of abnormal energy consumption. Figure 2, using corn data as an example, shows corn price data segmented in a 15-day window, with the average retained for further processing. At the same time, we divided the time series of corn s price into training set, verification set and test set according to the ratio of 6:2:2. Only the abnormal fluctuation of corn price time series is calculated, and a general abnormal fluctuation classifier is obtained by training the corn price time series in this paper. Then, the wheat price time series is directly input into the trained classification to identify abnormal fluctuations. This kind of data preprocessing method is similar to transfer learning in that corn price data is used as the database of transfer learning. Therefore, when judging abnormal fluctuations of similar time series of agricultural prices, there is no need to calculate the overall standard deviation or manually select extreme points with large fluctuations to find the slope, which reduces the workload and improves the efficiency. As can be seen from Figure 2, the identification of outliers in agricultural prices is not a direct process. For example, it is not possible to set a threshold to classify segmented Windows as normal or abnormal. Meaningful representations are required to extract this information, as described in the next section.\n3.2 Imaging\nIn order to obtain the spatial snapshot of time series, we formulated the imaging process by mapping the one-dimensional space of time series to the image, as shown in figure 3:\nWe get inspiration from Campanharo et al.[36], time series X determine Q quantile bins, and assign each xi to the corresponding storage unit qi(j \u2208 [1, Q]). Thus we construct a Q\u00d7Q weighted adjacency matrix W by counting transitions among quantile bins in the manner of a first-order Markov chain based on the time axis. wi,j is given by the transition probability of a point in quantile qj is followed by a point in quantile qi.After normalization by \u2211\nj \u03c9i,j = 1 W is the Markov transition matrix. It is irrelevant to the distribution of X and temporal dependency on time steps ti.However, our experimental results on W demonstrate that getting rid of the temporal dependency results in too much information loss in matrix W. In order to overcome this disadvantage, the mathematical formula of Markov transfer field (MTF) is as follows:\nM =\n\n   \n\u03c9ij|x1\u2208qi,x1\u2208qj \u03c9ij|x1\u2208qi,x2\u2208qj . . . \u03c9ij|x1\u2208qi,xn\u2208qj \u03c9ij|x2\u2208qi,x1\u2208qj \u03c9ij|x2\u2208qi,x2\u2208qj . . . \u03c9ij|x2\u2208qi,xn\u2208qj\n... ... . . . ... \u03c9ij|xn\u2208qi,x1\u2208qj \u03c9ij|xn\u2208qi,x2\u2208qj . . . \u03c9ij|xn\u2208qi,xn\u2208qj\n\n   \n(1)\nA Q \u00d7 Q Markov transition matrix is established by dividing the data into Q quantile bins. Mi,j in the MTF denotes the transition probability of qi \u2192 qj .That is, by considering the time and location, the matrix W is extended to an MTF matrix containing the transition probability on the magnitude axis. By forming the probability of quantiles from time step i to time step j at each pixel Mij , the essence of MTF is the multi span transition probability of coded time series. Mi,j|i\u2212j|=k represents the transition probability of two points with time interval k. For example, Mi,j|i\u2212j|=1 illustrates the transition process along the time axis with a skip step. The main diagonal Mii, which is a special case when k = 0 captures the probability from each quantile to itself (the self-transition probability) at time step i.To make the image size manageable and computation more efficient, we reduce the MTF size by averaging the pixels in each non-overlapping m\u00d7m which is a special case when k = 0 captures the probability from each quantile to itself (the self-transition probability) at time step i. To make the image size manageable and computation more efficient, we reduce the MTF size by averaging the pixels in each non-overlapping { 1\nm2\n}\nm\u00d7m .That is, we aggregate the transition probabilities\nin each subsequence of length m together. Figure 3 shows the procedure to encode time-series to MTF. Figure 4 shows the procedure to encode time-series to MTF.\n3.3 Convolutional neural networks\nConvolutional neural networks(CNNs) have made remarkable achievements in image classification [37], natural language processing [38] and reinforcement learning [39]. For time series forecasting, CNNs can reflect the subtle differences of underlying datasets and customize the corresponding architecture [40] and complex data representation [41] to reduce the work of manual feature engineering and model design. Basic idea of residual learning He et al.[42] put forward an improved CNN model for image classification, which is called deep residual network. The main difference between residual network and traditional CNN is that they have different network structures and information transmission modes, as shown in Figure 7. For the traditional CNN model, the input layer, convolution layer, pooling layer and output layer are combined in a cascade manner. But for the rest of the network, it has a shortcut that connects input and output directly together. Mathematically speaking, different from the direct approximation of basic function H (x), residual learning emphasizes the fitting of residual mapping f (x)\nF (x) = H(x)\u2212 x (2)\nThe special mapping of residual network block is F (x)+x, which is the output of a traditional CNN, namely H(x). However, as He et al. pointed, compared with the original mapping H(x), the fitting residual mapping F (x) is more effective, especially when H(x) is an identity or approximate identity mapping. The characteristics of the residual network will increase the depth greatly, but will not reduce the classification accuracy of the network.\n4 Experimental setup and result analysis\n4.1 Baseline algorithm\nThree benchmark comparison models are applied in this paper, namely support vector Machine (SVM)[43], K-nearest Neighbor (KNN)[44] and Long Short-\nTerm Memory (LSTM)[45]. An abnormal fluctuation criterion standard deviation is also used. In order to ensure the scientific nature of the experiment, this paper adopts the control variable method. SDS-TSI-Res34 is compared with SVM, KNN, LSTM under the same abnormal fluctuation criteria. And compared with SD-TSI-Res34 based on the traditional standard deviation abnormal fluctuation evaluation criteria.\n4.2 Datasets\nThe experiments are performed over the agricultural future product price time series datasets. The datasets include corn daily price data for nearly four decades from 1980 to 2020 and wheat daily price data for nearly two decades from 2000 to 2020. As we can see in Table 2.\n4.3 Abnormal fluctuation judgment\nThis paper improves the original abnormal fluctuation judgment criterion of agricultural price time series. The algorithm combines the original standard deviation with the abnormal fluctuation criterion based on the highest slope. The original standard deviation method calculates the standard score is also called the Z score which can reflect the relative position of the detection points in the overall distribution. Normalized values reflect the relative distance between the first I variable value and the average value of the sample . Let z for the relative standard distance of the mean value and the detection point, x as the detection point, \u03c3 as the standard deviation, then z scores can be expressed as\nz = (x\u2212 \u00b5)\n\u03c3 (3)\nAmong the formula,\u03c3 6= 0 and \u00b5 = E(x), so the arithmetic mean can be expressed as\nM =\n\u2211i=1\nn xi\nn (4)\nThe variance can be expressed as \u03c32 = V ar(x), and so the standard deviation can be expressed as\n\u03c3 =\n\u221a \u221a \u221a \u221a 1\nn\nn \u2211\ni=1\n(xi \u2212 \u00b5)2 (5)\nIf the standard value is 1, it means that the value of the ith sampling point is equal to the value of the standard deviation. If the normalized value is 2, then the value representing the ith sample point is twice the standard deviation value, i.e. the relative distance between the ith sample and the sample standard deviation is 2. According to the Pauta criterion, abnormal data is the mean and the distance between the mean is three times the standard deviation of the sample. Elevation anomaly data are those in which the distance between sample mean and standard deviation is greater than three times. However, in the practical application of time series of agricultural prices, whether the data should be deleted depends on the actual situation [46,47]. Standard deviation is used to judge abnormal fluctuations from the price time series as a whole, and the price point whose distance from the average value is greater than standard deviation is defined as outliers. One drawback of this approach is that it is impossible to judge the sharp fluctuation points within the standard deviation, as shown in the figure 6.\nThe judgment criterion for outliers based on the highest slope belongs to statistical data determined outliers [48], and usually the number of outliers does not exceed 5% of the total data. The highest slope based outlier criterion can be selected based on the outlier factor distribution of all data in the data set, without the number of outliers or any other parameter. In order to verify the feasibility of outlier judgment based on the highest slope, a small data set containing three dispersed outliers and a normal cluster was created in [48]. The results show that the criterion can adapt to the changing data flow, and the criterion based on the highest slope of outliers provides a novel method for accurately determining abnormal fluctuations. Therefore, slope k is added in this paper on the basis of the standard deviation, so that the outliers with violent fluctuations inside the threshold can be judged. In this paper, about 40 extreme points are selected to calculate the absolute value of slopes of two adjacent extreme points, and the minimum, average\nand maximum values of the slopes of the 20 extreme points are taken as the thresholds of the algorithm in this paper. If k > k0(k0 represents the maximum, average or minimum value of the slope of the extreme point), it is selected as outlier point. That is, the abnormal value judgment criterion proposed in this paper needs to meet one of two conditions:\nxi > 3 \u2217 \u03c3 \u222a k > k0 (6)\nWe calculate the slope between two adjacent extreme points(the difference of Price /the difference of time) and select the three most representative k0, which are maximum, minimum and average. Therefore, the threshold k0 can be taken kmax = 28.3, kave = 21.1, kmin = 18.3. Since the method of judging abnormal fluctuation based on slope is applied to the time series of agricultural prices for the first time, this paper carries out experiments on three different k0 and compares the results. Therefore, slope k is added in this paper on the basis of standard deviation, so that the outliers with violent fluctuations inside the threshold can be judged. We choose the k0 = kave for example, The improved abnormal fluctuation evaluation criteria are shown in Figure 7..\nFigure 8 shows the image of corn price time series generated by two different abnormal fluctuation judgment methods. The image on the left is clearer than that on the right. The clear contour indicates that the image on the left has more abundant and specific features, which is conducive to the judgment of abnormal fluctuations in the classifier. It can be seen that the time series images generated under standard deviation-slope abnormal fluctuation judgment are more suitable for the training and classification of deep convolutional neural network. IIn this paper, the judgment criterion for abnormal fluctuations of price time series images every 15 days is that there are abnormal fluctuations within 15 days, that is, the time series images are abnormal, otherwise they are normal.\n4.4 Performance measures\nEvaluating the model has entailed using three standard metrics Precision, Recall, and F1-score are applied as performance measures. In anomaly detection system, high Precision and high Recall are desired to build a good system. In such a situation, F-measure is used to give an equal importance to precision and recall.\nPrecision = TP\n(TP + FP ) (7)\nRecall = TP\n(TP + FN) (8)\nF1\u2212 Score = 2 \u2217 Precision \u2217Recall\n(Precision+Recall) (9)\n4.5 Parameter setting\nIn our experiment, we used Python 3.7 and Matlab 2018b. The size of four kinds of single pictures is 32 \u00d7 32, The parameters for pre-trained CNN models are set as follows: Dimension of the output of the pre-trained resnet-34: 512. The iteration rate of CNNs is 0.001, the batch size is 16, the epoch is 50, and the dropout is 0.1. The loss function is Cross Entropy Loss.\n4.6 Results analysis\nThrough the analysis of the results, we can draw the following conclusions: 1.The Precision, Recall and F1-Score of abnormal fluctuation detection under three slope judgment criteria are compared in this paper. As can be seen from Table 2, 3 and 4, when the slope threshold k0 = kave, the result are the best. The reason may be that when the slope is set to the maximum value kmax, a large number of qualified abnormal fluctuations will be discarded without reaching the threshold value kmax, resulting in the loss of abnormal fluctuations, thus reducing the number of abnormal fluctuation data sets and causing the emergence of deep learning overfitting. On the contrary, when the slope is kmin, a large number of non-abnormal fluctuations that do not meet the conditions will be included in the abnormal fluctuation data set, resulting in confusion of classification labels, thus reducing the accuracy of abnormal fluctuation classification by deep learning. 2.As shown in Table 2, in the time series of corn price, the precision of SDSTSI-Resnet34 method is 0.0096 higher than that of SD-TSI-Resnet34, as we can see in Fig 19. F1-score and Recall of SDS-TSI-Resnet34 is also 0.0271 and 0.0486 higher than SD-TSI-Resnet34 respectively. At the same time, the experimental results shows that the SDS-TSI-Resnet34 method have been greatly improved compared with non-image methods SDS-LSTM, SDS-SVM and SDSKNN. Figure 9-13 shows the corn price from December 2000 to December 2001, the blue line is the real data, and the red line is the abnormal fluctuation detection results of SDS-TSI-Resnet34 and other comparison models proposed in this paper. The results show that the error rate of SDS-TSI-Resnet34 proposed in this paper is significantly lower than that of other methods, which proves the effectiveness of this algorithm. 3.As shown in Table 5, the SDS-TSI-Resnet34 algorithm proposed in this paper still has a good result on the time series of wheat price, which is greatly improved compared with baseline algorithms. Therefore, the SDS-TSI-Resnet34 algorithm proposed in this paper has strong generalization ability and can be widely used to judge the abnormal fluctuation of most of the time series of agricultural prices. In the same way, Figure 14-18 shows the accuracy of SDSTSI-Resnet34 judgment in wheat price time series, and the results also prove the point of this paper. 4.The contrast table 2 and 5, we found that the same algorithms used in wheat price time series are better than that of corn price time series, the reason may lie in nearly 20 years of domestic agricultural policy is relatively stable, the state of wheat prices of important agricultural and sideline products such as the reasonable intervention, resulting in abnormal volatility is reduced, more conducive to demonstrate the superiority of the algorithm. The practical guiding significance of the agricultural product price abnormal fluctuation detection algorithm proposed in this paper is as follows: (1)Strengthen agro-business cooperation and reduce circulation links. It is suggested that the government take the lead and establish sales channels from production to purchase, wholesale and retail. According to the algorithm to judge the outliers and abnormal fluctuations of agricultural prices to make\na reasonable production planning, effectively avoid the problem of oversupply, which is conducive to the stability of agricultural prices to a certain extent. (2)Strengthen monitoring and early warning of agricultural prices. The algorithm proposed in this paper can help relevant departments strengthen the monitoring of agricultural product prices, improve the timeliness of detection, carefully analyze the market price dynamics, accurately analyze the market price trend, be impatient, do a good job in market price analysis and early warning, and provide basic data and information services for the scientific decision-making of the government."
        },
        {
            "heading": "5 Conclusion",
            "text": "The price fluctuation of agricultural products is an important indicator related to the national economy and the people\u2019s livelihood. In this paper, a TSI-Resnet34 model based on the Standard deviation-Slope abnormal fluctuation judgment criterion is proposed to detect the fluctuations of agricultural prices time series as normal or abnormal. Based on the original standard deviation, the model in this paper adds the judgment criterion of slope, which can judge more microscopic abnormal fluctuations. At the same time, the time series image method and deep learning model are combined to automatically extract features from the time series of agricultural prices and classify abnormal fluctuations. The experiment is carried out on two agricultural price data sets, and good results are obtained, which proves the applicability of SDSTSI-Resnet34 model. In experimental results, our method achieved an average F1 score of around 90%, which is higher than the average of 25% for other methods. In our future work, we plan to explore the imaging methods of time series images of agricultural futures prices and use more data sets to verify the generalization ability of this algorithm.\nAcknowledgements This work was supported by the National Natural Science Foundation of China (71971089,72001083).\nCompliance with ethical standards\nConflict of interest All Authors declar that they have no conflict of interest. Ethical approval This artical does not contain any studies with human participants or animals performed by any of the authors.\nAuthorship Contributions\nWentao Jiang Software, Data curation, Writing, Methodology.Dabin Zhang Writing-review, Supervision. Liwen Ling Conceptualization, Methodology,\nWriting - review, Supervision. Guotao Cai Software, Data curation. Liling Zeng Data curation."
        }
    ],
    "title": "Time series to imaging based deep learning model for detecting abnormal uctuation in agriculture product price",
    "year": 2022
}