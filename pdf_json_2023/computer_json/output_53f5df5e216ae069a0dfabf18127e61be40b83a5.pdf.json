{
    "abstractText": "We analyze the preservation properties of a family of reversible splitting methods when they are applied to the numerical time integration of linear differential equations defined in the unitary group. The schemes involve complex coefficients and are conjugated to unitary transformations for sufficiently small values of the time step-size. New and efficient methods up to order six are constructed and tested on the linear Schr\u00f6dinger equation.",
    "authors": [
        {
            "affiliations": [],
            "name": "J. Bernier"
        },
        {
            "affiliations": [],
            "name": "S. Blanes"
        },
        {
            "affiliations": [],
            "name": "F. Casas"
        },
        {
            "affiliations": [],
            "name": "A. Escorihuela-Tom\u00e0s"
        }
    ],
    "id": "SP:71af6bb7f0ff3f2cf4d7bfabc7e197a4d2f5069a",
    "references": [
        {
            "authors": [
                "A. Bandrauk",
                "H. Shen"
            ],
            "title": "Improved exponential split operator method for solving the time-dependent Schr\u00f6dinger equation",
            "venue": "Chem. Phys. Lett. 176, 428\u2013432",
            "year": 1991
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas"
            ],
            "title": "A Concise Introduction to Geometric Numerical Integration",
            "venue": "CRC Press, Boca Raton",
            "year": 2016
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas",
                "P. Chartier",
                "A. Escorihuela-Tom\u00e0s"
            ],
            "title": "On symmetric-conjugate composition methods in the numerical integration of differential equations",
            "venue": "Math. Comput. 91, 1739\u20131761",
            "year": 2022
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas",
                "A. Escorihuela-Tom\u00e0s"
            ],
            "title": "Applying splitting methods with complex coefficients to the numerical integration of unitary problems",
            "venue": "J. Comput. Dyn. 9, 85\u2013101",
            "year": 2022
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas",
                "A. Escorihuela-Tom\u00e0s"
            ],
            "title": "Runge\u2013Kutta\u2013Nystr\u00f6m symplectic splitting methods of order 8",
            "venue": "Appl. Numer. Math. 182, 14\u201327",
            "year": 2022
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas",
                "A. Murua"
            ],
            "title": "On the linear stability of splitting methods",
            "venue": "Found. Comput. Math. 8, 357\u2013393",
            "year": 2008
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas",
                "A. Murua"
            ],
            "title": "Splitting and composition methods in the numerical integration of differential equations",
            "venue": "Bol. Soc. Esp. Mat. Apl. 45, 89\u2013145",
            "year": 2008
        },
        {
            "authors": [
                "F. Castella",
                "P. Chartier",
                "S. Descombes",
                "G. Vilmart"
            ],
            "title": "Splitting methods with complex times for parabolic equations",
            "venue": "BIT Numer. Math. 49, 487\u2013508",
            "year": 2009
        },
        {
            "authors": [
                "S. Fl\u00fcgge"
            ],
            "title": "Practical Quantum Mechanics",
            "venue": "Springer, Berlin",
            "year": 1971
        },
        {
            "authors": [
                "F. Goth"
            ],
            "title": "Higher order auxiliary field quantum Monte Carlo methods, Tech",
            "venue": "Rep. 2009.0449, arXiv",
            "year": 2020
        },
        {
            "authors": [
                "F. Goth"
            ],
            "title": "Higher order auxiliary field quantumMonte Carlo methods",
            "venue": "J. Phys: Conf. Ser. 2207, 012029",
            "year": 2022
        },
        {
            "authors": [
                "E. Hairer",
                "C. Lubich",
                "G. Wanner"
            ],
            "title": "Geometric Numerical Integration",
            "venue": "Structure-Preserving Algorithms for Ordinary Differential Equations, Second ed. Springer, Berlin",
            "year": 2006
        },
        {
            "authors": [
                "E. Hansen",
                "A. Ostermann"
            ],
            "title": "Exponential splitting for unbounded operators",
            "venue": "Math. Comput. 78, 1485\u2013 1496",
            "year": 2009
        },
        {
            "authors": [
                "E. Hansen",
                "A. Ostermann"
            ],
            "title": "High order splitting methods for analytic semigroups exist",
            "venue": "BIT Numer. Math. 49, 527\u2013542",
            "year": 2009
        },
        {
            "authors": [
                "T. Jahnke",
                "C. Lubich"
            ],
            "title": "Error bounds for exponential operator splittings",
            "venue": "BIT 40, 735\u2013744",
            "year": 2000
        },
        {
            "authors": [
                "C. Lubich"
            ],
            "title": "From Quantum to Classical Molecular Dynamics: Reduced Models and Numerical Analysis",
            "venue": "European Mathematical Society, Helsinki",
            "year": 2008
        },
        {
            "authors": [
                "R. McLachlan",
                "R. Quispel"
            ],
            "title": "Splitting methods",
            "venue": "Acta Numer. 11, 341\u2013434",
            "year": 2002
        },
        {
            "authors": [
                "M. Thalhammer"
            ],
            "title": "Convergence analysis of high-order time-splitting pseudo-spectral methods for nonlinear Schr\u00f6dinger equations",
            "venue": "SIAM J. Numer. Anal. 50, 3231\u20133258",
            "year": 2012
        }
    ],
    "sections": [
        {
            "text": "Keywords Splitting methods \u00b7 Complex coefficients \u00b7 Unitary problems\nMathematics Subject Classification 65L05 \u00b7 65L20 \u00b7 65M70\nCommunicated by Mechthild Thalhammer.\nB F. Casas Fernando.Casas@mat.uji.es\nJ. Bernier joackim.bernier@univ-nantes.fr\nS. Blanes serblaza@imm.upv.es\nA. Escorihuela-Tom\u00e0s alescori@uji.es\n1 CNRS, Laboratoire de Math\u00e9matiques Jean Leray, LMJL, Nantes Universit\u00e9, F-44000 Nantes, France\n2 Universitat Polit\u00e8cnica de Val\u00e8ncia, Instituto de Matem\u00e1tica Multidisciplinar, 46022 Valencia, Spain\n3 Departament de Matem\u00e0tiques and IMAC, Universitat Jaume I, 12071 Castell\u00f3n, Spain"
        },
        {
            "heading": "1 Introduction",
            "text": "We are concerned in this work with the numerical integration of the linear ordinary differential equation\ni du\ndt + Hu = 0, u(0) = u0, (1.1)\nwhere u \u2208 CN and H \u2208 RN\u00d7N is a real matrix. A particular example of paramount importance leading to Eq. (1.1) is the time-dependent Schr\u00f6dinger equation once it is discretized in space. In that case H (related to the Hamiltonian of the system) can be typically split into two parts, H = A + B. The equation\ny\u2032\u2032 + Ky = 0\nwith y \u2208 Rd , K \u2208 Rd\u00d7d can also be recast in the form (1.1) if the matrix K satisfy certain conditions [6].\nAlthough the solution of (1.1) is given by u(t) = ei t H u0, very often the dimension of H is so large that evaluating directly the action of the matrix exponential on u0 is computationally very expensive, and so other approximation techniques are desirable. When H = A + B and ei t Au0, ei t Bu0 can be efficiently evaluated, then splitting methods constitute a natural option [17]. They are of the form\nSh = eiha0A eihb0B \u00b7 \u00b7 \u00b7 eihb2n\u22121B eiha2n A (1.2)\nfor a time step h. Here a j , b j are coefficients chosen in such a way that Sh = eihH + O(h p+1) when h \u2192 0 for a given p \u2265 1. After applying the Baker\u2013Campbell\u2013 Hausdorff (BCH) formula, Sh can be formally expressed as Sh = exp (ihHh), with i Hh = i Hoh + Heh and\nHoh = (g1,1A + g1,2B) + h2(g3,1[A, [A, B]] + g3,2[B, [A, B]]) + . . . Heh = hg2,1[A, B] + h3(g4,1[A, [A, [A, B]]] + . . .) + . . .\nHere [A, B] := AB \u2212 BA, gk, j are polynomials of degree k in the coefficients ai , bi verifying g1,1 = g1,2 = 1 (for consistency), and gk, j = 0, k = 1, 2, . . . , p, \u2200 j for achieving order p.\nIf A and B are real symmetric matrices, then [A, B] is skew-symmetric and [A, [A, B]] is symmetric. In general, all nested commutators with an even number of matrices A, B are skew-symmetric and those containing an odd number are symmetric, so that (Hoh )\nT = Hoh and (Heh )T = \u2212Heh . When the coefficientsa j , b j are real, then gk, j are also real and therefore Sh = eihHh is a unitarymatrix. In addition, if the composition (1.2) is palindromic, i.e.,a2n\u2212 j = a j , b2n\u22121\u2212 j = b j , j = 1, 2, . . ., then g2k, j = 0 and H\u2212h = Hh , thus leading to a timereversible method, S\u2212h = S\u22121h . In other words, if un denotes the approximation at\ntime t = nh, then S\u2212h(un+1) = un . As a result, one gets a very favorable long-time behavior of the error for this type of integrators [16]. Thus, in particular,\nM(u) := |u|2 (norm)\nand\nH(u) := u\u0304T Hu (expected value of the energy)\nare almost globally preserved. Recently, some preliminary results obtained with a different class of splitting methods (1.2) have been reportedwhen they are applied to the semi-discretized Schr\u00f6dinger equation [4]. These schemes are characterized by the fact that the coefficients in (1.2) are complex numbers. Notice, however, that in this case the polynomials gk, j \u2208 C, so that Sh = eihHh is not unitary in general. This is so even for palindromic compositions, since g2 +1, j are complex anyway.\nThere is nevertheless a special symmetry in the coefficients, namely\na2n\u2212 j = a j and b2n\u22121\u2212 j = b j , j = 1, 2, . . . , (1.3)\nworth to be considered. Methods of this class can be properly called symmetricconjugate compositions. In that case, a straightforward computation shows that the resulting composition satisfies\nSh = S\u22121h (1.4)\nfor real matrices A and B, and in addition\n(Sh) T = S\u2212h (1.5)\nif A and B are real symmetric. In consequence,\ni Hh = i(H + H\u0302oh ) + i H\u0302 eh for certain real matrices H\u0302oh (symmetric), and H\u0302 e h (skew-symmetric). Since i H\u0302 e h is not real, then unitarity is lost. In spite of that, the examples collected in [4] seem to indicate that this class of schemes behave as compositions with real coefficients regarding preservation properties, at least for sufficiently small values of h. Intuitively, this can be traced back to the fact that i H\u0302 eh = O(h p) and is purely imaginary.\nOne of the purposes of this paper is to provide a rigorous justification of this behavior by generalizing the treatment done in [4] for the problem (1.1) defined in the group SU(2), i.e., when H is a linear combination of Pauli matrices. In particular, we prove here that, typically, any consistent symmetric-conjugate splitting method applied to (1.1) when H is real symmetric, is conjugated to a unitary method for sufficiently small values of h. In fact, this property can be related to the reversibility of the map Sh with respect to complex conjugation, as specified next.\nLet C be the linear transformation defined by C(u) = u for all u \u2208 CN . Then, the differential equation (1.1) is C-reversible, in the sense that C(i Hu) = \u2212i H(C(u)) [12, section V.1]. Moreover, since (1.4) holds, then C \u25e6 Sh = S\u22121h \u25e6C . In other words, the map Sh(u) is C-reversible [12] (or reversible for short). Notice that this also holds for palindromic compositions (1.2) with real coefficients.\nIn the sequel we will refer to compositions verifying (1.3) as symmetric-conjugate or reversible methods.\nSplitting and composition methods with complex coefficients have also interesting properties concerning the magnitude of the successive terms in the asymptotic expansion of the local truncation error. Contrarily to methods with real coefficients, higher order error terms in the expansion of a given method have essentially a similar size as lower order terms [3]. In addition, an integrator of a given order with the minimum number of flows typically achieves a good efficiency, whereas with real coefficients one has to introduce additional parameters (and therefore more flows in the composition) for optimization purposes. It makes sense, then, to apply this class of schemes to equation (1.1) and eventually compare their performance with splitting methods involving real coefficients, since in any case the presence of complex coefficients does not lead to an increment in the overall computational cost.\nThe structure of the paper goes as follows. InSect. 2weprovide further experimental evidence of the preservation properties exhibited by C-reversible splitting methods applied to different classes of matrices H by considering several illustrative numerical examples. In Sect. 3we analyze in detail this type ofmethods and validate theoretically the observed results by stating two theorems concerning consistent reversible maps. Then, inSect. 4wepresent newsymmetric-conjugate schemesup to order 6 specifically designed for the semi-discretized Schr\u00f6dinger equation and other problems with the same algebraic structure. Finally, these newmethods are tested in Sect. 5 for a specific potential."
        },
        {
            "heading": "2 Symmetric-conjugate splittingmethods in practice: some illustrative examples",
            "text": "To illustrate the preservation properties exhibited by symmetric-conjugate (or reversible) methods when applied to (1.1) with H = A + B, we consider some low order compositions of this type. Specifically, the tests will be carried out with the following schemes:\nOrder 3. The simplest symmetric-conjugate method corresponds to\nS[3,1]h = eihb0B eiha1A eihb1B eiha1A eihb0B, (2.1)\nwith a1 = 12 + i \u221a 3 6 , b0 = a12 , b1 = 12 and was first obtained in [1]. In addition, and as a representative of the schemes considered in Sect. 4, we also use the following method, with a j > 0 and b j \u2208 C, (b j ) > 0:\nS[3,2]h = eihb0B eiha1A eihb1B eiha2A eihb1B eiha1A eihb0B, (2.2)\nwhere\na1 = 3 10 , a2 = 2 5 , b0 = 13 126 \u2212 i\n\u221a 59/2\n63 , b1 = 25 63 + i 5\n\u221a 59/2\n126 .\nOrder 4. The scheme has the same exponentials as (2.2),\nS[4]h = eihb0B eiha1A eihb1B eiha2A eihb1B eiha1A eihb0B, (2.3)\nbut now\na1 = 1 12 (3 + i\u221a15), a2 = 1 2 , b0 = a1 2 , b1 = 1 24 (9 + i\u221a15).\nWhen the matrix H results from a space discretization of the time-dependent Schr\u00f6dinger equation (for instance, by means of a pseudo-spectral method), then it is real symmetric and A, B are also symmetric (in fact, B is diagonal). It makes sense, then, to start analyzing this situation, where, in addition, all the eigenvalues of H are simple. To proceed, we generate a N \u00d7 N real matrix with N = 10 and uniformly distributed elements in the interval (0, 1), and take H as its symmetric part. The symmetric matrix A is generated analogously, and finally we fix B = H \u2212 A. Next we compute the approximations obtained by S[3,1]h , S [3,2] h and S [4] h for different values of h, determine their eigenvalues \u03c9 j and compute the quantity\nDh = max 1\u2264 j\u2264N( \u2223 \u2223|\u03c9 j | \u2212 1 \u2223 \u2223)\nfor each h. Finally, we depict Dh as a function of h. Figure1 (left) is representative of the results obtained in all cases we have tested: all |\u03c9 j | are 1 (except round-off) for some interval 0 < h < h\u2217, and then there is always some \u03c9 such that |\u03c9 | > 1. In other words, S[3,1]h , S[3,2]h and S[4]h behave as unitary maps in this interval. This is precisely what happens in the group SU(2), as shown in [4].\nThe right panel of Fig. 1 is obtained in the same situation (i.e., H real symmetric with simple eigenvalues), but now both A and B are no longer symmetric: essentially the same behavior as before is observed. Of course, when h < h\u2217, both the norm of u,M(u), and the expected value of the energy,H(u) are preserved for long times, as shown in [4].\nOur next simulation concerns a real (but not symmetric) matrix H with all its eigenvalues real and simple. Again, there exists a threshold h\u2217 > 0 such that for h < h\u2217 the schemes render unitary approximations. This is clearly visible in Fig. 2 (left panel). If we consider instead a completely arbitrary real matrix H , then the outcome is rather different: Dh > 0 for any h > 0 (right panel; for this example Dh = 9.79 \u00b7 10\u22124 already for h = 0.001).\nNext we illustrate the situation when the real matrix H has multiple eigenvalues but is still diagonalizable. As before, we consider first the analogue of Fig. 1, namely: H is symmetric, with A and B symmetric matrices (Fig. 3, left panel) and A and B\nare real, but not symmetric (right panel). In the first case we notice that, whereas all the eigenvalues of the approximations rendered by S[3,1]h and S [4] h still have absolute value 1 for some interval 0 < h < h\u2217, this is clearly not the case of S[3,2]h . If, on the other hand, the splitting is done is such a way that A and B are not symmetric (but still real), then Dh > 0 even for very small values of h. The same behavior is observed when H is taken as a real (but not symmetric), diagonalizable matrix with multiple real eigenvalues.\nThedifferent phenomena exhibited by these examples require then adetailed numerical analysis of the class of schemes involved, trying to explain in particular the role played by the eigenvalues of the matrix H in the final outcome, as well as the different behavior of S[3,1]h and S [3,2] h . This will be the subject of the next section."
        },
        {
            "heading": "3 Numerical analysis of reversible integration schemes",
            "text": ""
        },
        {
            "heading": "3.1 Main results",
            "text": "We next state two theorems and two additional corollaries that, generally speaking, justify the previous experiments and explain the good behavior exhibited by reversible methods.\nTheorem 3.1 Let H \u2208 RN\u00d7N be a real matrix and let Sh \u2208 CN\u00d7N be a family of complex matrices depending smoothly on h \u2208 R such that \u2022 Sh is a reversible map in the previous sense, so that\nSh = S\u22121h ;\n\u2022 Sh is consistent with exp(ihH), i.e. there exists p \u2265 1 such that\nSh = h\u21920 e ihH + O(h p+1); (3.1)\n\u2022 the eigenvalues of H are real and simple. Then there exist\n\u2022 Dh, a family of real diagonal matrices depending smoothly on h, \u2022 Ph, a family of real invertible matrices depending smoothly on h,\nsuch that Ph = P0 + O(h p), Dh = D0 + O(h p) and, provided that |h| is small enough,\nSh = Ph eihDh P\u22121h . (3.2)\nCorollary 3.2 In the setting of Theorem 3.1, there exists a constant C > 0 such that, provided that |h| is small enough, for all u \u2208 CN and all eigenvalues \u03c9 \u2208 \u03c3(H), one\nhas\nsup n\u22650\n\u2223 \u2223 \u2223| \u03c9Snh u| \u2212 | \u03c9u| \u2223 \u2223 \u2223 \u2264 C |h|p|u|, (3.3)\nwhere \u03c9 denotes the spectral projector onto Ker(H \u2212 \u03c9IN ). Moreover, if H is symmetric, the norm and the energy are almost conserved, in the sense that, for all u \u2208 CN , it holds that\nsup n\u2208Z\n\u2223 \u2223M(Snh u) \u2212 M(u) \u2223 \u2223 \u2264 C |h|p|u|2 and sup\nn\u2208Z\n\u2223 \u2223H(Snh u) \u2212 H(u) \u2223 \u2223 \u2264 C |h|p|u|2,\n(3.4)\nwhere M(u) = |u|2 and H(u) = uT Hu.\nProof of Corollary 3.2 First, we focus on (3.3). We note that by consistency, we have\nD0 = P\u221210 HP0.\nSince the eigenvalues of H are simple, it follows that the spectral projectors are all of the form\n( j) = P0(e j \u2297 e j )P\u221210 , (3.5)\nwhere e1, . . . , eN denotes the canonical basis of RN . Then, we note that for all n \u2208 Z, we have\nSnh = Ph einhDh P\u22121h .\nTherefore, since einhDh is uniformly bounded with respect to h and n (because Dh is a real diagonal matrix) and Ph = P0 + O(h p), it follows that\nSnh = P0 einhDh P\u221210 + O(h p),\nwhere the implicit constant inO term does not depend on n (here and later). Therefore, it is enough to use the explicit formula (3.5) to prove that\n( j)Snh = P0(e j \u2297 e j )P\u221210 P0 einhDh P\u221210 + O(h p) = einh(Dh) j, j ( j) + O(h p).\nAs a consequence, the estimate (3.3) follows directly by the triangular inequality:\n| ( j)Snh u| = |einh(Dh) j, j ( j)u + O(h p)(u)| \u2264 |einh(Dh) j, j ( j)u| + |u|O(h p) = | ( j)u| + |u|O(h p).\nNow, we focus on (3.4). Here, since H is assumed to be symmetric, its eigenspaces are orthogonal. Therefore by the Pythagorean theorem, we have\nM(u) = \u2211\n\u03c9\u2208\u03c3(H) | \u03c9(u)|2 and H(u) =\n\u2211\n\u03c9\u2208\u03c3(H) \u03c9| \u03c9(u)|2.\nAs a consequence, (3.4) follows directly of (3.3). The main limitation of Theorem 3.1 is the assumption on the simplicity of the eigenvalues of H . Indeed, even if this assumption is typically satisfied, it depends only on the equation we aim at solving and not of the numerical method one uses. The following theorem, which is a refinement of Theorem 3.1, remedies this point by making an assumption on the leading term of the consistency error (which is typically satisfied for generic choices of numerical integrators).\nTheorem 3.3 Let H \u2208 RN\u00d7N be a real matrix and let Sh \u2208 CN\u00d7N be a family of complex matrices depending smoothly on h such that\n\u2022 Sh is a reversible map, i.e.\nSh = S\u22121h ;\n\u2022 Sh is consistent with exp(ihH), i.e.\nSh = h\u21920 e ihH + ih p+1R + O(h p+2), (3.6)\nwhere p \u2265 1 is the order of consistency and R is a real matrix;1 \u2022 H is diagonalizable and its eigenvalues are real; \u2022 for all \u03c9 \u2208 \u03c3(H), the eigenvalues of \u03c9R|E\u03c9(H) are real and simple, where \u03c9 denotes the spectral projector on E\u03c9(H) := Ker(H \u2212 \u03c9IN ).\nThen there exist\n\u2022 Dh, a family of real diagonal matrices depending smoothly on h, \u2022 Ph, a family of real invertible matrices depending smoothly on h,\nsuch that, both P\u221210 BP0 and P \u22121 0 HP0 are diagonal, where B := \u2211\n\u03c9\u2208\u03c3(H) \u03c9 R \u03c9, and provided that |h| is small enough, it holds that\nSh = Ph eihDh P\u22121h . (3.7)\nCorollary 3.4 In the setting of Theorem 3.3, there exists a constant C > 0 such that, provided that |h| is small enough, for all u \u2208 CN , all \u03c9 \u2208 \u03c3(H) and all \u03bb \u2208 \u03c3( \u03c9R|E\u03c9(H)), we have\nsup n\u22650\n\u2223 \u2223 \u2223|P\u03bb,\u03c9Snh u| \u2212 |P\u03bb,\u03c9u| \u2223 \u2223 \u2223 \u2264 C |h||u|,\n1 The fact that R is a real matrix is a consequence of the reversibility of Sh .\nwhere P\u03bb,\u03c9 denotes the projector along \u2295\n(\u03b7,\u03bc) =(\u03bb,\u03c9) E\u03b7( \u03bcR|E\u03bc(H)) onto E\u03bb( \u03c9R|E\u03c9(H)).\nMoreover, if H and R are symmetric, for all \u03c9 \u2208 \u03c3(H), one gets\nsup n\u22650\n\u2223 \u2223 \u2223| \u03c9Snh u|2 \u2212 | \u03c9u|2 \u2223 \u2223 \u2223 \u2264 C |h||u|2,\nand the mass and the energy are almost conserved, i.e. for all u \u2208 CN , it holds that\nsup n\u2208Z\n\u2223 \u2223M(Snh u) \u2212 M(u) \u2223 \u2223 \u2264 C |h||u|2 and sup\nn\u2208Z\n\u2223 \u2223H(Snh u) \u2212 H(u) \u2223 \u2223 \u2264 C |h||u|2,\nwhere, as before, M(u) = |u|2 and H(u) = uT Hu. Proof of Corollary 3.4 The proof is almost identical to the one of Corollary 3.2. The key point is that, since both P\u221210 BP0 and P \u22121 0 HP0 are diagonal, then the projectors P\u03bb,\u03c9 are exactly the projectors ( j), 1 \u2264 j \u2264 N (given by (3.5)). Note that, contrary to Theorem 3.1, in Theorem 3.3 one does not claim that Ph = P0 + O(h p). A priori, here, in general, the best estimatewe expect is Ph = P0+O(h) (which follows directly from the smoothness of Ph with respect to h). It is this loss which explains why, in Corollary 3.4, the error terms are of order O(h) whereas they are of order O(h p) in Corollary 3.2. Remark Before starting the proof of these theorems, let us provide some comments about the context and the ideas involved.\n\u2022 In Theorem 3.1 and its proof, we are just putting Sh in Birkhoff normal form. The fact that Sh can be diagonalized is due to the simplicity of the eigenvalues of H while the fact that its eigenvalues are complex numbers of modulus 1 is due to the reversibility of Sh . This approach is robust and well known, in particular it can be extended to the nonlinear setting (see e.g. [12, section V.1]). Note that here, we reach convergence of the Birkhoff normal form because the system is linear. \u2022 Theorem 3.3 is a refinement of Theorem 3.1. To prove the absence of resonances due to the multiplicity of the eigenvalues of H , we use the first correction to the frequencies generated by the perturbation of H (i.e., the projections of R in Theorem 3.3). This approach is typical of what one does in the proof of Nekhoroshev theorems or KAM theorems (see also [12]). \u2022 In order to give some intuition about the proof and the assumptions of Theorem 3.1, let us prove simply that, provided h is small enough, Sh is conjugated to a unitary matrix. Indeed, since Sh is reversible it writes as\nSh = eihHh ,\nwhere Hh = H + O(h p) is a real matrix (provided that h is small enough). Now, since the set of the real matrices whose eigenvalues are simple and real is open in the space of the real matrices (by continuity of the eigenvalues) and Hh is a real perturbation of such a matrix (H by assumption), we deduce that, provided\nh is small enough, its eigenvalues are simple and real. This implies that Hh is conjugated to a real diagonal matrix and so that Sh is conjugated to a unitary matrix."
        },
        {
            "heading": "3.2 Technical lemmas",
            "text": "In the proof of the previous theorems we will make use of the following three lemmas.\nLemma 3.5 Let M be a complex matrix and let P be a complex invertible matrix. Then adP\u22121MP and adM are similar. More precisely,\nadintP M = (intP )adM (intP )\u22121, where intPM := P\u22121MP. Here adM stands for the adjoint operator: adM X := [M, X ] = MX \u2212 XM, for any matrix X. Proof A straightforward calculation shows that, for any X ,\n(intP )adM X = P\u22121[M, X ]P = [P\u22121MP, P\u22121X P] = adintP M (P\u22121X P) = adintP M (intP )X .\nLemma 3.6 Let M be a complex matrix. Then M is diagonalizable if and only if the kernel and the image of adM are supplementary, i.e.\nKerC adM \u2229 ImC adM = {0}. (3.8) Proof We can assume, in virtue of Lemma 3.5 and without loss of generality, that M is in Jordan normal form.2 On the one hand, if M is diagonal, we have adM A = ((mi,i \u2212m j, j )A)i, j and so the support of the matrices in KerC adM and ImC adM are clearly disjoint (which implies (3.8)). Conversely, doing calculations by blocks it is enough to consider the case where M = \u03bbIN + N is a Jordan matrix (i.e. \u03bb \u2208 C and N nilpotent). Then we just have to note that ad\u03bbIN+N = adN and that since adN is nilpotent necessarily we have KerC adN \u2229 ImC adN = {0}. Lemma 3.7 Let Mh be a family of real matrices depending smoothly on h and of the form\nMh = M0 + O(h p), where p \u2265 1. If M0 is diagonalizable on C, then there exists a family of real matrices \u03c7h, depending smoothly on h, such that if |h| is small enough, e\u2212h p\u03c7h Mh eh p\u03c7h commutes with M0, i.e.\n[eh p\u03c7h Mh e\u2212h p\u03c7h , M0] = 0. 2 Indeed, the property (3.8) is clearly invariant by conjugation of adM and by Lemma 3.5 we know that adM is conjugated to the adjoint representation of any Jordan normal form of M .\nProof We aim at designing the family \u03c7h as solution of the equation\nadM0 ( eh p\u03c7h Mh e \u2212h p\u03c7h ) = 0.\nThanks to the well known identity eAB e\u2212A = eadA B, this equation rewrites as\nadM0 ( eh pad\u03c7h Mh ) = 0. (3.9)\nNext we write the Taylor expansion of Mh at order p as\nMh = M0 + h pRh,\nwhere Rh is a family of real matrices depending smoothly on h. Then, isolating the terms of order 0 (and dividing by h p), the Eq. (3.9) leads to\nf (h, \u03c7h) := adM0 ( eh pad\u03c7h Rh \u2212 \u03d51(h pad\u03c7h ) adM0\u03c7h ) = 0,\nwhere \u03d51(z) := ez\u22121z . We restrict ourselves to \u03c7h in ImR adM0 and consider f as a smooth map from R \u00d7 ImR adM0 to ImR adM0 . To solve the equation f (h, \u03c7h) = 0 using the implicit function theorem, we just have to design \u03c70 so that\nf (0, \u03c70) = adM0 R0 \u2212 ad2M0\u03c70 = 0\nand prove that d\u03c7 f (0, \u03c70) = \u2212ad2M0 : ImR adM0 \u2192 ImR adM0 is invertible. Actually, these properties are clear because the first one is a consequence of the second one, whereas the second follows directly from Lemma 3.6."
        },
        {
            "heading": "3.3 Proofs of the theorems",
            "text": "We are now in a position to prove Theorems 3.1 and 3.3. Without loss of generality, and to simplify notations, we assume that H is diagonal\nH = \u239b \u239c \u239d \u03c91 In1 . . .\n\u03c9d Ind\n\u239e\n\u239f \u23a0 ,\nwhere \u03c91 < \u00b7 \u00b7 \u00b7 < \u03c9d denote the eigenvalues of H and n1, \u00b7 \u00b7 \u00b7 , nd are positive integers satisfying n1 + \u00b7 \u00b7 \u00b7 + nd = N .\nThanks to the consistency assumption (3.6) (which is equivalent to (3.1)), provided that |h| is small enough, Sh rewrites as\nSh = eihHh , where Hh = H + h pR + O(h p+1).\nMoreover, the reversibility assumption S\u22121h = Sh implies that Hh is a real matrix (provided that |h| is small enough). Note that, hence, we deduce that R is also a real matrix. Then, applying Lemma 3.7 to Hh , we get a family of real matrices \u03c7h such that, provided that |h| is small enough,\n[Wh, H ] = 0, where Wh = eh p\u03c7h Hh e\u2212h p\u03c7h .\nWe conclude that Wh is block-diagonal (with the same structure of blocks as H ), i.e. there exists some n j \u00d7 n j real matrices W ( j)h such that\nWh = \u239b \u239c \u239d W (1)h . . .\nW (d)h\n\u239e\n\u239f \u23a0 . (3.10)\nAs a consequence, if the eigenvalues of H are simple (i.e. d = N and n j = 1 for all j) then Wh is diagonal. Therefore, in this case, it is enough to set Ph = e\u2212h p\u03c7h and Wh = Dh to conclude the proof of Theorem 3.1.\nSo, from now on, we only focus on the proof of Theorem 3.3. First, we aim at identifying the matrices on the blocks in (3.10). The Taylor expansion ofWh is clearly\nWh = H + h pB + O(h p+1), with B := R + [\u03c70, H ].\nHowever, since [Wh, H ] = 0, we deduce that [B, H ] = 0 and so that B is blockdiagonal.Moreover, since thematrix [\u03c70, H ] is identically equal to zero on the diagonal blocks, the diagonal blocks of B are exactly those of R. As a consequence, with a slight abuse of notations, we may write\nW ( j)h = \u03c9In j + h pB( j) + h p+1Y ( j)h , where B( j) := \u03c9 j R|E\u03c9 j (H)\nand Y ( j)h is a family of real matrices depending smoothly on h. Next we aim at diagonalizing these blocks. By assumption, the eigenvalues of each matrix B( j) are real and simple. Therefore, all B( j) are diagonalizable. As a consequence, and again by applying Lemma 3.7, we get a family of real matrices\u03d2( j)h such that if |h| is small enough, for all j \u2208 1, d we have\n[\neh\u03d2 ( j) h (B( j) + hY ( j)h )e\u2212h\u03d2 ( j) h , B( j)\n]\n= 0.\nThis means that the eigenspaces of B( j) are stable by the action of eh\u03d2 ( j) h (B( j) + hY ( j)h )e \u2212h\u03d2( j)h . However, by assumption, these spaces are lines. Therefore, if Q( j) is a real invertible matrix such that Q( j)B( j)(Q( j))\u22121 is diagonal then Q( j)eh\u03d2 ( j) h (B( j) + hY ( j)h )e \u2212h\u03d2( j)h (Q( j))\u22121 is also diagonal.\nFinally, as a consequence, setting\nPh := e\u2212h p\u03c7h \u239b \u239c \u239c \u239d e\u2212h\u03d2 (1) h Q(1) . . .\ne\u2212h\u03d2 (d) h Q(d)\n\u239e\n\u239f \u239f \u23a0\nwe have proven that Dh := P\u22121h Hh Ph is real diagonal, which concludes the proof of Theorem 3.3."
        },
        {
            "heading": "3.4 Applications to reversible splitting and compositionmethods",
            "text": "Theorems 3.1 and 3.3 shed light on the behavior observed in the examples collected in Sect. 2. Thus, suppose H = A + B is a real symmetric matrix, with A, B also real. Furthermore, consider a splitting scheme Sh of the form (1.2) with coefficients satisfying the symmetry conditions (1.3) and consistency,\na0 + \u00b7 \u00b7 \u00b7 + a2n = 1, b0 + \u00b7 \u00b7 \u00b7 + b2n\u22121 = 1.\nClearly, Sh is a reversible map and moreover, it is consistent with eihH at least at order 1, so that (3.1) holds with p \u2265 1. Since H is real symmetric, it is diagonalizable. Therefore, if the eigenvalues of H are simple, the dynamics of (Snh )n\u2208Z is given by Theorem 3.1: for sufficiently small h, there exist real matrices Dh (diagonal) and Ph (invertible) so that Snh = Ph einDh P\u22121h , all the eigenvalues of Sh verify |\u03c9 j | = 1 and M(u) and H(u) are almost preserved for long times. This corresponds to the examples of Fig. 1. The same conclusions apply as long as H is a real matrix with all its eigenvalues real and simple (Fig. 2, left), whereas the general case of complex eigenvalues is not covered by the theorem, and no preservation is ensured (Fig. 2, right).\nSuppose now that the real matrix H has multiple real eigenvalues, but is still diagonalizable, and that A and B are real and symmetric. In that case, a symmetric-conjugate splitting method satisfies both conditions (1.4) and (1.5), so that it can be written as\nSh = eihHh ,\nwhere Hh is a family of real matrices whose even terms in h are symmetric and odd terms are skew-symmetric. Suppose in addition that Sh is of even order (i.e., p is even in (3.6)). In that case the matrix R in Theorem 3.3 is symmetric, and so its eigenvalues are real. Moreover, since R strongly depends on the coefficients a j , b j and the decomposition H = A + B, it is very likely that typically the eigenvalues of the operators \u03c9R|E\u03c9(H) are simple and so that the dynamics of (Snh )n\u2208Z is given by Theorem 3.3 and is therefore similar to the one of (einhH )n\u2208Z. Notice that this does not necessarily hold if the scheme is of odd order and/or A and B are not symmetric. This phenomenon is clearly illustrated in the examples of Fig. 3 by methods S[3,2]h and S[4]h .\nNotice, however, that method S[3,1]h , although of odd order, works in fact better than expected from the previous considerations. The reason for this behavior resides in the following\nProposition 3.8 The 3rd-order symmetric-conjugate splitting method\nS[3,1]h = eihb0B eiha1A eihb1B eiha1A eihb0B,\nwith a1 = 12 + i \u221a 3 6 , b0 = a12 , b1 = 12 , is indeed conjugate to a reversible integrator Vh of order 4, i.e., there exists a real near-identity transformation Fh such that Fh S [3,1] h F \u22121 h = Vh = eihH + O(h5) and V h = V\u22121h .\nProof Method S[3,1]h constitutes in fact a particular case of a composition \u03c8h = S[2]\u03b1\u0304h S[2]\u03b1h , where S[2]h is a time-symmetric 2nd-order method and \u03b1 = a1. Specifically, S[3,1]h is recovered when S[2]h = e h 2 B ehA e h 2 B . Therefore, it can be written as\nS[2]h = exp(ihH \u2212 ih3F3 + ih5F5 + \u00b7 \u00b7 \u00b7 )\nfor certain real matrices F2 j+1. In consequence, by applying the BCH formula, one gets \u03c8h = eW (h), with\nW (h) = ihH + 1 2 h4|\u03b1|2(\u03b12 \u2212 \u03b1\u03042)[H , F3]\n+ih5(w5,1F5 + w5,2[H , [H , F3]] ) + O(h6).\nHere w5, j are polynomials in \u03b1. Now let us consider\nVh = eV (h) = e\u03bbh3F3 eW (h) e\u2212\u03bbh3F3\nfor a given parameter \u03bb. Then, clearly,\nV (h) = e\u03bbh3adF3W (h) = ihH + h4 ( 1\n2 \u03b13 \u2212 i\u03bb\n)\n[H , F3] + O(h5),\nso that by choosing \u03bb = \u2212 i2\u03b13 = \u2212 \u221a 3\n18 , we have V (h) = ihH +O(h5) and the stated result is obtained, with Fh = e\u03bbh3F3 .\nThis result can be generalized as follows: given a time-symmetric method S[2k]h of order 2k, if \u03b1 is chosen so that the composition \u03c8h = S[2k]\u03b1\u0304h S[2k]\u03b1h is of order 2k + 1, then \u03c8h is conjugate to a reversible method of order 2k + 2.\nTheorems 3.1 and 3.3 also allow one to explain the good behavior shown by symmetric-conjugate composition methods for this type of problems. In fact, suppose H is a real symmetric matrix and zH is a family of linear maps which are\nconsistent with ei zH at least at order 1 and satisfy\n( zH ) \u22121 = zH .\nIf we define Sh as the symmetric-conjugate composition\nSh = \u03b10hH \u00b7 \u00b7 \u00b7 \u03b1nhH ,\nwhere \u03b1 j are some complex coefficients satisfying the symmetry condition\n\u03b1n\u2212 j = \u03b1 j , j = 1, 2, . . .\nand the consistency condition\n\u03b10 + \u00b7 \u00b7 \u00b7 + \u03b1n = 1,\nthen Sh is a reversible map. Moreover, it is consistent with eihH at least at order 1. Therefore, one can apply Theorems 3.1 and 3.3 also in this case. Notice, in particular, that even if the maps eiha j A and/or eihb j B in the symmetric-conjugate splitting method (1.2) are not computed exactly, but only conveniently approximated, the previous theorems still apply, so that one can expect good long term behavior from the resulting approximation."
        },
        {
            "heading": "4 Symmetric-conjugate splittingmethods for the Schr\u00f6dinger equation",
            "text": "An important application of the previous results corresponds to the numerical integration of the time dependent Schr\u00f6dinger equation ( = m = 1)\ni \u2202 \u2202t \u03c8(x, t) = H\u0302\u03c8(x, t), \u03c8(x, 0) = \u03c80(x), (4.1)\nwhere \u03c8 : R3 \u00d7 R \u2212\u2192 C. The Hamiltonian operator H\u0302 is the sum H\u0302 = T\u0302 + V\u0302 of the kinetic energy operator T\u0302 and the potential V\u0302 . Specifically,\n(T\u0302\u03c8)(x) = \u22121 2 \u03c8(x, t), (V\u0302\u03c8)(x) = V\u0302 (x)\u03c8(x, t).\nIn addition, a simple computation shows that [V\u0302 , [T\u0302 , V\u0302 ]] \u03c8 = |\u2207 V\u0302 |2\u03c8 , and therefore\n[V\u0302 , [V\u0302 , [V\u0302 , T\u0302 ]]] \u03c8 = 0. (4.2)\nAssuming d = 1 and periodic boundary conditions, the application of a pseudospectral method in space (with N points) leads to the N -dimensional system (1.1),\nwhereu(0) = u0 \u2208 CN and H represents the (real symmetric) N\u00d7N matrix associated with the operator \u2212H\u0302 [16]. Now\nH = A + B,\nwhere A is the (minus) differentiation matrix corresponding to the discretization of T\u0302 (a real and symmetric matrix) and B is the diagonal matrix associated to \u2212V\u0302 at the grid points. Since exp(t A) can be efficiently computed with the fast Fourier transform (FFT) algorithm, it is a common practice to use splitting methods of the form (1.2) to integrate this problem. In this respect, notice that property (4.2) will be inherited by the matrices A and B only if the number of discretization points N is sufficiently large to achieve spectral accuracy, i.e.,\n[B, [B, [B, A]]]u = 0 if N is large enough. (4.3)\nAssuming this is satisfied, then there is a reduction in the number of conditions necessary to construct a method (1.2) of a given order p [2, 12]. Integrators of this class are sometimes called Runge\u2013Kutta\u2013Nystr\u00f6m (RKN) splitting methods [5].\nTwo further points are worth remarking. First, the computational cost of evaluating (1.2) is not significantly increased by incorporating complex coefficients into the scheme, since one has to use complex arithmetic anyway. Second, since \u2211\nj a j = 1 for a consistent method, if a j \u2208 C, then both positive and negative imaginary parts are present, and this can lead to severe instabilities due to the unboundedness of theLaplace operator [8, 14]. On the other hand, the spurious effects introduced by complex b j can be eliminated (at least for sufficiently small values of h) by introducing an artificial cut-off bound in the potential when necessary.\nIn view of these considerations, we next limit our exploration to symmetricconjugate splitting methods of the form (1.2) with 0 < a j < 1 and b j \u2208 C with (b j ) > 0 to try to reduce the size of the error terms appearing in the asymptotic expansion of the modified Hamiltonian Hh associated with the integrator.\nFor simplicity, we denote the symmetric-conjugate splitting schemes Sh by their sequence of coefficients as\n(a0, b0, a1, b1, . . . , ar , br , ar , . . . , b1, a1, b0, a0). (4.4)\nAs a matter of fact, since A and B are sought to verify (4.3), sequences starting with B may lead to schemes with a different efficiency, so that we also analyze methods of the form\n(b0, a0, b1, a1, . . . , br , ar , br , . . . , a1, b1, a0, b0). (4.5)\nSchemes (4.4) and (4.5) include integrators where the central exponential corresponds to A (when br = 0) and B (when ar = 0), respectively. The method has s stages if the number of exponentials of A is precisely s for the scheme (4.5) or s + 1 for the scheme (4.4).\nThe construction process of methods within this class is detailed elsewhere (e.g. [5, 7] and references therein), so that it is only summarized here. First, we get the order conditions a symmetric-conjugate scheme has to satisfy to achieve a given order p = 4, 5 and 6. These are polynomial equations depending on the coefficients a j , b j , and can be obtained by identifying a basis in the Lie algebra generated by {A, B} and using repeatedly the BCH formula to express the splitting method as Sh = exp(hHh), with Hh in terms of A, B and their nested commutators. The order conditions up to order p are obtained by requiring that Hh = H + O(h)p+1, and the number is 7, 11 and 16 for orders 4, 5 and 6, respectively.\nSecond, we take compositions (4.4) and (4.5) involving the minimum number of stages required to solve the order conditions and get eventually all possible solutions with the appropriate symmetry. Sometimes, one has to add parameters, because there are no such solutions. In particular, there are no 4th-order schemes with 4 stages with both a j > 0 and (b j ) > 0.\nEven when there are appropriate solutions, it may be convenient to explore compositions with additional stages to have free parameters for optimization. This strategy usually pays off when purely real coefficients are involved, and so it is worth to be explored also in this context. Of course, some optimization criterion related with the error terms and the computational effort has to be adopted. In our study we look at the error terms in the expansion of Hh at successive orders and the size of the b j coefficients. Specifically, we compute for each method of order, say, p, the quantities\nb := \u2211\nj\n|b j | and E (r+1)f := s (Er+1 )1/r , r = p, p + 1, . . . (4.6)\nHere s is the number of stages and Er+1 is the Euclidean norm of the vector of error coefficients in Hh at higher orders than the method itself. In particular, for a method of order 6, E (7)f gives an estimate of the efficiency of the scheme by considering only the error at order 7. By computing E (8)f and E (9) f for this method we get an idea of how the higher order error terms behave. It will be of interest, of course, to reduce these quantities as much as possible to get efficient schemes.\nSolving the polynomial equations required to construct splittingmethodswith additional stages is not a trivial task, especially for orders 5 and 6. In these cases we have used the Python function fsolve of the SciPy library, with a large number of initial points in the space of parameters to start the procedure. From the total number of valid solutions thus obtained, we have selected those leading to reasonably small values of all quantities (4.6) and checked them on numerical examples.\nThe correspondingvalues for themost efficientmethodswehave foundby following this approach have been collected in Table 1, where NA\u2217[p]s refers to a symmetricconjugate method of type (4.4) of order p involving s stages, andNB\u2217[p]s is a similar scheme of type (4.5). For completeness, we have also included the most efficient integrators of order 4, 6 and 8with real coefficients for systems satisfying the condition (4.3) (same notation without \u2217) and also the symmetric-conjugate splitting schemes presented in [10, 11] (denoted by GB\u2217[p]s ). They do not take into account the property (4.3) for their formulation.\nIn Table 1 we also write the value of a := \u2211 j |a j | and b := \u2211 j |b j | for each method. Of course, by construction, a = 1 for all symmetric-conjugate integrators. The coefficients of themost efficient schemeswe have found (in boldface) are collected in Table 2.\nIn the \u201cAppendix\u201d we provide analogous information for general schemes of orders 3, 4, 5 and 6, i.e., of splitting methods for general problems of the form H = A + B, with a j > 0 and b j \u2208 C with (b j ) > 0. They typically involve more stages, but can be applied in more general contexts.\nOne should take into account, however, that all these symmetric-conjugate methods have been obtained by considering the ordinary differential Eq. (1.1) in finite dimension, whereas the time dependent Schr\u00f6dinger equation is a prototypical example of an evolutionary PDE involving unbounded operators (the Laplacian and possibly the potential). In consequence, one might arguably question the viability of using the above schemes in this setting. That this is indeed possible comes as a consequence of some previous results obtained in the context of PDEs defined in analytic semigroups.\nTable 2 Coefficients of the most efficient symmetric-conjugate RKN splitting methods of order 4, 5 and 6\nai bi\nNB\u2217[4]5 a0 = 0.17354158169943656 b0 = 0.06421454120274125 + 0.0245540186592381 i a1 = 0.19379086394173623 b1 = 0.20166370500451958 \u2212 0.0982277975564409 i a2 = 1 \u2212 2 \u22111 i=0 ai b2 = 12 \u2212 \u22111 i=0 (bi ) + 0.1491719824749133 i NB\u2217[4]6 a0 = 15 b0 = 7100 + 0.019444288930263294 i a1 = 0.054855282174763084 b1 = 0.16 \u2212 0.20579973912385285 i a2 = 12 \u2212 \u22111 i=0 ai b2 = 0.16251793145097668 + 0.21219211957584155 i\nb3 = 1 \u2212 2 \u22111\ni=0 (bi ) NB\u2217[5]8 a0 = 0.13556579817637690 b0 = 0.048 \u2212 0.0045117121645322032 i\na1 = 0.12110548685533656 b1 = 0.159 + 0.039915395925895825 i a2 = 0.040926280383255811 b2 = 0.08808186616153123 \u2212 0.19475521098317861 i a3 = 12 \u2212 \u22112 i=0 (ai ) b3 = 0.08139005735125036 + 0.17341123352295854 i\nb4 = 1 \u2212 2 \u22113\ni=0 bi NB\u2217[5]9 a0 = 0.066 b0 = 0.03 \u2212 0.026088775868557137 i\na1 = 0.066 b1 = 0.065 + 0.0871906864166141 i a2 = 0.15406042184345631 b2 = 0.087791471011534450 \u2212 0.07869869176637824 i a3 = 0.20434260458660722 b3 = 0.21903826707051549 + 0.005649631789653575 i a4 = 1 \u2212 2 \u22113 i=0 ai b4 = 12 \u2212 \u22113 i=0 (bi ) + 0.3080209334852549 i\nNA\u2217[6]11 a0 = 0.062770091 b0 = 0.10891717046144 \u2212 0.16165289456182 i a1 = 0.011912916558090 b1 = 0.05673774365156 + 0.19084324113721 i a2 = 0.20435669618321 b2 = 0.00000000664446 \u2212 0.2132590752834 i a3 = 0.019233264988143 b3 = 0.2404799796837 + 0.10112304441789 i a4 = 0.06593857714457 b4 = 0.04313692053520 + 0.11954730647763 i a5 = 12 \u2212 \u22114 i=0 ai b5 = 1 \u2212 2 \u22114 i=0 (bi ) NB\u2217[6]11 a0 = 2132500 b0 = 7250 \u2212 0.009532915454170 i a1 = 0.047358568390005 b1 = 0.08562523731685 + 0.0718344013568 i a2 = 0.1553620075936 b2 = 0.09331583397900 \u2212 0.09161071812994 i a3 = 0.10012117440925 b3 = 0.11799012127542 + 0.0702739287203 i a4 = 0.10547836949919 b4 = 0.16176918420712 \u2212 0.04327349898459 i a5 = 1 \u2212 2 \u22114 i=0 ai (b5) = 12 \u2212 \u22114 i=0 (bi ) \u2212 0.2203293328195 i\nSpecifically, Eq. (4.1) can be written in the generic form\nu\u2032 = L\u0302u = ( A\u0302 + B\u0302)u, u(0) = u0, (4.7)\nwith A\u0302 = i2 and B\u0302 = \u2212i V\u0302 . It has been shown in [13] (see also [15, 18]) that, under the two assumptions stated below, a splitting method of the form\nSh = eha0 A\u0302 ehb0 B\u0302 \u00b7 \u00b7 \u00b7 ehb2n\u22121 B\u0302 eha2n A\u0302 (4.8)\nis of order p for problem (4.7) if and only if it is of classical order p in the finite dimensional case. The assumptions are as follows:\n1. Semi-group property: A\u0302, B\u0302 and L\u0302 generate C0-semigroups on a Banach space X with norm \u2016 \u00b7 \u2016 and, in addition, they satisfy the bounds\n\u2016et A\u0302\u2016 \u2264 e\u03c9t , \u2016et B\u0302\u2016 \u2264 e\u03c9t\nfor some positive constant \u03c9 and all t \u2265 0. 2. Smoothness property: For any pair of multi-indices (i1, . . . , im) and ( j1, . . . , jm)\nwith i1 + \u00b7 \u00b7 \u00b7 + im + j1 + \u00b7 \u00b7 \u00b7 + jm = p + 1, and for all t \u2208 [0, T ],\n\u2016 A\u0302i1 B\u0302 j1 . . . A\u0302im B\u0302 jm et L\u0302 u0\u2016 \u2264 C\nfor a positive constant C .\nThese conditions restrict the coefficients a j , b j in (4.8) to be positive, however, and thus the method to be of second order at most. Nevertheless, it has been shown in [8, 14] that, if in addition L\u0302 , A\u0302 and B\u0302 generate analytic semigroups on X defined in the sector \u03c6 = {z \u2208 C : | arg z| < \u03c6}, for a given angle \u03c6 \u2208 (0, \u03c0/2] and the operators A\u0302 and B\u0302 verify\n\u2016ez A\u0302\u2016 \u2264 e\u03c9|z|, \u2016ez B\u0302\u2016 \u2264 e\u03c9|z|\nfor some \u03c9 \u2265 0 and all z \u2208 \u03c6 , then a splitting method of the form (4.8) of classical order p with all its coefficients a j , b j in the sector \u03c6 \u2282 C, then\n\u2016(Snh \u2212 enhL\u0302)u0\u2016 \u2264 Chp, 0 \u2264 nh \u2264 T\nwhere C is a constant independent of n and h."
        },
        {
            "heading": "5 Numerical illustration: Modified P\u00f6schl\u2013Teller potential",
            "text": "The so-called modified P\u00f6schl\u2013Teller potential takes the form\nV (x) = \u2212\u03b1 2\n2 \u03bb(\u03bb \u2212 1) cosh2 \u03b1x , (5.1)\nwith \u03bb > 1, and admits an analytic treatment to compute explicitly the eigenvalues for negative energies [9]. For the simulations we take \u03b1 = 1, \u03bb(\u03bb \u2212 1) = 10 and the initial condition \u03c80(x) = \u03c3 e\u2212x2/2, with \u03c3 a normalizing constant. We discretize the interval x \u2208 [\u22128, 8] with N = 256 equispaced points and apply Fourier spectral methods. With this value of N it turns out that \u2016([B, [B, [A, B]]])u0\u2016 is sufficiently close to zero to be negligible, so that we can safely apply the schemes of Table 2. If N is not sufficiently large, then the corresponding matrices A and B do not satisfy\n(4.3), and as a consequence, the schemes are only of order three. This can be indeed observed in practice.\nWe first check how the errors in the normM(u) and in the energyH(u) evolve with time for each type of integrator. To this endwe integrate numerically until the final time t f = 104 with three 6th-order compositions involving complex coefficients: (i) the new symmetric-conjugate schemeNB\u2217[6]11 collected in Table 2 (h = 100/909 \u2248 0.11), (ii) the palindromic scheme denoted by B[6]16 with all a j taking the same value a j = 1/16,\nj = 1, . . . , 8 and complex b j with positive real part3 (h = 0.16), and (iii) the method obtained by composing B[6]16 with its complex conjugate (B[6]16 )\u2217, resulting in a symmetric-conjugate integrator (h = 0.32). The step size is chosen in such a way that all the methods require the same number of FFTs. The results are depicted in Fig. 4. We see that, in accordance with the previous analysis, the error in both unitarity and energy furnished by the new schemeNB\u2217[6]11 does not grow with time, in contrast with palindromic compositions involving complex coefficients. Notice also that the composition of the palindromic scheme B[6]16 with its complex conjugate leads to a new (symmetric-conjugate) integrator with good preservation properties. On the other hand, composing a symmetric-conjugate method with its complex conjugate results in a palindromic scheme showing a drift in the error of both the norm and the energy [4] (Fig. 6).\nIn our second experiment, we test the efficiency of the different schemes. To this end we integrate until the final time t f = 100, compute the expectation value of the energy,H(uapp(t)), and measure the error as the maximum of the difference with respect to the exact value along the integration:\nmax 0\u2264t\u2264t f\n|H(uapp(t)) \u2212 H(u0)|. (5.2)\nThe corresponding results are displayed as a function of the computational cost measured by the number of FFTs necessary to carry out the calculations (in log-log plots) in Fig. 5. Notice how the new symmetric-conjugate schemes offer a better efficiency than standard splitting methods for this problem. The improvement is particularly significant in the 6th-order case.\n3 The coefficients can be found at the website http://www.gicas.uji.es/Research/splitting-complex.html.\nAcknowledgements The work of JB is supported by ANR-22-CE40-0016 \u201cKEN\" of the Agence Nationale de la Recherche (France) and by the region Pays de la Loire (France) through the project \u201cMasCan\". SB, FC and AE-T acknowledge financial support byMinisterio de Ciencia e Innovaci\u00f3n (Spain) through project PID2019-104927GB-C21, MCIN/AEI/10.13039/501100011033, ERDF (\u201cA way of making Europe\"). The authors would also like to thank Prof. C. Lubich for his very useful remarks.\nFunding Open Access funding provided thanks to the CRUE-CSIC agreement with Springer Nature.\nDeclarations\nConflict of interest All authors declare that they have no conflicts of interest.\nOpenAccess This article is licensedunder aCreativeCommonsAttribution 4.0 InternationalLicense,which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/."
        },
        {
            "heading": "A Appendix",
            "text": "We collect in this Appendix the most efficient symmetric-conjugate splitting methods with a j > 0 and b j \u2208 C with (b j ) > 0 we have found for a general problem of the form H = A + B. The coefficients of the schemes in boldface in Table 3 are listed in Table 4. Methods of type (4.4) of order p involving s stages are denoted as A\u2217[p]s , whereas B\u2217[p]s refers to a similar scheme of type (4.5). As in Table 1, we also collect for reference the methods proposed in [10] (denoted by GB\u2217[p]s ) and two efficient palindromic compositions with real coefficients, S[4]6 and S[6]10 . At order 5, the most efficient scheme turns out to be GB\u2217[5]9 .\nWe also include a numerical illustration on the modified P\u00f6schl\u2013Teller potential with the same data as before. Notice in particular the improvement with respect to the 6th-order scheme S[6]10 .\nTable 3 1-norm and effective errors for symmetric-conjugate splitting methods for H = A + B\nai bi\nB\u2217[3]3 a0 = 0.4706 b0 = 0.1655101882118 + 0.03704896872215 i a1 = 1 \u2212 2a0 (b1) = 12 \u2212 (b0) \u2212 0.6300845020773 i B\u2217[4]5 a0 = 37250 b0 = 0.05338438633498185 \u2212 0.03218942894140047 i a1 = 0.22446218092466344 b1 = 0.19561815336463223 + 0.0992879758243923 i a2 = 1 \u2212 2 \u22111 i=0 ai b2 = 12 \u2212 \u22111 i=0 (bi ) \u2212 0.14783578044680548 i B\u2217[6]15 a0 = 0.08092666015955027 b0 = 3100 \u2212 0.0028985018717006387 i a1 = 0.06736427978832901 b1 = 0.08826477458499815 + 0.019065371639195743 i a2 = 0.057276240999706116 b2 = 0.07026507350715319 \u2212 0.05226928459003309 i a3 = 0.06428730473896961 b3 = 0.051044248093469226 + 0.07580262639617709 i a4 = 0.05528732144478408 b4 = 0.040506044227148555 \u2212 0.07981221177569087 i a5 = 0.02566179136566552 b5 = 0.03061653536468681 + 0.07254698089135206 i a6 = 0.10559039215618958 b6 = 0.10349890449629792 \u2212 0.03539199012223482 i a7 = 1 \u2212 2 \u22116 i=0 ai b7 = 12 \u2212 \u22116 i=0 (bi ) + 0.0111821298374971054 i"
        }
    ],
    "title": "Symmetric-conjugate splitting methods for linear unitary problems",
    "year": 2023
}