{
    "abstractText": "The circum-galactic medium (CGM) can feasibly be mapped by multiwavelength surveys covering broad swaths of the sky. With multiple large data sets becoming available in the near future, we develop a likelihood-free Deep Learning technique using convolutional neural networks (CNNs) to infer broad-scale physical properties of a galaxy\u2019s CGM and its halo mass for the first time. Using CAMELS (Cosmology and Astrophysics with MachinE Learning Simulations) data, including IllustrisTNG, SIMBA, and Astrid models, we train CNNs on Soft X-ray and 21-cm (H I ) radio two-dimensional maps to trace hot and cool gas, respectively, around galaxies, groups, and clusters. Our CNNs offer the unique ability to train and test on \u2018multifield\u2019 data sets comprised of both H I and X-ray maps, providing complementary information about physical CGM properties and impro v ed inferences. Applying eRASS:4 surv e y limits shows that X-ray is not powerful enough to infer individual haloes with masses log ( M halo /M ) < 12.5. The multifield impro v es the inference for all halo masses. Generally, the CNN trained and tested on Astrid (SIMBA) can most (least) accurately infer CGM properties. Cross-simulation analysis \u2013 training on one galaxy formation model and testing on another \u2013 highlights the challenges of developing CNNs trained on a single model to marginalize over astrophysical uncertainties and perform robust inferences on real data. The next crucial step in improving the resulting inferences on the physical properties of CGM depends on our ability to interpret these deep-learning models. Key w ords: softw are: simulations \u2013 galaxies: clusters: general \u2013 galaxies: groups: general \u2013 (g alaxies:) interg alactic medium \u2013 radio lines: general \u2013 X-rays: general.",
    "authors": [
        {
            "affiliations": [],
            "name": "Naomi Gluck"
        },
        {
            "affiliations": [],
            "name": "Benjamin D. Oppenheimer"
        },
        {
            "affiliations": [],
            "name": "Daisuke Nagai"
        },
        {
            "affiliations": [],
            "name": "Francisco Villaescusa-Navarro"
        },
        {
            "affiliations": [],
            "name": "Daniel Angl \u0301es-Alc \u0301azar"
        }
    ],
    "id": "SP:8a87c8ec97f9d8741f5f65d2c6665a74d3fb69f0",
    "references": [],
    "sections": [
        {
            "text": "MNRAS 527, 10038\u201310058 (2024) https://doi.org/10.1093/mnras/stad3784 Advance Access publication 2023 December 7\nAn obser v ationally dri v en multifield appr oach for pr obing the circum-galactic medium with convolutional neural networks\nNaomi Gluck, 1 \u2039 Benjamin D. Oppenheimer , 2 Daisuke Nagai , 1 Francisco Villaescusa-Navarro 3 , 4 and Daniel Angl \u0301es-Alc \u0301azar 4 , 5 1 Physics Department, Yale University, 217 Prospect Str, New Haven, CT 06511, USA 2 CASA, Department of Astrophysical and Planetary Sciences, University of Colorado, 389 UCB, Boulder, CO 80309, USA 3 Department of Astrophysical Sciences, Princeton University, Peyton Hall, Princeton, NJ 08544, USA 4 Center for Computational Astrophysics, Flatiron Institute, 162 5th Avenue, New York, NY 10010, USA 5 Department of Physics, University of Connecticut, 196 Auditorium Road, U-3046, Storrs, CT 06269, USA\nAccepted 2023 December 5. Received 2023 December 3; in original form 2023 September 12\nA B S T R A C T The circum-galactic medium (CGM) can feasibly be mapped by multiwavelength surveys covering broad swaths of the sky. With multiple large data sets becoming available in the near future, we develop a likelihood-free Deep Learning technique using convolutional neural networks (CNNs) to infer broad-scale physical properties of a galaxy\u2019s CGM and its halo mass for the first time. Using CAMELS (Cosmology and Astrophysics with MachinE Learning Simulations) data, including IllustrisTNG, SIMBA, and Astrid models, we train CNNs on Soft X-ray and 21-cm (H I ) radio two-dimensional maps to trace hot and cool gas, respectively, around galaxies, groups, and clusters. Our CNNs offer the unique ability to train and test on \u2018multifield\u2019 data sets comprised of both H I and X-ray maps, providing complementary information about physical CGM properties and impro v ed inferences. Applying eRASS:4 surv e y limits shows that X-ray is not powerful enough to infer individual haloes with masses log ( M halo /M ) < 12.5. The multifield impro v es the inference for all halo masses. Generally, the CNN trained and tested on Astrid (SIMBA) can most (least) accurately infer CGM properties. Cross-simulation analysis \u2013 training on one galaxy formation model and testing on another \u2013 highlights the challenges of developing CNNs trained on a single model to marginalize over astrophysical uncertainties and perform robust inferences on real data. The next crucial step in improving the resulting inferences on the physical properties of CGM depends on our ability to interpret these deep-learning models.\nKey w ords: softw are: simulations \u2013 galaxies: clusters: general \u2013 galaxies: groups: general \u2013 (g alaxies:) interg alactic medium \u2013 radio lines: general \u2013 X-rays: general.\n1\nN a a g s l t t o a b f C e\np\nt 2 K > B o p fi 2 ( h (\nm w t h d\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024 I N T RO D U C T I O N ew telescopes are currently engaged in comprehensive surveys cross large sky areas and reaching previously unobtainable depths, iming to map the region beyond the galactic disc but within the alaxy\u2019s virial radius: the circum-galactic medium (CGM; Tumlinon, Peeples & Werk 2017 ). Ho we v er, these telescopes hav e inherent imitations in detecting emissions from gaseous haloes surrounding ypical galaxies. Nev ertheless, the y offer an exceptional opportunity o characterize the broad properties of CGM that extend beyond their riginal scientific scope. The CGM contains a multiphase gas, partly ccreted from the filaments of the cosmic web that is continuously eing reshaped, used in star formation, and enriched by astrophysical eedback processes occurring within the galaxy (Keres et al. 2005 ; hristensen et al. 2016 ; Oppenheimer et al. 2016 ; Angl \u0301es-Alc \u0301azar t al. 2017b ; Hafen et al. 2019 ).\nA simple way to characterize the CGM is by temperature. The cool hase gas has a temperature of approximately T \u223c 10 4 K and has been\nE-mail: naomi.gluck@yale.edu\n1\na\nPublished by Oxford University Press on behalf of Royal Astronomical Socie Commons Attribution License ( https:// creativecommons.org/ licenses/ by/ 4.0/ ), whi\nhe focus of UV absorption line measurements (e.g. Cooksey et al. 010 ; Tumlinson et al. 2013 ; Werk et al. 2013 ; Johnson et al. 2015 ; eeney et al. 2018 ). The hot phase of the CGM, with temperatures T 10 6 K, is observable via X-ray facilities (e.g. Bogd \u0301an et al. 2018 ; regman et al. 2018 ; Mathur et al. 2023 ) and can contain the majority f a galaxy\u2019s baryonic content. Understanding both the cool and hot hases of the CGM may answer questions regarding where we may nd baryons (Anderson & Bregman 2011 ; Werk et al. 2014 ; Li et al. 017 ; Oppenheimer et al. 2018 ), how galaxy quenching proceeds Tumlinson et al. 2011 ; Somerville, Popping & Trager 2015 ), and ow the metal products of stellar nucleosynthesis are distributed Peeples et al. 2014 ).\nNew, increasingly large data sets that chart the CGM across ultiple wavelengths already exist. In particular, two contrasting avelengths map diffuse gas across nearby galaxies: the X-ray and he 21-cm (neutral hydrogen, H I ) radio. First, the eROSITA 1 mission as conducted an all-sky X-ray survey, enabling the detection of iffuse emission from hot gas associated with groups and clusters\nAlthough eROSITA is currently dormant; its data at the level we mock have lready been taken.\n\u00a9 2023 The Author(s). ty. This is an Open Access article distributed under the terms of the Creative ch permits unrestricted reuse, distribution, and reproduction in any medium,\nprovided the original work is properly cited.\nTable 1. Definitions and global value ranges of the CGM properties to be inferred and constrained by the network. These are the global value ranges, encompassing the individual ranges of IllustrisTNG, SIMBA, and Astrid. They remain consistent throughout any combination of simulations during training and testing. Properties are further distinguished by those radially defined by R 200c and those by 200 kpc .\nProperty Definition Range\nM halo Logarithmic halo mass in R 200 c 11.5\u201314.3 f cgm Mass ratio of CGM gas to total mass within\nR 200 c\n0.0\u20130.23\nZ cgm Logarithmic CGM metallicity in 200 kpc \u22123.6 \u2013 \u22121.3 M cgm Logarithmic CGM mass in 200 kpc 8.0\u201312.5 f cool Ratio of cool, low-ionized CGM gas within\n200 kpc 0.0\u20131.0\nT cgm Logarithmic CGM temperature in 200 kpc 3.9\u20137.6\na i e S A T s 2\nm s ( 2 f t 2 e H g p a a ( s p 1 2 s t fi v g w p\nn S f d C\n2\n3\nl\nu f C L N o p s a s o\nu u C S i p ( e r w c f r s l b i f S\n2\nI h o T s m\nw u a n a t p d M s t\n2\nW u\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024 nd potentially massive galaxies (Predehl et al. 2021 ). Secondly n the 21-cm radio domain, the pursuit of detecting cool gas ncompasses initiatives that serve as precursors to the forthcoming quare Kilometer Array (SKA) project. Notable among these are SKAP (Johnston et al. 2007 ) and MeerKAT (Jonas & MeerKAT eam 2016 ), both of which have already conducted comprehensive urv e ys of H I gas in galaxy and group environments through deep 1-cm pointings. Cosmological simulations provide theoretical predictions of CGM aps, yet divergences arise due to varying hydrodynamic solvers and ubgrid physics modules employed in galaxy formation simulations Somerville, Popping & Trager 2015 ; Tumlinson, Peeples & Werk 017 ; Dav \u0301e et al. 2020 ). As a result, we see very different predictions or the circumgalactic reservoirs surrounding galaxies. Distinctively, he publicly available simulations such as IllustrisTNG (Nelson et al. 018 ; Pillepich et al. 2018 ), SIMBA (Dav \u0301e et al. 2019 ), Astrid (Bird t al. 2022 ; Ni et al. 2022 ), among others (e.g. Schaye et al. 2015 ; opkins et al. 2018 ; Wetzel et al. 2023 ), are valuable resources for enerating CGM predictions. CAMELS 2 3 (Cosmology and Astrohysics with MachinE Learning Simulations) is the first publicly vailable suite of simulations that includes thousands of parameter nd model variations designed to train machine learning models Villaescusa-Navarro et al. 2021c , 2022 ). It contains four different imulations sets co v ering distinct cosmological and astrophysical arameter distributions: LH (Latin Hypercube, 1000 simulations), P (1-Parameter variations, 61 simulations), CV (Cosmic Variance, 7 simulations), and EX (Extreme, 4 simulations). Of these, the CV et is uniquely significant as it fixes cosmology and astrophysics o replicate the observable properties of galaxies best, providing a ducial model. We exclude the numerous CAMELS simulations that ary cosmology and astrophysical feedback to prevent unrealistic alaxy statistics. Thus, utilizing the diverse CAMELS CV sets, e explore three universe realizations that make distinguishing redictions for the CGM. In this study, we develop an image-based convolutional neural\network (CNN) to infer CGM properties from CAMELS IllustrisTNG, IMBA, and Astrid CV-set simulations. The definitions and ranges or all CGM properties are outlined in Table 1 . Two significant and ifferently structured astrophysical feedback parameters that impact GM properties, stellar and AGN feedback, remain predominantly\nCAMELS Project Website: https://www.camel-simulations.org CAMELS Documentation available at https:// camels.readthedocs.io/ en/ atest/index.html\n( b a ( s fi\nnconstrained. The CV set does not explore the range of CAMELS eedback parameters like the other sets. Ho we ver, we choose the V set as a proof-of-concept and plan to include the much larger H set that completely marginalizes o v er astrophysics (Villaescusaavarro et al. 2021b ) in the future. The CNN is trained and tested n diverse simulations, yielding valuable insights into the CGM roperties. Additionally, we apply observational multiwavelength urv e y limits to the CNN for each field, guiding the design and pproach of new instruments and no v el surv e ys, maximizing their cientific returns on CGM properties, and significantly advancing ur understanding of galaxy formation and large-scale structure. This paper is outlined as follows. Section 2 lays out the methods sed to complete this work and includes subsections on specific simlation information (Section 2.1 ), data set generation (Section 2.2 ), NNs (Section 2.3 ), and network output (Section 2.4 ). We begin ection 3 by presenting results using individual simulations to nfer first the entire halo mass (Section 3.1 ), then a global CGM roperty, the mass of the CGM o v er the mass of the halo, or f cgm Section 3.2 ), and the metallicity of the CGM (Section 3.3 ) which xhibits large variation. We show results based on idealized soft Xay and H I images and assess the impact of realistic observations ith observational surv e y limits (Section 3.4 ). We also perform ross simulation inference , where one trains a CNN on one galaxy ormation model or simulation and tests on another to gauge its obustness (Section 3.5 ). We discuss the interpretability of the crossimulation inference analysis (Section 4.1 ), the applicability and imitations of CNNs applied to CGM (Section 4.2 ), the variance etween true and inferred values for CGM properties using the dealised multifield maps (Section 4.3 ), and a possible avenue for uture work as an expansion of this analysis (Section 4.4 ). Lastly, ection 5 concludes.\nM E T H O D S\nn this section, we introduce the simulations (Section 2.1 ) followed by ow our halo-centric \u2018map\u2019 data sets are generated and a description f the global properties we train the network to infer (Section 2.2 ). hen, Section 2.3 describes the neural network applied to these data ets. Finally, we specify the network output, including statistical easures, to e v aluate the performance of CNN (Section 2.4 ). We define some v ocab ulary and common phrases within this\nork. Fields refer to X-ray and 21-cm H I (hereafter H I ), where sing one field corresponds to either X-ray or H I ; two fields, X-ray nd H I , make up the multifield. With our CNN architecture, the umber of fields is equi v alent to the number of channels. Parameters nd hyperparameters define the inner workings of the CNN, where he latter must be optimized. This should not be confused with arameters in the context of astrophysical feedback. Properties escribe the attributes of the CGM that are inferred by the network: halo , f cgm , log ( Z cgm ), M cgm , f cool , and log ( T cgm ). The parameter pace reflects the range of values for the CGM properties (between he 16th and 84th percentiles) that each simulation encapsulates.\n.1 Simulations\ne use the CV set from three simulation suites, each of which ses a different hydrodynamic scheme: CAMELS-IllustrisTNG referred to as IllustrisTNG) using AREPO (Springel 2010 ; Weinerger, Springel & Pakmor 2020 ), CAMELS-SIMBA (referred to s SIMBA) utilizing GIZMO (Hopkins 2015 ), and CAMELS-Astrid referred to as Astrid) utilizing MP-Gadget (Springel 2005 ). These imulations encompass 27 volumes spanning (25 h \u22121 Mpc) 3 with xed cosmological parameters ( M = 0.3 and \u03c3 8 = 0.8) with varying\nMNRAS 527, 10038\u201310058 (2024)\nM\nTable 2. Outlining the number of haloes per mass bin in IllustrisTNG, SIMBA, and Astrid. The mass bins are defined as follows: Sub- L \u2217 for small haloes with mass between 11.5 \u2264 log ( M halo /M ) \u2264 12, L \u2217 for intermediatesized haloes with masses ranging from 12 \u2264 log ( M halo /M ) \u2264 13, and Groups are large haloes with masses from 13 \u2264 log ( M halo /M ) \u2264 14.3.\nSimulation Sub- L \u2217 L \u2217 Group Total IllustrisTNG 3450 1812 192 5454 SIMBA 3397 1534 170 5101 Astrid 3262 1866 218 5346\nr a W\ns t t m u e a h f l p (\nb w m h f f E a b t A t\nE ( e b m b b v s i\n2\nT ( a w t e d\nc S h a\nl s w p r a e t b\nl l t t f n t S h h A I t w a t ( c\np (\nM\nf\nZ\nM\nf\nT\nw p t p o a t o o m\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024 andom seeds for each volume\u2019s initial condition. The CAMELS strophysical parameters for feedback are set to their fiducial values. e e xclusiv ely use the z = 0 snapshots for this work. IllustrisTNG is an adaptation of the original simulation as decribed in Nelson et al. ( 2019 ) and Pillepich et al. ( 2018 ), using he AREPO (Springel 2010 ) magnetohydrodynamics code employing he N -body tree-particle-mesh approach for solving gravity and agnetohydrodynamics via moving-mesh methods. Like all simlation codes used here, IllustrisTNG has subgrid physics modules ncompassing stellar processes (formation, evolution, and feedback) nd black hole processes (seeding, accretion, and feedback). Black ole feedback uses a dual-mode approach that applies thermal eedback for high-Eddington accretion rates and kinetic feedback for ow-Eddington rate accretion rates. The kinetic mode is directionally ulsed and is more mechanically efficient than the thermal mode Weinberger et al. 2017 ). SIMBA, introduced in Dav \u0301e et al. ( 2019 ), uses the hydrodynamicased \u2018Meshless Finite Mass\u2019 GIZMO code (Hopkins 2015 , 2017 ), ith several unique subgrid prescriptions. It includes more physically oti v ated implementations of (1) AGN feedback and (2) black ole growth. SIMBA\u2019s impro v ed subgrid physics model for AGN eedback is based on observations, utilizing kinetic energy outflows or both radiative and jet feedback modes operating at high and low ddington ratios, respectively . Additionally , it applies observationlly moti v ated X-ray feedback to quench massive galaxies. SIMBA\u2019s lack hole growth model is phase-dependent. Cool gas accretion on o BHs is achieved through a torque-limited accretion model (Angl \u0301eslc \u0301azar et al. 2017a ), and when accreting hot gas, SIMBA transitions o Bondi accretion. Astrid, introduced in Bird et al. ( 2022 ), adopts the Pressure\u2013 ntropy SPH hydrodynamic model that uses the MP-Gadget code Feng et al. 2018 ). The original Astrid simulations focus on modlling high-redshift galaxy formation (from z = 99 to z = 3) y considering inhomogeneous hydrogen and helium reionization, etal return from massive stars, and the initial velocity offset between aryons and dark matter. It has also enhanced the modelling of lack hole mergers via a dynamic friction model. The CAMELS ersion of Astrid (Ni et al. 2023 ) follows the original simulation, but light changes in black-hole dynamics and dual-mode AGN feedback mplementations were made between them. .2 Data set generation\no create our halo-centric map data sets, we use YT -based software Turk et al. 2011 ) that allows for consistent and uniform analysis cross different simulation codes. We generate maps of all haloes ithin the CV set with masses of at least M halo = 10 11.5 M along he three cardinal axes. There are approximately 5000 haloes for ach simulation. The highest halo mass is 10 14.3 M , for a nearly 3 ex span in halo mass. Refer to Table 2 for additional details. We\nNRAS 527, 10038\u201310058 (2024)\nategorize all the haloes within the simulations by halo mass, where ub- L \u2217 haloes are within the range 11.5 \u2264 log ( M halo /M ) \u2264 12, L \u2217 aloes are within the range 12 \u2264 log ( M halo /M ) \u2264 13, and groups re within the range 13 \u2264 log ( M halo /M ) \u2264 14.3.\nThe relationship between log ( M halo /M ) and log ( M cgm ), og ( T cgm ), f cgm , and log ( Z cgm ) for all simulations, the parameter pace, is shown in Fig. 1 . The mean value of each property is indicated ith a solid line. The shaded regions represent the 16th \u221284th ercentiles, and the dotted points indicate the \u2018statistically low\u2019 egion for haloes with halo masses abo v e log ( M halo /M ) > 13.0. In greement with previous work (Oppenheimer et al. 2021 ; Delgado t al. 2023 ; Gebhardt et al. 2023 ; Ni et al. 2023 ), we illustrate how he properties of gas beyond the galactic disc can differ significantly etween feedback implementations.\nFor log ( M cgm ) (top left), Astrid (blue) shows little scatter beow log ( M halo /M ) > 12.5, IllustrisTNG (pink) shows similar but ess extreme scatter, and SIMBA (purple) has consistent scatter hroughout. In log ( T cgm ) (top right), Astrid again has a low scatter hroughout the entire M halo range. This scatter increases slightly or IllustrisTNG and again for SIMBA, and it is interesting to ote the divergence from log ( T cgm ) \u221d log ( M halo /M ) 2/3 . Astrid has he most scatter for f cgm (bottom left), whereas IllustrisTNG and IMBA display comparable scatter for lower masses, reducing for igher masses. Finally, log ( Z cgm ) illustrates that all three simulations ave significant and similar scatter. For M cgm , log ( T cgm ), and f cgm , strid has higher values throughout the M halo range, followed by llustrisTNG and SIMBA. This is not the case in log ( Z cgm ), where here is a significant o v erlap. The scatter in M halo was also computed ith respect to the total flux per map, corresponding to the sum of ll pixel values in X-ray and H I separately. When binned by M halo , here are correlations only with IllustrisTNG and Astrid for X-ray see Fig. A2 ). A more detailed discussion of map trends and pixel ounts is in Appendix A .\nFrom the snapshot data obtained from the X-ray and H I maps, we rovide an equation describing the calculation of each CGM property M halo , f cgm , Z cgm , M cgm , f cool , and T cgm ):\nhalo = \u2211 m DM ( r < R 200c )\n+ \u2211 m gas ( r < R 200c ) + \u2211 m star ( r < R 200c ) (1)\ncgm = \u2211 m cgm ( r < R 200c )\nM halo (2)\ncgm = \u2211\nz cgm ( r < 200 kpc ) \u2211 m cgm ( r < 200 kpc )\n(3)\ncgm = \u2211 m cgm ( r < 200 kpc ) (4)\ncool = \u2211\nm cool ( r < 200 kpc ) \u2211 m cgm ( r < 200 kpc )\n(5)\ncgm = \u2211\nt cgm ( r < 200 kpc ) \u2211 m cgm ( r < 200 kpc )\n(6)\nhere m is the mass of dark matter (DM), gas, or stellar (star) articles enclosed within r < 200 kpc . The subscript \u2018cgm\u2019 refers o any gas that is not star-forming. z cgm is the metallicity of the gas article. m cool is CGM gas with T < 10 6 K. t cgm is the temperature f the gas particle. For the definitions and numerical ranges of the bo v e CGM properties, see Table 1 . To ensure our CNN is able o reproduce the scatter seen in Fig. 1 , we include a comparison f mean and variance values between the input parameters and the utput inference, separated by mass bin for each galaxy simulation odel. This is only computed for log ( Z cgm ), as this parameter does\nFigure 1. Relationship between different CGM properties and the halo mass. Panels specifically illustrate M cgm , log ( T cgm ), f cgm , and log ( Z cgm ) within each simulation (IllustrisTNG, SIMBA, and Astrid) to represent the mean distribution of the objects. The points indicate the mass bins where there are statistically fewer haloes in mass bins abo v e log ( M halo /M ) = 13.5. The shaded regions represent the 16 th \u2212 84 th percentiles.\nn b i w\nt v X b b d 1 T o l W c W i k i H ( i R\ns r v l b t ( c t b o t s s s a w T t\ns l m 1\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\not have a clear relationship with halo mass, enabling a distinction etween mass relationships (seen within the other properties) and ntrinsic scatter. We confirm that our CNN reproduces the scatter ithin the initial data sets. We generated one channel for each field (H I or X-ray), adding hem together in the multifield case (H I + X-ray). Each map utilizes alues obtained through mock observation, as described below. For -ray, we map X-ray surface brightness emission in the soft band etween 0.5 and 2.0 keV. H I , or \u2018Radio\u2019 refers to the 21-cm emissionased measurement that returns column density maps, which is a ata reduction output of 21-cm mapping techniques. Each map is 28x128 pixels, spanning 512 \u00d7 512 kpc 2 with a 4 kpc resolution. he depth spans \u00b11000 kpc from the centre of the halo. Two types f maps are generated for each field: those with no observational imits, called idealized maps, and those with observed limits imposed. e first explain the generation of idealized maps. X-ray maps are reated using the pyXSIM package (ZuHone & Hallman 2016 ).\nhile pyXSIM can generate lists of individual photons, we use t in a non-stochastic manner to map the X-ray emission across the ernel of the fluid element. Therefore, our X-ray maps are idealized n their ability to map arbitrarily low emission levels. Radio-based I column density maps are created using the Trident package Hummels, Smith & Silvia 2017 ) where the Haardt & Madau ( 2012 ) onization background is assumed with the self-shielding criterion of ahmati et al. ( 2013 ) applied.\nFig. 2 depicts maps of the same massive halo in the three imulations: IllustrisTNG, SIMBA, and Astrid, from left to right, especti vely. The four ro ws illustrate (1) idealized X-ray, (2) obserationally limited X-ray, (3) idealized H I , and (4) observationally imited H I . For X-ray with observational limits, we set the surface rightness limit to 2.0 \u00d7 10 \u221213 erg s \u22121 cm \u22122 arcmin \u22122 corresponding o the observing depth of the eROSITA eRASS:4 all-sky survey Predehl et al. 2021 ). For H I with observational limits, we set the olumn density limit to N H I = 10 19.0 cm \u22122 , which is approximately he limit expected for the 21-cm H I MHONGOOSE Surv e y at a 15\u2019 eam size similar to the eROSITA surv e y (de Blok et al. 2016 ). The bservational limits are implemented by setting a lower limit floor hat corresponds to the detectability of the telescope. Accessing the ame halo across the three simulations is possible, since the CV set hares the same initial conditions between the different simulation uites. The X-ray maps tracing the gas primarily abo v e T > 10 6 K re brightest for Astrid and dimmest for SIMBA, a trend also seen hen the observational limits are imposed. The H I maps, probing \u223c 10 4 K gas, are less centrally concentrated than X-ray and often race gas associated with satellites. We expand on the first column in Fig. 2 in Fig. A1 , formatted imilarly, for a range of halo masses within IllustrisTNG from og ( M halo /M ) = 13.83 (leftmost) to log ( M halo /M ) = 11.68 (right-\nost). X-ray emission, which traces the gas with a temperature abo v e 0 6 K, indicates a strong correlation with the halo mass. The features\nMNRAS 527, 10038\u201310058 (2024)\nM\nFigure 2. Each column illustrates maps for IllustrisTNG, SIMBA, and Astrid, respecti vely. Each ro w corresponds to maps for idealized X-rays, X-rays with observational limits, idealized H I , and H I with observational limits. These maps display the same halo across the CV set of the three simulations.\ns g D a c H\n2\nT n a v t w w s a M i t m e u p i\ni p\nc a p d C t o b t\nr o r c r n o 2 i t\nv t p t n T c s p W s c t\n2\nH v p T e w s a\na m t f v t u v m\n4 https:// github.com/ pfnet/ optuna/\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\neen here include wind-blown bubbles (Predehl et al. 2020 ), satellite alaxies that create bow shocks (Kang et al. 2007 ; Bykov, Dolag & urret 2008 ; Zinger et al. 2018 ; Li et al. 2022 ), and emissions ssociated with the galaxies themselves. H I does not have the same orrelation with halo mass, strengthening our choice in creating the I + X-ray multifield. .3 Convolutional neural network he advantage of employing CNNs lies in their capacity to simultaeously learn multiple features from various channels or fields (X-ray nd H I ). Fields can be used independently or together for training, alidation, and testing without modifications to the network architecure and only minor changes in the scripts whenever necessary. This ork adopts lik elihood-free inference methods, suitable for cases here determining a likelihood function for large and complex data\nets is computationally demanding or is not attainable. Our CNN rchitecture is based on the architecture used with the CAMELS ultifield Data set (CMD) in Villaescusa-Navarro et al. ( 2021a ), nferring two cosmological and four astrophysical feedback parameers. In addition to now inferring six CGM properties , the remaining odifications stem from replacing the LH set (Villaescusa-Navarro t al. 2022 ) with the CV set. We must be able to accommodate ne venly distributed discrete-v alued data in the form of \u2018halo-centric\u2019 oints, which can be seen in a property like the halo mass. This s compared to the LH-based CMD data set, which was used to\nNRAS 527, 10038\u201310058 (2024)\nnfer the evenly distributed cosmological and astrophysical feedback arameters by design. Our CNN makes two main adjustments: (1) the kernel size is hanged from 4 to 2 to accommodate a smaller initial network input, nd (2) the padding mode is altered from \u2018circular\u2019 to \u2018zeros\u2019. The adding mode is crucial in guiding the network when the image imensions decrease, as it no longer perfectly fits the original frame. hanging to \u2018zeros\u2019 means filling the reduced areas with zeros o maintain the network\u2019s functionality. The CNN architecture is utlined in greater detail in Appendix C in Table C1 for the main ody of the CNN and Table C2 for additional functions utilized after he main body layers.\nCNN also includes hyperparameters: (1) the maximum learning ate (also referred to as step size), which defines how the application f weights changes during training, (2) the weight decay as a egularization tool to prevent overfitting by reducing the model omplexity, (3) the dropout value (for fully connected layers) as andom neurone disablement to prevent overfitting, and (4) the umber of channels in CNN (set to an integer larger than one). To ptimize these hyperparameters, we employ Optuna (Akiba et al. 019 ), 4 a tool that efficiently explores the parameter space and dentifies the values attributed to returning the lo west v alidation loss, hus achieving the best performance.\nWe divide the full data set into a training set (60 per cent), a alidation set (20 per cent), and a testing set (20 per cent). Only he training set contains the same halo along three different axis rojections (setting the network parameter split = 3 ). In conrast, the latter sets include neither the axis projections of any halo or the original image of the haloes assigned to the training set. he split is performed during each new training instance for a new ombination of fields and simulations. We set the same random eed across all network operations, so as to drastically reduce the robability of o v erlap between training, validation, and testing sets. ithout the same random seed, the data set will not be split in the ame way each time, and one halo could appear in two or more sets, ausing inaccurate results. This process is necessary to ensure that he network does not perform additional \u2018learning\u2019 in one phase.\n.4 Network outputs\nere, the \u2018moment\u2019 network (Jeffrey & Wandelt 2020 ) takes adantage of only outputting the mean, \u03bc, and variance, \u03c3 , of each roperty for increased efficiency, instead of a full posterior range. he minimum and maximum values used to calculate the network rror for the six CGM properties are kept the same throughout this ork, regardless of which simulation is used for training. Doing o ensures that the results are comparable in the cross-simulation nalysis or training on one simulation and testing on another.\nWe additionally include four metrics to determine the accuracy nd precision of the CNN\u2019s outputs for each CGM property: the root ean squared error (RMSE), the coefficient of determination ( R 2 ), he mean relative error ( ), and the reduced chi-squared ( \u03c72 ). In the ormulae below, we use the subscript i to correspond to the index alue of the properties [1\u20136], the marginal posterior mean, \u03bci , and he standard deviation, \u03c3 i . Four different statistical measurements are sed to make such conclusions, and TRUE i is used to denote the true alue of any given CGM property with respect to simulation-based aps.\nR\nw a\nR\nr R\nw p\n\u03c7\nw a e i o w s n m b l p m w h v i o\nfi t s m 1\n3\nW a ( ( o a S t t p m b o\nl s w\no d t o d t ( m 1 T o\n3\nT d h m F s e R\nt T t T C t w a m l r r w w a a t p\nI a l u v t T i t w t A g H w\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\nRoot mean squared error, RMSE :\nMSE i = \u221a\n\u3008 ( TRUE i \u2212 \u03bci ) 2 \u3009 , (7) here smaller RMSE values can be interpreted as increased model\nccuracy in units that can be related to the measured property. Coefficient of determination, R 2 :\n2 i = 1 \u2212 i ( TRUE i \u2212 \u03bci ) 2 i ( TRUE i \u2212 TRUE i ) 2 , (8)\nepresenting the scale-free version of the RMSE, where the closer\n2 is to one, the more accurate the model. Mean relati v e error, :\ni = \u2329 \u03c3i\n\u03bci\n\u232a , (9)\nhere smaller i values can be interpreted as increased model recision. This is also the type of error predicted by CNN. Reduced chi-squared, \u03c72 :\n2 i =\n1\nN N \u2211 i= 1 ( TRUE i \u2212 \u03bci \u03c3i )2 , (10)\nhere this quantifies how \u2018trustworthy\u2019 the posterior standard devition is, such that values close to one indicate a properly quantified rror and that the model is well trained. Values greater than one ndicate that the errors are underestimated, and those smaller than ne are o v erestimated. We do not expect deviations far from one hen analysing inferences from CNNs trained and tested on the same imulation. Ho we ver, v alues much higher than one are expected if etwork training and testing occur in different simulations, as outliers ay have a large contribution. The variation in parameter spaces etween simulations can be seen in Fig. 1 . If \u03c72 values become very arge, two hypotheses can be presented. First, either the CNN is not owerful enough to output the correct inference from the provided aps, or second, there is not enough of the correct information ithin the data set to produce a good inference. Distinguishing one ypothesis from the other, along with a physical interpretation of alues that de viate from one, is not possible without the ability to nterpret deep learning models. Resolving these issues is the focus f our future endea v ours. It is also important to note that the values reported in the subsequent gures correspond to the subset of the data that has been plotted, not he entire set, unless otherwise noted. To achieve such a reduced et, we randomly select a fraction of data points that vary with halo ass \u2013 for example, approximately (1/30)th of log ( M halo /M ) = 1.5 haloes, but all haloes abo v e log ( M halo /M ) = 13.0 are plotted.\nRESULTS\ne present our main results in this section. First, we discuss training nd testing on one idealized field at a time for the same simulation single-simulation analysis), focusing on three inferred properties: 1) halo mass in R 200c ( M halo in Section 3.1 ), (2) the mass ratio f CGM gas to the total mass inside R 200c [ f cgm in Section 3.2 ), nd (3) the metallicity of the CGM inside 200 kpc (log ( Z cgm ) in ection 3.3 ]. We do not display the case of a multifield here, as he results do not indicate a significant impro v ement. F ollowing his, we show the results for the observationally limited case (for roperties M halo and M cgm ), strengthening the moti v ation for using a ultifield (Section 3.4 ). We also organize network errors (RMSEs) y mass bin (see Table 2 ) and by simulation (training and testing n the same simulation) for the multifield case with observational\nimits (Section 3.4.1 ). Finally, we provide the results of a crossimulation analysis encompassing all three simulations, with and ithout observational limits for comparison (Section 3.5 ). We utilize Truth\u2013Inference scatter plots to display inferences n the CGM properties. Each plot consists of multiple panels istinguished by field, simulation, or both. The panels visualize the rue value, TRUE i , on the x -axis and the inferred posterior mean, \u03bci , n the y -axis, with error bars corresponding to the posterior standard eviation, \u03c3 i . Four statistics (for the subset of data plotted and not he entire data set) are also provided for each panel: the RMSE equation 7 ), coefficient of determination values ( R 2 , equation 8 ), ean relative error ( , equation 9 ), and reduced \u03c72 values (equation 0 ). The definitions and equations for each are given in Section 2.4 . he black diagonal line also represents a \u2018perfect inference\u2019 one-tone line between the true and inferred values.\n.1 Inferred halo mass\nhe halo mass emerges as a readily interpretable property, directly educible from the network, owing to its clear expectations: \u2018true\u2019 igh-mass haloes should yield correspondingly high \u2018inferred\u2019 halo asses, regardless of the simulation used for training and testing. ig. 3 illustrates the Inference\u2013Truth plots for M halo across all three imulations for a subset of the data. We define the halo mass in quation ( 1 ) as the sum of dark matter, gas, and stars within r < 200c . The top row corresponds to the results using idealized X-ray maps o infer M halo , and similarly for the bottom row using H I maps. he columns are ordered by the simulation used for training and esting: IllustrisTNG (left), SIMBA (middle), and Astrid (right). he points are coloured by halo mass throughout. We examine the NN with input X-ray maps first. In the first panel, we train and est on IllustrisTNG and obtain inferences that indicate a relatively ell-constrained monotonic relationship. Some points remain further way from the \u2018truth\u2019 values set by the black diagonal line at the lowass end, suggesting that X-ray may not be the best probe for these ow-mass haloes. The next panel visualizes the training and testing esults on SIMBA, with a slight impro v ement in the higher mass ange and an o v erall relativ ely well-constrained, monotonic trend ith a few outliers that stray far from the black line. This is exactly hat is expected and is the same across simulations and fields. There re a few more outliers than IllustrisTNG and slightly larger error bars cross the entire mass range. Finally, the third panel demonstrates hat the CNN trained on and tested with Astrid has excellent inference ower, as indicated by smaller error bars throughout the mass range. We can now look at the results obtained using the H I input maps. n the first panel, with training and testing on IllustrisTNG, we obtain clear and well-constrained monotonic relationship with relatively ittle scatter. There is a slight impro v ement in error predictions when sing H I instead of X-ray, as indicated by the change in the \u03c72 alue from 0.918 with X-ray to 0.938 with H I . Visually, we can see he impro v ement in the lower mass range, as there is less scatter. he middle panel shows training and testing on SIMBA, where the nference made is significantly worse than it is with X-ray throughout he entire parameter space, especially intermediate to low masses ith increased scatter and larger error bars. The last panel shows raining and testing on Astrid. Training and testing the CNN on strid with H I input maps yields the best inference of the three alaxy formation models, indicated by the highest R 2 and lowest . o we ver, the inference made with H I is outperformed by that made ith X-ray in the intermediate- to high-mass range.\nMNRAS 527, 10038\u201310058 (2024)\nM\nFigure 3. The Truth\u2013Inference plots for M halo when training and testing on the same simulation using idealized single-field data. IllustrisTNG, SIMBA, and Astrid are shown from left to right, and X-ray and H I are shown in the upper and lower rows, respectively. The data are at z = 0.0. We plot a mass-dependent fractional sample of haloes from the testing set.\ne I t h l a ( 1 t d\nd o t 6 o f h o f f e i t c\n3\nF F n t t H t o t\nr u t t i n o S F f s\nm s\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\nQuantitativ ely, Astrid pro vides the most accurate and precise infernce for both fields following the RMSE and v alues, respecti vely. t also has the highest R 2 score, indicating that a CNN trained and ested on Astrid can best explain the variability in the data. SIMBA as the lowest R 2 value o v erall with H I input maps, making it the east accurate in this case. Investigating the \u03c72 values, CNNs training nd testing on (1) IllustrisTNG consistently o v erestimate the error \u03c72 < 1), (2) SIMBA consistently underestimate the error ( \u03c72 > ), and (3) Astrid o v erestimate the X-ray error to a greater degree han IllustrisTNG but slightly underestimate the H I error to a lesser egree than SIMBA. To interpret the meaning of the \u03c72 values reported in Fig. 3 , we\netermine the percentage of \u03c3 i errors of individual data points that v erlap the line of perfect inference. If the errors are truly capturing he Gaussian behaviour, as in \u03c72 = 1, we would expect 1 \u2212 \u03c3 or 8 per cent errors to o v erlap. Briefly, we find that the percentage of v erlapping points is 78.3 per cent for the o v erall lowest \u03c72 = 0.858 or Astrid on idealized X-ray maps, and 65.0 per cent for the o v erall ighest \u03c72 = 1.277 for SIMBA for idealized H I maps. In the case f SIMBA X-ray, we find an o v erlapping percentage of 68.9 per cent or \u03c72 = 1.125, which indicates a slight non-Gaussian behaviour or a \u03c72 just under one. Note that data points with underestimated rrors generally o v ercontribute, especially this \u03c72 v alue. Ho we ver, it s encouraging to see that the \u03c72 values scale as expected, meaning hat the y hav e a diagnostic value, but that the inferred errors do not ompletely follow Gaussian statistics.\nNRAS 527, 10038\u201310058 (2024)\nH\n.2 Inferred CGM gas fraction\nig. 4 shows the Truth\u2013Inference plots for f cgm in the same format as ig. 3 , with the colour bar still indicating M halo . We see that f cgm does ot have a monotonic trend, seen explicitly in Fig. 1 . Higher masses end to be more constrained, illustrated by a less deviation from he black line and smaller errors than those of lower mass haloes. o we ver, this is likely due to having fewer higher mass haloes for he network to learn from. We define f cgm in equation ( 2 ), as the sum f non-star-forming gas within a radius of r < 200 kpc divided by he halo mass.\nCNN performs poorly with IllustrisTNG on idealized X-ray maps, esulting in scattered points with large error bars. The network nderestimates the error bars, as indicated by a \u03c72 value greater han one. The next panel shows the results with SIMBA, for which here is better agreement and less scatter toward the higher and ntermediate halo masses. Ho we ver, for the lo w-mass haloes, there is o distinctive trend, though the network can predict the values well v erall but with somewhat large error bars (also underestimated). IMBA also has slightly lower f cgm values than IllustrisTNG (c.f. ig. 1 ). Finally, a CNN with Astrid pro vides e xcellent inference or f cgm and accurately estimates the network error. The values are ystematically larger, matching Fig. 1 .\nSimilarly, we display H I in the bottom row, with o v erall trends atching those seen with X-ray. Ho we ver, H I of fers tighter contraints at lower mass haloes (higher f cgm values). This indicates that I is a slightly better probe for f cgm than X-ray . Interestingly , SIMBA\nFigure 4. The Truth\u2013Inference plots for f cgm , with idealized X-ray (top) and idealized H I (bottom), where the colour bar still represents halo mass. Astrid performs the best with the tightest constraints and the smallest errors, while IllustrisTNG performs the w orst, lik ely due to the sharp increase of f cgm at low mass.\nn I p u\nd v t u i f S i\n1 I ( i a w f i f C f i o w i\ni A f a ( o a b o\n3\nF t A c s a a s d m g\nt a p r m\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\now o v erestimates the network error ( \u03c72 value less than one), while llustrisTNG and Astrid underestimate the errors. In general, f cgm erforms worse than M halo , but CNN is learning to infer this property sing a single idealized field. It does not appear that the quality of inference by the CNN epends on where the range of f cgm lies with respect to the entire alue space spanned by all three simulations \u2013 IllustrisTNG returns he worst performance but has intermediate f cgm values, with an nderestimate of the error. Astrid yields the most accurate and precise nferences for X-ray and H I fields, with lower scatter and error values or predicting M halo compared to IllustrisTNG and SIMBA. While IMBA generally performs worse, it e xhibits relativ ely good results n this case, especially with H I . Following the results of Davies et al. ( 2020 ) using IllustrisTNG00, we see similar non-monotonic trends using CAMELSllustrisTNG in f cgm as a function of halo mass. Low-mass haloes log ( M halo /M ) < 12) show high f cgm values. When the halo mass s slightly increased, there is a decline in the values of f cgm , until pproximately log ( M halo /M ) \u2248 12.5 as a threshold mass, after hich the monotonic trend with the halo mass returns. Star-forming\needback processes below this threshold mass are dominant and ncapable of clearing the CGM. At the threshold mass, these starorming feedback processes become stronger. Instead of learning the GM of its gas, the AGN feedback is shut down as early black hole ormation is limited (Delgado et al. 2023 ). We then see a dramatic ncrease due to turning on jet-mode feedback. Even for cluster-mass bjects, AGN feedback cannot o v ercome deep potential wells, so that e again see high values of f cgm . SIMBA has the strongest feedback mplementation of the galaxy formation models considered, resulting\nn lower o v erall f cgm values throughout the entire mass range. dditionally, we note that although SIMBA has the largest scatter in cgm , this is not simply a reflection of larger statistical fluctuations, s it has a comparable amount of sub- L \u2217 objects to IllustrisTNG see Table 2 ). Astrid has the weakest feedback, resulting in higher v erall f cgm values across the mass range Ni et al. ( 2023 ). Further nalysis is needed to more concretely establish the relationships etween feedback and halo mass such that these results are robust to bservational data.\n.3 Inferred metallicity\nig. 5 shows the truth\u2013inference plots for metallicity, plotted as he logarithm of the absolute value of Z (note log (Z ) = 1.87, splund et al. ( 2009 ) on this scale. Metallicity presents an interesting hallenge to our CNN, as there are often \u223c1 dex of scatter in Z at the ame halo mass with no obvious trend (see Fig. 1 ). When training nd testing on IllustrisTNG (top left), we see that higher mass haloes re slightly better constrained than low-mass haloes, which are more cattered and have larger (and overall underestimated) error bars. We efine the metallicity of the CGM in equation ( 3 ) as the sum of the etallicity of the gas particles times the mass of non-star-forming as within a radius of r < 200 kpc . Training and testing on SIMBA results in significant scatter across he entire mass range, with larger and underestimated error bars. L \u2217 nd group haloes have higher metallicity values o v erall than in the revious panel. The last panel shows training and testing with Astrid, eturning the best o v erall inference in log ( Z cgm ) across the entire ass range. Although the error is underestimated, Astrid has much\nMNRAS 527, 10038\u201310058 (2024)\nM\nFigure 5. The Truth\u2013Inference plots for metallicity, with idealized X-ray (top) and idealized H I (bottom), where the colour bar still represents halo mass. Astrid performs the best, while SIMBA performs the worst, as it has the most v aried Z -v alues across the mass range, while Astrid has the most confined values.\nh a a\nw c c u t h \u03c7 n S u f d o f\n3\nS v b l l r c a i\nl a d m e e T p S T s s b i v l s ( t v t \u03c7\np r o o s o\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\nigher accuracy and precision based on RMSE, R 2 , and values. We rgue that this is quite an impressive demonstration of our CNN\u2019s bility to predict a value with significant scatter at a single halo mass. The bottom row illustrates this same inference, but now using H I , here we see similar trends as with X-ray, though slightly more onstrained in the case of IllustrisTNG and SIMBA and slightly less onstrained in the case of the low-mass end of Astrid. The same pward shift for L \u2217 and group haloes is seen with SIMBA, alluding o SIMBA\u2019s strong astrophysical feedback prescriptions that impact igher mass haloes. This is also seen in the changes in lower (higher) 2 values for IllustrisTNG and SIMBA (Astrid). We conclude that either X-ray nor H I is powerful enough on its own to infer log ( Z cgm ). urprisingly, the entire metallicity of the CGM can be well inferred sing H I , especially in the case of Astrid, despite being a small raction of o v erall hydrogen, which itself is a primordial element. We o not attempt to provide a physical interpretation of the metallicity f the CGM, as it is quite complex and will be a good topic to focus on or our future work applying interpretative deep learning techniques. .4 Obser v ational limits and multifield constraints\nimulations must consider the limitations of current and future obserational multiwavelength surveys, such that a one-to-one correlation etween them and the developing models can exist. The specific imits used in this work come from the eROSITA eRASS:4 X-ray uminosity of 2 \u00d7 10 \u221213 erg s \u22121 cm \u22122 arcmin \u22122 , and the typical adio telescope column density for measurements of H I as 10 19 m \u22122 . Again, we include the RMSE values R 2 , , and \u03c72 , which re especially important to distinguish between single and multifield nferences.\nNRAS 527, 10038\u201310058 (2024)\nThe top row of Fig. 6 displays the Truth\u2013Inference plots, highighting the power of using multiple fields to infer M halo by training nd testing a CNN with the IllustrisTNG observationally limited ata sets. Utilizing the X-ray (top left), it is clear that we cannot ake an inference towards lower halo masses (Sub- L \u2217). This is xpected, giv en the eROSITA -inspired limits, which show X-ray mission strongly correlating with the halo mass, following Fig. A1 . he inability to make a clear inference in this mass regime despite roviding the CNN with the most information (nearly 3500 separate ub- L \u2217 haloes, see Table 2 ) reiterates the weaknesses of X-ray. he X-ray inference impro v es in the L \u2217 range, but is still highly cattered. Chadayammuri et al. ( 2022 ) targeted L \u2217 galaxies by tacking eROSITA haloes and found a weak signal, which appears to e supported by the assessment here. The groups provide much better nference for M halo since these objects should be easily detectable ia eROSITA . In the middle panel, we explore H I with observational imits to infer M halo . Interestingly, H I does a much better job for ub- L \u2217 haloes, as these are robustly detected in the 21-cm mapping see Fig. A1 ). The inference worsens for L \u2217 haloes and for much of he Group range. H I thus far shows impro v ements via a lower RMSE alue, a R 2 v alue closer to 1, and a lo wer v alue. It also indicates that he network predicts a greater error underestimation due to a higher\n2 value. As neither X-ray nor H I is robust enough to infer M halo alone\nroperly, we now train and test the network on combined H I + Xay \u2018multifield\u2019. The multifield approach is specifically used when ne field alone may not be enough to constrain a property fully r only constrain a property within a certain range of values. The econdary or tertiary fields would then be able to fill in some gaps r tighten the constraints within the inference. Additionally, with\nFigure 6. Truth\u2013Inference figures for X-ray (left), H I (middle), and H I + X-ray (right) for IllustrisTNG with observational limits imposed on M halo ( top row ) and M cgm ( bottom row ) using IllustrisTNG. X-ray provides poor inference, especially for lower-mass galaxies, as there are very few, sometimes no emission lines detected if they are too faint. On the other hand, the inference produced from H I results in more uniform errors throughout the mass range, since H I is detected around both low- and high-mass haloes. Combined with their observational limits, the inference is enhanced by tighter constraints at all mass scales.\nt w c m X t t a t i\nM m e m i s d i t v w f\n3\nT f e 7 f X t w p\nt t l d o d i o G a error.\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\nhe ability to adjust the network based on current observations, e form computational counterparts to future surv e ys to aid in its onstruction. We achieve stronger constraints throughout the entire ass range, even with observational limits from both X-ray and H I . -ray probes the L \u2217 and Group mass range well, while H I probes he sub- L \u2217 mass well, alleviating the previously unresolved noise of he left panel. We see a quantitative improvement in the multifield pproach in lower values for RMSE, R 2 , and , which comes at he price of increased underestimation of errors seen with a slight ncrease in \u03c72 value. The bottom row of Fig. 6 provides similar results and trends for cgm (defined in equation 4 ) via IllustrisTNG with X-ray, H I , and ultifield using observational limits. X-ray here is also not powerful nough as a probe to infer this property, especially in the low halo ass region. We then look at H I , where there is a better o v erall nference in the low halo-mass re gion. Howev er, H I produces more catter towards the high halo masses than X-ray. The last panel isplays results from the H I + X-ray multifield, which is an o v erall mpro v ement compared to either field alone. The constraints are ighter o v erall, and the scatter is reduced, as seen in the RMSE alues, R 2 , , and \u03c72 . Additional truth\u2013inference multifield plots ith observational limits for the remaining CGM properties can be ound in the Appendix B . .4.1 Visualizing the CNN error o quantify the CNN error across all six CGM properties [ M halo , cgm , log ( Z cgm ), M cgm , f cool , and log ( T cgm )], we plot the error in ach property binned by the halo mass. In the left panel of Fig. , we plot the error (neural network error, or mean relative error) or each property when considering the observational limits on H I , -ray, and multifield H I + X-ray for a CNN that is trained and ested on IllustrisTNG. Panels are separated by halo mass, where e use the full data set instead of the subset in the truth\u2013inference lots. We outline the general trends of this figure and point out ineresting features. In the sub- L \u2217 panel, X-ray maps alone provide he highest error, followed by multifield, and then H I with the owest error, to be expected. Note that there is an infinitesimal ifference between multifield and using H I alone. In the secnd panel ( L \u2217), the margin of error between X-ray and H I is ecreasing, meaning that X-ray is becoming increasingly more mportant in the intermediate halo mass range. Multifield develpment is also strictly improving with the use of H I alone. With roups, the multifield offers a greater impro v ement o v er either field lone, except for log ( M cgm ) where the X-ray has a slightly lower\nMNRAS 527, 10038\u201310058 (2024)\nM\nFigure 7. Left: Average RMSE values split by halo category for training and testing on IllustrisTNG, with fields X-ray, H I , and the multifield H I + X-ray with observational limits, for all six properties. These bars are representative of the full data set. We provide a dashed vertical line to distinguish between properties that are radially bound by R 200c and those by 200 kpc . Right: Average RMSE values split by simulation (training and testing on IllustrisTNG, SIMBA, or Astrid), with H I + X-ray and observational limits, for all six properties. These bars are representative of the full data set. Neither panel is entirely comparable to the Truth\u2013Inference plots, as these categorize errors by halo mass and are for the full data set.\nM f 1 H L s b d\nn s s i i u m f 0 o f\nS l p h t i w A m T s s\n3\nU t o a p l\nI l t u\np A t o m m l m\ni m f S a\nr h f m t\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\nFocusing on f cgm , the errors are generally smaller than those of halo , but this may reflect the quantity range that is inferred as cgm is mainly between 0.0 and 0.16 while M halo varies between 1.5 and 14.3. Meanwhile, log ( Z cgm ) has similar error levels between I and X-ray, with a small impro v ement for multifield for sub\u2217 and L \u2217. The errors in log ( Z cgm ) vary between 0.16 and 0.24, o measuring metallicity at this level of accuracy is promising, ut distinguishing high values of metallicity from low ones is isappointing for IllustrisTNG (see Fig. B2 ). The last three sets of properties, log ( M cgm ), f cool , and log ( T ), have ot been previously illustrated as Truth\u2013Inference plots. They depict imilar trends and show general multifield impro v ement. H I infers ub- L \u2217 the best, while X-ray infers Groups the best. The multifield s most important for L \u2217 haloes, and across all six properties, there s a significant impro v ement in the inference. Other halo categories sually do not result in as much impro v ement; in some cases, the ultifield performs slightly worse. We note that inference of f cool or groups is a significant impro v ement, from 0.102 (X-ray) and .125 (H I ) to 0.084 (multifield), reflecting that CNN integrates bservations of both cool gas (H I ) and hot gas (X-ray) in this raction. The right panel of Fig. 7 outlines the errors in IllustrisTNG, IMBA, and Astrid for the multifield H I + X-ray with observational\nimits for all six properties. The halo mass again separates the three anels. Generally, a CNN trained and tested on SIMBA has the ighest error o v er the entire mass range, while a CNN trained and ested on Astrid returns a better inference. f cgm breaks this trend, as it s significantly worse for L \u2217 mass haloes when using IllustrisTNG, hich is directly due to the drastic inflection point seen in Fig. 1 . dditionally, Astrid can infer log ( Z cgm ) remarkably well for L \u2217 ass haloes, compared to the high error when using IllustrisTNG. his can be seen in Fig. B2 where IllustrisTNG has much more catter across the entire mass range, while Astrid shows little catter.\nNRAS 527, 10038\u201310058 (2024)\n.5 Cross simulation inference\nntil now, each truth\u2013inference plot has been created by training and esting on the same simulation. In this section, we provide the results btained when training on one simulation or galaxy formation model nd testing on another to pro v e the degree of robustness across any articular simulation. We do this for both an X-ray with observational imits and a multifield with observational limits.\nIn Fig. 8 , we demonstrate the cross-simulation inference between llustrisTNG, SIMBA, and Astrid, using X-ray with observational imits only on the M halo property. The diagonal plots correspond to he training and testing in IllustrisTNG, SIMBA, and Astrid from pper left to lower right (repeated from the upper panels of Fig. 3 ). The top row refers to CNNs trained on IllustrisTNG, where each anel from left to right has been tested on IllustrisTNG, SIMBA, and strid, respectively. When tested on SIMBA, most points are close o the black line, but with significantly more scatter. When tested n Astrid, we can only reco v er good constraints for the high-halo ass range. There is much more scatter in the low-mass range, as a ajority of them are o v erestimated, e xcept for a few outliers, most ikely resulting from the inability of X-rays to probe the low-halo ass range. When training on SIMBA, but then testing on IllustrisTNG, there s still quite a bit of scatter in the low-mass haloes, and the highass haloes are now o v erestimated. This matches the expectations rom the brightness differences between IllustrisTNG (brighter) and IMBA (dimmer). When testing on Astrid, all points are shifted up nd o v erestimate halo mass.\nFinally, training on Astrid and testing on IllustrisTNG cannot eco v er an y of the results. There is a lot of scatter for the lowalo-mass range with large error bars, with points that do not ollow the expected trends in IllustrisTNG for intermediate and high asses. Astrid underestimates the majority of the halo masses. When esting on SIMBA, the results cannot be reco v ered either, as most\nFigure 8. Cross-simulation results for IllustrisTNG, SIMBA, and Astrid on X-ray for M halo , with observational limits. The x-axis of each panel corresponds to the true values of M halo , and the y-axis corresponds to the inference values of M halo , as before. The y-axis labels indicate that the panels in the top row were trained on IllustrisTNG, the middle row on SIMBA, and the bottom row by Astrid. The columns are labelled such that the panels in the first column were tested on IllustrisTNG, the second column\u2019s panels on SIMBA, and the third on Astrid. The diagonal panels are the result of training and testing on the same simulation. Training and testing on Astrid provide the tightest constraints and the best inference. These points are a fraction of the full data set.\np o X t t e v m I o\nt w i v o\nt E A\ns S o b p t t t d w h L\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\noints underestimate the halo mass. Although training and testing n Astrid seem to provide the best constraints on halo mass with -ray observational limits, it is the least robust simulation out of the hree, as measured by its ability to be applied to other simulations as a raining set. In contrast, other models trained on the Astrid LH set (Ni t al. 2023 ; de Santi et al. 2023 ) are the most robust, as the parameter ariations produce the widest variation in galaxy properties, in turn aking ML models more robust to changes in baryonic physics. llustrisTNG is the most robust in this case, as it returns the results f the other two simulations with the least amount of scatter. One oddity in the statistical measurements produced comes from raining on either IllustrisTNG or SIMBA and testing on Astrid, hich results in a ne gativ e R 2 value, indicating a significant mismatch n the models. Another unusual statistic is in the extremely high \u03c72 alues from three cases: (1) training on IllustrisTNG and testing n Astrid, (2) training on SIMBA and testing on Astrid, and (3) raining on Astrid and testing on either IllustrisTNG or SIMBA. ach reiterates the lack of robust results that can be achieved with strid. Fig. 9 illustrates the cross-simulation results on M halo with obervational limits on the multifield H I + X-ray for IllustrisTNG, IMBA, and Astrid. The top left panel shows this multifield, trained n and tested with IllustrisTNG, where o v erall, M halo can somewhat e constrained throughout the entire parameter space. The second anel on the diagonal corresponds to the same multifield but is now rained on and tested with SIMBA. The constraints here are weaker hroughout the entire parameter space as there is more o v erall scatter, hough the trend is the same as expected. The last panel on the iagonal shows the network trained on and tested with Astrid, where e can obtain the tightest constraints o v erall, especially in the higher alo mass range. The few outliers towards the mid ( L \u2217) to low (Sub\u2217) mass range with larger error bars may need further investigation.\nMNRAS 527, 10038\u201310058 (2024)\nM\nFigure 9. Cross-simulation results to infer M halo using the multifield with observational limits for IllustrisTNG, SIMBA, and Astrid. The layout is the same as in Fig. 8 . Even with the observational limits of H I and X-ray, training and testing on Astrid have the best overall inference for M halo .\nI I h l t b h t w W t b o\nI t g\nI i t a a m o t\nI t l l h a l t c\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\nThe top row shows training with IllustrisTNG and testing on llustrisTNG, SIMBA, and Astrid, respectively. When training on llustrisTNG and testing on SIMBA, we expect that for a given mass alo in IllustrisTNG, that same halo will look dimmer and, therefore, ess massive in SIMBA. This is seen here, as most haloes are below he black line. When the network is now tested on Astrid, a similar ut opposite expectation is met. With the knowledge that for a given alo mass in IllustrisTNG, that same halo will look brighter and, herefore, more massive in Astrid, this trend also makes sense, as e see a large majority of the points shifted abo v e the black line. e can conclude that with observational limits in the multifield, raining on IllustrisTNG can return the trends in SIMBA and Astrid, ut there is an offset in reco v ered M halo e xplainable by the shift in bservables. The middle row shows training with SIMBA and testing on llustrisTNG, SIMBA, and Astrid, respectively. When the network rains on IllustrisTNG, it can reco v er the inference and achieve ood constraints. The same halo in SIMBA will appear brighter in\nNRAS 527, 10038\u201310058 (2024)\nllustrisTNG, so the shift in most points upward abo v e the black line s, therefore, as expected. When testing on Astrid, we still reco v er he inference and achieve good constraints, but we see the same shift s we saw when training on IllustrisTNG and testing on Astrid. This lso aligns with the expectations, as the haloes in Astrid will seem uch brighter than those in SIMBA. We can conclude that with bservational limits in the multifield, SIMBA is also robust enough o reco v er inference and constraints for M halo .\nThe bottom row shows training with Astrid and testing with llustrisTNG, SIMBA, and Astrid, respectively. When the network ests on IllustrisTNG, we can reco v er the general trend with slightly ess strong constraints. We can reco v er the general trend with slightly ess strong constraints when the network is tested on SIMBA. The aloes in Astrid will be brighter than the same haloes in IllustrisTNG nd SIMBA, so the majority of the points are below the black ine when testing on IllustrisTNG and SIMBA. We can conclude hat a CNN trained on Astrid cannot reco v er the inference and onstraints for M halo . We see the same statistical nuances as in the\nFigure 10. Cross-simulation results to infer M cgm using the multifield with observational limits for IllustrisTNG, SIMBA, and Astrid. The layout is the same as in Fig. 8 .\np c\nt t s w l I l r t b u o w v t\nl l\na s i t t t f t i w a a c m w\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\nre vious figure: negati ve R 2 v alues and large \u03c72 v alues in the same onfigurations. By adding observational constraints for both H I and X-rays, he simulations gain a further level of similarity, which enhances heir constraining power in the cross-simulation analysis. Fig. 10 hows the results of using the multifield (H I + X-ray) approach ith observational limits on M cgm , with observational limits. The\nayout of the plot is analogous to that of Fig. 9 . Training on llustrisTNG (top row) o v erpredicts the results for intermediate- and ow-mass haloes when testing on SIMBA and underpredicts the same esults when testing on Astrid. This aligns with the expectations in he bottom left panel of Fig. 1 , which describes the relationship etween the halo mass and M cgm . Training on SIMBA (middle row) nderpredicts intermediate- and low-mass haloes results when testing n IllustrisTNG and Astrid. Note that there is much more scatter hen testing on IllustrisTNG, especially for objects with low M cgm alues. Training on Astrid (bottom row) does reasonably well when esting on IllustrisTNG with some scatter in the intermediate- and\no w-mass haloes. Ho we v er, it o v erpredicts these intermediate- and ow-mass haloes when tested on SIMBA.\nAlthough able to return similar trends, cross-simulation training nd testing display offsets related to different CGM properties in all imulations. Ho we ver, it is enlightening to see that cross-simulation nference impro v es when more bands are included, which indicates hat broad properties like M halo and M cgm are more robustly characerized by observing in multiple bands. We make a deliberate choice o show the cross-simulation analysis results for M halo and M cgm , not cgm , as it is a ratio of the gas mass to the halo mass throughout he halo (not within 200 kpc), leading to a more complex trend that s not as easily interpretable. Cross-simulation analysis can offer a ay to understand the direction and magnitude of systematic offsets nd the variations between feedback implementations qualitatively nd the feedback energy as a function of redshift. This is entirely ontingent on our ability to create physically moti v ated deep-learning odels that are interpretable, which is the focus of our future ork.\nMNRAS 527, 10038\u201310058 (2024)\nM\n4\nI a C b l e\n4\nI c F r t t ( o a c t t m A s w\no i s r U o d s T t ( h p C m w\no s a t D S ( n s a a f i a a s t\nc ( t r\n4\nW V p a i f C l t t f\nf c fl r\ni i c w e i i a s s t o s o T\nd g d w\nd i r o a s F S g f C m l s i t\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\nDISCUSSIONS\nn this section, we discuss the interpretation of cross-simulation nalysis (Section 4.1 ), assess the applications and limitations of NNs when applied to CGM (Section 4.2 ), compare the variance etween true and inferred values for log ( M halo ), log ( M cgm ), and og ( Z cgm ) using the idealized multifield maps (Section 4.3 ), and xpand on an intriguing direction for future work (Section 4.4 ).\n.1 Cr oss-simulation interpr etability\nn Section 3.5 , we explore the robustness of simulations by examining ross-simulation inference with and without observational limits. ig. 9 presents cross-simulation inferences for multifield H I + Xay with observational limits on M halo . Upon initial inspection, raining, and testing on Astrid offer the tightest constraints across he entire mass bin. In general, a test simulation will o v erpredict underpredict) properties when trained on a simulation with CGM bservables that are dimmer (brighter). Among the three simulations, CNN trained on IllustrisTNG is the most robust, as it accurately aptures the differences between halo mass measurements when rained on SIMBA and Astrid. Ho we ver, more work must be done o show that a CNN trained on IllustrisTNG will produce the\nost robust predictions when applied to real observational data. no v el aspect to further explore is training and testing on multiple imulations, varying the feedback parameters such that the CNN ould marginalize o v er the uncertainties in baryonic physics. The effort to train and test on different simulations mimics training n a simulation and predicting real observational data. Although it s disappointing to see such deviations in the results of the crossimulation analysis, we know that some simulations offer better epresentations given the specific scope of this work than others. sing observational limits that resemble the ranges of detection f current instruments as a simulation constraint, we can begin irectly comparing simulations and observations. We note that the imulations are unconstrained by available observations in the CGM. he fiducial prescriptions for IllustrisTNG and SIMBA are calibrated o match the available data of the groups with varying success Oppenheimer et al. 2021 ), but Astrid with its higher f gas values as not been calibrated similarly . Importantly , no simulation is a erfect representation of the real universe, but it is crucial to develop NNs that can adapt to a wide range of mock haloes generated using ultiple galaxy formation codes that aim to simulate these systems ith realistic physical prescriptions. Robustness quantification, or how well a network trained on ne simulation can infer a given quantity when tested on another imulation within any set of simulations and machine learning lgorithms, including the CAMELS suites, is crucial to further heir de velopment (Villaescusa-Nav arro et al. 2021b ; Villanue v aomingo & Villaescusa-Navarro 2022 ; Echeverri et al. 2023 ; de anti et al. 2023 ). The lack of robustness can be due to either 1) differences between simulations, (2) networks learning from umerical effects or artefacts, or (3) lack of o v erlapping between imulations in the high-dimensional parameter space. These reasons re not surprising, because of the use of the CV set within CAMELS, nd there could be slight variations in feedback that are unaccounted or. Using the LH set instead would impro v e the results obtained n this work. Additionally, precision (smaller error bars) without ccurac y (reco v ering the \u2018true\u2019 values) is meaningless. Therefore, lthough Astrid generally has the smallest error bars, this alone shows trong biases when tested on other models. Future work can be done o address the inability to obtain robust constraints while performing\nNRAS 527, 10038\u201310058 (2024)\nross-simulation analysis. One avenue is through domain adaptation Ganin et al. 2015 ), which allows a smoother transition between raining and testing on different simulations such that we obtain obust results.\n.2 Applicability and limitations of CNNs applied to the CGM\ne have applied a CNN following the structural format used by illaescusa-Navarro et al. ( 2022 ) and modified it to infer underlying roperties of the CGM of individual haloes with fixed cosmology and strophysics within the CAMELS CV set. The former CNN infers six ndependent parameters (two cosmological and four astrophysical eedback) by the design of the LH simulation set . Our trained CGM NN learns to predict properties with high co-dependencies (e.g. og ( M halo ) and log ( T cgm )) and related quantities ( f cgm and M cgm ). In he latter case, there are two different ways to quantify CGM mass in wo distinct apertures\u2013 M cgm is the CGM mass inside 200 kpc, and cgm is the mass of CGM o v er the total mass inside R 200c .\nWe attempted to infer one property at a time instead of all six and ound only a marginal impro v ement. CNN implemented in this work, lassified as a moment network (Jeffrey & Wandelt 2020 ), has the exibility to infer multiple properties simultaneously, but requires a igorous hyperparameter search, as detailed in Section 2.3 .\nA concern that often appears with any simulation-based approach s the possibility of biases seeping into the result, generally due to ncomplete modelling of physical processes. We aim to alleviate this oncern first by using the CV set within the CAMELS simulations, here the values of cosmological and astrophysical feedback paramters are fixed to their fiducial values. The LH set, which was not used n this work (but could easily be integrated as part of future efforts), ncreases the chances of successful cross-simulation analysis as the strophysical dependencies are completely marginalized. From this tandpoint, the CV set is not best suited to produce robust crossimulation analysis. Using the CV set, we gain valuable insight into he distinctions among simulations and their effects on the results f the CGM properties in this study. In addition to using the LH et, we can explore training and testing on more than one simulation r performing a similar analysis on the broader parameter space of NG-SB28 (Ni et al. 2023 ). We apply CNNs to the CGM data sets to (1) determine the egree to which physical properties of the CGM can be inferred iven a combination of fields and simulations, and (2) examine ifferent observing strategies to determine how combining different avebands can infer underlying CGM properties. We demonstrate the feasibility of applying a CNN to observational ata sets and return values and errors for the CGM properties, ncluding M halo and M cgm . Additionally, the inference of M halo is more obustly determined when another field, along with its associated bservational limits, is added. However, training on one simulation nd testing on another support the notion that predictions can produce ignificantly divergent results compared to the true values, as seen in igs 8 and 9 . As mentioned in Section 4.1 , although IllustrisTNG, IMBA, and Astrid have been tuned to reproduce galaxies\u2019 and some as properties, they make varied predictions for gaseous haloes. In uture efforts to impro v e this work, the LH set would replace the V set, under the expectation of improvement, as all astrophysics is arginalized. Should this not be the case, domain adaptation is the onger term solution to help bridge the many gaps between different ubgrid physics models. Another interesting future direction would nclude training and testing on combinations of simulations, though his is ideally performed with the LH set.\nTable 3. The variance of M cgm and log ( Z cgm ) compared between the input from CAMELS (truth) and the values from the idealized multifield (H I + Xray) inference.\nlog ( M cgm ) sub- L \u2217 L \u2217 True Infer True Infer\nIllustrisTNG 0.024 0.013 0.127 0.074 SIMBA 0.099 0.094 0.129 0.111 Astrid 0.026 0.024 0.038 0.038 log ( Z cgm ) sub- L \u2217 L \u2217 True Infer True Infer IllustrisTNG 0.072 0.041 0.078 0.035 SIMBA 0.086 0.060 0.108 0.052 Astrid 0.053 0.033 0.042 0.035\n4\nA r C a d d a t i d H f a w w t u h l g\n4\nI t C c n o r A m h i p i o\n5\nI b m m m t\nr C O\na\na a o d S w n e r T ( b e\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024 .3 Multifield variance comparison s an additional test, we check if our CNN-inferred values can eproduce the original dispersion of a CGM data set. Even if a NN can reproduce the mean value of a CGM parameter, can it lso reproduce the spread of values? Fig. 1 shows the shaded \u00b11 \u03c3 ispersions in addition to the medians. We, therefore, calculate the ispersion for log ( M cgm ) and log ( Z cgm ) for sub- L \u2217 and L \u2217 galaxies cross the three simulations to explore our CNN\u2019s ability to reproduce his scatter in relatively flat M halo bins. The values are displayed n Table 3 . On a positive note, it does appear that sub- L \u2217 and L \u2217 ispersions for log ( M cgm ) are well reproduced in SIMBA and Astrid. o we ver, the dispersions are severely underestimated, often by a actor of 2, for log ( Z cgm ) and log( M cgm ), but, notably, R 2 measures nd the performance of the CNN is poor for these cases. In particular, ith IllustrisTNG, M CGM , and f CGM as a closely related quantity, show orse performance due to rapidly changing gas fractions in response o feedback, as we discuss in Section 3.2 . In this case, the CNN is nable to adequately learn signatures of reduced CGM mass at a fixed alo mass. This test presents a crucial challenge for future machine earning and deep learning methods in reproducing the spread of a iven property for objects that are otherwise alike. .4 Future work n expanding the scope of this work to additional wavelengths in he future, we also aim to advance our understanding of where the NN extracts important information from within a given map. We an use the information gained from this type of analysis, which has ot been applied to CGM data before this work, to inform future bservational surv e ys on how best to achieve the greatest scientific eturns giv en wav elength, surv e y depth, and other specifications. dditionally, this type of analysis will be necessary to determine achine learning verification and validation. To achieve this, we ypothesize that moving towards higher resolution simulations, ncluding IllustrisTNG-100, EAGLE, and others along with a more hysically moti v ated deep-learning model, will have a significant mpact across a wide range of scales, especially in the case of bservational limits.\nC O N C L U S I O N S\nn this study, we use CNNs trained and tested on CAMELS simulations ased on the IllustrisTNG, SIMBA, and Astrid galaxy formation odels to infer six broad-scale properties of the circum-galactic edium (CGM). We focus on the halo mass, the CGM mass, the etallicity, the temperature, and the cool gas fraction. We simulate wo observational fields, X-ray and 21-cm H I radio, which can\nepresent the broad temperature range of the CGM. We tested our NN on data sets with and without (idealized) observational limits. ur key findings include the following.\n(i) When training and testing the CNN on the same simulation:\n(a) By comparing all the CGM properties the CNN is trained to infer, it performs the best o v erall on M halo and M cgm , both with and without observational limits. For IllustrisTNG with observational limits, the RMSE values returned for M halo are \u223c0.14 dex, and M cgm are \u223c0.11 dex when combining X-ray and H I data.\n(b) The \u2018multifield\u2019 CNN trained simultaneously on X-ray and H I data with observational limits allows for the best inference across the entire mass range using the same inpts without the discontinuities seen when trained only on one field. Obtaining interpretable inferences on the halo mass for the continuous range of 11.5 \u2264 log ( M halo /M ) \u2264 14.5 requires a multifield, although various combinations may be better o v er smaller mass bins than others. Sub- L \u2217 haloes ( M halo = 10 11.5 \u221212 M ) are only marginally better inferred with H I than multifield. Moving to L \u2217 haloes ( M halo = 10 12 \u221213 M ) and the more massive groups ( M halo > 10 13 M ), there is a drastic impro v ement when using multifield o v er X-ray and H I alone. Our exploration demonstrates that CNN-fed multiple observational fields with detectable signals can continuously impro v e the inference of CGM properties o v er a large mass range given the same input maps.\n(c) When adding observational limits to the multifield CNN, the inference accuracy declines, but still returns RMSE values indicating success. Reco v ering total mass from observations appears to be feasible with our CNN. H I mapping is especially critical for reco v ering CGM properties of sub- L \u2217 and L \u2217 galaxies.\n(ii) For CNN cross-simulation analysis (training on one simulation nd testing on another):\n(a) When applying cross-simulation analysis by training on one simulation and testing on another, the inferred values generally correlate with the true physical properties. Still, they are frequently offset, indicating strong biases and o v erall poor statistical performance.\n(b) Interestingly, the cross-simulation analysis reveals that using the H I + X-ray multifield with observational limits impro v es the halo mass inference compared to that from X-ray maps alone. In the process of adding constraints in this case, the difference between the individual simulation parameter spaces becomes smaller and acts as tighter boundary conditions for the network.\nOur results have broader implications for applying deep learning lgorithms to the CGM than those outlined here. First, performing cross-simulation analysis and determining that the CNN is robust pens the possibility of replacing one of the simulations with real ata to infer the actual physical properties of observed systems. econd, the addition of more wavelengths is easily implemented ithin image-based neural networks. To continue making conections to current and future multiwavelength surveys, we can xpand the number of fields used in this architecture beyond Xay and H I , including image-based CGM probes like the Dragonfly elescope that can map the CGM in optical ions, like H \u03b1 and N II Lokhorst et al. 2022 ), and UV emission from ground- or spaceased probes (Johnson et al. 2014 ; Burchett et al. 2018 ; Johnson t al. 2018 ; P \u0301eroux & Howk 2020 ). Most importantly, this method\nMNRAS 527, 10038\u201310058 (2024)\nM\nw o c m a 2 M t t w t f T r\nb t a p e t e H u d t r w a\nA\nW s o s t C b b ( g S A A\nD\nC h f\nR\nA\nA A\n5\nA\nA B\nB B\nB B\nB C\nC\nC D\nD\nD\nd\nD d E F\nG\nG H H H H H H J J\nJ J J J\nK K K L\nL L L M N N N N O O\nO\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\nould allow simulation differences to be marginalized, while still btaining correlations and constraints. We can o v ercome the current hallenges of cross-simulation analysis by training our CNN on ultiple CAMELS simulations and parameter variations existing nd in production [including expanding to EAGLE (Schaye et al. 015 ), RAMSES (Teyssier 2010 ), Enzo (Bryan et al. 2014 ), and agneticum 5 ] while integrating additional wavebands. It is crucial o identify the primary source of information for CNN to increase he number of simulations and wavelengths used as input. Future ork includes performing saliency analysis with integrated gradients o determine the most important pixels on a given map. It allows or more targeted and efficient adjustments to impro v e inferences. his can reveal which underlying physical properties are universally eco v erable and robustly predictable in observations. The CGM demarcates a region of space defined by nebulous oundaries, which poses a unique challenge to traditional analysis echniques like principal component analysis. In addition, there re no established methods to characteristically analyse CGM. The hrase \u2018characteristically analysing\u2019 implies distinctly categorizing ntities. For instance, traditional analysis can be used with galaxies o classify them into various categories based on their unique volutionary traits, as e videnced by Lotz, Primack & Madau ( 2004 ). o we ver, the CGM refers to the area surrounding the galactic disc ntil the accretion shock radius, where neither boundary is precisely efined as they cannot be directly observed. Applying the same raditional analysis approach to a CGM data set would require a igid pipeline, making it difficult to incorporate new simulations or av elengths without e xtensiv e reconfiguration. Deep learning offers more flexible and versatile approach as a solution.\nC K N OW L E D G E M E N T S\ne thank Shy Genel and Matthew Ho for valuable feedback and uggestions for the paper. The CAMELS simulations were performed n the supercomputing facilities of the Flatiron Institute, which is upported by the Simons Foundation. This work is supported by he NSF grant AST 2206055 and the Yale Center for Research omputing facilities and staff. The work of FVN is supported y the Simons Foundation. The CAMELS project is supported y the Simons Foundation and the National Science Foundation NSF) grant AST 2108078. DAA acknowledges support by NSF rants AST-2009687 and AST-2108944, CXO grant TM2-23006X, imons Foundation Award CCA-1018464, and Cottrell Scholar ward CS-CSA-2023-028 by the Research Corporation for Science dvancement.\nATA AVAILABILITY\nAMELS data are publicly available at t tps://camels.readt hedocs.io/en/lat est/. Original data is available rom the authors upon request by emailing naomi.gluck@yale.edu .\nE FERENCES\nkiba T. , Sano S., Yanase T., Ohta T., Koyama M., 2019, preprint ( arXiv:1907.10902 ) nderson M. E. , Bregman J. N., 2011, ApJ , 737, 22 ngl \u0301es-Alc \u0301azar D. , Dav \u0301e R., Faucher-Gigu \u0300ere C.-A., O\u0308zel F., Hopkins P. F.,\n2017a, MNRAS , 464, 2840\nNRAS 527, 10038\u201310058 (2024)\nhttp:// www.magneticum.org/\nP P\nngl \u0301es-Alc \u0301azar D. , Faucher-Gigu \u0300ere C.-A., Kere \u030cs D., Hopkins P. F., Quataert E., Murray N., 2017b, MNRAS , 470, 4698 splund M. , Grevesse N., Sauval A. J., Scott P., 2009, ARA&A , 47, 481 ird S. , Ni Y., Di Matteo T., Croft R., Feng Y., Chen N., 2022, MNRAS , 512,\n3703 ogd \u0301an A\u0301. , Lovisari L., Volonteri M., Dubois Y., 2018, ApJ , 852, 131 regman J. N. , Anderson M. E., Miller M. J., Hodges-Kluck E., Dai X., Li\nJ.-T., Li Y., Qu Z., 2018, ApJ , 862, 3 ryan G. L. et al., 2014, ApJS , 211, 19 urchett J. N. , Tripp T. M., Wang Q. D., Willmer C. N. A., Bowen D. V.,\nJenkins E. B., 2018, MNRAS , 475, 2067 ykov A. M. , Dolag K., Durret F., 2008, Space Sci. Rev. , 134, 119 hadayammuri U. , Bogd \u0301an A\u0301., Oppenheimer B. D., Kraft R. P., Forman W.\nR., Jones C., 2022, ApJ , 936, L15 hristensen C. R. , Dav \u0301e R., Go v ernato F., Pontzen A., Brooks A., Munshi F.,\nQuinn T., Wadsley J., 2016, ApJ , 824, 57 ooksey K. L. , Thom C., Prochaska J. X., Chen H.-W., 2010, ApJ , 708, 868 avies J. J. , Crain R. A., Oppenheimer B. D., Schaye J., 2020, MNRAS , 491,\n4462 av \u0301e R. , Crain R. A., Stevens A. R. H., Narayanan D., Saintonge A., Catinella\nB., Cortese L., 2020, MNRAS , 497, 146 av \u0301e R. , Angl \u0301es-Alc \u0301azar D., Narayanan D., Li Q., Rafieferantsoa M. H.,\nAppleby S., 2019, MNRAS , 486, 2827 e Blok W. J. G. et al., 2016, in MeerKAT Science: On the Pathway to the\nSKA. p. 7, preprint ( arXiv:1709.08458 ) elgado A. M. et al., 2023, MNRAS , doi: e Santi N. S. M. et al., 2023, ApJ , 952, 69 cheverri N. et al., 2023, ApJ , 954, 125 eng Y. , Bird S., Anderson L., Font-Ribera A., Pedersen C., 2018, MP-\nGadget/MP-Gadget: A tag for getting a DOI anin Y. , Ustinova E., Ajakan H., Germain P., Larochelle H., Laviolette F.,\nMarchand M., Lempitsky V., 2015, preprint ( arXiv:1505.07818 ) ebhardt M. et al., 2023, preprint ( arXiv:2307.11832 ) aardt F. , Madau P., 2012, ApJ , 746, 125 afen Z. et al., 2019, MNRAS , 488, 1248 opkins P. F. , 2015, MNRAS , 450, 53 opkins P. F. , 2017, preprint ( arXiv:1712.01294 ) opkins P. F. et al., 2018, MNRAS , 480, 800 ummels C. B. , Smith B. D., Silvia D. W., 2017, ApJ , 847, 59\neffrey N. , Wandelt B. D., 2020, preprint ( arXiv:2011.05991 ) ohnson S. D. , Chen H.-W., Mulchaey J. S., Tripp T. M., Prochaska J. X.,\nWerk J. K., 2014, MNRAS , 438, 3039 ohnson L. C. et al., 2015, ApJ , 802, 127 ohnson S. D. et al., 2018, ApJ , 869, L1 ohnston S. et al., 2007, PASA , 24, 174 onas J. , MeerKAT Team , 2016, in MeerKAT Science: On the Pathway to the\nSKA. p. 1 ang H. , Ryu D., Cen R., Ostriker J. P., 2007, ApJ , 669, 729 eeney B. A. et al., 2018, ApJS , 237, 11 eres D. , Katz N., Weinberg D. H., Dave R., 2005, MNRAS , 363, 2 i J.-T. , Bregman J. N., Wang Q. D., Crain R. A., Anderson M. E., Zhang S.,\n2017, ApJS , 233, 20 i R. et al., 2022, ApJ , 936, 11 okhorst D. et al., 2022, ApJ , 927, 136 otz J. M. , Primack J., Madau P., 2004, AJ , 128, 163 athur S. , Das S., Gupta A., Krongold Y., 2023, MNRAS , 525, L11 elson D. et al., 2018, MNRAS , 475, 624 elson D. et al., 2019, CompAC , 6, 2 i Y. et al., 2022, MNRAS , 513, 670 i Y. et al., 2023, ApJ , 959, 136 ppenheimer B. D. et al., 2016, MNRAS , 460, 2157 ppenheimer B. D. , Schaye J., Crain R. A., Werk J. K., Richings A. J., 2018,\nMNRAS , 481, 835 ppenheimer B. D. , Babul A., Bah \u0301e Y., Butsky I. S., McCarthy I. G., 2021,\nUniverse , 7, 209 aszke A. et al., 2019, preprint ( arXiv:1912.01703 ) eeples M. S. , Werk J. K., Tumlinson J., Oppenheimer B. D., Prochaska J.\nX., Katz N., Weinberg D. H., 2014, ApJ , 786, 54\nP P P P R S S S S T T T T T\nV V V V V W W W\nW W Z\nZ\nA D\nI t ( l o a t\nX r a e t\nc w r m C a p d 8 l\nF w t\nD ow nloaded from https://academ ic.oup.com /m nras/article/527\n \u0301eroux C. , Howk J. C., 2020, ARA&A , 58, 363 illepich A. et al., 2018, MNRAS , 473, 4077 redehl P. et al., 2020, Nature , 588, 227 redehl P. et al., 2021, A&A , 647, A1 ahmati A. , P a wlik A. H., Rai \u030ccevi \u0301c M., Schaye J., 2013, MNRAS , 430, 2427 chaye J. et al., 2015, MNRAS , 446, 521 omerville R. S. , Popping G., Trager S. C., 2015, MNRAS , 453, 4337 pringel V. , 2005, MNRAS , 364, 1105 pringel V. , 2010, MNRAS , 401, 791 eyssier R. , 2010, Astrophysics Source Code Library, record ascl:1011.007 umlinson J. et al., 2011, Science , 334, 948 umlinson J. et al., 2013, ApJ , 777, 59 umlinson J. , Peeples M. S., Werk J. K., 2017, ARA&A , 55, 389 urk M. J. , Smith B. D., Oishi J. S., Skory S., Skillman S. W., Abel T.,\nNorman M. L., 2011, ApJS , 192, 9 illaescusa-Navarro F. et al., 2021a, preprint ( arXiv:2109.09747 ) illaescusa-Navarro F. et al., 2021b, preprint ( arXiv:2109.10360 ) illaescusa-Navarro F. et al., 2021c, ApJ , 915, 71 illaescusa-Navarro F. et al., 2022, ApJS , 259, 61 illanue v a-Domingo P. , Villaescusa-Navarro F., 2022, ApJ , 937, 115 einberger R. et al., 2017, MNRAS , 465, 3291 einberger R. , Springel V., Pakmor R., 2020, ApJS , 248, 32 erk J. K. , Prochaska J. X., Thom C., Tumlinson J., Tripp T. M., O\u2019Meara J.\nM., Peeples M. S., 2013, ApJS , 204, 17 erk J. K. et al., 2014, ApJ , 792, 8 etzel A. et al., 2023, ApJS , 265, 44\ninger E. , Dekel A., Birnboim Y., Nagai D., Lau E., Kravtsov A. V., 2018, MNRAS , 476, 56 uHone J. A. , Hallman E. J., 2016, Astrophysics Source Code Library, record ascl:1608.002.\nw\nigure A1. Maps of idealized X-ray (row 1), X-ray with observational limits (row ith IllustrisTNG. Moving across the row are haloes of decreasing mass (approxim\nhe same mass.\n/\nPPENDI X A : A D D I T I O NA L PLOTS O F M O C K ATA SETS\nn this appendix, we provide additional maps and plots, including he scatter of M halo with total pixel counts per map in X-ray and H I analogous to Fig. 1 ), and Truth\u2013Inference plots for inferred f cgm , og ( Z cgm ), f cool , and log ( T cgm ) for the H I + X-ray multifield with bservational limits. We omit M halo or M cgm here, as similar panels re shown in the diagonal panels of Figs 9 and 10 . A summary of hese properties and their trends with halo mass is shown in Fig. 7 .\nFig. A1 is an e xpanded v ersion of Fig. 2 for IllustrisTNG maps in -ray (with and without observational limits, first and second rows, espectively) and H I (with and without observational limits, third nd fourth ro ws, respecti vely) across most of the halo mass range xplored in our analysis. Each column indicates four variations of he same halo.\nFig. A2 illustrates the scatter of log ( M halo /M ), where each oloured point represents the total pixel value of each map along ith the respective halo mass. \u2018Pixel counts\u2019, as the total flux (Xay) or the total column density (H I ), are the sum of the pixels in each ap (log-scaled). We only include one image axis (even though our NN training set uses three rotations of the same halo along the three xes) so that the same halo does not appear more than once. The black oints represent the average trends in each halo mass bin (see the efinitions of the mass bin in Table 2 ), and the error bars are the 16th\u2013 4th percentiles. Dashed grey vertical lines indicate the observational imits of each field, such that to the left of this line reside objects that ould be too faint to observe with current instruments. The top row\nMNRAS 527, 10038\u201310058 (2024)\n2), idealized H I (row 3), and H I with observational limits (row 4), as seen ately 0.5 dex), where columns correspond to the same halo map and hence\n4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\nM\nFigure A2. Halo mass as a function of the spatially integrated (total) flux in X-ray (top; green) and H I (bottom; pink) for all maps available from the IllustrisTNG (left), SIMBA (middle), and Astrid (right) simulations. The vertical dashed line represents the observational limit of each field, and the black points represent the average value in each mass bin. The error bars represent the average 16\u201384 percentile in total flux for different halo mass bins. We see correlations only for IllustrisTNG and Astrid in X-ray.\ns h s h B m p t c\nA T\nF H t ( m s r l t p\nH\nF f\nF o\nD ow nloaded from https://academ ic.oup.com /m nras/article/527\nNRAS 527, 10038\u201310058 (2024)\nigure B1. Truth\u2013Inference plots for f cgm using H I + X-ray with observational li ull data set.\nigure B2. Truth\u2013Inference plots for log ( Z cgm ) using H I + X-ray with observatio f the full data set.\nhows this scatter in X-ray, where there is a clear correlation with the alo mass for IllustrisTNG and Astrid. The bottom ro w sho ws the catter in H I , similarly formatted. In this case, the correlations with alo mass for all simulations are either too weak or non-existent. oth fields match the expected trends from the visualization of the aps in Fig. A1 . This e x ercise aims to see if the halo mass can be redicted solely with total flux. Since the vertical scatter is not in he same order and is much larger than the network error, we cannot onclude that the halo mass is based only on the total flux.\nPPENDI X B: A D D I T I O NA L MULTIFIELD RU T H \u2013 I N F E R E N C E PLOTS\nig. B1 shows the Truth\u2013Inference plots for f cgm with the multifield I + X-ray and observational limits. We see a significant scatter\nhroughout the mass range when training and testing on IllustrisTNG left). Training and testing on SIMBA (middle) shows intermediateass haloes clustered at low f cgm values, and low-mass haloes cattered throughout. Training and testing on Astrid (right) shows a elati vely lo w amount of scatter with small error bars, resulting in the owest and highest R 2 value. Also, note that Astrid shifts the entire rend towards higher f cgm values and has its highest concentration of oints towards higher values of f cgm . Fig. B2 shows the Truth\u2013Inference plots for log ( Z cgm ) with the I + X-ray multifield and observational limits. Training and testing\nmits for IllustrisTNG, SIMBA, and Astrid. These points are a fraction of the\nnal limits for IllustrisTNG, SIMBA, and Astrid. These points are a fraction\n/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024\nFigure B3. Truth\u2013Inference plots for f cool (defined in equation 5 ) using H I + X-ray with observational limits for IllustrisTNG, SIMBA, and Astrid. These points are a fraction of the full data set.\nFigure B4. Truth\u2013Inference plots for log ( T cgm ) (defined in equation 6 ) using H I + X-ray with observational limits for IllustrisTNG, SIMBA, and Astrid. These points are a fraction of the full data set.\no s o t\nH i g d\nw a i o a s\nA\nI s w\nA N t a m o o t t m d\ni a i m S n w\ni s t o\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024 n IllustrisTNG (left) or SIMBA (middle) results in significant catter. Training and testing on Astrid shows a relatively low amount f scatter with small error bars. These trends look relatively similar o those with idealized maps of X-rays and H I (Fig. 5 ). Fig. B3 shows the Truth\u2013Inference plots for f cool with the multifield I + X-ray and observational limits. All three simulations have nferences with significant scatter and large error bars. The multifield reatly impro v es the inference results for this property, which is ifficult to constrain within the scope of this work. Finally, Fig. B4 shows the Truth\u2013Inference plots for log ( T cgm ) ith the H I + X-ray multifield and observational limits. Training nd testing on IllustrisTNG provide relatively good inference, with ncreased scatter for intermediate-mass haloes. Training and testing n SIMBA show the largest scatter across the mass range. Training nd testing on Astrid provides the least amount of scatter, with the mallest error bars and an o v erall impressiv e inference.\nPPENDIX C : C N N A R C H I T E C T U R E\nnitially, a similar CNN was applied to the CAMELS Multifield Data et (CMD; Villaescusa-Navarro et al. 2021c ) as continuous 2D maps ith the aim of constraining two cosmological parameters ( \u03c3 8 and M ), and four astrophysical feedback parameters ( A SN1 , A SN2 , A AGN1 ,\nAGN2 ) whose definitions change depending on the simulation used. ote that 3D maps are also available and can be reduced to obtain he existing 2D maps, but are not used for this analysis. A multifield llows the combination of fields to determine which singular or ultiple fields return the tightest and most accurate constraints n an y giv en parameter. The parameters currently available in the riginal network for the CMD are gas properties (density , velocity , emperature, pressure, metallicity), neutral hydrogen density, elecron number density, magnetic fields, magnesium-ion fraction, dark atter density, and velocity, stellar mass density, and the total matter ensity. We now define the variables used for the CNN used for this work n Table C1 . The names of layers beginning with C refer to Conv2d , nd B refers to BatchNorm2d . Each type of layer has different nput variables as described in the first mention of the layer type, with\nore details in the Paszke et al. ( 2019 ) documentation for PyTorch . ubsequent layers of these two types do not ha ve headings, b ut the umbers in the columns refer to the variable names and definitions hen they are first mentioned. For the Conv2d layers, Input and Output are the size of the mage produced as it passes through each layer. Kernel refers to the ize of the kernel or the grid space in any particular layer. Stride is he number of rows and columns that have passed through each \u2018slide\u2019 r translation between layers. If computational efficiency is not an\nMNRAS 527, 10038\u201310058 (2024)\nM\nTable C1. Table outlining the main body of the CNN architecture used.\nLayer Input Output Kernel Stride Padding\nC01 1 12 (3,3) (1,1) (1,1) C02 12 12 (3,3) (1,1) (1,1) C03 12 12 (2,2) (2,2)\nLayer Size Momentum Affine Tracking B01 12 1e \u22125 0.1 True True B02 12 1e \u22125 0.1 True True B03 12 1e \u22125 0.1 True True C11 12 24 (3,3) (1,1) (1,1) C12 24 24 (3,3) (1,1) (1,1) C13 24 24 (2,2) (2,2) \u2013 B11 24 1e \u22125 0.1 True True B12 24 1e \u22125 0.1 True True B13 24 1e \u22125 0.1 True True C21 24 48 (3,3) (1,1) (1,1) C22 48 48 (3,3) (1,1) (1,1) C23 48 48 (2,2) (2,2) \u2013 B21 48 1e \u22125 0.1 True True B22 48 1e \u22125 0.1 True True B23 48 1e \u22125 0.1 True True C31 48 96 (3,3) (1,1) (1,1) C32 96 96 (3,3) (1,1) (1,1) C33 96 96 (2,2) (2,2) \u2013 B31 96 1e \u22125 0.1 True True B32 96 1e \u22125 0.1 True True B33 96 1e \u22125 0.1 True True C41 96 192 (3,3) (1,1) (1,1) C42 192 192 (3,3) (1,1) (1,1) C43 192 192 (2,2) (2,2) \u2013 B41 192 1e \u22125 0.1 True True B42 192 1e \u22125 0.1 True True B43 192 1e \u22125 0.1 True True C51 192 384 (3,3) (1,1) (1,1) C52 384 394 (3,3) (1,1) (1,1) C53 384 384 (2,2) (2,2) \u2013 B51 384 1e \u22125 0.1 True True B52 384 1e \u22125 0.1 True True B53 384 1e \u22125 0.1 True True C61 384 768 (2,2) (1,1) \u2013 B61 768 1e \u22125 0.1 True True\ni a t P t w p t i o\no\nt c t c i w\nTable C2. A continuation of the neural network architecture, following Table C1 .\nLayer Type Kernel size Stride Padding\nP0 AvgPool2d 2 2 0 Layer Type Feat. In Feat. Out Bias FC1 Linear 768 384 True FC2 Linear 384 12 True Layer Function p -value in-place Slope Dropout Dropout() 0.3522 False ReLU ReLU() LeakyReLU LeakyReLU() \u22120.2 tanh Tanh()\nw t i t t\nT s d w P\nl o T b T p f i p o u\np\nR\nT o d\nL\nw u t d p\nT\nw c\nThis paper has been typeset from a T E X/L A T E X file prepared by the author.\nD ow nloaded from https://academ ic.oup.com /m nras/article/527/4/10038/7462315 by Indian Institute of Technology Patna user on 09 January 2024 ssue, in some cases, it can be more accurate to slide one element at time. Ho we ver, cutting out the intermediate steps and increasing he stride for larger data sets like the one used here is more efficient. adding refers to filling the kernel\u2019s edges after each layer. As he dimensions of the image decrease and eventually reach 1 \u00d7 1, e need to fill the space left after each dimensional reduction. One adding mode is the \u2018zeros\u2019, where values of 0 are used as a filler as he image is processed through the network. Another common mode s \u2018circular\u2019, where the grid is filled with the value at the boundary f the image in the current stage. For the BatchNorm2d layers, where Size refers to the number f features based on some expected input size from the previous layer. is added to the denominator of any value to ensure the stability of he pipeline and the results. Momentum can be set to None if a umulativ e mo ving av erage (simple av erage) is being computed, but he default value is 0.1 for the running mean and running variance omputations. Note that this argument is slightly different from what s generally used in optimizer classes. Affine , if set to True, allows eights and biases to be defined, which are \u03b3 and \u03b2, respectively,\nNRAS 527, 10038\u201310058 (2024)\nPublished by Oxford University Press on behalf of Royal Astronomical Society. This is an ( https://cr eativecommons.or g/licenses/by/4.0/), which permits unrestricted reus\nithin the documentation. Tracking , if set to True as the default, racks the mean and variance. If set to False, statistics buffers are nitialized such that running-mean and running-var is set o None, and the module uses only batch statistics for training and esting modes.\nIn Table C2 , the functions mentioned directly follow those of able C1 . The P0: AvgPool2d layer includes the kernel ize for the window size. Stride and Padding have similar efinitions as before, where Stride now refers to the stride of the indow, where it defaults to the same value as the kernel size, and adding is defaulted to \u2018zeros\u2019 mode, discussed previously. A linear transformation is applied for both Fully Connected (FC) ayers, where the Feat. In and Feat. Out refers to the size f each input and output sample, respectively. Setting the bias to rue (as the default) allows the activation function to be shifted y some constant amount, known as the bias, to the layer input. he dropout layers randomly disengage some neurons with some robability, p-value , or just as p , to discourage some neurons rom being fa v oured o v er others. The default p -value is 0.5. Finally, f set to True, inplace will randomly set the neurones to zero in lace. The default value for this parameter is False, where the results f the dropout layer are saved to a separate variable to be potentially sed later. The ReLU() , or the rectified linear acti v ation function (linear, iece-wise), takes this form:\neLU(x) = (x) + = max (0 , x) . (C1) he input is returned directly if positive and will be set to zero therwise. The LeakyReLU() (Leaky rectified linear unit) is efined as\neakyReLU (x) = {\nx, if x \u2265 0 ne gativ e slope \u00d7 x , otherwise , (C2)\nhere the negative slope controls the slope angle specifically sed for ne gativ e input values. The default value is 0.001, such hat instead of a flat slope for ne gativ e values, it has a small slope, etermined before training begins, and is not a result of the training rocess. The Tanh() function is defined as,\nanh (x) = exp (x) \u2212 exp ( \u2212x) exp (x) + exp ( \u2212x) , (C3)\nhere it is used in place of the sigmoid function, as it is more omputationally efficient for networks with multiple layers.\n\u00a9 2023 The Author(s). Open Access article distributed under the terms of the Creative Commons Attribution License e, distribution, and reproduction in any medium, provided the original work is properly cited."
        }
    ],
    "title": "An observationally driven multifield approach for probing the circum-galactic medium with convolutional neural networks",
    "year": 2023
}