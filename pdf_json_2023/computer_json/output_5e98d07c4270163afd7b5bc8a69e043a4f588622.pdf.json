{
    "abstractText": "Many existing digital human models approximate the human skeletal system using rigid bodies connected by rotational joints. While the simplification is considered acceptable for legs and arms, it significantly lacks fidelity to model rich torso movements in common activities such as dancing, Yoga, and various sports. Research from biomechanics provides more detailed modeling for parts of the torso, but their models often operate in isolation and are not fast and robust enough to support computationally heavy applications and large-scale data generation for full-body digital humans. This paper proposes a new torso model that aims to achieve high fidelity both in perception and in functionality, while being computationally feasible for simulation and optimal control tasks. We build a detailed human torso model consisting of various anatomical components, including facets, ligaments, and intervertebral discs, by coupling efficient finite-element and rigid-body simulations. Given an existing motion capture sequence without dense markers placed on the torso, our new model is able to recover the underlying torso bone movements. Our method is remarkably robust that it",
    "authors": [
        {
            "affiliations": [],
            "name": "SEUNGHWAN LEE"
        },
        {
            "affiliations": [],
            "name": "YIFENG JIANG"
        },
        {
            "affiliations": [],
            "name": "KAREN LIU"
        },
        {
            "affiliations": [],
            "name": "Seunghwan Lee"
        },
        {
            "affiliations": [],
            "name": "Yifeng Jiang"
        }
    ],
    "id": "SP:d253379ba706e7b0919098fa3a885d18fdef9b94",
    "references": [
        {
            "authors": [
                "William J Anderst",
                "William F Donaldson III",
                "Joon Y Lee",
                "James D Kang."
            ],
            "title": "Threedimensional intervertebral kinematics in the healthy young adult cervical spine during dynamic functional loading",
            "venue": "Journal of biomechanics 48, 7 (2015), 1286\u20131293.",
            "year": 2015
        },
        {
            "authors": [
                "Baptiste Angles",
                "Daniel Rebain",
                "Miles Macklin",
                "Brian Wyvill",
                "Loic Barthe",
                "JP Lewis",
                "Javier Von Der Pahlen",
                "Shahram Izadi",
                "Julien Valentin",
                "Sofien Bouaziz"
            ],
            "title": "Viper: Volume invariant position-based elastic rods",
            "venue": "Proceedings of the ACM on Computer Graphics and Interactive Techniques",
            "year": 2019
        },
        {
            "authors": [
                "Mihai Anitescu",
                "Florian A Potra."
            ],
            "title": "Formulating dynamic multi-rigid-body contact problems with friction as solvable linear complementarity problems",
            "venue": "Nonlinear Dynamics 14, 3 (1997), 231\u2013247.",
            "year": 1997
        },
        {
            "authors": [
                "SK Bhalla",
                "EH Simmons."
            ],
            "title": "Normal ranges of intervertebral-joint motion of the cervical spine",
            "venue": "Canadian Journal of Surgery 12, 2 (1969), 181\u2013187.",
            "year": 1969
        },
        {
            "authors": [
                "Sofien Bouaziz",
                "Sebastian Martin",
                "Tiantian Liu",
                "Ladislav Kavan",
                "Mark Pauly."
            ],
            "title": "Projective dynamics: Fusing constraint projections for fast simulation",
            "venue": "ACM transactions on graphics (TOG) 33, 4 (2014), 1\u201311.",
            "year": 2014
        },
        {
            "authors": [
                "Alexander G. Bruno",
                "Mary L. Bouxsein",
                "Dennis E. Anderson."
            ],
            "title": "Development and Validation of a Musculoskeletal Model of the Fully Articulated Thoracolumbar Spine and Rib Cage",
            "venue": "Journal of Biomechanical Engineering 137, 8 (06 2015). https://doi.org/10.1115/1.4030408 arXiv:https://asmedigitalcollection.asme.org/biomechanical/article-",
            "year": 2015
        },
        {
            "authors": [
                "Daniel LA Camacho",
                "William R Ledoux",
                "Eric S Rohr",
                "Bruce J Sangeorzan",
                "Randal P Ching."
            ],
            "title": "A three-dimensional, anatomically detailed foot model: a foundation for a finite element simulation and means of quantifying foot-bone position",
            "venue": "Journal of rehabilitation research and development 39, 3 (2002), 401\u2013410.",
            "year": 2002
        },
        {
            "authors": [
                "Dario Cazzola",
                "Timothy P Holsgrove",
                "Ezio Preatoni",
                "Harinderjit S Gill",
                "Grant Trewartha."
            ],
            "title": "Cervical spine injuries: a whole-body musculoskeletal model for the analysis of spinal loading",
            "venue": "PloS one 12, 1 (2017), e0169329.",
            "year": 2017
        },
        {
            "authors": [
                "Isaac Chao",
                "Ulrich Pinkall",
                "Patrick Sanan",
                "Peter Schr\u00f6der."
            ],
            "title": "A simple geometric model for elastic deformations",
            "venue": "ACM transactions on graphics (TOG) 29, 4 (2010), 1\u20136.",
            "year": 2010
        },
        {
            "authors": [
                "RichardW Cottle",
                "Jong-Shi Pang",
                "Richard E Stone."
            ],
            "title": "The linear complementarity problem",
            "venue": "SIAM.",
            "year": 2009
        },
        {
            "authors": [
                "B Daumas",
                "WL Xu",
                "J Bronlund."
            ],
            "title": "Jaw mechanism modeling and simulation",
            "venue": "Mechanism and Machine Theory 40, 7 (2005), 821\u2013833.",
            "year": 2005
        },
        {
            "authors": [
                "Scott L Delp",
                "Frank C Anderson",
                "Allison S Arnold",
                "Peter Loan",
                "Ayman Habib",
                "Chand T John",
                "Eran Guendelman",
                "Darryl G Thelen."
            ],
            "title": "OpenSim: open-source software to create and analyze dynamic simulations of movement",
            "venue": "IEEE transactions on biomedical engineering 54, 11 (2007), 1940\u20131950.",
            "year": 2007
        },
        {
            "authors": [
                "Ali Hamadi Dicko",
                "Nicolas Tong-Yette",
                "Benjamin Gilles",
                "Fran\u00e7ois Faure",
                "Olivier Palombi."
            ],
            "title": "Construction and Validation of a Hybrid Lumbar Spine Model For the Fast Evaluation of Intradiscal Pressure and Mobility",
            "venue": "International Science Index, Medical and Health Science 9, 2 (Feb. 2015), 134\u2013145. https://doi.org/10.5281/zenodo. 1099356",
            "year": 2015
        },
        {
            "authors": [
                "Richard Drake",
                "A Wayne Vogl",
                "Adam WM Mitchell."
            ],
            "title": "Gray\u2019s anatomy for students E-book",
            "venue": "Elsevier Health Sciences.",
            "year": 2009
        },
        {
            "authors": [
                "Roy Featherstone."
            ],
            "title": "Rigid body dynamics algorithms",
            "venue": "Springer.",
            "year": 2014
        },
        {
            "authors": [
                "Ryutaro Fujii",
                "Hironobu Sakaura",
                "Yoshihiro Mukai",
                "Noboru Hosono",
                "Takahiro Ishii",
                "Motoki Iwasaki",
                "Hideki Yoshikawa",
                "Kazuomi Sugamoto."
            ],
            "title": "Kinematics of the lumbar spine in trunk rotation: in vivo three-dimensional analysis using magnetic resonance imaging",
            "venue": "European spine journal 16, 11 (2007), 1867\u20131874.",
            "year": 2007
        },
        {
            "authors": [
                "Theodore F Gast",
                "Craig Schroeder",
                "Alexey Stomakhin",
                "Chenfanfu Jiang",
                "Joseph M Teran."
            ],
            "title": "Optimization integrator for large time steps",
            "venue": "IEEE transactions on visualization and computer graphics 21, 10 (2015), 1103\u20131115.",
            "year": 2015
        },
        {
            "authors": [
                "F. Ghezelbash",
                "A.H. Eskandari",
                "A. Shirazi-Adl",
                "N. Arjmand",
                "Z. El-Ouaaid",
                "A. Plamondon."
            ],
            "title": "Effects of motion segment simulation and joint positioning on spinal loads in trunk musculoskeletal models",
            "venue": "Journal of Biomechanics 70 (2018), 149\u2013156. https://doi.org/10.1016/j.jbiomech.2017.07.014 2nd International Workshop on Spine Loading and Deformation.",
            "year": 2018
        },
        {
            "authors": [
                "Daniel Holden",
                "Taku Komura",
                "Jun Saito."
            ],
            "title": "Phase-functioned neural networks for character control",
            "venue": "ACM Transactions on Graphics (TOG) 36, 4 (2017), 1\u201313.",
            "year": 2017
        },
        {
            "authors": [
                "Q Youn Hong",
                "Sang Il Park",
                "Jessica K Hodgins."
            ],
            "title": "A Data-driven Segmentation for the Shoulder Complex",
            "venue": "Computer Graphics Forum, Vol. 29. Wiley Online Library, 537\u2013544.",
            "year": 2010
        },
        {
            "authors": [
                "Yixin Hu",
                "Qingnan Zhou",
                "Xifeng Gao",
                "Alec Jacobson",
                "Denis Zorin",
                "Daniele Panozzo."
            ],
            "title": "Tetrahedral meshing in the wild",
            "venue": "ACM Trans. Graph. 37, 4 (2018), 60\u20131.",
            "year": 2018
        },
        {
            "authors": [
                "Yifeng Jiang",
                "Tom Van Wouwe",
                "Friedl De Groote",
                "C Karen Liu."
            ],
            "title": "Synthesis of biologically realistic human motion using joint torque actuation",
            "venue": "ACM Transactions",
            "year": 2019
        },
        {
            "authors": [
                "IA Kapandji."
            ],
            "title": "The Physiology of the Joints",
            "venue": "vol III. Trunk and Vertebral Column, 1st ed. New York: Churchill Livingstone 10 (1974), 88\u201390.",
            "year": 1974
        },
        {
            "authors": [
                "Taku Komura",
                "Yoshihisa Shinagawa",
                "Tosiyasu L Kunii."
            ],
            "title": "Creating and retargetting motion by the musculoskeletal human body model",
            "venue": "The visual computer 16, 5 (2000), 254\u2013270.",
            "year": 2000
        },
        {
            "authors": [
                "Lucas Kovar",
                "Michael Gleicher",
                "Fr\u00e9d\u00e9ric Pighin."
            ],
            "title": "Motion graphs",
            "venue": "ACM SIGGRAPH 2008 classes. 1\u201310.",
            "year": 2008
        },
        {
            "authors": [
                "Binh Huy Le",
                "Zhigang Deng."
            ],
            "title": "Robust and accurate skeletal rigging from mesh sequences",
            "venue": "ACM Transactions on Graphics (TOG) 33, 4 (2014), 1\u201310.",
            "year": 2014
        },
        {
            "authors": [
                "Jeongseok Lee",
                "Michael X. Grey",
                "Sehoon Ha",
                "Tobias Kunz",
                "Sumit Jain",
                "Yuting Ye",
                "Siddhartha S. Srinivasa",
                "Mike Stilman",
                "C. Karen Liu."
            ],
            "title": "DART: Dynamic Animation and Robotics Toolkit",
            "venue": "The Journal of Open Source Software 3, 22 (2018), 500.",
            "year": 2018
        },
        {
            "authors": [
                "Seunghwan Lee",
                "Ri Yu",
                "Jungnam Park",
                "Mridul Aanjaneya",
                "Eftychios Sifakis",
                "Jehee Lee."
            ],
            "title": "Dexterous manipulation and control with volumetric muscles",
            "venue": "ACM Transactions on Graphics (TOG) 37, 4 (2018), 1\u201313.",
            "year": 2018
        },
        {
            "authors": [
                "Sung-Hee Lee",
                "Eftychios Sifakis",
                "Demetri Terzopoulos."
            ],
            "title": "Comprehensive Biomechanical Modeling and Simulation of the Upper Body",
            "venue": "ACM Trans. Graph. 28, 4, Article 99 (sep 2009), 17 pages. https://doi.org/10.1145/1559755.1559756",
            "year": 2009
        },
        {
            "authors": [
                "Sung-Hee Lee",
                "Demetri Terzopoulos."
            ],
            "title": "Heads up! Biomechanical Modeling and Neuromuscular Control of the Neck",
            "venue": "ACM Trans. Graph. 25, 3 (jul 2006), 1188\u20131198. https://doi.org/10.1145/1141911.1142013",
            "year": 2006
        },
        {
            "authors": [
                "Sung-Hee Lee",
                "Demetri Terzopoulos."
            ],
            "title": "Spline joints for multibody dynamics",
            "venue": "ACM SIGGRAPH 2008 papers. 1\u20138.",
            "year": 2008
        },
        {
            "authors": [
                "C Karen Liu",
                "Aaron Hertzmann",
                "Zoran Popovi\u0107."
            ],
            "title": "Learning physics-based motion style with nonlinear inverse optimization",
            "venue": "ACM Transactions on Graphics (TOG) 24, 3 (2005), 1071\u20131081.",
            "year": 2005
        },
        {
            "authors": [
                "David J Magee."
            ],
            "title": "Orthopedic Physical Assessment-E-Book",
            "venue": "Elsevier Health Sciences.",
            "year": 2013
        },
        {
            "authors": [
                "Sebastian Martin",
                "Bernhard Thomaszewski",
                "Eitan Grinspun",
                "Markus Gross."
            ],
            "title": "Example-Based Elastic Materials",
            "venue": "ACM Transactions on Graphics 30, 4 (2011), 72.",
            "year": 2011
        },
        {
            "authors": [
                "Walter Maurel",
                "Daniel Thalmann."
            ],
            "title": "Human shoulder modeling including scapulo-thoracic constraint and joint sinus cones",
            "venue": "Computers & Graphics 24, 2 (2000), 203\u2013218.",
            "year": 2000
        },
        {
            "authors": [
                "Aleka McAdams",
                "Yongning Zhu",
                "Andrew Selle",
                "Mark Empey",
                "Rasmus Tamstorf",
                "Joseph Teran",
                "Eftychios Sifakis."
            ],
            "title": "Efficient elasticity for character skinning with contact and collisions",
            "venue": "ACM SIGGRAPH 2011 papers. 1\u201312.",
            "year": 2011
        },
        {
            "authors": [
                "Philip W McClure",
                "Lori A Michener",
                "Brian J Sennett",
                "Andrew R Karduna."
            ],
            "title": "Direct 3-dimensional measurement of scapular kinematics during dynamic movements in vivo",
            "venue": "Journal of shoulder and elbow surgery 10, 3 (2001), 269\u2013277.",
            "year": 2001
        },
        {
            "authors": [
                "Gary Monheit",
                "Norman I Badler."
            ],
            "title": "A kinematic model of the human spine and torso",
            "venue": "(1990).",
            "year": 1990
        },
        {
            "authors": [
                "Masaki Nakada",
                "Tao Zhou",
                "Honglin Chen",
                "Tomer Weiss",
                "Demetri Terzopoulos."
            ],
            "title": "Deep learning of biomimetic sensorimotor control for biomechanical human animation",
            "venue": "ACM Transactions on Graphics (TOG) 37, 4 (2018), 1\u201315.",
            "year": 2018
        },
        {
            "authors": [
                "Manohar M. Panjabi",
                "Richard A. Brand",
                "Augustus A. White."
            ],
            "title": "Threedimensional flexibility and stiffness properties of the human thoracic spine",
            "venue": "Journal of Biomechanics 9, 4 (1976), 185\u2013192. https://doi.org/10.1016/0021-9290(76)90003-8",
            "year": 1976
        },
        {
            "authors": [
                "Xue Bin Peng",
                "Pieter Abbeel",
                "Sergey Levine",
                "andMichiel Van de Panne"
            ],
            "title": "Deepmimic: Example-guided deep reinforcement learning of physics-based character skills",
            "venue": "ACM Transactions On Graphics (TOG) 37,",
            "year": 2018
        },
        {
            "authors": [
                "Charles A Rockwood."
            ],
            "title": "The shoulder",
            "venue": "Vol. 1. Elsevier Health Sciences.",
            "year": 2009
        },
        {
            "authors": [
                "Prashant Sachdeva",
                "Shinjiro Sueda",
                "Susanne Bradley",
                "Mikhail Fain",
                "Dinesh K Pai."
            ],
            "title": "Biomechanical simulation and control of hands and tendinous systems",
            "venue": "ACM Transactions on Graphics (TOG) 34, 4 (2015), 1\u201310.",
            "year": 2015
        },
        {
            "authors": [
                "Andrew Selle",
                "Michael Lentine",
                "Ronald Fedkiw."
            ],
            "title": "A mass spring model for hair simulation",
            "venue": "ACM SIGGRAPH 2008 papers. 1\u201311.",
            "year": 2008
        },
        {
            "authors": [
                "Marco Senteler",
                "Bernhard Weisse",
                "Dominique A. Rothenfluh",
                "Jess G. Snedeker."
            ],
            "title": "Intervertebral reaction force prediction using an enhanced assembly of OpenSim models",
            "venue": "Computer Methods in Biomechanics and Biomedical Engineering 19, 5 (2016), 538\u2013548. https://doi.org/10.1080/10255842.2015.1043906",
            "year": 2016
        },
        {
            "authors": [
                "Ajay Seth",
                "Meilin Dong",
                "Ricardo Matias",
                "Scott Delp."
            ],
            "title": "Muscle contributions to upper-extremity movement and work from a musculoskeletal model of the human shoulder",
            "venue": "Frontiers in neurorobotics 13 (2019), 90.",
            "year": 2019
        },
        {
            "authors": [
                "Ajay Seth",
                "Ricardo Matias",
                "Ant\u00f3nio P Veloso",
                "Scott L Delp."
            ],
            "title": "A biomechanical model of the scapulothoracic joint to accurately capture scapular kinematics during shoulder movements",
            "venue": "PloS one 11, 1 (2016), e0141028.",
            "year": 2016
        },
        {
            "authors": [
                "Eftychios Sifakis",
                "Igor Neverov",
                "Ronald Fedkiw."
            ],
            "title": "Automatic determination of facial muscle activations from sparse motion capture marker data",
            "venue": "ACM SIGGRAPH 2005 Papers. 417\u2013425.",
            "year": 2005
        },
        {
            "authors": [
                "Jack M Wang",
                "Samuel R Hamner",
                "Scott L Delp",
                "Vladlen Koltun."
            ],
            "title": "Optimizing locomotion controllers using biologically-based actuators and objectives",
            "venue": "ACM Transactions on Graphics (TOG) 31, 4 (2012), 1\u201311.",
            "year": 2012
        },
        {
            "authors": [
                "Wei Wang",
                "Dongmei Wang",
                "Friedl De Groote",
                "Lennart Scheys",
                "Ilse Jonkers."
            ],
            "title": "Implementation of physiological functional spinal units in a rigid-body model of the thoracolumbar spine",
            "venue": "Journal of Biomechanics 98 (2020), 109437. ACM Trans. Graph., Vol. 42, No. 4, Article 0. Publication date: August 2023.",
            "year": 2020
        },
        {
            "authors": [
                "Hans-Joachim Wilke",
                "Peter Neef",
                "Marco Caimi",
                "Thomas Hoogland",
                "Lutz E Claes."
            ],
            "title": "New in vivo measurements of pressures in the intervertebral disc in daily life",
            "venue": "Spine 24, 8 (1999), 755\u2013762.",
            "year": 1999
        },
        {
            "authors": [
                "Grady Williams",
                "Andrew Aldrich",
                "Evangelos A Theodorou."
            ],
            "title": "Model predictive path integral control: From theory to parallel computation",
            "venue": "Journal of Guidance, Control, and Dynamics 40, 2 (2017), 344\u2013357.",
            "year": 2017
        },
        {
            "authors": [
                "Gregory M Williams",
                "Elaine F Chan",
                "Michele M Temple-Wong",
                "Won C Bae",
                "Koichi Masuda",
                "William D Bugbee",
                "Robert L Sah."
            ],
            "title": "Shape, loading, and motion in the bioengineering design, fabrication, and testing of personalized synovial joints",
            "venue": "Journal of biomechanics 43, 1 (2010), 156\u2013165.",
            "year": 2010
        },
        {
            "authors": [
                "AndrewWitkin andMichael Kass."
            ],
            "title": "Spacetime constraints",
            "venue": "ACM Siggraph Computer Graphics 22, 4 (1988), 159\u2013168.",
            "year": 1988
        },
        {
            "authors": [
                "Zhan Xu",
                "Yang Zhou",
                "Evangelos Kalogerakis",
                "Chris Landreth",
                "Karan Singh."
            ],
            "title": "Rignet: Neural rigging for articulated characters",
            "venue": "arXiv preprint arXiv:2005.00559 (2020).",
            "year": 2020
        },
        {
            "authors": [
                "KangKang Yin",
                "Kevin Loken",
                "Michiel Van de Panne."
            ],
            "title": "Simbicon: Simple biped locomotion control",
            "venue": "ACM Transactions on Graphics (TOG) 26, 3 (2007), 105\u2013es.",
            "year": 2007
        },
        {
            "authors": [
                "Felix E Zajac."
            ],
            "title": "Muscle and tendon: properties, models, scaling, and application to biomechanics and motor control",
            "venue": "Critical reviews in biomedical engineering 17, 4 (1989), 359\u2013411.",
            "year": 1989
        }
    ],
    "sections": [
        {
            "text": "Anatomically Detailed Simulation of Human Torso\nSEUNGHWAN LEE, Stanford University, USA YIFENG JIANG, Stanford University, USA"
        },
        {
            "heading": "C. KAREN LIU, Stanford University, USA",
            "text": "Fig. 1. (Left) Our method recovers underlying spine and shoulder bone movements unobservable by standard motion capture systems. (Right) Our torso model includes veterbrae bones, ligaments, facet joints and discs, scapula, clavicles, and a rib cage to generate physically and physiologically plausible movements.\nMany existing digital human models approximate the human skeletal system using rigid bodies connected by rotational joints. While the simplification is considered acceptable for legs and arms, it significantly lacks fidelity to model rich torso movements in common activities such as dancing, Yoga, and various sports. Research from biomechanics provides more detailed modeling for parts of the torso, but their models often operate in isolation and are not fast and robust enough to support computationally heavy applications and large-scale data generation for full-body digital humans. This paper proposes a new torso model that aims to achieve high fidelity both in perception and in functionality, while being computationally feasible for simulation and optimal control tasks. We build a detailed human torso model consisting of various anatomical components, including facets, ligaments, and intervertebral discs, by coupling efficient finite-element and rigid-body simulations. Given an existing motion capture sequence without dense markers placed on the torso, our new model is able to recover the underlying torso bone movements. Our method is remarkably robust that it\nAuthors\u2019 addresses: Seunghwan Lee, Stanford University, 450 Serra Mall, Stanford, CA, 94305, USA, lsw9021@gmail.com; Yifeng Jiang, Stanford University, 450 Serra Mall, Stanford, CA, 94305, USA, yifengj@stanford.edu; C. Karen Liu, Stanford University, 450 Serra Mall, Stanford, CA, 94305, USA, karenliu@cs.stanford.edu.\nPermission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for components of this work owned by others than the author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee. Request permissions from permissions@acm.org. \u00a9 2023 Copyright held by the owner/author(s). Publication rights licensed to ACM. 0730-0301/2023/8-ART0 $15.00 https://doi.org/10.1145/3592425\ncan be used to automatically \u201cretrofit\u201d the entire Mixamo motion database of highly diverse human motions without user intervention. We also show that our model is computationally efficient for solving trajectory optimization of highly dynamic full-body movements, without relying any reference motion. Physiological validity of the model is validated against established literature.\nCCS Concepts: \u2022 Computing methodologies \u2192 Animation; Physical simulation.\nAdditional Key Words and Phrases: Biomechanics, Human anatomy, Finite elements, Spine modeling, Trajectory optimization\nACM Reference Format: Seunghwan Lee, Yifeng Jiang, and C. Karen Liu. 2023. Anatomically Detailed Simulation of Human Torso. ACM Trans. Graph. 42, 4, Article 0 (August 2023), 11 pages. https://doi.org/10.1145/3592425"
        },
        {
            "heading": "1 INTRODUCTION",
            "text": "Realistic modeling and simulation of human body movements have a wide range of applications from entertainments to robotics to medicine. Conventionally, human models used in computer graphics focus on visual realism while those used in biomechanics focus on anatomical realism. With recent advances in modeling, simulation and generative models, digital humans that achieve both high fidelity in perception and in functionality, while still robust and computationally efficient, are closer to the horizon. Human skeletal system is typically approximated as articulated rigid bodies, with hinge or ball-and-socket joints connecting the body segments. While the simplification can be acceptable for legs\nACM Trans. Graph., Vol. 42, No. 4, Article 0. Publication date: August 2023.\nar X\niv :2\n30 5.\n04 99\n5v 1\n[ cs\n.G R\n] 8\nM ay\n2 02\n3\nand arms, the human torso is significantly more complex. For example, the vertebrae bones can rotate to provide spine flexibility and can also translate to absorb compressive impact along the spinal column. Similarly, the shoulder complex manifests complicated range of motion (RoM) governed by multiple non-linear inter-bone constraints. For visualizing and synthesizing upper-body-rich human activities, such as gymnastics, dancing, and baseball pitching, using only rotational joints to model the human torso often leads to laborious and ad-hoc tuning in order to achieve visual plausibility.\nThis paper takes a step toward building a biomechanically realistic torso model that goes beyond the chain-of-rigid-bodies structure. Instead of connected by joints, the vertebral bones of our spine model are connected and regulated by discs, ligaments and facets, wherewe simulate the elastic discswith finite-elementmethod based on Projective Dynamics [Bouaziz et al. 2014], two-way coupled with the bones, and simulate the ligaments and facets as non-linear inequality constraints in an LCP (Linear Complementary Problem) framework. Similarly, the movements of shoulder complex are also subject to their own non-linear constraints. The interplay of all elements collectively determines the RoM of the skeleton, as well as its dynamic characteristics. Themodel parameters are systematically adjusted such that the simulated torso can match the real human\u2019s RoM.\nOur torso skeleton is kinematically and dynamically accurate and easily swappable with the simplified torso of existing humanmodels. We show that existing motion capture (moCap) data can be \"retrofit\" to obtain realistic and detailed torso and shoulder bone movements that match the movements of limbs in the moCap data. Because this problem is inherently under determined, the dynamic constraints imposed by our model are necessary for solving physically and anatomically plausible torso motions. As such, our method can serve as a principled tool to enrich motion capture data by adding unobserved skeletal movements. We also show that our model is computationally fast enough for optimal control with physics simulation. We optimize a sequence of control force from the torso to produce plausible motions, without using any reference data. In comparison to simplified torso, our model can generate more momentum without anatomically implausible artifacts, achieving more human-like movements.\nWe evaluate our model by reaffirming findings from biomechanics literature, demonstrating the biological validity of our model and its potentials to be used for biomedical analysis. The detailed analysis shows that the RoM of our spine model is similar to those reported in biomechanics literature. We also found that an emergent behavior of our torso model consistent with the well-known Scapulohumeral rhythm, a key signature movement of human shoulder complex."
        },
        {
            "heading": "2 RELATED WORK",
            "text": "Existing human models for character animation often depend on arbitrary parameterization and manual rigging. Artists usually design human models to have sufficient degrees of freedom (Dofs) for reconstructing captured human motions [Holden et al. 2017; Kovar et al. 2008], but anatomically realistic range of motion and physical properties are rarely top priories. Automatic rigging methods have been proposed to accelerate the manual process by learning\nrig parameters from a collection of motion data [Hong et al. 2010; Le and Deng 2014; Xu et al. 2020]. Our model can also be used as an animation rig, but we differ from existing methods in that we utilize biomechanics knowledge and physics simulation to synthesize additional details of the motion that cannot be observed by the moCap device, rather than simply fitting to the observed signals using arbitrarily parameterized rig. Physics-based modeling of human body parts has been broadly investigated in computer graphics, such as fingers [Sachdeva et al. 2015], face [Sifakis et al. 2005], hair [Selle et al. 2008], muscles [Angles et al. 2019], eyes [Nakada et al. 2018], jaws [Daumas et al. 2005], skin [McAdams et al. 2011], and feet [Camacho et al. 2002]. For full human skeletons, however, most existing methods adopt the structure of a rigid-body tree connected by standard hinge or ball-andsocket joints, despite that rotation joints are known to be error-prone for modeling certain human parts, such as the shoulder complex [Maurel and Thalmann 2000]. The most closely related work is by Lee and Terzopoulos [2006], who built a neck model connected with vertebrae bones using ball-and-socket joints. In their work, pivot points of each joint are carefully selected following biomechanics literature [Kapandji 1974]. Lee and Terzopoulos [2008] also introduce spline joints to model complex biomechnical joints such as the scapulothoracic joints and the knee. Rotational spring-dampers are designed to mimic the effect of intervertebrae discs. The same chainof-rigid-bodies framework is later extended to a full upper-body model in [Lee et al. 2009], combined with finite-element-based muscle and soft tissue modeling. Our model does not consider muscles. We focus on detailed and realistic modeling of skeletal connections between vertebrae bones, the rib cage, and the shoulder complex, allowing more anatomically correct range of motion. While our work focuses on the modeling of human, control is also an inseparable component in physics-based animation [Peng et al. 2018; Witkin and Kass 1988; Yin et al. 2007]. Multiple previous studies have revealed that better modeling can lead to more effective control. For instance, more humanlike behaviors were observed when simulated muscles [Komura et al. 2000; Wang et al. 2012], learned actuators [Jiang et al. 2019], or passive dynamics of joints [Liu et al. 2005] were used. Our work also shows that a detailed spine model enables natural torso motion to emerge with little tweaking on the optimization cost function. A rich body of work in biomechanics and medicine has been focusing on modeling human spines. Gray and Norman [1990] propose a kinematic model of the human spine with all vertebral joint movements having three axes of rotations. Panjabi and colleagues [1976] modeled the discs as bushing elements between vertebrae bones, parameterized as 6 by 6 stiffness matrices. Such bushing elements have been extended to have non-linear stiffness to better reflect the complex dynamics of intervertebrae discs, with parameters identified from in-vitro experiments [Wang et al. 2020]. Dicko and colleagues [2015] modelled discs using finite-element and ligaments as non-linear springs. However, their model was only used for static spine pose analysis, possibly due to less stable dynamics caused by springs. In general, robustness and computational efficiency are the main reasons why most existing spine models were rarely used beyond static pose equilibrium analysis [Ghezelbash et al. 2018; Wang et al. 2020]. Our model adopts a hybrid FEM\nACM Trans. Graph., Vol. 42, No. 4, Article 0. Publication date: August 2023.\nplus rigid approach, utilizing an efficient finite-element simulation framework, coupled with efficient rigid-body simulation with robust impulse-based constraint handling through LCP solvers, enabling stable simulation of full-body motion even with large foot-ground impact. Human shoulder complex has also been studied extensively in biomechanics, Seth and colleagues [2016] showed that analytic modeling of the scapulothoracic joint improved the accuracy of shoulder movement reconstruction. They used measured statistics of the scapulothoracic joint movements gathered from in-vivo experiments [McClure et al. 2001]. More realistic skeleton modeling facilitated the construction of shoulder muscle models in their later study [Seth et al. 2019]. Biomechanics researchers have also combined spine and shoulder models in biomechanics simulators, e.g. OpenSim [Delp et al. 2007], to study various activities. For example, [Bruno et al. 2015; Senteler et al. 2016] studied spine load and reaction forces during primitive motions such as bending and lifting with weight, and [Cazzola et al. 2017] studied shoulder injury of rugby players."
        },
        {
            "heading": "3 TORSO MODELING",
            "text": "We present a physics-based model for human torso that simulates detailed human anatomy. Our torso model consists of bones, joints, discs, ligaments, and facets. We include 23 vertebrae bones (from sacrum to C3) assembling a spinal column, a rib cage, and a clavicle and a scapula on each side of shoulder complex (See Figure 2). 20 ligaments and 44 facets are attached to the spine, and 23 vertebrae discs are sandwiched between adjacent vertebrae bones. There are 28 additional costovertebral and costotransverse facets joints that connect the rib cage to the thoracic bones. The collaboration of the\nligaments, the discs and the joints defines the passive dynamics of our model as well as kinematic characteristics such as the range of motion. Muscles are not included in our current model. All the bones are modeled as rigid bodies with detailed geometries used by anatomical modeling [Zygote [n. d.]]. The rib cage is assumed to be a single rigid body as the movements of the ribs are mostly associated with breathing. We use ball-and-socket joints to connect the rib cage and the clavicle, and the clavicle and the scapula. Between the vertebrae bones and between the rib cage and the thoracic vertebrae, we connect them with placeholder 6-DoF free joints, and the relative movements are instead constrained by finite-element simulation of the discs and non-linear constraints rising from ligaments and facets. The use of 6-DoF joints allows us to still treat the torso as an articulated rigid-body tree with \ud835\udc92 being the state of the rigid-body in generalized coordinates, facilitating incorporating existing frameworks for physics simulation. Two-way weak coupling between the finite-element discs and the rigid-body skeleton is discussed in Section 3.1 and 3.5."
        },
        {
            "heading": "3.1 Intervertebral Disc",
            "text": "Intervertebral discs are deformable materials attached in-between adjacent vertebrae bones (See Figure 3). The elasticity of the discs prevents the bones from colliding and rubbing against each other, and absorbs and dissipates large compressive impacts on the spinal column. Such a deformable body is often simulated using Finite Element Method (FEM) which discretizes a body into a finite number of elements such as tetrahedrons. The states of the disc at time \ud835\udc61 can be represented by its nodal positions \ud835\udc99\ud835\udc61 \u2208 R3\ud835\udc58 , where \ud835\udc58 is the number of discretized vertices. Following previous work, we adopt the standard implicit Euler integration in its variational form [Gast et al. 2015; Martin et al. 2011], where at each time step \ud835\udc61 , we solve an non-linear optimization problem for the current state \ud835\udc99\ud835\udc61 :\n\ud835\udc99\ud835\udc61 = argmin 1\n2\u210e2 \ud835\udc74 12 (\ud835\udc99\ud835\udc61 \u2212 \ud835\udc99\ud835\udc61\u22121 \u2212 \u210e\ud835\udc97\ud835\udc61\u22121) 2 \ud835\udc39 + \u2211\ufe01 \ud835\udc56 \ud835\udc58\ud835\udc56\ud835\udc38\ud835\udc56 (\ud835\udc99\ud835\udc61 ). (1)\nHere \ud835\udc74 is the mass matrix and \u210e is timestep size. \ud835\udc97\ud835\udc61 is obtained through backward finite differencing of \ud835\udc99\ud835\udc61 . By minimizing Equation 1, we essentially solve for \ud835\udc99\ud835\udc61 that balances the change of momentum and the forces expressed as the gradients of the potential energies \ud835\udc38\ud835\udc56 ,\nACM Trans. Graph., Vol. 42, No. 4, Article 0. Publication date: August 2023.\nwith scalar weights \ud835\udc58\ud835\udc56 . For our case, \ud835\udc38\ud835\udc56 include isotropic elasticity [Chao et al. 2010] and volume preservation [Bouaziz et al. 2014] of the disc. The minimization problem can be solved by modified Newton\u2019s Method, but it is usually computationally expensive. This is because Hessian \u22072\ud835\udc38\ud835\udc56 (\ud835\udc99) obtained through linearization changes at each time step, preventing us from utilizing matrix factorization to accelerate. Facing this issue, Projective Dynamics [Bouaziz et al. 2014] showed that certain types of energy functions can be solved much more efficiently in an alternating \"local-global\" manner. Following their framework, we define each \ud835\udc38\ud835\udc56 as a minimization process:\n\ud835\udc38\ud835\udc56 (\ud835\udc99) = min \ud835\udc8e\ud835\udc56 \u2208C\ud835\udc56\n1 2 | |\ud835\udc68\ud835\udc56\ud835\udc99 \u2212\ud835\udc8e\ud835\udc56 | |2, (2)\nwhere the constraint manifold C\ud835\udc56 and coefficient matrix \ud835\udc68\ud835\udc56 depend on the specific energy term. Equation 2 solves for\ud835\udc8e\ud835\udc56 , the projection of \ud835\udc68\ud835\udc56\ud835\udc99 onto C\ud835\udc56 . The projection error is then defined as the energy \ud835\udc38\ud835\udc56 . Since each \ud835\udc38\ud835\udc56 is independently computed without considering other \ud835\udc38\ud835\udc56 \u2019s, we call this step a \u201clocal\u201d solve. A large class of FEM energies can be written into this projection form. For instance, we can cast the isotropic elasticity term as the distance from the current deformation gradient to its closest projection on the SO(3) manifold (isometry rotation with zero deformation), such that a rigid rotation of the rest-pose tetrahedron will lead to zero elastic energy.\nOnce all \ud835\udc8e\ud835\udc56 \u2019s are obtained through local solves, we proceed with the standard Newton steps (\u201cglobal solve\u201d). We plug in the solved \ud835\udc8e\ud835\udc56 in Equation 2 and express \ud835\udc38\ud835\udc56 as a quadratic function in \ud835\udc99 , where the constant\ud835\udc68\ud835\udc56 enables acceleration using Cholesky decomposition. In practice, since the discs are tightly attached to the bones with negligible inertial effects comparing to the bones, we adopt a quasistatic simplification, effectively forgoing the momentum term (\u210e \u2192 \u221e) to improve simulation stability, similar to previous works [Lee et al. 2018b]. As such, Equation 1 simplifies to: \ud835\udc73\ud835\udc99\ud835\udc61 = \ud835\udc85, where \ud835\udc73 = \u2211 \ud835\udc56 \ud835\udc58\ud835\udc56\ud835\udc68 T \ud835\udc56 \ud835\udc68\ud835\udc56 and \ud835\udc85 = \u2211 \ud835\udc56 \ud835\udc68 T \ud835\udc56 \ud835\udc8e\ud835\udc56 .\nAn additional energy term \ud835\udc38pos is needed to couple the vertebrae bones and the discs. We compute a set of attached points between the bone surface and the disc surface at the rest pose and enforce the attachment via minimizing \ud835\udc38pos = \u2225\ud835\udc99B \u2212 \ud835\udc77 (\ud835\udc92)\u22252, where \ud835\udc77 (\ud835\udc92) evaluates attach points on the bone surface in the world frame given the current state \ud835\udc92, and \ud835\udc99B are the boundary disc vertices in the world frame. Note that we use the bone configuration \ud835\udc92 from the previous time step, resulting in a weak coupling between the bones and the discs. \ud835\udc87pos := \u2212\u2207\ud835\udc38pos is therefore the coupling force between finite-elements and rigid bodies (See Figure 3)."
        },
        {
            "heading": "3.2 Ligament",
            "text": "A ligament is a spring-like fibrous connective tissue attached between bones. It regulates the relative movements among the bones, keeping them stable. The anatomical functionality of each ligament varies by attachment sites (termed origin and insertion). For example, the intertransverse ligament is routed on the transverse process of the vertebrae bone, and it mainly limits the opposite-side lateral flexion of the spine (See Figure 4). We use piece-wise linear approximations to represent the ligament and its geometry. Starting from the origin of a ligament, we divide the ligament into multiple line\nsegments, where each segment is expressed by \ud835\udc91+ and \ud835\udc91\u2212 defined in the local coordinate of the associated bones respectively. Each ligament is represented by a unilateral spring; it generates contractile forces when the ligament is extended and zero force when relaxed, a characteristic described by the Hill\u2019s muscle model [Zajac 1989]. According to the model, the force-length curve of ligaments has two phases: tendon elongations below the thresholds create negligible forces, while tendon elongations above a threshold create exponentially growing forces. In practice, it is desirable to avoid a large amount of contractile forces as it decreases simulation stability. Hence we add inequality constraints (to be solved by a stable LCP time-stepping scheme) in our simulation where they preemptively bound the length of the ligament within a moderate range: \ud835\udc36ligament (\ud835\udc92) = \u2225\ud835\udc91+ (\ud835\udc92) \u2212 \ud835\udc91\u2212 (\ud835\udc92)\u22252 \u2264 \ud835\udc59max, (3) where \ud835\udc59max is the maximum length that varies by each ligament (see Section 3.6). Comparing with the Hill\u2019s model, this modification to inequality constraints (zero force below threshold and infinite-asneeded beyond threshold) doesn\u2019t change the biomechanical property much. Note that one ligament will create multiple\ud835\udc36ligament (\ud835\udc92) constraints with different \ud835\udc59max for each segment. Section 3.6 will describe how the ligament parameters are identified systematically."
        },
        {
            "heading": "3.3 Facet",
            "text": "The facets are located on the posterior side of the vertebrae bones, as well as between the rib cage and thoracic vertebrae bones. They are synovial joints consisting of two cartilages facing each other, wrapped up by the joint capsules. One cartilage (A) slides on the surface of the other cartilage (B) with near-frictionless movement due to highly smooth surface and the existence of fluids (See Figure 4). Facet forms a closed-chain kinematics with the disc which increases the stability and robustness of the spinal column against excessive external perturbations. The surface geometry of the cartilage B determines the movements of the facet [Drake et al. 2009; Williams et al. 2010]. As the cartilage is flat and oval-shaped, we represent the surface geometry of cartilage B as a flat ellipsoid:\n\ud835\udc36facet (\ud835\udc91) = | |\ud835\udc7a\u22121\ud835\udc79T (\ud835\udc91 \u2212 \ud835\udc91center) | |2 \u2212 1, (4)\nACM Trans. Graph., Vol. 42, No. 4, Article 0. Publication date: August 2023.\nwhere \ud835\udc7a \u2208 R3\u00d73 is the diagonal matrix representing each axis scale, \ud835\udc79 \u2208 SO(3) is the rotation matrix where each column denotes the axis of the ellipsoid, and \ud835\udc91center is the center of the ellipsoid. Here, the level-set \ud835\udc36facet (\ud835\udc91) = 0 represents the surface where we would like points on cartilage A to stay on. In other words, we need to select three non-colinear points on A that are also on\ud835\udc36facet (\ud835\udc91) = 0 at the rest configuration, and the constraint solver will then keep these three \"wheels\" on B\u2019s ellipsoid surface during the entire simulation. In practice, we select four points instead of three to ensure numerical robustness, and relax \ud835\udc36facet (\ud835\udc91) = 0 to |\ud835\udc36facet (\ud835\udc91) | \u2264 0.2."
        },
        {
            "heading": "3.4 Shoulder",
            "text": "We also utilize the ellipsoid constraint used for facets to simulate the shoulder movements (See Figure 5). The clavicles and the scapula together determine the location and the orientation of the shoulder. The joint of the clavicle is on the sternum (sternoclavicle joint) and can be modeled by a rotational joint. The movement of the scapula is much more complex and determined by both the acromioclavicle joint and the scapulothoracic joint. The scapulothoracic joint represents the sliding of the scapula on the posterior of the rib cage. It has been revealed in many studies (e.g. [Seth et al. 2016]) that the rib cage can be approximated by an ellipsoid on which the scapula slide on. This movement is identical to the movement of the facet joint so we add constraints between the rib cage and the scapula to mimic the scapulothoracic joint anatomy. Unlike facets joint, however, the ellipsoid constraints for the scapula will create a close-chain kinematics."
        },
        {
            "heading": "3.5 Torso Dynamics",
            "text": "With finite-element simulation presented in Section 3.1, the equations of motions of our rigid skeleton model can be described by the Lagrangian dynamics, where we solve for \u00a5\ud835\udc92 to drive the simulation\nforward:\n\ud835\udc74 (\ud835\udc92) \u00a5\ud835\udc92 + \ud835\udc84 (\ud835\udc92, \u00a4\ud835\udc92) = \ud835\udf49disc (\ud835\udc99B , \ud835\udc77 (\ud835\udc92)) + \ud835\udf49ext subject to (5) \ud835\udc6aligament (\ud835\udc92) \u2264 \ud835\udc8dmax (6) |\ud835\udc6afacet (\ud835\udc91(\ud835\udc92)) | \u2264 0.2, (7)\nwhere \ud835\udc92 is the generalized positions,\ud835\udc74 (\ud835\udc92) is themassmatrix, \ud835\udc84 (\ud835\udc92, \u00a4\ud835\udc92) is the coriolis and gravitational forces,\ud835\udf49ext is the external forces, and \ud835\udf49disc (\ud835\udc99B , \ud835\udc77 (\ud835\udc92)) = \u2212\ud835\udc71T\ud835\udc87pos is the sum of forces generated by the disc attached to the bones via positional constraints \ud835\udc38pos (\ud835\udc99B , \ud835\udc77 (\ud835\udc92)). \ud835\udc71 is the Jacobian matrix that maps the generalized coordinate to the attachment (bone surface) points. Equation 6 and 7 are the ligament constraints and facet joint constraints, respectively.\nAlgorithm 1 shows the process of forward dynamics of our model for each time step \ud835\udc61 , where we sequentially solve the FEM simulation and the articulated rigid body simulation. For FEM, we iterate between solving the local projection for each constraint (Equation 2) and linear solves for the Newton steps. Featherstone\u2019s algorithm [Featherstone 2014] is used to solve Equation 5 while the constraints 6 and 7 are solved via impulse-space simulation which yields a Linear Complementary Proplem (LCP) [Anitescu and Potra 1997]. We use Danzig\u2019s LCP solver [Cottle et al. 2009] to compute the lagrangian multipliers of the constraints which are eventually used to modify the generalized velocities \u00a4\ud835\udc92\ud835\udc61+1 such that they will not violate the constraints. Finally, the solved \ud835\udc92\ud835\udc61+1 will be used for the FEM simulation at next time step.\nALGORITHM 1: Torso Forward Dynamics Input: Disc Positions \ud835\udc99\ud835\udc61 , Joint Positions, Joint Velocities \ud835\udc92\ud835\udc61 , \u00a4\ud835\udc92\ud835\udc61 , Bone Surface Locations \ud835\udc77 (\ud835\udc92\ud835\udc61 ) \ud835\udc73 = \u2211 \ud835\udc56 \ud835\udc58\ud835\udc56\ud835\udc68 T \ud835\udc56 \ud835\udc68\ud835\udc56\nfor \ud835\udc59 = 0, 1, \u00b7 \u00b7 \u00b7 , numFEMIterations do \ud835\udc85 = 0 for \ud835\udc56 = 0, 1, \u00b7 \u00b7 \u00b7 , numFEMEnergies do\n\ud835\udc8e\ud835\udc56 = project(\ud835\udc68\ud835\udc56\ud835\udc99\ud835\udc61 , C\ud835\udc56 ) \ud835\udc85 = \ud835\udc85 +\ud835\udc68T\n\ud835\udc56 \ud835\udc8e\ud835\udc56\nend \ud835\udc99\ud835\udc61 = \ud835\udc73\u22121\ud835\udc85\nend \ud835\udf0fdisc = \u2212\ud835\udc71T\ud835\udc87pos (\ud835\udc99\ud835\udc61B , \ud835\udc77 (\ud835\udc92\ud835\udc61 )) \u00a5\ud835\udc92\ud835\udc61+1 = ForwardDynamics(\ud835\udf0fext, \ud835\udf0fdisc, \ud835\udc92\ud835\udc61 , \u00a4\ud835\udc92\ud835\udc61 ) \u00a4\ud835\udc92\ud835\udc61+1 = integrateVelocities( \u00a5\ud835\udc92\ud835\udc61+1, \u00a4\ud835\udc92\ud835\udc61 ) \u00a4\ud835\udc92\ud835\udc61+1 = ResolveConstraintsByLCP( \u00a4\ud835\udc92\ud835\udc61+1,\ud835\udc6aligament (\ud835\udc92\ud835\udc61 ),\ud835\udc6afacet (\ud835\udc92\ud835\udc61 )) \ud835\udc92\ud835\udc61+1 = integratePositions( \u00a4\ud835\udc92\ud835\udc61+1, \ud835\udc92\ud835\udc61 ) \ud835\udc99\ud835\udc61+1 = \ud835\udc99\ud835\udc61"
        },
        {
            "heading": "3.6 Parameters Identification",
            "text": "Ligaments. The maximum lengths \ud835\udc59max of the the ligaments are determined from biomechanics data of spine range of motion. For each adjacent pairs of vertebrae bones, existing literature [\u0160avlovskis and Raits [n. d.]] measured a few extreme relative orientations (shown as cross symbols in Figure 6) that an average subject is able to achieve. As shown in Figure 6, we gradually shorten \ud835\udc59max until it is no longer enough to realize all documented extreme poses. At each shortening step, this check is done by running the simulation for the bone pair with random actions. After all ligaments\nACM Trans. Graph., Vol. 42, No. 4, Article 0. Publication date: August 2023.\nare \"tightened\", we will obtain a non-linear range of motion (the yellow and red lines) that is strictly more flexible than the simplex (green lines) of measured extreme poses. In practice, some of the ligaments only affects one degree of freedom, and we shorten these independent ligaments first. Though different orders of shortening can lead to slightly different non-linear shapes of the RoM, they are equally valid in the sense of matching all available measurement data.\nFacets. The location \ud835\udc91center, orientation \ud835\udc79 and dimension \ud835\udc7a of each facet ellipsoid are determined by annotating the bone geometries. For each pair of the adjacent bones, we visually inspect and manually annotate the positions of superior articular process and inferior articular process with knowledge of anatomy. We determine the parameters such that the ellipsoid contains all the vertices on the superior articular process. We randomly select four non-colinear points \ud835\udc91 among the vertices on the inferior articular process. Note that these four points are irrelevant to the shape of the facet ellipsoid and thus do not affect RoM; they are only used to enable adjacent bones to slide with each other. Therefore, randomly choosing four non-colinear points is sufficient to guarantee sliding.\nDiscs. FEM parameters such as the Young\u2019s modulus are tuned manually for stable and visually plausible results. We leavematching disc properties to the non-linear stiffness observed in measurement data [Wang et al. 2020] to future work."
        },
        {
            "heading": "4 EXPERIMENTAL RESULTS",
            "text": "We evaluate our model based on three aspects. Realism: Can our model generate detailed torso motions that are visually realistic and consistent with the realistic human range of motion? Robustness: Can we use our model as an automatic tool to robustly process large-scalemotion datasets? Efficiency: Is ourmodel computationally efficient enough for physics simulation and optimal control applications? We describe a few experiments to validate these aspects below and provide a supplemental video for further evaluation."
        },
        {
            "heading": "4.1 Experiment setup",
            "text": "Our model includes 24 place-holder free joints and 17 ball-andsocket joints, totaling 195 DoFs. We model an adult human with a\nheight of 170cm and a mass of 72kg. The mass of a bone is computed by the bone density and the bounding box of the mesh while the mass of some bones with concave shapes such as ribs, scapula, and clavicle, is manually assigned. We apply joint limits to the sternoclavicular joint, the acromioclavicular joint, and the glenohumeral joint [Magee 2013] while the other joints have no limits. We also use passive spring-damper for all joints which increase simulation stability as well as the robustness of retrofitting. We use a PD controller for each DoF of our torso model. Our model consists of 20 ligaments and 74 facets, including 44 facet joints, 28 costovertebral and costotransverse joints, and 2 scapulothoracic joints. Each ligament is modelled by a sequence of line segments, each of which corresponds to each individual constraint equation (6). This yields 440 tendon constraints on the spinal column. We also sample four non-colinear points for each facet. As a result, our rigid-body world is simulated by 680 constraints. Our rigid-body simulation is written in C++ building upon the open-source library DART [Lee et al. 2018a]. We directly use the LCP solver in the DART engine for body-ground contact. The simulation runs at 600Hz for retrofitting and 1800Hz for trajectory optimizations. Simulation runs 8 to 40 times slower than real-time depending on configurations. We tetrahedralize the disc meshes using TetWild [Hu et al. 2018]. Each disc consists of 127 to 285 nodal vertices and 307 to 1090 tetrahedrons depending on its shape."
        },
        {
            "heading": "4.2 Motion Retrofitting",
            "text": "Our method provides a tool to estimate detailed movements of torso bones unobserved by standard moCap devices. We apply our tool to a large existing motion capture dataset, Mixamo, without user intervention to demonstrate its robustness. We will host a largescale public dataset of motion capture data with enriched torso movements.\nOur tool takes as input a target motion on any rigged skeleton and first retarget it to a temporary skeleton, followed by simulating the detailed torsomovements on our detailed skeleton. In the retargeting step, we utilize the IK-based retargeting algorithm provided by MotionBuilderTM to match the limb and head movements of the target motion on our temporary skeleton. The limbs and head of the temporary skeleton are identical to those of the detailed skeleton, but the torso is simplified to three ball joints, similar to many existing human rigs used in computer animation. The temporary skeleton has shoulders that include sternoclavicular and acromioclavicular joints, as it needs to allow movements such as shoulder shrugging and straightening. We set a wider range of motion for the temporary torso so that the arms and the head can match the target motion precisely. For each frame, using the current positions of the temporary skeleton, we set the positions of humerus, femur, and head bones as positional constraints and run our torso dynamics (Section 3.5) until convergence to a static equilibrium. The dynamic simulation is necessary because there are far more degrees of freedom on the torso then the constraints. In our experiments, we simulate the torso dynamics for 0.5\ud835\udc60 for most examples, while for some motions containing excessive bending we simulate the dynamics for 1\ud835\udc60 .\nACM Trans. Graph., Vol. 42, No. 4, Article 0. Publication date: August 2023.\nWe retrofit 1293 motion clips from Mixamo dataset including assorted dance moves, martial arts, baseball, jumping, walking, running etc. The dataset contains motion clips ranging from 1 to 44 seconds long, totaling an hour and 18 minutes of high quality motion data. Motion retrofitting takes 20 hours with AMD Ryzen 9 5950X. We accelerate the process with 16 parallel cores. A few representative motions can be found in the supplemental video."
        },
        {
            "heading": "4.3 Trajectory Optimization",
            "text": "We evaluate our torso model by solving trajectory optimization problems to simulate highly dynamic motions, i.e. jumping and swinging. The optimizer solves for a control trajectory to optimize the performance of a physically simulated motion sequence. Since the main goal of this experiment is to validate that the large number of DoFs does not prohibit physics simulation or optimal control in terms of efficiency, and motion naturalness is secondary, we use a very simple cost function, such as jumping as high as possible, with little regularization or tuning and without any use of human motion data. We adopt a standard stochastic trajectory optimization framework MPPI [Williams et al. 2017], a shooting-based gradient-free algorithm for solving open-loop control sequences. Given a constant initial state \ud835\udc920, \u00a4\ud835\udc920, and a transition function defined by a physics simulator \ud835\udc92\ud835\udc61 = \ud835\udc39 (\ud835\udc92\ud835\udc61\u22121, \ud835\udc82\ud835\udc61\u22121) with any action space \ud835\udc82, MPPI solves for (\ud835\udc820, \u00b7 \u00b7 \u00b7 , \ud835\udc82\ud835\udc41\u22121) such that the total optimal control cost\u2211\ud835\udc41 \ud835\udc61=0 \ud835\udc50 (\ud835\udc92\ud835\udc61 , \u00a4\ud835\udc92\ud835\udc61 ) of the simulated trajectory (\ud835\udc920, \ud835\udc921, \u00b7 \u00b7 \u00b7 , \ud835\udc92\ud835\udc41 ) is minimized. We additionally compare motions solved by our model to those from a fixed-torso model. Optimization takes around 30 MPPI iterations for both our model and the fixed-torso model, though our model has a much larger action space. For our model MPPI optimizations take around 6 hours each with 6 CPU cores, and the rigid-torso model is around 60x faster.\n4.3.1 Falling Test. Before running optimization, we make sure that when combining our model with an existing full-body skeleton, the combined model will be robust enough to interact with the environment and execute random control sequences commanded by MPPI during optimization. For this we drop our character from 2 meter high to the floor with small random controls commanded. As shown in the supplemental video, our model can handle discontinuous, large contact impact without issues. Interestingly, even without any optimization, our model already generates a more humanlike falling motion upon touching the ground, comparing with the fixed-torso model.\n4.3.2 Swing. In this task, the character attempts to swing on a horizontal bar from zero velocity. The objective is to maximize the product of horizontal and vertical speeds at the final frame of the trajectory, such that the character would travel the longest distance after releasing the bar:\n\u2212 \u00a4\ud835\udc5e\ud835\udc66,\ud835\udc41 \u00b7 \u00a4\ud835\udc5e\ud835\udc67,\ud835\udc41 + \ud835\udc41\u2211\ufe01 \ud835\udc61=0 0.1\ud835\udc5e2\ud835\udc65,\ud835\udc61 , (8)\nwhere \ud835\udc5e\ud835\udc65,\ud835\udc61 , \ud835\udc5e\ud835\udc66,\ud835\udc61 , \ud835\udc5e\ud835\udc67,\ud835\udc61 are respectively the \ud835\udc65,\ud835\udc66, \ud835\udc67 components of the center of mass of the character at time step \ud835\udc61 . The second term penalizes deviation from the sagittal plane:\nThe action space at each control step is the change of PD targets of relative bone orientations. While this action space is largely redundant compared with the real human musculoskeletal system which uses about 30 muscles to actuate the spine, we did not find MPPI having practical difficulty converging to a solution, nor did we find unnatural spine poses exhibted in the solution (except the task-irrelevant neck bones tends to be moderately jittery). We hypothesize that the coupling of discs, ligaments and facets in our spine model effectively restrict the search space of MPPI to a biomechanically realistic state-action space. On the other hand, the fixed spine character which uses only torso DoFs to swing demonstrates unsmooth and suboptimal behaviors, potentially due to its inability to utilize the spine to store and release potential energy.\n4.3.3 Jumping. The cost function tasks the character to jump as high as possible, with a small regularization term discouraging deviation from the vertical (\ud835\udc66) direction:\n\u2212 sign( \u00a4\ud835\udc5e\ud835\udc66,\ud835\udc41 ) \u00a4\ud835\udc5e2 \ud835\udc66,\ud835\udc41\n2\ud835\udc54 \u2212 \ud835\udc5e\ud835\udc66,\ud835\udc41 + \ud835\udc41\u2211\ufe01 \ud835\udc61=0 0.001(\ud835\udc5e2\ud835\udc65,\ud835\udc61 + \ud835\udc5e2\ud835\udc67,\ud835\udc61 ). (9)\nFor the jumping task, the action space for both our model and the fixed-torso model additionally include the knee and ankle DoFs. The difference between motions solved with two models are more subtle for this task, as excepted since spine mainly performs a balancing and buffering role in jumping. Nevertheless, the motion simulated by our torso model exhibits a propagation of acceleration due to the ground reaction force from the lower limbs through the spine, while the motion simulated by the fixed-torso model only uses ankles to exert large torque, resulting in more robot-like motion."
        },
        {
            "heading": "4.4 Comparisons with Real Human Data",
            "text": "4.4.1 Range of Motion. An effective validation of our model is to compare the range of motion (RoM) of each vertebrae bone in the simulatedmotion against real human RoM recorded in biomechanics literature. Because we do not explicitly \u201cset\u201d joint limits for our torso model, the resulting RoM is an emergent quantity from the complex interplay of physical and geometry properties of discs, ligaments, and facet joints.\nACM Trans. Graph., Vol. 42, No. 4, Article 0. Publication date: August 2023.\nWe compare the range of motion of each bone with established biomechanics literature [Anderst et al. 2015; Bhalla and Simmons 1969; Fujii et al. 2007]. The RoM of existing real human data is highly variant by subject\u2019s age, sex, and physical capability. We compare the RoM of our model with the average of existing data shown in red line in Figure 7). For each vertebrae bone, we measure the maximum and the minimum angle along anatomical axes (Flexion-Extension, Axial rotation and Lateral bending) to identify the RoM. The ranges of axial rotation and lateral bending are divided by half as they are symmetric. The RoM of our model is measured by the minimum and maximum angles (5% outliers are removed) among all retrofitted sequences of the Mixamo dataset. We observe that most verterbrae bones have similar RoMs compared to the biomechanics literature. There are still a few noticeable differences. For flexion-extension, the real human has a wider RoM on L1 and L2 while our model has a wider RoM on upper thoracic region. We suspect that the maximum length of ligaments we identified might be larger than the real human statistics due to our overly conservative algorithm. As a result, bending upper thoracic region is sufficient to match the positional constraints. We also observe a peak on C7 especially in axial rotation. We suspect that the locations and the shapes of the costovertebral joints and the costotransverse joints overly constrain the thoracic bones, and thus C7 has to be more flexible to compensate the narrowed RoM on the thoracic bones.\n4.4.2 Scapulohumeral Rhythm. Scapulohumeral rhythm is one of the signature features observed from human shoulder movements [Rockwood 2009]. It describes the relation between scapula elevation and humerus abduction. When a healthy subject laterally rotates the upper arm on the coronal plane, the glenohumeral joint (GH) and the scapulothoracic joint (ST) both contribute to the rotation (See Figure 8). The lateral rotation begins with the first phase called setting phase where the rotation is almost purely done by the GH joint while the ST joint remains relatively unchanged. If the rotation continues beyond a threshold (around 30 degrees), both GH and\nST joints start to rotate at a 1-to-2 ratio. This unique phenomenon emerges in our simulatedmotion from using sliding facet constraints between the scapula and the rib cage.\n4.4.3 Pressure Load on Disc. Existing biomechanics literature primarily focuses on spine and shoulder geometry and kinematics, such as lordosis (spine curvature), RoM, and Scapulohumeral Rhythm, while studies examining spine dynamics are less common due to the challenges of conducting in-vivo experiments. Among studies that measure dynamical properties, researchers often perform quasistatic analyses, such as assessing pressure loads on intervertebral discs. In [Wilke et al. 1999], the authors implanted a transducer with a pressure sensor into the L4-L5 disc, measuring loads during everyday tasks like standing, sitting, and holding objects. One experiment revealed a 0.5 MPa pressure during standing, which increased to 1.1 MPa when holding a 20 kg box and further to 1.8 MPa when holding the box 60 cm from the chest (See Figure 9).\nTo benchmark our model against their data, we compute pressure load by calculating elastic forces at the disc surface and dividing by the area attached to the bone (14.4 cm2). Using a PD controller, we emulate a pose holding a box with feet welded to the ground, allowing the character to hold the box without learning or optimizing motion control. Our experiment demonstrates similar pressure for the standing task and an increase when holding a box, albeit less than the clinical data, possibly due to the PD controller\u2019s high gain. Holding a box should cause spinal bending and both rotational and translational deformation of discs, but the high gain results in negligible rotational disc deformation. Translational DoFs between bones are not controlled by PD (to prevent the spine from moving freely with magic forces) and are solely influenced by the translational disc deformation, which correctly increases during box carrying."
        },
        {
            "heading": "4.5 Ablations",
            "text": "In this section, we conduct ablation studies to demonstrate the roles of intervertebral discs and ligaments in our torso simulation model.\n4.5.1 Disc. The intervertebral discs play a critical role in preventing vertebral discs from colliding and rubbing against each other. When we remove the discs during motion retrofitting, we observe a significant increase in bone-to-bone collisions. To quantify the impact of the discs, we measure bone-to-bone displacements relative to\nACM Trans. Graph., Vol. 42, No. 4, Article 0. Publication date: August 2023.\nrest-pose displacements and count the frames with collisions during retro-fitting, with and without the discs (See Figure 10). We approximate each vertebral bone as a cylinder to prevent the posterior side of bone (linked with the facets) from dominantly affecting distance measurements. We use mesh-to-cylinder distances to measure the displacements and compute the average and standard deviation (error bars) of the displacements across all motion frames in the dataset.\nWe observe that without the discs, the displacements at the lumbar bones are below 0 cm due to gravity, meaning that the distances between the bones are narrow. As a result, the bones collide with each other frequently at the incidence rate of 8.0% and 14.1% for L5 and L4 respectively during motion retrofitting. We also observe high collision rates among the upper thoracic bones, which are closer to each other at rest comparing to bones in other sections of the spine. With discs modeled (red in figure), collision rates are close to zero.\n4.5.2 Ligament. In addition, we also study the impact of ligaments. Removing the ligaments results in a unrealistically wider range of motion (RoM) than that of a real human spine (See Figure 11). Without the ligaments, the L5 exhibits a large flexion-extension angle ranging from \u221230\ud835\udc5c to 60\ud835\udc5c . When retrofitting the spine to the existing motions, our method tends to find extreme solution where only L5 rotates to fit the motion while other vertebral bones remain in the rest pose (See Figure 11 Right). This experiment shows that the ligaments with identified parameters provide accurate RoM, significantly improving our simulation model in producing more human-like results."
        },
        {
            "heading": "5 DISCUSSION",
            "text": "This paper introduces a novel human torso model featuring key anatomical elements from the spine and the shoulder complex. We show that our model is robust enough to retrofit a large and diverse motion database, and to be readily incorporated into existing fullbody skeletons to simulate highly dynamic movements. We further partially validate that the statistics of our model is consistent with the human data from biomechanics literature. While there has been some attempts from the biomechanics community to build similarly detailed spine or shoulder models, we demonstrate in this work that tools, algorithms, and implementation know-hows that continue to mature in Computer Graphics can make anatomically realistic human models robust and efficient for computationally-heavy applications, accelerating wide adoption of these models.\nOur current implementation has a few limitations. First, we have yet to model muscles on the torso which drive the spine and the shoulder. Our detailed skeletal model should help the development of an accurate torso muscle model. Second, passive dynamics of the joints and the discs, such as spring-damping coefficients and Poisson ratio, are tunedmanually.Whilemeasurement of dynamic properties of human skeleton is much less available compared with kinematics, our future work would include matching passive dynamics of our model to experiment data. Third, our current retrofitting is solved frame-by-frame and can lack temporal smoothness in some cases. Optimizing over a time window, or better initialization scheme would improve the quality of retrofitting.\nPerhaps the most exciting application domain enabled by our model lies in medicine and healthcare. The proposed computer graphics techniques have the potential to contribute to the development of noninvasive diagnostic tools for analyzing and predicting internal spinal conditions during daily activities. For instance, back pain, a prevalent medical issue affecting 80% of individuals at some point in their lives, is often caused by slipped (herniated) discs that impinge on the spinal nerve cord. The depth of this impingement affects the severity of pain and varies with different poses. Our model could simulate such protrusions and anticipate how various fullbody poses during a gait cycle influence the depth of impingement. Furthermore, incorrect squatting posture during strength training, leading to an improperly bent spine, can increase pressure on the spinal column. Our method may be capable of reproducing these phenomena and predicting the optimal squat position to minimize spinal load. Considering the wide variability in torso RoM due to factors like age, sex, and physical ability, personalizing our model for medical applications presents another promising future direction. Our framework also holds promise for enhancing computer animation applications. Existing skinning techniques such as linear blend skinning and dual quaternion skinning can be readily integrate to our model. In addition, by accounting for detailed bone meshes, our spine model can enable novel skinning techniques to visualize the outlines of scapular and vertebral protrusions commonly seen in actual human skin. Our model can thus serve as the foundation for a novel skinning pipeline. Additionally, adapting our spine model to quadruped animals, such as cats, may lead to improvements in the realism of animated quadruped motion.\nACM Trans. Graph., Vol. 42, No. 4, Article 0. Publication date: August 2023."
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "This work was supported by Wu Tsai Human Performance Alliance at Stanford University, the Stanford Institute for Human-Centered AI (HAI), and NSF:FRR 2153854."
        }
    ],
    "title": "Anatomically Detailed Simulation of Human Torso",
    "year": 2023
}