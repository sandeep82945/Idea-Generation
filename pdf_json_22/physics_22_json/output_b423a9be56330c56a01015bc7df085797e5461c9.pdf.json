{
    "abstractText": "We report a statistical analysis of Ge K-edge X-ray emission spectra simulated for amorphous GeO2 at elevated pressures. We find that employing machine learning approaches we can reliably predict the statistical moments of the Kb00 and Kb2 peaks in the spectrum from the Coulomb matrix descriptor with a training set of B 10 samples. Spectral-significance-guided dimensionality reduction techniques allow us to construct an approximate inverse mapping from spectral moments to pseudo-Coulomb matrices. When applying this to the moments of the ensemble-mean spectrum, we obtain distances from the active site that match closely to those of the ensemble mean and which moreover reproduce the pressure-induced coordination change in amorphous GeO2. With this approach utilizing emulator-based component analysis, we are able to filter out the artificially complete structural information available from simulated snapshots, and quantitatively analyse structural changes that can be inferred from the changes in the Kb emission spectrum alone.",
    "authors": [
        {
            "affiliations": [],
            "name": "Anton Vladyka"
        },
        {
            "affiliations": [],
            "name": "Christoph J. Sahle"
        },
        {
            "affiliations": [],
            "name": "Johannes Niskanen"
        }
    ],
    "id": "SP:cda0137650384bcf5fba146f31c969a6b2a42c6c",
    "references": [],
    "sections": [
        {
            "text": "This journal is \u00a9 the Owner Societies 2023 Phys. Chem. Chem. Phys., 2023, 25, 6707\u20136713 | 6707\nCite this: Phys. Chem. Chem. Phys., 2023, 25, 6707\nTowards structural reconstruction from X-ray spectra\u2020\nAnton Vladyka, *a Christoph J. Sahle b and Johannes Niskanen a\nWe report a statistical analysis of Ge K-edge X-ray emission spectra simulated for amorphous GeO2 at elevated pressures. We find that employing machine learning approaches we can reliably predict the statistical moments of the Kb00 and Kb2 peaks in the spectrum from the Coulomb matrix descriptor with a training set of B 104 samples. Spectral-significance-guided dimensionality reduction techniques allow\nus to construct an approximate inverse mapping from spectral moments to pseudo-Coulomb matrices.\nWhen applying this to the moments of the ensemble-mean spectrum, we obtain distances from the\nactive site that match closely to those of the ensemble mean and which moreover reproduce the\npressure-induced coordination change in amorphous GeO2. With this approach utilizing emulator-based component analysis, we are able to filter out the artificially complete structural information available\nfrom simulated snapshots, and quantitatively analyse structural changes that can be inferred from the changes in the Kb emission spectrum alone."
        },
        {
            "heading": "1 Introduction",
            "text": "Core-level spectroscopy provides information of structure of matter at the atomic level, and the constituent methods are applied from standard material characterization to conceptually new experiments at large-scale facilities such as freeelectron lasers. Although reference data helps, interpretation of core-level spectra is not always straightforward, especially in the case of soft condensed or amorphous matter where ensemble statistics plays a drastic role.1\u20137 Studies of this statistical nature, and the implied repeated function evaluations, could benefit from machine learning (ML), application of which to core-level spectra has been studied rather intensively lately.8\u201315 In general, when working with atomic resolution studies have raised the need to engineer features for both structure16\u201320 and spectra.13,19\nThe pressure dependent evolution of the germanium coordination by oxygen in glassy GeO2 has been a long standing subject of study.21\u201324 Besides applications of amorphous GeO2 in technical glasses, the increased sensitivity of a-GeO2 to pressure compared to amorphous SiO2 motivates the study of structural changes similar to those expected to occur in the pressurized analogue glass a-SiO2 but at greatly reduced\nabsolute pressures. Detailed knowledge of the compaction mechanisms in these simple glasses will have direct consequences for our understanding of geological, geochemical, and geophysical processes involving more complex silicate glasses and melts.\nX-ray emission spectra (XES) of GeO2 is an inviting case for development of spectroscopic analysis for soft and amorphous condensed matter. First, large spectroscopic changes with changing local structure are known to exist.24 Second, simulations are known to reproduce the observed ensemble-mean effects well.25 Third, XES is local-occupied-orbital derived and a few orbital-bonding neighbor atoms are expected to be decisive for the spectrum outcome. This would result in a minimal set of structural parameters needed to predict XES. Last, owing to the chemical simplicity and simple bonding topology due to nonmolecular structure, this system has promise to be reproduced by ML with the limited number of data points that the condensed phase allows. Namely, for such systems the electronic simulation needs to account for multi-electron effects in numerous interacting atoms - typically on the level of density functional theory. As a consequence, the number of individual structural data points for spectroscopy can be expected to be B 104 in an extensive contemporary simulation.\nIn this work, we focus on Ge Kb XES calculations of amorphous GeO2 at elevated pressures. Our previous work on the water molecule indicated that predicting spectral features is easier than predicting structural features.14 In the condensed phase, where the structural features to be predicted are more numerous, the task is arguably even more complicated. As a solution to this dilemma, we build a procedure on spectrum a University of Turku, Department of Physics and Astronomy, 20014 Turun yliopisto, Finland. E-mail: anton.vladyka@utu.fi, johannes.niskanen@utu.fi b European Synchrotron Radiation Source, 71 Avenue des Martyrs, 38000 Grenoble, France. E-mail: christoph.sahle@esrf.fr \u2020 Electronic supplementary information (ESI) available. See DOI: https://doi.org/ 10.1039/d2cp05420e\nReceived 19th November 2022, Accepted 9th February 2023\nDOI: 10.1039/d2cp05420e\nrsc.li/pccp\nPCCP\nPAPER\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 1\n5 Fe\nbr ua\nry 2\n02 3.\nD ow\nnl oa\nde d\non 1\n/1 9/\n20 24\n1 :2\n2: 30\nA M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io n 3. 0 U np or te d L\nic en\nce .\nView Article Online View Journal | View Issue\n6708 | Phys. Chem. Chem. Phys., 2023, 25, 6707\u20136713 This journal is \u00a9 the Owner Societies 2023\nprediction for structures, dimensionality reduction and iterative optimization algorithms. This approach is possible because the evaluation of a ML model requires much less computational resources than the corresponding quantum mechanical calculation does. We predict statistical moments of XES lines from a Coulomb matrix16 that describes the local atomic structure around the site of characteristic X-ray emission. Next, we study obtainable structural information for the occurring spectral changes in the pressure progression of the XES by emulator-based component analysis (ECA).15 Last, we investigate an approximate solution to the spectrum-to-structure inverse problem by first transforming it into an optimization task in the dimension-reduced ECA space, followed by expansion to the full multi-dimensional Coulomb matrix. A dedicated evaluation data set allows for assessment of performance of the approach in each of the aforementioned tasks."
        },
        {
            "heading": "2 Methods",
            "text": "After ionisation from a Ge 1s orbital, the electronic system is left in a highly excited state, which decays by either Auger decay or by emission of a photon, accompanied by a transition of an electron from a higher-energy orbital. For germanium, transitions from 3p to 1s orbital give rise to so called Kb emission spectra. Since the Ge 3p orbitals constitute valence orbitals, Ge Kb XES is highly sensitive to chemical bonding of the active Ge site.\nWe study data of amorphous GeO2 from statistical spectral simulations over a range of 11 pressure values from 0 GPa to 120 GPa. These XES spectra, simulated using the OCEAN code26,27 (version 2.5.2), are based on real-space configurations from ab initio molecular dynamics simulations reported earlier by Du et al.28 We used the Quantum ESPRESSO program package (version 5.0)29,30 for sampling the ground state wave functions and electron densities at the gamma point with a plane wave cutoff of 100 Ry (see Ref. 25 for more details). Transition matrix elements are then calculated using the Haydock recursion method31 as implemented in the OCEAN code using a Lorentzian width of 1.0 eV for the continued fraction. At each pressure point, Ge Kb XES spectra of 18 structurally uncorrelated AIMD simulation snapshots containing 72 GeO2 formula units were calculated for each Ge atom. For 5 pressure points only 17 out of 18 snapshots yielded spectra in a finite time frame due to convergence issues, resulting in 13 896 XES spectra. The spectra of individual Ge sites were aligned and normalized for each pressure to yield a constant Kb5 line peak position and intensity in its ensemble average spectrum.\nEven though extensive from a statistical simulation viewpoint, the available dataset is still rather limited for sophisticated ML algorithms. In this case, using a descriptive numerics allows for condensing structural and spectral information to a few parameters, resulting in an improvement of ML performance. We apply descriptors to both the spectrum and the atomic structure of the system (see below)."
        },
        {
            "heading": "2.1 Spectral-line descriptor",
            "text": "The XES spectrum is given as a function presenting intensity against photon energy in eV (I = I(E)). For a distinguishable peak in the spectrum, we use raw moments defined as follows:\nM1 \u00bc \u00d0 I\u00f0E\u00deEdE\u00d0 I\u00f0E\u00dedE ; (1)\nMn \u00bc \u00d0 I\u00f0E\u00de\u00f0E M1\u00dendE\u00d0\nI\u00f0E\u00dedE ; for n \u00bc 2; 3; 4: (2)\nCorresponding spectral descriptors used in the model are spectrum peak position mean m = M1 (eV), standard deviation s \u00bc ffiffiffiffiffiffiffi M2 p (eV), skewness sk =M3/s 3 and excess kurtosis ex = M4/s 4 3. These descriptors are referred to as \u2018\u2018spectral moments\u2019\u2019, and are presented as a vector m throughout the manuscript. In this work, 4 moments were calculated for both Kb00 and Kb2 peaks, which resulted in 8 descriptors per spectrum."
        },
        {
            "heading": "2.2 Structural descriptors",
            "text": "As the structural descriptor we use the Coulomb matrix,16 the elements of which are defined as\nCij \u00bc 0:5Z2:4i if i \u00bc j;\nZiZj\nRij if iaj;\n8>< >: (3)\nwhere Zi is the atomic number of the i-th atom, and Rij is the distance between the i-th and j-th atoms. In this work, we arrange the atoms by the distance from the active site in ascending order, and grouped Ge atoms first, followed by the O atoms. Since in this approach the order of atoms is the same for a given number of Ge and O atoms, the diagonal elements of the Coulomb matrix are identical for each structure. Therefore, owing to symmetry of the matrix, only the upper triangle of the Coulomb matrix is used (see Fig. 1) as vector p as an input data. From an optimization search, we deduced the optimal number of the atoms used for the Coulomb matrix calculation to be the 10 closest Ge and 7 closest O atoms, which\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 1\n5 Fe\nbr ua\nry 2\n02 3.\nD ow\nnl oa\nde d\non 1\n/1 9/\n20 24\n1 :2\n2: 30\nA M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io n 3. 0 U np or te d L\nic en\nce .\nThis journal is \u00a9 the Owner Societies 2023 Phys. Chem. Chem. Phys., 2023, 25, 6707\u20136713 | 6709\nleads to 153-dimensional feature vectors (see details in ESI,\u2020 Fig. S1).\nThe definition of the Coulomb matrix implies that it can be inverted to a distance matrix containing interatomic distances by\nRij \u00bc ZiZj\nCij with iaj; (4)\nwhere Rij is the distance between atoms i and j. This conversion is possible as the Zi of the chemical elements in each matrix element Cij is known. Furthermore, apart from the handedness of the coordinate system, the atomic geometry can be reconstructed from the distance matrix R, and therefore, from the Coulomb matrix C (see ESI\u2020 for algorithm).\nTo check the performance of the Coulomb matrix descriptor against a many-body-tensor-representation32 spirited descriptor, we used snapshot-wise evaluated radial distribution functions (RDF) from the active site. Although similar predictive power was obtained via the RDF, its performance in the later steps of the analysis (spectral coverage of decomposition) was inferior to that of the Coulomb matrix."
        },
        {
            "heading": "2.3 Algorithms",
            "text": "The structural and spectral data are presented as feature-wise standardized matrices P\u0303 and M\u0303, respectively (individual data points p\u0303 and m\u0303 occupy rows in these matrices). The analysis algorithms aim at discovering the correlations between the two data sets, for which we first applied the emulator-based component analysis (ECA) method as described in ref. 15. This algorithm relies on a machine-learning based emulator for spectral features at a vector of structural descriptors, that may be previously unseen to it. The algorithm uses projection of structural data on a subspace so that projected data maximize the generalized covered spectral variance (R2 score) when a prediction is made using the emulator. Here, ECA is applied to standardized Coulomb matrix parameters p\u0303 and the corresponding standardized spectral moments M\u0303. The decomposition algorithm results in orthonormal standardized-structuralparameter-space vectors v\u03031,v\u03032,. . . so that spectral moments m\u0303emu = Semu(p\u0303 (k)) for projections\n~p\u00f0k\u00de \u00bc Xk i\u00bc1\n~vi \u00f0~vi ~p\u00de|fflffl{zfflffl} \u00bc:ti ; (5)\npredicted using trained neural network Semu, cover most of spectral variance of the respective set of points p\u0303 at the given rank k. Scores ti are coordinates of the approximate point p\u0303\n(k) in the k-dimensional subspace.\nThe ECA method requires an emulator capable of predicting spectral moments for new structural data points. As an emulator, a trained multilayer perceptron (MLP) with 2 hidden layers and 64 neurons in each layer was used. We dedicated 80% of data for training, and 20% for evaluation of the prediction. Overall, all configurations of MLPs with 2\u20133 hidden layers and 64 or 128 neurons were evaluated on the training dataset (B11 000 spectra) using mean squared error as a training metric.\nFor comparison, we used partial least squares fitting based on singular value decomposition (PLSSVD)33 as applied to the X-ray spectroscopic problem in ref. 15. The PLSSVD algorithm relies on projections of spectral and structural feature vectors on latent variables between which a linear fit is made. The method results in an approximation of the data up to rank k\n~M ~P Xk i\u00bc1 U\u00f0i\u00deciV \u00f0i\u00deT; (6)\nwhere U(i) is the i-th (column) basis vector of the structural descriptors and V(i) is the i-th (column) basis vector of the spectral descriptor space. The coefficient ci is obtained by a fit to the scores (P\u0303U(i),M\u0303V(i)). The orthonormal basis vectors are obtained from a singular value decomposition of the covariance matrix of the data cov(P\u0303,M\u0303) =P\u0303TM\u0303; ordering along descending magnitude of the singular values li is applied. For analysis using the PLSSVD algorithm, the same evaluation data set as for ECA was used."
        },
        {
            "heading": "3 Results",
            "text": "The ensemble-averaged Ge Kb XES of GeO2 shows a transition induced by pressure, as seen in Fig. 2. Even though a smooth progression of the spectrum as a function of pressure is observed, the underlying statistical variation in the condensedphase XES is large.3,5,25 This is manifested by gray shading in Fig. 2 that shows the minimum\u2013maximum variation of intensity in the data set. We proceed with our analysis for the two lines with clear pressure dependence: the Kb00 and the Kb2.\nFig. 3a\u2013c present structures and spectra of three individual snapshots at pressures of 0, 30, and 120 GPa, respectively. Fig. 3d\u2013k in turn show the prediction and training performance of the chosen MLP for these descriptors. In the figure, perfect match between known and predicted data lie on the diagonal dashed line. Furthermore, the positions of the three illustrated spectra of Fig. 3a\u2013c, as well as the mean moment values for\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 1\n5 Fe\nbr ua\nry 2\n02 3.\nD ow\nnl oa\nde d\non 1\n/1 9/\n20 24\n1 :2\n2: 30\nA M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io n 3. 0 U np or te d L\nic en\nce .\n6710 | Phys. Chem. Chem. Phys., 2023, 25, 6707\u20136713 This journal is \u00a9 the Owner Societies 2023\neach pressure point against moment values of the known mean spectrum are indicated by crosses.\nThe spectra and their statistical moments show a clear trend as a function of pressure. Moreover, the overall quality of the prediction performance yields Pearson correlation coefficients above 0.94. The pressure-induced progression in the spectra is transferred into spectral moments, for which the ML task proved to be easier than predicting spectra as vectors of channel-wiselisted intensity values (see Fig. S2, ESI\u2020). Analogously with simple intensity prediction, spectral moments of an ensemble-averaged spectrum can be estimated by the mean of predicted moments to a good accuracy (see crosses in Fig. 3d\u2013k). However, this is an approximate finding instead of a mathematical equality.\nFor the evaluation data set, some 77% of generalized covered spectral variance (R2 score) can be explained by only a single ECA component v\u03031 (83% with two components {v\u03031,v\u03032}). These components represent individually standardized elements of a Coulomb matrix unrolled to 153-dimensional vectors (for {v\u03031,v\u03032} rolled back to the standardized Coulomb matrix differences, see Fig. S3, ESI\u2020) For PLSSVD, corresponding spectral variance coverages were 73% and 77% for one and\ntwo components, respectively. The added contribution of the second component indicates a rapid drop of improvement in higher ranks.\nBefore entering the inverse problem, it is instructive to analyse the decomposition of first rank i.e. along the path p\u0303(1) = t1v\u03031. Since the emulator provides the nonlinear response to the input vector, ECA is able to mimic the behavior of the moments more closely than PLSSVD, which is linear by definition (for the spectral moments along t1 see Fig. S4, ESI\u2020). For this reason, dimensionality reduction by ECA will be better adjusted to the spectral response; even with inaccuracies in prediction by the emulator, higher covered spectral variance is still obtained than from PLSSVD. For a majority of the atoms, both PLS and ECA trajectories follow the pressure-wise ensemble mean interatomic distances R0i from the active Ge site along the path (Fig. S5, ESI\u2020). However, for atoms Ge3, Ge4, O3, O4 and O7 the ECA trajectories show a different behavior, which indicates that the role of these atoms in deciding the spectral outcome is low compared to other atoms.\nThe interpretation of spectra would ideally lead to structures constructed from the spectroscopic information. However, already\nFig. 3 (a\u2013c) Sample XES spectra at different pressures. For each spectrum the inset shows the corresponding 3D structure, where the active Ge site is yellow, other Ge sites are pink and O sites are red. The symbols are used to indicate the data point in the panels below. (d\u2013k) Results of the MLP training: predicted spectral moments of the evaluation data set for the Kb00 (d\u2013g) and Kb2 peak (h\u2013k). The color of each point indicates the corresponding pressure for the structure, and colored crosses in every panel depict the mean values for each pressure subset (known: moments of known mean spectrum, predicted: mean of predicted moments). Positions of the sample spectra from panels (a\u2013c) are marked with black markers. Number in every panel shows the Pearson correlation coefficient r between known and predicted data.\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 1\n5 Fe\nbr ua\nry 2\n02 3.\nD ow\nnl oa\nde d\non 1\n/1 9/\n20 24\n1 :2\n2: 30\nA M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io n 3. 0 U np or te d L\nic en\nce .\nThis journal is \u00a9 the Owner Societies 2023 Phys. Chem. Chem. Phys., 2023, 25, 6707\u20136713 | 6711\nwith a few number of degrees of freedom (here 153) this problem is tedious. In line with findings in ref. 14, training an emulator to directly predict the Coulomb matrix from the spectral moments was not successful with the model selection grid, data and descriptors used here (the mean Pearson correlation coefficient of 0.33 was obtained). Therefore we looked at approaches that would rely on spectrum prediction by an emulator, that has in general better performance. However, an emulator-based approach of iteratively fitting the parameters p\u0303 to yield the 8 desired spectral moments proved also to be an unstable highdimensional problem, that we were unable to solve. Instead, fitting a few ECA component scores for matching spectral moments is a much simpler task that could be solved.\nWe searched for the coordinates t in the standardized dimension-reduced space by minimization of the least-squares error\nJ\u00f0t\u00de \u00bc ~Semu Xk i\u00bc1 ti~vi\n! ~m 2\n(7)\nfor a data point ~p\u00f0k\u00de \u00bc Pk i\u00bc1 ti~vi with given standardized spectral moments m\u0303. Here, S\u0303emu(p\u0303) is the standardized output of the moment emulator. We limit the study to two components t1 and t2.\nFig. 4 shows coordinates t = (t1,t2) for each point from the evaluation data set from fitting of eqn (7). Deduced coordinates for the set of moments of each mean-ensemble spectrum (blue line) are in a good agreement with projections of known mean points (black line) for a given pressure ensemble on the same subspace. It appears though, that this reconstruction of the scores ti misses the second component, possibly due to the fact that the component is already insignificant and the emulator is known to be imperfect. Knowledge of scores ti allows construction of an approximate Coulomb matrix p\u0303 as a linear\ncombination up to rank k. The absolute p is obtained after inverse standardization, as are C and R.\nEven though the mean interatomic distances are not necessarily obtainable from mean Coulomb matrix elements, and even though this matrix is not necessarily obtainable from the spectral moments of the ensemble-mean spectrum (which closely match with the ensemble mean of the spectral moments), we find both to be the case. Fig. 5 depicts the reconstructed atomic distances from the spectral moments with onedimensional and two-dimensional ECA space, indicating rapid convergence. Moreover, the reconstruction is at least qualitatively correct as seen from comparison with the known values for the evaluation data set, the most notable discrepancy being the 5th closest O atom at low pressures. This behavior can be understood in terms of reduced sensitivity of the spectra to these atomic distances; the first ECA component does not capture the drastic relative change in the parameter value (Fig. S5, ESI\u2020), and even the second component does not fix this shortcoming. Likewise, for the overall match on the data set, the vector v\u03031 results in underestimation of O6 distance at large t1 (high pressures), which leads to the line crossings in Fig. 5a. However, the pressure-induced coordination change from 4-coordinated Ge to 6-coordinated Ge21 is clearly discernible around the pressure of 10 GPa by the increase of the Ge\u2013O separation for the first four oxygen atoms and the concomitant decrease of Ge\u2013O distance for the fifth and sixth nearest oxygen neighbor. We note that while the first row of the constructed Coulomb matrix represent ensemble-averaged distances, the structure constructed from the mean Coulomb matrix is nonsensical."
        },
        {
            "heading": "4 Discussion",
            "text": "With the limited data available it is essential to have structural and spectral descriptors that are linkable by rather simple MLPs. Consequently, the used descriptors dictate the analysis\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 1\n5 Fe\nbr ua\nry 2\n02 3.\nD ow\nnl oa\nde d\non 1\n/1 9/\n20 24\n1 :2\n2: 30\nA M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io n 3. 0 U np or te d L\nic en\nce .\n6712 | Phys. Chem. Chem. Phys., 2023, 25, 6707\u20136713 This journal is \u00a9 the Owner Societies 2023\nto follow. While the relative positions of atoms for a Coulomb matrix can be evaluated (see ESI\u2020), there is dropout of more remote, potentially significant atoms. Furthermore, the observation that spectral moments are more suitable than tabulated intensities complicates spectral analysis as they may not be applicable in all cases, e.g. when clearly distinct and identifiable peaks are not formed for all data points.\nInstead of more direct approaches, approximate solution of the inverse problem by reconstruction of the first ECA components proved to be a feasible task to solve by optimization. It is natural to select these parameters so that they explain most spectral variance. As a result converging expansion of less and less relevant degrees of freedom are added and finally, irrelevant are identified and filtered out. Imperfection of emulator and incompleteness of the basis are likely reasons for the crossings of lines in Fig. 5a.\nStructural analysis of the AIMD trajectory results in a complete analysis of structural changes across the data set. However, this information does not indicate what can be concluded based on the XES alone, as the sensitivity of corelevel spectra to structural parameters may vary greatly.15,34 A parameter without an effect on a spectrum certainly cannot be expected to be reconstructed from it, and thus spectral insensitivity to a structural degree of freedom presents a danger of misinterpretation. The design of ECA means that a spectrally irrelevant structural degree of freedom obtains zero projection in the basis vector and is, in principle, omitted in subsequent analyses. Therefore, effects shown by ECA, and analysis based on it, can be considered to be inferred from a spectrum and its change. This reasoning is supported by Fig. 5, where the magnitudes of change from 0 GPa to 120 GPa in the known distance curves mostly exceed those of the predicted ones. For the end-to-end difference oxygens O3 and O4 with negligible (o 0.05 \u00c5) total change exceed that of the known data.\nDepending on details of an analysis other - rather minor - violations to the tendency can be found in the data.\nFor the 17 atoms and 11 pressures, the mean absolute deviation from the known ensemble-mean distances for 2-component decomposition was 0.091 \u00c5 for ECA and notably 0.051 \u00c5 for PLSSVD with which we also carried out the analysis (see Fig. S7\u2013S9, ESI\u2020). We interpret the better performance of PLSSVD to be due to more emphasis placed on structural variance in the method, whereas ECA focuses strictly on spectral significance. Thus PLS is allowed to know more from the simulated structural parameter space than the spectra alone would allow. However, the method undoubtedly benefited of the choice of descriptors by ML studies, making the data suitable for a linear model. In addition, imperfection of ECA results come from the imperfection of the emulator.\nSince the studied XES involves transitions of electrons from the occupied valence to localized deep core levels, the associated transition matrix elements become naturally limited to the immediate neighbourhood of the active atomic site. The occupied valence orbitals, in turn, can be expected to participate in chemical bonding, and thus to render these transitions sensitive to e.g. coordination number of the active site. It is an interesting yet open question to which degree the findings presented here generalize in other systems, and specifically to those posed by XES of high-pressure science. When assuming no exceptionality for GeO2 studied here, these spectra are potent of delivering far more structural information than it may at first seem."
        },
        {
            "heading": "5 Conclusions",
            "text": "For Ge Kb XES of GeO2 at elevated pressures, Coulomb matrix and statistical moments of spectral peaks prove to be descriptors feasible to be linked by machine-learning applications with B 104 simulated data points. We find the statistical moments of ensemble mean spectra to match closely with the ensemble mean of individually predicted moments. Dimensionality reduction by the ECA decomposition technique provides a means for a stable approximate solution of a spectroscopic inverse problem. We find the first row of a Coulomb matrix reconstructed from the spectral moments of the ensemblemean spectrum to represent that obtained from ensemblemean interatomic distances from the active site. Therefore, without a strict mathematical necessity, we find that these distances can be reconstructed to a good accuracy from the ensemble mean spectral statistical moments.\nDecomposition of structural sensitivity of spectra reduces the number of free parameters to be solved in the inversion problem, to only a few that have been chosen a priori for their spectral significance. The basis vectors of such decomposition span a subspace of degrees of freedom with most spectral response, and therefore reconstruction via this subspace will show structural effects with true inference from the change of spectra. This prevents spectrally irrelevant structural information, available in a simulation work, from affecting the analysis.\nFig. 5 Mean-structural-parameter-based distances from the central Ge atom. (a) Reconstructed distances for the t1 component. The inset shows distances for the 4 closest O atoms (dashed area). Dashed lines depict corresponding distances for sum of two projections (t1,t2). Arrow indicates the sequence of the atomic indices as mentioned in the text. (b) Known mean distances calculated from the atomic coordinates of the evaluation data set.\nO pe\nn A\ncc es\ns A\nrt ic\nle . P\nub lis\nhe d\non 1\n5 Fe\nbr ua\nry 2\n02 3.\nD ow\nnl oa\nde d\non 1\n/1 9/\n20 24\n1 :2\n2: 30\nA M . T hi s ar tic le is li ce ns ed u nd er a C re at iv e C om m on s A ttr ib ut io n 3. 0 U np or te d L\nic en\nce .\nThis journal is \u00a9 the Owner Societies 2023 Phys. Chem. Chem. Phys., 2023, 25, 6707\u20136713 | 6713\nPartial least squares fitting such as PLSSVD offers a usable and much lighter alternative where machine learning is not feasible, but the method is not as strict in spectrum-only inference.\nData availability\nUnderlying data (MD structures, corresponding XES spectra) and analysis scripts are available via request from the authors.\nAuthor contributions\nA. V. data analysis, machine learning, writing the manuscript; C. J. S. simulations, data curation, writing the manuscript; J. N. research design, data curation and its assistive analysis, funding, writing the manuscript.\nConflicts of interest\nThere are no conflicts to declare."
        },
        {
            "heading": "Acknowledgements",
            "text": "Academy of Finland is acknowledged for funding via project 331234. The European Synchrotron Radiation Facility is thanked for providing computing resources."
        }
    ],
    "title": "Towards structural reconstruction from X-ray spectra",
    "year": 2023
}