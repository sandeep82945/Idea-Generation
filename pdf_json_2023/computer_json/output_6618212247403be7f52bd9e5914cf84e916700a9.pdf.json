{
    "abstractText": "Dynamic positron emission tomography imaging (dPET) provides temporally resolved images of a tracer enabling a quantitative measure of physiological processes. Voxel-wise physiologically-based pharmacokinetic (PBPK) modeling of the time activity curves (TAC) can provide relevant diagnostic information for clinical workflow. Conventional fitting strategies for TACs are slow and ignore the spatial relation between neighboring voxels. We train a spatio-temporal UNet to estimate the kinetic parameters given TAC from F-18-fluorodeoxyglucose (FDG) dPET. This work introduces a self-supervised loss formulation to enforce the similarity between the measured TAC and those generated with the learned kinetic parameters. Our method provides quantitatively comparable results at organ-level to the significantly slower conventional approaches, while generating pixel-wise parametric images which are consistent with expected physiology. To the best of our knowledge, this is the first self-supervised network that allows voxel-wise computation of kinetic parameters consistent with a non-linear kinetic model.",
    "authors": [
        {
            "affiliations": [],
            "name": "Francesca De Benetti"
        },
        {
            "affiliations": [],
            "name": "Walter Simson"
        },
        {
            "affiliations": [],
            "name": "Magdalini Paschali"
        },
        {
            "affiliations": [],
            "name": "Hasan Sari"
        },
        {
            "affiliations": [],
            "name": "Axel Romiger"
        },
        {
            "affiliations": [],
            "name": "Kuangyu Shi"
        },
        {
            "affiliations": [],
            "name": "Nassir Navab"
        },
        {
            "affiliations": [],
            "name": "Thomas Wendler"
        }
    ],
    "id": "SP:a4954859ebd53ed7f6d9389e4fe721f78b698377",
    "references": [
        {
            "authors": [
                "X.J. Avula"
            ],
            "title": "Mathematical modeling",
            "venue": "Meyers, R.A. (ed.) Encyclopedia of Physical Science and Technology (Third Edition), pp. 219\u2013230. Academic Press, New York, third edition edn.",
            "year": 2003
        },
        {
            "authors": [
                "F.L. Besson",
                "B. Fernandez",
                "S. Faure",
                "O. Mercier",
                "A. Seferian",
                "X. Mignard",
                "S. Mussot",
                "C. le Pechoux",
                "C. Caramella",
                "A Botticella"
            ],
            "title": "18f-fdg pet and dce kinetic modeling and their correlations in primary nsclc: First voxel-wise correlative analysis of human simultaneous [18f] fdg pet-mri data",
            "venue": "EJNMMI research 10(1), 1\u201313",
            "year": 2020
        },
        {
            "authors": [
                "\u00d6. \u00c7i\u00e7ek",
                "A. Abdulkadir",
                "S.S. Lienkamp",
                "T. Brox",
                "O. Ronneberger"
            ],
            "title": "3d u-net: learning dense volumetric segmentation from sparse annotation",
            "venue": "Medical Image Computing and Computer-Assisted Intervention\u2013MICCAI 2016: 19th International Conference, Athens, Greece, October 17-21, 2016, Proceedings, Part II 19. pp. 424\u2013 432. Springer",
            "year": 2016
        },
        {
            "authors": [
                "J. Cui",
                "K. Gong",
                "N. Guo",
                "K. Kim",
                "H. Liu",
                "Q. Li"
            ],
            "title": "Unsupervised PET logan parametric image estimation using conditional deep image prior",
            "venue": "Medical Image Analysis 80, 102519",
            "year": 2022
        },
        {
            "authors": [
                "A.H. Dias",
                "A.K. Hansen",
                "O.L. Munk",
                "L.C. Gormsen"
            ],
            "title": "Normal values for 18F-FDG uptake in organs and tissues measured by dynamic whole body multiparametric FDG PET in 126 patients",
            "venue": "EJNMMI research 12(1), 1\u201314",
            "year": 2022
        },
        {
            "authors": [
                "A. Dimitrakopoulou-Strauss",
                "L. Pan",
                "C. Sachpekidis"
            ],
            "title": "Kinetic modeling and parametric imaging with dynamic PET for oncological applications: general considerations, current clinical applications, and future perspectives",
            "venue": "European journal of nuclear medicine and molecular imaging 48, 21\u201339",
            "year": 2021
        },
        {
            "authors": [
                "G. Fahrni",
                "N.A. Karakatsanis",
                "G. Di Domenicantonio",
                "V. Garibotto",
                "H. Zaidi"
            ],
            "title": "Does whole-body Patlak 18 F-FDG PET imaging improve lesion detectability in clinical oncology? European radiology",
            "year": 2019
        },
        {
            "authors": [
                "X. Guo",
                "B. Zhou",
                "X. Chen",
                "C. Liu",
                "N.C. Dvornek"
            ],
            "title": "Mcp-net: Inter-frame motion correction with patlak regularization for whole-body dynamic pet",
            "venue": "Medical Image Computing and Computer Assisted Intervention\u2013MICCAI 2022: 25th International Conference, Singapore, September 18\u201322, 2022, Proceedings, Part IV. pp. 163\u2013172. Springer",
            "year": 2022
        },
        {
            "authors": [
                "Z. Huang",
                "Y. Wu",
                "F. Fu",
                "N. Meng",
                "F. Gu",
                "Q. Wu",
                "Y. Zhou",
                "Y. Yang",
                "X. Liu",
                "H Zheng"
            ],
            "title": "Parametric image generation with the uEXPLORER total-body PET/CT system through deep learning",
            "venue": "European Journal of Nuclear Medicine and Molecular Imaging 49(8), 2482\u20132492",
            "year": 2022
        },
        {
            "authors": [
                "T. K\u00fcstner",
                "N. Fuin",
                "K. Hammernik",
                "A. Bustin",
                "H. Qi",
                "R. Hajhosseiny",
                "P.G. Masci",
                "R. Neji",
                "D. Rueckert",
                "Botnar",
                "R.M"
            ],
            "title": "Cinenet: deep learning-based 3d cardiac cine mri reconstruction with multi-coil complex-valued 4d spatio-temporal convolutions",
            "venue": "Scientific reports 10(1), 13710",
            "year": 2020
        },
        {
            "authors": [
                "A. Li",
                "J. Tang"
            ],
            "title": "Direct parametric image reconstruction for dynamic myocardial perfusion PET using artificial neural network representation",
            "year": 2022
        },
        {
            "authors": [
                "H. Moradi",
                "V. Vegh",
                "K. O\u2019Brien",
                "A. Hammond",
                "D. Reutens"
            ],
            "title": "FDG-PET kinetic model identifiability and selection using machine learning",
            "year": 2022
        },
        {
            "authors": [
                "A.R. Pantel",
                "V. Viswanath",
                "M. Muzi",
                "R.K. Doot",
                "D.A. Mankoff"
            ],
            "title": "Principles of tracer kinetic analysis in oncology, part I: principles and overview of methodology",
            "venue": "Journal of Nuclear Medicine 63(3), 342\u2013352",
            "year": 2022
        },
        {
            "authors": [
                "A.R. Pantel",
                "V. Viswanath",
                "M. Muzi",
                "R.K. Doot",
                "D.A. Mankoff"
            ],
            "title": "Principles of tracer kinetic analysis in oncology, part II: examples and future directions",
            "venue": "Journal of Nuclear Medicine 63(4), 514\u2013521",
            "year": 2022
        },
        {
            "authors": [
                "H. Sari",
                "C. Mingels",
                "I. Alberts",
                "J. Hu",
                "D. Buesser",
                "V. Shah",
                "R. Schepers",
                "P. Caluori",
                "V. Panin",
                "M Conti"
            ],
            "title": "First results on kinetic modelling and parametric imaging of dynamic 18F-FDG datasets from a long axial FOV PET scanner in oncological patients",
            "venue": "European journal of nuclear medicine and molecular imaging pp. 1\u201313",
            "year": 2022
        },
        {
            "authors": [
                "J.A. Snyman",
                "Wilke",
                "D.N"
            ],
            "title": "Practical mathematical optimization",
            "venue": "Springer",
            "year": 2005
        },
        {
            "authors": [
                "S. Surti",
                "A.R. Pantel",
                "J.S. Karp"
            ],
            "title": "Total body PET: why, how, what for? IEEE transactions on radiation and plasma medical sciences",
            "year": 2020
        },
        {
            "authors": [
                "G. Wang",
                "L. Nardo",
                "M. Parikh",
                "Y.G. Abdelhafez",
                "E. Li",
                "B.A. Spencer",
                "J. Qi",
                "T. Jones",
                "S.R. Cherry",
                "R.D. Badawi"
            ],
            "title": "Total-body pet multiparametric imaging of cancer using a voxelwise strategy of compartmental modeling",
            "venue": "Journal of Nuclear Medicine 63(8), 1274\u20131281",
            "year": 2022
        },
        {
            "authors": [
                "H. Watabe"
            ],
            "title": "Compartmental modeling in PET kinetics, pp",
            "venue": "323\u2013352. Springer International Publishing",
            "year": 2016
        },
        {
            "authors": [
                "Y. Zuo",
                "S. Sarkar",
                "M.T. Corwin",
                "K. Olson",
                "R.D. Badawi",
                "G. Wang"
            ],
            "title": "Structural and practical identifiability of dual-input kinetic modeling in dynamic pet of liver inflammation",
            "venue": "Physics in Medicine & Biology 64(17), 175023",
            "year": 2019
        }
    ],
    "sections": [
        {
            "heading": "1 Introduction",
            "text": "Positron Emission Tomography (PET) is a 3D imaging modality using radiopharmaceuticals, such as F-18-fluorodeoxyglucose (FDG) as tracer. Newly introduced long axial field-of-view (LA-FoV) PET scanners have enabled dynamic PET (dPET) with frame duration < 1 minute [17], allowing the observation of dynamic metabolic processes throughout the body. For a given voxel in space, the measurement of radioactivity concentration over time can be described by a characteristic curve, known as Time Activity Curve (TAC), measured in [Bq/ml].\nar X\niv :2\n30 5.\n10 56\n9v 1\n[ ee\nss .I\nTACs can be described by mathematical functions, called physiologicallybased pharmacokinetic (PBPK) models or kinetic models (KM) [13]. The parameters of the KM represent physiologically relevant quantities and are often called micro-parameters, whereas their combinations are called macro-parameters [13,19]. While the former can be retrieved only by methods that directly use the KM function, the latter can be computed also by simplified linearized methods (such as the Logan and the Patlak-Gjedde plots).\nThe approaches to extract KM parameters can be split in two categories: Volume of Interest (VoI) methods, in which the average TAC in a VoI is used, or voxel-based methods. Despite the former displaying less noise and therefore lower variance in the kinetic parameters, VoI-based methods only provide organwise information. On the other hand, voxel-based methods allow the generation of parametric images, in which kinetic parameters are visualized at a voxel level, but suffer from motion and breathing artifacts [19].\nParametric images are reported to be superior in lesion detection and delineation when compared to standard-of-care static activity- and weight-normalized PET images, known as Standard Uptake Value (SUV) images [6,7]. Biomarkers in breast cancer (e.g. recurrence rate and mortality risk) can be extracted by FDG-dPET kinetic analysis. Changes in the kinetic parameters during oncological therapy are associated with pathological response to treatment, whereas this is not true for changes in SUV [14].\nDespite the advantages of parametric images in diagnosis, the generation of accurate micro-parametric images is not possible in clinical practice today. To address the problem of the calculation of micro-parameteric images, we propose the use of a custom 3D UNet [3] to estimate kinetic micro-parameters in an unsupervised setting drawing inspiration from physics informed neural networks (PINN). The main contributions of this work are:\n\u2013 A self-supervised formulation of the problem of kinetic micro-parameters estimation \u2013 A spatio-temporal deep neural network for parametric images estimation \u2013 A quantitative and qualitative comparison with conventional methods for\nPBPK modeling"
        },
        {
            "heading": "1.1 Related work",
            "text": "Finding the parameters of a KM is a classical optimization problem [2,18,20] solved by fitting the kinetic model to measured TACs in a least squares sense [1,13,16]. The non-linearity of the KM functions make this approach prone to overfitting and local minima, and sensitive to noise [13]. Therefore, non-linear parametric imaging is still too noisy for clinical application [19]. To limit the drawbacks of the non-linear parameter fitting, the identification of kinetic parameters is commonly performed using simplified linearized versions of the KM [6,19], such as the Patlak-Gjedde plot [5,15], which are often included in clinical software for KM such as PMOD7. 7 https://www.pmod.com\nPreliminary works towards KM parameter estimation in dPET imaging have recently begun to be explored. Simulated data were used by Moradi et al. to select models to describe kinetic data [12]. Using an auto-encoder along with a Gaussian process regression block, they estimated KM parameters using a simulated 1D input function. Li et al. presented a similar approach for the prediction of the radioisotope uptake rate parameter for quantification of myocardial blood flow from simulated PET sinograms [11]. Huang et al. used a supervised 3D U-Net with residual modules to predict a macro-parameter image using an SUV image derived from static PET as input, and a Patlak image derived from dPET acquisition as ground truth [9]. Cui et al. proposed a conditional deep image prior framework to predict a macro-parametic image using a DNN in an unsupervised setting [4]. Until now, methods used simulated data [11,12] or static PET [9], were supervised [11,12,9] or predicted macro-parameters [9,4]."
        },
        {
            "heading": "2 Methodology and Materials",
            "text": "We propose to compute the kinetic micro-parameters in a self-supervised setting by directly including the KM in the loss function and comparing the modeled to the measured TAC. For this reason, an understanding of the KM is fundamental to describe our pipeline (see Fig. 1). We will briefly introduce the KM and then the proposed method in this Section."
        },
        {
            "heading": "2.1 Kinetic modelling",
            "text": "An FDG-TAC can be described by an irreversible two-compartment kinetic model (2TC), which represents the interaction of two compartments, F (t) (free) and B(t) (bound), and takes as input the radioactivity concentration in blood or plasma A(t) [13]. The concentration of the tracer C\u0303(t) in each tissue can be described as a set of ordinary differential equations [19]:\ndF (t)\ndt = K1A(t)\u2212 (k2 + k3)F (t)\ndB(t)\ndt = k3F (t) (1)\nC\u0303(t) = F (t) +B(t)\nwhere the micro-parameters K1 [ml/cm3/min], k2 [1/min], and k3 [1/min] represent physiologically meaningful quantities [6,19]. Including the blood fraction volume VB allows to correctly model the contribution to the radioactivity from vessels in a voxel that are too small to be resolved by the PET scanner [13].\nTogether, the TAC of each voxel in a FDG dPET acquisition can be modeled as C(t) = (1\u2212 VB)C\u0303(t) + VBA(t), and solved using the Laplace transform [19]:\nC(t) = (1\u2212 VB) [\nK1 k2 + k3\n[ k3 + k2e (k2+k3)t ] \u2217A(t) ] + VBA(t). (2)"
        },
        {
            "heading": "2.2 Proposed Pipeline",
            "text": "Our network takes as input a sequence of 2D axial slices and returns a 4-channel output representing the spatial distribution of KM parameters of a 2TC for FDG metabolisation [13]. The network has a depth of four, with long [3] and short skip connections [10]. The kernel size of the max-pooling is [2, 2, 2]. After the last decoder block, two 3D convolutional layers (with kernel size [3, 3, 3] and [64, 1, 1]) estimate the kinetic parameters given the output feature of the network. Inside the network the activation function is ELU and critically batch normalization is omitted. The network was trained with an initial learning rate of 10\u22124, which was divided by half every 25 epochs, for a maximum of 500 epochs.\nFollowing the approach taken by K\u00fcstner et al. for motion correction of 4D spatio-temporal CINE MRI, we used spatial-temporal convolutions for KM parameter estimation [10]. For PET, we replaced a conventional 3D convolutional layer with (2+1)D spatial and temporal convolutional layers. The spatial convolutional layer is a 3D convolutional layer with kernel size [1, 3, 3] in [t, x, y]. Similarly, the temporal convolutional layer has kernel size of [3, 1, 1].\nWe imposed that the parameters predicted by the network satisfy Eq. 2 by including it in the computation of the loss. At a pixel-level, we computed the Mean Squared Error (MSE) between the TAC estimated using the corresponding predicted parameters ( \u02dcTACi) and the measured one TACi, as seen in Fig. 1.\nWe introduced a final activation function to limit the output of the network to the valid parameter domain of the KM function. Using the multi-clamp function,\neach channel of the logits is restricted to the following parameter spaces: K1 \u2208 [0.01, 2], k2 \u2208 [0.01, 3], K3 \u2208 [0.01, 1], and VB \u2208 [0, 1]. The limits of the ranges were defined based on the meaning of the parameter (as in VB), mathematical requirements (as in the minimum values of k2 and k3, whose sum cannot be zero) [6] or previous knowledge on the dataset derived by the work of Sari et al. [15] (as in the maximum values of K1, k2 and k3).\nTo evaluate the performance of the network, we used the Mean Absolute Error (MAE) and the cosine similarity (CS) between TACi and \u02dcTACi."
        },
        {
            "heading": "2.3 Curve fit",
            "text": "For comparison, parameter optimization via non-linear fitting was implemented in Python using the scipy.optimize.curve_fit function (version 1.10), with initial values set to 0.1 for K1 and k2 and to 0.01 for k3 and VB , bounds set to [0,+\u221e) and step equal to 0.001."
        },
        {
            "heading": "2.4 Dataset",
            "text": "The dataset is composed by 23 oncological patients with different tumor types (see Supplementary Material). dPET data was acquired on a Biograph Vision Quadra for 65 minutes, over 62 frames. The exposure duration of the frames were 2\u00d710 s, 30\u00d72 s, 4\u00d710 s, 8\u00d730 s, 4\u00d760 s, 5\u00d7120 s and 9\u00d7300 s. The PET volumes were reconstructed with a voxel size of (1.65 mm)3. The dataset included one label map of 8 organs (bones, lungs, heart, liver, kidneys, spleen, aorta, brain) and one Image-Derived Input Function (IDIF, [Bq/ml]) from the descending aorta (which represented A(t)) per patient.\nThe PET frames and the label map were resampled to isotropic spacing of 2.5 mm. Then, the dataset was split patient-wise into training, validation and test set, with 10, 4 and 9 patients respectively. The training set consisted of 750 slices and the validation consisted of 300. In both cases 75 axial slices per patient were extracted in pre-defined patient-specific range from the the lungs to the bladder (included) and were cropped to size 112\u00d7112 pixels."
        },
        {
            "heading": "3 Results",
            "text": "Tab. 2 shows the results of the 8 ablation studies we performed to find the best model. We evaluated the impact of the design of the convolutional and max-pooling kernels, as well as the choice of the final activation. The design of the max pooling kernel (i.e., kernel size equal to [2, 2, 2] or [1, 2, 2]) had no measurable effects in terms of CS in most of the experiments, with the exception of Exp. 3.2 (as seen in Tab. 2) where max-pooling only in space resulted in a drop of 0.06. When evaluating the MAE, the use of the 3D max-pooling was generally better. The most important design choice is the selection of the final activation function. Indeed, the multi-clamp activation function was proven to be the best both in terms of CS (Exp 4.1: CS = 0.78 \u00b1 0.05) and MAE (Exp 4.2:\nMAE = 3.27 \u00b1 2.01). Compared to the other final activation functions, when the multi-clamp is used the impact of the max-pooling design is negligible also in terms of MAE. For the rest of the experiments, the selected configuration is the one from Exp. 4.1 (see Tab. 2).\nFig. 2 shows the kinetic parameters for four selected organs as computed with the proposed DNN (PDNN), and as computed with curve fit (PrefCF) using all 23 patients [15] and using only the test set (PCF). The voxel-wise kinetic parameters predicted by the DNN were averaged over the available organ masks. For parameter estimation with real data there is no ground truth, so this comparison serves as plausibility check.\nIn terms of run-time, the DNN needed approx. one minute to predict the kinetic parameters of the a whole-body scan (\u2248 400 slices), whereas curve fit took 8.7 minutes for a single slice: the time reduction of the DNN is expected to be \u2248 3.500 times."
        },
        {
            "heading": "4 Discussion",
            "text": "In the architecture of the network, the selection of the kernel design is important. Even though the choice of the final activation function has greater impact, using spatial and temporal convolution results in an increase in the performance (+0.01 in CS) and reduces the number of trainable parameters (from 2.1 M to 8.6 K), as pointed out by [10]. Therefore, the convergence is reached faster. Moreover, the use of two separate kernels in time and space is especially important because voxel counts are influenced by the neighbouring voxels due to the limited resolution of the PET scanner [19], but they are not influenced by the previous/following acquisitions in time. In general, there is good agreement between PDNN, PCF and PrefCF. The DNN prediction of K1 in the spleen, k2 in the kidneys and in the spleen, and k3 in the lungs is outside of the confidence interval of the PrefCF results published by Sari et al. [15].\nAn analysis per slice of the metrics shows that the CS between TACi and \u02dcTACi changes substantially depending on the region: CSmax=0.87 within the liver boundaries and CSmin =0.71 in the region corresponding to the heart and lungs (see Fig. 3a). This can be explained by the fact that VB is underestimated for the heart and aorta. The proposed network predicts V heartB = 0.376 \u00b1 0.133 and V aortaB = 0.622 \u00b1 0.238 while values of nearly 1 are to be expected. This is likely due to breathing and heart beat motion artifacts, which cannot be modeled properly with a 2TC KM that assumes no motion between frames.\nFig. 3b-e show the central coronal slice of the four parametric images through an exemplary patient. All parametric images show expected trends: e.g., K1, the uptake rate is high in heart, liver and kidney; similarly, the blood fraction volume VB is higher in the heart, blood vessels and lungs. This trend is also visible in Fig. 4a where an axial slice of K1 is depicted. K1 as calculated by the DNN distributes homogeneously when compared to the K1 image calculated using curve fit. Also, the distribution in the liver is more realistic in the DNN image, where the gallbladder can be seen as an ellipsoid between right and left liver lobes. High K1 regions are mainly within the liver, spleen and kidney for the DNN, while they also appear in unexpected areas in the curve fit image (e.g., next to the spine or in the region of the stomach).\nStandard non-linear optimization algorithms pitfalls, including local minima and overfitting, can result in poor estimation of kinetic parameters if performed independently [13]. Hence, the calculation of kinetic parameters at voxel level is more difficult than VoI-approaches that are commonly used. Moreover, voxelwise estimation requires more computational power or simplified methods like the Patlak plot [19].\nThe major limitation of this work is the lack of ground truth and a canonical method to evaluate quantitatively its performance. This limitation is inherent to PBPK modeling and results in the need for qualitative analyses based on expected physiological processes. A possible way to leverage this would be to work on simulated data, yet the validity of such evaluations strongly depends on how realistic the underlying simulation models are. As seen in Fig. 3a, motion (gross, respiratory or cardiac) has a major impact on the quality of the estima-\ntion. Registering different dPET frames has been shown to improve conventional PBPK models [8] and would possibly have a positive impact on our approach."
        },
        {
            "heading": "5 Conclusion",
            "text": "In this work, inspired by PINNs, we combine a self-supervised spatio-temporal DNN with a new loss formulation considering physiology to perform kinetic modeling of FDG dPET. We compare the best DNN model with the most commonly used conventional PBPK method, curve fit. While no ground truth is available, the proposed method provides similar results to curve fit, but qualitatively more plausible images in terms of physiology and with a radically shorter run-time. Further, our approach can be easily extended to more complex KM without increasing the complexity and the need of computational power significantly. Overall this work offers scalability and a new direction of research for analysing pharmacokinetics."
        }
    ],
    "title": "Self-Supervised Learning for Physiologically-Based Pharmacokinetic Modeling in Dynamic PET",
    "year": 2023
}