{
    "abstractText": "In this paper we derive and analyse efficient and stable numerical methods for accurate numerical simulations of nonlinear dynamic shear ruptures on non-planar faults embedded in 3D elastic solids using dual-paring (DP) summation by parts (SBP) finite difference (FD) methods. Specifically, for nonlinear dynamic earthquake ruptures, we demonstrate that the DP SBP FD operators [K. Mattsson. J. Comput. Phys., 335:283-310, 2017] generate spurious catastrophic high frequency wave modes that do not diminish with mesh refinement. Meanwhile our new dispersion relation preserving (DRP) SBP FD operators [C. Williams and K Duru, https://arxiv.org/abs/2110.04957, 2021] have more accurate numerical dispersion relation properties and do not support poisonous spurious high frequency wave modes. Numerical simulations are performed in 3D with geometrically complex fault surfaces verifying the efficacy of the method. Our method accurately reproduces community developed dynamic rupture benchmark problems, proposed by Southern California Earthquake Center, with less computational effort than standard methods based on traditional SBP FD operators. Keyword: Dual-pairing summation by parts methods, stability, earthquake rupture, nonlinear friction laws, dispersion relation preserving schemes, high performance computing",
    "authors": [
        {
            "affiliations": [],
            "name": "Kenneth Duru"
        },
        {
            "affiliations": [],
            "name": "Christopher Williams"
        },
        {
            "affiliations": [],
            "name": "Frederick Fung"
        }
    ],
    "id": "SP:0d236af6d9a81a6fb5e17df9cd204d70ce5a701f",
    "references": [
        {
            "authors": [
                "J.D. ACHENBACH"
            ],
            "title": "Wave Propagation in Elastic Solids. North-Holland Series in Applied Mathematics and Mechanics",
            "year": 1975
        },
        {
            "authors": [
                "DJ Andrews"
            ],
            "title": "Dynamic plane-strain shear rupture with a slip-weakening friction law calculated by a boundary integral method",
            "venue": "Bulletin of the Seismological Society of America,",
            "year": 1985
        },
        {
            "authors": [
                "Oded Ben-David",
                "Gil Cohen",
                "Jay Fineberg"
            ],
            "title": "The dynamics of the onset of frictional slip",
            "venue": "Science, 330(6001):211\u2013214,",
            "year": 2010
        },
        {
            "authors": [
                "M. Benjemaa",
                "N. Glinsky-Olivier",
                "V.M. Cruz-Atienza",
                "J. Virieux",
                "S. Piperno"
            ],
            "title": "Dynamic non-planar crack rupture by a finite volume method",
            "venue": "Geophysical Journal International, 171(1):271\u2013285,",
            "year": 2007
        },
        {
            "authors": [
                "Frank Philip Bowden",
                "David Tabor"
            ],
            "title": "The friction and lubrication of solids, volume 1",
            "venue": "Oxford university press,",
            "year": 2001
        },
        {
            "authors": [
                "M. Carpenter",
                "C. Kennedy"
            ],
            "title": "Fourth-order 2n-storage runge\u2013kutta schemes",
            "venue": "Technical report NASA TM-109112,",
            "year": 1994
        },
        {
            "authors": [
                "J. de la Puente",
                "J.-P. Ampuero",
                "M. K\u00e4ser"
            ],
            "title": "Dynamic rupture modeling on unstructured meshes using a discontinuous galerkin method",
            "venue": "Journal of Geophysical Research: Solid Earth,",
            "year": 2009
        },
        {
            "authors": [
                "James H Dieterich"
            ],
            "title": "Modeling of rock friction: 2. simulation of preseismic slip",
            "venue": "Journal of Geophysical Research: Solid Earth,",
            "year": 1979
        },
        {
            "authors": [
                "L. Dovgilovich",
                "I. Sofronov"
            ],
            "title": "High-accuracy finite-difference schemes for solving elastodynamic problems in curvilinear coordinates within multi-block approach",
            "venue": "Appl. Numer. Math.,",
            "year": 2015
        },
        {
            "authors": [
                "Eric M Dunham",
                "Jeremy E Kozdon",
                "David Belanger",
                "Lin Cong"
            ],
            "title": "Earthquake ruptures on rough faults",
            "venue": "In Multiscale and Multiphysics Processes in Geomechanics,",
            "year": 2011
        },
        {
            "authors": [
                "K. Duru",
                "E.M. Dunham"
            ],
            "title": "Dynamic earthquake rupture simulations on nonplanar faults embedded in 3d geometrically complex, heterogeneous elastic solids",
            "venue": "J. Comput. Phys.,",
            "year": 2016
        },
        {
            "authors": [
                "K. Duru",
                "J.E. Kozdon",
                "G. Kreiss"
            ],
            "title": "Boundary conditions and stability of a perfectly matched layer for the elastic wave equation in first order form",
            "venue": "J. Comput. Phys.,",
            "year": 2015
        },
        {
            "authors": [
                "K. Duru",
                "L. Rannabauer",
                "A.-A. Gabriel",
                "G. Kreiss",
                "M. Bader"
            ],
            "title": "A stable discontinuous galerkin method for the perfectly matched layer for elastodynamics in first order form",
            "year": 2019
        },
        {
            "authors": [
                "Kenneth Duru",
                "Frederick Fung",
                "Christopher Williams"
            ],
            "title": "Dual-pairing summation by parts finite difference methods for large scale elastic wave simulations in 3d complex geometries",
            "venue": "Journal of Computational Physics,",
            "year": 2022
        },
        {
            "authors": [
                "Kenneth Duru",
                "Leonhard Rannabauer",
                "Alice-Agnes Gabriel",
                "Heiner Igel"
            ],
            "title": "A new discontinuous galerkin method for elastic waves with physically motivated numerical fluxes",
            "venue": "Journal of Scientific Computing,",
            "year": 2021
        },
        {
            "authors": [
                "Kenneth Duru",
                "Leonhard Rannabauer",
                "Alice-Agnes Gabriel",
                "On Ki Angel Ling",
                "Heiner Igel",
                "Michael Bader"
            ],
            "title": "A stable discontinuous galerkin method for linear elastodynamics in 3d geometrically complex elastic solids using physics based numerical fluxes",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 2022
        },
        {
            "authors": [
                "M.L. Falk",
                "A. Needleman",
                "J.R. Rice"
            ],
            "title": "A critical evaluation of cohesive zone models of dynamic fractur",
            "venue": "J. Phys. IV France,",
            "year": 2001
        },
        {
            "authors": [
                "L.B. Freund"
            ],
            "title": "The mechanics of dynamic shear crack propagation",
            "venue": "Journal of Geophysical Research: Solid Earth,",
            "year": 1979
        },
        {
            "authors": [
                "Philippe H. Geubelle",
                "James R. Rice"
            ],
            "title": "A spectral method for three-dimensional elastodynamic fracture problems",
            "venue": "Journal of the Mechanics and Physics of Solids,",
            "year": 1995
        },
        {
            "authors": [
                "R.A. Harris",
                "M. Barall",
                "R. Archuleta",
                "E. Dunham",
                "B. Aagaard",
                "J.P. Ampuero",
                "H. Bhat",
                "V. Cruz-Atienza",
                "L. Dalguer",
                "P. Dawson",
                "S. Day",
                "B. Duan",
                "G. Ely",
                "Y. Kaneko",
                "Y. Kase",
                "N. Lapusta",
                "Y. Liu",
                "S. Ma",
                "D. Oglesby",
                "K. Olsen",
                "A. Pitarka",
                "S. Song",
                "E. Templeton"
            ],
            "title": "The SCEC/USGS Dynamic Earthquake Rupture Code Verification Exercise",
            "venue": "Seismological Research Letters, 80(1):119\u2013126,",
            "year": 2009
        },
        {
            "authors": [
                "Ruth A. Harris",
                "Michael Barall",
                "Brad Aagaard",
                "Shuo Ma",
                "Daniel Roten",
                "Kim Olsen",
                "Benchun Duan",
                "Dunyu Liu",
                "Bin Luo",
                "Kangchen Bai",
                "Jean-Paul Ampuero",
                "Yoshihiro Kaneko",
                "Alice-Agnes Gabriel",
                "Kenneth Duru",
                "Thomas Ulrich",
                "Stephanie Wollherr",
                "Zheqiang Shi",
                "Eric Dunham",
                "Sam Bydlon",
                "Zhenguo Zhang",
                "Xiaofei Chen",
                "Surendra Nadh Somala",
                "Christian Pelties",
                "Josu\u00e9 Tago",
                "Victor Manuel Cruz-Atienza",
                "Jeremy Kozdon",
                "Eric Daub",
                "Khurram Aslam",
                "Yuko Kase",
                "Kyle Withers",
                "Luis Dalguer"
            ],
            "title": "A Suite of Exercises for Verifying Dynamic Earthquake Rupture Codes",
            "venue": "Seismological Research Letters, 89(3):1146\u20131162,",
            "year": 2018
        },
        {
            "authors": [
                "Y. Kaneko",
                "N. Lapusta",
                "J.-P. Ampuero"
            ],
            "title": "Spectral element modeling of spontaneous earthquake rupture on rate and state faults: Effect of velocity-strengthening friction at shallow depths",
            "venue": "Journal of Geophysical Research: Solid Earth,",
            "year": 2008
        },
        {
            "authors": [
                "Boris V Kostrov",
                "Shamita Das"
            ],
            "title": "Principles of earthquake source mechanics",
            "year": 1988
        },
        {
            "authors": [
                "Jeremy E. Kozdon",
                "Eric M. Dunham",
                "Jan Nordstr\u00c3\u00b6m"
            ],
            "title": "Simulation of Dynamic Earthquake Ruptures in Complex Geometries Using High-Order Finite Difference Methods",
            "venue": "Journal of Scientific Computing, 55:92\u2013124,",
            "year": 2013
        },
        {
            "authors": [
                "R. Madariaga",
                "K. Olsen",
                "R. Archuleta"
            ],
            "title": "Modeling dynamic rupture in a 3D earthquake fault model",
            "venue": "Bulletin of the Seismological Society of America, 88(5):1182\u20131197,",
            "year": 1998
        },
        {
            "authors": [
                "J.E. Marsden",
                "T.J.R. Hughes"
            ],
            "title": "Mathematical Foundations of Elasticity",
            "venue": "Dover Publications Inc. New York,",
            "year": 1994
        },
        {
            "authors": [
                "K. Mattsson"
            ],
            "title": "Boundary procedures for summation-by-parts operators",
            "venue": "J. Sci. Comput.,",
            "year": 2003
        },
        {
            "authors": [
                "K. Mattsson"
            ],
            "title": "Diagonal-norm upwind sbp operators",
            "venue": "J. Comput. Phys.,",
            "year": 2017
        },
        {
            "authors": [
                "S. Abarbanel M.H. Carpenter",
                "D. Gottlieb"
            ],
            "title": "Time-stable boundary conditions for finitedifference schemes solving hyperbolic systems: methodology and application to highorder compact schemes",
            "venue": "J. Comput. Phys.,",
            "year": 1994
        },
        {
            "authors": [
                "J. Nordstr\u00f6m",
                "M.H. Carpenter"
            ],
            "title": "High-order finite difference methods, multidimensional linear problems",
            "venue": "J. Comput. Phys.,",
            "year": 2001
        },
        {
            "authors": [
                "David D. Oglesby",
                "Ralph J. Archuleta",
                "Stefan B. Nielsen"
            ],
            "title": "Earthquakes on dipping faults: The effects of broken symmetry",
            "year": 1998
        },
        {
            "authors": [
                "David D. Oglesby",
                "Ralph J. Archuleta",
                "Stefan B. Nielsen"
            ],
            "title": "The Three-Dimensional Dynamics of Dipping Faults",
            "venue": "Bulletin of the Seismological Society of America,",
            "year": 2000
        },
        {
            "authors": [
                "Christian Pelties",
                "Josep de la Puente",
                "Jean-Paul Ampuero",
                "Gilbert B. Brietzke",
                "Martin K\u00e4ser"
            ],
            "title": "Three-dimensional dynamic rupture simulation with a high-order discontinuous galerkin method on unstructured tetrahedral meshes",
            "venue": "Journal of Geophysical Research: Solid Earth,",
            "year": 2012
        },
        {
            "authors": [
                "Marlon D Ramos",
                "Yihe Huang"
            ],
            "title": "How the transition region along the cascadia megathrust influences coseismic behavior: Insights from 2-d dynamic rupture",
            "year": 1973
        },
        {
            "authors": [
                "J.R. Rice"
            ],
            "title": "Constitutive relations for fault slip and earthquake instabilities",
            "venue": "J. Appl. Mech.,",
            "year": 1983
        },
        {
            "authors": [
                "J.R. Rice",
                "A.L. Ruina"
            ],
            "title": "Stability of Steady Frictional Slipping",
            "venue": "Journal of Applied Mechanics,",
            "year": 1983
        },
        {
            "authors": [
                "Andy Ruina"
            ],
            "title": "Slip instability and state variable friction laws",
            "venue": "Journal of Geophysical Research: Solid Earth,",
            "year": 1983
        },
        {
            "authors": [
                "The SCEC/USGS"
            ],
            "title": "Spontaneous rupture code verification project",
            "year": 2022
        },
        {
            "authors": [
                "C.H. Scholz"
            ],
            "title": "Earthquakes and friction",
            "venue": "laws. Nature,",
            "year": 1998
        },
        {
            "authors": [
                "Zheqiang Shi",
                "Steven M Day"
            ],
            "title": "Rupture dynamics and ground motion from 3-d rough-fault simulations",
            "venue": "Journal of Geophysical Research: Solid Earth,",
            "year": 2013
        },
        {
            "authors": [
                "B. Strand"
            ],
            "title": "Summation by parts for finite difference approximations for d/dx",
            "venue": "J. Comput. Phys.,",
            "year": 1994
        },
        {
            "authors": [
                "Ilya Svetlizky",
                "Jay Fineberg"
            ],
            "title": "Classical shear cracks drive the onset of dry frictional motion",
            "venue": "Nature, 509:205\u2013208,",
            "year": 2014
        },
        {
            "authors": [
                "C. Williams"
            ],
            "title": "Dispersion relation preserving fd schemes and self-affine dg elements",
            "venue": "Master\u2019s thesis, The Australian National University,",
            "year": 2021
        },
        {
            "authors": [
                "C. Williams",
                "K. Duru"
            ],
            "title": "Provably stable full-spectrum dispersion relation preserving schemes, 2021",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "Keyword: Dual-pairing summation by parts methods, stability, earthquake rupture, nonlinear friction laws, dispersion relation preserving schemes, high performance computing"
        },
        {
            "heading": "1 Introduction",
            "text": "Numerical simulations of nonlinear frictional sliding along interfaces embedded in elastic solids are of utmost importance in science and engineering [23, 5, 39]. Frictional processes in both industrial materials such as steel pipes, plates and beams, and natural structures like faults in the Earth\u2019s subsurface can lead to failure or disaster. For instance, current\n\u2217Mathematical Sciences Institute, The Australian National University, Australia. \u2020Mathematical Sciences Institute, The Australian National University, Australia, Department of Statistics, University of Oxford \u2021Mathematical Sciences Institute, The Australian National University, National Computational Infrastructure, Australia\nar X\niv :2\n20 7.\n07 89\n1v 1\n[ m\nat h.\nN A\n] 1\nunderstanding of crustal earthquakes is that they nucleate as frictional instabilities on preexisting fault surfaces under slow tectonic loading [3, 39, 25, 42, 8, 36, 37]. Earthquakes occur when two sides of the fault, initially held in contact by a high level of static frictional resistance, slip suddenly when the high level frictional strength catastrophically decreases. Frictional fault-slip generates strong ground shaking which can be carried by seismic (elastic) waves to far field, far away from fault zones. Thus, spontaneously propagating shear ruptures along internal interfaces in elastic solids are a useful idealisation of earthquake source processes [39, 40, 10, 2, 34, 8, 36, 37, 17, 18, 20, 24, 20, 19, 21, 11]. However, this problem is both numerically and computationally challenging, because of the unprecedented large gradients generated by nonlinear coupling of fields across the fault interface and the presence of discontinuous solutions on the fault.\nEfficient and accurate numerical methods are necessary for effective and reliable numerical simulations of nonlinear dynamic shear ruptures in elastic solids. Different numerical methods have been developed [24, 20, 19, 21, 11, 8, 15]. These include standard numerical methods such as spectral method [22], finite element method [31, 32], finite volume method [4], finite difference (FD) method [11, 24, 40], and the discontinuous Galerkin finite element method [7, 15, 33]. They all have different strengths and weaknesses. However, FD methods on structured grids are attractive because they are efficient.\nIn this study, we derive and analyse high order accurate and provably stable FD methods for nonlinear frictional motion at interfaces in elastic solids. We consider the elastic wave equation in first-order form, subject to nonlinear friction laws at interfaces. The corresponding initial boundary value problem (IBVP) supports energy bounded solutions. For energy-stable IBVPs, a standard approach to achieve numerical stability is to derive a discrete energy estimate, by mimicking the procedure in the continuous setting. If such an estimate is possible, numerical stability is ensured. The summation-by-parts (SBP) FD [41] with the simultaneous approximation term (SAT) [29, 27, 30] technique for implementing boundary conditions enables the development of energy-stable numerical approximations.\nThe SBP-SAT FD method, with traditional SBP operators, have been developed for linear elastic waves and nonlinear friction laws [11, 24]. However, traditional SBP FD operators based on central finite difference stencils often suffer from spurious unresolved wave-modes in their numerical solutions. These spurious wave-modes have the potential to destroy the accuracy of numerical solutions. To improve the accuracy of SBP operators, the dualpairing SBP (DP SBP) non-central (upwind) FD stencils were recently introduce in [28, 9]. In [14] these operators were shown to improve the accuracy of the numerical solutions of the 3D elastic wave equations in complex geometries. The main benefit for the DP SBP operators [28, 14] is that they have the potential to suppress poisonous spurious oscillations from unresolved wave-modes, which can destroy the accuracy of numerical simulations on marginally resolved meshes. However, for dynamic shear ruptures composed of discontinuous and/or (nearly) singular exact solutions, numerical errors arising from high order accurate methods may not diminish with increasing mesh resolution, because of \u201dGibbs/Runge\u2019s phenomena\u201d. For these situations carefully designed numerical methods are necessary in order to compute accurate numerical solutions. Consequently, detailed theoretical analysis is needed in order to understand the behaviours of numerical errors and control them.\nIn this paper, our first objective is to derive a provably stable numerical approximation of the elastic wave equation subject to nonlinear friction laws using the DP SBP framework.\nAs in [11, 24], first we construct a subspace of solutions satisfying the (discrete) linear elastodynamics equations and the interface condition exactly. We then project the solutions on the interface to this subspace, extracting data. A main result in this paper is the proof (see Theorem 3) of existence and uniqueness of the interface data for nonlinear friction laws in general anisotropic elastic media. We discretise the 3D elastic wave equation with the DP SBP operators, on boundary-conforming curvilinear meshes, and enforce the nonlinear interface conditions weakly using penalties. Using the energy method and the dual-pairing SBP framework [28, 14, 43, 44], we prove that the numerical method is energy-stable. The proof of energy-stability, however, bounds the growth of the numerical solutions in time but it does not guarantee the convergence of the solution, in particular in the presence of nearly singular and discontinuous exact solutions.\nOur second objective is to perform error analysis. Numerical error analysis for the discrete approximation of the 3D elastic wave equation subject to the nonlinear friction laws at an internal fault/interface, is a nontrivial task. To succeed we will make some simplifying assumptions. However, our analysis are plausible and are able to explain some of the behavior of the error seen in the numerical simulations performed later in this paper. First, we linearise the friction law using a frozen coefficient argument. We derive a priori error estimates and prove the convergence of the numerical error for a linearised friction law. Second, we analyse the dependence of the parity (even/odd) of the operators on the numerical errors. For odd order accurate operators, our error analysis reveals that the DP SBP FD operators [28] have the potential to generate spurious catastrophic high frequency errors that do not diminish with mesh refinement. Numerical simulations in 3D corroborates the theoretical analysis.\nOur third objective is to eliminate the high frequency catastrophic error introduced by the DP SBP FD operators [28]. Using the DP framework, it is possible to design optimised finite difference stencils such that numerical dispersion errors are significantly diminished for all wave numbers. This was the approach taken by the authors in [44] where \u03b1-DRP SBP operators were derived. These DRP SBP operators are designed to guarantee maximum relative error \u2264 \u03b1 for all wave numbers. In particular the \u03b1-DRP SBP operators can resolve the highest frequency (\u03c0-mode) present on any equidistant grid at a tolerance of \u03b1 = 5% maximum error. For explicit schemes, these operators may provide a better resolution than any volume discretisation available today, including spectral methods, and significantly improves on the current standard for traditional operators that have a tolerance of 100% maximum error. The DRP SBP operators [44, 43] potentially eliminates the catastrophic high frequency errors. Numerical simulations performed in 3D corroborates the analysis. Our DRP SBP operators reproduces dynamic rupture benchmark problems, proposed by Southern California Earthquake Center, with less computational effort than standard methods based on traditional SBP operators.\nEfficient and scalable parallel implementation is necessary for effective large scale numerical simulations. The DRP operators are implemented in the large scale code WaveQLab3D [14, 11] with near perfect scaling. The resources used is slightly larger than the 6th order upwind DP and traditional SBP schemes, but not by a large amount. We consider the DRP operators to have a marginal higher cost than the traditional and DP SBP methods.\nThe remaining parts of the paper will proceed as follows. In the next section, we present model equations for linear elastic solids in complex geometries and the nonlinear friction laws coupling the elastic solids at the interface. We also derive energy estimates which a stable\nnumerical method should emulate. In Section 3 we introduce the frictional gluing (hat-) variables and prove the existence and uniqueness of the hat-variables for nonlinear friction laws in general anisotropic elastic solids. In Section 4, we approximate the elastic wave equation in space using the DP SBP operators, numerically enforce the friction laws using penalties and prove numerical stability. In Section 5 we perform numerical error analysis. Numerical simulations are presented in Section 6, corroborating the theoretical analysis. In Section 7 we summarise the results."
        },
        {
            "heading": "2 Physical model",
            "text": "We consider two geometrically complex elastic solids, in the bounded domains \u2126\u2212 and \u2126+, separated by a smooth fault of arbitrarily shaped surface at the interface \u0393F , see Figure 1. The two elastic solids, \u2126\u2212 and \u2126+ are held together at the interface \u0393F by a high level of\nstatic frictional strength. We are particularly interested in accurate modelling and efficient simulation of the dynamics of the fault-interface undergoing a nonlinear frictional sliding, when a load of finite magnitude overcomes the frictional strength at the interface, as well as the numerical computation of the emitted elastic waves propagating in the medium."
        },
        {
            "heading": "2.1 Elastic wave equation in curvilinear coordinates",
            "text": "As in [14, 11], for efficient numerical treatments, we map each complex elastic solids \u2126\u00b1 to a reference unit cube \u2126\u0303\u00b1 defined by the curvilinear coordinates (q, r, s) \u2208 \u2126\u0303 = [0, 1]3, see Figure 1.\nThe Jacobian determinant for the transformation \u03a6\u22121 can be written as\nJ = xq(yrzs \u2212 zrys)\u2212 yq(xrzs \u2212 zrxs) + zq(xrys \u2212 yrxs).\nHere \u03be\u03b7 is the partial derivative \u2202\u03be/\u2202\u03b7 for \u03be, \u03b7 \u2208 {x, y, z, q, r, s}. Similarly,\nqx = 1\nJ (yrzs \u2212 zrys) rx =\n1 J (zqys \u2212 yqzs) sx = 1 J (yqzr \u2212 zqyr),\nqy = 1\nJ (zrxs \u2212 xrzs) ry =\n1 J (xqzs \u2212 zqxs) sy = 1 J (zqxr \u2212 xqzr),\nqz = 1\nJ (zrys \u2212 yrxs) rz =\n1 J (yqxs \u2212 ysxq) sz = 1 J (xqyr \u2212 xryq).\nLetQ = (v,\u03c3)T denote the unknown vector fields in the medium where \u03c3 := (\u03c3xx, \u03c3yy, \u03c3zz\u03c3xy, \u03c3xz, \u03c3yz) T\nis the vector of stresses and v := (vx, vy, vz) T is the particle velocity vector in three space dimensions. The material parameters and the unknown vector fields in the sub-blocks \u2126\u2212 and \u2126+ will be denoted with the superscripts \u2212,+, respectively, that is {Q\u2212,Q+}. Let t \u2265 0 be the time variable. For Q \u2208 {Q\u2212,Q+}, the equation of motion for each sub-block in the transformed curvilinear coordinates (q, r, s) is given by the elastic wave equation\nP\u0303\u22121 \u2202\n\u2202t Q = \u2207 \u00b7 F (Q) + \u2211 \u03be\u2208{q,r,s} B\u03be(\u2207Q), (1)\nwhere\nF\u03be(Q) =  J(\u03bex\u03c3xx + \u03bey\u03c3xy + \u03bez\u03c3xz) J(\u03bex\u03c3xx + \u03bey\u03c3xy + \u03bez\u03c3xz) J(\u03bex\u03c3xx + \u03bey\u03c3xy + \u03bez\u03c3xz)\n0 0 0 0 0 0\n , B\u03be(\u2207Q) = \n0 0 0\nJ\u03bex \u2202vx \u2202\u03be J\u03bey \u2202vy \u2202\u03be J\u03bez \u2202vz \u2202\u03be\nJ(\u03bey \u2202vx \u2202\u03be + \u03bex \u2202vy \u2202\u03be ) J(\u03bez \u2202vx \u2202\u03be + \u03bex \u2202vz \u2202\u03be ) J(\u03bez \u2202vy \u2202\u03be + \u03bey \u2202vz \u2202\u03be )\n , (2)\nwith the gradient operator redefined as \u2207 := ( \u2202 \u2202q , \u2202 \u2202r , \u2202 \u2202s ) and P\u0303 = J\u22121P , where\nP := ( \u03c1\u221211 0 0T C ) , S\u22121 := C. (3)\nHere \u03c1 : \u2126 7\u2192 R+ is the density of the medium, S is the compliance matrix and C is the stiffness matrix of elastic coefficients, present in Hooke\u2019s law. In general anisotropic elastic medium C is described by 21 independent coefficients. If we consider an isotropic elastic medium C will be described the two independent Lame\u0301 parameters \u00b5, \u03bb \u2208 R with \u00b5 > 0, \u03bb > \u2212\u00b5, [1, 26, 11]. However, as shown in [26] (pages 241\u2013243), for strong ellipticity we must have \u00b5 > 0, \u03bb > \u2212\u00b5/2.\nNominally, we will take the positive block to be the \u2018right block\u2019, and the negative block to be the \u2018left block\u2019. We state a lemma which was proven in [16]\nLemma 1 Consider the split spatial operators in the transformed equation (1). The conservative flux term F\u03be(Q) and the non-conservative-products flux term B\u03be(\u2207Q) defined in (1) satisfy the skew-symmetric property, that is\nQTB\u03be (\u2207Q)\u2212 \u2202QT\n\u2202\u03be F\u03be (Q) = 0.\nOn the interface (x0, y0, z0) \u2208 \u0393F , define the positively pointing unit normal vector\nn(x0, y0, z0) = 1\n|q\u03be| qxqy qz \u2223\u2223\u2223 (x0,y0,z0) , |q\u03be| = \u221a q2x + q 2 y + q 2 z . (4)\nThe outward unit normal on the fault for left block \u2126\u2212 is n\u2212 = n, and n+ = \u2212n for right block \u2126+. Define the Cartesian components of the velocity vector v and traction vector T on the fault interface \u0393F\nv = vxvy vz  , T = TxTy Tz  = \u03c3\u0304n, \u03c3\u0304 = \u03c3xx \u03c3xy \u03c3xz\u03c3xy \u03c3yy \u03c3yz \u03c3xz \u03c3yz \u03c3zz  . (5) Another important consequence of the choice of the split spatial operators in the transformed equation (1) is the fact\nQTFq (Q) = J |q\u03be|vTT. (6)\nIntroduce the L2 inner-product \u3008\u00b7, \u00b7\u3009 in the transformed coordinates given through \u3008Q,F\u3009 := \u222b\n\u2126\u0303\n( QTF ) Jdqdrds. (7)\nDefine the mechanical energy in the medium We introduce the weighted L2-norm \u2016Q\u2016P , and mechanical energy E(t) defined by\nE(t) := \u2016Q\u20162P = \u3008Q, 1\n2 P\u0303\u22121Q\u3009 = \u222b \u2126\u0303 ( \u03c1 2 |v|2 + 1 2 \u03c3TS\u03c3 ) Jdqdrds, (8)\nwhere E(t) is the sum of the kinetic energy and the strain energy.\nTheorem 1 Consider the transformed equation of motion (1) defined in the negative and positive elastic blocks, \u2126\u0303\u2212 and \u2126\u0303+. We denote the elastic energy in the elastic blocks by E\u00b1(t) and particle velocity and traction vectors at both sides of the interface \u0393\u0303F by v\n\u00b1, T\u00b1. The total mechanical energy in the medium E(t) = E\u2212 (t) + E+ (t) satisfy\nd\ndt E(t) = ITs = \u2212 \u222b \u0393\u0303F (( v+ )T T+ \u2212 ( v\u2212 )T T\u2212 ) |q\u03be|Jdrds. (9)\nProof 1 For each Q \u2208 {Q\u2212,Q+}, consider\nd dt \u3008Q, 1 2 P\u0303\u22121Q\u3009 = \u222b \u2126\u0303 QT\u2207 \u00b7 F (Q) dqdrqs+ \u2211 \u03be=q,r,s \u222b \u2126\u0303 QTB\u03be (\u2207Q) dqdrqs. (10)\nOn the left hand side of (10) we recognize time derivative of the energy. On the right hand side of (10), we integrate the conservative flux term by parts and ignore contributions from the boundaries in the r- and s-directions, we have\nd dt \u3008Q, 1 2 P\u0303\u22121Q\u3009 = \u2211 \u03be=q,r,s \u222b \u2126\u0303 [ QTB\u03be (\u2207Q)\u2212 \u2202QT \u2202\u03be F\u03be (Q) ] dqdrds (11)\n+ \u222b 1 0 \u222b 1 0 ( vTT|q\u03be|J \u2223\u2223\u2223 q=1 \u2212 vTT|q\u03be|J \u2223\u2223\u2223 q=0 ) drds.\nBy Lemma 1, the volume terms in (11) vanish. Collecting contributions from both sides of\nthe interface and considering boundary terms only from the fault interface \u0393\u0303F having\nd\ndt E(t) = ITs = \u2212 \u222b \u0393\u0303F (( v+ )T T+ \u2212 ( v\u2212 )T T\u2212 ) |q\u03be|Jdrds. (12)\nNext, we will discuss frictional interface conditions coupling the two blocks at the interface, \u0393F . In general, friction laws are designed such that the interface term is never positive ITs \u2264 0, and dissipates the mechanical energy in the medium."
        },
        {
            "heading": "2.2 Frictional interface conditions",
            "text": "Here, we prescribe the nonlinear frictional interface conditions coupling the elastic solids. On the interface (x0, y0, z0) \u2208 \u0393F , consider the positively pointing unit normal vector n(x0, y0, z0) defined in (4). Next we form a locally spanning orthonormal basis with the vectors m(x0, y0, z0) and l(x0, y0, z0) given through a change of variable to the computational space\nm (x0, y0, z0) := m0 \u2212 \u3008n,m0\u3009n |m0 \u2212 \u3008n,m0\u3009n| \u2223\u2223\u2223 (x0,y0,z0) , l (x0, y0, z0) := n\u00d7m \u2223\u2223\u2223 (x0,y0,z0) ,\nwhere m0 is a vector not in the span of n. We often drop the evaluation point when this is clear from context.\nFor each point (x0, y0, z0) on the interface, we denote the particle velocity and traction vectors at both sides of the interface \u0393\u0303I by v \u00b1, T\u00b1. Thus T\u2212 is the traction exerted by the\nleft block on the fault interface and \u2212T+ is the traction exerted by the right block on the fault interface. Rotate the traction and particle velocity into the local orthonormal basis vector v\u00b1nv\u00b1m\nv\u00b1`  = Rv\u00b1, T\u00b1nT\u00b1m T\u00b1`  = RT\u00b1, R = nTmT lT  . (13) Note that R\u22121 = RT .\nNewtonian physics imposes the force balance condition\nT\u2212 = \u2212(\u2212T+) = T+ \u21d0\u21d2 T\u2212j = T+j = Tj, j \u2208 {n,m, l}. (14)\nThe particle velocity can be discontinuous across the interface, hence we define the jump of velocities across the interface by\n[[vj]] := v + j \u2212 v\u2212j , j \u2208 {l,m, n}. (15)\nIt is assumed that the interface does not open, that is\n[[vn]] := 0 for all t \u2208 [0, T ], (16)\nWe allow for shear ruptures. Hence the magnitude of the slip rate V and the shear strength \u03c4 are calculated by\nV = ( [[vl]] 2 + [[vm]] 2)1/2 , \u03c4 = (T 2m + T 2l )1/2 . (17)\nDefine the compressive-norm-stress \u03c3n := \u2212Tn > 0, on the interface. The shear strength \u03c4 is constrained by the frictional constitutive relation\n\u03c4 = f(V, \u03c8)\u03c3n, (18)\nwhere f(V, \u03c8) > 0 is a generic nonlinear friction, coefficient encapsulated in the rate-andstate framework, V is the slip-rate, and \u03c8 is a state variable that will be defined below. Further, we assume that the motion is parallel to the shear traction (forces), that is\nTj \u03c4 = [[vj]] V , j \u2208 {l,m}, (19)\nand we have\nTj = \u03b1[[vj]], \u03b1(V, \u03c3n, \u03c8) = \u03c3n f(V, \u03c8)\nV \u2265 0, j \u2208 {l,m}. (20)\nThe functional \u03b1 \u2265 0 parameterises the frictional strength of the fault interface. Note that \u03b1\u2192\u221e =\u21d2 V \u2192 0, any load of finite magnitude can never overcome the frictional strength and break the interface. The interface conditions can be summarised as:\nForce balance, T\u2212j = T + j = Tj; (21)\nNo opening, [[vn]] = 0; (22)\nFriction law, Tj = \u03b1[[vj]], \u03b1 = \u03c3n f(V, \u03c8)\nV \u2265 0, j \u2208 {l,m}. (23)\nTheorem 2 (Theorem 1, [11]) Consider the transformed equation of motion (1) defined in the negative and positive elastic blocks, \u2126\u0303\u2212 and \u2126\u0303+, subject to the nonlinear interface conditions (21)\u2013(23) at the interface \u0393\u0303I . We denote the mechanical energy in the medium by E\u00b1(t). The total mechanical energy in the medium E(t) = E\u2212 (t) + E+ (t) satisfy\nd\ndt E(t) = ITs = \u2212 \u222b \u0393\u0303F \u03b1|V |2 J |q\u03be|drds \u2264 0, \u03b1|V |2 = \u03c3n V f(V, \u03c8) \u2265 0. (24)\nProof 2 The proof follows from Theorem 9 and the interface conditions (21)\u2013(23). Consider the interface term in (9) with force balance (21), we have\nITs = \u2212 \u222b\n\u0393\u0303I\n(Tl[[vl]] + Tm[[vm]] + Tn[[vn]]) |q\u03be|Jdr ds.\nThe no opening condition [[vn]] = 0 and the friction law (23) yield the result ITs = \u2212 \u222b\n\u0393\u0303F\n\u03b1|V |2 J |q\u03be|dr ds < 0, \u03b1 = \u03c3n f(V, \u03c8)\nV \u2265 0.\nIn particular, the interface term ITs encodes the rate of work done by friction on the fault which is dissipated as heat. Note that Theorem 2 proves that friction dissipates energy and the solutions of IBVP are bounded. This does not prove well-posedness of IBVP, though. The proof of well-posedness of IBVPs for non-linear friction laws is beyond the scope of this work.\nBelow we will describe typical non-linear friction laws considered in this study."
        },
        {
            "heading": "2.2.1 Slip-weakening friction law",
            "text": "We will consider first the slip-weakening friction law [2]. This is a regularisation of Coulomb\u2019s friction, and it is widely used in applications e.g., to model megathrust earthquake dynamics [34]. The interface is held initially by a high-level of static friction coefficient, and the evolving friction coefficient weakens linear with slip S until it reaches the dynamic friction coefficient, as\nf (S) =\n{ fs \u2212 (fs \u2212 fd) Sdc , if S \u2264 dc,\nfd, if S \u2265 dc, (25)\nwhere 0 < fd < fs are the dynamic and static friction coefficients, dc > 0 is the critical slip-distance. The slip S evolves according to\ndS dt = V, (26)\nwhere V is the absolute slip-rate defined in (17). We introduce the peak frictional strength on the fault \u03c4p = fs\u03c3n and the residual frictional strength on the fault \u03c4r = fd\u03c3n, where \u03c3n > 0 is the compressive-normal-stress. By (25), as soon as the load on the fault exceeds the peak strength \u03c4p, the interface will begin to slip and the frictional strength will weaken linearly with slip S, until slip reaches the critical slip-distance dc. When the fault is fully weakened its residual strength is \u03c4r. After yielding, the rupture will spread to adjacent parts of the fault and will be arrested when it meets unfavourable conditions due to geometrical or stress asperities."
        },
        {
            "heading": "2.2.2 Rate-and-state friction law",
            "text": "Modern nonlinear friction laws are encapsulated in the rate-and-state framework (18), \u03c4 = f(V, \u03c8)\u03c3n with f(V, \u03c8) \u2265 0, f (0, \u03c8) = 0 and \u2202f (V, \u03c8) /\u2202V > 0. Here, \u03c3n > 0 is the compressive-normal-stress f (V, \u03c8) is the nonlinear friction coefficient, V is the slip-rate, and \u03c8 is the state variable. We consider formulations in which the state variable \u03c8 is nondimensional and is governed by the generic state evolution equation\nd\u03c8 dt = g (V, \u03c8) . (27)\nIn general f (V, \u03c8) and g (V, \u03c8) are empirical expressions obtained from laboratory experiments [8, 35, 36]. A typical rate-and-state friction coefficient is [17]\nf(V, \u03c8) = a arcsinh\n( V\n2V0 e\u03c8/a\n) , (28)\nwhere the friction parameters a and V0 are real and positive. These parameters will be described below. Note that f(V, \u03c8) \u2265 0, for all \u03c8. Common evolution laws for the state variable \u03c8 are: [37]\n1. aging law:\ng(V, \u03c8) = bV0 dc\n( e(f0\u2212\u03c8)/b \u2212 V\nV0\n) ; and, (29)\n2. slip law:\ng(V, \u03c8) = \u2212V dc (f(V, \u03c8)\u2212 fss(V )) , (30)\nwhere fss(V ) is an arbitrary steady state friction coefficient. Some commonly used forms of the steady state friction coefficient are the standard expression [17]\nfss(V ) = f0 \u2212 (b\u2212 a) ln V\nV0 . (31)\nThere is also the strongly rate-weakening friction law [10], but this will not be used in this work. Here, a is the direct effect parameter, b is evolution effect parameter, V0 is the reference slip velocity, dc is the state-evolution distance, f0 is the steady state friction coefficient at V0."
        },
        {
            "heading": "3 Frictional Gluing Variables (Hat-variables)",
            "text": "We aim to construct a consistent and stable discrete approximation of the IBVP such that a discrete energy estimate analogous to Theorem 2 can be derived. Some of the discussions here can be found in [11]. We have however included the details in order to have a self-contained narrative. The new result in this section is Theorem 3, which proves the existence and uniqueness of the frictional gluing variables for nonlinear friction laws in general anisotropic media.\nAs in [11], we will construct a numerical treatment of the interface without introducing stiffness such that the semi-discrete problem can be integrated efficiently using an explicit time-stepping method. We will reformulate the interface condition by introducing transformed (hat-) variables so that we can simultaneously construct (numerical) boundary/interface data for particle velocities and traction. The hat-variables encode the solution of the IBVP on the interface. The hat-variables will be constructed such that they preserve the amplitude of the outgoing characteristics and exactly satisfy the physical boundary conditions [11].\nLet vj, Tj be the velocity and traction vectors at the fault interface, with j \u2208 {l,m, n}. For Zj > 0, we define the characteristics\nqj = 1\n2 (Zjvj + Tj) , pj =\n1 2 (Zjvj \u2212 Tj) , j \u2208 {l,m, n}. (32)\nHere, qj are the left going characteristics and pj are the right going characteristics. The outgoing characteristics at the interface are\nq+j = 1\n2\n( Z+j v + j + T + j ) , p\u2212j = 1\n2\n( Z\u2212j v \u2212 j \u2212 T\u2212j ) , j \u2208 {l,m, n}. (33)\nThe characteristics are viewed as functions of velocity, traction and impedance. We define the hat-variables v\u0302\u00b1j , T\u0302 \u00b1 j preserving the amplitude of the outgoing characteristics at the interface to be\nq\u0302+j ( v\u0302+j , T\u0302 + j , Z + j ) := q+j ( v+j , T + j , Z + j ) , p\u0302\u2212j ( v\u0302\u2212j , T\u0302 \u2212 j , Z \u2212 j ) := p\u2212j ( v\u2212j , T \u2212 j , Z \u2212 j ) . (34)\nThe hat-variables also satisfy the interface conditions, (21)\u2013(23), exactly. Given q+j , p \u2212 j , the procedure will solve (34) and (21)\u2013(23) for the hat-variables, v\u0302\u00b1j , T\u0302 \u00b1 j .\nCombining the two equations in (34) and ensuring force balance, T\u0302\u2212j = T\u0302 + j = T\u0302j, we have\nT\u0302j + \u03b7j[[v\u0302j]] = \u03a6j, \u03a6j = \u03b7j\n( 2\nZ+j q+j \u2212\n2\nZ\u2212j p\u2212j\n) , \u03b7j = Z+j Z \u2212 j\nZ+j + Z \u2212 j\n> 0, j \u2208 {l,m, n}.\n(35)\nHere, \u03a6j are the stress transfer functionals, that is stresses on a locked interface when [[v\u0302j]] = 0. And by (35), the stresses will be altered by wave radiations when the fault is slipping [[v\u0302j]] 6= 0.\nIntroducing the compressive normal-stress \u03c3\u0302n = \u2212T\u0302n, as before we have\nForce balance, T\u0302j + \u03b7j[[v\u0302j]] = \u03a6j, j \u2208 {l,m, n}; (36) No opening, [[v\u0302n]] = 0; (37) Friction law, T\u0302j = \u03b1\u0302[[v\u0302j]], j \u2208 {l,m}, \u03b1\u0302 ( V\u0302 ) = \u03c3\u0302n f ( V\u0302 , \u03c8 ) V\u0302 , V\u0302 = ( [[v\u0302l]] 2 + [[v\u0302m]] 2)1/2 .\n(38)\nWe need to solve (36)\u2013(38) for the hat-functions T\u0302j and [[v\u0302j]]. In the normal direction j = n, we have closed form solutions\n[[v\u0302n]] = 0, T\u0302n = \u03a6n.\nIn the tangential directions we have four coupled algebraic equations to solve\nT\u0302j + \u03b7j[[v\u0302j]] = \u03a6j, T\u0302j = \u03b1\u0302[[v\u0302j]], j \u2208 {l,m}. (39)\nNext, using\n[[v\u0302j]] = (\u03b7j + \u03b1\u0302) \u22121 \u03a6j, j \u2208 {l,m}, (40)\nwe obtain a nonlinear algebraic problem for the absolute slip-rate V\u0302\u221a (\u03b7lV\u0302 + \u03b1\u0302V\u0302 )\u22122\u03a62l + (\u03b7mV\u0302 + \u03b1\u0302V\u0302 ) \u22122\u03a62m = 1. (41)\nOnce we compute the absolute slip-rate V\u0302 from (41), we can determine T\u0302j and [[v\u0302j]] from (39) and (40). Finally we have\nT\u0302\u2212j = T\u0302 + j = T\u0302\u03b7, v\u0302 + j =\n2p\u2212j + T\u0302j\nZ\u2212j + [[v\u0302j]], v\u0302\n\u2212 j = 2q+j \u2212 T\u0302j Z+j \u2212 [[v\u0302j]] (42)\nWe have equivalently redefined the interface condition\nv\u00b1j = v\u0302 \u00b1 j , T \u00b1 j = T\u0302j, (43)\nBy construction, the hat-variables v\u0302\u00b1j , T\u0302 \u00b1 j satisfy the following algebraic identities:\nqj ( v\u0302+j , T\u0302 + j , Z + j ) = qj ( v+j , T + j , Z + j ) , p\u03b7 ( v\u0302\u2212j , T\u0302 \u2212 j , Z \u2212 j ) = pj ( v\u2212j , T \u2212 j , Z \u2212 j ) , (44)\n( q2j ( v+j , T + j , Z + j )) \u2212 p2j ( v\u0302+j , T\u0302 + j , Z + j ) = Z+j T\u0302j v\u0302 + j , p 2 j ( v\u2212j , T \u2212 j , Z \u2212 j ) \u2212 q2j ( v\u0302\u2212j , T\u0302 \u2212 j , Z \u2212 j ) = \u2212Z\u2212j T\u0302j v\u0302\u2212j ,\n(45)\n1\nZ+j\n( q2j ( v+j , T + j , Z + j ) \u2212 p2j ( v\u0302+j , T\u0302 + j , Z + j )) + 1\nZ\u2212j\n( p2j ( v\u2212j , T \u2212 j , Z \u2212 j ) \u2212 q2j ( v\u0302\u2212j , T\u0302 \u2212 j , Z \u2212 j )) = T\u0302j[[v\u0302j]],\n(46)\nT\u0302n[[v\u0302n]] = 0, T\u0302j[[v\u0302j]] = \u03b1\u0302\n(\u03b7j + \u03b1\u0302) 2 \u03a6 2 j \u2265 0, j \u2208 {l,m}, (47)\u2211\nj\u2208{l,m,n}\nT\u0302j[[v\u0302j]] = \u2211\nj\u2208{l,m}\n\u03b1\u0302\n(\u03b7j + \u03b1\u0302) 2 \u03a6\n2 j = \u03b1\u0302|V\u0302 |2 \u2265 0. (48)\nWe note that hat-variables (v\u0302\u00b1, T\u0302 ) involve the computation of V\u0302 , which is the solution of the nonlinear algebraic problem (41) for nonlinear friction laws. It is, however, not obvious if there is a solution for (41), and if the solution is unique in general media with 0 < \u03b7m 6= \u03b7l > 0. As we will show below, under the assumptions given for the nonlinear friction coefficient f(V, \u03c8), we can prove that the nonlinear algebraic problem (41) has a unique solution in general anisotropic elastic media.\nConsider the derived quantities (v\u00b1, T\u00b1) defined on the fault interface \u0393F associated to a solution (v\u00b1,\u03c3\u00b1) that solves the IVP without the specified interface conditions. As we have not yet specified the interface conditions for (v\u00b1, T\u00b1), the IBVP across the two blocks is under-determined and multiple solutions (v\u00b1, \u03c3\u00b1) could exist. We will formulate a projection operator P that maps (v\u00b1, T\u00b1) to a (hat-) quantity (v\u0302\u00b1, T\u0302 ) which are uniquely determined. The hat-quantities additionally satisfy the interface conditions given in (39)\u2013(40) of the rupturing fault. We now make the discussion more formal. Let (v\u00b1, \u03c3\u00b1) be a solution on \u2126 of (1) corresponding to a derived quantity (v\u00b1, T\u00b1). In the following discussion, assume that all solutions (v\u00b1, \u03c3\u00b1) obey the linear elastic wave equation (1). Define\nU := {(v\u00b1, T\u00b1) | (v\u00b1, \u03c3\u00b1) satisfies the Cauchy problem (1) without the interface conditions (39)\u2013(40)},\nand U\u0302 := U \u2229 {(v\u0302\u00b1, T\u0302 ) | (v\u0302\u00b1, T\u0302 ) satisfies (39)\u2013(40)},\nthen U\u0302 \u2282 U . We require P : U 7\u2192 U\u0302 . Define the projection operator P through\nP ((v\u00b1, T\u00b1)) = (v\u0302\u00b1, T\u0302 ) (49)\nwhere (v\u0302\u00b1, T\u0302 ) is obtained by solving (41) for V\u0302 and following the procedure described above. Under reasonable assumptions of the interface and boundary conditions, like those given above, we can prove well-posedness of this projection operator.\nTheorem 3 Let P : U 7\u2192 U\u0302 be as described in (41) and assume the interface conditions previously given. Assume that the friction co-efficient function f obeys f(V, \u03c8) \u2265 0, f (0, \u03c8) = 0 and \u2202f (V, \u03c8) /\u2202V > 0. Then the operator P is continuous, U 6= \u2205, and |U\u0302 | = 1.\nProof 3 The set of functions U is non-empty as this contains the case of isotropic linear elasticity, with \u03b7l = \u03b7m = \u03b7 > 0, studied in [11]. Now consider the continuous function \u0398 : (0,\u221e) 7\u2192 (0,\u221e) given through\n\u0398(\u03b8) := \u221a\n(\u03b7l\u03b8 + \u03c3\u0302nf(\u03b8, \u03c8))\u22122\u03a62l + (\u03b7m\u03b8 + \u03c3\u0302nf(\u03b8, \u03c8)) \u22122\u03a62m. (50)\nThe function \u0398 obeys: lim\u03b8\u21920+ \u0398(\u03b8) =\u221e; lim\u03b8\u2192\u221e\u0398(\u03b8) = 0; and is (strictly) monotonically decreasing. Therefore the level set {\u03b8\u2217 | \u0398(\u03b8\u2217) = 1} contains precisely one element, call this"
        },
        {
            "heading": "V\u0302 . Equations (39)\u2013(40) are completely determined by V\u0302 , showing |U\u0302 | = 1. Finally, as P projects to a unique element, it is a continuous operator.",
            "text": "Remark 1 Theorem 3 proves existence and uniqueness of the hat-variables for nonlinear friction laws in general anisotropic elastic solids, as conjectured in [11].\nWe conclude this section by reformulating Theorem 2 in terms of the hat-variables.\nTheorem 4 Let E\u00b1 be given in (8) and (q, r, s) be the transformed curvilinear coordinates. Define E(t) := E+(t) + E\u2212(t), then\nd\ndt E(t) = ITs = \u2212 \u222b \u0393\u0303F \u03b1\u0302|V\u0302 |2J |q\u03be|dr ds \u2264 0. (51)\nProof 4 The proof is similar the proof of Theorem 2. Consider the interface term in (9) and impose the transformed interface conditions (43), that is\nv\u00b1j = v\u0302 \u00b1 j , T \u00b1 j = T\u0302j,\nwe have\nITs = \u2212 \u222b\n\u0393\u0303F\n( T\u0302l[[v\u0302l]] + T\u0302m[[v\u0302m]] + T\u0302n[[v\u0302n]] ) |q\u03be|Jdrds. (52)\nThe no opening condition [[v\u0302n]] = 0 and the identities (47)\u2013(48) yield the result\nITs = \u2212 \u222b\n\u0393\u0303F  \u2211 j\u2208{l,m}\n\u03b1\u0302\n(\u03b7j + \u03b1\u0302) 2 \u03a6\n2 j  J |q\u03be|dr ds = \u2212\u222b \u0393\u0303F \u03b1\u0302|V\u0302 |2J |q\u03be|dr ds \u2264 0. (53)"
        },
        {
            "heading": "4 DP SBP numerical approximation",
            "text": "In this section, we derive high order accurate and stable discrete numerical approximation of the elastic wave equation (1) in curvilinear coordinates subject to the nonlinear friction laws (21)\u2013(23) on the fault. We will discretise the spatial derivatives using SBP finite difference\noperators formulated in the DP framework [28, 14, 44]. In particular, the standard DP upwind SBP operators [28] and the recently derived \u03b1-DRP SBP operators [44] both satisfy the DP SBP property and will be used. The DP SBP operators come in pairs, the forward difference operator D+ and the backward difference operator D\u2212. As in [14] we will carefully combine the DP SBP operators to preserve, in the discrete setting, the skew-symmetric property given in Lemma 1. Our primary objective is to numerically implement the nonlinear friction laws (21)\u2013(23) using penalties such that we can prove energy-stability similar to the continuous analogue Theorem 4."
        },
        {
            "heading": "4.1 DP and upwind SBP operators for approximating spatial deriva-",
            "text": "tive\nIn [14] the term DP SBP operator was introduced. For our discussions to be self-contained we will also formally define the DP SBP framework. Firstly, discretise the reference computational cube \u2126\u0303 = [0, 1]3 with an evenly spaced mesh across each axis, \u03be = q, r, s. We will treat the left and right unit cubes independently in the discretisation, and use penalties, with the friction law (21)\u2013(23), to glue them together. For each \u03be \u2208 {q, r, s}, consider the uniform discretisation of the unit interval \u03be \u2208 [0, 1]\n\u03bei := i/n\u03be, i \u2208 {0, . . . , n\u03be}, (54)\nwhere n\u03be + 1 is the number of grid-points on the \u03be-axis. We will use DP SBP operators [28, 14, 44, 9] to approximate the spatial derivatives, \u2202/\u2202\u03be. For each \u03be \u2208 {q, r, s} define H\u03be := diag ( h (\u03be) 0 , . . . , h (\u03be) n\u03be ) , with h (\u03be) j > 0 for all j \u2208 {0, 1, . . . , n\u03be}. We consider the DP derivative operators D+\u03be, D\u2212\u03be : Rn\u03be+1 7\u2192 Rn\u03be+1 so that the SBP property holds\n(D+\u03bef) TH\u03beg + f TH\u03be(D\u2212\u03beg) = f(\u03ben\u03be)g(\u03ben\u03be)\u2212 f(\u03be0)g(\u03be0), (55)\nwhere f = (f(\u03be0), . . . , f(\u03ben\u03be)) T , g = (g(\u03be0), . . . , g(\u03ben\u03be)) T are vectors sampled from weakly differentiable functions of the \u03be variable. Introduce the matrices\nB = ene T n \u2212 e1eT1 , e1 := (1, 0, . . . , 0)T , en := (0, . . . , 0, 1)T ,\nQ+\u03be = H\u03beD+\u03be \u2212 1\n2 B, Q\u2212\u03be = H\u03beD\u2212\u03be \u2212\n1 2 B. (56)\nDefinition 1 Let D\u2212\u03be, D+\u03be, Q\u2212\u03be, Q+\u03be : Rn\u03be 7\u2192 Rn\u03be be linear operators that solve Equations (55) and (56) for a diagonal weight matrix H\u03be \u2208 Rn\u03be\u00d7n\u03be . If the matrix S+ := Q+\u03be +QT+\u03be is negative semi-definite and S\u2212 := Q\u2212\u03be +Q T \u2212\u03be is positive semi-definite, then the 3-tuple (H\u03be, D\u2212\u03be, D+\u03be) is called an upwind diagonal-norm DP SBP operator.\nWe call (H\u03be, D\u2212\u03be, D+\u03be) an upwind diagonal-norm DP SBP operator of order m if the accuracy conditions\nD\u03b7\u03be(\u03be i) = i\u03bei\u22121 (57)\nare satisfied for all i \u2208 {0, . . . ,m} and \u03b7 \u2208 {\u2212,+} where \u03bei := (\u03bei0, . . . , \u03bein\u03be) T .\nThe 1D SBP operators can be extended to higher space dimensions using tensor products \u2297. Let f(q, r, s) denote a 3D scalar function, and fijk := f(qi, rj, sk) denote the corresponding 3D grid function. The 3D scalar grid function fijk is rearranged row-wise as a vector f of length nqnrns. For \u03be \u2208 {q, r, s} and \u03b7 \u2208 {\u2212,+} define:\nD\u03b7q = (D\u03b7q \u2297 Inr \u2297 Ins) , D\u03b7r = ( Inq \u2297D\u03b7r \u2297 Ins ) , D\u03b7s = ( Inq \u2297 Inr \u2297D\u03b7s ) , H = (Hq \u2297Hr \u2297Hs) ,\nwhere In\u03be is the identity matrix of size n\u03be\u00d7n\u03be. The matrix operator D\u03b7\u03be will approximate the partial derivative operator in the \u03be direction. A discrete inner product on Rnq+1 \u00d7 Rnr+1 \u00d7 Rns+1 is induced by H through\n\u3008g,f\u3009H := g THf = nq\u2211 i=0 nr\u2211 j=0 ns\u2211 k=0 fijkgijkh (q) i h (r) j h (s) k , (58)\nand the discrete energy-norm for the elastic wave equation is given by \u2016Q (\u00b7, \u00b7, \u00b7, t) \u20162HP = \u2329 Q, 1\n2 P\u22121Q \u232a H . (59)"
        },
        {
            "heading": "4.2 Numerical approximation in space",
            "text": "We consider the transformed elastic wave equation (1) in a reference computational cube (q, r, s) \u2208 [0, 1]3, and approximate the spatial operators using the upwind SBP operators. We introduce compact notations by rearranging every 3D scalar grid function row-wise as a vector of length nqnrns and the unknown vector field Q is a vector of length 9nqnrns. As in [14, 44], the backward difference operator D\u2212\u03be is used to approximate the spatial derivative for the conservative flux term, and the forward difference operator D+\u03be approximates derivatives in the non-conservative product term. For Q \u2208 {Q\u2212,Q+}, we have\nP\u0303\u22121 d\ndt Q =\u2207D\u2212 \u2022 F (Q) + \u2211 \u03be\u2208{q,r,s} B\u03be ( \u2207D+Q ) , (60)\nwhere the discrete operator \u2207D\u03b7 = (D\u03b7q,D\u03b7r,D\u03b7s) T , with \u03b7 \u2208 {+,\u2212}, is analogous to the continuous gradient operator \u2207 = (\u2202/\u2202q, \u2202/\u2202r, \u2202/\u2202s)T . Note that the numerical solutions {Q\u2212,Q+} in the two blocks are unconnected, and independent of each other. Numerical implementation of the nonlinear interface conditions, discussed in the next subsection, will be used to coupled them together.\nWe state the discrete equivalence of Lemma 1 which was proven in [14].\nLemma 2 (Lemma 4.2 in [14]) Consider the semi-discrete approximation given in (60). We have the discrete skew-symmetric form(\n((I9 \u2297D+\u03be)Q)T F\u03be (Q)\u2212QTB\u03be ( \u2207D+Q )) = 0.\nFor a 2D scalar field fjk = f(yj, zk) we also introduce the surface cubature\nIq (f) = nr\u2211 j=0 ns\u2211 k=0 Jjk \u221a q2xjk + q 2 yjk + q 2 zjkfjkh (r) j h (s) k , (61)\nand IT ( (v+)TT+ \u2212 (v\u2212)TT\u2212 ) = nr\u2211 j=0 ns\u2211 k=0 Jjk \u221a q2xjk + q 2 yjk + q 2 zjk ( (v+jk) TT+jk \u2212 (v \u2212 jk) TT\u2212jk ) h (r) j h (s) k .\n(62) The interface surface term ITs ( (v+)TT+ \u2212 (v\u2212)TT\u2212 ) is a numerical approximation of the continuous analogue ITs defined in (9).\nTheorem 5 Consider the semi-discrete approximation (60) of the elastic wave equation. We have\nd\ndt\n( \u2016Q\u2212 (\u00b7, \u00b7, \u00b7, t) \u20162HP + \u2016Q+ (\u00b7, \u00b7, \u00b7, t) \u20162HP ) = \u2212IT ( (v+)TT+ \u2212 (v\u2212)TT\u2212 ) ,\nwhere ITs ( (v+)TT+ \u2212 (v\u2212)TT\u2212 ) is the surface term defined in (62).\nProof 5 For Q \u2208 {Q\u2212,Q+} consider\nd dt \u2016Q (\u00b7, \u00b7, \u00b7, t) \u20162HP =\n\u2329 Q, P\u22121 \u2202\n\u2202t Q \u232a H = \u2329 Q,\u2207D\u2212 \u2022 F (Q) + \u2211 \u03be\u2208{q,r,s} B\u03be ( \u2207D+Q )\u232a H . (63)\nExpanding the right hand side, applying the SBP property (55) and ignoring contributions from the boundaries in the r- and s-directions gives\u2211 \u03be\u2208{q,r,s} (\u2329 Q, (I9 \u2297D\u2212\u03be)F\u03be (Q)\u3009H + \u2329 Q,B\u03be ( \u2207D+Q ))\u232a H\n) = Iq ( vTT ) \u2223\u2223\u2223 q=1 \u2212 Iq ( vTT ) \u2223\u2223\u2223 q=0 + \u2211\n\u03be\u2208{q,r,s}\n(\u2329 Q,B\u03be(\u2207D+Q) \u232a H \u2212 \u3008(I9 \u2297D+\u03be)Q,F\u03be(Q)\u3009H ) ,\nwhich from Lemma 2 gives,\nd dt \u2016Q (\u00b7, \u00b7, \u00b7, t) \u20162HP = Iq\n( vTT ) \u2223\u2223\u2223 q=1 \u2212 Iq ( vTT ) \u2223\u2223\u2223 q=0 . (64)\nCollecting contribution from both sides of the interface and considering boundary terms only at the interface gives the result."
        },
        {
            "heading": "4.3 Numerical interface treatment",
            "text": "In this section, we will discuss the numerical implementation of the nonlinear interface conditions (43) using the SAT penalty method. The procedure is similar to the method derived in [11] using traditional SBP operators. Here we extend the procedure to the DP\nSBP framework [14, 44]. First, we will construct interface data, v\u0302\u03b7, T\u0302\u03b7, as discussed in section 3 and derive the SAT penalty terms by penalizing data, that is v\u0302\u03b7, T\u0302\u03b7, against the in-going waves only. The SAT terms are appended to the semi-discrete problem (60) with appropriate penalty parameters such that a discrete energy estimate, similar to Theorem 4, is derived.\nConsider Q \u2208 {Q\u2212,Q+}, the semi-discrete approximation of the elastic wave equation (1) with the weak enforcement of the interface conditions is\nP\u0303\u22121 d\ndt Q =\u2207D\u2212 \u2022 F (Q) + \u2211 \u03be\u2208{q,r,s} B\u03be ( \u2207D+Q ) + SATq ( v \u2212 v\u0302,T\u2212 T\u0302 ) . (65)\nHere SATq is the SAT penalty term enforcing the fault interface conditions. Below, we will derive the explicit form of the SAT terms, SATq.\nIntroduce the penalisation terms\nG+\u03b7 = 1 2 Z+\u03b7 ( v+\u03b7 \u2212 v\u0302+\u03b7 ) \u2212 1 2 ( T+\u03b7 \u2212 T\u0302+\u03b7 ) , G\u0303+\u03b7 := 1 Z\u03b7 G+\u03b7 , (66) G\u2212\u03b7 = 1 2 Z\u2212\u03b7 ( v\u2212\u03b7 \u2212 v\u0302\u2212\u03b7 ) + 1 2 ( T\u2212\u03b7 \u2212 T\u0302\u2212\u03b7 ) , G\u0303\u2212\u03b7 := 1 Z\u03b7 G\u2212\u03b7 .\nThe penalty terms are computed in the transformed coordinates l,m, n, and will be rotated to the physical coordinates x, y, z. We have\nG := GxGy Gz  = RT GnGm Gl  , G\u0303 := G\u0303xG\u0303y G\u0303z  = RT G\u0303nG\u0303m G\u0303l  , (67) where G \u2208 {G\u2212,G+}. Note that((\nv+ )T G+ \u2212 ( T+ )T G\u0303+ + ( v+ )T ( T+ )) = \u2211\n\u03b7\u2208{l,m,n}\n( 1\nZ+\u03b7 |G+\u03b7 |2 + T\u0302+\u03b7 v\u0302+\u03b7\n) ,\n(( v\u2212 )T G\u2212 + ( T\u2212 )T G\u0303\u2212 \u2212 ( v\u2212 )T ( T\u2212 )) = \u2211\n\u03b7\u2208{l,m,n}\n( 1\nZ\u2212\u03b7 |G\u2212\u03b7 |2 \u2212 T\u0302\u2212\u03b7 v\u0302\u2212\u03b7\n) .\n(68)\nWe introduce the SAT vectors that match the eigen\u2013structure of the elastic wave equation\nSAT+ = \nG+x G+y G+z\n\u2212nxG\u0303+x , \u2212nyG\u0303+y \u2212nzG\u0303+z ,\n\u2212 ( nyG\u0303 + x + nxG\u0303 + y ) \u2212 ( nzG\u0303 + x + nxG\u0303 + z\n) \u2212 ( nzG\u0303 + y + nyG\u0303 + z )\n , SAT\u2212 = \nG\u2212x G\u2212y G\u2212z\nnxG\u0303 \u2212 x , nyG\u0303 \u2212 y\nnzG\u0303 \u2212 z ,(\nnyG\u0303 \u2212 x + nxG\u0303 \u2212 y )( nzG\u0303 \u2212 x + nxG\u0303 \u2212 z\n)( nzG\u0303 \u2212 y + nyG\u0303 \u2212 z )\n . (69)\nHere, n = (nx, ny, nz) T is the positively pointing unit normal vector at the fault interface,\ndefined in (4). Note also that( Q+ )T SAT+ = ( v+ )T G+ \u2212 ( T+ )T G\u0303+, ( Q\u2212 )T SAT\u2212 = ( v\u2212 )T G\u2212 + ( T\u2212 )T G\u0303\u2212. (70)\nFinally, the SAT terms are defined as follows SAT\u2212q = \u2212H\u22121\u03be eq,nqJ \u221a \u03be2x + \u03be 2 y + \u03be 2 zSAT \u2212, SAT+q = \u2212H\u22121\u03be eq,0J \u221a \u03be2x + \u03be 2 y + \u03be 2 zSAT +.\n(71)\nIntroduce the fluctuation term\nFluc (G,Z) := \u2212Iq ( \u2211 \u03b7=l,m,n 1 Z\u03b7 |G\u03b7|2 ) \u2264 0, (72)\nand discrete surface interface term\nITs = Iq ( (v\u0302\u2212)T T\u0302\u2212 \u2212 (v\u0302+)T T\u0302+ ) = \u2212Iq  \u2211 j\u2208{l,m}\n\u03b1\u0302\n(\u03b7j + \u03b1\u0302) 2 \u03a6\n2 j  = \u2212Iq (\u03b1\u0302|V\u0302 |2) \u2264 0, (73) where the surface cubature Iq is defined in (61).\nWe can prove the result\nTheorem 6 Consider the semi-discrete approximation (65) of the elastic wave equation with the SAT-terms SATq defined in (71). We have\nd\ndt\n( \u2016Q\u2212 (\u00b7, \u00b7, \u00b7, t) \u20162HP + \u2016Q+ (\u00b7, \u00b7, \u00b7, t) \u20162HP ) = Fluc ( G\u2212,Z\u2212 ) + Fluc ( G+,Z+ ) + ITs \u2264 0.\nProof 6 For Q \u2208 {Q\u2212,Q+} consider\nd dt \u2016Q (\u00b7, \u00b7, \u00b7, t) \u20162HP =\n\u2329 Q, P\u22121 \u2202\n\u2202t Q \u232a H = \u2329 Q,\u2207D\u2212 \u2022 F (Q) + \u2211 \u03be=q,r,s B\u03be ( \u2207D+Q )\u232a H\n+ \u3008Q,SATq (Q)\u3009H .\nBy Theorem 5 we have\nd\ndt \u2016Q (\u00b7, \u00b7, \u00b7, t) \u20162HP = Iq\n( vTT ) \u2223\u2223\u2223 q=1 \u2212 Iq ( vTT ) \u2223\u2223\u2223 q=0 + \u3008Q,SATq (Q)\u3009H , (74)\nwith \u2329 Q,SAT+q \u232a H = \u2212Iq ( vTG+ \u2212TT G\u0303+ ) , \u2329 Q,SAT\u2212q \u232a H = \u2212Iq ( vTG\u2212 + TT G\u0303\u2212 ) .\nBy collecting contributions from both sides of the interface and using the identities (68) and (73) we have\nd\ndt\n( \u2016Q\u2212 (\u00b7, \u00b7, \u00b7, t) \u20162HP + \u2016Q+ (\u00b7, \u00b7, \u00b7, t) \u20162HP ) =\n\u2212 Iq (( v+ )T G+ \u2212 ( T+ )T G\u0303+ + ( v+ )T T+ ) \u2212 Iq (( v\u2212 )T G\u2212 + ( T\u2212 )T G\u0303\u2212 \u2212 ( v\u2212 )T T\u2212 )\n= \u2212Iq  \u2211 \u03b7\u2208{l,m,n} 1 Z+\u03b7 |G+\u03b7 |2 + ( v\u0302+ )T T\u0302+ \u2212 Iq  \u2211 \u03b7\u2208{l,m,n} 1 Z\u2212\u03b7 |G\u2212\u03b7 |2 \u2212 ( v\u0302\u2212 )T T\u0302\u2212  = Fluc ( G\u2212,Z\u2212 ) + Fluc ( G+,Z+ ) + ITs \u2264 0.\n(75)\nThe proof is complete.\nThe fluctuation term Fluc (G,Z) \u2264 0 adds a little numerical dissipation on the interface. However, in the limit of mesh refinement the fluctuation term vanishes, that is Fluc (G,Z)\u2192 0+ as h \u2192 0+, and we have ITs \u2192 ITs. The discrete result, Theorem 6, is completely analogous to the continuous counterparts, Theorems 2 and 4."
        },
        {
            "heading": "5 Analysis of numerical errors",
            "text": "Here, we will discuss numerical errors for the semi-discrete approximation (65). Numerical error analysis for the discrete approximation of the 3D elastic wave equation subject to the nonlinear friction laws (21)\u2013(23) at the fault/interface, is a nontrivial task. This is mostly due to the fact that the well-posedness of the continuous IBVP problem is not completely understood in general settings. To succeed we will make some simplifying assumptions. However our discussions are plausible and will help explain some of the behavior of the error seen in the numerical simulations performed later in this study. We will derive an error estimate for a linearised friction law. Next we will discuss the generation and propagation of errors due to DP SBP numerical differentiation of discontinuous and nearly singular exact solutions."
        },
        {
            "heading": "5.1 Error estimate",
            "text": "Let Q \u2208 {Q\u2212,Q+} denote the exact solutions of the IBVP, and Q(qi, rj, sk, t) denote the restriction of the solution on the grid (qi, rj, sk). We introduce the error on the grid\nE ijk(t) = Qijk(t)\u2212Q(qi, rj, sk, t). For the velocity and traction (v,T) and their hat-variable ( v\u0302, T\u0302 ) at the fault interface, we\ndenote the errors by (ev, eT ) , (e\u0302v, e\u0302T ) . The error E satisfies the error equation\nP\u0303\u22121 d\ndt E =\u2207D\u2212 \u2022 F (E ) + \u2211 \u03be\u2208{q,r,s} B\u03be ( \u2207D+E ) + SATq (ev \u2212 e\u0302v, eT \u2212 e\u0302T ) + T, (76)\nwhere T is the truncation error of the SBP FD operator. The truncation error T is a 3D vector field, however its structure is similar in each spatial direction. For sufficiently smooth exact solutions Q sampled on the grid points \u03bej = jh\u03be in the spatial direction \u03be \u2208 {q, r, s} the truncation error is of the form\nT\u03be,j =  h\u03b3\u03be\u03b2j \u2202\u03b3+1Q \u2202\u03be\u03b3+1 \u2223\u2223\u2223 \u03bej , if boundary,\nh\u03bd\u03be\u03b2j \u2202\u03bd+1Q \u2202\u03be\u03bd+1 \u2223\u2223\u2223 \u03bej , if interior.  , (77) where Tijk = Tq,i + Tr,j + Ts,k. Here, \u03b2j, are mesh independent constants, h\u03be > 0 is the grid spacing, \u03b3 \u2208 {1, 2, \u00b7 \u00b7 \u00b7 } is the order of accuracy of the FD stencils close to the boundary and \u03bd \u2208 {1, 2, \u00b7 \u00b7 \u00b7 } is the order of accuracy of the SBP FD stencils in the interior, away from the boundaries. For traditional SBP operators based on central difference stencils the interior accuracy is always even, and we have (\u03b3, \u03bd) = (p, 2p), for p = 1, 2, 3, \u00b7 \u00b7 \u00b7 . DP SBP operators based on skewed stencils, D+ and D\u2212, the interior order of accuracy can be odd or even. As discussed in [14, 28, 44], DP SBP operators with even order (2p)-th accuracy in the interior are closed with p-th order accurate stencils close to boundaries, and we also have (\u03b3, \u03bd) = (p, 2p). Dual-paring SBP FD operators with odd order (2p+ 1)-th accuracy in the interior are closed with p-th order accurate stencils close to boundaries, giving (\u03b3, \u03bd) = (p, 2p+ 1). The traditional SBP operators and DP SBP operators can yield (p+ 1)-th global order of accuracy, for smooth solutions.\nNote that if the hat-variables (e\u0302v, e\u0302T ) for the error satisfy the algebraic identities (44)\u2013 (47), then using Theorem 6 we can derive an estimate for the error. For the general friction law (20) with the nonlinear frictional strength \u03b1(\u03c3n, V, \u03c8) \u2265 0, it is difficult to show that the hat-variable (e\u0302v, e\u0302T ) satisfy the necessary algebraic identities (44)\u2013(47) required for stability.\nThe nonlinear frictional strength parameter is never negative, that is\n\u03b1(\u03c3n, V, \u03c8) \u2265 0, for all \u03c3n \u2265 0, V \u2265 0, \u03c8 \u2208 R.\nTo succeed, we linearise the friction law and consider the frozen coefficient case\n\u03b1(\u03c3n, V, \u03c8)\u2192 \u03b1 = const. \u2265 0, with 0 \u2264 \u03b1 \u2264 \u221e.\nWith this linearisation we minimise some of the nonlinear effects. However, the solutions can be discontinuous and nearly singular at the interface, and the hat-variables for the error (e\u0302v, e\u0302T ) satisfy the identities (44)\u2013(47).\nWe can prove the result for the linearised friction law.\nTheorem 7 Consider the semi-discrete error equation (76), with the numerical error E =( E \u2212,E + ) and the truncation error T = ( T\u2212,T+ ) of the elastic wave equation with the SATterms SATq defined in (71). Let \u03b1(\u03c3n, V, \u03c8) \u2192 \u03b1 \u2265 0, where \u03b1 \u2265 0 is a real constant, we have\nd\ndt \u2016E (t) \u20162HP + BTs \u2264 \u2016E (t) \u2016HP\u2016T (t) \u2016HP\u22121 ,\nwhere BTs = \u2212 (Fluc (G\u2212,Z\u2212) + Fluc (G+,Z+) + ITs) \u2265 0, ITs = \u2212Iq ( \u03b1\u0302|V\u0302e|2 ) \u2264 0, and\n|V\u0302e|2 = [[e\u0302vl]]2 + [[e\u0302vm]]2.\nBy the frozen coefficient analysis above, Theorem 7 indicates that the numerical error E is bounded by the truncation error T, and will converge to zero if T is square integrable. Obviously, the frozen coefficient analysis above hold for both traditional and DP SBP operators. Note however that the truncation errors in (77) include higher derivatives of the exact solution Q. If Q is sufficiently smooth such that the highest derivatives in (77) are continuous then the numerical error will converge to zero optimally, E = O(h\u03b3+1). For traditional SBP operators, the convergence rate O(h\u03b3+1) has been verified numerically in [11] using the method of manufacture solution, that is by forcing the IBVP with smooth exact solutions. We believe that the numerical result for smooth solutions hold also for DP SBP operators for friction laws.\nFor spontaneously self-evolving shear ruptures, the exact solutions are discontinuous across the fault for the particle velocity, and for the stress fields continuous across the fault but nearly singular. The solutions Q are rough, and the highest derivatives in (77) may not exist. As we will discuss below the smoothness of the solution and the parity of the order of accuracy (\u03bd) of the interior stencil of the SBP FD operators will have a significant impact in the generation and propagation of numerical errors."
        },
        {
            "heading": "5.2 Parity",
            "text": "Numerical errors for wave dominated problems are often most prominent at high frequencies. For well-posed IBVPs with smooth solutions high frequency wave modes can be resolved by increasing mesh resolution. However, for discontinuous and/or (nearly) singular exact solutions numerical errors arising from high order accurate methods may not diminish with increasing mesh resolution, because of \u201dGibbs/Runge\u2019s phenomena\u201d. For these situations carefully designed numerical methods are necessary in order to compute accurate numerical solutions. Consequently, detailed theoretical analysis is needed in order to understand the behaviours of numerical errors and control them.\nTo simplify the discussion here we will consider only the interior stencil, with the order of accuracy \u03bd. Numerical errors introduced by numerical differentiation of a wave-like solution can be split into the amplitude error and the phase error. If the amplitude error is much larger than the phase error we say that the numerical error is amplitude-dominated. Similarly, if the phase error is much larger than the amplitude error we say that the numerical error is phase-dominated.\nWe will show that the parity of the order of accuracy \u03bd will determine whether the numerical error is amplitude-dominated or phase-dominated. And if the numerical error is amplitude-dominated, then the numerical method has the potential to amplify high frequency numerical artefacts for non-smooth solutions.\nLet Q\u0303(t) = [Q(qi, rj, sk, t)] denote the grid function restricting the exact solution on the grid. We have\nD\u03b7\u03beQ\u0303 \u2223\u2223\u2223 j = \u2202Q \u2202\u03be \u2223\u2223\u2223 \u03bej + h\u03bd\u03be\u03b2j \u2202\u03bd+1Q \u2202\u03be\u03bd+1 \u2223\u2223\u2223 \u03bej ,\nwhere D\u03b7\u03be with \u03b7 \u2208 {\u2212,+} are the DP SBP operators defined above with the interior order of accuracy \u03bd \u2208 {2p, 2p+ 1}, p = 1, 2, \u00b7 \u00b7 \u00b7 . The numerical approximation replaces the partial\nderivative \u2202/\u2202\u03be by the modified partial differential operator\n\u2202 \u2202\u03be \u2192 \u2202 \u2202\u03be + h\u03bd\u03be\u03b2j\n\u2202\u03bd+1\n\u2202\u03be\u03bd+1 .\nTo determine whether the numerical error is amplitude-dominated or phase-dominated we consider the 1D monochromatic plane wave solution with unit amplitude eik\u03be\u03be, k\u03be \u2208 R, i = \u221a \u22121. The solution will be modified by the numerical approximation as follows\neik\u03be\u03be \u2192 eh\u03bd\u03be\u03b2j(ik\u03be) \u03bd+1 \u03be \u00b7 eik\u03be\u03be = ( 1 +O(h\u03bd\u03be ) ) eik\u03be\u03be.\nFor any finite k\u03be <\u221e the modified solution will converge to the monochromatic plane wave solution as h\u03be \u2192 0. Obviously for any h\u03be > 0 there are numerical errors. For even order of accuracy \u03bd = 2p we have\neik\u03be\u03be \u2192 eik\u03be(1+(\u22121)p\u03b2j(h\u03bek\u03be) \u03bd )\u03be,\nwhich is a phase error. For odd order of accuracy \u03bd = 2p+ 1 we have\neik\u03be\u03be \u2192 e((\u22121)p+1k\u03be\u03b2j(h\u03bek\u03be) \u03bd )\u03be \u00b7 eik\u03be\u03be,\nwhich gives an amplitude error. Therefore, even order (\u03bd = 2p) accurate numerical operators generate phase-dominated errors while numerical errors generated by odd order (\u03bd = 2p + 1) accurate operators are amplitude-dominated. As we will see in the numerical experiments below, upwind SBP operators with odd order accurate interior stencils can amplify high frequency numerical artefacts for spontaneously propagating shear ruptures in 3D elastic solids."
        },
        {
            "heading": "5.3 \u03b1-DRP SBP operators",
            "text": "Using the DP framework [14, 44, 43], it is possible to design optimised finite difference stencils such that numerical dispersion errors are significantly diminished for all wave numbers. This was the approach taken by the authors in [44] where \u03b1-DRP SBP operators are derived. These DP SBP operators are designed to guarantee maximum relative error \u2264 \u03b1 for all wave numbers. In particular the \u03b1-DRP SBP operators can resolve the highest frequency (\u03c0-mode) present on any equidistant grid at a tolerance of \u03b1 = 5% maximum error. For explicit schemes, these operators may provide a better resolution than any volume discretisation available today, including spectral methods, and significantly improves on the current standard for traditional operators that have a tolerance of 100% maximum error.\nIn Figure 3, we display the numerical dispersion relation for the 1D wave equation,\n\u2202v \u2202t = \u2202\u03c3 \u2202x ,\n\u2202\u03c3 \u2202t = \u2202v \u2202x , (78)\nwhich has the linear analytical dispersion relation \u03c9 = k. Here, \u03c9 is the angular frequency and k \u2208 R is the spatial wave number. In Figure 3, we compare the traditional SBP operators, the DP SBP operators and the \u03b1-DRP SBP operators. Note in particular, for the \u03b1-DRP SBP operators the numerical dispersion relations fit the continuous dispersion\nrelation for the 1D wave equation excellently well for all wave numbers. In Table 1 we tabulate the relative L2 dispersion errors. For more details we refer the reader to [44] where the \u03b1-DRP SBP operators are derived and analysed. As will be shown in the next section, using the \u03b1-DRP SBP operators we can eliminate the fatal errors arising from the upwind DP SBP operators [28] for dynamic rupture simulations with non-smooth solutions."
        },
        {
            "heading": "6 Numerical simulations of dynamic earthquake rup-",
            "text": "tures in 3D elastic solids\nIn this section, we will perform numerical simulations to verify the analysis performed in the previous sections. To highlight the numerical properties of the traditional, upwind DP and\nDRP SBP operators, we will select specifically the dipping fault benchmark problem, TPV10, from the series of dynamic rupture benchmark problems proposed by The SCEC/USGS Spontaneous Rupture Code Verification Project [38]. We note that other benchmark problems with different levels of difficulties have also been considered, although these results are not reported here, they can be found in the thesis of one of the co-authors [43].\nThe numerical methods are efficiently implemented in WaveQLab3D [11, 14], a petascale finite difference solver. The solutions are integrated in time using an explicit 5-stage 4-th order accurate low-storage Runge-Kutta time stepping scheme [6]. The explicit time-step dt is determined by\ndt = CFL min \u03be\u2208{q,r,s}\n\u221a h2\u03be(\nc2p + c 2 s ) ( \u03be2x + \u03be 2 y + \u03be 2 z ) , CFL = 0.5. (79) Here cp, cs are the P-wave and S-wave speeds, \u03bex, \u03bey, \u03bez are the partial derivatives of \u03be \u2208 {q, r, s} with respect to x, y, z respectively, h\u03be = 1/n\u03be is the uniform spatial step in the transformed coordinates.\nWe will compare and contrast the numerical resolution power of the traditional SBP FD operator, upwind DP SBP operator and the recently derived DRP SBP operator for nonlinear dynamic earthquake ruptures composed of discontinuous and nearly singular exact solutions. We note that our numerical solutions have been benchmarked against finite element and spectral element methods downloaded from [38]. Please see [43] for details.\nThese problems are computationally expensive, we will also demonstrate parallel efficiency and perfect scaling of our parallel implementation and numerical simulation on Gadi 1. For the production runs we will use two levels of mesh sizes, h = 100, 50 m, with 480 and 2304 MPI-ranks respectively on Gadi. We will briefly describe the TPV10 benchmark problem below, more elaborate descriptions can be found in [38]."
        },
        {
            "heading": "6.1 TPV10",
            "text": "The TPV10 benchmark is a 60-degree dipping normal fault embedded in a homogeneous half-space of isotropic elastic solid, see Figure (4). Therefore the fault region is the half-plane cutting through x = x\u0303(y) := x0+y/ tan(60), that is \u0393F = {x\u0303(y)}\u00d7(0,\u221e)\u00d7(\u2212\u221e,\u221e). We introduce the down-dip direction y\u0303 = y/ sin(60), thus the fault plane is \u0393F = {(y\u0303(y), z) |(y, z) \u2208 (0,\u221e)\u00d7 (\u2212\u221e,\u221e). The rupturing part of the fault is a 15 km-by-30 km rectangular surface, \u0393r = [0, 15] \u00d7 [\u221215, 15], on the fault plane. Outside \u0393r, the fault is locked and it is not permitted to slip. The 3 km-by-3 km nucleation patch is centered at 12 km down-dip that is \u0393nuc = [10.5, 13.5]\u00d7 [\u22121.5, 1.5].\nThe fault obeys the slip-weakening friction law, with the fault strength \u03c4 = C0 + f(S)\u03c3n where \u03c3n is the compressive-norm-stress, f(S) is the friction coefficient given by (25) and C0[MPa] is the cohesion. The friction parameters are giving in Table 2. The initial stresses on the fault are given in Table 3. Here T0n is the initial normal-stress, T0m is the initial\n1Gadi is the current supercomputer hosted at the National Computational Infrastructure, Australia. It contains total 3,074 nodes each containing two 24-core Intel Xeon Scalable \u2019Cascade Lake\u2019 processors and 192 Gigabytes of memory. The internal connection is through Mellanox Technologies\u2019 InfiniBand technology. The code is compiled on Gadi by Intel Compiler/2019.5.281 and the parallelisation is realised by Intel MPI/2019.5.281.\nshear-stress along dip, T0l is the initial shear-stress along strike and the initial compressive normal-stress is \u03c30n = \u2212T0n. At the nucleation patch \u0393nuc the initial shear-stress exceeds the fault\u2019s peak strength, \u03c40 > \u03c4p. The initiation of rupture is instantaneous at t > 0. Note that on the fault plane \u0393F but outside the 15 km -by- 30 km faulting area, that is in \u0393F \\\u0393r, there is a strength barrier that makes it impossible for the fault to slip. The strength barrier is established by the very large values for the cohesion C0 = 1000 MPa and the static coefficient of friction fs = 10000, given in Table 2."
        },
        {
            "heading": "6.2 Numerical simulations",
            "text": "To perform simulations we truncate the domain and consider the finite computational domain \u2126 with\n\u2126 = \u2126\u2212 \u222a \u2126+, \u2126\u2212 = [\u221220, x\u0303]\u00d7 [0, 20]\u00d7 [\u221220, 20], \u2126+ = [x\u0303, 20]\u00d7 [0, 20]\u00d7 [\u221220, 20]. (80)\nThe sub-blocks \u2126\u2212 and \u2126+ of isotropic elastic solid are glued together by friction. The material properties are homogeneous throughout the domain with the following properties,\ncp = 5.716 km/s, cs = 3.300 km/s, \u03c1 = 2.700 g/cm 3. (81)\nAt the boundary on the Earth\u2019s surface, y = 0, we impose the free-surface boundary condition by setting the traction vector to zero. The artificial boundaries at x = \u00b120, y = 20 and z = \u00b120 are surrounded by the PML [12, 13] of sufficiently small width of 1.2 km to absorb outgoing waves. Effective numerical treatment of the PML in the presence of nonlinear frictional sources is a topic of future work.\nA boundary conforming curvilinear mesh, obeying the fault topography, is generated for the sub-blocks \u2126\u2212 and \u2126+. Note that because of the dipping fault plane, the computational\nmesh is highly skewed. Numerical approximations are perform using the 6th order accurate traditional SBP operator, and upwind DP and DRP SBP operators with order of accuracy 4, 5, 6 and 7. We will probe the solutions at a receiver station placed at (7.5, 12) on the fault plane and which is 13.2 km from the hypo-centre (12, 0).\nWe run the simulations until the final time T = 15 s. Snapshots of the slip-rate on the fault plane are displayed in Figure 5, showing the evolution of the rupture on the fault plane, \u0393r. Comparisons of the time history of the slip-rate at the receiver station (7.5, 12) are shown in Figure 6, at h = 100 m and h = 50 m spatial step sizes. In Figure 8, we compare the slip-rate on the entire fault plane at t = 5.98 s. Similarly, comparisons of the time history of the shear-stress at the receiver station (7.5, 12) are shown in Figure 7, at h = 100 m and h = 50 m spatial step sizes."
        },
        {
            "heading": "6.3 Computational costs and scaling tests",
            "text": "Efficient HPC codes and parallel numerical implementations that scales perfectly with increasing supercomputing resources are necessary for effective numerical simulations. We have performed some scaling tests to demonstrate efficient parallel implementation of the DRP SBP operators for the numerical simulations of 3D nonlinear earthquake rupture dynamics, see Figure 9. Our new DRP operators are implemented in the large scale code with near perfect scaling. The resources used is slightly larger than the 6th order upwind DP and traditional SBP schemes, but not by a large amount. We consider the DRP operators to have a marginal higher cost than the traditional and DP SBP methods."
        },
        {
            "heading": "6.4 Discussions",
            "text": "Numerical simulations presented in Figure 6\u20137 compare our new DRP SBP operators with DP and the traditional SBP operator for the dynamic rupture simulation, TPV10 benchmark problem. The simulations are performed at two levels of mesh resolutions, h = 100, 50 m. As\nDP odd order DP even order\nDRP odd order DRP even order\nFigure 6a: Time-series of the vertical slip-rate at h = 100 m grid spacing for an on-fault station placed at (7.5, 12).\nDP odd order DP even order\nDRP odd order DRP even order\nFigure 6b: Time-series of the vertical slip-rate at h = 50 m grid spacing for an on-fault station placed at (7.5, 12).\nFigure 6: Comparisons of the slip-rate at at two levels of mesh refinements, h = 100, 50 m. The simulations are performed with the traditional SBP FD operator of order 6, the upwind DP and DRP SBP FD operators of order 4, 5, 67. Note that at h = 100 m mesh resolution, even (4 and 6) order DP SBP operators support minimal high frequency errors while the odd (5 and 7) order DP SBP operators amplify high frequency numerical errors. The DRP SBP operators support much less than the traditional SBP operator. With mesh refinement h = 50 m, the 4th order upwind DP SBP operator, the traditional SBP FD operator, and all DRP SBP operators compute convergent numerical solutions. For odd (5 and 7) order DP SBP operators, mesh refinement amplifies further high frequency numerical artefacts while the 6th order DP SBP operator generates a low frequency error.\nwe can see, our DRP SBP operators have much fewer oscillations in their numerical solutions than their DP and traditional SBP counterparts. However, the DRP operators seem to have\nDP odd order DP even order\nDRP odd order DRP even order\nFigure 7a: Time-series of the horizontal shear-stress at h = 100 m grid spacing for an on-fault placed at (7.5, 12).\nDP odd order DP even order\nDRP odd order DRP even order\nFigure 7b: Time-series of the horizontal shear-stress at h = 50 m grid spacing for an on-fault placed at (7.5, 12).\nFigure 7: Comparisons of the shear-stress at at two levels of mesh refinements, h = 100, 50 m. The simulations are performed with the traditional SBP FD operator of order 6, the upwind DP and DRP SBP FD operators of order 4, 5, 67. Note that at h = 100 m mesh resolution, even (4 and 6) order DP SBP operators support minimal high frequency errors while the odd (5 and 7) order DP SBP operators amplify high frequency numerical errors. The DRP SBP operators have much less spurious oscillations than the traditional SBP operator. With mesh refinement h = 50 m, the 4th order upwind DP SBP operator, the traditional SBP FD operator, and all DRP SBP operators compute convergent numerical solutions. For odd (5 and 7) order DP SBP operators, mesh refinement catastrophically amplifies high frequency numerical artefacts while the 6th order DP SBP operator generates low frequency errors.\na computational cost marginally higher than the computational costs of traditional and DP SBP methods, see Figure 9.\nFigure 6 and 7 show that, at h = 100 m grid spacing, even (4 and 6) order DP SBP operators support minimal high frequency errors while the odd (5 and 7) order DP SBP operators amplify high frequency numerical errors. These are in a good agreement with the numerical error analysis presented in Section 5.2. With mesh refinement h = 50 m, the 4th order upwind DP SBP operator, the traditional SBP FD operator, and all DRP SBP operators compute converging numerical solutions. For odd (5 and 7) order DP SBP operators, mesh refinement amplifies further high frequency numerical artefacts while the 6th order DP SBP operator generates a low frequency error.\nThe accuracy of the numerical solutions of DRP SBP operators at h = 100 m resolution is comparable to the accuracy of the numerical solutions of traditional SBP FD operator at h = 50 m. Although mesh refinement can improve the accuracy of the traditional SBP FD operator, however, this comes with a significant computational cost for the 3D problem.\nFigure 8 shows that the catastrophic high frequency numerical errors, for odd (5 and 7) order DP SBP operators, corrupts the solutions everywhere and significantly alters the nonlinear rupture process."
        },
        {
            "heading": "7 Summary",
            "text": "We derive and analyse high order finite difference numerical methods for the simulations of nonlinear frictional sliding along internal boundaries embedded in elastic solids. In particular, we consider earthquake source processes modelled by spontaneously propagating shear ruptures along fault surfaces in 3D elastic solids. This problem is both numerically and computationally challenging because of the unprecedented large gradients generated by nonlinear coupling of fields across the fault interface and the presence of discontinuous solutions on the fault.\nWe discretise the 3D elastic wave equation with a pair of DP SBP operators, on boundaryconforming curvilinear meshes, and enforce the nonlinear interface conditions weakly using penalties. Using the energy method and the dual-pairing SBP framework [28, 14, 43, 44], we prove that the numerical method is energy-stable. We derive a priori error estimates and prove the convergence of the numerical error for a linearised friction law. Further, we analyse the dependence of the parity (even/odd) of the operators on the numerical errors. For odd order accurate operators, our error analysis reveals that the DP SBP FD operators [28] have the potential to generate spurious catastrophic high frequency errors that do diminish with mesh refinement. However, the \u03b1-DRP SBP operators [44, 43] can resolve the highest frequency (\u03c0-mode) present on any equidistant grid at a tolerance of \u03b1 = 5% maximum error. The DRP SBP operators [44, 43] potentially eliminates the catastrophic high frequency errors.\nNumerical simulations performed in 3D corroborates the analysis. Our DRP SBP operators reproduces dynamic rupture benchmark problems, proposed by Southern California Earthquake Center, with less computational effort than standard methods based on traditional SBP operators."
        },
        {
            "heading": "Acknowledgments",
            "text": "This research was undertaken with the assistance of resources and services from the National Computational Infrastructure (NCI), which is supported by the Australian Government\u2019s National Collaborative Research Infrastructure Strategy (NCRIS). Frederick Fung and Christopher Williams acknowledge support from the Australian Government Research Training Program Scholarship."
        }
    ],
    "title": "Accurate simulations of nonlinear dynamic shear ruptures on pre-existing faults in 3D elastic solids with dual-pairing SBP methods",
    "year": 2022
}