{
    "abstractText": "Entropy-conserving numerical fluxes are a cornerstone of modern high-order entropydissipative discretizations of conservation laws. In addition to entropy conservation, other structural propertiesmimicking the continuous level suchaspressure equilibrium and kinetic energy preservation are important. This note proves that there are no numerical fluxes conserving (one of) Harten\u2019s entropies for the compressible Euler equations that also preserve pressure equilibria and have a density flux independent of the pressure. This is in contrast to fluxes based on the physical entropy, where even kinetic energy preservation can be achieved in addition.",
    "authors": [
        {
            "affiliations": [],
            "name": "Hendrik Ranocha"
        }
    ],
    "id": "SP:3ca2556f325dd2b643465a8c3537e929df948e4a",
    "references": [
        {
            "authors": [
                "R. Abgrall"
            ],
            "title": "A general framework to construct schemes satisfying additional conservation relations. Application to entropy conservative and entropy dissipative schemes.",
            "venue": "Journal of Computational Physics",
            "year": 2018
        },
        {
            "authors": [
                "R. Abgrall",
                "P. \u00d6ffner",
                "H. Ranocha"
            ],
            "title": "Reinterpretation and Extension of Entropy Correction Terms for Residual Distribution and Discontinuous Galerkin Schemes: Application to Structure Preserving Discretization.",
            "venue": "Journal of Computational Physics",
            "year": 2022
        },
        {
            "authors": [
                "J. Bezanson",
                "A. Edelman",
                "S. Karpinski",
                "andV.B. Shah"
            ],
            "title": "Julia: A FreshApproach toNumerical Computing.",
            "venue": "SIAM Review",
            "year": 2017
        },
        {
            "authors": [
                "P. Chandrashekar"
            ],
            "title": "Kinetic Energy Preserving and Entropy Stable Finite Volume Schemes for Compressible Euler and Navier-Stokes Equations.",
            "venue": "Communications in Computational Physics",
            "year": 2013
        },
        {
            "authors": [
                "D. Derigs",
                "A.R. Winters",
                "G.J. Gassner",
                "S. Walch"
            ],
            "title": "A novel averaging technique for discrete entropy-stable dissipation operators for ideal MHD.",
            "venue": "Journal of Computational Physics",
            "year": 2017
        },
        {
            "authors": [
                "T.C. Fisher",
                "M.H. Carpenter"
            ],
            "title": "High-order entropy stable finite difference schemes for nonlinear conservation laws: Finite domains.",
            "venue": "Journal of Computational Physics",
            "year": 2013
        },
        {
            "authors": [
                "G.J. Gassner",
                "M. Sv\u00e4rd",
                "F.J. Hindenlang"
            ],
            "title": "Stability Issues of Entropy-Stable and/or Split-form High-order Schemes.",
            "venue": "Journal of Scientific Computing",
            "year": 2022
        },
        {
            "authors": [
                "T.J.R. Hughes",
                "L.P. Franca",
                "M Mallet"
            ],
            "title": "A new finite element formulation for computational fluid dynamics: I. Symmetric forms of the compressible Euler and Navier-Stokes equations and the second lawof thermodynamics.",
            "venue": "In:ComputerMethods inAppliedMechanics and Engineering",
            "year": 1986
        },
        {
            "authors": [
                "F. Ismail",
                "P.L. Roe"
            ],
            "title": "Affordable, entropy-consistent Euler flux functions II: Entropy production at shocks.",
            "venue": "Journal of Computational Physics",
            "year": 2009
        },
        {
            "authors": [
                "A. Jameson"
            ],
            "title": "Formulation of Kinetic Energy Preserving Conservative Schemes for Gas Dynamics andDirect Numerical Simulation of One-Dimensional Viscous Compressible Flow in a Shock Tube Using Entropy and Kinetic Energy Preserving Schemes.",
            "venue": "Journal of Scientific Computing",
            "year": 2008
        },
        {
            "authors": [
                "H. Ranocha"
            ],
            "title": "Comparison of Some Entropy Conservative Numerical Fluxes for the Euler Equations.",
            "venue": "Journal of Scientific Computing",
            "year": 2018
        },
        {
            "authors": [
                "H. Ranocha"
            ],
            "title": "Generalised Summation-by-Parts Operators and Entropy Stability of Numerical Methods for Hyperbolic Balance Laws.",
            "venue": "PhD thesis. TU Braunschweig,",
            "year": 2018
        },
        {
            "authors": [
                "H. Ranocha"
            ],
            "title": "Reproducibility repository for \"A Note on Numerical Fluxes Conserving Harten\u2019s Entropies for the Compressible Euler Equations",
            "venue": "https://github.com/ranocha/paper-2022- Euler_Harten_EC",
            "year": 2022
        },
        {
            "authors": [
                "H. Ranocha",
                "G.J. Gassner"
            ],
            "title": "Preventing pressure oscillations does not fix local linear stability issues of entropy-based split-form high-order schemes.",
            "venue": "Communications on Applied Mathematics and Computation (Aug. 2021). doi: 10.1007/s42967-021-00148-z",
            "year": 2021
        },
        {
            "authors": [
                "H. Ranocha",
                "M. Schlottke-Lakemper",
                "A.R. Winters",
                "E. Faulhaber",
                "J. Chan",
                "G. Gassner"
            ],
            "title": "Adaptive numerical simulationswith Trixi.jl: A case study of Julia for scientific computing.",
            "venue": "Proceedings of the JuliaCon Conferences",
            "year": 2022
        },
        {
            "authors": [
                "J. Revels",
                "M. Lubin",
                "T. Papamarkou"
            ],
            "title": "Forward-Mode Automatic Differentiation in Julia",
            "year": 2016
        },
        {
            "authors": [
                "M. Schlottke-Lakemper",
                "A.R. Winters",
                "H. Ranocha",
                "G.J. Gassner"
            ],
            "title": "A purely hyperbolic discontinuous Galerkin approach for self-gravitating gas dynamics.",
            "venue": "Journal of Computational Physics",
            "year": 2021
        },
        {
            "authors": [
                "N. Shima",
                "Y. Kuya",
                "Y. Tamaki",
                "S. Kawai"
            ],
            "title": "Preventing spurious pressure oscillations in split convective form discretization for compressible flows.",
            "venue": "Journal of Computational Physics",
            "year": 2021
        },
        {
            "authors": [
                "B. Sj\u00f6green",
                "H. Yee"
            ],
            "title": "Entropy Stable Method for the Euler Equations Revisited: Central Differencing via Entropy Splitting and SBP.",
            "venue": "Journal of Scientific Computing",
            "year": 2019
        },
        {
            "authors": [
                "E. Tadmor"
            ],
            "title": "The numerical viscosity of entropy stable schemes for systems of conservation laws. I.",
            "venue": "In:Mathematics of Computation",
            "year": 1987
        }
    ],
    "sections": [
        {
            "heading": "A Note on Numerical Fluxes Conserving a Member",
            "text": "of Harten\u2019s One-Parameter Family of Entropies for\nthe Compressible Euler Equations\nHendrik Ranocha\u22171\n1Applied Mathematics, University of Hamburg, Germany\nMarch 8, 2022\nEntropy-conserving numerical fluxes are a cornerstone of modern high-order entropydissipative discretizations of conservation laws. In addition to entropy conservation, other structural propertiesmimicking the continuous level suchaspressure equilibrium and kinetic energy preservation are important. This note proves that there are no numerical fluxes conserving (one of) Harten\u2019s entropies for the compressible Euler equations that also preserve pressure equilibria and have a density flux independent of the pressure. This is in contrast to fluxes based on the physical entropy, where even kinetic energy preservation can be achieved in addition.\nKey words. entropy stability, numerical fluxes, flux differencing, kinetic energy preservation, pressure equilibrium preservation, local linear stability"
        },
        {
            "heading": "1 Introduction",
            "text": "Ever since the seminalwork of Tadmor [22], researchers have been interested in entropy-dissipative numerical methods for conservation laws and related models. Usually, these methods have improved robustness properties, even for underresolved simulations. Nowadays, several means have been explored to ensure entropy stability. One of the most popular and successful approaches is based on entropy-conservative (EC) numerical fluxes. These can be used to construct high-order central-type methods using flux differencing [6] to which appropriate dissipation can be added. A recent alternative is the general algebraic approach of [1, 2].\nThere are several numerical fluxes for the compressible Euler equations conserving the physical (logarithmic) entropy [4, 10, 12]. Harten [8] studied another family of entropies for the compressible Euler equations. Although these entropies do not symmetrize the heat flux terms in the compressible Navier-Stokes equations [9], they are still of interest, for example to construct entropy splitting methods or related EC fluxes [21]. Entropy conservation alone is often insufficient to construct good numericalmethods. Of course, dissipation and related issues such as shock capturing and positivity of the density and internal energy are also important but are not the focus of this contribution. Instead, preservation of the kinetic energy [11, 13, 14] and pressure equilibria [16, 20] is considered. Moreover, the numerical density flux should not depend on the pressure, in accordance with physical expectations. This is \u2217ORCID: 0000-0002-3456-2277\nar X\niv :2\n20 1.\n03 94\n6v 2\n[ m\nat h.\nN A\n] 2\n2 A\npr 2\n02 2\ndiscussed further in [5, 12], where positivity failure could be identified for certain setupswith large pressure jumps and constant densities and velocities, even in the presence of strong (numerical) dissipation. The main contribution of this note is to prove that there are no numerical fluxes conserving Harten\u2019s entropies for the compressible Euler equations that also preserve pressure equilibria and have a density flux independent of the pressure (Section 2). Further discussion of this result is presented in Section 3."
        },
        {
            "heading": "2 Main result",
            "text": "It suffices to concentrate on the 1D compressible Euler equations\n%CD + %G 5 (D) = 0, D = (* , *E, *4) ) , 5 (D) = (*E, *E2 + ?, (*4 + ?)E)) , (2.1)\nwhere * is the density, E the velocity, *4 the total energy, and the pressure ? = ( \u22121)(*4 \u2212*E2/2) is given by the ideal gas law with ratio of specific heats > 1. Harten [8] considered entropies of the form*(D) = \u2212*\u210e(B), where B = log(?/* ) and \u210e is a smooth function satisfying \u210e\u2032\u2032(B)/\u210e\u2032(B) < 1/ . A special one-parameter family of these entropies is given by\n*(D) = \u2212 + \u2212 1 *(?/* )1/( + ) , > 0 or < \u2212 , (2.2)\nwhere the restriction of the parameter ensures convexity of * [21]. The members of this oneparameter family (2.2) of entropy functions for the compressible Euler equations are often referred to as Harten\u2019s entropies in the literature, e.g., in [21]. The associated entropy variables F = *\u2032(D) and the flux potential # [22] are given by\nF = *\n? (?/* )1/( + ) ( \u2212 \u2212 1 ? * \u2212 1 2 E 2 , E,\u22121 ) , # = *(?/* )1/( + )E. (2.3)\nThis note focuses on two-point numerical fluxes for the compressible Euler equations. Such a two-point numerical flux 5 num is characterized as follows. Definition 2.1 (Entropy conservation [22]). The numerical flux 5 num is EC if [[F]] \u00b7 5 num \u2212 [[#]] = 0, where [[0]] = 0+ \u2212 0\u2212 is the common jump operator. \u22b3 Definition2.2 (Pressure equilibriumpreservation [16]). Anumerical flux 5 num = ( 5 num* , 5 num *E , 5 num *4 ) is pressure equilibrium preserving (PEP) if 5 num*E = E 5 num * + const1(?, E) and 5 num *4 = 1 2E 2 5 num * + const2(?, E) whenever the velocity E and the pressure ? are constant. Here, const8(?, E), 8 \u2208 {1, 2}, denote some generic constants depending only on the constants E and ?. \u22b3 As discussed in [7, 16, 20], pressure equilibria are important setups where the velocity and the pressure are constant. In this case, the compressible Euler equations are reduced to linear advection equations. Pressure equilibrium preserving schemes keep this property at the discrete level [16]. The main result of this note is\nTheorem 2.3. There is no two-point numerical flux for the compressible Euler equations (2.1) that is entropy-conserving in the sense of Tadmor (Def. 2.1) for a member of Harten\u2019s one-parameter family of entropies (2.2), pressure equilibrium preserving (Def. 2.2), and has a density flux that does not depend on the pressure.\nThe proof of Theorem 2.3 is divided into the following steps. Lemma 2.4. For ? \u2261 const and E \u2261 const, a numerical flux that is PEP and EC for a member of Harten\u2019s one-parameter family of entropies (2.2) has a density flux of the form\n5 num * = \u2212 [[* /( + )]] [[*\u2212 /( + )]] E. (2.4)\nProof. For constant pressure and velocity, [[F]] \u00b7 5 num \u2212 [[#]] = ( \u2212 \u2212 1? 1/( + )[[*\u2212 /( + )]] \u2212 1 2 ? (1\u2212 \u2212 )/( + ) E 2[[* /( + )]] ) 5 num *\n+ ?(1\u2212 \u2212 )/( + )E[[* /( + )]] 5 num*E \u2212 ? (1\u2212 \u2212 )/( + )[[* /( + )]] 5 num*4 \u2212 ?1/( + )E[[* /( + )]].\n(2.5)\nA PEP flux is of the form 5 num*E = E 5 num * + ?, 5 num *4 = 1 2E 2 5 num * + ?E /( \u2212 1). Thus,\n[[F]] \u00b7 5 num \u2212 [[#]] = ( \u2212 \u2212 1? 1/( + )[[*\u2212 /( + )]] \u2212 1 2 ? (1\u2212 \u2212 )/( + ) E 2[[* /( + )]] ) 5 num *\n+ ?(1\u2212 \u2212 )/( + )E2[[* /( + )]] 5 num* + ? 1/( + ) E[[* /( + )]] \u2212 1 2 ? (1\u2212 \u2212 )/( + ) E 2[[* /( + )]] 5 num* \u2212 \u2212 1? 1/( + ) E[[* /( + )]]\n\u2212 ?1/( + )E[[* /( + )]]\n= \u2212 \u2212 1?\n1/( + )[[*\u2212 /( + )]] 5 num* \u2212 \u2212 1? 1/( + ) E[[* /( + )]].\n(2.6)\nHence, the EC condition is equivalent to (2.4).\nLemma 2.5. For E \u2261 const and ?\u2212 = ?+(*\u2212/*+) /( + \u22121), a numerical flux that is EC for a member of Harten\u2019s one-parameter family of entropies (2.2) has a density flux of the form\n5 num * = \u2212\n\u2212 1 [[* /( + \u22121)]] [[* (1\u2212 )/( + \u22121)]] E. (2.7)\nProof. For this special choice of the pressure,\n*\u2212 ?\u2212 (?\u2212/* \u2212) 1/( + ) = * /( + )\u2212 ? (1\u2212 \u2212 )/( + ) \u2212 = * /( + ) \u2212 (*\u2212/*+) \u2212 /( + ) ? (1\u2212 \u2212 )/( + ) +\n= * /( + )+ ? (1\u2212 \u2212 )/( + ) + = *+ ?+ (?+/* +)1/( + ) ,\n(2.8)\ni.e., [[(*/?)(?/* )1/( + )]] = 0. Thus, for E \u2261 const, (2.3) yields\n[[F]] \u00b7 5 num \u2212 [[#]] = \u2212 \u2212 1 [[(?/* )1/( + )]] 5 num* \u2212 [[*(?/* )1/( + )]]E. (2.9)\nConsequently, an EC flux must be of the form\n5 num * = \u2212\n\u2212 1 [[*(?/* )1/( + )]] [[(?/* )1/( + )]] E. (2.10)\nInserting the pressure ratio, the fraction of the jump terms can be written as\n* /( + ) + ? 1/( + ) + \u2212 * /( + )\u2212 ? 1/( + ) \u2212\n* \u2212 /( + ) + ? 1/( + ) + \u2212 *\u2212 /( + )\u2212 ? 1/( + ) \u2212\n= * /( + ) + \u2212 * /( + )\u2212 (*\u2212/*+) /(( + \u22121)( + ))\n* \u2212 /( + ) + \u2212 *\u2212 /( + )\u2212 (*\u2212/*+) /(( + \u22121)( + ))\n= * /( + \u22121) + \u2212 * /( + \u22121)\u2212\n* \u2212 /( + \u22121) + \u2212 *\u2212 /( + \u22121)\u2212\n,\n(2.11)\nproving (2.7).\nProof of Theorem 2.3. For given , , and *\u00b1, such a flux needs to satisfy both (2.4) and (2.7), i.e.,\n[[* /( + )]] [[*\u2212 /( + )]] = ( \u2212 1) [[* /( + \u22121)]] [[* (1\u2212 )/( + \u22121)]] . (2.12)\nFor fixed and , it is easy to find *\u2212 \u2260 *+ such that this equation is not satisfied. Hence, a numerical flux with all properties listed in Theorem 2.3 cannot exist."
        },
        {
            "heading": "3 Discussion",
            "text": "There are no numerical fluxes conserving a member of Harten\u2019s one-parameter family of entropies (2.2) for the compressible Euler equations that also preserve pressure equilibria and have a density flux independent of the pressure (Theorem 2.3). This result is in contrast to fluxes conserving the physical (logarithmic) entropy, where kinetic energy preservation can be achieved in addition to all of these properties [13, 14], resulting in an essentially unique numerical flux [16]. Following the uniqueness proof of such a numerical flux based on the logarithmic entropy presented in [16], it is tempting to choose a density flux based on a simplified setting, e.g., for constant velocity and pressure as in Lemma 2.4. Then, kinetic energy preservation determines the momentum flux accordingly [13, 14] and one might expect to be able to use the EC criterion to find an energy flux. However, this does not work in general since the energy part of the numerical flux can be orthogonal to the jump of the entropy variables as in Lemma 2.5. In this case, such an approach will often lead to a blow-up of the derived component for the total energy flux. Hence, one cannot impose a form of the density flux in general.\nMoreover, it is interesting to note that EC fluxes based on Harten\u2019s one-parameter family of entropies do not solve the local linear/energy stability issues discussed in [7, 16]. This is demonstrated by the spectra of discontinuous Galerkin semidiscretizations of the 2D compressible Euler equations shown in Figure 1. The setup uses the density wave example described in [16]. If the central flux 5 num = {{ 5 }} is used instead of an EC flux, the spectrum of the resulting semidiscretization is essentially purely imaginary (ignoring floating point errors etc.), indicating (marginal) local linear/energy stability of themethod [7, 16]. This property is desired and reasonable for this physical setup, since the density wave reduces the compressible Euler equations to linear advection equations, see also the extended discussion in [7, 16].\nThe semidiscretizations used to compute the spectra above are implemented using Trixi.jl [17, 19]. The Jacobian is computed using automatic differentiation [18] in Julia [3]. All source code required to reproduce the examples as well as additional material verifying the implementation and some calculations presented in this article are available online [15]."
        },
        {
            "heading": "Acknowledgments",
            "text": "Funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany\u2019s Excellence Strategy EXC 2044-390685587, Mathematics M\u00fcnster: Dynamics-GeometryStructure. Special thanks to Gregor Gassner and Ayaboe Edoh for discussions related to this manuscript."
        }
    ],
    "title": "A Note on Numerical Fluxes Conserving a Member of Harten's One-Parameter Family of Entropies for the Compressible Euler Equations",
    "year": 2022
}