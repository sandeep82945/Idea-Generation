{
    "abstractText": "Capacity drop is the critical phenomenon that triggers traffic congestion, while traffic evolution is very complex during a capacity drop. This study applied the empirical vehicle trajectory data to explore the traffic characteristics during the capacity drop at the tunnel bottleneck section. We first construct a capacity drop analysis model using image processing technology to extract high-precision vehicle trajectories. We then analyze the characteristics of the evolution process of the capacity drop at the bottleneck area. The results show that the capacity drop is a dynamic evolution process from free flow to congested flow where traffic operation is distinct. The capacity drop shows the difference between congested flow and non-congested flow. The driving characteristics of drivers in the two states are also different. The influence of lane-changing behavior on the capacity drop is estimated. In the free flow state, the disturbance caused by lane-changing can be quickly eliminated. With the increase in vehicle numbers in the area, the frequent lane-changing behavior accumulates disturbance. When the disturbance reaches a certain degree, congestion will occur, and the vehicle\u2019s speed will drop sharply, resulting in a capacity drop.",
    "authors": [
        {
            "affiliations": [],
            "name": "Lu Yang"
        },
        {
            "affiliations": [],
            "name": "Chishe Wang"
        },
        {
            "affiliations": [],
            "name": "Zhibin Li"
        }
    ],
    "id": "SP:6ca59de1ee6fafdc1cfa94839ac5e5cee12f263a",
    "references": [
        {
            "authors": [
                "Jin",
                "W.-L"
            ],
            "title": "Kinematic wave models of sag and tunnel bottlenecks",
            "venue": "Transp. Res. Part B Methodol",
            "year": 2018
        },
        {
            "authors": [
                "J. Sun",
                "T. Li",
                "M. Yu",
                "H.M. Zhang"
            ],
            "title": "Exploring the Congestion Pattern at Long-Queued Tunnel Sag and Increasing the Efficiency by Control",
            "venue": "IEEE Trans. Intell. Transp. Syst",
            "year": 2018
        },
        {
            "authors": [
                "M.L. Anderson",
                "L.W. Davis"
            ],
            "title": "An empirical test of hypercongestion in highway bottlenecks",
            "venue": "J. Public Econ",
            "year": 2020
        },
        {
            "authors": [
                "K. Wada",
                "I. Martinez",
                "W.-L. Jin"
            ],
            "title": "Continuum car-following model of capacity drop at sag and tunnel bottlenecks",
            "venue": "Transp. Res. Part C Emerg. Technol",
            "year": 2020
        },
        {
            "authors": [
                "I. Mart\u00ednez",
                "W.-L. Jin"
            ],
            "title": "Impact of VSL Location on Capacity Drop: A Case of Sag and Tunnel Bottlenecks",
            "venue": "Transp. Res. Procedia",
            "year": 2018
        },
        {
            "authors": [
                "Y. Wang",
                "X. Yu",
                "S. Zhang",
                "P. Zheng",
                "J. Guo",
                "L. Zhang",
                "S. Hu",
                "S. Cheng",
                "H. Wei"
            ],
            "title": "Freeway traffic control in presence of capacity drop",
            "venue": "IEEE Trans. Intell. Transp. Syst",
            "year": 2020
        },
        {
            "authors": [
                "L.C. Edie"
            ],
            "title": "Car-Following and Steady-State Theory for Noncongested Traffic",
            "venue": "Oper. Res",
            "year": 1961
        },
        {
            "authors": [
                "H. Greenberg"
            ],
            "title": "An Analysis of Traffic Flow",
            "venue": "Oper. Res",
            "year": 1959
        },
        {
            "authors": [
                "M. Koshi"
            ],
            "title": "Some findings and an overview on vehicular flow characteristics",
            "venue": "In Proceedings of the 8th International Symposium on Transportation and Traffic Theory, Toronto, ON, Canada,",
            "year": 1983
        },
        {
            "authors": [
                "J.H. Banks"
            ],
            "title": "The two-capacity phenomenon: Some theoretical issues",
            "venue": "Transp. Res. Rec",
            "year": 1991
        },
        {
            "authors": [
                "K. Kim",
                "M.J. Cassidy"
            ],
            "title": "A capacity-increasing mechanism in freeway traffic",
            "venue": "Transp. Res. Part B Methodol",
            "year": 2012
        },
        {
            "authors": [
                "Cassidy",
                "M.J. An Empirical",
                "Theoretical Study of Freeway Weave Bottlenecks. 2009. Available online"
            ],
            "title": "https://escholarship",
            "venue": "org/uc/item/2970816w",
            "year": 2021
        },
        {
            "authors": [
                "B.S. Kerner"
            ],
            "title": "Experimental Features of Self-Organization in Traffic Flow",
            "venue": "Phys. Rev. Lett",
            "year": 1998
        },
        {
            "authors": [
                "B.S. Kerner"
            ],
            "title": "Three-phase traffic theory and highway capacity",
            "venue": "Phys. A Stat. Mech. Its Appl",
            "year": 2002
        },
        {
            "authors": [
                "F. Marczak",
                "W. Daamen",
                "C. Buisson"
            ],
            "title": "Empirical Analysis of Lane Changing Behavior at a Freeway Weaving Section",
            "venue": "In Proceedings of the 93th Annual Meeting of the TRB,",
            "year": 2014
        },
        {
            "authors": [
                "W. Liu",
                "K.Q. Chen",
                "Z.Z. Tian",
                "G.C. Yang"
            ],
            "title": "Capacity of Urban Arterial Weaving Sections under Lane Signal Control Strategy",
            "venue": "Transp. Res. Rec. J. Transp. Res. Board",
            "year": 2019
        },
        {
            "authors": [
                "M.J. Cassidy",
                "S. Ahn"
            ],
            "title": "Driver turn-taking behavior in congested freeway merges",
            "venue": "Transp. Res. Rec",
            "year": 2005
        },
        {
            "authors": [
                "M.J. Cassidy",
                "J. Rudjanakanoknad"
            ],
            "title": "Increasing the capacity of an isolated merge by metering its on-ramp",
            "venue": "Transp. Res. Part B Methodol",
            "year": 2005
        },
        {
            "authors": [
                "D. Chen",
                "S. Ahn"
            ],
            "title": "Capacity-drop at extended bottlenecks: Merge, diverge, and weave",
            "venue": "Transp. Res. Part B Methodol",
            "year": 2018
        },
        {
            "authors": [
                "Y. Zhou",
                "E. Chung",
                "M.E. Cholette",
                "A. Bhaskar"
            ],
            "title": "Real-Time Joint Estimation of Traffic States and Parameters Using Cell Transmission Model and Considering Capacity Drop",
            "venue": "In Proceedings of the 21st IEEE Conference on Intelligent Transportation Systems, Maui, HI, USA,",
            "year": 2018
        },
        {
            "authors": [
                "K. Chung",
                "J. Rudjanakanoknad",
                "M.J. Cassidy"
            ],
            "title": "Relation between traffic density and capacity drop at three freeway bottlenecks",
            "venue": "Transp. Res. Part B Methodol",
            "year": 2007
        },
        {
            "authors": [
                "Y. Lu",
                "S. Wong",
                "M. Zhang",
                "C.-W. Shu",
                "W. Chen"
            ],
            "title": "Explicit construction of entropy solutions for the Lighthill\u2013Whitham\u2013Richards traffic flow model with a piecewise quadratic flow\u2013density relationship",
            "venue": "Transp. Res. Part B Methodol",
            "year": 2008
        },
        {
            "authors": [
                "A. Srivastava",
                "N. Geroliminis"
            ],
            "title": "Empirical observations of capacity drop in freeway merges with ramp control and integration in a first-order model",
            "venue": "Transp. Res. Part C Emerg. Technol",
            "year": 2013
        },
        {
            "authors": [
                "C. Parzani",
                "C. Buisson"
            ],
            "title": "Second-Order Model and Capacity Drop at Merge",
            "venue": "Transp. Res. Rec. J. Transp. Res. Board",
            "year": 2012
        },
        {
            "authors": [
                "S. Oh",
                "H. Yeo"
            ],
            "title": "Estimation of Capacity Drop in Highway Merging Sections",
            "venue": "Transp. Res. Rec. J. Transp. Res. Board",
            "year": 2012
        },
        {
            "authors": [
                "J.H. Bick",
                "G.F. Newell"
            ],
            "title": "A continuum model for two-directional traffic flow",
            "venue": "Q. Appl. Math",
            "year": 1960
        },
        {
            "authors": [
                "H. Yeo"
            ],
            "title": "A proposed asymmetric microscopic traffic flow theory",
            "venue": "In Proceedings of the 88th Transportation Research Board Annual Meeting, Washington, DC, USA,",
            "year": 2009
        },
        {
            "authors": [
                "H. Yeo",
                "A. Skabardonis",
                "J. Halkias",
                "J. Colyar",
                "V. Alexiadis"
            ],
            "title": "Oversaturated freeway flow algorithm for use in next generation simulation",
            "venue": "Transp. Res. Rec",
            "year": 2008
        },
        {
            "authors": [
                "S.C. Calvert",
                "F.L.M. van Wageningen-Kessels",
                "S.P. Hoogendoorn"
            ],
            "title": "Capacity drop through reaction times in heterogeneous traffic",
            "venue": "J. Traffic Transp. Eng. 2018,",
            "year": 2018
        },
        {
            "authors": [
                "K. Yuan",
                "V.L. Knoop",
                "L. Leclercq",
                "S.P. Hoogendoorn"
            ],
            "title": "Capacity drop: A comparison between stop-and-go wave and standing queue at lane-drop bottleneck",
            "venue": "Transp. B Transp. Dyn. 2017,",
            "year": 2017
        },
        {
            "authors": [
                "W.-L. Jin",
                "Q.-J. Gan",
                "J.-P. Lebacque"
            ],
            "title": "A kinematic wave theory of capacity drop",
            "venue": "Transp. Res. Part B Methodol. 2015,",
            "year": 2022
        },
        {
            "authors": [
                "T. Monamy",
                "S. Haj-Salem",
                "J.-P. Lebacque"
            ],
            "title": "A macroscopic node model related to capacity drop",
            "venue": "Procedia Soc. Behav. Sci",
            "year": 2012
        },
        {
            "authors": [
                "Jin",
                "W.-L"
            ],
            "title": "A first-order behavioral model of capacity drop",
            "venue": "Transp. Res. Part B Methodol",
            "year": 2017
        },
        {
            "authors": [
                "L. Leclercq",
                "L.A. Laval",
                "N. Chiabaut"
            ],
            "title": "Capacity drops at merges: An endogenous model",
            "venue": "Transp. Res. Part B Methodol",
            "year": 2011
        },
        {
            "authors": [
                "D.J. Chen",
                "A. Sivastava",
                "S. Ahn",
                "T. Li"
            ],
            "title": "Traffic dynamics under speed disturbance in mixed traffic with automated and nonautomated vehicles",
            "venue": "Transp. Res. Part C",
            "year": 2019
        },
        {
            "authors": [
                "S. Oh",
                "H. Yeo"
            ],
            "title": "Impact of stop-and-go waves and lane changes on discharge rate in recovery flow",
            "venue": "Transp. Res. Part B Methodol",
            "year": 2015
        },
        {
            "authors": [
                "C. Zhang",
                "N. Sabar",
                "E. Chung",
                "A. Bhaskar",
                "X. Guo"
            ],
            "title": "Optimisation of lane-changing advisory at the motorway lane drop bottleneck",
            "venue": "Transp. Res. Part C Emerg. Technol",
            "year": 2019
        },
        {
            "authors": [
                "R. Rahman",
                "Z. Bin Azad",
                "B. Hasan"
            ],
            "title": "Densely-Populated Traffic Detection Using YOLOv5 and Non-maximum Suppression Ensembling",
            "venue": "In Proceedings of the International Conference on Big Data, IoT, and Machine Learning 2022, Sydney, Australia,",
            "year": 2022
        },
        {
            "authors": [
                "R. Ke",
                "Z. Li",
                "J. Tang",
                "Z. Pan",
                "Y. Wang"
            ],
            "title": "Real-Time Traffic Flow Parameter Estimation From UAV Video Based on Ensemble Classifier and Optical Flow",
            "venue": "IEEE Trans. Intell. Transp. Syst",
            "year": 2018
        },
        {
            "authors": [
                "X. Chen",
                "Z. Li",
                "Y. Yang",
                "L. Qi",
                "R. Ke"
            ],
            "title": "High-Resolution Vehicle Trajectory Extraction and Denoising From Aerial Videos",
            "venue": "IEEE Trans. Intell. Transp. Syst",
            "year": 2020
        },
        {
            "authors": [
                "C. Fuhs",
                "B. Parsons"
            ],
            "title": "Synthesis of Active Traffic Management Experiences in Europe and the United States; No. FHWA-HOP-10-031; Federal Highway Administration",
            "year": 2010
        },
        {
            "authors": [
                "J. Ferreira"
            ],
            "title": "Cooperative, Connected and Automated Mobility (CCAM): Technologies and Applications",
            "venue": "Electronics 2019,",
            "year": 2019
        },
        {
            "authors": [
                "N. Slamnik-Krijestorac",
                "G.M. Yilma",
                "M. Liebsch",
                "F.Z. Yousaf",
                "J. Marquez-Barja"
            ],
            "title": "Collaborative orchestration of multi-domain edges from a Connected, Cooperative and Automated Mobility (CCAM) perspective",
            "venue": "IEEE Trans. Mob. Comput. 2021,",
            "year": 2021
        },
        {
            "authors": [
                "M. Centenaro",
                "S. Berlato",
                "R. Carbone",
                "G. Burzio",
                "G.F. Cordella",
                "R. Riggio",
                "S. Ranise"
            ],
            "title": "Safety-Related Cooperative, Connected, and Automated Mobility Services: Interplay Between Functional and Security Requirements",
            "venue": "IEEE Veh. Technol. Mag",
            "year": 2021
        },
        {
            "authors": [
                "J. Sawant",
                "U. Chaskar",
                "D. Ginoya"
            ],
            "title": "Robust Control of Cooperative Adaptive Cruise Control in the Absence of Information About Preceding Vehicle Acceleration",
            "venue": "IEEE Trans. Intell. Transp. Syst",
            "year": 2021
        },
        {
            "authors": [
                "L. Cui",
                "Z. Chen",
                "A. Wang",
                "J. Hu",
                "B.B. Park"
            ],
            "title": "Development of a Robust Cooperative Adaptive Cruise Control With Dynamic Topology",
            "venue": "IEEE Trans. Intell. Transp. Syst",
            "year": 2022
        },
        {
            "authors": [
                "M. Alonso Raposo",
                "M. Grosso",
                "J. Despr\u00e9s",
                "E. Fern\u00e1ndez Mac\u00edas",
                "C. Galassi",
                "A. Krasenbrink",
                "J. Krause",
                "L. Levati",
                "A. Mourtzouchou",
                "B. Saveyn",
                "Connected et al. An Analysis of Possible Socio-Economic Effects of a Cooperative",
                "Automated Mobility (CCAM) in Europe",
                "Technical Report",
                "Publications Office of the European Union"
            ],
            "title": "Luxembourg, 2018; pp",
            "venue": "1\u2013212. Available online: https://core.ac.uk/download/pdf/157830385.pdf",
            "year": 2022
        },
        {
            "authors": [
                "R. Munoz",
                "F. Vazquez-Gallego",
                "R. Casellas",
                "R. Vilalta",
                "R. Sedar",
                "P. Alemany",
                "R. Martinez",
                "J. Alonso-Zarate",
                "A. Papageorgiou",
                "M Catalan-Cid"
            ],
            "title": "5GCroCo Barcelona Trial Site for Cross-border Anticipated Cooperative Collision Avoidance",
            "venue": "In Proceedings of the 2020 European Conference on Networks and Communications (EuCNC), Dubrovnik, Croatia,",
            "year": 2020
        },
        {
            "authors": [
                "W. Lemstra"
            ],
            "title": "Leadership with 5G in Europe: Two contrasting images of the future, with policy and regulatory implications",
            "venue": "Telecommun. Policy 2018,",
            "year": 2018
        },
        {
            "authors": [
                "G. Qu",
                "B. Qiu",
                "Y. Zhang",
                "H. Wang"
            ],
            "title": "The Industry Situation and Inspiration of Intelligent Connected Vehicles in Europe, America and Japan",
            "venue": "Cyber Secur. Intell. Anal",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "Citation: Yang, L.; Wang, C.; Li, Z.\nTunnel Traffic Evolution during\nCapacity Drop Based on High-\nResolution Vehicle Trajectory Data.\nAlgorithms 2022, 15, 240. https://\ndoi.org/10.3390/a15070240\nAcademic Editor: Frank Werner\nReceived: 5 June 2022\nAccepted: 4 July 2022\nPublished: 12 July 2022\nPublisher\u2019s Note: MDPI stays neutral\nwith regard to jurisdictional claims in\npublished maps and institutional affil-\niations.\nCopyright: \u00a9 2022 by the authors.\nLicensee MDPI, Basel, Switzerland.\nThis article is an open access article\ndistributed under the terms and\nconditions of the Creative Commons\nAttribution (CC BY) license (https://\ncreativecommons.org/licenses/by/\n4.0/).\nKeywords: vehicle trajectories; capacity drop; tunnel bottleneck; lane change"
        },
        {
            "heading": "1. Introduction",
            "text": "With the acceleration of urbanization and the improvement of motorization level in urban traffic, urban tunnel bears increasing traffic pressure, which is the most common bottleneck type of urban traffic [1\u20133]. Unlike open ground traffic, urban tunnels have typical characteristics such as limited building space, exceptional driving environment, unique driving rules, and significant internal and external brightness differences. The maximum discharge flow measured downstream decreases immediately when a bottleneck is activated. This phenomenon is called \u201ccapacity drop\u201d. Vehicles are more susceptible to interference from various factors and form an agglomeration effect of traffic flow disturbance, causing tunnel congestion and triggering the \u201ccapacity drop\u201d phenomenon [4\u20136]. The actual vehicle flow rate of the tunnel is significantly lower than the standard capacity. Previous research shows that capacity drop has attracted significant attention from researchers. Loop detector data are generally used to estimate the occurrence of the capacity drop to establish the prediction model. Some research used vehicle trajectory data from the simulation model for capacity drop analysis. In our study, the advancement is that we applied the empirical vehicle trajectory data extracted from cameras to explore the characteristics of the traffic during the capacity drop at the tunnel bottleneck section. We also explored the influence of lane-changing behaviors on the capacity drop with empirical vehicle trajectory data to establish the prediction model. Nanjing Yingtian Street Tunnel, as one of the fast channels connecting Jiangbei New Area and the main urban area, also undertakes the significant demand of commuting across\nAlgorithms 2022, 15, 240. https://doi.org/10.3390/a15070240 https://www.mdpi.com/journal/algorithms\nAlgorithms 2022, 15, 240 2 of 13\nthe river. On the monitoring video platform of the whole tunnel, high-precision vehicle trajectory data are obtained, and the characteristics of the data are statistically analyzed."
        },
        {
            "heading": "2. Literature Review",
            "text": "Researchers observed the phenomenon of the capacity drop in early studies. Initially, the concept of the \u201ccapacity drop\u201d first appeared in the 1960s when Edie [7] and Greenberg [8] obtained two significantly different areas by drawing the flow\u2013density point diagram of the Lincoln Tunnel in the United States. There are free flow and congested flow. It has a significant flow difference at the regional junction of two areas, the \u201ccapacity drop\u201d phenomenon. Koshi draws the \u201creverse-\u03bb\u201d shape of the flow\u2013density point diagram and the discontinuity of the change from free flow to congested flow to explain the capacity drop [9]. He believed that the driver in congested traffic flow is more inclined to have a more considerable car-following distance, but this comment lacks corresponding data support. The range of 5%-30% drop in the maximum discharge flow at the bottleneck has been widely observed, bringing excessive travel delays and safety concerns [10\u201312]. Previous research has investigated the cause of capacity drop using aggregated traffic data from loop detectors. Kerner proposed the \u201cthree-phase traffic\u201d theory and the concept of \u201cphase transition\u201d [13\u201315] and believed that the \u201cphase transition\u201d process of traffic flow caused the \u201cbreakdown phenomenon\u201d of a sudden decrease in vehicle speed, resulting in capacity drop. Studies have observed capacity drop in areas where lane changing often occurs, near weaving segments [16,17], merging [18\u201320], diverging [21], and lane-drop [22] bottlenecks. Some researchers found that the magnitude of the capacity drop is associated with the density [23,24], the demand of ramp flows [25], the speed at the bottleneck [26], and the number of lanes [27]. Recent studies explored the capacity drop from the human behavior perspective. Based on Newell\u2019s hyperbolic theory [28], Yeo conducted statistical analysis by intercepting part of the vehicle trajectory data in Next Generation Simulation (NGSIM) [29]. He elaborated and explained the asymmetric driving behavior theory [30] and effectively connected the capacity drop phenomenon with this theory. It is believed that after experiencing congestion, drivers tend to adopt a more considerable headway distance during acceleration. The shock wave formed by the disturbance during the driving process has a more noticeable impact on capacity drop [31,32]. The macroscopic node model and kinematic wave theory are proposed to predict the causes of the capacity drop [33,34]. Some researchers believe that car-following behaviors are the cause of the capacity drop. For example, Jin established a behavior model of first-order capacity drop at the continuous bottleneck based on the Lighthill\u2013Whitham\u2013Richards (LWR) model [35,36], taking the limited acceleration of the vehicle as an additional constraint of the optimal model of traffic flow at the bottleneck. More recently, Chen et al. revealed that combining different acceleration rates and desired driving behavior speeds induced voids and reduced capacity [37]. Through research and analysis of NGSIM data, Simon Oh quantified the traffic flow generated by stop-and-go waves and lane changing downstream of the bottleneck [38]. On the other hand, Zhang et al. considered the lane changer\u2019s insertion speed as a factor in AIMSUM, a traffic simulation software. They found that lane-changing vehicles with a high insertion speed could offset the capacity drop [39]."
        },
        {
            "heading": "3. Tunnel Vehicle Trajectory Data Extraction",
            "text": ""
        },
        {
            "heading": "3.1. Extraction of Fixed-Point Vehicle Trajectory in the Tunnel",
            "text": "To obtain each vehicle\u2019s spatial and temporal coordinate data in the tunnel monitoring field of view, it is necessary to identify and track each vehicle in the video. Firstly, each image frame is binarized, and the threshold value of vehicle identification size is set to realize each vehicle\u2019s rough detection and identification. To further improve the accuracy and speed of detection, this paper adopts the emerging deep learning algorithm You Only Look Once (YOLO) v5 to recognize and detect moving targets in monitoring [40,41]. Then, the intermittent trajectory matching and missing trajectory completion are performed based\nAlgorithms 2022, 15, 240 3 of 13\non the speed limit judgment data association algorithm for the primary construction of vehicle trajectories. Then, the coordinate conversion method is applied to map the image coordinates to the Frenet coordinates along the lane and perpendicular to the direction of the lane. Finally, the overall algorithm of empirical mode decomposition (EMD) noise reduction is used to reduce the trajectory error and improve the trajectory accuracy at the fixed point of the tunnel [42]."
        },
        {
            "heading": "3.2. Reconstruction of Vehicle Track in Entire Space\u2013Time of Tunnel",
            "text": "There is a blind area of track detection of 40 to 70 m between the adjacent video surveillance of the tunnel. To obtain the space\u2013time continuous track of vehicles in tunnels and ensure the track\u2019s authenticity, the curves represent the track of the vehicle movement, which is improved based on the cubic Hermite interpolation method. The cubic polynomial function is introduced into the Hermite interpolation algorithm to solve the slope. This method does not need other vehicle motion information, the algorithm complexity is low, and the interpolation accuracy is higher than linear interpolation, cubic spline interpolation, and cubic Hermite interpolation. The overall schematic diagram is shown in Figure 1.\nAlgorithms 2022, 15, x FOR PEER REVIEW 3 of 15\nto realize each vehicle\u2019s rough detection and identification. To further improve the accu-\nracy and speed of detection, this paper adopts the emerging deep learning algorithm You\nOnly Look Once (YOLO) v5 to recognize and detect moving targets in monitoring [40,41].\nThen, the intermittent trajectory matching and missing trajectory completion are per-\nformed based on the speed limit judgment data association algorithm for the primary con-\nstruction of vehicle trajectories. Then, the coordinate conversion method is applied to map\nthe image coordinates to the Frenet c ordinates along the lan and perpe dic lar to the\ndirection of the lane. Finally, the overall algor thm of empirica mode decomposition\n(EMD) oise reduction is used to r duce the trajectory error a imp ove the t ajectory\naccuracy at the fixed point of the tunnel [42].\n3.2. Reconstruction of Vehicle Track in Entire Space\u2013Time of Tunnel\nThere is a blind area of track detection of 40 to 70 m between the adjacent video sur-\nveillance of the tunnel. To obtain the space\u2013time continuous track of vehicles in tunnels\nand ensure the track\u2019s authenticity, the curves represent the track of the vehicle move-\nment, which is improved based on the cubic Hermite interpolation method. The cubic\npolynomial function is introduced into the Hermite interpolation algorithm to solve the\nslope. This method does not need other vehicle motion infor ation, the algorithm com-\nplexity is low, and the interpolation accuracy is higher than linear interpolation, cubic\nspline interpolation, nd cubic Hermite i terpolation. The overall schematic diagram is\nshown in Figure 1.\nAlgorithms 2022, 15, x FOR PEER REVIEW 4 of 15\nFigure 1. Schematic diagram of extraction steps of space\u2013time trajectory.\n4. Analysis of Capacity Drop Based on Phase Transition-Theory\nThe capacity drop indicates the difference in capacity between the crowded and non-\ncrowded flow. Many studies have taken the occurrence of congestion, queuing, and other\nphenomena as the prerequisites for the capacity drop. In this section, the inclined cumu-\nlative curve is used to identify the moment of traffic capacity drop at each section of the\ntunnel. Combined with Kerner\u2019s three-phase traffic flow theory, the temporal and spatial\ncharacteristics of vehicle speed are used as indicators to draw the temporal and spatial\ncharacteristics of the vehicle track in each lane. The phase change points in vehicle track\ndata are extracted in combination with various phase characteristics to study the correla-\ntion of traffic capacity drop.\n4.1. Identification of Tunnel Capacity Drop\nThe advantage of the vehicle oblique accumulation curve is that it can highlight the\nphase characteristics of the flow change at the section to identify the flow change point.\nHowever, the abrupt flow is not always the phenomenon of capacity drop. It is not enough\nto identify the moment of the capacity drop with the inclined cumulative curve of vehi-\ncles. By combining the inclined cumulative curve of time occupancy and recognizing the\nchanging trend of a vehicle passing time at the section, the moment of the capacity drop\ncan be more accurately determined. We draw the cumulative vehicle curve and the cu-\nmulative curve of time occupancy in the oblique coordinate system by combining the bot-\ntleneck characteristics and state parameters. Then, we enlarge the traffic change charac-\nteristics at the section to determine the moment of traffic capacity drop. The basic principle\nof the oblique accumulation curve is as follows:\nBased on the original cumulative curve of the section, a background value is sub-\ntracted. The change characteristics of the curve are visually enlarged, and the change\npoints of vehicle arrival intensity and vehicle delay at the section are identified. The curve\nformula is as follows:\n\ud835\udc49(\ud835\udc65, \ud835\udc61) = \ud835\udc41(\ud835\udc65, \ud835\udc61) \u2212 \ud835\udc5e\ud835\udc5c(\ud835\udc65) \u2219 \ud835\udc61\n\ud835\udc42(\ud835\udc65, \ud835\udc61) = \ud835\udc47(\ud835\udc65, \ud835\udc61) \u2212 \ud835\udc61\ud835\udc5c(\ud835\udc65) \u2219 \ud835\udc61\nwhere:\nV(\ud835\udc65, \ud835\udc61)\u2014the cumulative number of arrivals of vehicles passing through section x\nwithin t after adjustment;\n\ud835\udc42(\ud835\udc65, \ud835\udc61)\u2014the cumulative curve of the time occupancy rate of vehicles passing through\nsection x within t after adjustment;\n\ud835\udc41(\ud835\udc65, \ud835\udc61)\u2014the cumulative number of arrivals of vehicles passing through section x\nwithin t;\nFigure 1. Sche atic iagra of extraction steps of space\u2013time trajectory.\nAlgorithms 2022, 15, 240 4 of 13"
        },
        {
            "heading": "4. Analysis of Capacity Drop Based on Phase Transition-Theory",
            "text": "The capacity drop indicates the difference in capacity between the crowded and non-crowded flow. Many studies have taken the occurrence of congestion, queuing, and other phenomena as the prerequisites for the capacity drop. In this section, the inclined cumulative curve is used to identify the moment of traffic capacity drop at each section of the tunnel. Combined with Kerner\u2019s three-phase traffic flow theory, the temporal and spatial characteristics of vehicle speed are used as indicators to draw the temporal and spatial characteristics of the vehicle track in each lane. The phase change points in vehicle track data are extracted in combination with various phase characteristics to study the correlation of traffic capacity drop."
        },
        {
            "heading": "4.1. Identification of Tunnel Capacity Drop",
            "text": "The advantage of the vehicle oblique accumulation curve is that it can highlight the phase characteristics of the flow change at the section to identify the flow change point. However, the abrupt flow is not always the phenomenon of capacity drop. It is not enough to identify the moment of the capacity drop with the inclined cumulative curve of vehicles. By combining the inclined cumulative curve of time occupancy and recognizing the changing trend of a vehicle passing time at the section, the moment of the capacity drop can be more accurately determined. We draw the cumulative vehicle curve and the cumulative curve of time occupancy in the oblique coordinate system by combining the bottleneck characteristics and state parameters. Then, we enlarge the traffic change characteristics at the section to determine the moment of traffic capacity drop. The basic principle of the oblique accumulation curve is as follows: Based on the original cumulative curve of the section, a background value is subtracted. The change characteristics of the curve are visually enlarged, and the change points of vehicle arrival intensity and vehicle delay at the section are identified. The curve formula is as follows:\nV(x, t) = N(x, t)\u2212 qo(x)\u00b7t O(x, t) = T(x, t)\u2212 to(x)\u00b7t\nwhere: V(x, t)\u2014the cumulative number of arrivals of vehicles passing through section x within t after adjustment; O(x, t)\u2014the cumulative curve of the time occupancy rate of vehicles passing through section x within t after adjustment; N(x, t)\u2014the cumulative number of arrivals of vehicles passing through section x within t; T(x, t)\u2014the cumulative curve of the time occupancy rate of vehicles passing through section x within t; qo(x)\u2014background flow at section x, usually the maximum capacity at this section; to(x)\u2014undetermined parameter at section x, unit s/h. Based on the construction method of the oblique cumulative curve of the appealing vehicle and combined with the research division of this area in this paper, the oblique cumulative curve of the critical sections (tunnel entrance and exit, slope change points, etc.), in the whole region of the tunnel is constructed. The oblique cumulative curves display \u201cvirtual departures,\u201d such that the vertical displacements between any two are the excess vehicle accumulations (queueing) on the intervening tunnel segment. With the oblique coordinate system, each curve displays the quantity, the virtual vehicle counts to time, minus a background reduction. We conducted the adjustment tests for the background parameters of each section. The original parameter value is the average flow multiplied by the interval extending from the curves\u2019 start time to the current time. Then, we tested the parameters varying from \u221210% to 10% of the original value for final use. After several adjustment tests, the background parameters of each section are determined to significantly enhance the visual effect of the flow rate change of sections.\nAlgorithms 2022, 15, 240 5 of 13\nIn Figure 2, the oblique accumulation curves of vehicles at the four adjacent sections are all piecewise approximately linear, showing a stepped characteristic. As shown in the figure below, at 123 s, the traffic capacity first drops in the bottleneck section. Secondly, the traffic flow leaving the area downstream of the bottleneck is limited to the merge bottleneck and lags the merge bottleneck. At 131 s, the flow suddenly changes. At the same time, the congestion at the merge bottleneck gradually spreads to the segment at the upstream section. Further, at 177 s, the traffic capacity drops. By calculating the flow rate at the bottleneck section, the capacity before congestion formation is estimated to be 6700 veh/h, while the discharge flow after congestion formation is estimated to be 5850 veh/h. The magnitude of capacity drop at the merge bottleneck is 12.7%. Algorithms 2022, 15, x FOR PEER REVIEW 6 of 15\nAlgorithms 2022, 15, 240 6 of 13"
        },
        {
            "heading": "4.2. Analysis of Capacity Drop Based on Traffic Flow",
            "text": "This section uses vehicle speed\u2019s temporal and spatial characteristics as reference indicators, and the three main lanes\u2019 temporal and spatial trajectory diagrams are homogeneously abstracted. We then draw the three-phase traffic flow temporal and spatial characteristics of the main lanes (see Figure 3). Kerner\u2019s empirical research shows that there are usually two main blocking patterns at a single bottleneck: the synchronized flow pattern (phase S) and the wide moving jam pattern (phase J). In Kerner\u2019s theory, the phases J and S in congested traffic are observed outcomes in universal spatial\u2013temporal features of real traffic data. Asynchronous flow appears at the bottleneck at the beginning of the congestion and propagates upstream of the bottleneck. The downstream front of the synchronized flow is often fixed at a bottleneck. In contrast, a wide-moving jam could occur spontaneously in this synchronous flow. A wide moving jam is meant to reflect the characteristic feature of the jam to propagate through any other state of traffic flow and any bottleneck while maintaining the velocity of the downstream jam front. The speed within the wide moving jam could be very low, and thus this pattern is also called stop-and-go traffic. Algorithms 2022, 15, x FOR PEER REVIEW 8 of 15\nFigure 3. Analysis of tunnel capacity drop based on three-phase traffic flow.\n5. Analysis of Tunnel Driving Behavior\nThe capacity drop means that the traffic flow follows different operating rules in the\ntwo states of free flow and congested flow. The microscopic level is manifested as the\ncharacteristic difference of vehicle trajectory. When a certain percentage of drivers in the\ntransportation system are affected by nearby driving vehicles, the traffic flow will lose\nstability, manifesting as congestion, traffic capacity drop, and other phenomena summa-\nrized as the \u201cdisturbance\u201d. The significant source of disturbance in this study is the decel-\neration behavior of vehicles passing through the tunnel.\n5.1. Analysis of Headway Distribution\nThe headway indicates the time difference between the two vehicles passing through\nthe same position on the road and represents the maximum reaction time of the driver\nbehind the vehicle when the current vehicle brakes suddenly. The headway distance is\nclosely related to the traffic flow composition and driving behavior and is an essential\nindicator of road capacity, service level, and driving safety. The probability distribution\nof headway is shown in Figure 4.\nThe time headway for different driving speeds ranges from 2.04 s to 2.52 s in syn-\nchronous flow and from 2.09 s to 3.76 in the wide moving jam. The time headway distri-\nbution for the two traffic phases shows a clear difference. In synchronous flow, the dis-\nFigure 3. Analysis f t l city drop based on three-phase traffic flow.\nThere is a connection between the capacity characteristic point and the phase change boundary of the three-phase traffic flow.\nAlgorithms 2022, 15, 240 7 of 13\n(1) F->S: Free flow changes to synchronous flow. Traffic crash occurs with the spontaneous start and propagation of the synchronous flow (the upstream boundary of the synchronous flow propagates upstream, while the downstream boundary is fixed at the bottleneck). According to the black dotted arrow in the distance\u2013time diagrams in the first row of subfigures in Figure 3, the vehicle begins to slow down when approaching the upstream interface, and the bottleneck capacity does not change significantly at this time. (2) S->J: Synchronous flow changes to jam flow. Some narrow moving jams (narrow moving jams) appeared in this state, and then they evolved into wide moving jams (J appeared). At this time, the capacity has been significantly reduced.\nCombined with the characteristic points of capacity drop in the temporal and spatial diagram of the vehicle trajectory in the figure, it is found that the vehicle speed decreases significantly when the traffic flow is approaching the interface. It causes drivers to take a more considerable distance between vehicles, leading to the phenomenon of \u201ctraffic capacity drop\u201d at the macro level. From the flow\u2013density diagrams in the subfigures of Figure 3, it can be found that the traffic capacity drop points are all near the synchronous flow, and vehicles exhibit a significant speed reduction. The capacity decreased rapidly when the synchronous flow transitioned to the wide moving jam flow. In the synchronous flow state, the vehicle speed decreases while the density increases, and the traffic capacity does not change significantly. The synchronous flow is more like the accumulation process of disturbance. When the disturbance is sufficient, the jam flow occurs."
        },
        {
            "heading": "5. Analysis of Tunnel Driving Behavior",
            "text": "The capacity drop means that the traffic flow follows different operating rules in the two states of free flow and congested flow. The microscopic level is manifested as the characteristic difference of vehicle trajectory. When a certain percentage of drivers in the transportation system are affected by nearby driving vehicles, the traffic flow will lose stability, manifesting as congestion, traffic capacity drop, and other phenomena summarized as the \u201cdisturbance\u201d. The significant source of disturbance in this study is the deceleration behavior of vehicles passing through the tunnel."
        },
        {
            "heading": "5.1. Analysis of Headway Distribution",
            "text": "The headway indicates the time difference between the two vehicles passing through the same position on the road and represents the maximum reaction time of the driver behind the vehicle when the current vehicle brakes suddenly. The headway distance is closely related to the traffic flow composition and driving behavior and is an essential indicator of road capacity, service level, and driving safety. The probability distribution of headway is shown in Figure 4. The time headway for different driving speeds ranges from 2.04 s to 2.52 s in synchronous flow and from 2.09 s to 3.76 in the wide moving jam. The time headway distribution for the two traffic phases shows a clear difference. In synchronous flow, the disturbance caused by the lane-changing behavior forces the following vehicle to speed adaptation, varying from high speed to low speed. The traffic inflow at the bottleneck is similar to the extrusion process, and the headway distance is gradually compressed. Finally, the headway decreases slightly, explaining that the road system still maintains a high flow input in the synchronous flow state. The traffic flow at the bottleneck has been compressed in the wide moving jam flow. The driver tends to drive at a higher distance for safety considerations in this state. In addition, the driver will have a certain psychological threshold of safe distance, even in a completely stationary state. There will still be a particular gap between vehicles, so it can be explained that in the state of wide moving jam flow, the distance between the fronts has been compressed because of the significantly reduced speed. The probability distribution of headway shows that the lower the speed, the larger the value.\nAlgorithms 2022, 15, 240 8 of 13\nAlgorithms 2022, 15, x FOR PEER REVIEW 9 of 15 turbance caused by the lane-changing behavior forces the following vehicle to speed adaptation, varying from high speed to low speed. The traffic inflow at the bottleneck is similar to the extrusion process, and the headway distance is gradually compressed. Finally, the headway decreases slightly, explaining that the road system still maintains a high flow input in the synchronous flow state.\nThe traffic flow at the bottleneck has been compressed in the wide moving jam flow.\nThe driver tends to drive at a higher distance for safety considerations in this state. In\naddition, the driver will have a certain psychological threshold of safe distance, even in a\ncompletely stationary state. There will still be a particular gap between vehicles, so it can\nbe explained that in the state of wide moving jam flow, the distance between the fronts\nhas been compressed because of the significantly reduced speed. The probability distri-\nbution of headway shows that the lower the speed, the larger the value."
        },
        {
            "heading": "5.2. Analysis of Lane-Change Speed",
            "text": "The salient feature of a vehicle changing lanes is vehicle speed change. When the\ndriver has an intention to change lanes, he usually takes a deceleration action, waits for\nthe opportunity to enter the target lane, and adjusts his speed in the target lane to enter\nthe stable following state of the target lane as soon as possible. Speed features of lane\nchange vehicles are shown in Figure 5.\nProbability distribution of headway. (a) Pro ability fitting di gram of speed-he dway distributio in 3D, (b) Pro ability fitting diagram of sp ed-headway distribution in 2 , (c) c tic diagram of the headway probability distribution fitting in the synchronous flow state, (d) Schematic diagram of the headway probability distribution fitting in the blocked flow state.\ni l c i l is vehicle spee chan e. as an intention to change lanes, he us ally takes a deceleration action, waits for the\nopp rtunity to enter the arget lane, and adjusts hi speed in the arget lane to enter the stable following state of the target lan as soon a possible. Speed features of lane chang vehicl s are shown in Figure 5.\naccumulates over time and ultimately causes the traffic capacity to decrease.\nWhen the free flow of the study area ch nges to a congested flow the lane-changing\nvehicles in the proce s of reduced capacity show a similar trend as before the reduced\ncapacity. During his time, the speed exhibits large fluctuations and the fluctuating speed\nof the vehicle during the lane change. The following vehicles cause more significant disturbances, causing the drivers of the following vehicles to vacate a more substantial gap for safety reasons, thus causing a decrease in traffic capacity.\nAfter the traffic capacity declines, the road shows more severe congestion, and lanechanging vehicles show a low-speed and stable trend. There are significant outliers in the spe d box diagr m a the lane-changing decision-making stage in this stat . After inspection, these ou liers are in the upstre m input area or ramp, nd th cong tion stat has not spread to this area.\nAlgorithms 2022, 15, 240 9 of 13 Algorithms 2022, 15, x FOR PEER REVIEW 11 of 15\n(b) Speed features of lane change during capacity drop\n(c) Speed features of lane change after capacity drop\nFigure 5. Speed features of lane change vehicles.\nWe further calculate the speed change of vehicles on the target lane and original lane. The speed change rate ai is the change of vehicle i\u2019s speed after and before the lane change divided by the original speed. A positive rate indicates that the speed increases after the lane change and vice versa. The results on different lanes are summarized in Table 1. For lane-changing vehicles and following vehicles on the target lane, the speed of most vehicles is reduced during the lane-changing process. The lane-changing vehicle in the outer\nFigure 5. Speed features of lane change vehicles.\nWhen the capacity decreases, the confluence bottleneck area is in a smooth state. When the driver intends to change lanes, he can quickly adjust his speed and complete the lane-changing behavior faster. At the same time, according to the trajectory characteristics of the previous chapter, the area runs at a higher speed and a more considerable distance. The lane-changing driv r has complet space for speed adaptatio in short time a d then changes lanes. As the upstream flow increases, the state of this area enters the synchronous flow phase. The deceleration behavior of the lane-changing driver in the original lane decision phase and the speed adjustment behavior in the execution phase cause the following vehicle to adapt to the speed. The disturbance to the following vehicle accumulates over time and ultimately causes the traffic capacity to decrease. When the free flow of the study area changes to a congested flow, the lane-changing vehicles in the process of reduced capacity show a similar trend as before the reduced capacity. During this time, the speed exhibits large fluctuations and the fluctuating speed\nAlgorithms 2022, 15, 240 10 of 13\nof the vehicle during the lane change. The following vehicles cause more significant disturbances, causing the drivers of the following vehicles to vacate a more substantial gap for safety reasons, thus causing a decrease in traffic capacity. After the traffic capacity declines, the road shows more severe congestion, and lanechanging vehicles show a low-speed and stable trend. There are significant outliers in the speed box diagram at the lane-changing decision-making stage in this state. After inspection, these outliers are in the upstream input area or ramp, and the congestion state has not spread to this area. We further calculate the speed change of vehicles on the target lane and original lane. The speed change rate ai is the change of vehicle i\u2019s speed after and before the lane change divided by the original speed. A positive rate indicates that the speed increases after the lane change and vice versa. The results on different lanes are summarized in Table 1. For lane-changing vehicles and following vehicles on the target lane, the speed of most vehicles is reduced during the lane-changing process. The lane-changing vehicle in the outer lane has a more serious speed reduction. When the vehicle changes lanes to the inner lane, its speed increases. The main reason is that the inner lane runs relatively smoothly with less disturbance. The driver of a lane-changing vehicle can better adjust its driving state after entering the inner lane because the speed has increased. For the following vehicle on the original lane, the standard deviation of the parameter is relatively small during the lane change, which means that the original lane is less disturbed, and the speed fluctuation reflected is less."
        },
        {
            "heading": "6. Conclusions and Discussion",
            "text": "This paper constructs the capacity drop analysis using video image processing technology to extract high-precision vehicle trajectory data. The article analyzes the characteristics of the evolution process of traffic congestion at the bottleneck in a tunnel section. The capacity drop is captured by plotting the cumulative vehicle count curves. The capacity at the merge bottleneck is found to be 6700 veh/h, while the magnitude of the capacity drop is estimated to be 12.7%. We also explored the driving characteristics related to the occurrence of the capacity drop. The results show that the time headway for different driving speeds ranges from 2.04 s to 2.52 s in synchronous flow and from 2.09 s to 3.76 in the wide moving jam, which indicates a clear difference between the two traffic phases. Based on the analysis, the main findings are summarized as follows: (1) we captured the dynamic process of tunnel traffic capacity drop involving free flow and congested flow; (2) the capacity drop in the diagrams shows the difference between congested flow and non-congested flow, and deep analysis shows the different driving characteristics of drivers in the two states; (3) the influence of lane-changing behavior on the capacity drop is captured by analyzing the driving behaviors. In the free flow state, the disturbance caused by lane-changing can be quickly eliminated. With the increase in vehicle count, frequent lane-changing behavior will accumulate disturbance. When the disturbance reaches a certain degree, congestion will occur, and the speed of vehicles will drop sharply, resulting in a capacity drop. The study\u2019s findings can provide evidence of explanations of causes of\nAlgorithms 2022, 15, 240 11 of 13\ncapacity in tunnel bottlenecks in urban areas, supporting real-time traffic control strategies to preserve tunnel capacity. The algorithm proposed in the study has the potential for applications in engineering. For example, the traffic control center can use the algorithm to accurately monitor and predict traffic conditions. Once the capacity drop is captured or predicted, we can quickly inform the drivers about the upcoming congestions within the tunnel via roadside variable message signs or vehicle onboard displays to take some precautions. In addition, we can apply active traffic management (variable speed limit, ramp metering, lane control, etc.), techniques to prevent the drop in tunnel capacity further and maintain a high flow rate [43]. Finally, as we explored the vehicle driving behaviors that trigger the capacity drop, we can apply some vehicle behavior control measures (such as lane change regulations) to prevent the disturbance that causes capacity drop. Those are some efforts that can be conducted for engineering applications based on the algorithms in our research. In our research, we investigated the vehicle driving behaviors that cause the capacity drop in tunnel traffic. The vehicle movements can be coordinated via the cooperative connected and automated mobility (CCAM) technique to prevent the occurrence of capacity drop and congestion. Cooperative connected and automated mobility (CCAM) aims to achieve a safer, more efficient, and more comfortable mobility mode by coordinating vehicle motion states with sharing information [44]. CCAM mainly includes the technology of vehicular communications, automated driving, and cooperating transportation systems. Recently, numerical research proposed a series of innovative technology for CCAM, such as 5G-SDN-MPTCP-based communication systems [45], multi-tier orchestration platform architectures [46], safety-related assessment platforms [47], and a significant number of cooperative adaptive cruising control algorithms [48,49]. There are also some evaluation and incentive systems related to the social and economic benefits of CCAM. State-of-the-art CCAM has been applied in practices in Europe, America, and Asia. For example, Europe conducted a project named H2020 5GCroCo to define a successful path toward providing CCAM services along with cross-border scenarios and reduce the uncertainties of an actual 5G cross-border deployment [50]. A Plan for Europe is conducted to achieve 5G deployment along the main transport corridors for autonomous vehicles in European Union [51]. America has carried out a series of travel services by connected and automated vehicles, such as MILO in Texas, ARIBO in North Carolina, AAA, and Nevada [52]. Our research found that the disturbance caused by lane changes, especially when the disturbance reaches a certain degree, significantly impacts traffic stability and capacity drop. Thus, we can coordinate and control the vehicle lane change moment via the CCAM, to control the cumulative disturbance under the critical threshold. The proposed algorithm can help identify this threshold by analyzing the traffic flow and vehicle trajectory samples. Additionally, the algorithm should be slightly updated to identify more driving parameters for the CCAM system, such as headway, the gap for a lane change, acceleration/deceleration rate, etc.\nAuthor Contributions: Conceptualization, L.Y. and Z.L.; methodology, L.Y.; validation, L.Y. and C.W.; formal analysis, L.Y.; writing\u2014original draft preparation, L.Y.; writing\u2014review and editing, C.W. All authors have read and agreed to the published version of the manuscript.\nFunding: This research received no external funding.\nInstitutional Review Board Statement: Not applicable.\nInformed Consent Statement: Not applicable.\nData Availability Statement: The public can access the vehicle trajectory data used for this research on the website www.seutraffic.com.\nConflicts of Interest: The authors declare no conflict of interest.\nAlgorithms 2022, 15, 240 12 of 13"
        }
    ],
    "title": "Tunnel Traffic Evolution during Capacity Drop Based on High-Resolution Vehicle Trajectory Data",
    "year": 2022
}