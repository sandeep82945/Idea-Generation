{
    "abstractText": "This article describes an auto-zero stabilized voltage buffer that achieves low offset and low noise with sub-pA input current. A high gain stabilization loop is used to periodically cancel the buffer\u2019s offset. The loop itself is periodically disconnected from the buffer and auto-zeroed, during which its bandwidth is reduced to reduce the associated noise folding. However, this also reduces its offset correction range, and so to avoid overloading, its initial offset is digitally trimmed. To break up the correlation between the residual low-frequency (LF) noise of the auto-zero and stabilization phases, the loop is periodically chopped, which significantly reduces the buffer\u2019s LF noise. Finally, the duty-cycle of the two phases is optimized to bring the buffer\u2019s LF noise density close to \u221a 2 times its white noise density (14 nV/ \u221a Hz), which is the fundamental limit of an AZ amplifier. The buffer also achieves a constant and low input current (0.8 pA), as well as a state-of-the-art offset (0.4 \u03bcV).",
    "authors": [
        {
            "affiliations": [],
            "name": "Thije Rooijers"
        },
        {
            "affiliations": [],
            "name": "Johan H. Huijsing"
        },
        {
            "affiliations": [],
            "name": "Kofi A. A. Makinwa"
        }
    ],
    "id": "SP:3cb4abe78904cb9272ddb9610c30da4c0404c996",
    "references": [
        {
            "authors": [
                "V. Ivanov",
                "R. Brederlow",
                "J. Gerber"
            ],
            "title": "An ultra low power bandgap operational at supply from 0.75 V",
            "venue": "IEEE J. Solid-State Circuits, vol. 47, no. 7, pp. 1515\u20131523, Jul. 2012.",
            "year": 2012
        },
        {
            "authors": [
                "Y. Chen",
                "M. Fojtik",
                "D. Blaauw",
                "D. Sylvester"
            ],
            "title": "A 2.98 nW bandgap voltage reference using a self-tuning low leakage sample and hold",
            "venue": "Proc. Symp. VLSI Circuits (VLSIC), Jun. 2012, pp. 200\u2013201.",
            "year": 2012
        },
        {
            "authors": [
                "M. Liu",
                "P. Harpe",
                "R. van Dommele",
                "A. van Roermund"
            ],
            "title": "A 0.8 V 10 b 80 kS/s SAR ADC with duty-cycled reference generation",
            "venue": "IEEE Int. Solid-State Circuits Conf. (ISSCC) Dig. Tech. Papers, Feb. 2015, pp. 1\u20133.",
            "year": 2015
        },
        {
            "authors": [
                "S. Wen",
                "K. Chen",
                "C. Hsiao",
                "Y. Chen"
            ],
            "title": "A \u2212105 dBc THD+N (\u2212114 dBc HD2) at 2.8 VPP swing and 120 dB DR audio decoder with sample-and-hold noise filtering and poly resistor linearization schemes",
            "venue": "IEEE Int. Solid-State Circuits Conf. (ISSCC) Dig. Tech. Papers, Feb. 2019, pp. 294\u2013295.",
            "year": 2019
        },
        {
            "authors": [
                "Q. Fan"
            ],
            "title": "A 21 nV/ \u221a Hz chopper-stabilized multi-path currentfeedback instrumentation amplifier with 2 \u03bcV offset",
            "venue": "IEEE J. Solid- State Circuits, vol. 47, no. 2, pp. 464\u2013475, Feb. 2012.",
            "year": 2012
        },
        {
            "authors": [
                "Y. Kusuda"
            ],
            "title": "A 5.9 nV/ \u221a Hz chopper operational amplifier with 0.78 \u03bcV maximum offset and 28.3 nV/\u25e6C offset drift",
            "venue": "IEEE Int. Solid-State Circuits Conf. (ISSCC) Dig. Tech. Papers, Feb. 2011, pp. 242\u2013244.",
            "year": 2011
        },
        {
            "authors": [
                "A.T.K. Tang"
            ],
            "title": "A 3 \u03bcV-offset operational amplifier with 20 nV/ \u221a Hz input noise PSD at DC employing both chopping and autozeroing",
            "venue": "IEEE Int. Solid-State Circuits Conf. (ISSCC) Dig. Tech. Papers, Feb. 2001, pp. 386\u2013387.",
            "year": 2001
        },
        {
            "authors": [
                "R. Wu",
                "Y. Chae",
                "J.H. Huijsing",
                "K.A.A. Makinwa"
            ],
            "title": "A 20-b \u00b1 40-mV range read-out IC with 50-nV offset and 0.04% gain error for bridge transducers",
            "venue": "IEEE J. Solid-State Circuits, vol. 47, no. 9, pp. 2152\u20132163, Sep. 2012.",
            "year": 2012
        },
        {
            "authors": [
                "Y.M. Chi",
                "T.-P. Jung",
                "G. Cauwenberghs"
            ],
            "title": "Dry-contact and noncontact biopotential electrodes: Methodological review",
            "venue": "IEEE Rev. Biomed. Eng., vol. 3, pp. 106\u2013119, 2010.",
            "year": 2010
        },
        {
            "authors": [
                "W. Kester"
            ],
            "title": "Practical Design Techniques for Sensor Signal Conditioning",
            "venue": "Upper Saddle River, NJ, USA: Prentice-Hall,",
            "year": 1999
        },
        {
            "authors": [
                "M. Bolatkale",
                "M.A.P. Pertijs",
                "W.J. Kindt",
                "J.H. Huijsing",
                "K.A.A. Makinwa"
            ],
            "title": "A single-temperature trimming technique for MOS-input operational amplifiers achieving 0.33 \u03bcV/\u25e6C offset drift",
            "venue": "IEEE J. Solid-State Circuits, vol. 46, no. 9, pp. 2099\u20132107, Sep. 2011. Authorized licensed use limited to: TU Delft Library. Downloaded on August 22,2022 at 07:45:30 UTC from IEEE Xplore. Restrictions apply. 2448 IEEE JOURNAL OF SOLID-STATE CIRCUITS, VOL. 57, NO. 8, AUGUST 2022",
            "year": 2011
        },
        {
            "authors": [
                "M. Snoeij"
            ],
            "title": "A 36 V 48 MHz JFET-input bipolar operational amplifier with 150 \u03bcV maximum offset and overload supply current control",
            "venue": "Proc. IEEE 44th Eur. Solid State Circuits Conf. (ESSCIRC), Dresden, Germany, Sep. 2018, pp. 290\u2013293.",
            "year": 2018
        },
        {
            "authors": [
                "Y. Kusuda"
            ],
            "title": "A 60 V auto-zero and chopper operational amplifier with 800 kHz interleaved clocks and input bias current trimming",
            "venue": "IEEE J. Solid-State Circuits, vol. 50, no. 12, pp. 2804\u20132813, Dec. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "A. Bakker",
                "K. Thiele",
                "J.H. Huijsing"
            ],
            "title": "A CMOS nested-chopper instrumentation amplifier with 100-nV offset",
            "venue": "IEEE J. Solid-State Circuits, vol. 35, no. 12, pp. 1877\u20131883, Dec. 2000.",
            "year": 1877
        },
        {
            "authors": [
                "T. Rooijers",
                "J.H. Huijsing",
                "K.A.A. Makinwa"
            ],
            "title": "A quiet digitally assisted auto-zero-stabilized voltage buffer with 0.6 pA input current and 0.6 \u03bcV offset",
            "venue": "IEEE Int. Solid-State Circuits Conf. (ISSCC) Dig. Tech. Papers, San Francisco, CA, USA, Feb. 2018, pp. 50\u201352.",
            "year": 2018
        },
        {
            "authors": [
                "T. Rooijers",
                "J.H. Huijsing",
                "K.A.A. Makinwa"
            ],
            "title": "An auto-zero stabilized voltage buffer with a quiet chopping scheme and constant input current",
            "venue": "IEEE Int. Solid-State Circuits Conf. (ISSCC) Dig. Tech. Papers, San Francisco, CA, USA, Feb. 2019, pp. 298\u2013299.",
            "year": 2019
        },
        {
            "authors": [
                "C.C. Enz",
                "G.C. Temes"
            ],
            "title": "Circuit techniques for reducing the effects of op-amp imperfections: Autozeroing, correlated double sampling, and chopper stabilization",
            "venue": "Proc. IEEE, vol. 84, no. 11, pp. 1584\u20131614, Nov. 1996.",
            "year": 1996
        },
        {
            "authors": [
                "M.A.P. Pertijs",
                "W.J. Kindt"
            ],
            "title": "A 140 dB-CMRR current-feedback instrumentation amplifier employing ping-pong auto-zeroing and chopping",
            "venue": "IEEE J. Solid-State Circuits, vol. 45, no. 10, pp. 2044\u20132056, Oct. 2010.",
            "year": 2010
        },
        {
            "authors": [
                "J. Xu",
                "R.F. Yazicioglu",
                "P. Harpe",
                "K.A.A. Makinwa",
                "C. Van Hoof"
            ],
            "title": "A 160 \u03bcW 8-channel active electrode system for EEG monitoring",
            "venue": "IEEE Int. Solid-State Circuits Conf. (ISSCC) Dig. Tech. Papers, Nov. 2011, pp. 300\u2013302.",
            "year": 2011
        },
        {
            "authors": [
                "M. Pelgrom"
            ],
            "title": "Analog-to-Digital Conversion, 3rd ed",
            "venue": "Cham, Switzerland: Springer,",
            "year": 2009
        }
    ],
    "sections": [
        {
            "text": "Delft University of Technology\nAn Auto-Zero-Stabilized Voltage Buffer With a Quiet Chopping Scheme and Constant Sub-pA Input Current\nRooijers, Thije; Huijsing, Johan H.; Makinwa, Kofi A.A.\nDOI 10.1109/JSSC.2021.3127462 Publication date 2022 Document Version Final published version Published in IEEE Journal of Solid-State Circuits\nCitation (APA) Rooijers, T., Huijsing, J. H., & Makinwa, K. A. A. (2022). An Auto-Zero-Stabilized Voltage Buffer With a Quiet Chopping Scheme and Constant Sub-pA Input Current. IEEE Journal of Solid-State Circuits, 57(8), 2438-2448. [9626348]. https://doi.org/10.1109/JSSC.2021.3127462\nImportant note To cite this publication, please use the final published version (if applicable). Please check the document version above.\nCopyright Other than for strictly personal use, it is not permitted to download, forward or distribute the text or part of it, without the consent of the author(s) and/or copyright holder(s), unless the work is under an open content license such as Creative Commons.\nTakedown policy Please contact us and provide details if you believe this document breaches copyrights. We will remove access to the work immediately and investigate your claim.\nThis work is downloaded from Delft University of Technology. For technical reasons the number of authors shown on this cover page is limited to a maximum of 10.\nGreen Open Access added to TU Delft Institutional Repository\n'You share, we take care!' - Taverne project\nhttps://www.openaccess.nl/en/you-share-we-take-care\nOtherwise as indicated in the copyright section: the publisher is the copyright holder of this work and the author uses the Dutch legislation to make this work public.\nAn Auto-Zero-Stabilized Voltage Buffer With a Quiet Chopping Scheme and\nConstant Sub-pA Input Current Thije Rooijers , Graduate Student Member, IEEE, Johan H. Huijsing, Life Fellow, IEEE,\nand Kofi A. A. Makinwa , Fellow, IEEE\nAbstract\u2014 This article describes an auto-zero stabilized voltage buffer that achieves low offset and low noise with sub-pA input current. A high gain stabilization loop is used to periodically cancel the buffer\u2019s offset. The loop itself is periodically disconnected from the buffer and auto-zeroed, during which its bandwidth is reduced to reduce the associated noise folding. However, this also reduces its offset correction range, and so to avoid overloading, its initial offset is digitally trimmed. To break up the correlation between the residual low-frequency (LF) noise of the auto-zero and stabilization phases, the loop is periodically chopped, which significantly reduces the buffer\u2019s LF noise. Finally, the duty-cycle of the two phases is optimized to bring the buffer\u2019s LF noise density close to \u221a 2 times its white noise density (14 nV/ \u221a Hz), which is the fundamental limit of an AZ amplifier. The buffer also achieves a constant and low input current (0.8 pA), as well as a state-of-the-art offset (0.4 \u00b5V).\nIndex Terms\u2014 Auto-zero, digitally assisted AZ loop, low input current, low offset, noise correlation, noise folding.\nI. INTRODUCTION\nSAMPLED voltage references [1]\u2013[4] (Fig. 1) can achievelow-power operation by storing the output of a conventional voltage reference on a hold capacitor (CH ). As shown in Fig. 1, the voltage reference then only needs to be briefly turned on (via SW2) to refresh the voltage on CH . To drive a load (RL), however, this voltage must be buffered. Since the power dissipation of a buffer will typically be lower than that of a voltage reference for the same noise level, this approach delivers significant power savings. This is especially true of band-gap voltage references, which are generally not very noise efficient, because their output voltage is generated by amplifying the difference between two base\u2013emitter voltages VBE, together with the associated noise, and adding it to a base\u2013emitter voltage VBE [1]\u2013[4].\nThe buffer used in a sampled voltage reference must achieve low noise, low offset, and low offset-drift. To achieve\nManuscript received 5 August 2021; revised 8 October 2021; accepted 29 October 2021. Date of publication 24 November 2021; date of current version 25 July 2022. This article was approved by Associate Editor Pui-In Mak. (Corresponding author: Thije Rooijers.)\nThe authors are with the Department of Microelectronics, Delft University of Technology, 2628 Delft, The Netherlands (e-mail: c.t.rooijers@tudelft.nl).\nColor versions of one or more figures in this article are available at https://doi.org/10.1109/JSSC.2021.3127462.\nDigital Object Identifier 10.1109/JSSC.2021.3127462\nthis, dynamic offset compensation (DOC) techniques, such as chopping and auto-zeroing can be used. However, they require the use of input switches, whose activity gives rise to significant input current, in the order of tens of pAs [5]\u2013[7]. As shown in Fig. 1, this current will cause the voltage stored on CH to drift, thus limiting the allowable hold time and thus the amount of power that can be saved by dutycycling. Furthermore, input switching activity typically causes output-referred spikes, making it difficult to interface the buffer to a subsequent ADC. Although the effect of such spikes can be mitigated by synchronizing them to the ADC\u2019s sampling clock [8], this is not feasible in a stand-alone reference.\nAnother application that requires low-offset amplifiers with low input currents is the readout of high impedance sensors\n0018-9200 \u00a9 2021 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information.\nAuthorized licensed use limited to: TU Delft Library. Downloaded on August 22,2022 at 07:45:30 UTC from IEEE Xplore. Restrictions apply.\n(Fig. 2). Such sensors, e.g., dry electrodes, photodiodes, and pH probes, can have impedances of several M s [9]\u2013[10]. Input currents (Iin) of several pAs then lead to voltage errors ( V ) of several \u03bcVs, thus nullifying the benefits of DOC techniques.\nPrevious amplifiers targeting a combination of low input current and low offset have relied on trimming to avoid the input current associated with DOC techniques. An op-amp with a single-temperature trimming scheme that corrects both VTH and \u03b2 mismatch of its MOSFET-based differential input pair is presented in [11]. However, its offset (30 \u03bcV) and offset drift (0.33 \u03bcV/\u25e6C) are still high compared to that of typical chopper or auto-zero amplifiers (<10 \u03bcV and <10 nV/\u25e6C). Moreover, unlike the use of chopping and auto-zeroing, the use of trimming does not mitigate 1/ f noise.\nAmplifiers with JFET input stages have low 1/ f noise and relatively low input current [12]. However, compared to amplifiers with MOS input stages, their input current is still rather high (\u223c10 pA), and increases exponentially with temperature, making them unsuitable for high-temperature applications. Furthermore, their offset (\u223c150 \u03bcV) and offset drift (1.5 \u03bcV/\u25e6C) are still quite high compared to that of typical chopper or auto-zero amplifiers [13], [14].\nTo lower the input current of amplifiers using DOC techniques: trimming [15] and nested chopping [16] have been used. In [15], a high effective chopping frequency (4.8 MHz) was used to achieve a large glitch-free signal bandwidth. This requires trimming to lower the input current from 1.5 nA to 150 pA. Nested chopping [16] utilizes a second chopper to chop the charge injection mismatch of the first chopper. The input current of the second chopper is minimized by using a much lower chopping frequency. This reduces the overall input current, as well as the residual offset, at the expense of reducing the ripple-free bandwidth.\nThis article presents an auto-zero stabilized voltage buffer that achieves low input current, low offset, and low noise [17], [18]. It has an input current of 0.8 pA, state-of-the-art offset (0.4 \u03bcV), and a low-frequency (LF) noise density close to \u221a 2\u00d7 its white noise density (14 nV/\u221aHz), which is the\nfundamental limit of an AZ amplifier [20]. The rest of the article is organized as follows. The chosen\narchitecture and its design considerations are described in Section II. Measurement results are shown and discussed in Section III, and the article ends with conclusions."
        },
        {
            "heading": "II. ARCHITECTURE DESIGN",
            "text": "When the low input current is required, auto-zeroing is\npreferred over chopping, since it requires less input switch-\nAuthorized licensed use limited to: TU Delft Library. Downloaded on August 22,2022 at 07:45:30 UTC from IEEE Xplore. Restrictions apply.\ning. This can be understood by considering the associated switching sequences in Fig. 3. The switches introduce charge injection (CI) when they open and charge absorption (CA) when they close. Only the CI/CA into/from the parasitic capacitors Cp1 and Cp2 are considered since the opening CI into Vin (and Vout) ideally cancels the closing CA. In the case of auto-zeroing, the CI of the opening \u03c61 switches (q1 and q2) is stored on Cp1 and Cp2. The \u03c62 switch has symmetric impedances on both sides, so when it closes, its CA will equally split (\u2212q3/2) between the capacitors. The charge is shared during \u03c62, resulting in 0.5(q1 + q2 \u2212 q3) on each capacitor. The CI of the opening \u03c62 switch (q3/2) will then cancel \u2212q3/2, leaving 0.5(q1 + q2) on each capacitor. When the \u03c61 switches close again, the charge on Cp1 and Cp2 is combined with the CA (\u2212q1 and \u2212q2), leading to an average input current (Iin) of 0.5 faz(q1 \u2212 q2) and output current (Iout) of 0.5 faz(q2 \u2212 q1). It is important to note that due to the charge sharing in \u03c62, the CI and CA of the \u03c61 switches cannot completely cancel.\nIn the case of chopping, the CI of the opening CH switches (q1 and q2) is stored on Cp1 and Cp2. This is then combined with the CA of the closing C H switches (\u2212q3 and \u2212q4). This results in an Iin of fch(q1 \u2212q3) and Iout of fch(q2 \u2212q4) in C H . Similarly, the CI of the closing CH switches (\u2212q1 and \u2212q2) gets stored and combined with the CI of the opening C H switches (q3 and q4). This results in an Iin of fch(q4 \u2212 q2) and Iout of fch(q3 \u2212 q1). After a complete chopping cycle, the result is a total average Iin of fch((q1 \u2212 q3) + (q4 \u2212 q2)) and Iout of fch((q3 \u2212 q1) + (q2 \u2212 q4)). Due to the chopping action, CI mismatch q1 \u2212 q3 gets supplied by Vin in C H and the opposite q3 \u2212 q1 gets supplied by Vout in CH, leading to incomplete cancellation. Assuming the same CI/CA mismatch for all switches and fch = faz, the conclusion is that chopping generates four times more input current than auto-zeroing.\nA simplified schematic of the proposed auto-zero (AZ) stabilized buffer is shown in Fig. 4. It consists of a three-stage buffer with a folded-cascode input stage (GmMAIN), a foldedcascode intermediate stage with Class AB output stage (AOUT), nested Miller compensation (30 and 7 pF, not shown), and Miller-zero compensation resistors (6 and 8 k , not shown). The offset of the main amplifier (VosMAIN) and 1/ f noise are periodically canceled by an AZ stabilization loop consisting of an active integrator (GmINT, Cint11\u221212 and Cint21\u221222) and two OTAs: Gm1 and Gm3.\nDuring phase \u03c62, Gm1 is auto-zeroed. Its input is shorted, and so its offset is converted by its transconductance (\u223c230 \u03bcS) into an output current. This is integrated on capacitors Cint21\u2212int22(10 pF each), leading to a correction voltage across nodes E and F . Gm2 then converts this into a correction current that cancels Vos1.\nDue to negative feedback, the buffer\u2019s offset appears across its input terminals. During phase \u03c61, this is sensed by Gm1. Its output current is then integrated on capacitors Cint11\u2212int12(10 pF each), resulting in a correction voltage across nodes G and H, and a corresponding cancellation current generated by Gm3. To achieve sub-\u03bcV offset, while generating correction voltages of several hundred millivolts, each stabilization loop should have a high (>120 dB) gain. In this work,\nthis is realized by multiplexing a single gain-boosted OTA (GmINT) between the two loops, each with its own integration capacitors."
        },
        {
            "heading": "A. Noise Folding in Auto-Zero Amplifiers",
            "text": "The main drawback of auto-zeroing is that it causes undersampled thermal noise to fold back to low frequencies [19]. As a result, the LF noise density after auto-zeroing is typically larger than the original thermal noise density. The amount of noise folding is determined by the ratio of the bandwidth of the auto-zeroing loop (BWAZ) and the auto-zeroing frequency ( fAZ). To achieve low input current, fAZ should be as low as possible, i.e., somewhat higher than the 1/ f corner frequencies of Gm1 and GmMAIN.\nDuring the AZ phase \u03c62, BWAZ is given by [20]\nBWAZ = Gm2 2\u03c0Cint21\u2212in22\n(1)\nwhere Gm2 is the transconductance of Gm2 and Cint21\u2212int22 are the individual values of the corresponding integration capacitors. During phase \u03c61, BWAZ is determined by the transconductances of GmMAIN, Gm1, and Gm3. To equalize their noise contributions, the transconductances of GmMAIN and Gm1 are made the same, as are the transconductances of Gm2 and Gm3. In this case, the bandwidth of the AZ loop can be expressed as\nBWAZ = Gm3 2\u03c0Cint11\u2212in12\n(2)\nwhere Gm3 is the transconductance of Gm3 and Cint11\u2212int12 are the values of the corresponding integration capacitors.\nLimiting the bandwidth of the stabilization loop, therefore, requires either large integration capacitors or small transconductances (Gm2 and Gm3). The latter approach is the most attractive since it has the least impact on the chip area. In a\nAuthorized licensed use limited to: TU Delft Library. Downloaded on August 22,2022 at 07:45:30 UTC from IEEE Xplore. Restrictions apply.\nwell-optimized design, the buffer\u2019s input-referred voltage noise density will then be determined by GmMAIN (=Gm1), and so for a given integration capacitance, the LF noise density due to folding will be inversely proportional to the Gm ratio \u03b1 = GmMAIN/Gm3 (= Gm1/Gm2).\nFig. 5 shows the simulated input-referred voltage noise density of the buffer for a fixed GmMAIN (=230 \u03bcS), integration capacitors (10 pF), and fAZ = 15 kHz but different gm ratios. As the gm ratio increases, the bandwidth BWAZ decreases, the noise folding decreases, as does the voltage noise density at low frequencies. At large Gm ratios, however, the voltage noise density eventually stops decreasing and converges to a limit. As will be shown later, this limit is equal to \u221a 5 \u00d7 en, where en is the voltage noise density associated with GmMAIN. From Fig. 5, it can be seen that the gm ratio has to be at least 500\u00d7 to reach this limit."
        },
        {
            "heading": "B. Digitally Assisted Auto-Zero-Stabilized Loop",
            "text": "Using a gm ratio of 500\u00d7 means that the combined offset of GmMAIN and Gm1 will be amplified by 500\u00d7 at the output of the integrator. The maximum offset voltage that can be corrected by the stabilization loop is then limited to Vswing/500, where Vswing is the integrator\u2019s maximum output swing. In this work, Vswing \u223c \u00b10.6 V, which corresponds to a maximum correctable offset voltage of \u00b11.2 mV. From Monte-Carlo simulations, however, the expected offsets of Gm1 and GmMAIN are about 1.8 mV (6\u03c3). On top of this, offset drifts of several hundreds of \u03bcVs may be expected over the intended operating temperature range (\u221240 to 85 \u25e6C) [11].\nIn prior work [20], an additional gm stage driven by a voltage derived from an on-chip bandgap reference was used in order to trim the initial offset. In [21], a digitally assisted calibration loop is used to lower the ripple of a chopper amplifier. In this work a similar approach is used, where the initial offset of both GmMAIN and Gm1 is trimmed at startup by a digital AZ loop, to handle worst-case offset and drift levels. As shown in Fig. 6, this consists of a comparator,\na successive approximation register (SAR), and two current DACs (IDACs) in parallel with the outputs of Gm2 and Gm3. At startup, Gm1 is first auto-zeroed by shorting its inputs and using a comparator to sample the integrator output and thus detect its offset polarity. This information is used to update the SAR, whose output drives the IDAC. Next, GmMAIN is autozeroed in the same way by sensing its offset at the input of Gm1 due to the feedback. As a result, the stabilization loop only has to cancel the offset drift and the residual offset corresponding to the LSB of the IDAC.\nTo ensure fast settling after each bit trial, the auto-zeroing bandwidth BWAZ is temporarily increased. This is achieved by increasing the transconductances of Gm2 and Gm3 by \u223c4\u00d7 during the operation of the digital AZ loop. This is implemented by switching both the bias current and the degeneration of Gm2 and Gm3 (Fig. 7). After the SAR bits are fixed, BWAZ is decreased (via the end of conversion (EOC) bit) and the analog stabilization loop is enabled.\nFor robustness, the 5 bit IDAC is slightly over-designed, with the maximum current of 1 \u03bcA corresponding to an offset of 4.3 mV. Its MSB then corresponds to an offset of 2.5 mV, while its LSB corresponds to roughly 150 \u03bcV. A polarity bit is used to steer the DAC current to the appropriate output, and thus compensate for both positive and negative offsets.\nSince the offsets of Gm1 and GmMAIN are amplified by the Gm ratio, the offset of the comparator can be quite relaxed. During startup, the Gm ratio is about 120, which means that the LSB of the IDAC corresponds to an integrator output of\nAuthorized licensed use limited to: TU Delft Library. Downloaded on August 22,2022 at 07:45:30 UTC from IEEE Xplore. Restrictions apply.\n18 mV. This is much greater than the simulated comparator offset (5 mV).\nA further benefit of the digital AZ loop is that it reduces the amplitude of the switching spikes associated with the multiplexed operation of the integrator. It does this by reducing the integrator\u2019s output swing, which in turn, reduces the charge injection mismatch of its output switches. It also reduces the transient currents required to drive the integrator\u2019s load capacitors to the two different offset levels of Gm1 and GmMAIN. Due to the 500 \u00d7 Gm ratio, any spikes that still appear on nodes G and H will be attenuated by 500\u00d7 when referred to the output."
        },
        {
            "heading": "C. Low-Frequency Noise Analysis",
            "text": "As shown in Fig. 5, even after minimizing BWAZ, the LF noise density is still limited to about \u221a 5\u00d7 the white\nnoise level, which is higher than the \u221a\n2\u00d7 fundamental limit. To understand the reasons for this, in this section, the proposed amplifier\u2019s LF noise performance will be analyzed. At first, it will be assumed that all noise sources are uncorrelated. All noise sources refer to voltage noise densities, and capitalization will be used to denote sampled sources, while lowercases will be used for time-varying sources.\nIn phase \u03c62(Fig. 8), the input of Gm1 is shorted and the voltage across nodes E and F tracks the (500\u00d7 amplified)\noffset. It also tracks the noise of Gm1 (vn1). At the end of phase \u03c62, this noise will be sampled across E and F (Vn1EF) and held there during the following \u03c61 phase.\nIn phase \u03c61 (Fig. 9) the voltage across node G and H tracks and cancels the noise of GmMAIN (vnMAIN), in the same way as its offset. This is done by Gm1, whose offset is still being nulled by the voltage across E and F . This means that the voltage across G and H is the sum of the voltage needed to track the time-varying noise sources vnMAIN and vn1, and the sampled noise from E and F (Vn1EF), which are both amplified by \u03b1. As a result, the noise density across G and H during phase \u03c61 can be expressed as\nvGH_\u03c61 = \u03b1 \u221a\nv2nMAIN + v2n1 + V 2n1EF. (3) Assuming that the AZ stabilized loop has enough gain,\nit will completely cancel the LF noise of GmMAIN, and so during \u03c61 the buffer\u2019s output-referred noise density, referred to Vout, will be given by\nvout_ \u03c61 = \u221a v2n1 + V 2n1EF = \u221a 2en. (4)\nThis shows that in phase \u03c61 the buffer\u2019s LF output-referred noise density is fully determined by the noise of Gm1, which is also in good agreement with the results of Pnoise simulations.\nIn phase \u03c62 (Fig. 8), the noise across G and H due to the contributions of vnMAIN, vn1, and Vn1EF will be frozen. This leads to a total noise density across G and H during phase \u03c62 of\nVGH_\u03c62 = \u03b1 \u221a\nVnMAINGH2 + Vn1GH2 + Vn1EF2 (5) where VnMAINGH and Vn1GH are the sampled noise sources across G and H from vnMAIN and vn1, respectively. Referred to the buffer\u2019s output, these contributions across G and H add to the noise vnMAIN, and so the buffer\u2019s output-referred noise density in phase \u03c62 is given by\nvout_\u03c62 = \u221a v2nMAIN + V 2nMAINGH + V 2n1GH + V 2n1EF = 2en. (6)\nAuthorized licensed use limited to: TU Delft Library. Downloaded on August 22,2022 at 07:45:30 UTC from IEEE Xplore. Restrictions apply.\nThis result shows that in phase \u03c62 the buffer\u2019s LF outputreferred noise is equally determined by Gm1 and GmMAIN, which is also supported by the result of Pnoise simulations.\nIf phase \u03c61 and \u03c62 have a 50% duty-cycle, then the buffer\u2019s output noise over the two phases is the average of their respective noise contributions. The buffer\u2019s output noise is therefore determined by the average of (4) and (6) and is given by\nvout = \u221a 1\n2\n( vout_\u03c612 + vout_\u03c622 ) . (7)\nFilling-in the earlier expressions for the output noise in phase \u03c61 (4) and \u03c62 (6) gives an output noise of\nvout = \u221a 1\n2\n( v2nMAIN + V 2nMAINGH + v2n1 + V 2n1GH + 2V 2n1EF ) .\n(8)\nRemoving the distinction between sampled and timevarying noise, this can be simplified to\nvout = \u221a v2nMAIN + 2v2n1 = \u221a 3en . (9)\nThe final result in (9) shows that without correlation, the output noise will be \u221a 3en. However, Vn1EF,Vn1GH, and VnMAINGH in (8) are sampled versions of vn1 and vnMAIN, which leads to a partial correlation. Pnoise simulations show that these correlations increase the noise to \u221a 5en .\nBased on this LF analysis, there are two possible ways to further reduce the total LF noise. One is to remove the dominant Vn1EF term in (7), the other is to extend phase \u03c61 relative to phase \u03c62, noting that the output noise in phase \u03c61 (4) is much lower than phase \u03c62 (6). These two approaches will be further explored in Sections II-D and II-E."
        },
        {
            "heading": "D. Chopped Stabilization Loop",
            "text": "To remove the Vn1EF term in (7), Vn1EF should not be allowed to propagate to G & H , and eventually to the output, in the same way during the two phases. To achieve this, a chopper placed between nodes E & F and G & H (CHout in Fig. 10) is used to periodically invert the polarity of the Vn1EF on its way to nodes G and H in phase \u03c61. In this way, Vn1EF will reach the output with opposite polarities and thus cancel over one chopping period. In this case, the output noise would be given by\nvout = \u221a 1\n2\n( v2nMAIN + V 2nMAINGH + v2n1 + V 2n1GH ) = \u221a2en (10)\nwhere the partial correlation still exists between Vn1GH and vn1 as well as VnMAINGH and vnMAIN. Pnoise simulations show that for a 50% duty-cycle, the partial correlation limits the noise floor to about \u221a 3en. To preserve the correct loop polarity, a second Chopper CHin is inserted at the input of Gm1. This chopper is switched in phase \u03c62 when it is disconnected from the input by the AZ switches. This prevents its switching activity from generating transients, and thus introducing spikes in the amplifier\u2019s input current.\nOne issue is that the AZ loop is still active in between the two chopping phases. Therefore, Vn1EF will slowly change during chopping and so will not be perfectly canceled. The amount of change depends on the duration of the chopping period and hence on the AZ frequency fAZ. Setting fAZ = 15 kHz, which is enough to cancel the buffer\u2019s 1/ f noise, only reduces the LF noise floor slightly (Fig. 11). To approach the \u221a 3 \u00d7 en limit, simulations show that fAZ would have to be some 3\u00d7 higher, resulting in significantly more input switching, and hence, more input current.\nTo preserve the noise across nodes E and F during a chopping period, extra capacitors Cint31\u2212int32(1 pF each) are used to implement a modified \u03c62 phase, denoted by \u03c63 (Fig. 10). During \u03c63, the output of GmINT is not connected to either AZ loop. Also, resistors R1\u22122 (2 M ) limit the gain of GmINT, preventing it from clipping due to the residual output current of Gm1. Vn1EF can then be fully chopped-out without changing fAZ (Fig. 11). The chopping transitions are arranged to occur in phase \u03c62, when the input chopper is disconnected from the input by the AZ switches. With these two measures, the AZ stabilization loop can be chopped, lowering the LF noise to\u221a\n3en, without introducing extra spikes or input current.\nAuthorized licensed use limited to: TU Delft Library. Downloaded on August 22,2022 at 07:45:30 UTC from IEEE Xplore. Restrictions apply.\nAnother issue is the integrator\u2019s own offset, which, via the chopper at its input, gives rise to a square-wave ripple voltage at the output of Gm1. This will be translated into a ripple voltage at the input of the buffer ripple voltage by dividing it by the transconductance and finite output impedance at fch of Gm1. With an expected integrator offset of about 2 mV, the output impedance of Gm1 then needs to be quite high (>150 M ) to ensure that the resulting ripple is negligible (<100 nV). This requirement is met by implementing Gm1 as a folded cascode OTA."
        },
        {
            "heading": "E. Duty-Cycling the AZ Clock",
            "text": "With the Vn1EF term removed, the buffer\u2019s LF noise level can be further reduced by adjusting the \u03c61: \u03c62 duty-cycle. From the noise analysis, we can note that the output noise in phase \u03c61 ( \u221a 2 \u00d7 en) is less than the noise in phase \u03c62 (2 \u00d7 en). The correlation will also be affected by the dutycycle, and the more time the buffer spends in phase \u03c61, the lower the noise gets. Since some settling time is required for \u03c62, the resulting noise level in Pnoise simulations will then be somewhere between \u221a 3 \u00d7 en and \u221a 2 \u00d7 en .\nF. Implementation of the AZ Switches\nThe input current of the AZ amplifier is determined by the charge injection mismatch of the two input switches driven by \u03c61 (Fig. 12). Two implementations of the AZ switches were tested and compared: transmission gate switches [17] and NMOS switches with a constant VGS drive [18].\nThe constant VGS drive consists of two latching transistors MN1 and MN2 which pre-charges boosting capacitors CB1 and CB2 to the input voltage. A fraction of the clock signal is then boosted on top of this to get a VGS driving the switches that\nare independent of the input voltage. The amplitude of the resulting clock signal 1,2_bo is determined by the ratio of the boosting capacitor (CB1\u2013B2) to the parasitic capacitance to the ground (CP1\u2013P2). A simple buffer is used to make sure that the constant VGS drive switching is not loading the input."
        },
        {
            "heading": "III. MEASUREMENT RESULTS",
            "text": "The auto-zero-stabilized buffer was realized in a 0.18 \u03bcm CMOS technology (Fig. 13). It draws 210 \u03bcA from a 1.8 V supply and has an active area of 0.55 mm2, 0.12 mm2 of which is occupied by the low-leakage S&H circuit."
        },
        {
            "heading": "A. Measuring the Input Current",
            "text": "To evaluate the extremely low input current of the buffer, a circuit similar to the sampled voltage reference is used (Fig. 14). An on-chip hold capacitor CH (36 pF) is pre-charged to an input voltage through a low-leakage sampling network consisting of switches SW1,2. The input is then disconnected\nAuthorized licensed use limited to: TU Delft Library. Downloaded on August 22,2022 at 07:45:30 UTC from IEEE Xplore. Restrictions apply.\nand the voltage drift over time of the hold capacitor is observed to deduce the input current.\nTo minimize the leakage of the sampling switch, extra hold capacitors CT (3 pF) and, via SW3, CB (36 pF) ensure that the channel and body-diodes of SW2 are operated at zero reverse bias. The same technique is applied to Gm1\u2019s input switches SW4\u22126, as the body diode leakage of these switches would cause the hold capacitor to discharge. All capacitors are implemented with custom MOM capacitors to minimize their leakage.\nThe voltage drift across CH is shown for a typical sample with a 1 V input (Fig. 15). With AZ off, there is negligible leakage, illustrating the effectiveness of the low-leakage techniques.\nThe voltage drift across CH is an accurate measure of the buffer\u2019s input current. In a general-purpose buffer, another challenge, when interfacing off-chip sensors, is the leakage of the ESD devices, which is usually >1 pA. To suppress this leakage, special bootstrapped ESD structures can be used [22]. These protection devices are outside the scope of this work. Instead, this article focuses on showing that the input current of an AZ amplifier can be reduced to the sub-pA level.\nB. Voltage Noise Density\nWith all dynamic techniques turned off, at low frequencies, the 1/ f noise can be seen with a corner frequency of\nabout 700 Hz (Fig. 16). At higher frequencies, the white noise level can be seen with a level of 14 nV/ \u221a Hz. With auto-\nzeroing only, an LF noise density of 31 nV/ \u221a\nHz is achieved, which equals the earlier discussed \u221a 5\u00d7 white noise. When\nchopping with the extra 3 phase enabled, the LF noise drops to 25 nV/ \u221a Hz, which equals the \u221a 3\u00d7 white noise. Finally,\nwhen a 75% duty-cycle is used, an LF noise of 20 nV/ \u221a\nHz is achieved, which is very close to the \u221a 2\u00d7 noise limit.\nThis reduction from \u221a 5\u00d7 to \u221a2\u00d7 noise corresponds to a 2.5\u00d7 power saving in the input stages. All the noise reduction techniques lead to a competitive NEF of 7.3, due to the low increase in noise floor over a small bandwidth, which leads to an NEF that outperforms even many chopper amplifiers. No tones at fAZ or fCH can be seen, demonstrating that the use of auto-zeroing and chopping does not add spikes and a quiet output is achieved."
        },
        {
            "heading": "C. Offset and Input Current",
            "text": "To evaluate the offset and the input current of the buffer, measurements were done on 15 samples (Fig. 17). Without any dynamic techniques, the offset is below 200 \u03bcV. When all the dynamic techniques are switched on, the offset is reduced to a maximum value of 0.4 \u03bcV. Finally, the input current with all dynamic techniques and the NMOS input switches with a constant VGS drive has a maximum value of 0.8 pA. The 75% duty-cycle of the AZ clock does not change the offset or input current performance. The low input current of this design can be attributed to several design choices. First, autozeroing is used instead of chopping, so that the input current only depends on the CI mismatch of one pair of switches.\nAuthorized licensed use limited to: TU Delft Library. Downloaded on August 22,2022 at 07:45:30 UTC from IEEE Xplore. Restrictions apply.\nMaking fAZ low (15 kHz) also lowers the input current. The additional chopping is done during auto-zeroing phases, and so does not increase the input current. Finally, compared to most prior art [5]\u2013[7], the use of finer technology (180 nm) allows the use of smaller switches with less CI. In general, for a given minimum dimension L, CI scales with L2, while CI mismatch scales with L [23].\nFor the two implementations of the AZ switches, the input current versus input voltage was measured for up to 15 samples. The implementation with transmission gates shows a large variation of the input current versus input voltage changing up to 0.9 pA over the full range of the buffer (0.1 to 1.3 V) (Fig. 18).\nThis change in input current can be attributed to the PMOS and NMOS being active for the different input voltages. For low input voltages, the charge injection of the NMOS is only contributing to the input current and for higher input voltages, the PMOS is contributing. Around halfway the supply, both switches will contribute which leads to a partial cancellation of the charge injection and therefore the lowest input current.\nThe implementation of the NMOS switches with a constant VGS drive shows a much more constant input current over input voltage, where the worst-case sample changes around 0.2 pA (Fig. 19).\nA measurement of the input current versus fAZ shows a linear relationship (Fig. 20), which extrapolates to zero, which indicates that charge injection is the dominant source of input current.\nThe input current drift over temperature (from 5 \u25e6C to 85 \u25e6C) was characterized for two typical samples at a fixed input voltage of 1 V (Fig. 21). The input current drifts around 0.3 pA over 80 \u25e6C. This input current is still well below the expected ESD leakage. At higher temperatures, a part of this drift can be attributed to the increased leakage of the S&H circuit.\nThe input current versus input voltage is also measured for the case of AZ and AZ & CH for a typical sample (Fig. 22). For both cases the input current is similar, showing that the chopping can be done without adding input current."
        },
        {
            "heading": "D. Comparison With the Prior Art",
            "text": "In Table I, the performance of the AZ Stabilized Voltage Buffer is summarized and compared with the state of the art. A 50\u00d7 reduction in input current is achieved, while also achieving state-of-the-art offset (0.4 \u03bcV) and competitive LF voltage noise (20 nV/ \u221a Hz). The NEF of this AZ design is\nAuthorized licensed use limited to: TU Delft Library. Downloaded on August 22,2022 at 07:45:30 UTC from IEEE Xplore. Restrictions apply.\nTABLE I\nPERFORMANCE SUMMARY AND COMPARISON WITH THE STATE OF THE ART\nFig. 22. Input current versus input voltage for a typical sample in the case of AZ and AZ & CH.\ncomparable with some CH amplifiers [6], due to the introduced LF noise reduction techniques."
        },
        {
            "heading": "IV. CONCLUSION",
            "text": "An auto-zero-stabilized voltage buffer is presented that achieves a combination of low noise (20 nV/ \u221a Hz), low offset\n(0.4 \u03bcV max), and low input current (0.8 pA max). The elevated LF noise density associated with auto-zeroing is minimized by using a combination of: a digitally assisted AZ loop, chopping to remove correlation, and an optimized dutycycle for the AZ clock. This allows the buffer to reach an LF noise density close to \u221a 2 times its white noise density\n(14 nV/ \u221a\nHz), which is the fundamental limit of an AZ amplifier. This is the first design to demonstrate that dynamic\noffset correction techniques can be used to realize a buffer with both sub-pA input current and sub-\u03bcV offset."
        }
    ],
    "title": "An Auto-Zero-Stabilized Voltage Buffer With a Quiet Chopping Scheme and Constant Sub-pA Input Current",
    "year": 2022
}