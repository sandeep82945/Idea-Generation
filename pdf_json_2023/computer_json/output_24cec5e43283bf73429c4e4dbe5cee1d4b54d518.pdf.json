{
    "abstractText": "The rapid growth of energy demand requires progressive energy generation. This, together with the demand for higher efficiency and flexibility, has promoted the application of power electronics in energy systems. During the past decade, model predictive control (MPC) of power electronics has witnessed significant advancements in both dynamic performance and optimal control of the multi-objective terms. Several of these terms can have equal control priorities, resulting in a symmetrical cost function; however, most objectives have different priorities and require weighting factors to resolve the asymmetry in the cost function. Currently, researchers continue to encounter challenges in the optimal design of weighting factors. Moreover, the relative performance of different techniques that either utilize or avoid the weighting factor are uncertain. Therefore, this study focuses on weighting factor design techniques in the literature as applied to wind/solar energy conversion, microgrids, grid-connected converters, and other high-performance converter-based systems. These are grouped under the heuristic, offline tuning, sequential, and online optimization methods. This study demonstrates that optimal online tuning of weighting factors and sequential MPC methods can both offer improved robustness against parameter uncertainties. In addition, the advantages and limitations of different techniques are highlighted.",
    "authors": [
        {
            "affiliations": [],
            "name": "Yuzhe Zhang"
        },
        {
            "affiliations": [],
            "name": "Zhenbin Zhang"
        },
        {
            "affiliations": [],
            "name": "Zhen Li"
        }
    ],
    "id": "SP:52e7e8f0fd23cfcf69aa2c02350a311d010865dc",
    "references": [
        {
            "authors": [
                "P. Karamanakos",
                "T. Geyer"
            ],
            "title": "Guidelines for the Design of Finite Control Set Model Predictive Controllers",
            "venue": "IEEE Trans. Power Electron",
            "year": 2020
        },
        {
            "authors": [
                "S. Vazquez",
                "J. Rodriguez",
                "M. Rivera",
                "L.G. Franquelo",
                "M. Norambuena"
            ],
            "title": "Model predictive control for power converters and drives: Advances and trends",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2016
        },
        {
            "authors": [
                "Y. Liu",
                "S. Shi",
                "Z. Zhang",
                "Z. Di",
                "O. Babayomi"
            ],
            "title": "Data-Driven Model Predictive Control for Wave Energy Converters",
            "venue": "Using Gaussian Process. Symmetry 2022,",
            "year": 2022
        },
        {
            "authors": [
                "R. Heydari",
                "T. Dragicevic",
                "F. Blaabjerg"
            ],
            "title": "High-bandwidth secondary voltage and frequency control of VSC-Based AC microgrid",
            "venue": "IEEE Trans. Power Electron",
            "year": 2019
        },
        {
            "authors": [
                "Y. Zhang",
                "X. Liu",
                "H. Li",
                "Z. Zhang"
            ],
            "title": "A Model Independent Predictive Control of PMSG Wind Turbine Systems with a New Mechanism to Update Variables",
            "venue": "Energies",
            "year": 2023
        },
        {
            "authors": [
                "O. Babayomi",
                "Z. Zhang",
                "T. Dragicevic",
                "J. Hu",
                "J. Rodriguez"
            ],
            "title": "Smart grid evolution: Predictive control of distributed energy resources\u2014A review",
            "venue": "Int. J. Electr. Power Energy Syst",
            "year": 2023
        },
        {
            "authors": [
                "P. Cortes",
                "S. Kouro",
                "B. La Rocca",
                "R. Vargas",
                "J. Rodriguez",
                "J.I. Leon",
                "S. Vazquez",
                "L.G. Franquelo"
            ],
            "title": "Guidelines for weighting factors design in Model Predictive Control of power converters and drives",
            "venue": "In Proceedings of the 2009 IEEE International Conference on Industrial Technology,",
            "year": 2009
        },
        {
            "authors": [
                "M. Norambuena",
                "J. Rodriguez",
                "Z. Zhang",
                "F. Wang",
                "C. Garcia",
                "R. Kennel"
            ],
            "title": "A Very Simple Strategy for High-Quality Performance of AC Machines Using Model Predictive Control",
            "venue": "IEEE Trans. Power Electron",
            "year": 2019
        },
        {
            "authors": [
                "O. Babayomi",
                "Z. Zhang",
                "Y. Li",
                "R. Kennel"
            ],
            "title": "Adaptive Predictive Control with Neuro-Fuzzy Parameter Estimation for Microgrid Grid-Forming Converters",
            "venue": "Sustainability",
            "year": 2021
        },
        {
            "authors": [
                "Z. Wang",
                "Q. Qu",
                "Y. Zhang",
                "Z. Min"
            ],
            "title": "Model-Free Predictive Power Control for PWM Rectifiers under Asymmetrical Grids",
            "venue": "Symmetry 2022,",
            "year": 2022
        },
        {
            "authors": [
                "Z. Zhang",
                "Z. Li",
                "M.P. Kazmierkowski",
                "J. Rodriguez",
                "R. Kennel"
            ],
            "title": "Robust Predictive Control of Three-Level NPC Back-to-Back Power Converter PMSG Wind Turbine Systems with Revised Predictions",
            "venue": "IEEE Trans. Power Electron",
            "year": 2018
        },
        {
            "authors": [
                "J. Zhang",
                "L. Li",
                "D.G. Dorrell",
                "M. Norambuena",
                "J. Rodriguez"
            ],
            "title": "Predictive Voltage Control of Direct Matrix Converters with Improved Output Voltage for Renewable Distributed Generation",
            "venue": "IEEE J. Emerg. Sel. Top. Power Electron",
            "year": 2019
        },
        {
            "authors": [
                "M.F. Elmorshedy",
                "W. Xu",
                "S.M. Allam",
                "J. Rodriguez",
                "C. Garcia"
            ],
            "title": "MTPA-Based Finite-Set Model Predictive Control Without Weighting Factors for Linear Induction Machine",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2021
        },
        {
            "authors": [
                "M.B. Shadmand",
                "S. Jain",
                "R.S. Balog"
            ],
            "title": "Autotuning Technique for the Cost Function Weight Factors in Model Predictive Control for Power Electronic Interfaces",
            "venue": "IEEE J. Emerg. Sel. Top. Power Electron",
            "year": 2019
        },
        {
            "authors": [
                "K. Zaouche",
                "S.M. Benmerabet",
                "A. Talha",
                "E.M. Berkouk"
            ],
            "title": "Finite-Set Model Predictive Control of an Asymmetric Cascaded H-bridge photovoltaic inverter",
            "venue": "Appl. Surf. Sci",
            "year": 2019
        },
        {
            "authors": [
                "P.R.U. Guazzelli",
                "W.C.d.A. Pereira",
                "C.M.R.d. Oliveira",
                "A.G.D. Castro",
                "M.L.D. Aguiar"
            ],
            "title": "Weighting Factors Optimization of Predictive Torque Control of Induction Motor by Multiobjective Genetic Algorithm",
            "venue": "IEEE Trans. Power Electron",
            "year": 2019
        },
        {
            "authors": [
                "M. Novak",
                "H. Xie",
                "T. Dragicevic",
                "F. Wang",
                "J. Rodriguez",
                "F. Blaabjerg"
            ],
            "title": "Optimal Cost Function Parameter Design in Predictive Torque Control (PTC) Using Artificial Neural Networks (ANN)",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2020
        },
        {
            "authors": [
                "S. Kim",
                "Y. Jang",
                "R. Kim"
            ],
            "title": "Modeling and Hierarchical Structure Based Model Predictive Control of Cascaded Flying Capacitor Bridge Multilevel Converter for Active Front-End Rectifier in Solid-State Transformer",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2019
        },
        {
            "authors": [
                "W. Wu",
                "D. Wang",
                "L. Liu"
            ],
            "title": "A Multi-Layer Sequential Model Predictive Control of Three-Phase Two-Leg Seven-Level T-Type Nested Neutral Point Clamped Converter Without Weighting Factors",
            "venue": "IEEE Access 2019,",
            "year": 2019
        },
        {
            "authors": [
                "Z. Cui",
                "Z. Zhang",
                "T. Dragicevic",
                "J. Rodr\u00edguez"
            ],
            "title": "Dynamic Sequential Model Predictive Control of Three-Level NPC Back-to-Back Power Converter PMSG Wind Turbine Systems",
            "venue": "In Proceedings of the IECON 2020 the 46th Annual Conference of the IEEE Industrial Electronics Society, Singapore,",
            "year": 2020
        },
        {
            "authors": [
                "I. Jlassi",
                "A.J.M. Cardoso"
            ],
            "title": "Enhanced and Computationally Efficient Model Predictive Flux and Power Control of PMSG Drives for Wind Turbine Applications",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2020
        },
        {
            "authors": [
                "X. Lin",
                "W. Huang",
                "W. Jiang",
                "Y. Zhao",
                "S. Zhu"
            ],
            "title": "Predictive Torque Control for PMSM Based on Weighting Factor Elimination and Fast Voltage Vector Selection",
            "venue": "IEEE J. Emerg. Sel. Top. Power Electron",
            "year": 2020
        },
        {
            "authors": [
                "Y. Luo",
                "C. Liu"
            ],
            "title": "A Flux Constrained Predictive Control for a Six-Phase PMSM Motor With Lower Complexity",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2019
        },
        {
            "authors": [
                "M. Easley",
                "S. Jain",
                "M. Shadmand",
                "H. Abu-Rub"
            ],
            "title": "Autonomous Model Predictive Controlled Smart Inverter With Proactive Grid Fault Ride-Through Capability",
            "venue": "IEEE Trans. Energy Convers",
            "year": 2020
        },
        {
            "authors": [
                "D. Xiao",
                "M.P. Akter",
                "K. Alam",
                "R. Dutta",
                "S. Mekhilef",
                "M.F. Rahman"
            ],
            "title": "Cascaded Predictive Flux Control for a 3-L Active NPC Fed IM Drives Without Weighting Factor",
            "venue": "IEEE Trans. Energy Convers",
            "year": 2021
        },
        {
            "authors": [
                "N.S.P. Musunuru",
                "S. Srinivas"
            ],
            "title": "Cascaded Predictive Control of a Single Power Supply driven Four-level Open-end Winding Induction motor drive without weighting factors",
            "venue": "IEEE J. Emerg. Sel. Top. Power Electron",
            "year": 2020
        },
        {
            "authors": [
                "S.A. Davari",
                "M. Norambuena",
                "V. Nekoukar",
                "C. Garcia",
                "J. Rodriguez"
            ],
            "title": "Even-Handed Sequential Predictive Torque and Flux Control",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2020
        },
        {
            "authors": [
                "E. Kusuma",
                "K.M.R. Eswar",
                "T.V. Kumar"
            ],
            "title": "An Effective Predictive Torque Control Scheme for PMSM Drive without Involvement of Weighting Factors",
            "venue": "IEEE J. Emerg. Sel. Top. Power Electron",
            "year": 2020
        },
        {
            "authors": [
                "A. Bakeer",
                "G. Magdy",
                "A. Chub",
                "D. Vinnikov"
            ],
            "title": "Predictive control based on ranking multi-objective optimization approach for quasi Z-source inverter",
            "venue": "CSEE J. Power Energy Syst. 2020,",
            "year": 2020
        },
        {
            "authors": [
                "Y. Zhang",
                "B. Zhang",
                "H. Yang",
                "M. Norambuena",
                "J. Rodriguez"
            ],
            "title": "Generalized Sequential Model Predictive Control of IM Drives With Field-Weakening Ability",
            "venue": "IEEE Trans. Power Electron",
            "year": 2019
        },
        {
            "authors": [
                "Y.H. Li",
                "T.X. Wu",
                "D.W. Zhai",
                "C.H. Zhao",
                "Y.F. Zhou",
                "Y.G. Qin",
                "J.S. Su",
                "H. Qin"
            ],
            "title": "Hybrid Decision Based on DNN and DTC for Model Predictive Torque Control of PMSM",
            "venue": "Symmetry",
            "year": 2022
        },
        {
            "authors": [
                "H. Xie",
                "J. Du",
                "D. Ke",
                "Y. He",
                "F. Wang",
                "C. Hackl",
                "J. Rodr\u00edguez",
                "R. Kennel"
            ],
            "title": "Multistep Model Predictive Control for Electrical Drives\u2014A Fast Quadratic Programming Solution",
            "venue": "Symmetry",
            "year": 2022
        },
        {
            "authors": [
                "R.E.K. Meesala",
                "V.P.K. Kunisetti",
                "V.K. Thippiripati"
            ],
            "title": "Enhanced Predictive Torque Control for Open End Winding Induction Motor Drive Without Weighting Factor Assignment",
            "venue": "IEEE Trans. Power Electron",
            "year": 2019
        },
        {
            "authors": [
                "Y. Yang",
                "H. Wen",
                "M. Fan",
                "L. He",
                "M. Xie",
                "R. Chen",
                "M. Norambuena",
                "J. Rodr\u00edguez"
            ],
            "title": "Multiple-Voltage-Vector Model Predictive Control With Reduced Complexity for Multilevel Inverters",
            "venue": "IEEE Trans. Transp. Electrif",
            "year": 2020
        },
        {
            "authors": [
                "T. Liu",
                "A. Chen",
                "C. Qin",
                "J. Chen",
                "X. Li"
            ],
            "title": "Double Vector Model Predictive Control to Reduce Common-Mode Voltage Without Weighting Factors for Three-Level Inverters",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2020
        },
        {
            "authors": [
                "J.W. Moon",
                "J.S. Gwon",
                "J.W. Park",
                "D.W. Kang",
                "J.M. Kim"
            ],
            "title": "Model Predictive Control With a Reduced Number of Considered States in a Modular Multilevel Converter for HVDC System",
            "venue": "IEEE Trans. Power Deliv",
            "year": 2015
        },
        {
            "authors": [
                "M. Siami",
                "D. Arab Khaburi",
                "J. Rodriguez"
            ],
            "title": "Simplified Finite Control Set-Model Predictive Control for Matrix Converter-Fed PMSM Drives",
            "venue": "IEEE Trans. Power Electron",
            "year": 2018
        },
        {
            "authors": [
                "X. Wu",
                "W. Song",
                "C. Xue"
            ],
            "title": "Low-Complexity Model Predictive Torque Control Method Without Weighting Factor for Five-Phase PMSM Based on Hysteresis Comparators",
            "venue": "IEEE J. Emerg. Sel. Top. Power Electron. 2018,",
            "year": 2018
        },
        {
            "authors": [
                "S.A. Davari",
                "J. Rodriguez"
            ],
            "title": "Predictive Direct Voltage Control of Induction Motor With Mechanical Model Consideration for Sensorless Applications",
            "venue": "IEEE J. Emerg. Sel. Top. Power Electron. 2018,",
            "year": 1990
        },
        {
            "authors": [
                "Y. Xu",
                "Y. He",
                "S. Li"
            ],
            "title": "Logical Operation-Based Model Predictive Control for Quasi-Z-Source Inverter Without Weighting Factor",
            "venue": "IEEE J. Emerg. Sel. Top. Power Electron",
            "year": 2021
        },
        {
            "authors": [
                "E.S. Jun",
                "M.H. Nguyen",
                "S.S. Kwak"
            ],
            "title": "Model Predictive Control Method With NP Voltage Balance by Offset Voltage Injection for Three-Phase Three-Level NPC Inverter",
            "venue": "IEEE Access 2020,",
            "year": 2020
        },
        {
            "authors": [
                "X. Liu",
                "D. Wang",
                "Z. Peng"
            ],
            "title": "A Computationally Efficient FCS-MPC Method Without Weighting Factors for NNPCs With Optimal Duty Cycle Control",
            "venue": "IEEE/ASME Trans. Mechatron",
            "year": 2018
        },
        {
            "authors": [
                "Y. Jin",
                "Q. Xiao",
                "H. Jia",
                "Y. Mu",
                "Y. Ji",
                "T. Dragieevic",
                "R. Teodorescu",
                "F. Blaabjerg"
            ],
            "title": "A Novel Sliding-Discrete-Control-Set Modulated Model Predictive Control for Modular Multilevel Converter",
            "venue": "IEEE Access 2021,",
            "year": 2021
        },
        {
            "authors": [
                "J. Wang",
                "X. Liu",
                "Q. Xiao",
                "D. Zhou",
                "H. Qiu",
                "Y. Tang"
            ],
            "title": "Modulated Model Predictive Control for Modular Multilevel Converters With Easy Implementation and Enhanced Steady-State Performance",
            "venue": "IEEE Trans. Power Electron",
            "year": 2020
        },
        {
            "authors": [
                "A. Kaymanesh",
                "A. Chandra",
                "K. Al-Haddad"
            ],
            "title": "Model Predictive Control of MPUC7-Based STATCOM Using Autotuned Weighting Factors",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2021
        },
        {
            "authors": [
                "Y. Yang",
                "J. Pan",
                "H. Wen",
                "X. Zhang",
                "Y. Wang",
                "W. Perdikakis"
            ],
            "title": "Model Predictive Control with Auto-tuning Weighting Factors for Single-phase Six-Level Hybrid-Clamped Converters",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2020
        },
        {
            "authors": [
                "S.A. Davari",
                "V. Nekoukar",
                "C. Garcia",
                "J. Rodriguez"
            ],
            "title": "Online Weighting Factor Optimization by Simplified Simulated Annealing for Finite Set Predictive Control",
            "venue": "IEEE Trans. Ind. Inform",
            "year": 2021
        },
        {
            "authors": [
                "A. Bhowate",
                "M. Aware",
                "S. Sharma"
            ],
            "title": "Predictive Torque Control With Online Weighting Factor Computation Technique to Improve Performance of Induction Motor Drive in Low Speed Region",
            "venue": "IEEE Access 2019,",
            "year": 2019
        },
        {
            "authors": [
                "C. Gong",
                "Y. Hu",
                "M. Ma",
                "J. Gao",
                "K. Shen"
            ],
            "title": "Novel Analytical Weighting Factor Tuning Strategy Based on State Normalization and Variable Sensitivity Balance for PMSM FCS-MPTC",
            "venue": "IEEE/ASME Trans. Mechatron",
            "year": 2020
        },
        {
            "authors": [
                "L.M. Caseiro",
                "A.M. Mendes",
                "S.M. Cruz"
            ],
            "title": "Dynamically Weighted Optimal Switching Vector Model Predictive Control of Power Converters",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2019
        },
        {
            "authors": [
                "M. Babaie",
                "M. Mehrasa",
                "M. Sharifzadeh",
                "K. Al-Haddad"
            ],
            "title": "Floating Weighting Factors ANN-MPC Based on Lyapunov Stability for Seven-Level Modified PUC Active Rectifier",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2021
        },
        {
            "authors": [
                "O. Machado",
                "P. Mart\u00edn",
                "F.J. Rodr\u00edguez",
                "E.J. Bueno"
            ],
            "title": "A Neural Network-Based Dynamic Cost Function for the Implementation of a Predictive Current Controller",
            "venue": "IEEE Trans. Ind. Inform",
            "year": 2017
        },
        {
            "authors": [
                "S. Wang",
                "P. Dehghanian",
                "M. Alhazmi",
                "M. Nazemi"
            ],
            "title": "Advanced control solutions for enhanced resilience of modern powerelectronic-interfaced distribution systems",
            "venue": "J. Mod. Power Syst. Clean Energy 2019,",
            "year": 2019
        },
        {
            "authors": [
                "C.A. Rojas",
                "J.R. Rodriguez",
                "S. Kouro",
                "F. Villarroel"
            ],
            "title": "Multiobjective Fuzzy-Decision-Making Predictive Torque Control for an Induction Motor Drive",
            "venue": "IEEE Trans. Power Electron",
            "year": 2017
        },
        {
            "authors": [
                "P. Karamanakos",
                "E. Liegmann",
                "T. Geyer",
                "R. Kennel"
            ],
            "title": "Model Predictive Control of Power Electronic Systems: Methods, Results, and Challenges",
            "venue": "IEEE Open J. Ind. Appl. 2020,",
            "year": 2020
        },
        {
            "authors": [
                "D.F. Valencia",
                "R. Tarvirdilu-Asl",
                "C. Garcia",
                "J. Rodriguez",
                "A. Emadi"
            ],
            "title": "A Review of Predictive Control Techniques for Switched Reluctance Machine Drives",
            "venue": "Part I: Fundamentals and Current Control. IEEE Trans. Energy Convers",
            "year": 2021
        },
        {
            "authors": [
                "D.F. Valencia",
                "R. Tarvirdilu-Asl",
                "C. Garcia",
                "J. Rodriguez",
                "A. Emadi"
            ],
            "title": "A Review of Predictive Control Techniques for Switched Reluctance Machine Drives. Part II: Torque Control, Assessment and Challenges",
            "venue": "IEEE Trans. Energy Convers",
            "year": 2021
        },
        {
            "authors": [
                "Z. Dong",
                "Z. Zhang",
                "Z. Li",
                "X. Li",
                "J. Qin",
                "C. Liang",
                "M. Han",
                "Y. Yin",
                "J. Bai",
                "C Wang"
            ],
            "title": "A Survey of Battery\u2013Supercapacitor Hybrid Energy Storage Systems: Concept, Topology, Control and Application",
            "venue": "Symmetry 2022,",
            "year": 2022
        },
        {
            "authors": [
                "J. Rodriguez",
                "C. Garcia",
                "A. Mora",
                "F. Flores-Bahamonde",
                "P. Acuna",
                "M. Novak",
                "Y. Zhang",
                "L. Tarisciotti",
                "S.A. Davari",
                "Z Zhang"
            ],
            "title": "Latest Advances of Model Predictive Control in Electrical Drives\u2014Part I: Basic Concepts and Advanced Strategies",
            "venue": "IEEE Trans. Power Electron",
            "year": 2022
        },
        {
            "authors": [
                "J. Rodriguez",
                "C. Garcia",
                "A. Mora",
                "S.A. Davari",
                "J. Rodas",
                "D.F. Valencia",
                "M. Elmorshedy",
                "F. Wang",
                "K. Zuo",
                "L Tarisciotti"
            ],
            "title": "Latest Advances of Model Predictive Control in Electrical Drives\u2014Part II: Applications and Benchmarking with Classical Control Methods",
            "venue": "IEEE Trans. Power Electron",
            "year": 2022
        },
        {
            "authors": [
                "O. Babayomi",
                "Z. Li",
                "Z. Zhang",
                "Y. Sun",
                "T. Dragicevic",
                "J. Rodriguez"
            ],
            "title": "The Role of Model Predictive Control in Microgrid Power Quality\u2014A Survey",
            "venue": "In Proceedings of the 2020 IEEE 11th International Symposium on Power Electronics for Distributed Generation Systems (PEDG), Dubrovnik, Croatia,",
            "year": 2020
        },
        {
            "authors": [
                "D. Razmi",
                "O. Babayomi",
                "A. Davari",
                "T. Rahimi",
                "Y. Miao",
                "Z. Zhang"
            ],
            "title": "Review of Model Predictive Control of Distributed Energy Resources in Microgrids",
            "venue": "Symmetry 2022,",
            "year": 2022
        },
        {
            "authors": [
                "H. Chen",
                "Z. Zhang",
                "P. Karamanakos",
                "J. Rodriguez"
            ],
            "title": "Digital Twin Techniques for Power Electronics-Based Energy Conversion Systems: A Survey of Concepts, Application Scenarios, Future Challenges, and Trends",
            "venue": "IEEE Ind. Electron. Mag",
            "year": 2022
        },
        {
            "authors": [
                "T. Geyer"
            ],
            "title": "Model Predictive Control of High Power Converters and Industrial Drives",
            "year": 2016
        },
        {
            "authors": [
                "Z. Zhang",
                "H. Fang",
                "F. Gao",
                "J. Rodr\u00edguez",
                "R. Kennel"
            ],
            "title": "Multiple-Vector Model Predictive Power Control for Grid-Tied Wind Turbine System With Enhanced Steady-State Control Performance",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2017
        },
        {
            "authors": [
                "S.W. Kang",
                "J.H. Soh",
                "R.Y. Kim"
            ],
            "title": "Symmetrical Three-Vector-Based Model Predictive Control With Deadbeat Solution for IPMSM in Rotating Reference Frame",
            "venue": "IEEE Trans. Ind. Electron",
            "year": 2020
        },
        {
            "authors": [
                "J. Han",
                "P. Zhao",
                "G. Yao",
                "H. Chen",
                "Y. Wang",
                "M. Benbouzid",
                "T. Tang"
            ],
            "title": "Model predictive current control of asymmetrical hybrid cascaded multilevel inverter",
            "venue": "J. Power Electron",
            "year": 2022
        },
        {
            "authors": [
                "X. Yu",
                "Y. Yang",
                "L. Xu",
                "D. Ke",
                "Z. Zhang",
                "F. Wang"
            ],
            "title": "Luenberger Disturbance Observer-Based Deadbeat Predictive Control for Interleaved Boost Converter",
            "venue": "Symmetry 2022,",
            "year": 2022
        },
        {
            "authors": [
                "K.M.R. Eswar",
                "K.V.P. Kumar",
                "T.V. Kumar"
            ],
            "title": "A Simplified Predictive Torque Control Scheme for Open-End Winding Induction Motor Drive",
            "venue": "IEEE J. Emerg. Sel. Top. Power Electron",
            "year": 2019
        },
        {
            "authors": [
                "H. Xu",
                "C. Yu",
                "C. Liu",
                "Q. Wang",
                "F. Liu",
                "F. Li"
            ],
            "title": "An Improved Virtual Capacitor Algorithm for Reactive Power Sharing in Multi-Paralleled Distributed Generators",
            "venue": "IEEE Trans. Power Electron",
            "year": 2019
        },
        {
            "authors": [
                "S. Zhao",
                "F. Blaabjerg",
                "H. Wang"
            ],
            "title": "An Overview of Artificial Intelligence Applications for Power Electronics",
            "venue": "IEEE Trans. Power Electron",
            "year": 2021
        },
        {
            "authors": [
                "T. Geyer"
            ],
            "title": "Algebraic Tuning Guidelines for Model Predictive Torque and Flux Control",
            "venue": "IEEE Trans. Ind. Appl",
            "year": 2018
        },
        {
            "authors": [
                "Z. Zhang",
                "C.M. Hackl",
                "R. Kennel"
            ],
            "title": "Computationally Efficient DMPC for Three-Level NPC Back-to-Back Converters in Wind Turbine Systems With PMSG",
            "venue": "IEEE Trans. Power Electron",
            "year": 2017
        },
        {
            "authors": [
                "Z. Cui",
                "Z. Zhang",
                "Q. Yang",
                "R. Kennel"
            ],
            "title": "Cascaded Model Predictive Control of Three-Level NPC Back-to-Back Power Converter PMSG Wind Turbine Systems",
            "venue": "In Proceedings of the 2018 IEEE International Power Electronics and Application Conference and Exposition (PEAC), Shenzhen, China,",
            "year": 2018
        },
        {
            "authors": [
                "Y. Li",
                "Z. Zhang",
                "M.P. Kazmierkowski"
            ],
            "title": "Cascaded Predictive Control for Three-Level NPC Power Converter Fed Induction Machine Drives Without Weighting Factors",
            "venue": "In Proceedings of the 2018 IEEE International Power Electronics and Application Conference and Exposition (PEAC), Shenzhen, China,",
            "year": 2018
        }
    ],
    "sections": [
        {
            "text": "Citation: Zhang, Y.; Zhang, Z.;\nBabayomi, O.; Li, Z. Weighting Factor\nDesign Techniques for Predictive\nControl of Power Electronics and\nMotor Drives. Symmetry 2023, 15,\n1219. https://doi.org/10.3390/\nsym15061219\nAcademic Editors: Moo-Yeon Lee\nand Deming Lei\nReceived: 28 April 2023\nRevised: 23 May 2023\nAccepted: 6 June 2023\nPublished: 7 June 2023\nCopyright: \u00a9 2023 by the authors.\nLicensee MDPI, Basel, Switzerland.\nThis article is an open access article\ndistributed under the terms and\nconditions of the Creative Commons\nAttribution (CC BY) license (https://\ncreativecommons.org/licenses/by/\n4.0/).\nKeywords: weighting factor; model predictive control; power electronics converters; drives; renewable energy resources; microgrids; asymmetry"
        },
        {
            "heading": "1. Introduction",
            "text": "Model predictive control is emerging as a popular control technique with applications in cross-disciplinary domains. Over the past half-century, it has found industrial relevance in petrochemical, aerospace, and automotive processing and manufacturing. Despite the initial introduction of MPC to power electronics control in the 1980s, its ascendancy has occurred over roughly the past two decades [1]. This resurgence has been attributed to the emergence of fast microprocessors with the capability to meet the high computational needs of MPC. MPC can be grouped into finite control set MPC (FCS-MPC) and generalized predictive control [2]. However, FCS-MPC (sometimes called direct MPC with reference tracking [1,3]) has been studied more extensively because of its intuitive features and ease of application. Despite its advantages, including high performance multi-objective control with constraints, FCS-MPC (henceforth simply called MPC) is limited by several challenges, among which is the optimal weighting factor design in the asymmetric cost function. Three generic scenarios are typical in the design of weighting factors. First, certain multi-objective cost functions do not require weighting factors; they comprise sub-objectives with identical units or order of magnitudes. In cases such as this, there is usually a single variable being controlled which is split into different components in the cost function, for example, the voltage or current control of a voltage source converter or the control of complex power in a grid-connected converter. In the first case, where there is a threephase or multi-phase system, the cost function has components for each coordinate axis (or phase) [4], e.g., J = (v\u2217a \u2212 va)2 + (v\u2217b \u2212 vb) 2 + (v\u2217c \u2212 vc)2. Similarly, complex power\nSymmetry 2023, 15, 1219. https://doi.org/10.3390/sym15061219 https://www.mdpi.com/journal/symmetry\ncomprises active and reactive power, resulting in the weighting factor-free cost function J = (S\u2217 \u2212 S)2 = (P\u2217 \u2212 P)2 + (Q\u2217 \u2212Q)2 [5,6]. Second, while the multi-objective terms are of equal priority, they have different units or magnitudes, making weighting factors necessary. In this case, the weighting factors must be set to 1 after ensuring that all magnitudes are made equal (usually by normalization) [7]. A common examble of this occurs in the torque and flux control of an induction machine drive [8]. Third, the multi-objective terms are of unequal priority, with certain terms having higher control priority than others. Examples of this case include predictive current control of a grid-connected rectifier with control input (switching frequency) regulation [9] and predictive current control with reactive power regulation [7]. The weighting factor is used to prioritize control objectives in the single asymmetric cost function to be optimized in MPC-based multi-objective control [10]. Thus, objectives with higher priority receive higher weight assignments. Based on this principle, researchers usually adjust values assigned to weight factors heuristically until performance indices are attained, including total harmonic distortion (THD), tracking error, average switching frequency, and steady-state stability. Nonetheless, this procedure hinders optimal MPC performance. Therefore, researchers in this field have devised several alternative approaches to overcome this challenge. These can be categorized as offline heuristic weighting factor tuning, sequential MPC, simplified model-based MPC, and online optimization tuning approaches comprising both artificial intelligence (AI)-based and non-AI-based methods. Sequential MPC methods, called cascaded schemes in the literature, attempt to simplify the design process by indirectly achieving the purpose of the weighting factor, rendering it unnecessary [8]. Another method that avoids the weight factor is the simplified-model MPC. This can be applied where the competing control objectives can be analytically transformed into one parameter such that all objectives have the same unit [11\u201313]. Online optimization tuning utilizes an optimization algorithm to select the optimal weighting factor with respect to real-time plant and operational conditions [14,15], and can increase the computational burden of the controller. It comprises both non-AI-based and AI-based methods. AI-based online tuning schemes optimize the tuning process using genetic algorithms, fuzzy logic, and other AI schemes [16]. AI methods have been shown to have relatively low computational requirements in control applications [17]. These techniques have been validated in various applications. Sequential MPC has been applied to cascaded flying capacitor bridge (CFCB) multilevel converters [18], threephase/two-leg/seven-level T-type nested NPC converters [19], and three-level neutral-pointclamped (NPC) back-to-back converter permanent magnet synchronous machine (PMSM) wind turbines [20]. The simplified model method has been applied to the induction motor and PMSM [11,12,21\u201324]. Online optimization of the weighting factor has been applied to quasi-Zsource PV inverters [25] and DC\u2013DC single-ended primary-inductor converters (SEPIC) [26]. A more comprehensive classification and listing of applications is provided in Table 1.\nRedundant switching states/ voltage vectors Multilevel Inverters HVDC [36\u201338], Matrix converter-fed PMSM drives [39] Virtual voltage vectors 5Ph PMSM [40] Model reference adaptive system Induction motor [41] Logical control of each control objective Quasi-Z-Source inverter [42] Offset voltage between upper and lower capacitor arms 3Ph 3L NPC inverter [43] Fuzzy decision-making Nested NPC rectifier [44] Independent circulating current controller Multilevel inverters HVDC [45,46]\nOnline Optimization: Non-AI-based (with weighting factor) Tracking error optimization Quasi-Z-source PV inverter [25], DC-DC single-ended primaryinductor converters (SEPIC) [26], 7L modified packed U-cell (MPUC7) STATCOM [47], 1Ph 6L hybrid-clamped converters [48]\nAnnealing algorithm Induction motor [49] Coefficient of variation Asymmetric cascaded H-bridge photovoltaic inverter [15], Induction motor [50] State normalization and variable sensitivity balance PMSM [51] Grey relational analysis Induction motor [51] Continuous function of the preerror 3L NPC converter [52]\nOnline Optimization: AIbased (with weighting factor) Genetic algorithm Induction motor [16]\nArtificial neural network (ANN) Induction motor [17], 7L modified packed U-cell (MPUC7) active rectifier [53], 3L NPC converter [54], 2L inverter [55] Fuzzy logic PMSM [56], Induction motor [57]\n\u201cL\u201d represents level, \u201cPh\u201d represents phase, NPC representsneutral-point clamped, B2B represents back-to-back, PMSM represents permanent magnet synchronous machine, STATCOM represents static synchronous compensator, HVDC represents high voltage direct current, and PWM represents pulse width modulation.\nReview studies on MPC for power electronics and drives have been reported in past publications, revealing the basic concepts, strategies, applications, and benchmarking with classical control methods. In [2,58], the authors surveyed MPC of power converters with a focus on both academic and industrial aspects of the prediction model, the cost function, and the optimization algorithm. The predictive torque control of switched reluctance machine drives was covered in [59,60]. In [61], the authors surveyed the application of predictive control in battery and supercapacitor energy storage systems. In the field of electrical drives, [62] presented weighting factor calculation in the most relevant contributions published in the last few years, while [63] presented a performance comparison. The authors of [64,65] reviewed MPC applications for microgrid converters. In [66], the authors discussed the future trends and challenges of digital twins in the field of MPC for power electronics. However, none of these publications carried out a detailed study on the design of the weighting factor in the asymmetric cost function of MPC for converters and drives. In addition, there is as yet no study that provides a detailed quantitative comparison of the performance of different weighting factor design methods. To close this research gap, the present study focuses specifically on the methods for designing weighting factors (or indirectly achieving their purpose while avoiding their explicit use), which is a significant challenge that has been highlighted in several studies. Here, we provide a\ndetailed comparison of design methods using their underlying mathematical principles, control schemes, and numerical results of dynamic performances. The contributions of this paper include:\n\u2022 A detailed review of the design of weighting factors for the predictive control of power electronic converters; \u2022 A detailed comparison of the design methods based on their underlying mathematical principles, control schemes, and numerical results of dynamic performances; \u2022 Guidelines for the choice of weighting factor design method in power electronic applications.\nThe paper introduces the fundamentals of MPC and heuristic weighting factor tuning in Section 2. Three weighting factor design methods are presented as follows: sequential MPC in Section 3, simplified model MPC in Section 4, and online optimization-based tuning in Section 5. The relative performance of the different methods are compared in Section 6 on a symmetrical two-level back-to-back topology, and the final conclusions are drawn in Section 7."
        },
        {
            "heading": "2. Fundamentals of MPC for Power Converters",
            "text": "In this section, the underlying principles of MPC are discussed, including the system model and weighting factor."
        },
        {
            "heading": "2.1. System Model",
            "text": "The generic discrete model of a power converter is provided by (1), where k \u2208 N is the discrete time step, x is the state vector (with state variables that include the filter current/voltage and machine fluxes [58]), and y is the output vector (with output variables including output current, voltage, active/reactive power, speed, and torque):\nx(k + 1) = f(x(k), u(k)) (1a)\ny = x(k) (1b)\nConsidering a sequence of input variables over a prediction horizon Np \u2208 N time steps, a sequence of possible power converter switching states that the controller can implement can be defined as follows [58,67]:\nU(k) = [uT(k) uT(k + 1) ... uT(k + Np \u2212 1)] (2)\nThe predictive controller seeks an optimal switching sequence\nUopt(k) = min U(k) J (3)\nwhere J is the cost function that captures the control objectives for the optimization problem. In power converter systems, the control objective can track a reference by minimizing a tracking error magnitude as follows:\nJ = k+Np\u22121\n\u2211 k=1\n\u2016yp(k + 1)\u2212 y\u2217(k + 1)\u20162Q + \u03bbu\u2016\u2206u(k)\u201622 (4)\nwhere Q is the penalty matrix on the tracking error, yp is the predicted output, y\u2217 is the reference, \u03bbu penalizes the control effort \u2206u(k), and \u2206u(k) := u(k)\u2212 u(k\u2212 1). MPC is a receding horizon scheme; therefore, only the first term of the sequence Uopt(k) is applied to the plant. Recalculation of the next sampling instant\u2019s predictions and optimal sequence is performed after the measurements/estimates of the states have been updated.\nDetailed discussions on holistic design considerations for MPC, including the prediction horizon, control effort, weighting factor, and performance assessment, are outside the scope of this article, but can be found in [1]. In this work, the focus is on the design methods for optimal weighting factor tuning."
        },
        {
            "heading": "2.2. Heuristic Weighting Factor Tuning",
            "text": "As mentioned earlier, MPC can facilitate the optimal control of the multi-objective terms/parameters in a predictive cost function. Several of these parameters might have equal control priorities [68\u201371], which is ideal for symmetrical cost function designs. However, other control objectives may have differing priorities, e.g., torque and flux control in electrical machine drives. The latter case requires weighting factors in order to set the relative importance between the control objectives for optimal system performance (e.g., low current THD) in an asymmetric cost function. The conventional means of determining the value of the weighting factors rely on offline heuristic tuning, leading to sub-optimal control results [1]. In the following discourse, proposed solutions from the literature are subjected to objective analyses while highlighting the advantages and disadvantages associated with each method."
        },
        {
            "heading": "3. Sequential Model Predictive Control",
            "text": "Sequential MPC is a relatively new method that offers a solution to the challenges associated with tuning the weighting factors for MPC of power electronic converters. This method was introduced by [8], and operates on the concept of using multiple cost functions arranged in a cascaded/sequential order of computational execution, as shown in Figure 1. In the figure, n cost functions are arranged sequentially in decreasing order of priority, representing the cost function J (5a) broken into cascaded cost functions J1 to Jn (5b):\nJ = |xpred1 \u2212 x \u2217 1 |+ \u03bbx2|x pred 2 \u2212 x \u2217 2 |+ ... + \u03bbxn|x pred n \u2212 x\u2217n| (5a) J1 = |x pred 1 \u2212 x \u2217 1 |, J2 = |x pred 2 \u2212 x \u2217 2 |, . . . , Jn = |x pred n \u2212 x\u2217n| (5b)\nNote that here xpredi is the predicted term and x \u2217 i is the reference \u2200 i \u2208 {1, 2, ..., n}. After the model prediction stage, the first cost function (representing the criterion of highest priority) is executed. The output of block J1 comprises a sorted list of selected optimal voltage vectors that is made available to all subsequent cost function stages J2 to Jn. Stages J2 to Jn each optimize their respective individual cost functions using information about the prediction model and references. The final stage Jn provides the switching signals Sabc of the overall optimal voltage vector for each sampling time.\nTwo challenges arise with basic sequential MPC: first, the number of selected switching vectors from each stage could be too limited for optimal control of subsequent stages, and second, because the first stage is implicitly afforded the highest priority, there is a problem with applications in which all criteria/cost functions have equal priorities in a symmetrical structure. The first challenge is addressed to an extent by dynamic sequential MPC [20], while the second challenge can be solved using generalized sequential MPC [32] or evenhanded MPC [29]. The dynamic sequential MPC approach shown in Figure 2 adaptively\nmodifies the sorted list of selected optimal voltage vectors from each stage to include all vectors that satisfy a minimum error criterion [20], thereby providing better dynamic performance than when a static number of switching vectors is selected. Furthermore, both generalized sequential MPC [32] and even-handed MPC [29] overcome the inherent challenges of using a fixed sequence of execution for the cost functions. The even-handed method shown in Figure 3, for instance, adaptively selects the order of execution based on the simultaneous optimality of all criteria using a cross-error minimization process.\nFor instance, in a two-level inverter with eight voltage vectors ui|i = {0, 1, .., 7}, the control objectives can be for states x1 and x2 to track their references x\u22171 and x \u2217 2 , respectively. The criteria C1, C2 can be computed by normalization of the predicted errors for predicted terms xp1 and x p 2 (where x1rated and x2rated are the rated values of x1 and x2):\nCj = |xpj \u2212 x \u2217 j |\nxjrated , \u2200j \u2208 {1, 2} (6)\nApplying conventional sequential MPC sets C1 as the priority criterion. However, this results in suboptimal results for C2, as illustrated in Figure 4. In this case, the three most optimal vectors relative to C1 are {u4, u3, u2}, while u4 is selected as the applied voltage vector; however, u4 is not as optimal for C2 as u5. Nonetheless, u5 is excluded from the selection. Even-handed sequential MPC (EH-SMPC) provides a solution to this limitation.\nEH-SMPC improves optimization performance by introducing the concept of crosserrors. At each sampling instant, the following steps are executed: Step 1: The voltage vectors are ranked for C1, C2 as follows: Cj = [Cjr1, Cjr2, ..., Cjr8] \u2200 j \u2208 {1, 2}, with rank r1 being the most optimal and r8 the least optimal. Step 2: The three highest ranking voltage vectors for each of C1, C2 are selected for the cross-error stage, i.e., [C1r1, C1r2, C1r3] and [C2r1, C2r2, C2r3].\nStep 3: The cross-errors are computed as follows:\nerr12 = [(C2r1 \u2212 C1min), (C2r2 \u2212 C1min), (C2r3 \u2212 C1min)] (7a) err21 = [(C1r1 \u2212 C2min), (C2r2 \u2212 C2min), (C2r3 \u2212 C2min)] (7b)\nerr = [err12, err21] (7c)\nwhere Cjmin = min(Cj), \u2200 j \u2208 {1, 2}. Step 4: The vectors of all cross-errors (min(err)) are minimized and mapped to the\ncorresponding voltage vector for application to the plant. Despite their relative ease of implementation, sequential MPC techniques have been shown to result in sub-optimal performance [1] to optimally-tuned weighting factors."
        },
        {
            "heading": "4. Simplified Model-Based MPC",
            "text": "Simplified model-based MPC methods aim to avoid the use of weighting factors by unifying the control objectives. This is possible where these control objectives are (in)directly interrelated. For instance, flux and torque can be unified in drive applications [11\u201313,21\u201324,35]. In addition, the model of multilevel converters can be simplified by reducing the number of switching states or introducing redundant voltage vectors without sacrificing good control performance [36,37]. The two cases of this method, i.e., unified control objectives and reduced switching states, are discussed in detail in this section. The overall control scheme of a simplified MPC model with unified control objectives is shown in Figure 5 for a generic power converter system. It involves three basic control stages: state prediction, reference conversion, and cost function minimization. Without loss of generality, the figure applies to the case in which two states (x1 and x2) need to be controlled via a single predictive cost function without the use of a weighting factor. Because these states are usually defined in different units, e.g., flux and torque, the crucial step in this method is the reference conversion of both states to the same unit. This can be accomplished by converting one state\u2019s reference to the other (e.g., x\u22172 to x \u2217 1 , or vice-versa), as was the case in [11\u201313,21,23,24,35] for torque to flux reference conversion and [72,73] for flux to torque reference conversion. Alternatively, a third variable \u03b6 can be introduced, and references x\u22171 and x \u2217 2 can both be converted to \u03b6\n\u2217, as was the case in [11] for flux and torque to voltage reference conversions. For improved steady-state performance, modifications to Figure 5 can include two optimal switching vectors per cycle instead of one. To achieve this, two stages can be added for second vector selection, duty ratio optimization, and pulse generation control (Figure 6) [11].\nThe use of reduced switching states/redundant voltage vectors is a means of simplifying the MPC of multilevel converters such as neutral-point clamped converters [43], nested neutral-point clamped converters [44], matrix converters [39], rectifiers [43], and quasiZ-source converters [42]. These converters are modeled with per-phase (e.g., MMC for HVDC [36\u201338,45,46]), and the three-phase concepts (e.g., motor drives [39]). The control objectives include the DC-link current ripple, sub-module voltage ripple, circulating current, output current, and sub-module capacitor voltage. Furthermore, while most studies were on FCS-MPC, few reported modulated MPC with constant switching frequency [45,46]. Due to the modular design of multilevel converters, the calculation burden of the control scheme increases with the number of sub-modules or cells. Therefore, in order to decrease the computational burden, methods of reducing the number of applied switching states have been investigated in the literature. Figure 7 shows a simplified MPC scheme for application in multilevel converters. It requires a current reference generation stage to optimize the cost function J. This is not done for all the available switching states, which could be as large as (N + 1)3 (where N is the number of sub-modules per arm); instead, an optimized set of redundant voltage vectors is generated for the cost function optimization process, reducing the computational burden to 3(N + 4) [38]. The literature has focused significantly on applying variants of this scheme to modular multilevel converters for HVDC [36\u201338,43,45,46]. Among these, only [45,46] have presented designs for modulated MPC with fixed switching frequencies, with all others using variable switching frequencies.\nGeneric simplified FCS-MPC for power electronics systems"
        },
        {
            "heading": "5. Online Optimization Methods",
            "text": "In this section, the online calculation of the optimal weight factor is discussed under the headings of AI-based tuning and non-AI-based optimization."
        },
        {
            "heading": "5.1. Artificial Intelligence-Based Tuning Methods",
            "text": "Artificial intelligence (AI) is associated with enabling machines to use intelligence in ways that mimic human learning and reasoning [74]. In the broad field of power electronics, four groups of AI techniques have been applied: expert systems, fuzzy logic, metaheuristic techniques, and machine learning [74]. Among these, the latter three have been applied to MPC weighting factor design in the literature.\nFuzzy logic, the most popular among AI methods in weighting factor design, forms rules using Boolean logic while taking uncertainties into consideration. It has been applied to electrical machine drives [56,57]. Metaheuristic techniques (e.g., genetic algorithms, particle swarm optimization) utilize biological processes for mathematical optimization [74]. A multi-objective genetic algorithm was employed in [16] to tune weighting factors for torque, flux, and switching frequency for model predictive torque control of an induction motor drive. The dynamic performance was reported to be better than when using a heuristic tuning process. Machine learning can be categorized into supervised learning (using labeled training datasets), unsupervised learning (using unlabeled datasets), and reinforcement learning (which does not require training datasets) [74]. Among several existing machine learning methods, only neural networks (a form of supervised learning) have been applied to online weighting factor optimization. The neural network approach has been used for a three-level neutral-point clamped converter [54], a two-level voltage source converter [55], and predictive torque control of an induction machine [17]. In contrast to previous methods that are trained offline, an online self-training neural network method was proposed in [53] for a sevenlevel modified packed U-cell (MPUC7) active rectifier, combining particle swarm algorithm optimization for multi-weight factor tuning and a decoupled Lyapunov stability objective to guarantee control stability. In summary, machine learning methods are notable and have promising potential because they do not add significantly to the computational burden and can provide high accuracy."
        },
        {
            "heading": "5.2. Non-AI-Based Online Optimization",
            "text": "Online optimization techniques carry out real-time optimization of the weighting factors in multi-objective predictive control of power converters. Because all calculations required to accurately determine the optimal weighting factor are performed online, these techniques generally increase the computational burden of the predictive control process. Methods employed in the literature include tracking error optimization [14,25,26,47,48], coefficient of variation [50], state normalization/variable sensitivity balance [51], and continuous function of pre-existing error [52]. To facilitate the optimal weight factor calculation for predictive torque and flux control in particular, algebraic methods are presented in [75], and these are not computationally-intensive. Figure 8 depicted an example for online autotuning of weighting factors [14,47], described in Algorithm 1.\nAlgorithm 1 Autotune Weight Factor [14,47]\n1: function AUTOTUNE(x1, x2) 2: g1 = |x1 \u2212 x\u22171 | < \u03a61 3: g2 = |x2 \u2212 x\u22172 | < \u03a62 . Here \u03a61, \u03a62 are maximum tracking errors 4: Tracking errors for g2: eg2 = {e2, 2e2, ..., Ne2} 5: Weighting factors set for g2: \u03bbg2 = {\u03bb2, 2\u03bb2, ..., N\u03bb2} 6: for i = 1 to 7 do 7: \u03c8 = ming2 8: end for 9: if \u03c8 \u2264 e2 then\n10: \u03bb = \u03bb2 11: ... 12: else if \u03c8 \u2264 Ne2 then 13: \u03bb = N\u03bb2 14: end if 15: end function"
        },
        {
            "heading": "6. Case Studies",
            "text": "In this section, the relative dynamic and steady-state performances of the different methods reviewed above are compared."
        },
        {
            "heading": "6.1. System Description and Modeling",
            "text": "Figure 9 illustrates the system to be controlled. It comprises a machine-side converter (MSC) that functions as an active front-end rectifier connected to a DC-link capacitor, which supplies a grid-side converter (GSC). For greater modeling simplicity, the wind turbine is directly mounted on the PMSG shaft without any interfacing gearbox. The system parameters are provided in Table 2. In order to remain within the scope of this paper, the details of the mathematical models and state predictions for the MSC and GSC can be found in [76,77] and are not repeated here.\nFour control schemes in the references were implemented on real-time hardwarein-the-loop (HiL) PLECS RT-Box devices (Figure 10) and compared: classical MPC [76], sequential MPC [77,78], even-handed sequential MPC [29], and online-tuned weighting factor-based MPC [14]. The HiL approach executes the actually compiled codes on a real microprocessor. Hence, its verification is more convincing than simulations. In addition, the HiL test provides controller validation at a low cost and with great flexibility. The test bench, shown in Figure 10, is composed of two PLECS RT Boxes. One of the RT boxes emulates the PMSG wind turbine system. To obtain accurate results, the switching behavior of the power converter has been modeled here. The other is used as a real-time controller to run the mentioned control algorithm. The plant emulator captures the switching signals generated by the controller, and the controller then uses analog-to-digital (AD) input channels to receive the feedback signals from the plant. Therefore, the test bench is close to the real system, taking into account the time delays in sampling, transmission, and calculation. Three key performance indices were used to compare the studied control methods, namely, power/voltage ripples, current THDs, and average switching frequency. These are defined as follows:\n\u2022 Ripples (%): The total ripples of a state variable x, computed as follows:\nx(ripples) = xmax \u2212 xaverage\nxrated \u00d7 100% (8)\nwhere x represents power or voltage, xmax is the maximum value of x, xaverage is the average value of x, and xrated is the rated value of x.\n\u2022 Total harmonic distortion (THD): THD is a measure of the distortion of the signal that arises from harmonics. Current THD is calculated as follows:\niTHD = \u221a\n\u2211\u221en=2 i2n(rms) ifund(rms)\n(9)\n\u2022 Average switching frequency ( fsw): This is computed as the average number of switch changes per sampling period:\nfsw = \u2211Nk=1 usw(k)\n3NTs (10)\nwhere N is the number of samples per second, Ts is the sampling period, and usw represents the switch change at a given sampling instant."
        },
        {
            "heading": "6.2. Overall Performance",
            "text": "Figure 11 shows the overall control performance without any mismatch in the model parameters (Case A), while the ripple and THD data are collected in Table 3. For all four control methods, three step parameter changes were effected to test the transient performance of the control schemes. The speed reference was changed from 0.85 p.u. to 1.15 p.u. at 0.06 s. The DC-link voltage Vdc was changed by +0.1 p.u. at 0.12 s. Finally, a pulse reactive power reference change of 1 p.u. was initiated at 0.18 s.\nUnder nominal parameter conditions, the performance of the DC-link voltage and power tracking for the four schemes were identical in their rapid response and low level of\nripples. As presented in Table 3, there is little difference in the current THD and average switching frequency resulting from the four methods. On the other hand, the even-handed MPC scheme has the best tracking performance, with no spikes during any the transients described earlier. The online-optimized method has good tracking as well, with secondlowest reactive power spikes during transients. Sequential MPC has low ripples, but has the highest reactive power tracking error."
        },
        {
            "heading": "6.3. Performance under Parameter Uncertainties",
            "text": "Figure 12 shows the overall control performance with the actual inductance set to 1.5Ln versus Ln in the controller. The same transients described earlier for the case without parameter mismatch were applied. Figures 13 and 14 show the machine-side and grid-side current THD in steady-state. All data are summarised in Table 4. As in the previous case, the performance of the DC-link voltage and active power tracking for the four schemes is identical in terms of the rapid response and low levels of ripples. Although even-handed sequential MPC has the highest voltage overshoot after the reference voltage step change, it produces the best overall performance for reactive power tracking. Meanwhile, the tracking accuracy of classical MPC is the worst in the case of parametric mismatch.\nConsistent with these results, a number of the aforementioned methods have been reported to provide enhanced robustness against parameter uncertainties. In particular, online optimization [14] and EH-SMPC [29]. When a system operates optimally at nominal parameter values, it has nominal operating-point weighting factors for all the weighted cost function elements. However, when there are model parameter mismatches this corresponds to a change in the operating point, and new weighting factors need to be computed. This\nis demonstrated by the predictive current control of a motor load (modeled as a backelectromotive force (EMF) in series with R\u2212 L load) in Figure 3 (EH-SMPC) and Figure 8 (online optimization of weighting factor). In Figure 3, two cost functions (11) are optimized in an even-handed manner:\nJ1 = |i p \u03b1 \u2212 i\u2217\u03b1|; J2 = |i p \u03b2 \u2212 i \u2217 \u03b2| (11)\nIn Figure 8, a single cost function (12) with a weighting factor \u03bb is used:\nJ = |ip\u03b1 \u2212 i\u2217\u03b1|+ \u03bb|i p \u03b2 \u2212 i \u2217 \u03b2| (12)\nThe zoomed plots in Figure 15 illustrate the current responses under two conditions: (i) a nominal inductance value L, and (ii) an inductance value of 0.5L. Using conventional MPC (\u03bb = 1 in (12)), current ripples at nominal inductance (phase A) are low and the reference is accurately tracked. The mismatch of filter values results in poor tracking of the reference and increased current ripples. However, with an optimally tuned weighting factor, better reference tracking is achieved along with slightly reduced ripples. Similarly, better reference tracking is achieved with EH-SMPC than with conventional MPC. This demonstrates the improved robustness of these techniques."
        },
        {
            "heading": "6.4. Performance Comparison",
            "text": "Table 5 summarizes the literature reporting the relative performance of different techniques for weighting factor design issues. Here, the classical heuristically-tuned weighting factor method is used as a reference for all other methods.\nSequential MPC methods and online optimization methods are reported to demonstrate a measure of improved robustness against model parameter variations compared to classical MPC, while simplified MPC has identical robustness to classical MPC. Furthermore, the computational time required for sequential MPC methods and online optimization methods is typically higher than for classical MPC. Nonetheless, simplified MPC methods generally have lower computational time than classical MPC. Hence, in choosing a method for weighting factor design, several features need to be taken into consideration. First, where relative parametric robustness is of high priority, online weighting factor optimization and sequential MPC methods are recommended. The use of sequential MPC has a limitation in that it reduces optimal control performance [1]. Second, when lower computational time and hardware resources are a priority, simplified MPC becomes advantageous."
        },
        {
            "heading": "7. Conclusions",
            "text": "Weighting factor design for predictive control of power converters in renewable energy conversion, electric drives, smart/microgrids, etc., has faced asymmetry challenges, leading to cumbersome tuning requirements. For this reason, many researchers have resorted to suboptimal design methods which reduce the powerful optimal control potential of predictive control techniques. This article has presented a review of state-of-the-art methods in weighting factor design, showing that the choice of weighting factor techniques by researchers and practitioners can be guided by two main factors: first, where relative parametric robustness is of high priority, online weighting factor optimization and sequential MPC methods are superior; second, when lower computational time and low cost of hardware resources are a priority, the use of simplified MPC techniques becomes advantageous. The trend of development in optimal weighting factor design for predictive control of power electronics and motor drives indicates the potential for significant advancements thanks to emerging methods. Our future work will focus on hybrid design methods that combine features of two or more of the methods described above, e.g., sequential MPC with a computationally efficient selection of switching states.\nAuthor Contributions: Conceptualization, Z.Z., O.B., and Y.Z.; methodology, O.B., Z.L.; software, Y.Z.; validation, O.B., Y.Z.; formal analysis, O.B.; investigation, Y.Z.; resources, Z.Z., Z.L.; data curation, Y.Z.; writing\u2014original draft preparation, O.B., Y.Z.; writing\u2014review and editing, Z.Z., Z.L.; visualization, O.B., Y.Z.; supervision, Z.Z., Z.L.; project administration, Z.Z.; funding acquisition, Z.Z. All authors have read and agreed to the published version of the manuscript.\nFunding: This research was funded by National Key R&D Program of China (2022YFB4201700).\nData Availability Statement: Not applicable.\nConflicts of Interest: The authors declare no conflict of interest.\nNomenclature\nx, y, U State vector, output vector, switching state xp, x\u2217 Predictive and reference value of x J Cost function \u03bb Weighting factor P Active power Q Reactive power iabcm , iabcn Generator and grid-side current vectors vabcm Generator voltage vector en Grid voltage vector Rn, Ln Filter resistance and inductance"
        }
    ],
    "title": "Weighting Factor Design Techniques for Predictive Control of Power Electronics and Motor Drives",
    "year": 2023
}