{
    "abstractText": "Characterizing the interactions and dynamics of quantummechanical systems is an essential task in developing quantum technologies. We propose an efficient protocol based on the estimation of the time-derivatives of few qubit observables using polynomial interpolation for characterizing the underlying Hamiltonian dynamics and Markovian noise of a multi-qubit device. For finite range dynamics, our protocol exponentially relaxes the necessary timeresolution of the measurements and quadratically reduces the overall sample complexity compared to previous approaches. Furthermore, we show that our protocol can characterize the dynamics of systemswith algebraically decaying interactions. The implementation of the protocol requires only the preparation of product states and single-qubit measurements. Furthermore, we improve a shadow tomography method for quantum channels that is of independent interest and discuss the robustness of the protocol to various errors. This protocol can be used to parallelize the learning of theHamiltonian, rendering it applicable for the characterization of both current and future quantum devices.",
    "authors": [
        {
            "affiliations": [],
            "name": "Daniel Stilck Fran\u00e7a"
        },
        {
            "affiliations": [],
            "name": "Liubov A. Markovich"
        },
        {
            "affiliations": [],
            "name": "V. V. Dobrovitski"
        },
        {
            "affiliations": [],
            "name": "Albert H. Werner"
        },
        {
            "affiliations": [],
            "name": "Johannes Borregaard"
        }
    ],
    "id": "SP:ea44e36979f24bf6c0a1000a4cb289fac284787e",
    "references": [
        {
            "authors": [
                "F Arute"
            ],
            "title": "Quantum supremacy using a programmable superconducting processor",
            "venue": "Nature 574,",
            "year": 2019
        },
        {
            "authors": [
                "Zhong",
                "H. S"
            ],
            "title": "Quantum computational advantage using photons",
            "venue": "Science 370,",
            "year": 2020
        },
        {
            "authors": [
                "P Scholl"
            ],
            "title": "Quantum simulation of 2d antiferromagnets with hundreds of Rydberg atoms",
            "venue": "Nature 595,",
            "year": 2021
        },
        {
            "authors": [
                "S Ebadi"
            ],
            "title": "Quantum phases of matter on a 256-atom programmable quantum simulator",
            "venue": "Nature 595,",
            "year": 2021
        },
        {
            "authors": [
                "J.I. Cirac",
                "P. Zoller"
            ],
            "title": "Goals and opportunities in quantum simulation",
            "venue": "Nat. Phys",
            "year": 2012
        },
        {
            "authors": [
                "I.L. Chuang",
                "M.A. Nielsen"
            ],
            "title": "Quantum Computation and Quantum Information",
            "year": 2010
        },
        {
            "authors": [
                "J Eisert"
            ],
            "title": "Quantum certification and benchmarking",
            "venue": "Nat. Rev. Phys",
            "year": 2020
        },
        {
            "authors": [
                "Shulman",
                "M. D"
            ],
            "title": "Suppressing qubit dephasing using real-time Hamiltonian estimation",
            "venue": "Nat. Commun",
            "year": 2014
        },
        {
            "authors": [
                "J. Zhang",
                "M. Sarovar"
            ],
            "title": "Quantum Hamiltonian identification from measurement time traces",
            "venue": "Phys. Rev. Lett. 113,",
            "year": 2014
        },
        {
            "authors": [
                "J. Zhang",
                "M. Sarovar"
            ],
            "title": "Identification of open quantum systems from observable time traces",
            "venue": "Phys. Rev. A",
            "year": 2015
        },
        {
            "authors": [
                "C. Di Franco",
                "M. Paternostro",
                "M.S. Kim"
            ],
            "title": "Hamiltonian tomography in an access-limited setting without state initialization",
            "venue": "Phys. Rev. Lett. 102,",
            "year": 2009
        },
        {
            "authors": [
                "S. Sheldon",
                "E. Magesan",
                "J.M. Chow",
                "J.M. Gambetta"
            ],
            "title": "Procedure for systematically tuning up cross-talk in the cross-resonance gate",
            "venue": "Phys. Rev. A",
            "year": 2016
        },
        {
            "authors": [
                "A. Sone",
                "P. Cappellaro"
            ],
            "title": "Hamiltonian identifiability assisted by a single-probe measurement",
            "venue": "Phys. Rev. A 95,",
            "year": 2017
        },
        {
            "authors": [
                "Samach",
                "G. O"
            ],
            "title": "Lindblad tomography of a superconducting quantum processor",
            "venue": "Phys. Rev. A",
            "year": 2022
        },
        {
            "authors": [
                "S.T. Wang",
                "D.L. Deng",
                "L.M. Duan"
            ],
            "title": "Hamiltonian tomography for quantummany-body systems with arbitrary couplings",
            "venue": "New J. Phys 17,",
            "year": 2015
        },
        {
            "authors": [
                "J Wang"
            ],
            "title": "Experimental quantum Hamiltonian learning",
            "venue": "Nat. Phys. 13,",
            "year": 2017
        },
        {
            "authors": [
                "A. Valenti",
                "E. van Nieuwenburg",
                "S. Huber",
                "E. Greplova"
            ],
            "title": "Hamiltonian learning for quantum error correction",
            "venue": "Phys. Rev. Res",
            "year": 2019
        },
        {
            "authors": [
                "A. Valenti",
                "G. Jin",
                "J. L\u00e9onard",
                "S.D. Huber",
                "E. Greplova"
            ],
            "title": "Scalable Hamiltonian learning for large-scale out-of-equilibrium quantum dynamics",
            "venue": "Phys. Rev. A 105,",
            "year": 2022
        },
        {
            "authors": [
                "C.E. Granade",
                "C. Ferrie",
                "N. Wiebe",
                "D.G. Cory"
            ],
            "title": "Robust online Hamiltonian learning",
            "venue": "New J. Phys 14,",
            "year": 2012
        },
        {
            "authors": [
                "N. Wiebe",
                "C. Granade",
                "C. Ferrie",
                "D.G. Cory"
            ],
            "title": "Hamiltonian learning and certification using quantum resources",
            "venue": "Phys. Rev. Lett. 112,",
            "year": 2014
        },
        {
            "authors": [
                "N. Wiebe",
                "C. Granade",
                "C. Ferrie",
                "D. Cory"
            ],
            "title": "Quantum Hamiltonian learning using imperfect quantum resources",
            "venue": "Phys. Rev. A 89,",
            "year": 2014
        },
        {
            "authors": [
                "A. Shabani",
                "M. Mohseni",
                "S. Lloyd",
                "R.L. Kosut",
                "H. Rabitz"
            ],
            "title": "Estimation of many-body quantum Hamiltonians via compressive sensing",
            "venue": "Phys. Rev. A",
            "year": 2011
        },
        {
            "authors": [
                "X.L. Qi",
                "D. Ranard"
            ],
            "title": "Determining a local Hamiltonian from a single eigenstate",
            "venue": "Quantum 3,",
            "year": 2019
        },
        {
            "authors": [
                "E. Chertkov",
                "B.K. Clark"
            ],
            "title": "Computational inverse method for constructing spaces of quantum models from wave functions",
            "venue": "Phys. Rev. X",
            "year": 2018
        },
        {
            "authors": [
                "E. Bairey",
                "I. Arad",
                "N.H. Lindner"
            ],
            "title": "Learning a local Hamiltonian from local measurements",
            "venue": "Phys. Rev. Lett. 122,",
            "year": 2019
        },
        {
            "authors": [
                "A. Anurag",
                "A. Srinivasan",
                "K. Tomotaka",
                "S. Mehdi"
            ],
            "title": "Sampleefficient learning of interacting quantum systems",
            "venue": "Nat. Phys. 17,",
            "year": 2021
        },
        {
            "authors": [
                "L. Zhi",
                "Z. Liujun",
                "H.H. Timothy"
            ],
            "title": "Hamiltonian tomography via quantum quench",
            "venue": "Phys. Rev. Let",
            "year": 2020
        },
        {
            "authors": [
                "J. Haah",
                "R. Kothari",
                "E. Tang"
            ],
            "title": "Optimal learning of quantum Hamiltonians from high-temperature",
            "venue": "Gibbs states. arXiv:2108",
            "year": 2021
        },
        {
            "authors": [
                "M.P. da Silva",
                "O. Landon-Cardinal",
                "D. Poulin"
            ],
            "title": "Practical characterization of quantum devices without tomography",
            "venue": "Phys. Rev. Lett. 107,",
            "year": 2011
        },
        {
            "authors": [
                "E. Bairey",
                "C. Guo",
                "D. Poletti",
                "N.H. Lindner",
                "I. Arad"
            ],
            "title": "Learning the dynamics of open quantum systems from their steady states",
            "venue": "N. J. Phys. 22,",
            "year": 2020
        },
        {
            "authors": [
                "A. Zubida",
                "E. Yitzhaki",
                "N.H. Lindner",
                "E. Bairey"
            ],
            "title": "Optimal shorttime measurements for Hamiltonian learning",
            "year": 2021
        },
        {
            "authors": [
                "A. Gu",
                "L. Cincio",
                "P.J. Coles"
            ],
            "title": "Practical black box Hamiltonian learning",
            "year": 2022
        },
        {
            "authors": [
                "W. Yu",
                "J. Sun",
                "Z. Han",
                "X. Yuan"
            ],
            "title": "Robust and efficient Hamiltonian learning",
            "venue": "Quantum 7,",
            "year": 2023
        },
        {
            "authors": [
                "D. Rattacaso",
                "G. Passarelli",
                "P. Lucignano"
            ],
            "title": "High-accuracy Hamiltonian learning via delocalized quantum state evolutions.Quantum",
            "year": 2023
        },
        {
            "authors": [
                "K. Rudinger",
                "R. Joynt"
            ],
            "title": "Compressed sensing for Hamiltonian reconstruction",
            "venue": "Phys. Rev. A 92,",
            "year": 2015
        },
        {
            "authors": [
                "C. Rouze",
                "D. Stilck Fran\u00e7a"
            ],
            "title": "Learning quantum many-body systems from a few copies",
            "year": 2021
        },
        {
            "authors": [
                "D. Kane",
                "S. Karmalkar",
                "E. Price"
            ],
            "title": "Robust polynomial regression up to the information theoretic limit",
            "venue": "In Proc. IEEE 58th Annual Symposium on Foundations of Computer Science (FOCS),",
            "year": 2017
        },
        {
            "authors": [
                "J. Kunjummen",
                "M.C. Tran",
                "D. Carney",
                "J.M. Taylor"
            ],
            "title": "Shadow process tomography of quantum channels",
            "venue": "Physical Review A",
            "year": 2023
        },
        {
            "authors": [
                "R. Levy",
                "D. Luo",
                "B.K. Clark"
            ],
            "title": "Classical shadows for quantum process tomography on near-term quantum computers",
            "year": 2021
        },
        {
            "authors": [
                "Wolf",
                "M.M. Quantum channels",
                "operations"
            ],
            "title": "guided tour",
            "venue": "Lecture notes are available at https://www-m5.ma.tum.de/foswiki/pubM, 5,",
            "year": 2012
        },
        {
            "authors": [
                "Huang",
                "H.-Y",
                "R. Kueng",
                "J. Preskill"
            ],
            "title": "Predictingmany properties of a quantum system from very few measurements",
            "venue": "Nat. Phys. 16,",
            "year": 2020
        },
        {
            "authors": [
                "E.H. Lieb",
                "D.W. Robinson"
            ],
            "title": "The finite group velocity of quantum spin systems",
            "venue": "Commun. Math. Phys 28,",
            "year": 1972
        },
        {
            "authors": [
                "D. Poulin"
            ],
            "title": "Lieb-Robinson bound and locality for general Markovian quantum dynamics",
            "venue": "Phys. Rev. Let",
            "year": 2010
        },
        {
            "authors": [
                "M. Kliesch",
                "C. Gogolin",
                "Eisert",
                "J. Lieb-Robinson bounds",
                "the simulation of time-evolution of local observables in lattice systems. In Many-Electron Approaches in Physics",
                "Chemistry",
                "Mathematics (Series Title"
            ],
            "title": "Mathematical Physics Studies) (eds Bach V",
            "venue": "& Site L. D.) 301\u2013318",
            "year": 2014
        },
        {
            "authors": [
                "T. Kuwahara",
                "K. Saito"
            ],
            "title": "Strictly linear light cones in long-range interacting systems of arbitrary dimensions",
            "venue": "Phys. Rev. X 10,",
            "year": 2020
        },
        {
            "authors": [
                "F Yan"
            ],
            "title": "Tunable coupling scheme for implementing highfidelity two-qubit gates",
            "venue": "Phys. Rev. Appl. 10,",
            "year": 2018
        },
        {
            "authors": [
                "Y Sung"
            ],
            "title": "Realization of high-fidelity cz and zz-free iswap gates with a tunable coupler",
            "venue": "Phys. Rev. X 11,",
            "year": 2021
        },
        {
            "authors": [
                "L. Vandenberghe",
                "S. Boyd"
            ],
            "title": "Convex Optimization (Cambridge",
            "year": 2004
        }
    ],
    "sections": [
        {
            "text": "Efficient and robust estimation of many-qubit Hamiltonians\nDaniel Stilck Fran\u00e7a 1,2 , Liubov A. Markovich3,4, V. V. Dobrovitski3, Albert H. Werner 1,5 & Johannes Borregaard3,6\nCharacterizing the interactions and dynamics of quantummechanical systems is an essential task in developing quantum technologies. We propose an efficient protocol based on the estimation of the time-derivatives of few qubit observables using polynomial interpolation for characterizing the underlying Hamiltonian dynamics and Markovian noise of a multi-qubit device. For finite range dynamics, our protocol exponentially relaxes the necessary timeresolution of the measurements and quadratically reduces the overall sample complexity compared to previous approaches. Furthermore, we show that our protocol can characterize the dynamics of systemswith algebraically decaying interactions. The implementation of the protocol requires only the preparation of product states and single-qubit measurements. Furthermore, we improve a shadow tomography method for quantum channels that is of independent interest and discuss the robustness of the protocol to various errors. This protocol can be used to parallelize the learning of theHamiltonian, rendering it applicable for the characterization of both current and future quantum devices.\nLarge quantum devices consisting of tens to hundreds of qubits have been realized across various hardware architectures1\u20134 representing a significant step towards the realization of quantum computers and simulators with the potential to solve outstanding problems intractable for classical computers5,6. However, continued progress towards this goal requires careful characterization of the underlying Hamiltonians and dissipative dynamics of the hardware to mitigate errors and engineer the desired dynamics. The exponential growth of the dimension of the state space of a quantum device with the number of qubits renders this an outstanding challenge broadly referred to as the Hamiltonian learning problem7\u201335.\nTo tackle this challenge, previous approaches make strong assumptions such as the existence of a trusted quantum simulator capable of simulating the unknownHamiltonian20,21 or the capability of preparing particular states of the Hamiltonian such as steady states\nand Gibbs states23,25,26,29,36,37, whichmay be difficult for realistic devices subject to various decoherence mechanisms.\nAlternatively, several works30\u201332 are built on the observation that a Master equation describes the evolution of any system governed by Markoviandynamics. Through this, one obtains a simple linear relation between time derivatives of expectation values and the parameters of theHamiltonian, jumpoperators and decay rates (jointly referred to as the parameters of the Lindbladian L) governing the system. Furthermore, for finite range interactions, these approaches can estimate the parameters of the Lindbladian to a given precision from a number of samples that is independent of the system\u2019s size30\u201332.\nA significant drawback of these approaches is that the time derivatives are estimated using finite difference methods. Obtaining a good precision thus requires high time resolution, which is experimentally challenging given the finite operation time of gates and\nReceived: 19 November 2022\nAccepted: 24 November 2023\nCheck for updates\n1QMATH, Department of Mathematical Sciences, University of Copenhagen, Universitetsparken 5, 2100 Copenhagen, Denmark. 2Univ Lyon, ENS Lyon, UCBL, CNRS, Inria, LIP, F-69342, LyonCedex 07, France. 3QuTech and Kavli Institute of Nanoscience, Delft University of Technology, Delft 2628CJ, TheNetherlands. 4Instituut-Lorentz, Universiteit Leiden, P.O. Box 9506, Leiden 2300 RA, The Netherlands. 5NBIA, Niels Bohr Institute, University of Copenhagen, Blegdamsvej 17, 2100 Copenhagen, Denmark. 6Department of Physics, Harvard University, Cambridge, MA 02138, USA. e-mail: daniel.stilck_franca@ens-lyon.fr\nNature Communications | (2024) 15:311 1\n12 34\n56 78\n9 0 () :,;\n12 34\n56 78\n9 0 () :,;\nmeasurements. To estimate a Lindbladian parameter up to an additive error \u03f5, the system has to be probed at times O\u00f0\u03f5\u00de apart and expectation values of observables have to be estimated up to a precision of O\u00f0\u03f52\u00de, which translates to an overall O\u00f0\u03f5 4\u00de sample complexity to estimate each parameter.\nIn this article, we propose a protocol that alleviates these daunting experimental requirements. Our protocol requires only a time resolution of O\u00f0polylog\u00f0\u03f5 1\u00de\u00de representing an exponential improvement compared to previous protocols and gives an overall sample complexity to recover all parameters of a k-local n qubit Lindbladian up to precision \u03f5 of O\u00f09k\u03f5 2polylog\u00f0n,\u03f5 1\u00de\u00de. We obtain this by estimating time derivatives using multiple temporal sampling points and robust polynomial interpolation38. Furthermore, we show how to use shadow process tomography methods to estimate multiple parameters in parallel. In particular, we improve the results of refs. 39, 40 in extending the framework of classical shadows to processes and Pauli matrices with an alternative proof, a result that is of independent interest. We also extend our analysis to long-range (algebraically decaying) interactions in the systems, obtaining the first results for such systems to the best of our knowledge. The necessary operations for our protocol are measurements in the Pauli bases on time-evolved product states consisting of Pauli eigenstates. These minimal requirements make our protocol feasible for characterization of both current and future quantum devices."
        },
        {
            "heading": "Results",
            "text": "In order to use our protocol for an efficient characterization of a quantum device, two assumptions should be fulfilled: 1. The quantum device implements an (unknown) Markovian\nquantum evolution on n qubits described by a time-independent Lindbladian, L. 2. We assume knowledge of the general structure of the interaction graph of the device i.e., which qubits are coupled to each other. Importantly, no assumptions are made regarding the couplings\u2019 exact form.\nThe first assumption ensures that the evolution of a general observable, O(t) is described by the Master equation, i.e., d dt O\u00f0t\u00de=L\u00f0O\u00f0t\u00de\u00de: We note that the Lindbladian captures both the Hamiltonian evolution and the dissipative dynamics of the device.\nThe second assumption bounds the size of the estimation task. It corresponds to making some assumptions about the locality of the generator, as evolutions without some locality assumptions have exponentially many parameters. However, having prior knowledge that, e.g., nearest neighbor couplings dominate in the device, makes the estimation task tractable. For now, we will assume that we know which qubits interact. Later, we will show that a bound on the support of each interaction and some technical assumptions on the evolution suffice to also learn the interaction graph from data.\nUsing the knowledge of the interaction graph, one can expand the Lindbladian in anoperator basis, {Pi} constructed fromtensor products of single-qubit Pauli matrices and the identity41:\nL\u00f0O\u00de= X\nai\u00bdPi,\u03c1\n+ X\nDi,j P y i OPj 1 2 fPyj Pi,Og \u00f01\u00de Such an expansion is always possible since this basis amounts to a Hilbert-Schmidt orthogonal set of Hermitian operators spanning the entire vector space. Note that the coefficient matrix Di,j needs to be positive for it to form a valid Lindbladian. Estimating the set of expansion coefficients {ai,Di,j} gives an estimation of L and thus a full characterization of the system.\nIt is well known that theMaster equation for the timederivative of the expectation value of a local observable O at time t =0 for a given initial state \u03c1 of the system gives us a linear equation for the expansion coefficients30\u201332. We use this to estimate the expansion coefficients going through three stages of classical pre-processing, quantum processing, and classical post-processing (see Fig. 1)."
        },
        {
            "heading": "Classical pre-processing",
            "text": "After expanding L in an operator basis, the following steps are performed. 1. Find a suitable complete set, {(\u03c1j,Oi)} ofmulti-qubitproduct states\n(\u03c1j) and observables (Oi) for which the Master equation involves only a few selected expansion parameters of the Lindbladian for each element of the set. The set is complete in the sense that all expansion coefficients can be found by solving the Master equations for all elements in the set. As we show below, such a set can readily be found by considering initial states where only a few qubits are initialized as different eigenstates of the Pauli matriceswhile the remainingqubits are prepared in themaximally mixed state I/2. 2. Calculate the expectation values appearing on the right-hand side of theMaster equations dd t tr\u00bd\u03c1jOi\u00f0t\u00de = tr\u00bd\u03c1jL\u00f0Oi\u00de for all elements in the set {(\u03c1j,Oi)} in terms of the expansion coefficients. Since the initial states and the observables are products, this can be done efficiently."
        },
        {
            "heading": "Quantum processing",
            "text": "In order to solve for the expansion coefficients, we also need the values of the time-derivatives appearing on the left-hand side of the Master equations, i.e., dd t tr\u00bd\u03c1jOi . These can be estimated using the quantum device. The naive approach is the following: 1. The quantumdevice is prepared in initial state \u03c1j and evolved for a\ntime tk 2 ft0,t1, . . . ,tmaxg after which the observable Oi is measured. 2. The above procedure is repeated for each element in the set {(\u03c1j,Oi)} for all evolution times tk to obtain estimates of hOi\u00f0tk\u00deij = tr\u00bd\u03c1j\u00f0tk\u00deOi where \u03c1j(tk) is the state of the system having evolved for time tk from the initial state \u03c1j. We note that the single qubit mixed states can be simulated by sampling eigenstates of the Pauli matrices at random.For this naive approach, the sample complexity increases linearly with the size of the set {(\u03c1j,Oi)} since the expectation values hOi\u00f0tk\u00deij are estimated sequentially. However,we alsopropose a variation of the classical shadowsprotocol of ref. 42 for process tomography that can reduce this to a logarithmic scaling. In essence,we canobtain estimates of all elements in the set {(\u03c1j,Oi)} in parallel. This is done by the following steps: 1. Every qubit is prepared in a random Pauli matrix eigenstate and the system is evolved for a time tk after which each qubit is measured in a random single-qubit Pauli basis. 2. The above procedure is repeatedO\u00f03w1 +w2\u03f5 2 log\u00f0K\u00de\u00de times set by the required precision, \u03f5, of the estimates, the size, K, of the set {(\u03c1j,Oi)} and the weights (i.e., maximum number of sites differing from identity) of \u03c1j (w1) and Oi (w2). The whole procedure is repeated for all times tk 2 ft0,t1, . . . ,tmaxg.From the measurement statistics of the above procedure, it is possible to obtain accurate estimates of all hOi\u00f0tk\u00deij and thus a parallel estimation is possible. We refer to Sec. V and the Supplementary Note for more details and proof of the method. Whether to use the sequential approach or the parallel approach depends on the number of qubits and the weight of the states and observables in the set {(\u03c1j,Oi)}. For few qubit processors, the sequential protocol may require fewest samples, however for local Hamiltonians on a lattice, the logarithmic scaling in system size of the parallel method will quickly be advantageous for larger\nNature Communications | (2024) 15:311 2\nprocessors. Importantly, both methods only require the preparation of single qubit Pauli states and measurements in single-qubit Pauli bases."
        },
        {
            "heading": "Classical post-processing",
            "text": "The final part of the characterization involves estimating dd t tr\u00bd\u03c1jOi\u00f0t\u00de from the experimentally obtained time traceof hOi\u00f0tk\u00deij and solving for the expansion coefficients {ai}. This involves 1. Fit the time trace of hOi\u00f0tk\u00deij with a low-degree polynomial in the\ntime, pi,j(t) and estimate dd t tr\u00bd\u03c1jOi as d d t pi,j\u00f0t\u00dejt =0. This is done for\neach element in the set {(\u03c1j,Oi)}. 2. Solve the set of linear equations from the Master equations\nd d t tr\u00bd\u03c1jOi = tr\u00bd\u03c1jL\u00f0Oi\u00de with respect to the expansion coefficients. This is possible since dd t tr\u00bd\u03c1jOi has been estimated from the polynomial fits and all expectation values appearing in tr\u00bd\u03c1jL\u00f0Oi\u00de\nhave been calculated leaving the expansion coefficients as the only unknown parameters.\nFollowing the steps above, a complete characterization of the underlying Hamiltonian and dissipative dynamics of the quantum device as given by the Lindbladian is obtained. The two key steps of the protocol are the choice of the set {(\u03c1j,Oi)} and the polynomial interpolation used to obtain estimates of the time derivatives. Below, we outline the details of both steps and provide rigorous guarantees on theprecisionof theprotocol. Importantly,we show that Lieb-Robinson bounds on the spread of correlations in the system can be used to ensure robust polynomial fitting of the time traces of expectation values allowing for an exponential relaxation of the temporal resolution compared to finite difference methods rendering the protocol feasible for near-term quantum devices.\nChoosing the set of initial states and observables. The first step in the classical pre-processing is to expand L in an operator basis\nFig. 1 | Sketch of the proposed protocol to estimate an unknown Lindbladian, L, of a multi-qubit device. In the first step of classical pre-processing, the interaction graph between qubits is identified from the physical connectivity of the device. Then the unknown Lindbladian is written in a general form using an operator basis of Pauli strings, {Pi} and a suitable set of initial states and observables, {(\u03c1j,Oi)} is chosen. In the second step of quantum processing, a time trace\n(expectation value) of eachelement of the set is obtained from thepreparation and evolution of single qubit Pauli eigenstates on the quantum device followed by measurements in single qubit Pauli basis. In the last step of classical post-processing, each time trace is fitted to a low-degree polynomial to estimate the derivative of the observable. From these, an estimate of the Lindbladian, Lest , is obtained from the Master equation.\nNature Communications | (2024) 15:311 3\nconstructed from tensor products of single-qubit Pauli matrices and the identity. The right-hand side (rhs) of the Master equation d d t tr\u00bd\u03c1jOi\u00f0t\u00de = tr\u00bd\u03c1jL\u00f0Oi\u00de can be expanded as a sum of single Pauli matrices and their products. Our goal is to isolate the unknown expansion coefficients. To this end, we consider an initial state of the form\n\u03c1\u00f0i,j\u00dek,l = I + \u03c3\u00f0i\u00de k 2\nI + \u03c3\u00f0j\u00de l\n2 \u03c1n 2, \u00f02\u00de\nwhere k, l = x, y, z. Thus, the i\u2019th and j\u2019th qubit are prepared in eigenstates of the Pauli matrices \u03c3k and \u03c3l while the state of the remaining n \u2212 2 qubits, \u03c1n\u22122, is assumed to be the maximally mixed state.\nFor a state of the form in Eq. (2) the rhs of theMaster equation (see above) can be simplified greatly depending on the choice of the observableO. This is due to the properties of the Paulimatrices namely that they have vanishing trace and that\n\u03c3k\u03c3l = \u03b4kl I + i\u03b5klp\u03c3p, \u00f03\u00de\nwhere \u03b4kl is the Kroenecker delta function and \u03b5klp is the Levi-Civita symbol. As we show explicitly in the Supplementary Note, if a single qubit Pauli observable, O= \u03c3\u00f0i\u00del , is chosen, then only the single qubit terms of the rhs of the Master equation involving the i\u2019th qubit will have non-vanishing trace and, using the relation in Eq. (3), the different single qubit Pauli expansion coefficients (the coefficients of terms in the expansion that only involves single qubit Pauli matrices) can be isolated.\nAfter isolating the single qubit expansion coefficients, the coefficients related to two-qubit Pauli terms (\u03c3\u00f0i\u00dei \u03c3\u00f0 j\u00dej ) can be isolated by choosing observables of the form O= \u03c3\u00f0i\u00dei \u03c3\u00f0 j\u00dej in a similar manner. This procedure can be iterated to isolate higher order expansion coefficients by considering observables involving more and and more qubits.\nIn Supplementary Note, we provide a detailed derivation of how all expansion parameters can be isolated for a general Hamiltonian with terms coupling between two and k qubits and arbitrary single qubit dissipation terms. We note that already for two qubit dissipation terms, deriving linear combinations of initial states and expectation values that allow us to isolate different parameters is quite cumbersome and we do not do this explicitly. However, from a numerical point of view, this is a trivial task. Indeed, as remarkedbefore, eachpair of Pauli strings gives us access to a linear equation for the different evolution parameters.\nAfter collecting enough equations to ensure that the linear system is invertible, the precision with which we need to estimate each expectation value to ensure a reliable estimation of the parameters is controlled by the condition number of the matrix describing the system of linear equations. As both estimating the condition number and solving the linear system can be done efficiently, we conclude that estimating dissipative terms acting on a constant number of qubits does not pose a significant challenge from a numerical perspective.\nRobust polynomial interpolation. As described above, a key step in our learning algorithm is to obtain information about the timederivatives of observables at t =0. For this, we rely on robust polynomial interpolation. Accordingly, based on expectation values hOi\u00f0tk\u00deij for a set of times tkwewant to extract a polynomial pi,j(t) such that we can estimate dd t tr\u00bd\u03c1jOi as d d t pi,j\u00f0t\u00dejt =0. For this approach to work, we have to be able to control the degree of the polynomial pi,j(t) in order to give an upper bound on the number of sampling points tk for which we will have to determine hOi\u00f0tk\u00deij experimentally. In the\nfollowing, we briefly outline how such a guarantee on the degree of pi,j(t) can be obtained and refer to the methods section for a more detailed proof.\nOur argument proceeds in two steps: establishing that local expectation values are well approximated by low-degree polynomials and then showing how to robustly extract the derivative of the polynomial from this information. Before we give an overview of the ideas, wewill also need to introduce some notation to deal with Lindbladians acting on different parts of the system. We will denote by \u039b the whole systemof qubits and for some subset B\u2282\u039b of qubits, we denote byLB, the generator truncated to those qubits.\nThefirst step of our proof is to establish that the expectation value \u2329O(t)\u232a of a local observable O that evolves under a Lindbladian LB restricted to some sub-region B up to some time tmax, can indeed be approximated up to error \u03b5 by a degree-d polynomial, where d depends linearly on the size of B, tmax and log\u00f0\u03b5 1\u00de.\nFor the second step of our argument, it remains to show under which circumstances, we can restrict the evolution of the observable O, thatwe identified in theprevious step, to a local generator. Themain insight here is that forfinite range (or sufficiently quickly fastdecaying) interactions, the dynamics of any local observable exhibits an effective light cone quantified by a Lieb-Robinson bound (LRB)43\u201347. The LRbound, in turn, allows us to restrict the Lindbladian on the full system to a generator coupling only systems in the vicinity of the support ofO, where the size of this shielding region only grows linearly with tmax.\nBringing these two arguments together, we can first employ the LR-bound to restrict the dynamics to a sub-region around the support of the observable, O, and then approximate the corresponding evolution on that finite region up to error \u03b5 by a polynomial of degree O poly\u00f0tmax, log\u00f0\u03f5 1\u00de\u00de\n. Now, making use of the techniques from ref. 38, we can extract the first derivative of this polynomial from measurements at O polylog\u00f0\u03f5 1\u00de different times tk. Indeed, in that work, the authors show how to perform polynomial interpolation reliably only given approximations of the values and even under the presence of outliers.\nRobustness of the protocol to experimental errors In the previous sections, we assumed that we can prepare Pauli eigenstates andmeasure in Pauli eigenbases and didnot consider state preparation and measurement (SPAM) errors. Furthermore, we assumed that the dynamics is described exactly be a generator that is local. Such an idealized scenario rarely comes up in practice and it is important to develop protocols that also work when these conditions are only met approximately. Here, we will provide the main arguments showing that our protocol is indeed robust to such imperfections. We refer to Supplementary Note for the more detailed technical derivations and statements.\nFirst, we consider the setting where the SPAM errors are wellcharacterized and independent of the basis we prepare and measure. In this case, it is possible to adapt the protocol to incorporate this information without changing its performance significantly. For instance, if the SPAM errors are described by local depolarizing noise with depolarizing probability p, we can still recover 2\u2212 local Hamiltonians with single qubit noise with a O\u00f0\u00f01 p\u00de 4\u00de sampling overhead when compared to the noiseless case. In particular, this only depends on the local noise rate. We then show that this is the case more generally: if the SPAM errors are not characterized well or are highly dependent on the particular state we are preparing or the basis we are measuring, then once again the effect of SPAM errors will be independent of the system\u2019s size and only depend on the precisionwewish to obtain.\nBesides SPAM errors, our protocol is also robust to perturbations of the generators, even nonlocal ones.More precisely, assume that the true generator is of the form L=L0 +\u0394, where L is a Lindbladian that\nNature Communications | (2024) 15:311 4\nsatisfies a LR-bound and \u0394 is an arbitrary, potentially global perturbation. A naive bound would imply that for short times, the expectation value of this perturbed evolution could be up to t\u2225\u0394\u2225\u221e\u2192\u221e away from the unperturbed value, where k \u0394k1!1 = sup\nkXk1 \u2264 1 k \u0394\u00f0X \u00dek1.\nHowever, we show that only the effect of \u0394 on few-qubit observables contributes to the bound. A precise statement is given in Thm. 9.1. of the Supplementary Note 9. As an illustrative example, assume that\u0394 is a small all-to-all coupling between all pairs of qubits of order \u03c4, e.g.,\n\u0394\u00f0X \u00de= \u03c4 Pn i,j = 1,i \u2260 j i\u00bd\u03c3\u00f0i\u00dex \u03c3\u00f0j\u00dex ,X : \u00f04\u00de\nClearly, such an evolution does not satisfy a LR-bound and k \u0394k1!1 =O\u00f0\u03c4n2\u00de. However, we show that under such a perturbation, the expectation value is only perturbed byO\u00f0t\u03c4n\u00de, which corresponds to the local effect of this global perturbation. To show this, we once again resort to LR bounds and the fact that we only need to measure local observables. Taken together, these results show thatour protocol is robust to both SPAM noise and deviations from the assumptions we impose on the generators.\nLearning the structure of the interactions. So far, we have also assumed that we have knowledge of the interaction graph. However, an astute reader might have remarked that we do not require this explicit knowledge for our protocol to work: indeed, we just use it to decide which parameters to estimate and need to restrict the possible interaction graphs to have an LR bound for the evolution. Thus, a brute-force approach to learning the interaction structure also follows from our results if we wish to estimate all k-body couplings of strength at least \u03b7: we just estimate all k body-couplings up to a precision \u03b7/4 and discard all of those that we see are smaller than 34\u03b7. This can be done with a number of samples that scales like O\u00f09k\u03b7 2polylog\u00f0\u03b7 1\u00de log\u00f0n\u00de\u00de."
        },
        {
            "heading": "Numerical examples",
            "text": "To investigate the performance of our protocol for experimentally relevant parameters, we performed numerical simulations of a multiqubit superconducting device. We consider a system with tunable couplers similar to the Google Sycamore chip1. This design relies on a cancellation of the next-next-nearest coupling between two qubits through the direct coupling with a coupler48,49. We consider a generic system consisting of a 2D grid of qubits with exchange coupling between nearest neighbors. The dynamics are described through a Lindblad equation with the effective two-qubit Hamiltonian for each neighboring qubit pair (i, j)48,49\nHij = P k = i,j 1 2 ~\u03c9k\u03c3 \u00f0k\u00de z + gigj \u0394ij + gij h i \u00f0\u03c3\u00f0i\u00de+ \u03c3\u00f0j\u00de + \u03c3\u00f0i\u00de \u03c3\u00f0j\u00de+ \u00de \u00f05\u00de\nfor i \u2260 j = 1,\u2026, n and a dissipation term acting on the i\u2019th qubit and having jump operators \u03c3\u00f0i\u00de , \u03c3 \u00f0i\u00de + (generalized amplitude damping) and \u03c3\u00f0k\u00dez (pure dephasing). Here ~\u03c9k =\u03c9k + g2 k\n\u0394k is the Lamb-shifted qubit\nfrequency, gi is the coupling between the i\u2019th qubit and the coupler, and gij is the direct two-qubit coupling. We have assumed that \u0394k =\u03c9k \u2212\u03c9c < 0 where \u03c9c (\u03c9k) is the frequency of the coupler (k\u2019th qubit) and have defined 1/\u0394ij = (1/\u0394i + 1/\u0394j)/2. By adjusting the frequencies of the coupler and the qubits, the effective qubit-qubit interaction can be canceled up to experimental precision. Typical qubit frequencies are around 5 \u2212 6 GHz1), while \u0394k ~\u22121 GHz, gij ~ 10\u221220MHz, and gj ~ 100MHz48,49. In our simulation, we assume that all qubit frequencies and couplings havebeen characterizedup to aprecisionof 100 kHz using standard characterization techniques1 and consequently, that all couplers have been tuned off with the same precision i.e.,\ngigj \u0394ij + gij \u223c 100 kHz. Considering a layout of 16 qubits (see below for\nthe interaction graph), we randomly sample all qubit frequencies and qubit-qubit interactions according to Gaussian distributions with zero mean and standard deviation of 100 kHz.\nIn addition to the Hamiltonian evolution, we also include dissipative dynamics in our numerical simulation. We include quasi-static random frequency shifts of the qubits leading to effective dephasing with a characteristic timescale of T *2 \u223c 150\u03bcs as well as pure dephasing resulting in a transverse relaxation on a timescale T2 ~ 60\u03bcs representing state of the art coherence times1,49. Finally, we include longitudinal relaxation of the qubits through an amplitude damping channel on the time scale of T1 ~ 60\u03bcs. We refer to Supplementary Note 2 for a more detailed discussion and Table III for the sampled parameters of our simulation.\nIn Fig. 2, we plot the average estimation error as a function of the temporal resolution set by the value of the initial time step, t0. For this plot, we only included the Hamiltonian evolution in the numerical simulation together with quasi-static random frequency shifts of the qubits. This was to lower the run time of the simulation allowing us to investigate the performance for a broad range of initial times. We assumed the total run time of the experiment was fixed such that t0 \u00d7 S is constant, where S is the number of samples. From the figure, we clearly see the improved scaling of our protocol of the estimationerror with the time-step size compared to using a finite difference method30\u201332. Besides already performing better at the time resolution for moderate values of the initial time, we see that after a threshold initial time around 10\u22120.7, the performance is not limited by the initial time, only the shot noise. In contrast, the finite differencemethod still requires smaller initial times to improve on the error with the same shot noise.\nWe also investigated the robustnessof ourmethodwith respect to shot-noise for a fixed time resolution. For these simulations, we again only included the Hamiltonian evolution together with quasi-static random frequency shifts of the qubits to have a practical run time of the simulation. From Fig. 3, we see that for a fixed time resolution of 30 ns our protocol results in an average estimation error that improves\nNature Communications | (2024) 15:311 5\nlinearly with the shot-noise down to an error below 10\u22124. This is in contrast to finite difference methods, where the estimation error plateaus around 10\u22123 since it becomes limited by the time resolution. This is a clear effect of the exponential improvement of our protocol w.r.t. the time resolution compared to finite difference methods.\nFinally, we performed a numerical simulation that included the pure dephasing and amplitude damping noise as described above and estimated the \u03c3X\u03c3X couplings between the qubits. As shown in Fig. 4, we obtain reliable estimates of all 22 couplings demonstrating how our method allows the estimation of specific terms in the Hamiltonian despite the dynamics being governed by the full (dissipative) Lindbladian. For simplicity, we did not explicitly estimate the single qubit Hamiltonian parameters and the Lindbladian decay rates.\nFor all estimations above, we fitted to degrees 1\u22127 and picked the one with the smallest average error on the sampled points. In Supplementary Note 6, we give explicit rigorous bounds on how to pick the parameters like the degree for a given desired precision, but we believe that a heuristic approach like the one pursued in the numerics performs well in practice: as long as the interpolating polynomial approximates well the observed points and new points we did not fit to, the degree should be adequate. We note that, although the robust interpolation methods of ref. 38, in principle, require random times, we performed numerical experiments with deterministic times on systems with 16 qubits."
        },
        {
            "heading": "Discussion",
            "text": "In conclusion, we have proposed a Hamiltonian learning protocol based on robust polynomial interpolation that has rigorous guarantees on the estimation error. Our protocol offers an exponential reduction in the required temporal resolution of the measurements compared to previous methods and a quadratic\nreduction in the overall sampling complexity for finite-range interactions. Our protocol only requires the preparation of single qubit states and single qubit measurements in the Pauli bases and is robust to various imperfections such as SPAM errors and Hamiltonian perturbations. This makes it suitable for the characterization of both near-term and future quantum devices.\nFurthermore, the recovery of multiple parameters can be highly parallelized by resorting to a variation of classical shadows to quantum channels we improve here.\nOur method allows for the characterization of a general local Markovian evolution consisting of a unitary Hamiltonian part and a dissipative part. While we have only explicitly considered single-qubit dissipation here, we believe that our protocol is also valid for general multi-qubit dissipation as outlined above but leave the explicit analysis of this to future work. We have also analyzed the performance of our protocol for algebraically decaying interactions whichwe believe to be the first results for Hamiltonian learning of such systems. The convergence of our method can be ensured for interactions decaying faster than the dimension of the system. We note, however, that improved bounds on the locality of such systems might improve this result in the future."
        },
        {
            "heading": "Methods",
            "text": "Here, we detail and formalize our results regarding the estimation error guarantees of our protocol. In particular, we detail the use of Lieb-Robinson bounds on the spread of correlations in the system to bound the error. Furthermore, we outline the shadow tomography method for the parallelization of the measurements."
        },
        {
            "heading": "Derivative estimation",
            "text": "Define f \u00f0t\u00de= tr etL\u00f0O\u00de\u03c1 and LB to be the Lindbladian truncated to a subregion B of the interaction graph. Our protocol consists of first estimating f(ti) up to anerrorO\u00f0\u03f5\u00de for randomtimes t1,\u2026, tm. The curve of f(t) is then fitted to a low-degree polynomial p, and p0\u00f00\u00de is taken as an estimate for the derivative f 0\u00f00\u00de= tr L\u00f0O\u00de\u03c1\u00bd . Below we prove the accuracy and robustness of this method. The first step is Theorem 1, which establishes under what conditions f(t) is indeed wellapproximated by a low-degree polynomial.\nTheorem 1. Let L\u039b be a local Lindbladian on a D-dimensional lattice \u039b. Moreover, let tmax,\u03f5>0 and OY be a 2-qubit observable, supported on some regionY\u2208\u039b, such that\u2225OY\u2225 \u2264 1, holds. Then there is a polynomial p of degree\nd =O poly\u00f0tmax, log\u00f0\u03f5 1\u00de\u00de , \u00f06\u00de\nsuch that for all 0 \u2264 t \u2264 tmax:\ntr etL\u039b \u00f0OY \u00de\u03c1 p\u00f0t\u00de \u2264 \u03f5, \u00f07\u00de\nand p0\u00f00\u00de= tr L\u039b\u00f0OY \u00de\u03c1\n, holds. The main technical tool required for the proof are LRB43\u201347, which ascertain that the dynamics of local observables under a time evolution with a local Lindbladian have an effective lightcone. More precisely, we need that for regions Y\u2282B we have\nk \u00f0etLB etL\u039b \u00de\u00f0OY \u00de k \u2264 c1 exp\u00f0 \u03bcdist\u00f0Y ,\u039bnfBg\u00de\u00de\u00f0evt 1\u00de,\n\u00f08\u00de\nto hold for constants c1, \u03bc and v, where dist() is the distance in the graph.\nFrom the LRB we can show that the dynamics is wellapproximated by a low-degree polynomial. We leave the details of the proof to Supplementary Note 3 and only discuss the main steps here. The general idea of going from the LRB to the low-degree\nNature Communications | (2024) 15:311 6\nFig. 4 | Error in the recovery of \u03c3X\u03c3X couplings of a quantum system with a geometry similar to the Sycamore processor using numerical derivatives and interpolation. Note that while we only plot the estimation of the Hamiltonian couplings, the numerical simulation included the full Lindbladian including both dephasing due to quasi-static random frequency shifts of the qubits, pure\ndephasing and amplitude damping noise. The initial time for each coupling was 0.1\u03bcs in the simulation. Note that interpolation consistently outperforms numerical derivatives, sometimes by several orders of magnitude. We chose the time steps and the number of samples to compare both methods, as in Fig. 2.\nNature Communications | (2024) 15:311 7\npolynomial is to truncate the Taylor series of the evolution under LB for B large enough and take that as the approximating polynomial. As the derivatives of the evolution underLB only scale with the size of the region B, this allows us to show that the Taylor series converges quickly. To simplify the presentationwedid not give explicit numerical constants in the bounds, but in Section A of the Supplementary Note 7 we explicitly determine the constants for the polynomial approximation.\nNow that we have concluded that the expectation value is wellapproximatedby a small degreepolynomial,we continue to show thatwe can reliably extract the derivative from approximations of the expectation values for different t. This is formally stated in the following theorem.\nTheorem 2. Let L be a Lindbladian on a D-dimensional regular lattice. Suppose we can measure the expectation value of two-body Pauli observables on Pauli eigenstates in the time interval \u00bdt0,tmax under L for t0 as\nt 10 =O polylog\u00f0\u03f5 1\u00de \u00f09\u00de\nand tmax = 2 + t0. Then, measuring the expectation values at\nm=O polylog\u00f0\u03f5 1\u00de \u00f010\u00de random times up to precisionO\u00f0\u03f5=polylog\u00f0\u03f5 1\u00de\u00de, is sufficient to obtain an estimate of the Lindbladian coefficients a\u0302i of ai satisfying\na\u0302i ai = \u03f5: \u00f011\u00de\nThis yields a total sample complexity of S=O \u03f5 2polylog\u00f0\u03f5 1\u00de . Importantly, Theorem 2 bypasses both requiring small initial times and O\u00f0\u03f5 4\u00de sample complexities. To go from Thm. 1 to Thm. 2 we first need to establish that we can robustly infer an approximation of p from finite measurement data subject to shot noise. Subsequently, we need to show that it will also allow us to reliably estimate p0\u00f00\u00de. Let us start with approximating p."
        },
        {
            "heading": "Robust polynomial interpolation",
            "text": "We will resort to the robust polynomial interpolation methods of38 to show Thm. 2. We review their methods in more detail in Supplementary Note 6. In our setting, the randomly sampled points xi,i 2 1,m correspond to different times 2 \u00bdt0,tmax and the yi 2 R to approximations of the expectation value of the evolution at that time. Furthermore, the yi satisfy the promise that there exists a polynomial p of degree d and some \u03c3 >0 such, that\nyi =p\u00f0xi\u00de+wi, jwij\u2264 \u03c3, \u00f012\u00de\nhold, for strictly more than half of the yi. The rest might be outliers. In our setting, the magnitude of \u03c3 corresponds to the amount of shot noise present in the estimates of the expectation values.\nThe authors of38 then show that by sampling m=O\u00f0d log\u00f0d\u00de\u00de points from the Chebyshev measure on \u00bdt0,tmax , a combination of \u21131 and \u2113\u221e regression allows us to find a polynomial p\u0302 of degree d that satisfies:\nmax x2\u00bdt0,tmax\njp\u00f0x\u00de p\u0302\u00f0x\u00dej =O\u00f0\u03c3\u00de: \u00f013\u00de\nAlthough the details of the \u21131 and \u2113\u221e interpolation are more involved and described in the Supplementary Note 4, a rough simplification of the procedure is the following. First, we find a polynomial p1 of degree d that minimizes \u2211i\u2223p1(xi)\u2212 yi\u2223. After finding p1 we compute the polynomial p\u221e that minimizes max\ni jp1\u00f0xi\u00de \u00f0yi p1\u00f0x1\u00de\u00dej. We then\noutput p\u0302=p1 +p1 as our guess polynomial. Note that finding both p1\nand p\u221e can be cast as linear programs and thus can be solved efficiently50.\nBy combining this result with Thm. 1, we robustly extract a polynomial that approximates the curve t 7!tr etL\u00f0OY \u00de\u03c1 up to O\u00f0\u03f5\u00de for t 2 \u00bdt0,tmax . Indeed, we only need to estimate the expectation value f(ti) up to \u03f5 for enough ti and run the polynomial interpolation.\nNote that Eq. (13) only allows us to conclude that p p\u0302 is small. However, we are ultimately interested in the curve\u2019s derivative at t =0, as the derivative contains information about the parameters of the evolution. For arbitrary smooth functions, two functions being close on an interval does not imply that their derivatives are close as well. Fortunately, for polynomials the picture is simpler. By the Thm. 1 one has to estimate thefirst derivative of a polynomial at t = 0but not of the actual function. A classical result from approximation theory, Markov brother\u2019s inequality51, allows us to quantify the deviation of the derivatives given a bound on the degree and a bound like Eq. (13). Putting these observations together, we arrive at Thm. 2. The details of the proof are given in the Supplementary Note 4."
        },
        {
            "heading": "Generalizations of Thm. 2",
            "text": "Wealsogeneralize Thm. 2 in twodirections. First, we extend the results to interactions acting on k qubits instead of two. As long as the noise is constrained to act on one qubit and k =O\u00f01\u00de, this generalization is straightforward. Indeed, we only need to measure an observable that has the same support as the Pauli string and does not commutewith it, as it is then always possible to find a product initial state that isolates the parameter. Generalizing to noise acting on more than one qubit makes it more difficult to isolate the parameters of the evolution as described in the main text. In that case, it then becomes necessary to solve a system of linear equations that couples different parameters. Although our method still applies, analyzing this scenario would require picking the observables and initial states in a way that the system of equations is well-conditioned and we will not discuss this case in detail here.\nSecond, another important generalization is to go beyond short-range systems. Although we have only stated our results for short-range systems in Thm. 2, our techniques apply to certain longrange systems. As this generalization is more technical, we leave the details to the Supplementary Note 4 and constrain ourselves to discussing how the statement of Thm. 2 changes for more general interactions.\nOnly one aspect of the previous discussion changes significantly for long-range interactions: how the r.h.s. of Eq. (8) generalizes. More precisely, let us assume that for some injective function h : R ! R with h(x) = o(1), we have\nk \u00f0etLB etL\u039b \u00de\u00f0OY \u00de k \u2264 h\u00f0dist\u00f0Y ,VnfBg\u00de\u00de\u00f0evt 1\u00de: \u00f014\u00de\nFor instance, for short-range or exponentially decaying interactions, h will be an exponentially decaying function. Thenwe can restate Thm. 2 in terms of h\u22121. As we show in Thm. 6.1. of the Supplementary Note 6, for a precision parameter \u03f5 >0 and evolution on a D-dimensional lattice, assume that we pick the initial time as\nt0 =O h 1 \u03f52\u00f0e2:5v 1\u00de D\nlog\u00f0\u03f5 1\u00de 2\" # : \u00f015\u00de\nFurthermore, assume that we estimate the expectation value of local observables up to precision O\u00f0\u03f5\u00de at ~O\u00bd\u00f0h 1\u00f0 \u03f52\u00f0e2:5v 1\u00de\u00de\u00de D log\u00f0\u03f5 1\u00de\u00de points. Then we can estimate each parameter up to an error of\nO \u03f5 h 1 \u03f52\u00f0e2:5v 1\u00de D\nlog\u00f0\u03f5 1\u00de 2\" # , \u00f016\u00de\nNature Communications | (2024) 15:311 8\nthrough, the same procedure as in the local case. Note that the error in Eq. (16) only tends to 0 as \u03f5\u21920 if h 1\u00f0 \u03f52\u00f0e2:5v 1\u00de\u00de\nD log\u00f0\u03f5 1\u00de= o\u00f0\u03f5 1\u00de, holds, i.e., the function h must decay fast enough. In the Supplementary Note 5, we discuss examples of systems with algebraically decaying interactions for which this is satisfied. For instance, for potentials that decay like r\u2212\u03b1 with \u03b1 > 5D \u2212 1 we obtain that h 1\u00f0\u03f5\u00de=O\u00f0\u03f5 1\u03b1 3D\u00de, holds.We summarize the resulting resources in the Supplementary Table 6.\nThemessage of bounds like (16) is that it is still possible to obtain bounds on the error independent of the system\u2019s size beyond shortrange systems. However, this comes at the expense of requiring higher precision and sampling from more points.\nAnother important observation is that the assumption that we know the structure of the interactions exactly is not required. Indeed, our method is robust to Hamiltonian perturbations of the model as long as the resulting evolution still satisfies a LR bound. For instance, suppose that there actually is a non-negligible interaction between qubits i and j that is not accounted by our model. As long as the resulting time evolution still satisfies a LR bound, our results still hold. As the linear equation to isolate any parameter is independent of that parameter, we can still apply our techniques in this setting."
        },
        {
            "heading": "Parallelizing the measurements",
            "text": "To parallelize the measurement procedure and ensure that we can obtain experimental data to estimate all parameters simultaneously, we resort to a classical shadow process tomography method. Although some papers in the literature already discussed classical shadows for process tomography39,40, we present a simplified and streamlined proof that also gives an improved sample complexity for the observables relevant to this work in the Supplementary Note.\nMore precisely, we show that given a quantum channel \u03a6, Pauli strings P1a, . . . ,P K1 a that differ from the identity on at most \u03c9a sites and Pauli strings P1b, . . . P K2 b that differ from the identity on atmost\u03c9b sites, it is possible to obtain estimates e\u0302m,l of 2 ntr Pma \u03a6\u00f0Plb\u00de h i satisfying\nj2 ntr Pma \u03a6\u00f0Plb\u00de h i e\u0302m,l j\u2264 \u03f5 \u00f017\u00de\nfor all m, l with probability at least 1 \u2212 \u03b4 from\nO\u00f03\u03c9a +\u03c9b\u03f5 2 log\u00f0K1K2\u03b4 1\u00de\u00de \u00f018\u00de\nsamples. More precisely, the protocol of shadow process tomography requires preparing Eq. (18)many different random initial product Pauli eigenstates and measuring them in random Pauli bases. This makes it feasible to implement it in the near-term.Wediscuss it inmore detail in the Supplementary Note 7, as this protocol may be of interest beyond the problem at hand.\nThe shadowprocess tomography protocol is ideally suited for our Hamiltonian learning protocol. Indeed, note that to learn k-body interactions, we only required the preparation of initial states \u03c1l that differ from the maximally mixed state on k qubits and measure Pauli strings supported on at most k qubits. Furthermore, for a system of n qubits in total, there are at most 16k\u00f0n\nk \u00de\u2264 16knk such states or Pauli\nstrings. We conclude that we can estimate all required expectation values for a given time step using\nO\u00f09k\u03f5 2k log\u00f0n\u03b4 1\u00de\u00de \u00f019\u00de\nsamples. As our protocol requires estimating expectation values at a total of polylog\u00f0\u03f5 1\u00de time steps, we can gather the data required to recover all the O\u00f0n\u00de parameters of the evolution from O\u00f0\u03f5 2polylog\u00f0n,\u03f5 1\u00de\u00de samples through the shadow process tomography protocol whenever k =O\u00f01\u00de."
        },
        {
            "heading": "Data availability",
            "text": "Thedata generated and analyzedduring the current study are available from the authors upon request."
        },
        {
            "heading": "Code availability",
            "text": "The computer codes developed and tested by the authors, and the input files used for producing the presented data, are available upon request. The current version of the codes is not designed for broad distribution and requires substantial hardware resources for reproducing the presented results. Correct installation of the current version of the codes, preparation of correct input files, and correct analysis of the results require substantial expertise, and may need separate instructions in each specific case."
        },
        {
            "heading": "Acknowledgements",
            "text": "D.S.F. was supported by VILLUM FONDEN via the QMATH Centre of Excellence under Grant No. 10059 and the European Research Council (Grant agreement No. 818761). This work is part of HQI initiative (www.hqi.fr) and DSF was supported by France 2030 under the French National Research Agency award number \u201cANR-22-PNCQ-0002\u201d. A.H.W. thanks the VILLUM FONDEN for its support with a Villum Young Investigator Grant (Grant No. 25452). J.B. acknowledges support from The AWS Quantum Discovery Fund at the Harvard Quantum Initiative and funding from the NWO Gravitation Program Quantum Software Consortium. V.V.D. work is a part of the research programNWOQuTech Physics Funding (QTECH, program 172) with project number 16QTECH02, which is (partly) financed by the Dutch Research Council (NWO); the work was partially supported by the Kavli Institute of Nanoscience Delft. L.A.M. was supported by the Netherlands Organisation for Scientific Research (NWO/OCW), as part of the Quantum Software Consortium program (project number 024.003.037/3368)."
        },
        {
            "heading": "Author contributions",
            "text": "D.S.F., A.H.W., and J.B. conceived the original project. D.S.F., A.H.W., and L.M. conducted the analytical derivationswith input fromV.V.D. and J.B. The software for the many-qubit simulations was written and tested by V.V.D. L.M. and D.S.F. performed the numerical analysis with input from A.H.W. and J.B. All authors contributed to the discussion of the results and writing of the manuscript."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41467-023-44012-5.\nCorrespondence and requests for materials should be addressed to Daniel Stilck Fran\u00e7a.\nPeer review informationNatureCommunications thanks Eyal Bairey and the other, anonymous, reviewer(s) for their contribution to the peer review of this work.\nReprints and permissions information is available at http://www.nature.com/reprints\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nNature Communications | (2024) 15:311 10\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/ licenses/by/4.0/.\n\u00a9 The Author(s) 2024\nNature Communications | (2024) 15:311 11"
        }
    ],
    "title": "Efficient and robust estimation of many-qubit Hamiltonians",
    "year": 2024
}