{
    "abstractText": "Problem definition: Appointment scheduling problems under uncertainty encounter a fundamental trade-off between cost minimization and customer waiting times. Most existing studies address this trade-off using a weighted sum approach, which puts little emphasis on individual waiting times and, thus, customer satisfaction. In contrast, we study how to minimize total cost while providing waiting time guarantees to all customers. Methodology/results: Given box uncertainty sets for service times and no-shows, we introduce the Robust Appointment Scheduling Problem with Waiting Time Guarantees. We show that the problem is NP-hard in general and introduce a mixed-integer linear program that can be solved in reasonable computation time. For special cases, we prove that polynomial-time variants of the well-known Smallest-Variance-First sequencing rule and the Bailey-Welch scheduling rule are optimal. Furthermore, a case study with data from the radiology department of a large university hospital demonstrates that the approach not only guarantees acceptable waiting times but, compared to existing robust approaches, may simultaneously reduce costs incurred by idle time and overtime. Managerial implications: This work suggests that limiting instead of minimizing customer waiting times is a win-win solution in the trade-off between customer satisfaction and cost minimization. Additionally, it provides an easy-to-implement and customizable appointment scheduling framework with waiting time guarantees.",
    "authors": [
        {
            "affiliations": [],
            "name": "Carolin Bauerhenne"
        },
        {
            "affiliations": [],
            "name": "Rainer Kolisch"
        },
        {
            "affiliations": [],
            "name": "Andreas S. Schulz"
        }
    ],
    "id": "SP:5e46b8899ed22fa916ddb8c46f04498c422f6385",
    "references": [
        {
            "authors": [
                "A Ahmadi-Javid",
                "Z Jalali",
                "KJ Klassen"
            ],
            "title": "Outpatient appointment systems in healthcare: A review",
            "year": 2017
        },
        {
            "authors": [
                "S Benjaafar",
                "D Chen",
                "R Wang",
                "Z Yan"
            ],
            "title": "Appointment scheduling under a service-level constraint",
            "year": 2023
        },
        {
            "authors": [
                "D Bertsimas",
                "VF Farias",
                "N Trichakis"
            ],
            "title": "The price of fairness. Operations Research 59(1):17\u201331",
            "venue": "Manufacturing & Service Operations Management",
            "year": 2011
        },
        {
            "authors": [
                "L Vandenberghe"
            ],
            "title": "Outpatient scheduling in health care: a review of literature",
            "venue": "Convex Optimization,",
            "year": 2000
        },
        {
            "authors": [
                "T Cayirli",
                "E Veral",
                "H Rosen"
            ],
            "title": "Assessment of patient classification in appointment system design",
            "year": 2008
        },
        {
            "authors": [
                "MA de Kemp",
                "M Mandjes",
                "N Olver"
            ],
            "title": "Performance of the smallest-variance-first rule in appointment sequencing",
            "venue": "Operations Research",
            "year": 2021
        },
        {
            "authors": [
                "M Deceuninck",
                "D Fiems",
                "S De Vuyst"
            ],
            "title": "Outpatient scheduling with unpunctual patients and no-shows",
            "venue": "European Journal of Operational Research",
            "year": 2018
        },
        {
            "authors": [
                "B Denton",
                "D Gupta"
            ],
            "title": "A sequential bounding approach for optimal appointment scheduling",
            "venue": "IIE Transactions",
            "year": 2003
        },
        {
            "authors": [
                "MR Garey",
                "DS Johnson"
            ],
            "title": "Computers and intractability: A guide to the theory of NP-hardness (San Fransisco: WH Freeman)",
            "year": 1979
        },
        {
            "authors": [
                "M Goitein",
                "M Jermann"
            ],
            "title": "The relative costs of proton and X-ray radiation therapy",
            "venue": "Clinical Oncology 15(1):S37\u2013S50",
            "year": 2003
        },
        {
            "authors": [
                "D Gupta",
                "B Denton"
            ],
            "title": "Appointment scheduling in health care: Challenges and opportunities",
            "venue": "IIE Transactions",
            "year": 2008
        },
        {
            "authors": [
                "CJ Hill",
                "K Joonas"
            ],
            "title": "The impact of unacceptable wait time on health care patients\u2019 attitudes and actions. Health Marketing Quarterly 23(2):69\u201387",
            "year": 2005
        },
        {
            "authors": [
                "XM Huang"
            ],
            "title": "Patient attitude towards waiting in an outpatient clinic and its applications. Health Services Management Research 7(1):2\u20138",
            "year": 1994
        },
        {
            "authors": [
                "M Issabakhsh",
                "S Lee",
                "H Kang"
            ],
            "title": "Scheduling patient appointment in an infusion center: a mixed integer robust optimization approach",
            "venue": "Health Care Management Science",
            "year": 2021
        },
        {
            "authors": [
                "M Jafarnia-Jahromi",
                "R Jain"
            ],
            "title": "Non-indexability of the stochastic appointment scheduling problem",
            "venue": "Automatica",
            "year": 2020
        },
        {
            "authors": [
                "R Jiang",
                "S Shen",
                "Y Zhang"
            ],
            "title": "Integer programming approaches for appointment scheduling with random no-shows and service durations. Operations Research 65(6):1638\u20131656",
            "year": 2017
        },
        {
            "authors": [
                "Q Kong",
                "CY Lee",
                "CP Teo",
                "Z Zheng"
            ],
            "title": "Appointment sequencing: Why the smallest-variance-first rule may not be optimal",
            "venue": "European Journal of Operational Research 255(3):809\u2013821",
            "year": 2016
        },
        {
            "authors": [
                "Q Kong",
                "S Li",
                "N Liu",
                "CP Teo",
                "Z Yan"
            ],
            "title": "Appointment scheduling under time-dependent patient no-show behavior. Management Science 66(8):3480\u20133500",
            "year": 2020
        },
        {
            "authors": [
                "P Kumar",
                "MU Kalwani",
                "M Dada"
            ],
            "title": "The impact of waiting time guarantees on customers\u2019 waiting experiences. Marketing Science 16(4):295\u2013314",
            "year": 1997
        },
        {
            "authors": [
                "HY Mak",
                "Y Rong",
                "J Zhang"
            ],
            "title": "Appointment scheduling with limited distributional information. Management Science 61(2):316\u2013334",
            "year": 2015
        },
        {
            "authors": [
                "S Mittal",
                "AS Schulz",
                "S Stiller"
            ],
            "title": "Robust appointment scheduling. Approximation, Randomization, and Combinatorial Optimization",
            "venue": "Algorithms and Techniques (APPROX/RANDOM 2014),",
            "year": 2014
        },
        {
            "authors": [
                "GP Moschis",
                "DN Bellenger",
                "CF Curasi"
            ],
            "title": "What influences the mature consumer? Marketing Health Services 23(4):16\u201321",
            "year": 2003
        },
        {
            "authors": [
                "J Qi"
            ],
            "title": "Mitigating delays and unfairness in appointment systems. Management Science 63(2):566\u2013583",
            "year": 2017
        },
        {
            "authors": [
                "LW Robinson",
                "RR Chen"
            ],
            "title": "Scheduling doctors\u2019 appointments: optimal and empirically-based heuristic policies",
            "venue": "IIE Transactions",
            "year": 2003
        },
        {
            "authors": [
                "G Roels",
                "BR Staats"
            ],
            "title": "OM forum\u2014people-centric operations: Achievements and future research directions. Manufacturing & Service Operations Management 23(4):745\u2013757",
            "year": 2021
        },
        {
            "authors": [
                "M Samorani",
                "SL Harris",
                "LG Blount",
                "H Lu",
                "MA Santoro"
            ],
            "title": "Overbooked and overlooked: machine learning and racial bias in medical appointment scheduling. Manufacturing & Service Operations Management 24(6):2825\u20132842",
            "year": 2021
        },
        {
            "authors": [
                "P Sang",
                "MA Begen",
                "J Cao"
            ],
            "title": "Appointment scheduling with a quantile objective",
            "venue": "Computers & Operations Research",
            "year": 2021
        },
        {
            "authors": [
                "AS Schulz",
                "R Udwani"
            ],
            "title": "Robust appointment scheduling with heterogeneous costs. Approximation, Randomization, and Combinatorial Optimization",
            "venue": "Algorithms and Techniques (APPROX/RANDOM 2014),",
            "year": 2019
        },
        {
            "authors": [
                "SA Taylor",
                "TL Baker"
            ],
            "title": "An assessment of the relationship between service quality and customer satisfaction in the formation of consumers\u2019 purchase intentions",
            "venue": "Journal of Retailing",
            "year": 1994
        },
        {
            "authors": [
                "J Welch",
                "NJ Bailey"
            ],
            "title": "Appointment systems in hospital outpatient departments",
            "year": 1952
        },
        {
            "authors": [
                "M Zhou",
                "GG Loke",
                "C Bandi",
                "ZQG Liau",
                "W Wang"
            ],
            "title": "Intraday scheduling with patient re-entries and variability in behaviours. Manufacturing & Service Operations Management 24(1):561\u2013579",
            "year": 2022
        },
        {
            "authors": [
                "Jiang"
            ],
            "title": "2017, Kong et al. 2020)",
            "venue": "To capture the variability in real-world scenarios,",
            "year": 2020
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n40 2.\n12 56\n1v 1\n[ ec\non .G\nN ]\n1 9\nmental trade-off between cost minimization and customer waiting times. Most existing studies address this trade-off using a weighted sum approach, which puts little emphasis on individual waiting times and, thus, customer satisfaction. In contrast, we study how to minimize total cost while providing waiting time guarantees to all customers. Methodology/results: Given box uncertainty sets for service times and no-shows, we introduce the Robust Appointment Scheduling Problem with Waiting Time Guarantees. We show that the problem is NP-hard in general and introduce a mixed-integer linear program that can be solved in reasonable computation time. For special cases, we prove that polynomial-time variants of the well-known Smallest-Variance-First sequencing rule and the Bailey-Welch scheduling rule are optimal. Furthermore, a case study with data from the radiology department of a large university hospital demonstrates that the approach not only guarantees acceptable waiting times but, compared to existing robust approaches, may simultaneously reduce costs incurred by idle time and overtime. Managerial implications: This work suggests that limiting instead of minimizing customer waiting times is a win-win solution in the trade-off between customer satisfaction and cost minimization. Additionally, it provides an easy-to-implement and customizable appointment scheduling framework with waiting time guarantees.\nKey words : appointment scheduling; waiting time guarantees; robust optimization\n1\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 2"
        },
        {
            "heading": "1. Introduction",
            "text": "Excessive waiting times negatively affect customer satisfaction, perceived service quality, and loyalty in various services, such as call centers, public transportation, and health care (Huang 1994, Taylor and Baker 1994). A customer\u2019s tolerance for waiting, which separates acceptable from excessive waiting times, has been shown to range from 37 minutes for a majority of patients in an outpatient clinic to 11 seconds for most users to load a website (Bouch et al. 2000, Moschis et al. 2003, Hill and Joonas 2005). The tolerance depends amongst others on the perceived and expected waiting time and can be influenced by many effective interventions, e.g., Kumar et al. (1997), Davis and Heineke (1998), Bielen and Demoulin (2007). Meanwhile, there is a lack of appointment scheduling approaches to control actual waiting times.\nAppointment scheduling is a multi-criteria problem that typically involves uncertainty in service times and other attributes. In particular, appointment scheduling problems face a fundamental trade-off between waiting times and capacity utilization: Shorter waiting times come at the cost of longer idle times, and vice versa. In the literature, this trade-off has been modeled predominantly by minimizing a weighted sum of waiting times, idle times, and overtime (Ahmadi-Javid et al. 2017). However, it has long been known that such weighted sum approaches can lead to unbalanced and excessive waiting times for some customers (Cayirli and Veral 2003), and in combination with individual no-show predictions even to racial disparity (Samorani et al. 2021).\nThis paper proposes a new approach to appointment scheduling that considers waiting (in)tolerance. In particular, we study the following robust appointment scheduling and sequencing problem. For a set of preselected customers, we are given the shortest and longest possible service time of each customer as well as the total number of no-shows. We limit each customer\u2019s waiting time, even in a worst-case scenario, to a predetermined tolerance for waiting (so-called maximum waiting time guarantee). Then we minimize a weighted sum of idle times and overtime (so-called total cost). The main contributions of this work can be summarized as follows.\nMaximum Waiting Time Guarantees. To the best of our knowledge, this paper is the first to introduce maximum waiting time guarantees for intraday appointment scheduling. The\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 3\nguarantees ensure that each customer\u2019s waiting time stays below a given individual threshold, even in a worst-case scenario. Hence, they ensure that all customers experience acceptable waiting times and prevent customer dissatisfaction due to excessive waiting times. In addition, communicating these guarantees can increase customer satisfaction (Kumar et al. 1997).\nOptimal Scheduling and Sequencing Rules. We show that the robust appointment scheduling and sequencing problem with customer-specific maximum waiting time guarantees is NP-hard in general, and introduce a mixed-integer linear programming formulation. We present optimal scheduling and sequencing rules for the following polynomial-time solvable problem variants. First, we consider the case of constant idle time costs, minimizing total idle time plus overtime cost. For this case, we prove optimality of an extended variant of the well-known Smallest-Variance-First rule, sorting customers in ascending order by the degree of uncertainty in their service time and their waiting time guarantees. For the case of non-increasing idle time costs and any given but fixed customer sequence, we prove optimality of the so-called ASAP rule, scheduling customers as early as possible while fulfilling the waiting time guarantees.\nComputational Study Using Patient Data from a Radiology Department. Using real data from the radiology department of a large hospital, we first show that the problem can be solved in reasonable computation times for all considered instances. Second, we conduct a sensitivity analysis of the waiting times, idle times, and overtime obtained with optimal schedules and sequences. Third, we compare the schedules with those obtained by a weighted sum approach. The results show that waiting time guarantees lead to limited and more balanced waiting times across all customers. Moreover, by definition, our approach introduces the waiting time guarantees with a minimal increase in worst-case total cost. In particular, in cases in which the waiting times obtained by the weighted sum approach are also acceptable for all patients, our approach generally leads to lower total costs without increasing the waiting time of the longest waiting patient.\nThe remainder of the paper is organized as follows. Section 2 reviews related optimization problems in the appointment scheduling literature. Section 3 formally introduces the Robust Appointment Scheduling Problem with Waiting Time Guarantees. We show that it is NP-hard in general\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 4\nand derive a mixed-integer linear program formulation. In Section 4, we present optimal scheduling and sequencing rules for relevant special cases in polynomial time. In Section 5, we conduct a computational study with real-world data, showing that introducing maximum waiting time guarantees can improve both waiting times and total cost compared to a weighted sum approach."
        },
        {
            "heading": "2. Literature Review",
            "text": "For an overview of general appointment scheduling, we refer the interested reader to Cayirli and Veral (2003), Gupta and Denton (2008), and Ahmadi-Javid et al. (2017). In the following, we review two streams of the appointment scheduling literature that are most relevant to our research. In Section 2.1, we discuss robust optimization approaches using box uncertainty sets for service times. In Section 2.2, we survey alternative approaches for modeling waiting time, distinct from the widely used weighted sum approach that minimizes total idle time, total waiting time, and overtime."
        },
        {
            "heading": "2.1. Robust Optimization Framework",
            "text": "Robust approaches to appointment scheduling that require only the shortest and longest service times but no other distributional information are scarce. To the best of our knowledge, Mittal et al. (2014) present the first such approach, minimizing a weighted sum of idle time costs and waiting time costs. Schulz and Udwani (2019) generalize the problem in Mittal et al. (2014) to idle time costs that are heterogeneous in the customer sequence and thus implicitly heterogeneous over time. Both works derive scheduling and sequencing rules for various special cases that are remarkably easy to implement. Given a customer sequence and homogeneous idle time costs, Mittal et al. (2014) present a polynomial-time algorithm to compute optimal interappointment times, which decrease as the planning horizon progresses. They also show that a simple variant of Smith\u2019s rule, scheduling customers in ascending order of the length of their service time intervals divided by their waiting time costs, is a 1.137 approximation. Schulz and Udwani (2019) prove a slightly adapted variant of this rule to be 1.0604-approximate, and the problem of simultaneously scheduling and sequencing customers with heterogeneous idle time costs and the weighted sum objective function to be strongly NP-hard. Recently, Issabakhsh et al. (2021) addressed a robust appointment\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 5\nscheduling problem for infusion centers and solved it with a scheduling heuristic based on Adaptive Large Neighborhood Search. Advancing this first stream of literature, whose robust optimization framework we follow and additionally extend to account for no-shows, we provide waiting time guarantees to all customers."
        },
        {
            "heading": "2.2. Modeling Waiting Time",
            "text": "Building on the classification by Bertsimas et al. (2011), we divide approaches for modeling waiting times into two substreams, based on the criterion used to evaluate waiting time. The utilitarian criterion minimizes a weighted sum of waiting times, while fairness criteria address individual waiting times more directly.\n2.2.1. Utilitarian Criterion. In the first substream, we review appointment scheduling approaches that deviate from the classic weighted sum objective function but retain the utilitarian criterion. Sang et al. (2021) use a stochastic optimization approach to minimize any quantile of the total (idle time, overtime, and waiting) cost for a given job sequence. They find a semi-domeshaped pattern with increasing interappointment times at the beginning of the planning horizon and constant interappointment times later. Zhou et al. (2022) use a chance-constraint approach, minimizing, among others, the probability that the sum of waiting times exceeds a certain threshold. They find optimal interappointment times to follow the well-known dome-shaped pattern in the case of zero no-shows and walk-ins. With a positive number of walk-ins, they find optimal interappointment times in the middle of the planning horizon to be constant, forming a so-called plateau dome-shaped pattern.\n2.2.2. Fairness Criteria. Qi (2017) presents the first optimization study with the primary objective of fair customer waiting times. She lexicographically minimizes the so-called delay unpleasantness of the longest-waiting customer, which considers the frequency and intensity of delays above a certain threshold. Optimal scheduling rules depend on waiting time thresholds and the weighting of overtime costs. As the weighting of overtime increases, the interappointment times between the first appointments are shorter than with weighted sum approaches. As the waiting\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 6\ntime threshold decreases, later start times are assigned to the later appointments in the planning horizon. Following a queuing approach, Benjaafar et al. (2023), by contrast, assign the earliest possible appointment time to each customer request while limiting the expected waiting time of\neach customer. They find that the optimal times between appointments increase in the order of arrival. Finally, for a given customer sequence, Bendavid et al. (2018) minimize the completion time of the last appointment while bounding the probability of delay for each appointment. Under\nthe assumption that the distribution of service times is known, they develop a simulation-based sequential algorithm and show that optimal interappointment times follow a dome-shaped pattern.\n2.2.3. Our Contribution. In this paper, we contribute to the fairness criteria by providing an a priori waiting time guarantee for each customer, effectively limiting their worst-case waiting time. These waiting time guarantees can be customized to match the tolerance levels for waiting\nidentified in empirical studies. Moreover, compared to existing approaches, we allow for substantial cost reduction by accounting for no-shows, (heterogeneous) idle time costs, and the sequencing decision."
        },
        {
            "heading": "3. Robust Appointment Scheduling with Waiting Time Guarantees",
            "text": "This section is organized as follows. In Section 3.1, we formally introduce the Robust Appointment\nScheduling Problem with Waiting Time Guarantees. In Section 3.2, we show that the problem is NP-hard. In Section 3.3, we derive two mixed-integer linear programs, the first for the case that all customers show up and the second for the general case, which considers no-shows."
        },
        {
            "heading": "3.1. Mathematical Model",
            "text": "We consider a set of n preselected customers denoted by [n] := {1, . . . , n}, and a single service provider with a regular working time of L time units. Our decisions involve determining the customer sequence and appointment times. To determine the customer sequence, we introduce binary variables \u03c0ij for i, j \u2208 [n], where \u03c0ij = 1 if and only if exactly i\u2212 1 customers are served before customer j. In other words, customer j is assigned to the i-th appointment. We define continuous variables Ai \u2265 0 to represent the start time of each appointment i \u2208 [n]. We consider the following\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 7\ncosts. Idle time before the first appointment incurs a per-time unit cost c1, and idle time between two consecutive appointments i\u2212 1 and i incurs a per-time unit cost ci, for 2\u2264 i\u2264 n. If there is any idle time before the planning horizon of L time units ends, it incurs a per-time unit cost cn+1. Additionally, overtime incurs a per-time unit cost co. We aim to determine a customer sequence and appointment times that minimize the cost incurred by idle time and overtime, while ensuring that no customer j \u2208 [n] waits longer than their maximum waiting time guarantee Wj .\nThe main difficulty is that customers have uncertain service times and no-show behavior. For each customer j \u2208 [n], we only have information about the shortest and longest possible service times, denoted as \u00af pj and p\u0304j, respectively. This leads to the scenario set of possible service time realizations P := [ \u00af p1, p\u03041]\u00d7 . . .\u00d7 [ \u00af pn, p\u0304n]. Additionally, we know the total number of customers who will show up within the planning horizon, denoted as k, where k \u2264 n. We have no information on which k out of n customers show up. This leads to the scenario set of possible no-show realizations \u039bk := {\u03bb\u2208 {0,1} n : \u2211n j=1 \u03bbj = k}, where \u03bbj =1 if and only if customer j shows up. We assume that customers who show up are on time.\nFor any given but fixed service time scenario p \u2208 P and no-show scenario \u03bb \u2208 \u039bk, and given \u03c0 and A, we compute waiting times, idle times, and overtime as follows. We start by initializing C0(\u03c0,A,p,\u03bb) := 0, and define completion times recursively for each appointment i \u2208 [n] as Ci(\u03c0,A,p,\u03bb) := max{Ai,Ci\u22121(\u03c0,A,p,\u03bb)} + \u2211n j=1 \u03c0ij\u03bbjpj. It is useful and easy to see by induction that the completion times can be reformulated as Ci(\u03c0,A,p,\u03bb) = maxl\u2208[1,i] { Al + \u2211i\nk=l\nn\u2211 j=1 \u03c0kj\u03bbjpj\n}\n, see Lemma 3 in the Online Appendix. The waiting time before\neach appointment i\u2208 [n] then equals the duration between the completion of the previous appointment and the start of the current appointment, expressed as\nwaiti(\u03c0,A,p,\u03bb) := (Ci\u22121(\u03c0,A,p,\u03bb)\u2212Ai) + ,\nwith (\u00b7)+ :=max{0, \u00b7}. Similarly, the idle time before each appointment i \u2208 [n+1], with An+1 :=L, is given by (Ai\u2212Ci\u22121(\u03c0,A,p,\u03bb)) + , and overtime is computed as (Cn(\u03c0,A,p,\u03bb)\u2212 L) +. The cost function cost(\u03c0,A,p,\u03bb) := n\u2211\ni=1\nci (Ai\u2212Ci\u22121(\u03c0,A,p,\u03bb)) + +max{cn+1(L\u2212Cn(\u03c0,A,p,\u03bb)), co(Cn(\u03c0,A,p,\u03bb)\u2212L)}\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 8\naccounts for the total cost arising from idle time and overtime. We refer to Table 7 in the Online Appendix for a summary of the notation.\nTo establish sustainable solutions, appointment schedules should be designed sufficiently robust to withstand unfortunate service times and no-shows. Excessive waiting times, idle time, and overtime not only incur high costs but also lead to employee and customer stress, dissatisfaction, and reduced loyalty. In healthcare, these factors can even harm patient health (Bae and Fabry 2014). Hence, we introduce a robust optimization approach that ensures smooth operations for all stakeholders, even in adverse scenarios. This gives rise to the following Robust Appointment Scheduling Problem with Waiting Time Guarantees:\nmin \u03c0,A U (1)\ns.t. max p\u2208P,\u03bb\u2208\u039bk\n{\ncost(p,\u03bb,\u03c0,A)\u2212U,max i\u2208[n]\n{\nwaiti(p,\u03bb,\u03c0,A)\u2212 n\u2211\nj=1\n\u03c0ijWj\n}}\n\u2264 0 (2)\nn\u2211\ni=1\n\u03c0ij = 1, n\u2211\nj=1\n\u03c0ij = 1 \u2200i, j \u2208 [n] (3)\nA1 = 0 (4) \u03c0ij \u2208 {0,1} \u2200i, j \u2208 [n] (5)\nThe Objective Function (1) minimizes the upper bound U on total cost incurred by idle time and overtime. Constraint (2) enforces this upper bound to remain valid even in worst-case scenarios, preventing excessive idle time and excessive overtime. Additionally, it ensures that the waiting time guarantees of all customers are met across all scenarios, ensuring acceptable waiting times. Thus, by preparing both the provider and the customers for their respective worst-case scenarios, Constraint (2) ensures smooth operation even on a challenging day. Constraints (3) enforce that each customer is assigned to exactly one appointment, and each appointment is assigned to exactly one customer. Constraint (4) sets the start time of the first appointment to 0.\nRemark 1. Due to the adversarial problems in Constraint (2), which maximize the total cost and the waiting time of the longest-waiting customer, the above problem formulation is non-linear. In particular, it is not amenable to standard MIP solvers in this form.\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 9\nRemark 2. The problem always has a feasible solution. For an arbitrary but fixed sequence \u03c0, it is easy to see that the appointment times A1 := 0 and Ai := (\nmaxl\u2208[1,i\u22121]\n(\nAl + \u2211i\u22121\nk=l \u2211n j=1 \u03c0kj p\u0304j\n)\n\u2212 \u2211n\nj=1 \u03c0ijWj\n)+\nfor i \u2208 [2, n] are feasible solutions. In the\nspecial case that all waiting time guarantees are so long that the latter term equals 0 for all i \u2208 [n], all customers could be scheduled at time 0, which corresponds to the single block rule (Cayirli and Veral 2003).\nRemark 3. It is noteworthy that in special cases a monotonic increase in the appointment times is not guaranteed. Specifically, given a worst-case scenario p and \u03bb, an assignment \u03c0, and appointment times A1, . . . ,Ai\u22121, it holds that Ai can be chosen to be earlier than Ai\u22121 if and only if max{0,Ci\u22121(\u03c0,A,p,\u03bb)\u2212Ai\u22121}+ \u2211n j=1 \u03c0i\u22121,jpj < \u2211n j=1 \u03c0ijWj ."
        },
        {
            "heading": "3.2. Complexity Analysis",
            "text": "In this section, we establish theNP-hardness of the Robust Appointment Scheduling Problem with Waiting Time Guarantees, which holds even under the assumption of zero no-shows and identical waiting time guarantees for all customers. This result expands upon existing NP-hardness proofs for appointment scheduling and sequencing problems employing weighted sum approaches (Bosch 1997, Kong et al. 2016, Schulz and Udwani 2019).\nTheorem 1 (NP-Hardness). Let all customers show up and have identical waiting time guarantees W . Moreover, let the idle time costs fulfill c1 = . . .= c\u03c3 > c\u03c3+1 = . . .= cn for some \u03c3 \u2208 [n\u22121] and the overtime cost co = 0. Then the Robust Appointment Scheduling Problem with Waiting Time Guarantees is NP-hard.\nWe briefly sketch the proof and refer to the Online Appendix for details. In a worst-case scenario, worst-case idle times arise in two ways: If no idle time occurs up to and including appointment i\u2217\u2212 1, then the idle time before appointment i\u2217 equals \u2211i\u2217\u22121\ni=1 \u2211n j=1 \u03c0ij(p\u0304j\u2212\n\u00af pj)\u2212W . The idle time\nbefore all subsequent appointments i > i\u2217 equals \u2211n\nj=1 \u03c0i\u22121,j(p\u0304j\u2212 \u00af pj). In the case of i\n\u2217 = \u03c3, the unit\nidle time cost before appointment i\u2217 exceeds all later unit costs of idle time. The challenge lies in partitioning the customers into two groups such that the idle time sum \u2211i\u2217\u22121\ni=1 \u2211n j=1 \u03c0ij(p\u0304j\u2212\n\u00af pj)\u2212W\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 10\nis minimized. In the Online Appendix, we show that the well-known Subset Sum Problem can be reduced to this particular problem, establishing the NP-hardness of RASWTG.\nRemark 4. If the assumption on idle time costs in Theorem 1 is replaced by constant idle time costs c1 = . . .= cn, indicating no time preference for idle time occurrence, the Robust Appointment Scheduling Problem with Waiting Time Guarantees becomes solvable in polynomial time. We discuss this case in detail in Section 4. 3.3. Linearization Due to the recursive nature of completion times in the cost function, applying the classical dualization scheme by Bertsimas and Sim (2004) for linearization is impractical. However, we overcome this challenge by exploring structural problem properties. In Section 3.3.1, we leverage structural properties to determine worst-case service times analytically. This allows us to formulate a compact Mixed-Integer Linear Program (MILP) for the case of zero no-shows. Section 3.3.2 then motivates the consideration of no-shows and outlines advanced structural properties utilized for linearization in the presence of no-shows. For a detailed consideration of no-shows as well as for proofs not included in the main paper, we refer the interested reader to the Online Appendix B.\n3.3.1. Worst-Case Service Time Scenarios. We investigate service times in adversarial scenarios maximizing cost and waiting times, respectively. Consequently, we present a compact MILP for the case of zero no-shows.\nAdversarial Problem of Maximizing Cost. The following theorem shows that the total cost is maximized in one of the n+1 sequence-dependent scenarios, in which customers scheduled for the first i\u2217 \u2208 {0, . . . , n} appointments require minimum service duration (idle time maximization), and all subsequent customers require maximum service time (overtime maximization).\nTheorem 2. Given a customer sequence \u03c0, appointment times A, and \u03bb\u2208\u039bk, let \u00af Ci(\u03c0,A,\u03bb) :=\nmax{Ai, \u00af Ci\u22121(\u03c0,A,\u03bb)}+\n\u2211n j=1 \u03c0ij\u03bbj\n\u00af pj for i\u2208 [n], with \u00af C0(\u03c0,A,\u03bb) := 0, define the completion times\nwhen all customers require minimum service time. Then maxp\u2208P cost(p,\u03bb,\u03c0,A) is equivalent to\nmax i\u2217\u2208{0,...,n+1}\ni\u2217\u2211\ni=1\nci(Ai\u2212 \u00af Ci\u22121(\u03c0,A,\u03bb))\n+ + co\n(\nAi\u2217 + n\u2211\nk=i\u2217\nn\u2211\nj=1\n\u03c0kj\u03bbj p\u0304j \u2212L\n)+\n,\nwhere An+1 :=L.\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 11\nAdversarial Problem of Maximizing Waiting Times. As for each no-show scenario \u03bb \u2208 \u039bk, service time scenario p \u2208 P, and patient j \u2208 [n], the realized service time \u03bbjpj is non-negative, it is straightforward to see that the scenario of maximum service times\np\u0304 := (p\u03041, . . . , p\u0304n)\u2208 argmax p\u2208P\n{\nmax l\u2208[1,i\u22121]\n(\nAl + i\u22121\u2211\nk=l\nn\u2211 j=1 \u03c0kj\u03bbjpj\n)}\n, (6)\nuniformly maximizes the waiting time for each appointment i\u2208 [n] in Constraint (2).\nMILP. Now, let \u2206i denote the idle time before appointment i \u2208 [n + 1] and \u03c3i\u2217 denote the overtime accumulated starting from appointment i\u2217 \u2208 [n+ 1]. Then the worst-case service time\nscenarios from Theorem 2 allow us to obtain the following mixed-integer linear program for the\ncase of zero no-shows (RASWTG-0):\nminU (7)\ns.t.U \u2265 i\u2217\u2211\ni=1\nci\u2206i+ co\u03c3i\u2217 \u2200i \u2217 \u2208 [n+1] (8)\n\u2206i \u2265Ai\u2212 \u00af Ci\u22121 \u2200i\u2208 [n+1] (9) \u00af Ci =max{Ai, \u00af Ci\u22121}+ n\u2211\nj=1\n\u03c0ij \u00af pj \u2200i\u2208 [n] (10)\n\u03c3i\u2217 \u2265Ai\u2217 + n\u2211\nk=i\u2217\nn\u2211\nj=1\n\u03c0kj p\u0304j \u2212L \u2200i \u2217 \u2208 [n] (11)\nAl + i\u22121\u2211\nk=l\nn\u2211 j=1 \u03c0kj p\u0304j \u2212Ai \u2264 n\u2211 j=1 \u03c0ijWj \u2200i, l : i \u2208 [n], l \u2208 [i\u2212 1] (12)\nn\u2211\nj=1\n\u03c0ij = 1, n\u2211\ni=1\n\u03c0ij = 1 \u2200i, j \u2208 [n] (13)\nA1 = 0, \u00af C0 = 0,An+1 =L (14) Ai, \u00af Ci \u2265 0 \u2200i\u2208 [n] (15) \u2206i, \u03c3i \u2265 0 \u2200i\u2208 [n+1] (16)\n\u03c0ij \u2208 {0,1} \u2200i, j \u2208 [n] (17)\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 12\nCompared to (1 - 5), RASWTG-0 can be characterized as follows: Based on Lemma 2, Con-\nstraints (8) - (11) determine the worst-case total cost incurred by idle time and overtime. Based on\n(6), Constraint (12) ensures that the waiting time guarantees are fulfilled even in the worst case.\nRASWTG-0 is an assignment problem of customers to appointments with assignment-dependent cost. It has O(n2) binary variables, O(n) continuous variables, and O(n2) constraints. Using stan-\ndard linearization techniques, Constraint (10) can be linearized by introducing another O(n) binary\nvariables, see Remark 6 in the Online Appendix. The computational study in Section 5 shows that\nRASWTG-0 is solvable with a state-of-the-art MIP solver in short times for all instances with up\nto twenty patients from a data set of CT examinations in a large university hospital.\n3.3.2. Worst-Case No-Show Scenarios. No-shows introduce uncertainties that, if over-\nlooked, can strongly elevate costs. The example given in Remark 5 illustrates that considering\nno-shows can reduce idle time cost by 70%, and this pattern consistently holds across various\nexamples.\nRemark 5 (Potential for Cost Reduction.). Consider a scenario with five customers in\na fixed order and service time intervals [5, 6], [5, 7], [5, 8], [5, 9], [5, 10], in which two out of five\ncustomers do not show up. All customers have a maximum waiting time guarantees of 10 time\nunits. Idle time costs c1 = . . .= cn are constant. For simplicity, we do not consider idle time after the last appointment or overtime, i.e., cn+1 = 0, co = 0. In Section 4, we demonstrate that this leads to the following optimal solutions: Disregarding the no-show information (planning for 0 no-shows)\nresults in appointment times of 0, 0, 3, 11, 20, incurring a worst-case total idle time of 10 units.\nHowever, accounting for the accurate count of two no-shows yields appointment times of 0, 0, 3,\n5, 7, with a worst-case total idle time of only 3 units.\nWe now address the task of formulating a MILP for the general Robust Appointment Schedul-\ning Problem with Waiting Time Guarantees and k no-shows, 0 \u2264 k \u2264 n. To this end, we explore\nthe adversarial problems, seeking no-show scenarios that maximize waiting times and total cost,\nrespectively. Identifying worst-case no-show scenarios is notably more complex than determining\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 13\nworst-case service times. Moreover, maximizing total cost is particularly intricate because the cost incurred by a no-show is not only proportional to the customer\u2019s service time but also encompasses sequence-dependent idle time and overtime costs. For a comprehensive understanding of the technical aspects, we direct the interested reader to the Online Appendix B. Here, we summarize our key findings:\nAdversarial Problem of Maximizing Cost. In Lemma 5 in the Online Appendix, we characterize a worst-case no-show scenario for an arbitrary but fixed sequence. Specifically, it suffices to consider, for each i\u2217 \u2208 {1, . . . , n+1}, a no-show scenario in which, among the customers scheduled for the last n\u2212 i\u2217+1 appointments, those with the longest maximum service times show up. If k > n\u2212 i\u2217+1, all customers scheduled for these last appointments show up. Additionally, among the customers scheduled for the first i\u2217\u2212 1 appointments, the k\u2212 (n\u2212 i\u2217 +1) ones with the smallest product of idle time cost and minimum service time show up.\nAdversarial Problem of Maximizing Waiting Times. The following lemma establishes the equivalence of (i) computing a single worst-case scenario that maximizes the waiting time for the longest waiting customer and (ii) independently computing a worst-case scenario for each customer that maximizes their waiting time. This inherent decomposability of the adversary problem for waiting times stems from the scenario-independent appointment times.\nLemma 1 (Decomposability). Given a customer sequence (\u03c0ij)i,j\u2208[n] and appointment times\n(Ai)i\u2208[n], it holds that maxp\u2208P,\u03bb\u2208\u039bk\u22121\n{\nmaxi\u2208[n]\n{\nCi\u22121(\u03c0,A,p,\u03bb)\u2212Ai\u2212 \u2211n j=1 \u03c0ijWj\n}}\n\u2264 0 if and\nonly if maxi\u2208[n]\n{\nmaxp(i)\u2208P,\u03bb(i)\u2208\u039bk\u22121\n{\nCi\u22121(\u03c0,A,p (i), \u03bb(i))\u2212Ai\u2212 \u2211n j=1 \u03c0ijWj\n}}\n\u2264 0.\nBy employing the completion time reformulation, leveraging the total unimodularity of the constraint matrix associated with the adversarial problem for each appointment, and applying LP duality, the adversarial problem of maximizing waiting times is then reduced to O(n) linear programming problems. Each of these problems entails O(n) variables and constraints.\nMILP. These results lead to a comprehensive MILP for the general case, detailed in the Online Appendix B and denoted as RASWTG. This MILP encompasses O(n3) variables and constraints, where the constraint matrix exhibits sparsity. The computational study in Section 5\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 14\ndemonstrates the efficient solvability of RASWTG for all instances involving up to ten patients\nfrom a dataset of CT examinations in a large hospital, employing a state-of-the-art MIP solver."
        },
        {
            "heading": "4. Optimal Scheduling and Sequencing",
            "text": "In this section, we present optimal scheduling and sequencing rules to solve RASWTG in polynomial\ntime in special cases, as summarized in Table 1. Additionally, we investigate optimal interappoint-\nment times for the general case. All results demonstrate how to provide maximum waiting time\nguarantees cost-efficiently."
        },
        {
            "heading": "4.1. Polynomial-Time Sequencing for the Case of Constant Idle Time Costs and Zero No-Shows",
            "text": "Finding an optimal customer sequence can substantially reduce idle time costs (Cayirli et al. 2008,\nDeceuninck et al. 2018) but appears extremely difficult (Mak et al. 2015). Similarly, Theorem 1\nimplies that (unless P =NP) we cannot find a universal optimal scheduling and sequencing rule for\nthe Robust Appointment Scheduling Problem with Waiting Time Guarantees in polynomial time.\nHowever, for a relevant special case, we now prove optimality of a polynomial-time sequencing rule\nconsistent with the well-known Smallest-Variance-First (SVF) heuristic.\nSVF is the most common heuristic for weighted sum approaches to appointment sequencing\nwith stochastic service times. It ranks customers in ascending order of variance, following the\nintuition to reduce the probability of deviating from the schedule by placing customers with less\nvariable service times first. For recent SVF studies in a stochastic optimization framework, we refer\nto Kong et al. (2016), Jafarnia-Jahromi and Jain (2020), and de Kemp et al. (2021). Moreover,\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 15\nMak et al. (2015) prove, under a mild condition, the optimality of the SVF rule for a robust meanvariance model with an arbitrary number of appointments. Recently, Kong et al. (2016) showed that the optimality of the SVF policy depends on the number of customers as well as the shape of service time distributions.\nLemma 2 (Optimal Customer Sequence). Let the number of no-shows equal zero and idle time costs c1 = . . .= cn+1 be constant, indicating no time preference for the occurrence of idle time. Then it is optimal to schedule customers j \u2208 [n] in non-decreasing order w.r.t. p\u0304j\u2212 \u00af pj +(1+ co)Wj.\nUnder the given assumptions, it is optimal to schedule customers j \u2208 [n] in non-decreasing order with respect to their service time uncertainty p\u0304j \u2212 \u00af pj and their waiting time guarantee Wj, as a function of overtime cost co. This result intuitively extends the SVF rule to account for waiting time guarantees: Uncertainty is kept as low as possible for as long as possible, particularly for customers with stricter waiting time guarantees. The relative importance of both criteria depends on the overtime cost. We call it the Smallest-Variance-First Rule with Waiting Time Guarantees (SVF-WTG). We will further determine optimal appointment times under these (and milder) assumptions in Section 4.2."
        },
        {
            "heading": "4.2. Polynomial-Time Scheduling Rule under Non-Increasing Idle Time Costs",
            "text": "In the following, we assume that an arbitrary sequence of customers is given. We first present the so-called As Soon As Possible (ASAP) scheduling rule defined by Algorithm 1. Second, we show that in the case of non-increasing idle time costs, it leads to an optimal solution in polynomial time. Third, we describe how ASAP generalizes the well-known Bailey-Welch rule (Welch and Bailey 1952).\nThe ASAP scheduling rule schedules each customer as early as possible while respecting the waiting time constraints. It is constructed as follows by Algorithm 1. The start time of the first appointment is set to 0 in Line 1. For each subsequent appointment, the algorithm computes the latest possible completion time of the previous appointment using Lines 5 and 7. Line 5 calculates the maximum sum of service times from the l-th to the ith appointment under k \u2212 1 show-ups,\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 16\nwhich corresponds to the term in Line 7 if all customers show up. Line 8 ensures that even in a\nworst-case scenario, the waiting time guarantee is met by setting the i-th appointment time to\nthe latest possible completion time of the previous appointment and subtracting the waiting time\nguarantee of the customer scheduled for the i-th appointment. In the special case of zero no-shows, Lines 3 to 7 can be skipped, and Line 8 can be replaced by Ai = ( \u2211i\u22121\nk=1 \u2211n j=1 \u03c0kj p\u0304j \u2212 \u2211n j=1 \u03c0ijWj\n)+\n.\nAlgorithm 1 computes optimal appointment times for a given sequence under non-increasing\nidle time costs, as stated in the following theorem. This condition, while crucial for the optimality\nproof (see Remark 7 in the Online Appendix), holds practical significance. Constant idle time costs\nindicate no time preference for the occurrence of idle time. Decreasing idle time costs indicate that\nlater idle time is less expensive than earlier idle time, potentially due to its productive use for\ndocumentation work incurred by earlier appointments.\nTheorem 3 (Optimal Appointment Times). Given non-increasing idle time costs c1 \u2265 . . .\u2265 cn+1, and a customer sequence \u03c0, Algorithm 1 computes optimal appointment times in polynomial time for the Robust Appointment Scheduling Problem with Waiting Time Guarantees.\nAlgorithm 1 ASAP Scheduling Rule Require: n \u2208N, c\u2208Rn+1 with c1 \u2265 . . .\u2265 cn+1, (Wj)j\u2208[n], p\u0304\u2208R n, k\u2265 0, \u03c0 \u2208 {0,1}n\u00d7n\n1: A1\u2190 0 2: for i\u2190 2 to n do\n3: for l\u2190 1 to i\u2212 1 do\n4: if i\u2212 l > k\u2212 1 then 5: Ul\u2190min\u03b1,z { (k\u2212 1)\u03b1+ \u2211i\u22121 \u03c3=l z\u03c3 : z\u03c3 +\u03b1\u2265 \u2211n j=1 \u03c0\u03c3j p\u0304j, z\u03c3 \u2265 0 \u2200\u03c3 \u2208 [l, i\u2212 1] } 6: else 7: Ul\u2190 \u2211i\u22121\n\u03c3=l \u2211n j=1 \u03c0\u03c3j p\u0304j\n8: Ai\u2190\n(\nmaxl\u2208[i\u22121]Al +Ul\u2212 n\u2211\nj=1\n\u03c0ijWj\n)+\n9: return (A1, . . . ,An)\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 17\nThe ASAP rule can be considered a generalization of the well-known Bailey-Welch rule, which schedules the first two customers simultaneously and all subsequent customers sequentially. In Line 8, each customer is scheduled to arrive at time 0 as long as the latest possible completion times of the previous customers are not longer than their waiting time guarantee. If this condition is no longer met, customers are scheduled sequentially. In particular, the maximum waiting time guarantees control how many customers can be scheduled at the start time of the planning horizon."
        },
        {
            "heading": "4.3. Optimal Interappointment Times for Varying Costs and No-Show Rates",
            "text": "In the literature, empirical studies on optimal interappointment times are commonly pursued in settings where analytical approaches face significant challenges. Accordingly, while we have proven optimality of the ASAP scheduling rule for the case of non-increasing costs, we derive further insights for the case of increasing costs by analyzing optimal interappointment times. The optimal schedules are computed using Gurobi and illustrated by the example of ten identical customers, each with a minimum service time of 15 minutes, a maximum service time of 25 minutes, and a waiting time guarantee of 30 minutes.\nIn the cases of non-increasing idle time costs, we observe in Figure 1 that the optimal interappointment times follow variants of the well-known plateau dome shape (Denton and Gupta 2003, Robinson and Chen 2003, Kong et al. 2020, Sang et al. 2021). Specifically, interappointment times initially increase, followed by a plateau of constant interappointment times, and non-increasing\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 18\ninterappointment times towards the end of the planning horizon. We provide a detailed explana-\ntion and generalize these findings for all cases with non-increasing idle time costs in the Online\nAppendix, employing the ASAP scheduling rule. The complexity observed in the case of increasing\ncosts supports the hypothesis from Remark 7 that establishing optimal scheduling rules in this\nscenario is more complex."
        },
        {
            "heading": "5. Computational Study",
            "text": "In this section, we evaluate the performance of RASWTG schedules on a real-world data set from\nthe radiology department of a large university hospital. In particular, we analyze runtimes, conduct\na sensitivity analysis, and present managerial insights from comparing waiting times, idle times,\nand overtime obtained with RASWTG to those obtained with a weighted sum approach. We use\nthe standard time notation mm:ss, where mm denotes the number of completed minutes and ss\nthe number of completed seconds since the start of the minute."
        },
        {
            "heading": "5.1. Instances",
            "text": "We generate test instances based on 7,745 CT examination records performed on one of three\nCT machines in the radiology department of a large university hospital in Munich, Germany. All\nexams were performed in 2019 or the first quarter of 2020. For each CT examination, we have\nthe following information: Exam type, exam day, start time, and completion time. The start and\ncompletion times were recorded as so-called \u201cModality Performed Procedure Steps\u201d. That is, they\ndo not include setup times before and after the irradiation procedure, such as preparing the patient\nat the unit or removing the patient from the unit, but only the scanning time. Service times are\ncalculated as the difference between completion time and start time.\nWe first split the data into an interval estimation set and a test set. The interval estimation\nset consists of all 6,359 CT examinations recorded in 2019; the test set consists of all 1,386 CT\nexaminations recorded in the first quarter of 2020. The interval estimation set is used to estimate\nthe service time intervals for the examinations in the test set. Specifically, for each of the 64\nexamination types, we estimate the minimum and maximum service time as the 5th and 90th\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 19\npercentiles of the empirical distribution of service times within the interval estimation set. We\ntested that this choice ensures meeting the waiting time guarantees for nearly all patients while\nalso resulting in reasonable total costs. We then compute schedules for the examination requests\nrecorded in the test set using these service time interval estimates. In case of multiple optimal\nsolutions, we choose one that minimizes the sum of appointment times in accordance with the\nASAP rule. The schedules are evaluated using the service times recorded in the test set and a\nrandom sample of n\u2212 k no-shows.\nTo generate test instances, we consider four factors: number of patients, level of no-shows, waiting\ntime guarantees, and structure of the idle time costs. In a ceteris paribus design, we systematically\nvary these factors using three values each, as outlined in Table 2. Further insights into the rationale\nbehind selecting these factors are available in the following and the Online Appendix D.1. Unless\nspecified otherwise, our analysis centers on the base case characterized by bold values, encompassing\nconstant idle time costs, ten patients who all show up, and a maximum waiting time guarantee of\n30 minutes.\nset that contain at least n appointments. Subsequently, we randomly sample n consecutive patient\nrecords from these days. This process generates 252 instances across all classes with five patients,\n107 instances across all classes with ten patients, and 39 instances across all classes with twenty\npatients.\nWe differentiate three types of idle time costs: constant, decreasing, and increasing. Constant\nidle time costs (ci)i\u2208[n] remain fixed at ci = 1 for all i \u2208 [n+ 1]. Decreasing idle time costs follow three assumptions: Idle time before the first appointment incurs a per-unit time cost of 1, idle time\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 20\nafter the last appointment, fully utilized by staff for tasks like documentation, incurs a per-unit\ntime cost of only 0.5, and costs linearly decrease between the first and last idle time. This results in ci = 1\u2212 i\u22121 2n for idle time before appointment i\u2208 [n+1]. For completeness, we also consider linearly increasing idle time costs with ci = n+i\u22121\n2n , i \u2208 [n+ 1]. Overtime cost, complying with current US\nfederal law requiring a minimum of 1.5 times the regular pay rate, is set at co =1.25.\nFinally, the length L of the planning horizon crucially impacts the trade-off between idle time\ncost and overtime cost. A short planning horizon may cause significant worst-case overtime, while\nan extended one may lead to no overtime but substantial idle time. For a comprehensive evaluation\nof the model, we set the length of the planning horizon for each instance to a specific time between\nthe earliest and latest possible completion times of the last appointment, accommodating both idle\ntime and overtime. Specifically, L is chosen as the sum of maximum service times minus the waiting\ntime guarantee for the last appointment. For instances with zero no-shows and a waiting time\nguarantee of 30 minutes, the resulting average planning horizon is 50:05 minutes for five patients,\n132:08 minutes for ten patients, and 312:32 minutes for twenty patients. The average cumulative\nuncertainty within this horizon, obtained as the sum of the service time interval lengths, amounts\nto 46:53 minutes for five patients, 91:02 minutes for ten patients, and 178:09 minutes for twenty\npatients, and accordingly higher in the case of no-shows."
        },
        {
            "heading": "5.2. Runtimes",
            "text": "In Table 3, we report the average runtimes to compute an optimal schedule using the polynomial-\ntime algorithm (PTA) that results from first applying Lemma 2 and then Algorithm 1 in the case\nof constant idle time costs and zero no-shows, the mixed-integer program RASWTG-0 for the case\nof zero no-shows, and the general mixed-integer program RASWTG. All experiments have been\nperformed on an Intel Core i7-10510U 1.8 GHz machine (in 64-bit mode) with 16 GB memory\nunder Microsoft Windows 10 and Gurobi 9.5.0 in Python 3.9.0.\nIn the case of zero no-shows and constant idle time costs, our polynomial-time algorithm effi-\nciently computes optimal schedules in milliseconds, even for a substantial number of patients.\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 21\nWhen there are zero no-shows but non-constant idle time costs, we employ the mixed-integer linear program RASWTG-0. With this model, Gurobi finds optimal schedules within seconds for up to 10 patients and within 200 seconds for 20 patients.\nFor the case of a positive number of no-shows, we utilize the mixed-integer linear program RASWTG to calculate optimal schedules. Computation times increase noticeably with higher patient numbers and no-show rates. The model remains computationally tractable for 10 patients. For situations involving 20 patients and a positive number of no-shows, Gurobi solves (almost) no instance within a one-hour time limit. This underscores the need for future research to develop scalable algorithms for addressing the robust appointment scheduling problem with no-shows. Furthermore, our experimental results support the conjecture from Section 4 that decreasing idle time costs lead to simpler optimal solution structures than increasing idle time costs. 5.3. Results We first conduct a sensitivity analysis and then compare the results with those obtained by minimizing a weighted sum of waiting times, idle times, and overtime.\n5.3.1. Sensitivity Analysis. We assess the impact of each of the four factors listed in Table 2 on waiting times, idle times, and overtime, from which we derive practical managerial recommen-\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 22\ndations. To comprehensively understand the dynamics, we recall the trade-offs between waiting time and idle time until the last appointment, and the trade-off between overtime and idle time following the last appointment.\nBase Case. In the base case, the average waiting time per patient is 10:55 minutes, and the waiting time guarantees are met for 97% of the patients. The slight discrepancy from 100% is due to the estimation of minimum and maximum service times derived from empirical service time data in the separate interval estimation set, excluding outliers. In cases where realized service times are outside the estimated range, the waiting time guarantees of a few later patients are unmet. Furthermore, the average total idle time amounts to 37:40 minutes and overtime to 1:46 minutes, relative to an average cumulative uncertainty of 91:02 minutes. Figure 2 illustrates the distribution of waiting and idle times by appointment.\nNumber of Patients. Table 4 summarizes our findings regarding waiting times, idle times, and overtime across a varying number of patients. Generally, as the number of patients in the planning horizon increases, the RASWTG approach leads to shorter waiting times and longer idle times (see Online Appendix, Section D.2). Moreover, given our choice of the planning horizon L, overtime decreases as the number of patients rises.\nNo-Shows. Table 5 demonstrates that higher no-show rates correspond to enhanced adherence to waiting time guarantees and slightly increased overtime. Total idle time is not significantly affected by higher no-show rates, which highlights the model\u2019s performance with no-shows. Looking at the increase from 0% to 10% and from 10% to 20%, waiting times on average decrease by 1:08 minutes, and the fulfillment of waiting time guarantees increases by 1.14%. This pattern is driven by the elevated planning uncertainty associated with higher no-show rates, prompting the conservatism\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 23\nof RASWTG, which ensures that all waiting time guarantees are met even if exactly the patients included in the worst-case scenario for waiting times show up. Moreover, a 10% increase in the no-show rate leads to a 0:42-minute rise in overtime, attributed to the planning horizon choice dependent on the number of show-ups. Finally, it is important to note that the RASWTG approach relies on precise predictions of the number of no-shows. If practitioners cannot accurately forecast this number, we recommend underestimating the total number of no-shows to ensure the fulfillment of all waiting time guarantees.\nWaiting Time Guarantees. Practitioners should tailor waiting time guarantees to align with their customers\u2019 waiting time tolerance levels. Figure 2a illustrates how waiting and idle times vary across the planning horizon for different waiting time guarantee choices. Table 5 shows the corresponding total idle time, average waiting times, and adherence to the waiting time guarantee.\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 24\nIncreasing the waiting time guarantee by 10 minutes, on average, improves the fulfillment of the\nwaiting time guarantee by 1.90%, boosts capacity utilization by 18.44%, and maintains stability\nin terms of overtime. This substantial capacity utilization increase results from greater flexibility\nin terms of the waiting time constraints and, correspondingly, a shorter overall planning horizon.\nIdle Time Costs. The idle time costs control whether idle times occur rather early or late in the\nplanning horizon and, oppositely, whether waiting times occur rather early or late. Decreasing idle\ntime costs, by definition, particularly avoid early idle times. Thus, idle times predominantly occur\nlater in the planning horizon, as can be seen in Figure 2b for the base case. The opposite is true\nfor increasing idle time costs. Constant idle time costs do not define a preference for when idle\ntime occurs. Notably, both total idle time and overtime are highest in the case of increasing idle\ntime costs and significantly lower and closely aligned for constant and decreasing idle time costs.\nThis observation suggests that the simple greedy rule which utilizes capacities as early as possible\nproves effective when minimizing total idle time. Furthermore, constant and decreasing idle time\ncosts lead to later and, thus, potentially more productively usable idle times.\n5.3.2. Comparison to a Weighted Sum Approach. In this section, we compare waiting\ntimes, idle times, and overtime acquired using RASWTG in contrast to those obtained using a\nweighted sum approach. Unless stated otherwise, we use the RASWTG approach in the base case\nsetting. In particular, we assume that all patients show up. We refer to the following problem as\nWeighted Sum Robust Appointment Scheduling Problem (WSRAS).\nmin \u03c0,A U (18)\ns.t.U \u2265 n+1\u2211\ni=1\nci (Ai\u2212Ci\u2217,i\u22121) + +\nn\u2211\ni=1\ncw (Ci\u2217,i\u22121\u2212Ai) + + co (Ci\u2217n\u2212L) + \u2200i\u2217 \u2208 [n+1] (19)\nCi\u2217i =max{Ai,Ci\u2217,i\u22121}+\n     \u2211n j=1 \u03c0ij \u00af pj, i < i \u2217\n\u2211n j=1 \u03c0ij p\u0304j, i\u2265 i \u2217\n\u2200i\u2217 \u2208 [n+1] (20)\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 25\nn\u2211\nj=1\n\u03c0ij =1, n\u2211\ni=1\n\u03c0ij =1 \u2200i, j \u2208 [n] (21)\nA1 =0,An+1 =L,Ci\u22170 = 0 \u2200i \u2217 \u2208 [n+1] (22)\nThe Objective Function (18) minimizes the upper bound on total cost, as established in Con-\nstraint (19). Specifically, Constraint (19) upper bounds the sum of waiting times, weighted by constant cost cw, idle times, weighted by sequence-dependent cost ci, and overtime, weighted by co; while ensuring robustness with respect to the same worst-case scenarios as RASWTG (see Theo-\nrem 2). Constraint (20) defines the completion times, while Constraint (21) reflects the assignment constraint known from the Robust Appointment Scheduling Problem with Waiting Time Guarantees. To enhance our understanding of optimal WSRAS schedules, we briefly explore optimal\ninterappointment times, as illustrated in Figure 6 in the Online Appendix.\nNotably, Mittal et al. (2014) study a related robust appointment scheduling problem that minimizes a weighted sum of idle time and waiting time costs under a collective worst-case scenario. Our works show, independently of each other and with different objective functions, that it is\nsufficient to consider the same n+1 critical service time scenarios (see Theorem 2).\nWaiting Times. We compare, first, how to control waiting times with both approaches and, second, the distribution of waiting times across all appointments. Applying the weighted sum\napproach, we need to carefully tune the waiting time costs to manage waiting times. In contrast,\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 26\nwhen applying RASWTG, the waiting time guarantees constitute input parameters which (a priori)\nlimit all worst-case waiting times, and indirectly also the realized waiting times. It is therefore\neasier to control waiting times with RASWTG than with the weighted sum approach.\nIn addition, Figures 3 and 4 present boxplots illustrating patient waiting times depending on\ntheir position in the appointment schedule. These waiting times correspond to the optimal inter-\nappointment intervals depicted in Figure 6 in the Online Appendix. Notably, for modest waiting\ntime costs (cw), waiting times with the weighted sum approach exhibit an increasing trend until the penultimate or last appointment, and excessive waiting times for some later appointments.\nHigh waiting time costs lead to very short waiting times for all appointments. In contrast, the\nRASWTG approach demonstrates an initial (limited) increase in waiting times followed by a grad-\nual decrease. It is worth mentioning that this decline can be mitigated by introducing uncertainty\nbudgets. Furthermore, for comparable overall costs, waiting times are distributed more equitably\nacross appointments with RASWTG, and excessive waiting times are less likely.\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 27\nCosts. We finally evaluate the cost of replacing the weighted sum approach with RASWTG. We consider that a healthcare provider replaces WSRAS schedules with fixed waiting time cost (i) cw = 0.00001, (ii) cw = 0.1, and (iii) cw = 1 over all days. Our findings are summarized in Table 6.\nLet us first examine overtime. For WSRAS, we observe that overtime decreases with lower waiting time costs, as lower waiting costs allow for scheduling appointments earlier. Surprisingly, RASWTG exhibits the lowest overtime, on average only 1:46 minutes. This suggests that, even with hard waiting time constraints, RASWTG permits slightly earlier scheduling of the last appointment even compared to the weighted sum approach with low waiting time cost. Overall, both approaches maintain reasonable average overtime within a 1 to 7-minute range, and minimal with RASWTG.\nConsidering total idle time, we find that it naturally increases with rising waiting time costs for WSRAS. RASWTG displays the lowest total idle time, a result consistent with our findings regarding overtime. It is worth noting that idle time for both approaches could be reduced by opting for a shorter planning horizon L but at the expense of increased overtime, which we aimed to prevent in the first place. However, as a substantial amount of idle time remains between the last appointment and the end of the planning horizon L for both approaches, we also compare the idle time up to the last appointment, which is less dependent on the choice of L. Again, for all waiting time costs except for cw = 0.00001, which comes with excessive waiting times, RASWTG yields lower idle time than WSRAS.\nWe conclude with the following rule of thumb. In environments where most customers experience acceptable waiting times, introducing RASWTG offers both a priori waiting time guarantees and total cost reduction. The cost reduction typically comes with a limited increase in average waiting times. In environments where many customers experience excessive waiting times, introducing RASWTG effectively prevents excessive waiting times with a minimum increase in total worst-case cost. In all cases, RASWTG effectively mitigated excessive waiting times and overtime."
        },
        {
            "heading": "6. Conclusion",
            "text": "This work was motivated by the lack of intraday appointment scheduling and sequencing approaches to precisely control waiting times. We introduce maximum waiting time guarantees to respect\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 28\ncustomers\u2019 waiting time tolerance even in a worst-case scenario of uncertain service times and no-shows. Hence, the established guarantees prevent negative effects of waiting times on customer dissatisfaction, perceived service quality, and loyalty shown in previous empirical research. At the same time, we minimize worst-case costs incurred by idle time and overtime.\nWe show that the presented appointment scheduling problem with waiting time guarantees is NP-hard and find optimal scheduling and sequencing rules in polynomial time for practically relevant special cases. Assuming constant idle time costs and zero no-shows, we show optimality of a sequencing rule that schedules customers in ascending order with the amount of uncertainty about their service times and their waiting tolerance. This rule provides a deeper understanding of the optimality of the well-known SVF rule and extends it to consider waiting time guarantees. Moreover, for the case of non-increasing idle time costs, we show optimality of the ASAP scheduling rule that sets each appointment time as early as possible while fulfilling the waiting time guarantees. The presented sequencing and scheduling rules are intuitive and easy to implement.\nOur case study with real data from the radiology department of a large hospital shows that robust appointment scheduling with waiting time guarantees not only prevents excessive waiting times. Compared to weighted sum approaches, our approach also provides more flexibility to control the timing of idle and waiting times. Most importantly, we introduce the waiting time guarantees with a minimal increase in worst-case costs, which in many cases is even negative. Thus, compared to weighted sum approaches, waiting time guarantees can even reduce costs without increasing the waiting time of the longest waiting customer.\nOur work also points to several avenues for future research. First, an intriguing open question involves introducing uncertainty budgets to control the level of conservatism, and adapting the presented scheduling and sequencing rules. Second, it would be interesting to integrate individual no-show predictions into our robust framework. Third, the concept of minimizing costs under robust service levels is applicable to any service in which customer disutility increases sharply upon surpassing a critical threshold. Identifying such services and studying the corresponding problem variants seems promising.\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 29"
        },
        {
            "heading": "Appendix. Online Supplement",
            "text": "Index sets: i\u2208 [n] appointments (sorted in the order of service receipt)\nj \u2208 [n] customers\nScenarios: p\u2208P service times\n\u03bb\u2208\u039bk no-shows\nParameters: L length of the planning horizon\nk number of customers showing up\nWj waiting time guarantee for customer j\nci unit cost for idle time before appointment i co unit cost for overtime\nVariables: Ai appointment time of appointment i\nCi completion time of appointment i\n\u03c0ij assignment of customer j to appointment i\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n33"
        },
        {
            "heading": "A. Proofs",
            "text": "This section of the appendix contains the proofs for the results presented in the main part of this paper. In contrast to the main part, where the findings were organized for ease of understanding and applicability, here we structure the proofs to build upon previously established results.\nFirst, we reformulate the definition of completion times, adopting a non-recursive computation approach. This reformulation allows for an essential transformation of idle times into non-negative blocks. Additionally, the reformulation of completion times facilitates to prove a crucial decomposition of worst-case scenarios for cost maximization, dividing them into two parts: the first one maximizing idle time and the other maximizing overtime. We demonstrate that considering n+1 service time scenarios is sufficient to maximize worst-case costs, and effectively linearize the search for corresponding worst-case no-show scenarios. By leveraging these findings, we establish the ASAP scheduling rule, followed by the SVF-WTG sequencing rule, and ultimately prove NP-hardness.\nLemma 3. For any service time scenario p \u2208 P and no-show scenario \u03bb \u2208 \u039bk, the completion time of\nappointment i\u2208 [n] equals\nCi = max l\u2208[1,i]\n(\nAl +\ni\u2211 k=l n\u2211 j=1 \u03c0kj\u03bbjpj\n)\n. (23)\nProof of Lemma 3. We prove by induction that the recursive computation of the com-\npletion times max{Ai,Ci\u22121} + \u2211n j=1 \u03c0ij\u03bbjpj is equivalent to the maximization problem maxl\u2208[1,i] ( Al + \u2211i\n\u03c3=l \u2211n j=1 \u03c0\u03c3j\u03bbjpj\n)\n. For i = 1, the terms are equivalent. Suppose the claim is true\nfor all appointments 1, . . . , i \u2212 1. Then the recursive definition of the completion time for appointment i is equivalent to max {\nAi,maxl\u2208[1,i\u22121]\n(\nAl + \u2211i\u22121\n\u03c3=l \u2211n j=1 \u03c0\u03c3j\u03bbjpj\n)}\n+ \u2211n\nj=1 \u03c0ij\u03bbjpj . Taking the last\nsummand into the maximization problem renders this equivalent to the above maximization problem.\nProof of Lemma 1 (page 13). Given a customer sequence \u03c0, appointment times A, and waiting time\nguarantees W1, . . . ,Wn, it clearly holds\nmax p\u2208P,\u03bb\u2208\u039bk\u22121\n{\nmax i\u2208[n]\n{\nCi\u22121(A,\u03c0, p, \u03bb)\u2212Ai\u2212 n\u2211\nj=1\n\u03c0ijWj\n}}\n\u2264max i\u2208[n]\n{\nmax p(i)\u2208P,\u03bb(i)\u2208\u039bk\u22121\n{\nCi\u22121(A,\u03c0, p (i), \u03bb(i))\u2212Ai\u2212\nn\u2211 j=1 \u03c0ijWj\n}}\n.\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n34\nAssume the inequality holds strictly (i.e., with \u201d<\u201d). Let i\u2217, p\u2217, \u03bb\u2217 maximize the right-hand side. Then, for\nany A\u2265 0, we obtain\nCi\u2217\u22121(A,\u03c0, p \u2217, \u03bb\u2217)\u2212Ai\u2217 \u2212\nn\u2211 j=1 \u03c0i\u2217jWj\n\u2264max i\u2208[n]\n{\nCi\u22121(A,\u03c0, p \u2217, \u03bb\u2217)\u2212Ai\u2212\nn\u2211 j=1 \u03c0ijWj\n}\n\u2264 max p\u2208P,\u03bb\u2208\u039bk\u22121\n{\nmax i\u2208[n]\n{\nCi\u22121(A,\u03c0, p, \u03bb)\u2212Ai\u2212 n\u2211\nj=1\n\u03c0ijWj\n}}\n<max i\u2208[n]\n{\nmax p(i)\u2208P,\u03bb(i)\u2208\u039bk\u22121\n{\nCi\u22121(A,\u03c0, p (i), \u03bb(i))\u2212Ai\u2212\nn\u2211 j=1 \u03c0ijWj\n}}\n=Ci\u2217\u22121(A,\u03c0, p \u2217, \u03bb\u2217)\u2212Ai\u2217 \u2212\nn\u2211 j=1 \u03c0i\u2217jWj,\nwhich is a contradiction.\nLemma 4. Let \u03c0 be an assignment, (Ai)i\u2208[n] appointment times, p\u2208P a service time scenario, and \u03bb \u2208\u039bk a no-show scenario. Moreover, let {i \u2208 [n] : (Ai \u2212Ci\u22121)> 0}= {i1, . . . , ir}=: I with i1 \u2264 . . .\u2264 ir denote the index set of appointments before which positive idle time occurs. Then the idle time cost \u2211n+1\ni=1 ci(Ai\u2212Ci\u22121) +\nis equivalent to r\u22121\u2211\nl=1\n(cil \u2212 cil+1)Ail + cirAir \u2212 ci1A1\u2212 r\u2211\nl=1\ncil\nil\u22121\u2211\n\u03c3=il\u22121\n\u03bb\u03c3p\u03c3.\nProof of Lemma 4. Assume w.l.o.g. that \u03c0 = id. For each i \u2208 I, let l(i) denote the smallest index such\nthat Ci\u22121 =Al(i) + i\u22121\u2211\n\u03c3=l(i)\np\u03c3\u03bb\u03c3 (see Lemma 3).\nWe show that l(ij) = ij\u22121 for all j \u2208 [r], j \u2265 2, via a proof by contradiction. First assume that l(ij+1)< ij, and for the purpose of simpler notation, let w.l.o.g. j = 2. On the one hand, Theorem 3 implies that Ci2\u22121 \u2265 Ai1 + \u2211i2\u22121 \u03c3=i1 p\u03c3\u03bb\u03c3. On the other hand, it holds that Ci2\u22121 = Al(i2) + \u2211i1\u22121 \u03c3=l(i) p\u03c3\u03bb\u03c3 + \u2211i2\u22121 \u03c3=i1 p\u03c3\u03bb\u03c3 \u2264 Ci1\u22121 + \u2211i2\u22121 \u03c3=i1 p\u03c3\u03bb\u03c3. Together, it follows that Ci1\u22121 \u2265Ai1 , a contradiction to i1 \u2208 I. Therefore, l(i2)\u2265 i1. Now assume that l(i2) > i1. On the one hand, as l(i2) is the smallest index with the above property, it must hold that Ci2\u22121 > Ai1 + \u2211i2\u22121 \u03c3=i1 p\u03c3\u03bb\u03c3. On the other hand, because now l(i2) /\u2208 I, it holds that Ai \u2264 Ci\u22121 for all i \u2208 [i1 + 1, l(i2)] and therefore Ci2\u22121 = Al(i2) + \u2211i2\u22121 \u03c3=l(i2) p\u03c3\u03bb\u03c3 \u2264 Cl(i2)\u22121 + \u2211i2\u22121 \u03c3=l(i2) p\u03c3\u03bb\u03c3 = max{Cl(i2)\u22122,Al(i2)\u22121}+ \u2211i2\u22121 \u03c3=l(i2)\u22121 p\u03c3\u03bb\u03c3 \u2264 . . . \u2264 Ai1 + \u2211i2\u22121 \u03c3=i1 p\u03c3\u03bb\u03c3. Together this yields the contradiction Ai1 \u2265Ci2\u22121\u2212 \u2211i2\u22121 \u03c3=i1 p\u03c3\u03bb\u03c3 >Ai1 , from which it finally follows that l(i2) = i1.\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n35\nThe above argument for l(i2)\u2264 i1 can be equivalently applied to show that l(i1) = 1, so we define i0 := 1.\nAltogether, this yields:\nn+1\u2211 i=1 ci (Ai\u2212Ci\u22121) +\n(24)\n=\nr\u2211 l=1 cil (Ail \u2212Cil\u22121) (25)\n=\nr\u2211 l=1 cil\n Ail \u2212Ail\u22121 \u2212 il\u22121\u2211\nk=il\u22121\npk\u03bbk\n  (26)\n= r\u22121\u2211\nl=1\n( cil \u2212 cil+1 ) Ail + cirAir \u2212 ci1Ai0 \u2212\nr\u2211 l=1 cil il\u22121\u2211\n\u03c3=il\u22121\n\u03bb\u03c3p\u03c3 (27)\nProof of Theorem 2 (page 10). We show that any service time scenario that maximizes total cost can be decomposed into two parts: the first one maximizing idle time and the second one maximizing overtime. Assume w.l.o.g. that \u03c0 = id.\nFirst, using the reformulation of the completion times from Lemma 3, we find:\nn+1\u2211 i=1 ci (Ai\u2212Ci\u22121(\u03c0,A, p, \u03bb)) + + co (Cn(\u03c0,A, p, \u03bb)\u2212An+1) + (28)\n= n\u2211\ni=1\nci (Ai\u2212Ci\u22121(\u03c0,A, p, \u03bb)) + +max{cn+1 (An+1\u2212Cn(\u03c0,A, p, \u03bb)) , co(Cn(\u03c0,A, p, \u03bb)\u2212An+1)} (29)\n=c1A1 +\nn\u2211 i=2 ci\n(\nAi\u2212 max l\u2208[i\u22121]\n{\nAl +\ni\u22121\u2211 k=l \u03bbkpk\n})+\n(30)\n+max\n{\ncn+1\n(\nAn+1\u2212max l\u2208[n]\n{\nAl +\nn\u2211 k=l \u03bbkpk\n})\n, co\n(\nmax l\u2208[n]\n{\nAl +\nn\u2211 k=l \u03bbkpk\n}\n\u2212An+1\n)}\n(31)\nNow, let \u03bb \u2208 \u039bk and let the service time scenario popt \u2208 P maximize total cost\n\u2211n+1 i=2 ci (Ai\u2212Ci\u22121(\u03c0,A, p, \u03bb)) + + co (Cn(\u03c0,A, p, \u03bb)\u2212An+1) + . We distinguish the following two cases.\nCase 1: An+1\u2212Cn(\u03c0,A, popt, \u03bb)\u2265 0. In this case, overtime cost equals zero. Therefore, setting popti to pi for each i\u2208 [n] will lead to an equal or\nhigher value of (30)\u2013(31).\nCase 2: Cn(\u03c0,A, p opt, \u03bb)\u2212An+1 \u2265 0. In this case, there are non-negative overtime costs. Let l\u2217 \u2208 [n] chosen minimally such that\nCn(\u03c0,A, p opt, \u03bb) = Al\u2217 + \u2211n k=l\u2217 \u03bbkp opt k . In particular, it is easy to see that idle time cannot occur after the l\u2217th appointment. Then setting popti to p\u0304i for all i\u2265 l \u2217 and to p\ni for all i\u2264 l\u2217\u2212 1 will again lead to an equal\nor higher value of (30)\u2013(31).\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n36\nRemark 6 (Additional Mixed-Integer Linear Reformulation Techniques). For each i\u2217 \u2208 {0, . . . , n+1} and i\u2208 [n], let zi\u2217i \u2208 {0,1} be auxiliary binary variables and M \u2265maxi\u2208[n]max{Ai,Ci\u2217,i\u22121} an upper bound for the latest realized start time of any appointment, for example, M :=A1 + \u2211n j=1 p\u0304j. Then Ci\u2217i =max{Ai,Ci\u2217i\u22121}+ \u2211n\nj=1 \u03bbi\u2217ij \u00af pj can be linearized as follows:\nCi\u2217i \u2265Ai + n\u2211\nj=1\n\u03bb (i\u2217,1) ij\n\u00af pj \u2200i\u2208 [n] (32)\nCi\u2217i \u2265Ci\u2217,i\u22121 + n\u2211\nj=1\n\u03bb (i\u2217,1) ij\n\u00af pj \u2200i\u2208 [n] (33)\nCi\u2217i \u2264Ai + n\u2211\nj=1\n\u03bb (i\u2217,1) ij\n\u00af pj + zi\u2217iM \u2200i\u2208 [n] (34)\nCi\u2217i \u2264Ci\u2217,i\u22121 + n\u2211\nj=1\n\u03bb (i\u2217,1) ij\n\u00af pj +(1\u2212 zi\u2217i)M \u2200i\u2208 [n] (35)\nProof of Theorem 3 (page 16). It is straightforward to see that Algorithm 1 runs in polynomial time with\nthe fact that line 5 in Algorithm 1 constitutes a linear program with only O(n) variables and constraints.\nThe waiting time constraints enforce that Ai \u2265 ( maxl\u2208[i\u22121]Al +Ul\u2212 \u2211n j=1 \u03c0ijWj )+ for all i \u2208 [2, n]. We\nnow show that, if A1 = 0, then Ai = ( maxl\u2208[i\u22121]Al +Ul\u2212 \u2211n j=1 \u03c0ijWj )+ for i \u2208 [2, n] is an optimal solution in the case of non-increasing idle time costs.\nLet A\u2217 be optimal appointment times with A\u2217i\u2032 > ( maxl\u2208[i\u2032\u22121]A \u2217 l +Ul\u2212 \u2211n j=1 \u03c0i\u2032jWj )+ for some i\u2032 \u2208 [2, n]. As ci\u22121 \u2212 ci \u2265 0 for all i \u2208 [2, n], and using the cost reformulation 24\u201327 in the proof of Lemma 4 with corresponding index set I, we distinguish the following two cases. Firstly, if i\u2032 \u2208 I, then choosing A\u2217i\u2032 = (\nmaxl\u2208[i\u2032\u22121]A \u2217 l +Ul\u2212 \u2211n j=1 \u03c0i\u2032jWj\n)+\nleads to a better objective value, contradicting the optimality of A\u2217.\nSecondly, if i\u2032 \u2208 I, then choosing A\u2217i\u2032 = ( maxl\u2208[i\u2032\u22121]A \u2217 l +Ul\u2212 \u2211n j=1 \u03c0i\u2032jWj )+ does not change the optimal solution value. Thus, it is optimal to schedule each appointment time Ai, i \u2208 [n], as early as possible.\nRemark 7 (Increasing idle time costs). The case of increasing idle time costs seems to be more difficult, as a balance must be found between the following strategies. On the one hand, the last appointment should be scheduled as early as possible to avoid both idle time and overtime. On the other hand, later idle\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n37\ntimes are more costly than early idle times and can only be prevented by scheduling later appointments with relatively long worst-case waiting times. To allow for longer worst-case waiting times for later appointments while still fulfilling all waiting time guarantees, early appointments may need to be scheduled later than necessary due to the waiting time constraints. This may delay the appointment time of the last appointment.\nProof of Lemma 2 (page 15). Consider an optimal sequence \u03c0\u2217 that does not adhere to the SVF-WTG\nsequencing rule. Then there exists i\u2032, j\u2032, j\u2032\u2032 \u2208 [n] satisfying \u03c0\u2217i\u2032,j\u2032 , \u03c0 \u2217 i\u2032+1,j\u2032\u2032 = 1 and p\u0304j\u2032 \u2212 \u00af pj\u2032 +Wj\u2032 (1 + co) > p\u0304j\u2032\u2032 \u2212 \u00af pj\u2032\u2032 + Wj\u2032\u2032(1 + co). To establish the optimality of the SVF-WTG sequencing rule, we prove that (iteratively) swapping the positions of customers j\u2032 and j\u2032\u2032 does not increase the optimal worst-case cost maxi\u2217\u2208{0,...,n+1} \u2211i\u2217\ni=1 ci (Ai\u2212 \u00af Ci\u22121(\u03c0\n\u2217,A)) + + co ( Ai\u2217 + \u2211n i=i\u2217 \u03c0 \u2217 ij p\u0304j \u2212L )+ =: opt.\nSince the idle time costs are constant and all customers show up, we know from a special case of Theorem 3\nthat A1 = 0 and Ai = ( \u2211i\u22121\nk=1 \u2211n j=1 \u03c0 \u2217 kj p\u0304j \u2212 \u2211n j=1 \u03c0 \u2217 ijWj\n)+\nare optimal appointment times for i\u2208 [2, n].\nFirst, we consider the costs associated with the case i\u2217 \u2208 {0, n+1}. For i\u2217 = n+1, using the idle time cost\nreformulation 27 from Lemma 4, the total cost is equivalent to cn+1(L\u2212 \u2211n\ni=1 \u2211n j=1 \u03c0\n\u2217 ij \u00af pj), and swapping\nthe position of two customers does not affect this value. For i\u2217 = 0, where there is no idle time, swapping two customers does not affect the value.\nFor each i\u2217 \u2208 [n], the associated cost is \u2211i\u2217\ni=1(Ai\u2212 \u00af Ci\u22121(\u03c0\n\u2217,A))++co ( Ai\u2217 + \u2211n k=i\u2217 \u03c0 \u2217 kj p\u0304j \u2212L ) . Moreover, we\nassume w.l.o.g. that Ai\u2217 = \u2211i\u2217\u22121\nk=1 \u2211n j=1 \u03c0 \u2217 kj p\u0304j\u2212 \u2211n j=1 \u03c0 \u2217 ijWj > 0. Therefore, the total cost becomes \u2211i\u2217 i=1(Ai\u2212\n\u00af Ci\u22121(\u03c0\n\u2217,A))+ + co\n( \u2211n\ni=1 \u2211n j=1 \u03c0 \u2217 ij p\u0304j \u2212 \u2211n j=1 \u03c0i\u2217jWj \u2212L\n)\n. Using again the idle time cost reformulation 27\nfrom Lemma 4, the sequence-dependent value is:\ni\u2217\u2211 i=1 (Ai\u2212 \u00af Ci\u22121(\u03c0 \u2217,A))+\u2212 co n\u2211 j=1 \u03c0\u2217i\u2217jWj\n=Ai\u2217 \u2212 i\u2217\u22121\u2211\nk=1\nn\u2211 j=1 \u03c0\u2217kj \u00af pj \u2212 co n\u2211 j=1 \u03c0\u2217i\u2217jWj\n=\ni\u2217\u22121\u2211 k=1 n\u2211 j=1 \u03c0\u2217kj p\u0304j \u2212 n\u2211 j=1 \u03c0\u2217i\u2217jWj \u2212 i\u2217\u22121\u2211 k=1 n\u2211 j=1 \u03c0\u2217kj \u00af pj \u2212 co n\u2211 j=1 \u03c0\u2217i\u2217jWj\n=\ni\u2217\u22121\u2211 k=1 n\u2211 j=1 \u03c0\u2217kj(p\u0304j \u2212 \u00af pj)\u2212 (1+ co) n\u2211 j=1 \u03c0\u2217i\u2217jWj .\nWe now show that changing the sequence to \u03c0i\u2032,j\u2032\u2032 , \u03c0i\u2032+1,j\u2032 = 1, the cost associated with each i \u2217 \u2208 [n] does\nnot exceed the optimal solution value obtained with \u03c0\u2217.\nFor each i\u2217 > i\u2032 + 1 or i\u2217 < i\u2032, the solution value does not change when changing the sequence to\n\u03c0i\u2032,j\u2032\u2032 , \u03c0i\u2032+1,j\u2032 = 1. For i \u2217 = i\u2032, we find\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n38\ni\u2217\u22121\u2211 k=1 n\u2211 j=1 \u03c0\u2217kj(p\u0304j \u2212 \u00af pj)\u2212 (1+ co) n\u2211 j=1 \u03c0\u2217i\u2217jWj\n=\ni\u2217\u22121\u2211 k=1 n\u2211 j=1 \u03c0\u2217kj(p\u0304j \u2212 \u00af pj)\u2212 (1+ co)Wj\u2032\n<\ni\u2217\u22121\u2211 k=1 n\u2211 j=1 \u03c0\u2217kj(p\u0304j \u2212 \u00af pj)+ p\u0304j\u2032 \u2212 \u00af pj\u2032 \u2212 (p\u0304j\u2032\u2032 \u2212 \u00af pj\u2032\u2032 +Wj\u2032\u2032(1+ co))\n\u2264 i\u2217\u2211\nk=1\nn\u2211 j=1 \u03c0\u2217kj(p\u0304j \u2212 \u00af pj)\u2212Wj\u2032\u2032(1+ co)\n\u2264opt\u2212 co\n( n\u2211\nj=1\np\u0304j \u2212L\n)\nand therefore, changing the sequence to \u03c0i\u2032,j\u2032\u2032 , \u03c0i\u2032+1,j\u2032 = 1 does not increase the optimal solution value for the case of i\u2217 = i\u2032. Finally, for i\u2217 = i\u2032 +1, it is easy to see that switching the position of j\u2032 and j\u2032\u2032 improves the associated costs:\ni\u2217\u22122\u2211 k=1 n\u2211 j=1 \u03c0\u2217kj(p\u0304j \u2212 \u00af pj)+ p\u0304j\u2032 \u2212 \u00af pj\u2032 \u2212 (1+ co)Wj\u2032\u2032\n>\ni\u2217\u22122\u2211 k=1 n\u2211 j=1 \u03c0\u2217kj(p\u0304j \u2212 \u00af pj)+ p\u0304j\u2032\u2032 \u2212 \u00af pj\u2032\u2032 \u2212 (1+ co)Wj\u2032\nWe note that i\u2217 = i\u2032+1 cannot have been the maximizer of the total worst-case cost, as this would contradict the optimality of \u03c0\u2217.\nThus, (iteratively) applying the SVF-WTG rule does not increase the total worst-case cost.\nProof of Theorem 1 (page 9). We establish the NP-hardness of the RASWTG problem for the case that all customers show up, have identical waiting time guarantees W , and the idle time costs satisfy c1 = . . .= c\u03c3 > c\u03c3+1 = . . .= cn for some \u03c3 \u2208 [n\u2212 1] and the overtime cost co = 0. To simplify the notation, let \u01eb be a real number such that L= \u2211n\nj=1 p\u0304j \u2212W + \u01eb=:An+1.\nFirst, we employ Theorem 2 to reformulate the objective function as\nmin\u03c0,A\n{\nmaxi\u2217\u2208{0,...,n+1} \u2211i\u2217\ni=1 ci(Ai\u2212 \u00af Ci\u22121(\u03c0,A))\n+ + co\n(\nAi\u2217 + \u2211n\nk=l\u2217 \u2211n j=1 \u03c0kj p\u0304j \u2212L\n)+ }\n. Since the over-\ntime cost fulfill co =0, it suffices to consider i \u2217 \u2208 {n+1}. Moreover, using Theorem 3, the appointment start times can be calculated as A1 = 0, Ai = ( \u2211i\u22121\nl=1 \u2211n j=1 \u03c0lj p\u0304j\u2212W ) + for i\u2208 {2, . . . , n}. Therefore, the worst-case\ncost equals:\nn+1\u2211 i=2 ci (Ai\u2212 \u00af Ci\u22121(\u03c0,A)) +\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n39\n=\nn+1\u2211 i=2 ci\n( i\u22121\u2211\nk=1\nn\u2211 j=1 \u03c0kj p\u0304j \u2212W \u2212max\n{ i\u22121\u2211\nk=1\nn\u2211 j=1 \u03c0kj \u00af pj, max l\u2208[i\u22121]\n( l\u22121\u2211\nk=1\nn\u2211 j=1 \u03c0kj p\u0304j + i\u22121\u2211 k=l n\u2211 j=1 \u03c0kj \u00af pj\n)\n\u2212W\n})+\n+ cn+1\u01eb\n=\nn+1\u2211 i=2 ci\n(\nmin\n{ i\u22121\u2211\nk=1\nn\u2211 j=1 \u03c0kj(p\u0304j \u2212 \u00af pj)\u2212W, n\u2211 j=1 \u03c0i\u22121,j(p\u0304j \u2212 \u00af pj)\n})+\n\ufe38 \ufe37\ufe37 \ufe38\n:=si\n+cn+1\u01eb\nWe observe that \u2211n\nj=1 \u03c0i\u22121,j(p\u0304j\u2212 \u00af pj)\u2265 0 holds for all i\u2208 [2, n+1] in the second term in si and that si =0\nif \u2211i\u22121\nk=1 \u2211n j=1 \u03c0kj(p\u0304j \u2212\n\u00af pj)\u2212W \u2264 0. Let l\u2217 be the smallest index such that\n\u2211l\u2217\u22121 k=1 \u2211n j=1 \u03c0kj(p\u0304j \u2212\n\u00af pj)\u2212W \u2265 0.\nThen, for all i > l\u2217, it holds that \u2211n\nj=1 \u03c0i\u22121,j(p\u0304j\u2212 \u00af pj)\u2264\n\u2211l\u2217\u22121 k=1 \u2211n j=1 \u03c0kj(p\u0304j\u2212\n\u00af pj)\u2212W +\n\u2211n j=1 \u03c0i\u22121,j(p\u0304j\u2212\n\u00af pj)\u2264\n\u2211i\u22121 k=1 \u2211n j=1 \u03c0kj(p\u0304j \u2212\n\u00af pj)\u2212W. Therefore, the worst-case cost finally becomes:\nn+1\u2211 i=1 ci(Ai\u2212 \u00af Ci\u22121) + (36)\n=cl\u2217\n( l\u2217\u22121\u2211\ni=1\nn\u2211 j=1 \u03c0ij(p\u0304j \u2212 \u00af pj)\u2212W\n)\n+\nn+1\u2211\ni=l\u2217+1\nci\nn\u2211 j=1 \u03c0i\u22121,j(p\u0304j \u2212 \u00af pj)+ cn+1\u01eb. (37)\nNow, we observe that the index l\u2217 is uniquely determined by the two conditions:\n(i) l\u2217\u22121\u2211\ni=1\nn\u2211 j=1 \u03c0ij(p\u0304j \u2212 \u00af pj)\u2212W \u2265 0\n(ii) l\u2217\u22122\u2211\ni=1\nn\u2211 j=1 \u03c0ij(p\u0304j \u2212 \u00af pj)\u2212W < 0\nNotably, even if l\u2217\u22122\u2211\ni=1\nn\u2211 j=1 \u03c0ij(p\u0304j \u2212 \u00af pj)\u2212W = 0, then the worst-case sum of idle time equals (60). Therefore,\nthe RASWTG problem under consideration becomes:\nmin l\u2217\u2208[2,n+1] min \u03c0 cl\u2217\n( n\u2211\nj=1\nl\u2217\u22121\u2211 i=1 \u03c0ij(p\u0304j \u2212 \u00af pj)\n)\n+\nn\u2211 j=1 n\u2211 i=l\u2217+1 \u03c0i\u22121,jci(p\u0304j \u2212 \u00af pj)\u2212 cl\u2217W + cn+1\u01eb (38)\ns.t. W \u2264 l\u2217\u22121\u2211\ni=1\nn\u2211 j=1 \u03c0ij(p\u0304j \u2212 \u00af pj)\u2264W + n\u2211 j=1 \u03c0l\u2217\u22121,j(p\u0304j \u2212 \u00af p j ) (39)\nn\u2211 j=1 \u03c0ij = 1, n\u2211 i=1 \u03c0ij = 1 (40) \u03c0 \u2208 {0,1}n\u00d7n (41)\nWe now reduce the following NP-hard Subset Sum Problem (Garey and Johnson 1979, p. 226) to a variant\nof (38) \u2013 (41).\nmax z\nn\u2211 j=1 \u03b1jzj (42)\ns.t.\nn\u2211 j=1 \u03b1jzj \u2264 \u03b2 (43)\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n40\nz \u2208 {0,1}n (44)\nDefining yj := 1\u2212 zj for all j \u2208 [n], the Subset Sum Problem is equivalent to the following problem. In particular, denoting the optimal value of the Subset Sum Problem by OPTz and the optimal value of the following problem by OPTy, it holds OPTz = \u2211n j=1 \u03b1j \u2212OPTy.\nmin l\u2217\u2208[0,n] min y\nn\u2211 j=1 \u03b1jyj (45)\ns.t.\nn\u2211 j=1 \u03b1j \u2212 \u03b2 \u2264 n\u2211 j=1 \u03b1jyj (46) n\u2211 j=1 yj = l \u2217 (47) y \u2208 {0,1}n (48)\nIf the l\u2217th problem is infeasible, we assign it a huge number. Now, w.l.o.g. (the case l\u2217 = 0 is trivial to\ncheck), the latter problem is equivalent to:\nmin l\u2217\u2208[n] min \u03c0\nl\u2217\u2211 i=1 n\u2211 j=1 \u03b1j\u03c0ij (49)\ns.t.\nn\u2211 j=1 \u03b1j \u2212 \u03b2 \u2264 l\u2217\u2211 i=1 n\u2211 j=1 \u03b1j\u03c0ij (50) n\u2211 j=1 \u03c0ij = 1, n\u2211 i=1 \u03c0ij =1 (51) \u03c0ij \u2208 {0,1} n\u00d7n (52)\nWe can now use the similarity of (49) \u2013 (52) and (38) \u2013 (41). Let \u03b1 and \u03b2 be an instance for (49) \u2013\n(52). For l\u2217 \u2208 [n] choose p\u0304, \u00af p fulfilling p\u0304j \u2212 \u00af pj := \u03b1j for each j \u2208 [n], W :=\nn\u2211 j=1 \u03b1j \u2212 \u03b2, c1 = . . .= cl\u2217 := 1, and\ncl\u2217+1 = . . .= cn+1 := 0. Then solving the l \u2217th subproblem of (49) \u2013 (52) is equivalent to solving the respective (l\u2217 +1)-st subproblem of (38) \u2013 (39). In particular, an optimal solution (iOPT , \u03c0OPT ) also fulfills the second inequality in (39): If for some j \u2208 [n] and l\u2264 iOPT such that \u03c0lj =1 holds \u2211\ni\u2208[1,iOPT ]\\{l}\n\u2211n j=1 \u03b1j\u03c0ij >\nn\u2211 j=1 \u03b1j\u2212\u03b2,\nthen there exists a solution (l\u2217, \u03c0\u2217), l\u2217 < iOPT with smaller solution value, which contradicts the optimality of (iOPT , \u03c0OPT ).\nThus, the problem (38) \u2013 (41), and therefore also the original problem, are NP-hard.\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n41"
        },
        {
            "heading": "B. Mixed-Integer Linear Program",
            "text": "We now derive and present the mixed-integer linear program for the Robust Appointment Scheduling Problem with Waiting Time Guarantees, accounting for 0\u2264 k\u2264 n no-shows. This involves linearizing the adversarial problems related to maximizing waiting time for each customer and the most challenging case of maximizing total cost.\nAdversarial Problem of Maximizing Waiting Times. We first address the problem of describing a\nno-show scenario argmax\u03bb\u2208\u039bk,\u03bbj=1\n{\nmaxl\u2208[1,i\u22121]\n(\nAl + \u2211i\u22121\nk=l \u2211n j=1 \u03c0kj\u03bbj p\u0304j\n)}\nthat maximizes the comple-\ntion time of the last appointment before appointment i \u2208 [n], to which the j-th customer is assigned. Given the inner term Al + \u2211i\u22121\nk=l \u2211n j=1 \u03c0kj\u03bb (i) j p\u0304j \u2212 Ai, l \u2208 [i \u2212 1], i \u2208 [n], in a worst-case no-show sce-\nnario, both the j-th customer and as many as possible but at most k \u2212 1 of the previous i\u2212 l customers show up, namely those with the longest maximum service times. Now, following (Boyd and Vandenberghe 2004, p. 278) for the equivalent max-(k \u2212 1)-sum problem, we can use total unimodularity of the constraint matrix as well as duality to see that the objective value of max\u03bb\u2208\u039bk,\u03bbj=1 \u2211i\u22121 k=l \u2211n j=1 \u03c0kj\u03bbj p\u0304j equals min\u03b1,z\u22650 { (k\u2212 1)\u03b1+ \u2211i\u22121 k=l zk | zk +\u03b1\u2265 \u2211n j=1 \u03c0kj p\u0304j } . Therefore, for all appointments i \u2208 [n], l \u2208 [i\u2212 1] such that i\u2212 l\u2265 k, the waiting time constraints in (2) can be formulated as\nAl + min \u03b1,z\u22650\n{\n(k\u2212 1)\u03b1+ n\u2211\nj=1\nzj |\u03b1+ zj \u2265 n\u2211\nj=1\n\u03c0kj p\u0304j \u2200k \u2208 [l, i\u2212 1]\n}\n\u2212Ai \u2264 n\u2211\nj=1\n\u03c0ijWj . (53)\nAdversarial Problem of Maximizing Cost. The problem of identifying the customers that show up when maximizing total cost is more difficult. This is because a no-show not only incurs costs proportional to the customer\u2019s service time but also involves sequence-dependent idle time and overtime costs. To tackle this issue, the following lemma characterizes a worst-case no-show scenario structure. Specifically, it becomes sufficient to consider, for each i\u2217 \u2208 {1, . . . , n+1}, a no-show scenario in which, among the customers scheduled for the last n\u2212 i\u2217+1 appointments, those with the longest maximum service times show up. If k > n\u2212 i\u2217+1, all customers scheduled for these last appointment show up. Additionally, among the customers scheduled for the first i\u2217 \u2212 1 appointments, the k \u2212 (n\u2212 i\u2217 + 1) ones with the smallest product of idle time cost and minimum service time show up.\nLemma 5. Let i\u2217 \u2208 {1, . . . , n+ 1}. For any no-show scenario \u03bb \u2208 \u039bk and appointment i \u2208 [n], let c(i) := cmin{l\u2208[i,n]:Al\u2212 \u00af Cl\u22121(\u03c0,A,\u03bb)>0} denote the unit idle time cost of the next appointment before which a positive\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n42\namount of idle time is incurred under minimum service times \u00af p. If no idle time is incurred for any of these appointments, then we choose c(i) :=maxl\u2208[n] cl.\nThen \u03bb \u2208 \u039bk maximizes the total cost \u2211i\u2217\ni=1 ci(Ai \u2212 \u00af Ci\u22121(\u03c0,A,\u03bb))\n+ + co (Ai\u2217 + \u2211n k=i\u2217 \u03c0kj\u03bbj p\u0304j \u2212L) + if \u03bb\nfulfills the following conditions. In case that k\u2264 n\u2212 i\u2217+1, then \u03bbj = 1 for any j \u2208 [n] implies that \u2211n i=i\u2217 \u03c0ij p\u0304j is among the k largest components of ( \u2211n\ni=i\u2217 \u03c0ij p\u0304j)j\u2208[n]. In case that k > n \u2212 i \u2217 + 1, then it must hold\n\u2211n j=1 \u03c0ij\u03bbj = 1 for all i\u2265 i \u2217, and if \u03c0ij\u03bbj = 1 for some i < i \u2217 and j \u2208 [n], then c(i)\n\u00af pj is among the k\u2212 (n\u2212\ni\u2217 +1) smallest components of ( \u2211i\u2217\u22121\ni=1 \u03c0ijc(i) \u00af pj\n)\nj\u2208[n] .\nProof of Lemma 5. Following the case distinction in the proof of Theorem 2, it is sufficient to consider\nthe cost function \u2211i\u2217\ni=1 ci(Ai \u2212 \u00af Ci\u22121(\u03c0,A,\u03bb))\n+ + co (Ai\u2217 + \u2211n i=i\u2217 \u03c0ij\u03bbj p\u0304j \u2212L) + for each i\u2217 \u2208 {0, . . . , n+ 1}\nwhen maximizing total cost in the general case. Thus, we show that a no-show scenario \u03bb \u2208 \u039bk maximizes the total cost if \u03bbj = 1 for some j \u2208 [n] implies the following: If k\u2264 n\u2212 i \u2217+1, then \u2211n i=i\u2217 \u03c0ij p\u0304j is among the k largest components of ( \u2211n\ni=i\u2217 \u03c0ij p\u0304j)j\u2208[n]. If k > n\u2212 i \u2217 + 1, then it holds either \u03c0ij = 1 for some i \u2265 i\u2217 or\n\u2211i\u2217\u22121 i=1 \u03c0ijc(i)\n\u00af pj is among the k\u2212 (n\u2212 i\u2217+1) smallest components of\n( \u2211i\u2217\u22121\ni=1 \u03c0ijc(i) \u00af pj\n)\nj\u2208[n] .\nTo show the claim, we use the idle time reformulation from Lemma 4:\ni\u2217\u2211 i=1 ci(Ai\u2212 \u00af Ci\u22121(\u03c0,A,\u03bb)) + + co\n(\nAi\u2217 +\nn\u2211 k=i\u2217 \u03c0kj\u03bbj p\u0304j \u2212L\n)+\n=\nr\u22121\u2211 l=1 (cil \u2212 cil+1)Ail + cirAir \u2212 ci1Ai0 \u2212 r\u2211 l=1 cil il\u22121\u2211\n\u03c3=il\u22121\n\u03bb\u03c3 \u00af p\u03c3 + co\n(\nAi\u2217 +\nn\u2211 k=i\u2217 \u03c0kj\u03bbj p\u0304j \u2212L\n)+\nAs the appointment times are independent of a worst-case no-show scenario for the total idle time cost, the last term is maximized by the no-show scenario described above.\nTo reformulate this result as a mixed-integer linear program, we first introduce auxiliary binary variables \u03bb,\u03c0(c),w. Each of these variables has an index i\u2217 for the worst-case scenario described in Lemma 5. Now, \u03bbi\u2217ij takes the value 1 if and only if customer j is assigned to the ith appointment and shows up. The variable \u03c0(c)i\u2217jl takes the value 1 if and only if the jth customer is assigned idle time cost cl. The variable wi\u2217j1j2 takes the value 1 if and only if both customer j1 and j2 are assigned to the first i \u2217 \u2212 1 appointments, j2 shows up, and j1 is a no-show.\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n43\nSecondly, for any given but fixed i\u2217 \u2208 {0, . . . , n+ 1}, we compute each appointment i\u2019s cost function c(i)\nfrom Lemma 5 via c(i) = \u2211n+1\nl=1 \u03b3ilcl with cn+1 := maxl\u2208[n] cl using any feasible solution \u03b3 \u2208 {0,1} n\u00d7(n+1) of\nthe following mixed-integer linear problem.\n\u03b3il \u2264\u2206lM \u2200l \u2208 [n]\u2200i\u2208 [n+1] (54)\nl\u22121\u2211 \u03b1=i \u2206\u03b1 \u2264L(1\u2212 \u03b3il) \u2200\u03b1 \u2208 [n]\u2200i\u2208 [n+1] (55)\ni\u22121\u2211 l=1 \u03b3il = 0 \u2200i\u2208 [n] (56) n+1\u2211 l=i \u03b3il = 1 \u2200i\u2208 [n] (57)\nConstraints (49) ensure that, if there is no positive amount of idle time before an appointment l \u2208 [n],\nthen \u03b3il = 0. We carefully choose M \u2265 1\nminl\u2208[n]{\u2206l:\u2206l>0} to ensure numerical stability. An alternative approach\ninvolves replacing (54) with an indicator constraint, namely \u2206l = 0\u21d2 \u03b3il = 0. Constraints (51)and (52) ensure that each appointment i is assigned a unit idle time cost cl with l\u2265 i. Constraints (50) ensure that, if \u03b3i\u03b1 =1, then there occurs no idle time before any of the appointments i, ..., \u03b1\u22121. Therefore, Constraints (49) to (52) ensure that \u03b3il = 1 holds if and only if l \u2208 [i, n] is the next appointment before which a positive amount of idle time occurs, and \u03b3i,n+1 = 1 if there is no such appointment.\nMILP. Hence, we have derived the following mixed-integer formulation for the general Robust Appoint-\nment Scheduling Problem with Waiting Time Guarantees and k show-ups (RASWTG):\nminU (58)\ns.t.U \u2265 i\u2217\u2211\ni=2\nci\u2206i\u2217i + co\u03c3i\u2217 \u2200i \u2217 \u2208 [n+1] (59)\n\u2206i\u2217i \u2265Ai\u2212 \u00af Ci\u2217i\u22121 \u2200i\n\u2217, i\u2208 [n+1] (60)\n\u00af Ci\u2217i =max{Ai, \u00af Ci\u2217i\u22121}+\nn\u2211 j=1 \u03bbi\u2217ij \u00af pj \u2200i \u2217 \u2208 [n+1]\u2200i\u2208 [n] (61)\n\u03c3i\u2217 \u2265Ai\u2217 + n\u2211\nk=i\u2217\nn\u2211 j=1 \u03bbi\u2217kj p\u0304j \u2212L \u2200i \u2217 \u2208 [n] (62)\n\u03bbi\u2217ij \u2264 \u03c0ij \u2200i \u2217 \u2208 [n+1]\u2200i, j \u2208 [n] (63) n\u2211\ni=1\nn\u2211 j=1 \u03bbi\u2217ij = k \u2200i \u2217 \u2208 [n+1] (64)\nn\u2211 j=1 \u03bbi\u2217ij =1 \u2200i \u2217 \u2208 [n+1\u2212 k,n+1]\u2200i\u2208 [i\u2217, n] (65)\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n44\nn\u2211 j=1 \u03bbi\u2217ij =0 \u2200i \u2217 \u2208 [n\u2212 k]\u2200i\u2208 [i\u2217, n] (66) n\u2211 i=1 \u03bbi\u2217ij2 \u2212 n\u2211 i=1 \u03bbi\u2217ij1 \u2264wi\u2217j1j2 \u2200i \u2217 \u2208 [n+1]\u2200j1, j2 \u2208 [n] (67) wi\u2217j1j2 \u2264 1\u2212 n\u2211\ni=1\n\u03bbi\u2217ij1 ,\nn\u2211 i=1 \u03bbi\u2217ij2 \u2200i \u2217 \u2208 [n+1]\u2200j1, j2 \u2208 [n] (68)\nn+1\u2211 l=1 cl(\u03c0(c)i\u2217j2l \u00af pj2 \u2212 \u03c0(c)i\u2217j1l \u00af pj1)\u2264M(1\u2212wi\u2217j1j2) \u2200i \u2217 \u2208 [n+1\u2212 k,n+1]\u2200j1, j2 \u2208 [n] (69) p\u0304j2 \u2212 p\u0304j1 \u2264M(1\u2212wi\u2217j1j2) \u2200i \u2217 \u2208 [n\u2212 k]\u2200j1, j2 \u2208 [n] (70) (54)\u2212 (57) with additional index i\u2217 \u2208 [n+1] (71) \u2212 1+ \u03c0ij + \u03b3i\u2217il \u2264 \u03c0(c)i\u2217jl \u2200i \u2217 \u2208 [n+1]\u2200j, l\u2208 [n] (72)\nAl +\ni\u22121\u2211 k=l n\u2211 j=1 \u03c0kj p\u0304j \u2212Ai \u2264 n\u2211 j=1 \u03c0ijWj \u2200i, l : i\u2208 [n], l \u2208 [i\u2212 1], i\u2212 l\u2264 k\u2212 1 (73)\nAl +(k\u2212 1)\u03b1i,l + i\u22121\u2211\n\u03c3=l\npil\u03c3\u2212Ai \u2264 n\u2211\nj=1\n\u03c0ijWj \u2200i\u2208 [n], l \u2208 [i\u2212 1] : i\u2212 l > k\u2212 1 (74)\n\u03b1il + pil\u03c3 \u2265 n\u2211\nj=1\n\u03c0\u03c3j p\u0304j \u2200i, l, \u03c3 \u2208 [n] (75)\nn\u2211 j=1 \u03c0ij =1, n\u2211 i=1 \u03c0ij = 1, n\u2211 j=1 \u03c0(c)i\u2217jl = 1 \u2200i, j, l\u2208 [n] (76) A1 = 0, \u00af Ci\u22170 = 0,An+1 =L \u2200i \u2217 \u2208 [n+1] (77) \u2206i\u2217i,\u2206n+1,i, \u03c3i\u2217 , \u03b1i,l, pil\u03c3 \u2265 0 \u2200i \u2217 \u2208 [n+1]\u2200i, l, \u03c3\u2208 [n] (78) \u03bbi\u2217ij , \u03c0(c)i\u2217jl, \u03b3 (i\u2217) il ,wi\u2217j1j2 \u2208 {0,1} \u2200i \u2217 \u2208 [n+1]\u2200i, j, j1, j2, l \u2208 [n] (79) Ai \u2265 0, \u03c0ij \u2208 {0,1} \u2200i, j \u2208 [n] (80)\nThe Objective Function (53) minimizes the upper bound on the total cost, which is computed in Constraints (54) \u2013 (66). Specifically, Constraint (54) sets the upper bound for cost incurred from idle time \u2206i\u2217i and overtime \u03c3i\u2217 in each worst-case scenario corresponding to i \u2217 \u2208 [n + 1] (see Lemma 5). Constraint (55) \u2013 (56) define the worst-case idle time before the i\u2217th appointment as a function of \u03bb. Similarly, Constraint (57) defines the worst-case overtime accumulated starting from the i\u2217th appointment. Constraint (59) ensures that a total of k customers show up. The following constraints implement the results from Theorem 2. Constraints (60) ensure that if k\u2265 n\u2212 i\u2217+1, then all customers schedules for the k\u2212 (n\u2212 i\u2217+1) last appointments show up. Constraint (61) allows customers to show up for the first i\u2217 \u2212 1 appointments only if k > n\u2212 i\u2217 + 1. Constraints (62) \u2013 (65) determine that among the first i\u2217 appointments, only those\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n45\nwith the smallest product cl \u00af pj show up, and among the subsequent appointments those with the longest maximum service times. Finally, Constraints (67) \u2013 (69) ensure the waiting time guarantees as derived in (53)."
        },
        {
            "heading": "C. Optimal Interappointment Times",
            "text": "The finding of the optimal ASAP scheduling rule in Theorem 3 under non-increasing idle time costs provides valuable insights, enhancing our understanding of the depicted optimal interappointment times in Figure 1:\nIn the case of zero no-shows, the ASAP rule implies increasing or varying interappointment times at the beginning of the scheduling horizon to avoid early idle times, followed by a constant pattern (limited by the waiting time guarantees). In this sense, the semi-plateau-dome pattern is a customer-driven variant of the plateau-dome-shaped pattern for zero-no shows.\nMoving on to the case that only k < n patients show up, no-shows do not affect the worst-case completion times of the first k appointments, but they affect the worst-case completion times of later appointments. In particular, some later interappointment times can be shortened in favor of lower cost. Due to the adherence to the waiting time guarantees, the interappointment times rise again to their previous level afterward. This observation leads to spikes typically after k customers. We consider this structure a customer-driven variant of the plateau-dome-shaped pattern with no-shows."
        },
        {
            "heading": "D. Computational Study Details",
            "text": "D.1. Instances The chosen patient numbers, n \u2208 {5,10,20}, are aligned with our daily CT examination records and are consistent with previous computational studies utilizing distributionally robust optimization approaches (Qi\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees\n46\n2017, Jiang et al. 2017, Kong et al. 2020). To capture the variability in real-world scenarios, and following consultation with radiology management, we introduce variations in no-show rates across 0%, 10%, and 20%, achieved by setting k \u2208 {n, \u230a0.9n\u230b, \u230a0.8n\u230b}. Figure 5 presents a boxplot illustrating the service times for the most common examination types.\nD.2. Sensitivity Analysis: The Number of Customers As can be seen in Table 4, the RASWTG approach leads to shorter waiting times and longer idle times as the number of scheduled customers increases. Specifically, the ASAP scheduling rule from Theorem 3, which is optimal for constant and decreasing costs, provides a rationale for this trend:\nThe first few appointments can all be scheduled at the start time of the scheduling horizon, as long as the sum of their maximum service times does not exceed the waiting time guarantee of the subsequent appointment. For these appointments, waiting times accumulate in proportion to the service times realized. For all subsequent appointments, the start time can be calculated as the worst-case sum of the previous service times minus the waiting time guarantee. As the number of customers treated increases, we consider it increasingly unlikely that all customers require their maximum service time. Consequently, we expect short waiting times and longer idle times before late appointments.\nWe note that this trend could be mitigated by using uncertainty budgets that control the number of\ncustomers who require maximum service time.\nD.3. Utilitarian Approach We briefly explore optimal interappointment times to enhance our understanding of optimal WSRAS schedules, as illustrated in Figure 6. We again compute the interappointment times for ten identical customers\nBauerhenne, Kolisch, and Schulz: Robust Appointment Scheduling with Waiting Time Guarantees 47\nwith a minimum service time of 15 minutes, a maximum service time of 25 minutes, and a waiting time guarantee of 30 minutes. In contrast to RASWTG, WSRAS interappointment times start at a higher level. Then, depending on the waiting time weight, they gradually decrease until a certain point. For small waiting time weights, most interappointment times match the minimum service time of 15 minutes, leading to little idle time but exploding waiting times. Conversely, higher waiting time weights yield interappointment times closer to the maximum service time of 25 minutes, resulting in short waiting times but extended idle time. Intriguingly, when cw =0.1, WSRAS accumulates waiting times until, at a certain point, they are alleviated by a single long interappointment time.\nFinally, we note that the WSRAS problem with constant idle time costs closely resembles problem (1) in Schulz and Udwani (2019), except that the latter does not consider a fixed planning horizon L. While initially minimizing a weighted sum of idle times and waiting time costs under a collective worst-case scenario, Schulz and Udwani (2019) demonstrate the sufficiency of considering the same n+1 scenarios as in WSRAS.\nMoreover, comparing an RASWTG-optimal schedule that does not consider a fixed planning horizon (e.g., cn+1 = co = 0) to a schedule computed with the optimal scheduling rule in Schulz and Udwani (2019) and under the respective assumptions, we find that RASWTG improves capacity utilization for sufficiently long waiting time guarantees. In particular, it is easy to show that the RASWTG schedule reduces worst-case idle time costs in the case of W > \u2211n\u22121\ni=1 \u2211n j=1 \u03c0ij u\nu+o\u2265i\n( p\u0304j \u2212 \u00af pj ) ."
        }
    ],
    "title": "Robust Appointment Scheduling with Waiting Time Guarantees",
    "year": 2024
}