{
    "abstractText": "The combination of transfer learning (TL) a low level potential energy surface (PES) to a higher level of electronic structure theory together with ring-polymer instanton (RPI) theory is explored and applied to malonaldehyde. The RPI approach provides a semiclassical approximation of the tunneling splitting and depends sensitively on the accuracy of the PES. With second order M\u00f8ller-Plesset perturbation theory (MP2) as the low-level (LL) model and energies and forces from coupled cluster singles, doubles and perturbative triples (CCSD(T)) as the high-level (HL) model, it is demonstrated that CCSD(T) information from only 25 to 50 judiciously selected structures along and around the instanton path suffice to reach HL-accuracy for the tunneling splitting. In addition, the global quality of the HL-PES is demonstrated through a mean average error of 0.3 kcal/mol for energies up to 40 kcal/mol above the minimum energy structure (a factor of 2 higher than the energies employed during TL) and < 2 cm\u22121 for harmonic frequencies compared with computationally challenging normal mode calculations at the CCSD(T) level.",
    "authors": [
        {
            "affiliations": [],
            "name": "Silvan K\u00e4ser"
        },
        {
            "affiliations": [],
            "name": "Jeremy O. Richardson"
        },
        {
            "affiliations": [],
            "name": "Markus Meuwly"
        }
    ],
    "id": "SP:74219913b40b69f68248c02f6257b3b99ecfaef0",
    "references": [
        {
            "authors": [
                "S. K\u00e4ser",
                "O.T. Unke",
                "M. Meuwly"
            ],
            "title": "Reactive dynamics and spectroscopy of hydrogen transfer from neural network-based reactive potential energy surfaces",
            "venue": "New J. Phys. 2020,",
            "year": 2020
        },
        {
            "authors": [
                "J.O. Richardson",
                "S.C. Althorpe"
            ],
            "title": "Ring-polymer instanton method for calculating tunneling splittings",
            "venue": "J. Chem. Phys. 2011,",
            "year": 2011
        },
        {
            "authors": [
                "D. Firth",
                "K. Beyer",
                "M. Dvorak",
                "S. Reeve",
                "A. Grushow",
                "K. Leopold"
            ],
            "title": "Tunable farinfrared spectroscopy of malonaldehyde",
            "venue": "J. Chem. Phys. 1991,",
            "year": 1991
        },
        {
            "authors": [
                "T. Baba",
                "T. Tanaka",
                "I. Morino",
                "K.M. Yamada",
                "K. Tanaka"
            ],
            "title": "Detection of the tunneling-rotation transitions of malonaldehyde in the submillimeter-wave region",
            "venue": "J. Chem. Phys",
            "year": 1999
        },
        {
            "authors": [
                "S.L. Baughcum",
                "Z. Smith",
                "E.B. Wilson",
                "R.W. Duerst"
            ],
            "title": "Microwave spectroscopic study of malonaldehyde. 3. Vibration-rotation interaction and one-dimensional model for proton tunneling",
            "venue": "J. Am. Chem. Soc",
            "year": 1984
        },
        {
            "authors": [
                "T.D. Sewell",
                "Y. Guo",
                "D.L. Thompson"
            ],
            "title": "Semiclassical calculations of tunneling splitting in malonaldehyde",
            "venue": "J. Chem. Phys. 1995,",
            "year": 1995
        },
        {
            "authors": [
                "J.O. Richardson",
                "S.C. Althorpe"
            ],
            "title": "Ring-polymer instanton method for calculating tunneling splittings",
            "venue": "J. Chem. Phys. 2011,",
            "year": 2011
        },
        {
            "authors": [
                "M. Ben-Nun",
                "T.J. Mart\u0301\u0131nez"
            ],
            "title": "Semiclassical tunneling rates from ab initio molecular dynamics",
            "venue": "J. Phys. Chem. A",
            "year": 1999
        },
        {
            "authors": [
                "G.V. Mil\u2019nikov",
                "K. Yagi",
                "T. Taketsugu",
                "H. Nakamura",
                "K. Hirao"
            ],
            "title": "Simple and accurate method to evaluate tunneling splitting in polyatomic molecules",
            "venue": "J. Chem. Phys",
            "year": 2004
        },
        {
            "authors": [
                "K. Yagi",
                "T. Taketsugu",
                "K. Hirao"
            ],
            "title": "Generation of full-dimensional potential energy surface of intramolecular hydrogen atom transfer in malonaldehyde and tunneling dynamics",
            "venue": "J. Chem. Phys",
            "year": 2001
        },
        {
            "authors": [
                "A. Viel",
                "M.D. Coutinho-Neto",
                "U. Manthe"
            ],
            "title": "The ground state tunneling splitting and the zero point energy of malonaldehyde: A quantum Monte Carlo determination",
            "venue": "J. Chem. Phys. 2007,",
            "year": 2007
        },
        {
            "authors": [
                "Z. Smedarchina",
                "W. Siebrand",
                "A. Fern\u00e1ndez-Ramos"
            ],
            "title": "The rainbow instanton method: A new approach to tunneling splitting in polyatomics",
            "venue": "J. Chem. Phys. 2012,",
            "year": 2012
        },
        {
            "authors": [
                "Y. Wang",
                "B.J. Braams",
                "J.M. Bowman",
                "S. Carter",
                "D.P. Tew"
            ],
            "title": "Full-dimensional quantum calculations of ground-state tunneling splitting of malonaldehyde using an accurate ab initio potential energy surface",
            "venue": "J. Chem. Phys",
            "year": 2008
        },
        {
            "authors": [
                "M. Schr\u00f6der",
                "F. Gatti",
                "H.-D. Meyer"
            ],
            "title": "Theoretical studies of the tunneling splitting of malonaldehyde using the multiconfiguration time-dependent Hartree approach",
            "venue": "J. Chem. Phys. 2011,",
            "year": 2011
        },
        {
            "authors": [
                "T. Hammer",
                "U. Manthe"
            ],
            "title": "Intramolecular proton transfer in malonaldehyde: Accurate multilayer multi-configurational time-dependent Hartree calculations",
            "venue": "J. Chem. Phys. 2011,",
            "year": 2011
        },
        {
            "authors": [
                "M.T. Cvitas",
                "S.C. Althorpe"
            ],
            "title": "Locating instantons in calculations of tunneling splittings: The test case of malonaldehyde",
            "venue": "J. Chem. Theory Comput. 2016,",
            "year": 2016
        },
        {
            "authors": [
                "E. Jahr",
                "G. Laude",
                "J.O. Richardson"
            ],
            "title": "Instanton theory of tunneling in molecules with asymmetric isotopic substitutions",
            "venue": "J. Chem. Phys. 2020,",
            "year": 2020
        },
        {
            "authors": [
                "Z. Smith",
                "E.B. Wilson",
                "R.W. Duerst"
            ],
            "title": "The infrared spectrum of gaseous malonaldehyde (3-hydroxy-2-propenal). Spectrochim",
            "venue": "Acta A Mol. Biomol. Spectrosc",
            "year": 1983
        },
        {
            "authors": [
                "S.L. Baughcum",
                "R.W. Duerst",
                "W.F. Rowe",
                "Z. Smith",
                "E.B. Wilson"
            ],
            "title": "Microwave spectroscopic study of malonaldehyde (3-hydroxy-2-propenal). 2. Structure, dipole moment, and tunneling",
            "venue": "J. Am. Chem. Soc",
            "year": 1981
        }
    ],
    "sections": [
        {
            "text": "The combination of transfer learning (TL) a low level potential energy surface (PES) to a higher level of electronic structure theory together with ring-polymer instanton (RPI) theory is explored and applied to malonaldehyde. The RPI approach provides a semiclassical approximation of the tunneling splitting and depends sensitively on the accuracy of the PES. With second order M\u00f8ller-Plesset perturbation theory (MP2) as the low-level (LL) model and energies and forces from coupled cluster singles, doubles and perturbative triples (CCSD(T)) as the high-level (HL) model, it is demonstrated that CCSD(T) information from only 25 to 50 judiciously selected structures along and around the instanton path suffice to reach HL-accuracy for the tunneling splitting. In addition, the global quality of the HL-PES is demonstrated through a mean average error of 0.3 kcal/mol for energies up to 40 kcal/mol above the minimum energy structure (a factor of 2 higher than the energies employed during TL) and < 2 cm\u22121 for harmonic frequencies compared with computationally challenging normal mode calculations at the CCSD(T) level."
        },
        {
            "heading": "1 Introduction",
            "text": "Tunneling splittings are exquisitely sensitive to the accuracy of a molecular potential energy surface (PES). The nuclear wave-functions corresponding to the two or multiple quantum mechanical bound states involved in the split energy levels probe an extended region on the underlying PES. Furthermore, the tunneling splitting also informs about the barrier height and the shape of the PES in the region connecting the two wells, see Figure 1. Due to all the above, tunneling splittings constitute a meaningful and stringent test of the level of theory at which the underlying PESs were calculated and the accuracy of their representation required for simulations from which the splittings are determined.\n2\nEven if a PES is given, accurate computation of tunneling splittings for multidimensional systems from quantum-based methods itself is a formidable task. The ring-polymer instanton (RPI) approach provides a semiclassical approximation of a tunneling process and can be used to calculate tunneling splittings in molecular systems.1\u20134 As was shown for the formic acid dimer,4 it is necessary to include all degrees of freedom of the molecule for a quantitative comparison with experiment. This often means that the (semiclassical) full-dimensional instanton approximation is more accurate than a reduced-dimensional quantum calculation. Instanton theory is based on the path-integral formulation of quantum mechanics and is formally exact only in the limit of ~ \u2192 0.5 In many previous studies it has been shown to give predictions within about 20% of fully quantum-mechanical calculations using the same PES for typical molecular systems, as long as the barrier height is significantly higher than the zero-point energy along the tunneling mode.1,4,6 Instanton calculations which, contrary to exact quantum calculations such as wave-function propagation,7,8 scale well with system\n3\nsize, are often used in combination with analytical, full-dimensional PESs. Path-integral molecular dynamics (PIMD) simulations also scale well with system size but are considerably more expensive than an instanton calculation.9,10\nIn principle it is possible to implement the instanton approach using on-the-fly ab-initio electronic structure calculations.11,12 However, because energies, gradients and Hessians are needed for each ring-polymer bead, this may be impractical for medium-sized molecules if high accuracy from coupled cluster with perturbative triples (CCSD(T)) level of theory is sought. More recent work has been devoted to combining machine learning (ML) and instanton theory to reduce overall computational expense. Gaussian process regression (GPR) has been used to obtain a local fit of the PES around the dominant tunneling pathway to calculate rate constants.13 It has been shown that the GPR rate constants are on par with the ab initio results, however, reducing the number of required electronic structure calculations by an order of magnitude. Similarly, instanton rate theory has been combined with NNs to obtain the PES more efficiently as compared to the on-the-fly approach.14,15\nAs an alternative, full-dimensional PESs can now be constructed for medium-sized molecules from which tunneling splittings can also be determined using the instanton approach. The generation of ML PESs based on large data sets of ab initio data is a challenging task16 and accuracy as well as the level of theory of the PES is of crucial importance for the accurate determination of tunneling splittings. The \u201cgold standard\u201d CCSD(T) approach scales as N7 (with N being the number of basis functions)17 which quickly becomes computationally prohibitive for generating data to build a full-dimensional PESs even for relatively small molecules. To avoid the need for calculating large ab initio data sets at high levels of theory transfer learning (TL)18\u201320 and related \u2206-ML21 were shown to be data and cost-effective alternatives.22\u201327\n4\nThe combination of TL and instanton theory appears particularly appealing as the instanton path (IP) can be determined on a low-level PES, which gives a rough approximation to the true tunneling path, and can be included (and iteratively refined if needed) into the TL data set. Additionally, the IP is inherently local and, thus, allows concentrating on improving only a small part of a PES. While instanton theory has been used in combination with ML schemes,13,15,28 the present work demonstrates the first combination of instanton theory with TL. The capability of the combined approach is demonstrated for the extensively studied malonaldehyde system exhibiting intramolecular hydrogen transfer (HT).\nRing Polymer Instanton theory has been employed to calculate the tunneling splitting of malonaldehyde on a permutationally invariant polynomial (PIP) PES fitted to 11147 near basis-set-limit frozen-core CCSD(T) electronic energies.29 The splitting was found to be 25 cm\u22121 with RPI6 as well as with a strongly related instanton method.30 The same PES was also used to calculate tunneling splittings using the fixed-node diffusion Monte Carlo (DMC) method giving 21.6 cm\u22121 with a statistical uncertainty of 2 to 3 cm\u22121.29 For DT, computed values on the PIP PES are 3.3 and 3.4 cm\u22121 using RPI6 and the related instanton method,30 and 3.0\u00b1 2\u2212 3 cm\u22121 from DMC simulations.29 The tunneling splitting from RPI calculations on a LASSO fit to CCSD(T)(F12*) energies was found to be 19.3 cm\u22121.6,31 To validate such computations, direct comparison with experiment is also of interest. Reliable tunneling splittings from experiment are only available for a few select systems.32\u201339 For malonaldehyde, the experimentally determined tunneling splitting is 21.583 cm\u22121 and 2.915 cm\u22121 for HT and deuterium transfer (DT), respectively.32,33,40 Although these results are not in perfect agreement with experiment, they are close enough that spectroscopic assignments can be made and provide detailed mechanistic information about the tunneling process.\nThe purpose of the present work is to develop and quantitatively assess an evidence-based\n5\nprocedure to determine reliable tunneling splittings by combining transfer learned PESs with instanton calculations. It is shown that this can dramatically reduce the cost of the overall simulation in comparison to working with ab initio potentials. The work is structured as follows. First, the methods and the generation of the data sets are presented. This is followed by a thorough evaluation of the accuracy of the transfer leaned PESs in terms of tunneling splittings and harmonic frequencies. Finally, the results are discussed and conclusions are drawn."
        },
        {
            "heading": "2 Methods",
            "text": ""
        },
        {
            "heading": "2.1 Ring-Polymer Instanton Theory",
            "text": "In a one-dimensional model, instanton theory is strongly related to the WKB approximation.41 Its main advantage, however, is that it can also be applied to multidimensional systems, in which it locates the uniquely defined optimal tunneling pathway.42 This pathway, known as the instanton, is defined as a long imaginary-time \u03c4 \u2192 \u221e path connecting two degenerate wells which minimizes the action, S. In computations, the path is located using an efficient ring-polymer optimization based on discretizing the path into N ring-polymer beads and taking the limit N \u2192 \u221e (typically on the order of 1000 is sufficient for convergence). The action is determined by the distance between neighbouring beads as well as the potential-energy of each bead, i.e. it uses information along the IP. Full technical details are presented in previous work.1,2 In general, the IP is not equivalent to the minimum-energy pathway (MEP) and will not even pass through a saddle point. This is because the instanton finds a compromise between length and height to optimize the tunneling path. Unlike PIMD or DMC, no random numbers or statistical errors are involved and so the instanton (once it is converged with \u03c4 \u2192\u221e and N/\u03c4 \u2192\u221e) is in principle uniquely determined by the PES.\n6\nOnce the IP has been located, fluctuations around the path are computed to second order and the information is combined into the term \u03a6, i.e. this is based on information around the IP. For this, one requires the Hessians (second-derivative matrix of PES) at each bead. The final prediction for the tunneling splitting (in a double-well system) is given by\n\u2206 = 2~ \u03a6\n\u221a S\n2\u03c0~ e\u2212S/~. (1)\nBecause S appears in the exponent it is particularly important to determine this quantity with high accuracy. The method has also been generalized to treat tunneling in systems with multiple (more than two) wells3,43 and in cases with non-degenerate wells for instance due to asymmetric isotopic substitution.6 The approach outlined in this work is, in principle, also applicable to these extensions."
        },
        {
            "heading": "2.2 Machine Learning",
            "text": "All PESs used in this work are represented with a high-dimensional neural network (NN) of the PhysNet44 architecture. PhysNet is a \u2018message-passing\u201945 NN that employs learnable descriptors of the atomic environments to predict individual atomic energy contributions Ei and partial charges qi. The descriptors are initialized as x 0 i = eZi , where eZi corresponds to a parameter vector defined by the nuclear charge Zi, i.e. atoms of the same element share the same descriptor. The descriptor is then iteratively updated and refined to best describe the local chemical environment of each atom i by passing \u2018messages\u2019 between atoms within a cut-off rcut following\nxl+1i = x l i +\n\u2211\nrij<rcut\nF(xli,xlj, rij). (2)\n7\nwhere rcut was 10 A\u030a. Here, x l i and x l j are the descriptors of atoms i and j at iteration l, rij is their interatomic distance and F(xli,xlj, rij) is the \u2018message-passing\u2019 function (for details see Ref. 44). Because only pairwise distances are used to encode the atoms\u2019 chemical environment and summation is commutative, the resulting descriptors (and thus the PES) are invariant with respect to translation, rotation and permutation of identical atoms, which is of particular importance when describing tunneling between degenerate wells. The descriptors are then used to predict partial charges qi (which are corrected to ensure total charge conservation) and the total energy of the chemical system by summation of the atomic contributions and explicitly including long-range electrostatics according to\nE = \u2211\ni\nEi + ke\nN\u2211\ni=1\nN\u2211\nj>i\nqiqj rij\n(3)\nHere, ke represents Coulomb\u2019s constant and the second term involving qiqj rij is damped to avoid numerical instabilities caused by the singularity at rij = 0 (for details refer to Ref. 44). The forces F and Hessians H can be obtained analytically using reverse mode automatic differentiation46 as implemented in Tensorflow.47\nThe learnable parameters of PhysNet are fitted to reference ab initio energies, forces and dipole moments following the strategy outlined in Reference 44. The partial charges qi are fitted to the ab initio dipole moment (\u00b5 = \u2211N\ni qiri) and explicitly enter the energy expression\n(see equation 3). In the present work, the TL scheme is employed whereby the parameters of a low-level (LL) treatment are used as a meaningful initial guess and are fine-tuned using higher-level information. For TL, the learning rate is reduced from 10\u22123 (as for learning a model from scratch) to 10\u22124. The LL in the present work is the full-dimensional PES for malonaldehyde at the MP2/aug-cc-pVTZ level of theory (henceforth, PhysNet MP2 PES) which is available from previous work and was trained on \u223c 70000 reference structures.22 This PhysNet PES has a barrier for HT of 2.79 kcal/mol which compares to a reference value\n8\nof 2.74 kcal/mol calculated at the MP2/aug-cc-pVTZ level of theory and the reference harmonic frequencies are reproduced with a root-mean-square deviation (RMSD) of 3.6 cm\u22121. The high-level (HL) treatment is the considerably higher and computationally much more demanding CCSD(T)/aug-cc-pVTZ level of theory at which energies, forces and dipole moments are calculated using Molpro48 for all data points used in TL."
        },
        {
            "heading": "2.3 Data Set Generation",
            "text": "Transfer learning requires high-level energies, forces and dipole moments for selected geometries of the system considered and ideally cover all spatial regions relevant for the observable(s) of interest. Without additional a priori information it is advantageous to generate an initial pool of structures which can be used for TL to fine-tune the LL treatment. When selecting configurations, it is not necessary to sample both potential wells since PhysNet handles this symmetry by construction. Here, the initial pool contained 862 malonaldehyde configurations consisting of:\n\u2022 111 geometries along the MEP of the PhysNet MP2 PES.\n\u2022 110 geometries along the IP of the PhysNet MP2 PES.\n\u2022 111 geometries along the IP determined on a PES that was transfer learned by using\nCCSD(T) information of the 111 MEP geometries (see above) to have an energy barrier closer to the ab initio CCSD(T) barrier.\n\u2022 280 geometries obtained from normal mode sampling (NMS) around the equilibrium\ngeometry. For this purpose, normal mode vectors and corresponding force constants are determined ab initio at the MP2/aug-cc-pVTZ level of theory.\n\u2022 240 geometries around the IP as obtained from NMS.\n\u2022 10 geometries along the IP of TL1 (see Section 3.2).\n9\nThis data set is referred to as the \u201cExtended Data Set\u201d and transfer learned models using it are called TLext. To probe the dependence of barrier heights and tunneling splittings on details of the training, ten independent models were trained on different splits of the data for TLext (and all the subsequent TLs). For each of the ten resulting PESs an instanton calculation was carried out. From this information, averages and standard deviations for the barrier heights and tunneling splittings were determined.\nAfter validating the performance of TLext from instanton calculations on each of the independently trained models, smaller subsets of the Extended Data Set were selected, employed for TL and subsequent tunneling splitting calculations."
        },
        {
            "heading": "3 Results",
            "text": "To set the stage, the tunneling splittings for malonaldehyde were calculated on the PhysNet MP2 PES using RPI theory. The tunneling splitting calculations were carried out with three different values of the imaginary time, \u03c4 , corresponding to effective \u2018temperatures\u2019 T = ~/kB\u03c4 \u2208 [50, 25, 12.5] K and with different numbers of beads N \u2208 [25, .., 212] to ensure convergence. Formally the instanton result is defined in the low-temperature limit, which is equivalent to infinitely-long imaginary times. The results are summarized in Table S1. A tunneling splitting of 96 cm\u22121 is obtained compared with 25 cm\u22121 from instanton calculations6,30 on the PIP-representation29 of the CCSD(T) reference data and 21.6 cm\u22121 from experiments.32,33,40 This illustrates the insufficient quality of the MP2 level of theory to capture tunneling splittings correctly. For the following, all instanton calculations were carried out with N = 4096 beads at an effective temperature of T = 25 K, which was found to be more than sufficient for convergence of \u2206 to two significant figures.\n10\n3.1 Performance of TLext\nAs a reference for the following exploration, the performance of TLext using the full set of 862 energies, forces and dipole moments determined at the CCSD(T)/aug-cc-pVTZ level is first assessed. These geometries are shown as a projection onto the PES spanned by the O\u2013O distance and the reaction coordinate q = rOAH \u2212 rOBH in Figure 2 (gray circles). As the PES is symmetric with respect to q = 0, the same geometry appears to the left and to the right of the mirror plane. The Extended Data Set was split according to \u223c 80/10/10 %\n11\ninto training/validation/test sets, from which the test sets were used only for testing. Across the 10 TL models, the separate test sets were predicted on average with MAE(E) \u2248 0.006, RMSE(E) \u2248 0.009 kcal/mol, MAE(F ) \u2248 0.03 and RMSE(F ) \u2248 0.07 kcal/mol/A\u030a. The average barrier height on the ten transfer-learned PESs (\u3008TLext\u3009) was EB = 3.8945 \u00b1 0.0006 kcal/mol which compares with an ab initio barrier of 3.8948 kcal/mol determined at the CCSD(T)/aug-cc-pVTZ level of theory determined from present calculations. The RPI tunneling splittings for HT and DT were \u2206H = 25.3 \u00b1 0.2 cm\u22121 and \u2206D = 3.7 \u00b1 0.03 cm\u22121, respectively, see Table 1 and S2. These results compare with computed splittings on the PIP representation of CCSD(T)/aug-cc-pVTZ reference calculations using instanton calculations that yield 25/3.4 cm\u22121 6,30 and experimental splittings of 21.6/2.9 cm\u22121.32,33,40 Hence, the transfer-learned PES using fewer than 1000 higher level CCSD(T)/aug-cc-pVTZ energies and forces together with the same method for determining the tunneling splitting performs on par with calculations on the PIP representation of the \u223c 11000 CCSD(T)/aug-cc-pVTZ energies.29 Based on this it is of much practical interest to further reduce the number of HL calculations required to achieve the same result. Therefore, in a next step, different subsets of the Extended Data Set are considered and used for TL to arrive at an ideally small number of HL points while still retaining the accuracy in tunneling splittings from instanton calculations.\n3.2 Performance on Smaller Datasets: TL0, TL1, and TL2\nFrom the Extended Data Set containing 862 geometries, different subsets were extracted. The size of the data set has to be chosen small enough for efficient computation but sufficiently large to still cover the appropriate regions of configurational space probed by the instanton calculation.\nTL0: To check whether a considerably smaller data set suffices as a starting point, ten TLs were preformed on a data set containing only 25 geometries: a) 5 IP geometries (approximately equally spaced) determined on a PES that was transfer learned to have a barrier closer to the ab initio CCSD(T) barrier; b) 10 geometries, each, selected from the NMS around the equilibrium geometry and the IP. This can be done by selecting geometries based on a RMSD criterion on the n atomic positions ( \u221a\n1 n \u2211n i=1 ||vi \u2212 wi||2 where vi and wi are\ntwo sets of Cartesian coordinates of atom n), which was done as follows for both groups of geometries that were generated with NMS. Starting from a random geometry, new geometries are added iteratively if the RMSD with respect to the selected ones is larger than a threshold. For this reason, the threshold is maximized to include 10 geometries. Note that no MEP geometries are added. The data set for TL0 are the yellow crosses in Figure 2.\nWith this smallest subset the barrier height of the (ensemble of the) transfer learned PES \u3008TL0\u3009 is EB = 3.8925 \u00b1 0.012 kcal/mol which is, within errors, close to the target value of 3.8948 kcal/mol determined at the CCSD(T)/aug-cc-pVTZ level. From 10 independent instanton calculations the average splitting is \u2206H = 23.4 \u00b1 1.9 cm\u22121 which is \u223c 2 cm\u22121 below that from the simulations on the TLext PES but still within statistical fluctuation. Comparing the action S/~ of the IPs on TL0 and TLext shows that they are comparable (5.743 \u00b1 0.002 vs. 5.749 \u00b1 0.026) and even identical within the error bars. However, the uncertainty on TL0 is larger by an order of magnitude compared with that on TLext. Thus, the action, S/~, of the path is clearly less well defined on TL0. For the fluctuation factor\n13\n\u03a6 the differences are considerably larger between the two families of PESs. Still, the values themselves are within error bounds but again, the fluctuation around the mean for TL0 is ten times larger than that for the TLext PESs. This conclusion also hold for DT, see Table S2. Overall, using only 25 additional data points as done for TL0 already yields encouraging results for the barrier height and tunneling splittings. To explore further improvements new points were added and the process was repeated.\nTL1: For TL1 the points used for TL0 were extended and increased to 50 points, see turquoise circles in Figure 2. The data set for TL1 contained: a) 5 geometries along the MEP of the PhysNet MP2 PES; b) 5 geometries along the IP of a transfer learned PES from using the MEP points calculated at CCSD(T); c) 20 geometries, each, selected from the NMS around the equilibrium geometry and the IP. The MEP and IP geometries are chosen with a uniform spacing along the respective path and the geometries from NMS are selected following the\n14\nRMSD approach outlined for TL0.\nTL1 yields an averaged barrier height EB = 3.8974\u00b1 0.0161 which agrees within error bars with that of TLext and the ab initio value (3.8948 kcal/mol). The splitting \u2206H = 24.9\u00b1 1.1 cm\u22121 is only 0.4 cm\u22121 below that of TLext. The key improvement is that the fluctuation factor \u03a6 agrees considerably better with TLext than for TL0 and the remaining 2% discrepancy can be traced to the 0.02 absolute difference in S/~. Overall, increasing the number of geometries used for TL to Ndata = 50 in this fashion leads to a PES which reproduces the barrier height and splittings from TLext. To further probe convergence of these results yet a larger data set was considered.\nTL2: While the accuracy of TL1 might appear satisfactory, convergence of TL1 cannot be checked without TLext. Thus, TL1 was further extended to yield TL2. This was accomplished from a strategy related to adaptive sampling.49 Two independent models from TL1\n15\nwere used to predict the energy E of the remaining pool of geometries obtained from NMS. From these geometries, the 40 geometries with the largest deviation (here \u223c 0.02 kcal/mol) between the prediction of the two NNs are added to the data set. If a large deviation between the energy predictions of the two models is found, it is likely that no or too little reference data has been included in TL1. In addition, 5 geometries along the MEP and instanton of the TL1 were added such that TL2 contained a total of 100 geometries (see salmon squares in Figure 2).\nWith TL2 the barrier height EB, splitting \u2206, action S/~ and fluctuation \u03a6 further improve over those from TL1 and are closer to the results from TLext, see Table 1 and S2. Within 1\u03c3 all values for HT and DT agree with those from TLext and with the reference from the literature except for the tunneling splitting for DT. Overall, addition of 50 to 100 additional points from the HL treatment appears to suffice to arrive at a quantitatively correct PES transfer-learned from the LL treatment (MP2/aug-cc-pVTZ). Figure 3 illustrates the gradual convergence for TL0 to TL2 towards the results found for TLext, which is promising. While exceptional agreement regarding the energy barrier EB (as the \u201csimpler\u201d property) is found for all the TLs the standard deviation of the splittings \u2206H (which is more challenging to obtain) can be reduced from 1.9 cm\u22121 (7.5%) for TL0 to 0.5 cm\u22121 (2%) for TL2. The results from TL2 are accurate to within 0.1 cm \u22121 for HT and 0.04 cm\u22121 for DT as compared to TLext. This corresponds to deviations of 0.4% and 1.1%. The IPs themselves are reported in Figures S1 to S4 and show slight deviations between the different TLs on the smallest data set (TL0), but for TL1, TL2 and TLext they are hardly distinguishable.\nIn summary, it has been found that with between 25 and 50 HL energies and forces for judiciously chosen structures the correct barrier height, tunneling splitting, action and fluctuation can be obtained, see Table 1. This is the foundation to further optimize the procedure, ideally based entirely on information available from the LL surface by minimizing the\n16\namount of data required from the HL treatment."
        },
        {
            "heading": "3.3 Towards an Optimized Procedure",
            "text": "For an even more efficient procedure, an approach is sought that is based on information about the LL-PES only. Hence, an attempt is made to further reduce the computational effort by minimizing the number of structures for which HL calculations need to be carried out for an improved PES and tunneling splittings. Therefore, it is explored which elements of the procedure are most important for obtaining high accuracy to cost ratios. For moving towards a more evidence-guided, optimized procedure, TL is carried out from LL-information that is only contained in the MEP and IP as follows: a) only the MEP (TLMEP) using 111 geometries along the MEP of the PhysNet MP2 PES; b) only the IP (TLIP) using 110 geometries along the IP of the PhysNet MP2 PES; and c) a combination of the MEP and the IP (TLMI) including 111 MEP and 110 instanton geometries as obtained from the PhysNet MP2 PES. The HL information for TL consisted again of energies, forces and dipole moment determined at the CCSD(T)/aug-cc-pVTZ level of theory. A total of 5 TLs were performed, each on different splits of the data. The two best NNs (judged from the performance on the validation set) were used for further analysis.\nFirst, it is noted that for TLMEP and TLMI the barrier EB for HT agrees well with the target value of 3.8948 kcal/mol (ab initio CCSD(T)/aug-cc-pVTZ level value) whereas this is not the case for TLIP, as expected, because the instanton path does not pass through the transition state of the MEP (see Table 2). Also, despite starting from MP2 information only, TL to the HL model yields considerably improved tunneling splittings \u2206H for all three models, ranging from 15 to 18 cm\u22121, compared to those from the PhysNet MP2 PES (96 cm\u22121).\nConsidering the action S/~ from TLMEP, TLIP and TLMI it is seen that it progressively\n17\napproaches that from TLext. For TLMEP the action overshoots the target value from TLext by \u223c 0.15 which leads to an error of \u223c 15 % in the splitting because S/~ appears in the exponential factor in Eq. 1. Conversely, with a difference of 0.04 compared with TLext, the error for TLMI due to S/~ is only \u223c 4 %. The influence of \u03a6 on the difference between TLext and the three models considered in Table 2 is minor because for all of them \u03a6 is uniformly too large by \u223c 40 % compared with that from TLext.\nTable 2 suggests that a combination of information from the MEP and the IP used for transfer learning, i.e. TLMI, yields EB and \u2206H closest to the results from TLext. However, the tunneling splittings still differ by more than 10 % from the target value obtained on the TLext PESs. Considering the actions S/~ and fluctuations \u03a6 for all the transfer learned PESs in Table 2 it is found that in particular the values of \u03a6, which are sensitive to fluctuations around the IP, differ considerably from that on TLext. Hence as a last improvement points along the MEP and IP are combined with structures around the IP.\nFor two final, evidence-based TLs (TLEB1 and TLEB2), a set of 25 data points was generated\n18\nas follows. A total of 5 points was selected along the MEP and IP (one close to the minimum and 2 points along the PhysNet MP2 PES MEP and IP each, see black points in Figure 5). These were supplemented by 20 geometries from NMS around the equilibrium structure and the IP that are selected by means of an RMSD criterion. For TLEB1 (orange circles in Figure 5), the geometries with largest RMSD are selected (single geometries which occupy the same rOO and q coordinates are eliminated). For TLEB2 (green crosses in Figure 5), besides the RMSD criterion, the geometries were selected to cover the important configurational space more regularly (as judged by Figure 5).\nFor both sets of points the corresponding CCSD(T)/aug-cc-pVTZ energies, forces and dipole moments were used for TL, resulting in two sets of transfer learned PESs: TLEB1 and TLEB2. For both of them the barrier height (3.90 kcal/mol) is within error bars of TLext for which it was 3.89 kcal/mol. The action S/~ for both EB-models agree with TLext within error bounds although the fluctuations around the mean is larger by almost an order of magnitude, see Table 3. For the fluctuation \u03a6 the differences compared with TLext are \u223c 5 %, commensurate with TL0 and evidently improved over those using MEP, IP or MI, see Table 2 which do not train on geometries around the path. The tunneling splittings are \u2206H,EB1 = 23.7 \u00b1 1.1 cm\u22121 and \u2206H,EB2 = 23.5\u00b1 2.1 cm\u22121, both of which are close to/within error bounds of the reference value (25.3 \u00b1 0.2), see Table 3. These results are comparable and slightly better\n19\nto those on TL0 which also was based on only 25 points for TL. However, the training data for TLEB1,EB2 are selected based entirely on the PhysNet MP2 PES whereas TL0 made use of HL information in that it employed geometries along the IP of a PES with corrected barrier. Hence, from a computational perspective, the EB models are considerably more cost-effective.\nOverall, it is found that TL to the HL with 25 additional points yields a barrier height that agrees with the full HL treatment and the tunneling splitting differs by only \u223c 1 cm\u22121. Any further improvement requires additional points. Based on the results in Table 3 it is expected that using a TL model trained on fewer than 50 judiciously selected HL data points yields results within 1% of the HL reference TLext. This needs also be contrasted with an expected\n20\naccuracy of instanton calculations for tunneling splittings of \u223c 20 %."
        },
        {
            "heading": "4 Discussion and Conclusions",
            "text": "The present work aimed at developing a computationally efficient and accurate road-map for how to improve a given LL model - which was assumed to be \u201ccomprehensive\u201d (here 7\u00d7 104 MP2 energies and forces were used) for the observable of interest - to a HL model by providing a small amount of additional information at the higher level of theory considering a particular observable. Here, the observable was the tunneling splitting for HT/DT in malonaldehyde for which the LL model (MP2/aug-cc-pVTZ) yielded \u2206 = 96 cm\u22121, compared with a literature value of \u2206H \u223c 25 cm\u22121 from a PIP-represented PES of CCSD(T)/aug-ccpVTZ reference energies using a range of methods for computing \u2206H/D, see Table S7. Most HL models generated were based on TL using 10s to 100s of HL points and yield \u2206 \u223c 25 cm\u22121 which is a substantial improvement over the LL model and consistent with computations in the literature at the same level of theory but employing computationally much more demanding approaches. The remaining differences between computations and experiments are due to a) shortcomings of the CCSD(T) level of theory compared with a full CI treatment, b) the incompleteness of the basis set, and c) inherent semiclassical approximations of instanton theory (e.g. neglect of coupling to overall molecule rotation and anharmonicity perpendicular to the instanton path).\nA typically used shortcut is to optimize the instanton using a LL ab initio method, e.g. DFT or MP2, and then compute the CCSD(T) properties along the path to correct the action S/~. Such a hybrid approach was assessed using the PhysNet MP2 PES to optimize the instanton and then calculate the action S/~ on the TLext PES.11,12,50,51 The results are summarized in Table 4 and illustrate that although the hybrid approach is, in this case, able to\n21\ninfer the correct value for S/~, the TL approach additionally improves \u03a6. Using Equation 1 with the action as determined by the hybrid approach (S/~ = 5.7401) and the fluctuation factor determined on the PhysNet MP2 PES (\u03a6 = 42.7705) yields \u2206H \u223c 31.5 cm\u22121 which overestimates the value of 25.1 cm\u22121 from TLext. The TL approach is thus able to provide a more accurate prediction of \u2206 for a similar computational cost.\nFor calculating the tunneling splittings based on the instanton approach it was found that an evidence-based approach starting from MEP and IP on the LL PES, augmented with geometries drawn from a pool of structures selected such that their RMSD is maximal with respect to an existing set of structures requires of the order of 50 points at the HL for TL. Therefore, only local and not global knowledge of the PES is required as would, e.g. be necessary for fully quantum-mechanical methods such as wavepackets. The bottleneck to a \u201cdirect\u201d ab initio-based instanton approach is typically the calculation of N Hessians, as these are rather expensive to compute.11,12 Earlier work on instanton rate theory combined with machine-learning techniques for the H + CH4 and H + C2H6 reactions required \u223c 50 energies and forces and 8 Hessians in the training set to converge the rate constant to within 1 % of the ab initio result at 200 K.13 Using TL, calculating any high-level ab initio Hessians at all has been avoided. As is demonstrated here, this can significantly lower the computational expense with no loss of accuracy.\n22\nWith regards to the accuracy of the TL PESs it is of interest to compare their performance on out-of-sample structures. For this a test set was generated from MD simulations at 700 K on one of the TLext PESs from which 100 geometries were randomly extracted. In addition, 10 equally spaced off-grid geometries along the IP on the same PES were selected. The CCSD(T)/aug-cc-pVTZ energies of these 110 geometries cover a range from \u223c 5 to 40 kcal/mol above the global minimum. The energies for these structures were computed based on TLext (most rigorous TL using 862 HL structures) and TLEB1 (following the recommended procedure; TL with 25 HL energies and forces), respectively, and the [MAE100(E),MAE10(E)] for the two out-of-sample sets are [0.21,0.004] kcal/mol and [0.34,0.005] kcal/mol. Notably, the energies of the geometries used for TLext and TLEB1 only cover a range 20 kcal/mol above the global minimum whereas the out-of-sample energies reach twice as high, up to 40 kcal/mol above the minimum. Hence, the out-of-sample structures contain true predictions on the HL-PES. As a comparison, for the PIP PES, which used energies only and no forces, the reported fitting errors (i.e. in-sample) are 32 cm\u22121 (0.09 kcal/mol) for energies below 2000 cm\u22121 (5.7 kcal/mol) above the global minimum and 211 cm\u22121 (0.6 kcal/mol) for energies up to 20000 cm\u22121 (51.2 kcal/mol).29\nTL as used in the present work - namely as a local refinement of a LL-PES - can also be regarded as a variant of the more global \u201cmorphing\u201d approach for PESs.52 It is therefore of interest to consider in what way observables other than the tunneling splitting change upon TL from LL to HL. For this, harmonic frequencies were determined for a number of transfer learned PESs. The harmonic frequencies averaged over the 10 individually trained NNs for different TLs are reported in Table 5, where they are compared with frequencies determined from CCSD(T)/aug-cc-pVTZ calculations at the corresponding equilibrium structure of malonaldehyde. As judged from the MAE(\u03c9) the PhysNet model for TLext is most accurate (MAE < 1 cm\u22121), followed by TL2 (MAE < 2 cm\u22121), TL1 (MAE \u223c 2 cm\u22121)and\n24\nTL0 (MAE \u223c 3 cm\u22121), as expected, and show a considerable improvement over the MP2 frequencies. For TLEB1 the MAE is < 3 cm \u22121. Thus, TL to the HL model also improves the shape of the PES in degrees orthogonal to the two reaction coordinates considered for the tunneling splitting.\nIn terms of a recommended procedure it is noted that the strategy outlined in going from TL1 to TL2 (adaptive sampling/active learning) can also be pursued recursively from a \u201cpool\u201d of geometries generated from sampling the PhysNet MP2 PES. This procedure can be repeated until convergence of the barrier height and the tunneling splittings. The approach proposed for future application is (see Figure 6): i) create a LL-PES from a fine grid (here 7\u00d7 104 points) and train a ML model (here PhysNet) ii) generate a pool of structures based on the LL-PES (including MEP, Instanton, NMS) iii) choose N \u223c 25 geometries following EB1/2 and determine energies and forces from HL ab initio calculations iv) perform TL and instanton calculations on the HL-PES v) refine the data set using adaptive sampling and structures along the new IP. Then repeat TL and instanton calculations vi) repeat iv) and v) until convergence. The present work demonstrates that following such a road-map requires \u223c 50 HL energy and force evaluations to determine an accurate tunneling splitting of malonaldehyde which is manifestly more efficient than previously explored approaches.\nIn summary, given that LL models can be constructed efficiently even for moderately sized\n25\nmolecules such as malonaldehyde or larger,53 the present work confirms that with specific, evidence-based information grounded in physical understanding of the process in question, several 10 points from a HL treatment are sufficient to generate high-quality PESs for a target observable which was the tunneling splitting in malonaldehyde in the present work. The MAE(E) for the TL-PESs trained on energies spanning 20 kcal/mol above the global minimum is \u223c 0.3 kcal/mol on off-grid structures spanning 40 kcal/mol and the resulting harmonic frequencies agree to within 1 to 3 cm\u22121 with rigorous and very time consuming normal mode analysis at the CCSD(T)/aug-cc-pVTZ level of theory. The recommended approach deduced from the present work is based on information about the MEP, the IP, and fluctuations around the IP determined on the LL-PES for which HL calculations are required for TL to determine the HL-PES. It is expected that - with suitable adaptations due to the particular observable considered - the present approach can also be applied to other observables that are computationally expensive to determine for a given PES, e.g. the quantum bound states of molecules or scattering cross sections for gas phase reactions from wavepacket propagation."
        },
        {
            "heading": "Acknowledgment",
            "text": "This work has been financially supported by the Swiss National Science Foundation NCCRMUST (MM and JOR), the AFOSR, and the University of Basel."
        },
        {
            "heading": "EB is given in kcal/mol. The results emphasized in red are supposed to be closest to the present results due to a similar PES and method to obtain the tunneling splittings (RPI).",
            "text": "Ref. PES EB Dynamics H/D \u2206 [cm \u22121]\nExp. 3,4 H 21.583 5 D 2.915 Theo. 6 FFa 10.0 semiclassicalb H 21.8 7 FFa,6 10.0 RPIi H 51 8 AIc(B3LYP/double-\u03b6) 2.3 semiclassicalb H 21\u00b1 1 9 SId (MP2/6-31G(d,p))10 3.6 instanton H 30.7 11 SI (MP2/6-31G(d,p))10 3.6 POITSEe H 25.7\u00b1 0.3 12 AI (MC-QCISD/3) 4.1 rainbow instanton H 25.4 9 AI (CCSD(T)/(a)VTZ) 3.8 instanton H 21 - 22 13 PIPf (CCSD(T)/aVTZ) 4.1 DMC H 21.6\u00b1 (2\u2212 3) 14 PIP (CCSD(T)/aVTZ) 4.1 MCTDHg H 23.4 15 PIP (CCSD(T)/aVTZ) 4.1 MCTDH H 23.8 16 PIP (CCSD(T)/aVTZ) 4.1 RPI H 25 17 PIP (CCSD(T)/aVTZ) 4.1 RPI H 24.9 18 PIP (CCSD(T)/aVTZ) 4.1 ti-QMh H 24.5 17 LASSOj(CCSD(T)(F12*)) 4.0 RPI H 19.3 9 SI (MP2/6-31G(d,p))10 3.6 instanton D 4.58 11 SI (MP2/6-31G(d,p))10 3.6 POITSE D 3.21\u00b1 0.09 12 AI (MC-QCISD/3) 4.1 rainbow instanton D 3.4 9 AI (CCSD(T)/(a)VTZ) 3.8 instanton D 3.0 13 PIP (CCSD(T)/aVTZ) 4.1 DMC D 3.0\u00b1 (2\u2212 3) 16 PIP (CCSD(T)/aVTZ) 4.1 RPI D 3.4\na experimental vibrational force field derived by Wilson et al.19,20 b semiclassical method based on the Makri-Miller model c Ab initio d Shepard interpolation e Monte Carlo projection operator, imaginary time spectral evolution f Permutationally invariant polynomial method g Multiconfiguration time-dependent Hartree approach h time-independent quantum mechanical method i Ring-polymer instanton method j least absolute shrinkage and selection operator\nS8"
        }
    ],
    "title": "Transfer learning for affordable and high quality tunneling splittings from instanton calculations",
    "year": 2022
}