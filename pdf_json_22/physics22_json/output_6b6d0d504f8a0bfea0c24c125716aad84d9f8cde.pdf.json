{
    "abstractText": "Shadow estimation is an efficient method for predicting many observables of a quantum state with a statistical guarantee. In the multi-shot scenario, one performs projective measurement on the sequentially prepared state for K times under the same unitary evolution, and repeats this procedure for M rounds of random sampled unitary, which results in MK times measurements in total. Here we analyze the performance of shadow estimation in this multi-shot scenario, which is characterized by the variance of estimating the expectation value of some observable O. We find that in addition to the shadow-norm \u2225O\u2225shadow introduced in [Huang et.al. Nat. Phys. 2020[1]], the variance is also related to another norm, and we denote it as the cross-shadow-norm \u2225O\u2225Xshadow. For both random Pauli and Clifford measurements, we analyze and show the upper bounds of \u2225O\u2225Xshadow. In particular, we figure out the exact variance formula of Pauli observables for random Pauli measurements. Our work gives theoretical guidance for the application of multi-shot shadow estimation.",
    "authors": [
        {
            "affiliations": [],
            "name": "You Zhou"
        },
        {
            "affiliations": [],
            "name": "Qing Liu"
        }
    ],
    "id": "SP:4fbc16e5d74db2c6f49af03037d0b1986e87bfc0",
    "references": [
        {
            "authors": [
                "Hsin-Yuan Huang",
                "Richard Kueng",
                "John Preskill"
            ],
            "title": "Predicting many properties of a quantum system from very few measurements",
            "venue": "Nature Physics,",
            "year": 2020
        },
        {
            "authors": [
                "Jeongwan Haah",
                "Aram W Harrow",
                "Zhengfeng Ji",
                "Xiaodi Wu",
                "Nengkun Yu"
            ],
            "title": "Sample-optimal tomography of quantum states",
            "venue": "IEEE Transactions on Information Theory,",
            "year": 2017
        },
        {
            "authors": [
                "Steven T Flammia",
                "David Gross",
                "Yi-Kai Liu",
                "Jens Eisert"
            ],
            "title": "Quantum tomography via compressed sensing: error bounds, sample complexity and efficient estimators",
            "venue": "New Journal of Physics,",
            "year": 2012
        },
        {
            "authors": [
                "Martin Kliesch",
                "Ingo Roth"
            ],
            "title": "Theory of quantum system certification",
            "venue": "PRX Quantum,",
            "year": 2021
        },
        {
            "authors": [
                "Ehud Altman",
                "Kenneth R Brown",
                "Giuseppe Carleo",
                "Lincoln D Carr",
                "Eugene Demler",
                "Cheng Chin",
                "Brian DeMarco",
                "Sophia E Economou",
                "Mark A Eriksson",
                "Kai-Mei C Fu"
            ],
            "title": "Quantum simulators: Architectures and opportunities",
            "venue": "PRX Quantum,",
            "year": 2021
        },
        {
            "authors": [
                "Yuri Alexeev",
                "Dave Bacon",
                "Kenneth R Brown",
                "Robert Calderbank",
                "Lincoln D Carr",
                "Frederic T Chong",
                "Brian DeMarco",
                "Dirk Englund",
                "Edward Farhi",
                "Bill Fefferman"
            ],
            "title": "Quantum computer systems for scientific discovery",
            "venue": "PRX Quantum,",
            "year": 2021
        },
        {
            "authors": [
                "Andreas Elben",
                "Steven T Flammia",
                "Hsin-Yuan Huang",
                "Richard Kueng",
                "John Preskill",
                "Beno\u00eet Vermersch",
                "Peter Zoller"
            ],
            "title": "The randomized measurement toolbox",
            "venue": "Nature Reviews Physics,",
            "year": 2023
        },
        {
            "authors": [
                "Scott Aaronson"
            ],
            "title": "Shadow tomography of quantum states",
            "venue": "SIAM Journal on Computing,",
            "year": 2019
        },
        {
            "authors": [
                "Andreas Elben",
                "Richard Kueng",
                "Hsin-Yuan Robert Huang",
                "Rick van Bijnen",
                "Christian Kokail",
                "Marcello Dalmonte",
                "Pasquale Calabrese",
                "Barbara Kraus",
                "John Preskill",
                "Peter Zoller"
            ],
            "title": "Mixed-state entanglement from local randomized measurements",
            "venue": "Physical Review Letters,",
            "year": 2005
        },
        {
            "authors": [
                "Aniket Rath",
                "Cyril Branciard",
                "Anna Minguzzi",
                "Beno\u00eet Vermersch"
            ],
            "title": "Quantum fisher information from randomized measurements",
            "venue": "Phys. Rev. Lett.,",
            "year": 2021
        },
        {
            "authors": [
                "Zhenhuan Liu",
                "Yifan Tang",
                "Hao Dai",
                "Pengyu Liu",
                "Shu Chen",
                "Xiongfeng Ma"
            ],
            "title": "Detecting entanglement in quantum many-body systems via permutation moments",
            "venue": "Physical Review Letters,",
            "year": 2022
        },
        {
            "authors": [
                "Roy J. Garcia",
                "You Zhou",
                "Arthur Jaffe"
            ],
            "title": "Quantum scrambling with classical shadows",
            "venue": "Phys. Rev. Research,",
            "year": 2021
        },
        {
            "authors": [
                "Max McGinley",
                "Sebastian Leontica",
                "Samuel J Garratt",
                "Jovan Jovanovic",
                "Steven H Simon"
            ],
            "title": "Quantifying information scrambling via classical shadow tomography on programmable quantum simulators",
            "venue": "Physical Review A,",
            "year": 2022
        },
        {
            "authors": [
                "Alireza Seif",
                "Ze-Pei Cian",
                "Sisi Zhou",
                "Senrui Chen",
                "Liang Jiang"
            ],
            "title": "Shadow distillation: Quantum error mitigation with classical shadows for near-term quantum processors",
            "venue": "PRX Quantum,",
            "year": 2023
        },
        {
            "authors": [
                "Hong-Ye Hu",
                "Ryan LaRose",
                "Yi-Zhuang You",
                "Eleanor Rieffel",
                "Zhihui Wang"
            ],
            "title": "Logical shadow tomography: Efficient estimation of error-mitigated observables",
            "venue": "arXiv preprint arXiv:2203.07263,",
            "year": 2022
        },
        {
            "authors": [
                "Hsin-Yuan Huang",
                "Michael Broughton",
                "Jordan Cotler",
                "Sitan Chen",
                "Jerry Li",
                "Masoud Mohseni",
                "Hartmut Neven",
                "Ryan Babbush",
                "Richard Kueng",
                "John Preskill"
            ],
            "title": "Quantum advantage in learning from experiments",
            "year": 2022
        },
        {
            "authors": [
                "Hsin-Yuan Huang",
                "Richard Kueng",
                "Giacomo Torlai",
                "Victor V Albert",
                "John Preskill"
            ],
            "title": "Provably efficient machine learning for quantum many-body problems",
            "venue": "Science, 377(6613):eabk3333,",
            "year": 2022
        },
        {
            "authors": [
                "Stefan H. Sack",
                "Raimel A. Medina",
                "Alexios A. Michailidis",
                "Richard Kueng",
                "Maksym Serbyn"
            ],
            "title": "Avoiding barren plateaus using classical shadows",
            "venue": "PRX Quantum,",
            "year": 2022
        },
        {
            "authors": [
                "Hsin-Yuan Huang",
                "Richard Kueng",
                "John Preskill"
            ],
            "title": "Efficient estimation of pauli observables by derandomization",
            "venue": "Physical review letters,",
            "year": 2021
        },
        {
            "authors": [
                "Charles Hadfield",
                "Sergey Bravyi",
                "Rudy Raymond",
                "Antonio Mezzacapo"
            ],
            "title": "Measurements of quantum hamiltonians with locally-biased classical shadows",
            "venue": "Communications in Mathematical Physics,",
            "year": 2022
        },
        {
            "authors": [
                "Bujiao Wu",
                "Jinzhao Sun",
                "Qi Huang",
                "Xiao Yuan"
            ],
            "title": "Overlapped grouping measurement: A unified framework for measuring quantum states",
            "year": 2023
        },
        {
            "authors": [
                "You Zhou",
                "Zhenhuan Liu"
            ],
            "title": "A hybrid framework for estimating nonlinear functions of quantum states",
            "venue": "arXiv preprint arXiv:2208.08416,",
            "year": 2022
        },
        {
            "authors": [
                "Roman Stricker",
                "Michael Meth",
                "Lukas Postler",
                "Claire Edmunds",
                "Chris Ferrie",
                "Rainer Blatt",
                "Philipp Schindler",
                "Thomas Monz",
                "Richard Kueng",
                "Martin Ringbauer"
            ],
            "title": "Ex- Accepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 10 perimental single-setting quantum state tomography",
            "venue": "PRX Quantum,",
            "year": 2022
        },
        {
            "authors": [
                "H. Chau Nguyen",
                "Jan Lennart B\u00f6nsel",
                "Jonathan Steinberg",
                "Otfried G\u00fchne"
            ],
            "title": "Optimizing shadow tomography with generalized measurements",
            "venue": "Phys. Rev. Lett.,",
            "year": 2022
        },
        {
            "authors": [
                "Hong-Ye Hu",
                "Soonwon Choi",
                "Yi-Zhuang You"
            ],
            "title": "Classical shadow tomography with locally scrambled quantum dynamics",
            "venue": "Physical Review Research,",
            "year": 2023
        },
        {
            "authors": [
                "Christian Bertoni",
                "Jonas Haferkamp",
                "Marcel Hinsche",
                "Marios Ioannou",
                "Jens Eisert",
                "Hakop Pashayan"
            ],
            "title": "Shallow shadows: Expectation estimation using lowdepth random clifford circuits",
            "venue": "arXiv preprint arXiv:2209.12924,",
            "year": 2022
        },
        {
            "authors": [
                "Mirko Arienzo",
                "Markus Heinrich",
                "Ingo Roth",
                "Martin Kliesch"
            ],
            "title": "Closed-form analytic expressions for shadow estimation with brickwork circuits",
            "venue": "arXiv preprint arXiv:2211.09835,",
            "year": 2022
        },
        {
            "authors": [
                "Hong-Ye Hu",
                "Yi-Zhuang You"
            ],
            "title": "Hamiltonian-driven shadow tomography of quantum states",
            "venue": "Phys. Rev. Research,",
            "year": 2022
        },
        {
            "authors": [
                "Minh C Tran",
                "Daniel K Mark",
                "Wen Wei Ho",
                "Soonwon Choi"
            ],
            "title": "Measuring arbitrary physical properties in analog quantum simulation",
            "venue": "Physical Review X,",
            "year": 2023
        },
        {
            "authors": [
                "Max McGinley",
                "Michele Fava"
            ],
            "title": "Shadow tomography from emergent state designs in analog quantum simulators",
            "venue": "arXiv preprint arXiv:2212.02543,",
            "year": 2022
        },
        {
            "authors": [
                "Katherine Van Kirk",
                "Jordan Cotler",
                "Hsin-Yuan Huang",
                "Mikhail D Lukin"
            ],
            "title": "Hardware-efficient learning of quantum many-body states",
            "venue": "arXiv preprint arXiv:2212.06084,",
            "year": 2022
        },
        {
            "authors": [
                "Senrui Chen",
                "Wenjun Yu",
                "Pei Zeng",
                "Steven T. Flammia"
            ],
            "title": "Robust shadow estimation",
            "venue": "PRX Quantum,",
            "year": 2021
        },
        {
            "authors": [
                "Dax Enshan Koh",
                "Sabee Grewal"
            ],
            "title": "Classical shadows with noise. Quantum",
            "year": 2022
        },
        {
            "authors": [
                "Matthias Ohliger",
                "Vincent Nesme",
                "Jens Eisert"
            ],
            "title": "Efficient and feasible state tomography of quantum many-body systems",
            "venue": "New Journal of Physics,",
            "year": 2013
        },
        {
            "authors": [
                "Ahmed A Akhtar",
                "Hong-Ye Hu",
                "Yi-Zhuang You"
            ],
            "title": "Scalable and flexible classical shadow tomography with tensor networks. Quantum",
            "year": 2023
        },
        {
            "authors": [
                "Huangjun Zhu",
                "Richard Kueng",
                "Markus Grassl",
                "David Gross"
            ],
            "title": "The clifford group fails gracefully to be a unitary 4-design",
            "year": 2016
        },
        {
            "authors": [
                "David Gross",
                "Sepehr Nezami",
                "Michael Walter"
            ],
            "title": "Schur\u2013weyl duality for the clifford group with applications: Property testing, a robust hudson theorem, and de finetti representations",
            "venue": "Communications in Mathematical Physics,",
            "year": 2021
        },
        {
            "authors": [
                "Sam McArdle",
                "Suguru Endo",
                "Al\u00e1n Aspuru-Guzik",
                "Simon C. Benjamin",
                "Xiao Yuan"
            ],
            "title": "Quantum computational chemistry",
            "venue": "Rev. Mod. Phys.,",
            "year": 2020
        },
        {
            "authors": [
                "Srilekha Gandhari",
                "Victor V Albert",
                "Thomas Gerrits",
                "Jacob M Taylor",
                "Michael J"
            ],
            "title": "Accepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 11 Gullans. Continuous-variable shadow tomography",
            "venue": "arXiv preprint arXiv:2211.05149,",
            "year": 2022
        },
        {
            "authors": [
                "Simon Becker",
                "Nilanjana Datta",
                "Ludovico Lami",
                "Cambyse Rouz\u00e9"
            ],
            "title": "Classical shadow tomography for continuous variables quantum systems",
            "venue": "arXiv preprint arXiv:2211.07578,",
            "year": 2022
        },
        {
            "authors": [
                "Tianren Gu",
                "Xiao Yuan",
                "Bujiao Wu"
            ],
            "title": "Efficient measurement schemes for bosonic systems",
            "venue": "arXiv preprint arXiv:2210.13585,",
            "year": 2022
        },
        {
            "authors": [
                "Andrew Zhao",
                "Nicholas C. Rubin",
                "Akimasa Miyake"
            ],
            "title": "Fermionic partial tomography via classical shadows",
            "venue": "Phys. Rev. Lett.,",
            "year": 2021
        },
        {
            "authors": [
                "Guang Hao Low"
            ],
            "title": "Classical shadows of fermions with particle number symmetry",
            "venue": "arXiv preprint arXiv:2208.08964,",
            "year": 2022
        },
        {
            "authors": [
                "You Zhou",
                "Pei Zeng",
                "Zhenhuan Liu"
            ],
            "title": "Single-copies estimation of entanglement negativity",
            "venue": "Phys. Rev. Lett.,",
            "year": 2020
        },
        {
            "authors": [
                "Andreas Ketterer",
                "Nikolai Wyderka",
                "Otfried G\u00fchne"
            ],
            "title": "Characterizing multipartite entanglement with moments of random correlations",
            "venue": "Phys. Rev. Lett.,",
            "year": 2019
        },
        {
            "authors": [
                "Xiao-Dong Yu",
                "Satoya Imai",
                "Otfried G\u00fchne"
            ],
            "title": "Optimal entanglement certification from moments of the partial transpose",
            "venue": "Phys. Rev. Lett.,",
            "year": 2021
        },
        {
            "authors": [
                "Zhenhuan Liu",
                "Pei Zeng",
                "You Zhou",
                "Mile Gu"
            ],
            "title": "Characterizing correlation within multipartite quantum systems via local randomized measurements",
            "venue": "Phys. Rev. A,",
            "year": 2022
        },
        {
            "authors": [
                "Jonas Helsen",
                "Michael Walter"
            ],
            "title": "Thrifty shadow estimation: re-using quantum circuits and bounding tails",
            "venue": "arXiv preprint arXiv:2212.06240,",
            "year": 2022
        },
        {
            "authors": [
                "Benoit Collins",
                "Piotr Sniady"
            ],
            "title": "Integration with respect to the haar measure on unitary, orthogonal and symplectic group",
            "venue": "Communications in Mathematical Physics,",
            "year": 2006
        },
        {
            "authors": [
                "Daniel A. Roberts",
                "Beni Yoshida"
            ],
            "title": "Chaos and complexity by design",
            "venue": "Journal of High Energy Physics,",
            "year": 2017
        },
        {
            "authors": [
                "I. Roth",
                "R. Kueng",
                "S. Kimmel",
                "Y.-K. Liu",
                "D. Gross",
                "J. Eisert",
                "M. Kliesch"
            ],
            "title": "Recovering quantum gates from few average gate fidelities",
            "venue": "Phys. Rev. Lett.,",
            "year": 2018
        }
    ],
    "sections": [
        {
            "text": "Performance analysis of multi-shot shadow estimation"
        },
        {
            "heading": "You Zhou and Qing Liu",
            "text": "Key Laboratory for Information Science of Electromagnetic Waves (Ministry of Education), Fudan University, Shanghai 200433, China\nShadow estimation is an efficient method for predicting many observables of a quantum state with a statistical guarantee. In the multi-shot scenario, one performs projective measurement on the sequentially prepared state for K times under the same unitary evolution, and repeats this procedure for M rounds of random sampled unitary, which results in MK times measurements in total. Here we analyze the performance of shadow estimation in this multi-shot scenario, which is characterized by the variance of estimating the expectation value of some observable O. We find that in addition to the shadow-norm \u2225O\u2225shadow introduced in [Huang et.al. Nat. Phys. 2020[1]], the variance is also related to another norm, and we denote it as the cross-shadow-norm \u2225O\u2225Xshadow. For both random Pauli and Clifford measurements, we analyze and show the upper bounds of \u2225O\u2225Xshadow. In particular, we figure out the exact variance formula of Pauli observables for random Pauli measurements. Our work gives theoretical guidance for the application of multi-shot shadow estimation."
        },
        {
            "heading": "1 Introduction",
            "text": "Learning the properties of quantum systems is of fundamental and practical interest, which can uncover quantum physics and enable quantum technologies. Traditional quantum state tomography [2\u20134] is not efficient with the increasing of qubit number in various quantum simulating and computing platforms [5, 6]. Recently, randomized measurements [7], especially the shadow estimation method [1, 8] are proposed for learning the quantum systems efficiently with a statistical guarantee.\nIn shadow estimation, a quantum state \u03c1 is prepared sequentially, evolved by a randomly sampled unitary \u03c1 \u2192 U\u03c1U \u2020, and finally measured in the computational basis. With the measurement results and the information of U , one can construct the shadow snapshot \u03c1\u0302, which is an unbiased estimator of \u03c1. Using a few independent snapshots, many properties described by the observable O, for instance, the local Pauli operators and fidelities to some entangled states [1], can be predicted efficiently. Shadow estimation has been applied to many quantum information tasks, from quantum correlation detection [9\u201311], quantum chaos diagnosis [12, 13], to quantum error mitigation [14, 15], quantum machine learning [16, 17], and near-term quantum algorithms [18]. There are also a few works aiming to enhance the performance of shadow estimation from various perspectives, for instance, derandomization [19] and locally biased shadow for measuring Pauli observables [20, 21], hybrid shadow for polynomial functions [22], single-setting shadow [23],\nYou Zhou : you_zhou@fudan.edu.cn Qing Liu : liuqingppk@gmail.com\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 1\nar X\niv :2\n21 2.\n11 06\n8v 2\n[ qu\nan t-\nph ]\n2 3\nJu n\n20 23\ngeneralized-measurement shadow [24], shadow estimation with a shallow circuit [25\u201327] or restricted unitary evolution [28\u201331], and practical issues considering measurement noises [32, 33].\nIn the current framework, shadow estimation in general needs to sample say M times random unitary to generate M shadow snapshots. However, the execution of different unitary is still resource-consuming in real experiments, which generally means changing control pulses or even physical settings. One direct idea is to add more measurement shots under the same unitary evolution [7, 14], say K-shot per unitary, to compensate for the realization of random unitaries. This strategy, denoted as multi-shot shadow estimation, however, still lacks a rigorous performance analysis compared to the original one.\nIn this work, we fill this gap by giving the statistical guarantee for multi-shot shadow estimation. We estimate the variance of measuring some observable O and relate it to the introduced cross-shadow-norm \u2225O\u2225Xshadow, which supplements the original shadow-norm \u2225O\u2225shadow [1]. The final variance is practically bounded by a interpolation of \u2225O\u2225Xshadow and \u2225O\u2225shadow controlled by the shot-number K. For both Pauli measurements and Clifford measurements, where the random unitary is sampled from single-qubit and global Clifford circuits respectively, we analyze \u2225O\u2225Xshadow and the variance. In the Pauli measurement, we find that multi-shot shadow estimation shows an advantage when estimating Pauli observable, conditioning on the expectation value of that observable. However, in the Clifford measurement, we find no clear benefit of increasing the shot-number K for a given number of random evolution M , especially for estimating the fidelity for many-qubit states. Our work could advance further applications of multi-shot shadow estimation."
        },
        {
            "heading": "2 Multi-shot shadow estimation",
            "text": "In this section, we introduce the background of shadow estimation and its multi-shot extension. Here, we focus on the n-qubit quantum system, that is, the state \u03c1 \u2208 HD with D = 2n, and denote the computational basis of HD as {|b\u27e9} = {|b1b2 \u00b7 \u00b7 \u00b7 bn\u27e9} with bi = 0/1. In shadow estimation [1], one prepares an unknown quantum state \u03c1 in the experiment sequentially for M rounds. In the i-th round, one evolves the quantum system with a random unitary U sampled from some ensemble E to get U\u03c1U \u2020, and measures it in the computational basis to get the result\n\u2223\u2223\u2223b(i)\u232a. We call M the setting-number hereafter, since the sampled unitary U in each round determines the measurement setting. The shadow snapshot can be constructed as follows.\n\u03c1\u0302(i) := M\u22121 ( U \u2020 \u2223\u2223\u2223b\u0302(i)\u232a\u2329b\u0302(i)\u2223\u2223\u2223U) , (1)\nwith b\u0302(i) a random variable. \u03c1\u0302(i) is an unbiased estimator of \u03c1, such that E{U,b(i)} ( \u03c1\u0302(i) )\n= \u03c1. And the inverse (classical) post-processing M\u22121 is determined by the chosen random\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 2\nunitary ensemble [1, 25, 34, 35]. For the n-qubit random Clifford circuit ensemble ECl and the tensor-product of random single-qubit Clifford gate ensemble EPauli, one has M\u22121C = M\u22121n and M\u22121P = \u2297ni=1M \u22121 1 respectively, with M\u22121n (A) = (2n + 1)A \u2212 I2n tr(A) [1]. The random measurements from ECl and EPauli are denoted as Clifford and Pauli measurement primitives respectively.\nAlgorithm 1 Multi-shot shadow estimation Input: M \u00d7 K sequentially prepared \u03c1 Output: The shadow set {\u03c1\u0302(i)}Mi=1.\n1: for i = 1 to M do 2: Randomly choose U \u2208 E and record it. 3: for j = 1 to K do 4: Evolve the state \u03c1 using U to get U\u03c1U \u2020. 5: Measure the state in the computational basis {|b\u27e9}. 6: Construct the unbiased estimator \u03c1\u0302(j)(i) with the result b\n(i,j) by Eq. (1), where i and j denoting the j-th shot under the i-th unitary.\n7: end for 8: Average K results under the same unitary to get \u03c1\u0302(i) = 1K \u2211 j \u03c1\u0302 (j) (i) .\n9: end for 10: Get the shadow set { \u03c1\u0302(1), \u03c1\u0302(2), \u00b7 \u00b7 \u00b7 \u03c1\u0302(M) } , which contains M independent estimators of\n\u03c1.\nIn the multi-shot shadow estimation illustrated in Fig. 1, one conducts K shots by applying the same unitary U sampled in each round, that is, the measurement settings of these K shots are the same. So the total preparation-and-measurement number is MK. Denote the measurement result in i-th round and j-th shot as b(i,j). One can construct the estimator of \u03c1 in this shot as \u03c1\u0302(j)(i) following Eq. (1), and then average on K shots and M rounds to get\n\u03c1\u0302(i) = K\u22121 \u2211\nj\u2208[K] \u03c1\u0302\n(j) (i) , \u03c1\u0302 = M \u22121 \u2211 i\u2208[M ] \u03c1\u0302(i). (2)\nThis procedure is listed in Algorithm 1, and we remark that as K = 1, it reduces to the original shadow estimation.\nTo estimate the expectation value of an observable O, one can construct the unbiased estimator as O\u0302 = tr(O\u03c1\u0302). The performance of shadow estimation is mainly characterized by the variance of o\u0302, which determines the experiment time to control the estimation error,\nVar ( O\u0302 ) = E tr(O\u03c1\u0302)2 \u2212 tr(O\u03c1)2. (3)\nHere, the expectation value is taken on the random unitary U in M rounds and the measurement result b(i,j) in MK shots. In the following sections, we give a general expression for this key quantity, and then analyze the variance for Pauli and Clifford measurements respectively. We remark that even though we focus on estimating one observable O here, the variance result can be applied to simultaneously estimating a set of observables {Oi} by using the median-of-mean technique [1], which is discussed in Appendix B."
        },
        {
            "heading": "3 The general variance expression and cross-shadow-norm",
            "text": "In this section, we give the general variance expression for the multi-shot shadow estimation and relate the variance to the cross-shadow-norm. First, we define two functions of a\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 3\nquantum state \u03c3 and an observable O as follows,\n\u03931(\u03c3, O) := EU \u2211\nb \u27e8b| U\u03c3U \u2020 |b\u27e9 \u27e8b| UM\u22121(O)U \u2020 |b\u27e92 ,\n\u03932(\u03c3, O) := EU \u2211 b,b\u2032 \u27e8b| U\u03c3U \u2020 |b\u27e9 \u27e8b| UM\u22121(O)U \u2020 |b\u27e9 \u2329 b\u2032 \u2223\u2223U\u03c3U \u2020 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223UM\u22121(O)U \u2020 \u2223\u2223b\u2032\u232a , (4) where b, b\u2032 are computational basis for n-bit. The cross-shadow-norm is defined as follows.\nDefinition 1. The cross-shadow-norm (short as XSnorm) of some observable O is defined as\n\u2225O\u2225Xshadow = max \u03c3 state\n\u03932(\u03c3, O) 1 2 . (5)\nThe proof of it being a norm is in Appendix A.1. Note that the original shadow norm (short as Snorm hereafter) is defined as \u2225O\u2225shadow = max\u03c3 \u03931(\u03c3, O) 1 2 [1]. By definition, one has the upper bounds \u03931(\u03c3, O) \u2264 \u2225O\u22252shadow, and \u03932(\u03c3, O) \u2264 \u2225O\u22252Xshadow. Then we show the first result of this work considering the statistical variance for measuring some observable using multi-shot shadow estimation.\nTheorem 1. The statistical variance of tr(O\u03c1\u0302) shows\nVar [tr(O\u03c1\u0302)] = 1 M [ 1 K \u03931(\u03c1, O0) + (1 \u2212 1 K )\u03932(\u03c1, O0) \u2212 tr(O0\u03c1)2 ] , (6)\nwhere O0 = O \u2212 tr(O)ID/D is the traceless part of O, and the functions \u03931, \u03932 are defined in Eq. (4), which can be bounded by the square of the Snorm and XSnorm respectively. As a result, one has the upper bound of the variance as\nVar [tr(O\u03c1\u0302)] \u2264 1 M [ 1 K \u2225O0\u22252shadow + (1 \u2212 1 K )\u2225O0\u22252Xshadow ] . (7)\nThe proof of Theorem 1 is left in Appendix A.2. We remark that as K = 1, the variance in Eq. (6) and the upper bound in Eq. (7) reduce to the result of the original shadow estimation [1]. Note that the variance is an interpolation of the two functions \u03931(\u03c1, O0) and \u03932(\u03c1, O0) with the shot-number K. And the advantage of introducing multi-shot should come from the condition when \u03932(\u03c1, O0) \u226a \u03931(\u03c1, O0). We remark that Ref. [14] also investigated on this kind of multi-shot variance with a focus on quantum error mitigation.\nThe function \u03931(\u03c3, O) and the Snorm \u2225O0\u2225shadow have been extensively studied in Ref. [1]. Thus, the remaining content of this work is to analyze \u03932(\u03c3, O) and the XSnorm \u2225O0\u2225Xshadow. To proceed, one can write \u03932(\u03c3, O) in Eq. (4) in the following twirling channel form.\n\u03932(\u03c3, O) = tr [ \u03c3 \u2297 M\u22121(O) \u2297 \u03c3 \u2297 M\u22121(O) \u03a6(4,E) (\u039bn) ] . (8)\nHere, we denote the 4-fold twirling channel as \u03a6(4,E)(\u00b7) = E{U\u2208E}U \u2020\u22974(\u00b7)U\u22974, which is dependent on the random unitary ensemble E , and the 4-copy n-qubit diagonal operator is defined as\n\u039bn := \u2211 b,b\u2032 (|b\u27e9 \u27e8b|)\u22972 \u2297 ( \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223)\u22972. (9)\nFor the global n-qubit Clifford ensemble, we denote the twirling channel as \u03a6(4,Cl)n , and the one of local Clifford is just the tensor product \u2297n i=1 \u03a6 (4,Cl) 1,(i) .\nIt is known that Clifford ensemble is not a 4-design [36]. Hence, in order to calculate \u03932(\u03c3, O) and the XSnorm, one should apply the representation theory (rep-th) of Clifford\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 4\ngroup in the 4-copy Hilbert space [36, 37]. In the following sections, we first figure out the exact result of random Pauli measurements, say single-qubit Clifford twirling based on direct calculation, without using the rep-th; and then give the bound of \u03932(\u03c3, O) for random Clifford measurements, say n-qubit Clifford twirling with results from rep-th."
        },
        {
            "heading": "4 Variance analysis for Pauli measurements",
            "text": "In this section, we focus on the observable O being an n-qubit Pauli operator P , that is P = \u2297ni=1Pi, with Pi \u2208 {I2, X, Y, Z}. This choice is of practical interest, for example, in the measurement problem in quantum chemistry simulation [19, 20, 38]. We say a Pauli operator P is w-weight, if there are w qubits with Pi \u0338= I2, i.e., there are single-qubit Pauli operators on w qubits and identity operators on the other n \u2212 w qubits. We have the following result for the Pauli observable.\nProposition 1. Suppose O = P is a Pauli observable with weight w, the function \u03932 defined in Eq. (4) shows\n\u0393Pauli2 (\u03c3, P ) = 3w tr(P\u03c3) 2 (10)\nfor the random Pauli measurements. In this case, the XSnorm is \u2225P\u2225PauliXshadow = 3w/2 by Eq. (5).\nWe remark that compared to \u0393Pauli1 (\u03c3, P ) = 3w in the original shadow [1], \u0393Pauli2 (\u03c3, P ) has an extra relevant term, that is the square of the expectation value tr(P\u03c3)2. To prove Proposition 1, we mainly apply the following Lemma 1 of the single-qubit Clifford twirling.\nLemma 1. The 4-fold single-qubit Clifford twirling channel maps the operator\n\u039b1 := \u2211\nb=0,1 \u2211 b\u2032=0,1 |b\u27e9 \u27e8b|\u22972 \u2297 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223\u22972 (11)\ninto \u03a6(4,Cl)1 (\u039b1) =\n1 3 (1 2I \u22972 2 \u2297 F (2) + 12F (2) \u2297 I\u229722 + F(4) ) . (12)\nHere F(t) := 2\u2212t/2(I\u2297t2 + X\u2297t + Y \u2297t + Z\u2297t) on t qubits, and F(2) is the swap operator on two qubits.\nWe prove Lemma 1 by giving the general t-copy twirling result of \u03a6(t,Cl)1 on any Pauli operator in Appendix C.1. Note that the diagonal operator in Eq. (9) can be decomposed to \u039bn = \u2297ni=1\u039b1,(i), and the twirling result in Eq. (8) is thus in the tensor-product form \u2297ni=1\u03a6 (4,Cl) 1,(i) (\u039b1,(i)). Then one can prove Proposition 1 by applying the result of Lemma 1 to Eq. (8) and further calculation, which is left in Appendix C.2. Inserting \u0393Pauli1 (\u03c3, P ) = 3w [1] and the result of \u0393Pauli2 (\u03c3, P ) of Proposition 1 into Eq. (6), one has the following exact variance.\nTheorem 2. Suppose O = P is a Pauli observable with weight w, the variance to measure P using random Pauli measurements is\nVar [tr(P \u03c1\u0302)] = 1 M [ 1 K 3w + (1 \u2212 1 K )3w tr(P\u03c1)2 \u2212 tr(P\u03c1)2 ] . (13)\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 5\n2 with\nw being an even number, and in (d), P = \u03c3\u2297wx \u2297 I \u2297(8\u2212w) 2 , such that tr(P\u03c1)\n2 = 1 and 0 respectively. The red triangles represent the simulated variance which shows consistency with the green dotted line, i.e., the analytical variance given by Eq. (13).\nTheorem 2 shows that the dependence of Var [tr(P \u03c1\u0302)] on the shot-number K is related to tr(P\u03c1)2. For the extreme cases when tr(\u03c1O)2 = 0/1,\nVar [tr(P \u03c1\u0302)] =  1 M 1 K 3w tr(P\u03c1)2 = 0, 1\nM (3w \u2212 1) tr(P\u03c1)2 = 1.\n(14)\nOne can see that when tr(P\u03c1)2 = 1, the variance is independent of the shot-number K; for tr(P\u03c1)2 = 0, the dependence of K is the same as the setting-number M . So it is advantageous to increase K for tr(P\u03c1)2 being small, by considering that it is more convenient to repeat shots than change measurement settings in a real experiment. The variance result here can be extended to any w-local observable following the proof routine in Ref. [1], and this is investigated in Ref. [14]. We give more discussions on this point in Appendix B.\nIn Fig. 2, we show numerical results of the variance dependence on M , K and w, where we perform random Pauli measurements on the Greenberger\u2013Horne\u2013Zeilinger(GHZ) states. Please see Appendix F for details of the numerical simulation, and also extended discussions\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 6\nabout the reduction of experiment time-cost. The numerical results are consistent with the variance given by Eq. (13) and (14)."
        },
        {
            "heading": "5 Variance analysis for Clifford measurements",
            "text": "In this section, we analyze the statistical variance of random Clifford measurements. In this case, the inverse channel maps M\u22121(O0) = (D + 1)O0, and \u03932(\u03c3, O0) in Eq. (8) becomes\n\u0393Cl2 (\u03c3, O0) = (D + 1)2 tr [ \u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 \u03a6(4,Cl)n (\u039bn) ] . (15)\nFor the simplicity of the calculation, we decompose \u039bn = \u039b0n + \u039b1n, with\n\u039b0n = \u2211\nb |b\u27e9 \u27e8b|\u22974 ,\n\u039b1n = \u2211\nb\u0338=b\u2032 |b\u27e9 \u27e8b|\u22972 \u2297 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223\u22972 . (16) To calculate \u0393Cl2 (\u03c3, O0), one should apply the 4-fold twirling result of the Clifford group [36] on \u039b0n and \u039b1n, respectively. And we show in Appendix E that \u039b1n contributes to the leading term of the final result. Since the n-qubit Clifford twirling is quite sophisticated, we do not calculate it in a very exact form but give the following upper bound on \u0393Cl2 (\u03c3, O0).\nProposition 2. Suppose O0 is a traceless observable, the function \u03932 defined in Eq. (4) is upper bounded by\n\u0393Cl2 (\u03c3, O0) \u2264 c\u2225O0\u222522, (17)\nfor the random Clifford measurements, where \u2225A\u22252 = \u221a\ntr(AA\u2020) is the Frobenius norm, and c is some constant independent of the dimension D. In this case, the XSnorm \u2225O0\u2225ClXshadow \u2264 \u221a c\u2225O0\u22252 by Eq. (5).\nFor comparison, in the original shadow [1],\n\u0393Cl1 (\u03c3, O0) = D + 1 D + 2\n[ \u2225O0\u222522 + 2 tr ( \u03c3O20 )2] \u2264 3\u2225O0\u222522, (18)\nand \u2225O0\u2225shadow \u2264 \u221a\n3\u2225O0\u22252, which is qualitatively same to the current multi-shot result. The proof of Proposition 2 is left in Appendix D and E. In Appendix D, we first analyze \u0393Haar2 (\u03c3, O0) in the Haar random case, where the global unitary is sampled from Haar ensemble or any unitary 4-design ensemble. We then extend the result to the Clifford ensemble in Appendix E. For both Haar and Clifford ensembles, we can bound \u03932(\u03c3, O0) in the order O(1)\u2225O0\u222522 as in Proposition 2.\nInserting Eq. (17) in Eq. (6), one has the following variance result.\nTheorem 3. For a general observable O, the variance to measure O using the random Clifford measurements is upper bounded by\nVar [tr(O\u03c1\u0302)] \u2264 1 M [ 3 K + (1 \u2212 1 K )c ] \u2225O0\u222522\n\u2264 c \u2032\nM \u2225O0\u222522,\n(19)\nwith c\u2032 = c + 3 some constant independent of the dimension D, and \u2225A\u22252 = \u221a\ntr(AA\u2020) is the Frobenius norm.\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 7\n2 . Note\nthat the corresponding Frobenius norm \u2225O0\u22252 is about a constant and 2n/2, respectively. The dotted lines and the slopes represent the fitting curves for the corresponding cases, which is consistent with Eq. (19).\nIn the original shadow, the variance bound is about O(1)M\u22121\u2225O0\u222522. Even though Eq. (19) is an upper bound, it already gives a hint that it is not very helpful to increase the shot-number K in the random Clifford measurements. We demonstrate this phenomenon with numerical simulation considering measuring the fidelity. In Fig. 3, we take the state \u03c1 = |GHZ\u03b8\u27e9 \u27e8GHZ\u03b8|, with |GHZ\u03b8\u27e9 = 1/ \u221a 2(|0\u27e9\u2297n + ei\u03b8 |1\u27e9\u2297n), i.e., the GHZ state with some phase. And the observable is taken to be O = |GHZ\u03b8=0\u27e9 \u27e8GHZ\u03b8=0|, that is, measuring the fidelity of the quantum state to the GHZ state. We find that the variance is almost independent with the shot-number K for various choices of \u03b8 which gives different expectation values of tr(O\u03c1). This is very different from the results of random Pauli measurements as shown in Fig. 2."
        },
        {
            "heading": "6 Conclusion and outlook",
            "text": "In this work, we systemically analyze the statistical performance of multi-shot shadow estimation by introducing a key quantity \u2014the cross-shadow-norm. We find the advantage of this framework in Pauli measurements, however, the advantage in Clifford measurements is\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 8\nnot significant. There are a few interesting points that merit further investigation. First, the application of the result of Pauli measurements to quantum chemistry problems is promising, especially combined with other measurement techniques, such as derandomization and local-bias [19, 20]. Second, considering that the advantage of multi-shot for Clifford measurements is minor, it is interesting to investigate whether this hold or not for shallow circuit [25\u201327] or restricted unitary evolution [28\u201331]. Third, it is also intriguing to extend the current analysis to boson [39\u201341] and fermion systems [42, 43], and to nonlinear functions of quantum states [9, 11, 22]. Finally, we expect the result here would also benefit the statistical analysis for other randomized measurement tasks, especially those related to high-order functions [44\u201347].\nWhile completing this work, we became aware of a related work [48] by Jonas Helsen and Michael Walter which also considers shadow estimation under multi-shot. Different from Ref. [48], we analyze the performance under Pauli measurements. Our negative conclusion on Clifford measurements is consistent with theirs. Ref. [48] also demonstrates the weakness of Clifford measurements by giving the exact variance for estimating stabilizerfidelity. Additionally, they nicely extend the Clifford unitary to doped Clifford circuits to bypass this weakness."
        },
        {
            "heading": "7 Acknowledgements",
            "text": "Y.Z. thanks Huangjun Zhu for the useful discussion on unitary design. This work is supported by NSFC Grant No. 12205048 and startup funding from Fudan University."
        },
        {
            "heading": "A Proofs of cross-shadow-norm",
            "text": ""
        },
        {
            "heading": "A.1 Proof of cross-shadow-norm as a norm",
            "text": "First one has \u22250\u2225Xshadow = 0, and then we verify the triangle inequality as follows.\n\u2225O1 + O2\u22252Xshadow =EU \u2211 b,b\u2032 \u27e8b| U\u03c3U \u2020 |b\u27e9 \u27e8b| U [M\u22121(O1) + M\u22121(O2)]U \u2020 |b\u27e9\n\u00d7 \u2329 b\u2032 \u2223\u2223U\u03c3U \u2020 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223U [M\u22121(O1) + M\u22121(O2)]U \u2020 \u2223\u2223b\u2032\u232a\n=\u03932(\u03c3, O1) + \u03932(\u03c3, O2) + 2EU \u2211 b,b\u2032 \u27e8b| U\u03c3U \u2020 |b\u27e9 \u27e8b| UM\u22121(O1)U \u2020 |b\u27e9 \u2329 b\u2032 \u2223\u2223U\u03c3U \u2020 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223UM\u22121(O2)U \u2020 \u2223\u2223b\u2032\u232a \u2264\u2225O1\u22252Xshadow + \u2225O2\u22252Xshadow + 2EU\n\u2211 b \u27e8b| U\u03c3U \u2020 |b\u27e9 \u27e8b| UM\u22121(O1)U \u2020 |b\u27e9 \u2211 b\u2032 \u2329 b\u2032 \u2223\u2223U\u03c3U \u2020 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223UM\u22121(O2)U \u2020 \u2223\u2223b\u2032\u232a\n\u2264\u2225O1\u22252Xshadow + \u2225O2\u22252Xshadow + 2 \u221a \u03932(\u03c3, O1) \u221a \u03932(\u03c3, O2)\n\u2264\u2225O1\u22252Xshadow + \u2225O2\u22252Xshadow + 2 \u221a\n\u2225O1\u2225Xshadow\u2225O2\u2225Xshadow =(\u2225O1\u2225Xshadow + \u2225O2\u2225Xshadow)2.\n(20) Here the first and third inequalities are due to the definition of XSnorm in Eq. (5), and \u03c3 is assumed to be the optimal state in the maximization for O1 + O2, but may be not the optimal one for O1 and O2 respectively. The second inequality is by the Cauchy\u2013Schwarz inequality for the domain of the random unitary U . That is, we can take the formula of the cross term as the inner product of two vectors indexed by U ."
        },
        {
            "heading": "A.2 Proof of Theorem 1",
            "text": "As \u03c1\u0302(i) are M i.i.d. random variables, we only need to focus on a specific i0, and get the final variance by directly dividing it by M . By definition the variance of tr ( O\u03c1\u0302(i0) ) shows\nVar [ tr ( O\u03c1\u0302(i0) )] = E tr ( O\u03c1\u0302(i0) )2 \u2212 tr(O\u03c1)2\n= E tr ( O0\u03c1\u0302(i0) )2 \u2212 tr(O0\u03c1)2.\n(21)\nHere one can shift the operator to its traceless part without changing the variance. The expectation value can be written explicitly as\nE tr ( O\u03c1\u0302(i0) )2 = E  1 K \u2211 j tr ( O\u03c1\u0302 (j) (i0) )2\n= 1 K2 \u2211 j,j\u2032 E tr ( O\u03c1\u0302 (j) (i0) ) tr ( O\u03c1\u0302 (j\u2032) (i0) ) .\n(22)\nThe expectation value of the terms in the summation depends on the coincidence of\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 13\nthe index j. For j = j\u2032 with totally K terms, one has\nE tr ( O\u03c1\u0302\n(j) (i0)\n) tr ( O\u03c1\u0302\n(j) (i0) ) =E \u2329 b\u0302(j)\n\u2223\u2223\u2223UM\u22121(O)U \u2020 \u2223\u2223\u2223b\u0302(j)\u232a2 =EU\n\u2211 b(j) Pr(b(j)|U) \u2329 b(j) \u2223\u2223\u2223UM\u22121(O)U \u2020 \u2223\u2223\u2223b(j)\u232a2 =EU\n\u2211 b(j) \u2329 b(j)\n\u2223\u2223\u2223U\u03c1U \u2020 \u2223\u2223\u2223b(j)\u232a\u2329b(j)\u2223\u2223\u2223UM\u22121(O)U \u2020 \u2223\u2223\u2223b(j)\u232a2 = \u03931(\u03c1, O). (23)\nby definition in Eq. (4). Here in the first equality we insert the definition of \u03c1\u0302(j)(i0), and use the self-adjoint property of the inverse channel M\u22121.\nFor j \u0338= j\u2032 with totally K2 \u2212 K terms, the measurements are under the same setting i0 but for different shots, one has\nE tr ( O\u03c1\u0302\n(j) (i0)\n) tr ( O\u03c1\u0302\n(j\u2032) (i0) ) =E \u2329 b(j)\n\u2223\u2223\u2223UM\u22121(O)U \u2020 \u2223\u2223\u2223b\u0302(j)\u232a\u2329b(j\u2032)\u2223\u2223\u2223UM\u22121(O)U \u2020 \u2223\u2223\u2223b\u0302(j\u2032)\u232a =EU\n\u2211 b(j),b(j\u2032) Pr(b(j)|U) Pr(b(j\u2032)|U) \u2329 b(j) \u2223\u2223\u2223UM\u22121(O)U \u2020 \u2223\u2223\u2223b\u0302(j)\u232a\u2329b(j\u2032)\u2223\u2223\u2223UM\u22121(O)U \u2020 \u2223\u2223\u2223b\u0302(j\u2032)\u232a =EU\n\u2211 b(j),b(j\u2032) \u2329 b(j) \u2223\u2223\u2223U\u03c1U \u2020 \u2223\u2223\u2223b(j)\u232a\u2329b(j\u2032)\u2223\u2223\u2223U\u03c1U \u2020 \u2223\u2223\u2223b(j\u2032)\u232a \u2329b(j)\u2223\u2223\u2223UM\u22121(O)U \u2020 \u2223\u2223\u2223b(j)\u232a\u2329b(j\u2032)\u2223\u2223\u2223UM\u22121(O)U \u2020 \u2223\u2223\u2223b(j\u2032)\u232a =\u03932(\u03c1, O), (24) by definition in Eq. (4), and here the subscript i0 is omitted without ambiguity.\nAs a result, the total variance shows\nVar [tr(O\u03c1\u0302)] = 1 M Var [ tr ( O\u03c1\u0302(i0) )] = 1 M Var [ tr ( O0\u03c1\u0302(i0) )] = 1\nM [ 1 K \u03931(\u03c1, O0) + (1 \u2212 1 K )\u03932(\u03c1, O0) \u2212 tr(O0\u03c1)2 ] , (25)\nand we finish the proof.\nB Variance analysis of a collection of observables In this section, we extend the variance results on a single observable O in the main text to a collection of observable {Oi}Li=1. In particular, we are interested in the summation of them H = \u2211 i O\ni, and each Oi = \u03b1iPi could be proportional to a Pauli operator Pi. For instance, H can be a Hamiltonian of an n-qubit system, and we aim to estimate the expectation value of H within error \u03f5. We first give general formulas of the measurement budget or the variance without a specific chosen random measurements, and then show the result of estimating H under random Pauli measurements, which is of practical interest. For simplicity, we denote the estimator based on the shadow \u03c1\u0302 as O\u0302 = tr(O\u03c1\u0302) and the expectation value as O\u0304 = tr(O\u03c1) in the following discussion.\nWe mainly give two solutions to this task. The first one is directly using the median-ofmean technique for all {Oi}Li=1 following Theorem S1 of Ref. [1]. Remembering that we totally collect M i.i.d. estimators {\u03c1\u0302(k)}, and each of them is composed of measurement data from repeated K-shots as shown in Eq. (2). For the median-of-mean post-processing, {\u03c1\u0302(k)}\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 14\nis grouped into M1 sets with each set containing M2 elements (please refer to Eq. (S12) in Ref. [1] for more details). The estimator for each Oi is denoted as O\u0302i(M1, M2), and H\u0302(M1, M2) is thus the summation of them. Different from estimating each Oi within error \u03f5 there, we should instead keep the whole error within \u03f5. Let \u03f5i = \u03f5\u2225Oi\u2225\u221e/ \u2211 i \u2225Oi\u2225\u221e and\n\u03f5 = \u2211\ni \u03f5i, one can find the following result.\nCorollary 1. Set M1 = 2 log(2L/\u03b4) and M2 = 34\u03f5\u22122 (\u2211 i \u2225Oi\u2225\u221e )2 maxj\u2208[L] Var(O\u0302j/\u2225Oj\u2225\u221e), with the variance dependent on the particular random measurement primitive. A collection of M = M1M2 shadow estimators {\u03c1\u0302(k)}Mk=1 via the the median-of-mean prediction is sufficient to make the estimating error of H = \u2211 i O\ni, |H\u0302(M1, M2) \u2212 H\u0304| \u2264 \u03f5, under confidence level 1 \u2212 \u03b4.\nIn particular, for each Oi = \u03b1iPi and the random Pauli measurements, the number of independent estimators is at most\nM = 68 log(2L/\u03b4)\u03f5\u22122\u2225\u03b1\u20d7\u222521 max j\u2208[L] Var(P\u0302j), (26)\nHere \u2225\u03b1\u20d7\u22251 = \u2211\ni |\u03b1i| is the 1-norm of the coefficient vector, and Var(P\u0302j) of Pauli operator Pj on a single estimator \u03c1\u0302(k0) given in Eq. (13) (i.e., M = 1 there).\nHere the error of estimating H is bounded by the triangle inequality of each error \u03f5i of estimating Oi.\nThe second way is to calculate and bound the variance of H\u0302, based on the variance of each O\u0302i. Let us first define some functions of a state \u03c3 and two observable O1 and O2 generalized from Eq. (4).\n\u03931(\u03c3, O1, O2) := EU \u2211\nb \u27e8b| U\u03c3U \u2020 |b\u27e9 \u27e8b| UM\u22121(O1)U \u2020 |b\u27e9 \u27e8b| UM\u22121(O2)U \u2020 |b\u27e9 ,\n\u03932(\u03c3, O1, O2) := EU \u2211 b,b\u2032 \u27e8b| U\u03c3U \u2020 |b\u27e9 \u27e8b| UM\u22121(O1)U \u2020 |b\u27e9 \u2329 b\u2032 \u2223\u2223U\u03c3U \u2020 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223UM\u22121(O2)U \u2020 \u2223\u2223b\u2032\u232a . (27) One has the following variance result of estimating H.\nTheorem 4. By using multi-shot shadow estimation with M -round and K-shot, the statistical variance of H\u0302 with H = \u2211 i O i shows\nVar(H\u0302) = \u2211\ni Var(O\u0302i) + 2 \u2211 i<j Cov(O\u0302i, O\u0302j). (28)\nThe variance of Var(O\u0302i) is given in Eq. (6), and the covariance can be calculated via\nCov(O\u0302i, O\u0302j) = 1 M [ 1 K \u03931(\u03c1, Oi, Oj) + (1 \u2212 1 K )\u03932(\u03c1, Oi, Oj) \u2212 O\u0304iO\u0304j ] . (29)\nThe proof follows similarly to that of Theorem 1 in Sec. A.2. In principle, one can calculate Cov(O\u0302i, O\u0302j) via Eq. (29), similar as we have done in main text for Var(O\u0302i). For the random Pauli measurements, Ref. [1] and Ref. [14] investigate \u03931(\u03c1, Oi, Oj) and \u03932(\u03c1, Oi, Oj) for two Pauli observables, respectively.\nHere for a supplement, we further give some bound for the total variance Var(H\u0302). Note that Cov(O\u0302i, O\u0302j) \u2264 \u221a Var(O\u0302i)Var(O\u0302j) by Cauchy\u2013Schwarz inequality, and thus one has\nVar(H\u0302) \u2264 [\u2211\ni\n\u221a Var(O\u0302i) ]2 . Applying this to random Pauli measurements, one finally gets\nthe following result.\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 15\nCorollary 2. For H = \u2211\ni \u03b1iPi and the random Pauli measurements, the variance of estimating H is upper bounded by\nVar(H\u0302) \u2264 [\u2211\ni\n\u221a Var(\u03b1iP\u0302i) ]2 \u2264 \u2225\u03b1\u20d7\u222521 max\nj\u2208[L] Var(P\u0302j). (30)\nwith Var(P\u0302j) given in Eq. (13).\nThe second inequality in Eq. (30) is by the Holder\u2019s inequality (p = 1, q = \u221e). By adopting the median-of-mean technique only for a single observerble H, one sets M1 = 2 log(2/\u03b4) and M2 = 34\u03f5\u22122Var(H\u0302), with the variance on a single estimator \u03c1\u0302(k0). In this way, a collection shadow estimators {\u03c1\u0302(k)}Mi=1 is sufficient to make the estimator error less than \u03f5 under confidence 1 \u2212 \u03b4. By using upper bound in Eq. (30), one has M at most being\nM = 68 log(2/\u03b4)\u03f5\u22122 [\u2211\ni\n\u221a Var(\u03b1iP\u0302i) ]2 \u2264 68 log(2/\u03b4)\u03f5\u22122\u2225\u03b1\u20d7\u222521 max\nj\u2208[L] Var(P\u0302j).\n(31)\nIt is clear that the upper bound of M obtained here is better than the one in Eq. (26). We remark that one can also apply Cauchy\u2013Schwarz inequality to Eq. (30) to find\nanother upper bound Var(H\u0302) \u2264 \u2225\u03b1\u20d7\u222522 \u2211\nj Var(P\u0302j). Note that Var(P\u0302j) is a function of wi, P\u0304i and the shot-number K. One may further utilizes the commuting relation among the operators {Pi} of interest to minimize the measurement budget, and we leave it to some further study."
        },
        {
            "heading": "C Proof for random Pauli measurements",
            "text": ""
        },
        {
            "heading": "C.1 Proof of Lemma 1",
            "text": "We first decompose \u039b1 defined in Lemma 1 into the Pauli operator representation as follows.\n\u039b1 = \u2211\nb |b\u27e9 \u27e8b|\u22972 \u2211 b\u2032 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223\u22972 = 12(I2 \u2297 I2 + Z \u2297 Z) \u2297 1 2(I2 \u2297 I2 + Z \u2297 Z) = 14(I \u22974 2 + I \u22972 2 Z \u22972 + Z\u22972I\u229722 + Z\u22974)\n(32)\nHere I2 and Z are single-qubit identity and Pauli Z operator. By inserting this decomposition inside the 4-copy single-qubit Clifford twirling channel,\n\u03a6(4,Cl)1 [ 1 4(I \u22974 2 + I \u22972 2 Z \u22972 + Z\u22972I\u229722 + Z\u22974)]\n=14[I \u22974 2 + I \u22972 2 \u2297 \u03a6 (2,cl) 1 (Z\u22972) + \u03a6 (2,cl) 1 (Z\u22972) \u2297 I \u22972 2 + \u03a6 (4,cl) 1 (Z\u22974)] =14[I \u22974 2 + I \u22972 2 1 3(2F (2) \u2212 I\u22972) + 13(2F (2) \u2212 I\u22972)I\u229722 + (4F(4) \u2212 I \u22974 2 )/3] =1/6I\u229722 F(2) + 1/6F(2)I \u22972 2 + 1/3F(4).\n(33)\nIn the second line: the first term is due to \u03a6(4,Cl)1 being unital, the two terms in the middle reduce to 2-copy twirling, and the last term is still a 4-copy twirling. In the third line, we insert the result of the following Lemma.\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 16\nLemma 2. The t-fold single-qubit Clifford twirling channel maps any Pauli operator P \u2297t1 with P1 \u2208 {X, Y, Z} into\n\u03a6(t,Cl)1 (P \u2297t 1 ) =  1 3(X \u2297t + Y \u2297t + Z\u2297t) = (2t/2F(t) \u2212 I\u2297t2 )/3, t even\n0, t odd (34)\nwhere in the first line we define F(t) := 2\u2212t/2(I\u2297t2 +X\u2297t +Y \u2297t +Z\u2297t), and F(2) is the swap operator on two qubits.\nProof. By definition, random single-qubit Clifford gate takes P1 \u2208 {X, Y, Z} uniformly to all six directions in the Bloch sphere, i.e., {\u00b1X, \u00b1Y, \u00b1Z}. Consequently, the final result is the average of six terms, i.e., 1/6 \u2211 P1\u2208{\u00b1X,\u00b1Y,\u00b1Z} P \u2297t 1 . In the even t case, we thus have the equal weight summation of X\u2297t, Y \u2297t, Z\u2297t. In the odd k case, X\u2297t and (\u2212X)\u2297t cancel with each other, same for Y, Z terms, thus it returns zero."
        },
        {
            "heading": "C.2 Proof of Proposition 1",
            "text": "Proof. Without loss of generality, suppose P = P1 \u2297 \u00b7 \u00b7 \u00b7 Pw \u2297 I[n\u2212w] with the first w-qubit owning Pauli operator, and of course traceless. The inverse channel maps M\u22121(O) =\u2297n\ni=1 M\u221211 (O) = \u2297w i=1 3Pi \u2297 I[n\u2212w]. By definition of Eq. (4), one has EU \u2211 b,b\u2032 \u27e8b| U\u03c3U \u2020 |b\u27e9 \u2329 b\u2032 \u2223\u2223U\u03c3U \u2020 \u2223\u2223b\u2032\u232a \u27e8b| UM\u22121(O)U \u2020 |b\u27e9 \u2329b\u2032\u2223\u2223UM\u22121(O)U \u2020 \u2223\u2223b\u2032\u232a\n=EU=\u2297n i=1 ui \u2211 b1,\u00b7\u00b7\u00b7 ,bn;b\u20321,\u00b7\u00b7\u00b7 ,b\u2032n\ntr [ \u03c3\u22972\nn\u2297 i=1 (u\u2020i |bi\u27e9 \u27e8bi| ui) n\u2297 i=1 (u\u2020i \u2223\u2223b\u2032i\u232a \u2329b\u2032i\u2223\u2223ui) ]\n\u00d7 w\u220f\ni=1 \u27e8bi| ui3Piu\u2020i |bi\u27e9 w\u220f i=1 \u2329 b\u2032i \u2223\u2223ui3Piu\u2020i \u2223\u2223b\u2032i\u232a\n=E\u2297w i=1 ui \u2211 b1,\u00b7\u00b7\u00b7 ,bw;b\u20321,\u00b7\u00b7\u00b7 ,b\u2032w\ntr [ \u03c3\u22972\nw\u2297 i=1 (u\u2020i |bi\u27e9 \u27e8bi| ui) \u2297 I[n\u2212w] w\u2297 i=1 (u\u2020i \u2223\u2223b\u2032i\u232a \u2329b\u2032i\u2223\u2223ui) \u2297 I[n\u2212w] ]\n\u00d7 w\u220f\ni=1 \u27e8bi| ui3Piu\u2020i |bi\u27e9 w\u220f i=1 \u2329 b\u2032i \u2223\u2223ui3Piu\u2020i \u2223\u2223b\u2032i\u232a\n=E\u2297w i=1 ui \u2211 b1,\u00b7\u00b7\u00b7 ,bw;b\u20321,\u00b7\u00b7\u00b7 ,b\u2032w tr [ \u03c3\u22972[m] w\u2297 i=1 (u\u2020i |bi\u27e9 \u27e8bi| ui) w\u2297 i=1 (u\u2020i \u2223\u2223b\u2032i\u232a \u2329b\u2032i\u2223\u2223ui) ]\n\u00d7 w\u220f\ni=1 \u27e8bi| ui3Piu\u2020i |bi\u27e9 w\u220f i=1 \u2329 b\u2032i \u2223\u2223ui3Piu\u2020i \u2223\u2223b\u2032i\u232a\n=32w tr (\u03c3[w] w\u2297 i=1 Pi)\u22972 E\u2297w i=1 ui \u2211 b1,\u00b7\u00b7\u00b7 ,bw;b\u20321,\u00b7\u00b7\u00b7 ,b\u2032w w\u2297 i=1 [(u\u2020i |bi\u27e9 \u27e8bi| ui) \u22972 \u2297 (u\u2020i \u2223\u2223b\u2032i\u232a \u2329b\u2032i\u2223\u2223ui)\u22972] \n=32w tr (\u03c3[w] w\u2297 i=1 Pi)\u22972 w\u2297 i=1 \u03a6(4,Cl)1,(i) \u2211 bi |bi\u27e9 \u27e8bi|\u22972 \u2211 b\u2032i \u2223\u2223b\u2032i\u232a \u2329b\u2032i\u2223\u2223\u22972 \n(35) Here in the first equality, we write the random unitary U = \u2297n i=1 ui and computational basis summation b = {b1b2 \u00b7 \u00b7 \u00b7 bn}, b\u2032 = {b\u20321b\u20322 \u00b7 \u00b7 \u00b7 b\u2032n} on the single-qubit level; in the second\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 17\nequality we sum the bi, b\u2032i for i > w in the trace, and it gives I[n\u2212w] on the last n\u2212w qubits no matter what ui is chosen. And the problem is reduced on the first w-qubit in the third equality, with \u03c3[m] the reduced state of the first m-qubit from \u03c3. In the last two lines, we arrange these operators and relate the result to the single-qubit Clifford twirling.\nBy inserting the Eq. (12) of Lemma. 1, one finally has\n\u03932(\u03c3, P ) =3w tr [ (\u03c3[w] w\u2297 i=1 Pi)\u22972 w\u2297 i=1 (1 2I \u22972 i \u2297 F (2) i + 1 2F (2) i \u2297 I \u22972 i + F (4) i )]\n=3w tr [ (\u03c3[w] w\u2297 i=1 Pi)\u22972 w\u2297 i=1 ( F(4)i )]\n=3w tr (\n\u03c3[w] w\u2297 i=1 Pi\n)2 = 3w tr(\u03c3P )2.\n(36)\nHere the second line is by the following fact. Suppose there is an appearance of I\u22972i \u2297F (2) i or F(2)i \u2297 I \u22972 i on i-th qubit, then the identity operator on the first or last two-copy would result in tr(Pi) = 0, such that gives no contribution to the final result. Consequently, we are left only F(4)i . In the final line, \u2297w i=1 ( F(4)i ) contains all possible w-qubit Pauli\noperators, and only the one \u2297w\ni=1 Pi contributes to the final result."
        },
        {
            "heading": "D Statistical analysis for Haar random measurements",
            "text": "In this section, we aim to give the statistical analysis for the global Haar random measurement, that is, the unitary ensemble E is Haar random on HD (or any unitary 4-design ensemble). The central result shows as follows, as an analog of Proposition 2 in main text.\nProposition 3. Suppose O0 is a traceless observable, the function \u03932 defined in Eq. (4) is upper bounded by\n\u0393Haar2 (\u03c3, O0) \u2264 c1\u2225O0\u222522, (37)\nfor the random Haar measurements, where \u2225A\u22252 = \u221a\ntr(AA\u2020) is the Frobenius norm, and c1 is some constant independent of the dimension D. In this case, the XSnorm \u2225O0\u2225HaarXshadow \u2264 \u221a c1\u2225O0\u22252 by Eq. (5).\nThe main task of this section is to prove this proposition, which is helpful for the discussion of random Clifford measurements shown in the next section.\nRecall the essential quantity in Eq. (15) we would like to calculate shows\n\u0393Haar2 = (D + 1)2 tr [ \u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 \u03a6(4,Haar)n (\u039bn) ] = (D + 1)2 tr [ \u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 \u03a6(4,Haar)n ( \u039b0n + \u039b1n\n)] (38) with the only difference being that we use the Haar twirling \u03a6(4,Haar) here, and \u039bn is decomposed into two parts as in main text,\n\u039b0n = \u2211\nb |b\u27e9 \u27e8b|\u22974 ,\n\u039b1n = \u2211\nb\u0338=b\u2032 |b\u27e9 \u27e8b|\u22972 \u2297\n\u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223\u22972 .\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 18\nBefore we calculate their contributions separately in the next subsections, we give a brief review of the result of the t-copy Haar twirling, and more details can be found in, for example Ref. [49\u201351]. Denote the permutation elements of the t-th order symmetric group as \u03c0 \u2208 St, and there is a unitary representation of \u03c0 on the t-copy Hilbert space H\u2297tD as\nT\u03c0 |b1, b2, \u00b7 \u00b7 \u00b7 , bt\u27e9 = \u2223\u2223\u2223b\u03c0(1), b\u03c0(2), \u00b7 \u00b7 \u00b7 , b\u03c0(t)\u232a , (39)\nwith |b\u27e9 the basis state for one copy. By the celebrated Schur\u2013Weyl duality, the twirling result is related to the irreducible representation (ir-rep) of St as follows.\nLemma 3. The t-fold Haar twirling channel maps A \u2208 H\u2297tD into\n\u03a6(t,Haar)(A) = 1 t! \u2211\n\u03c0\u2208St tr(AT\u03c0)T\u03c0\u22121 \u2211 \u03bb d\u03bb D\u03bb P\u03bb, (40)\nwhere \u03bb denotes the irreducible representation of St, and P\u03bb is the corresponding projector showing\nP\u03bb = d\u03bb t! \u2211\n\u03c0\u2208St \u03c7\u03bb(\u03c0)T\u03c0, (41)\nwith \u03c7\u03bb(\u03c0) being the character of \u03c0."
        },
        {
            "heading": "D.1 The contribution of \u039b0n in Haar case",
            "text": "Inserting the term \u039b0n in the 4-copy Haar twirling channel in Eq. (40) with t = 4 one has\n\u03a6(4,Haar)(\u039b0n) = 1 4! \u2211\n\u03c0\u2208S4 \u2211 b tr ( |b\u27e9 \u27e8b|\u22974 T\u03c0\u22121 ) T\u03c0 \u2211 \u03bb d\u03bb D\u03bb P\u03bb\n= D4! \u2211 \u03c0\u2208S4 T\u03c0 \u2211 \u03bb d\u03bb D\u03bb P\u03bb\n= DPsym \u2211\n\u03bb\nd\u03bb D\u03bb P\u03bb\n= D Dsym Psym = D 4!Dsym \u2211 \u03c0\u2208Sk \u03c0\n(42)\nHere the second line is by the fact tr ( |b\u27e9 \u27e8b|\u22974 T\u03c0\u22121 ) = 1 for any b and \u03c0; the third line\nis by the definition of the symmetric subspace as Psym = 14! \u2211\n\u03c0\u2208S4 T\u03c0; the final line is by the fact that symmetric subspace is one of the ir-rep subspace and orthogonal to others. Inserting this twirling result and the dimension Dsym = (D + 3)(D + 2)(D + 1)D/4!, one has\n(D + 1)2 tr [ \u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 \u03a6(4,Haar) ( \u039b0n )]\n= (D + 1) 2D (D + 3)(D + 2)(D + 1)D \u2211\n\u03c0\u2208Sk\ntr(\u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 T\u03c0)\n=O(D\u22121) \u2211\n\u03c0\u2208S4 tr(\u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 T\u03c0) = O(D\u22121) tr\n( O20 ) (43)\nThe final line shows that the result is in the order O(D\u22121) tr ( O20 ) , by the following lemma.\nLemma 4. For any \u03c0 \u2208 S4, the following inequality holds for a quantum state \u03c3 and a traceless observable O0,\ntr(\u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 T\u03c0) \u2264 tr ( O20 ) . (44)\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 19\nProof. For the permuation operator T\u03c0, the formula could take the following values: tr ( \u03c32 ) tr ( O20 ) , tr ( O20 ) , tr ( O20\u03c3 ) , tr ( O20\u03c3 2), tr(O0\u03c3O0\u03c3). All these can be bounded by tr ( O20 ) . We bound the last one with Cauchy\u2013Schwarz inequality for operator as follows.\ntr(O0\u03c3O0\u03c3) \u2264 \u2225O0\u03c3\u222522 = \u221a tr(O0\u03c3\u03c3O0) 2 = tr ( O20\u03c3 2 ) \u2264 \u2225O20\u2225\u221e \u2264 tr ( O20 ) . (45)"
        },
        {
            "heading": "D.2 The contribution of \u039b1n in Haar case",
            "text": "For the second term of \u039b1n, by inserting the Haar twirling channel in Eq. (40) with t = 4, one has\n\u03a6(4,Haar)(\u039b1n) = 1 4! \u2211\n\u03c0\u2208S4 \u2211 b\u0338=b\u2032 tr ( |b\u27e9 \u27e8b|\u22972 \u2297 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223\u22972 T\u03c0\u22121)T\u03c0 \u2211 \u03bb d\u03bb D\u03bb P\u03bb\n= 14!(D 2 \u2212 D) \u2211 \u03c0\u2208Sr \u03c0 \u2211 \u03bb d\u03bb D\u03bb P\u03bb = 16(D 2 \u2212 D) \u2211 \u03bb d\u03bb D\u03bb PrP\u03bb.\n(46)\nHere the second line is by the fact that the trace formula gives zero unless \u03c0 \u2208 Sr, with the set Sr = {(), (12), (34), (12)(34)} being a subgroup of S4. And we define the corresponding projector as Pr = 14 \u2211 \u03c0\u2208Sr T\u03c0. One thus further gets (D + 1)2 tr [ \u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 \u03a6(4,Haar) ( \u039b1n )]\n=16(D 2 \u2212 D)(D + 1)2 \u2211 \u03bb d\u03bb D\u03bb tr(\u03c3 \u2297 O \u2297 \u03c3 \u2297 O PrP\u03bb)\n(47) Recall the definition of P\u03bb in Eq. (41), and for each ir-rep \u03bb, one has\nd\u03bb D\u03bb tr(\u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 PrP\u03bb) = d2\u03bb D\u03bb 1 4 \u2217 4! \u2211 \u03c0\u2032\u2208Sr,\u03c0\u2208S4 \u03c7\u03bb(\u03c0) tr(\u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 T\u03c0\u2032T\u03c0)\n= d 2 \u03bb\nD\u03bb\n1 4 \u2217 4! \u2211 \u03c0\u2032\u2208Sr,\u03c0\u2208S4 \u03c7\u03bb(\u03c0) tr(\u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 T\u03c0\u2032\u03c0)\n\u2264 d 2 \u03bb\nD\u03bb |\u03c7\u03bb(\u03c0)|max \u03c0\u2208S4 tr\n( O20 ) (48)\nwhere the last line we use Lemma 4 for each T\u03c0\u2032\u03c0. Here |\u03c7\u03bb(\u03c0)|max \u03c0\u2208S4 \u2264 3 , d2\u03bb D\u03bb\n= O(D\u22124) for any ir-rep \u03bb, and there are totally 5 ir-reps [36]. As a result one has\n(D + 1)2 tr [ \u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 \u03a6(4,Haar) ( \u039b1n )]\n< 1 6(D\n2 \u2212 D)(D + 1)2 [\u2211\n\u03bb\nd2\u03bb D\u03bb |\u03c7\u03bb(\u03c0)|max \u03c0\u2208S4\n] tr ( O20 ) = O(1) tr ( O20\n) (49)\nInserting Eq. (43) and Eq. (49) into Eq. (38), we finish the proof of Proposition 3.\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 20"
        },
        {
            "heading": "E Statistical analysis for random Clifford measurements",
            "text": "Similar as the Haar case, here the we should calculate the quantity in Eq. (15) shown as follows,\n\u0393Cl2 (\u03c3, O0) = (D + 1)2 tr [ \u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 \u03a6(4,Cl)n ( \u039b0n + \u039b1n )] . (50)\nIn the following subsections, as in the Haar case, we evaluate the contributions from \u039b0n and \u039b1n separately. As Clifford circuit is not a 4-design, the 4-copy twirling result is a little different compared to Eq. (40), which is shown as follows. One can refer to Ref. [36, 51, 52] for more details.\nLemma 5. The 4-fold n-qubit Clifford twirling channel maps A \u2208 H\u22974D into\n\u03a6(4,Cl)n (A) = 1 4! \u2211\n\u03bb\nd\u03bb \u2211\n\u03c0\u2208S4 [ 1 D+\u03bb tr(AQT\u03c0)T\u03c0\u22121Q + 1 D\u2212\u03bb tr ( AQ\u22a5T\u03c0 ) T\u03c0\u22121Q \u22a5]P\u03bb (51)\nwhere \u03bb denotes the irreducible representation of St, and P\u03bb is the corresponding projector shown in Eq. (41) with t = 4. The operator Q is a stabilizer code subspace projector, commuting with any T\u03c0 and P\u03bb,\nQ = 1 D2 \u2211 k W \u22974k (52)\nwith Wk running on all D2 n-qubit Pauli operators including the identity; and Q\u22a5 = I\u22974D \u2212 Q."
        },
        {
            "heading": "E.1 The contribution of \u039b0n in Clifford case",
            "text": "For the first term \u039b0n, by using the twirling formula in Eq. (51) one has \u03a6(4,Cl)n (\u039b0n) = 1 4! \u2211\n\u03bb\nd\u03bb \u2211\n\u03c0\u2208S4 \u2211 b [ 1 D+\u03bb tr ( |b\u27e9 \u27e8b|\u22974 QT\u03c0\u22121 ) T\u03c0Q + 1 D\u2212\u03bb tr ( |b\u27e9 \u27e8b|\u22974 Q\u22a5T\u03c0\u22121 ) T\u03c0Q \u22a5]P\u03bb\n= 14! \u2211\n\u03bb\nd\u03bb \u2211\n\u03c0\u2208S4 \u2211 b [ 1 D+\u03bb tr ( |b\u27e9 \u27e8b|\u22974 Q ) T\u03c0Q + 1 D\u2212\u03bb tr ( |b\u27e9 \u27e8b|\u22974 Q\u22a5 ) T\u03c0Q \u22a5]P\u03bb\n= 14! \u2211\n\u03bb\nd\u03bb \u2211\n\u03c0\u2208S4 D[ 1 D+\u03bb D Q + 1 D\u2212\u03bb (1 \u2212 1/D)Q\u22a5]T\u03c0P\u03bb\n= \u2211\n\u03bb\nd\u03bb[ 1 D+\u03bb Q + D \u2212 1 D\u2212\u03bb Q\u22a5] \u2211 \u03c0\u2208S4 1 4!T\u03c0 P\u03bb\n= [ 1 D+sym Q + D \u2212 1 D\u2212sym Q\u22a5]Psym.\n(53) Here in the second line, we use the fact that T\u03c0 |b\u27e9\u22974 = |b\u27e9\u22974 for any \u03c0. In the third line, tr ( |b\u27e9 \u27e8b|\u22974 Q ) = 1/D, since Wk which only contains {I2, Z} on each qubit contributes to\nit and there are totally 2n = D such terms. Therefore, tr ( |b\u27e9 \u27e8b|\u22974 Q\u22a5 ) = 1\u22121/D. In the\nfinal line, we only have Psym due to the orthogonality of each P\u03bb. Inserting this twirling result into the trace formula in Eq. (50) one gets\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 21\n(D + 1)2 tr [ \u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 \u03a6(4,Cl)n ( \u039b0n )]\n=(D + 1)2( 1 D+sym \u2212 D \u2212 1 D\u2212sym ) tr[\u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 QPsym] + (D + 1)2 D \u2212 1 D\u2212sym tr[\u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 Psym] =O(1) tr[\u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 QPsym] + O(D\u22121) tr[\u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 Psym]\n=O(D\u22121) tr ( O20 ) (54) where in the third line we use the fact D+sym = O(D\u22122) and D\u2212sym = O(D\u22124) [36]; in the last line, the second term is directly from the result in Eq. (43) of the Haar case, and the first term is on account of the following Lemma 6, by taking P0 = Psym and P1 = I there. In total, we thus show that the contribution from \u039b0n is still in the order O(D\u22121) tr ( O2 ) as in the Haar case.\nLemma 6. For any two projectors P0 and P1, which may not commute with each other but commute with Q, the following inequality holds for a quantum state \u03c3 and an observable O,\ntr(\u03c3 \u2297 O \u2297 \u03c3 \u2297 O QP0P1) \u2264 D\u22121 tr ( O2 ) . (55)\nProof. Suppose the spectrum decomposition of the observable is O = \u2211\nj aj |\u03a8j\u27e9 \u27e8\u03a8j |, and we define the operator O\u2032 = \u2211 j i \u03b4(aj<0)|aj | 1 2 |\u03a8j\u27e9 \u27e8\u03a8j |, such that O\u20322 = O and O\u2032O\u2032\u2020 =\u221a\nO2.\ntr(\u03c3 \u2297 O \u2297 \u03c3 \u2297 O QP0P1) = tr ( \u03c3 1 2 \u2297 O\u2032 \u2297 \u03c3 1 2 \u2297 O\u2032Q P0P1Q\u03c3 1 2 \u2297 O\u2032 \u2297 \u03c3 1 2 \u2297 O\u2032 ) \u2264 \u2225\u03c3 1 2 \u2297 O\u2032 \u2297 \u03c3 1 2 \u2297 O\u2032Q\u22252 \u2225P0P1Q\u03c3 1 2 \u2297 O\u2032 \u2297 \u03c3 1 2 \u2297 O\u2032\u22252\n\u2264 \u2225\u03c3 1 2 \u2297 O\u2032 \u2297 \u03c3 1 2 \u2297 O\u2032Q\u222522 = tr ( \u03c3 \u2297 O\u2032O\u2032\u2020 \u2297 \u03c3 \u2297 O\u2032O\u2032\u2020Q ) (56)\nthe first inequality is by using the Cauchy\u2013Schwarz inequality, and the second inequality is by\n\u2225P0P1Q\u03c3 1 2 \u2297 O\u2032 \u2297 \u03c3 1 2 \u2297 O\u2032\u22252 = \u221a tr(\u03c3 \u2297 O\u2032O\u2032\u2020 \u2297 \u03c3 \u2297 O\u2032O\u2032\u2020QP1P0P1Q)\n\u2264 \u221a tr(\u03c3 \u2297 O\u2032O\u2032\u2020 \u2297 \u03c3 \u2297 O\u2032O\u2032\u2020Q) = \u2225\u03c3 1 2 \u2297 O\u2032 \u2297 \u03c3 1 2 \u2297 O\u2032Q\u22252,\n(57) since P1P0P1 \u2264 P1 \u2264 I.\nTo further bound Eq. (56), we insert the formula of Q in Eq. (52) to get\ntr(\u03c3 \u2297 O \u2297 \u03c3 \u2297 O QP0P1) \u2264 tr ( \u03c3 \u2297 O\u2032O\u2032\u2020 \u2297 \u03c3 \u2297 O\u2032O\u2032\u2020Q ) = D\u22122\n\u2211 k tr(\u03c3Wk)2 tr (\u221a O2Wk )2\n\u2264 D\u22122 \u2211\nk\ntr (\u221a O2Wk )2\n= D\u22121 tr ( O2 ) .\n(58)\nHere the second inequality is by the fact tr(\u03c3Wk)2 \u2264 1, and the last line is by the decomposition of the n-qubit swap operator in the Pauli basis as S = D\u22121 \u2211 k Wk \u2297 Wk.\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 22"
        },
        {
            "heading": "E.2 The contribution of \u039b1n in Clifford case",
            "text": "For the second term \u039b1n, by using the twirling formula in Eq. (51) one has\n\u03a6(4,Cl)n (\u039b1n) = 1 4! \u2211\n\u03bb\nd\u03bb \u2211\n\u03c0\u2208S4 \u2211 b\u0338=b\u2032 [ 1 D+\u03bb tr ( |b\u27e9 \u27e8b|\u22972 \u2297 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223\u22972 QT\u03c0)T\u03c0\u22121Q + 1\nD\u2212\u03bb tr ( |b\u27e9 \u27e8b|\u22972 \u2297 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223\u22972 Q\u22a5T\u03c0)T\u03c0\u22121Q\u22a5]P\u03bb (59)\nWe define the first trace formula as Q0(\u03c0) := tr ( |b\u27e9 \u27e8b|\u22972 \u2297 \u2223\u2223b\u2032\u232a \u2329b\u2032\u2223\u2223\u22972 QT\u03c0) =D\u22122\n\u2211 k \u27e8b| Wk \u2297 \u27e8b| Wk \u2297 \u2329 b\u2032 \u2223\u2223Wk \u2297 \u2329b\u2032\u2223\u2223Wk T\u03c0 |b\u27e9 \u2297 |b\u27e9 \u2297 \u2223\u2223b\u2032\u232a\u2297 \u2223\u2223b\u2032\u232a . (60)\nThere are two cases which give nonzero value depending on \u03c0. In the first case, via the permutation T\u03c0, |b\u27e9 is connected to \u27e8b|, and this also holds for b\u2032. That is, \u03c0 \u2208 Sr with the set Sr = {(), (12), (34), (12)(34)} and one has | \u27e8b| Wk |b\u27e9 |2| \u27e8b\u2032| Wk |b\u2032\u27e9 |2. As in the Haar case, one can only choose Wk with {I2, Z} for each qubit, so it gives D/D2 = D\u22121. In the second case, all |b\u27e9 are connected to \u27e8b\u2032|, that is \u03c0 \u2208 Sr\u2032 , with Sr\u2032 = (13)(24)Sr = Sr(13)(24). And one has | \u27e8b| Wk |b\u2032\u27e9 |4. For b \u0338= b\u2032, one needs to choose {I2, Z} for the qubit with the same bit value of b and b\u2032, and {X, Y } for the qubit of different bit values. Thus the result is also D\u22121. Besides these two cases, the term shows | \u27e8b| Wk |b\u2032\u27e9 |2 \u27e8b| Wk |b\u27e9 | \u27e8b\u2032| Wk |b\u2032\u27e9. It is not hard to see that it is 0 no matter what Wk is.\nDefine Q1(\u03c0) := tr ( |b\u27e9 \u27e8b|\u22972 \u2297 |b\u2032\u27e9 \u27e8b\u2032|\u22972 Q\u22a5T\u03c0 ) . Note that Q0(\u03c0) + Q1(\u03c0) = 1 when\n\u03c0 \u2208 Sr, otherwise it is 0, as shown in the Haar case. We thus have\nQ0(\u03c0) = {\nD\u22121, \u03c0 \u2208 Sr \u222a Sr\u2032 0, \u03c0 \u2208 S4 \\ (Sr \u222a Sr\u2032)\nQ1(\u03c0) =  1 \u2212 D\u22121, \u03c0 \u2208 Sr \u2212 D\u22121, \u03c0 \u2208 Sr\u2032 0, \u03c0 \u2208 S4 \\ (Sr \u222a Sr\u2032) (61)\nInserting these into Eq. (59), and define the projector Pr\u2032 = 14 \u2211\n\u03c0\u2208Sr\u2032 T\u03c0 similar as Pr in the Haar case, one has\n\u03a6(4,Cl)n (\u039b1n)\n= 14! \u2211\n\u03bb\nd\u03bb(D2 \u2212 D)  1D+\u03bb D\u22121 \u2211 \u03c0\u2208Sr\u222aSr\u2032 T\u03c0Q + 1 D\u2212\u03bb (1 \u2212 D\u22121) \u2211 \u03c0\u2208Sr T\u03c0 \u2212 D\u22121 \u2211 \u03c0\u2032\u2208Sr\u2032 T\u03c0\u2032 Q\u22a5 P\u03bb\n= \u2211\n\u03bb\n\u03981(\u03bb)QPrP\u03bb + \u03982(\u03bb)QPr\u2032P\u03bb + \u03983(\u03bb)PrP\u03bb + \u03984(\u03bb)Pr\u2032P\u03bb)\n(62) with\n\u03981(\u03bb) = 1 3!d\u03bb(D 2 \u2212 D)( 1 D+\u03bb D \u2212 1 \u2212 D \u22121 D\u2212\u03bb ) = O(D\u22121), \u03982(\u03bb) = 1 3!d\u03bb(D 2 \u2212 D)( 1 D+\u03bb D + 1 D\u2212\u03bb D ) = O(D\u22121), \u03983(\u03bb) = 1 3!d\u03bb(D 2 \u2212 D)1 \u2212 D \u22121 D\u2212\u03bb = O(D\u22122), \u03984(\u03bb) = \u2212 1 3!d\u03bb(D 2 \u2212 D) 1 D\u2212\u03bb D = O(D\u22123),\n(63)\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 23\nby the fact D+\u03bb = O(D2) (otherwise it is zero) and D \u2212 \u03bb = O(D4) [36]. For the ir-rep where D+\u03bb = tr(QP\u03bb) = 0, that is, QP\u03bb = 0, one has \u03981(\u03bb) = \u03982(\u03bb) = 0. Recall Eq. (53), one finally has the contribution of \u039b1n as\n(D + 1)2 tr [ \u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 \u03a6(4,Cl)n ( \u039b1n )]\n=(D + 1)2 tr { \u03c3 \u2297 O0 \u2297 \u03c3 \u2297 O0 [\u2211 \u03bb \u03981(\u03bb)QPrP\u03bb + \u03982(\u03bb)QPr\u2032P\u03bb + \u03983(\u03bb)PrP\u03bb + \u03984(\u03bb)Pr\u2032P\u03bb ]}\n\u2264(D + 1)2 [\u2211\n\u03bb\n\u03981(\u03bb) + \u03982(\u03bb) ] D\u22121 tr ( O20 ) + (D + 1)2 [\u2211 \u03bb \u03983(\u03bb) + |\u03984(\u03bb)| ] O(1) tr ( O20 ) =O(1) tr ( O20 ) . (64) Here in the last but one line, we apply Lemma 6 for the first two terms, and the last two terms can be bounded by following Eq. (48) in the Haar case. Combining Eq. (54) and (64), we finally prove Proposition 2 in main text."
        },
        {
            "heading": "F Numerical simulations and practical time-cost analysis",
            "text": ""
        },
        {
            "heading": "F.1 Details of numerical simulations",
            "text": "In this section, we clarify the technique and details of the numerical simulations for the scaling of statistical variance with shot-number K, setting-number M , weight w of Pauli observables, and qubit number n in Fig. 2 and 3.\nWe first generate the processed state \u03c1, which is either a GHZ state or a more general GHZ\u03b8 state in quantum simulators. Then we perform randomized Pauli or Clifford measurements on \u03c1 for M different random bases, each one repeating K shots, and record the measurement results and the corresponding bases. Using the numerical results, we can construct the classical shadow \u03c1\u0302 through Eq. (1) and Eq. (2), and calculate the value of o\u0302 = tr(O\u03c1\u0302). Here, the observables O are set as illustrated in the captions of Fig. 2 and 3. Finally, for each pair of (M, K) which generates a total estimator \u03c1\u0302 in Eq. (2), we repeat the whole randomized measurement procedure for T = 2000 times to obtain the estimation of the statistical variance, with Var [tr(O\u03c1\u0302)] \u223c 1T \u2211T t=1 [tr(O\u03c1\u0302t) \u2212 tr(O\u03c1)]\n2. The numerical simulation results of random Pauli and Clifford measurements in Fig. 2\nand 3 show consistency with the analytical results given by Eq. (13), (14), and (19).\nF.2 Practical time-cost and accuracy analysis for random Pauli measurements Here, we illustrate the advantage of the introduced multi-shot protocol, by investigating the variance and time cost enhancements against the original shadow protocol for fixed measurement budgets and accuracy requirements.\nGenerally, the total experimental time cost Ctot depends on both the time to change measurement settings CM and the time to perform single-shot measurements CK . We assume, similar as in Ref. [14], CM = 1000 and CK = 1, which indicates that changing the measurement settings requires more time than performing measurements in a fixed basis. Thus, the measurement budget is approximately Ctot = 1000M + MK. As indicated in Eq. (13), the variance to measure a Pauli operator P using random Pauli measurements depends on {M, K, w, tr(P\u03c1)}. Here, we directly set w = 2, tr(P\u03c1) = 0.2 and explore the scaling of the variance and total time cost with the shot-number K and setting-number M , as shown in Fig. 4.\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 24\nConsider a fixed measurement budget Ctot = 4.4 \u00d7 105, we find the optimal choice of (M, K) using our multi-shot protocol. It provides the lowest variance for estimating tr(P\u03c1), that is, Varms = 0.001, with the optimal choice approximately M = 380 and K = 160. Under the same budget, as shown in Fig. 4, the variance using the original shadow protocol Varos is much larger than using the multi-shot method Varms, i.e., Varos = 0.011 > Varms = 0.001. In the meantime, if one fixes the variance requirement as Var = 0.001, the total experimental time cost of the original shadow is C\u2032tot = 9.15 \u00d7 106 marked by the point of red triangle in Fig. 4, which is much larger than the one using our multi-shot technique. Therefore, the results of the example above show advantages of our multi-shot shadow protocol against the original shadow from both the measurement budgets and the accuracy aspects.\nAccepted in Quantum 2023-04-17, click title to verify. Published under CC-BY 4.0. 25"
        }
    ],
    "title": "Performance analysis of multi-shot shadow estimation",
    "year": 2023
}