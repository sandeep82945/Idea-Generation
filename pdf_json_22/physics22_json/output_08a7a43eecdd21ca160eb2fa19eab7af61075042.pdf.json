{
    "abstractText": "The control of articulated soft robots, i.e. robots with flexible joints and rigid links, presents a challenge due to their intrinsic elastic elements and nonlinear force-deflection dependency. This letter first proposes a discrete-time delayed unknown inputstate observer based on a nominal robot model that reconstructs the total torque disturbance vector, resulting from the imperfect knowledge of the elastic torque characteristic, external torques, and other model uncertainties. Then, it introduces a robust controller, that actively compensates for the estimated uncertainty and allows bounded stability for the tracking of independent link position and joint stiffness reference signals. The convergence of the disturbance estimator and the overall system\u2019s stability in closed loop is proven analytically, while the effectiveness of the proposed control design is first evaluated in simulations with respect to large uncertainty conditions, and then demonstrated through experiments on a real multi-degree-of-freedom articulated soft robot.",
    "authors": [
        {
            "affiliations": [],
            "name": "Salvatore Pedone"
        }
    ],
    "id": "SP:68be0388151cf8eca008bf798d971d07a9ef1672",
    "references": [
        {
            "authors": [
                "R. Van Ham",
                "B. Vanderborght",
                "M. Van Damme",
                "B. Verrelst",
                "D. Lefeber"
            ],
            "title": "MACCEPA, the mechanically adjustable compliance and controllable equilibrium position actuator: Design and implementation in a biped robot",
            "venue": "Robot. Auton. Syst., vol. 55, no. 10, pp. 761\u2013768, 2007.",
            "year": 2007
        },
        {
            "authors": [
                "F. Wu",
                "M. Howard"
            ],
            "title": "Energy regenerative damping in variable impedance actuators for long-term robotic deployment",
            "venue": "IEEE Trans. Robot., vol. 36, no. 6, pp. 1778\u20131790, Dec. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "R. Mengacci",
                "F. Angelini",
                "M.G. Catalano",
                "G. Grioli",
                "A. Bicchi",
                "M. Garabini"
            ],
            "title": "Stiffness bounds for resilient and stable physical interaction of articulated soft robots",
            "venue": "IEEE Robot. Automat. Lett., vol. 4, no. 4, pp. 4131\u20134138, Oct. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "S. Wolf"
            ],
            "title": "Variable stiffness actuators: Review on design and components",
            "venue": "IEEE/ASME Trans. Mechatronics, vol. 21, no. 5, pp. 2418\u20132430, Oct. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "G. Palli",
                "C. Melchiorri",
                "A. De Luca"
            ],
            "title": "On the feedback linearization of robots with variable joint stiffness",
            "venue": "Proc. IEEE Int. Conf. Robot. Automat., 2008, pp. 1753\u20131759.",
            "year": 2008
        },
        {
            "authors": [
                "R. Mengacci",
                "F. Angelini",
                "M.G. Catalano",
                "G. Grioli",
                "A. Bicchi",
                "M. Garabini"
            ],
            "title": "On the motion/stiffness decoupling property of articulated soft robots with application to model-free torque iterative learning control",
            "venue": "Int. J. Robot. Res., vol. 40, no. 1, pp. 348\u2013374, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M. Trumi\u0107",
                "K. Jovanovi\u0107",
                "A. Fagiolini"
            ],
            "title": "Decoupled nonlinear adaptive control of position and stiffness for pneumatic soft robots",
            "venue": "Int. J. Robot. Res., vol. 40, no. 1, pp. 277\u2013295, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "S.S.M. Salehian",
                "M. Khoramshahi",
                "A. Billard"
            ],
            "title": "A dynamical system approach for softly catching a flying object: Theory and experiment",
            "venue": "IEEE Trans. Robot., vol. 32, no. 2, pp. 462\u2013471, Apr. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "R. Mengacci",
                "M. Garabini",
                "G. Grioli",
                "M.G. Catalano",
                "A. Bicchi"
            ],
            "title": "Overcoming the torque/stiffness range tradeoff in antagonistic variable stiffness actuators",
            "venue": "IEEE/ASME Trans. Mechatronics, vol. 26, no. 6, pp. 3186\u20133197, Dec. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "A. Albu-Sch\u00e4ffer",
                "A. Bicchi"
            ],
            "title": "Actuators for soft robotics",
            "venue": "Handbook of Robotics. B. Siciliano and O. Khatib, Eds. Berlin, Germany: Springer, 2016, ch. 21, pp. 243\u2013282.",
            "year": 2016
        },
        {
            "authors": [
                "M. Ruderman",
                "T. Bertram",
                "M. Iwasaki"
            ],
            "title": "Modeling, observation, and control of hysteresis torsion in elastic robot joints",
            "venue": "Mechatronics, vol. 24, no. 5, pp. 407\u2013415, 2014.",
            "year": 2014
        },
        {
            "authors": [
                "I. Sardellitti",
                "G.A. Medrano-Cerda",
                "N. Tsagarakis",
                "A. Jafari",
                "D.G. Caldwell"
            ],
            "title": "Gain scheduling control for a class of variable stiffness actuators based on lever mechanisms",
            "venue": "IEEE Trans. Robot., vol. 29, no. 3, pp. 791\u2013798, Jun. 2013.",
            "year": 2013
        },
        {
            "authors": [
                "F. Petit",
                "A. Daasch",
                "A. Albu-Sch\u00e4ffer"
            ],
            "title": "Backstepping control of variable stiffness robots",
            "venue": "IEEE Trans. Control Syst. Technol., vol. 23, no. 6, pp. 2195\u20132202, Nov. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "M. Keppler",
                "D. Lakatos",
                "C. Ott",
                "A. Albu-Sch\u00e4ffer"
            ],
            "title": "Elastic structure preserving (ESP) control for compliantly actuated robots",
            "venue": "IEEE Trans. Robot., vol. 34, no. 2, pp. 317\u2013335, Apr. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "F. Angelini"
            ],
            "title": "Decentralized trajectory tracking control for soft robots interacting with the environment",
            "venue": "IEEE Trans. Robot., vol. 34, no. 4, pp. 924\u2013935, Aug. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "F. Petit",
                "A. Albu-Sch\u00e4ffer"
            ],
            "title": "State feedback damping control for a multi DOF variable stiffness robot arm",
            "venue": "Proc. IEEE Int. Conf. Robot. Automat., 2011, pp. 5561\u20135567.",
            "year": 2011
        },
        {
            "authors": [
                "S. Sundaram",
                "C.N. Hadjicostis"
            ],
            "title": "Delayed observers for linear systems with unknown inputs",
            "venue": "IEEE Trans. Autom. Control, vol. 52, no. 2, pp. 334\u2013339, Feb. 2007.",
            "year": 2007
        },
        {
            "authors": [
                "A.H. Al-Bayati",
                "Z. Skaf"
            ],
            "title": "A comparative study of linear observers applied to a DC servo motor",
            "venue": "Proc. IEEE Int. Conf. Modelling, Identification Control, 2010, pp. 785\u2013790.",
            "year": 2010
        },
        {
            "authors": [
                "T.H. Chong",
                "V. Chalvet",
                "D.J. Braun"
            ],
            "title": "Analytical conditions for the design of variable stiffness mechanisms",
            "venue": "Proc. IEEE Int. Conf. Robot. Automat., 2017, pp. 1241\u20131247.",
            "year": 2017
        },
        {
            "authors": [
                "M. Mattioni",
                "A. Moreschini",
                "S. Monaco",
                "D. Normand-Cyrot"
            ],
            "title": "On feedback passivation under sampling",
            "venue": "Proc. IEEE Amer. Control Conf., 2021, pp. 3578\u20133583.",
            "year": 2021
        },
        {
            "authors": [
                "K. Youcef-Toumi",
                "O. Ito"
            ],
            "title": "A time delay controller for systems with unknown dynamics",
            "venue": "Proc. Amer. Control Conf., 1988, pp. 904\u2013913.",
            "year": 1988
        },
        {
            "authors": [
                "J. Kim",
                "A.S. Lee",
                "K. Chang",
                "B. Schwarz",
                "S.A. Gadsden",
                "M. Al-Shabi"
            ],
            "title": "Dynamic modeling and motion control of a three-link robotic manipulator",
            "venue": "Proc. Int. Conf. Artif. Life Robot., 2017, vol. 22, pp. 380\u2013383.",
            "year": 2017
        },
        {
            "authors": [
                "S.E. Talole",
                "J.P. Kolhe",
                "S.B. Phadke"
            ],
            "title": "Extended-state-observer-based control of flexible-joint system with experimental validation",
            "venue": "IEEE Trans. Ind. Electron., vol. 57, no. 4, pp. 1411\u20131419, Apr. 2010.",
            "year": 2010
        },
        {
            "authors": [
                "A. Fagiolini",
                "M. Trumi\u0107",
                "K. Jovanovi\u0107"
            ],
            "title": "An input observer-based stiffness estimation approach for flexible robot joints",
            "venue": "IEEE Robot. Automat. Lett., vol. 5, no. 2, pp. 1843\u20131850, Apr. 2020. Open Access provided by \u2018Universit\u00e0 degli Studi di Palermo\u2019 within the CRUI CARE Agreement",
            "year": 1843
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014Robust/adaptive control, flexible robotics, compliance and impedance control.\nI. INTRODUCTION\nENDOWED with intrinsic flexibility, Articulated SoftRobots (ASR) can reach competitive skills, such as adaptation to unstructured environment [1], effective energy storage and release [2], and stable interaction with static environment [3], that are typical of biomechanical systems. To fully match the skills of vertebrates, a class of articulated soft robots with Variable Stiffness Actuation (VSA) technology has been developed, capable of modifying robot joint stiffness with time [4]. The potential capacity to regulate simultaneously, and in a decoupled manner, joint position and stiffness [5]\u2013[7],\nManuscript received 24 February 2022; accepted 16 June 2022. Date of publication 6 July 2022; date of current version 20 July 2022. This letter was recommended for publication by Associate Editor M. Saveriano and Editor J. Kober upon evaluation of the reviewers\u2019 comments. This work was supported in part by the MIUR under Grant POC R&I 2014-2020 (\u201cInnovative doctoral studies with industrial connection\u201d) and in part by the Science Fund of the Republic of Serbia, PROMIS under Grant #6062528, ForNextCobot. (Corresponding author: Adriano Fagiolini.)\nSalvatore Pedone and Adriano Fagiolini are with the Mobile & Intelligent Robots @ Panormous Laboratory (MIRPALab), Department of Engineering, University of Palermo, 90128 Palermo, Italy (e-mail: salvo.pedone89@ hotmail.it; fagiolini@unipa.it).\nMaja Trumic\u0301 is with the School of Electrical Engineering, University of Belgrade, 11000 Belgrade, Serbia, and also with the Mobile & Intelligent Robots @ Panormous Laboratory (MIRPALab), Department of Engineering, University of Palermo, 90128 Palermo, Italy (e-mail: maja.trumic@unipa.it).\nKosta Jovanovic\u0301 is with the School of Electrical Engineering, University of Belgrade, 11000 Belgrade, Serbia (e-mail: kostaj@etf.rs).\nThis letter has supplementary downloadable material available at https://doi.org/10.1109/LRA.2022.3188903, provided by the authors.\nDigital Object Identifier 10.1109/LRA.2022.3188903\nempowers them with even more dynamic manipulation capabilities, allowing them to perform tasks that involve for example throwing and catching [8] of objects, that were not attainable by rigid robots just a few decades ago.\nBeing biologically inspired and of a less complex mechanical design compared to other VSAs, agonistic-antagonistic VSAs are often applied technology in ASR systems [9]. However, the gained advantage of a simpler mechanical design is tradedoff with the need for a more elaborated controller that can allow decoupled position and stiffness regulation. Moreover, the agonistic-antagonistic actuators introduce nonlinearities into the model since a nonlinear force-deformation dependency is needed to achieve a time-varying stiffness [10], while the existence of elastic tendons introduces hysteresis and additional nonlinearities since tendons change their characteristic over time due to wear-off and working temperature, or even break [11].\nTo tackle the challenge of controlling an ASR, the first line of research consists of model-based approaches, which leverage on precise knowledge of either the full robot dynamics or the actuator\u2019s model. Relevant examples of the first setting are the ones obtained by feedback linearization [5], gain-scheduling control [12], and backstepping control [13], while adaptive control [7] and control based on damping injection [14] have been used in the latter one. A second, also very promising, line of research is model-free and involves techniques that aim at iteratively learning the position or torque control of an ASR, by using the minimum knowledge about the system while preserving its compliance through a feedforward control component [6], [15], yet without guaranteeing stability. Moreover, compared to the state feedback control in [16] this letter avoids using torque sensors.\nThe present work capitalizes on the advantages of modelbased formal approaches to provide stability guarantees, and, in that regard, it proposes a novel disturbance-based robust control solution for articulated soft robots with antagonistic VSA, that ensures the performance even under lack of system knowledge or presence of the external disturbance. More precisely, our approach assumes arbitrary values of the parameters that construct the robot\u2019s inertia matrix, chosen under the constraint that the inertia matrix is non-singular. The proposed solution builds upon the theory of delayed Unknown Input Observers (UIO), which allows estimating and compensating the model\u2019s uncertainties after only a few samples [17], compared to the dozen iterations needed for learning-based approaches. Compared to other existing solutions such as Extended State Observers (ESO), UIOs do not lean on assumptions on the disturbance dynamics and its boundedness, require no parameter tuning, have exact convergence guarantees, and outperform them [18] despite their simplicity. Moreover, the controllers\u2019 robustness to the robot and actuator model uncertainties facilitates its application and avoids the necessity for extensive a-priori model identification.\nThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/\nThe contributions of the letter are: 1) the formalization of a model for VSA-driven articulated soft robots with factorized actuator dynamics, allowing a convenient decomposition into arbitrarily simple yet invertible nominal and uncertain dynamics; 2) a formulation of a delayed UIO for VSA-driven robots that simultaneously estimates the input disturbance and system states, and, consequently, avoids the necessity to collect velocity and acceleration measures at the only cost of a few sample delay; 3) the design of a robust composite disturbance-observer-based controller, which uses the information on state and input estimates to provide perfect asymptotic tracking of position and stiffness desired trajectories; 4) simulation and experimental validations on a multi-degree-of-freedom VSA-driven articulated soft robot that prove the effectiveness of the proposed control design in successfully tracking the desired position and stiffness references despite the existing nonlinearities and uncertainties."
        },
        {
            "heading": "II. BACKGROUND AND PROBLEM STATEMENT",
            "text": "The structure of an articulated soft robot with n links and n flexible joints, driven by electromechanical VSA devices, is illustrated in Fig. 1. The actuation of the i-th robot joint is obtained as the result of mechanical deflections of elastic elements within each VSA, which are generated by internal pairs of electric motors. Such pairs are arranged in so-called agonisticantagonistic configuration so as to enable simultaneous setting of the link position and joint stiffness. Indicating with qi the i-th link position and with \u03b8i,a and \u03b8i,b the internal motor positions of the i-th VSA device, the i-th pair of deflections are\n\u03c6i,a = qi \u2212 \u03b8i,a , \u03c6i,b = qi \u2212 \u03b8i,b , (1) and produce an agonistic elastic torque \u03c4ei,a(\u03c6i,a) and an antagonistic elastic torque \u03c4ei,b(\u03c6i,b), that are simultaneously applied at the i-th link. The total elastic torque applied at the i-th link is then\n\u03c4ei = \u03c4 e i,a(\u03c6i,a) + \u03c4 e i,b(\u03c6i,b) . (2)\nDefining the robot configuration vector q = (q1, . . . , qn)T , the motor position vectors and elastic torque vectors, \u03b8j = (\u03b81,j , . . . , \u03b8n,j) T and \u03c4ej = (\u03c4 e 1,j , . . . , \u03c4 e n,j)\nT , for j = a, b, respectively, and the total elastic torque vector \u03c4e = \u03c4ea + \u03c4 e b , the\nrobot\u2019s dynamic model, including the link position dynamics and those of the motors within the VSA devices, is given by [10]:\nM(q) q\u0308 + h(q, q\u0307) + \u03c4e(\u03c6a, \u03c6b) = \u03c4ext ,\nJa \u03b8\u0308a +\u0394a \u03b8\u0307a \u2212 \u03c4ea(\u03c6a) = \u03c4a , Jb \u03b8\u0308b +\u0394b \u03b8\u0307b \u2212 \u03c4eb (\u03c6b) = \u03c4b .\n(3)\nwhere M \u2208 Rn\u00d7n is the robot\u2019s inertia matrix, h(q, q\u0307) \u2208 Rn is a vector field collecting the centrifugal, Coriolis, and gravity terms, \u03c4ext \u2208 Rn is an externally applied torque vector, Ja and Jb are the motors\u2019 inertia, \u0394a and \u0394b are damping coefficients, and \u03c4a and \u03c4b are the electrically-induced motor torques. Accordingly, the i-th joint stiffness is given by definition\n\u03c3i = \u2202 \u2202\u03c6i,a \u03c4ei,a(\u03c6i,a) + \u2202 \u2202\u03c6i,b \u03c4ei,b(\u03c6i,b) , (4)\nand the joint stiffness matrix is \u03c3 = diag(\u03c31, . . . , \u03c3n). Within this setting, the present letter addresses the following problem:\nProblem 1: Given an ASR with dynamics as in (3) and joint stiffness as in (4), design a robust observer-based controller ensuring simultaneous and asymptotic tracking of desired link position and joint stiffness signals, qd(t) and \u03c3d(t).\nBefore moving on to the letter contributions, the following definitions and properties are recalled. First, a square matrix A is Schur if all its eigenvalues are within the unit circle, i.e. |\u03bbi(A)| < 1 for all i. The notation 0 \u00d7h represents a null matrix belonging to R \u00d7h, while 0 is used as a short-hand when h = . Also, I indicates the identity matrix of order . Moreover, given a linear discrete-time model of the form\nXk+1 = AXk +B Uk , Yk = C Xk +DUk , (5) where k is a discrete time step, Xk \u2208 Rn is a state vector, Uk \u2208 Rm an unknown input vector, and Yk \u2208 Rr an output vector, the state matrix is A \u2208 Rn\u00d7n, input matrix is B \u2208 Rn\u00d7m, output matrix is C \u2208 Rr\u00d7n and feed-through matrix is D \u2208 Rr\u00d7m the L-step invertibility and observability matrices are obtained by the recursive definitions\nHL =\n( D 0r\u00d7m\nOL\u22121B HL\u22121\n) and OL = ( C OL\u22121 A ) ,\nforL \u2265 1 and H0 = D andO0 = C. Given the sequences of the matrices, HL and OL, for L = 0, 1, . . . , n, a dynamic model as in (5) is said to be strongly observable if, and only if, for some L, it holds rank([OL,HL])\u2212 rank(HL) = n , (6) and it is said to be invertible if, and only if, for some L, it holds\nrank(HL)\u2212 rank(HL\u22121) = m. (7)"
        },
        {
            "heading": "III. COMPOUND CONFIGURATION DYNAMICS OF ASR - FACTORIZATION AND DECOMPOSITION",
            "text": "The purpose of this section is twofold: first, to describe a convenient and general way to factorize the actuation-related terms, in the position and stiffness dynamics of an articulated soft robot, with respect to a generic basis of functions; then, to introduce a general decomposition of the obtained model as an arbitrarily simple yet invertible nominal dynamics, affected by uncertain input signals."
        },
        {
            "heading": "A. Actuation Model Factorization",
            "text": "Virtually all VSA devices are provided with an integrated and fast control loop allowing a practically instantaneous regulation of the actuation motors. Based on this, the agonistic and antagonistic motor positions, indicated in our model by the vectors \u03b8a and \u03b8b, can be viewed as input variables for the robot dynamics.\nAs a result, the robot model in (3) can be restricted to the link equation only:\nM(q) q\u0308 + h(q, q\u0307) + \u03c4e(\u03c6a, \u03c6b) = \u03c4ext , (8)\nwhere \u03c6j = (\u03c61,j , . . . , \u03c6n,j)T , for j = a, b, with each \u03c6i,j = qi \u2212 \u03b8i,j is the j-th deflection at the i-th joint.\nAssuming that all VSA devices in the robot are homogeneous, i.e. they are made of similar copies of the same agonistic/antagonistic actuation mechanism, the entries of the elastic torque vectors \u03c4ea and \u03c4 e b can be expressed as combinations of suitable basis functions, {y1, . . . , yp}, of the (i, j)-th pair of deflection variables \u03c6i,j (cf. e.g. the basis choice in [19]), i.e.\n\u03c4ei,a = p\u2211 k=1 \u03b1i,k yk(\u03c6i,a) , \u03c4 e i,b = p\u2211 k=1 \u03b2i,k yk(\u03c6i,b),\nfor i = 1, . . . , n, with \u03b1i,k and \u03b2i,k being the coefficients of the combinations. Note that since the functions yk belong to a basis, they can be assumed to be linearly independent. From (2) and considering the separability of the elastic torque factors, the total elastic torque vector \u03c4e can be factorized as in the following:\n\u03c4e = \u239b \u239c\u239d \u03c4e1,a(\u03c61,a) + \u03c4 e 1,b(\u03c61,b)\n... \u03c4en,a(\u03c6n,a) + \u03c4 e n,b(\u03c6n,b)\n\u239e \u239f\u23a0 = \u03a0\u0393(\u03c61, \u03c62) ,\nwith \u03a0 = diag(\u03a01, . . . ,\u03a0n) \u2208 Rn\u00d72np , \u0393 = (\u03b31(\u03c61,a, \u03c61,b) T , . . . , \u03b3n(\u03c6n,a, \u03c6n,b) T )T \u2208 R2np,\nand each \u03a0i = (\u03b1i,1, . . . , \u03b1i,p, \u03b2i,1, . . . , \u03b2i,p) \u2208 R1\u00d72p , \u03b3i = (y1(\u03c6i,a), . . . , yp(\u03c6i,a), y1(\u03c6i,b), . . . , yp(\u03c6i,b))\nT \u2208 R2p. Moreover, to attain a similar decomposition for the dynamic behavior of the joint stiffness matrix \u03c3 and, in parallel, avoid using link and motor speed data, it is algebraically convenient to adopt the time-integral Si of the total i-th joint stiffness \u03c3i, i.e. Si = \u222b t 0 \u03c3i(\u03c4)d\u03c4 , as a state variable. Then, its time derivative is S\u0307i = \u03c3i, which, by virtue of (4), is the sum of two addends depending on the i-th agonistic and antagonistic deflections, respectively. Hence, such a derivative can be expressed via the same basis functions used above, i.e.\nS\u0307i = \u03c3i = p\u2211 k=1 (\u03bci,k yk(\u03c6i,a) + \u03bdi,k yk(\u03c6i,b)),\nwhere \u03bci,k and \u03bdi,k are suitable coefficients. Accordingly, one can write S\u0307 = \u03a3\u0393(\u03c61, \u03c62), with \u03a3 = diag(\u03a31, . . . ,\u03a3n) \u2208 Rn\u00d72np and each \u03a3i = (\u03bci,1, . . . , \u03bci,p, \u03bdi,1, . . . , \u03bdi,p) \u2208 R1\u00d72p .\nFinally, putting all together, the dynamics of the compound configuration vector (qT , ST )T can be written in the following form with actuation factorization:\nM(q) q\u0308 + h(q, q\u0307) = \u03c4ext \u2212\u03a0\u0393(\u03c6a, \u03c6b) , S\u0307 = \u03a3\u0393(\u03c6a, \u03c6b) ,\n(9)\nwhere the basis functions used to decompose the total elastic torque and its partial derivative operate as input functions."
        },
        {
            "heading": "B. Nominal and Uncertain Model Decomposition",
            "text": "The dynamics in (9) includes functions that may be uncertain or even unknown, i.e. the inertia matrix M(q), the functions appearing in h(q, q\u0307), the coefficients of \u03a0 and \u03a3 in the actuation-related terms, and the external torque \u03c4ext are only partially known. Under this hypothesis, we seek for a convenient\ndecomposition of (9) separating a minimal yet exactly known dynamics from the remainder uncertain one.\nTo this purpose, it can be assumed, without loss of generality, that M(q)\u22121 can be expanded as the sum of an invertible known matrix M\u0304(q)\u22121 and a remainder uncertain one \u0394M(q)\u22121. In addition, as the basis functions used to factorize the actuationrelated terms can be freely chosen, they are available and, thus, the only uncertainty affects the values of the involved coefficients\u03a0 and\u03a3. Finally, no assumptions on the separability of known and unknown terms in h(q, q\u0307) are made. In summary, it holds:\nM(q)\u22121 = M\u0304(q)\u22121 +\u0394M(q)\u22121 ,\n\u03a0 = \u03a0\u0304 +\u0394\u03a0 , \u03a3 = \u03a3\u0304 +\u0394\u03a3, (10)\nwith \u03a0\u0304 and \u03a3\u0304 being nominal known values and \u0394\u03a0 and \u0394\u03a3 the uncertain ones. Having stated the previous assumptions, one can left-multiply the first equation of (9) byM(q)\u22121 and, using (10), obtain\nq\u0308 = M(q)\u22121 (\u03c4ext \u2212 h (q, q\u0307))\u2212M(q)\u22121 \u03a0\u0393(\u03c6a, \u03c6b) = ( M\u0304(q)\u22121 +\u0394M(q)\u22121 ) (\u03c4ext \u2212 h(q, q\u0307)) +\n\u2212 (M\u0304(q)\u22121 +\u0394M(q)\u22121)\u0394\u03a0 \u0393(\u03c6a, \u03c6b) + \u2212\u0394M\u22121(q) \u03a0\u0304 \u0393(\u03c6a, \u03c6b)\u2212 M\u0304\u22121(q) \u03a0\u0304 \u0393(\u03c6a, \u03c6b) ,\nS\u0307 = \u03a3\u0304 \u0393(\u03c6a, \u03c6b) + \u0394\u03a3 \u0393(\u03c6a, \u03c6b).\nAs a next step, one can separate the terms that are fully known from the remaining ones that can be lumped together into a vector signal w = (wTq , w T S )\nT , which will be considered as unknown disturbance. Specifically, defining\nwq = M(q) \u22121 (\u03c4ext \u2212 h(q, q\u0307)) +\n\u2212 (M(q)\u22121\u0394\u03a0+\u0394M(q)\u22121 \u03a0\u0304)\u0393(\u03c6a, \u03c6b) , wS = \u0394\u03a3 \u0393(\u03c6a, \u03c6b),\nwhere matrix M(q)\u22121 has been recombined where possible for compactness, leads to the sought nominal model with explicit unknown input disturbance:\nq\u0308 = \u2212M\u0304(q)\u22121 \u03a0\u0304 \u0393(\u03c6a, \u03c6b) + wq , S\u0307 = \u03a3\u0304 \u0393(\u03c6a, \u03c6b) + wS .\n(11)\nRemark 1: As shown later, the inertia inverse M\u0304(q)\u22121 can be chosen quite arbitrarily, provided that it is invertible, thereby avoiding information loss on the right hand-side of (8). Accordingly, to make the synthesis of a linear input-state observer feasible, as done in the next section, M\u0304(q)\u22121 is further assumed to be constant, i.e. M\u0304(q)\u22121 = M\u0304\u22121. The remainder part of the inertia inverse is then \u0394M(q)\u22121 = M(q)\u22121 \u2212 M\u0304\u22121.\nIV. INPUT-STATE OBSERVER DESIGN FOR ASR\nThe second step of our strategy is to dynamically reconstruct the unknown signalw (or better its discrete-time version), acting in (11), so as to enable its subsequent compensation by a suitable robust controller later derived. Leveraging on the model reformulation described in the previous section, w can be estimated by a linear unknown input-state observer using a nominal state form of such model.\nTo this aim, given a sampling period T and a discrete time k, let the compound configuration vector be the system output, i.e. Y = (qT , ST )T \u2208 R2n, the output of the robust controller be the system (manipulable) input, i.e. U = \u0393(\u03c6a, \u03c6b) \u2208 R2np, and w = (wTq , wTS )T \u2208 R2n be an unknown\ndisturbance (note that no link speed data is used); defining the state vector X = (qT , q\u0307T , ST )T , (11) is written as X\u0307 =\nAcX +BcU +Wcw, with Ac = (\n0n In 0n 02n\u00d7n 02n\u00d7n 02n\u00d7n\n) , Bc =\n(0np\u00d7n,\u2212(M\u0304\u22121 \u03a0\u0304)T , \u03a3\u0304T )T , Wc = (0Tn\u00d72n, I2n)T . Assuming U and w be constant between two consecutive discrete times and using the approach in [20] and the fact that Ac is nilpotent of order 2, i.e. Akc = 0 for k \u2265 2, it is straightforward to obtain the linear discrete-time state form\nXk+1 = AXk +B Uk +W wk , Yk = C Xk , (12) where Xk = X(kT ), Yk = Y (kT ), Uk = U(kT ), and wk = w(kT ) and where\nA=eAcT=I3n+TAc= \u239b \u239dIn T In 0n0n In 0n 0n 0n In \u239e \u23a0, C=(In 0n 0n 0n 0n In )\nB = J Bc =\n\u239b \u239d 0n\u00d7np\u2212TM\u0304\u22121 \u03a0\u0304\nT \u03a3\u0304\n\u239e \u23a0 ,W = J Wc = ( 0n\u00d72n T I2n ) ,\n(13)\nbeing J = A\u22121c (e AcT \u2212 I3n) = T .\nNow, indicating with X\u0302k = (q\u0302(kT )T , \u02d9\u0302q(kT )T , S\u0302(kT )T )T an estimate of Xk, with w\u0302k an estimate of wk, with Yk = (Y Tk\u22122, Y T k\u22121, Y T k )\nT the output history vector of the latest 3 values of Yk, and with {\u03bb1, . . . , \u03bb3n} a set of constants that can be freely chosen within the unit circle of the complex plane, the linearity of (12) allows designing the following delayed estimator:\nTheorem 1 (DUIO Design for ASR): Given the reformulated model of an articulated soft robot described in (12), with matrices A, B, and C as in (13), a 2-sample delayed state estimate X\u0302k\u22122 can be computed via the iterative rule\nX\u0302k\u22122+1 = E X\u0302k\u22122 +B Uk\u22122 + F (Yk + Nk) , (14) in which E = diag(\u03bb1, . . . , \u03bb3n) ,\nF = \u239b \u239d F1 \u2212 In 1T In 0n 0n 0n 0n\u2212F1 \u2212 1T In In 1T F3 0n 1T In 0n\n1 T In F2 + In 0n In 0n 0n \u239e \u23a0 (15)\nwith F1 = diag(\u03bb1, . . . , \u03bbn), F2 = diag(\u03bbn+1, . . . , \u03bb2n), F3 = diag(\u03bb2n+1, . . . , \u03bb3n), and in which\nNk = (02n, (N1Uk\u22122)T , (N2Uk\u22122 +N1Uk\u22121)T )T , (16) with N1 = ( 0n\u00d7np \u2212T \u03a3\u0304 ) and N2 = ( T 2M\u0304\u22121 \u03a0\u0304 \u2212T \u03a3\u0304 ) . Moreover, given G = (02n\u00d7n, 1T I2n, 02n), a 2-sample delayed input estimate w\u0302k\u22122 can be computed via the formula\nw\u0302k\u22122 = G\n( X\u0302k\u22121 \u2212AX\u0302k\u22122 \u2212B Uk\u22122\nYk \u2212 CX\u0302k\u22122\n) . (17)\nProof: The DUIO derivation can be achieved within the framework of delayed input-state observers (cf. e.g. [17]), which can be done through the following three steps.\n1) Existence: The existence of the observer with a suitable delay L is ensured if, and only if, the compound state dynamics in (12) is strongly observable with respect to all initial conditions and invertible with respect to the unknown input wk when the system output is Yk [17]. Referring to the conditions in (6)\nand (7), the system dynamics has a null direct matrix, D = 02n, multiplying wk, and hence the first three invertibility matrices in the sequence are\nH0 = 02n,H1 = \u239b \u239d 02n 02n0n 0n\n0n T In 02n\n\u239e \u23a0 ,\nH2= \u239b \u239c\u239d 02n 02n 02n CW 02n 02n\nCAW CW 02n\n\u239e \u239f\u23a0= \u239b \u239c\u239c\u239c\u239c\u239d 02n 02n 02n 0n 0n 0n T In 02n 02n\nT 2In 0n 0n T In 0n 0n 0n T In 02n\n\u239e \u239f\u239f\u239f\u239f\u23a0 .\nGiven that the dimension of the unknown input wk is m = 2n and that rank(H0) = 0, rank(H1) = n and rank(H2) = 3n, the conditions in (6) and (7) are first satisfied with L = 2, which is the (minimum) delay of the observer.\n2a) State Estimation \u2013 Convergence Conditions: Knowing that the required delay is L = 2, one can define the output history vector Yk = (Y Tk\u22122, Y T k\u22121, Y T k )\nT \u2014 comprising the latest L+ 1 = 3 output samples and being the one in the theorem statement \u2014 and assume a state estimate update rule as in (14), where E and F are matrices to be suitably chosen and where Nk is still a free vector. As the observer is meant to provide, at any step k, an estimate of the past compound state Xk\u22122, the current state estimation error can be defined as ek = X\u0302k\u22122 \u2212 Xk\u22122. Shifting backward in time of 2 steps the robot dynamics in (12) yields Xk\u22122+1 = AXk\u22122 +B Uk\u22122 +W wk\u22122 , which allows, along with the assumed observer\u2019s update rule, deriving the following state estimation error dynamics:\nek+1 = X\u0302k\u22122+1 \u2212Xk\u22122+1 = = E X\u0302k\u22122 \u2212AXk\u22122 + F Y \u2032k \u2212W wk\u22122 = = E ek + (E \u2212A)Xk\u22122 + F Y \u2032k \u2212W wk\u22122 , (18)\nwhere the addend EXk\u22122 has been added and subtracted in the last line of (18), and where Y \u2032k = Yk + Nk.\nNow, the observer\u2019s convergence must be guaranteed for all delayed states Xk\u22122 and all behaviors of the delayed unknown inputwk\u22122, and hence (18) should be made independent of them. A possible dynamics that has the desired convergence property and that is algebraically compliant with (18) is ek+1 = E ek with E a Schur matrix. By comparing the two expressions one gets the condition\n(E \u2212A)Xk\u22122 + F Y \u2032k \u2212W wk\u22122 = 0 . (19) To remove the explicit dependency of this expression on the output history vector Yk, its entries can be expanded in terms of the delayed state Xk\u22122 and the latest unknown input samples wk\u22122, wk\u22121, and wk. This leads to the three formulas:\nYk\u22122 = C Xk\u22122 ,\nYk\u22121 = CAXk\u22122 + CB Uk\u22122 + CW wk\u22122 ,\nYk = CA 2 Xk\u22122 + CAB Uk\u22122 + CB Uk\u22121\n+ CAW wk\u22122 + CW wk\u22121 ,\nfrom which, after conveniently choosing matrix Nk as\nNk = \u2212 \u239b \u239d 02n 02n 02nCB 02n 02n CAB CB 02n \u239e \u23a0 \u239b \u239dUk\u22122Uk\u22121 Uk \u239e \u23a0 ,\nwhose direct computation leads to its expression in (16), with N1 = \u2212CB and N2 = \u2212CAB, one can write\u239b \u239dY \u2032k\u22122Y \u2032k\u22121\nY \u2032k\n\u239e \u23a0= \u239b \u239d CCA CA2 \u239e \u23a0Xk\u22122+ \u239b \u239d 02n 02n 02nCW 02n 02n CAW CW 02n \u239e \u23a0 \u239b \u239dwk\u22122wk\u22121 wk \u239e \u23a0\nor, in matrix form, Y \u2032k = O2 Xk\u22122 + H2 Wk, where O2 is the 2-step observability matrix and Wk = (wTk\u22122, w T k\u22121, w T k )\nT . Consequently, (19) becomes (E \u2212A+ FO2)Xk\u22122 + (F H2 \u2212 (W, 02n, 02n))Wk = 0 .\nNow, in order to satisfy this expression for every Xk\u22122 and Wk, it must be that\nE = A\u2212 FO2 and F H2 = (W, 02n, 02n) . (20) 2b) State Estimation \u2013 Derivation of the Matrices: The second condition in (20) requires that F is in the left-nullspace of the last m columns of H2, that are P = (04n,HT1 )\nT . Given a matrix N\u0304 whose rows are a basis of the left-nullspace of H1, the rows of matrix diag(I2n, N\u0304) are a basis of the left-nullspace of P . Seeing the structure of H1, it suffices to choose N\u0304 = (I3n, 03n\u00d7n). Moreover, given an invertible matrix W \u2217, we can define N = W \u2217diag(I2n, N\u0304), whose rows also form a basis of the left nullspace of P . Therefore, to find W , first note\nthat N (\n02n 02n\u00d74n O1W H1\n) = W \u2217 ( 02n 02n\nN\u0304 O1 W 02n\n) = W \u2217 V , where\nO1 = (CT , (CA)T )T . As the required delay is L = 2, the first 2n columns of H2 are linearly independent and hence rank(V ) = 2n. Matrix W \u2217 can be chosen so that its last 2n rows are a left-inverse of V , while the top ones are a basis of its left-nullspace. The choice\nW \u2217 =\n\u239b \u239d I3n 03n\u00d72n\n02n\u00d73n 0n 1 T In\nIn/T 2\n0n\n\u239e \u23a0 ,\nleads to a matrix N satisfying the expression N H2 =( 02n 02n I2n 02n ) and then N = W \u2217. Based again on the structure of (20) and the columns of W , F can be factorized as F = F \u2217N , with F \u2217 = (F \u22171 , F \u2217 2 ), so that (20) itself\ncan be written as (F \u22171 , F \u2217 2 ) ( 02n 02n I2n 02n ) = (W, 03n\u00d72n), from which it follows F \u22172 = W , while F \u2217 1 is still free. Plugging F into the first condition in (20) yields E = A\u2212 (F \u22171 ,W )NO2 = A\u2212 (F \u22171 ,W )(RT , QT )T , with\nR = \u239b \u239dIn 0n 0n0n 0n In\nIn T In 0n\n\u239e \u23a0 , Q = ( 1T 2 In 2T In 0n\n0n 0n 1 T In\n) ,\nand then E = A\u2212WQ\u2212 F \u22171R =\n= \u239b \u239d 0n In 0n\u2212 1T 2 In \u2212 2T In 0n\n0n 0n \u2212 1T In\n\u239e \u23a0\u2212 F \u22171 \u239b \u239dIn 0n 0n0n 0n In\nIn T In 0n\n\u239e \u23a0 .\nTo finally ensure that E is Schur and diagonal as in (15), it suffices to choose F \u22171 = (A\u2212WQ\u2212 diag(\u03bb1, . . . , \u03bb3n))R, which also leads to F \u2019s expression in (15).\n3) Unknown Input Reconstruction: Finally, an estimate, that is optimal in the least square sense, of the delayed unknown input wk\u22122 can be retrieved from the conditions: X\u0302k\u22122+1\u2212Xk\u22122+1=X\u0302k\u22122+1 \u2212AXk\u22122 \u2212B Uk\u22122 \u2212Wwk\u22122 , Y\u0302k\u22122 \u2212 Yk\u22122=CX\u0302k\u22122 \u2212 Yk\u22122 .\nOnce the delayed state estimate X\u0302k\u22122 has converged to Xk\u22122, the right hand-sides of these equations converge to zero; then the remaining expressions can be rearranges as follows:(\nW\n02n\n) wk\u22122 = ( X\u0302k\u22122+1 \u2212AXk\u22122 \u2212B Uk\u22122\nYk\u22122 \u2212 CX\u0302k\u22122\n) .\nLeft-multiplying both sides of this equation by a matrix G = (WTW )\u22121(WT , 02n), whose computation leads to the formula in theorem\u2019s statement, allows obtaining the sought (17), which concludes the proof."
        },
        {
            "heading": "V. ROBUST CONTROL AND CLOSED-LOOP STABILITY",
            "text": "Given desired trajectories, qd(t) and \u03c3d(t), for the compound configuration, define the desired state signal samples Xd,k = (qd(kT )T , q\u0307d(kT )T , Sd(kT )T )T , with Sd(t) =\u222b t 0 \u03c3d(\u03c4)d\u03c4 . Then, using the information retrieved by the DUIO, the following can be found: Theorem 2: Given an articulated soft robot as in (8), the feedback-feedforward control law Uk = K(X\u0302k\u22122 \u2212Xd,k) + P (Xd,k+1 \u2212AXd,k \u2212W w\u0302k\u22122) , (21) where X\u0302k\u22122 and w\u0302k\u22122 are found using (14) and (17), P = (BTB)\u22121BT , and K is such that A+BK is Schur, ensures global and robust bounded stability for the tracking error of desired position and stiffness trajectories, qd(t) and \u03c3d(t).\nProof: The dynamics of the discrete-time tracking error, Zk = Xk \u2212Xd,k, reads\nZk+1 = AXk +BUk +Wwk \u2212Xd,k+1 = = AZk +BUk \u2212Xd,k+1 +AXd,k +Wwk . (22)\nA desired convergent dynamics for the state vector is Zk+1 = A\u2217 Zk, with A\u2217 = A+BK, where K \u2208 R2np\u00d73n is a free gain matrix that can be chosen to make matrix A\u2217 Schur. Comparing such desired expression with (22) yields the conditionBUk = BKZk +Xd,k+1 \u2212AXd,k \u2212Wwk. In practice, as only the estimates of Xk and wk are available with 2- sample delays, the following best-effort condition can be ensured: BUk = BKZ\u0302k +Xd,k+1 \u2212AXd,k \u2212Ww\u0302k\u22122 , (23) with Z\u0302k = X\u0302k\u22122 \u2212Xd,k. The overall closed-loop dynamics, including the tracking error dynamics in (22) and the estimation error ek from Theorem 1 reads(\nZk+1 ek+1\n) = ( A\u2217 03n 03n E )( Zk ek ) + ( \u03d5k 03n ) , (24)\nwith \u03d5k = BK(Z\u0302k \u2212 Zk) +Ww\u0303k and w\u0303k = wk \u2212 w\u0302k\u22122. It can be seen, as expected by its design, that the dynamics of the estimation error ek is independent of Uk and wk, and hence its closed-loop convergence is ensured by E being Schur. That being so, after a transient in the observer estimates, X\u0302k\u22122 Xk\u22122 and w\u0302k\u22122 wk\u22122. Moreover, considering the small delayL = 2 [21] and assuming a small enough sampling period T , it also holds X\u0302k\u22122 Xk, Uk\u22122 Uk, wk\u22122 wk, Yk\u22122 Yk. As a result, Z\u0302k Zk and w\u0303k wk \u2212 w\u0302k 0 and the forcing term \u03d5k in the closed-loop dynamics vanishes, i.e. \u03d5k tends to zero. More precisely, it can be shown that Z\u0302k\u22121 \u2212 Zk\u22121 = A(Z\u0302k\u22122 \u2212 Zk\u22122) +W (w\u0302k\u22122 \u2212 wk\u22122) 0, which in turn implies Z\u0302k \u2212 Zk = A(Z\u0302k\u22121 \u2212 Zk\u22121) +W (w\u0302k\u22121 \u2212 wk\u22121) W (w\u0302k\u22121 \u2212 wk\u22121). As (A,B) is controllable, a matrix K making A\u2217 Schur always exists, thus ensuring ||A\u2217Zk|| < ||Zk||. Also, for small T [21], w\u0302k\u22121 w\u0302k\u22122 wk\u22122. Then, from (24),\nZk evolves with a stable dynamics subject to a forcing signal \u03d5 such that ||\u03d5|| = ||BKW (wk\u22122 \u2212 wk\u22121) +W (wk \u2212 wk\u22122)|| \u2264 T (||B|| ||K||+ 2)\u03b3, where \u03b3 is the absolute maximum variation of wk between any two consecutive samples. A possible estimate for this quantity is \u03b3 = max(q\u0308max, S\u0307max) = max(q\u0308max, \u03c3max), where q\u0308max and \u03c3max are the maximum reachable acceleration and stiffness.Zk converges to the equilibrium Zk = (I3n \u2212A\u2217)\u22121\u03d5, whose norm is ||Zk|| \u2264 T ||(I3n \u2212 A\u2217)\u22121||(||B|| ||K||+ 2)\u03b3 and hence is upper bounded by a quantity proportional to T . Finally, left-multiplying both members of (23) by the pseudoinverse of B, the control law in (21) is obtained."
        },
        {
            "heading": "VI. METHOD APPLICATION AND EVALUATION",
            "text": "This section shows the performance of the proposed solution when applied to the 3-degree-of-freedom ASR in Fig. 1. In the considered hardware setup, each joint of the robot is driven by a qbmove advanced actuator [22] that allows simultaneous settings of link position and joint stiffness. The section is organized in three parts: 1) instances of the proposed estimator and robust controller are derived based on a coarse but very convenient simplification of the robot\u2019s compound dynamics; 2) their effectiveness and robustness are shown in simulation with large model uncertainty due to the few amount of information used for their derivation; 3) experimental test results with the adopted real hardware setup are reported."
        },
        {
            "heading": "A. Derivation of Estimator and Controller Components",
            "text": "To test the robustness of the method and to show also the few amount of information used to derive the corresponding estimator and controller, first of all, all links\u2019 interactions are completely neglected, thereby leading to a nominal inertia matrix inverse that is diagonal and given by M\u0304(q)\u22121 = diag(1/I1, 1/I2, 1/I3) (cf. e.g. [23]), where Ii are the solely link inertia constants whose values are reported in Table I. Secondly, from [22], the i-th VSA device can apply the total elastic torque and set the joint stiffness given by the following VSA-specific formulas\n\u03c4ei = ki,a sinh(ui,a) + ki,b sinh(ui,b) , \u03c3i = ai,aki,a cosh(ui,a) + ai,bki,b cosh(ui,b) ,\n(25)\nwhere ui,a = ai,a\u03c6i,a, ui,b = ai,b\u03c6i,b, and where ki,a, ki,b, ai,a, and ai,b are suitable constants whose nominal values ka, kb, aa, and ab, experimentally identified by the manufacturer, are reported again in Table I. Given the convex behavior of such functions, one can expand them as\n\u03c4ei = \u03c0i(t)(ui,a + ui,b) , \u03c3i = \u03bci(t)(ui,a + ui,b) , (26)\nwhere \u03c0i(t) and \u03bci(t) are time-varying yet bounded slope signals. While for our approach any positive constant value can be used in place of these signals, it is reasonable to conservatively tune them bargaining the maximum elastic torque \u03c4emax and stiffness \u03c3max demands. To do so, using the prosthaphaeresis formulas for hyperbolic functions, with\nai,a = ai,b = a and ki,a = ki,b = k, one can rewrite (25) as \u03c4ei = 2k \u03ba\u03c9 and \u03c3i = 2ak \u03b5\u03c9, with \u03ba = sinh((ui,a + ui,b)/2), \u03c9 = cosh((ui,a \u2212 ui,b)/2), and \u03b5 = cosh((ui,a + ui,b)/2). The ratio \u03b5/\u03ba = coth((ui,a + ui,b)/2) = \u03c3i/(a\u03c4ei ) allows finding (ui,a + ui,b)/2 = arccoth(\u03c3i/(a\u03c4ei )) = \u03c71. Then, from the relation \u03c9 = \u03c4ei /(2k \u03ba), one also obtains (ui,a \u2212 ui,b)/2 = arccosh(\u03c4ei /(2k sinh(\u03c71))) = \u03c72, and finally ( ui,a ui,b ) = ( 1 2 1 2 1 2 \u2212 12 )\u22121( \u03c71 \u03c72 ) . Evaluating this last relation for the maximum torque and stiffness demands allows obtaining the maximum values for ui,a and ui,b, which are then converted to the maximum of \u03c0i and\u03bci. For the adopted qbmove actuators, it holds \u03c4emax = 7 Nm and \u03c3max = 83.5 Nm/rad, and hence it holds \u03c0i = 3.3416 and \u03bci = 37.2032.\nIn accordance with this reasoning and the proposed formalization, the nominal matrices of the actuation-related terms are chosen as \u03a0\u0304 = diag(\u03a0\u03041, \u03a0\u03042, \u03a0\u03043), \u03a3\u0304 = diag(\u03a3\u03041, \u03a3\u03042, \u03a3\u03043), with \u03a0\u0304i = (\u03c0i, \u03c0i, 0, 0) and \u03a3\u0304i = (0, 0, \u03bci, \u03bci), for all i, and the (manipulable) input vector is\n\u0393(\u03c6a, \u03c6b)=(\u03b3 T 1 (\u03c61,a, \u03c61,b), \u03b3 T 2 (\u03c62,a, \u03c62,b), \u03b3 T 3 (\u03c63,a, \u03c63,b)) T ,\nwith \u03b3i = (ui,a, ui,b)T , for all i. Accordingly, the (manipulable) input vector is Uk = \u0393(\u03c6a(kT ), \u03c6b(kT )) and the matrices of the estimator are of immediate writing from Theorem 1, while they are omitted here for the sake of space. Finally, it should be recalled, as stated in Section III, that the actual inputs to the i-th VSA device are the motor positions, \u03b8i,a and\u03b8i,b. They are finally determined by inverting (1) and are given by \u03b8ci,a = qi \u2212 ui,a/a and \u03b8ci,b = qi \u2212 ui,b/a."
        },
        {
            "heading": "B. Effectiveness and Robustness Evaluation",
            "text": "To show its validity and robustness, the proposed approach is tested in Matlab/Simulink with parametric, nominal inertia matrix M\u0304 , and input matrix B uncertainties. Nominal parameters are reported in Table I. Nominal matrix M\u0304 is set to be diag(I1, I2, I3) representing the case where all off-diagonal entries of M(q) are neglected. Perturbation of parameters, M\u0304 , and B range from a 25% to a 100% increase from their nominal values. Fig. 2 depicts the position and stiffness tracking errors for the robot\u2019s base segment, being the one with the most visible trends. A common behavior is that higher tracking errors appear with larger uncertainty, yet, the closed-loop performance is not significantly deteriorated even with substantial uncertainty. Noticeably, this shows that the method is robust with respect to\nthe choice of M\u0304 and B, which, in practice, allows neglecting all off-diagonal entries of M(q) and approximating the diagonal ones even up to a relative error of 100%.\nMoreover, the proposed solution is compared in Fig. 3 with an ESO-based one [24], initialized with position and stiffness tracking errors of (0.1,0.1,0.1) rad and (4,4,4) Nm/rad. The robust DUIO-based control law in (21) is used with the same control gains and, specifically, matrixK is chosen so that the closed loop matrix A\u2217 are in the unit circle, and with desired references of the form qi,d = Qi sin\u03c9qit and \u03c3i,d = i +A\u03c3i | sin\u03c9\u03c3it|, for i \u2208 {1, 2, 3}. Fig. 3 shows that the UIO solution outperforms the ESO one, achieves a faster and more precise disturbance estimation and allows better tracking errors."
        },
        {
            "heading": "C. Experimental Validation",
            "text": "An experimental validation of the proposed solution is presented using the real hardware pictured in Fig. 1. Nominal geometric and inertial parameter values are in Table I and the desired trajectories have the same form as in the simulations, so as to capture similar behaviors, and have been chosen with various amplitudes and frequencies for each joint. The controller is also set as in Section VI-A. Link positions are measured through the encoders embedded in the qbmove actuators, while joint stiffness is obtained through the use of the stiffness estimator in [25]. As it can be seen in Fig. 4, the proposed solution robustly tracks the desired signals, and imperfect yet practically negligible tracking errors occur only very rarely, which is due to intrinsic slackness of the actuators. Noteworthy, despite the drastically simplified robot model, used to design the estimator from Theorem 1 and the controller from Theorem 2, each link position and joint stiffness are smoothly and successfully controlled."
        },
        {
            "heading": "VII. CONCLUSION",
            "text": "This letter formulated the model of VSA-driven articulated soft robots with the factorized actuator matrix suitable for the decomposition into the nominal and uncertain dynamics, and it derived a novel solution for their control. Using delayed unknown input observer theory and disturbance-observer-based control, the proposed approach enables successful position and stiffness tracking, even with large disturbance due to the model uncertainty. Validation of the method was carried out in simulations and experiments, proving also its robustness to parametric and structural uncertainties. Future work will explore the advantages of information decoupling between possible external interaction and uncertainty estimation, due to parametric changes and actuator failures.\nREFERENCES\n[1] R. Van Ham, B. Vanderborght, M. Van Damme, B. Verrelst, and D. Lefeber, \u201cMACCEPA, the mechanically adjustable compliance and controllable equilibrium position actuator: Design and implementation in a biped robot,\u201d Robot. Auton. Syst., vol. 55, no. 10, pp. 761\u2013768, 2007. [2] F. Wu and M. Howard, \u201cEnergy regenerative damping in variable impedance actuators for long-term robotic deployment,\u201d IEEE Trans. Robot., vol. 36, no. 6, pp. 1778\u20131790, Dec. 2020. [3] R. Mengacci, F. Angelini, M. G. Catalano, G. Grioli, A. Bicchi, and M. Garabini, \u201cStiffness bounds for resilient and stable physical interaction of articulated soft robots,\u201d IEEE Robot. Automat. Lett., vol. 4, no. 4, pp. 4131\u20134138, Oct. 2019.\n[4] S. Wolf et al., \u201cVariable stiffness actuators: Review on design and components,\u201d IEEE/ASME Trans. Mechatronics, vol. 21, no. 5, pp. 2418\u20132430, Oct. 2016. [5] G. Palli, C. Melchiorri, and A. De Luca, \u201cOn the feedback linearization of robots with variable joint stiffness,\u201d in Proc. IEEE Int. Conf. Robot. Automat., 2008, pp. 1753\u20131759. [6] R. Mengacci, F. Angelini, M. G. Catalano, G. Grioli, A. Bicchi, and M. Garabini, \u201cOn the motion/stiffness decoupling property of articulated soft robots with application to model-free torque iterative learning control,\u201d Int. J. Robot. Res., vol. 40, no. 1, pp. 348\u2013374, 2021. [7] M. Trumic\u0301, K. Jovanovic\u0301, and A. Fagiolini, \u201cDecoupled nonlinear adaptive control of position and stiffness for pneumatic soft robots,\u201d Int. J. Robot. Res., vol. 40, no. 1, pp. 277\u2013295, 2021. [8] S. S. M. Salehian, M. Khoramshahi, and A. Billard, \u201cA dynamical system approach for softly catching a flying object: Theory and experiment,\u201d IEEE Trans. Robot., vol. 32, no. 2, pp. 462\u2013471, Apr. 2016. [9] R. Mengacci, M. Garabini, G. Grioli, M. G. Catalano, and A. Bicchi, \u201cOvercoming the torque/stiffness range tradeoff in antagonistic variable stiffness actuators,\u201d IEEE/ASME Trans. Mechatronics, vol. 26, no. 6, pp. 3186\u20133197, Dec. 2021. [10] A. Albu-Sch\u00e4ffer and A. Bicchi, \u201cActuators for soft robotics,\u201d in Handbook of Robotics. B. Siciliano and O. Khatib, Eds. Berlin, Germany: Springer, 2016, ch. 21, pp. 243\u2013282. [11] M. Ruderman, T. Bertram, and M. Iwasaki, \u201cModeling, observation, and control of hysteresis torsion in elastic robot joints,\u201d Mechatronics, vol. 24, no. 5, pp. 407\u2013415, 2014. [12] I. Sardellitti, G. A. Medrano-Cerda, N. Tsagarakis, A. Jafari, and D. G. Caldwell, \u201cGain scheduling control for a class of variable stiffness actuators based on lever mechanisms,\u201d IEEE Trans. Robot., vol. 29, no. 3, pp. 791\u2013798, Jun. 2013. [13] F. Petit, A. Daasch, and A. Albu-Sch\u00e4ffer, \u201cBackstepping control of variable stiffness robots,\u201d IEEE Trans. Control Syst. Technol., vol. 23, no. 6, pp. 2195\u20132202, Nov. 2015. [14] M. Keppler, D. Lakatos, C. Ott, and A. Albu-Sch\u00e4ffer, \u201cElastic structure preserving (ESP) control for compliantly actuated robots,\u201d IEEE Trans. Robot., vol. 34, no. 2, pp. 317\u2013335, Apr. 2018. [15] F. Angelini et al., \u201cDecentralized trajectory tracking control for soft robots interacting with the environment,\u201d IEEE Trans. Robot., vol. 34, no. 4, pp. 924\u2013935, Aug. 2018. [16] F. Petit and A. Albu-Sch\u00e4ffer, \u201cState feedback damping control for a multi DOF variable stiffness robot arm,\u201d in Proc. IEEE Int. Conf. Robot. Automat., 2011, pp. 5561\u20135567. [17] S. Sundaram and C. N. Hadjicostis, \u201cDelayed observers for linear systems with unknown inputs,\u201d IEEE Trans. Autom. Control, vol. 52, no. 2, pp. 334\u2013339, Feb. 2007. [18] A. H. Al-Bayati and Z. Skaf, \u201cA comparative study of linear observers applied to a DC servo motor,\u201d in Proc. IEEE Int. Conf. Modelling, Identification Control, 2010, pp. 785\u2013790. [19] T. H. Chong, V. Chalvet, and D. J. Braun, \u201cAnalytical conditions for the design of variable stiffness mechanisms,\u201d in Proc. IEEE Int. Conf. Robot. Automat., 2017, pp. 1241\u20131247. [20] M. Mattioni, A. Moreschini, S. Monaco, and D. Normand-Cyrot, \u201cOn feedback passivation under sampling,\u201d in Proc. IEEE Amer. Control Conf., 2021, pp. 3578\u20133583. [21] K. Youcef-Toumi and O. Ito, \u201cA time delay controller for systems with unknown dynamics,\u201d in Proc. Amer. Control Conf., 1988, pp. 904\u2013913. [22] Qbrobotics, Qbmove Advanced Kit - User Manual. Accessed: Feb. 15, 2022. [Online]. Available: https://qbrobotics.com/wp-content/uploads/ 2021/08/qbmove-advanced-kit-Base-user-manual-1.pdf [23] J. Kim, A. S. Lee, K. Chang, B. Schwarz, S. A. Gadsden, and M. Al-Shabi, \u201cDynamic modeling and motion control of a three-link robotic manipulator,\u201d in Proc. Int. Conf. Artif. Life Robot., 2017, vol. 22, pp. 380\u2013383. [24] S. E. Talole, J. P. Kolhe, and S. B. Phadke, \u201cExtended-state-observer-based control of flexible-joint system with experimental validation,\u201d IEEE Trans. Ind. Electron., vol. 57, no. 4, pp. 1411\u20131419, Apr. 2010. [25] A. Fagiolini, M. Trumic\u0301, and K. Jovanovic\u0301, \u201cAn input observer-based stiffness estimation approach for flexible robot joints,\u201d IEEE Robot. Automat. Lett., vol. 5, no. 2, pp. 1843\u20131850, Apr. 2020.\nOpen Access provided by \u2018Universit\u00e0 degli Studi di Palermo\u2019 within the CRUI CARE Agreement"
        }
    ],
    "title": "Robust and Decoupled Position and Stiffness Control for Electrically-Driven Articulated Soft Robots",
    "year": 2022
}