{
    "abstractText": "The polarization of the cosmic microwave background (CMB) can be used to search for parity-violating processes like that predicted by a Chern-Simons coupling to a light pseudoscalar field. Such an interaction rotates E modes into B modes in the observed CMB signal by an effect known as cosmic birefringence. Even though isotropic birefringence can be confused with the rotation produced by a miscalibration of the detectors\u2019 polarization angles the degeneracy between both effects is broken when Galactic foreground emission is used as a calibrator. In this work, we use realistic simulations of the High-Frequency Instrument of the Planck mission to test the impact that Galactic foreground emission and instrumental systematics have on the recent birefringence measurements obtained through this technique. Our results demonstrate the robustness of the methodology against the miscalibration of polarization angles and other systematic effects, like intensity-to-polarization leakage, beam leakage, or cross-polarization effects. However, our estimator is sensitive to the EB correlation of polarized foreground emission. Here we propose to correct the bias induced by dust EB by modeling the foreground signal with templates produced in Bayesian component-separation analyses that fit parametric models to CMB data. Acknowledging the limitations of currently available dust templates like that of the Commander sky model, high-precision CMB data and a characterization of dust beyond the modified blackbody paradigm are needed to obtain a definitive measurement of cosmic birefringence in the future.",
    "authors": [
        {
            "affiliations": [],
            "name": "P. Diego-Palazuelos"
        },
        {
            "affiliations": [],
            "name": "E. Mart\u00ednez-Gonz\u00e1lez"
        },
        {
            "affiliations": [],
            "name": "P. Vielva"
        },
        {
            "affiliations": [],
            "name": "R. B. Barreiro"
        },
        {
            "affiliations": [],
            "name": "M. Tristram"
        },
        {
            "affiliations": [],
            "name": "E. de la Hoz"
        },
        {
            "affiliations": [],
            "name": "J. R. Eskilt"
        },
        {
            "affiliations": [],
            "name": "Y. Minami"
        },
        {
            "affiliations": [],
            "name": "R. M. Sullivan"
        },
        {
            "affiliations": [],
            "name": "A. J. Banday"
        },
        {
            "affiliations": [],
            "name": "K. M. G\u00f3rski"
        },
        {
            "affiliations": [],
            "name": "D. Scott"
        }
    ],
    "id": "SP:f0efa7c0eb5808cd3d7a828cc202a97f4717eb63",
    "references": [
        {
            "authors": [
                "G. Gubitosi",
                "F. Paci"
            ],
            "title": "Constraints on cosmological birefringence energy dependence from CMB polarization data",
            "venue": "J. Cosmology Astropart. Phys. 2013 ",
            "year": 2013
        },
        {
            "authors": [
                "D.J.E. Marsh"
            ],
            "title": "Axion cosmology",
            "venue": "Phys. Rep. 643 ",
            "year": 2016
        },
        {
            "authors": [
                "J.L. Feng"
            ],
            "title": "Dark Matter Candidates from Particle Physics and Methods of Detection",
            "venue": "ARA&A 48 ",
            "year": 2010
        },
        {
            "authors": [
                "J. Yoo",
                "Y. Watanabe"
            ],
            "title": "Theoretical Models of Dark Energy",
            "venue": "Int. J. Mod. Phys. D 21 ",
            "year": 2012
        },
        {
            "authors": [
                "S.M. Carroll",
                "G.B. Field",
                "R. Jackiw"
            ],
            "title": "Limits on a Lorentz- and parity-violating modification of electrodynamics",
            "venue": "Phys. Rev. D 41 ",
            "year": 1990
        },
        {
            "authors": [
                "S.M. Carroll",
                "G.B. Field"
            ],
            "title": "Einstein equivalence principle and the polarization of radio galaxies",
            "venue": "Phys. Rev. D 43 ",
            "year": 1991
        },
        {
            "authors": [
                "D. Harari",
                "P. Sikivie"
            ],
            "title": "Effects of a Nambu-Goldstone boson on the polarization of radio galaxies and the cosmic microwave background",
            "venue": "Phys. Lett. B 289 ",
            "year": 1992
        },
        {
            "authors": [
                "E. Komatsu"
            ],
            "title": "New physics from the polarized light of the cosmic microwave background",
            "venue": "Nat. Rev. Phys. ",
            "year": 2022
        },
        {
            "authors": [
                "L. Campanelli",
                "A.D. Dolgov",
                "M. Giannotti",
                "F.L. Villante"
            ],
            "title": "Faraday Rotation of the Cosmic Microwave Background Polarization and Primordial Magnetic Field Properties",
            "venue": "ApJ 616 ",
            "year": 2004
        },
        {
            "authors": [
                "K. Subramanian"
            ],
            "title": "The origin",
            "venue": "evolution and signatures of primordial magnetic fields, Rep. Prog. Phys. 79 ",
            "year": 2016
        },
        {
            "authors": [
                "G.M. Shore"
            ],
            "title": "Strong equivalence",
            "venue": "Lorentz and CPT violation, anti-hydrogen spectroscopy and gamma-ray burst polarimetry, Nucl. Phys. B 717 ",
            "year": 2005
        },
        {
            "authors": [
                "R.J. Gleiser",
                "C.N. Kozameh"
            ],
            "title": "Astrophysical limits on quantum gravity motivated birefringence",
            "venue": "Phys. Rev. D 64 ",
            "year": 2001
        },
        {
            "authors": [
                "J.R. Eskilt"
            ],
            "title": "Frequency-dependent constraints on cosmic birefringence from the LFI and HFI Planck Data Release 4",
            "venue": "A&A 662 ",
            "year": 2022
        },
        {
            "authors": [
                "A. Lue",
                "L. Wang",
                "M. Kamionkowski"
            ],
            "title": "Cosmological Signature of New Parity-Violating Interactions",
            "venue": "Phys. Rev. Lett. 83 ",
            "year": 1999
        },
        {
            "authors": [
                "M.A. Fedderke",
                "P.W. Graham",
                "S. Rajendran"
            ],
            "title": "Axion dark matter detection with CMB polarization",
            "venue": "Phys. Rev. D 100 ",
            "year": 2019
        },
        {
            "authors": [
                "H. Nakatsuka",
                "T. Namikawa",
                "E. Komatsu"
            ],
            "title": "Is cosmic birefringence due to dark energy or dark matter? A tomographic approach",
            "venue": "Phys. Rev. D 105 ",
            "year": 2022
        },
        {
            "authors": [
                "B. Feng",
                "M. Li",
                "J.-Q. Xia",
                "X. Chen",
                "X. Zhang"
            ],
            "title": "Searching for CPT Violation with Cosmic Microwave Background Data from WMAP and BOOMERANG",
            "venue": "Phys. Rev. Lett. 96 ",
            "year": 2006
        },
        {
            "authors": [
                "E.Y.S. Wu",
                "P. Ade",
                "J. Bock",
                "M. Bowden",
                "M.L. Brown"
            ],
            "title": "G",
            "venue": "Cahill et al., Parity Violation Constraints Using Cosmic Microwave Background Polarization Spectra from 2006 and 2007 Observations by the QUaD Polarimeter, Phys. Rev. Lett. 102 ",
            "year": 2009
        },
        {
            "authors": [
                "G. Hinshaw",
                "D. Larson",
                "E. Komatsu",
                "D.N. Spergel",
                "C.L. Bennett"
            ],
            "title": "J",
            "venue": "Dunkley et al., Nine-year Wilkinson Microwave Anisotropy Probe (WMAP) Observations: Cosmological Parameter Results, ApJS 208 ",
            "year": 2013
        },
        {
            "authors": [
                "T. Namikawa",
                "Y. Guan",
                "O. Darwish",
                "B.D. Sherwin",
                "S. Aiola"
            ],
            "title": "N",
            "venue": "Battaglia et al., Atacama Cosmology Telescope: Constraints on cosmic birefringence, Phys. Rev. D 101 ",
            "year": 2020
        },
        {
            "authors": [
                "F. Bianchini",
                "W.L.K. Wu",
                "P.A.R. Ade",
                "A.J. Anderson",
                "J.E. Austermann"
            ],
            "title": "J",
            "venue": "S. Avva et al., Searching for anisotropic cosmic birefringence with polarization data from SPTpol, Phys. Rev. D 102 ",
            "year": 2020
        },
        {
            "authors": [
                "S.K. Choi",
                "M. Hasselfield",
                "S.-P.P. Ho",
                "B. Koopman",
                "M. Lungu"
            ],
            "title": "M",
            "venue": "H. Abitbol et al., The Atacama Cosmology Telescope: a measurement of the Cosmic Microwave Background power spectra at 98 and 150 GHz, J. Cosmology Astropart. Phys. 2020 ",
            "year": 2020
        },
        {
            "authors": [
                "W. Hu",
                "M.M. Hedman",
                "M. Zaldarriaga"
            ],
            "title": "Benchmark parameters for CMB polarization experiments",
            "venue": "Phys. Rev. D 67 ",
            "year": 2003
        },
        {
            "authors": [
                "M. Shimon",
                "B. Keating",
                "N. Ponthieu",
                "E. Hivon"
            ],
            "title": "CMB polarization systematics due to beam asymmetry: Impact on inflationary science",
            "venue": "Phys. Rev. D 77 ",
            "year": 2008
        },
        {
            "authors": [
                "N.J. Miller",
                "M. Shimon",
                "B.G. Keating"
            ],
            "title": "CMB polarization systematics due to beam asymmetry: Impact on cosmological birefringence",
            "venue": "Phys. Rev. D 79 ",
            "year": 2009
        },
        {
            "authors": [
                "A.P.S. Yadav",
                "M. Su",
                "M. Zaldarriaga"
            ],
            "title": "Primordial B-mode diagnostics and self-calibrating the CMB polarization",
            "venue": "Phys. Rev. D 81 ",
            "year": 2010
        },
        {
            "authors": [
                "B.G. Keating",
                "M. Shimon",
                "A.P.S. Yadav"
            ],
            "title": "Self-calibration of Cosmic Microwave Background Polarization Experiments",
            "venue": "ApJ 762 ",
            "year": 2013
        },
        {
            "authors": [
                "H.C. Chiang",
                "P.A.R. Ade",
                "D. Barkats",
                "J.O. Battle",
                "E.M. Bierman"
            ],
            "title": "J",
            "venue": "J. Bock et al., Measurement of Cosmic Microwave Background Polarization Power Spectra from Two Years of BICEP Data, ApJ 711 ",
            "year": 2010
        },
        {
            "authors": [
                "S. Naess",
                "M. Hasselfield",
                "J. McMahon",
                "M.D. Niemack",
                "G.E. Addison"
            ],
            "title": "P",
            "venue": "A. R. Ade et al., The Atacama Cosmology Telescope: CMB polarization at 200 < l < 9000, J. Cosmology Astropart. Phys. 2014 ",
            "year": 2014
        },
        {
            "authors": [
                "J.T. Sayre",
                "C.L. Reichardt",
                "J.W. Henning",
                "P.A.R. Ade",
                "A.J. Anderson"
            ],
            "title": "J",
            "venue": "E. Austermann et al., Measurements of B -mode polarization of the cosmic microwave background from 500 square degrees of SPTpol data, Phys. Rev. D 101 ",
            "year": 2020
        },
        {
            "authors": [
                "P. Vielva",
                "E. Mart\u00ednez-Gonz\u00e1lez",
                "F.J. Casas",
                "T. Matsumura",
                "S. Henrot-Versill\u00e9"
            ],
            "title": "E",
            "venue": "Komatsu et al., Polarization angle requirements for CMB B-mode experiments. Application to the LiteBIRD satellite, J. Cosmology Astropart. Phys. 2022 ",
            "year": 2022
        },
        {
            "authors": [
                "B.R. Johnson",
                "C.J. Vourch",
                "T.D. Drysdale",
                "A. Kalman",
                "S. Fujikawa"
            ],
            "title": "B",
            "venue": "Keating et al., A CubeSat for Calibrating Ground-Based and Sub-Orbital Millimeter-Wave Polarimeters (CalSat), J. Astron. Instrum. 4 ",
            "year": 2015
        },
        {
            "authors": [
                "F. Nati",
                "M.J. Devlin",
                "M. Gerbino",
                "B.R. Johnson",
                "B. Keating"
            ],
            "title": "L",
            "venue": "Pagano et al., POLOCALC: A Novel Method to Measure the Absolute Polarization Orientation of the Cosmic Microwave Background, J. Astron. Instrum. 6 ",
            "year": 2017
        },
        {
            "authors": [
                "M.F. Navaroli",
                "G.P. Teply",
                "K.D. Crowley",
                "J.P. Kaufman",
                "N.B. Galitzki"
            ],
            "title": "K",
            "venue": "S. Arnold et al., Design and characterization of a ground-based absolute polarization calibrator for use with polarization sensitive CMB experiments, in Millimeter, Submillimeter, and Far-Infrared Detectors and Instrumentation for Astronomy IX, J. Zmuidzinas and J.-R. Gao, eds., vol. 10708 of Proc. SPIE, p. 107082A, July",
            "year": 2018
        },
        {
            "authors": [
                "F.J. Casas",
                "E. Mart\u00ednez-Gonz\u00e1lez",
                "J. Bermejo-Ballesteros",
                "S. Garc\u00eda",
                "J. Cubas"
            ],
            "title": "P",
            "venue": "Vielva et al., L2-CalSat: A Calibration Satellite for Ultra-Sensitive CMB Polarization Space Missions, Sensors 21 ",
            "year": 2021
        },
        {
            "authors": [
                "P. Ade",
                "J. Aguirre",
                "Z. Ahmed",
                "S. Aiola",
                "A. Ali"
            ],
            "title": "D",
            "venue": "Alonso et al., The Simons Observatory: science goals and forecasts, J. Cosmology Astropart. Phys. 2019 ",
            "year": 2019
        },
        {
            "authors": [
                "K. Abazajian",
                "G. Addison",
                "P. Adshead",
                "Z. Ahmed",
                "S.W. Allen"
            ],
            "title": "D",
            "venue": "Alonso et al., CMB-S4 Science Case, Reference Design, and Project Plan, arXiv e-prints ",
            "year": 2019
        },
        {
            "authors": [
                "Y. Minami",
                "H. Ochi",
                "K. Ichiki",
                "N. Katayama",
                "E. Komatsu",
                "T. Matsumura"
            ],
            "title": "Simultaneous determination of the cosmic birefringence and miscalibrated polarization angles from cmb experiments",
            "venue": "PTEP 2019 ",
            "year": 2019
        },
        {
            "authors": [
                "Y. Minami"
            ],
            "title": "Determination of miscalibrated polarization angles from observed cosmic microwave background and foreground EB power spectra: Application to partial-sky observation",
            "venue": "PTEP 2020 ",
            "year": 2020
        },
        {
            "authors": [
                "Y. Minami",
                "E. Komatsu"
            ],
            "title": "Simultaneous determination of the cosmic birefringence and miscalibrated polarization angles II: Including cross-frequency spectra",
            "venue": "PTEP 2020 ",
            "year": 2020
        },
        {
            "authors": [
                "N. Krachmalnicoff",
                "T. Matsumura"
            ],
            "title": "E",
            "venue": "de la Hoz, S. Basak, A. Gruppuso, Y. Minami et al., In-flight polarization angle calibration for LiteBIRD: blind challenge and cosmological implications, J. Cosmology Astropart. Phys. 2022 ",
            "year": 2022
        },
        {
            "authors": [
                "Y. Minami",
                "E. Komatsu"
            ],
            "title": "New Extraction of the Cosmic Birefringence from the Planck 2018 Polarization Data",
            "venue": "Phys. Rev. Lett. 125 ",
            "year": 2020
        },
        {
            "authors": [
                "P. Diego-Palazuelos",
                "J.R. Eskilt",
                "Y. Minami",
                "M. Tristram",
                "R.M. Sullivan"
            ],
            "title": "A",
            "venue": "J. Banday et al., Cosmic Birefringence from the Planck Data Release 4, Phys. Rev. Lett. 128 ",
            "year": 2022
        },
        {
            "authors": [
                "F.A. Martire",
                "R.B. Barreiro",
                "E. Mart\u00ednez-Gonz\u00e1lez"
            ],
            "title": "Characterization of the polarized synchrotron emission from Planck and WMAP data",
            "venue": "J. Cosmology Astropart. Phys. 2022 ",
            "year": 2022
        },
        {
            "authors": [
                "K.M. Huffenberger",
                "A. Rotti",
                "D.C. Collins"
            ],
            "title": "The Power Spectra of Polarized",
            "venue": "Dusty Filaments, ApJ 899 ",
            "year": 2020
        },
        {
            "authors": [
                "S.E. Clark",
                "C.-G. Kim",
                "J.C. Hill",
                "B.S. Hensley"
            ],
            "title": "The origin of parity violation in polarized dust emission and implications for cosmic birefringence",
            "venue": "ApJ 919 ",
            "year": 2021
        },
        {
            "authors": [
                "A.J. Cukierman",
                "S.E. Clark",
                "G. Halal"
            ],
            "title": "Magnetic Misalignment of Interstellar Dust Filaments",
            "venue": "arXiv e-prints ",
            "year": 2022
        },
        {
            "authors": [
                "J. Jewell",
                "S. Levin",
                "C.H. Anderson"
            ],
            "title": "Application of Monte Carlo Algorithms to the Bayesian Analysis of the Cosmic Microwave Background",
            "venue": "ApJ 609 ",
            "year": 2004
        },
        {
            "authors": [
                "B.D. Wandelt",
                "D.L. Larson",
                "A. Lakshminarayanan"
            ],
            "title": "Global",
            "venue": "exact cosmic microwave background data analysis using Gibbs sampling, Phys. Rev. D 70 ",
            "year": 2004
        },
        {
            "authors": [
                "H.K. Eriksen"
            ],
            "title": "I",
            "venue": "J. O\u2019Dwyer, J. B. Jewell, B. D. Wandelt, D. L. Larson, K. M. G\u00f3rski et al., Power Spectrum Estimation from High-Resolution Maps by Gibbs Sampling, ApJS 155 ",
            "year": 2004
        },
        {
            "authors": [
                "H.K. Eriksen",
                "J.B. Jewell",
                "C. Dickinson",
                "A.J. Banday",
                "K.M. G\u00f3rski",
                "C.R. Lawrence"
            ],
            "title": "Joint Bayesian Component Separation and CMB Power Spectrum Estimation",
            "venue": "ApJ 676 ",
            "year": 2008
        },
        {
            "authors": [
                "J.R. Eskilt",
                "E. Komatsu"
            ],
            "title": "Improved constraints on cosmic birefringence from the WMAP and Planck cosmic microwave background polarization data",
            "venue": "Phys. Rev. D 106 ",
            "year": 2022
        },
        {
            "authors": [
                "S. Saito",
                "K. Ichiki",
                "A. Taruya"
            ],
            "title": "Probing polarization states of primordial gravitational waves with cosmic microwave background anisotropies",
            "venue": "J. Cosmology Astropart. Phys. 2007 ",
            "year": 2007
        },
        {
            "authors": [
                "T. Fujita",
                "Y. Minami",
                "M. Shiraishi",
                "S. Yokoyama"
            ],
            "title": "Can primordial parity violation explain the observed cosmic birefringence",
            "venue": "arXiv e-prints ",
            "year": 2022
        },
        {
            "authors": [
                "M.-A. Watanabe",
                "S. Kanno",
                "J. Soda"
            ],
            "title": "Imprints of the anisotropic inflation on the cosmic microwave background",
            "venue": "MNRAS 412 ",
            "year": 2011
        },
        {
            "authors": [
                "K. Tassis",
                "V. Pavlidou"
            ],
            "title": "Searching for inflationary B modes: can dust emission properties be extrapolated from 350 GHz to 150 GHz",
            "venue": "MNRAS 451 ",
            "year": 2015
        },
        {
            "authors": [
                "Planck Collaboration",
                "Planck intermediate results. L"
            ],
            "title": "Evidence of spatial variation of the polarized thermal dust spectral energy distribution and implications for CMB B-mode analysis, A&A",
            "year": 2017
        },
        {
            "authors": [
                "L. Vacher",
                "J. Chluba",
                "J. Aumont",
                "A. Rotti",
                "L. Montier"
            ],
            "title": "High precision modeling of polarized signals: moment expansion method generalized to spin-2 fields",
            "venue": "Accepted for publication in A&A ",
            "year": 2022
        },
        {
            "authors": [
                "V. Pelgrims",
                "S.E. Clark",
                "B.S. Hensley",
                "G.V. Panopoulou",
                "V. Pavlidou"
            ],
            "title": "K",
            "venue": "Tassis et al., Evidence for line-of-sight frequency decorrelation of polarized dust emission in Planck data, A&A 647 ",
            "year": 2021
        },
        {
            "authors": [
                "A. Ritacco",
                "F. Boulanger",
                "V. Guillet",
                "J.-M. Delouis",
                "J.-L. Puget"
            ],
            "title": "J",
            "venue": "Aumont et al., Dust polarization spectral dependence from Planck HFI data. Turning point on CMB polarization foregrounds modelling, arXiv e-prints ",
            "year": 2022
        },
        {
            "authors": [
                "L. Vacher",
                "J. Aumont",
                "F. Boulanger",
                "L. Montier",
                "V. Guillet"
            ],
            "title": "A",
            "venue": "Ritacco et al., Frequency dependence of the thermal dust E/B ratio and EB correlation: insights from the spin-moment expansion, arXiv e-prints ",
            "year": 2022
        },
        {
            "authors": [
                "E. Hivon",
                "S. Mottet",
                "N. Ponthieu"
            ],
            "title": "QuickPol: Fast calculation of effective beam matrices for CMB polarization",
            "venue": "A&A 598 ",
            "year": 2017
        },
        {
            "authors": [
                "E. Hivon",
                "K.M. G\u00f3rski",
                "C.B. Netterfield",
                "B.P. Crill",
                "S. Prunet",
                "F. Hansen"
            ],
            "title": "MASTER of the Cosmic Microwave Background Anisotropy Power Spectrum: A Fast Method for Statistical Analysis of Large and Complex Cosmic Microwave Background Data Sets",
            "venue": "ApJ 567 ",
            "year": 2002
        },
        {
            "authors": [
                "A. Challinor",
                "G. Chon"
            ],
            "title": "Error analysis of quadratic power spectrum estimates for cosmic microwave background polarization: sampling covariance",
            "venue": "MNRAS 360 ",
            "year": 2005
        },
        {
            "authors": [
                "D. Alonso",
                "J. Sanchez"
            ],
            "title": "A",
            "venue": "Slosar and LSST Dark Energy Science Collaboration, A unified pseudo-C` framework, MNRAS 484 ",
            "year": 2019
        },
        {
            "authors": [
                "L. McBride",
                "P. Bull",
                "B.S. Hensley"
            ],
            "title": "Characterizing line-of-sight variability of polarized dust emission with future CMB experiments",
            "venue": "arXiv e-prints ",
            "year": 2022
        },
        {
            "authors": [
                "L. Vacher",
                "J. Aumont",
                "L. Montier",
                "S. Azzoni",
                "F. Boulanger",
                "M. Remazeilles"
            ],
            "title": "Moment expansion of polarized dust SED: A new path towards capturing the CMB B-modes with LiteBIRD",
            "venue": "A&A 660 ",
            "year": 2022
        },
        {
            "authors": [
                "A. Lewis",
                "A. Challinor"
            ],
            "title": "CAMB: Code for Anisotropies in the Microwave Background",
            "venue": "Feb.",
            "year": 2011
        },
        {
            "authors": [
                "K.M. G\u00f3rski",
                "E. Hivon",
                "A.J. Banday",
                "B.D. Wandelt",
                "F.K. Hansen"
            ],
            "title": "M",
            "venue": "Reinecke et al., HEALPix: A Framework for High-Resolution Discretization and Fast Analysis of Data Distributed on the Sphere, ApJ 622 ",
            "year": 2005
        },
        {
            "authors": [
                "D. Foreman-Mackey",
                "D.W. Hogg",
                "D. Lang",
                "J. Goodman"
            ],
            "title": "emcee: The MCMC Hammer",
            "venue": "PASP 125 ",
            "year": 2013
        },
        {
            "authors": [
                "D. Foreman-Mackey"
            ],
            "title": "corner.py: Scatterplot matrices in Python, The Journal of Open Source Software 1 (2016",
            "year": 2016
        },
        {
            "authors": [
                "J.D. Hunter"
            ],
            "title": "Matplotlib: A 2D Graphics Environment",
            "venue": "Comput. Sci. Eng. 9 ",
            "year": 2007
        },
        {
            "authors": [
                "C.R. Harris",
                "K.J. Millman"
            ],
            "title": "S",
            "venue": "J. van der Walt, R. Gommers, P. Virtanen, D. Cournapeau et al., Array programming with NumPy, Nature 585 ",
            "year": 2020
        }
    ],
    "sections": [
        {
            "text": "Contents"
        },
        {
            "heading": "1 Introduction 1",
            "text": ""
        },
        {
            "heading": "2 Methodology 4",
            "text": "3 NPIPE simulations and Galactic masks 8"
        },
        {
            "heading": "4 Impact of Galactic foregrounds 10",
            "text": ""
        },
        {
            "heading": "5 Impact of instrumental systematics 15",
            "text": ""
        },
        {
            "heading": "6 Impact of noise bias 20",
            "text": ""
        },
        {
            "heading": "7 Conclusions 22",
            "text": ""
        },
        {
            "heading": "A Cross-spectra estimator 23",
            "text": ""
        },
        {
            "heading": "B Comparison with MCMC sampling 27",
            "text": ""
        },
        {
            "heading": "C Calculation of the covariance matrix 29",
            "text": ""
        },
        {
            "heading": "D Modeling Galactic foregrounds in the covariance matrix 30",
            "text": ""
        },
        {
            "heading": "1 Introduction",
            "text": "Parity-violating processes are predicted by several extensions of the standard model of cosmology and particle physics [1]. For example, axion-like particles [2] and other dark energy and dark matter models [3, 4] introduce a new parity-violating pseudoscalar field, \u03c6, that can couple to the electromagnetic tensor through a Chern-Simons interaction [5\u20137]. Such an interaction makes the phase velocities of the right- and left-handed helicity states of photons differ, rotating the plane of linear polarization clockwise on the sky by an angle \u03b2 = \u221212g\u03c6\u03b3 \u222b \u2202\u03c6 \u2202t dt that depends on the coupling constant of the pseudoscalar field to photons g\u03c6\u03b3 , and the time evolution of the field. This rotation is what we call \u201ccosmic birefringence\u201d because it is as if space itself acted like a birefringent material (see Ref. [8] for a review). Cosmic birefringence can also be produced by the Faraday rotation originating from primordial magnetic fields [9, 10]. Unlike the Chern-Simons interaction, Faraday rotation does depend on the photon energy, leading to a \u03b2 \u221d \u03bd\u22122 birefringence angle. A frequency-dependent birefringence is also predicted by superluminal Lorentz-violating electrodynamics emerging from a non-vanishing Weyl tensor (\u03b2 \u221d \u03bd) [11], and some quantum gravity models that modify the dispersion relation of photons (\u03b2 \u221d \u03bd2) [12]. Nevertheless, in this work, we focus on the frequency-independent birefringence predicted by light pseudoscalar fields, since the analysis of Planck data presented in Ref. [13] highly disfavored these other theories. Although we know that birefringence must be a small effect, in principle we could constrain \u03b2 by measuring the rotation of the plane of polarization of a well-known source of linearly polarized light situated at a far enough distance to allow photons to accumulate a\n\u2013 1 \u2013\nsignificant rotation. Emitted at the epoch of recombination and with its polarization angular power spectra accurately predicted by the \u039b cold dark matter (\u039bCDM) model, the cosmic microwave background (CMB) is, therefore, the ideal tool in the search for cosmic birefringence [14]. We can model the effect of a constant, isotropic, and frequency-independent birefringence angle (like the one that a homogeneous axion-like field of mass 10\u221233eV\u2264 m\u03c6 \u2264 10\u221228eV might produce [13, 15, 16]) as a rotation of the plane of linear polarization of CMB photons. In this way, the spherical harmonic coefficients of the E and B modes of the CMB polarization that we observe (\u201co\u201d superscript) would be a rotation of those emitted at recombination:(\nEo`m Bo`m\n) = ( c(2\u03b2) \u2212s(2\u03b2) s(2\u03b2) c(2\u03b2) )( ECMB`m BCMB`m ) . (1.1)\nFor brevity, throughout this work we refer to the sine, cosine, and tangent functions as \u201cs\u201d, \u201cc\u201d, and \u201ct\u201d, respectively. Under this approximation, and without solving the Boltzmann equations coupled to the light pseudoscalar field (as done, e.g., in Ref. [16]), we can model the observed angular power spectra as a rotation of the CMB spectra predicted in \u039bCDM:C EE,o `\nCEB,o` CBB,o`\n = c2(2\u03b2) \u2212s(4\u03b2) s2(2\u03b2)1\n2s(4\u03b2) c(4\u03b2) \u2212 1 2s(4\u03b2) s2(2\u03b2) s(4\u03b2) c2(2\u03b2) CEE,\u039bCDM` 0 CBB,\u039bCDM`  . (1.2) From Eq. (1.2) it follows that the observed EB correlation can be written as a rotation of the observed EE and BB angular power spectra like\nCEB,o` = t(4\u03b2)\n2\n( CEE,o` \u2212 C BB,o ` ) . (1.3)\nEq. (1.3) has been the basis for the majority of the harmonic-space methodologies applied in the past to measure cosmic birefringence from CMB polarization data [17\u201324]. However, those analyses have often been dominated by systematic uncertainties. In particular, the miscalibration of the detector\u2019s polarization angle is one of the most pernicious systematics for this type of analysis, since it produces a rotation of the observed polarization signal that is degenerate with that of birefringence [25\u201328]. Namely, for an \u03b1 miscalibration angle, the CMB spherical harmonic coefficients in Eq. (1.1) would be rotated by \u03b2 + \u03b1, so that the observed EB correlation in Eq. (1.3) yields \u03b2 + \u03b1 instead of \u03b2. In this way, the calibration strategies used for currently available CMB datasets tend to limit the systematic uncertainty attainable through the analysis of EB to 0.5\u25e6-1\u25e6 [20, 29\u201333]. In addition to the miscalibration of polarization angles, other systematic effects, like intensity-to-polarization leakage, beam leakage, or cross-polarization effects, also produce spurious EB correlations that contribute to the total systematic uncertainty [25\u201328]. Although the accuracy in the calibration of polarization angles is expected to improve in the near future [34\u201338], systematics will play an even more critical role in the precision measurements of CMB polarization envisioned for next-generation experiments [39\u201341]. To overcome the limitation imposed by the calibration of polarization angles, Refs. [42\u2013 44] proposed a novel methodology to simultaneously determine birefringence and miscalibration angles through the use of polarized Galactic foreground emission. Foreground emission can be used to break the degeneracy between the \u03b1 and \u03b2 angles since Galactic foreground photons are negligibly affected by cosmic birefringence due to their small propagation length.\n\u2013 2 \u2013\nThat methodology has proven to successfully capture polarization angle miscalibrations and provide robust birefringence measurements [42\u201345]. Ref. [46] applied it to polarization data from the Planck mission High-Frequency Instrument (HFI) third public release (PR3) [47] and obtained a birefringence measurement of \u03b2 = 0.35\u25e6\u00b10.14\u25e6 (68% C.L.), with no apparent contribution from systematic uncertainties.\nThe subsequent study of HFI data from Planck \u2019s fourth public release (known as PR4 or NPIPE reprocessing) [48] done in Ref. [49] yielded a birefringence angle of \u03b2 = 0.30\u25e6\u00b10.11\u25e6 (68% C.L.). More importantly, that study revealed that, although robust against systematics, the methodology is sensitive to the EB correlation inherent in polarized foreground emission. The contribution from a possible foreground EB correlation had been considered but ultimately neglected in previous works [42\u201344, 46], since the EB correlation of both Galactic synchrotron and dust emissions is still statistically compatible with zero according to current experimental constraints [50, 51].\nNevertheless, the misalignment between the filamentary dust structures of the interstellar medium and the plane-of-sky orientation of the Galactic magnetic field is expected to induce a non-null EB correlation on Galactic dust emission that can bias the measurement of birefringence [52\u201354]. Two independent approaches to model dust EB and correct for such a bias were proposed in Ref. [49]: one based on the EB correlation predicted from the misalignment of dust filaments and magnetic field lines [53]; and another one that takes the EB from the foreground templates produced by Bayesian component-separation analyses that fit parametric models to CMB data such as the Commander1 sky model [55\u201358].\nProduced by a different physics, no alignment mechanism is known to induce a non-null EB correlation in synchrotron radiation. The study of the synchrotron-dominated frequencies of WMAP and the Low-Frequency Instrument (LFI) of Planck in Refs. [13, 51, 59] suggests that such a hypothetical synchrotron EB has little effect on the measurement of birefringence. Correcting only for dust EB, the combined analysis of Planck HFI and LFI with WMAP data gave a birefringence angle of \u03b2 = 0.342\u25e6+0.094 \u25e6\n\u22120.091\u25e6 (68% C.L.) [59]. The aim of this work is to test the robustness of these cosmic birefringence measure-\nments against Galactic foreground emission and instrumental systematics using high-fidelity simulations of Planck data. Such an analysis was part of the study on the impact of systematics undertaken in Ref. [49], but finally not described in that publication due to space limitations. Although the results presented here are restricted to simulations of Planck HFI, our conclusions on the impact of dust EB and the robustness of the methodology against instrumental systematics are expected to extend to the other measurements presented above.\nThe original implementation of the methodology presented in Refs. [42\u201344] relies on Markov chain Monte Carlo (MCMC) methods to sample the likelihood and obtain the posterior distribution. To reduce the computational cost of that approach, in this work, we present an iterative algorithm based on the small-angle approximation to semi-analytically calculate the maximum likelihood solution. With this implementation we achieve a great reduction of execution time without compromising accuracy and precision, making the algorithm ideal for simulation-based studies of different experimental configurations, foreground models, or systematic effects. This method is the extension to the simultaneous determination of both cosmic birefringence and miscalibrated polarization angles of the methodology originally presented in Ref. [60].\n1Commander products are available at https://pla.esac.esa.int/#maps, and the code itself at https: //github.com/Cosmoglobe/Commander.\n\u2013 3 \u2013\nThis work is structured as follows. In section 2, we present our methodology for the simultaneous estimation of birefringence and miscalibration angles. To test and validate our algorithm in a realistic scenario, we use the official end-to-end simulations provided in the NPIPE data release [48] to build the two simulation sets described in section 3. The effect that Galactic foregrounds, instrumental systematics, and instrumental noise bias have on our estimates are considered in sections 4, 5, and 6, respectively. Final comments and conclusions are left for section 7. Some technical aspects regarding the more general formulation of the estimator in terms of frequency cross-spectra, the comparison with the standard MCMC implementation, the calculation of the covariance matrix, and the modeling of Galactic foregrounds in the covariance matrix, are presented in appendices A, B, C, and D, respectively."
        },
        {
            "heading": "2 Methodology",
            "text": "Both the isotropic birefringence angle \u03b2 and the \u03b1i miscalibration of polarization angles rotate the polarization signal observed by CMB experiments at any given frequency band \u03bdi. However, the amplitude of the birefringence rotation depends on the difference between the value of the pseudoscalar field at the moments of photon emission and observation. For fields that vary slowly, this means that birefringence is proportional to the propagation length of photons [2, 8]. In that case, we can assume that the birefringence suffered by locally emitted Galactic foregrounds (z \u2248 0) is negligible compared to that seen by CMB photons emitted at recombination (z \u2248 1100). Thus, Galactic foreground emission would only be significantly affected by the \u03b1i miscalibration, allowing us to break the degeneracy between both angles [42]. In this way, the E- and B- mode spherical harmonic coefficients of the observed signal at a certain frequency band \u03bdi would be(\nEi,o`m Bi,o`m\n) = ( c(2\u03b1i) \u2212s(2\u03b1i) s(2\u03b1i) c(2\u03b1i) )( Ei,fg`m Bi,fg`m ) + ( c(2\u03b1i + 2\u03b2) \u2212s(2\u03b1i + 2\u03b2) s(2\u03b1i + 2\u03b2) c(2\u03b1i + 2\u03b2) )( Ei,CMB`m Bi,CMB`m ) , (2.1)\nwhere the different superscripts stand for the observed signal (\u201co\u201d), and the underlying Galactic foreground (\u201cfg\u201d) and CMB emissions. Note that in this equation, and throughout the rest of the paper unless otherwise stated, foreground and CMB spherical harmonic coefficients and angular power spectra are assumed to be convolved by the instrumental beam and pixel window functions corresponding to each frequency band. Calculating the angular power spectra of the spherical harmonic coefficients in Eq. (2.1) leads to the following EE, BB, and EB cross-correlations between different i and j frequency bands: C EiEj ,o ` C EiBj ,o `\nC BiEj ,o ` C BiBj ,o `\n = R(\u03b1i, \u03b1j)  C EiEj ,fg ` C EiBj ,fg `\nC BiEj ,fg ` C BiBj ,fg `\n+ R(\u03b1i + \u03b2, \u03b1j + \u03b2)  C EiEj ,\u039bCDM ` 0 0\nC BiBj ,\u039bCDM `  , (2.2) where R is the rotation matrix\nR(\u03b8, \u03b8\u2032) =  c(2\u03b8)c(2\u03b8\u2032) \u2212c(2\u03b8)s(2\u03b8\u2032) \u2212s(2\u03b8)c(2\u03b8\u2032) s(2\u03b8)s(2\u03b8\u2032) c(2\u03b8)s(2\u03b8\u2032) c(2\u03b8)c(2\u03b8\u2032) \u2212s(2\u03b8)s(2\u03b8\u2032) \u2212s(2\u03b8)c(2\u03b8\u2032) s(2\u03b8)c(2\u03b8\u2032) \u2212s(2\u03b8)s(2\u03b8\u2032) c(2\u03b8)c(2\u03b8\u2032) \u2212c(2\u03b8)s(2\u03b8\u2032) s(2\u03b8)s(2\u03b8\u2032) s(2\u03b8)c(2\u03b8\u2032) c(2\u03b8)s(2\u03b8\u2032) c(2\u03b8)c(2\u03b8\u2032)  . (2.3)\n\u2013 4 \u2013\nIn this work, we neglect CMB EB correlations prior to \u03b1i or \u03b2 rotations, since they are expected to be null in \u039bCDM [14]. Nevertheless, in the case of working with alternative models that grant the CMB an initial EB correlation at the moment of recombination (e.g., chiral gravitational waves [14, 61, 62] or anisotropic inflation [63]), the corresponding EB terms must be added to the equations derived from Eq. (2.2), and a theoretical angular power spectrum must be provided for them. On the other hand, we do consider a potential intrinsic foreground EB correlation even though current experimental constraints find it to still be statistically compatible with zero [50, 51]. Starting from Eq. (2.2), we build a maximum likelihood estimator to simultaneously calculate \u03b2 and \u03b1i. Although we use the cross-spectra estimator throughout the rest of the work, in this section we adopt the simpler formulation in terms of only frequency auto-spectra (i = j in Eq. (2.2)) to explain the methodology in detail. For the derivation of the more general estimator in terms of frequency cross-spectra see appendix A. Following a procedure similar to the one detailed in Refs. [13, 42, 60], the observed EB correlation is written as a rotation of the observed EE and BB angular power spectra, the \u039bCDM prediction for the CMB EE and BB angular power spectra, and the foreground EB signal:\nCEB,i,o` = t(4\u03b1i)\n2\n( CEE,i,o` \u2212 C BB,i,o ` ) +\nA c(4\u03b1i) CEB,i,fg` + s(4\u03b2) 2c(4\u03b1i)\n( CEE,i,\u039bCDM` \u2212 C BB,i,\u039bCDM ` ) . (2.4)\nHere A is introduced ad hoc as a normalization parameter: we can set A = 0 to ignore the foreground EB contribution, or take A = 1 if the true foreground emission is known. If the foreground contribution is considered (A 6= 0), then Eq. (2.4) asks for the intrinsic foreground EB correlation prior to any potential \u03b1i rotation. In this work, we take the Commander [55\u201358] sky model2 derived from the analysis of an early version of Planck PR4 data as a template for the polarized foreground emission, leaving A as a free amplitude parameter to fit alongside \u03b2 and \u03b1i. Here we consider a single overall amplitude and use Commander spectral energy distributions (SEDs) to scale the foreground template to the target frequencies. The methodology extends easily to different Ai amplitudes for each frequency band, at the price of increasing the number of parameters to fit. This approach warrants a couple of caveats. First, Commander does not yet provide a signal-dominated template for the foreground EB correlation [64, 65]. Hence the template might include some of the noise fluctuations present in Planck data. Second, the existence of miscalibrated polarization angles, which were not considered in the SEDs assumed by Commander to model Galactic foreground emission, might lead to a spurious EB correlation in their final foreground maps. However, we believe this effect to be minimal, since the EB measured in Commander\u2019s dust template does not resemble a s(4\u03b1)(CEE,fg` \u2212 C BB,fg ` )/2 rotation. To avoid such a spurious EB signal, parametric component-separation methodologies that include instrumental polarization angles in their SEDs are already being proposed [60]. Finally, the integration along the line-of-sight of the thermal emission from several dust clouds with different spectral parameters and polarization angles is not fully characterized by the single modified blackbody SED used by Commander [66\u201370]. This can create spurious dust EB correlations with a different frequency dependence and a strong dependence on the sky\n2The foreground sky model used in this work can be found at NERSC under /global/cfs/cdirs/cmb/ data/planck2020/all_data/npipe6v20_sim/skymodel_cache.\n\u2013 5 \u2013\nfraction and multipole range considered [71]. Alternative ways to model the foreground EB correlation without relying on templates have been proposed in Refs. [13, 42, 43, 49, 59]. From the equality in Eq. (2.4), we build a Gaussian likelihood to simultaneously fit for \u03b2, \u03b1i, and A. For a CMB experiment with a total of N\u03bd frequency bands, and using the \u03c7sij` = C EiEj ,s ` \u2212 C BiBj ,s ` abbreviation, that log-likelihood takes the form\n\u22122 lnL \u2283 \u2211 i,j \u2211 `,`\u2032 [ CEB,i,o` \u2212 t(4\u03b1i) 2 \u03c7oii` \u2212 A c(4\u03b1i) CEB,i,fg` \u2212 s(4\u03b2) 2c(4\u03b1i) \u03c7\u039bCDMii` ] \u00d7\nC\u22121ij``\u2032 [ CEB,j,o`\u2032 \u2212 t(4\u03b1j)\n2 \u03c7ojj`\u2032 \u2212 A c(4\u03b1j) CEB,j,fg`\u2032 \u2212 s(4\u03b2) 2c(4\u03b1j) \u03c7\u039bCDMjj`\u2032\n] , (2.5)\nwhere we are summing over all possible combinations of detector channels (i, j = 1, ..., N\u03bd) and multipoles (`, `\u2032 \u2208 [`min, `max] for a total of N` = `max \u2212 `min + 1), and Cij``\u2032 is the covariance matrix of N\u03bdN` \u00d7 N\u03bdN` dimensions. Here we use the \u2283 symbol to remind the reader that Eq. (2.5) does not show the full log-likelihood, since the ln |Cij``\u2032 | term is not included; although it can usually be excluded from the minimization process, in our case, the log-determinant must be taken into account because the model parameters explicitly appear in the covariance matrix. Therefore, the variation of the free parameters during minimization leads to a change in the likelihood\u2019s normalization that can bias the results if it is not correctly accounted for. As will be further discussed later in this section and in appendix B, the iterative algorithm we propose automatically accounts for this change, so that we do not need to explicitly consider the contribution of the log-determinant. For each combination of ij frequency bands, the corresponding N` \u00d7 N` box of the covariance is calculated as\nCij``\u2032 =Cov [ CEB,i,o` \u2212 t(4\u03b1i)\n2 \u03c7oii` \u2212 A c(4\u03b1i) CEB,i,fg` \u2212 s(4\u03b2) 2c(4\u03b1i) \u03c7\u039bCDMii` ,\nCEB,j,o`\u2032 \u2212 t(4\u03b1j)\n2 \u03c7ojj`\u2032 \u2212 A c(4\u03b1j) CEB,j,fg`\u2032 \u2212 s(4\u03b2) 2c(4\u03b1j) \u03c7\u039bCDMjj`\u2032\n] . (2.6)\nNote that in Eq. (2.6), covariance elements are calculated from the observed angular power spectra and from the model for both foreground and CMB signals. Neglecting `-to-`\u2032 correlations and assuming that the spherical harmonic coefficients are Gaussian, we can approximate each box of the covariance between whatever X, Y, Z, and W combination of observed, foreground, or CMB E- and B-modes by its diagonal:\nCov [ CXY` , C ZW `\u2032 ] \u2248 1 2`+ 1 \u03b4``\u2032 ( CXZ` C YW ` + C XW ` C Y Z ` ) . (2.7)\nIn our notation, we explicitly indicate the use of this approximation by reducing Cij``\u2032 to Cij`, and summations in both ` and `\u2032 to just `. The impact that the non-Gaussianity of Galactic foregrounds has on the estimator was already studied in Ref. [60]. In the case of partial skies, one can still approximate the covariance matrix as diagonal as long as the `-to-`\u2032 correlations induced by the limited sky coverage are reduced by sufficiently apodizing the analysis mask and binning the angular power spectra. See appendix C for more details in the calculation of the covariance matrix. Finally, we average both the angular power spectra and the covariance\n\u2013 6 \u2013\nmatrix into Nbins uniform bins of \u2206` width:\nCXb = 1\n\u2206` \u2211 `\u2208b CX` , Cijb = 1 \u2206`2 \u2211 `\u2208b Cij`. (2.8)\nIn addition to reducing the coupling between non-diagonal multipoles for masked skies, binning also helps to reduce the numerical instabilities that arise from calculating the covariance matrix from observed spectra rather than from theoretical models [60]. In this work, we focus on high-` data and uniformly bin angular power spectra and covariance matrices from `min = 51 to `max = 1490, with a spacing of \u2206` = 20 (Nbins = 72), to match the analysis in Ref. [49]. The likelihood in Eq. (2.5) is often sampled with Markov chain Monte Carlo (MCMC) methods to find the best-fit solution for all parameters, as done in Refs. [13, 42\u201344, 46, 49, 59]. As an extension of the methodology presented in Ref. [60], we propose an alternative iterative implementation to calculate the maximum likelihood solution for A, \u03b2, and \u03b1i semianalytically. In this algorithm, we assume that the A, \u03b2, and \u03b1i parameters in the covariance matrix are known and fixed, starting at xi = (A, \u03b2, \u03b1i) = (1, 0, 0). Then, applying the smallangle approximation (valid for angles . 10\u25e6), the likelihood in Eq. (2.5) is reduced to\n\u22122 lnL \u2283 \u2211 i,j \u2211 b [ CEB,i,ob \u2212 2\u03b1i\u03c7 o iib \u2212AC EB,i,fg b \u2212 2\u03b2\u03c7 \u039bCDM iib ] \u00d7\nC\u22121ijb [ CEB,j,ob \u2212 2\u03b1j\u03c7 o jjb \u2212AC EB,j,fg b \u2212 2\u03b2\u03c7 \u039bCDM jjb ] . (2.9)\nDifferentiating Eq. (2.9) with respect to each of the xi parameters, we obtain a set of linear equations with which to calculate the maximum likelihood solution for all parameters analytically. This first estimate is then used to update the covariance matrix and recalculate a new best-fit solution, starting an iterative process that converges after only a few iterations. By fixing the value of the free parameters in the covariance matrix and iteratively updating them, we are implicitly accounting for the change in the likelihood\u2019s normalization that would otherwise need to be explicitly considered through the inclusion of the ln |Cij`| term in Eqs. (2.5) and (2.9). With this algorithm, we achieve a great reduction of execution time without losing accuracy and precision with respect to the MCMC sampling of the full likelihood. See appendix B for a more detailed comparison of both implementations.\nIn particular, the minimization of Eq. (2.9) leads to a linear system \u2211\nn Amnxn = bm of the form:  \u039e Z Kn . . . Z \u0398 Tn . . .\nKm Tm ... ... \u2126mn   A \u03b2 \u03b1n ...  =  \u03be \u03b8 \u03c9m ...  , (2.10) where the elements of the Amn system matrix are\n\u039e = \u2211 i,j \u2211 b CEB,i,fgb C \u22121 ijbC EB,j,fg b , (2.11)\nZ =2 \u2211 i,j \u2211 b CEB,i,fgb C \u22121 ijb\u03c7 \u039bCDM jjb , (2.12)\n\u0398 =4 \u2211 i,j \u2211 b \u03c7\u039bCDMiib C \u22121 ijb\u03c7 \u039bCDM jjb , (2.13)\n\u2013 7 \u2013\nKm =2 \u2211 j \u2211 b \u03c7ommbC \u22121 mjbC EB,j,fg b , (2.14)\nTm =4 \u2211 j \u2211 b \u03c7ommbC \u22121 mjb\u03c7 \u039bCDM jjb , (2.15)\n\u2126mn =4 \u2211 b \u03c7ommbC \u22121 mnb\u03c7 o nnb, (2.16)\nand bm terms that are\n\u03be = \u2211 i,j \u2211 b CEB,i,fgb C \u22121 ijbC EB,j,o b , (2.17)\n\u03b8 =2 \u2211 i,j \u2211 b CEB,i,ob C \u22121 ijb\u03c7 \u039bCDM jjb , (2.18)\n\u03c9m =2 \u2211 j \u2211 b \u03c7ommbC \u22121 mjbC EB,j,o b . (2.19)\nFinally, this formalism allows us to calculate the uncertainty associated with the maximum likelihood solution within the Fisher matrix approximation. The corresponding covariance matrix is C\u22121mn = \u2212 \u2202 2lnL \u2202xm\u2202xn = Amn.\n3 NPIPE simulations and Galactic masks\nWe use the official NPIPE end-to-end simulations3 of Planck \u2019s HFI 100, 143, 217, and 353GHz bands to test the robustness of our methodology against Galactic foreground emission and instrumental systematics in a realistic scenario. The NPIPE release [48] provides a set of high-fidelity Monte Carlo simulated maps that include CMB, Galactic foregrounds, noise, and systematics. Simulations of detector splits, obtained by dividing the horns in the focal plane into two subsets (A and B) and independently processing them, are also provided.\nThe CMB realizations are the full-focal plane simulations used in PR3 [72]. Galactic foregrounds are simulated by evaluating the Commander sky model derived from the analysis of an early version of NPIPE data at the target frequencies. In particular, synchrotron radiation is modeled with a power-law SED, and thermal dust emission as a one-component modified blackbody. When the angular resolution of the foreground model is higher than that of the target frequency band (e.g., dust at 100GHz), the foreground component is smoothed to match the QuickPol [73] beam specific to the NPIPE dataset. To avoid divergences in the deconvolution, the Gaussian beam with full-width-at-half-maximum (FWHM) of 5 arcmin present in Commander\u2019s dust component is maintained at 217 and 353GHz. Static zodiacal emission is also included by adding the same nuisance templates that Commander marginalized over. Among other instrumental effects, noise maps include beam systematics, gain calibration and bandpass mismatches, analogue-to-digital conversion non-linearities, and the transferfunction corrections. Noise maps also capture the non-linear response of the instrument and of the NPIPE processing pipeline, reproducing the non-linear couplings between signal and noise that they introduce. Please refer to Ref. [48] for a more detailed description of the systematic effects included in NPIPE simulations.\n3The foreground sky model and the simulations used in this paper (individual input components as well as coadded maps) are available at NERSC under /global/cfs/cdirs/cmb/data/planck2020/all_data.\n\u2013 8 \u2013\nFor the analysis presented in section 4, we build a first simulation set (FG\u03b1 + CMB\u03b1+\u03b2\n+N) by coadding foreground maps with 100 different CMB realizations and their associated noise maps. Before addition, foreground and CMB maps are rotated by \u03b1i and \u03b1i +\u03b2 angles, respectively. For each realization, birefringence and polarization angles are randomly drawn from a uniform distribution in the range [\u22121\u25e6, 1\u25e6]. To mimic the analysis in Ref. [49], we simulate A/B detector splits with a different miscalibration angle per split, i.e., \u03b1i with i =100A, 100B, ..., 353B. In other words, we treat A/B detector splits as if they were observations from different frequency bands. To assess the impact of instrumental systematics different from a miscalibration of polarization angles, we build a second simulation set (CMB + N) by coadding the same 100 CMB realizations and their associated noise maps. In this case we do not rotate the maps, since we want to use them to test whether some of the systematic effects in the NPIPE data lead to any systematic \u03b2 or \u03b1i angles. This second simulation set is also generated for A/B detector splits. We adopt three of the masks used in the analysis of Planck HFI data presented in Ref. [49] (see figure 1). The default mask is built by masking point sources and the regions where the emission of the carbon monoxide (CO) line is the brightest. The common point-source mask is constructed from the combination of the Planck point source-polarization masks4 at 100, 143, 217, and 353GHz. Pixels where the CO line is brighter than 45 KRJkms\u22121 are also masked because, although CO is not polarized, the mismatch of detector bandpasses creates a spurious polarization signal via intensity-to-polarization leakage. While CO strength varies over frequency, a common CO mask is adopted for all channels to simplify the analysis. This base CO+PS mask is then extended to exclude 10% and 30% of the regions of brightest Galactic foreground emission by thresholding the NPIPE 353GHz polarization and total intensity maps smoothed with a Gaussian beam with a FWHM of 10\u25e6. Finally, all masks are apodized with a 1\u25e6 FWHM Gaussian. The effective sky fraction to use in the calculation of the covariance matrix is given by fsky = N\u22121pix( \u2211 i \u03c9 2 i ) 2/( \u2211 i \u03c9 4 i ) [74, 75], where \u03c9i is the value of the (non-integer) apodized mask, and Npix is the total number of pixels. This yields fsky =0.93, 0.85, and 0.63 for the CO+PS, CO+PS+10%, and CO+PS+30% masks, respectively. In our analysis of masked skies, we calculate full-sky pseudo-C`s using NaMaster5 [76] and without performing any E/B mode purification6. For the CO+PS+30% mask, we bin the pseudo-C` calculated with NaMaster to reduce the `-to-`\u2032 correlations induced by the partial sky coverage, so than we can still approximate the covariance matrix as diagonal.\n4HFI_Mask_PointSrc_2048_R2.00.fits file at https://pla.esac.esa.int/#maps. 5https://github.com/LSSTDESC/NaMaster 6We do not perform E/B mode purification because the E-to-B leakage produced by our masks of fsky &\n60% is negligible at the angular scales ` > 50 used in our analysis.\n\u2013 9 \u2013"
        },
        {
            "heading": "4 Impact of Galactic foregrounds",
            "text": "To determine the impact of Galactic foregrounds on the measurement of cosmic birefringence, we apply our frequency cross-spectra-only estimator (see appendix A) to the 100 FG\u03b1 + CMB\u03b1+\u03b2 + N simulations and calculate the difference between the true input angles and the estimated ones. Figures 2 and 3 show the typical bias in angle estimation, where data points correspond to the mean value and uncertainties are calculated as the simulations\u2019 dispersion (one standard deviation).\nAs in previous works [42\u201344, 46], we start by neglecting the foreground EB contribution in figure 2. Those results demonstrate that \u03b2 and \u03b1i measurements are biased when both angles are estimated simultaneously and the foreground EB is not acknowledged. In contrast, figure 3 shows the typical bias that we obtain from FG\u03b1 + CMB\u03b1+\u03b2 + N simulations with \u03b2 = 0 when estimating miscalibration angles alone, for the case in which the foreground EB is ignored (A = 0) or modeled by providing a template for foreground emission (free A). The good agreement between the results obtained in both cases demonstrates that assuming a null foreground EB correlation does not introduce any significant bias to the measurement of exclusively miscalibration angles. This was also shown by Ref. [60] in the context of the LiteBIRD satellite. The only exceptions are the systematic \u03b1i angles found for the 100A and 100B detector splits. As discussed in the next section, those systematic angles do not reflect a bias of our methodology but rather reveal the presence of a cross-polarization effect in NPIPE simulations. To clarify the reason behind their different response to foreground EB, figure 4 shows the signal-to-noise ratio per bin obtained for the different rotation angles with estimators that measure exclusively miscalibration angles (left), or both birefringence and miscalibration angles simultaneously (right). The signal-to-noise ratio associated with each xm variable is calculated as S/Nb(xm) = xm/( \u2211 b\u2032\u2208wb Cmmb\u2032) 1/2, where wb is a square window function of\n\u2013 10 \u2013\n\u2206b = 10 centered around each bin, and the covariance is the Cmn = A\u22121mn matrix defined in appendix A. The bin-dependence (and, by extension, `-dependence) in Cmnb comes from removing the summation in b from Eqs. (A.8) to (A.16). The main difference between both estimators is that, when focused exclusively on the determination of miscalibration angles (left panel of figure 4), information can be gathered from all scales, since both Galactic foregrounds and the CMB are rotated by \u03b1. In this sense, providing a template of foreground emission increases the S/N at ` . 300 scales, but dismissing the contribution of the foreground EB correlation does not lead to a significant bias.\nOn the other hand, when trying to simultaneously determine both birefringence and miscalibration angles, we rely on foregrounds to determine \u03b1i and partially break the degeneracy between both effects. Thus, a precise knowledge of foreground emission is crucial, especially at the ` . 300 foreground-dominated scales. In the right panel of figure 4, we see that when no foreground template is provided, the S/N ratio of \u03b2 (purple solid line) shows the same angular dependence at large-scales as that of miscalibration angles (rest of colored solid lines), indicating that \u03b2 is being derived from foregrounds as well as the CMB. As a consequence, the unaccounted foreground EB produces the bias seen in the left panel of figure 5 (blue contours), where we show the correlation between the \u03b2 and \u03b1353B7 angles recovered when only ` < 300 scales are used. After a template for the foreground EB is provided, we see that such a bias is reduced (orange contours), and that now the angular dependence of the S/N ratios of \u03b2 and \u03b1i angles (dotted colored lines) correctly resemble those of, respectively, the CMB and Galactic foreground signals in the right panel of figure 4. In addition, the extra knowledge on foreground emission provided by the template helps to break the degeneracy between \u03b2 and \u03b1i angles, relaxing the anti-correlation between them from \u03c1 \u2248 \u22120.9 to \u03c1 \u2248 \u22120.40.\nAt small angular scales (` & 300), the CMB starts to dominate over the foreground emission and becomes the common source of S/N for both \u03b2 and \u03b1i. At those scales, there is\n7Here we chose \u03b1353B as an example of a foreground-dominated band, but similar correlations are found across the rest of the detector splits.\n\u2013 11 \u2013\nnot enough foreground signal to break the degeneracy between both angles, but the inclusion of the template still helps to avoid the bias induced by the foreground EB correlation (central panel of figure 5). Once all scales are included in the analysis (right panel of figure 5), the extra constraining power that the template grants at large-scales helps to alleviate the degeneracy between both angles (from \u03c1 \u2248 \u22120.90 to \u03c1 \u2248 \u22120.70) and correct the bias induced by the foreground EB correlation, bringing the best-fit value closer to the correct answer. In this way, ignoring the foreground EB correlation when simultaneously estimating \u03b2 and \u03b1i angles leads to the biases seen in figure 2.\nWe also check the correct performance of the estimator by comparing the uncertainty obtained from the simulations\u2019 dispersion with that of the Fisher prediction. That is what we do in figure 6, where data points show the uncertainty calculated as the simulations\u2019 dispersion (\u03c3sim) and solid lines correspond to the Fisher matrix prediction (\u03c3Fisher). We expect the Fisher formalism to overestimate \u03c3sim uncertainties as seen for the CO+PS (red) and CO+PS+10%\n\u2013 12 \u2013\n(blue) masks, since foreground emission is a source of cosmic variance in our covariance matrix but we have used a common foreground realization for all of the FG\u03b1 + CMB\u03b1+\u03b2 + N simulations. When the majority of Galactic emission is removed from the covariance with the CO+PS+30% mask (green), \u03c3sim and \u03c3Fisher uncertainties do agree. Both the biases in the estimation of \u03b2 and \u03b1i angles and the inconsistencies between simulations- and Fisher-derived uncertainties are corrected when an accurate template for foreground emission is provided and A is left as a free amplitude parameter in the likelihood. Figure 7 shows that now the mean values of the recovered \u03b2 and \u03b1i are centered around zero, with the exception of the aforementioned \u03b1100A and \u03b1100B systematic angles. Moreover, as is discussed in appendix D, providing a template for foreground emission allows for the removal of most of the variance originated by the foregrounds\u2019 fluctuations. The effects of removing the contribution of foreground emission from the covariance are twofold. First, it leads to a reduction of the total covariance that explains the smaller uncertainties seen in figure 8 with respect to those in figure 6. And second, it ensures that the uncertainties estimated from the simulations\u2019 dispersion and the Fisher analysis are compatible with each other for all of the three Galactic masks. This last observation does not just apply to our simulations with a fixed foregrounds realization. It is a feature transferable to the analysis of real data. If we believe that our template is a measurement of the true foreground signal in the sky, then its cosmic variance should not contribute to the total uncertainty. Within this interpretation, the emission of our Galaxy is explicitly characterized at the map level through the template, while the CMB signal is only statistically characterized by the theoretical angular power spectra provided.\nThe amplitude of the foreground template is also correctly recovered, with uncertainties from Fisher analysis and the simulations\u2019 dispersion nicely matching, as can be seen in figure 9. In our case, the recovered amplitudes are centered around unity because the foreground template is the same as the fiducial foreground model used in the simulations. We checked that the choice of initial value for A does not condition the final results. Here we started from A = 1, but the algorithm quickly converges to compatible results after a couple more iterations when starting from A \u2208 {\u22121, 0}. These results show that, with the exception of\n\u2013 13 \u2013\nthe systematic \u03b1100A and \u03b1100B angles, our methodology provides an unbiased estimation of both birefringence and polarization angles, once the foreground EB is taken into account.\nFinally, we can use the insight gained from this study of realistic simulations to interpret the results obtained from the analysis of Planck HFI data made in Ref. [49]. For that purpose, figure 10 reproduces some of the results of that publication, including the birefringence measurement obtained from Planck data without accounting for the EB correlation of Galactic dust (orange circles), and those obtained when correcting for dust EB using either the Commander sky model (purple triangles) or the filament model presented in Refs. [13, 49] (black triangles). Uncertainties are calculated within the Fisher approximation. The results for the CO+PS+30% mask (fsky = 0.63) differ8 from those reported in Ref. [49], since now we have binned the pseudo-C`s calculated for this mask to further reduce `-to-`\u2032 correlations and have a more diagonal covariance matrix.\nWhen dust EB is ignored, the decreasing values of \u03b2 found as we enlarge the Galactic mask seem to qualitatively agree with the biases expected from figure 2. Having statistically characterized the bias produced by dust EB, we can de-bias those measurements by adding to them the mean bias calculated from the FG\u03b1 + CMB\u03b1+\u03b2 +N simulations. This leads to the shaded orange squares, which are centered at the de-biased measurements and contain all values compatible with them at 1\u03c3. De-biased values are compatible with the results obtained with both the filament and Commander models for fsky < 0.90. The disagreement seen at higher fsky suggests that the Commander template might be struggling to reproduce dust emission near the center of the Galactic plane where the single modified blackbody model may be too simplistic [68, 70, 71, 77, 78].\nWe also find that the reduction of uncertainties that we achieve by including the foreground template in the analysis of Planck data is larger than expected from the simulation study. To illustrate this discrepancy, the gray error bars around the birefringence measurements obtained with the Commander template in figure 10 show the uncertainty expected from the reduction seen in the simulation study, while the purple error bars show the actual uncertainty obtained in the fit to Planck data. In particular, uncertainties are underestimated by approximately a 18%, 23%, and 28% at fsky =0.93, 0.85, and 0.63, respectively. The\n8The differences in the \u03b2 angle measured with and without binning are of the order of \u2206\u03b2 \u2248 0.3\u03c3 when dust EB is ignored or corrected with the filament model, and of \u2206\u03b2 \u2248 0.6\u03c3 when corrected with the Commander sky model.\n\u2013 14 \u2013\nfact that uncertainties are smaller in the analysis of the data than in the analysis of simulations where Commander is the fiducial foreground model suggests that the template might reproduce not only foreground emission but also some of the statistical fluctuations and noise from Planck data. In this way, the limited signal-to-noise of the Commander template leads to the over-reduction of the covariance matrix and the subsequent underestimation of error bars. Future experiments such as LiteBIRD [39] will provide high-precision measurements of the CMB polarization that will allow us to derive a signal-dominated dust template on the full-sky."
        },
        {
            "heading": "5 Impact of instrumental systematics",
            "text": "The miscalibration of polarization angles is not the only instrumental effect that interferes with the measurement of cosmic birefringence. Systematic effects like intensity-to-polarization leakage, beam leakage, or cross-polarization effects also produce spurious EB correlations that can bias our analysis. Since the effect of miscalibration angles and Galactic foregrounds was already determined in the previous section, here we use CMB + N simulations to focus on the impact of the rest of systematics. By construction, CMB + N simulations reproduce the non-linear response of the instrument and the NPIPE processing pipeline, including the systematics produced by the non-linear couplings between signal and noise [48]. Therefore, CMB + N simulations retain the systematics associated with foregrounds (e.g., the intensity-to-polarization leakage induced by the CO bandpass mismatch), despite discarding foreground emission itself. However, without foregrounds, we are no longer able to break the degeneracy between birefringence and miscalibration angles. Hence, instead of fitting them simultaneously, we must fit for \u03b2 and \u03b1i independently: we can fit a different angle for each detector split (see Ref. [60]), knowing that these effective \u03b1i yield \u03b1i + \u03b2; or we can fit the same angle for all frequency bands\n\u2013 15 \u2013\n(see Eq. (1.3)), obtaining an effective birefringence angle \u03b2 + \u03b1\u0304 that includes the weighted average of miscalibration angles across all detector splits. Since CMB + N simulations do not contain birefringence or miscalibration angles, we know that any effective \u03b1i found in them are produced by the rest of the systematic effects included in the simulations, with \u03b1\u0304 being the net effect of those systematics in the measurement of birefringence. We refer to these angles as \u03b1sysi and \u03b1\u0304sys. Fitting \u03b1sysi and \u03b1\u0304sys angles to the 100 CMB + N simulations with our frequency crossspectra-only estimator, we obtain the mean angles shown in figure 11. Their corresponding uncertainties, calculated both as the simulations\u2019 dispersion and within the Fisher approximation, are shown in figure 12. At a first glance, uncertainties now rapidly increase at 353GHz, a behaviour that differs from the one seen in figure 8. Such difference is explained by the absence of foregrounds in CMB + N simulations. Without foregrounds, rotation angles are estimated from the CMB, with instrumental noise as the only impediment. In this scenario, the larger uncertainties at 353GHz just reflect the configuration of Planck -HFI. 100, 143, and 217GHz frequency bands have similar noise levels around 1.5\u00b5K\u00b7deg, while the 353GHz band has 7.3\u00b5K\u00b7deg [79]. Accordingly, the uncertainties recovered for 353B are approximately 6 times higher than those at, e.g., 143B, matching the roughly 6 times higher nominal noise level at 353GHz. In addition, masking the Galactic plane does not have such a dramatic effect as in figure 8, because here we are fitting effective \u03b1i + \u03b2 angles instead of using foregrounds to break the degeneracy between \u03b1i and \u03b2. Still, uncertainties do scale as, roughly, f \u22121/2 sky . More quantitatively, we find that NPIPE systematics produce angles \u3008\u03b1sys100A\u3009 = 0.188\u25e6 \u00b1 0.009\u25e6 and \u3008\u03b1sys100B\u3009 = \u22120.305\u25e6 \u00b1 0.007\u25e6, with uncertainties given as the error of the mean. Although the values of \u03b1sysi are determined to high precision using CMB + N simulations, we would only be able to detect them at a 1.9-3.8\u03c3 confidence level when simultaneously fitting \u03b2 and \u03b1i to real data (compare with the uncertainties on figure 8), and that is assuming that Planck \u2019s polarimeters were perfectly calibrated. At other frequencies, \u3008\u03b1sys143A\u3009 = 0.047\u25e6 \u00b1 0.006\u25e6, \u3008\u03b1sys143B\u3009 = 0.039\u25e6 \u00b1 0.005\u25e6, and \u3008\u03b1 sys 217A\u3009 = \u22120.063\u25e6 \u00b1 0.008\u25e6 angles are also found at a lower significance level (0.6-1.3\u03c3 compared to uncertainties on figure 8). These angles, produced by systematics, explain the biases seen in figures 2, 3, and 7. Note the change of sign, since those figures approximately show \u2212\u3008\u03b1sysi \u3009.\nTo understand the origin of the \u03b1sysi angles seen in figure 11, we performed a closer\n\u2013 16 \u2013\nstudy of the angular power spectra of CMB + N simulations. In particular, we investigate the origin of the \u03b1sys100A and \u03b1 sys 100B angles in figure 13, and that of the \u03b1 sys 143A, \u03b1 sys 143B, and \u03b1 sys 217A angles in figure 14. For completeness, in figure 15 we also show the angular power spectra of frequency bands where no significant \u03b1sysi is found. Black solid lines in figures 13, 14, and\n\u2013 17 \u2013\n15 show the mean CEB` angular power spectra for a selection of bands, averaged over the 100 simulations, and binned in uniform bins from `min = 51 to `max = 1490 with a spacing of \u2206` = 20. We find no significant difference between mean CMB+N spectra calculated with the CO+PS, CO+PS+10%, or CO+PS+30% masks. Thus, we only display the spectra obtained with the CO+PS mask. As demonstrated in figures 13 and 14, even in the absence of an \u03b1i miscalibration, CMB+N simulations present a spurious EB correlation between multipoles 200 and 1000 (corresponding roughly to angular scales between 50 and 10 arcmin). These features are more prominent at the lower frequencies, with cross-correlations involving 353GHz showing a mostly uncorrelated EB cross-spectra (see figure 15).\nThose spurious EB correlations could be produced by several systematic effects. In general, intensity-to-polarization leakage gives CEB` \u221d CTT` at leading order, whereas the cross-polarization effect gives CEB` \u221d CEE` . A combination of the two would give CEB` \u221d CTE` . Beam imperfections and mismatches between each detector\u2019s optical and electronic responses also lead to a leakage of signal into EB. For these simulations that contain only CMB and noise, we calculate the effect that beam leakage has on EB:\nCEB,BL` = \u03c9 2 pix,` \u2211 XY WEB,XY` C XY,\u039bCDM ` , (5.1)\nwhere XY \u2208 {TT,EE,BB, TE}, \u03c9pix,` is the pixel window function, and WEB,XY` are the beam-window matrices calculated with QuickPol [73] specifically for Planck beams. To identify which of these effects is most likely to have caused the spurious EB correlations seen in\n\u2013 18 \u2013\nfigures 13 and 14, we fit the mean CMB+N angular power spectra with the set of models\nMb \u2208 {ATTCTT,\u039bCDMb , (5.2)\nAEEC EE,\u039bCDM b , (5.3) ATEC TE,\u039bCDM b , (5.4) ABLC EB,BL b , (5.5) ATTC TT,\u039bCDM b +AEEC EE,\u039bCDM b +ATEC TE,\u039bCDM b +ABLC EB,BL b } (5.6)\nby minimizing a simple \u03c72 function:\n\u03c72ij,M = \u2211 b (\u2329 C EiBj b \u232a \u2212Mb )2 /V ijb . (5.7)\nThe mean angular power spectra in Eq. (5.7) are calculated as\u2329 CXYb \u232a = 1\n\u2206` \u2211 `\u2208b \u2329 CXY` \u232a sim , (5.8)\nwith variance\nV ijb = 1\nfskyNsim\u2206`2 \u2211 `\u2208b 1 2`+ 1 [\u2329 CEiEi` \u232a sim \u2329 C BjBj ` \u232a sim + \u2329 C EiBj ` \u232a2 sim ] . (5.9)\n\u2013 19 \u2013\nNote the N\u22121sim factor in Eq. (5.9), since \u03c7 2 ij,M describes a fit to the mean EB angular power spectra and thus V ijb is the variance of the mean. In figures 13 and 14, dashed colored lines show the best fit for each model, with the goodness of fit quantified by the reduced \u03c72 included on the bottom-left corner of each plot. To get an intuition of the relative importance of each systematic, we also show on the top-left corner of each plot the values of the ATT, AEE, ATE, and ABL amplitudes obtained from the fit to Eq. (5.6). For completeness, the green shaded regions in figures 13, 14, and 15 show the 1\u03c3 confidence contours of the EB correlation expected from the \u03b1sysi angles found in figure 11. For every combination of ij bands, these contours are generated by plotting the C EiBj ` = (s(4\u03b1 sys j )C EiEj ,o ` \u2212 s(4\u03b1 sys i )C BiBj ,o ` )/(c(4\u03b1 sys i ) + c(4\u03b1 sys j )) spectra produced by the angles found in CMB + N simulations that fall within the 1\u03c3 confidence ellipse of the correlation between each \u03b1sysi \u03b1 sys j pair. The fits in figure 13 suggest the presence of a cross-polarization effect leaking E modes into B modes at 100GHz. This kind of systematic is particularly dangerous since our estimator relies on finding a signal resembling CEE,\u039bCDM` in the observed EB correlation to determine both birefringence and miscalibration angles. Moreover, the fit to AEEC EE,\u039bCDM b falls perfectly within the 1\u03c3 confidence contours from \u03b1sysi angles, confirming that such a cross-polarization effect is indeed the cause of the \u03b1sys100A and \u03b1 sys 100B angles found in the simulations. Although the spread in \u03c72/Ndof from the fits in figure 14 is smaller than that from figure 13, the fits suggest that beam leakage is the main contribution to the spurious EB correlation seen at those frequencies. Beam leakage has an angular dependence that our estimator cannot reproduce, since it only considers rotations of the observed EE and BB angular power spectra. Nevertheless, the approximate match between the green confidence contours and the mean EB spectra of CMB+N simulations in figure 14 shows how the estimator is trying to accommodate CEB,BL` as a rotation of C EE,\u039bCDM ` . This limited ability to reproduce the signal from beam leakage leads to the \u03b1sys143A, \u03b1 sys 143B, and \u03b1 sys 217A angles found in the simulations at a lower significance level. Finding the presence of these cross-polarization and beam leakage effects is important for understanding all the systematics at play in both simulations and, presumably, the real Planck data. Nevertheless, note that the \u03b1sysi angles found in CMB+N simulations do not need to agree with the ones found in the data because these simulations do not include the actual (unknown) miscalibration angles present in the data. The \u03b1sysi found here would only match the angles found in the data if the orientation of Planck \u2019s polarimeters was perfectly calibrated. In this way, the main conclusion to draw from these results is that, even in the presence of such systematics, our methodology is able to correctly capture their effect within the \u03b1i parameters, leaving the measurement of \u03b2 not significantly affected by any of them. The \u3008\u03b1\u0304sys\u3009 = \u22120.009\u25e6 \u00b1 0.003\u25e6 angle that we find falls well below the corresponding 0.06\u25e6 uncertainty that we have on \u03b2 when simultaneously fitting \u03b2 and \u03b1i (see figure 8). This observation justifies the decision not to correct the \u03b2 measurement in Ref. [49] for any of the known systematics."
        },
        {
            "heading": "6 Impact of noise bias",
            "text": "Although cosmic variance limited for the temperature power spectrum, Planck \u2019s polarization noise levels are still relatively high [79]. As seen in figure 16, the noise bias in the frequency auto-spectra (e.g., 100\u00d7100 full-mission) is high enough to obscure most of the CMB and\n\u2013 20 \u2013\nforeground EE signal. Such noise-dominated EE can potentially bias \u03b2 and \u03b1i measurements, since our estimator heavily relies on observed angular power spectra to fit rotation angles and build the covariance matrix. To avoid those biases, frequency auto-spectra were excluded from the analysis of Ref. [49]. Here we quantify the impact of instrumental noise by applying estimators that use information coming from all spectra, only auto-spectra, or only crossspectra, to FG\u03b1 + CMB\u03b1+\u03b2 + N simulations.\nFigure 17 shows that measurements derived from auto-spectra-only estimators (light pink and green triangles) lead to higher biases, especially when large Galactic masks are applied. Nevertheless, the higher biases are accompanied by the corresponding increase in the uncertainty, ensuring that the estimates remain compatible with zero within the error bars. When interpreting these results, remember that we expect to recover approximately \u22120.2\u25e6 and 0.3\u25e6 values for \u03b1100A and \u03b1100B, respectively, because of the systematic effects explained in section 5.\nInstrumental noise can be mitigated by cross-correlating different observations of the same signal. Planck \u2019s NPIPE [48] data release makes this possible by providing A/B detector splits of their frequency maps, which were built from independent subsets of antennas observing at the same frequency. Using cross-spectra, we are able to avoid the noise bias and recover a signal-dominated observed EE spectrum (100A\u00d7100B on figure 16) that improves the estimation of both birefringence and polarization angles. In addition, statistical uncertainties are reduced since the likelihood has N\u03bd times (N\u03bd \u2212 1 times) more information when all spectra (only cross-spectra) are used [44]. As seen in figure 17, the effect of noise is diluted once cross-spectra are included. To further avoid noise bias, we can exclude auto-spectra from the cross-spectra estimator. With respect to the estimator that includes all correlations (dark red and green stars), this cross-spectra-only estimator (red and green circles) reduces\n\u2013 21 \u2013\nthe mean value obtained with the CO+PS mask by 30%, and that of the CO+PS+30% mask by 60%, while keeping uncertainties compatible within a 5% level. The superior performance of cross-spectra estimators in noise-dominated experiments like Planck was already anticipated in Ref. [60]. Nevertheless, the improvement in polarization noise levels planned for the next generation of CMB experiments will allow for a signaldominated measurement of E modes without resorting to cross-correlations. Reference [60] showed that, for an experiment such as LiteBIRD [39], auto-spectra-only estimators were more suited for the estimation of miscalibrated polarization angles because of their simpler covariance matrices. We leave the study of the methodology performance in the signaldominated regime and its application to LiteBIRD for a future work."
        },
        {
            "heading": "7 Conclusions",
            "text": "In this work, we have used realistic simulations of Planck data to test the impact that Galactic foreground emission and instrumental systematics have on recent birefringence measurements [13, 46, 49, 59]. To reduce the computational cost of such an extensive simulation study, we have developed a semi-analytical iterative algorithm that simultaneously calculates birefringence and miscalibrated polarization angles within the small-angle approximation. Our simulation study supports the results presented in Ref. [49], confirming and highlighting the importance of accounting for dust EB when simultaneously estimating birefringence and miscalibration angles. It also proves that our methodology is robust, not only against the miscalibration of polarization angles, but also against other systematics like intensity-topolarization leakage, beam leakage, or cross-polarization effects. We have demonstrated that a model for Galactic foreground emission is needed to calibrate polarization angles and measure cosmic birefringence at the same time. Thus, having a precise characterization of Galactic foregrounds is the most critical aspect of the analysis. For both the simulation study performed here and the application to Planck -HFI data presented in Ref. [49], we adopted the Commander sky model as our foreground model. Although Commander offers one of the best descriptions of thermal dust emission currently available, it still has its limitations. In particular, Commander does not yet provide a signal-dominated template for the foreground EB and it might contain spurious EB correlations through not contemplating the existence of miscalibration angles and the integration of different dust clouds along the line-of-sight in its SED. Our results also lead us to believe that Commander might struggle to reproduce dust emission near the center of the Galactic plane. The comparison of simulations and data tells us that the limited signal-to-noise of the template leads to a \u2248 20% underestimation of the uncertainty of the birefringence angle reported in [49]. However, as they are themselves based on the Commander sky model, our simulations do not allow us to quantitatively asses the impact that polarized mixing and miscalibration angles have on the foreground model. Therefore, we leave such a study for a future work. To overcome these obstacles, a self-consistent end-to-end study encompassing componentseparation to birefringence estimation is needed. As demonstrated in Ref. [60] using the B-SeCRET method [80], it should be possible to derive a new template of polarized foreground emission free of any spurious EB correlation by adding miscalibration angles to the synchrotron and thermal dust SEDs fitted in Bayesian component-separation analyses. Such a self-consistent study would allow us to correctly propagate uncertainties through the whole pipeline and check the consistency of the birefringence and miscalibration angles obtained at all stages: from frequency maps, to component-separation, and the final clean CMB\n\u2013 22 \u2013\nmaps. A better characterization of dust emission beyond the single modified blackbody paradigm [68, 71, 78] and high-precision measurements of the CMB polarization from which to derive a signal-dominated template on the full-sky are also required. We believe that such an analysis will allow for an unbiased and reliable measurement of cosmic birefringence in the future.\nFinally, here we have limited ourselves to the study of the high-frequency bands of the Planck satellite, where thermal dust emission is the main foreground component. Nevertheless, lower frequency bands could be added to the analysis by including an additional template to describe synchrotron radiation. We will explore that extension of the methodology, and its application to the forecasting of LiteBIRD\u2019s capabilities and to the analysis of Planck and WMAP [59] data in future works."
        },
        {
            "heading": "Acknowledgments",
            "text": "This research used resources of the National Energy Research Scientific Computing Center (NERSC), a U.S. Department of Energy Office of Science User Facility operated under Contract No. DE-AC02-05CH11231. Part of the research was carried out at the Jet Propulsion Laboratory, California Institute of Technology, under a contract with the National Aeronautics and Space Administration (80NM0018D0004). PDP acknowledges financial support from the Formaci\u00f3n del Profesorado Universitario program of the Spanish Ministerio de Ciencia, Innovaci\u00f3n y Universidades. EdlH acknowledges financial support from the Concepci\u00f3n Arenal program of the Universidad de Cantabria. PDP, EMG, PV, BB, and EdlH thank the Spanish Agencia Estatal de Investigaci\u00f3n (AEI, MICIU) for the financial support provided under the projects with references PID2019-110610RB-C21, ESP2017-83921-C2-1-R, and AYA2017-90675-REDC, co-funded with EU FEDER funds, and acknowledge support from Universidad de Cantabria and Consejer\u00eda de Universidades, Igualdad, Cultura y Deporte del Gobierno de Cantabria via the Instrumentaci\u00f3n y ciencia de datos para sondear la naturaleza del universo project, as well as from Unidad de Excelencia Mar\u00eda de Maeztu (MDM-2017-0765). JRE acknowledges funding from the European Research Council (ERC) under the Horizon 2020 Research and Innovation Program (Grant agreement No. 819478). The work of YM was supported in part by the Japan Society for the Promotion of Science (JSPS) KAKENHI, Grants No. JP20K14497. RS and DS acknowledge the support of the Natural Sciences and Engineering Research Council of Canada. The work of EK was supported in part by JSPS KAKENHI Grant No. JP20H05850 and JP20H05859, and the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany\u2019s Excellence Strategy - EXC-2094 - 390783311. The Kavli IPMU is supported by World Premier International Research Center Initiative (WPI), MEXT, Japan. We acknowledge the use of CAMB [81], HEALPix [82], NaMaster [76], emcee [83], corner [84], Matplotlib [85], and Numpy [86]."
        },
        {
            "heading": "A Cross-spectra estimator",
            "text": "Starting from Eq. (2.2), we build a maximum likelihood estimator that uses the information from all the frequency cross-spectra to simultaneously calculate \u03b2 and \u03b1i. In its more general\n\u2013 23 \u2013\nform, the observed EB correlation across different frequency bands is now the rotation of\nC EiBj ,o ` =\n1\nc(4\u03b1i) + c(4\u03b1j)\n( s(4\u03b1j)C EiEj ,o ` \u2212 s(4\u03b1i)C BiBj ,o ` + 2c(2\u03b1i)c(2\u03b1j)AC EiBj ,fg `\n+2s(2\u03b1i)s(2\u03b1j)AC BiEj ,fg `\n) +\ns(4\u03b2)\n2c(2\u03b1i + 2\u03b1j)\n( C EiEj ,\u039bCDM ` \u2212 C BiBj ,\u039bCDM ` ) . (A.1)\nAnalogously to what was done in section 2, we build a Gaussian likelihood from Eq. (A.1) that, within the small-angle approximation, reads\n\u22122 lnL \u2283 \u2211 i,j,p,q \u2211 ` [ C EiBj ,o ` \u2212 2\u03b1jC EiEj ,o ` + 2\u03b1iC BiBj ,o ` \u2212AC EiBj ,fg ` \u2212 2\u03b2\u03c7 \u039bCDM ij` ] \u00d7\nC\u22121ijpq` [ C EpBq ,o ` \u2212 2\u03b1qC EpEq ,o ` + 2\u03b1pC BpBq ,o ` \u2212AC EpBq ,fg ` \u2212 2\u03b2\u03c7 \u039bCDM pq` ] . (A.2)\nIn this case, the Cijpq` covariance matrix has N2\u03bdN`\u00d7N2\u03bdN` elements. Under the approximation in Eq. (2.7), the Cijpq` covariance matrix in Eq. (A.2) can be divided into terms that depend only on the observed, foreground, and CMB spectra, and on their cross-correlations:\nCijpq` = 1\n(2`+ 1)fsky\n[ Coijpq` + C CMB ijpq` + C fg ijpq` + C CMB\u2217o ijpq` + C fg\u2217o ijpq` ] . (A.3)\nExpanding CXCMBY o` angular power spectra like C XCMBY o ` = 1 2`+1 \u2211` m=\u2212`X CMB `m Y o `m \u2217,\nand acknowledging that the spherical harmonic coefficients of the observed signal are a rotation of the CMB and foreground ones as shown in Eq. (2.1), the contribution of all CMBrelated terms is reduced to\nCCMBijpq` + C CMB\u2217o ijpq` = \u2212\ns2(4\u03b2)bi`b j `b p `b q `\u03c9 4 pix,`\n2c(2\u03b1i + 2\u03b1j)c(2\u03b1p + 2\u03b1q)\n[( CEE,\u039bCDM` )2 + ( CBB,\u039bCDM` )2] , (A.4)\nwhere CEE,\u039bCDM` and C BB,\u039bCDM ` are the theoretical angular power spectra predicted by \u039bCDM, and the combination of ij frequency bands is specified through the different beam and pixel window functions, bi` and \u03c9pix,`, respectively.\nThe terms depending on the observed and foreground spectra are calculated as follows:\nCoijpq` = C Eoi E o p ` C BojB o q ` + C Eoi B o q ` C BojE o p `\n+ s(4\u03b1p)\nc(4\u03b1p) + c(4\u03b1q)\n( C Eoi B o p\n` C BojB o q ` + C Eoi B o q ` C BojB o p ` ) \u2212 s(4\u03b1q)\nc(4\u03b1p) + c(4\u03b1q)\n( C Eoi E o p\n` C BojE o q ` + C Eoi E o q ` C BojE o p ` ) + s(4\u03b1i)\nc(4\u03b1i) + c(4\u03b1j)\n( C Boi E o p\n` C BojB o q ` + C BoiB o q ` C BojE o p ` ) \u2212 s(4\u03b1j)\nc(4\u03b1i) + c(4\u03b1j)\n( C Eoi E o p\n` C EojB o q ` + C Eoi B o q ` C EojE o p ` ) + s(4\u03b1j)s(4\u03b1q)\n[c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C Eoi E o p\n` C EojE o q ` + C Eoi E o q ` C EojE o p ` ) + s(4\u03b1i)s(4\u03b1p)\n[c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C BoiB o p\n` C BojB o q ` + C BoiB o q ` C BojB o p `\n)\n\u2013 24 \u2013\n\u2212 s(4\u03b1j)s(4\u03b1p)\n[c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C Eoi B o p\n` C EojB o q ` + C Eoi B o q ` C EojB o p ` ) \u2212 s(4\u03b1i)s(4\u03b1q)\n[c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C Boi E o p\n` C BojE o q ` + C Boi E o q ` C BojE o p `\n) (A.5)\nand\nCfgijpq` = 4A2\n[c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)] [ c(2\u03b1i)c(2\u03b1j)c(2\u03b1p)c(2\u03b1q) ( C Efgi E fg p ` C Bfgj B fg q ` + C Efgi B fg q ` C Bfgj E fg p `\n) + c(2\u03b1i)c(2\u03b1j)s(2\u03b1p)s(2\u03b1q) ( C Efgi B fg p ` C Bfgj E fg q ` + C Efgi E fg q ` C Bfgj B fg p `\n) + s(2\u03b1i)s(2\u03b1j)c(2\u03b1p)c(2\u03b1q) ( C Bfgi E fg p ` C Efgj B fg q ` + C Bfgi B fg q ` C Efgj E fg p `\n) + s(2\u03b1i)s(2\u03b1j)s(2\u03b1p)s(2\u03b1q) ( C Bfgi B fg p ` C Efgj E fg q ` + C Bfgi E fg q ` C Efgj B fg p ` )] . (A.6)\nFinally, the cross-correlation between the observed and foreground signals is given as\nCfg\u2217oijpq` =\u2212 2Ac(2\u03b1i)c(2\u03b1j) c(4\u03b1i) + c(4\u03b1j)\n( C Efgi E o p ` C Bfgj B o q ` + C Efgi B o q ` C Bfgj E o p ` ) \u2212\n2Ac(2\u03b1p)c(2\u03b1q) c(4\u03b1p) + c(4\u03b1q)\n( C Eoi E fg p\n` C BojB fg q ` + C Eoi B fg q ` C BojE fg p ` ) \u2212\n2As(2\u03b1i)s(2\u03b1j) c(4\u03b1i) + c(4\u03b1j)\n( C Bfgi E o p ` C Efgj B o q ` + C Bfgi B o q ` C Efgj E o p ` ) \u2212\n2As(2\u03b1p)s(2\u03b1q) c(4\u03b1p) + c(4\u03b1q)\n( C Eoi B fg p\n` C BojE fg q ` + C Eoi E fg q ` C BojB fg p ` ) +\n2Ac(2\u03b1p)c(2\u03b1q)s(4\u03b1j) [c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C Eoi E fg p\n` C EojB fg q ` + C Eoi B fg q ` C EojE fg p ` ) +\n2Ac(2\u03b1i)c(2\u03b1j)s(4\u03b1q) [c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C Efgi E o p ` C Bfgj E o q ` + C Efgi E o q ` C Bfgj E o p ` ) +\n2As(2\u03b1p)s(2\u03b1q)s(4\u03b1j) [c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C Eoi B fg p\n` C EojE fg q ` + C Eoi E fg q ` C EojB fg p ` ) +\n2As(2\u03b1i)s(2\u03b1j)s(4\u03b1q) [c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C Bfgi E o p ` C Efgj E o q ` + C Bfgi E o q ` C Efgj E o p ` ) \u2212\n2Ac(2\u03b1p)c(2\u03b1q)s(4\u03b1i) [c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C Boi E fg p\n` C BojB fg q ` + C BoiB fg q ` C BojE fg p ` ) \u2212\n2Ac(2\u03b1i)c(2\u03b1j)s(4\u03b1p) [c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C Efgi B o p ` C Bfgj B o q ` + C Efgi B o q ` C Bfgj B o p ` ) \u2212\n2As(2\u03b1p)s(2\u03b1q)s(4\u03b1i) [c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C BoiB fg p\n` C BojE fg q ` + C Boi E fg q ` C BojB fg p `\n)\n\u2013 25 \u2013\n\u2212 2As(2\u03b1i)s(2\u03b1j)s(4\u03b1p)\n[c(4\u03b1i) + c(4\u03b1j)][c(4\u03b1p) + c(4\u03b1q)]\n( C Bfgi B o p ` C Efgj B o q ` + C Bfgi B o q ` C Efgj B o p ` ) . (A.7)\nAfter binning both the angular power spectra and the covariance matrix, the minimization of Eq. (A.2) leads to a linear system with the same structure as that of Eq. (2.10), but with Amn elements that are now\n\u039e = \u2211 i,j,p,q \u2211 b C EiBj ,fg b C \u22121 ijpqbC EpBq ,fg b , (A.8)\nZ = 2 \u2211 i,j,p,q \u2211 b C EiBj ,fg b C \u22121 ijpqb\u03c7 \u039bCDM pqb , (A.9)\n\u0398 = 4 \u2211 i,j,p,q \u2211 b \u03c7\u039bCDMijb C \u22121 ijpqb\u03c7 \u039bCDM pqb , (A.10)\nKm = 2 \u2211 i,p,q \u2211 b [ CEiEm,ob C \u22121 impqbC EpBq ,fg b \u2212 C BmBi,o b C \u22121 mipqbC EpBq ,fg b ] , (A.11)\nTm = 4 \u2211 i,p,q \u2211 b [ CEiEm,ob C \u22121 impqb\u03c7 \u039bCDM pqb \u2212 C BmBi,o b C \u22121 mipqb\u03c7 \u039bCDM pqb ] , (A.12)\n\u2126mn = 4 \u2211 i,j \u2211 b [ CEiEn,ob C \u22121 injmbC EjEm,o b + C BnBi,o b C \u22121 nimjbC BmBj ,o b ] \u2212 4\n\u2211 i,j \u2211 b [ CBnBi,ob C \u22121 nijmbC EjEm,o b + C BmBj ,o b C \u22121 mjinbC EiEn,o b ] . (A.13)\nand bm terms \u03be = \u2211 i,j,p,q \u2211 b C EiBj ,fg b C \u22121 ijpqbC EpBq ,o b , (A.14)\n\u03b8 =2 \u2211 i,j,p,q \u2211 b C EiBj ,o b C \u22121 ijpqb\u03c7 \u039bCDM pqb , (A.15)\n\u03c9m =2 \u2211 i,p,q \u2211 b [ CEiEm,ob C \u22121 impqbC EpBq ,o b \u2212 C BmBi,o b C \u22121 mipqbC EpBq ,o b ] , (A.16)\nOnce again, the uncertainty in the estimation of the xi = (A, \u03b2,\u03b1i) parameters is calculated within the Fisher matrix approximation as C\u22121mn = \u2212 \u2202 2lnL \u2202xm\u2202xn\n= Amn. By exploiting the cross-correlation of different frequency bands, the cross-spectra esti-\nmator is statistically more powerful than the auto-spectra-only estimator defined in section 2, due to the sheer increase of available information (from N\u03bd to N2\u03bd equations) [44]. It is also more robust against instrumental noise bias. On the other hand, the greater complexity of the cross-spectra estimator\u2019s covariance matrix makes it more prone to suffer from the numerical instabilities that arise from calculating the covariance matrix from observed spectra rather than from theoretical models. As explored in Ref. [60], such numerical instabilities are mitigated by optimizing the range of multipoles used in the analysis, smoothing the spectra, or binning the covariance matrix. Note that we can avoid the noise bias contained in frequency auto-spectra with a minimal loss of information if we build an estimator that exclusively uses cross-spectra by explicitly leaving auto-spectra out of the summations in the elements of the linear system. In practice, this is done by changing \u2211 i,j,p,q \u2192 \u2211 i,j 6=i \u2211 p,q 6=p in Eqs. (A.8), (A.9), (A.10), (A.14), and\n\u2013 26 \u2013\n(A.15), \u2211 i,p,q \u2192 \u2211 i 6=m \u2211 p,q 6=p in Eqs. (A.11), (A.12), and (A.16), and \u2211 i,j \u2192 \u2211 i 6=n \u2211\nj 6=m in Eq. (A.13). For this cross-spectra-only estimator, the size of the covariance matrix is reduced to N\u03bd(N\u03bd \u2212 1)N` \u00d7N\u03bd(N\u03bd \u2212 1)N`."
        },
        {
            "heading": "B Comparison with MCMC sampling",
            "text": "Here, we briefly compare our semi-analytical algorithm with its counterpart MCMC implementation. By comparing them with the posterior distributions obtained from the MCMC sampling of the full likelihood, figure 19 shows that our algorithm is correctly finding the maximum-likelihood solutions and marginalized Fisher uncertainties for all parameters. Those results validate both our iterative approach and the use of the small-angle approximation. As discussed in section 2, the likelihood defined for our estimator should include the ln |C| term to ensure that the change in the likelihood\u2019s normalization as the free parameters in the covariance matrix vary during the MCMC sampling is taken into account. Therefore, not including the log-determinant can lead to biased posterior distributions. Figure 18 illustrates this effect by showing the maximum-likelihood solutions obtained when including (blue circles) or excluding (orange circles) ln |C| from the likelihood, for both the case where foreground EB is ignored (left panel) or accounted for (right panel). The biases produced by ignoring ln |C| are more important for smaller sky fractions, and seem to diminish when a template for foreground emission is provided. In both cases, our algorithm yields values (red triangles) that are compatible with those obtained when including ln |C|, confirming that our iterative approach also accounts for the change in the likelihood\u2019s normalization. The uncertainties derived from our algorithm and the MCMC sampling are compatible within a 1% level for CO+PS and CO+PS+10% masks, and within 15% for the CO+PS+30% mask. The latter discrepancy is of the same order of magnitude as the discrepancy seen between the uncertainties derived from Fisher and the simulations\u2019 dispersion in section 4. This suggests that, for large Galactic masks, the Fisher approximation might not be enough to correctly describe posterior distributions.\n\u2013 27 \u2013\nIn terms of computational resources and speed, our semi-analytical algorithm is far superior to the MCMC implementation. Taking the 8 detector splits of Planck HFI as a benchmark, and using 60 walkers, running the MCMC sampler parallelized over 64 cores at Cori Haswell9 nodes on NERSC takes approximately 4.2s per iteration when the foreground EB contribution is ignored, and 12.9s per iteration when a foreground template is provided.\n9Cori Haswell nodes have 64 Intel Xeon processors with a 2.3GHz clock rate and a total memory of 128GB per node.\n\u2013 28 \u2013\nA minimum of around 2500 iterations are needed to obtain fully converged chains, taking from 3 to 9 hours of computation time. In contrast, the semi-analytical algorithm written in plain Python runs on one Cori Haswell core in approximately 7s when the foreground EB contribution is ignored, and 12s when a foreground template is provided. In this sense, our algorithm could be run on any laptop with enough memory to support the volume of data corresponding to the covariance matrix for a given number of frequency bands."
        },
        {
            "heading": "C Calculation of the covariance matrix",
            "text": "Here, we offer a detailed calculation of the covariance matrix presented in section 2 for the frequency auto-spectra estimator. We followed the same procedure to calculate the covariance matrix of the cross-spectra estimator presented in appendix A. In Eq. (2.6), covariance elements are calculated from the observed angular power spectra as well as the models for both foreground and CMB signals. Therefore, once all the products are expanded, the covariance can be divided into terms that depend only on the observed, foreground, and CMB spectra, and on their cross-correlations:\nCij` = 1\n(2`+ 1)fsky\n[ Coij` + C CMB ij` + C fg ij` + C CMB\u2217o ij` + C fg\u2217o ij` ] , (C.1)\nwhere we have already assumed that correlations between the foreground and CMB signals are negligible10 (CCMB\u2217fgij` = 0), and included the sky fraction factor fsky to account for partial sky coverage.\nApplying Eq. (2.7), Coij` and C fg ij` terms are calculated as follows:\nCoij` = C Eoi E o j ` C BoiB o j ` + C Eoi B o j ` C Boi E o j ` + t(4\u03b1j) [ C Eoi B o j ` C BoiB o j ` \u2212 C Eoi E o j ` C Boi E o j ` ] + t(4\u03b1i) [ C Boi E o j ` C BoiB o j ` \u2212 C Eoi E o j ` C Eoi B o j `\n] + t(4\u03b1i)t(4\u03b1j)\n2\n[( C Eoi E o j\n`\n)2 + ( C BoiB o j\n`\n)2 \u2212 ( C Eoi B o j\n`\n)2 \u2212 ( C Boi E o j\n`\n)2] (C.2)\nand\nCfgij` = A2\nc(4\u03b1i)c(4\u03b1j)\n[ C Efgi E fg j ` C Bfgi B fg j ` + C Efgi B fg j ` C Bfgi E fg j ` ] . (C.3)\nThe cross-correlation between the observed signal and the foreground model is given as\nCfg\u2217oij` =\u2212 A\nc(4\u03b1i)\n[ C Efgi E o j ` C Bfgi B o j ` + C Bfgi E o j ` C Efgi B o j ` ] \u2212\nA c(4\u03b1j)\n[ C Eoi E fg j\n` C BoiB fg j ` + C Eoi B fg j ` C Boi E fg j ` ] + At(4\u03b1j) c(4\u03b1i) [ C Efgi E o j ` C Bfgi E o j ` \u2212 C Efgi B o j ` C Bfgi B o j `\n] + At(4\u03b1i) c(4\u03b1j) [ C Eoi E fg j ` C Eoi B fg j ` \u2212 C Boi E fg j ` C BoiB fg j ` ] . (C.4)\n10Although chance correlations between foreground and CMB signals can be important on a realization-byrealization basis, they are subdominant at the angular scales of interest for this work (` > 50).\n\u2013 29 \u2013\nIf we had a theoretical model for the foreground angular power spectra, or accepted the Commander sky model as an exact representation of the polarized foreground emission on the sky, we could further expand the CXfgY o` terms in Eq. (C.4) by acknowledging that the spherical harmonic coefficients of the observed signal are a rotation of the CMB and foreground ones (see Eq. (2.1)). Therefore, when calculating CXfgY o` = (2`+ 1) \u22121\u2211` m=\u2212`X fg `m Y o `m \u2217 for any given pair of frequency bands, we will obtain a rotation of CEfgEfg` , C EfgBfg ` , and C BfgBfg\n` . Instead, as we are treating Commander as an approximate model, in this work we calculate the CXfgY o` correlations between the observed maps and Commander templates to account for any possible mismodeling of the foreground emission. On the other hand, for the CMB we do expand the corresponding CXCMBY o` terms. In that case, the contribution from CMB-related terms to the covariance is\nCCMBij` = s2(4\u03b2)\n2c(4\u03b1i)c(4\u03b1j)\n( bi`b j ` )2 \u03c94pix,` [( CEE,\u039bCDM` )2 + ( CBB,\u039bCDM` )2] , (C.5)\nCCMB\u2217oij` =\u2212 s2(4\u03b2)\nc(4\u03b1i)c(4\u03b1j)\n( bi`b j ` )2 \u03c94pix,` [( CEE,\u039bCDM` )2 + ( CBB,\u039bCDM` )2] , (C.6)\nwhere CEE,\u039bCDM` and C BB,\u039bCDM ` are the theoretical angular power spectra predicted by \u039bCDM, and the combination of ij frequency bands is specified through the different beam and pixel window functions, bi` and \u03c9pix,`, respectively. Note that the covariance matrix is a block matrix composed of N\u03bd\u00d7N\u03bd diagonal N`\u00d7N` boxes since we are not considering `-to-`\u2032 correlations. Hence, our algorithm can be optimized by reordering the Cij``\u2032 terms of the covariance into N` \u00d7N` boxes of N\u03bd \u00d7N\u03bd elements to form a block diagonal matrix whose inverse is calculated by independently inverting each of its blocks. This leads to a faster implementation, since inverting N` N\u03bd\u00d7N\u03bd matrices is faster than inverting one big N\u03bdN` \u00d7N\u03bdN` matrix, especially when dealing with a large number of frequency bands."
        },
        {
            "heading": "D Modeling Galactic foregrounds in the covariance matrix",
            "text": "In section 4, we saw that the statistical uncertainties in the estimation of \u03b2 and \u03b1i decreased when the foreground EB was included in the model (A 6= 0). Although counter-intuitive at first, here we will explain why the inclusion of a template for Galactic foreground emission in the covariance matrix leads to a reduction of the total covariance that produces those smaller uncertainties. For simplicity, we will perform these calculations for the frequency auto-spectra estimator.\nTo determine the role of foregrounds in the covariance matrix, we can assume that our foreground template is a faithful representation of the foreground emission in the sky and expand the CXfgY o` terms in Eq. (C.4) as a rotation of C EfgEfg ` , C EfgBfg ` , and C BfgBfg\n` . Under these conditions, the contribution of the foreground template to the covariance is\nCfgij` = A2\nc(4\u03b1i)c(4\u03b1j)\n[ C EiEj ,fg ` C BiBj ,fg ` + C EiBj ,fg ` C BiEj ,fg ` ] , (D.1)\nCfg\u2217oij` =\u2212 2A\nc(4\u03b1i)c(4\u03b1j)\n[ C EiEj ,fg ` C BiBj ,fg ` + C EiBj ,fg ` C BiEj ,fg ` ] . (D.2)\n\u2013 30 \u2013\nFrom these terms alone we can already see that if the template offers a good enough representation of the foreground emission in the sky, then A \u2248 1, and Cfgij` + C fg\u2217o ij` becomes a negative contribution to the total covariance. We can also expand the CXoY o` angular power spectra in Eq. (C.2) by explicitly calculating the correlations between the rotated foreground and CMB components, as written in Eq. (2.1). With that we obtain\nCoij` = 1\nc(4\u03b1i)c(4\u03b1j)\n[ C EiEj ,fg ` C BiBj ,fg ` + C EiBj ,fg ` C BiEj ,fg ` ] + s2(4\u03b2)\n2c(4\u03b1i)c(4\u03b1j)\n[( C EiEj ,\u039bCDM ` )2 + ( C BiBj ,\u039bCDM ` )2] + s(4\u03b2)c2(2\u03b1i + 2\u03b1j)\nc(4\u03b1i)c(4\u03b1j)\n[ C EiBj ,fg ` + C BiEj ,fg ` ] [ C EiEj ,\u039bCDM ` \u2212 C BiBj ,\u039bCDM ` ] + s2(2\u03b2)\nc(4\u03b1i)c(4\u03b1j)\n[ C EiEj ,fg ` C EiEj ,\u039bCDM ` + C BiBj ,fg ` C BiBj ,\u039bCDM ` ] + c2(2\u03b2)\nc(4\u03b1i)c(4\u03b1j)\n[ C EiEj ,fg ` C BiBj ,\u039bCDM ` + C BiBj ,fg ` C EiEj ,\u039bCDM ` ] + s2(4\u03b2)\nc(4\u03b1i)c(4\u03b1j) C EiEj ,\u039bCDM ` C BiBj ,\u039bCDM ` . (D.3)\nAdding all contributions, the total covariance in Eq. (C.1) is\n(2`+ 1)fskyCij` = 1 +A(A\u2212 2) c(4\u03b1i)c(4\u03b1j)\n[ C EiEj ,fg ` C BiBj ,fg ` + C EiBj ,fg ` C BiEj ,fg ` ] + s(4\u03b2)c2(2\u03b1i + 2\u03b1j)\nc(4\u03b1i)c(4\u03b1j)\n[ C EiBj ,fg ` + C BiEj ,fg ` ] [ C EiEj ,\u039bCDM ` \u2212 C BiBj ,\u039bCDM ` ] + s2(2\u03b2)\nc(4\u03b1i)c(4\u03b1j)\n[ C EiEj ,fg ` C EiEj ,\u039bCDM ` + C BiBj ,fg ` C BiBj ,\u039bCDM ` ] + c2(2\u03b2)\nc(4\u03b1i)c(4\u03b1j)\n[ C EiEj ,fg ` C BiBj ,\u039bCDM ` + C BiBj ,fg ` C EiEj ,\u039bCDM ` ] + s2(4\u03b2)\nc(4\u03b1i)c(4\u03b1j) C EiEj ,\u039bCDM ` C BiBj ,cmb ` , (D.4)\nwhere the second term from Eq. (D.3) gets cancelled by the sum of CCMBij` and C CMB\u2217o ij` from Eqs. (C.5) and (C.6) as long as our theoretical model for the CMB angular power spectra is accurate enough. At high frequencies, Galactic foreground emission dominates over that of the CMB (especially at the largest scales), making the first term in Eq. (D.4) one of the main contributions to the total covariance. That term remains present if we do not account for the foreground EB correlation (A = 0) in our likelihood, but gets cancelled when we use a good enough foreground template (A \u2248 1) to correct for it. This cancellation explains why including the foreground template leads to a reduction of the statistical uncertainties associated with our measurements. It is also worth noting that Cfg\u2217oij` is the term responsible for the reduction in the covariance matrix. Thus, the inclusion of foregrounds will indeed lead to an increase in statistical uncertainties if we ignored the correlations between template and data. The same happens with CCMBij` and C CMB\u2217o ij` correlations.\n\u2013 31 \u2013"
        }
    ],
    "title": "Robustness of cosmic birefringence measurement against Galactic foreground emission and instrumental systematics",
    "year": 2023
}