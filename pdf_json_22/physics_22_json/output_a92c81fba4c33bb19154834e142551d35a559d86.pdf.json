{
    "abstractText": "Yuto Minami 1, and Kiyotomo Ichiki 2,3,4 1Research Center for Nuclear Physics, Osaka University, Ibaraki, Osaka 567-0047, Japan 2Kobayashi-Maskawa Institute for the Origin of Particles and the Universe, Nagoya University, Furouchou, Chikusa-ku, Nagoya, Aichi 464-8602, Japan 3Graduate School of Science, Nagoya University, Furouchou, Chikusa-ku, Nagoya, Aichi 464-8602, Japan 4Institute for Advanced Research, Nagoya University, Furouchou, Chikusa-ku, Nagoya Aichi 464-8602, Japan E-mail: yminami@rcnp.osaka-u.ac.jp",
    "authors": [
        {
            "affiliations": [],
            "name": "Yuto Minami"
        },
        {
            "affiliations": [],
            "name": "Kiyotomo Ichiki"
        }
    ],
    "id": "SP:0df0e2046036f2a245926f7b79bdcb70cf2fe48a",
    "references": [
        {
            "authors": [
                "L.P. Grishchuk"
            ],
            "title": "Zh",
            "venue": "Eksp. Teor. Fiz. 67, 825 ",
            "year": 1974
        },
        {
            "authors": [
                "A.A. Starobinsky",
                "JETP Lett"
            ],
            "title": "30",
            "venue": "682 ",
            "year": 1979
        },
        {
            "authors": [
                "U. Seljak",
                "M. Zaldarriaga"
            ],
            "title": "Phys",
            "venue": "Rev. Lett. 78, 2054 ",
            "year": 1997
        },
        {
            "authors": [
                "M. Kamionkowski",
                "A. Kosowsky",
                "A. Stebbins"
            ],
            "title": "Phys",
            "venue": "Rev. Lett. 78, 2058 ",
            "year": 1997
        },
        {
            "authors": [
                "M. Kamionkowski",
                "E.D. Kovetz"
            ],
            "title": "Ann",
            "venue": "Rev. Astron. Astrophys. 54, 227 ",
            "year": 2016
        },
        {
            "authors": [
                "K. Ichiki"
            ],
            "title": "Prog",
            "venue": "Theor. Exp. Phys. 2014, 06B109 ",
            "year": 2014
        },
        {
            "authors": [
                "H.K. Eriksen",
                "J.B. Jewell",
                "C. Dickinson",
                "A.J. Banday",
                "K.M. Gorski",
                "C.R. Lawrence"
            ],
            "title": "Astrophys",
            "venue": "J. 676, 10 ",
            "year": 2008
        },
        {
            "authors": [
                "R. Fern\u00e1ndez-Cobos",
                "P. Vielva",
                "R.B. Barreiro",
                "E. Mart\u00ednez-Gonz\u00e1lez"
            ],
            "title": "Mon",
            "venue": "Not. R. Astron. Soc. 420, 2162 ",
            "year": 2012
        },
        {
            "authors": [
                "J. Delabrouille",
                "J.F. Cardoso",
                "G. Patanchon"
            ],
            "title": "Mon",
            "venue": "Not. R. Astron. Soc. 346, 1089 ",
            "year": 2003
        },
        {
            "authors": [
                "J. Delabrouille",
                "J.F. Cardoso",
                "M. Le Jeune",
                "M. Betoule",
                "G. Fay",
                "F. Guilloux"
            ],
            "title": "Astron",
            "venue": "Astrophys. 493, 835 ",
            "year": 2009
        },
        {
            "authors": [
                "M. Remazeilles",
                "J. Delabrouille",
                "J.-F. Cardoso"
            ],
            "title": "Mon",
            "venue": "Not. R. Astron. Soc. 418, 467 ",
            "year": 2011
        },
        {
            "authors": [
                "K. Ichiki",
                "H. Kanai",
                "N. Katayama",
                "E. Komatsu"
            ],
            "title": "Prog",
            "venue": "Theor. Exp. Phys. 2019, 033E01 ",
            "year": 2019
        },
        {
            "authors": [
                "J. Chluba",
                "J.C. Hill",
                "M.H. Abitbol"
            ],
            "title": "Mon",
            "venue": "Not. R. Astron. Soc. 472, 1195 ",
            "year": 2017
        },
        {
            "authors": [
                "A. Mangilli",
                "J. Aumont",
                "A. Rotti",
                "F. Boulanger",
                "J. Chluba",
                "T. Ghosh",
                "L. Montier"
            ],
            "title": "Astron",
            "venue": "Astrophys. 647, A52 ",
            "year": 2021
        },
        {
            "authors": [
                "L. Vacher",
                "J. Aumont",
                "L. Montier",
                "S. Azzoni",
                "F. Boulanger",
                "M. Remazeilles"
            ],
            "title": "Astron",
            "venue": "Astrophys. 660, A111 ",
            "year": 2022
        },
        {
            "authors": [
                "L. Vacher",
                "J. Chluba",
                "J. Aumont",
                "A. Rotti",
                "L. Montier"
            ],
            "title": "Astron",
            "venue": "Astrophys. 669, A5 ",
            "year": 2023
        },
        {
            "authors": [
                "N. Katayama",
                "E. Komatsu"
            ],
            "title": "Astrophys",
            "venue": "J. 737, 78 ",
            "year": 2011
        },
        {
            "authors": [
                "R. Stompor",
                "S.M. Leach",
                "F. Stivoli",
                "C. Baccigalupi"
            ],
            "title": "Mon",
            "venue": "Not. R. Astron. Soc. 392, 216 ",
            "year": 2009
        },
        {
            "authors": [
                "C.E. Rasmussen",
                "C.K.I. Williams"
            ],
            "title": "Gaussian Processes for Machine Learning",
            "venue": "Adaptive Computation and Machine Learning ",
            "year": 2006
        },
        {
            "authors": [
                "B. Thorne",
                "J. Dunkley",
                "D. Alonso",
                "S. Naess"
            ],
            "title": "Mon",
            "venue": "Not. R. Astron. Soc. 469, 2821 ",
            "year": 2017
        },
        {
            "authors": [
                "M.A. Miville-Deschenes",
                "N. Ysard",
                "A. Lavabre",
                "N. Ponthieu",
                "J.F. Macias-Perez",
                "J. Aumont",
                "J.P. Bernard"
            ],
            "title": "Astron",
            "venue": "Astrophys. 490, 1093 ",
            "year": 2008
        },
        {
            "authors": [
                "A.M. Meisner",
                "D.P. Finkbeiner"
            ],
            "title": "Astrophys",
            "venue": "J. 798, 88 ",
            "year": 2015
        },
        {
            "authors": [
                "K.M. Gorski",
                "E. Hivon",
                "A.J. Banday",
                "B.D. Wandelt",
                "F.K. Hansen",
                "M. Reinecke",
                "M. Bartelman"
            ],
            "title": "Astrophys",
            "venue": "J. 622, 759 ",
            "year": 2005
        },
        {
            "authors": [
                "A. Lewis",
                "A. Challinor",
                "A. Lasenby"
            ],
            "title": "Astrophys",
            "venue": "J. 538, 473 ",
            "year": 2000
        }
    ],
    "sections": [
        {
            "text": "Prog. Theor. Exp. Phys. 2023 033E01(20 pages) DOI: 10.1093/ptep/ptad016\nExtended delta-map: A map-based foreground removal method for CMB polarization observations Yuto Minami 1, and Kiyotomo Ichiki 2,3,4 1Research Center for Nuclear Physics, Osaka University, Ibaraki, Osaka 567-0047, Japan 2Kobayashi-Maskawa Institute for the Origin of Particles and the Universe, Nagoya University, Furouchou, Chikusa-ku, Nagoya, Aichi 464-8602, Japan 3Graduate School of Science, Nagoya University, Furouchou, Chikusa-ku, Nagoya, Aichi 464-8602, Japan 4Institute for Advanced Research, Nagoya University, Furouchou, Chikusa-ku, Nagoya Aichi 464-8602, Japan E-mail: yminami@rcnp.osaka-u.ac.jp\nReceived December 16, 2022; Revised January 20, 2023; Accepted January 21, 2023; Published January 28, 2023\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . In order to extract information about inflationary gravitational waves using B-mode patterns of cosmic microwave polarization anisotropy, we need to remove the foreground radiation from the Milky Way. In our previous delta-map method for foreground removal, the number of observation bands was limited to the number of parameters of the assumed foreground model, and therefore it was difficult to improve the sensitivity by increasing the number of observation bands. Here, we extend the previous method so that it can be adapted to an arbitrary number of observation bands. Using parametric likelihood and realistic foreground and CMB simulations, we show that our method can increase the sensitivity to the tensor-to-scalar ratio r without inducing any significant bias. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nSubject Index E63, F11, F14"
        },
        {
            "heading": "1. Introduction",
            "text": "Precise measurements of linear polarization patterns of the cosmic microwave background (CMB) provide us with plentiful information of our Universe [1\u20139]. In particular, a measurement of the B-mode pattern in CMB polarization anisotropies is a key to detecting primordial gravitational waves (PGWs) expected in the inflation scenario of the early Universe [10\u201314]. However, celestial sources also emit microwave photons with linear polarization that mimic the cosmological B-mode, the so-called foreground emission, which disturbs the precise measurement of the CMB B-mode [15]. The two representative foreground emissions in CMB polarization measurements are synchrotron and thermal dust emissions, which have different spectral energy distributions from the black body and dominate at lower and higher frequencies, respectively. Therefore, we can remove the foreground emissions using multiple-band observations owing to their frequency dependences.\nMany foreground removal and component separation methods exist to extract the cosmological B-mode signal, e.g., Commander [16], SEVEM [17], SMICA [18], NILC [19], and GNILC [20]. Among these, we proposed a method called \u201cdelta-map\u201d based on a linear combination of the observed maps to remove the foreground components [21]. This method allows the directional dependence of the frequency spectrum of foreground emissions up to the\n\u00a9 The Author(s) 2023. Published by Oxford University Press on behalf of the Physical Society of Japan. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (https://creativecommons.org/licenses/by/4.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nfirst order to be taken into account by considering the differences in the observation maps1. Because the method uses one additional frequency map to eliminate the directional dependence of one foreground parameter, the usable number of maps is limited by the number of foreground parameters in the assumed model. Specifically, suppose that we assume one foreground model with N parameters and CMB signal in all the multi-frequency maps. In this case, the delta-map method requires one map for the CMB, one map for the zeroth (or spatially uniform) foreground parameter, and N maps for the first-order expansion of the N parameters; we need exactly (2 + N) maps. This prevents us from obtaining improvement of the sensitivity in observation by increasing the number of observing bands. More concretely, if we consider a power-law synchrotron foreground model with one parameter \u03b2s and a one-component dust model with two parameters \u03b2d and Td, the number of observation bands should be exactly six. This is a waste of resources since some future CMB missions plan to have plenty of bands; e.g., LiteBIRD will have 15 bands [26,27]. In this paper, we improve the method by constructing a parametric likelihood in a Bayesian way so that more observation bands can be used.\nThe rest of this paper is organized as follows. In Sect. 2, we first review the previous deltamap method that is based on the linear combination, and then derive a new delta-map method based on a parametric likelihood. In Sect. 3, we explain the foreground models and simulations used in this work. We show the results of the measurements of CMB parameters with some sky simulation setups in Sect. 4. In Sect. 5, we discuss the results and conclude this work."
        },
        {
            "heading": "2. Methodology",
            "text": "We first introduce the delta-map method described in Ref. [21]. We decompose a linear polarization signal of a microwave component at a frequency, \u03bd, from a line of sight, n\u0302, to two orthogonal Stokes parameters, Q(n\u0302) and U (n\u0302), which we observe in thermodynamic temperature units. Let us vectorize all Q(n\u0302) and U (n\u0302) from all n\u0302 in use and concatenate them into one column vector as s = (Q(n\u03021), . . . , Q(n\u0302Npix ),U (n\u03021), . . . ,U (n\u0302Npix ))T , (1) where Npix is the number of pixels in use and the subscript T represents a transpose.\nThe CMB signal is common in any frequency band except for beam effects of instruments, and can be written as sCMB(\u03bd ) = sCMB. We assume that each frequency has each independent Gaussian noise, sN . A foreground signal varies in frequency space according to N parameters that vary over the sky, pI (I = 1, 2, . . . , N ), as\ns f (\u03bd ) = g\u03bdD\u03bd ( pI ) sb, (2) where sb is a signal vector at a pivot frequency in brightness temperature units, D\u03bd ( pI ) is a diagonal matrix with the same dimension as s f , and g\u03bd is the conversion factor from the brightness temperature to the CMB thermodynamic temperature given by\ng\u03bd \u2261 (e x \u2212 1)2 exx2 with x \u2261 h\u03bd kBTCMB . (3)\nIn this paper, we use the power-law synchrotron and one-component modified black body (1MBB) models to fit the synchrotron and dust foreground emissions, respectively. The func-\n1A similar perturbative approach in multipole space has also been investigated in Refs. [22\u201325].\n2/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\ntional form of one pixel of D\u03bd ( pI ) for the power-law synchrotron is Ds\u03bd (\u03b2s(n\u0302)) = ( \u03bd\n\u03bds\u2217\n)\u03b2s(n\u0302) , (4)\nwhere \u03bd\u2217 is the reference frequency, which we set as \u03bds\u2217 = 23 GHz, and \u03b2s(n\u0302) is the synchrotron spectral index. The one for 1MBB is\nDd\u03bd (Td (n\u0302), \u03b2d (n\u0302)) = ( \u03bd\n\u03bdd\u2217\n)\u03b2d (n\u0302)+1 exd\u2217(n\u0302) \u2212 1 exd (n\u0302) \u2212 1 , (5)\nwhere xd\u2217(n\u0302) \u2261 h\u03bdd\u2217kBTd (n\u0302) , xd (n\u0302) \u2261 h\u03bd kBTd (n\u0302) , Td (n\u0302) is the dust temperature, \u03b2d (n\u0302) is the dust spectral index, and we set \u03bdd\u2217 = 353 GHz. The basic idea of the delta-map method is to consider a spatial variation of foreground signal parameters up to the first-order expansion2 as\ng\u03bdD\u03bd ( pI ) sb = g\u03bdD\u03bd ( p\u0304I )I sb + g\u03bd \u2211N I=1 D\u03bd,pI ( p\u0304 I )I(\u03b4 pI \u25e6 sb) + O(\u03b4 pI 2), (6)\nwhere p\u0304I represents the mean value of the parameter pI over the sky, I is an identity matrix, and \u201c\u25e6\u201d means a Hadamard product. Hereafter, we consider two representative foreground components: synchrotron radiation and thermal dust emission. With these two foreground components, the foreground signal is written as\ng\u03bdD\u03bd ( pI ) s f = g\u03bdDd\u03bd ( p\u0304I ) I sd + g\u03bd Nd\u2211 I=1 Dd\u03bd ,pId ( p\u0304I ) I ( \u03b4 pId \u25e6 sd ) + O (\u03b4 pId 2)\n+ g\u03bdDs\u03bd ( p\u0304I ) I ss + g\u03bd Ns\u2211 I=1 Ds\u03bd,pIs ( p\u0304Is ) I ( \u03b4 pIs \u25e6 ss ) + O (\u03b4 pIs2) (7) = D\u0303\u03bd\u0303s f ,\nwhere the superscripts and subscripts \u201cs\u201d and \u201cd\u201d denote synchrotron and dust emission foreground components, respectively, and Ns and Nd denote the numbers of parameters for synchrotron and dust foreground emissions, respectively. Here D\u0303\u03bd represents the frequency dependence of the signals up to the first order \u0303s f and is given by\nD\u0303\u03bd = ( g\u03bdDd\u03bd ( p\u0304 I d )I g\u03bdD d \u03bd ,p1d ( p\u03041d )I \u00b7 \u00b7 \u00b7 g\u03bdDd\u03bd ,pNdd ( p\u0304 Nd d )I g\u03bdD s \u03bd ( p\u0304 I s )I g\u03bdD s \u03bd,p1s ( p\u0304 1 s )I \u00b7 \u00b7 \u00b7 g\u03bdDs\u03bd,pNss ( p\u0304Nss )I ) (8)\nand, in the last line, we define the foreground signal vector as\n\u0303s f \u2261 \u239b \u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239d sd \u03b4 p1d \u25e6 sd ... \u03b4 pNd \u25e6 sd ss \u03b4 p1s \u25e6 ss\n... \u03b4 pNs \u25e6 ss\n\u239e \u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u23a0 . (9)\nIn summary, we assume that the observed data can be decomposed as m(\u03bd ) = sCMB + D\u0303\u03bd\u0303s f + sN (\u03bd ). (10) 2The standard deviation of directional variation of foreground parameters considered in this paper is less than 10% of the spatial uniform parameter. We can assume the second-order variation to be less than 1%; hence we neglect higher-order terms.\n3/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nWe need to observe the sky at multiple frequencies to remove foreground components using its frequency dependence. When we observe the sky at N\u03bd frequencies, the total data can be expressed as\nm = DCMB sCMB + D\u0303\u0303s f + \u239b \u239c\u239d sN (\u03bd1) ...\nsN (\u03bdN\u03bd )\n\u239e \u239f\u23a0, (11)\nwhere\nm \u2261 \u239b \u239c\u239d m(\u03bd1) ...\nm(\u03bdN\u03bd )\n\u239e \u239f\u23a0, (12)\nDCMB \u2261 \u239b \u239c\u239d\nI ... I\n\u239e \u239f\u23a0 and D\u0303 \u2261 \u239b \u239c\u239d D\u0303\u03bd1 ...\nD\u0303\u03bdN\u03bd\n\u239e \u239f\u23a0. (13)\nThis is the baseline expression of the \u201cdelta-map\u201d method. In Ref. [21], one frequency, \u03bd1, was chosen as the CMB channel and other channels with weights \u03b1T = (\u03b1\u03bd2, . . . , \u03b1\u03bdN\u03bd ) were added to remove foreground contributions and to have a cleaned CMB map as\nmCMB = m\u03bdCMB +\n\u2211\u03bdN\u03bd i=\u03bd2 \u03b1i m\u03bdi\n1 + \u2211\u03bdN\u03bdi=\u03bd2 \u03b1i (14) with\n[1, \u03b1T]D\u0303 = O. (15) The above equation can be solved only when the number of frequencies, N\u03bd , is equal to the number of degrees of freedom, (Nd + 1) + (Ns + 1) + 1, where Ns and Nd are the number of parameters of the synchrotron radiation and thermal dust emission models, respectively. This is the caveat and weak point of the previous delta-map method because we cannot increase the sensitivity by increasing N\u03bd . We shall mitigate this point in the following sections.\nSince the cleaned CMB map should contain only the CMB and the combined noise, we can construct our likelihood as \u22122 lnL = mTCMBC\u22121 mCMB + ln |2\u03c0C|, (16) where the covariance matrix C is given by [21,28]\nC = r \u00d7 Ctens + Cscal + N\u03bdCMB + \u2211\u03bdN\u03bd i=\u03bd2 \u03b1 2 i N\u03bdi(\n1 + \u2211\u03bdN\u03bdi=\u03bd2 \u03b1i)2 . (17) By minimizing this likelihood, we can determine a CMB parameter, r, and foreground parameters, pIdd and p Is s , where Id \u2208 (1, \u2026, Nd) and Is \u2208 (1, \u2026, Ns). It is known that the determined foreground parameters are biased when we use the full likelihood function [29]. We can avoid the bias by using the \u03c72 term, namely, the first term of Eq. (16). Technically, the following iteration scheme was adapted in Ref. [21] to determine both the CMB and foreground parameters.\n2.1 Extended delta-map In this section we introduce our method using a parametric likelihood. We describe the details of the derivation in Appendix A.\n4/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nAlgorithm 1 Iteration algorithm of the minimization\nSet initial values of pd I d and psI s rpre = \u221e rout = 1e2 \u22122Lpre = \u221e \u22122Lout = 1e10 Set initial values of foreground parameters while (\u22122Lpre + 2Lout) > 1e\u22122 & (rpre \u2212 rout) > 1e\u22125 do\nFix rout and minimize \u03c72 term against pd I d and psI s Fix foreground and minimize all the \u22122L terms against rout Set rpre with rout Set \u22122Lpre with \u22122Lout Set \u22122Lout with the minimized \u22122L\nend while Return rout, pd I d , and psI s\nWe start from Eq. (11). By subtracting the CMB and foreground terms from the observed maps m, we can construct the likelihood of data as\n\u22122 lnL ( m| sCMB, \u0303s f , D\u0303 ) = ( m \u2212 DCMB sCMB \u2212 D\u0303\u0303s f )T N\u22121 ( m \u2212 DCMB sCMB \u2212 D\u0303\u0303s f ) + ln |2\u03c0N|, (18)\nwhere N = diag(N\u03bd1, . . . , N\u03bdN\u03bd ) is a noise covariance matrix. We use Bayes\u2019 theorem to relate the posterior distribution to the likelihood as\nP ( sCMB, \u0303s f , p\u0304I , SCMB0 , S f | m )\n= L\n( m| sCMB, \u0303s f , D\u0303 ( p\u0304I )) \u00b7 P ( sCMB, \u0303s f , D\u0303 (p\u0304I) , SCMB0 , S f ) P ( m) , (19)\nwhere SCMB0 and S f are covariance matrices of the CMB, sCMB, and foreground signal, \u0303s f , respectively; p\u0304I represents the foreground parameters of both synchrotron and thermal dust emissions; and P( m) is a normalization factor. Here we use a flat prior on p\u0304I and have P( sCMB, \u0303s f , D\u0303( p\u0304I ), SCMB0 , S\nf ) \u221d P( sCMB, \u0303s f , SCMB0 , S f ). We marginalize it over the CMB signal assuming a Gaussian distribution,\n\u22122P ( sCMB, SCMB0 ) = sTCMBSCMB0 \u22121 sCMB + ln \u2223\u22232\u03c0SCMB0 \u2223\u2223 , (20) to have\n\u22122 ln P( p\u0304I , \u0303s f , S f , SCMB0 | m) = ( m \u2212 D\u0303\u0303s f )T ( SCMB + N)\u22121 ( m \u2212 D\u0303\u0303s f )\n+ ln \u2223\u22232\u03c0 (SCMB + N)\u2223\u2223 \u2212 2 ln P (\u0303s f , S f ) + const. , (21) where SCMB = DCMBSCMB0 DCMB T . This is Eq. (58) in Ref. [21].\nFrom here, we deal with the P ( \u0303s f , S f ) term. Our strategy is to marginalize the foreground probability function, assuming that its mean is zero, \u0303s f = 0, and its covariance is \u201cvague\u201d, Sf\u22121 \u2192 O. We follow the methodology described in Sect. 2 of Ref. [30] to deal with the \u201cvague\u201d\n5/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nforeground covariance matrix. Following the method, we obtain\n\u22122 ln P( p\u0304I , SCMB0 | m) = \u2212 mTN\u22121DCMBA\u22121DCMB T N\u22121 m\n\u2212 MH M \u2212 MHB\u22121H M + ln |SCMB0 | + ln |D\u0303TN\u22121D\u0303| + ln |B| + const. , (22)\nwhere\nA = \u239b \u239dSCMB0 \u22121 +\nN+1\u2211 j=1 N\u22121\u03bd j\n\u239e \u23a0 , (23)\nH = N\u22121D\u0303 [D\u0303TN\u22121D\u0303]\u22121 D\u0303TN\u22121, (24) B = A \u2212 DCMBTHDCMB, (25)\nM = m \u2212 DCMBA\u22121DCMBTN\u22121 m, (26) and put the noise terms, mTN\u22121 m + ln |N|, into the const. term. For details of the derivation of Eq. (22), see Appendix A. To determine the CMB parameter (r) and foreground parameters (p\u0304I ), we follow the same procedure, namely Algorithm 1, as in Ref. [21]. We set the initial values of all parameters as r = 0.5, \u03b2s = \u22123.0, \u03b2d = 1.5, and Td = 20.1 K. We set a lower bound on r \u2265 0.0 so that the CMB covariance matrix is not singular and set boundaries on the foreground parameters as \u03b2s \u2208 (\u221210.0, \u22120.01), \u03b2d \u2208 (0.1, 10.0), and Td \u2208 (5.0, 40.0).\nWe obtain the \u201cextended delta-map\u201d likelihood as Eq. (22), which allows us to determine the CMB and foreground parameters without the band number constraint. This likelihood has another benefit. Because we use the \u201cmatrix inversion lemma\u201d (Appendix B) in the derivation, we can reduce the computational cost in using the Cholesky solver for SCMB + N in Eq. (21), which is a positive definite symmetric matrix with a dimension of 2NpixN\u03bd . In Eq. (22), in contrast, we only need to use the Cholesky solver for some positive definite symmetric matrices, e.g., B, with a smaller size of 2Npix(Nd + Ns + 3).\nBecause the form of Eq. (22) looks so different from that of Eq. (16), one may suspect that they are totally different methods. We find that estimated values of the parameters with this likelihood are equivalent to those estimated from the previous delta-map method in the case where N\u03bd = (Nd( = 1) + 1) + 1. We describe the comparison in Appendix C.\nAll of the numerical codes for the calculations above have been implemented in an extended-deltamap GitHub repository3."
        },
        {
            "heading": "3. Models and simulations",
            "text": "We use simulations to validate our methodology. We use the \u201cPySM\u201d package [31] to produce polarized synchrotron and thermal dust emission maps with direction-dependent spectral parameters. For the synchrotron map, we use the power-law synchrotron model, \u201cs1\u201d, which is based on the Q and U maps from WMAP-9 [32] and the spectral index map from Ref. [33]. For the thermal dust emission map, we use the one-component modified black body (MBB) model, \u201cd1\u201d [34], and the two-component MBB model, \u201cd4\u201d [35], both of which are based on the Planck HFI results. Note that the results used the intensity map in addition to the Q and U polarization maps, and the model adopted common foreground parameters \u03b2d and Td for the\n3https://github.com/YutoMinami/extended-deltamap.\n6/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nTable 1. Polarization sensitivity and beam size of the telescopes similar to the LiteBIRD mission [26]. The parameters in brackets are for the modified high-frequency model used in Sect. 4.4.\nFrequency (GHz) Polarization sensitivity (\u03bcK\u2032) Beam size in FWHM (arcmin)"
        },
        {
            "heading": "40 37.5 69",
            "text": ""
        },
        {
            "heading": "50 24.0 56",
            "text": ""
        },
        {
            "heading": "60 19.9 48",
            "text": ""
        },
        {
            "heading": "68 16.2 43",
            "text": ""
        },
        {
            "heading": "78 13.5 39",
            "text": ""
        },
        {
            "heading": "89 11.7 35",
            "text": ""
        },
        {
            "heading": "100 9.2 29",
            "text": ""
        },
        {
            "heading": "119 7.6 25",
            "text": ""
        },
        {
            "heading": "140 5.9 23",
            "text": ""
        },
        {
            "heading": "166 6.5 21",
            "text": ""
        },
        {
            "heading": "195 5.8 20",
            "text": ""
        },
        {
            "heading": "235 7.7 19",
            "text": ""
        },
        {
            "heading": "280 13.2 24",
            "text": ""
        },
        {
            "heading": "337 (500) 19.5 (67.8) 20 (13.7)",
            "text": ""
        },
        {
            "heading": "402 (600) 37.5 (113.5) 17 (11.5)",
            "text": "Q and U Stokes parameters at each sky pixel. Cosmological CMB maps are generated using the synfast function of the HEALPix package [36] from the power spectra calculated using CAMB [37] with the Planck 2018 cosmological parameters for \u201cTT,TE,EE+lowE+lensing\u201d [2]: bh2 = 0.022 37, ch2 = 0.1200, h = 0.6736, \u03c4 = 0.0544, As = 2.100 \u00d7 10\u22129, and ns = 0.9649. We generate CMB maps with some values of the tensor-to-scalar ratio, r.\nWe use experimental parameters such as frequency bands and angular resolutions similar to the LiteBIRD mission [26] (Table 1). For the input noise, we assume white noise with a standard deviation of \u03c3N = (\u03c0/10 800)(w\u22121/2p /\u03bcK\u2032) \u03bcK str\u22121/2 [28], where we use the \u201cPolarization sensitivity\u201d column of Table 1 for the values of w\u22121/2p .\nWe incorporate the beam smearing effect from the finite angular resolution, whose full-widthhalf-maximum (FWHM) values are given by the \u201cBeam size in FWHM\u201d column of Table 1, by multiplying the spherical harmonics coefficients of the CMB and foreground maps by the corresponding Gaussian beam transfer function for individual frequencies. In this paper, we use the map resolution parameter of Nside = 4 and set max = 2Nside. To ensure that the maps are limited to low resolution, we follow the method described in Ref. [38]; specifically, we deconvolve each frequency map and reconvolve all the maps with a Gaussian 2200 arcmin beam, which is 2.5 times the pixel size of Nside = 4. Even though our method can be applied to higherresolution maps, we choose Nside = 4 (or max = 8), which covers the so-called reionization bump. Since we do not apply any delensing scheme, we cannot effectively increase the sensitivity to r because of the cosmic variance of the lensing B-mode. If we can increase max further to cover the so-called recombination bump, we could increase the sensitivity. However, such high-resolution analysis is limited by our computational resources.\nIn Sect. 4.4, we will show the case in which the frequencies of the two highest-frequency bands are increased. For that, we show the replaced parameters in brackets. The replaced polarization sensitivity and beam size in FWHM are extrapolated using a power-law function.\nSince our method approximates the directional dependence of foreground parameters up to the first order, we need to mask the very bright Galactic plane. We follow Ref. [21] and use the\n7/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nTable 2. Summary of our analysis. Estimated rout values are from the 50th percentile. For rin = 1.0 \u00d7 10\u22122, we use the (16th, 84th) percentiles for the uncertainties. For null rin, we use the 95% C.L. as the upper bounds. \u201c(High)\u201d indicates the result with the \u201cmodified high-frequency model\u201d, where we increase the frequencies of the two highest-frequency bands.\nNumber of bands Input synchrotron Input dust Td prior rin \u00d7 10\u22122 rout \u00d7 10\u22122 3 s1 \u2013 \u2013 1.0 1.00+0.18\u22120.33 9 s1 \u2013 \u2013 1.0 0.99+0.15\u22120.28 3 s1 \u2013 \u2013 0.0 <0.12 (95% C.L.) 9 s1 \u2013 \u2013 0.0 <0.07 (95% C.L.) 4 \u2013 d1 flat 1.0 0.95+1.43\u22120.95 9 \u2013 d1 flat 1.0 1.13+0.61\u22120.49 15 s1 d1 flat 1.0 0.96+0.49\u22120.96 15 s1 d1 1\u03c3 1.0 1.08+0.52\u22120.90 15 s1 d1 10\u22125\u03c3 1.0 1.18+0.50\u22120.83 15 s1 d1 flat 0.0 <1.15 (95% C.L.) 15 s1 d1 1\u03c3 0.0 <1.26 (95% C.L.) 15 (High) s1 d1 flat 1.0 1.40+0.63\u22120.48 15 (High) s1 d1 1\u03c3 1.0 1.41+0.56\u22120.42 15 s1 d4 flat 1.0 2.00+1.09\u22120.85 15 s1 d4 1\u03c3 0.0 2.19+1.26\u22120.93\n\u201cP06 mask\u201d by WMAP polarization analysis, whose fsky = 0.56. Since our method uses pixel space maps, we do not apply any apodization to the mask."
        },
        {
            "heading": "4. Results",
            "text": "We apply our new method to simulated CMB maps with foregrounds. In the following sections, we show the results of estimating the tensor-to-scalar ratio r with CMB + synchrotron (Sect. 4.1), CMB + 1MBB dust (Sect. 4.2), and CMB + 1MBB dust + synchrotron (Sect. 4.3) maps. Recently, it has been shown that shifting the observation bands toward higher frequencies can improve the determination of foreground parameters [27]. Thus, we show the results of estimating the tensor-to-scalar ratio r, with the two highest observation frequencies given in Table 1 shifted even higher, in Sect. 4.4. Finally, we show the results with the two-component dust model as a case of mismodeling of the foreground emissions.\nWe summarize all the estimated rout values for all the setups in Table 2.\n4.1 Estimation with synchrotron radiation foreground only In this section we consider the case where only synchrotron radiation is the foreground source. Because we use a power-law synchrotron radiation model, we need at least three observation bands to fit our parametric model. We first estimate the tensor-to-scalar ratio, r, and synchrotron spectrum index, \u03b2s, with three exact bands \u03bd \u2208 (40, 60, 140) GHz against input rin = 0.01. We show histograms of the estimated r and \u03b2s as blue boxes in the left and right panels of Fig. 1 from 1000 realizations, respectively. The black vertical line shows the naive average of the \u03b2s of the PySM input in the unmasked sky area.\nWe next estimate r and \u03b2s with nine bands \u03bd \u2208 (40, 50, 60, 68, 78, 89, 100, 119, 140) GHz, and show the histograms of the estimated r and \u03b2s in the left and right panels of Fig. 1 in orange,\n8/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nFig. 1. Estimated rout (left) and \u03b2s (right) from 1000 realizations. Blue histograms show the estimates with three bands and orange histograms show the estimates with nine bands.\nFig. 2. Estimated rout from 1000 realizations for null rin. Blue histograms show the estimated results with three bands and orange histograms show those with nine bands.\nrespectively. This is one of the main results of this paper showing that we are free from the constraint of the number of bands that existed in the previous delta-map method. We find that r and \u03b2s are determined better by increasing the number of observation bands.\nWe show the results of the estimation of rout for the case in which rin is null in Fig. 2. We find that r is constrained to rout < 0.12 \u00d7 10\u22122 and rout < 0.07 \u00d7 10\u22122 using three and nine bands, respectively.\n9/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nFig. 3. Histograms of estimated r from 1000 realization samples. Blue box shows the estimated r with four bands. Orange box shows the estimated r with nine bands.\n4.2 Estimation with thermal dust emission foreground only Next, we consider the case where only the thermal dust emission is the foreground source. We choose the one-component modified black body (1MBB) model as the foreground dust model, for which we need at least four bands to fit our parametric model, and we set rin to be 0.01.\nWe first estimate the tensor-to-scalar ratio parameter r and foreground parameters, Td and \u03b2d, with the four exact bands, \u03bd \u2208 (140, 235, 280, 402) GHz. We show the histograms of the estimated rout from 1000 realizations in Fig. 3. We find that the uncertainty on rout is large and the lowest bin is dominant, which reflects the fact that we impose an r \u2265 0 prior on r so that SCMB0 is a positive definite matrix.\nWe show 2D histograms of the estimates of Td and \u03b2d in the left panel of Fig. 4. We find that foreground parameters Td and \u03b2d are not precisely determined with the four bands. The undetermined foreground parameters cause the large error in estimating r.\nThis can be mitigated by increasing the number of frequency bands. We show the estimated rout with nine bands, \u03bd \u2208 (100, 119, 140, 166, 195, 235, 280, 337, 402) GHz, in the orange histogram of Fig. 3, and the estimated Td and \u03b2d with nine bands using the 2D histogram in the right panel of Fig. 4. We find that we can determine foreground parameters well using nine bands, and thereby we can determine rout more precisely.\n4.3 Estimation with thermal dust and synchrotron foreground emissions Finally, we consider the one-component modified black body dust and power-law synchrotron as our foreground models, and estimate the CMB parameter, r, and the foreground parameters, Td, \u03b2d, and \u03b2s. We use all 15 bands in Table 1. Because we found that the number of bands is\n10/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nFig. 4. 2D histograms of estimated dust parameters, \u03b2d vs Td, with four bands (left) and nine bands (right).\nFig. 5. Histograms of estimated rout from 1000 samples. (Left) rout histograms for input rin = 0.01. Blue, orange, and green histograms show the estimated rout with flat, 1\u03c3 , and 10\u22125\u03c3 priors on Td, respectively. (Right) rout histograms for input rin = 0.0. Blue and orange histograms show the estimated rout with flat and 1\u03c3 priors on Td, respectively.\nnot sufficient to determine Td, we impose some priors, Td = 21.8 \u00b1 1\u03c3 K and \u00b11.0 \u00d7 10\u22125\u03c3 K, on Td, where \u03c3 is the standard deviation of the dust temperature measured by Planck [34].\nThe estimated rout values are shown in the left panel of Fig. 5. We find that stronger constraints on Td lead to a more precise estimate of rout. However, the 50th percentile is slightly biased to positive, as shown in Table 2. We can see this bias in the estimation of r for null rin, as shown in the right panel of Fig. 5, which shows that rout is slightly biased to positive and the upper bound with the 95% C.L. becomes larger (Table 2).\n4.4 Modified high-frequency case We next see the results with the modified high-frequency model, which increases the frequencies of the high-frequency bands of telescopes.\nTo see the determination of foreground parameters, we show 2D histograms of \u03b2d and Td for 15 normal bands and 15 modified bands in the left and right panels of Fig. 6, respectively. We find that we can determine the foreground parameters precisely in the case of the modified high-frequency model.\n11/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nFig. 6. 2D histograms of Td vs \u03b2d with 15 normal bands (left) and 15 modified high-frequency bands (right).\nFig. 7. Histograms of rout from 1000 realizations for a flat prior and a 1\u03c3 prior on Td. The input rin = 0.01 and the dust model is 1MBB. The modified high-frequency model is used.\nWe show histograms of rout against rin = 0.01 with a flat prior and a 1\u03c3 prior in Fig. 7 for the modified high-frequency model. Compared to the result with the fiducial frequency band setting shown in the left panel of Fig. 5, the uncertainties on r become much smaller while the 50th percentile values of r are positively biased as shown in Table 2 if the modified high-frequency model is considered. This tendency was also found in Ref. [21]; the smaller uncertainty comes with a larger systematic bias if one sets the foreground frequency bands far away from the CMB bands.\n12/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nFig. 8. Histograms of rout from 1000 realizations. The input rin = 0.01 and the dust model is 2MBB.\n4.5 Mismodeling To demonstrate the case in which we assume a wrong foreground model, we use the twocomponent modified black body (2MBB) model as the input but the 1MBB model to estimate r and the foreground parameters. We show the histograms of the estimated r from 1000 realizations with flat and 1\u03c3 priors on Td in Fig. 8. We find that the estimates of r are biased by \u223c0.01.\nThis bias was not found in our previous paper [21]. This could be because the determinative power of the foreground parameters depends on the number of frequency bands. In Ref. [21], r and 1MBB foreground parameters were estimated using only six bands. Because of the small number of bands used in the analysis, the foreground parameters were not well determined and therefore the bias on r was small. To confirm this argument, we estimated r with seven and 10 bands using the extended delta-map method. The results showed that the bias was small for the case with seven bands, and large with 10 bands as well as with 15 bands.\nWe show 2D histograms of the foreground parameters, Td and \u03b2d, in the left and right panels of Fig. 9 with flat and 1\u03c3 priors on Td, respectively. Without a prior, the estimated Td reaches the bound."
        },
        {
            "heading": "5. Summary and discussion",
            "text": "In this paper, we have improved the \u201cdelta-map method\u201d [21] by constructing a parametric likelihood in a Bayesian way so that more observation bands can be used. By incorporating the covariance of the foreground emission as \u201cvague\u201d, we have extended the method. Sample codes are available at the extended-deltamap GitHub repository https://github.com/Yut oMinami/extended-deltamap.\n13/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nFig. 9. 2D histograms of estimated Td and \u03b2d in the case of mismodeling with flat (left) and 1\u03c3 (right) priors on Td.\nWe have tested the \u201cextended delta-map method\u201d with realistic simulations assuming LiteBIRD-like telescopes. In the case with one foreground component, we find that the extended delta-map method can estimate both the CMB parameter (tensor-to-scalar ratio r) and the foreground parameters, even if we use more frequency bands than the minimum required bands (Sects. 4.1 and 4.2). Moreover, we also found that the parameters of the foreground model are better determined when more observation frequency bands are used, and the tensorto-scalar ratio r is better estimated accordingly. This is an improvement on and benefit compared to the previous delta-map method.\nNext, we apply our method to the model with two foreground components, synchrotron and dust. It turns out that determining dust foreground parameters \u03b2d and Td becomes difficult in this case. The reason for this probably lies in the interplay between the synchrotron and dust foreground emissions. To determine \u03b2d and Td simultaneously, one needs to observe the dust spectrum over a wide frequency range. However, in the two-component foreground model, synchrotron radiation dominates the low-frequency side and masks the dust component, effectively reducing the number of observed frequency bands that can be used to estimate the dust foreground parameters. To aid the determination of the foreground parameter, therefore, we have imposed a prior on dust temperature based on the Planck results. In this case, the error in the estimate of r becomes small, while we have a small positive bias in the estimate. This small bias may indicate that the mean value of Td estimated in the delta-map method is not necessarily the same as Td derived by maps with higher angular resolutions, e.g., Planck.\nA positive bias is also found in the case using a modified band configuration with higher frequencies. If we increase the frequencies of the two highest observation bands, we can determine the foreground parameters better, as we discussed above, while the estimated CMB parameter is biased. This tendency was already found in Ref. [21]. The reason for this is probably the breakdown of the perturbative treatment of the foreground parameters in our method. Although it is easier to remove foreground radiation when the frequency bands are closer to each other, internal template methods, including ours, have the disadvantage of removing the CMB at the same time, resulting in relatively larger noise. Thus, we are faced with the familiar dilemma of systematic and statistical errors that are inherent in statistical analysis.\n14/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nLastly, we test the case with mismodeling by fitting the two-component modified black body model with the one-component modified black body model. We find that the estimated CMB parameter is biased.\nIn this paper, we have not considered detailed characteristics of telescopes or detectors, e.g., the bandpass average discussed in Ref. [21]. We can include the detailed characteristics in the transfer matrices. The basic idea of the delta-map method is to consider the spatial variation of foreground signal parameters perturbatively. Though we have only considered the first-order expansions of spatial variations of foreground parameters, we can consider higher-order expansions, which may improve the estimates of the foreground and CMB parameters. We leave this study for future work."
        },
        {
            "heading": "Acknowledgements",
            "text": "We thank E. Komatsu, A. Nishizawa, Y. Chinone, and S. Takakura for useful discussions. This work is supported in part by the Japan Society for the Promotion of Science (JSPS) KAKENHI, Grants Nos. JP18K03616 (K.I.) and JP20K14497 (Y.M.), JSPS core-to-core program number JPJSCCA20200003 (K.I.), JST AIP Acceleration Research Grant JP20317829 (K.I.), and JST FOREST Program JPMJFR20352935 (K.I.)."
        },
        {
            "heading": "Appendix A. Derivation of likelihood",
            "text": "We use the methodology described in Ref. [30] to deal with the \u201cvague\u201d foreground covariance matrix.\nWhen we marginalize P(\u0303s f , S f ) in Eq. (21), we have\n\u22122 ln P( p\u0304I , \u0303s f , S| m) = ( m \u2212 D\u0303 sF )T ( (SCMB + N) + D\u0303S f D\u0303T)\u22121 ( m \u2212 D\u0303\u0303s f )\n+ n ln 2\u03c0 + ln \u2223\u2223(SCMB + N) + D\u0303S f D\u0303T\u2223\u2223 . (A1) When we assume that the mean of the foreground signal is zero, \u0303s f = 0, we have\n\u22122 ln P( p\u0304I , S| m) = mT(SCMB + N)\u22121 m\n\u2212 mT(SCMB + N)\u22121D\u0303 [ S f \u22121 + D\u0303T(SCMB + N)\u22121D\u0303 ]\u22121 D\u0303T(SCMB + N)\u22121 m\n+ ln |SCMB + N| + ln |S f | + ln \u2223\u2223D\u0303T(SCMB + N)\u22121D\u0303\u2223\u2223 + const. , (A2) where we have used the matrix inversion lemma (B1), (B2).\nWhen we are ignorant about the covariance of the foreground signals, we take the limit where Sf\u22121 \u2192 O and have\n\u22122 ln P( p\u0304I , SCMB0 | m) = mT(SCMB + N)\u22121 m \u2212 mT(SCMB + N)\u22121D\u0303 [D\u0303T(SCMB + N)\u22121D\u0303]\u22121 D\u0303T(SCMB + N)\u22121 m + ln |SCMB + N| + ln \u2223\u2223D\u0303T(SCMB + N)\u22121D\u0303\u2223\u2223 + const. , (A3)\nwhere we discard the terms ln |Sf | following Ref. [30]. This is similar to the likelihood function (Eq. (61) of Ref. [21]) except for the additional term,\nln \u2223\u2223D\u0303(SCMB + N)\u22121D\u0303\u2223\u2223. We will revisit this difference in Appendix C and show that this term is necessary to reproduce the results of Ref. [21].\n15/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nTable A1. Summaries of matrices and the vector defined in this section.\nSymbols Definition A (SCMB0 \u22121 + \u2211N+1j=1 N\u22121\u03bd j )\nH N\u22121D\u0303 [ D\u0303TN\u22121D\u0303 ]\u22121 D\u0303TN\u22121 B A \u2212 DCMBTHDCMB M m \u2212 DCMBA\u22121DCMBTN\u22121 m\nNext, we apply the matrix inversion lemma (B1), (B2) to (SCMB + N)\u22121 and ln |(SCMB + N)|, to reduce the calculation cost of the large covariance matrix. Using (SCMB + N) expressed as (DCMBSCMB0 D\nCMBT + N), we have (SCMB + N)\u22121 = N\u22121 \u2212 N\u22121DCMBA\u22121DCMBTN\u22121 (A4)\nln |SCMB + N| = ln |SCMB0 | + ln |N| + ln |A|, (A5) where we define A = (SCMB0 \u22121 + \u2211N+1j=1 N\u22121\u03bd j ). When we substitute Eqs. (A4) and (A5) into Eq. (A3), we have\n\u22122 ln P( p\u0304I , SCMB0 | m) = mTN\u22121 m \u2212 mTN\u22121DCMBA\u22121DCMB T N\u22121 m \u2212 MTH M \u2212 MTHB\u22121H M\n+ ln |SCMB0 | + ln |N| + ln |D\u0303T N\u22121D\u0303| + ln |B|, (A6) where we define\nM = m \u2212 DCMBA\u22121DCMBTN\u22121 m (A7)\nH = N\u22121D\u0303 [D\u0303TN\u22121D\u0303]\u22121 D\u0303TN\u22121 (A8) B = A \u2212 DCMBTHDCMB. (A9)\nHere we try to keep the symmetry to write down each term because we find that the estimated parameters are biased when we calculate the log-likelihood value using asymmetric terms. Finally, we summarize the newly defined matrices and the vector in Table A1."
        },
        {
            "heading": "Appendix B. Matrix inversion lemma",
            "text": "In the derivation of the likelihood function, we use the Woodbury, Sherman, and Morrison formula, the so-called \u201cmatrix inversion lemma\u201d,(\nZ + UWV T)\u22121 = Z\u22121 \u2212 Z\u22121U (W \u22121 + V TZ\u22121U )\u22121 V Z\u22121, (B1) where Z and W are invertible matrices and U and V are matrices with corresponding dimensions.\nFor log-determinants, a similar equation exists: ln \u2223\u2223Z + UWV T\u2223\u2223 = ln |Z| + ln |W | + ln |W \u22121 + V TZ\u22121U |. (B2)"
        },
        {
            "heading": "Appendix C. Comparison of likelihood",
            "text": "In this section, we show that the estimated parameters with Eq. (22) are equivalent to those estimated from Eq. (C4) in the case in which we assume one foreground component and one parameter, \u03b2, where the number of frequencies is N\u03bd = (Nd( = 1) + 1) + 1 = 3.\n16/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nThe cleaned CMB map (14) can also be expressed as [ D\u22121 m ] CMB, where the subscript \u201cCMB\u201d\nmeans that we take the elements related to the CMB, as described above Eq. (50) in Ref. [21]. First, let us calculate this cleaned CMB map. The elements of the D matrix are\nD = [ DCMB D\u0303 ]\n= \u23a1 \u23a2\u23a3I g\u03bd1D\u03bd1I g\u03bd1D\u03bd1,\u03b2II g\u03bd2D\u03bd2I g\u03bd2D\u03bd2,\u03b2I\nI g\u03bd3D\u03bd3I g\u03bd3D\u03bd3,\u03b2I\n\u23a4 \u23a5\u23a6. (C1)\nThe inverse matrix of D is\nD\u22121 = \u22121| DCMB| \u23a1 \u23a2\u23a3 \u2212\u03be23I \u2212\u03be31I \u2212\u03be12I(g\u03bd2D\u03bd2,\u03b2 \u2212 g\u03bd3D\u03bd3 )I (\u2212g\u03bd1D\u03bd1,\u03b2 + g\u03bd3D\u03bd3,\u03b2 )I (g\u03bd1D\u03bd1,\u03b2 \u2212 g\u03bd2D\u03bd2,\u03b2 )I\n(\u2212g\u03bd2D\u03bd2 + g\u03bd3D\u03bd3 )I (g\u03bd1D\u03bd1 \u2212 g\u03bd3D\u03bd3 )I (\u2212g\u03bd1D\u03bd1 + g\u03bd2D\u03bd2 )I\n\u23a4 \u23a5\u23a6,\n(C2) where = ( \u03be23I \u03be31I \u03be12I ) . Then the cleaned CMB map can be expressed as\nCMBML(n\u0302) = [D\u22121 m]CMB = ( DCMB)\u22121 m. (C3)\nThe corresponding covariance matrix (17) is calculated as C = SCMB0 + |K|( DCMB)\u22121( DCMB)\u22121 (C4) where K = N T.\nTherefore, we can write the likelihood function used in Ref. [21] as\n\u22122 lnL = (( DCMB)\u22121 m)T (SCMB0 + |K|( DCMB)\u22121( DCMB)\u22121)\u22121 ( DCMB)\u22121 m. (C5)\nWe will show that Eq. (22) is equal to this equation. First, we calculate D\u0303TN\u22121D\u0303 matrix and its determinant as\nD\u0303TN\u22121D\u0303 = [ \u2211 i N \u22121 i g 2 \u03bdi D2\u03bdi \u2211 i N \u22121 i g\u03bdi D\u03bdi D\u03bdi,\u03b2\u2211\ni N \u22121 i g\u03bdi D\u03bdi D\u03bdi,\u03b2\n\u2211 i N \u22121 i g 2 \u03bdi D2\u03bdi,\u03b2\n] (C6)\n\u2223\u2223D\u0303TN\u22121D\u0303\u2223\u2223 = |K|\u220f i |N\u22121i |. (C7)\nUsing them, we have\nH = 1|K|\n\u23a1 \u23a2\u23a3N \u22121 1 ( N3\u03be 212 + N2\u03be 231 ) I \u2212\u03be31\u03be23I \u2212\u03be12\u03be23I \u2212\u03be31\u03be23I N\u221221 ( N1\u03be 223 + N3\u03be 212 ) I \u2212\u03be12\u03be31I\n\u2212\u03be12\u03be23I \u2212\u03be12\u03be31I N\u221231 ( N2\u03be 231 + N1\u03be 223 ) I\n\u23a4 \u23a5\u23a6\n= N\u22121 \u2212 T\n|K| . (C8)\nThen we have\nB = A \u2212 DCMBT ( N\u22121 \u2212 T |K| ) DCMB\n= SCMB0 \u22121 + D\nCMBT T DCMB\n|K| , (C9)\n17/20\nD ow nloaded from https://academ ic.oup.com /ptep/article/2023/3/033E01/7008913 by Indian Institute of Technology Patna user on 18 January 2024\nand its inverse as B\u22121 = ( SCMB0 \u22121 + D CMBT T DCMB\n|K|\n)\u22121\n= |K|( DCMB)\u22121( DCMB)\u22121SCMB0 ( SCMB0 + |K|( DCMB)\u22121( DCMB)\u22121 )\u22121 = |K|( DCMB)\u22121( DCMB)\u22121SCMB0 C\u22121\n( = A\u22121 + B\u22121DCMBTHDCMBA\u22121) ( = A\u22121 + A\u22121DCMBTHDCMBB\u22121). (C10)\nTherefore, we can rewrite Eq. (22) as \u22122 ln P( p\u0304I , SCMB0 | m) = mTN\u22121 m \u2212 mTN\u22121DCMBA\u22121DCMB T N\u22121 m \u2212 MTH M\n\u2212 MHDCMBB\u22121DCMBTH M + ln |SCMB0 | + ln |N| + ln |D\u0303T N\u22121D\u0303| + ln |B|\n= mTN\u22121 m \u2212 mTN\u22121DCMBA\u22121DCMBTN\u22121 m \u2212 mTH m + 2 mTHDCMBA\u22121DCMBTN\u22121 m \u2212 mTN\u22121DCMBA\u22121DCMBTHDCMBA\u22121DCMBTN\u22121 m \u2212 mTHDCMBB\u22121DCMBTH m + 2 mHDCMBB\u22121DCMBTHDCMB\n\u00d7 A\u22121DCMBTN\u22121 m \u2212 mN\u22121DCMBA\u22121DCMBTHDCMBB\u22121DCMBT\n\u00d7 HDCMBA\u22121DCMBTN\u22121 m + 2 ln | DCMB| + ln |C|\n= mT( DCMB)\u22121 I \u2212 S CMB 0 C \u22121\n|K| ( D CMB)\u22121 m + 2 ln | DCMB| + ln |C|\n= CMBML(n\u0302)TC\u22121CMBML(n\u0302) + 2 ln | DCMB| + ln |C|. (C11) This agrees with Eq. (C4) except for the term ln | DCMB|. This does not change the estimated parameters, since, in Ref. [21], the foreground parameters are determined only with the chisquared term and the CMB parameters are determined with the total likelihood function by fixing the foreground parameter."
        }
    ],
    "title": "Extended delta-map: A map-based foreground removal method for CMB polarization observations",
    "year": 2023
}