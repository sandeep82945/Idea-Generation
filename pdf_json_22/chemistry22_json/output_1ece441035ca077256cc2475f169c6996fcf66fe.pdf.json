{
    "abstractText": "Accurate decomposition of the mixed Mn oxidation states is highly important for characterizing the electronic structures, charge transfer and redox centers for electronic, electrocatalytic and energy storage materials that contain Mn. Electron energy loss spectroscopy (EELS) and soft X-ray absorption spectroscopy (XAS) measurements of the Mn L2,3 edges are widely used for this purpose. To date, although the measurement of the Mn L2,3 edges are straightforward given the sample is prepared properly, an accurate decomposition of the mix valence states of Mn remains non-trivial. For both EELS and XAS, 2+, 3+, 4+ references spectra need to be taken on the same instrument/beamline and preferably in the same experimental session because the instrumental resolution and the energy axis offset could vary from one session to another. To circumvent this hurdle, in this study, we adopted a deep learning approach and developed a calibration-free and reference-free method to decompose the oxidation state of Mn L2,3 edges for both EELS and XAS. To synthesize physics-informed and ground-truth labeled training datasets, we created a forward model that takes into account plural scattering, instrumentation broadening, noise and energy axis offset. With that, we created a 1.2 million-spectrum database with a three-element oxidation state composition label. The library includes a sufficient variety of data including both EELS and XAS spectra. By training on this large database, our convolutional neural network achieves 85% accuracy on the validation dataset. We tested the model and found it is robust against noise (down to PSNR of 10) and plural scattering (up to t/\u03bb = 1). We further validated the model against spectral data that were not used in training. In particular, the model shows high accuracy and high sensitivity for the decomposition of Mn3O4, MnO, Mn2O3 and MnO2. In particular, the accurate decomposition of Mn3O4 experimental data shows the model is quantitatively correct and can be deployed for real experimental data. Our model will not only be a valuable tool to researchers and materials scientists but also can assist experienced electron microscopists and synchrotron scientists in automated analysis of Mn L edge data.",
    "authors": [
        {
            "affiliations": [],
            "name": "Huolin L. Xin"
        },
        {
            "affiliations": [],
            "name": "Mike Hu"
        }
    ],
    "id": "SP:6c1744a9efef07075bf37d9df193bb859c40f7a8",
    "references": [
        {
            "authors": [
                "J.G. Chen"
            ],
            "title": "NEXAFS investigations of transition metal oxides, nitrides, carbides, sulfides and other interstitial compounds",
            "venue": "Surface Science Reports",
            "year": 1997
        },
        {
            "authors": [
                "R.F. Egerton"
            ],
            "title": "Electron energy-loss spectroscopy in the TEM",
            "venue": "Reports on Progress in Physics",
            "year": 2009
        },
        {
            "authors": [
                "V.J. Keast",
                "A.J. Scott",
                "R. Brydson",
                "D.B. Williams",
                "J. Bruley"
            ],
            "title": "Electron energyloss near-edge structure \u2013 a tool for the investigation of electronic structure on the nanometre scale",
            "venue": "Journal of Microscopy",
            "year": 2001
        },
        {
            "authors": [
                "R.D. Leapman",
                "L.A. Grunes",
                "P.L. Fejes"
            ],
            "title": "Study of the ${L}_{23}$ edges in the $3d$ transition metals and their oxides by electron-energy-loss spectroscopy with comparisons to theory",
            "venue": "Physical Review B",
            "year": 1982
        },
        {
            "authors": [
                "L.A.J. Garvie",
                "P.R. Buseck"
            ],
            "title": "Ratios of ferrous to ferric iron from nanometresized areas in minerals",
            "venue": "Nature 396,",
            "year": 1998
        },
        {
            "authors": [
                "L. Fitting Kourkoutis",
                "Y. Hotta",
                "T. Susaki",
                "H.Y. Hwang",
                "D.A. Muller"
            ],
            "title": "Nanometer Scale Electronic Reconstruction at the Interface between ${\\mathrm{LaVO}}_{3}$ and ${\\mathrm{LaVO}}_{4}$",
            "venue": "Physical Review Letters",
            "year": 2006
        },
        {
            "authors": [
                "Mundy",
                "J. A"
            ],
            "title": "Visualizing the interfacial evolution from charge compensation to metallic screening across the manganite metal\u2013insulator transition",
            "venue": "Nature Communications",
            "year": 2014
        },
        {
            "authors": [
                "C.M. Pate",
                "J.L. Hart",
                "M.L. Taheri"
            ],
            "title": "RapidEELS: machine learning for denoising and classification in rapid acquisition electron energy loss spectroscopy",
            "venue": "Scientific Reports",
            "year": 1951
        },
        {
            "authors": [
                "M. Chatzidakis",
                "G.A. Botton"
            ],
            "title": "Towards calibration-invariant spectroscopy using deep learning",
            "venue": "Scientific Reports",
            "year": 2019
        },
        {
            "authors": [
                "L.A.J. Garvie",
                "A.J. Craven"
            ],
            "title": "High-resolution parallel electron energy-loss spectroscopy of Mn L2,3-edges in inorganic manganese compounds",
            "venue": "Physics and Chemistry of Minerals",
            "year": 2021
        },
        {
            "authors": [
                "J Lee"
            ],
            "title": "Valence-state transition in ${\\text{SrMn}}_{1\\ensuremath{-}x}{\\text{Mo}}_{x}{\\text{O}}_{3}$ $(0\\ensu remath{\\le}x\\ensuremath{\\le}0.5)$ investigated by soft x-ray absorption spectroscopy",
            "venue": "Physical Review B",
            "year": 2009
        },
        {
            "authors": [
                "C Mitra"
            ],
            "title": "Direct observation of electron doping in ${\\mathrm{La}}_{0.7}{\\mathrm{Ce}}_{0.3}{\\mathrm{MnO}}_{3}$ using xray absorption spectroscopy",
            "venue": "Physical Review B",
            "year": 2003
        },
        {
            "authors": [
                "S Nemrava"
            ],
            "title": "Three Oxidation States of Manganese in the Barium Hexaferrite BaFe12\u2013xMnxO19",
            "venue": "Inorganic Chemistry",
            "year": 2017
        },
        {
            "authors": [
                "R. Qiao",
                "T. Chin",
                "S.J. Harris",
                "S. Yan",
                "W. Yang"
            ],
            "title": "Spectroscopic fingerprints of valence and spin states in manganese oxides and fluorides",
            "venue": "Current Applied Physics",
            "year": 2012
        }
    ],
    "sections": [
        {
            "heading": "MnEdgeNet\u2014Accurate Decomposition of Mixed Oxidation States for",
            "text": "Mn XAS and EELS L2,3 Edges without Reference and Calibration Huolin L. Xin*, Mike Hu Department of Physics and Astronomy, University of California, Irvine, CA 92697, United States *Correspondence should be addressed to H.L.X. (huolin.xin@uci.edu) Abstract: Accurate decomposition of the mixed Mn oxidation states is highly important for characterizing the electronic structures, charge transfer and redox centers for electronic, electrocatalytic and energy storage materials that contain Mn. Electron energy loss spectroscopy (EELS) and soft X-ray absorption spectroscopy (XAS) measurements of the Mn L2,3 edges are widely used for this purpose. To date, although the measurement of the Mn L2,3 edges are straightforward given the sample is prepared properly, an accurate decomposition of the mix valence states of Mn remains non-trivial. For both EELS and XAS, 2+, 3+, 4+ references spectra need to be taken on the same instrument/beamline and preferably in the same experimental session because the instrumental resolution and the energy axis offset could vary from one session to another. To circumvent this hurdle, in this study, we adopted a deep learning approach and developed a calibration-free and reference-free method to decompose the oxidation state of Mn L2,3 edges for both EELS and XAS. To synthesize physics-informed and ground-truth labeled training datasets, we created a forward model that takes into account plural scattering, instrumentation broadening, noise and energy axis offset. With that, we created a 1.2 million-spectrum database with a three-element oxidation state composition label. The library includes a sufficient variety of data including both EELS and XAS spectra. By training on this large database, our convolutional neural network achieves 85% accuracy on the validation dataset. We tested the model and found it is robust against noise (down to PSNR of 10) and plural scattering (up to t/\u03bb = 1). We further validated the model against spectral data that were not used in training. In particular, the model shows high accuracy and high sensitivity for the decomposition of Mn3O4, MnO, Mn2O3 and MnO2. In particular, the accurate decomposition of Mn3O4 experimental data shows the model is quantitatively correct and can be deployed for real experimental data. Our model will not only be a valuable tool to researchers and materials scientists but also can assist experienced electron microscopists and synchrotron scientists in automated analysis of Mn L edge data."
        },
        {
            "heading": "Introduction",
            "text": "X-ray absorption spectroscopy (XAS)1 and electron energy loss spectroscopy (EELS)2,3 are two techniques that can probe the unoccupied electronic states providing bonding information of materials. In particular, the L2,3 edges are widely used to determine the oxidation state of transition metals1,4,5. The transition metal L2,3 edges probe the unoccupied d orbitals and therefore the edge onset and the edges\u2019 fine structures and shapes are sensitive to the oxidation state of the d-block metal ions, in particular the 3d transition\nmetals, such as V, Ti, Mn, Fe, and Ni5-8. For example, using the near edge fine structures in the Mn L2,3 edges, the oxidation states of Mn ions in a material can be determined by decomposing the spectrum into a linear combination of Mn2+, Mn3+, and Mn4+ reference spectra9,10. This decomposition, in principle, is simple but in reality, it is non-trivial because the energy axis is not always calibrated, and the instrument/beamline does not always have the instrumental broadening. Without proper calibration, an energy offset is present between the experimental spectrum and the references which prevents accurate oxidation states decomposition. In order to avoid the problem, standard reference samples such as MnO, Mn2O3, MnO2 need to be measured in the same experimental session to avoid any energy offsets as well as change in instrumental broadening9,11. Still with this procedure, there are other factors that could prevent the proper energy axis calibration for example temperature fluctuations would result in an energy shift in the monochromator. Basically, if the XAS measurements are separated multiple hours in time, the spectra taken could have a slight energy offset. In EELS, the energy offset could change more rapidly and is more unpredictable than XAS. Typically, the energy offset is very sensitive to the DC stray field. For example, the passing of a truck or the movement of a nearby elevator, all could change the energy offset if the TEM is not fully shielded. This problem is now mitigated with the dualEELS instruments but there are still many single EELS instruments under active service. Moreover, all historical data were acquired without the dualEELS correction. In addition, nonlinearity of parallel EELS spectrometer is present in EELS in a nontrivial way because the nonlinearity is not only present in the dispersion device, i.e. the magnetic prism. There is another complex nonlinearity present in the magnification lenses, a series of quadrupole. Therefore, it is extremely difficult to calibrate the energy onset of EELS edges unless strict protocols are followed as described by Tan et al11. Another complication is that EELS\u2019 near-edge fine structures change with sample thickness due to plural scattering. As the sample gets thicker, signals close to the edge onset would be multiple scattered to higher energy losses. This would result in a shape change of the spectrum11. For example, for latter 3d transition metals\u2019s L2,3 edges, as the sample gets thicker, the L2/L3 ratio increases\u2014this problem has rendered the reference-free L2,3 ratio method inaccurate for EELS11. In addition, for XAS, the background and the near edge structures could be different between the TEY and TFY modes. That also renders the L2,3 ratio method unreliable. Moreover, for early 3d transition metals, there are no established reference-free methods because of the L2,3 anomaly. For both EELS and XAS spectroscopy, one interesting observation is that human operators with sufficient training can identify spectral features and assign oxidation states to transition metal L2,3 edges with high confidence. This points to the direction that deep learning could be successful in solving the L2,3 oxidation state decomposition problem. Pate et al in 2021 discussed using deep learning to denoise high frame rate spectra.12 Chatzidakis and Botton in 2019 introduced the idea of translation-invariance for classifying EELS edges.13 They built a convolutional neural network (CNN) for oxidation state classification and showed that with a translation-invariant training, moving the energy axis does not change the Mn 2+, 3+, 4 oxidation state classification. This is a very important step in demonstrating that spectral features are like spatial features in images\u2014they can be classified by a CNN network regardless of their absolute energy positions in the spectrum.\nHowever, there are still problems remained to be resolved: 1) how to quantitatively decompose mixed oxidation states; 2) is it possible to build one model that work for both XAS and EELS spectroscopy that have drastically different energy resolution; 3) is it possible to build a model that is not affected by plural scattering, i.e. the thickness effect in EELS. To address the three challenges defined above, in this study, we present a reference-free, calibration-free deep learning approach to determine the accurate oxidation states decomposition of 3d transition metal based on the L2,3 near edge fine structures. To demonstrate the validity of the method, in this study, we use Mn as an example because Mn is technologically important in catalysis, energy storage and electronic materials. Determining the composition of the mixed oxidation states is extremely important for understanding the charge transfer phenomenon happening at the device interfaces. The method we present in this study is not a simple classification of Mn2+, 3+ and 4+ edges but an accurate and quantitative decomposition of the mixed Mn oxidation states. Instead of having a classification/binary type label, we created a three-element ground truth vector that quantitatively describe the composition of Mn2+, 3+ and 4+ in each Mn spectrum, i.e. [%Mn2+, %Mn3+, %Mn4+]. To achieve this goal, we built a 1.2 million-spectrum ground truth labeled library with 50% XAS data and 50% EELS data. In building the mixed oxidation state library, we paid special attention to normalizing the Mn L2,3 edges correctly, and including experimentallike uncertainties such as both Gaussian and Lorentzian type instrumental broadening, energy offset and detector noise. To include the plural scattering effect in the training library, we developed a forward model to correctly introduce the thickness effect to the L2,3 edges. Using this physics-informed large training library, we show that the deep convolutional regression model we trained is robust against plural scattering and noise. The overall accuracy of model in determining the mixed valence state reaches 85% on the validation data set. We also validated the data on \u201cunknown unknowns\u201d, i.e. Mn3O4 spectra that have never been used for training\u2014the accurate decomposition of Mn3O4 experimental data shows the model is quantitatively correct and can be deployed for real experimental data."
        },
        {
            "heading": "Methods",
            "text": "In this method section, we will describe 1) how to build a ground-truth oxidation state labeled Mn edge library, 2) how to construct the neural network, and 3) how to train it. For building the library, the technical challenges lie in 1) how to obtain a wide variety of XAS and EELS Mn2+, Mn3+, Mn4+ reference spectra; 2) how to normalize or ratio the 2+, 3+ and 4+ spectra correctly; 3) how to include the EELS\u2019s plural scattering effect (thickness effect) into the training sets; 4) how to include the various experimental uncertainties including instrumental broadening, energy offset, detector noise, etc. In the following subsections, we will address each aforementioned challenge."
        },
        {
            "heading": "Collection of Mn reference spectra",
            "text": "To have sufficient varieties of data that can capture the features of the EELS and XAS Mn 2+, 3+ and 4+ edges, in this study, we digitized a large number of experimental EELS and XAS Mn spectra that were documented in the literature. In Figure 1, we presented all spectra that were used for making the training library. (The Mn 2.67+ spectrum was not included in the training library.) In Table 1, we listed the compounds for which we digitized the spectra and their original references. All data are standardized to range from 630.5 eV to 669.4 eV with 0.1 eV increments (338 data points). For missing data, the left side of the spectra is padded with zero and the right side is padded with the end value of the spectra. Fig xx shows examples of the standardized data."
        },
        {
            "heading": "Normalization of 2+, 3+, 4+ reference spectra",
            "text": "In order to quantitatively combine the 2+, 3+, and 4+ Mn spectra, they need to be normalized them to the correct ratio. To achieve that, we normalize the Mn L3 edge according to the d-hole number. Elemental Mn has an electron configuration of [Ar] 3d5 4s2. Therefore, Mn2+, 3+, 4+ have an electron configuration of [Ar] 3d5, [Ar] 3d4, [Ar] 3d3. Because d shell can hold 10 electrons, the number of d holes for Mn 2+, 3+ and 4+ are 5, 6, 7 respectively. Therefore, the area under the L3 peak and above the continuous background shall be proportional to the d hole number. The continuous background under the L2,3 edge can be modeled by two step functions with a step height that follows the 1:2 population ratio. (The filled 2p3/2, 2p1/2 orbitals have a population ratio of 1:2). The d hole area can be calculated after the background is subtracted from the spectrum (Figure 2). With this procedure to find the d-hole area, we can correctly ratio the 2+, 3+ and 4+ spectra.\nGround truth labeled library After the d-hole ratio normalization, we can correctly combine the Mn 2+, 3+ and 4+ component spectra to form a new spectrum with the known ground truth oxidation state composition and oxidation state as the following\n\ud835\udc60\ud835\udc60 = \ud835\udc65\ud835\udc65\ud835\udc65\ud835\udc65\ud835\udc5b\ud835\udc5b2+ + \ud835\udc66\ud835\udc66\ud835\udc65\ud835\udc65\ud835\udc5b\ud835\udc5b3+ + \ud835\udc67\ud835\udc67\ud835\udc65\ud835\udc65\ud835\udc5b\ud835\udc5b4+ \ud835\udc64\ud835\udc64\u210e\ud835\udc52\ud835\udc52\ud835\udc52\ud835\udc52\ud835\udc52\ud835\udc52 \ud835\udc65\ud835\udc65 + \ud835\udc66\ud835\udc66 + \ud835\udc67\ud835\udc67 = 1\nground truth oxidation state composition = [x, y, z] ground truth average oxidation state = 2x + 3y + 4z.\nIn making the ground truth labeled spectra, we only combined Mn spectral components that were digitalized from the same publication source. The reason being that the spectra to be combined shall share the same instrumental resolution. The composition of the training library is detailed in Table 2. A total of 1,210,000 synthetic spectra are included in the library.\nThree components (2+, 3+, 4+)\n48.75% 50% EELS and 50% XAS"
        },
        {
            "heading": "Instrumental broadening",
            "text": "The instrumental broadening of EELS spectra includes two major contributions. The first contribution primarily comes from the thermal broadening at the electron source and the first cross over due to the space-charge effect. This type of broadening is typically characterized by a Gaussian type broadening function. The second contribution happens at the detector. The light diffusion in the sinterlator and the optical coupler introduce a longtail broadening effect which can be characterized by a Lorentzian function. For XAS, similar short range and long-range broadening happens due to the monochromator. Therefore, we introduce a two-parameter controlled instrument broadening kernel aka the point spread function, PSF(E) as the following PSF(E, w, \u03c3) = L(E,w) \u2297 G(E,\u03c3) where \u2297 stands for convolution\n\ud835\udc3f\ud835\udc3f(\ud835\udc38\ud835\udc38, \ud835\udc64\ud835\udc64) = 1 \ud835\udf0b\ud835\udf0b 1/2\ud835\udc64\ud835\udc64 \ud835\udc38\ud835\udc382 + (1/2\ud835\udc64\ud835\udc64)2\nand\n\ud835\udc3a\ud835\udc3a(\ud835\udc38\ud835\udc38, \ud835\udf0e\ud835\udf0e) = 1\n\ud835\udf0e\ud835\udf0e\u221a2\ud835\udf0b\ud835\udf0b \ud835\udc52\ud835\udc52\n\u221212( \ud835\udc38\ud835\udc38\n\ud835\udf0e\ud835\udf0e\u221a2 )\nBasically, the instrumental point spread function is a convolution of a Gaussian function with a Lorentzian function. The full width at maximum (FWHM) of the Lorentzian function is w and the FWHM of the Gaussian function is 2\ufffd2\ud835\udc59\ud835\udc59\ud835\udc5b\ud835\udc5b(2)\ud835\udf0e\ud835\udf0e . The combined FWHM is equal to \ufffd\ud835\udc39\ud835\udc39\ud835\udc39\ud835\udc39\ud835\udc39\ud835\udc39\ud835\udc65\ud835\udc65\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f + \ud835\udc39\ud835\udc39\ud835\udc39\ud835\udc39\ud835\udc39\ud835\udc39\ud835\udc65\ud835\udc65\ud835\udc3a\ud835\udc3a\ud835\udc3f\ud835\udc3f\ud835\udc3a\ud835\udc3a\ud835\udc3a\ud835\udc3a\ud835\udc3a\ud835\udc3a\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f . It is worth noting that the inclusion of the Lorentzian tails in the point spread kernel is very important for making the synthesized spectra resemble the experimental ones. An example of such broadening effect on a Mn2+ L2,3 edge is shown in Figure 3."
        },
        {
            "heading": "Plural scattering in EELS",
            "text": "If the single scattering probability function is P(E), plural scattering as a function of thickness, t, in EELS can be described by the following differential equation\n\ud835\udc51\ud835\udc51\ud835\udc51\ud835\udc51(\ud835\udc38\ud835\udc38, \ud835\udc61\ud835\udc61) \ud835\udc51\ud835\udc51\ud835\udc61\ud835\udc61 = \ufffd \ud835\udc51\ud835\udc51(\ud835\udc38\ud835\udc38\u2032)\ud835\udc43\ud835\udc43(\ud835\udc38\ud835\udc38 \u2212 \ud835\udc38\ud835\udc38\u2032)\ud835\udc51\ud835\udc51\ud835\udc38\ud835\udc38\u2032\nand the boundary condition is \ud835\udc51\ud835\udc51(\ud835\udc38\ud835\udc38, \ud835\udc61\ud835\udc61 = 0) = \ud835\udeff\ud835\udeff(\ud835\udc38\ud835\udc38) in the ideally monochromatic condition. In the practical situation where the incoming electron has an energy spread, we can use the point spread function given in the last section as the initial energy profile, i.e.\n\ud835\udc51\ud835\udc51(\ud835\udc38\ud835\udc38, \ud835\udc61\ud835\udc61 = 0) = \ud835\udc43\ud835\udc43\ud835\udc51\ud835\udc51\ud835\udc38\ud835\udc38(\ud835\udc38\ud835\udc38, \ud835\udc64\ud835\udc64, \ud835\udf0e\ud835\udf0e) Once we obtain a numerical representation of P(E), the spectral function, S(E, t) at any given thickness, t can be numerically calculated. Using this equation, it allows us to calculate the low-loss spectral function numerically. Once we obtain the low-loss spectral function, the core-loss spectrum is a convolution of the core-loss single scattering probably distribution, \ud835\udc43\ud835\udc43\ud835\udc50\ud835\udc50\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\ud835\udc3f\u2212\ud835\udc59\ud835\udc59\ud835\udc3f\ud835\udc3f\ud835\udc3a\ud835\udc3a\ud835\udc3a\ud835\udc3a(\ud835\udc38\ud835\udc38) , with the low-loss spectral function, i.e. \ud835\udc51\ud835\udc51(\ud835\udc38\ud835\udc38, \ud835\udc61\ud835\udc61). Figure 4 shows the change of the low-loss function as function of normalized thickness (\ud835\udc61\ud835\udc61/\ud835\udf06\ud835\udf06, \ud835\udf06\ud835\udf06 is the inelastic mean free path) and how the Mn L2,3 edge evolves. In this modeling, we use an average plasmon loss energy of 25 eV and approximate the P(E) by an asymmetric function where the left side is a Gaussian function, and the right size is a Lorentzian loss function. To be more exact, we also modeled the Mn M edge and superimposed it onto the plasmon loss.\nOther augmentations: energy shift and noise Both EELS and XAS are subject to the issues of inaccurate energy axis. To take this into account, we apply a random shift augmentation of the energy axis for the ground truth labeled spectra. With this augmentation, the model become translation invariant\u2014it is only\nsensitive to the spectral shape and it is insensitive to the absolute energy onset of the L2,3 edge. For noise, we have modeled the noise as a white noise (Gaussian noise) with a salt and pepper noise (impulse noise). Both noises are additive to the spectrum. We use the linear definition of PSNR as:\n\ud835\udc43\ud835\udc43\ud835\udc51\ud835\udc51\ud835\udc43\ud835\udc43\ud835\udc43\ud835\udc43 = \ud835\udc65\ud835\udc65\ud835\udc40\ud835\udc40\ud835\udc65\ud835\udc65 \ud835\udc51\ud835\udc51\ud835\udc46\ud835\udc46\ud835\udc46\ud835\udc46\ud835\udc5b\ud835\udc5b\ud835\udc40\ud835\udc40\ud835\udc59\ud835\udc59\n\ufffd\ud835\udc65\ud835\udc65\ud835\udc52\ud835\udc52\ud835\udc40\ud835\udc40\ud835\udc5b\ud835\udc5b \ud835\udc51\ud835\udc51\ud835\udc52\ud835\udc52\ud835\udc46\ud835\udc46\ud835\udc46\ud835\udc46\ud835\udc40\ud835\udc40\ud835\udc52\ud835\udc52\ud835\udc52\ud835\udc52 \ud835\udc38\ud835\udc38\ud835\udc52\ud835\udc52\ud835\udc52\ud835\udc52\ud835\udc5f\ud835\udc5f\ud835\udc52\ud835\udc52"
        },
        {
            "heading": "Summary of augmentation",
            "text": "In the table below, we summarize the augmentation operations done to the ground truth labeled library."
        },
        {
            "heading": "Network structure",
            "text": "How our brains process or identify a spectral feature is very similar to recognizing spatial features in an image. Inspired by this, we adopted the convolution layers that are used in image classification for feature extraction. Then we connected the features with a fully connected layer (also known as dense layers) for composition regression. The input is the one-dimensional spectrum, and the output is a 3-element composition vector (Figure 5). We call this network a convolutional regression net (CRN). Different from a classification network, a regression network\u2019s outputs are continuous numbers rather than binary number. Therefore, we used the mean square error function as the loss function. For feature extractions, we use three convolutional layers followed by leaky relu and maxpooling. The final layer outputs 41*128=5248 filtered features. In the regression layers, we used three fully connected layers with 2048, 512 and then 3 neurons with leaky relu in between. The final output is a softmax normalization of the final 3-neuron layer to ensure\nthat sum of the composition vector is equal to 1."
        },
        {
            "heading": "Training",
            "text": "All spectra are subtracted by the mean and divided by the standard deviation before entering the network. Dropout are added to each layer before maxpooling with a dropout rate of 0.1. Adam, an algorithm for first-order gradient-based optimization of stochastic objective functions, based on adaptive estimates of lower-order moments was used for learning. The learning rate is set at 8E-5. Batch size is 32. As shown in Fig. xx, the model converges quickly; therefore, only 3 epochs of training was done to avoid overfitting."
        },
        {
            "heading": "Validation",
            "text": "We performed a 20/80 split of the ground truth labeled library into training and validation\ndata sets. The accuracy of the model is evaluated on the validation set. An accurate prediction is defined as that the predicted oxidation state falls in \u00b10.1 of the ground truth oxidation state. We also evaluated our model on known knowns, unknown knowns and unknown unknowns data sets. Known knowns are the data used to build the training data. The unknown knowns are the data with various augmentations such as noise and plural scattering. The unknown unknowns are new experimental data that were never used for training."
        },
        {
            "heading": "Result & Discussion",
            "text": "Performance of the model on the validation set. On the validation set, the trained model reports an accuracy of 85%. Figure 7shows the scatter plot of the prediction versus the ground truth (2000 spectra were randomly selected from the validation set). The result shows that the model performs reasonably well on the validation data.\nground truth. To more closely look at the performance of the predicted decomposition, we provide a table of the predicted composition as shown in Table 4. It shows that the decomposition is reasonably accurate on the validation dataset.\nMnF2 99.69, 0.31, 0.0 2.0\nMnF3 0.66, 98.87, 0.48 3.0\nMnO 98.05, 1.85, 0.1 2.02\nMnO2 0.45, 4.67, 94.88 3.94\nMnO 99.6, 0.37, 0.03 2.0\nMnV2O4 99.42, 0.21, 0.37 2.01\nMnOOH 0.18, 98.03, 1.79 3.02\nCaMnO3 0.0, 2.4, 97.6 3.98\nMnO2 0.0, 0.01, 99.98 4.0\nSrMnO3 0.0, 0.06, 99.94 4.0\n75% Mn3+OOH +25%Mn4+O2\n0.09, 73.45, 26.46 3.26\n75% Mn3+OOH + 25% SrMn4+O3 0.25, 70.55, 29.2 3.29\n60% Mn4+O2 + 40% SrMn4+O3 0.0, 0.02, 99.98 4.0\nPlural scattering. To show how the model performs with the interference of plural scattering, we tested the thickness effect on MnO, Mn2O3, and MnO2. As shown in Table 5, the results are accurate up to 1.5 inelastic mean free path (\u03bb) which is larger than maximum augmentation range used in the training dataset.\n2 [94.27, 4.14, 1.59] 2.07\n2.5 [88.33, 4.42, 7.25] 2.19\n3 [80.74, 3.14, 16.12] 2.35\nMn2O3\n0 [0.66, 99.13, 0.21] 3.0\n0.1 [0.57, 99.21, 0.22] 3.0\n0.3 [0.6, 99.19, 0.21] 3.0\n0.5 [0.69, 99.07, 0.24] 3.0\n0.8 [1.25, 98.46, 0.28] 2.99\n1 [2.2, 97.54, 0.26] 2.98\n1.5 [12.87, 86.66, 0.48] 2.88\n2 [43.15, 55.66, 1.19] 2.58\n2.5 [52.78, 44.89, 2.33] 2.5\n3 [59.93, 36.5, 3.57] 2.44\nMnO2\n0 [0.0, 0.01, 99.98] 4.0\n0.1 [0.0, 0.03, 99.97] 4.0\n0.3 [0.01, 0.04, 99.95] 4.0\n0.5 [0.01, 0.06, 99.93] 4.0\n0.8 [0.01, 0.11, 99.88] 4.0\n1 [0.02, 0.21, 99.77] 4.0\n1.5 [0.11, 1.75, 98.14] 3.98\n2 [0.57, 10.88, 88.55] 3.88\n2.5 [3.33, 23.44, 73.23] 3.7\n3 [16.82, 20.4, 62.78] 3.46\nPerformance with noise. To show how the model performs with the interference of noise, we tested the effect on MnO, Mn2O3, and MnO2. As shown in Table 6, the model is robust down to PSNR = 20. At PSNR = 10, 2+ and 4+ are more stable than 3+.\nValidation of the model on experimental data that were not used for training. Validation on unknown unknowns is critical for understanding the accuracy and robustness of a machine learning model. Testing on Mn3O4. One of the compounds, for which we have experimental data on, but was not used for training was Mn3O4. It has a mixed oxidation state of Mn2+ and Mn3+\nwith a theoretical ratio of 1:2. It gives an average oxidation state of +2.67. Figure 8 shows the predicted oxidation state as a function of thickness and the oxidation state decomposition is shown in Table 7. The model predicts the correct ratio between 2+/3+ with a small error. The prediction starts to deviate from the ground truth at t/\u03bb =1.5 which is larger than the maximal augmentation used for training. Therefore, the reduced performance is expected.\nFurther testing on the influence of noise. The ratio between 2+ and 3+ stays close to 1:2 for PSNR down to 10. When below 10, the composition ratio starts to deviate from the theoretical ground truth as expected (the noise augmentation range is PSNR = [10,30]).\nSensitivity and accuracy validation on Mn3O4 with vacancies on the tetrahedral sites. We tested the accuracy and sensitivity of our model using two Mn3O4 EELS spectra documented in ref. 9. The two spectra are shown in Figure 10. The small different in the L3 edge indicates that the nanosized Mn3O4 has some slightly more Mn2+ and less Mn3+ than the bulk Mn3O4. The documented ratio of Mn3+/Mn2+ is 2 for the bulk sample and 1.6 for the nanosized sample in ref. 9 . Our model accurately captures this change . For the nanosized sample, our model\u2019s predicted decomposition clearly shows the reduction of Mn3+ composition and increase of Mn2+ composition. The ratio of Mn3+/Mn2+ is\npredicted to be 1.59 which is almost the same as the documented value. This test shows that our model is accurate and sensitive to small changes in the spectrum.\nMore on XAS and EELS data not used in training. To further test the model on unknown unknowns. We collected more EELS and XAS data from literature and experiments with very different energy resolutions. All data shown in Figure 11 were not used for training. Figure 11 shows the oxidation decomposition of EELS/XAS Mn L2,3 edge inferred by our model. All predictions are within reasonable errors of the ground truth. It is worth noting that the model is effective on both XAS and EELS spectra. The XAS and EELS have very different energy resolutions. Within the XAS, the TEY and PFY also have noticeable differences in the fine structures. In addition, the energy onsets are all different. However, as shown, our model remains translation invariant and is robust enough to correctly decompose their oxidation states."
        },
        {
            "heading": "Conclusion",
            "text": "Determination of the oxidation states of Mn is highly important for characterizing the electronic structures and redox centers for electronic, electrocatalytic and energy storage materials. EELS and XAS measurement of the Mn L2,3 edges are widely used for this purpose. To date, although the measurement of the Mn L2,3 edges are straightforward given the sample is prepared properly, an accurate decomposition of the mix valence states of Mn remains non-trivial. For both EELS and XAS, 2+, 3+, 4+ references spectra need to be taken on the same instrument/beamline and preferably in the same experimental session because the instrumental resolution and the energy axis offset could vary from one session to another. To circumvent this hurdle, in this study, we adopted a deep learning approach and developed a calibration-free and reference-free method to decompose the oxidation state of Mn L2,3 edges for both EELS and XAS. To synthesize physics included and ground-truth labeled training data, we created a forward model that takes into account plural scattering, instrumentation broadening, noise and energy axis offset. With that we created a 1.2 million-spectrum database with oxidation states labeled. The library includes sufficient variety of data including both EELS and XAS spectra. By training on this large database, our convolutional neural network achieves 85% accuracy on the validation dataset. We tested the model and found it is robust against noise (down to PSNR of 10) and plural scattering (up to t/\u03bb = 1). We further validated the model against spectral data that were not used in training. In particular, the model shows high accuracy and high sensitivity for the decomposition of Mn3O4, MnO, Mn2O3 and MnO2. In particular, the accurate decomposition of Mn3O4 experimental data shows the model is quantitatively correct and can be deployed for real experimental data. Our model will not only be a valuable tool to researchers and materials scientists but also can assist experienced electron microscopists and synchrotron scientist in automated analysis of Mn L edge data."
        },
        {
            "heading": "Acknowledgement",
            "text": "This work is supported by the Office of Basic Energy Sciences of the U.S. Department of Energy, under award no. DE-SC0021204."
        },
        {
            "heading": "Author Contributions",
            "text": "HLX conceived the idea. All authors designed and carried out the experiments. HLX wrote the manuscript."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Data availability",
            "text": "Data and code are available upon request."
        }
    ],
    "title": "MnEdgeNet\u2014Accurate Decomposition of Mixed Oxidation States for Mn XAS and EELS L2,3 Edges without Reference and Calibration",
    "year": 2022
}