{
    "abstractText": "We investigate the fair allocation of indivisible goods to agents with possibly different entitlements represented by weights. Previous work has shown that guarantees for additive valuations with existing envy-based notions cannot be extended to the case where agents have matroid-rank (i.e., binary submodular) valuations. We propose two families of envy-based notions for matroid-rank and general submodular valuations, one based on the idea of transferability and the other on marginal values. We show that our notions can be satisfied via generalizations of rules such as picking sequences and maximum weighted Nash welfare. In addition, we introduce welfare measures based on harmonic numbers, and show that variants of maximum weighted harmonic welfare offer stronger fairness guarantees than maximum weighted Nash welfare under matroid-rank valuations.",
    "authors": [
        {
            "affiliations": [],
            "name": "Luisa Montanari"
        },
        {
            "affiliations": [],
            "name": "Ulrike Schmidt-Kraepelin"
        },
        {
            "affiliations": [],
            "name": "Warut Suksompong"
        }
    ],
    "id": "SP:f8de895b5638b5701058e372d5eef4f973250541",
    "references": [
        {
            "authors": [
                "Haris Aziz",
                "Herv\u00e9 Moulin",
                "Fedor Sandomirskiy"
            ],
            "title": "A polynomial-time algorithm for computing a Pareto optimal and almost proportional allocation",
            "venue": "Operations Research Letters,",
            "year": 2020
        },
        {
            "authors": [
                "Moshe Babaioff",
                "Tomer Ezra",
                "Uriel Feige"
            ],
            "title": "Fair-share allocations for agents with arbitrary entitlements",
            "venue": "In Proceedings of the 22nd ACM Conference on Economics and Computation (EC),",
            "year": 2021
        },
        {
            "authors": [
                "Moshe Babaioff",
                "Tomer Ezra",
                "Uriel Feige"
            ],
            "title": "Fair and truthful mechanisms for dichotomous valuations",
            "venue": "In Proceedings of the 35th AAAI Conference on Artificial Intelligence (AAAI),",
            "year": 2021
        },
        {
            "authors": [
                "Moshe Babaioff",
                "Noam Nisan",
                "Inbal Talgam-Cohen"
            ],
            "title": "Competitive equilibrium with indivisible goods and generic budgets",
            "venue": "Mathematics of Operations Research,",
            "year": 2021
        },
        {
            "authors": [
                "Siddharth Barman",
                "Paritosh Verma"
            ],
            "title": "Existence and computation of maximin fair allocations under matroid-rank valuations",
            "venue": "In Proceedings of the 20th International Conference on Autonomous Agents and Multiagent Systems (AAMAS),",
            "year": 2021
        },
        {
            "authors": [
                "Siddharth Barman",
                "Paritosh Verma"
            ],
            "title": "Truthful and fair mechanisms for matroid-rank valuations",
            "venue": "In Proceedings of the 36th AAAI Conference on Artificial Intelligence (AAAI),",
            "year": 2022
        },
        {
            "authors": [
                "Nawal Benabbou",
                "Mithun Chakraborty",
                "Edith Elkind",
                "Yair Zick"
            ],
            "title": "Fairness towards groups of agents in the allocation of indivisible items",
            "venue": "In Proceedings of the 28th International Joint Conference on Artificial Intelligence (IJCAI),",
            "year": 2019
        },
        {
            "authors": [
                "Nawal Benabbou",
                "Mithun Chakraborty",
                "Ayumi Igarashi",
                "Yair Zick"
            ],
            "title": "Finding fair and efficient allocations for matroid rank valuations",
            "venue": "ACM Transactions on Economics and Computation,",
            "year": 2021
        },
        {
            "authors": [
                "Steven J. Brams",
                "Alan D. Taylor"
            ],
            "title": "Fair Division: From Cake-Cutting to Dispute Resolution",
            "year": 1996
        },
        {
            "authors": [
                "Ioannis Caragiannis",
                "David Kurokawa",
                "Herv\u00e9 Moulin",
                "Ariel D. Procaccia",
                "Nisarg Shah",
                "Junxing Wang"
            ],
            "title": "The unreasonable fairness of maximum Nash welfare",
            "venue": "ACM Transactions on Economics and Computation,",
            "year": 2019
        },
        {
            "authors": [
                "Mithun Chakraborty",
                "Ayumi Igarashi",
                "Warut Suksompong",
                "Yair Zick"
            ],
            "title": "Weighted envy-freeness in indivisible item allocation",
            "venue": "ACM Transactions on Economics and Computation,",
            "year": 2021
        },
        {
            "authors": [
                "Mithun Chakraborty",
                "Ulrike Schmidt-Kraepelin",
                "Warut Suksompong"
            ],
            "title": "Picking sequences and monotonicity in weighted fair division",
            "venue": "Artificial Intelligence,",
            "year": 2021
        },
        {
            "authors": [
                "Mithun Chakraborty",
                "Erel Segal-Halevi",
                "Warut Suksompong"
            ],
            "title": "Weighted fairness notions for indivisible items revisited",
            "venue": "In Proceedings of the 36th AAAI Conference on Artificial Intelligence (AAAI), pages 4949\u20134956,",
            "year": 2022
        },
        {
            "authors": [
                "Alireza Farhadi",
                "Mohammad Ghodsi",
                "MohammadTaghi Hajiaghayi",
                "Sebastien Lahaie",
                "David Pennock",
                "Masoud Seddighin",
                "Saeed Seddighin",
                "Hadi Yami"
            ],
            "title": "Fair allocation of indivisible goods to asymmetric agents",
            "venue": "Journal of Artificial Intelligence Research,",
            "year": 2019
        },
        {
            "authors": [
                "Jugal Garg",
                "Pooja Kulkarni",
                "Rucha Kulkarni"
            ],
            "title": "Approximating Nash social welfare under submodular valuations through (un)matchings",
            "venue": "In Proceedings of the 31st ACM-SIAM Symposium on Discrete Algorithms (SODA),",
            "year": 2020
        },
        {
            "authors": [
                "Jugal Garg",
                "Edin Husi\u0107",
                "L\u00e1szl\u00f3 A. V\u00e9gh"
            ],
            "title": "Approximating Nash social welfare under Rado valuations",
            "venue": "In Proceedings of the 53rd Annual ACM SIGACT Symposium on Theory of Computing (STOC),",
            "year": 2021
        },
        {
            "authors": [
                "Jugal Garg",
                "Edin Husi\u0107",
                "Aniket Murhekar",
                "L\u00e1szl\u00f3 V\u00e9gh"
            ],
            "title": "Tractable fragments of the maximum Nash welfare problem",
            "venue": "In Proceedings of the 18th Conference on Web and Internet Economics (WINE),",
            "year": 2022
        },
        {
            "authors": [
                "Hiromichi Goko",
                "Ayumi Igarashi",
                "Yasushi Kawase",
                "Kazuhisa Makino",
                "Hanna Sumita",
                "Akihisa Tamura",
                "Yu Yokoi",
                "Makoto Yokoo"
            ],
            "title": "Fair and truthful mechanism with limited subsidy",
            "venue": "In Proceedings of the 21st International Conference on Autonomous Agents and Multiagent Systems (AAMAS),",
            "year": 2022
        },
        {
            "authors": [
                "Martin Lackner",
                "Piotr Skowron"
            ],
            "title": "Multi-winner voting with approval",
            "venue": "preferences. CoRR,",
            "year": 2022
        },
        {
            "authors": [
                "Euiwoong Lee"
            ],
            "title": "APX-hardness of maximizing Nash social welfare with indivisible items",
            "venue": "Information Processing Letters,",
            "year": 2017
        },
        {
            "authors": [
                "Herv\u00e9 Moulin"
            ],
            "title": "Fair Division and Collective Welfare",
            "year": 2003
        },
        {
            "authors": [
                "Vignesh Viswanathan",
                "Yair Zick"
            ],
            "title": "A general framework for fair allocation with matroid rank valua",
            "venue": "Mathematical Social Sciences,",
            "year": 2022
        },
        {
            "authors": [
                "tions. CoRR",
                "abs/2208.07311v",
                "2022a. Vignesh Viswanathan",
                "Yair Zick"
            ],
            "title": "Yankee Swap: a fast and simple fair allocation mechanism",
            "year": 2022
        },
        {
            "authors": [
                "Lemma B"
            ],
            "title": "Viswanathan and Zick [2022a]). Suppose that the fairness objective \u03a8 admits a gain function \u03c6 such that the following conditions",
            "year": 2022
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n20 9.\n06 43\n7v 1\n[ cs\n.G T\n] 1\n4 Se\np 20\n22\nWe investigate the fair allocation of indivisible goods to agents with possibly different entitlements represented by weights. Previous work has shown that guarantees for additive valuations with existing envy-based notions cannot be extended to the case where agents have matroid-rank (i.e., binary submodular) valuations. We propose two families of envy-based notions for matroid-rank and general submodular valuations, one based on the idea of transferability and the other on marginal values. We show that our notions can be satisfied via generalizations of rules such as picking sequences and maximum weighted Nash welfare. In addition, we introduce welfare measures based on harmonic numbers, and show that variants of maximum weighted harmonic welfare offer stronger fairness guarantees than maximum weighted Nash welfare under matroid-rank valuations."
        },
        {
            "heading": "1 Introduction",
            "text": "Fair division refers to the study of how to fairly allocate resources among agents with possibly differing preferences. Over the 70 years since Steinhaus [1948] initiated a mathematical framework of fair division, the field has given rise to numerous fairness notions and procedures for computing fair outcomes in a variety of scenarios [Brams and Taylor, 1996, Moulin, 2003]. For instance, in the common scenario of allocating indivisible goods, the notion envy-freeness up to one good (EF1) has emerged as a standard benchmark. An allocation of the goods satisfies EF1 if any envy that an agent has toward another agent can be eliminated by removing some good in the latter agent\u2019s bundle. Even when agents have arbitrary monotonic valuations over the goods, an EF1 allocation always exists and can be found in polynomial time [Lipton et al., 2004].\nThe definitions of many fairness notions in the literature, including EF1, inherently assume that all agents have the same entitlement to the resource. In the past few years, several researchers have examined a more general model in which different agents may have different weights reflecting their entitlements to the goods [Farhadi et al., 2019, Aziz et al., 2020, Babaioff et al., 2021a,c, Chakraborty et al., 2021a,b, 2022, Garg et al., 2020, 2021, 2022, Scarlett et al., 2021, Hoefer et al., 2022, Suksompong and Teh, 2022, Viswanathan and Zick, 2022a]. This model allows us to capture settings such as inheritance division, in which relatives are typically entitled to unequal shares of the legacy, as well as resource allocation among groups or organizations of different sizes. Chakraborty et al. [2021a] generalized EF1 to weighted EF1 (WEF1): for instance, if Alice\u2019s weight is three times as high as Bob\u2019s, then WEF1 stipulates that, after removing some good from Bob\u2019s bundle, Alice should have at least three times as much value for her own bundle as for Bob\u2019s. The same authors demonstrated that if agents have additive valuations over the goods, a complete WEF1 allocation always exists and can be computed efficiently.1 However, they provided the following example showing that existence is no longer guaranteed once we move beyond additivity.\n1An allocation is called complete if it allocates all of the goods.\nExample 1.1 (Chakraborty et al. [2021a]). Consider an instance with n = 2 agents whose weights are w1 = 1 and w2 = 2, and m \u2265 6 goods. Agent 1 has an additive valuation with value 1 for every good, whereas agent 2 has value 0 for the empty bundle and 1 for any nonempty bundle. If agent 1 is allocated more than one good, then agent 2 has weighted envy toward agent 1 even after removing any good from agent 1\u2019s bundle. Thus, assuming that all goods need to be allocated, agent 2 obtains at least m \u2212 1 goods. Again, this causes weighted envy according to WEF1, this time from agent 1 toward agent 2. Hence, no complete WEF1 allocation exists in this instance.\nThe impossibility result illustrated in this example still holds even if WEF1 is relaxed to weak WEF1 (WWEF1), whereby an agent is allowed to either remove a good from the other agent\u2019s bundle or copy one such good into her own bundle,2 and stands in contrast to the aforementioned EF1 guarantee in the unweighted setting [Lipton et al., 2004]. In light of these observations, Chakraborty et al. [2021a] left open the direction of identifying appropriate envy-based notions for non-additive valuations. Note also that the valuations in Example 1.1 are particularly simple: both agents have binary submodular valuations, that is, submodular valuations3 in which the marginal gain from receiving any single good is either 0 or 1. Binary submodular valuations are also known as matroid-rank valuations, and have been studied in a number of recent fair division papers, mostly in the unweighted setting [Babaioff et al., 2021b, Barman and Verma, 2021, 2022, Benabbou et al., 2021, Goko et al., 2022, Viswanathan and Zick, 2022a,b].4 Such valuations arise in settings such as the allocation of course slots to students, or apartments in public housing estates to ethnic groups [Benabbou et al., 2021].\nIn this paper, we explore weighted envy-freeness for both matroid-rank and general submodular valuations. We propose new envy-based notions and show that they can be satisfied in these settings, not only via extensions of existing algorithms, but also via new rules. For the sake of generality, we define our notions based on the notion WEF(x, 1 \u2212 x) of Chakraborty et al. [2022]. With additive valuations, given a parameter x \u2208 [0, 1], WEF(x, 1 \u2212 x) allows each agent i to subtract x times the value of some good in another agent j\u2019s bundle from i\u2019s value for this bundle, and add (1 \u2212 x) times the value of this good to the value of i\u2019s own bundle. WEF1 corresponds to WEF(1, 0), and higher values of x yield notions that favor lower-weight agents. Chakraborty et al. [2022] showed that for any instance with additive valuations and any x, a complete WEF(x, 1 \u2212 x) allocation always exists; on the other hand, they proved that for any distinct x and x\u2032, there is an instance with binary additive valuations and identical goods in which no complete allocation satisfies both WEF(x, 1\u2212 x) and WEF(x\u2032, 1\u2212 x\u2032)."
        },
        {
            "heading": "1.1 Our Contributions",
            "text": "In Section 2, we introduce two new families of weighted envy-freeness notions. The first family, TWEF(x, 1\u2212x), is based on the concept of \u201ctransferability\u201d:5 we consider the condition TWEF(x, 1\u2212x) from agent i to agent j to be violated only if the WEF(x, 1\u2212 x) condition between i and j fails and i\u2019s value for her own bundle does not increase even if all goods from j\u2019s bundle are transferred to i\u2019s bundle. TWEF(x, 1\u2212 x) handles instances such as the one in Example 1.1, where an agent could be unsatisfied with respect to WEF(x, 1 \u2212 x) even if she already receives her maximum possible utility. Our second family, WMEF(x, 1\u2212x), is an extension of the notion marginal EF1 (MEF1) of Caragiannis et al. [2019] from the unweighted setting. The idea is that, instead of agent i considering her value for agent j\u2019s bundle as in WEF(x, 1 \u2212 x), agent i considers her marginal value of j\u2019s bundle when added to i\u2019s own bundle. While TWEF(x, 1 \u2212 x) is stronger than WMEF(x, 1 \u2212 x), we show that the former notion is\n2In fact, the impossibility persists even with WWEFc for any constant c; see the discussion after Proposition 8.1 of\nChakraborty et al. [2021a]. 3See the definition of submodularity in Section 2. 4An exception is the recent work of Viswanathan and Zick [2022a], which deals with the weighted setting. 5This concept has been discussed by Benabbou et al. [2021] and Chakraborty et al. [2021a].\nsuitable primarily for matroid-rank valuations, whereas the latter can be guaranteed even for general submodular valuations.\nIn Sections 3 and 4, we allow agents to have arbitrary submodular valuations. In Section 3, we investigate picking sequences, which let agents take turns picking a good according to a specified agent ordering until the goods run out. While previous work on picking sequences typically assumed that agents have additive valuations, this assumption may be violated in real-world applications of picking sequences, such as the allocation of ministries to political parties. We adjust picking sequences to submodular valuations by letting agents pick a good with the highest marginal gain in each of their turns. We show that for every x, the output of the adjusted version of the picking sequence proposed by Chakraborty et al. [2022] with parameter x satisfies WMEF(x, 1\u2212 x); this generalizes their result from the weighted additive setting. As a corollary, in the unweighted submodular setting, the adjusted version of the commonly studied round-robin algorithm produces an MEF1 allocation. In Section 4, we consider the maximum weighted Nash welfare (MWNW) rule, which chooses an allocation that maximizes the weighted product of the agents\u2019 utilities. Although prior results rule out the possibility that MWNW implies WMEF(x, 1 \u2212 x) for any x, we show that an MWNW allocation always satisfies a relaxation of WMEF(x, 1 \u2212 x) called weak weighted MEF1 (WWMEF1). This extends a corresponding result of Chakraborty et al. [2021a] from the weighted additive setting, which is in turn a generalization of the prominent result by Caragiannis et al. [2019] in the unweighted additive setting.\nNext, in Sections 5 and 6, we focus on agents with matroid-rank valuations. In Section 5, we extend the \u201ctransfer algorithm\u201d of Benabbou et al. [2021] from the unweighted setting, and prove that our algorithm returns a clean6 TWEF(x, 1\u2212 x) allocation that maximizes the unweighted utilitarian welfare. While Benabbou et al.\u2019s potential function argument can be generalized to show that our algorithm terminates, it is insufficient for establishing polynomial-time termination in our setting with different weights; hence, we devise a more elaborate argument for this purpose. Finally, in Section 6, we introduce new welfare measures based on harmonic numbers and their variants.7 Perhaps surprisingly, we demonstrate that the maximum-welfare rules based on our measures offer stronger fairness guarantees compared to MWNW under matroid-rank valuations. In particular, while MWNW does not imply WEF(x, 1\u2212x) for any x even with binary additive valuations and identical goods [Chakraborty et al., 2022], we prove that a clean maximum weighted harmonic welfare allocation parameterized by x satisfies TWEF(x, 1 \u2212 x) for matroid-rank valuations (and therefore WEF(x, 1\u2212 x) for binary additive valuations).8"
        },
        {
            "heading": "2 Preliminaries",
            "text": "Let N = [n] be the set of agents and G = {g1, . . . , gm} be the set of indivisible goods, where [k] := {1, . . . , k} for any positive integer k. A bundle refers to a subset of G. Each agent i \u2208 N has a weight wi > 0 representing her entitlement, and a valuation function (or utility function) vi : 2\nG \u2192 R\u22650. The setting where all of the weights are equal is sometimes referred to as the unweighted setting. For convenience, we write vi(g) instead of vi({g}) for a single good g. We assume throughout the paper that vi is\n\u2022 monotone: vi(G \u2032) \u2264 vi(G \u2032\u2032) for all G\u2032 \u2286 G\u2032\u2032 \u2286 G;\n\u2022 submodular: vi(G \u2032\u222a{g})\u2212vi(G \u2032) \u2265 vi(G \u2032\u2032\u222a{g})\u2212vi(G \u2032\u2032) for all G\u2032 \u2286 G\u2032\u2032 \u2286 G and g \u2208 G\\G\u2032\u2032;\n6An allocation is clean if no good can be discarded from an agent\u2019s bundle without decreasing the agent\u2019s utility [Benabbou et al., 2021]. The term non-redundant has also been used with the same meaning [Babaioff et al., 2021b]. 7The harmonic welfare measure is the basis of the proportional approval voting (PAV) rule in the context of approval-based committee voting [Lackner and Skowron, 2022]. To the best of our knowledge, we are the first to consider this measure in the context of fair division. 8To further exhibit the potential of harmonic welfare, we show in Appendix C that, in the unweighted additive setting, if each agent\u2019s value for each good is an integer, then a maximum harmonic welfare allocation always satisfies EF1.\n\u2022 normalized: vi(\u2205) = 0.\nThe function vi is said to be matroid-rank (or binary submodular) if it is submodular and vi(G \u2032\u222a{g})\u2212 vi(G \u2032) \u2208 {0, 1} for all G\u2032 \u2286 G and g \u2208 G\\G\u2032. Moreover, vi is additive if vi(G \u2032) = \u2211\ng\u2208G\u2032 vi(g) for all G\u2032 \u2286 G, and binary additive if it is additive and vi(g) \u2208 {0, 1} for all g \u2208 G. An instance consists of the set of agents N , the set of goods G, and the agents\u2019 weights (wi)i\u2208N and valuation functions (vi)i\u2208N .\nAn allocation A is a list of bundles (A1, . . . , An) such that no two bundles overlap, where bundle Ai is assigned to agent i. The allocation is complete if \u22c3 i\u2208N Ai = G. It is Pareto-optimal (PO) if there does not exist another allocation A\u2032 such that vi(A \u2032 i) \u2265 vi(Ai) for all i \u2208 N and the inequality is strict for at least one i \u2208 N ; such an allocation A\u2032 is said to Pareto-dominate A. For each i \u2208 N , we denote by N+A the subset of agents receiving positive utility from A. The unweighted utilitarian welfare of A is defined as \u2211 i\u2208N vi(Ai).\nFor a bundle G\u2032 \u2286 G, we define the marginal gain of a good g 6\u2208 G\u2032 for agent i as \u2206+i (G \u2032, g) :=\nvi(G \u2032 \u222a {g}) \u2212 vi(G \u2032). Similarly, the marginal loss of a good g \u2208 G\u2032 for agent i is defined as \u2206\u2212i (G \u2032, g) := vi(G \u2032) \u2212 vi(G\n\u2032 \\ {g}). An allocation A is called clean (or non-redundant) if for any i \u2208 N and any g \u2208 Ai, it holds that \u2206 \u2212 i (Ai, g) > 0. For matroid-rank valuations, A is clean if and only if vi(Ai) = |Ai| for all i \u2208 N [Benabbou et al., 2021, Prop. 3.3]. We now introduce our first family of fairness notions, TWEF(x, y).9\nDefinition 2.1 (TWEF(x, y)). For x, y \u2208 [0, 1], an allocation A is said to satisfy transferable WEF(x, y) (TWEF(x, y)) if, for any pair of agents i, j \u2208 N , either vi(Ai) = vi(Ai \u222a Aj) or there exists g \u2208 Aj such that\nvi(Ai) + y \u00b7\u2206 + i (Ai, g)\nwi \u2265\nvi(Aj)\u2212 x \u00b7\u2206 \u2212 i (Aj , g)\nwj .\nBy submodularity, the condition vi(Ai) = vi(Ai \u222a Aj) is equivalent to the condition that vi(Ai) = vi(Ai \u222a {g}) for every g \u2208 Aj .\nFor any x and y, if valuations are additive, then TWEF(x, y) reduces to the notion WEF(x, y) of Chakraborty et al. [2022]. We will mostly be concerned with the case where y = 1\u2212 x. As we will see, TWEF(x, 1 \u2212 x) is a useful notion for matroid-rank valuations. However, like WEF(x, 1 \u2212 x), it can be too demanding for general submodular valuations. For instance, in Example 1.1, if agent 2 has value 1 + (|G\u2032| \u2212 1) \u00b7 \u03b5 for any nonempty bundle |G\u2032|, where \u03b5 > 0 is a small constant, then the condition vi(Ai) = vi(Ai \u222a Aj) becomes impotent and a complete TWEF(x, 1\u2212 x) allocation does not exist for any x. The second family of notions that we propose, which is based on the marginal EF1 (MEF1) notion of Caragiannis et al. [2019],10 does not suffer from this shortcoming.\nDefinition 2.2 (WMEF(x, y)). For x, y \u2208 [0, 1], an allocation A is said to satisfy WMEF(x, y) if, for any pair of agents i, j \u2208 N , either Aj = \u2205 or there exists g \u2208 Aj such that\nvi(Ai) + y \u00b7\u2206 + i (Ai, g)\nwi \u2265\nvi(Ai \u222aAj)\u2212 vi(Ai)\u2212 x \u00b7\u2206 \u2212 i (Ai \u222aAj , g)\nwj .\nIf valuations are additive, WMEF(x, y) reduces to WEF(x, y) for any x and y. On the other hand, if all agents have the same weight, WMEF(x, 1 \u2212 x) reduces to MEF1 only if x = 1. The following proposition establishes an implication relationship between our two families of notions.\nProposition 2.3. For x, y \u2208 [0, 1], any TWEF(x, y) allocation is also WMEF(x, y).\n9This is not to be confused with the notion that Chakraborty et al. [2021a] informally termed \u201ctransfer WEF1\u201d, which allows an agent to transfer a good from another agent\u2019s bundle over to her own bundle (instead of only making a copy of it as in weak WEF1), or with the notion \u201ctypewise (M)EF1\u201d of Benabbou et al. [2019] in a different setting. 10In the unweighted setting, an allocation satisfies MEF1 if for all i, j \u2208 N , there exists g \u2208 Aj such that vi(Ai) \u2265 vi(Ai \u222aAj \\ {g})\u2212 vi(Ai).\nProof. Let A be a TWEF(x, y) allocation, and consider any i, j \u2208 N . By definition of TWEF(x, y), either vi(Ai) = vi(Ai \u222a Aj) or there exists g \u2208 Aj such that vi(Ai)+y\u00b7\u2206 + i (Ai,g)\nwi \u2265\nvi(Aj)\u2212x\u00b7\u2206 \u2212 i (Aj ,g)\nwj .\nAssume first that the latter holds. Since vi is submodular, we have vi(Ai) + vi(Aj \\ {g}) \u2265 vi(Ai \u222a Aj \\ {g}) and \u2206 \u2212 i (Aj , g) \u2265 \u2206 \u2212 i (Ai \u222aAj , g). It follows that\nvi(Ai) + y \u00b7\u2206 + i (Ai, g)\nwi \u2265\nvi(Aj)\u2212 x \u00b7\u2206 \u2212 i (Aj , g)\nwj\n= vi(Aj \\ {g}) + (1\u2212 x) \u00b7\u2206\n\u2212 i (Aj , g)\nwj\n\u2265 vi(Ai \u222aAj \\ {g}) \u2212 vi(Ai) + (1\u2212 x) \u00b7\u2206\n\u2212 i (Ai \u222aAj , g)\nwj\n= vi(Ai \u222aAj)\u2212 vi(Ai)\u2212 x \u00b7\u2206\n\u2212 i (Ai \u222aAj , g)\nwj .\nHence, the WMEF(x, y) condition between agents i and j is fulfilled. Next, assume that vi(Ai) = vi(Ai\u222aAj). If Aj = \u2205, then the WMEF(x, y) condition between agents i and j is automatically fulfilled. Otherwise, for any good g \u2208 Aj , we have\nvi(Ai) + y \u00b7\u2206 + i (Ai, g)\nwi \u2265 0 \u2265\n\u2212x \u00b7\u2206\u2212i (Ai \u222aAj , g)\nwj\n= vi(Ai \u222aAj)\u2212 vi(Ai)\u2212 x \u00b7\u2206\n\u2212 i (Ai \u222aAj , g)\nwj ,\nand WMEF(x, y) between i and j is again fulfilled.\nSince the valuations that we consider in this paper are not necessarily additive, in order to reason about the running time of algorithms, we make the standard assumption that an algorithm can query the value of any agent i for any bundle G\u2032 \u2286 G in constant time."
        },
        {
            "heading": "3 Picking Sequences",
            "text": "In this section, we investigate picking sequences, which are procedures wherein agents take turns picking a good according to a specified agent ordering until there are no more goods left. For brevity, we will say that a picking sequence satisfies a fairness notion if the allocation that it returns always satisfies that notion. With additive valuations, Chakraborty et al. [2022] showed that for any x \u2208 [0, 1], a picking sequence that assigns each subsequent pick to an agent i \u2208 N with the smallest ratio ti+(1\u2212x) wi , where ti denotes the number of times agent i has picked so far, satisfies WEF(x, 1 \u2212 x). Our main result of this section extends their result to submodular valuations. We make the specification that, in each turn, the agent picks a good that yields the highest marginal gain with respect to the agent\u2019s current bundle, breaking ties arbitrarily. More formally, if it is agent i\u2019s turn, then i chooses a good g that maximizes \u2206+i (Ai, g), where Ai is the set of goods i has picked in previous turns.\nTheorem 3.1. Let x \u2208 [0, 1]. Consider a picking sequence \u03c0x such that, in each turn, the pick is assigned to an agent i \u2208 N with the smallest ratio ti+(1\u2212x) wi\n, where ti denotes the number of times agent i has picked so far, and the agent picks a good that yields the highest marginal gain. Then, under submodular valuations, \u03c0x satisfies WMEF(x, 1\u2212 x).\nFor any x and agents with equal weights, \u03c0x encompasses the popular round-robin algorithm where the agents take turns in the order 1, 2, . . . , n, 1, 2, . . . , n, 1, 2, . . . , and WMEF(1, 0) reduces to MEF1 of\nCaragiannis et al. [2019]. We therefore have the following corollary, which is also new to the best of our knowledge.\nCorollary 3.2. Assume that all agents have equal weights and submodular valuations. Suppose that in each turn of the round-robin algorithm, the picking agent picks a good with the highest marginal gain. Then, the algorithm returns a complete MEF1 allocation.\nAs Corollary 3.2 admits a more direct proof, which also illustrates the ideas that we will use to show\nTheorem 3.1, we first present the (shorter) proof of Corollary 3.2.\nProof of Corollary 3.2. Let A be the allocation produced by the round-robin algorithm, and consider any i, j \u2208 N . Assume without loss of generality that i < j.\nWe first establish the MEF1 condition from i toward j. Let k := |Aj | \u2264 |Ai|, and suppose that agent j picks the goods in the order c1, c2, . . . , ck. Let b1, b2, . . . , bk be the first k goods picked by agent i in this order. For 0 \u2264 \u2113 \u2264 k, let B\u2113 = {b1, . . . , b\u2113} and C\u2113 = {c1, . . . , c\u2113} (so B0 = C0 = \u2205). For 1 \u2264 \u2113 \u2264 k, since agent i picks b\u2113 when c\u2113 is also available, it must be that\nvi(B\u2113)\u2212 vi(B\u2113\u22121) \u2265 vi(B\u2113\u22121 \u222a {c\u2113})\u2212 vi(B\u2113\u22121).\nMoreover, since B\u2113\u22121 \u2286 Ai \u2286 Ai \u222aC\u2113\u22121, submodularity implies that\nvi(B\u2113\u22121 \u222a {c\u2113})\u2212 vi(B\u2113\u22121) \u2265 vi(Ai \u222a C\u2113\u22121 \u222a {c\u2113})\u2212 vi(Ai \u222a C\u2113\u22121).\nCombining the previous two inequalities yields\nvi(B\u2113)\u2212 vi(B\u2113\u22121) \u2265 vi(Ai \u222a C\u2113\u22121 \u222a {c\u2113})\u2212 vi(Ai \u222aC\u2113\u22121).\nSumming this over all \u2113 \u2208 [k], we get vi(Bk) \u2265 vi(Ai \u222aCk)\u2212 vi(Ai). Since Bk \u2286 Ai and Ck = Aj , it follows that vi(Ai) \u2265 vi(Ai \u222aAj)\u2212 vi(Ai), and the MEF1 condition from i to j is fulfilled.\nThe proof for the MEF1 condition from j toward i is almost identical: by ignoring the first good g picked by agent i and applying the same argument, we have vj(Aj) \u2265 vj(Aj \u222a (Ai \\ {g})) \u2212 vj(Aj). Thus, the MEF1 condition is again satisfied.\nIn Appendix A, we provide an example demonstrating that the condition MEF1 in Corollary 3.2\ncannot be strengthened to EF1, even when agents have matroid-rank valuations.\nWe now establish Theorem 3.1 by augmenting the proof of Chakraborty et al. [2022, Thm. 3.2] from the additive setting with the ideas from our proof of Corollary 3.2 and arguments involving submodularity.\nProof of Theorem 3.1. Fix two agents i, j \u2208 N . For convenience, we write \u03c0 instead of \u03c0x. For any prefix P of \u03c0, if i and j pick ti and tj times in P , respectively, then it must be that (tj+(1\u2212x))\u22121\nwj \u2264\nti+(1\u2212x) wi\n; otherwise the tj-th pick of j should have been assigned to i instead. That is, we have ti+(1\u2212 x) \u2265 wi\nwj \u00b7 (tj \u2212 x). Using this property, we will show that the WMEF(x, 1\u2212 x) condition from i to j is\nsatisfied after every prefix of \u03c0. We first prove a general claim that, for any x, y \u2208 [0, 1], if the WMEF(x, y) condition from i to j is satisfied with bundles Ai and Aj , and we add one good h 6\u2208 Ai \u222a Aj to Ai, then the condition remains satisfied. To this end, we show that for every good g \u2208 Aj ,\nvi(Ai \u222a {h}) + y \u00b7\u2206 + i (Ai \u222a {h}, g) \u2265 vi(Ai) + y \u00b7\u2206 + i (Ai, g) (1)\nand\nvi(Ai \u222aAj)\u2212 vi(Ai)\u2212 x \u00b7\u2206 \u2212 i (Ai \u222aAj , g)\n\u2265 vi(Ai \u222aAj \u222a {h}) \u2212 vi(Ai \u222a {h})\u2212 x \u00b7\u2206 \u2212 i (Ai \u222aAj \u222a {h}, g). (2)\nFrom the definition of WMEF(x, y), these two inequalities suffice to prove our claim. In order to prove inequality (1), we observe that\n\u2206+i (Ai, h) + y \u00b7\u2206 + i (Ai \u222a {h}, g) \u2265 y \u00b7\u2206 + i (Ai, h) + y \u00b7\u2206 + i (Ai \u222a {h}, g)\n= y \u00b7 (vi(Ai \u222a {h, g}) \u2212 vi(Ai))\n\u2265 y \u00b7 (vi(Ai \u222a {g}) \u2212 vi(Ai)) = y \u00b7\u2206+i (Ai, g).\nSince \u2206+i (Ai, h) = vi(Ai \u222a {h})\u2212 vi(Ai), this implies (1). For (2), observe that\nvi(Ai \u222aAj)\u2212 vi(Ai)\u2212 x \u00b7\u2206 \u2212 i (Ai \u222aAj, g)\n= vi(Ai \u222aAj \\ {g}) \u2212 vi(Ai) + (1\u2212 x) \u00b7\u2206 \u2212 i (Ai \u222aAj, g) \u2265 vi(Ai \u222aAj \u222a {h} \\ {g}) \u2212 vi(Ai \u222a {h}) + (1\u2212 x) \u00b7\u2206 \u2212 i (Ai \u222aAj \u222a {h}, g) = vi(Ai \u222aAj \u222a {h}) \u2212 vi(Ai \u222a {h}) \u2212 x \u00b7\u2206 \u2212 i (Ai \u222aAj \u222a {h}, g),\nwhere the inequality follows from submodularity.\nWe are ready to prove Theorem 3.1. Let \u03c1 = wi/wj and y = 1\u2212 x. From the previous paragraph, it is sufficient to show that the WMEF(x, 1\u2212x) condition from i to j is fulfilled after every pick by agent j. Consider any pick by agent j, and suppose that it is the agent\u2019s tj-th pick. We divide the sequence of picks up to this pick into phases, where each phase \u2113 \u2208 [tj] consists of the picks after agent j\u2019s (\u2113\u22121)-th pick up to (and including) the agent\u2019s \u2113-th pick. Let Ai and Aj be the bundle of agent i and j after phase tj , respectively. If Aj = \u2205, then the WMEF(x, 1 \u2212 x) condition from i to j holds trivially, so assume that Aj 6= \u2205. In addition, we introduce the following notation:\n\u2022 \u03c4\u2113 := the number of times agent i picks in phase \u2113 (that is, between agent j\u2019s (\u2113 \u2212 1)-th and \u2113-th picks);\n\u2022 \u03b1\u21131, \u03b1 \u2113 2, . . . , \u03b1 \u2113 \u03c4\u2113 := agent i\u2019s marginal gain for each good that she picks herself in phase \u2113 with respect to the goods that she has already picked (including those in phase \u2113, if any);\n\u2022 \u03b1\u2113 := \u03b1 \u2113 1 + \u00b7 \u00b7 \u00b7+\u03b1 \u2113 \u03c4\u2113 = the total marginal gain of agent i in phase \u2113 with respect to the goods that\nshe has picked in prior phases;\n\u2022 \u03b2\u2113 := agent i\u2019s marginal gain for the good that agent j picks at the end of phase \u2113 with respect to Ai.\nNote that \u03b1\u21131, \u03b1 \u2113 2, . . . , \u03b1 \u2113 \u03c4\u2113 (and therefore \u03b1\u2113) and \u03b2\u2113 are defined differently than in the proof of Theorem 3.2 of Chakraborty et al. [2022], as the valuations that we consider may be non-additive.\nFor any integer s \u2208 [tj ], applying the condition in the first paragraph of our proof to the picking sequence up to and including phase s, we have\ny +\ns\u2211\n\u2113=1\n\u03c4\u2113 \u2265 \u03c1(s\u2212 x) \u2200s \u2208 [tj]. (3)\nEvery time it is agent i\u2019s turn, she picks a good with the highest marginal gain with respect to her current bundle among the available goods. In particular, in each phase \u2113, she picks \u03c4\u2113 goods each of which yields at least as high marginal gain to her as any good not yet picked by agent j. By submodularity, this implies\n\u03b1\u2113 \u2265 \u03c4\u2113 \u00b7 max \u2113\u2264r\u2264tj \u03b2r \u2200\u2113 \u2208 [tj ]. (4)\nUsing (3) and (4), the same inductive argument as in Chakraborty et al.\u2019s proof of their Theorem 3.2 yields\ny \u00b7 max 1\u2264r\u2264tj \u03b2r +\ntj\u2211\n\u2113=1\n\u03b1\u2113 \u2265 \u03c1\n  tj\u2211\n\u2113=1\n\u03b2\u2113 \u2212 x\u03b21\n  . (5)\nLet g\u2217 \u2208 argmaxg\u2208Aj \u2206 + i (Ai, g), and let g1 be the first good picked by agent j (possibly g1 = g \u2217).\nUsing (5), we get\n(1\u2212 x) \u00b7\u2206+i (Ai, g \u2217) + vi(Ai) \u2265 wi wj \u00b7\n \u2211\ng\u2208Aj\n\u2206+i (Ai, g)\u2212 x \u00b7\u2206 + i (Ai, g1)\n \n\u2265 wi wj \u00b7\n \u2211\ng\u2208Aj\n\u2206+i (Ai, g)\u2212 x \u00b7\u2206 + i (Ai, g \u2217)\n \n= wi wj \u00b7\n  \u2211\ng\u2208Aj\\{g\u2217}\n\u2206+i (Ai, g) + (1\u2212 x) \u00b7\u2206 + i (Ai, g \u2217)\n \n\u2265 wi wj \u00b7 ( vi(Ai \u222aAj \\ {g \u2217})\u2212 vi(Ai) + (1\u2212 x) \u00b7\u2206 + i (Ai, g \u2217) ) ,\nwhere the second inequality follows from the definition of g\u2217 and the last inequality from submodularity. Consequently, we have\nvi(Ai) + (1\u2212 x) \u00b7\u2206 + i (Ai, g \u2217)\nwi\n\u2265 vi(Ai \u222aAj \\ {g\n\u2217})\u2212 vi(Ai) + (1\u2212 x) \u00b7\u2206 + i (Ai, g \u2217)\nwj\n\u2265 vi(Ai \u222aAj \\ {g\n\u2217})\u2212 vi(Ai) + (1\u2212 x) \u00b7\u2206 + i (Ai \u222aAj \\ {g \u2217}, g\u2217)\nwj\n= vi(Ai \u222aAj)\u2212 vi(Ai)\u2212 x \u00b7\u2206\n\u2212 i (Ai \u222aAj , g \u2217)\nwj .\nHere, the second inequality holds by submodularity. As a result, the WMEF(x, 1\u2212x) condition between agents i and j is fulfilled, completing the proof."
        },
        {
            "heading": "4 Nash Welfare",
            "text": "In this section, we turn our attention to maximum weighted Nash welfare (MWNW), a weighted extension of the well-studied maximum Nash welfare (MNW). MWNW has been studied in several recent papers [Chakraborty et al., 2021a,b, 2022, Garg et al., 2020, 2021, 2022, Suksompong and Teh, 2022, Viswanathan and Zick, 2022a].\nDefinition 4.1 (MWNW). Given an instance, an allocation A is a maximum weighted Nash welfare (MWNW) allocation if it maximizes the weighted Nash welfare WNW(A) := \u220f i\u2208N vi(Ai) wi . If the highest possible weighted Nash welfare is 0, an MWNW allocation should maximize the number of agents receiving positive utility and, subject to that, maximize the weighted Nash welfare of these agents.\nChakraborty et al. [2022] showed that, for any x \u2208 [0, 1], there exists an instance with binary additive valuations and identical goods such that every MWNW allocation is not WEF(x, 1 \u2212 x). As a consequence, MWNW allocations cannot always satisfy WMEF(x, 1 \u2212 x) for submodular valuations. On the other hand, Chakraborty et al. [2021a] proved that, under additive valuations, MWNW allocations satisfy weak WEF1 (WWEF1), which is weaker than WEF(x, 1 \u2212 x) for every x but still reduces to EF1 in the unweighted additive setting. We extend their result to the submodular setting via a natural generalization of WWEF1.\nDefinition 4.2 (WWMEF1). An allocation A is said to satisfy weak weighted marginal envy-freeness up to one good (WWMEF1) if for any pair of agents i, j with Aj 6= \u2205, there exists a good g \u2208 Aj such that\neither vi(Ai)\nwi \u2265\nvi(Ai \u222aAj \\ {g}) \u2212 vi(Ai)\nwj or\nvi(Ai \u222a {g})\nwi \u2265\nvi(Ai \u222aAj)\u2212 vi(Ai)\nwj .\nTheorem 4.3. Under submodular valuations, any MWNW allocation satisfies WWMEF1 and PO.\nProof. LetA be an MWNW allocation, and recall that N+A denotes the set of agents who receive positive utility fromA. We first prove the PO property. IfA were not PO, there would exist an allocation A\u0302 such that vj(A\u0302j) > vj(Aj) for some j \u2208 N and vi(A\u0302i) \u2265 vi(Ai) for every i \u2208 N \\ {j}. If j \u2208 N \\N + A , we would have vi(A\u0302i) > 0 for every i \u2208 N + A \u222a{j}, contradicting the assumption that N + A is a largest subset of agents to whom it is possible to give positive utility simultaneously. On the other hand, if j \u2208 N+A ,\nwe would have \u220f\ni\u2208N+A vi(A\u0302i)\nwi > \u220f\ni\u2208N+A vi(Ai)\nwi , which would mean that A does not maximize the\nweighted Nash welfare of the agents in N+A , again a contradiction. Therefore, A is PO. Next, we proceed to establish the WWMEF1 property. Following the approach of Caragiannis et al. [2019] and Chakraborty et al. [2021a], we first prove thatA is WWMEF1 for the scenario N+A = N and then address the case where N+A 6= N .\nAssume that N+A = N , and suppose for contradiction that A is not WWMEF1. This means that there exists a pair of agents i, j \u2208 N such that the WWMEF1 condition between i and j is violated. That is, Aj 6= \u2205, and for every good g \u2208 Aj it holds that\nvi(Ai)\nwi <\nvi(Ai \u222aAj \\ {g}) \u2212 vi(Ai)\nwj (6)\nand vi(Ai \u222a {g})\nwi <\nvi(Ai \u222aAj)\u2212 vi(Ai)\nwj . (7)\nWe will construct another allocation A\u2032 obtained by transferring a good g\u2217 (to be chosen later) from Aj to Ai, so that A \u2032 i = Ai\u222a{g \u2217} and A\u2032j = Aj \\{g \u2217}, and the bundles of all other agents remain unchanged. Then, we have\nWNW(A\u2032) WNW(A) =\n( vi(Ai \u222a {g \u2217})\nvi(Ai)\n)wi (vj(Aj \\ {g\u2217}) vj(Aj) )wj\n=\n( vi(Ai) + \u2206 + i (Ai, g \u2217)\nvi(Ai)\n)wi (vj(Aj)\u2212\u2206\u2212j (Aj , g\u2217) vj(Aj) )wj\n= (vi(Ai) + \u2206\n+ i (Ai, g \u2217))wi(vj(Aj)\u2212\u2206 \u2212 j (Aj , g \u2217))wj\nvi(Ai)wivj(Aj)wj . (8)\nBy Lemma C.5 of Caragiannis et al. [2019] (which is a simple application of submodularity), it holds\nthat \u2211\ng\u2208Aj\n\u2206\u2212j (Aj , g) \u2264 vj(Aj). (9)\nMoreover, by submodularity, we have that for every g\u2032 \u2208 Aj ,\n\u2211\ng\u2208Aj\n\u2206+i (Ai, g) \u2265 vi(Ai \u222aAj \\ {g \u2032})\u2212 vi(Ai) + \u2206 + i (Ai, g \u2032), (10)\nand \u2211\ng\u2208Aj\n\u2206+i (Ai, g) \u2265 vi(Ai \u222aAj)\u2212 vi(Ai) > 0, (11)\nwhere the last inequality follows from (7). By (11), we have that \u2206+i (Ai, g) > 0 for at least one g \u2208 Aj .\nLet B = {g \u2208 Aj : \u2206 + i (Ai, g) > 0}, and let g \u2217 \u2208 argming\u2208B \u2206\u2212j (Aj ,g)\n\u2206+i (Ai,g) . Due to our choice of g\u2217\nand the definition of B, we have\n\u2206\u2212j (Aj , g \u2217) \u2206+i (Ai, g \u2217) \u2264\n\u2211 g\u2208B \u2206\n\u2212 j (Aj , g)\u2211\ng\u2208B \u2206 + i (Ai, g)\n\u2264\n\u2211 g\u2208Aj\n\u2206\u2212j (Aj , g)\u2211 g\u2208Aj \u2206+i (Ai, g) . (12)\nNote that vi(Ai\u222aAj \\{g \u2217})\u2212vi(Ai)+\u2206 + i (Ai, g \u2217) \u2265 \u2206+i (Ai, g \u2217) > 0. Combining (12) with (9), (10), and (11), we get\n\u2206\u2212j (Aj , g \u2217) \u2206+i (Ai, g \u2217) \u2264\nvj(Aj)\nvi(Ai \u222aAj \\ {g\u2217})\u2212 vi(Ai) + \u2206 + i (Ai, g\n\u2217) (13)\nand \u2206\u2212j (Aj , g \u2217)\n\u2206+i (Ai, g \u2217) \u2264\nvj(Aj)\nvi(Ai \u222aAj)\u2212 vi(Ai) . (14)\nWe split our remaining argument into two cases. In each case, we will show that the expression\nin (8) is greater than 1, which results in a contradiction because A is an MWNW allocation.\nCase 1: wi \u2265 wj . Assume first that \u2206 \u2212 j (Aj , g \u2217) > 0. By (6) and (13), we have\nvi(Ai)\nwi <\nvi(Ai \u222aAj \\ {g \u2217})\u2212 vi(Ai)\nwj \u2264\n\u2206+i (Ai,g \u2217) \u2206\u2212j (Aj ,g \u2217) \u00b7 vj(Aj)\u2212\u2206 + i (Ai, g \u2217)\nwj .\nMultiplying \u2206\u2212j (Aj , g \u2217) \u00b7 wi on both sides and manipulating, we get\nwi wj \u00b7\u2206+i (Ai, g \u2217) \u00b7 vj(Aj)\u2212 wi wj \u00b7\u2206+i (Ai, g \u2217) \u00b7\u2206\u2212j (Aj , g \u2217)\u2212\u2206\u2212j (Aj , g \u2217) \u00b7 vi(Ai) > 0.\nSince N+A = N , we can divide by vi(Ai)vj(Aj) on both sides to obtain\nwi wj\n( \u2206+i (Ai, g \u2217)\nvi(Ai) \u2212\n\u2206+i (Ai, g \u2217)\u2206\u2212j (Aj , g \u2217)\nvi(Ai)vj(Aj)\n) \u2212 \u2206\u2212j (Aj , g \u2217)\nvj(Aj) > 0.\nAdding 1 to both sides yields\n1 + wi wj\n( \u2206+i (Ai, g \u2217)\nvi(Ai) \u2212\n\u2206+i (Ai, g \u2217)\u2206\u2212j (Aj , g \u2217)\nvi(Ai)vj(Aj)\n) \u2212 \u2206\u2212j (Aj , g \u2217)\nvj(Aj) > 1,\nwhich can then be factorized as\n( 1 +\nwi wj \u00b7 \u2206+i (Ai, g \u2217) vi(Ai)\n)( 1\u2212 \u2206\u2212j (Aj , g \u2217)\nvj(Aj)\n) > 1. (15)\nIf \u2206\u2212j (Aj , g \u2217) = 0, then (15) holds trivially because \u2206+i (Ai, g \u2217) > 0. Hence, (15) always holds.\nNow, since \u2206+i (Ai,g \u2217) vi(Ai) > 0 and wi wj \u2265 1, Bernoulli\u2019s inequality together with (15) implies that\n( 1 + \u2206+i (Ai, g \u2217)\nvi(Ai)\n)wi wj ( 1\u2212 \u2206\u2212j (Aj , g \u2217)\nvj(Aj)\n) \u2265 ( 1 +\nwi wj \u00b7 \u2206+i (Ai, g \u2217) vi(Ai)\n)( 1\u2212 \u2206\u2212j (Aj , g \u2217)\nvj(Aj)\n) > 1,\nwhich means that\n( (vi(Ai) + \u2206 + i (Ai, g \u2217))wi(vj(Aj)\u2212\u2206 \u2212 j (Aj , g \u2217))wj\nvi(Ai)wivj(Aj)wj\n) 1 wj\n> 1,\nthat is (from (8)), [ WNW(A\u2032)\nWNW(A)\n] 1 wj\n> 1,\na contradiction.\nCase 2: wi < wj . Assume first that \u2206 \u2212 j (Aj , g \u2217) > 0. By (7) and (14), we have\nwj wi \u00b7 (vi(Ai) + \u2206 + i (Ai, g \u2217)) = wj wi \u00b7 vi(Ai \u222a {g \u2217})\n< vi(Ai \u222aAj)\u2212 vi(Ai) \u2264 \u2206+i (Ai, g \u2217)\n\u2206\u2212j (Aj , g \u2217) \u00b7 vj(Aj).\nMultiplying \u2206\u2212j (Aj , g \u2217) on both sides and manipulating, we get\n\u2206+i (Ai, g \u2217) \u00b7 vj(Aj)\u2212 wj wi \u00b7\u2206\u2212j (Aj , g \u2217) \u00b7 vi(Ai)\u2212 wj wi \u00b7\u2206+i (Ai, g \u2217) \u00b7\u2206\u2212j (Aj , g \u2217) > 0.\nSince N+A = N , we can divide by vi(Ai)vj(Aj) on both sides to obtain\n\u2206+i (Ai, g \u2217)\nvi(Ai) \u2212 wj wi\n( \u2206\u2212j (Aj , g \u2217)\nvj(Aj) +\n\u2206+i (Ai, g \u2217)\u2206\u2212j (Aj , g \u2217)\nvi(Ai)vj(Aj)\n) > 0.\nAdding 1 to both sides yields\n1 + \u2206+i (Ai, g \u2217)\nvi(Ai) \u2212 wj wi\n( \u2206\u2212j (Aj , g \u2217)\nvj(Aj) +\n\u2206+i (Ai, g \u2217)\u2206\u2212j (Aj , g \u2217)\nvi(Ai)vj(Aj)\n) > 1,\nwhich can then be factorized as\n( 1 + \u2206+i (Ai, g \u2217)\nvi(Ai)\n)( 1\u2212\nwj wi \u00b7 \u2206\u2212j (Aj , g \u2217) vj(Aj)\n) > 1. (16)\nIf \u2206\u2212j (Aj , g \u2217) = 0, then (16) holds trivially because \u2206+i (Ai, g \u2217) > 0. Hence, (16) always holds. Moreover, since wj > wi, it must be that \u2206 \u2212 j (Aj , g \u2217) < vj(Aj).\nNow, since \u2206\u2212j (Aj ,g \u2217)\nvj(Aj) < 1 and wj wi > 1, Bernoulli\u2019s inequality together with (16) implies that\n( 1 + \u2206+i (Ai, g \u2217)\nvi(Ai)\n)( 1\u2212 \u2206\u2212j (Aj , g \u2217)\nvj(Aj)\n)wj wi\n\u2265 ( 1 + \u2206+i (Ai, g \u2217)\nvi(Ai)\n)( 1\u2212\nwj wi \u00b7 \u2206\u2212j (Aj , g \u2217) vj(Aj)\n) > 1,\nwhich means that\n( (vi(Ai) + \u2206 + i (Ai, g \u2217))wi(vj(Aj)\u2212\u2206 \u2212 j (Aj , g \u2217))wj\nvi(Ai)wivj(Aj)wj\n) 1 wi\n> 1,\nthat is (from (8)), [ WNW(A\u2032)\nWNW(A)\n] 1 wi\n> 1,\na contradiction. This completes the proof for the scenario where N+A = N . Finally, we handle the scenario where N+A ( N . Let i, j \u2208 N with Aj 6= \u2205, and consider three cases.\n\u2022 If i, j \u2208 N+A , we can show as in the scenario where N + A = N that the WWMEF1 condition\nbetween i and j is satisfied.\n\u2022 Suppose that i 6\u2208 N+A and j \u2208 N + A . This means that vi(Ai) = 0 and vj(Aj) > 0. If there exists\na good g \u2208 Aj such that vi(Ai \u222a Aj \\ {g}) = 0, the WWMEF1 condition from i to j is trivially satisfied. Thus, assume now that vi(Ai\u222aAj \\{g}) > 0 for every g \u2208 Aj . Fix an arbitrary g\u0302 \u2208 Aj . Since vi(Ai \u222aAj \\ {g\u0302}) > 0, by submodularity, there exists g \u2032 \u2208 Aj such that vi(Ai \u222a {g \u2032}) > 0. Similarly, since vi(Ai \u222aAj \\{g \u2032}) > 0, there exists g\u2032\u2032 \u2208 Aj with g\n\u2032\u2032 6= g\u2032 (possibly g\u2032\u2032 = g\u0302) such that vi(Ai \u222a {g \u2032\u2032}) > 0. If vj(Aj \\ {g \u2032}) > 0, we can transfer g\u2032 from Aj to Ai and obtain an allocation with more agents receiving positive utility than in A, a contradiction. Therefore, vj(Aj \\ {g \u2032}) = 0. Similarly, vj(Aj \\ {g \u2032\u2032}) = 0. By submodularity, we must have vj(Aj) = 0 as well, contradicting the assumption that j \u2208 N+A .\n\u2022 Suppose that j 6\u2208 N+A . This means that vj(Aj) = 0. If vi(Ai \u222a {g}) > vi(Ai) for some g \u2208 Aj , we can transfer g from Aj to Ai and obtain an allocation with the same number of agents receiving positive utility as in A but a higher weighted Nash welfare of these agents than in A, a contradiction. Hence, vi(Ai \u222a {g}) = vi(Ai) for every g \u2208 Aj . Submodularity implies that vi(Ai \u222aAj) = vi(Ai). Therefore, the WWMEF1 condition from i to j is satisfied.\nIt follows that A is WWMEF1 in all cases.\nViswanathan and Zick [2022a] showed that if agents have matroid-rank valuations, then an MWNW allocation can be found in polynomial time. On the other hand, with equal-weight agents and additive valuations, even approximating the maximum Nash welfare is computationally difficult [Lee, 2017]."
        },
        {
            "heading": "5 Transfer Algorithm",
            "text": "For agents with equal weights and matroid-rank valuations, Benabbou et al. [2021, Algorithm 1] proposed a \u201ctransfer algorithm\u201d that computes a clean, utilitarian welfare-maximizing EF1 allocation in polynomial time. In this section, we extend their algorithm to the weighted setting. Our algorithm is presented as Algorithm 1; we argue in the proof of Theorem 5.1 that the algorithm is well-defined.\nTheorem 5.1. Suppose that all agents have matroid-rank valuations, and let x \u2208 [0, 1]. Algorithm 1 with parameter x returns a clean TWEF(x, 1 \u2212 x) (and therefore WMEF(x, 1 \u2212 x)) allocation that maximizes the unweighted utilitarian welfare among all allocations in polynomial time.\nAlgorithm 1 For finding a clean TWEF(x, 1\u2212 x) allocation maximizing \u2211\ni\u2208N vi(Ai)\nCompute a clean allocation A that maximizes the unweighted utilitarian welfare. while there exist i, j \u2208 N such that TWEF(x, 1\u2212 x) from i to j fails with respect to A do\nFind a good g \u2208 Aj with \u2206 + i (Ai, g) = 1.\nAi \u2190 Ai \u222a {g}; Aj \u2190 Aj \\ {g}. end while\nSince any allocation maximizing the unweighted utilitarian welfare is PO, the allocation output by Algorithm 1 is also PO. In the unweighted setting, Benabbou et al. [2021] exhibited polynomialtime termination of their algorithm using the potential function \u03a6(A) := \u2211\ni\u2208N vi(Ai) 2. As \u03a6(A) is\nalways an integer between 0 and m2 and decreases with every transfer, the number of transfers made by their algorithm is at most m2. While we can also establish termination of our weighted algorithm by modifying the potential function to \u03a6(A) = \u2211\ni\u2208N vi(Ai) 2+(1\u22122x)\u00b7vi(Ai) wi , this argument does not yield\na polynomial upper bound on the number of transfers, because the potential function may decrease by a very small amount depending on the weights. Therefore, we will instead employ a different, more refined, argument to show that our algorithm terminates in polynomial time as well.\nProof of Theorem 5.1. By Proposition 2.3, it suffices to prove the statement for TWEF(x, 1\u2212 x). First, we claim that each transfer maintains the welfare optimality and cleanness of the allocation. Indeed, vj(Aj) decreases by 1 because the previous allocation is clean, while vi(Ai) increases by 1 due to the algorithm\u2019s choice of the good g \u2208 Aj . Hence, \u2211 i\u2208N vi(Ai) remains the same. Moreover, since vi(Ai) = |Ai| for all i \u2208 N , the allocation remains clean. If the TWEF(x, 1\u2212 x) condition from agent i to agent j fails at some point during the execution of the algorithm, it must be that vi(Ai) < vi(Ai \u222aAj), and for every g \u2208 Aj we have\nvi(Ai) + (1\u2212 x) \u00b7\u2206 + i (Ai, g)\nwi <\nvi(Aj)\u2212 x \u00b7\u2206 \u2212 i (Aj , g)\nwj\n= vi(Aj \\ {g}) + (1\u2212 x) \u00b7\u2206\n\u2212 i (Aj , g)\nwj\n\u2264 vj(Aj \\ {g}) + (1\u2212 x) \u00b7\u2206\n\u2212 j (Aj , g)\nwj , (17)\nwhere the latter inequality follows from cleanness. Since vi(Ai) < vi(Ai\u222aAj), by submodularity, there exists g\u2217 \u2208 Aj such that \u2206 + i (Ai, g\n\u2217) = 1; in particular, the algorithm is well-defined. Plugging this good g\u2217 into (17) and using the cleanness of A, we get\n|Ai|+ (1\u2212 x) wi < |Aj | \u2212 x wj . (18)\nIf the algorithm terminates, then TWEF(x, 1 \u2212 x) is satisfied for all pairs of agents i, j. We will show that the algorithm always terminates, and moreover does so in polynomial time. The initial clean allocation A can be found in polynomial time [Benabbou et al., 2021]. Checking whether TWEF(x, 1\u2212 x) fails for some pair i, j (and, if so, finding a valid transfer) can be done in polynomial time. It therefore remains to argue that the number of transfers is polynomial. For ease of understanding, we will formulate this argument in terms of cupboards and balls.\nAssociate each i \u2208 N with a cupboard consisting of m shelves at height 1\u2212x wi , 2\u2212x wi , . . . , m\u2212x wi , respectively. For the clean allocation A at the beginning of the algorithm and each i \u2208 N , place one ball on each of the |Ai| lowest shelves 11 of cupboard i. Whenever a good is transferred from Aj to Ai, move\n11Note that the sum of the heights of all balls is \u2211\ni\u2208N |Ai| 2+(1\u22122x)\u00b7|Ai| 2wi , which is exactly half of the potential function\nmentioned before the proof.\nthe highest ball in cupboard j to the lowest shelf without a ball in cupboard i. This means that the ball is moved from height |Aj |\u2212x\nwj to height |Ai|+1\u2212x wi ; by (18), the height of the ball decreases. Since there are\nm balls and at most mn heights of the shelves, the number of transfers is at most m2n, which is indeed polynomial.12 This concludes the proof."
        },
        {
            "heading": "6 Harmonic Welfare",
            "text": "Recall from Section 4 that an MWNW allocation maximizes the product \u220f\ni\u2208N vi(Ai) wi , or equivalently,\nthe sum \u2211\ni\u2208N wi \u00b7 ln vi(Ai). Since ln k is approximately the k-th harmonic number Hk := 1 + 1 2 +\n\u00b7 \u00b7 \u00b7 + 1 k\nfor each positive integer k, one could also consider a maximum weighted harmonic welfare (MWHW) allocation, defined as an allocation maximizing the sum \u2211 i\u2208N wi \u00b7 Hvi(Ai), where H0 = 0. Interestingly, we show in this section that for agents with matroid-rank valuations, MWHW outperforms MWNW in terms of fairness. Specifically, even though for each x \u2208 [0, 1] there exists an instance with binary additive valuations and identical goods in which every MWNW allocation fails WEF(x, 1 \u2212 x) [Chakraborty et al., 2022], we show that a clean MWHW allocation satisfies TWEF(0, 1) for matroidrank valuations (and therefore WEF(0, 1) for binary additive valuations). More generally, we define a class of modified harmonic numbers parameterized by x such that a clean maximum-welfare allocation based on each x satisfies TWEF(x, 1\u2212 x).\nDefinition 6.1 (Modified harmonic numbers). Let k \u2208 Z\u22650. For x \u2208 [0, 1), the number Hk,x is defined by\nHk,x =\n{ 1\n1\u2212x + 1 2\u2212x + \u00b7 \u00b7 \u00b7+ 1 k\u2212x if k \u2265 1; 0 if k = 0,\nwhereas for x = 1, Hk,x is defined by\nHk,1 =    1 + 12 + \u00b7 \u00b7 \u00b7 + 1 k\u22121 if k \u2265 2; 0 if k = 1;\n\u2212\u221e if k = 0.\nNote that the numbers Hk,0 correspond to the canonical harmonic numbers Hk, and that for each x, the sequence H0,x,H1,x, . . . is increasing. We define a maximum weighted harmonic welfare allocation parameterized by x. Recall that N+A denotes the set of agents who receive positive utility from an allocation A.\nDefinition 6.2 (MWHWx). For x \u2208 [0, 1), given an instance with matroid-rank valuations, an allocation A is an MWHWx allocation if it maximizes the sum WHWx(A) := \u2211 i\u2208N wi \u00b7Hvi(Ai),x.\nFor x = 1, A is an MWHW1 allocation if it maximizes the number of agents receiving positive utility and, subject to that, maximizes the sum \u2211 i\u2208N+A wi \u00b7Hvi(Ai),1.\nThe quantity Hvi(Ai),x is well-defined because, for matroid-rank valuations, vi(Ai) is always a nonnegative integer. We now prove the efficiency and fairness guarantees of MWHWx allocations, starting with efficiency.\nTheorem 6.3. Let x \u2208 [0, 1]. Under matroid-rank valuations, any MWHWx allocation is PO.\nProof. Let A be an MWHWx allocation. For x < 1, if A is Pareto-dominated by another allocation A \u2032,\nthen \u2211 i\u2208N wi \u00b7Hvi(A\u2032i),x > \u2211 i\u2208N wi \u00b7Hvi(Ai),x, a contradiction.\n12Note that if all agents have equal weights, the number of different shelf heights is only m. The number of transfers is then\nbounded by m2, which matches the bound provided by Benabbou et al. [2021].\nConsider the case x = 1. If A were not PO, there would exist an allocation A\u0302 such that vj(A\u0302j) > vj(Aj) for some j \u2208 N and vi(A\u0302i) \u2265 vi(Ai) for every i \u2208 N \\ {j}. If j \u2208 N \\ N + A , we would have vi(A\u0302i) > 0 for every i \u2208 N + A \u222a{j}, contradicting the assumption that N + A is the largest subset of agents to whom it is possible to give positive utility simultaneously. On the other hand, if j \u2208 N+A , we would have\n\u2211 i\u2208N+A wi \u00b7Hvi(A\u0302i),x > \u2211 i\u2208N+A wi \u00b7Hvi(Ai),x, again a contradiction. Therefore, A is PO.\nFor the fairness guarantee, we will make an assumption that the allocation is clean; we later demonstrate that this assumption is necessary. We also remark that given any MWHWx allocation, one can easily obtain another MWHWx allocation in which every agent receives the same utility as before by iteratively removing any good that does not contribute to its owner\u2019s utility until no such good exists.\nTheorem 6.4. Let x \u2208 [0, 1]. Under matroid-rank valuations, any clean MWHWx allocation satisfies TWEF(x, 1\u2212 x) (and therefore WMEF(x, 1\u2212 x)).\nProof. By Proposition 2.3, it suffices to prove the statement for TWEF(x, 1\u2212 x). Let A be a clean MWHWx allocation. Assume for contradiction that for some i, j \u2208 N , the TWEF(x, 1 \u2212 x) condition from i to j is violated. This means that vi(Ai) < vi(Ai \u222a Aj), and for every g \u2208 Aj it holds that\nvi(Ai) + (1\u2212 x) \u00b7\u2206 + i (Ai, g)\nwi <\nvi(Aj)\u2212 x \u00b7\u2206 \u2212 i (Aj , g)\nwj .\nBy the same argument as in the proof of Theorem 5.1, this implies that\nvi(Ai) + (1\u2212 x)\nwi <\nvj(Aj)\u2212 x\nwj . (19)\nAlso, since vi(Ai) < vi(Ai \u222a Aj), submodularity implies that there exists a good g \u2217 \u2208 Aj such that \u2206+i (Ai, g \u2217) = 1.\nWe now consider two cases depending on whether x = 1.\nCase 1: 0 \u2264 x < 1. If we transfer g\u2217 from Aj to Ai, we obtain an allocation A \u2032 in which vi(A \u2032 i) = vi(Ai)+1, vj(A \u2032 j) = vj(Aj)\u2212 1, and vk(A \u2032 k) = vk(Ak) for all k \u2208 N \\{i, j}. SinceA is an MWHWx allocation, it must be that\nwi \u00b7Hvi(Ai),x +wj \u00b7Hvj(Aj),x \u2265 wi \u00b7Hvi(Ai)+1,x + wj \u00b7Hvj(Aj)\u22121,x.\nThis is equivalent to\nwj \u00b7 1\nvj(Aj)\u2212 x \u2212 wi \u00b7\n1\nvi(Ai) + 1\u2212 x \u2265 0.\nAlgebraic manipulation gives us\nvi(Ai) + 1\u2212 x\nwi \u2265\nvj(Aj)\u2212 x\nwj ,\nwhich contradicts (19).\nCase 2: x = 1. From (19), we have that\nvi(Ai)\nwi <\nvj(Aj)\u2212 1\nwj . (20)\nSince vi(Ai) \u2265 0 and vj(Aj) is an integer, it must be that vj(Aj) \u2265 2. If vi(Ai) = 0, we can transfer g\u2217 from Aj to Ai and increase the number of agents with positive utility, contradicting the assumption that A is an MWHW1 allocation. Hence, vi(Ai) \u2265 1.\nThe rest of the argument proceeds in a similar way as in Case 1. If we transfer g\u2217 from Aj to Ai, we obtain an allocation A\u2032 in which vi(A \u2032 i) = vi(Ai) + 1, vj(A \u2032 j) = vj(Aj)\u2212 1, and vk(A \u2032 k) = vk(Ak) for all k \u2208 N \\ {i, j}. Note that the number of agents with positive utility is the same inA and A\u2032. SinceA is an MWHW1 allocation, it must be that\nwi \u00b7Hvi(Ai),1 + wj \u00b7Hvj(Aj),1 \u2265 wi \u00b7Hvi(Ai)+1,1 + wj \u00b7Hvj(Aj)\u22121,1.\nThis is equivalent to\nwj \u00b7 1\nvj(Aj)\u2212 1 \u2212 wi \u00b7\n1\nvi(Ai) \u2265 0.\nAlgebraic manipulation gives us vi(Ai)\nwi \u2265\nvj(Aj)\u2212 1\nwj ,\nwhich contradicts (20).\nWe now exhibit the necessity of the cleanness condition in Theorem 6.4.\nProposition 6.5. There exists an instance and an allocation such that, for every x \u2208 [0, 1], the allocation is MWHWx but does not satisfy TWEF(x, 1\u2212 x).\nProof. Consider an instance with n = 2 agents whose weights are w1 = 1 and w2 = 2, and m = 6 goods. Agent 1 has an additive valuation with value 1 for g1 and 0 for the remaining goods. Agent 2\u2019s valuation v2 is given by\nv2(S) =\n{ min{3, |S|} if g1 6\u2208 S;\nmin{4, |S|} if g1 \u2208 S,\nfor each bundle S \u2286 G. First, we claim that v2 is matroid-rank. The marginal gain from adding g1 is always 1, while the marginal gain from adding any other good is either 0 or 1. To establish submodularity, let G\u2032 \u2286 G\u2032\u2032 \u2286 G and g \u2208 G\\G\u2032\u2032, and assume that v2(G \u2032\u222a{g}) = v2(G \u2032); it suffices to prove that v2(G \u2032\u2032\u222a{g}) = v2(G \u2032\u2032) as well. From our earlier discussion, it must be that g 6= g1. If g1 \u2208 G \u2032, then |G\u2032\u2032| \u2265 |G\u2032| \u2265 4 and thus v2(G \u2032\u2032 \u222a {g}) = v2(G \u2032\u2032). Assume therefore that g1 6\u2208 G \u2032, which means that |G\u2032| \u2265 3. If G\u2032\u2032 = G\u2032, then v2(G \u2032\u2032 \u222a {g}) = v2(G\n\u2032\u2032) holds trivially. Otherwise, we have |G\u2032\u2032| \u2265 |G\u2032| + 1 \u2265 4, and again v2(G \u2032\u2032 \u222a {g}) = v2(G \u2032\u2032).\nFix x \u2208 [0, 1]. If x = 1, any MWHWx allocation must give g1 to agent 1, which leaves agent 2 with a utility of at most 3. Else, for x < 1, the maximum weighted harmonic welfare achievable by giving g1 to agent 1 is\n1\n1\u2212 x + 2 \u00b7\n( 1\n1\u2212 x +\n1\n2\u2212 x +\n1\n3\u2212 x\n) ,\nwhereas the maximum achievable by giving g1 to agent 2 is\n2 \u00b7\n( 1\n1\u2212 x +\n1\n2\u2212 x +\n1\n3\u2212 x +\n1\n4\u2212 x\n) .\nSince 11\u2212x = 2 2\u22122x > 2\n4\u2212x , every MWHWx allocation must again give g1 to agent 1. In particular, for any x \u2208 [0, 1], the allocation A = ({g1, g2, g3}, {g4, g5, g6}) is an MWHWx allocation.\nTo finish the proof, we show that A violates the TWEF(x, 1 \u2212 x) condition from agent 2 toward agent 1. Note that v2(A2) = 3 < 4 = v2(A2 \u222aA1). Moreover, for any g \u2208 A1, it holds that\nv2(A2) + (1\u2212 x) \u00b7\u2206 + 2 (A2, g)\nw2 \u2264\n3 + (1\u2212 x)\n2 < 3\u2212 x =\nv2(A1)\u2212 x \u00b7\u2206 \u2212 2 (A1, g)\nw1 .\nHence, the TWEF(x, 1\u2212 x) condition from agent 2 to agent 1 is not satisfied.\nBy applying results from the recent work of Viswanathan and Zick [2022a], we show in Appendix B that an MWHWx allocation (which additionally maximizes the unweighted utilitarian welfare across all allocations) can be found in polynomial time.\nFinally, we remark that it may be interesting to consider harmonic welfare beyond binary valuations. In Appendix C, we prove that for agents with equal weights and additive valuations, if the value of every agent for every good is an integer (in which case the harmonic welfare is well-defined), then an allocation maximizing the harmonic welfare is always EF1."
        },
        {
            "heading": "Acknowledgments",
            "text": "This work was partially supported by the Deutsche Forschungsgemeinschaft under grant BR 4744/2-1, by the Singapore Ministry of Education under grant number MOE-T2EP20221-0001, and by an NUS Start-up Grant."
        },
        {
            "heading": "A Round-Robin Algorithm and EF1",
            "text": "In the unweighted setting, it is well-known that if agents have additive valuations, then the round-robin algorithm always produces an EF1 allocation (e.g., [Caragiannis et al., 2019, p. 7]). A natural question is therefore whether the MEF1 condition in Corollary 3.2 can be strengthened to EF1. We show that the answer is negative, even for matroid-rank valuations.\nConsider an instance with m = 8 goods and n = 2 agents with equal weights. Agent 1 has an additive valuation with value 1 for each of g4 and g8, and 0 for the remaining goods. The value of agent 2 for any bundle S is\nv2(S) := |S \u2229 {g4}|+ |S \u2229 {g8}|+min{1, |S \u2229 {g1, g2, g3}|}+min{1, |S \u2229 {g5, g6, g7}|}.\nOne can check that v2 is matroid-rank. 13\nAssume that the round-robin algorithm lets agent 1 pick first, and that the agents break ties in the goods lexicographically. Under these assumptions, agent 1 picks g4, agent 2 picks g1, agent 1 picks g8, agent 2 picks g5, agent 1 picks g2, agent 2 picks g3, agent 1 picks g6, and agent 2 picks g7. Hence, A1 = {g2, g4, g6, g8} and A2 = {g1, g3, g5, g7}, and so v2(A2) = 2 < 3 = v2(A1 \\ {g}) for every g \u2208 A1. This means that agent 2 is not EF1 toward agent 1. Note also that adding the condition vi(Ai) = vi(Ai \u222aAj) as in our definition of TWEF(x, y) does not help circumvent this negative result, as we have v2(A2) = 2 < 4 = v2(A2 \u222aA1).\nB Computing MWHWx allocations\nRecently, Viswanathan and Zick [2022a] introduced a framework for efficiently computing allocations that maximize a range of fairness objectives. Formally, a fairness objective is a function that maps each allocation A (more precisely, the utility vector (v1(A1), . . . , vn(An)) induced by A) to a totally ordered space. A gain function maps each clean allocation and each agent i \u2208 N to a real number.14\n13In fact, v2 belongs to a subclass of matroid-rank valuations called (0, 1)-OXS [Benabbou et al., 2021]. 14Viswanathan and Zick [2022a] also allowed the output of a gain function to be a vector, but we do not need that.\nThey showed that if a fairness objective admits a gain function satisfying certain properties, then an allocation that maximizes the objective (along with the unweighted utilitarian welfare) can be computed in polynomial time.\nLemma B.1 (Viswanathan and Zick [2022a]). Suppose that the fairness objective \u03a8 admits a gain function \u03c6 such that the following conditions are satisfied:\n(i) For any two allocations A and A\u2032, if A Pareto-dominates A\u2032, then \u03a8(A) \u2265 \u03a8(A\u2032).\n(ii) For any clean allocation A and any agent i \u2208 N , let A+i be an allocation resulting from giving a good g 6\u2208 \u22c3 k\u2208N Ak such that \u2206 + i (Ai, g) = 1 to i. Define A\n+j analogously. If \u03c6(A, i) \u2265 \u03c6(A, j), then \u03a8(A+i) \u2265 \u03a8(A+j); equality holds if and only if \u03c6(A, i) = \u03c6(A, j).\n(iii) For any clean allocations A and A\u2032, if |Ai| \u2264 |A \u2032 i|, then \u03c6(A, i) \u2265 \u03c6(A \u2032, i); equality holds if and only if |Ai| = |A \u2032 i|.\n(iv) The gain function \u03c6 can be computed in polynomial time.\nThen, there exists a polynomial-time algorithm that computes an allocation that maximizes the fairness objective \u03a8 as well as the unweighted utilitarian welfare.\nWe now apply Lemma B.1 to MWHWx.\nTheorem B.2. For any x \u2208 [0, 1], under matroid-rank valuations, an MWHWx allocation that maximizes the unweighted utilitarian welfare can be computed in polynomial time.\nProof. Fix x \u2208 [0, 1], and let\n\u03a8x(A) = {\u2211 i\u2208N wi \u00b7Hvi(Ai),x if x < 1;( |N+A |, \u2211 i\u2208N+A wi \u00b7Hvi(Ai),1 ) if x = 1,\nwhere for x = 1 we compare the ordered pairs \u03a8(A) for different allocations A lexicographically. By definition of MWHWx, an allocation A that maximizes \u03a8x(A) is also an MWHWx allocation. It is clear that \u03a8x satisfies condition (i) of Lemma B.1.\nNext, let wmax = maxi\u2208N wi. We define the gain function \u03c6x as follows:\n\u03c6x(A, i) =\n{ wi\n|Ai|+1\u2212x if |Ai| > 0 or x < 1; wmax + 1 if |Ai| = 0 and x = 1.\nSince \u03c6x can be computed efficiently, condition (iv) of Lemma B.1 is satisfied. Condition (iii) is also trivially met.\nIt remains to show that condition (ii) is satisfied. Let A be a clean allocation, so vi(Ai) = |Ai| for all i \u2208 N . Consider any i, j \u2208 N . First, suppose that x < 1. We have\n\u03c6x(A, i) \u2265 \u03c6x(A, j)\u21d0\u21d2 wi\n|Ai|+ 1\u2212 x \u2265 wj |Aj |+ 1\u2212 x\n\u21d0\u21d2 wi \u00b7 (Hvi(Ai)+1,x \u2212Hvi(Ai),x) \u2265 wj \u00b7 (Hvj(Aj)+1,x \u2212Hvj(Aj),x) \u21d0\u21d2 \u03a8x(A +i) \u2265 \u03a8x(A +j).\nThis reasoning also shows that \u03c6x(A, i) = \u03c6x(A, j) if and only if \u03a8x(A +i) = \u03a8x(A +j). Hence, (ii) is satisfied.\nNext, suppose that x = 1. We consider four cases.\nCase 1: |Ai| = |Aj| = 0. We have \u03c61(A, i) = \u03c61(A, j) = wmax + 1. Also,\n\u03a81(A +i) = \u03a81(A +j) =  |N+A |+ 1, \u2211\nk\u2208N+A\nwk \u00b7Hvk(Ak),1\n  ,\nwhere the second coordinate is the same as in \u03a81(A) because H1,1 = 0. Hence, (ii) holds.\nCase 2: |Ai| > |Aj | = 0. We have \u03c61(A, j) = wmax +1 > wi \u2265 \u03c61(A, i), so (ii) holds trivially since the assumption \u03c61(A, i) \u2265 \u03c61(A, j) is not satisfied.\nCase 3: |Aj | > |Ai| = 0. We have \u03c61(A, i) = wmax + 1 > wj \u2265 \u03c61(A, j). Also, the first coordinate of \u03a81(A +i) is |N+A | + 1, whereas that of \u03a81(A +j) is |N+A |, which means that \u03a81(A +i) > \u03a81(A +j). Hence, (ii) holds.\nCase 4: |Ai|, |Aj | > 0. In this case, the same argument as for x < 1 applies.\nTherefore, (ii) is satisfied in all cases, and Theorem B.2 follows readily from Lemma B.1."
        },
        {
            "heading": "C More on Harmonic Welfare",
            "text": "In this section, we assume that all agents have additive valuations, and demonstrate some potential (and limits) of harmonic welfare. Recall that Hk = 1 + 1 2 + \u00b7 \u00b7 \u00b7+ 1 k for each positive integer k and H0 = 0.\nDefinition C.1 (MHW). Given an instance with equal weights and additive valuations in which each agent\u2019s value for each good is an integer, an allocation A is a maximum harmonic welfare (MHW) allocation if it maximizes the harmonic welfare HW(A) := \u2211 i\u2208N Hvi(Ai).\nNote that in the unweighted setting, MHW allocations are the same as MWHW0 allocations defined in Section 6. To establish the EF1 guarantee of MHW allocations, we will use the following lemma, which follows directly by inspecting the left and right Riemann sums of the function f(x) = 1/x. Lemma C.2. For integers b \u2265 a \u2265 1, it holds that \u2211b\nk=a 1 k > ln ( b+1 a ) . Moreover, if a \u2265 2, then\n\u2211b k=a 1 k < ln\n( b\na\u22121\n) .\nTheorem C.3. Suppose that all agents have equal weights and additive valuations, and each agent\u2019s value for each good is an integer. Then, any MHW allocation satisfies EF1.\nProof. LetA be an MHW allocation, and assume for contradiction that for some pair of agents i, j \u2208 N , it holds that Aj 6= \u2205 and vi(Ai) < vi(Aj)\u2212 vi(g) for all g \u2208 Aj . Since each agent\u2019s value for each good is an integer, we have\nvi(Ai) \u2264 vi(Aj)\u2212 vi(g) \u2212 1 (21)\nfor all g \u2208 Aj . In particular, vi(Aj) \u2265 1, and so there exists g \u2208 Aj such that vi(g) \u2265 1. Plugging such a good g into (21), we get vi(Aj) \u2265 2. By (21) again, vi(Aj) \u2265 vi(g) + 1 for each g \u2208 Aj .\nLet B = {g \u2208 Aj : vi(g) > 0}; from the previous paragraph, we have |B| \u2265 2. Since A is an MHW allocation, moving any good g from Aj to Ai cannot increase the harmonic welfare. In particular, vj(g) > 0 for all g \u2208 B, which also means that vj(g) \u2264 vj(Aj)\u2212 1 for each g \u2208 B. We have\nHvi(Ai) +Hvj(Aj) \u2265 Hvi(Ai)+vi(g) +Hvj(Aj)\u2212vj(g)\nfor all g \u2208 B. Equivalently,\n1\nvj(Aj)\u2212 vj(g) + 1 + \u00b7 \u00b7 \u00b7+\n1\nvj(Aj) \u2265\n1\nvi(Ai) + 1 + \u00b7 \u00b7 \u00b7+\n1\nvi(Ai) + vi(g) .\nCombining this with (21) yields\n1\nvj(Aj)\u2212 vj(g) + 1 + \u00b7 \u00b7 \u00b7+\n1\nvj(Aj) \u2265\n1\nvi(Aj)\u2212 vi(g) + \u00b7 \u00b7 \u00b7+\n1\nvi(Aj)\u2212 1 .\nSince vi(Aj) \u2212 vi(g) \u2265 1 and vj(Aj) \u2212 vj(g) + 1 \u2265 2 for every g \u2208 B, applying Lemma C.2 to both sides, we get\nln\n( vj(Aj)\nvj(Aj)\u2212 vj(g)\n) > ln ( vi(Aj)\nvi(Aj)\u2212 vi(g)\n)\nfor all g \u2208 B. This implies that\nvj(Aj)\nvj(Aj)\u2212 vj(g) >\nvi(Aj)\nvi(Aj)\u2212 vi(g) ,\nwhich simplifies to vi(g)/vj(g) < vi(Aj)/vj(Aj) for all g \u2208 B. As a result, we have\nvi(Aj) vj(Aj) =\n\u2211 g\u2208Aj\nvi(g)\u2211 g\u2208Aj vj(g) \u2264 \u2211 g\u2208B vi(g)\u2211 g\u2208B vj(g) < vi(Aj) vj(Aj) ;\nthe first inequality holds because \u2211\ng\u2208Aj vi(g) = \u2211 g\u2208B vi(g) by definition of B and \u2211 g\u2208Aj\nvj(g) \u2265\u2211 g\u2208B vj(g) due to the relation B \u2286 Aj . This yields the desired contradiction.\nIn spite of Theorem C.3, a disadvantage of MHW compared to MNW is that MHW is not scaleinvariant\u2014multiplying the value of a certain agent for every good by the same factor may change the MHW outcome. Moreover, MHW is well-defined only when all utilities are integers. Even though there is a natural extension of the harmonic numbers to the real domain given by Hx = \u222b 1 0 1\u2212tx\n1\u2212t dt for x \u2208 R [Hintze, 2019], MHW defined via this extension is not guaranteed to satisfy EF1.\nProposition C.4. There exists an instance with n = 2 agents with equal weights and additive valuations such that every MHW allocation, where MHW is defined based on the extended harmonic numbers Hx = \u222b 1 0 1\u2212tx 1\u2212t dt, does not satisfy EF1.\nProof. Let m = 3, and assume that the agents\u2019 valuations are given by v1(g1) = 0, v1(g2) = v1(g3) = 4, v2(g1) = 1.9, and v2(g2) = v2(g3) = 2. Clearly, in any MHW allocation, g1 must be allocated to agent 2. We consider the three possibilities.\n\u2022 If agent 1 receives both g2 and g3, the harmonic welfare is H8 +H1.9 > 2.717 + 1.459 = 4.176.\n\u2022 If agent 1 receives one of g2 and g3, the harmonic welfare is H4+H3.9 < 2.084+2.061 = 4.145.\n\u2022 If agent 1 receives neither g2 nor g3, the harmonic welfare is H0 +H5.9 < 0 + 2.435 = 2.435.\nHence, the only MHW allocation gives g1 to agent 2 and both g2 and g3 to agent 1. However, agent 2 is not EF1 toward agent 1 with respect to this allocation."
        }
    ],
    "title": "Weighted Envy-Freeness for Submodular Valuations",
    "year": 2022
}