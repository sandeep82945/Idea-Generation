{
    "abstractText": "In this work, we derive analytical expressions governing state-of-charge and current imbalance dynamics for two parallel-connected batteries. The model, based on equivalent circuits and an affine open circuit voltage relation, describes the evolution of state-of-charge and current imbalance over the course of a complete charge and discharge cycle. Using this framework, we identify the conditions under which an aged battery will experience a higher current magnitude and state-of-charge deviation towards the end of a charge or discharge cycle. This work enables a quantitative understanding of how mismatches in battery capacities and resistances influence imbalance dynamics in parallel-connected battery systems, helping to pave a path forward for battery degradation modeling in heterogeneous battery systems.",
    "authors": [
        {
            "affiliations": [],
            "name": "Andrew Weng"
        },
        {
            "affiliations": [],
            "name": "Sravan Pannala"
        },
        {
            "affiliations": [],
            "name": "Jason B. Siegel"
        },
        {
            "affiliations": [],
            "name": "Anna G. Stefanopoulou"
        }
    ],
    "id": "SP:a1ad3a2748e46a7c27a4a5472bd9966db6707398",
    "references": [
        {
            "authors": [
                "A. 1016/j.est.2019.100781. Fill",
                "K.P. Birke"
            ],
            "title": "Influences of cell",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "Keywords: batteries, current imbalance, SOC imbalance, heterogeneity, parallel, second-life"
        },
        {
            "heading": "1. INTRODUCTION",
            "text": "Battery degradation behavior is often understood in the context of single battery cells. Yet, under real applications, batteries are often connected in parallel to increase available system capacity and power. When non-identical batteries are connected and cycled in parallel, as shown in Figure 1, complex current and state-of-charge (SOC) dynamics can arise due to mismatches in capacities and resistances of the individual batteries. Such dynamics can cause one battery to experience higher peak currents or to become more charged at the end of a charge or discharge, leading to more degradation relative to the other batteries. Several key questions arise: in a parallel-connected battery pack with mismatched battery capacities and resistances, do the degradation trajectories of individual batteries converge or diverge over life? Such questions are foundational to understanding battery management system requirements for aged battery packs. If non-identical batteries cause divergent aging behavior, for example, then efforts to manage second-life battery pack health may become complex and costly. If, however, the aging behavior is shown to be convergent, then heterogeneous battery packs may be able to \u2018self-regulate\u2019, improving the feasibility of deploying such systems in the field. These questions are particularly salient for second-life applications in which aged batteries may be repurposed and reused alongside fresh batteries in a single pack (Zhu et al., 2021).\nThe behavior of parallel-connected batteries has been explored empirically by Luca et al. (2021); Schindler et al. (2021); Diao et al. (2019), who independently demonstrated the potentially significant impact of mismatched resistances and capacities on the current imbalance at the end of a charge cycle. Model-based approaches have also been proposed for pack-level simulations and controls. Bruen and Marco (2016) and Gong et al. (2015) devel-\noped equivalent-circuit based models enabling simulation of current dynamics in parallel-connected systems. Similar models have also recently been applied to develop SOC estimators (Zhang et al., 2020), study the influence of cellto-cell variances on the thermal design of battery packs (Fill and Birke, 2021), and simulate the aging behavior of grid battery systems (Reniers and Howey, 2022). However, despite the existing literature, fundamental analysis of such systems remain challenging due to a lack of first-principles descriptions of current-sharing behavior in parallel-connected batteries.\nIn this work, we focus on deriving analytical equations for current and SOC imbalance for two parallel-connected batteries and analyzing the system\u2019s dynamical properties. Our characterization provides an intuitive but quantitative\nar X\niv :2\n21 1.\n04 96\n1v 1\n[ ee\nss .S\nY ]\n9 N\nov 2\n02 2\nunderstanding of how differences in battery cell capacities and resistances influence the growth rate and magnitude of current and SOC imbalance over the course of a complete charge and discharge cycle. Our analysis requires a linearization of the cell open circuit potential function, so we provide a discussion on model accuracy when compared to a non-linear case. We finally discuss the degradation circumstances that could lead to convergent or divergent degradation pathways for mismatched cells connected in parallel. This work is foundational to understanding how current and SOC imbalance can lead to different degradation outcomes in parallel-connected battery systems."
        },
        {
            "heading": "2. PROBLEM FORMULATION",
            "text": "For this study, we start with the simplest possible representation of a parallel-connected battery system: two battery cells, each represented by an OCV-R model, connected in parallel as shown in Figure 1. We define the following quantities for each cell i \u2208 {a, b}: \u2022 zi(t) \u2208 [0, 1] : cell state of charge (SOC) at time t \u2022 Ui(zi) \u2208 R+ : cell open-circuit voltage (OCV) \u2022 Ri \u2208 R+ : cell internal resistance \u2022 Qi \u2208 R+ : cell capacity \u2022 Ii \u2208 R+ : cell branch current\nRi and Qi are assumed to be constants. Ui is generally a non-linear, monotonically increasing function. The system input is the applied current I which is defined to be negative for charge and positive for discharge. The system output is the terminal voltage, Vt, which is identical for all batteries due to voltage conservation, and is given by\nVt = Ui(zi)\u2212 IiRi. (1)\nCurrent conservation further requires that\nI = \u2211 i Ii. (2)\nApplying (1) and (2) for two parallel-connected cells yields the following relationships for the branch currents and terminal voltage as a function of the input current I:\nVt = RbUa(za) +RaUb(zb)\u2212RaRbI\nR (3)\nIa = Ua(za)\u2212 Ub(zb) +RbI\nR (4)\nIb = Ub(zb)\u2212 Ua(za) +RaI\nR (5)\nwhere\nR , Ra +Rb. (6)\nA key simplification we will make throughout the this work is to assume that the cells have identical and affine OCV functions which take the form\nUi = U 0 + \u03b1zi (7)\nwhere U0, \u03b1 \u2208 R+. U0 is the minimum voltage definition for the battery and \u03b1 characterizes the slope of the OCV function. A discussion of the case of a non-linear OCV function is provided in Section 4.2. For this work, we will take U0 = 3.0V and \u03b1 = 1.2V to approximate an OCV function for commercial lithium-ion battery systems consisting of a metal oxide positive electrode and a graphite negative electrode. With this simplification, the branch currents can be re-written as:\nIa(t) = + \u03b1\nR \u2206z(t) + Rb R I(t) (8)\nIb(t) = \u2212 \u03b1\nR \u2206z(t)\ufe38 \ufe37\ufe37 \ufe38 Irebalance(t) + Ra R I(t)\ufe38 \ufe37\ufe37 \ufe38 IOhmic(t) , (9)\nwhere \u2206z , za \u2212 zb and time-dependent terms have been made explicit for clarity. The first terms in each equation can be thought of as SOC rebalancing currents while the second terms are due to purely Ohmic effects (i.e. resistance mismatches). Equations (8) and (9) highlight the fact that, in the presence of SOC imbalance, internal currents will flow even in the absence of an externally applied current. Note that the SOC rebalancing current increases with the slope of the OCV function \u03b1 and decreases with the total system resistance R."
        },
        {
            "heading": "3. DERIVATION OF IMBALANCE DYNAMICS",
            "text": "In this section, we will derive analytical equations that describe the SOC and current imbalance dynamics for two parallel-connected batteries throughout a full chargedischarge cycle. The key features of the resulting system dynamics are previewed in Figure 2, which shows the imbalance dynamics for an aged battery a connected in parallel with a fresh battery b. The mathematical formalism developed in this section will fully describe the dynamics highlighted in this figure and enable a deeper analysis of the system properties."
        },
        {
            "heading": "3.1 SOC Imbalance",
            "text": "The SOC dynamics for each battery is described by the integrator state\nz\u0307i = \u2212 1\nQi Ii. (10)\nCombining (10) with (8) and (9) yields the following system of equations:\nz\u0307a z\u0307b  = \u03b1R  \u22121 Qa +1 Qa\n+1 Qb \u22121 Qb\n za zb \u2212 1R  Rb Qa\nRa Qb  I. (11) The SOC imbalance dynamics can then be written down by taking the difference between the two states defined in (11) which yields\n\u2206z\u0307(t) = \u2212 \u03b1 R\n( 1\nQa +\n1\nQb ) \ufe38 \ufe37\ufe37 \ufe38\n1/\u03c4\n\u2206z(t) + 1\nR ( Ra Qb \u2212 Rb Qa ) \ufe38 \ufe37\ufe37 \ufe38\n\u03ba/\u03c4\nI.\n(12)\nThis is a standard linear time-invariant (LTI) system which can be readily solved under a galvanostatic (constantcurrent) mode of operation:\n\u2206z(t) = \u2206z0e \u2212t/\u03c4 \u2212 \u03ba(e\u2212t/\u03c4 \u2212 1)I, (13)\nwhere\n\u03c4 = R \u03b1 ( QaQb Qa +Qb ) (14)\n\u03ba = 1\n\u03b1 ( RaQa \u2212RbQb Qa +Qb ) (15)\nand \u2206z0 = za,0 \u2212 zb,0 is the initial SOC imbalance in the system. This system has a single negative eigenvalue \u03bb = \u22121/\u03c4 and is therefore globally exponentially stable.\nSteady-State Properties The SOC imbalance value will decay to a steady-state value given by\n\u2206zss = \u03baI. (16)\nA steady-state SOC imbalance will therefore develop under an applied current even under the absences of an initial SOC imbalance. The magnitude of this imbalance will increase with the current input magnitude and decrease with the slope of the OCV function \u03b1 due to (15). An interesting implication of this result is that battery chemistries with shallower OCV function slopes, such as lithium-iron phosphate (LFP) batteries, will experience more steadystate SOC imbalance during operation. However, towards the end of the charge curve, the same OCV function will typically rise sharply, accelerating the decay towards zero SOC imbalance. We also note that the steady-state SOC imbalance will approach zero as RaQa approaches RbQb due to (15). This scenario resembles the case of aged batteries in which resistance rise typically occurs in tandem with capacity decreases.\nConvergence Rate The convergence rate of the system towards \u2206zss is understood through (14), which predicts that SOC rebalancing times decrease when battery capacities and resistances are lower, or with steeper OCV function slopes.\nA key question is whether the steady-state condition is realizable over the course of a single charge or discharge cycle. If it is, then the steady-state values may be a useful metric to consider under certain degradation modeling contexts. For example, the steady-state imbalance values could be used as a proxy for the total damage accrued over a single charge-discharge cycle. To evaluate whether or not a given steady-state imbalance value is realizable by the end of a single cycle, we consider a minimum observation time of 3\u03c4 , by which point the imbalance will have progressed to 95% of its steady-state value. The C-rate must therefore be sufficiently low to enable this minimum observation time. The necessary condition for observing steady-state imbalance can be summarized as\nCrate < zmax \u2212 zmin\n3\u03c4 . (17)\nIn the above equation, we introduced a multiplicative factor zmax \u2212 zmin which represents the range of SOCs accessed for this particular cycle, where zmax and zmin are the maximum and minimum SOCs accessed during the cycle. This additional term accounts for the fact that shallower SOC cycling will require even lower Crates to observe the steady-state condition before the cycle ends. The condition described by (17) can often be realized under practical applications. For example, consider a system with (Qa, Ra) = (4 Ah, 35 m\u2126) and (Qb, Rb) < (5 Ah, 25 m\u2126). For this system, 3\u03c4 = 0.33 hours, and we will further assume that the system charges from 67% to 100% SOC so that zmax \u2212 zmin = 0.33. Application of (17) predicts that a C-rate of less than 1C is sufficient for the steady-state value to be realized before charging ends. By comparison, Level 2 charging for electric vehicles typically take between 3 to 8 hours, which corresponds to an equivalent C-rate well under 1C."
        },
        {
            "heading": "3.2 Current Imbalance",
            "text": "An expression for \u2206I , Ia \u2212 Ib can now be obtained by direct substitution of (13) into (8) and (9) to yield\n\u2206I(t) = 2\u03b1\nR \u2206z(t)\ufe38 \ufe37\ufe37 \ufe38\n\u2206Irebalance(t)\n\u2212 \u2206R R\nI\ufe38 \ufe37\ufe37 \ufe38 \u2206IOhmic(t) , (18)\nwhere R , Ra +Rb as before, and\n\u2206R , Ra \u2212Rb. (19)\nEquation (18) provides several useful interpretations of current imbalance. First, the current imbalance can now be readily interpreted as the output equation of the SOC imbalance state equation (13) in a state-space representation. The current imbalance dynamics therefore inherits the stability properties, convergence properties, and time constant of the SOC imbalance system. Second, the current imbalance can be viewed as the difference between the SOC rebalancing current (first term) and the Ohmic contribution due to the resistance mismatch (second term). These two terms have opposite signs, making it possible to achieve zero steady-state current imbalance even under the presence of a non-zero SOC imbalance.\nThe steady-state current imbalance can be written as\n\u2206Iss = 2\u03b1\nR \u2206zss \u2212\n\u2206R\nR I. (20)\nAfter substitution of \u2206zss from (16), it can be shown that\n\u2206Iss = ( Qa \u2212Qb Qa +Qb ) I. (21)\nEquation (21) predicts that capacity-matching is sufficient for guaranteeing zero steady-state current imbalance, irrespective of the degree of resistance mismatch. To better understand this counter-intuitive result, consider the fact that both the SOC rebalancing current and the Ohmic current increase as the resistance mismatch between the two batteries increase, but since these two terms have opposite signs, the net effect of the resistance mismatch on current imbalance is nullified. This \u2018exact-cancellation\u2019 result is due to the assumption of affine OCV and is not generally expected to hold in the case of non-linear OCV functions (see Section 4.2)."
        },
        {
            "heading": "3.3 Potentiostatic Mode",
            "text": "So far, we have focused on deriving equations that are valid under the constant-current (i.e. galvanostatic) mode of operation. However, battery charging systems typically switch to a constant-voltage (i.e. potentiostatic) mode towards the end of a charge cycle when some upper voltage limit is reached. During the constant-voltage charging stage, the total system current decays toward zero as the individual battery SOCs asymptotically approach unity. This section focuses on deriving the imbalance equations for the constant-voltage mode of operation.\nTo start, we invert the input and output from (3) to express the total current I as a function of a fixed voltage set-point Uf , which, when combined with the affine OCV assumption (7), yields\nI = \u03b1(zaRb + zbRa)\u2212\u2206UR\nRaRb (22)\nwhere R = Ra+Rb as defined before, and \u2206U , Uf \u2212U0. Substituting (22) into (4) and (5) leads to two branch current expressions:\nIi(t) = \u03b1zi(t)\u2212\u2206U\nRi (23)\nwhere i \u2208 {a, b}. The SOC dynamics can then be obtained by substituting (23) into (10), which yields\nz\u0307a z\u0307b  = \u2212 \u03b1QaRa 0\n0 \u2212 \u03b1QbRb\n za zb +  1QaRa\n1 QbRb \u2206U. (24) Equation (24) is another LTI system which is readily solved to obtain:\nzi(t) = zi,0e \u2212t/\u03c4i \u2212 1\n\u03b1 (e\u2212t/\u03c4i \u2212 1)\u2206U (25)\nwhere i \u2208 {a, b} and the time constants \u03c4i are defined by\n\u03c4i , QiRi \u03b1 . (26)\nThe SOC and current imbalance dynamics during potentiostatic mode of operation can then be obtained directly from (23) and (25)."
        },
        {
            "heading": "3.4 Summary of the Imbalance System Behavior",
            "text": "We now have the means to quantitatively understand the system characteristics shown in Figure 2. In this scenario, the battery parameters used were (Qa, Ra) = (5 Ah, 50 m\u2126), and (Qb, Rb) = (5.6 Ah, 33 m\u2126). The current input was I = \u22121.67A during charge and I = 1.67A during discharge, the maximum voltage was set to 4.2V, and the constant-voltage hold cut-off condition was set to 83 mA. Battery a started at 5% lower SOC than battery b. The system then underwent a constant-current, constantvoltage charging protocol, followed by a constant-current discharge. The persistent SOC and current imbalance observed during both charge and discharge can now be quantitatively explained by (16) and (21). The initially large current imbalance at the beginning of the charge cycle is due to the SOC rebalancing current which forced current from battery b to flow into battery a. Toward the end of the charge cycle, the total current imbalance can be shown to include contributions from both a steady-state SOC rebalancing current and a steady-state Ohmic current. The SOC imbalance decreased during the constant-voltage hold step, leading to a smaller spike in current imbalance at the beginning of the discharge step."
        },
        {
            "heading": "4. DISCUSSION",
            "text": "This section dives deeper into several aspects of the current and SOC imbalance system properties. Section 4.1 introduces the concept of (q, r) maps to answer questions about which battery will see higher currents and SOCs. Section 4.2 comments on the validity of the affine OCV assumption. Finally, Section 4.3 briefly discusses the implications of SOC and current imbalance on long-term aging behavior of parallel-connected battery systems.\n4.1 (q, r) Maps: Which Battery Will Experience Higher Currents and SOCs?\nHere, we will use Figure 3 to understand how different combinations of resistances and capacities affect the steady-state behavior of the imbalance system. Defining\nr , Ra/Rb q , Qa/Qb, (27)\na map of \u2206zss and \u2206Iss as a function of q and r (16,21) can then be built. The figure highlights regions in (q, r)space under which imbalance values are either positive or negative. Each subplot is centered at (1, 1) which corresponds to a system having two perfectly-matching batteries (circle marker). The top left quadrants (red boxes) correspond to regions in which battery a is more aged than battery b, with Qa < Qb and Ra > Rb. The contour labels indicate the amplitude of the steady-state values during charge.\nThe top panel shows that zero steady-state SOC imbalance is achieved under the condition q = r\u22121, or equivalently, RaQa = RbQb (16). Hence, zero steady-state SOC imbalance is achievable even in systems with mismatched capacities and resistances. In particular, as battery a ages, Ra increases while Qa decreases, so RaQa may remain sufficiently close to RbQb such that the steady-state SOC imbalance remains close to zero. A system described by (0.8, 1.25) (square marker), for example, represents an aged battery with 20% capacity loss and 25% resistance growth which achieves exactly zero steady-state SOC imbalance. In general, the condition q > r\u22121 must be satisfied in order for the aged battery a to experience a comparatively lower SOC at the end of a charge cycle.\nThe bottom panel shows that q = 1 is sufficient for attaining zero steady-state current imbalance and irrespective of the value of r (see Section 3.2). This result implies that an aged battery a, when connected with a fresh battery b (red region), will always experience a lower steady-state current magnitude for any r provided that q < 1.\nThe (q, r)-map also illustrates the existence of scenarios in which steady-state SOC imbalance persists even in the absence of current imbalance, and vice versa. For example, the system (0.8, 1.25) (square markers) achieves zero SOC imbalance, yet still experiences a current imbalance of 0.2A at steady-state. Meanwhile, the system (1, 1.25) (triangle markers) reaches zero current imbalance, yet, an SOC imbalance persists at steady-state. We finally note that the numerical values in Fig. 3 are provided for the case of charging. During discharge, values in the (q, r)-maps will flip signs. A similar analysis can then be repeated to\nshow that an aged battery a, when connected to a fresh battery b, will continue to experience lower steady-state current magnitudes for any r and q < 1, and that battery a will also experience higher steady-state SOCs (i.e. be less discharged) when q > r\u22121."
        },
        {
            "heading": "4.2 Comments on the Affine OCV Assumption",
            "text": "A key assumption used in our derivation was that the battery OCV functions were affine and identical. Here, we explore the applicability of the linear model towards more practical battery systems having non-linear OCV curves. To begin, we numerically simulated the imbalance\ndynamics for two additional cases: a non-linear OCV function and a piecewise-affine OCV function. The nonlinear OCV function was adapted from Chen et al. (2020) and represents a battery comprising a nickel manganese cobalt (NMC) positive electrode and graphite negative electrode. The piecewise-affine OCV function consisted of four linear segments which approximate the non-linear OCV function. The individual battery SOC and current dynamics were then solved numerically in discrete time using using a forward Euler approach.\nThe simulation results are shown in Figure 4. The first row shows the (q, r)-maps for SOC imbalance (\u2206zf ) and current imbalance (\u2206If ). These values correspond to the final imbalance value when the maximum voltage of 4.2V was reached and are analogous to the steady-state values \u2206zss and \u2206Iss reported previously. However, in this case, steady-state convergence is not guaranteed due to the nonlinear OCV function. We observe that the non-linear system behaves in a qualitatively similar way compared to the non-linear system, but the numerical values differ. Now, the system (0.8, 1.25) no longer achieves zero \u2018steady-state\u2019 SOC imbalance as was the case for the linear system, and the \u2018steady-state\u2019 current imbalance has become dependent on r. To further study these differences, we plotted the evolution of the SOC and current imbalance over time for the case (q, r) = (0.8, 1.25). The analytic (linear) result underestimated the degree of SOC imbalance and could\nnot capture the inflection point in the current imbalance towards the end of charge. The system using a piecewiseaffine function, however, was successful at approximating the non-linear case.\nOverall, we observe that the model assuming an affine OCV function can provide correct qualitative trends compared to a system with a non-linear OCV function. The numerical accuracy of the linear model will, however, expectedly deteriorate for systems having large non-linearities in the OCV function."
        },
        {
            "heading": "4.3 From Current and SOC Imbalance to Divergent Aging",
            "text": "SOC and current imbalances can act as precursors to possible divergent aging over cycle life. To motivate further work in this area, we will briefly highlight several aging scenarios to illustrate the rich connection between imbalance dynamics and degradation dynamics. Recall that, in Figure 3, we identified the fact that an aged battery a will always experience lower current magnitudes at steadystate compared to the fresh battery b. The lower current magnitude causes battery a to more protected against lithium plating compared to battery b over life, since the negative electrode overpotential for battery a will be comparatively higher at the end of charge (Yang et al., 2017). Now, consider the possibility that q < r\u22121, in which case the aged battery a will additionally realize higher SOCs at\nthe end of charge compared to battery b. The positive electrode of battery a will therefore be more delithiated at the end of charge compared to battery b. A more delithiated positive electrode is associated with strain-induced loss of active material (O'Kane et al., 2022), so battery a will experience more active material loss compared to battery b. Hence, we have identified a scenario under which the aged battery a is more protected against lithium plating, while simultaneously being less protected against active material loss. The overall degradation rate of battery a will depend on the degradation modeling assumptions, such as the relative contribution of lithium plating versus active material losses to the total capacity loss (O'Kane et al., 2022). In summary, imbalance dynamics will inevitably manifest as differences in degradation trajectories. The analytic description of the imbalance dynamics established in this paper sets the stage for more detailed studies to answer the ultimate question: \u201cunder what conditions do aging trajectories converge in parallel-connected battery systems?\u201d"
        },
        {
            "heading": "5. CONCLUSION AND FUTURE WORK",
            "text": "In this work, we derived state equations for SOC and current imbalance dynamics in two parallel-connected batteries assuming affine and identical OCV functions (13,18). The steady-state values for SOC and current imbalance (16,21) reveal the conditions under which an aged battery will experience higher SOCs and more currents at the end of a charge cycle. Importantly, we found that an aged battery, when connected in parallel with a fresh battery, will always experience lower current magnitudes at the end of a charge or discharge cycle. We relaxed the assumption of an affine OCV function to show that the steady-state analysis can qualitatively capture the correct trends when compared against the general non-linear case. We finally discussed how the steady-state SOC and current imbalance values can be thought of as precursors to heterogeneous aging in parallel-connected packs.\nThis work represents a necessary step towards degradation modeling in parallel-connected battery systems. From here, battery aging dynamics can be further developed, which leverages the analytical equations derived in this paper to provide a cycle-by-cycle accounting of how capacities and resistances of the individual batteries evolve, e.g. due to differences in steady-state SOC and current imbalance. The derivation described in this work can also be generalized to the case of an arbitrary number of cells connected in parallel. Finally, model parameters such as resistance can be augmented with temperature and SOCdependence to improve model accuracy under real-world scenarios."
        }
    ],
    "title": "Parallel-Connected Battery Current Imbalance Dynamics",
    "year": 2022
}