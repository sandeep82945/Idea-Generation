{
    "abstractText": "The beam-oriented digital predistortion (BO-DPD) is not sufficient to linearize the output from a subarray of power amplifiers (PAs) in different directions except the desired direction. Therefore, subsequent to the BO-DPD operation, we perform a post-weighting (PW) processing to minimize the nonlinear radiations in the wide range of directions under crosstalk. Here, the optimized PW coefficients are multiplied by the polynomial terms of the BO-DPD, then, the resultant signals are distributed to the PAs to compensate the nonlinear radiations. In this work, first, we propose fully-featured post-weighting (FFPW) scheme, then, we derive a low-complexity post-weighting (LC-PW) scheme.",
    "authors": [
        {
            "affiliations": [],
            "name": "Ganesh Prasad"
        }
    ],
    "id": "SP:355f96d60ac922aec5711944b1de393ad5474acd",
    "references": [
        {
            "authors": [
                "H. Yan",
                "D. Cabric"
            ],
            "title": "Digital predistortion for hybrid precoding architecture in millimeter-wave massive MIMO systems",
            "venue": "Proc. IEEE ICASSP, LA, USA, Mar. 2017, pp. 3479\u20133483.",
            "year": 2017
        },
        {
            "authors": [
                "Q. Luo",
                "X.-W. Zhu",
                "C. Yu",
                "W. Hong"
            ],
            "title": "Single-receiver over-theair digital predistortion for massive MIMO transmitters with antenna crosstalk",
            "venue": "IEEE Trans. Microw. Theory Tech., vol. 68, no. 1, pp. 301 \u2013 315, Jan. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "A. Brihuega"
            ],
            "title": "Digital predistortion for multiuser hybrid MIMO at mmwaves",
            "venue": "IEEE Trans. Signal Process., vol. 68, pp. 3603 \u2013 3618, May 2020.",
            "year": 2020
        },
        {
            "authors": [
                "E. Ng",
                "Y. Beltagy",
                "P. Mitran",
                "S. Boumaiza"
            ],
            "title": "Single-input singleoutput digital predistortion of power amplifier arrays in millimeter wave RF beamforming transmitters",
            "venue": "Proc. IEEE Int. Microw. Symp.-IMS, Philadelphia, PA, USA, Jun. 2018, pp. 481\u2013484.",
            "year": 2018
        },
        {
            "authors": [
                "C. Yu"
            ],
            "title": "Full-angle digital predistortion of 5G millimeter-wave massive MIMO transmitters",
            "venue": "IEEE Trans. Microw. Theory Tech., vol. 67, no. 7, pp. 2847\u20132860, Jul. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "J. Yan",
                "H. Wang",
                "J. Shen"
            ],
            "title": "Novel post-weighting digital predistortion structures for hybrid beamforming systems",
            "venue": "IEEE Commun. Lett., vol. 25, no. 12, pp. 3980\u20133984, Dec. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "B. Khan"
            ],
            "title": "Statistical digital predistortion of 5G millimeter-wave RF beamforming transmitter under random amplitude variations",
            "venue": "IEEE Trans. Microw. Theory Tech., vol. 70, no. 9, pp. 4284\u20134296, Sep. 2022.",
            "year": 2022
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n30 4.\n05 79\n5v 3\n[ cs\n.N I]\n3 0\nA ug\n2 02\n3 1\nIndex Terms\u2014Predistortion, polynomial model, subarray of PAs, post-weighting, convex optimization\nI. INTRODUCTION\nFor efficient transmission of signals, radio frequency (RF) power amplifiers (PAs) play an important role. However, the design of highly linear PAs over the large dynamic range of the signals is expensive. Further, it is costly for a massive multiple-input multiple-output (mMIMO) transmitter with a large number of PAs under crosstalk. So, the linearization requires a less complex and proficient predistortion scheme.\nInitially, the multiple antennas transmitter was linearized using a single digital predistortion (DPD) by considering equal nonlinear characteristics of its PAs [1]. However, in practice, the nonlinear characteristics are not equal and later, instead of fully linearizing all PAs, the beam-oriented (BO) output in a desired direction was linearized using a single DPD, known as BO-DPD1 under crosstalk [2], [3]. But, it is not able to provide the linearization in other directions except the desired direction, thus, it gives nonlinear sidelobes in the BO output. Then, it is realized that a single DPD with one predistorted output signal is not sufficient to linearize all the PAs of different nonlinearites [4]. Later, the full linearization of the PAs was achieved by including a tuning box to each PA. But, it has high complexity as each tuning box requires a training [5].\nRecently, in a post-weighting (PW) scheme, a single DPD training followed by a post-weighting (PW) optimization is used to generate more than one predistorted signal in a subarray, then, these signals are distributed to multiple PAs to address their nonlinearities [6]. But, it provides only one PW coefficient (one degree of freedom (DOF)) per PA that is not sufficient to linearize the multiple PAs. In the proposed PW scheme, the DOF per PA is increased with less complexity\nG. Prasad and H. Johansson are with the Division of Communication Systems, Department of Electrical Engineering, Linko\u0308ping University, 581 83 Linko\u0308ping, Sweden (e-mail: {ganesh.prasad, hakan.johansson}@liu.se).\n1In this work, the terms DPD and BO-DPD are used interchangeably.\nDPD\nRF-Chain\nwk1 ck1\nRF-Chain\nPW }NRF\nS0\nS1\nSN RF\n}\n}nPA\nwkn PA wk(S\u2212n PA +1)\nckn PA\nwkS\nck(S\u2212n PA +1)\nckS\nComb. A D C T ra in in g\n} Q+ 1\n} Q\nn PA\n\u03a6\u0302k\nsk c\u0302k\nxk\nFig. 1. An architecture of a DPD followed by a PW predistortion.\nby reducing the adders, multipliers, and the RF chains. In this regard, the key contribution of this work is three-fold. (i) First, using the dual-input polynomial models of the PAs, an approximate relationship is established between the crosstalks at the PAs and the crosstalk compensation signal to the BODPD. Then, using it, we train the DPD. (ii) Next, we propose a fully-featured PW (FF-PW) scheme and using it, we derive a low-complexity PW (LC-PW) scheme. Based on it, the system parameters are arranged non-trivially into suitable vectors and matrices to simplify the system analysis. (iii) Further, an expression for nonlinear radiation from the BO transmitter operating with DPD and PW is obtained. Using it, a convex minimization problem is formulated. Then, its optimal PW coefficients are obtained in a closed form. Finally, numerical results are obtained to get various design insights."
        },
        {
            "heading": "II. SYSTEM DESCRIPTION AND BO-DPD TRAINING",
            "text": ""
        },
        {
            "heading": "A. System Architecture",
            "text": "In a mMIMO transmitter, we consider a uniform linear array of K \u00d7 S PAs where each of K subarrays contains S PAs. The message vector that needs to be transmitted is s = [s1, \u00b7 \u00b7 \u00b7 , sK ]\nT , where sk is the message to be transmitted by the kth subarray. Fig. 1 represents an architecture for the linearization of the kth subarray under crosstalk signals {ckl}; l \u2208 {1, \u00b7 \u00b7 \u00b7 , S} using two layers of predistortion operations: DPD followed by the PW predistortion. Here, ckl is the crosstalk signal at lth PA of the kth subarray due to transmit signals from the remaining PAs. In this scheme, first, the DPD is trained separately for the BO output from the subarray. Thus, during the training of the DPD, the PAs are directly connected to the DPD and isolated from the PW block by closing the switch S0 and opening the switches, {Si}; i \u2208 {1, \u00b7 \u00b7 \u00b7 , N\nRF }, where N RF (\u2264 S) is the number of RF\nchains in the subarray. In the training, the message sk and\n2 the signal ck are inputted to the dual-input DPD, where ck is obtained from the training block as shown in the figure. Using them, the DPD generates the predistorted signal xk to address the nonlinearties of the PAs under the crosstalks {ckl}. Using Fig. 1, the generation of xk can be described as follows. The dual-input DPD is modeled using a polynomial model (as described later using (1a)), having Q+ 1 terms which are its outputs. Each term is a basis function (of sk and ck) multiplied by its coefficient. The Q+1 coefficients are represented by a vector \u03a6k which needs to be trained in the training block. The resultant predistorted signal from the DPD is xk which is the sum of Q + 1 outputs (cf. (1a) in Section II-B)2. Thereafter, xk is multiplied by the analog beamforming weights, {wkl} to get the BO output in a given direction, where wkl (|wkl| = 1) is the analog phase shifter to the lth PA of the kth subarray and they are represented in a vector wk = [wk1, \u00b7 \u00b7 \u00b7 , wkS ] T . The BO output is feedback to the training block to train the coefficients \u03a6k and the signal ck using the iterative method as described in Section II-C. At the end of the training, their estimated values, \u03a6\u0302k and c\u0302k are obtained. Using them, the trained DPD provides the Q + 1 outputs that are connected to the PAs via the PW block after opening S0 and closing {Si}. In the PW block, the PW coefficients (dedicated for each n\nPA = S/N RF PAs to enhance the predistortion DOF) are multiplied by the Q nonlinear outputs of the DPD. Thereafter, the PW block outputs the N\nRF number of signals and each of\nthese signals are distributed to n PA number of PAs to get the desired BO output."
        },
        {
            "heading": "B. Dual Input Polynomial Model of DPD and PAs",
            "text": "We consider the dual-input memoryless polynomial models3 [2] for the the DPD and PAs. After omitting the nonlinear terms of the signal ck, the output xk of the DPD as a function of sk and ck can be expressed as in (1a) which is further represented in matrix form in (1b).\nxk =\n(P\u22121)/2\u2211\np=0\n\u03c60kp\u03c8 0 p(sk) +\n(P\u22121)/2\u2211\np=0\n\u03c61kp\u03c8 1 p(sk)ck +\n(P\u22121)/2\u2211\np=1\n\u03c62kp\u03c8 2 p(sk)c \u2217 k,(1a)\nxk = \u03a8\u0306(sk, ck)\u03a6\u0306k; k \u2208 {1, 2, \u00b7 \u00b7 \u00b7 ,K}, (1b)\nwhere P is the order of the polynomial4 and \u03a8\u0306(sk, ck) = [\u03a80(sk),\u03a8 1(sk)ck,\u03a8 2(sk)c \u2217 k] is the row vector of basis functions, \u03a8v(sk) = [\u03c8 v \u00b5(sk), \u00b7 \u00b7 \u00b7 , \u03c8 v (P\u22121)/2(sk)] for v \u2208 {0, 1, 2}. \u03c80p(sk) = s p+1 k s \u2217 k p, \u03c81p(sk) = s p ks \u2217 k p, and \u03c82p(sk) = sp+1k s \u2217 k p\u22121. \u00b5 is the initial value of p and \u00b5 = 1 for v = 2; otherwise, \u00b5 = 0. \u03a6\u0306k is a column vector of the coefficients for the basis functions in \u03a8(sk, ck), given by \u03a6\u0306k = [\u03a6 0 k T ,\u03a61k T ,\u03a62k T ]T . \u03a6vk = [\u03c6 v k\u00b5, \u00b7 \u00b7 \u00b7 , \u03c6 v k(P\u22121)/2] T and \u03c6vkp is the coefficient of basis \u03c8 v p(sk). Note that \u03a8\u0306(sk, ck) and \u03a6\u0306k contain the basis functions and coefficients for the polynomial of order P in (1a). However, in practice, certain basis\n2A conventional DPD has one output xk based on a polynomial model [2]. But, here, each term of the polynomial is further processed by the PW block (cf. Fig. 1), thus, the DPD has Q+ 1 outputs and xk is the sum of them.\n3For simplicity, we consider the memoryless polynomial models, however, the proposed work is equally applicable for memory polynomial models.\n4Although, for simplicity, the orders of the polynomials are represented by the same symbol, P in (1a) and (2a), they can take different values.\nfunctions with their nonzero coefficients play the dominant role in predistortion for a given type of PAs. Thus, in general, if (Q+1) basis functions have their dominant role in the predistortion, then, the basis row vector \u03a8(sk, ck) is defined as: \u03a8(sk, ck) , [\u03c8 v1 p1C v1 k , \u00b7 \u00b7 \u00b7 , \u03c8 v(Q+1) p(Q+1)C v(Q+1) k ] and corresponding coefficient column vector is: \u03a6k , [\u03c6 v1 kp1 , \u00b7 \u00b7 \u00b7 , \u03c6 v(Q+1) kp(Q+1) ]T . Here, Cvik = \u03b4(vi) + ck\u03b4(vi \u2212 1) + c \u2217 k\u03b4(vi \u2212 2), pi \u2208 {0, \u00b7 \u00b7 \u00b7 , (P \u2212 1)/2}, vi \u2208 {0, 1, 2} for i \u2208 {1, \u00b7 \u00b7 \u00b7 , (Q + 1)}, Q is the number of nonlinear basis functions, and only one basis function, \u03c8vipiC vi k = sk is linear for pi = vi = 0 (thus, the total number of basis functions is (Q + 1)). \u03b4(\u00b7) is the Kronecker delta function. Hereafter, we consider the DPD in \u03a8(sk, ck) and \u03a6k. Moreover, output signal vector of K DPDs is denoted as x = [x1, \u00b7 \u00b7 \u00b7 , xK ] T .\nSimilarly, based on dual input memoryless polynomial model, for the inputs, xk and ckl to the lth PA of the kth subarray, its output ykl is expressed as in (2a) and its matrix form in (2b). ykl = \u2211(P\u22121)/2 p=0 \u03c6 0 klp\u03c8 0 p(wklxk) + \u2211(P\u22121)/2 p=0 \u03c6 1 klp\u03c8 1 p(wklxk)ckl\n+ \u2211(P\u22121)/2\np=1 \u03c6 2 klp\u03c8 2 p(wklxk)c \u2217 kl (2a)\nykl =\u03a8\u0306(wklxk, ckl)\u03a6\u0306kl; l \u2208 {1, 2, \u00b7 \u00b7 \u00b7 , S}, (2b)\nwhere \u03a8\u0306(wklxk, ckl) and \u03a6\u0306kl are the row and column vectors of the basis functions and its coefficients respectively. They can be represented similarly as described above for the DPD basis functions and coefficients with additional suffix l to represent it for lth PA of the subarray. Further, for a given type of PAs, similar to the DPD, the Q \u2032\n+ 1 dominant basis functions to identify them can be represented in a row vector \u03a8(wklxk, ckl) and corresponding coefficients in a column vector can be given by \u03a6kl. Note that the PAs coefficients \u03a6kl; l \u2208 {1, \u00b7 \u00b7 \u00b7 , S} are assumed to be known which can be identified using least square (LS) estimation as described briefly in the numerical section. Further, all the outputs from the PAs can be expressed in a matrix form as:\nYk = \u2126k\u0398k, (3)\nwhere Yk = [yk1, \u00b7 \u00b7 \u00b7 , ykS ] T , \u2126k = diag([\u03a8(wk1xk, ck1) T , \u00b7 \u00b7 \u00b7 , \u03a8(wkSxk, ckS) T ]T ) and \u0398k = [\u03a6 T k1, \u00b7 \u00b7 \u00b7 ,\u03a6 T kS ] T .\nUsing (3), for the stearing vector h \u03d5 k at angle (direction) \u03d5\nto the vertical plane of the array, the BO signal z\u03d5k is:\nz\u03d5k = h \u03d5 k T Yk = h \u03d5 k T \u2126k\u0398k, (4)\nwhere h \u03d5 k = [h \u03d5 k1, \u00b7 \u00b7 \u00b7 , h \u03d5 kS ] T and h\u03d5kl is the lth steering element. As ckl cannot be measured at the lth PA, it can be expressed as a linear combination of the transmit signals from the other PAs as [2]:\nckl = \u2211K\ni=1 \u2211S r=1 \u03bb \u2032 kl,iryir = \u03bb \u2032 klY , (5)\nwhere \u03bb \u2032 kl = [\u03bb \u2032 kl,1, \u00b7 \u00b7 \u00b7 ,\u03bb \u2032 kl,K ], and \u03bb \u2032 kl,i = [\u03bb \u2032\nkl,i1, \u00b7 \u00b7 \u00b7 , \u03bb \u2032 kl,iS ], and Y = [Y T 1 , \u00b7 \u00b7 \u00b7 ,Y T K ] T . \u03bb \u2032 kl,ir is the coefficient for contribution in crosstalk signal ckl at lth PA of the kth subarray from rth PA of the ith subarray. Simplifying (5) in linear terms of cir and xk after omitting the negligible nonlinear terms, we get ckl as in (6a). Further, it is expressed in a matrix form in (6b), then, simplified\n3 to (6c).\nckl = \u2211K\ni=1 \u2211S r=1 [ \u03bb \u2032 kl,ir\u03c6 0 ir0wirxi + \u03bb \u2032 kl,ir\u03c6 1 ir0cir ] (6a)\nc = A0WDx+A 1c (6b)\n\u21d2 c = (I \u2212A1)\u22121A0WDx = \u039bWDx, (6c)\nwhere c = [cT1 , \u00b7 \u00b7 \u00b7 , c T K ] T , ck = [ck1, \u00b7 \u00b7 \u00b7 , ckS ] T , Av = \u039bdiag(\u03a6 v\n1, \u00b7 \u00b7 \u00b7 ,\u03a6 v K), \u03a6 v k = [\u03c6 v k10, \u00b7 \u00b7 \u00b7 , \u03c6 v kS0] for\nv \u2208 {0, 1}, \u039b = [\u03bb \u2032T 11 , \u00b7 \u00b7 \u00b7 ,\u03bb \u2032T 1S , \u00b7 \u00b7 \u00b7 , \u03bb \u2032T K1, \u00b7 \u00b7 \u00b7 ,\u03bb \u2032T KS] T , and WD = diag([w11, \u00b7 \u00b7 \u00b7 , w1S ] T , \u00b7 \u00b7 \u00b7 , [wK1, \u00b7 \u00b7 \u00b7 , wKS ]\nT ). From (6c), \u039b = (I \u2212 A1)\u22121A0 which is nothing but the coefficients associated with the weighted signal vector WDx to get c. It can be expressed as \u039b = [\u039bT1 , \u00b7 \u00b7 \u00b7 ,\u039b T K ] T , where \u039bk = [\u03bb T k1, \u00b7 \u00b7 \u00b7 ,\u03bb T kS ]\nT and \u03bbkl = [\u03bbkl,11, \u00b7 \u00b7 \u00b7 , \u03bbkl,1S , \u00b7 \u00b7 \u00b7 , \u03bbkl,K1, \u00b7 \u00b7 \u00b7 , \u03bbkl,KS ]. Next, using (4) and (6c), we describe the training of the BO-DPD."
        },
        {
            "heading": "C. Training of BO-DPD",
            "text": "In [2], the relationship between ck and ck is obtained without considering wk. To include wk, first, we consider the same approximation, \u03bbkl,ir \u2248 \u03b1l\u03bbki due to uniform and linear arrangement of PAs [2]. It denotes that the crosstalk from rth PA of the ith subarray to lth PA of the kth subarray with coefficient \u03bbkl,ir can be approximated to \u03b1l times the overall crosstalk from the ith subarray to kth subarray with coefficient \u03bbki. Applying it to \u03bbkl (cf. Section II-B), we get: \u03bbkl \u2248 \u03b1l[\u03bbk1, \u00b7 \u00b7 \u00b7 , \u03bbk1\ufe38 \ufe37\ufe37 \ufe38\nS times\n, \u00b7 \u00b7 \u00b7 , \u03bbkK , \u00b7 \u00b7 \u00b7 , \u03bbkK\ufe38 \ufe37\ufe37 \ufe38 S times ] =\n\u03b1l[\u03bbk11 T S , \u00b7 \u00b7 \u00b7 , \u03bbkK1 T S ] = \u03b1l\u03bb T kD1, where \u03bbk = [\u03bbk1, \u00b7 \u00b7 \u00b7 , \u03bbkK ] T , D1 = diag(1 T S , \u00b7 \u00b7 \u00b7 ,1\nT S\ufe38 \ufe37\ufe37 \ufe38\nK times\n) and 1S is\nthe column vector of ones of length S. Thus, \u039bk (cf. Section II-B) is: \u039bk \u2248 \u03b1\u03bb T kD1, where \u03b1 = [\u03b11, \u00b7 \u00b7 \u00b7 , \u03b1S ] T . After applying this approximation in (6c), we get:\nck = \u03b1ck; ck = x TWTDD T 1 \u03bbk. (7)\nUsing (7), the inputs to the basis functions in \u2126k of (3) can be expressed in xk and ck. As ck depends on \u03bbk, we estimate \u03bbk to find ck. In this regard, using (7), z \u03d5 k in (4) is given as:\nz\u03d5k = g 0 k + g 1 k\u03bb\u0302k + g 2 k\u03bb\u0302 \u2217 k, (8)\nwhere g0k = \u2211S l=1 h \u03d5 kl\u03a8 0(wklxk)\u03a6\u0302 0 kl, g\n1 k =\u2211S\nl=1 h \u03d5 kl \u03a8 1(wklxk)\u03a6\u0302 1 klx TWTDD T 1 , and g2k =\u2211S l=1 h \u03d5 kl\u03a8 2(wklxk)\u03a6\u0302 2 klx HWHD D H 1 . Further, by including time samples of x, (8) is given by:\nz \u03d5 k = g 0 k +G 1 k\u03bb\u0302k +G 2 k\u03bb\u0302 \u2217 k, (9)\nwhere z\u03d5k , g 0 k, g 1 k, and g 2 k are denoted as z \u03d5 k , g 0 k, G 1 k, and G 2 k respectively after including the time samples5. By splitting (9) into real and imaginary parts, the real part R(\u03bb\u0302k) and the imaginary part I(\u03bb\u0302k), can be determined as:[ R(\u03bb\u0302k)\nI(\u03bb\u0302k)\n] = [ R(G1k+G 2 k) I(\u2212G 1 k+G 2 k)\nI(G1k+G 2 k) R(G 1 k\u2212G 2 k)\n]\u2020 [ R(z\u03d5k\u2212g 0 k)\nI(z\u03d5k\u2212g 0 k)\n] (10)\nTo determine \u03bb\u0302k, first, xk is set as: xk = sk. Thus, we can compute G1k, G 2 k, and g 0 k and using the measured z \u03d5 k ,\n5Note that in this work, the boldface symbol a represents the scalar signal a with its time samples.\nStart\nj = 0 Given: s, xk = sk\n\u03bb\u0302k, c (0) k = s TWTDD T 1 \u03bb\u0302k\nj = j + 1\nMeasured: z\u03d5k (j)\n\u03a6 (j) k = \u03a8(z \u03d5 k (j), c (j\u22121) k ) \u2020 x (j\u22121) k\nx (j) k = \u03a8(sk, c (j\u22121) k )\u03a6 (j) k\nc (j) k = x TWTDD T 1 \u03bb\u0302k\nConverged? No\n\u03a6\u0302k = \u03a6 (j) k\nYes\nEnd\n1: 2: 3:\nfrom (10), we find \u03bb\u0302k. Further, the obtained \u03bb\u0302k is used in the algorithm as shown in Fig. 2. Here, initially, we again set xk = sk and for given \u03bb\u0302k, ck is determined. Then, using post-inverse, the measured z\n\u03d5 k and ck are set as inputs to the\nDPD to find \u03a6k using LS method. Using it, the output xk of the DPD and ck are computed. The process repeats until the value of \u03a6k converges. The complexity of the algorithm in an iteration is determined using the dominant matrix operations in Steps 1, 2, and 3 (cf. Fig. 2) which is: O((Q+1)2)+O(K2S).\n4"
        },
        {
            "heading": "III. POST-WEIGHTING SCHEMES AND OPTIMIZATION",
            "text": "To investigate the PW processing, first, we express z\u03d5k in (8) as a function of sk. By substituting (1b) into (8) and separating the first basis function from the rest, we get:\nz\u03d5k=h \u03d5 k T Wk\u03c6\u0303 0 k\u03c6 0 k0sk+h \u03d5 k0 T Wk\u03c6\u0303 0 k0\u03a8 \u2032 (sk, ck)\u03a6 \u2032 k+Z\u0303 \u03d5 k,NL,(11)\nwhere Wk = diag(wk), \u03c6\u0303 0 k0 = [\u03c6 0 k10, \u00b7 \u00b7 \u00b7 , \u03c6 0 kS0] T , \u03a8 \u2032\n(sk, ck) = {\u03a8(sk, ck)\\\u03c8 0 0(sk) = sk}, \u03a6\n\u2032 k = {\u03a6k\\\u03c6 0 k0},\nand Z\u0303k,NL is the nonlinear higher order terms with less power contents, obtained after removing the term consisting first (linear) basis function in (4). In (11), the first term is the desired output. But, the second and third terms inject nonlinearties, denoted as the nonlinear radiation z\u03d5k,NL as:\nz\u03d5k,NL = h \u03d5 k T Wk\u03c6\u0303 0 k0\u03a8 \u2032 (sk, ck)\u03a6 \u2032 k + Z\u0303 \u03d5 k,NL. (12)\nIn (12), z\u03d5k,NL gives the nonlinearties in other directions except \u03d5. Because, in BO-DPD, its coefficients \u03a6 \u2032\nk are trained to\nprovide the linearization in the direction \u03d5. Therefore, to linearize it further in other directions too, the predistortion output of the trained DPD is passed through the PW block by changing the modes of the switches (S0 is open and {Si} are closed). Next, we describe the proposed two PW schemes."
        },
        {
            "heading": "A. Post-Weighting",
            "text": "The outputs of the DPD are the Q + 1 basis functions (in \u03a8(sk, ck)) multiplied by the respective coefficients (in \u03a6k) and they are inputted to the PW block. The two types of PW schemes: (a) FF-PW and (b) LC-PW are shown in Fig. 3 for S = 4 and Q = 3. The PW coefficients are only multiplied by the Q nonlinear outputs of the DPD comprising the nonlinear basis functions (in \u03a8 \u2032\n(sk, ck)) except the linear basis function \u03c8vipiC vi k = sk for pi = vi = 0 (cf. Section II-B). Thereafter, the outputs of the PW block are distributed to the inputs of the PAs to get the desired linear output.\n1) Fully-Featured PW (FF-PW): For instance, the FF-PW scheme in Fig. 3(a) is for S = 4 and Q = 3. Here, Q = 3 nonlinear outputs of the DPD are multiplied by the S = 4 different sets of PW coefficients to generate the resultant predistorted signals for the respective S PAs. For the generation of the predistorted signal to the lth (l \u2208 {1, 2, 3, 4}) PA, the corresponding set of coefficients is {\u03b3v1klp1 , \u03b3 v2 klp2\n, \u03b3v3klp3}. These PW coefficients are multiplied by the respective DPD outputs given in the set {\u03c6v1kp1\u03c8 v1 p1C v1 k , \u03c6 v2 kp2 \u03c8v2p2C v2 k , \u03c6 v3 kp3 \u03c8v3p3C v3 k }. Thereafter, the sum of the three multiplications along with the linear DPD output, \u03c60k0sk gives the lth predistorted signal. Therefore, the total number of PW coefficients, NF\u03b3 = S \u00d7 Q = 12 which are completely different from each other without any repetition and it provides the full DOF to further linearize the individual PA. However, in LC-PW, the PW coefficients are assigned adaptively (some coefficients repeat) to the PAs to reduce their number as described later. In general, the Q PW coefficients associated with the predistorted signal to the lth PA are represented as: \u03b3v1klp1 , \u00b7 \u00b7 \u00b7 , \u03b3 vQ klpQ , where \u03b3viklpi is the PW coefficient multiplied by the ith nonlinear DPD output. Further, for the convenience in analysis, the PW coefficients of the S PAs are arranged in a vector as: \u03b3k , [\u03b3\nv1 k1p1 , \u00b7 \u00b7 \u00b7 , \u03b3v1kSp1 , \u00b7 \u00b7 \u00b7 , \u03b3 vQ k1pQ , \u00b7 \u00b7 \u00b7 , \u03b3 vQ kSpQ ]T , where the\ncoefficients multiplied by the same DPD output are grouped together. The PW processing can be analyzed by incorporating the \u03b3k in (12). As its first term has \u03a8 \u2032\n(sk, ck), to multiply \u03b3k with it, we need to rearrange \u03a8 \u2032\n(sk, ck) along with other matrices and vectors according to arrangement of PW coefficients in \u03b3k. So, h \u03d5 k , Wk, \u03c6\u0303 0 k0, \u03a8 \u2032 (sk, ck), and \u03a6 \u2032\nk are arranged as h \u03d5 k , W k, \u03c6\u0303 0 k0, \u03a8 \u2032 (sk, ck), and \u03a6 \u2032 k,\nrespectively. h \u03d5 k = 1Q \u2297 h \u03d5 k , W k = diag(1Q \u2297 wk), \u03c6\u0303 0\nk0 = diag(1Q\u2297\u03c6\u0303 0 k0), \u03a8\n\u2032 (sk, ck) = diag(\u03a8 \u2032 (sk, ck) T \u22971S),\nand \u03a6 \u2032 k = diag(\u03a6 \u2032 k \u2297 1S). Now, (12) can be expressed as:\nz\u03d5k,NL = T \u03d5 k \u03b3k + Z \u03d5 k,NL, (13)\nwhere T\u03d5k = h \u03d5 k T W k\u03c6\u0303\n0 k0\u03a8 \u2032 (sk, ck)\u03a6 \u2032 k. Also, after incor-\nporating PW coefficients in Z\u0303\u03d5k,NL, it is expressed as Z \u03d5 k,NL in (13). As described earlier, due to small power content, we neglect the PW effect on Z\u03d5k,NL. Moreover, in FF-PW, the number of multipliers NF\u03b3 and the number of adders N F a are same as the number of PW coefficients in \u03b3k, given as: NF\u03b3 = N F a = S \u00d7 Q. Also, the number of RF chains NFRF = S. So, to reduce them, we propose a LC-PW scheme.\n2) Low-Complexity PW (LC-PW): As the complexity of the PW block depends on the number of PW coefficients, therefore, in the LC-PW scheme, the number of PW coefficients are reduced by a factor based on a geometric sequence. In general, the nonlinear DPD outputs in this scheme are arranged in their decreasing order of dominance (or increasing order of the polynomial terms). Besides, the numbers of PW coefficients that are multiplied by the Q DPD outputs, decrease in a geometric sequence as: {Sr\u03bd , Sr(\u03bd+1), \u00b7 \u00b7 \u00b7 , Sr(\u03bd+Q\u22121)}, where r (< 1) is the common ratio. For example, in Fig. 3(b), for S = 4, Q = 3, r = 1/2, and \u03bd = 1, the sequence of numbers of PW coefficients is: {2, 1, 0.5}. But, the number cannot be a fraction value, so, the value in the sequence less than one is assigned as one, thus the sequence is: {2, 1, 1}. So, we keep decreasing the number of coefficients until Sri < 1; i \u2208 {\u03bd, \u03bd + 1, \u00b7 \u00b7 \u00b7 , \u03bd + Q \u2212 1} and after that we assign one PW coefficient to each of the remaining DPD outputs. Thus, in general, the total number of coefficients (or the multipliers), NL\u03b3 in the LC-PW is given by (14a) and the total number of adders, NLa is expressed in (14b).\nNL\u03b3 =   \nS \u00d7 r \u03bd(1\u2212rQ) 1\u2212r ; for S \u00d7 r (Q+\u03bd\u22121) \u2265 1\nS \u00d7 r \u03bd(1\u2212rm) 1\u2212r +Q\u2212m; for {S \u00d7 r (m+\u03bd\u22121) \u2265 1}\n\u2227{S \u00d7 r(m+\u03bd) < 1},\n(14a)\nNLa = N L \u03b3 + Sr\n\u03bd \u2212 \u2308 Sr(\u03bd+Q\u22121) \u2309 . (14b)\nFor the first case in (14a), the PW coefficient vector, \u03b3k = [\u03b3v1k1p1 , \u03b3 v1 k(1+r\u2212\u03bd)p1 , \u00b7 \u00b7 \u00b7 , \u03b3v1k(1+(Sr\u03bd\u22121)r\u2212\u03bd)p1 , \u00b7 \u00b7 \u00b7 , \u03b3 vQ k1pQ , \u03b3 vQ k(1+r\u2212(\u03bd+Q\u22121))pQ , \u00b7 \u00b7 \u00b7 , \u03b3 vQ k(1+(Sr(\u03bd+Q\u22121)\u22121)r\u2212(\u03bd+Q\u22121))pQ ]T and \u03a6 \u2032 k = diag(\u03a6 \u2032\nk \u2297 1S)diag(1r\u2212\u03bd , \u00b7 \u00b7 \u00b7 ,1r\u2212\u03bd\ufe38 \ufe37\ufe37 \ufe38 Sr\u03bd times , \u00b7 \u00b7 \u00b7 ,\n1r\u2212(\u03bd+Q\u22121) , \u00b7 \u00b7 \u00b7 ,1r\u2212(\u03bd+Q\u22121)\ufe38 \ufe37\ufe37 \ufe38 Sr(\u03bd+Q\u22121) times ). Otherwise, for the second case, \u03b3k = [\u03b3 v1 k1p1\n, \u03b3v1k(1+r\u2212\u03bd)p1 , \u00b7 \u00b7 \u00b7 , \u03b3 v1 k(1+(Sr\u03bd\u22121)r\u2212\u03bd)p1 , \u00b7 \u00b7 \u00b7 , \u03b3vmk1pm , \u03b3vm k(1+r\u2212(\u03bd+m\u22121))pm , \u00b7 \u00b7 \u00b7 , \u03b3vm k(1+(Sr(\u03bd+m\u22121)\u22121)r\u2212(\u03bd+m\u22121))pm ,\n5 \u03b3 v(m+1) k1p(m+1) , \u03b3 v(m+2) k1p(m+2) , \u00b7 \u00b7 \u00b7 , \u03b3 vQ k1pQ ]T and \u03a6 \u2032 k = diag(\u03a6 \u2032 k \u2297 1S)diag(1r\u2212\u03bd , \u00b7 \u00b7 \u00b7 ,1r\u2212\u03bd\ufe38 \ufe37\ufe37 \ufe38 Sr\u03bd times , \u00b7 \u00b7 \u00b7 ,1r\u2212(\u03bd+m\u22121) , \u00b7 \u00b7 \u00b7 ,1r\u2212(\u03bd+m\u22121)\ufe38 \ufe37\ufe37 \ufe38 Sr(\u03bd+m\u22121) times , 1S , \u00b7 \u00b7 \u00b7 ,1S\ufe38 \ufe37\ufe37 \ufe38 Q\u2212m times ). Moreover, remaining vectors and matrices, h \u03d5 k , W k, and \u03c6\u0303 0 k0, \u03a8 \u2032\n(sk, ck) are expressed same as for FF-PW (cf. Section III-A1). Also, the expression for the nonlinear radiation, z\u03d5k,NL is same as in (13). Moreover, from Fig. 3(b), the number of RF chains, NLRF depends on the number of coefficients assigned to the first nonlinear output, i.e., NLRF = Sr \u03bd = NFRF r \u03bd . Thus, in LC-PW, the number of RF chains, multipliers, and the adders are reduced by the factors, r\u2212\u03bd , NF\u03b3 /N L \u03b3 , and N F a /N L a , respectively. For example, in Fig. 3(b), the respective factors are 2, 4, and 2.4. Hence, the LC-PW is less complex and economical for the mMIMO."
        },
        {
            "heading": "B. Optimization of \u03b3k",
            "text": "The optimization problem can be formulated as:\nP0 : minimize \u03b3k\n\u2211 t E[|z \u03d5t k,NL| 2]\ns. t.: h \u03d50 k T W k\u03c6\u0303\n0 k0\u03a8 \u2032 \u03a6 \u2032 k\u03b3k = h \u03d50 k T W k\u03c6\u0303 0 k0\u03a8 \u2032 \u03a6 \u2032\u2032 k,\nwhere \u03a6 \u2032\u2032 k = \u03a6 \u2032\nk \u2297 1S and E[\u00b7] is the expectation with respect to time samples. In problem P0, the objective function which needs to be minimized in \u03b3k, is the sum of the average value of the power of nonlinear radiation in the given range of directions with sample points {\u03d5t}. The constraint ensures the linearization of BO signal in the desired direction \u03d50.\n1) Optimal Solution: To investigate the convexity of the\nproblem, the objective function, OP0 , \u2211 t E[|z \u03d5t k,NL|\n2] =\u2211 t E[z \u03d5tH k,NL z \u03d5t k,NL], can be expressed using (13) as:\nOP0 =\u03b3 H k \u2211 t E[T \u03d5t k H T\u03d5tk ]\u03b3k + \u03b3 H k \u2211 t E[T \u03d5t k H Z\u03d5tk,NL]\n+ \u2211\nt E[Z \u03d5tH k,NL T \u03d5t k ]\u03b3k + \u2211 t E[Z \u03d5tH k,NLZ \u03d5t k,NL]. (15)\nAs the constraint is linear and from (15), the objective function is quadratic in \u03b3k, the problem P0 is convex and gives a global solution using the Karush\u2013Kuhn\u2013Tucker (KKT) conditions. From P0, the Lagrangian function, L(\u03b3k, \u03b7) is:\nL(\u03b3k, \u03b7) = OP0 + \u03b7(T \u03d50 k \u03b3k \u2212 h \u03d50 k T W k\u03c6\u0303\n0 k0\u03a8 \u2032 \u03a6 \u2032\u2032 k), (16)\nwhere \u03b7 is the Lagrangian multiplier which is 6= 0 to consider the constraint in the optimization. Using the complex gradient of L(\u03b3k, \u03b7) in \u03b3k, the KKT conditions are obtained as:\u2211\nt\nE[T\u03d5tk H T\u03d5tk ]\u03b3k+\n\u2211\nt\nE[T\u03d5tk H Z\u03d5tk,NL]+\u03b7T \u03d50 k H = 0,(17a)\nT\u03d50k \u03b3k = T \u03d5\u20320 k , (17b)\nwhere T \u03d5\u20320 k = h \u03d50 k T W k\u03c6\u0303\n0 k0\u03a8 \u2032 \u03a6 \u2032\u2032 k. Using (17), the optimal\nsolution \u03b3\u0302k and corresponding Lagrangian multiplier \u03b7\u0302 are: \u03b3\u0302k =\u03b7\u0302 (\u2211 t E[T \u03d5t k H T\u03d5tk ] )\u22121 T\u03d50k H \u2212 (\u2211 t E[T \u03d5t k H T\u03d5tk ] )\u22121\n\u00d7 \u2211\nt E[T \u03d5t k H Z\u03d5tk,NL], (18a)\n\u03b7\u0302 = T\n\u03d5\u20320 k +T \u03d50 k ( \u2211 t E[T \u03d5t k HT \u03d5t k ])\u22121 \u2211 t E[T \u03d5t k HZ \u03d5t k,NL ]\nT \u03d50 k\n( \u2211\nt E[T \u03d5t k HT \u03d5t k ])\u22121T \u03d50 k\nH . (18b)\n(a) (b)\nFig. 4. Performance comparison of the different PW schemes against (a) the benchmark schemes and (b) the systems with only BO-DPD."
        },
        {
            "heading": "IV. NUMERICAL EXPERIMENT AND CONCLUSION",
            "text": "To evaluate the performance, we use the set of 16 PA memoryless polynomial models obtained by measuring the outputs of 16 HMC943APM5E PA ICs at 28.5 GHz to the OFDM input signal of 200 MHz bandwidth. Although, the signal is wideband, the memoryless model provides an accuracy around \u221223 dB in normalized mean square error [3]. Besides, two subarrays, each comprising 16 PAs, are considered. The PAs are arranged in a uniform linear array and the distance between the two adjacent antennas is half the operating wavelength. The beamforming and steering weight for a given azimuth angle is determined using the procedure in [7]. The crosstalk between two adjacent antennas is \u221210 dB, whereas, it decays as a square of distance between other two antennas [3]. Using the measured output of HMC943APM5E PA ICs at 28.5 GHz with \u221210 dB crosstalk, we identified the dual-input memoryless model for each PA using LS estimation as follows. For a given input signal x\u030ak, a test crosstalk signal c\u030akl to the PA, and the measured output y\u030akl, the coefficients of the PA are identified using LS estimation as: \u03a6\u0302kl = \u03a8(\u030axk, c\u030akl) \u2020 y\u030akl.\nFig. 4 depicts the performance comparison of the schemes in the nonlinear radiations. A notch in each curve at 0 rad is due to BO-DPD linearization in the direction. PW coefficients are optimized for the angle range [\u2212\u03c0/3, \u03c0/3] and [\u2212\u03c0/2, \u03c0/2] for Figs. 4(a) and 4(b), respectively. So, intra-PW and interPW schemes overshoots beyond the range in Fig. 4(a). In the direct nonlinear radiation (DNR), the message signal is directly transmitted from the subarray where the average power of the transmit signal is normalized to 0 dB. So, the predistortion schemes give significant performance enhancement against DNR. Further, FF-PW and LC-PW provide the improvements by 20.01 dB and 9.88 dB against intra-PW due to their higher DOF in PW, but, inter-PW gives marginal improvement of 3.44 dB. Fig 4(b) quantifies the performance improvement due to crosstalk preprocessing (CTP) in the schemes. Here, a scheme name followed by w/ (w/o) represents the predistortion with (without) CTP. In BO-DPD w/o [4] and BO-DPD w/ [2],\n6 only DPD is used to linearize the BO outputs. Thus, the PW schemes always perform better. Moreover, BO-DPD, LCPW, and FF-PW schemes with CTP provide the respective on average improvements by 5.06 dB, 5.82 dB, and 8.11 dB against the schemes without CTP. Also, the average adjacent channel power ratios (ACPRs) of the schemes are shown in Table I. Here, average ACPR is the average of the ACPRs of the two adjacent channels which are computed as in [3]. Again, the FF-PW has the best average ACPR while the LCPW has an intermediate performance."
        }
    ],
    "title": "A Low-Complexity Post-Weighting Predistorter in a mMIMO Transmitter Under Crosstalk",
    "year": 2023
}