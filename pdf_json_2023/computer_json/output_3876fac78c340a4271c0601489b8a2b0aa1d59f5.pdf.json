{
    "abstractText": "Abstract. The equations of Lagrangian gas dynamics fall into the larger class of overdetermined hyperbolic and thermodynamically compatible (HTC) systems of partial differential equations. They satisfy an entropy inequality (second principle of thermodynamics) and conserve total energy (first principle of thermodynamics). The aim of this work is to construct a novel thermodynamically compatible cell-centered Lagrangian finite volume scheme on unstructured meshes. Unlike in existing schemes, we choose to directly discretize the entropy inequality, hence obtaining total energy conservation as a consequence of the new thermodynamically compatible discretization of the other equations. First, the governing equations are written in fluctuation form. Next, the non-compatible centered numerical fluxes are corrected according to the approach recently introduced by Abgrall et al., using a scalar correction factor that is defined at the nodes of the grid. This perfectly fits into the formalism of nodal solvers which is typically adopted in cell-centered Lagrangian finite volume methods. Semi-discrete entropy conservative and entropy stable Lagrangian schemes are devised, and they are adequately blended together via a convex combination based on either a priori or a posteriori detectors of discontinuous solutions. The nonlinear stability in the energy norm is rigorously demonstrated and the new schemes are provably positivity preserving for density and pressure. Furthermore, they exhibit zero numerical diffusion for isentropic flows while being still nonlinearly stable. The new schemes are tested against classical benchmarks for Lagrangian hydrodynamics, assessing their convergence and robustness and comparing their numerical dissipation with classical Lagrangian finite volume methods.",
    "authors": [
        {
            "affiliations": [],
            "name": "WALTER BOSCHERI"
        },
        {
            "affiliations": [],
            "name": "MICHAEL DUMBSER"
        }
    ],
    "id": "SP:50daf24f56efeb8c847858ca23ce725a3c522459",
    "references": [
        {
            "authors": [
                "R. Abgrall"
            ],
            "title": "A general framework to construct schemes satisfying additional conservation relations",
            "venue": "Application to entropy conservative and entropy dissipative schemes. J. Comput. Phys., 372:640\u2013666",
            "year": 2018
        },
        {
            "authors": [
                "R. Abgrall",
                "S. Busto",
                "M. Dumbser"
            ],
            "title": "A simple and general framework for the construction of thermodynamically compatible schemes for computational fluid and solid mechanics",
            "venue": "Applied Mathematics and Computation, 440:127629",
            "year": 2023
        },
        {
            "authors": [
                "N.V. Pogorelov A.G. Kulikovskii",
                "A.Y. Semenov"
            ],
            "title": "Mathematical aspects of numerical solution of hyperbolic systems",
            "venue": "Chapman and Hall/CRC,",
            "year": 2000
        },
        {
            "authors": [
                "D.S. Balsara"
            ],
            "title": "Self-adjusting",
            "venue": "positivity preserving high order schemes for hydrodynamics and magnetohydrodynamics. J. Comput. Phys., 231:7504\u20137517",
            "year": 2012
        },
        {
            "authors": [
                "W. Boscheri",
                "S. Chiocchetti",
                "I. Peshkov"
            ],
            "title": "A cell-centered implicit-explicit lagrangian scheme for a unified model of nonlinear continuum mechanics on unstructured meshes",
            "venue": "Journal of Computational Physics, 451:110852",
            "year": 2022
        },
        {
            "authors": [
                "W. Boscheri",
                "M. Dumbser",
                "R. Loub\u00e8re",
                "P.-H. Maire"
            ],
            "title": "A second-order cell-centered Lagrangian ADER-MOOD finite volume scheme on multidimensional unstructured meshes for hydrodynamics",
            "venue": "358:103 \u2013 129",
            "year": 2018
        },
        {
            "authors": [
                "W. Boscheri",
                "R. Loub\u00e8re",
                "P.-H. Maire"
            ],
            "title": "A 3D cell-centered ADER MOOD finite volume method for solving updated Lagrangian hyperelasticity on unstructured grids",
            "venue": "Journal of Computational Physics, 449:110779",
            "year": 2022
        },
        {
            "authors": [
                "W. Boscheri",
                "R. Loub\u00e9re",
                "P.-H. Maire"
            ],
            "title": "A 3d cell-centered ader mood finite volume method for solving updated lagrangian hyperelasticity on unstructured grids",
            "venue": "Journal of Computational Physics, 449:110779",
            "year": 2022
        },
        {
            "authors": [
                "J.P. Braeunig"
            ],
            "title": "Reducing the entropy production in a collocated lagrange\u2013remap scheme",
            "venue": "Journal of Computational Physics, 314:127\u2013144",
            "year": 2016
        },
        {
            "authors": [
                "D.E. Burton",
                "N.R. Morgan",
                "T.C. Carney",
                "M.A. Kenamond"
            ],
            "title": "Reduction of dissipation in Lagrange cell-centered hydrodynamics (CCH) through corner gradient reconstruction (CGR)",
            "venue": "J. Comput. Phys., 299:229\u2013280",
            "year": 2015
        },
        {
            "authors": [
                "S. Busto",
                "M. Dumbser"
            ],
            "title": "A new thermodynamically compatible finite volume scheme for magnetohydrodynamics",
            "venue": "SIAM Journal on Numerical Analysis, 61:343\u2013364",
            "year": 2023
        },
        {
            "authors": [
                "S. Busto",
                "M. Dumbser",
                "S. Gavrilyuk",
                "K. Ivanova"
            ],
            "title": "On thermodynamically compatible finite volume methods and path-conservative ADER discontinuous Galerkin schemes for turbulent shallow water flows",
            "venue": "J. Sci. Comput., 88:28",
            "year": 2021
        },
        {
            "authors": [
                "S. Busto",
                "M. Dumbser",
                "I. Peshkov",
                "E. Romenski"
            ],
            "title": "On thermodynamically compatible finite volume schemes for continuum mechanics",
            "venue": "SIAM Journal on Scientific Computing, 44:A1723\u2013A1751",
            "year": 2022
        },
        {
            "authors": [
                "G. Carr\u00e9",
                "S. Del Pino",
                "B. Despr\u00e9s",
                "E. Labourasse"
            ],
            "title": "A cell-centered Lagrangian hydrodynamics scheme on general unstructured meshes in arbitrary dimension",
            "venue": "J. Comput. Phys., 228:5160\u20135183",
            "year": 2009
        },
        {
            "authors": [
                "T. Cheng",
                "C.W. Shu"
            ],
            "title": "Entropy stable high order discontinuous Galerkin methods with suitable quadrature rules for hyperbolic conservation laws",
            "venue": "J. Comput. Phys., 345:427\u2013 461",
            "year": 2017
        },
        {
            "authors": [
                "S. Clain",
                "S. Diot",
                "R. Loub\u00e8re"
            ],
            "title": "A high\u2013order finite volume method for systems of conservation laws - Multi\u2013dimensional Optimal Order Detection (MOOD)",
            "venue": "J. Comput. Phys., 230:4028\u20134050",
            "year": 2011
        },
        {
            "authors": [
                "B. Despr\u00e9s",
                "C. Mazeran"
            ],
            "title": "Lagrangian gas dynamics in two-dimensions and Lagrangian systems",
            "venue": "Archive for Rational Mechanics and Analysis, 178:327\u2013372",
            "year": 2005
        },
        {
            "authors": [
                "U.S. Fjordholm",
                "S. Mishra",
                "E. Tadmor"
            ],
            "title": "Arbitrarily high-order accurate entropy stable essentially nonoscillatory schemes for systems of conservation laws",
            "venue": "SIAM Journal on Numerical Analysis, 50(2):544\u2013573",
            "year": 2012
        },
        {
            "authors": [
                "K.O. Friedrichs"
            ],
            "title": "Symmetric positive linear differential equations",
            "venue": "Comm. Pure Appl. Math., 11:333\u2013418",
            "year": 1958
        },
        {
            "authors": [
                "K.O. Friedrichs",
                "P.D. Lax"
            ],
            "title": "Systems of conservation equations with a convex extension",
            "venue": "Proc. Nat. Acad. Sci. USA, 68:1686\u20131688",
            "year": 1971
        },
        {
            "authors": [
                "G. Gassner",
                "A.R. Winters",
                "D.A. Kopriva"
            ],
            "title": "A well balanced and entropy conservative discontinuous Galerkin spectral element method for the shallow water equations",
            "venue": "Appl. Math. Comput., 272:291\u2013308",
            "year": 2016
        },
        {
            "authors": [
                "E. Godlewski",
                "P.A. Raviart"
            ],
            "title": "Coupling nonlinear hyperbolic systems: mathematical and numerical analysis",
            "venue": "R. Herbin and D. Kr\u00f6ner, editors, Finite Volumes for Complex Applications III, pages 211\u2013218. Hermes Penton Science",
            "year": 2002
        },
        {
            "authors": [
                "S.K. Godunov"
            ],
            "title": "An interesting class of quasilinear systems",
            "venue": "Dokl. Akad. Nauk SSSR, 139(3):521\u2013 523",
            "year": 1961
        },
        {
            "authors": [
                "A. Harten",
                "P. Lax"
            ],
            "title": "and B",
            "venue": "van Leer. On upstream differencing and godunov type methods for hyperbolic conservation laws. SIAM review, 25:35\u201361",
            "year": 1983
        },
        {
            "authors": [
                "S. Hennemann"
            ],
            "title": "A",
            "venue": "M. Rueda-Ram\u0131\u0301rez, F. J. Hindenlang, and G. J. Gassner. A provably entropy stable subcell shock capturing approach for high order split form DG for the compressible Euler equations. Journal of Computational Physics, 426",
            "year": 2021
        },
        {
            "authors": [
                "A. Hiltebrand",
                "S. Mishra"
            ],
            "title": "Entropy stable shock capturing space-time discontinuous Galerkin schemes for systems of conservation laws",
            "venue": "Numerische Mathematik, 126(1):103\u2013151",
            "year": 2014
        },
        {
            "authors": [
                "C. Hu",
                "C.W. Shu"
            ],
            "title": "Weighted essentially non-oscillatory schemes on triangular meshes",
            "venue": "J. Comput. Phys., 150:97\u2013127",
            "year": 1999
        },
        {
            "authors": [
                "K.A. Ivanova",
                "S.L. Gavrilyuk"
            ],
            "title": "Structure of the hydraulic jump in convergent radial flows",
            "venue": "Journal of Fluid Mechanics, 860:441\u2013464",
            "year": 2019
        },
        {
            "authors": [
                "J.R. Kamm",
                "F.X. Timmes"
            ],
            "title": "On efficient generation of numerically robust sedov solutions",
            "venue": "Technical Report LA-UR-07-2849,LANL",
            "year": 2007
        },
        {
            "authors": [
                "P. Lax"
            ],
            "title": "Hyperbolic systems of conservation laws and the mathematical theory of shock waves",
            "venue": "SIAM Regional Conference Lecturers in Applied Mathematics",
            "year": 1972
        },
        {
            "authors": [
                "R.J. LeVeque"
            ],
            "title": "Finite Volume Methods for Hyperbolic Problems",
            "venue": "Cambridge University Press",
            "year": 2002
        },
        {
            "authors": [
                "R. Loub\u00e8re",
                "P.-H. Maire",
                "P. V\u00e1chal"
            ],
            "title": "Staggered Lagrangian hydrodynamics based on cellcentered Riemann solver",
            "venue": "10(4):940\u2013978",
            "year": 2010
        },
        {
            "authors": [
                "R. Loub\u00e8re",
                "P.-H. Maire",
                "B. Rebourcet"
            ],
            "title": "Staggered and colocated finite volume schemes for Lagrangian hydrodynamics",
            "venue": "Handbook of numerical analysis, 17:319\u2013352",
            "year": 2016
        },
        {
            "authors": [
                "P.H. Maire"
            ],
            "title": "A high-order cell-centered lagrangian scheme for two-dimensional compressible fluid flows on unstructured meshes",
            "venue": "J. Comput. Phys., 228:2391\u20132425",
            "year": 2009
        },
        {
            "authors": [
                "P.H. Maire"
            ],
            "title": "A high-order one-step sub-cell force-based discretization for cell-centered lagrangian hydrodynamics on polygonal grids",
            "venue": "Computers and Fluids, 46(1):341\u2013347",
            "year": 2011
        },
        {
            "authors": [
                "P.H. Maire",
                "R. Abgrall",
                "J. Breil",
                "J. Ovadia"
            ],
            "title": "A cell-centered lagrangian scheme for twodimensional compressible flow problems",
            "venue": "SIAM J. Sci. Comput., 29:1781\u20131824",
            "year": 2007
        },
        {
            "authors": [
                "P.H. Maire",
                "I. Bertron",
                "R. Chauvin",
                "B. Rebourcet"
            ],
            "title": "Thermodynamic consistency of cellcentered Lagrangian schemes",
            "venue": "Computers and Fluids, 203:104527",
            "year": 2020
        },
        {
            "authors": [
                "R. Menikoff",
                "B.J. Plohr"
            ],
            "title": "The Riemann problem for fluid flow of real materials",
            "venue": "61(1):75 \u2013 130",
            "year": 1989
        },
        {
            "authors": [
                "I. Peshkov",
                "E. Romenski"
            ],
            "title": "A hyperbolic model for viscous Newtonian flows",
            "venue": "Continuum Mech. Thermodyn., 28:85\u2013104",
            "year": 2016
        },
        {
            "authors": [
                "D. Ray",
                "P. Chandrashekar",
                "U.S. Fjordholm",
                "S. Mishra"
            ],
            "title": "Entropy stable scheme on twodimensional unstructured grids for euler equations",
            "venue": "Communications in Computational Physics, 19(5):1111\u20131140",
            "year": 2016
        },
        {
            "authors": [
                "S.K. Sambasivan",
                "M.J. Shashkov",
                "D.E. Burton"
            ],
            "title": "A finite volume cell-centered Lagrangian hydrodynamics approach for solids in general unstructured grids",
            "venue": "Int. J. Numer. Methods Fluids, 72:770\u2013810",
            "year": 2013
        },
        {
            "authors": [
                "E. Tadmor"
            ],
            "title": "The numerical viscosity of entropy stable schemes for systems of conservation laws I",
            "venue": "Math. Comput., 49:91\u2013103",
            "year": 1987
        },
        {
            "authors": [
                "E. Tadmor"
            ],
            "title": "Entropy stability theory for difference approximations of nonlinear conservation laws and related time-dependent problems",
            "venue": "Acta Numerica, 12:451\u2013512",
            "year": 2003
        },
        {
            "authors": [
                "E.F. Toro"
            ],
            "title": "Riemann Solvers and Numerical Methods for Fluid Dynamics: a Practical Introduction",
            "venue": "Springer",
            "year": 2009
        },
        {
            "authors": [
                "R.D.J. von Neumann"
            ],
            "title": "Richtmyer. A method for the calculation of hydrodynamics shocks",
            "venue": "Journal of Applied Physics,",
            "year": 1950
        }
    ],
    "sections": [
        {
            "text": "Key words. thermodynamically compatible finite volume schemes, Lagrangian gas dynamics, cell entropy inequality, nonlinear stability in the energy norm, positivity preserving, unstructured mesh\nAMS subject classifications. 35L40, 65M08.\n1. Introduction. The gas dynamics equations constitute a nonlinear hyperbolic system of conservation laws that evolve mass, momentum and total energy. As discussed in [30], the solutions might exhibit discontinuities and shock waves at finite time, which necessitate the introduction of weak solutions. The physically meaningful solution is then identified relying on an admissibility criterion known as entropy condition. This permits to reject nonphysical solutions by enforcing consistency with the second law of Thermodynamics, thus ensuring entropy conservation for smooth flows and entropy production, which transfers kinetic energy into internal energy, in the case of discontinuous flow fields. These systems are said to be hyperbolic thermodynamically compatible (HTC). It is worth recalling that the connection with thermodynamic compatibility was first presented in [23] and later in [20], noticing that the gas dynamics equations belong to the more general framework of symmetrizable hyperbolic systems [19].\nTo numerically solve the hydrodynamics system, the updated Lagrangian form is considered in this work. The Lagrangian approach allows strong shocks and expansions to be properly modeled for compressible fluid flows due to the embedded mesh motion, and material interfaces or contact waves can be accurately tracked since zero mass flux occurs across the boundaries of the control volumes. This peculiar repre-\n\u2217Department of Mathematics and Computer Science, University of Ferrara, via Machiavelli 30, 44121 Ferrara, Italy (walter.boscheri@unife.it)\n\u2020Department of Civil, Environmental and Mechanical Engineering, University of Trento, Via Mesiano 77, 38123 Trento, Italy (michael.dumbser@unitn.it)\n\u2021CEA CESTA, 33116 Le Barp, France (pierre-henri.maire@cea.fr)\n1\nar X\niv :2\n30 6.\n11 65\n1v 1\n[ m\nat h.\nN A\n] 2\n0 Ju\nn 20\n23\nsentation is characterized by a frame moving with the material velocity. The first Lagrangian numerical method dates back to the 50s [45], where a staggered grid was employed for the kinematic variables, hence requiring an artificial viscosity term to be tuned in order to deal with shock waves. An alternative approach is given by Godunov-type finite volume (FV) methods, in which the integral form of the conservation laws is discretized on a collocated grid. As such, numerical fluxes have to be computed at the cell interfaces by means of Riemann solvers [24]. Mimicking the thermodynamic compatibility at the discrete level is not trivial. Staggered grid Lagrangian methods discretize the internal energy equation, hence ensuring entropy conservation for smooth flows up to the order of the numerical method. However, entropy dissipation must be added for discontinuous solutions via an artificial viscosity that needs to be properly adjusted so that thermodynamic compatibility is fulfilled in multiple space dimensions. On the other hand, Godunov-type schemes are compliant with an entropy inequality within each cell, even in the case of isentropic flows, hence yielding severe inaccuracy for strong rarefaction waves [3]. The design of thermodynamically compatible finite volume schemes has been investigated in the Eulerian framework in [42], where the total energy equation is discretized and the entropy equation (or inequality) is enforced by designing specific numerical fluxes at the interfaces. Following this seminal idea, entropy-compatible schemes have been developed in the Eulerian setting, see for instance [40, 18, 43, 26, 21, 25, 15].\nVery few contributions can be found in the literature concerning the construction of Lagrangian methods that are compliant with the second law of thermodynamics [9, 37]. Therefore, the aim of this work is to design a new Lagrangian finite volume scheme that is provably thermodynamically compatible. However, unlike most of the existing numerical methods for hyperbolic systems, we do not discretize the total energy equation, but we directly discretize the entropy inequality and instead obtain total energy conservation as a consequence of the novel compatible discretization, thus admitting a discrete extra conservation law to the governing equations. This approach has first been proposed in [12, 13, 11] for turbulent shallow water flows [28], the GPR model of continuum mechanics [39] and the MHD equations, which both also fall into the wider class of hyperbolic and thermodynamically compatible (HTC) systems. A general framework for the construction of schemes that satisfy additional extra conservation laws has been forwarded in [1], and this technique has been recently also used in [2] in the context of finite volume and discontinuous Galerkin methods. Following the ideas of Abgrall, in this work we will compute a node-based scalar corrector factor that makes the scheme compatible with thermodynamics in the Lagrangian setting, demonstrating that total energy is retrieved as an additional conservation law. To design entropy stable schemes, we propose to blend the new thermodynamically compatible methods with the EUCCLHYD scheme [33], rewritten here in fluctuation form and for the entropy inequality. The production term is then exactly quantified, and the positivity preservation of density and pressure can be proven. We stress that in our framework the entropy production is directly controlled by the scheme, since here the entropy inequality is directly solved for the first time in the Lagrangian context, which is a radically different concept compared to most of the existing entropy compatible numerical methods. We will focus on the design of semi-discrete schemes, thus keeping the time continuous while correcting the spatial fluxes to obtain thermodynamic compatibility.\nThe rest of this paper is organized as follows. In Section 2 we present the governing equations, starting from the energy equation and passing to the entropy inequality. Section 3 is devoted to the construction of the new hyperbolic thermodynamically\ncompatible (HTC) Lagrangian scheme, which introduces both semi-discrete entropy conservative and entropy stable schemes, including the blending procedure. Nonlinear stability in the energy norm as well as positivity of thermodynamics quantities are rigorously demonstrated. Next, in Section 4 we present some numerical results for a suite of benchmarks for Lagrangian hydrodynamics. Finally, conclusions and an outlook to future investigations are drawn in Section 5.\n2. The Euler equations of Lagrangian hydrodynamics. Let x \u2208 Rd be the spatial position vector in d = 2 space dimensions, and let t \u2208 R+ be the time coordinate. The Euler equations of hydrodynamics can be written in the updated Lagrangian form using the material derivative ddt as follows:\n\u03c1 d\u03c4\ndt \u2212\u2207 \u00b7 v = 0,(2.1a)\n\u03c1 dv\ndt +\u2207p = 0,(2.1b)\n\u03c1 dE\ndt +\u2207 \u00b7 (pv) = 0.(2.1c)\nHere, \u03c1 is the fluid density and \u03c4 = 1/\u03c1 is the specific volume, v \u2208 Rd is the velocity vector, p denotes the fluid pressure and E = \u03b5 + 12v\n2 is the specific total energy. Furthermore, in the Lagrangian framework, the system is supplemented with the trajectory equation for the fluid particles, that is\n(2.2) dx\ndt = v, x(0) = X,\nwhere X is the Lagrangian coordinate defined at time t = 0 corresponding to the Eulerian coordinate x for t > 0. The system is closed by an equation of state (EOS) that provides the specific internal energy \u03b5 in terms of the specific volume \u03c4 and specific entropy S, hence \u03b5 = \u03b5(\u03c4, S). In addition, \u03b5(\u03c4, S) being convex implies that S(\u03c4, \u03b5) is concave, thus dealing with the physical entropy. To enforce thermodynamic stability [38, 22], the specific internal energy is assumed to be convex with respect to \u03c4 and S. Consequently, if the specific internal energy is a thermodynamic potential, the pressure p and the temperature \u03b8 can be determined by the complete equation of state\n(2.3) p(\u03c4, S) = \u2212 ( \u2202\u03b5\n\u2202\u03c4 ) S , \u03b8(\u03c4, S) = ( \u2202\u03b5 \u2202S ) \u03c4 ,\nwhere the absolute temperature is assumed to be strictly positive (\u03b8 > 0). Thanks to the convexity of the EOS we define the isentropic sound speed a as\n(2.4) a2 \u03c42 = \u2212\u2202p \u2202\u03c4 = \u22022\u03b5 \u2202\u03c42 > 0.\nThe ideal gas EOS fulfills these assumptions, and it simply writes\n(2.5) \u03b5 = eS/cv\n\u03c4\u03b3\u22121 (\u03b3 \u2212 1) ,\nwith \u03b3 = cp/cv being the polytropic index of the gas given as the ratio between the specific heat at constant pressure and volume, respectively. The Lagrangian hydrodynamics equations (2.1) have the following set of real eigenvalues: (2.6) \u03bb = (\u2212a,0, a), a = \u221a\u03b3 p \u03c4 ,\nwith a being the isentropic speed of sound. The convexity of \u03b5 implies that the specific total energy E is also convex. The Gibbs relation stems from the EOS:\ndE = \u2202E\n\u2202\u03c4 d\u03c4 +\n\u2202E \u2202v dv + \u2202E \u2202S dS\n= \u2212p d\u03c4 + v dv + \u03b8 dS = w \u00b7 du, w = \u2202E \u2202u = (\u2212p,v, \u03b8)\u22a4.(2.7) where u = (\u03c4,v, E)\u22a4 denotes the vector of conserved variables, while w is the vector of dual or Godunov variables [23] of the energy potential. Similarly, from the Gibbs relation (2.7) one has\n(2.8) dS = 1 \u03b8 (pd\u03c4 \u2212 v dv + dE) = w\u2217 \u00b7 du, w\u2217 = \u2202S \u2202u = 1 \u03b8 (p,\u2212v, 1)\u22a4, with w\u2217 being the vector of dual variables of the entropy potential. Assuming that the flow variables are smooth, the governing equations (2.1) admit one additional conservation law for entropy, that is derived by dot-multiplying the Lagrangian hydrodynamics system with the dual variables w\u2217 defined by (2.8):\n(2.9) \u03c1 dS\ndt +\n1 \u03b8 (\u2212p\u2207 \u00b7 v \u2212 v \u00b7 \u2207p+\u2207 \u00b7 (pv)) = 0.\nTherefore, entropy is conserved under the condition\n(2.10) \u2212 p\u2207 \u00b7 v \u2212 v \u00b7 \u2207p+\u2207 \u00b7 (pv) = 0,\nwhich is trivial if smooth flows are considered because this is the algebraic identity of the product rule. In case of discontinuous flows, entropy production takes place in order to discriminate the physical admissible solution characterized by an entropy increase, hence leading to an entropy inequality. Differently from most of the existing solvers for Lagrangian hydrodynamics [36, 34, 32, 17, 14, 41, 10], we aim at directly solving the entropy inequality instead of the energy equation, hence obtaining the energy equation as a consequence of the discrete form of the following conservation laws:\n\u03c1 d\u03c4\ndt \u2212\u2207 \u00b7 v = 0,(2.11a)\n\u03c1 dv\ndt +\u2207p = 0,(2.11b)\n\u03c1 dS\ndt = \u03a0 \u2265 0,(2.11c)\nwith \u03a0 being a suitable entropy production term that must be non-negative to obtain physically admissible solutions. By dot-multiplying the above equations (2.11a)(2.11c) with the dual variables w defined in (2.7), we retrieve the energy equation\n\u03c1 dE\ndt + p\u2207 \u00b7 v + v \u00b7 \u2207p = \u03b8\u03a0,\n\u03c1 dE\ndt +\u2207 \u00b7 (pv) = \u03b8\n( \u03a0\u2212 1\n\u03b8 (p\u2207 \u00b7 v + v \u00b7 \u2207p\u2212\u2207 \u00b7 (pv))\n) ,(2.12)\nwhich exactly corresponds to (2.1c) if \u03a0 = (p\u2207 \u00b7 v + v \u00b7 \u2207p\u2212\u2207 \u00b7 (pv)) /\u03b8, thus for smooth solutions we retrieve the entropy preserving condition (2.10). Therefore, the relation (2.10) also ensures that energy is conserved under the assumption of smooth solutions. In the next section, we design a numerical method that can preserve this thermodynamic compatibility also at the discrete level and also in the presence of discontinuities.\n3. Numerical method. The Euclidean space \u2126(t) with boundary \u2202\u2126(t) in d = 2 space dimensions is discretized with a set of non-overlapping triangular control volumes \u03c9c(t) of volume |\u03c9c(t)|. Notice that the geometry related quantities are time\ndependent due to the mesh motion, while the topology of the grid remains unchanged. A generic vertex of the mesh is denoted by p, while the sub-cell \u03c9pc refers to the portion of cell \u03c9c attached to one of its vertex p, as depicted in Figure 1. The set of vertexes belonging to cell \u03c9c is referred to with P(c), while the set of cells sharing node p is indicated with C(p). The sub-cell \u03c9pc is defined by connecting the vertex with position xp, the cell barycenter of coordinates xbc = 1/(d + 1) \u2211 p\u2208P(c) xp, and the left and right midpoints of the edges impinging on node p, namely p\u2212 1 2 and p+ 1 2 , respectively.\nThe half lengths of these edges are given by l\u2212pc = \u2223\u2223\u2223xp \u2212 x\u2212 12p \u2223\u2223\u2223 and l+pc = \u2223\u2223\u2223xp \u2212 x+ 12p \u2223\u2223\u2223, and the corner normal is computed as\n(3.1) lpcnpc = l + pcn + pc + l \u2212 pcn \u2212 pc.\nBy construction the corner vectors satisfy the fundamental geometrical identity (3.2) \u2211\np\u2208P(c)\nlpcnpc = 0,\nwhich is a consequence of the Gauss theorem. At the aid of Figure 1, we introduce the dual cell \u03c9p given by the union of all sub-cells sharing a generic node p:\n(3.3) \u03c9p = \u22c3\nc\u2208C(p)\n\u03c9pc.\nNotice that the outward pointing corner vectors of \u03c9p are simply the cell corner vectors lpcnpc with opposite sign for all c \u2208 C(p), thus the following identity holds\n(3.4) \u2211\nc\u2208C(p)\n\u2212lpcnpc = 0.\nThe time coordinate t is defined in the interval [0; tf ] and is approximated by a sequence of discrete points tn such that\n(3.5) tn+1 = tn +\u2206t,\nwhere the time step \u2206t is computed according to a CFL stability condition as\n(3.6) \u2206t \u2264 CFL min c |\u03c9c| ac .\n3.1. Semi-discrete entropy conservative Lagrangian schemes (ECL). We first design a cell-centered finite volume scheme that is exactly entropy conservative, thus we set \u03a0 = 0 in the entropy inequality (2.11c). Let mc = |\u03c9c(t)|/\u03c4c(t) be the mass of the cell, which remains constant in the Lagrangian framework, and let the mass averaged value of a generic quantity \u03d5(x, t) be defined as\n(3.7) \u03d5c = 1\nmc \u222b \u03c9c(t) \u03c1\u03d5 dx.\nBy integrating system (2.11) over the cell \u03c9c(t) and using the Reynolds transport formula, the semi-discrete finite volume scheme in fluctuation form reads\nmc d\u03c4c dt\n\u2212 \u2211\np\u2208P(c)\nlpcnpc \u00b7 (vp \u2212 vc) = 0,(3.8a)\nmc dvc dt\n+ \u2211\np\u2208P(c)\nlpcnpc (p\u0303p \u2212 pc) = 0,(3.8b)\nmc dSc dt = 0.(3.8c)\nThe motion of the computational grid is governed by the trajectory equation (2.2) that is discretized at each node of the mesh as\n(3.9) dxp dt = vp, xp(0) = X(0).\nTo rigorously ensure the geometric conservation law (GCL), the flux approximation of the continuity equation (3.8a) must provide a time rate of change of the cell volume that is fully compatible with the mesh displacement given by (3.9). This comes from the fact that \u2202|\u03c9c|/\u2202xp = lpcnpc and thus (3.8a) corresponds to d|\u03c9c|/dt [8]. In other words, the volume of the cell given by \u03c4\u22121c must be equal to the volume of the cell computed from the vertex coordinates. Therefore, the node velocity in (3.8a) and (3.9) must be the same, and one is not allowed to modify this requirement, which is the compliance with the GCL. However, we can correct the nodal pressure flux p\u0303p to be the sought thermodynamically compatible numerical flux. Following the general framework of entropy conservative schemes proposed by Abgrall in [1], we assume that the entropy conservative numerical flux writes\n(3.10) lpcnpc p\u0303p = lpcnpc pp + \u2225lpcnpc\u2225\u03b1p (vc \u2212 vp),\nwith pp an averaged node pressure that is not necessarily thermodynamically compatible and \u03b1p a scalar nodal correction factor that multiplies the jump in the thermodynamic dual variables and that eventually corrects the flux pp to ensure thermodynamic consistency. Therefore, the semi-discrete entropy conservative scheme is given by\nmc d\u03c4c dt\n\u2212 \u2211\np\u2208P(c)\nlpcnpc \u00b7 (vp \u2212 vc) = 0,(3.11a)\nmc dvc dt\n+ \u2211\np\u2208P(c)\nlpcnpc (pp \u2212 pc) + \u2225lpcnpc\u2225\u03b1p (vc \u2212 vp) = 0,(3.11b)\nmc dSc dt = 0.(3.11c)\nFirst, we need to determine the non-compatible fluxes vp and pp invoking conservation principles. A consistent condition implies that the sum of the fluctuations around a node must be equal to the sum of the fluxes across the faces defining the dual cell \u03c9p, hence we require (3.12)\u2211 c\u2208C(p) lpcnpc (pp \u2212 pc) + \u03b1p \u2211 c\u2208C(p) \u2225lpcnpc\u2225(vc \u2212 vp) = \u2212 \u2211 c\u2208C(p) lpcnpc pc = \u222b \u2202\u03c9p(t) p \u00b7 nds,\nwhere the change of sign is due to the opposite corner vectors defined on the dual cell according to (3.4). By canceling the terms appearing on both sides of (3.12) and recalling the discrete Gauss theorem on the dual cell (3.4), we obtain the nodal velocity which satisfies conservation. Although the nodal pressure pp is in principle without any constraints, we use the same definition of the conservative velocity flux, thus we obtain\n(3.13) vp =\n\u2211 c\u2208C(p)\n\u2225lpcnpc\u2225vc\u2211 c\u2208C(p) \u2225lpcnpc\u2225 , pp =\n\u2211 c\u2208C(p)\n\u2225lpcnpc\u2225 pc\u2211 c\u2208C(p) \u2225lpcnpc\u2225 .\nNext, we need to provide thermodynamic compatibility by imposing the condition (2.10) around a node p, thus we compute the dot product of the discrete dual variables (2.7) with the fluxes of the semi-discrete scheme (3.11):\u2211\nc\u2208C(p)\nlpcnpc \u00b7 (pc (vp \u2212 vc) + vc (pp \u2212 pc)) + \u03b1p \u2211\nc\u2208C(p)\n\u2225lpcnpc\u2225vc \u00b7 (vc \u2212 vp)\n= \u2212 \u2211\nc\u2208C(p)\nlpcnpc \u00b7 pc vc = \u222b\n\u2202\u03c9p(t)\npv \u00b7 nds.(3.14)\nThe term multiplied by the scalar factor \u03b1p can be conveniently rearranged in quadratic form as follows: (3.15)\u2211 c\u2208C(p) \u2225lpcnpc\u2225 (vc \u2212vp)2 = \u2211 c\u2208C(p) \u2225lpcnpc\u2225vc (vc \u2212vp)\u2212vp \u2211 c\u2208C(p)\n\u2225lpcnpc\u2225 (vc \u2212 vp)\ufe38 \ufe37\ufe37 \ufe38 =0 ,\nwhere the last term on the right hand side is zero due to the definition of the nodal fluxes (3.13). Inserting the above expression (3.15) into the thermodynamically compatible condition (3.14), allows the scalar correction factor \u03b1p to be computed: (3.16)\n\u03b1p =\n\u2211 c\u2208C(p)\nlpcnpc \u00b7 (pc vc \u2212 vp pc \u2212 pp vc)\u2211 c\u2208C(p) \u2225lpcnpc\u2225 (vc \u2212 vp)2 = |\u03c9p| (\u2212\u2207p \u00b7(pv) + vp \u00b7\u2207pp+ pp\u2207p \u00b7v)\u2211 c\u2208C(p) \u2225lpcnpc\u2225 (vc \u2212 vp)2\nwhere \u2207p\u00b7 and \u2207p are the discrete divergence and gradient operators defined on the dual cell [37]. It is interesting to notice that the condition (2.10) can also be interpreted as a consistency condition on the dual cell (similar to (3.12)) imposed on the contraction of the fluctuations with the dual variables w, that indeed must be equal to the energy flux \u2207 \u00b7 (pv). In the case of vanishing denominator in (3.16), that is when its numerical value is lower than 10\u221220, the correction factor is set to\n\u03b1p = 0. Notice that the thermodynamically compatible scheme (3.11) exhibits no numerical dissipation since the fluxes (3.13) are given by geometry weighted averages that can be seen as purely central fluxes. Nevertheless, the semi-discrete scheme (3.11) is nonlinearly stable in the energy norm, as we will prove later.\nTheorem 3.1. Assuming impermeable boundary conditions \u222b \u2202\u2126 v \u00b7 n ds = 0, the semi-discrete scheme (3.11) with nodal fluxes defined by (3.13) and the correction factor given by (3.16) is nonlinearly stable in the energy norm in the sense that we have\n(3.17)\n\u222b \u2126 dE dt dx = 0.\nProof. Mimicking the procedure at the continuous level yielding (2.12), let us compute the semi-discrete energy conservation law by contracting the semi-discrete scheme (3.11) with the dual variables w given by (2.7):\nmc dEc dt\n= \u2211\np\u2208P(c)\nlpcnpc \u00b7 (pc (vc \u2212 vp) + vc (pc \u2212 pp))\n\u2212 \u2211\np\u2208P(c)\n\u2225lpcnpc\u2225\u03b1p vc \u00b7 (vc \u2212 vp).(3.18)\nThe above equation can now be summed over all the cells which discretize the computational domain, yielding\u2211\nc\nmc dE\ndt = \u2211 c \u2211 p\u2208P(c) lpcnpc \u00b7 (pc (vc \u2212 vp) + vc (pc \u2212 pp))\n\u2212 \u2211 c \u2211 p\u2208P(c) \u2225lpcnpc\u2225\u03b1p vc \u00b7 (vc \u2212 vp)\n= \u2211 p \u2211 c\u2208C(p) lpcnpc \u00b7 (pc (vc \u2212 vp) + vc (pc \u2212 pp))\n\u2212 \u2211 p \u2211 c\u2208C(p) \u2225lpcnpc\u2225\u03b1p vc \u00b7 (vc \u2212 vp) = 0,(3.19)\nwhere we have switched the summation over all the cells and all the nodes of each cell with the summation over all the nodes and all the cells surrounding each node. Notice that the right hand side of the above equation is exactly the right hand side of the thermodynamic compatibility condition (3.14), which together with the definition of \u03b1p (3.16) leads to the last equality, hence retrieving the sought nonlinear stability in the energy norm (3.17).\n3.2. Boundary conditions. In the Lagrangian framework one has to deal with two types of boundary conditions, imposing either the pressure or the normal component of the velocity. Let p be a node lying on the boundary of the domain \u2202\u2126, as depicted in Figure 1. The corner vector on the boundary is given by\n(3.20) lpbnpb = l + pbn + pb + l \u2212 pbn \u2212 pb,\nwhere the outward normals l+pbn + pb and l \u2212 pbn \u2212 pb are referred to the boundary sides impinging on node p. These normals are essentials to satisfy the discrete Gauss theorem\nalso for a boundary node, and they are indeed linked to the corner vectors with the following relation:\n(3.21) \u2211\nc\u2208C(p)\nlpcnpc = lpbnpb.\nParticular care must be devoted to design the boundary conditions in such a way that the GCL property of the scheme is not spoiled. Here, we consider pressure and wall boundaries.\nPressure boundary condition. For a boundary node the consistent condition (3.12) would write (3.22)\n\u2212 \u2211\nc\u2208C(p)\nlpcnpc (pc \u2212 pp) + \u03b1p \u2211\nc\u2208C(p)\n\u2225lpcnpc\u2225(vc \u2212 vp) = \u2212 \u2211\nc\u2208C(p)\nlpcnpc pc + lpbnpb pb,\nwhere pb is the prescribed nodal pressure. We recall that the definition of pp is not constrained under any conservation requirement, thus the choice made in (3.13) can be modified. In order to maintain the same definition of vp in (3.13), which ensures conservation, we impose the following boundary pressure:\n(3.23) pp = pb.\nInserting the above definition into (3.22) and using the geometry identity (3.21), we retrieve the same conservation condition on the velocity given by (3.13). The thermodynamic compatibility condition (3.14) and thus the computation of the correction factor \u03b1p (3.16) remain unchanged.\nWall boundary condition. In order to prescribe the zero normal velocity at a boundary node, let us decompose the velocity vector of a boundary cell into the normal and tangential contributions with respect to the boundary corner vector (3.20):\n(3.24) vc := v \u22a5 c + v \u2225 c = (vc \u00b7 lpbnpb) lpbnpb + ( vc \u2212\nvc \u00b7 lpbnpb \u2225lpbnpb\u2225 lpbnpb\n) .\nNow, since the normal contribution is prescribed as boundary condition, we only have the freedom to determine the tangential velocity vector, relying on the consistency condition (3.12), thus we obtain\n\u2212 \u2211\nc\u2208C(p)\nlpcnpc (pc \u2212 pp) + \u03b1p \u2211\nc\u2208C(p)\n\u2225lpcnpc\u2225 ( (v\u22a5c + v \u2225 c )\u2212 vp ) = \u2212\n\u2211 c\u2208C(p) lpcnpc pc + lpbnpb pb.(3.25)\nThe boundary nodal pressure can be arbitrarily chosen because we are imposing a velocity boundary condition, therefore we simply set pb = pp. For wall boundaries obviously v\u22a5c = 0 holds, hence the velocity vector that is compatible with the prescribed boundary condition and satisfies conservation is eventually given by\n(3.26) vp =\n\u2211 c\u2208C(p)\n\u2225lpcnpc\u2225v\u2225c\u2211 c\u2208C(p) \u2225lpcnpc\u2225 .\nThis new definition of the node velocity must be taken into account also in the thermodynamically compatible correction (3.14), that now becomes\u2211\nc\u2208C(p)\nlpcnpc \u00b7 pc vc = \u2211\nc\u2208C(p)\nlpcnpc \u00b7 (pc (vc \u2212 vp) + vc (pc \u2212 pp))\n\u2212 \u03b1p \u2211\nc\u2208C(p)\n\u2225lpcnpc\u2225 (v\u2225c \u2212 vp)2,(3.27)\nfrom which we derive the correction factor \u03b1p that is also consistent with the prescribed wall boundary condition.\n3.3. Semi-discrete entropy stable Lagrangian schemes (ESL). If the flow exhibits discontinuities like shock waves, the entropy inequality (2.11c) permits to define the physically admissible solution characterized by an entropy increase. In this case we need to explicitly consider the entropy production term \u03a0 in our new scheme, which directly solves the entropy inequality. The production term must exactly account for the numerical dissipation introduced in the scheme, hence we need to: i) supplement the scheme with suitable numerical diffusion and, ii) quantify the amount of numerical viscosity to obtain a thermodynamically compatible entropy stable scheme.\nThe dissipative scheme is based on the EUCCLHYD finite volume method [33, 34], which is here rewritten in fluctuation form for the governing equations (2.11):\nmc d\u03c4c dt\n\u2212 \u2211\np\u2208P(c)\nlpcnpc \u00b7 (v\u2217p \u2212 vc) = 0,(3.28a)\nmc dvc dt\n+ \u2211\np\u2208P(c)\nlpcnpc (p \u2217 pc \u2212 pc) = 0,(3.28b)\nmc dSc dt\n= \u2211\np\u2208P(c)\n\u03a0pc \u2265 0.(3.28c)\nwhere lpcnpc \u00b7 v\u2217p and lpcnpcp\u2217p are the consistent numerical flux functions for the continuity and the momentum equations, respectively. In order to satisfy an entropy inequality within the cell \u03c9c, the expression of the pressure flux, also known as the sub-cell force [35], is given by\n(3.29) lpcnpcp \u2217 pc = lpcnpcpc \u2212Mpc(v\u2217p \u2212 vc),\nwith the symmetric and positive definite corner viscosity matrix [35]\n(3.30) Mpc = ac \u03c4c\n( l\u2212pc (n \u2212 pc \u2297 n\u2212pc) + l+pc (n+pc \u2297 n+pc) ) .\nThe node velocity v\u2217p is determined such that momentum conservation is ensured. Similar to the entropy conservative scheme, we apply the consistency condition (3.12) on the dual cell \u03c9p to the semi-discrete scheme (3.28), thus obtaining (3.31) \u2211\nc\u2208C(p)\nlpcnpc(p \u2217 pc \u2212 pc) = \u2212 \u2211 c\u2208C(p) lpcnpcpc = \u222b \u2202\u03c9p(t) p \u00b7 n ds,\nwhich requires that the sum of the sub-cell forces around a node vanishes. It is worth noticing that exactly the same relation is obtained in [33] by invoking conservation\nprinciples of energy and momentum over the whole computational domain. Inserting the definition of the sub-cell force (3.29) into the above equation yields a linear system for the nodal velocity:\n(3.32) Mpv \u2217 p = \u2211 c\u2208C(p) lpcnpcpc +Mpcvc, Mp = \u2211 c\u2208C(p) Mpc,\nwhich is typically referred to as nodal solver. To comply with the GCL, the nodes of the grid are moved according to (2.2) using the velocity v\u2217p. In order to quantify the production term in (3.28c), we dot-multiply the semi-discrete finite volume scheme (3.28) by the vector of dual variables w defined in (2.7), hence obtaining\n(3.33) \u03a0pc = 1\n\u03b8c (vc \u2212 v\u2217p)Mpc (vc \u2212 v\u2217p) \u2265 0,\nwhich is the non-negative entropy production term needed in eqn. (3.28c) of the scheme. It is non-negative since the temperature \u03b8c \u2265 0 is assumed to be non-negative and because the matrix Mpc is symmetric positive definite. Hence, our new scheme satisfies the entropy inequality by construction, which is a unique feature of the novel cell-centered Lagrangian scheme introduced in this paper.\nTheorem 3.2. Assuming impermeable wall boundary conditions \u222b \u2202\u2126 v \u00b7 nds = 0, the semi-discrete scheme (3.28) with nodal fluxes defined by (3.29) and (3.32) is nonlinearly stable in the energy norm in the sense that we have\n(3.34)\n\u222b \u2126 dE dt dx = 0.\nProof. Similar to the proof of Theorem 3.1, we proceed by computing the semidiscrete energy conservation law as the dot-product of the semi-discrete scheme (3.28) with the dual variables w given by (2.7):\nmc dEc dt\n= \u2212 \u2211\np\u2208P(c)\npc lpcnpc \u00b7 (v\u2217p \u2212 vc) + \u2211\np\u2208P(c)\n(vc \u2212 v\u2217p)Mpc (vc \u2212 v\u2217p)\n\u2212 \u2211\np\u2208P(c)\nvc \u00b7 lpcnpcpc \u2212 vc \u00b7Mpc(v\u2217p \u2212 vc)\u2212 vc \u00b7 lpcnpcpc.(3.35)\nAfter some algebra and using the geometrical identity (3.2), the above equation simplifies to\nmc dEc dt\n= \u2212 \u2211\np\u2208P(c)\npc lpcnpc \u00b7 v\u2217p \u2212 \u2211\np\u2208P(c)\nv\u2217pMpc (vc \u2212 v\u2217p).(3.36)\nLet us now sum the local energy equation (3.36) over all the cells paving the computational domain, hence obtaining\u2211\nc\nmc dEc dt = \u2211 c \u2211 p\u2208P(c) \u2212pc lpcnpc \u00b7 v\u2217p \u2212 v\u2217pMpc (vc \u2212 v\u2217p)\n= \u2212 \u2211 p v\u2217p \u2211 c\u2208C(p) pc lpcnpc \u2212Mpc (v\u2217p \u2212 vc) = 0,(3.37)\nwhere we have switched the summation between cells and nodes since we are dealing with finite summations. Notice that the term on the right hand side of the energy balance (3.37) is the sub-cell force definition (3.29), whose summation over all the cells surrounding a node is exactly zero because of the conservation property (3.31) which the semi-discrete scheme (3.28) relies on. Therefore, we retrieve the nonlinear stability (3.34) at the discrete level.\n3.4. Adaptive semi-discrete ECL/ESL schemes. Because of the non-linearity of the governing equations, the flow can dynamically face situations of discontinuities and/or smooth solutions, that must be properly handled by an adaptive switching in space and time between the entropy conservative and entropy stable scheme. Let F(u) = (\u2207 \u00b7 v,\u2212\u2207p,\u03a0)\u22a4 be the spatial fluxes of the hydrodynamics system (2.11), and let FCh and F S h represent its entropy conservative and entropy stable spatial discretization according to (3.11) and (3.28), respectively. The semi-discrete schemes (3.11) and (3.28) are then hybridized at each time step with a convex combination of the form\n(3.38) mc duc dt = (1\u2212 \u03b2p) \u00b7FCh + \u03b2p \u00b7FSh ,\nwhere \u03b2p is the blending factor. The design of the blending factor is out of the scope of this work, therefore we simply set\n(3.39) \u03b2p = { 1 for discontinuous flows 0 for smooth flows .\nTo detect discontinuities in the solution, we use either the a priori technique designed in [4], which is based on the measure of the discrete divergence of the velocity field, or the a posteriori MOOD strategy [16, 7, 6], that identifies the troubled cells relying on a set of physical and numerical admissibility criteria.\nTheorem 3.3. Assuming a convex equations of state \u03b5 = \u03b5(\u03c4, S), well prepared initial data in the sense that \u03c4c(t = 0) > 0 and Sc(t = 0) \u2265 0 and assuming positive cell volumes |\u03c9c(t)| > 0 for all times t \u2265 0, the semi-discrete scheme (3.38) is positivity preserving for pressure, density and temperature, that is\n(3.40) \u03c1c(t) > 0, pc(t) \u2265 0, \u03b8c(t) \u2265 0.\nProof. The adaptive scheme (3.38) is a convex combination of the semi-discrete schemes (3.11) and (3.28). Since the Lagrangian element mass mc = |\u03c9c(0)|/\u03c4c(0) > 0 is strictly positive and constant in time and since the volumes are assumed to be positive, |\u03c9c(t)| > 0, the density \u03c1c(t) = mc/|\u03c9c(0)| > 0 is necessarily positive for all times. Since the initial entropy is non-negative and the entropy in each element is non-decreasing due to \u03a0pc \u2265 0 in (3.28c) and due to the absence of source terms in (3.11c) we have Sc \u2265 0 for all times. As an immediate consequence, the pressure and the temperature in each cell are always positive, pc \u2265 0 and \u03b8c \u2265 0 according to their definition (2.3) and the assumed convexity of the equation of state.\n4. Numerical results. We present a suite of classical numerical test cases for Lagrangian hydrodynamics that aim at showing the correct convergence and shock capturing properties of the novel hyperbolic and thermodynamically compatible Lagrangian scheme, which will be referred to as HTC-Lag method in the following. Differently from most of the existing cell-centered and staggered Lagrangian numerical methods that discretize the Lagrangian hydrodynamics equations in the form\n(2.1), the energy equation is obtained as a consequence of the thermodynamically compatible discretization of the governing PDE system (2.11), since we are directly solving the entropy inequality. Consequently, the major objective of the following test problems is to demonstrate the capability of the HTC-Lag schemes to compute correct solutions for problems with shock waves. Depending on the test case, we either use the a priori or the a posteriori troubled cell detector to compute the blending factor introduced in Section 3.4. If not stated otherwise, the CFL number is set to CFL = 0.4 and the polytropic index of the gas is assumed to be \u03b3 = 7/5. For comparison, some of the results are also obtained with the classical cell-centered Lagrangian Finite Volume method, named EUCCLHYD [33], that constitutes the main building block for the dissipative part of our novel HTC-Lag method.\nFor all test cases, time integration is performed using the classical explicit fourth order Runge-Kutta method [31], thus ensuring that the GCL and total energy conservation are satisfied up to sufficient accuracy at the fully-discrete level.\n4.1. Numerical convergence study. To verify the accuracy of the new HTCLag scheme we rely on the isentropic vortex test case proposed in [27], which is defined in the computational domain (x, y) \u2208 [0; 10]\u00d7 [0; 10] with periodic boundaries everywhere. The initial condition is given in terms of a homogeneous background field (\u03c1,v, p)0 that is supplemented with a set of perturbations defined in [27]. The simulations are run until the final time tf = 1 on a set of refined meshes with characteristic mesh size h = max c \u221a |\u2126c|, and the convergence rates are reported in Table 1 using a convective background velocity of the vortex v = (1, 1). No troubled cell detector is used since the flow field is smooth. The errors are measured in L2 norm for density, horizontal velocity and total energy density, which is obtained via a post-processing of the state variables. One can observe that the expected first order of accuracy is achieved.\n4.2. Riemann problems. The novel HTC-Lag scheme is now tested against a set of Riemann problems (RP) with initial data given in Table 2. The left and right state are given by (\u03c1, u, p)L,R, the initial discontinuity is located at xd = 0 and the computational domain is given by (x, y) \u2208 [xL;xR]\u00d7 [\u22120.05; 0.05] and we use a twodimensional computational grid with characteristic mesh size of h = 1/200. Periodic boundary conditions are set in y\u2212direction, while the x\u2212boundaries are treated as no-slip walls. Despite the one-dimensional setup of these test problems, the simulations are truly multidimensional on unstructured grids, since no element edges are in principle aligned with the main flow. As such, this suite of Riemann problems also allows to check the symmetry preservation of the HTC-Lag method. The numerical solutions are compared with the exact solution of the Riemann problems provided\nin [44]. RP1 and RP2 are the Sod and the Lax shock tube problem, respectively, while RP3 corresponds to the double rarefaction test case forwarded in [44]. We use the a posteriori detector of troubled cells for RP1 and RP2, that supplements the scheme with numerical dissipation only across the shock waves, as clearly visible in the first panels of Figures 2-3. We also note that the results for horizontal velocity and pressure distribution are in excellent agreement with the exact solution, hence proving the correct entropy production by the HTC-Lag scheme across shock waves and to properly resolve rarefaction fans without spurious entropy production. Figure 4 shows a comparison between the EUCCLHYD and the HTC-Lag scheme in terms of specific internal energy for RP3, which consists in an isentropic expansion of the gas. It is evident that the new methods are able to properly capture the correct behavior of the gas close to vacuum in the vicinity of the center of the domain. On the other hand, the EUCCLHYD scheme suffers from a spurious entropy production in the rarefaction, which implies a spurious heating.\n4.3. Sedov problem. This problem involves a strong blast wave departing from the origin at (0, 0)or of the computational domain (x, y) \u2208 [0; 1.2]\u00d7[0; 1.2]. We set wall boundary conditions on the left and bottom side, while transmissive pressure boundaries are imposed elsewhere. The domain is paved with an unstructured triangular mesh with characteristic size of h = 0.03 yielding a total number of Nc = 3602 cells. The fluid is initially assigned with a constant state given by (\u03c1,v, p)0 = (1,0, 10\u22126). The energy of the explosion is totally concentrated in the cells containing the origin by prescribing an initial pressure por = (\u03b3\u22121)\u03c10\u03b50/|\u03c9|or, where |\u03c9|or denotes the volume of the cells containing the origin. According to [29], the amount of released energy is set to \u03b50 = 0.244816, thus the solution consists of a diverging infinite strength shock wave that is placed at radius r = 1 at the final time of the simulation tf = 1. The analytical solution can be found in [29]. This test is run using both the new HTCLag and the EUCCLHYD scheme, and the final density distribution is qualitatively compared in Figure 5. Being less dissipative, the HTC-Lag scheme better captures the shock peak and location, which is also visible from the density scatter plots. We use the a priori detector of troubled cells that is only active across the shock wave, as expected, thus entropy increases perfectly in correspondence of the discontinuity, as shown in Figure 6.\n4.4. Cylindrical expansion into vacuum. As last test case we solve a cylindrical expansion of gas into vacuum, as proposed in [37]. The computational domain is given by the portion of a shell defined with cylindrical coordinates (r, \u03d5) \u2208 [0.1; 0.1] \u00d7 [0;\u03c0/2], and it is paved with a triangular grid of sizes hr = 1/100 and h\u03d5 = 1/30 in radial and angular direction, respectively. Wall boundaries are prescribed at \u03d5 = 0 and \u03d5 = \u03c0/2, whereas we apply a free pressure (pb = 0) boundary condition on the internal and the external frontier of the shell. No troubled cell detec-\ntion is carried out for this test case, thus the HTC-Lag scheme is run with zero entropy production until the final time tf = 0.3. Figure 7 shows the final mesh configuration with the entropy distribution, which remains of machine accuracy throughout the entire computation. We also plot the scalar correction factor \u03b1p, which is mostly active across the density and pressure jumps, detected with the a posteriori indicator. Finally, the results are compared against those obtained with the EUCCLHYD scheme in terms of radial velocity and specific internal energy distribution. Furthermore, a reference solution is obtained by solving this test case on a very fine one-dimensional mesh with 20\u2019000 cells by a second order MUSCL-Hancock-type TVD scheme. We observe that the classical cell-centered formulation is plagued by a spurious heating in the vicinity of the interface with the vacuum. The new thermodynamically compatible schemes can cure quite well this behavior, obtaining results which are in very good agreement with the reference solution, even in the vicinity of the vacuum interface.\n5. Conclusions. In this work a new cell-centered Lagrangian finite volume scheme for gas dynamics has been designed that is by construction compatible with the second law of thermodynamics and which satisfies the total energy conservation as a consequence at the semi-discrete level. Unlike existing schemes, the novel method\ndirectly evolves the entropy as a primal evolution quantity while total energy conservation is merely retrieved as a consequence of the new thermodynamically compatible scheme. The new method is proven to be nonlinearly stable in the energy norm. Moreover, we demonstrate the positivity preserving property for both density and pressure. Entropy conservative as well as entropy stable schemes are derived, and they are blended by a space-time adaptive technique which preserves all the thermodynamic properties of the original methods. Numerical convergence rates and results for classical benchmarks in Lagrangian hydrodynamics have been run, showing the advantages of the new thermodynamically compatible schemes over standard cell-centered Lagrangian methods, especially in regions of isentropic flow.\nIn the future we plan to design a thermodynamically compatible Lagrangian discretization for the GPR model of continuum mechanics [39], starting from the Lagrangian finite volume scheme proposed in [5]. We also aim at investigating the development of a more sophisticated blending factor in the adaptive scheme, in order to provide a smoother transition between entropy conservative/stable schemes.\nAcknowledgments. WB received financial support by Fondazione Cariplo and Fondazione CDP (Italy) under the grant No. 2022-1895 and by the Italian Ministry of\nUniversity and Research (MUR) with the PRIN Project 2022 No. 2022N9BM3N. MD was funded by the Italian Ministry of University and Research (MUR) in the frame of the PRIN 2022 project High order structure-preserving semi-implicit schemes for hyperbolic equations and by the European Union NextGenerationEU (PNRR, Spoke 7 CN HPC). Views and opinions expressed are however those of the author(s) only and do not necessarily reflect those of the European Union or the European Research Council. Neither the European Union nor the granting authority can be held responsible for them."
        }
    ],
    "title": "A NEW THERMODYNAMICALLY COMPATIBLE FINITE VOLUME SCHEME FOR LAGRANGIAN GAS DYNAMICS",
    "year": 2023
}