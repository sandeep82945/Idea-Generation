{
    "abstractText": "Yield farming represents an immensely popular asset management activity in decentralized finance (DeFi). It involves supplying, borrowing, or staking crypto assets to earn an income in forms of transaction fees, interest, or participation rewards at different DeFi marketplaces. In this systematic survey, we present yield farming protocols as an aggregationlayer constituent of the wider DeFi ecosystem that interact with primitive-layer protocols such as decentralized exchanges (DEXs) and protocols for loanable funds (PLFs). We examine the yield farming mechanism by first studying the operations encoded in the yield farming smart contracts, and then performing stylized, parameterized simulations on various yield farming strategies. We conduct a thorough literature review on related work, and establish a framework for yield farming protocols that takes into account pool structure, accepted token types, and implemented strategies. Using our framework, we characterize major yield aggregators in the market including Yearn Finance, Beefy, and Badger DAO. Moreover, we discuss anecdotal attacks against yield aggregators and generalize a number of risks associated with yield farming. Keywords\u2014Decentralized Finance (DeFi), yield farming, yield aggregator, simulation, blockchain",
    "authors": [
        {
            "affiliations": [],
            "name": "Jiahua Xu"
        },
        {
            "affiliations": [],
            "name": "Yebo Feng"
        }
    ],
    "id": "SP:fc658d87206f58df5871b82890059e6a75b3c329",
    "references": [
        {
            "authors": [
                "Aave"
            ],
            "title": "Open Source DeFi Protocol",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://aave.com/",
            "year": 2021
        },
        {
            "authors": [
                "G. Angeris",
                "H.-T. Kao",
                "R. Chiang",
                "C. Noyes",
                "T. Chitra"
            ],
            "title": "An Analysis of Uniswap markets",
            "venue": "Cryptoeconomic Systems, 11 2020. [Online]. Available: https://cryptoeconomicsystems.pubpub.org/pub/a ngeris-uniswap-analysis",
            "year": 2020
        },
        {
            "authors": [
                "Ankr"
            ],
            "title": "Ankr doc",
            "venue": "2022, accessed: 2022-08-15. [Online]. Available: https://www.ankr.com/ankr-whitepaper-2.0.pdf",
            "year": 2022
        },
        {
            "authors": [
                "M. Apostolaki",
                "A. Zohar",
                "L. Vanbever"
            ],
            "title": "Hijacking bitcoin: Routing attacks on cryptocurrencies",
            "venue": "2017 IEEE symposium on security and privacy (SP). IEEE, 2017, pp. 375\u2013392.",
            "year": 2017
        },
        {
            "authors": [
                "P. Augustin",
                "R. Chen-Zhang",
                "D. Shin"
            ],
            "title": "Yield farming",
            "venue": "Available at SSRN 4063228, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "Avalanche"
            ],
            "title": "Avalanche doc",
            "venue": "2020.",
            "year": 2020
        },
        {
            "authors": [
                "Balancer"
            ],
            "title": "Balancer",
            "venue": "2021, accessed: 2022-08-15. [Online]. Available: https://balancer.finance/",
            "year": 2021
        },
        {
            "authors": [
                "Bank of Chain"
            ],
            "title": "Bank of Chain Docs",
            "venue": "2022, accessed: 2022-09-01. [Online]. Available: https://docs.bankofchain.io/en/",
            "year": 2022
        },
        {
            "authors": [
                "M. Bartoletti",
                "J.H.-y. Chiang",
                "A.L. Lafuente"
            ],
            "title": "SoK: Lending Pools in Decentralized Finance",
            "venue": "Workshop Proceedings of Financial Cryptography and Data Security, vol. 12676 LNCS, 12 2021, pp. 553\u2013578. [Online]. Available: https://link.springer.com/10.1007/978-3 -662-63958-0 40",
            "year": 2021
        },
        {
            "authors": [
                "J. Bertin"
            ],
            "title": "What is NFT yield farming, and how does it work?",
            "year": 2022
        },
        {
            "authors": [
                "BNBchain"
            ],
            "title": "BNB doc",
            "venue": "2022, accessed: 2022-08-15. [Online]. Available: https://docs.bnbchain.org/docs/bnbIntro/",
            "year": 2022
        },
        {
            "authors": [
                "E. Cecchetti",
                "S. Yao",
                "H. Ni",
                "A.C. Myers"
            ],
            "title": "Compositional Security for Reentrant Applications",
            "venue": "IEEE Symposium on Security and Privacy, 5 2021, pp. 1249\u20131267.",
            "year": 2021
        },
        {
            "authors": [
                "Compound"
            ],
            "title": "Compound",
            "venue": "2021, accessed: 2022-08-15. [Online]. Available: https://compound.finance/",
            "year": 2021
        },
        {
            "authors": [
                "S. Cousaert",
                "N. Vadgama",
                "J. Xu"
            ],
            "title": "Token-Based Insurance Solutions on Blockchain",
            "venue": "Blockchains and the Token Economy: Theory and Practice, sep 2022, pp. 237\u2013260. [Online]. Available: https://link.springer.com/10.1007/978-3-030-95108-5 9",
            "year": 2022
        },
        {
            "authors": [
                "S. Cousaert",
                "J. Xu",
                "T. Matsui"
            ],
            "title": "SoK: Yield Aggregators in DeFi",
            "venue": "International Conference on Blockchain and Cryptocurrency. IEEE, may 2022, pp. 1\u201314. [Online]. Available: https://ieeexplore.iee e.org/document/9805523/",
            "year": 2022
        },
        {
            "authors": [
                "A. Cronje"
            ],
            "title": "YFI. Under yearn.finance we have released",
            "venue": "7 2020, accessed: 2022-09-01. [Online]. Available: https://medium.com/iearn /yfi-df84573db81",
            "year": 2020
        },
        {
            "authors": [
                "Curve Finance"
            ],
            "title": "Curve Finance",
            "venue": "2021, accessed: 2022-08-15. [Online]. Available: https://curve.fi/",
            "year": 2021
        },
        {
            "authors": [
                "\u2014\u2014"
            ],
            "title": "Understanding Tokenomics",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://resources.curve.fi/base-features/understand ing-tokenomics",
            "year": 2021
        },
        {
            "authors": [
                "A. Das",
                "S. Balzer",
                "J. Hoffmann",
                "F. Pfenning",
                "I. Santurkar"
            ],
            "title": "Resource-aware session types for digital contracts",
            "venue": "2021 IEEE 34th Computer Security Foundations Symposium (CSF), 2021, pp. 1\u2013 16.",
            "year": 2021
        },
        {
            "authors": [
                "DeFi Llama"
            ],
            "title": "DeFi Leader Board",
            "venue": "accessed: 2022-08-15. [Online]. Available: https://defillama.com/chains",
            "year": 2022
        },
        {
            "authors": [
                "DeFi Score"
            ],
            "title": "DeFi Score",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://defiscore.io/",
            "year": 2021
        },
        {
            "authors": [
                "S. Eskandari",
                "S. Moosavi",
                "J. Clark"
            ],
            "title": "Sok: Transparent dishonesty: front-running attacks on blockchain",
            "venue": "International Conference on Financial Cryptography and Data Security. Springer, 2019, pp. 170\u2013 189.",
            "year": 2019
        },
        {
            "authors": [
                "Ethereum"
            ],
            "title": "Ethereum2 doc",
            "venue": "2022, accessed: 2022-09-01. [Online]. Available: https://ethereum.org/en/upgrades/",
            "year": 2022
        },
        {
            "authors": [
                "Fantom"
            ],
            "title": "Fantom doc",
            "venue": "2018, accessed: 2022-09-01. [Online]. Available: https://fantom.foundation/research/wp fantom v1.6.pdf",
            "year": 2018
        },
        {
            "authors": [
                "Y. Feng",
                "J. Xu",
                "L. Weymouth"
            ],
            "title": "University blockchain research initiative (ubri): Boosting blockchain education and research",
            "venue": "IEEE Potentials, vol. 41, no. 6, pp. 19\u201325, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "L. Gudgeon",
                "D. Perez",
                "D. Harz",
                "B. Livshits",
                "A. Gervais"
            ],
            "title": "The Decentralized Financial Crisis",
            "venue": "Crypto Valley Conference on Blockchain Technology (CVCBT), no. February. IEEE, 6 2020, pp. 1\u2013 15. [Online]. Available: https://ieeexplore.ieee.org/document/9150192/",
            "year": 2020
        },
        {
            "authors": [
                "L. Gudgeon",
                "S. Werner",
                "D. Perez",
                "W.J. Knottenbelt"
            ],
            "title": "DeFi Protocols for Loanable Funds",
            "venue": "Proceedings of the 2nd ACM Conference on Advances in Financial Technologies. New York, NY, USA: ACM, 10 2020, pp. 92\u2013112. [Online]. Available: https://dl.acm.org/doi/10.1145/3419614.3423254",
            "year": 2020
        },
        {
            "authors": [
                "J. Han",
                "S. Huang",
                "Z. Zhong"
            ],
            "title": "Trust in DeFi: An Empirical Study of the Decentralized Exchange",
            "venue": "2021.",
            "year": 2021
        },
        {
            "authors": [
                "Harvest Finance"
            ],
            "title": "FARM Token Info",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://farm.chainwiki.dev/en/supply",
            "year": 2021
        },
        {
            "authors": [
                "\u2014\u2014"
            ],
            "title": "Harvest Finance Yield Farming Strategies",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://farm.chainwiki.dev/en/strategy",
            "year": 2021
        },
        {
            "authors": [
                "\u2014\u2014"
            ],
            "title": "Harvest Vault",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://farm.chainwiki.dev/en/education/vault",
            "year": 2021
        },
        {
            "authors": [
                "Y. Huang",
                "Y. Bian",
                "R. Li",
                "J.L. Zhao",
                "P. Shi"
            ],
            "title": "Smart contract security: A software lifecycle perspective",
            "venue": "IEEE Access, vol. 7, pp. 150 184\u2013150 202, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "Idle Finance"
            ],
            "title": "Distribution - Idle",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://developers.idle.finance/advanced/governan ce/distribution",
            "year": 2021
        },
        {
            "authors": [
                "\u2014\u2014"
            ],
            "title": "Idle Finance Documentation",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://developers.idle.finance/",
            "year": 2021
        },
        {
            "authors": [
                "Jakub"
            ],
            "title": "Yearn Finance And YFI Token Explained",
            "venue": "2020, accessed: 2022-09-01. [Online]. Available: https://finematics.com/yearn-finance -and-yfi-explained/",
            "year": 2020
        },
        {
            "authors": [
                "H.T. Kao",
                "T. Chitra",
                "R. Chiang",
                "J. Morrow"
            ],
            "title": "An Analysis of the Market Risk to Participants in the Compound Protocol",
            "venue": "Third International Symposium on Foundations and Applications of Blockchain (FAB \u201820), 2020. [Online]. Available: https://scfab.github.i o/2020/FAB2020 p5.pdf",
            "year": 2020
        },
        {
            "authors": [
                "M. Kjaer",
                "M. di Angelo",
                "G. Salzer"
            ],
            "title": "Empirical Evaluation of MakerDAO\u2019s Resilience",
            "venue": "3rd Conference on Blockchain Research & Applications for Innovative Networks and Services (BRAINS). IEEE, 9 2021, pp. 193\u2013200. [Online]. Available: https://ieeexplore.ieee.org/ document/9569811/",
            "year": 2021
        },
        {
            "authors": [
                "R. Leshner"
            ],
            "title": "Expanding Compound Governance.",
            "year": 2020
        },
        {
            "authors": [
                "Lido"
            ],
            "title": "Liquidity for staked assets",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://lido.fi/",
            "year": 2021
        },
        {
            "authors": [
                "J. Lipstone"
            ],
            "title": "Rari Capital Partners with Saffron Finance",
            "venue": "12 2020, accessed: 2022-09-01. [Online]. Available: https://medium.com/rari-c apital/rari-capital-partners-with-saffron-finance-b80c82878c07",
            "year": 2020
        },
        {
            "authors": [
                "S. Mackenzie"
            ],
            "title": "Criminology towards the metaverse: Cryptocurrency scams, grey economy and the technosocial",
            "venue": "The British Journal of Criminology, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "H. Markowitz"
            ],
            "title": "Portfolio Selection",
            "venue": "The Journal of Finance, vol. 7, no. 1, pp. 77\u201391, 1952.",
            "year": 1952
        },
        {
            "authors": [
                "milkyklim"
            ],
            "title": "Introduction to Yearn",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://docs.yearn.finance/",
            "year": 2021
        },
        {
            "authors": [
                "A. Moin",
                "E.G. Sirer",
                "K. Sekniqi"
            ],
            "title": "A Classification Framework for Stablecoin Designs",
            "venue": "Lecture Notes in Computer Science (including subseries Lecture Notes in Artificial Intelligence and Lecture Notes in Bioinformatics), vol. 12059 LNCS, pp. 174\u2013197, 9 2019. [Online]. Available: http://arxiv.org/abs/1910.10098",
            "year": 2019
        },
        {
            "authors": [
                "E. Napoletano",
                "B. Curry"
            ],
            "title": "What is DeFi? understanding decentralized finance",
            "venue": "4 2022, accessed: 2022-11-10. [Online]. Available: https://www.forbes.com/advisor/investing/cryptocurrency/de fi-decentralized-finance/",
            "year": 2022
        },
        {
            "authors": [
                "D. Perez",
                "S.M. Werner",
                "J. Xu",
                "B. Livshits"
            ],
            "title": "Liquidations: DeFi on a Knife-Edge",
            "venue": "Financial Cryptography and Data Security, vol. 12675 LNCS. Springer, 2021, pp. 457\u2013476. [Online]. Available: https://link.springer.com/10.1007/978-3-662-64331-0 24",
            "year": 2021
        },
        {
            "authors": [
                "D. Perez",
                "J. Xu",
                "B. Livshits"
            ],
            "title": "Revisiting Transactional Statistics of High-scalability Blockchains",
            "venue": "ACM Internet Measurement Conference, vol. 16, no. 20. New York, NY, USA: ACM, oct 2020, pp. 535\u2013550. [Online]. Available: https://dl.acm.org/doi/10.1145/341 9394.3423628",
            "year": 2020
        },
        {
            "authors": [
                "Pickle Finance"
            ],
            "title": "Emission Schedule - Pickle Finance Docs",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://docs.pickle.finance /faqs/emissions",
            "year": 2021
        },
        {
            "authors": [
                "M. Platt",
                "J. Sedlmeir",
                "D. Platt",
                "J. Xu",
                "P. Tasca",
                "N. Vadgama",
                "J.I. Ibanez"
            ],
            "title": "The Energy Footprint of Blockchain Consensus Mechanisms Beyond Proof-of-Work",
            "venue": "21st International Conference on Software Quality, Reliability and Security Companion (QRS-C). IEEE, dec 2021, pp. 1135\u20131144. [Online]. Available: https://ieeexplore.ieee.org/ document/9741872/",
            "year": 2021
        },
        {
            "authors": [
                "Polkadot"
            ],
            "title": "Polkadot doc",
            "venue": "2016, accessed: 2022-09-01. [Online]. Available: https://polkadot.network/PolkaDotPaper.pdf",
            "year": 2016
        },
        {
            "authors": [
                "Polygon"
            ],
            "title": "Polygon doc",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://polygon.technology/lightpaper-polygon.pdf",
            "year": 2021
        },
        {
            "authors": [
                "PoolTogether"
            ],
            "title": "Home Page",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://pooltogether.com/",
            "year": 2021
        },
        {
            "authors": [
                "A.-d. Popescu"
            ],
            "title": "Transitions and Concepts Within Decentralized Finance ( Defi ) Space",
            "venue": "Social Science Research, no. May, pp. 40\u201361, 2020. [Online]. Available: https://www.researchgate.net/publication/3 44348838 TRANSITIONS AND CONCEPTS WITHIN DECENTR ALIZED FINANCE DEFI SPACE",
            "year": 2020
        },
        {
            "authors": [
                "K. Qin",
                "L. Zhou",
                "A. Gervais"
            ],
            "title": "Quantifying blockchain extractable value: How dark is the forest?",
            "venue": "IEEE Symposium on Security and Privacy (SP). IEEE,",
            "year": 2022
        },
        {
            "authors": [
                "K. Qin",
                "L. Zhou",
                "B. Livshits",
                "A. Gervais"
            ],
            "title": "Attacking the DeFi Ecosystem with Flash Loans for Fun and Profit",
            "venue": "Financial Cryptography and Data Security, vol. 12674 LNCS. Springer, 2021, pp. 3\u201332. [Online]. Available: https://link.springer.com/10.1007/978-3 -662-64322-8 1",
            "year": 2021
        },
        {
            "authors": [
                "Rari Capital"
            ],
            "title": "Rari Capital",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://www.rari.capital/index.html",
            "year": 2021
        },
        {
            "authors": [
                "M. Rodler",
                "W. Li",
                "G.O. Karame",
                "L. Davi"
            ],
            "title": "Sereum: Protecting Existing Smart Contracts Against Re-Entrancy Attacks",
            "venue": "Network and Distributed System Security Symposium (NDSS), 2019.",
            "year": 2019
        },
        {
            "authors": [
                "K. Saengchote"
            ],
            "title": "Decentralized lending and its users: Insights from Compound",
            "venue": "Tech. Rep., 2022. [Online]. Available: https: //ssrn.com/abstract=3925344",
            "year": 2022
        },
        {
            "authors": [
                "F. Sch\u00e4r"
            ],
            "title": "Decentralized Finance: On Blockchain- and Smart Contract- Based Financial Markets",
            "venue": "Federal Reserve Bank of St. Louis Review, pp. 153\u201374, 2021. [Online]. Available: https://research.stlouisfed.org/ publications/review/2021/02/05/decentralized-finance-on-blockchain-a nd-smart-contract-based-financial-markets?fbclid=IwAR2EJyX0LLTh FztaI0kuxOgG6aiXM25mbuiOTl04ZXgvAZjl1NqKxU fJoc",
            "year": 2021
        },
        {
            "authors": [
                "Solana"
            ],
            "title": "Solana doc",
            "venue": "2018, accessed: 2022-09-01. [Online]. Available: https://solana.com/solana-whitepaper.pdf",
            "year": 2018
        },
        {
            "authors": [
                "Sushiswap"
            ],
            "title": "FAQ - xSUSHI",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://docs.sushi.com/faq#xsushi-staking",
            "year": 2021
        },
        {
            "authors": [
                "The European Business Review"
            ],
            "title": "What Is A \u201cRug Pull\u201d In Crypto? DeFi Exploits Explained",
            "venue": "1 2021. [Online]. Available: https://www.europeanbusinessreview.com/what-is-a-rug-pull-in-crypt o-defi-exploits-explained/",
            "year": 2021
        },
        {
            "authors": [
                "P. Tolmach",
                "Y. Li",
                "S.-W. Lin",
                "Y. Liu"
            ],
            "title": "Formal Analysis of Composable DeFi Protocols",
            "venue": "2 2021. [Online]. Available: http://arxiv.org/abs/2103.00540",
            "year": 2021
        },
        {
            "authors": [
                "P. Treleaven",
                "A. Greenwood",
                "H. Pithadia",
                "J. Xu"
            ],
            "title": "Web 3.0 tokenization and decentralized finance (defi)",
            "venue": "Available at SSRN 4037471, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "Uniswap"
            ],
            "title": "Introducing UNI",
            "venue": "9 2020, accessed: 2022-09-01. [Online]. Available: https://uniswap.org/blog/uni/",
            "year": 2020
        },
        {
            "authors": [
                "\u2014\u2014"
            ],
            "title": "Uniswap",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://uniswap.org/",
            "year": 2021
        },
        {
            "authors": [
                "Vesper Finance"
            ],
            "title": "Homepage - Vesper Finance",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://vesper.finance/",
            "year": 2021
        },
        {
            "authors": [
                "\u2014\u2014"
            ],
            "title": "Vesper\u2019s Tokenomics",
            "venue": "2 2021, accessed: 2022-09-01. [Online]. Available: https://medium.com/vesperfinance/vespers-tokenomics-a n-overview-f342ae5b613f",
            "year": 2021
        },
        {
            "authors": [
                "N. Walton"
            ],
            "title": "Yield Generation Using Decentralized Financial (DeFi) Applications",
            "venue": "Ph.D. dissertation, 2022. [Online]. Available: https: //scholarcommons.sc.edu/cgi/viewcontent.cgi?article=1546&context=s enior theses#:\u223c:text=Decentralizedfinancial(DeFi)applicationsare,muc hlikeatraditionalbank.",
            "year": 2022
        },
        {
            "authors": [
                "Z. Wan",
                "X. Xia",
                "D. Lo",
                "J. Chen",
                "X. Luo",
                "X. Yang"
            ],
            "title": "Smart contract security: A practitioners\u2019 perspective",
            "venue": "2021 IEEE/ACM 43rd International Conference on Software Engineering (ICSE), 2021, pp. 1410\u20131422.",
            "year": 2021
        },
        {
            "authors": [
                "Z. Wang",
                "H. Jin",
                "W. Dai",
                "K.-K.R. Choo",
                "D. Zou"
            ],
            "title": "Ethereum smart contract security research: survey and future research opportunities",
            "venue": "Frontiers of Computer Science, vol. 15, no. 2, pp. 1\u201318, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "S.M. Werner",
                "D. Perez",
                "L. Gudgeon",
                "A. Klages-Mundt",
                "D. Harz",
                "W.J. Knottenbelt"
            ],
            "title": "SoK: Decentralized Finance (DeFi)",
            "venue": "1 2021. [Online]. Available: http://arxiv.org/abs/2101.08778",
            "year": 2021
        },
        {
            "authors": [
                "P. Xia",
                "H. Wang",
                "B. Gao",
                "W. Su",
                "Z. Yu",
                "X. Luo",
                "C. Zhang",
                "X. Xiao",
                "G. Xu"
            ],
            "title": "Trade or trick? detecting and characterizing scam tokens on uniswap decentralized exchange",
            "venue": "Proceedings of the ACM on Measurement and Analysis of Computing Systems, vol. 5, no. 3, pp. 1\u201326, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "J. Xu",
                "K. Paruch",
                "S. Cousaert",
                "Y. Feng"
            ],
            "title": "SoK: Decentralized Exchanges (DEX) with Automated Market Maker (AMM) protocols",
            "venue": "ACM Computing Surveys, nov 2022. [Online]. Available: https: //dl.acm.org/doi/10.1145/3570639",
            "year": 2022
        },
        {
            "authors": [
                "J. Xu",
                "N. Vadgama"
            ],
            "title": "From Banks to DeFi: the Evolution of the Lending Market",
            "venue": "Enabling the Internet of Value: How Blockchain Connects Global Businesses, 4 2022, ch. 6, pp. 53\u201366. [Online]. Available: https://link.springer.com/10.1007/978-3-030-78184-2 6",
            "year": 2022
        },
        {
            "authors": [
                "T.A. Xu",
                "J. Xu"
            ],
            "title": "A Short Survey on Business Models of Decentralized Finance (DeFi) Protocols",
            "venue": "Workshop Proceedings of Financial Cryptography and Data Security, 2 2022.",
            "year": 2022
        },
        {
            "authors": [
                "T.A. Xu",
                "J. Xu",
                "K. Lommers"
            ],
            "title": "DeFi vs TradFi: Valuation Using Multiples and Discounted Cash Flow",
            "venue": "oct 2022. [Online]. Available: https://arxiv.org/abs/2210.16846",
            "year": 2022
        },
        {
            "authors": [
                "Yearn Finance"
            ],
            "title": "yearn.finance",
            "venue": "2021, accessed: 2022-09-01. [Online]. Available: https://yearn.finance/",
            "year": 2021
        },
        {
            "authors": [
                "L. Zhou",
                "K. Qin",
                "A. Cully",
                "B. Livshits",
                "A. Gervais"
            ],
            "title": "On the justin-time discovery of profit-generating transactions in defi protocols",
            "venue": "2021 IEEE Symposium on Security and Privacy (SP). IEEE, 2021, pp. 919\u2013936.",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "Keywords\u2014Decentralized Finance (DeFi), yield farming, yield aggregator, simulation, blockchain\nI. INTRODUCTION\nY IELD farming protocols are deemed as the decentralizedasset managers on blockchain. After having absorbed crypto assets from users\u2014including both retail and institutional investors, yield farming protocols algorithmically deploy those funds into one or more revenue generating services such as lending and market making. Yield farming protocols have become immensely popular as they seem to create a win-winwin situation: users can earn return on their idle funds through an automated process; yield farming protocols can charge a management fee; other DeFi services can gain more liquidity.\nThe concept of yield farming was first popularized in mid 2020 by the leading PLF Compound with the introduction of its governance token COMP [92]. Compound participants get rewarded with newly-minted COMP tokens through both lending and borrowing activities, which lead to offsetting some loan costs for borrowers and increasing the return for lenders. This incentive scheme was quickly adopted by other protocols such as Uniswap [121] and Yearn Finance [70]) to attract liquidity and participation. As such, on top of the inherently designed benefit that users get for providing liquidity in different kinds of pools (e.g. interest in the case of lending protocols, or fees in the case of providing\nJiahua Xu is with the Computer Science Department, University College London, UK. Email: jiahua.xu@ucl.ac.uk.\nYebo Feng is the corresponding author. He is with the Computer and Information Science Department, University of Oregon, USA. Email: yebof@uoregon.edu.\nliquidity in automated market maker (AMM) pools), additional governance tokens are rewarded to users to further encourage their participation in the issuing platform during the early stage of adoption. The basic yield farming idea was born: the search for opportunities in the DeFi ecosystem to generate returns on otherwise dormant crypto assets.\nAs a reaction to the creation of a multitude of platforms returning interests, fees and token rewards, yield aggregators\u2014 represented by Yearn Finance, Beefy, and Badger DAO (Table I)\u2014dedicated to farming yield through DeFi primitives emerged. At the beginning 2021, the total value locked (TVL) of DeFi yield aggregators was still shy of 1 billion USD; by May 2021, however, this value grew exponentially to 8 billion USD (illustrated in Figure 1).\nIn this paper, we present a systemic examination of yield farming protocols. We first inspect yield farming protocols from the perspective of DeFi architecture and posit them as an aggregation-level component that interact with lowerlevel primitives in DeFi (see \u00a7II). We then synthesize an action-state framework of yield farming operations, and extract yield farming protocols\u2019 features such as pool structure and accepted token types as well as their variations (see \u00a7III). With our established model framework, we characterize top yield farming protocols such as Yearn Finance, Harvest Finance and Pickle Finance. We argue that yield farming protocols are still associated with both security and economic risks (see \u00a7IV) and provide a through literature review for interested readers (see \u00a7V). In Appendix, we present simulations on three typical yield farming strategies in \u00a7A, and describe the workings of top yield aggregators comparatively in \u00a7B. Of a particular note here is that this paper is an updated and extended version of work published in [69].\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n2 2020 May Sep 2021 May Sep 2022 May Sep Date 2022 $0.00 $1.00B $2.00B $3.00B $4.00B $5.00B $6.00B $7.00B $8.00B TV L Ethereum BNB Chain Polygon\nFigure 1: Total value locked (TVL) (b USD) of yield aggregators on Ethereum, BNB Chain and Polygon. Data collected on 12 September 2022 from https://defillama.com/."
        },
        {
            "heading": "II. BACKGROUND IN DEFI",
            "text": "Yield farming protocols are a constituent part of the wider DeFi ecosystem, and operate heavily dependent on other ecosystem components. In this section, we present those related components to understand where yield farming protocols reside within the DeFi ecosystem (illustrated in Figure 2)."
        },
        {
            "heading": "A. DeFi overview",
            "text": "Built on top of decentralized blockchain networks, DeFi [128] systems allow various financial products and services, including lending and asset trading, to be available to the general public. Compared with traditional financial systems, DeFi democratizes finance by replacing legacy, centralized institutions with algorithm-backed protocols, thereby improving the accessibility, inclusion, and transparency of financial services [120], [99]."
        },
        {
            "heading": "B. Chain layer",
            "text": "The distributed ledger technology (DLT) layer forms the infrastructural basis for decentralized applications (dApps). Like all other dApps, DeFi protocols consist of one or more smart contracts deployed on blockchain. To this end, the DeFi chain layer typically requires compatibility with smart contracts. As the oldest and the most widely adopted DLT that supports smart contracts, the Ethereum blockchain is also home to the majority of DeFi protocols [74]. The blockchain implements Ethereum Virtual Machine (EVM) to ensure that state transitions follow the same rules regardless of node they are performed on. The energy consumption and scalability issues associated with blockchains (e.g., EthereumPoW) that are based on the legacy proof of work (PoW) [104] prompted the emergence of the new Ethereum 2.0 and other EVMcompatible chain layer solutions such as Polygon [106], BNB Chain [65], Fantom [78], and Avalanche [60]. Those solutions incorporate alternative consensus mechanisms like proof of stake (PoS) and exhibit an improved throughput capacity [101]. PoS chains in particular not only provides the architectural foundation for the DeFi ecosystem, but can also be a source of yield: to encourage users\u2019 participation\nin the consensus of the distributed network, many of these PoS chains\u2014including Ethereum 2.0 [77], Solana [116] and Polkadot [105]\u2014reward users\u2019 staking activities."
        },
        {
            "heading": "C. DeFi primitive layer",
            "text": "Serving as the fundamental building blocks of the application layer of the DeFi ecosystem, DeFi primitives include AMM-based DEXs, PLFs and stablecoins. DeFi yield mainly comes from AMM-based DEXs and PLFs.\n1) AMM-based DEXs: Different from order book-based exchanges where a trade has both buy and sell sides, AMM-based exchanges\u2014often simply referred to as AMM\u2014leverage an algorithm termed \u201cconservation function\u201d to determine the swap rate between two assets given the swap tokens and size [130]. As illustrated in Figure 3a, traders using an AMMbased DEX swap their tokens against the exchange protocol\u2019s liquidity pool, which contains tokens deposited by liquidity providers (LPs). Against their funds contributed, LPs receive \u201cLP tokens\u201d as a form of \u201cI owe you\u201d (IOU), which allow liquidity withdrawal and entitle LPs for their share of swap fee income. At the time of writing this paper, most prominent AMM-based DEXs include Uniswap [122], Curve [71] and Balancer [61].\n2) PLFs: A PLF (illustrated in Figure 3b) typically applies a pre-coded interest rate model that dynamically adjusts the borrow and supply rates [100]. Both rates are commonly programmed to positively correlate with the utilization ratio of the funds, defined as the total amount borrowed as a fraction of the total amount supplied for each specific token asset. PLFs on blockchain are mostly collateral-based rather than credit based. This means that a borrow position can only be created when a sufficient amount of deposit is in place acting as collateral. The collateral might become liquidated if market movements or interest accrual cause the borrow position to become insufficiently collateralized. From the accounting perspective, interest accrual is achieved through \u201cinterest-bearing tokens\u201d which, while sitting in their holder\u2019s wallet, increase in value with the passage of time. Analogous to AMM\u2019s LP tokens, interest-bearing tokens also serve as a from of IOU, which are emitted to lenders according to funds supplied and must be surrendered upon funds withdrawal. Aave [55] and Compound [67] can be counted as the two most popular PLFs at the time of writing this paper.\n3) Stablecoins: Stablecoins are token contracts deployed on blockchain representing cryptocurrencies that offer price stability relative to a certain reference asset [98], namely, a \u201cpeg\u201d. The peg can be another cryptocurrency, legal tender, commodities, or a combination of the above. At the time of writing this paper, the biggest stablecoins, USDT, USDC and DAI are all pegged to the US Dollar. Stablecoins can be custodial or non-custodial, asset-backed or algorithmically programmed."
        },
        {
            "heading": "D. Aggregation layer",
            "text": "DeFi protocols on the aggregation layer interact with the chain layer or the DeFi primitive layer on end users\u2019 behalf [115]. Depending on whether their target users are requesting\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n3 Curve\nBalancer\nUniswap\nAnchor\nCompound\nAave\nUSDT\nUSDC\nDAI\nBeefy BadgerDAO\nAggregation Layer\nDeFi Primitive Layer\nDemand-side aggregator Supply-side aggregator\nParaswap 1inch Lido AnkrYearnFinance\nStaking platformYield aggregator\nA PP\nLI C\nAT IO\nN L\nAY ER\nDEX aggregator\nDEX StablecoinPLF\nEthereum Polygon BNB Chain Fantom Solana Avalanche Polkadot\nCHAIN LAYER\nFigure 2: Architecture of the DeFi ecosystem on blockchain.\nor providing services, aggregation layer protocols can be classified as demand-side aggregators and supply-side aggregators. The latter is the category the yield farming protocols belong to.\n1) Demand-side aggregators: Channeling similar services offered by DeFi primitives, demand-side aggregators seek to present users with the most competitive offer so that they do not have to manually perform the comparison themselves. DEX aggregators Paraswap [37] and 1inch [1] algorithmically search for the optimal swap route through multiple primitive DEXs to generate the best exchange rate for users.\n2) Supply-side aggregators: All supply-side aggregators to a certain extent perform some form of yield farming. Some protocols farm yields directly from the chain layer. For instance, staking platforms like Lido [93] and Ankr [57] act as a one-stop shop for users to benefit from staking rewards from various PoS chains; yield aggregators like Yearn Finance [134], Beefy [12] and Badger DAO [10] collect users\u2019 funds, redeposit them to DeFi primitives such as DEXs and PLFs or other aggregators to generate returns that will be re-distributed back to the users (presented in Figure 3c)."
        },
        {
            "heading": "III. YIELD FARMING PRELIMINARIES",
            "text": "In this section, we dive deep into the workings of yield farming protocols, understand how they generate yield for the users as well as revenue for the protocols themselves."
        },
        {
            "heading": "A. Types of yield farming protocols",
            "text": "There is no universal definition for yield farming protocols. Some equate yield farming protocols to generic yieldgenerating protocols, in which sense, DeFi primitives such as AMMs and PLFs would also be counted as they offer yield to LPs and lenders, respectively. More commonly, however, yield farming protocols refer to protocols on the aggregation layer (see \u00a7II-D) that pool funds to generate return by interacting with DeFi primitives. This is the type of yield farming protocols that we focus on in this paper.\nUser actions Protocol state\nDeposit (Provide liquidity)\nRedeem (Withdraw liquidity)\nSwap\nReserves\nToken1 Token2 Token3\n...\nLP token\nProtocol actions\nMint\nBurn\n+\n+\n-\n-\n+ -\n(a) Automated market maker (AMM).\nProtocol actions\n-\nUser actions Protocol state\nDeposit\nRedeem\nLiquidate\nRepay\nBorrow\nTotal supply\nTotal borrow\nUtilization ratio\nInterest rate\n++\n+\n-\n-\nMint\nBurn\n+\n-\nInterest-bearing token +\n-\n(b) Protocol for loanable funds (PLF).\nExternal yield-generating protocols\nProtocol stateProtocol actionsUser actions\nDeposit\nRedeem\nPool token\nMint\nBurn\n+\n-\nInvest\nWithdraw\nSwap\nBorrow\nRepay PLF\nPool wealth\nPool token value\nOracleAMM\n+\n-\nPrice feed\n+\n-\nRebase\n-+\n(c) Yield aggregator.\nFigure 3: State diagram with describing the interaction between the environment of a DeFi protocol and associated actions. + means positive effect, \u2212 negative effect.\nBesides yield aggregators which are the most widely recognized type of yield farming protocols, some other protocols are more implicit in their farming activities by branding themselves as e.g. stablecoin or lottery protocols. Those protocols mainly differ in the form of IOU tokens they mint to end users upon new deposit.\n1) Yield aggregators: Represented by Yearn, Beefy and Badger, the most classic and commonly known yield farming protocols are yield aggregators. In return for deposit into a yield farming pool, pool tokens that represent a fraction of the pool wealth are issued. Typically, the value of a pool token varies according to the total pool wealth (see \u00a7III-B2h).\n2) Yield-bearing stablecoins: A yield-bearing stablecoin protocol works similar to a savings account with a bank. Instead of minting pool tokens, the protocol issues stablecoins to\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n4 users as a form of certificate of deposit. The yield-generating nature of the protocol is reflected in the increase in the quantity of the stablecoins to their holders, as opposed to the value of the stablecoin token; the value is designed to remain stable to the peg. OUSD issuer Origin Dollar and USDi issuer Bank of Chain [62] are two examples of this type of protocols.\n3) Lottery protocols: A lottery protocol collect users\u2019 funds and issue them each a lottery ticket token in return. The protocol then performs yield farming under the hood. Instead of distributing yield proportionate to users\u2019 deposit, the protocol every once in a while randomly selects one or more winners who can pocket the yield of all participants. PoolTogether [107] is one of the most popular protocols of this type while writing this paper.\n4) NFT farming: Recently, with the popularity of nonfungible tokens (NFTs), groups began to explore involving NFTs in yield farming. The main goal of NFT farming is to create liquidity and utility for NFTs, especially in gaming space, thereby earning yields for token owners [64]. Axie Infinity [52], ZooKeeper [136], Pulsar Farm [54], and MOBOX [53] are typical platforms that provide NFT farming services."
        },
        {
            "heading": "B. Yield farming operations",
            "text": "As illustrated in Figure 3c, the entire yield farming process comprises actions from both the user and the protocol sides. We discuss common action types associated with yield farming protocols. The exact name and implementation of actions may deviate from one protocol to another.\n1) User actions: The actions that yield farming users, a.k.a \u201cfarmers\u201d, need to take are often trivial and straightforward.\na) Deposit: Protocol users simply select their favored yield farming pool and deposit their funds by transferring token assets to the pool smart contract. In return, users receive pool tokens as a form of IOU which should increase in value with the passage of time due to the yield farmed by the protocol [130], [100].\nb) Redeem: Unless there is a timelock, users can redeem their deposited funds plus any yield generated anytime by surrendering their pool tokens.\n2) Protocol actions: The more sophisticated operations are assumed by the algorithm of the protocol where the actual yield farming is performed automatically under the hood.\na) Mint: The protocol mints pool tokens to the user proportionate to the amount of funds deposited, representing their share of the liquidity within the yield farming pool.\nb) Burn: When a user requests to withdraw funds from a yield farming protocol, pool tokens need to be surrendered by the user and consequently burned by the protocol.\nc) Invest: Depending on the DeFi primitive that the yield farming pool interacts with, the yield farming protocol can invest funds collected from users either into an AMM as a liquidity provider to collect swap fees (see \u00a7A2c), or into a PLF as a lender to earn supply interests (see \u00a7A2a). A yield farming pool may also invest in another yield farming protocol, often for the benefit of receiving reward tokens.\nd) Withdraw: When end users request to redeem their funds from a yield farming pool, the pool contract needs to withdraw the corresponding amount of liquidity from the protocol(s) that it has invested in.\ne) Swap: \u201cRaw yield\u201d does not always come in the form of the originally deposited assets. Therefore, the yield farming protocol may perform a swap, usually on an AMM, to convert yield tokens into the same tokens as originally deposited, which are sometimes reinvested to achieve the compounding effect.\nf) Borrow: Yield farming protocols may use all or part of the funds deposited by users as collateral to borrow from a PLF. This may need to be performed due to various reasons: (i) to arbitrarily inflate the borrow position to be qualified for more participation reward (see \u00a7A2b), (ii) to borrow out assets that can be invested to generate higher yield than the deposited assets.\ng) Repay: Yield farming protocols that take the \u201cborrow\u201d action may need to partially or fully repay their loans to reduce or close its borrow position if: (i) the borrow position is on the verge of becoming liquidated, (ii) the collateral must be withdrawn so that it can be invested elsewhere or returned to end users.\nh) Rebase: A yield farming pool mints or burns pool tokens depends on the quantity of the asset deposited or withdrawn as well as the exchange rate between the pool token and the asset. As yield farming progresses, the farming pool usually accumulates wealth and the exchange rate changes. Due to diversified investment in various protocols, some yield farming pools may possess an array of assets different from the one deposited by end users. Yield farming protocols connect to price oracles to fetch the price of each of these assets, and subsequently calculate the total value held by the pool. The exchange rate can thus be updated through dividing the latest pool value denominated by the asset deposited by end users with the circulating quantity of the pool tokens. This process of updating the pool token price is termed \u201crebase\u201d."
        },
        {
            "heading": "C. Forms of yield farming pools",
            "text": "Different yield farming protocols vary in terms of their pool structure and token types acceptable by each pool (Table II).\n1) Pool structure: A yield farming pool may accept deposits in single or multiple assets.\na) Single asset: Most yield farming protocols have single-asset pools. While those pools only accept one particular token asset, they may still hold various assets due to different sorts of yield farmed. Typically, those other assets are automatically swapped for the one acceptable as deposits, and reinvested to generate compounded yield (see \u00a7III-B2).\nb) Multiple assets: A yield farming pool may also accept multiple token assets. Usually assets acceptable by the same pool share a peg. For example, at the time of writing this paper, Badger DAO\u2019s ibBTC/crvsBTC pool accept ibBTC, renBTC, WBTC and ibbtc/sbtcCRV-f, all pegged to BTC.\n2) Accepted token types: Yield farming protocols accept various types of tokens, ranging from stablecoins to LP tokens.\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n5\na) Stablecoins: In the recent low-interest environment in the traditional finance (TradFi) space, yield farming solutions that boast to offer a high single-digit to a double-digit annual percentage yield (APY) for USD-pegged stalecoins have been of particular interest. Most yield farming protocols offer stablecoin farming; in fact, among the top 20 yield aggregators, only Badger DAO has no stablecoin pool thus far.\nb) LP tokens: Many yield farming pools also accept LP tokens. As discussed in \u00a7II-C1, LP tokens themselves already entitle their tokenholders to swap fee income. Nevertheless, having LP tokens managed by a yield farming pool provides the additional benefit of automatically converting and reinvesting participation reward (see \u00a7III-D3) distributed by the respective AMMs.\nc) Others: Other asset types may also be eligible for yield farming. For example, Yearn Finance accepts ETH, the native currency on the Ethereum blockchain, as well as UNI and YFI, which are protocol governance tokens of Uniswap and Yearn Finance itself, respectively."
        },
        {
            "heading": "D. Sources of yield",
            "text": "1) Supply interest: The most straightforward type of yield originates from lending. As the demand for loans in crypto assets grows, the borrowing interest rate increases, leading to higher yields for lenders. Particularly in a bullish market, speculators are keen to borrow funds despite a high interest rate, in expectation of an appreciation in the assets of their leveraged long position. A borrower wishing to increase their exposure to ETH, for example, may use ETH as collateral to borrow USDC, then repetitively exchanging USDC for ETH to deposit it as collateral to borrow more USDC, forming a \u201cleveraging spiral\u201d [131]. Compound [67] and Aave [55], two major DeFi lending protocols while writing this paper (see \u00a7II-C2), have witnessed the borrow APY of USDC rising from 2-3% in May 2020 to as high as 10% in April 2021.1 This specific kind of yield is incorporated in interest-bearing tokens, such as cTokens from Compound or aTokens from Aave.\n1https://app.defiscore.io/assets/usdc\n2) Swap fee income: Some tokens entitle users to part of the revenue that is going through the protocol. These can be governance tokens or other kinds of tokens. One example is the liquidity provider tokens in AMM-based DEXs [130]. By supplying liquidity into an AMM pool, users receive the fees that are paid by traders within that pool. The higher the volume in that pool, the more fees that are generated, and the more a liquidity provider profits from this. In Uniswap [122], a 0.3% fee is charged for every trade within a pool and goes fully to LPs.\n3) Participation reward: Another yield source comes from liquidity mining programs, where early participants receive native tokens representing protocol ownership. This incentivizes people to contribute funds into the protocol, and enhances decentralization as the protocol ownership is distributed to users. The native tokens often have a governance functionality attached to them which is deemed valuable, as the token holders have a say in the future strategic direction of the project. Native tokens sometimes also entitle holders to a share of the protocol revenue. Further, the values these tokens possess itself especially in a speculation context can be the benefits of owing a protocol.\nThis brings up a second kind of revenue-sharing token, where users have to actively stake their tokens to receive a share of the revenue. For example, SUSHI holders that stake their SUSHI will get xSUSHI in return, which represents the proportional share of a pool that captures 0.05% of all trades on Sushiswap [117]. Vesper Finance\u2019s governance token, VSP, can also be deposited in a pool, in return for vVSP, a token that represents the user\u2019s proportional share of a pool that captures part of the revenue generated throughout the whole Vesper platform [124]."
        },
        {
            "heading": "E. Revenue model of yield farming protocols",
            "text": "Yield farming protocols often retain a fraction of yield earned as the protocol revenue [132]. In the spirit of Decentralized Autonomous Organization (DAO), the revenue may be redistributed to tokenholders of the protocol governance token\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n6 [133]. In that sense, a stronger buy pressure of a particular governance token of a yield farming protocol usually mirrors a larger (anticipated) TVL of the protocol, as it can translate to higher protocol revenue."
        },
        {
            "heading": "IV. YIELD FARMING RISKS",
            "text": "Compared with asset management in traditional finance (TradFi), yield farming may bring substantial profits in short order but also carry a range of risks."
        },
        {
            "heading": "A. Security risks",
            "text": "We identify four major types of attacks associated with yield farming. Table III presents anecdotal events of these attacks and their potential solutions.\n1) Flash loan attack: Flash loan attacks [110] abuse the mechanism of flash loan protocols in which an attacker borrows a great deal of funds that do not require collateral. The attacker then manipulates the price of an asset in a very short period and quickly resell it to earn profits. Such a procedure can be repeated for multiple time by the attacker, thereby causing considerable losses to investors and yield aggregators.\nMajor yield aggregators have witnessed multiple waves of flash loan attacks, losing millions of dollars each. For example, ApeRocket suffered two flash loan attacks that costed investors 1.26 million USD on July 2021 [18]; in October 2020, a farmer leveraged flash loans to reap 33.8 million USD from the USDT and USDC pools [28]; Pancake Bunny Finance lost around 690,000 BUNNY tokens due to removal of liquidity and price manipulation by flash loan attacks [35].\nTo defend against flash loan attacks, developers must consolidate and improve flash loan protocols, making them difficult to be exploited by attackers. An effective approach is to setup floating interest rates, thereby increasing the cost of launching flash loan attacks [35]. Developers can also choose to enhance the audits [7] or forbid depositing and withdrawing funds within a single transaction [51].\n2) Rug pull: A rug pull refers to the abandonment of a project by the project administrator after collecting investor\u2019s funds, leaving investors with valueless assets [130], [118]. One way of conducting this type of scam is to lure yield farming protocols into buying assets with no value and then swap this asset for ETH or another type of asset with value. For example, Arbix Finance, a typical rug pull, drained around 10 m USD in users\u2019 assets directly from the vaults without any advanced attack techniques in sight [8].\nTo prevent from being rugged, investors should exercise caution and always confirm a project\u2019s credibility before investing in it [129], [95]. Besides, continuously tracking the audit information of invested projects enables investors to quickly identify risks and take appropriate measures, thereby reducing losses [43].\n3) Reentrancy attack: Even though the composability factor of DeFi is what makes yield farming possible in the first place by allowing for complex, interconnected financial protocols, it does bring along the danger of smart contract risk as more and more money legos are plugged into a strategy. While two smart contracts may be secure in isolation, the\ncombination of them may not. By composing multiple smart contracts together, the attack surface might be greater than the sum of its parts [127], [126].\nReentrancy attack is one of the most destructive attacks that appear when multiple smart contracts operate with each other. More specifically, the reentrancy attack occurs when a smart contract makes an external call to another smart contract. Then the another contract makes recursive calls back to the original function, intentionally or unintentionally withdraw funds. When the original contract fails to update its state before sending funds, the attacker can exploit this vulnerability to continuously drain the contract\u2019s funds.\nMajor yield aggregators have witnessed a large amount of reentrancy attacks in the past several years. In April 2021, the ForceDAO DeFi aggregator was exploited by a group of attackers, who utilized reentrancy attacks to steal 367 thousands USD worth of tokens before the ForceDAO team took effective actions to prevent further attacks [19]; in September 2021, DAO Maker, a decentralized finance platform on Ethereum, was hacked for almost 4 million USD due to insecure smart contracts [16]; a reentrancy attack on the Grim Finance project within the Fantom Blockchain also successfully drained over 30 million USD worth of tokens in 2021 [5].\nTo defend protocols against reentrancy attacks, researchers and developers have proposed a variety of frameworks and methods [86]. For example, Rodler et al. [112] propose a backward compatible approach based on run-time monitoring and validation to protect smart contracts on Ethereum; Das et al. [73] propose a reentrancy-aware language called Nomos, which enforces reentrancy security using resourceaware session types; Cecchetti et al. [66] first formalize the reentrancy interface on general distributed systems and then leverage information flow control to automatically fix defective smart contracts. However, with the increasing complexity and variety of DeFi protocols, reentrancy attacks will also become increasingly difficult to detect and counter. From users\u2019 side, protection can be sought from DeFi-native insurance protocols such as Nexus Mutual that cover smart contract risks [68].\n4) Key exploit: Due to poor access control of some DeFi systems, yield aggregators can be attacked by exploiting various keys (e.g., API key, wallet key) to tamper with the smart contracts or drain funds. For example, the Bent Finance utilized non-multisig wallets to deploy their project\u2019s smart contracts. Anyone who knows the appropriate private key can perform updates to the contracts, allowing attackers to inject malicious code and create the backdoor. In December 2021, an attacker leveraged this feature to drain 1.75 million USD worth of tokens from the pool [13], [14], [20].\nTo avoid attacks based on key exploiting, DeFi contracts should always be deployed upon multisig wallets to eliminate single points of failure [20]. DeFi platforms should also properly protect the private keys used to access and control correlative smart contracts. The developments of DeFi system API, application, and user interface should follow software security practices, ensuring that the access control and function calls are solidly implemented.\n5) Other attacks: As yield farming protocols are built upon multiple complex systems with a variety of software\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n7\nand hardware components interacting with each other, both technical and economic weaknesses give rise to attractive exploit opportunities for malicious hackers. Besides the aforementioned attacks, there are many other attacks targeting the blockchain infrastructure, user interface, or even network communications, thereby disturbing the proper operation of yield farming protocols. For example, malicious miners can prioritize transactions in their favor by inspecting miner extractable values (MEVs), thereby causing damages to the smart contracts running on the upper layers [109], [135]; attackers can break the network connections between the users and the blockchain system through border gateway protocol (BGP) hijacking [58]; malicious traders can leverage front-running attacks to drain funds from pools [76].\nThese attacks are out of scope for this paper, but it is important for users and developers to be aware of that yield farming security is a systemic problem. Only by ensuring the security of every component in the system can the security of yield seeker\u2019s funds be ensured."
        },
        {
            "heading": "B. Economic risks",
            "text": "Besides security concerns, there exist various economic risks associated with yield farming. In \u00a7A2, we demonstrate that investment strategies with the potential to generate remarkably high yield also bear high risks. While our simulation only illustrate return courses in a deterministic fashion, through various simulated scenarios one can easily extrapolate that the ever-changing market conditions\u2014including volatile price movements and trading activities\u2014lead to return insta-\nbility, and sometimes even losses. Below, we discuss several types of economic risks associated with yield farming.\n1) Yield dilution risk: Yield farming pools providing double or even triple digit APY can be deceiving in their return generating capability. Often enough, those pools are thin in liquidity and lack scalability, unable to accommodate a large amount of deposit while sustaining a similar level of APY. Users who invest a significant amount of funds into such a pool may find the pool APY dropping significantly immediately afterwards. For users with funds already in the pool, they may experience a decrease in return on their investment due to dilution from newly added funds. For those who do not constantly monitor their investment performance, this may mean leaving their funds in a diluted, low-APY pool, while missing the opportunity of reallocating their funds to more profitable strategies.\n2) Conversion risk: As discussed in \u00a7III-C, yield farming pools typically specify tokens that they can accept. Therefore, to participate in yield farming, users may have to first convert partially or all of their funds into acceptable assets for yield farming. This engenders conversion risk: a user might have been better off holding their original funds, than converting them to \u201celigible\u201d assets. This is because the \u201celigible\u201d assets might depreciate against the original assets prior to the conversion to such an extent that even the yield generated cannot make up for the depreciation loss. This risk is most prominent with liquidity provision strategies, manifested by the so-called \u201cimpermenent loss\u201d (see [130]). By design, the value LP tokens (e.g. USDT-ETH-LP token) from an AMM-based DEX falls against the original portfolio (e.g. a combination of USDT\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n8 and ETH). Sometimes, even the swap fee income and the participation reward are insufficient to cover the conversion loss.\n3) Exchange risk: Related to conversion risk, exchange risk is associated with the uncertainty surrounding the exchange rate between the assets held by the yield farming pool and the denominating currency (usually USD). As demonstrated in \u00a7A2, yield farming strategies benefit from\u2014and, in cases such as leveraged borrow, solely rely on\u2014the high value of participation reward. This makes yield farming highly speculative as token prices are unpredictable. An overly low price of yielded tokens such as reward tokens might result in a loss for end users.\n4) Counterparty risk: This risk is associated with farming strategies that incorporate lending, where loans might not be repaid. While the simple lending strategy (see \u00a7A2a) is a relatively low-risk one, losses may still occur under extreme market conditions, e.g. when the price of the asset lent out relative to the collateral suddenly increases to such a significant extent that the loan becomes undercollateralized (see lending protocol MakerDAO\u2019s Black Thursday Incident [91], [100]). In such cases, borrowers may choose not to repay their loans since their collateral is not worth the effort anymore, resulting in a default. Kao et al. [90] simulate a wide range of market volatility to stress-test lending protocols such as Compound, and find that only rarely can undercollateralization occur.\n5) Liquidation risk: Liquidation risk is associated with farming strategies such as leveraged borrow (see \u00a7A2b) that incorporate taking a overcollateralized loan on a PLF. Due to price movements and interest accrual, a loan position may become insufficiently collateralized, triggering liquidation of the deposited assets backing the loan. At liquidation, the value of the collateral liquidated by design exceeds the loan payable reduced, resulting a loss on the side of the borrower. Thus, yield farming protocols that implement borrow but unable to handle liquidation risk properly may cause users to lose their funds."
        },
        {
            "heading": "V. RELATED WORK",
            "text": "In this section, we introduce literature that is related to yield farming in some shape and form. As it is still a fairly new area, there is a paucity of existing works related to our paper. Table IV summarizes the most related and representative ones.\nIn general, our paper is different from existing papers in the following aspects:\n\u2022 our paper focuses on the subject of yield farming, while other papers either investigate a more specific DeFi topic (e.g., yield generating mechanism [125], yield chasing [114]), examine a different but related DeFi applications (e.g., AMM-based DEXs [130], lending [63]), or have a broader coverage (e.g., DeFi transformation [108]); \u2022 to investigate yield farming comprehensively, our paper utilizes multiple methodologies, including literature survey, modeling, empirical analysis, and taxonomization. In contrast, other papers use only one or a few of these methodologies to study their subjects;\n\u2022 our paper examines a series of aspects of yield farming, including related DeFi protocols, yield generation, yield farming strategies, financial risks, and security issues, while most of the related papers only cover some of these topics.\nWe discuss related literature in more details from different perspectives in the following subsections."
        },
        {
            "heading": "A. Yield farming",
            "text": "A few papers focus on studying and comparing yield farming strategies or yield aggregators [59]. For instance, Nathan Walton [125] provides a break down of yield generating mechanism, covering four different farming strategies and a few other related topics (e.g., benefits and risks); Kanis Saengchote [114] studies DeFi composability, which covers yield-chasing behaviors and some introductions about major yield aggregators; another case study about Compound [113] also comes with explanations about yield aggregators and yield farming incentives; Popescu et al. [108] discuss the transition from the traditional finance to DeFi and include some descriptions about yield farming.\nHowever, none of these works have comprehensively investigated yield farming from the perspective of literature survey, modeling, empirical analysis, and taxonomization like our paper."
        },
        {
            "heading": "B. DeFi platforms",
            "text": "As a type of DeFi application, yield farming is built upon DeFi platforms. Combing the design of general DeFi platforms lays the groundwork for yield farming designs. Moin et al. [98] and Pernice et al. [102] systematically study the general designs of DeFi platforms by decomposing the structure into diverse elements (i.e., peg assets, collateral amount, price and governance mechanism). They also investigate the merits and demerits of DeFi platforms to spot future directions. Nonetheless, yield farming is not the main focus of these works."
        },
        {
            "heading": "C. Related DeFi protocols",
            "text": "There are various papers studying the DeFi protocols (e.g., flash loan, lending, trading) that can be leveraged by yield farming. For example, as fundamental protocols of yield farming, the mechanisms, properties, and risks of DeFi lending protocols are extensively investigated in several publications [63], [100], [119], [90]; some papers [81], [100] provide analysis and discussions about protocols for Loanable Funds, introducing the interest rate determination and liquidity issues; Han et al. [82] zoom into the launch event of the yield farming protocols for Uniswap liquidity provision and further establish the causal impact of this on Binance investor trading activities; within the scope of the analysis of financial attack vectors that involve a flash loan, Qin et al. [110] study the existing flash loan-based attacks and propose optimizations that significantly improve the ROI of these attacks; Gudgeon et al. [80] explore how design weaknesses in DeFi protocols can trigger a decentralized financial crisis.\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n9\nAlthough these papers can cover almost all the DeFi protocols used by yield farming, our paper presents this topic more systematically by putting together all the relevant protocols, components, and problems worth exploring."
        },
        {
            "heading": "VI. CONCLUSION",
            "text": "In this survey paper, we examine yield farming protocols from multiple perspectives. We first highlight yield farming\u2019s dependence on lower-level DeFi primitives in the context of the broader DeFi ecosystem and propose a general framework for yield farming protocols. We then explain code-level actions and associated yield farming operations. We decompose various aspects of yield farming protocols such as protocol form, pool structure, accepted token types, and enumerate their variations. Later, we stylize three frequently used strategies and simulate yield farming performance under a set of assumptions. We also compare four major yield aggregators by summarizing their strategies and revenue models. Finally, we discuss security and economic risks of yield farming protocols, together with related work.\nWhile yield farming has been exploding since 2020, an important question remains if current yields will be sustainable in the long term. Higher rewards also imply higher risks, and associated DeFi attacks prove that the safest and most robust\nyield provider will win the race. Besides security enhancement, new industry developments should consider building one-stop-shop solutions, in pursuit of aggregating more than just yield and facilitating the on-boarding of new DeFi users."
        },
        {
            "heading": "ACKNOWLEDGEMENT",
            "text": "We would like to extend our sincere thanks to Simon Cousaert and Toshiko Matsui for the base of this paper [69]. We also would like to thank Yitian Wang and Honglin Fu for their research assistance.\nThis material is based upon work partially supported by Ripple under the University Blockchain Research Initiative (UBRI) [79]. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of Ripple.\nACRONYMS\nIOU \u201cI owe you\u201d AMM automated market maker APY annual percentage yield DAO Decentralized Autonomous Organization dApp decentralized application DeFi decentralized finance\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n10\nDEX decentralized exchange DLT distributed ledger technology EVM Ethereum Virtual Machine LP liquidity provider MEV miner extractable value NFT non-fungible token PLF protocol for loanable funds PoS proof of stake PoW proof of work TradFi traditional finance TVL total value locked"
        },
        {
            "heading": "A. Simulating yield Farming Strategies",
            "text": "A yield farming strategy is made of a specific set of actions (see \u00a7III-B2) through modular smart contracts that automates the yield farming process. In this section, we describe three common yield farming strategies: simple lending, leveraged borrow, and liquidity provision. Besides, to intuitively and roughly compare the performance differences of these yield farming strategies, we simulate each strategy in a controlled, parameterized, simplified environment by tracking the trajectory of the total value W of the yield aggregator2.\n1) Assumptions: On comparing the three common strategies, for simple demonstration purposes without loss of generality, we make the following assumptions:\n1. the transaction cost is neglected; 2. the value of the yield farming pool Wt is measured in\nUSDT; at t = 0, the pool contains 1 USDT\u2019s worth of funds, i.e., W0 = 1; 3. the pool initially supplies all its funds to a yieldgenerating protocol\u2014either a PLF or an AMM, and the funds represent 1% of the protocol\u2019s total assets held at t = 0; 4. the yield-generating protocol\u2014either a PLF or an AMM\u2014distributes 0.01 governance token per day to its users proportionately to their stake in the protocol: a. for a PLF, half of the governance tokens are distributed\nto lenders proportionate to their deposits, and half to borrowers proportionate to their loans, b. for an AMM, the governance tokens are distributed proportionately to LPs;\n5. the governance token price remains constant during the simulation period; 6. the lending platform has an non-linear interest rate model [81] as illustrated in Figure 4; 7. the AMM has a fixed exchange fee of 5% and applies a Uniswap-like constant-product conservation function;3\nthe fee is charged by retaining 5% of the theoretical feefree purchase quantity within the AMM pool.\n2The code repository can be found from this URL: https://github.com/xujiahuayz/yieldAggregators.\n3We refer the reader to [56] for detailed description and analyses on AMMs with constant-product conservation function.\n2) Simulation results: a) Simple lending: The yield farming pool grows its wealth through accrual of supply interest and reward tokens distributed by the PLF.\nSimulated strategy execution. In our simulated environment, at t = 0 the yield aggregator deposits 1 USDT to a PLF, and receives in return some interest-USDT as a certificate of deposit (see \u00a7II-C2). According to Assumption 3., the aggregator owns 1% of the total circulating supply of interest-USDT.\nThe interest-USDT holding of the aggregator is worth exactly 1 USDT at t = 0, and increases in value due to interest accrued with the passage of time. In addition, the farming pool is rewarded with the PLF\u2019s governance tokens owing to its supply contribution, and the value of the governance token holding is counted towards the total value of the yield farming pool.\nSimulated scenarios. At each given rewarded protocol token price, we simulate three scenarios: the initial utilization ratio of the funds in the lending pool equals 0, 0.4, 0.8, respectively. As illustrated in Figure 4, a higher utilization ratio indicates a higher supply interest rate.\nResults. Figure 5a shows that, the value held by the aggregator Wt is floored at 1 USDT, with the worst-case scenario when the supply interest equals 0 due to the absence of borrow demand and the reward token has 0 value. Intuitively, Wt increases with higher utilization and reward token price.\nb) Leveraged borrow: According to Assumption 4.a and in line with practices of major lending platforms such as Compound [67], governance tokens are rewarded to both lenders and borrowers. This strategy thus aims to maximize the amount of governance tokens received by the lending platform through leveraging spirals.\nSimulated strategy execution. In our simulated environment, at t = 0 the yield aggregator first deposits 1 USDT to a lending platform; with this initial deposit as collateral, the aggregator then takes a loan worth 65% of its deposit, i.e. 0.65 USDT. To further augment its deposit and borrow amount for the entitlement of larger rewards, the aggregator re-deposits the borrowed funds, and use them as collateral to borrow again 0.65% of the new deposit; and so on and so forth. Obviously, the more spirals the yield farming pool undertakes, the higher shares it holds at both the lending and the borrowing sides of the lending platform.\nSimulated scenarios. We assume the initial utitization ratio of the PLF\u2019s lending pool is 0.4. At each given reward token price, we simulate three scenarios: (i) depositing without borrowing, (ii) lending and repeat borrowing and re-supplying 3 times, (iii) lending and repeat borrowing and re-supplying 6 times.\nResults. As an asset\u2019s borrow interest rate always exceeds its supply interest rate, the loan accrues interest exponentially faster than its deposit. We observe from Figure 5b that sufficiently\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n14\nvaluable reward tokens can make the strategy profitable, but losses occur when the value of the governance tokens received is insufficient to offset the negative net interest revenue. Overall, a high degree of leverage, measured by the number of spirals, can amplify both the profit\u2014in case of high-value governance tokens, as well as the loss\u2014in case of low-value governance tokens.\nc) Liquidity provision: The yield farming pool supplies funds to an AMM in order to profit from both trading fees and governance tokens rewarded by the AMM.\nSimulated strategy execution. In our simulated environment, at t = 0 the aggregator deposits 1 USDT\u2019s worth of funds in the USDT-ETH pool of an AMM, and receives in return some USDT-ETH-LP tokens, representing its share in the AMM pool. According to Assumption 3., the aggregator owns 1% of the total circulating supply of USDT-ETH-LP. Given that USDT is the denominating asset (Assumption 2.), and that the USDT-ETH pool applies a constant-product conservation function (Assumption 7.), the USDT-ETH pool always contains USDT and ETH with equivalent value, and the total pool value thus equals twice the USDT quantity in the pool.4\nWe additionally assume that, on an aggregate level, further liquidity provision and withdrawal cancel each other out. Hence, the aggregator\u2019s ownership of the AMM pool is neither diluted nor concentrated; that is, the value of the aggregator\u2019s USDT-ETH-LP holding remains 1% of the USDT-ETH pool\u2019s value. Naturally, all other things equal, the value held by the aggregator increases with the value of the AMM governance token.\nSimulated scenarios. We test scenarios with different market movements. Specifically, we illustrate in 5c when during the entire simulation period (i) there is 0 trading volume (blue line), (ii) the buy and sell volume of ETH is respectively 45 USDT and 55 USDT (orange line), (iii) the buy and sell volume of ETH is each 50 USDT (green line), (iv) the buy and sell volume of ETH is respectively 55 USDT and 45 USDT (orange line). We assume that the trading volume is evenly spread out throughout the simulation period.\nAbsent any trading activity\u2014as in Scenario (i), the aggregator\u2019s yield solely comes from governance token reward. The yield difference between Scenarios (i) and (iii) lies in the trading fee. By comparing the blue line and the green line in Figure 5c, we clearly see that (iii) results in higher yield with the presence of 5% trading fee.\nScenario (ii) describes a market situation with higher selling pressure and consequently falling ETH prices. The leads to an increase in the quantity of the depreciated ETH and a decrease in the quantity of the denominating asset USDT in the AMM pool, diminishing the AMM pool\u2019s value. When the trading fee revenue and governance token reward are insufficient to offset this value loss, the yield would be negative.\nIn contrast to Scenario (ii), Scenario (iv) describes an opposite market situation where a higher demand in ETH drives up its price. The leads to a decrease in the quantity of the appreciated ETH and an increase in the quantity of the\n4We refer the reader to [130] for a formal derivation on the pool value of a constant-product AMM.\ndenominating asset USDT in the AMM pool, raising the AMM pool\u2019s value.\nNote that in both Scenarios (ii) and (iv), liquidity providers suffer from divergence loss [130], that is, they could have been better off by just holding their USDT and ETH, as opposed to supplying them to the AMM pool.\nResults. The simulation shows that the liquidity provision strategy also entails risk, associated with market movements of the assets within the AMM pool. Higher volatility of the AMM pool assets implies higher uncertainty in yield."
        },
        {
            "heading": "B. Current Major yield aggregators in DeFi",
            "text": "As listed in Table I, to date, yield aggregators have collected billions of dollars worth of liquidity. This section compares current major yield aggregators with a focus on their strategies, performances, and fee mechanisms. Table II lists the characteristics of current top 20 yield aggregators. All the data was collected on 28 August 2022.\n1) Yearn Finance: Yearn Finance offers a multitude of products in DeFi, providing lending aggregation, yield generation and others [97]. The services discussed here are Yearn Earn, a lending aggregator, and Yearn Vaults, a more comprehensive yield aggregator. Yearn Finance launched in July 2020.\na) Strategies: \u2022 Earn pools: The strategy of the Earn pools is to collect\na certain asset and deposit it either in dYdX, Aave or Compound, depending on where the highest interest rate of that asset is found. Yearn will withdraw from one protocol and deposit to another automatically as\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n15\ninterest rates change between protocols, in a strategy that is slightly similar to the Idle Finance \u201cBest-Yield\u201d Strategy. Proportional shares in Earn pools are commonly represented by yTokens. \u2022 Vaults: A Yearn Vault uses an asset as liquidity, deposits that liquidity as collateral (accounting for risk levels) to borrow stablecoins. Then, it uses those stablecoins to generate yield, after which that yield is re-invested in the stablecoins to generate more yield. Vaults thus allow for more complex strategies compared to Earn pools. Proportional shares in Yearn Vaults are commonly represented by yvTokens or other yTokens.\nYield farming strategies in Yearn v2 Vaults can be complex, involving flash loans (uncollateralized loans that are taken and repaid within the same transaction [131]), leveraged borrowing, staking on specific protocols (for example HegicStaking) and more.\nb) Return for users: Yearn Finance distributed the YFI governance token over a 9-day period after launch. Liquidity providers in the Earn pools or Vaults are thus not incentivized by a Yearn liquidity mining program, so current yield only comes from the returns that the product strategies reap. Those returns can be straightforward, as is the case for Earn pools, and can be complex to calculate, as is the case for v2 Vaults that can have up to 20 strategies working at once. Some Yearn vaults accept LP tokens, other accept single asset tokens.\nc) Protocol fees: v1 Vaults have a 20% performance fee and a 0.5% withdrawal fee (in case funds need to be pulled from the strategy in order to cover the withdrawal request). v2 Vaults have also a 20% performance fee, but no withdrawal fee. Instead, they charge a 2% management fee. Performance fees are split 50:50 between the Treasury and the Strategist, the official creator of the strategy. The management fee is assigned fully to the Treasury.\n2) Idle Finance: Launched in August 2019, Idle is a yield aggregator that automatically allocates and aggregates interestbearing tokens [88].\na) Strategies: Idle Finance only distributes single-asset pools over different lending protocols. Users\u2019 funds are pooled together and depending on the strategy that the pool employs, assets are allocated over different lending platforms, currently limited to: Compound, Fulcrum, Aave, DyDx and Maker DSR. In Idle Finance, the currently supported pools can be deposited directly into the above lending platforms. When any user interacts with Idle or if no interactions are made for 1 hour, rebalancing of the assets takes place according to the rates of supported providers.\nCurrently, Idle uses two different allocation strategies: \u2022 Best-Yield: this strategy seeks the best interest rates\nacross multiple lending protocols. \u2022 Risk-Adjusted: this strategy automatically changes the\nasset pool allocation in order to find an allocation with the highest risk-return score, compared to the highest return score of the \u201cBest Yield\u201d strategy. It does this by incorporating a framework for quantifying risk, developed by DeFiScore [75], which outputs a 0-10 score that represents the level of risk on a specific lending platform (0 = highest risk, 10 = lowest risk).\nb) Return for users: Idle uses IdleTokens to represent the farmers\u2019 proportional ownership of the asset pool, which should accrue yield over time. In addition, farmers are rewarded with IDLE governance tokens for participating in the pools as part of Idle\u2019s liquidity mining program. In January 2021, a two-year liquidity mining program started to reward liquidity providers depending on the amount of funds deposited and the utility generated by a certain pool [87].\nc) Protocol fees: A performance fee 10% of the generated yield is charged.\n3) Harvest Finance: Harvest Finance gives FARM holders the opportunity to share in the revenue model of the protocol. By staking FARM, users are entitled to receive part of the revenue that is collected by the protocol. Harvest Finance went live in August 2020, and currently has more than 70 pools/vaults in its offering.\na) Strategies: Harvest Finance has two main categories of yield farming strategies [84]:\n\u2022 Simple single-asset Strategies: Users deposit single assets such as USDC, USDT, DAI, WBTC, renBTC or WETH into a Harvest Vault, which then deposits those assets into another yield generating protocol, including Compound and Idle Finance. \u2022 LP token Strategies: Users deposit LP tokens from Uniswap, Sushiswap or Curve into Harvest which automatically collects liquidity mining rewards and re-invests them into LP tokens. b) Return for users: Depending on the vault used, return of Harvest users is composed of (i) the fees accrued by providing liquidity to AMM pools or other yield-bearing assets, (ii) earning tokens distributed through external liquidity mining programs and (iii) extra FARM tokens as part of the liquidity mining program. These returns are dependent on underlying market forces, liquidity programs and token values. For example, the Harvest emission schedule defines how much FARM will be distributed over time [83].\nc) Protocol fees: Harvest Finance does not charge withdrawal fees and does not claim a direct \u201cfee\u201d on the yield farming revenue. However, during liquidation of the yield, 30% of the profits is used to buy the FARM token on the market, which is then distributed to users who stake FARM in the profit-sharing FARM pool [85].5\n4) Pickle Finance: Launched in September 2020, Pickle offers yield on deposits through two products: Pickle Jars (pJar) and Pickle Farms. Jars are yield farming robots, earning returns on users\u2019 funds, while farms are liquidity mining pools where users can earn PICKLE governance tokens by staking different kinds of assets. Proportional shares in pJars are represented by pTokens.\na) Strategies: Each Pickle Jar employs a specific strategy to earn yield. Currently, two main versions of pJar strategy are in existence, pJar 0.00 and pJar 0.99, of which the 0.99 version is most important. In either version, pooled funds are directly utilized to farm rewards, after which they are sold to re-invest the accrued yield.\n5This type of buyback reduces the supply of governance tokens in the secondary market to the benefit of existing tokenholders.\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply.\n16\n\u2022 pJar 0.00: These pJars involve a user depositing LP tokens acquired by supplying liquidity on Curve Finance [71], an AMM-based DEX. The strategy employed in pJar 0.00 earns and re-invests CRV rewards by selling CRV into the market for stablecoins and re-depositing those into the Curve pools to get more LP tokens. Effectively, pJars 0.00 generate yield by accruing (i) LP fees from Curve and (ii) generating CRV tokens because of Curve\u2019s liquidity mining program [72]. \u2022 pJar 0.99: These pJars utilize LP tokens from Uniswap and Sushiswap, earning yield by accruing (i) LP fees from Uniswap/ Sushiswap and (ii) generating SUSHI or other native tokens because of liquidity mining programs. b) Return for users: Return of Pickle users is generally composed of (i) the fees accrued by providing liquidity to AMM pools, (ii) earning tokens distributed through external liquidity mining programs, and (iii) extra PICKLE tokens if the yield farmer makes use of the Farm products. The return is thus dependent on underlying market forces, liquidity programs and token values. For example, the Pickle emission schedule defines how much PICKLE will be distributed over time [103].\nc) Protocol fees: Most Pickle Jars have a 20% performance fee on the generated yield.\n5) Other aggregators: The four main yield aggregators above are deemed the most mature, but a new wave of yield aggregating protocols is coming up. In general, there seems to be a tendency where more recent yield aggregators aim to be a one-stop-shop, providing additional functionalities such decentralized exchanges, lending and borrowing and risk-managing services. This enhances user experience and introduces more revenue streams for the protocols.\nBelow we list more recently launched protocols and products that are still being tested.\na) Rari Capital: Rari Capital [111] is a roboadvisor that attempts to provide investors with the highest yield, beyond just lending. It has multiple products, including Earn, Tranches, Fuse and Tanks. The Earn product can be considered a traditional yield farming service, while the other products are extending the number of functionalities on the Rari Capital platform, such as lending and borrowing, and yield farming within certain risk boundaries, called \u201ctranches\u201d [94].\nb) Vesper Finance: Vesper [123] focuses on institutional adoption of the DeFi yield market. Currently, only Vesper Grow Pools are available, which are comparable to the traditional yield products. In future developments, Vesper plans to integrate Vesper Labs [123] where external users can build their own strategy in return for part of the reaped profits.\n6) Summary: Many yield farming strategies entail some extent of optimization, e.g. choosing the lending pool that offers the highest APY to deposit assets into (e.g. Idle\u2019s Best-Yield pools, Yearn\u2019s earn pools), or balancing between risks and return (e.g. Idle\u2019s risk-adjusted pools). The core strategies applied by major yield aggregators commonly do not deviate much from the basic strategies described in \u00a7A. However, as the competition in yield farming grows, basic strategies becomes less effective [89], which prompts protocols to device more sophisticated strategies that incorporate various\nforms of interactions with other DeFi protocols (e.g. upgrade from Yearn v1 to v2). Yield aggregators generate revenues by charging fees from investors. Protocols associated with better yield farming performance are able to charge higher fees, which can be observed by comparing both the performance fee between Yearn (20%) and Idle (10%) as well as their respective performance.\n\u00a9 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: University College London. Downloaded on December 12,2022 at 16:58:25 UTC from IEEE Xplore. Restrictions apply."
        }
    ],
    "title": "Reap the Harvest on Blockchain: A Survey of Yield Farming Protocols",
    "year": 2022
}