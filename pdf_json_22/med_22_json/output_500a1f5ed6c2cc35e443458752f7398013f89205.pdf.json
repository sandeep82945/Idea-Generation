{
    "abstractText": "We introduce a novel method to improve the computational efficiency for (S)TEM image simulation by employing matrix diagonalization of the mixed envelope function (MEF). The MEF is derived by taking the finite size and the energy spread of the effective electron source into account, and is a component of the transmission cross-coefficient that accounts for the correlation between partially coherent waves. Since the MEF is a four-dimensional array and its application in image calculations is time-consuming, we reduce the computation time by using its eigenvectors. By incorporating the aperture function into the matrix diagonalization, only a small number of eigenvectors are required to approximate the original matrix with high accuracy. The diagonalization enables for each eigenvector the calculation of the corresponding image by employing the coherent model. The individual images are weighted by the corresponding eigenvalues and then summed up, resulting in the total partially coherent image.",
    "authors": [
        {
            "affiliations": [],
            "name": "Zhongbo Li"
        },
        {
            "affiliations": [],
            "name": "Harald Rose"
        },
        {
            "affiliations": [],
            "name": "Jacob Madsen"
        },
        {
            "affiliations": [],
            "name": "Johannes Biskupek"
        },
        {
            "affiliations": [],
            "name": "Toma Susi"
        },
        {
            "affiliations": [],
            "name": "Ute Kaiser"
        }
    ],
    "id": "SP:5b2694521fb61c8ba159b2c2e364a88606423a6a",
    "references": [
        {
            "authors": [
                "LJ Allen",
                "S Findlay"
            ],
            "title": "Modelling the inelastic scattering of fast",
            "year": 2015
        },
        {
            "authors": [
                "M Born",
                "E Wolf"
            ],
            "title": "Principles of Optics",
            "year": 1970
        },
        {
            "authors": [
                "H Press. Brown",
                "P Pelz",
                "C Ophus",
                "J Ciston"
            ],
            "title": "A python based open",
            "year": 2020
        },
        {
            "authors": [
                "JM 271\u2013280. Cowley",
                "AF Moodie"
            ],
            "title": "The scattering of electrons by atoms",
            "year": 1957
        },
        {
            "authors": [],
            "title": "Advanced Computing in Electron Microscopy",
            "year": 1998
        },
        {
            "authors": [],
            "title": "Computation in electron microscopy",
            "year": 2016
        },
        {
            "authors": [
                "H software_qstem Kohl",
                "H Rose"
            ],
            "title": "Theory of image formation by inelastically",
            "year": 1985
        },
        {
            "authors": [
                "Cambridge",
                "Z US: Elsevier. Lee",
                "R Hambach",
                "U Kaiser",
                "H Rose"
            ],
            "title": "Significance of matrix",
            "year": 2017
        },
        {
            "authors": [
                "Z Lee",
                "T Lehnert",
                "U Kaiser",
                "H Rose"
            ],
            "title": "Comparison of different imaging models handling partial coherence for aberration-corrected HRTEM at 40\u201380",
            "venue": "scattering. Ultramicroscopy",
            "year": 2019
        },
        {
            "authors": [
                "I Lobato",
                "S Van Aert",
                "J Verbeeck"
            ],
            "title": "Progress and new advances in simulating electron microscopy datasets using MULTEM",
            "venue": "Ultramicroscopy",
            "year": 2016
        },
        {
            "authors": [
                "J Madsen",
                "T Susi"
            ],
            "title": "abTEM: Ab initio transmission electron microscopy image simulation",
            "venue": "Microsc Microanal",
            "year": 2020
        },
        {
            "authors": [
                "H M\u00fcller",
                "H Rose",
                "P Schorsch"
            ],
            "title": "A coherence function approach to image simulation",
            "venue": "J Microsc",
            "year": 1998
        },
        {
            "authors": [
                "P Nellist",
                "J Rodenburg"
            ],
            "title": "Beyond the conventional information limit: The relevant coherence function",
            "venue": "Ultramicroscopy",
            "year": 1994
        },
        {
            "authors": [
                "RJ Noll"
            ],
            "title": "Zernike polynomials and atmospheric turbulence",
            "venue": "J Opt Soc Am",
            "year": 1976
        },
        {
            "authors": [
                "JO Oelerich",
                "L Duschek",
                "J Belz",
                "A Beyer",
                "SD Baranovskii",
                "K Volz"
            ],
            "title": "STEMsalabim: A high-performance computing cluster friendly code for scanning transmission electron microscopy image simulations of thin specimens",
            "venue": "Ultramicroscopy 177,",
            "year": 2017
        },
        {
            "authors": [
                "M O\u2019Keefe",
                "P Buseck"
            ],
            "title": "Computation of high resolution TEM images of minerals",
            "venue": "Trans ACA",
            "year": 1979
        },
        {
            "authors": [
                "C Ophus"
            ],
            "title": "A fast image simulation algorithm for scanning transmission electron microscopy",
            "venue": "Adv Struct Chem Imaging",
            "year": 2017
        },
        {
            "authors": [
                "PM Pelz",
                "A Rakowski",
                "LR DaCosta",
                "BH Savitzky",
                "MC Scott",
                "C Ophus"
            ],
            "title": "A fast algorithm for scanning transmission electron microscopy (STEM) imaging and 4D-STEM diffraction simulations",
            "venue": "Microsc Microanal",
            "year": 2021
        },
        {
            "authors": [
                "LM Peng",
                "G Ren",
                "S Dudarev",
                "M Whelan"
            ],
            "title": "Debye\u2013Waller factors and absorptive scattering factors of elemental crystals",
            "venue": "Acta Crystallogr A",
            "year": 1996
        },
        {
            "authors": [
                "H Pulvermacher"
            ],
            "title": "Transmission cross-coefficient for electron microscopic imaging with partially coherent illumination and electric instability",
            "venue": "Optik 60,",
            "year": 1981
        },
        {
            "authors": [
                "M Radek",
                "JG Tenberge",
                "S Hilke",
                "G Wilde",
                "M Peterlechner"
            ],
            "title": "STEMcl\u2014A multi-GPU multislice algorithm for simulation of large structure and imaging parameter series",
            "venue": "Ultramicroscopy",
            "year": 2018
        },
        {
            "authors": [
                "F R\u00f6der"
            ],
            "title": "Transfer and reconstruction of the density matrix in off-axis electron holography",
            "venue": "Lubk A",
            "year": 2014
        },
        {
            "authors": [
                "H Rose"
            ],
            "title": "Image formation by inelastically scattered electrons in electron microscopy",
            "venue": "Optik",
            "year": 1976
        },
        {
            "authors": [
                "H Rose"
            ],
            "title": "Information transfer in transmission electron microcopy",
            "venue": "Ultramicroscopy",
            "year": 1984
        },
        {
            "authors": [
                "A Rosenauer",
                "M Schowalter"
            ],
            "title": "STEMSIM\u2014A new software tool for simulation of STEM HAADF Z-contrast imaging",
            "venue": "Microscopy of Semiconducting Materials",
            "year": 2008
        },
        {
            "authors": [
                "WO Saxton"
            ],
            "title": "Spatial coherence in axial high resolution conventional electron microscopy",
            "venue": "Optik 49,",
            "year": 1977
        },
        {
            "authors": [
                "P Schattschneider",
                "M Nelhiebel",
                "B Jouffrey"
            ],
            "title": "Density matrix of inelastically scattered fast electrons",
            "venue": "Phys Rev B",
            "year": 1999
        },
        {
            "authors": [
                "S Singh",
                "M De Graef"
            ],
            "title": "GPU-accelerated matrix exponentiation for 5-D STEM-DCI simulations",
            "venue": "Microsc Microanal",
            "year": 2018
        },
        {
            "authors": [
                "P Stadelmann"
            ],
            "title": "JEMS-EMS java version. Available at https:// www.jems-swiss.ch",
            "year": 2021
        },
        {
            "authors": [
                "W Van den Broek",
                "X Jiang",
                "C Koch"
            ],
            "title": "FDES, a GPU-based multislice algorithm with increased efficiency of the computation of the projected potential",
            "year": 2015
        },
        {
            "authors": [
                "J Verbeeck",
                "P Schattschneider",
                "A Rosenauer"
            ],
            "title": "Image simulation of high resolution energy filtered TEM",
            "venue": "images. Ultramicroscopy",
            "year": 2009
        },
        {
            "authors": [
                "RH Wade",
                "J Frank"
            ],
            "title": "Electron microscope transfer functions for partially coherent axial illumination and chromatic defocus spread",
            "venue": "Optik",
            "year": 1977
        },
        {
            "authors": [
                "G Wentzel"
            ],
            "title": "Zwei Bemerkungen \u00fcber die Zerstreuung korpuskularer Strahlen als Beugungserscheinung",
            "venue": "Z Phys",
            "year": 1926
        },
        {
            "authors": [
                "Y Yao",
                "B Ge",
                "X Shen",
                "Y Wang",
                "R Yu"
            ],
            "title": "STEM image simulation with hybrid CPU/GPU programming",
            "venue": "Ultramicroscopy 166,",
            "year": 2016
        }
    ],
    "sections": [
        {
            "text": ""
        },
        {
            "heading": "Graphical Abstract",
            "text": ""
        },
        {
            "heading": "Introduction",
            "text": "Image simulation is an important tool for evaluating experimental (scanning) transmission electron microscope ((S) TEM) images. Most electron microscopes are equipped with a field-emission or a Schottky-emission source, which have a finite size and energy width. The effective source can be modeled as an ensemble of independent point sources\u2014each of which has a specific energy and location. The interaction of the electrons emitted by each of these coherent sources with the sample is modeled by the Bloch-wave and/or by the multislice algorithm (Kirkland, 1998), and results in a constituent (S)TEM image. The intensity distribution of the final image is the weighted sum of the constituent coherent images. The weighting factor depends on the energy distribution and size of the effective electron source. Representative application\nwhich provides the option to calculate images using the incoherent summation approach is Dr. Probe (Barthel, 2018).\nThe transmission cross-coefficient (TCC) is the mixed transfer function averaged with respect to the energy distribution and the size of the source. The use of the Gaussian distribution for the locations of the point sources and for their energy spread enables an analytical form of the TCC (Wade & Frank, 1977; Ishizuka, 1980; Pulvermacher, 1981; Bonevich & Marks, 1988). The first-order TCC is derived by considering only linear terms from the Taylor expansion of the microscope aberrations (Wade & Frank, 1977; Ishizuka, 1980; Pulvermacher, 1981). In the first-order TCC, the correlation between plane waves with angles \u03b8 and \u03b8 \u2032 is gauged by what we call the mixed envelope function (MEF). For an aberrationcorrected microscope, the first-order TCC suffices for image calculations, even at low voltages in the range of 40\u201380 kV (Lee et al., 2019). For an uncorrected microscope, an\nReceived: April 29, 2022. Revised: June 11, 2022. Accepted: June 27, 2022 \u00a9 The Author(s) 2023. Published by Oxford University Press on behalf of the Microscopy Society of America. All rights reserved. For permissions, please e-mail: journals.permissions@oup.com\nnloaded from https://academ ic.oup.com /m am /article/29/1/364/6987567 by Indian Institute of Technology Patna user on 25 January 2024\nimproved TCC including also the high-order terms is required (Pulvermacher, 1981; Bonevich & Marks, 1988). Examples of applications which allow image simulation using the TCC include xHREM (Ishizuka, 2022), JEMS (Stadelmann, 2021), and Dr. Probe (Barthel, 2018).\nThe quasi-coherent (QC) model is a simplified form of the TCC model, which considers only the correlation between the axial wave (\u03b8 \u2032 = 0) and the off-axial waves (\u03b8 \u2260 0), while neglecting the correlation between off-axial plane waves (Frank, 1973; Saxton, 1977; Ishizuka, 1980; Pulvermacher, 1981). The MEF reduces to a simple envelope function for the QC model. In the case of high-resolution TEM (HRTEM), the QC model provides a sufficient approximation of the TCC model for two cases: (a) thin samples which are considered as weak-phase objects and (b) imaging of thicker objects by using a Cc/C3-corrected microscope with the MEF close to one (Lee et al., 2019). The standard calculations of HRTEM images employ the QC model (O\u2019Keefe & Buseck, 1979; Kirkland, 1998; Koch, 2010; Barthel, 2018; Madsen & Susi, 2020; Stadelmann, 2021).\nFor the QC model, the image sampled by an N \u00d7 N grid requires a number of arithmetic operations in the order of O(N2log2N ). The calculations using the TCC model require operations in the order of O(N4) (Chang et al., 2005). In order to improve the computational efficiency of the TCC model, Stadelmann suggested to consider only reflections in the reciprocal space with an amplitude larger than a self-defined threshold, which depends on the requirement of the accuracy (Stadelmann, 2021). For image calculations using the incoherent summation approach, the number of operations is in the order of O(MN2log2N ) with M denoting the number of point sources sampling the effective source (Chang et al., 2005).\nIn the case of STEM image calculations, the scattered wave must be calculated for each scanning position. As a result, the QC model cannot be used, and thus STEM image simulation is much more computationally expensive than that for HRTEM images. If the effective source is considered as an incoherent ensemble of M coherent point sources, then the number of operations for the STEM image calculation is in the order of O(MN4). Fertig and Rose simulated the first STEM images of crystalline objects by employing the Bloch-wave method (Fertig & Rose, 1981). Kirkland et al. implemented the multislice procedure for the calculation of STEM images (Kirkland et al., 1987).\nTwo procedures exist, which significantly reduce the computation time of STEM image calculations. The first procedure takes advantage of parallel computation and the multislice formalism (Hosokawa et al., 2015; Van den Broek et al., 2015; Kirkland, 2016; Lobato et al., 2016; Yao et al., 2016; Oelerich et al., 2017; Barthel, 2018; Radek et al., 2018; Singh & De Graef, 2018). The second method uses the S-matrix, which describes the scattering of the electron wave through the sample. Ophus proposed the PRISM algorithm which combines Bloch-wave and multislice methods. In this algorithm, the incident wave is expressed as a superposition of plane waves. After propagating each plane wave through the object by using the multislice algorithm, one adds them linearly to produce the probes at the exit plane. Fourier interpolation may be used to limit the number of plane waves required to express the probe, at some cost of accuracy (Ophus, 2017).\nThe PRISM algorithm has been combined with parellel computing implementing CPUs and GPUs in open-source codes (Brown et al., 2020; Madsen & Susi, 2020; DaCosta\net al., 2021). An improved method, called the partitioning PRISM algorithm, splits the STEM probe into a series of basis functions generated by natural neighbor interpolation between a set of parent beams. This improved algorithm provides remarkable benefits for 4D-STEM image simulations (Pelz et al., 2021). The PRISM algorithm does not directly adress the issue of partial coherence of the source. However, since the defocus can be adjusted after propagating the plane waves, the focal variation can be used for including partial temporal coherence of the source.\nThis paper focusses on the efficient handling of the electron source in (S)TEM image calculation considering only elastic scattering. We employ the MEF to account for the partial coherence of the source, and the calculation is based on the TCC model. Since the MEF is a four-dimensional array, a direct incorporation of this term in the image calculation is time-consuming. We provide another method to handle the MEF. Because the flattened MEF is a symmetric matrix, it enables a sufficiently accurate approximation by using the eigenvectors retrieved from matrix diagonalization of the MEF. We aim for a small number of eigenvectors for approximating the MEF and thus reducing the computation time considerably."
        },
        {
            "heading": "Theory",
            "text": "We employ the TCC model for calculating (S)TEM images, taking into account the finite size and energy spread of the source. We retrieve the eigenvectors of the MEF from the TCC by matrix diagonalization. Since the TCC model for HRTEM imaging has been presented by several authors (Wade & Frank, 1977; Ishizuka, 1980; Pulvermacher, 1981), we only give a brief review with an emphasis on the application of matrix diagonalization for this model."
        },
        {
            "heading": "Application of Matrix Diagonalization in STEM Image Calculation Using the TCC Model",
            "text": ""
        },
        {
            "heading": "Formation of STEM Images Including Chromatic Aberration and Finite Source Size",
            "text": "The scanning probe is the image of the effective electron source formed by the condenser lens system. The effective source consists of an incoherent ensemble of point sources with different energies. As shown in Figure 1, the spatial distribution of the individual point sources results in a spatial distribution of probe positions in the sample plane, and the energy distribution of the point sources results in probes of varied focal values. For a monochromated point source located at \u03c1s with energy deviation \u0394E from the mean energy E0, the corresponding probe function \u03a8(\u03c1 \u2212 \u03c10 \u2212 \u03c1s, \u0394E) at the object plane z0 is given by\n\u03a8(\u03c1 \u2212 \u03c10 \u2212 \u03c1s, \u0394E)\n= \u222b\u03b4(\u03c1\u03bd \u2212 \u03c1s)A(\u03b8)TL(\u03b8, \u0394E) eik\u03b8(\u03c1\u2212 \u03c10) e\u2212 ik\u03b8\u03c1\u03bd d2\u03c1\u03bd d2\u03b8\n= \u222bA(\u03b8)TL(\u03b8, \u0394E) eik\u03b8(\u03c1\u2212 \u03c10 \u2212 \u03c1s) d2\u03b8,\n(1)\nwhere the aperture function A(\u03b8) guarantees that the beam is only transmitted if the illumination angle \u03b8 is smaller than the limiting aperture angle \u03b80. The lens transfer function TL(\u03b8, \u0394E) = e\u2212 i\u03b3( \u03b8,\u0394E) = e\u2212 i[\u03b3g(\u03b8)+\u03b3c(\u03b8,\u0394E)] depends on the phase\nZhongbo Li et al. 365 D\now nloaded from https://academ ic.oup.com /m am /article/29/1/364/6987567 by Indian Institute of Technology Patna user on 25 January 2024\nshift \u03b3g(\u03b8) resulting from the geometrical aberrations and the defocus of the objective lens, as well as on the chromatic phase shift \u03b3c(\u03b8, \u0394E) \u2248 Cc(\u03c0\u0394E/\u03bbE0)\u03b8\n2, where Cc is the chromatic aberration coefficient. The vector \u03c10 is the shift of the center of the probe due to scanning.\nBy taking into account the object transmission function O(\u03c1), the wave at the exit plane of a thin sample is\n\u03a8e(\u03c1 \u2212 \u03c10 \u2212 \u03c1s, \u0394E) = O(\u03c1)\u03a8(\u03c1 \u2212 \u03c10 \u2212 \u03c1s, \u0394E). (2)\nFor a thick sample, the object transmission function O(\u03c1) in (2) is replaced by the scattering matrix S. The multislice algorithm (Cowley & Moodie, 1957) is applied to calculate the exit wave \u03a8e.\nThe Fourier transform of \u03a8e(\u03c1 \u2212 \u03c10 \u2212 \u03c1s, \u0394E) represents the wave at the detector plane. Its absolute square is the diffraction pattern:\nR(\u0398, \u03c10, \u0394E, \u03c1s)\n= \u222b\u03a8e(\u03c1 \u2212 \u03c10 \u2212 \u03c1s, \u0394E) e\u2212 ik\u0398\u03c1d2\u03c1       2\n= \u222b\u222bA(\u03b8)TL(\u03b8, \u0394E)O(\u03c1) e\u2212 ik\u03c1(\u0398\u2212 \u03b8) e\u2212 ik\u03b8(\u03c10+\u03c1s) d2\u03c1 d2\u03b8       2\n= \u222bA(\u03b8)TL(\u03b8, \u0394E)O\u0303(\u0398 \u2212 \u03b8) e\u2212 ik\u03b8(\u03c10+\u03c1s))d2\u03b8       2\n= |T(\u0398, \u0394E, \u03c10, \u03c1s)\u2297 O\u0303(\u0398)|2.\n(3)\nHere, \u0398 is the detector angle. The object spectrum O\u0303(\u0398) is the Fourier transform of O(\u03c1). The transfer function T(\u0398, \u0394E, \u03c10, \u03c1s) is\nT(\u0398, \u0394E, \u03c10, \u03c1s) = A(\u0398)TL(\u0398, \u0394E) e\u2212 ik \u0398(\u03c10+\u03c1s). (4)\nThe intensity of the STEM image formed by the scanning probe originating from the point source located at \u03c1s is:\nI(\u03c10, \u03c1s, \u0394E) = \u222bD(\u0398)|T(\u0398, \u0394E, \u03c10, \u03c1s)\u2297 O\u0303(\u0398)|2 d2 \u0398. (5) The detector function D(\u0398) accounts for the combination of the signals recorded by the individual elements of the detector. This function can have positive and negative values indicating signal subtraction. The absolute value of the detector function is |D(\u0398)| \u2264 1. In the case of an ideal detector, the collection efficiency adopts its maximum value |D(\u0398)| = 1.\nThe final image is the sum of the subimages, each formed by the scanning probes originating from a distinct point source. The intensity I(\u03c10, \u03c1s, \u0394E) of each subimage is weighted by factors p(\u0394E) and s(\u03c1s). The term p(\u0394E) is the normalized energy distribution function: \u222b p(\u0394E)d\u0394E = 1. The normalized function s(\u03c1s) accounts for the spatial distribution of the point sources: \u222b s(\u03c1s) d2\u03c1s = 1. The intensity distribution of the final image is given by\nI(\u03c10) = \u222b\u222bp(\u0394E)s(\u03c1s)I(\u03c10, \u03c1s, \u0394E)d2\u03c1s d\u0394E. (6)\nFig. 1. The effective source in STEM is considered as an ensemble of incoherent point sources. The spatial distribution of the individual point sources results in a spatial distribution of probe positions in the sample plane, and a superposition of diffraction patterns formed by different probes. The energy distribution of the point sources results in probes of varied focal values and a radially blurred diffraction pattern, which is a superposition of the diffraction patterns formed by individual probes.\n366 Microscopy and Microanalysis, 2023, Vol. 29, No. 1 D\now nloaded from https://academ ic.oup.com /m am /article/29/1/364/6987567 by Indian Institute of Technology Patna user on 25 January 2024\nBy substituting (5) for I(\u03c10, \u03c1s, \u0394E) in (6), and (4) for T(\u0398, \u0394E, \u03c10, \u03c1s) in (5), one obtains\nI(\u03c10) = \u222b s(\u03c1s)I\u2032(\u03c10 + \u03c1s) d2\u03c1s = s(\u03c10)\u2297 I\u2032(\u03c10). (7) Relation (7) shows that final image intensity is the convolution between the spatial distribution function of the source and the image intensity I\u2032(\u03c10) formed by a spatially coherent point source (Gong, 1994; Nellist & Rodenburg, 1994):\nI\u2032(\u03c10) = \u222b\u222b p(\u0394E)D(\u0398)|T(\u0398, \u0394E, \u03c10)\u2297 O\u0303(\u0398)|2 d2 \u0398 d\u0394E. (8) By assuming a Gaussian distribution: s(\u03c10) = (1/2\u03c0\u03c32s ) exp(\u2212 \u03c120/2\u03c32s ), the Fourier transform of s(\u03c10) is\nE\u03c3(\u03b8) = \u222b s(\u03c10) e\u2212 ik\u03c10\u03b8 d2\u03c10 = exp \u2212 2 \u03c0\u03c3s \u03bb  2 \u03b82\n \n. (9)\nThe mean diameter of the effective source is given by ds = \ufffd\ufffd\ufffd 2\u03c0 \u221a \u03c3s."
        },
        {
            "heading": "MEF Accounting for Temporal Partial Coherence of the Source",
            "text": "We rewrite the integral (8) as\nI\u2032(\u03c10) = \u222b\u222b\u222b\u222bp(\u0394E)D(\u0398)T(\u03b8, \u0394E, \u03c10)O\u0303(\u0398 \u2212 \u03b8) T\u2217(\u03b8 \u2032, \u0394E, \u03c10)O\u0303 \u2217 (\u0398 \u2212 \u03b8 \u2032)d2\u03b8 \u2032 d2\u03b8 d2 \u0398 d\u0394E. (10)\nReplacing T(\u03b8, \u0394E, \u03c10) and T\u2217(\u03b8 \u2032, \u0394E, \u03c10) each by (4), and by assuming that p(\u0394E) is the normalized Gaussian function p(\u0394E) = (1/ \ufffd\ufffd\ufffd 2\u03c0 \u221a\n\u03c3E) exp(\u2212 \u0394E2/2\u03c32E), we can perform analytically the integration with respect to \u0394E, giving\nEc(\u03b8, \u03b8 \u2032)\n= 1 \ufffd\ufffd\ufffd 2\u03c0 \u221a \u03c3E \u222b exp \u2212 \u0394E\n2\n2\u03c32E\n \nexp \u2212 iCc \u03c0\u0394E \u03bbE0 [\u03b8 2 \u2212 \u03b8 \u20322]\n \nd\u0394E\n= exp \u2212 1 2 \u03c0Cc\u03c3E \u03bbE0\n 2 [\u03b8 2 \u2212 \u03b8 \u20322]2  \n= exp \u2212 1 2 \u03c0\u03c3c \u03bb  2 [\u03b8 2 \u2212 \u03b8 \u20322]2\n \n.\n(11)\nHere, \u03c3c = Cc(\u03c3E/E0) = Cc( \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \u2329(\u0394E)2\u232a  /E0) is the focal spread.\nIn the case of chromatic correction, Ec(\u03b8, \u03b8 \u2032) = 1. We define the maximum usable aperture angle \u03b80 by the relation Ec(\u03b8, 0) = exp( \u2212 2), giving\n\u03b80 = \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd 2\u03bb/(\u03c0\u03c3c)  . (12)\nRewriting the image intensity (10), we obtain\nI\u2032(\u03c10) = \u222b\u222b\u222b D(\u0398)Tcc(\u03b8, \u03b8 \u2032, \u03c10)O\u0303(\u0398 \u2212 \u03b8) O\u0303 \u2217 (\u0398 \u2212 \u03b8 \u2032)d2\u03b8 d2\u03b8 \u2032 d2 \u0398,\n(13)\nTcc(\u03b8, \u03b8 \u2032, \u03c10) = T(\u03b8, \u03c10)T\u2217(\u03b8 \u2032, \u03c10)Ec(\u03b8, \u03b8 \u2032), (14)\nT(\u03b8, \u03c10) = A(\u03b8) e\u2212 i\u03b3g( \u03b8) e\u2212 ik \u03b8\u03c10 . (15)\nConvert 4D Problem to 2D Because \u03b8 and \u03b8 \u2032 are two-dimensional vectors, Ec(\u03b8, \u03b8 \u2032) is a 4D symmetric matrix. The computation of the intensity I\u2032(\u03c10) is very time-consuming by direct implementation of Ec(\u03b8, \u03b8 \u2032) in the integrand (13). To reduce the computation time, we flatten and diagonalize the 4D symmetric matrix Ec(\u03b8, \u03b8 \u2032) such that we can write it as a sum of products of eigenvectors \u03d5n(\u03b8):\nEc(\u03b8, \u03b8 \u2032) = \nn\nan\u03d5n(\u03b8)\u03d5 T n ( \u03b8 \u2032). (16)\nBy substituting (16) for Ec(\u03b8, \u03b8 \u2032) in (14), we rewrite (13) as\nI\u2032(\u03c10) = \nn\nan\u222b D(\u0398)|[\u03d5n(\u0398)T(\u0398, \u03c10)]\u2297 O\u0303(\u0398)|2 d2 \u0398. (17)\nThe contribution of each eigenvector \u03d5n(\u0398) is weighted by the corresponding eigenvalue an. Matrix diagonalization aims at finding the fewest eigenvectors for reconstructing the 4D matrix Ec(\u03b8, \u03b8 \u2032). The diagonalization of the 4D matrix (Lee et al., 2017) necessitates three steps as shown in Figure 2."
        },
        {
            "heading": "Application of Matrix Diagonalization in HRTEM Image Calculation Using the TCC Model",
            "text": "The TCC model for HRTEM imaging is based on the incoherent summation approach. The MEF accounting for partially temporal coherence of the source is derived by assuming a Gaussian distribution of the energy spread of the source, leading to the analytical expression (11). For HRTEM, a point source located at \u03c1s \u2260 0 results in a tilted illumination angle \u03c4 = \u03c1s/fc. Here, fc is the focal length of the condenser system. \u03c1s = 0 correponds to parallel illumination. We derive the MEF accounting for partially spatial coherence of the source by assuming a Gaussian distribution of the point sources. Since the illumination angle \u03c4 and the shift of source \u03c1s are linearly related, the Gaussian distribution can also be expressed as a function of the illumination angle: s(\u03c4) = (1/\u03c0\u03b82s ) exp(\u2212 \u03c42/\u03b8 2 s ). By considering only linear terms from the Taylor expansion of the phase shift of the objective lens: \u03b3g(\u03b8+ \u03c4) = \u03b3g(\u03b8) + \u03c4\u2207\u03b3g(\u03b8) + \u00b7 \u00b7 \u00b7, and by calculating the integration over \u03c4, one obtains the first-order spatial MEF (Wade & Frank, 1977; Ishizuka, 1980; Pulvermacher, 1981):\nEs(\u03b8, \u03b8 \u2032) = exp \u2212 \u03b8s 2\n 2 (\u2207\u03b3(\u03b8) \u2212 \u2207\u03b3(\u03b8 \u2032))2   . (18)\nFig. 2. Diagonalization of a 4D matrix takes three steps: (a) flatten the 4D matrix as a 2D matrix; (b) diagonalize the 2D matrix and retrieve the eigenvectors; and (c) reshape each 1D eigenvector to 2D.\nZhongbo Li et al. 367 D\now nloaded from https://academ ic.oup.com /m am /article/29/1/364/6987567 by Indian Institute of Technology Patna user on 25 January 2024\nThe first-order MEF E(\u03b8, \u03b8 \u2032) is the product of Ec(\u03b8, \u03b8 \u2032) and Es(\u03b8, \u03b8 \u2032):\nE(\u03b8, \u03b8 \u2032) = Ec(\u03b8, \u03b8 \u2032)Es(\u03b8, \u03b8 \u2032). (19)\nThe intensity distribution of the HRTEM image calculated by using the TCC model is given by\nI(\u03c1) = \u222b\u222b O\u0303(\u03b8)O\u0303\u2217(\u03b8 \u2032)Tcc(\u03b8, \u03b8 \u2032) eik\u03c1(\u03b8\u2212 \u03b8 \u2032) d2\u03b8 d2\u03b8 \u2032, (20) Tcc(\u03b8, \u03b8 \u2032) = T(\u03b8)T(\u03b8 \u2032)E(\u03b8, \u03b8 \u2032). (21)\nThe transfer function T(\u03b8) is obtained by setting \u03c10 = 0 in (15). We obtain the QC model by means of the approximation E(\u03b8, \u03b8 \u2032) \u2248 E(\u03b8)E(\u03b8 \u2032). This approximation holds true if \u03b8s in (18) and \u03c3c in (11) are negligibly small. The corresponding image intensity is\nI(\u03c1) = \u222b O\u0303(\u03b8)T(\u03b8)E(\u03b8) eik\u03c1\u03b8 d2\u03b8       2 . (22)\nInstead of using the QC approximation, we use the eigenvectors of E(\u03b8, \u03b8 \u2032) in order to employ the TCC model with high accuracy. Replacing Ec(\u03b8, \u03b8 \u2032) in (16) by E(\u03b8, \u03b8 \u2032), we rewrite (20) as\nI(\u03c1) = \nn\nan \u222b O\u0303(\u03b8)T(\u03b8)\u03d5n(\u03b8) eik\u03c1\u03b8 d2\u03b8       2 . (23)\nHere, an and \u03d5n(\u03b8) are the nth eigenvalue and eigenvector of the matrix (19), respectively."
        },
        {
            "heading": "Results and Discussion",
            "text": ""
        },
        {
            "heading": "Application of the Eigenvector Method in STEM Image Calculation Employing the TCC Model",
            "text": ""
        },
        {
            "heading": "Number of Eigenvectors Required to Reconstruct the 4D Matrix with Sufficient Accuracy",
            "text": "In order to approximate the MEF Ec(\u03b8, \u03b8 \u2032) by matrix diagonalization with a given accuracy, we must determine the required number of eigenvectors. As an example, we constructed two vectors \u03b8 and \u03b8 \u2032, each sampled by a 100 \u00d7 100 grid with an interval of 0.75 mrad/pixel. We calculated the 4D array Ec(\u03b8, \u03b8 \u2032) for the STEM operating at 200 kV and \u03c3c = 4 nm. The dimension of the flattened array is 10,000 \u00d7 10,000. The ten largest eigenvalues were retrieved, and subsequently, the matrices were reconstructed by using the corresponding eigenvectors. The accuracy was evaluated by means of the correlation coefficient R (R \u2264 1). The original matrix is approximated with sufficient accuracy in the case R \u2248 1.\nThe bold line in Figure 3 shows that for R \u2248 1, about ten eigenvectors suffice for reconstructing the original matrix Ec(\u03b8, \u03b8 \u2032) with sufficient accuracy. Since the aperture function A(\u03b8) is part of the transfer function T(\u03b8, \u03c10) in (15), one can remove the irrelevant regions in Ec(\u03b8, \u03b8 \u2032) and accelerate the convergence of the R curve by including the aperture function in the matrix diagonalization:\nEc(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032) = \nn\nan\u03d5n(\u03b8)\u03d5 T n ( \u03b8 \u2032). (24)\nBy applying the maximum usable aperture angle \u03b80 = 20 mrad given by (12), we reduce the effective size of the flattened\nmatrix Ec(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032) to 2,809 \u00d7 2,809 in this example. The dashed line in Figure 3 shows, two or three eigenvectors suffice to reconstruct Ec(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032)with R \u22481. The eigenvectors corresponding to the five largest eigenvalues are displayed in Figure 4, which resemble radial Zernike polynomials (Noll, 1976).\nFor finding the number of eigenvectors required to reconstruct Ec(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032) in general cases, we employed the maximum usable aperture angle (12) and constructed a stack of Ec(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032) for accelerating voltages in the range between 20 and 300 kV, \u03c3c in the range between 1 and 6 nm. In all cases, three eigenvectors suffice for reconstructing the original matrix with correlation coefficient R \u2265 0.9999."
        },
        {
            "heading": "Image Calculation Using the Eigenvector Method",
            "text": "In order to verify the advantage of diagonalizing Ec(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032) for image calculations, we compared the eigenvector method (17) with the incoherent summation method (8).\nWe have performed image calculations implementing CPU-based parallel computation algorithm on a computer equipped with Intel Quad-core i5-6500 CPU and 16 GB of DDR4 RAM. As an example, we considered a BaTiO3 crystal 8 \u00c5 \u00d7 8 \u00c5 \u00d7 20 \u00c5 and a sampling of 0.1 \u00c5/pixel. Incoherent BF (IBF) and HAADF images were calculated for an STEM microscope operating at 200 kV by applying the multislice algorithm (Kirkland, 1998). For a quantitative comparison with experiments, thermal diffuse scattering is usually taken into account by the frozen-phonon model, in which a random offset is assigned to the position of each atom, and images calculated for a series of atomic arrangements are averaged (Kirkland, 1998). Representative applications which provide the option of the frozen-phonon model for STEM image calculations are STEMSIM (Rosenauer & Schowalter, 2008) and abTEM (Madsen & Susi, 2020). An alternative to the frozen-phonon model is the many-body quantummechanical model based on the Born-Oppenheimer approximation (Forbes et al., 2010), which treats phonon scattering\nFig. 3. Coeffcient R defining the correlation between the reconstructed matrix  n an\u03d5n(\u03b8)\u03d5 T n ( \u03b8 \u2032) and the true matrices (a) Ec(\u03b8, \u03b8 \u2032) (bold line), (b) Ec(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032) (dashed line), as a function of the number n of eigenvectors. Microscope parameters: U = 200 kV, \u03c3c = 4 nm, \u03b80 = 20 mrad.\n368 Microscopy and Microanalysis, 2023, Vol. 29, No. 1 D\now nloaded from https://academ ic.oup.com /m am /article/29/1/364/6987567 by Indian Institute of Technology Patna user on 25 January 2024\nas \u201cinelastic\u201d scattering. This model has been incorporated into the \u03bcSTEM package for (S)TEM image calculations (Allen & Findlay, 2015). We include thermal diffuse scattering by applying Debye\u2013Waller factors for BaTiO3 (Harada & Pedersen, 1968). The calculation parameters are listed in the caption of Figure 5. In the IBF mode, the maximum collection angle equals the illumination angle. One, two, and three eigenvectors are used for the image calculation. The image intensity is normalized by dividing it by the solid angle of the illumination aperture \u03a9 = \u222b A(\u03b8) d\u03b8. The first to third rows in Figure 5 show images calculated by using eigenvectors from diagonalizing Ec(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032). The images calculated by using the incoherent summation method are shown in the fourth row. The last row displays line profiles marked on the images of each column.\nThe use of only one eigenvector leads to perceivable intensity loss in the IBF image. By using three eigenvectors, the image is almost identical with the one calculated by incoherent summation, as demonstrated by the line profiles in the last row. In the HAADF case, even one eigenvector produces the image close to the one calculated by using the incoherent summation method (Figure 5, last column). The contrasts of HAADF images are less sensitive to the microscope parameters than in the IBF mode.\nThe calculation time for each case is given in Table 1. For the eigenvector method, the calculation time accounts for matrix diagonalization and for the total calculation of both the IBF and HAADF images. The calculations employing the eigenvectors took no more than 1 min. The summation method based on (6) took 192 s. In this method, we have sampled the focal variation caused by the energy spread of the source in the range between \u2212 12 and 12 nm with an interval of 2.4 nm. For an effective electron source with a broader energy distribution than in Figure 5, the computational time for the incoherent summation method increases further, whereas it will stay within 1 min by applying the eigenvector method. Three eigenvectors suffice in most cases to approximate Ec(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032) with high accuracy."
        },
        {
            "heading": "Application of the Eigenvector Method in HRTEM Image Calculation Using the TCC Model",
            "text": "We demonstrate the application of the eigenvector method in HRTEM image calculation by means of the images of a monolayered MoTe2 structure with defect, shown in Figure 6. The structure is sampled by a 245 \u00d7 212 grid with the sampling of 0.1 \u00c5/pixel. HRTEM images are calculated for a microscope operating at 80 kV. Thermal diffuse scattering is taken into account by applying a Debye\u2013Waller factor\nof 0.58 \u00c52, derived from the mean square relative displacement \u03c32i\u2212 j = 74 pm\n2 of the bonds Mo\u2013Mo and Te\u2013Te (Caramazza et al., 2016) by using the relation B = 8\u03c02\u03c32i\u2212 j (Peng et al., 1996). The parameters \u03c3c = 4 nm and \u03b8s = 5 mrad are employed for constructing the matrix E(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032) with E(\u03b8, \u03b8 \u2032) defined by (19). Other parameters are listed in the caption of Figure 6. Figures 6a\u20136c are calculated by using 2, 4, and 6 eigenvectors retrieved from matrix diagonalization. As comparison, the image calculated by using the TCC model is shown in Figure 6d, and the one calculated by using the QC model is shown in Figure 6e. Figure 6f displays line profiles marked by the arrows in Figures 6a\u20136e. CPU-based parallel computation algorithm has been employed for the image calculation utilizing the TCC method.\nCompared with the image calculated by using the TCC model (Fig. 6d), the one calculated by using the QC model (Fig. 6e) suffers a loss of intensity because the QC model introduces appreciable errors for modeling the imaging of high-Z materials in a microscope without Cc-correction (Lee et al., 2019). By using six eigenvectors, we obtain an image quite close to the one calculated by using the TCC method (Figs. 6c, 6d), also demonstrated by the line profiles in Figure 6f. However, the difference between the calculation time for the two cases is dramatic. As shown in Table 2, the calculation using the TCC method takes 3,300 times longer than that using the eigenvector method.\nWe have constructed a stack of E(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032) for \u03b8s = 5 mrad, accelerating voltages in the range between 20 and 300 kV, \u03c3c in the range between 1 and 6 nm, and the maximum usable aperture angle \u03b80 given by (12). In almost all cases, six eigenvectors suffice for reconstructing the original matrix with a correlation coefficient R \u2265 0.9999."
        },
        {
            "heading": "Potential Application of the Eigenvector Method in Other Aspects",
            "text": ""
        },
        {
            "heading": "Calculation of Convergent-Beam Electron Diffraction (CBED) Patterns",
            "text": "For STEM image calculations, partial spatial coherence of the source is taken into account by a convolution between the spatial distribution of the source and the image intensity formed by a point source (Gong, 1994; Nellist & Rodenburg, 1994). In calculations where the partial spatial coherence of the source cannot be described by such a simple convolution, such as simulations of CBED patterns, this effect is usually accounted for by explicit averaging over probe shift (Barthel, 2018). A suggestion is to use 100 or more samplings for\nFig. 4. Eigenvectors \u03d5n(\u03b8x, \u03b8y) and eigenvalues an (n = 1, 2, \u2026, 5), obtained by diagonalizing the matrix Ec(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032). Microscope parameters: U = 200 kV, \u03c3c = 4 nm, \u03b80 = 20 mrad.\nZhongbo Li et al. 369 D\now nloaded from https://academ ic.oup.com /m am /article/29/1/364/6987567 by Indian Institute of Technology Patna user on 25 January 2024\nsimulating source size effect (Barthel, 2022). In this case, the eigenvector method has the potential to include the partial spatial coherence in a more efficient manner.\n(S)TEM Image Calculations Including Plasmon-Loss and Core-Loss Scattering So far we have only considered the application of the eigenvector method in (S)TEM image calculations for elastic scattering. However, this method has also the potential to be extended to image calculations including inelastic scattering and a partially coherent source. Inspired by the concept of mutual coherence function (MCF) accounting for the interference between two partially coherent waves in optics (Born & Wolf, 1970), Rose and Hawkes extended its application in electron optics (Rose, 1976; Hawkes, 1978; Rose, 1984). Rose and Kohl introduced an imaging model considering inelastic scattering, where the MCF accounts for the interference between the waves which correspond to the same object state (Rose, 1976, 1984; Kohl & Rose, 1985). The object is described by\nFig. 5. Calculated STEM IBF and HAADF images of a BaTiO3 crystal (8 \u00c5 \u00d7 8 \u00c5 \u00d7 20 \u00c5) using (a) the eigenvector method based on (7) and (17); (b) the incoherent summation method based on (7) and (8). The calculations employs Wentzel atom potentials (Wentzel, 1926) and Debye\u2013Waller factors taken from Harada & Pedersen (1968): BBa = 0.27 \u00c52, BTi = 0.46 \u00c52, BO = 0.9 \u00c52. The first to third rows show images calculated by substituting 1, 2, and 3 eigenvectors for Ec(\u03b8, \u03b8 \u2032)A(\u03b8)A(\u03b8\u2032), respectively. The fourth row shows images calculated by using the incoherent summation method. The last row shows line profiles marked by the lines in the images. Each image is sampled by a grid of 79 \u00d7 79 pixels, with a sampling of 0.1 \u00c5/pixel. Microscope parameters: U = 200 kV, \u03c3c = 4 nm, \u03c3s = 15 pm (ds = 38 pm), C5 = 4 mm, C3 = \u221266.4 \u03bcm, C1 = 146 \u00c5. The values of C1 and C3 are optimized based on the Appendix. The focal spread profile of the electron source is sampled in the range \u221212 to 12 nm with an interval of 2.4 nm.\nTable 1. Time for STEM Image Calulcations in Figure 5 by Using the Eigenvector Method and by Using the Incoherent Summation Method.\nMethods No. of eigenvectors Calc. time (s)\nEigenvector method, equations (7) and (17)\n1 18\n2 34 3 50\nIncoherent sum, equations (7) and (8)\n192\n370 Microscopy and Microanalysis, 2023, Vol. 29, No. 1 D\now nloaded from https://academ ic.oup.com /m am /article/29/1/364/6987567 by Indian Institute of Technology Patna user on 25 January 2024\nthe mutual dynamic object transparency (MDOT) (Rose, 1984; Kohl & Rose, 1985; M\u00fcller et al., 1998) or by the density matrix (Schattschneider et al., 1999). The MDOT and the density matrix are both spatially four-dimensional, and computation efficient methods have been proposed to tackle the 4D problem. M\u00fcller utilized generated Bessel functions to factorize the 4D Fourier transform into the combination of 2D Fourier transforms (M\u00fcller et al., 1998). Schattschneider derived the dipole approximation which is valid for scattering angles close to zero (Schattschneider et al., 1999). This approximation has been applied by Verbeeck et al. to calculate core-loss images (Verbeeck et al., 2009). Dwyer calculated the projected transition potential utilizing the Hermann-Skillman model, and this method is proved to be consistent with experiments (Dwyer, 2005). Allen et al. extended the work of Kohl and Rose by deriving the local effective scattering potential (Allen & Findlay, 2015). This method has been applied to high-angle annular dark-field imaging and elemental mapping (Allen & Findlay, 2015). Lee et al. applied the method of matrix diagonalization to convert the MDOT of the sample to combination of 2D functions (Lee et al., 2017). The examples above do not include the effect of the partial coherence of the source. An imaging model developed for electron holography including the TCC is given by R\u00f6der & Lubk (2014). The eigenvector method has the potential to significantly reduce the time for image calculation taking into account inelastic scattering and a partially coherent source."
        },
        {
            "heading": "Conclusion",
            "text": "We introduced a computation-efficient method for (S)TEM image calculations accounting for the finite size and the energy spread of the effective electron source, which we consider as an\nensemble of independent point sources. We first calculate the MEF, which characterizes the partial coherence of the effective source. Since the MEF is a four-dimensional array, its application in image calculations is very time-consuming. To reduce the computation time, we approximate the MEF by the eigenvectors obtained from matrix diagonalization. By including the aperture function in the matrix diagonalization, only a small number of eigenvectors are required to approximate the original matrix with high accuracy. Each eigenvector of the diagonalized matrix is multiplied with the transfer function of the objective lens. Subsequently, the corresponding (S)TEM image is calculated by using the modified transfer function. Finally, all images are summed up after being weighted by the corresponding eigenvalues. Because only a few eigenvectors are necessary to accurately approximate the original matrix, the eigenvector method is more efficient than the incoherent summation method for (S)TEM image calculation, and significantly more efficient than the TCC method. The eigenvector method is implemented in the open-source TEM image simulation code abTEM (Madsen & Susi, 2020). The public repository provides notebooks demonstrating the presented method with comparison to the incoherent summation method."
        },
        {
            "heading": "Acknowledgments",
            "text": "We sincerely thank Heiko M\u00fcller for helpful suggestions. Z.L., H.R., J.B., and U.K. gratefully acknowledge the financial support of the German Research Foundation (DFG) within the project 456681676. J.M. and T.S. were further supported by the European Research Council (ERC) under the European Union\u2019s Horizon 2020 research and innovation programme (Grant No. 756277-ATMEN)."
        },
        {
            "heading": "Appendix. Optimization of C1 and C3 for given C5",
            "text": "The electron microscope corrected up to the fifth-order spherical aberration allows one to adjust the third-order spherical aberration coefficient C3 and the defocus C1 arbitrarily. In the case of only rotationally symmetric aberrations, the phase shift \u03b3g(\u03b8) of the aberration transfer function exp[\u2212 i\u03b3g(\u03b8)] is given by\n\u03b3g(\u03b8) = \u03c0 \u03bb C1\u03b82 + 1 2 C3\u03b84 + 1 3\nC5\u03b86   . (A.1)\nWe choose the parameters such that the phase shift of the objective lens satisfies the condition:\n\u222b \u03b3g(\u03b8) \u2213 \u03c0 2      d\u03b8\u2192 min. (A.2)\nThe sign \u201c\u2212\u201d represents the bright-atom imaging condition and \u201c+\u201d represents the dark-atom imaging condition. By applying the least-square fitting, we obtain\nC1 = (\u2212 1)n 7\u03bb\n3\u03b82m +\n35 297 C5\u03b84m, (A.3)\nC3 = (\u2212 1)n+1 21\u03bb 5\u03b84m \u2212 28 33 C5\u03b82m. (A.4)\nHere, \u03b8m represents the resolution limit for HRTEM, or the maximum usable aperture angle for STEM. The coefficients C1 and C3 for bright-atom imaging are given by setting n = 0 in (A.3)\u2013(A.4). For a positive C5, the resolution limit for the bright-atom imaging is given by\n\u03b8m = min 1.7473 \u03bb\nC5\n 1/6\n, infolim\n \n. (A.5)\nThe first term in (A.5) represents C5 limited resolution, and the second term is the information limit of the microscope. The smaller of the two denotes the optimal resolution. In the case of C3-corrected microscope, the second term is given by (12).\nThe coefficients C1 and C3 for dark-atom imaging are given by setting n = 1 in (A.3)\u2013(A.4). For postive C5, the resolution limit for the dark-atom imaging is given by\n\u03b8m = min 1.433 \u03bb\nC5\n 1/6\n, infolim\n \n. (A.6)\nZhongbo Li et al. 373 D\now nloaded from https://academ ic.oup.com /m am /article/29/1/364/6987567 by Indian Institute of Technology Patna user on 25 January 2024\nTESCAN Solutions for Battery Industry Power your Advanced Battery Technology and Research with TESCAN Solutions\ninfo.tescan.com/batteries Scan for more information"
        }
    ],
    "title": "Computationally Efficient Handling of Partially Coherent Electron Sources in (S)TEM Image Simulations via Matrix Diagonalization",
    "year": 2023
}