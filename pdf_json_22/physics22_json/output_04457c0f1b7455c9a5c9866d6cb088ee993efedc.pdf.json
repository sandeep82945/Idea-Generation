{
    "abstractText": "The PADME apparatus was built at the Frascati National Laboratory of INFN to search for a dark photon (A\u2032) produced via the process e+e\u2212 \u2192 A\u2032\u03b3. The central component of the PADME detector is an electromagnetic calorimeter composed of 616 BGO crystals dedicated to the measurement of the energy and position of the final state photons. The high beam particle multiplicity over a short bunch duration requires reliable identification and measurement of overlapping signals. A regression machine-learning-based algorithm has been developed to disentangle with high efficiency close-intime events and precisely reconstruct the amplitude of the hits and the time with sub-nanosecond resolution. The performance of the algorithm and the sequence of improvements leading to the achieved results are presented and discussed.",
    "authors": [
        {
            "affiliations": [],
            "name": "Kalina Dimitrova"
        }
    ],
    "id": "SP:2a2e0b96fb840a2db6c2ac0e62eec3b2da322ee6",
    "references": [
        {
            "authors": [
                "M. Raggi",
                "V. Kozhuharov"
            ],
            "title": "Proposal to Search for a Dark Photon in Positron on Target Collisions at DA\u03a6NE Linac",
            "venue": "Adv. High Energy Phys. 2014,",
            "year": 2014
        },
        {
            "authors": [
                "P. Valente",
                "M. Belli",
                "B. Bolli",
                "B. Buonomo",
                "S. Cantarella",
                "R. Ceccarelli",
                "A. Cecchinelli",
                "O. Cerafogli",
                "R. Clementi",
                "C Di Giulio"
            ],
            "title": "Linear Accelerator Test Facility at LNF Conceptual Design Report",
            "venue": "arXiv 2016,",
            "year": 2016
        },
        {
            "authors": [
                "S. Agostinelli",
                "J. Allison",
                "K.A. Amako",
                "J. Apostolakis",
                "H. Araujo",
                "P. Arce",
                "M. Asai",
                "D. Axen",
                "S. Banerjee",
                "G.J.N.I Barrand"
            ],
            "title": "GEANT4\u2014A simulation toolkit",
            "venue": "Nucl. Instrum. Methods Phys. Res. Sect. A Accel. Spectrometers Detect. Assoc. Equip",
            "year": 2003
        },
        {
            "authors": [
                "M. Raggi",
                "V. Kozhuharov",
                "P. Valente"
            ],
            "title": "The PADME experiment at LNF",
            "venue": "EPJ Web Conf",
            "year": 2015
        },
        {
            "authors": [
                "P. Albicocco",
                "R. Assiro",
                "F. Bossi",
                "P. Branchini",
                "B. Buonomo",
                "V. Capirossi",
                "E. Capitolo",
                "C. Capoccia",
                "A.P. Caricato",
                "S Ceravolo"
            ],
            "title": "Commissioning of the PADME experiment with a positron beam",
            "venue": "arXiv 2022,",
            "year": 2022
        },
        {
            "authors": [
                "R. Assiro",
                "A.P. Caricato",
                "G. Chiodini",
                "M. Corrado",
                "M. De Feudis",
                "C. Di Giulio",
                "G. Fiore",
                "L. Foggetta",
                "E. Leonardi",
                "M Martino"
            ],
            "title": "Performance of the diamond active target prototype for the PADME experiment at the DAPHNE BTF",
            "venue": "Nucl. Instrum. Methods Phys. Res. Sect. A Accel. Spectrometers Detect. Assoc",
            "year": 2018
        },
        {
            "authors": [
                "F. Ferrarotto",
                "L. Foggetta",
                "G. Georgiev",
                "P. Gianotti",
                "V. Kozhuharov",
                "E. Leonardi",
                "G. Piperno",
                "M. Raggi",
                "C. Taruggi",
                "L Tsankov"
            ],
            "title": "Performance of the Prototype of the Charged-Particle Veto System of the PADME Experiment",
            "venue": "IEEE Trans. Nucl. Sci",
            "year": 2018
        },
        {
            "authors": [
                "P. Albicocco",
                "J. Alexander",
                "F. Bossi",
                "P. Branchini",
                "B. Buonomo",
                "C. Capoccia",
                "E. Capitolo",
                "G. Chiodini",
                "A.P. Caricato",
                "R de Sangro"
            ],
            "title": "Characterisation and performance of the PADME electromagnetic calorimeter",
            "venue": "J. Instrum",
            "year": 2020
        },
        {
            "authors": [
                "A. Frankenthal",
                "J. Alexander",
                "B. Buonomo",
                "E. Capitolo",
                "C. Capoccia",
                "C. Cesarotti",
                "R. De Sangro",
                "C. Di Giulio",
                "F. Ferrarotto",
                "L Foggetta"
            ],
            "title": "Characterization and performance of PADME\u2019s Cherenkov-based small-angle calorimeter",
            "venue": "Nucl. Instrum. Methods Phys. Res. Sect. A Accel. Spectrometers Detect. Assoc. Equip",
            "year": 2019
        },
        {
            "authors": [
                "R. Brun",
                "F. Rademakers"
            ],
            "title": "ROOT: An object oriented data analysis framework",
            "venue": "Nucl. Instrum. Methods Phys. Res. Sect. A Accel. Spectrometers Detect. Assoc. Equip",
            "year": 1997
        },
        {
            "authors": [
                "M. Abadi",
                "A. Agarwal",
                "P. Barham",
                "E. Brevdo",
                "Z. Chen",
                "C. Citro",
                "G.S. Corrado",
                "A. Davis",
                "J. Dean",
                "M. Devin",
                "et al. TensorFlow"
            ],
            "title": "Large-Scale Machine Learning on Heterogeneous Systems",
            "venue": "2015. Available online: https://tensorflow.org",
            "year": 2022
        },
        {
            "authors": [
                "K. O\u2019Shea",
                "R. Nash"
            ],
            "title": "An Introduction to Convolutional Neural Networks",
            "venue": "arXiv 2015,",
            "year": 2015
        },
        {
            "authors": [
                "Zhang",
                "Y. A better autoencoder for image"
            ],
            "title": "Convolutional autoencoder",
            "venue": "In Proceedings of the ICONIP17-DCEC, Guangzhou, China, 14\u201318 October 2017. Available online: http://users.cecs.anu.edu.au/~Tom.Gedeon/conf/ABCs2018/paper/ABCs2018_ paper_58.pdf",
            "year": 2022
        }
    ],
    "sections": [
        {
            "text": "Citation: Dimitrova, K.; on behalf of\nthe PADME Collaboration. Using\nArtificial Intelligence in the\nReconstruction of Signals from the\nPADME Electromagnetic Calorimeter.\nInstruments 2022, 6, 46. https://doi.\norg/10.3390/instruments6040046\nAcademic Editors: Fabrizio Salvatore,\nAlessandro Cerri, Antonella De Santo\nand Iacopo Vivarelli\nReceived: 1 August 2022\nAccepted: 13 September 2022\nPublished: 21 September 2022\nPublisher\u2019s Note: MDPI stays neutral\nwith regard to jurisdictional claims in\npublished maps and institutional affil-\niations.\nCopyright: \u00a9 2022 by the authors.\nLicensee MDPI, Basel, Switzerland.\nThis article is an open access article\ndistributed under the terms and\nconditions of the Creative Commons\nAttribution (CC BY) license (https://\ncreativecommons.org/licenses/by/\n4.0/).\nKeywords: dark photon; calorimetry; signal reconstruction; machine learning"
        },
        {
            "heading": "1. Introduction",
            "text": "In recent years, the search for an explanation of the Dark Matter phenomenon has led to the development of various hypotheses for an extension of the Standard Model, e.g., Weakly Interacting Massive Particles (WIMPs) [1]. However, the non-observation of new states with mass in the order of 100 GeV led scientists to explore other Dark Matter explanations. The main goal of PADME (Positron Annihilation into Dark Matter Experiment) [2] is to search for the dark photon A\u2032, a hypothetical gauge boson connecting the dark and the visible sector. In the case of non-vanishing interaction strength \u03b1\u2032 with the electrons, A\u2032 can be produced in the annihilation process of beam positrons with electrons from the target:\ne+e\u2212 \u2192 A\u2032\u03b3. (1)\nKnowing the four-momenta of the beam\u2019s positrons, the electrons at rest and the photon produced in the process, the missing mass of the dark photon can be calculated:\nM2miss = (Pe+ + Pe\u2212 \u2212 P\u03b3)2. (2)\nThe positron beam provided by the DA\u03a6NE LINAC [3] can reach energies up to 550 MeV, providing a limit for the missing mass of 23.7 MeV, and is composed of bunches with a 50 Hz rate. Each bunch contains about 2\u00d7 104 particles and its length can be varied with typical values of 200\u2013300 ns.\nInstruments 2022, 6, 46. https://doi.org/10.3390/instruments6040046 https://www.mdpi.com/journal/instruments\nThe two main processes contributing to the background, are the annihilation e+e\u2212 \u2192 \u03b3\u03b3(\u03b3) and Bremsstrahlung events e+N \u2192 e+N\u03b3. To suppress the background from e+e\u2212 \u2192 \u03b3\u03b3(\u03b3), the PADME experiment should have high photon detection efficiency, while for the rejection of e+N \u2192 e+N\u03b3, the radiating positron should be detected and a reliable matching in time between the positron and the emitted photon should be assured. The initial studies based on a full Geant4 [4] simulation indicate that the PADME experiment can reach sensitivies in \u03b1\u2032 down to 10\u22128 [5] with high-efficiency detectors (greater than 99%) and time resolution better than 1 ns. In addition, due to the high bunch multiplicity, double-pulse separation capabilities are required for each of the chosen detectors."
        },
        {
            "heading": "2. The Padme Experiment",
            "text": "A sketch of the PADME experiment is shown in Figure 1. A short description of its major detector components [6] follows."
        },
        {
            "heading": "2.1. Active Target",
            "text": "The target [7] is composed of polycrystalline diamond (Z = 6) since low Z is required to increase the annihilation to bremsstrahlung cross-section ratio. The target has a 100 \u00b5m thickness and 20 mm width and length. Apart from providing the target for the annihilation process, it also measures the beam\u2019s multiplicity and XY profile. For this reason 16 horizontal and 16 vertical graphite electrodes of 1 mm width are engraved onto the target using an excimer laser."
        },
        {
            "heading": "2.2. Charged Particle Detectors",
            "text": "Three sets of detectors register the charged particles. The beam positrons may lose energy in the target and produce Bremsstrahlung photons, detected by the electromagnetic calorimeter, which need to be rejected. This is achieved by coinciding these photons with the particles that produced them. These particles are detected by the positron and high energy positron vetoes. In case the A\u2032 decays into an e+e\u2212 pair, the electron will be registered by the electron veto. All three charged particle detectors are composed of 10\u00d7 10\u00d7 178 mm3 plastic scintillators with WLS fibers coupled to 3\u00d7 3 mm2 Hamamatsu S13360 silicon photomultipliers with 25 \u00b5m pixel size and are placed in 10\u22125 mbar vacuum. The positron and the electron vetoes are located inside the magnet and are composed of 90 and 96 scintillating bars, respectively. Both detect particles with momenta between\n50 and 450 MeV. The high energy positron veto is located next to the beam exit window and is composed of 16 scintillating bars, with scintillation light read out on both sides. It allows the detection of positrons with momenta between 450 and 500 MeV.\nThe charged particle detectors segmentation provides measurement of the e+/e\u2212\nmomentum with a resolution of \u22485%. The time resolution is 700 ps [8]."
        },
        {
            "heading": "2.3. Calorimeters",
            "text": "The PADME calorimetric system is composed of an Electromagnetic Calorimeter (ECal) and a small-angle calorimeter (SAC). The ECal (Figure 2) is composed of 616 BGO cystals measuring 2.1\u00d7 2.1\u00d7 23 cm3, connected to HZC 1912 photomultipliers. The optical isolation of the crystals is achieved by covering them with diffuse reflective TiO2 paint and additionally with 50\u2013100 \u00b5m thin black Tedlar foils. The ECal is placed 3.45 m away from the target and has a radius of 29 cm, thus achieving an angular coverage between 15 and 84 mrad. The lower limit is due to a square hole in its center, which is covered by the SAC. The scintillation light decay time is 300 ns. Calibration was performed both with a 22Na source before constructing the calorimeter and then subsequently with cosmic rays. The energy resolution is \u223c7% at E\u03b3 = 100 MeV [9].\nThe Small Angle Calorimeter (SAC) [10] is located downstream of the ECal and mainly detects photons produced by Bremsstrahlung events. To suppress this type of background, the data from the SAC is matched in time with the data from the charged particle detectors. In addition, the SAC detects photons from multiphoton annihilation events. The SAC is composed of 25 PbF2 crystals measuring 3\u00d7 3\u00d7 14 cm3 and covers an angle between 0 and 15 mrad."
        },
        {
            "heading": "2.4. Readout System",
            "text": "The PADME Data Acquisition System consists of 29 CAEN V1742 ADC boards, each equipped with 32 analog and 2 trigger input channels. The V1742 switch capacitor digitizer employs the DRS4 chip, capable of sampling the input signal at 750 MS/s, 1 GS/s, 2.5 GS/s, and 5 GS/s. Complete waveforms of 1024 samples for each channel are recorded upon a beam-based trigger signal. In the case of the electromagnetic calorimeter which is sampled at 1 GS/s, this corresponds to a \u22481 \u00b5s recorded waveform."
        },
        {
            "heading": "3. Application of Neural Networks for Waveform Description",
            "text": "The high multiplicity of the positron beam in combination with the short bunch duration leads to many overlapping or close-in-time signals recorded in a single event. One way to solve this problem is to use neural networks (NNs) to count the signals from\nthe electromagnetic calorimeter in each event, to identify and separate overlapping signals, and to extract signal parameters\u2014the arrival times of the individual signals and their amplitudes. To train the NNs, an event simulation was developed. Each event represents a waveform of 1024 samples, for which the number of signals as well as the individual signal parameters can be varied. Various sets of waveforms A(t) were generated, containing a random number of signals with shapes defined by the subtraction of two exponents\nA(t) = A0(e\u2212(t\u2212t0)/\u03c41 \u2212 e\u2212(t\u2212t0)/\u03c42), t \u2265 t0, (3)\nwhere t0 is the arrival time of the signal, \u03c41 is the signal decay time, taken to be 300 ns, and \u03c42 is related to the signal rise time, taken to be 10 ns. These values are typical for the PADME PMT + BGO crystal assembly. A0 is the signal amplitude parameter, chosen to follow a Gaussian distribution. The arrival time follows a uniform distribution with a minimum value of t0 = 100 ns, to account for the trigger specifications. For the training of the networks presented here, a mean value A0 = 200 mV with \u03c3 = 200 mV was used and an additional lower limit A0 > 20 mV was set. The signals from the ECal are digitised by an ADC with 1 V dynamic range, which should be sufficient for the maximal energy cell within an electromagnetic shower. Since the selected photon energy is between 50 MeV and 450 MeV, a 200 mV mean amplitude was chosen to increase the training statistics to signals corresponding to the 100 MeV range. All waveforms include a Gaussian noise with a mean value of 10 mV added in each bin. A predefined maximum number of four signals was used for all generated waveforms. Many of the events, recorded by the ECal contain only one or two signals, however, there are events with more recorded signals which requires the inclusion of such cases in the training. Different NNs were trained on the thus generated events and each network is trained on 100,000 events. For the implementation of all neural networks presented in this study and for the output analysis were used the ROOT [11], TensorFlow [12] and Keras [13] frameworks. Three different convolutional neural networks (CNNs) [14] were developed, starting with the classification task of dividing the events into categories based on the number of signals in them and moving to regression tasks with the aim of signal parameter estimation. The first CNN performs a classification task aimed at counting the number of signals in each waveform. It consists of a single convolutional layer, followed by three fully connected layers. This network was trained using labels containing only information about the number of signals in each event. The obtained model was then applied for the simulated set of events with two generated signals and the output was compared to the true labels. Figure 3 shows the efficiency of the signal counting as a function of \u2206t = |t2 \u2212 t1| where t2 and t1 are the arrival times of the two signals. The efficiency is 50% for \u2206t = 10 ns and 100% for \u2206t > 50 ns.\n(1+exp(\u2212\u2206t/70) \u2212 0.5) is fitted (red). For signals\nwith \u2206t = 10 ns, the efficiency is 50%. The efficiency reaches 100% for \u2206t > 50 ns.\nThe estimation of signal parameters requires the development of networks with more complex architectures. Convolutional autoencoders [15] can be used for extracting useful data from waveforms. An autoencoder was developed with the targeted output replicating the original waveform. The neural network architecture consists of three convolutional layers followed by three deconvolutional layers with the same parameters and a single final deconvolutional layer for setting the output dimensions. Figure 4 (left) shows an example of the original and the output waveform for an event with two signals. It is observed that such networks can reproduce the signals, which represents the main motivation for applying this architecture for signal parameter estimation through supervised learning.\nA modified autoencoder trained on labeled data was developed with training based on output arrays of the same length as the input waveforms. On the positions of signal arrival, the value is set to the signal amplitude and all other values are set to 0. An example of the output of the modified autoencoder and its corresponding waveform is presented in Figure 4 (right). To assess the modified autoencoder output and compare it with the original data labels, a reconstruction algorithm was developed. The data labels contain an array of 1024 numbers with a single non-zero amplitude value at the arrival time t0 for each generated signal. The NN output gives multiple amplitude values over a number of time positions for each recognised signal, usually with a maximum on the most probable position and decreasing values on both of its sides. The reconstruction algorithm locates the maximum and adds the values of the three positions before it and the three positions after it to the maximum value. The result is taken to be the amplitude of the reconstructed signal and the time position of the maximum is taken to be the arrival time of this signal. The reconstruction is also applied to the original data labels and the results for the reconstructed output are then compared to them. This allows both for comparison of the amplitude value of the original and reconstructed signal, as well as evaluation of the arrival time and analysis of the neural network efficiency."
        },
        {
            "heading": "4. Signal Parameter Reconstruction",
            "text": "The probability for a signal to be discriminated and the accuracy of the reconstructed signal parameters were studied. The modified autoencoder model was trained on a set of 100,000 events with up to four signals each and was applied to a statistically independent test set, again with 100,000 events containing up to four signals."
        },
        {
            "heading": "4.1. Time Reconstruction",
            "text": "To study the double-pulse separation abilities of the machine learning algorithm, each simulated signal is associated with the closest-in-time one from the NN output. The left panel in Figure 5 represents the difference between the reconstructed and the original time\nof the signal arrival. The distribution of this difference (Figure 5, right panel) is symmetric, with \u03c3 \u223c 520 ps and RMS \u223c 3.2 ns if assumed Gaussian, however, non-Gaussian tails do exist.\nA signal is considered successfully identified if the difference between the original and reconstructed output is less than 2 ns."
        },
        {
            "heading": "4.2. Signal Recognition",
            "text": "Figure 6 shows all of the events in the test set, divided into bins based on the number of reconstructed signals and the originally generated ones. Ideally, these two numbers should be the same for all events. However, two major factors influence signal discrimination: a small difference in signal arrival time may cause two or more signals to be merged into one and signals with small amplitudes may not be identified above the noise.\nSignals with time differences less than 10 ns are merged into a single hit and most events with amplitudes smaller than 50 mV are not likely to be identified, which results in decreased efficiency, as seen in Figure 7."
        },
        {
            "heading": "4.3. Amplitude Reconstruction",
            "text": "The developed CNN provides reconstruction of the signal amplitude values. The reconstructed versus the original amplitudes for the successfully identified signals are shown in the left panel of Figure 8. The correlation is well pronounced. To quantitatively compare the quality of signal identification, the average difference between the reconstructed and the true amplitude value for each 2 mV interval of generated amplitude is shown in the right panel of Figure 8.\nThe inaccuracy of the small amplitude values can be compensated for by a dedicated calibration of the NN output."
        },
        {
            "heading": "5. Conclusions",
            "text": "The high particle rate in the PADME calorimeter requires implementation of advanced reconstruction algorithms to achieve less than 1 ns time resolution of the reconstructed showers. Machine learning methods were applied for the successful identification of calorimeter signals and for the extraction of signal parameters. A CNN with a single convolutional layer was used to count the number of signals in an event. A modified CNN autoencoder was probed for the estimation of signal parameters\u2014arrival time and amplitude. The performance of the networks was assessed through a specially designed algorithm, comparing the network output with the original data labels. The CNN provides time reconstruction with \u223c500 ps time resolution and the amplitude is reconstructed in the 30\u2013700 mV range. There is an inaccuracy for amplitudes less than 100 mV, which can be solved by an additional calibration of the NN output or by developing networks with modified architectures specifically targeting small amplitudes.\nAuthor Contributions: The presented material is a result of the joint work of the PADME collaboration. All authors have read and agreed to the published version of the manuscript.\nFunding: This work was partially supported by BNSF: KP-06-D002_4/15.12.2020 within MUCCA, CHIST-ERA-19-XAI-009 and by LNF-SU MoU.\nData Availability Statement: Not applicable.\nConflicts of Interest: The authors declare no conflict of interest."
        }
    ],
    "title": "Using Artificial Intelligence in the Reconstruction of Signals from the PADME Electromagnetic Calorimeter",
    "year": 2022
}