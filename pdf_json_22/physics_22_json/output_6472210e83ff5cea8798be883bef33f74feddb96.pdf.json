{
    "abstractText": "Spikes are some obvious sharp increases that appear on the raw light curves of Insight-HXMT\u2019s High Energy X-ray telescope(HE), which could have influences on data products like energy and power spectra. They are considered to be fake triggers generated by large signals. In this paper, we study the spikes\u2019 characteristic and propose two methods to remove spikes from the raw data. According to the different influences on energy and power spectra, the best parameters for removing the spikes is selected and used in the Insight-HXMT data analysis software. The generation mechanism of spikes is also studied using the backup HE detectors on ground and the spikes can be reduced by the electronic design.",
    "authors": [
        {
            "affiliations": [],
            "name": "Baiyang Wu"
        },
        {
            "affiliations": [],
            "name": "Yifei Zhang"
        },
        {
            "affiliations": [],
            "name": "Haisheng Zhao"
        },
        {
            "affiliations": [],
            "name": "Jinlu Qu"
        }
    ],
    "id": "SP:8f03da8f51bdd4f590b122326d4486c86fb4defe",
    "references": [
        {
            "authors": [
                "X. Li",
                "Y. Tan",
                "Y. Yang",
                "M. Ge",
                "J. Zhang",
                "Y. Tuo",
                "B. Wu",
                "J. Liao",
                "Y. Zhang",
                "L. Song",
                "S. Zhang",
                "J. Qu",
                "S. nan Zhang",
                "F. Lu",
                "Y. Xu",
                "C. Liu",
                "X. Cao",
                "Y. Chen",
                "J. Nie",
                "H. Zhao",
                "C. Li"
            ],
            "title": "In-flight calibration of the insight-hard x-ray modulation telescope",
            "year": 2020
        },
        {
            "authors": [
                "Affiliations Baiyang Wu"
            ],
            "title": "qujl@ihep.ac.cn 1 Key Laboratory for Particle Astrophysics, Institute of High Energy Physics, Chinese Academy of Sciences, Beijing 100049, China 2 University of Chinese Academy of Sciences, Chinese Academy of Sciences, Beijing",
            "venue": "Astrophysical Journal 272,",
            "year": 1983
        }
    ],
    "sections": [
        {
            "text": "Keywords HXMT \u00b7 PMT \u00b7 spikes"
        },
        {
            "heading": "1 Introduction",
            "text": "The Hard X-ray Modulation Telescope (HXMT), dubbed Insight-HXMT, successfully launched on June 15, 2017[1][2]. It is China\u2019s first X-ray astronomy satellite devoted to broad band observations in the 1\u2013250 keV. It carries three main telescopes: High Energy X-ray telescope (HE) using an array of NaI(Tl)/CsI(Na) scintillation detectors[3], covering the 20\u2013250 keV energy band, Medium Energy X-ray telescope (ME) using an array of Silicon PositiveIntrinsic-Negative (Si-PIN) detectors in the 5\u201330 keV band [4], and Low Energy X-ray detector (LE) using an array of Swept Charge Device (SCD) detectors in the 1\u201315 keV band[5].\nXiaobo Li, Liming Song E-mail: lixb@ihep.ac.cn, songlm@ihep.ac.cn\nar X\niv :2\n20 2.\n08 99\n7v 1\n[ as\ntr o-\nph .I\nM ]\n1 8\nFe b\n20 22\nWe will give a short description of HE. HE utilizes 18 NaI(Tl)/CsI(Na) phoswich as the main detectors with diameter of 190 mm. The thicknesses of NaI(Tl) and CsI(Na) are about 3.5 mm and 40 mm, respectively. The particle with most of its energy deposited in NaI(Tl) is regarded as a NaI(Tl) event. The scintillation photons generated in the two crystals can be collected by a shared photomultiplier tube (PMT). Signals from the PMT can be distinguished NaI(Tl) events and CsI(Na) events due to the different decay time in the two crystals. The energy loss, time of arrival and pulse width of each detected event are measured and digitized. The CsI(Na) can be used as a gamma-ray burst (GRB) monitor. The detected energy band in high gain mode is about 50\u2013800 keV and 250 keV\u20133 MeV in low gain mode for CsI(Na) if the high voltage of PMT is decreased[2]. The spikes in low gain mode can be ignored because the large signals have been greatly reduced, thus we focus on the spikes happened in high gain mode.\nThere are similar spikes that have been found on other detectors or experiments which have provided some explanations to the generation of spikes. The hard x-ray detector of Astro-E appears fake pre-trigger signals which are due to after pulses of the photomultiplier[6]. Photomultiplier tube would produce signal-induced noises that are usually considered to be the electron cloud that surrounds the photocathode or the fluorescence that is induced by ions striking the glass envelope of the PMT[7]. There are also more delayed after pulses that are possible results of the phosphorescence of glass or other insulators with activation energies well above kT[8]. In addition, space charge effects and statistical fluctuations in the background[9] also contribute the spikes.\nSince HE detectors also consist of crystal components and PMTs, similar effects may cause spikes. According to our ground experiments (we describe details in section 4), we have found large signals would cause a series of effects that are mentioned above. These effects make large signals come out from the PMT with long tails which cause electronics continuously triggered and counted repeatedly, and finally spikes are appeared on the light curves.\nSpikes could distort the shape of energy spectrum and power spectrum of the events. In order to obtain the spikes removed data products, we explore two methods to remove spike events and find out the optimal parameters in this paper. We structure our paper as follows. In section 2, we describe how we use the observed data to study the spikes\u2019 features. In section 3, two methods of removing spikes are described and compared to find the best parameters for the data analysis of HXMT. The experiments setup is described to study the generation and reduction of spikes using the backup HE detectors on ground in section 4. In section 5, we give a conclusion and discussion."
        },
        {
            "heading": "2 The features of HE spikes",
            "text": "Since the spikes are often appeared in the high gain mode of HE detectors, a lot of pointing observations of Crab and blank sky have been selected to analysis the features of spikes. The observation log of the data is summarized in table 1*. As an example of spikes, a fragment of the raw light curve of one Crab observation with exposure time of about 2000 seconds is plotted in Figure 1. The light curves of detector 0 and detector 1 are plotted respectively to show that the spikes occur in different detectors independently. We can see there are some apparent spikes whose counts are much larger than the statistic fluctuations on the raw light curve.\nIn order to explore the characteristic of the spikes, some sharp and prominent spikes are selected from the raw data. The distributions of pulse heights\n* All Insight-HXMT data used in this work are publicly available and can be downloaded from the official website of Insight-HXMT: http://archive.hxmt.cn/proposal.\n(PHA) and pulse widths of spikes are shown in Figure 2. It is clear that most of pulse heights of spikes are between the pulse height threshold (20) and 35 channel. Meanwhile, the distribution of pulse widths covers the range from 40 to 120 channel, where one channel means the pulse width of 20.8 ms. Most of events with pulse widths under 70 channel are NaI events and the widths higher than 80 channel are CsI events. The distribution of pulse width indicates that spikes come from both NaI(Tl) and CsI(Na). The distribution of time intervals between two adjacent events is shown in Figure 3. An obvious deviation from the exponential distribution can be found in the range of less than 200\u00b5s. We consider this deviation comes from the contributions of the spikes. This characteristic of HE spikes can be summarized as:\n\u2013 Most of the pulse heights for spikes is less than 35 channel. \u2013 Pulse width covers the range of NaI(Tl) and CsI(Na) events. \u2013 Most of the time intervals between two adjacent events are less than 200 us."
        },
        {
            "heading": "3 Methods of removing spikes and their influences",
            "text": "3.1 Two methods to remove spike-like events\nSpikes are some unusually dense events with shorter time intervals than normal events, we have come up with two methods to remove events that may be spikes. We mark a raw time series as To, which contains all events, marked as t1, t2, ...ti, ti+1, ..., tN , N is the total number of these events.\nThe first method to remove spikes is that if there is a number of consecutive events, ti, ti+1, ..., ti+n, where ti+n-ti < tf and n+ 1 \u2265 nf , we remove this consecutive events, i.e, we remove\nthese n+1 events. tf and nf can be determined empirically. For simplicity, we call this method as method 1.\nThe second method (method 2) requires more than ns consecutive events where each time interval between two consecutive events is less than ts, we remove these events that meet the conditions. ts and ns can also be determined empirically.\nFor each method to remove spike-like events, we basically follow these steps to analysis its effects. We choose a set of parameters, tf , nf for the first method and ns, ts for the second one. The events satisfied these specific parameters are regarded as the spike-like events and would be removed from the event file.\nAfter removing the spike-like events, a new time series can be obtained as Tr. We analyse the new time series through three aspects: light curve, power spectrum and energy spectrum. For each method we have utilized several sets\nof parameters which are listed in Table 2 and 3. The percentages of events that remain after removing \u201dspikes\u201d to the original events number are listed in the third column of Table 2 and 3.\nWe show some of the new light curves that have been removed spike-like events using method 1 in Figure 4, and their corresponding \u201cspike\u201d light curves are plotted in figure 5. Other light curves with parameters shown in table 2 have been omitted since they lost too many normal events. We can see that there are normal events and no sharp spikes on all the new light curves. The percentage of events left is shown in Table 2.\nSimilarly, the light curves of spike-like events removed by using method 2 with relatively good parameters and spike-like events are displayed in Figure 6 and 7, respectively. We use method 2 to remove spikes with these sets of parameters and show them in Figure 6. The majority events are remained, and there are hardly spikes on new light curves. The percentage of events left\nis shown in Table 3.\n3.2 The influences of spikes on power spectra\nThe data we selected for spike analysis can be regarded as white noise dominated at higher frequencies. In addition, HE detectors have different dead times for different types of signal. The minimum of the dead time is about 3\u00b5s for the norm events and 20\u00b5s for the large events [10]. The small dead time will cause powers at frequencies with several thousand Hz a slight decrease. The decrease is relatively tiny and the influence of dead time can be\nignored when we focus on the spikes. As a consequence, we expect a frequency power spectrum without spikes would be distributed as a \u03c72 random variable with 2 degrees of freedom[11] and converge to 2 (Leahy normalization) [12].\nIn order to find out the influence of spikes to power spectrum, we filter the raw light curve as shown in the panel a) of Figure 8. We simulate a Poisson time series and take the counts of filtered curve as the expected values of Poisson function at each second. The new simulated light curve is displayed in the panel b) of Figure 8 and it has similar shape to the original one without spikes. Then the new light curve is used to simulate a event list by sampling the Poisson distribution. The corresponding power spectrum of the simulated event list in shown in Figure 9). Furthermore, we simulate a Poisson time series using a constant expected value, which is similar to the mean number of events as original light curve as shown in the panel c) of Figure 8. This light curve is used to simulate a event list using the same method above to calculate its power spectrum. The Leahy normalized power spectrum must be converged to 2. As a result, the generation of the simulated event list is verified for the power spectrum generation.\nThe power spectra of the three light curves as shown in Figure 8 are generated in Figure 9. The power spectrum of simulated data with constant expected value has power value around 2 at all the frequencies as expected. The\npower spectrum of the simulated data with filtered expected value has the same power-law structure with that of original data at low frequencies, but converges to 2 at high frequencies. Hence, the power-law structure at low frequencies of power spectrum is caused by the overall trend of the raw light curve, while the contribution of the spikes is the additional power between 0.1 Hz and 300 Hz which is higher than 2.\nSince we have obtained the expected power spectrum of the light curves without spikes, various parameters of the two methods listed above are applied to screen the raw data and compare the power spectra of the screen data to the expected power spectra. Some power spectra of these parameters deviate a lot from what we expect like the filtered power spectra as shown in Figure 9. Some of the power spectra are plotted in Figure 10 to show why these parameters are discarded. Among these power spectra, some show an average power level under 2, indicating that too many normal events have been removed, e.g. when using method 2 with ts=200\u00b5s, ns=4. On the contrary, some power spectra indicate that there are considerable spike events remaining in light curves which make the power higher than 2, e.g. when using method 1 with tf=1 ms, nf=7.\nWe select several pairs of parameters of the two methods as candidate to remove spikes. Their power spectra are displayed in Figure 11. However, we have noticed that at high frequencies, their power goes higher and being like bulges, especially when tf=1 ms, nf=6 and ts=300\u00b5s, ns=6. We think that this bulge is caused by the spikes that are still remained in the event list. According to these power spectra, method 2 with ts=200\u00b5s with ns=5 seams to be the best candidate to remove spikes.\n3.3 The influences of spikes on energy spectra\nThe effects of spikes on energy spectrum are compared only for these new time series whose power spectra are converge to 2 at high frequencies. Therefore, we choose tf = 1ms with nf = 6, ts=200\u00b5s with ns=5, ts=250\u00b5s with ns=5 and ts=300\u00b5s with ns=6, as candidate to remove spikes. The energy spectrum of raw events and spikes removed spectrum with different methods are shown in Figure 12. The ratio between each energy channel of the spikes removed spectra and the raw spectra are also displayed in the bottom panel of Figure 12.\nAs mentioned in section 2, the energy channel of most spike events are under 35 channel. The ratio between original spectrum and the new spectrum should be constant and close to 1 for channels above 40. Among these candidate, the events lost is minimal by using method 2 with ts=200\u00b5s, ns=5.\nTaking accounts of both power spectrum and energy spectrum, the optimal choice for removing the spikes is method 2 (ts=200\u00b5s with ns=5)."
        },
        {
            "heading": "4 The generation and reduction of spikes in HE",
            "text": "In order to find out the fake triggers in HE, an experiment base on a backup copy of HE detector is taken on ground. The HE detector (HED) is composed of a NaI(Tl)/CsI(Na) crystal, a PMT R877 and a charge sensitive amplifier. The full width at half maximum (FWHM) of a normal NaI(Tl) pulse is about 1.5 \u00b5s, while that of CsI(Na) is 2.5 \u00b5s.\nFigure 13 depicts a simplified readout circuit similar to the on-board data acquisition system of the HED. The signals coming from the HED are received by two followed one-unit amplifiers, between which a quick charge circuit is inset. After that the signals are sent to an Analog to Digital Converter (ADC). The points A and B are linked with the oscilloscope through two one-unit amplifiers, respectively, so as to measure the pulses in real time.\nWe will describe how the big signal generates the spikes in the following. As displayed in Figure 14, after a big pulse in point A, we find that some fake pulses in point B are induced from the fluctuation in steep tail of the big pulse in point A when a high energy charge particle such as a cosmic ray muon deposited large energy in NaI(Tl) or CsI(Na) crystal. So the fake pulses generated in point A can be larger than the threshold for point B and generate the spikes.\nIn order to study the origin of the spikes, two experiments have been tested. The signal generator is used to take the place of crystal and PMT to generate large signal, the tail of the big pulse is very smooth and no spikes occur. Then we use the LED as the light source to produce the fluorescent photons and illuminate the PMT, the tail of the big pulse will not be smooth, just as shown in the blue line of Figure 14. There are some fluctuations on the tail and the spikes appear in this situation. Therefore, the generation of HE spikes is originated from the PMT, and we also have found that if the high voltage of PMT is reduced in flight when HE is working at low gain mode, the spikes in the raw light curve will be very rare. This further proves that the generation of spikes is strongly related to the PMT.\nNumerical analysis shows that the quick discharge circuit makes a bad contribution. The current charge decay time is 100\u00b5s, larger than the fluctuation\ntime in the tail of big pulse. When the discharge circuit works, a down-up fluctuation in point A will become a pulse in point B with a height equal to its peak-to-peak value, almost double the average fluctuation value. In this way, a bigger fluctuation will be amplified and become a fake trigger when its height is above the normal threshold of 100 mV. We measure those big fluctuations in large signal tail and get an average decay time of about several microseconds. So a capacitance of 1 nF is chosen to shorten the discharge time. As shown in Figure 15, the induced fake pulse amplitude is reduced by more than two thirds, while the normal signal only reduced by one fourth. A smaller capacitance will further reduce signal amplitude and make it pulse width deviate from the design value, meanwhile the fake pulse amplitude will be reduced more. As the fluctuation in the big signal tail is induced by the PMT, it is hard to completely eliminate the spikes. In addition, since the telescope has been on-board, it is impossible to change the circuit, we could only remove\nspike events through data analysis methods while remaining valid events as many as possible."
        },
        {
            "heading": "5 Conclusion and discussion",
            "text": "Directly extracting light curves from raw events files of HE, we have noticed that there are spikes on them. These spikes are some obvious sharp increases on light curve, whose counts are significantly higher than statistical fluctuation. They are not valid x-ray or \u03b3 events, but results of fake triggers. According to the characteristic of the spikes and spikes\u2019 influences on power and energy spectra, we find a best choice (ts=200\u00b5s with ns=5) to remove the spikes.\nAccording to ground experiments, we also find that the spikes is caused by the large signal in flight which will produce a series of effects after they enter the PMT. These effects make large signals come out from the PMT with long tails which cause electronics continuously triggered and count repeatedly, and finally become spikes on light curve. If we improve the circuit design by changing the blocking capacitor to 1 nF which would greatly shorten the discharge time and these spikes will also significantly reduced. Since it is impossible to change the circuit when the telescope is on board, the data analysis method is required to remove spikes when producing data products. The method we introduce in this paper has been used in the Insight-HXMT data analysis software.\nThis work is supported by the National Natural Science Foundation of China under grants (No.U1838201, U1838202, U1838105, U1938102, U1938108, U2031205). This work made use of data from the Insight-HXMT mission, a project funded by China National Space Administration (CNSA) and the Chinese Academy of Sciences (CAS). We also thank the support from the Strategic Priority Program on Space Science, the Chinese Academy of Sciences, Grant No. XDA15020503.\nCompliance with Ethical Standards\nThe authors have no relevant financial or non-financial interests to disclose."
        }
    ],
    "title": "The removal method and generation mechanism of spikes in Insight-HXMT/HE telescope",
    "year": 2022
}