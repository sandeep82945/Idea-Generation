conclusion and future work This paper demonstrated the design, implementation, and evaluation of an architecture for compromised IoT node detection. The presented architecture has three important features. First, the concept of DT is utilized to only replicate relevant node information needed for malicious behavior detection. Second, classification is performed in the fog layer for low latency access to classifiers. Third, the architecture combines data anomaly and network intrusion detection methods for better coverage of malicious behavior detection leading to increased detection coverage. System evaluation of the architecture and the used classifiers demonestrates good accuracy as well as negligible overhead making it suitable for use in IoT solutions.