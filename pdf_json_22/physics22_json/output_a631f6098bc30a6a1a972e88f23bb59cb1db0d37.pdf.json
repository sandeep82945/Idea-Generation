{
    "abstractText": "Terahertz (THz) communication is widely deemed the next frontier of wireless networks owing to the abundant spectrum resources in the THz band. Whilst THz signals suffer from severe propagation losses, a massive antenna array can be deployed at the base station (BS) to mitigate those losses through beamforming. Nevertheless, a very large number of antennas increases the BS\u2019s hardware complexity and power consumption, and hence it can lead to poor energy efficiency (EE). To surmount this fundamental problem, we propose a novel array design based on superdirectivity and nonuniform inter-element spacing. Specifically, we exploit the mutual coupling between closely spaced elements to form superdirective pairs. A unique property of them is that all require the same excitation amplitude, and thus can be driven by a single radio frequency chain akin to conventional phased arrays. Moreover, they facilitate multi-port impedance matching, which ensures maximum power transfer for any beamforming angle. After addressing the implementation issues of superdirectivity, we show that the number of BS antennas can be effectively reduced without sacrificing the achievable rate. Simulation results demonstrate that our design offers huge EE gains compared to uncoupled arrays with uniform spacing, and hence could be a radical solution for future THz systems.",
    "authors": [
        {
            "affiliations": [],
            "name": "Konstantinos Dovelos"
        },
        {
            "affiliations": [],
            "name": "Stylianos D. Assimonis"
        },
        {
            "affiliations": [],
            "name": "Hien Quoc Ngo"
        },
        {
            "affiliations": [],
            "name": "Michail Matthaiou"
        }
    ],
    "id": "SP:0560ac3052e349eb456fefb72ebd3e71d6c17b31",
    "references": [
        {
            "authors": [
                "W. Roh"
            ],
            "title": "Millimeter-wave beamforming as an enabling technology for 5G cellular communications: Theoretical feasibility and prototype results,",
            "venue": "IEEE Commun. Mag., vol. 52,",
            "year": 2014
        },
        {
            "authors": [
                "S.D. Assimonis",
                "M.A.B. Abbasi"
            ],
            "title": "V",
            "venue": "Fusco, \u201cMillimeter-wave multimode circular antenna array for uni-cast multi-cast and OAM communication,\u201d Sci. Rep. 11, 4928",
            "year": 2021
        },
        {
            "authors": [
                "T.S. Rappaport"
            ],
            "title": "Wireless communications and applications above 100 GHz: Opportunities and challenges for 6G and beyond,",
            "venue": "IEEE Access,",
            "year": 2019
        },
        {
            "authors": [
                "M. Matthaiou"
            ],
            "title": "The road to 6G: Ten physical layer challenges for communications engineers,",
            "venue": "IEEE Commun. Mag.,",
            "year": 2021
        },
        {
            "authors": [
                "J. Zhang el al"
            ],
            "title": "Prospective multiple antenna technologies for beyond 5G,",
            "venue": "IEEE J. Sel. Areas Commun.,",
            "year": 2020
        },
        {
            "authors": [
                "H.J. Song",
                "N. Lee"
            ],
            "title": "Terahertz communications: Challenges in the next decade,",
            "venue": "IEEE Trans. THz Sci. Technol.,",
            "year": 2022
        },
        {
            "authors": [
                "E. Bj\u00f6rnson",
                "L. Sanguinetti",
                "J. Hoydis",
                "M. Debbah"
            ],
            "title": "Optimal design of energy-efficient multi-user MIMO systems: Is massive MIMO the answer?,",
            "venue": "IEEE Trans. Wireless Commun.,",
            "year": 2015
        },
        {
            "authors": [
                "O.E. Ayach",
                "R.W. Heath",
                "Jr.",
                "S. Abu-Surra",
                "S. Rajagopal",
                "Z. Pi"
            ],
            "title": "The capacity optimality of beam steering in large millimeter wave MIMO systems,",
            "venue": "in Proc. IEEE SPAWC,",
            "year": 2012
        },
        {
            "authors": [
                "A. Uzkov"
            ],
            "title": "An approach to the problem of optimum directive antenna design,",
            "venue": "Comptes Rendus (Doklady) de l\u2019Academie des Sci. de l\u2019URSS, vol. 53,",
            "year": 1946
        },
        {
            "authors": [
                "T.L. Marzetta"
            ],
            "title": "Super-directive antenna arrays: Fundamentals and new perspectives,",
            "venue": "in Proc. IEEE ACSSC,",
            "year": 2019
        },
        {
            "authors": [
                "L. Han",
                "H. Yin"
            ],
            "title": "and T",
            "venue": "L. Marzetta, \u201cCoupling matrix-based beamforming for superdirective antenna arrays,\u201d in Proc. IEEE ICC",
            "year": 2022
        },
        {
            "authors": [
                "M.L. Morris"
            ],
            "title": "Superdirectivity in MIMO systems,",
            "venue": "IEEE Trans. Antennas Propag.,",
            "year": 2005
        },
        {
            "authors": [
                "N.W. Bikhazi",
                "M.A. Jensen"
            ],
            "title": "The relationship between antenna loss and superdirectivity in MIMO systems,",
            "venue": "IEEE Trans. Wireless Commun.,",
            "year": 2007
        },
        {
            "authors": [
                "R.J. Williams",
                "E. de Carvalho",
                "T.L. Marzetta"
            ],
            "title": "A communication model for large intelligent surfaces,",
            "venue": "in Proc. IEEE ICC,",
            "year": 2020
        },
        {
            "authors": [
                "A.S.Y. Poon",
                "D.N.C. Tse"
            ],
            "title": "Does superdirectivity increase the degrees of freedom in wireless channels?,",
            "venue": "in Proc. IEEE ISIT,",
            "year": 2015
        },
        {
            "authors": [
                "H. Li",
                "M. Li",
                "Q. Liu"
            ],
            "title": "Hybrid beamforming with dynamic subarrays and low-resolution PSs for mmWave MU-MISO systems,",
            "venue": "IEEE Trans. Commun.,",
            "year": 2020
        },
        {
            "authors": [
                "L. Yan",
                "C. Han",
                "J. Yuan"
            ],
            "title": "A dynamic array-of-subarrays architecture and hybrid precoding algorithms for terahertz wireless communications,",
            "venue": "IEEE J. Sel. Areas Commun.,",
            "year": 2020
        },
        {
            "authors": [
                "L. Zakrajsek"
            ],
            "title": "Design of graphene-based plasmonic nano-antenna arrays in the presence of mutual coupling,",
            "venue": "in Proc. EuCAP,",
            "year": 2017
        },
        {
            "authors": [
                "C. Han",
                "J.M. Jornet"
            ],
            "title": "and I",
            "venue": "Akyildiz, \u201cUltra-massive MIMO channel modeling for graphene-enabled terahertz-band communications,\u201d in Proc. IEEE VTC Spring",
            "year": 2018
        },
        {
            "authors": [
                "K. Dovelos",
                "S.D. Assimonis",
                "H.Q. Ngo",
                "B. Bellalta",
                "M. Matthaiou"
            ],
            "title": "Intelligent reflecting surfaces at terahertz bands: Channel modeling and analysis,",
            "venue": "in Proc. IEEE ICC,",
            "year": 2021
        },
        {
            "authors": [
                "Z. Chen"
            ],
            "title": "Intelligent reflecting surface assisted terahertz communications toward 6G,",
            "venue": "IEEE Wireless Commun.,",
            "year": 2021
        },
        {
            "authors": [
                "R. Goossens",
                "H. Rogier"
            ],
            "title": "Optimal beamforming in the presence of mutual coupling,",
            "venue": "in Proc. IEEE SCVT,",
            "year": 2006
        },
        {
            "authors": [
                "C.A. Balanis"
            ],
            "title": "Antenna Theory: Analysis and Design",
            "venue": "3rd ed., John Wiley & Sons",
            "year": 2012
        },
        {
            "authors": [
                "M.T. Ivrla\u010d",
                "J.A. Nossek"
            ],
            "title": "High-efficiency super-gain antenna arrays,",
            "venue": "in Proc. Int. ITG WSA,",
            "year": 2010
        },
        {
            "authors": [
                "M.T. Ivrla\u010d",
                "J.A. Nossek"
            ],
            "title": "Toward a circuit theory of communication,",
            "venue": "IEEE Trans. Circuits Syst.,",
            "year": 2010
        },
        {
            "authors": [
                "D.M. Pozar"
            ],
            "title": "Microwave Engineering",
            "venue": "John Wiley & Sons",
            "year": 2009
        },
        {
            "authors": [
                "M.T. Ivrla\u010d",
                "J.A. Nossek"
            ],
            "title": "The multiport communication theory,",
            "venue": "IEEE Circuits Syst. Mag.,",
            "year": 2014
        },
        {
            "authors": [
                "S. Shen",
                "R.D. Murch"
            ],
            "title": "Impedance matching for compact multiple antenna systems in random RF fields,",
            "venue": "IEEE Trans. Antennas Propag.,",
            "year": 2016
        },
        {
            "authors": [
                "T. Laas",
                "J.A. Nossek",
                "W. Xu"
            ],
            "title": "Limits of transmit and receive array gain in massive MIMO,",
            "venue": "in Proc. IEEE WCNC,",
            "year": 2020
        },
        {
            "authors": [
                "S.D. Assimonis",
                "T.V. Yioultsis",
                "C.S. Antonopoulos"
            ],
            "title": "Design and optimization of uniplanar EBG structures for low profile antenna applications and mutual coupling reduction,",
            "venue": "IEEE Trans. Antennas Propag., vol. 60,",
            "year": 2012
        },
        {
            "authors": [
                "X. Yang"
            ],
            "title": "Hardware-constrained millimeter-wave systems for 5G: Challenges, opportunities, and solutions,",
            "venue": "IEEE Commun. Mag.,",
            "year": 2019
        },
        {
            "authors": [
                "X. Gao"
            ],
            "title": "Fast channel tracking for terahertz beamspace massive MIMO systems,",
            "venue": "IEEE Trans. Veh. Technol.,",
            "year": 2017
        },
        {
            "authors": [
                "C. Lin",
                "G.Y. Li"
            ],
            "title": "Indoor terahertz communications: How many antenna arrays are needed?,",
            "venue": "IEEE Trans. Wireless Commun.,",
            "year": 2015
        },
        {
            "authors": [
                "C. Han",
                "A.O. Bicen",
                "I.F. Akyildiz"
            ],
            "title": "Multi-ray channel modeling and wideband characterization for wireless communications in the terahertz band,",
            "venue": "IEEE Trans. Wireless Commun.,",
            "year": 2015
        },
        {
            "authors": [
                "L.N. Ribeiro",
                "S. Schwarz",
                "M. Rupp",
                "A.L.F. de Almeida"
            ],
            "title": "Energy efficiency of mmWave massive MIMO precoding with low-resolution DACs,",
            "venue": "IEEE J. Sel. Topics Signal Process.,",
            "year": 2018
        },
        {
            "authors": [
                "E. Bj\u00f6rnson",
                "J. Hoydis",
                "L. Sanguinetti"
            ],
            "title": "Massive MIMO Networks: Spectral",
            "venue": "Energy, and Hardware Efficiency, Foundations and Trends in Signal Processing: vol. 11, no. 3\u20134, pp. 154\u2013655",
            "year": 2017
        },
        {
            "authors": [
                "M.T. Ivrla\u010d",
                "J.A. Nossek"
            ],
            "title": "Physical modeling of communication systems in information theory,",
            "venue": "in Proc. IEEE ISIT,",
            "year": 2009
        },
        {
            "authors": [
                "C. Hermosilla",
                "R. Feick",
                "R.A. Valenzuela",
                "L. Ahumada"
            ],
            "title": "Improving MIMO capacity with directive antennas for outdoor-indoor scenarios,",
            "venue": "in Proc. IEEE VTC,",
            "year": 2008
        },
        {
            "authors": [
                "T.L. Marzetta",
                "E.G. Larsson",
                "H. Yang",
                "H.Q. Ngo"
            ],
            "title": "Fundamentals of Massive MIMO",
            "venue": "Cambridge, U.K.: Cambridge Univ. Press",
            "year": 2016
        },
        {
            "authors": [
                "K. Dovelos",
                "M. Matthaiou",
                "H.Q. Ngo",
                "B. Bellalta"
            ],
            "title": "Channel estimation and hybrid combining for wideband terahertz massive MIMO systems,",
            "venue": "IEEE J. Sel. Areas Commun.,",
            "year": 2021
        },
        {
            "authors": [
                "J. Lee",
                "G.-T. Gil",
                "Y.H. Lee"
            ],
            "title": "Exploiting spatial sparsity for estimating channels of hybrid MIMO systems in millimeter wave communications,",
            "venue": "in Proc. IEEE GLOBECOM,",
            "year": 2014
        },
        {
            "authors": [
                "O.E. Ayach",
                "S. Rajagopal",
                "S. Abu-Surra",
                "Z. Pi",
                "R.W. Heath",
                "Jr."
            ],
            "title": "Spatially sparse precoding in millimeter wave MIMO systems,",
            "venue": "IEEE Trans. Wireless Commun.,",
            "year": 2014
        },
        {
            "authors": [
                "T.J. Brockett",
                "Y. Rahmat-Samii"
            ],
            "title": "Subarray design diagnostics for the suppression of undesirable grating lobes,",
            "venue": "IEEE Trans. Antennas Propag.,",
            "year": 2012
        },
        {
            "authors": [
                "V. Petrov",
                "D. Moltchanov",
                "Y. Koucheryavy",
                "J.M. Jornet"
            ],
            "title": "Capacity and outage of terahertz communications with user micro-mobility and beam misalignment,",
            "venue": "IEEE Trans. Veh. Technol.,",
            "year": 2020
        },
        {
            "authors": [
                "Y. He",
                "Y. Chen",
                "L. Zhang",
                "S. -W. Wong",
                "Z.N. Chen"
            ],
            "title": "An overview of terahertz antennas,",
            "venue": "China Commun.,",
            "year": 2020
        },
        {
            "authors": [
                "B.G. Duffley",
                "G.A. Morin",
                "M. Mikavica",
                "Y.M.M. Antar"
            ],
            "title": "A wideband printed double-sided dipole array,",
            "venue": "IEEE Trans. Antennas Propag.,",
            "year": 2004
        },
        {
            "authors": [
                "R. Garg",
                "P. Bhartia",
                "I. Bahl",
                "A. Ittipiboon"
            ],
            "title": "Microstrip Antenna Design Handbook",
            "venue": "Artech House",
            "year": 2001
        },
        {
            "authors": [
                "K.R. Jha",
                "S.K. Sharma"
            ],
            "title": "Waveguide integrated microstrip patch antenna at THz frequency,",
            "venue": "in Proc. IEEE APSURSI,",
            "year": 2014
        },
        {
            "authors": [
                "S. Abu-Surra"
            ],
            "title": "End-to-end 6G terahertz wireless platform with adaptive transmit and receive beamforming,",
            "venue": "in Proc. IEEE ICC Workshops,",
            "year": 2022
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014Antenna arrays, channel estimation, energy efficiency, hybrid beamforming, impedance matching, mutual coupling, superdirectivity, THz communications.\nI. INTRODUCTION\nMassive multiple-input multiple-output (MIMO) is now a mature technology, which has been adopted by 5G new radio to provide superior network capacity and coverage. In parallel, millimeter wave (mmWave) systems start gaining ground as an effective way for delivering multi-gigabit rates thanks to their very large bandwidths [1], [2]. Toward this direction, communication above 100 GHz, i.e., terahertz (THz) frequencies, is widely deemed the next frontier of wireless systems with a plethora of promising applications, ranging from ultra-broadband femtocells to terabit-per-second links for wireless backhaul [3]. Nevertheless, THz signals are subject to severe propagation and molecular absorption losses, which can drastically limit the communication range and coverage [4]. To deal with this problem, large antenna arrays can be deployed at the base station (BS) to increase the signal power by means of sharp beamforming. As a result, massive MIMO is expected to be an integral component of future THz systems [5]. On\nManuscript received July 1, 2022; revised December 19, 2022, May 6, 2023, and August 8, 2023; accepted August 22, 2023.\nKonstantinos Dovelos is with Meta Materials. Inc., Athens, Greece, email: kostis.dovelos@metamaterial.com. All other authors are with the Centre for Wireless Innovation, Queen\u2019s University Belfast, Belfast BT3 9DT, U.K., email: {s.assimonis, hien.ngo, m.matthaiou}@qub.ac.uk.\nthe other hand, THz radio frequency (RF) circuits, e.g., power amplifiers, phase shifters, etc., exhibit significantly higher power consumption than their sub-6 GHz counterparts [6]. Additionally, baseband processing with multiple RF chains during channel estimation and data transmission is power intensive [7]. In conclusion, achieving a large beamforming gain in an energy efficient manner constitutes a major engineering challenge which calls for novel solutions.\nThe beamforming capabilities of multi-antenna systems have been extensively investigated in the past. For example, a typical N -element phased array offers a gain that scales linearly with N when maximum ratio transmission (MRT) is used [8]. However, higher gains are possible by leveraging the mutual coupling between adjacent antennas. Specifically, Uzkov theoretically proved in his seminal work [9] that a uniform linear array (ULA) of N isotropic radiators and vanishingly small inter-element spacing has an endfire directivity of N2, a phenomenon now known as superdirectivity.\nThe theme of superdirectivity has been widely studied from both information theoretic and pure electromagnetic standpoints, e.g., [10]\u2013[17], and references therein. However, most of the related literature considers arrays of uniform spacing. More importantly, it overlooks various communication and practical aspects, such as the EE, implementation limitations in hybrid analog-digital architectures, and channel estimation performance. Consequently, there are still critical questions about how THz massive MIMO could fully benefit from superdirectivity. Regarding other approaches, there is a stream of recent papers on arrays-of-subarrays (AoSA) with metallic antennas [18]\u2013[20] and graphene-based plasmonic nanoantennas [21], [22], as well as on intelligent reflecting surfaces [23], [24], which can improve the EE of the system. Yet, they neglect the superdirective effects of closely spaced BS antennas.\nThis paper aims to show that superdirectivity can be ingeniously used to reduce the hardware complexity and boost the EE of THz massive MIMO. The contributions of our work are summarized as follows:\n\u2022 We introduce a coupling-aware array model based on antenna theory. In particular, we derive the input impedance matrix of the BS array assuming lossy dipole antennas. Note that directional antennas, such as linear dipoles, are mutually coupled even for half-wavelength spacing. Therefore, proper characterization of their electromagnetic interaction is crucial to beamforming [25]. \u2022 Based on the introduced array model, we study the implementation issues of superdirectivity. In particular,\nar X\niv :2\n20 7.\n00 69\n7v 2\n[ cs\n.I T\n] 2\n8 A\nug 2\n02 3\n2 z\nx\ny\nThe rest of the paper is organized as follows: Section II delineates the BS array model. Section III presents the impedance matching problem. Section IV delves into the implementation issues of superdirectivity and details the proposed solution. Section V introduces the system model used for performance evaluation. Section VI analyzes the signal and interference powers under the proposed array. Section VII addresses the\nchannel estimation problem. Section VIII explains how to reduce the number of BS antennas. Section IX is devoted to numerical simulations. Finally, Section X summarizes the main conclusions of this work.\nNotation: Throughout the paper, DN (x) = sin(Nx/2) N sin(x/2) is the Dirichlet sinc function; A(\u00b7, \u00b7, \u00b7) is a vector field; A is a matrix; A\u2217, A\u2020, AH , and AT are the conjugate, pseudoinverse, conjugate transpose, and transpose of A, respectively; [A]i,j is the (i, j)th entry of A; A(i) is the ith column of A; blkdiag(A1, . . . ,An) is a block diagonal matrix; a is a vector; \u2225a\u22251 and \u2225a\u2225 are the l1-norm and l2-norm of a, respectively; mag(a) = [|a1|, . . . , |aN |]T for a = [a1, . . . , aN ]T ; 1N\u00d7M is the N \u00d7 M matrix with unit entries; IN is the N \u00d7 N identity matrix; 0N\u00d7M is the N\u00d7M matrix with zero entries; \u2297 denotes the Kronecker product; a \u00b7 b is the inner product between a and b; E{\u00b7} denotes expectation; CN (\u00b5,R) is a complex Gaussian vector with mean \u00b5 and covariance matrix R. Finally, Re{\u00b7} and Im{\u00b7} are the real and imaginary parts of a complex variable, respectively."
        },
        {
            "heading": "II. ANTENNA ARRAY MODEL",
            "text": "In this section, we present the BS array model which takes into account antenna mutual coupling."
        },
        {
            "heading": "A. Radiated Power",
            "text": "Consider an N -element ULA along the z-axis at the BS, as depicted in Fig. 1.1 The inter-element spacing is d. Each element is a linear dipole parallel to the x-axis, and is of length \u2113 and radius \u03c1. According to [26, Ch. 4], the current distribution on each dipole n has approximately the sinusoidal form\nIn(x \u2032) \u2248 In(0) sin (\u03ba\u2113/2\u2212 \u03ba|x\u2032|) sin(\u03ba\u2113/2) , |x\u2032| \u2264 \u2113/2, (1)\nwhere In(0) \u2208 C is the input current, \u03ba = 2\u03c0/\u03bb is the wavenumber, and \u03bb is the wavelength. We next focus on an arbitrary user who is in the far field of the BS array. The user\u2019s location is described by the tuple (r cos\u03d5 sin \u03b8, r sin\u03d5 sin \u03b8, r cos \u03b8), where r, \u03b8 \u2208 [0, \u03c0], and \u03d5 \u2208 [0, 2\u03c0] are the radial distance, polar angle, and azimuth\n1We consider a linear array at the BS since it constitutes the building block of planar arrays. The planar case is investigated in Section VI-C and thereafter.\n3 angle, respectively. The electric field at the user is then specified as (see Appendix A)\nE(r, \u03b8, \u03d5) = \u2212j\u03b7 e \u2212j\u03bar\n2\u03c0r N\u22121\u2211 n=0 ej\u03bar\u0302\u00b7rnIn(0)F(\u03b8, \u03d5), (2)\nwhere\nF(\u03b8, \u03d5) = cos(\u03ba\u2113/2 cos\u03d5 sin \u03b8)\u2212 cos(\u03ba\u2113/2) sin(\u03ba\u2113/2)(sin2 \u03d5+ cos2 \u03d5 cos2 \u03b8)\n\u00d7 (cos \u03b8 cos\u03d5e\u03b8 \u2212 sin\u03d5e\u03d5), (3)\nis the vector field pattern of each dipole, e\u03b8 and e\u03d5 are the unit vectors along the polar and azimuth directions, respectively, \u03b7 is the characteristic impedance of free-space, r\u0302 = (cos\u03d5 sin \u03b8, sin\u03d5 sin \u03b8, cos \u03b8)T is the unit radial vector along the user direction, and rn = (0, 0, nd) is the position vector of the nth antenna. The radiation intensity [W/sr] is written in vector form as\nU \u225c \u2225E(r, \u03b8, \u03d5)\u22252\n2\u03b7 r2 =\n\u03b7\n8\u03c02 \u2225F(\u03b8, \u03d5)\u22252 \u2223\u2223aH(\u03b8)i\u2223\u22232 , (4) where a(\u03b8) = [e\u2212j\u03bar\u0302\u00b7r0 , . . . , e\u2212j\u03bar\u0302\u00b7rN\u22121 ]T \u2208 CN\u00d71 and i = [I0(0), . . . , IN\u22121(0)]\nT \u2208 CN\u00d71 are the far-field array response vector and the vector of input currents, respectively. Using (4), the power radiated by the antenna array is\nPrad = \u222b 2\u03c0 0 \u222b \u03c0 0 U sin \u03b8d\u03b8d\u03d5\n= 1 2 iH ( \u03b7 4\u03c02 \u222b 2\u03c0 0 \u222b \u03c0 0 a(\u03b8)aH(\u03b8)\u2225F(\u03b8, \u03d5)\u22252 sin \u03b8d\u03b8d\u03d5, )\n\ufe38 \ufe37\ufe37 \ufe38 Re{Zideal} i\n= 1\n2 iHRe{Zideal}i, (5)\nwhere Zideal \u2208 CN\u00d7N is the input impedance matrix of the array assuming lossless antennas. Moreover, Ri \u225c [Re{Zideal}]n,n = \u03b7 4\u03c02 \u222b 2\u03c0 0 \u222b \u03c0 0 \u2225F(\u03b8, \u03d5)\u22252 sin \u03b8d\u03b8d\u03d5 is the input resistance2 of each lossless dipole.\nB. Input Power and Array Gain\nRealistic dipole antennas exhibit a conduction/loss resistance which leads to heat dissipation. Because of the skin effect of conductive wires carrying an alternating current, the loss resistance per unit length is given by [26, Eq. (2-90b)]\nR\u0304loss = 1\n2\u03c1\n\u221a \u00b5f\n\u03c0\u03c3c , (6)\nwhere f is the carrier frequency, \u00b5 is the permeability of freespace, and \u03c3c is the conductivity of the wire material. Under the sinusoidal current distribution in (1), the loss resistance relative to the input current In(0) is then specified as\nRloss = R\u0304loss \u222b \u2113/2 \u2212\u2113/2 \u2223\u2223\u2223\u2223In(x\u2032)In(0) \u2223\u2223\u2223\u22232 dx\u2032 = \u03ba\u2113\u2212 sin(\u03ba\u2113)4\u03ba\u03c1 sin2 (\u03ba\u2113/2) \u221a \u00b5f \u03c0\u03c3c ,\n(7)\n2Recall that the input resistance equals the radiation resistance divided by sin2(\u03ba\u2113/2) [26, Ch. 8]. This is because all quantities are expressed in terms of the input currents rather than the current maxima {In(0)/ sin(\u03ba\u2113/2)}N\u22121n=0 .\nFig. 2: Equivalent multi-port network of an antenna array covering signal generation, impedance matching, and mutual coupling.\nwhich yields the overall power loss [27]\nPloss = 1\n2 N\u22121\u2211 n=0 Rloss|In(0)|2 = 1 2 Rloss\u2225i\u22252. (8)\nConsequently, the input power at the antenna ports is\nPin = Ploss + Prad\n= 1\n2 Rloss\u2225i\u22252 +\n1 2 iHRe{Zideal}i = 1 2 iHRe{Z}i, (9)\nwhere Z \u225c RlossIN + Zideal is the impedance matrix of the lossy array. Finally, the array gain is defined as\nG(\u03b8, \u03d5) \u225c 4\u03c0U\nPin = Ge(\u03b8, \u03d5)(Rloss +Ri)\n|aH(\u03b8)i|2 iHRe{Z}i , (10)\nwhere Ge(\u03b8, \u03d5) = \u03b7\u2225F(\u03b8,\u03d5)\u22252 \u03c0(Rloss+Ri) denotes the gain of each dipole."
        },
        {
            "heading": "C. Optimal Currents under Fixed Input Power",
            "text": "According to Friis transmission formula, the power received by the user is given by [26]\nPr = Pin\n( \u03bb\n4\u03c0r\n)2 G(\u03b8, \u03d5), (11)\nwhere an isotropic antenna has been assumed at the user for simplicity. We now seek to find i that maximizes the received power (or equivalently G(\u03b8, \u03d5)) subject to the input power constraint Pin \u2264 Pt. The objective (10) is a generalized Rayleigh quotient. Thus, the optimal current excitation is obtained as [27]\niopt =\n\u221a 2Pt\naH(\u03b8)Re{Z}\u22121a(\u03b8) Re{Z}\u22121a(\u03b8), (12)\nand the maximum array gain is\nGmax(\u03b8, \u03d5) = Ge(\u03b8, \u03d5)(Rloss +Ri)a H(\u03b8)Re{Z}\u22121a(\u03b8).\n(13)\nRemark 1 (Uncoupled ULA). In the absence of mutual coupling, Re{Zideal} = RiIN and Prad = 12Ri\u2225i\u2225 2. Moreover, iopt = \u221a\n2Pt N(Rloss+Ri) a(\u03b8) and Gmax(\u03b8, \u03d5) = Ge(\u03b8, \u03d5)N , which is the typical O(N) power gain.\n4\nIII. IMPEDANCE MATCHING IN THE PRESENCE OF MUTUAL COUPLING\nMutual coupling alters the input impedance of each dipole. To see this, let v = [v0, . . . , vN\u22121]T \u2208 CN\u00d71 denote the vector of voltages at the antenna ports. Then, we have that v = Zi = Zai, where Za \u2208 CN\u00d7N is a diagonal matrix with entries [26, Ch. 8]\n[Za]n,n \u225c [Z]n,n + N\u22121\u2211 m=0,m \u0338=n [Z]n,m Im(0) In(0)  , (14) where [Za]n,n is the active impedance of the nth antenna. The active impedance of each dipole hinges on the excitation currents, and hence single-port conjugate matching is optimal only for a specific beamforming angle \u03b8 [28]. For this reason, we resort to multi-port matching and model the BS array as in Fig. 2. The impedance network is a passive and lossless 2N -port network described by the matrix ZM \u2208 C2N\u00d72N , which is partitioned as\nZM = [ ZM11 ZM12 ZM21 ZM22 ] . (15)\nThe lossless property implies that ZM has only imaginary entries. The vector of voltage sources is denoted by vs = [vs,0, . . . , vs,N\u22121]\nT \u2208 CN\u00d71. Each voltage source has an internal impedance Zs \u2208 C, with Re{Zs} = Rs. Likewise, the voltages and currents at the input ports of the network are denoted by vM = [vM,0, . . . , vM,N\u22121]T \u2208 CN\u00d71 and iM = [iM,0, . . . , iM,N\u22121]\nT \u2208 CN\u00d71, respectively. Based on basic circuit analysis, the relationship between the voltages and currents at the input and output of the matching network is [29][\nvM v\n] = [ ZM11 ZM12 ZM21 ZM22 ] [ iM \u2212i ] . (16)\nUsing (16) and the relationship v = Zi yields vM = ( ZM11 \u2212 ZM12(Z+ ZM22)\u22121ZM21 )\ufe38 \ufe37\ufe37 \ufe38 ZT iM , (17)\nwhere ZT \u2208 CN\u00d7N is the overall transmit impedance matrix accounting for power matching and mutual coupling. The problem of optimal multi-port matching is to find ZM so that ZT = Z\u2217s IN . In this case, there are no reflection losses and half of the generated power enters the antenna array, i.e.,\nmaximum power transfer [30]. This is accomplished for [29]\nZM =\n[ \u2212jIm{Zs}IN \u2212j \u221a RsRe{Z}1/2\n\u2212j \u221a RsRe{Z}1/2 \u2212jIm{Z}\n] . (18)\nUnder (18), we have that\nvs = ZsIN iM + vM = (ZsIN + ZT ) iM = 2RsiM , (19)\nand the total power generated by the voltage sources is\nPtotal = 1 2 Re { vHs iM } = Rs\u2225iM\u22252. (20)\nFrom (16) and (18), it also holds that\niM = Z \u22121 M21(Z+ ZM22)i\n= j\u221a Rs Re{Z}1/2i, (21)\nand hence Ptotal = iHRe{Z}i = 2Pin, which confirms the optimality of (18)."
        },
        {
            "heading": "IV. HARDWARE-EFFICIENT IMPLEMENTATION OF SUPERDIRECTIVE BEAMSTEERING",
            "text": "In this section, we investigate the problem of generating a superdirective beam with a single RF chain and a lowcomplexity impedance matching network."
        },
        {
            "heading": "A. Problem Statement",
            "text": "From (12), (19), and (21), the vector of voltage sources maximizing the array gain is given by\nvopts = 2Rsi opt M = j2 \u221a RsRe{Z}1/2iopt\n= j2\n\u221a 2RsPt\naH(\u03b8)Re{Z}\u22121a(\u03b8) Re{Z}\u22121/2a(\u03b8).\n(22)\nIn most massive MIMO studies, beamforming is conveniently described by a complex vector w \u2208 CN\u00d71 whose squared norm, \u2225w\u22252, defines the transmit power. This representation originates from information theory and can be mapped to the voltage sources driving the array through the relationship [31]\nw = \u2212 1 j2 \u221a Rs\n( vopts )\u2217\n=\n\u221a 2Pt\naH(\u03b8)Re{Z}\u22121a(\u03b8) Re{Z}\u22121/2a\u2217(\u03b8). (23)\nWe next consider a hybrid analog-digital array with one RF chain and N analog phase shifters, as shown in Fig. 3. In this case, w = wBB[ej\u03c60 , . . . , ej\u03c6N\u22121 ]T , where wBB denotes the complex amplitude of baseband processing whilst {\u03c6n}N\u22121n=0 are the variable phases. Consequently, beamsteering requires voltage sources {vs,n}N\u22121n=0 of uniform magnitude. From (22), it is easy to verify that vopts has entries of different magnitudes, and hence cannot be realized by a single RF chain. In summary, superdirective ULAs require amplitude control at each antenna, which can be provided by a fully digital array or an active phased array with digitally controlled amplitude attenuators. However, those architectures increase substantially the hardware complexity and power consumption.\n5 z\nd\u0304 dg\nSimilarly, multi-port matching requires interconnections and circuit components between all the 2N ports [32]. Thus, it is prohibitively complex for a large number N of antennas [33]."
        },
        {
            "heading": "B. Proposed Solution",
            "text": "1) Nonuniform Linear Array: The BS array is divided into Ng groups of N\u0304 antennas each, i.e., N = NgN\u0304 . Let dg and d\u0304 denote the inter-group and inter-element spacings, respectively, as shown in Fig. 4. The distance of the n\u0304th element in the ngth subarray from the origin of the coordinate system is given by( n\u0304d\u0304+ ng(dg + (N\u0304 \u2212 1)d\u0304) ) cos \u03b8, where n\u0304 = 0, . . . , N\u0304\u22121 and ng = 0, . . . , Ng \u2212 1. Thus, the array response vector a(\u03b8) can be recast as\na(\u03b8) = [ a0(\u03b8),a0(\u03b8)e \u2212j\u03ba((dg+(N\u0304\u22121)d\u0304) cos \u03b8), . . . ,\na0(\u03b8)e \u2212j\u03ba(Ng\u22121)(dg+(N\u0304\u22121)d\u0304) cos \u03b8 ]T = ag(\u03b8)\u2297 a0(\u03b8), (24)\nwhere a0(\u03b8) \u225c [1, . . . , e\u2212j\u03ba(N\u0304\u22121)d\u0304 cos \u03b8]T \u2208 CN\u0304\u00d71 is the response vector of the 0th antenna group, and ag(\u03b8) \u225c [1, . . . , e\u2212j\u03ba(Ng\u22121)(dg+(N\u0304\u22121)d\u0304) cos \u03b8]T \u2208 CNg\u00d71 is the response vector between groups. Similarly, the input impedance matrix is partitioned as\nZ =  Z0 Z0,1 \u00b7 \u00b7 \u00b7 Z0,Ng\u22121 Z1,0 Z0 \u00b7 \u00b7 \u00b7 Z1,Ng\u22121 ... ... . . . ...\nZNg\u22121,0 ZNg\u22121,1 \u00b7 \u00b7 \u00b7 Z0  , (25) where Re{Zng1,ng2} \u2208 RN\u0304\u00d7N\u0304 and Re{Z0} \u2208 RN\u0304\u00d7N\u0304 are defined by (26) and (27) at the bottom of this page, respectively. In fact, Z0 corresponds to the input impedance matrix of each N\u0304 -element group. For N\u0304 = 2, we have\nRe{Z0} \u225c [ Rself Rm Rm Rself ] , (28)\nwhere Rself = Rloss + Ri denotes the self impedance for notational convenience, and Rm is the real part of the mutual impedance between two adjacent dipoles.\nWhen the inter-group spacing is sufficiently large, the coupling between groups can be neglected. Thus, Re{Zng1,ng2} \u2248 0N\u0304\u00d7N\u0304 for ng1 \u0338= ng2, which makes Z approximately a block diagonal matrix, namely Re{Z} \u2248 INg \u2297 Re{Z0} = Re{Zapprox}. We finally stress that in addition to a large dg , the mutual coupling between antenna groups can be further reduced through various decoupling techniques, such as electromagnetic band gap structures placed between them [34].\n2) Coupled Antenna Pairs: A major drawback of beamsteering under mutual coupling is the requirement of amplitude control at each voltage source. However, in a NULA, all antenna groups share the same voltage amplitudes. This is because from (22)\nvopts = v\u0304Re{Z}\u22121/2a(\u03b8) \u2248 v\u0304Re{Zapprox}\u22121/2a(\u03b8)\n= v\u0304 ( INg \u2297 Re{Z0}\u22121/2 ) (ag(\u03b8)\u2297 a0(\u03b8))\n= v\u0304ag(\u03b8)\u2297 ( Re{Z0}\u22121/2a0(\u03b8) ) , (29)\nwhere v\u0304 = j2 \u221a 2RsPt/aH(\u03b8)Re{Z}\u22121a(\u03b8), which gives\nmag ( vopts ) = v\u0304 mag ( Re{Z0}\u22121/2a0(\u03b8) ) ...\nmag ( Re{Z0}\u22121/2a0(\u03b8)\n)  . (30)\nBy leveraging this unique property of NULAs, we further propose two-element groups. The following proposition justifies the choice of N\u0304 = 2.\nProposition 1. For N\u0304 = 2, mag ( Re{Z0}\u22121/2a0(\u03b8) ) reduces to (31) at the top of the next page.\nProof. See Appendix B.\nAccording to Proposition 1, antenna pairs result in uniform excitation amplitudes {|vs,n|}N\u22121n=0 , thereby enabling the realization of superdirective beamsteering with a single RF chain and N analog phase shifters. Additionally, each antenna pair is separately matched using the four-port network (see Appendix B)\nZM,0 =\n[ \u2212jIm{Zs}I2 \u2212j \u221a RsRe{Z0}1/2\n\u2212j \u221a RsRe{Z0}1/2 \u2212jIm{Z0}\n] . (32)\nTherefore, the proposed solution also facilitates the implementation of optimal multi-port matching, which would not be feasible in a coupled ULA with a large number of elements. Note that our solution relies on the symmetric structure of Z0 \u2208 C2\u00d72, which holds for radiators beyond linear dipoles. The main reason we chose dipoles is mathematical tractability; otherwise, we would heavily rely on full-wave simulations to assess the antenna array gain. The problem of finding the\nRe{Zng1,ng2} \u225c \u03b7\n4\u03c02 \u222b 2\u03c0 0 \u222b \u03c0 0 a0(\u03b8)a H 0 (\u03b8)e \u2212j\u03ba(ng1\u2212ng2)(dg+(N\u0304\u22121)d\u0304) cos \u03b8\u2225F(\u03b8, \u03d5)\u22252 sin \u03b8d\u03b8d\u03d5, for ng1 \u0338= ng2, (26)\nRe{Z0} \u225c Re{Zng1,ng2} = \u03b7\n4\u03c02 \u222b 2\u03c0 0 \u222b \u03c0 0 a0(\u03b8)a H 0 (\u03b8)\u2225F(\u03b8, \u03d5)\u22252 sin \u03b8d\u03b8d\u03d5+RlossIN\u0304 , for ng1 = ng2. (27)\n6 mag ( Re{Z0}\u22121/2a0(\u03b8) ) = 12\u00d71\n1\u221a 2Rself + 2 \u221a R2self \u2212R2m\n\u00d7 \u221a\u221a\u221a\u221a( Rself\u221a R2self \u2212R2m + 1 )2 + R2m R2self \u2212R2m \u2212 2 ( Rself\u221a R2self \u2212R2m + 1 ) Rm\u221a R2self \u2212R2m cos ( \u03bad\u0304 cos \u03b8 ) .\n(31)\noptimal antenna type to facilitate superdirectivity is beyond the scope of the current work, and is a promising avenue for future research."
        },
        {
            "heading": "V. THZ MASSIVE MIMO MODEL",
            "text": "In this section, we introduce the high-level system model used to evaluate the performance of the proposed NULA in terms of the achievable rate and EE."
        },
        {
            "heading": "A. Signal Model",
            "text": "Consider a THz massive MIMO system, where the BS serves K \u226a N single-antenna users. Let hk \u2208 CN\u00d71 and \u03b2k denote the small-scale fading channel and path loss of user k, respectively. The downlink channel of user k is then specified as \u221a \u03b2kh T k . To facilitate hardware implementation, a fully connected analog-digital array with NRF RF chains is considered at the BS [35]. Thus, the precoder is decomposed as W = WRFWBB = [w1, . . . ,wNRF ] \u2208 CN\u00d7NRF , where WRF \u2208 CN\u00d7NRF is the RF beamformer realized by analog phase shifters, whereas WBB \u2208 CNRF\u00d7NRF is the baseband precoder. Without loss of generality, we assume NRF = K hereafter. Let x = [x1, . . . , xK ]T \u223c CN (0K\u00d71, IK) be the vector of users\u2019 data symbols. The transmitted signal is then given by Wx \u2208 CN\u00d71, and should satisfy the power constraint\nE { \u2225Wx\u22252 } = K\u2211 k=1 \u2225wk\u22252 \u2264 2Pt, (33)\nwhere 2Pt is the total power under perfect impedance matching. Given the above, the received baseband signal at the kth user is written as\nyk = \u221a \u03b2kh T kwkxk + \u221a \u03b2k K\u2211 i=1,i\u0338=k hTkwixi + nk, (34)\nwhere nk \u223c CN (0, \u03c32) is the additive noise. Finally, the signal-to-interference-plus-noise ratio (SINR) of user k is\nSINRk = \u03b2k \u2223\u2223hTkwk\u2223\u22232\n\u03b2k \u2211K\ni=1,i\u0338=k \u2223\u2223hTkwi\u2223\u22232 +B\u03c32 , (35) where B\u03c32 is the noise power over the transmit bandwidth B."
        },
        {
            "heading": "B. Channel Model",
            "text": "Because of the severe path attenuation in the THz band, multi-path scattering is very limited. We therefore assume lineof-sight (LoS) links between the BS and users, akin to [36]. In\nthe presence of mutual coupling at the BS array, the channel vector of user k is expressed as [29, Eq. (105)]\nhk \u225c Re { Z\u0304 }\u22121/2 a(\u03b8k), (36)\nwhere Z\u0304 \u225c 1Rloss+RiZ is the normalized input impedance matrix of the BS array.3 Finally, because the molecular absorption losses are no longer negligible at THz frequencies, the path loss coefficient is calculated as [37]\n\u03b2k = Ge(\u03b8k, \u03d5k)\n( \u03bb\n4\u03c0rk\n)2 e\u2212\u03baabsrk , (37)\nwhere Ge(\u03b8k, \u03d5k) is the gain of each BS antenna, \u03bb is the carrier wavelength, rk is the distance from the BS to user k, and \u03baabs is the molecular absorption coefficient determined by the composition of the propagation medium [38]."
        },
        {
            "heading": "C. Power Consumption Model",
            "text": "For a fully-connected array structure, the overall power consumption is given by [39]\nPc = PBB +KPRF +KNPPS +NPPA + Pt + PCE, (38)\nwhere PBB, PRF, PPS, PPA, and PCE denote the powers consumed by a baseband unit, an RF chain, a phase shifter, a power amplifier, and the channel estimation process, respectively. Moreover, each RF chain comprises a digital-toanalog converter (DAC), a local oscillator, and a mixer, and hence PRF = PDAC + PLO + PM. We finally stress that the power consumption of splitters and combiners is negligible, and hence is ignored [39]."
        },
        {
            "heading": "VI. SIGNAL AND INTERFERENCE POWERS",
            "text": ""
        },
        {
            "heading": "A. Proposed NULA",
            "text": "We consider MRT at the BS. Under equal power allocation, we have that\nwk = \u221a 2Pt K h\u2217k \u2225hk\u2225\n=\n\u221a 2Pt\nKaH(\u03b8k)Re { Z\u0304 }\u22121 a(\u03b8k) Re { Z\u0304 }\u2212 12 a\u2217(\u03b8k), (39)\nand the power of the desired signal, normalized by K/(2Pt), is\nK\n2Pt \u2223\u2223hTkwk\u2223\u22232 = aH(\u03b8k)Re{Z\u0304}\u22121 a(\u03b8k). (40) 3The normalized input impedance matrix is used for notational convenience.\nIn this way, the array gain is recast as G(\u03b8, \u03d5) = Ge(\u03b8, \u03d5) |aH (\u03b8)i|2\niHRe{Z\u0304}i , and the path loss coefficient or channel vector will not include the term Rloss + Ri. For example, Re { Z\u0304 } = IN and hk = a(\u03b8k) in the absence of coupling.\n7 (a) d = 1.5\u03bb, dg = 1.5\u03bb, and d\u0304 = \u03bb/5. (b) d = \u03bb/2, dg = \u03bb/2, and d\u0304 = \u03bb/5.\nFig. 5: Normalized signal power versus polar angle for N = 8 dipoles of \u2113 = \u03bb/2, \u03c1 = \u03bb/500, and \u03c3c = 5.7\u00d7 107 S/m. In NULA, N\u0304 = 2 and Ng = 4. The carrier frequency is set to f = 300 GHz.\nDue to the block-diagonal structure of Z\u0304, (40) simplifies to\nK\n2Pt \u2223\u2223hTkwk\u2223\u22232 \u2248 aH(\u03b8k)Re{Z\u0304approx}\u22121 a(\u03b8k) = ( aHg (\u03b8k)\u2297 aH0 (\u03b8k) )( INg \u2297 Re { Z\u03040 }\u22121) (ag(\u03b8k)\u2297 a0(\u03b8k))\n= Nga H 0 (\u03b8k)Re { Z\u03040 }\u22121 a0(\u03b8k), (41)\nwhere Z\u0304approx = 1Rloss+RiZapprox and Z\u03040 = 1 Rloss+Ri Z0. As seen from (41), the power gain of the NULA is Ng times the gain of a superdirective antenna group. In the sequel, we determine aH0 (\u03b8k)Re { Z\u03040 }\u22121\na0(\u03b8k) in closed-form for N\u0304 = 2. We first have that\nRe { Z\u03040 } =\n[ 1 R\u0304m\nR\u0304m 1\n] , (42)\nwhere R\u0304m = 1Rloss+RiRm. Then, the inverse matrix is determined as\nRe { Z\u03040 }\u22121 = 1\n1\u2212 R\u03042m\n[ 1 \u2212R\u0304m\n\u2212R\u0304m 1\n] , (43)\nand Re { Z\u03040 }\u22121 a0(\u03b8k) = 1\n1\u2212 R\u03042m\n[ 1 \u2212R\u0304m\n\u2212R\u0304m 1\n][ 1\ne\u2212j\u03bad\u0304 cos \u03b8k ] = 1\n1\u2212 R\u03042m [ 1\u2212 R\u0304me\u2212j\u03bad\u0304 cos \u03b8k \u2212R\u0304m + e\u2212j\u03bad\u0304 cos \u03b8k ] , (44)\nwhich gives aH0 (\u03b8k)Re { Z\u03040 }\u22121 a0(\u03b8k)\n= 1\n1\u2212 R\u03042m\n( 1\u2212 R\u0304me\u2212j\u03bad\u0304 cos \u03b8k \u2212 R\u0304mej\u03bad\u0304 cos \u03b8k + 1 ) = 2\n1\u2212 R\u03042m\n( 1\u2212 R\u0304m cos(\u03bad\u0304 cos \u03b8k) ) . (45)\nAccording to (45), aH0 (\u03b8k)Re { Z\u03040 }\u22121\na0(\u03b8k) \u2248 2 for large d\u0304, i.e., R\u0304m \u2248 0, which corresponds to the conventional power gain of a two-element array.\nIn a similar manner, the interference power at user k from the beam toward user i \u0338= k, normalized by K/(2Pt), is given\nby\nK\n2Pt \u2223\u2223hTkwi\u2223\u22232 = \u2223\u2223\u2223aH(\u03b8k)Re{Z\u0304}\u22121 a(\u03b8i)\u2223\u2223\u22232 aH(\u03b8i)Re { Z\u0304 }\u22121 a(\u03b8i)\n\u2248 \u2223\u2223\u2223aH(\u03b8k)Re{Z\u0304approx}\u22121 a(\u03b8i)\u2223\u2223\u22232 aH(\u03b8i)Re { Z\u0304approx }\u22121 a(\u03b8i)\n(a) = Ng \u2223\u2223DNg (\u03ba(dg + (N\u0304 \u2212 1)d\u0304)(cos \u03b8k \u2212 cos \u03b8i))\u2223\u22232 \u00d7\n\u2223\u2223\u2223aH0 (\u03b8k)Re{Z\u03040}\u22121 a0(\u03b8i)\u2223\u2223\u22232 aH0 (\u03b8i)Re { Z\u03040 }\u22121 a0(\u03b8i) , (46)\nwhere (a) is proven in Appendix C. From (44) and (45), we finally have that\u2223\u2223\u2223aH0 (\u03b8k)Re{Z\u03040}\u22121 a0(\u03b8i)\u2223\u2223\u22232 aH0 (\u03b8i)Re { Z\u03040 }\u22121 a0(\u03b8i) =\n= \u2223\u2223\u22231 + ej\u03bad\u0304(cos \u03b8k\u2212cos \u03b8i) \u2212 R\u0304m (ej\u03bad\u0304 cos \u03b8k + e\u2212j\u03bad\u0304 cos \u03b8i)\u2223\u2223\u22232 2(1\u2212 R\u03042m) ( 1\u2212 R\u0304m cos(\u03bad\u0304 cos \u03b8i)\n) . (47)"
        },
        {
            "heading": "B. Comparison With Uncoupled ULA",
            "text": "In the massive MIMO literature, it is customary to consider a uniform inter-element spacing [40]. Furthermore, mutual coupling is avoided by employing a sufficiently large d so that Re { Z\u0304 } \u2248 IN . In this case, the normalized power of the desired signal becomes\nK\n2Pt \u2223\u2223hTkwk\u2223\u22232 \u2248 N, (48) whereas the normalized interference is\nK\n2Pt\n\u2223\u2223hTkwi\u2223\u22232 \u2248 N |DN (\u03bad(cos \u03b8k \u2212 cos \u03b8i))|2. (49)\n8 z\nd\u0304 dg\nx\ndx\nCollinear dipoles: weak coupling\n(a)\n90 \u00b0\n60 \u00b0\n30 \u00b0\n0 \u00b0\n330 \u00b0\n300 \u00b0\n270 \u00b0\n240 \u00b0\n210 \u00b0\n180 \u00b0\n150 \u00b0\n120 \u00b0\n-30\n-19.43\n-8.87\n1.7\n12.26 dBi\n(b)\nFig. 6: (a) Example of a NUPA with Nx = Ng = N\u0304 = 2; and (b) theoretical beampattern (52) against full-wave simulation for dx = 0.7\u03bb, dg = 1.5\u03bb, and d\u0304 = \u03bb/5. The desired beamforming direction is (\u03b8i, \u03d5i) = (20\u25e6, 0\u25e6).\nFrom (48), it is evident that the power gain is independent of the steering direction \u03b8k in an uncoupled ULA. This assumption is safely made for a large antenna separation, as showcased in Fig. 5. Specifically, half-wavelength spacing does create coupling between directional antennas, and hence the input impedance matrix cannot be ignored.4 Lastly, according to the approximate expressions, the proposed NULA with N\u0304 = 2 yields a relative power gain equal to\nNga H 0 (\u03b8k)Re { Z\u03040 }\u22121 a0(\u03b8k)\u2212N =\n= Ng [ aH0 (\u03b8k)Re { Z\u03040 }\u22121 a0(\u03b8k)\u2212 2 ] = O(Ng), (50)\nwhich scales linearly with Ng for some \u03b8k \u2208 [0, \u03b8max]; for example, \u03b8max \u2248 50\u25e6 in Fig. 5(a). This trade off between directivity and angular coverage is fundamental [42]. Thus, increasing the former inevitably decreases the latter, and vice versa. Whether it is beneficial to have a highly directive array depends on the propagation environment and deployment scenario [42], [43]."
        },
        {
            "heading": "C. Extension to Planar Arrays",
            "text": "In this section, we extend the proposed design to planar arrays, which are of practical importance. Specifically, a NUPA is formed by placing Nx NULAs along the x-axis with interelement spacing dx, as depicted in Fig. 6(a). The total number of antennas is N = NxNgN\u0304 . Also, the response vector of the NUPA is given by a(\u03b8, \u03d5) = ax(\u03b8, \u03d5)\u2297 ag(\u03b8)\u2297 a0(\u03b8), where ax(\u03b8, \u03d5) \u225c [1, . . . , e\u2212j\u03ba(Nx\u22121)dx cos\u03d5 sin \u03b8]T \u2208 CNx\u00d71. The coupling between the NULAs is very small for dx \u2265 \u03bb/2 since adjacent dipoles along the x-axis are collinear. Given that, the impedance matrix of the NUPA reduces to Z \u2248 INgNx \u2297 Z0, while the signal and interference powers in (40) and (46) are recast, respectively, as\nK\n2Pt \u2223\u2223hTkwk\u2223\u22232 \u2248 NxNgaH0 (\u03b8k)Re{Z\u03040}\u22121 a0(\u03b8k), (51) 4The assumption of uncoupled elements under half-wavelength spacing\nholds only for isotropic radiators [41].\nand K\n2Pt \u2223\u2223hTkwi\u2223\u22232 \u2248 \u2248 NxNg |DNx (\u03badx(cos\u03d5k sin \u03b8k \u2212 cos\u03d5i sin \u03b8i))| 2\n\u00d7 \u2223\u2223DNg (\u03ba(dg + (N\u0304 \u2212 1)d\u0304)(cos \u03b8k \u2212 cos \u03b8i))\u2223\u22232\n\u00d7 \u2223\u2223\u2223aH0 (\u03b8k)Re{Z\u03040}\u22121 a0(\u03b8i)\u2223\u2223\u22232 aH0 (\u03b8i)Re { Z\u03040 }\u22121 a0(\u03b8i) . (52)\nFrom (51), we see that the signal power is Nx times that of a NULA with Ng dipole pairs, as expected. Regarding the interference power, NUPA offers an additional degree of freedom compared to a single NULA along the z-axis, which is given by the term Nx |DNx (\u03badx(cos\u03d5k sin \u03b8k \u2212 cos\u03d5i sin \u03b8i))|\n2. The good accuracy of (52) is confirmed in Fig. 6(b) considering the polar plane \u03d5k = \u03d5i = 0. Note that the fullwave simulation was performed using the Antenna Toolbox of MATLAB."
        },
        {
            "heading": "VII. CHANNEL ESTIMATION",
            "text": "So far, we have assumed perfect channel knowledge at the BS and analyzed the performance of MRT in the presence of mutual coupling. In this section, we focus on the channel estimation problem, which is crucial to beamforming."
        },
        {
            "heading": "A. Channel Reciprocity",
            "text": "In massive MIMO, it is typical to invoke channel reciprocity for time-division duplex (TDD) operation [44]. This enables the BS to estimate the downlink channel through uplink pilots sent by users. Let hk,DL = hTk \u2208 C1\u00d7N denote the downlink channel, where hk is given by (36). The TDD assumption is then that hk,UL = hTk,DL. Although the physical channels (i.e., those defined by electromagnetic theory) are reciprocal, this does not generally hold for their information-theoretic counterparts in the presence of antenna mutual coupling [45].\n9 In particular, the BS needs to employ a linear transformation to compute hTk,DL from the estimated hk,UL. Nevertheless, the transmit and receive array gains coincide with each other under isotropic background noise and noise matching at the receiver [29, Eq. (97)]. Thus, we can assume that hk,UL = hTk,DL, and that the reception strategy maximizing the signal-to-noise ratio (SNR) of each user k is the maximum ratio combiner vk = h H k /\u2225hk\u2225."
        },
        {
            "heading": "B. Problem Formulation",
            "text": "We assume a block-fading model, where the channel coherence time is much larger than the training period. The BS estimates the uplink channel hk of each user k in rounds. Subsequently, we focus on an arbitrary user and omit the subscript \u201ck\u201d. Specifically, the training period for each user consists of Nslot time slots. At each time slot t = 1, . . . , Nslot, the user transmits the pilot signal xt = \u221a Pp, where Pp is the power per pilot signal. In turn, the BS combines the received pilot signal using a training hybrid combiner Vt = VRF,tVBB,t \u2208 CN\u00d7NRF . Therefore, the post-processed signal at slot t, yt \u2208 CK\u00d71, is written as\nyt = \u221a \u03b2PpV H t h+V H t nt, (53)\nwhere nt \u223c CN (0N\u00d71, \u03c32IN ) is the additive noise vector. Let Nbeam = NslotNRF denote the total number of pilot beams. After Nslot training slots, the BS acquires the measurement vector y\u0304 \u225c [yT1 , . . . ,y T Nslot ]T \u2208 CNbeam\u00d71 for h as y\u0304 = \u221a \u03b2Pp  V H 1 ...\nVHNslot\nh+  V H 1 n1 ...\nVHNslotnNslot  =\u221a\u03b2Pp VHh+ n\u0304, (54)\nwhere V \u225c [V1, . . . ,VNslot ] \u2208 CN\u00d7Nbeam , whereas n\u0304 \u2208 CNbeam\u00d71 is the effective noise. More particularly, Rn\u0304[s] \u225c \u03c32blkdiag ( VH1 V1, . . . ,V H Nslot VNslot )\nis the covariance matrix of the effective noise, which is colored in general.5 Regarding the pilot combiners, due to the hybrid array architecture, V = VRFVBB, with VRF = [VRF,1, . . . ,VRF,Nslot ] \u2208 CN\u00d7Nbeam and VBB = blkdiag(VBB,1, . . . ,VBB,Nslot) \u2208 CNbeam\u00d7Nbeam comprising the pilot RF beams and baseband combiners of the Nslot time slots, respectively."
        },
        {
            "heading": "C. Orthogonal Matching Pursuit",
            "text": "1) Sparse Formulation: We next consider a dictionary H\u0304 \u2208 CN\u00d7G whose G columns are the channel vectors associated with a predefined set of angles-of-arrival (AoA). Then, the uplink channel can be approximated as\nh \u2248 H\u0304\u03b2, (55)\nwhere \u03b2 is a G \u00d7 1 vector with a single nonzero entry corresponding to the LoS path. Therefore, (54) is recast as y\u0304 \u2248 \u03a6\u03b2 + n\u0304, where \u03a6 \u225c \u221a Pp V H H\u0304 \u2208 CNbeam\u00d7G is the equivalent sensing matrix. Since G \u226b 1, the vector \u03b2\u0304\n5We have assumed the same noise variance, \u03c32, as in the user side.\nFig. 7: Fraction of N/Nx versus d\u0304 for (\u03b8, \u03d5) = (0, 0) at f = 300 GHz. The dipoles are half-wavelength copper wires of radius \u03c1 = \u03bb/500.\nis 1-sparse, and thus the channel estimation problem can be formulated as the sparse recovery problem [46]\n\u03b2\u0302 = argmin \u03b2\n\u2225\u03b2\u22251 subject to \u2225y\u0304 \u2212\u03a6\u03b2\u2225 \u2264 \u03f5, (56)\nwhere \u03f5 \u2264 E{\u2225n\u0304\u2225} is an appropriately chosen bound on the mean magnitude of the effective noise. The l1-norm optimization problem in (56) can be readily solved by the popular OMP algorithm, which takes the following form for single-path channels\ng\u22c6 = argmax g\u2208G \u2223\u2223\u03a6H(g)y\u0304\u2223\u2223 , (57) where G denotes the set of predefined AoA. Finally, the estimate of h is obtained as h\u0302 = H\u0304(g\u22c6). It is worth stressing that the actual AoA might differ from the one defined by the dictionary. Nonetheless, this mismatch error can become negligible by adopting a high-resolution dictionary, as demonstrated in [46].\n2) Dictionary and Pilot Beams: In the spirit of [47], [48], we discretize the polar angle \u03b8 \u2208 [0, \u03b8max] and azimuth angle \u03d5 \u2208 [0, \u03d5max] as\n\u03b8\u0304gz = \u03b8max Gz gz, gz = 0, . . . , Gz \u2212 1, (58) \u03d5\u0304gx = \u03d5max Gx gx, gx = 0, . . . , Gx \u2212 1, (59)\nwhere G = GxGz is the overall dictionary size, which results in the coupling-aware dictionary\nH\u0304 = [ Re{Z}\u2212 12 a ( \u03b8\u03040, \u03d5\u03040 ) , . . . ,Re{Z}\u2212 12 a ( \u03b8\u0304Gz\u22121, \u03d5\u0304Gx\u22121 )] . (60) The elements of the RF combiner VRF are selected from the set {\u22121/ \u221a N, 1/ \u221a N} with equal probability. The reason we adopt a randomly formed RF combiner is that it will exhibit low mutual-column coherence, and therefore is expected to attain a high recovery probability according to the compressed sensing (CS) theory [49]. The columns of VRF have been normalized so that the total power consumed during the channel estimation stage is PCE = KNbeamPp, as KNbeam pilot beams are used for the K users. The specific RF pilot design results in a colored effective noise. For this reason, we\n10\ndesign the baseband combiner such that the effective noise remains white. Let DHt Dt be the Cholesky decomposition of VHRF,tVRF,t, where D \u2208 CNRF\u00d7NRF is an upper triangular matrix. Then, the baseband combiner of the tth slot is set to VBB,t = D \u22121 t , and hence V = VRFblkdiag(D \u22121 1 , . . . ,D \u22121 Nslot\n). Under this pilot beam design, the covariance matrix of the effective noise becomes Rn\u0304 = \u03c32INbeam ."
        },
        {
            "heading": "VIII. REDUCING THE NUMBER OF BS ANTENNAS",
            "text": "As demonstrated in Section VI-B, the proposed NULA achieves larger gain than ULA thanks to the superdirective pairs. This excessive power gain can improve EE, because the number of antennas is kept fixed in both array designs. A more radical approach is to adopt a NULA with fewer elements than a ULA to substantially reduce the power consumption, akin to the paradigm of array thinning. Hereafter, we focus on the general case of planar arrays, and determine the parameters Ng , dg , and d\u0304 of NUPA in order to attain a similar signal and interference power as a UPA of N elements.\nA. How Many BS Antennas Do We Need?\nFor the sake of fair comparison, we consider that both NUPA and UPA have Nx elements along the x-axis with\ninter-element spacing dx. We then seek to find how many antennas along the z-axis are needed such that the two arrays offer the same signal power toward the endfire direction (\u03b8, \u03d5) = (0\u25e6, 0\u25e6). This occurs when\nNxNga H 0 (0)Re { Z\u03040 }\u22121 a0(0) = N, (61)\nwhich gives, after some basic algebra,\n2Ng = 1\u2212 R\u03042m( 1\u2212 R\u0304m cos ( \u03bad\u0304 )) N Nx . (62)\nNote that (62) hinges on the inter-element spacing d\u0304 within dipole pairs, which determines the level of mutual coupling. From Fig. 7, we observe that the minimum number of antennas is attained for d\u0304 = \u03bb/5.6 In this case, the NUPA requires approximately 68% of the UPA antennas along the z-axis, and hence up to 32% saving in RF hardware is possible. This performance can be readily obtained for a point-to-point link where the user is placed at the endfire direction of the BS. Conversely, the impact of reducing the number of BS antennas on the performance of multiuser transmissions is hard to analytically study, under either perfect or imperfect CSI. For\n6For spacings smaller than \u03bb/5, the ohmic losses become dominant and decrease the array gain.\n11\nthis reason, we resort to numerical simulations in Section IX."
        },
        {
            "heading": "B. Spatial Resolution and Inter-Group Spacing",
            "text": "It is known that spatial resolution is determined by the array size [26]. Thus, the NUPA with less elements will preserve its spatial resolution if its length along the z-axis is equal to that of UPA. This happens for Ngd\u0304+(Ng \u22121)dg = (N/Nx\u22121)d, or equivalently\ndg = (N/Nx \u2212 1)d\u2212Ngd\u0304\nNg \u2212 1 , (63)\nwhich ensures that the NUPA and UPA have the same physical size. To demonstrate this design methodology, we consider a 32 \u00d7 32-element UPA at the BS with d = dx = 0.7\u03bb. Then, the NUPA will consist of Ng = 11 dipole pairs, yielding a 32 \u00d7 22-element array with inter-group spacing dg = 1.95\u03bb. We now compare these two arrays in terms of the overall signal and interference powers given by \u03b2k\n\u2223\u2223hTkwk\u2223\u22232 \u221d Ge(\u03b8k, \u03d5k)\n\u2223\u2223hTkwk\u2223\u22232 and \u03b2k \u2223\u2223hTkwi\u2223\u22232 \u221d Ge(\u03b8k, \u03d5k) \u2223\u2223hTkwi\u2223\u22232, respectively. From Fig. 8, we verify that both arrays have very similar performance, though the NUPA employs much fewer elements than UPA. Lastly, the side lobes occurred for polar angles \u03b8k beyond 50\u25e6 can be neglected since their power is less than 0 dB. About possible grating lobes, these will appear if dg + d\u0304 > \u03bb and dx > \u03bb. Their positions, in the polar plane (i.e., \u03d5k = \u03d5i = 0), are given by [26]\n\u03b8k = cos \u22121 ( cos \u03b8i \u00b1 n1 \u03bb\ndg + d\u0304\n) = sin\u22121 ( sin \u03b8i \u00b1 n2 \u03bb\ndx\n) ,\n(64)\nfor n1 and n2 in {1, 2, 3, . . . }. Since dx < \u03bb, (64) does not admit a real solution, and hence grating lobes do not occur in the visible region of the NUPA. In practice, these are suppressed by the low-level sidelobes of the array along the x-axis, as indicated by (52). This behavior is confirmed in Fig. 9, where\nBz = Ge(\u03b8k, \u03d5k) \u00d7Ng \u2223\u2223DNg (\u03ba(dg + (N\u0304 \u2212 1)d\u0304)(cos \u03b8k \u2212 cos \u03b8i))\u2223\u22232\n\u00d7 \u2223\u2223\u2223aH0 (\u03b8k)Re{Z\u03040}\u22121 a0(\u03b8i)\u2223\u2223\u22232 aH0 (\u03b8i)Re { Z\u03040 }\u22121 a0(\u03b8i) (65)\nand\nBx = Nx |DNx (\u03badx(cos\u03d5k sin \u03b8k \u2212 cos\u03d5i sin \u03b8i))| 2 (66)\nare the beampatterns of the NUPA along the z and x directions, respectively [50].\nRemark 2. The proposed NUPA enables beam broadening without sacrificing the maximum array gain by adopting a small inter-group spacing dg , i.e., by decreasing the length of the overall array along the z-axis. This feature is showcased in Fig. 9, and can be very useful for THz links where wide beamwidths alleviate the detrimental effect of beam misalignment [51]."
        },
        {
            "heading": "IX. SIMULATION RESULTS",
            "text": "We conduct extensive numerical simulations to assess the performance of the proposed array design. In all numerical experiments, we consider a fractional bandwidth B/f \u2264 0.1 and LoS links, which ensure a spatially narrowband propagation channel [46]. The other simulation parameters are summarized in Table II. Also, all values in the power consumption model are taken from [20]."
        },
        {
            "heading": "A. Point-to-Point Link",
            "text": "We commence with the case of a point-to-point link, where a single user is placed at (\u03b8, \u03d5) = (0\u25e6, 0\u25e6). Note that this setup can represent a wireless backhaul link. Due to the fixed user direction, perfect CSI is assumed at the BS.\n12\nThe distance from the BS follows the uniform distribution U(5, 15) m. The maximum achievable rate and EE are given by R = B log2 ( 1 + \u03b2|h Tw|2 B\u03c32 ) and R/Pc, respectively. The signal power |hTw|2 is determined by (51) and is independent of dg and dx. The cumulative distribution function (CDF) of each metric is calculated for 1, 000 channel realizations. From Fig. 10 of the next page, we observe that the NUPA attains the same achievable rate as UPA, yet with 320 antennas less. This translates roughly to 31% saving in RF circuitry, such as power amplifiers, phase shifters and combiners, which in turn yields a mean EE improvement of 45%.\nFor the point-to-point deployment, we can employ singleport impedance matching as the beamforming angle is kept fixed all the time. Subsequently, we investigate how this is accomplished. To calculate the active impedance of each dipole, the endfire current vector is decomposed as iopt = [iopt0 , . . . , i opt Ng\u22121] T , where ioptng \u225c [Ing (0), Ing+1(0)] T denotes the optimal excitation vector at each antenna pair. This is defined as\nioptng =\n\u221a 2Pte \u2212j\u03bang(dg+d\u0304)\u221a NgaH0 (0)Re{Z0}\u22121a0(0) Re{Z0}\u22121a0(0)\n=\n\u221a Pte \u2212j\u03bang(dg+d\u0304)\u221a Ng(Rself \u2212Rm cos(\u03bad\u0304))\n[ Rself \u2212Rme\u2212j\u03bad\u0304\n\u2212Rm +Rselfe\u2212j\u03bad\u0304\n] ,\n(67)\nwhere (67) follows from (12) and (45) for \u03b8 = 0\u25e6. Therefore,\nfor any pair ng , we have that\nIng+1(0)\nIng (0) =\n\u2212Rm +Rselfe\u2212j\u03bad\u0304\nRself \u2212Rme\u2212j\u03bad\u0304 , (68)\nwhich is independent of the group index ng . Now let\nZ0 \u225c [ Zself Zm Zm Zself ] , (69)\nwith Re{Zself} = Rself and Re{Zm} = Rm. The input impedance matrix Z0 is computed by the induced EMF method for two side-by-side dipoles [26, Ch. 8]. Since Z = INg \u2297 Z0, it is straightforward to prove that Za = blkdiag(Z0,a, . . . ,Z0,a) using the relationship Zaiopt = Ziopt, where\nZ0,a = Zself + Zm Ing+1(0)Ing (0) 0 0 Zself + Zm Ing (0)\nIng+1(0)  =\nZself + Zm\u2212Rm+Rselfe\u2212j\u03bad\u0304Rself\u2212Rme\u2212j\u03bad\u0304 0 0 Zself + Zm\nRself\u2212Rme\u2212j\u03bad\u0304 \u2212Rm+Rselfe\u2212j\u03bad\u0304  . (70)\nTherefore, all dipole pairs share a common active impedance matrix whose entries are [Z0,a]1,1 = 21.84 + j32.89 \u2126, and [Z0,a]2,2 = 40.87 + j83.89 \u2126, for half-wavelength dipoles made of copper and inter-element distance d\u0304 = \u03bb/5. This is a unique feature of the proposed NULA/NUPA. In contrast, a superdirective ULA/UPA would need a different matching impedance for each port because the current amplitude is not uniform along the ports (akin to the source voltages). Thus, the derived architecture simplifies also single-port matching. Finally, compared to an uncoupled ULA/UPA with Zself = 75.94+j41.76 \u2126, the active impedances [Z0,a]1,1 and [Z0,a]2,2 are not very large, and thus could be easily matched."
        },
        {
            "heading": "B. Multiuser Transmissions with Imperfect CSI",
            "text": "We now consider that the BS simultaneously transmits to K users using MRT. The users\u2019 directions are not fixed, and thus the BS acquires the channel estimates {h\u0302k}Kk=1 through the OMP estimator of Section VII-C. In the UPA case, the dictionary is H\u0304 = [ a ( \u03b8\u03040, \u03d5\u03040 ) , . . . ,a ( \u03b8\u0304Gz\u22121, \u03d5\u0304Gx\u22121 )] . The BS treats those estimates as the true channels in the\n13\nbeamforming stage, i.e., wk = h\u0302\u2217k/\u2225h\u0302k\u2225. The achievable rate of user k is then specified as Rk = B log2(1+SINRk), where SINRk is given by (35). Note that this rate is achieved under the assumption that user k knows |hTkwk|2 and \u2211 i \u0338=k |hTkwi|2 in the decoding stage. These are scalars and, hence, are easy to be estimated. For the performance evaluation, the primary metrics are the sum-rate, minimum rate, and total EE defined as \u2211K k=1 Rk, mink{Rk}, and \u2211K\nk=1 Rk/Pc, respectively. Figure 11 shows the results for a two-user transmission. As observed, the NUPA boosts the mean EE by 29% without compromising the sum or minimum data rate. Regarding the OMP estimator, we calculate the normalized squared error\n(NSE) defined as NSE \u225c 1K \u2211K k=1 \u2225\u2225\u2225hk \u2212 h\u0302k\u2225\u2225\u22252 /\u2225hk\u22252. The training overhead per user is Nbeam = 0.8N \u2248 564 pilot beams for the NUPA, whilst Nbeam \u2248 820 beams for the UPA. Importantly, Fig. 12 indicates that channel estimation accuracy is similar for both arrays, although the NUPA employs 256 pilots less. Consequently, it has the potential to reduce also the CSI acquisition overhead of massive MIMO BS."
        },
        {
            "heading": "C. Comparison with Patch Antennas",
            "text": "Microstrip antennas, also known as patch antennas, are widely adopted in real-world mmWave and THz MIMO systems due to their planar geometry, directional radiation characteristics, and easy fabrication into printed circuit boards [52]. As such, it is of practical interest to investigate how our superdirective design compares with a typical patch antenna array. Here, we would like to stress that the proposed superdirective pair can be readily realized with printed dipoles in order to have a planar radiating structure [53]. In the sequel, we consider a copper patch of length L and width W on top of a grounded dielectric substrate of thickness h, dielectric constant \u03f5r and loss tangent tan \u03b4. To ensure high radiation efficiency, the substrate thickness is selected in the range 0.025\u03bb \u2264 h \u2264 0.05\u03bb, where \u03bb is the free-space wavelength. Since the fields generated by the antenna propagate in two\ndifferent media, a homogeneous medium is assumed with effective dielectric constant [26]\n\u03f5reff = \u03f5r + 1\n2 + \u03f5r \u2212 1 2 1\u221a 1 + 12h/W . (71)\n1) Antenna Gain: For the dominant transverse magnetic TM010 mode, the width and length of the copper patch are chosen as [26]\nW = c\n2fr\n\u221a 2\n\u03f5r + 1 , (72)\nand\nL = c\n2fr \u221a \u03f5reff \u2212 2\u2206L, (73)\nwhere fr denotes the resonant frequency of the antenna, and\n\u2206L = 0, 412h (\u03f5reff + 0.3)(W/h+ 0.264)\n(\u03f5reff \u2212 0.258)(W/h+ 0.8) . (74)\nUsing these equations, the dimensions of the radiator are calculated for given fr, h, \u03f5r, and tan \u03b4. Next, the azimuth E\u03b8 and polar E\u03d5 components of the electric field of the antenna are specified by [54, Ch. 4]\nE\u03b8 = 2h\n\u03c0\nsin ( \u03c0W \u03bb sin \u03b8 sin\u03d5 ) sin \u03b8 sin\u03d5 cos ( \u03c0Lreff \u03bb sin \u03b8 cos\u03d5 ) cos\u03d5,\n(75)\nE\u03d5 = \u2212 2h\n\u03c0\nsin ( \u03c0W \u03bb sin \u03b8 sin\u03d5 ) sin \u03b8 sin\u03d5\n\u00d7 cos ( \u03c0Lreff \u03bb sin \u03b8 cos\u03d5 ) cos \u03b8 sin\u03d5, (76)\nwhere Lreff \u225c L+\u2206L is the effective length. Note that (75)- (76) are valid for polar angles 0 \u2264 \u03b8 \u2264 \u03c0/2 due to the presence of the ground plane. The directivity of the antenna is defined as D(\u03b8, \u03d5) \u225c 4\u03c0U/Prad, where U = 12\u03b7 (E 2 \u03b8 + E 2 \u03d5)\nis the radiation intensity and Prad = \u222b 2\u03c0 0 \u222b \u03c0/2 0\nU sin \u03b8d\u03b8d\u03d5 is the radiated power.\nFor sufficiently thin substrate, the surface wave losses can\n14\nbe neglected, and hence the radiation efficiency is determined by\n\u03b7rad = Prad\nPrad + Pc + Pd , (77)\nwhere Pc and Pd denote the power dissipated in the conducting patch and dielectric substrate, respectively. These are given by the known closed-form expressions [54, Ch. 4]\nPd = 1\n4 \u03c9\u03f50\u03f5rhLW tan \u03b4, (78)\nPc = \u03c9\u03f50\u03f5rLW\n4\u03c3cRs , (79)\nwhere \u03f50 is the permittivity of free space, \u03c9 is the angular frequency, and Rs = \u221a \u03c9\u00b5/(2\u03c3c) is the sheet resistance of the copper patch. Finally, the element gain is Ge(\u03b8, \u03d5) = \u03b7radD(\u03b8, \u03d5).\nFigure 13(a) shows the gain pattern of a single halfwavelength dipole, a supedirective dipole pair, and a rectangular patch antenna with copper and a Polydimethylsiloxane substrate (\u03f5r = 2.35, tan \u03b4 = 0.03) of thickness h = 0.03\u03bb [55]. The estimated patch antenna directivity at broadside is D(0, 0) = 7.1 dBi with radiation efficiency \u03b7rad = 60%, yielding a maxum gain Ge(0, 0) = 4.86 dBi in perfect agreement with [55], [56]. On the other hand, the superdirective dipole pair offers a 6.6 dBi gain, and exhibits sufficient directionality at the element level. Regarding the footprint of the radiators, the width of the patch antenna is determined by the width of the grounded substrate, as depicted in Fig. 13(b), and is given by Wg = 6h +W \u2248 0.56\u03bb [54]. Therefore, it is slightly larger than that of the half-wavelength dipoles comprising the superdirective pair.\n2) Array Gain: We now consider a linear array of N elements. Both the superdirective pair and the patch antenna have nulls in the radiation pattern at \u03b8 = \u03c0/2, and hence the elements can be placed in a linear configuration with subwavelength spacing and negligible mutual coupling. Therefore, the maximum broadside array gain is G(0, 0) = Ge(0, 0)N . Figure 14 shows the broadside gain difference between the patch and superdirective antenna arrays. As seen for h = 0.03\u03bb, the performance improvement is more than 20 dB for\nN > 100 antennas. More importantly, this is attained with a compact configuration as the patch antenna array will be N(Wg \u2212 \u03bb/2) > 6\u03bb wider for N > 100. Consequently, the proposed grouping architecture can enable the realization of low-profile MIMO transceivers."
        },
        {
            "heading": "X. CONCLUSIONS",
            "text": "In this paper, we introduced the novel concept of superdirective dipole pairs. Specifically, we first derived a comprehensive array model that captures the physics of mutual coupling and ohmic losses of nonideal antennas. Capitalizing on the derived model, we then studied the implementation aspects of superdirectivity, namely the impedance matching and hybrid beamforming problems. To surmount the challenges of superdirective ULAs/UPAs, we proposed to partition the BS array into multiple two-element groups of sub-wavelength spacing. The resulting NULA/NUPA facilitates multi-port impedance matching, which is optimal for any beamforming angle. More importantly, it enables the realization of superdirectivity with a single RF chain per beam. Afterwards, we pursued a performance analysis in terms of achievable rate and EE under perfect and imperfect CSI. To this end, approximate closed-form expressions for the signal and multi-user interference powers were provided under MRT. The channel estimation problem was also addressed by employing OMP along with a coupling-aware dictionary. Numerical results were finally provided demonstrating that the proposed method boosts the EE of THz massive MIMO without compromising the data transmission and channel estimation performances. As a result, arrays of superdirective dipole pairs can be a promising approach for realizing energy-efficient MIMO antennas with sharp beamforming capabilities."
        },
        {
            "heading": "ACKNOWLEDGEMENTS",
            "text": "This project has received funding from the European Research Council (ERC) under the European Union\u2019s Horizon 2020 research and innovation programme (grant agreement No. 101001331). The work of H. Q. Ngo was supported by the U.K. Research and Innovation Future Leaders Fellowships under Grant MR/X010635/1."
        },
        {
            "heading": "APPENDIX A",
            "text": "Based on the radiation equations, the electric field is specified as [26, Ch. 3]\nE(r, \u03b8, \u03d5) = \u2212j\u03b7 ke \u2212j\u03bar\n4\u03c0r (A\u03b8e\u03b8 +A\u03d5e\u03d5), (80)\nwhere\nA\u03b8 = \u222b \u2113/2 \u2212\u2113/2 I(x\u2032) cos \u03b8 cos\u03d5ej\u03bax \u2032 cos\u03d5 sin \u03b8dx\n= I(0) cos \u03b8 cos\u03d5\nsin(\u03ba\u2113/2) \u222b \u2113/2 \u2212\u2113/2 sin (\u03ba\u2113/2\u2212 \u03ba|x\u2032|) ej\u03bax \u2032 cos\u03d5 sin \u03b8dx,\n(81)\n15\nand\nA\u03d5 = \u222b \u2113/2 \u2212\u2113/2 \u2212I(x\u2032) sin\u03d5ej\u03bax \u2032 cos\u03d5 sin \u03b8dx\n= \u2212 I(0) sin\u03d5 sin(\u03ba\u2113/2) \u222b \u2113/2 \u2212\u2113/2 sin (\u03ba\u2113/2\u2212 \u03ba|x\u2032|) ej\u03bax \u2032 cos\u03d5 sin \u03b8dx.\n(82)\nUtilizing the identity [26]\u222b eax sin(\u03b2x+\u03b3)dx = eax\na2 + \u03b22 [a sin(\u03b2x+\u03b3)\u2212\u03b2 cos(\u03b2x+\u03b3)],\n(83) for a = j\u03ba cos\u03d5 sin \u03b8, \u03b2 = \u03ba, and \u03b3 = \u03ba\u2113/2, and after some algebraic manipulations, we get\u222b \u2113/2\n\u2212\u2113/2 sin (\u03ba\u2113/2\u2212 \u03ba|x\u2032|) ej\u03bax \u2032 cos\u03d5 sin \u03b8dx =\n= 2\n\u03ba cos(\u03ba\u2113/2 cos\u03d5 sin \u03b8)\u2212 cos(\u03ba\u2113/2) sin2 \u03d5+ cos2 \u03d5 cos2 \u03b8 . (84)\nCombining those equations yields the field expression in (2)."
        },
        {
            "heading": "APPENDIX B",
            "text": "The inverse matrix of Z0 is\nRe{Z0}\u22121 = 1\nR2self \u2212R2m\n[ Rself \u2212Rm \u2212Rm Rself ] . (85)\nWe now need to calculate the square root of the 2\u00d7 2 matrix Re{Z0}\u22121. To do so, we utilize the lemma [57]\nA1/2 = 1\nt [ a11 + s a12 a21 a22 + s ] , (86)\nfor A = [ a11 a12 a21 a22 ] , (87) where s = \u221a a11a22 \u2212 a12a21 and t = \u221a a11 + a22 + 2s. In our case, we have that\ns = 1\u221a\nR2self \u2212R2m , t =\n\u221a 2Rself + 2 \u221a R2self \u2212R2m\nR2self \u2212R2m . (88)\nApplying (86) to Re{Z0}\u22121, and after basic algebra, yields\nRe{Z0}\u22121/2 = 1\u221a 2Rself + 2 \u221a R2self \u2212R2m\n\u00d7  Rself\u221aR2self\u2212R2m + 1 \u2212 Rm\u221aR2self\u2212R2m \u2212 Rm\u221a\nR2self\u2212R2m Rself\u221a R2self\u2212R2m + 1  , (89) and\nRe{Z0}\u22121/2a0(\u03b8) = 1\u221a 2Rself + 2 \u221a R2self \u2212R2m\n\u00d7  Rself\u221a R2self\u2212R2m + 1\u2212 Rm\u221a R2self\u2212R2m e\u2212j\u03bad\u0304 cos \u03b8\n\u2212 Rm\u221a R2self\u2212R2m +\n( Rself\u221a\nR2self\u2212R2m + 1\n) e\u2212j\u03bad\u0304 cos \u03b8  . (90) Lastly, calculating the magnitudes of the entries of Re{Z0}\u22121/2a0(\u03b8), and some algebraic manipulations, we\nobtain (31). Also, because Z \u2248 INg \u2297 Z0 in the proposed NULA, (18) becomes\nZM =\n[ \u2212jIm{Zs}INg \u2297 I2 \u2212j \u221a RsINg \u2297 Re{Z0}1/2\n\u2212j \u221a RsINg \u2297 Re{Z0}1/2 \u2212jINg \u2297 Im{Z0}\n] .\n(91)\nWe now partition the vectors of voltages and currents at the input and output of the impedance matching network as vM = [vM,0, . . . ,vM,Ng\u22121] T , iM = [iM,0, . . . , iM,Ng\u22121] T , v = [v0, . . . ,vNg\u22121] T , and i = [i0, . . . , iNg\u22121]\nT , where vM,ng = [vM,ng , vM,ng+1]\nT is the vector of voltages at the ngth input port pair; iM,ng , vng , and ing are defined similarly. By using (91) and the previous decompositions, (16) is recast as [[\nvM,0 v0\n] \u00b7 \u00b7 \u00b7 [ vM,Ng\u22121 vNg\u22121 ]]T =\n= [ ZM,0 [ iM,0 \u2212i0 ] \u00b7 \u00b7 \u00b7 ZM,0 [ iM,Ng\u22121 \u2212iNg\u22121 ]]T , (92)\nwhich shows that ZM comprises Ng four-port matching networks, which are independent of each other."
        },
        {
            "heading": "APPENDIX C",
            "text": "We have that\u2223\u2223\u2223aH(\u03b8k)Re{Z\u0304approx}\u22121 a(\u03b8i)\u2223\u2223\u22232 aH(\u03b8i)Re { Z\u0304approx }\u22121 a(\u03b8i)\n= \u2223\u2223\u2223(aHg (\u03b8k)\u2297 aH0 (\u03b8k))(INg \u2297 Re{Z\u03040}\u22121)(ag(\u03b8i)\u2297 a0(\u03b8i))\u2223\u2223\u22232 (aHg (\u03b8i)\u2297 aH0 (\u03b8i)) ( INg \u2297 Re { Z\u03040 }\u22121) (ag(\u03b8i)\u2297 a0(\u03b8i))\n= \u2223\u2223\u2223aH0 (\u03b8k)Re{Z\u03040}\u22121 a0(\u03b8i)\u2223\u2223\u22232 aH0 (\u03b8i)Re { Z\u03040 }\u22121 a0(\u03b8i) \u2223\u2223aHg (\u03b8k)ag(\u03b8i)\u2223\u22232 Ng , (93)\nwhere the identity (A \u2297 B)(C \u2297 D) = (AC) \u2297 (BD) has been applied twice. Lastly,\u2223\u2223aHg (\u03b8k)ag(\u03b8i)\u2223\u22232\nNg =\n1\nNg \u2223\u2223\u2223\u2223\u2223\u2223 Ng\u22121\u2211 ng=0 e\u2212j\u03bang(dg+(N\u0304\u22121)d\u0304)(cos \u03b8k\u2212cos \u03b8i) \u2223\u2223\u2223\u2223\u2223\u2223 2\n= 1\nNg \u2223\u2223\u2223\u2223\u22231\u2212 e\u2212j\u03baNg(dg+(N\u0304\u22121)d\u0304)(cos \u03b8k\u2212cos \u03b8i)1\u2212 e\u2212j\u03ba(dg+(N\u0304\u22121)d\u0304)(cos \u03b8k\u2212cos \u03b8i) \u2223\u2223\u2223\u2223\u2223 2\n(94)\n= Ng|DNg ( \u03ba(dg + (N\u0304 \u2212 1)d\u0304)(cos \u03b8k \u2212 cos \u03b8i) ) |2, (95)\nwhich completes the proof."
        }
    ],
    "title": "Superdirective Antenna Pairs for Energy-Efficient Terahertz Massive MIMO",
    "year": 2023
}