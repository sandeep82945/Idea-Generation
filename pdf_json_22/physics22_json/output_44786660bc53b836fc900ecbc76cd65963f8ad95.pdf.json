{
    "abstractText": "Hybrid quantum-classical embedding methods for correlated materials simulations provide a path towards potential quantum advantage. However, the required quantum resources arising from the multi-band nature of d and f electron materials remain largely unexplored. Here we compare the performance of different variational quantum eigensolvers in ground state preparation for interacting multi-orbital embedding impurity models, which is the computationally most demanding step in quantum embedding theories. Focusing on adaptive algorithms and models with 8 spin-orbitals, we show that state preparation with fidelities better than 99.9% can be achieved using about 214 shots per measurement circuit. When including gate noise, we observe that parameter optimizations can still be performed if the two-qubit gate error lies below 10\u22123, which is slightly smaller than current hardware levels. Finally, we measure the ground state energy on IBM and Quantinuum hardware using a converged adaptive ansatz and obtain a relative error of 0.7%. https://doi.org/10.1038/s42005-022-01089-6 OPEN",
    "authors": [
        {
            "affiliations": [],
            "name": "Anirban Mukherjee"
        },
        {
            "affiliations": [],
            "name": "Noah F. Berthusen"
        },
        {
            "affiliations": [],
            "name": "Jo\u00e3o C. Getelina"
        },
        {
            "affiliations": [],
            "name": "Peter P. Orth"
        },
        {
            "affiliations": [],
            "name": "Yong-Xin Yao"
        }
    ],
    "id": "SP:13b0c8763089326f8a0dccbe018aa5e2a23e3400",
    "references": [
        {
            "authors": [
                "A. Aspuru-Guzik",
                "A.D. Dutoi",
                "P.J. Love",
                "M. Head-Gordon"
            ],
            "title": "Simulated quantum computation of molecular energies",
            "venue": "Science 309,",
            "year": 2005
        },
        {
            "authors": [
                "A Peruzzo"
            ],
            "title": "A variational eigenvalue solver on a photonic quantum processor",
            "venue": "Nat. Commun",
            "year": 2014
        },
        {
            "authors": [
                "A Kandala"
            ],
            "title": "Hardware-efficient variational quantum eigensolver for small molecules and quantum magnets",
            "venue": "Nature 549,",
            "year": 2017
        },
        {
            "authors": [
                "O\u2019Malley",
                "P. J"
            ],
            "title": "Scalable quantum simulation of molecular energies",
            "venue": "Phys. Rev. X",
            "year": 2016
        },
        {
            "authors": [
                "J. Preskill"
            ],
            "title": "Quantum computing in the NISQ era and beyond",
            "venue": "Quantum 2,",
            "year": 2018
        },
        {
            "authors": [
                "S. McArdle",
                "S. Endo",
                "A. Aspuru-Guzik",
                "S.C. Benjamin",
                "X. Yuan"
            ],
            "title": "Quantum computational chemistry",
            "venue": "Rev. Mod. Phys. 92,",
            "year": 2020
        },
        {
            "authors": [
                "M Cerezo"
            ],
            "title": "Variational quantum algorithms",
            "venue": "Nat. Rev. Phys 3,",
            "year": 2021
        },
        {
            "authors": [
                "J.R. McClean",
                "J. Romero",
                "R. Babbush",
                "A. Aspuru-Guzik"
            ],
            "title": "The theory of variational hybrid quantum-classical algorithms",
            "venue": "New J. Phys. 18,",
            "year": 2016
        },
        {
            "authors": [
                "M.R. Hoffmann",
                "J. Simons"
            ],
            "title": "A unitary multiconfigurational coupled-cluster method: theory and applications",
            "venue": "J. Chem. Phys. 88,",
            "year": 1988
        },
        {
            "authors": [
                "R.J. Bartlett",
                "S.A. Kucharski",
                "J. Noga"
            ],
            "title": "Alternative coupled-cluster ans\u00e4tze ii. the unitary coupled-cluster method",
            "venue": "Chem. Phys.Lett. 155,",
            "year": 1989
        },
        {
            "authors": [
                "R.J. Bartlett",
                "M. Musia\u0142"
            ],
            "title": "Coupled-cluster theory in quantum chemistry",
            "venue": "Rev. Mod. Phys. 79,",
            "year": 2007
        },
        {
            "authors": [
                "J Romero"
            ],
            "title": "Strategies for quantum computing molecular energies using the unitary coupled cluster ansatz",
            "venue": "Quantum Sci. Technol",
            "year": 2018
        },
        {
            "authors": [
                "H.R. Grimsley",
                "S.E. Economou",
                "E. Barnes",
                "N.J. Mayhall"
            ],
            "title": "An adaptive variational algorithm for exact molecular simulations on a quantum computer",
            "venue": "Nat. Commun",
            "year": 2019
        },
        {
            "authors": [
                "I.G. Ryabinkin",
                "Yen",
                "T.-C",
                "S.N. Genin",
                "A.F. Izmaylov"
            ],
            "title": "Qubit coupled cluster method: a systematic approach to quantum chemistry on a quantum computer",
            "venue": "J. Chem. Theory Comput",
            "year": 2018
        },
        {
            "authors": [
                "J. Lee",
                "W.J. Huggins",
                "M. Head-Gordon",
                "K.B. Whaley"
            ],
            "title": "Generalized unitary coupled cluster wave functions for quantum computation",
            "venue": "J. Chem. Theory Comput",
            "year": 2018
        },
        {
            "authors": [
                "Tang",
                "H. L"
            ],
            "title": "Qubit-adapt-vqe: an adaptive algorithm for constructing hardware-efficient ans\u00e4tze on a quantum processor",
            "venue": "PRX Quantum",
            "year": 2021
        },
        {
            "authors": [
                "F Zhang"
            ],
            "title": "Shallow-circuit variational quantum eigensolver based on symmetry-inspired hilbert space partitioning for quantum chemical calculations",
            "venue": "Phys. Rev. Res",
            "year": 2021
        },
        {
            "authors": [
                "N Gomes"
            ],
            "title": "Adaptive variational quantum imaginary time evolution approach for ground state preparation",
            "venue": "Adv. Quantum Technol",
            "year": 2021
        },
        {
            "authors": [
                "D.A. Fedorov",
                "B. Peng",
                "N. Govind",
                "Y. Alexeev"
            ],
            "title": "VQE method: a short survey and recent developments",
            "venue": "Mater. Theory 6,",
            "year": 2022
        },
        {
            "authors": [
                "J Tilly"
            ],
            "title": "The variational quantum eigensolver: a review of methods and best practices",
            "venue": "Phys. Rep. 986,",
            "year": 2022
        },
        {
            "authors": [
                "D. Wecker",
                "M.B. Hastings",
                "M. Troyer"
            ],
            "title": "Progress towards practical quantum variational algorithms",
            "venue": "Phys. Rev. A 92,",
            "year": 2015
        },
        {
            "authors": [
                "W.W. Ho",
                "T.H. Hsieh"
            ],
            "title": "Efficient variational simulation of non-trivial quantum states",
            "venue": "SciPost Phys. 6,",
            "year": 2019
        },
        {
            "authors": [
                "R Wiersema"
            ],
            "title": "Exploring entanglement and optimization within the hamiltonian variational ansatz",
            "venue": "PRX Quantum 1,",
            "year": 2020
        },
        {
            "authors": [
                "P.R. Kent",
                "G. Kotliar"
            ],
            "title": "Toward a predictive theory of correlated materials",
            "venue": "Science 361,",
            "year": 2018
        },
        {
            "authors": [
                "Z. Yin",
                "K. Haule",
                "G. Kotliar"
            ],
            "title": "Kinetic frustration and the nature of the magnetic and paramagnetic states in iron pnictides and iron chalcogenides",
            "venue": "Nat. Mater",
            "year": 2011
        },
        {
            "authors": [
                "A. Georges",
                "L. de\u2019Medici",
                "J. Mravlje"
            ],
            "title": "Strong correlations from Hund\u2019s coupling",
            "venue": "Annu. Rev. Condensed Matter Phys",
            "year": 2013
        },
        {
            "authors": [
                "L. de\u2019Medici",
                "G. Giovannetti",
                "M. Capone"
            ],
            "title": "Selective Mott physics as a key to iron superconductors",
            "venue": "Phys. Rev. Lett",
            "year": 2014
        },
        {
            "authors": [
                "Sprau",
                "P. O"
            ],
            "title": "Discovery of orbital-selective cooper pairing in FESE",
            "venue": "Science 357,",
            "year": 2017
        },
        {
            "authors": [
                "A. Georges",
                "G. Kotliar",
                "W. Krauth",
                "M.J. Rozenberg"
            ],
            "title": "Dynamical mean-field theory of strongly correlated fermion systems and the limit of infinite dimensions",
            "venue": "Rev. Mod. Phys. 68,",
            "year": 1996
        },
        {
            "authors": [
                "G Kotliar"
            ],
            "title": "Electronic structure calculations with dynamical mean-field theory",
            "venue": "Rev. Mod. Phys. 78,",
            "year": 2006
        },
        {
            "authors": [
                "Q. Sun",
                "Chan",
                "G.K.-L"
            ],
            "title": "Quantum embedding theories",
            "venue": "Acc. Chem. Res",
            "year": 2005
        },
        {
            "authors": [
                "G. Knizia",
                "Chan",
                "G.K.-L"
            ],
            "title": "Density matrix embedding: a simple alternative to dynamical mean-field theory",
            "venue": "Phys. Rev. Lett. 109,",
            "year": 2012
        },
        {
            "authors": [
                "N. Lanat\u00e0",
                "Yao",
                "Y.-X",
                "X. Deng",
                "V. Dobrosavljevi\u0107",
                "G. Kotliar"
            ],
            "title": "Slave boson theory of orbital differentiation with crystal field effects: application to uo2",
            "venue": "Phys. Rev. Lett. 118,",
            "year": 2017
        },
        {
            "authors": [
                "Lee",
                "T.-H",
                "T. Ayral",
                "Yao",
                "Y.-X",
                "N. Lanata",
                "G. Kotliar"
            ],
            "title": "Rotationally invariant slave-boson and density matrix embedding theory: unified framework and comparative study on the one-dimensional and twodimensional Hubbard model",
            "venue": "Phys. Rev. B",
            "year": 2019
        },
        {
            "authors": [
                "Yao",
                "Y.-X",
                "F. Zhang",
                "Wang",
                "C.-Z",
                "Ho",
                "K.-M",
                "P.P. Orth"
            ],
            "title": "Gutzwiller hybrid quantum-classical computing approach for correlated materials",
            "venue": "Phys. Rev. Res",
            "year": 2021
        },
        {
            "authors": [
                "R. Sakurai",
                "W. Mizukami",
                "H. Shinaoka"
            ],
            "title": "Hybrid quantum-classical algorithm for computing imaginary-time correlation functions",
            "venue": "Phys. Rev. Res",
            "year": 2022
        },
        {
            "authors": [
                "C. Vorwerk",
                "N. Sheng",
                "M. Govoni",
                "B. Huang",
                "G. Galli"
            ],
            "title": "Quantum embedding theories to simulate condensed systems on quantum computers",
            "venue": "Nat. Comput. Sci",
            "year": 2022
        },
        {
            "authors": [
                "B. Bauer",
                "D. Wecker",
                "A.J. Millis",
                "M.B. Hastings",
                "M. Troyer"
            ],
            "title": "Hybrid quantum-classical approach to correlated materials",
            "venue": "Phys. Rev. X",
            "year": 2016
        },
        {
            "authors": [
                "J. B\u00fcnemann",
                "W. Weber",
                "F. Gebhard"
            ],
            "title": "Multiband Gutzwiller wave functions for general on-site interactions",
            "venue": "Phys. Rev. B",
            "year": 1998
        },
        {
            "authors": [
                "M. Fabrizio"
            ],
            "title": "Gutzwiller description of non-magnetic Mott insulators: dimer lattice model",
            "venue": "Phys. Rev. B",
            "year": 2007
        },
        {
            "authors": [
                "X. Deng",
                "X. Dai",
                "Z. Fang"
            ],
            "title": "LDA+Gutzwiller method for correlated electron systems",
            "venue": "Europhys. Lett. 83,",
            "year": 2008
        },
        {
            "authors": [
                "N Lanata"
            ],
            "title": "\u03b3-\u03b1 isostructural transition in cerium",
            "venue": "Phys. Rev. Lett. 111,",
            "year": 2013
        },
        {
            "authors": [
                "F. Lu",
                "J. Zhao",
                "H. Weng",
                "Z. Fang",
                "X. Dai"
            ],
            "title": "Correlated topological insulators with mixed valence",
            "venue": "Phys. Rev. Lett. 110,",
            "year": 2013
        },
        {
            "authors": [
                "N. Lanat\u00e0",
                "Yao",
                "Y.-X",
                "Wang",
                "C.-Z",
                "Ho",
                "K.-M",
                "G. Kotliar"
            ],
            "title": "Phase diagram and electronic structure of praseodymium and plutonium",
            "venue": "Phys. Rev. X",
            "year": 2015
        },
        {
            "authors": [
                "Yao",
                "Y.-X"
            ],
            "title": "Python driver of Gutzwiller quantum-classical embedding simulation framework (PyGQCE). https://doi.org/10.6084/m9.figshare",
            "year": 2020
        },
        {
            "authors": [
                "G. Kotliar",
                "A.E. Ruckenstein"
            ],
            "title": "New functional integral approach to strongly correlated fermi systems: the Gutzwiller approximation as a saddle point",
            "venue": "Phys. Rev. Lett. 57,",
            "year": 1986
        },
        {
            "authors": [
                "J. B\u00fcnemann",
                "F. Gebhard"
            ],
            "title": "Equivalence of Gutzwiller and slave-boson mean-field theories for multiband Hubbard models",
            "venue": "Phys. Rev. B",
            "year": 2007
        },
        {
            "authors": [
                "L. de\u2019 Medici",
                "J. Mravlje",
                "A. Georges"
            ],
            "title": "Janus-faced influence of Hund\u2019s rule coupling in strongly correlated materials",
            "venue": "Phys. Rev. Lett",
            "year": 2011
        },
        {
            "authors": [
                "N Lanat\u00e0"
            ],
            "title": "Orbital selectivity in Hund\u2019s metals: the iron chalcogenides",
            "venue": "Phys. Rev. B",
            "year": 2013
        },
        {
            "authors": [
                "H Abraham"
            ],
            "title": "Qiskit: an open-source framework for quantum computing",
            "venue": "Zenodo https://github.com/Qiskit/qiskit",
            "year": 2019
        },
        {
            "authors": [
                "T. Stein",
                "T.M. Henderson",
                "G.E. Scuseria"
            ],
            "title": "Seniority zero pair coupled cluster doubles theory",
            "venue": "J. Chem. Phys. 140,",
            "year": 2014
        },
        {
            "authors": [
                "T.M. Henderson",
                "I.W. Bulik",
                "G.E. Scuseria"
            ],
            "title": "Pair extended coupled cluster doubles",
            "venue": "J. Chem. Phys. 142,",
            "year": 2015
        },
        {
            "authors": [
                "Yao",
                "Y.-X"
            ],
            "title": "Python code to perform Qubit-ADAPT VQE calculations with statevector simulator",
            "year": 2022
        },
        {
            "authors": [
                "Yao",
                "Y.-X",
                "J.C. Getelina"
            ],
            "title": "Python code for VQE calculations with generic Hamiltonian Variational Ansatz",
            "year": 1934
        },
        {
            "authors": [
                "S McArdle"
            ],
            "title": "Variational ansatz-based quantum simulation of imaginary time evolution",
            "venue": "npj Quantum Inf. 5,",
            "year": 2019
        },
        {
            "authors": [
                "A.F. Izmaylov",
                "Yen",
                "T.-C",
                "R.A. Lang",
                "V. Verteletskyi"
            ],
            "title": "Unitary partitioning approach to the measurement problem in the variational quantum eigensolver method",
            "venue": "J. Chem. Theory Comput",
            "year": 2019
        },
        {
            "authors": [
                "P Gokhale"
            ],
            "title": "Minimizing state preparations in variational quantum eigensolver by partitioning into commuting families",
            "year": 2019
        },
        {
            "authors": [
                "A Zhao"
            ],
            "title": "Measurement reduction in variational quantum algorithms",
            "venue": "Phys. Rev. A 101,",
            "year": 2020
        },
        {
            "authors": [
                "O Crawford"
            ],
            "title": "Efficient quantum measurement of Pauli operators in the presence of finite sampling error",
            "venue": "Quantum 5,",
            "year": 2021
        },
        {
            "authors": [
                "Yen",
                "T.-C",
                "A.F. Izmaylov"
            ],
            "title": "Cartan subalgebra approach to efficient measurements of quantum observables",
            "venue": "PRX Quantum",
            "year": 2021
        },
        {
            "authors": [
                "Huggins",
                "W. J"
            ],
            "title": "Efficient and noise resilient measurements for quantum chemistry on near-term quantum computers",
            "venue": "npj Quantum Inf",
            "year": 2021
        },
        {
            "authors": [
                "K.M. Nakanishi",
                "K. Fujii",
                "S. Todo"
            ],
            "title": "Sequential minimal optimization for quantum-classical hybrid algorithms",
            "venue": "Phys. Rev. Res",
            "year": 2020
        },
        {
            "authors": [
                "M.D. Zeiler"
            ],
            "title": "Adadelta: an adaptive learning rate method",
            "year": 2012
        },
        {
            "authors": [
                "A. Mukherjee",
                "Yao",
                "Y.-X"
            ],
            "title": "Circuit Implementation of qubit-ADAPT VQE",
            "year": 2022
        },
        {
            "authors": [
                "D. Claudino",
                "J. Wright",
                "A.J. McCaskey",
                "T.S. Humble"
            ],
            "title": "Benchmarking adaptive variational quantum eigensolvers",
            "venue": "Front. Chem",
            "year": 2020
        },
        {
            "authors": [
                "Y.S. Yordanov",
                "V. Armaos",
                "C.H. Barnes",
                "D.R. Arvidsson-Shukur"
            ],
            "title": "Qubitexcitation-based adaptive variational quantum eigensolver",
            "venue": "Commun. Phys. 4,",
            "year": 2021
        },
        {
            "authors": [
                "X Bonet-Monroig"
            ],
            "title": "Performance comparison of optimization methods on variational quantum algorithms",
            "year": 2021
        },
        {
            "authors": [
                "A. Mari",
                "T.R. Bromley",
                "N. Killoran"
            ],
            "title": "Estimating the gradient and higher-order derivatives on quantum hardware",
            "venue": "Phys. Rev. A 103,",
            "year": 2021
        },
        {
            "authors": [
                "V. Shkolnikov",
                "N.J. Mayhall",
                "S.E. Economou",
                "E. Barnes"
            ],
            "title": "Avoiding symmetry roadblocks and minimizing the measurement overhead of adaptive variational quantum eigensolvers",
            "year": 2021
        },
        {
            "authors": [
                "D. Finke"
            ],
            "title": "IBM Demonstrates 99.9% CNOT Gate Fidelity On A New Superconducting Test Device (Quantum Computing",
            "year": 2021
        },
        {
            "authors": [
                "M Urb\u00e1nek"
            ],
            "title": "Mitigating depolarizing noise on quantum computers with noise-estimation circuits",
            "venue": "Phys. Rev. Lett. 127,",
            "year": 2021
        },
        {
            "authors": [
                "J Vovrosh"
            ],
            "title": "Simple mitigation of global depolarizing errors in quantum simulations",
            "venue": "Phys. Rev. E",
            "year": 2021
        },
        {
            "authors": [
                "Y. Li",
                "S.C. Benjamin"
            ],
            "title": "Efficient variational quantum simulator incorporating active error minimization",
            "venue": "Phys. Rev. X",
            "year": 2017
        },
        {
            "authors": [
                "K. Temme",
                "S. Bravyi",
                "J.M. Gambetta"
            ],
            "title": "Error mitigation for short-depth quantum circuits",
            "venue": "Phys. Rev. Lett. 119,",
            "year": 2017
        },
        {
            "authors": [
                "R. LaRose",
                "A. Mari",
                "P.J. Karalekas",
                "N. Shammah",
                "W.J. Zeng"
            ],
            "title": "Mitiq: a software package for error mitigation on noisy quantum computers",
            "venue": "Quantum 6,",
            "year": 2022
        },
        {
            "authors": [
                "T. Giurgica-Tiron",
                "Y. Hindy",
                "R. LaRose",
                "A. Mari",
                "W.J. Zeng"
            ],
            "title": "Digital zero noise extrapolation for quantum error mitigation",
            "venue": "IEEE International Conference on Quantum Computing and Engineering (QCE),",
            "year": 2020
        },
        {
            "authors": [
                "P Virtanen"
            ],
            "title": "Scipy 1.0: fundamental algorithms for scientific computing in python",
            "venue": "Nat. Methods 17,",
            "year": 2020
        },
        {
            "authors": [
                "S. Endo",
                "S.C. Benjamin",
                "Y. Li"
            ],
            "title": "Practical quantum error mitigation for nearfuture applications",
            "venue": "Phys. Rev. X",
            "year": 2018
        },
        {
            "authors": [
                "E. van den Berg",
                "Z.K. Minev",
                "A. Kandala",
                "K. Temme"
            ],
            "title": "Probabilistic error cancellation with sparse Pauli\u2013Lindblad models on noisy quantum processors",
            "year": 2022
        },
        {
            "authors": [
                "P. Czarnik",
                "A. Arrasmith",
                "P.J. Coles",
                "L. Cincio"
            ],
            "title": "Error mitigation with Clifford quantum-circuit data",
            "venue": "Quantum 5,",
            "year": 2021
        },
        {
            "authors": [
                "A Lowe"
            ],
            "title": "Unified approach to data-driven quantum error mitigation",
            "venue": "Phys. Rev. Res",
            "year": 2021
        },
        {
            "authors": [
                "J Rogers"
            ],
            "title": "Error mitigation in variational quantum eigensolvers using probabilistic machine learning",
            "year": 2021
        }
    ],
    "sections": [
        {
            "heading": "ARTICLE",
            "text": "Comparative study of adaptive variational quantum eigensolvers for multi-orbital impurity models Anirban Mukherjee1, Noah F. Berthusen1,2,3, Jo\u00e3o C. Getelina1, Peter P. Orth 1,4\u2709 & Yong-Xin Yao 1,4\u2709\nHybrid quantum-classical embedding methods for correlated materials simulations provide a\npath towards potential quantum advantage. However, the required quantum resources arising\nfrom the multi-band nature of d and f electron materials remain largely unexplored. Here we\ncompare the performance of different variational quantum eigensolvers in ground state\npreparation for interacting multi-orbital embedding impurity models, which is the computa-\ntionally most demanding step in quantum embedding theories. Focusing on adaptive algo-\nrithms and models with 8 spin-orbitals, we show that state preparation with fidelities better\nthan 99.9% can be achieved using about 214 shots per measurement circuit. When including\ngate noise, we observe that parameter optimizations can still be performed if the two-qubit\ngate error lies below 10\u22123, which is slightly smaller than current hardware levels. Finally, we\nmeasure the ground state energy on IBM and Quantinuum hardware using a converged\nadaptive ansatz and obtain a relative error of 0.7%.\nhttps://doi.org/10.1038/s42005-022-01089-6 OPEN\n1 Ames National Laboratory, U.S. Department of Energy, Ames, IA 50011, USA. 2Department of Electrical and Computer Engineering, Iowa State University, Ames, IA 50011, USA. 3 Department of Computer Science, University of Maryland, College Park, MD 20742, USA. 4Department of Physics and Astronomy, Iowa State University, Ames, IA 50011, USA. \u2709email: porth@iastate.edu; ykent@iastate.edu\nCOMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys 1\n12 34\n56 78\n9 0 () :,;\nEigenstate preparation for Hamiltonian systems is one pro-mising application of noisy intermediate-scale quantum(NISQ) computers to achieve practical quantum advantage1\u20137. One of the representative hybrid quantum-classical algorithms to achieve this task is the variational quantum eigensolver (VQE). It attempts to find the ground state of a given Hamiltonian H within a variational manifold of states that are generated by parametrized quantum circuits U(\u03b8) acting on a reference state \u03a80\n. The parameters \u03b8 are obtained by classically minimizing the energy cost function E\u00f0\u03b8\u00de \u00bc \u03a80jUy\u00f0\u03b8\u00deHU\u00f0\u03b8\u00dej\u03a80 that is measured on quantum hardware2\u20134,8. The quality of a VQE calculation is tied to the ability of the variational ansatz to represent the ground state with high fidelity. In quantum computational chemistry, the unitary coupled cluster ansatz truncated at single and double excitations (UCCSD) has been extensively studied, owing to the success of the classical coupled cluster algorithm9\u201311. It was found that the application of UCCSD ansatz is limited by the rapid circuit growth with system size and the deteriorating accuracy in the presence of static electron correlations8,12,13. Therefore, alternative variants have been developed, including hardwareefficient ans\u00e4tze, that improve the trainability and expressivity of the wave function ansatz3,13\u201320.\nIndeed, it was found that compact and numerically exact variational ground state ans\u00e4tze can be adaptively constructed for specific problems using approaches like the adaptive derivativeassembled pseudo-trotter (ADAPT) ansatz13,16. The adaptive ansatz is typically obtained by successively appending parametrized unitaries to a variational circuit with generators chosen from a predefined operator pool. In practice, the ADAPT-VQE algorithm works well with an operator pool composed of fermionic excitation operators in the UCCSD ansatz. The extended qubit-ADAPT VQE approach16 utilizes an operator pool composed of Pauli strings in the qubit representation of fermionic excitation operators in the UCCSD ansatz, which is shown to be capable of generating significantly more compact ans\u00e4tze than the original ADAPT-VQE method at the price of introducing more variational parameters. As the circuit complexity (i.e., the number of two-qubit operations in the circuit) is a determining factor for practical calculations on NISQ devices, qubit-ADAPT is preferable and chosen for the comparative study in this work. Regarding the scalability of the qubit-ADAPT method towards larger system sizes, we note that reference18 reports a favorable linear system-size scaling for the adaptive ansatz complexity of nonintegrable mixed-field Ising model using the adaptive variational quantum imaginary time evolution method (AVQITE). AVQITE is known to generate variational circuits of comparable complexity as qubit-ADAPT VQE. As a first step to investigate the scalability in fermionic models, we here study qubit-ADAPT VQE for fermionic models with two and three spinful orbitals.\nAn alternative approach to constructing efficient wavefunction ans\u00e4tze for problems in condensed matter physics is to exploit the sparsity of the Hamiltonian. Interacting electron systems are often simulated with reduced degrees of freedom, represented, for example, by a single-band Hubbard model. This simplified model features a sparse Hamiltonian including nearest-neighbor hopping and onsite Coulomb interactions only. Motivated by the simplicity of the Trotterized circuits for dynamics simulations due to Hamiltonian sparsity, the Hamiltonian variational ansatz (HVA) has been proposed by promoting the time in Trotter circuits to independent variational parameters21. The HVA ansatz has attracted much attention and turns out to be very successful in reaching a compact state representation for sparse Hamiltonian systems including local spin models21\u201323. Here, we propose to combine the flexibility of an adaptive approach with the efficiency of the HVA by designing a \u201cHamiltonian\ncommutator\u201d (HC) operator pool that contains pairwise commutators of operators that appear in the Hamiltonian.\nTo obtain a realistic description of correlated quantum materials, which typically contain partially filled d-orbitals such as transition metal compounds, or f-orbitals such as rare-earth and actinide systems, it is important to go beyond the single-orbital description of a simple Hubbard model24. Intriguing physics arises from the local Hund\u2019s coupling of electrons in different atomic orbitals. Examples are bad metallic behavior with suppressed quasiparticle coherence and orbital-selective Mott transitions or superconducting pairing, which naturally require a multi-orbital description25\u201328. A multi-orbital model including additional inter-orbital hoppings and Hund\u2019s couplings will necessarily make the Hamiltonian less sparse and consequently the HVA ansatz more complicated. Nevertheless, the complexity of material simulations can be greatly reduced by quantum embedding methods which map the infinite system to coupled subsystems, typically a noninteracting effective medium and some many-body interacting impurity models24,29\u201337. These quantum embedding approaches have proven to be very effective to simulate correlated electron systems, including energies, electronic structure, magnetism, superconductivity, and spectral properties of multiple competing phases. The computational load in these approaches is shifted from the solution of a full lattice system to that of an interacting multi-orbital impurity model. Classical algorithms for solving the impurity problem, however, are not scalable, which can be more tractable with quantum computers35,38.\nIn this paper, we compare the VQE circuit complexity for ground state preparation of multi-orbital many-body impurity models with a fixed HVA versus a qubit-ADAPT ansatz with different operator pools. An HC operator pool compatible with HVA is proposed to allow a fair comparison between qubitADAPT and fixed ansatz HVA calculations. For comparison, we also include results from UCCSD and qubit-ADAPT calculations with a simplified UCCSD pool. To connect with quantum embedding methods for realistic materials simulations, we use the Gutzwiller embedding approach33,39\u201344 to generate the impurity models that we employ for our benchmark35,45. The quantum calculation we perform is general and could also be applied to other embedding methods. Numerical results from a noiseless state vector simulator and quantum assembly language (QASM)based simulator with quantum sampling noise are presented. Important techniques for efficient circuit simulations of qubitADAPT VQE are discussed, including ways to simplify generators and reduce the operator pool size. We further investigate the impact of realistic gate noise by performing qubit-ADAPT VQE simulations with a realistic noise model including amplitude and dephasing channels. Finally, we measure the energy cost function of the converged VQE ansatz for the eg model composed of eight spin-orbitals on the IBM quantum processing unit (QPU) ibmq_casablanca and on Quantinuum hardware."
        },
        {
            "heading": "Results and discussion",
            "text": "Quantum embedding model. Here we focus on a specific quantum embedding method: the well-established Gutzwiller variational embedding approach for correlated material simulations33,39\u201344, which is known to be equivalent to rotationally invariant slave-boson theory at the saddle point approximation46,47. Recently, our group has developed a hybrid Gutzwiller quantum-classical embedding approach (GQCE)35. GQCE maps the ground state solution of a correlated electron lattice system to a coupled eigenvalue problem of a noninteracting quasiparticle Hamiltonian and one or multiple finitesize interacting embedding Hamiltonians44. Within GQCE one\n2 COMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys\nemploys a quantum computer to find the ground state energy and the single-particle density matrix of the interacting embedding Hamiltonian, for example, using VQE.\nThe embedding Hamiltonian describes an impurity model consisting of a physical many-body NS-orbital subsystem (H\u0302S) coupled with a NB-orbital quadratic bath (H\u0302B): H\u0302 \u00bc H\u0302S \u00fe H\u0302B \u00fe H\u0302SB; \u00f01\u00de with\nH\u0302S \u00bc \u2211 \u03b1\u03b2 \u2211 \u03c3 \u03f5\u03b1\u03b2c\u0302 y \u03b1\u03c3 c\u0302 y \u03b2\u03c3 \u00fe 1 2 \u2211 \u03b1\u03b2\u03b3\u03b4 \u2211 \u03c3\u03c3 0 V\u03b1\u03b2\u03b3\u03b4 c\u0302 y \u03b1\u03c3 c\u0302 y \u03b3\u03c3 0 c\u0302 y \u03b4\u03c3 0 c\u0302 y \u03b2\u03c3 ; \u00f02\u00de\nH\u0302B \u00bc \u2211 ab \u2211 \u03c3 \u03bbabf\u0302\ny a\u03c3 f\u0302 y b\u03c3 ; \u00f03\u00de\nH\u0302SB \u00bc \u2211 a\u03b1 \u2211 \u03c3\nDa\u03b1c\u0302y\u03b1\u03c3 f\u0302 y a\u03c3 \u00fe h:c: : \u00f04\u00de\nHere \u03b1, \u03b2, \u03b3, \u03b4 are composite indices for sites and spatial orbitals in the physical subsystem. Likewise, the bath sites and orbitals are labeled by a, b, and \u03c3 is the spin index. The fermionic ladder operators c\u0302y and f\u0302 y are used to distinguish the physical and bath orbital sites. The one-body component and two-body Coulomb interaction in the physical subsystem are specified by matrix \u03f5 and tensor V. The quadratic bath and its coupling to the subsystem are defined by matrix \u03bb and D, respectively. Compared with typical quantum chemistry calculations, the embedding Hamiltonian is much sparser since the two-body interaction only exists between electrons in the physical subsystem.\nFor clarification, we name the above-defined embedding Hamiltonian system as (NS;NB) impurity model, where (NS;NB) is the number of spatial orbitals in the system and bath models. Within GQCE, the ground state solution of the embedding Hamiltonian at half-electron filling is needed, which is achieved by a chemical potential absorbed in the one-body Hamiltonian coefficient matrices \u03f5 and \u03bb in Eq. (1).\nIn the numerical simulations presented here, we choose a Gutzwiller embedding Hamiltonian for the degenerate M-band Hubbard model. The noninteracting density of states of the lattice\nmodel adopts a semi-circular form \u03c1\u00f0\u03c9\u00de \u00bc 2M\u03c0D ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi 1 \u00f0\u03c9=D\u00de2 q as shown in Fig. 1a, which corresponds to the Bethe lattice in infinite dimensions. In the following, we set the half band width D= 1 as the energy unit. In physical systems, D is of the order of a few eV. The Coulomb matrix V takes the Kanamori form specified by\nHubbard U and Hund\u2019s J parameters: V\u03b1\u03b1\u03b1\u03b1=U, V\u03b1\u03b1\u03b2\u03b2=U\u22122J, and V\u03b1\u03b2\u03b1\u03b2=V\u03b1\u03b2\u03b2\u03b1= J for \u03b1 \u2260 \u03b2. Here we have assumed spin and orbital rotational invariance (within the eg or t2g manifold) for simplicity and to limit the interaction parameter space.\nThe embedding Hamiltonian, as illustrated in Fig. 1b, is represented with 2M spatial orbitals: M degenerate physical orbital plus M degenerate bath orbitals. The symmetry of the model reduces matrices \u03f5, \u03bb and D to single parameters proportional to identity.\nIn the following, we set the electron filling for the lattice model to M\u00fe 1, which is one unit larger than half-filling, and fix the ratio of the Hund\u2019s to Hubbard interaction to J/U= 0.3 and U= 7. These parameters put the model deep in the correlationinduced bad metallic state, with physical properties distinct from doped Mott insulators25. It represents a wide class of strongly correlated materials, such as iron pnictides and chalcogenides, where Hund\u2019s coupling significantly reduces the low-energy quasiparticle coherence scale26,48,49. Hund\u2019s metal physics is far beyond a static mean-field description and requires treating the localized and itinerant characters of electrons on equal footing, which can be realized in the quantum embedding approach adopted here.\nIn the calculations below, we consider M \u00bc 2 and M \u00bc 3, which correspond to eg and t2g orbitals in cubic crystal symmetry, respectively. The associated \u00f0NS;NB\u00de \u00bc \u00f02; 2\u00de and (3, 3) impurity models have in total 8 and 12 spin-orbitals. The two models host nontrivial many-body ground states and represent important checkpoints along the path to achieve a practical quantum advantage in correlated materials simulations through a hybrid quantum-classical embedding framework. In quantum simulations reported below, parity encoding which exploits the symmetry in a total number of electrons and spin z-component is used to transform the fermionic Hamiltonian to qubit representation.\nVariational quantum eigensolvers. GQCE leverages quantum computing technologies to solve for the ground state of the embedding Hamiltonian, specifically the energy and one-particle density matrix. Note that the ground state is always prepared at half-filling for the embedding system, which is determined by the Gutzwiller embedding algorithm and is independent of the actual electron filling of the physical lattice model33,44. For this purpose, we benchmark multiple versions of VQE with fixed or adaptively generated ansatz to prepare the ground state of the above embedding Hamiltonian. We consider VQE calculations with fixed UCCSD ansatz and the associated qubit-ADAPT VQE using a simplified UCCSD operator pool. The calculations are naturally performed in the molecular orbital (MO) basis representation, where the reference Hartree\u2013Fock (HF) state becomes a simple tensor product state and fermionic excitation operators can be naturally defined. However, using a MO representation comes at the cost of reducing the sparsity of the embedding Hamiltonian compared to the atomic orbital (AO) basis representation. To take advantage of the Hamiltonian sparsity in AO representation, we consider a generalized form of the HVA and the associated qubit-ADAPT VQE with a modified HC operator pool.\nVQE algorithm. For an Nq-qubit system with Hamiltonian H\u0302, VQE amounts to minimizing the cost function E\u00f0\u03b8\u00de \u00bc h\u03a8\u00bd\u03b8 j H\u0302 j\u03a8\u00bd\u03b8 i with respect to the variational parameters \u03b8, as schematically illustrated in Fig. 2. Here, \u03a8\u00bd\u03b8\n\u00bc U\u0302\u00f0\u03b8\u00de \u03a80 is obtained by application of a parametrized quantum circuit U\u0302\u00f0\u03b8\u00de onto a reference state \u03a80\n. The cost function is evaluated on a quantum computer and the optimization is performed classically\ninteractions among the physical orbitals are specified by the Coulomb matrix V. Due to symmetry, each physical orbital (positioned at zero energy level) is coupled with a single bath orbital at energy level \u03bb with a coupling parameter D. The models with M \u00bc 2 and 3 correspond to that of eg and t2g orbitals in cubic crystal symmetry, respectively.\nCOMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys 3\nusing E(\u03b8) as input. The accuracy of VQE is therefore tied to the variational ansatz \u03a8\u00bd\u03b8\nand to the performance of the classical optimization, e.g., how often the cost function is called during the optimization and how well the approach converges to the global (as opposed to a local) minimum of E(\u03b8).\nUCCSD ansatz. The UCCSD ansatz takes the following form:\n\u03a8\u00bd\u03b8 \u00bc eT\u0302\u00bd\u03b8 T\u0302y\u00bd\u03b8 \u03a80 \u00bc e i\u2211j\u03b8j f j\u00f0f\u03c3\u0302g\u00de \u03a80 : \u00f05\u00de\nThe operator T\u0302\u00bd\u03b8 consists of single and double excitation operators with respect to the HF reference state \u03a80\n: T\u0302\u00bd\u03b8 \u00bc \u2211\np p \u03b8 ppc\u0302 y pc\u0302p \u00fe \u2211 p<q; p< q \u03b8 p qpqc\u0302 y pc\u0302 y qc\u0302qc\u0302p: \u00f06\u00de\nHere p, q and p; q refer to the occupied and unoccupied MOs, respectively, with spin included implicitly. f j\u00f0f\u03c3\u0302g\u00de \u00bc \u2211kwjkP\u0302k is a weighted sum of Pauli strings (P\u0302k 2 fI;X;Y;Zg Nq) for the qubit representation of the fermionic excitation operator associated with parameter \u03b8j. Here \u03b8j runs over the set of parameters \u03b8 p p and \u03b8 p qpq. For the impurity model without spin\u2013orbit interaction, only excitation operators which conserve a respective number of electrons in the spin-up and spin-down sectors need to be considered. In practical implementation, a single-step Trotter approximation is often adopted to construct the UCCSD circuit:\n\u03a8\u00bd\u03b8 Y\njk\ne i\u03b8jwjkP\u0302k \u03a80 : \u00f07\u00de\nFurthermore, the final circuit state generally depends on the order of the unitary gates. In the calculations reported here, we apply gates with single-excitation operators first following the implementation in Qiskit50.\nQubit-ADAPT VQE with simplified UCCSD pool. VQE-UCCSD is a useful reference point for quantum chemistry calculations. However, the fixed UCCSD ansatz has limited accuracy and often\ninvolves deep quantum circuits for implementations. Various approaches have been proposed to construct a more compact variational ansatz with systematically improvable accuracy. In this work, we will focus on the qubit-ADAPT VQE method16, where the ansatz takes a similar pseudo-Trotter form:\n\u03a8\u00bd\u03b8 \u00bc YN\u03b8\nj\u00bc1 e i\u03b8j P\u0302j \u03a80 : \u00f08\u00de With qubit-ADAPT, the ansatz is recursively expanded by adding one unitary at a time, followed by reoptimization of parameters. The additional unitary is constructed with a generator selected from a predefined Pauli string pool which gives maximal energy gradient amplitude jgjmax at the preceding ansatz state. The ansatz expansion process iterates until convergence, which is set by jgjmax<10 4 here. Note that we have set the half bandwidth of the original noninteracting lattice model to D= 1, such that jgjmax 0:1 meV in physical systems with D ~ 1 eV.\nThe computational complexity of qubit-ADAPT VQE calculations is tied to the size of the operator pool, which consists of a set of Pauli strings. Naturally, one can construct an operator pool using all the Pauli strings in the qubit representation of fermionic single and double excitation operators. However, the dimension of this UCCSD-compatible pool is usually quite big and scales as O\u00f0N4q\u00de. Here we propose a much-simplified operator pool, which consists of Pauli strings from single-excitation and paired doubleexcitation operators only. The pair excitation involves a pair of electrons with opposite spins, which are initially occupying the same spatial MO, hopping together to another initially unoccupied spatial MO. To further reduce the circuit depth, only one Pauli string is chosen from each qubit representation of the fermionic excitation operator. The qubit representation is a weighted sum of equal-length Pauli strings, and a specific choice of which one of them does not seem to be important in practical calculations reported here. This simplified pool containing operators arising from the UCC ansatz restricted to single and paired double excitation operators (sUCCSpD)51,52 greatly reduces the number of Pauli strings compared to the UCCSD pool. The dimension of this sUCCSpD pool scales as O\u00f0N2q\u00de. For the (2, 2) eg impurity model, the pool size reduces from 152 for UCCSD to 56 for sUCCSpD, and for the (3, 3) t2g impurity model it reduces from 828 to 192. The code to perform the above qubitADAPT VQE calculations at the state vector level with examples are available in figshare53.\nHamiltonian variational ansatz. The Hamiltonian sparsity in the AO basis naturally motivates the application of the Hamiltonian variational ansatz21, which generally takes the form of multi-layer Trotterized annealing-like circuits. While different ways of designing specific HVA forms have been developed, we propose the following ansatz with L layers for the impurity model:\n\u03a8\u00bd\u03b8 \u00bc YL\nl\u00bc1 YNG j\u00bc1 e i\u03b8lj h\u0302j \u03a80 : \u00f09\u00de\nHere H\u0302 \u00bc \u2211NGj\u00bc1 h\u0302j, with h\u0302j being a subgroup of Hamiltonian terms which share the same coefficient and mutually commute. Such ansatz construction aims to differentiate the physical and bath orbitals while retaining the degeneracy information among the orbitals in a systematic way. For each layer of unitaries, we first apply the multi-qubit rotations that are generated by the interacting part of the Hamiltonian, since these act as entangling gates. For the (M;M) impurity model, two reference states have been tried: \u03a8\u00f0I\u00de0 E is a simple tensor product state with M\niteration of state preparation and energy measurement. The cycle continues until E(\u03b8) converges.\n4 COMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys\nphysical orbitals fully occupied and the bath orbitals empty; \u03a8\u00f0II\u00de0 E is the ground state of the noninteracting part of H\u0302, which is equivalent to the one-electron core Hamiltonian in quantum chemistry. We did not find any significant difference between the two choices of reference state in practical simulations of the impurity models. Therefore, only HVA calculations with the\nreference state \u03a8\u00f0I\u00de0 E are reported here. We adopt the gradient-\nbased Broyden\u2013Fletcher\u2013Goldfarb\u2013Shanno (BFGS) algorithm as the classical optimizer. Proper parameter initialization for HVA optimization is crucial, as barren plateaus and local energy minima are generally present in the variational energy landscape. In practice, we find that a uniform initialization of the parameters, such as setting all to \u03c0/7, overall works well for simulations reported here.\nInspired by the idea of adaptive ansatz generation13, we also tried constructing and optimizing an L-layer HVA ansatz by adaptively adding layers from 1 to L. Specifically, the calculation starts with optimizing a single-layer ansatz, followed by appending another layer to the ansatz while keeping the first layer at previously obtained optimal angles. The two-layer ansatz is then optimized with the parameters for the new layer initialized randomly or uniformly. The procedure continues with the optimization of l-layer ansatz leveraging the (l\u22121)-layer solution until the ansatz reaches L layers.\nLet the number of cost function evaluations for optimizing an l-layer ansatz be N\u00f02\u00del . The total number of function evaluations amounts to N\u00f02\u00de \u00bc \u2211Ll\u00bc1 N \u00f02\u00del . In practice, we find that the direct optimization of the L-layer ansatz using a uniform initialization takes N(1) function evaluations with N \u00f01\u00de N\u00f02\u00deL <N\u00f02\u00de, and reaches the same accuracy. Starting with L layers is therefore more efficient than growing the ansatz layer by layer.\nIntuitively, this can be related to the fact that successive HVA optimization introduces discontinuities in the variational path toward the ground state whenever a new layer of unitaries is added. Since the energy gradient associated with new variational parameters that are initialized to zero (for continuity) vanishes (see the \u201cMethods\u201d section), they have to be initialized away from zero. In other words, the (l\u22121)-layer HVA solution is not a good starting point for the optimization of the l-layer ansatz. The open source code to perform the above HVA calculations at the state vector level with examples are available in figshare54.\nHamiltonian commutator pool. It has been demonstrated that the qubit-ADAPT VQE in the MO basis outperforms VQE-UCCSD calculations regarding circuit complexity and numerical accuracy13,16. Motivation by this observation, we compare the corresponding qubit-ADAPT VQE with a Hamiltoniancompatible pool in AO basis and HVA calculations. Following\nHVA, we choose the simple tensor product state \u03a8\u00f0I\u00de0 E as the\nreference state. In the qubit-ADAPT step, the energy gradient criterion g\u03b8 \u00bc 2Im\u00bdh\u03a8\u00bd\u03b8 j P\u0302H\u0302 j\u03a8\u00bd\u03b8 i to append a new unitary generated by P\u0302 vanishes due to symmetry with \u03a8[\u03b8], if the number of Pauli-Y operators in the Pauli string P\u0302 is even13,55. This can be simply shown by the following argument. Because the impurity model in this study respects time-reversal symmetry and spin-flip (Z2) symmetry, both Hamiltonian H\u0302 and wavefunction are real (H\u0302 \u00bc H\u0302 ;\u03a8\u00bd\u03b8 \u00bc \u03a8\u00bd\u03b8 ). The Pauli string P\u0302 is also real (P\u0302 \u00bc P\u0302 ) if it has an even number of Pauli-Y operators. Consequently, the expectation value of h\u03a8\u00bd\u03b8 j P\u0302H\u0302 j\u03a8\u00bd\u03b8 i is real and g\u03b8 vanishes if the associated generator P\u0302 has an even number of Pauli-Y operators.\nBy construction, the sUCCSpD pool consists of Pauli strings of an odd number of Y\u2019s. However, the Hamiltonian of the impurity models studied here is all real. Consequently, all the Pauli strings in the qubit representation of the Hamiltonian contain an even number of Y\u2019s, which excludes the option of directly constructing the operator pool from the Hamiltonian operators. Nevertheless, the practical usefulness of HVA implies that the Hamiltonian-like pool can be constructed by commuting the Hamiltonian terms, which we call the Hamiltonian commutator (HC) pool PHC. Mathematically PHC is constructed in the following manner:\nPHC \u00bc f 12i \u00bdP\u0302; P\u0302 0 j P\u0302; P\u03020 2 PH; andNY \u00f0\u00bdP\u0302; P\u0302 0 \u00de\u00f0mod 2\u00de \u00bc 1g; \u00f010\u00de\nHere PH is the set of Pauli strings fP\u0302hg present in the qubit representation of Hamiltonian H\u0302 \u00bc \u2211hwhP\u0302h. NY \u00f0P\u0302\u00de counts the number of Y operators in the Pauli string P\u0302. Therefore, the size of PHC can scale as N 2 H, where NH is the total number of Hamiltonian terms. Clearly, the pool PHC should only be applied to sparse Hamiltonian systems. The dimension of the HC pool is 56 for the eg impurity model, and 192 for the t2g model.\nQuantum circuit implementation. Performing a calculation on a quantum computer always needs to deal with the presence of noise. Even for ideal fault-tolerant quantum computers, quantum sampling (or shot) noise is present due to a finite number of measurements that are used to estimate expectation values. The current noisy quantum devices exhibit additional noise originating from qubit relaxation and dephasing as well as hardware imperfections when implementing unitary gate operations. In this subsection, we describe several techniques adopted in our simulations to most efficiently use the available quantum resources and stabilize the calculations against sampling noise. We discuss how to mitigate gate noise in the final subsection.\nMeasurement circuit reduction. The quantum circuit implementation for VQE and its adaptive version amounts to the direct measurement of the Hamiltonian as a weighted sum of Pauli string expectation values, hH\u0302i \u00bc \u2211hwhhP\u0302hi, with respect to parametrized circuits U[\u03b8]. Here, H\u0302 \u00bc \u2211hwhP\u0302h is the Hamiltonian in qubit representation. Because the number of shots (or repeated measurements) scales with the desired precision \u03f5 as Nsh / 1\u03f52 due to the central limit theorem, Nsh is often huge in practical calculations. Therefore, it is desirable to group the Pauli strings into mutually commuting sets such that the number of distinct measurement circuits is reduced to a minimum. Indeed, many techniques to achieve such measurement reduction have been developed56\u201361. In this work, we adopt the measurement reduction strategy based on the Hamiltonian integral factorization61, which shows a favorable linear system-size scaling of the number of distinct measurement circuits and embraces a diagonal representation for the operators to be measured.\nSpecifically, we transform the physical subsystem Hamiltonian as follows:\nH\u0302S \u00bc \u2211 \u03b1\u03b2\u03c3 e\u03f5\u03b1\u03b2c\u0302y\u03b1\u03c3 c\u0302\u03b2\u03c3 \u00fe 12 \u2211\u03b1\u03b2\u03b3\u03b4 \u2211\u03c3\u03c3 0 V\u03b1\u03b2\u03b3\u03b4 c\u0302y\u03b1\u03c3 c\u0302y\u03b2\u03c3 c\u0302y\u03b3\u03c30 c\u0302\u03b4\u03c3 0 ; \u00f011\u00de with e\u03f5\u03b1\u03b2 \u00bc \u03f5\u03b1\u03b2 12\u2211\u03b3V\u03b1\u03b3\u03b3\u03b2. A typical way to simplify the measurement of the two-body terms H\u0302\u00f02\u00deS in Eq. (11) is to perform nested matrix factorization for the Coulomb V tensor. Namely, we first rewrite H\u0302\u00f02\u00deS in the following factorized form by diagonalizing the real symmetric positive semidefinite\nCOMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys 5\nsupermatrix V(\u03b1\u03b2),(\u03b3\u03b4):\nH\u0302\u00f02\u00deS \u00bc 1 2 \u2211 L l\u00bc1 \u2211 \u03b1\u03b2 \u2211 \u03c3 L\u00f0l\u00de\u03b1\u03b2c\u0302y\u03b1\u03c3 c\u0302\u03b2\u03c3 2 : \u00f012\u00de\nHere l runs through the L positive eigenvalues of the supermatrix V, and the lth component of the auxiliary tensor L is obtained by multiplying the lth eigenvector with the square root of lth positive eigenvalue. Each tensor component, L\u00f0l\u00de, which is a real symmetric matrix, is subsequently diagonalized to reach the following decomposition:\n\u2211 \u03b1\u03b2\u03c3\nL\u00f0l\u00de\u03b1\u03b2c\u0302y\u03b1\u03c3 c\u0302\u03b2\u03c3 \u00bc \u2211 Ml\nm\u00bc1 \u03bb\u00f0l\u00dem \u2211 \u03b1\u03b2\u03c3 U \u00f0l\u00de\u03b1mU \u00f0l\u00de \u03b2mc\u0302 y \u03b1\u03c3 c\u0302\u03b2\u03c3 \u00bc \u2211\nMl\nm\u00bc1 \u2211 \u03c3 \u03bblmn\u0302 \u00f0l\u00de m\u03c3 \u00f013\u00de\nHere, we have defined n\u0302\u00f0l\u00dem\u03c3 \u2211\u03b1\u03b2U \u00f0l\u00de\u03b1mU \u00f0l\u00de\u03b2mc\u0302y\u03b1\u03c3 c\u0302\u03b2\u03c3 . The index m goes through the Ml nonzero eigenvalues \u03bb \u00f0l\u00de m and associated eigenvectors U \u00f0l\u00dem , which determines the single-particle basis transformation for the lth component. The whole embedding Hamiltonian of Eq. (1) can then be cast into the following doubly-factorized form with a unitary transformation similar to Eq. (13) for the one-body part:\nH\u0302 \u00bc \u2211 M0\nm\u00bc1 \u2211 \u03c3 \u03f5\u00f00\u00dem n\u0302 \u00f00\u00de m\u03c3 \u00fe 12 \u2211\nL l\u00bc1 \u2211 Ml m\u00bc1 \u2211 \u03c3 \u03bb\u00f0l\u00dem n\u0302 \u00f0l\u00de m\u03c3 2 ; \u00f014\u00de\nwhich is composed of L+ 1 groups characterized by unique single-particle basis transformations {U(l)}, including one from the single-electron component. This form allows efficient measurement of the Hamiltonian expectation value using L\u00fe 1 / O\u00f0N\u00de distinct circuits for a generic quantum chemistry problem with a single-particle basis dimension given by N.\nThe expectation value of H\u0302 is obtained by measuring each group l independently in the variational state \u03a8\u00bd\u03b8\n. The variational state is transformed to the same representation used in the lth group by applying a series of Givens rotations, fe\u03b8\u03bc\u03bd \u00f0\u0302cy\u03bc\u03c3 c\u0302\u03bd\u03c3 h:c:\u00deg, with the set of {\u03b8\u03bc\u03bd} determined by the single-particle transformation matrix U(l). Here \u03bc and \u03bd are generic indices for physical and bath orbital sites. Therefore, the number of distinct measurement circuits is Nc= L+ 1. As an example, we have Nc= 4 for eg model. We refer to the \u201cMethods\u201d section for further details.\nIn practice, it is advantageous to isolate the one-body and twobody terms that contain only density operators before the double factorization procedure, because they are already in a diagonal representation. For the eg model we have carried out the doublefactorization with explicit calculations in the \u201cMethods\u201d section and we ultimately find Nc= 3 for the eg model. This can be compared with the Hamiltonian measurement procedure using the mutual qubit-wise commuting groups: operators that commute with respect to every qubit site are placed in the same group. This commuting Pauli approach generally needs Nc / O\u00f0N4\u00de distinct circuits for Hamiltonian measurement. And for the eg model, it requires Nc= 5.\nNoise-resilient optimization. Although classical optimization approaches such as BFGS, which rely on a computation of the energy gradient, are effective, they rely on very accurate cost function evaluations. Because of the inherent noise in quantum computing, optimization algorithms that are robust to cost function noise are highly desirable. In the noisy quantum simulations reported here, we adopt two optimization techniques that are more tolerant to noise than BFGS: sequential minimal optimization (SMO)62 and Adadelta63. Because of their similar performance in the noisy simulations, we only discuss SMO in the main text and leave the discussions of Adadelta in the \u201cMethods\u201d section.\nSMO is the first technique we use for our noisy quantum simulations. Tailored to the qubit-ADAPT ansatz of Eq. (8) where each variational parameter is associated with a single Pauli string generator, the optimization consists of Nsw sweeps of sequential single parameter minimization of the cost function. At a specific optimization step with varying parameter \u03b8j, while keeping others fixed, the cost function has a simple form of a cos\u00f02\u03b8j b\u00de \u00fe c, with the optimal \u03b8 j \u00bc b=2 if a < 0 and (b+ \u03c0)/ 2 otherwise. To determine the parameters a, b, and c, one requires knowledge of function values for at least three mesh points in the range of [\u2212\u03c0/2, \u03c0/2). In practice, we use eight uniformly spaced mesh points to better mitigate the effect of noise in the cost function. Consequently, least square fitting is used to determine the values of a, b and c. In SMO calculations, we use the number of sweeps as the parameter to control the convergence, which we set to Nsw= 40. Alternative control parameters, such as energy and gradient, usually are required to be evaluated at higher precision, which can be challenging and introduce additional quantum computation overhead.\nIn this work, we perform noisy simulations with classical optimizations that include sampling noise due to a finite number of measurements or shots (Nsh) as well as both sampling and gate noise. The purpose is to investigate the performance of the qubitADAPT algorithm in the presence of sampling and gate noise and to separate the effects of sampling noise, which is controlled by a single parameter Nsh from the effect of gate noise. The code with the circuit implementation of qubit-ADAPT VQE with examples on QASM simulator and quantum hardware are available at figshare64.\nStatevector simulations. In this section, we present numerical simulation results using a statevector simulator, which is equivalent to a fault-tolerant quantum computer with an infinite number of measurements (Nsh=\u221e). Figure 3 shows the ground state energy calculations of the (2, 2) eg and (3, 3) t2g impurity models using VQE-HVA as well as qubit-ADAPT VQE with sUCCSpD and HC pools. The reference UCCSD energy is 0.029 higher than the exact ground state energy EGS for the eg model and 0.128 higher for the t2g model. This implies that both models are in the strong electron correlation region. For calculations of the eg model, the energy converges below 10\u22125 with N\u03b8= 20 variational parameters for VQE-HVA, N\u03b8= 59 for ADAPTsUCCSpD, and N\u03b8= 31 for ADAPT-HC. Although the qubitADAPT VQE calculation on a statevector simulator is in principle deterministic, the operator selection from a predefined operator pool can introduce some randomness due to the numerical accuracy and near degeneracy of scores (i.e., the associated gradient components) for some operators. As a result, the converged N\u03b8 can slightly change by about one between runs.\nAs a simple estimation of the circuit complexity for NISQ devices, we provide the number of CNOT gates Ncx assuming full qubit connectivity, which can be realized in trapped ion systems. The converged circuit has Ncx= 288 for VQE-HVA, Ncx= 292 for ADAPT-sUCCSpD, and Ncx= 150 for ADAPT-HC. As a reference, the UCCSD ansatz has N\u03b8= 26 and Ncx= 1096. The HVA calculation converges with the smallest number of variational parameters, but the number of CNOT gates (Ncx) is in between that of ADAPT-HC and ADAPT-sUCCSpD because each variational parameter in HVA is associated with a generator composed of a weighted sum of Pauli strings. The ADAPT-HC\ncalculation starts from a reference state \u03a8\u00f0I\u00de0 E, a simple tensor\nproduct state on an AO basis, with energy higher than the HF reference state used by ADAPT-sUCCSpD, yet ADAPT-HC converges faster to the ground state. In fact, the initial state\n6 COMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys\nfidelity, defined as f\u2261 \u2223\u2329\u03a80\u2223\u03a8GS\u232a\u22232, is 0.19 for ADAPT-HC, compared with 0.76 for ADAPT-sUCCSpD. Therefore, the final ansatz complexity does not show a simple positive correlation with the initial state fidelity, which implies that both the Hamiltonian structure and operator pool are determining factors.\nCompared with ADAPT-sUCCSpD, the advantage of ADAPTHC becomes more prominent when applied to the t2g model. To reach energy convergence below 10\u22125, ADAPT-HC needs N\u03b8= 270 parameters and Ncx= 2052 CNOTs, while ADAPTsUCCSpD requires as many as N\u03b8= 1020 parameters and Ncx= 8066 CNOTs. For reference, the UCCSD ansatz has N\u03b8= 117 parameters and Ncx= 9200 CNOTs. The HVA calculation is carried out with up to L= 10 layers, which amounts to N\u03b8= 70 and Ncx= 2420, and the energy converges close to 10\u22126.\nWe emphasize that strong electron correlation effects are present in our chosen model that lies deep in the bad metallic state48,49. This state cannot be accurately captured within a meanfield description and hence requires the application of an appreciable number of unitary gates to the reference state. Generally, the circuit depth of a variational ansatz is tied to both the complexity of the problem (i.e. the complexity of the ground state wavefunction) and the desired state fidelity. As shown in Fig. 4, when we require a state fidelity close to 99.9% or an energy error close to 0.001, which is typically necessary for practical calculations, one observes a sharp rise of N\u03b8 when the system is tuned from the weak correlation (U < 1) to the strong correlation (U > 2) regime by increasing Hubbard U.\nSimulations with shot noise. The ADAPT VQE calculations are often reported at the statevector level, and a systematic study including the effect of noise is not yet available13,16,65\u201367. Here we present qubit-ADAPT VQE calculations of the (2, 2)eg model including shot noise.\nFigure 5 shows the representative convergence behavior of the qubit-ADAPT energy with an increasing number of variational parameters N\u03b8 calculated using different numbers of shots per observable measurement: Fig. 5a is for Nsh= 212, and Fig. 5b is for Nsh= 216. We use SMO for the classical optimization. The adaptive ansatz energy E overall decreases as the circuit grow and more variational parameters are used. The energy uncertainty is tied to the number of shots Nsh. The energy spread roughly reduces by a factor of 4 when Nsh increases from 212 to 216, consistent with the 16-fold increase in Nsh due to the central limit theorem.\nThe energy points shown include not only the final SMO optimized energies of the qubit-ADAPT ansatz with N\u03b8 parameters but also the intermediate energies after each of the Nsw= 40 sweeps during SMO optimizations to provide more detailed convergence information. The above-reported Nsh is referred to as measurements for SMO optimizations. At the operator screening step of the qubit-ADAPT calculation to expand the ansatz by appending an additional optimal unitary, we fix Nsh= 216 shots for energy evaluations in all cases and determine the energy gradient by the parameter-shift rule68.\nTo further assess the quality of the qubit-ADAPT ansatz obtained in these QASM simulations, we plot in Fig. 5c the ansatz\nCOMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys 7\nenergies evaluated using a statevector simulator at the end of each noisy SMO optimization. The four solid curves are calculated using the variational parameters that are obtained by QASM optimizations with different numbers of shots Nsh as indicated and noiseless optimization results are shown for comparison as the dashed line. While there is no clear order of the energies during the early stages of the simulation, the final convergence is consistently improved with more shots. Specifically, the error converges close to and below 10\u22123 for Nsh= 214 and 216 and the fidelity f improves beyond 99.9%. The associated single-particle density matrix elements also converge to an accuracy better than 10\u22122. Similar QASM simulations of qubit-ADAPT VQE have been performed using the Adadelta optimizer, as specified in the \u201cMethods\u201d section. Generally, we find the numerical results and the dependence on the number of shots to be comparable to SMO. Compared with SMO, Adadelta can potentially take advantage of multiple QPUs by evaluating the gradient vector in parallel.\nDiscussion of optimal pool size. One important factor determining the computational load of qubit-ADAPT VQE calculations is the size of the operator pool Np. One simple strategy to reduce Np is to strip off Pauli Z\u2019s in the pool of operators because they contribute negligibly to the ground state energy as pointed out in refs. 16,66. This reduces Np of the Hamiltonian commutator (HC) pool from 56 to 16 for the eg model, and from 192 to 60 for the t2g model, due to a large degeneracy. Furthermore, some qualitative guidance has been laid out in the literature to construct a minimal complete pool (MCP) of size 2(Nq\u22121)16,69, where Nq is the number of qubits. Indeed, we find that an MCP can be constructed using a subset of operators in the HC pool.\nWe discover a dichotomy that the reduction of the pool size can potentially make the optimization of the qubit-ADAPT ansatz more challenging, especially in the presence of noise. Figure 6 compares qubit-ADAPT calculations using three different pool sizes of dimensions 56, 16, and 10, which were introduced above. Figure 6a shows the qubit-ADAPT energies with increasing N\u03b8 from statevector simulations of the eg model using the three pools. All the simulations converge with 31 parameters and final CNOT gate numbers Ncx= 150, 98, and 62 which decrease for the smaller pools. The details of the convergence rate of the three runs differ significantly. When the pool dimension decreases, the region of N\u03b8 with minimal energy change expands, as seen by the almost flat segments of the curves of Fig. 6a. The minimal energy gain implies that small noise in the cost function evaluation could deteriorate the parameter optimization.\nIndeed as shown in Fig. 6b, the qubit-ADAPT energy from noisy simulation converges slower as the pool size decreases. The flat segments in the energy curves become more evident owing to\ncommutator pool of the eg model, where U varies from 0.5 to 8 with 0.5 as the step size. The other model parameters can be retrieved at figshare53.\n8 COMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys\nthe stochastic energy errors. We further analyze the quality of the qubit-ADAPT ansatz by evaluating the energy at optimal angles obtained in noisy simulations, as plotted in Fig. 6c. The energy difference is 0.001, 0.027, 0.135 at N\u03b8= 31 where the statevector simulation converges, and 0.0006, 0.001, 0.005 at the end of N\u03b8= 40 for calculations with pools of size 56, 16, and 10, respectively.\nOur analysis clearly shows the strikingly distinct convergence behaviors of qubit-ADAPT calculations using different complete operator pools in the presence of sampling noise. This indicates that the optimal pool in practical calculations can be a trade-off between choosing a small pool size and guaranteeing sufficient connectivity of the operators in the pool.\nSimulations with noise models. Besides the inherent sampling noise in quantum computing, NISQ hardware is subject to various other error effects. These include coherent errors due to imperfect gate operations as well as stochastic errors due to qubit decoherence, dephasing, and relaxation. Here, we perform a preliminary investigation of the impact of hardware imperfections on qubit-ADAPT VQE calculations by adopting a realistic decoherence noise model proposed by Kandala et al. in ref. 3. The model includes an amplitude-damping channel (\u03c1 ! \u22112i\u00bc1 Eai \u03c1Eayi ) and a dephasing channel (\u03c1 ! \u22112i\u00bc1 Edi \u03c1Edyi ). These act on the qubit density matrix following each single-qubit or two-qubit gate operation. The Kraus operators are given as:\nEa1 \u00bc 1 0 0 ffiffiffiffiffiffiffiffiffiffiffiffiffi 1 pap ; Ea2 \u00bc\n0 ffiffiffiffi pa p\n0 0\n;\nEd1 \u00bc 1 0 0 ffiffiffiffiffiffiffiffiffiffiffiffiffi 1 pd p ; Ed2 \u00bc 0 00 ffiffiffiffipdp :\n\u00f015\u00de\nThe error rates pa \u00bc 1 e \u03c4=T1 and pd \u00bc 1 e 2\u03c4=T\u03d5 are determined by the gate time \u03c4, the qubit relaxation time T1 and the dephasing time T\u03d5= 2T1T2/(2T1\u2212T2), where T2 is the qubit coherence time. For the sake of simplicity of the analysis, we choose a uniform single-qubit gate error rate pa1 \u00bc pd1 p1 \u00bc 10 4, which is close to the value found in current hardware. We also assume a uniform two-qubit error rate pa2 \u00bc pd2 \u00bc p2 that we vary between 10\u22124 and 10\u22122, in order to study the impact of two-qubit noise on the VQE optimization.\nFigure 7a shows a typical qubit-ADAPT energy curve E\u2212EGS during optimization as a function of the number of variational parameters N\u03b8 obtained in noisy simulations with p2= 10\u22122, 10\u22123, and 10\u22124. Here, EGS is the exact ground state energy. The results with only single-qubit noise are also shown for reference. Figure 7b contains the associated exact energies for the ansatz states, which we obtain by evaluating the VQE ansatz on a statevector simulator.\nFor p2= 10\u22122, which represents the current hardware noise level, the noisy energy increases with N\u03b8, indicating that the error rate is too large to get reliable energy estimation. Nevertheless, as shown in the corresponding statevector analysis in Fig. 7b, one still observes a sizable energy reduction in the early stage of the optimization. The evaluated ansatz state fidelity is found to improve from 0.19 in the initial state to about 0.70 with 4 <N\u03b8 < 9. When further increasing N\u03b8, however, the statevector ansatz energy shows an upward trend due to noise accumulation, signifying a failure of the noisy optimization. For a smaller error rate, p2= 10\u22123, which was demonstrated recently with the IBM Falcon device70, the noisy energy initially decreases and reaches a minimum near N\u03b8= 7. This is again followed by an upturn as the number of variational parameters N\u03b8 grows. On the other hand, the corresponding statevector analysis shows a clear continuous energy improvement up to N\u03b8= 25, followed by saturation with small fluctuations. We find the ansatz state fidelity saturates near 0.97. Similar observations apply to the noisy simulations with other two-qubit error rates. The statevector analysis shows that the energy converges at an error \u2248 3 \u00d7 10\u22123 with a fidelity \u2248 0.997 for p2= 10\u22124. When including only single-qubit errors, we find an error \u2248 1 \u00d7 10\u22123 with a fidelity \u22480.9992.\nThe observed improvement of the ansatz (revealed using statevector analysis), even though the noisy energy expectation value increases, is intriguing. This effect is most clearly seen in results for p= 10\u22123 between 7 \u2264N\u03b8 < 25. It demonstrates the robustness of VQE to certain types of noise effects and can be rationalized as follows. Assuming for simplicity a global depolarizing error channel, we can relate the expectation value of an observable hOi with respect to a noisy density matrix to the noiseless result \u2329O\u232a as hOi \u00bc \u00f01 p\u00dehOi \u00fe p2n Tr\u00bdO 71,72. Since any observable can be shifted to be traceless (Tr[O]= 0), \u2329O\u232a is equivalent to hOi up to a constant scaling factor. The noise thus only rescales the energy landscape of the variational ansatz and maintains the optimal parameters. The fact that we find the\nans\u00e4tze obtained in the noisy simulations of panel (b) are shown in panel (c).\nCOMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys 9\nansatz energy to saturate in the statevector analysis with finite p2 is caused by our choice of noise model, which includes noise effects beyond a global depolarizing channel. This observation of state improvement during optimization masked by noisy energy expectation values suggests that with reasonably small error rates, expensive error mitigation techniques may be restricted to the final converged state at the end of VQE calculations to ensure accurate observable measurements.\nEstimating ground state energy on NISQ devices. As a further step to benchmark the realistic noise effect on qubit-ADAPT VQE calculations of the multi-orbital quantum impurity models, we measure the Hamiltonian expectation value of the eg model with a converged qubit-ADAPT ansatz on the IBM quantum device ibmq_casablanca. The ansatz with optimal parameters is obtained with the HC pool using statevector simulations. The converged qubit-ADAPT ansatz used for the ground state energy estimate has 32 parameters, and the associated 32 generators for multi-qubit unitary gates are listed in the \u201cMethods\u201d section.\nTo reduce the noise in the cost function measurement, it is essential to utilize a range of error mitigation techniques. We\nemploy the standard readout error mitigation using the full confusion matrix approach, as implemented in Qiskit50. The adopted measurement circuits based on Hamiltonian integral factorization also allow convenient symmetry detection and filtering with respect to how well the ansatz preserves the total electron number Ne= 4 and total spin z-projection Sz= 0. The gate error is mitigated using zero noise extrapolation (ZNE) with Richardson second-order polynomial inference73,74. The noise scale factor increases from 1 to 2 and 3 for each measurement circuit by local random unitary folding following the implementation in Mitiq75,76. Because of the random gate folding and the stochastic SWAP mapping during transpilation to native gates50, we perform ten runs for each measurement circuit at each noise level to smooth out the nondeterministic effects with averaging. For each run, we apply Nsh= 214 shots for the measurements.\nFigure 8a shows the Richardson extrapolation for the ground state energy with measured points at noise scale factors \u03bb= 1, 2, 3, taking all 10 runs for each \u03bb into account. The estimated energy has an absolute error \u0394(E)= 0.6 \u00b1 1.4 compared with the exact result indicated by the horizontal dashed line. This corresponds to a relative error of 3%. The standard deviation is obtained by fitting the sample points with a second-order polynomial using the SciPy function curve_fit which takes both the mean values and standard deviations into account77. In the postprocessing for the mean value of the energy cost function from statistical samplings, we first apply readout calibration, followed by symmetry filtering which discards the configurations with total electron number Ne \u2260 4 or total spin Sz \u2260 0. We observe that the ten runs can be divided into two groups based on the average Ne and Sz evaluated before symmetry filtering, as shown in Fig. 8c and d. A subgroup of five runs denoted by square symbols has much less bias away from the correct conserved quantum numbers Ne= 4 and Sz= 0 than the other five runs shown as circles. A more accurate ground state energy can be obtained when restricting to this optimal subgroup, as shown in Fig. 8b. The estimated energy error reduces significantly to \u0394(E)= 0.1 \u00b1 0.2, with a relative error of 0.7%. In the above calculations on QPU, the circuits are transpiled into the basis gates of ibmq_casablanca device using the qubit layout and coupling map illustrated in the inset of Fig. 8a. Due to the limited qubit connectivity between nearest neighbors, each of the three transpiled measurement circuits for the eg model contains about 350 CNOT gates, which amounts to over two-fold increase compared to about 150 CNOTs without qubit swapping. Therefore, we also benchmark the calculations on other types of QPUs with full qubit connectivity such as trapped-ion devices. As an initial reference, we perform an energy estimation with the same ansatz on Quantinuum\u2019s trapped-ion Honeywell System Model H1-2. The transpiled circuits have about 150 two-qubit ZZMax gates as expected. Due to limited access to the device, we apply only Nsh= 450 shots per circuit for the measurements without utilizing any error mitigation. The energy thus obtained is \u221217.6 \u00b1 2, which should be compared with data points in Fig. 8a at a scale factor 1, and is found to be located near the lower end of that range. Here the error bar is estimated using multiple runs of simulations with the associated system Model H1-2 emulator (H1-2E) including a realistic noise model."
        },
        {
            "heading": "Conclusions",
            "text": "In an effort towards performing hybrid quantum-classical simulations of realistic correlated materials using a quantum embedding approach29\u201337, we assess the gate depth and accuracy of variational ground state preparation with fixed and adaptive ans\u00e4tze for two representative interacting multi-orbital, eg and t2g, impurity models. To take advantage of the sparsity of the\nsimulations are performed with the Hamiltonian commutator pool of size 56.\n10 COMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys\nHamiltonian in the atomic orbital representation in real space, we consider the HVA ansatz and an adaptive variant in the qubitencoded atomic orbital basis. An HC pool composed of pairwise commutators of the Hamiltonian terms is developed to allow fair comparison between the qubit-ADAPT and HVA ansatz. For reference, the standard UCCSD and related qubit-ADAPT calculations using UCCSD-compatible pools are also presented. The qubit-ADAPT calculation with an HC pool generally produces the most compact circuit representation with a minimal number of CNOTs in the final converged circuit. The fixed HVA ansatz follows very closely and has the additional advantage of requiring the least variational parameters N\u03b8.\nTo address the effect of quantum shot noise, we report QASM simulations of qubit-ADAPT VQE in the presence of shot noise for different numbers of shots (Nsh) that allow controlling the stochastic error. For our benchmark, we adopt state-of-the-art techniques such as low-rank tensor factorization to reduce the number of distinct measurement circuits and a noise resilient optimization including sequential minimal optimization and Adadelta. We find a modest number of shots Nsh= 214 per measurement circuit can lead to a variational representation of the ground state with fidelity f > 99.9%.\nWe further discuss ways to simplify the pool operators and reduce the pool size using eg model as an example. It is pointed out that a minimal complete pool, as defined in refs. 16,69, can be constructed using a subset of the HC pool. While a simplified pool can reduce the quantum computation resource in the adaptive operator screening procedure, it can make classical optimization more complicated, especially in the presence of noise. This suggests both the dimension and connectivity of operators are joint determining factors to design a practically optimal pool.\nTo assess the effects of realistic noise on VQE calculations of multi-orbital impurity models, we perform qubit-ADAPT VQE calculations with a realistic decoherence noise model that includes amplitude and dephasing error channels. We find the impact of two-qubit errors to dominate over those of single-qubit errors, also since they are larger in NISQ hardware. We report that practically useful results can be obtained for p2= 10\u22123, which is close to current hardware levels. Importantly, we observe that the classical optimization continues to improve the ansatz even in a regime, where the noisy energy expectation value starts to rise. We reveal this behavior by executing the ansatz state on statevector simulators. Such persisting ansatz state improvement masked by noise shows that VQE is robust to certain noise effects and implies that costly error mitigation methods can potentially be reserved for the evaluation of expectation values in the final converged state.\nFinally, we measure the energy for a converged qubit-ADAPT ansatz of the eg model on the ibmq_casablanca QPU and Quantinuum\u2019s H1-2 device. Using the results from IBM hardware, we obtain an error of 0.1 (0.7%) for the total energy by adopting error mitigation techniques such as zero-noise extrapolation, combined with a careful post-selection based on symmetry and the conservation of quantum numbers.\nMoving forward, the full qubit-ADAPT VQE calculations of quantum impurity models will be extended from noisy QASM simulations to simulations that include device-specific noise effects beyond our decoherence model and finally to experiments on real hardware. Our study shows that an array of error mitigation techniques, including readout calibration, zero-noise extrapolation73,74, and potentially probabilistic error cancellation74,78,79, Clifford data regression80,81, and probabilistic\nCOMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys 11\nmachine-learning-based techniques82, need to be adopted to reach sufficiently accurate results. This is especially important when using VQE as an impurity solver in a quantum embedding approach as sufficiently accurate impurity model results are needed in order to enable the convergence of the classical selfconsistency loop. Our results constitute an important step forward in demonstrating high-fidelity ground state preparation of impurity models on quantum devices. This is essential for realizing correlated material simulations through hybrid quantumclassical embedding approaches, where the ground state preparation of a generic f-electron impurity model consisting of 28 spin-orbital is on the verge of achieving practical quantum advantage35."
        },
        {
            "heading": "Methods",
            "text": "Energy gradient of HVA. Here we show that the outermost lth layer gradient component vanishes (\u2202E\u00f0\u03b8\u00de\u2202\u03b8lj\n\u03b8l\u00bc0\n\u00bc 0) for an l-layer HVA ansatz\n\u03a8l \u00bd\u03b8 \u00bc \u03a0NGj\u00bc1e i\u03b8lj h\u0302j \u03a8l 1\u00bd\u03b8 :\n\u2202E\u00f0\u03b8\u00de \u2202\u03b8lj\n\u03b8l\u00bc0\n\u00bc \u2202h\u03a8l \u00bd\u03b8 jH\u0302j\u03a8l \u00bd\u03b8 i \u2202\u03b8lj\n\u03b8l\u00bc0 \u00bc ih\u03a8l 1\u00bd\u03b8 j H\u0302h\u0302j j\u03a8l 1\u00bd\u03b8 i \u00fe c:c: \u00f016\u00de\nBecause the system Hamiltonian H\u0302 under study is real due to time-reversal symmetry, HVA is also real by construction. Therefore, h\u03a8l 1\u00bd\u03b8 j H\u0302h\u0302j j\u03a8l 1\u00bd\u03b8 i is real, and \u2202E\u00f0\u03b8\u00de\u2202\u03b8lj\n\u03b8l\u00bc0\nvanishes. Note that the exactly same reason motivates the develop-\nment of the HC pool for qubit-ADAPT calculations.\nHamiltonian factorization of the impurity model. Here we explain explicitly how the Hamiltonian factorization is obtained using the eg model as an example, whose Hamiltonian takes the following specific form:\nH\u0302 \u00bc D \u2211 2\ni\u00bc1 \u2211 \u03c3\nc\u0302yi\u03c3 f\u0302 i\u03c3 \u00fe h:c:\n\u00f017\u00de\n\u00feJ=2 c\u0302y1\" c\u03022\" \u00fe c\u0302y1# c\u03022# \u00fe h:c: 2 \u00f018\u00de\n\u00feU \u2211 2\ni\u00bc1 n\u0302i\"n\u0302i# \u00fe \u00f0U 2J\u00de\u2211 \u03c3\u03c3 0 n\u03021\u03c3 n\u03022\u03c3 0 \u00f019\u00de\n\u00fee\u03f5 \u22112 i\u00bc1 \u2211 \u03c3 n\u0302i\u03c3 \u00fe \u03bb \u2211 2 i\u00bc1 \u2211 \u03c3 n\u0302fi\u03c3 : \u00f020\u00de\nHere n\u0302i\u03c3 \u00bc c\u0302yi\u03c3 c\u0302i\u03c3 and n\u0302fi\u03c3 \u00bc f\u0302 y i\u03c3 f\u0302 i\u03c3 are the electron occupation number operators for the physical and bath orbitals, respectively. The factorization procedure is only needed for the single-particle hybridization term (17) and the pair hopping and spin-flip terms (18), as the rest are already in the diagonal representation.\nThe hybridization term (17) can be written in a diagonal form through singleparticle rotations on the physical and bath orbitals as follows:\n\u2211 2 i\u00bc1 c\u0302yi\u03c3 f\u0302 i\u03c3 \u00fe h:c: \u00bc n\u0302\u00f00\u00de1\u03c3 n\u0302\u00f00\u00de2\u03c3 \u00fe n\u0302\u00f00\u00de3\u03c3 \u00fe n\u0302\u00f00\u00de4\u03c3 ; \u00f021\u00de\nwhere n\u0302\u00f00\u00dem\u03c3 \u00bc c\u0302y\u00f00\u00dem\u03c3 c\u0302\u00f00\u00dem\u03c3 and the rotated fermionic operators c\u0302\u00f00\u00dem\u03c3 are given by,\nc\u0302\u00f00\u00de1\u03c3 \u00bc 1ffiffi2p \u00f0\u0302c1\u03c3 \u00fe f\u0302 1\u03c3 \u00de; c\u0302\u00f00\u00de2\u03c3 \u00bc 1ffiffi2p \u00f0\u0302c2\u03c3 \u00fe f\u0302 2\u03c3 \u00de; c\u0302\u00f00\u00de3\u03c3 \u00bc 1ffiffi2p \u00f0\u0302c1\u03c3 f\u0302 1\u03c3 \u00de; c\u0302\u00f00\u00de4\u03c3 \u00bc 1ffiffi2p \u00f0\u0302c2\u03c3 f\u0302 2\u03c3 \u00de: \u00f022\u00de\nThis can be derived conveniently in the matrix formulation:\n\u2211 2 i\u00bc1 c\u0302yi\u03c3 f\u0302 i\u03c3 \u00fe h:c:\n\u00bc c\u0302y1\u03c3 c\u0302y2\u03c3 f\u0302 y 1\u03c3 f\u0302 y 2\u03c3 0 0 1 00 0 0 1 1 0 0 0\n0 1 0 0\n0 BBB@\n1 CCCA\nc\u03021\u03c3 c\u03022\u03c3 f\u0302 1\u03c3 f\u0302 2\u03c3\n0 BBBB@ 1 CCCCA\n\u00bc c\u0302y1\u03c3 c\u0302y2\u03c3 f\u0302 y 1\u03c3 f\u0302 y 2\u03c3\n1ffiffi 2 p 0 1ffiffi 2 p 0 0 1ffiffi 2 p 0 1ffiffi 2 p\n1ffiffi 2 p 0 1ffiffi 2 p 0 0 1ffiffi 2 p 0 1ffiffi 2 p\n0 BBBBB@\n1 CCCCCA\n\u00b4 1 0 0 0 0 1 0 0 0 0 1 0\n0 0 0 1\n0 BBB@\n1 CCCA 1ffiffi 2 p 0 1ffiffi 2 p 0 0 1ffiffi 2 p 0 1ffiffi 2 p\n1ffiffi 2 p 0 1ffiffi 2 p 0 0 1ffiffi 2 p 0 1ffiffi 2 p\n0 BBBBB@\n1 CCCCCA\nc\u03021\u03c3 c\u03022\u03c3 f\u0302 1\u03c3 f\u0302 2\u03c3\n0 BBBB@ 1 CCCCA\n\u00bc c\u0302y\u00f00\u00de1\u03c3 c\u0302y\u00f00\u00de2\u03c3 c\u0302y\u00f00\u00de3\u03c3 c\u0302y\u00f00\u00de4\u03c3 1 0 0 00 1 0 0\n0 0 1 0\n0 0 0 1\n0 BBB@\n1 CCCA c\u0302\u00f00\u00de1\u03c3 c\u0302\u00f00\u00de2\u03c3 c\u0302\u00f00\u00de3\u03c3 c\u0302\u00f00\u00de4\u03c3 0 BBBB@ 1 CCCCA:\n\u00f023\u00de\nThe pair hopping and spin-flip terms of the second line of Eq. (18) can be rewritten as:\nJ=2 c\u0302y1\" c\u0302 y 1# c\u0302 y 2\" c\u0302 y 2# L\u00f01\u00de c\u03021\" c\u03021# c\u03022\" c\u03022#\n0 BBB@ 1 CCCA 0 BBB@ 1 CCCA 2 : \u00f024\u00de\nwith\nL\u00f01\u00de \u00bc\n0 0 1 0\n0 0 0 1\n1 0 0 0\n0 1 0 0\n0 BBB@\n1 CCCA: \u00f025\u00de\nThe above expression is obtained by diagonalizing the Coulomb supermatrix of V(\u03b1\u03b2),(\u03b3\u03b4) with density-density elements set to zero, V(\u03b1\u03b1),(\u03b3\u03b3)\u2261 0, which gives a single eigenvector associated with nonzero eigenvalue. Following the similar derivation in Eq. (23), the pair hooping and spin-flip terms have the following diagonal representation:\nJ=2 n\u0302\u00f01\u00de1\" n\u0302\u00f01\u00de1# \u00fe n\u0302\u00f01\u00de2\" \u00fe n\u0302\u00f01\u00de2# 2 ; \u00f026\u00de\nwith n\u0302\u00f01\u00dem\u03c3 \u00bc c\u0302y\u00f01\u00dem\u03c3 c\u0302\u00f01\u00dem\u03c3 and\nc\u0302\u00f01\u00de1\u03c3 \u00bc 1ffiffi 2 p \u00f0\u0302c1\u03c3 \u00fe c\u03022\u03c3 \u00de; c\u0302\u00f01\u00de2\u03c3 \u00bc 1ffiffi 2\np \u00f0\u0302c1\u03c3 c\u03022\u03c3 \u00de: \u00f027\u00de Finally, we can represent the embedding Hamiltonian for eg model in the\nfollowing doubly-factorized form:\nH\u0302 \u00bcD\u2211 \u03c3 n\u0302\u00f00\u00de1\u03c3 n\u0302\u00f00\u00de2\u03c3 \u00fe n\u0302\u00f00\u00de3\u03c3 \u00fe n\u0302\u00f00\u00de4\u03c3\n\u00fe J=2 n\u0302\u00f01\u00de1\" n\u0302\u00f01\u00de1# \u00fe n\u0302\u00f01\u00de2\" \u00fe n\u0302\u00f01\u00de2# 2\n\u00fe U \u2211 2\ni\u00bc1 n\u0302i\"n\u0302i# \u00fe \u00f0U 2J\u00de\u2211 \u03c3\u03c3 0 n\u03021\u03c3 n\u03022\u03c3 0\n\u00fe e\u03f5 \u22112 i\u00bc1 \u2211 \u03c3 n\u0302i\u03c3 \u00fe \u03bb \u2211 2 i\u00bc1 \u2211 \u03c3 n\u0302fi\u03c3 :\n\u00f028\u00de\nWith the Hamiltonian integral factorization we find that three distinct measurement circuits are needed for the Hamiltonian expectation value: (i) the diagonal terms in the original atomic orbital basis, (ii) the hybridization terms in the basis of c\u00f00\u00dem\u03c3 (22), (iii) the pair hopping and spin-flip terms in the basis of c\u00f01\u00dem\u03c3 (27).\nQuantum simulation with Adadelta optimizer. In the main text, we reported the qubit-ADAPT VQE calculation with shots using the SMO optimizer. Here we additionally perform the calculations using the Adadelta optimization method, which is potentially tolerant to cost function errors63. Below we describe the implementation of the algorithm followed by the results.\nThe algorithm minimizes the cost function along the steepest decent direction in parameter space, with a parameter update at step t as \u03b8t= \u03b8t\u22121\u2212wt\u2299 gt. The gradient vector is determined from the derivative of the energy function along\n12 COMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys\nevery parameter direction gt=\u2207\u03b8E(\u03b8t), where E\u00f0\u03b8\u00de \u00bc h\u03a8\u00bd\u03b8 j H\u0302 j\u03a8\u00bd\u03b8 i is the estimated energy. The set of parameter-dependent adaptive learning rates is\ndetermined as wt \u00bc ffiffiffiffiffiffiffiffiffiffiffiffi \u0394\u03b8t 1\u00fe\u03f5 p ffiffiffiffiffiffiffi st\u00fe\u03f5\np , where the leaked average of the square of rescaled gradients at the previous step is obtained as \u0394\u03b8t 1 \u00bc \u03b2\u0394\u03b8t 2 \u00fe \u00f01 \u03b2\u00de\u00f0wt 1 gt 1\u00de2, and that of gradients is evaluated as st \u00bc \u03b2st 1 \u00fe \u00f01 \u03b2\u00deg2t . The operator\u2299 denotes element-wise product. The Adadelta algorithm involves a hyperparameter \u03f5 to regularize the ratio in determining wt, which is set to 10\u22128, and a mixing parameter set to \u03b2= 0.9. The leaked averages are all initialized to zero. We fix the number of steps in Adadelta optimization to Ns= 250 in our simulations. Considering that the evaluation of one gradient component associated with a variational parameter involves cost function measurements at two distinct parameter points following the parameter-shift rule, the quantum computational resource for Adadelta optimization is comparable to SMO with Nsw= 60.\nFigure 9 shows the representative convergence behavior of qubit-ADAPT energy with an increasing number of variational parameters N\u03b8 calculated using a number of shots Nsh= 216 per observable. The adaptive ansatz energy E decreases as the circuit depth increases with more variational parameters. The energy points shown include not only the final Adadelta optimized energies of the qubit-ADAPT ansatz with N\u03b8 parameters but also intermediate energies for the 250 Adadelta steps to provide a detailed view of the convergence. For the operator screening step of the qubit-ADAPT calculation we fix Nsh= 216 for energy evaluations in all cases, and determine the energy gradient by the parameter-shift rule68. The final energy error from the calculations with Adadelta is E\u2212EGS= 4.4 \u00d7 10\u22123. This is comparable with the result from the SMO optimizer.\nThe ground state ansatz of (2, 2) eg model used on ibmq_casablanca. The qubit-ADAPT ansatz takes the pseudo-Trotter form. The converged ansatz for the eg model which we used for the calculations on IBM quantum hardware ibmq_casablanca is composed of 32 generators for the multi-qubit unitary gates, which are listed here with parity encoding (in the order that they appear in the ansatz):\nIIIZXY, IYXIII, XYZIII, IIZYXZ, IXYIII, ZXYIIZ, XYIIZZ, XYIIIZ, IIIIYX, IZXYXX, IIXZYI, IIXIIY, IIXIZY, IIZYXZ, IIIZYX, YXIIII, IZXIZY, IIXIZY, IIYIIX, IIZXYI, IZXYXX, IZYIZX, ZYXIII, ZYIIZX, IIYIIX, IIIIXY, IIXIIY, IIXIYZ, IIXZYI, YXXIZX, IIXIYZ, YXXIIX."
        },
        {
            "heading": "Data availability",
            "text": "All the data to generate the figures are available at figshare83. Data supporting the calculations are available together with the codes at figshare53,54,64. All other data are available from the corresponding authors on reasonable request."
        },
        {
            "heading": "Code availability",
            "text": "All the computer codes developed and used in this work are available open-source at figshare45,53,54,64.\nReceived: 18 March 2022; Accepted: 17 November 2022;"
        },
        {
            "heading": "Acknowledgements",
            "text": "The authors acknowledge valuable discussions with Thomas Iadecola, Niladri Gomes, Cai-Zhuang Wang, and Nicola Lanat\u00e0. This work was supported by the US Department of Energy (DOE), Office of Science, Basic Energy Sciences, Materials Science and Engineering Division, including the grant of computer time at the National Energy Research Scientific Computing Center (NERSC) in Berkeley, CA, USA. The research was performed at the Ames National Laboratory, which is operated for the US DOE by Iowa State University under Contract No. DE-AC02-07CH11358. We acknowledge the use of the IBM Quantum Experience, through the IBM Quantum Researchers Program. The views expressed are those of the authors and do not reflect the official policy or position of IBM or the IBM Quantum team. This research also used resources from the Oak Ridge Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC05-00OR22725."
        },
        {
            "heading": "Author contributions",
            "text": "A.M. and Y.Y. developed the codes and performed the simulations. N.F.B. and J.C.G. contributed to the HVA calculations. A.M., P.P.O., and Y.-X.Y. analyzed the results. Y.-X.Y., A.M., and P.P.O. wrote the paper with input from all authors. Y.-X.Y. and P.P.O. conceived and supervised the project."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests.\n14 COMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys"
        },
        {
            "heading": "Additional information",
            "text": "Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s42005-022-01089-6.\nCorrespondence and requests for materials should be addressed to Peter P. Orth or Yong-Xin Yao.\nPeer review information Communications Physics thanks the anonymous reviewers for their contribution to the peer review of this work. Peer reviewer reports are available.\nReprints and permission information is available at http://www.nature.com/reprints\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing,\nadaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/ licenses/by/4.0/.\n\u00a9 The Author(s) 2023\nCOMMUNICATIONS PHYSICS | (2023) 6:4 | https://doi.org/10.1038/s42005-022-01089-6 | www.nature.com/commsphys 15"
        }
    ],
    "title": "Comparative study of adaptive variational quantum eigensolvers for multi-orbital impurity models",
    "year": 2023
}