{
    "abstractText": "I introduce the concept of a persistence diagram (PD) bundle, which is the space of PDs for a fibered filtration function (a set {fp : K \u2192 R}p\u2208B of filtrations that is parameterized by a topological space B). Special cases include vineyards, the persistent homology transform, and fibered barcodes for multiparameter persistence modules. I prove that if B is a smooth compact manifold, then for a generic fibered filtration function, B is stratified such that within each stratum Y \u2286 B, there is a single PD \u201ctemplate\u201d (a list of \u201cbirth\u201d and \u201cdeath\u201d simplices) that can be used to obtain the PD for the filtration fp for any p \u2208 Y . If B is compact, then there are finitely many strata, so the PD bundle for a generic fibered filtration on B is determined by the persistent homology at finitely many points in B. I also show that not every local section can be extended to a global section (a continuous map s from B to the total space E of PDs such that s(p) \u2208 PD(fp) for all p \u2208 B). Consequently, a PD bundle is not necessarily the union of \u201cvines\u201d \u03b3 : B \u2192 E; this is unlike a vineyard. When there is a stratification as described above, I construct a cellular sheaf that stores sufficient data to construct sections and determine whether a given local section can be extended to a global section.",
    "authors": [
        {
            "affiliations": [],
            "name": "ABIGAIL HICKOK"
        }
    ],
    "id": "SP:3760411f3207ac0d6f62737f2b20f24458c97974",
    "references": [
        {
            "authors": [
                "Henry Adams",
                "Tegan Emerson",
                "Michael Kirby",
                "Rachel Neville",
                "Chris Peterson",
                "Patrick Shipman",
                "Sofya Chepushtanova",
                "Eric Hanson",
                "Francis Motta",
                "Lori Ziegelmeier"
            ],
            "title": "Persistence images: A stable vector representation of persistent homology",
            "venue": "Journal of Machine Learning Research,",
            "year": 2017
        },
        {
            "authors": [
                "Pankaj K. Agarwal",
                "Herbert Edelsbrunner",
                "John Harer",
                "Yusu Wang"
            ],
            "title": "Extreme elevation on a 2manifold",
            "venue": "Discrete & Computational Geometry,",
            "year": 2006
        },
        {
            "authors": [
                "Erik J. Am\u00e9zquita",
                "Michelle Y. Quigley",
                "Tim Ophelders",
                "Jacob B. Landis",
                "Daniel Koenig",
                "Elizabeth Munch",
                "Daniel H. Chitwood"
            ],
            "title": "Measuring hidden phenotype: quantifying the shape of barley seeds using the Euler characteristic transform",
            "venue": "in silico Plants,",
            "year": 2022
        },
        {
            "authors": [
                "Barbara Di Fabio"
            ],
            "title": "Betti numbers in multidimensional persistent homology are stable functions",
            "venue": "Mathematical Methods in the Applied Sciences,",
            "year": 2013
        },
        {
            "authors": [
                "Shreya Arya",
                "Justin Curry",
                "Sayan Mukherjee"
            ],
            "title": "A sheaf-theoretic construction of shape space",
            "year": 2022
        },
        {
            "authors": [
                "Omer Bobrowski",
                "Sayan Mukherjee",
                "Jonathan E. Taylor"
            ],
            "title": "Topological consistency via kernel estimation",
            "year": 2017
        },
        {
            "authors": [
                "Magnus Bakke Botnan",
                "Michael Lesnick"
            ],
            "title": "An introduction to multiparameter persistence",
            "year": 2022
        },
        {
            "authors": [
                "Gunnar Carlsson",
                "Afra Zomorodian"
            ],
            "title": "The theory of multidimensional persistence",
            "venue": "Discrete and Computational Geometry,",
            "year": 2007
        },
        {
            "authors": [
                "Andrea Cerri",
                "Marc Ethier",
                "Patrizio Frosini"
            ],
            "title": "A study of monodromy in the computation of multidimensional persistence",
            "venue": "Discrete Geometry for Computer Imagery,",
            "year": 2013
        },
        {
            "authors": [
                "Fr\u00e9d\u00e9ric Chazal",
                "David Cohen-Steiner",
                "Quentin M\u00e9rigot"
            ],
            "title": "Geometric inference for probability measures",
            "venue": "Foundations of Computational Mathematics,",
            "year": 2011
        },
        {
            "authors": [
                "Yao-li Chuang",
                "Maria R. D\u2019Orsogna",
                "Daniel Marthaler",
                "Andrea L. Bertozzi",
                "Lincoln S. Chayes"
            ],
            "title": "State transitions and the continuum limit for a 2D interacting, self-propelled particle system",
            "venue": "Physica D: Nonlinear Phenomena,",
            "year": 2007
        },
        {
            "authors": [
                "Moo K. Chung",
                "Peter Bubenik",
                "Peter T. Kim"
            ],
            "title": "Persistence diagrams of cortical surface data",
            "venue": "Information Processing in Medical Imaging,",
            "year": 2009
        },
        {
            "authors": [
                "David Cohen-Steiner",
                "Herbert Edelsbrunner",
                "John Harer"
            ],
            "title": "Stability of persistence diagrams",
            "venue": "Discrete and Computational Geometry,",
            "year": 2007
        },
        {
            "authors": [
                "David Cohen-Steiner",
                "Herbert Edelsbrunner",
                "Dmitriy Morozov"
            ],
            "title": "Vines and vineyards by updating persistence in linear time",
            "venue": "In Proceedings of the Twenty-Second Annual Symposium on Computational Geometry,",
            "year": 2006
        },
        {
            "authors": [
                "Padraig Corcoran",
                "Christopher B. Jones"
            ],
            "title": "Modelling topological features of swarm behaviour in space and time with persistence landscapes",
            "venue": "IEEE Access,",
            "year": 2017
        },
        {
            "authors": [
                "Justin Curry"
            ],
            "title": "Sheaves, Cosheaves, and Applications",
            "venue": "PhD thesis, University of Pennsylvania,",
            "year": 2014
        },
        {
            "authors": [
                "Justin Curry",
                "Haibin Hang",
                "Washington Mio",
                "Tom Needham",
                "Osman Berat Okutan"
            ],
            "title": "Decorated merge trees for persistent topology",
            "venue": "Journal of Applied and Computational Topology,",
            "year": 2022
        },
        {
            "authors": [
                "Justin Curry",
                "Sayan Mukherjee",
                "Katharine Turner"
            ],
            "title": "How many directions determine a shape and other sufficiency results for two topological transforms",
            "venue": "Transactions of the American Mathematical Society, Series B,",
            "year": 2022
        },
        {
            "authors": [
                "Herbert Edelsbrunner",
                "John Harer"
            ],
            "title": "Computational Topology: An Introduction",
            "venue": "American Mathematical Society,",
            "year": 2010
        },
        {
            "authors": [
                "Herbert Edelsbrunner",
                "David Letscher",
                "Afra Zomorodian"
            ],
            "title": "Topological persistence and simplification",
            "venue": "Discrete & Computational Geometry,",
            "year": 2022
        },
        {
            "authors": [
                "Robert Ghrist"
            ],
            "title": "Elementary Applied Topology",
            "venue": "Createspace, 1st edition,",
            "year": 2014
        },
        {
            "authors": [
                "Jakob Hansen",
                "Robert Ghrist"
            ],
            "title": "Toward a spectral theory of cellular sheaves",
            "venue": "Journal of Applied. and Computational Topology,",
            "year": 2019
        },
        {
            "authors": [
                "Abigail Hickok"
            ],
            "title": "Computing persistence diagram bundles",
            "year": 2022
        },
        {
            "authors": [
                "Abigail Hickok",
                "Deanna Needell",
                "Mason A Porter"
            ],
            "title": "Analysis of spatial and spatiotemporal anomalies using persistent homology: Case studies with COVID-19 data",
            "venue": "SIAM J. Math. Data Sci.,",
            "year": 2022
        },
        {
            "authors": [
                "Woojin Kim",
                "Facundo M\u00e9moli"
            ],
            "title": "Spatiotemporal persistent homology for dynamic metric spaces",
            "venue": "Discrete & Computational Geometry,",
            "year": 2021
        },
        {
            "authors": [
                "Yanjie Li",
                "Dingkang Wang",
                "Giorgio A. Ascoli",
                "Partha Mitra",
                "Yusu Wang"
            ],
            "title": "Metrics for comparing neuronal tree shapes based on persistent homology",
            "venue": "PLoS ONE,",
            "year": 2017
        },
        {
            "authors": [
                "Shawn Martin",
                "Aidan Thompson",
                "Evangelos A. Coutsias",
                "Jean-Paul Watson"
            ],
            "title": "Topology of cyclooctane energy landscape",
            "venue": "Journal of Chemical Physics,",
            "year": 2010
        },
        {
            "authors": [
                "Nina Otter",
                "Mason A. Porter",
                "Ulrike Tillmann",
                "Peter Grindrod",
                "Heather A. Harrington"
            ],
            "title": "A roadmap for the computation of persistent homology",
            "venue": "EPJ Data Science,",
            "year": 2017
        },
        {
            "authors": [
                "Raul Rabadan",
                "Andrew J. Blumberg"
            ],
            "title": "Topological Data Analysis for Genomics and Evolution: Topology in Biology",
            "year": 2019
        },
        {
            "authors": [
                "Kristian Strommen",
                "Matthew Chantry",
                "Joshua Dorrington",
                "Nina Otter"
            ],
            "title": "A topological perspective on weather regimes",
            "venue": "Climate Dynamics,",
            "year": 2022
        },
        {
            "authors": [
                "Chad M. Topaz",
                "Lori Ziegelmeier",
                "Tom Halverson"
            ],
            "title": "Topological data analysis of biological aggregation models",
            "venue": "PLoS ONE,",
            "year": 2015
        },
        {
            "authors": [
                "Katharine Turner",
                "Sayan Mukherjee",
                "Doug M. Boyer"
            ],
            "title": "Persistent homology transform for modeling shapes and surfaces",
            "venue": "Information and Inference: A Journal of the IMA,",
            "year": 2014
        },
        {
            "authors": [
                "Yusu Wang",
                "Pankaj K. Agarwal",
                "Paul Brown",
                "Herbert Edelsbrunner",
                "Johannes Rudolph"
            ],
            "title": "Coarse and reliable geometric alignment for protein docking",
            "venue": "Pacific Symposium on Biocomputing,",
            "year": 2005
        },
        {
            "authors": [
                "Schmuel Weinberger"
            ],
            "title": "The Topological Classification of Stratified Spaces. Chicago Lectures in Mathematics",
            "year": 1994
        },
        {
            "authors": [
                "Lu Xian",
                "Henry Adams",
                "Chad M. Topaz",
                "Lori Ziegelmeier"
            ],
            "title": "Capturing dynamics of time-varying data via topology",
            "venue": "Foundations of Data Science,",
            "year": 2022
        }
    ],
    "sections": [
        {
            "heading": "1. Introduction",
            "text": "In topological data analysis (TDA), our aim is to understand the global shape of a data set. Often, the data set takes the form of a collection of points in Rn, called a point cloud, and we hope to analyze the topology of a lower-dimensional space that the points lie on. TDA has found applications in a variety of fields, such as biology [29], neuroscience [12], and chemistry [27].\nWe use persistent homology (PH), a tool from algebraic topology [21]. The first step of persistent homology is to construct a filtered complex from our data; a filtered complex is a nested sequence\n(1) Kr0 \u2286 Kr1 \u2286 \u00b7 \u00b7 \u00b7 \u2286 Krn \u2286 \u00b7 \u00b7 \u00b7\nof simplicial complexes. For example, one of the standard ways to build a filtered complex from point cloud data is to construct the Vietoris\u2013Rips filtered complex. At filtrationparameter value r, the Vietoris\u2013Rips complex Kr includes a simplex for every subset of points within r of each other. In persistent homology, one studies how the topology of Kr changes as the filtration parameter-value r increases. As r grows, new homology classes (which represent \u201choles\u201d in the data) are born and old homology classes die. One way of summarizing this information is a persistence diagram: a multiset of points in the extended plane R2. If there is a homology class that is born at filtration-parameter value b and dies at filtration-parameter value d, the persistence diagram contains the point (b, d).\nDate: August 15, 2023.\n1\nar X\niv :2\n21 0.\n05 12\n4v 2\n[ m\nat h.\nA T\n] 1\n1 A\nug 2\n02 3\nDeveloping new methods for analyzing how the topology of a data set changes as multiple parameters vary is a very active area of research [7]. For example, if a point cloud evolves over time (i.e., it is a dynamic metric space), then one maybe interested in using time as a second parameter, in addition to the filtration parameter r. Common examples of timeevolving point clouds include swarming or flocking animals whose positions and/or velocities are represented by points ( [15, 25, 36]). In such cases, one can obtain a filtered complex Ktr0 \u2286 K t r1\n\u2286 \u00b7 \u00b7 \u00b7 \u2286 Ktrn at every time t by constructing, e.g., the Vietoris\u2013Rips filtered complex for the point cloud at time t. It is also common to use the density of the point cloud as a parameter ( [6, 10, 30]). Many other parameters can also vary in the topological analysis of point clouds or other types of data sets.\nOne can use a vineyard [14] to study a 1-parameter family of filtrations {Ktr0 \u2286 K t r1 \u2286 \u00b7 \u00b7 \u00b7 Ktrn}t\u2208R such as that obtained from a time-varying point cloud. At each t \u2208 R, one can compute the PH of the filtration Ktr0 \u2286 K t r1\n\u2286 \u00b7 \u00b7 \u00b7 \u2286 Ktrn and obtain a persistence diagram PD(t). A vineyard is visualized as the continuously-varying \u201cstack of PDs\u201d {PD(t)}t\u2208R. See Figure 1 for an illustration. As t \u2208 R varies, the points in the PDs trace out curves (\u201cvines\u201d) in R3. Each vine corresponds to a homology class (i.e., one of the holes in the data), and shows how the persistence of that homology class changes with time (or, more generally, as some other parameter varies). However, one cannot use a vineyard for a set of filtrations that is parameterized by a space that is not a subset of R. For example, suppose that we have a time-varying point cloud whose dynamics depend on some system-parameter values \u00b51, . . . , \u00b5m \u2208 R. Many such systems exist. For example, the D\u2019Orsogna model is a multi-agent dynamical system that models attractive and repulsive interactions between particles [11]. Each particle is represented by a point in a point cloud. In certain parameter regimes, there are interesting topological features, such as mills or double mills [31]. For each time t \u2208 R and for each \u00b51, . . . , \u00b5m \u2208 R, one can obtain a filtered complex\n(2) Kt,\u00b51,...,\u00b5mr0 \u2286 K t,\u00b51,...,\u00b5m r1 \u2286 \u00b7 \u00b7 \u00b7 \u2286 Kt,\u00b51,...,\u00b5mrn\nby constructing, e.g., the Vietoris\u2013Rips filtered complex for the point cloud at time t at system-parameter values \u00b51, . . . , \u00b5m. A parameterized set of filtered complexes like the one in (2) cannot be studied using a vineyard for the simple reason that there are too many parameters.\nSuch a parameterized set of filtered complexes cannot be studied using multiparameter PH [8], either. A multifiltration is a set {Ku}u\u2208Rn of simplicial complexes such that Ku \u2286 Kv whenever u \u2264 v. Multiparameter PH is the F[x1, . . . , xn] module obtained by applying homology (over a field F) to a multifiltration. (For more details, see reference [8].) The parameterized set of filtered complexes in (2) is not typically a multifiltration because it is not necessarily the case that Kt,\u00b51,...,\u00b5mri \u0338\u2286 K t\u2032,\u00b5\u20321,...,\u00b5 \u2032 m ri for all values of t, t \u2032, {\u00b5i}, and {\u00b5\u2032i}. Not only is there not necessarily an inclusion Kt,\u00b51,...,\u00b5mri \u21aa\u2212\u2192 K t\u2032,\u00b5\u20321,...,\u00b5 \u2032 m ri , but there is not any given simplicial map Kt,\u00b51,...,\u00b5mri \u2192 K t\u2032,\u00b5\u20321,...,\u00b5 \u2032 m\nri . Therefore, we cannot use multiparameter PH. In what follows, we will work with a slightly different notion of filtered complex than that of (1). A filtration function is a function f : K \u2192 R, where K is a simplicial complex, such that every sublevel set Kr := {\u03c3 \u2208 K | f(\u03c3) \u2264 r} is a simplicial complex (i.e., f(\u03c4) \u2264 f(\u03c3) if \u03c4 is a face of \u03c3). For every r \u2264 s, we have that Kr \u2286 Ks. A simplex \u03c3 \u2208 K appears in the filtration at r = f(\u03c3). By setting {ri} = Im(f), where ri < ri+1, we obtain a nested sequence as in (1). Conversely, given a nested sequence of simplicial complexes, the associated filtration function is f(\u03c3) = min{ri | \u03c3 \u2208 Kri}, with K = \u22c3 i Kri .\n1.1. Contributions. I introduce the concept of a persistence diagram (PD) bundle, in which PH varies over an arbitrary \u201cbase space\u201d B. A PD bundle gives a way of studying a fibered filtration function, which is a set {fp : Kp \u2192 F}p\u2208B of functions such that fp is a filtration of a simplicial complex Kp. At each p \u2208 B, the sublevel sets of fp form a filtered complex. For example, in (2), we have B = Rn+1 and we obtain a fibered filtration function {ft,\u00b51,...,\u00b5m : K \u2192 R}(t,\u00b51,...,\u00b5m)\u2208Rm+1 by defining ft,\u00b51,...,\u00b5m to be the filtration function associated with the filtered complex in (2). The associated PD bundle is the space of persistence diagrams PD(fp) as they vary with p \u2208 B (see Definition 3.2). In the special case in which B is an interval in R, a PD bundle is equivalent to a vineyard.\nI prove that for \u201cgeneric\u201d fibered filtration functions (see Section 4.2), the base space B can be stratified in a way that makes PD bundles tractable to compute and analyze. Theorem 4.15 says that for a \u201cgeneric\u201d fibered filtration function on a smooth compact manifold B, the base space B is stratified such that within each stratum, there is a single PD \u201ctemplate\u201d that can be used to obtain PD(fp) at any point p in the stratum. Proposition 4.5 shows that all \u201cpiecewise-linear\u201d PD bundles (see Definition 3.4) have such a stratification. The template is a list of (birth, death) simplex pairs, and the diagram PD(fp) is obtained by evaluating fp on each simplex. In particular, when B is a smooth compact manifold, the number of strata is finite, so the PD bundle is determined by the PH at a finite number of points in the base space.\nI show that unlike vineyards, PD bundles do not necessarily decompose into a union of \u201cvines\u201d. More precisely, there may not exist continuous maps \u03b31, . . . , \u03b3m : B \u2192 E such that\n(3) PD(fp) = m\u22c3 i=1 \u03b3i(p)\nfor all p \u2208 B. This is a consequence of Proposition 5.3, in which it is shown that nontrivial global sections are not guaranteed to exist. That is, given a point z0 \u2208 PD(fp0) for some\np0 \u2208 B, it may not be possible to extend p0 7\u2192 z0 to a continuous map s : B \u2192 E := {(p, z) | z \u2208 PD(fp)} such that s(p) \u2208 PD(fp) for all p. This behavior is a feature that gives PD bundles a richer mathematical structure than vineyards.\nFor any fibered filtration with a stratification as described above (see Theorem 4.15 and Proposition 4.5), I construct a \u201ccompatible cellular sheaf\u201d (see Section 6.2) that stores the data in the PD bundle. Rather than analyzing the entire PD bundle, which consists of continuously varying PDs over the base space B, we can analyze the cellular sheaf, which is discrete. For example, in Proposition 6.4, I prove that an extension of p0 7\u2192 z0 to a global section exists if a certain associated global section of the cellular sheaf exists. A compatible cellular sheaf stores sufficient data to reconstruct the associated PD bundle and analyze its sections.\nThough not the focus of this paper, I also give a simple example of vineyard instability in Appendix A.1. It is often quoted in the research literature that \u201cvineyards are unstable\u201d; however, this \u201cwell-known fact\u201d has been shared only in private correspondence and, to the best of my knowledge, has never been published. The example of vineyard instability is furnished from an example in Proposition 5.3.\n1.2. Related work. PD bundles are a generalization of vineyards, which were introduced in [14]. Two other important special cases of PD bundles are the fibered barcode of a multiparameter persistence module [4] and the persistent homology transform (B = Sn) from shape analysis [2,32]. I discuss the special case of fibered barcodes in detail in Section 3.2.2; the base space B is a subset of the space of lines in Rn. The persistent homology transform (PHT) is defined for a constructible set M \u2286 Rn+1. For any unit vector v \u2208 Sn, one defines the filtration M vr = {x \u2208 M | x \u00b7 v \u2264 r} (i.e., the sublevel filtration of the height function with respect to the direction v). PHT is the map that sends v \u2208 Sn to the persistence diagram for the filtration {M vr }r\u2208R. The significance of PHT is that it is a sufficient statistic for shapes in R2 and R3 [32]. Applications of PHT are numerous and include protein docking [34], barley-seed shape analysis [3], and heel-bone analysis in primates [32].\nFor PHT, Curry et al. [18] proved that the base space Sn is stratified such that the PHT of a shape M is determined by the PH of {M vr }r\u2208R for finitely many directions v \u2208 Sn (one direction v per stratum). This is related to the stratification given by Theorem 4.15, in which I show that a \u201cgeneric\u201d PD bundle whose base space B is a compact smooth manifold (such as Sn) is similarly stratified and thus determined by finitely many points in B (one p \u2208 B per stratum). The primary difference between the stratifications in [18] and Theorem 4.15 is that in [18], each stratum is a subset in which the order of the vertices of a triangulated shape M (as ordered by the height function) is constant, whereas in Theorem 4.15, each stratum is a subset in which the order of the simplices (as ordered by the filtration function) is constant. The stratification result of the present paper (Theorem 4.15) applies to general PD bundles, while [18] applies only to PHT.\nThe stratification that we study in the present paper is used in [23] to develop an algorithm for computing \u201cpiecewise-linear\u201d PD bundles (see Definition 3.4). The algorithm relies on the fact that for any piecewise-linear PD bundle on a compact triangulated base space B, there are a finite number of strata, so the PD bundle is determined by the PH at a finite number of points in B.\nThe existence (or nonexistence) of nontrivial global sections in PD bundles is related to the study of \u201cmonodromy\u201d in fibered barcodes of multiparameter persistence modules [9].\nCerri et al. [9] constructed an example in which there is a path through the fibered barcode that loops around a \u201csingularity\u201d (a PD in the fibered barcode for which there is a point in the PD with multiplicity greater than one) and finishes in a different place than where it starts.\n1.3. Organization. This paper proceeds as follows. I review background on persistent homology in Section 2. In Section 3, I give the definition of a PD bundle, with some examples, and I compare PD bundles to multiparameter PH. In Section 4, I show how to stratify the base space B into strata in which the (birth, death) simplex pairs are constant (see Theorem 4.15 and Proposition 4.5). I discuss sections of PD bundles and the existence of monodromy in Section 5. I construct a compatible cellular sheaf in Section 6.2. I conclude and discuss possible directions for future research in Section 7. In Appendix A.1, I use the example of monodromy from Section 5 to construct an example of vineyard instability. In Appendix A.2, I provide technical details that are needed to prove Theorem 4.15."
        },
        {
            "heading": "2. Background",
            "text": "We begin by reviewing persistent homology (PH) and cellular sheaves. For a more thorough treatment of PH, see [19, 28], and for more on cellular sheaves, see [16,22].\n2.1. Filtrations. Consider a simplicial complex K. A filtration function on K is a realvalued function f : K \u2192 R such that if \u03c4 \u2208 K is a face of \u03c3 \u2208 K, then f(\u03c4) \u2264 f(\u03c3). The filtration value of a simplex \u03c3 \u2208 K is f(\u03c3). The r-sublevel sets Kr := {\u03c3 \u2208 K | f(\u03c3) \u2264 r} form a filtered complex. The condition that f(\u03c4) \u2264 f(\u03c3) if \u03c4 \u2286 \u03c3 guarantees that Kr is a simplicial complex for all r. For all s \u2264 r, we have Ks \u2286 Kr. The parameter r is the filtration parameter. For an example, see Figure 2.\nFor example, suppose that X = {xi}Mi=1 is a point cloud. Let K be the simplicial complex that has a simplex \u03c3 with vertices {xj}j\u2208J for all J \u2286 {1, . . . ,M}. The Vietoris\u2013Rips filtration function is f(\u03c3) = 1\n2 maxj,k\u2208J{\u2225xj \u2212 xk\u2225}, where {xj}j\u2208J are the vertices of \u03c3.\n2.2. Persistent homology. Let f : K \u2192 R be a filtration function on a finite simplicial complex K, and let {Kr}r\u2208R be the associated filtered complex. Let r1 < \u00b7 \u00b7 \u00b7 < rN be the filtration values of the simplices of K. These are the critical points at which simplices are added to the filtration. For all s \u2208 [ri, ri+1), we have Ks = Kri .\nFor all i \u2264 j, the inclusion \u03b9i,j : Kri \u21aa\u2192 Krj induces a map \u03b9i,j\u2217 : H\u2217(Kri ,F) \u2192 H\u2217(Krj ,F) on homology, where F is a field that we set to Z/2Z for the rest of this paper. The qth-persistent homology (PH) is the pair (\n{Hq(Kri ,F)}1\u2264i\u2264N , {\u03b9i,j\u2217 }1\u2264i\u2264j\u2264N ) .\nThe Fundamental Theorem of Persistent Homology yields compatible choices of bases for the vector spaces Hq(Kri ,F), which we use below in our definition of a persistence diagram.\nThe qth persistence diagram PDq(f) is a multiset of points in the extended plane R 2 that summarizes the qth-persistent homology. The PD contains the diagonal as well as a point for every generator. We say that a generator \u03b3 \u2208 Hq(Kri ,F) is born at ri if it is not in the image of \u03b9i,i\u22121\u2217 . The homology class \u03b3 subsequently dies at rj > ri if \u03b9 i,j \u2217 (\u03b3) = 0 and \u03b9 i,j\u22121 \u2217 (\u03b3) \u0338= 0. If \u03b9i,j\u2217 (\u03b3) \u0338= 0 for all j > i, then \u03b3 never dies. For every generator, the PD contains the point (ri, rj) if the generator is born at ri and dies at rj, or else contains the point (ri,\u221e) if the generator is born at ri and never dies.\n2.3. Birth and death simplex pairs. Computing persistent homology can be reduced to computing the set of \u201cbirth\u201d and \u201cdeath\u201d simplices for the generating homology classes. Informally, a birth simplex \u03c3b is a q-simplex that creates a new q-dimensional homology class when it is added to the filtration and a death simplex is a (q+1)-simplex that destroys a q-dimensional homology class when it is added to the filtration. For example, in Figure 2, the 1D PH has one generator. Its birth simplex is the 1-simplex (0, 3) and its death simplex is the 2-simplex (0, 2, 3). For every pair (\u03c3b, \u03c3d) of (birth, death) simplices, the persistence diagram contains the point (f(\u03c3b), f(\u03c3d)). For every unpaired birth simplex \u03c3b, the persistence diagram contains the point (f(\u03c3b),\u221e). In [20], Edelsbrunner and Harer presented an algorithm for computing the (birth, death) simplex pairs of a filtration f : K \u2192 R. Let \u03c31, . . . , \u03c3N be the simplices of K, indexed such that i < j if \u03c3i is a proper face of \u03c3j.\nDefinition 2.1. The simplex order induced by f is the strict partial order \u227af on K such that \u03c3i \u227af \u03c3j if and only if f(\u03c3i) < f(\u03c3j).\nIf the simplex orders \u227af1 ,\u227af2 induced by filtrations f1, f2 (respectively) are the same, then f1(\u03c3i) < f1(\u03c3j) if and only if f2(\u03c3i) < f2(\u03c3j) and f1(\u03c3i) = f1(\u03c3j) if and only if f2(\u03c3i) = f2(\u03c3j).\nThe algorithm of [20] requires a compatible simplex indexing.\nDefinition 2.2. A compatible simplex indexing is a function idx : K \u2192 {1, . . . , N} such that idx(\u03c3i) < idx(\u03c3j) if \u03c3i \u227af \u03c3j or \u03c3i is a proper face of \u03c3j. Because a compatible simplex indexing may not be unique, we fix the simplex indexing induced by f to be the unique function idxf : K \u2192 {1, . . . , N} such that idxf (\u03c3i) < idxf (\u03c3j) if either \u03c3i \u227af \u03c3j or if f(\u03c3i) = f(\u03c3j) and i < j.\nThe function idxf is a compatible simplex indexing because if \u03c3i is a proper face of \u03c3j, then i < j and f(\u03c3i) \u2264 f(\u03c3j). The sequence idx\u22121f (1), . . . , idx \u22121 f (N) of simplices is ordered by the value of f on each simplex, with ties broken by the order of the simplices in the sequence \u03c31, . . . , \u03c3N . The indexing idxf is defined such that if we define K\u2032j := {\u03c3 \u2208 K | idxf (\u03c3) \u2264 j}, then\nK\u20321 \u2286 K\u20322 \u2286 \u00b7 \u00b7 \u00b7 \u2286 K\u2032N\nis a nested sequence of simplicial complexes and if ri = f(\u03c3j1) = \u00b7 \u00b7 \u00b7 = f(\u03c3jk), where j1 < \u00b7 \u00b7 \u00b7 < jk and {ri} = Im(f), with ri < ri+1, then\nKri = K\u2032j1 \u2282 K \u2032 j2 \u2282 \u00b7 \u00b7 \u00b7 \u2282 K\u2032jk \u2282 Kri+1 .\nIn other words, {K\u2032j} is a refinement of {Kri}. The following lemma is a straightforward corollary of the work in [19], and we will rely on\nit repeatedly in the present paper.\nLemma 2.3 ( [19]). If f0, f1 : K \u2192 R are two filtration functions such that \u227af0 is the same as \u227af1 , then idxf0 = idxf1 and f1 and f2 both induce the same set of (birth, death) simplex pairs.\n2.4. Updating persistent homology when the simplex indexing is updated. One of the main contributions of [14], in which vineyards were introduced, is an algorithm for updating the (birth, death) simplex pairs when the simplex indexing changes. We review the relevant details in this subsection.\nSuppose that idxf0 , idxf1 : K \u2192 {1, . . . , N} are the simplex indexings that are induced by filtrations f0, f1 : K \u2192 R (respectively), and suppose that idxf0 and idxf1 differ only by a transposition of a pair (\u03c3, \u03c4) of consecutive simplices. That is, idxf0(\u03c4) = idxf0(\u03c3) + 1, idxf1(\u03c4) = idxf0(\u03c3), and idxf1(\u03c3) = idxf0(\u03c4). Let Sidxf0 and Sidxf1 be the sets of (birth, death) simplex pairs for f0 and f1, respectively. 1 The update rule of [14] gives us bijection \u03d5idxf0 , idxf1 : Sidxf0 \u2192 Sidxf1 . We review the key properties of the bijection \u03d5idxf0 , idxf1 . We write\n\u03d5idxf0 , idxf1 = (\u03d5 idxf0 , idxf1 b , \u03d5 idxf0 , idxf1 d ) ,\nwhere \u03d5 idxf0 , idxf1 b : Sidxf0 \u2192 K maps a simplex pair (\u03c3b, \u03c3d) \u2208 Sidxf0 to the birth simplex of \u03d5idxf0 , idxf1 ((\u03c3b, \u03c3d)) and \u03d5 idxf0 , idxf1 d : Sidxf0 \u2192 K maps (\u03c3b, \u03c3d) \u2208 Sidxf0 to the death simplex of \u03d5idxf0 , idxf1 ((\u03c3b, \u03c3d)). If (\u03c3b, \u03c3d) \u2208 Sidxf0 is a pair such that \u03c3b, \u03c3d \u0338\u2208 {\u03c3, \u03c4}, then \u03d5idxf0 , idxf1 ((\u03c3b, \u03c3d)) = (\u03c3b, \u03c3d). If (\u03c3 1 b , \u03c3 1 d) \u2208 Sidxf0 is the pair that contains \u03c3, then let \u03bb \u2208 {b, d} be the index such that \u03c31\u03bb = \u03c3. Similarly, if (\u03c32b , \u03c32d) \u2208 Sidxf0 is the pair that contains \u03c4 , then let \u00b5 \u2208 {b, d} be the index such that \u03c31\u00b5 = \u03c4 . The key fact about the update rule of [14] is that \u03d5idxf0 , idxf1 is defined such that either\n\u03d5idxf0 , idxf1 ((\u03c31b , \u03c3 2 d)) = (\u03c3 1 b , \u03c3 1 d) ,\n\u03d5idxf0 , idxf1 ((\u03c32b , \u03c3 2 d)) = (\u03c3 2 b , \u03c3 2 d) ,\nor\n\u03d5 idxf0 , idxf1 \u03bb ((\u03c3 1 b , \u03c3 1 d)) = \u03c4 , \u03d5 idxf0 ,idxf1 \u03bbc ((\u03c3 1 b , \u03c3 1 d)) = \u03c3 1 \u03bbc ,\n\u03d5 idxf0 , idxf1 \u00b5 ((\u03c3 2 b , \u03c3 2 d)) = \u03c3 , \u03d5 idxf0 , idxf1 \u00b5c ((\u03c3 2 b , \u03c3 2 d)) = \u03c3 1 \u00b5c ,\nwhere\n\u03bbc :=\n{ b , \u03bb = d\nd , \u03bb = b \u00b5c :=\n{ b , \u00b5 = d\nd , \u00b5 = b .\n1Recall that, by Lemma 2.3, the pairs depend only on the simplex orders idxf0 , idxf1 , which is why we label the sets by their associated simplex indexings.\nIn other words, either \u03d5idxf0 , idxf1 is the identity map or \u03d5idxf0 , idxf1 swaps \u03c3 and \u03c4 in the pairs that contain them. The particular case depends on the order of f0(\u03c3 1 b ), f0(\u03c3 1 d), f0(\u03c3 2 b ), f0(\u03c3 2 d) (see [14] for details; they are not relevant to the present paper). More generally, suppose that idxf0 , idxf1 are the simplex indexings induced by any two filtrations f0, f1, where idxf0 and idxf1 are no longer required to differ only by the transposition of two consecutive simplices. Let Sidxf0 and Sidxf1 be the sets of (birth, death) simplex pairs for f0 and f1, respectively. The update rule of Cohen-Steiner et al. [14] defines a bijection \u03d5idxf0 , idxf1 : Sidxf0 \u2192 Sidxf1 as follows. Every permutation can be decomposed into a sequence of transpositions that transpose consecutive elements, so there is a sequence \u03b60, . . . , \u03b6m of simplex indexings such that \u03b60 = idxf0 , \u03b6m = idxf1 , and \u03b6i, \u03b6i+1 differ only by the transposition of two consecutive simplices. Cohen-Steiner et al. [14] defined\n(4) \u03d5idxf0 , idxf1 := \u03d5\u03b6m\u22121, \u03b6m \u25e6 \u00b7 \u00b7 \u00b7 \u25e6 \u03d5\u03b60, \u03b61 .\nRemark 2.4. If idxf0 , idxf1 do not differ by only the transposition of two consecutive simplices, then the sequence \u03b60, . . . , \u03b6m is not unique. Unfortunately, the definition of \u03d5 idxf0 , idxf1 does depend on the sequence \u03b60, . . . , \u03b6m in its definition. This is implicitly shown in Proposition 5.3.\n2.5. Cellular Sheaves. A cell complex is a topological space Y with a partition into a set {Y\u03b1}\u03b1\u2208PY of subspaces (the cells of the cell complex) that satisfy the following conditions:\n(1) Every cell Y\u03b1 is homeomorphic to Rk\u03b1 for some k\u03b1 \u2265 0. The cell Y\u03b1 is a k\u03b1-cell. (2) For every cell Y\u03b1, there is a homeomorphism \u03d5\u03b1 : B\nk\u03b1 \u2192 X\u03b1, where Bk\u03b1 is the closed k\u03b1-dimensional ball, such that \u03d5\u03b1(int(B\nk\u03b1)) = X\u03b1. (3) Axiom of the Frontier: If the intersection Y\u03b2 \u2229Y\u03b1 is nonempty, then Y\u03b1 \u2286 Y\u03b2. We\nsay that Y\u03b1 is a face of Y\u03b2. (4) Locally finite: Every x \u2208 X has an open neighborhood U such that U intersects\nfinitely many cells.\nFor example, a polyhedron is a cell complex whose k-cells are the k-dimensional faces of the polyhedron. A graph is a another example of a cell complex; the 0-cells are the vertices and the 1-cells are the edges.\nWe will first review the most general definition of cellular sheaves, which uses category theory, and then we will specialize to the case of interest for the present paper, which does not require category theory. Let Y be a cell complex with cells {Y\u03b1}\u03b1\u2208PY , and let D be a category. The set PY is a poset with the relation \u03b1 \u2264 \u03b2 if Y\u03b1 \u2286 Y\u03b2.\nA D-valued cellular sheaf on Y consists of (1) An assignment of an object F(Y\u03b1) \u2208 D (the stalk of F at Y\u03b1) for every cell Y\u03b1 in Y ,\nand (2) A morphism F\u03b1\u2264\u03b2 : F (Y\u03b1) \u2192 F (Y\u03b2) (a restriction map) whenever Y\u03b1 is a face of Y\u03b2.\nThe morphisms must satisfy the composition condition:\n(5) F\u03b2\u2264\u03b3 \u25e6 F\u03b1\u2264\u03b2 = F\u03b1\u2264\u03b3\nwhenever \u03b1 \u2264 \u03b2 \u2264 \u03b3. Equivalently, a D-valued cellular sheaf on Y is a functor F : PY \u2192 D, where PY is considered as a category.\nA global section of a cellular sheaf F is a function s : {Y\u03b1}\u03b1\u2208PY \u2192 \u22c3 \u03b1 F(Y\u03b1)\nsuch that\n(1) s(Y\u03b1) \u2208 F(Y\u03b1) (i.e., s(Y\u03b1) is a choice of element in the stalk at Y\u03b1), and (2) if \u03b1 \u2264 \u03b2, then s(Y\u03b2) = F\u03b1\u2264\u03b2(s(Y\u03b1)) . In what follows, we will consider a Set-valued cellular sheaf. The objects of the category\nSet are sets, and the morphisms between sets A and B are the functions from A to B. A Set-valued cellular sheaf on a cell complex Y consists of\n(1) A set F(Y\u03b1) for every cell Y\u03b1 in Y , and (2) A function F\u03b1\u2264\u03b2 : F(Y\u03b1) \u2192 F(Y\u03b2) whenever Y\u03b1 is a face of Y\u03b2. The functions must\nsatisfy the condition: F\u03b2\u2264\u03b3 \u25e6 F\u03b1\u2264\u03b2 = F\u03b1\u2264\u03b3 whenever \u03b1 \u2264 \u03b2 \u2264 \u03b3."
        },
        {
            "heading": "3. Definition of a Persistence Diagram Bundle",
            "text": "A vineyard is a 1-parameter set of persistence diagrams that is computed from a 1- parameter set of filtration functions on a simplicial complex K. We generalize a vineyard to a \u201cpersistence diagram bundle\u201d as follows.\nDefinition 3.1 (Fibered filtration function). A fibered filtration function is a set {fp : Kp \u2192 R}p\u2208B, where B is a topological space, {Kp}p\u2208B is a set of simplicial complexes parameterized by B, and fp is a filtration function on Kp.\nWhen Kp \u2261 K for all p \u2208 B, we define f : K \u00d7 B \u2192 R to be the function f(\u03c3, p) := fp(\u03c3). In a slight abuse of notation, we refer to f : K \u00d7 B \u2192 R, rather than to {fp : K \u2192 B}p\u2208B, as the fibered filtration function. For all p \u2208 B, the function f(\u00b7, p) : K \u2192 R is a filtration of K. For several examples with Kp \u2261 K, see Section 3.1.\nDefinition 3.2 (Persistence diagram bundle). Let {fp : Kp \u2192 R}p\u2208B be a fibered filtration function. The base of the bundle is B. The qth total space of the bundle is E := {(p, z)} | p \u2208 B, z \u2208 PDq(fp)}, with the subspace topology inherited from the inclusion E \u21aa\u2192 B\u00d7R 2 .2 The qth persistence diagram bundle is the triple (E,B, \u03c0), where \u03c0 : E \u2192 B is the projection (p, z) 7\u2192 p.\nFor example, when B is an interval in R and Kp \u2261 K, Definition 3.2 reduces to that of a vineyard: a 1-parameter set of PDs for a 1-parameter set of filtrations of K. As discussed in Section 1, PHT is a special case with B = Sd. The fibered barcode of a multiparameter persistence module is another special case; we will discuss it in Section 3.2.2.\nRemark 3.3. In Definition 3.2, we are suggestively using the language of fiber bundles. However, it is important to note that a PD bundle is not guaranteed to be a true fiber bundle. The fibers need not be homeomorphic to each other for all p \u2208 B. At \u201csingularities\u201d (points p\u2217 \u2208 B at which PD(fp\u2217) has an off-diagonal point with multiplicity), points in\n2Technically, E is a multiset because persistence diagrams are multisets. However, when considering E as a topological space (which we do in Section 5 to study continuous paths in E and sections of the PD bundle), we consider E as a set.\nPD(fp) for nearby p may merge into each other, changing the homotopy type of the fiber. However, if f : K \u00d7 B \u2192 R is continuous and p \u2208 B is not a singularity, then there is a neighborhood U \u2286 B and a homeomorphism \u03d5 : \u03c0\u22121(U) \u2192 U\u00d7PD(fp\u2217) that preserves fibers (i.e., a local trivialization).\nAs a special case of fibered filtration functions, we define piecewise-linear fibered filtration functions, which are simpler to analyze.\nDefinition 3.4 (Piecewise-linear fibered filtration function). Let {fp : Kp \u2192 R}p\u2208B be a fibered filtration function such that Kp \u2261 K. We define f(\u03c3, p) := fp(\u03c3) for all \u03c3 \u2208 K and p \u2208 B. If B is a simplicial complex and f(\u03c3, \u00b7) is linear on each simplex of B for all simplices \u03c3 \u2208 K, then f is a piecewise-linear fibered filtration function. The resulting PD bundle is a piecewise-linear PD bundle.\nFor instance, the fibered filtration function in Example 3.6, below, is piecewise linear.\n3.1. Examples. The following are concrete examples of PD bundles. We begin with the example that motivated PD bundles in Section 1.\nExample 3.5. Suppose that X(t,\u00b5) = {x1(t,\u00b5), . . . , xk(t,\u00b5)} is a point cloud that varies continuously with time t \u2208 R and system-parameter values \u00b51, . . . , \u00b5m \u2208 R. We obtain a fibered filtration function f : K \u00d7 Rm+1 \u2192 R by defining f(\u00b7, (t,\u00b5)) : K \u2192 R to be the Vietoris\u2013Rips filtration function for the point cloud X(t,\u00b5) at all (t,\u00b5) \u2208 Rm+1 (or any other filtration for the point cloud at each (t,\u00b5)). The simplicial complex K is the simplicial complex that has a simplex for every subset of points in the point cloud.\nExample 3.6. Consider a color image. Enumerate the pixels and let r(i), g(i), and b(i) denote the red, green, and blue values of the ith pixel. Triangulate each pixel to obtain a simplicial complex K. (Every pixel is split into two triangles.) Let B = {(w1, w2) \u2208 [0, 1]2 | 0 \u2264 w1 + w2 \u2264 1}. For all (w1, w2) \u2208 B, define p(i, (w1, w2)) = w1r(i) + w2g(i) + (1\u2212 w1 \u2212 w2)b(i). The function p(i, (w1, w2)) is a weighted average of the red, green, and blue values of the ith pixel. Define a piecewise-linear fibered filtration function f : K \u00d7B \u2192 R as follows. For a 2-simplex \u03c3, define f(\u03c3,w) = p(i(\u03c3),w), where i(\u03c3) is the pixel containing \u03c3. For any other simplex \u03c3 \u2208 K, define f(\u03c3,w) = min{f(\u03c4,w) | \u03c3 \u2286 \u03c4, dim(\u03c4) = 2}. At w = (1, 0), w = (0, 1), and w = (1, 1), the filtration function f(\u00b7,w) is the sublevel filtration by red, green, and blue pixel values, respectively. At all other w \u2208 B, the filtration function f(\u00b7,w) is the sublevel filtration by a weighted average of the red, green, and blue pixel values.\nExample 3.7. Let \u00b51, . . . , \u00b5m \u2208 R denote the system-parameter values of some discrete dynamical system. For given system-parameter values \u00b5 \u2208 Rm, let x\u00b5i \u2208 Rn be the solution at the ith time step and let X(\u00b5) = {x\u00b50 , . . . , x \u00b5 k } be the set of points obtained after the first k time steps. For example, persistent homology has been used to study orbits of the linked twist map (a discrete dynamical system) [1]. We obtain a fibered filtration function f : K \u00d7 Rm \u2192 R by defining f(\u00b7,\u00b5) : K \u2192 R to be the Vietoris\u2013Rips filtration function for the point cloud X(\u00b5) (or any other filtration for the point cloud at each \u00b5). The simplicial complex K has a simplex for every subset of points in the point cloud. Example 3.8. Suppose that X(t) = {x1(t), . . . , xk(t)} is a time-varying point cloud in a compact triangulable subset S \u2286 Rn. Let \u03c1h(\u00b7, t) be a kernel density estimator at time t, with bandwidth parameter h > 0. For fixed h and t, we define a filtered complex by considering sublevel sets of \u03c1h as follows. Let K be a triangulation of S \u2286 Rn. A vertex v of K is included\nin the simplicial complex K(t,h)r if \u03c1h(v, t) \u2264 r, and a simplex of K is included in Kt,hr if all of its vertices are in K(t,h)r . For each t and h, the set {K(t,h)r }r\u2208R is a filtered complex. We obtain a fibered filtration function f : K\u00d7R2+ \u2192 R by defining f(\u00b7, (t, h)) to be the filtration function associated with the filtered complex {K(t,h)r }r\u2208R.\nDensity sublevels of time-varying point clouds were also considered by Corcoran et al. [15], who studied a school of fish swimming in a shallow pool that was modeled as a subset of R2. However, Corcoran et al. [15] fixed a bandwidth parameter h and a sublevel r, and only studied how the PH changed with time (by using zigzag PH).\n3.2. Comparison to multiparameter PH. Multiparameter PH was introduced in [8]; see [7] for a review. Typically, a fibered filtration function does not induce a multifiltration, but the fibered barcode of a multiparameter peristence module is an example of a PD bundle.\n3.2.1. Multifiltrations. We review the definition of a multifiltration and compare it to the definition of a fibered filtration.\nDefinition 3.9. A multifiltration is a set {Ku}u\u2208Zn of simplicial complexes such that if u \u2264 v, then Ku \u2286 Kv.\nThe inclusion \u03b9u,v : Ku \u21aa\u2192 Kv induces a map \u03b9u,v\u2217 : Hq(Ku,F) \u2192 Hq(Kv,F) from the qth homology of Ku to the qth homology of Kv over a field F. Given a multifiltration {Ku}u\u2208Zn , the multiparameter persistence module is the graded F[x1, . . . , xn]-module \u2295 u\u2208Zn Hq(Ku,F). The action of xi on a homogeneous element \u03b3 \u2208 Hq(Ku,F) is given by xi\u03b3 = \u03b9\u2217u,v(\u03b3), where vj = uj + \u03b4ij.\nRemark 3.10. Some researchers define multifiltrations more generally as functors F : P \u2192 Simp, where P is any poset and Simp is the category of simplicial complexes, with simplicial maps as morphisms. Definition 3.9 is the specific case in which P = Zn and Fu\u2264v : Ku \u2192 Kv is an inclusion map.\nTo see why a fibered filtration function does not typically induce a multifiltration, consider a fibered filtration function {fp : Kp \u2192 R}p\u2208B with B = Rn. Let Kpr := {\u03c3 \u2208 Kp | fp(\u03c3) \u2264 r} denote the r-sublevel set of fp. It is not necessarily the case that Kp1s \u2286 Kp2r whenever r \u2264 s and p1 \u2264 p2. Moreover, there are no canonical simplicial maps Kp1s \u2192 Kp2r , so it is not guaranteed that {Kpr}(p,r)\u2208Rn\u00d7R is a multifiltration even in the general sense of Remark 3.10. Therefore, such a set of filtered complexes cannot be analyzed using multiparameter persistent homology.\n3.2.2. Fibered barcodes. Consider a multifiltration {Ku}u\u2208Rn . Let L denote the space of lines in Rn with a parameterization of the form\nL : R \u2192 Rn , L(r) = rv + b , v \u2208 [0,\u221e)n, \u2225v\u2225 = 1, b \u2208 Rn.\nFor example, when n = 2, the space L is the space of lines in R2 with non-negative slope, including vertical lines. For each line L \u2208 L, we define KLr := KL(r). That is, {KLr }r\u2208R is the filtered complex obtained by restricting the multifiltration {Ku}u\u2208Rn to the line L \u2286 Rn. The set {KLr }r\u2208R is a filtered complex because L(r)i \u2264 L(s)i for all r \u2264 s and i \u2208 {1, . . . , n}. The fibered barcode [4] is the map that sends L \u2208 L to the barcode for the persistent homology of {KLr }r\u2208R.\nA fibered barcode is a PD bundle whose base space is B = L. For L \u2208 L, the filtration function is\nfL : KL \u2192 R , fL(\u03c3) = min{r | \u03c3 \u2208 KL(r)} ,\nwhere KL := \u22c3\nr\u2208R KL(r). Unlike the other examples in Section 3.1, the simplicial complex KL is not independent of L \u2208 L."
        },
        {
            "heading": "4. A Stratification of the Base Space",
            "text": "There are many different notions of a stratified space [35]. In the present paper, what we mean by a stratification is the following definition.\nDefinition 4.1. A stratification of a topological space B is a nested sequence\nB0 \u2286 B1 \u2286 B2 \u2286 \u00b7 \u00b7 \u00b7 \u2286 Bn = B of closed subsets Bm such that the following hold:\n(1) For all m, the space Bm \\Bm\u22121 is either empty or a smooth m-dimensional submanifold of B (where we set B\u22121 := \u2205). The m-dimensional strata are the connected components of Bm \\Bm\u22121. We denote the set of strata by Y . (2) The set Y of strata is locally finite: every p \u2208 B has an open neighborhood U such that U intersects finitely many elements of Y . (3) The set Y of strata satisfy the Axiom of the Frontier : If Y\u03b1, Y\u03b2 \u2208 Y are strata such that Y\u03b2 \u2229 Y\u03b1, then Y\u03b2 \u2286 Y\u03b1. We write that Y\u03b2 is a face of Y\u03b1.\nIn the present paper, B is the base space of a fibered filtration function. Theorem 4.15 says that for any \u201cgeneric\u201d smooth fibered filtration function (see Section 4.2), the base space B can be stratified so that in each stratum Y \u2286 B, the set of (birth, death) simplex pairs is constant and can be used to obtain PD(fp) for any p \u2208 Y .\n4.1. Piecewise-linear fibered filtrations. As a warm-up, we first consider piecewiselinear fibered filtration functions, which will provide intuition for the general case. However, note that Proposition 4.5 below is not simply a special case of Theorem 4.15, in which we consider generic smooth fibered filtrations on smooth compact manifolds (see Section 4.2). Here, we consider all piecewise-linear fibered filtrations, rather than only generic piecewiselinear fibered filtrations.\nFirst, we establish some notation and definitions.\nDefinition 4.2. An open half-space of an affine space A is one of the two connected components of A \\H for some hyperplane H.\nFor example, an open half-space of Rn is a set of the form {x \u2208 Rn | Ax > b} for some n\u00d7n matrix A and some vector b \u2208 Rn.\nDefinition 4.3. An open polyhedron is the intersection of open half-spaces.\nFor example, an open polygon P (a polygon without its faces) in R2 is an open 2D polyhedron because it is the intersection of half-spaces of R2. The 1D faces (i.e., edges) of P are 1D polyhedra because an edge is a subset of a line L \u2286 R2 and the edge is the intersection of two half-spaces of L. The 0D faces (i.e., vertices) of P are 0D polyhedra.\nWe fix a simplicial complex K for the remainder of this section. For each pair (\u03c3, \u03c4) of simplices in K, we define (6) I(\u03c3, \u03c4) := {p \u2208 B | f(\u03c3, p) = f(\u03c4, p)} .\nLemma 4.4. Suppose that f : K \u00d7 B \u2192 R is a continuous fibered filtration function (i.e., f(\u03c3, \u00b7) : B \u2192 R is continuous for all simplices \u03c3 \u2208 K) and that Y is a path-connected subset of B. If all pairs (\u03c3, \u03c4) of simplices satisfy either I(\u03c3, \u03c4) \u2229 Y = \u2205 or I(\u03c3, \u03c4) \u2229 Y = Y , then the simplex order is constant in Y . That is, there is a strict partial order \u227aY on K such that for all y \u2208 Y , we have that \u227af(\u00b7,y) is the same as \u227aY .\nProof. Let (\u03c3, \u03c4) be a pair of simplices. If I(\u03c3, \u03c4) \u2229 Y = Y , then f(\u03c3, p) = f(\u03c4, p) for all p \u2208 Y , so \u03c3 \u0338\u227af(\u00b7,p) \u03c4 and \u03c4 \u0338\u227af(\u00b7,p) \u03c3 for all p \u2208 Y . If I(\u03c3, \u03c4) \u2229 Y = \u2205, then f(\u03c3, p) \u0338= f(\u03c4, p) for all p \u2208 Y . Let p0 be a point in Y . Without loss of generality, \u03c4 \u227af(\u00b7,p0) \u03c3. Therefore, f(\u03c3, p0) > f(\u03c4, p0). To obtain a contradiction, suppose that f(\u03c3, p1) < f(\u03c4, p1) for some p1 \u2208 Y . Let \u03b3 : [0, 1] \u2192 Y be a continuous path from p0 to p1, and let g(s) = f(\u03c3, \u03b3(s)) \u2212 f(\u03c4, \u03b3(s)) for s \u2208 [0, 1]. By the Intermediate Value Theorem, there is an s\u2217 \u2208 [0, 1] such that f(\u03c3, \u03b3(s\u2217)) = f(\u03c4, \u03b3(s\u2217)), but this is a contradiction. Therefore, f(\u03c3, p) > f(\u03c4, p) for all p \u2208 Y , which implies that \u03c4 \u227af(\u00b7,p) \u03c3 for all p \u2208 Y . \u25a1\nProposition 4.5. Let B be a simplicial complex. If f : K \u00d7 B \u2192 R is a piecewise-linear fibered filtration function, then B can be partitioned into disjoint polyhedra P on which the simplex order induced by f is constant. That is, there is a strict partial order \u227aP on K such that \u227af(\u00b7,p) is the same as \u227aP for all p \u2208 P . Consequently, the set {(\u03c3b, \u03c3d)} of (birth, death) simplex pairs for f is constant in each P and for any p \u2208 P , the persistence diagram PD(fp) consists of the diagonal and the multiset {(f(\u03c3b), f(\u03c3d)}.\nProof. Let \u2206 be an n-dimensional simplex of the simplicial complex B and let \u03c3 and \u03c4 be distinct simplices of K. Because f(\u03c3, \u00b7)|\u2206 and f(\u03c4, \u00b7)|\u2206 are linear, the set I(\u03c3, \u03c4) \u2229\u2206 is one of the following:\n(1) the intersection of an (n\u2212 1)-dimensional hyperplane with \u2206 ; (2) \u2205 ; (3) \u2206 ; (4) a vertex of \u2206 .\nTherefore, the set \u2202\u2206 \u22c3 {I(\u03c3, \u03c4)\u2229\u2206 | \u2205 \u2282 (I(\u03c3, \u03c4)\u2229\u2206) \u2282 \u2206}\u03c3,\u03c4\u2208K partitions \u2206 into polyhedra. By Lemma 4.4, the simplex order induced by f is constant on each polyhedron. The last statement of Proposition 4.5 follows from Lemma 2.3. \u25a1\nFor example, if B is a triangulated surface, then the set (7) L := \u22c3 \u2206\u2208B \u2202\u2206 \u222a {I(\u03c3, \u03c4) \u2229\u2206 | \u2205 \u2282 (I(\u03c3, \u03c4) \u2229\u2206) \u2282 \u2206}\u03c3,\u03c4\u2208K\npartitions \u2206 into polyhedra such that the simplex order is constant on each polyhedron, including the 1D polyhedra (i.e., edges) and the 0D polyhedra (i.e., vertices). The polygonal subdivision induced by L is called a line arrangement A(L). For an example of such a line arrangement, see Figure 3.\n4.2. Generic smooth fibered filtrations. We now consider generic smooth fibered filtration functions. Throughout Section 4.2, we consider a smooth fibered filtration function of the form f : K \u00d7 B \u2192 R for some n-dimensional smooth compact manifold B and some\nsimplicial complex K. (A fibered filtration f is smooth if f(\u03c3, \u00b7) : B \u2192 R is smooth for all \u03c3 \u2208 K.) To make precise the notion of a \u201cgeneric\u201d fibered filtration function, we consider perturbations of f of a certain form. Because the filtration value of a simplex \u03c3 must be at least as large as the filtration value of any face \u03c4 at all p \u2208 B, we consider only perturbations fa : K \u00d7B \u2192 R of the form\nfa(\u03c3i, p) := f(\u03c3i, p) + ai ,\nwhere a is an element of the set\n(8) A := {a \u2208 RN | ai \u2264 aj for all i \u2264 j} and \u03c31, . . . , \u03c3N are the simplices of K, indexed such that i < j if \u03c3i is a proper face of \u03c3j. By construction, fa is a fibered filtration function for all a \u2208 A. For each simplex \u03c3k in K, we define the manifold\nMk := {(p, f(\u03c3k, p)) | p \u2208 B} \u2286 B \u00d7 R and for each a \u2208 A, we define the manifold (9) Ma,k := {(p, fa(\u03c3k, p)) | p \u2208 B} \u2286 B \u00d7 R . For each pair (\u03c3i, \u03c3j) of simplices in K, we define I(\u03c3i, \u03c3j) as in (6). The set I(\u03c3i, \u03c3j) is the projection of Mi \u2229Mj \u2286 B \u00d7 R to a subset of B. For each a \u2208 A, we define the set\nIa(\u03c3i, \u03c3j) := {p \u2208 B | fa(\u03c3i, p) = fa(\u03c3j, p)} . We also define\nEm := {I(\u03c3i1 , \u03c3j1) \u2229 \u00b7 \u00b7 \u00b7 \u2229 I(\u03c3im , \u03c3jm)} , which is the set of all m-way intersections of sets I(\u03c3i, \u03c3j). For all a \u2208 A, we define (10) Ema := {Ia(\u03c3i1 , \u03c3j1) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3im , \u03c3jm)} .\nLastly, we define\n(11) Em,ka := {Ia(\u03c3i1 , \u03c3j1) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3im , \u03c3jm) | ir, jr \u2264 k for all r} ,\nwhich is the set of m-way intersections that only involve the simplices \u03c31, . . . , \u03c3k.\nRemark 4.6. There are several facts to keep in mind. First, it is not guaranteed that Ia(\u03c3i, \u03c3j) is homeomorphic to I(\u03c3i, \u03c3j) even for arbitrarily small a. Additionally, the sets Ia(\u03c3i, \u03c3j) are not \u201cindependent\u201d of each other; a perturbation of f(\u03c3, \u00b7) for a single simplex \u03c3 causes a perturbation of I(\u03c3, \u03c4) for all \u03c4 \u2208 K. Furthermore, not every element of Em is an (n \u2212 m)-dimensional submanifold, even generically. For example, if I(\u03c3i2 , \u03c3i1) and I(\u03c3i3 , \u03c3i2) are (n\u2212 1)-dimensional submanifolds that intersect transversely, then I(\u03c3i3 , \u03c3i1)\u2229 I(\u03c3i3 , \u03c3i2)\u2229 I(\u03c3i2 , \u03c3i1) = I(\u03c3i3 , \u03c3i2)\u2229 I(\u03c3i2 , \u03c3i1) is an (n\u2212 2)-dimensional submanifold, rather than an (n \u2212 3)-dimensional submanifold. Finally, \u22c2m r=1 I(\u03c3ir , \u03c3jr) is not necessarily equal\nto the projection of \u22c2m\nr=1(Mir \u2229Mjr) to B. In other words, not every intersection in B lifts to an intersection of the manifolds {Mk}Nk=1 \u2286 B \u00d7 R. These are the main subtleties in the proof of Theorem 4.15.\nDefinition 4.7. Let S be an element of Ema , where E m a is defined as in (10). The set S is mreduced if it equals a set of the form Ia(\u03c3i1 , \u03c3j1)\u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3im , \u03c3jm), where i1 > i2 > \u00b7 \u00b7 \u00b7 > im and ir > jr for all r.\nFor example, if \u03c3i1 , \u03c3i2 , and \u03c3i3 are distinct simplices, then Ia(\u03c3i3 , \u03c3i2) \u2229 Ia(\u03c3i2 , \u03c3i1) is 2- reduced, but Ia(\u03c3i3 , \u03c3i1) \u2229 Ia(\u03c3i3 , \u03c3i2) \u2229 Ia(\u03c3i2 , \u03c3i1) is not 3-reduced. We define\nEma := {S \u2208 Ema | S is m-reduced} ,(12)\nEm,ka := {S \u2208 Em,ka | S is m-reduced} ,(13)\nwhere Ema is defined as in (10) and E m,k a is defined as in (11).\nLemma 4.8. For all m \u2265 1, all k, and all a \u2208 A, where A is defined as in (8), every S \u2208 Em,ka belongs to Em \u2032,k a for some m\u2032 \u2264 m, where Em,ka and E m\u2032,k a are defined as in (11) and (13), respectively.\nProof. We prove the lemma by induction on m. For all k, every S \u2208 E1,ka is 1-reduced by definition. Assume that Lemma 4.8 is true for m\u2212 1 \u2265 1, and let S be an element of Em,ka . The set S is equal to a set of the form\nIa(\u03c3i1 , \u03c3j1) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3im , \u03c3jm) ,\nwhere ir > jr for all r and k \u2265 i1 \u2265 i2 \u2265 \u00b7 \u00b7 \u00b7 \u2265 im without loss of generality. By the induction hypothesis,\nIa(\u03c3i2 , \u03c3j2) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3im , \u03c3jm) = Ia(\u03c3i\u20322 , \u03c3j\u20322) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3i\u2032\u2113 , \u03c3j\u2032\u2113)\nfor some \u2113 \u2264 m, where i\u2032r > j\u2032r for all r and k \u2265 i1 \u2265 i2 \u2265 i\u20322 > i\u20323 > \u00b7 \u00b7 \u00b7 > i\u2032\u2113. If i1 > i\u20322, then S is an element of E\u2113,k and we are done. Otherwise,\nIa(\u03c3i1 , \u03c3j1) \u2229 Ia(\u03c3i\u20322 , \u03c3j\u20322) = Ia(\u03c3i1 , \u03c3j1) \u2229 Ia(\u03c3j1 , \u03c3j\u20322)\nbecause i1 = i \u2032 2. If j1 = j \u2032 2, then\nS = Ia(\u03c3i1 , \u03c3j1) \u2229 Ia(\u03c3i\u20323 , \u03c3j\u20323) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3i\u2032\u2113 , \u03c3j\u2032\u2113) ,\nso S is (\u2113\u2212 1)-reduced. Otherwise, S = Ia(\u03c3i1 , \u03c3j1) \u2229 Ia(\u03c3j1 , \u03c3j\u20322) \u2229 Ia(\u03c3i\u20323 , \u03c3j\u20323) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3i\u2032\u2113 , \u03c3j\u2032\u2113) , where k \u2265 i1 > j1, j\u20322 and i1 > i\u2032r for all r \u2265 3. By the induction hypothesis, the set Ia(\u03c3j1 , \u03c3j\u20322)\u2229Ia(\u03c3i\u20323 , \u03c3j\u20323)\u2229\u00b7 \u00b7 \u00b7\u2229Ia(\u03c3i\u2032\u2113 , \u03c3j\u2032\u2113) belongs to E \u2113\u2032,k\u22121 a for some \u2113\u2032 \u2264 \u2113\u22121, so S belongs to E\u2113 \u2032+1,k a , where \u2113\u2032 + 1 \u2264 \u2113 \u2264 m. \u25a1\nLemma 4.9. For almost every a \u2208 A (where A is defined as in (8)), we have that Ma,i intersects Ma,j transversely\n3 for i \u0338= j and every S \u2208 Ema is either \u2205 or an (n\u2212m)-dimensional submanifold of B for all m \u2208 {1, . . . , n}, where Ma,i is defined as in (9) and Ema is defined as in (12).\nProof. Define gij(p) := f(\u03c3i, p)\u2212 f(\u03c3j, p) for all i \u0338= j. For almost every a \u2208 A, the quantity aj \u2212 ai is a regular value of gij by Sard\u2019s Theorem. The set of regular values is open for all i \u0338= j because gij is smooth and B is compact. Therefore, there is an \u03f5\u2217 such that for all i \u0338= j, every y \u2208 (aj \u2212 ai \u2212 2\u03f5\u2217, aj \u2212 ai + 2\u03f5\u2217) is a regular value of gij.\nGiven an a and \u03f5\u2217 as above, it suffices to show that for almost every \u03f5 \u2208 RN with |\u03f5i| \u2264 \u03f5\u2217, we have that every S \u2208 Ema+\u03f5 is an (n \u2212 m)-dimensional submanifold of B for all m. For m = 1, every element of E1a+\u03f5 is of the form Ia+\u03f5(\u03c3i, \u03c3j) for some i \u0338= j. The set Ia+\u03f5(\u03c3i, \u03c3j) is the (aj \u2212ai+ \u03f5j \u2212 \u03f5i)-level set of gij. Because (aj \u2212ai+ \u03f5j \u2212 \u03f5i) is a regular value of gij, the set Ia+\u03f5(\u03c3i, \u03c3j) is an (n\u2212 1)-dimensional submanifold of B and we must have Ma,i \u22d4 Ma,j.\nFor m \u2265 2, observe that\nEma = E m,2 a \u222a ( N\u22c3 k=3 Em,ka \\ Em,k\u22121a ) ,\nwhere Em,ka is defined as in (13). We induct on k \u2208 {2, . . . , N}, where N is the number of simplices in K. When k = 2, we have\nEm,2a+\u03f5 = { {Ia+\u03f5(\u03c31, \u03c32)} , m = 1 \u2205 , m \u2265 2 ,\nso every S \u2208 Em,2a+\u03f5 is either \u2205 or an (n \u2212 m)-dimensional submanifold of B. Now suppose that k > 2 and that every element of S \u2208 Em,k\u22121a+\u03f5 is either \u2205 or an (n \u2212 m)-dimensional submanifold for all m. Every element S in Em,ka+\u03f5 \\ E m,k\u22121 a+\u03f5 is equal to a set of the form\nS = Ia+\u03f5(\u03c3k, \u03c3\u2113) \u2229 S \u2032 ,\nwhere \u2113 \u2264 k \u2212 1 and S \u2032 \u2208 Em\u22121,k\u22121a+\u03f5 . We define the vectors \u03f5j := (0, . . . , 0, \u03f5j, 0, . . . , 0) and bj := a+\u03f5\u2212\u03f5j. Note that Ia+\u03f5(\u03c3k, \u03c3\u2113) = Ib+\u03f5k(\u03c3k, \u03c3\u2113) because bki + \u03f5ki = ai+ \u03f5i for all i, and Em\u22121,k\u22121a+\u03f5 = E m\u22121,k\u22121 bk because ai+\u03f5i = bi for all i \u2264 k\u22121. Therefore, every S \u2208 Em,ka+\u03f5\\E m,k\u22121 a+\u03f5 is equal to a set of the form S = Ibk+\u03f5k(\u03c3k, \u03c3\u2113) \u2229 S \u2032\nfor some S \u2032 \u2208 Em\u22121,k\u22121 bk and \u2113 \u2264 k\u22121. Because g\u2113k has no critical values between b\u2113\u2212 bk\u2212 \u03f5k and b\u2113\u2212bk, we have that Ibk+\u03f5k(\u03c3k, \u03c3\u2113) is diffeomorphic to Ibk(\u03c3k, \u03c3\u2113) for all \u03f5k \u2208 (\u2212\u03f5\u2217, \u03f5\u2217). In\n3When manifolds M1 and M2 intersect transversely, we will use the notation M1 \u22d4 M2.\nother words, Ibk+\u03f5k(\u03c3k, \u03c3\u2113) is a perturbation of Ibk(\u03c3k, \u03c3\u2113) for all \u03f5k \u2208 (\u2212\u03f5\u2217, \u03f5\u2217). By Thom\u2019s Transversality Theorem, Ibk+\u03f5k(\u03c3k, \u03c3\u2113) intersects every S \u2032 \u2208 Em\u22121,k\u22121 bk\ntransversely for almost every \u03f5k \u2208 (\u2212\u03f5\u2217, \u03f5\u2217). This shows that S is either \u2205 or an (n\u2212m)-dimensional submanifold of B for almost every \u03f5k \u2208 (\u03f5\u2217, \u03f5\u2217). Because there are finitely many elements in Em,ka , we must have that every S \u2208 Em,ka is either \u2205 or an (n\u2212m)-dimensional submanifold of B for almost every \u03f5k \u2208 (\u03f5\u2217, \u03f5\u2217). Induction on k concludes the proof. \u25a1\nLemma 4.10. For all a \u2208 A, with A defined as in (8), define\n(14) Bna := B B m a := \u22c3 \u2113\u2264m \u22c3 S\u2208En\u2212\u2113a S for m < n .\nIf a \u2208 A is such that every S \u2208 En\u2212\u2113a is either \u2205 or an \u2113-dimensional smooth submanifold for every \u2113 \u2208 {1, . . . , n}, where En\u2212\u2113a is defined as in (12), then Bma \\Bm\u22121a is the disjoint union of smooth m-dimensional manifolds.\nProof. We have that\nBma \\Bm\u22121a = \u22c3\nS\u2208En\u2212ma\n( S \\ \u22c3 S\u2032\u2208En\u2212\u2113a \u2113\u2264m\u22121 S \u2032 ) .\nIf S \u2032 \u2208 En\u2212\u2113a is a subset of S \u2208 En\u2212ma , then S \u2032 is a closed subset of S. Therefore, the set S \\ (\u22c3 S\u2032\u2208En\u2212\u2113a \u2113\u2264m\u22121 S \u2032 ) is an open subset of the smooth manifold S, which implies that\nS \\ (\u22c3\nS\u2032\u2208En\u2212\u2113a \u2113\u2264m\u22121\nS \u2032 ) is a smooth manifold. If S1 and S2 are distinct elements of En\u2212ma , then\n( S1 \\ \u22c3 S\u2032\u2208En\u2212\u2113a \u2113\u2264m\u22121 S \u2032 ) \u2229 ( S2 \\ \u22c3 S\u2032\u2208En\u2212\u2113a \u2113\u2264m\u22121 S \u2032 ) = \u2205 ,\nwhich completes the proof. \u25a1\nFor the remainder of Section 4.2, let {Bma }nm=0 be defined as in (14), and define\n(15) Ya = n\u22c3\nm=0\nYma ,\nwhere Yma is the set of connected components of Bma \\Bm\u22121a (with B\u22121a := \u2205).\nLemma 4.11. Let A be defined as in (8). If a \u2208 A is such that each Y \u2208 Ya is a manifold, then the simplex order induced by f is constant in each Y . That is, there is a strict partial order \u227aY on K such that \u227afa(\u00b7,y) is the same as \u227aY for all y \u2208 Y .\nProof. Let Y \u2208 Ya. The set Y is connected by definition. Because Y is a manifold, it is also path-connected. For each pair (\u03c3, \u03c4) of simplices, we have by construction that Y \u2229 Ia(\u03c3, \u03c4) equals either \u2205 or Y . (In fact, this statement holds for all a \u2208 A and does not require Y to be a manifold.) By Lemma 4.4, the simplex order is constant in Y . \u25a1\nLemma 4.12. For almost every a \u2208 A (where A is defined as in (8)), we have that\u22c2m r=1 Ia(\u03c3ir , \u03c3jr) is a submanifold of B and\n(16) Tp ( m\u22c2 r=1 Ia(\u03c3ir , \u03c3jr) ) = m\u22c2 r=1 Tp ( Ia(\u03c3ir , \u03c3jr) ) for all points p \u2208 \u22c2m r=1 Ia(\u03c3ir , \u03c3jr) and all sets {(ir, jr)}mr=1 of index pairs such that {ir, jr} =\u0338 {is, js} if r \u0338= s.\nProof. Because there are finitely many sets of index pairs, it suffices to fix a set {(ir, jr)}mr=1 of index pairs and show that (16) holds for all y \u2208 \u22c2m r=1 Ia(\u03c3ir , \u03c3jr) for almost every a \u2208 A.\nBy Lemmas 4.8 and 4.9, the set \u22c2m\nr=1 Ia(\u03c3ir , \u03c3jr) is a manifold for almost every a \u2208 A. By Lemma A.2, there is a finite open cover {Uk}Kk=1 of B such that for each k, there is a disjoint partition \u22c3 \u2113 J\u2113,k = {1, . . . ,m} such that {ir, jr | r \u2208 J\u21131,k} \u2229 {ir, jr | r \u2208 J\u21132,k} = \u2205 if \u21131 \u0338= \u21132 and\n\u03c0 ( \u22c2\nr\u2208J\u2113,k\n(Ma,ir \u2229Ma,jr) ) \u2229 Uk = \u22c2 r\u2208J\u2113,k Ia(\u03c3ir , \u03c3jr) \u2229 Uk\nfor all \u2113, where \u03c0 is the projection \u03c0 : B \u00d7 R \u2192 B.4 Because the number K of open sets is finite, it suffices to fix Uk and show that (16) holds for all p \u2208 \u22c2m r=1 Ia(\u03c3ir , \u03c3jr) \u2229 Uk for almost every a \u2208 A. By Lemma A.4, we have\nTp ( m\u22c2 r=1 Ia(\u03c3ir , \u03c3jr) ) = Tp (\u22c2 \u2113 \u22c2 r\u2208J\u2113,k Ia(\u03c3ir , \u03c3jr) ) = \u22c2 \u2113 Tp ( \u22c2 r\u2208J\u2113,k ( Ia(\u03c3ir , \u03c3jr) )) for all p \u2208\n\u22c2m r=1 Ia(\u03c3ir , \u03c3jr) \u2229 Uk for almost every a \u2208 A. By Lemma A.5, we have\u22c2\n\u2113\nTp ( \u22c2 r\u2208J\u2113,k ( Ia(\u03c3ir , \u03c3jr) )) = \u22c2 \u2113 \u22c2 r\u2208J\u2113,k Tp(Ia(\u03c3ir , \u03c3jr)\nfor all p \u2208 \u22c2m\nr=1 Ia(\u03c3ir , \u03c3jr) \u2229 Uk for almost every a \u2208 A. \u25a1 For any strict partial order \u227a on K, we define\nZ\u227aa :={p \u2208 B | fa(\u03c3, p) < fa(\u03c4, p) if \u03c3 \u227a \u03c4 and fa(\u03c3, p) = fa(\u03c4, p) if \u03c3 \u0338\u227a \u03c4 and \u03c4 \u0338\u227a \u03c3} .(17)\nThat is, Z\u227aa is the subset of B such that for all z in Z \u227a a , the strict partial order \u227afa(\u00b7,z) is the same as \u227a.\nLemma 4.13. Let A be defined as in (8). If a \u2208 A is such that (1) every Y \u2208 Ya is a manifold, where Ya is defined as in (15), (2) Ma,i \u22d4 Ma,j for all i \u0338= j, where Ma,i is defined as in (9), (3) \u22c2m r=1 Ia(\u03c3ir , \u03c3jr) is a manifold for all sets {(ir, jr}mr=1 of index pairs, and\n(4) Tp (\u22c2m r=1 Ia(\u03c3ir , \u03c3jr) ) = \u22c2m r=1 Tp ( Ia(\u03c3ir , \u03c3jr) ) for all sets {(ir, jr}mr=1 of index pairs\nand all p \u2208 \u22c2m\nr=1 Ia(\u03c3ir , \u03c3jr),\n4Recall that an arbitrary intersection \u22c2\nr Ia(\u03c3ir , \u03c3jr ) \u2286 B does not necessarily lift to an intersection\u22c2m r=1(Ma,i \u2229Ma,j) \u2286 B \u00d7R. Lemma A.2 says that in local neighborhoods U \u2286 B, we can partition the set\n{1, . . . ,m} into subsets J\u2113 such that the intersection \u22c2\nr\u2208J\u2113 Ia(\u03c3ir , \u03c3jr ) does lift to a subset of the intersection\u22c2 r\u2208J\u2113(Ma,i \u2229Ma,j).\nthen Ya is locally finite.\nProof. Let p be a point in B. There are finitely many strict partial orders \u227a1, . . . ,\u227ai on K. By Lemma A.6, we have that for each j \u2208 {1, . . . , i}, there is a subset Y\u227aja \u2286 Ya such that Z \u227aj a = \u22c3 Y \u2208Y \u227aj a Y . For each j, the point p has a neighborhood Uj that intersects at most one\nY \u2208 Y\u227aja by Lemma A.7. Therefore \u22c2i\nj=1 Uj is a neighborhood of p that intersects at most i elements of Ya. \u25a1\nLemma 4.14. Let A be defined as in (8). If a \u2208 A is such that (1) every S \u2208 En\u2212\u2113a is an \u2113-dimensional smooth submanifold for every \u2113 \u2208 {1, . . . , n},\nwhere En\u2212\u2113a is defined as in (12), (2) Ma,i \u22d4 Ma,j for all i \u0338= j, where Ma,i is defined as in (9), (3) \u22c2m i=r Ia(\u03c3ir , \u03c3jr) is a manifold for all sets {(ir, jr}mr=1 of index pairs, and\n(4) Tp (\u22c2m i=r Ia(\u03c3ir , \u03c3jr) ) = \u22c2m i=1 Tp ( Ia(\u03c3ir , \u03c3jr) ) for all sets {(ir, jr}mr=1 of index pairs\nand all p \u2208 \u22c2m\ni=r Ia(\u03c3ir , \u03c3jr),\nthen Ya satisfies the Axiom of the Frontier in Definition 4.1, where Ya is defined as in (15)\nProof. By Lemma 4.10, each Y \u2208 Ya is a manifold. Let Y\u03b1 be an element of Ya. It suffices to show that if Y\u03b2 \u0338= Y\u03b1 is another element of Ya and Y\u03b2 \u2229 \u2202Y\u03b1 \u0338= \u2205, where \u2202Y\u03b1 denotes the boundary of the manifold Y\u03b1, then Y\u03b2 \u2286 \u2202Y\u03b1.\nBy Lemma 4.11, the simplex order induced by f is constant on each Y , so there is a strict partial order \u227a\u03b1 on K such that \u227afa(\u00b7,y) is the same as \u227a\u03b1 for all y \u2208 Y\u03b1. Let Z\u227a\u03b1a be defined as in (17). By Lemma A.6, there is a subset Y\u227a\u03b1a \u2286 Ya such that Y\u03b1 \u2208 Y\u227a\u03b1a and Z\u227a\u03b1a = \u22c3 Y \u2208Y\u227a\u03b1a Y . We have \u2202Z \u227a\u03b1 a = \u22c3 Y \u2208Y\u227a\u03b1a \u2202Y because Ya is locally finite by Lemma 4.13. Therefore,\n(18) Y\u03b2 \u2229 \u2202Z\u227a\u03b1a = \u22c3\nY \u2208Y\u227a\u03b1a\n(Y\u03b2 \u2229 \u2202Y ) .\nBy Lemmas A.6 and A.8, we have that if Y \u2208 Ya intersects \u2202Z\u227a\u03b1a , then Y \u2286 \u2202Z\u227a\u03b1a . Therefore Y\u03b2 \u2286 \u2202Z\u227a\u03b1a because Y\u03b2 \u2229 \u2202Z\u227a\u03b1a contains Y\u03b2 \u2229 \u2202Y\u03b1 \u0338= \u2205. Together with (18), this shows that\n(19) Y\u03b2 = \u22c3\nY \u2208Y\u227a\u03b1a\n(Y\u03b2 \u2229 \u2202Y ) .\nBy Lemma A.7, every point in B has a neighborhood that intersects at most one Y \u2208 Y\u227a\u03b1a , so \u2202Y \u2032 \u2229 \u2202Y = \u2205 for all Y, Y \u2032 \u2208 Y\u227a\u03b1a such that Y \u0338= Y \u2032. Because Y\u03b2 is connected (by definition) and Y\u03b2 \u2229 \u2202Y\u03b1 \u0338= \u2205, we must have that Y\u03b2 \u2229 \u2202Y = \u2205 for all Y \u2208 Y\u227a\u03b1a such that Y \u0338= Y\u03b1. By (19),\nY\u03b2 = Y\u03b2 \u2229 \u2202Y\u03b1 \u2286 \u2202Y\u03b1 . \u25a1\nTheorem 4.15. Let B be a smooth compact n-dimensional manifold. For every a \u2208 A, define {Bma }nm=0 as in (14), with A defined as in (8). For almost every a \u2208 A, we have that {Bma }nm=0 is a stratification of B. In each stratum Y , the simplex order induced by fa is constant. (In other words, there is a strict partial order \u227aY on K such that \u227afa(\u00b7,y) is the same as \u227aY for all y \u2208 Y .) Consequently, the set {(\u03c3b, \u03c3d)} of (birth, death) simplex pairs is constant in each stratum Y and for any p \u2208 Y , the persistence diagram PD(fp) consists of the diagonal (with infinite multiplicity) and the multiset {(f(\u03c3b, p), f(\u03c3d, p))}.\nProof. By Lemmas 4.8, 4.9, 4.10, 4.12, 4.13, and 4.14, {Bma }nm=0 is a stratification of B for almost every a \u2208 A. By Lemma 4.11, the simplex order induced by fa is constant in each stratum Y \u2208 Ya whenever {Bma }nm=0 is a stratification of B. The last statement of Theorem 4.15 follows from Lemma 2.3. \u25a1"
        },
        {
            "heading": "5. Monodromy in PD Bundles",
            "text": "Definition 5.1 (Local section). Let (E,B, \u03c0) be a PD bundle. A local section is a continuous map s : U \u2192 E, where U is an open set in B and \u03c0 \u25e6 s(p) = p for all p \u2208 U .\nFor example, consider a vineyard, in which B is an interval I in R. Let (t0, T ) be an open interval in I. A local section in the vineyard is a map s : (t0, T ) \u2192 E that parameterizes an open subset of one of the vines (a curve in R3).\nDefinition 5.2 (Global section). Let (E,B, \u03c0) be a PD bundle. A global section is a continuous map s : B \u2192 E with \u03c0 \u25e6 s(p) = p for all p \u2208 B. In particular, a nontrivial global section is a global section s : B \u2192 E such that there exists a p\u2217 \u2208 B for which s(p\u2217) is not on the diagonal of PD(fp\u2217).\nIn a vineyard, every local section can be extended to a global section. In other words, we can trace out how the persistence of a single homology class changes over B = [t0, t1] \u2286 R, so there are individual \u201cvines\u201d in the vineyard. We will show that local sections of a PD bundle cannot necessarily be extended to global sections. Consequently, a PD bundle does not necessarily have a decomposition of the form (3); if it does, then each \u03b3 is a global section.\nProposition 5.3. There is a PD bundle (E,B, \u03c0) for which no nontrivial global sections exist.\nProof. The proof is constructive. Let K be the simplicial complex in Figure 4a, which has vertices 0, 1, 2, and 3. Let a be the edge with vertices (0, 1), let b be the edge with vertices (0, 2), let c be the triangle with vertices (0, 1, 2), and let d be the triangle with vertices (0, 2, 3).\nLet f : K\u00d7R2 \u2192 R be a continuous fibered filtration function that satisfies the following conditions:\nf(c, (x, y)), f(d, (x, y)) > f(a, (x, y)), f(b, (x, y)) > 0 for all (x, y) \u2208 R2 , f(a, (x, y)) > f(b, (x, y)) , y > 0 ,\nf(a, (x, y)) < f(b, (x, y)) , y < 0 ,\nf(c, (x, y)) > f(d, (x, y)) , x > 0 ,\nf(c, (x, y)) < f(d, (x, y)) , x < 0 ,\nf(\u03c3, (x, y)) = 0 , for all other \u03c3, for all x, y .\nThe conditions on the fibered filtration function f are illustrated in Figure 4b. These conditions imply that simplices a and b swap their order along the x-axis and the simplices c and d swap their order along the y-axis.\nIn Figure 4c, we list the (birth, death) simplex pairs for the 1D PH in each quadrant. In quadrants 1, 2, and 4, the simplex pairs are (a, c) and (b, d). In quadrant 3, the simplex pairs are (a, d) and (b, c).\nLet (E,R2, \u03c0) be the corresponding PD bundle, where E = {((x, y), z) | (x, y) \u2208 R2, z \u2208 PD1(f(\u00b7, (x, y)))} is the total space and \u03c0 is the projection to R2. We will show that (E,R2, \u03c0) has no nontrivial global sections.\nIf s : B \u2192 E is a global section and s(p\u2217) is on the diagonal of PD(f(\u00b7, p\u2217)) for some p\u2217 \u2208 B, then s is a trivial section because f(\u03c3b, p) \u0338= f(\u03c3d, p) for all p for any (birth, death) simplex pairs (\u03c3b, \u03c3d) at p. Therefore, if s : B \u2192 E is a nontrivial global section, s(p) is not on the diagonal of PD(f(\u00b7, p)) for any p \u2208 B. Suppose that \u03b3 : [0, 1] \u2192 E is a continuous path such that \u03b3(u) is not on the diagonal of PD(f(\u00b7, (x, y))) for any (x, y) \u2208 R2 and such that (20) \u03c0 \u25e6 \u03b3(u) = \u03b8(u) := (cos(2\u03c0u+ \u03c0/4), sin(2\u03c0u+ \u03c0/4)) \u2208 S1 . That is, \u03c0 \u25e6 \u03b3 is a parameterization of S1 that starts in the first quadrant of R2 at p0 = ( \u221a 2/2, \u221a 2/2). The path \u03b3 is determined uniquely by its initial condition \u03b3(0). The simplex\npairs in the first quadrant are (a, c) and (b, d), so \u03b3(0) equals either (p0, (f(a, p0), f(c, p0))) or (p0, (f(b, p0), f(d, p0))). In Figure 5, we illustrate the two possibilities for the path \u03b3. If \u03b3(0) = (p0, (f(a, p0), f(c, p0))), then \u03b3(1) = (p0, (f(b, p0), f(d, p0))); if \u03b3(0) = (p0, (f(b, p0), f(d, p0))), then \u03b3(1) = (p0, (f(a, p0), f(c, p0))). In either case, \u03b3(0) \u0338= \u03b3(1). To obtain a contradiction, suppose that there were a nontrivial global section s : R2 \u2192 E. Let \u03b3 : [0, 1] \u2192 E be the path \u03b3 = s \u25e6 \u03b8, where \u03b8 is the parameterization of S1 defined in (20). Then \u03b3(0) \u0338= \u03b3(1) because \u03b3 is a path satisfying (20), but \u03b3(0) = s(p0) = \u03b3(1). \u25a1\nNote that we will use the fibered filtration f : K \u00d7 R2 \u2192 R that was constructed in Proposition 5.3 as a running example throughout Section 6.2.\nRemark 5.4. Even when dim(B) = 1, it is not guaranteed that a nontrivial global section exists. To see this, consider the 1D PH of the fibered filtration function above restricted to S1 \u2286 R2. In this example, dim(B) = 1 and a nontrivial global section does not exist.\n\u03b3(u), which depend only on the choice of \u03b3(u0), are shown in red and blue, respectively. For each k, the red (respectively, blue) dot in the kth PD is equal to \u03b3(uk) when \u03b3(u0) is the red (respectively, blue) point in the 0th PD. Observe that \u03b3(u0) \u0338= \u03b3(u8) even though p0 = p8. The unlabeled PD at the origin is the PD for the origin in R2, at which there is a \u201csingularity.\u201d\nRemark 5.5. In the example of Proposition 5.3, it was the \u201csingularity\u201d (the point (0, 0) \u2208 R2 at which the PD had a point of multiplicity greater than one) that prevented the existence of a nontrivial global section. Restricting the PD bundle to B\u2032 := R2 \\ {(0, 0)} yields a true fiber bundle; each fiber is homeomorphic to the disjoint union of a line (the diagonal) and\ntwo points (the off-diagonal points). It is well known that fiber bundles over contractible spaces are trivial (i.e., the total space is homeomorphic to the product of the base and a fiber.) However, B\u2032 is not contractible, so our PD bundle restricted to B\u2032 is not guaranteed to be trivial. Indeed, what we showed in Proposition 5.3 is that it is not. By comparison to a vineyard,\n(1) Singularities do not occur for generic fibered filtrations f : K\u00d7R \u2192 R. A singularity occurs at p\u2217 \u2208 B when there are two (birth, death) simplex pairs (\u03c31b , \u03c31d), (\u03c32b , \u03c32d) at p\u2217 such that p\u2217 \u2208 I(\u03c31b , \u03c32b ) \u2229 I(\u03c31d, \u03c32d). When dim(B) = 1, the intersection I(\u03c31b , \u03c3 2 b ) \u2229 I(\u03c31d, \u03c32d) is empty in the generic case, so singularities do not typically\nexist when dim(B) = 1. (2) Even when singularities do occur in a vineyard, there should not be monodromy\nin the vineyard. As in the example above, we can remove the singularities from R to obtain a disjoint union of intervals B1, . . . , Bm such that when we restrict the vineyard to a Bi, we have a fiber bundle. Intervals in R are contractible, so these fiber bundles must be trivial. By continuity, we can glue together the fiber bundles over each Bi to see that our PD bundle cannot have monodromy."
        },
        {
            "heading": "6. A Compatible Cellular Sheaf",
            "text": "For a given fibered filtration function that induces a stratification of B as in Theorem 4.15, we construct a compatible cellular sheaf. We discuss a motivating example in Section 6.1, and give the definition in Section 6.2.\n6.1. A motivating example. Again consider the example in the proof of Proposition 5.3, and also again consider the path \u03b3 : [0, 1] \u2192 E that is determined uniquely by the choice of\n\u03b3(0) \u2208 {(p0, (f(a, p0), f(c, p0))), (p0, (f(b, p0), f(d, p0)))} ,\nwhere p0 = ( \u221a 2/2, \u221a 2/2). The two possibilities for the path \u03b3 are illustrated in Figure 5. For example, if \u03b3(0) = (p0, (f(a, p0), f(c, p0))), then\n\u03b3(u) =  ( \u03b8(u), (f(a, \u03b8(u)), f(c, \u03b8(u))) ) , u \u2208 [0, 1/8]( \u03b8(u), (f(a, \u03b8(u)), f(c, \u03b8(u))) ) , u \u2208 [1/8, 3/8]( \u03b8(u), (f(b, \u03b8(u)), f(c, \u03b8(u))) ) , u \u2208 [3/8, 5/8]( \u03b8(u), (f(b, \u03b8(u)), f(d, \u03b8(u))) ) , u \u2208 [5/8, 7/8]( \u03b8(u), (f(b, \u03b8(u)), f(d, \u03b8(u))) ) , u \u2208 [7/8, 1] ,\nwhere \u03b8(u) is the parameterization of S1 given by (20). As we move through the quadrants of R2, the point in the PD that represents the pair (a, c) in the first quadrant becomes the point that represents the pair (a, c) in the second quadrant, which becomes the point that represents the pair (b, c) in the third quadrant, which becomes the point that represents the pair (b, d) in the fourth quadrant, which becomes the point that represents the pair (b, d) in the first quadrant. One can do a similar analysis for the case in which \u03b3(0) = (p0, (f(b, p0), f(d, p0))). This analysis yields a bijection of the (birth, death) simplex pairs for any pair of adjacent\nquadrants. We illustrate the bijections in Figure 6. The bijection between the simplex pairs in a given quadrant and one of its adjacent quadrants is the same as the bijection defined by\nthe update rule of Cohen-Steiner et al. [14] for updating the simplex pairs in a vineyard. A combinatorial perspective on Proposition 5.3 is that there is no consistent way of choosing a simplex pair in each quadrant such that if (\u03c3b, \u03c3d) is the (birth, death) simplex pair chosen for a given quadrant and (\u03c4b, \u03c4d) is the (birth, death) simplex pair chosen for an adjacent quadrant, then (\u03c3b, \u03c3d) and (\u03c4b, \u03c4d) are matched in the bijection between the two quadrants. This is because if we choose an initial simplex pair in one of the quadrants and then walk in a circle through the other quadrants, then the simplex pair at which we finish is different from the initial simplex pair. For example, if we start at (a, c) in the first quadrant, then we finish at (b, d) when we return to the first quadrant, and vice versa. This is a discrete way of illustrating the non-existence of a nontrivial global section.\n6.2. Definition of a compatible cellular sheaf. I generalize the discussion in Section 6.1 to fibered filtration functions of the form f : K \u00d7 B \u2192 R that have a stratification (see Definition 4.1) of B such that in each stratum Y , the simplex order that is induced by f is constant. (In other words, there is a strict partial order \u227aY on K such that \u227af(\u00b7,y) is the same as \u227aY for all y \u2208 Y .) Theorem 4.15 guarantees that such a stratification exists for generic fibered filtration functions, and Proposition 4.5 guarantees that such a stratification exists for all piecewise-linear fibered filtration functions. We denote the set of strata by Y = {Y\u03b1}\u03b1\u2208J for some index set J .\nDefinition 6.1. Suppose that F is a Set-valued cellular sheaf whose cell complex, stalks, and morphisms are of the following form:\n(1) The cell complex: The cell complex on which F is constructed is the graph G such that there is a vertex v\u03b1 for each stratum Y\u03b1 \u2208 Y and an edge e\u03b2,\u03b1 = (v\u03b2, v\u03b1) if Y\u03b2 \u2208 Y is a face of Y\u03b1. The 0-cells of the cell complex are the vertices of G and the 1-cells are the edges of G.\n(2) The stalks: Let S\u03b1 denote the set of (birth, death) simplex pairs for a stratum Y\u03b1. The stalk at a 0-cell v\u03b1 \u2208 G is F(v\u03b1) := S\u03b1. For a 1-cell e\u03b2,\u03b1 \u2208 G, where Y\u03b2 is a face of Y\u03b1, the stalk at e\u03b2,\u03b1 is F(e\u03b2,\u03b1) := S\u03b1.\n(3) The morphisms: If Y\u03b2 \u2208 Y is a face of Y\u03b1 \u2208 Y , then the morphism Fv\u03b2\u2264e\u03b2,\u03b1 : F(v\u03b1) \u2192 F(e\u03b2,\u03b1) is the identity map and the morphism Fv\u03b2\u2264e\u03b2,\u03b1 : F(v\u03b2) \u2192 F(e\u03b2,\u03b1) is\nFv\u03b2\u2264e\u03b2,\u03b1 := \u03d5idx\u03b2 , idx\u03b1 , where \u03d5idx\u03b2 , idx\u03b1 is of the form in (4) and idx\u03b1 : K \u2192 {1, . . . , N} and idx\u03b2 : K \u2192 {1, . . . , N} are the simplex indexings (recall Definition 2.2) on Y\u03b1 and Y\u03b2, respectively. (Recall that by Lemma 4.11, the simplex order induced by f is constant within Y\u03b1 and within Y\u03b2.)\nThen the cellular sheaf F is a compatible cellular sheaf for the fibered filtration function f : K \u00d7B \u2192 R. It is not guaranteed that there is a unique compatible cellular sheaf for a given fibered\nfiltration function f . Although the cell complex (the graph G) is determined uniquely by f , the stalks and morphisms are not. Recall from Definition 2.2 that the simplex indexing that is induced by f may depend on an intrinsic indexing \u03c31, . . . , \u03c3N of the simplices in K. (The intrinsic indexing breaks ties when two simplices have the same filtration value.) For a stratum Y\u03b1 such that f(\u03c3, y) = f(\u03c4, y) for all y \u2208 Y\u03b1 for some pair (\u03c3, \u03c4) of simplices, the simplex indexing idxf(\u00b7,Y\u03b1) depends on the intrinsic indexing, so S\u03b1 may not be determined uniquely by f . If S\u03b1 is not determined uniquely by f , then for any face Y\u03b2 of Y\u03b1, the stalks F(v\u03b1) and F(e\u03b2,\u03b1) are not determined uniquely by f . As discussed in Remark 2.4, a bijection \u03d5idx\u03b2 ,idx\u03b1 of the form in (4) is not determined uniquely by f if idx\u03b2 and idx\u03b1 differ by more than the transposition of two consecutive simplices. Therefore, the morphism Fv\u03b2\u2264e\u03b2,\u03b1 is not necessarily determined uniquely by f .\nHowever, many aspects of the stalks and morphisms are determined uniquely by f . Suppose that Y\u03b2 \u2208 Y is a face of Y\u03b1 \u2208 Y . If f(\u03c3, y) \u0338= f(\u03c4, y) for all y in Y\u03b1 and all simplices \u03c3 \u0338= \u03c4 , then the simplex indexing idxf(\u00b7,Y\u03b1) is determined uniquely by f , so the stalks F(v\u03b1) and F(e\u03b2,\u03b1) are determined uniquely by f . Theorem 4.15 guarantees that this is the generic case when Y\u03b1 is an n-dimensional stratum (where n = dim(B)). There are also conditions under which a morphism is determined uniquely by f . The morphism Fv\u03b1\u2264e\u03b2,\u03b1 : S\u03b1 \u2192 S\u03b1 must be the identity map. The morphism Fv\u03b1\u2264e\u03b2,\u03b1 := \u03d5idx\u03b2 ,idx\u03b1 is determined uniquely by f when idx\u03b2 and idx\u03b1 differ by the transposition of two consecutive simplices. Theorem 4.15 guarantees that this is the generic case when Y\u03b2 is a \u201ctop-dimensional\u201d face of Y\u03b1 (i.e., when dim(Y\u03b2) = dim(Y\u03b1)\u2212 1). Example 6.2. Again consider a fibered filtration function f : K \u00d7 R2 \u2192 R of the form defined in Proposition 5.3, with K defined as in Figure 4a with N = 11 simplices. We construct a compatible cellular sheaf F as follows.\n(1) The cell complex: The strata are the open quadrants Q1, . . . , Q4, the open halfaxes A12, A23, A34, A14 with Aij = (\u2202Qi \u2229 \u2202Qj) \\ {0}, and the point 0 \u2208 R2. The\nassociated graph G (the cell complex for F) has a vertex vQi for the ith quadrant, a vertex vAij for the (i, j)th half-axis, and a vertex v0 for the point 0. The graph G has edges (vAij , vQi) and (vAij , vQj) for each half-axis Aij, and it has an edge (v0, v) for every vertex v \u2208 G such that v \u0338= v0.\n(2) The stalks: We index the simplices of K such that \u03c38 = a, \u03c39 = b, \u03c310 = c, and \u03c311 = d, where a, b, c, d are the simplices defined in Figure 4a. The stalk at vQ1 is SQ1 = {(a, c), (b, d)}. The vertices vQ2 and vA12 have the same stalk {(a, c), (b, d)}; the vertices vQ3 , vA23 , and v34 have the same stalk {(a, d), (b, c)}; and the vertices vQ4 and vA14 have the same stalk {(b, d), (a, c)}. The stalks at the edges of G are determined by the stalks at the vertices. In this example, the stalks at the vertices or edges that correspond to 2D strata are determined uniquely by f , but the stalks at the vertices and edges that correspond to 0D or 1D strata depend on our choice of intrinsic indexing.\n(3) The morphisms: There are only three distinct nonidentity morphisms. The first two are\nFvA23\u2264e(A23,Q2) , Fv0\u2264e(0,Q2) : {(a, c), (b, d)} \u2192 {(a, d), (b, c)} (a, c) 7\u2192 (b, c) (b, d) 7\u2192 (a, d) ,\nFvA34\u2264e(A34,Q4) , Fv0\u2264e(0,Q4) : {(a, d), (b, c)} \u2192 {(a, c), (b, d)} (a, d) 7\u2192 (a, c) (b, c) 7\u2192 (b, d) .\nThe third distinct nonidentity morphism is a map\nFv0\u2264e(0,Q1) : {(a, d), (b, c)} \u2192 {(a, c), (b, d)} .\nAs we move from 0 to Q1, we swap the simplex indices of a and b and we also swap the simplex indices of c and d (in the simplex indexing induced by f). The morphism is not canonical because the bijection \u03d5idx0,idxQ1 depends on whether one first swaps a and b or one first swaps c and d. Therefore, we may define either\nFv0\u2264e(0,Q1) : (a, d) 7\u2192 (a, c) , (b, c) 7\u2192 (b, d)\nor\nFv0\u2264e(0,Q1) : (a, d) 7\u2192 (b, d) , (b, c) 7\u2192 (a, c) .\nBoth choices results in a compatible cellular sheaf.\n6.3. Sections of the cellular sheaf. Let F be any compatible cellular sheaf for a fibered filtration f : K \u00d7B \u2192 R. We write\n(21) Fv\u03b2\u2264e\u03b2,\u03b1 = ( F bv\u03b2\u2264e\u03b2,\u03b1 , F d v\u03b2\u2264e\u03b2,\u03b1 ) ,\nwhere F bv\u03b2\u2264e\u03b2,\u03b1 : S\u03b2 \u2192 S\u03b1 maps a pair (\u03c3b, \u03c3d) \u2208 S\u03b2 to the birth simplex of Fv\u03b2\u2264e\u03b2,\u03b1((\u03c3b, \u03c3d)) and Fdv\u03b2\u2264e\u03b2,\u03b1 : S\u03b2 \u2192 S\u03b1 maps (\u03c3b, \u03c3d) \u2208 S\u03b2 to the death simplex of Fv\u03b2\u2264e\u03b2,\u03b1((\u03c3b, \u03c3d)). (Recall that S\u03b1, S\u03b2 are the stalks at the vertices v\u03b1, v\u03b2 that are associated with the strata Y\u03b1, Y\u03b2.) In this subsection, we show that one can view sections of F as sections of the associated\nPD bundle.\nLemma 6.3. Let Y\u03b2 be a face of Y\u03b1. Assume that f : K\u00d7B \u2192 R is continuous (i.e., f(\u03c3, \u00b7) is continuous for all simplices \u03c3 in K). Then for any point p \u2208 Y\u03b2 and any pair (\u03c3b, \u03c3d) in F(v\u03b2), we have\n(22) ( f(\u03c3b, p), f(\u03c3d, p) ) = ( f(F bv\u03b2\u2264e\u03b2,\u03b1((\u03c3b, \u03c3d)), p) , f(F d v\u03b2\u2264e\u03b2,\u03b1((\u03c3b, \u03c3d)), p) ) ,\nwhere F b and Fd are defined as in (21).\nProof. If the simplex orders in Y\u03b1 and Y\u03b2 differ only by a transposition of simplices (\u03c3, \u03c4) with consecutive indices in the orderings, then we must have f(\u03c3, p) = f(\u03c4, p) for all p \u2208 Y\u03b2 because f is continuous and Y\u03b2 \u2286 Y\u03b1. By definition, Fv\u03b2\u2264e\u03b2,\u03b1 is either the identity map or the map that swaps \u03c3 and \u03c4 in the pairs that contain them. In either case, (22) holds because f(\u03c3, p) = f(\u03c4, p) for all p \u2208 Y\u03b2. Equation (22) holds in general because Fv\u03b2\u2264e\u03b2,\u03b1 is defined as the composition of such maps. \u25a1\nThe following proposition says that a global section of a compatible cellular sheaf F corresponds to a global section of the PD bundle.\nProposition 6.4. Let z0 be a non-diagonal point in PDq(fp0) for some p0 \u2208 B, let (\u03c3b, \u03c3d) be the (birth, death) simplex pair such that z0 = (f(\u03c3b, p0), f(\u03c3d, p0)), and let Y0 be the stratum that contains p0. Suppose that F is a compatible cellular sheaf, and let v0 be the vertex in the graph G (see Definition 6.1) that is associated with Y0. If there is a global section s of the cellular sheaf F such that s(v0) = (\u03c3b, \u03c3d), then there is a global section s of the PD bundle such that s(p0) = z0.\nProof. Let s be a global section of the cellular sheaf F such that s(v0) = (\u03c3b, \u03c3d). For every stratum Y\u03b1, we write\ns(v\u03b1) = (sb(v\u03b1), sd(v\u03b1)) ,\nwhere sb(v\u03b1) is the birth simplex of s(v\u03b1) and sd(v\u03b1) is the death simplex of s(v\u03b1). Let Y : B \u2192 {Y\u03b1} be the function that maps p \u2208 B to the unique stratum Y\u03b1 that contains it. We define s : B \u2192 E to be the function\ns(p) := ( p, f(sb(vY (p)), p), f(sd(vY (p)), p) ) .\nTo show that s : B \u2192 E is a global section of the PD bundle, it remains to show that it is continuous. The function s|Y\u03b1 is continuous for all strata Y\u03b1 because f(\u03c3, \u00b7) is continuous for all simplices \u03c3 \u2208 K. Therefore, it suffices to show that s|Y\u03b1 is continuous on each face Y\u03b2 of Y\u03b1. Because s is a section of the cellular sheaf,\ns(v\u03b1) = Fv\u03b2\u2264e\u03b2,\u03b1(s(v\u03b2)) .\nBy Lemma 6.3,( f(sb(v\u03b2), p), f(sd(v\u03b2), p) ) = ( f(F bv\u03b2\u2264e\u03b2,\u03b1(s(v\u03b2)), p), f(F d v\u03b2\u2264e\u03b2,\u03b1(s(v\u03b2)), p) )\nfor all points p \u2208 Y\u03b2. Therefore,( f(sb(v\u03b2), p), f(sd(v\u03b2), p) ) = ( f(sb(v\u03b1), p), f(sd(v\u03b1), p) ) for all p \u2208 Y\u03b2, which completes the proof. \u25a1"
        },
        {
            "heading": "7. Conclusions",
            "text": "7.1. Summary. In this paper, I introduced the concept of a persistence diagram (PD) bundle, a framework that can be used to study the persistent homology of a fibered filtration function (i.e., set of filtrations parameterized by an arbitrary \u201cbase space\u201d B). Special cases of PD bundles include vineyards [14], the persistent homology transform (PHT) [32], the fibered barcode of a multiparameter persistence module [4], and the barcode-decorated merge tree [17].\nIn Theorem 4.15, I proved that if B is a smooth compact manifold, then for generic fibered filtrations, B is stratified so that the simplex order is constant within each stratum. When such a stratification exists, the PD bundle is determined by the PDs at a locally finite (or finite, if B is compact) subset of points in B. In Proposition 4.5, I showed that every piecewise-linear PD bundle has such a stratification into polyhedra. This polyhedral stratification is utilized in [23] in an algorithm for computing piecewise-linear PD bundles.\nI showed that, unlike vineyards, which PD bundles generalize, not every local section of a PD bundle can be extended to a global section (see Proposition 5.3). The implication is that PD bundles do not necessarily decompose into \u201cvines\u201d in the way that vineyards do (see (3)).\nLastly, I introduced a cellular sheaf that is compatible with a given PD bundle. In Proposition 6.4, I proved that one can determine whether a local section can be extended to a global section by determining whether or not there is an associated global section of a compatible cellular sheaf. A compatible cellular sheaf is a discrete mathematical data structure for summarizing the data in a PD bundle.\n7.2. Discussion. For a given fibered filtration function f with a stratification as in Theorem 4.15, I defined a compatible cellular sheaf F over a graph G. It is tempting to instead define an associated cellular sheaf directly on the stratification of B. In particular, when f is piecewise linear, the strata are polyhedra, so the stratification is guaranteed to be a cellular decomposition. One could certainly define stalks F(Y\u03b1) and functions F(Y\u03b2) \u2192 F(Y\u03b2) in the same way as in Definition 6.1. The problem is that F would not necessarily satisfy the composition condition (see (5)). For instance, this issue occurs in Example 6.2 for the same reason that the morphism Fv0\u2264e(0,Q1) in the example is not canonical (see the discussion in Example 6.2).\nAdditionally, I note that one could have defined a compatible cellular cosheaf rather than a sheaf.\n7.3. Future research. I conclude with some questions and proposals for future work:\n\u2022 What are the conditions under which a PD bundle must have a decomposition of the form (3)?\nI conjecture that if B \\ B\u2217 is contractible, where B\u2217 is the set of singularities (i.e., points p\u2217 \u2208 B at which there is a point in PD(fp\u2217) with multiplicity greater than\none), then there is a decomposition of the form (3). See the discussion in Remark 5.5.\n\u2022 What algebraic or computational methods can we use to analyze global sections and to compute obstructions to the existence of global sections?\nIt may help to consider the cellular-sheaf perspective from Section 6.2, which turns the question into a discrete problem that one can study computationally. One can also generalize Turner\u2019s vineyard-module perspective [33].\n\u2022 PHT is a PD bundle over the base space B = Sn. Are there constructible sets M \u2286 Rn+1 for which the associated PHT exhibits monodromy? What is the geometric interpretation (in terms of M)?\n\u2022 Arya et al. [5] showed that the PHT of a constructible set M can be calculated by \u201cgluing together\u201d the PHT of smaller, simpler subsets of M . Can one generalize these results to all PD bundles?\n\u2022 When are PD bundles \u201cstable\u201d?\nPD bundles are \u201cfiberwise stable\u201d in the sense that if f1, f2 : K \u00d7 B \u2192 R are two fibered filtrations, then the bottleneck distance between PD(f1(\u00b7, p)) and PD(f2(\u00b7, p)) is bounded above by \u2225f1 \u2212 f2\u2225\u221e for all p \u2208 B [13]. However, this does not guarantee that the global structure of a PD bundle is stable. For example, it is well known that the structure of a vineyard is not stable (see Appendix A.1 for an example). However, vineyards are stable for generic 1-parameter filtrations; if none of the vines intersect (which is the generic case), then sufficiently small perturbations of the filtration result in small perturbations of each vine in the vine decomposition (see (3)). I expect that an analogous result holds for generic fibered filtration functions over any base space B.\n\u2022 It will also be interesting to study real-world applications of PD bundles, such as the examples that were mentioned in Section 3.1."
        },
        {
            "heading": "Acknowledgements",
            "text": "I am very grateful for discussions with Andrew Blumberg, which led to the investigation of monodromy in PD bundles. I also thank Ryan Grady and Karthik Viswanathan for helpful discussions.\nAppendix\nA.1. Vineyard instability. For any \u03f5 > 0, we construct two 1-parameter filtration functions f+\u03f5 , f \u2212 \u03f5 that are \u03f5-perturbations of each other (that is, |f+\u03f5 (\u03c3, p)\u2212 f\u2212\u03f5 (\u03c3, p)| < \u03f5 for all simplices \u03c3 \u2208 K and all points p \u2208 B) but such that for any bijection between the vines in the respective vineyards, not all of the matched vines are close to each other. In fact, we can define f+\u03f5 and f \u2212 \u03f5 so that their vines are arbitrarily far apart.\nWe construct our example by restricting the filtration function from Section 5 to certain paths through R2. Let K and f : K\u00d7R2 \u2192 R be defined as in the proof of Proposition 5.3. (See Figure 4b.) Because f is continuous, we have that for any \u03f5 > 0, there is a \u03b4 > 0 such\nthat |f(\u03c3, p) \u2212 f(\u03c3,0)| < \u03f5/2 when \u2225p\u2225 < \u221a 2\u03b4 and \u03c3 is any simplex in K. We define the\npaths\n\u03b3+\u03f5 (t) :=  (t, t) , |t| \u2265 \u03b4 (\u2212\u03b4, \u03b4 + 2t) , \u2212\u03b4 < t < 0 (\u2212\u03b4 + 2t, \u03b4) , 0 \u2264 t < \u03b4 ,\n\u03b3\u2212\u03f5 (t) :=  (t, t) , |t| \u2265 \u03b4 (\u03b4 + 2t,\u2212\u03b4) , \u2212\u03b4 < t < 0 (\u03b4,\u2212\u03b4 + 2t) , 0 \u2264 t < \u03b4 .\nSee Figure 7 for a plot of the paths \u03b3\u00b1\u03f5 (t). Let f\u00b1\u03f5 : K \u00d7 R \u2192 R be the 1-parameter filtration functions defined by f\u00b1(\u03c3, t) := f(\u03c3, \u03b3\u00b1\u03f5 (t)). By construction, the filtrations f + \u03f5 and f \u2212 \u03f5 are \u03f5-perturbations of each other.\nLet V + and V \u2212 be the vineyards for f+\u03f5 and f \u2212 \u03f5 , respectively, for the 1st degree PH. The\nvineyards V \u00b1 each have two vines v\u00b11 , v \u00b1 2 , which are paths v \u00b1 i : R \u2192 R3. The vines are\nv+1 (t) = { (f(a, \u03b3+(t)), f(d, \u03b3+(t))) , t \u2264 \u2212\u03b4/2 f(b, \u03b3+(t)), f(d, \u03b3+(t))) , t > \u2212\u03b4/2 ,\nv+2 (t) = { (f(b, \u03b3+(t)), f(c, \u03b3+(t))) , t \u2264 \u2212\u03b4/2 f(a, \u03b3+(t)), f(c, \u03b3+(t))) , t > \u2212\u03b4/2 ,\nv\u22121 (t) = { (f(a, \u03b3\u2212(t)), f(d, \u03b3\u2212(t))) , t \u2264 \u2212\u03b4/2 f(a, \u03b3\u2212(t)), f(c, \u03b3\u2212(t))) , t > \u2212\u03b4/2 ,\nv\u22122 (t) = { (f(b, \u03b3\u2212(t)), f(c, \u03b3\u2212(t))) , t \u2264 \u2212\u03b4/2 f(b, \u03b3\u2212(t)), f(d, \u03b3\u2212(t))) , t > \u2212\u03b4/2 .\nThere is no bijection \u03d5 : {1, 2} \u2192 {1, 2} such that v+1 and v+2 are close to v\u2212\u03d5(1) and v \u2212 \u03d5(2),\nrespectively. This is because\n\u2225v+1 (t)\u2212 v\u22121 (t)\u22252 = |f(b, (t, t))\u2212 f(a, (t, t))|2 + |f(d, (t, t)))\u2212 f(c, (t, t))|2 , t > \u2212\u03b4/2 , \u2225v+1 (t)\u2212 v\u22122 (t)\u22252 = |f(b, (t, t))\u2212 f(a, (t, t))|2 + |f(d, (t, t)))\u2212 f(c, (t, t))|2 , t \u2264 \u2212\u03b4/2 , \u2225v+2 (t)\u2212 v\u22122 (t)\u22252 = |f(b, (t, t))\u2212 f(a, (t, t))|2 + |f(d, (t, t)))\u2212 f(c, (t, t))|2 , t > \u2212\u03b4/2 , \u2225v+2 (t)\u2212 v\u22121 (t)\u22252 = |f(b, (t, t))\u2212 f(a, (t, t))|2 + |f(d, (t, t)))\u2212 f(c, (t, t))|2 , t \u2264 \u2212\u03b4/2\nand we can define f so that |f(b, (t, t))\u2212f(a, (t, t))| and |f(d, (t, t))\u2212f(c, (t, t))| are arbitrarily large for t \u0338= 0.\nA.2. Technical Details of Section 4. All notation is defined as in Section 4. The first series of lemmas is used to prove Lemma 4.12, which shows that for almost every a \u2208 A, the tangent space of the intersection of sets Ia(\u03c3ir , \u03c3jr) is equal to the intersection of their tangent spaces.\nLemma A.1. For almost every a \u2208 A, we have\nTp (\u22c2 j\u2208J Ma,j ) = \u22c2 j\u2208J Tp(Ma,j)\nfor all J \u2286 {1, . . . , N} and all p \u2208 \u22c2\nj\u2208J Ma,j.\nProof. Because there are finitely many subsets of {1, . . . , N}, it suffices to show that for a given J \u2286 {1, . . . , N}, we have Tp (\u22c2 j\u2208J Ma,j ) = \u22c2 j\u2208J Tp(Ma,j) for all p \u2208 \u22c2 j\u2208J Ma,j for almost every a \u2208 A. Let {ji}ki=1 be the elements of J , where ji < ji+1 for all i. Because transverse intersections are generic, we have Ma,ji \u22d4 (Ma,j1 \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ma,ji\u22121) for every i for almost every a \u2208 A. For such an a \u2208 A, we have\nTp (\u22c2 j\u2208J Ma,j ) = Tp(Ma,jk) \u2229 Tp ( k\u22121\u22c2 i=1 Ma,ji ) because Ma,jk \u22d4 (Ma,j1 \u2229 \u00b7 \u00b7 \u00b7 \u2229Ma,jk\u22121). Therefore,\nTp (\u22c2 j\u2208J Ma,j ) = k\u22c2 i=1 Tp(Ma,ji)\nby induction on i. \u25a1\nLemma A.2. Let a \u2208 A, and let {(ir, jr)}mr=1 be a set of index pairs such that {ir, jr} \u0338= {is, js} if r \u0338= s. If B is a compact manifold, then there is a finite open cover {Uk}Kk=1 and a disjoint partition \u22c3 \u2113 J\u2113,k = {1, . . . ,m} for each k such that\n{ir, jr | r \u2208 J\u21131,k} \u2229 {ir, jr | r \u2208 J\u21132,k} = \u2205\nif \u21131 \u0338= \u21132 and \u03c0 ( \u22c2\nr\u2208J\u2113,k\n(Ma,ir \u2229Ma,jr) ) \u2229 Uk = \u22c2 r\u2208J\u2113,k Ia(\u03c3ir , \u03c3jr) \u2229 Uk\nfor all \u2113, where \u03c0 is the projection \u03c0 : B \u00d7 R \u2192 B."
        },
        {
            "heading": "32 ABIGAIL HICKOK",
            "text": "Proof. Suppose that y \u2208 \u22c2m\nr=1 Ia(\u03c3ir , \u03c3jr). Let J 0 \u2113 := {\u2113} be an initial disjoint partition of\n{1, . . . ,m}. By definition, \u03c0(Ma,i\u2113 \u2229Ma,j\u2113) = Ia(\u03c3i\u2113 , \u03c3j\u2113). If i\u21131 = i\u21132 for some \u21131 \u0338= \u21132, then f(\u03c3j\u21131 , y) = f(\u03c3i\u21131 , y) = f(\u03c3j\u21132 , y), so y \u2208 \u03c0(Ma,i\u21131 \u2229Ma,j\u21131 \u2229Ma,i\u21132 \u2229Ma,j\u21132 ). We combine J0\u21131 and J 0 \u21132\ninto a single subset of the partition, and we iterate until we obtain a disjoint partition {J\u2113,y}\u2113 of {1, . . . ,m} such that\n{ir, jr | r \u2208 J\u21131,y} \u2229 {ir, jr | r \u2208 J\u21132,y} = \u2205\nif \u21131 \u0338= \u21132 and y \u2208 \u03c0 ( \u22c2 r\u2208J\u2113,y (Ma,ir \u2229Ma,jr) )\nfor all \u2113. Therefore, for each \u2113, there is a neighborhood U\u2113,y such that \u03c0 ( \u22c2\nr\u2208J\u2113,y\n(Ma,ir \u2229Ma,jr) ) \u2229 U\u2113,y = \u22c2 r\u2208J\u2113,y Ia(\u03c3ir , \u03c3jr) \u2229 U\u2113,k .\nSet Uy := \u22c2\n\u2113 U\u2113,y. Because B is compact, there is a finite open cover {Uk}Kk=1, which has the desired properties by construction. \u25a1\nThe following lemma will be repeatedly used in Lemma A.4.\nLemma A.3. Suppose that g : B \u2192 R is a smooth map and y \u2208 R is a regular value with preimage Zy. If Z \u2286 B is a submanifold such that Z \u22d4 Zy, then y is a regular value of g|Z : Z \u2192 R.\nProof. At any z \u2208 Zy, we have ker(dgz) = TzZy. Therefore, if z \u2208 Z\u2229Zy, then TzZ \u2286 ker(dgz) only if TzZ \u2286 TzZy. Because y is a regular value of g : B \u2192 R, we have\ndim(Tz(Zy)) = dimB \u2212 1 ,\nso Tz(Zy) is a strict subset of TzB. Because Z \u22d4 Zy, we have\nTzZ + TzZy = TzB ,\nso TzZ cannot be a subset of TzZy. Therefore, TzZ is not a subset of ker(dgz). This implies that dgz|TzZ is a surjection because dimR = 1. Therefore, y is a regular value of g|Z . \u25a1\nLemma A.4. Let {(ir, jr)}mr=1 be a set of index pairs such that {ir, jr} =\u0338 {is, js} if r \u0338= s. For almost every a \u2208 A, we have that if\n(1) \u22c3\n\u2113 J\u2113 = {1, . . . ,m} is a disjoint partition with\n{ir, jr | r \u2208 J\u21131} \u2229 {ir, jr | r \u2208 J\u21132} = \u2205\nfor \u21131 \u0338= \u21132 and (2) U is an open set in B such that\n(23) \u03c0 ( \u22c2\nr\u2208J\u2113\n(Ma,ir \u2229Ma,jr) ) \u2229 U = \u22c2 r\u2208J\u2113 Ia(\u03c3ir , \u03c3jr) \u2229 U ,\nfor all \u2113, where \u03c0 is the projection \u03c0 : B \u00d7 R \u2192 B, then\n(1) the set \u22c2\nr\u2208J \u2032 Ia(\u03c3ir , \u03c3jr) is a manifold for every J \u2032 \u2286 {1, . . . ,m} and\n(2) we have\n(24) Ty (\u22c2 \u2113 \u22c2 r\u2208J\u2113 Ia(\u03c3ir , \u03c3jr) ) = \u22c2 \u2113 Ty ( \u22c2 r\u2208J\u2113 Ia(\u03c3ir , \u03c3jr) )\nfor every y \u2208 \u22c2m\nr=1 Ia(\u03c3ir , \u03c3jr) \u2229 U .\nProof. It suffices to show that (25) ( \u22c2\nr\u2208J\u2113\nIa(\u03c3ir , \u03c3jr) \u2229 U ) \u22d4 ( \u22c2\n\u2113\u2032<\u2113 \u22c2 r\u2208J\u2113 Ia(\u03c3ir , \u03c3jr) \u2229 U )\nfor all \u2113 and almost every a \u2208 A. Informally, what we show first is that at almost every a \u2208 A, perturbations of a produce perturbations of \u22c2 r\u2208J\u2113 Ia(\u03c3ir , \u03c3jr) \u2229 U for each \u2113. Then at the end of the proof, we apply the fact that transverse intersections are generic. By Lemmas 4.8 and 4.9, we may assume that \u22c2 r\u2208J \u2032 Ia(\u03c3ir , \u03c3jr) is a manifold for every J \u2032 \u2286 {1, . . . ,m}. By (23), we may assume without loss of generality that there is a sequence k1 < \u00b7 \u00b7 \u00b7 < kc such that j1 = k1 and ir = jr\u22121 for all r and jr+1 = ir for all r. In other words, we may assume that \u22c2 r\u2208J\u2113 Ia(\u03c3ir , \u03c3jr) is of the form\nIa(\u03c3kc , \u03c3kc\u22121) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3k3 , \u03c3k2) \u2229 Ia(\u03c3k2 , \u03c3k1)\nfor all a. The idea is that because the intersection lifts to an intersection of the corresponding manifolds (see (23)), we can pair up the indices however we like.\nDefine the function gi : B \u2192 R by\ngi(p) := f(\u03c3ki , p)\u2212 f(\u03c3ki\u22121 , p) .\nFor almost every a \u2208 A, the quantity aki \u2212 aki\u22121 is a regular value of gi for all i, and the set of regular values is open. By the same argument as in the proof of Lemma 4.9, we have(\nIa(\u03c3kc , \u03c3kc\u22121) \u2229 U ) \u22d4 ( c\u22121\u22c2\ni=2\nIa(\u03c3ki , \u03c3ki\u22121) \u2229 U )\nfor almost every a \u2208 A. Therefore, (akc \u2212 akc\u22121) is a regular value of gkc |\u22c2c\u22121 i=2 Ia(\u03c3ki ,\u03c3ki\u22121 )\u2229U by Lemma A.3. Additionally, for \u03f5 \u2208 RN such that \u03f5kc and \u03f5kc\u22121 are sufficiently small, there are no critical values between (akc \u2212 akc\u22121) and (akc \u2212 akc\u22121 + \u03f5kc \u2212 \u03f5kc\u22121). Because there are no critical values, the set \u22c2 r\u2208J\u2113 Ia(\u03c3ir , \u03c3jr) \u2229 U (which is the (akc \u2212 akc\u22121)-level\nset of gk|\u22c2c\u22121 i=2 Ia(\u03c3ki ,\u03c3ki\u22121 )\u2229U ) is a submanifold of B that is diffeomorphic to Ia+\u03f5(\u03c3kc , \u03c3kc\u22121) \u2229(\u22c2c\u22121 i=2 Ia(\u03c3ki , \u03c3ki\u22121) ) \u2229U (which is the (akc\u2212akc\u22121+\u03f5kc\u2212\u03f5kc\u22121)-level set of gk|\u22c2c\u22121\ni=2 Ia(\u03c3ki ,\u03c3ki\u22121 )\u2229U ),\nand these submanifolds are smoothly parameterized by \u03f5kc , \u03f5kc\u22121 . Now consider any i\u2217 \u2208 {2, . . . , c\u2212 1}. By induction on i\u2217, we will show that there is a set A\u2032 \u2286 A such that A \\ A\u2032 has measure zero and such that for all a \u2208 A\u2032, we have that (1) the set\n\u22c2 r\u2208J\u2113 Ia+\u03f5(\u03c3ir , \u03c3jr) \u2229 U is a submanifold of B that is diffeomorphic to\u22c2\nr\u2208J\u2113\nIa(\u03c3ir , \u03c3jr) \u2229 U\nfor sufficiently small \u03f5 \u2208 RN , and (2) these submanifolds are smoothly parameterized by \u03f5.\nBecause (aki\u2217 \u2212 aki\u2217\u22121) is a regular value of gi\u2217 and the set of regular values is open, there are no critical values between (aki\u2217 \u2212 aki\u2217\u22121) and (aki\u2217 \u2212 aki\u2217\u22121 \u2212 \u03f5ki\u2217\u22121) for sufficiently small \u03f5ki\u2217\u22121 . Therefore, for sufficiently small \u03f5ki\u2217\u22121 , the (aki\u2217 \u2212 aki\u2217\u22121 \u2212 \u03f5ki\u2217\u22121)-level set of gi\u2217 is a submanifold of B that is diffeomorphic to the (aki\u2217 \u2212aki\u2217\u22121)-level set, and these submanifolds are smoothly parameterized by (sufficiently small) \u03f5ki\u2217\u22121 . Because transverse intersections are generic, ( c\u22c2\ni=i\u2217+1\nIa+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 ( i\u2217\u22121\u22c2\ni=2\nIa+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 U\nis transverse to the (aki\u2217 \u2212 aki\u2217\u22121 \u2212 \u03f5ki\u2217\u22121)-level set of gi\u2217 for almost every (sufficiently small) \u03f5ki\u2217\u22121 . Additionally, if the intersection is transverse, it is transverse for an open neighborhood of \u03f5ki\u2217\u22121 . Therefore, we can assume without loss of generality that this intersection is transverse at \u03f5ki\u2217\u22121 = 0 (if not, we can perturb aki\u2217\u22121 so that it is) and for all sufficiently small \u03f5ki\u2217\u22121 . This implies that (aki\u2217 \u2212 aki\u2217\u22121 \u2212 \u03f5ki\u2217\u22121) is also a regular value of gi\u2217 restricted to (\u22c2c i=i\u2217+1 Ia+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 (\u22c2i\u2217\u22121 i=2 Ia+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 U , by Lemma A.3. For sufficiently small \u03f5ki\u2217 , there are no critical values between (aki\u2217 \u2212 aki\u2217\u22121 \u2212 \u03f5ki\u2217\u22121) and (aki\u2217 \u2212 aki\u2217\u22121 + \u03f5ki\u2217 \u2212 \u03f5ki\u2217\u22121). Therefore, for sufficiently small \u03f5ki\u2217 , \u03f5ki\u2217\u22121 , we have that( c\u22c2\ni=i\u2217+1\nIa+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 ( i\u2217\u22c2\ni=2\nIa+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 U ,\nwhich is the (aki\u2217 \u2212 aki\u2217\u22121)-level set of gi\u2217 restricted to( c\u22c2 i=i\u2217+1 Ia+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 ( i\u2217\u22121\u22c2 i=2 Ia+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 U ,\nis a submanifold of B that is diffeomorphic to( c\u22c2 i=i\u2217 Ia+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 ( i\u2217\u22121\u22c2 i=2 Ia+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 U ,\nwhich is the (aki\u2217 \u2212 aki\u2217\u22121 + \u03f5ki\u2217 \u2212 \u03f5ki\u2217\u22121)-level set of gi\u2217 restricted to( c\u22c2 i=i\u2217+1 Ia+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 ( i\u2217\u22121\u22c2 i=2 Ia+\u03f5(\u03c3ki , \u03c3ki\u22121) ) \u2229 U .\nThese submanifolds are smoothly parameterized by \u03f5ki\u2217 and \u03f5ki\u2217+1 . This concludes the inductive step.\nLet a \u2208 A\u2032, where A\u2032 is defined as it was earlier in the proof. We showed above that for sufficiently small \u03f5 \u2208 RN , the set of manifolds \u22c2 r\u2208\u2113 Ia+\u03f5(\u03c3ir , \u03c3jr)\u2229U (parameterized by \u03f5) is\na smoothly parameterized family of embeddings of \u22c2\nr\u2208\u2113 Ia(\u03c3ir , \u03c3jr)\u2229U into U \u2286 B. Varying {\u03f5r | r \u2208 J\u2113} (while holding \u03f5r constant for r \u0338\u2208 J\u2113) produces a smoothly parameterized family of embeddings of \u22c2 r\u2208\u2113 Ia(\u03c3ir , \u03c3jr)\u2229U while holding (\u22c2 \u2113\u2032<\u2113 \u22c2 r\u2208J\u2113 Ia(\u03c3ir , \u03c3jr)\u2229U ) constant. Therefore, because transverse intersections are generic,( \u22c2 r\u2208J\u2113 Ia(\u03c3ir , \u03c3jr) \u2229 U ) \u22d4 ( \u22c2 \u2113\u2032<\u2113 \u22c2 r\u2208J\u2113 Ia(\u03c3ir , \u03c3jr) \u2229 U )\nfor all \u2113 for almost every \u03f5 in a neighborhood of 0 \u2208 RN . This proves (25), which completes the proof. \u25a1\nLemma A.5. Let {(ir, jr)}mr=1 be a set of index pairs such that {ir, jr} =\u0338 {is, js} if r \u0338= s. For almost every a \u2208 A, we have that if U is an open set in B such that\n(26) \u03c0 ( m\u22c2\nr=1\n(Ma,ir \u2229Ma,jr) ) \u2229 U = m\u22c2 r=1 Ia(\u03c3ir , \u03c3jr) \u2229 U ,\nwhere \u03c0 is the projection \u03c0 : B \u00d7 R \u2192 B, then \u22c2\nr\u2208J \u2032 Ia(\u03c3ir , \u03c3jr) is a manifold for every J \u2032 \u2286 {1, . . . ,m} and\n(27) Ty ( Ia(\u03c3i1 , \u03c3j1) \u2229 \u00b7 \u00b7 \u00b7 Ia(\u03c3im , \u03c3jm) ) = m\u22c2 r=1 Ty ( Ia(\u03c3ir , \u03c3jr) ) for all y \u2208 \u22c2m r=1 Ia(\u03c3ir , \u03c3jr) \u2229 U .\nProof. By Lemmas 4.8 and 4.9, \u22c2\nr\u2208J \u2032 Ia(\u03c3ir , \u03c3jr) is a manifold for every J \u2032 \u2286 {1, . . . ,m} for\nalmost every a \u2208 A. We have\nTy ( Ia(\u03c3i1 , \u03c3j1) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3im , \u03c3jm) ) \u2286 m\u22c2 r=1 Ty ( Ia(\u03c3ir , \u03c3jr) ) because \u22c2m r=1 Ia(\u03c3ir , \u03c3jr) \u2286 Ia(\u03c3is , \u03c3js) for all s.\nLet v \u2208 \u22c2m\nr=1 Ty ( Ia(\u03c3ir , \u03c3jr) ) . Define \u03c0[m] := \u03c0|\u22c2mr=1(Ma,ir\u2229Ma,jr )\u2229\u03c0\u22121(U), and define \u03c0r :=\n\u03c0|Ma,ir\u2229Ma,jr\u2229\u03c0\u22121(U) for each r. Each \u03c0r is a diffeomorphism from Ma,ir \u2229 Ma,jr \u2229 \u03c0 \u22121(U) to Ia(\u03c3ir , \u03c3jr) \u2229 U , and \u03c0[m] is a diffeomorphism from \u22c2m\nr=1(Ma,ir \u2229 Ma,jr) \u2229 \u03c0\u22121(U) to\u22c2m r=1 Ia(\u03c3ir , \u03c3jr) \u2229 U . Let y\u0303 := \u03c0 \u22121 [m] (which exists because \u03c0 \u22121 [m] is a diffeomorphism), and let v\u0303 := d\u03c0\u22121[m](v) (which exists because d\u03c0[m] is an isomorphism). For all r, we have y\u0303 = \u03c0 \u22121 r (y) and v\u0303 := d\u03c0\u22121r (v). Therefore,\nv\u0303 \u2208 m\u22c2 r=1 Ty\u0303 ( Ma,ir \u2229Ma,jr ) .\nBy Lemma A.1, we have Ty\u0303 (\u22c2m r=1(Ma,ir \u2229 Ma,jr) ) = \u22c2m r=1 Ty\u0303(Ma,ir \u2229 Ma,jr) for all y\u0303 \u2208\u22c2m\nr=1(Ma,ir \u2229Ma,jr) for almost every a \u2208 A, so\nv\u0303 \u2208 Ty\u0303 ( m\u22c2\nr=1\n(Ma,ir \u2229Ma,jr) )\nfor almost every a \u2208 A. Therefore, v = d\u03c0[m](v\u0303) is in Ty ( \u03c0[m] (\u22c2m r=1(Ma,ir \u2229 Ma,jr) )) =\nTy (\u22c2m r=1 Ia(\u03c3ir , \u03c3jr) ) , which implies that\nTy ( m\u22c2 r=1 Ia(\u03c3ir , \u03c3jr) ) \u2287 m\u22c2 r=1 Ty ( Ia(\u03c3ir , \u03c3jr) ) .\n\u25a1\nThe following series of lemmas is used to prove Lemma 4.13, which shows that Ya is locally finite for almost every a \u2208 A, and Lemma 4.14, which shows that Ya satisfies the Axiom of the Frontier for almost every a \u2208 A. (Recall that Ya is the set of subsets of B that is defined by (15).)\nLemma A.6. If a \u2208 A is such that each Y \u2208 Ya is a manifold, then for any strict partial order \u227a on K, there is a unique subset Y\u227aa \u2286 Ya such that Z\u227aa = \u22c3 Y \u2208Y\u227aa Y , where Z \u227a a is defined as in (17).\nProof. Let Y \u2208 Ya and suppose that Y \u2229 Z\u227aa \u0338= \u2205. This implies that there is a point p \u2208 Y such that \u227afa(\u00b7,p) is the same as \u227a. By Lemma 4.11, the simplex order induced by f is constant in Y , so Y \u2286 Z\u227aa . \u25a1\nLemma A.7. Let \u227a be a strict partial order on the simplices in K. Let a \u2208 A be such that (1) every Y \u2208 Ya is a manifold, where Ya is defined as in (15), (2) Ma,i \u22d4 Ma,j for all i \u0338= j, where Ma,i is defined as in (9), (3) \u22c2m r=1 Ia(\u03c3ir , \u03c3jr) is a manifold for all sets {(ir, jr}mr=1 of index pairs, and\n(4) we have\n(28) Tp ( m\u22c2 r=1 Ia(\u03c3ir , \u03c3jr) ) = m\u22c2 r=1 Tp ( Ia(\u03c3ir , \u03c3jr) ) for all sets {(ir, jr}mr=1 of index pairs and all p \u2208 \u22c2m r=1 Ia(\u03c3ir , \u03c3jr).\nLet Y\u227aa be the unique subset of Ya such that Z\u227aa = \u22c3\nY \u2208Y\u227aa Y , which exists by Lemma A.6. Then every p \u2208 B has a neighborhood that intersects at most one set Y \u2208 Y\u227aa .\nProof. Let S(p) = {(\u03c3i, \u03c3j) | p \u2208 Ia(\u03c3i, \u03c3j)}. There is a neighborhood U0 of p such that I(\u03c3i, \u03c3j) \u2229 U0 \u0338= \u2205 if and only if (\u03c3i, \u03c3j) \u2208 S(p). In a neighborhood of p, each I(\u03c3i, \u03c3j) is locally diffeomorphic (via the exponential map, for example) to Tp(Ia(\u03c3i, \u03c3j)), which is an (n \u2212 1)-dimensional hyperplane. By (28), these local diffeomorphisms are compatible with each other, so there is a neighborhood U of p, a set {H(\u03c3i, \u03c3j)}(\u03c3i,\u03c3j)\u2208S(p) of hyperplanes in Rn, and a homeomorphism \u03d5 : U \u2192 B, where B is the open unit n-ball, such that\n\u03d5 ( \u22c2\n(\u03c3i,\u03c3j)\u2208S\u2032(p)\nIa(\u03c3i, \u03c3j) \u2229 U ) = \u22c2 (\u03c3i,\u03c3j)\u2208S\u2032(p) H(\u03c3i, \u03c3j) \u2229 B\nfor all S \u2032(p) \u2286 S(p). See Figure 8 for intuition, where we illustrate the neighborhood U for a few points p \u2208 B. The hyperplanes induce a stratification of B, with a set Y \u2032 of strata, such that for all Y \u2032 \u2208 Y \u2032, we have Y \u2032 = \u03d5(Y \u2229 U) for some Y \u2208 Ya. Because Ma,i \u22d4 Ma,j for all i \u0338= j, we have that B \\H(\u03c3i, \u03c3j) is the disjoint union of open sets W1(\u03c3i, \u03c3j) and W2(\u03c3i, \u03c3j) such that\nfa(\u03c3i, p \u2032) < fa(\u03c3j, p \u2032) for all p\u2032 \u2208 \u03d5\u22121(W1(\u03c3i, \u03c3j)) , fa(\u03c3j, p \u2032) < fa(\u03c3i, p \u2032) for all p\u2032 \u2208 \u03d5\u22121(W2(\u03c3i, \u03c3j))\nfor all (\u03c3i, \u03c3j) \u2208 S(p). Suppose that u1 and u2 are points in U such that \u227afa(\u00b7,u1) and \u227afa(\u00b7,u2) are both the same as \u227a. For each (\u03c3i, \u03c3j) \u2208 S(p), define the set\n(29) V (\u03c3i, \u03c3j) :=  H(\u03c3i, \u03c3j) , \u03c3i \u0338\u227a \u03c3j and \u03c3j \u0338\u227a \u03c3i W1(\u03c3i, \u03c3j) , \u03c3i \u227a \u03c3j W2(\u03c3i, \u03c3j) , \u03c3j \u227a \u03c3i .\nWe define (30) V := \u22c2\n(\u03c3i,\u03c3j)\u2208S(p)\nV (\u03c3i, \u03c3j) \u0338= \u2205 ,\nwhich is a stratum in Y \u2032. Therefore, there is a Y \u2208 Ya such that Y \u2229 U = \u03d5\u22121(V ), with u1, u2 \u2208 Y \u2229 U . Therefore, Y is the only element of Y\u227aa that U intersects. \u25a1\nLemma A.8. Let \u227a0 be a strict partial order on the simplices in K, and define O to be the set of strict partial orders \u227a such that\n(1) if \u03c3 \u227a0 \u03c4 and \u03c3 \u0338= \u03c4 , then either we have \u03c3 \u227a \u03c4 or we have \u03c3 \u0338\u227a \u03c4 and \u03c4 \u0338\u227a \u03c3, (2) if \u03c3 \u0338\u227a0 \u03c4 and \u03c4 \u0338\u227a0 \u03c3, then \u03c3 \u0338\u227a \u03c4 and \u03c4 \u0338\u227a \u03c3, and (3) the strict partial order \u227a is not the same as \u227a0.\nIf a \u2208 A is such that (1) every S \u2208 En\u2212\u2113a is an \u2113-dimensional smooth submanifold for every \u2113 \u2208 {1, . . . , n},\nwhere n is the dimension of B, (2) Ma,i \u22d4 Ma,j for all i \u0338= j, (3) the set \u22c2m r=1 Ia(\u03c3ir , \u03c3jr) is a manifold for all sets {(ir, jr)}mr=1 of index pairs, and\n(4) Ty( \u22c2m r=1 Ia(\u03c3ir , \u03c3jr) = \u22c2m\nr=1 Ty(Ia(\u03c3ir , \u03c3jr)) for all sets {(ir, jr)}mr=1 of index pairs, then\n\u2202Z\u227a0a = \u22c3\n\u227a in O\nZ\u227aa .\nProof. By Lemma 4.10, every Y \u2208 Ya is a manifold. By Lemmas A.6 and A.7, the sets Z\u227a0a and Z\u227aa (for all \u227a in O) are submanifolds of B.\nCase 1: If dim(Z\u227a0a ) = 0, then we must have\nZ\u227a0a = Ia(\u03c3i1 , \u03c3j1) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3in , \u03c3jn) .\nfor some Ia(\u03c3i1 , \u03c3j1) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3in , \u03c3jn) \u2208 Ena. If \u227a is in O, then there is another pair (\u03c3in+1 , \u03c3jn+1) of distinct simplices such that \u03c3in+1 \u0338\u227a \u03c3jn+1 and \u03c3jn+1 \u0338\u227a \u03c3in+1 . Therefore,\nZ\u227aa \u2286 Ia(\u03c3i1 , \u03c3j1) \u2229 \u00b7 \u00b7 \u00b7 \u2229 Ia(\u03c3in , \u03c3jn) \u2229 Ia(\u03c3in+1 , \u03c3jn+1) ,\nwhich is an element of En+1a . By choice of a, every S \u2208 En+1a is empty, so Z\u227aa = \u2205.\nCase 2: If dim(Z\u227a0a ) \u2265 1, let \u227a be any strict partial order in O. Let p \u2208 Z\u227aa . Let S(p) = {(\u03c3i, \u03c3j) | p \u2208 Ia(\u03c3i, \u03c3j)}. By the same argument as in the proof of Lemma A.7, there is a neighborhood U of p, a set {H(\u03c3i, \u03c3j)}(\u03c3i,\u03c3j)\u2208S(p) of hyperplanes in Rn, and a homeomorphism \u03d5 : U \u2192 B, where B is the open unit n-ball, such that\n\u03d5 ( \u22c2\n(\u03c3i,\u03c3j)\u2208S\u2032(p)\nIa(\u03c3i, \u03c3j) \u2229 U ) = \u22c2 (\u03c3i,\u03c3j)\u2208S\u2032(p) H(\u03c3i, \u03c3j) \u2229 B\nfor all S \u2032(p) \u2286 S(p). See Figure 8. Because Ma,i \u22d4 Ma,j for all i \u0338= j, we have that B \\H(\u03c3i, \u03c3j) is the disjoint union of open sets W1(\u03c3i, \u03c3j) and W2(\u03c3i, \u03c3j) such that\nfa(\u03c3i, p \u2032) < fa(\u03c3j, p \u2032) for all p\u2032 \u2208 \u03d5\u22121(W1(\u03c3i, \u03c3j)) , fa(\u03c3j, p \u2032) < fa(\u03c3i, p \u2032) for all p\u2032 \u2208 \u03d5\u22121(W2(\u03c3i, \u03c3j))\nfor all (\u03c3i, \u03c3j) \u2208 S(p). For each (\u03c3i, \u03c3j) \u2208 S(p), define the set V (\u03c3i, \u03c3j) as in (29), and define the set V as in (30). The set \u03d5\u22121(V ) is a nonempty subset of U \u2229 Z\u227a0a . This implies that p is a limit point of Z\u227a0a , so Z \u227a0 a \u2286 Z \u227a0 a . Because \u227a is not the same as \u227a0, we have that Z\u227aa \u2229 Z\u227a0a = \u2205. Therefore, Z\u227a0a \u2286 \u2202Z\u227a0a and\u22c3 \u227a in O Z\u227aa \u2286 \u2202Z\u227a0a .\nNow suppose that p is in the complement of Z\u227a0a \u222a (\u22c3 \u227a in O Z \u227a a ) . Because \u227afa(\u00b7,p) is not the same as \u227a0 or any \u227a in O, there is a pair (\u03c3i, \u03c3j) of simplices such that f(\u03c3i, p) < f(\u03c3j, p) and either we have \u03c3j \u227a0 \u03c3i or we have \u03c3j \u0338\u227a \u03c3i and \u03c3i \u0338\u227a \u03c3j. By continuity of f , there is a neighborhood U\u03c3i,\u03c3j of p such that fa(\u03c3i, p \u2032) < fa(\u03c3j, p \u2032) for all p\u2032 \u2208 U\u03c3i,\u03c3j . Therefore, U\u03c3i,\u03c3j is in the complement of Z\u227a0a , so p is not in Z \u227a0 a . This implies\n\u2202Z\u227a0a \u2286 \u22c3\n\u227a in O\nZ\u227aa ,\nwhich completes the proof. \u25a1"
        }
    ],
    "title": "PERSISTENCE DIAGRAM BUNDLES: A MULTIDIMENSIONAL GENERALIZATION OF VINEYARDS",
    "year": 2023
}