{
    "abstractText": "Most ultrasound (US) imaging techniques use spatially-constant speed-of-sound (SoS) values for beamforming. Having a discrepancy between the actual and used SoS value leads to aberration artifacts, e.g., reducing the image resolution, which may affect diagnostic usability. Accuracy and quality of different US imaging modalities, such as tomographic reconstruction of local SoS maps, also depend on a good initial beamforming SoS. In this work, we develop an analytical method for estimating mean SoS in an imaged medium. We show that the relative shifts between beamformed frames depend on the SoS offset and the geometric disparities in transmission paths. Using this relation, we estimate a correction factor and hence a corrected mean SoS in the medium. We evaluated our proposed method on a set of numerical simulations, demonstrating its utility both for global SoS prediction and for local SoS tomographic reconstruction. For our evaluation dataset, for an initial SoS underand overassumption of 5% the medium SoS, our method is able to predict the actual mean SoS within 0.3% accuracy. For the tomographic reconstruction of local SoS maps, the reconstruction accuracy is improved on average by 78.5% and 87%, respectively, compared to an initial SoS underand over-assumption of 5%.",
    "authors": [
        {
            "affiliations": [],
            "name": "Can Deniz Bezek"
        },
        {
            "affiliations": [],
            "name": "Mert Bilgin"
        },
        {
            "affiliations": [],
            "name": "Lin Zhang"
        },
        {
            "affiliations": [],
            "name": "Orcun Goksel"
        }
    ],
    "id": "SP:bc5dda4a4b278bbfb79a4fd6ede032732929c79b",
    "references": [
        {
            "authors": [
                "R. Rau",
                "D. Schweizer",
                "V. Vishnevskiy",
                "O. Goksel"
            ],
            "title": "Speed-of-sound imaging using diverging waves",
            "venue": "International journal of computer assisted radiology and surgery, vol. 16, pp. 1201\u20131011, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "M.E. Anderson",
                "G.E. Trahey"
            ],
            "title": "The direct estimation of sound speed using pulse-echo ultrasound",
            "venue": "The Journal of the Acoustical Society of America, vol. 104, pp. 3099\u2013106, 1998.",
            "year": 1998
        },
        {
            "authors": [
                "B. Byram",
                "G. Trahey",
                "J. Jensen"
            ],
            "title": "A method for direct localized sound speed estimates using registered virtual detectors",
            "venue": "Ultrasonic imaging, vol. 34, pp. 159\u2013180, 2012.",
            "year": 2012
        },
        {
            "authors": [
                "C.-C. Shen",
                "K.-L. Tu"
            ],
            "title": "Ultrasound DMAS beamforming for estimation of tissue speed of sound in multi-angle plane-wave imaging",
            "venue": "Applied Sciences, vol. 10, no. 18, p. 6298, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "X. Augustin",
                "L. Zhang",
                "O. Goksel"
            ],
            "title": "Estimating mean speed-ofsound from sequence-dependent geometric disparities",
            "venue": "2021 IEEE International Ultrasonics Symposium (IUS), 2021, pp. 1\u20134.",
            "year": 2021
        },
        {
            "authors": [
                "M. Jaeger",
                "G. Held",
                "S. Preisser",
                "S. Peeters",
                "M. Gr\u00fcnig",
                "M. Frenz"
            ],
            "title": "Computed ultrasound tomography in echo mode for imaging speed of sound using pulse-echo sonography: proof of principle",
            "venue": "Ultrasound Med Biol., vol. 41, pp. 235\u2013250, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "S.J. Sanabria",
                "E. Ozkan",
                "M.B. Rominger",
                "O. Goksel"
            ],
            "title": "Spatial domain reconstruction for imaging speed-of-sound with pulse-echo ultrasound: simulation and in vivo study",
            "venue": "Physics in medicine and biology, vol. 63, p. 215015, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "L. Ruby",
                "S.J. Sanabria",
                "K. Martini",
                "K.J. Dedes",
                "D. Vorburger",
                "E. Oezkan",
                "T. Frauenfelder",
                "O. Goksel",
                "M.B. Rominger"
            ],
            "title": "Breast cancer assessment with pulse-echo speed of sound ultrasound from intrinsic tissue reflections: Proof-of-concept",
            "venue": "Investigative Radiology, vol. 54, no. 7, pp. 419\u2013427, Jul 2019.",
            "year": 2019
        },
        {
            "authors": [
                "R.Z. Azar",
                "O. Goksel",
                "S.E. Salcudean"
            ],
            "title": "Sub-sample displacement estimation from digitized ultrasound rf signals using multi-dimensional polynomial fitting of the cross-correlation function",
            "venue": "IEEE Trans Ultras, Ferroelec, Freq Control, vol. 57, no. 11, pp. 2403\u20132420, 2010.",
            "year": 2010
        },
        {
            "authors": [
                "B.E. Treeby",
                "B.T. Cox"
            ],
            "title": "k-Wave: MATLAB toolbox for the simulation and reconstruction of photoacoustic wave fields",
            "venue": "Journal of Biomedical Optics, vol. 15, no. 2, pp. 1 \u2013 12, 2010.",
            "year": 2010
        },
        {
            "authors": [
                "M. Bernhardt",
                "V. Vishnevskiy",
                "R. Rau",
                "O. Goksel"
            ],
            "title": "Training variational networks with multidomain simulations: Speed-of-sound image reconstruction",
            "venue": "IEEE Transactions on Ultrasonics, Ferroelectrics, and Frequency Control, vol. 67, no. 12, pp. 2584\u20132594, 2020.",
            "year": 2020
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014Beamforming, aberration correction.\nI. INTRODUCTION Speed-of-Sound (SoS) is the longitudinal travel rate of the acoustic waves within the tissue. Beamforming is the reconstruction of spatial US images from temporal signals received by an US transducer, and this process requires an SoS assumption for such image formation. Typically a constant SoS value is assumed and used. However, SoS may in reality change largely in tissues. Having a discrepancy between the actual and assumed SoS values leads to aberration artifacts, e.g., reducing the image resolution, which may affect diagnostic usability. Global average SoS values are also utilized in the beamforming stage of tomographic reconstruction of local SoS maps [1]. Thus, utilizing a correct SoS assumption is of great importance in US image formation. SoS estimation has been studied by several groups, to find either a single global SoS value or a spatial (heterogeneous) SoS map.\nAmong single-value estimation methods, in [2] a leastsquares fitting of a second-order polynomial to echo profiles was proposed for estimating a mean SoS within the imaged region. This work was later extended for measuring SoS in layered phantoms in [3]. In [4], mean SoS was estimated using the signal coherence between different transmit (Tx) and receive (Rx) paths in multi-angle plane wave imaging. In [5], an approach for mean SoS estimation was proposed by\nFunding provided by Uppsala Medtech Science and Innovation Centre.\nexploiting geometric disparities between sequences originating from different transducer elements. This used calibrations from simulations, in order to map the lateral disparity profiles to actual SoS under-/over-estimation. Herein we propose an analytical estimation method with a closed form solution, where under-/over-estimation can be directly inferred from disparities, i.e. without a need for calibration, in contrast to [5].\nFor estimating heterogeneous SoS distribution, local SoS maps were reconstructed in [6] using steered plane waves and frequency domain reconstruction. A spatial domain reconstruction approach in [7] allowed successful image quality that can be used in multiple clinical applications, such as for breast cancer diagnosis [8]. In [1], instead of plane waves, diverging wave transmission is proposed to minimize wavefront diffraction artifacts in SoS reconstruction. These above local SoS mapping methods all utilize beamformed images and thus require an initial SoS assumption; hence their results also highly depend on the accuracy of such assumed SoS value."
        },
        {
            "heading": "II. METHOD",
            "text": "In this work, we devise an analytical method for mean SoS estimation using the geometric disparities between images generated with different transmission/receive events during data acquisition. An overview of our processing pipeline is shown in Fig. 1. In our processing, we first beamform the received temporal raw data using an arbitrary assumed SoS value. Any disparity between the assumed and actual SoS then causes a spatially-varying shift in the beamformed frames.\nar X\niv :2\n20 8.\n08 37\n7v 1\n[ ph\nys ic\ns. m\ned -p\nh] 1\n7 A\nug 2\n02 2\nWe estimate these shifts between the beamformed RF frames using a motion-estimation (displacement-tracking) method. We devise an algebraic model relating such speckle shifts to differential Tx distances as well as the disparity between the actual and beamforming SoS values. Using this model, we then calculate a correction factor to update the assumed value with an accurate SoS estimate."
        },
        {
            "heading": "A. Analytical model",
            "text": "Consider two transmits Tx1 and Tx2 with different distances to a point M , as shown in Fig. 2. By using dynamic receive aperture (with an F-number of N), we place the Rx apertures directly above the beamformed point, such that only the Tx paths differ for different transmits. Any disparity between the unknown actual SoS cac and assumed beamforming SoS cbf is expected to cause a spatial shift between different beamformed frames. Using transmission geometry, this shift can be written as a spatial function of ( cbf cac \u2212 caccbf ) as follows:\n\u2206x = x2 \u2212 x1 = ( d2 \u2212 d1\n2 )( cbf cac \u2212 cac cbf ) . (1)\nwhere \u2206x is the expected shift between image features observed at locations x1 and x2 in the two beamformed frames from different Tx events. Herein d1 and d2 are known physical distances of the beamformed image point to each Tx element. Note that their difference (d1\u2212d2) changes spatially, and in particular laterally, across the image frame. Aggregating (1) for every beamformed point with corresponding geometric distances, we arrive at the following linear system of equations:\n\u2206x = D\u03b3 , where \u03b3 = ( cbf cac \u2212 cac cbf ) (2)\nwith \u03b3 the correction factor, \u2206x the displacement map, and D the differential distance map, as illustrated in Fig. 1 (top-right). We use (2) as an analytical model to predict global SoS."
        },
        {
            "heading": "B. Model fitting to predict the global SoS",
            "text": "Given imaging data, we measure the spatial distribution of point-wise shifts between beamformed frames using a speckle tracking algorithm, herein a time-delay estimation method based on normalized cross-correlation [9]. Finding the correction factor \u03b3 can then be defined as an optimization problem (model fitting) by minimizing the following cost function:\n\u03b3\u0302 = arg min \u03b3 ||\u2206x\u2212 \u03b3D||2 . (3)\nSoS can then be updated to a corrected value using:\nccorrected = cbf(\n\u221a \u03b3\u03022 + 4\u2212 \u03b3\u0302)\n2 (4)"
        },
        {
            "heading": "C. Application on local SoS reconstruction",
            "text": "An incorrect SoS assumption does not only deteriorate Bmode imaging, but also negatively affects local SoS reconstruction process due to the use of beamformed images therein. To demonstrate this and the use of our proposed method to this end, we first briefly explain local SoS reconstruction procedure below. For tomographic reconstruction of SoS maps, first a differential path matrix L with each row indicating the integral distances from Tx and Rx elements to a spatial image location is formed as in [1]. Then, given differential displacement measurements \u2206\u03c4 , reconstructing a spatial slowness map \u03c3\u0302 (inverse of SoS) is formulated as:\n\u03c3\u0302 = arg min \u03c3\n||L(\u03c3 \u2212 \u03c30)\u2212\u2206\u03c4 ||1 + \u03bb||B\u03c3||1, (5)\nwhere \u03c30 is the initial slowness, B is the regularization matrix, and \u03bb is the trade-off parameter between data and regularization terms. Following [1], we use total variation regularization with anisotropically weighted spatial gradients and solve the inverse problem using the limited memory Broyden-Fletcher-Goldfarb-Shanno (L-BFGS) algorithm."
        },
        {
            "heading": "III. RESULTS",
            "text": "We conducted experiments with numerical phantoms simulated using k-Wave toolbox [10]. We simulated a linear transducer with 128 channels and 300 mm pitch, on a 2D phantom of size 40x55 mm. Spatial and temporal resolutions were set to be 75\u00b5m and 6.25 ns, respectively. Utilizing diverging waves [1], for each Tx only a single is activated. For each Tx pulse, we used 4 half cycles with a center frequency of fc=5 MHz. We study errors due to over- and under-assumption of beamforming SoS values, by initially beamforming the raw channel Rx data with 8 different global SoS values of {1, 3, 5, 10}% higher and lower than the known ground-truth SoS. We then employed our proposed method to evaluate the corrected SoS values. Without loss of generality, in this paper for SoS correction we used the beamformed RF frame pair from Tx of channels 55 and 65 only."
        },
        {
            "heading": "A. Global SoS estimation in homogeneous medium",
            "text": "First we studied accuracy in two homogeneous numerical phantoms with SoS values of 1400 and 1600 m/s, where internal scattering was simulated using minor density variations. Given 8 different initial SoS assumptions, Fig. 3 shows the SoS values corrected by our method, indicating a convergent pattern when applied iteratively. The ground-truth SoS values are found within few iterations, regardless of the initial estimate."
        },
        {
            "heading": "B. Global SoS estimation in heterogeneous medium",
            "text": "Next we studied the feasibility of our method in heterogeneous phantoms. To that end, we utilized the set of 32 numerical phantom simulations described in [11]. For a heterogeneous phantom, since there is no ground-truth global\nSoS value, we conduct this evaluation via comparisons against the mean SoS value within each phantom, which vary across 32 phantoms depending on their inclusion SoS and size. Accordingly, we also set the initial assumed beamforming SoS to {1, 3, 5, 10}% higher and lower than the phantom mean. For each phantom, we then computed mean absolute error (MAE) between the mean of ground-truth phantom SoS map and our global SoS prediction (or the assumed value for the initial step). Table I presents average MAEs over 32 inclusion phantoms, for different initial beamforming SoS assumptions and their corrected values after the 1st and the 5th correction iterations using our method. We also compared our method favorably to global SoS values corrected using the geometric model from [5], which is an inexact model which was remedied in that work using a tedious and potentially error-prone calibration step. As seen in Table I, our proposed method successfully reduces the average MAE under 5 m/s after five iterations, both from over- and under-assumption; leading to MAE improvements over 30 folds in some experimental settings. The remaining MAE can be explained by the fact that mean phantom SoS used for comparison here is indeed not a ground-truth, but is rather a surrogate, since the SoS location, Tx/Rx geometry, etc may all affect how an SoS heterogeneity could factor into beamforming.\nDistributions of differences of the corrected SoS from the mean phantom SoS are presented in Fig. 4 for different experimental settings. For each phantom, the corrected SoS is"
        },
        {
            "heading": "140 RMSE [m/s]",
            "text": "seen to converge similar values regardless of the initialization, which indicates the robustness of our analytical approach."
        },
        {
            "heading": "C. Effect of global SoS assumption in local SoS reconstruction",
            "text": "Since local SoS reconstruction uses displacements between beamformed RF frames, its accuracy also relies on a good beamforming SoS assumption. To study this, we compared local SoS reconstructions of the 32 phantoms, using under/over-assumed beamforming SoS values and SoS values corrected by different methods. For local SoS reconstructions, we used 6 pairs of beamformed RF frames as in [11]. For each reconstruction, we computed root mean square error (RMSE) with respect to the known ground truth SoS map. Average RMSEs over 32 numerical phantoms are given in Table II for each method for beamforming SoS determination. As seen, our method significantly improves the accuracy of tomographic SoS reconstructions, and more importantly make the results of this quantitative imaging method robust to and independent of the unknown global SoS value for beamforming. In particular, for 5% initial offset, RMSE is improved by 78.5% for under-assumption and 87.0% for over-assumption cases. Distributions of RMSEs for each phantom reconstructed using initial assumed and 5th-iteration corrected SoS values are presented in Fig. 5, demonstrating a consistent improvement of SoS reconstructions for all phantoms regardless of the initial SoS assumption error.\nIn Fig. 6, we illustrate three sample phantoms and their reconstructions for 3% assumption error and corrected SoS values. As seen, after the correction, reconstruction are also substantially improved qualitatively. Specifically, background SoS values and deeper regions are better reconstructed, where the inclusions can be distinguished more clearly."
        },
        {
            "heading": "IV. CONCLUSION",
            "text": "In this work, we have proposed an analytical method for the estimation of beamforming SoS by utilizing the geometric disparities between different transmits. We have devised a model for the differential spatial shifts between different beamformed RF frames, and use this in a closed-form model fitting approach to estimate a corrected beamforming SoS from\nTABLE I: Mean Absolute Error (MAE) values [m/s] averaged over 32 heterogeneous numerical phantoms.\nExperimental Setting Under-Assumption Over-Assumption\n1% 3% 5% 10% 1% 3% 5% 10% Error for assumed beamforming SoS 15.02 45.07 75.12 150.23 15.02 45.07 75.12 150.23 Corrected using geometric model from [5] 9.47 37.20 57.66 92.68 11.37 34.17 54.66 73.27 Corrected using our proposed model (iteration 1) 5.25 6.33 13.10 43.42 3.90 4.25 5.97 26.25 Corrected using our proposed model (iteration 5) 4.54 4.55 4.57 4.57 4.52 4.52 4.52 4.49 Improvement [%] from assumed to our corrected 69.8 89.9 93.9 97.0 69.9 90.0 94.0 97.0\nTABLE II: Root Mean Square Error (RMSE) values [m/s] averaged over 32 heterogeneous numerical phantoms.\nExperimental Setting Under-Assumption Over-Assumption\n1% 3% 5% 10% 1% 3% 5% 10% Error for assumed beamforming SoS 8.54 20.23 42.37 115.75 13.87 39.08 70.16 143.82 Corrected using geometric model from [5] 13.12 34.37 52.23 87.81 9.39 14.34 25.76 42.25 Corrected using our proposed model (iteration 1) 8.60 8.57 8.51 20.00 9.27 9.37 9.85 24.69 Corrected using our proposed model (iteration 5) 9.16 9.16 9.11 9.09 9.13 9.13 9.12 9.12 Improvement [%] from assumed to our corrected -7.3 54.7 78.5 92.2 34.2 76.6 87.0 93.7\nany initial arbitrary SoS assumption. By applying this iteratively, we show that actual SoS values are estimated robustly and accurately. We have studied our method on numerically simulated phantoms. We have shown the accuracy of our method and its behaviour with iterative use on homogeneous phantoms, and also demonstrated its utility in significantly improving local SoS map reconstruction accuracy. Our method\nutilizes an improved model compared to [5]; relies only on the known transducer geometry and hence does not require any prior training or calibration; and can be used iteratively for increased accuracy."
        }
    ],
    "title": "Global Speed-of-Sound Prediction Using Transmission Geometry",
    "year": 2022
}