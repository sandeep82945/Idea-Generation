{
    "abstractText": "With the rapid growth in the demand for plugin electric vehicles (EVs), the corresponding charging infrastructures are expanding. These charging stations are located at various places and with different congestion levels. EV drivers face an important decision in choosing which charging station to go to in order to reduce their overall time costs. However, existing literature either assumes a flat charging rate and hence overlooks the physical characteristics of an EV battery where charging rate is typically reduced as the battery charges, or ignores the effect of other drivers on an EV\u2019s decision making process. In this paper, we consider both the predetermined exogenous wait cost and the endogenous congestion induced by other drivers\u2019 strategic decisions, and propose a differential equation based approach to find the optimal strategies. We analytically characterize the equilibrium strategies and find that co-located EVs may make different decisions depending on the charging rate and/or remaining battery levels. Through numerical experiments, we investigate the impact of charging rate characteristics, modeling parameters and the consideration of endogenous congestion levels on the optimal charging decisions. Finally, we conduct numerical studies on realworld data and find that some EV users with slower charging rates may benefit from the participation of fast-charging EVs.",
    "authors": [
        {
            "affiliations": [],
            "name": "Lihui Yi"
        },
        {
            "affiliations": [],
            "name": "Ermin Wei"
        }
    ],
    "id": "SP:3f8343d68305302c2b6467a6c26208376489dc20",
    "references": [
        {
            "authors": [
                "The ROUTES Initiative"
            ],
            "title": "Electric vehicles & rural transportation",
            "venue": "U.S. Department of Transportation. [Online]. Available: https://www.transportation.gov/rural/ev. [Accessed: 08-Aug-2023].",
            "year": 2023
        },
        {
            "authors": [
                "B. Badia",
                "R. Berry",
                "E. Wei"
            ],
            "title": "Price and capacity competition for EV parking with government mandates",
            "venue": "56th Annual Allerton Conference on Communication, Control, and Computing (Allerton), pp. 583-589, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "B. Badia",
                "R.A. Berry",
                "E. Wei"
            ],
            "title": "Investment in EV charging spots for parking",
            "venue": "IEEE Transactions on Network Science and Engineering, vol. 7, no. 2, pp. 650-661, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "P. You",
                "J.Z.F. Pang",
                "S.H. Low"
            ],
            "title": "Online station assignment for electric vehicle battery swapping",
            "venue": "IEEE Transactions on Intelligent Transportation Systems, vol. 23, no. 4, pp. 3256-3267, April 2022.",
            "year": 2022
        },
        {
            "authors": [
                "K.W.E. Cheng",
                "B.P. Divakar",
                "H. Wu",
                "K. Ding",
                "H.F. Ho"
            ],
            "title": "Battery-management system (BMS) and SOC development for electrical vehicles",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 60, no. 1, pp. 76-88, Jan. 2011.",
            "year": 2011
        },
        {
            "authors": [
                "C. Sun",
                "T. Li",
                "S.H. Low",
                "V.O.K. Li"
            ],
            "title": "Classification of electric vehicle charging time series with selective clustering",
            "venue": "Electric Power Systems Research, vol. 189, pp. 106695, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "A. Seaman",
                "TS. Dao",
                "J. McPhee"
            ],
            "title": "A survey of mathematics-based equivalent-circuit and electrochemical battery models for hybrid and electric vehicle simulation",
            "venue": "Journal of Power Sources, vol. 256, pp. 410\u2013423, 2014.",
            "year": 2014
        },
        {
            "authors": [
                "The ROUTES Initiative"
            ],
            "title": "Electric vehicle charging speeds",
            "venue": "U.S. Department of Transportation. [Online]. Available: https://www.transportation.gov/rural/ev/toolkit/ev-basics/charging-speeds. [Accessed: 08-Aug-2023].",
            "year": 2023
        },
        {
            "authors": [
                "P. Alexeenko",
                "E. Bitar"
            ],
            "title": "Achieving reliable coordination of residential plug-in electric vehicle charging: A pilot study",
            "venue": "arXiv preprint arXiv:2112.04559v2, 2022.",
            "year": 2022
        },
        {
            "authors": [
                "T. Mamalis",
                "S. Bose",
                "L.R. Varshney"
            ],
            "title": "Ridesharing systems with electric vehicles",
            "venue": "2019 American Control Conference (ACC), pp. 3329- 3334, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "B. Alinia",
                "M.H. Hajiesmaili",
                "Z.J. Lee",
                "N. Crespi",
                "E. Mallada"
            ],
            "title": "Online EV scheduling algorithms for adaptive charging networks with global peak constraints",
            "venue": "IEEE Transactions on Sustainable Computing, vol. 7, no. 3, pp. 537-548, 1 July-Sept. 2022.",
            "year": 2022
        },
        {
            "authors": [
                "Y. Zhang",
                "X. Qu",
                "L. Tong"
            ],
            "title": "Optimal eco-driving control of autonomous and electric trucks in adaptation to highway topography: Energy minimization and battery life extension",
            "venue": "IEEE Transactions on Transportation Electrification, vol. 8, no. 2, pp. 2149-2163, June 2022.",
            "year": 2022
        },
        {
            "authors": [
                "J. Qin",
                "K. Poolla",
                "P. Varaiya"
            ],
            "title": "Mobile storage for demand charge reduction",
            "venue": "IEEE Transactions on Intelligent Transportation Systems, vol. 23, no. 7, pp. 7952-7962, July 2022.",
            "year": 2022
        },
        {
            "authors": [
                "A.Y.S. Lam",
                "Y. -W. Leung",
                "X. Chu"
            ],
            "title": "Electric vehicle charging station placement: formulation, complexity, and solutions",
            "venue": "IEEE Transactions on Smart Grid, vol. 5, no. 6, pp. 2846-2856, Nov. 2014.",
            "year": 2014
        },
        {
            "authors": [
                "X. Wang",
                "C. Yuen",
                "N.U. Hassan",
                "N. An",
                "W. Wu"
            ],
            "title": "Electric vehicle charging station placement for urban public bus systems",
            "venue": "IEEE Transactions on Intelligent Transportation Systems, vol. 18, no. 1, pp. 128-139, Jan. 2017.",
            "year": 2017
        },
        {
            "authors": [
                "Y. Xiong",
                "J. Gan",
                "B. An",
                "C. Miao",
                "A.L.C. Bazzan"
            ],
            "title": "Optimal electric vehicle fast charging station placement based on game theoretical framework",
            "venue": "IEEE Transactions on Intelligent Transportation Systems, vol. 19, no. 8, pp. 2493-2504, Aug. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "C. Luo",
                "Y. Huang",
                "V. Gupta"
            ],
            "title": "Placement of EV charging stations\u2014balancing benefits among multiple entities",
            "venue": "IEEE Transactions on Smart Grid, vol. 8, no. 2, pp. 759-768, March 2017.",
            "year": 2017
        },
        {
            "authors": [
                "Fastned"
            ],
            "title": "Tesla",
            "venue": "Fastned FAQ. [Online]. Available: https://support.fastned.nl/hc/en-gb/articles/360012178313-Tesla. [Accessed: 08-Aug-2023].",
            "year": 2023
        },
        {
            "authors": [
                "B. Nyland"
            ],
            "title": "Charging curves",
            "venue": "Google Sheets. [Online]. Available: https://drive.google.com/drive/folders/ 1HOwktdiZmm40atGPwymzrxErMi1ZrKPP. [Accessed: 08-Aug-2023].",
            "year": 2023
        },
        {
            "authors": [
                "H. Hotelling"
            ],
            "title": "Stability in competition",
            "venue": "The Economic Journal, vol. 39, no. 153, pp. 41\u201357, 1929.",
            "year": 1929
        },
        {
            "authors": [
                "L. Yi",
                "E. Wei"
            ],
            "title": "The effects of varying charging rates on optimal charging station choices for electric vehicles",
            "venue": "58th Annual Allerton Conference on Communication, Control, and Computing (Allerton), Monticello, IL, USA, 2022, pp. 1-5.",
            "year": 2022
        },
        {
            "authors": [
                "R. Arnott",
                "E. Inci"
            ],
            "title": "An integrated model of downtown parking and traffic congestion",
            "venue": "J. Urban Econ., vol. 60, no. 3, pp. 418-442, 2006.",
            "year": 2006
        },
        {
            "authors": [
                "W. Rudin"
            ],
            "title": "Principles of Mathematical Analysis, 3rd ed",
            "venue": "New York, USA: McGraw-Hill,",
            "year": 1976
        },
        {
            "authors": [
                "W.E. Boyce",
                "R.C. DiPrima",
                "D.B. Meade"
            ],
            "title": "Elementary differential equations and boundary value problems, 11th ed., Hoboken, NJ",
            "venue": "USA: Wiley, 2017,",
            "year": 2017
        },
        {
            "authors": [
                "I. V"
            ],
            "title": "Arnol\u2019d, Ordinary Differential Equations, 3rd ed",
            "venue": "New York, USA: Springer-Verlag,",
            "year": 1992
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n30 8.\n05 98\n2v 1\n[ cs\n.G T\n] 1\n1 A\nug 2\n02 3\nIndex Terms\u2014Electric vehicles, charging stations, varying charging rate, endogenous congestion cost, differential equation.\nI. INTRODUCTION\nTHE federal government aims to achieve a goal of making50% of new vehicles sold in the U.S. by 2030 be electric vehicles (EVs). To achieve this, they plan to establish a convenient and equitable network of 500,000 chargers to make EVs accessible for both local and long-distance trips [1]. As EVs become more widely adopted, there has been significant research into designing efficient charging infrastructures. For example, in [2] and [3], the authors study the impact of government policies on firms\u2019 investment in EV charging infrastructures. In [4], the authors design an online algorithm to assign service stations in response to EVs\u2019 battery swapping requests, based on the location of requesting EVs and the availability of fully-charged batteries at service stations in the system.\nOn the EV side, every manufacturer builds a Battery Management System (BMS) in order to keep the battery healthy and increase its longevity. The BMS captures real time\nThe authors are with Northwestern University, Evanston, IL, 60208. L. Yi is with the Department of Electrical and Computer Engineering (e-mail: lihuiyi2027@u.northwestern.edu). E. Wei is with the Department of Electrical and Computer Engineering and Department of Industrial Engineering and Management Sciences (e-mail: ermin.wei@northwestern.edu).\ninformation of the battery (e.g., temperature, charging level), negotiates with the charger for proper voltage, current and charging rate [5]. In [6], researchers study battery behavior from the empirical charging data. Due to the physical attributes of a battery, the charging rate slows down as the battery level becomes higher [7]. In particular, the U.S. Department of Transportation states that when the battery gets close to full, it can take about as long to charge the last 10 percent of an EV battery as the first 90 percent [8].\nThis work is related to the growing literature on control and optimization of EVs [9]\u2013[13], especially those studying the placement of EV charging stations and the interactions between charging stations and drivers [14]\u2013[17]. The work in [14] proposes an optimization model to formulate the EV charging station placement problem, analyzes its complexity and proposes several solution methods. In [15], the authors consider the problem of placing EV charging stations at selected bus stops, to minimize the total installation cost. In [16], to capture the competitive and strategic charging behaviors of EV users, a model considering environment factors such as queuing conditions in charging stations is proposed. In [17], researchers propose a multi-stage charging station placement strategy that takes into account the interactions among EVs, the road network, and the electric power grid. However, they often ignore EVs\u2019 varying charging rate as a function of their charging levels. Based on charging rate curves of commonly seen EVs, such as the Tesla Model 3, the charging speed at high battery levels is generally lower than that at low battery levels [18].\n0.2 0.4 0.6 0.8 1 0\n50\n100\n150\n200\n250\n300\n350\nIn this paper, we model and study the decision making process of EV drivers when choosing between two charging stations that are situated in different locations and have varying congestion levels. Our study takes into account the effects\n2 of varying charging rates of electric vehicles. Our stylized model is inspired by the classical Hotelling\u2019s model [20], where customers choose between two firms based on spatial proximity and firms choose their locations accordingly. In our case, two charging stations are situated at two extreme points on a line segment, each with a waiting time determined exogenously and/or endogenously. EVs with different battery levels and locations must decide which charging station to use to minimize their overall time cost, which includes waiting time, traveling time from their current position to the charging station, and charging time. Our prior work [21] considers a special case, where there is no endogenous congestion induced by other drivers\u2019 strategic decisions and simply assumes a fixed and predetermined waiting time. The endogenous equilibrium here is challenging due to the dependency between the optimal strategies of one single EV driver and all the other drivers, thus the method in [21] cannot be easily extended. To address this problem, we propose a differential equation based approach that involves studying an ordinary differential equation and connecting its solution to the optimal decision making of EV drivers.\nOur main contribution is the introduction of charging time function, which captures the varying levels of charging rates and the study of their impact on selecting the optimal charging station. We demonstrate that optimal strategies for EVs, given varying charging rates, differ from those with constant rates. Moreover, we model both exogenous and endogenous waiting time costs and analyze the corresponding equilibrium. Finally, numerical and field data experiments illustrate the optimal strategies for EV drivers in various scenarios.\nThe remaining sections of this paper are organized as follows. In Section II, we introduce our model. Section III analyzes the optimal strategies for EV drivers under varying charging rates. Section IV considers the scenario when charging rates are non-increasing. In Section V and VI, we present numerical case studies for exogenous model and endogenous model, respectively. In Section VII, we discuss the heterogeneous case where various charging rate characteristics are considered together in one single game. Finally, Section VIII concludes the paper."
        },
        {
            "heading": "II. MODEL",
            "text": "In this section, we present our model and define some key\nterms."
        },
        {
            "heading": "A. Charging Stations",
            "text": "We assume there are two EV charging stations, identified by Station A and Station B. Suppose the location of Station A is 0 and the location of Station B is normalized to be 1, which are two extreme points of the space we are interested in. Both charging stations offer the same product, namely electricity, to customers located on a line segment of [0, 1]."
        },
        {
            "heading": "B. EV Drivers",
            "text": "We assume there is a continuum of EV drivers located on the line segment between two charging stations and each EV\ndriver wishes to charge at one of them. The location of an EV is denoted by H \u2208 [0, 1].\nEach EV may have a different remaining battery level A \u2208 [2, AC ], where 0 < 2 < AC \u2264 1. Here, constants 2 and AC represent the power consumption to travel one unit distance and the target battery capacity level that all EVs wish to charge to, respectively. We assume the values of 2 and AC are the same for all EVs. By letting EVs\u2019 battery levels be greater than or equal to 2, all EV drivers can reach both charging stations regardless of their positions.\nEach EV driver is characterized by the parameter pair (A, H). We consider the EV drivers in the region ' corresponding to the product space of [2, AC ] \u00d7 [0, 1] with A \u2208 [2, AC ] and H \u2208 [0, 1]. These drivers need to decide simultaneously which charging stations (A or B) to charge at to minimize their overall time costs."
        },
        {
            "heading": "C. Cost Functions",
            "text": "The overall time cost function is comprised of 3 compo-\nnents: waiting time, traveling time and charging time.\n1) Waiting time: Waiting time refers to the time cost of waiting at Station A or B. Here, we introduce two separate models for waiting time: exogenous and endogenous.\nIn the exogenous model, waiting times at Station A and\nB are denoted by two non-negative constants FG and FG , respectively. This simple model was initially proposed for tractability purposes in our preliminary work [21], which assumes the waiting times to be independent of EV drivers\u2019 strategies. This assumption is reasonable when the drivers make their decisions without accounting for the other drivers.\nIn the endogenous model, we consider a more realistic scenario that waiting times vary with the number of drivers who choose a particular charging station. That is to say, the strategies of EV drivers may cause congestion and affect the value of waiting times.\nMore formally, we model the congestion as a function of the proportion of EVs that opt for a particular charging station. The more EVs choose Station A (or B), the less desirable it is on average for the other EVs. Since we assume all EV drivers make their one-shot decisions simultaneously, they all see the same congestion level. Define n (n > 0) as the congestion level when all EV drivers opt for charging station A or B. We then follow the idea in [22] and model the congestion at Station A and B as two linear functions nU and n (1 \u2212 U), respectively, where U (0 \u2264 U \u2264 1) is the proportion of EVs that choose Station A as their optimal strategy.\nFor the endogenous model, we add the congestion time to the exogenous waiting time and define the total waiting time at Station A (B) as\nF= = F G + nU, F = = F G + n (1 \u2212 U).\n2) Traveling time: Traveling time cost refers to the time taken to reach the selected charging station. We simplify the model by assuming all EVs travel at the same speed. We denote g > 0 as the unit distance traveling time or the total time taken to travel from Station A (B) to Station B (A). For\n3 an EV driver with the parameter pair (A, H), their traveling time to Station A (B) is\ngH, g(1 \u2212 H).\n3) Charging time: To model different battery sizes, we use\n( > 0) to denote the battery capacity of the EVs and % : [0, 1] \u2192 R+ as the charging rate which is a function of the state-of-charge (SoC), A. Here, we state our assumption on % below.\nAssumption 1. We consider charging rate function % to be continuous in [0, 1].\nNext, we define the charging time (A) as the time required to charge an EV from the current battery level A to the target battery capacity level AC , i.e.,\n(A) =\n\u222b AC\nA\n%(W) 3W.\nWe observe that is a continuously differentiable and strictly decreasing function [23]. Note that different make and model of EVs may have different charging rates and charging time functions. For simplicity, we first assume all EVs have the same charging characteristics. We will discuss the case of heterogeneous EVs with different % and functions in Section VII.\nFor an EV located at H with remaining battery level A, its charging time at Station A is (A \u2212 2H), where A \u2212 2H represents the remaining battery level after driving to Station A. Similarly, the charging time at Station B is (A\u2212 2(1\u2212 H)), where A \u2212 2(1 \u2212 H) is the remaining battery level upon arrival at Station B.\n4) Total time cost: The total time cost is the sum of waiting time, traveling time and charging time. Specifically, the total time cost when EVs choose Station A and Station B is written as\n) 8 (A, H) = F 8 + gH + (A \u2212 2H), ) 8 (A, H) = F 8 + g(1 \u2212 H) + (A \u2212 2(1 \u2212 H)),\nwhere 8 = G represents the exogenous model and 8 = = represents the endogenous model.\nTo understand how EV drivers make decisions, we define\n\u0394) 8 (A, H) = ) 8 (A, H) \u2212 ) 8 (A, H).\nThen, for EVs with parameter pair (A, H), three possible cases may arise. If \u0394) 8 (A, H) > 0, they should choose Station A. If \u0394) 8 (A, H) < 0, they should choose Station B. If \u0394) 8 (A, H) = 0, they are indifferent between the two charging stations. We refer to this last group as the indifferent drivers."
        },
        {
            "heading": "III. OPTIMAL STRATEGIES FOR EV DRIVERS",
            "text": "In this section, we study the optimal strategy for an EV driver associated with the parameter pair (A, H). We address the problem by first characterizing the existence and properties of the set of indifferent drivers. Then, the optimal strategies for other EVs follow naturally.\nThe set of indifferent drivers is those within region ' that have equal costs to both stations. Our preliminary work\n[21] establishes conditions for the existence of these drivers under specific assumptions. In this work, we take an alternative approach, where we first extend the region from ' : [2, AC ] \u00d7 [0, 1] to (\u2212\u221e,\u221e)\u00d7 (\u2212\u221e,\u221e). To do so, we extend the domain of function from [0, AC ] to (\u2212\u221e,\u221e), such that we preserve the continuously differentiable and strictly decreasing properties. Then we introduce the \u201cextended\u201d indifferent drivers as follows.\nDefinition 1 (Extended indifferent driver/indifference curve). Any point (A, H) in R2 with \u0394) 8 (A, H) = 0 is referred to as an extended indifferent driver. The set of extended indifferent drivers is referred to as the extended indifference curve.\nWith this definition, an indifferent driver exists whenever the intersection of ' and the extended indifference curve is nonempty. This yields a unified analysis framework for both exogenous and endogenous waiting times; and both cases where indifferent drivers are present and absent.\nTo solve the extended indifference curve, we let \u0394) 8 (A, H) =\n0, yielding\nk(A, H) = F8 \u2212 F 8 \u2212 g, (1)\nwhere we define\nk(A, H) = (A \u2212 2 + 2H) \u2212 (A \u2212 2H) \u2212 2gH,\nand 8 = G, = represents the exogenous and endogenous models, respectively.\nRegarding the preceding equation, two questions arise:\nQ1. Does there exist a solution in R2? Q2. How to solve the equation?\nWe observe that the LHS of equation (1) depends only on the charging characteristics and modeling parameters, while the RHS is dependent on different waiting time models.\nFor exogenous model, the answer to question Q1 is not obvious, but for question Q2 is straightforward. Equation (1) can be written as k(A, H) = FG \u2212 FG \u2212 g. As the RHS is a constant independent of other EV drivers\u2019 decisions, for each A, we can search for a solution of H.\nFor endogenous model, both question Q1 and Q2 are hard to answer. In this case, equation (1) is written as k(A, H) = FG \u2212FG \u2212g\u2212n+2nU. As the RHS includes the congestion U that is dependent on all EVs\u2019 strategies, it is challenging to solve the equation. Specifically, we need to know the congestion U to solve the extended indifference curve. Meanwhile, it is necessary to know the indifference curve before calculating the congestion U. This dependency or coupling effect creates the challenge of solving equation (1) for endogenous model.\nMotivated by addressing this dependency and unifying two waiting time models, we propose an equivalent reformulation using ordinary differential equation (ODE). The idea is as follows. Since we assume all EV drivers see the same congestion U, the RHS of equation (1) remains the same as A varies. Then, by taking the derivatives of both sides of equation (1) with respect to A, the term involving U goes away and thus the aforementioned \u201ccoupling effect\u201d disappears. Therefore,\n4 for an extended indifferent driver, we find H as a function of A by studying the ODE as follows,\n( 2 \u2032 (A \u2212 2 + 2H) + 2 \u2032 (A \u2212 2H) \u2212 2g ) 3H\n3A\n= \u2212 ( \u2032 (A \u2212 2 + 2H) \u2212 \u2032 (A \u2212 2H) ) . (2)\nBy construction, we set the derivative of k to 0 and see that the general solution of the preceding ODE has the form k(A, H) = :, where : is an arbitrary constant. Combining with an appropriate initial condition, equation (1) can be solved.\nFor the remainder of this section, we first present preliminary results. Then, Theorem 1-3 prove the existence of extended indifference curve and give the appropriate initial conditions to ODE in (2) for exogenous and endogenous models, respectively."
        },
        {
            "heading": "A. Preliminaries",
            "text": "In this subsection, we provide some basic properties related to the previous ODE, which can be used in both exogenous and endogenous models.\nLemma 1 shows the monotonicity of function k. Lemma 2 proves that the general solution of ODE in (2) is a welldefined function. In Lemma 3, we formally introduce the initial value problem (IVP) and then characterize the solutions to such problem. Lemma 4-6 further describe some properties regarding the general solution of ODE.\nLemma 1. Given any A \u2208 R, k(A, \u00b7) is strictly decreasing in R.\nProof. Since is differentiable, we observe that k(A, H) =\n(A \u2212 2 + 2H) \u2212 (A \u2212 2H) \u2212 2gH is also differentiable. Then,\nwe take its partial derivative with respect to H and obtain\nmk(A, H)\nmH = 2 \u2032 (A \u2212 2 + 2H) + 2 \u2032 (A \u2212 2H) \u2212 2g.\nWith being strictly decreasing, its first order derivative is negative and so on we have mk(A, H)/mH < 0 for any H \u2208 R. Hence, k(A, \u00b7) is strictly decreasing.\nRecall that the general solution to ODE in (2), if exists, is given by k(A, H) = :, where : is an arbitrary constant. In the following lemma, we show the existence and uniqueness of such a solution.\nLemma 2. For any constant : \u2208 R, there exists one and only one value H \u2208 R such that k(A, H) = : for any A \u2208 R.\nProof. To show the existence, we observe that is continuous and strictly decreasing, we then have for all A, limH\u2192\u221e k(A, H) = \u2212\u221e < 0, limH\u2192\u2212\u221e k(A, H) = \u221e > 0. Therefore, by the intermediate value theorem, there exists a value H \u2208 R such that k(A, H) = :.\nThe uniqueness of H follows from the strict monotonicity\nof k(A, \u00b7) as established in Lemma 1.\nFrom Lemma 2, we learn that the general solution of ODE in problem (IVP) is given by k(A, H) = : with an arbitrary constant :. It implicitly defines a function mapping 6 such that H = 6(A). The initial condition is naturally given by that\nconstant : \u2208 R. However, this form of initial condition does not give any insight about the extended indifference curve, we here introduce an alternative initial condition H(AC ) = I with I \u2208 R. For the rest of the paper, we focus on this formulation.\nLemma 3. Consider the following initial value problem\n( 2 \u2032 (A \u2212 2 + 2H) + 2 \u2032 (A \u2212 2H) \u2212 2g ) 3H\n3A (IVP)\n= \u2212 ( \u2032 (A \u2212 2 + 2H) \u2212 \u2032 (A \u2212 2H) ) ,\nH(AC ) = I.\nThe initial conditions H(AC ) = I with I \u2208 R and k(A, H) = : with : \u2208 R are equivalent.\nProof. By Lemma 1, k(AC , I) is strictly decreasing in I \u2208 R. Hence, k(AC , \u00b7) is a one-to-one mapping function. Since limI\u2192\u221e k(AC , I) = \u2212\u221e and limI\u2192\u2212\u221e k(AC , I) = \u221e, function k(AC , \u00b7) maps from R to R. Therefore, every value of I \u2208 R corresponds to a distinct value of : \u2208 R with : = k(AC , I) and vice versa. Hence, we conclude that the two initial conditions k(A, H) = : and H(AC ) = I are equivalent.\nThe preceding results suggest that there is a unique solution H = 6(A), where 6 is a function well defined in A \u2208 R and is determined implicitly by k(A, H) = k(AC , I). We note that we may use any vertical slice H(\u00b7) as the initial condition of problem (IVP). We will discuss the reason of choosing H(AC ) in Remark 1.\nIt is worth noting that the more general Picard\u2019s existence and uniqueness theorem for first order initial value problems is not applicable, as it requires additional smoothness assumption on function [24].\nCorollary 1. As the initial value I varies, the curves of any two solutions of problem (IVP) cannot intersect each other.\nProof. By Lemmas 2-3, if any two solutions intersect, there will be two solutions that satisfy problem (IVP) with the same initial condition corresponding to the intersection point, which contradicts to the uniqueness.\nBy regarding the initial value I as an independent variable, the solution of problem (IVP) is also a function of I. Therefore, for the rest of the paper, we abuse the notation and write H as a function of both A and I, i.e., H = 6(A, I). In Lemma 4-6, we show that 6(A, I) is continuous in I.\nLemma 4. With a fixed A \u2208 R, 6(A, \u00b7) is non-decreasing and limI\u21920 6(A, I) exists for any 0 \u2208 R.\nProof. We first prove the monotonicity. Clearly 6(A, \u00b7) is nondecreasing when A = AC , as the initial value of problem (IVP) is 6(AC , I) = I. For the case of A \u2260 AC , we assume the contrary that there exists I1, I2 \u2208 R with I2 > I1 such that 6(A, I1) > 6(A, I2). Denote \u03946(A) = 6(A, I1) \u2212 6(A, I2). Since 6(A, I) is continuous with respect to A, \u03946(A) is continuous in R. Hence we have \u03946(A) > 0 and \u03946(AC ) < 0. By intermediate value theorem, there exists a A\u2032 between A and AC such that \u03946(A \u2032) = 6(A\u2032, I1) \u22126(A \u2032, I2) = 0. However, this contradicts Corollary 1, which shows that any two solutions of problem (IVP) cannot intersect each other. Therefore, 6(A, \u00b7) is non-decreasing.\n5 Next, we prove the existence of the limit. The monotonicity\nimplies that, with any fixed A \u2208 R, the one-sided limits limI\u21920\u2212 6(A, I) and limI\u21920+ 6(A, I) exist for any 0 \u2208 R [23]. Then, limI\u21920 6(A, I) exists if and only if the two limits are equal.\nWe assume that limI\u21920\u2212 6(A, I) \u2260 limI\u21920+ 6(A, I) for some A and 0. According to the strict monotonicity of k(A, \u00b7) shown in Lemma 1, there holds\n:1 = k(A, lim I\u21920\u2212 6(A, I)) \u2260 k(A, lim I\u21920+ 6(A, I)) = :2,\nfor some scalars :1, :2. Since H = 6(A, I) is determined implicitly by k(A, H) = k(AC , I), we have I = 6(AC , I) and thus the following inequality,\n:1 = k(AC , lim I\u21920\u2212 I) \u2260 k(AC , lim I\u21920+ I) = :2.\nAgain, by Lemma 1, the preceding inequality implies that limI\u21920\u2212 I \u2260 limI\u21920+ I, which is not true. Therefore, limI\u21920 6(A, I) exists for any A, 0 \u2208 R.\nLemma 5. For any A, 0 \u2208 R, the following equation holds,\nlim I\u21920 k(A, 6(A, I)) = k(A, lim I\u21920 6(A, I)).\nProof. By continuity of function k and the existence of limI\u21920 6(A, I), the statement can be established.\nLemma 6. For any A \u2208 R, function H = 6(A, I) is continuous with respect to I.\nProof. For any initial value I \u2208 R, we have k(A, 6(A, I)) = k(AC , I). Suppose we add a small perturbation \u0394 around I, then, the following equation holds for any A \u2208 R,\nk(A, 6(A, I + \u0394)) = k(AC , I + \u0394)\n= (AC \u2212 2 + 2I + 2\u0394) \u2212 (AC \u2212 2I \u2212 2\u0394) \u2212 2g(I + \u0394).\nBy the continuity of , we have\nlim \u0394\u21920 (AC \u2212 2 + 2I + 2\u0394) = (AC \u2212 2 + 2I),\nlim \u0394\u21920 (AC \u2212 2I \u2212 2\u0394) = (AC \u2212 2I),\nwhich imply\nlim \u0394\u21920 k(AC , I + \u0394) = (AC \u2212 2 + 2I) \u2212 (AC \u2212 2I) \u2212 2gI\n= k(AC , I).\nTherefore,\nlim \u0394\u21920 k(A, 6(A, I + \u0394)) = k(AC , I) = k(A, 6(A, I)).\nFrom Lemma 5, the preceding equation can be rewritten as\nk(A, lim \u0394\u21920 6(A, I + \u0394)) = k(A, 6(A, I)).\nAccording to Lemma 1, k(A, \u00b7) is strictly decreasing in R. It follows that\nlim \u0394\u21920\n6(A, I + \u0394) = 6(A, I),\nthus 6(A, I) is continuous in I \u2208 R.\nTo summarize we show that the solution of problem (IVP)\ndepends continuously on the initial value I. 1\n1Note that though there is existing ODE theorem [25] implying a similar continuous dependence of an initial value problem, it requires additional smoothness conditions on , and hence is not applicable here."
        },
        {
            "heading": "B. Exogenous Waiting Time Model",
            "text": "In this subsection, we present the following theorem for exogenous model. It shows the existence of extended indifference curve. Combine with Lemma 3, the question Q1 and Q2 are answered. Furthermore, the optimal strategies for all EV drivers in region ' are derived.\nTheorem 1. In the exogenous waiting time model, there exists an initial value I satisfying\nk(AC , I) = F G \u2212 F G \u2212 g. (3)\nDenote the corresponding solution of problem (IVP) by 6(A, I). For any A in the region ', the optimal strategy of EV associated with the pair (A, H) is as follows:\n\u2022 Choose Station A if H < 6(A, I); \u2022 Choose Station B if H > 6(A, I); \u2022 Be indifferent if H = 6(A, I).\nProof. First, as the right hand side of equation (3) is a constant, such initial value I satisfying equation (3) exists and is unique.\nUsing the definition of total time cost in Section II, we then\nobtain \u0394) G (A, H) = k(A, H) + g + FG \u2212 FG for any A. With I satisfying equation (3), we have \u0394) G (A, 6(A, I)) = 0. Lemma 1 implies that k(A, H) and thus \u0394) G (A, H) are strictly decreasing in H \u2208 R. If H < 6(A, I), then \u0394) G (A, H) > 0, implying that the optimal strategy is to choose Station A. On the other hand, if H > 6(A, I), then \u0394) G (A, H) < 0, so the optimal choice is to opt for Station B. The case of H = 6(A, I) implies that \u0394) G (A, H) = 0, meaning the EV driver is indifferent between two charging stations.\nThe function 6(A, I) stated in Theorem 1 is the extended indifference curve. If the intersection of the region ' and 6(A, I) is empty, all EV drivers in ' strictly prefer the same charging station. Otherwise, there exists at least one driver in ' who is indifferent between the two charging stations and people on either side of the indifference curve choose different charging stations. In Section V we illustrate some examples of indifference curves by numerical simulations."
        },
        {
            "heading": "C. Endogenous Waiting Time Model",
            "text": "In the aforementioned exogenous model, EV drivers make decisions without taking into account the strategies of other drivers. However, a more rational decision maker will also respond to the strategies of other drivers. Therefore, we further study the endogenous model, where EV drivers consider not only the exogenous waiting times, but also the congestion at two charging stations. We assume that the parameter pairs (A, H) of EV drivers are uniformly distributed in the region '.\nBefore delving into the main theorem for endogenous model, we need to establish another preliminary result related to the monotonicity and continuity of an integration. Specifically, we define\n(I) = 1\nAC \u2212 2\n\u222b AC\n2\n\u210e(A, I)3A,\nwhere \u210e(A, I) = min{1,max{0, 6(A, I)}}.\n6 The integration (I) can be interpreted as the integral of\n6(A, I) intersecting region '. In the following lemma, we show the properties of this integration.\nLemma 7. (I) is a bounded, non-decreasing and continuous function.\nProof. According to the definition of \u210e(A, I), (I) is naturally lower bounded by 0 and upper bounded by 1.\nThe monotonicity follows from Lemma 4. To prove the continuity, we use the property that 6(A, I) is continuous in I by Lemma 6. That says, for any A \u2208 R and I \u2208 R and every Y > 0, there exists a X > 0 such that\n|\u210e(A, I) \u2212 \u210e(A, I\u2032) | < Y,\nfor all points I\u2032 \u2208 R satisfying |I \u2212 I\u2032 | < X.\nThen we have\n| (I) \u2212 (I\u2032) | = 1\nAC \u2212 2\n\u222b AC\n2\n\u210e(A, I)3A \u2212\n\u222b AC\n2\n\u210e(A, I\u2032)3A\n\u2264 1\nAC \u2212 2\n\u222b AC\n2\n\u210e(A, I) \u2212 \u210e(A, I\u2032) 3A\n< 1\nAC \u2212 2 Y(AC \u2212 2)\n= Y.\nHence, (I) is continuous in I.\nWith the proper initial value I, 6(A, I) is the extended indifference curve, then the integration (I) represents the congestion U. Formally, we first give the optimal strategies of EV drivers in the next theorem, assuming the extended indifference curve exists. Then, we find the appropriate initial value I such that this existence is guaranteed. In this way, the two questions Q1 and Q2 are naturally answered.\nTheorem 2. If 6(A, I) is the extended indifference curve, the optimal strategy of EV associated with the pair (A, H) is as follows:\n\u2022 Choose Station A if H < 6(A, I); \u2022 Choose Station B if H > 6(A, I); \u2022 Be indifferent if H = 6(A, I).\nProof. We first write the total time cost defined in Section II,\n\u0394)= (A, H) = k(A, H) + g + FG \u2212 F G + n \u2212 2nU,\nwhere U \u2208 [0, 1] represents the proportion of EVs that choose Station A as their optimal strategy. If 6(A, I) is indeed the extended indifference curve, it satisfies \u0394)= (A, 6(A, I)) = 0. Since we assume all EV drivers see the same congestion when making decisions, Lemma 1 implies that \u0394)= (A, H) is strictly decreasing in H. Therefore, we have the following observations. If H < 6(A, I), then \u0394)= (A, H) > 0, implying that the optimal strategy is to choose Station A. On the other hand, if H > 6(A, I), then \u0394)= (A, H) < 0, so the optimal strategy is to choose Station B. The case of H = 6(A, I) implies that \u0394)= (A, H) = 0, meaning the EV driver is indifferent between two charging stations.\nTheorem 3. In the endogenous waiting time model, there exists an initial value I satisfying\nk(AC , I) = F G \u2212 F G \u2212 g \u2212 n + 2n (I), (4)\nsuch that the corresponding solution of problem (IVP), denoted by 6(A, I), is the extended indifference curve.\nProof. First, we show that there exists one and only one value of I \u2208 R such that equation (4) is satisfied. Denote\nd(I) = k(AC , I) + g + F G \u2212 F G + n \u2212 2n (I).\nBy Lemma 1 and Lemma 7, we observe that d(I) is continuous and strictly decreasing. As (I) is bounded, we have limI\u2192\u2212\u221e d(I) = \u221e and limI\u2192\u221e d(I) = \u2212\u221e. Therefore, by the intermediate value theorem, there exists an initial value I \u2208 R such that d(I) = 0 and so on equation (4) is satisfied. The uniqueness follows from the strict monotonicity of d(I).\nBy letting d(I) = 0, we observe that 6(A, I) is the extended indifference curve satisfying \u0394)= (A, 6(A, I)) = 0, while the integral (I) measures the proportion of drivers who choose Station A, i.e., the congestion U.\nFinally, we conclude this section by comparing with our preliminary work [21]. In this paper, we first extend region ' and introduce the concept of extended indifferent driver. Then we propose a unified ODE-based formulation for both exogenous and endogenous models, prove the existence of extended indifference curve and give the appropriate initial conditions to the ODE. In comparison, our preliminary work focuses on the exogenous model. It first derives the existence conditions of indifferent drivers in region ', and then analyzes the properties of indifference curve under specific assumptions. However, that method cannot be directly extended to endogenous model due to the dependency of congestion and strategies. The advantage of ODE approach is that it provides an efficient way to solve the endogenous model and gives a unified framework for both waiting time models. In fact, the exogenous model can be regarded as a special case of endogenous model by letting n = 0.\nSince we extend the region for analysis convenience, the resulting extended indifference curve may lie outside the physically feasible region '. In the next section, we characterize the conditions for which it is in '."
        },
        {
            "heading": "IV. CHARACTERISTICS OF THE EXTENDED INDIFFERENCE CURVE",
            "text": "Recall that we assume the charging rate function % to be continuous and the charging time function is defined as (A) = \u222b AC\nA /%(W)3W. In Section III, we consider the\ncharging rate function % in its general form, with the only assumption being its continuity. In practice, as shown in Fig. 1, EVs\u2019 charging rate is typically non-increasing as the state-ofcharge increases. Therefore, we formally make the following assumption in this section.\nAssumption 2. We consider charging rate function % to be non-increasing in [0, 1].\nLemma 8. The charging time function is concave.\n7 Proof. Since is differentiable, we take the first order derivative as \u2032 (A) = \u2212 % (A ) . By definition and Assumption 2, %(A) is strictly positive and non-increasing. Hence \u2032 (A) is (weakly) decreasing and so on is concave.\nWe then identify the weak monotonicity of the extended\nindifference curve under Assumption 2.\nTheorem 4. For both exogenous and endogenous models, the solution H = 6(A, I) of problem (IVP) has the following properties for all A \u2208 R:\n\u2022 If I = 1/2, 6(A, I) = 1/2; \u2022 If I < 1/2, 6(A, I) < 1/2 and is non-decreasing in A; \u2022 If I > 1/2, 6(A, I) > 1/2 and is non-increasing in A.\nProof. When I = 1/2, we verify that H = 6(A, I) = 1/2 is a solution of problem (IVP) by observing that A\u22122+2H = A\u22122H = A \u2212 2 2 and the ODE reduces to 3H 3A = 0. According to Lemma 2 and 3, the solution is unique. Thus, we have 6(A, I) = 1/2 for all A \u2208 R.\nIf I < 1/2, by Corollary 1, 6(A, I) < 1/2 for all A \u2208 R. Otherwise, it will intersect the solution with the initial value being I = 1/2. To demonstrate the monotonicity of H = 6(A, I) with respect to A, it is equivalent to showing 3H/3A \u2265 0 for any A \u2208 R. We assume the contrary that there exists one A such that 3H/3A < 0. As H = 6(A, I) < 1/2, we have A \u2212 2H > A \u2212 2 + 2H. Then the LHS of the ODE in (2) is positive since is strictly decreasing, which contradicts the RHS being non-positive due to the concavity of . Therefore, 6(A, I) is non-decreasing in A when I < 1/2.\nThe case of I > 1/2 can be established similarly.\nIntuitively, as Station A is at H = 0 and Station B is at H = 1, the two charging stations are symmetric around H = 1/2. If I = 1/2, there is an indifferent driver at (AC , 1/2). In this case, even if we exchange the positions of Station A and B, the extended indifference curve should remain the same. Thus, we shall have 6(A, I) = 1/2 for all A \u2208 R as stated in Theorem 4. On the other hand, if I < 1/2, 6(A, I) should also be symmetric with respect to the line H = 1/2, compared to the case when I > 1/2. Furthermore, we see that the extended indifference curve is weakly monotonic by assuming the monotonicity of charging rates. Then, we show the necessary and sufficient condition under which an indifferent driver exists in region '.\nCorollary 2. In the exogenous model, an indifferent driver exists in region ' if and only if the following condition holds\n(AC \u2212 2) \u2212 (AC ) \u2265 \u2212g + |F G \u2212 F G |. (5)\nProof. Based on Theorem 1 and 4, we observe that an indifferent driver exists in ' if and only if the initial value I satisfies both equation (3) and 0 \u2264 I \u2264 1. Using Lemma 1, we find that k(AC , I) is strictly decreasing in I. Therefore, an equivalent characterization is\nk(AC , 1) \u2264 \u2212g \u2212 F G + F G \u2264 k(AC , 0),\nwhich yields inequality (5).\nWith charging rate non-increasing as the state-of-charge increases, we can infer that when inequality (5) is violated\nfor exogenous model, all EVs will choose the same charging station as their optimal strategies. This scenario is more likely to occur when one of the following conditions is met:\n1) The waiting time difference, |FG \u2212 FG |, is large; 2) The unit distance traveling time, g, is small; 3) The power consumption per unit distance, 2, is small; 4) The target battery capacity level, AC , is small.\nFrom an EV\u2019s perspective, two charging stations appear identical except for the waiting time difference. Hence, all EV drivers are inclined to select the station with the lower waiting time, especially when the difference is large. Furthermore, if the unit distance traveling time and the power consumption over unit distance approach zero, that is, g, 2 \u2192 0, i.e., it is cheap to travel, then even a small waiting time difference may cause all EV drivers to choose the same charging station and leave the other station completely idle. The last condition is due to the concavity of as verified by real-world data that charging time from 20% to 40% is much shorter than 80% to 100% (full battery). In this case, the overall cost of charging is dominated by the waiting/travel time if only charging to a smaller AC . Consequently, in the exogenous model, it is likely that all drivers head to one charging station with a shorter waiting time, whereas the rational EV drivers should anticipate that the once-idle charging station would soon become congested. This phenomenon is alleviated in the endogenous model.\nCorollary 3. In the endogenous model, an indifferent driver exists in region ' if and only if the following condition holds\n(AC \u2212 2) \u2212 (AC ) \u2265 \u2212g \u2212 n + |F G \u2212 F G |. (6)\nProof. The proof follows from Theorem 3 and 4, which indicates that an indifferent driver exists if and only if the initial value I satisfies the conditions 0 \u2264 I \u2264 1 and equation (4). Denote\nd(I) = k(AC , I) + g + F G \u2212 F G + n \u2212 2n (I).\nLemma 1 and Lemma 7 ensure that d(I) is continuous and strictly decreasing in I. Therefore, an equivalent characterization is\nd(0) \u2265 0 \u2265 d(1),\nwhere (0) = 0 and (1) = 1. Simplifying the preceding inequalities leads to inequality (6).\nRemark 1. In problem (IVP), we could have chosen any other vertical slice H(\u00b7) as the initial condition rather than H(AC ). However, 0 \u2264 H(AC ) \u2264 1 is the only \u201ctight\u201d condition for the existence of indifferent driver in ', due to the monotonicity of 6(A, I) shown in Theorem 4.\nCompared with inequality (5), we observe that whenever there is an indifferent driver for exogenous model, there must be one for endogenous model as well. The reverse is not true. The inequality (6) is more likely to be violated under the same four conditions discussed above for exogenous model. Furthermore, as n decreases, the impact of congestion is reduced. Thus, the difference in exogenous waiting times, i.e., |FG \u2212 FG |, becomes more substantial and EV drivers\n8 are more likely to choose the same charging station with the lower exogenous waiting time. In Section V and VI, we will numerically show the impact of parameters and compare the results of two waiting time models."
        },
        {
            "heading": "V. NUMERICAL CASE STUDY FOR EXOGENOUS MODEL",
            "text": "In this section, we use numerical case studies to showcase the optimal strategies that EVs with different locations and remaining battery levels adopt under the exogenous waiting time model. Specifically, we examine how charging rate functions, exogenous waiting times, unit distance traveling time and power consumption over the unit distance impact the strategies employed by EVs. To illustrate the charging decisions, we depict the region ' as a rectangle in Cartesian coordinate system where A is the horizontal axis and H is the vertical axis. We plot the indifference curve that shows all the indifferent EV drivers. According to Theorem 1, the lower region below the curve contains all EVs that select Station A as their optimal strategies, while the upper region includes all EVs that choose Station B as optimal strategies."
        },
        {
            "heading": "A. The impact of charging rate characteristics",
            "text": "We first examine the impact of charging rate characteristics as shown in Fig. 2, where we set 2 = 0.2, g = 1, AC = 1, FG = 0.5 and FG = 0. Fig. 2(a) shows the (weakly) decreasing charging rate curves for each charging time function, while Fig. 2(b) shows the corresponding indifference curves. With an analytical expression of the charging time function, the indifference curve 6 can be explicitly solved. When charging rate is a constant, i.e., (A) = 1 \u2212 A, the indifference curve is a line parallel to A-axis. It divides the region ' into two parts around H = 0.29. Here, we observe that fewer EVs use Station A than B. This is potentially due to the longer waiting time at Station A. Thus, some EVs close to Station A are willing to spend slightly increased traveling and charging times for an exchange of a much lower waiting time at Station B.\nHowever, when charging rate is strictly decreasing, i.e.,\n(A) = 1 \u2212 A2, and other parameters remain the same, the indifference curve becomes an increasing function. For EVs located near the previous indifference curve with H values close to 0.29, since the charging speed is faster with low remaining battery levels, more EVs with small values of A\nwould be willing to travel a bit further and take Station B as their optimal strategies instead of Station A comparing to the linear charging time function case. What is happening here is that their charging time difference at two stations is much reduced due to the fast charging speed at low battery capacities. Meanwhile, the traveling times and waiting times for both stations remain the same as in the linear case. Therefore, such EVs tend to choose Station B instead. On the other hand, more EVs with large values of A choose Station A as their optimal strategy rather than Station B. This is due to the slower charging rate when the battery is nearly full. These vehicles opt for a closer charging station to balance the tradeoff between traveling time, charging time and waiting time.\nWhen charging rates change more dramatically with A, i.e., (A) = 1 \u2212 A3, the aforementioned phenomena become more evident. Specifically, more EVs with small remaining battery levels opt for Station B, while more EVs with large remaining battery levels choose Station A, in comparison to both previously mentioned cases.\nIt is worth noting that all charging time functions in this subsection take the same value of (0), meaning that the same amount of time is required to charge an EV from empty to full, regardless of the variation in instantaneous charging rates. As a result, the indifference curves of three cases are close to each other."
        },
        {
            "heading": "B. The impact of average charging speed",
            "text": "Next, we further consider the impact of average charging speed that EV has to charge from empty to full, which can be reflected by (0). The parameters are set as 2 = 0.2, g = 1, AC = 1, F G = 0.5 and FG = 0. Fig. 3(a) illustrates the charging rate curves and Fig. 3(b) shows the indifference curves. Specifically, the charging time functions (A) = 8(1\u2212 A2) and\n(A) = 4(1\u2212A2) model the real-world scenario of using a level 2 charging, while the remaining cases correspond to a DC fast charging or supercharging [8]. As the overall charging process speeds up, the indifference curve shifts downwards and more EV drivers tend to choose Station B as their optimal strategy, regardless of the remaining battery levels. This is because the charging time difference between two stations decreases as the charging time is generally reduced. It results in more EVs opting to choose a station far away but with a significantly lower waiting time.\n9"
        },
        {
            "heading": "C. The impact of modeling parameters",
            "text": "In this subsection, we investigate the impact of modeling parameters on the optimal strategies of EVs, including exogenous waiting times at charging stations, unit distance traveling time and power consumption over unit distance. The corresponding indifference curves are depicted in Fig. 4. Before delving into the details, we set AC = 1, (A) = 1 \u2212 A 2 and FG = 0 as unchanged parameters. In the first case, we assume 2 = 0.2, g = 1 and FG = 0.5.\nSubsequently, we examine the scenario where the waiting\ntime at Station A is longer, i.e., FG = 1, while the other parameters remain the same. In this case, the indifference curve shifts downwards and gets closer to Station A, indicating that more EVs prefer to choose Station B as their optimal strategy. The reason for this can be attributed to the fact that when the waiting time at Station A increases, EV drivers who would have chosen Station A may opt for Station B instead, as the total time cost at Station A has increased. In the extreme case where FG is infinitely large, the optimal strategies for all EVs are to charge at Station B since they will never start charging at Station A.\nFurthermore, we lower the unit distance traveling time g to 0.5 while keeping the other parameters the same as in the first case. As a result, the indifference curve shifts towards Station A. This can be explained by the fact that the importance of traveling time cost diminishes when the unit distance traveling time decreases. Therefore, some EV drivers who are restricted by the large traveling time and decide to choose Station A are no longer concerned about that and may choose Station B instead.\nFinally, we investigate the impact of power consumption over unit distance, 2, by decreasing it to 0.1 while keeping the other parameters the same as in the first case. As shown in Fig. 4, the indifference curve slightly shifts downwards towards Station A. Thus, more EVs tend to choose Station B for charging. The reason is as follows. When 2 is small, the power consumed by EVs during their travels to charging stations is also reduced. As a result, the remaining battery levels upon arrival at two charging stations become almost the same, regardless of their initial positions. For EVs on the indifference curve in the first case, they are indifferent to both choices even if the charging time at Station B is larger than that at Station A. Therefore, if the charging time difference is reduced or even eliminated, these previously indifferent drivers will choose Station B instead as their optimal strategy, causing the indifference curve to shift downwards when 2 decreases."
        },
        {
            "heading": "D. Field data test",
            "text": "Using the field data and charging rate curves shown in Fig. 1, we plot the indifference curves in Fig. 5 with the parameters of 2 = 0.2, g = 1, AC = 1, F G = 0.5 and FG = 0. As evidenced by the real-world data, the charging rates decrease as the charge level increases. Generally speaking, with lower remaining battery levels, more EV drivers should opt for a farther charging station in order to achieve a lower overall time cost. This finding is interesting because EV drivers with low battery levels may have charging anxiety. So psychologically, they would have a stronger willingness to opt for a closer charging station than those people with high battery levels. However, our findings show that things should be the opposite if they are rational people. Besides of that, the results also suggest that charging station selection of EV owners will be significantly influenced by their car\u2019s charging curve characteristics."
        },
        {
            "heading": "VI. NUMERICAL CASE STUDY FOR ENDOGENOUS MODEL",
            "text": "In this section, we focus on endogenous model and compare our findings with those obtained from the exogenous model. First, we explore cases with explicit charging rate functions and present the optimal strategies for EV drivers. Here the charging rates are considered to be flat, decreasing and piecewise flat. Subsequently, we conduct a field data test based on the charging rates shown in Fig. 1."
        },
        {
            "heading": "A. Flat charging rates",
            "text": "We first investigate the case of flat charging rates, where the charging time function is set as (A) = 1 \u2212 A. This is the simplest case, as the charging speed is constant, regardless of the remaining battery levels. With the parameters set as FG = 1, FG\n= 0, g = 1, 2 = 0.2, AC = 1 and n = 1, Fig. 6(a)\ncompares the indifference curve obtained using exogenous and endogenous models, denoted by 6G and 6=, respectively. We observe that there is a large gap between two indifference curves, due to the presence of congestion in endogenous model."
        },
        {
            "heading": "B. Decreasing charging rates",
            "text": "Next, we consider the decreasing charging rates scenario and assume the charging time function to be (A) = 1 \u2212 A2.\n10\nWith the same parameters, the indifference curve is shown and compared in Fig. 6(b). Similar to the first case, as the congestion at Station B is higher than A, more EV drivers choose Station A instead to avoid the congestion."
        },
        {
            "heading": "C. Piecewise flat charging rates",
            "text": "In this subsection, we study a more practical case where the charging rates are piecewise flat. It corresponds to the scenario where the charging rate significantly drops after the battery level exceeds a certain threshold. An example of such charging rate characteristic is Ford Mustang Mach-e, where the charging speed decreases once the battery level reaches 80%. For simplicity, we let the charging rate curves be piecewise flat, as shown in Fig. 7(a). With the same parameters, the resulting indifference curve is demonstrated in red in Fig. 7(b). Meanwhile, the curve in blue is the indifference curve of exogenous model.\nCombining all scenarios together, we see that the inclusion of endogenous waiting times in the model reveals a significant difference in the indifference curves and the optimal strategies, compared to the exogenous results. More EVs choose not to wait at a more \u201ccrowded\u201d charging station. Many of those who previously opt for Station B now switch to Station A. Although they suffer from a longer exogenous waiting time at Station A, the congestion time they experience is much reduced since only a few people may be waiting at that charging station. This shows the impact of considering endogenous model on EVs\u2019 charging station choices."
        },
        {
            "heading": "D. Field data test",
            "text": "Finally, we present the results of testing on real-world data. To perform this experiment, the parameters are set as 2 = 0.2, g = 1, AC = 1, F G = 0.5, FG = 0 and n = 1. The charging rates used in this experiment are the same as those shown in Fig. 1. The solutions 6(A, I), or say indifference curves, are plotted in Fig. 8, and the results are compared to those obtained using the exogenous model.\nWe find that many EVs change their optimal strategies from Station B to Station A since the congestion at Station B is larger than that at Station A. The values of UAudi, UFord and UTesla, which are the proportions of EVs of each make and model that choose Station A as their optimal strategies, are calculated to be 0.3814, 0.3876 and 0.3837, respectively."
        },
        {
            "heading": "VII. CASE STUDY ON HETEROGENEOUS MODEL",
            "text": "In this section, we discuss the heterogeneous model, where different EVs may possess distinct charging rate characteristics. From the previous sections, we have seen that different charging rate characteristics lead to different indifference curves and thus different optimal strategies. Therefore, we are interested in the case when EVs are mixed, for example, one half drives Tesla and the other half drives Audi, and how their strategies may be affected by each other.\nTo effectively model the behavior of these diverse EVs, we classify them into multiple classes, say < classes, based on their charging rate characteristics. Denote the charging rate and time functions by %1, . . . , %< and 1, . . . , <, respectively. Additionally, we assign a normalized weight to each class, denoted by ,1, . . . ,,<, reflecting the number of EVs in each class. Note that all weights add up to 1, i.e., \u2211<\n8=1 ,8 = 1.\nIn exogenous waiting time model, each class of EVs has its own initial value problem and associated solution, which means that the optimal strategies for each class of EVs are not affected by other classes of users.\nHowever, in endogenous waiting time model, the solutions to the initial value problem and optimal strategies for each class of EVs are coupled with the other classes. This means that the behavior of one class affects the behavior of other classes, leading to changes in their charging strategies and resulting in a more complex decision making process. Specifically, when considering the endogenous model with multiple classes of EVs, the interaction between the classes can lead to new patterns of behavior. For example, some classes may prioritize charging at one station over the other one, leading to high congestion. Mathematically, the problem can be formulated as solving a system of first order ordinary differential equations with an initial value that combines the weighted solutions of each ODE. Note that our theory only works for < = 1, but the approach is general and can be extended to the case of < > 1. We leave the technical details as future work and present an experimental result here.\nIn < > 1 setup, is defined as the weighted sum of integral of ODE solutions 61, . . . , 6< intersecting region '. With appropriate initial conditions, coincides with the congestion U. Numerically, we solve it by iteratively altering the initial conditions so that the difference between and U is minimized. To demonstrate how the heterogeneous model differs from the single-class homogeneous model, we use the same field data as before, with the parameters being 2 = 0.2, g = 1, AC = 1, F G = 0.5, FG = 0 and n = 1. In this case, we\n11\nassume that the EVs consist of Audi, Ford and Tesla users, with the same weight for each class, i.e., ,1 = ,2 = ,3 = 1/3.\nThe charging rate functions are shown in Fig. 1. The\nindifference curves are illustrated in Fig. 9, where 6= 1 , 6= 2 and 6= 3 represent the indifference curves for each class. We also compare these results with the single-class case using the endogenous waiting time model, as shown by 6=. In this experiment, for each class we calculate\nV8 = The number of EVs in class 8 that choose A\nThe total number of EVs in class 8 ,\nand obtain V1 = 0.3787, V2 = 0.3903 and V3 = 0.3832.\nAfter accounting for the mutual effects between different classes of EVs, we observe that more Audi users opt for Station B while more Ford users opt for Station A. This is because Audi users generally have faster charging rates, making their charging time difference at two stations relatively small. Therefore, they are more likely to travel a bit further to tradeoff their charging time and waiting time. As a consequence, the indifference curve shifts downwards. In contrast, Ford users have slower charging rates and are more likely to choose a closer station. Moreover, by taking Audi users as an example, we find that the total time cost of indifferent drivers in heterogeneous case (plotted as Audi, 6= 1 ) is slightly increased compared to homogeneous case (plotted as Audi, 6=). The reason is due to the increase in congestion level at Station A. On the other hand, the indifferent drivers in Ford class, who have slower charging rates, get a slightly reduced total time cost when Audi and Tesla users participate. Therefore, as the EV users with the slowest charging rates, they actually benefit from those EVs with faster charging rates. This highlights the externalities EV drivers impose on each other."
        },
        {
            "heading": "VIII. CONCLUSION",
            "text": "We study the charging station selection problem with the consideration of varying charging rates. Our work introduces an ODE approach to derive the optimal strategies for EV drivers considering both exogenous and endogenous models. In the exogenous model, each EV has a fixed, predetermined waiting time that is not influenced by the behavior of other EVs. On the other hand, the endogenous model takes into account the impact of other EVs, where an EV\u2019s waiting time is affected by the charging decisions of others. We find that even if EVs have the same location, their optimal strategies might be opposite depending on the remaining battery capacities. The EVs in the region ' could be divided into two groups choosing different charging stations. We use a unified ODE framework to solve the extended indifference curve for both exogenous and endogenous models, and then give the optimal strategies for EVs. Finally, we demonstrate the optimal strategies by numerical simulations and field data tests.\nOverall, our study provides a practical solution for EV users to optimally make decisions on charging station selection. In future work, we plan to further refine our model by incorporating more complex user behaviors, such as irrational behaviors, to better capture real-world charging scenarios."
        }
    ],
    "title": "Optimal EV Charging Decisions Considering Charging Rate Characteristics and Congestion Effects",
    "year": 2023
}