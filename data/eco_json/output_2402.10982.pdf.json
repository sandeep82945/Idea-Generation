{
    "abstractText": "Transmission system operators have a growing need for more accurate forecasting of electricity demand. Current electricity systems largely require demand forecasting so that the electricity market establishes electricity prices as well as the programming of production units. The companies that are part of the electrical system use exclusive software to obtain predictions, based on the use of time series and prediction tools, whether statistical or artificial intelligence. However, the most common form of prediction is based on hybrid models that use both technologies. In any case, it is software with a complicated structure, with a large number of associated variables and that requires a high computational load to make predictions. The predictions they can offer are not much better than those that simple models can offer. In this paper we present a MATLAB\u00ae toolbox created for the prediction of electrical demand. The toolbox implements multiple seasonal Holt\u2013Winters exponential smoothing models and neural network models. The models used include the use of discrete interval mobile seasonalities (DIMS) to improve forecasting on special days. Additionally, the results of its application in various electrical systems in Europe are shown, where the results obtained can be seen. The use of this library opens a new avenue of research for the use of models with discrete and complex seasonalities in other fields of application.",
    "authors": [
        {
            "affiliations": [],
            "name": "Oscar Trull"
        },
        {
            "affiliations": [],
            "name": "J.Carlos"
        },
        {
            "affiliations": [],
            "name": "Garc\u00eda-D\u00edaz"
        },
        {
            "affiliations": [],
            "name": "A. Peir\u00f3-Signes"
        }
    ],
    "id": "SP:d7fa42f8e02b4f15bfa0fc4975da4432996f93d5",
    "references": [
        {
            "authors": [
                "A. Midttun"
            ],
            "title": "European electricity systems in transition: a comparative analysis of policy and regulation in Western Europe",
            "venue": "Elsevier",
            "year": 1997
        },
        {
            "authors": [
                "E. Palazuelos"
            ],
            "title": "El oligopolio que domina el sistema el\u00e9ctrico",
            "venue": "Consecuencias para la transici\u00f3n energ\u00e9tica [The oligopoly that dominates the electrical system.Consequences for the energy transition], akal, Tres Cantos, Spain",
            "year": 2019
        },
        {
            "authors": [
                "T. Hong"
            ],
            "title": "Crystal Ball Lessons in Predictive Analytics",
            "venue": "Energybiz 12 ",
            "year": 2015
        },
        {
            "authors": [
                "J. Gonz\u00e1lez Ordiano",
                "S. Waczowicz",
                "V. Hagenmeyer",
                "R. Mikut"
            ],
            "title": "Energy forecasting tools and services",
            "venue": "Wiley Interdiscip Rev Data Min Knowl Discov 8 ",
            "year": 2018
        },
        {
            "authors": [
                "M. L\u00f3pez",
                "S. Valero",
                "A. Rodriguez",
                "I. Veiras",
                "C. Senabre"
            ],
            "title": "New online load forecasting system for the Spanish Transport System Operator",
            "venue": "Electric Power Systems Research 154 ",
            "year": 2018
        },
        {
            "authors": [
                "Y. Chakhchoukh",
                "P. Panciatici",
                "L. Mili"
            ],
            "title": "Electric load forecasting based on statistical robust methods",
            "venue": "IEEE Transactions on Power Systems 26 ",
            "year": 2011
        },
        {
            "authors": [
                "L. Meeus",
                "K. Purchala",
                "R. Belmans"
            ],
            "title": "Development of the Internal Electricity Market in Europe",
            "venue": "The Electricity Journal 18 ",
            "year": 2005
        },
        {
            "authors": [
                "K. Imran",
                "I. Kockar"
            ],
            "title": "A technical comparison of wholesale electricity markets in North America and Europe",
            "venue": "Electric Power Systems Research 108 ",
            "year": 2014
        },
        {
            "authors": [
                "M.A. Abu-El-Magd",
                "N.K. Sinha"
            ],
            "title": "Short-Term Load Demand Modeling and Forecasting: A Review",
            "venue": "IEEE Trans Syst Man Cybern 12 ",
            "year": 1982
        },
        {
            "authors": [
                "R. Weron"
            ],
            "title": "Modeling and Forecasting Electricity Loads and Prices: A Statistical Approach",
            "venue": "John Wiley & Sons, Ltd, Chichester, England",
            "year": 2006
        },
        {
            "authors": [
                "L. Suganthi",
                "A.A. Samuel"
            ],
            "title": "Energy models for demand forecasting\u2014A review",
            "venue": "Renewable and Sustainable Energy Reviews 16 ",
            "year": 2012
        },
        {
            "authors": [
                "O. Trull"
            ],
            "title": "Predicci\u00f3n a corto plazo de la demanda horaria de energ\u00eda el\u00e9ctrica en Espa\u00f1a mediante modelos optimizados de Holt-Winters m\u00faltiple-estacionales [Short-term load forecasting of Spanish hourly electricity demand through multiple seasonal Holt-Winters",
            "venue": "Universitat Polit\u00e8cnica de Val\u00e8ncia",
            "year": 2019
        },
        {
            "authors": [
                "R.J. Hyndman",
                "A.B. Koehler",
                "J.K. Ord",
                "R.D. Snyder"
            ],
            "title": "Forecasting with exponential smoothing: The State Space Approach",
            "venue": "Springer, Berlin Heidelberg",
            "year": 2008
        },
        {
            "authors": [
                "J.W. Taylor"
            ],
            "title": "Short-term electricity demand forecasting using double seasonal exponential smoothing",
            "venue": "Journal of the Operational Research Society 54 ",
            "year": 2003
        },
        {
            "authors": [
                "J.W. Taylor"
            ],
            "title": "Triple seasonal methods for short-term electricity demand forecasting",
            "venue": "Eur J Oper Res 204 ",
            "year": 2010
        },
        {
            "authors": [
                "P.G. Gould",
                "A.B. Koehler",
                "J.K. Ord",
                "R.D. Snyder",
                "R.J. Hyndman",
                "F. Vahid-Araghi"
            ],
            "title": "Forecasting time series with multiple seasonal patterns",
            "venue": "Eur J Oper Res 191 ",
            "year": 2008
        },
        {
            "authors": [
                "A.M. De Livera",
                "R.J. Hyndman",
                "R.D. Snyder"
            ],
            "title": "Forecasting time series with complex seasonal patterns using exponential smoothing",
            "venue": "J Am Stat Assoc 106 ",
            "year": 2011
        },
        {
            "authors": [
                "A.I. Almazrouee",
                "A.M. Almeshal",
                "A.S. Almutairi"
            ],
            "title": "Long-Term Forecasting of Electrical Loads in Kuwait",
            "venue": "Applied Science 10 ",
            "year": 2020
        },
        {
            "authors": [
                "J.D. Berm\u00fadez"
            ],
            "title": "Exponential smoothing with covariates applied to electricity demand forecast",
            "venue": "European Journal of Industrial Engineering 7 ",
            "year": 2013
        },
        {
            "authors": [
                "G. Sudheer",
                "A. Suseelatha"
            ],
            "title": "Short term load forecasting using wavelet transform combined with Holt\u2013 Winters and weighted nearest neighbor models",
            "venue": "International Journal of Electrical Power & Energy Systems 64 ",
            "year": 2015
        },
        {
            "authors": [
                "J.W. Taylor",
                "P.E.L.M. de Menezes"
            ],
            "title": "McSharry, A comparison of univariate methods for forecasting electricity demand up to a day ahead",
            "venue": "Int J Forecast",
            "year": 2006
        },
        {
            "authors": [
                "P.R. Winters"
            ],
            "title": "Forecasting sales by exponentially weighted moving averages",
            "venue": "Management",
            "year": 1960
        },
        {
            "authors": [
                "J.C. Garc\u00eda-D\u00edaz",
                "O. Trull"
            ],
            "title": "Competitive Models for the Spanish Short-Term Electricity Demand Forecasting",
            "year": 2016
        },
        {
            "authors": [
                "O. Trull",
                "J.C. Garc\u00eda-D\u00edaz",
                "A. Troncoso"
            ],
            "title": "Application of Discrete-Interval Moving Seasonalities to Spanish Electricity Demand Forecasting during Easter",
            "venue": "Energies (Basel) 12 ",
            "year": 2019
        },
        {
            "authors": [
                "O. Trull",
                "J.C. Garc\u00eda-D\u00edaz",
                "A. Troncoso"
            ],
            "title": "One-day-ahead electricity demand forecasting in holidays using discrete-interval moving seasonalities",
            "venue": "Energy 231 ",
            "year": 2021
        },
        {
            "authors": [
                "O. Trull",
                "A.J.C. Garc\u00eda\u2010d\u00edaz"
            ],
            "title": "Peir\u00f3\u2010signes, Forecasting irregular seasonal power consumption. An application to a hot\u2010dip galvanizing process",
            "venue": "Applied Sciences",
            "year": 2021
        },
        {
            "authors": [
                "N. Andriopoulos",
                "A. Magklaras",
                "A. Birbas",
                "A. Papalexopoulos",
                "C. Valouxis",
                "S. Daskalaki",
                "M. Birbas",
                "E. Housos",
                "G.P. Papaioannou"
            ],
            "title": "Short term electric load forecasting based on data transformation and statistical machine learning",
            "venue": "Applied Sciences (Switzerland) 11 ",
            "year": 2021
        },
        {
            "authors": [
                "C. Cai",
                "Y. Tao",
                "T. Zhu",
                "Z. Deng"
            ],
            "title": "Short-term load forecasting based on deep learning bidirectional lstm neural network",
            "venue": "Applied Sciences (Switzerland) 11 ",
            "year": 2021
        },
        {
            "authors": [
                "J.F. Torres",
                "F. Mart\u00ednez-\u00c1lvarez",
                "A. Troncoso"
            ],
            "title": "A deep LSTM network for the Spanish electricity consumption forecasting",
            "venue": "Neural Comput Appl 2 ",
            "year": 2022
        },
        {
            "authors": [
                "A. Deoras"
            ],
            "title": "Electricity Load and Price Forecasting Webinar Case Study",
            "venue": "MATLAB Central File Exchange (2020). https://es.mathworks.com/matlabcentral/fileexchange/28684-electricity-load-and-priceforecasting-webinar-case-study ",
            "year": 2020
        },
        {
            "authors": [
                "L. Ren",
                "Y. Liu",
                "Z. Rui",
                "H. Li",
                "R. Feng"
            ],
            "title": "Application of Elman Neural Network and MATLAB to Load Forecasting",
            "venue": "in: 2009 International Conference on Information Technology and Computer Science,",
            "year": 2009
        },
        {
            "authors": [
                "C.M. Huang"
            ],
            "title": "A new short-term load forecasting approach using self-organizing fuzzy armax models",
            "venue": "IEEE Transactions on Power Systems 13 ",
            "year": 1998
        },
        {
            "authors": [
                "N. Mohamed",
                "M. Hura Ahmad"
            ],
            "title": "Short Term Load Forecasting Using Double Seasonal ARIMA Model",
            "venue": "",
            "year": 2010
        },
        {
            "authors": [
                "S. Fan",
                "R.J. Hyndman"
            ],
            "title": "Forecasting electricity demand in Australian National Electricity Market",
            "venue": "IEEE Power and Energy Society General Meeting,",
            "year": 2012
        },
        {
            "authors": [
                "J. Amat Rodrigo",
                "J. Escobar Ortiz"
            ],
            "title": "Forecasting electricity demand with Python",
            "venue": "(2021). https://www.cienciadedatos.net/py29-forecasting-electricity-power-demand-python.html ",
            "year": 2022
        },
        {
            "authors": [
                "M. Wadinger"
            ],
            "title": "loadforecast",
            "venue": "(2021). https://pypi.org/project/loadforecast/ ",
            "year": 2022
        },
        {
            "authors": [
                "C.C. Holt"
            ],
            "title": "Forecasting seasonals and trends by exponentially weighted moving averages",
            "venue": "Int J Forecast 20 ",
            "year": 2004
        },
        {
            "authors": [
                "R.G. Brown"
            ],
            "title": "Statistical forecasting for inventory control",
            "venue": "McGraw-Hill, New York",
            "year": 1959
        },
        {
            "authors": [
                "P.R. Winters"
            ],
            "title": "Forecasting sales by exponentially weighted moving averages",
            "venue": "Management",
            "year": 1960
        },
        {
            "authors": [
                "O. Trull",
                "J.C. Garc\u00eda-D\u00edaz",
                "A. Troncoso"
            ],
            "title": "Initialization methods for multiple seasonal holt-winters forecasting models",
            "venue": "Mathematics 8 ",
            "year": 2020
        },
        {
            "authors": [
                "B.C. Archibald"
            ],
            "title": "Parameter space of the Holt\u2013Winters\u2019 model",
            "venue": "Int J Forecast 6 ",
            "year": 1990
        },
        {
            "authors": [
                "O. Trull",
                "J.C. Garc\u00eda-D\u00edaz",
                "A. Troncoso"
            ],
            "title": "Stability of multiple seasonal holt-winters models applied to hourly electricity demand in Spain",
            "venue": "Applied Sciences (Switzerland) 10 ",
            "year": 2020
        },
        {
            "authors": [
                "J.W. Taylor"
            ],
            "title": "Exponential smoothing with a damped multiplicative trend",
            "venue": "Int J Forecast 19 ",
            "year": 2070
        },
        {
            "authors": [
                "J.W. Taylor"
            ],
            "title": "Short-term electricity demand forecasting using double seasonal exponential smoothing",
            "venue": "Journal of the Operational Research Society 54 ",
            "year": 2003
        },
        {
            "authors": [
                "J.W. Taylor"
            ],
            "title": "Triple seasonal methods for short-term electricity demand forecasting",
            "venue": "Eur J Oper Res 204 ",
            "year": 2010
        },
        {
            "authors": [
                "J.C. Garc\u00eda-D\u00edaz",
                "O. Trull"
            ],
            "title": "Competitive Models for the Spanish Short-Term Electricity Demand Forecasting",
            "year": 2016
        },
        {
            "authors": [
                "O. Trull",
                "J.C. Garc\u00eda-D\u00edaz",
                "A. Troncoso"
            ],
            "title": "One-day-ahead electricity demand forecasting in holidays using discrete-interval moving seasonalities",
            "venue": "Energy 231 ",
            "year": 2021
        },
        {
            "authors": [
                "H.S. Hippert",
                "C.E. Pedreira",
                "R.C. Souza"
            ],
            "title": "Neural networks for short-term load forecasting: a review and evaluation",
            "venue": "IEEE Transactions on Power Systems 16 ",
            "year": 2001
        },
        {
            "authors": [
                "R.B. Cleveland",
                "W.S. Cleveland",
                "J.E. McRae",
                "I. Terpenning"
            ],
            "title": "STL: A seasonal-trend decomposition procedure based on loess",
            "venue": "J Off Stat 6 ",
            "year": 1990
        },
        {
            "authors": [
                "O. Trull",
                "J.C. Garc\u00eda-d\u00edaz",
                "A. Peir\u00f3-signes"
            ],
            "title": "Multiple seasonal STL decomposition with discrete-interval moving seasonalities",
            "venue": "433 ",
            "year": 2022
        },
        {
            "authors": [
                "O. Trull",
                "J.C. Garc\u00eda-d\u00edaz",
                "A. Peir\u00f3-signes"
            ],
            "title": "Multiple seasonal STL decomposition with discrete-interval moving seasonalities",
            "venue": "433 ",
            "year": 2022
        },
        {
            "authors": [
                "S. Arora",
                "J.W. Taylor"
            ],
            "title": "Load Forecasting for Special Days Using a Rule-based Modeling Framework : A Case Study for France",
            "venue": "North-Holland",
            "year": 2018
        },
        {
            "authors": [
                "O. Trull",
                "J.C. Garc\u00eda-D\u00edaz",
                "A. Troncoso"
            ],
            "title": "Initialization methods for multiple seasonal holt-winters forecasting models",
            "venue": "Mathematics 8 ",
            "year": 2020
        },
        {
            "authors": [
                "J.C. Lagarias",
                "J.A. Reeds",
                "M.H. Wright",
                "P.E. Wright"
            ],
            "title": "Convergence properties of the nelder--mead simplex method in low dimensions",
            "venue": "SIAM Journal on Optimization",
            "year": 1998
        }
    ],
    "sections": [
        {
            "text": "Transmission system operators have a growing need for more accurate forecasting of electricity demand. Current electricity systems largely require demand forecasting so that the electricity market establishes electricity prices as well as the programming of production units. The companies that are part of the electrical system use exclusive software to obtain predictions, based on the use of time series and prediction tools, whether statistical or artificial intelligence. However, the most common form of prediction is based on hybrid models that use both technologies. In any case, it is software with a complicated structure, with a large number of associated variables and that requires a high computational load to make predictions. The predictions they can offer are not much better than those that simple models can offer. In this paper we present a MATLAB\u00ae toolbox created for the prediction of electrical demand. The toolbox implements multiple seasonal Holt\u2013Winters exponential smoothing models and neural network models. The models used include the use of discrete interval mobile seasonalities (DIMS) to improve forecasting on special days. Additionally, the results of its application in various electrical systems in Europe are shown, where the results obtained can be seen. The use of this library opens a new avenue of research for the use of models with discrete and complex seasonalities in other fields of application.\nKeywords: time series; forecasting; holt-winters; neuronal network; mstl; mshw"
        },
        {
            "heading": "1. Introduction",
            "text": "The evolution of national electrical systems in Western countries towards deregulation and a free market has forced all entities to improve their management. Currently, the markets are organized by producers, sellers and a transmission system operator (TSO) who is in charge of establishing the operating conditions, and with it, the cost of energy [1]. These TSOs may or may not be owned by governments, but they work independently in search of the best energy efficiency. They are in charge of matching supply and demand, and thus programming the production units. However, and prior to this programming, the producers make offers in the electricity market by offering quantities of energy at a price. In the same way, marketers offer energy purchases at a cost. The TSO is in charge of balancing\nthese offers to establish which units will be the active ones to generate energy, and the price of energy is established. This responsibility has turned the TSOs as the main elements in the electricity system.\nThis business model moves in Spain around 40 billion euros, in Germany more than 70 billion and in France more than 80 billion and it depends enormously on these predictions [2\u20134]. The forecasts thus provided by TSOs must be accurate. Hong estimates that for a 1000MW production unit, an improve of 1% in the forecast error can reduce losses of up to $300,000 per year while analyzing short-term load forecasting (STLF) and 500,000$ when analyzing long-term load forecasting [5].\nDue to the fact that predictions play a fundamental role in the electricity system, the entities that are part of the electricity systems have opted for the development of specific software for the prediction of demand and prices, each one for its field of action. There is a wide variety of software provided by specialized companies [6], although on many occasions, TSOs prefer to develop their own [7,8]. These models have a huge number of parameters and factors to calculate, in addition to having to rework the series to be able to carry out the calculations. The models offer very good results, although they require a huge investment and require highly capable equipment.\nIn this article we present a novelty MATLAB\u00ae toolbox specifically designed for electricity demand\nforecasting, in which its main objective has been the simplicity of the models, as well as robust results.\nThis toolbox includes multiple seasonal Holt-Winters (nHWT) models, prediction models based on component decomposition, and artificial neural network (ANN) models. In addition, the possibility of using discrete interval moving seasonalities (DIMS) to make predictions on special days is included.\nThe paper is organized as follows. Section 2 surveys the previous published works related to this paper. Section 3 shows the models used in this toolbox. Section 4 describes the architecture of the toolbox. Section 5 presents some cases published using this software. Finally, Section 6 summarizes the conclusions and the future research."
        },
        {
            "heading": "2. Related work",
            "text": "The generation of electricity for public use dates back to the end of the 19th century with the installation of the first plants in Godalming (UK) and Pearl Street (US). The first plants produced without the need to manage demand, due to the low installed capacity. But with the growth in the use of electricity, and with the installation of more and more production plants, it was necessary to focus in knowing how much energy should be produced. The growing need to determine future demand provokes an interest in using statistical methods based on time series to make forecasts.\nAt that time the supply companies had a very vertical structure, so that the producers themselves are the ones who end up marketing the energy. However, with the deregulation in the electricity markets, where the business has been divided by area of activity, into producers, distributors and marketers, in addition to a TSO, the model changed [9,10]. The need to make more accurate forecasts becomes an essential requirement. Companies multiply their efforts, and the number of proposed models increases. Figure 1 shows the evolution of the papers published in journals regarding the electricity systems. It is noticeable how an exponential growth of the publications, with almost 200 papers published in 2015 regarding this topic, from which about 50% of the publications were focused on load forecasting methods and applications.\nFIGURE 1 ABOUT HERE\nHowever, the proposed statistical models have not undergone major variations. Abu-El-Magd and Sinha [11] analyze the models used for the demand in 1982. The authors distinguish between models based on multiple regression, spectral decomposition, exponential smoothing, stochastic models, state\nspaces, and multivariate models. Recent studies about STLF methods [12\u201314] describe three main areas: fundamental, statistical and computational methods.\nOnly computational methods have shown a great increase in models and analyses, while \"traditional\" models have focused more on improving methodologies in practice [15]. The introduction of multiple seasonalities in exponential smoothing models [16,17] and in state spaces[18,19] have been a trigger to evolve these models. Some new approaches use modern methods, like Facebook\u2019s Prophet [20], covariates introduction [21] or combined with wavelets decomposition [22].\nThe characteristics of the short-term electricity demand series make it particularly suitable for the use of prediction models based on univariate methods [23]. The Holt-Winters methods have evolved from the original model published by Winters [24]. These models have a set of smoothing equations for the different components of the series: an equation for the level, an equation (optional) for the trend and an equation for seasonality, also optional. The prediction equation collects all the information provided by the previous equations to produce a forecast f instants later. Taylor [16] proposed the double seasonal model in which the seasonal equation is divided into two nested seasonal equations, and where the prediction is also adjusted using the first-order autocorrelation error with a factor also to be determined. A generalization to nHWT is proposed [25] that is extended using discrete seasonalities, resulting nHWT-DIMS [26,27], that can be applied to irregular seasonalities [28].\nA very common alternative in prediction is the use of artificial intelligence. Neural networks offer very accurate forecasts for this type of series. Among the wide range of tools available, the NARX and Shallow networks stand out. They have been the most used for this purpose. There is currently a rising trend in the presentation of models based on neural networks, as convolution neural nets (CNN) or long short-term memory (LSTM) models that take advantage of Deep Learning [29,30], with really interesting results [31]. However, the first ones are the ones used with a lot of difference.\nThe software developed for the prediction of electricity demand is very varied [32,33]. As a general rule, TSOs develop their own proprietary software, and rarely publish the results. The use of programs\nsuch as MATLAB\u00ae [34,35], SAS [36,37], etc. is usual for this purpose. The alternatives with free software go through the options in R, such as the MEFM (Monash Electricity Forecasting Model) package [38], and in Python the loadforecast library [39,40]."
        },
        {
            "heading": "3. Implemented models",
            "text": "This software implements advanced forecasting methods based on nHWT, multiple seasonal decomposition and A.I. including DIMS. The following subsections describe the models implemented in the software."
        },
        {
            "heading": "3.1. Holt-Winters",
            "text": "Exponential smoothing methods were started at the 60\u2019s, with the works of Holt [41] and Brown [42]. The Holt-Winters model was developed in the 60\u2019s [43]. It consists of three smoothing equations for level \ud835\udc3f\ud835\udc61 (1), trend \ud835\udc47\ud835\udc61 (2) and seasonality \ud835\udc60\ud835\udc61 (3), with a forecasting equation that uses the information from the smoothing equations to make k-ahead forecasts (4).\n\ud835\udc3f\ud835\udc61 = \ud835\udefc \ud835\udc66\ud835\udc61\n\ud835\udc60\ud835\udc61 + (1 \u2212 \ud835\udefc)(\ud835\udc3f\ud835\udc61\u22121 + \ud835\udc47\ud835\udc61\u22121) (1)\n\ud835\udc47\ud835\udc61 = \ud835\udefe(\ud835\udc3f\ud835\udc61 \u2212 \ud835\udc3f\ud835\udc61\u22121) + (1 \u2212 \ud835\udefe)\ud835\udc47\ud835\udc61\u22121 (2)\n\ud835\udc60\ud835\udc61 = \ud835\udeff \ud835\udc66\ud835\udc61\n\ud835\udc3f\ud835\udc61 + (1 \u2212 \ud835\udeff)\ud835\udc60\ud835\udc61\u2212\ud835\udc60 (3)\n?\u0302?\ud835\udc61+\ud835\udc58 = \ud835\udc3f\ud835\udc61 + \ud835\udc58\ud835\udc47\ud835\udc61 + \ud835\udc60\ud835\udc61\u2212\ud835\udc60+\ud835\udc58 (4)\nwhere \ud835\udc60 stands for the seasonal cycle length. It can be seen the models are recursive, so it means it is necessary to calculate initial values. Several methods are described in [44]. The smoothing parameters \ud835\udefc , \ud835\udefe and \ud835\udeff are bounded in the range (0,1), and measure the weight of the smoothing, giving more importance to initial values when closer to 0, and more importance to newer when closer to 1 [45,46]. To obtain the values of the parameters, several optimization techniques can be used, always trying to\nminimize the one step ahead forecasting error, measured through an accuracy indicator. The most commonly used indicator used to measure the error is the root of the mean squared error (RMSE), as shown in (5).\n\ud835\udc45\ud835\udc40\ud835\udc46\ud835\udc38 = \u221a \u2211 (\ud835\udc66\ud835\udc56\u2212?\u0305?)\n2\ud835\udc41 \ud835\udc56=1\n\ud835\udc41 (5)\nwith N as number of observed values. The model can be expressed using additive or multiplicative trend, and with additive or multiplicative seasonality, depending on the way they are combined. Some evolutions on the model included a damping trend factor \ud835\udf19 in trend [47,48]. Taylor introduced in the model two and three nested seasonalities [49,50], as well as the first-order autocorrelation error adjustment. These novelties outperformed previous models. Garc\u00eda-D\u00edaz and Trull [51] generalized the models to multiple seasonalities (nHWT) and described new initialization methods. The general model for a additive-tend and multiplicative-seasonality model is shown in (6-9).\n\ud835\udc3f\ud835\udc61 = \ud835\udefc ( \ud835\udc66\ud835\udc61\n\u220f \ud835\udc60\ud835\udc61\u2212\ud835\udc60\ud835\udc56 (\ud835\udc56) ) + (1 \u2212 \ud835\udefc)(\ud835\udc3f\ud835\udc61\u22121 + \ud835\udf19\ud835\udc47\ud835\udc61\u22121), (6)\n\ud835\udc47\ud835\udc61 = \ud835\udefe(\ud835\udc3f\ud835\udc61 \u2212 \ud835\udc3f\ud835\udc61\u22121) + (1 \u2212 \ud835\udefe)\ud835\udf19\ud835\udc47\ud835\udc61\u22121 (7)\n\ud835\udc60\ud835\udc61 (\ud835\udc56) = \ud835\udeff (\ud835\udc56) (\n\ud835\udc66\ud835\udc61\n\ud835\udc3f\ud835\udc61 \u220f \ud835\udc60\ud835\udc61\u2212\ud835\udc60\ud835\udc57\n(\ud835\udc57) \ud835\udc57\u2260\ud835\udc56\n) + (1 \u2212 \ud835\udeff(\ud835\udc56))\ud835\udc60\ud835\udc61\u2212\ud835\udc60\ud835\udc56 (\ud835\udc56)\n(8)\n?\u0302?\ud835\udc61+\ud835\udc58 = (\ud835\udc3f\ud835\udc61 + \u2211 \ud835\udf19 \ud835\udc5b\ud835\udc58 \ud835\udc5b=1 \ud835\udc47\ud835\udc61) \u220f \ud835\udc60\ud835\udc61\u2212\ud835\udc60\ud835\udc56+\ud835\udc58 (\ud835\udc56) \ud835\udc56 +\ud835\udf11\ud835\udc34\ud835\udc45 \ud835\udc58 \ud835\udf00\ud835\udc61 (9)\nHere, the former seasonality \ud835\udc60\ud835\udc61 has been split into several \ud835\udc60\ud835\udc61 (\ud835\udc56) , each with a smoothing parameter \ud835\udeff(\ud835\udc56). The number of seasonalities must be according to the time series under study, and \ud835\udc60\ud835\udc56 stands for each seasonal cycle length. We included here the trend damping factor in (7) and the first autocorrelation error adjustment (\ud835\udf11\ud835\udc34\ud835\udc45) in (9).\nTrull et al. [52] introduced DIMS in the model, in order to deal with calendar and special events. nHWT-DIMS adds discrete seasonalities within the model that catches the seasonal effect produced by the special events and includes it as a part of the model itself, not being thus modified.\nThe former equations (6-9) are now modelled including DIMS as shown in equations (10-14).\n\ud835\udc3f\ud835\udc61 = \ud835\udefc ( \ud835\udc66\ud835\udc61\n\u220f \ud835\udc60\ud835\udc61\u2212\ud835\udc60\ud835\udc56 (\ud835\udc56) \ud835\udc56=1,\u2026,\ud835\udc5b\ud835\udc60 \u220f \ud835\udc37\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e (\u210e) \u210e=1,\u2026,\ud835\udc5b\ud835\udc37\ud835\udc3c\ud835\udc40\ud835\udc46\n) + (1 \u2212 \ud835\udefc)(\ud835\udc3f\ud835\udc61\u22121 + \ud835\udf19\ud835\udc47\ud835\udc61\u22121), (10)\n\ud835\udc47\ud835\udc61 = \ud835\udefe(\ud835\udc3f\ud835\udc61 \u2212 \ud835\udc3f\ud835\udc61\u22121) + (1 \u2212 \ud835\udefe)\ud835\udf19\ud835\udc47\ud835\udc61\u22121 (11)\n\ud835\udc60\ud835\udc61 (\ud835\udc56) = \ud835\udeff(\ud835\udc56) (\n\ud835\udc66\ud835\udc61\n\ud835\udc3f\ud835\udc61 \u220f \ud835\udc60\ud835\udc61\u2212\ud835\udc60\ud835\udc57 (\ud835\udc57) \ud835\udc57\u2260\ud835\udc56 \u220f \ud835\udc37\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 (\u210e) \u210e=1,\u2026,\ud835\udc5b\ud835\udc37\ud835\udc3c\ud835\udc40\ud835\udc46\n) + (1 \u2212 \ud835\udeff(\ud835\udc56))\ud835\udc60\ud835\udc61\u2212\ud835\udc60\ud835\udc56 (\ud835\udc56)\n(12)\n\ud835\udc37\ud835\udc61\u210e (\u210e) = \ud835\udeff\ud835\udc37 (\u210e) (\n\ud835\udc66\ud835\udc61\n\ud835\udc3f\ud835\udc61 \u220f \ud835\udc60\ud835\udc61\u2212\ud835\udc60\ud835\udc57 (\ud835\udc57) \ud835\udc57\u2260\ud835\udc56 \u220f \ud835\udc37\ud835\udc61\ud835\udc5a \u2217 \u2212\ud835\udc60\ud835\udc5a \u2217 (\ud835\udc5a) \ud835\udc5a=1,\u2026,\ud835\udc5b\ud835\udc37\ud835\udc3c\ud835\udc40\ud835\udc46\n) + (1 \u2212 \ud835\udeff\ud835\udc37 (\u210e)\n)\ud835\udc37\ud835\udc61\u210e\u2212\ud835\udc60\u210e \u2217\n(\u210e) (13)\n?\u0302?\ud835\udc61+\ud835\udc58 = (\ud835\udc3f\ud835\udc61 + \u2211 \ud835\udf19 \ud835\udc5b\ud835\udc58 \ud835\udc5b=1 \ud835\udc47\ud835\udc61) \u220f \ud835\udc60\ud835\udc61\u2212\ud835\udc60\ud835\udc56+\ud835\udc58 (\ud835\udc56) \ud835\udc56 \u220f \ud835\udc37\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 (\u210e) \u210e=1,\u2026,\ud835\udc5b\ud835\udc37\ud835\udc3c\ud835\udc40\ud835\udc46 + \ud835\udf11\ud835\udc34\ud835\udc45 \ud835\udc58 \ud835\udf00\ud835\udc61 (14)\nWe introduced D\ud835\udc61h (h) , the new smoothing equations for the DIMS. They also include new smoothing\nparameters \ud835\udeffD (h) for each DIMS. \ud835\udc5b\ud835\udc37\ud835\udc3c\ud835\udc40\ud835\udc46 refers for the number of DIMS considered. The DIMS are integrated as a part of the model itself, thus no external modifications like dummies are needed. DIMS h is only defined in times \ud835\udc61h (\ud835\udc61\u210e \u2208 \ud835\udc61). DIMS seasonal cycle length is defined by \ud835\udc60\u210e , but the recurrence depends on the previous appearances that are not necessarily regular, must sh \u2217 must be continuously calculated on every time step. \ud835\udc61\ud835\udc5a \u2217 has been defined to check whether a DIMS is defined in time step \ud835\udc61 or not. Once again, depending on the way in which the seasonalities and the trend are integrated into the model, we can speak of a framework of models, as can be seen in appendix A1 of [52]."
        },
        {
            "heading": "3.2. nHWT-DIMS generalized models",
            "text": "The working basis of the toolbox are the nHWT-DIMS models. One of the advantages of integrating seasonalities is the versatility with which they can do so. As a general rule, the models contemplate an integration in an additive or multiplicative way, following all the seasonalities the same generic way. However, depending on the nature of seasonality, a general model allows it to be included in one way or another.\nTaking advantage of this feature of multiple seasonality, the model framework is reduced to only two\ngeneralized models, depending on the type of trend considered."
        },
        {
            "heading": "3.2.1. nHWT-DIMS with additive trend model",
            "text": "The model presented in (15-21) uses an additive damped trend, where the seasonalities are integrated so that \ud835\udc46\ud835\udc34(i) represents the additive seasonalities, \ud835\udc37\ud835\udc34(\ud835\udc56) the additive DIMS, \ud835\udc46\ud835\udc40(i) represents the multiplicative seasonalities and \ud835\udc37\ud835\udc40(\ud835\udc56) the multiplicative DIMS,\n\ud835\udc3f\ud835\udc61 = \ud835\udefc(\ud835\udc66\ud835\udc61\u2212\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc56\n(\ud835\udc56) \ud835\udc56 \u2212\u2211 \ud835\udc37\ud835\udc34\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 (\u210e) \u210e )\n\u220f \ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc58 (\ud835\udc58) \u220f \ud835\udc37\ud835\udc40 \ud835\udc61\ud835\udc5a \u2217 \u2212\ud835\udc60\ud835\udc5a\n(\ud835\udc5a) + (1 \u2212 \ud835\udefc)(\ud835\udc3f\ud835\udc61\u22121 + \ud835\udf19\ud835\udc47\ud835\udc61\u22121) (15)\n\ud835\udc47\ud835\udc61 = \ud835\udefe(\ud835\udc3f\ud835\udc61 \u2212 \ud835\udc3f\ud835\udc61\u22121) + (1 \u2212 \ud835\udefe)\ud835\udf19\ud835\udc47\ud835\udc61\u22121 (16)\n\ud835\udc46\ud835\udc34\ud835\udc61 (\ud835\udc56) =\n\ud835\udeff(\ud835\udc56)(\ud835\udc66\ud835\udc61\u2212\ud835\udc3f\ud835\udc61\u2212\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc57 (\ud835\udc57)\n\ud835\udc57\u2260\ud835\udc56 \u2212\u2211 \ud835\udc37\ud835\udc34\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e\n\u2217 (\u210e) \u210e )\n\u220f \ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc58 (\ud835\udc58) \ud835\udc58 \u220f \ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc5a \u2217 \u2212\ud835\udc60\ud835\udc5a \u2217 (\ud835\udc5a) \ud835\udc8e\n+ (1 \u2212 \ud835\udeff(\ud835\udc56))\ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc56 (\ud835\udc56)\n(17)\n\ud835\udc46\ud835\udc40\ud835\udc61 (\ud835\udc56) =\n\ud835\udeff(\ud835\udc56)(\ud835\udc66\ud835\udc61\u2212\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc57 (\ud835\udc57)\n\ud835\udc56 \u2212\u2211 \ud835\udc37\ud835\udc34\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e\n\u2217 (\u210e) \u210e )\n\ud835\udc3f\ud835\udc61 \u220f \ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc58 (\ud835\udc58) \ud835\udc58\u2260\ud835\udc56 \u220f \ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc5a \u2217 \u2212\ud835\udc60\ud835\udc5a \u2217 (\ud835\udc5a) \ud835\udc8e\n+ (1 \u2212 \ud835\udeff(\ud835\udc56))\ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc56 (\ud835\udc56)\n(18)\n\ud835\udc37\ud835\udc34\ud835\udc61\ud835\udc56 (\ud835\udc56) =\n\ud835\udeff\ud835\udc37 (\ud835\udc56)\n(\ud835\udc66\ud835\udc61\u2212\ud835\udc3f\ud835\udc61\u2212\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\ud835\udc56 \u2217\u2212\ud835\udc60\ud835\udc57 (\ud835\udc57) \ud835\udc57 \u2212\u2211 \ud835\udc37\ud835\udc34\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 (\u210e) \ud835\udc5a\u2260\u210e )\n\u220f \ud835\udc46\ud835\udc40 \ud835\udc61\ud835\udc56 \u2217\u2212\ud835\udc60\ud835\udc58 (\ud835\udc58) \ud835\udc58 \u220f \ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc5a \u2217 \u2212\ud835\udc60\ud835\udc5a \u2217 (\ud835\udc5a) \ud835\udc8e\n+ (1 \u2212 \ud835\udeff\ud835\udc37 (\ud835\udc56)\n)\ud835\udc37\ud835\udc34\ud835\udc61\ud835\udc56\u2212\ud835\udc60\ud835\udc56 \u2217\n(\ud835\udc56) (19)\n\ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc56 (\ud835\udc56) =\n\ud835\udeff\ud835\udc37 (\ud835\udc56)\n(\ud835\udc66\ud835\udc61\u2212\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\ud835\udc56 \u2217\u2212\ud835\udc60\ud835\udc57 (\ud835\udc57) \ud835\udc57 \u2212\u2211 \ud835\udc37\ud835\udc34\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 (\u210e) \u210e )\n\ud835\udc3f\ud835\udc61 \u220f \ud835\udc46\ud835\udc40\ud835\udc61\ud835\udc56 \u2217\u2212\ud835\udc60\ud835\udc58 (\ud835\udc58) \ud835\udc58 \u220f \ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc5a \u2217 \u2212\ud835\udc60\ud835\udc5a \u2217 (\ud835\udc5a) \ud835\udc8e\u2260\ud835\udc8a\n+ (1 \u2212 \ud835\udeff\ud835\udc37 (\ud835\udc56)\n)\ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc56\u2212\ud835\udc60\ud835\udc56 \u2217\n(\ud835\udc56) (20)\n?\u0302?\ud835\udc61+\ud835\udc58 = [(\ud835\udc3f\ud835\udc61 + \ud835\udc58 \ud835\udf19\ud835\udc47\ud835\udc61) + (\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc56+\ud835\udc58 (\ud835\udc56) \ud835\udc56 + \u2211 \ud835\udc37\ud835\udc34\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 +\ud835\udc58 (\u210e) \u210e )] \u220f \ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc5b+\ud835\udc58 (\ud835\udc5b) \ud835\udc5b \u220f \ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc5a\u2217 \u2212\ud835\udc60\ud835\udc5a\u2217 +\ud835\udc58 (\ud835\udc5a) \ud835\udc8e + \ud835\udf11\ud835\udc34\ud835\udc45 \ud835\udc58 \ud835\udf00\ud835\udc61 (21)\nThis formulation allows the combination of all kinds of seasonality. If it is not desired to consider the damping of the trend, the effect of the parameter \ud835\udf19 can be removed by assigning it a value of 0. The same will happen with the adjustment of the first-order autocorrelation error (\ud835\udf11\ud835\udc34\ud835\udc45 = 0)."
        },
        {
            "heading": "3.2.2. nHWT-DIMS with multiplicative trend model",
            "text": "In case the way of integrating the trend is multiplicative, the previous formulation is not correct. It is necessary to build a new model. It would be possible to generalize in a single model all the equations, but it would result too complicated to work with. Therefore, it has been split into two models. The new model for multiplicative trend is shown in equations (22-28), where \ud835\udc45\ud835\udc61 is the multiplicative trend.\n\ud835\udc3f\ud835\udc61 = \ud835\udefc(\ud835\udc66\ud835\udc61\u2212\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc57\n(\ud835\udc57) \ud835\udc56 \u2212\u2211 \ud835\udc37\ud835\udc34\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 (\u210e) \u210e )\n\u220f \ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc58 (\ud835\udc58) \ud835\udc58 \u220f \ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc5a \u2217 \u2212\ud835\udc60\ud835\udc5a \u2217 (\ud835\udc5a) \ud835\udc8e\n+ (1 \u2212 \ud835\udefc)(\ud835\udc3f\ud835\udc61\u22121\ud835\udc45\ud835\udc61\u22121 \ud835\udf19 ) (22)\n\ud835\udc45\ud835\udc61 = \ud835\udefe(\ud835\udc3f\ud835\udc61/\ud835\udc3f\ud835\udc61\u22121) + (1 \u2212 \ud835\udefe)\ud835\udc45\ud835\udc61\u22121 \ud835\udf19 (23)\n\ud835\udc46\ud835\udc34\ud835\udc61 (\ud835\udc56)\n= \ud835\udeff(\ud835\udc56)(\ud835\udc66\ud835\udc61\u2212\ud835\udc3f\ud835\udc61\u2212\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc57 (\ud835\udc57) \ud835\udc57\u2260\ud835\udc56 \u2212\u2211 \ud835\udc37\ud835\udc34\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 (\u210e) \u210e )\n\u220f \ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc58 (\ud835\udc58) \ud835\udc58 \u220f \ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc5a \u2217 \u2212\ud835\udc60\ud835\udc5a \u2217 (\ud835\udc5a) \ud835\udc8e\n+ (1 \u2212 \ud835\udeff(\ud835\udc56))\ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc56 (\ud835\udc56) (24)\n\ud835\udc46\ud835\udc40\ud835\udc61 (\ud835\udc56)\n= \ud835\udeff(\ud835\udc56)(\ud835\udc66\ud835\udc61\u2212\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc57 (\ud835\udc57) \ud835\udc57 \u2212\u2211 \ud835\udc37\ud835\udc34\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 (\u210e) \u210e )\n\ud835\udc3f\ud835\udc61 \u220f \ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc58 (\ud835\udc58) \ud835\udc58\u2260\ud835\udc56 \u220f \ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc5a \u2217 \u2212\ud835\udc60\ud835\udc5a \u2217 (\ud835\udc5a) \ud835\udc8e\n+ (1 \u2212 \ud835\udeff(\ud835\udc56))\ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc56 (\ud835\udc56) (25)\n\ud835\udc37\ud835\udc34 \ud835\udc61\ud835\udc56\n\u2217 (\ud835\udc56) = \ud835\udeff\ud835\udc37\n(\u210e) (\ud835\udc66\ud835\udc61\u2212\ud835\udc3f\ud835\udc61\u2212\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc57 (\ud835\udc57) \ud835\udc57 \u2212\u2211 \ud835\udc37\ud835\udc34\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 (\u210e) \u210e\u2260\ud835\udc56 )\n\u220f \ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc58 (\ud835\udc58) \ud835\udc58 \u220f \ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc5a \u2217 \u2212\ud835\udc60\ud835\udc5a \u2217 (\ud835\udc5a) \ud835\udc8e\n+ (1 \u2212 \ud835\udeff\ud835\udc37 (\ud835\udc56)\n)\ud835\udc37\ud835\udc34 \ud835\udc61\ud835\udc56 \u2217\u2212\ud835\udc60\ud835\udc56 \u2217\n(\ud835\udc56) (26)\n\ud835\udc37\ud835\udc40 \ud835\udc61\ud835\udc56\n\u2217 (\ud835\udc56) = \ud835\udeff\ud835\udc37\n(\u210e) (\ud835\udc66\ud835\udc61\u2212\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc57 (\ud835\udc57) \ud835\udc57 \u2212\u2211 \ud835\udc37\ud835\udc34\ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 (\u210e) \u210e ) \ud835\udc3f\ud835\udc61 \u220f \ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc58 (\ud835\udc58) \ud835\udc58 \u220f \ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc5a \u2217 \u2212\ud835\udc60\ud835\udc5a \u2217 (\ud835\udc5a) \ud835\udc8e\u2260\ud835\udc8a + (1 \u2212 \ud835\udeff\ud835\udc37 (\ud835\udc56))\ud835\udc37\ud835\udc40 \ud835\udc61\ud835\udc56 \u2217\u2212\ud835\udc60\ud835\udc56 \u2217 (\ud835\udc56) (27)\n?\u0302?\ud835\udc61+\ud835\udc58 = [\ud835\udc3f\ud835\udc61\ud835\udc45\ud835\udc61 \u2211 \ud835\udf19\ud835\udc58\ud835\udc58\ud835\udc59=1 + (\u2211 \ud835\udc46\ud835\udc34\ud835\udc61\u2212\ud835\udc60\ud835\udc56+\ud835\udc58 (\ud835\udc56) + \u2211 \ud835\udc37\ud835\udc34 \ud835\udc61\u210e \u2217 \u2212\ud835\udc60\u210e \u2217 +\ud835\udc58 (\u210e) \u210e\ud835\udc56 )] \u220f \ud835\udc46\ud835\udc40\ud835\udc61\u2212\ud835\udc60\ud835\udc5b+\ud835\udc58 (\ud835\udc5b) \ud835\udc5b \u220f \ud835\udc37\ud835\udc40\ud835\udc61\ud835\udc5a\u2217 \u2212\ud835\udc60\ud835\udc5a\u2217 +\ud835\udc58 (\ud835\udc5a) \ud835\udc8e + \ud835\udf11\ud835\udc34\ud835\udc45 \ud835\udc58 \ud835\udf00\ud835\udc61 (28)"
        },
        {
            "heading": "3.3. Additional implementations: Neural networks",
            "text": "The library also includes neural network models. It has been considered interesting to include a\nprediction module using neural networks, in which the use of DIMS is included as a novelty.\nThe artificial intelligence models are widely used in the prediction of electricity demand due to their good forecasts [31,53]. The toolbox includes NARX and shallow neural network models. A schematic of the neural network used is shown in the Figure 2. There is an input layer to which the observed values and variables are input. The network is organized into nodes and connections, similar to the human brain, which is why they are known as neurons and synapses. The nodes are organized in layers performing simple operations in parallel, using the information of neurons from previous layers through connections. Input variables are connected to an input layer. The following layers are known as hidden layers, and in them the number of neurons and the weight of the connections are adjusted. The last layer, the output layer, is the one that produces the prediction of the network.\nFIGURE 2 ABOUT HERE\nThe input variables \ud835\udc65\ud835\udc61 are exogenous variables that can be used to improve the model. The variables are connected by means of axioms with weights \ud835\udc64\ud835\udc56 assigned during the training, and with an activation function \ud835\udc53(. ) that integrates with an aggregation function \ud835\udef4. \ud835\udc4f represents the bias. The output ?\u0302?\ud835\udc61+1 provides forecasts after the network has been trained.\nThe mathematical representation of the neural network model can be seen in equation (1). The values of \ud835\udc37\ud835\udc65 and \ud835\udc37\ud835\udc66 represent the delays that are applied to the variables in the network.\n?\u0302?\ud835\udc61+1 = \ud835\udc53 [\ud835\udc65\ud835\udc61 , \ud835\udc65\ud835\udc61\u22121, \u2026 , \ud835\udc65\ud835\udc61\u2212\ud835\udc37\ud835\udc65 , \ud835\udc66\ud835\udc61 , \ud835\udc66\ud835\udc61\u22121, \u2026 , \ud835\udc66\ud835\udc61\u2212\ud835\udc37\ud835\udc66+1] (1)\nObtaining the weights of the networks is obtained through a training process. The LevenbergMarquardt algorithm is used in the toolbox, although it is possible to use others. Error minimization is done through the mean square error (MSE).\nThe preparation of the data for the input layer is necessary. According to [34], the time, day of the week, and weather information (if available) are included as additional information. The series used present several seasonalities, so it is necessary to include a recurrence to previous values through the use of moving averages, one for each different seasonality, and of amplitude the length of the considered seasonal cycle. To include special events due to the calendar effect, a dichotomous variable is generally used that indicates whether it is a holiday or a working day. The use of DIMS allows not only to indicate the presence of a holiday, but also to consider its effect on the series. DIMS are included in the model as a new exogenous variable, in a discontinuous way, which includes a seasonal pattern only at the times when the special event occurs. Therefore, as many DIMS series as discrete seasonalities have been incorporated into the model are included in the input layer."
        },
        {
            "heading": "4. Architecture of the toolbox",
            "text": "Due to the large data size of the series used, it was decided that the best platform to use to implement the models was MATLAB\u00ae. The programming uses a proprietary software language, although it is similar to others such as C++, Java, etc. However, its use provides a series of advantages: there are\nalready developed and verified libraries, and memory management is exceptional. The library has been developed using an object-oriented architecture (OO) based on the mts class (included as a package), which is a subclass based on MATLAB timeseries class. The use of timeseries allows reuse of a large number of functions offered by MATLAB.\nFrom this class, inherited classes have been generated with specific purposes: to manage the database from which to extract the data, and to carry out the planned analyses. Additionally, additional classes have been designed to perform specific actions."
        },
        {
            "heading": "4.1. Class diagram of the toolbox",
            "text": "The structure of inheritance and derivation of classes can be seen in the class diagram shown in the Figure 3. In this diagram, the object of each class has been organized by color. Orange shows the timeseries class, typical of MATLAB, from which mts, the base class of the library, inherits. The classes whose purpose is to manage the databases are presented on a green background, and the classes destined to perform time series analysis are shown in blue. Class dependencies are indicated by arrows.\nFIGURE 3 ABOUT HERE"
        },
        {
            "heading": "4.2. Class mts",
            "text": "The mts class extends the functionality of timeseries to include multiple seasonalities. This class is in charge of managing the seasonalities of the model, in addition to the discrete seasonalities. mts works as a container for the covariates of the model.\nThe methods included in this class are organized as follows: on the one hand, there are the methods aimed at managing the data, on the other, the methods for performing prediction error calculations, and finally, the methods for performing operations with the series. Table 1 shows the main properties and methods related to this series.\nThe mts class is a container in addition to the DIMS. These elements have a particular structure in order to contain the necessary information. They are first identified, and the seasonal length is determined. Then, it is indicated in which moments of the series they are defined, indicating the first moment in each of the interventions.\nTABLE 1 about here\nClasses derived from mts overload the Seasons and the DIMS containers to give them additional features, depending on the goal. Thus, the mshw class will add to the DIMS the properties of how seasonality will be related in the model (additive or multiplicative) and how its initial value will be obtained. TSCov contains any exogenous variables that may be needed for the models.\nAmong the prominent methods in the mts class are the functions stl, mstl, stlplot. These functions perform a decomposition based on Loess [54,55] of the series into trend and seasonal (multiple) components. The decomposition uses an algorithm so that all the seasonalities are obtained simultaneously and prior to obtaining the DIMS decomposition. The discrete seasonalities are obtained using the methodology explained in [56].\nFigure 4 shows an example of multiple seasonal STL decomposition plot by the stlplot function. Figure 4a shows the regular multiple seasonal decomposition, where the original data and the regular seasonalities are decomposed. The remainder is also shown below. Figure 4b has a different layout. The seasonal decomposition for the DIMS is shown at the left side of the figure, while the appearances of the DIMS in the time series is shown at the right side. The code needed to generate the graphs is included in Appendix A.\nFIGURE 4 ABOUT HERE\nFrom the STL decomposition predictions can be made keeping the structure of the decomposition. It is a very brief way of predicting, and it is of no more interest than the application's own internals. However, it is indicated because it may be useful to the reader."
        },
        {
            "heading": "4.3. Class Elecmts",
            "text": "The data to be analyzed can be entered from any data source, including a numeric array. However, much of the data used in the library and applied in previous papers is provided through the different data wrapper classes. The Elecmts class handles the loading of data provided by TSOs from different countries.\nSince this is a class derived from mts, you can access the existing properties and methods of that class. This class provides the following methods to be able to work with the included databases. The ListDB function allows the user to know the databases included in the data file. The ListSeries method allows you to see the series included in each database.\nTable 2 shows the main databases available in the toolbox. Databases are identified by a word, as indicated in the first column. The second column is the official name given to the database, while the third column describes its content. Subsequently, each database has its own structure, according to the available data. Because the size of the files is considerable, each database manages its own file.\nTo load the data, the user must create an object of type Elecmts indicating the database with the db parameter, and with the different parameters necessary to locate the series to be used. You can also indicate the period or the time window to load. If the loading of several data series is required, the library will load the data as covariates.\nTABLE 2 ABOUT HERE"
        },
        {
            "heading": "4.4. Class Climmts",
            "text": "The Climmts class is a wrapper and database manager for the mts class related to weather variables. Like Elecmts, it is responsible for managing the data load in the Climmts class object. The ListDB and ListSeries methods work the same way as in the previous case. Table 3 lists the current database available.\nTABLE 3 ABOUT HERE"
        },
        {
            "heading": "4.5. Class Demmts",
            "text": "Demographic data can be interesting to calculate models with better precision. This class derived from mts manages the library's demographic database. At present, demographic data is only available for Spain and some for the USA. The functions used for its management are the same as in the previous cases.\nThis class also includes tourism indicators used in previous works, such as the Human Pressure\nIndicator \u2013both daily and monthly\u2013, provided by the Balearic Institute of Statistics (IBESTAT)."
        },
        {
            "heading": "4.6. Class mshw",
            "text": "The mshw class provides a series of tools to forecast time series using multiple seasonal Holt-Winters models, including the possibility of including DIMS within the model. This class derives directly from mts, but some of the inherited processes are modified to suit the needs of the models. The Seasons property, for example, includes in addition to the length of the cycle of each seasonality, the method used to calculate the effect of the seasonality, being additive or multiplicative. The way to calculate the initial values of each seasonality is also included.\nThe smoothing parameters (alpha, gamma, delta, phi and ar1) are managed from this class. Among the methods to highlight in this class, the FindParams method stands out. This method obtains the\noptimized values of the smoothing parameters by minimizing the prediction error. The algorithm used in the solve de minimization problem, as well as the error indicator can be customized. Although simplex method is commonly used, genetic algorithms, pattern search and others are available to be used in order to find the parameters.\nTable 4 shows the most important properties and methods of this class. To make predictions, the forecast function offers a wide range of possibilities. If the parameters have been optimized, the call to this function will indicate the number of predictions to make.\nThe mshw class implements a wide variety of Holt-Winters models, as described in Section 3. It also introduces different methodologies for obtaining seeds, both for the initial values of the models and for the initial values of the DIMS. The mshw object is created (usually inheriting from Elecmts object). The model structure is defined by setting the features of the trend and the seasonalities. The user can then enter the smoothing parameters\u2019 values or leave the toolbox to obtain them. The forecasts can be then produced and plotted.\nWe show an example of the forecasting properties using mshw in Figure 5. The instructions list used\nto obtain the forecasts is listed in Appendix B.\nTABLE 4 ABOUT HERE\nFIGURE 5 ABOUT HERE"
        },
        {
            "heading": "4.7. Class msnn",
            "text": "The implementation of A.I. have also been considered in this toolbox. The msnn class manages specialized neural network models for prediction. It is a class derived from mts, and has the same properties and methods. Additionally, it has a neural network container that must be trained using the FindParams method.\nThe neural network used can include covariates, which must be correctly prepared. The forecastoption\nand Covforecastoptions properties allow you to establish the working conditions of the neural network."
        },
        {
            "heading": "4.8. Helper classes",
            "text": "The Calmts class is a helper class that manages the database of events in the calendar, and provides the information needed to generate DIMS. The optim class is designed to contain the information needed during the parameter fetching process."
        },
        {
            "heading": "4.9. Graphical User Interface",
            "text": "In order to facilitate the user's work with the toolbox, a graphical user interface (GUI) has been developed. Using this GUI you can perform the basic functions of work with the objects described, since it allows you to obtain data from database sources, display the series and perform the relevant analysis.\nFIGURE 6 ABOUT HERE"
        },
        {
            "heading": "5. Application",
            "text": "To check the effectiveness of the toolbox presented here, application cases already published in previous works will be shown. In each case, the objective of the application is explained, and the effectiveness of the result of the forecasts will be verified by measuring the error in the forecasts. To do this, the Mean Average Percentage Percentage Error (MAPE%) will be used."
        },
        {
            "heading": "5.1. Spanish Electricity Demand Forecasting during Easter",
            "text": "The prediction of electricity demand in holiday periods usually carries with it the problem that the models are not specially designed for this situation. This causes the effectiveness of the forecasts to decline sharply. In order to deal with this situation, the models use modifiers such as dummy variables, which consider each particular case as a unique model. On other occasions, this special situation condition is simply analyzed and eliminated, and after applying the known prediction methods, the modification made is incorporated again.\nThe use of DIMS allows the singularity of special events to be introduced into the model itself, and where appropriate, for Easter, a festive period that lasts several days and with high variability. In Spain, Holy Friday is a holiday; Holy Thursday is a holiday depending on the region and the Monday after Easter in some regions it is a holiday, and in others, depending on the year, it is. This generates a particular situation of variability that the usual models fail to work correctly. DIMS, however, adapt naturally by being introduced as one more seasonality, albeit discreetly. In [19] a comparison was made using a double seasonal model, a TBATS (Exponential smoothing state space model with Box-Cox transformation, ARMA errors, Trend and Seasonal components) without modifying the series, and another modifying the series as shown. indicates in, a Shallow neural network model, and an nHWTDIMS model.\nThe indicator used to compare the results obtained is the Mean Absolute Percentage Error (MAPE%), which is the most commonly used for this purpose. Figure 7shows the results of the forecasts of the best models, where it can be seen how the nHWT-DIMS and the ANN stand out from the rest of the models.\nFIGURE 7 ABOUT HERE"
        },
        {
            "heading": "5.2. STLF in holidays and bridges",
            "text": "Following the same line of work, the use of DIMS was extended to the entire range of holidays and bridges that exist in the Spanish and French calendars [27]. Unlike the previous case, where there is a discrete seasonality that appears only once a year, we find on this occasion how a special event (holidays) occurs up to 9 or 10 times in a year, and another event (bridges) that is enormously volatile and occurs 3 or 4 times a year.\nThe variability that this situation provides means that the usual models resort to modeling these events as singular in which an additional treatment of the series, or an expressly rectified model make good predictions. The use of DIMS allows these anomalous demands to be integrated as part of the model itself. Distinguishing the type of event a priori, the model adjusts to the series without the need for modifications or filters, and makes predictions based on real information. Figure 8 shows a comparison of the results obtained using nHWT-DIMS and other methods described in [27]. The figure shows the MAPE(%) of 24-hours-ahead forecasts during special days. The subfigure (a) shows the results for the Spanish hourly electricity demand in the holidays (identified by name) and bridges (written as date). The models AMC24,168,Easter,Holidays,Bridges and NMC24,168,Easter,Holidays,Bridges show a better performance against the rest, with MAPEs under 5%. Only the best methods have been reported here.\nThe subfigure (b) shows the results of 48-midhours-ahead forecasting for special days in France,\nidentified by their name. It has been compared the results obtained to those reported by [57].\nFIGURE 8 ABOUT HERE"
        },
        {
            "heading": "6. Conclusions and future research",
            "text": "This article presents a new toolbox based on MATLAB\u00ae whose objective is the prediction of electrical demand using exponential smoothing methods with multiple seasonal Holt-Winters models. Neural networks are also available for benchmark purposes.\nFirstly, the general formulation for the nHWT models has been presented, both with additive and multiplicative trend, including damping. The model is presented valid so that the different seasonalities are included in the model in an additive or multiplicative way, independently of the rest. In the same way, the use of DIMS within the model allows situations with special events to be modeled internally, without the need for external modifications with exogenous variables.\nSecondly, the library itself has been described. On the one hand, the architecture of the library and its organization in classes are shown. The methods and properties associated with the different classes are described in depth, as well as their relationship with the parameters of the models. The article hovers over the most important, although sufficient to be able to carry out accurate predictions.\nTo demonstrate the functionality of the toolbox, tested and published application cases are included, in which the excellent results offered by the toolbox demonstrate the interest of its use. On the one hand, the application of the DIMS for forecasting demand in the Easter period has been shown, and then applied to all holidays (including long weekends).\nThis toolbox has been mainly used for short-term electricity demand prediction. Its formulation allows its use for longer periods, although it has not been optimized for this. The data used has been provided by the TSOs through their websites.\nFuture work related to this toolbox is the automation of selection processes for special events and the inclusion of new models. The use of DIMS has been shown to be effective, so they will be applied to new prediction methods."
        },
        {
            "heading": "APPENDIX A",
            "text": "The above notation can be complex, therefore it has been decided to use a section to explain the terms. First, Table 5 shows the equations of the model. The first column indicates the notation of the equations, while the rest of the columns describe it. All equations are in function of time \ud835\udc61. It is important to note that the seasonal indices have an associated superscript that indicates the ID of the seasonality. For example, if we use intraday seasonalities, we could use (\ud835\udc57) = (24) due to the seasonal length, or just (\ud835\udc57) = \ud835\udc51\ud835\udc56\ud835\udc4e\ud835\udc5f\ud835\udc66. This is the case of seasonalities that are included in the model in an additive way, but for multiplicative ones it would be denoted in the same way. The same goes for DIMS, although these are generally associated with events, such as Easter, Holidays, etc.\nTABLE 5 ABOUT HERE\nThe time subscript that accompanies the DIMS is different and includes a reference to the DIMS itself. The notation \ud835\udc61\ud835\udc56 \u2217 or its equivalents indicate that the time variable \ud835\udc61 is used, but only if the DIMS is defined for that instant. Similarly, the subscripts do indicate the length of the seasonal period considered, being, for example, for intraday seasonality \ud835\udc6024 = 24. In the case of DIMS, it works differently. The subscript is relative to the last occurrence of the DIMS prior to this instance, and therefore the length is determined at each occurrence. Trull et al. [27] describe this process. The equation ?\u0302?\ud835\udc61(\ud835\udc53) provides the \ud835\udc53-ahead point forecasts starting from the las observed value.\nThe equations also include smoothing parameters, which are described in the Table 7. For each seasonality considered, whether regular or DIMS, a delta described with superscripts will be used in the same way as in the previous case. The value of these parameters is bounded between 0 and 1, since in this way they respond stably to the models.\nSince the models are recursive, the initial values of the series must be obtained previously. The use of multiple seasonalities and, even more so, the use of DIMS, requires a complex process of obtaining parameters. The toolbox allows to use different methods according to [58], which the user decides.\nFinally, the influence of the value of the parameters on the predictions is fundamental. The process of optimizing the parameters is done through algorithms to minimize the prediction error in the set used for the adjustment. The toolbox allows the use of algorithms based on the Nelder-Mead simplex[59], genetic algorithms, BFGS and L-BFGS-B, among others [60].\nTABLE 7 ABOUT HERE\nFigure 1. Evolution of the number of publications related to electricity systems and focused on electricity demand forecasting. Source: own survey in JCR-indexed journals.\nFigure 2. Neural network diagram.\nFigure 3. Class diagram of the toolbox\n(a)\n(b)\nFigure 4. MSTL plot produced by the toolbox. (a) Regular seasonal decomposition, and remainder. (b) DIMS seasonal decomposition with the DIMS location in the time series.\n20000 40000 60000 80000 100000 120000\n20000\n30000\n40000\nSeries data\n20000 40000 60000 80000 100000 120000\n25000\n30000\n35000\nTrend\n20 40 60 80 100 120 140 160 180 200 220 240 -10000\n-5000\n0\nSeasonal (Period : 24)\n200 400 600 800 1000 1200 1400 1600 -10000\n-5000\n0\nSeasonal (Period : 168)\n0 20000 40000 60000 80000 100000 120000 -20000\n-10000\n0\nRemainder\n100 200 300 400 500 600 700 800 900 1000 -6000\n-4000\n-2000\n0\n2000\nDIMS Seasonal (Easter DIMS)\n20000 40000 60000 80000 100000 120000\n20000\n30000\n40000\nDIMS locations\n200 400 600 800 1000 1200 1400 1600 1800 2000 -10000\n-5000\n0\nDIMS Seasonal (Holidays DIMS)\n20000 40000 60000 80000 100000 120000\n20000\n30000\n40000\nDIMS locations\n100 200 300 400 500 600 700 800 900 1000 1100 1200\n-2000\n-1000\n0 DIMS Seasonal (Bridges DIMS)\n20000 40000 60000 80000 100000 120000\n20000\n30000\n40000\nDIMS locations\nFigure 5. forecasts produced by mshw object after optimizing the parameters.\nFigure 6. mtsgui is a graphical user interface to easily manage mts objects.\nFigure 7. Comparison of the accuracy while forecasting from several methods.\n(a)\n(b)\nFigure 8. Accuracy of the forecasts produced for (a) Hourly Electricity Demand and (b) Half-hourly electricity demand. Measured in MAPE."
        }
    ],
    "title": "mshw, a forecasting library to predict short-term electricity demand based on multiple seasonal Holt-Winters",
    "year": 2024
}