{
    "abstractText": "The evaluation of the interaction between objects arranged on a lattice requires the computation of lattice sums. A scenario frequently encountered are systems governed by the Helmholtz equation in the context of electromagnetic scattering in an array of particles forming a metamaterial, a metasurface, or a photonic crystal. While the convergence of direct lattice sums for such translation coefficients is notoriously slow, the application of Ewald\u2019s method converts the direct sums into exponentially convergent series. We present a derivation of such series for the 2D and 3D solutions of the Helmholtz equation, namely spherical and cylindrical solutions. When compared to prior research, our novel expressions are especially aimed at computing the lattice sums for several interacting sublattices in 1D lattices (chains), 2D lattices (gratings), and 3D lattices. We verify our results by comparison with the direct computation of the lattice sums.",
    "authors": [
        {
            "affiliations": [],
            "name": "Dominik Beutel"
        },
        {
            "affiliations": [],
            "name": "Ivan Fernandez-Corbaton"
        },
        {
            "affiliations": [],
            "name": "Carsten Rockstuhl"
        }
    ],
    "id": "SP:a1d368114e4ecd2b44aae3ffb6b7400f007a7b72",
    "references": [
        {
            "authors": [
                "V.K. Varadan",
                "V.V. Varadan"
            ],
            "title": "Acoustic",
            "venue": "electromagnetic and elastic wave scattering\u2013focus on the T-matrix approach ",
            "year": 1980
        },
        {
            "authors": [
                "P.C. Waterman"
            ],
            "title": "T-matrix methods in acoustic scattering",
            "venue": "The Journal of the Acoustical Society of America 125, 42 ",
            "year": 2009
        },
        {
            "authors": [
                "P.P. Ewald"
            ],
            "title": "Die Berechnung optischer und elektrostatischer Gitterpotentiale",
            "venue": "Annalen der Physik 369, 253 ",
            "year": 1921
        },
        {
            "authors": [
                "V.E. Babicheva",
                "A.B. Evlyukhin"
            ],
            "title": "Multipole lattice effects in high refractive index metasurfaces",
            "venue": "Journal of Applied Physics 129, 040902 ",
            "year": 2021
        },
        {
            "authors": [
                "A. Berkhout",
                "A.F. Koenderink"
            ],
            "title": "A simple transfermatrix model for metasurface multilayer systems",
            "venue": "Nanophotonics 9, 3985 ",
            "year": 2020
        },
        {
            "authors": [
                "Y. Chen",
                "Y. Zhang",
                "A.F. Koenderink"
            ],
            "title": "General point dipole theory for periodic metasurfaces: Magnetoelectric scattering lattices coupled to planar photonic structures",
            "venue": "Optics Express 25, 21358 ",
            "year": 2017
        },
        {
            "authors": [
                "P.G. Cummins",
                "D.A. Dunmur",
                "R.W. Munn",
                "R.J. Newham"
            ],
            "title": "Applications of the Ewald method",
            "venue": "I. Calculation of multipole lattice sums, Acta Crystallographica Section A: Crystal Physics, Diffraction, Theoretical and General Crystallography 32, 847 ",
            "year": 1976
        },
        {
            "authors": [
                "B. Gallinet",
                "A.M. Kern",
                "O.J.F. Martin"
            ],
            "title": "Accurate and versatile modeling of electromagnetic scattering on periodic nanostructures with a surface integral approach",
            "venue": "JOSA A 27, 2261 ",
            "year": 2010
        },
        {
            "authors": [
                "M. Goodarzi",
                "T. Pakizeh"
            ],
            "title": "Retrieving effective surface susceptibilities of high-index metasurfaces based on dipole approximation",
            "venue": "Optics Communications 483, 126659 ",
            "year": 2021
        },
        {
            "authors": [
                "G. Hu",
                "M. Wang",
                "Y. Mazor",
                "C.-W. Qiu",
                "A. Al\u00f9"
            ],
            "title": "Tailoring Light with Layered and Moir\u00e9 Metasurfaces",
            "venue": "Trends in Chemistry 3, 342 ",
            "year": 2021
        },
        {
            "authors": [
                "G. Lovat",
                "P. Burghignoli",
                "R. Araneo"
            ],
            "title": "Efficient Evaluation of the 3-D Periodic Green\u2019s Function Through the Ewald Method",
            "venue": "IEEE Transactions on Microwave Theory and Techniques 56, 2069 ",
            "year": 2008
        },
        {
            "authors": [
                "P. Lunnemann",
                "I. Sersic",
                "A.F. Koenderink"
            ],
            "title": "Optical properties of two-dimensional magnetoelectric point scattering lattices",
            "venue": "Physical Review B 88, 245109 ",
            "year": 2013
        },
        {
            "authors": [
                "P. Lunnemann",
                "A.F. Koenderink"
            ],
            "title": "The local density of optical states of a metasurface",
            "venue": "Scientific Reports 6, 20655 ",
            "year": 2016
        },
        {
            "authors": [
                "A. Rahimzadegan",
                "T.D. Karamanos",
                "R. Alaee",
                "A.G. Lamprianidis",
                "D. Beutel",
                "R.W. Boyd",
                "C. Rockstuhl"
            ],
            "title": "A Comprehensive Multipolar Theory for Periodic Metasurfaces",
            "venue": "Advanced Optical Materials 10, 2102059 ",
            "year": 2022
        },
        {
            "authors": [
                "M.S. Rider"
            ],
            "title": "\u00c1",
            "venue": "Buend\u0301\u0131a, D. R. Abujetas, P. A. Huidobro, J. A. S\u00e1nchez-Gil, and V. Giannini, Advances and Prospects in Topological Nanoparticle Photonics, ACS Photonics 9, 1483 ",
            "year": 2022
        },
        {
            "authors": [
                "N. Stefanou",
                "V. Yannopapas",
                "A. Modinos"
            ],
            "title": "Heterostructures of photonic crystals: Frequency bands and transmission coefficients",
            "venue": "Computer Physics Communications 113, 49 ",
            "year": 1998
        },
        {
            "authors": [
                "N. Stefanou",
                "V. Yannopapas",
                "A. Modinos"
            ],
            "title": "MULTEM 2: A new version of the program for transmission and band-structure calculations of photonic crystals",
            "venue": "Computer Physics Communications 132, 189 ",
            "year": 2000
        },
        {
            "authors": [
                "O.Y. Yermakov",
                "D.V. Permyakov",
                "F.V. Porubaev",
                "P.A. Dmitriev",
                "A.K. Samusev",
                "I.V. Iorsh",
                "R. Malureanu",
                "A.V. Lavrinenko",
                "A.A. Bogdanov"
            ],
            "title": "Effective surface conductivity of optical hyperbolic metasurfaces: From far-field characterization to surface wave analysis",
            "venue": "Scientific Reports 8, 14135 ",
            "year": 2018
        },
        {
            "authors": [
                "A. Moroz"
            ],
            "title": "Quasi-periodic Green\u2019s functions of the Helmholtz and Laplace equations",
            "venue": "Journal of Physics A: Mathematical and General 39, 11247 ",
            "year": 2006
        },
        {
            "authors": [
                "C.M. Linton"
            ],
            "title": "Lattice Sums for the Helmholtz Equation",
            "venue": "SIAM Review 52, 630 ",
            "year": 2010
        },
        {
            "authors": [
                "F. Capolino",
                "D. Wilton",
                "W. Johnson"
            ],
            "title": "Efficient computation of the 2-D Green\u2019s function for 1-D periodic structures using the Ewald method",
            "venue": "IEEE Transactions on Antennas and Propagation 53, 2977 ",
            "year": 2005
        },
        {
            "authors": [
                "F. Capolino",
                "D.R. Wilton",
                "W.A. Johnson"
            ],
            "title": "Efficient computation of the 3D Green\u2019s function for the Helmholtz operator for a linear array of point sources using the Ewald method",
            "venue": "Journal of Computational Physics 223, 250 ",
            "year": 2007
        },
        {
            "authors": [
                "S.K. Chin",
                "N.A. Nicorovici",
                "R.C. McPhedran"
            ],
            "title": "Green\u2019s function and lattice sums for electromagnetic scattering by a square array of cylinders",
            "venue": "Physical Review E 49, 4590 ",
            "year": 1994
        },
        {
            "authors": [
                "C. Craeye",
                "F. Capolino"
            ],
            "title": "Accelerated computation of the free space Green\u2019s function of semi-infinite phased arrays of dipoles",
            "venue": "IEEE Transactions on Antennas and Propagation 54, 1037 ",
            "year": 2006
        },
        {
            "authors": [
                "P.A. Belov",
                "C.R. Simovski"
            ],
            "title": "Boundary conditions for interfaces of electromagnetic crystals and the generalized Ewald-Oseen extinction principle",
            "venue": "Physical Review B 73, 045102 ",
            "year": 2006
        },
        {
            "authors": [
                "A. Dienstfrey",
                "F. Hang",
                "J. Huang"
            ],
            "title": "Lattice sums and the two-dimensional",
            "venue": "periodic Green\u2019s function for the Helmholtz equation, Proceedings of the Royal Society of London. Series A: Mathematical, Physical and Engineering Sciences 457, 67 ",
            "year": 2001
        },
        {
            "authors": [
                "V. Jandieri",
                "P. Baccarelli",
                "G. Valerio",
                "G. Schettini"
            ],
            "title": "1- 12 D Periodic Lattice Sums for Complex and Leaky Waves in 2-D Structures Using Higher Order Ewald Formulation",
            "venue": "IEEE Transactions on Antennas and Propagation 67, 2364 ",
            "year": 2019
        },
        {
            "authors": [
                "R.C. McPhedran",
                "N.A. Nicorovici",
                "L.C. Botten",
                "K.A. Grubits"
            ],
            "title": "Lattice sums for gratings and arrays",
            "venue": "Journal of Mathematical Physics 41, 7808 ",
            "year": 2000
        },
        {
            "authors": [
                "A. Moroz"
            ],
            "title": "On the Computation of the Free-Space Doubly-Periodic Green\u2019s Function of the Three- Dimensional Helmholtz Equation",
            "venue": "Journal of Electromagnetic Waves and Applications 16, 457 ",
            "year": 2002
        },
        {
            "authors": [
                "B. Su",
                "Y. Wu",
                "Y. Tang",
                "Y. Chen",
                "W. Cheng",
                "L. Jiang"
            ],
            "title": "Free-Standing 1D Assemblies of Plasmonic Nanoparticles",
            "venue": "Advanced Materials 25, 3968 ",
            "year": 2013
        },
        {
            "authors": [
                "S. Kruk",
                "A. Slobozhanyuk",
                "D. Denkova",
                "A. Poddubny",
                "I. Kravchenko",
                "A. Miroshnichenko",
                "D. Neshev",
                "Y. Kivshar"
            ],
            "title": "Edge States and Topological Phase Transitions in Chains of Dielectric Nanoparticles",
            "venue": "Small 13, 1603190 ",
            "year": 2017
        },
        {
            "authors": [
                "C.-L. Chen",
                "N.L. Rosi"
            ],
            "title": "Preparation of Unique 1-D Nanoparticle Superstructures and Tailoring their Structural Features",
            "venue": "Journal of the American Chemical Society 132, 6902 ",
            "year": 2010
        },
        {
            "authors": [
                "M.C. Rechtsman",
                "J.M. Zeuner",
                "Y. Plotnik",
                "Y. Lumer",
                "D. Podolsky",
                "F. Dreisow",
                "S. Nolte",
                "M. Segev",
                "A. Szameit"
            ],
            "title": "Photonic Floquet topological insulators",
            "venue": "Nature 496, 196 ",
            "year": 2013
        },
        {
            "authors": [
                "D. Theobald",
                "D. Beutel",
                "L. Borgmann",
                "H. Mescher",
                "G. Gomard",
                "C. Rockstuhl",
                "U. Lemmer"
            ],
            "title": "Simulation of light scattering in large",
            "venue": "disordered nanostructures using a periodic T-matrix method, Journal of Quantitative Spectroscopy and Radiative Transfer 272, 107802 ",
            "year": 2021
        },
        {
            "authors": [
                "Y. Moritake",
                "M. Ono",
                "M. Notomi"
            ],
            "title": "Far-field optical imaging of topological edge states in zigzag plasmonic chains",
            "venue": "Nanophotonics 11, 2183 ",
            "year": 2022
        },
        {
            "authors": [
                "K. Koshelev",
                "S. Lepeshov",
                "M. Liu",
                "A. Bogdanov",
                "Y. Kivshar"
            ],
            "title": "Asymmetric Metasurfaces with High- Q Resonances Governed by Bound States in the Continuum",
            "venue": "Physical Review Letters 121, 193903 ",
            "year": 2018
        },
        {
            "authors": [
                "C. Sun",
                "Z. Dong",
                "J. Si",
                "X. Deng"
            ],
            "title": "Independently tunable dual-band plasmonically induced transparency based on hybrid metal-graphene metamaterials at midinfrared frequencies",
            "venue": "Optics Express 25, 1242 ",
            "year": 2017
        },
        {
            "authors": [
                "P. Wang",
                "Y. Zheng",
                "X. Chen",
                "C. Huang",
                "Y.V. Kartashov",
                "L. Torner",
                "V.V. Konotop",
                "F. Ye"
            ],
            "title": "Localization and delocalization of light in photonic moir\u00e9 lattices",
            "venue": "Nature 577, 42 ",
            "year": 2020
        },
        {
            "authors": [
                "M. Ne\u010dada",
                "P. T\u00f6rm\u00e4"
            ],
            "title": "Multiple-Scattering T -Matrix Simulations for Nanophotonics: Symmetries and Periodic Lattices",
            "venue": "Communications in Computational Physics 30, 357 ",
            "year": 2021
        },
        {
            "authors": [
                "H. Solbrig"
            ],
            "title": "On the Ewald Summation Technique for 2D Lattices",
            "venue": "physica status solidi (a) 72, 199 ",
            "year": 1982
        },
        {
            "authors": [
                "K. Kambe"
            ],
            "title": "Theory of Low-Energy Electron Diffraction (I",
            "venue": "Application of the Cellular Method to Monatomic Layers), Zeitschrift f\u00fcr Naturforschung A 22, 322 ",
            "year": 1967
        },
        {
            "authors": [
                "K. Kambe"
            ],
            "title": "Theory of Low-Energy Electron Diffraction (II",
            "venue": "Cellular Method for Complex Monolayers and Multilayers), Zeitschrift f\u00fcr Naturforschung A 23, 1280 ",
            "year": 1968
        },
        {
            "authors": [
                "P.C. Waterman"
            ],
            "title": "Matrix formulation of electromagnetic scattering",
            "venue": "Proceedings of the IEEE 53, 805 ",
            "year": 1965
        },
        {
            "authors": [
                "M.I. Mishchenko"
            ],
            "title": "Comprehensive thematic T-matrix reference database: A 2017\u20132019 update",
            "venue": "Journal of Quantitative Spectroscopy and Radiative Transfer 242, 106692 ",
            "year": 2020
        },
        {
            "authors": [
                "V. Eyert"
            ],
            "title": "The Augmented Spherical Wave Method: A Comprehensive Treatment",
            "venue": "second edition ed., Lecture Notes in Physics No. 849 ",
            "year": 2012
        },
        {
            "authors": [
                "I.S. Grad\u0161tejn",
                "I.M. Ry\u017eik"
            ],
            "title": "Table of Integrals",
            "venue": "Series, and Products, edited by D. Zwillinger ",
            "year": 2014
        }
    ],
    "sections": [
        {
            "text": "Lattice Sums Accommodating Multiple Sublattices for Solutions of the Helmholtz Equation in Two and Three Dimensions\nDominik Beutel\u2217\nInstitute of Theoretical Solid State Physics, Karlsruhe Institute of Technology (KIT), 76131 Karlsruhe, Germany\nIvan Fernandez-Corbaton Institute of Nanotechnology, Karlsruhe Institute of Technology (KIT), 76344 Eggenstein-Leopoldshafen, Germany\nCarsten Rockstuhl Institute of Theoretical Solid State Physics, Karlsruhe Institute of Technology (KIT), 76131 Karlsruhe, Germany and Institute of Nanotechnology, Karlsruhe Institute of Technology (KIT), 76344 Eggenstein-Leopoldshafen, Germany\n(Dated: July 15, 2022)\nThe evaluation of the interaction between objects arranged on a lattice requires the computation of lattice sums. A scenario frequently encountered are systems governed by the Helmholtz equation in the context of electromagnetic scattering in an array of particles forming a metamaterial, a metasurface, or a photonic crystal. While the convergence of direct lattice sums for such translation coefficients is notoriously slow, the application of Ewald\u2019s method converts the direct sums into exponentially convergent series. We present a derivation of such series for the 2D and 3D solutions of the Helmholtz equation, namely spherical and cylindrical solutions. When compared to prior research, our novel expressions are especially aimed at computing the lattice sums for several interacting sublattices in 1D lattices (chains), 2D lattices (gratings), and 3D lattices. We verify our results by comparison with the direct computation of the lattice sums.\nThe calculation of lattice sums for solutions of the Helmholtz equation appears regularly in various fields of physics, such as electrodynamics, solid-state physics, or acoustics [1, 2]. A particularly useful tool to treat those sums is Ewald\u2019s method [3] with it various applications [4\u201318]. There, the slowly converging series is split into two parts. One of these parts converges rapidly in real space, and the other one converges rapidly after a transition into reciprocal space. In-depth discussions on this method applied to the Helmholtz equations can be found in several reviews [19, 20], and there exist various derivations for special cases [21\u201329].\nHowever, what has not yet been fully considered are lattices with multiple sublattices. Typical systems with multiple sublattices in different dimensions are chains with alternating distances between particles [30], zigzag chains [31], helical structures [32], or structures based on the honeycomb lattice [33]. Also, having many particles in one unit cell may require such lattice sums [34]. Photonic materials with multiple sublattices emerge in the context of many contemporary photonic materials. Examples are Su-Schrieffer-Heeger chains found in topological photonics [35], structures with an asymmetry in their unit cell to support bound states in the continuum [36], dolmen structures to observe plasmonically induced transparency [37], or Moire\u0301 lattices [38]. Conceptional illustrations showing such contemporary artificial photonic materials are presented in Fig. 1. We highlight the multiple sublattices by using red, blue, and green colors for the associated particles. To efficiently describe\n\u2217 dominik.beutel@kit.edu\nthe optical response from such photonic materials, we develop here novel approaches for Ewald\u2019s summations for lattices that contain multiple sublattices with arbitrary relative positions with respect to each other. That holds particularly for sublattices that have a relative displacement perpendicular to the lattice. Our sums are also useful to compute, e.g., the electromagnetic field at an arbitrary position within the unit cell, because this essentially is equivalent to a relative shift with respect to the objects in the lattice [39].\nThe goal of this article is two-fold: first, we present a way of deriving exponentially convergent expressions by extending an existing approach [40] that, second, is applicable to many of these problem of arbitrary positions in the unit cell of the lattice. Our novel approach reproduces known results for 2D lattices and spherical wave solutions [41, 42], but it is also able to derive expressions for multiple sublattices in the 2D case of cylindrical wave solutions and for 1D lattices.\nThe outline of the article is as follows. In Sec. I, we give a definition of the lattice sum and the notation used. In Sec. II, we treat the real space sum and, in Sec. III, the reciprocal space sum. For the reciprocal space sum, we derive closed form expressions for all cases individually. We conclude with a comparison of the presented expressions with results obtained from the direct summation approach in Sec. IV and an example application of the lattice sums to the T-matrix method [43, 44] in Sec. V. These numerical examples clearly demonstrate the usefulness and forte of our novel expressions.\nThe main results needed for an implementation are Eqs. (9) and (10) for the real space sum of cylindrical and spherical solutions, respectively, one of the Eqs. (20), (25), (30), and (35) for the reciprocal space sum depend-\nar X\niv :2\n20 7.\n06 93\n0v 1\n[ ph\nys ic\ns. op\ntic s]\n1 4\nJu l 2\n02 2\ning on the spatial dimension and the lattice dimension, and Eq. (14) as correction term for the origin contribution."
        },
        {
            "heading": "I. PROBLEM STATEMENT AND NOTATION",
            "text": "We define the lattice sum as Dd,\u03bd(\u039bd\u2032 , k,k\u2016, r) = \u2211\u2032\nR\u2208\u039bd\u2032 fd,\u03bd(k,\u2212r \u2212R)eik\u2016R (1)\nand derive expressions for the spatial dimensions d \u2208 {2, 3}. The second index \u03bd is a placeholder for the parameters of the function fd,\u03bd . The lattice \u039bd\u2032 is a set containing the d\u2032 \u2264 d dimensional lattice vectors defined by\n\u039bd\u2032 =  d\u2032\u2211 i=1 niai | ni \u2208 Z  , (2) where ai are the basis vectors of the lattice. We use k for the wave number and k\u2016 for the wave vector components in the d\u2032 dimensional reciprocal space. Later, we use the notation \u039b\u2217d\u2032 for the reciprocal space lattice defined analogously to Eq. (2) with basis vectors bj satisfying aibj = 2\u03c0\u03b4ij . The vector r \u2208 Rd describes the shift between sublattices, and it can be decomposed into a\ntangential component r\u2016 \u2208 Rd \u2032 and a normal component r\u22a5 \u2208 Rd\u2212d \u2032\nwith respect to the vectors of the lattice \u039bd\u2032 . On the right hand side of Eq. (1), the sum includes all lattice points with the exception that in the case of r + R = 0, i.e., if r coincides with a lattice point we omit that specific contribution. We use the prime next to the summation sign as a reminder of this ommission. Each term of the sum contains a phase factor and the scalar solutions of the Helmholtz equation for the chosen dimension d, namely\nf2,\u03bd(k, r) = H (1) m (k|r|)eim\u03d5r (3)\nand\nf3,\u03bd(k, r) = h (1) l (k|r|)Ylm(\u03b8r, \u03d5r) . (4)\nThus, the index \u03bd stands for m \u2208 Z, if d = 2, and for l \u2208 N0 and m \u2208 {\u2212l,\u2212l + 1, \u00b7 \u00b7 \u00b7 , l}, if d = 3. The functions H (1) m (x) are the Hankel functions of the first kind, h (1) l (x) are the spherical Hankel functions of the first kind, and Ylm(\u03b8, \u03d5) are the spherical harmonics. See appendix A for the used normalization convention. We also use the notation Ylm(r) = Ylm(\u03b8r, \u03d5r), where cos \u03b8r = z |r| and tan\u03d5r = y x are the polar and azimuthal angle of the vector r. These definitions lead to five different possible cases shown in Fig. 2. For d = 3, the lattice can have d\u2032 \u2208\n{1, 2, 3} as shown in panels (a) to (c). For d = 2 the lattice can have d\u2032 \u2208 {1, 2}.\nThe starting point for the evaluation of the sum expressed in Eq. (1) are the representations [45]\nH (1) l (x) =\n(\u22121) l\u2212|l| 2 2\ni\u03c0 x|l| \u221e\u222b (0) dt t2|l|\u22121e\u2212 x2t2 2 + 1 2t2 , l \u2208 Z\n(5) and\nh (1) l (x) = \u2212i\n\u221a 2 \u03c0 xl \u221e\u222b\n(0)\ndt t2le\u2212 x2t2 2 + 1 2t2 , l \u2208 N0 , (6)\nwhere we exchanged the azimuthal order index m for the case d = 2 with the letter l to highlight the similarity between the expressions for both cases. To ensure convergence, the integration contour has to be chosen such that |=(t)| > |<(t)| for t\u2192 0 at the lower boundary. The brackets around the lower boundary\u2019s value are used as a reminder for that choice of integration contour. Inserting these representations into the expression for Dd,\u03bd in\nEq. (1), we arrive at\nDd,\u03bd(\u039bd\u2032 , k,k\u2016, r) = \u2211\u2032\nR\u2208\u039bd\u2032\n2eik\u2016R\ni\u03c0 (k|r + R|)|l|\n\u00b7 \u221e\u222b\n(0)\ndt t2|l|\u22123+de\u2212 (k|r+R|t)2 2 + 1 2t2\n\u00b7\n{ (\u22121)\nl\u2212|l| 2 eil\u03d5\u2212r\u2212R d = 2\u221a\n\u03c0 2Ylm(\u2212r \u2212R) d = 3\n.\n(7)\nNow, the integration can be separated at some value \u03b7, which divides the sum into a long range (t > \u03b7) and a short range (t < \u03b7) contribution, each of which can be solved separately. Indeed, this separation converts the short range contribution into a quickly convergent series in real space and the long range contribution into a quickly convergent series after a transformation into reciprocal space. The following two sections are dedicated to these spaces individually."
        },
        {
            "heading": "II. REAL SPACE SUM",
            "text": "The short range part can be readily summed in real space. The only change to the expression in Eq. (7) is\n4 that the required integration changes to\nIn(x, \u03b7) = \u221e\u222b \u03b7 dt tne\u2212 x2t2 2 + 1 2t2 , (8)\nwhere n \u2265 \u22121. For a numerical implementation, this integral can be evaluated by recurrence (see appendix C). However, the lattice sum is evaluated in general with the expressions\nD (2) 2,l (\u039bd\u2032 , k,k\u2016, r) =\n(\u22121) l\u2212|l| 2 2\ni\u03c0\n\u2211\u2032 R\u2208\u039bd\u2032 ( (k|r + R|)|l|\n\u00b7I2|l|\u22121(k|r + R|, \u03b7)eil\u03d5\u2212r\u2212R+ik\u2016R ) (9)\nand\nD (2) 3,lm(\u039bd\u2032 , k,k\u2016, r) = \u2212i\n\u221a 2\n\u03c0 \u2211\u2032 R\u2208\u039bd\u2032 ( eik\u2016R(k|r + R|)|l|\n\u00b7I2|l|(k|r + R|, \u03b7)Ylm(\u2212r \u2212R) ) ,\n(10)\nwhere the total sum of Eq. (7) has been conventionally written in three terms as\nDd,\u03bd = D (0) d,\u03bd +D (1) d,\u03bd +D (2) d,\u03bd . (11)\nHere, we omitted the arguments of the different sums. The first two terms are related to the reciprocal space sum discussed in the next chapter. For an increasing length of the lattice vectors R, the summands quickly decrease due to the exponential factor in Eq. (8). Therefore, the lattice series can be truncated after including few lattice vectors. The expressions here make no assumptions on the orientation of the lattice for the cases when d\u2032 < d, but we will require the specific orientations shown in Fig. 2 for the reciprocal lattice sum. In the special case of r\u22a5 = 0, the symmetry of the solution sets together with the orientation of the lattices can lead to simplifications (appendix F) that can be used to reproduce the results for this special case [20]."
        },
        {
            "heading": "III. RECIPROCAL SPACE SUM",
            "text": "The long range contribution is summed in reciprocal space. For the transformation into reciprocal space, a\nfully periodic lattice is necessary, so the inclusion of the potentially missing summand at r + R = 0 in Eq. (7) needs to be compensated. This compensation contribution is independent of the lattice dimension and can be written as\nD (0) d\u03bd (\u039bd\u2032 , k,k\u2016, r) = \u2212 \u03b4l0\u03b4r0 i\u03c0 \u03b7\u222b (0) dt e 1 2t2 { 2 t d = 2 1\u221a 2 d = 3 ,\n(12) where we assume that r is in the Wigner-Seitz cell of the lattice, such that r + R = 0 implies r = 0 = R, and we use that all contributions except for l = 0 vanish due to the factor (k|r + R|)|l| in Eq. (7). We substitute the integration variable t = \u2212i\u221a\n2u and obtain the expression\nD (0) d,\u03bd(\u039bd\u2032 , k,k\u2016, r) = \u03b4l0\u03b4r0 \u221e\u222b \u2212 1\n2\u03b72\ndu e\u2212u { i u d = 2\n1\n4u 3 2\nd = 3\n(13) that can be readily evaluated using the upper incomplete gamma function\nD (0) d,\u03bd(\u039bd\u2032 , k,k\u2016, r) = \u03b4l0\u03b4r0  i \u03c0\u0393 ( 0,\u2212 12\u03b72 )\nd = 2\n1 4\u03c0\u0393 ( \u2212 12 ,\u2212 1 2\u03b72 ) d = 3 .\n(14) Note that the conditions on the lower boundary with the particular choice of substitution implies that the upper boundary becomes \u221e. Special care has to be taken also for the branch choice in the incomplete gamma function due to its negative argument. The substitution that was necessary for the integral transformation implies that one has to take the value for \u2212 12\u03b72 \u2212 i for \u2192 0 +, i.e., the value below the real axis.\nHaving dealt with the origin contribution, we now continue with the main part of the long range summation by the transformation to reciprocal space using the Poisson summation formula\n5 D (1) d,\u03bd(\u039bd\u2032 , k,k\u2016, r) = 2k|l|\ni\u03c0Vd\u2032 \u2211 G\u2208\u039b\u2217\nd\u2032\ne\u2212i(k\u2016+G)r\u2016 \u03b7\u222b\n(0)\ndt t2|l|\u22123+de 1 2t2\n\u00b7 \u222b Rd\u2032 dd \u2032 r\u2032|r\u2032 \u2212 r\u22a5||l| exp ( \u2212 (k|r \u2032 \u2212 r\u22a5|t)2 2 ) e\u2212i(k\u2016+G)r \u2032 { (\u22121) l\u2212|l| 2 eil\u03d5r\u2032\u2212r\u22a5 d = 2\u221a \u03c0 2Ylm(r \u2032 \u2212 r\u22a5) d = 3 (15)\nwhere we also performed a shift of the newly introduced integral over r\u2032 to absorb the component r\u2016 in the integral expression. We observe that components tangential to the lattice enter the expression now only with a phase factor e\u2212i(k\u2016+G)r\u2016 . Perpendicular shifts with respect to the lattice are considerably more difficult due to the way they appear in Eq. (15). The d\u2032 dimensional volume of the unit cell is Vd\u2032 .\nAt this point, it is necessary to individually treat the different cases of d and d\u2032. First, we consider full lattices, i.e., lattices where d = d\u2032. There, no perpendicular component exists, and the integrals are straightforwardly solved. However, the cases where d > d\u2032 are each solved separately. All possible cases are discussed in following sections."
        },
        {
            "heading": "A. Case: d = d\u2032",
            "text": "The two cases, d = 2 = d\u2032, and d = 3 = d\u2032, are among the most commonly found ones in literature, and the results are known [45]. However, we will rederive them here, since it is instructive to follow the different steps before applying them to the derivation of the more difficult expressions in the other cases.\nWe focus first on the integration\u222b Rd ddr\u2032 r\u2032|l|e\u2212 (kr\u2032t)2 2 e\u2212i(k\u2016+G)r \u2032 { eil\u03d5r\u2032 d = 2 Ylm(r \u2032) d = 3 (16)\nover r\u2032. We remark that in those cases, a perpendicular component to the lattice cannot exist, and we set r\u22a5 = 0 in Eq. (15). Using the expansions of the plane wave e\u2212i(k\u2016+G)r \u2032 suitable for the cases d = 2 and d = 3 (appendix B), we can perform the angular integration trivially due to the orthogonality of the angular functions. The remaining radial integration for the case d = 2 is\n(\u2212i)|l|eil\u03d5k\u2016+G \u221e\u222b\n0\ndr\u2032 r\u2032|l|+1e\u2212 (kr\u2032t)2 2 J|l|(\u03b2kr \u2032) (17)\nand\n4\u03c0(\u2212i)lYlm(k\u2016 + G) \u221e\u222b\n0\ndr\u2032 r\u2032|l|+2e\u2212 (kr\u2032t)2 2 jl(\u03b2kr \u2032) (18)\nfor the case d = 3, where we introduced \u03b2 = |k\u2016+G|\nk . The integral is in both cases essentially the same and can be found in literature [46, Eq. 6.631 4.]. Thus, we\u2019re now left with\nD (1) d,\u03bd(\u039bd, k,k\u2016, r) =\n4(\u2212i)l\niVdkd \u2211 G\u2208\u039b\u2217d e\u2212i(k\u2016+G)r\u03b2|l|\n\u00b7 \u03b7\u222b\n(0)\ndt t3 e \u03b32 2t2\n{ eil\u03d5k+G d = 2\n\u03c0Ylm(k\u2016 + G) d = 3 ,\n(19)\nwhere we use \u03b3 = \u221a\n1\u2212 \u03b22 with the square root chosen such, that it has a non-negative imaginary part. The remaining integral over t can be substituted to a simple exponential, that we write here as the incomplete gamma function\nD (1) d,\u03bd(\u039bd, k,k\u2016, r) =\n4(\u2212i)l\u22121\nVdkd \u2211 G\u2208\u039b\u2217d e\u2212i(k\u2016+G)r\u03b2|l|\n\u00b7\u03b3\u22122\u0393 ( 1,\u2212 \u03b3 2\n2\u03b72\n){ eil\u03d5k+G d = 2\n\u03c0Ylm(k\u2016 + G) d = 3\n(20)\nto highlight the similarities to the following cases. For the case of d = d\u2032, this calculation was quite straightforward compared to the other cases, especially since r\u22a5 6= 0 is not possible. However, the basic idea of the calculation \u2013 expanding the plane wave suitably and then using a direct evaluation of the integral \u2013 remains the same for d 6= d\u2032, although the details become more involved. They will be discussed in the following."
        },
        {
            "heading": "B. Case: d = 3, d\u2032 = 2",
            "text": "This case has been treated in-depth by Kambe [42], and a direct approach to the solution of this series exists for the case when r\u22a5 = 0 [40]. We now generalize that derivation to the case when r\u22a5 6= 0. We start with the expression in Eq. (15). Conventionally, we place the lattice in the z = 0 plane. By inserting r\u22a5 = zz\u0302 we obtain\n6 D (1) 3,lm(\u039b2, k,k\u2016, r) = \u221a 2\n\u03c0\nkl\niV2 \u2211 G\u2208\u039b\u22172 e\u2212i(k\u2016+G)r\u2016 \u03b7\u222b\n(0)\ndt t2le 1 2t2\n\u00b7 \u222b R2 d2r\u2032(r\u20322 + z2) l 2 e\u2212 k2(r\u20322+z2)t2 2 e\u2212i(k\u2016+G)r \u2032 Nl|m|e im\u03d5r\u2032 (\u22121) m\u2212|m| 2 P |m| l ( \u2212z\u221a r\u20322 + z2 ) , (21)\nwhere we have replaced the spherical harmonics with a more explicit expression (Eq. (A1)).\nNow, we replace the plane wave e\u2212i(k\u2016+G)r \u2032\nby a suitable expansion for the evaluation of the spatial integral. The integration domain covers the d\u2032 = 2 dimensional space and, therefore, the plane wave is expanded in cylindrical coordinates (Eq. (B1)). Now, the azimuthal angle integral can be solved trivially, because the phase factors involving \u03d5r match exactly. The remaining radial integral is \u221e\u222b 0 dr\u2032 r\u2032(r\u20322+z2) l 2 J|m|(\u03b2kr \u2032)e\u2212 (kr\u2032t)2 2 P |m| l ( \u2212z\u221a r\u20322 + z2 ) . (22) We insert a suitable representation of the Legendre polynomials (Eq. (A12)) to eliminate the factor (r\u20322 + z2) l 2 . Up to a sum over s \u2208 {0, 1, \u00b7 \u00b7 \u00b7 , b l\u2212|m|2 c} and the prefactors coming from the Legendre polynomial representation.\nThe integral in Eq. (22) can now be evaluated as\n\u221e\u222b 0 dr\u2032 r\u20321+|m|+2sJ|m|(\u03b2kr \u2032)e\u2212 (kr\u2032t)2 2\n= (s+ |m|)! |m|!\u03b2k ( k2t2\n2\n) 1+|m| 2 +s e\u2212 \u03b22 4t2M 1+|m| 2 +s, |m| 2\n( \u03b22\n2t2\n)\n= (s+ |m|)!\n\u03b2k\n( \u03b2\nkt2\n)1+|m|+2s (\u22121)se\u2212 \u03b22 2t2\n\u00b7 s\u2211\nn=0\n( s\nn ) (\u2212 \u03b222t2)\u2212n (s+ |m| \u2212 n)! ,\n(23)\nwhere we use the known result of the integral [46, Eq.\n6.631 1.] and use that M 1+|m| 2 +s, |m| 2\n( \u03b2 2\n2t2 ) is a special case\nof the Whittaker function that can be expressed as a finite sum of elementary functions (Eq. (E3)). Combining Eqs. (21), (23), and (A12), we obtain\nD (1) 3,lm(\u039b2, k,k\u2016, r) =\n\u221a 2(2l + 1)(l \u2212m)!(l +m)! i m\u22121\nV2k2 \u2211 G\u2208\u039b\u22172 e\u2212i(k\u2016+G)r\u2016eim\u03d5k\u2016+G \u03b7\u222b\n(0)\ndt e \u03b32 2t2 \u2212 k2z2t22\n\u00b7 b l\u2212|m|2 c\u2211 s=0 s\u2211 n=0 t2l\u22122\u22122|m|\u22124s+2n \u03b2|m|+2s\u22122n(\u2212kz)l\u2212|m|\u22122s(\u22121)n 22s+|m|\u2212n(s+ |m| \u2212 n)!n!(s\u2212 n)!(l \u2212 |m| \u2212 2s)! .\n(24)\nThe final step is now to simplify the expressions, especially the exponent of t, by making it only dependent on the outer sum index to improve the practicality for a software implementation. Lengthy, but straightforward manipulations of the two nested series (Eq. (D1)) lead to the expression\nD (1) 3,lm(\u039b2, k,k\u2016, r) = \u2211 G\u2208\u039b\u22172 e\u2212i(k\u2016+G)reim\u03d5k\u2016+G\nl\u2212|m|\u2211 n=0 S3,lmn,2(k, \u03b2, z)\u03b3 2n\u22121 \u221e\u222b \u2212 \u03b32\n2\u03b72\ndu\nu u\n1 2\u2212ne\u2212u+\n(\u03b3kz)2\n4u\n(25)\nwith\nS3,lmn,2(k, \u03b2, z) =\n\u221a (2l + 1)(l \u2212m)!(l +m)!(\u2212i)m\n(\u22122)lV2k2 min(l\u2212|m|,2n)\u2211\ns=n\n(\u2212kz)2n\u2212s\u03b2l\u2212s\n(2n\u2212 s)!(s\u2212 n)!( l+m\u2212s2 )!( l\u2212m\u2212s 2 )! .\n(26)\nFor this final expression, we also substitute t = \u2212i\u03b3\u221a 2u which, again, transforms the lower boundary to an integration to infinity. We emphasize that the sum over s runs only over either all even or all odd values, such that the factorials only take integer values. Thus, s takes on only values with the same parity as l + m. The sum S3,lmn,2 simplifies significantly if z = 0, where one gets the simpler expressions from Eq. (F1). Now, only the in-\n7 tegral for u has to be solved. If z = 0, the integral is the upper incomplete gamma function \u0393( 12\u2212n,\u2212 \u03b32 2\u03b72 ), otherwise it can be transformed to an integral Il (appendix C) that we defined already for the real space sum. The appearance of the incomplete gamma function with half integer values is typical for the case d \u2212 d\u2032 = 1 and will later also appear for d = 2 and d\u2032 = 1. When |r\u22a5| = 0, our result is equivalent to Kambe\u2019s expressions [42].\nWith our approach working for previously know cases,\nwe now apply it to 1D lattices where a derivation of an equivalent result is not known to us."
        },
        {
            "heading": "C. Case: d = 3, d\u2032 = 1",
            "text": "Here, we treat the one dimensional lattice in 3D space. We place the lattice along the z-axis of our coordinate systems (Fig. 2(c)). Then, starting from Eq. (15), we can obtain\nD (1) 3,lm(\u039b1, k, k\u2016, r) =\n\u221a 2kl\ni \u221a \u03c0V1 \u2211 G\u2208\u039b\u22171 e\u2212i(k\u2016+G)r\u2016 \u03b7\u222b\n(0)\ndt t2le 1 2t2\n\u00b7 \u221e\u222b \u2212\u221e dr\u2032(r\u20322 + \u03c12) l 2 e\u2212 k2(r\u20322+\u03c12)t2 2 e\u2212i(k\u2016+G)r \u2032 Nl|m|(\u22121) m\u2212|m| 2 eim\u03d5\u2212r\u22a5P |m| l ( r\u2032\u221a r\u20322 + \u03c12 ) , (27)\nwhere we used |r\u22a5| = \u03c1. Also, we can now use simple scalars k\u2016 = k\u2016e\u0302z and G = Ge\u0302z instead of vectors for the parallel wave vector component and the reciprocal lattice vectors. For lattices with d\u2032 = 1, there is no angular integration to do. We can reuse the expansion of the Legendre polynomials (Eq. (A12)) to remove the factor (r\u20322+\u03c12) l 2 , trading it instead for an additional sum. After inserting the expansion, we integrate over r\u2032 which is, again, an integral that can be found in literature [46,\n3.462 2.]\n\u221e\u222b \u2212\u221e dr\u2032e\u2212 k2r\u20322t2 2 e\u2212i(k\u2016+G)r \u2032 r\u2032l\u2212|m|\u22122s\n= (l \u2212m\u2212 2s)!\n\u221a 2\u03c0\nkt e\u2212\n\u03b22 2t2 ( \u2212 i\u03b2 kt2 )l\u2212|m|\u22122s\n\u00b7 b l\u2212|m|2 \u2212sc\u2211\nn=0\n( \u2212 t 2\n2\u03b22 )n (l \u2212 |m| \u2212 2s\u2212 2n)!n!\n(28)\nand results in a finite series. Now, we are ready to assemble the full expression\nD (1) 3,lm(\u039b1, k, k\u2016, r) =\n\u221a 2l+1 \u03c0 (l \u2212m)!(l +m)!\nikV1 (\u2212i)l+m \u2211 G\u2208\u039b\u22171 e\u2212i(k\u2016+G)r\u2016 \u03b7\u222b\n(0)\ndt e \u03b32 2t2 \u2212 k2\u03c12t22 eim\u03d5\u2212r\u22a5\nb l\u2212|m|2 c\u2211 s=0 b l\u2212|m|2 \u2212sc\u2211 n=0\n(k\u03c1)2s+|m|\n22s+|m|+n(s+ |m|)!s! t4s+2|m|+2n\u22121\u03b2l\u2212|m|\u22122s\u22122n\n(\u22121)n\n(l \u2212 |m| \u2212 2s\u2212 2n)!n!\n(29)\nfrom Eqs. (27), (28), and (A12). Here, we use \u03b2 = k\u2016 k , where k\u2016 is the (signed) scalar value of the parallel wave vector component. We can perform manipulations on the two nested finite series (Eq. (D2)) to finally get the\nexpression\nD (1) 3,lm(\u039b1, k, k\u2016, r) = e im\u03d5\u2212r\u22a5 \u2211 G\u2208\u039b\u22171 e\u2212i(k\u2016+G)r\u2016\nl\u2211 n=|m| S3,lmn,1(k, \u03b2, \u03c1) \u03b32n 4n \u221e\u222b \u2212 \u03b32\n2\u03b72\ndu\nu u\u2212ne\u2212u+\n(\u03b3k\u03c1)2\n4u\n(30)\n8 with\nS3,lmn,1(k, \u03b2, \u03c1) = (\u2212i)l+1im\n2V1k\n\u221a 2l + 1\n\u03c0 (l \u2212m)!(l +m)!\nmin(2n\u2212|m|,l)\u2211 s=n (k\u03c1)2n\u2212s\u03b2l\u2212s( n\u2212 s+m2 ) ! ( n\u2212 s\u2212m2 ) !(l \u2212 s)!(s\u2212 n)! .\n(31)\nAgain, the summation for s only takes values, such that the factorials have an integer argument, namely s must have the same parity as m.\nAs in the previous case, the expression can be simpli-\nfied significantly (Eq. (F2)) if \u03c1 = 0, where the remaining integral transforms to the incomplete gamma function \u0393(\u2212n,\u2212 \u03b3 2\n2\u03b72 ). If \u03c1 6= 0 the integral can, again, be computed by recurrence (appendix C)."
        },
        {
            "heading": "D. Case: d = 2, d\u2032 = 1",
            "text": "The last case left, treats the lattice sum on a 1D lattice for cylindrical solutions, which we place along the x-axis of our coordinate system (Fig. 2(e)). Then, Eq. (15) becomes\nD (1) 2,l (\u039b1, k, k\u2016, r) =\n2k|l|(\u22121) l\u2212|l| 2\ni\u03c0V1\n\u2211 G\u2208\u039b\u22171 e\u2212i(k\u2016+G)r\u2016 \u03b7\u222b\n(0)\ndt t2|l|\u22121e 1 2t2\n\u221e\u222b \u2212\u221e dr\u2032(r\u20322 + y2) |l| 2 e\u2212 k2(r\u20322+y2)t2 2 \u2212i(k\u2016+G)r\u2032 ( r\u2032 \u2212 i sgn(l)y\u221a r\u20322 + y2 )|l| .\n(32)\nHere we used r\u22a5 = ye\u0302y. The term in brackets to the right corresponds to eil\u03d5r\u2032\u2212r\u22a5 and its denominator cancels the factor (r\u20322 +y2) |l| 2 exactly. We can expand its numerator using the binomial theorem, which replaces it with a sum over s \u2208 {0, 1, \u00b7 \u00b7 \u00b7 , |l|}. The spatial integral over r\u2032 for each term in the expansion of the binomial is essentially the same as Eq. (28)\n\u221e\u222b \u2212\u221e dr\u2032 r\u2032se\u2212 kr\u20322t2 2 e\u2212i(k\u2016+G)r \u2032\n= s! \u221a 2\u03c0\nkt e\u2212\n\u03b22 2t2 ( \u2212 i\u03b2 kt2 )s b s2c\u2211 n=0\n( \u2212 t 2\n2\u03b22 )n (s\u2212 2n)!n!\n(33)\nand can be solved accordingly [46, 3.462 2.]. Combining these results, we get\nD (1) 2,l (\u039b1, k, k\u2016, r) =\n2il \u221a 2\ni \u221a \u03c0kV1 \u2211 G\u2208\u039b\u22171 e\u2212i(k\u2016+G)r\u2016\n\u03b7\u222b (0) dt e \u03b32 2t2 \u2212 k2y2t22 |l|\u2211 s=0 b s2c\u2211 n=0 t2(|l|\u22121\u2212s+n)(\u22121)s+n\n|l|!(\u2212 sgn(l)ky)|l|\u2212s\u03b2s\u22122n\n(s\u2212 2n)!n!2n(|l| \u2212 s)! .\n(34)\nSimilarly to the previous cases, we have two finite series, that can be rearranged to simplify the exponent of the\nintegration variable t (Eq. (D3)), finally arrive at\nD (1) 2,l (\u039b1, k, k\u2016, r) = \u2211 G\u2208\u039b\u22171 e\u2212i(k\u2016+G)r\u2016\n|l|\u2211 n=0 S2,ln,1(k, \u03b2, y)\u03b3 2n\u22121 \u221e\u222b \u2212 \u03b32\n2\u03b72\ndu\nu u\n1 2\u2212ne\u2212u+\n(\u03b3ky)2\n4u\n(35)\nwith\nS2,ln,1(k, \u03b2, y) = (\u2212i)l2\u221a \u03c0V1k\nmin(2n,|l|)\u2211 s=n (\u2212 sgn(l)ky)2n\u2212s\u03b2|l|\u2212s 2s(2n\u2212 s)!(|l| \u2212 s)!(s\u2212 n)!\n(36)\nagain after substituting t = \u2212i\u03b3\u221a 2u . Here, the sum in s takes every value in its range in contrast to the other cases. Major simplifications are possible when considering \u03c1 = 0 (Eq. (F3)), where the integral becomes, analogously to the d = 3, d\u2032 = 2 case, the incomplete gamma function \u0393( 12 \u2212 n,\u2212 \u03b32 2\u03b72 )."
        },
        {
            "heading": "IV. COMPARISON WITH THE DIRECT SUM",
            "text": "We verify and compare our results by evaluating the sum directly with an increasing number of lattice points and by using the novel expressions derived in this work.\nIn the first example, we use the values l = 2 and m = 0 in case of d = 3 and for m = 2 in case of d = 2. The shift vector is r = (0.2, 0.1, 0.3) for d = 3 and r = (0.1, 0.3)\nfor d = 2. The parallel component of the wave vector is k\u2016 = 0.3, k\u2016 = (\u22120.1, 0.2), and k\u2016 = (0.3,\u22120.1, 0.2) for the 1D, 2D, and 3D lattices, respectively. In all cases, we use k = 3 and a lattice pitch a = 1.9. The 2D and 3D lattice are square or, suitably, cubic.\nFor the chain there is mostly only one way to include lattice points in the direct summation, namely taking the origin unit cell and then expanding outwards on both sides. This summation scheme can be generalized to higher dimensions in a spherical or cubic fashion. This means that all points within a region defined by either a fixed Euclidean distance or a fixed Chebyshev distance from the reference unit cell are considered in the sum. We opt for the latter because of its better convergence behavior [20] and express the number of points considered by the number of layers n, i.e., all points with \u2016R\u2016\u221e \u2264 na.\nThe first row in Fig. 3 shows the results for d = 3 and d\u2032 \u2208 {1, 2, 3} in panels (a), (b), and (c), respec-\ntively. The second row shows the results for d = 2 and d\u2032 \u2208 {1, 2}. We observe in all five cases presented in Fig. 3(a)-(e) very fast oscillations of the direct sum, depending on the number of layers. For panels (a) and (d), corresponding to the chain, we included up to 105 layers, such that the fast oscillations are not resolved and appear as a blue area. Although converging fairly rapid initially, the direct summation needs more than 105 layers to deviate only by 10\u22124 from the Ewald\u2019s method result for d = 3 and d\u2032 = 1. For d = 2 and d\u2032 = 1 the convergence is even slower by up to two orders of magnitude. The exponentially fast converging result obtained with Eqs. (9) and (10) for the real part and Eqs. (20), (25), (30), and (35) for the reciprocal part is shown as a orange line.\nPanel (b) shows the results for d = 3 and d\u2032 = 2. Here, we included up to 1000 layers. In comparison to d\u2032 = 1, the convergence of the direct sum is more time consum-\n10\ning. To reach a relative accuracy of roughly 10\u22122, the contributions of over 4 million lattice points have to be evaluated. Such a deteriorating convergence behavior as d\u2032 gets closer to d is commonly found for direct summations. This is even more pronounced in panels (c) and (e), which show the results for the full lattices. Here, for the number of layers included, no convergence is visible at all but only oscillations\nIn summary, we find that the formulas derived converge quickly to a precise value suitable for numerical evaluations. While it is possible to improve the convergence of the direct summation by averaging over one or multiple oscillations (see appendix G), it is clear that the exponentially fast converging series are a major improvement.\nAdditionally to our first example, we also look into larger shifts |r\u22a5| away from the lattice and mainly the components that are not present for r\u22a5 = 0. For this, we choose the parameters l = 2 and m = 1 for d = 3 and m = 2 for d = 2. For d = 3 and d\u2032 = 2 we set r = (1.5, 1.1, 0.3), for d = 3 and d\u2032 = 1 we set r = (0.2, 0.1, 1.3), and for d = 2 and d\u2032 = 1 we set r = (0.1, 1.3). The values of k, a, and k\u2016 remain unchanged. The entries with l = 2 and m = 1 for d = 3 that are shown in panels (a) and (b) in Fig. 4 would be zero in case of r\u22a5 = 0, but it becomes non-zero when r\u22a5 6= 0. The direct summation in those cases converges comparably fast, and we can confirm that the derived formulas are correct. Panel (c) shows the result for d = 2 and d\u2032 = 1 with large r\u22a5. Also, in that case, the result of the derived exponentially convergent formula is approached by the direct summation with an increasing number of layers. However, the convergence is quite slow."
        },
        {
            "heading": "V. EXEMPLARY APPLICATION",
            "text": "A typical field of application for the lattice sum is in summing translation coefficients for vector spherical waves like they appear as part of the T-matrix method. Here, we apply the summation for a 1D lattice for vector spherical waves. The example system corresponds roughly to the sketch shown in Fig. 2(a). It consists of two spheres per unit cell with radii 40 nm and 60 nm and relative permittivity = 9 with a relative shift r = (70, 0, 80)T nm from the larger to the smaller sphere. The chain has a lattice constant of 200 nm and is illuminated with a plane wave of wavelength 500 nm under oblique incidence with a \u03c06 angle with respect to the xaxis.\nFigure 3(f) shows the field intensity in one unit cell. Using the T-matrix method together with the lattice sums, we can efficiently compute the electric field in the entire space outside the spheres. This example makes not only use of the lattice sums to translate the scattered fields between the two sublattices associated with each type of sphere for computing the mutual interaction but also uses them to translate the scattered field to each point in the sampled space to obtain the electric field within the unit cell."
        },
        {
            "heading": "VI. CONCLUSION",
            "text": "We presented a derivation of exponentially fast converging series for quasi-periodic Helmholtz equation sums in d = 2 and d = 3 spatial dimensions. Our approach is suitable to derive exponentially convergent series for arbitrary lattice dimensions d\u2032 \u2264 d. A special emphasis is placed on the applicability of the lattice sums to the case when there is a relative shift between multiple sublattices. This enables us to apply the sums to a wide range of applications.\n11\nFor an implementation of the exponentially fast lattice sum, the formulas in Eqs. (9), (10), (14), (20), (25), (30), and (35) can be directly used with the integrals evaluated by recursion."
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "D.B. and C.R. acknowledge support by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany\u2019s Excellence Strategy via the Excellence Cluster 3D Matter Made to Order (EXC\u2013 2082/1\u2013390761711) and from the Carl Zeiss Foundation via CZF-Focus@HEiKA.\n[1] V. K. Varadan and V. V. Varadan, Acoustic, electromagnetic and elastic wave scattering\u2013focus on the T-matrix approach (Pergamon Press, New York, 1980). [2] P. C. Waterman, T-matrix methods in acoustic scattering, The Journal of the Acoustical Society of America 125, 42 (2009). [3] P. P. Ewald, Die Berechnung optischer und elektrostatischer Gitterpotentiale, Annalen der Physik 369, 253 (1921). [4] V. E. Babicheva and A. B. Evlyukhin, Multipole lattice effects in high refractive index metasurfaces, Journal of Applied Physics 129, 040902 (2021). [5] A. Berkhout and A. F. Koenderink, A simple transfermatrix model for metasurface multilayer systems, Nanophotonics 9, 3985 (2020). [6] Y. Chen, Y. Zhang, and A. F. Koenderink, General point dipole theory for periodic metasurfaces: Magnetoelectric scattering lattices coupled to planar photonic structures, Optics Express 25, 21358 (2017). [7] P. G. Cummins, D. A. Dunmur, R. W. Munn, and R. J. Newham, Applications of the Ewald method. I. Calculation of multipole lattice sums, Acta Crystallographica Section A: Crystal Physics, Diffraction, Theoretical and General Crystallography 32, 847 (1976). [8] B. Gallinet, A. M. Kern, and O. J. F. Martin, Accurate and versatile modeling of electromagnetic scattering on periodic nanostructures with a surface integral approach, JOSA A 27, 2261 (2010). [9] M. Goodarzi and T. Pakizeh, Retrieving effective surface susceptibilities of high-index metasurfaces based on dipole approximation, Optics Communications 483, 126659 (2021). [10] G. Hu, M. Wang, Y. Mazor, C.-W. Qiu, and A. Alu\u0300, Tailoring Light with Layered and Moire\u0301 Metasurfaces, Trends in Chemistry 3, 342 (2021). [11] G. Lovat, P. Burghignoli, and R. Araneo, Efficient Evaluation of the 3-D Periodic Green\u2019s Function Through the Ewald Method, IEEE Transactions on Microwave Theory and Techniques 56, 2069 (2008). [12] P. Lunnemann, I. Sersic, and A. F. Koenderink, Optical properties of two-dimensional magnetoelectric point scattering lattices, Physical Review B 88, 245109 (2013). [13] P. Lunnemann and A. F. Koenderink, The local density of optical states of a metasurface, Scientific Reports 6, 20655 (2016). [14] A. Rahimzadegan, T. D. Karamanos, R. Alaee, A. G. Lamprianidis, D. Beutel, R. W. Boyd, and C. Rockstuhl, A Comprehensive Multipolar Theory for Periodic Metasurfaces, Advanced Optical Materials 10, 2102059 (2022).\n[15] M. S. Rider, A\u0301. Buend\u0301\u0131a, D. R. Abujetas, P. A. Huidobro, J. A. Sa\u0301nchez-Gil, and V. Giannini, Advances and Prospects in Topological Nanoparticle Photonics, ACS Photonics 9, 1483 (2022). [16] N. Stefanou, V. Yannopapas, and A. Modinos, Heterostructures of photonic crystals: Frequency bands and transmission coefficients, Computer Physics Communications 113, 49 (1998). [17] N. Stefanou, V. Yannopapas, and A. Modinos, MULTEM 2: A new version of the program for transmission and band-structure calculations of photonic crystals, Computer Physics Communications 132, 189 (2000). [18] O. Y. Yermakov, D. V. Permyakov, F. V. Porubaev, P. A. Dmitriev, A. K. Samusev, I. V. Iorsh, R. Malureanu, A. V. Lavrinenko, and A. A. Bogdanov, Effective surface conductivity of optical hyperbolic metasurfaces: From far-field characterization to surface wave analysis, Scientific Reports 8, 14135 (2018). [19] A. Moroz, Quasi-periodic Green\u2019s functions of the Helmholtz and Laplace equations, Journal of Physics A: Mathematical and General 39, 11247 (2006). [20] C. M. Linton, Lattice Sums for the Helmholtz Equation, SIAM Review 52, 630 (2010). [21] F. Capolino, D. Wilton, and W. Johnson, Efficient computation of the 2-D Green\u2019s function for 1-D periodic structures using the Ewald method, IEEE Transactions on Antennas and Propagation 53, 2977 (2005). [22] F. Capolino, D. R. Wilton, and W. A. Johnson, Efficient computation of the 3D Green\u2019s function for the Helmholtz operator for a linear array of point sources using the Ewald method, Journal of Computational Physics 223, 250 (2007). [23] S. K. Chin, N. A. Nicorovici, and R. C. McPhedran, Green\u2019s function and lattice sums for electromagnetic scattering by a square array of cylinders, Physical Review E 49, 4590 (1994). [24] C. Craeye and F. Capolino, Accelerated computation of the free space Green\u2019s function of semi-infinite phased arrays of dipoles, IEEE Transactions on Antennas and Propagation 54, 1037 (2006). [25] P. A. Belov and C. R. Simovski, Boundary conditions for interfaces of electromagnetic crystals and the generalized Ewald-Oseen extinction principle, Physical Review B 73, 045102 (2006). [26] A. Dienstfrey, F. Hang, and J. Huang, Lattice sums and the two-dimensional, periodic Green\u2019s function for the Helmholtz equation, Proceedings of the Royal Society of London. Series A: Mathematical, Physical and Engineering Sciences 457, 67 (2001). [27] V. Jandieri, P. Baccarelli, G. Valerio, and G. Schettini, 1-\n12\nD Periodic Lattice Sums for Complex and Leaky Waves in 2-D Structures Using Higher Order Ewald Formulation, IEEE Transactions on Antennas and Propagation 67, 2364 (2019). [28] R. C. McPhedran, N. A. Nicorovici, L. C. Botten, and K. A. Grubits, Lattice sums for gratings and arrays, Journal of Mathematical Physics 41, 7808 (2000). [29] A. Moroz, On the Computation of the Free-Space Doubly-Periodic Green\u2019s Function of the ThreeDimensional Helmholtz Equation, Journal of Electromagnetic Waves and Applications 16, 457 (2002). [30] B. Su, Y. Wu, Y. Tang, Y. Chen, W. Cheng, and L. Jiang, Free-Standing 1D Assemblies of Plasmonic Nanoparticles, Advanced Materials 25, 3968 (2013). [31] S. Kruk, A. Slobozhanyuk, D. Denkova, A. Poddubny, I. Kravchenko, A. Miroshnichenko, D. Neshev, and Y. Kivshar, Edge States and Topological Phase Transitions in Chains of Dielectric Nanoparticles, Small 13, 1603190 (2017). [32] C.-L. Chen and N. L. Rosi, Preparation of Unique 1-D Nanoparticle Superstructures and Tailoring their Structural Features, Journal of the American Chemical Society 132, 6902 (2010). [33] M. C. Rechtsman, J. M. Zeuner, Y. Plotnik, Y. Lumer, D. Podolsky, F. Dreisow, S. Nolte, M. Segev, and A. Szameit, Photonic Floquet topological insulators, Nature 496, 196 (2013). [34] D. Theobald, D. Beutel, L. Borgmann, H. Mescher, G. Gomard, C. Rockstuhl, and U. Lemmer, Simulation of light scattering in large, disordered nanostructures using a periodic T-matrix method, Journal of Quantitative Spectroscopy and Radiative Transfer 272, 107802 (2021). [35] Y. Moritake, M. Ono, and M. Notomi, Far-field optical imaging of topological edge states in zigzag plasmonic chains, Nanophotonics 11, 2183 (2022). [36] K. Koshelev, S. Lepeshov, M. Liu, A. Bogdanov, and Y. Kivshar, Asymmetric Metasurfaces with High- Q Resonances Governed by Bound States in the Continuum, Physical Review Letters 121, 193903 (2018). [37] C. Sun, Z. Dong, J. Si, and X. Deng, Independently tunable dual-band plasmonically induced transparency based on hybrid metal-graphene metamaterials at midinfrared frequencies, Optics Express 25, 1242 (2017). [38] P. Wang, Y. Zheng, X. Chen, C. Huang, Y. V. Kartashov, L. Torner, V. V. Konotop, and F. Ye, Localization and delocalization of light in photonic moire\u0301 lattices, Nature 577, 42 (2020). [39] M. Nec\u030cada and P. To\u0308rma\u0308, Multiple-Scattering T -Matrix Simulations for Nanophotonics: Symmetries and Periodic Lattices, Communications in Computational Physics 30, 357 (2021). [40] H. Solbrig, On the Ewald Summation Technique for 2D Lattices, physica status solidi (a) 72, 199 (1982). [41] K. Kambe, Theory of Low-Energy Electron Diffraction (I. Application of the Cellular Method to Monatomic Layers), Zeitschrift fu\u0308r Naturforschung A 22, 322 (1967). [42] K. Kambe, Theory of Low-Energy Electron Diffraction (II. Cellular Method for Complex Monolayers and Multilayers), Zeitschrift fu\u0308r Naturforschung A 23, 1280 (1968). [43] P. C. Waterman, Matrix formulation of electromagnetic scattering, Proceedings of the IEEE 53, 805 (1965). [44] M. I. Mishchenko, Comprehensive thematic T-matrix reference database: A 2017\u20132019 update, Journal of Quantitative Spectroscopy and Radiative Transfer 242, 106692\n(2020). [45] V. Eyert, The Augmented Spherical Wave Method: A\nComprehensive Treatment, second edition ed., Lecture Notes in Physics No. 849 (Springer, Heidelberg, 2012). [46] I. S. Grads\u030ctejn and I. M. Ryz\u030cik, Table of Integrals, Series, and Products, edited by D. Zwillinger (Elsevier Science, 2014). [47] P. M. Morse and H. Feshbach, Methods of Theoretical Physics (McGraw-Hill, New York, 1953). [48] W. Magnus, F. Oberhettinger, and R. P. Soni, Formulas and Theorems for the Special Functions of Mathematical Physics, 3rd ed., Die Grundlehren Der Mathematischen Wissenschaften in Einzeldarstellungen, Vol. 52 (Springer, 1966)."
        },
        {
            "heading": "Appendix A: Spherical harmonics and associated Legendre polynomials",
            "text": "The spherical harmonics we use are defined by\nYlm(\u03b8, \u03d5) =\n\u221a 2l \u2212 1\n4\u03c0 (l \u2212m)! (l +m)!\ufe38 \ufe37\ufe37 \ufe38\nNlm\nPml (cos \u03b8)e im\u03d5 , (A1)\nwhere Pml (x) are the Legendre polynomials\nPml (x) =(\u22121)m ( 1\u2212 x2 )m 2 dm\ndxm Pl(x) (A2)\n= (\u22121)m\n2ll!\n( 1\u2212 x2 )m 2 dl+m dxl+m ( x2 \u2212 1 )l , (A3)\nwhere Eq. (A2) defines the associated Legendre polynomials, in principle, only for m \u2265 0. After using using Rodrigues\u2019 formula for the Legendre polynomials,yy to arrive at Eq. (A3), the expression can be used for all |m| \u2264 l.\nTo derive the closed form expression for the associated Legendre polynomials in the main text, we begin with\nP |m| l (cos \u03b8r) = P |m| l\n( z\u221a\n\u03c12 + z2\n)\n= b l\u2212|m|2 c\u2211 j=0 (\u22121)j+|m|(l \u2212 2j)! 2l(l \u2212 |m| \u2212 2j)! ( l j )( 2l \u2212 2j l ) zl\u2212|m|\u22122j\u03c1|m|\u221a \u03c12 + z2 l\u22122j\n(A4)\nwhere r = (x, y, z)T and \u03c1 = \u221a x2 + y2, for the associated Legendre polynomials, which can be derived by evaluating Eq. (A2) and using the closed expression\nPl(x) = 1\n2l b l2 c\u2211 j=0 (\u22121)j ( l j )( 2l \u2212 2j l ) xl\u22122j (A5)\nfor the Legendre polynomials [46, Eq. 8.911 1.]. We\n13\nexpand \u221a \u03c12 + z2 2j to arrive at\nPml\n( z\u221a\n\u03c12 + z2\n)\n= (\u22121)|m|\u03c1|m| 2l \u221a \u03c12 + z2 l b l\u2212|m|2 c\u2211 j=0 (\u22121)j(l \u2212 2j)! (l \u2212 |m| \u2212 2j)! ( l j )( 2l \u2212 2j l )\n\u00b7 j\u2211 s=0 ( j s ) \u03c12szl\u2212|m|\u22122s . (A6)\nNow, we can rearrange the series to\nPml\n( z\u221a\n\u03c12 + z2\n)\n= (\u22121)|m|\u03c1|m| 2l \u221a \u03c12 + z2 l b l\u2212|m|2 c\u2211 s=0 \u03c12szl\u2212|m|\u22122s s!\n\u00b7 b l\u2212|m|2 c\u2211 j=s (\u22121)j(2l \u2212 2j)! (l \u2212 |m| \u2212 2j)!(l \u2212 j)!(j \u2212 s)!\n(A7)\nwhere the last sum fulfills\nf(l,m, s) = b l\u2212|m|2 c\u2211 j=s (\u22121)j(2l \u2212 2j)! (l \u2212 |m| \u2212 2j)!(l \u2212 j)!(j \u2212 s)! (A8)\n= (\u22121)s(l +m)!2l\u2212m\u22122s\n(l \u2212m\u2212 2s)!(s+m)! , (A9)\nwhich can be shown by using the recursion formula\nf(l+1,m, s) = 2(f(l,m, s)+(l+m)f(l,m\u22121, s) (A10)\nand the initial condition\nf(l,\u2212l, s) = \u03b4ls(\u22121)l . (A11)\nThus, combining Eq. (A7) and Eq. (A8), we arrive at\nPml\n( z\u221a\n\u03c12 + z2\n)\n= (\u22121) |m|+m 2\u221a\n\u03c12 + z2 l b l\u2212|m|2 c\u2211 s=0 \u03c12s+|m|zl\u2212|m|\u22122s\n\u00b7 (\u22121) s(l +m)!\n22s+|m|(l \u2212 |m| \u2212 2s)!(s+ |m|)!s! (A12)\nas our final expression for the associated Legendre polynomials, which we have generalized to negative values of m with\nP\u2212ml (x) = (\u22121) m (l \u2212m)!\n(l +m)! Pml (x) . (A13)"
        },
        {
            "heading": "Appendix B: Plane wave expansion",
            "text": "We use the expressions [47]\ne\u2212ikr = \u221e\u2211\nl=\u2212\u221e (\u2212i)|l|J|l|(kr)eil(\u03d5k\u2212\u03d5r) (B1)\nif k, r \u2208 R2 and\ne\u2212ikr =4\u03c0 \u221e\u2211 l=0 l\u2211 m=\u2212l (\u2212i)ljl(kr)Ylm(\u03b8k, \u03d5k)Y \u2217lm(\u03b8r, \u03d5r)\n(B2)\nif k, r \u2208 R3 to expand the plane waves using cylindrical and spherical coordinates."
        },
        {
            "heading": "Appendix C: Real and reciprocal space integral",
            "text": "The integral\nIn(x, \u03b1) = \u221e\u222b \u03b1 dt tne\u2212 z2t2 2 + 1 2t2 (C1)\nused for the real space part of the sum fulfils the recursion relation [41]\nIn(z, \u03b1) = (n+ 3)In+2(z, \u03b1)\u2212 z2In+4(z, \u03b1)\n+\u03b1n+3e\u2212 z2\u03b12 2 + 1 2\u03b12 , (C2)\nwhich can also be rearranged for increasing values of n instead of decreasing values. As initial values, two integrals have to be known for odd and even values of n, so in total 4 integrals. We evaluate the integrals for n \u2208 {\u22123,\u22122,\u22121, 0} directly. For n = \u22122 and n = 0, we construct the new integral\nzI0(z, \u03b1)\u00b1 iI\u22122(z, \u03b1) = \u221e\u222b \u03b1 dt ( z \u00b1 i t2 ) e\u2212 (zt\u2213 i t )2 2 \u2213iz\n= e\u2213iz \u221a 2 \u221e\u222b 1\u221a 2 (\u03b1z\u2213 i\u03b1 ) du e\u2212u 2 = \u221a \u03c0 2 e\u2213iz erfc ( \u03b1z \u2213 i\u03b1\u221a 2 ) .\n(C3)\nWith this result, the required initial integrals for the recursion over even numbers is\n14\nI0(z, \u03b1) =\n\u221a \u03c0\n2 \u221a 2z\n( e\u2212iz erfc ( \u03b1z \u2212 i\u03b1\u221a\n2\n) + eiz erfc ( \u03b1z + i\u03b1\u221a\n2\n)) (C4)\nI\u22122(z, \u03b1) = \u2212i \u221a \u03c0\n2 \u221a 2z\n( e\u2212iz erfc ( \u03b1z \u2212 i\u03b1\u221a\n2\n) \u2212 eiz erfc ( \u03b1z + i\u03b1\u221a\n2\n)) . (C5)\nIn the case n = \u22121, the integral becomes after a substitution u = z 2t2\n2\nI\u22121(z, \u03b1) = 1\n2 \u221e\u222b z2t2\n2\ndu\nu e\u2212ue\nz2 4u (C6a)\n= 1\n2 \u221e\u2211 n=0 1 n! ( z2 4 )n \u221e\u222b z2t2\n2\nduu\u2212n\u22121e\u2212u (C6b)\n= 1\n2 \u221e\u2211 n=0 1 n! ( z2 4 )n \u0393 ( \u2212n, z 2t2 2 ) . (C6c)\nThis summation converges quite fast and can be truncated for a numerical evaluation. Similarly, we derive\nI\u22123(z, \u03b1) = \u221e\u2211 n=0 1 n! ( z2 4 )n+1 \u0393 ( \u2212n\u2212 1, z 2t2 2 ) . (C7)\nWith these four starting values we can use the recursion formula for positive and negative values of n.\nThe reciprocal space integral reads\n\u221e\u222b \u2212 \u03b32\n2\u03b72\ndu\nu une\u2212u+\n(\u03b3kz)2\n4u (C8)\nfor n either integer or half integer numbers. This integral can be transformed to the integral Il. For this, we take the substitution t = \u221a\n2u k\u03b3z resulting in\n2\n( k2\u03b32z2\n2 )n \u221e\u222b \u2212 ikz\u03b7 dt t2n\u22121e\u2212 (k\u03b3zt)2 2 + 1 2t2\n= 2\n( k2\u03b32z2\n2\n)n I2n\u22121 ( k\u03b3z,\u2212 i\nkz\u03b7\n) , (C9)\nwhich has the exact same form as the real space integral. Therefore, it can be calculated with Eq. (C2) in combination with the previously derived initial values."
        },
        {
            "heading": "Appendix D: Sum manipulations",
            "text": "In the main text, the following manipulations of the summation indices are used.\n1. d = 3, d\u2032 = 2\nb l\u2212|m|2 c\u2211 s=0 s\u2211 n=0 as,n = b l\u2212|m|2 c\u2211 s=0 l\u2212|m|\u2212s\u2211 w=l\u2212|m|\u22122s as,w\u2212l+|m|+2s\n= l\u2212|m|\u2211 w=0 min(l\u2212|m|,b l\u2212|m|2 c)\u2211 s=d l\u2212|m|\u2212n2 e as,w\u2212l+|m|+2s\n= l\u2212|m|\u2211 w=0 min(l\u2212|m|,2w)\u2211 v=w a l\u2212|m|\u22122w+v 2 ,v\u2212w\n(D1)\nwhere v in the last line only takes values with the same parity as l \u2212 |m|.\n2. d = 3, d\u2032 = 1\nb l\u2212|m|2 c\u2211 s=0 b l\u2212|m|2 c\u2212s\u2211 n=0 as,n = b l\u2212|m|2 c\u2211 s=0 b l+|m|2 c+s\u2211 w=|m|+2s as,w\u2212|m|\u22122s\n= l\u2211 w=|m| bw\u2212|m|2 c\u2211 s=max(0,n\u2212b l+|m|2 c) as,w\u2212|m|\u22122s\n= l\u2211 w=|m| min(2n\u2212|m|,l)\u2211 v=w a w\u2212 v+|m|2 ,v\u2212w\n(D2)\nwhere v in the last line only takes values with the same parity as |m|.\n15\n3. d = 2, d\u2032 = 1\n|l|\u2211 s=0 b s2c\u2211 n=0 as,n = |l|\u2211 s=0 |l|\u2212d s2e\u2211 w=|l|\u2212s as,w+s\u2212|l|\n= |l|\u2211 w=0 min(|l|,2|l|\u22122w)\u2211 s=|l|\u2212w as,w+s\u2212|l|\n= |l|\u2211 w=0 min(2w,|l|)\u2211 v=w av+|l|\u22122w,v\u2212w\n(D3)"
        },
        {
            "heading": "Appendix E: Whittaker function",
            "text": "It holds that\nM 1+|m| 2 +s, |m| 2\n(z) = e z 2 z 1\u2212|m| 2 |m|! (|m|+ s)! ds dzs (e\u2212zz|m|+s) (E1)\nfor n \u2208 N and m \u2208 Z [48, sec. 7.2.4]. With the generalized product rule for derivatives\nds\ndzs (f(z)g(z)) = s\u2211 n=0 ( s n )( ds\u2212n dzs\u2212n f(z) )( dn dzn g(z) ) ,\n(E2)\nwe obtain the expression\nM 1+|m| 2 +s, |m| 2\n(z) = e\u2212 z 2 |m|! s\u2211 n=0 ( s n ) z 1+|m| 2 (\u2212z)s\u2212n (|m|+ s\u2212 n)! .\n(E3)"
        },
        {
            "heading": "Appendix F: Simplifications for r\u22a5 = 0",
            "text": "The following simplifications in the reciprocal space sum can be obtained for a vanishing shift perpendicular to the lattice\nS3,lmn,2(k, \u03b2, 0) =  \u221a (2l+1)(l\u2212m)!(l+m)! (\u22122)lV2k2\n\u03b2l\u22122n\nn!( l\u2212m2 \u2212n)( l+m 2 \u2212n) n \u2264\n\u230a l\u2212|m|\n2\n\u230b and l \u2212m even\n0 otherwise (F1)\nS3,lmn,1(k, \u03b2, 0) =\n{ (\u2212i)l+1l!\n2V1k\n\u221a 2l+1 \u03c0 \u03b2l\u22122n n!(l\u22122n)! n \u2264 \u230a l 2 \u230b and m = 0\n0 otherwise (F2)\nS2,ln,1(k, \u03b2, 0) =\n{ 2(\u2212i)l\u221a \u03c0V1k \u03b2|l|\u22122n 4nn!(|l|\u22122n)! n \u2264 \u230a |l| 2 \u230b 0 otherwise\n(F3)\nwhich reproduce equivalent expressions as those in [20]. Due to the properties of the spherical harmonics and the complex exponential function, there can also be some simplifications for the real space sum if there is no perpendicular component of the shift r\u22a5 = 0, and the lattice is placed along certain high symmetry directions, which is done for the derivation of the reciprocal space integral anyhow. These simplifications are listed in Table I."
        },
        {
            "heading": "Appendix G: Direct computation with averaging over oscillations",
            "text": "To improve the convergence of the direct summation, it is possible to average over oscillations. The results shown in Fig. 5 are obtained from the data in Fig. 3.\n16"
        }
    ],
    "title": "Lattice Sums Accommodating Multiple Sublattices for Solutions of the Helmholtz Equation in Two and Three Dimensions",
    "year": 2022
}