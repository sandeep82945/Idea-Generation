{
    "abstractText": "Forecasting the state of vegetation in response to climate and weather events is a major challenge. Its implementation will prove crucial in predicting crop yield, forest damage, or more generally the impact on ecosystems services relevant for socio-economic functioning, which if absent can lead to humanitarian disasters. Vegetation status depends on weather and environmental conditions that modulate complex ecological processes taking place at several timescales. Interactions between vegetation and different environmental drivers express responses at instantaneous but also time-lagged effects, often showing an emerging spatial context at landscape and regional scales. We formulate the land surface forecasting task as a strongly guided video prediction task where the objective is to forecast the vegetation developing at very fine resolution using topography and weather variables to guide the prediction. We use a Convolutional LSTM (ConvLSTM) architecture to address this task and predict changes in the vegetation state in Africa using Sentinel-2 satellite NDVI, having ERA5 weather reanalysis, SMAP satellite measurements, and topography (DEM of SRTMv4.1) as variables to guide the prediction. Ours results highlight how ConvLSTM models can not only forecast the seasonal evolution of NDVI at high resolution, but also the differential impacts of weather anomalies over the baselines. The model is able to predict different vegetation types, even those with very high NDVI variability during target length, which is promising to support anticipatory actions in the context of drought-related disasters 1.",
    "authors": [
        {
            "affiliations": [],
            "name": "Claire Robin"
        },
        {
            "affiliations": [],
            "name": "Christian Requena-Mesa"
        },
        {
            "affiliations": [],
            "name": "Vitus Benson"
        },
        {
            "affiliations": [],
            "name": "Lazaro Alonso"
        },
        {
            "affiliations": [],
            "name": "Jeran Poehls"
        },
        {
            "affiliations": [],
            "name": "Nuno Carvalhais"
        },
        {
            "affiliations": [],
            "name": "Markus Reichstein"
        }
    ],
    "id": "SP:094a75aba8f00bb8851c71c50c62c5232b427c45",
    "references": [
        {
            "authors": [
                "Hans O P\u00f6rtner",
                "Debra C Roberts",
                "Helen Adams",
                "Carolina Adler",
                "Paulina Aldunce",
                "Elham Ali",
                "Rawshan Ara Begum",
                "Richard Betts",
                "Rachel Bezner Kerr",
                "Robbert Biesbroek"
            ],
            "title": "Climate change 2022: impacts, adaptation and vulnerability",
            "year": 2022
        },
        {
            "authors": [
                "N Yaghmaei",
                "R Below"
            ],
            "title": "Disasters in africa: 20 year review (2000-2019)",
            "venue": "CRED Crunch,",
            "year": 2019
        },
        {
            "authors": [
                "Zia Mehrabi",
                "Simon Donner",
                "Patricia Rios",
                "Debarati Guha-Sapir",
                "Pedram Rowhani",
                "Milind Kandlikar",
                "Navin Ramankutty"
            ],
            "title": "Can we sustain success in reducing deaths to extreme weather in a hotter world",
            "venue": "World Development Perspectives,",
            "year": 2019
        },
        {
            "authors": [
                "Felix N Kogan"
            ],
            "title": "Remote sensing of weather impacts on vegetation in non-homogeneous areas",
            "venue": "International Journal of remote sensing,",
            "year": 1990
        },
        {
            "authors": [
                "Jon D Pelletier",
                "A Brad Murray",
                "Jennifer L Pierce",
                "Paul R Bierman",
                "David D Breshears",
                "Benjamin T Crosby",
                "Michael Ellis",
                "Efi Foufoula-Georgiou",
                "Arjun M Heimsath",
                "Chris Houser"
            ],
            "title": "Forecasting the response of earth\u2019s surface to future climatic and land use changes: A review of methods and research needs",
            "venue": "Earth\u2019s Future,",
            "year": 2015
        },
        {
            "authors": [
                "Joan Sturm",
                "Maria J Santos",
                "Bernhard Schmid",
                "Alexander Damm"
            ],
            "title": "Satellite data reveal differential responses of swiss forests to unprecedented 2018 drought",
            "venue": "Global Change Biology,",
            "year": 2022
        },
        {
            "authors": [
                "Kiona Ogle",
                "Jarrett J Barber",
                "Greg A Barron-Gafford",
                "Lisa Patrick Bentley",
                "Jessica M Young",
                "Travis E Huxman",
                "Michael E Loik",
                "David T Tissue"
            ],
            "title": "Quantifying ecological memory in plant and ecosystem processes",
            "venue": "Ecology letters,",
            "year": 2015
        },
        {
            "authors": [
                "Christina Papagiannopoulou",
                "Diego G Miralles",
                "Stijn Decubber",
                "Matthias Demuzere",
                "Niko EC Verhoest",
                "Wouter A Dorigo",
                "Willem Waegeman"
            ],
            "title": "A non-linear granger-causality framework to investigate climate\u2013vegetation dynamics",
            "venue": "Geoscientific Model Development,",
            "year": 1945
        },
        {
            "authors": [
                "Jill F Johnstone",
                "Craig D Allen",
                "Jerry F Franklin",
                "Lee E Frelich",
                "Brian J Harvey",
                "Philip E Higuera",
                "Michelle C Mack",
                "Ross K Meentemeyer",
                "Margaret R Metz",
                "George LW Perry"
            ],
            "title": "Changing disturbance regimes, ecological memory, and forest resilience",
            "venue": "Frontiers in Ecology and the Environment,",
            "year": 2016
        },
        {
            "authors": [
                "Wanda De Keersmaecker",
                "Stef Lhermitte",
                "Laurent Tits",
                "Olivier Honnay",
                "Ben Somers",
                "Pol Coppin"
            ],
            "title": "A model quantifying global vegetation resistance and resilience to short-term climate anomalies and their relationship with vegetation cover",
            "venue": "Global Ecology and Biogeography,",
            "year": 2015
        },
        {
            "authors": [
                "Basil Kraft",
                "Martin Jung",
                "Marco K\u00f6rner",
                "Christian Requena Mesa",
                "Jos\u00e9 Cort\u00e9s",
                "Markus Reichstein"
            ],
            "title": "Identifying dynamic memory effects on vegetation state using recurrent neural networks",
            "venue": "Frontiers in big Data,",
            "year": 2019
        },
        {
            "authors": [
                "Alistair WR Seddon",
                "Marc Macias-Fauria",
                "Peter R Long",
                "David Benz",
                "Kathy J Willis"
            ],
            "title": "Sensitivity of global terrestrial ecosystems to climate",
            "venue": "variability. Nature,",
            "year": 2016
        },
        {
            "authors": [
                "Ana Bastos",
                "Ren\u00e9 Orth",
                "Markus Reichstein",
                "Philippe Ciais",
                "Nicolas Viovy",
                "S\u00f6nke Zaehle",
                "Peter Anthoni",
                "Almut Arneth",
                "Pierre Gentine",
                "Emilie Joetzjer"
            ],
            "title": "Vulnerability of european ecosystems to two compound dry and hot summers",
            "venue": "Earth system dynamics,",
            "year": 2018
        },
        {
            "authors": [
                "Sebastian Sippel",
                "Jakob Zscheischler",
                "Markus Reichstein"
            ],
            "title": "Ecosystem impacts of climate extremes crucially depend on the timing",
            "venue": "Proceedings of the National Academy of Sciences,",
            "year": 2016
        },
        {
            "authors": [
                "Compton J Tucker"
            ],
            "title": "Red and photographic infrared linear combinations for monitoring vegetation",
            "venue": "Remote sensing of Environment,",
            "year": 1979
        },
        {
            "authors": [
                "Erin Coughlan de Perez",
                "Bart Van den Hurk",
                "Marcel van Aalst",
                "Brenden Jongman",
                "T. Klose",
                "Pablo Suarez"
            ],
            "title": "Forecast-based financing: an approach for catalyzing humanitarian action based on extreme weather and climate forecasts",
            "venue": "Natural Hazards and Earth System Sciences,",
            "year": 2014
        },
        {
            "authors": [
                "Reinhard Mechler"
            ],
            "title": "Cost-benefit analysis of natural disaster risk management in developing countries",
            "venue": "Eschborn: Deutsche Gesellschaft fu\u0308r Technische Zusammenarbeit (GTZ),",
            "year": 2005
        },
        {
            "authors": [
                "Chris Hillbruner",
                "Grainne Moloney"
            ],
            "title": "When early warning is not enough\u2014lessons learned from the 2011 somalia famine",
            "venue": "Global Food Security,",
            "year": 2012
        },
        {
            "authors": [
                "Daniel Maxwell",
                "Merry Fitzpatrick"
            ],
            "title": "The 2011 somalia famine: Context, causes, and complications",
            "venue": "Global Food Security,",
            "year": 2012
        },
        {
            "authors": [
                "David R Easterling"
            ],
            "title": "Global data sets for analysis of climate extremes. In Extremes in a Changing Climate, pages 347\u2013361",
            "year": 2013
        },
        {
            "authors": [
                "Jonas Koehler",
                "Claudia Kuenzer"
            ],
            "title": "Forecasting spatio-temporal dynamics on the land surface using earth observation data\u2014a review",
            "venue": "Remote Sensing,",
            "year": 2020
        },
        {
            "authors": [
                "Andrea Gobbi",
                "Marco Cristoforetti",
                "Giuseppe Jurman",
                "Cesare Furlanello"
            ],
            "title": "High resolution forecasting of heat waves impacts on leaf area index by multiscale multitemporal deep learning",
            "year": 1909
        },
        {
            "authors": [
                "Monidipa Das",
                "Soumya K Ghosh"
            ],
            "title": "Deep-step: A deep learning approach for spatiotemporal prediction of remote sensing data",
            "venue": "IEEE Geoscience and Remote Sensing Letters,",
            "year": 1984
        },
        {
            "authors": [
                "Joshua Fan",
                "Junwen Bai",
                "Zhiyun Li",
                "Ariel Ortiz-Bobea",
                "Carla P Gomes"
            ],
            "title": "A gnn-rnn approach for harnessing geospatial and temporal information: application to crop yield prediction",
            "venue": "arXiv preprint arXiv:2111.08900,",
            "year": 2021
        },
        {
            "authors": [
                "Changlu Cui",
                "Wen Zhang",
                "ZhiMing Hong",
                "LingKui Meng"
            ],
            "title": "Forecasting ndvi in multiple complex areas using neural network techniques combined feature engineering",
            "venue": "International Journal of Digital Earth,",
            "year": 2020
        },
        {
            "authors": [
                "Lingjun Kang",
                "Liping Di",
                "Meixia Deng",
                "Eugene Yu",
                "Yang Xu"
            ],
            "title": "Forecasting vegetation index based on vegetation-meteorological factor interactions with artificial neural network",
            "venue": "Fifth International Conference on Agro-Geoinformatics (Agro-Geoinformatics),",
            "year": 2016
        },
        {
            "authors": [
                "Thomas Lees",
                "Gabriel Tseng",
                "Clement Atzberger",
                "Steven Reece",
                "Simon Dadson"
            ],
            "title": "Deep learning for vegetation health forecasting: a case study in kenya",
            "venue": "Remote Sensing,",
            "year": 2022
        },
        {
            "authors": [
                "Andreas Kamilaris",
                "Francesc X"
            ],
            "title": "Prenafeta-Bold\u00fa. Deep learning in agriculture: A survey",
            "venue": "Computers and electronics in agriculture,",
            "year": 2018
        },
        {
            "authors": [
                "Bernhard Schauberger",
                "Jonas J\u00e4germeyr",
                "Christoph Gornott"
            ],
            "title": "A systematic review of local to regional yield forecasting approaches and frequently used data resources",
            "venue": "European Journal of Agronomy,",
            "year": 2020
        },
        {
            "authors": [
                "Saeed Khaki",
                "Lizhi Wang",
                "Sotirios V Archontoulis"
            ],
            "title": "A cnn-rnn framework for crop yield prediction",
            "venue": "Frontiers in Plant Science,",
            "year": 2020
        },
        {
            "authors": [
                "Christian Requena-Mesa",
                "Vitus Benson",
                "Markus Reichstein",
                "Jakob Runge",
                "Joachim Denzler"
            ],
            "title": "Earthnet2021: A large-scale dataset and challenge for earth surface forecasting as a guided video prediction task",
            "venue": "In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition,",
            "year": 2021
        },
        {
            "authors": [
                "Codrut",
                "-Andrei Diaconu",
                "Sudipan Saha",
                "Stephan G\u00fcnnemann",
                "Xiao Xiang Zhu"
            ],
            "title": "Understanding the role of weather data for earth surface forecasting using a convlstm-based model",
            "venue": "In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition,",
            "year": 2022
        },
        {
            "authors": [
                "Klaus-Rudolf William Kladny",
                "Marco Milanta",
                "Oto Mraz",
                "Koen Hufkens",
                "Benjamin David Stocker"
            ],
            "title": "Deep learning for satellite image forecasting of vegetation greenness",
            "venue": "bioRxiv,",
            "year": 2022
        },
        {
            "authors": [
                "Hans Hersbach",
                "Bill Bell",
                "Paul Berrisford",
                "Shoji Hirahara",
                "Andr\u00e1s Hor\u00e1nyi",
                "Joaqu\u00edn Mu\u00f1oz- Sabater",
                "Julien Nicolas",
                "Carole Peubey",
                "Raluca Radu",
                "Dinand Schepers"
            ],
            "title": "The era5 global reanalysis",
            "venue": "Quarterly Journal of the Royal Meteorological Society,",
            "year": 1999
        },
        {
            "authors": [
                "Dara Entekhabi",
                "Eni G Njoku",
                "Peggy E O\u2019Neill",
                "Kent H Kellogg",
                "Wade T Crow",
                "Wendy N Edelstein",
                "Jared K Entin",
                "Shawn D Goodman",
                "Thomas J Jackson",
                "Joel Johnson"
            ],
            "title": "The soil moisture active passive (smap) mission",
            "venue": "Proceedings of the IEEE,",
            "year": 2010
        },
        {
            "authors": [
                "Hannes Isaak Reuter",
                "Andy Nelson",
                "Andrew Jarvis"
            ],
            "title": "An evaluation of void-filling interpolation methods for srtm data",
            "venue": "International Journal of Geographical Information Science,",
            "year": 2007
        },
        {
            "authors": [
                "Xingjian Shi",
                "Zhourong Chen",
                "Hao Wang",
                "Dit-Yan Yeung",
                "Wai-Kin Wong",
                "Wang-chun Woo"
            ],
            "title": "Convolutional lstm network: A machine learning approach for precipitation nowcasting",
            "venue": "Advances in neural information processing systems,",
            "year": 2015
        },
        {
            "authors": [
                "Sepp Hochreiter",
                "J\u00fcrgen Schmidhuber"
            ],
            "title": "Long short-term memory",
            "venue": "Neural computation,",
            "year": 1997
        },
        {
            "authors": [
                "Viorica Patraucean",
                "Ankur Handa",
                "Roberto Cipolla"
            ],
            "title": "Spatio-temporal video autoencoder with differentiable memory",
            "venue": "arXiv preprint arXiv:1511.06309,",
            "year": 2015
        },
        {
            "authors": [
                "J Eamonn Nash",
                "Jonh V Sutcliffe"
            ],
            "title": "River flow forecasting through conceptual models part i\u2014a discussion of principles",
            "venue": "Journal of hydrology,",
            "year": 1970
        },
        {
            "authors": [
                "Hoshin V Gupta",
                "Harald Kling",
                "Koray K Yilmaz",
                "Guillermo F Martinez"
            ],
            "title": "Decomposition of the mean squared error and nse performance criteria: Implications for improving hydrological modelling",
            "venue": "Journal of hydrology,",
            "year": 2009
        },
        {
            "authors": [
                "Matthias Drusch",
                "Umberto Del Bello",
                "S\u00e9bastien Carlier",
                "Olivier Colin",
                "Veronica Fernandez",
                "Ferran Gascon",
                "Bianca Hoersch",
                "Claudia Isola",
                "Paolo Laberinti",
                "Philippe Martimort"
            ],
            "title": "Sentinel-2: Esa\u2019s optical high-resolution mission for gmes operational services",
            "venue": "Remote sensing of Environment,",
            "year": 2012
        },
        {
            "authors": [
                "Rolf H Reichle",
                "Qing Liu",
                "Randal D Koster",
                "Wade T Crow",
                "Gabrielle JM De Lannoy",
                "John S Kimball",
                "Joseph V Ardizzone",
                "David Bosch",
                "Andreas Colliander",
                "Michael Cosh"
            ],
            "title": "Version 4 of the smap level-4 soil moisture algorithm and data product",
            "venue": "Journal of Advances in Modeling Earth Systems,",
            "year": 2019
        },
        {
            "authors": [
                "Krishna Karra",
                "Caitlin Kontgis",
                "Zoe Statman-Weil",
                "Joseph C Mazzariello",
                "Mark Mathis",
                "Steven P Brumby"
            ],
            "title": "Global land use/land cover with sentinel 2 and deep learning",
            "venue": "IEEE International Geoscience and Remote Sensing Symposium IGARSS,",
            "year": 2021
        },
        {
            "authors": [
                "Uwe Muller-Wilm",
                "Jerome Louis",
                "Rudolf Richter",
                "Ferran Gascon",
                "Marc Niezette"
            ],
            "title": "Sentinel-2 level 2a prototype processor: Architecture, algorithms and first results",
            "venue": "In Proceedings of the ESA Living Planet Symposium,",
            "year": 2013
        },
        {
            "authors": [
                "Jin Chen",
                "Per J\u00f6nsson",
                "Masayuki Tamura",
                "Zhihui Gu",
                "Bunkei Matsushita",
                "Lars Eklundh"
            ],
            "title": "A simple method for reconstructing a high-quality ndvi time-series data set based on the savitzky\u2013golay filter",
            "venue": "Remote sensing of Environment,",
            "year": 2004
        }
    ],
    "sections": [
        {
            "heading": "1 Introduction",
            "text": "Climate change is leading to an increase in extreme weather events, affecting both ecosystem and human livelihoods. Africa is one of the most vulnerable continents to climate change with droughts in the region expected to increase in severity according to the IPCC [1]. Given current projections of population growth and impacts from climate change, many more people will be affected by extreme drought events in the future [2]. Any insight into predicting their occurrences can help prepare short-term solutions to alleviate potential impacts on local and regional communities [3].\nThe local scale response to extreme events is often not homogeneous [4]. Abiotic (e.g. soil type, topography, water bodies) and biotic (e.g. vegetation type, plant rooting depth) factors and the interactions between them affect how vegetation responds to atmospheric extreme events [5, 6].In\n1https://github.com/earthnet2021/earthnet-models-pytorch.git\nAccepted in Artificial Intelligence for Humanitarian Assistance and Disaster Response: workshop at NeurIPS 2022, and in Tackling Climate Change with Machine Learning: workshop at NeurIPS 2022.\nar X\niv :2\n21 0.\n13 64\n8v 2\n[ cs\n.L G\n] 3\n0 N\naddition, weather impacts with temporal lagged responses can have a significant influence on ecosystem responses to weather variability [7\u20139]. This so-called \u2019memory effect\u2019, arises from the complex processes involved in vegetation dynamics leading to non-linear interaction on several time scales [10, 11] (e.g. the time-lagged effect of precipitation on vegetation due to the water soil recharge [12], legacy effect of earlier drought [6, 13] or early starting season [14]).\nPredicting the evolution and impacts of vegetation at the very local level is therefore a challenge to support anticipatory action before a disaster In this paper, we aim to create a model capable of learning the relationship between vegetation states, local factors and weather conditions, at a very fine resolution in order to characterise and forecast the impact of weather extremes from an ecosystem perspective. We use the Normalized Difference Vegetation Index (NDVI) [15] as a proxy for vegetation health monitoring. Our work can be easily extended to predict other vegetation indices, depending on the ecological process of interest.\nContributions Our main contributions are summarized as follows:\n\u2022 A proof-of-concept of forecasting vegetation greenness in Africa at high spatial resolution. \u2022 A spatio-temporal analysis of the prediction, both of the dataset and of individual samples.\nApplication context Anticipatory action, such as Forecast-based Financing (FbF) [16], implement short-time action (e.g. commercial animal destocking or early procurement of food) during the period of time between a warning and a disaster to reduce both the impact of the disasters and the financial cost of humanitarian aid [17]. One of the main obstacles to anticipatory action is the uncertainty of a disaster actually taking place, what is its magnitude and where and when exactly respond [18] [19]. This context leads to protracted debates about response strategy and a reluctance to make decisions on the part of donors and policymakers during these precious time windows [16].\nSince drought vulnerability is very context specific and location specific [? ], a forecast vegetation evolution tool predicting at the very local scale from an ecosystem perspective can be impactful for the drought vulnerability assessments in term of location and magnitude to support anticipatory action. Additionally, our model is relevant for area not well covered by in situ meteorological and vegetation monitoring instruments (which is notably the case in Africa [20]) since we use only on satellite data.\nRelated work At low spatial resolutions, machine learning models have been proposed for both vegetation modeling [11, 21\u201327] and crop forecasting [28\u201330]. Requena-Mesa et al. [31] introduced Earth surface forecasting as modeling the future spectral reflectance of the Earth surface and provided the first dataset in this respect, EarthNet2021. Concurrent to our work, Diaconu et al. [32] and Kladny et al. [33] have built ConvLSTM variants for EarthNet2021. Both study the influence of weather on the predictions by providing artificial meteorological inputs."
        },
        {
            "heading": "2 Method",
            "text": "This paper follows the works of Requena-Mesa et al. [31], who introduced EarthNet2021, focusing instead on Africa and a specific deep learning model: the Convolutional LSTM (ConvLSTM).\nDataset Similar to EarthNet2021 [31], our dataset contains Sentinel 2 satellite imagery (bands red, blue, green and near-infrared), weather variables from ERA5 reanalysis (evaporation, surface pressure, surface net solar radiation, 2m temperature, total precipitation, potential evaporation) [34] and SMAP (latent and sensible heat flux, rootzone and surface soil moisture, surface pressure) [35] and topography from SRTMv4.1 DEM [36]. The data is collected at high spatial resolution for over 40000 locations in Africa, each resulting sample we call a minicube. For more information, see supplementary materials 5.1 and 5.2.\nTask We define an Earth surface forecasting task [31] as a strongly guided video prediction task. The objective is to forecast a length-k sequence of future NDVI satellite imagery (S\u0302n+1, ..., S\u0302n+k) based on previous length-n sequence of satellite imagery (S1, ..., Sn), topography T and guiding environmental variables during both the context and prediction periods (E1, ..., En, ..., En+k). Formally, the task is to learn a function f such that:\n(S\u0302n+1, ..., S\u0302n+k) = f(S1, .., Sn, E1, ..., En, ..., En+k, T )\nIn this paper, deep learning models use a context period of one year and then forecast the next three months of NDVI at a 10-daily timestepping.\nModel We use a ConvLSTM [37], that is an LSTM [38] using convolution to operate in the spatial domain. We stack two ConvLSTM units (each designed as in Patraucean et al. [39]) into an encoder and another two into a decoder (for forecasting). The encoder is used during the context period, it gets as inputs the concatenated satellite imagery, environmental variables and topography. The decoder uses only the environmental variables and the topography as inputs, but gets the hidden states from the encoder to propagate information from the context period. The model is visualized in supplementary material fig. 3. The training procedure is detailed in supplementary material 5.4.\nBaselines and ablation We compare our model against a constant baseline (last valid pixel from context period) and a previous season baseline (observations from previous year). Furthermore we ablate our model by removing the environmental variables (ConvLSTM w/o weather), i.e. doing an ablation without weather to see how much the model learns from just the first order process underlying vegetation dynamics: the seasonal cycle.\nEvaluation We evaluate the models using two mean squared error (MSE) derived scores: the root mean squared error (RMSE) and the Nash-Sutcliffe model efficiency (NSE) [40]. The latter rescales the MSE with the variance of the observations \u03c320 , it is defined as:\nNSE = 1\u2212MSE/\u03c320 , (1)\nBoth the MSE and the NSE can be decomposed into parts:\nMSE = phase_err + var_err + bias_sq (2)\nNSE = 2\u03b1r \u2212 \u03b12 \u2212 \u03b22, (3)\nHere we introduced the bias bias_sq = (\u00b50 \u2212 \u00b5\u0302)2, the variance error var_err = (\u03c30 \u2212 \u03c3\u0302)2, the phase error phase_err = (1\u2212 r) \u2217 2 \u2217 \u03c30 \u2217 \u03c3\u0302, the correlation r, the rescaled bias \u03b2 = (\u00b5\u0302\u2212 \u00b50)/\u03c30 and a measure of relative variability \u03b1 = \u03c3\u0302/\u03c30. \u00b5 represents means, \u03c32 represents variances, \u00b70 refers to observations and \u00b7\u0302 stands for predicted quantities. For the NSE decomposition, the components\u2019 ideal values are r = 1, \u03b1 = 1 and \u03b2 = 0 [41]."
        },
        {
            "heading": "3 Results",
            "text": "For our evaluation, we removed minicubes with more than 75% missing pixels. The evaluation is computed per pixel of the time series: we compute the metrics for each unmasked pixel of each\n0.0 0.2 0.4 0.6 0.8\n0.0\n0.5\n1.0\n0.0\n0.2\n0.4\n0\n1\n2\n3\n4\n0\n1\n2\n3\n0\n5\n10\n0.0\n0.5\n1.0\n(a) (b) (c) (d) (e) (f)\nminicube. Central estimates of our models\u2019 performance are reported in tab. 1. Our ConvLSTM model beats the baselines by a large margin in both RMSE and NSE. The previous season baseline has the same NDVI distribution over the whole dataset as the target (since it is the same season one year ago), so we have \u2211 \u03c3\u0302 ' \u2211 \u03c30 and \u2211 \u00b5\u0302 ' \u2211 \u00b50. Negative errors compensate for positive ones, which explains a median of \u03b1 and \u03b2 very close to their ideal value (but not for r). An ablation of it not using weather covariates performs worse than our model using them. This supports the intuition that weather should be driving vegetation dynamics. Supplementary figs. 5 and 6 visualize the performance against the baselines clustered by land cover type. Our model is stronger than the baselines across all classes.\nFig. 2 shows the decomposition for both NSE and RMSE on the test set. We find 50% of the pixels in our model reach NSE \u2265 0, while this is only 35% in the ablation without weather. This difference mostly stems from a reduction in bias (fig. 2c) and a reduction in relative variability (fig. 2b).\nWhile already good, our ConvLSTM does have limitations. Fig. 1 visualizes a prediction on one example minicube. One visible limitation is due the dataset. On 2019-12-09, the gapfilled RGB satellite image has noise due to undetected clouds. Clouds lower the target NDVI and lead to an apparent overestimation of the model on that day. Additionally, since such artifacts are common in the training dataset, the model learns a biased estimate, slightly underestimating NDVI to account for occasional clouds. Such underestimation is visible on 2019-12-19 in fig. 1. We present the pixelwise decomposition of the NSE for this pixel in the supplementary material, fig. 4."
        },
        {
            "heading": "4 Conclusion",
            "text": "This work presents a ConvLSTM deep learning model to predict vegetation greenness in Africa at high spatial resolution from coarse-scale weather. Our model obtains a higher Nash-Sutcliffe model efficiency than two baselines. In an ablation we train a model variant without weather covariates with lower performance. Hence, our final model is able to extract information from meteorology. We trained our model on a diverse dataset, thus it is applicable to a wide variety of landcover classes and climate zones. Decomposing the NSE into parts, we find a vulnerability of our model to data\nnoise: some clouds were not flagged during pre-processing, thereby biasing our model towards lower greenness values. Nevertheless, our model is a proof-of-concept of high resolution vegetation modeling in Africa. Future work should now focus on improving predictions by better understanding of spatial context, on the applicability of our model during extreme events and on building a bridge to the anticipatory action community.\nAuthors contribution C.R: Manuscript, experimental design, visualisation. C.R-M: Supervision, manuscript, dataset consititution. V.B: dataset constitution, pre-processing, pytorch framework, manuscript. L.A: Visualization, manuscript revision, model evaluation. N.C: Supervision, manuscript revision. M.R: Supervision, manuscript revision.\nAcknowledgments and Disclosure of Funding\nThis project has received funding from the European Union\u2019s Horizon 2020 research and innovation programme under grant agreement No 101004188."
        },
        {
            "heading": "5 Supplementary material",
            "text": ""
        },
        {
            "heading": "5.1 Dataset description",
            "text": "Following the EarthNet2021 challenge [31], we design a dataset for landsurface forecasting task on the African continent. The dataset contains over 40,000 samples, each sample is called a minicubes given that they are three dimensional arrays. The temporal resolution is 10 days, with 45 time-step. There is 36 time-step per year and each minicube contains 5 seasons. The data come from 2016 to 2021, with a start in four different dates: first of March, June, September or December. Minicubes\u2019s length is 15 months. The resolution of the spatial data is around 30 meters per pixels, so an image of with a size of 128\u00d7 128 pixels represent an area of 3.84\u00d7 3.84 km. Minicubes in the same location never overlap temporally, but the same location can be in the test and the train set (for different years). Auto-correlation between different nearby locations is a limitation of the data set. We chose to randomly split the years in the training and test sets due to interannual climate variability, e.g. El Ni\u00f1o. Splitting the years with only a few years can potentially add a potential out-of-domain problem for training, we preferred to simplify this problem in this proof of concept. Therefore, the years are considered independent. Half of the samples are dominated by croplands, the other half is dominated by other land cover classes present in Africa (e.g. forest, mangroves, savanna, meadows, scrub, shrubs or bare land)."
        },
        {
            "heading": "5.2 Data sources",
            "text": "Each minicube contains 45 time-step of high resolution Sentinel-2 satellite imagery in the red, blue, green, and near-infrared, so respectively the B02, B03, B04 and B08 reflectance bands [42]. We additionally compute the Normalized Difference Vegetation Index (NDVI) [15], a vegetation index (VI) for vegetation health monitoring based on the red and near-infrared bands. This is the target for the landsurface forecasting task. Each minicube contains the topography of the location based on a digital elevation model (DEM) of the Shuttle Radar Topography Mission (SRTMv4.1) [36]. The original spatial resolution is 90 meters, we use interpolation to get a 30 meters resolution for each of the 128 \u00d7 128 pixels. For the weather, we use the reanalysis dataset ERA5 [34]. We use observational weather to reduce both the uncertainty and the computation cost of a seasonal weather forecasting, the only information available when used for real forecasts. We use the following weather variables: surface pressure, surface net solar radiation, 2m temperature, potential evaporation, and total precipitation. We additionally use the SMAP satellite measurements of the land surface soil moisture [43], the soil moisture surface and soil moisture rootzone variables. Finally, each minicube also contains the ESRI2020 landcover map [44]. We use the landcover to detect the non-vegetation pixels (water, build area, bare ground, snow or cloud) and mask them during training and evaluation, we also use it for results analysis, but not during the training."
        },
        {
            "heading": "5.3 Pre-processing",
            "text": "The data has been processed using the Level-2A algorithm [45] to the cloud detection following by interpolation on the cloudy data. Then we apply a custom timeseries jump filter based on [46] but adapted for the sentinel-2 data to reduce the noise due to the undetected clouds. However, the pre-processing is imperfect, due to the difficulty of correctly detecting clouds and their shadows. This issue leads to artifacts in the data. The undetected clouds distort the subsequent calculation of NDVI, additionally, when the interpolation is made from undetected cloud images, the result propagates the clouds in the following time steps."
        },
        {
            "heading": "5.4 Training procedure",
            "text": "The loss function is the L2-norm. We apply during training and evaluation a mask to remove all the missing and non-vegetation pixels based on the landcover map. The target is the NDVI and the prediction is done timestep by timestep recurrently. When weather and environmental variables are\nin input of the ConvLSTM, their dimensions are upscaled to 128\u00d7 128, moreover, future weather is on input even during the prediction period since it is a strongly guided task. The topography is attached to each timestep. We train our models for 150 epochs with a batch size of 32 and a learning rate of 10\u22126. Models were implemented using the deep learning framework PyTorch Lightning [47] which is built on top of PyTorch [48]."
        },
        {
            "heading": "5.5 Limitation of the evaluation",
            "text": "The accuracy of the model for different seasons and for latitudes and longitudes depends strongly on the type of vegetation (agricultural or natural vegetation), without showing any particular pattern. There is a strong correlation between target variance and prediction accuracy (i.e., the sample with the most variance, e.g., during the growing season, is more difficult to predict than those without variance), see Fig. 5 and Fig. 6. In addition, samples with many clouds often have poor prediction. However, the limitation of the dataset prevents a finer prediction: many clouds have not been detected, and therefore it is difficult to attest the influence of clouds on the accuracy of the model. Moreover, we are working with a whole continent, containing several types of vegetation, climate and ecosystems, so the drivers are radically different [12], as as well as the time scales. Without any information on meteorological and vegetation anomalies, we cannot propose a more accurate evaluation at this point."
        }
    ],
    "title": "Learning to forecast vegetation greenness at fine resolution over Africa with ConvLSTMs",
    "year": 2022
}