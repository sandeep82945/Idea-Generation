{
    "abstractText": "In Monte Carlo calculations of expectation values in lattice quantum field theories, the stochastic variance of the sampling procedure that is used defines the precision of the calculation for a fixed number of samples. If the variance of an estimator of a particular quantity is formally infinite, or in practice very large compared to the square of the mean, then that quantity can not be reliably estimated using the given sampling procedure. There are multiple scenarios in which this occurs, including in Lattice Quantum Chromodynamics, and a particularly simple example is given by the Gross-Neveu model where Monte Carlo calculations involve the introduction of auxiliary bosonic variables through a HubbardStratonovich (HS) transformation. Here, it is shown that the variances of HS estimators for classes of operators involving fermion fields are divergent in this model and an even simpler zero-dimensional analogue. To correctly estimate these observables, two alternative sampling methods are proposed and numerically investigated.",
    "authors": [
        {
            "affiliations": [],
            "name": "Cagin Yunus"
        },
        {
            "affiliations": [],
            "name": "William Detmold"
        }
    ],
    "id": "SP:dd9994b9f622fb3e7f9465f2da3bc8d9a6e90d60",
    "references": [
        {
            "authors": [
                "H. Shi",
                "S. Zhang"
            ],
            "title": "Phys",
            "venue": "Rev. E 93, 033303 ",
            "year": 2016
        },
        {
            "authors": [
                "D.J. Gross",
                "A. Neveu"
            ],
            "title": "Phys",
            "venue": "Rev. D 10, 3235 ",
            "year": 1974
        },
        {
            "authors": [
                "J. Hubbard"
            ],
            "title": "Phys",
            "venue": "Rev. Lett. 3, 77 ",
            "year": 1959
        },
        {
            "authors": [
                "R.L. Stratonovich"
            ],
            "title": "Sov",
            "venue": "Phys. Dokl. 2, 416 ",
            "year": 1957
        },
        {
            "authors": [
                "K.G. Wilson"
            ],
            "title": "Phys",
            "venue": "Rev. D 10, 2445 ",
            "year": 1974
        },
        {
            "authors": [
                "J.E. Hirsch"
            ],
            "title": "Phys",
            "venue": "Rev. B 28, 4059 ",
            "year": 1983
        },
        {
            "authors": [
                "A. Bulgac",
                "J.E. Drut",
                "P. Magierski"
            ],
            "title": "Phys",
            "venue": "Rev. A 78, 023625 ",
            "year": 2008
        },
        {
            "authors": [
                "C. Wu",
                "S.-C. Zhang"
            ],
            "title": "Phys",
            "venue": "Rev. B 71, 155115 ",
            "year": 2005
        },
        {
            "authors": [
                "R. Durrett"
            ],
            "title": "Probability: Theory and Examples",
            "venue": "5th ed., Cambridge Series in Statistical and Probabilistic Mathematics ",
            "year": 2019
        }
    ],
    "sections": [
        {
            "text": "Infinite variance in Monte Carlo sampling of lattice field theories\nCagin Yunus1,* and William Detmold1,2,\u2020 1Center for Theoretical Physics, Massachusetts Institute of Technology,\nCambridge, Massachusetts 02139, USA 2The NSF Institute for Artificial Intelligence and Fundamental Interactions\n(Received 22 May 2022; accepted 28 October 2022; published 22 November 2022)\nIn Monte Carlo calculations of expectation values in lattice quantum field theories, the stochastic variance of the sampling procedure that is used defines the precision of the calculation for a fixed number of samples. If the variance of an estimator of a particular quantity is formally infinite, or in practice very large compared to the square of the mean, then that quantity can not be reliably estimated using the given sampling procedure. There are multiple scenarios in which this occurs, including in Lattice Quantum Chromodynamics, and a particularly simple example is given by the Gross-Neveu model where Monte Carlo calculations involve the introduction of auxiliary bosonic variables through a HubbardStratonovich (HS) transformation. Here, it is shown that the variances of HS estimators for classes of operators involving fermion fields are divergent in this model and an even simpler zero-dimensional analogue. To correctly estimate these observables, two alternative sampling methods are proposed and numerically investigated.\nDOI: 10.1103/PhysRevD.106.094506\nI. INTRODUCTION\nQuantum field theories (QFTs) at strong coupling are interesting in many contexts in particle, nuclear, and condensed matter physics, but in many cases can only be quantitatively investigated using numerical approaches. One such approach involves discretizing the theory on a spacetime lattice with a Euclidean metric. The functional integrals corresponding to measurable quantities can then be approximated using an importance sampling Monte Carlo method. In such a calculation, the probability of sampling a given configuration of the field degrees of freedom is determined by the Euclidean action and, depending on the parameters in the action, it is possible that field configurations enter with probability weights arbitrarily close to zero. If this is the case, certain random variables (observables corresponding to field operators) will have arbitrary large (infinite) variance. As will be discussed below, quantities with infinite variance in standard sampling algorithms occur in phenomenologically relevant theories such as Quantum Chromodynamics (QCD) due to zero-modes of the lattice Dirac operator as well as in other contexts. A particularly clear example is\nprovided by correlation functions constructed from large numbers of fermion fields as will be the focus of this work.1\nIn applying Monte Carlo methods to QFTs, the Central Limit Theorem (CLT) is used to construct confidence intervals for the expectation value (mean) of the random variable from the corresponding variance over the samples. However, a random variable with infinite variance does not satisfy the conditions for the CLTand the sample variance of such a random variable is not meaningful because it does not converge to a particular value with increasing sample size. Moreover, the CLT is valid only in the limit that the sample size approaches infinity and hence similar deficiencies will appear for random variables with finite but very large variances compared to squares of their means. Despite these issues, there are physically interesting quantities in QCD and other field theories that formally have finite mean but infinite variance under standard sampling methods. To address these cases, alternative sampling schemes are required for reliable Monte Carlo estimates. In this work, two methods will be introduced to address specific occurrences of infinite variance. The first method is applicable in the context of fermionic lattice field theories that are typically approached using the (continuous) Hubbard-Stratonovich (HS) transformation such as theories whose actions involve powers of fermion bilinear operators. A class of discrete HS transformations is introduced which generate discrete auxiliary bosonic variables. The variance *cyunus@mit.edu \u2020wdetmold@mit.edu\nPublished by the American Physical Society under the terms of the Creative Commons Attribution 4.0 International license. Further distribution of this work must maintain attribution to the author(s) and the published article\u2019s title, journal citation, and DOI. Funded by SCOAP3.\n1Observables with infinite variances in fermionic theories have been analyzed using a different approach in Ref. [1].\nPHYSICAL REVIEW D 106, 094506 (2022)\n2470-0010=2022=106(9)=094506(21) 094506-1 Published by the American Physical Society\nof an estimator constructed from these discrete bosonic variables will then be manifestly finite although it may be still very large compared to the square of its mean. This discrete sampling scheme is investigated in a toy model and in the 2D Gross-Neveu (GN) model. While the approach is seen to be useful in some contexts, it becomes impractical in the limit of large spacetime volumes in its current implementation. The second method that is considered is a sequential reweighting procedure that is suitable for analysis of non-negative stochastic variables. With this method, the mean of a such a non-negative bosonic variable with infinite variance can be written as a product of the means of the several non-negative random variables each having finite variance. This approach is also investigated in the toy model and in the 2D GNmodel but can be applied in more complicated theories. The structure of this work is as follows. In Sec. II, theway in which random variables with infinite variances arise in lattice calculations of field theories such as QCD is outlined as a motivation for subsequent studies of related phenomena in simple models. In Sec. III, the main statistical concepts that are used in our analysis are introduced and interpreted. In Sec. IV, simple models are introduced that cleanly exhibit the features that lead to observables with infinite variance. In Sec. V, a novel discrete Hubbard-Stratonovich transform is presented that provides estimators with manifestly finite variance. This method is tested for the toy models introduced in Sec. IV. In Sec. VI, a new reweighting method that can be applied to non-negative stochastic variables is also introduced and this method is then tested for the toy model introduced in Sec. IV. Finally, Sec. VII summarizes the results of this work and provides an outlook for future directions of investigation. A number of important statistical results that support our main analysis are proven in Appendix A while Appendices B and C present further technical details.\nII. INFINITE VARIANCE IN EUCLIDEAN FIELD THEORY\nOne can construct illustrative examples of infinite variance in phenomenologically relevant theories such as lattice QCD. In this case, the partition function is given by:\nZ \u00bc Z D\u00bdU D\u00bd\u03a8\u03a8\u0304 e\u2212S\u00bdU \u2212\u03a8\u0304D\u00bdU \u03a8\n\u00bc Z D\u00bdU e\u2212S\u00bdU det\u00f0D\u00bdU \u00de \u00bc Z D\u00bdU e\u2212S\u00bdU Y\n\u03bb\u2208\u03c3D\u00bdU\n\u03bb; \u00f01\u00de\nwhere U represents the gauge field and \u03a8 and \u03a8\u0304 represent the fermions. Here S\u00bdU is the bosonic part of the action of lattice QCD, D\u00bdU is the ND \u00d7 ND Dirac matrix, the determinant of which arises from integration of the fermion\ndegrees of freedom, and \u03c3D\u00bdU is the spectrum of D\u00bdU which accounts for multiplicities of the eigenvalues. It is assumed that the Dirac matrix D\u00bdU is diagonalizable for each U and can be expressed as\nD\u00bdU \u00bc QU\u039bUQ\u22121U ; \u00f02\u00de\nwhere \u039bU is a diagonal matrix consisting of eigenvalues \u03bba \u2208 \u03c3D\u00bdU ofD\u00bdU , andQU is not necessarily unitary. With this definition, the columns v\u00f0a\u00deU ofQU and the rows \u00f0w\u00f0a\u00deU \u00deT of Q\u22121U are the right and left eigenvectors of D\u00bdU , respectively, and satisfy\nX i\n\u00f0w\u00f0a\u00deU \u00dei\u00f0v\u00f0b\u00deU \u00dei \u00bc \u03b4ab;X a \u00f0v\u00f0a\u00deU \u00dei\u00f0w\u00f0a\u00deU \u00dej \u00bc \u03b4ij; \u00f03\u00de\nwhere a and b label the eigenvalues and i and j index the components of the corresponding eigenvectors. It must be noted that one can permute and (independently) scale the columns of QU freely. Furthermore, QU can not generically be chosen continuously in U and consequently the quantities \u03bbaU, v \u00f0a\u00de U , and w \u00f0a\u00de U depend implicitly on the choice of QU. In terms of these quantities, the components of the inverse of the Dirac operator for fieldU can be expressed as:\nD\u22121\u00bdU ij \u00bc XND a\u00bc1 1 \u03bbaU \u00f0v\u00f0a\u00deU \u00dei\u00f0w\u00f0a\u00deU \u00dej: \u00f04\u00de\nFor certain values of the couplings that define the theory, there may be an \u201cexceptional configuration\u201d, that is a bosonic field configuration U such that, for simplicity, strictly one of the eigenvalues, \u03bb \u2208 \u03c3D\u00bdU , vanishes. In what follows, the corresponding left and right eigenvectors of U will be denoted by \u00f0w \u00deT and v , respectively. If such exceptional configurations exist, it can be seen that the standard estimators of physical quantities, such as fermion propagators, diverge. To illustrate this, consider a fermion field bilinear denoted as\nV1ij \u00bc \u03a8\u0304i\u03a8j \u00f05\u00de\nand choose a particular combination of these bilinears weighted by the left and right eigenvectors at the exceptional configuration\nO \u00bc X i;j w i v jV 1 ij: \u00f06\u00de\nAfter the fermions are integrated out, for each sample size NS, a standard estimator for the expectation value of V1ij in a Monte Carlo calculation is\n094506-2\nV\u03021ij \u00bc 1\nNS XNS t\u00bc1 D\u22121\u00bdUt ij; \u00f07\u00de\nwhere Ut for t \u2208 f1;\u2026; NSg are assumed to be independently and identically generated samples. The corresponding estimator for O is\nO\u0302NS \u00bc 1\nNS X i;j w i v j XNs t\u00bc1 D\u22121\u00bdUt ij: \u00f08\u00de\nThe mean of O\u0302NS is given as:\nhO\u0302NSi \u00bc 1\nZ\nZ D\u00bdU e\u2212S\u00bdU det\u00f0D\u00bdU \u00de X i;j w i v jD \u22121\u00bdU ij: \u00f09\u00de\nAs one of the eigenvalues, \u03bb , for the field configuration U vanishes, the integration measure in Eq. (9) is such that U will have vanishing probability of being sampled and consequently the singularity due to D\u22121\u00bdU ij will not cause the expectation value to diverge. Nevertheless, configurations in a neighborhood2 of U\u22c6, which will be sampled with a very small frequency governed by detD\u00bdU , will make large individual contributions to the sample mean but the expectation value will remain finite as det\u00bdU D\u22121\u00bdU ij is polynomial in U. To examine var\u00f0O\u0302NS\u00de we consider NS \u00bc 1 for simplicity, noting that var\u00f0O\u0302NS\u00de \u00bc 1NS var\u00f0O\u0302NS\u00bc1\u00de. The variance 3 of O\u03021 is var\u00f0O\u03021\u00de \u00bc Z D\u00bdU e\u2212S\u00bdU detD\u00bdU jO\u03021\u00bdU \u2212 hO\u03021ij2: \u00f010\u00de\nSince O\u03021\u00bdU \u00bc \u00f0\u03bb \u00de\u22121 by construction and it was assumed that \u03bb \u00bc 0 is the only vanishing eigenvalue of D\u00bdU , the variance of O\u03021 is divergent as \u00f0\u03bb \u00de\u22122 det\u00bdU is divergent. It must be stressed that, in an actual Monte Carlo calculation, exceptional configurations will not be sampled so the sample variance will remain finite for any finite sample size, but will not be bounded from above as the sample size increases. The above example of a single fermion propagator illustrates the way in which infinite variance manifests but is not of physical relevance. However, correlation functions involving hadrons and nuclei in a theory such as QCD involve many propagators that arise from products of k fermion bilinears. In this context, it is useful to consider the more general product\nVkfig;fjg \u00bc Yk n\u00bc1 V1in;jn ; \u00f011\u00de\nwhere fig\u2261 fi1;\u2026; ikg and fjg \u00bc fj1;\u2026; jkg label the fermions that enter in an ordered manner. A family of estimators for Vkfig;fjg analogous to Eq. (7) for each NS is\nV\u0302kNS;fig;fjg \u00bc 1\nNS XNS t\u00bc1 X \u03c0\u2208Sk s\u03c0 Yk n\u00bc1 D\u22121\u00bdUt in;j\u03c0\u00f0n\u00de ; \u00f012\u00de\nunless fig and fjg contain repeated indices in which case V\u0302kfig;fjg \u00bc 0 due to the anticommutativity of fermions. Here, Sk is the symmetric permutation group of order k, and s\u03c0 is the sign of permutation \u03c0. Again choosing NS \u00bc 1, one observes:\nV\u0302k1;fig;fjg \u00bc X \u03c0\u2208Sk s\u03c0 Yk n\u00bc1 V\u030211;in;j\u03c0\u00f0n\u00de : \u00f013\u00de\nIf N0 > 1 eigenvalues of D\u00bdU\u22c6 vanish, then it suffices to focus on a product of N0 fermion bilinears:\nRN0 \u00bc YN0 s\u00bc1 XND i;j\u00bc1 \u00f0w\u22c6s \u00dei\u00f0v\u22c6s \u00dejV1i;j; \u00f014\u00de\nwhereND is the size of the Dirac matrix and \u00f0w\u22c6s \u00dei and \u00f0v\u22c6s \u00dej are the left and right eigenvectors of D\u00bdU\u22c6 , respectively, with vanishing eigenvalues \u03bb\u22c6s \u00bc 0, for s \u2208 f1;\u2026; N0g. For the estimator\nR\u0302N0 \u00bc X \u03c0\u2208SN0 s\u03c0 X\ni1\u2260\u2026\u2260iN0 j1\u2260\u2026\u2260jN0\nYN0 s\u00bc1 \u00f0w s\u00deis\u00f0v s\u00dejsD\u22121\u00bdU1 is;j\u03c0\u00f0s\u00de ; \u00f015\u00de\nwhere the first sum is over permutations \u03c0 in the symmetric group SN0 . Using the same arguments as for O\u03021, it can be shown that R\u0302N0 has infinite variance. The above arguments illustrate how infinite variances of estimators of physically relevant quantities can arise in Monte Carlo calculations of theories including lattice QCD. We note that, the situation is exacerbated in quenched QCD, where the fermion determinant is taken to be unity, or in partially quenched or mixed action QCD, where the Dirac operators entering the measure and the observables are different. In these cases, fermionic observables can have infinite expectation values. Since the fermion action is different in the measure and in defining observables, similar concerns will arise in partially quenched or mixed-action QCD. Without knowing that an observable in such a theory 2Precisely, for every \u03f5 > 0, one can find a neighborhood N of U such that supU\u2208N detD\u00bdU < \u03f5.3For fermionic systems, the square of an observable is not an observable in general. Therefore in this work, \u201cvariance\u201d always refers to the variance of an estimator.\n094506-3\nis free of the problem illustrated above,4 standard sampling methods result in estimates of observables whose statistical behaviors are not governed by the CLT at any sample size and are unreliable."
        },
        {
            "heading": "III. STATISTICAL SAMPLING",
            "text": "In this section, important results for stochastic variables that will be needed in the following analysis are introduced. A review of the relevant aspects of probability theory and proofs of the results presented here are provided in Appendix A."
        },
        {
            "heading": "A. A natural indicator of infinite variance",
            "text": "For a sequence of independent and identically distributed (i.i.d.) random variables fXng, a sequence of random variables fsng can be defined such that sn \u00bc 1\nn\u22121 P n i\u00bc1\u00f0Xi \u2212 X\u0304n\u00de2 where X\u0304n \u00bc 1n P n i\u00bc1 Xi. Each sn is an unbiased estimator of the variance of X\u0304n when it is finite. The n \u2192 \u221e behavior of sn provides empirical evidence as to whether the system has a finite variance or not. In particular:\n(i) Let fXng be a sequence of i.i.d. random variables with finite variance \u03c32. Then as n \u2192 \u221e, sn \u2192 a:s: \u03c32,\nwhere the notation \u201calmost surely\u201d (a.s.) is defined in Appendix A. (ii) Let fXng to be a sequence of i.i.d. random variables with finite mean \u03bc and infinite variance. Then, for any given \u03b4 > 0, the number of random variables sn that satisfies sn > \u03b4 is infinite a.s. The former statement follows from the Strong Law of Large Numbers, while the latter statement is proven in Appendix A as Theorem 1."
        },
        {
            "heading": "B. Empirical bias of the sample average for finite systems with exceptional configurations",
            "text": "In systems that contain exceptional configurations, the convergence of the sample mean to the mean is slow and it is not straightforward to estimate uncertainties as the sample variance does not converge. These issues resurface as empirical biases in systems with finite configuration spaces with configurations that are sufficiently infrequently sampled. To explore this, let \u03a9 be a finite sample space with j\u03a9j elements. To this space, we associate the \u03c3-algebra F \u00bc 2\u03a9 that is the set of subsets of \u03a9, and a family of probability distributions Pt\u2236 F \u2192 \u00bd0; 1 for t \u2208 \u00f00; 1 . Here, t corresponds to a parameter describing the system from which the samples are drawn such as a coupling constant or a mass. For a finite system, the knowledge ofPt\u00f0f\u03c9g\u00de for all \u03c9 \u2208 \u03a9 completely determines Pt\u2236 F \u2192 \u00bd0; 1 through the requirement Pt\u00f0A \u2208 F \u00de \u00bc P\u03c9\u2208A Pt\u00f0f\u03c9g\u00de. Therefore, it is\nenough to consider Pt\u00f0f\u03c9g\u00de and for brevity we define Pt\u00f0\u03c9\u00de\u2261 Pt\u00f0f\u03c9g\u00de. In the following, it is assumed that Pt is continuous in the sense that Pt\u00f0\u03c9\u00de is a continuous function of t for t \u2208 \u00f00; 1 for all \u03c9 \u2208 \u03a9 and that Xt is a non-negative random variable which is continuous in t in the same sense. Furthermore, the set of exceptional configurations is defined as E \u2282 \u03a9 such that limt\u21920 Pt\u00f0\u03c9\u00de \u00bc 0 and limt\u21920 Pt\u00f0\u03c9\u00de Xt\u00f0\u03c9\u00de \u2260 0 for all \u03c9 \u2208 E. An element\u03c9 \u2208 E is referred to as an exceptional configuration and it should be noted that this definition depends on the choice of X implicitly. The mean of Xt, \u03bcXt , can be written as a sum of contributions from the exceptional configurations and contributions from the nonexceptional configurations:\n\u03bcXt \u00bc X \u03c9\u2208\u03a9 Pt\u00f0\u03c9\u00deXt\u00f0\u03c9\u00de \u00bc \u03bceXt \u00fe \u03bceXt ; \u00f016\u00de\nwhere\n\u03bceXt \u00bc X \u03c9\u2208E Pt\u00f0\u03c9\u00deXt\u00f0\u03c9\u00de; \u03bceXt \u00bc X \u03c9\u2208Ec Pt\u00f0\u03c9\u00deXt\u00f0\u03c9\u00de; \u00f017\u00de\nand Ec \u00bc \u03a9nE. For a Monte Carlo estimate of the mean \u03bcXt with a fixed sample size NS, the contribution from the exceptional configurations will be missing for t sufficiently close to 0, resulting in a \u201cgap\u201d denoted by \u0394X \u2261 limt\u21920 \u03bceXt. That is, denoting the actual mean of the observable by \u03bcX \u2261 limt\u21920 \u03bcXt , the sample mean will underestimate this value by \u0394X for ensembles that are large but not sufficiently large that the CLT applies, as will be discussed below. Consider the product space \u03a9NS corresponding to the set of all ensembles of size NS, that is every element \u03c9\u00bdNS \u2208 \u03a9NS will correspond to a sequence of elements from \u03a9: \u03c9\u00bdNS \u00bc f\u03c9\u00bdNS 1 ;\u2026;\u03c9\u00bdNS NS g. A new random variable which should be interpreted as the ensemble average for each ensemble can be defined by X\u0304tNS\u00f0\u03c9\u00bdNS \u00de \u00bc 1 NS PNS i\u00bc1 X\nt\u00f0\u03c9\u00bdNS i \u00de. Now let pemin\u00f0t\u00de \u00bc min\u03c9\u2208E Pt\u00f0\u03c9\u00de and pemin\u00f0t\u00de \u00bc min\u03c9\u2208Ec Pt\u00f0\u03c9\u00de. As t \u2192 0, pemin\u00f0t\u00de \u2192 0 while pemin\u00f0t\u00de \u219b 0. Therefore, for small enough t one will have \u00bdpemin\u00f0t\u00de \u22121 \u226a \u00bdpemin\u00f0t\u00de \u22121. The Weak Law of Large Numbers (see Appendix A) implies that for NS \u226b \u00bdpemin\u00f0t\u00de \u22121, X\u0304NS \u2243 \u03bcX with very high probability. However, for \u00bdpemin\u00f0t\u00de \u22121 \u226a NS \u226a \u00bdpemin\u00f0t\u00de \u22121, X\u0304NS \u2243 \u03bcX \u2212 \u0394X with very high probability. For practical purposes, these results can be summarized by saying that for small t, with very high probability, X\u0304tNS first approaches to \u03bcX \u2212 \u0394X and then eventually converges to \u03bcX as NS is further increased. The above statements are made precise and proven as Theorem 2 in Appendix A. It should be noted that if E includes more than one element, 4For example, the massive overlap Dirac operator does not have zero eigenvalues.\n094506-4\nX\u0304NS may demonstrate a series of plateaus before eventually converging to \u03bcX. Figure 1 schematically demonstrates the expected behavior."
        },
        {
            "heading": "C. Nonasymptotic estimators",
            "text": "While the CLT is of utmost importance in statistical analysis, it is only valid asymptotically and for random variables with finite variance (see Appendix A). Therefore, the CLT is not applicable when dealing with random variables with infinite variance and the standard methods of estimation can not be utilized. Similar issues are also expected for a random variable with finite variance that has infinite variance in a certain limit, as such a variable is expected to be extremely non-Gaussian and require impractically large sample sizes for the CLT to apply. To address these situations, nonasymptotic estimators are important, and in this work the Median of Means (MoM) estimator will be used. The MoM is an estimator for which one is able to define confidence intervals which are also valid for random variables with infinite variance. After including the possibility of autocorrelations between samples, the MoM estimator can be defined as follows. Let f\u03bc\u03021;\u2026; \u03bc\u0302Kg be the means of the random variable X on each of K independent batches of B samples of X obtained from the same stationary (thermalized) discrete time process. Then the median of means estimator \u03bc\u0302MoM \u00bc median\u00f0f\u03bc\u03021;\u2026; \u03bc\u0302Kg\u00de. Confidence intervals can be defined using\nProb j\u03bcX \u2212 \u03bc\u0302MoMj > 2\u03c3X\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi 2\u03c4int;X\u00f0B\u00de\nB\nr \u2264 e\u2212K8 ; \u00f018\u00de\nwhere \u03bcX is the expectation value of X, \u03c3X be the standard deviation ofX, and \u03c4int;X\u00f0B\u00de is the integrated autocorrelation\ntime of the discrete time process.5 Further details and a proof of the above relation are provided in Appendix B."
        },
        {
            "heading": "IV. SIMPLE EXAMPLES WITH",
            "text": "INFINITE VARIANCE\nIn this section, two simple models are introduced and exemplar correlation functions are investigated to illustrate the problem of infinite variance in Monte Carlo sampling. Numerical explorations of these models are presented in Secs. V and VI below."
        },
        {
            "heading": "A. Toy model",
            "text": "The first model considered is a zero dimensional (Euclidean) theory of 2Nf interacting fermions represented by \u03a8 \u00bc \u00f0\u03a81;\u2026;\u03a82Nf\u00deT and \u03a8\u0304 \u00bc \u00f0\u03a8\u03041;\u2026; \u03a8\u03042Nf\u00de where \u03a8i and \u03a8\u0304i are independent Grassmannian variables. The Lagrangian of this toy model is defined as\nL \u00bc m\u03a8\u0304\u03a8 \u2212 g 2 \u00f0\u03a8\u0304\u03a8\u00de2; \u00f019\u00de\nwhere it is assumed that g is positive. As shown in Ref. [2], positivity of g is required for the unitarity of realistic theories with four fermion interaction. The partition function of this theory coupled to (Grassmannian) sources \u03b7\u0304 and \u03b7 is given by:\nZ\u00bd\u03b7; \u03b7\u0304 \u00bc Z Y2Nf\ni\u00bc1 \u00f0d\u03a8id\u03a8\u0304i\u00dee\u2212m\u03a8\u0304\u03a8\u00fe g 2 \u00f0\u03a8\u0304\u03a8\u00de2\u00fe\u03b7\u0304\u03a8\u00fe\u03a8\u0304\u03b7: \u00f020\u00de\nTo calculate quantities derived from this partition function, one needs to remove the quartic term so that the Grassmannian integrations can be performed exactly. The standard way to do this is to introduce an auxiliary field through a (continuous) Hubbard-Stratonovich transformation [3,4]. It is straightforward to see that up to a multiplicative constant, the partition function is equivalent to Z\u00bd\u03b7; \u03b7\u0304 \u00bc Z \u221e\n\u2212\u221e d\u03d5 Z Y2Nf i\u00bc1 \u00f0d\u03a8id\u03a8\u0304i\u00dee\u221212\u03d52\u2212\u00f0m\u00fe ffiffi g p \u03d5\u00de\u03a8\u0304\u03a8\u00fe\u03b7\u0304\u03a8\u00fe\u03a8\u0304\u03b7;\n\u00f021\u00de\nwhere \u03d5 is a real-valued scalar field. The fermions can now be integrated exactly, leading to\nZ\u00bd\u03b7; \u03b7\u0304 \u00bc Z \u221e\n\u2212\u221e d\u03d5e\u2212\n1 2 \u03d52\u00fe\u03b7\u0304 1m\u00fe ffigp \u03d5\u03b7\u00f0m\u00fe ffiffigp \u03d5\u00de2Nf : \u00f022\u00de\nHere, the Boltzmann weight\n5\u03c4int;X\u00f0B\u00de is defined in the Appendix B.\n094506-5\nP\u00f0\u03d5\u00de \u221d e\u221212\u03d52\u00f0m\u00fe ffiffigp \u03d5\u00de2Nf \u00f023\u00de is common to the partition functions and all correlation functions derived from it and therefore acts as the probability weight in importance-sampling Monte Carlo calculations. Now suppose that one is interested in calculating the expectation value of the observable\nO \u00bc Y2Nf i\u00bc1 \u03a8\u0304i\u03a8i \u00f024\u00de\nwhich is determined by\nhOi \u00bc 1 Z\u00bd0; 0 Y2Nf i\u00bc1 \u2202 \u2202\u03b7i \u2202 \u2202\u03b7\u0304i Z\u00bd\u03b7; \u03b7\u0304 \u03b7;\u03b7\u0304\u00bc0 : \u00f025\u00de\nUsing the auxiliary field, this is given by\nhOi \u00bc R d\u03d5P\u00f0\u03d5\u00de\u00f0m\u00fe ffiffigp \u03d5\u00de\u22122NfR\nd\u03d5P\u00f0\u03d5\u00de\n\u00bc R d\u03d5e\u2212 1 2 \u03d52R\nd\u03d5e\u2212 1 2 \u03d52\u00f0m\u00fe ffiffigp \u03d5\u00de2Nf ; \u00f026\u00de\nwhich is clearly finite. Difficulties arise if this quantity is naively estimated through a Monte Carlo calculation. The standard estimator for this expectation is\nO\u0302 \u00bc 1 NS XNS n\u00bc1 O\u0303\u00f0\u03d5n\u00de; \u00f027\u00de\nwhere NS is the sample size and O\u0303\u00f0\u03d5\u00de \u00bc \u00f0m\u00fe ffiffigp \u03d5\u00de\u22122Nf \u00f028\u00de is the representation of the observable in terms of the auxiliary field. This quantity has a singularity at \u03d5 \u00bc \u2212 mffiffigp . While one will never sample this point because P\u00f0\u03d5 \u00de \u00bc 0, with sufficiently many samples one will sample nearby points and they will cause large fluctuations in the estimation of the observable. In fact, the variance of this estimator is divergent, as the second moment (and all higher moments) of the bosonic operator O\u0303 diverges:\nhO2\u00f0\u03d5\u00dei \u00bc R d\u03d5P\u00f0\u03d5\u00de\u00f0m\u00fe ffiffigp \u03d5\u00de\u22124NfR\nd\u03d5P\u00f0\u03d5\u00de\n\u00bc R d\u03d5e\u2212 1 2 \u03d52\u00f0m\u00fe ffiffigp \u03d5\u00de\u22122NfR\nd\u03d5e\u2212 1 2 \u03d52\u00f0m\u00fe ffiffigp \u03d5\u00de2Nf\n\u00bc \u221e: \u00f029\u00de"
        },
        {
            "heading": "B. Gross-Neveu model",
            "text": "To further explore the ideas introduced above, it is useful to consider the Nf-flavor Gross-Neveu (GN) model [2] which resembles QCD in a number of ways. In particular, it is asymptotically free and exhibits chiral symmetry breaking.6\nHere, the Gross-Neveu model is defined in two dimensions on a discretized lattice geometry withWilson fermions [5]. Consider a rectangular lattice, described by the points f\u00f0s; t\u00dej1 \u2264 s \u2264 L; 1 \u2264 t \u2264 Tg where s, t, L and T are positive integers and lattice units are assumed throughout. Periodic (antiperiodic) boundary conditions are implemented in space (time). In this work, two-dimensional Dirac matrices are defined as\n\u03b30 \u00bc 1 0\n0 \u22121\n; \u03b31 \u00bc\n0 1\n1 0\n: \u00f030\u00de\nDenoting the masses by mi and the coupling constant by g, the partition function of the GN model is given by\nZ \u00bc Z Y\ns;t;i\nd\u03c8\u0304 id\u03c8 i\u00f0s; t\u00de\n\u00d7 exp \u2212 X s;t;i \u03c8\u0304 i\u00f0s; t\u00deKi\u00f0s; t; s0; t0\u00de\u03c8 i\u00f0s0; t0\u00de\n\u00fe g 2 X s;t X i \u03c8\u0304 i\u00f0s; t\u00de\u03c8 i\u00f0s; t\u00de 2 ; \u00f031\u00de\nwhere, 1 \u2264 i \u2264 Nf and\nKi\u00f0s; t; s0; t0\u00de \u00bc 12\u00d72 \u00f02\u00femi\u00de\u03b4s;s0\u03b4t;t0\n\u2212 1\n2 \u00f0\u03b4s;s0\u00fe1\u03b4t;t0 \u00fe \u03b4s;s0\u22121\u03b4t;t0\n\u00fe \u03b4s;s0\u03b4t;t0\u00fe1 \u00fe \u03b4s;s0\u03b4t;t0\u22121\u00de\n\u00fe 1 2 \u03b30\u00f0\u03b4s;s0\u03b4t;t0\u00fe1 \u2212 \u03b4s;s0\u03b4t;t0\u22121\u00de\n\u00fe 1 2 \u03b31\u00f0\u03b4s;s0\u00fe1\u03b4t;t0 \u2212 \u03b4s;s0\u22121\u03b4t;t0 \u00de: \u00f032\u00de\nIn the current work, Nf \u00bc 2 flavors of fermions are used everywhere with m1 \u00bc m2 \u00bc m. By utilizing a HubbardStratonovich transformation, the exponential in Eq. (31) can be made bilinear in the fermion fields as in Sec. IVA. Indeed, the toy model in Sec. IVA is an approximation to\n6The version of the model introduced here has a discrete chiral symmetry but it is simple to modify the action to obtain a theory with a continuous chiral symmetry [2].\n094506-6\nthe Gross-Neveu model in which the kinetic terms in the action are ignored.7\nThe set of exceptional configurations in the GN model is more complicated than in the toy model discussed in the previous subsection. In particular, the exceptional configurations will correspond to a union of surfaces of codimension 1 (and higher). For L \u00d7 T \u00bc 2 \u00d7 2, the set of the exceptional configurations can be found algebraically by solving the characteristic equation of the Dirac operator for a given set of parameters and is composed of two and three dimensional surfaces in the four-dimensional field-space. For larger lattice geometries, determination of these surfaces can in principle be performed numerically."
        },
        {
            "heading": "V. DISCRETE HUBBARD-STRATONOVICH TRANSFORMATION",
            "text": "The failure of sampling for some quantities with the standard HS transformation is tied to the continuous values taken by the auxiliary field, necessitating the existence of exceptional configurations in the models of the previous section. To avoid this, a family of discrete HS sampling schemes is introduced in this section and their utility in ameliorating the infinite variance problem is investigated numerically. As introduced above, the continuous HubbardStratonovich transformation is given by\ne 1 2 \u03c72 \u00bc 1ffiffiffiffiffi\n2\u03c0 p\nZ \u221e\n\u2212\u221e due\u2212 1 2 u2\u00feu\u03c7 : \u00f033\u00de\nThis expression is valid for all commuting variables \u03c7. However, if \u03c7 is constructed out of fermion bilinears as in the models in Sec. IV, Eq. (33) need only be satisfied up to terms O\u00f0\u03c72Nf\u00de (where Nf is the number of fermions for the theories that have spinor dimension 2) since higher powers of \u03c7 vanish identically. To find additional solutions, solutions of\ne 1 2 \u03c72 \u00bc X a\u2208A wae\u03bea\u03c7 \u00f034\u00de\nare required, where the index a takes values in a finite index setA that is to be determined. The weights, wa, are required to be non-negative to have a probabilistic representation and the \u03bea are required to be real to avoid a sign problem. \u03c7 is assumed to satisfy \u03c72Nf\u00fe1 \u00bc 0. After a change of variables \u03c7 \u2192 i\u03c7, solving the above equation is equivalent to solving\ne\u2212 1 2 \u03c72 \u00bc X a waei\u03bea\u03c7 \u00feO\u00f0\u03c72Nf\u00fe1\u00de; \u00f035\u00de\nwhere \u03c7 is considered as a real variable. That is, the above equation may be interpreted as the equality of the two real power series in \u03c7 up to the 2Nfth order in \u03c7. The series on the left and right sides of the above equation can be viewed as the characteristic functions8 of two probability densities in a conjugate variable \u03be, where these densities are\nP1\u00f0\u03be\u00de \u00bc 1ffiffiffiffiffi 2\u03c0 p e\u221212\u03be2 \u00f036\u00de\nand\nP2\u00f0\u03be\u00de \u00bc X a wa\u03b4\u00f0\u03be \u2212 \u03bea\u00de; \u00f037\u00de\nrespectively. Equation (34) can thus be rephrased as finding a polynomial f\u00f0\u03be\u00de of degree at most 2Nf that satisfies\n1ffiffiffiffiffi 2\u03c0\np Z \u221e\n\u2212\u221e d\u03bee\u2212 1 2 \u03be2f\u00f0\u03be\u00de \u00bc X a waf\u00f0\u03bea\u00de: \u00f038\u00de\nWritten in this form, the f\u03beag and fwag can be found through the method of Gaussian quadrature. Denoting the Hermite polynomials by\nHen\u00f0\u03be\u00de \u00bc \u00f0\u22121\u00dene12\u03be2 dn\nd\u03ben e\u2212 1 2 \u03be2 ; \u00f039\u00de\nthe Nf \u00fe 1 roots of HeNf\u00fe1\u00f0\u03be\u00de give the \u03bea and the wa are constructed as\nwa \u00bc Nf!\nHe0Nf\u00fe1\u00f0\u03bea\u00deHeNf\u00f0\u03bea\u00de ; \u00f040\u00de\nas shown in Appendix C. Having defined the sets f\u03beag and fwag, a Monte Carlo calculation can be performed for a Euclidean field theory as follows. Assume that the theory has a partition function: Z\u00bc Z D\u00bdU D\u00bd\u03a8\u03a8\u0304 e\u2212S\u00bdU \u00fe\u03a8\u0304\u03b1xD\u00bdU \u03b1x;\u03b2y\u03a8\u03b2y\u00fe12 P x \u00f0C\u03b1\u03b2\u03a8\u0304\u03b1x\u03a8\u03b2x\u00de2 ; \u00f041\u00de\nwhere f\u03b1; \u03b2g correspond to all fermion indices except the spacetime location x \u00bc \u00f0s; t\u00de and C\u03b1\u03b2 is a complex matrix. If C\u03b1\u03b2\u03a8\u0304\u03b1x\u03a8 \u03b2 x is a sum of k fermion bilinears, then \u00f0C\u03b1\u03b2\u03a8\u0304\u03b1x\u03a8\u03b2x\u00dek\u00fe1 will vanish. Then, the partition function can be expressed as: Z\u00bc Z\nD\u00bda D\u00bdU D\u00bd\u03a8\u03a8\u0304 Y x waxe \u2212S\u00bdU \u00fe\u03a8\u0304D\u00bdU \u03a8\u00fe P x \u03beaxC\u03b1\u03b2\u03a8\u0304 \u03b1 x\u03a8 \u03b2 x ;\n\u00f042\u00de 7In this approximation, Grassmannian variables at different\nsites are decoupled from each other and the GN model reduces to independent products of the toy model on each site.\n8The characteristic function of a random variable X is defined as \u03d5\u00f0\u03be\u00de \u00bc hei\u03beXi.\n094506-7\nwhere D\u00bda \u2261Qx Pax\u2208A and A indexes the set of roots of HeN>k. Note that N can be chosen to be any integer greater than k. After integrating over the fermion fields, one obtains:\nZ \u00bc Z D\u00bda D\u00bdU e\u2212S\u00bdU det\u00f0D0\u00bdU; a \u00de Y x wax; \u00f043\u00de\nwhere D0\u00bdU; a \u03b1;x;\u03b10;x0 is given as\nD0\u00bdU; a \u03b1;x;\u03b10;x0 \u00bc D\u00bdU \u03b1;x;\u03b10;x0 \u00fe C\u03b1\u03b10\u03beax\u03b4x;x0 : \u00f044\u00de\nConsequently, one can perform a Monte Carlo calculation using e\u2212S\u00bdU det\u00f0D0\u00bdU; a \u00deQx wax as the probability weight. The family of discrete HS transformations introduced here generalizes the transformation first proposed by Hirsch [6] and used extensively in the context of Quantum Monte Carlo simulations [7,8]. The form used in that work is equivalent to the Nf \u00bc 1 case of the transformation introduced above."
        },
        {
            "heading": "A. Discrete sampling vs. continuous sampling for the toy model",
            "text": "In this section, the toy model discussed in Sec. IV is used to compare estimators based on discrete HS transformations to each other and to the standard estimator based on the continuous HS transformation. The operator O \u00bcQ2Nf\ni\u00bc1 \u03a8\u0304i\u03a8i in Eq. (24) combines fermion bilinears for each type of fermion in the model and provides a concrete example on which to focus. Nf \u00bc 2 will be used in numerical studies. The behavior of the different estimators is determined by the model parameters m and g in Eq. (19). The behavior of the continuous estimator has been discussed above. For the discrete HS-based estimators, the choice of m, g and the order N of the Hermite polynomial HeN control the magnitude and probability of the least probable configuration. The roots and the corresponding weights for the first few Hermite polynomials are given in Table I. For the continuous HS estimator, Eq. (27), samples are generated through the Metropolis-Hastings algorithm with the standard normal distribution chosen as the proposal distribution. Discrete HS estimators are constructed for HeN where N \u2208 f3;\u2026; 9g with samples drawn through the Metropolis-Hastings algorithm with the weights given in Eq. (40) chosen as the proposal probabilities. For each sampling scheme, a total of NS \u00bc 108 samples are created for m \u2208 f1.03;1.43;1.53;1.63;1.73;1.83;1.83;2.03;2.43g and for g \u00bc 1.0. Autocorrelations are measured using the procedure of Ref. [9] and accounted for in the analysis. In what follows, the numerical data are analyzed inNp \u00bc 103 steps by adding 105 samples at each step. Precisely, at the step k, the samples that are included are the set f1;\u2026; k \u00b7 105g. For each step the data is analyzed\ndisregarding the samples not included and all metrics, including the autocorrelation times, are calculating independently for each step. In order to compare methods, the behaviors of the mean and the standard deviation of the continuous and discrete HS estimators are considered as a function of the sample size. Figure 2 shows this comparison for HeN for N \u2208 f3;\u2026; 9g at m \u00bc 1.73 and g \u00bc 1.0. These couplings are chosen such that the exceptional point \u03d5 \u00bc \u2212m= ffiffigp is very close to one of the configurations in the He3 estimator (\u03d5 \u00bc \u2212 ffiffiffi3p ). As can be seen from the behavior of the mean, most of the discrete HS estimators rapidly converge to the exactly calculable value that is used to normalize the Monte-Carlo results. However, the continuous HS estimator shows significant jumps as the number of samples increases that occur whenever a sample sufficiently close to \u03d5 \u00bc \u22121.73 is chosen, as expected from the general arguments in Sec. III. Note that the binning of results in steps of Np \u00bc 103 has a smoothing effect on the mean; unbinned results show more frequent and larger jumps. The He3 discrete sampling rapidly converges, but is biased even for 108 samples. The He8 estimator also samples configurations close to \u03d5 (but not as close as for He3) and correspondingly individual samples of these points significantly modify the mean, leading to the discontinuous jumps shown in the figure. The logarithm of the standard deviation shows the expected 1= ffiffiffiffiffiffi NS p behavior for most of the discrete HS estimators, however the continuous HS estimator, and to some extent the He8 estimator, exhibits nonasymptotic scaling arising from samples close to \u03d5 . As the number of samples increases, the continuous HS estimator will sample configurations arbitrarily close to \u03d5 and the nonasymptotic behavior will persist indefinitely: the mean is not guaranteed to converge to the true value for any finite sample set and the variance will not monotonically decrease. This behavior is anticipated by Theorem 1 in Appendix Awhich shows that the large jumps observed in the variance will never cease.\n094506-8\nThe behavior seen for the He3 and He8 estimators is in line with expectations given the configurations that are sampled and their respective probabilities. He8 has a root t \u2243 \u22121.63652 that is close to the exceptional configuration \u03d5 \u00bc \u22121.73, and consequently the He8 results show many jumps. This root of He8 is sampled with a probability p \u2243 3 \u00d7 10\u22127 and is thus sampled about 30 times for a sample size of NS \u00bc 108. Supporting this expectation, it is observed that the first jump emerges around NS \u223c 1p with the subsequent jumps are less marked. For He3 discrete sampling, the variance is apparently behaving asymptotically, falling as 1=NS, despite the empirical bias observed in the mean. For this sampling, the root ta \u00bc \u2212 ffiffiffi 3 p is sampled with probability p \u2243 10\u221213. Since this root has not been chosen in the NS \u00bc 108 samples used in Fig. 2, the mean is significantly underestimated. For Ns \u2273 1013, the sample mean will begin to converge to the true value and the variance will exhibit jumps (as seen for He8). For NS \u226b 1013, ta \u00bc \u2212 ffiffiffi 3 p will be sampled representatively\nand the mean will converge to the correct value and the variance will decrease asymptotically. While for this case the empirical bias would be observed with a very high probability if the same numerical experiments were repeated, it is not strictly a bias. With a very low probability the mean will be overestimated enormously making the estimator unbiased. As this particular example shows, in the case of random variables with very large variance, asymptotic scaling of the variance is no guarantee of correctness. If the model parameters m and g are chosen such that the exceptional configuration is one of the roots of a given discrete HS sampling, the corresponding configuration will never be sampled, just as in the case of continuous HS sampling. Under these circumstances, the variance will decrease as 1=NS but the mean will be biased. In Fig. 3, the mean and standard deviation of the same observable are studied for the He3 discrete HS sampling from g \u00bc 1.0 and for a range of values of m \u2208 \u00bd1.03; 2.43 .\n094506-9\nAs can be seen, for masses such that the exceptional value \u03d5 \u00bc \u2212m= ffiffigp is not close to one of the roots ta \u2208 f\u2212 ffiffiffi 3 p ; 0; ffiffiffi 3\np g, the calculations converge quickly to the correct value as the number of samples is increased and display the expected asymptotic 1=NS scaling of the variance. However as \u03d5 moves closer to the root at ta \u00bc \u2212 ffiffiffi 3 p from either above (m \u00bc 1.63) or below (m \u00bc 1.83), the convergence to the true value is much slower and large jumps are seen in the variance each time this root is sampled. For m \u00bc 1.73, the results apparently converge rapidly with 1=NS scaling, but to an incorrect result at this number of samples (as in the previous figure). In fact, using the CLT, a sample size satisfying the conditions for N\u00f0\u03b4; \u03f5\u00de in Eq. (A6) can be found. For the current problem, N\u00f0\u03b4; \u03f5\u00de is a lower bound, such that for all N \u2265 N\u00f0\u03b4; \u03f5\u00de there is a range of mass values ml\u00f0N\u00de \u2264 m \u2264 mu\u00f0N\u00de where ml\u00f0N\u00de < ffiffiffi 3 p < mu\u00f0N\u00de such that P\u00f0jO\u0302N \u2212 \u00f0\u03bc \u2212 \u0394\u00dej \u2264 \u03b4\u00de \u2265 1 \u2212 \u03f5. To obtain a concrete value, we choose \u03f5 \u00bc 3 \u00d7 10\u22127 corresponding to 5 standard deviations for the standard normal distribution. Then, N\u00f0\u03b4; \u03f5\u00de can be chosen as \u00f0 \u03c3X0\u03bc\u2212\u0394\u03a6\u22121\u00f01 \u2212 \u03f52\u00de\u00de2 1r2 \u2248 59.07r2 where r \u00bc \u03b4\u03bc\u2212\u0394 is ratio of the deviation \u03b4 to the biased mean \u03bc \u2212 \u0394 and \u03a6\u00f0x\u00de is the cumulative distribution function of the standard normal distribution. For r \u00bc 0.01, N\u00f0\u03b4; \u03f5\u00de \u00bc 6 \u00d7 105 satisfies the required conditions. To further investigate how the He3 discrete sampling behaves as the exceptional point of the theory moves towards one of the roots, the convergence of the sample average normalized to the true value is studied for g \u00bc 1.0 and m \u2208 f1.73; 1.76; 1.79; 1.82g. In this simple toy model, the expected deviation of the sample mean arises from the contribution of just one root that is the least probable and is straightforward to determine. Figure 4 presents the results and shows that as the exceptional point approaches a root, the number of samples needed to remove the empirical bias\nincreases, scaling approximately as the inverse probability of the least probable root."
        },
        {
            "heading": "B. Discrete sampling for the Gross-Neveu model",
            "text": "In this section, the effects of infinite variance are investigated in the context of the GN model. Calculations are undertaken for Nf \u00bc 2 flavors of fermions and for various values of the fermion mass, m, and coupling, g. For a lattice of size L \u00d7 T using the HeN discrete sampling there are NLT possible configurations. As concrete examples, lattices of extent L \u00bc T \u2208 f2;\u2026; 8g are investigated using the continuous and discrete He3 sampling schemes. For L \u00bc T \u00bc 2, Fig. 5 shows the sample size dependence of the logarithm of the standard deviation of the observable\nQ\u00f0s; t\u00de \u00bc YNf i\u00bc1 Y \u03c3\u00bc\u2191;\u2193 \u03a8\u0304\u03c3i \u00f0s; t\u00de\u03a8\u03c3i \u00f0s; t\u00de; \u00f045\u00de\nwhere the second product is over the fermion spin components. This quantity is evaluated at a single site, chosen to be \u00f0s; t\u00de \u00bc \u00f01; 1\u00de, and is constructed from all spin and flavor components of the fermion field at that site.9 While the slope converges to \u22120.5 for the discrete sampling scheme, the standard deviation of the continuous scheme exhibits large jumps over the entire NS \u00bc 108 samples. Figure 6 displays results for the same quantities calculated using a larger lattice of extent L \u00bc T \u00bc 8. It is clear that over the same range of sample sizes, even the discrete sampling scheme does not conclusively show the variance decreasing as 1=NS. The lack of convergence seen for the larger lattice can be understood by considering the spectrum of the logarithm of\np .\n9Due to the spin-flavor symmetry of the model, this quantity involves a single eigenvalue entering with multiplicity 2Nf. By translational symmetry, Q\u00f0s; t\u00de is identical for any site.\n094506-10\nQ\u00f01; 1\u00de. Figure 7 shows this spectrum on each configuration as a function of the logarithm of the probabilities of the configurations for L \u00d7 L lattices with L \u2208 f2; 3; 4g (since the number of configurations grows exponentially with L, results for L > 4 are not shown). As can be seen in each case, there are a significant number of rare but important configurations. As L increases, the number of these configurations increases rapidly. The operator Q\u00f01; 1\u00de is explicitly constructed such that for the continuous HS sampling scheme P\u00f0\u03d5 \u00de \u00bc 0 and Q\u0302\u00f0\u03d5 \u00de \u00bc \u221e for at least one exceptional configuration \u03d5 while R \u03d5 P\u00f0\u03d5\u00deQ\u0302\u00f0\u03d5\u00de < \u221e [here, Q\u0302 is the HS representation of Q\u00f01; 1\u00de after fermions are integrated out]. Since\nP\u00f0\u03d5\u00de \u221d e\u221212 P x \u03d52\u00f0x\u00de det\u00bdD\u00f0\u03d5\u00de ; \u00f046\u00de\nit follows that for j\u03d5j < \u221e, P\u00f0\u03d5 \u00de \u00bc 0 occurs only when the determinant vanishes. For a valid discrete sampling scheme, \u03d5 will not be in the domain of the discrete variable \u03be. However for \u03be close to \u03d5 ,\nP\u00f0\u03be\u00de \u221d w\u00f0\u03be\u00de det\u00bdD\u00f0\u03be\u00de \u00f047\u00de\nwill be small since w\u00f0\u03be\u00de > 0 and the determinant has the same functional dependence on either the continuous or discrete HS field. Similarly, Q\u0302\u00f0\u03be\u00de will be large for \u03be near \u03d5 as both the continuous and discrete HS transforms result in the same functional form for Q\u0302 after the fermion fields are integrated out. As a consequence of this behavior, configurations of smaller and smaller probabilities contribute larger and larger amounts toQ\u00f01; 1\u00de. From Fig. 7, it is clear that this issue is exacerbated for larger lattices, Since the set of exceptional configurations grows with volume, the number of nearby configurations in discrete HS sampling with small probability and large contribution to Q\u00f01; 1\u00de\ngrows rapidly. While the discrete sampling schemeQ\u00f01; 1\u00de has finite variance, in practice one needs to have a sample size on the order of the inverse of the smallest probability to obtain a reliable estimate of hQ\u00f01; 1\u00dei. The smallest probability for a lattice with volume V and number of\n094506-11\ndegrees of freedom per site c has an upper bound \u223cO\u00f0c\u2212V\u00de although the smallest probabilities will typically be much smaller. Consequently for observables that have formally infinite variance, one needs to have a sample size that is greater than O\u00f0cV\u00de to properly estimate the mean. As a comparison, Fig. 8 shows the logarithm of the absolute value of an observable with finite variance, namely\nO\u0304 \u00bc 1 L2 X s;t;i;\u03c3 \u03a8\u0304\u03c3i \u00f0s; t\u00de\u03a8\u03c3i \u00f0s; t\u00de \u00f048\u00de\nfor L \u00bc 4, Nf \u00bc 2, m \u00bc \u22121.5, ffiffigp \u00bc 2.0 using the He3 sampling scheme. In terms of the auxiliary variable, \u03be, after integrating out the fermions, this operator will take a form \u03be \u2192 O\u0304a:v:\u00f0\u03be\u00de, so that hO\u0304i \u00bc P \u03be P\u00f0\u03be\u00deO\u0304a:v:\u00f0\u03be\u00de. The notation a.v. indicates the \u201cabsolute value of the condensate\u201d which refers to the random variable \u03be \u2192 jO\u0304a:v:\u00f0\u03be\u00dej. Note that this definition depends on the particular auxiliary variable chosen. In contrast toQ\u00f01; 1\u00de, O\u0304 only involves one fermion bilinear in each term in the sum and is thus less singular around exceptional configurations; although for small probabilities log O\u0304 \u223c \u2212 log\u00f0prob\u00de, this growth is not as severe as in the case ofQ\u00f01; 1\u00de. This is made clear in Fig. 9 which compares the behavior of O\u0304 and Q\u00f01; 1\u00de directly. While the behavior of observables with infinite variance in regions of low probability is controlled by the exceptional configurations, the more general structure of the log-count plots above is specific to the particular observable."
        },
        {
            "heading": "C. Summary",
            "text": "The discrete sampling schemes that have been proposed have manifestly finite variance provided the roots in the\nscheme do not contain an exceptional configuration. In the case where the roots do contain an exceptional configuration, the variance is still finite; however, the sample mean will be biased due to the missing contribution of the exceptional configuration to the mean. These discrete sampling schemes are effective for calculating observables for small lattice volumes and provide interesting testing grounds for investigation of the fundamental issues of infinite variance. However for quantities with infinite, or very large, variance under a continuous HS sampling, the discrete sampling schemes do not practically overcome the issues of large variance for large volumes."
        },
        {
            "heading": "VI. REWEIGHTING",
            "text": "In this section, a method for sampling non-negative observables with infinite variance is proposed that constructs the target observable through a series of discrete reweighting steps or through a continuous reweighting procedure. In each case, samplings are performed using probability measures that incorporate part of the observable."
        },
        {
            "heading": "A. Discrete reweighting",
            "text": "Consider an un-normalized probability distribution P\u00f0x\u00de and an observable T \u00f0x\u00de that is non-negative everywhere. The expectation value\nhT i \u00bc P\nxP\u00f0x\u00deO\u00f0x\u00deP xP\u00f0x\u00de ; \u00f049\u00de\nwith the standard estimator for this quantity is given by\nT\u0302 \u00bc 1 Ns XNs i\u00bc1 T \u00f0xi\u00de; \u00f050\u00de\n094506-12\nwhere the xi are sampled with respect to the probability weight P\u00f0x\u00de. As in the previous sections, the variance of the standard estimator is not well defined if the second moment of T under the un-normalized probability weight P\u00f0x\u00de is infinite. To surmount this problem, a set of un-normalized probability weights Ps\u00f0x\u00de\nPs\u00f0x\u00de \u00bc P\u00f0x\u00deT \u00f0x\u00des; \u00f051\u00de\nare introduced with P0\u00f0x\u00de \u00bc P\u00f0x\u00de. Since T \u00f0x\u00de is nonnegative, this forms a probability distribution for real s. We denote the expectation value of an observable with respect to Ps\u00f0x\u00de by h\u00b7is. It is straightforward to see that:\nhT i \u00bc YN\u22121 r\u00bc0 hT \u00f0x\u00de1=Ni r N ; \u00f052\u00de\nwhere N is a positive integer. Based on the breakup in Eq. (52), an alternative estimator of hT i can be defined as follows. Consider a set of N configurations such that xr is sampled with respect to Pr N and denote the set by x\u2261 \u00f0x0;\u2026; xN\u22121\u00de. Let x\u00f0k\u00de \u2261 \u00f0x\u00f0k\u00de0 ;\u2026; x\u00f0k\u00deN\u22121\u00de for k \u2208 f1;\u2026; Nsg be i.i.d. sets of configurations. In terms of these sets, a valid estimator is given by\nT\u0303 \u00bdx\u00f01\u00de;\u2026;x\u00f0Ns\u00de \u00bc 1 Ns XNs k\u00bc1 YN\u22121 r\u00bc0 T 1 N\u00f0x\u00f0k\u00der \u00de; \u00f053\u00de\nwhere the total number of samples is NS \u00bc N \u00d7 Ns. It is easy to check that this estimator is unbiased. Except in pathological cases, the random variables T \u00f0xr\u00de1N , where xr are sampled with respect to Pr\nN \u00f0x\u00de, will have finite variance\nfor r \u2208 f0;\u2026; N \u2212 1g for large enough N (each quantity is less singular near an exceptional configuration than the original observable). If this is the case, then the estimator T\u0303 will also have finite variance. Figure 10 presents results forQ\u00f01; 1\u00de defined in Eq. (45) for the Gross-Neveu model on a L \u00bc 2 lattice using this discrete reweighting sampling scheme, Eq. (53). For comparison with Sec. V B, Fig. 10 also presents the corresponding results for the L \u00bc 8 lattice. Note that the exact result for the latter case is not shown as calculating it with the Hen discrete sampling scheme requires the generation of n64 configurations. Figure 11 presents the results for the standard deviation of the estimator Q\u00f01; 1\u00de. It must be noted that in Fig. 5, the median of the means method is applied to the estimator defined in Eq. (53) while in Fig. 11, Eq. (53) is used directly as appropriate for comparison with the results for the continuous and discrete HubbardStratonovich sampling schemes presented in Figs. 5 and 6."
        },
        {
            "heading": "B. Continuous reweighting",
            "text": "There is a natural extension of this sequential reweighting method to a continuous version of the procedure. To arrive at this version, note that\nhPi \u00bc hP1\u2212sishPsi0 \u00f054\u00de\nfor any s \u2208 \u00bd0; 1 and positive observable P as long as Zs \u2261 hPsi0 is finite. Zs is naturally interpreted as the partition function for the probability weight Ps\u00f0x\u00de \u00bc P\u00f0x\u00deP\u00f0x\u00des. Since the left-hand side of this equation is s-independent, one obtains\n0 \u00bc d ds \u00f0hP1\u2212sisZs\u00de: \u00f055\u00de\nThis differential equation is straightforward to solve, noting that Z\u22121s Z0s \u00bc hlogPis and hlog\u00f0P0\u00deis \u00bc 0. Therefore, under the assumption that Zs and hlogPis are both finite for s \u2208 \u00bd0; 1 , one finds that\nhPi \u00bc exp Z 1\n0\ndshlogPis : \u00f056\u00de\nUtilizing Gauss-Legendre quadrature and Eq. (56), an estimator for loghPi can be defined. Let N be a positive integer. Then an integral of the form R 1 0 dsf\u00f0s\u00de can be\napproximated by P\nN i\u00bc1 cif\u00f0si\u00de, where ci \u00bc 12wi and si \u00bc\n1\u00fezi 2\nare determined by the roots, zi, of the Nth Legendre polynomial and the corresponding weights, wi, associated with Gauss-Legendre quadrature.10 Defining the set of configurations x \u00bc \u00f0x1;\u2026; xN\u00de where xi is sampled with respect to Psi\u00f0x\u00de, let x\u00f0k\u00de for k \u2208 f1;\u2026; Nsg be i.i.d. sets of configurations. Then the following is an estimator for loghPi:\ngloghPi\u00bdx\u00f01\u00de;\u2026;x\u00f0Ns\u00de \u00bc 1 Ns XNs k\u00bc1 XN i\u00bc1 ci logP\u00f0x\u00f0k\u00dei \u00de; \u00f057\u00de\nwhere NS \u00bc N \u00d7 Ns is the total number of samples divided evenly between each of the N Gauss-Legendre quadrature points. As a very simple demonstration of this method, consider a one-dimensional example of the standard normal distribution P\u00f0x\u00de \u00bc 1ffiffiffiffi\n2\u03c0 p e\u2212x2=2 and observables Pp\u00f0x\u00de \u00bc epx2\nfor real p < 1 2 . The expectation values of these observables\nare given by hPpi \u00bc 1ffiffiffiffiffiffiffiffi1\u22122pp and the variances by 10If f\u00f0x\u00de is a polynomial of degree at most 2N \u2212 1, thenR\n1 \u22121 f\u00f0x\u00dedx \u00bc P i\u00bcN wif\u00f0xi\u00de where fxig are the roots of the Nth\nLegendre polynomial PN\u00f0x\u00de and wi \u00bc 2\u00f01\u2212xi\u00de2\u00f0P0N \u00f0xi\u00de\u00de2.\n094506-13\n094506-14\nvar\u00f0Pp\u00de \u00bc 1\u22122p\u2212 ffiffiffiffiffiffiffiffi 1\u22124p p \u00f01\u22122p\u00de ffiffiffiffiffiffiffiffi1\u22124pp . The variance diverges for p \u2265 14 and the expectation value diverges for p \u2265 1 2 .\nTo calculate loghPpi using Eq. (57) and Gauss-Legendre quadrature, a proposal distribution for each si is required. A simple and straightforward choice is to use P0\u00f0x\u00de \u00bc 1ffiffiffiffi 2\u03c0\np e\u221212x2 for all si. The data labeled as \u201cbasic\u201d in Fig. 12 is generated in this context. For 1=p\u2273 3 this provides an accurate estimate that agrees with the exact value within uncertainties. However for a fixed sample size per GaussLegendre node, the estimates deviate from the exact value as p approaches 1\n2 . A possible cause of this is that for\np \u00bc 1 2 \u2212 \u03f5, the probability weight is proportional to e\u2212\u03f5x2 for s \u00bc 1 and important contributions will be due to jxj \u2272 1ffiffi\n\u03f5 p . Therefore, more and more samples will be needed\nas \u03f5 \u2192 0 and the \u201cbasic\u201d method suffers from an overlap problem. To improve the algorithm in this simple example, one can also directly sample for Psi which are normal distributions. Results generated in this latter context are labeled as \u201cimproved\u201d in Fig. 12, and are seen to agree perfectly with the exact results for all p. Systematic errors due to the finite number of nodes are negligible compared to the statistical errors in both cases. To test this method on a more realistic system, estimates\nof glogQ\u00f01; 1\u00de for the Gross-Neveu model on the L \u00bc 2 and L \u00bc 8 lattices with m \u00bc \u22121.5, ffiffigp \u00bc 2.0 and Nf \u00bc 2 are presented in Fig. 13. For L \u00bc 2, the exact value is reproduced within uncertainties while for L \u00bc 8, results\nfrom continuous reweighting agree with those from discrete reweighting."
        },
        {
            "heading": "VII. CONCLUSIONS",
            "text": "Large statistical variance in Monte Carlo sampling severely limits the precision with which many important quantities in quantum field theories can be determined. In this work, quantities that have formally infinite variance under standard sampling schemes have been considered. In the context of fermionic theories, a family of discrete sampling schemes has been presented that surmounts the issue of infinite variance. Nevertheless, the variances in these schemes can be very large (compared to their means squared) and hence sampling maybe inefficient. An alternate sampling scheme has also been developed which can be applied to any non-negative random variable that can be sampled with the Monte Carlo method. While the method has been proposed in order to estimate observables with infinite variances, it is likely to be effective for non-negative random variables that have finite but large noise to signal ratios. There are potentially interesting connections of the investigations presented here to the large time-separation behavior of two-point correlation functions for quantities that possess global charges, such as for baryons and nuclei in QCD, that will be explored in subsequent work."
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "We are grateful for insightful discussions with P. Shanahan. This work is supported by the National Science Foundation under Cooperative Agreement PHY2019786 (The NSFAI Institute for Artificial Intelligence and Fundamental Interactions, http://iaifi.org/). W. D. is supported in part by the U.S. Department of Energy, Office of Science, Office of Nuclear Physics under grant Contract Number DE-SC0011090. W. D. is also supported by the SciDAC4 Grant No. DE-SC0018121. This research was supported in part by the National Science Foundation under Grant No. NSF PHY-1748958."
        },
        {
            "heading": "APPENDIX A: REVIEW OF THE BASIC PROBABILITY THEORY",
            "text": "The standard method of estimating an observable (a random variable) is based on the Central Limit Theorem. We therefore begin by reviewing the background for the Central Limit Theorem. We refer to Ref. [10] for further details. A probability space is a triplet (\u03a9, F , P) where: (i) \u03a9 is the sample space. (ii) F is the space of events and is required to be a\n\u03c3-algebra. (iii) P\u2236 F \u2192 \u00bd0; 1 is the probability measure.\nEvery element \u03c9 in the sample space \u03a9 is called an outcome. An event A \u2208 F is said to occur if \u03c9 is the\n094506-15\noutcome and \u03c9 \u2208 A. F is required to be a \u03c3-algebra which means that\n(i) \u2205;\u03a9 \u2208 F . (ii) A \u2208 F implies Ac \u2208 F where Ac is the complement\nof A. (iii) If Ai\u22651 \u2208 F is a countable sequence of elements of\nF it follows that \u222ai\u22651 Ai \u2208 F . The probability measure P is required to satisfy:\n(i) P\u00f0\u2205\u00de \u00bc 0. (ii) P\u00f0\u03a9\u00de \u00bc 1. (iii) If Ai\u22651 \u2208 F is a countable sequence of pairwise\ndisjoint elements of F it follows that P\u00f0\u222ai\u22651 Ai\u00de \u00bcP i\u22651 P\u00f0Ai\u00de. It must be noted that in general one can not choose F \u00bc 2\u03a9, the set of all subsets of \u03a9. Therefore, the choice of F is essential and elements of F are said to be measurable. A random variable X\u2236 \u03a9 \u2192 R is a real valued function on the sample space such that for all a \u2208 R, X\u22121\u00f0ABR\u00de \u2208 F\nwhere BR is the Borel \u03c3-algebra on R, the smallest 11 \u03c3-algebra containing all open subsets of R. An equivalent condition is X\u22121\u00f0\u00f0\u2212\u221e; a \u00de \u2208 F for all a \u2208 R. This condition allows one to define another probability distribution PX on the real line through the formula PX\u00f0\u00f0a; b \u00de \u00bc P\u00f0X\u22121\u00f0\u00f0\u2212\u221e; b \u00de\u00de \u2212 P\u00f0X\u22121\u00f0\u00f0\u2212\u221e; a \u00de\u00de. By the celebrated Carathe\u0301odory\u2019s extension theorem PX can be extended to the BR. If A \u2208 BR, PX\u00f0A\u00de should be interpreted as the probability that X takes value in A. We further define the cumulative distribution function FX\u00f0t\u00de \u00bc PX\u00f0\u00f0\u2212\u221e; t \u00de which gives the probability that X \u2264 t. For a stochastic physical system represented by the probability space \u00f0\u03a9;F ; P\u00de, one can consider the space of repeated outcomes denoted by\u03a9\u221e \u00bc Q\u221ei\u00bc1\u03a9, associated with the \u03c3-algebra F\u221e, the smallest \u03c3-algebra containing\n11Smallest \u03c3-algebra containing a given set of sets is defined as the intersection of all \u03c3-algebras that contains the given set of sets which can be shown to be a \u03c3-algebra.\n094506-16\nQ\u221e i\u00bc1 Ai where only finitely many of Ai \u2208 F are different than \u03a9. An element \u03c9\u221e \u2208 \u03a9\u221e is given by \u03c9\u221e \u00bc f\u03c91;\u03c92; g where \u03c9i \u2208 \u03a9 for all i \u2208 N\u00fe. Then, \u03a9\u221e can be identified with the set of of all samples of the physical system with infinite sample size. By Kolmogorov\u2019s Extension Theorem, there exists a unique probability measure P\u221e on F\u221e such that P\u221e\u00f0Q\u221ei\u00bc1 Ai\u00de \u00bcQ\ni P\u00f0Ai\u00de if only finitely many of Ai \u2208 F are different that \u03a9. Given a random variable X on \u00f0\u03a9;F ; P\u00de, we define the random variable Xn on \u00f0\u03a9\u221e;F\u221e; P\u221e\u00de by Xn\u00f0\u03c9\u221e\u00de \u00bc X\u00f0\u03c9n\u00de. For our purposes, there are three important types of convergence for random variables. One says that a sequence of random variables Xn converges to a random variable X\n(i) almost surely/everywhere12 if P\u00f0Xn \u2192 X\u00de \u00bc 1. It is denoted by Xn\u2192 a:s: X.\n(ii) in probability if for every \u03f5 > 0, P\u00f0jXn\u2212Xj> \u03f5\u00de\u21920. It is denoted by Xn\u2192 p X.\n(iii) in distribution if FXn converges pointwise to FX at every continuity point of FX. It is denoted by\nXn \u2192 d X.\nThese three different types of convergence imply each other in the sense that\n\u2192 a:s: \u21d2 \u2192 p \u21d2 \u2192 d : \u00f0A1\u00de\nThree of the most important results of the probability theory are the Strong Law of the Large Numbers (SLLN), The Weak Law of Large Numbers (WLLN), and the Central Limit Theorem (CLT). Strong Law of Large Numbers Let fXng be a sequence of identically and independently distributed random variables with the finite mean E\u00bdXn \u00bc \u03bc. If one defines the sample mean X\u0304n\u22651 \u00bc 1n P n i\u00bc1 Xi, it follows that:\nX\u0304n !a:s: \u03bc: \u00f0A2\u00de An important consequence of the SLLN is the Weak Law of Large Numbers. Weak Law of Large Numbers Let fXng be a sequence of identically and independently distributed random variables with the finite mean E\u00bdXn \u00bc \u03bc. If one defines the sample mean X\u0304n \u00bc 1n P n i\u00bc1 Xi forn \u2265 1, it follows that for any \u03f5 > 0:\nlim N\u2192\u221e\nP\u00f0jX\u0304N \u2212 \u03bcj \u2264 \u03f5\u00de \u00bc 1: \u00f0A3\u00de\nAlthough the SLLN says any sequence of sample means will eventually converge to the mean, in practice it does not say anything about how close a sample mean is to the mean for a given sample size N. A similar statement also applies\nto the WLLN. On the other hand, the CLT gives a measure of how close the sample mean is to the mean. Central Limit Theorem Let fXng be a sequence of identically and independently distributed random variables with the finite mean E\u00bdX1 \u00bc \u03bc and finite variance E\u00bdX21 \u2212 E\u00bdX1 2 \u00bc \u03c32. It then follows that ffiffiffi n\np \u00f0X\u0304n \u2212 \u03bc\u00de\u2192d N \u00f00; \u03c32\u00de where N \u00f0\u03bc; \u03c32\u00de denotes the normal distribution with mean \u03bc and variance \u03c32. It follows that for large enough n, ffiffiffi n\np \u00f0X\u0304n\u2212\u03bc\u00de\u2248N \u00f00;\u03c32\u00de. Therefore, it follows that X\u0304n \u2248N \u00f0\u03bc; \u03c32n \u00de. Although one can derive a similar expression for the estimation of \u03c32 in the case E\u00bdX41 < \u221e, it is usually enough to estimate \u03c32 by the (unbiased) estimator sn \u00bc 1n\u22121 P n i\u00bc1\u00f0Xi \u2212 X\u0304n\u00de2.\nLet fXng to be an i.i.d. sequence of random variables with finite variance \u03c32. Application of the SLLN to fXng and fX2ng immediately implies that sn\u2192a:s:\u03c32."
        },
        {
            "heading": "1. Theorems under infinite variance",
            "text": "Two theorems are particularly important for analysis of random variables with infinite variance. Theorem 1. Let Xn\u22651 to be a sequence of independent and identically distributed random variables with finite mean \u03bc and infinite variance. Then, for any given L > 0, the number of the random variables sn that satisfies sn > L is infinite almost surely. We need a bit preparation beforewe can prove Theorem 1. Lemma 1. (Second Borel-Cantelli) Let fEng to a\nsequence of independent events. If P\nn P\u00f0En\u00de \u00bc \u221e then13 P\u00f0lim supEn\u00de \u00bc 1. Lemma 2. Let Z be a non-negative random variable\nwith infinite mean. Then, for any given L > 0, P\u221e n\u00bc1 P\u00f0fZ \u2265 nLg\u00de \u00bc \u221e. Proof.\n\u221e \u00bc E\u00bdZ\n\u00bc X\u221e n\u00bc0 Z nL\u2264Z<\u00f0n\u00fe1\u00deL ZdP \u2264 L X\u221e n\u00bc0 \u00f0n\u00fe 1\u00deP\u00f0fnL \u2264 Z < \u00f0n\u00fe 1\u00deLg\u00de \u2264 L X\u221e n\u00bc0 nP\u00f0fnL \u2264 Z < \u00f0n\u00fe 1\u00deLg\u00de\n\u00fe L X\u221e n\u00bc0 P\u00f0fnL \u2264 Z < \u00f0n\u00fe 1\u00deLg\u00de\n\u00bc X\u221e n\u00bc1 nP\u00f0fnL \u2264 Z < \u00f0n\u00fe 1\u00deLg\u00de \u00fe L: \u00f0A4\u00de\n12To be precise, there is a set A \u2208 F such that for all \u03c9 \u2208 A, limn\u2192\u221e Xn\u00f0\u03c9\u00de \u00bc X\u00f0\u03c9\u00de and P\u00f0A\u00de \u00bc 1. It is possible that the set of all elements \u03c9 \u2208 \u03a9 satisfying Xn\u00f0\u03c9\u00de \u2192 X\u00f0\u03c9\u00de is not measurable, but this distinction is not relevant for our discussion.\n13Here, lim supEn\u2261 \u2229n\u22651\u222am\u2265n Em and is equal to the set of all outcomes \u03c9 such that \u03c9 \u2208 Ek for infinitely many Ek. Therefore, P\u00f0lim supEn\u00de can be interpreted as the probability that infinitely many events Ek happens.\n094506-17\nIt follows that P\u221e\nn\u00bc1 nP\u00f0fnL \u2264 Z < \u00f0n\u00fe 1\u00deLg\u00de \u00bc \u221e. Then:\n\u221e \u00bc X\u221e n\u00bc1 nP\u00f0fnL \u2264 Z < \u00f0n\u00fe 1\u00deLg\u00de\n\u00bc X\u221e n\u00bc1 Xn m\u00bc1 P\u00f0fnL \u2264 Z < \u00f0n\u00fe 1\u00deLg\u00de \u00bc X\u221e m\u00bc1 X\u221e n\u00bcm P\u00f0fnL \u2264 Z < \u00f0n\u00fe 1\u00deLg\u00de \u00bc X\u221e m\u00bc1 P\u00f0fZ \u2265 mLg\u00de: \u00f0A5\u00de\n\u25aa Corollary 1. Let fZng to be a sequence of independent and identically distributed non-negative random variables with infinite mean. Then, for any given L > 0, the number of the random variables Zn that satisfies Zn \u2265 nL is infinite almost surely. Proof. We define the events En \u00bc f\u03c9\u2236Zn\u00f0\u03c9\u00de \u2265 nLg. The corollary then follows from Lemma 2 and the second Borel-Cantelli lemma. \u25aa Proof of Theorem 1. We first define the random\nvariable s0n \u00bc 1n\u22121 P\ni\u00bc1\u00f0Xi \u2212 \u03bc\u00de2 for n \u2265 2. Next, we are going to show that, almost surely, infinitely many elements of the sequence fs0ng satisfy s0n \u2265 L. Let Tn \u00bc \u00f0Xn \u2212 \u03bc\u00de2. Then, Corollary 1 applies and there are infinitely many Tn that satisfy Tn \u2265 nL. Let nk \u2265 2 for k \u2265 1 be an increasing sequence that satisfies Tnk \u2265 nkL. Then for each k \u2265 1, we have s0nk \u2265 1 nk\u22121\nTnk > L. Let \u03a9s0;L be the set of outcomes such that fs0n > Lg is satisfied for infinitely many n. We showed that P\u00f0\u03a9s0;L\u00de \u00bc 1. We now show that a similar statement holds for\nsn \u00bc 1n\u22121 P n i\u00bc1\u00f0Xi \u2212 X\u0304n\u00de2. By the SLLN, there is a set of outcomes \u03a9X\u0304\u2192\u03bc such that limn\u2192\u221e X\u0304n\u00f0\u03c9\u00de \u00bc \u03bc for all \u03c9 \u2208 \u03a9X\u0304n\u2192\u03bc and P\u00f0\u03a9X\u0304n\u2192\u03bc\u00de \u00bc 1. Let \u03a9s \u00bc \u03a9s0;3L \u2229 \u03a9X\u0304\u2192\u03bc. Choose an arbitrary \u03c9 \u2208 \u03a9s. Since \u03a9s \u2286 \u03a9s0;3L, there is an infinite sequence fnk \u2265 2g such that s0nk\u00f0\u03c9\u00de \u2265 3L. As X\u0304n converges to \u03bc in\u03a9s \u2286 \u03a9X\u0304n\u2192\u03bc, the sequence fnkg has an infinite subsequence fmk \u2265 2g that also satisfies jX\u0304mk\u00f0\u03c9\u00de \u2212 \u03bcj < L. As sn\u00f0\u03c9\u00de \u00bc s0n\u00f0\u03c9\u00de \u2212 nn\u22121 \u00f0Xn\u00f0\u03c9\u00de \u2212 \u03bc\u00de2, it follows that s0mk \u2265 2n\u22123 n\u22121 L. Since for n \u2265 2 2n \u2212 3 \u2265 n \u2212 1 is satisfied, s0mk \u2265 L is valid for all mk. The theorem is proved if we can show P\u00f0\u03a9s0 \u00de \u00bc 1. To see this note that P\u00f0\u03a9s\u00de \u00bc 1 \u21d4 P\u00f0\u03a9n\u03a9s\u00de \u00bc 0. The latter follows from the following relation. P\u00f0\u03a9n\u03a9s\u00de \u00bc P\u00f0\u03a9 \u2229 \u00f0\u03a9cs0;3L \u222a\u03a9cX\u0304n\u2192\u03bc\u00de\u00de \u2264 P\u00f0\u03a9 \u2229 \u03a9cX\u0304n\u2192\u03bc\u00de \u00feP\u00f0\u03a9 \u2229 \u03a9 c s0 \u00de \u00bc 0. \u25aa\nLet \u03a9 be a finite sample space associated with the \u03c3-algebra F \u00bc 2\u03a9, the set of all subsets of \u03a9, and a family of probability distributions Pt\u2236 F \u2192 \u00bd0; 1 for t \u2208 \u00f00; 1 . We assume that Pt is continuous in the sense that Pt\u00f0\u03c9\u00de is a\ncontinuous function of t for t \u2208 \u00f00; 1 for all \u03c9 \u2208 \u03a9. We consider a non-negative random variable Xt which is continuous in t in the same sense. We further assume that there is a set E \u2282 \u03a9 such that limt\u21920 Pt\u00f0\u03c9\u00de \u00bc 0 and limt\u21920 Pt\u00f0\u03c9\u00deXt\u00f0\u03c9\u00de \u2260 0 for all \u03c9 \u2208 E. Theorem 2. Let \u03b4, \u03f5 > 0. There is an integer N\u00f0\u03b4; \u03f5\u00de such that for all N \u2265 N\u00f0\u03b4; \u03f5\u00de:\nlim t\u21920\nPt\u00f0jX\u0304tN \u2212 \u00f0\u03bc \u2212 \u0394\u00dej \u2264 \u03b4\u00de \u2265 1 \u2212 \u03f5: \u00f0A6\u00de\nProof of Theorem 2. We first define another probability measure on \u03a9 that we will denote by P0. P0 is defined by P0\u00f0\u03c9\u00de \u00bc limt\u21920 Pt\u00f0\u03c9\u00de for all \u03c9 \u2208 \u03a9. We also define X0 similarly: X0\u00f0\u03c9\u00de \u00bc limt\u21920 Xt\u00f0\u03c9\u00de. Effectively, this definition ignores exceptional configurations. It follows that, expectation value of X0 is \u03bc \u2212 \u0394:\n\u03bcX0 \u00bc X \u03c9\u2208\u03a9 P0\u00f0\u03c9\u00deX0\u00f0\u03c9\u00de\n\u00bc X \u03c9\u2208E P0\u00f0\u03c9\u00deX0\u00f0\u03c9\u00de \u00fe X \u03c9\u2208\u00f0\u03a9nE\u00de P0\u00f0\u03c9\u00deX0\u00f0\u03c9\u00de\n\u00bc X\n\u03c9\u2208\u00f0\u03a9nE\u00de lim t\u21920\nPt\u00f0\u03c9\u00delim t\u21920 Xt\u00f0\u03c9\u00de\n\u00bc lim t\u21920 X \u03c9\u2208\u00f0\u03a9nE\u00de Pt\u00f0\u03c9\u00deXt\u00f0\u03c9\u00de\n\u00bc \u03bc \u2212 \u0394: \u00f0A7\u00de\nNow given \u03b4, \u03f5 > 0, by the WLLN there is an integer N\u00f0\u03b4; \u03f5\u00de such that for all N \u2265 N\u00f0\u03b4; \u03f5\u00de:\nP\u00f0jX\u03040N \u2212 \u00f0\u03bc \u2212 \u0394\u00dej \u2264 \u03b4\u00de \u2265 1 \u2212 \u03f5: \u00f0A8\u00de\nNow we consider \u00f0Ec\u00deN, the set of ensembles of sample size N that does not include any exceptional configurations where Ec\u03a9nE. For P0, exceptional configurations can be ignored and therefore \u03a9N \u2261 \u00f0Ec\u00deN effectively so it follows that:\nP0\u00f0jX\u03040N \u2212 \u00f0\u03bc \u2212 \u0394\u00dej \u2264 \u03b4\u00de \u00bc P0\u00f0jX\u03040N \u2212 \u00f0\u03bc \u2212 \u0394\u00dej \u2264 \u03b4j\u03c9N \u2208 \u00f0Ec\u00deN\u00de \u00bc lim\nt\u21920 Pt\u00f0jX\u0304tN \u2212 \u00f0\u03bc \u2212 \u0394\u00dej \u2264 \u03b4j\u03c9N \u2208 \u00f0Ec\u00deN\u00de: \u00f0A9\u00de\nNow we make the following observation. Let \u00f0\u00f0Ec\u00deN\u00dec \u2282 \u03a9N be the subset of \u03a9NS that includes at least one element from E, the set of the exceptional configurations. The probability of \u00f0\u00f0Ec\u00deN\u00dec occurs is a polynomial in the variables fPt\u00f0\u03c9\u00de\u2236\u03c9 \u2208 Eg with the constant term is vanishing. Since limt\u21920 Pt\u00f0\u03c9\u00de \u00bc 0 for all \u03c9 \u2208 E, we have:\n094506-18\nlim t\u21920 Pt\u00f0\u00f0\u00f0Ec\u00deN\u00dec\u00de \u00bc 0 lim t\u21920 Pt\u00f0\u00f0Ec\u00deN\u00de \u00bc 1: \u00f0A10\u00de\nNow we complete the proof of Theorem 2 by combining Eqs. (A9) and (A10):\nlim t\u21920 Pt\u00f0jX\u0304tN \u2212 \u00f0\u03bc \u2212 \u0394\u00dej \u2264 \u03b4\u00de \u00bc limt\u21920P t\u00f0jX\u0304tN \u2212 \u00f0\u03bc \u2212 \u0394\u00dej \u2264 \u03b4j\u03c9N \u2208 \u00f0Ec\u00deN\u00dePt\u00f0\u03c9N \u2208 \u00f0Ec\u00deN\u00de\n\u00fe lim t\u21920 Pt\u00f0jX\u0304tN \u2212 \u00f0\u03bc \u2212 \u0394\u00dej \u2264 \u03b4j\u03c9N \u2208 \u00f0\u00f0Ec\u00deN\u00dec\u00dePt\u00f0\u03c9N \u2208 \u00f0\u00f0Ec\u00deN\u00dec\u00de \u00bc lim\nt\u21920 Pt\u00f0jX\u0304tN \u2212 \u00f0\u03bc \u2212 \u0394\u00dej \u2264 \u03b4j\u03c9N \u2208 \u00f0Ec\u00deN\u00de\n\u00bc P0\u00f0jX\u03040N \u2212 \u00f0\u03bc \u2212 \u0394\u00dej \u2264 \u03b4\u00de \u2265 1 \u2212 \u03f5: \u00f0A11\u00de"
        },
        {
            "heading": "APPENDIX B: MEDIAN OF MEANS",
            "text": "In this section we will prove Eq. (18) for the median of means by modifying the arguments given in Ref. [11] to include correlations between samples. Consider a random variable X with mean \u03bcX. Given an \u03f5 > 0, we aim to find a lower bound for the probability that j\u03bc\u0302MoM \u2212 \u03bcXj < \u03f5, where \u03bc\u0302MoM is defined in Sec. III C. If there are K batches of size B, for this to happen less than K\n2 of the batch means\n\u03bc\u0302i must be outside the range \u00f0\u03bcX \u2212 \u03f5; \u03bcX \u00fe \u03f5\u00de. Let us define the indicator random variables Ii for i \u00bc 1;\u2026; K. Ii defined to be 1 if \u03bc\u0302i \u2208 \u00f0\u03bc \u2212 \u03f5; \u03bc\u00fe \u03f5\u00de and 0 otherwise. Consequently:\nProb\u00f0j\u03bc\u0302MoM \u2212 \u03bcj < \u03f5\u00de \u2265 Prob 1\nK XK i\u00bc1 Ii < 1 2 : \u00f0B1\u00de\nSince the batches are independent, we can use Hoeffding\u2019s inequality ([10]):\nProb\n1\nK XK i\u00bc1 Ii < 1 2 \u2265 1 \u2212 e\u22122K\u00f012\u2212E\u00bdI1 \u00de2 ; \u00f0B2\u00de\nwhere the first indicator function I1 is chosen for convenience. Now we define \u03bc\u03021 to be the standard deviation of X and use Chebyshev\u2019s inequality ([10]) to obtain:\nE\u00bdI1 \u2212 1 2 \u00bc 1 2 \u2212 Prob\u00f0j\u03bc\u03021 \u2212 \u03bcj \u2265 \u03f5\u00de\n\u2265 1 2 \u2212 \u03c321 \u03f52 : \u00f0B3\u00de\nBy choosing \u03f5 \u00bc 2\u03c31, we obtain:\nProb\u00f0j\u03bc\u0302MoM \u2212 \u03bcj < 2\u03c31\u00de \u2265 1 \u2212 e\u2212K8 : \u00f0B4\u00de\nTo estimate \u03c31, we note that \u03bc\u03021 \u00bc 1B P B n\u00bc1 Xn. Then one obtains:\n\u03c321 \u00bc 1\nB2 XB n\u00bc1 Var\u00f0Xn\u00de \u00fe 2 X m<n Cov\u00f0Xm; Xn\u00de\n\u00bc 1 B2 B\u03c32 \u00fe 2 XB\u22121 m\u00bc1 XB n\u00bcm\u00fe1 Cov\u00f0Xm; Xn\u00de\n\u00bc 1 B2 B\u03c32 \u00fe 2\u03c32 XB\u22121 m\u00bc1 XB n\u00bcm\u00fe1 \u0393X\u00f0n \u2212m\u00de\n\u00bc 1 B2 B\u03c32 \u00fe 2\u03c32 XB\u22121 t\u00bc1 \u00f0B \u2212 t\u00de\u0393X\u00f0t\u00de\n\u00bc \u03c3 2\nB\n1\u00fe 2 XB\u22121 t\u00bc1 1 \u2212 t B \u0393X\u00f0t\u00de\n\u00bc \u03c3 2\nB 2\u03c4X;int\u00f0B\u00de; \u00f0B5\u00de\nwhere we have defined the autocorrelation function \u0393X\u00f0t\u00de\u2261 1\u03c32 Cov\u00f0Xn; Xn\u00fet\u00de and the integrated autocorrelation time \u03c4X;int\u00f0B\u00de \u00bc 12 \u00fe P B\u22121 t\u00bc1 \u00f01 \u2212 tB\u00de\u0393X\u00f0t\u00de [The sequence fXng is assumed to be stationary, \u0393X\u00f0t\u00de is independent of n.]. Equation (18) then follows by combining above inequality with (B4)."
        },
        {
            "heading": "APPENDIX C: GAUSS-HERMITE QUADRATURE",
            "text": "The polynomials Hen\u00f0\u03be\u00de are defined by:\nHen\u00f0\u03be\u00de \u00bc \u00f0\u22121\u00dene12\u03be2 dn\nd\u03ben e\u2212 1 2 \u03be2 \u00f0C1\u00de\nand have the properties:\n1ffiffiffiffiffi 2\u03c0\np Z\nd\u03bee\u2212 1 2 \u03be2\u03bemHen\u00f0\u03be\u00de \u00bc 0 for 0 \u2264 m < n; \u00f0C2\u00de\n1ffiffiffiffiffi 2\u03c0\np Z\nd\u03bee\u2212 1 2 \u03be2Hem\u00f0\u03be\u00deHen\u00f0\u03be\u00de \u00bc n!\u03b4nm; \u00f0C3\u00de\n094506-19\nHn\u00f0\u03be\u00de \u00bc \u03ben \u00fe\u2026: \u00f0C4\u00de\nConsider a polynomial f\u00f0\u03be\u00de of degree at most 2n \u2212 1. We can then write\nf\u00f0\u03be\u00de \u00bc q\u00f0\u03be\u00deHen\u00f0\u03be\u00de \u00fe r\u00f0\u03be\u00de; \u00f0C5\u00de\nwhere both q\u00f0\u03be\u00de and r\u00f0\u03be\u00de have degree at most n \u2212 1. By Eq. (C2) one has:\n1ffiffiffiffiffi 2\u03c0\np Z\nd\u03bee\u2212\u03be 2=2q\u00f0\u03be\u00deHen\u00f0\u03be\u00de \u00bc 0; \u00f0C6\u00de\nand therefore one obtains:\n1ffiffiffiffiffi 2\u03c0\np Z d\u03bee\u2212 1 2 \u03be2f\u00f0\u03be\u00de \u00bc 1ffiffiffiffiffi\n2\u03c0 p\nZ d\u03bee\u2212 1 2 \u03be2r\u00f0\u03be\u00de: \u00f0C7\u00de\nAs r\u00f0\u03be\u00de is a polynomial of degree at most n \u2212 1, it is determined by its values at n points. Let us choose these points f\u03be\u00f0n\u00dea ja \u00bc 1;\u2026ng as the roots of Hen\u00f0\u03be\u00de \u00bcQ n a\u00bc1\u00f0\u03be \u2212 \u03be\u00f0n\u00dea \u00de. Then we have:\nr\u00f0\u03be\u00de \u00bc X a r\u00f0\u03bea\u00de Y 1\u2264b\u2264n b\u2260a \u03be \u2212 \u03beb \u03bea \u2212 \u03beb\n\u00bc X a r\u00f0\u03bea\u00de 1Q b\u2260a\u00f0\u03bea \u2212 \u03beb\u00de Hen\u00f0\u03be\u00de \u03be \u2212 \u03bea : \u00f0C8\u00de\nThis allows us to express Eq. (C7) as:\n1ffiffiffiffiffi 2\u03c0\np Z d\u03bee\u2212 1 2 \u03be2r\u00f0\u03be\u00de \u00bc X a r\u00f0\u03bea\u00de 1Q b\u2260a\u00f0\u03bea \u2212 \u03beb\u00de\n\u00d7 1ffiffiffiffiffi 2\u03c0\np Z\nd\u03bee\u2212 1 2 \u03be2 Hen\u00f0\u03be\u00de \u03be \u2212 \u03bea : \u00f0C9\u00de\nAfter defining wa as:\nwa \u00bc 1Q b\u2260a\u00f0\u03bea \u2212 \u03beb\u00de 1ffiffiffiffiffi 2\u03c0\np Z\nd\u03bee\u2212 1 2 \u03be2 Hen\u00f0\u03be\u00de \u03be \u2212 \u03bea ; \u00f0C10\u00de\none can use f\u00f0\u03bea\u00de \u00bc q\u00f0\u03bea\u00deHen\u00f0\u03bea\u00de \u00fe r\u00f0\u03bea\u00de \u00bc r\u00f0\u03bea\u00de to obtain:\n1ffiffiffiffiffi 2\u03c0\np Z d\u03bee\u2212 1 2 \u03be2f\u00f0\u03be\u00de \u00bc X a waf\u00f0\u03bea\u00de: \u00f0C11\u00de\nMoreover, if q\u00f0\u03be\u00de is a polynomial of degree at most n: 1Q\nb\u2260a\u00f0\u03bea \u2212 \u03beb\u00de 1ffiffiffiffiffi 2\u03c0\np Z\nd\u03bee\u2212 1 2 \u03be2 Hen\u00f0\u03be\u00de \u03be \u2212 \u03bea q\u00f0\u03be\u00de \u00bc q\u00f0\u03bea\u00dewa:\n\u00f0C12\u00de To see that consider q\u00f0\u03be\u00de \u00bc \u03bem for m < n. Using the identity\n\u03bem \u00bc \u03bema \u00fe \u00f0\u03be \u2212 \u03bea\u00de\u00f0\u03bem\u22121a \u00fe \u03bem\u22122a \u03be\u00fe \u00fe \u03bea\u03bem\u22122 \u00fe \u03bem\u22121\u00de \u00f0C13\u00de\nand Eq. (C2), we see that\n1Q b\u2260a\u00f0\u03bea \u2212 \u03beb\u00de 1ffiffiffiffiffi 2\u03c0\np Z\nd\u03bee\u2212 1 2 \u03be2 Hen\u00f0\u03be\u00de \u03be \u2212 \u03bea \u03bem \u00bc \u03bema wa \u00f0C14\u00de\nfor m \u2264 n, from which (C12) follows. Now choosing q\u00f0\u03be\u00de \u00bc Hen\u22121\u00f0\u03be\u00de and using Eqs. (C2) and (C4), the lefthand side of Eq. (C12) becomes:\n1Q b\u2260a\u00f0\u03bea \u2212 \u03beb\u00de 1ffiffiffiffiffi 2\u03c0\np Z\nd\u03bee\u2212 1 2 \u03be2Hen\u22121\u00f0\u03be\u00deHen\u22121\u00f0\u03be\u00de: \u00f0C15\u00de\nUsing Eq. (C3), this leads to:\nwa \u00bc \u00f0n \u2212 1\u00de\nHe0n\u00f0\u03bea\u00deHen\u22121\u00f0\u03bea\u00de ; \u00f0C16\u00de\nwhere wa satisfies the normalization:X a wa \u00bc 1: \u00f0C17\u00de\nA table of the weights and roots corresponding to the Hermite polynomials used in this work is provided in Table II.\n094506-20"
        }
    ],
    "title": "Infinite variance in Monte Carlo sampling of lattice field theories",
    "year": 2022
}