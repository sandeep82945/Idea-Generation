{
    "abstractText": "Recent advances in native mass spectrometry (MS) and denatured intact protein MS have made these techniques essential for biotherapeutic characterization. As MS analysis has increased in throughput and scale, new data analysis workflows are needed to provide rapid quantitation from large datasets. Here, we describe the UniDec Processing Pipeline (UPP) for the analysis of batched biotherapeutic intact MS data. UPP is built into the UniDec software package, which provides fast processing, deconvolution, and peak detection. The user and programming interfaces for UPP read a spreadsheet that contains the data file names, deconvolution parameters, and quantitation settings. After iterating through the spreadsheet and analyzing each file, it returns a spreadsheet of results and HTML reports. We demonstrate the use of UPP to measure correct pairing percentage on a set of bispecific antibody data and to measure drug-toantibody ratios from antibody-drug conjugates. Moreover, because the software is free and opensource, users can easily build on this platform to create customized workflows and calculations. Thus, UPP provides a flexible workflow that can be deployed in diverse settings and for a wide range of biotherapeutic applications.",
    "authors": [
        {
            "affiliations": [],
            "name": "Wilson Phung"
        },
        {
            "affiliations": [],
            "name": "Corey E. Bakalarski"
        },
        {
            "affiliations": [],
            "name": "Trent B. Hinkle"
        },
        {
            "affiliations": [],
            "name": "Wendy Sandoval"
        },
        {
            "affiliations": [],
            "name": "Michael T. Marty"
        }
    ],
    "id": "SP:02f6b9d466e472b83b3390cbc3db99f6fcf37d12",
    "references": [
        {
            "authors": [
                "K.R. Karch",
                "D.T. Snyder",
                "S.R. Harvey",
                "V.H. Wysocki"
            ],
            "title": "Native Mass Spectrometry: Recent Progress and Remaining Challenges",
            "venue": "Annu. Rev. Biophys. 2022,",
            "year": 2022
        },
        {
            "authors": [
                "I.D.G. Campuzano",
                "W. Sandoval"
            ],
            "title": "Denaturing and Native Mass Spectrometric Analytics for Biotherapeutic Drug Discovery Research: Historical, Current, and Future Personal Perspectives",
            "venue": "J Am Soc Mass Spectr 2021,",
            "year": 2021
        },
        {
            "authors": [
                "J.F. Kellie",
                "J.C. Tran",
                "W. Jian",
                "B. Jones",
                "J.T. Mehl",
                "Y. Ge",
                "J. Henion",
                "K.P. Bateman"
            ],
            "title": "Intact Protein Mass Spectrometry for Therapeutic Protein Quantitation, Pharmacokinetics, and Biotransformation in Preclinical and Clinical Studies: An Industry Perspective",
            "venue": "J Am Soc Mass Spectr 2021,",
            "year": 2021
        },
        {
            "authors": [
                "Y. Yin",
                "G. Han",
                "J. Zhou",
                "M. Dillon",
                "L. McCarty",
                "L. Gavino",
                "D. Ellerman",
                "C. Spiess",
                "W. Sandoval",
                "P.J. Carter"
            ],
            "title": "Precise quantification of mixtures of bispecific IgG produced in single host cells by liquid chromatography-Orbitrap high-resolution mass spectrometry",
            "venue": "MAbs 2016,",
            "year": 2016
        },
        {
            "authors": [
                "Y. Yan",
                "T. Xing",
                "S. Wang",
                "T.J. Daly",
                "N. Li"
            ],
            "title": "Coupling Mixed-Mode Size Exclusion Chromatography with Native Mass Spectrometry for Sensitive Detection and Quantitation of Homodimer Impurities in Bispecific IgG",
            "venue": "Anal. Chem. 2019,",
            "year": 2019
        },
        {
            "authors": [
                "I. Grunert",
                "K. Heinrich",
                "M. Hingar",
                "J. Ernst",
                "M. Winter",
                "K. Bomans",
                "K. Wagner",
                "A. Fevre",
                "D. Reusch",
                "M. Wuhrer",
                "P. Bulau"
            ],
            "title": "Comprehensive Multidimensional Liquid Chromatography\u2013Mass Spectrometry for the Characterization of Charge Variants of a Bispecific Antibody",
            "venue": "J Am Soc Mass Spectr 2022,",
            "year": 2022
        },
        {
            "authors": [
                "K.K. Joshi",
                "W. Phung",
                "G. Han",
                "Y. Yin",
                "I. Kim",
                "W. Sandoval",
                "P.J. Carter"
            ],
            "title": "Elucidating heavy/light chain pairing preferences to facilitate the assembly of bispecific IgG in single cells",
            "venue": "mAbs 2019,",
            "year": 2019
        },
        {
            "authors": [
                "I.D.G. Campuzano",
                "M. Nshanian",
                "C. Spahr",
                "C. Lantz",
                "C. Netirojjanakul",
                "H. Li",
                "P. Wongkongkathep",
                "J.J. Wolff",
                "J.A. Loo"
            ],
            "title": "High Mass Analysis with a Fourier Transform Ion Cyclotron Resonance Mass Spectrometer: From Inorganic Salt Clusters to Antibody Conjugates and Beyond",
            "venue": "J. Am. Soc. Mass Spectrom. 2020,",
            "year": 2020
        },
        {
            "authors": [
                "A. Dyachenko",
                "G. Wang",
                "M. Belov",
                "A. Makarov",
                "R.N. de Jong",
                "E.T.J. van den Bremer",
                "P.W.H.I. Parren",
                "A.J.R. Heck"
            ],
            "title": "Tandem Native Mass-Spectrometry on Antibody\u2013Drug Conjugates and Submillion Da Antibody\u2013Antigen Protein Assemblies on an Orbitrap EMR Equipped with a High-Mass Quadrupole Mass Selector",
            "venue": "Anal. Chem. 2015,",
            "year": 2015
        },
        {
            "authors": [
                "A. Ehkirch",
                "V. D'Atri",
                "F. Rouviere",
                "O. Hernandez-Alba",
                "A. Goyon",
                "O. Colas",
                "M. Sarrut",
                "A. Beck",
                "D. Guillarme",
                "S. Heinisch",
                "S. Cianferani"
            ],
            "title": "An Online Four-Dimensional HICxSEC-IMxMS Methodology for Proof-of-Concept Characterization of Antibody",
            "venue": "Drug Conjugates. Anal. Chem. 2018,",
            "year": 2018
        },
        {
            "authors": [
                "K.O. Nagornov",
                "N. Gasilova",
                "A.N. Kozhinov",
                "P. Virta",
                "P. Holm",
                "L. Menin",
                "V.J. Nesatyy",
                "Y.O. Tsybin"
            ],
            "title": "Drug-to-Antibody Ratio Estimation via Proteoform Peak Integration in the Analysis of Antibody-Oligonucleotide Conjugates with Orbitrap Fourier Transform Mass Spectrometry",
            "venue": "Anal. Chem. 2021,",
            "year": 2021
        },
        {
            "authors": [
                "K.J. Pacholarz",
                "P.E. Barran"
            ],
            "title": "Use of a charge reducing agent to enable intact mass analysis of cysteine-linked antibody-drug-conjugates by native mass spectrometry",
            "venue": "EuPA Open Proteomics 2016,",
            "year": 2016
        },
        {
            "authors": [
                "Z.L. VanAernum",
                "F. Busch",
                "B.J. Jones",
                "M. Jia",
                "Z. Chen",
                "S.E. Boyken",
                "A. Sahasrabuddhe",
                "D. Baker",
                "V.H. Wysocki"
            ],
            "title": "Rapid online buffer exchange for screening of proteins, protein complexes and cell lysates by native mass spectrometry",
            "venue": "Nat Protoc 2020,",
            "year": 2020
        },
        {
            "authors": [
                "C. Ren",
                "A.O. Bailey",
                "E. VanderPorten",
                "A. Oh",
                "W. Phung",
                "M.M. Mulvihill",
                "S.F. Harris",
                "Y. Liu",
                "G. Han",
                "W. Sandoval"
            ],
            "title": "Quantitative Determination of Protein\u2013Ligand Affinity by Size Exclusion Chromatography Directly Coupled to High-Resolution Native Mass Spectrometry",
            "venue": "Anal. Chem. 2019,",
            "year": 2019
        },
        {
            "authors": [
                "I.D.G. Campuzano",
                "E.M. Pelegri-O'Day",
                "N. Srinivasan",
                "J.L. Lippens",
                "P. Egea",
                "A. Umeda",
                "J. Aral",
                "T. Zhang",
                "A. Laganowsky",
                "C. Netirojjanakul"
            ],
            "title": "High-Throughput Mass Spectrometry for Biopharma: A Universal Modality and Target Independent Analytical Method for Accurate Biomolecule Characterization",
            "venue": "J. Am. Soc. Mass Spectrom. 2022,",
            "year": 2022
        },
        {
            "authors": [
                "A.O. Zacharias",
                "C. Liu",
                "Z.L. VanAernum",
                "T.R. Covey",
                "K.P. Bateman",
                "X. Wen",
                "D.G. McLaren"
            ],
            "title": "Ultrahigh-Throughput Intact Protein Analysis with Acoustic Ejection Mass Spectrometry",
            "venue": "J. Am. Soc. Mass Spectrom. 2023,",
            "year": 2023
        },
        {
            "authors": [
                "A.D. Rolland",
                "J.S. Prell"
            ],
            "title": "Approaches to Heterogeneity in Native Mass Spectrometry",
            "venue": "Chem. Rev. 2022,",
            "year": 2022
        },
        {
            "authors": [
                "M.T. Marty",
                "A.J. Baldwin",
                "E.G. Marklund",
                "G.K. Hochberg",
                "J.L. Benesch",
                "C.V. Robinson"
            ],
            "title": "Bayesian deconvolution of mass and ion mobility spectra: from binary interactions to polydisperse ensembles",
            "venue": "Anal. Chem. 2015,",
            "year": 2015
        },
        {
            "authors": [
                "M.T. Marty"
            ],
            "title": "A Universal Score for Deconvolution of Intact Protein and Native Electrospray Mass Spectra",
            "venue": "Anal. Chem. 2020,",
            "year": 2020
        },
        {
            "authors": [
                "M.T. Marty"
            ],
            "title": "Eliminating Artifacts in Electrospray Deconvolution with a SoftMax Function",
            "venue": "J. Am. Soc. Mass Spectrom. 2019,",
            "year": 2019
        },
        {
            "authors": [
                "D.J. Reid",
                "J.M. Diesing",
                "M.A. Miller",
                "S.M. Perry",
                "J.A. Wales",
                "W.R. Montfort",
                "M.T. Marty"
            ],
            "title": "MetaUniDec: High-Throughput Deconvolution of Native Mass Spectra",
            "venue": "J. Am. Soc. Mass Spectrom. 2019,",
            "year": 2019
        },
        {
            "authors": [
                "W. McKinney"
            ],
            "title": "In Data structures for statistical computing in python",
            "year": 2010
        },
        {
            "authors": [
                "T. Bald",
                "J. Barth",
                "A. Niehues",
                "M. Specht",
                "M. Hippler",
                "C. Fufezan"
            ],
            "title": "pymzML\u2014Python module for high-throughput bioinformatics on mass spectrometry data",
            "venue": "Bioinformatics 2012,",
            "year": 2012
        },
        {
            "authors": [
                "A.A. Goloborodko",
                "L.I. Levitsky",
                "M.V. Ivanov",
                "M.V. Gorshkov"
            ],
            "title": "Pyteomics\u2014a Python Framework for Exploratory Data Analysis and Rapid Software Prototyping in Proteomics",
            "venue": "J Am Soc Mass Spectr 2013,",
            "year": 2013
        },
        {
            "authors": [
                "L.I. Levitsky",
                "J.A. Klein",
                "M.V. Ivanov",
                "M.V. Gorshkov"
            ],
            "title": "Pyteomics 4.0: Five Years of Development of a Python Proteomics Framework",
            "venue": "J Proteome Res 2019,",
            "year": 2019
        },
        {
            "authors": [
                "W.M. Alexander",
                "S.B. Ficarro",
                "G. Adelmant",
                "J.A. Marto"
            ],
            "title": "multiplierz v2.0: A Pythonbased ecosystem for shared access and analysis of native mass spectrometry data",
            "venue": "Proteomics 2017,",
            "year": 2017
        },
        {
            "authors": [
                "M.M. Kostelic",
                "M.T. Marty"
            ],
            "title": "Deconvolving Native and Intact Protein Mass Spectra with UniDec",
            "venue": "In Proteoform Identification: Methods and Protocols,",
            "year": 2022
        },
        {
            "authors": [
                "J. Jones",
                "L. Pack",
                "J.H. Hunter",
                "J.F. Valliere-Douglass"
            ],
            "title": "Native size-exclusion chromatography-mass spectrometry: suitability for antibody-drug conjugate drug-to-antibody ratio quantitation across a range of chemotypes and drug-loading levels",
            "venue": "MAbs 2020,",
            "year": 2020
        },
        {
            "authors": [
                "C.E. Norris",
                "J.E. Keener",
                "S. Perera",
                "N. Weerasinghe",
                "S.D.E. Fried",
                "W.C. Resager",
                "J.G. Rohrbough",
                "M.F. Brown",
                "M.T. Marty"
            ],
            "title": "Native Mass Spectrometry Reveals the Simultaneous Binding of Lipids and Zinc to Rhodopsin",
            "venue": "Int. J. Mass Spectrom",
            "year": 2021
        },
        {
            "authors": [
                "W. Li",
                "A.S. Norris",
                "K. Lichtenthal",
                "S. Kelly",
                "E.C. Ihms",
                "P. Gollnick",
                "V.H. Wysocki",
                "M.P. Foster"
            ],
            "title": "Thermodynamic coupling between neighboring binding sites in homooligomeric ligand sensing proteins from mass resolved ligand-dependent population distributions",
            "venue": "Protein Sci. 2022,",
            "year": 2022
        },
        {
            "authors": [
                "A.A. Vorobieva",
                "P. White",
                "B. Liang",
                "J.E. Horne",
                "A.K. Bera",
                "C.M. Chow",
                "S. Gerben",
                "S. Marx",
                "A. Kang",
                "A.Q. Stiving",
                "S.R. Harvey",
                "D.C. Marx",
                "G.N. Khan",
                "K.G. Fleming",
                "V.H. Wysocki",
                "D.J. Brockwell",
                "L.K. Tamm",
                "S.E. Radford",
                "D. Baker"
            ],
            "title": "De novo design of transmembrane \u03b2 barrels",
            "venue": "Science 2021,",
            "year": 2021
        },
        {
            "authors": [
                "M.M. Kostelic",
                "C.K. Zak",
                "Y. Liu",
                "V.S. Chen",
                "Z. Wu",
                "J. Sivinski",
                "E. Chapman",
                "M.T. Marty"
            ],
            "title": "UniDecCD: Deconvolution of Charge Detection-Mass Spectrometry Data",
            "venue": "Anal. Chem. 2021,",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "made these techniques essential for biotherapeutic characterization. As MS analysis has increased in throughput and scale, new data analysis workflows are needed to provide rapid quantitation from large datasets. Here, we describe the UniDec Processing Pipeline (UPP) for the analysis of batched biotherapeutic intact MS data. UPP is built into the UniDec software package, which provides fast processing, deconvolution, and peak detection. The user and programming interfaces for UPP read a spreadsheet that contains the data file names, deconvolution parameters, and quantitation settings. After iterating through the spreadsheet and analyzing each file, it returns a spreadsheet of results and HTML reports. We demonstrate the use of UPP to measure correct pairing percentage on a set of bispecific antibody data and to measure drug-toantibody ratios from antibody-drug conjugates. Moreover, because the software is free and opensource, users can easily build on this platform to create customized workflows and calculations. Thus, UPP provides a flexible workflow that can be deployed in diverse settings and for a wide range of biotherapeutic applications.\nIntroduction Native and intact protein mass spectrometry (MS) has become an indispensable tool for analysis of therapeutic antibodies and other therapeutic modalities.1-3 By measuring the masses of intact antibodies, MS quickly reveals the distribution of proteoforms and can detect changes to the expected species. Importantly, as therapeutic modalities have become more complex, the mass distributions also confirm correct assembly of the products. For example, native/intact MS is useful for elucidating the correct pairing of bispecific antibodies and correct assembly of more complex structures.4-7 In developing and optimizing bispecific antibody pairing strategies, minimizing undesired species, including mis-paired antibodies and homodimers, is crucial in any bispecific therapeutic platform.\nNative/intact MS is also useful for measuring the drug-to-antibody ratio for antibody-drug\nconjugates (ADCs) and in characterizing other covalently modified antibodies.8-12 In designing ADCs, determining the drug payload is essential in improving potency as well as enhancing the functionality of the ADC as a whole.13 Thus, the ability to characterize bispecific antibodies and ADCs in a high-throughput manner is highly beneficial in evaluating these therapeutic strategies.\nUnlike denatured intact protein MS, native MS initially relied on manual injection with\nsingle-use borosilicate needles for each sample. However, recent work has advanced automated\nonline injections and sample preparation.1 For example, using online buffer exchange14 or online size-exclusion chromatography15 enables automated native MS analysis with very little user intervention at a rate of minutes per sample. Faster high-throughput methods are also being developed for denatured intact protein analysis, with rates as fast as a sample per second.16, 17\nThese advances in data collection throughput have driven a need for higher throughput\ndata analysis methods. A range of open source and commercial packages are available, which have been reviewed previously.18 Among the open-source options, UniDec has become widely used in academic and industrial settings due to its speed and flexibility.19 Prior publications have developed scoring methods,20 algorithm improvements,21 and new modules to help support highthroughput data analysis with collections of related data.22 However, there was previously not a simple workflow for analysis of a large number of independent samples, especially applied to biotherapeutic settings.\nHere, we describe the UniDec Processing Pipeline (UPP), a new module in the UniDec\nsoftware package designed to streamline analysis and reporting of large, independent data sets. We discuss the key components of UPP and demonstrate its use for rapid analysis of a dataset of bispecific antibody pairing and calculating drug-to-antibody ratios (DARs). We also discuss additional applications that could be built on this flexible open-source platform."
        },
        {
            "heading": "Code and Software Availability",
            "text": "UPP is part of the UniDec software package, which is distributed free and open source on GitHub: https://github.com/michaelmarty/UniDec. It has a modified BSD 3-clause license that permits unlimited use (including for commercial purposes and with modifications), unlimited numbers of downloads and installations, and very permissive redistribution, including allowing commercial redistribution with proper attribution (detailed in the license). Thus, UPP is readily customizable and can be deployed in a wide range of settings.\nA compiled, stand-alone Windows graphical user interface (GUI) can be downloaded from\nGitHub: https://github.com/michaelmarty/UniDec/releases. Support for Mac and Linux operating systems is available through Python distribution described below. UPP can be run through the GUI (Figure 1) by selecting UPP from the main Launcher. Additional documentation and a wiki page with video tutorials can also be found on the GitHub page (https://github.com/michaelmarty/UniDec/wiki).\nUniDec is written primarily in Python with the core UniDec algorithm in C. All changes to\nimplement UPP were added to the Python code and relied on the existing UniDec application programming interface (API). In addition to GitHub, UniDec is also available from the Python Packaging Index (PyPI, https://pypi.org) and can be installed with \u201cpip install unidec\u201d. After installing UniDec, the main GUI can be launched with the command: \u201cpython -m unidec.Launcher\u201d. With Python, the UniDec GUI can be run on Linux and Mac computers. However, it can also be run through the command line and scripted. Binaries of the C code are provided for Linux and Mac, but users may need to run the compiling scripts on their own machine.\nFinally, to facilitate use in high-throughput settings, a UniDec Docker image has been built.\nFreely available for download and deployment from DockerHub (https://hub.docker.com/r/michaeltmarty/unidec), this image allows for instant access to UPP analysis using Docker or Singularity on any system, from personal laptops to high-performance computing clusters and cloud providers such as Amazon Web Services. Between the GUI for\ndesktop use, the PyPI distribution for easy Python scripting and direct integration into custom data processing pipelines, and the container for large scale deployment, UPP is easily accessible and interoperable with a variety of systems."
        },
        {
            "heading": "Computational Design and Methods",
            "text": ""
        },
        {
            "heading": "Overall Design and GUI",
            "text": "The primary data structure in UPP is a simple data table, imported from either an Excel spreadsheet or CSV file into a Pandas DataFrame23 (Figure 1A). UPP operates by iterating over each row of the table (Figure 1B), applying different options specified in the input to the deconvolution and analysis, and writing outputs from the analysis into a results spreadsheet, which can be displayed in the GUI (Figure 1C). As described below, these outputs can include peak heights for specific mass combinations or DAR calculations, depending on the input values in the spreadsheet. Users can deconvolve and analyze a set of data automatically without viewing any spectra. However, HTML reports are generated for each file and linked in the results spreadsheet (Figure 2). Each of these individual reports is also concatenated into a larger combined HTML report viewable in any web browser. Examples of input spreadsheets, HTML reports, and results spreadsheets are provided in the supporting information.\nUPP consists of three main Python modules. First, the UPP.py file provides the GUI. The\nUPP GUI is a simple spreadsheet interface that allows spreadsheet files to be opened, saved, and manipulated (Figure 1). Users can select specific rows to run through UniDec or run the entire spreadsheet. A limited set of run options are present, but specific deconvolution settings are entered into the spreadsheet, not in the GUI, to enable automated analysis at scale."
        },
        {
            "heading": "Batch Processing Engine",
            "text": "Second, the batch.py file provides the core engine of the UPP workflow. The UniDecBatchProcessor object can either read a spreadsheet file or a Pandas DataFrame object. The batch processer is called by the GUI, but it can also be run through scripting or command line inputs (for example with a command \u201cpython -m unidec.batch file.xlsx\u201d).\nThe engine iterates over each row in the spectrum and reads the values specified by\ndifferent column keywords present in the spreadsheet (Figure 1B). The complete list of recognized column keywords is detailed in the help menu, and a copy of the help page is provided in the supporting information. The only required keyword is \u201cSample name\u201d. The \u201cSample name\u201d column provides the location of the file to deconvolve. Note, the capitalization of the keywords should match exactly. An additional optional keyword of \u201cData Directory\u201d can be provided to specify the\ndata location if a full path is not provided in the \u201cSample name\u201d. A wide range of file types are currently supported by UniDec, including text, csv, mzML (using pymzml24), mzXML (using pyteomics25, 26), and raw data formats from Agilent (using multiplierz27), Waters, and Thermo. Note, the vendor raw data formats use libraries that are only available on Windows. We welcome support from other file types from anyone willing to contribute Python libraries for conversion.\nFor each row iteration, UniDec will open the specified file, process the data, run the\ndeconvolution, perform peak picking, and generate an HTML report. The UniDec processing, deconvolution, and peak picking have been described previously,19, 28 and more information can be found in the online wiki and tutorial videos linked above. Each report has a sortable list of peaks, plots of both the deconvolved mass and raw data, and a list of parameters used. An example is provided in the supporting information and shown in Figure 2. The HTML format makes reports easily shareable, and they can be opened directly in a browser by clicking on the GUI. The individual report locations are added to the output results spreadsheet, which is saved at the end of the run. For simple deconvolution, the only thing that needs to be specified is the file location, and the only output will be the \u201cReports\u201d column. A global HTML report is also saved alongside the results spreadsheet. This global report concatenates the individual HTML reports into a combined document for easy browsing, and an example is provided in the supporting information for the DAR dataset.\nSettings for the deconvolution can be adjusted by adding additional columns to the\nspreadsheet. For example, including \u201cStart Time\u201d and \u201cEnd Time\u201d as keywords will select specific time ranges from the data to analyze (assuming retention time is present in the original data format). Various deconvolution settings can also be adjusted. For example, adding columns like \u201cConfig Low Mass\u201d and \u201cConfig High Mass\u201d can be used to set the minimum and maximum masses for the deconvolution. An external \u201cConfig File\u201d location can also be added as a column to override the default parameters with a new config parameter set. In contrast with MetaUniDec22 and other UniDec batch processing features,19 UPP enables each row of the spreadsheet to have different, customizable deconvolution parameters if needed. An example input spreadsheet is provided in the supporting information.\nIn addition to modifying config parameters in the spreadsheet, users can open the main\nUniDec GUI on any individual file to manually fine tune settings (either directly from the UPP GUI or by opening the file separately with the main UniDec GUI). During data conversion, a fresh config file is created for each file. However, if the \u201cUse Converted Data\u201d option is selected, the existing config file (with any manual changes) will be used. In all cases, the config file will still be overwritten by settings in the spreadsheet, so the spreadsheet must be updated to reflect the manual adjustments."
        },
        {
            "heading": "Matching Workflow",
            "text": "The third primary Python module used in UPP is matchtools.py, which provides an extensible library of modules that analyze the peaks that are detected in the deconvolution step. These libraries have been designed to provide a framework for custom peak analysis, and users are welcome to design their own recipes for analyzing the peaks and reporting the results back to the output spreadsheet. To demonstrate the potential for these recipes, we designed two analysis workflows. The first checks for correct combinations of masses from a list of provided masses and/or sequences. The second calculates DARs for antibody-drug conjugates (ADCs).\nEach recipe can be loaded into the system at runtime and can be activated by required keywords in the column names of the input data table."
        },
        {
            "heading": "Checking for Correct Pairing of Bispecific Antibodies",
            "text": "The goal of this recipe is to extract the peak heights for predicted masses. Within this general framework, there are a number of ways to accomplish the overarching goal, depending on the column keyword and cell values provided. In the most basic case, users can provide the masses directly in cells and include either \u201cCorrect\u201d, \u201cIncorrect\u201d, or \u201cIgnore\u201d in the column labels. Only the correct column is required. There can be multiple columns of each type, as long as they include the \u201cCorrect\u201d, \u201cIncorrect\u201d, and \u201cIgnore\u201d keywords somewhere in the column header. For our bispecific antibody example, we set \u201cLC1 Mispair (Incorrect)\u201d and \u201cLC2 Mispair (Incorrect)\u201d as two possible incorrect species.\nBeyond the basic case of directly providing masses, users can also match with\ncombinations of masses/sequences. Here, columns are provided in the spreadsheet with the keyword \u201cSequence\u201d plus some unique identifier. For example, we use \u201cSequence LC1\u201d for the first light chain value. Currently, the values provided in each sequence cell can either be the mass of the species or the amino acid sequence of the protein, which UniDec will automatically use to calculate the mass. However, it would be possible in the future to convert SMILES, nucleic acid sequences, or other similar codes to mass if a suitable function can be provided in Python. Custom code could also be written to query a database based on identifiers in the cell and retrieve a mass value.\nIn our example of bispecific antibody analysis, we specify the predicted masses for\n\u201cSequence LC1\u201d, \u201cSequence HC1\u201d, \u201cSequence LC2\u201d, and \u201cSequence HC2\u201d. Additional columns can also be provided to apply fixed modifications and disulfide oxidation, which requires an amino acid sequence. All of these adjust the masses that UniDec will generate to match with the detected peaks.\nAfter defining sequences, users can then specify the sequence combinations under the\ncorrect, incorrect, or ignore columns. Here, the cell uses \u201cSeq\u201d with the unique identifier as a code to specify the \u201cSequence\u201d species in a string with \u201c+\u201d separating the species. For example, the \u201cLC1 Mispair (Incorrect)\u201d column has a cell value of \u201cSeqLC1+SeqHC1+SeqLC1+SeqHC2\u201d. This combination tells the software to combine the masses of the columns with \u201cSequence LC1\u201d + \u201cSequence HC1\u201d + \u201cSequence LC1\u201d + \u201cSequence HC2\u201d. As a reminder, correct capitalization of the keywords is required. Also, it is possible to only have a single species (\u201cSeqProtein\u201d for example) in the cell. An example input file is provided in the supporting information.\nFor each correct, incorrect, or ignored column (whether defined directly or as sequence\ncombinations), this recipe will calculate the potential mass for this species, apply any variable modifications, and generate a list of potential species. It will then match this list with peaks found in the data, subject to the defined tolerance. For each combination, it will return the peak heights (both absolute and relative) to the results file. It will also sum all the correct, incorrect, and ignored peaks to generate the total peak heights (both absolute and relative) of the correct, incorrect, and ignored species. Finally, it will calculate the percentage correct vs. incorrect after ignored species are removed and report which matches are found. In the HTML reports, peaks are colored based on their status of correct (green), incorrect (red), ignored (blue), or unknown (yellow), as shown in Figure 2 and in the example report in the supporting information. An example results\nspreadsheet is also provided in the supporting information. Overall, this workflow allows users to quickly extract the absolute and relative intensities of combinations of potential species.\nAlthough we have illustrated this for bispecific antibodies, it would be straightforward to\nuse this same workflow for measuring protein-ligand binding or covalent protein modifications. Here, users would specify \u201cSequence Protein\u201d and \u201cSequence Ligand\u201d with the necessary masses. Correct binding stoichiometries could be defined as \u201cSeqProtein+SeqLigand\u201d. Incorrect binding could be defined as \u201cSeqProtein\u201d. UPP would then return the percentage of protein that is bound to the ligand versus unbound. Additional custom calculations or other binding stoichiometries could be added as needed.\nDrug-to-Antibody Ratio Calculations In addition to the correct pairing workflow described above, we also developed a matching workflow for calculating DARs. Here, the spreadsheet requires the \u201cProtein Mass\u201d, which can be either 1) the predicted mass, 2) the amino acid sequence of the protein, 3) or a \u201cSeq\u201d code word combination, using the same nomenclature described above. Fixed modifications can be applied in several ways, as described in the help documentation.\nThis workflow also requires the \u201cDrug Mass\u201d and \u201cMax Drugs\u201d, which specifies the\nmaximum number of potential drug conjugations to consider. A \u201cMin Drugs\u201d column, specifying the minimum number of potential drug conjugations to consider, can also be supplied, but it will default to 0. UniDec then combines different numbers of the drug mass, ranging from the minimum to the maximum number of potential conjugations, with the total protein mass. These masses are matched with peaks from the spectrum to determine the peak heights. The DAR is then calculated29 from the peak heights and added as a new column on the report. An example report is provided in the supporting information, and a screenshot of the outputs and select inputs is shown in Figure 3."
        },
        {
            "heading": "Results and Discussion",
            "text": "Application to Bispecific Antibodies To demonstrate the use of UPP, we first tested it against a dataset of bispecific antibodies containing 115 independent denatured LC/MS runs that had been previously published.4 In the spreadsheet (see example in the supporting information), we specified the file names and the data directory. Data was provided as Thermo Raw format and converted using the internal\nlibraries in UniDec. The time range was specified to capture the antibody peak eluting from the column. Simple deconvolution settings were provided to limit the m/z and mass range and specify peak picking settings.\nFor the match settings, a match\ntolerance of 20 Da was chosen. Two files did not match within this tolerance and were expanded to 50 Da. A global fixed modification of -32 Da was applied to account for disulfides. Predicted masses were supplied for each of the four \u201cSequences\u201d: LC1, LC2, HC1, and HC2. The \u201cBsAb (Correct)\u201d column was specified as SeqLC1+SeqHC1+SeqLC2+SeqHC2. The \u201cLC1 Mispair (Incorrect)\u201d column was SeqLC1+SeqHC1+SeqLC1+SeqHC2, and the \u201cLC2 Mispair (Incorrect)\u201d column was SeqLC2+SeqHC1+SeqLC2+SeqHC2. Species are annotated in Figure 4A and 4B.\nAfter loading this spreadsheet\nfile into UPP, the full \u201cRun All\u201d process took 99 seconds to convert/average the data, deconvolve the results, and assign the peaks for all 115 files. Thus, a standard laptop was able to process the data set with less than a second per file. After data has been converted and averaged from raw file into a text file, data conversion can be removed for subsequent reanalysis, which shortens the deconvolution and analysis steps to 90 seconds. Removing the deconvolution process shortened the time needed for peak picking and data analysis to 60 seconds, but shortcuts in the code could shorten that further by removing optional file imports. Importantly, these results demonstrate that UPP can process data faster than it can be collected, even with the highest throughput systems.17\nFigure 4: Deconvolved data for bispecific antibody (BsAb) with high (A) and low (B) correct pairing percentages. (C) Comparison of published BsAb pairing percent (ref. 4) versus the UPP results. The dashed line shows perfect agreement. Residuals shown below indicate the difference between published and UPP.\nAs part of the workflow, UPP calculated the percentage of correctly paired bispecific\nantibody from the relative amounts of BsAb, LC1 Mispair, and LC2 Mispair.4 Example data in Figure 4A illustrates a relatively high correct pairing, with low amounts of incorrectly paired byproducts. Figure 4B illustrates an example with relatively low correct pairing with higher amounts of incorrectly paired species. The results excellently matched prior analysis,4 with a root mean squared deviation of 1.1% (Figure 4C). The maximum absolute difference was 6.7%, and only two files had absolute differences greater than 3%. Together, these data demonstrate that UPP can rapidly and accurately process native MS and intact protein ESI data from large screening studies and provide valuable quantitative outputs."
        },
        {
            "heading": "Application to DAR Calculations",
            "text": "To test the DAR calculation workflow, we applied UPP to a set of 10 data files collected on a Thermo Scientific Exactive EMR with online SEC with native MS, using a previously described LC/MS method.7 This data set contained two antibodies with duplicates of either biotin or drug conjugation. An unmodified control was included for each antibody. The mass of each antibody was supplied along with the mass of the conjugate. The minimum number of conjugates was set to 0 and the maximum was set to 15.\nAnalysis of these 10 files took around 6 seconds, less than 1 second per file. After the\ndata had been converted and deconvolved, reanalysis took only 4 seconds for the data set. A screenshot of the output is shown in Figure 3, and example deconvolutions are shown in Figure 5. An example results file and an example report are provided in the supporting information. All conjugates had DAR values around 4 that matched manual calculations. Unmodified controls both had DAR values of 0, as expected.\nInterestingly, the deglycosylation was\npartially incomplete (Figure 5A), which led to a series of unmatched peaks (shown in yellow in Figures 5A, C, and E). To correct for incomplete deglycosylation, we used the DoubleDec feature in UniDec. DoubleDec loads a template mass distribution that is used to deconvolve the output of the primary UniDec deconvolution.30 Essentially, it specifies a complex peak shape pattern (Figure 5A) and then collapses that fixed pattern into a single peak in a second round of deconvolution (Figure 5B). DoubleDec has previously been used to measure zinc and lipid binding to rhodopsin, which has a complex set of post-translational modifications (PTMs),30 and to measure tryptophan binding to TRAP, also combining a set of PTMs into a single peak.31\nTo use DoubleDec in UPP, we first\nmanually deconvolved the unmodified antibodies to obtain a kernel file (Figure 5A).\nFigure 5: UPP results for DAR calculations of an antibody with UniDec (A, C, E) and DoubleDec (B, D, E) with unmodified forms (A, B), biotin conjugates (C, D), and drug conjugates (E, F).\nThe deconvolved mass distributions from each antibody were saved separately, and the paths to those files were included in the spreadsheet as the \u201cDoubleDec Kernel File\u201d. After deconvolving with these kernel files in the automated UPP deconvolution, the second series of peaks was largely removed (Figure 5B, D, and E).\nDoubleDec systematically lowered the calculated DAR values, as seen in Figure 5. All\nconjugates had lower DARs with DoubleDec. The DARs for the 4 biotin conjugates decreased by an average of 3.5%, and DARs for the 4 drug conjugates decreased by an average of 2%. The biotin conjugate was more affected because it has a smaller mass difference (339 Da) than the drug conjugate (471 Da). Thus, the drug conjugate has more space between the peaks to accommodate the incompletely deglycosylated peaks. In contrast, the second incompletely deglycosylated peak (+331 Da) overlapped with the biotin conjugation (+339 Da), and this overlap caused slightly higher signal for larger conjugates and thus a systematically high DAR. DoubleDec corrects this subtle error and enables accurate DAR calculation.\nOverall, these results demonstrate the power of UPP for quickly calculating DAR values\nfor a set of data. Although the DoubleDec kernel file currently needs to be generated manually, it would also be possible to automate this in the future by providing an unmodified control column. Reviewing the HTML reports can help to alert the user when DoubleDec is needed, and a cutoff for the percentage of unknown peaks could be set up with custom code to automatically trigger DoubleDec. With the flexible scripting framework, teams can customize their workflow and automate these complex analyses."
        },
        {
            "heading": "Conclusions",
            "text": "Here, we described a new module to the UniDec software package, the UniDec Processing Pipeline. UPP offers several advantages for high-throughput data processing. Because it is open source, labs and companies can develop custom workflows. The example workflows shown here demonstrate its potential for biopharmaceutical applications, but the same framework could be readily applied to drug discovery15 or protein design32 by simply adjusting the spreadsheet columns. Accessible inputs and outputs make the software easy to interface with other tools. Finally, because it is free, cross platform, and containerized, it can be run in individual workstations, local servers, or cloud providers without licensing restrictions or requirements to transfer data offsite or to a 3rd party ecosystem. It can be run in either GUI or command line modes, and the results can be viewed with standard desktop tools: a web browser and a spreadsheet application.\nAlongside these advantages, several limitations remain. First, only a subset of\ndeconvolution settings can be controlled from the spreadsheet currently. However, because each parameter takes only a few extra lines of code, we will add additional settings as needed and requested. If desired, users can also control all deconvolution settings by specifying an external config file in each line of the table.\nSecond, as discussed above, UPP is fast but not perfectly efficient. Much of the\ncomputational time is spent reading and writing from the hard drive, which could be streamlined with future code developments to pass data in the memory between the Python scripts and the core UniDec binaries, ideally by developing a shared library and Python wrapper.\nFinally, for simple systems and abundant species, deconvolution with standard\nparameters is very robust. However, for complex data or low abundance species, automated\nprocessing with default parameters may not be reliable. If deconvolution settings need to be adjusted for each file, UniDec can be opened for manual deconvolution on each, but that defeats the purpose of batch processing. In any case, we recommend that users carefully validate the tool and regularly check the reports to ensure that the deconvolution results are correct.\nOverall, UPP provides a flexible template to build complex workflows on, presenting a\nstreamlined interface to batch process, deconvolve, and analyze data. We welcome users to build custom in-house pipelines, which they can either keep private or contribute back to the free and open-source code base. In future iterations, it would also be possible to link other UniDec engines for CD-MS analysis33 and more sophisticated LC/MS analysis. Pairing a flexible spreadsheet input with these deconvolution engines will significantly advance high throughput biotherapeutic analysis by mass spectrometry."
        },
        {
            "heading": "Acknowledgements",
            "text": "This work was funded by the National Science Foundation (CHE-1845230 to M.T.M.). The authors thank the community of UniDec users for valuable suggestions and motivating the work. We also thank the Antibody Engineering and BioAnalytical Sciences departments at Genentech for the bispecific antibody and antibody-drug conjugate materials, respectively.\nSupporting Information Supporting files are provided for:\n\u2022 The help file HTML\n\u2022 An individual example BsAb HTML report\n\u2022 Combined example DAR HTML reports with and with DoubleDec\n\u2022 An example input spreadsheet for BsAb\n\u2022 An example results spreadsheet for BsAb\n\u2022 An example results spreadsheet for DAR"
        }
    ],
    "title": "The UniDec Processing Pipeline for Rapid Analysis of Biotherapeutic Mass Spectrometry Data",
    "year": 2023
}