{
    "abstractText": "The unit selection problem defined by Li and Pearl identifies individuals who have desired counterfactual behavior patterns, for example, individuals who would respond positively if encouraged and would not otherwise. Li and Pearl showed by example that their unit selection model is beyond the A/B test heuristics. In this paper, we reveal the essence of the A/B test heuristics, which are exceptional cases of the benefit function defined by Li and Pearl. Furthermore, We provided more simulated use cases of Li-Pearl\u2019s unit selection model to help decision-makers apply their model correctly, explaining that A/B test heuristics are generally problematic.",
    "authors": [],
    "id": "SP:41b2443af0459ec6bbc41cf98b0d335ee0613fc0",
    "references": [
        {
            "authors": [
                "Alex Berson",
                "Stephen Smith",
                "Kurt Thearling"
            ],
            "title": "Building data mining applications for CRM",
            "venue": "McGraw-Hill Professional,",
            "year": 1999
        },
        {
            "authors": [
                "L\u00e9on Bottou",
                "Jonas Peters",
                "Joaquin Qui\u00f1onero-Candela",
                "Denis X Charles",
                "D Max Chickering",
                "Elon Portugaly",
                "Dipankar Ray",
                "Patrice Simard",
                "Ed Snelson"
            ],
            "title": "Counterfactual reasoning and learning systems: The example of computational advertising",
            "venue": "The Journal of Machine Learning Research,",
            "year": 2013
        },
        {
            "authors": [
                "Philip Dawid",
                "Monica Musio",
                "Rossella Murtas"
            ],
            "title": "The probability of causation",
            "venue": "Law, Probability and Risk,",
            "year": 2017
        },
        {
            "authors": [
                "David Galles",
                "Judea Pearl"
            ],
            "title": "An axiomatic characterization of causal counterfactuals",
            "venue": "Foundations of Science,",
            "year": 1998
        },
        {
            "authors": [
                "Joseph Y Halpern"
            ],
            "title": "Axiomatizing causal reasoning",
            "venue": "Journal of Artificial Intelligence Research,",
            "year": 2000
        },
        {
            "authors": [
                "Shin-Yuan Hung",
                "David C Yen",
                "Hsiu-Yu Wang"
            ],
            "title": "Applying data mining to telecom churn management",
            "venue": "Expert Systems with Applications,",
            "year": 2006
        },
        {
            "authors": [
                "Miguel APM Lejeune"
            ],
            "title": "Measuring the impact of data mining on churn management",
            "venue": "Internet Research,",
            "year": 2001
        },
        {
            "authors": [
                "A. Li",
                "S. Jiang",
                "Y. Sun",
                "J. Pearl"
            ],
            "title": "Learning probabilities of causation from finite population data",
            "venue": "Technical Report R-519,",
            "year": 2022
        },
        {
            "authors": [
                "A. Li",
                "S. Jiang",
                "Y. Sun",
                "J. Pearl"
            ],
            "title": "Unit selection: Learning benefit function from finite population data",
            "venue": "Technical Report R-520,",
            "year": 2022
        },
        {
            "authors": [
                "A. Li",
                "R. Mao",
                "J. Pearl"
            ],
            "title": "Probabilities of causation: Adequate size of experimental and observational samples",
            "venue": "Technical Report R-518,",
            "year": 2022
        },
        {
            "authors": [
                "A. Li",
                "J. Pearl"
            ],
            "title": "Probabilities of causation with non-binary treatment and effect",
            "venue": "Technical Report R-516,",
            "year": 2022
        },
        {
            "authors": [
                "A. Li",
                "J. Pearl"
            ],
            "title": "Unit selection with nonbinary treatment and effect",
            "venue": "Technical Report R-517,",
            "year": 2022
        },
        {
            "authors": [
                "Ang Li",
                "Suming J. Chen",
                "Jingzheng Qin",
                "Zhen Qin"
            ],
            "title": "Training machine learning models with causal logic",
            "venue": "In Companion Proceedings of the Web Conference",
            "year": 2020
        },
        {
            "authors": [
                "Ang Li",
                "Judea Pearl"
            ],
            "title": "Unit selection based on counterfactual logic",
            "venue": "In Proceedings of the Twenty-Eighth International Joint Conference on Artificial Intelligence,",
            "year": 2019
        },
        {
            "authors": [
                "Ang Li",
                "Judea Pearl"
            ],
            "title": "Bounds on causal effects and application to high dimensional data",
            "venue": "In Proceedings of the AAAI Conference on Artificial Intelligence,",
            "year": 2022
        },
        {
            "authors": [
                "Ang Li",
                "Judea Pearl"
            ],
            "title": "Unit selection with causal diagram",
            "venue": "In Proceedings of the AAAI Conference on Artificial Intelligence,",
            "year": 2022
        },
        {
            "authors": [
                "Lihong Li",
                "Shunbao Chen",
                "Jim Kleban",
                "Ankur Gupta"
            ],
            "title": "Counterfactual estimation and optimization of click metrics for search engines",
            "venue": "arXiv preprint arXiv:1403.1891,",
            "year": 2014
        },
        {
            "authors": [
                "S. Mueller",
                "A. Li",
                "J. Pearl"
            ],
            "title": "Causes of effects: Learning individual responses from population data",
            "venue": "Technical Report R-505,",
            "year": 2021
        },
        {
            "authors": [
                "Judea Pearl"
            ],
            "title": "Probabilities of causation: Three counterfactual interpretations and their identification",
            "venue": "Synthese, pages 93\u2013149,",
            "year": 1999
        },
        {
            "authors": [
                "Wei Sun",
                "Pengyuan Wang",
                "Dawei Yin",
                "Jian Yang",
                "Yi Chang"
            ],
            "title": "Causal inference via sparse additive models with application to online advertising",
            "venue": "In AAAI,",
            "year": 2015
        },
        {
            "authors": [
                "Jin Tian",
                "Judea Pearl"
            ],
            "title": "Probabilities of causation: Bounds and identification",
            "venue": "Annals of Mathematics and Artificial Intelligence,",
            "year": 2000
        },
        {
            "authors": [
                "Chih-Fong Tsai",
                "Yu-Hsin Lu"
            ],
            "title": "Customer churn prediction by hybrid neural networks",
            "venue": "Expert Systems with Applications,",
            "year": 2009
        },
        {
            "authors": [
                "Jun Yan",
                "Ning Liu",
                "Gang Wang",
                "Wen Zhang",
                "Yun Jiang",
                "Zheng Chen"
            ],
            "title": "How much can behavioral targeting help online advertising",
            "venue": "In Proceedings of the 18th international conference on World Wide Web,",
            "year": 2009
        }
    ],
    "sections": [
        {
            "text": "ar X\niv :2\n21 0.\n05 03\n0v 1\n[ cs\n.A I]\n1 0\nO ct\nThe unit selection problem defined by Li and Pearl identifies individuals who have desired counterfactual behavior patterns, for example, individuals who would respond positively if encouraged and would not otherwise. Li and Pearl showed by example that their unit selection model is beyond the A/B test heuristics. In this paper, we reveal the essence of the A/B test heuristics, which are exceptional cases of the benefit function defined by Li and Pearl. Furthermore, We provided more simulated use cases of Li-Pearl\u2019s unit selection model to help decision-makers apply their model correctly, explaining that A/B test heuristics are generally problematic."
        },
        {
            "heading": "1 Introduction",
            "text": "The unit selection problem defined by Li and Pearl is encountered in several fields, such as business, social science, health science, and economics. For example, decision-makers in customer relationship management want to identify customers who would buy purchases if there is an enticement and would not otherwise [1, 6, 7, 22]. For another example, large companies are interested in customers who would visit their website if there the website is prompted by an online advertisement and would not otherwise [2, 13, 17, 20, 23]. The challenge of identifying such customers stems from the fact that the desired behaviors are defined counterfactually and would occur under hypothetical space. For example, if a customer bought a car with a discount, we will never know whether this customer would still buy that car if there were no discounts.\nThe vastly used solution to the unit selection problem is the A/B test heuristics, where a small set of individuals is divided into two groups: a control group and a treatment group. The treatment group is served with encouragement, whereas the control group is not. Individuals with certain characteristics that maximize the difference in effective rate are then selected as desired individuals. However, the counterfactual fact of the unit selection problem is not properly handled. In contrast, Li and Pearl labeled individuals into four counterfactual response types: complier, always-taker, never-taker, and defier, and proposed an objective function (i.e., benefit function) that is the average payoff of selecting each of the response types [14]. Using experimental and observational data, Li and Pearl provided the tight bounds of the benefit function and showed that their unit selection model is the right way to select the desired individuals compared to that of the A/B test heuristics.\nIn this study, we focus on the relationship between Li-Pearl\u2019s benefit function and the A/B test heuristics, explaining why the A/B test heuristics are sometimes problematic. Afterward, more simulated case studies are provided to emphasize the conclusion, as well as illustrate how to apply Li-Pearl\u2019s unit selection model correctly.\nPreprint. Under review."
        },
        {
            "heading": "2 Preliminaries",
            "text": "Here, we review Li and Pearl\u2019s benefit function of the unit selection problem [14]. Readers who are familiar with the model may skip this section.\nSimilarly, we used the language of the structural causal model (SCM) [4, 5], where the counterfactual sentences are well-defined. The experimental and observational data herein are those in the form of causal effects and a joint probability function denoted by P (yx) and P (x, y), respectively. The basic counterfactual sentence \u201cVariable Y would have the value y, had X been x\u201d is denoted by Yx = y. For simplicity, Yx = y is shorted as yx. Besides, if not specified, the treatment is denoted by X , and the effect is denoted by Y .\nSuppose the treatment is binary (denoted by x and x\u2032), and the effect is binary (denoted by y and y\u2032). Li and Pearl classified individual behaviors into four response types: complier, always-taker, never-taker, and defier. If the payoff of selecting an individual of each response type is \u03b2, \u03b3, \u03b8, \u03b4 respectively (i.e., benefit vector), the objective function defined by Li and Pearl, which is the average payoff per selecting an individual, is as follows:\nargmaxc \u03b2P (yx, y \u2032 x \u2032 |c) + \u03b3P (yx, yx\u2032 |c) + \u03b8P (y \u2032 x , y\u2032 x \u2032 |c) + \u03b4P (y\u2032 x , yx\u2032 |c). (1)\nNote that c represents the population-specific characteristics, and the benefit function is a linear combination of the probabilities of causation [11, 15, 19, 21]. Using a combination of experimental and observational data, Li and Pearl established the tight bounds of the above benefit function as follows (which we referred to as Li-Pearl\u2019s Theorem hereafter). The only assumption is that c is not a descendant of treatment X .\nTheorem 1. Given a causal diagram G and distribution compatible with G, let C be a set of variables that does not contain any descendant of X in G, then the benefit function f(c) = \u03b2P (yx, y \u2032 x \u2032 |c) + \u03b3P (yx, yx\u2032 |c) + \u03b8P (y \u2032 x , y\u2032 x \u2032 |c) + \u03b4P (yx\u2032 , y \u2032 x |c) is bounded as follows:\nW + \u03c3U \u2264 f(c) \u2264 W + \u03c3L if \u03c3 < 0,\nW + \u03c3L \u2264 f(c) \u2264 W + \u03c3U if \u03c3 > 0,\nwhere \u03c3,W,L, U are given by,\n\u03c3 = \u03b2 \u2212 \u03b3 \u2212 \u03b8 + \u03b4,W = (\u03b3 \u2212 \u03b4)P (yx|c) + \u03b4P (yx\u2032 |c) + \u03b8P (y \u2032 x \u2032 |c),\nL = max\n\n \n  0, P (yx|c)\u2212 P (yx\u2032 |c), P (y|c)\u2212 P (yx\u2032 |c), P (yx|c)\u2212 P (y|c)\n\n \n \n, U = min\n\n   \n  \nP (yx|c), P (y\u2032\nx \u2032 |c),\nP (y, x|c) + P (y\u2032, x\u2032|c), P (yx|c)\u2212 P (yx\u2032 |c)+\n+P (y, x\u2032|c) + P (y\u2032, x|c)\n\n   \n  \n.\nThe above bounds have been narrowed by Li and Pearl [16] given additional covariate information and the causal structure [3, 18]. The nonbinary cases were discussed in ref [12].\nIn addition, Li and Pearl provided conditions such that the benefit function can have a point estimation.\nDefinition 2. (Monotonicity) A Variable Y is said to be monotonic relative to variable X in a causal model M iff\ny\u2032 x \u2227 yx\u2032 = false\nDefinition 3. (Gain Equality) The benefit of selecting a complier (\u03b2), an always-taker (\u03b3), a nevertaker(\u03b8), and a defier (\u03b4) is said to satisfy gain equality iff\n\u03b2 + \u03b4 = \u03b3 + \u03b8\nTheorem 4. Given that Y is monotonic relative to X or that (\u03b2, \u03b3, \u03b8, \u03b4) satisfies gain equality, the benefit function f(c) is given by\nf(c) = (\u03b2 \u2212 \u03b8)P (yx|c) + (\u03b3 \u2212 \u03b2)P (yx\u2032 |c) + \u03b8"
        },
        {
            "heading": "3 Essence of A/B Test Heuristic",
            "text": "A common solution that is explored in the literature is an A/B test-based approach where a controlled experiment is performed, and the result is used as a selection criterion. Specifically, individuals are randomly split into two groups called control and treatment. Individuals in the control group are served with no treatment, whereas those in the treatment group are served with the treatment. Then, the commonly used A/B test heuristics are aP (yx|c) \u2212 bP (yx\u2032 |c) (i.e., the weighted difference between the effective rates under treatment and no treatment). We then have,\naP (yx|c)\u2212 bP (yx\u2032 |c) = a(P (yx, y \u2032 x \u2032 |c) + P (yx, yx\u2032 |c))\u2212 b(P (yx\u2032 , y \u2032 x |c) + P (yx\u2032 , yx|c))\n= aP (yx, y \u2032 x \u2032 |c) + (a\u2212 b)P (yx, yx\u2032 |c)\u2212 bP (yx\u2032, y \u2032 x |c).\nThe effective rate under treatment is the percentage of the complier plus always-taker in the population, and the effective rate under no treatment is the percentage of always-taker plus defier in the population. The essence of the A/B test heuristics is a weighted difference between P (complier\u222a always_taker) and P (always_taker \u222a defier). Therefore, the A/B test heuristics are special cases of the benefit function. The benefit function has more expression power than the A/B test heuristics. This explains why the A/B test heuristics can be optimal for some cases (i.e., gain equality [14] satisfied.) and is generally problematic."
        },
        {
            "heading": "4 Case Studies",
            "text": "Recall that the benefit vector in Li-Pearl\u2019s model is not determined by the model but by the model\u2019s user. Here, we illustrate several common applications showing how to set the benefit vector. The applications are categorized based on the quality of the A/B test-based approaches."
        },
        {
            "heading": "4.1 Cases in which A/B-test Heuristics are Correct",
            "text": "Here, we present simulated examples that satisfy the gain equality so that the benefit function is reduced to an A/B test Heuristics."
        },
        {
            "heading": "4.1.1 Immediate Profit",
            "text": "Consider a car manufacturer that wants to identify customers (based on observed characteristics) who would buy a hybrid car if there is an enticement and would not otherwise so as to increase their immediate total profit.\nThe management of the car manufacturing plant acknowledged that the profit of sending the enticement to a complier (i.e., who would buy a hybrid car if there is an enticement and would not otherwise) is $45000 as the profit of selling a hybrid car is $50000, but the enticement costs $5000. The profit of sending the enticement to an always-taker (i.e., who would buy a hybrid car no matter whether or not there is an enticement) is \u2212$5000 as the always-taker would buy the car anyway so that the manufacturer loses the enticement cost. The profit of sending the enticement to a never-taker (i.e., who would not buy a hybrid car no matter whether or not there is an enticement) is $0 as the process of issuing the enticement is negligible. The profit of sending the enticement to a defier (i.e., who would buy a hybrid car if there is no enticement and would not otherwise) is \u2212$50000 as the manufacturer lost a customer due to the enticement.\nThe benefit vector above is (45000,\u22125000, 0,\u221250000), which satisfies the gain equality (45000 \u2212 50000 = \u22125000 + 0). The benefit function is then f(c) = 45000P (yx|c) \u2212 50000P (yx\u2032|c). This is the same as the popular A/B test heuristics revenue difference in the industry. From the view of the essence of A/B test heuristic, 45000P (yx|c) \u2212 50000P (yx\u2032|c) is 45000P (complier\u222aalways_taker)\u221250000P (always_taker\u222adefier) = 45000P (complier)\u2212 5000P (always_taker)\u2212 50000P (defier)."
        },
        {
            "heading": "4.1.2 Number of Increased Customers",
            "text": "Suppose the goal of the car manufacturer is to maximize the total increased customers regardless of the total profit. Therefore, for the benefit vector, 1 should be assigned to the complier because the manufacturer gains one customer due to the enticement. Furthermore, 0 should be assigned\nto both the always-taker and never-taker because the manufacturer gains no customer due to the enticement. Also, \u22121 should be assigned to the defier because the manufacturer loses one customer due to the enticement. The benefit vector is then (1, 0, 0,\u22121), which again satisfies the gain equality (1 \u2212 1 = 0 + 0). The benefit function is f(c) = P (yx|c) \u2212 P (yx\u2032 |c), which is another common A/B test heuristics. From the view of the essence of A/B test heuristic, P (yx|c) \u2212 P (yx\u2032 |c) is P (complier \u222a always_taker)\u2212 P (always_taker \u222a defier) = P (complier)\u2212 P (defier)."
        },
        {
            "heading": "4.2 Cases in which A/B-test Heuristics are Incorrect",
            "text": ""
        },
        {
            "heading": "4.2.1 Nonimmediate Profit",
            "text": "Suppose the car manufacturer wishes to maximize the total profit but includes the long-term profit (e.g., sending enticement to an always-taker may change the customer to a complier). Therefore, the management should change the benefit of selecting an always-taker to \u2212$7000 (i.e., an estimated loss of 2000 in the long term) in the example of immediate profit and keep the rest the same.\nThe benefit vector is (45000,\u22127000, 0,\u221250000). Then, the benefit function is f(c) = 45000P (yx, y \u2032 x \u2032 |c)\u22127000P (yx, yx\u2032 |c)\u221250000P (y \u2032 x , yx\u2032 |c), which no point estimation exists with pure experimental data. From the view of the essence of A/B test heuristics, no matter how to assign a, b in aP (yx|c) \u2212 bP (yx\u2032 |c) = aP (complier \u222a always_taker) \u2212 bP (always_taker \u222a defier), the results cannot equal to 45000P (complier)\u2212 7000P (always_taker)\u2212 50000P (defier)."
        },
        {
            "heading": "4.2.2 Effectiveness of Vaccine",
            "text": "A vaccine manufacturer invented a vaccine for a new virus and wants to verify the effectiveness of the vaccine. The effectiveness of a vaccine should be the difference between benefited and nonbenefited (i.e., ineffective and harmed) individuals.\nLet X = x denote the event that an individual receives the vaccine, X = x\u2032 denote the event that an individual receives no vaccine, Y = y denote the event that an individual is not infected by the virus, Y = y\u2032 denote the event that an individual is infected by the virus, and C (a set of variables) denote the population-specific characteristics of an individual.\nThe commonly used way to assess the effectiveness of the vaccine is the A/B test heuristic, P (yx|c) \u2212 P (y \u2032 x |c). However, this does not capture the counterfactual behavior. The real benefited individual should be the complier (i.e., the individual who would not be infected by the virus if vaccinated and would be infected if unvaccinated), the harmed individual should be the defier (i.e., the individual who would be infected by the virus if vaccinated and would not be infected if not vaccinated), and all other types (i.e., always-taker and never-taker) are all ineffective individuals. The benefit vector should then be (1,\u22121,\u22121,\u22121), and the benefit function is f(c) = P (yx, y \u2032 x \u2032 |c) \u2212 P (yx, yx\u2032 |c) \u2212 P (y \u2032 x , y\u2032 x \u2032 |c) \u2212 P (y\u2032 x , yx\u2032 |c). From the view of the essence of A/B test heuristics, P (yx|c) \u2212 P (y \u2032 x |c) is equal to P (complier \u222a always_taker) \u2212 P (always_taker\u222adefier) = P (complier)\u2212P (defier), which definitely cannot represent the desired objective function (i.e., P (complier)\u2212P (always_taker)\u2212P (never_taker)\u2212P (defier)).\nLet us plug some concrete numbers into the above example. Suppose two groups of individuals, c1 and c2, are waiting for the conclusion of whether the vaccine should be offered to the group. From the informer\u2019s view, two groups of individuals consist of different percentages of response types, as shown in Table 1 (note that in the real world, we never know these numbers). The random sampled experimental data of 1500 individuals of each group are given in Table 2 (one can check that the simulated experimental data are compatible with the informer data, i.e., P (yx|c) = P (complier) + P (always_taker) and P (yx\u2032 |c) = P (always_taker) + P (defier)). We also have the prior observational data that P (y|x, c1) = 0.4 and P (y|x, c2) = 0.05.\nThe above-mentioned A/B test heuristic and the benefit function were compared, where,\nf1(c) = P (yx|c)\u2212 P (yx\u2032 |c).\nf2(c) = P (yx, y \u2032 x \u2032 |c)\u2212 P (yx, yx\u2032 |c)\u2212 P (y \u2032 x , y\u2032 x \u2032 |c)\u2212 P (y\u2032 x , yx\u2032|c).\nWe plug the experimental and observational data into two objective functions, the results are summarized in Table 3 (Midpoints of Theorem 1 applied for f2). The real values come from the informer data, where real(c1) = P (yx, y \u2032 x \u2032 |c1) \u2212 P (yx, yx\u2032 |c1) \u2212 P (y \u2032 x , y\u2032 x \u2032 |c1) \u2212 P (y \u2032 x , yx\u2032 |c1) = 0.35\u2212 0.25\u2212 0.35\u2212 0.05 = \u22120.3 and real(c2) = P (yx, y \u2032 x \u2032 |c2)\u2212P (yx, yx\u2032 |c2)\u2212P (y \u2032 x , y\u2032 x \u2032 |c2)\u2212 P (y\u2032 x , yx\u2032|c2) = 0.65 \u2212 0.05 \u2212 0.05 \u2212 0.25 = 0.3. The conclusion from Theorem 1 and f2 is to offer the vaccine to group 2 only (i.e., the effectiveness is positive), which is the same as the real effectiveness from the informer\u2019s view. The conclusion from the A/B test heuristic is problematic in offering the vaccine to both groups though the real effectiveness of the first group is negative."
        },
        {
            "heading": "4.2.3 Effectiveness of Vaccine with Focus on Effected Individual",
            "text": "In the last example, the benefited individual, the harmed individual, and the ineffective individual is treated with the same importance. Suppose that we want to distinguish these individuals because we want to focus on benefited and harmed individuals; therefore, we could simply change the benefit vector to (2,\u22121,\u22121,\u22122) to indicate such a requirement.\nThe benefit function is then f(c) = 2P (yx, y \u2032 x \u2032 |c) \u2212 P (yx, yx\u2032 |c) \u2212 P (y \u2032 x , y\u2032 x \u2032 |c) \u2212 2P (y\u2032 x , yx\u2032 |c), which again has no point estimation with pure experimental data. From the view of the essence of A/B test heuristics, again, no matter how to setup a, b in aP (yx|c) \u2212 bP (yx\u2032|c) = aP (complier \u222a always_taker)\u2212 bP (always_taker\u222adefier), it can never equal to the desired objective function 2P (complier)\u2212 P (always_taker)\u2212 P (never_taker)\u2212 2P (defier)."
        },
        {
            "heading": "5 Conclusion",
            "text": "Herein, we reviewed Li-Pearl\u2019s unit selection model and its benefit function. We explained the relationships between the benefit function and the A/B test heuristics by showing that the essence of the latter one is a weighted difference between P (complier \u222a always_taker) and P (always_taker \u222a defier). Li and Pearl provided useful resources to bridge the theoretical unit selection model and the real-world applications, including the needed sample size and machine learning tools [8\u201310, 13]. We hope that the example provided here will help decision-makers to apply Li-Pearl\u2019s model correctly and push forward the revolution of A/B test heuristics style decisionmaking."
        },
        {
            "heading": "Acknowledgements",
            "text": "This research was supported in parts by grants from the National Science Foundation [#IIS2106908], Office of Naval Research [#N00014-17-S-12091 and #N00014-21-1-2351], and Toyota Research Institute of North America [#PO-000897]."
        }
    ],
    "year": 2022
}