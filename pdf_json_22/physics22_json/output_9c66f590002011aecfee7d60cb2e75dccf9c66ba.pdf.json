{
    "abstractText": "Background: The nuclear energy density functional method at finite temperature is a useful tool for studies of nuclear structure at high excitation, and also for researches of nuclear matter involved in explosive stellar phenomena and neutron stars. However, its unrestricted calculation requires large computational costs for the three-dimensional coordinate-space solvers, especially for the Hamiltonian matrix diagonalization and (or) the Gram-Schmidt orthonormalization of the single-particle wave functions. Purpose: We test numerical performance of a numerical method, that requires neither the diagonalization nor the Gram-Schmidt orthonormalization, for finite nuclei and inhomogeneous nuclear matter. We examine its advantageous features in future applications. Methods: The Fermi operator expansion method, which approximates the Fermi-Dirac distribution in terms of the Chebyshev polynomials, is used to construct the one-body density matrix for the energy density functional calculations at finite temperature. The modified Broyden\u2019s mixing method is adopted for the self-consistent iteration process. Results: The method is applied to isolated finite N = Z nuclei and to non-uniform symmetric nuclear matter at finite temperature, which turns out be very effective with the three-dimensional coordinate-space representation, especially at high temperature. The liquid-gas transition is clearly observed in the calculations. Conclusions: The Fermi operator expansion method is a useful tool for studies of various nuclear phases at finite temperature with the energy density functional calculations. The method is suitable for massively parallel computing with distributed memory. Furthermore, when the space size is large, the calculation may benefit from its order-N scaling property.",
    "authors": [
        {
            "affiliations": [],
            "name": "Takashi Nakatsukasa"
        }
    ],
    "id": "SP:e0ca031a57bb9c526415d54ad1f58690e10ca0af",
    "references": [
        {
            "authors": [
                "N. Schunck"
            ],
            "title": "ed., Energy Density Functional Methods for Atomic Nuclei",
            "venue": "(IOP Publishing,",
            "year": 2019
        },
        {
            "authors": [
                "A.L. Goodman"
            ],
            "title": "Nuclear Physics A 352",
            "venue": "30 ",
            "year": 1981
        },
        {
            "authors": [
                "J.L. Egido",
                "P. Ring"
            ],
            "title": "Journal of Physics G: Nuclear and Particle Physics 19",
            "venue": "1 ",
            "year": 1993
        },
        {
            "authors": [
                "G. Bertsch",
                "J. Mehlhaff"
            ],
            "title": "Computer Physics Communications 207",
            "venue": "518 ",
            "year": 2016
        },
        {
            "authors": [
                "W. Zhang",
                "Y.F. Niu"
            ],
            "title": "Phys",
            "venue": "Rev. C 97, 054302 ",
            "year": 2018
        },
        {
            "authors": [
                "W.G. Newton",
                "J.R. Stone"
            ],
            "title": "Phys",
            "venue": "Rev. C 79, 055801 ",
            "year": 2009
        },
        {
            "authors": [
                "P. Bonche",
                "S. Levit",
                "D. Vautherin"
            ],
            "title": "Nuclear Physics A 427",
            "venue": "278 ",
            "year": 1984
        },
        {
            "authors": [
                "P. Bonche",
                "S. Levit",
                "D. Vautherin"
            ],
            "title": "Nuclear Physics A 436",
            "venue": "265 ",
            "year": 1985
        },
        {
            "authors": [
                "M. Brack"
            ],
            "title": "C",
            "venue": "Guet, and H.-B. H\u030aakansson, Physics Reports 123, 275 ",
            "year": 1985
        },
        {
            "authors": [
                "M. Onsi",
                "H. Przysiezniak",
                "J.M. Pearson"
            ],
            "title": "Phys",
            "venue": "Rev. C 55, 3139 ",
            "year": 1997
        },
        {
            "authors": [
                "M. Okamoto",
                "T. Maruyama",
                "K. Yabana",
                "T. Tatsumi"
            ],
            "title": "Phys",
            "venue": "Rev. C 88, 025801 ",
            "year": 2013
        },
        {
            "authors": [
                "C.-J. Xia",
                "T. Maruyama",
                "N. Yasutake",
                "T. Tatsumi"
            ],
            "title": "Phys",
            "venue": "Rev. D 106, 063020 ",
            "year": 2022
        },
        {
            "authors": [
                "G. Watanabe",
                "K. Sato",
                "K. Yasuoka",
                "T. Ebisuzaki"
            ],
            "title": "Phys",
            "venue": "Rev. C 69, 055805 ",
            "year": 2004
        },
        {
            "authors": [
                "C.J. Horowitz",
                "D.K. Berry",
                "C.M. Briggs",
                "M.E. Caplan",
                "A. Cumming",
                "A.S. Schneider"
            ],
            "title": "Phys",
            "venue": "Rev. Lett. 114, 031102 ",
            "year": 2015
        },
        {
            "authors": [
                "M.E. Caplan",
                "C.J. Horowitz"
            ],
            "title": "Rev",
            "venue": "Mod. Phys. 89, 041002 ",
            "year": 2017
        },
        {
            "authors": [
                "A. Bulgac",
                "P. Magierski"
            ],
            "title": "Nuclear Physics A 683",
            "venue": "695 ",
            "year": 2001
        },
        {
            "authors": [
                "N. Chamel"
            ],
            "title": "Nuclear Physics A 747",
            "venue": "109 ",
            "year": 2005
        },
        {
            "authors": [
                "J. Negele",
                "D. Vautherin"
            ],
            "title": "Nuclear Physics A 207",
            "venue": "298 ",
            "year": 1973
        },
        {
            "authors": [
                "M. Baldo",
                "E. Saperstein",
                "S. Tolokonnikov"
            ],
            "title": "Nuclear Physics A 775",
            "venue": "235 ",
            "year": 2006
        },
        {
            "authors": [
                "H. Shen",
                "H. Toki",
                "K. Oyamatsu",
                "K. Sumiyoshi"
            ],
            "title": "Nuclear Physics A 637",
            "venue": "435 ",
            "year": 1998
        },
        {
            "authors": [
                "H. Togashi",
                "K. Nakazato",
                "Y. Takehara",
                "S. Yamamuro",
                "H. Suzuki",
                "M. Takano"
            ],
            "title": "Nuclear Physics A 961",
            "venue": "78 ",
            "year": 2017
        },
        {
            "authors": [
                "N. Chamel",
                "P. Haensel"
            ],
            "title": "Living Rev",
            "venue": "Relativity 11, 10 ",
            "year": 2008
        },
        {
            "authors": [
                "S. Jin",
                "A. Bulgac",
                "K. Roche"
            ],
            "title": "and G",
            "venue": "Wlaz lowski, Phys. Rev. C 95, 044302 ",
            "year": 2017
        },
        {
            "authors": [
                "Y. Kashiwaba",
                "T. Nakatsukasa"
            ],
            "title": "Phys",
            "venue": "Rev. C 101, 045804 ",
            "year": 2020
        },
        {
            "authors": [
                "S. Goedecker",
                "L. Colombo"
            ],
            "title": "Phys",
            "venue": "Rev. Lett. 73, 122 ",
            "year": 1994
        },
        {
            "authors": [
                "S. Goedecker",
                "M. Teter"
            ],
            "title": "Phys",
            "venue": "Rev. B 51, 9455 ",
            "year": 1995
        },
        {
            "authors": [
                "S. Wu",
                "C. Jayanthi"
            ],
            "title": "Physics Reports 358",
            "venue": "1 ",
            "year": 2002
        },
        {
            "authors": [
                "W. Kohn"
            ],
            "title": "International Journal of Quantum Chemistry 56",
            "venue": "229 ",
            "year": 1995
        },
        {
            "authors": [
                "R. Baer",
                "M. Head-Gordon"
            ],
            "title": "Phys",
            "venue": "Rev. Lett. 79, 3962 ",
            "year": 1997
        },
        {
            "authors": [
                "P. Bonche",
                "S. Koonin",
                "J.W. Negele"
            ],
            "title": "Phys",
            "venue": "Rev. C 13, 1226 ",
            "year": 1976
        },
        {
            "authors": [
                "T. Nakatsukasa",
                "K. Yabana"
            ],
            "title": "Phys",
            "venue": "Rev. C 71, 024301 ",
            "year": 2005
        },
        {
            "authors": [
                "J. Maruhn",
                "P.-G. Reinhard",
                "P. Stevenson",
                "A. Umar"
            ],
            "title": "Computer Physics Communications 185",
            "venue": "2195 ",
            "year": 2014
        },
        {
            "authors": [
                "J. Eastwood",
                "D. Brownrigg"
            ],
            "title": "Journal of Computational Physics 32",
            "venue": "24 ",
            "year": 1979
        },
        {
            "authors": [
                "D.D. Johnson"
            ],
            "title": "Phys",
            "venue": "Rev. B 38, 12807 ",
            "year": 1988
        },
        {
            "authors": [
                "A. Baran",
                "A. Bulgac",
                "M.M. Forbes",
                "G. Hagen",
                "W. Nazarewicz",
                "N. Schunck",
                "M.V. Stoitsov"
            ],
            "title": "Phys",
            "venue": "Rev. C 78, 014318 ",
            "year": 2008
        },
        {
            "authors": [
                "S. Goedecker"
            ],
            "title": "Phys",
            "venue": "Rev. B 58, 3501 ",
            "year": 1998
        }
    ],
    "sections": [
        {
            "text": "Fermi operator expansion method for nuclei and inhomogeneous matter with nuclear energy density functional\nTakashi Nakatsukasa1, 2, 3\n1Center for Computational Sciences, University of Tsukuba, Tsukuba 305-8577, Japan 2Faculty of Pure and Applied Sciences, University of Tsukuba, Tsukuba 305-8571, Japan\n3RIKEN Nishina Center, Wako 351-0198, Japan (Dated: November 18, 2022)\nBackground: The nuclear energy density functional method at finite temperature is a useful tool for studies of nuclear structure at high excitation, and also for researches of nuclear matter involved in explosive stellar phenomena and neutron stars. However, its unrestricted calculation requires large computational costs for the three-dimensional coordinate-space solvers, especially for the Hamiltonian matrix diagonalization and (or) the Gram-Schmidt orthonormalization of the single-particle wave functions. Purpose: We test numerical performance of a numerical method, that requires neither the diagonalization nor the Gram-Schmidt orthonormalization, for finite nuclei and inhomogeneous nuclear matter. We examine its advantageous features in future applications. Methods: The Fermi operator expansion method, which approximates the Fermi-Dirac distribution in terms of the Chebyshev polynomials, is used to construct the one-body density matrix for the energy density functional calculations at finite temperature. The modified Broyden\u2019s mixing method is adopted for the self-consistent iteration process. Results: The method is applied to isolated finite N = Z nuclei and to non-uniform symmetric nuclear matter at finite temperature, which turns out be very effective with the three-dimensional coordinate-space representation, especially at high temperature. The liquid-gas transition is clearly observed in the calculations. Conclusions: The Fermi operator expansion method is a useful tool for studies of various nuclear phases at finite temperature with the energy density functional calculations. The method is suitable for massively parallel computing with distributed memory. Furthermore, when the space size is large, the calculation may benefit from its order-N scaling property.\nI. INTRODUCTION\nIt is of significant importance to calculate nuclear matter in a variety of phases with different temperature, utilized in simulation studies of supernovae and neutron stars. The nuclear energy density functional method at finite temperature [1, 2] is a desirable choice for studying the inhomogeneous neutron-star matter in outer and inner crusts. Especially, near the boundary between the inner crust and the core, various exotic phases, \u201cnuclear pasta\u201d, are expected to appear.\nIn order to properly treat thermally dripped nucleons and to study the transition from inhomogeneous to uniform nuclear matter, the coordinate-space representation is preferable. Furthermore, to find a new exotic structure at finite temperature, it is desired to perform the calculation without assuming any spatial symmetry of the configuration, using the three-dimensional (3D) coordinate-space representation. Since the 3D coordinate-space solution is computationally demanding, most of the finite-temperature mean-field calculations for nuclei either adopt the harmonic-oscillator-basis (shellmodel-basis) representation [3\u20136], or are restricted to the spherical systems1 [8, 9].\n1 An exception can be found in a paper by Newton and Stone [7] in\nTo reduce the computational cost, the finitetemperature Thomas-Fermi approximation has been often adopted [10\u201313]. The molecular dynamics simulations can be performed with even smaller computational time, thus, they have been extensively utilized with larger simulation volumes [14\u201316]. A major drawback of these semiclassical approximation is a lack of shell effects. In the inner crust, the shell effects play a role not only in protons but also in the band effect for unbound neutrons scattered by the periodic potentials [17, 18]. An alternative quantum approach to the inner crust is to use the Wigner-Seitz approximation, pioneered by Negele and Vautherin [19]. The structure is optimized in a WignerSeitz sphere of radius Rws. using different boundary conditions depending on the parity of the single-particle orbitals. For the inner crust, this trick for the boundary condition produces a roughly constant neutron density at the spherical boundary r = Rws. However, some spurious density fluctuations still remain near the edge of the boundary. Furthermore, the numerical results suffer from ambiguity caused by the choice of the boundary conditions [20]. It should be noted that a combination of the Thomas-Fermi and Wigner-Seitz approximations is\nwhich they solve the finite-temperature Hartree-Fock equations with the BCS treatment on the pairing correlation in the 3D coordinate space. To reduce the computational time, the states with the occupation smaller than 10\u22126 are neglected.\nar X\niv :2\n21 1.\n09 44\n8v 1\n[ nu\ncl -t\nh] 1\n7 N\nov 2\n02 2\n2 frequently used for non-uniform matter at finite temperature based on the microscopic results for the uniform matter [13, 21, 22]. Another disadvantage of these approximations is that one loses information on the transport properties which may be crucial for understanding dynamics of neutrons in the inner crust of neutron stars [23].\nIn this paper, we perform a feasibility study for the fully quantum energy density functional (mean-field) calculations without the Wigner-Seitz approximation for non-uniform nuclear matter at finite temperature. A conventional solution of the finite-temperature mean-field theory can be summarized as follows: (1) Construct the mean-field Hamiltonian H which depends on one-body densities. (2) Diagonalize the Hamiltonian to obtain the eigenvalues and the eigenvectors, H|i\u3009 = i|i\u3009. (3) Calculate the densities, then, go back to (1) to reach the self-consistency. In the step (3), the Fermi-Dirac distribution function f(x) is used to calculate the densities, \u03c1 = \u2211 i f( i)|i\u3009\u3008i|. The truncation with respect to the eigenvector |i\u3009may be possible at low temperature, while, at high temperature, we need to compute all the eigenvalues and eigenvectors. Since this diagonalization is needed every iteration, it requires a large amount of numerical resources.\nRecently, the shifted Krylov method for the HartreeFock-Bogoliubov (HFB) theory has been proposed [24]. Then, it was extended to the finite-temperature HFB theory [25]. The method uses the shifted Krylov subspace method for solution of linear algebraic equation, (z \u2212H)G(z) = 0, where H is the HFB Hamiltonian and G(z) is the Green\u2019s function. The densities are obtained from the Green\u2019s function G(z) integrated over complex energy z. Thus, the diagonalization procedure is unnecessary. This feature is favorable for large systems since the matrix diagonalization needs the operation of O(N3) where N is the dimension of the matrix. It is shown to be numerically feasible and efficient in the parallel computation [24, 25]. However, its performance depends on the required number of iterations of the shifted Krylov algorithm whose convergence is not guaranteed.\nPurposes of the present paper are to study an alternative method for the finite-temperature mean-field calculation, and to examine its performance for nuclear systems. The methodology is known as the Fermi operator expansion (FOE) method in the condensed matter physics [26, 27]. It is also known as one of the order-N (O(N)) method [28], thus, the number of computational operations linearly scales with respect to either the particle number or the dimension of the one-particle space. In the O(N) methods, the \u201cnearsightedness\u201d of many electron systems play a crucial role [29]. Since the nearsightedness is due to destructive interference effect in quantum mechanical many-particle systems, we expect that it is applicable to nuclear systems as well. However, since the size of a nucleus is roughly ten femtometer at most, the nearsightedness principle has been assumed not so beneficial in practice. The situation may be different for hot\nnuclei and macroscopic neutron-star matters. It is worth examining the O(N) methods for calculations of nuclei at finite temperature and inhomogeneous nuclear matter.\nThe paper is organized as follows: The finitetemperature mean-field theory is recapitulated in Sec. II A. In Secs. II B and II C, the Fermi operator expansion method is summarized. In Sec. II D, we propose an efficient method of computing the entropy without calculating single-particle energies. The nearsightedness and the O(N) method are briefly reviewed in Sec. II E. Details of the numerical calculations, examination of the validity of the Chebyshev polynomial expansion, and numerical results for finite nuclei and non-uniform matter are shown in Sec. III. Concluding remarks are given in Sec. IV."
        },
        {
            "heading": "II. THEORY AND NUMERICAL METHODS",
            "text": ""
        },
        {
            "heading": "A. Mean-field theory at finite temperature",
            "text": "We recapitulate here the Hartree-Fock (HF) theory at finite temperature [1]. The partition function and the statistical density matrix at the temperature \u03b2\u22121 = kBT\nare in the form, Z = tr [ e\u2212\u03b2H\u0302 \u2032 ] , and D\u0302 = e\u2212\u03b2H\u0302 \u2032 /Z,\nrespectively, where H\u0302 \u2032 \u2261 H\u0302 \u2212\u00b5N\u0302 with the one-body HF Hamiltonian H\u0302, the particle number operator N\u0302 , and the chemical potential \u00b5. The one-body density matrix is given as\n\u03c1ij = tr [ D\u0302c\u0302\u2020j c\u0302i ] = \u2211 \u03b1 \u3008i|\u03b1\u3009f\u03b2\u00b5( \u03b1)\u3008\u03b1|j\u3009 (1)\nwhere f\u03b2\u00b5 is the Fermi-Dirac function f\u03b2\u00b5(x) = {1 + e\u03b2(x\u2212\u00b5)}\u22121. Here, the subscripts i and j denote the indices for an arbitrary single-particle basis, while \u03b1 for the single-particle states to diagonalize H (and H \u2032), H\u0302|\u03b1\u3009 = \u03b1|\u03b1\u3009. c\u0302i (c\u0302\u2020i ) is an annihilation (creation) operator for a particle at the state |i\u3009. Since the HF Hamiltonian H\u0302[\u03c1] is a functional of the one-body density, the states |\u03b1\u3009 and energies \u03b1 depend on \u03c1ij . Thus, Eq. (1) should be iteratively calculated until the self-consistency is achieved. It is straightforward to extend the theory to the HFB theory at finite temperature [1, 25].\nIt should be worth mentioning that the finitetemperature HF theory can be derived by the principle of maximum entropy, with an assumption that the partition function is given in a form, Z = tr[e\u2212\u03b2K\u0302 ] with\na one-body operator K\u0302. Constraining the energy and the particle number with Lagrange multipliers (associated with \u03b2 and \u00b5), it is equivalent to the minimization of the thermodynamic potential [1].\nJ = E \u2212 TS \u2212 \u00b5N (2) = E[\u03c1] + kBT tr [ D\u0302 ln D\u0302 ] \u2212 \u00b5tr [ D\u0302N\u0302 ] (3)\n= E\u2032[\u03c1]\u2212 tr [ D\u0302K\u0302 ] \u2212 kBT lnZ, (4)\n3 where E[\u03c1] is the energy density functional and E\u2032 \u2261 E \u2212 \u00b5N . Taking the variation with respect to the onebody operator \u03b4K\u0302, it leads to\n\u03b4J = \u03b4E\u2032\n\u03b4\u03c1 \u00b7 \u03b4\u03c1\u2212 tr\n[ D\u0302\u03b4K\u0302 ] \u2212 tr [ K\u0302\u03b4D\u0302 ] \u2212 \u03b4 lnZ\n\u03b2 (5) = tr [ H\u0302 \u2032\u03b4D\u0302 ] \u2212 tr [ K\u0302\u03b4D\u0302 ] , (6)\nwhere H\u0302 \u2032 \u2261 \u2211 ij H \u2032 ij c\u0302 \u2020 i c\u0302j with H \u2032 ij = \u03b4E \u2032/\u03b4\u03c1ji. Therefore, the principle of maximum entropy gives K\u0302 = H\u0302 \u2032."
        },
        {
            "heading": "B. Fermi operator expansion method",
            "text": "According to Eq. (1), the one-body density can be calculated by diagonalizing H \u2032 to obtain the eigenstates and the eigenenergies, |\u03b1\u3009 and \u03b1. However, since we need to perform the diagonalization every iteration until the self-consistency is achieved, it is prohibitively difficult for large systems. In order to reduce the computational cost, we must avoid the matrix diagonalization which numerically costs O(N3). In this paper, we explore one of such approaches, the Fermi operator expansion (FOE) method.\nThe idea of the FOE method can be easily understood by rewriting Eq. (1) as \u03c1ij = \u3008i|\u03c1\u0302|j\u3009, where\n\u03c1\u0302 = \u2211 \u03b1 |\u03b1\u3009f\u03b2\u00b5( \u03b1)\u3008\u03b1| = f\u03b2\u00b5(H\u0302). (7)\nThus, the one-body density is nothing but the FermiDirac function whose argument is replaced by the Hamiltonian. In addition, the FOE is based on the polynomial approximation of the Fermi-Dirac distribution function.\nf\u03b2\u00b5(x) \u2248 M\u2211 n=0 anTn(x), (8)\nwhere Tn(x) is a polynomial function of the n-th degree, and the summation is truncated at the maximum degree M . The polynomial approximation should be better at large T , because the Fermi-Dirac function is smoother at higher temperature. In contrast, at the zero temperature limit, the function becomes the Heaviside step function for which the approximation is not so precise. Nevertheless, in case that there is a gap \u2206E at the Fermi surface, such as the shell gap and the pairing gap, the results of the finite temperature calculation with kBT \u2206E is practically identical to the one at zero temperature.\nInserting Eqs. (7) and (8) into \u03c1ij = \u3008i|\u03c1\u0302|j\u3009, we have\n\u03c1ij = \u3008i|f\u03b2\u00b5(H\u0302)|j\u3009 = M\u2211 n=0 an\u3008i|jn\u3009, (9)\nwhere |jn\u3009 \u2261 Tn(H\u0302)|j\u3009. If the polynomial function Tn(x) is simply given by Tn(x) = x\nn, the state |jn\u3009 can be calculated starting from |j0\u3009 \u2261 |j\u3009 as\n|jn\u3009 = H\u0302|jn\u22121\u3009, n = 0, \u00b7 \u00b7 \u00b7 ,M. (10)\nThus, multiplying the basis state |j\u3009 by H\u0302 M times, the one-body density \u03c1ij can be constructed. This is the basic idea of the FOE method.\nIn practice, the simple choice of Tn(x) = x n often leads to a numerical instability, because the functions xn are diverging function at |x| > 1 for large n. In order to avoid this numerical problem, a careful choice of the polynomial functions is required for Tn(x)."
        },
        {
            "heading": "C. Chebyshev polynomials",
            "text": "In the present work, we adopt the Chebyshev polynomials for Tn(x). The Chebyshev polynomials of the first kind are given by Tn(x) = cosnt with x = cos t, thus, both x and Tn(x) are bound between \u22121 and 1. They are orthogonal with respect to the weight of 1/\n\u221a 1\u2212 x2.\u222b 1\n\u22121 Tn(x)Tm(x) dx\u221a 1\u2212 x2 = Nn\u03b4nm, (11)\nwith the normalization constants N0 = \u03c0 and Nn = \u03c0/2 (n 6= 0).\nFirst, we should change the energy scale by transforming H\u0302 into H\u0302 \u2261 H\u0302\u2212ecer where ec \u2261 (emax + emin)/2 and er \u2261 (emax \u2212 emin)/2. When the eigenvalues of H\u0302 satisfy emin \u2264 e\u03b1 \u2264 emax in the adopted model space, those of H\u0302 are in the interval [\u22121, 1]. Instead of expanding f\u03b2\u00b5(x) as Eq. (8), we expand a scaled Fermi-Dirac function f\u0303(x) as\nf\u0303(x) \u2261 f\u03b2\u00b5(erx+ ec) \u2248 a0 2 + M\u2211 n=1 anTn(x), (12)\nwhere the coefficients an are given by\nan = 2\n\u03c0 \u222b 1 \u22121 Tn(x)f\u0303(x) dx\u221a 1\u2212 x2 . (13)\nIt is worth noting that f\u0303(x) and an depend on both \u03b2 and \u00b5, for which we omit these subscripts for simplicity.\nInstead of Eq. (10), the recursive relations of the Chebyshev polynomials,\nTn+1(x) = 2xTn(x)\u2212 Tn\u22121(x), n \u2265 1, (14)\nlead to recursive formula for |jn\u3009 \u2261 Tn(H\u0302)|j\u3009,\n|jn+1\u3009 = 2H\u0302|jn\u3009 \u2212 |jn\u22121\u3009, n = 1, \u00b7 \u00b7 \u00b7 ,M \u2212 1. (15)\nStarting with |j0\u3009 = |j\u3009 and |j1\u3009 = H\u0302|j\u3009, all the states |jn\u3009 up to n = M are obtained, then, the one-body density is calculated as\n\u03c1ij = \u3008i|f\u0303(H\u0302)|j\u3009 = a0 2 \u3008i|j\u3009+ M\u2211 n=1 an\u3008i|jn\u3009. (16)\nLet us summarize the numerical procedure to reach the self-consistent solution of the HF problem at a given temperature T .\n4 0. The maximum and minimum energies, emax and emin, are determined according to a problem of interest. See Sec. III A for those values. The initial density distribution \u03c1(r) and the initial chemical potential \u00b5 are given by hand. For a given T , calculate the coefficients an (n = 0, \u00b7 \u00b7 \u00b7 ,M) according to Eq. (13). Set up the initial Hamiltonian H\u0302.\n1. Calculate |jn\u3009 (n = 0, \u00b7 \u00b7 \u00b7 ,M) according to Eq. (15).\n2. Construct the one-body density according to Eq. (16). Adjust the chemical potential \u00b5 if necessary.\n3. Construct the HF Hamiltonian H\u0302[\u03c1] using the calculated density \u03c1ij .\n4. Check the self-consistency between the density and the Hamiltonian. If it is self-consistent, end the iteration. Otherwise, go to Step 1 and iterate the procedure.\nIn the present formulation, the function f\u03b2\u00b5(x) depends on T and \u00b5. Thus, when we change the chemical potential \u00b5, we have to recalculate the coefficients an in Eq. (12). You may think that it is better to expand the function (1 + e\u03b2x)\u22121 instead of {1 + e\u03b2(x\u2212\u00b5)}\u22121 and to use H\u0302 \u2212 \u00b5 instead of H\u0302. However, in this case, we need reevaluate the states |jn\u3009 using the recursion relation (15), because |jn\u3009 depend on T and \u00b5. Since the calculation of |jn\u3009 requires the major portion of the computation, we adopt the expansion of f\u03b2\u00b5(x). If we adjust the chemical potential in step 2 of every iteration to fix the particle number (average density), only the coefficients an in Eq. (13) need to be recalculated. The additional computation is negligibly small compared to the calculation of |jn\u3009."
        },
        {
            "heading": "D. Calculation of entropy",
            "text": "It is of significant importance to calculate the entropy of systems at finite temperature. The calculation of the free energy requires the evaluation of the entropy as well. For the product wave functions, the entropy S is given by\nS = \u2212kB \u2211 \u03b1 [f\u03b1 ln f\u03b1 + (1\u2212 f\u03b1) ln (1\u2212 f\u03b1)] , (17)\nwhere f\u03b1 = f\u03b2\u00b5( \u03b1). In order to calculate this, normally we need all the eigenvalues of the Hamiltonian , \u03b1, which requires an additional computation, namely the diagonalization of the Hamiltonian. It demands a large computational cost of O(N3).\nIn this paper, we propose another manner to approximate a function\ng\u0303(x) \u2261 \u2212f\u0303(x) ln f\u0303(x)\u2212 { 1\u2212 f\u0303(x) } ln { 1\u2212 f\u0303(x) } , (18)\nwith the polynomial expansion as\ng\u0303(x) \u2248 b0 2 + M \u2032\u2211 n=1 bnTn(x), (19)\nanalogous to Eq. (12). The coefficients bn are determined in the same manner as Eq. (13). Then, the entropy can be calculated as\nS = kBtr [ g\u0303(H\u0302) ] (20)\n\u2248 \u2211 j b0 2 + M \u2032\u2211 n=1 bn\u3008j|jn\u3009  . (21) Since the states |jn\u3009 = Tn(H\u0302)|j\u3009 are calculated in Eq. (15) in order to construct the density, almost no extra cost is needed for evaluation of the entropy provided that M \u2032 \u2264M . In fact, we find that the condition M \u2032 \u2264M is well satisfied in practice (See Sec. III B). At small temperature, g\u0303(x) has a sharp peak at x = (\u00b5 \u2212 ec)/er, which demands large value of M \u2032. However, in this case, M must be also large, because f\u0303(x) also produces a sharp\ntransition from 1 to 0. At T = 0, f\u0303(x) becomes a discon-\ntinuous Heaviside function, f\u0303(x) = \u03b8(x), while g\u0303(x) is a constant function, g\u0303(x) = 0.\nIn the FOE method, we end up the vectors, |jn\u3009, which contains the information of the Chebyshev polynomials of the Hamiltonian, |jn\u3009 = Tn(H\u0302)|j\u3009. Therefore, quantities that are continuous functions of the single-particle energies, including the density and the entropy, can be evaluated in principle from |jn\u3009. The number of the vectors |jn\u3009 is N \u00d7 M , where N is the dimension of the single-particle space (system size). Since M is inversely proportional to the temperature T as Eq. (22) below, the FOE is more efficient at higher temperature.\nE. Nearsightedness and order-N method\nThe FOE method is regarded as one of the linear system-size scaling method, namely, the order-N (O(N)) method. According to Ref. [30], the degrees of polynomials necessary for an accuracy of 10\u2212D (D > 1) is estimated as\nM = 2\n3 (D \u2212 1)er\u03b2. (22)\nAssuming a gaussian basis functions of range \u03c3 centered at mesh points whose spacing comparable to \u03c3, the matrix elements for H\u0302 at a large separation have the same width \u03c3, and the long-range matrix elements for H\u0302M are estimated as \u221a M\u03c3 [30]. Therefore, the range of the density matrix of Eq. (16) is approximately given as\nrN \u223c \u221a M\u03c3 \u223c \u221a ~2 3m (D \u2212 1)\u03b2, (23)\n5 where we use Eq. (22) and er \u223c emax \u223c ~2\u03c3\u22122/(2m) at a small value of \u03c3. In other words, the density matrices \u03c1(r, r\u2032) are localized, namely, \u03c1(r, r\u2032) \u2248 0 at |r \u2212 r\u2032| > rN . It becomes more \u201cnearsighted\u201d (rN \u2192 0) for higher temperature \u03b2 \u2192 0.\nAt the zero temperature limit, rN can stay finite if there is a gap \u03b4e at the Fermi surface, although Eq. (23) diverges. Taking the chemical potential \u00b5 as the mid value of the gap, the condition that discrepancies between the Heaviside function and the Fermi-Dirac function are smaller than 10\u2212D except for the gap interval leads to\n\u03b2 > (2 ln 10) D\n\u03b4e . (24)\nFor instance, when we have a shell gap of \u03b4e = 2 MeV at the Fermi surface and require the accuracy of D = 3 (error smaller than 10\u22123), the calculation at T = 100 keV is practically identical to that at T = 0.\nThe nearsightedness of the density enables us to perform the O(N) calculation. The calculation of |jn\u3009 (n = 1, \u00b7 \u00b7 \u00b7 ,M) in Eq. (15) can be performed in a truncated space whose dimension does not depend on the system size. Since the nonlocal (off-diagonal) densities \u03c1ij with Rij > rN vanish, the matrix-vector product in Eq. (15) can be performed in the restricted active subspace. Here, Rij mean that spatial distance between two basis states |i\u3009 and |j\u3009. For the coordinate-space basis, they are trivially Rij = |ri \u2212 rj |. For the singlecenter harmonic-oscillator basis, which are common and efficient in calculation of finite nuclei, it is difficult to find a pair of states with Rij > rN . Thus, the applicability of the O(N) method also relies on the choice of the basis.\nBefore finishing this section, we emphasize the following advantageous features of the method in numerical computation. First of all, in order to construct the onebody density \u03c1ij , only the matrix-vector product, operation of the Hamiltonian on a state, is necessary in Eq. (15). Although the self-consistency between the density \u03c1 and the Hamiltonian H[\u03c1] requires the iteration, neither the matrix diagonalization nor the linear algebraic equations are involved to achieve the mean-field solution at the temperature T . Second, the calculations of \u03c1ij in Eqs. (15) and (16) for different j can be independently performed. It is suitable for massively parallel computing for large systems. Last, but not the least, the method may receive benefits from its nearsightedness, and the computational cost could linearly scale with the system size (Sec III E)."
        },
        {
            "heading": "III. NUMERICAL RESULTS",
            "text": ""
        },
        {
            "heading": "A. Energy density functional and numerical details",
            "text": "We use the BKN energy density functional [31], which is a functional of the isoscalar kinetic and local densities and assumes the spin-isospin symmetry without the spinorbit interaction. The pairing correlation is neglected.\nSince the BKN functional is not suitable for description of the neutron-rich matter, we study only the symmetric nuclear matter and finite nuclei with N = Z. Nevertheless, it serves for the purposes of the present paper, namely, to examine applicability and performance of the FOE method for the mean-field (energy-density) calculation for nuclei and nuclear matter at finite temperature.\nWe adopt the 3D Cartesian grid representation [32] of the square box with periodic boundary condition. The 3D grid size is set to be h3 = (1.0 fm)3. The differentiation is evaluated with the nine-point finite difference. For calculation of isolated finite nuclei, the center-of-mass correction is taken into account by modifying the nucleon\u2019s mass as m\u2192 m\u2217A/(A\u22121). For the non-uniform nuclear matter calculation (A \u2192 \u221e), we use the bare nucleon\u2019s mass. The fast Fourier transform is utilized for calculation of the Coulomb potential, which is well suitable for periodic systems. For the calculation of the isolated finite nucleus, we use the method same as Ref. [33] following the idea given in Ref. [34].\nIn order to make the Chebyshev polynomial expansion, we need to set the maximum and the minimum singleparticle energies. The minimum energy is taken as emin = \u221250 MeV, which is safe enough in the cases of N = Z nuclei and the symmetric nuclear matter. The maximum energy is set as\nemax = 3\u00d7 ~2\n2m (\u03c0 h )2 , (25)\naccording to the maximum kinetic energy for the 3D grid of h3.\nFor the self-consistent iteration of the finitetemperature HF calculation, we use the modified Broyden\u2019s method [35, 36]. We use the HF potential v(r) as the Broyden\u2019s vector to update [36].\nB. Validity check for the polynomial expansion\nLet us first examine the accuracy of the expansion with the Chebyshev polynomials. According to Eq. (22), the maximum degrees of the polynomials M are adopted as M = 1.5 \u00d7 er\u03b2, which corresponds to the accuracy of 10\u22125.5. In Fig. 1, we show the approximated Fermi-Dirac distribution function f\u03b2\u00b5( ) with the chemical potential \u00b5 = \u221210 MeV (panel (a)), and the deviation from the exact values (panel (b)),\ndf( ) = a0 2 + M\u2211 n=1 anTn ( \u2212 ec er ) \u2212 f\u03b2\u00b5( ). (26)\nWe assume that the maximum and minimum singleparticle energies are max = 500 MeV and min = \u2212100 MeV, respectively, which leads to M = 900\u03b2 (\u03b2 in units of MeV\u22121). The largest deviation appears around = \u00b5 and its value is order of 10\u22126, which is consistent with the estimation of Eq. (22). We can clearly see the importance of the temperature-dependent maximum degrees M .\n6 0 0.2 0.4 0.6 0.8 1\n-40 -20 0 20 40\n(a) Fermi-Dirac function f \u03b2\u00b5 (\u03b5 ) T=10 MeV T= 1 MeV T=0.1 MeV\n-3x10-6 -2x10-6 -1x10-6\n0\n1x10-6 2x10-6 3x10-6\n-40 -20 0 20 40\n(b) Error\ndf (\u03b5 )\n\u03b5 [ MeV ]\nwhich is used for calculation of the entropy, Eq. (17), and show the result in Fig. 2. The maximum degrees M \u2032 is taken as M \u2032 = M = 900\u03b2. The Chebyshev expansion for g( ) is well approximated with the deviation is smaller than 10\u22125 for any temperature. They are well controlled as far as the maximum degrees M are adjusted in proportion to \u03b2.\nIf we increase M at the fixed temperature, the accuracy is significantly improved as shown in Fig. 3. We find an agreement with Eq. (22); M = 100 (M = 120) corresponds to D = 6 (D = 7) in Eq. (22).\nIn order to check the accuracy in the final results, we perform the FOE calculation using M = k \u00d7 er\u03b2 with different values of k. We use the Woods-Saxon potential, Vws(r) = Vws/(1 + exp(r \u2212 Rws)/aws), with Vws = \u221250 MeV, Rws = 3 fm, and aws = 0.5 fm. The adopted space size is (13 fm)3 and the chemical potential is fixed at \u00b5 = \u221215 MeV. The calculated quantities with T = 1 MeV and 10 MeV are shown in Table I. The nucleon number is calculated as the integration of density over the adopted space. The \u201cWoods-Saxon energy\u201d is defined as Ews = (1/2) \u222b Vws(r)\u03c1(r)dr. The difference between k = 1.5 and k = 2.0 is negligible, less than 100 eV in energy. In this paper, we use the temperature-dependent maximum\n0\n0.2\n0.4\n0.6\n0.8\n1\n-40 -20 0 20 40\n(a) Entropy function\ng( \u03b5)\nT=10 MeV T= 1 MeV T=0.1 MeV\n-1x10-5\n-5x10-6\n0\n5x10-6\n1x10-5\n-40 -20 0 20 40\n(b) Error\ndg (\u03b5 )\n\u03b5 [ MeV ]\nFIG. 2. Same as Fig. 1, but for the entropy function g( ) of Eq. (27) instead of f\u03b2\u00b5( ).\n-2x10-6\n-1.5x10-6\n-1x10-6\n-5x10-7\n0\n5x10-7\n1x10-6\n1.5x10-6\n2x10-6\n-100 -50 0 50 100\ndf (\u03b5 )\n\u03b5 [ MeV ]\nM=90 M=100 M=120\nFIG. 3. Error in the Fermi-Dirac function at T = 10 MeV with different values of the maximum degrees M . The magenta line is calculated with M = 90, the same as that in Fig. 1(b). Those with M = 100 and M = 120 are shown by orange and light blue lines, respectively.\ndegrees, M = 1.5 \u00d7 er\u03b2, which provides a reasonable accuracy.\nWith the same chemical potential, the nucleon number A increases approximately threefold from T = 1 MeV to 10 MeV. On the other hand, difference in the WoodsSaxon energy is only about 30%. This can be understood from the nucleon density profile shown in Fig. 4. A significant portion of nucleons is dripped from the WoodsSaxon potential at T = 10 MeV. The particles far out of the potential range Rws = 3 fm do not contribute to Ews.\n7 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18\n0 1 2 3 4 5 6 7 8\n\u03c1( r) [ f m -3\n]\nr [ fm ]\nT=1 MeV T=10 MeV\nFIG. 4. Calculated density profiles at T = 1 MeV and 10 MeV as a function of the radial coordinate. Symbols indicate calculated values at the square mesh points and lines are obtained by the spline interpolation. See text for details.\nC. Isolated nuclei at finite temperature"
        },
        {
            "heading": "1. Modified Broyden\u2019s method",
            "text": "In the HF calculations, the self-consistency between the densities and the potentials (Hamiltonian) is required. For a given HF Hamiltonian H\u0302 (n) in at the nth iteration, the one-body density \u03c1ij is obtained using the FOE calculation of Eq. (16), which produces a new HF Hamiltonian H\u0302 (n) out . The self-consistency is achieved when we reach the fixed point for the Hamiltonian, Hin = Hout, which is equivalent to the density fixed point. Since naive iteration with the total replacement of the Hamiltonian as H\u0302 (n+1) in = H\u0302 (n) out does not converges in many cases, the linear mixing is often adopted as H\u0302 (n+1) in = (1\u2212\u03b1)H\u0302 (n) in +\u03b1H\u0302 (n) out with a mixing parameter \u03b1. Although the divergence can be avoided if we choose the parameter \u03b1 small (0 < \u03b1 1), the convergence can be very slow.\nIn this paper, we use the modified Broyden\u2019s method\n[35]. In Ref. [36], its performance has been examined for finite nuclei with the Skyrme-HFB calculations at zero temperature using the matrix diagonalization. We perform similar study for the FOE calculation at finite temperature. In Fig. 5, we show the convergence behaviors of the modified Broyden\u2019s method, compared to the linear mixing method. Here, we show the difference in diagonal density \u03c1(r) between the current (n) and the previous (n\u2212 1) iteration steps.\n|\u2206Fn| \u2261 A\u22121 \u222b dr \u2223\u2223\u2223\u03c1(n)(r)\u2212 \u03c1(n\u22121)(r)\u2223\u2223\u2223 . (28)\nSince the chemical potential is adjusted every iteration to reproduce either the average nucleon density \u03c1av, or the nucleon number, the baryon (nucleon) number A is fixed during the iteration.\nIn the linear mixing, the result depends on the magnitude of the mixing parameter \u03b1. Figure 5 shows the case of 16O at T = 1 MeV. In this case, the calculation with \u03b1 = 1 does not converge, while that with \u03b1 = 0.5 gives the fastest convergence among \u03b1 = 1, 0.8, 0.5, and 0.2. The optimum value of \u03b1 varies and is difficult to predict. For instance, in the case of T = 10 MeV, the calculation with \u03b1 = 1 converges faster than that with \u03b1 = 0.5. In order to guarantee the convergence, we need to choose a small value of \u03b1, typically \u03b1 < 0.2, which leads to a slow convergence of the iterative procedure.\nThe modified Broyden\u2019s method provides a faster and a stable convergence. The modified Broyden\u2019s algorithm [35] also contains two parameters we need to choose, namely, the mixing parameter \u03b1 and the maximum number of stored vectors m. It turns out that the result does not strongly depend on the choice of \u03b1 and m. For the mixing parameter \u03b1, we can safely choose \u03b1 \u2248 1. Larger values of m give slightly better convergence, but only a few iteration number difference between m = 10 and 100. In the present paper, we adopt \u03b1 = 0.8 and m = 100. Although storing m Broyden\u2019s vectors may require large memory resources when the system size is large, the computational time for the Broyden\u2019s procedure is negligible."
        },
        {
            "heading": "2. Isolated doubly magic nuclei at finite temperature",
            "text": "First, let us show results of 16O at finite temperature. We use the space size of (13 fm)3 with the 3D cubic grid of (1 fm)3. In Fig. 6, the total energy E and the free energy F at every iteration are plotted. At T = 1 MeV, as the iteration number increases, both E and F decrease to the final values, E = \u2212132.6 MeV and F = \u2212132.9 MeV. The calculated entropy is very small, about 0.3kB . This is due to the doubly closed-shell nature of 16O. At T = 10 MeV, in contrast, the total energy E increases to reach the converged value, E = 210.0 MeV. Note that the line in Fig. 6 is shifted downwards by 330 MeV to be presented in the same panel as T = 1 MeV. Nevertheless, the free energy F decreases, because the entropy gradu-\n8 1x10-12 1x10-10 1x10-8 1x10-6 0.0001 0.01 1\n0 20 40 60 80 100 120 140 160 180 200\n|\u0394 F n |\nItenation number\n\u03b1=1 \u03b1=0.8 \u03b1=0.5 \u03b1=0.2 Broyden\nFIG. 5. Comparison of convergence between the linear mixing (black lines) and the modified Broyden\u2019s method (red symbols) for 16O calculated at T = 1 MeV. The space size is (13 fm)3. See text for details.\n-138\n-136\n-134\n-132\n-130\n-128\n-126\n-124\n-122\n-120\n0 2 4 6 8 10 12 14 16 18 20\nE or\nF [ M eV\n]\nIteration number\nE (T=1 MeV) F (T=1 MeV) E (T=10 MeV) F (T=10 MeV)\nFIG. 6. Total energy E (solid lines) and free energy F (dashed) of 16O at T = 1 MeV (blue) and T = 10 MeV (red) as functions of self-consistent iteration number with the modified Broyden\u2019s method. The lines for T = 10 MeV are shifted by \u2212330 MeV for E and by +300 MeV for F . See text for details.\nally increases as the iteration proceeds. The entropy is calculated as S = 64.6kB .\nThe calculated nucleon density distributions are presented in Fig. 7. The center of mass of 16O is located at the center of the cubic box of (13 fm)3. The density values at the calculated grid points are shown by circles for T = 0.5 and 8 MeV. The spline interpolation is used to show the smooth lines in Fig. 7. At low temperature, such as T = 0.5 and 1 MeV, we find a signature of the shell effect as a dip at the center of the nucleus. This is due to the full occupation of the 0p orbitals. Higher is the temperature, more fractional is the occupation, leading to weakening of the shell effect. At T = 7 MeV, the density hole at the center disappears.\nThe phase transition to the uniformed nuclear matter takes place at the critical temperature Tc = 7.47 MeV. More precisely speaking, it is 7.46 < Tc \u2264 7.47 MeV.\n0\n0.02\n0.04\n0.06\n0.08\n0.1\n0.12\n0.14\n0.16\n0 1 2 3 4 5 6 7 8\n\u03c1( r) [ f m -3\n]\nr [ fm ]\nT=0.5 MeV T=1.0 MeV T=4.0 MeV T=7.0 MeV T=7.4 MeV T=7.46 MeV T=7.47 MeV T=8.0 MeV\n0\n0.005\n0.01\n4 5 6 7 8\nFIG. 7. Nucleon density distribution of 16O at different temperature. The horizontal axis is the distance from the center of mass. Since those calculated at T = 0.5 MeV and 8 MeV are indistinguishable from those at T = 1 MeV and 7.47 MeV, respectively, they are shown as symbols. The space size is (13 fm)3. Inset: Density distributions in the outer region of r > 4 fm is shown, but those at T = 0.5 MeV and 8 MeV are omitted. See text for details.\nA discontinuous change in the density profile suddenly occurs at T = Tc. This is a consequence of the selfconsistent evolution of the mean-field potential, which gives a striking contrast to the density change in the fixed potential (Fig. 4). The 16O nucleus is in a liquid phase at T = 0. Since there are some dripped nucleons at T 6= 0, it is a coexistence phase of liquid and vapor at 0 < T < Tc. Then, it is transformed to the gas phase at T > Tc. We should note here that the critical temperature Tc depends on the adopted volume V that is (13 fm)3 in the present calculation. Tc for the isolated nucleus should be given as the value at V \u2192\u221e. See Sec. III D 2 for more details.\nThe dripped nucleons at different temperature can be seen in the inset of Fig. 7. In the gas phase, the density should be \u03c1gas = 16/(13 fm)\n3 = 7.28 \u00d7 10\u22123 fm\u22123. The uniform density obtained at T > Tc is very close to \u03c1gas, however, the calculated density is not perfectly constant. It has a minimum value at the center and slightly increases as r increases. This strange behavior is an artifact due to the finiteness of the box size. Following the idea of Ref. [34], the Coulomb potential for the isolated system is calculated by assuming that there exist no charge outside of the adopted space ((13 fm)3 in the present case). Therefore, the charged particles (protons) tend to move toward the edge of the box, in order to reduce the Coulomb repulsive energy. We have also confirmed that the density is perfectly constant if the Coulomb potential is neglected.\nFigure 8 shows the density profiles for 40Ca. The model space is taken as (17 fm)3 with the cubic grids of (1 fm)3. The shell effect opposite to 16O is seen at low temperature, namely a bump at the center of the nucleus. This is due to the full occupation of 1s orbital. The shell effect becomes invisible at T = 7\n9 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18\n0 1 2 3 4 5 6 7 8\n\u03c1( r)\n[ f m\n-3 ]\nr [ fm ]\nT=1.0 MeV T=3.0 MeV T=7.0 MeV T=8.5 MeV T=8.6 MeV\nFIG. 8. Nucleon density distribution of 16O at different temperature. The horizontal axis is the distance from the center of mass. The space size is (17 fm)3.\n-1000 -800 -600 -400 -200\n0 200 400 600 800\n0 2 4 6 8 10\nE [ M\neV ]\nT [ MeV ]\nE Ekin\n-ST+600MeV F\n-344.45 -344.4\n-344.35\n0 0.5\nFIG. 9. Total energy E (red solid) and free energy F (blue solid) are shown as functions of T , together with kinetic energy Ekin (black dotted) and \u2212ST (purple dash-dotted) for 40Ca. Note that the line of \u2212ST is shifted upward by 600 MeV. Inset: E and F in the zero temperature region are magnified.\nMeV. The critical temperature of the liquid-gas transition is located in 8.5 < Tc \u2264 8.6 MeV. The discontinuous density change is seen at T = Tc. The density of the uniform matter in the present calculation should be \u03c1gas = 40/(17 fm)\n3 = 8.14\u00d7 10\u22123 fm\u22123. In Fig. 9, the energy E and the free energy F are shown as functions of T . At T = Tc \u2248 8.6 MeV, the total energy E shows a kink because of the abrupt density change. However, this kink is almost canceled by an opposite kink behavior in the entropy, and F = E\u2212ST behaves rather smoothly. E is a monotonic increasing function of T , while F is a decreasing function. The zero temperature limit is easily achieved in this case, because the 40Ca nucleus is doubly magic with large shell gaps at the Fermi surface. In the inset panel of Fig. 9, we find that E = F holds in very high accuracy at T = 0.1 MeV. The difference is within 0.1 eV. Even at T = 0.5 MeV, it is within 50 keV. Note that the upper (lower) limit of the\n0\n10\n20\n30\n40\n50\n0 0.5 1 1.5 2 2.5 3\naxial\nQ m\nom de\nnt [\nfm 2 ]\nT [ MeV ]\n|Q22|\ntriaxial\naxial\ntriaxial |Q2|\nFIG. 10. Calculated intrinsic quadrupole moments (Q2 and |Q22|) for 24Mg at finite temperature. At low temperature (T . 0.5 MeV), the self-consistent iterations starting from different initial states result in different solutions, labeled by \u201caxial\u201d and \u201ctriaxial\u201d, respectively. See text for details.\ntotal energy at T = 0 is given by E (F ) at T > 0.\nIt is worth mentioning that the coordinate-space representation is essential to describe the dripped nucleons and the liquid-gas phase transition. Most of the finite-temperature mean-field calculations in the past have been performed with the harmonic oscillator basis [3, 4, 6]. Those studies are focused on the shape change and the pairing properties at finite temperature, however, it is difficult to describe the uniform matter and the dripped nucleons. In Refs. [8, 9], adopting the spherical Wigner-Seitz approximation, the finite-temperature Skyrme Hartree-Fock calculation was performed in the radial coordinate representation. Our results on properties of the liquid-gas phase transition turns out to be substantially different from Refs. [8, 9]. For instance, they showed that ignoring the Coulomb potential for 208Pb leads to a significant increase in Tc (about 5 MeV) and a smooth continuous transition from the liquid to the gas phase. In our calculation, properties of the liquidgas transition is almost invariant, even if we neglect the Coulomb potential: We find a slight increase by only a few hundreds of keV with a discontinuous transitions of the density profile into the uniform matter. Although the the results in this paper are on N = Z nuclei only, it would be important to perform the detailed comparison in future to identify origins of the discrepancies."
        },
        {
            "heading": "3. Isolated deformed nuclei at finite temperature",
            "text": "We calculate an isolated 24Mg nucleus at finite temperature, which is known to be deformed in the ground state. In Fig. 10, we present the calculated quadrupole\n10\nmoment, which is defined as\nQ2 \u2261 \u221a\u221a\u221a\u221a 2\u2211 \u00b5=\u22122 |Q2\u00b5|2, Q2\u00b5 \u2261 \u222b drr2Y2\u00b5\u03c1(r). (29)\nAt low temperature, when we start the self-consistent iteration with a Hamiltonian corresponding to an axially symmetric deformed density distribution, the calculation converges to an axially symmetric prolate nucleus (Q2\u00b5 = 0 except for \u00b5 = 0). However, near the zero temperature, this does not correspond to the state with the minimum free energy. If we start with a triaxial shape, it ends up with a triaxially deformed nucleus, characterized by Q22 6= 0. The shape transition from triaxial to axial shapes takes place at temperature T = Ttri with 0.5 < Ttri < 0.6 MeV. The axial prolate shape persists till the second shape transition to the spherical shapes, which takes place at temperature T = Tdef with 2.7 < Tdef < 2.8 MeV. This is shown in Fig. 10 as two lines.\nIn Fig.11, we show the temperature dependence of the energy E and the free energy F . A kink of the energy E is caused by the liquid-gas phase transition. The calculated critical temperature is 6.5 < Tc < 6.6 MeV. Again, this kink is almost canceled by an opposite kink behavior in the entropy, and a kink in the free energy F is much smaller. The effect of the shape transition at T \u2248 2.7 MeV is invisible in the temperature dependence of E and F , while that of the axial-triaxial transition at T \u2248 0.5 MeV can be seen in the inset of Fig.11. An extrapolation to T = 0 using calculations at T > 0.5 MeV may lead to a wrong answer. The zero temperature limit should be carefully examined when a structure change is expected at very low temperature.\nAnother interesting feature is a property of the kinetic energy. At T = 0.1 MeV, the kinetic energy for the triaxial solution is smaller than that of the axial one by about 6.3 MeV, while the difference in the total energy is about 2.4 MeV. This clearly indicates that the triax-\nial shape in 24Mg is realized by significant decrease in the kinetic energy, although it is unfavored by the potential energy. As the deformation decreases with increasing temperature, the kinetic energy monotonically increases up to T = Tdef . This also suggests that the deformation reduces the kinetic energy, while the potential energy favors the sphericity. This is consistent with the fact that the Thomas-Fermi method cannot produce the deformation. When there are more nucleons moving along z direction than x and y directions, according to the uncertainty principle, the kinetic energy can be reduced by elongating a potential in the z direction. This effect is completely lost in the local density approximation.\nAt T > Tdef , the nucleus is spherical and the kinetic energy decreases as increasing T . At T = Tc, since the nucleus suddenly breaks up into a gas phase, the kinetic energy shows a discontinuous drop. This is because number of dripped nucleons increases as a function of T up to T = Tc, and their momenta are smaller than those of nucleons confined inside the nucleus, which is also due to the uncertain principle."
        },
        {
            "heading": "D. Non-uniform periodic nuclear matter at finite temperature",
            "text": "Next, we apply the method to the non-uniform symmetric nuclear matter. The only difference from the calculations in Sec. III C is the treatment of the Coulomb potential. For periodic non-uniform nuclear matter, we assume the uniform distribution of electrons, to guarantee the charge neutrality. This results in the vanishing k = 0 Fourier component of the Coulomb potential. In the present calculations, the electron energy does not affect the structure of nuclear matter, since we calculate the nuclear matter at given baryon density \u03c1 and proton ratio (Yp = 0.5).\n1. A = 32 in a cell of (17 fm)3\nFirst, we calculate the symmetric nuclear matter at average baryon density \u03c1 = 6.51\u00d710\u22123 fm\u22123 with a simple cubic initial configuration in which a 32S nucleus is located at the center of a cubic box of (17 fm)3. At low temperature, we find the 32S nucleus in a self-consistent solution. The 32S nucleus is deformed at low temperature T < Tdef . The deformation disappears at T = Tdef with 1.6 < Tdef < 1.7 MeV. The dripped nucleons increase with temperature, then, the liquid-gas phase transition takes place at T = Tc with 7.7 < Tc < 7.8 MeV. See Fig. 12 for evolution of the density distribution as a function of temperature.\nIn addition to the simple cubic configuration, we also perform calculations with the body-centered-cubic (bcc) configuration as the initial state. This leads to two 16O nuclei in the same cell (17 fm)3. At low temperature, the self-consistent calculation converges to the bcc phase.\n11\nSince the (free) energy is larger than that of the cubic configuration, the bcc state exists as a metastable equilibrium. Panels (a) and (b) in Fig. 13 show the density distributions at T = 0.1 MeV in the xy plane at z = 8 fm and at z = 0. In contrast, panels (c) and (d) in Fig. 13 show those at T = 5 MeV, indicating that the bcc state is no longer stable at higher temperature. During the self-consistent iterations starting from the bcc state, the 16O nucleus at the center disappears leading to the cubic configuration, namely, a single 32S nucleus in the cell of (17 fm)3. The stability of the bcc state seems to be lost around T = 4 MeV.\nAnother calculation with the initial configuration of a 40Ca nucleus located at the center of the cell of (17 fm)3 is performed. This corresponds to the average density of \u03c1 = 8.14 \u00d7 10\u22123 fm\u22123. The variation of the density distribution as a function of temperature is similar to the one for the isolated 40Ca nucleus in Fig. 8. However, the critical temperature for the liquid-gas transition slightly increases, 8.6 < Tc < 8.7 MeV.\nIn the present calculation, the number of particles is irrelevant to the computational cost. Thus, as far as the cell and the grid sizes are invariant, the computing time is roughly the same for any density and particle numbers in the cell. It should be noted that there is no spurious effect in dripped nucleons, namely a rise up of the density near the boundary observed in cases of isolated nuclei (Sec. III C 2) , such as Fig. 7. The Coulomb potential in the periodic systems is influenced by the periodic presence of other nuclei outside of the cell (17 fm)3. The dripped nucleons produce perfectly flat density distribution outside of the nucleus.\n2. A = 32 in a cell of (23 fm)3\nEnlarging the cell size into (23 fm)3 keeping the baryon number A = 32 in the cell, we perform the same calcula-\ntions with the cubic and bcc initial con gurations. The average density is = 2 :63 10 3 fm 3. Both the cubic and bcc con gurations exist at low temperature at T . 3:7 MeV. The solution with a single 32S nucleus in the cell has lower energy than the bcc solution. In the calculation with T 3:8 MeV, the bcc metastable solution seems to disappear, since we end up with the single32S nucleus in the cell even if we start with the bcc con guration with two 16O nuclei. The density pro les obtained with calculations starting from the bcc initial con guration are shown in Fig. 14 at T = 2 MeV (panels (a) and (b)) and at T = 5 MeV ((c) and (d)).\nFigure 15 presents the free energy per nucleonF=A for various phases. The cubic con guration of 32S has the lowest free energy atT < T c 5:1 MeV. At T > T c, the uniform symmetric matter becomes the lowest. This critical temperature Tc is signi cantly smaller than Tc for the average density = 6 :51 10 3 fm 3 with the cell size (17 fm)3. This can be understood as follows: For the uniform phase at T > 5 MeV, the system is well approximated by the classical gas. The entropy of the classical ideal gas has the volume dependence asS AkB ln(V=A). Thus, the entropy per nucleon S=A for the cell of (23 fm)3 is larger than that of (17 fm) 3, by (S=A) = kB ln(233=173) 0:9kB . This leads to a shift of 0:9kB T in the free energy of the uniform matter in (17 fm)3, shown by a dashed line in Fig. 15. Since the entropy in the localized phases, such as cubic and bcc, is scarcely a ected by the volume change,Tc, given by the crossing point of the uniform and cubic phases, decreases as the volume increases.\n12\nFIG. 14. Density distributions in the xy plane at = 2 :63 10 3 fm 3 with a cell of (23 fm) 3 , calculated with the bcc initial state. (a) T = 2 MeV and z = 11 fm, (b) T = 2 MeV and z = 0, (c) T = 5 MeV and z = 11 fm, (d) T = 5 MeV and z = 0. Note that the color map is given in logarithmic scale.\nFIG. 15. Free energy per particle of symmetric nuclear matter at = 2 :63 10 3 fm 3 with a cell of (23 fm) 3 , for cubic, bcc, and uniform phases. The dashed line is given by shifting the line of the uniform matter by 0 :9 T . See text for details.\nE. Nearsightedness\nFinally, let us check properties of the \"nearsightedness\" in calculations of nuclear matter at nite temperature, then, examine whether it bene ts calculations of neutron star matter. The O( N ) calculation can be achieved if the one-body density matrix, (r ; r 0), is localized in a space considerably smaller than the cell size. In the present calculation, we can truncate the Hamiltonian matrix in Eq. (15) into a space only nearby jj n i . See also\narguments in Sec. II E. Figure 16 presents the o -diagonal behaviors of the density matrix for a 40Ca nucleus located at the center of the cell (23 fm)3 of the simple cubic lattice. For comparison, those for the uniform matter is shown in the bottom panels (b) and (d). We adopt the center of the cellr = 0 as a reference point and show (r; 0) as a function of the distance r . The magnitude of the o -diagonal density exponentially decays. For the uniform matter, the calculated behaviors indicate the decay constant proportional to the temperature T . This is known in studies of nitetemperature density matrix for electrons in metals [37]. In contrast, for non-uniform matter with 40Ca in a cell, the decay is signi cantly faster than the uniform matter and is insensitive to the temperature. This is not entirely attributed to the nite radius of the nucleus 40Ca. From T = 1 MeV to T = 5 MeV, the radius of 40Ca is reduced by about 0:5 1 fm (cf. Fig. 8), because more nucleons are dripped to form low-density matter. However, the e ect of this reduction in the nuclear radius is not visible in Fig. 16 (a) and (c). The fast decay may be, at least partially, due to large density inside the nucleus. At zero temperature, the uniform matter is expected to show an oscillating pattern of (r; 0) kF cos(kF r )=r2 [28], wherekF is the Fermi momentum. Thus, at larger density (larger kF ), the o -diagonal density goes to zero more quickly.\nEventually, the localization of the density matrix is more prominent in the non-uniform phase than in the uniform matter. Adopting the cut-o value for the relative magnitude as 10 4 (the dashed line in Fig. 16 (d)), the cut-o distance for the uniform matter is given by Rc 13 fm at T = 5 MeV, and it is considerably larger than 20 fm at T = 1 MeV. In contrast, for the nonuniform matter, the cut-o distance is Rc 10 fm at T = 5 MeV and Rc 13 fm at T = 1 MeV. When we calculate the (r ; r 0) with the recursion relation (15), truncating the space into a local subspace,jr r 0j < R c, may lead to a sizable reduction in the computational cost if the cell size is larger thanR3c .\nIV. CONCLUSION\nWe examine the applicability and the usefulness of the Fermi operator expansion (FOE) method in nuclear energy density functional approaches at nite temperature. The one-body density matrix, which is identical to the Fermi operator, is expanded in terms of the Chebyshev polynomials up to the nite order. The maximum degree of the polynomials is inversely proportional to the temperature. Thus, it becomes extremely e cient for calculations at high temperature. For the self-consistent iteration procedure, we adopt the modi ed Broyden\u2019s mixing method. The same idea of the polynomial expansion is applied to calculations of the entropy, which enables us to estimate the free energy without diagonalization of the Hamiltonian matrix. The FOE method is applied to\n13\ncalculations of isolated nuclei and non-uniform nuclear matter, using the 3D coordinate-space representation.\nWe investigate thermal properties of isolated nuclei in a cell of (13 fm)3. For 24Mg, the triaxial shape has the minimum energy at zero temperature. The triaxial state exists as a solution at T . 0.6 MeV, beyond that, the state disappears. The axial deformed solution survives till T \u2248 2.7 MeV, beyond which the nuclear shape is spherical. The liquid-gas transition takes place around Tc \u2248 6.5 MeV. For doubly-magic spherical nuclei, such as 16O and 40Ca, the critical temperature of the liquidgas transition has slightly higher values, Tc = 7\u22129 MeV. However, the detailed values of the critical temperature may not have a significant meaning for isolated nuclei, because they depends on the volume of the adopted space. We need to take the infinite volume limit. Nevertheless, it is a great advantage of the coordinate-space representation to be capable of describing both the spatially localized nucleus and the extended matter.\nFor periodic non-uniform nuclear matter, the calculations are performed with different cell sizes, (13 fm)3 and (23 fm)3, with the same nucleon number A = 32. We start the self-consistent iteration with different initial states, such as the simple cubic and the bcc configurations. At low temperature, both the simple cubic and the bcc states exist as self-consistent solutions. The cubic state is lower in free energy than the bcc state. The transition to the uniform matter takes place at Tc, the value of which is smaller for a larger cell. This volume effect on the critical temperature Tc is due to the volume dependence of the entropy of the uniform matter. For the inner crust of neutron stars in the beta equilibrium, the cell size is supposed to decrease as the density increases [19]. Since the entropy of the classical gas behaves as S/A \u223c kB ln(V/A) \u223c \u2212kB ln \u03c1, Tc may become larger at larger densities. This is somewhat opposite to our naive\nexpectation, because the density profile becomes flatter at higher density. It may be of interest to investigate the critical temperature Tc at different density regions.\nAdvantageous features of the FOE method in computational point of view can be summarized as follows: (1) The matrix diagonalization is not involved in the calculation, including the calculation of the entropy. (2) The calculation of the density matrix \u03c1ij is independent with respect to the index j. Thus, it is suitable for the distributed-memory parallel computing. (3) The computational cost could scale linearly with respect to the space dimension N , when N is large enough. Here, N is the dimension of the matrix \u03c1ij .\nThe last point (3) above is numerically investigated by examining the decay of the density matrix \u03c1(r, r\u2032) at large |r \u2212 r\u2032|. For the uniform matter, the decay length is shorter at higher temperature, which has been known for electron systems [28]. In addition, for non-uniform matter with localized nuclei, the decay is significantly faster than the uniform matter. The decay pattern of the non-uniform matter at T = 1 MeV is close to that of the uniform matter at T \u2248 10 MeV. The short decay length of the density matrix could lead to the O(N) calculation by truncating the space in the matrix operation. The O(N) method may be more useful in the non-uniform matter than in the uniform matter.\nThe calculations in the present paper use the BKN energy density functional. It is straightforward to extend this to realistic Skyrme functionals, which is under progress. The proper treatment of the matter in the periodic potential requires the band calculation. The density should be constructed by averaging the calculated results over different values of Bloch wave numbers k, which should be relatively easy to perform. The calculation can be further parallelized with respect to different k.\nThe extension of the FOE method to the finitetemperature HFB calculation is formally straightforward as well. This can be done by replacing the single-particle Hamiltonian H by the HFB Hamiltonian,\nH\u00b5 = ( H \u2212 \u00b5 \u2206 \u2212\u2206\u2217 \u2212(h\u2212 \u00b5)\u2217 ) , (30)\nin Eq. (7) to achieve the generalized density matrix R. R = \u2211 \u03b1\u22770 |\u03b1\u3009f\u03b2(E\u03b1)\u3008\u03b1| = f\u03b2(H\u00b5), (31)\nwhere |\u03b1\u3009 are the quasiparticle eigenstates, H\u00b5|\u03b1\u3009 = E\u03b1|\u03b1\u3009, and the summation is taken over both positive and negative quasiparticle energies. However, there is a practical issue to be examined in future, namely, the truncation of the pairing model space. Since most of the pairing energy functional has been constructed with a cut-off energy, it is preferable to develop a prescription to allow the truncation of the pairing model space.\nThe FOE method may open a new possibility for studies of the non-uniform baryonic matter at finite temperature and neutron-star matter in the crust region.\n14"
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "This work is supported in part by JSPS KAKENHI Grant No. 18H01209. This research in part used com-\nputational resources provided through the HPCI System Research Project (Project ID: hp200069), and by Multidisciplinary Cooperative Research Program in Center for Computational Sciences, University of Tsukuba.\n[1] J.-P. Blaizot and G. Ripka, Quantum Theory of Finite Systems (MIT Press, Cambridge, 1986). [2] N. Schunck, ed., Energy Density Functional Methods for Atomic Nuclei , 2053-2563 (IOP Publishing, 2019). [3] A. L. Goodman, Nuclear Physics A 352, 30 (1981). [4] J. L. Egido and P. Ring, Journal of Physics G: Nuclear\nand Particle Physics 19, 1 (1993). [5] G. Bertsch and J. Mehlhaff, Computer Physics Commu-\nnications 207, 518 (2016). [6] W. Zhang and Y. F. Niu, Phys. Rev. C 97, 054302 (2018). [7] W. G. Newton and J. R. Stone, Phys. Rev. C 79, 055801\n(2009). [8] P. Bonche, S. Levit, and D. Vautherin, Nuclear Physics\nA 427, 278 (1984). [9] P. Bonche, S. Levit, and D. Vautherin, Nuclear Physics\nA 436, 265 (1985). [10] M. Brack, C. Guet, and H.-B. H\u030aakansson, Physics Re-\nports 123, 275 (1985). [11] M. Onsi, H. Przysiezniak, and J. M. Pearson, Phys. Rev.\nC 55, 3139 (1997). [12] M. Okamoto, T. Maruyama, K. Yabana, and T. Tatsumi,\nPhys. Rev. C 88, 025801 (2013). [13] C.-J. Xia, T. Maruyama, N. Yasutake, and T. Tatsumi,\nPhys. Rev. D 106, 063020 (2022). [14] G. Watanabe, K. Sato, K. Yasuoka, and T. Ebisuzaki,\nPhys. Rev. C 69, 055805 (2004). [15] C. J. Horowitz, D. K. Berry, C. M. Briggs, M. E. Caplan,\nA. Cumming, and A. S. Schneider, Phys. Rev. Lett. 114, 031102 (2015). [16] M. E. Caplan and C. J. Horowitz, Rev. Mod. Phys. 89, 041002 (2017). [17] A. Bulgac and P. Magierski, Nuclear Physics A 683, 695 (2001). [18] N. Chamel, Nuclear Physics A 747, 109 (2005). [19] J. Negele and D. Vautherin, Nuclear Physics A 207, 298\n(1973).\n[20] M. Baldo, E. Saperstein, and S. Tolokonnikov, Nuclear Physics A 775, 235 (2006). [21] H. Shen, H. Toki, K. Oyamatsu, and K. Sumiyoshi, Nuclear Physics A 637, 435 (1998). [22] H. Togashi, K. Nakazato, Y. Takehara, S. Yamamuro, H. Suzuki, and M. Takano, Nuclear Physics A 961, 78 (2017). [23] N. Chamel and P. Haensel, Living Rev. Relativity 11, 10 (2008). [24] S. Jin, A. Bulgac, K. Roche, and G. Wlaz lowski, Phys. Rev. C 95, 044302 (2017). [25] Y. Kashiwaba and T. Nakatsukasa, Phys. Rev. C 101, 045804 (2020). [26] S. Goedecker and L. Colombo, Phys. Rev. Lett. 73, 122 (1994). [27] S. Goedecker and M. Teter, Phys. Rev. B 51, 9455 (1995). [28] S. Wu and C. Jayanthi, Physics Reports 358, 1 (2002). [29] W. Kohn, International Journal of Quantum Chemistry\n56, 229 (1995). [30] R. Baer and M. Head-Gordon, Phys. Rev. Lett. 79, 3962\n(1997). [31] P. Bonche, S. Koonin, and J. W. Negele, Phys. Rev. C\n13, 1226 (1976). [32] T. Nakatsukasa and K. Yabana, Phys. Rev. C 71, 024301\n(2005). [33] J. Maruhn, P.-G. Reinhard, P. Stevenson, and A. Umar,\nComputer Physics Communications 185, 2195 (2014). [34] J. Eastwood and D. Brownrigg, Journal of Computa-\ntional Physics 32, 24 (1979). [35] D. D. Johnson, Phys. Rev. B 38, 12807 (1988). [36] A. Baran, A. Bulgac, M. M. Forbes, G. Hagen,\nW. Nazarewicz, N. Schunck, and M. V. Stoitsov, Phys. Rev. C 78, 014318 (2008).\n[37] S. Goedecker, Phys. Rev. B 58, 3501 (1998)."
        }
    ],
    "title": "Fermi operator expansion method for nuclei and inhomogeneous matter with nuclear energy density functional",
    "year": 2022
}