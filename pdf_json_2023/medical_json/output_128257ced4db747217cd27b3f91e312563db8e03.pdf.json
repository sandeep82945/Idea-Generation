{
    "abstractText": "Sleep-related breathing disorders (SBDs) will lead to poor sleep quality and increase the risk of cardiovascular and cerebrovascular diseases which may cause death in serious cases. Tis paper aims to detect breathing states related to SBDs by breathing sound signals. Amoment waveform analysis is applied to locate and segment the breathing cycles. As the core of our study, a set of useful features of breathing signal is proposed based on Mel frequency cepstrum analysis. Finally, the normal and abnormal sleep breathing states can be distinguished by the extracted Mel-scale indexes. Young healthy testers and patients who sufered from obstructive sleep apnea are tested utilizing the proposedmethod.Te average accuracy for detecting abnormal breathing states can reach 93.1%. It will be helpful to prevent SBDs and improve the sleep quality of home healthcare.",
    "authors": [
        {
            "affiliations": [],
            "name": "Yu Fang"
        },
        {
            "affiliations": [],
            "name": "Dongbo Liu"
        },
        {
            "affiliations": [],
            "name": "Zhongwei Jiang"
        },
        {
            "affiliations": [],
            "name": "Haibin Wang"
        }
    ],
    "id": "SP:2cc09cea895467ee90da64993a2fff0a8704e0dc",
    "references": [
        {
            "authors": [
                "World Sleep Day"
            ],
            "title": "Celebrate healthy sleep on world sleep day",
            "venue": "Proceedings of the News Conference of World Sleep Day, Beijing, China, March 2017.",
            "year": 2017
        },
        {
            "authors": [
                "J.A. Dempsey",
                "S.C. Veasey",
                "B.J. Morgan",
                "C.P. Donnell"
            ],
            "title": "Pathophysiology of sleep apnea",
            "venue": "Physiological Reviews, vol. 90, pp. 47\u2013112, 2010.",
            "year": 2010
        },
        {
            "authors": [
                "U.R. Abeyratne",
                "S. De Silva",
                "C. Hukins",
                "B. Duce"
            ],
            "title": "Obstructive sleep apnea screening by integrating snore feature classes",
            "venue": "Physiological Measurement, vol. 34, no. 2, pp. 99\u2013121, 2013.",
            "year": 2013
        },
        {
            "authors": [
                "C. Doukas",
                "T. Petsatodis",
                "C. Boukis",
                "I. Maglogiannis"
            ],
            "title": "Automated sleep breath disorders detection utilizing patient sound analysis",
            "venue": "Biomedical Signal Processing and Control, vol. 7, no. 3, pp. 256\u2013264, 2012.",
            "year": 2012
        },
        {
            "authors": [
                "J.-Y. Huang",
                "J.-R. Zhang",
                "C.-J. Mao"
            ],
            "title": "Efects of obstructive sleep apnoea hypopnoea and rapid eye movement sleep behavior disorder on cognitive impairment in Parkinson\u2019s disease",
            "venue": "Journal of Clinical Neurology, vol. 29, no. 6, pp. 417\u2013420, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "Z. Moussavi",
                "A. Elwali",
                "R. Soltanzadeh",
                "C.A. MacGregor",
                "B. Lithgow"
            ],
            "title": "Breathing sounds characteristics correlate with structural hanges of upper airway due to obstructive sleep apnea",
            "venue": "EMBC, vol. 2015, pp. 5956\u20135959, Article ID 7319748, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "M.A. Serhani",
                "M.E.Menshawy",
                "A. Benharref"
            ],
            "title": "SME2EM: smart mobile end-to-end monitoring architecture for lifelong diseases",
            "venue": "Computers in Biology and Medicine, vol. 68, pp. 137\u2013154, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "Q. Jiang",
                "J. Ma",
                "C. Yang",
                "X. Ma",
                "J. Shen",
                "A.C. Shehzad"
            ],
            "title": "Efcient end-to-end authentication protocol for wearable health monitoring systems",
            "venue": "Computers and Electrical Engineering, vol. 63, pp. 1\u201314, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "C. Massaroni",
                "D. Lo Presti",
                "D. Formica",
                "S. Silvestri",
                "E. Schena"
            ],
            "title": "Non-contact monitoring of breathing pattern and respiratory rate via RGB signal measurement",
            "venue": "Sensors, vol. 19, no. 12, pp. 2758\u20132815, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "A. Cesareo",
                "Y. Previtali",
                "E. Bif",
                "A. Aliverti"
            ],
            "title": "Assessment of breathing parameters using an inertial measurement unit (IMU)-Based system",
            "venue": "Sensors, vol. 19, no. 1, pp. 88\u201324, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "A. Al-Naji",
                "A.J. Al-Askery",
                "S.K. Gharghan",
                "J. Chahl"
            ],
            "title": "A system for monitoring breathing activity using an ultrasonic radar detection with low power consumption",
            "venue": "Journal of Sensor and Actuator Networks, vol. 8, no. 2, pp. 32\u201317, 2019.",
            "year": 2019
        },
        {
            "authors": [
                "A. Prochzka",
                "H. Charvtov",
                "O. Vysata",
                "J. Kopal",
                "J. Chambers"
            ],
            "title": "Breathing analysis using thermal and depth imaging camera video records",
            "venue": "Sensors, vol. 17, pp. 1\u201310, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "H. Alshaer",
                "G.R. Fernie",
                "E. Maki",
                "T. Douglas Bradley"
            ],
            "title": "Validation of an automated algorithm for detecting apneas and hypopneas by acoustic analysis of breath sounds",
            "venue": "Sleep Medicine, vol. 14, no. 6, pp. 562\u2013571, 2013.",
            "year": 2013
        },
        {
            "authors": [
                "G. Sierra",
                "V. Telfort",
                "B. Popov",
                "L.G. Durand",
                "R. Agarwal",
                "V. Lanzo"
            ],
            "title": "Monitoring respiratory rate based on tracheal sounds. First experiences",
            "venue": "Proceedings of the IEEE Engineering in Medicine and Biology Society Conference 2004, pp. 317\u2013320, California, CA, USA, September 2004.",
            "year": 2004
        },
        {
            "authors": [
                "S. Saha",
                "M. Kabir",
                "N. Montazeri Ghahjaverestan"
            ],
            "title": "Portable diagnosis of sleep apnea with the validation of individual event detection",
            "venue": "Sleep Medicine, vol. 69, pp. 51\u201357, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "M. Tenhunen",
                "E. Huupponen",
                "J. Hasan",
                "O. Heino",
                "S.L. Himanen",
                "L. Himanen"
            ],
            "title": "Evaluation of the diferent sleep-disordered breathing patterns of the compressed tracheal sound",
            "venue": "Clinical Neurophysiology, vol. 126, no. 8, pp. 1557\u20131563, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "F. Jin",
                "F. Sattar",
                "D.Y.T. Goh",
                "I.M. Louis"
            ],
            "title": "An enhanced respiratory rate monitoring method for real tracheal sound recordings",
            "venue": "Proceedings of the 17th European Signal Processing Conference, pp. 642\u2013645, Scotland, UK, August 2009.",
            "year": 2009
        },
        {
            "authors": [
                "Y. Nam",
                "B.A. Reyes",
                "Ki H. Chon"
            ],
            "title": "Estimation of respiratory rates using the built-in microphone of a smartphone or headset",
            "venue": "Ieee Journal of Biomedical andHealth Informatics, vol. 20, no. 6, pp. 1493\u20131501, 2016.",
            "year": 2016
        },
        {
            "authors": [
                "R. Palaniappan",
                "K. Sundaraj",
                "S. Sundaraj"
            ],
            "title": "Adaptive neuro-fuzzy inference system for breath phase detection and breath cycle segmentation",
            "venue": "Computer Methods and Programs in Biomedicine, vol. 145, pp. 67\u201372, 2017.",
            "year": 2017
        },
        {
            "authors": [
                "Y. Fang",
                "Z. Jiang",
                "andH.Wang"
            ],
            "title": "A novel sleep respiratory rate detection method for obstructive sleep apnea based on characteristic moment waveform",
            "venue": "Journal of Healthcare Engineering, vol. 018, pp. 1\u201310, Article ID 21902176, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "T. Emoto",
                "U.R. Abeyratne",
                "M. Akutagawa",
                "S. Konaka",
                "Y. Kinouchi"
            ],
            "title": "High frequency region of the snore spectra carry important information on the disease of sleep apnoea",
            "venue": "Journal of Medical Engineering and Technology, vol. 35, no. 8, pp. 425\u2013431, 2011.",
            "year": 2011
        },
        {
            "authors": [
                "L. Almazaydeh",
                "K. Elleithy",
                "M. Faezipour",
                "A. Abushakra"
            ],
            "title": "Apnea detection based on respiratory signal classifcation",
            "venue": "Procedia Computer Science, vol. 21, pp. 310\u2013316, 2013.",
            "year": 2013
        },
        {
            "authors": [
                "J. Xie",
                "X. Aubert",
                "X. Long"
            ],
            "title": "Audio-based snore detection using deep neural networks",
            "venue": "Computer Methods and Programs in Biomedicine, vol. 200, Article ID 105917, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "F. Shen",
                "S. Cheng",
                "Z. Li",
                "K. Yue",
                "W. Li",
                "L. Dai"
            ],
            "title": "Detection of snore from OSAHS patients based on deep learning",
            "venue": "Journal of Healthcare Engineering, vol. 2020, pp. 1\u201310, Article ID 8864863, 2020.",
            "year": 2020
        },
        {
            "authors": [
                "T. Ganchev",
                "N. Fakotakis",
                "G. Kokkinakis"
            ],
            "title": "Comparative evaluation of various MFCC implementations on the speaker verifcation task",
            "venue": "Proceedings of the SPECOM-2005, no. 1, pp. 191\u2013194, Patras, Greece, October 2005.",
            "year": 2005
        },
        {
            "authors": [
                "P. Wang",
                "C.S. Lim",
                "S. Chauhan",
                "J.Y.A. Foo",
                "V. Anantharaman"
            ],
            "title": "Phonocardiographic signal analysis method using a modifed hidden markov model",
            "venue": "Annals of Biomedical Engineering, vol. 35, no. 3, pp. 367\u2013374, 2007.",
            "year": 2007
        },
        {
            "authors": [
                "R. Zhang",
                "J. Liu"
            ],
            "title": "An improved multi-band spectral subtraction using mel-scale",
            "venue": "Procedia Computer Science, vol. 131, pp. 779\u2013785, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "M. Bahoura"
            ],
            "title": "Pattern recognition methods applied to respiratory sounds classifcation into normal and wheeze classes",
            "venue": "Computers in Biology and Medicine, vol. 39, no. 9, pp. 824\u2013843, 2009.",
            "year": 2009
        },
        {
            "authors": [
                "I. Mazic",
                "M. Bonkovic",
                "B. Dzaja"
            ],
            "title": "Two-level coarse-to-fne classifcation algorithm for asthma wheezing recognition in children\u2019s respiratory sounds",
            "venue": "Biomedical Signal Processing and Control, vol. 21, pp. 105\u2013118, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "S. Sun",
                "H. Wang",
                "Z. Jiang",
                "Y. Fang",
                "T. Tao"
            ],
            "title": "Segmentation-based heart sound feature extraction combined with classifer models for a VSD diagnosis system",
            "venue": "Expert Systems with Applications, vol. 41, no. 4, pp. 1769\u20131780, 2014. Journal of Healthcare Engineering 13",
            "year": 2014
        }
    ],
    "sections": [
        {
            "heading": "Research Article",
            "text": ""
        },
        {
            "heading": "Monitoring of Sleep Breathing States Based on Audio Sensor",
            "text": ""
        },
        {
            "heading": "Utilizing Mel-Scale Features in Home Healthcare",
            "text": "Yu Fang ,1,2 Dongbo Liu ,1,2 Zhongwei Jiang ,2 and Haibin Wang 1\n1School of Electrical Engineering and Electronic Information, Xihua University, Chengdu 610000, China 2Graduate School of Science and Technology for Innovation, Yamaguchi University, Ube 755-0096, Japan\nCorrespondence should be addressed to Dongbo Liu; daniel_lb@126.com\nReceived 4 February 2022; Revised 3 July 2022; Accepted 24 November 2022; Published 9 February 2023\nAcademic Editor: Kunal Pal\nCopyright \u00a9 2023 Yu Fang et al.Tis is an open access article distributed under the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.\nSleep-related breathing disorders (SBDs) will lead to poor sleep quality and increase the risk of cardiovascular and cerebrovascular diseases which may cause death in serious cases. Tis paper aims to detect breathing states related to SBDs by breathing sound signals. Amoment waveform analysis is applied to locate and segment the breathing cycles. As the core of our study, a set of useful features of breathing signal is proposed based on Mel frequency cepstrum analysis. Finally, the normal and abnormal sleep breathing states can be distinguished by the extracted Mel-scale indexes. Young healthy testers and patients who sufered from obstructive sleep apnea are tested utilizing the proposedmethod.Te average accuracy for detecting abnormal breathing states can reach 93.1%. It will be helpful to prevent SBDs and improve the sleep quality of home healthcare."
        },
        {
            "heading": "1. Introduction",
            "text": "Healthcare-related issues have become the hot spots of society around the world. Among them, sleep quality plays an important role in health management. Poor sleep quality caused by sleep-related breathing disorders will impact peoples\u2019 daily life seriously. SBDs mainly include obstructive sleep apnea (OSA), central sleep apnea (CSA), and the mixed type. OSA which means the obstruction of the upper airway primarily due to the fabby tongue and uvula, is the most common SBD, CSA would cause sleep breathing apnea by the problem of the brain, and another type is the case mixed with the OSA and CSA [1]. Te breathing abnormalities of SBDs are apnea, hypopnea, and snore. An apnea event lasts more than 10 seconds, and it can lead to a lower oxygen supply to the brain [2]. Te ventilation of hypopnea will reduce to less than 50% ofnormal ventilation, and it will cause the value of oxygen levels to decline by more than 4% compared with the median. Snore is generated by a partial obstruction of the upper airway and is recognized as a vital sign of SBDs prevention [3]. Te most harmful thing about these abnormal breathing states is the reduction of the oxygen supplement to the heart and brain. SBDs will lead to\nthe complications of cardiovascular diseases and increase the risk of diabetes, cerebral stroke, and Alzheimer\u2019s disease [4, 5].\nSBDs are not exclusive to the older as we thought, they will occur for diferent age groups and the morbidity is increasing in recent twenty years [6].Tere is much evidence of the general population lacking awareness of SBDs, more than 20% of adults are sufering from SBDs with diferent levels, yet less than 25% of SBDs suferers realized that they have been disturbed by the bad sleep health condition [1]. And the high cost of the existing clinical means keeps people from getting tests and treatment.\nIn the clinic, polysomnography (PSG) is the golden standard and the only way to provide the Apnea-Hypopnea Index (AHI) exactly for diagnosing SBDs. However, dozens of sensors used for PSG are not only costly but also complicated for common patients [7]. Hence, a smart and portable monitoring measure with the least sensors is imperative for home healthcare of SBDs.\nTe smart wearable with sensors is a new trend in the smart monitoring system of long-life diseases [8, 9], especially for the increasing demand for home healthcare. Researchers have applied diferent kinds of sensors, such as\nHindawi Journal of Healthcare Engineering Volume 2023, Article ID 6197564, 13 pages https://doi.org/10.1155/2023/6197564\nlight sensors [10] and inertial sensors, to monitor the sleep condition by respiratory rate and breathing pattern analysis [11]. Researchers used the ultrasonic radar to normal and abnormal breathing activity [12] and used a thermal imaging camera to diagnose breathing disorders [13]. Researchers also used the sound sensors set near the nose and mouth to record the breathing sound signal for detecting apnea and hypopnea events by a set of pattern recognition rules [14]. Some researchers recorded tracheal signals from the throat to acquire the respiratory rate or set the sound sensor to the skin in a suprasternal notch to evaluate the breathing pattern in the high-frequency range [15, 16]. In previous studies, the sound sensors with smaller contact areas and easier operation are applied to record the breathing sound signal for sleep breathing monitoring [17]. As described above, these abnormal breathing states of SBDs will lead to decreasing ventilation while inspiration and expiration. Te changes of ventilation can be refected by diferent breathing states, such as snoring, apnea, hypopnea, and irregular breathing rate. Based on the production mechanism and physical signifcance of the abnormal breathing states, it is potential to detect the abnormality and health situation of sleep by breathing sound signals via a smart system with sound sensors.\nIn the research area of sleep monitoring based on breathing sound signals, many researchers focused on the respiratory rate detection based on the genetic algorithm [18], Hilbert transform [19], and neuro-fuzzy method [20] to analyze SBDs. In our previous study [21], a moment waveform analysis was proposed to segment the breathing cycles for respiratory rate detection. And snoring detection has been discussed to evaluate the level of SBDs [22]. And some researchers used the respiratory phase analysis to detect apnea [23]. Xie et al. proposed a deep learning method with a 2D spectrogram to detect snoring in various sleeping positions, based on constant Q transformation [24]. Shen et al. used CNN and LSTM to identify the snoring of OSAHS patients based on MFCC, LPCC, and LPMFCC and extracted the AHI index to evaluate the severity of OSAHS [25].\nIt can be found that the segmentation of breathing sound and the detection of breathing states are crucial for sleep monitoring and SBDs diagnosis. However, there are two problems. One problem is how to reduce the computational complexity of the analysis algorithms for the long-time data, that is, the real-time capability. Another one is how to guarantee the accuracy of the detection results. Most of the existed research always focused on a short period of the breathing signal, and the accuracy of the analysis results is not sufcient for healthcare. Our research aims to detect abnormal breathing states related to the SBDs such as apnea, hypopnea, and irregular breathing in a simple and fast way by a portable system.\nTis study keeps the ventilation of oxygen and carbon dioxide while sleep in mind and proposes a method to detect sleep breathing states based on Mel frequency cepstrum analysis by a portable acquisition system of breathing sound signal. In Section 2, the acquisition of breathing sound signal\nutilizing the sound sensor is introduced. Te test condition and testers are also referred briefy. Ten, the segmentation of breathing cycles is sketched in Section 3 as the preprocessing for the further analysis. Section 4 describes the proposed detection method based on Mel frequency cepstrum analysis in detail, including the feature extraction and the identifed rules of diferent sleep breathing states. Experiments and results can be found in Section 5. Finally, the discussion and conclusion are summarized in Sections 6 and 7, respectively."
        },
        {
            "heading": "2. Wearable Acquisition System with Sound Sensor",
            "text": "A wireless sound sensor and a commercial headset (Plantronics, M165) were applied to record sleep breathing data during the whole night. Te M165 is very light and easily-operated. It is indeed a cheap and easy use for smart sleep healthcare in daily life. Te acquired breathing data will be transmitted to a smartphone by Bluetooth and stored in mp3 format which is convenient for computerized analysis. Te parameters of audio fles can be set by an APP developed by our team. In this study, the sampling frequency is 44.1 kHz. Te environment of data acquisition is shown in Figure 1. Te headset is fxed to the nose by a strip of cosmetic tape. As we mainly focus on the changes in breathing airfow, the breathing sound signal from the nose and mouth can be recorded as long as the headset does not fall of and the tester is almost unafected while sleeping whether at home or not.\nAt the beginning of preprocessing, the original sample frequency will be down-sampled to 11.025 kHz to reduce the computation amount. Te real sleep breathing sound signal recorded by our system is shown in Figure 2. Figure 2(a) is one-night sleep breathing sound data. Te recording lasts about 5 hours, and the intensity of breathing changes greatly. Figure 2(b) is a part of stable normal breathing sound data from the ffth hour and Figure 2(c) is a part of complex breathing sound data from the third hour. Tere are some obvious breathing pauses shown in Figure 2(c), and they are related to the obstruction of the airway. Hence, there is a high potential to identify diferent abnormal breathing states, such as apnea, hypopnea, unstable respiratory rate, and snore, from the breathing sound signal acquired via a portable and wireless sensor. Eight volunteers are selected as testers, including four in twenties, two in thirties, and two in Fifties.Te study was approved by the ethics committee of Chengdu Region General Hospital (No. 2015 research 01). All testers\u2019 consent was obtained before participating in the study. Te twenties and thirties were tested by Epworth sleepiness score (ESS), the scores were all less than 9, which was normal. Te elder testers are diagnosed with moderate OSA and severe OSA by PSG with AHI \ufffd 16 and 32, respectively. All the testers have monitored for the whole night lasting more than fve hours. Te breathing cycles of onenight data are counted, and the breathing states are manually labeled under the guidance of a professional physician for further analysis."
        },
        {
            "heading": "3. Segmentation of Sleep Breathing Signal Based on Characteristic Moment Waveform Analysis",
            "text": "To identify the breathing state accurately, the breathing cycle should be segmented for further analysis. A brief introduction of the segmentation method is presented in this section. Te details can be found in our previous work [21].\nTe enhanced processing for amplitude contrast diminution has been performed frst to reduce the efect of the weak breathing issues during the whole night\u2019s sleep.\nTe precondition assumes the noise part of the sleep breathing sound signal as a signal with zero-mean and unit variance. Suppose the sleep breathing sound signal is r(t), the random noise signal is n(t), and the real output signal is y(t) \ufffd r(t) + n(t), time characteristic waveform (TCW) of sleep breathing sound signal, denoted by c(t, \u03b4), defned as the variance of the output y(t) can be given by the following equations:\nc(t, \u03b4) \ufffd  t+\u03b4\nt\u2212\u03b4 (y(t) \u2212 y(t))\n2d\u03c4 \ufffd  t+\u03b4\nt\u2212\u03b4 y(\u03c4)2d\u03c4 \u2212 2\u03b4y(t)2, (1)\ny(t) \ufffd 1 2\u03b4  t+\u03b4 t\u2212\u03b4 y(\u03c4)d\u03c4. (2)\nTen, the characteristic moment waveform (CMW) is calculated by the thought of image shape identifcation in image processing with another time scale l, which is represented by I(t, \u03b4, l). It is calculated according to the following equation:\nI(t, \u03b4, l) \ufffd  t+l\nt\u2212l (\u03c4 \u2212 t)2c(\u03c4, \u03b4)d\u03c4. (3)\nFor a discrete signal with length N, the computations of TCW and CMW only need 8 N and 15 N additions and multiplications, respectively. Te algorithm can process the whole night data fast, and it will be helpful for real-time motoring.\nAccording to our experimental statistic, the scale l is usually set to (1.5, 3), about half of the sleep breathing cycle. Te time scale \u03b4 is set as 0.1, about 1/10 of the phase duration. After choosing the suitable time scales, TCW and CMW can be extracted by equations (1) to (3). Cmin of CMW is the local minimum point sequence which would be calculated frst. Ten, the local maximum points sequence T max of TCW can be found by a computation windowwith Cmin as the central points. Te local maximum point sequence of CMW can be obtained as the cycle segmentation points and adjusted according to T max. Finally, the incorrectly segmented breathing pauses will be combined utilizing a threshold value by the average amplitude of the test data.\nTe breathing cycle segmentation result of partial normal breathing signal is shown in Figure 3."
        },
        {
            "heading": "4. Detection of Breathing States via Mel Frequency Cepstrum Analysis",
            "text": "During the whole night\u2019s sleep, the sleep breathing state changes greatly. Besides the apnea, there are the hypopnea events, snore events, and others as shown in Figure 4. In Figure 4, two types of irregular breathing events are found and shown by blue and orange boxes. Tey are all related to the obstruction of the upper airway. Te breathing parts marked by blue boxes display the changed respiratory rate. By hearing, they mix with noise caused by the movements of the nose and mouth. It is easy to fnd that the breathing parts of orange boxes have higher amplitude with the extended or merged inspiration/expiration. And they sound similar to labored breathing and can be classifed as a kind of snore.\nDifering from the apnea with a clear defnition in the time domain, other complex breathing states cannot be detected in the time domain. According to the previous research, the distribution of frequency energy would be very diferent between the normal and abnormal breathing states. From the time-frequency representation, the breathing case with apnea has much more energies below 500Hz and above 3500Hz compared with the normal case. It provides a probable way to distinguish the diferent breathing states in the frequency domain.\n4.1. Te Conventional MFCCs Analysis. Psychophysical studies have shown that human perception of the frequency content of sounds does not follow a linear scale. Te Mel frequency cepstrum coefcients (MFCCs) were proposed as it is very similar to perceptual linear predictive analysis of sound [26]. MFCCs were derived from the short time spectrum of a signal and were widely used both for speech and speaker recognition [27, 28]. MFCCs have already been applied to extract features of respiratory sound in combination with learning machines to recognize the wheeze for respiratory disorders [29, 30].\nFirst of all, framing and windowing are applied for the conventional MFCC algorithm.Ten, fast Fourier transform (FFT) is used to transform the signal of each frame from the time domain to the frequency domain. Ten, the energy\nspectrum is calculated. Next, the energy signal is fltered by the Mel-scale flter bank and processed in the logarithm orderly. At last, discrete cosine transform would transform the signal into the time domain and extract a series of coefcients.\nAs the core of MFCCs, the relationship between Mel frequency and real frequency is defned as follows:\nMel(f) \ufffd 1000\u2217 lg (1 +(f/700)) lg (1 +(1000/700)) , (4)\nwhere f is the real frequency and Mel(f) is the Mel-scale frequency. As the human perception of the frequency content is almost linear below 1 kHz and nonlinear over 1 kHz, 1000 is a key parameter to determine the relationship of f and Mel(f) simulating the character of the human ear. 700 is the parameter that afects the relationship\u2019s changing trend between f and Mel(f).\nFor the frequencies under 1000Hz, the Mel scale can be approximated to a linear scale. Mel frequency can represent the details of the low-frequency range more accurately than the high-frequency range. Hence, it can capture formants that lie in the low-frequency range.\nTe Mel flter bank is designed based on Mel-scale frequency. Te Mel-scale frequency distributes uniformlyspaced in Mel scale, simulating the critical frequency bands of the human ear. Te center of each triangle window is the starting of the next one.\nTe logarithm is used to compress the components above 1000Hz. And it can translate the multiplicative components into the additive ones and reduce the computation complexity [26]. A logarithm can provide the frequency energy distribution of a one-time point in the form of addition. Finally, the Mel frequency cepstrum coefcients will be extracted by discrete cosine transform.\nOur purpose is to fnd the relationship between the frequency energy distribution and the monitoring time. Te results of the processing after the logarithm should be paid attention to in this study.\n4.2. Analysis of Breathing Sound Signal Based on Mel Frequency Cepstrum Analysis. Here, we proposed a method of parameters extraction to detect diferent breathing states, and the fowchart is displayed in Figure 5.\nAs shown in Figure 5, window screening is the frst step and the length of the rectangle window is set as 1024 sample points, about 100ms according to the sampling frequency. Te windowmoves foreword by overlapping the half of itself to keep enough details of the observation. Ten, the frequency energy distribution of the breathing sound signal would be calculated by power spectrum density (PSD) in the second step. Te PSD estimation is an important part of modern signal processing and refects the energy distribution of the frequency component of the signal. Te autoregressive (AR) method is the most frequently used parametric method because the estimation of AR parameters can be performed easily by solving the linear question. Here, Yule\u2013Walker\u2019s method is used to make the power spectrum density instead of the energy of the FFT result. Te order of\nan autoregressive prediction model for the signal is set as 32 [31].\nIn the third step, the energy of the signal is fltered by the Mel frequency flter banks including 20 triangle flters. Te triangle flter bank is selected by default in speech processing shown in Figure 6, which simulates the auditory characteristics of the human ear. Te mathematical expression of the triangular window is simple, reducing the amount of computation.\nAnd the 20-dimension Mel-scale features are extracted after the logarithm operation in the fourth step. Te horizontal of the feature matrix represents frames of observation time. Te vertical of the matrix represents the Mel-scale flters of the flter bank.\nTo stand out the frequency energy distribution of each frame, a new feature set has been proposed in the ffth step, the core of our proposed method. Te procedure of the proposedmethod to extract the efective features is described in detail. Te sketch map of extraction for one breathing cycle can be found in Figure 7 to illustrate the algorithm.\n(a) Extract the Mel-scale features of one segmented breathing cycle according to the frst four steps of the fowchart in Figure 5. Te Mel-scale features fi,j can be displayed by the stretch map shown in Figure 7(b). i is the label of the triangle flters of the Mel frequency flter bank in the frequency domain, from 1 to 20. j is the number of\nframes in the time domain, from 1 to N. N is the total number of frames of each breathing cycle.\n(b) Find the maximum point of each column of fi,j, denoted by Ai,j.\ni is corresponding to the label of the Mel-scale flter and represents a fxedMel-scale frequency range.We proposed it as Mel-scale label (MsL) as shown in Figure 7(c). Te X-axis is the frame number, and Yaxis is the Msl. MsL can be explained by the main part of frequency energy distributing in one observed duration in the time domain.\n(c) Compute the present times of each MsL to represent the distribution of frequency energy in each cycle, marked as NMsL which is shown in the bar chart of Figure 7(d). MsL and NMsL are proposed to detect the abnormal breathing sound signal. For the normal breathing cycle shown in Figure 7(a), it is found that the label number i of MsL is from 4 to 14 in the duration of inspiration and expiration compared with the breathing stopping intervals as shown in Figure 7(c). So, the frequency energy of this breathing cycle is mainly fltered by the No. 4 to No. 14 Mel-scale flter as same as the results of NMsL shown in Figure 7(d).\nAfter all the fve steps, we can use MsL and NMsL to analyze the components of the breathing sound signal and to detect the abnormal breathing states fnally. Te results of\ndetecting abnormal breathing states will be demonstrated in the next section."
        },
        {
            "heading": "5. Experiment",
            "text": "5.1. Analysis of Breathing Sound Signal by the Proposed Identifcation Method. Te label of Mel-scale features, MsL, and the corresponding NMsL in each segmented breathing cycle during one-night monitoring can be extracted. Te energy of distribution in a fxed frequency range is useful to present the features of diferent breathing states. We mainly separate snoring, normal breathing, and abnormal breathing components of the breathing signal.\nIt is found that the MsL in the low-frequency range can represent the snore component. Te normal breathing component is usually represented by MsL in the middlefrequency range. Te abnormal breathing components including apnea, hypopnea, and irregular breathing rate can be expressed by MsL in the high-frequency range. Checking results manually by ear and eye is the reference under the guidance of a professional doctor.\nSo, three MsL sets are proposed, i.e., low-frequency label set, middle-frequency label set, and high-frequency label set and marked as FL, FM, and FH, respectively, in Figure 8.\nFor diferent individuals, there would be a little diference when we partition these three MsL sets. Based on the experimental attempts, the common part of each MsL set is selected for the further analysis, that is, MsL2 for the snore detection, MsL4 to MsL7 for the normal breathing state\ndetection, and MsL15 to MsL17 for the abnormal breathing state detection. To detect diferent breathing components in each breathing cycle, threshold values are applied and displayed by red lines in Figure 8. As the time duration of inspiration and expiration lasts about 2.5 seconds in one breathing cycle according to our experimental dataset, the total NMsL equals the total number of frames, about 50 times. Hence, according to the experiment results and observation, the threshold values for FM and FH are set by 40% of the total NMsL of eachMsL, about 20 times. And the threshold value of FL is set by 20% of the total number CLi of each MsL, about 10 times.\nIf NMsL is larger than the red threshold line, the corresponding cycle can be symbolized by 1, the opposite is 0. It is obvious that the breathing cycles with abnormal component always accompany the snoring component. Te abnormal component and normal component do not exist at the same time in the usual case from Figure 8. So, it is the potential to detect diferent kinds of breathing states based on these three MsL sets.\nIf there is \u20181\u2019 of FH, the breathing state can be detected as abnormal. If there is \u20180\u2019 of FH, combined with the detection results of FM, heavy breathing can be identifed from the normal states which can be checked by the ear.\nTe snore can be divided into the normal type and the abnormal type. Normal snore is related to simple snoring, and abnormal snore is related to SBDs. However, they all should be concerned. So, the snore is detected separately from other abnormal breathing states and listed for a useful index. If there is \u20181\u2019 in FL, the breathing cycle is identifed as breathing with snore.\nTe study focuses on the ratio of abnormal breathing states during the monitoring for sleep healthcare management in the early stage. Obviously, the subclassifying of breathing types is a rough judgment now and it will be applied to a deeper discussion of accurate analysis for SBDs in the future work."
        },
        {
            "heading": "5.2. Application for the Sleep Breathing States Detection.",
            "text": "Te identifed results by MsL sets for an OSA tester (AHI \ufffd 16) are shown in Figure 9. Figure 9(a) displays the detection results of normal/abnormal sleep state. Te abnormal sleep breathing cycle is denoted by \u20181\u2019 and the normal sleep breathing is \u20180\u2019 based on the identifcation rules introduced in the last subsection. It is easy to compute the time duration of normal and abnormal breathing state lasting during the whole night. In this case, the normal breathing lasts 2.8 hours, and the abnormal breathing lasts 2.2 hours. Figure 9(b) displays the detection result of snoring. Te breathing cycle with snore is marked as \u20181,\u2019 and the snore lasts 1.8 hours of the whole night totally.\nTe time duration of breathing stop from the audio waveforms can distinguish the apnea and typical hypopnea from normal breathing states. For apnea, the breathing stop is larger than 10 s. As the ventilation of hypopnea will reduce to less than 50% of the normal ventilation, the breathing stop of the typical hypopnea is calculated from 6 s to 10 s according to the clinical defnition of apnea and hypopnea [2]. Irregular breathing rate can be picked up by comparing with the normal parts.\nFrom the original breathing waveforms of A1 to A3 shown in Figure 10, two parts of the breathing signal in each\nsection are shown orderly. It can be found that there is obvious apnea (such as A1-1, A3-1, and A3-2), hypopnea (such as A1-2), irregular breathing (such as A1-1, A2-1, and A2-2), and breathing with noise caused by the body movement (such as A2-1) from the waveforms in time domain clearly. Sections A1 to A3 belong to the abnormal breathing states with snore.\nFrom the original breathing waveforms of N1 and N2 shown in Figure 11, these two sections are normal stable breathing, and breathing of N2 is snoring. Te red line in Figure 10 is the envelope of the spectrum, and it is easy to fnd that there is a large energy in the middle-frequency range (500\u20131500Hz), representing the normal breathing component for both N1 and N2. Te amplitude of N2 is higher than N1. And the higher ratio of frequency energy distributes below 500Hz is the main feature of snore shown in section N2.\nApplying the proposed method based on Mel-scale features, the monitoring results of all the testers are listed in Table 1. We can fnd the total time of the whole night monitoring and the time durations of diferent breathing states. To evaluate the sleep quality, the ratio of the normal breathing during the night is computed by the following equation:\nRSleep \ufffd TNormal\nTMonitoring , (5)\nwhere RSleep is used to test the quality of sleep by the detection of normal breathing state, TNormal is the total time duration of normal breathing state lasting, and TMonitoring is the total time duration of the sleep monitoring. It will be a meaningful index to know and manage sleep health in one\u2019s daily life.\nAccording to the detected results of breathing states, the ratio of normal breathing states is over 70% for testers no. 1, 2, 3, and 5 which is higher than the OSA testers no. 7 and 8, which were diagnosed by PSG. Testers No. 4 and 6 have lower ratios of normal breathing state and there are indeed a lot of apnea and hypopnea events during the monitoring\nprocedure by checking up on the original breathing signal. Testers no. 4 and 6 were diagnosed as severe rhinitis by the doctor during the experimental period. Actually, after the relief from rhinitis symptoms, the results of monitoring are within the normal range. Te extreme cases of young testers can also show the efciency of the proposed method.\nMoreover, it is found that the testers with a low ratio of normal breathing state always snore with a longer time\nduration. Hence, snore is really an important sign related to the analysis and prevention of sleep breathing-related disorders.\nTe accuracy of detecting normal and abnormal breathing states can be given based on the prepared manual labels in our experiment, and the accuracy of our proposed method of the testers can reach 95.2% shown in Table 1, and the average value is 93.1%."
        },
        {
            "heading": "6. Discussion",
            "text": "In the studies of breath state detection by breath sound signal, some researchers used the measurement of energy to detect apnea events during the breath and breath hold [23]. From [24] in Table 2, it can be seen that the MFCC feature parameters are themost efective in classifying snores among the three features used. Using MFCC combined with the LSTM method can achieve 87% accuracy. At the same time, the AHI index was also estimated. Although there is a particular gap with the AHI value detected by PSG, it can be used as an auxiliary reference in the classifcation of OSAHS. It can also be found that the average accuracy of snoring recognition of OSA patients and normal people is 95.3% by combining deep learning and two-dimensional spectral features in [25]. Literature [23] used spectral energy and VAD criterion threshold for apnea detection for simulated apnea signals and achieved an accuracy of 97%. Still, it is not applied to the actual breathing signals of OSA patients, nor does it mention hypopnea detection.\nTe method in this paper does not use classical machine learning and deep learning methods, so the amount of calculation is small. Moreover, the threshold displays the fact between the characteristic parameters and the breathing signal. At the same time, the normal and abnormal breathing and snoring sounds are distinguished. Te accuracy rate of 93.1% can be achieved by judging normal and abnormal\nbreathing. Te judgment of abnormal breathing includes apnea, hypopnea, and other respiratory disturbance events. However, due to the small amount of breathing data and individual diferences among testers, there is a state of misjudging normal breathing as snoring in snoring detection. It is necessary to refne the types of abnormal breathing and accurately fnd them for the intervention in continuous work.\nSome researchers combined a sound sensor, accelerometer, and pulse oximeter to get AHI index for SBDs [16]. Moreover, the degree of blood oxygen saturation (SpO2) acquired by the pulse oximeter is a vital index for the respiratory system in the clinic. Te SpO2 will decrease when there is an obstruction in the upper airway; that is, apnea, hypopnea, and irregular breathing will accompany the lower value of SpO2.\nHence, SpO2 has been monitored for the testers as well and the abnormal breathing states can be evaluated by subtracting a fxed value from the medium value of SpO2. In our experiment, it is easy to fnd that the results of SpO2 are included in the scope of the proposed detection. Te comparison results with SpO2 are given in Figure 12. Te red line represents the median value of the tester\u2019s SpO2. It can be seen that the period when SpO2 has a signifcant decrease compared to the median value is detected as an abnormal breathing state which matches the detection results.\nTa bl\ne 2:\nSu m m ar y of\npr ev io us\nst ud\nie s on\nbr ea th in g st at es\nde te ct io n by\nac ou\nst ic\nsig na l.\nA ut ho\nrs M et ho\nd Fe at ur es\nD at as et\nSn or e de te ct io n re su lts\nA bn\nor m al\nde te ct io n\nre su lts\n[2 3]\nV oi ce\nac tiv\nity de te ct io n\nal go ri th m\nFF T\n50 no\nrm al\npe op\nle br ea th\n20 cy cl es\nan d ho\nld th ei r br ea th to m ak e th e ap ne a\nN ot\nm en tio\nne d\nA pn\nea de te ct io n ac cu ra cy\nm or e\nth an\n97 %\n[2 4]\nC N N + RN\nN C Q T sp ec tr og ra m\nPa rt\nof fu ll ni gh\nt re co rd in gs\nfr om\n38 su bj ec ts\nA cc ur ac y: 95 .3 %\nN ot\nm en tio\nne d\n[2 5]\nC N N + LS\nTM M FC\nC ,L\nPC C an d\nLP M FC\nC W ho\nle ni gh\ntr ec od\nin g fr om\n32 vo lu nt ee rs\nA cc ur ac y:\n87 %\nC al cu la te\nA H I va lu es\nT is st ud\ny T\nre sh ol d va lu es\nfo r\nin di vi du\nal s\nM el -s ca le -b as ed\nfe at ur es\nFu ll ni gh\nts re co di ng\nfr om\n8 te st er s\nA cc ur ac y: 96 .1 %\nA cc ur ac y:\n93 .1 %\nHowever, the abnormalities caused by the light obstruction of the airway can be pointed out by the proposed detection, which is not clearly defned. It may be related to the threshold values set by our proposed detection. More types of abnormal breathing states will be discussed deeply in future work. And because the tapes may become loose and the microphone\u2019s location may change occasionally, the acquisition system should be developed. And the classifcation and identifcation of breathing states are further refned. Te analysis of the hypopnea state is limited by the small amount of experimental data and cannot be further refned and analyzed.\nIn other words, the tester dataset should be enlarged and the types of abnormal breathing states should be discussed in detail. We will optimize the ranges of MsL sets to analyze the components of breathing sound signal, such as dividing diferent frequency ranges to show more precise results. Te relationship between our defnitions of abnormal breathing and the pathological characteristics of SBDs will be discussed deeply in further study."
        },
        {
            "heading": "7. Conclusion",
            "text": "In this study, the sound sensor and microphone in a headset with Bluetooth were utilized to record and transmit the breathing sound signal during the whole night. Te portable and wireless acquisition system proposed in this paper has less impact on sleep quality and can be operated simply anywhere. And the MFCCs are introduced from speech signal processing to the processing of breathing signal for sleep monitoring in-home healthcare. TeMsL representing the main distribution of frequency energy in each frame is proposed to detect the diferent sleep breathing states. In addition, the data acquisition operation is simple, the cost of detection is low, and the accuracy can satisfy individual monitoring needs. Recognition of respiratory status and detection of abnormal breathing can be popularized in daily monitoring. It can also be used as an aid for clinical diagnosis based on a more detailed analysis of the results. Te study is limited by the small amount of experimental data, so the classifcation and identifcation of breathing need to be\nfurther improved, and the adaptability and accuracy of the algorithm need to be further enhanced. Although it has particular reference signifcance for the long-term sleep monitoring of individuals, the algorithm is still unstable in monitoring diferent people.\nTe core of the Mel frequency analysis is to refect the relationship between the monitoring time and the frequency energy simulating the acoustic character of the human ear. For each frame in the time domain, the MsL is extracted by fnding the maximum value of the frequency energy in each Mel scale.Ten, the present times of eachMsL are computed to show the frequency energy distribution of each segmented breathing cycle. Tree MsL sets are determined corresponding to the normal breathing component, abnormal breathing component, and snore component, denoted by FM, FH, and FL. Finally, with the suitable threshold values and comprehensive evaluation rules, the normal breathing state, abnormal state, and snore state can be detected successfully. Te types of sleep breathing states should be discussed deeply and classifed accurately for examination and analysis of SBDs. And for diferent individuals, longtime monitoring and big data analysis are necessary to acquire more precise monitoring results for the prevention and treatment of SBDs in the future."
        },
        {
            "heading": "Data Availability",
            "text": "Te data used to support the fndings of this study are available from the corresponding author upon request."
        },
        {
            "heading": "Conflicts of Interest",
            "text": "Te authors declare that they have no conficts of interest."
        },
        {
            "heading": "Acknowledgments",
            "text": "Tis study was supported by the National Natural Science Foundation of China (Grant no. 61901393), the Ministry of Education \u201cchunhui project\u201d of China (Grant no. Z2018118), the National Natural Science Foundation of China (Grant no. 61571371), and the Talented Penson Projects of School (Grant nos. Z201087 and Z202088)."
        }
    ],
    "title": "Monitoring of Sleep Breathing States Based on Audio Sensor Utilizing Mel-Scale Features in Home Healthcare",
    "year": 2023
}