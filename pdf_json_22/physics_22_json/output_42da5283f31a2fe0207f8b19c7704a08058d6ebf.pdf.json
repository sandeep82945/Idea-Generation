{
    "authors": [
        {
            "affiliations": [],
            "name": "Timo Eichhorn"
        },
        {
            "affiliations": [],
            "name": "Christian Hoelbling"
        },
        {
            "affiliations": [],
            "name": "Philip Rouenhoff"
        },
        {
            "affiliations": [],
            "name": "Lukas Varnhorst"
        }
    ],
    "id": "SP:83b9a18381c4dc911f4173e81d19fae3c4dc90a6",
    "references": [
        {
            "authors": [
                "B. Alles",
                "G. Boyd"
            ],
            "title": "M",
            "venue": "D\u2019Elia, A. Di Giacomo and E. Vicari, Hybrid Monte Carlo and topological modes of full QCD, Phys. Lett. B 389 ",
            "year": 1996
        },
        {
            "authors": [
                "L. Del Debbio",
                "G.M. Manca",
                "E. Vicari"
            ],
            "title": "Critical slowing down of topological modes",
            "venue": "Phys. Lett. B 594 ",
            "year": 2004
        },
        {
            "authors": [
                "S. Schaefer",
                "R. Sommer",
                "F. Virotta"
            ],
            "title": "Investigating the critical slowing down of QCD simulations",
            "venue": "PoS LAT2009 ",
            "year": 2009
        },
        {
            "authors": [
                "S. Durr"
            ],
            "title": "Physics of \u03b7\u2032 with rooted staggered quarks",
            "venue": "Phys. Rev. D 85 ",
            "year": 2012
        },
        {
            "authors": [
                "J. Smit",
                "J.C. Vink"
            ],
            "title": "Remnants of the Index Theorem on the Lattice",
            "venue": "Nucl. Phys. B 286 ",
            "year": 1987
        },
        {
            "authors": [
                "A.A. Belavin",
                "A.M. Polyakov",
                "A.S. Schwartz",
                "Y.S. Tyupkin"
            ],
            "title": "Pseudoparticle Solutions of the Yang-Mills Equations",
            "venue": "Phys. Lett. B 59 ",
            "year": 1975
        },
        {
            "authors": [
                "T. Eichhorn",
                "C. Hoelbling"
            ],
            "title": "Comparison of topology changing update algorithms",
            "venue": "PoS LATTICE2021 ",
            "year": 2112
        },
        {
            "authors": [
                "T. Eichhorn",
                "C. Hoelbling",
                "L.P. Rouenhoff"
            ],
            "title": "Varnhorst, Topology changing update algorithms for SU(3) gauge theory",
            "venue": "in 39th International Symposium on Lattice Field Theory,",
            "year": 2022
        },
        {
            "authors": [
                "A. Laio",
                "G. Martinelli",
                "F. Sanfilippo"
            ],
            "title": "Metadynamics surfing on topology barriers: the CPN\u22121 case",
            "venue": "JHEP 07 ",
            "year": 2016
        },
        {
            "authors": [
                "S. Elser"
            ],
            "title": "The Local bosonic algorithm applied to the massive Schwinger model",
            "venue": "other thesis, 3",
            "year": 2001
        },
        {
            "authors": [
                "A. Barducci",
                "G. Bussi",
                "M. Parrinello"
            ],
            "title": "Well-tempered metadynamics: A smoothly converging and tunable free-energy method",
            "venue": "Physical Review Letters 100 ",
            "year": 2008
        }
    ],
    "sections": [
        {
            "text": "P o S ( L A T T I C E 2 0 2 2 ) 2 5 3\nMetadynamics Surfing on Topology Barriers in the Schwinger Model\nTimo Eichhorn, Christian Hoelbling, Philip Rouenhoff\u2217 and Lukas Varnhorst Department of Physics, University of Wuppertal, Gau\u00dfstra\u00dfe 20, D-42119 Wuppertal, Germany\nE-mail: philip.rouenhoff@uni-wuppertal.de\nTopological freezing is a well known problem in lattice simulations: with shrinking lattice spacing a transition between topological sectors becomes increasingly improbable, leading to a problematic increase of the autocorrelation time regarding several observables. We present our investigation of metadynamics as a solution for topological freezing in the Schwinger model. Specifically, we take a closer look at the collective variable and its scaling behaviour, visualize the effects of topological freezing and how metadynamics helps in that respect and explore alternatives for a more efficient building process. Possible implications for and differences to four-dimensional SU(3) theory are briefly discussed.\nThe 39th International Symposium on Lattice Field Theory, LATTICE2022 8th-13th August, 2022 Bonn Germany\n\u2217Speaker\n\u00a9 Copyright owned by the author(s) under the terms of the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License (CC BY-NC-ND 4.0). https://pos.sissa.it/\nP o S ( L A T T I C E 2 0 2 2 ) 2 5 3"
        },
        {
            "heading": "1. Introduction",
            "text": "In order to generate configurations in an efficient manner, one has to rely on the method of importance sampling, the reason being that the probability of generating relevant configurations via simple sampling decreases drastically for increasing dimensions of the phase space. Importance sampling is usually implemented by means of Markov chain Monte Carlo algorithms, which per se involve generating configurations that are correlated with each other. For several interesting field theories (such as 2-dim. U(1) or 4-dim. SU(3) gauge field theories) one notices a dramatic increase of the autocorrelation time when approaching the continuum limit. This phenomenon, which is called topological freezing, ultimately thwarts correct measurements of observables and still poses an active topic of research [1, 2, 3, 4, 5]. One observable which is particularly prone to topological freezing is the topological charge \ud835\udc44, as can be seen in Fig. 1. It can be defined in both 2-dim. U(1) and 4-dim. SU(3) field theory. We will focus on the former case, where we can luxuriously define \ud835\udc44 in a manner which only yields integer values:\n\ud835\udc44 = 1\n2\ud835\udf0b \u2211\ufe01 \u00ae\ud835\udc5b\u2208\u039b Im [ log(\ud835\udc43\ud835\udc61 \ud835\udc65 (\u00ae\ud835\udc5b)) ] , (1)\nwhere \ud835\udc43\ud835\udc61 \ud835\udc65 (\u00ae\ud835\udc5b) is the plaquette at the lattice site \u00ae\ud835\udc5b = (\ud835\udc61, \ud835\udc65)T. Since small changes of a configuration do not always change \ud835\udc44, there are regions in phase space where \ud835\udc44 is constant, called topological sectors. The troublesome increase in autocorrelation time is caused by action barriers in between these sectors that grow for decreasing lattice spacing \ud835\udc4e, ultimately trapping the Markov chain inside. The method of Metadynamics helps visualize and circumvent these action barriers, as can be seen in the next section.\nFigure 1: Time series of the discrete topological charge on different square lattices. The configurations were produced using the Metropolis algorithm on a line of constant physics (LCP) given by \ud835\udc41\ud835\udc65\ud835\udc41\ud835\udc61/\ud835\udefd = 80. On the finer lattice with \ud835\udefd = 7.2 the system visibly got stuck in a topological sector. Including instanton-updates in between Metropolis sweeps caused the system to tunnel to different sectors again, providing a remedy.\nP o S ( L A T T I C E 2 0 2 2 ) 2 5 3"
        },
        {
            "heading": "2. Metadynamics",
            "text": "For 2-dim. U(1) theory there already exist multiple methods which counteract topological freezing, one example being instanton-updates [5, 6, 7] which involve multiplying a configuration link by link with a \u00b11-instanton (plus or minus with equal probability) followed by a conventional accept-reject step. Here a \ud835\udc44-instanton is a configuration given by\n\ud835\udc48 \ud835\udc3c\ud835\udc61 (\ud835\udc44; \ud835\udc61, \ud835\udc65) = exp ( \u22122\ud835\udf0b\ud835\udc56\ud835\udc65 \ud835\udc44\n\ud835\udc41\ud835\udc61\ud835\udc41\ud835\udc65\n) ,\n\ud835\udc48 \ud835\udc3c\ud835\udc65 (\ud835\udc44; \ud835\udc61, \ud835\udc65) = exp ( 2\ud835\udf0b\ud835\udc56\ud835\udc61 \ud835\udc44\n\ud835\udc41\ud835\udc61 \ud835\udeff\ud835\udc65,\ud835\udc41\ud835\udc65\n) .\n(2)\nConsequently, every plaquette of a \ud835\udc44-instanton configuration has the same value, such that its topological charge is \ud835\udc44. Thus, an instanton-update proposes a configuration whose topological charge differs by \u0394\ud835\udc44 = \u00b11, effectively tunneling through the action barriers. In 2-dim. U(1) theory this update is very effective when used in combination with ergodic algorithms such as the Metropolis algorithm used here, as can be seen in Fig. 1. However, in 4-dim. SU(3) there are multiple problems, which also holds for other topology changing algorithms [8, 9].\nMetadynamics is a topology changing algorithm that also seems promising for SU(3) [8, 9]. It involves building a bias potential \ud835\udc49 (also called metapotential) that depends on so called collective variables (CV) and is added onto the gauge action. The idea is to add small and local repulsive potentials at the points in phase space (parameterized via the CVs) that the system has already visited, thus discouraging the system from revisiting the same places again and eventually filling up local action minima. Observables can be measured via reweighting with factors \ud835\udc52\ud835\udc49\ud835\udc56 , see Sec. 4.\nTo be more specific we proceed analogously to Laio et. al [10]. We use one CV to characterize the phase space, which we call the continuous topological charge \ud835\udc44cont (also called meta charge and denoted by \ud835\udc44meta), as it is an approximation of the discrete charge and not integer-valued anymore:\n\ud835\udc44cont = 1\n2\ud835\udf0b \u2211\ufe01 \u00ae\ud835\udc5b\u2208\u039b Im [ \ud835\udc43\ud835\udc61 \ud835\udc65 (\u00ae\ud835\udc5b) ] . (3)\n\ud835\udc44 itself, telling us in which sector the system is currently located, is already a good means of characterizing the phase space. For Metadynamics, however, it is necessary to have a higher resolution, which is why \ud835\udc44cont is the CV of choice here. In order to build up the bias potential, one starts a run using the Metropolis algorithm, measures the CV at each point \ud835\udc61 in Monte Carlo time and adds a small strictly positive potential \ud835\udc54(\ud835\udc44cont(\ud835\udc65(\ud835\udc61))) onto \ud835\udc49 . Thus, \ud835\udc49 is built up according to\n\ud835\udc49 (\ud835\udc44cont(\ud835\udc65), \ud835\udc61) = \u2211\ufe01 \ud835\udc61 \u2032<\ud835\udc61 \ud835\udc54 ( \ud835\udc44cont(\ud835\udc65) \u2212\ud835\udc44cont ( \ud835\udc65(\ud835\udc61\u2032) ) ) , (4)\nwhere \ud835\udc65 is a point in phase space. The potential is stored on a \ud835\udc44cont-grid of resolution \ud835\udeff\ud835\udc44. It is important that \ud835\udc54 vanishes rapidly for large absolute values of its argument; we used triangles of height \ud835\udc64, which is a little cheaper than e.g. \ud835\udc54(\ud835\udc44) = \ud835\udc64 \u00b7 exp ( \u2212\ud835\udc442 2\ud835\udeff\ud835\udc44 ) , which has also been used before [10]. An example of a bias potential as well as a demonstration of principle can be seen in Fig. 2. The values used here are \ud835\udc64 = 10\u22124 and \ud835\udeff\ud835\udc44 = 10\u22122.\nP o S ( L A T T I C E 2 0 2 2 ) 2 5 3\n(a) 32 \u00d7 32-lattice with \ud835\udefd = 12.8 (b) Measurement of \u27e8\ud835\udc442\u27e9 for different \ud835\udefd\nFigure 2: (a) Shows snapshots of the metapotential taken at different times during the building process. For comparison the maximum value was subtracted at each time. In (b) measurements of \u27e8\ud835\udc442\u27e9 using Metadynamics are compared with the analytical prediction [11]. The \ud835\udc5d-value is \ud835\udc5d = 97.8% and \ud835\udf122/dof = 7.02/6 = 1.17."
        },
        {
            "heading": "3. Renormalization Constant \ud835\udc4d",
            "text": "When plotting the bias potential as in Fig. 2(a), the extrema apparently do not align with the integer values on the \ud835\udc44cont-axis. This is to be expected, since the local action minima lie at \ud835\udc44- instanton configurations, and for their continuous and discrete charges one can quickly see by use of Eqs. (2) and (3) that for fixed instanton charge \ud835\udc44insta holds |\ud835\udc44cont, insta | \u2264 |\ud835\udc44insta |. 1 We measured pairs of (\ud835\udc44,\ud835\udc44cont) of configurations generated with the Metropolis algorithm infused with instanton-updates on various lattice sizes and plotted them in 2D histograms as in Fig. 3(a). The means of the \ud835\udc44cont-distributions corresponding to one \ud835\udc44-value each could be fitted by a linear function of \ud835\udc44, see Fig. 3(b). As a consequence of the definition of \ud835\udc44cont, the slope in Fig. 3(b) is less than one. We call its inverse the renormalization constant \ud835\udc4d , since multiplying \ud835\udc44cont with \ud835\udc4d leads to the mean values of the \ud835\udc44cont-distributions aligning with their respective integer values. Hence, considering \ud835\udc4d \u00b7 \ud835\udc44cont instead of \ud835\udc44cont leads to the extrema of the bias potential aligning with (half-) integer values as can be seen in Fig. 4.\nThe fitting function we found to describe \ud835\udc4d best as a function of the lattice spacing \ud835\udc4e is\n\ud835\udc4d fit(\ud835\udc4e) = (1.001 \u00b1 0.001) + (33.50 \u00b1 2.78) \ud835\udc4e2 + (9431 \u00b1 866) \ud835\udc4e4, (5)\nalthough, apart from polynomial functions, also exponential and Pad\u00e9 ansatzes have been looked into. Note that the limit lim\ud835\udc4e\u21920 \ud835\udc4d (\ud835\udc4e) = 1 is an important check for consistency as \ud835\udc44 and \ud835\udc44cont both have the same continuum limit. The dependency of \ud835\udc4d on only even powers of \ud835\udc4e is to be expected since the presence of \ud835\udc4e raised to uneven powers would break the symmetry of the topological charge distribution.\n1In fact, one can swiftly calculate that \ud835\udc44cont, insta has a sinusoidal behaviour with a period of (\ud835\udc41\ud835\udc65\ud835\udc41\ud835\udc61 )\u22121.\nP o S ( L A T T I C E 2 0 2 2 ) 2 5 3\n(a) 2D histograms of (\ud835\udc44,\ud835\udc44cont)-pairs (b) Linear fit through (\ud835\udc44,\ud835\udc44cont)-pairs\nFigure 3: Measurements on a (12 \u00d7 12)-lattice with \ud835\udefd = 1.8. This is the coarsest lattice used, for finer lattices the widths of the distributions in (a) quickly decrease while the slopes in (b) approach one.\n(a) Without multiplying with \ud835\udc4d (b) With multiplying with \ud835\udc4d\nFigure 4: Due to the scaling of the continuous charge one cannot directly compare metapotentials of different \ud835\udefd\u2019s of the same LCP: one has to multiply the \ud835\udc44cont-values with their respective \ud835\udc4d-factors."
        },
        {
            "heading": "4. Effective Sample Size",
            "text": "Modifying the action with the bias potential results in sampling configurations according to a different probability distribution than that of the underlying theory. Consequently, as mentioned before, one has to make use of reweighting when measuring observables. In our case, the weights are obtained using the bias potential entries of the \ud835\udc56-th ensemble member via \ud835\udc64\ud835\udc56 = exp ( \ud835\udc49 (\ud835\udc44cont,\ud835\udc56) ) , leading to\n\u27e8\ud835\udc42\u27e9 = \u2211 \ud835\udc56 \ud835\udc42\ud835\udc56 exp ( \ud835\udc49 (\ud835\udc44cont,\ud835\udc56) )\u2211 \ud835\udc56 exp ( \ud835\udc49 (\ud835\udc44cont,\ud835\udc56) ) . (6)\nP o S ( L A T T I C E 2 0 2 2 ) 2 5 3\nThis results in a different effective sampling size \ud835\udc5beff, which can be calculated via\n\ud835\udc5beff = (\u2211\ud835\udc56 \ud835\udc64\ud835\udc56)2\u2211\n\ud835\udc56 \ud835\udc64 2 \ud835\udc56\n. (7)\nThis has been done for the bias potentials on various lattice sizes, the results can be found in Tab. 1.\n\ud835\udc41 \ud835\udefd \ud835\udc5beff ratio \ud835\udf0fint"
        },
        {
            "heading": "20 5.0 1955671 0.19559 7357",
            "text": ""
        },
        {
            "heading": "24 7.2 941015 0.09411 13881",
            "text": ""
        },
        {
            "heading": "28 9.8 643229 0.06433 12832",
            "text": ""
        },
        {
            "heading": "32 12.8 614815 0.06149 12605",
            "text": ""
        },
        {
            "heading": "36 16.2 307691 0.03077 17518",
            "text": ""
        },
        {
            "heading": "40 20.0 182351 0.01824 33192",
            "text": "Table 1: Effective sample sizes as per Eq. (7). 107 configurations were generated on lattices of different \ud835\udc41 = \ud835\udc41\ud835\udc61 = \ud835\udc41\ud835\udc65 on the same LCP. The integrated autocorrelation time was determined using \u27e8\ud835\udc442\u27e9.\nTo avoid sampling regions of unnecessarily high \ud835\udc44cont, a penalty potential was used such that the generation of configurations with |\ud835\udc44cont | \u2265 7.0 was heavily suppressed. Yet the measured \ud835\udc5beff turn out to be comparatively small, highlighting one shortcoming of Metadynamics. To that end one can enhance the procedure by adapting the height \ud835\udc64 of the small local potentials \ud835\udc54(\ud835\udc44cont) dynamically, i.e. \ud835\udc64 \u2192 \ud835\udc64(\ud835\udc61), such that \ud835\udc64(\ud835\udc61) decreases over Monte Carlo time. This approach is referred to as well-tempered Metadynamics [12] and has been shown to provide relief."
        },
        {
            "heading": "5. Fitting Attempts",
            "text": "(a) 20 \u00d7 20-lattice with \ud835\udefd = 5.0 (b) 40 \u00d7 40-lattice with \ud835\udefd = 20.0\nFigure 5: Using the naive fitting function \ud835\udc39 (\ud835\udc44cont) = \ud835\udc34\ud835\udc442cont + \ud835\udc35 sin2 (\ud835\udc36\ud835\udc44cont) to describe the bias potential does not yield satisfactory results for any lattice size.\nOne drawback of Metadynamics is the circumstance that a bias potential has to be built up for every lattice size separately, leading to an increase of computational costs. Knowing the bias potential in advance would thus impose a significant improvement. Even an estimate can be of advantage, since small corrections can be implemented via a shortened building run. We are currently performing fits of already built up bias potentials in hopes of finding a pattern of the fit parameters for different lattice sizes on the same LCP.\nWhile Laio et al. [10] showed that a fit of the form \ud835\udc39 (\ud835\udc44cont) = \ud835\udc34\ud835\udc442cont + \ud835\udc35 sin2(\ud835\udf0b\ud835\udc44cont) described the model of their choice well, we find that this function is insufficient in 2-dim. U(1)theory: firstly, the phase velocity must be modified by the \ud835\udc4d-factor since here the local action minima lay in vicinity of \ud835\udc44-instanton configurations, which are defined using the discrete charge, not the continuous one; secondly, in our case it seems that for coarse lattices the fitting function consistently\nP o S ( L A T T I C E 2 0 2 2 ) 2 5 3\nunder- and for finer lattices overestimates the potential barriers. Both of these observations are illustrated in Fig. 5. Using multiple sin2(\ud835\udf0b \ud835\udc53\ud835\udc56\ud835\udc44) -terms with frequencies \ud835\udc53\ud835\udc56 determined via a discrete Fourier transform yields a better result. The fitting process used here is displayed in more detail in Fig. 6. To outline, parabolas were fitted to the extrema of the bias potentials in order to subtract them so as to receive a signal more suited for a Fourier transform. The frequency spectrum can be seen in Fig. 6(c) and turned out to be mostly composed of one ground frequency close to the aforementioned \ud835\udc36-parameters and its following one to two harmonics. These frequencies were then used as proposals for \ud835\udc53\ud835\udc56 in fitting functions of the form\n\ud835\udc39\u2032(\ud835\udc44cont) = \ud835\udc34\u2032\ud835\udc442cont + 2 or 3\u2211\ufe01 \ud835\udc56=1 \ud835\udc35\ud835\udc56 sin2(\ud835\udf0b \ud835\udc53\ud835\udc56\ud835\udc44cont), (8)\nwhere \ud835\udc34\u2032, \ud835\udc35\ud835\udc56 and \ud835\udc53\ud835\udc56 are fit parameters. We present our results for the case \ud835\udc56 \u2208 {1, 2, 3} and note that the transition from \ud835\udc56 \u2208 {1, 2} to \ud835\udc56 \u2208 {1, 2, 3} did not produce different results for \ud835\udc351, \ud835\udc531 and \ud835\udc532, but did so for \ud835\udc352. The frequencies determined for different lattice sizes can be seen in Fig. 7(a). There it can be seen that for finer lattices, the frequencies roughly coincide with the prediction delivered by the renormalization constant \ud835\udc4d (\ud835\udc4e).\n(a) \ud835\udc53\ud835\udc56 for various lattices (b) Preliminary \ud835\udc35\ud835\udc56 for various lattices\nFigure 7: In (a) the frequencies \ud835\udc53\ud835\udc56 from the fitting function Eq. (8) are plotted over \ud835\udc4e. One can see that for fixed \ud835\udc4e the frequencies \ud835\udc532 and \ud835\udc533 roughly match the first two harmonics of \ud835\udc531 and additionally, that the frequencies coincide with (multiples of) \ud835\udc4d (\ud835\udc4e) for small \ud835\udc4e. (b) shows preliminary results for the amplitudes \ud835\udc35\ud835\udc56 .\nFig. 7(b) shows the preliminary results for the fitted amplitudes \ud835\udc35\ud835\udc56 . The growth of \ud835\udc351 for decreasing \ud835\udc4e clearly shows the growth of the action barriers when approaching the continuum, as we already knew. For \ud835\udc352 and \ud835\udc353 one can see that while for coarse lattices both of the amplitudes are comparatively small, for finer lattices \ud835\udc352 seems to grow. One can surmise that for finer lattices \ud835\udc353 will follow this behaviour and become more relevant as well.\nP o S ( L A T T I C E 2 0 2 2 ) 2 5 3"
        },
        {
            "heading": "6. Conclusion",
            "text": "In 2-dim. U(1) gauge theory the approach of Metadynamics seems to be a successful remedy for topological freezing. One drawback of this method, the building process, is attempted to be circumvented by the search of suitable fitting functions for the bias potentials. One function that yields a satisfactory result is\n\ud835\udc39\u2032(\ud835\udc44cont) = \ud835\udc34\u2032\ud835\udc442cont + 2 or 3\u2211\ufe01 \ud835\udc56=1 \ud835\udc35\ud835\udc56 sin2(\ud835\udf0b \ud835\udc53\ud835\udc56\ud835\udc44cont),\nwhere a Fourier analysis of the bias potential showed that the frequencies \ud835\udc531, \ud835\udc532, \ud835\udc533 approximately fulfill \ud835\udc53\ud835\udc56 = \ud835\udc56 \u00b7 \ud835\udc531. For each lattice the ground frequency \ud835\udc531 can be obtained via the renormalization constant \ud835\udc4d (\ud835\udc4e), which in turn can be determined by examining the collective variable \ud835\udc44cont. While instanton-updates and several other methods would also work here, Metadynamics is an ansatz which also seems promising for 4-dim. SU(3) theory [8, 9]. In the future, we plan to investigate bias potentials in that theory analogously to the way presented here. Additionally, in hopes of improving the effective sample size, we plan to experiment with different building strategies, such as well-tempered Metadynamics [12] or other dynamical building methods. More generally, we intend to look into using other CVs in addition to\ud835\udc44cont. What would also be interesting to see is if one can extract modes from the Markov chain which couple to the autocorrelation time by use of the generalized eigenvalue problem. Should one find observables with larger autocorrelation times than those of \ud835\udc44, one could (amongst other things) customize interesting CVs for Metadynamics."
        }
    ],
    "title": "Metadynamics Surfing on Topology Barriers in the Schwinger Model",
    "year": 2022
}