{
    "abstractText": "The evaluationof scratching behavior is important in experimental animals because there is significant interest in elucidating mechanisms and developing medications for itching. The scratching behavior is classically quantified by human observation, but it is labor-intensive and has low throughput. We previously established an automated scratching detection method using a convolutional recurrent neural network (CRNN). TheestablishedCRNNmodelwas trained bywhitemice (BALB/c), and it could predict their scratching bouts and duration. However, its performance in blackmice (C57BL/6) is insufficient. Here, we established amodel for blackmice to increase prediction accuracy. Scratching behavior in black mice was elicited by serotonin administration, and their behavior was recorded using a video camera. The videos were carefully observed, and each frame was manually labeled as scratching or other behavior. The CRNN model was trained using the labels and predicted the first-look videos. In addition, posterior filters were set to remove unlikely short predictions. The newly trained CRNN could sufficiently detect scratching behavior in black mice (sensitivity, 98.1%; positive predictive rate, 94.0%). Thus, our established CRNN and posterior filter successfully predicted the scratching behavior in blackmice, highlighting that our workflow can be useful, regardless of the mouse strain.",
    "authors": [
        {
            "affiliations": [],
            "name": "Naoaki Sakamoto"
        },
        {
            "affiliations": [],
            "name": "Taiga Haraguchi"
        },
        {
            "affiliations": [],
            "name": "Koji Kobayashi"
        },
        {
            "affiliations": [],
            "name": "Yusuke Miyazaki"
        },
        {
            "affiliations": [],
            "name": "Takahisa Murata"
        },
        {
            "affiliations": [],
            "name": "Kazuya Miyagawa"
        }
    ],
    "id": "SP:bc1dbfed886b924357607dc1837be7206f025882",
    "references": [
        {
            "authors": [
                "P. Elliott",
                "M. G\u2019Sell",
                "L.M. Snyder",
                "S.E. Ross",
                "V. Ventura"
            ],
            "title": "Automated acoustic detection of mouse scratching",
            "venue": "PLoS One 12,",
            "year": 2017
        },
        {
            "authors": [
                "E.A. Hoeck",
                "J.B. Marker",
                "P. Gazerani",
                "H.H. Andersen",
                "L. Arendt-Nielsen"
            ],
            "title": "Preclinical and human surrogate models of itch",
            "venue": "Exp. Dermatol. 25, 750\u2013757. doi:10.1111/exd.13078",
            "year": 2016
        },
        {
            "authors": [
                "N. Inagaki",
                "K. Igeta",
                "N. Shiraishi",
                "J.F. Kim",
                "M. Nagao",
                "N Nakamura"
            ],
            "title": "Evaluation and characterization of mouse scratching behavior by a new apparatus, MicroAct",
            "venue": "Skin. Pharmacol. Appl. Skin. Physiol. 16,",
            "year": 2003
        },
        {
            "authors": [
                "N. Inagaki",
                "M. Nagao",
                "K. Igeta",
                "H. Kawasaki",
                "J.F. Kim",
                "H Nagai"
            ],
            "title": "Scratching behavior in various strains of mice",
            "venue": "Skin. Pharmacol. Appl. Skin. Physiol",
            "year": 2001
        },
        {
            "authors": [
                "Institute for Health Metrics",
                "Evaluation"
            ],
            "title": "GBD 2019 cause and risk summary: Pruritus",
            "venue": "Seattle, USA: IHME, University of Washington. Accessed 2022/ 04/29.",
            "year": 2020
        },
        {
            "authors": [
                "I. Ishii",
                "S. Kurozumi",
                "K. Orito",
                "H. Matsuda"
            ],
            "title": "Automatic scratching pattern detection for laboratory mice using high-speed video images",
            "venue": "IEEE Trans. Autom. Sci. Eng. 5, 176\u2013182. doi:10.1109/tase.2007.902868",
            "year": 2008
        },
        {
            "authors": [
                "H. Jin",
                "R. He",
                "M. Oyoshi",
                "R.S. Geha"
            ],
            "title": "Animal models of atopic dermatitis",
            "venue": "J. Investig. Dermatol. 129, 31\u201340. doi:10.1038/jid.2008.106",
            "year": 2009
        },
        {
            "authors": [
                "K. Kobayashi",
                "S. Matsushita",
                "N. Shimizu",
                "S. Masuko",
                "M. Yamamoto",
                "T Murata"
            ],
            "title": "Automated detection of mouse scratching behaviour using convolutional recurrent neural network",
            "year": 2021
        },
        {
            "authors": [
                "J. Lee",
                "H. Suh",
                "H. Jung",
                "M. Park",
                "J. Ahn"
            ],
            "title": "Association between chronic pruritus, depression, and insomnia: A cross-sectional study",
            "venue": "JAAD Int. 3, 54\u201360. doi:10.1016/j.jdin.2021.02.004",
            "year": 2021
        },
        {
            "authors": [
                "A. Mathis",
                "P. Mamidanna",
                "K.M. Cury",
                "T. Abe",
                "V.N. Murthy",
                "Mathis",
                "M. W"
            ],
            "title": "DeepLabCut: Markerless pose estimation of user-defined body parts with deep learning",
            "venue": "Nat. Neurosci",
            "year": 2018
        },
        {
            "authors": [
                "G. Tarras\u00f3n",
                "C. Carcasona",
                "P. Eichhorn",
                "B. P\u00e9rez",
                "A. Gavald\u00e0",
                "N Godessart"
            ],
            "title": "Characterization of the chloroquine-induced mouse model of pruritus using an automated behavioural system",
            "venue": "Exp. Dermatol",
            "year": 2017
        },
        {
            "authors": [
                "G. Yosipovitch",
                "J.D. Rosen",
                "T. Hashimoto"
            ],
            "title": "Itch: Frommechanism to (novel) therapeutic approaches",
            "venue": "J. Allergy Clin. Immunol. 142, 1375\u20131390. doi:10. 1016/j.jaci.2018.09.005",
            "year": 2018
        }
    ],
    "sections": [
        {
            "text": "Automated scratching detection system for black mouse using deep learning\nNaoaki Sakamoto\u2020, Taiga Haraguchi\u2020, Koji Kobayashi\u2020, Yusuke Miyazaki and Takahisa Murata*\nDepartment of Animal Radiology, Graduate School of Agricultural and Life Sciences, The University of Tokyo, Tokyo, Japan\nThe evaluationof scratching behavior is important in experimental animals because there is significant interest in elucidating mechanisms and developing medications for itching. The scratching behavior is classically quantified by human observation, but it is labor-intensive and has low throughput. We previously established an automated scratching detection method using a convolutional recurrent neural network (CRNN). TheestablishedCRNNmodelwas trained bywhitemice (BALB/c), and it could predict their scratching bouts and duration. However, its performance in blackmice (C57BL/6) is insufficient. Here, we established amodel for blackmice to increase prediction accuracy. Scratching behavior in black mice was elicited by serotonin administration, and their behavior was recorded using a video camera. The videos were carefully observed, and each frame was manually labeled as scratching or other behavior. The CRNN model was trained using the labels and predicted the first-look videos. In addition, posterior filters were set to remove unlikely short predictions. The newly trained CRNN could sufficiently detect scratching behavior in black mice (sensitivity, 98.1%; positive predictive rate, 94.0%). Thus, our established CRNN and posterior filter successfully predicted the scratching behavior in blackmice, highlighting that our workflow can be useful, regardless of the mouse strain.\nKEYWORDS\nscratching behavior, itching, neural network, convolutional neural network, pruritus\nIntroduction\nOver 70 million people suffer from itching worldwide (Institute for Health Metrics and Evaluation, 2020). Chronic itching is sometimes associated with serious problems, such as sleep impairments and depression, and decreases the patients\u2019 quality of life (Lee et al., 2021). Although variousmedications, including antihistamine drugs are typically used for treatments, detailedmechanisms of refractory cases remain unknown (Yosipovitch et al., 2018). Therefore, researchers have established various rodent itching models (Hoeck et al., 2016) and have explored the mechanisms and drug candidates.\nSince we cannot directly assess itching sensation in rodents, we usually evaluate itching by observing scratching. In most laboratories, visual observation is the standard method for measuring scratching bouts and durations. However, it has low throughput and places physical"
        },
        {
            "heading": "OPEN ACCESS",
            "text": ""
        },
        {
            "heading": "EDITED BY",
            "text": "Rafael Gonzalez-Cano, University of Granada, Spain"
        },
        {
            "heading": "REVIEWED BY",
            "text": "Kazuya Miyagawa, International University of Health and Welfare (IUHW), Japan Pouya Bashivan, McGill University, Canada \u00d6zg\u00fcr G\u00fcnd\u00fcz, Trakya University, Turkey Daisuke Uta, University of Toyama, Japan\n*CORRESPONDENCE Takahisa Murata, amurata@g.ecc.u-tokyo.ac.jp\n\u2020These authors have contributed equally to this work and share first authorship"
        },
        {
            "heading": "SPECIALTY SECTION",
            "text": "This article was submitted to Computational Physiology and Medicine, a section of the journal Frontiers in Physiology\nRECEIVED 11 May 2022 ACCEPTED 28 June 2022 PUBLISHED 22 July 2022"
        },
        {
            "heading": "CITATION",
            "text": "Sakamoto N, Haraguchi T, Kobayashi K, Miyazaki Y and Murata T (2022), Automated scratching detection system for black mouse using deep learning. Front. Physiol. 13:939281. doi: 10.3389/fphys.2022.939281"
        },
        {
            "heading": "COPYRIGHT",
            "text": "\u00a9 2022 Sakamoto, Haraguchi, Kobayashi, Miyazaki and Murata. This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permittedwhich does not comply with these terms.\nFrontiers in Physiology frontiersin.org01\nTYPE Brief Research Report PUBLISHED 22 July 2022 DOI 10.3389/fphys.2022.939281\nand mental burdens on researchers. Therefore, automated tools are required to promote research into itching.\nRecently, we reported an automated scratching detectionmethod using a convolutional recurrent neural network (CRNN) (Kobayashi et al., 2021). This method can detect scratching behavior in white mice (BALB/c). In addition, only a simple recording environment was required to use our method: a video camera, a cage, and a GPUmounted computer. These characteristics are superior to existing methods requiring special equipment (Inagaki et al., 2003; Elliott et al., 2017; Tarras\u00f3n et al., 2017). However, in a previous study, the established method could not sufficiently predict the scratching behavior in black mice (C57BL/6). Because black mice are also widely used in research, including for itching (Jin et al., 2009), the development of an accurate automated prediction method for black mice, as is the case for white mice, is desired.\nThis study aimed to improve our workflow and develop an accurate automated prediction method for black mice. The CRNN and posterior filter combination successfully detected scratching behaviors in black mice. Together with previous works, our proposed workflow can accelerate research on itching."
        },
        {
            "heading": "Materials and methods",
            "text": ""
        },
        {
            "heading": "Mice",
            "text": "C57BL/6 mice (12\u201318 weeks old; males, n = 9) were used in this study. All the experiments were approved by the Institutional Animal Care and Use Committee of the University of Tokyo (P19-079). Animal care and treatment were performed in accordance with the guidelines outlined in the Guide to Animal Use and Care of the University of Tokyo.\nSerotonin treatment and video recording\nSerotonin (10 ug in 10 ul saline; Serotonin hydrochloride, Sigma Aldrich, St. Louis, MO) was intradermally injected into the backs of C57BL/6 mice to induce scratching behavior. After treatment, the mice were placed into a white square arena (37 cm \u00d7 25 cm \u00d7 22 cm), and their behavior was recorded for 20\u201330 min using a video camera (HDR-CX720V, Sony, Tokyo, Japan). The detailed recording conditions were as follows: frame rate, 60 Hz; resolution, 1,920 \u00d7 1,080 pixels. We split the recorded videos every about 10.5 min and selected 21 videos in which several scratching bouts were observed."
        },
        {
            "heading": "Manual labelling of scratching",
            "text": "We defined scratching behavior as the rapid, repetitive, and back-and-forth movement of the hind limb toward the injection\nsite, as previously defined (Kobayashi et al., 2021). The recorded videos were carefully observed and each frame was labeled as \u201cscratching\u201d: 1 or \u201cother behaviors\u201d: 0."
        },
        {
            "heading": "Image pre-processing",
            "text": "All the recorded videos were divided into frames. The frames were pre-processed as previously described (Kobayashi et al., 2021). Briefly, differential images between successive frames were generated and cropped around the geometric center of the mouse into a square shape. They were converted to gray scale, binarized, and resized to 200 \u00d7 200 pixels. The binarization threshold was set to 15. To consider the temporal changes before and after the frame at time t, 21 pre-processed images from t-10 to t+10 were collected. Hereafter, we call them as \u201csegment\u201d. The label of the frame at time t is assigned to the label of the segments at time t.\nConvolutional recurrent neural network\nThe architecture and hyperparameters were similar to those described previously (Kobayashi et al., 2021). Briefly, the CRNN is composed of three convolution and max pooling layers, two LSTM layers, and five fully connected layers. One hundred segments were randomly selected from those labeled as scratching, and 1,500 segments were randomly selected regardless of labels for every epoch. The images were randomly flipped and rotated by multiples of 20\u00b0 for data augmentation. An Adam optimizer with a 3 \u00d7 10\u22125 learning rate and a binary cross-entropy loss function was used. For the prediction, segments were input into the trained CRNN without data augmentation. The CRNN outputs a decimal value between zero and one for the segments.We defined a segment which value was more than 0.5 as \u201cscratching\u201d.\nPrediction of scratching bouts and duration\nA series of continuous predictions were counted as a bout. Duration was calculated as the time period for each bout. When a bout observed by humans was predicted to be several bouts, the duration was predicted as the sum of the time period of predicted bouts."
        },
        {
            "heading": "Computer hardware and software",
            "text": "Training and prediction of neural networks were conducted on a desktop computer equipped with an Intel Core i9-9900 KS CPU, 64 GB RAM, and NVIDIA GeForce RTX 2080 Ti using the TensorFlow library (version 1.14.0) in Python.\nFrontiers in Physiology frontiersin.org02"
        },
        {
            "heading": "Results",
            "text": "Dataset preparation of scratching behavior\nSerotonin (10 \u00b5g in 10 \u00b5L saline) was intradermally injected into the backs of C57BL/6 mice (n = 9) to induce scratching behavior. The mice\u2019s behavior was recorded for 20\u201330 min using a video camera.We split the recorded videos approximately every 10.5 min and obtained 21 videos in which the mice scratched several times. These videos were divided into frames, and each frame was manually labeled as \u201cscratching\u201d or \u201cother behavior.\u201d In addition, the images were pre-processed as previously described (Materials and Methods).\nThe 21 videos were split into three datasets: 12 videos for the training dataset, four for the validation dataset, and five for the test dataset. Five mice were used to create the training and validation datasets, and the other four mice were used to create the test dataset. The training dataset was used to train the neural network, the validation dataset was used to tune the hyperparameters, and the test dataset was used to evaluate the performance of the trained neural network."
        },
        {
            "heading": "CRNN training",
            "text": "The CRNN model was constructed as previously described (Kobayashi et al., 2021) and trained with the training dataset. The losses, an index of the difference between CRNN prediction and human labels, for the training dataset were surveyed to understand training progress. The losses gradually decreased and reached almost plateaued at 800 epochs (Supplementary Figure S1A), suggesting that the training progress almost converged at 800 epochs. Thus, we stopped training at that point. When a neural network excessively learns the training datasets, the performance to predict the first-look dataset decreases, which are usually called \u201coverfitting.\u201d We checked the performance of the trained CRNN every 200 epochs using the training and validation datasets whose videos were not used for training. The ratio of mispredicted frames to all frames (error rate) was calculated for both datasets (Supplementary Figure S1B). While the error rate gradually decreased as training progressed for the training dataset, the model at 600 epochs showed the lowest error rate (0.26%) for the validation dataset. Therefore, we used this model with 600 epochs.\nPerformance validation and filter application\nThe performance of the trained model was evaluated using the validation dataset. The sensitivity and specificity were 93.5% (2,645 of 2,830) and 99.9% (149,331 of 149,546). The positive\npredictive and negative predictive values were 92.5% (2,645 of 2,860) and 99.9% (149,331 of 149,516) (Supplementary Table S1). Besides, we also confirmed that the previous model trained with BALB/c dataset exhibited lower performance (sensitivity, 50.7%; positive predictive rate, 99.5%; Supplementary Table S3), consistent with our previous result (Kobayashi et al., 2021).\nNext, we counted the number of scratching bouts and calculated the duration of each bout. The number of scratching bouts and the duration of each bout predicted by the CRNN were largely comparable to those counted by humans (Figures 1A,B; bouts: r = 0.871, duration: r = 0.963). However, there was a video in which bouts were overestimated compared to others (indicated by an arrow in Figure 1A).\nMispredicted frames were classified into three categories: 1) boundary errors, 2) false detections, and 3) oversights to investigate the error details. \u201cBoundary errors\u201d were assigned to cases in which the start frame and/or end frame of a series of continuous predictions were shifted compared with those of human labeling. \u201cFalse detections\u201d were assigned to cases in which the CRNN mislabeled non-scratching behavior as scratching. Oversights were assigned to cases in which the CRNN failed to detect scratching behavior labeled by humans. In the mispredicted frames of the validation dataset, boundary errors were 84.0% (336 of 400), false detections were 15.8% (63 of 400), and oversights were 0.3% (1 of 400) (Figure 1C). In addition, we found that false detections occurred for short periods (one to nine frames) when the mice walked and groomed themselves. Therefore, a posterior filter that removed the predictions for nine or fewer frames was set to improve the predictive performance (Figure 1D).\nAfter the filter was applied, the overestimated bouts were significantly improved, whereas the prediction of durations remained highly correlated with human observations (Figures 1E,F; bouts: r = 0.999, duration: r = 0.930). In addition, analyzing the details of the errors showed that false detections were completely removed, and oversights remained at low levels (Figures 1C,G). We also confirmed that there were no apparent changes in sensitivity (93.1%), specificity (99.9%), positive predictive rate (94.5%), and negative predictive rate (99.9%, Supplementary Table S2). These results indicate that the posterior filter improves the performance in predicting the number of scratching bouts.\nPerformance evaluation using the test dataset\nWe evaluated the trained CRNN and filter performance using the test dataset. The test dataset consisted of five videos not used in the training or validation datasets. The sensitivity and specificity were 98.1% (7,814 of 7,968) and 99.9% (182,082 of 182,577), respectively. The positive predictive and negative predictive values were 94.0% (7,814 in 8,309) and 99.9%\nFrontiers in Physiology frontiersin.org03\nFrontiers in Physiology frontiersin.org04\n(182,082 in 182,236) (Table 1). The number of bouts and duration predicted by the CRNN and filter were highly correlated with those counted by humans (Figures 2A,B; bouts: r = 0.994, duration: r = 0.991). The most frequent errors were boundary errors (87.2%, 566 in 612); false detections and oversights accounted only for 3.2% (21 of 612) and 9.6% (62 in 612), respectively (Figure 2C). Because boundary errors can occur among human experimenters, these results demonstrate the high performance of the method."
        },
        {
            "heading": "Discussion",
            "text": "Evaluation of mouse scratching behavior is indispensable for itching research. We previously established a model to automatically detect the scratching behavior of a white BALB/c strain using CRNN (Kobayashi et al., 2021). In this study, we improved the method by introducing a posterior filter and showed that our workflow can be applied to C57BL/6 mice.\nFrontiers in Physiology frontiersin.org05\nVisual assessment of scratching behavior is a general method; however, it is time-consuming and exhausts researchers. Therefore, automated tools have been developed using magnets (Inagaki et al., 2003), sounds (Elliott et al., 2017), vibrations (Tarras\u00f3n et al., 2017), and video images (Ishii et al., 2008; Kobayashi et al., 2021). In the present study, we adopted video-based analysis and used simple recording setups: a cage and a video camera. Since this simple setup did not require invasive treatment (Inagaki et al., 2003), our method places less of a burden on experimental animals. In addition, the initial introduction costs into the experimental facilities can be lower, as no special equipment is necessary. Besides, we can easily check predictions by observing recorded video files, whereas it is difficult to make such checks from sounds and vibrations only. Therefore, our method is superior to the existing methods.\nBecause various mouse strains have been used for itching research (Inagaki et al., 2001; Jin et al., 2009; Hoeck et al., 2016), automated scratching detection methods are desired to be used regardless of strain. However, while humans can easily detect the scratching behavior of any strain, machine learning methods are often affected by differences such as fur colors and sizes. For instance, the neural network model trained using the BALB/c strain dataset did not sufficiently predict the dataset of C57BL/ 6 strain (Kobayashi et al., 2021). We considered that this failure was caused by slight differences between the training and test datasets and newly created the datasets for C57BL/6 strain. Consequently, the model trained using the new training dataset successfully detected the scratch behavior of C57BL/ 6 mice. More importantly, we noted that the number of bouts and duration were highly correlated with those of human observations, showing feasibility for practical use. These results suggest that our proposed workflow can operate regardless of the mouse strains, when a specific, tailor-made training dataset is created from scratch.\nMachine-learning methods sometimes provide unnatural predictions because they do not consider biological factors. In the previous study, we did not examine whether the predicted periods were sufficiently long for mice to exhibit scratching behavior (Kobayashi et al., 2021). We excluded unlikely short (<10 frames) scratching predictions by applying a posterior filter. This post-processing successfully decreased the number of false detection frames (Figures 1C,G) and improved the prediction of scratching bouts (Figures 1A,E). Because adjusting filters is easier than tuning the hyperparameters of CRNN, the present study showed that the posterior filter could effectively improve the output of machine-learning methods.\nHowever, our workflow has a weakness: the requirement of strain-specific models. Recording videos and manual labeling is laborious work for researchers. For instance, we\nspent hours labeling 10-min videos in each study (Kobayashi et al., 2021). One possible solution is fine-tuning or transferlearning, which utilize already trained neural network models. These techniques can reduce the amount of necessary labeling as adopted in DeepLabCut, an animal pose estimation algorithm (Mathis et al., 2018). We are currently investigating the best way to reduce the amount of necessary labeling with fine-tuning or transfer-learning. Another solution is to develop versatile models using a few strains. Although it is beyond the scope of the present study, there is great interest in establishing a model that can be used for any kind of mouse. Creating a mixed dataset for different strains might help neural networks learn the universal features of scratching behavior. Further investigations are required to address these issues.\nIn conclusion, we established an automated method to detect scratching behavior in C57BL/6 mice using a CRNN. Combined with a previous study, this study showed that our workflow could accelerate itching research."
        },
        {
            "heading": "Data availability statement",
            "text": "The original contributions presented in the study are included in the article/Supplementary Material, further inquiries can be directed to the corresponding author."
        },
        {
            "heading": "Ethics statement",
            "text": "The animal study was reviewed and approved by the Institutional Animal Care and Use Committee of the University of Tokyo (P19-079)."
        },
        {
            "heading": "Author contributions",
            "text": "KK and TM designed and managed the project. TH performed the experiments. NS, KK, TH, and YM analyzed the data. NS, KK, and TM drafted the manuscript. All authors have read and approved the final manuscript and agreed to be accountable for all aspects of the work."
        },
        {
            "heading": "Funding",
            "text": "This work was supported by a Grant-in-Aid for Scientific Research from Japan Society for the Promotion of Science (19K15975 to KK, 20H05678 to TM), the University of Tokyo Gap Fund Program, Kobayashi Foundation, Terumo Life Science Foundation, and Asahi Group Foundation (to TM).\nFrontiers in Physiology frontiersin.org06"
        },
        {
            "heading": "Conflict of interest",
            "text": "The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest."
        },
        {
            "heading": "Publisher\u2019s note",
            "text": "All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated\norganizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher."
        },
        {
            "heading": "Supplementary material",
            "text": "The Supplementary Material for this article can be found online at: https://www.frontiersin.org/articles/10.3389/fphys. 2022.939281/full#supplementary-material"
        }
    ],
    "title": "Automated scratching detection system for black mouse using deep learning",
    "year": 2022
}