{
    "abstractText": "States of light encoding multiple polarizations vector beams offer unique capabilities in metrology and communication. However, their practical application is limited by the lack of methods for measuring many polarizations in a scalable and compact way. Here we demonstrate polarimetry of vector beams in a single shot without any polarization optics. Wemap the beampolarization content into a spatial intensity distribution through light scattering andexploit supervised learning for single-shot measurements of multiple polarizations. We characterize structured light encoding up to nine polarizations with accuracy beyond 95% on each Stokes parameter. Themethod also allows us to classify beamswith an unknownnumber of polarizationmodes, a functionality missing in conventional techniques. Our findings enable a fast and compact polarimeter for polarization-structured light, a general tool that may radically impact optical devices for sensing, imaging, and computing.",
    "authors": [
        {
            "affiliations": [],
            "name": "Davide Pierangeli"
        },
        {
            "affiliations": [],
            "name": "Claudio Conti"
        }
    ],
    "id": "SP:56e17e432bafbdc7997cb48cc2d02c8ce64ac3b7",
    "references": [
        {
            "authors": [
                "J.S. Tyo",
                "D.L. Goldstein",
                "D.B. Chenault",
                "J.A. Shaw"
            ],
            "title": "Review of passive imaging polarimetry for remote sensing applications",
            "venue": "Appl. Opt",
            "year": 2006
        },
        {
            "authors": [
                "Pierangelo",
                "A. et al. Polarimetric imaging of uterine cervix"
            ],
            "title": "a case study",
            "venue": "Opt. Express 21, 14120",
            "year": 2013
        },
        {
            "authors": [
                "A Crespi"
            ],
            "title": "Integrated photonic quantum gates for polarization qubits",
            "venue": "Nat. Commun",
            "year": 2011
        },
        {
            "authors": [
                "Nicholls",
                "L. H"
            ],
            "title": "Ultrafast synthesis and switching of light polarization in nonlinear anisotropic metamaterials",
            "venue": "Nat. Photon",
            "year": 2017
        },
        {
            "authors": [
                "J.P.B. Mueller",
                "N.A. Rubin",
                "R.C. Devlin",
                "B. Groever",
                "Capasso",
                "F. Metasurface polarization optics"
            ],
            "title": "independent phase control of arbitrary orthogonal states of polarization",
            "venue": "Phys. Rev. Lett. 118, 113901",
            "year": 2017
        },
        {
            "authors": [
                "S. Biswas",
                "M.Y. Grajower",
                "K. Watanabe",
                "T. Taniguchi",
                "H.A. Atwater"
            ],
            "title": "Broadband electro-optic polarization conversion with atomically thin black phosphorus",
            "venue": "Science 374,",
            "year": 2021
        },
        {
            "authors": [
                "R.M.A. Azzam"
            ],
            "title": "Stokes-vector and Mueller-matrix polarimetry",
            "venue": "J. Opt. Soc. Am. A 33,",
            "year": 2016
        },
        {
            "authors": [
                "Tyo",
                "J.S. Design of optimal polarimeters"
            ],
            "title": "maximization of signal-tonoise ratio and minimization of systematic error",
            "venue": "Appl. Opt. 41, 619\u2013630",
            "year": 2002
        },
        {
            "authors": [
                "A. Ling",
                "K.P. Soh",
                "A. Lamas-Linares",
                "C. Kurtsiefer"
            ],
            "title": "Experimental polarization state tomography using optimal polarimeters",
            "venue": "Phys. Rev. A",
            "year": 2006
        },
        {
            "authors": [
                "F. Afshinmanesh",
                "J.S. White",
                "W. Cai",
                "M.L. Brongersma"
            ],
            "title": "Measurement of the polarization state of light using an integrated plasmonic polarimeter",
            "venue": "Nanophotonics 1,",
            "year": 2012
        },
        {
            "authors": [
                "A. Pors",
                "M.G. Nielsen",
                "S.I. Bozhevolnyi"
            ],
            "title": "Plasmonic metagratings for simultaneous determination of Stokes parameters",
            "venue": "Optica 2,",
            "year": 2015
        },
        {
            "authors": [
                "J Bai"
            ],
            "title": "Chip-integrated plasmonic flat optics for mid-infrared full-Stokes polarization detection",
            "venue": "Photonics Res",
            "year": 2019
        },
        {
            "authors": [
                "J.P.B. Mueller",
                "K. Leosson",
                "F. Capasso"
            ],
            "title": "Ultracompact metasurface in-line polarimeter",
            "venue": "Optica 3,",
            "year": 2016
        },
        {
            "authors": [
                "Rubin",
                "N. A"
            ],
            "title": "Polarization state generation and measurement with a single metasurface",
            "venue": "Opt. Express",
            "year": 2018
        },
        {
            "authors": [
                "X Zhang"
            ],
            "title": "Direct polarizationmeasurement usingamultiplexed Pancharatnam-Berry metahologram",
            "venue": "Optica 6,",
            "year": 2019
        },
        {
            "authors": [
                "E. Arbabi",
                "S.M. Kamali",
                "A. Arbabi",
                "A. Faraon"
            ],
            "title": "Full-stokes imaging polarimetry using dielectric metasurfaces",
            "venue": "ACS Photonics",
            "year": 2018
        },
        {
            "authors": [
                "Rubin",
                "N. A"
            ],
            "title": "Matrix Fourier optics enables a compact fullStokes polarization camera",
            "venue": "Science 365,",
            "year": 2019
        },
        {
            "authors": [
                "C He"
            ],
            "title": "Full Poincar\u00e9 polarimetry enabled through physical inference",
            "venue": "Optica 9,",
            "year": 2022
        },
        {
            "authors": [
                "A. Aiello",
                "F. T\u00f6ppel",
                "C. Marquardt",
                "E. Giacobino",
                "G. Leuchs"
            ],
            "title": "Quantum-like nonseparable structures in optical beams",
            "venue": "N. J. Phys. 17,",
            "year": 2015
        },
        {
            "authors": [
                "V D\u2019Ambrosio"
            ],
            "title": "Photonic polarization gears for ultra-sensitive angular measurements",
            "venue": "Nat. Commun",
            "year": 2013
        },
        {
            "authors": [
                "S Berg-Johansen"
            ],
            "title": "Classically entangled optical beams for high-speed kinematic sensing",
            "venue": "Optica 2,",
            "year": 2015
        },
        {
            "authors": [
                "Z Zhu"
            ],
            "title": "Compensation-free high-dimensional free-space optical communication using turbulence-resilient vector beams",
            "venue": "Nat. Commun",
            "year": 2021
        },
        {
            "authors": [
                "I Nape"
            ],
            "title": "Revealing the invarianceof vectorial structured light in complex media",
            "venue": "Nat. Photon",
            "year": 2022
        },
        {
            "authors": [
                "S Sederberg"
            ],
            "title": "Vectorized optoelectronic control and metrology in a semiconductor",
            "venue": "Nat. Photon",
            "year": 2020
        },
        {
            "authors": [
                "M. El Ketara",
                "H. Kobayashi",
                "E. Brasselet"
            ],
            "title": "Sensitive vectorial optomechanical footprint of light in soft condensed matter",
            "venue": "Nat. Photon",
            "year": 2021
        },
        {
            "authors": [
                "V Parigi"
            ],
            "title": "Storage and retrieval of vector beams of light in a multiple-degree-of-freedom quantum memory",
            "venue": "Nat. Commun",
            "year": 2015
        },
        {
            "authors": [
                "B Ndagano"
            ],
            "title": "Characterizing quantum channels with nonseparable states of classical light",
            "venue": "Nat. Phys. 13,",
            "year": 2017
        },
        {
            "authors": [
                "M. Fridman",
                "M. Nixon",
                "E. Grinvald",
                "N. Davidson",
                "A.A. Friesem"
            ],
            "title": "Real-timemeasurement of space-variant polarizations.Opt",
            "venue": "Expess 18,",
            "year": 2010
        },
        {
            "authors": [
                "B Zhao"
            ],
            "title": "Real-time Stokes polarimetry using a digital micromirror device",
            "venue": "Opt. Express",
            "year": 2019
        },
        {
            "authors": [
                "A Manthalkar"
            ],
            "title": "All-digital Stokes polarimetry with a digital micromirror device",
            "venue": "Opt. Lett. 45,",
            "year": 2020
        },
        {
            "authors": [
                "A. Selyem",
                "C. Rosales-Guzm\u00e1n",
                "S. Croke",
                "A. Forbes",
                "S. FrankeArnold"
            ],
            "title": "Basis-independent tomography and nonseparability witnesses of pure complex vectorial light fields by Stokes projections",
            "venue": "Phys. Rev. A 100,",
            "year": 2019
        },
        {
            "authors": [
                "Al Khafaji",
                "M. A"
            ],
            "title": "Single-shot characterization of vector beams by generalized measurements",
            "venue": "Opt. Express 30,",
            "year": 2022
        },
        {
            "authors": [
                "M. Belkin",
                "D. Hsu",
                "S. Ma",
                "S. Mandal"
            ],
            "title": "Reconciling modern machine-learning practice and the classical bias-variance trade-off",
            "venue": "Proc. Natl Acad. Sci. USA",
            "year": 2019
        },
        {
            "authors": [
                "Popoff",
                "S.M. et al. Measuring the transmission matrix in optics"
            ],
            "title": "an approach to the study and control of light propagation in disordered media",
            "venue": "Phys. Rev. Lett. 104, 100601",
            "year": 2010
        },
        {
            "authors": [
                "I. Freund"
            ],
            "title": "Looking through walls and around corners",
            "venue": "Phys. A Stat. Mech. Appl. 168,",
            "year": 1990
        },
        {
            "authors": [
                "I.M. Vellekoop",
                "A. Lagendijk",
                "A.P. Mosk"
            ],
            "title": "Exploiting disorder for perfect focusing",
            "venue": "Nat. Photon",
            "year": 2010
        },
        {
            "authors": [
                "T. Kohlgraf-Owens",
                "A. Dogariu"
            ],
            "title": "Spatially resolved scattering polarimeter",
            "venue": "Opt. Lett. 34,",
            "year": 2009
        },
        {
            "authors": [
                "T. Kohlgraf-Owens",
                "Dogariu",
                "A. Transmission matrices of random media"
            ],
            "title": "means for spectral polarimetric measurements",
            "venue": "Opt. Lett. 35, 2236",
            "year": 2010
        },
        {
            "authors": [
                "B. Redding",
                "S.F. Liew",
                "R. Sarma",
                "H. Cao"
            ],
            "title": "Compact spectrometer basedonadisorderedphotonic chip.Nat",
            "venue": "Photon. 7,",
            "year": 2013
        },
        {
            "authors": [
                "D. Pierangeli",
                "M. Rafayelyan",
                "C. Conti",
                "S. Gigan"
            ],
            "title": "Scalable spinglass optical simulator",
            "venue": "Phys. Rev. Appl. 15,",
            "year": 2021
        },
        {
            "authors": [
                "H.B. de Aguiar",
                "S. Gigan",
                "S. Brasselet"
            ],
            "title": "Polarization recovery through scattering media",
            "venue": "Sci. Adv. 3,",
            "year": 2017
        },
        {
            "authors": [
                "N. Borhani",
                "E. Kakkava",
                "C. Moser",
                "D. Psaltis"
            ],
            "title": "Learning to see through multimode fibers",
            "venue": "Optica 5,",
            "year": 2018
        },
        {
            "authors": [
                "G.B. Huang",
                "H. Zhou",
                "X. Ding",
                "R. Zhang"
            ],
            "title": "Extreme learning machine for regression and multiclass classification",
            "venue": "IEEE Trans. Syst. Man Cybern. Part B",
            "year": 2012
        },
        {
            "authors": [
                "G Wetzstein"
            ],
            "title": "Inference in artificial intelligence with deep optics and photonics",
            "venue": "Nature 588,",
            "year": 2020
        },
        {
            "authors": [
                "Saade",
                "A. et al. Random projections through multiple optical scattering"
            ],
            "title": "approximating kernels at the speed of light",
            "venue": "In IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP) 6215\u20136219",
            "year": 2016
        },
        {
            "authors": [
                "G. Marcucci",
                "D. Pierangeli",
                "Conti",
                "C. Theory of neuromorphic computing by waves"
            ],
            "title": "machine learning by rogue waves, dispersive shocks, and solitons",
            "venue": "Phys. Rev. Lett. 125, 093901 (2020). Article https://doi.org/10.1038/s41467-023-37474-0 Nature Communications |",
            "year": 2023
        },
        {
            "authors": [
                "D. Pierangeli",
                "G. Marcucci",
                "C. Conti"
            ],
            "title": "Photonic extreme learning machine by free-space optical propagation",
            "venue": "Photonics Res",
            "year": 2021
        },
        {
            "authors": [
                "M. Rafayelyan",
                "J. Dong",
                "Y. Tan",
                "F. Krzakala",
                "S. Gigan"
            ],
            "title": "Large-scale optical reservoir computing for spatiotemporal chaotic systems prediction",
            "venue": "Phys. Rev. X 10,",
            "year": 2020
        },
        {
            "authors": [
                "R Mirek"
            ],
            "title": "Neuromorphic binarized polariton networks",
            "venue": "Nano Lett. 21,",
            "year": 2021
        },
        {
            "authors": [
                "U. Tegin",
                "M. Yildirim",
                "I. Oguz",
                "C. Moser",
                "D. Psaltis"
            ],
            "title": "Scalable optical learning",
            "venue": "operator. Nat. Comput. Sci",
            "year": 2021
        },
        {
            "authors": [
                "Z. Denis",
                "I. Favero",
                "C. Ciuti"
            ],
            "title": "Photonic Kernel machine learning for ultrafast spectral analysis",
            "venue": "Phys. Rev. Appl. 17,",
            "year": 2022
        },
        {
            "authors": [
                "C.M. Valensise",
                "I. Grecco",
                "D. Pierangeli",
                "C. Conti"
            ],
            "title": "Large-scale photonic natural language processing",
            "venue": "Photonics Res",
            "year": 2022
        },
        {
            "authors": [
                "J.B. Altepeter",
                "E.R. Jeffrey",
                "P.G. Kwiat"
            ],
            "title": "Photonic state tomography",
            "venue": "Adv. At., Mol. Opt. Phys. 52,",
            "year": 2005
        },
        {
            "authors": [
                "V Kumar"
            ],
            "title": "Deterministic Terahertz wave control in scattering media",
            "venue": "ACS Photonics",
            "year": 2022
        },
        {
            "authors": [
                "A. Aiello",
                "P. Banzer",
                "M. Neugebauer",
                "G. Leuchs"
            ],
            "title": "From transverse angular momentum to photonic wheels",
            "venue": "Nat. Photon",
            "year": 2015
        },
        {
            "authors": [
                "A. Di Falco",
                "V. Mazzone",
                "A. Cruz",
                "A. Fratalocchi"
            ],
            "title": "Perfect secrecy cryptography via mixing of chaotic waves in irreversible timevarying silicon chips",
            "venue": "Nat. Commun",
            "year": 2019
        }
    ],
    "sections": [
        {
            "text": "Single-shot polarimetry of vector beams by supervised learning\nDavide Pierangeli 1,2 & Claudio Conti 2,3\nStates of light encoding multiple polarizations - vector beams - offer unique capabilities in metrology and communication. However, their practical application is limited by the lack of methods for measuring many polarizations in a scalable and compact way. Here we demonstrate polarimetry of vector beams in a single shot without any polarization optics. Wemap the beampolarization content into a spatial intensity distribution through light scattering andexploit supervised learning for single-shot measurements of multiple polarizations. We characterize structured light encoding up to nine polarizations with accuracy beyond 95% on each Stokes parameter. Themethod also allows us to classify beamswith an unknownnumber of polarizationmodes, a functionality missing in conventional techniques. Our findings enable a fast and compact polarimeter for polarization-structured light, a general tool that may radically impact optical devices for sensing, imaging, and computing.\nGenerating, manipulating, and detecting the optical state of polarization (SOP) is of paramount importance in many areas, such as optical communication1, sensing2, microscopy3, and quantum information and computation4. While progress in material growth and nanotechnology are enabling advances in active polarization control5\u20137, the measurement of light polarization remains limited by its intrinsic vectorial nature. Complete determinationof a single SOPneeds at least four individual measurements, each projecting the state on a distinct vector8\u201310. Conventional polarimetry methods replicate in time or space the polarization analyzer, which results in bulky optical setups, or in costly compact polarimeters based onmetasurfaces11\u201318. While for uniformly-polarized light the need for several measurements is still affordable and can bemitigated by using specific optical devices19, it becomes a serious issue for beams with a spatial polarization structure.\nLight with non-uniform polarization across the transverse plane exhibits non-separable correlations between polarization and spatial modes20. These vector beams recently have disclosed unique potentials in metrology21\u201323, communication24,25, optoelectronics26, optomechanics27, and quantum information28,29. However, their characterization still relies on bulky polarization optics30\u201334. Fast, accurate, and compact polarizationmeasurement is crucial for exploiting vector beams in widespread applications.\nIn this article, we demonstrate compact single-shot measurements of multiple polarizations by photonic machine learning. We map the beam polarizations into a complex spatial distribution of intensity corresponding to a point in a high-dimensional feature space. Then, supervised learning extracts polarization information from the intensity data. The critical point is that we avoid projecting on a polarization basis and perform no direct operation on the polarization state. The method thus removes the need for polarization optics and engineered devices in polarization imaging. We report accurate measurements of various beams encodingmultiple SOP, including the case inwhich the number of polarizationmodes is unknown and inferredby the measurements. An unexpected outcome is the experimental evidence of the double descent, a phenomenon that is attracting attention in machine learning35. The double descent increases the classification accuracy when the dimension of the feature space is large. This effect improves the observation fidelity of themultiple SOP and enables high-precision measurements."
        },
        {
            "heading": "Results",
            "text": "Single-shot polarimetry via light scattering and learning Figure 1 reports our methodology. We show a representation of the SOP given by the four-component vector \u2223si= \u2223S1, S2, S3, S0 , with Stokes parameters Si. The system phase space is the unit sphere,\nReceived: 27 September 2022\nAccepted: 15 March 2023\nCheck for updates\n1Institute for Complex Systems - National Research Council (ISC-CNR), 00185 Rome, Italy. 2Physics Department, Sapienza University of Rome, 00185 Rome, Italy. 3Research Center Enrico Fermi (CREF), 00184 Rome, Italy. e-mail: davide.pierangeli@roma1.infn.it\nNature Communications | (2023) 14:1831 1\n12 34\n56 78\n9 0 () :,;\n12 34\n56 78\n9 0 () :,;\nknown as the Poincar\u00e9-Bloch (PB) sphere. A projective measurement returns the components of the incident state \u2223si in a set of analysis vectors (Fig. 1a). Given a minimal set of four independent detected optical powers \u2223p\n= \u2223p1,p2,p3,p4 , the measured state is obtained as\n\u2223sm = P\u0302\n1 \u2223p , where P\u0302 is the instrument matrix9,10.\nIn our single-shot polarimetry (Fig. 1b), the light beam interacts with a physical object that transforms the input polarization into a set of features. The object can be any polarization-dependent optical system, such as a diffractive element, a disordered medium, etc., and its details can be unknown to the observer. The feature set at the readout is composed of an ensamble of different observable quantities. Specifically, we consider the field intensity at different n spatial positions. An intensity measurement collects the values \u2223xi= \u2223x1, x2,:::, xn . The polarization state is determined by a linear operation as\n\u2223so = \u03b2\u0302\u2223xi, \u00f01\u00de\nwhere the \u03b2\u0302 operator is a 4 \u00d7 n matrix, which we refer to as the calibration matrix of the instrument. Crucially, \u03b2\u0302 is not determined apriori, but retrieved by experimental data via machine learning.\nThe key point of our single-shot method is the redundant mapping of a polarization state, determined by four observables, to a state belonging to amuch larger space, defined by n observables. If n is very large, the redundancy makes the method very advantageous to measure light beams that encode many polarizations in distinct spatial opticalmodes (vector beams).We consider a beamcontaining D different polarization states. The corresponding multiple SOP can be expressed as \u2223si= \u2223s1 \u2223s2 ::: \u2223sD , where \u2223s j denotes the Stokes vector of the j-th mode. The observation of multiple SOP with conventional polarization tomography requires at least 4D projections or 4D generalizedmeasurements34. On the contrary, we observe the state \u2223so , composed of D individual SOP, with a single-shot measurement by using the higher-dimensional data vector \u2223xi. The\nnecessary calibration matrix \u03b2\u0302 of size 4D \u00d7 n is determined by an initial training phase. The scheme is scalable with the dimension D of the multiple SOP, at variance with projective measurement setups where additional detectors are required. In our case, we can observe input states \u2223si of variable dimension by adopting a unique feature space. This property means we can obtain, through the same detected signal, additional beam parameters otherwise difficult to access.\nSingle-shot polarimetry is experimentally implemented by using the scheme illustrated in Fig. 2. The optical setup is composed of two parts: a generator that produces vector beams and a single-shot polarization analyzer that realizes the optical transformation and collects the resulting intensity (details in Methods). To generate multiple SOP we exploit a phase-only spatial light modulator (SLM). This allows shaping a large number of different polarizations on thewavefront of a single \u03bb = 532nm laser beam, with distinct states \u2223s j that correspond to spatially-separated modes with phase \u03d5j (see Supplementary Note 1). The single-shot analyzer exploits light scattering36. In fact, it is known that multiple scattering from random media can be harnessed to perform deterministic operations on an incident electromagnetic field37. The ideahave resulted in optical instruments basedondisorder, such as lenses38, polarimeters39, beam analyzers40, and compact spectrometers41, but also in effective schemes for optical computing42. In our experiment, we use light scattering from a glass diffuser to map the SOP into intensity data. The scattering medium spatially mixes the impinging optical field and transmits a disordered field. The resulting speckle pattern is imaged on a camera sensor with no polarization filters. The entire polarization content of the incoming beam is hidden within this intensity distribution. However, at variance from disorderbased photonic instruments39\u201341, our method does not require determining the transmission operator to perform the measurement. We simply get an image whose spatial details depend on the polarizations of the vector beam. By sampling the image, we obtain the output data \u2223xi, which encodes the input polarizations into a higher-dimensional feature space. The mapping can be performed by any optical system\nFig. 1 | Observing many polarizations in a single shot. a Conventional polarimetry relies on projective measurements: the state of polarization (SOP) \u2223si = \u2223S1, S2, S3, S0 , a point on the Poincar\u00e9-Bloch sphere, is processed by distinct detectors, each analyzing one component. b In our single-shot method, the SOP is mapped onto a high-dimensional phase space (false-color map) where data were collected. The black box represents the transformation setup, i.e., any optical\nsystem with a polarization-dependent response: disordered media, nonlinear materials, optical devices, etc. The SOP is identified in the feature space by supervised learning. When measuring a vector beam composed by 1, 2, ..., D different polarizations, the projective analysis necessitates 4D measurements, while we use a single intensity distribution embedding all information.\nNature Communications | (2023) 14:1831 2\nsensitive to the input polarization such as optical fibers and nonlinear materials.\nTo understand the role of coupling between polarization and spatial degrees of freedom, we differentiate two cases. For D = 1, a necessary working condition is a scatterer that couples polarization and amplitude spatialmodes. In fact, different input SOP have to result in distinguishable intensity distributions to obtain distinct measurement outcomes. Surprisingly, for vector beams (D > 1), coupling generated by the scatterer is no longer necessary. In this case, the partitioning of the impinging beam induces sufficient interaction (see Supplementary Note 2). In experiments, we vary the polarizationspatial coupling by testing glass diffusers of various roughness, which induce a different amount of depolarization43. We found comparable performance in all the considered samples. Hereafter, we report results in the case of small coupling, corresponding to transmitted light with a degree of polarization close to one (see Supplementary Note 3).\nTo extract polarization information from the intensity data, we use supervised learning. Among the various neural network architectures that have been proved convenient for optical systems44, we adopt the extreme learning machine (ELM)45. ELM allows fast and easy training with several thousands of network nodes, thus being especially suited to large-scale photonic implementations46\u201354. To apply the ELM algorithm, we construct a readout layer by a random selection of 4M output camera channels (Fig. 2b). Each channel has a linear weight \u03b2ji, with i = 1, ..., 4M and j = 1, ..., D, which form the calibration matrix in Eq. (1). Training consists in adjusting these parameters according to a labeled dataset via ridge regression (see Methods)."
        },
        {
            "heading": "Machine-learning polarimeter",
            "text": "Figure 3 shows the single-shot polarimetry of a single SOP. We generate Ntrain samples randomly distributed on the PB sphere (Fig. 3a) and validate the calibrated single-shot analyzer on Ntest unknown SOP. As reported in Fig. 3b, the observed polarizations correspond to the input within a distance d =0.014 \u00b10.002 (see Methods). Each measured Stokes parameter Si is in remarkable agreement with its target value (Fig. 3c). The accuracy of the machine-learning polarimeter is investigatedby varying thenumber of network channelsM and the size Ntrain of the calibration dataset. Results in Fig. 3d show the behavior of the Stokes error E(Si). We find that single-shot measurements become extremely accurate when M increases (E(Si) = 0.0075).\nThe observed error peak in Fig. 3d discloses the so-called double descent35. Above the interpolation threshold, the accuracy increases with the number of channels with no overfitting. We find that the\ninterpolation threshold shifts with the training dataset size (Fig. 3d), with a maximum error for M\u2243Ntrain. This point marks a critical condition in ELMmade with physical systems48. Experimental observation of the double descent is made possible by the huge number of output nodes of our optical setup54. We exploit the effect to enhance the polarimeter precision. On the other hand, we underline that a few hundred channels are sufficient for effective measurements. Figure 3f shows the accuracy matrix a\u0302, which also includes the degree of polarization \u03bd. The single-shot results match well data from a conventional rotating-waveplate polarimeter. With reference to singlequbit tomography55, we obtain a fidelity F(\u03c1s, \u03c1m) = 0.99 \u00b1 0.01, where \u03c1s and \u03c1m are the density matrices obtained via single-shot and multiple projections.\nSingle-shot polarimetry of vector beams In Fig. 4, we report single-shot polarization measurements of partitioned vector beams with four SOP. Calibration operates alike the single polarization case, but with Ntrain states of dimension D = 4. Figure 4a shows the intensity of an unknownmultiple SOP generated by four random phases \u03d5i on four spatial modes. The effect of diffraction between adjacent SOP is visible. By collecting the transformed intensity image, we reveal the full polarization structure in a single shot, as shown by the polarization ellipses in Fig. 4b. Conventional projective polarization tomography (Fig. 4c) strikingly agrees with the single-shot observation. The overall uncertainty of the detection for D = 4 is evaluated in Fig. 4d by varying M up to 4M = 52,000 total channels. The error decreases with M, with localized peaks that indicate the interpolation threshold. The fidelity is confirmed by the overlap matrix a\u0302 in Fig. 4e, with Tr a\u0302 =4D =0:95 accuracy. We succeed in characterizing with high accuracy beams encoding up to nine SOP. This implies a single-shot reconstruction of a classical state \u2223si lying in a 27-dimensional phase space. To implement larger systems, we expand the spatial extent of the input and output optical planes. Figure 5a shows the intensity of a beam encodingmultiple SOP withD = 9. The result of the single-shot detection agrees with the state we get frommultiple projections (Fig. 5b, c). The comparison, with the a\u0302 matrix having 1296 entries, gives a 0.91 overlap between the polarization states measured by using the two methods. The single-shot observation is hence performed with high precision, as also the measurement error in Fig. 5d indicates. Interestingly, we observe that the distance d decreases rapidly with M and gets stuck into a broad plateau. This behavior underlines the enormous complexity of the states that we are characterizing. Even if, in Fig. 5d, we do not observe any\nNature Communications | (2023) 14:1831 3\ninterpolation threshold, as more output channels would be necessary, the method still enables accurate measurements."
        },
        {
            "heading": "Measuring the number of polarizations",
            "text": "In themost general case of an unknownmultiple-polarization state, its dimensionD is also an unknown variable. We demonstrate that we can identify the dimensionality of the multiple SOP. To train the setup, the calibration dataset includes beams with a variable number of partitions, and D as an additional target parameter. Figure 6a reports the confusion matrix obtained for vector beams having three possible partition configurations (D = 1, D = 4, and D = 9), with M = 10,000. Thedimension is foundwith anaccuracy that exceeds 98%. In addition, the set of Stokes parameters ismeasuredwith precision comparable to cases of known dimension (E(Si) = 0.057). For D = 9, a comparison between the entire Sidistribution is shown in Fig. 6b. Therefore, we not only perform single-shot polarimetry of beams encoding nine polarizations, but we carry out the measurement not knowing that the overall polarization vector has nine dimensions. It is important to note that dimension D is not directly measurable by using multiple projective measurements."
        },
        {
            "heading": "Discussion",
            "text": "We have experimentally demonstrated the measurement of multiple polarizations in a single shotwithout polarizationoptics. The result has\nbeen obtained with an original method that combines physical transformation between polarization and spatial degrees of freedom with machine learning to get unprecedented information in a single detection. This approach demonstrates photonicmachine learning for a challenging optical application, i.e., polarization imaging.\nOur measurement scheme has no bulky optical components and can operate at any wavelength. This allows to overcome the narrowbandoperationof all polarization camerasbasedon integrateddevices andmetasurfaces17,18. In our setup, both the scattering process and the learning procedure are efficient on a broad spectrum. As the transmitted intensity distribution is highly sensitive to the incoming spectrum, we expect our polarization imaging is able to operate on broadband light by training a wavelength-dependent instrument matrix \u03b2\u0302\u00f0\u03bb\u00de. The single-shot polarimeter is hence compact, without moving components, broadband, and does not require nanofabrication. Moreover, it provides direct access to properties of the vector field otherwise difficult to quantify, as we demonstrate by measuring the unknown number of polarizations within the vector beam. The device can be developed further by using unsupervised learning methods such as variational autoencoders that generate Stokes parameter distributions from the detected sparse data.\nThese findings empower compact single-shot polarimetry based on machine learning in a wide variety of contexts, from optical networking to biomedical devices. We foresee the extension of our\nFig. 3 | Polarization measurements by supervised learning. a Training dataset made by Ntrain randomly-selected polarizations. b, c Measured SOP and corresponding Stokes parameters (purple), along with their unknown values used for testing (orange). For clarity, only a subset of samples is shown. d Testing error E(Si) on each Stokes parameter versus the number of readout channels. The error peak\n(interpolation threshold) is direct evidenceof the double-descent effect. eDistance between the measured and generated SOP varying the number of training samples and channels. f Accuracy matrix (see Methods) comparing single-shot (M = 200) and conventional polarimetry performed via multiple projections.\nNature Communications | (2023) 14:1831 4\nsingle-shot approach to the entire electromagnetic spectrum56, to subwavelength and topological optical fields, and, more generally, to other optical degrees of freedom57, with applications where conventional instruments are useless, as in edge devices and photonic chips58. Moreover, partitioned vector beams of quantum light can encode many qubits. Therefore, our results may also open exciting perspectives in the quantum domain, with the possibility to benefit from single-shot polarimetry by machine learning."
        },
        {
            "heading": "Methods",
            "text": ""
        },
        {
            "heading": "Experimental setup",
            "text": "The experimental setup follows the sketch in Fig. 2. A continuouswave laser beamwith wavelength \u03bb = 532 nm (LaserQuantum Ventus 532, 250mW) is expanded and linearly polarized along the horizontal (H) direction (x-axis) with a linear polarizer (LP). The vector beam generator is composed of a reflective phase-only SLM (Hamamatsu X13138, 1280 \u00d7 1024 pixels, 12.5 \u03bcm pixel pitch, 60Hz frame rate) sandwiched between an input half-waveplate (HWP) and an output polarization system made by a quarter-waveplate (QWP) and HWP. The output waveplates are equipped with motorized precision rotation stages (MS) (25\u00b0/s maximum rotation velocity) that are programmed online. Their fast axes form respectively an angle \u03b1 and \u03b2with the x-axis. The parameters \u03b1 and \u03b2 are varied with 2\u00b0 resolutions during both training and testing. By grouping L \u00d7 L SLM pixels, the modulator active area is divided into D squared input modes, with each mode having a phase \u03d5j in the [0, 2\u03c0]\nfor D = 4.\nNature Communications | (2023) 14:1831 5\ninterval. The available phase levels are 210, distributed according to a linear phase response curve59. Polarization-modulated light is focused by a plano-convex lens (f = 150mm) on a scatteringmedium (Thorlabs N-BK7 GroundGlass Diffusers, 1500 grit) positioned using a four-axis translational stage. The scattered field is collected by an imaging objective (NA = 0.25) and the transmitted speckle pattern is detected by a cooled camera (Basler a2A1920-160umPRO, 1920 \u00d7 1200 pixels, 160 fps) with 12-bit (4096 gray-levels) intensity sensitivity. Within the camera region of interest, 4M output channels are randomly pre-selected. The signal is obtained by binning over a few camera pixels (4 \u00d7 4 pixels) to reduce detection noise. Output channels have a size comparable to the spatial extent of a speckle grain. For reference measurements, a portion of the polarization-modulated beam is split and analyzed by using conventional polarimetry. A commercial rotating-waveplate polarimeter (PAX1000VIS, 0.25\u2218 accuracy) is used for a single SOP. For projective polarization imaging of vector beams, we use a custom rotating-waveplate analyzer composed of aQWP, an LP, and a CMOS camera (DCC1545M). Intensity projections are measured along the horizontal (H), vertical (V), diagonal (D), and right circular (R) components, i.e., pH, pV, pD, and pR are the detected power. An example of projective analysis for a partitioned vector beam is shown in Supplementary Fig. 2."
        },
        {
            "heading": "Training method",
            "text": "Calibration of the setup for single-shot polarization measurements is performed by generating Ntrain vector beams and by loading one-byone the corresponding phase mask on the SLM. For the l-th training sample, the output waveplates of the vector beam generator are rotated to a couple of parameters \u03b1l and \u03b2l (Supplementary Note 1). The dataset f\u03d5jl ,\u03b1l ,\u03b2lg is randomly generated to cover the entire phase space.When the polarizationdimensionD need also to be determined, the training set is composed of states whose number of polarizations varies within the dataset. Intensity values from the 4M output channels are stored (Supplementary Fig. 6). We increase linearly the number of selected channels when increasing the dimension. In the case of D = 9, for the feasibility of training, we consider a maximum value of M = 13,000. For the measurement of multiple SOP with an unknown polarization number, M additional channels are used to reconstruct D. The calibration weights \u03b2ji are determined by applying the training algorithm to the entire set of acquired data. The obtained\ncalibration matrix \u03b2\u0302 is used to measure Ntest random SOP. We use a ratio Ntest/Ntrain = 0.1.\nExtracting polarizations from intensity data In our setup, the scattering medium creates a mapping between the incoming polarization set and a higher-dimensional feature space. This general mechanism underlies physical implementations of ELM and kernel machines for neuromorphic computing47,49,52. In our case, the scheme is trained to perform physical measurements. To determine the calibration matrix \u03b2\u0302 by using 4M output channels, we consider a training set of randomly-selected Stokes vectors f\u2223sig S as target vectors (Ntrain \u00d7 4D sized). The corresponding acquired intensity matrix is f\u2223xig X, with size Ntrain \u00d7 4M (M\u226bD). Training corresponds to solving numerically the ridge regression problem:\nargmin\u03b2\u0302\u00f0k X\u03b2\u0302 Sk2 + c 1 k \u03b2\u0302k2\u00de, \u00f02\u00de\nwhere parameter c controls the trade-off between the training error and the regularization. A solution is given by45\n\u03b2\u0302 = XTX+ cI 1 XTS, \u00f03\u00de\nwhere I is the identity matrix. Inversion involves the 4M \u00d7 4M matrix XTX, whichmakes themethod scalable asM is selectedby theobserver. Therefore, given an unknown multiple SOP and the corresponding single-shot intensity vector \u2223xi, the observed state can be expressed as\n\u2223so = XTX+ cI 1 XTS\u2223xi: \u00f04\u00de\nAn explicit expression for xi is reported in Supplementary Note 2. In the case of a single SOP, the measured Stokes parameters from single-shot intensity data are\nSi = XM\nk = 1\n\u03b2kxk : \u00f05\u00de\nEach Si is hence decoded throughM weights. An example of both the acquired intensity and calibration matrix (c = 1) is reported in Supplementary Note 4."
        },
        {
            "heading": "Analysis of the measurements",
            "text": "To quantify the accuracy of the single-shot polarimeter, as a testing error on the i-th Stokes parameter, we use the mean-absolute-error (MAE) E\u00f0Si\u00de= \u2223Ssi Sgi \u2223 , in which the apex stands for single-shot (s) and generated (g), and the average is over Ntest samples. Instead of S0, we report the degree of polarization \u03bd = ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi S21 + S 2 2 + S 2 3 q =S0, which quantifies the amount of unpolarized light. The distance between two SOP on the PB sphere is computed as d = ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiP iE\u00f0Si\u00de2 q . The accuracy values with respect to projective measurements are aij = 1 \u2212Oij, with the overlap Oij = \u2223S s i Smi \u2223 , with apex m stands for multiple measurements. It is worth noting that this comparison includes also the inaccuracy of the SOP generator and the uncertainty of the conventional polarization analyzer (Supplementary Fig. 2). For beams with a single SOP, the fidelity is computed in analogy with quantum state tomography as55F\u00f0\u03c1s,\u03c1m\u00de=Tr ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi \u03c1m p \u03c1s ffiffiffiffiffiffi \u03c1m pp 2 , where the density matrix is \u03c1= 1=2\u00f0PiSi\u03c3\u0302i\u00de with Pauli matrices \u03c3\u0302i."
        },
        {
            "heading": "Reporting summary",
            "text": "Further information on research design is available in the Nature Portfolio Reporting Summary linked to this article.\nNature Communications | (2023) 14:1831 6"
        },
        {
            "heading": "Data availability",
            "text": "All relevant data that support the findings of this study are available within the article and supplementary information. Any additional data are available from the corresponding author upon request."
        },
        {
            "heading": "Code availability",
            "text": "The code used in the present study are available from the corresponding author upon request."
        },
        {
            "heading": "Acknowledgements",
            "text": "We acknowledge funding from the Italian Ministry of University and Research (PRIN PELM 20177PSCKT, C.C.), and FLAG-ERA JTC 2019 (MARGO). We thank L. Dieli for useful discussions, I. MD Deen and F. Farrelly for technical support in the laboratory."
        },
        {
            "heading": "Author contributions",
            "text": "D.P. and C.C. developed the idea andwrote themanuscript. D.P. carried out the experiments and data analysis."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41467-023-37474-0.\nCorrespondence and requests for materials should be addressed to Davide Pierangeli.\nPeer review information Nature Communications thanks the anonymous reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.\nReprints and permissions information is available at http://www.nature.com/reprints\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/ licenses/by/4.0/.\n\u00a9 The Author(s) 2023\nNature Communications | (2023) 14:1831 8"
        }
    ],
    "title": "Single-shot polarimetry of vector beams by supervised learning",
    "year": 2023
}