{
    "abstractText": "Motor systems show an overall robustness, but because they are highly nonlinear, understanding how they achieve robustness is difficult. In many rhythmic systems, robustness against perturbations involves response of both the shape and the timing of the trajectory. This makes the study of robustness even more challenging. To understand how a motor system produces robust behaviors in a variable environment, we consider a neuromechanical model of motor patterns in the feeding apparatus of the marine mollusk Aplysia californica (Shaw et al. in J Comput Neurosci 38(1):25\u201351, 2015; Lyttle et al. in Biol Cybern 111(1):25\u201347, 2017). We established in (Wang et al. in SIAM J Appl Dyn Syst 20(2):701\u2013744, 2021. https://doi.org/10.1137/ 20M1344974) the tools for studying combined shape and timing responses of limit cycle systems under sustained perturbations and here apply them to study robustness of the neuromechanical model against increased mechanical load during swallowing. Interestingly, we discover that nonlinear biomechanical properties confer resilience by immediately increasing resistance to applied loads. In contrast, the effect of changed sensory feedback signal is significantly delayed by the firing rates\u2019 hard boundary properties. Our analysis suggests that sensory feedback contributes to robustness in swallowing primarily by shifting the timing of neural activation involved in the power stroke of the motor cycle (retraction). This effect enables the system to generate stronger retractor muscle forces to compensate for the increased load, and hence achieve strong robustness. The approaches that we are applying to understanding a neuromechanical model in Aplysia, and the results that we have obtained, are likely to provide insights into the function of other motor systems that encounter changing mechanical loads and hard boundaries, both due to mechanical and neuronal firing properties.",
    "authors": [
        {
            "affiliations": [],
            "name": "Yangyang Wang"
        },
        {
            "affiliations": [],
            "name": "Jeffrey P. Gill"
        },
        {
            "affiliations": [],
            "name": "Hillel J. Chiel"
        },
        {
            "affiliations": [],
            "name": "Peter J. Thomas"
        }
    ],
    "id": "SP:e27c0425f8de0ac5d2eae6f04e0393691d07a6d5",
    "references": [
        {
            "authors": [
                "K Aihara",
                "H Suzuki"
            ],
            "title": "Theory of hybrid dynamical systems",
            "year": 2010
        },
        {
            "authors": [
                "RD Beer",
                "CJ Hillel",
                "JC Gallagher"
            ],
            "title": "Evolution and analysis",
            "year": 1999
        },
        {
            "authors": [
                "J variability"
            ],
            "title": "Biologically inspired robotics",
            "year": 2009
        },
        {
            "authors": [
                "Springer",
                "V Berlin Brezina",
                "IV Orekhova",
                "KR Weiss"
            ],
            "title": "Optimization of rhythmic",
            "year": 2000
        },
        {
            "authors": [
                "rophysiol"
            ],
            "title": "Computational model of a",
            "year": 2006
        },
        {
            "authors": [
                "T Chartrand",
                "MS Goldman",
                "TJ Lewis"
            ],
            "title": "Synchronization of electrically coupled resonate-and-fire neurons",
            "venue": "SIAM J Appl Dyn Syst",
            "year": 2019
        },
        {
            "authors": [
                "HJ Chiel",
                "RD Beer",
                "JC Gallagher"
            ],
            "title": "Evolution and analysis of model CPGs for walking: I",
            "venue": "Dynamical modules. J Comput Neurosci",
            "year": 1999
        },
        {
            "authors": [
                "RM Costa",
                "DA Baxter",
                "JH Byrne"
            ],
            "title": "Computational model of the distributed representation of operant reward memory: combinatoric engagement of intrinsic and synaptic plasticity mechanisms",
            "year": 2020
        },
        {
            "authors": [
                "EC Cropper",
                "J Jing",
                "FS Vilim",
                "KR Weiss"
            ],
            "title": "Peptide cotransmitters as dynamic, intrinsic modulators of network activity",
            "venue": "Front Neural Circuits",
            "year": 2018
        },
        {
            "authors": [
                "CullinsMJ",
                "ShawKM",
                "Gill JP",
                "Chiel HJ"
            ],
            "title": "2015)Motor neuronal activity varies least among individuals when it matters most for behavior",
            "venue": "J Neurophysiol",
            "year": 2015
        },
        {
            "authors": [
                "L Dieci",
                "L Lopez"
            ],
            "title": "Fundamental matrix solutions of piecewise smooth differential systems",
            "venue": "Math Comput Simul",
            "year": 2011
        },
        {
            "authors": [
                "B Ermentrout"
            ],
            "title": "Neural networks as spatio-temporal patternforming systems",
            "venue": "Rep Prog Phys",
            "year": 1998
        },
        {
            "authors": [
                "AF Filippov"
            ],
            "title": "Differential equations with discontinuous righthand sides. Mathematics and its applications",
            "year": 1988
        },
        {
            "authors": [
                "FitzpatrickMN",
                "WangY",
                "Thomas PJ",
                "QuinnRD"
            ],
            "title": "Shape robotics application of a method for analytically computing infinitesimal phase response curves. In: Conference on biomimetic and biohybrid systems",
            "venue": "SzczecinskiNS",
            "year": 2020
        },
        {
            "authors": [
                "FrigonA",
                "HurteauM-F",
                "Thibaudier Y",
                "LeblondH",
                "Telonio A",
                "D\u2019Angelo G"
            ],
            "title": "Split-belt walking alters the relationship between locomotor phases and cycle duration across speeds in intact and chronic spinalized adult cats",
            "venue": "J Neurosci",
            "year": 2013
        },
        {
            "authors": [
                "JP Gill",
                "HJ Chiel"
            ],
            "title": "Rapid adaptation to changing mechanical load by ordered recruitment of identified motor neurons",
            "year": 2020
        },
        {
            "authors": [
                "C Goldsmith",
                "N Szczecinski",
                "RD Quinn"
            ],
            "title": "Drosophibot: a fruit fly inspired bio-robot. In: Conference on biomimetic and biohybrid systems",
            "year": 2019
        },
        {
            "authors": [
                "J Harris",
                "B Ermentrout"
            ],
            "title": "Bifurcations in the Wilson\u2013Cowan equations with nonsmooth firing rate",
            "venue": "SIAM J Appl Dyn Syst",
            "year": 2015
        },
        {
            "authors": [
                "B Hille"
            ],
            "title": "Ion channels of excitable membranes, 3rd edn",
            "venue": "Sinauer Associates Inc,",
            "year": 2001
        },
        {
            "authors": [
                "P Holmes",
                "RJ Full",
                "KoditschekDE",
                "J Guckenheimer"
            ],
            "title": "The dynamics of legged locomotion: models, analyses, and challenges",
            "year": 2006
        },
        {
            "authors": [
                "Y Huan",
                "JP Gill",
                "JB Fritzinger",
                "PR Patel",
                "JM Richie",
                "ED Valle",
                "JD Weiland",
                "CA Chestek",
                "HJ Chiel"
            ],
            "title": "Carbon fiber electrodes for intracellular recording and stimulation",
            "year": 2021
        },
        {
            "authors": [
                "JP Keener"
            ],
            "title": "Principles of applied mathematics: transformation and approximation",
            "year": 2018
        },
        {
            "authors": [
                "DW Jordan",
                "P Smith"
            ],
            "title": "Chapter 6.3: Lighthill\u2019s method",
            "year": 2007
        },
        {
            "authors": [
                "SB Laughlin",
                "TJ Sejnowski"
            ],
            "title": "Communication in neuronal networks",
            "year": 2003
        },
        {
            "authors": [
                "LeineRI",
                "Nijmeijer H"
            ],
            "title": "2013)Dynamics and bifurcations of non-smooth mechanical systems, vol 18",
            "year": 2013
        },
        {
            "authors": [
                "H Lu",
                "JM McManus",
                "MJ Cullins",
                "HJ Chiel"
            ],
            "title": "Preparing the periphery for a subsequent behavior: motor neuronal activity during biting generates little force but prepares a retractor muscle to generate larger forces during swallowing in Aplysia",
            "venue": "J Neu123",
            "year": 2015
        },
        {
            "authors": [
                "D Lyttle",
                "J Gill",
                "K Shaw",
                "P Thomas",
                "H Chiel"
            ],
            "title": "Robustness, flexibility, and sensitivity in a multifunctional motor control model",
            "year": 2017
        },
        {
            "authors": [
                "VA Novakovic",
                "GP Sutton",
                "DM Neustadter",
                "RD Beer",
                "HJ Chiel"
            ],
            "title": "Mechanical reconfiguration mediates swallowing and rejection in Aplysia californica",
            "venue": "J Comp Physiol A 192(8):857\u2013870",
            "year": 2006
        },
        {
            "authors": [
                "Y Park",
                "S Heitmann",
                "B Ermentrout"
            ],
            "title": "The utility of phase models in studying neural synchronization. In: Computational models of brain and behavior",
            "venue": "Wiley Online Library",
            "year": 2017
        },
        {
            "authors": [
                "Y Park",
                "KM Shaw",
                "HJ Chiel",
                "PJ Thomas"
            ],
            "title": "The infinitesimal phase response curves of oscillators in piecewise smooth dynamical systems",
            "venue": "Eur J Appl Math 10:1017",
            "year": 2018
        },
        {
            "authors": [
                "R Pfeifer",
                "M Lungarella",
                "F Iida"
            ],
            "title": "Self-organization, embodiment, and biologically inspired robotics",
            "year": 2007
        },
        {
            "authors": [
                "M Schwemmer",
                "T Lewis"
            ],
            "title": "The theory of weakly coupled oscillators. Phase response curves in neuroscience",
            "year": 2012
        },
        {
            "authors": [
                "ShawK",
                "D Lyttle",
                "J Gill",
                "CullinsM",
                "J McManus",
                "LuH",
                "P Thomas",
                "H Chiel"
            ],
            "title": "The significance of dynamical architecture for adaptive responses tomechanical loads during rhythmic behavior",
            "venue": "J Comput Neurosci",
            "year": 2015
        },
        {
            "authors": [
                "S Shirasaka",
                "W Kurebayashi",
                "H Nakao"
            ],
            "title": "Phase reduction theory for hybrid nonlinear oscillators",
            "venue": "Phys Rev E",
            "year": 2017
        },
        {
            "authors": [
                "L Spardy",
                "S Markin",
                "N Shevtsova",
                "B Prilutsky",
                "I Rybak",
                "J Rubin"
            ],
            "title": "A dynamical systems analysis of afferent control in a neuromechanical model of locomotion: I",
            "venue": "Rhythm generation. J Neural Eng",
            "year": 2011
        },
        {
            "authors": [
                "L Spardy",
                "S Markin",
                "N Shevtsova",
                "B Prilutsky",
                "I Rybak",
                "J Rubin"
            ],
            "title": "A dynamical systems analysis of afferent control in a neuromechanical model of locomotion: II",
            "venue": "Phase asymmetry. J Neural Eng",
            "year": 2011
        },
        {
            "authors": [
                "GP Sutton",
                "EV Mangan",
                "DM Neustadter",
                "RD Beer",
                "PE Crago",
                "HJ Chiel"
            ],
            "title": "Neural control exploits changing mechanical advantage and context dependence to generate different feeding responses in Aplysia",
            "year": 2004
        },
        {
            "authors": [
                "PH Taghert",
                "MN Nitabach"
            ],
            "title": "Peptide neuromodulation in invertebrate model systems",
            "venue": "Neuron 76(1):82\u201397",
            "year": 2012
        },
        {
            "authors": [
                "M Vukobratovic",
                "B Borovac",
                "D Surla",
                "D Stokic"
            ],
            "title": "Biped locomotion: dynamics, stability, control and application, vol 7",
            "year": 2012
        },
        {
            "authors": [
                "Y Wang",
                "J Gill",
                "H Chiel",
                "P Thomas"
            ],
            "title": "Shape versus timing: linear responses of a limit cyclewith hard boundaries under instantaneous and static perturbation",
            "venue": "SIAM J Appl Dyn Syst 20(2):701\u2013744",
            "year": 2021
        },
        {
            "authors": [
                "VA Webster-Wood",
                "JP Gill",
                "PJ Thomas",
                "HJ Chiel"
            ],
            "title": "Control for multifunctionality: bioinspired control based on feeding inAplysia californica",
            "year": 2020
        },
        {
            "authors": [
                "ER Westervelt",
                "JW Grizzle",
                "C Chevallereau",
                "JH Choi",
                "B Morris"
            ],
            "title": "Feedback control of dynamic bipedal robot locomotion.CRCPress",
            "year": 2018
        },
        {
            "authors": [
                "D Wilson"
            ],
            "title": "Isostable reduction of oscillators with piecewise smooth dynamics and complex Floquet multipliers",
            "venue": "Phys Rev E",
            "year": 2019
        },
        {
            "authors": [
                "H Ye",
                "DW Morton",
                "HJ Chiel"
            ],
            "title": "Neuromechanics of multifunctionality during rejection in Aplysia californica",
            "venue": "J Neurosci",
            "year": 2006
        }
    ],
    "sections": [
        {
            "text": "Keywords Nonsmooth systems \u00b7 Aplysia \u00b7 Variational dynamics \u00b7 Infinitesimal phase response curve \u00b7 Robust motor behavior \u00b7 Sensory feedback\nCommunicated by Benjamin Lindner.\nB Yangyang Wang yangyang-wang@uiowa.edu\nJeffrey P. Gill jpg18@case.edu\nHillel J. Chiel hjc@case.edu\nPeter J. Thomas pjthomas@case.edu\n1 Department of Mathematics, The University of Iowa, Iowa City, IA 52242, USA\n2 Department of Biology, Case Western Reserve University, Cleveland, OH 44106, USA\n3 Department of Neurosciences, Case Western Reserve University, Cleveland, OH 44106, USA\n4 Department of Biomedical Engineering, Case Western Reserve University, Cleveland, OH 44106, USA\n5 Departments of Mathematics, Applied Mathematics, and Statistics, Case Western Reserve University, Cleveland, OH 44106, USA\n6 Department of Biology, Case Western Reserve University, Cleveland, OH 44106, USA\n7 Department of Cognitive Science, Case Western Reserve University, Cleveland, OH 44106, USA\n8 Department of Data and Computer Science, Case Western Reserve University, Cleveland, OH 44106, USA\n9 Department of Electrical, Control and Systems Engineering, Case Western Reserve University, Cleveland, OH 44106, USA"
        },
        {
            "heading": "1 Introduction",
            "text": "In many animals, motor control involves neural oscillatory circuits that can produce rhythmic patterns of neural activity without receiving rhythmic inputs [central pattern generators (CPGs)], force generation by muscles, and interactions between the body and environment. Moreover, sensory feedback from the peripheral nervous system is known to modulate the rhythms of the electrical signals in CPGs and thereby facilitate adaptive behavior.\nMotor systems show an overall robustness, but because they are highly nonlinear, understanding how they achieve robustness due to their different components is difficult. To understand how animals produce robust behavior in a variable environment, Shaw et al. (2015) and Lyttle et al. (2017) developed a neuromechanical model of triphasic motor patterns to describe the feeding behavior of the marine mollusk Aplysia californica. Like many rhythmic motor systems, feeding inAplysia involves two distinct phases ofmovement: a power stroke during which the musculature engages with the substrate (the seaweed) against which it exerts a force to advance its goal (ingestion of seaweed), and a recovery stage during which the motor system disengages from the substrate to reposition itself, in preparation for beginning the next power stroke. Similarly, in legged locomotion, the stance phase corresponds to the power stroke and the swing phase corresponds to the recovery stage.\nAlso, like many rhythmic motor systems, feeding in Aplysia involves a closed-loop system, which integrates biomechanics and sensory feedback, and exhibits a stable limit cycle solution. It has been conjectured that sensory feedback plays a crucial role in creating robust behavior by extending or truncating specific phases of the motor pattern (Lyttle et al. 2017, \u00a73.1). To test this hypothesis, we applied small mechanical perturbations as well as parametric perturbations to the sensory feedback pathways in the coupled neuromechanical system. It was shown in Lyttle et al. (2017) that a sustained increase in mechanical load leads to changes in both shape and timing of the limit cycle solution: the system generates stronger retractor muscle force for a longer time in response to the increased load. Qualitatively similar effects have been observed during in vivo experiments in Aplysia (Gill and Chiel 2020). In general, we expect that applying parametric changes to CPG-based motor systems leads to changes in both the shape and timing of the resulting limit cycle behavior (Fig. 1).\nIn Aplysia, the increased duration (timing) and increased force (shape) have opposite effects on the task-fitness, measured as seaweed consumption per unit time. Strengthening the retractor force pulls in more food with each cycle, which increases fitness, whereas lengthening the cycle time decreases fitness. Together these effects approximately cancel, making the system robust against increased load. This\ntype of \u201cstronger-and-longer\u201d response may occur generically in other motor systems. Thus, in this paper, we seek to understand the roles of sensory feedback and biomechanics in enhancing robustness. To this end, we apply recently developed tools from variational analysis (Wang et al. 2021) to quantitatively study changes in shape and timing of a limit cycle under static perturbations.\nIn the first part of the present paper (cf. Sect. 2.1), we apply the classical tools of forward variational analysis to the model introduced by Shaw et al. (2015) and Lyttle et al. (2017) (denoted as the Shaw\u2013Lyttle\u2013Gill or SLG model for brevity) to arrive at the following insights:\n\u2013 Nonlinear biomechanical properties confer resilience by immediately increasing resistance to applied loads, on timescales much faster than neural responses. \u2013 The main effect of sensory feedback is to shift the timing of retraction neural pool deactivation; in parallel, firing rate saturation effectively censors sensory feedback during specific movement subintervals.\nWhile the forward-in-time variational analysis is illuminating and allows us to explain in detail the robustness mechanism, it is still incomplete. Over time, the original and perturbed cycle will become increasingly out of phase due to the timing changes under sustained perturbations. Hence, the shape displacements estimated from the forward variational analysis will become less and less accurate over time. This difficulty is not limited to models of feeding in Aplysia californica. For example, if we were to compare the gaits of two subjects walking on treadmills with slightly different speeds, although the ratio of stance and swingmaybe the functionally important aspect, this quantity is difficult to assess directly without putting the two movements on a common footing by comparing them using a common time scale.\nThus, in order to compare perturbed and unperturbed motions with greater accuracy, in the remainder of the paper (cf. Sect. 2.2 and following)we showhow to extend the localin-time variational analysis to a global analysis by applying the infinitesimal shape response curve (ISRC) analysis and local timing response curve (LTRC) analysis developed in Wang et al. (2021). We review these methods in Sect. 3. This time-rescaled analysis accounts for both global timing sensitivity (through the infinitesimal phase response curve, IPRC), as well as local timing sensitivity (through LTRC) by rescaling time to take into account local differences in the effects of parametric variation. It yields a more accurate and selfconsistent description of the oscillator trajectory\u2019s changing shape in response to parametric perturbations and helps complete the picture by providing a complementary perspective. Specifically, our time-rescaled analysis provides additional insights, specifically that\n\u2013 Increasing the applied load on the system increases the duty cycle of the neuron pool responsible for retraction, in the sense that the retraction neuron pool is activated for a larger percentage of the closed phase of the cycle. (The closed phase of the trajectory occurs while the animal\u2019s radula-odontophore, or grasper, is closed on the seaweed, and encompasses the power stroke.) This effect ultimately results in more seaweed being consumed, despite increased force opposing ingestion. \u2013 We are able to derive the multidimensional infinitesimal phase response curve (IPRC) despite the presence of nonsmooth dynamics in the system; we identify the mechanical component of the IPRC as the one that contributes most to robustness, and note that its contribution arises from the \u201cpower stroke\u201d segment of the motor cycle. \u2013 We derive an analytical expression for the robustness to the mechanical perturbation that decomposes naturally into a sum of two terms, one capturing the effect of the perturbation on the shape of the trajectory, and the other capturing the effect on the timing; this result provides a quantitative analysis of robustness that confirms the qualitative insights described previously in the literature. \u2013 In addition to sensory feedback and intrinsic biomechanical properties, robustness against changes in applied load can arise from coordinated changes of multiple parameters such as the gain of sensory feedback and muscle stiffness.\nThe dynamics of the SLG model (Lyttle et al. 2017) is given by\nda0 dt = (a0(1 \u2212 a0 \u2212 \u03b3 a1) + \u03bc + \u03b50(xr \u2212 \u03be0)\u03c30)/\u03c4a da1 dt\n= (a1(1 \u2212 a1 \u2212 \u03b3 a2) + \u03bc + \u03b51(xr \u2212 \u03be1)\u03c31)/\u03c4a da2 dt\n= (a2(1 \u2212 a2 \u2212 \u03b3 a0) + \u03bc + \u03b52(xr \u2212 \u03be2)\u03c32)/\u03c4a du0 dt\n= ((a0 + a1)umax \u2212 u0)/\u03c4m du1 dt\n= (a2umax \u2212 u1)/\u03c4m dxr dt = (Fmusc(u0, u1, xr ) + r Fsw)/br (1)\nThis system incorporates firing rates of three neuron populations, corresponding to the \u201cprotraction-open\u201d (a0), \u201cprotraction-closed\u201d (a1), and \u201cretraction\u201d phase (a2). Note that when a nerve cell ceases firing because of inhibition, its firing rate will be held at zero until the balance of inhibition and excitation allow firing activity to resume. Hence, we supplement model (1) with three hard boundaries introduced by the requirement that the firing rates a0, a1, a2 must be nonnegative:\n0 = {a0 = 0}, 1 = {a1 = 0}, 2 = {a2 = 0}.\nDuring the limit cycle, when a neural variable ai changes from positive to 0, we call that the ai landing point; when it changes from 0 to positive, we call that the ai liftoff point. The fact that the trajectory is non-smooth at the landing and liftoff points will play an important role in the analysis to follow. See Sect. 4 for further discussion of the biological basis for our modeling assumptions.\nThis model also consists of a simplified version of the mechanics of the feeding apparatus: a grasper that can open or close (xr ), a muscle that can protract the grasper to reach the food (u0) and another muscle that can retract the grasper to pull the food back into itsmouth (u1). The net force exerted by the muscles is given by the sum of the two muscle forces\nFmusc(u0, u1, xr ) = Fmusc,pro + Fmusc,ret = k0\u03c6 ( c0\u2212xr\nw0\n) u0 + k1\u03c6 ( c1\u2212xr\nw1\n) u1\n(2)\nwhere \u03c6(x) = \u22123 \u221a 3\n2 x(x \u2212 1)(x + 1)\nis the effective length-tension curve for muscle forces, ci ,wi and ki denote the mechanical properties of each muscle.\nFsw represents the external force applied to the seaweed, which can only be felt by the grasper when it is closed on the food (a1 + a2 > 0.5), during which r = 1. When the grasper is open (a1 + a2 \u2264 0.5), r = 0; that is, the grasper moves independently of the seaweed. This condition leads\nto a transversal crossing boundary; that is, the open/closing boundary given by\no/c = {a1 + a2 = 0.5}.\nValues for model parameters and initial conditions are given in Tables 2 and 3 in Appendix. For additional details on the biological assumptions motivating the model, see Shaw et al. (2015) and Lyttle et al. (2017).\nIn this paper, we are interested in the so-called heteroclinic mode in which the neural dynamics temporarily slow down when the sensory feedback overcomes the endogenous neural excitation and forces the neural trajectory to slide along the hard boundary ai = 0. Such temporary slowing down of neural variables allows the muscles, which evolve on slower timescales, to \u201ccatch up\u201d; hence the seaweed can be swallowed and ingested successfully. Following the terminology fromWang et al. (2021), we call attracting periodic trajectories that experience sliding motions limit cycles with sliding components (LCSCs).\nUsing classical sensitivity analysis and our recently developed tools from variational analysis (Wang et al. 2021), we show here that biomechanics and sensory feedback cooperatively support strong robustness by changing the timing and shape of the neuromechanical trajectory.While both sensory feedback and biomechanics respond immediately to the increased load, we find that the sensory feedback effect is initially censored while the neural activity is pinned against a hard boundary of neuronal firing. Thus the effect of the sensory feedback signal is significantly delayed relative to onset of the increased load.Our analysis suggests that sensory feedback mediates robustness mainly through shifting the timing of neural activation and specifically increasing the duty cycle of the retraction neural pool. This response allows the system to digest more seaweed despite the increased force opposing ingestion and hence achieve strong robustness. In addition to uncovering the mechanisms for robust motor control, our methods allow us to quantify analytically the robustness of the model system to the mechanical perturbation. Finally, although we focus on the Aplysia californica feeding system as ourworking example, ourmethods should extend naturally to a broad range of motor systems.\nOur paper is organized as follows.We present our analysis and main results in Sect. 2. Methods that we use to understand the robustness in the Aplysia neuromechanical model are presented and reviewed in Sect. 3. We discuss limitations and possible extensions of our approach in Sect. 4."
        },
        {
            "heading": "2 Results",
            "text": "Recall that a sustained (parametric) perturbation often causes changes in both shape and timing of the neuromechanical\ntrajectory solution of (1). In this paper, we adopt methods developed in Wang et al. (2021) for analyzing the joint variation of both shape and timing of limit cycles with sliding components under parametric perturbations."
        },
        {
            "heading": "2.1 Forward variational analysis",
            "text": "We begin our analysis by investigating how the shape of the trajectory changes in response to a sustained increase in mechanical load Fsw. To a first approximation, the change in shape can be captured by classical sensitivity analysis (also called forward variational analysis) which we review in Sect. 3.\nWe apply a small static perturbation to system (1) by increasing the model parameter Fsw by \u03b5 = 0.02: Fsw \u2192 Fsw + \u03b5, and comparing the new, perturbed limit cycle trajectory \u03b3\u03b5 to the original, unperturbed limit cycle trajectory \u03b30, beginning at the start of the grasper-closed phase (time 0 in Fig. 2 panels A\u2013D). That is, we plot v \u2248 (\u03b3\u03b5(t)\u2212\u03b30(t))/\u03b5; see (13)\u2013(15) for precise definitions. Note that Fsw is multiplied by an indicator function that is only nonzero when the trajectory is in the grasper-closed phase. Thus the perturbation is only present when the grasper is closed on the food.\nThe neural and biomechanical components of the unperturbed trajectory \u03b3 (t) are shown by the solid curves in Fig. 2A, B, respectively. The perturbed trajectories \u03b3\u03b5(t) are indicated by the dashed lines. The gray shaded regions indicate phases when the grasper in the unperturbed system is closed. With the perturbation (increased load), the transition from closing to opening is delayed; this transition is indicated by the magenta vertical line. Figure 2C, D shows the difference between the two trajectories per perturbation along the neural directions and along the biomechanical directions, respectively. These curves can be approximated by the solutions to the forward variational equation (14) defined in Sect. 3. The muscle forces Fmusc(u0, u1, xr ) before and after the perturbation are shown by the gray curves in Fig. 2B, and the difference between them is included as the gray curve in Fig. 2D.\nFigure 2 yields several insights about the roles of sensory feedback and biomechanics in robustness, which we discuss in detail below."
        },
        {
            "heading": "2.1.1 Biomechanics confer resilience by immediately increasing resistance to the increased load",
            "text": "Immediately following the perturbation of the mechanical load,we observed a positive displacement in the grasper position xr relative to the unperturbed trajectory (Fig. 2D, yellow curve). This displacement simply reflects the grasper being pulled by a stronger force Fsw + \u03b5. If nothing other than the applied load Fsw changes in the system, a linearized analysis\n0 2 4 6 8 -0.4\n-0.2\n0\n0.2\n0.4\n0.6\n0.8\n1(B)\n0 2 4 6 8 -8\n-6\n-4\n-2\n0\n2\n4\n6\n8\n10 (D)\nintervals during which the grasper without perturbation is closed on the food are indicated by the shaded regions. The vertical magenta lines indicate the times at which the grasper under perturbation switches from closed to open. The difference in periods and the delay in the grasper opening time both accumulate, making the comparison between the two trajectories invalid except at short times. A, C show trajectories and displacements along the neural directions, while B, D show trajectories and displacements along the mechanical directions. The lines in panel C (resp., D) approximate the difference between the dashed and solid trajectories from panel A (resp., B) per perturbation\nsuggests that the initial displacement of xr would approximately follow the yellow dashed line given by 1br t (Fig. 2D). Nonetheless, while this line gives a good initial approximation, the true displacement in xr (yellow solid curve) quickly sags below the yellow dashed line over time. This difference arises due to the negative displacement occurring in the muscle force Fmusc(u0, u1, xr ) (Fig. 2D, gray curve) which acts to overcome the increased load. However, early in the retraction cycle, all other variables, including themuscle activation u0 and u1, show almost no displacement at all (see Fig. 2C, D). This observation suggests that long before the sensory feedback effect has time to act, the biomechanics may play an essential role in generating robust motor behavior, by providing an immediate, short-term resistance to increased load.\nEarly in the retraction cycle, increasing the load stretches both the retractor and protractor muscles, and moves them down their length-tension curves. As a result, both forces become weaker, but the magnitude of the protractor muscle force drops more quickly than the retractor muscle force (Fig. 3). Thus, the retractor muscle force grows relative to the opposing protractor muscle force. This shift endows the systemwith a built-in resilience, in that increasing seaweed force opposing ingestion automatically (i.e., without changes in neural activation) engages a larger resistingmuscle force long before neural pools or muscles show differential activation. This is a new insight beyond the previous \u201clonger-stronger\u201d hypothesis (Shaw et al. 2015; Lyttle et al. 2017)."
        },
        {
            "heading": "2.1.2 Sensory feedback effects are largely delayed by the firing rate hard boundary properties",
            "text": "Changes in xr due to the increased load will immediately propagate to the neural variables (a0, a1, a2) through the sensory feedback \u03b5i (xr \u2212 \u03bei )\u03c3i )/\u03c4a , and hence should affect the neural variables without any lag. However, no significant displacement of the neural variables is observed until nearly the end of the retraction cycle (Fig. 2C). In other words, while the sensory feedback itself immediately responds to the increased load, the effect of the changed sensory feedback signal is not manifest until much later in the retraction cycle, when the protraction-open neuron pool is released from inhibition along its hard boundary and starts to fire (Fig. 2). Hence, the nonsmooth hard boundary conditions on neuronal firing rates significantly delay the effect of sensory feedback, and create intervals during which neurons are insensitive to sensory feedback.\n2.1.3 Sensory feedback contributes by shifting the timing of neural activation\nDue to the hard boundary effects, the displacements of the neural variables appear near the endof the closed phase,when the protraction-open neuron pool a0 lifts off from its hard boundary, and the retraction-closed neuron pool a2 deactivates to stop firing (Fig. 2A, C). A positive (resp., negative) displacement of a2 (resp., a0) indicates that a2 deactivates (resp., a0 activates) at a later time with the increased load, and hence the retraction-closed phase is prolonged. Consequently, the retraction muscle activity will increase, because its stimulation by the retraction motor neuron is prolonged, allowing the slow retractor muscle to generate larger forces\n(Fig. 3). Similarly, we also observe a decreased protractor muscle activity, as the protraction neuron pool a0 turns on at a later time. This decrease leads to a stronger retractor muscle force and a weaker protractor muscle force (Fig. 3). Hence, a more negative net muscle force results (Fig. 2D, gray curve), which corresponds to a stronger resisting force pulling the seaweed towards the jaw to swallow the food. To summarize, the main effect of sensory feedback that contributes to robustness is prolonging the retraction phase to confer on the system a resilience in that increasing seaweed force opposing ingestion engages a larger resisting muscle force.\nThus, sensory feedback contributes to robustness primarily by shifting the timing of neural activation, as opposed to the magnitude of neural activation. Biologically, this distinction corresponds to affecting the timing of motor neuron burst onset or offset, rather than burst intensity."
        },
        {
            "heading": "2.2 Variational analysis with rescaled time\u2014ISRC",
            "text": "Under the forward-in-time analysis, the grasper of the perturbed system lags behind the grasper of the unperturbed system throughout the closing phase; yet the net seaweed movement was measured to be greater for the perturbed system (Lyttle et al. 2017). Fig. 4 shows an expanded view of the perturbed and unperturbed systems\u2019 grasper position (Fig. 4A) and the linearized difference produced by the variational equation (Fig. 4B). As this detailed view shows, at the time when the unperturbed system transitions from closed to open (gray-white boundary) the unperturbed grasper position is more retracted than the perturbed grasper position at the coincident time point. Similarly, the grasper component of the variational equation is positive at the gray-white boundary. Furthermore, at the time when the perturbed system transitions from closed to open (magenta line) the perturbed system continues to be less retracted than the unperturbed system. Thus, whether we compare the systems at the perturbed or unperturbed opening time, the perturbed grasper is \u201cfurther behind.\u201d Yet the overall effect in the perturbed system is a larger net intake of seaweed per cycle.\nThis apparent contradiction underscores the need to extend theperturbation analysis beyond the standard forwardin-time variational analysis. In particular, if one cycle is slower than another, then while the local perturbation analysis can explain the cause-and-effect relations a short time into the future, they cannot account for the net effect around a cycle in a self-consistent way. Over time, the displacements between the two trajectories grow, and the linearized approximation becomes invalid except at short times (cf. Jordan et al. 2007). Hence, unless time is rescaled to take into account the difference in cycle period, comparing the components of the original and perturbed cycles will become less and less meaningful.\nTo overcome this difficulty, we extend the local-in-time variational analysis to a global analysis by rescaling time so the unperturbed closing and opening events coincide with those after perturbations, respectively. We do so by applying the infinitesimal shape response curve (ISRC) analysis and the local timing response curve (LTRC) (Wang et al. 2021), which we review in Sect. 3. This method yields a more accurate and self-consistent description of the oscillator trajectory\u2019s changing shape in response to parametric perturbations (see Fig. 5). We show that the combination of the ISRC and the LTRC gives a sensitivity analysis of an oscillator to sustained perturbations within any given region (e.g., protraction or retraction cycle, opening or closing phase) and provides a self-contained framework for analytically quantifying and understanding robustness to perturbations.\nWe write \u03b31 for the linear shift in the limit cycle shape in response to the static perturbation Fsw \u2192 Fsw + \u03b5, that is:\n\u03b3\u03b5(\u03c4\u03b5(t)) = \u03b30(t) + \u03b5\u03b31(t) + O(\u03b52),\nuniformly in time. Note that the time for the perturbed trajectory is rescaled to be \u03c4\u03b5(t) to match the unperturbed time points. The linear shift \u03b31(t) is the so-called ISRC curve and satisfies a nonhomogeneous variational equation (see Sect. 3). Compared with the forward variational equation, the ISRC equation has one additional nonhomogeneous term \u03bd1F0(\u03b30(t)) that arises from the time rescaling. In this term, \u03bd1 is determined by the choice of time rescaling \u03c4\u03b5(t) and F0(\u03b30(t)) is the unperturbed vector field evaluated along the unperturbed limit cycle \u03b30(t) (see Sect. 3 for details).\nSince the perturbation is applied to the seaweed, it can only be felt by the system when the grasper is closed on the seaweed. It is natural to expect that the segment at the closing phase has a different timing sensitivity than the segment at the opening phase. We hence choose to rescale time differently in the two phases, using piecewise uniform rescaling when computing the ISRC. This leads to a piecewise ISRC equation, where \u03bd1 is piecewise constant. It was shown in Wang et al. (2021) that \u03bd1 can be estimated from the LTRC analysis (see Sect. 3).\nIn Fig. 5A, B, the time traces of variables along the unperturbed limit cycle are shown by the solid curves, whereas the perturbed limit cycle whose time has been rescaled to match the unperturbed time points as described above are indicated by the dashed curves.With the piecewise rescaling, the transitions between the closing and opening events of the perturbed andunperturbed systemsnowcoincide.The relative displacements between the perturbed and unperturbed trajectories are approximately given by the piecewise ISRC \u03b31 shown in Fig. 5C, D. In contrast to the forward variational analysis, in which the displacements grow over time, the piecewise ISRC curve is periodic, meaning we have achieved a selfconsistent global description of the response of the limit cycle to increased load.\nWe now show that the apparent contradiction that we obtained from the forward variational analysis, i.e., that the grasper displacement at the end of the closing phase is positive (cf. Fig.4), can now be resolved in the time-rescaled picture. In response to the perturbation, the relative displacement of the grasper position (the xr component of \u03b31, denoted as \u03b31,xr ) initially increases (i.e., the grasper becomes more and more protracted due to the increased load) and reaches its peak at about t = 1.4 (see Fig. 5D, yellow curve). Then, it starts to decrease and becomes negative at the time when the grasper opens. This means later in the retraction cycle, the perturbed grasper is less and less protracted than the unperturbed version and eventually become more retracted by the end of the closing phase (Fig. 5D, green arrow). In sum-\n0 2 4 6 8 0\n0.2\n0.4\n0.6\n0.8\n1(B)\n0 2 4 6 8 -1\n-0.5\n0\n0.5\n1\n1.5(D)\nrescaling \u03b3 (t) over two periods. Shaded regions have the same meanings as in Fig. 2. Note the xr component of the ISRC is negative at the time of opening (see green arrow). With piecewise uniform rescaling, the variational approximation is consistent across multiple periods (c.f., Fig. 2)\nmary, the grasper perturbed by larger force begins \u201cbehind\u201d the unperturbed version, but catches up around 60% of the way through the retraction phase (in relative time) and comes out \u201cahead\u201d by the time both graspers open, consistent with having a larger net seaweed intake (Lyttle et al. 2017).\nTo understand what causes \u03b31,xr to be negative despite its initial big rise, we consider the effect of the perturbation on the neural pool through sensory feedback. In Fig. 5C, we observe positive displacements in \u03b31,a2 (yellow curve) occurring both when the retraction neuron pool a2 activates and when it deactivates. These displacements indicate that with the increased load, the retraction neuron a2 activates earlier and turns off later relative to the unperturbed a2. In other words, increasing the applied load on the system increases the duty cycle of the neuron pool involved in retraction, i.e., the retraction neuron pool is activated for a larger percentage of the total cycle. As a result, the motor system recruits\na larger retractor muscle force, as indicated by the positive displacement of the retractor muscle activation u1 during the closing phase (Fig. 5D, red curve). A similar increase in motor recruitment in response to increased external load has been observed in vivo (Gill and Chiel 2020). In the model, the stronger retraction force acts to impede the protraction of the grasper, and eventually pulls the grasper to a more retracted state. Thus the grasper displacement crosses zero andbecomes negative at the end of the closing phase (Fig. 5D, green arrow).\nNote that there is no perturbation during the opening phase (Fig. 5, white space). During this phase of the cycle, displacements slowly decay and are nearly zero by the time the grasper closes on the food again."
        },
        {
            "heading": "2.3 Timing responses to sustained perturbations of",
            "text": "Fsw."
        },
        {
            "heading": "2.3.1 Infinitesimal phase response curve",
            "text": "To understand the timing response of system (1) to increased load, we perform an IPRC analysis. Figure 6 shows the time traces of the IPRCcurve over one cycle.As before, the shaded region indicates the phase when the grasper is closed.\nThe IPRC curves associated with biomechanical variables are shown in Fig. 6, lower panel. In particular, the timing sensitivity of system (1) to the increased load on the grasper (Fsw \u2192 Fsw + \u03b5) can be estimated using the IPRC along the xr direction, i.e., the yellow curve in the lower panel of Fig. 6. Since the perturbation only has effect during the closing phase, only the portion of zxr over the shaded region is relevant. This portion is strictly negative. Therefore, in response to the increased load considered above, the system undergoes phase delay, and hence the total period is prolonged. This finding is consistent with earlier results on the sensory feedback effect obtained from the variational analysis (see Sect. 2.2).\nThe linear shift in period can be estimated by evaluating the integral\nT1 := lim \u03b5\u21920 T\u03b5 \u2212 T0 \u03b5 = \u2212 \u222b T0 0 z(t)\u1d40 \u2202F\u03b5(\u03b30(t)) \u2202\u03b5 \u2223\u2223\u2223 \u03b5=0 dt,\nwhere T0, T\u03b5 are the periods before and after perturbation \u03b5 (see Sect. 3). For the perturbation on Fsw, the derivative \u2202F\u03b5(\u03b30(t))\n\u2202\u03b5 equals (0, 1br ) \u1d40 over the grasper-closed region, and equals 0 during the grasper-open region, where the first 0 is a 5\u00d7 1 zero vector and the second 0 is a 6\u00d7 1 vector. It then follows that\nT1 = \u2212 \u222b\nclose\nzxr (t)/br dt (3)\nwhere close denotes the grasper-closed phase. Other IPRC curves in Fig. 6 indicate the timing sensitivity of the model to other perturbations and lead to several useful insights as well as testable predictions. For example,\n\u2013 The IPRC curves are continuous except at the liftoff points (Fig. 6 top panel, blue and red spikes). While all three neural variables go through liftoff points, there is no large spike in za2 (yellow curve). The absence of a yellow spike and the fact that the red spike is larger than the blue spike, imply that the system has the highest timing sensitivity to perturbing a1 and intermediate timing sensitivity to a0, both of which are significantly higher than the sensitivity to a2 perturbations. \u2013 Excitatory inputs to neural populations lead to phase advance and hence shorten the total period, because the IPRC curves associated with neural variables are mostly positive (Fig. 6 top panel). \u2013 Most of the time the system is not sensitive to neural perturbations, but there also exist sensitive regions when the trajectory is not restricted to the hard boundaries (e.g., Fig. 6 top panel, blue and red spikes). For instance, the system has high timing sensitivity to perturbations of a0 late in the closing phase and to perturbations of a1 late in the opening phase, whereas sensory inputs are largely ignored early in the opening phase. This effect is a concrete example of differential penetrance, a striking feature of many biological systems in which some neural activity can vary greatly, with little effect on behavior, whereas in other circumstances, a small change in neural activity may have a very large impact on behavior (Chiel et al. 1999; Beer et al. 1999; Ye et al. 2006; Cullins et al. 2015). \u2013 Increasing the protractor muscle activation u0 causes a phase delay early in the closing phase and late in the opening phase, and a phase advance otherwise. In contrast, increasing the retraction muscle activation u1 causes a phase advance early in the closing phase and late in the opening phase, and a phase delay otherwise. \u201cAppendix B\u201d discusses why the system has different timing sensitivities to muscle perturbations.\nAlthough all three neural variables go through liftoff points, there is no large yellow spike in za2 (see Fig. 6). To understand this, we note that before a0 (resp., a1) lifts off its hard boundary, there exists no inhibition from other neurons except for inhibitory sensory feedback. However, when a2 lifts off at around t \u2248 3.2, it still experiences inhibition from a0 (see Fig. 5A). In other words, there are two inhibitory effects pressing neurons a2 down to the hard boundary, but only one inhibitory effect acting on the other two neuron populations. As a result, while there is a discontinuous jump of the IPRC curve corresponding to a2 at the liftoff point, it remains small as the other inhibition is still present."
        },
        {
            "heading": "2.3.2 Local timing response curve",
            "text": "While the IPRC is a powerful tool for understanding the global timing sensitivity of an oscillator to sustained perturbations, it does not give local timing sensitivities, which, however, are needed for computing the ISRC curve as discussed above. We hence adopt the local timing response curve (LTRC) method developed in Wang et al. (2021) and reviewed in Sect. 3. To illustrate this method, we show the LTRCassociatedwith the closing phase and denote it as\u03b7close (see Fig. 7). Although the LTRC \u03b7close is defined throughout the full domain, estimating the effect of the perturbation within the closing region only requires evaluating the LTRC in this region. Figure 7 shows the time series of \u03b7close for the model in the closing region, obtained by numerically integrating the adjoint equation backward in time with the initial condition of \u03b7close given by its value when the grasper switches from closing to opening. Note that \u03b7xr , the yellow curve in Fig. 7 lower panel, remains positive over the closing phase. This implies that the increased load on seaweed prolongs the time remaining in the closing region; that is, the increased load prolongs the total closing time. The relative shift in the closing time caused by the increased load can also be estimated by integrating the LTRC (see Section 3).\nIn addition, Fig. 7 implies that strengthening the protractor muscle activation u0 during the closing phase prolongs the total closing time, whereas increasing the retraction muscle activation u1 decreases the total closing time. Similarly, we can compute the LTRC over other phases, such as the retraction phase, in order to estimate local timing sensitivities of the system in other regions.\nFinally we note an interesting feature in \u03b7close: there is an abrupt change in \u03b7xr at the a0 = 0 liftoff point (Fig. 7 bottom panel, dashed vertical line). To understand this behavior, note that an instantaneous perturbation of xr directly propagates to neural pools through sensory feedback. While all three neural pools are affected by this mechanical perturbation, the neural components of \u03b7close are zero most of the time except when the trajectory lifts off from the a0 = 0 constraint (Fig. 7 top panel, blue spike). This observation implies that\nthe system has a high local sensitivity to a0 during the blue spike, whereas the sensitivity to a1 and a2 are significantly smaller than unity at all times. Thus, to understand the effect of perturbing xr on the local timing, it is sufficient to focus on \u03b7a0 and examine how a0 reacts to perturbing xr .\nSimilar to the forward variational analysis, perturbing xr delays the activation of a0, i.e., a0 lifts off from a0 = 0 at a later time. That is, the displacement in a0 near the a0 = 0 liftoff point is negative. Since \u03b7a0 is negative near the liftoff point, perturbing xr prolongs the total closed time (i.e., \u03b7xr is positive during the closed phase).\nNext we address the cusp phenomena observed in \u03b7xr (Fig. 7, bottom panel, yellow curve). Note that perturbations arriving before the trajectory lifts off from a0 = 0 delay the activation of a0 by increasing the inhibition from its sensory feedback. Moreover, the closer the time of perturbation to the time of liftoff, the larger the delay on the activation of a0. Such a larger delay leads to a greater increase in the total closed time due to perturbing xr . Hence, before the liftoff time (Fig. 7, bottom panel, vertical black dashed line), \u03b7xr gradually increases. Once the trajectory has passed the liftoff point, perturbing xr delays the activation of a0 by decreasing its sensory feedback, the effect of which now becomes excitatory. The size of this effect decays exponentially as the trajectory gradually leaves the boundary a0 = 0. Thus, there is a cusp in the \u03b7xr curve at the liftoff point, after which \u03b7xr rapidly decreases."
        },
        {
            "heading": "2.4 Robustness to static perturbations",
            "text": "In this section, we show how the robustness of the Aplysia model (1), the ability of the system to maintain its performance despite perturbations, can be quantified using the ISRC, IPRC and LTRC analysis.\nFollowing Lyttle et al. (2017), we quantify the performance or task fitness via the average seaweed intake rate\nS\u03b5 = \u2212 xr ,\u03b5 T\u03b5\n(4)\nwhere xr ,\u03b5 is the net change in perturbed grasper position xr ,\u03b5 during the grasper-closed phase and T\u03b5 is the perturbed period. Note that we assume the seaweed is moving together with the grasperwhen it is closed and notmoving at all during the grasper-open component of the trajectory.Hence,\u2212 xr ,\u03b5 denotes the total amount of seaweed consumed per cycle.\nSince the vector field F\u03b5(x) in system (1) is piecewise smooth in the coordinates x and smooth in the perturbation \u03b5, it follows that the following expansion holds:\nxr ,\u03b5 = xr ,0 + \u03b5 xr ,1 + O(\u03b52),\nwhere xr ,0 is the net change in the unperturbed grasper position during the grasper-closed component of the trajectory. Here, xr ,1 is approximately given by the net change of the xr component of the ISRC \u03b31, which is denoted as \u03b31,xr (see Sect. 2.2), over the grasper-closed phase. Suppose the grasper closes at tclose and opens at topen over one cycle. It follows that xr ,1 = \u03b31,xr (topen) \u2212 \u03b31,xr (tclose).\nLyttle et al. (2017) show that the robustness, i.e., the relative shift in the taskfitness per relative change in perturbation, for small \u03b5, can be written as\nRobustness = Fsw \u03b5 S(\u03b5) \u2212 S0 S0\n= Fsw (\nxr ,1 xr ,0 \u2212 T1 T0\n) + O(\u03b5), (5)\nas \u03b5 \u2192 0. Recall that T0 is the period of the unperturbed limit cycle and T1 denotes the linear shift in period, which can be estimated using the IPRC (see Sect. 2.3.1).\nIn summary, the robustness formula can be decomposed into two parts, one involving changes in shape (in particular, the grasper position xr ) and the other involving the timing change. As discussed before, changes in shape can be estimated using the ISRC and the LTRC analysis, whereas the latter can be quantified using the IPRC. Below, we illustrate the quantification of the robustness by considering the perturbation to be the increase in the constant applied load Fsw \u2192 Fsw + \u03b5.\nThe ISRCwith or without timing rescaling corresponding to the perturbation on the applied load have already been\ncomputed and discussed in Sects. 2.1 and 2.2.Note that xr ,1 in (5) is the net change in the ISRC during the grasper-closed phase. Choosing the ISRCwith rescaling based on the timing of the closing and opening events provides a more accurate estimate of xr ,1. Hence, we use the ISRC with piecewise rescaling to estimate xr ,1, which is the net change in \u03b31,xr over the closing region per cycle (see the yellow curve over the shaded region in the lower right panel of Fig. 5 and the green arrow marking the difference at the end of the closing phase). Furthermore, the linear shift in the period T1 can be estimated by (3) using the IPRC.\nFrom the above analysis, we obtain xr ,1 xr ,0 \u2248 0.4806 and T1 T0\n\u2248 1.6532, both of which are positive and are consistent with the concept of an adaptive \u201cstronger and longer\u201d change in the motor pattern in response to increased load. It follows that the robustness is approximately \u22121.1726\u00d7 10\u22122. (Note that the smaller this number is in magnitude, the more robust the system is.) To the first order in \u03b5, the relative change in the performance is then given by\nS(\u03b5) \u2212 S0 S0 \u2248 \u22121.1726 \u00d7 10\u22122(\u03b5/Fsw),\nwhich is illustrated by the red circle as the perturbation size \u03b5 varies (see Fig. 8, top panel). To see what this means, we take a data point on the line indicated by the arrow, i.e., (0.42,\u22120.005). Here \u03b5/Fsw = 0.42 indicates a 42% increase in load Fsw, which only causes a 0.5% decrease in the task fitness, corresponding to a highly robust response. Here the \u201cstronger\u201d effect (i.e., the first term in the robustness formula (5) being positive) contributes to the robustness, whereas the \u201clonger\u201d effect (i.e., the second term in the robustness) reduces it. However, these two effects are not independent from each other: it is the longer retraction-closed time that allows the muscle to build up a stronger force, thereby contributing to a robust response.\nWe also compute the relative change in S with respect to \u03b5 using direct numerical simulations (see Fig. 8, blue stars), which show good agreement with our analytical results. In contrast, if we estimate xr ,1 using the ISRC with a uniform timing rescaling (see Fig. 11), the resulting estimated robustness becomes more negative and no longer gives an accurate approximation to the actual robustness (see Fig. 8, bottom panel). That is, the ISRC using different rescaling factors over the grasper-closed phase (\u03bd1,close) versus the grasper-open phase (\u03bd1,open), gives a much better approximation to the robustness than the ISRC based on a global timing rescaling \u03bd1 = T1/T0. The fact that the \u03bd1,open/close are obtained via the LTRC analysis highlights the contribution of this novel analytical tool. This observation demonstrates that for systems under certain circumstances [e.g., non-uniform perturbation as considered in system (1)], the ISRC together with the LTRC greatly improves the accuracy of the robust-\nness, compared to the ISRCwith global timing analysis given by the IPRC."
        },
        {
            "heading": "2.5 Sensitivity of robustness to other parameters",
            "text": "In general, the performance of motor control systems may be affected not only by external parameters, such as an applied load, but also be internal parameters, for instance describing the physical properties of the biomechanics or neural controllers. The variational tools used in the previous section to understand mechanisms of robustness to increases in applied load\u2014the IPRC, ISRC and LTRC\u2014can also give insights\ninto the effects of changing internal model parameters. For instance, in the SLG model, appropriately varying strengths of protractor or retractor muscles can overcome effects of the increased mechanical load Fsw \u2192 Fsw + \u03b5. Because of the SLG model\u2019s relative simplicity, we can relate many of these changes to specific components of the fitness equation in detail.\nBelow, we first consider how varying sensory feedback strengths can help restore the reduced seaweed intake rate due to increased applied load. Then, we examine how changing the strengths of the protractor and retractor muscles affects robustness to applied loads."
        },
        {
            "heading": "2.5.1 Varying sensory feedback strengths",
            "text": "Figure 9 shows the seaweed intake rate and robustness to the increased load Fsw with respect to changes in sensory feedback strengths \u03b5i , i \u2208 {0, 1, 2}. The performance S0 becomes negative when \u03b50 or \u03b51 is relatively small (e.g., smaller than 10\u22125) or when \u03b52 is relatively big (e.g., larger than 10\u22123), during which the system is in a fast limit cycle/biting mode and hence cannot swallow seaweed.\nWhen the system is in the heteroclinic/swallowing mode, as one might expect, increasing the sensory feedback (e.g., \u03b52) improves the performance. Surprisingly, our results show that increasing sensory feedback strengths to the two protraction-related neural pools leads to opposite results by decreasing the performance. These results seem to suggest that to restore the deficit caused by the increased load and achieve an increased robustness, we can either increase \u03b52 or decrease \u03b50 and/or \u03b51. However, this is not true. As shown in Fig. 9, a decrease in the robustness can be induced by either decreasing \u03b50 or increasing \u03b52. Moreover, the robustness is largely insensitive to changes in \u03b51, despite the fact that it influences the performance. Understanding these effects on the robustness would require analysis of a second-order variational problem and represents a future direction for understanding neuromodulation."
        },
        {
            "heading": "2.5.2 Varying muscle strengths",
            "text": "Next we investigate how variations of k0 and |k1|, the strengths of the protraction and retraction muscles, affect the robustness to changes in seaweed load.\nFigure 10 shows that performance improves with the increased protractor muscle strength k0 or the increased retractor muscle strength |k1|. This suggests that increasing k0 or |k1| can help restore the deficit in the performance due to the increased mechanical load and hence boost the robustness, which agreeswith our numerical simulations (see Fig. 10, top panel, black curve).\nRecall that the robustness can be approximated as Fsw (\nxr ,1 xr ,0 \u2212 T1T0 ) [see Eq. (5)]. Understanding the underly-\ning mechanisms of the robustness requires one to investigate how the two quantities involving shifts in shape and timing change with respect to k0 or |k1| (see Fig. 10, lower three\npanels). We find that increasing k0 or |k1| reduces T1 and \u2212 xr ,1 while T0 and \u2212 xr ,0 are almost unaffected. Hence, both xr ,1/ xr ,0 (the \u201cstronger\u201d effect in response to perturbations on the seaweed load) and T1/T0 (the \u201clonger\u201d effect ) are decreased as we increase the muscle strengths. However, the reduction in the \u201cstronger\u201d effect is smaller than the reduction in the \u201clonger\u201d effect. As a result, the robustness\napproximated by Fsw (\nxr ,1 xr ,0 \u2212 T1T0 ) increases as k0 or |k1|\nincreases. Together, our analytical tools suggest ways in which coordinated changes in intrinsic parameters couldmaintainfitness and thus enhance robustness."
        },
        {
            "heading": "3 Methods",
            "text": "In this section, we review the classical variational theory for limit cycles (e.g., Filippov 1988; Bernardo et al. 2008; Leine and Nijmeijer 2013; Park et al. 2018), and new tools that we recently developed in Wang et al. (2021) for linear approximation of the effects of small sustained perturbations on the timing and shape of a limit cycle trajectory in both smooth and nonsmooth systems.\nIn the next two sections we treat the smooth and nonsmooth cases, respectively. In each case, we consider a one-parameter family of n-dimensional dynamical systems\ndx dt = F\u03b5(x), (6)\nindexed by a parameter \u03b5 representing a static perturbation of a reference system\ndx dt = F0(x). (7)"
        },
        {
            "heading": "3.1 Timing and shape responses to static perturbations in smooth systems",
            "text": "Following Wang et al. (2021), we make the following assumptions:\nAssumption 1 \u2013 The vector field F\u03b5(x) : \u00d7 I \u2192 Rn is C1 in both the coordinates x in some open subset \u2282 Rn and the perturbation \u03b5 \u2208 I \u2282 R, where I is an open neighborhood of zero.\n\u2013 For \u03b5 \u2208 I, system (6) has a linearly asymptotically stable limit cycle \u03b3\u03b5(t), with finite period T\u03b5 depending (at least C1) on \u03b5.\nIt follows from Assumption 1 that when \u03b5 = 0, F0(x) is C1 in x \u2208 and the unperturbed system (7) exhibits a T0periodic linearly asymptotically stable limit cycle solution \u03b30(t) = \u03b30(t + T0) with 0 < T0 < \u221e.\nAssumption 1 also implies that the following approximations hold:\nF\u03b5(x) = F0(x) + \u03b5 \u2202F\u03b5 \u2202\u03b5 (x) \u2223\u2223\u2223 \u03b5=0 + O(\u03b5 2), (8)\nT\u03b5 = T0 + \u03b5T1 + O(\u03b52), (9) \u03b3\u03b5(\u03c4\u03b5(t)) = \u03b30(t) + \u03b5\u03b31(t) + O(\u03b52) (uniformly in t), (10)\nwhereT1 is the linear shift in the limit cycle period in response to the static perturbation of size \u03b5. This global timing sensitivity, T1, is strictly positive if increasing \u03b5 increases the period. The perturbed time \u03c4\u03b5(t) satisfies the conditions \u03c40(t) \u2261 t and \u03c4\u03b5(t+T0)\u2212\u03c4\u03b5(t) = T\u03b5; it allows approximation (10) to be uniform in time1 and permits us to compare perturbed and unperturbed trajectories at corresponding time points. The vector function \u03b31(t) \u2261 \u2202\u03b3\u03b5(\u03c4\u03b5(t))\u2202\u03b5 |\u03b5\u21920 is the linear (i.e., firstorder) shift in the limit cycle shape.\nThe timing and shape aspects of limit cycles are complementary, and may be studied together by considering the infinitesimal phase response curve (IPRC) and the variational analysis of the limit cycle, respectively.\nInfinitesimal Phase Response Curve (IPRC) The IPRC is a classical analytic tool thatmeasures the timing response of an oscillator due to an infinitesimally small perturbation deliv-\n1 That is, the approximation remains valid for arbitrarily long times t . Formally, there exists a constant C > 0, independent of t , such that\u2223\u2223\u2223 \u03b3\u03b5(\u03c4\u03b5(t))\u2212\u03b30(t)\u03b5 \u2212 \u03b31(t) \u2223\u2223\u2223 < C\u03b5 as \u03b5 \u2192 0, for all t > 0.\nered at any given point on the limit cycle. It satisfies the adjoint equation (Schwemmer and Lewis 2012)\ndz dt = \u2212DF0(\u03b30(t))\u1d40z, (11)\nwith the normalization condition\nF0(\u03b30(t)) \u00b7 z(t) = 1.\nThe linear shift in period T1 can be calculated using the IPRC as T1 = \u2212 \u222b T0 0 z(t)\u1d40 \u2202F\u03b5(\u03b30(t)) \u2202\u03b5 \u2223\u2223\u2223 \u03b5=0dt . (12)\nForward Variational Equation Classical sensitivity analysis (Wilkins et al. 2009) has been used in many applications to study the shape sensitivity or response of an oscillator to sustained perturbations.\nThe dynamics of the linear shift\nv(t) \u2261 lim \u03b5\u21920(\u03b3\u03b5(t) \u2212 \u03b30(t))/\u03b5 (13)\nat time t of the periodic orbit \u03b3\u03b5(t) due to a sustained parametric perturbation \u03b5 initiated at time 0 satisfies the following forward variational equation:\ndv dt = DF0(\u03b30(t))v + \u2202F\u03b5(\u03b30(t)) \u2202\u03b5 \u2223\u2223\u2223 \u03b5=0 (14)\ntime, and aligning trajectories at the onset of closing. The red dashed curve denotes the product of the perturbation \u03b5 and the ISRC curve. The vertical blue dashed lines indicate the times at which the unperturbed grasper switches from closed to open. Shaded regions and the vertical magenta lines have the same meanings as in Fig. 2. The perturbation is the same as in Fig. 2\nwith initial condition v(0) set by the difference in the perturbed and unperturbed trajectories at the point where they cross the Poincar\u00e9 section defined by the beginning of the closed phase. Specifically,\nv(0) = lim \u03b5\u21920(\u03b3\u03b5(t close \u03b5 ) \u2212 \u03b30(tclose0 ))/\u03b5. (15)\nCompared with the homogeneous variational equation, which studies the shape sensitivity to instantaneous perturbations, the forward variational equation (14) contains a non-homogeneous term arising directly from the parametric perturbation acting on the vector field.\nHowever, since the perturbed limit cycle has a different period T\u03b5 and hence a different perturbed time \u03c4\u03b5 due to sustained perturbations, the forward variational equation which neglects such changes in timing fails to give a valid comparison between the perturbed and unperturbed trajectories for times on the order of a full cycle or longer (see Fig. 2C, D). Hence, we adopt a new tool developed in Wang et al. (2021), the infinitesimal shape response curve (ISRC), which incorporates both the shape and timing aspects and captures amore accurate first-order approximation to the change in shape of the limit cycle under a parametric perturbation.\nInfinitesimal Shape Response Curve (ISRC) Suppose the rescaled perturbed time can be written as \u03c4\u03b5(t) = t/\u03bd\u03b5 \u2208 [0, T\u03b5] for t \u2208 [0, T0]. It follows that the relative change in timing denoted by \u03bd\u03b5 = T0/T\u03b5 can be represented as \u03bd\u03b5 = 1 \u2212 \u03b5\u03bd1 + O(\u03b52) where \u03bd1 = T1T0 .\nWang et al. (2021) denote the linear shift in the periodic orbit, \u03b31(t) in (10), as the ISRC and adapted Lighthill\u2019s method of \u201cstrained coordinates\u201d (Jordan et al. 2007) to show it satisfies the following variational equation. An equation similar to (16) can also be derived by simultaneously Taylor expanding the state variable x around the limit cycle and its frequency (Keener 2018) (see \u201cAppendix C\u201d for details).\nd\u03b31(t)\ndt = DF0(\u03b3 (t))\u03b31(t) + \u03bd1F0(\u03b3 (t))\n+\u2202F\u03b5(\u03b3 (t)) \u2202\u03b5 \u2223\u2223\u2223 \u03b5=0. (16)\nThis equation resembles the forward variational equation (14), but has one additional non-homogeneous term arising from time rescaling t \u2192 \u03c4\u03b5(t). In contrast to the forward variational dynamics \u2202\u03b3\u03b5(t)\n\u2202\u03b5 , the ISRC \u03b31(t) is peri-\nodic with period T0 (see Fig. 11, left). To see how well the ISRC approximates the actual linear shift between the perturbed and unperturbed trajectories, we plot the linear shift approximated from the ISRC (black curve) and the actual displacement (red dashed curve). Overall, they show good agreement with each other except near the transition between the grasper-closed and grasper-open phases. Such discrepancies arise from the fact that the solution segment at the closing phase has different timing sensitivity to the parametric perturbation comparedwith the segment at the opening phase, as discussed before. While these small errors are nearly unno-\nticeable (seeFig. 11, right), they expandwhen the ISRC result is used to calculate the robustness (see Fig. 8, bottom panel).\nThus, in the case when a parametric perturbation leads to different timing sensitivities in different regions, we use the local timing response curve (LTRC) defined by Wang et al. (2021) to compute shifts in timing in different regions in order to improve the accuracy of the ISRC, as demonstrated when considering perturbations to the load applied to the seaweed (see Fig. 12).\nLocal Timing Response Curve (LTRC) The accuracy of the ISRC in approximating the linear change in the limit cycle shape evidently depends on its timing sensitivity, that is, the choice of the relative change in frequency \u03bd1. In (16), we chose \u03bd1 to be the relative change in the full period, by assuming the limit cycle has constant timing sensitivity. It is natural to expect that different choices of \u03bd1 will be needed for systems with varying timing sensitivities along the limit cycle. Tomore accurately capture timing sensitivity of such systems to static perturbations,Wang et al. (2021) defined a local timing response curve (LTRC) which is analogous to the IPRC but measures the linear shift in the time that the trajectory spends within any given region. Specifically, the LTRC is the gradient of the time remaining in a given region until exiting it through some specified Poincar\u00e9 section - a local timing surface corresponding to the exit boundary of this region. Such a section could be given as a boundary where the dynamics changes between regions, or where a perturbation is applied in one region but not another. For instance, in the feeding system of Aplysia californica (Shaw et al. 2015; Lyttle et al. 2017), the open-closed switching boundary of the grasper defines a local timing surface.\nLet \u03b7I denote the LTRC vector for region I. Suppose that at time t in, the trajectory \u03b30(t) enters region I upon crossing the surface in at the point xin; at time tout, \u03b30(t) exits region I upon crossing the surface out at the point xout. Similar to the IPRC, the LTRC \u03b7I satisfies the adjoint equation\nd\u03b7I\ndt = \u2212DF(\u03b3 (t))\u1d40\u03b7I (17)\ntogether with the boundary condition at the exit point\n\u03b7I(xout) = \u2212n out\nnout\u1d40F(xout) (18)\nwhere nout is a normal vector of out at the unperturbed exit point xout. The linear shift in the total time spent in region I, T I1 , is given by\nT I1 = \u03b7I(xin) \u00b7 \u2202xin\u03b5 \u2202\u03b5 \u2223\u2223\u2223 \u03b5=0 + \u222b tout t in \u03b7I(\u03b3 (t)) \u00b7 \u2202F\u03b5(\u03b3 (t)) \u2202\u03b5 \u2223\u2223\u2223 \u03b5=0dt,\n(19)\nwhere xin\u03b5 denotes the coordinate of the perturbed entry point into region I. It follows that the relative change in frequency local to region I is given by \u03bdI1 = T I1/(tout \u2212 t in). Piecewise uniform ISRC The existence of different timing sensitivities of \u03b3 (t) in different regions therefore leads to a piecewise-specified version of the ISRC (16) with period T0,\nd\u03b3 j1 (t)\ndt = DF j0 (\u03b3 (t))\u03b3 j1 (t) + \u03bd j1 F j0 (\u03b3 (t)) +\n\u2202F j\u03b5 (\u03b3 (t))\n\u2202\u03b5\n\u2223\u2223\u2223 \u03b5=0,\n(20)\nwhere \u03b3 j1 , F j 0 , F j \u03b5 and \u03bd j 1 denote the ISRC, the unperturbed vector field, the perturbed vector field, and the relative change in frequency in region j , respectively, with j \u2208 {I, II, III, . . .}. Note that in a smooth system, F j0 \u2261 F0 for all j .\nAs discussed before, the piecewise-specified ISRC, where \u03bd1 takes different values in the closing and opening phases, nicely complements the forward variational analysis. It provides a more self-consistent global description of the shape response of the limit cycle to themechanical perturbation (see Fig. 5). Displacements between perturbed and unperturbed trajectories estimated using the piecewise-specified ISRC agree well with the actual displacements (see Fig. 12). Moreover, it yields a much better approximation to the robustness compared with the ISRC with uniform rescaling (see Fig. 8)."
        },
        {
            "heading": "3.2 Timing and shape responses to static perturbations in nonsmooth systems",
            "text": "As discussed before, system (1) is a piecewise smooth system with one transversal crossing boundary o/c and three hard boundaries ( 0, 1, 2). The study of limit cycle motions in such nonsmooth systems requires analytical tools beyond the standard arsenal of phase response curves and variational analysis, developed for systems with smooth (differentiable) right-hand sides (Spardy et al. 2011a, b; Park et al. 2017). For small instantaneous displacements, variational analysis has been extended to nonsmooth dynamics with both transversal crossing boundaries and hard boundaries for studying the linearized effect on the shape of a trajectory (Filippov 1988; Bernardo et al. 2008; Leine and Nijmeijer 2013; Dieci and Lopez 2011). Analysis in terms of infinitesimal phase response curves (IPRC) has likewise been extended to nonsmooth dynamics for studying the linear shift in the timing of a trajectory following a small perturbation, provided the flow is always transverse to any switching surfaces at which nonsmooth transitions occur (Shirasaka et al. 2017; Park et al. 2018; Chartrand et al. 2018; Wilson 2019). Recently, Wang et al. (2021) extended the IPRC method to nonsmooth systems with hard boundaries.\nIn nonsmooth systems with degree of smoothness one or higher (i.e., Filippov systems), the right-hand-side changes discontinuously as one or more switching surfaces are crossed. A trajectory reaching a switching surface or boundary has two behaviors: it may cross the boundary transversally or it may slide along it. Hence, there are two types of boundary crossing points: transversal crossing points, at which the trajectory crosses a boundary with finite velocity in the direction normal to the boundary, and non-transversal crossing points including the landing point at which a sliding motion along a switching boundary begins, and the liftoff point at which the sliding terminates. The time evolutions of the solutions to the variational equation (i.e., the forward variational dynamics and the ISRC) and the solutions to the adjoint equation (i.e., the IPRC and the LTRC) may experience discontinuities at a boundary crossing point (Filippov 1988; Bernardo et al. 2008; Leine and Nijmeijer 2013; Park et al. 2018; Wang et al. 2021).\nThe discontinuity in the variational dynamics when a trajectory meets a boundary crossing point xp at crossing time tp can be expressed with the saltation matrix Sp (see Table 1):\nv+p = Sp v\u2212p where v(t) denotes the solution of the forward variational equation or the ISRC, v\u2212p = limt\u2192t\u2212p v(t) and v+p = limt\u2192t+p v(t) represent the solution just before and just after the crossing, respectively.\nThe discontinuity in z(t), the solution to the adjoint equation, at a boundary crossing point xp may be expressed with the forward jump matrix (Jp)\nz+p = Jpz\u2212p (21)\nwhere z\u2212p = limt\u2192t\u2212p z(t) and z+p = limt\u2192t+p z(t) are the IPRC or the LTRC just before and just after crossing the switching boundary at time tp in forwards time. However, Wang et al. (2021) showed that the jump matrix is not well defined at a liftoff point and hence introduced a time-reversed version of the jumpmatrix, denoted asJp , defined as follows:\nz\u2212p = Jpz+p (22)\nTable 1 summarizes the saltation and jump matrices at different types of boundary crossing points."
        },
        {
            "heading": "3.3 Simulation codes",
            "text": "Simulation codes written in Matlab are available at https:// github.com/yangyang-wang/AplysiaModel."
        },
        {
            "heading": "4 Discussion",
            "text": "Overview Motor systems are robust\u2014they maintain their performance despite perturbations. Understanding themechanisms of robustness is important but challenging. To unravel the contributions of different components of robustness, we adopted tools we established in Wang et al. (2021) and reviewed in the methods section (Sect. 3) for studying combined shape and timing responses of both continuous and nonsmooth limit cycle systems under small sustained perturbations.Weapplied these tools to understand themechanisms of robustness in a neuromechanical model of triphasic motor patterns in the feeding apparatus of Aplysia developed in Shaw et al. (2015) and Lyttle et al. (2017). We show in the results section (Sect. 2) that this framework lets us analyze how a small sustained perturbation alters the shape and tim-\ning of a closed loop system, and thus we began to describe how the neural and biomechanical components interact to contribute to robustness.\nThe first perturbation we considered was a sustained increase in mechanical load (Fsw \u2192 Fsw + \u03b5). To our surprise, we discovered that long before sensory feedback affected the system, biomechanics played an essential role in robustness by producing an immediate force increase to resist the applied load (Figs. 2, 3 and 4). Furthermore, although the sensory feedback immediately responded to the perturbation, its effect was delayed by the hard boundary properties of the neural firing rates. Our analysis suggests that sensory feedback contributes to the robustness primarily by shifting the timing of neural activation as opposed to changing neuronal firing rate amplitude (Figs. 5, 6 and 7). Our methods can also be readily used to quantify how changes in timing and shape of trajectory affect the robustness (Fig. 8). We find that sensory feedback and biomechanics contribute to the robustness of the system by generating a stronger retractor muscle force build-up during the prolonged retraction-closed phase that resists the increased load. The increased retractor muscle force ultimately leads to more seaweed being consumed during the slightly longer cycle time despite the large opposing forces, thereby contributing to a robust response. These new insights have refined and expanded a previous hypothesis that sensory feedback is the major mechanism that plays a crucial role in creating robust behavior (Lyttle et al. 2017).\nRobustness is sensitive to other model parameters. For example, in Sect. 2.5 we investigated how varying internal parameters such as strengths of sensory feedback andmuscle activity can help restore the performance that was reduced by an increased applied load (Figs. 9 and 10). Again, we obtained some non-intuitive results. For example, increasing the sensory feedback strength can reduce the robustness rather than improving it (Fig. 9). Moreover, increasing sensory feedback gain has opposite effects on performance and robustness, whereas increasing the protractor or retractor muscle strength improves both performance and robustness. Understanding sensitivities of performance to mixed parameters requires us to go beyond our existing methods.\nThis second-order sensitivity represents an interesting future direction for understanding neuromodulation - the coordinated change of multiple system parameters in order to most effectively counter the effect of an external perturbation (Cropper et al. 2018). There are multiple pathways for neuromodulation, and the simplicity of the model lends itself to detailed analysis of multifactor sensitivities. In future work, we may apply the variational tools used in the present paper for understanding howchanges inmultiple parameters simultaneously could impact model performance and robustness (cf. Sect. 2.5). Nonsmooth dynamics and biological realism Our model incorporates two types of nonsmooth dynamics. Both of these features complicate the model analysis, and one might ask whether an \u201cequivalent\u201d smooth formulation might have been employed. We emphasize that both types of nonsmooth dynamics provide better reflection of the underlying biophysics than a \u201csmoothed\u201d version would do, and contribute in fundamental ways to the biological mechanisms we study. Our model assumes that neurons fire, once excited, at a nonzero rate, and maintain a rate of exactly zero (rather than \u201cvery small\u201d) when inhibited. Thus our motor pool variables ai have hard boundaries at zero firing rate. It is well known that the Hodgkin\u2013Huxley model, for example, fires at very high rates when provided even relatively small currents, and slower rates are only possible with additional ionic conductances, such as the A current (see, for example, Hille (2001)). Studies on the energetics of neurons in real brains do not assume that they can fire at values much lower than a few Hertz. See, for example, Figure 2 in Laughlin and Sejnowski (2003), where the minimum firing rate for rat cortex is estimated to be about 3 Hz. Thus, the model we are using Lyttle et al. (2017) is more realistic than one that assumes that neurons can fire infinitely slowly [e.g., a sigmoid function or a hyperbolic tangent function (Ermentrout 1998)]. Thus, assuming that neurons fire once excited at a nonzero rate (and thus have a \u201chard boundary\u201d at 0 firing frequency) is more biologically realistic. Moreover, we have attempted to replicate the results in this paper using an alternative formulation in which we replace the hard boundary with a \u201csoft\u201d\nboundary, implemented using a sigmoidal firing rate function (Harris and Ermentrout 2015) and found that eliminating the hard boundary drives the system from the so-called heteroclinic cycling regime (Shaw et al. 2015; Lyttle et al. 2017) to the \u201climit cycle regime\u201d in which it fails to consume seaweed at a rate sufficient to support survival. In addition to the hard \u201csliding boundary\u201d at zero firing rateWang et al. (2021) our model has a nonsmooth transverse crossing of a Poincar\u00e9 section at the point when the grasper transitions from \u201copen\u201d to \u201cclosed,\u201d and the biomechanics switch from being free of the mechanical loading to engaging the mechanical load of the seaweed. It is important to realize that when an animal encounters a load, that interaction creates a nonlinear change in the dynamics of the system. Although some investigators attempt to finesse this aspect by trying to add a smoothly changing load function (such as a spring with a very stiff spring constant), an entire field devoted to hybrid systems has developed to study how dynamics evolves when there is a discontinuous change due to interaction with the environment [see, for example, Holmes et al. (2006) and Aihara and Suzuki (2010)]. Experimentally testable predictionsThe surprising result that the length-tension curves of the opposing muscles generate an instantaneous response to force perturbations could be tested, at least initially, using some of the more realistic biomechanics models that have been developed of Aplysia feeding.\nFor example, in a detailed kineticmodel that does not have sensory feedback (Sutton et al. 2004; Novakovic et al. 2006), one could apply a step increase in forcewhen theodontophore is closed and the retractor muscle is activated while measuring the force resistance to that change, and compare that to a purely passive response in which the retractor muscle is not activated. The results of this paper predict that there will be significant differences between these conditions.\nIn a model that does have sensory feedback (WebsterWood et al. 2020), one could apply a step increase in force when the odontophore is closed and measure the change in force and the duration of the cycle to determine how that perturbation alters fitness. This paper\u2019s results predict that the response to a sustained perturbation will be smaller in the presence of sensory feedback andwill be larger if sensory feedback is removed.\nThe model suggests that there may be delays from the time that sensory feedback is available to the time that force changes. Using the model, sinusoidal force changes could be applied at different frequencies to determine the predicted phase lag, and this effect could be tested in the real animal.\nResults shown in Fig. 9 suggest that themodel is relatively insensitive to changes in the strength of sensory feedback over a wide range of gains. Thus, one experimental test might be to increase or decrease the strength of sensory feedback to show that robustness to changing mechanical loads is not\nsignificantly affected. One way to test this hypothesis would be to use the newly developed technology of carbon fiber electrode arrays, which could be used to excite, inhibit, and record from many sensory neurons simultaneously (Huan et al. 2021).\nIn contrast, results shown in Fig. 10 suggest that changing the relative strengths of themuscles can have larger effects on robustness. Previous studies have shown that neuromodulators can speed up and strengthen muscular contractions and thus might contribute to robustness (Taghert and Nitabach 2012; Lu et al. 2015; Cropper et al. 2018). Studies of the neuromuscular transform (Brezina et al. 2000) suggested that neuromodulation could effectively speed up and strengthen feeding responses in normal animals, and thus might contribute to robustness.\nFuture experimental studies could be guided by coordinated changes of parameters in this model using the analysis tools we have presented. Caveats and limitations Tracking possible transitions into and out of constraint surfaces becomes combinatorially complex as the number of distinct constraint surfaces grows. Here we impose three hard boundaries at ai \u2265 0, as discussed above, by requiring firing rates to be nonnegative. An earlier model specification given in Shaw et al. (2015) and Lyttle et al. (2017) also required firing rates to be bounded via the constraint ai \u2264 1. Here we relax this constraint for computational convenience, since the coexistence of multiple constraints requires encoding entry/exit conditions and vector field restrictions for all feasible combinations of constraints. In practice, comparison of simulations with and without the ai \u2264 1 constraint give qualitatively and quantitatively indistinguishable results under most conditions.\nOur analysis is in principle limited to small perturbations. Large perturbations lead to crossing of bifurcation boundaries in which the behavior switches to a different dynamical mode. \u201cRobustness\u201d in a broader sense can mean the distance to a basin of attraction of another dynamical attractor. For example, if the force is increased too much, the model will collapse into a stable fixed point with overextended protraction, while the animal will engage a different response to release or sever the seaweed to avoid damage to its feeding apparatus. This aspect is not captured in the variational approach. Nonlinear and bifurcation analysis could complement the present study and is ripe for investigation in future work.\nIn this paper, we considered a specific perturbation, namely increasing the force opposing seaweed ingestion Fsw \u2192 Fsw + \u03b5. Note that in this formulation, the perturbation parameter \u03b5 carries the same units (force) as Fsw. Consequently, in order to use a unitless measure of robustness, expression (5) includes a factor of Fsw/\u03b5. Also, in this formulation, the timing sensitivity T1 (shift in period per increase in force) and shape sensitivity \u03b31 (shift in\nlimit cycle shape per increase in force) have units including reciprocal force. As an alternative formulation, which might facilitate comparison of robustness to perturbations across different modalities, one could rewrite the force perturbation as Fsw \u2192 Fsw(1 + \u03b5). In this case \u03b5 would represent a unitless measure of relative perturbation size. The subsequent variational, IPRC, ISRC and LTRC analysis would remain unchanged, except the resulting quantities Z , T1, \u03b31, and \u03b71 would undergo a change in units, hence a multiplicative (fixed) change in scale. An advantage of specifying perturbations as a relative or unitless quantity would be that a similar analysis to that undertaken in this paper could be applied to other modalities in the same system or across disparate systems. Generalizability to other systems Although we focused in the present work on the robustness of the mean rate of seaweed intake with respect to increases in the force opposing ingestion, our analysis carries over to other objective functions (e.g., calories consumedper energy expenditure) aswell as other perturbations (e.g., temperature, which may alter the speed of feeding in Aplysia). The variational approach to analyzing robustness should apply to any reasonable (e.g., smoothly differentiable) objective function and any parameter represented in the system, e.g., adjustments to changes in speed, steepness, or right-left asymmetry of walking movements on a (split) treadmill system (Frigon et al. 2013; Embry et al. 2018).\nOur methods might also provide insights into how rapidly a system can adjust to small modulation of forces. One could possibly conduct experiments to study the linear response of a system to modulation of applied force Fsw, such as an instantaneous small change from one static force to another, or a small amplitude sinusoidal modulation of Fsw. The infinitesimal shape response curve and other variational tools developed inWang et al. (2021)might play a role in the linear response analysis. This treatment could represent an interesting future direction.\nThe present manuscript applies variational methods to understand the robustness in a specificAplysia neuromechanical model (Lyttle et al. 2017). This model makes significant simplifications to the real feeding apparatus control system in order to gain mathematical tractability and analytical and biological insights. Nonetheless, the framework developed in Wang et al. (2021) applies naturally to more elaborate dynamical models of Aplysia feeding such asWebster-Wood et al. (2020) and models incorporating conductance-based network descriptions of the central pattern generator (Cataldo et al. 2006; Costa et al. 2020). Thus, what we have done here provides a framework for understanding neural control of motor behaviors like the one considered in this paper.\nMore broadly, motor control beyond the Aplysia feeding system is also amenable to the analysis of the sort developed in Sect. 3 (Wang et al. 2021). For example, the stability\nof bipedal walking movements remains a challenge in the field of mobile robotics Vukobratovic et al. (2012); Westervelt et al. (2018). Biologically inspired robotics continues to provide alternative approaches with greater robustness than conventional devices (Beer 2009; Pfeifer et al. 2007; Beer et al. 1997; Goldsmith et al. 2019). The variational framework exhibited here applies to these systems as well (Fitzpatrick et al. 2020). In the context of any motor control model, the variational analysis we present here should allow analysis of robustness of any reasonable objective function with respect to any system parameter.\nAcknowledgements Thisworkwas supported in part byNational Institutes of Health BRAIN Initiative grant RF1 NS118606-01 to HJC and PJT, by NSF grant DMS-2052109 to PJT, by NSF grant IOS1754869 to HJC, by NIH/NIDA R01DA057767 to YW, as part of the NSF/NIH/DOE /ANR/BMBF/BSF/NICT/AEI/ISCIII Collaborative Research in Computational Neuroscience Program and by NSF grant DBI 2015317 toHJC, as part of theNSF/CIHR/DFG/FRQ/UKRIMRCNext Generation Networks for Neuroscience Program. This work was supported in part by the Oberlin College Department of Mathematics. We thank Zhuojun Yu for providing a critical reading of the manuscript. We thank the anonymous reviewer for suggesting an alternative way of deriving the infinitesimal shape response curve, which is now included in the \u201cAppendix C.\u201d\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, youwill need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecomm ons.org/licenses/by/4.0/."
        },
        {
            "heading": "A Tables for model parameters and initial conditions",
            "text": "Values for model parameters and initial conditions of state variables are given in Tables 2 and 3."
        },
        {
            "heading": "B Different timing sensitivities tomuscle perturbations",
            "text": "Here we explain why increasing the protractor (resp., retractor) muscle activation during the early closing phase leads to a phase delay (resp., phase advance), whereas increasing the muscle activations during the late closing phase lead to the opposite effects (see Fig. 6 in Sect. 2.3.1).\nEarly in the closing phase (i.e., the protraction-closed phase), increasing u0 leads to a phase delay. This effect occurs because with larger u0 force, xr protracts more, which\nprolongs the inhibition to a0 through sensory feedback (feedback to a0 is inhibitory when xr > 0.5). Hence a0 activates at a later time and the switch from closed to open is delayed, corresponding to a phase delay (see Fig. 13A).\nOn the other hand, increasing u1 during the early closing phase leads to a phase advance, because xr decreases due to the increased retraction muscle forces and hence the inhibition switches to excitation earlier than in the original case (see Fig. 13C).\nDuring the late retraction-closed phase, increasing u0 leads to a phase advance (see Fig. 13B). With increased protractor muscle force, xr increases, but soon the state transitions to protraction-open. Then, the inhibition on a1 from the sensory feedback (feedback to a1 is inhibitory when xr < 0.5) will be released earlier than before, because xr is larger under perturbation and hence a1 activates earlier. As a result, the system switches from opening to closing phase earlier and this change corresponds to a phase advance.\nOn the other hand, if we increase u1 during the late closing phase, a phase delay results because xr decreases with the perturbation. This effect prolongs the inhibition from sensory feedback to a1, since xr stays below 0.5 for a longer time (see Fig. 13D)."
        },
        {
            "heading": "C An alternative derivation of the infinitesimal shape response curve",
            "text": "Recall that we assume for \u03b5 small,\nx\u2032 = F\u03b5(x)\nhas a linearly asymptotically stable limit cycle with frequency w(\u03b5) depending (at least C1) on \u03b5. To incorporate the unknown period into the problem, we make the change of variables s = T0w(\u03b5)t . Then, we look for period T0 periodic solutions of the new equation\nT0w(\u03b5)x\u2032 = F\u03b5(x) (23)\nwhere the prime \u2032 denotes the derivative with respect to s. We can write\nx(t) = x0(t) + \u03b5x1(t) + . . . w(\u03b5) = w0 + \u03b5w1 + . . . (24)\nWe substitute the above expansions into the governing equation (23), collect like powers of \u03b5 and obtain the following equations\nx\u20320 = F0(x0) x\u20321 \u2212 DF0(x0)x1 = G(x0) \u2212 T0w1x\u20320\n(25)\nwhere G(x0) = \u2202F\u03b5(x0)\u2202\u03b5 |\u03b5\u21920. The first equation in (25) is just the unperturbed differential equationwith x0 representing the coordinate of the unperturbed limit cycle. The second equation is equivalent to the ISRC equation (2.20) that we derived in Wang et al. (2021) and x1 denotes the coordinates of the linear displacement between the perturbed and unperturbed limit cycle.\nBy the Fredholm Alternative, the second equation of (25) has a solution if and only if \u222b T0 0 (G(x0(s)) \u2212 T0w1x\u20320(s)) \u00b7 z(s) ds = 0\nwhere z is the infinitesimal phase response curve. Hence, the linear shift in the frequency is given by\nw1 = 1 T 20 \u222b T0 0 G(x0(s)) \u00b7 z(s) ds,\nwhich is equivalent to equation (2.14) in Wang et al. (2021)."
        }
    ],
    "title": "Variational and phase response analysis for limit cycles with hard boundaries, with applications to neuromechanical control problems",
    "year": 2022
}