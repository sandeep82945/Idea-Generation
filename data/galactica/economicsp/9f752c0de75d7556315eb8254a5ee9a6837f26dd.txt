conclusion This paper provides a solution to the intra-day rollingwindow joint dispatch and pricing of energy and reserve, which is necessary for the accommodation of increasing volatile and uncertain renewables but has not been properly addressed yet in both industry and academia. A novel rollingwindow energy-reserve co-optimization has been proposed to coordinate inter-temporal ramp with intra-temporal reserve and minimize the expected system total cost considering scenario trajectories of possible outages and load/renewable deviations. 10
Based on the proposed model, marginal prices of energy and reserve have been derived, which incorporate the Lagrangian multipliers of generators’ private ramping limits to eliminate their possible ramping-induced opportunity costs or arbitrages. Indicated by the proposed pricing, generation resources at the same bus are heterogeneous for their differentiated ramping capabilities, and reserve resources are further heterogeneous for their differentiated re-dispatch marginal costs. Based on the proposed dispatch and pricing, dispatch-following and truthful-bidding incentives of generators have been proved, and revenue adequacy of the ISO has been numerically validated in the case study. appendix a notations and nomenclatures The notations and nomenclatures are presented in Table I. 11 appendix b proof of dispatch-following incentives We first consider some KKT conditions of the proposed look-ahead co-optimization F t(·) over Ht as follows:
∂L∗t ∂git =−(λ∗t,0−STG(·,mi)ϕ∗t,0)− ∑ s∈St (λ∗t,s−STG,t,s(·,mi)ϕ∗t,s)
− ( µ∗it−µ∗it ) + ( µ∗i(t−1)−µ ∗ i(t−1) ) +Cgit+υ ∗ it−υ∗it
=0, (31) ∂L∗t ∂rUit =− ∑ s∈St α∗it,s + µ ∗ i(t−1) + µ ∗ it + CUit + υ ∗ it − ρU∗it + ρ U∗ it =0, (32) ∂L∗t ∂rDit =− ∑ s∈St β ∗ it,s + µ ∗ i(t−1) + µ ∗ it + C D it + υ ∗ it − ρD∗it + ρ D∗ it
=0, (33)
where L∗t represents the optimal Lagrangian of F t(·). With the pricing formulations in (14)-(16) of πgit, π U it , π D it , these KKT conditions can be further transformed into ∂L∗t ∂git = −πgit + C g it + υ ∗ it − υ∗it = 0, (34) ∂L∗t ∂rUit = −πUit + CUit + υ∗it − ρU∗it + ρ U∗ it = 0, (35) ∂L∗t ∂rDit = −πDit + CDit + υ∗it − ρD∗it + ρ D∗ it = 0. (36)
We next consider the case where each generator i selfschedules its energy and reserve provision at t to maximize
its profit at t with given prices πit = {πgit, πUit , πDit } from the ISO for t, and write the corresponding model as:
Qit(π̃it)= ( πgitgit+π U itr U it+π D itr D it ) − ( Cgitgit+C U itr U it+C D itr D it ) ,
(37) maximize {git,rUit,rDit} Qit(π̃it), subject to: (υ′it, υ ′ it) : Git ≤ git − rDit , git + rUit ≤ Git, (38) (ρD ′
it , ρD
′ it , ρ U ′ it , ρU ′ it ) : 0 ≤ rDit ≤ RDit , 0 ≤ rUit ≤ RUit , (39) (µ′
i(t−1)) : −rit ≤ git − gi(t−1) − r D it − rUi(t−1), (40)
(µ′i(t−1)) : git − gi(t−1) + r U it + r D i(t−1) ≤ rit. (41)
For the above model, if we set
µ′ i(t−1) = 0, µ ′ i(t−1) = 0, ρ
D′
it = ρD∗ it , ρD
′
it = ρ D∗ it ,
ρU ′ it = ρU∗ it , ρU ′ it = ρ U∗ it , υ ′ it = υ ∗ it, υ ′ it = υ ∗ it (42)
where ρD∗ it , ρD∗it , ρ U∗ it , ρU∗it , υ ∗ it, υ ∗ it are optimally solved from the proposed co-optimization F t(·) over Ht, then based on (34)-(36), we can observe that this set of dual variables in (42) and the set of primal variables {g∗it, rU∗it , rD∗it } solved from F t(·) satisfy the KKT conditions of the model in (37)- (41), which indicates that
{g∗it, rU∗it , rD∗it } = argmax {git,rUit,rDit} {Qit(π̃it)|(38)− (41)}. Furthermore, from (42), we can observe that {g∗it, rU∗it , rD∗it } optimizes Qit(π̃it) with the Lagrangian multipliers of ramping constraints (40)-(41) being zero, what means that {g∗it, rU∗it , rD∗it } also optimizes Qit(π̃it) for the rampunconstrained case, i.e.,
{g∗it, rU∗it , rD∗it } = argmax {git,rUit,rDit} {Qit(π̃it)|(38)− (39)}. This can be easily augmented to the ramp-unconstrained multiinterval profit-maximization over H as
{g∗it, rU∗it , rD∗it ,∀t∈H}= argmax {git,rUit,rDit ,∀t∈H} {Qi(π̃i)|(21)−(22)}. Meanwhile, since the ramping constraints of generators are indeed incorporated into every F t(·) for t ∈ H , then it is obvious that {g∗it, rU∗it , rD∗it ,∀t ∈ H } given by the ISO definitely satisfies generators’ ramping constraints over H , which indicates that {g∗it, rU∗it , rD∗it ,∀t ∈ H } also optimizes Qi(π̃i) for the ramp-constrained case, i.e.,
{g∗it, rU∗it , rD∗it ,∀t∈H}= argmax {git,rUit,rDit ,∀t∈H} {Qi(π̃i)|(21)−(24)},
proving Theorem 1. appendix c proof of cost recovery The proof of cost recovery is quite intuitive. Namely, With the additional zero-lower-bound assumption, consider any generator i. A feasible solution to its multi-interval profitmaximization in (20)-(24) is to provide zero energy and reserve over H and earn a zero bid-in profit over H . At
12
the same time, according to Theorem 1, the optimal solution is to follow the ISO’s dispatch of energy and reserve P̃i over H . Therefore, by following P̃i over H , generator i can earn an overall bid-in profit that is no less than zero, proving its cost recovery. appendix d proof of truthful-bidding incentives We first revisit the strategic bidding model of any generator i given in (26)-(30). The truthful operational parameters of generator i in constraints (27)-(30) actually construct its truthful feasible dispatch region over H , which limits generator i’s bidding behavior as it wants the rolling-window dispatch of energy and reserve from the ISO to fall into that region, otherwise it would not be physically able to follow. Moreover, note that when bidding truthfully, the profit of generator i over H can be expressed as
Πi(θ ∗ i )= ∑ t∈H ( πitg ∗ it(θ ∗ i )+π U itr U∗ it (θ ∗ i )+π D itr D∗ it (θ ∗ i ) )
(43)
− ∑ t∈H ( Cg∗it g ∗ it(θ ∗ i )+C U∗ it r U∗ it (θ ∗ i )+C D∗ it r D∗ it (θ ∗ i ) ) ,
where {g∗it(θ∗i ), rU∗it (θ∗i ), rD∗it (θ∗i ),∀t ∈ H } are the ISO’s dispatch quantities over H with truthful bid θ∗i from generator i. From dispatch-following incentives in Theorem 1, we can further interpret that
Πi(θ ∗ i ) = ∑ t∈H ( πitg ∗ it(θ ∗ i )+π U itr U∗ it (θ ∗ i )+π D itr D∗ it (θ ∗ i ) )
− ∑ t∈H ( Cg∗it g ∗ it(θ ∗ i )+C U∗ it r U∗ it (θ ∗ i )+C D∗ it r D∗ it (θ ∗ i ) )
=Q∗i (·|θ∗i ), (44)
where Q∗i (·|θ∗i ) is the optimal value of generator i’s multiinterval profit-maximization (20)-(24) with its cost coefficients and operational parameters being truthful θ∗i , which further implies that
Πi(θ ∗ i ) = ∑ t∈H ( πitg ∗ it(θ ∗ i )+π U itr U∗ it (θ ∗ i )+π D itr D∗ it (θ ∗ i ) )
− ∑ t∈H ( Cg∗it g ∗ it(θ ∗ i )+C U∗ it r U∗ it (θ ∗ i )+C D∗ it r D∗ it (θ ∗ i ) )
=Q∗i (·|θ∗i ) ≥ ∑ t∈H (πitgit+π U itr U it+π D itr D it −C g∗ it git−C U∗ it r U it−CD∗it rDit)
(45)
for any set of {git, rUit , rDit ,∀t ∈ H } that lies in generator i’s truthful feasible dispatch region. Note that no matter how generator i submits its bid θi, the dispatch over H that it receives must be within its truthful feasible dispatch region. Therefore, any feasible bid θi definitely corresponds to a set of {git, rUit , rDit ,∀t ∈ H } in the truthful feasible dispatch region. Combining this with (45), we can terminally interpret that
Πi(θ ∗ i ) ≥ Πi(θi), (46)
proving Theorem 2. appendix e benchmark: deterministic co-optimization U t = ∑ τ∈Ht ∑ i∈NG ( Cgiτgiτ + C U iτr U iτ + C D iτ r D iτ ) , (47)
minimize {giτ ,rUiτ ,rDiτ ,∀τ∈Ht}
U t(·), subject to ∀τ ∈ Ht:
λτ : ∑ i∈NG giτ = ∑ l∈ND d̂lτ , (48)
ϕτ : SG · g[τ ]− SD · d̂[τ ]≤f , (49)
(χUτ , χ D τ ) : ∑ i∈NG rUiτ = Req U τ , ∑ i∈NG rDiτ = Req D τ , (50) Giτ ≤ giτ − rDiτ , giτ + rUiτ ≤ Giτ , (51) 0 ≤ rDiτ ≤ RDiτ , 0 ≤ rUiτ ≤ RUiτ , (52) − riτ ≤ giτ − gi(τ−1) − rDiτ − rUi(τ−1), (53) giτ − gi(τ−1) + rUiτ + rDi(τ−1) ≤ riτ , (54)
where ReqUτ /Req D τ are the upward/downward reserve requirement parameters at interval τ . Based on this model, the deterministic LMP of any generator i at t is
ηgit = λ ∗ t − STG(·,mi)ϕ∗t , (55)
and its deterministic upward and downward reserve pricing at t is
ηUit = χ U t , η D it = χ D t , (56)
respectively.