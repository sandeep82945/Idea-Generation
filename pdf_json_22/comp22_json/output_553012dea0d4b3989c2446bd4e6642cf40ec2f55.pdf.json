{
    "abstractText": "Computational materials discovery has grown in utility over the past decade due to advances in computing power and crystal structure prediction algorithms (CSPA). However, the computational cost of the ab initio calculations required by CSPA limits its utility to small unit cells, reducing the compositional and structural space the algorithms can explore. Past studies have bypassed unneeded ab initio calculations by utilizing machine learning to predict the stability of a material. Specifically, graph neural networks trained on large datasets of relaxed structures display high fidelity in predicting formation energy. Unfortunately, the geometries of structures produced by CSPA deviate from the relaxed state, which leads to poor predictions, hindering the model\u2019s ability to filter unstable material. To remedy this behavior, we propose a simple, physically motivated, computationally efficient perturbation technique that augments training data, improving predictions on unrelaxed structures by 66%. Finally, we show how this error reduction can accelerate CSPA.",
    "authors": [
        {
            "affiliations": [],
            "name": "Jason Gibson"
        },
        {
            "affiliations": [],
            "name": "Ajinkya Hire"
        },
        {
            "affiliations": [],
            "name": "Richard G. Hennig"
        }
    ],
    "id": "SP:921bd52514a3c769e8c8f3923de836ff13c53421",
    "references": [
        {
            "authors": [
                "Jain",
                "A. et al. The materials project"
            ],
            "title": "a materials genome approach to accelerating materials innovation",
            "venue": "APL Mater. 1, 011002",
            "year": 2013
        },
        {
            "authors": [
                "Kirklin",
                "S. et al. The open quantum materials database (oqmd"
            ],
            "title": "assessing the accuracy of dft formation energies",
            "venue": "NPJ Comput. Mater. 1, 15010",
            "year": 2015
        },
        {
            "authors": [
                "C. Draxl",
                "Scheffler",
                "M. Nomad"
            ],
            "title": "The fair concept for big data-driven materials science",
            "venue": "MRS Bull. 43, 676\u2013682",
            "year": 2018
        },
        {
            "authors": [
                "Curtarolo",
                "S. et al. Aflow"
            ],
            "title": "an automatic framework for high-throughput materials discovery",
            "venue": "Comput. Mater. Sci. 58, 218\u2013226",
            "year": 2012
        },
        {
            "authors": [
                "A.R. Oganov",
                "C.J. Pickard",
                "Q. Zhu",
                "R.J. Needs"
            ],
            "title": "Structure prediction drives materials discovery",
            "venue": "Nat. Rev. Mater",
            "year": 2019
        },
        {
            "authors": [
                "B. Revard",
                "W. Tipton",
                "R. Hennig"
            ],
            "title": "Genetic algorithm for structure and phase prediction",
            "venue": "https://github.com/henniggroup/GASP-python",
            "year": 2018
        },
        {
            "authors": [
                "D.J. Wales",
                "J.P.K. Doye"
            ],
            "title": "Global optimization by basin-hopping and the lowest energy structures of lennard-jones clusters containing up to 110 atoms",
            "venue": "J. Phys. Chem. A 101,",
            "year": 1997
        },
        {
            "authors": [
                "J Noh"
            ],
            "title": "Unveiling new stable manganese based photoanode materials via theoretical high-throughput screening and experiments",
            "venue": "Chem. Commun",
            "year": 2019
        },
        {
            "authors": [
                "B Chen"
            ],
            "title": "Phase stability and superconductivity of lead hydrides at high pressure",
            "venue": "Phys. Rev. B 103,",
            "year": 2021
        },
        {
            "authors": [
                "D Duan"
            ],
            "title": "Pressure-induced metallization of dense (h2s)2h2 with high-tc superconductivity",
            "venue": "Sci. Rep. 4",
            "year": 2014
        },
        {
            "authors": [
                "H. Liu",
                "I.I. Naumov",
                "R. Hoffmann",
                "N.W. Ashcroft",
                "R.J. Hemley"
            ],
            "title": "Potential high-tc superconducting lanthanum and yttrium hydrides at high pressure",
            "venue": "Proc. Natl Acad. Sci. USA",
            "year": 2017
        },
        {
            "authors": [
                "Peng",
                "F. et al. Hydrogen clathrate structures in rare earth hydrides at high pressures"
            ],
            "title": "possible route to room-temperature superconductivity",
            "venue": "Phys. Rev. Lett. 119 https://doi.org/10.1103/physrevlett.119.107001",
            "year": 2017
        },
        {
            "authors": [
                "Y. Sun",
                "J. Lv",
                "Y. Xie",
                "H. Liu",
                "Y. Ma"
            ],
            "title": "Route to a superconducting phase above room temperature in electron-doped hydride compounds under high pressure",
            "venue": "Phys. Rev. Lett. 123",
            "year": 2019
        },
        {
            "authors": [
                "S.D. Cataldo",
                "C. Heil",
                "W. von der Linden",
                "Boeri",
                "L. LaBH8"
            ],
            "title": "towards high- tc lowpressure superconductivity in ternary superhydrides",
            "venue": "Phys. Rev. B 104 https:// doi.org/10.1103/physrevb.104.l020511",
            "year": 2021
        },
        {
            "authors": [
                "K.P. Hilleke",
                "Zurek",
                "E. Tuning chemical precompression"
            ],
            "title": "Theoretical design and crystal chemistry of novel hydrides in the quest for warm and light superconductivity at ambient pressures",
            "venue": "J. Appl. Phys. 131, 070901",
            "year": 2022
        },
        {
            "authors": [
                "Y. Huang",
                "Y. Cheng",
                "J. Zhang"
            ],
            "title": "A review of high density solid hydrogen storage materials by pyrolysis for promising mobile applications",
            "venue": "Ind. Eng. Chem. Res",
            "year": 2021
        },
        {
            "authors": [
                "W.W. Tipton",
                "C.A. Matulis",
                "R.G. Hennig"
            ],
            "title": "Ab initio prediction of the li5ge2 zintl compound",
            "venue": "Comput. Mater. Sci",
            "year": 2014
        },
        {
            "authors": [
                "Nguyen",
                "M.C. et al. New layered structures of cuprous chalcogenides as thin film solar cell materials"
            ],
            "title": "cu2Te and cu2Se",
            "venue": "Phys. Rev. Lett. 111, 165502",
            "year": 2013
        },
        {
            "authors": [
                "S. Heiles",
                "R.L. Johnston"
            ],
            "title": "Global optimization of clusters using electronic structure methods",
            "venue": "Int J. Quantum Chem. 113,",
            "year": 2013
        },
        {
            "authors": [
                "S.R. Xie",
                "M. Rupp",
                "R.G. Hennig"
            ],
            "title": "Ultra-fast interpretable machine-learning potentials",
            "year": 2021
        },
        {
            "authors": [
                "Wu",
                "S. Q"
            ],
            "title": "Adaptive genetic algorithm for crystal structure prediction",
            "venue": "J. Phys. Condens. Matter",
            "year": 2013
        },
        {
            "authors": [
                "P.C. Jennings",
                "S. Lysgaard",
                "J.S. Hummelsh\u00f8j",
                "T. Vegge",
                "T. Bligaard"
            ],
            "title": "Genetic algorithms for computational materials discovery accelerated by machine learning",
            "venue": "NPJ Comput. Mater",
            "year": 2019
        },
        {
            "authors": [
                "T. Xie",
                "J.C. Grossman"
            ],
            "title": "Crystal graph convolutional neural networks for an accurate and interpretable prediction of material properties",
            "venue": "Phys. Rev. Lett. 120,",
            "year": 2018
        },
        {
            "authors": [
                "Z. Ahmad",
                "T. Xie",
                "C. Maheshwari",
                "J.C. Grossman",
                "V. Viswanathan"
            ],
            "title": "Machine learning enabled computational screening of inorganic solid electrolytes for suppression of dendrite formation in lithium metal anodes",
            "venue": "ACS Cent. Sci",
            "year": 2018
        },
        {
            "authors": [
                "K. Choudhary",
                "B. DeCost"
            ],
            "title": "Atomistic line graph neural network for improved materials property predictions",
            "venue": "NPJ Comput. Mater. 7,",
            "year": 2021
        },
        {
            "authors": [
                "J. Cheng",
                "C. Zhang",
                "L. Dong"
            ],
            "title": "A geometric-information-enhanced crystal graph network for predicting properties of materials",
            "venue": "Commun. Mater. 2,",
            "year": 2021
        },
        {
            "authors": [
                "C. Chen",
                "W. Ye",
                "Y. Zuo",
                "C. Zheng",
                "S.P. Ong"
            ],
            "title": "Graph networks as a universal machine learning framework for molecules and crystals",
            "venue": "Chem. Mater",
            "year": 2019
        },
        {
            "authors": [
                "C.W. Park",
                "C. Wolverton"
            ],
            "title": "Developing an improved crystal graph convolutional neural network framework for accelerated materials discovery",
            "venue": "Phys. Rev. Mater",
            "year": 2020
        },
        {
            "authors": [
                "J. Noh",
                "G.H. Gu",
                "S. Kim",
                "Y. Jung"
            ],
            "title": "Uncertainty-quantified hybrid machine learning/density functional theory high throughput screening method for crystals",
            "venue": "J. Chem. Inf. Model",
            "year": 2020
        },
        {
            "authors": [
                "N. Srivastava",
                "G. Hinton",
                "A. Krizhevsky",
                "I. Sutskever",
                "Salakhutdinov",
                "R. Dropout"
            ],
            "title": "a simple way to prevent neural networks from overfitting",
            "venue": "J. Mach. Learn Res 15, 1929\u20131958",
            "year": 2014
        },
        {
            "authors": [
                "R.E.A. Goodall",
                "A.S. Parackal",
                "F.A. Faber",
                "R. Armiento",
                "A.A. Lee"
            ],
            "title": "Rapid discovery of stable materials by coordinate-free coarse graining",
            "venue": "Sci. Adv. 8,",
            "year": 2022
        },
        {
            "authors": [
                "J.S. Smith",
                "O. Isayev",
                "Roitberg",
                "A.E. Ani-1"
            ],
            "title": "an extensible neural network potential with dft accuracy at force field computational cost",
            "venue": "Chem. Sci. 8, 3192\u20133203",
            "year": 2017
        },
        {
            "authors": [
                "S.J. Honrao",
                "S.R. Xie",
                "R.G. Hennig"
            ],
            "title": "Augmenting machine learning of energy landscapes with local structural information",
            "venue": "J. Appl. Phys. 128,",
            "year": 2020
        },
        {
            "authors": [
                "Nakkiran",
                "P. et al. Deep double descent"
            ],
            "title": "where bigger models and more data hurt",
            "venue": "J. Stat. Mech. Theory Exp. 2021, 124003",
            "year": 2021
        },
        {
            "authors": [
                "B.C. Revard",
                "W.W. Tipton",
                "R.G. Hennig"
            ],
            "title": "Prediction and Calculation of Crystal Structures (eds Atahan-Evrenk, S",
            "venue": "(Springer International Publishing,",
            "year": 2014
        },
        {
            "authors": [
                "Y Kim"
            ],
            "title": "Deep learning framework for material design space exploration using active transfer learning and data augmentation",
            "venue": "NPJ Comput. Mater. 7,",
            "year": 2021
        },
        {
            "authors": [
                "U.K. Deiters"
            ],
            "title": "Efficient coding of the minimum image convention",
            "venue": "Z. Phys. Chem. (N. F.)",
            "year": 2013
        },
        {
            "authors": [
                "Pedregosa",
                "F. et al. Scikit-learn"
            ],
            "title": "Machine learning in python",
            "venue": "J. Mach. Learn. Res. 12, 2825\u20132830",
            "year": 2011
        },
        {
            "authors": [
                "Omee",
                "S. S"
            ],
            "title": "Scalable deeper graph neural networks for high-performance materials property prediction",
            "venue": "Patterns 3,",
            "year": 2022
        },
        {
            "authors": [
                "G.B. Goh",
                "N.O. Hodas",
                "A. Vishnu"
            ],
            "title": "Deep learning for computational chemistry",
            "venue": "J. Comput Chem",
            "year": 2017
        },
        {
            "authors": [
                "W.W. Tipton",
                "R.G. Hennig"
            ],
            "title": "A grand canonical genetic algorithm for the prediction of multi-component phase diagrams and testing of empirical potentials",
            "venue": "J. Phys. Condens. Matter 25,",
            "year": 2013
        },
        {
            "authors": [
                "B.C. Revard",
                "W.W. Tipton",
                "A. Yesypenko",
                "R.G. Hennig"
            ],
            "title": "Grand-canonical evolutionary algorithm for the prediction of two-dimensional materials",
            "venue": "Phys. Rev. B",
            "year": 2016
        },
        {
            "authors": [
                "G. Kresse",
                "J. Hafner"
            ],
            "title": "Ab initio molecular dynamics for liquid metals",
            "venue": "Phys. Rev. B",
            "year": 1993
        },
        {
            "authors": [
                "G. Kresse",
                "J. Hafner"
            ],
            "title": "Ab initio molecular-dynamics simulation of the liquidmetal\u2013amorphous-semiconductor transition in germanium",
            "venue": "Phys. Rev. B",
            "year": 1994
        },
        {
            "authors": [
                "G. Kresse",
                "J. Furthm\u00fcller"
            ],
            "title": "Efficiency of ab-initio total energy calculations for metals and semiconductors using a plane-wave basis set",
            "venue": "Comput. Mater. Sci. 6,",
            "year": 1996
        },
        {
            "authors": [
                "G. Kresse",
                "J. Furthm\u00fcller"
            ],
            "title": "Efficient iterative schemes for ab initio total-energy calculations using a plane-wave basis set",
            "venue": "Phys. Rev. B",
            "year": 1996
        },
        {
            "authors": [
                "P.E. Bl\u00f6chl"
            ],
            "title": "Projector augmented-wave method",
            "venue": "Phys. Rev. B 50,",
            "year": 1994
        },
        {
            "authors": [
                "J.P. Perdew",
                "K. Burke",
                "M. Ernzerhof"
            ],
            "title": "Generalized gradient approximation made simple",
            "venue": "Phys. Rev. Lett. 77,",
            "year": 1996
        }
    ],
    "sections": [
        {
            "text": "ARTICLE OPEN\nData-augmentation for graph neural network learning of the relaxed energies of unrelaxed structures"
        },
        {
            "heading": "Jason Gibson 1,2\u2709, Ajinkya Hire 1,2\u2709 and Richard G. Hennig 1,2\u2709",
            "text": "Computational materials discovery has grown in utility over the past decade due to advances in computing power and crystal structure prediction algorithms (CSPA). However, the computational cost of the ab initio calculations required by CSPA limits its utility to small unit cells, reducing the compositional and structural space the algorithms can explore. Past studies have bypassed unneeded ab initio calculations by utilizing machine learning to predict the stability of a material. Specifically, graph neural networks trained on large datasets of relaxed structures display high fidelity in predicting formation energy. Unfortunately, the geometries of structures produced by CSPA deviate from the relaxed state, which leads to poor predictions, hindering the model\u2019s ability to filter unstable material. To remedy this behavior, we propose a simple, physically motivated, computationally efficient perturbation technique that augments training data, improving predictions on unrelaxed structures by 66%. Finally, we show how this error reduction can accelerate CSPA.\nnpj Computational Materials (2022) 8:211 ; https://doi.org/10.1038/s41524-022-00891-8"
        },
        {
            "heading": "INTRODUCTION",
            "text": "The process of discovery of functional materials, which drives innovation, has dramatically accelerated over the past decade, partially as a product of growing crystal structure databases1\u20134 and improved computationally based CSPA5, such as genetic algorithms (GA)6, basin hoping7, elemental substitution8, and particle swarm techniques9. CSPA have played a prominent role in successfully predicting the structure and establishing the stability of high-pressure, high-temperature superconducting binary hydrides10\u201312. Many recent studies have started looking for stable ternary hydride superconductors. The addition of a third element to the binary hydrides can potentially stabilize these materials at much lower pressure13\u201315. Complex ternary and quaternary materials systems are also promising candidates for hydrogen storage applications16. In particular, GAs have proven their utility to identify thermodynamically stable phases efficiently; successfully identifying previously unknown materials for applications such as Li-Ge batteries17 and solar cells18. Unfortunately, finding thermodynamically stable phases in ternary and quaternary systems is notoriously difficult due in part to the computationally expensive ab initio calculations required to relax and calculate the energies of GA produced structures, accounting for 99% of the algorithm\u2019s computational cost19. This places restrictions on the size and the composition of the unit cells, inhibiting the exploration of complex material systems. This computational cost can be reduced by bypassing many of the costly ab initio calculations via a machine-learned filter or by implementing a more computationally efficient machine-learned surrogate potential to pre-relax structures20. Wu et al.21 fitted a classical potential to the structures evaluated by density functional theory (DFT). They used the potential to pre-relax the structures in the GA and only evaluated the best structures with DFT. Jennings et al.22 used a machine learning (ML) model to predict a structure\u2019s fitness directly and then only used DFT to evaluate structures that improved the current population. These methods are still\nsomewhat hindered because many DFT evaluated structures are required to train a ML model to an adequate fidelity. Further, the models are specific to the materials\u2019 space the GA is searching, restricting their application to the given GA search. Alternatively, there has been work to create universal ML models that determine a material\u2019s stability by predicting the formation energy of structures containing elements across the periodic table. Most notably, Xie et al.23 predicted formation energy using a crystal graph convolutional neural network (CGCNN) trained on the materials project (MP) database1. The CGCNN represents a crystal structure as a multi-graph and builds a graph convolutional neural network on top of the multi-graph. This enables the model to learn the best features to represent the structure as opposed to the typical handcrafted feature approach24 and achieve a formation energy validation MAE of 39 meV/atom23. More recently, the MAE of formation energy prediction of graph-based models continued to decrease to 21\u201339 meV/atom25\u201329. However, Park et al.28 found that the model\u2019s dependence on a structure\u2019s atomic coordinates hinders the model\u2019s predictive fidelity on structures that strongly deviate from their relaxed states. Given that to obtain a structure in a relaxed state, a DFT relaxation and hence energy calculation is needed, the reported MAEs do not represent the model\u2019s ability to accurately identify unrelaxed structures that would relax to stable structures. On an unseen test set of 311 stable ThCr2Si2-type compounds, the CGCNN obtained a reasonable formation energy MAE on relaxed structures of 56 meV/atom. However, the prediction MAE was 370meV/atom for the same test set on unrelaxed structures. This high error led to a true-positive rate (TPR) of 0.48 when filtering the unrelaxed compounds in the dataset28. Noh et al.29 directly addressed the high formation energy prediction MAE of unrelaxed structures by adding two forms of regularization to the CGCNN in their CGCNN-HD approach. Replacing the softplus activation function in the convolution function with a hyperbolic tangent and adding dropout layers30\n1Department of Materials Science and Engineering, University of Florida, Gainesville, FL 32611, USA. 2Quantum Theory Project, University of Florida, Gainesville, FL 32611, USA. \u2709email: jasongibson@ufl.edu; ajinkya.hire@ufl.edu; rhennig@ufl.edu\nwww.nature.com/npjcompumats\nPublished in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences\n1 2 3 4 5 6 7 8 9 0 () :,;\nbetween each fully connected layer, reduced the MAE of the formation energy for a test set of unrelaxed Mg-Mn-O compounds from 518meV/atom to 296meV/atom. The significant errors for unrelaxed structures are due to the limited sampling of the complex multi-dimensional configuration space of the potential energy surface (PES), with the relaxed structures only describing the minima of the surface. Since unrelaxed structures are not located at these minima, predicting a structure\u2019s formation energy at an unrelaxed configuration is a qualitatively different task31. To sample configurations near the minima of the PES, Smith et al.32 applied a data augmentation technique known as normal mode sampling to a large dataset of molecular structures, resulting in a high fidelity neural network potential. However, determining the normal modes requires millions of phonon calculations which, while attainable for molecular structures, is infeasible for crystal structures. Recently, Honrao et al.33 showed that GA data could be used to predict relaxed formation energies of unrelaxed structures to high accuracy. This high accuracy was achieved by augmenting the training dataset, setting the formation energy of every structure within a basin of attraction to the minima of the respective basin of attraction, essentially modeling the continuous PES as a step function. We propose leveraging these findings to improve formation energy prediction of unrelaxed structures by augmenting our data using a simple, physically motivated perturbation technique. Figure 1 illustrates our augmentation approach, which perturbs the atomic coordinates of a relaxed structure to generate additional training points that describe the regions surrounding the minima of the PES. We then map these perturbed structures to the energy of the relaxed structure, which requires no additional ab initio calculations. We utilize the CGCNN23 and CGCNN-HD29 to analyze how the augmentation affects formation energy predictions. We train these models on the MP database1 augmented by perturbed structures. The resulting CGCNN models have similar prediction errors as the original ones for relaxed structures. To show the improvement in formation energy prediction, we apply the models to a test set consisting of 623 unrelaxed Nb-Sr-H hydride structures produced from a GA structure search. We find that compared to training on only relaxed structures, training with the augmented dataset, consisting of relaxed and perturbed structures, reduced the formation energy prediction MAE from\n251meV/atom to 86meV/atom for CGCNN and from 172meV/ atom to 82meV/atom for CGCNN-HD, as compared to the models trained only on relaxed structure."
        },
        {
            "heading": "RESULTS Model performance",
            "text": "Figure 2 shows the training, validation, and test (test-relaxed/testunrelaxed) RMSE for each training epoch of the respective models. For interpretability, the trends are smoothed using an exponential moving average with a smoothing weight of 0.95. The Pearson correlation coefficients34, with a value of 1 for perfect correlation and -1 for perfect anti-correlation, are computed between smoothed RMSE trends of Test-Relaxed/Test-Unrelaxed, TestRelaxed/Validation, and Test-Unrelaxed/Validation. The Pearson correlation coefficients show that the CGCNN and CGCNN-HD trained on only relaxed structures (Fig. 2(a, b)) result in anti-correlated trends between predictions on the relaxed and unrelaxed structures of the test set. These findings demonstrate that accurate predictions on relaxed structures do not lead to accurate predictions on unrelaxed structures and provide insight into the high prediction error for unrelaxed structure inputs reported in the literature. Furthermore, the CGCNN and CGCNNHD trained on only relaxed structures display anti-correlated trends between the Test-Unrelaxed set and the validation set. This anti-correlation is detrimental to the model\u2019s predictive performance on unrelaxed structures because the validation error shows that predictions are improving and training should continue, while in actuality, unrelaxed structure predictions are getting worse. Additionally, the anti-correlation leads to an inability to correctly optimize a model\u2019s hyperparameters. Figure 2(c) and (d) illustrate the effectiveness of training with the augmented dataset. Simply perturbing the atomic coordinates of each relaxed structure and then training on both the relaxed and perturbed structures dramatically improves the models\u2019 predictive ability on unrelaxed structures. Both the CGCNN and CGCNN-HD trained on the augmented dataset show a high Pearson correlation between the RMSE of Test-Unrelaxed/Validation. While beyond the scope of this manuscript, it is worth noting the test curves displayed in Fig. 2(c) shows the double decent behavior described in et al.35. Since the models trained on only relaxed structures, validation RMSE was inversely correlated to the RMSE of Test-Unrelaxed; the validation results provide no insight into the model\u2019s predictive abilities on unrelaxed structures. The model can extrapolate to unrelaxed structures only when augmented structures are included in the training dataset. Further, since the validation dataset is also augmented when the training dataset is augmented, perturbed structures that are representative of unrelaxed structures are present in the validation dataset leading to a correlation between the RMSE of Test-Unrelaxed/Validation. Hence, the validation error provides information on the models\u2019 accuracy on unrelaxed structure predictions, allowing correct hyperparameter optimization. Figure 3 compares the models\u2019 formation energy predictions on Test-Unrelaxed to the DFT-computed formation energies. The CGCNN in Fig. 3(a) trained on only relaxed data tends to over predict Ef for the higher energy hydrides, which leads to a significant prediction MAE of 251 meV/atom. The added regularization applied to the CGCNN-HD in Fig. 3(b) improves the predictions on the higher energy hydrides. Still, the model tends to over predict Ef leading to an MAE of 172 meV/atom when training on relaxed. Training with the augmented dataset substantially improves the prediction MAEs for the CGCNN and CGCNN-HD, reducing the prediction MAE to 86meV/atom and 82meV/atom, respectively.\nnpj Computational Materials (2022) 211 Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences\n1 2 3 4 5 6 7 8 9 0 () :,;\nThis reduction in error improves the models ability to correctly identify low energy structures. Interestingly, while the CGCNN-HD trained on augmented data has the lowest testing MAE, the dense region of underpredicted formation energies seen in Fig. 3(d) leads to a substantial number of misidentified unstable structures, hindering the model\u2019s ability to filter unstable structures. This will be discussed further in the proceeding section. Owing to the large perturbations, some augmented structures may have moved to neighbor basins of attraction. Intuitively this would seem to yield substantial errors. However, as shown previously, the prediction of unrelaxed structures improved substantially. We suspect the error associated with perturbing a structure to a neighboring basin of attraction is mitigated due to the tendency of neighboring basins to cluster around similar minima on the PES36. Still, the large perturbations likely introduce some prediction error. A more sophisticated augmentation method could likely reduce the number of structures perturbed into neighboring basins and further improve predictions. Interestingly, the models trained on the augmented data also display improved predictions on Test-Relaxed (Supplementary Fig. 1). However, this improvement seems specific to our test data as predictions on the relaxed validation data were better when the model was trained only on relaxed structures (Supplementary Fig. 2). The CGCNN-HD trained on only relaxed structures underpredicted the structures in Test-Relaxed likely because the training data contains relatively few transition metal hydrides and the bounded hyperbolic activation function, utilized in the CGCNN-HD\u2019s convolutional layers, has poor predictive power on unseen domains37. This poor predictive power on unseen domains is also the reason the CGCNN-HD models make poor\npredictions on the high and low formation energy structures of the MP data. Further, it is the reason the CGCNN-HD seems to make better predictions on both Test-Relaxed and Test-Unrelaxed for the model trained on the augmented dataset (Fig. 2(d)) when compared to the training and validation set. This is confirmed when using MAE instead of the RMSE as the learning curve\u2019s loss function (Supplementary Fig. 3)."
        },
        {
            "heading": "Filtering unstable hydrides",
            "text": "To evaluate the models\u2019 ability to filter energetically unfavorable structures, we removed the MP database\u2019s correction applied to hydrogen-containing compounds and constructed a convex hull using the five known competing phases of the Nb-Sr-H system. Then, based on this constructed convex hull, we computed the hull distance EDFTHull of all the structures in the test set, utilizing their DFT-computed formation energy, and defined all structures with EDFTHull< \u00bc 0 as stable. As a result, ten structures in the test set met the stability criteria. To construct the receiver operating characteristic (ROC) curve, shown in Fig. 4 the predicted formation energies were used to compute hull distance (EMLHull). To compute a range of true positives, false positives, true negatives, and false negatives, we varied the stability criteria (EMLHull < \u00bd 200; 199; :::; 699; 700 meV/atom) of EMLHull over a range of hull distances that ensure a completed ROC curve. We defined a true positive as a stable structure predicted as stable, a false positive as an unstable structure predicted as stable, a true negative as an unstable structure predicted as unstable, and a false negative as a stable structure predicted as unstable. The ROC curve provides a graphical way to balance the models accuracy and computational cost. To demonstrate this we assume\nFig. 2 Learning curves. a The CGCNN trained on relaxed data, b the CGCNN-HD trained on relaxed data, c the CGCNN trained on augmented data, d the CGCNN-HD trained on augmented data on the relaxed (1st column) and augmented (2nd column) data. The faded curves show the exact loss values, while the solid curves show the smoothed values. The red and green curves denote the loss on the training and validation data, respectively. The orange and blue curves display the loss for the Test-Relaxed and Test-Unrelaxed test sets, respectively. Note that the Test-Relaxed and Test-Unrelaxed datasets were not used in the training or validation of the model. The r values are the Pearson correlation coefficients between the stated trends.\nPublished in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences npj Computational Materials (2022) 211\nour test data is randomly generated and consider two hypothetical cases in which the models may be utilized. Case 1 emulates a study where identifying all stable structures is desirable (TPR= 1.0). Case 2 emulates a study where missing some stable structures is acceptable (TPR= 0.7). For case 1, the CGCNN trained on the augmented data performed best, successfully identifying all stable structures at a filtration criterion of EMLHull < 39meV=atom while classifying 130 unstable structures as stable, yielding a 5-fold reduction in the number of energy calculations needed to identify all stable structures. For case 2, again, the CGCNN trained on the augmented data performed best, obtaining a TPR of 0.7 while only classifying 54 unstable structures as stable with a filtration criterion of EMLHull < 6meV=atom. The performance of all the models is summarized in Table 1, models trained on only relaxed structures required a higher EMLHull and had substantially more FP compared to models trained on the augmented dataset. The naive approach of setting the stability criteria to be the same for EMLHull and E DFT Hull, restricts the ability to select a balance of accuracy and computational cost. For example, at stability criteria\nof EMLHull < 0, the CGCNN trained with the augmented dataset obtained a TPR of 0.6, classifying 47 unstable structures as stable. While this performance is acceptable, as shown previously, at stability criteria of EMLHull < 39meV=atom the model can correctly identify all stable structures, which may be more desirable for a given application."
        },
        {
            "heading": "DISCUSSION",
            "text": "We proposed a simple, physically motivated, computationally efficient perturbation technique that augmented our data to represent the PES better, dramatically improving unrelaxed structure formation energy predictions. To augment our dataset, we add a perturbed structure for every relaxed structure and map it to the same energy as the relaxed structure. Thus, representing an additional point for a given basin of attraction of the energy landscape. Compared to training on only relaxed structures, training with an augmented dataset consisting of one relaxed and one perturbed structure for every relaxed structure, prediction MAEs of the CGCNN and CGCNN-HD were reduced from 251meV/\nFig. 3 Comparison of target and predicted energies of the test set of unrelaxed structures. a The CGCNN trained on relaxed data, b the CGCNN-HD trained on relaxed data, c the CGCNN trained on augmented data, d the CGCNN-HD trained on augmented data. The x-axis denotes the DFT-computed formation energies, while the y-axis denotes the predicted formation energies of the Test-Unrelaxed set. The values reported in the lower right are the coefficient of determination, R2, the MAE, and the RMSE.\nnpj Computational Materials (2022) 211 Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences\natom and 172meV/atom to 86meV/atom and 82meV/atom, respectively. Further, we showed that formation energy predictions for relaxed structures inputs were anti-correlated to predictions for unrelaxed structures inputs when training on only relaxed structures while training on the augmented data correlated relaxed and unrelaxed predictions RMSE. Finally, we utilize a ROC curve to show two cases where our method may be useful in accelerating CSPA. While more advanced augmentation techniques likely exist, this work showed the surprising effectiveness of a relatively simple method of augmentations that outperformed the current state of the art in formation energy prediction of unrelaxed structures."
        },
        {
            "heading": "METHODS Data augmentation",
            "text": "For training, we use two datasets derived from the MP database1 accessed on December 10, 2021. The 1st dataset, referred to as the relaxed dataset, consists of 126 k relaxed structures from the MP\ndatabase, 20% of this data is held out for validation. The 2nd dataset, referred to as the augmented dataset, consists of the relaxed set and one perturbed structure for every relaxed structure. We augment the data by perturbing the coordinates, Ri of all atoms, i, in each relaxed structures using a displacement vector\n\u0394Ri \u00bc \u00f0Mxi ;Myi ;Mzi \u00de (1) where each Cartesian component is obtained by multiplying a direction vector, randomly sampled from a unit sphere with a scalar value randomly sampled from the displacement distribution. The displacement distribution was determined by analyzing the displacements of atoms during relaxation in three separate GA structure searches. The distance was determined by first taking the difference between the initial and final structure\u2019s fractional coordinates using the minimum image convention38. These differences were then multiplied by the lattice vector matrix of the relaxed structure to obtain the cartesian displacement vector and the euclidean norm for this vector. Figure 5 shows the resulting distribution of displacements, which was then fitted to a Gaussian mixture model (GMM) as implemented in the open python library scikit-learn39. The value of Mi was then selected by randomly sampling the GMM. Information about the change in lattice vectors and volume can be found in Supplementary Fig. 4.\nPublished in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences npj Computational Materials (2022) 211"
        },
        {
            "heading": "Training",
            "text": "The CGCNN and CGCNN-HD are trained on both the relaxed and augmented data. The model\u2019s architecture was determined by performing a grid search on the CGCNN trained on the augmented data. Supplementary Table 2 provides the range of parameters considered in the grid search. The architecture that minimized the validation error consists of 3-graph convolutional layers followed by 6-hidden layers with 64 neurons each. This architecture was then used for all models. Interestingly while past works40 have found the CGCNN can scale up to 25 graph convolutional layers we found that models with more than eight hidden layers suffered from the vanishing gradient problem41 when training on the relaxed data while training on the augmented data allowed for deeper models. we speculate the models\u2019 ability to scale with the number of graph convolutional layers and not the number of hidden layers is a product of the graph convolutional layers containing batch normalization. The remaining model hyperparameters are set to the values reported in ref. 23 for CGCNN and ref. 29 for the CGCNN-HD."
        },
        {
            "heading": "Test data",
            "text": "To provide test data for our models, we performed a GA search over the ternary system formed by H2-Sr6NbH16-Nb6SrH16. We used the Genetic Algorithm for Structure and Phase Prediction (GASP) python package42,43 for performing the GA search. Our aim with the search was to produce high hydrogens-containing structures that might show superconductivity. We remove the elemental hydrogen structures and partitioned this data into two test sets consisting of the relaxed and unrelaxed hydrides, referred to as Test-Relaxed and, Test-Unrelaxed respectively. Additionally. since the MP database contains few hydride structures, this data provides a challenging test case. To relax and evaluate the energies of the candidate structures generated by GASP, we use VASP44\u201347 with the projector augmented wave method48 and the Perdew-Burke-Ernzerhof (PBE) generalized gradient approximation for the exchangecorrelation functional49. We use a k-point density of 40 per inverse \u212b with the Methfessel-Paxton scheme and a smearing of 100meV for the Brillouin zone integration, and a cutoff energy of 250 eV for the plane-wave basis set. The GA search was terminated after 771 DFT relaxations. We recomputed all energies using the\nVASP inputs generated by the MPRelaxset class of pymatgen to ensure consistency between the training and test sets and computed the formation energies50. Figure 6 shows the ternary convex hull of the Nb-Sr-H system produced using the GAgenerated structure and the known competing phases from the MP database. Noteworthy, our structure search found previously unreported, thermodynamically stable ternary hydride, Sr2NbH9. Preliminary analysis of Sr2NbH9 suggest that the band gap closes at around 100 GPa."
        },
        {
            "heading": "DATA AVAILABILITY",
            "text": "Data will be made available upon reasonable requests."
        },
        {
            "heading": "CODE AVAILABILITY",
            "text": "Code for implementing the model on both cpus and gpus, training the models, augmenting training data are available at https://github.com/JasonGibsonUfl/ Augmented_CGCNN.\nReceived: 27 April 2022; Accepted: 7 September 2022;"
        },
        {
            "heading": "ACKNOWLEDGEMENTS",
            "text": "This work was supported by the National Science Foundation under grants Nos. PHY1549132, the Center for Bright Beams, and the software fellowship awarded to J.B.G. by the Molecular Sciences Software Institute funded by the National Science Foundation (Grant No. ACI-1547580). Computational resources were provided by the University of Florida Research Computing Center."
        },
        {
            "heading": "AUTHOR CONTRIBUTIONS",
            "text": "J.B.G. and R.G.H. conceived the Augmentation technique and training strategy. J.B.G. implemented the Augmentation technique and performed the model training and analysis. ACH performed the genetic algorithm structure search to provide testing data. J.B.G., A.C.H., and R.G.H. contributed to the writing of the manuscript.\nCOMPETING INTERESTS The authors declare no competing interests.\nADDITIONAL INFORMATION Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41524-022-00891-8.\nCorrespondence and requests for materials should be addressed to Jason Gibson, Ajinkya Hire or Richard G. Hennig.\nReprints and permission information is available at http://www.nature.com/ reprints\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing,\nadaptation, distribution and reproduction in anymedium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http:// creativecommons.org/licenses/by/4.0/.\nThis is a U.S. Government work and not under copyright protection in the US; foreign copyright protection may apply 2022\nPublished in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences npj Computational Materials (2022) 211"
        }
    ],
    "title": "Data-augmentation for graph neural network learning of the relaxed energies of unrelaxed structures",
    "year": 2022
}