{
    "abstractText": "Gaussian boson sampling (GBS) has the potential to solve complex graph problems, such as clique finding, which is relevant to drug discovery tasks. However, realizing the full benefits of quantum enhancements requires large-scale quantum hardware with universal programmability. Here we have developed a time-bin-encoded GBS photonic quantum processor that is universal, programmable and software-scalable. Our processor features freely adjustable squeezing parameters and can implement arbitrary unitary operations with a programmable interferometer. Leveraging our processor, we successfully executed clique finding on a 32-node graph, achieving approximately twice the success probability compared to classical sampling. As proof of concept, we implemented a versatile quantum drug discovery platform using this GBS processor, enabling molecular docking and RNA-folding prediction tasks. Our work achieves GBS circuitry with its universal and programmable architecture, advancing GBS toward use in real-world applications.",
    "authors": [
        {
            "affiliations": [],
            "name": "Shang Yu"
        },
        {
            "affiliations": [],
            "name": "Zhi-Peng Zhong"
        },
        {
            "affiliations": [],
            "name": "Yuhua Fang"
        },
        {
            "affiliations": [],
            "name": "Raj B. Patel"
        },
        {
            "affiliations": [],
            "name": "Qing-Peng Li"
        },
        {
            "affiliations": [],
            "name": "Wei Liu"
        },
        {
            "affiliations": [],
            "name": "Zhenghao Li"
        },
        {
            "affiliations": [],
            "name": "Liang Xu"
        },
        {
            "affiliations": [],
            "name": "Steven Sagona-Stophel"
        },
        {
            "affiliations": [],
            "name": "Wen-Hao Zhang"
        },
        {
            "affiliations": [],
            "name": "Geoffrey K. Tranmer"
        },
        {
            "affiliations": [],
            "name": "Ying Dong"
        },
        {
            "affiliations": [],
            "name": "Guang-Can Guo"
        }
    ],
    "id": "SP:4e5057b1d0be5b6d670188b97fd68a0503d2b083",
    "references": [
        {
            "authors": [
                "Spring",
                "B. J"
            ],
            "title": "Boson sampling on a photonic chip",
            "venue": "Science 339,",
            "year": 2013
        },
        {
            "authors": [
                "R Barends"
            ],
            "title": "Digitized adiabatic quantum computing with a superconducting circuit",
            "venue": "Nature 534,",
            "year": 2016
        },
        {
            "authors": [
                "M Mohseni"
            ],
            "title": "Commercialize quantum technologies in five years",
            "venue": "Nature 543,",
            "year": 2017
        },
        {
            "authors": [
                "F Arute"
            ],
            "title": "Quantum supremacy using a programmable superconducting processor",
            "venue": "Nature 574,",
            "year": 2019
        },
        {
            "authors": [
                "Zhong",
                "H.-S"
            ],
            "title": "Quantum computational advantage using photons",
            "venue": "Science 370,",
            "year": 2020
        },
        {
            "authors": [
                "Arrazola",
                "J. M"
            ],
            "title": "Quantum circuits with many photons on a programmable nanophotonic chip",
            "venue": "Nature 591,",
            "year": 2021
        },
        {
            "authors": [
                "Madsen",
                "L. S"
            ],
            "title": "Quantum computational advantage with programmable photonic processor",
            "venue": "Nature 606,",
            "year": 2022
        },
        {
            "authors": [
                "J Zhang"
            ],
            "title": "Observation of a many-body dynamical phase transition with a 53-qubit quantum simulator",
            "venue": "Nature 551,",
            "year": 2017
        },
        {
            "authors": [
                "H Bernien"
            ],
            "title": "Probing many-body dynamics on a 51-atom quantum simulator",
            "venue": "Nature 551,",
            "year": 2017
        },
        {
            "authors": [
                "M Tillmann"
            ],
            "title": "Experimental boson sampling",
            "venue": "Nature Photon",
            "year": 2013
        },
        {
            "authors": [
                "Brod",
                "D.J. et al. Photonic implementation of boson sampling"
            ],
            "title": "a review",
            "venue": "Adv. Photon. 1, 034001",
            "year": 2019
        },
        {
            "authors": [
                "Lund",
                "A. P"
            ],
            "title": "Boson sampling from a Gaussian state",
            "venue": "Phys. Rev. Lett. 113,",
            "year": 2014
        },
        {
            "authors": [
                "H Wang"
            ],
            "title": "High-efficiency multiphoton boson sampling",
            "venue": "Nat. Photonics",
            "year": 2017
        },
        {
            "authors": [
                "Hamilton",
                "C. S"
            ],
            "title": "Gaussian boson sampling",
            "venue": "Phys. Rev. Lett. 119,",
            "year": 2017
        },
        {
            "authors": [
                "J.M. Arrazola",
                "T.R. Bromley"
            ],
            "title": "Using Gaussian boson sampling to find dense subgraphs",
            "venue": "Phys. Rev. Lett. 121,",
            "year": 2018
        },
        {
            "authors": [
                "S. Sempere-Llagostera",
                "R.B. Patel",
                "I.A. Walmsley",
                "W.S. Kolthammer"
            ],
            "title": "Experimentally finding dense subgraphs using a time-bin encoded Gaussian boson sampling device",
            "venue": "Phys. Rev. X 12,",
            "year": 2022
        },
        {
            "authors": [
                "J. Huh",
                "G.G. Guerreschi",
                "B. Peropadre",
                "J.R. McClean",
                "A. Aspuru-Guzik"
            ],
            "title": "Boson sampling for molecular vibronic spectra",
            "venue": "Nature Photon",
            "year": 2015
        },
        {
            "authors": [
                "L. Banchi",
                "M. Fingerhuth",
                "T. Babej",
                "C. Ing",
                "J.M. Arrazola"
            ],
            "title": "Molecular docking with Gaussian boson sampling",
            "venue": "Science Advances",
            "year": 1950
        },
        {
            "authors": [
                "K.R. Motes",
                "A. Gilchrist",
                "J.P. Dowling",
                "P.P. Rohde"
            ],
            "title": "Scalable boson sampling with time-bin encoding using a loop-based architecture",
            "venue": "Phys. Rev. Lett. 113,",
            "year": 2014
        },
        {
            "authors": [
                "Y He"
            ],
            "title": "Time-bin-encoded boson sampling with a singlephoton device",
            "venue": "Phys. Rev. Lett. 118,",
            "year": 2017
        },
        {
            "authors": [
                "A Deshpande"
            ],
            "title": "Quantum computational advantage via high-dimensional Gaussian boson sampling",
            "venue": "Sci. Adv. 8,",
            "year": 2022
        },
        {
            "authors": [
                "H. Qi",
                "L.G. Helt",
                "D. Su",
                "Z. Vernon",
                "Br\u00e1dler",
                "K. Linear multiport photonic interferometers"
            ],
            "title": "loss analysis of temporally-encoded architectures",
            "venue": "Preprint at https://arxiv.org/abs/1812.07015",
            "year": 2018
        },
        {
            "authors": [
                "Plummer",
                "M.D. Well-covered graphs"
            ],
            "title": "a survey",
            "venue": "Quaest. Math. 16, 253\u2013287",
            "year": 1993
        },
        {
            "authors": [
                "K. Br\u00e1dler",
                "Dallaire-Demers",
                "P.-L",
                "P. Rebentrost",
                "D. Su",
                "C. Weedbrook"
            ],
            "title": "Gaussian boson sampling for perfect matchings of arbitrary graphs",
            "venue": "Phys. Rev. A 98,",
            "year": 2018
        },
        {
            "authors": [
                "R.M. Karp"
            ],
            "title": "Reducibility among combinatorial problems. in Complexity of Computer Computations",
            "venue": "The IBM Research Symposia Series (eds. Miller, R. E. et al.)",
            "year": 1972
        },
        {
            "authors": [
                "M. Tang",
                "K. Hwang",
                "Kang",
                "S.H. StemP"
            ],
            "title": "a fast and deterministic stem-graph approach for RNA secondary structure prediction",
            "venue": "IEEE/ACM Trans. Comput. Biol. Bioinform. https://doi.org/10.1109/ TCBB.2023.3253049",
            "year": 2023
        },
        {
            "authors": [
                "A. Eckstein",
                "A. Christ",
                "P.J. Mosley",
                "C. Silberhorn"
            ],
            "title": "Highly efficient single-pass source of pulsed single-mode twin beams of light",
            "venue": "Phys. Rev. Lett. 106,",
            "year": 2011
        },
        {
            "authors": [
                "G Harder"
            ],
            "title": "Single-mode parametric-down-conversion states with 50 photons as a source for mesoscopic quantum optics",
            "venue": "Phys. Rev. Lett. 116,",
            "year": 2016
        },
        {
            "authors": [
                "B.A. Bell",
                "G.S. Thekkadath",
                "R. Ge",
                "X. Cai",
                "I.A. Walmsley"
            ],
            "title": "Testing multi-photon interference on a silicon chip",
            "venue": "Opt. Express",
            "year": 2019
        },
        {
            "authors": [
                "W.R. Clements",
                "P.C. Humphreys",
                "B.J. Metcalf",
                "W.S. Kolthammer",
                "I.A. Walmsley"
            ],
            "title": "Optimal design for universal multiport interferometers",
            "venue": "Optica 12,",
            "year": 2016
        },
        {
            "authors": [
                "K.R. Motes",
                "J.P. Dowling",
                "A. Gilchrist",
                "P.P. Rohde"
            ],
            "title": "Simple scheme for universal linear-optics quantum computing with constant experimental complexity using fiber loops",
            "venue": "Phys. Rev. A",
            "year": 2015
        },
        {
            "authors": [
                "N Spagnolo"
            ],
            "title": "Experimental validation of photonic boson sampling",
            "venue": "Nature Photon",
            "year": 2015
        },
        {
            "authors": [
                "F.S. Kuhl",
                "G.M. Crippen",
                "D.K. Friesen"
            ],
            "title": "A combinatorial algorithm for calculating ligand binding",
            "venue": "J. Comput. Chem",
            "year": 1984
        },
        {
            "authors": [
                "C Powell"
            ],
            "title": "Pre-clinical and clinical evaluation of PARP inhibitors as tumour-specific radiosensitisers",
            "venue": "Cancer Treat. Rev",
            "year": 2010
        },
        {
            "authors": [
                "Lu",
                "Y. et al. Double-barreled gun"
            ],
            "title": "combination of PARP inhibitor with conventional chemotherapy",
            "venue": "Pharmacol. Therapeut. 188, 168\u2013175",
            "year": 2018
        },
        {
            "authors": [
                "S. Tangutoori",
                "P. Baldwin",
                "Sridhar",
                "S. PARP inhibitors"
            ],
            "title": "a new era of targeted therapy",
            "venue": "Maturitas 81, 5\u20139",
            "year": 2015
        },
        {
            "authors": [
                "A.L. Olsen",
                "M.B. Feany"
            ],
            "title": "PARP inhibitors and Parkinson\u2019s disease",
            "venue": "New Engl. J. Med",
            "year": 2019
        },
        {
            "authors": [
                "S. Martire",
                "L. Mosca",
                "d\u2019Erme",
                "M. PARP-1 involvement in neurodegeneration"
            ],
            "title": "a focus on Alzheimer\u2019s and Parkinson\u2019s diseases",
            "venue": "Mech. Ageing Dev. 146, 53\u201364",
            "year": 2015
        },
        {
            "authors": [
                "Levin",
                "J.I. et al. Acetylenic TACE inhibitors. Part 3"
            ],
            "title": "thiomorpholine sulfonamide hydroxamates",
            "venue": "Bioorg. Med. Chem. Lett. 16, 1605\u20131609",
            "year": 2006
        },
        {
            "authors": [
                "M Chemaly"
            ],
            "title": "Role of tumour necrosis factor alpha converting enzyme (TACE/ADAM17) and associated proteins in coronary artery disease and cardiac events",
            "venue": "Arch. Cardiovas",
            "year": 2017
        },
        {
            "authors": [
                "Johannes",
                "J.W. et al. Discovery of 5-4-[(7-ethyl-6-oxo-5",
                "6-dihydro-1",
                "5-naphthyridin-3-yl) methyl] piperazin-1-yl-Nmethylpyridine-2-carboxamide (AZD5305"
            ],
            "title": "a PARP1-DNA trapper with high selectivity for PARP1 over PARP2 and other PARPs",
            "venue": "J. Med. Chem. 64, 14498\u201314512",
            "year": 2021
        },
        {
            "authors": [
                "H. Berman",
                "K. Henrick",
                "H. Nakamura"
            ],
            "title": "Announcing the worldwide protein data bank",
            "venue": "Nat. Struct. Mol. Biol",
            "year": 2003
        },
        {
            "authors": [
                "R Santos"
            ],
            "title": "A comprehensive map of molecular drug targets",
            "venue": "Nat. Rev. Drug Discov. 16,",
            "year": 2017
        },
        {
            "authors": [
                "Townshend",
                "R.J. L"
            ],
            "title": "Geometric deep learning of RNA structure",
            "venue": "Science 373,",
            "year": 2021
        },
        {
            "authors": [
                "J Jumper"
            ],
            "title": "Highly accurate protein structure prediction with AlphaFold",
            "venue": "Nature 596,",
            "year": 2021
        },
        {
            "authors": [
                "Emani",
                "P. S"
            ],
            "title": "Quantum computing at the frontiers of biological sciences",
            "venue": "Nat. Methods",
            "year": 2021
        },
        {
            "authors": [
                "T Zaborniak"
            ],
            "title": "A QUBO model of the RNA folding problem optimized by variational hybrid quantum annealing",
            "venue": "IEEE International Conference on Quantum Computing and Engineering (QCE)",
            "year": 2022
        },
        {
            "authors": [
                "Wirecki",
                "T.K. et al. RNAProbe"
            ],
            "title": "a web server for normalization and analysis of RNA structure probing data",
            "venue": "Nucleic Acids Res. 48, 292\u2013299",
            "year": 2020
        },
        {
            "authors": [
                "C. Oh",
                "Y. Lim",
                "Y. Wong",
                "B. Fefferman",
                "L. Jiang"
            ],
            "title": "Quantuminspired classical algorithm for molecular vibronic spectra",
            "year": 2022
        },
        {
            "authors": [
                "R Kruse"
            ],
            "title": "Detailed study of Gaussian boson sampling",
            "venue": "Phys. Rev. A 100,",
            "year": 2019
        },
        {
            "authors": [
                "P.S. Kharkar",
                "S. Warrier",
                "Gaud",
                "R.S. Reverse docking"
            ],
            "title": "a powerful tool for drug repositioning and drug rescue",
            "venue": "Future Med. Chem. 6, 333\u2013342",
            "year": 2014
        },
        {
            "authors": [
                "B. Bhattacharjee",
                "J. Chatterjee"
            ],
            "title": "Identification of proapoptopic, anti-inflammatory, anti-proliferative, anti-invasive and antiangiogenic targets of essential oils in cardamom by dual reverse virtual screening and binding pose analysis",
            "venue": "Asian Pac. J. Cancer P",
            "year": 2013
        },
        {
            "authors": [
                "Carvalho",
                "D. et al. Structural evidence of quercetin multi-target bioactivity"
            ],
            "title": "a reverse virtual screening strategy",
            "venue": "Eur. J. Pharm. Sci. 106, 393\u2013403",
            "year": 2017
        },
        {
            "authors": [
                "R. Dias",
                "W.F. de Azevedo Jr."
            ],
            "title": "Molecular docking algorithms",
            "venue": "Curr. Drug Targets",
            "year": 2008
        },
        {
            "authors": [
                "D. Rognan"
            ],
            "title": "Structure-based approaches to target fishing and ligand profiling",
            "venue": "Mol. Inform. 29,",
            "year": 2010
        },
        {
            "authors": [
                "Koutsoukas",
                "A. et al. From in silico target prediction to multitarget drug design"
            ],
            "title": "current database, methods, and application",
            "venue": "J. Proteomics 74, 2554\u20132574",
            "year": 2011
        },
        {
            "authors": [
                "Killoran",
                "N. et al. Strawberry Fields"
            ],
            "title": "a software platform for photonic quantum computing",
            "venue": "Quantum 3, 129",
            "year": 2019
        },
        {
            "authors": [
                "B Sun"
            ],
            "title": "On-chip beam rotators, polarizers and adiabatic mode converters through low-loss waveguides with variable cross-sections",
            "venue": "Light Sci. Appl. 11,",
            "year": 2022
        },
        {
            "authors": [
                "Y. Enomoto",
                "K. Yonezu",
                "Y. Mitsuhashi",
                "K. Takase",
                "S. Takeda"
            ],
            "title": "Programmable and sequential Gaussian gates in a loop-based single-mode photonic quantum processor",
            "venue": "Sci. Adv. 7,",
            "year": 2021
        },
        {
            "authors": [
                "K. Irwin"
            ],
            "title": "An application of electrothermal feedback for high resolution cryogenic particle detection",
            "venue": "Appl. Phys. Lett",
            "year": 1995
        },
        {
            "authors": [
                "C. Kumar",
                "P.T.V. Lakshmi",
                "A. Arunachalam"
            ],
            "title": "Structure based pharmacophore study to identify possible natural selective PARP1 trapper as anti-cancer agent",
            "venue": "Comput. Biol. Chem",
            "year": 2019
        },
        {
            "authors": [
                "L Zandarashvili"
            ],
            "title": "Structural basis for allosteric PARP-1 retention on DNA breaks",
            "venue": "Science 368,",
            "year": 2020
        },
        {
            "authors": [
                "S Yu"
            ],
            "title": "Data for the paper titled \u2018A universal programmable Gaussian boson sampler for drug discovery",
            "venue": "Zenodo https://doi",
            "year": 2023
        }
    ],
    "sections": [
        {
            "text": "Nature Computational Science | Volume 3 | October 2023 | 839\u2013848 839\nnature computational science\nhttps://doi.org/10.1038/s43588-023-00526-yBrief Communication"
        },
        {
            "heading": "A universal programmable Gaussian boson",
            "text": "sampler for drug discovery\nShang Yu 1,2,3,4,7 , Zhi-Peng Zhong1,7, Yuhua Fang5,7, Raj B. Patel 2 , Qing-Peng Li1, Wei Liu3,4, Zhenghao Li2, Liang Xu1, Steven Sagona-Stophel 2, Ewan Mer2, Sarah E. Thomas 2, Yu Meng3,4, Zhi-Peng Li3,4, Yuan-Ze Yang3,4, Zhao-An Wang3,4, Nai-Jie Guo3,4, Wen-Hao Zhang3,4, Geoffrey K. Tranmer5, Ying Dong 1, Yi-Tao Wang3,4 , Jian-Shun Tang 3,4,6 , Chuan-Feng Li 3,4,6 , Ian A. Walmsley 2 & Guang-Can Guo3,4,6\nGaussian boson sampling (GBS) has the potential to solve complex graph problems, such as clique finding, which is relevant to drug discovery tasks. However, realizing the full benefits of quantum enhancements requires large-scale quantum hardware with universal programmability. Here we have developed a time-bin-encoded GBS photonic quantum processor that is universal, programmable and software-scalable. Our processor features freely adjustable squeezing parameters and can implement arbitrary unitary operations with a programmable interferometer. Leveraging our processor, we successfully executed clique finding on a 32-node graph, achieving approximately twice the success probability compared to classical sampling. As proof of concept, we implemented a versatile quantum drug discovery platform using this GBS processor, enabling molecular docking and RNA-folding prediction tasks. Our work achieves GBS circuitry with its universal and programmable architecture, advancing GBS toward use in real-world applications.\nQuantum computing technology has developed rapidly in recent years1\u20137, and an exponential \u2018speed-up\u2019 compared to classical methods has been experimentally demonstrated for certain algorithms4,5,7\u20139. Quantum sampling tasks, like boson sampling10\u201312, have proven to be challenging to solve within a reasonable time frame on classical computers, but can be implemented and solved efficiently on photonic processors1,13. As a variant of boson sampling, Gaussian boson sampling (GBS)14 uses squeezed light to encode and carry the input states, making the method easier to scale. The method shows great capacity to demonstrate quantum advantage in optical systems5,7. The prospect of achieving quantum advantage has motivated the discovery of several real-world applications, such as dense graph searching15,16, molecular vibronic spectra calculations6,17 and molecular docking18. For these tasks, a GBS device should be programmable and scalable to a large number of modes5,6; however, achieving such capability is a challenging task16 due to the experimental complexity involved in preparing the large number of individually addressable input states and phase-shifters necessary to achieve universal programmability5,6. Time-bin encoding of Gaussian states is an effective means of achieving scale and programmability7,16,19\u201321. First, it is resource efficient because only one squeezed source and one detector are required16.\nReceived: 16 December 2022\nAccepted: 1 September 2023"
        },
        {
            "heading": "Published online: 12 October 2023",
            "text": "Check for updates\n1Research Center for Quantum Sensing, Zhejiang Lab, Hangzhou, People\u2019s Republic of China. 2Quantum Optics and Laser Science, Blackett Laboratory, Imperial College London, London, UK. 3CAS Key Laboratory of Quantum Information, University of Science and Technology of China, Hefei, China. 4CAS Center For Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Hefei, China. 5College of Pharmacy, Rady Faculty of Health Sciences, University of Manitoba, Winnipeg, Manitoba, Canada. 6Hefei National Laboratory, University of Science and Technology of China, Hefei, China. 7These authors contributed equally: Shang Yu, Zhi-Peng Zhong, Yuhua Fang. e-mail: shang.yu@imperial.ac.uk; raj.patel1@imperial.ac.uk; yitao@ustc.edu.cn; tjs@ustc.edu.cn; cfli@ustc.edu.cn\nNature Computational Science | Volume 3 | October 2023 | 839\u2013848 840\nSpatial light modulator\n(1) Squeezed-state\npreparation\n(4) Detector\nTDC\nM od\nelo\nck ed\nla se\nr\npp KT P w av eg\nui de\nEOM0\nEOM2 EOM1\nEOMa EOMb\nAcoustic-optic modulator\nSpatial reshaper\nTo detector From QPU\nSN SPD\ns\nTrigger signal\nPBS HWP Mirror Lens\nRAP CL Coupler\nFilterGratingBS\nRF\n~7.5 m delay line\n(2) QPU\n(3) QuSAM\nGraph\nDecomposition Unitary\noperation U\nSqueezing parameters ri\nSignal send to EOM0\nSignal send to EOM0\nObjective lens\n1\n2\n3\n4\n5 6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17 18\n19\n20\n21\n22 23\n24\n25\n26\n27\n28\n29\n30\n31 32\na\nd\nWeight of six-node cliques\n0.15\n0.10\n0.05\n0\nPr ob\nab ili\ntie s\n7.957.587.216.846.696.576.325.83\nEncoding graphs into GBS\nSignal send to\nEOM1 and EOM2\n= \u03b1 + \u03b2I\nd, Finding the maximum weighted clique in a 32-node graph. The probabilities of the six-node cliques in the graph \ud835\udca2\ud835\udca232 are shown at the bottom with box-andwhisker plots. The corresponding graph is shown above; the labels beside the nodes denote the corresponding order and the weight of the nodes is represented by their size. The statistics are calculated from ten individual experiments, each with around 300 samples. The wide blue boxes of varying shades, and the red box, symbolize the GBS experimental results. The lower and upper limits of the \u2018whisker\u2019 denote the minimum and maximum values (excluding outliers), respectively; and the horizontal black (or white) lines inside the boxes indicate the median value. The shaded regions denote the cliques identified through GBS results, with the red-shaded regions representing the maximum weighted cliques. The classical uniform sampling results are portrayed by slim yellow boxes of varying shades. In a few cases, outlier data are displayed as circles that match the color of the corresponding box. The diagram shows that the GBS machine can identify the maximum weighted clique with a higher success rate.\nNature Computational Science | Volume 3 | October 2023 | 839\u2013848 841\nSecond, time-bin operation provides phase stability and exhibits losses comparable with other approaches22. Time-bin interferometers show flexibility in reconfiguration because they can realize arbitrarydimension linear transformations with the same setup. Recently, quantum computational advantage has been demonstrated with a programmable time-bin-encoded GBS machine7, though in that research, universality was sacrificed to avoid the accumulation of loss.\nThis prompts us to consider a universal and programmable time-bin GBS machine that can fulfill various practical tasks. The GBS algorithm can potentially be applied to many important problems and enhance their solution, for example, the complete subgraph (clique) finding task23,24. Some structure-based drug design methods, like molecular docking or protein folding prediction, can be interpreted as equivalent to the problem of finding the maximum weighted clique in their corresponding graph models18,25,26. Hence, a universal, programmable, GBS machine equipped with freely adjustable squeezers and interferometer can be utilized for these tasks and extend the range of practical applications based on graph theory. Inspired by this prospect, in this work we built a scalable, universal and programmable time-bin GBS machine, making a stride toward using GBS in drug discovery applications."
        },
        {
            "heading": "Results",
            "text": "Programmable GBS machine and sampling results The GBS machine, named \u2018Abacus\u2019, comprises four primary components: a tunable squeezed-state source for precise light state control27\u201330; a quantum processing unit based on the architecture of Clements et al.31 that ensures stable, programmable quantum information processing32; a quantum sequential access memory with a 180-meter optical fiber designed for efficient data storage and cyclic operations; and a detection module featuring superconducting nano wire single-photon detectors (SNSPDs) for collision-free photon measurements. Further details are provided in the Methods section \u2018Details about the programmable GBS machine\u2019, as well as in Supplementary Information Sections 1 and 2.\nAs illustrated in Fig. 1a, this time-bin-encoded GBS machine enables us to expand the number of modes arbitrarily and freely set the required squeezing parameters, denoted as ri, and linear transformation matrix for the tasks with a series of electro-optic modulators (EOMs). Thus, this universal and programmable architecture supports the running of arbitrary GBS circuits on this machine. As a concrete example, benefitting from these features, the adjacency matrix \ud835\udc9c\ud835\udc9c of a graph \ud835\udca2\ud835\udca2 can be encoded into this GBS machine by decomposing \u2112(\ud835\udc9c\ud835\udc9c\ud835\udc9c (Laplacian of the adjacency matrix of graph \ud835\udca2\ud835\udca2) after a suitable re-scaling, as shown in the inset of Fig. 1a.\nThe validation of Abacus is demonstrated by the sampling results from running two random GBS circuits with different dimensions. The normalized photon sampling distribution probabilities are shown in Fig. 1b,c. In Fig. 1b, a 32-mode random interferometer is chosen, and only four squeezers are turned on, with r1\u22123,32 = 2.23. The statistical\nresults of all two-photon detection events are plotted, and the total variation distance between experimental and theoretical results is 0.054. Similarly, the four-photon distribution pattern is shown in Fig. 1c, conducted on a 16-mode GBS with all 16 squeezers turned on and rmax = 1.8 (here, the total variation distance is 0.175). We also use the modified likelihood ratio test introduced in ref. 33 to exclude the thermal state and distinguishable photon hypotheses; these details can be found in Supplementary Information Section 2G. These results show that Abacus can perform the sampling tasks with high fidelity.\nFinding the maximum weighted clique with GBS Not only can GBS be used to demonstrate quantum advantage in the laboratory5,7 as a near-term specific-function quantum computer, it can also be used in solving certain problems in real-world applications. Here, we use Abacus to solve max clique decision problems, which are NP-hard (non-deterministic polynomial time) problems in graph theory and play a crucial role in many applications25.\nClique refers to all the maximal complete subgraphs in a graph \ud835\udca2\ud835\udca2; the clique-finding problem has a complexity which scales exponentially with the number of nodes. Here, we use Abacus to find the maximum weighted clique in a graph. A 32-node weighted graph \ud835\udca2\ud835\udca232 is artificially constructed here (details are shown in Supplementary Information Sections 3 and 4), and the essential step is encoding \ud835\udca2\ud835\udca232 onto our GBS machine. Using the method introduced in refs. 18,24, we perform Takagi\u2013Autonne decomposition to the Laplacian of graph \ud835\udca2\ud835\udca232, with appropriate re-scaling, and obtain the unitary operation U and the squeezing parameters ri, which are required to be programmed on the GBS (Methods). Then, we control the acoustic-optical modulator chopper with an arbitrary waveform generator to pump the periodically polled potassium titanyl phosphate (ppKTP) waveguide with 32 sequential pulses. EOM0 is used to adjust ri for each time bin, and U, the unitary operation, is achieved by adjusting the input voltages of EOM1 and EOM2 in the time-bin interferometer. After mapping \ud835\udca2\ud835\udca232 onto Abacus, around 300 five (or more)-photon sampling results are collected in each experiment. Using these sampling data, we can find the cliques with nodes corresponding to the 30-time postprocessed sampling results (see details in Methods). Figure 1d displays all six-node cliques and their corresponding probabilities. The maximum weighted clique stands out as the most probable among them. In comparison to classical sampling with the same postprocessing iterations, GBS demonstrates a substantially higher probability of successfully finding the maximum weighted clique, approximately twice as much. This indicates that GBS can perform the clique-finding task with high efficiency18."
        },
        {
            "heading": "Molecular docking with GBS",
            "text": "If the graph is constructed according to an actual system occupying the network structure, the clique-finding task then could be utilized to find the optimal subset corresponding to the maximum weighted clique. Recent research shows that the information of the best docking orientation of the protein\u2013ligand complex can be predicted by the\nFig. 2 | Molecular docking and RNA-folding prediction results obtained with Abacus. a, The docking pair of PARP-CQ (see text). Abacus is encoded with a 24-node BIG and finds the maximum weighted clique, using 347 sample data and 100-iteration local searches. b, Another 28-node BIG constructed by the complex of TACE-TS (see text), using 254 sample data and 10 iterations. In a and b the colored spheres denote the pharmacophore points we considered in the experiment (cyan: hydrogen-bond acceptor, HA, ha; blue: hydrogen-bond donor, HD, hd; yellow: negative charge, NC; orange: aromatic, AR, ar; and we use capital letters to represent pharmacophore points in the protein and lowercase letters to represent pharmacophore points in the ligand.) The sphere meshes in the ligands are other possible pharmacophore points but are not considered in our experiments. The shaded region in panels a and b denotes the maximum weighted cliques, as determined by the experimental results. All the cliques found from GBS experiments are shown in the pie charts; the maximum weighted\ncliques in both cases have a major proportion in the experimental results obtained from QIVS. More details are found in Supplementary Information Sections 5 and 6. c,d, The GBS-based RNA-folding prediction results for two RNA sequences (in c, accession no. AH003339; in d, accession no. AB041850). The max weighted cliques are highlighted in colored regions; they represent the most likely folding structures. The four colored circles (A, G, U, C) in the RNA structure represent the four different bases and the gray dashed lines represent the false negative base-pair matching. The colors of nodes within the clique, outlined by solid black lines, correspond to the predicted stems (base-pairs with matching shadow colors) in the RNA folding structure. For example, in c, the yellow node corresponds to the predicted stem with base-pairs 10\u201325, 11\u201324, 12\u201323 and 13\u201322. The cliques encircled by dashed pink (c) and yellow lines (d) represent other folding structures, though they are less accurate. More details are shown in Supplementary Information Section 7.\nNature Computational Science | Volume 3 | October 2023 | 839\u2013848 842\nmaximum weighted clique of a corresponding binding interaction graph (BIG), which is a weighted graph constructed based on docking modes between ligand and receptor18. In the BIG, the weighted nodes represent the interacting pharmacophore pairs weighted by potential, and the edges represent the compatible contacts (Methods). By encoding the BIG on Abacus, we can solve molecular docking problems by finding the maximum weighted clique in the BIG18,34, as we demonstrated in Fig. 1d. To demonstrate the capability of GBS in solving molecular docking problems, we build a quantum inverse virtual screening (QIVS)\nHD2\nHD1 HA1 HA2\nHD3\nGBS\n(HA3 hd3)\n(HA1, hd1)\n(NC1, hd1)\n(HA2, hd1)\n(HA1, hd2)\n(NC1, hd2)\n(HA2, hd2) (HD1, ha1)\n(HD2, ha1)\n(NC2, hd3)\nLigand\nHA1 HA2\nHA3 NC2\nNC1 HD1\nHD2\n(HA1, hd1) (NC1, hd1) (HA1, hd2) (NC1, hd2) (HA2, hd2) (HA2, ha1) (HD1, ha1) (HD2, ha1) (NC2, hd3) (HA3 hd3)\n(HA1, hd1) (NC1, hd1) (HA2, hd1) (NC1, hd2) (HA2, hd2) (HD1, hd2) (HD1, ha1) (HD2, ha1) (NC2, hd3) (HA3 hd3)\n(HA1, hd1) (NC1, hd1) (NC1, hd2) (HA2, hd2) (HD1, hd2) (HA2, ha1) (HD1, ha1) (HD2, ha1) (NC2, hd3) (HA3 hd3)\n(HA1, hd1) (NC1, hd1) (HA2, hd1) (HA1, hd2) (NC1, hd2) (HA2, hd2) (HD1, ha1) (HD2, ha1) (NC2, hd3) (HA3 hd3)\nGBS\nReceptor\nLigand\n(HA1, ha1) (HD1, ha1) (HD2, ha1) (HA1, hd1) (HD1, hd1) (HD3, ha2) (HA2, ha2) (HA1, ar1) (AR1, ar1) (HA1, ha1) (HD1, ha1) (HD2, ha1) (HA1, hd1) (HD1, hd1) (HD2, hd1) (HD3, ha2) (HA1, ar1) (AR1, ar1) (HA1, ha1) (HD1, ha1) (HD2, ha1) (HA1, hd1) (HD1, hd1) (HD3, ha2) (HA2, ha2) (HD1, ar1) (HD2, ar1) (HA1, ha1) (HD1, ha1) (HD2, ha1) (HA1, hd1) (HD1, hd1) (HD2, hd1) (HD3, ha2) (HD1, ar1) (HD2, ar1)\na\nb\n9.76%\n31.71% w = 6.8144\n17.89% w = 6.6936 17.07% w = 6.6702\n23.58% w = 6.5494\nReceptor\n18.50% w = 4.5657\n11.42% w = 4.5423\n9.84% w = 4.5126 14.96% w = 4.4892\n15.75% w = 4.4805\n15.75% w = 4.4571\n13.78%\n(HA2, ha2)\n(HD1, ha1)\n(HD3, ha2)\n(HD1, hd1)\n(HA1, hd1) (HD2, ha1)\n(HA1, ha1)\n(HA1, ar1)\n(AR1, ar1)\nAR1\nd\nA\nU\nG\nC\n10\n20 30\n40\n50\n60\n70\nTwo maximum weighted cliques found by Abacus\nPredicted\nstructure\nc\n1\n76\nTwo maximum weighted cliques found by Abacus\n1\n10\n20 30\n40\n50\n60\n70\n75\nPr ed\nic te d st ru ct ur e\nA\nU\nG\nC\nha1\nha2\nar1 hd1\nha1\nhd3\nhd1 hd2\nHA2\nNC1 hd2\nhd1\nha1 HD1\nHD2\nHA1\nNC2\nHA3\nhd3\nProtein\u2013ligand docking\nProtein\u2013ligand docking\nHD2\nHD3ha2\nHD1 ha1\nhd1ar1\nAR1 HA1\nHA2\nNature Computational Science | Volume 3 | October 2023 | 839\u2013848 843\nplatform based on Abacus and use two pairs of protein\u2013ligand complexes with different drug properties to demonstrate the ability of QIVS in drug design and verified the practicability of the platform. In the first case (Fig. 2a), a 28-node BIG \ud835\udca2\ud835\udca228PARP-CQ is constructed based on the Poly (ADP-Ribose) polymerase-1 (PARP) and an 8-chloroquinazolinone-based inhibitor (PARP-CQ), which is a promising candidate for anticancer drugs35\u201337 and for some central nervous system diseases such as Parkinson\u2019s and Alzheimer\u2019s diseases38,39. The structures of ligand and protein and their BIG are shown in Fig. 2a. By encoding \ud835\udca2\ud835\udca228PARP-CQ onto Abacus, we collect the sampling results and find the associated cliques with postprocessing (that is, shrink and local search)18. The pie chart in Fig. 2a shows all the cliques we find with GBS experiments, where each sector corresponds to one the various cliques with corresponding weights. The maximum weighted clique (with seven nodes and weight = 6.8144) occupies the major proportion. This demonstrates we can use Abacus to find the best binding pose (Fig. 2a, right side) of this complex with a high success rate.\nIn the second case (Fig. 2b), we use the complex of tumor necrosis factor (TNF) converting enzyme (TACE) and thiomorpholine sulfonamide hydroxamate inhibitor (TACE-TS)40, which are involved in inflammatory diseases41. Aromatic pharmacophore points are included and, in order to increase the accuracy of the docking results, an improved algorithm is used. Considering the fact that the interaction strength between various pharmacophore points may create some behavior differences, the variable distance is used to compare the distance between different points when we construct the 24-node BIG \ud835\udca2\ud835\udca224TACE-TS . GBS experiments then are performed by programming the circuit with another set of polarization rotation (\u03b8i), phase shift (\u03c6i) and ri. We find 11 cliques in the sampling results; and six of them (maximum size N = 9) appear with relatively high probabilities. The protein\u2013ligand docking position suggested by the maximum weighted clique (with weight (w) = 4.5657) is shown on the right in Fig. 2b. Compared with the method used by Banchi et al.18, the improved method we proposed here obtains a more accurate binding pose result; the detailed comparison analysis is shown in the Supplementary Information Sections 5 and 6.\nAlthough there is relatively high loss in the experiment, the maximum weighted clique can still be found with a high success probability through postprocessing, which is robust with regard to noise18. The above results, predicted by GBS experiments, agree well with the outcomes obtained from the corresponding co-crystal structures, which can be found by reviewing complex structures within a certain distance (\u03c4) to each other40,42,43, through their entries in the Protein Data Bank (PDB) for PARP1 (PDB entry no. 7ONR) and TACE (PDB entry no. 2A8H)."
        },
        {
            "heading": "GBS for RNA-folding prediction",
            "text": "The molecular docking process relies heavily on the protein structure, and the fact is that many pathogenic proteins associated with human diseases cannot be targeted by conventional small-molecule drugs or biomacromolecules44. In recent years, nucleic acid drugs have received attention in the pharmaceutical field as a potential solution to overcome the limitations of existing target drugs and to treat previously untargeted diseases. Predicting RNA structures has become an important task in discovering these nucleic acid drugs, as it can aid in identifying potential drug targets and predicting small-molecule-drugs\u2019 interactions with RNA molecules45. However, predicting RNA structures by calculation has proven difficult, as only a few RNA structures are known. Nevertheless, exciting work in protein and RNA structure prediction has emerged recently, with artificial intelligence technology being particularly prominent45,46. Quantum computational technology also has great potential to solve this folding prediction task47,48. However, no solution to this problem has yet been experimentally demonstrated on devices that can exhibit quantum computational advantages (such as GBS devices) due to their programmability limitations.\nUsing our universal programmable GBS device Abacus, we use a method, inspired by Tang et al.26, for predicting RNA sequence folding. This approach involves modeling the RNA sequence as a weighted full stem graph (WFSG) and then encoding it into our universal programmable GBS device. The WFSG captures all possible folding information of the RNA sequence, where each node represents a possible stem in the sequence, and the edges indicate the co-existence between them26. The weight of each node corresponds to the length of the stem it represents. Then, the RNA-folding prediction can be obtained by finding the maximum weighted cliques in WFSG26. To demonstrate the effectiveness of our GBS machine in solving this problem, we conducted two experiments with different RNA fragments on Abacus; the results are shown in Fig. 2c,d.\nIn the first example, we predicted the secondary structure of an RNA sequence (accession no.: AH003339) by encoding the corresponding 32-node WFSG into Abacus. We found two maximum weighted cliques, and the Matthews correlation coefficient (MCC) of the best one (shown in light orange shadow in Fig. 2c) reached 0.953, which outperforms FOLD49 (best case) and RNAProbing50, with MCC values of only 0.864 and 0.934, respectively. In the second experiment, we use the RNA sequence of the organism Alanine (accession no.: AB041850) and encoded its corresponding WFSG, which had 31 nodes, into Abacus by modifying the control program. The best prediction with MCC = 1.00 among the two results is shown in Fig. 2d, and it is more accurate than those obtained by other methods, with FOLD achieving MCC = 0.870 and RNAProbing achieving MCC = 0.914. Details of the true reference folding and other information are provided in Supplementary Information Section 7."
        },
        {
            "heading": "Discussion",
            "text": "The scalability and programmability of our universal GBS machine enable its utilization in real-world applications, as demonstrated in this work. The ability to program arbitrary graphs demonstrates that drug discovery tasks, such as molecular docking or RNA-folding prediction, can be performed efficiently by a purpose-built quantum computer. However, unequivocal quantum computational advantage5,7 has not been realized in our experiments due to photon loss. Although the question of whether GBS can outperform improved classical algorithms or quantum-inspired algorithms remains open51, and the potential for GBS to demonstrate computational advantages also relies on the properties of the encoded graph, we remain optimistic about scaling Abacus to several hundred modes using the \u2018multicore encoding\u2019 and \u2018distributed computing\u2019 methods. This scalability holds the potential to unlock quantum advantages in some specific real-world applications. Additionally, it is crucial to consider practical applications that encompass more complex protein structures, larger pharmacophore points and longer RNA sequences, which also necessitate the use of such a large-scale GBS machine. For a comprehensive discussion on scaling our GBS machine by minimizing loss and utilizing the multicore encoding and distributed computing methods, refer to Supplementary Information Section 8. Apart from offering programmability and universality, this work presents a promising hardware solution for the near-term industrial implementation of quantum computing in the biopharmaceutical industry. It also paves the way for diverse real-world applications in the future."
        },
        {
            "heading": "Methods",
            "text": "Details about the programmable GBS machine The GBS machine shown in Fig. 1a, which we named Abacus, can be divided into four main parts: (1) Tunable squeezed-state source. The pump light from a mode-locked pulsed laser (80 MHz, 773 nm, ~150 fs) is reduced in repetition rate to 40 MHz by an acoustic-optic modulator. The electro-optic modulator (EOM0) and polarization beam splitter (PBS) are used to adjust the pump energy of each pulse. This controls the squeezing degree (ri) of the squeezed vacuum states in each time\nNature Computational Science | Volume 3 | October 2023 | 839\u2013848 844\nbin. The spectral mode of the pump light is modulated by a spatial light modulator, two gratings and two cylindrical lenses (CLs). Then, spectrally uncorrelated two-mode squeezed light is generated by pumping a 10-mm-long ppKTP waveguide27\u201329. Following interference at a 50:50 beamsplitter, a series of individually addressable single-mode squeezed states can be efficiently prepared30. (2) Quantum processing unit (QPU). The single-mode squeezed states are then sent into a timebin interferometer, which is programmed for a specific unitary operation. This is achieved according to Clements\u2019 architecture31, which is realized by a group of Mach\u2013Zehnder interferometers consisting of two high-speed optical switches EOMa and EOMb, a 7.5 m delay line (to combine or separate two adjacent time bins) and a linear transformation T(\u03b8,\u03c6\ud835\udc9c = ( e i\u03c6 cos\u03b8 \u2212 sin\u03b8 ei\u03c6 sin\u03b8 cos\u03b8 ) , where \u03c6 represents the phase shift and \u03b8 denotes the polarization rotation, these are achieved by EOM1 and EOM2, respectively. Since the optical path before and after T(\u03b8, \u03c6) passes through the same low-loss free-space delay line, the phase stability of the setup is well guaranteed, and the non-uniform loss expected in the fiber-loop scheme32 is mitigated. (3) Quantum sequential access memory (QuSAM). In each loop of evolution, the quantum memory is achieved by a 180-meter-long optical fiber delay line. The QuSAM ensures that the last time bin has completed the operation in one cycle before the first time bin enters into the next cycle. With a 4f beam-shaper system, we can efficiently couple the light from free space into single-mode optical fiber and realize a low-loss time-bin memory (with total efficiency of ~94%) by reshaping the spatial mode of the beam. (4) Detection module. SNSPDs are used to detect the single-photon events, since our experiments are performed in the collision-free space. To avoid the issue of the SNSPD dead-time (\u227250 ns) being longer than the time interval between two adjacent time bins (25 ns), we use another EOM to separate two adjacent time bins and use two SNSPDs for detection. The throughput of each round-trip in the system is approximately 82%. In the case of Fig. 1b, the average count rate of two-fold events is 45 counts per second, and in the case of Fig. 1c, the four-fold average count rate is 24 counts per second, which are calculated from 107 samples in 10 min (the repetition rate of each individual sampling experiment is 20 kHz). More details are provided in Supplementary Information Section 2.\nThis GBS machine has two main advantages compared with previous works: First, universal operation is possible since both the squeezers and arbitrary unitary matrices can be programmed on the time-bin interferometer. This makes it suitable not only for molecular docking of various molecules but also for other applications. Our architecture also provides flexibility in scaling to many modes via the control software. Compared to previous work5,7, our GBS setup supports adjustments to all the parameters: n squeezing parameters ri and n(n \u2212 1)/2 parameters for an arbitrary U. Our time-bin-encoding GBS setup is resource-efficient for scaling up. Specifically, when the number of modes increases, we do not need to add more squeezed-light sources. Independent of the number of modes we required in experiments, two analog EOMs (that is, EOM1 and EOM2) assisted with two light-switch EOMs (that is, EOMa and EOMb) are sufficient to realize any linear transformation. A resource advantage is also exhibited in the detection. As we discussed in the main text and Supplementary Information Section 2E, two SNSPDs are enough for collecting the ~30-mode GBS samples.\nSecond, non-uniform loss in previous time-bin interferometer implementations appears across different time-bin modes, and this limits the ability to perform an arbitrary unitary operation32. In this setup, we use a free-space delay line with transmittance 0.995 to greatly reduce the non-uniform loss. Thus, the mitigated non-uniform loss and dispersion-free features in our setup can better exhibit universality. The time-bin-encoded GBS scheme is intrinsically phase stable20. As shown in Fig. 1a, since every time bin goes through the same path, the slow phase fluctuations (caused by mechanical vibrations, temperature\ndrifts or other unpredictable environmental noise) can be neglected compared to the high sampling rate where a sample is obtained in 50 \u03bcs. The 7.5 m free-space delay line is isolated from the environment to ensure that the phase between two adjacent time bins can be stable for up to 5 min. This is enough for collecting 106 samples within 1 min."
        },
        {
            "heading": "Mapping a graph onto GBS",
            "text": "As for a loopless, undirected and vertex-weighted graph \ud835\udca2\ud835\udca2, the corresponding adjacency matrix \ud835\udc9c\ud835\udc9c is a symmetric (0,1)-matrix, where the vertex weights are given by \u03c9i, and the entries are \ud835\udc9c\ud835\udc9cii = \u03c9i, \ud835\udc9c\ud835\udc9cij = 1 if there is an edge between vertex i and j and \ud835\udc9c\ud835\udc9cij = 0 if otherwise. After finding the adjacency matrix \ud835\udc9c\ud835\udc9c of a graph, then the key step to encode the graph \ud835\udca2\ud835\udca2 onto GBS machine is connecting \ud835\udc9c\ud835\udc9c with the sampling matrix A through some proper transformation (the inset in Fig. 1a provides an example possibility).\nFor a pure Gaussian state, the sampling matrix A can be written as B \u2295 B*; then the Hafnian Haf(A) can be expressed as Haf(B \u2295 B*) = \u2223Haf(B)\u22232. Thus, the output probability of obtaining the sampling pattern s can be expressed as\nPr(s\ud835\udc9c = |Haf(Bs\ud835\udc9c| 2\nn1!n2!\u22efnN!\u221adet (\u03c3 + \ud835\udd40\ud835\udd40\ud835\udd402\ud835\udc9c . (1)\nAn immediate idea is to replace B here with the adjacency matrix \u2126(\ud835\udc9f\ud835\udc9f \u2212 \ud835\udc9c\ud835\udc9c\ud835\udc9c\u2126 , where \u03a9 is a diagonal matrix with elements (\u2126ii = \u03c9i\ud835\udc9c and \ud835\udc9f\ud835\udc9f is the degree matrix of \ud835\udc9c\ud835\udc9c defined as \ud835\udc9f\ud835\udc9fii = \u2211j\ud835\udc9c\ud835\udc9cij . However, this does not work, since the eigenvalues of B should be within the interval [0, 1), such that the covariance matrix of the pure Gaussian state is positive definite24. From an experimental point of view, this restriction is because the eigenvalues of B denote the brightness of squeezing sources in the experiment. We can decompose the symmetric matrix B as52\nB = U\u2295Ni tanh(ri\ud835\udc9cUT, (2)\nwhere U is the unitary matrix applied in experiments and ri denotes the squeezing parameters for the vacuum states, as shown in Supplementary Information Fig. 1a. Thus, the value of eigenvalues tanh(ri\ud835\udc9c should be between 0 and 1, and 1 cannot be reached because that would correspond to infinite brightness.\nTo satisfy this condition, we can rescale \ud835\udc9c\ud835\udc9c by carefully choosing the parameters c and \u03b1 when we add the weight of each vertex to the adjacency matrix:\n\ud835\udc9c\ud835\udc9c\u2032 = \u2126(\ud835\udc9f\ud835\udc9f \u2212 \ud835\udc9c\ud835\udc9c\ud835\udc9c\u2126, (3)\nwhere \u03a9 is a diagonal matrix with elements \u03a9ii = c(1 + \u03b1\u03c9i). By choosing parameters c and \u03b1 suitably, we can obtain an \ud835\udc9c\ud835\udc9c\u2032 with the correct spectrum. Additionally, we also can maximize the maximum input photon number in the experiment over the choice of c and \u03b1. The \ud835\udc9f\ud835\udc9f matrix is introduced so that the \ud835\udc9c\ud835\udc9c\u2032 matrix is positive definite18. But when GBS is operated in the collision-free subspace, \ud835\udc9f\ud835\udc9f will not affect the results of Haf (\ud835\udc9c\ud835\udc9c\u2032\ud835\udc9c and, according to Banchi et al.18, Haf (\ud835\udc9c\ud835\udc9c\u2032\ud835\udc9c = det(\u03a9\ud835\udc9cHaf (\ud835\udc9c\ud835\udc9c\ud835\udc9c. More details can be found in Supplementary Information Section 3."
        },
        {
            "heading": "Constructing the adjacency matrix of a BIG",
            "text": "Inverse virtual screening is a structure-based approach to find potential drug targets for a given drug or active small molecule by calculation. For known drugs, inverse virtual screening technology can do the drug repositioning and provide reference for the study of new drug effects and drug side effects53. For active small molecules, inverse virtual screening technology can predict their potential targets, identify their therapeutic potential in diseases and provide direction for the later transformation and mechanism research of active compounds54,55.\nNature Computational Science | Volume 3 | October 2023 | 839\u2013848 845\nIf the graph is constructed according to an actual system occupying the network structure, the clique-finding task then could be utilized to find the optimal subset corresponding to the maximum weighted clique. Recent research shows that the information of the best docking orientation of the protein\u2013ligand complex can be predicted by the maximum weighted clique of a corresponding BIG18. In the docking scheme of bioactive molecules, the BIG is a weighted graph constructed based on docking modes between ligand and receptor. In the BIG, the weighted nodes represent the interacting pharmacophore pairs weighted by potential and the edges represent the compatible contacts.\nThe edge generation in a BIG is determined by comparing the distances between the pharmacophore points on the ligand (Dx\u2212xL ) and binding (Dx\u2212xP ) sites. This is illustrated in boxes 1 and 2 of Supplementary Information Fig. 21. Each possible contact is represented by a vertex in BIG, and the corresponding weight is determined by the contact potential (shown in Supplementary Information Fig. 23). A BIG with only weighted vertices is illustrated in box 3 in Supplementary Information Fig. 21.\nWhile the geometric distances between two contacts should normally be approximately the same on both the ligand and the binding site, they can exhibit some degree of flexibility18. A pair of contacts, for example, (C, a) and (B, c), is considered a \u03c4-flexible contact pair if the difference between the distances of the pharmacophore points on the ligand (corresponding to vertices \u2018C\u2019 and \u2018B\u2019) and the distances of the pharmacophore points on the binding site (corresponding to vertices \u2018a\u2019 and \u2018c\u2019) is within \u03c4 + 2\u03b5, as depicted in Supplementary Information Fig. 21. The constants \u03c4 and \u03b5 describe the flexibility constant and interaction distance, respectively, and they determine which edges appear in the BIG, as shown in boxes 4 and 5 in Supplementary Information Fig. 21.\nIt should be noted that, in the work of Banchi et al.18, \u03c4 and \u03b5 are set as constants for simplicity, as discussed above. However, more accurate methods can account for the changeable flexibility of the ligand and receptor18,56. \u03c4 and \u03b5 are no longer set as constants and can vary according to the various pharmacophore points in the contacts.\nBy encoding the BIG on Abacus, we can solve molecular docking problems by finding the maximum weighted clique18,34 in the BIG, as we demonstrated, with results shown in Fig. 2.\nTo better demonstrate the capability of Abacus in solving molecular docking problems, we build a QIVS platform, as shown in Supplementary Information Fig. 22. Inverse virtual screening (IVS) is a technology for finding potential drug targets for a given drug or small active molecule by calculations, and it has been applied to identifying targets, research on side effects and drug repurposing57,58. In such a computer-aided drug design method as IVS, a large amount of computational resources are usually required, since a huge number of proteins in the database need to be screened by this docking program to identify potential targets for a given ligand, with a run-time that scales with the size of the ligands and receptors.\nUnlike the classical IVS, we replace the traditional molecular docking process with GBS and achieve a more efficient and accurate QIVS. According to the selected ligand and potential proteins, a corresponding BIG, \ud835\udca2\ud835\udca2BIG, is constructed (shown in Supplementary Information Fig. 22) and is then encoded into the GBS machine. The best binding pose can be determined by finding the maximum weighted clique of this graph \ud835\udca2\ud835\udca2BIG (ref. 18), a task for which our programmable Abacus is well suited. More details can be found in Supplementary Information Section 5."
        },
        {
            "heading": "Postprocessing method with \u2018Shrinking\u2019 and \u2018Local search\u2019",
            "text": "The presence of various types of noise in the experiments affects the probability of the maximum weighted clique obtained from the raw experimental data. In some cases, the subgraph obtained may not even be a clique. Certain types of noise are unavoidable in experiments (for example, photon loss), in which case we can use the raw experimental data as a seed which can be input to a postprocessing algorithm to\ngenerate cliques at a high-rate. The postprocessing method introduced in Banchi et al.18 is very useful for this purpose. We briefly review the postprocessing method and discuss how we use it in our experiments.\nWe use \u2018Greedy Shrinking\u2019 to ensure the subgraph obtained from the raw GBS data is a clique by removing the nodes based on the degree and weight of the nodes until it forms a clique. To obtain the maximum weighted clique, which usually occurs with a larger number of nodes, we perform an expansion with a \u2018Local search\u2019. This expands the clique by adding neighboring nodes within several iterations of the algorithm to generate the largest clique. This is represented as the \u2018Postprocessing\u2019 module in Supplementary Information Fig. 22. Strawberry Fields59 is used to perform the postprocessing. Further details can be found in the work of Banchi et al.18\nFurther scaling by reducing loss In our experiment, simultaneously achieving universality and programmability comes at the cost of loss, which increases with the circuit depth or, more specifically, the number of cycles. This relatively large loss exists in our GBS machine prohibits demonstration of quantum computational advantage. Although we mainly focus on the mapping of GBS to real-world applications in this work, with further developments toward low-loss optical components, realization of quantum advantage should be possible in the future.\nLoss in Abacus can be reduced by various methods. Loss in the experiment mainly comes from (1) the coupling loss from the ppKTP waveguide to single-mode fiber, (2) insertion loss caused by EOMs, (3) the limited coupling efficiency from free space to QuSAM and (4) the limited detection efficiency of SNSPDs. Particularly, for the EOM insertion loss (2) and the limited QuSAM coupling efficiency (3), due to the characteristics of our free-space loop architecture, the total loss will increase exponentially with the loss inside the loop. Therefore, when the number of modes is large, small improvements to these sources of loss will greatly improve the overall loss.\nFirst, for the coupling loss from the ppKTP waveguide to singlemode fiber, mode shaping techniques may be applied to match the spatial mode of light from the ppKTP waveguide to that of the fiber, potentially improving the coupling efficiency to greater than 0.9 (ref. 60). Second, the insertion loss of EOMs or other optical elements is unavoidable. However, an EOM with a shorter and lower loss crystal\u2014driven by a higher-gain amplifier\u2014could be used. Combining the actions of EOM1 and EOM2 into an integrated EOM operation will further reduce the loss experienced upon reflection and absorption at the end faces. Transmission has been shown to reach higher than 0.99 after optimizing the EOM7. Third, the coupling efficiency from free space to QuSAM can be improved up to ~0.97 by using a 4f or 8f imaging systems through spherical lenses and graded-index lens fiber couplers (see Madsen et al.7). In addition, a Herriott longdistance delay line can be used as a quantum memory for minimizing the loss61. Finally, the detection efficiency can be improved with the latest generation of nanowire detectors with detection efficiencies at 1,550 nm of up to 0.95. Through these methods to minimize the loss, the single-loop transmission can potentially reach ~90%. Thus, our GBS setup can be extended to at least 60 modes (for example, a 60-mode GBS experiment will have total transmission efficiency of ~0.12%, found from the product of the several involved transmission efficiencies, as 0.9061 (loop efficiency, to the loop-count power) \u00d7 0.9 (coupling efficiency from ppKTP to fiber) \u00d7 0.944 (filter after ppKTP induce) \u00d7 0.93 (coupling efficiency from QPU to fiber) \u00d7 0.973 (transmission of demultiplexer) \u00d7 0.95 (detection efficiency of SNSPDs).\nImplement displacement and photon-number resolving detection in time-domain GBS Displacement operation D(\u03b1) is entirely feasible to include in Abacus. To achieve this, the photon source module needs to be rebuilt, which involves incorporating an optical parametric oscillator after\nNature Computational Science | Volume 3 | October 2023 | 839\u2013848 846\nthe mode-locked laser (Chameleon) to generate a 1,550 nm laser. This laser is subsequently split into two separate paths. In one path, the light serves as the pump for generating squeezed states. In the other path, the light is utilized as a coherent state to achieve the displacement operation. The addition of a delay line ensures that the coherent state and squeezed state reach the beamsplitter simultaneously, enabling optimal interference at the output. Two EOMs facilitate the programmability of the amplitude and phase of the displacement operation. For more detailed information, please refer to Supplementary Information Section 2H.\nOur time-domain GBS machine Abacus can also implement photon-number resolving detection with a transition edge sensor (TES). The TES initially needs to be cooled below its transition temperature of approximately 100 mK and then heated back to its transition temperature by applying a bias current62. To maintain the TES at this temperature, it should be operated inside a dilution refrigerator. After a photon absorption event, it takes approximately 5 \u03bcs for the TES to return to its original temperature. Therefore, the repetition rate of TES detectors is usually limited to around 100\u2013300 kHz. This necessitates the installation of a demultiplexer in our timedomain GBS setup. To address this limitation for a time-domain GBS machine, a demultiplexer needs to be installed. By employing a loop structure, it is straightforward to implement a nine-channel demultiplexer using a single EOM. The EOM enables us to manipulate the polarization of photons in each time bin, thereby determining whether they exit the system through PBSs or undergo internal reflection and remain within the loop. The design corresponding to this approach is depicted in Supplementary Information Fig. 15, and further detailed information can be found in Supplementary Information Section 2I."
        },
        {
            "heading": "Pharmacophore points selection",
            "text": "The selection of PARP\u2013PARPi pharmacophore points\u2014where PARPi refers to PARP inhibitors, including the PARP-CQ we used as shown in Fig. 2a\u2014is according to previous research focused on PARP\u2013PARPi relationships63,64. These articles have demonstrated important amino acid residues from the protein and functional groups from the inhibitor that will influence the efficacy of the protein\u2013ligand interactions. We choose some of them for the GBS machine due to the size of the experiment.\nThe selection of pharmacophore points in this work is typically based on prior knowledge from experimental studies, structural analysis or computational modeling of similar PARP\u2013PARPi complexes. The selection of pharmacophore points, such as hydrogen-bond acceptors and donors, negative charges, pi\u2013pi interaction and aromatic ring in the PARP\u2013PARPi complex is based on their known importance in the interaction between the protein, PARP and the ligand. These pharmacophore characteristics play a crucial role in the binding affinity and specificity of ligands to protein targets.\nHydrogen-bond interactions are important for stabilizing the protein\u2013ligand complex. Such an interaction occurs between the hydrogen atom of the ligand and a hydrogen-bond acceptor or donor group on the protein. These pi\u2013pi interactions contribute to the overall binding strength and specificity by forming specific and directional interactions; they involve the stacking of aromatic rings in the ligand and the protein. These interactions are driven by the pi electrons present in the aromatic systems and contribute to the stability of the complex. Such pi\u2013pi interactions are often found in protein\u2013ligand interactions and can enhance binding affinity. Some articles have reviewed pharmacophores in a PARP inhibitor, and in those studies the nicotinamide component is considered as a hydrogen-bond donor and acceptor, as well as being a part of pi\u2013pi interaction with the tyrosine residue63.\nAromatic rings are frequently present in ligands and proteins and can participate in various types of interactions, including pi\u2013pi stacking, hydrophobic interactions and van der Waals interactions. Aromatic rings provide a hydrophobic surface that can interact with\ncomplementary hydrophobic regions in the protein, contributing to the overall binding affinity. The aromatic ring at the tail of the compound is also critical, and we take it as a pharmacophore as well42.\nNegative charges, represented by negatively charged atoms or functional groups, also play a major role in the PARP\u2013PARPi complex. Such a negative charge can interact with positively charged residues on the protein, like arginine or lysine, through electrostatic interactions, and these interactions can also contribute to the stability of the complex and enhance ligand binding.\nClassical combinatorial optimization methods In Supplementary Information Section 9, we discuss more details about the classical or quantum-inspired approaches like genetic algorithms, quantum approximate optimization algorithm, quantum annealing and digital annealer, which also can be used to realize clique finding and other similar tasks."
        },
        {
            "heading": "Data availability",
            "text": "Source data are provided with this paper. The experimental data used in this paper are also publicly available in a Zenodo repository at https:// doi.org/10.5281/zenodo.8306628 with a citable release at ref. 65."
        },
        {
            "heading": "Code availability",
            "text": "The codes used to generate the corresponding adjacency matrices in Fig. 2a\u2013d, analyze experimental data and implement the Bron\u2013 Kerbosch and Maximum Clique algorithms for result verification are available at https://doi.org/10.5281/zenodo.8284043 with a citable release at ref. 66."
        },
        {
            "heading": "Acknowledgements",
            "text": "S. Yu would like to express special gratitude to M. Tang and S. Kang for their assistance with RNA-folding prediction methods. We thank Q. Wang, B. Bell, Z. Jia, X. Xu, Z. Liu and A. Zhang for the helpful discussions, and S. Sempere-Llagostera for providing useful feedback on the manuscript. This work was supported by Engineering and Physical Sciences Research Council and Quantum Computing and Simulation Hub (T001062), UK Research and Innovation Future Leaders Fellowship (MR/W011794/1), EU Horizon 2020 Marie Sklodowska-Curie Innovation Training Network (no. 956071, \u2018AppQInfo\u2019), International Postdoctoral Exchange Fellowship Program 2022 (no. PC2022049), Innovation Program for Quantum Science and Technology (no. 2021ZD0301200), China Postdoctoral Science Foundation funded projects (no. 2020M681949), the National Natural Science Foundation of China (nos. 11821404, 12174370 and 12174376), the Youth Innovation Promotion Association of Chinese Academy of Sciences (no. 2017492) and the Fok Ying-Tong Education Foundation (no. 171007)."
        },
        {
            "heading": "Author contributions",
            "text": "S.Y. and J.-S.T. designed the experiment with input from R.B.P. S.Y. built the experimental setup with the help of Q.-P.L., R.B.P., L.X., Y.M., Z.-P.L., Y.-Z.Y., Z.-A.W., N.-J.G., W.-H.Z. and Y.-T.W. Z.-P.Z. developed the control system for the programmable hardware. Y.F. and G.K.T. designed the molecular docking scheme. S.Y. designed and built the squeezed-light source with the help of Y.-T.W. and R.B.P. S.Y. and Y.F. completed data\nanalysis with the help of W.L., J.-S.T., R.B.P. and I.A.W. S.Y., J.-S.T., Y.-T.W., S.S.-S. and Y.D. designed the further-scaling method with the help of Z.L. S.Y. and Y.F. prepared the manuscript with the help of R.B.P., Y.D., J.-S.T., Y.-T.W., Z.L., E.M., S.E.T., C.-F.L., I.A.W. and G.-C.G. All authors discussed the results and reviewed the manuscript."
        },
        {
            "heading": "Competing interests",
            "text": "The authors declare no competing interests."
        },
        {
            "heading": "Additional information",
            "text": "Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s43588-023-00526-y.\nCorrespondence and requests for materials should be addressed to Shang Yu, Raj B. Patel, Yi-Tao Wang, Jian-Shun Tang or Chuan-Feng Li.\nPeer review information Nature Computational Science thanks Leonardo Banchi and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Primary Handling Editor: Jie Pan, in collaboration with the Nature Computational Science team.\nReprints and permissions information is available at www.nature.com/reprints.\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.\nOpen Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article\u2019s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article\u2019s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons. org/licenses/by/4.0/.\n\u00a9 The Author(s) 2023"
        }
    ],
    "title": "A universal programmable Gaussian boson sampler for drug discovery",
    "year": 2023
}