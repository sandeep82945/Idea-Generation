{
    "abstractText": "With the development of wireless communication, people have put forward higher requirements for train-ground communications in the high-speed railway (HSR) scenarios. With the help of mobile relays (MRs) installed on the roof of the train, the application of Millimeter-Wave (mm-wave) communication which has rich spectrum resources to the trainground communication system can realize high data rate, so as to meet users\u2019 increasing demand for broad-band multimedia access. Also, full-duplex (FD) technology can theoretically double the spectral efficiency. In this paper, we formulate the user association and transmission scheduling problem in the mmwave train-ground communication system with MR operating in the FD mode as a nonlinear programming problem. In order to maximize the system throughput and the number of users meeting quality of service (QoS) requirements, we propose an algorithm based on coalition game to solve the challenging NPhard problem, and also prove the convergence and Nash-stable structure of the proposed algorithm. Extensive simulation results demonstrate that the proposed coalition game based algorithm can effectively improve the system throughput and meet the QoS requirements of as many users as possible, so that the communication system has a certain QoS awareness.",
    "authors": [
        {
            "affiliations": [],
            "name": "Xiangfei Zhang"
        },
        {
            "affiliations": [],
            "name": "Yong Niu"
        },
        {
            "affiliations": [],
            "name": "Tao Yang"
        },
        {
            "affiliations": [],
            "name": "Xian Xiao"
        },
        {
            "affiliations": [],
            "name": "Jianwen Ding"
        },
        {
            "affiliations": [],
            "name": "Sheng Chen"
        },
        {
            "affiliations": [],
            "name": "Zhangdui Zhong"
        },
        {
            "affiliations": [],
            "name": "Ning Wang"
        }
    ],
    "id": "SP:d877ef33c5ac08c7544151a8b83cda5a7264d58e",
    "references": [
        {
            "authors": [
                "B. Ai",
                "A.F. Molisch",
                "M. Rupp",
                "Z. Zhong"
            ],
            "title": "5G key technologies for smart railways",
            "venue": "Proceedings of the IEEE, vol. 108, no. 6, pp. 856-893, June 2020.",
            "year": 2020
        },
        {
            "authors": [
                "D. Fan",
                "Z. Zhong",
                "G. Wang",
                "F. Gao"
            ],
            "title": "Doppler shift estimation for high-speed railway wireless communication systems with largescale linear antennas",
            "venue": "Proc. Int. Workshop High Mobility Wireless Commun., pp. 96-100, Oct. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "M. Gao"
            ],
            "title": "Dynamic mmWave beam tracking for high speed railway communications",
            "venue": "Proc. IEEE Wireless Commun. Netw. Conf. Workshops (WCNCW), pp. 278-283, Apr. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "X. Zhang"
            ],
            "title": "Resource Allocation for Millimeter-Wave Train- Ground Communications in High-Speed Railway Scenarios",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 70, no. 5, pp. 4823-4838, May 2021.",
            "year": 2021
        },
        {
            "authors": [
                "B. Lannoo",
                "D. Colle",
                "M. Pickavet",
                "P. Demeester"
            ],
            "title": "Radio-over-fiberbased solution to provide broadband Internet access to train passengers",
            "venue": "IEEE Communications Magazine, vol. 45, no. 2, pp. 56-62, Feb. 2007.",
            "year": 2007
        },
        {
            "authors": [
                "Y. Niu",
                "C. Gao",
                "Y. Li",
                "D. Jin",
                "L. Su",
                "D. Wu"
            ],
            "title": "Boosting spatial reuse via multiple paths multi-hop scheduling for directional mmWave WPANs",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 65, no. 8, pp. 6614\u20136627, Aug. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "K. Guan"
            ],
            "title": "On millimeter wave and thz mobile radio channel for smart rail mobility",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 66, no. 7, pp. 5658\u20135674, Jul. 2017.",
            "year": 2017
        },
        {
            "authors": [
                "H. Song",
                "X. Fang",
                "Y. Fang"
            ],
            "title": "Millimeter-wave network architectures for future high-speed railway communications: Challenges and solutions",
            "venue": "IEEE Wireless Communications, vol. 23, no. 6, pp. 114\u2013122, Dec. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "S. Singh",
                "R. Mudumbai",
                "U. Madhow"
            ],
            "title": "Interference analysis for highly directional 60-GHz mesh networks: the case for rethinking medium access control",
            "venue": "IEEE/ACM Transactions on Networking (TON), vol. 19, no. 5, pp. 1513-1527, Oct. 2011.",
            "year": 2011
        },
        {
            "authors": [
                "W.G. Ding",
                "Y. Niu",
                "H. Wu",
                "Y. Li",
                "Z.D. Zhong"
            ],
            "title": "QoS-Aware Full- Duplex Concurrent Scheduling for Millimeter Wave Wireless Backhaul Networks",
            "venue": "IEEE Access, vol. 6, pp. 25313-25322, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "C. Skouroumounis",
                "C. Psomas",
                "I. Krikidis"
            ],
            "title": "Heterogeneous FD mm-Wave Cellular Networks With Cell Center/Edge Users",
            "venue": "IEEE Transactions on Communications, vol. 67, no. 1, pp. 791-806, Jan. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "Z. Zhang",
                "X. Chai",
                "K. Long",
                "A.V. Vasilakos",
                "L. Hanzo"
            ],
            "title": "Full duplex techniques for 5G networks: self-interference cancellation, protocol design, and relay selection",
            "venue": "IEEE Communications Magazine, vol. 53, no. 5, pp. 128-137, May 2015.",
            "year": 2015
        },
        {
            "authors": [
                "Y.Z. Lu",
                "J.H. Qi",
                "F.Q. Hu",
                "H. Peng"
            ],
            "title": "Exploring the application of millimeter wave communication technology in high-speed rail passenger service",
            "venue": "Railway Signaling Commun., vol. 54, no. 5, pp. 50\u201353, 2018.",
            "year": 2018
        },
        {
            "authors": [
                "C.H. Doan"
            ],
            "title": "Design considerations for 60 GHz CMOS radios",
            "venue": "IEEE Commun. Mag., vol. 42, no. 12, pp. 132\u2013140, Dec. 2004.",
            "year": 2004
        },
        {
            "authors": [
                "S. Singh",
                "R. Mudumbai",
                "U. Madhow"
            ],
            "title": "Interference Analysis for Highly Directional 60-GHz Mesh Networks: The Case for Rethinking Medium Access Control",
            "venue": "IEEE/ACM Transactions on Networking, vol. 19, no. 5, pp. 1513-1527, Oct. 2011.",
            "year": 2011
        },
        {
            "authors": [
                "S. Singh",
                "F. Ziliotto",
                "U. Madhow",
                "E. Belding",
                "M. Rodwell"
            ],
            "title": "Blockage and directivity in 60 GHz wireless personal area networks: from crosslayer model to multihop MAC design",
            "venue": "IEEE Journal on Selected Areas in Communications, vol. 27, no. 8, pp. 1400-1413, October 2009.",
            "year": 2009
        },
        {
            "authors": [
                "A. Khan",
                "A. Jamalipour"
            ],
            "title": "Moving Relays in Heterogeneous Cellular Networks?A Coverage Performance Analysis",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 65, no. 8, pp. 6128-6135, Aug. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "A.J. Theiss",
                "C.J. Meadows",
                "R.B. True"
            ],
            "title": "Experimental Investigation of a Novel Circuit for MM-Wave TWTs",
            "venue": "2006 IEEE International Vacuum Electronics Conference held Jointly with 2006 IEEE International Vacuum Electron Sources, pp. 183-184, 2006.",
            "year": 2006
        },
        {
            "authors": [
                "D. He"
            ],
            "title": "Influence of Typical Railway Objects in a mmWave Propagation Channel",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 67, no. 4, pp. 2880-2892, April 2018.",
            "year": 2018
        },
        {
            "authors": [
                "H. Yuan",
                "M. Zhou"
            ],
            "title": "Profit-Maximized Collaborative Computation Offloading and Resource Allocation in Distributed Cloud and Edge Computing Systems,",
            "venue": "IEEE Transactions on Automation Science and Engineering,",
            "year": 2021
        },
        {
            "authors": [
                "X. Chen"
            ],
            "title": "Multi-Antenna Covert Communication via Full-Duplex Jamming Against a Warden With Uncertain Locations",
            "venue": "IEEE Transactions on Wireless Communications, vol. 20, no. 8, pp. 5467-5480, Aug. 2021.",
            "year": 2021
        },
        {
            "authors": [
                "Y. Cao"
            ],
            "title": "Secrecy Analysis for Cooperative NOMA Networks With Multi-Antenna Full-Duplex Relay",
            "venue": "IEEE Transactions on Communications, vol. 67, no. 8, pp. 5574-5587, Aug. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "L. Weizheng",
                "T. Xiumei"
            ],
            "title": "Throughput analysis of full-duplex network coding in two-way relay channel",
            "venue": "2017 IEEE 17th International Conference on Communication Technology (ICCT), 2017, pp. 85-90.",
            "year": 2017
        },
        {
            "authors": [
                "W. Cheng",
                "X. Zhang",
                "H. Zhang"
            ],
            "title": "RTS/FCTS mechanism based full-duplex MAC protocol for wireless networks",
            "venue": "2013 IEEE Global Communications Conference (GLOBECOM), 2013, pp. 5017-5022.",
            "year": 2013
        },
        {
            "authors": [
                "C. Kai",
                "X. Zhang",
                "X. Hu",
                "W. Huang"
            ],
            "title": "Optimal Scheduling and Power Control for In-Band Full-Duplex Communication in WLANs",
            "venue": "GLOBECOM 2020 - 2020 IEEE Global Communications Conference, 2020, pp. 1-6.",
            "year": 2020
        },
        {
            "authors": [
                "D. Wen",
                "G. Yu"
            ],
            "title": "Time-division cellular networks with full-duplex base stations",
            "venue": "IEEE Commun. Lett., vol. 20, no. 2, pp. 392\u2013395, Feb. 2016.",
            "year": 2016
        },
        {
            "authors": [
                "W. Ding"
            ],
            "title": "QoS-aware full-duplex concurrent scheduling for millimeter wave wireless backhaul networks",
            "venue": "IEEE Access, vol. 6, pp. 25313\u201325322, Apr. 2018.",
            "year": 2018
        },
        {
            "authors": [
                "Y. Niu"
            ],
            "title": "A survey of millimeter wave communications (mmWave) for 5G: Opportunities and challenges",
            "venue": "Wireless Networks, vol. 6, no. 8, pp. 2657\u20132676, 2015.",
            "year": 2015
        },
        {
            "authors": [
                "N. Zarifeh",
                "M. Alissa",
                "M. Khaliel",
                "T. Kaiser"
            ],
            "title": "Self-interference mitigation in full-duplex base-station using dual polarized reflect-array",
            "venue": "2018 11th German Microwave Conference (GeMiC), 2018, pp. 180-183.",
            "year": 2018
        },
        {
            "authors": [
                "Y. Du",
                "L. Wang",
                "L. Xing",
                "J. Yan",
                "M. Cai"
            ],
            "title": "Data-Driven Heuristic Assisted Memetic Algorithm for Efficient Inter-Satellite Link Scheduling in the BeiDou Navigation Satellite System",
            "venue": "IEEE/CAA Journal of Automatica Sinica, vol. 8, no. 11, pp. 1800-1816, Nov 2021.",
            "year": 1816
        },
        {
            "authors": [
                "X. Jin",
                "C. Xia",
                "N. Guan",
                "P. Zeng"
            ],
            "title": "Joint Algorithm of Message Fragmentation and No-Wait Scheduling for Time-Sensitive Networks",
            "venue": "IEEE/CAA Journal of Automatica Sinica, vol. 8, no. 2, pp. 478-490, Feb 2021.",
            "year": 2021
        },
        {
            "authors": [
                "S. Rezvani",
                "N.M. Yamchi",
                "M.R. Javan",
                "E.A. Jorswieck"
            ],
            "title": "Resource Allocation in Virtualized CoMP-NOMA HetNets: Multi-Connectivity for Joint Transmission",
            "venue": "IEEE Transactions on Communications, vol. 69, no. 6, pp. 4172-4185, June 2021.",
            "year": 2021
        },
        {
            "authors": [
                "Y. Li",
                "Z. Zhang",
                "W. Wang",
                "H. Wang"
            ],
            "title": "Concurrent transmission based Stackelberg game for D2D communications in mmWave networks",
            "venue": "Proc. ICC 2017 (Paris, France), May 21-25, 2017, pp. 1\u20136.",
            "year": 2017
        },
        {
            "authors": [
                "S.H. Paik",
                "S. Kim",
                "H.B. Park"
            ],
            "title": "A resource allocation using game theory adopting AMC scheme in multi-cell OFDMA system",
            "venue": "2010 2nd International Conference on Future Computer and Communication, 2010, pp. V2-344-V2-347.",
            "year": 2010
        },
        {
            "authors": [
                "A. Wang",
                "Y. Cai",
                "Z. Hou"
            ],
            "title": "A novel resource allocation algorithm in uplink multi-cell OFDMA networks based on game theory",
            "venue": "2011 International Conference on Wireless Communications and Signal Processing (WCSP), 2011, pp. 1-4.",
            "year": 2011
        },
        {
            "authors": [
                "R. Rathi",
                "N. Gupta"
            ],
            "title": "Device to Device Communication using Stackelberg Game Theory approach",
            "venue": "2020 Research, Innovation, Knowledge Management and Technology Application for Business Sustainability (INBUSH), 2020, pp. 100-103.",
            "year": 2020
        },
        {
            "authors": [
                "I.K. Son",
                "S. Mao",
                "M.X. Gong",
                "Y. Li"
            ],
            "title": "On frame-based scheduling for directional mmWave WPANs",
            "venue": "Proc. INFOCOM 2012 (Orlando, FL, USA), Mar. 25-30, 2012, pp. 2149\u20132157.",
            "year": 2012
        },
        {
            "authors": [
                "L.X. Cai",
                "L. Cai",
                "X. Shen",
                "J.W. Mark"
            ],
            "title": "Rex: A randomized EXclusive region based scheduling scheme for mmWave WPANs with directional antenna",
            "venue": "IEEE Trans. Wireless Commun., vol. 9, no. 1, pp. 113\u2013121, Jan. 2010.",
            "year": 2010
        },
        {
            "authors": [
                "J. Qiao",
                "L.X. Cai",
                "X. Shen",
                "J.W. Mark"
            ],
            "title": "STDMA-based scheduling algorithm for concurrent transmissions in directional millimeter wave networks",
            "venue": "Proc. ICC 2012 (Ottawa, ON, Canada), Jun. 10-15, 2012, pp. 5221\u20135225. 13",
            "year": 2012
        },
        {
            "authors": [
                "G. Yang",
                "J. Du",
                "M. Xiao"
            ],
            "title": "Maximum throughput path selection with random blockage for indoor 60 GHz relay networks",
            "venue": "IEEE Transactions on Communications, vol. 63, no. 10, pp. 3511-3524, Oct. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "D. Pisinger"
            ],
            "title": "Where are the hard knapsack problems?",
            "venue": "Computers & Operations Research,",
            "year": 2005
        },
        {
            "authors": [
                "Q. Chen",
                "X. Peng",
                "J. Yang",
                "F. Chin"
            ],
            "title": "Spatial reuse strategy in mmWave WPANs with directional antennas",
            "venue": "Proc. GLOBECOM 2012 (Anaheim, CA, USA), Dec. 3-7, 2012, pp. 5392\u20135397.",
            "year": 2012
        },
        {
            "authors": [
                "W. Saad"
            ],
            "title": "Coalitional game theory for communication networks",
            "venue": "IEEE Signal Processing Mag., vol. 26, no. 5, pp. 77\u201397, Sep. 2009.",
            "year": 2009
        },
        {
            "authors": [
                "I. Toyoda",
                "T. Seki",
                "K. Iigusa"
            ],
            "title": "Reference antenna model with side lobe for TG3c evaluation",
            "venue": "IEEE 802.15-06-0474-00-003c, Nov. 2006.",
            "year": 2006
        },
        {
            "authors": [
                "Y. Niu"
            ],
            "title": "Energy-Efficient Scheduling for mmWave Backhauling of Small Cells in Heterogeneous Cellular Networks",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 66, no. 3, pp. 2674-2687, March 2017.",
            "year": 2017
        },
        {
            "authors": [
                "Y. Chen",
                "Y. Niu",
                "B. Ai",
                "Z. Zhong",
                "D. Wu",
                "K. Li"
            ],
            "title": "Using Coalition Games for QoS Aware Scheduling in mmWave WPANs",
            "venue": "2018 IEEE 87th Vehicular Technology Conference (VTC Spring), 2018.",
            "year": 2018
        },
        {
            "authors": [
                "X. Zhou"
            ],
            "title": "Deep Reinforcement Learning Coordinated Receiver Beamforming for Millimeter-Wave Train-Ground Communications",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 71, no. 5, pp. 5156- 5171, May 2022.",
            "year": 2022
        },
        {
            "authors": [
                "L. Yan",
                "X. Fang",
                "X. Wang",
                "B. Ai"
            ],
            "title": "AI-Enabled Sub-6-GHz and mm-Wave Hybrid Communications: Considerations for Use With Future HSR Wireless Systems",
            "venue": "IEEE Vehicular Technology Magazine, vol. 15, no. 3, pp. 59-67, Sept. 2020.",
            "year": 2020
        },
        {
            "authors": [
                "M. Gao",
                "B. Ai",
                "Y. Niu",
                "Z. Han",
                "Z. Zhong"
            ],
            "title": "IRS-Assisted High-Speed Train Communications: Outage Probability Minimization with Statistical CSI",
            "venue": "ICC 2021 - IEEE International Conference on Communications, 2021.",
            "year": 2021
        },
        {
            "authors": [
                "Y. Cao"
            ],
            "title": "Enhancing video QoE over high-speed train using segment-based prefetching and caching",
            "venue": "IEEE MultiMedia, vol. 26, no. 4, pp. 55\u201366, Oct.-Dec. 2019.",
            "year": 2019
        },
        {
            "authors": [
                "Y. Liu"
            ],
            "title": "Exploiting multi-hop relay to achieve mobility-aware transmission scheduling in mmWave systems",
            "venue": "Proc. ICC 2018 (Kansas City, MO, USA), May 20-24, 2018, pp. 1\u20136.",
            "year": 2018
        },
        {
            "authors": [
                "X. Wan",
                "X. Guan",
                "J. Wang",
                "M. Zhao"
            ],
            "title": "Time slotted scheduling for outdoor mmWave mesh networks with performance guarantee",
            "venue": "Proc. ICNC 2017 (Silicon Valley, CA, USA), Jan. 26-29, 2017, pp. 224\u2013229.",
            "year": 2017
        },
        {
            "authors": [
                "Y. Niu"
            ],
            "title": "Energy-efficient scheduling for mmWave backhauling of small cells in heterogeneous cellular networks",
            "venue": "IEEE Trans. Vehicular Technology, vol. 66, no. 3, pp. 2674\u20132687, Mar. 2017.",
            "year": 2017
        },
        {
            "authors": [
                "Y. Niu"
            ],
            "title": "Exploiting device-to-device communications in joint scheduling of access and backhaul for mmWave small cells",
            "venue": "IEEE J. Sel. Areas Commun., vol. 33, no. 10, pp. 2052\u20132069, Oct. 2015.",
            "year": 2015
        },
        {
            "authors": [
                "Y. Zhu J. Li",
                "Q. Huang",
                "D. Wu"
            ],
            "title": "Regret benefit ratio link scheduler for wireless backhaul with directional antennas",
            "venue": "IEEE Trans. Vehicular Technology, vol. 66, no. 11, pp. 10220\u201310232, Nov. 2017.",
            "year": 2017
        },
        {
            "authors": [
                "J. Li",
                "Y. Zhu",
                "D.O. Wu"
            ],
            "title": "Practical distributed scheduling for QoSaware small cell mmWave mesh backhaul network",
            "venue": "Ad Hoc Networks, vol. 55, pp. 62\u201371, Feb. 2017.",
            "year": 2017
        }
    ],
    "sections": [
        {
            "text": "Index Terms\u2014Millimeter-wave communications, game theory, full-duplex communications, user association, transmission scheduling.\nI. INTRODUCTION As a vital part of the transport infrastructure, high-speed railway (HSR) has been developing rapidly in the recent years. By June 2018, the total operational mileages of HSRs in\nThis study was supported by National Key R&D Program of China (2020YFB1806903); in part by the National Key Research and Development Program under Grant 2021YFB2900301; in part by the National Natural Science Foundation of China Grants 62221001, 62231009, 61725101, 61961130391, and U1834210; in part by the Fundamental Research Funds for the Central Universities (Science and technology leading talent team project) 2022JBXT001; in part by the Fundamental Research Funds for the Central Universities, China, under grant number 2022JBQY004.\nX. Zhang, T. Yang, X. Xiao and J. Ding are with the State Key Laboratory of Rail Traffic Control and Safety, and also with the Frontiers Science Center for Smart High-speed Railway System, Beijing Jiaotong University, Beijing 100044, China (e-mails: zxfei78@163.com, 18211241@bjtu.edu.cn, 18211205@bjtu.edu.cn, jwding@bjtu.edu.cn).\nY. Niu is with the State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University, Beijing 100044, China, and also with the National Mobile Communications Research Laboratory, Southeast University, Nanjing 211189, China (e-mail: niuy11@163.com).\nSheng Chen is with the School of Electronics and Computer Science, University of Southampton, Southampton SO17 1BJ, U.K. (e-mail: sqc@ecs.soton.ac.uk).\nZ. Zhong and B. Ai are with the State Key Laboratory of Rail Traffic Control and Safety, and also with the Beijing Engineering Research Center of High-speed Railway Broadband Mobile Communications, Beijing Jiaotong University, Beijing 100044, China (e-mails: boai@bjtu.edu.cn; zhdzhong@bjtu.edu.cn).\nN. Wang is with the School of Information Engineering, Zhengzhou University, Zhengzhou 450001, China (e-mail: ienwang@zzu.edu.cn).\nthe world has reached 49,000km with additionally more than 16,000km under construction [1]. Many countries, including China, Japan, Germany and so on, have already operated trains with speeds exceeding 200km/h.\nOn the other hand, since many passengers are accustomed to broadband wireless access in their daily living environment, more and more people hope to have high-quality broadband wireless access on mobile terminals. However, in the HSR scenarios, the high-speed of train causes frequent handovers. When the cell radius is 1 to 2km, the train running at 350km/h will handover every 20 to 40s [2]. In addition, the rapid relative movement between the train and track-side base station (BS) causes more serious Doppler shift and smaller channel coherence time. So the wireless channel in HSR scenarios has obvious non-stationary and fast time-varying characteristics, which seriously reduces the performance of train-ground communication systems [3]. Moreover, due to the complexity and non-stationarity of HSR scenarios, there are weak field strength and blind areas, and the train body of metal material causes great penetration loss to the signal from the BS [4]. Therefore, meeting passengers\u2019 compelling demand for broadband mobile communications in the HSR environment has become a key technical challenge. It has become particularly important to carry out research on broadband wireless communication technologies in HSR scenarios. However, the current widely-used communication technologies under HSR scenarios, such as Global System for Mobile Communications for Railways (GSM-R), can only support a rate that is too low to meet user\u2019s increasing demands for multimedia applications, and the current demand rate of each train is about 37.5Mbps [5]. With the growth of business and entertainment activities and quality of service (QoS) demands, the demand rate may easily reach 0.5\u20135Gbps in the near future [6]. Obviously, the current wireless transmission scheme will be inadequate to satisfy the needs of HSR passengers.\nTo this end, industry and academia have started to exploit the 30-300 GHz millimeter-wave (mm-wave) frequency band. Owing to its wide bandwidth and rich spectrum resources, it is not only consistent with the current development trend of wireless communication systems, but also able to meet the demand of multi-gigabit wireless services such as online gaming, video calling and so on [7], which the current communication systems for railways like GSM-R and Long Term Evolution for Railways (LTE-R) can\u2019t provide. Thus, mmwave communications are regarded as a promising technology to meet the growing network capacity requirements caused by the rapid development in the HSR industry [8] [9].\nBut compared with the communication systems of lower\nar X\niv :2\n30 8.\n10 18\n6v 1\n[ cs\n.I T\n] 2\n0 A\nug 2\n02 3\n2 frequency band, mm-wave communication suffers from greater propagation loss. Because the free space path loss (FSPL) is proportional to the square of the carrier frequency, the FSPL in 60 GHz is 28 decibels (dB) higher than that in 2.4GHz [10]. In order to compensate for strong link attenuation, mm-wave communication uses directional antenna to achieve beamforming for improving antenna gain. At the same time, due to the short wavelength of mm-wave and the relatively small size of the antenna array, we can deploy mobile relays (MRs) on the roof of the train, which can overcome the huge penetration loss caused by the train body. Furthermore, the full-duplex (FD) communication technology allows wireless communication devices to simultaneously transmit and receive signals on the same frequency band, and the capacity of the communication system can be doubled theoretically [13]. Therefore, FD technology is regarded as one of the key physical layer technologies of 5G. The biggest challenge of FD communication is the elimination of self interference (SI), which is caused by the signal leakage from the sending end to the corresponding receiving end [11] [12].\nTherefore, it would be desirable for the MRs to adopt both the mm-wave and FD technology, and simultaneously serve HSR passengers and ground users. The track-side BS allocates part of the bandwidth to the MRs, allowing some users to directly communicate with the track-side BS in a traditional manner, and other users to be associated with the MRs to obtain wireless access. At this time, determining the user association mechanism in the investigated train-ground communication system is a key challenge, and proposing an effective user association scheme to maximize the number of users whose QoS requirements are satisfied is the focus of this paper. If mm-wave communication and FD technology can be applied to the train-ground communication system in the HSR scenarios, high-rate transmission can be achieved between the BS and MR to significantly improve the communication service performance [14].\nHowever, the current research on the application of mmwave communication and FD technology to train-ground communications are very limited. In this paper, we study the problem of user association in the mm-wave train-ground communication system, in which the MR adopts FD mode. We focus on the cooperation between track-side BS and FD MR in user association to optimize system performance, especially to maximize the system throughput and the number of users meeting QoS requirements. To this end, we propose a user association optimization scheme based on coalition game theory. In this scheme, each player will try its best to achieve the maximum system throughput. Then we propose a transmission scheduling algorithm to maximize the number of users whose QoS requirements are satisfied. The main contributions made in this paper are summarized as follows.\n\u2022 Mm-wave communications and FD technology are combined to improve the capacity of train-ground communication system in HSR scenarios. \u2022 A low complexity user association and transmission scheduling algorithm is proposed to reduce the implementation complexity while ensuring the network capacity is at a high level.\n\u2022 We focuse on users\u2019 QoS requirements to improve user communication experience in HSR scenarios.\nFirstly, HSR communications are still based on GSM-R at present. The mm-wave band with rich spectrum resources can fundamentally solve the problem of lack of wireless resources in HSR scenarios, and FD technology has the potential to double communication capacity in theoretically. Therefore, we combined mm-wave communications and FD technology to build a new train-ground wireless communication framework to significantly improve transmission performance in HSR scenarios.\nSecondly, considering the fast time-varying of channels and frequent handoff in HSR scenarios, the optimization algorithm that require complex iteration is no longer applicable to the communication problem in HSR scenarios. Therefore, we proposed a low complexity user association algorithm based on coalition game theory, and theoretically prove its convergence and stability. At the same time, we proposed a greedy algorithm for transmission scheduling to further improve capacity performance. The proposed user association and transmission scheduling algorithms both ensure the system performance and reduce the implementation complexity, making them more suitable for application in HSR scenarios.\nThirdly, different from the most existing user association researches, we pay more attention to the users\u2019 QoS requirements in the HSR scenarios. Our goal is to schedule as many data flows as possible while meeting the users\u2019 QoS requirements, rather than just to increase system capacity, and the proposed algorithm will effectively improve the user communication experience in the HSR scenarios.\nThe rest of the paper is organized as follows. In Section II, we provide an detailed overview of the related work. Section III introduce the train-ground communication system model, and Section IV formulate the problem of user association. The proposed user association scheme based on coalition game theory and transmission scheduling algorithm are presented in Section V and evaluated in Section VI. The conclusions of this paper are drawn in Section VII."
        },
        {
            "heading": "II. RELATED WORK",
            "text": "We can classify the related works into three categories: (a) mm-wave communications in wireless networks; (b) FD communications in wireless networks; and (c) application of game theory into resource allocation. We examine these related work in this section.\na) Mm-wave Communications: There has been considerable research on mm-wave based wireless communications and networks. Most of these researches focus on 28GHz, 38GHz, 60GHz and E-band (71-76GHz and 81-86GHz). The rapid development of complementary metal oxide semiconductor (CMOS) in radio frequency integrated circuits has paved the way for electronic products in mm-wave band [15]. At the same time, several international standards for indoor wireless personal area network (WPAN) and wireless local area network (WLAN), such as ECMA-387, IEEE 802.15.3c and IEEE 802.11ad, have been developed.\nIn terms of the propagation characteristics of mm-wave, Singh et al. mentioned that the FSPL of 60GHz mm-wave\n3 is 28dB higher than that of 2.4GHz [16]. At the same time, the authors of [17] pointed out that mm-wave is more sensitive to being blocked by obstacles. For these problems, considering that high-speed trains (HSTs) generally operate in rural areas and viaducts, the buildings in the HSR scenarios are short and sporadic, which reduces the probability of mm-wave being blocked. In addition, when the MR is installed on the roof of the train, the directional characteristics of mm-wave can be further utilized, while avoiding the huge penetration loss caused by the train body [18] [19]. Theiss et al. analyzed the propagation characteristics of the mm-wave in the HSR scenarios, and showed the measurement results from the mm-wave transceiver prototype in the Japanese Shinkansen environment [20]. Subsequently, He et al. analyzed the influence of many typical objects in the HSR scenarios on mmwave propagation, obtained the corresponding electromagnetic parameters, and established a mm-wave channel model closed to the real train-ground communications [21]. Yuan et al. proposed a profit-maximized collaborative computing offloading and resource allocation algorithm based on an architecture including terminal, edge computing, and cloud data centers (CDC) layers, but the introduction of edge computing into the mm-wave train ground communication system may increase the end-to-end delay [22]. However, due to the difficult propagation characteristics of mm-wave and the particularity of HSR scenarios, there are still many challenges ahead.\nb) FD Communications: FD wireless communications have also attracted much efforts in the research community in the past decade. For example, Chen et al. uses the FD jamming receiver to assist the multi-antenna transmitter to realize covert communications, and the proposed scheme maximizes the system throughput while ensuring covertness [23]. Cao et al. explored the downlink non-orthogonal multiple access system assisted by multi-antenna FD relay, and proposed a twostage interference scheme, which significantly improved the security performance [24]. Li et al. combined FD technology and physical layer coding in the two-way relay channel, and proposed two transmission schemes, which improved the system throughput and reduced the time slot required for unit information transmission [25]. Cheng et al. proposed a request to send and FD clear to send based media access control (MAC) protocol, which can support two-way and one-way links in a wireless FD network, achieving higher normalized system throughput [26]. In addition, Kai et al. formulated the joint optimization problem of tarnsmission scheduling and power control in a three-node FD WLAN, and proposed an efficient algorithm based on alternating optimization and successive convex approximation with low complexity [27].\nThe toughest challenge of FD communications is the cancellation of SI caused by the signal leakage from the transmitter of a terminal to the receiver of the same terminal [28]. In order to realize the high spectral efficiency, the SI has to be reduced by 110dB with the help of antenna separation, analogdomain and digital-domain cancellation [29]. At the same time, due to the directional transmission characteristics of mmwave communications, the directivity of the transmitting and receiving beams can naturally reduce the SI [30]. In order to achieve the theoretical double system throughput, Nidal\net al. proposed a scheme to restrain SI by using a reflective array [31].\nThe related work show that FD communications have great research value in cellular networks, WiFi networks, mmwave networks and heterogeneous networks. However, there are still few applications of FD in HSR scenarios. In the train-ground communication system model established in this paper, we exploit the advantages of FD technology and mmwave communications, which can jointly bring about huge improvements on network capacity and user experience.\nc) Game Theory based Resource Allocation: Considering the inherent problems such as fast time-varying of channels and frequent handoff in HSR scenarios, the optimization algorithms that used to require complex iteration are no longer applicable to the train-ground communications in HSR scenarios, especially once new users enter the system, the previous experience will lose its effectiveness. To address the dual requirements of normal and quick-response ISL schedulings, a data-driven heuristic assisted memetic algorithm (DHMA) is proposed by Du et al.. The main idea of it is to address normal and quick-response schedulings separately, while high-quality normal scheduling data are also trained for quick-response use [32]. However, this method relies on large data sets, and mm-wave communication has not been applied to the trainground communication system in HSR scenarios at present, so the lack of data sets makes this method not applicable in HSR scenarios. To improve the real-time performance of networked control systems, the joint problem of message fragmentation and no-wait scheduling is explored by Jin et al. [33]. The proposed algorithm is based on optimization module theory, which is not suitable for train-ground communication in HSR scenarios with fast time-varying channels because of its high complexity. To provision high-speed Internet services in HSTs, Taheri et al. proposed a novel solution named Free-space OptiCs Utilization in high-Speed trains (FOCUS). However, the authors did not consider meeting the QoS requirments of different users [34].\nGame theory has been widely applied in wireless networks to improve the utilization of limited resources. For example, the authors of [36] proposed a time resource sharing scheme based on Stakelberg game, in which the D2D links that cause interference can only access the time resources by paying a higher price, and it can realize distributed power control to reduce interference and improve the network throughput. Paik et al. formulated the downlink resource allocation problem in the multi-cell OFDMA system as a non-cooperative game, and proposed a coalition game based scheme using adaptive modulation and coding to maximize system capacity [37]. Wang et al. proposed a novel resource allocation algorithm based on game theory in the full-frequency multiplexing OFDMA system, and established a non-cooperative game model based on the arctangent function, which achieved lower complexity while ensuring network capacity [38]. The authors of [39] discussed the influence of Stackelberg game on system performance when optimizing radio resource allocation in heterogeneous networks, and the established game theory model provides guidance for exploring more efficient resource allocation schemes.\n4\nIt can be concluded that in the existing works, there is a paucity of contributions on user association for mm-wave train-ground communication systems with FD MR as well as transmission scheduling of data flows in HSR scenarios. These motivate our research."
        },
        {
            "heading": "III. SYSTEM MODEL",
            "text": "This paper considers a mm-wave train-ground communication system using FD MR, as shown in Fig. 1. In this model, the track-side BS reserves part of the bandwidth resources, and the remaining bandwidth is allocated to MR, and the two parts of bandwidth resources are mutually exclusive. All the devices in this train-ground communication system work in the mm-wave frequency band. In addition, both the BS and MR are equipped with directional antennas, and transmit and receive beamforming are allowed to achieve higher mm-wave directional gain. Ground users and passengers in the HST can choose to directly communicate with the BS in a traditional manner, or use MR to achieve two-hop transmission, so there are problems with user association and transmission scheduling. Assuming that the bandwidth allocation ratio of track-side BS and MR has been predetermined, we hope to find the optimal user association mechanism to achieve high network capacity and make the number of users meeting the QoS requirements as many as possible.\nWe adopt the frame structure of the MAC layer [40] which is illustrated in Fig. 2. Each superframe consists of a scheduling phase and a transmission phase. During the scheduling phase, the BS or MR receives the QoS request for each flow and makes the scheduling decision, which is then broadcasted to the entire network. During the transmission phase, the frame is further divided into M equal time slots. At each time slot, the data flow can be transmitted based on scheduling decisions\nmade during the scheduling phase. Depending on the user association and scheduling decision, some users in the system receive services through the BS, and others receive services through the MR. Multiple users associated with BS or MR use the TDMA mode to access the network. Considering that each user has certain QoS request, which is described by its throughput requirement in this paper, the BS and MR work jointly to satisfy the user\u2019s QoS request through transmission scheduling.\nFirst of all, we assume that there are N flows requesting transmission time slots in the superframe. Since each time slot can only be occupied by one flow, we have N \u2264 M . For flow i, we denote its sender and receiver by si and ri, respectively. The distance between si and ri is denoted by li. We also denote the transmitting antenna gain of si in the direction of si to ri by Gt(si, ri), and the receiving antenna gain of ri in the direction of ri to si by Gr(ri, si). According to the path loss model [41], the received signal power at ri for the signal transmitted from si to ri can be calculated as\nPr(i) = k0 \u00b7Gt(si, ri) \u00b7Gr(ri, si) \u00b7 l\u2212ni \u00b7 Pt(i), (1)\nwhere Pt(i) is the transmission power of flow i, k0 is a constant that is proportional to (\u03bb/4\u03c0)2 with \u03bb denoting the signal wavelength, and n is the path loss exponent [41] [42]. Then the received signal-to-noise power ratio (SNR) of flow i can be calculated as\nSNRi = Pr(i)\nN0W = k0 \u00b7Gt(si, ri) \u00b7Gr(ri, si) \u00b7 l\u2212ni \u00b7 Pt(i) N0W ,\n(2)\nwhere W is the bandwidth, and N0 is the unilateral noise power spectral density of the Gaussian channel [42]. Therefore the achievable data rate of flow i according to the Shannon\u2019s channel capacity can be expressed as\nRi = \u03b7 \u00b7W \u00b7 log2 ( 1 + Pr(i)\nN0W\n) , (3)\nwhere \u03b7 \u2208 (0, 1) describes the efficiency of the transceiver design. If the number of time slots allocated to flow i is \u03b4i, the achieved throughput of flow i can be expressed as\nqi = Ri \u00b7 \u03b4i M . (4)\nwhere M denotes the number of time slots of the transmission phase.\nBecause the MR adopts the FD mode, it causes a certain amount of SI (i.e., due to imperfect SI cancellation). As shown\n5\nin Fig. 3, the so-called SI refers to the interference at the MR receiver caused by its own transmitter. Let the MR\u2019s transmission power be Pt, then the SI power can be modeled as \u03b2 \u00b7Pt, where \u03b2 represents the SI cancellation level. Therefore, if receiver ri of flow i is the MR with FD mode, then the achievable data rate of flow i should be modified as\nRi = \u03b7 \u00b7W \u00b7 log2 ( 1 +\nPr(i)\nN0W + \u03b2 \u00b7 Pt(i)\n) . (5)"
        },
        {
            "heading": "IV. PROBLEM FORMULATION",
            "text": "In this paper, efficient transmission scheduling is achieved by maximizing the number of users whose QoS requests are met. Therefore, we establish an optimization problem with user association and user time slot scheduling as decision variables, aiming to maximize the number of users who meet the condition. As aforementioned, there are N flows to be transmitted with M available time slots. The scheduler partitions the superframe into K pairings, where a pairing is defined as several consecutive time slots. For each flow i, we define a binary variable \u03b1ki to indicate whether flow i is scheduled in the kth pairing. Specifically, if flow i is scheduled in the kth pairing, \u03b1ki = 1, otherwise \u03b1 k i = 0. The number of time slots in the kth pairing is denoted by \u03b3k. Given the total bandwidth W , the BS is allocated with the bandwidth a \u00b7W and the MR with the bandwidth b \u00b7W , where a + b = 1. Further define two binary variables \u00b5i and \u03bbi, and \u00b5i indicates whether flow i is associated with the BS. specifically, \u00b5i = 1 indicating that flow i is associated with the BS, otherwise \u00b5i = 0. Similarly, if flow i is associated with the MR, the indicator \u03bbi = 1, otherwise \u03bbi = 0. To show how we calculate the transmission rates of different links, consider\nTaking into account the RSI at FD MR, the transmission rate over the link lcei that flow i is sent from BS c to MR e can be expressed as\nRki(c\u2192e) = \u03b7 \u00b7 b \u00b7W log2\n( 1+ \u03b1ki k0Gt(c, e)Gr(e, c)l \u2212n ceiPt(i)\nN0 \u00b7 b \u00b7W + \u03b2 \u00b7 Pt(i)\n) .\n(7)\nSimilarly, it is assumed that the transmission power of BS and MR is Pt, then the transmission rate over the link lefi that flow i is sent via MR e to user f can be expressed as\nRki(e\u2192f)= \u03b7 \u00b7 b \u00b7W \u00b7 log2\n( 1+ \u03b1ki k0Gt(e, f)Gr(f, e)l \u2212n efi Pt(i)\nN0 \u00b7 b \u00b7W + \u03b2 \u00b7 Pt(i)\n) .\n(8)\nHence, the rate of flow i, sent from BS via MR to user, is RkMR,i = min { Rki(c\u2192e), R k i(e\u2192f) } . (9)\nLet the required throughput for flow i be Qi, and denote the actual throughput for flow i as qi, therefore we have\nqi =\n\u2211K k=1 ( \u00b5i \u00b7RkBS,i + \u03bbi \u00b7RkMR,i ) \u00b7 \u03b3k\nM . (10)\nWe further define a binary variable Ii to indicate whether the actual throughput qi achieved for flow i meets the QoS requirement Qi, specifically,\nIi = { 1, qi \u2265 Qi, 0, qi < Qi.\n(11)\nwhere the QoS requirement here is defined as the minimum throughput requirement of the data flow.\nGiven the QoS requirements Qi for all the N flows, 1 \u2264 i \u2264 N . Since the number of time slots M in the transmission phase is limited, the optimal scheduling should accommodate as many flows as possible. Therefore, our goal is to maximize the number of flows that satisfy their QoS requirements, and the objective function can be expressed as\nmax N\u2211 i=1 Ii. (12)\nNext we analyze the constraints of this optimal transmission scheduling. First, each pairing of the superframe can only be occupied by a flow once, and therefore\nK\u2211 k=1 \u03b1ki = 1, \u2200i. (13)\nSecond, there are only M time slots in the superframe, so we have\nK\u2211 k=1 \u03b3k \u2264 M. (14)\nThird, flow i can only be associated with either the BS or the MR, not the both, that is,{\n\u00b5i + \u03bbi = 1 \u00b5i \u00b7 \u03bbi = 0 , \u2200i. (15)\nWe utilize the simple example as shown in Fig. 5 to illustrate the basic idea of our optimal transmission scheduling strategy. There are five nodes uniformly distributed in a square area of\n6\n10m \u00d7 10m, and they are denoted by A, B, C, D and E, respectively. There are M = 10 time slots in the superframe, and N = 5 flows in the network to be scheduled. To meet the throughput requirements, 8 time slots are needed for the flow O \u2192 A, 3 time slots for the flow O \u2192 B, 1 time slot for the flow O \u2192 C, 2 time slots for the flow O \u2192 D, and 4 time slots for the flow O \u2192 E. Without transmission scheduling and simply carrying out the transmission scheduling for the 5 flows in the order of A, B, C, D, and E, only one flow, A, can meets its QoS requirement. To maximizing the number of flows that can meet their QoS requirements, the flow scheduling should be carry out according to the required time slots for meeting the required throughput in the order of low to high, that is, the transmission scheduling should be C, D, B, E and A. It can be seen that with this transmission scheduling, four flows, namely B, C, D and E, can meet their QoS requirements.\nConsidering the height of the MRs, the link between the MRs and the ground BS can be regarded as line-of-sight (LOS) transmission, and the railway is generally located in spacious scenarios, so it is considered that the blockages are mainly caused by human body. We consider that in the investigated mm-wave train-ground communication system, the blockage problem caused by human body can be solved in three steps. In the first step, we connect the users to the nearest BS or MR, and propose an average outage probability Pb for all links, which note that each link has a random probability of experiencing blockage. In the second step, if the communication link between the user and the associated equipment experiences blockage, this user will re-establish an association relationship with the second closest equipment to actively avoid blockage. In the third step, we study the scenario of non-LOS (NLOS) transmission, which can be enhanced with the assist of intelligent reflecting surface (IRS) and Device-to-Device (D2D) communications. In this paper, for analytical simplicity, it is assumed that the link blockage probability remains stable in a road segment. The link blockage probability Pb on average is deemed as a constant in a certain section along the rail track [43].\nIn summary, the problem of optimal user association and transmission scheduling, denoted by P1, can be formulated as\nfollows.\n(P1) max (1\u2212 Pb) N\u2211 i=1 Ii (16)\ns.t. Constraints (13) to (15).\nBecause the data transmission rate of each flow includes a logarithmic function, the objective function is nonlinear. So P1 is a mixed integer nonlinear programming problem with binary variable Ii. Considering that the user\u2019s location, QoS requirements, and the gain of the channel formed by connecting with BS and MR will jointly decide the best user association scheme in the established train-ground communication system, it is more complex than the 0-1 knapsack problem [44], so P1 is an NP-hard problem, and difficult to solve in polynomial time [29]. In the next section, we introduce a coalition game theory based algorithm to solve problem (P1) with competitive solutions."
        },
        {
            "heading": "V. COALITION GAME BASED ALGORITHMS",
            "text": "In this section, we will introduce the coalition game from the view point of game theory to solve the problem of user association. Coalition formation game is a subcategory of the cooperative game theory, which is able to determine how users cooperate to achieve the optimal system throughput. After that, a sorting algorithm is proposed to solve the problem of optimal transmission scheduling."
        },
        {
            "heading": "A. Coalition Formation: Model",
            "text": "To tackle the optimization problem formulated in the Section IV, we will introduce a coalition game model, where the flows form coalitions to improve the system utility. In our investigated system, there are N flows, and the flows can choose to associate either with the BS or with the MR. Hence, there are two coalitions, and we denote them by F1 and F2. Specifically, F1 represents the set of flows associated with the BS, while F2 represents the set of flows associated with the MR. Clearly, for our entire coalition F = {F1,F2}, we have\nF1 \u2229 F2 = \u2205, (17)\n7 |F| = |F1|+ |F2| = N, (18)\nwhere \u2223\u2223F\u2223\u2223 denotes the cardinality of the set F .\nRecall that the transmission rate RkBS,i over the link that flow i is sent from the BS to a user is given by (6). Thus the sum rate associated with the coalition F1 is\nR ( F1 ) = N\u2211 i=1 RkBS,i. (19)\nAlso the transmission rate RkMR,i over the link that flow i is sent via the MR to a user is given by (7) to (9). Hence the total throughput associated with the coalition F2 is\nR ( F2 ) = N\u2211 i=1 RkMR,i. (20)\nR ( F1 ) and R ( F2 )\nrepresents the sum profits contributed by the entire coalition F with the particular coalition partition of F1 and F2. Hence, the user association model with resource sharing relations for our investigated mm-wave train-ground communication system is established in a coalition game with transferable utility. In this model, the data flows, as players, tend to form a coalition to associate either with the BS or with the MR, in order to maximize the total profit of the system."
        },
        {
            "heading": "B. Coalition Formation: Algorithm",
            "text": "In this section, We will propose a coalition formation algorithm based on the coalition formation game. One key point to coalition formation is what strategy to adopt by each flow. An efficient coalition formation algorithm should be able to compare the sum profits of the coalitions and to find a suitable coalition for each flow to join so as to achieve the optimization goal. Thus, we first introduce the concept of preference order to enable the comparison of the profits for different coalitions.\nDefinition 1 (preference order): For any flow i \u2208 N = {1, 2, \u00b7 \u00b7 \u00b7 , N}, the preference order \u227bi is defined as a complete, reflexive, and transitive binary relation over the set of all the coalitions that flow i can possibly form.\nTherefore, the flows in our coalition game have the right to choose to join or leave a coalition according to their preference order, and they tends to join a coalition based on which it prefers to being a member. For any given flow i \u2208 N , Fc \u227bi Fc\u0304 implies that flow i is more willing to be a member of the coalition Fc, that is, i \u2208 Fc, than with Fc\u0304, which does not include the case that flow i prefers these two coalitions equally. In different applications, the preferences for flows can be quantified in different way. In this paper, we adopt the utilitarian preference order [46].\nDefinition 2 (utilitarian preference order): For any flow i \u2208 N = {1, 2, \u00b7 \u00b7 \u00b7 , N}, the utilitarian preference order is defined by the following equivalence:\nFc \u227bi Fc\u0304 \u21d4 R ( Fc ) +R ( Fc\u0304 \\ i ) > R ( Fc \\ i ) +R ( Fc\u0304 ) . (21)\nIn other words, flow i prefers to be a member of coalition Fc than Fc\u0304 under the condition of increasing the sum system throughput.\nWhen flow i \u2208 N performs a switching from Fc to Fc\u0304, the original partition F = { Fc,Fc\u0304 } is changed to the new\npartition F \u2032 = { Fc \\ {i},Fc\u0304 \u22c3 {i} }\n. The switching can occur if and only if the preference order as defined in (21) is satisfied.\nIn our proposed algorithm based on the coalition game, we first initialize the system by a random coalition partition with two coalitions Fc and Fc\u0304. For any flow i \u2208 N , we denote its present coalition by Fc. If Fc\u0304 \u227bi Fc, there will be a switching of flow i from Fc to Fc\u0304, and the current coalition partition F = { Fc,Fc\u0304 } will be updated to the new partition\nF \u2032 = { Fc \\ {i},Fc\u0304 \u22c3 {i} }\n. In this mechanism, every flow i can leave its current coalition and join the other coalition, given that the new coalition is strictly preferred based on the definition in (21) and the flow can make a greater contribution to the system performance in terms of throughput in the new coalition. It\u2019s worth noting that our proposed algorithm based on coalition formation game needs to find a coalition structure that maximizes the total utility rather than the individual payoffs of the players.\nThe pseudo code of the proposed coalition game based algorithm is given in Algorithm 1, which contains a user association algorithm for maximizing system throughput, and a transmission scheduling algorithm for maximizing the number of users meeting QoS requirements. More specifically, Algorithm 1 first initializes the parameters, and collects the set of flows that need to be scheduled in the current time slot, as well as the QoS requirements of each flow. Secondly, the proposed algorithm divides all flows into two coalitions randomly. Then, take a flow as the target, calculate R ( Fc ) , R ( Fc\u0304 ) , R ( Fc\\{i}\n) and R ( Fc\u0304 \u22c3 {i} ) . If the system sum rate when the current flow stays in the current coalition is greater than that when it is moved to another coalition, the current flow will stay in the current coalition, as shown in lines 6 and 7 of Algorithm 1. The user association phase of the proposed algorithm is not completed until all flows have made the above judgments in turn. In the transmission scheduling phase, the proposed algorithm arranges each flow from small to large according to its QoS requirements, finds the maximum Nsuc flows with the required time slots less than M , and then transmits them.\nFirstly, according to the QoS requirements, the amount of time slots required by each flow are obtained. Then the user association either with BS or with MR is determined according to the coalition formation algorithm. After the convergence of the algorithm, the flows are sorted according to their required numbers of time slots to meet their QoS requests from small to large. By prioritizing the flows with smaller time slots requirement during transmission scheduling, the number of the flows that satisfy their QoS requests is maximized.\nThe condition to terminate the algorithm is that the partition converges to the Nash-stable partition. If \u2200i \u2208 N , i \u2208 Fc \u2282 F , Fc \u227bi Fc\u0304 \u22c3 {i}, where Fc\u0304 \u22c3 Fc = F and Fc\u0304 \u22c2 Fc = \u2205, then the partition F = {Fc,Fc\u0304} is Nash-stable. Starting from any initial coalition structure Fini, the proposed coalition formation algorithm will always converge to a final partition Ffin that is Nash-stable, after a sequence of switching operations. We will give related theoretical proofs in Section V-C.\nWe then analyze the complexity of Algorithm 1. In a specific time slot, the established train-ground communication system can be regarded as temporarily static, i.e., the coalition of each flow is determined (not necessarily the optimal situation).\n8 The computational complexity of the sum rate of the coalition formed by the flows associated with BS is O(nB), and that of the coalition formed by the flows associated with MR is O(nM ). At this time, considering the decision operation shown in the line 6 of Algorithm 1, the complexity corresponding to the user association phase is O(N \u00b7 (nB \u00b7 nM + 1)). Then, the computational complexity of directly sorting the QoS requirements corresponding to data flows at one time is O(nts). Considering that the worst case of determining Nsuc requires N times of judgment, the complexity in the data transmission phase is O(nts+N). To sum up, the computational complexity of Algorithm 1 is O(N(nB + nM + 2) + nts)."
        },
        {
            "heading": "C. Theoretical Analysis",
            "text": "1) Convergence: We first examine the convergence of the proposed algorithm theoretically.\nTheorem 1: With an arbitrary initial partition Fini, after the limited switching operations, a final partition Ffin obtained by the proposed algorithm can always be found, and the coalitions within Ffin maintain a disjoint relationship.\nProof : Users are divided into U \u2032 disjoint subsets in the coalition structure (CS), and each subset represents a coalition. We exhaustively examine all the CSs of U \u2032 users and obtain the set S of all CSs, given by S = {S1, S2, ..., S|S|}. Based on the Bell number Bk, the cardinality of S for the U \u2032 users can be expressed as\nB(U \u2032) =  1 , U \u2032= 0, U \u2032\u22121\u2211 k=0 ( U \u2032 \u2212 1 k ) Bk, U \u2032 \u2265 1. (22)\nIn Algorithm 1, the number of switch operations in each iteration is up to N , and each user either joins a new coalition or still stays in the original coalition. Thus, the whole number of partitions is B(N), and since we preset the number of the BS and MRs, the number of partitions will be decreased based on the Bell number. As the number of partitions is bounded, we can conclude that after a certain number of switch operations, a final partition Ffin will be obtained.\n2) Stability: We next examine the Nash-stable structure of the proposed algorithm theoretically.\nDefinition 3 (Nash-stable Structure): If for all i \u2208 N , i \u2286 Fc \u2282 F , Fc\u227bi Fc\u0304 \u22c3 {i}, for all Fc\u0304 \u2282 F , Fc \u0338= Fc\u0304, a coalitional patition C = {C0, C1, ..., Cn\u22121, Cn} is Nashstable.\nTheorem 2: The final partition Ffin obtained by the Algorithm 1 is Nash-stable.\nProof : When the switching operation no longer occurs, the proposed algorithm based on the coalition game will terminate. At the same time, the optimal value of system throughput is obtained, and the final partition is Nash-stable. We have F\u2217 = argmaxFR(F), for all Fc \u2282 F , and F\u2217 = {F0\u2217,F1\u2217, ...,Fn\u22121\u2217,Fn\u2217} is the Nash-stable coalition partition.\nIf the partition still has tendency of switching, the final partition Ffin has not been found yet, which is contradictory to Ffin is the final partition. Consequently, the final partition Ffin of the proposed algorithm has reached Nash-stable.\nAlgorithm 1 Coalition Game based Algorithm for User Association and Transmission Scheduling Initialization: The flow set N = {i : 1 \u2264 i \u2264 N} and the\ncorresponding QoS set Q = {Qi : 1 \u2264 i \u2264 N}, M . 1: Perform a random partition Fini of N ; 2: Set the current partition Fcur = Fini; 3: repeat 4: Choose a flow i\u2208N in a pre-determined order, denote its coalition as Fc and the other coalition as Fc\u0304; 5: Get R ( Fc ) , R ( Fc\u0304 ) , R ( Fc \\ {i} ) and R ( Fc\u0304 \u22c3 {i} ) ;\n6: if R ( Fc ) +R ( Fc\u0304 ) < R ( Fc \\ i ) +R ( Fc\u0304 \u22c3 i )\nthen 7: Flow i leaves Fc and join in Fc\u0304; 8: Update Fcur= { Fc \\ {i},Fc\u2032 \u22c3 {i} }\n; 9: end if\n10: until Fcur Converges to the Nash-stable partition Ffin; 11: Get the number of time slots required for each flow\naccording to its throughput requirement; 12: Sort the flows according to their required numbers of time\nslots from small to large; 13: Terminate when the first Nsuc sorted flows have the\nnumber of time slots \u2264 M but counterpart of the first Nsuc + 1 sorted flows > M ;\n14: Output: The first Nsuc sorted flows."
        },
        {
            "heading": "VI. PERFORMANCE EVALUATION",
            "text": "In this section, we evaluate the performance of our proposed coalition game based algorithm under various system parameters. In the first part, we consider bandwidth resource allocation and ascertain the best ratio. In the second part, we compare our coalition game based scheme with other three schemes in terms of sum rate. After user association is over, we compare the proposed transmission scheduling scheme with another scheme in terms of system throughput and the number of users whose needs are met. Besides, we give the necessary analysis for the obtained simulation results."
        },
        {
            "heading": "A. Simulation Setup",
            "text": "Based on the system model described in Section III, the entire train-ground communication system works in the 60GHz mm-wave frequency band, and we consider a single cell scenario where users are randomly distributed in a 300\u00d7 300 square area. On the other hand, we use the widely used realistic directional antenna model in IEEE 802.15.3c [47] [48], and the antenna gain in units of dB, denoted by G (\u03b8) , can be expressed as\nG(\u03b8) =\n{ G0 \u2212 3.01 ( 2\u03b8\n\u03b8\u22123dB\n)2 , 0\u25e6 \u2264 \u03b8 \u2264 \u03b8ml2 ,\nGsl , \u03b8ml 2 \u2264 \u03b8 \u2264 180\n\u25e6. (23)\nwhere \u03b8 denotes an arbitrary angle within [0\u25e6, 180\u25e6], \u03b8\u22123dB denotes the angle of the half-power beam width, and \u03b8ml is the main lobe width in units of degrees, and the relationship between \u03b8ml and \u03b8\u22123dB is \u03b8ml = 2.6 \u00b7 \u03b8\u22123dB . Gsl is the side\n9\nlobe gain given by Gsl=\u22120.4111 \u00d7 ln (\u03b8\u22123dB)\u2212 10.579. G0 is the maximum gain which can be obtained by\nG0 =10 log10\n( 1.6162\nsin ( \u03b8\u22123dB/2 ))2 . (24) Other simulations parameters are given in Table I. In order to show the advantage of the proposed coalition game based scheme, we compare our scheme, which is labeled as Coalition Game (CG\u2212 FD), with other three schemes:\n1) CG-HD: Coalition Game - Half Duplex [49], where the MR operate in the half duplex mode. Thus, the bandwidth resource that the users can occupy is decreased in comparison with the case of FD under the same number of users.\n2) FBSC: Full BS Communication [50], where all users are associated with the BS.\n3) FMRC: Full MR Communication [50], where all users are associated with the MR."
        },
        {
            "heading": "B. Rationality of the Model in the Reality",
            "text": "Considering that HST mainly operates in rural areas and viaducts, and the buildings in the communication environments are generally low, so LOS transmission is dominant at this time. Mm-wave communications are directional, so we adopted the real directional antenna model in IEEE 802.15.3c [47] [48]. Secondly, we refer to the classical Shannon channel capacity for data rate. Thirdly, considering that the current algorithm can reduce the SI generated by FD to a low level, but there is still some residual SI in actual communication, a residual SI model such as \u03b2 \u00b7 Pt is built, and the results corresponding to different \u03b2 and Pt on system capacity is analyzed in the following. Fourthly, considering the small coverage of the mm-wave BS, the radius of cell is set to 300m during simulation.\nAt present, train-ground wireless communication in HSR scenario mainly based on GSM-R, while mm-wave and FD are the key technologies of 5G. The details of their practical application in HSR scenarios are still unclear, so the construction of system models and the selection of simulation parameters mainly come from theoretical literatures and standards."
        },
        {
            "heading": "C. Compared with the Optimal Solution",
            "text": "Firstly, we compare the performance of CG-FD with the optimal solution (OS) obtained by traditional exhaustive search method. The simulation results when the number of flows is 1 to 8 as shown in Fig.6 (a), and we can see that there\nis a good approximation between the sum rate of CG-FD shown by the solid line and that of OS shown by the dot line. This reminds us that under the same parameters, the user association algorithm based on coalition game proposed in this paper has the same optimal sum rate performance as the exhaustive search method, which is consistent with the theoretical analysis in Section IV."
        },
        {
            "heading": "D. Bandwidth resource allocation",
            "text": "In this section, we use simulation to determine the optimal way to allocate bandwidth. As shown in Fig. 6 (b), we obtain the sum rate with a, i.e., the ratio of bandwidth reserved by the BS to the total bandwidth resources, varying from 0.1 to 0.9. From the simulation results, we can easily get that the optimal bandwidth allocation is 0.4 for the BS and 0.6 for the MR. At this time, the sum rate of the system reaches the maximum when other parameters remain unchanged. Therefore, in the following simulation and analysis section, we assume that the ratio of bandwidth to BS is 0.4 and the counterpart of MR is 0.6."
        },
        {
            "heading": "E. System Sum Rate",
            "text": "When the number of flows waiting to be scheduled is 10, the sum rate obtained by the proposed coalition game\n10\nbased algorithm and other three comparison schemes when \u03b2 changes from \u2212150 dB to \u2212110 dB are shown in Fig. 7. When \u03b2 = \u2212150 dB, the sum rate of CG-FD is larger than that of FBSC, FMRC and CG-HD about 11%, 351% and 6%. As \u03b2 increases, the data rate of the flows transmitted from the MR decreases due to the increase of the SI, which can explain the trend of curves obtained by the CG-FD and the FMRC. Because there is no SI in the link without MR forwarding, the sum rate obtained by the FBSC scheme is stable. Unsurprisingly, as RSI gradually increases, more users intend to associate with the BS, so the curve corresponding to FMRC shows a trend of downward, which is obviously different from the other three curves. When \u03b2 is about -120dB, the sum rate obtained by CG-FD is lower than that obtained by CG-HD, which indicates when the SI cancellation level is above -120dB, the performance improvement brought by FD cannot offset the adverse effects of SI on the system.\nAs shown in Fig. 8, we compare system sum rate of the four schemes with different distance between BS and MR. In the\ninvestigated mm-wave train-ground communication system, the longitudinal distance between the BS and MR is fixed, so we take the lateral displacement of the MR as the independent variable to simulate the operation of the train. Based on the simulation results, it can be seen that CG-FD has the best performance. When the lateral displacement of the MR is 150m, the sum rate of CG-FD is larger than that of FBSC, FMRC and CG-HD about 26%, 40% and 8%, respectively. In general, when the distance between the BS and MR is too large, the sum rate of the MR is greatly limited, resulting in FMRC being the scheme with the lowest performance. On the whole, when the distance between BS and MR is about 150m, the sum rate have a maximum value. This is related to our planned radius of 300m. When other parameters are fixed and the distance between BS and MR is about 150m, the average distance between the user and the associated device is the shortest and the path loss is the smallest.\nThe variation of system sum rate under different transmission power is shown in Fig. 9. When Pt = 30dBm, the sum rate of CG-FD is larger than that of FBSC, FMRC and CGHD about 11%, 351% and 6%. As Pt increases, the SI of MR also increases, so the curve of FMRC scheme has a flat trend. Since there is no SI in the flows associated with the BS, increasing Pt is not bad for them and certainly has a greater effect on the growth of the FBSC. When the Pt is low, the proposed CG-FD scheme is closer to the FMRC, and shows great advantages when Pt is high.\nAs shown in Fig. 10, we compare system sum rate of the four schemes under different number of flows from 20 to 55. It can be seen that the performance of CG-FD proposed in this paper is best. When the number of the flows is 55, the sum rate of CG-FD is larger than that of FBSC, FMRC and CGHD about 18%, 254% and 13%. From overall view, the sum rate of these four schemes improve as the number of flows increases.\n11"
        },
        {
            "heading": "F. System Performance",
            "text": "In this simulation, we evaluate the system performance of our proposed transmission scheduling scheme. At first, we randomly set the throughput requirements of each flow and the upper limit of the required number of time slots. The simulation results of system performance under different number of CTAs are shown in Fig. 11.\nWhen the total number of flows is 50, the system throughput under different upper limit of number of time slots are shown in Fig. 11 (a). We can see that the proposed transmission scheduling scheme produces higher throughput and better performance. After sorting the number of slots required by all the flows, the proposed scheme were able to achieve much higher throughput than the one without sorting with limited slots, thus improving the performance of the system.\nThe variation of number of users whose throughput requirements are met under different restrictions of time slots are shown in Fig. 11 (b). We can see that the performance of the proposed transmission scheduling scheme is better. By sorting the number of slots required by all flows, we are able to meet the needs of more users with a limited number of time slots."
        },
        {
            "heading": "G. Convergence Rate",
            "text": "To examine the convergence performance of the proposed coalition game based algorithm, the number of switch operations under different number of flows are shown in Fig. 12 where the proposed CG scheme converges to the final partition.\nAs we can see, as the number of flows increases, so does the number of switching operations, and the average number of switching operations is 0 to 25. Given N flows, the exhaustive operation requires 2N iterations to find the optimal solution. Therefore, the proposed coalition game based algorithm allows users to establish the final Nash-stable partition with a very fast convergence rate, which greatly reduces the computational complexity."
        },
        {
            "heading": "H. Challenges in Real-life Environments",
            "text": "The above results show that the proposed algorithm can effectively improve the system throughput while maintaining a certain QoS awareness, but there are still some challenges in applying them in real-life environments.\nFirstly, the established train-ground communication system works in the mm-wave band, which requires the antenna array to be arranged at MR and BS simultaneously. Considering the inherent high path loss of mm-wave communications, we also need to optimize the beamforming at the transmitter and receiver to maximize the directional gain of the antenna. At present, the method based on deep reinforcement learning has been proposed, which has great potential to solve this problem.\nSecondly, considering that the operation of HST is based on a fixed timetable and its trajectory is predictable, the trackside train-ground wireless communication system also has a regular pattern, and artificial intelligence is good at capturing this hidden pattern, which has great potential to optimize the beamforming in the HSR scenarios [51] [52]. In addition, as the HST mainly runs in rural areas and viaducts, the buildings in the communication environments are generally low. At this time, LOS transmission is dominant, but there is still the possibility that the service may be interrupted due to blocking. At present, scholars have proposed to deploy IRS on HST windows or track-side [53].\nThirdly, in the actual scenarios, BS should timely count the QoS requirements of users, and send the results of user association and transmission scheduling to users through the control channel. However, because the speed of HST is fast and not constant, there is usually additional queuing and transmission delay, so a more detailed model needs to be established to further evaluate the control channel bandwidth that needs to be reserved when the HST speed is different, and the implementation complexity of the algorithm can also be reduced by referring to historical user association and transmission scheduling data."
        },
        {
            "heading": "VII. CONCLUSIONS",
            "text": "In this paper, we propose a coalition game based algorithm to solve the user association and transmission scheduling problems in the mm-wave train-ground communication system with MR operating in the FD mode. The coalition formation algorithm ensures the maximum sum rate of the system, and the sorting algorithm ensures the maximum number of users meeting QoS requirements. In addition, we theoretically proved that the proposed algorithm can converge after limited steps, and finally reach the Nash-stable structure. Extensive simulation results demonstrated that the proposed coalition\n12\ngame based algorithm can effectively improve the system throughput while maintaining a certain QoS awareness, when compared with three baseline schemes."
        }
    ],
    "title": "QoS-aware User Association and Transmission Scheduling for Millimeter-Wave Train-ground Communications",
    "year": 2023
}