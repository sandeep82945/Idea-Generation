{
    "abstractText": "We introduce a generalization of the \u03c3-SCF method to approximate noncollinear spin ground and excited single-reference electronic states by minimizing the Hamiltonian variance. The new method is based on the \u03c3-SCF method, originally proposed by Ye et al. [J. Chem. Phys. 147, 214104 (2017)], and provides a prescription to determine ground and excited noncollinear spin states on an equal footing. Our implementation was carried out utilizing an initial simulated annealing stage followed by a mean-field iterative self-consistent approach to simplify the cumbersome search introduced by generalizing the spin degrees of freedom. The simulated annealing stage ensures a broad exploration of the Hilbert space spanned by the generalized spin single-reference states with random complex element-wise rotations of the generalized density matrix elements in the simulated annealing stage. The mean-field iterative self-consistent stage employs an effective Fockian derived from the variance, which is utilized to converge tightly to the solutions. This process helps us to easily find complex spin structures, avoiding manipulating the initial guess. As proof-of-concept tests, we present results for Hn (n = 3\u20137) planar rings and polyhedral clusters with geometrical spin frustration. We show that most of these systems have noncollinear spin excited states that can be interpreted in terms of geometric spin frustration. These states are not directly targeted by energy minimization methods, which are meant to converge to the ground state. This stresses the capability of the \u03c3-SCF methodology to find approximate noncollinear spin structures as mean-field excited states. Published under an exclusive license by AIP Publishing. https://doi.org/10.1063/5.0178264",
    "authors": [
        {
            "affiliations": [],
            "name": "Ofelia B. O\u00f1a"
        },
        {
            "affiliations": [],
            "name": "Gustavo E. Massaccesi"
        },
        {
            "affiliations": [],
            "name": "Juan I. Melo"
        },
        {
            "affiliations": [],
            "name": "Alicia Torre"
        },
        {
            "affiliations": [],
            "name": "Luis Lain"
        },
        {
            "affiliations": [],
            "name": "Diego R. Alcoba"
        },
        {
            "affiliations": [],
            "name": "Juan E. Peralta"
        }
    ],
    "id": "SP:baad7453b2c69be728d128f5ea7741dd2a7e6bdf",
    "references": [
        {
            "authors": [
                "J. Goings",
                "F. Ding",
                "M.J. Frisch",
                "X. Li"
            ],
            "title": "Stability of the complex generalized",
            "year": 2015
        }
    ],
    "sections": [
        {
            "text": "I. INTRODUCTION\nThe Rayleigh\u2013Ritz (RR) variational principle1 has been used in electronic structure theory for many years as the basis for developing methods that approximate the ground state of many-electron systems by simply minimizing the electronic energy. Hartree\u2013Fock (HF) and multi-configurational self-consistent field are just two\nexamples of widely used techniques that rely on RR to cast the working equations that are, in turn, solved via self-consistent field (SCF) techniques.2\u20135 These ground-state variational solutions can be used as starting points and subsequently improved with methods from the coupled-cluster family, M\u00f8ller-Plesset, or multi-reference wave function-based approaches, such as configuration interaction (CI).6 The ground-state variational solutions can also be used as\nJ. Chem. Phys. 159, 214104 (2023); doi: 10.1063/5.0178264 159, 214104-1\nPublished under an exclusive license by AIP Publishing\na reference for calculating excited states using linear-response, like for example configuration interaction singles, or time-dependent Hartree-Fock.7\u20139\nThe RR method can also be used to directly target excited states using the \u0394SCF approach,10,11 where excited states are determined by purposely violating the Aufbau single-particle occupation rule (in HF or density functional theory, DFT). Although self-consistency convergence can be problematic for arbitrary excited states (leading to the so-called \u201cvariational collapse\u201d to the ground state),12 the \u0394SCF approach has been successfully employed in many applications, where convergence can be numerically achieved. Examples of these are cases where the objective state corresponds to a given symmetry that is different than that of the ground state (space point group or spin),13,14 or cases where the objective states are fairly isolated in configuration space, such as in magnetic molecular complexes whose magnetic centers closely follow the Heisenberg model physics.15 To overcome the variational collapse problem in the \u0394SCF methodology, Gilbert et al.16 developed the maximum overlap method, which proposes to determine the occupied orbitals by maximizing their overlap during successive SCF iterations. The \u0394SCF method has proven to be successful, but the underlying problem associated with the variational collapse of the solution to unwanted states cannot be fully avoided. Remarkably, several mean-field approaches that directly target excited states such as the squared-gradient minimization, SCF meta dynamics, or the method of Levi et al.17,18 also rely on the ground-state variational principle.\nIn contrast to relying on the ground-state variational principle, which proposes to minimize the expectation value of the Hamiltonian for a given ans\u00e4tze wave function, the pioneering works of Weinstein19 and Bartlett et al.20 proposed to utilize the Hamiltonian variance as the objective function to determine optimal states. This idea has been utilized in different contexts by Frost et al.,21\u201325 Conroy,26\u201328 Coldwell,29 and Umrigar et al.30 for variational Monte Carlo calculations.\nRecently, Ye and co-workers proposed the \u03c3-SCF method, which also utilizes the Hamiltonian variance and targets the ground and excited states on an equal footing.31 This method has been adopted recently by David et al.32 to incorporate finite magnetic fields into the calculation of excited states.32,33\nThe \u03c3-SCF method has been implemented and tested using spin-restricted (spin-compensated) and spin-unrestricted singlereference wave function ans\u00e4tze, hereafter termed \u03c3-SCF(R) and \u03c3-SCF(U), respectively.31,32 In the spin-unrestricted case, orbitals are constrained to be spin-polarized in the same direction, forcing the electron density to be spin-polarized in one single direction, typically z. This constraint ensures that the wave function is an eigenstate of S\u0302z , albeit not necessarily an eigenstate of S\u0302 2. These two approaches are commonly adopted in mean-field type calculations such as HF or DFT. Alternatively, a generalized spin ansatz allows single-electron orbitals to be spin-polarized in different arbitrary directions, which implies that the electron spin density can acquire any direction at different points in space, such as in generalized-HF (GHF) or noncollinear spin DFT.3,5 In all cases, GHF or noncollinear spin DFT codes are limited to energy minimization. Although, in practice, the spin-unrestricted approach leads to a global minimum for many problems of practical interest, a generalized spin approach is necessary to find global minima in cases where there is spin frustration,\nor when the spin\u2013orbit operator is included self-consistently in the calculation. In this paper, we introduce a generalized spin version of the \u03c3-SCF method, hereafter termed \u03c3-SCF(G), which targets generalized (fully unrestricted) spin ground and excited states on an equal footing with single-reference ansatz. To this end, we first develop the working equations and methodology, then we show results for hydrogen atomic arrangements as proof-of-concept, focusing on cases where strong geometric spin frustration is present, and thus, noncollinear atomic local spin populations arise from their ground and excited states."
        },
        {
            "heading": "II. THEORY AND IMPLEMENTATION",
            "text": "Starting from an N-electron wave function ansatz, \u03a6, and an N-electron non-relativistic Hamiltonian, H\u0302, its variance S(\u03a6) is evaluated as\nS[\u03a6] = \u27e8\u03a6\u2223H\u0302 2\u2223\u03a6\u27e9 \u2212 \u27e8\u03a6\u2223H\u0302\u2223\u03a6\u27e92, (1)\nwhile the dispersion, W[\u03a6](\u03c9), for a real parameter \u03c9 is19\nW[\u03a6](\u03c9) = \u27e8\u03a6\u2223(H\u0302 \u2212 \u03c9)2\u2223\u03a6\u27e9. (2)\nFor exact eigenstates of the H\u0302 operator, S[\u03a6] = 0 and W[\u03a6](\u03c9) = (E\u03a6 \u2212 \u03c9)2 is a quadratic function in\u03c9whose minimum corresponds to the exact eigenenergy E\u03a6. From Eqs. (1) and (2), it follows that:\nW[\u03a6](\u03c9) = S[\u03a6] + (\u27e8\u03a6\u2223H\u0302 \u2223\u03a6\u27e9 \u2212 \u03c9)2, (3)\nwhich shows that the dispersion and the variance are equal when \u03c9 = \u27e8\u03a6\u2223H\u2223\u03a6\u27e9. Equation (3) also provides a useful relation for the variational minimization of W[\u03a6](\u03c9) that relates the variations of W and S,\n\u03b4W = \u03b4S + 2(\u27e8H\u0302\u27e9 \u2212 \u03c9)\u03b4\u27e8H\u0302\u27e9, (4)\nwhere \u03b4 represents variations with respect to variational parameters. The \u03c3-SCF method proposes to approximate eigenstates of the H\u0302 operator as those states that satisfy \u03b4W/\u03b4\u03a6 = 0 and dW/d\u03c9 = 0 for a given wave function ansatz \u03a6. It is worth noting that for the cases where \u03b4W/\u03b4\u03a6 = 0 (subject to the normalization constraint), the value of \u03c9 that minimizes the dispersion is \u03c9 = \u27e8H\u0302\u27e9. In Refs. 31 and 32, Ye et al. and David et al. detailed the working equations for the cases of spin-restricted and spin-unrestricted single-determinant wave functions [analog to the restricted Hartree-Fock (RHF) and unrestricted Hartree-Fock (UHF) cases] and showed that the function\u03a9(\u03c9) = min\n\u03a6 W[\u03a6](\u03c9), subject to the normalization constraint,\nis a sequence of overlapping parabola-like functions, with the minima d\u03a9(\u03c9)/d\u03c9 = 0 corresponding to the (approximate) Hamiltonian eigen energies. Thus, determining approximate energies within the \u03c3-SCF method involves finding the local minima of these piece-wise functions. The \u03c3-SCF method is particularly attractive since it avoids the variational collapse, but it is not free from caveats, such as its high computational scaling, and the masking of local minima, as pointed out by the authors.32\nJ. Chem. Phys. 159, 214104 (2023); doi: 10.1063/5.0178264 159, 214104-2\nPublished under an exclusive license by AIP Publishing\nNoncollinear spin states in a single-reference wave function can be obtained by introducing two-component spinors,\n\u03a8i = \u239b \u239c \u239d \u03c8\u2191i \u03c8\u2193i \u239e \u239f \u23a0 , (5)\nwhere \u03c8\u2191i and \u03c8 \u2193 i are spatial orbitals expanded as a linear combination of M atomic orbitals, \u03d5\u03bc,\n\u03c8\u03c3i (r) = M\n\u2211 \u03bc\nc\u03c3\u03bci\u03d5\u03bc(r) (\u03c3 = \u2191, \u2193), (6)\nwhere \u03d5\u03bc(r) \u2208 R and c\u03bci are the complex expansion coefficients. The density matrix is constructed as\nPpq = \u2211 i\u2208occ \u239b \u239c \u239d\nc\u2191\u03bcic \u2191\u2217 \u03bdi c \u2191 \u03bcic \u2193\u2217 \u03bdi c\u2193\u03bcic \u2191\u2217 \u03bdi c \u2193 \u03bcic \u2193\u2217 \u03bdi \u239e \u239f \u23a0 = \u239b \u239c \u239d P\u2191\u2191\u03bc\u03bd P \u2191\u2193 \u03bc\u03bd P\u2193\u2193\u03bc\u03bd P \u2193\u2191 \u03bc\u03bd \u239e \u239f \u23a0 , (7)\nwhere p and q, in this case, represent compounded atomic orbital and spin indices, respectively, p = \u03bc\u03c3 and q = \u03bd\u03c3\u2032. The density matrix of elements Ppq has dimensions 2M \u00d7 2M and is complex.\nThe variance S and the dispersion W can be expressed in terms of the generalized density matrix, like \u27e8H\u0302\u27e9 in generalized HF theory.3 Introducing a simplified notation for the two-electron integrals in the compounded orbital and spin indices, (pq\u2223rs) = (\u03bc\u03c3\u03bc\u03bd\u03c3\u03bd\u2223\u03bb\u03c3\u03bb\u03be\u03c3\u03be) = (\u03bc\u03bd\u2223\u03bb\u03be) \u03b4\u03c3\u03bc\u03c3\u03bd \u03b4\u03c3\u03bb\u03c3\u03be , where (\u03bc\u03bd\u2223\u03bb\u03be) are standard two-electron integrals in the atomic basis set, the variance S can be expressed as\nS =\u2211 pqrs FpqPqrFrsQsp + 1 2\u2211pqrs \u2211 ijkl (pq\u2223rs) (ji\u2223lk) PpiQlqPrkQjs\n\u2212 1 2\u2211pqrs \u2211 ijkl (pq\u2223rs) (ji\u2223lk) PpiQjqPrkQls, (8)\nwhere Qrs = Srs \u2212 Prs, Srs is the overlap matrix elements, and Frs is the Fock matrix elements. An approximate resolution of the identity has been employed to limit the evaluation of matrix elements to oneand two-electron integrals. From S, we readily evaluate W using Eq. (3).\nAlthough the minimization of the objective function W for a given (fixed) \u03c9 can be performed without gradient information (see below), it is convenient to have the option to perform a selfconsistent search in analogy with traditional mean-field approaches. To this end, the effective Fock matrix for the self-consistent minimization of W is evaluated using Fpq = dW/dPpq as\nFpq =\u2211 rs Fpr(Qrs \u2212 Prs)Fsq +\u2211 rs \u2211 ij (sr\u2223qp)QriFijPjs\n\u2212\u2211 rs \u2211 ij (sq\u2223rp)QriFijPjs +\u2211 rs \u2211 ij (sr\u2223qp) PriFijQjs\n\u2212\u2211 rs \u2211 ij (sq\u2223rp) PriFijQjs +\u2211 rs \u2211 ijkl (rs\u2223qi) (lk\u2223jp) PrkQlsQji\n\u2212\u2211 rs \u2211 ijkl (rs\u2223qi)(jk\u2223lp)PrkQlsQji+\u2211 rs \u2211 ijkl (rs\u2223ip)(lk\u2223qj)PrkQlsPij\n\u2212\u2211 rs \u2211 ijkl (rs\u2223ip) (qk\u2223lj) PrkQlsPij + 2(Eel \u2212 \u03c9)Fpq, (9)\nwhere Eel = \u27e8H\u0302\u27e9 is the electronic energy. It should be pointed out that the index summations in Eqs. (8) and (9) introduce a computational scaling of O(N5), in contrast to the formal scaling of O(N4) in standard HF.\nIn this paper, minimization of the objective function W for a given value of the \u03c9 parameter is carried out in two steps. The first step consists of a simulated annealing (SA) minimization, followed by a second step which performs a standard self-consistent field (SCF) minimization. It should be mentioned that a common strategy to find noncollinear spin solutions in SCF calculations is to start from an initial guess with a spin structure that resembles the expected solution.34,35 The scheme proposed in this work ensures that the minima of W are found independently of the initial guess, which becomes important for exploring noncollinear generalized spin solutions for the excited states with the \u03c3-SCF method. The SA method resembles a physical process in which a system is cooled, decreasing the temperature T until \u201cfreezing\u201d to a minimum energy configuration.36,37 This procedure turns out to be particularly useful in describing systems having many local energy minima, such as in this case. Our SA working scheme for the minimization of the objective function W is shown in Fig. 1. First, a random pairwise complex unitary transformation of the generalized density matrix P [Eq. (7)] is proposed, such that\nPnew = U\u2020PoldU, (10)\nwhere the density matrix Pold is written in an orthonormal basis, and the matrix U is the identity matrix except for elements corresponding to two randomly chosen row i and column j (with i \u2260 j) that form the 2 \u00d7 2 matrix R,\nJ. Chem. Phys. 159, 214104 (2023); doi: 10.1063/5.0178264 159, 214104-3\nPublished under an exclusive license by AIP Publishing\nR = \u239b \u239c \u239d\nei\u03b11 cos \u03b8 ei\u03b12 sin \u03b8\n\u2212e\u2212i\u03b12 sin \u03b8 e\u2212i\u03b11 cos \u03b8 \u239e \u239f \u23a0 . (11)\nIn Eq. (11), \u03b11, \u03b12, and \u03b8 represent rotation angles that lie in the interval [\u2212\u03b1max,\u03b1max] chosen from a uniform random distribution. In our implementation, the orthonormal basis is chosen to be the L\u00f6wdin orbital basis set, which relies on a symmetric orthonormalization of the atomic orbitals, but other choices such as molecular orbitals from an HF calculation are also feasible. The transformation in Eq. (11) can be viewed as a generalized random rotation of the spinors that define the density matrix, Fig. 1 (1), which, in turn, is used to evaluate a new dispersion Wnew(\u03c9). If Wnew(\u03c9) < Wold(\u03c9), then the new density matrix is accepted; otherwise, a uniform random number R01 \u2208 [0, 1] is drawn, Fig. 1 (2), so that if\nexp( Wold(\u03c9) \u2212 Wnew(\u03c9)\nT ) > R01 1 \u2212 R01 ,\nthe change is also accepted, Fig. 1 (3). This is a key step in the SA process since it allows the algorithm to explore outside local minimum basins. Whether the proposed generalized rotation is accepted or not, the temperature T and the maximal angle \u03b1max decrease along consecutive steps, Fig. 1 (4). The starting temperature T is chosen high enough to be able to initially explore the entire W space. According to our experience, a good choice is T = 1.0 (atomic units will be used throughout). The decreasing rate of T for each step i is chosen so that T(i+1) = \u03b4T T(i) with \u03b4T = 0.995, while \u03b1(i+1)max = \u03b4\u03b1max \u03b1(i)max, with an initial value \u03b1max = 1.4 rad and \u03b4\u03b1max = 0.9995. This choice has proven to be suitable to decrease the maximum angle slowly in order to escape potential local minima. T, \u03b1max, \u03b4T, and \u03b4\u03b1max have been initialized with identical values for all calculations in this work. Nevertheless, it should be mentioned that these parameters may need to be re-adjusted for other cases due to factors like the dimension of the problem and the particular choice of the initial configuration. The process is repeated and stops when a maximum number of cycles is completed (2 \u00d7 104) or the number of consecutive non-acceptance steps is greater than 103. After the SA minimization, a standard SCF minimization is carried out utilizing the effective Fock matrix for the target dispersion in Eq. (9). Using Pulay mixing,38,39 the SCF converges in a few iterations in most cases, with some rare exceptions, in which cases the entire process is repeated. A representative example of the convergence behavior of the SA stage is shown in the supplementary material. The SA stage followed by a mean-field iterative SCF stage allows us to find generalized spin solutions with ease independently of the initial state. The algorithm was implemented in PYTHON and interfaced with the PYSCF program to evaluate one- and two-electron integrals.40,41 After the SA minimization, the commutator error (defined as \u2223[F , P]\u2223) is typically 10\u22123, while the SCF convergence tolerance is 10\u22129. After SCF convergence, the atomic spin population is analyzed and the method described in Ref. 42 is used to decompose \u27e8S\u0302 2\u27e9 into atomic contributions.43\u201346\nIn addition, the magnetic structure analyses proposed by Small et al. and Henderson et al. were used to determine the spin coplanarity and collinearity of the solutions.35,47 All these methods combined provide a useful tool set to determine the nature of the\nsolutions. After this, the entire process is repeated for different values of \u03c9."
        },
        {
            "heading": "III. APPLICATIONS",
            "text": "As proof-of-concept applications, we tested our generalized \u03c3-SCF algorithm in a set of hydrogen atoms symmetrically arranged at a distance of 1 \u00c5 between first neighbors: H3 (triangular), H4 (square and tetrahedral), H5 (pentagonal), H6 (hexagonal and bi-pyramidal), and H7 (heptagonal). At this interatomic distance, neighbor hydrogen atoms have a strong antiferromagnetic coupling, and thus, some configurations such as the rings H3, H5, and H7 are particularly interesting since they are prone to geometric spin frustration. As a result, noncollinear spin structures are expected to arise from single-reference electronic configurations. Similar arrangements have been used by Goings et al. and Henderson et al. to probe noncollinear spin solutions within GHF.35,48 These simple atomic arrangements allow for a simple physical interpretation of the solutions in terms of spin interactions.\nIn all cases, the Wminimization algorithm described above was employed with a given fixed \u03c9, and the values of \u03c9 were swept in a preset energy range. The SA step becomes crucial for the \u03c3-SCF(G) method in our test cases, where the magnetic structure of the minima of W(\u03c9) is hard to predict. A minimal basis was utilized in all calculations to allow for a direct comparison with full-CI calculations. Consistently with the observations in Refs. 31 and 32 for the spin-restricted and (collinear) spin-unrestricted cases, a sequence of parabola-like \u03a9(\u03c9) was obtained, with electronic energies that show an approximate step-wise behavior with nearly constant values in the vicinity of the minima. For comparison, in addition to the (noncollinear) generalized spin calculations [labeled \u03c3-SCF(G) in the figures], we have also repeated this process using a (collinear) spin-unrestricted version of the algorithm [labeled \u03c3-SCF(U) in the figures]. A detailed summary of our results for all systems can be found in the supplementary materials, including \u03a9(\u03c9) vs \u03c9 plots, atomic spin populations, and iso-charge and spin density plots and for the solutions with minima \u03a9. In this section, we present and discuss the results for the geometrically spin-frustrated H3, H5, and H7.\nIn Fig. 2, we show \u03a9 and Eel as a function of \u03c9 for H3 with the \u03c3-SCF(U) and \u03c3-SCF(G) methods. This figure shows similar characteristics than those found by Ye et al.31 and David et al.,32 although for \u03c3-SCF(G), the intersection between the parabola-like regions is somewhat smoother than for the \u03c3-SCF(U) case. This can be attributed to the increased spin degrees of freedom in the minimization of W(\u03c9) that allow for a continuous transition between the two parabolas that correspond to solutions of different spin multiplicity. Both \u03c3-SCF(U) and \u03c3-SCF(G) curves are very similar, with the only major difference found close to the ground state (labeled as a in Fig. 2), where the parabola for\u03a9G < \u03a9U and EGel < E U el as expected from the presence of a geometrically frustrated spin state. However, the approximate excited states in this case with the minimal basis do not present signs of spin noncollinearity. The first excited state b coincides for \u03c3-SCF(U) and \u03c3-SCF(G), and its energy is identical to the full-CI energy, which indicates that this excited state corresponds to the high spin state represented as a single-reference configuration in both methods with \u03a9G \u2248 10\u22126 as expected.\nJ. Chem. Phys. 159, 214104 (2023); doi: 10.1063/5.0178264 159, 214104-4\nPublished under an exclusive license by AIP Publishing\nFor H5, the situation is slightly different, as shown in Fig. 3, where the plots of \u03a9(\u03c9) present more minima. Although both \u03c3-SCF(U) and \u03c3-SCF(G) methods give somewhat similar results, there are clear differences in the vicinity of some minima. As in the case of H3, this can be interpreted as originated in the presence of frustrated spin states and captured by the \u03c3-SCF(G) method as noncollinear spin states, which, in this case, are found beyond the ground state (labeled as a, b, d, and e in Fig. 3). For H7, the number of basins in \u03a9(\u03c9) increases, as shown in Fig. 4, and there are also excited states with \u03a9G < \u03a9U (labeled as a, b, and d in Fig. 4). The energy Eel for H7 presents a less marked step-wise behavior than H3 and H5, likely due to the larger number of overlapping \u03a9 basins present in this case. For H5 and H7, the high spin excited states with negligible dispersion (\u03a9G \u2248 10\u22126) are c and e, respectively.\nFIG. 4. \u03a9 vs \u03c9 (right axis) and electronic energy vs \u03c9 (left axis) for H7 using the spin-unrestricted, \u03c3-SCF(U), and generalized-spin, \u03c3-SCF(G) approximations. The minima are labeled for reference using roman letters.\nNow, we turn to the analysis of the magnetic structure of the solutions obtained with the \u03c3-SCF(G) method. In Fig. 5, we show isosurfaces of the spin density magnitude for selected collinear and noncollinear spin ground and excited state solutions. Figure 5 also shows the local spin at each H atom calculated using the standard L\u00f6wdin projection method. The spin densities in all the solutions shown in Fig. 5 are confirmed to be coplanar and correspond to the transverse spin density wave classification of Fukutome.49,50 From a simple classical spin model of antiferromagnetically coupled rings, the angles between first neighbors are expected to be 2\u03c0/3, 4\u03c0/5, and 6\u03c0/7 for H3, H5, and H7, respectively. This is exactly what is found for the angles between first-neighbor atomic spin densities for these hydrogen rings in their ground state [(a) in the figure], as shown in Table I. The H5 ring shows a noncollinear excited state (b) with a first-neighbor atomic spin density angle of 2\u03c0/5. This solution corresponds to a geometrically frustrated configuration that is not found in energy-targeting methods and provides a good example of the capabilities of the \u03c3-SCF(G) method. A similar situation arises for H7, with two geometrically frustrated configurations with angles 4\u03c0/7 and 2\u03c0/7. These excited state solutions hold a larger spin at each center compared to the ground state and a total \u27e8S\u0302 2\u27e9 also larger than the ground state. It is important to stress that all the solutions reported were found without manipulating the initial guess to target specific spin configurations, which becomes essential when no information about the spin density of the target solutions is available. Although it is evident, it is also proper to emphasize that within this method it is not possible to target particular solutions with a given spin configuration. For example, for H3, there are four different degenerate solutions with positive and negative spin chiralities51 and identical \u03a9 and electronic energy, but the SA stage converges randomly to one of these states. It is also worth remarking that, due to the masking of the local minima problem,31,32 the \u03c3-SCF method may have difficulties in determining states that are relevant for molecular magnetism problems. For typical molecular spin excitations, energy differences between spin states are of the order of the mHa, while the basins in the vicinity of the local minima in the\nJ. Chem. Phys. 159, 214104 (2023); doi: 10.1063/5.0178264 159, 214104-5\nPublished under an exclusive license by AIP Publishing\n\u03c3-SCF method span tenths of a Ha. Hence, if two states are close in energy and the minima of the\u03a9(\u03c9) function are displaced vertically, as is likely the case when one state can be closely represented by a single configuration while the other cannot, then the masking problem becomes a limitation to determine the higher variance state. On the other hand, if both minima are only displaced horizontally (likely when both states can be approximated by a single reference), then it could be possible to isolate them.\nComparing the noncollinear spin \u03c3-SCF(G) and collinear spin \u03c3-SCF(U) solutions in Fig. 5, it can be readily seen that the \u03c3-SCF(G) spin densities preserve the Cn point group symmetry of the rings, while S\u0302z symmetry is broken. On the other hand, \u03c3-SCF(U) solutions preserve S\u0302z symmetry but break the Cn point group symmetry, as shown in Fig. 5. This rupture of the point group symmetry creates an artificial Jahn-Teller distortion effect for collinear spin solutions since the atomic forces are expected to be asymmetrical. The \u03c3-SCF(G) method provides an alternative to remediate this problem for ground and excited states."
        },
        {
            "heading": "IV. CONCLUDING REMARKS",
            "text": "We have introduced a generalization of the \u03c3-SCF method that allows approximating noncollinear spin ground and excited singlereference electronic states on an equal footing by minimizing the Hamiltonian dispersion W[\u03a6](\u03c9) = \u27e8\u03a6\u2223(H\u0302 \u2212 \u03c9)2\u2223\u03a6\u27e9 with respect to \u03a6 and \u03c9. The method is based on the \u03c3-SCF method, originally proposed by Ye et al.,31 and involves performing a sequence of sweeps in \u03c9 while minimizing W[\u03a6](\u03c9) with respect to \u03a6 for each \u03c9. To simplify and streamline the cumbersome state search originated by introducing generalized spin degrees of freedom, our implementation relies on an initial simulated annealing stage followed by a mean-field iterative self-consistent approach. In the simulated annealing stage, random complex element-wise rotations of the generalized density matrix elements ensure a broad exploration of the Hilbert space spanned by the generalized spin single-reference states. This, in turn, makes it possible to find complex spin structures with ease, without the need of manipulating the initial guess. In the second stage, a mean-field iterative self-consistent approach that employs an effective Fockian derived from the variance was utilized to tightly converge to the solutions. As proof-of-concept tests, we present results for the Hn rings (n = 3, 5, and 7) with geometrical spin frustration (other examples are provided in the supplementary material). We show that for these systems, there are noncollinear mean-field spin ground and excited states that arise as a result of the dispersion minimization. We find a number of excited states that can be interpreted in terms of geometric spin frustration and are not straightforward to target with energy minimization methods, which are meant to converge to the ground state. This shows the capability of the proposed method to find approximate noncollinear spin structures with mean-field states."
        },
        {
            "heading": "SUPPLEMENTARY MATERIAL",
            "text": "See supplementary material for dispersion minima and energy plots, local spin angles and population analysis, spin density and charge density isosurface plots, and local spin directions for \u03c3SCF(G) solutions for Hn (n = 1\u20137) rings, tetrahedral H4, and bi-pyramidal H6. Convergence behavior for H3."
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "O.B.O., G.E.M., J.I.M., and D.R.A. acknowledged the financial support from the Consejo Nacional de Investigaciones Cient\u00edficas y T\u00e9cnicas (Grant Nos. PIP 11220200100467CO and PIP\nJ. Chem. Phys. 159, 214104 (2023); doi: 10.1063/5.0178264 159, 214104-6\nPublished under an exclusive license by AIP Publishing\n11220210100821CO). O.B.O., G.E.M., and D.R.A. acknowledged the support from the Universidad de Buenos Aires (Grant No. 20020190100214BA) and the Agencia Nacional de Promoci\u00f3n Cient\u00edfica y Tecnol\u00f3gica (Grant No. PICT-201-0381). J.E.P. acknowledged the support from the U.S. Department of Energy, Office of Basic Energy Sciences, as part of the Computational Chemical Sciences Program, under Award No. DE-SC0005027."
        },
        {
            "heading": "AUTHOR DECLARATIONS Conflict of Interest",
            "text": "The authors have no conflicts to disclose."
        },
        {
            "heading": "Author Contributions",
            "text": "Ofelia B. O\u00f1a: Conceptualization (equal); Data curation (lead); Formal analysis (equal); Methodology (equal); Software (equal); Validation (lead); Visualization (lead); Writing \u2013 original draft (supporting); Writing \u2013 review & editing (supporting). Gustavo E. Massaccesi: Conceptualization (equal); Formal analysis (equal); Methodology (equal); Software (equal). Juan I. Melo: Conceptualization (equal); Formal analysis (equal); Methodology (equal); Validation (equal); Writing \u2013 review & editing (equal). Alicia Torre: Conceptualization (equal); Formal analysis (equal); Validation (equal); Writing \u2013 review & editing (equal). Luis Lain: Conceptualization (equal); Formal analysis (equal); Validation (equal); Writing \u2013 review & editing (equal). Diego R. Alcoba: Conceptualization (lead); Data curation (equal); Formal analysis (equal); Methodology (equal); Software (equal); Validation (equal); Writing \u2013 original draft (supporting); Writing \u2013 review & editing (equal). Juan E. Peralta: Conceptualization (equal); Data curation (supporting); Formal analysis (equal); Methodology (equal); Software (lead); Validation (equal); Visualization (supporting); Writing \u2013 original draft (lead); Writing \u2013 review & editing (equal)."
        },
        {
            "heading": "DATA AVAILABILITY",
            "text": "The data that support the findings of this study are available within this paper and its supplementary material. The PYTHON code employed for this work is publicly available in GITHUB under https://github.com/peraltajuan/generalized-spin-sigma-SCF."
        }
    ],
    "title": "Generalized spin \u03c3-SCF method",
    "year": 2023
}