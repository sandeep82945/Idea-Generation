{
    "abstractText": "Simulating the time-evolution of a Hamiltonian is one of the most promising applications of quantum computers. Multi-Product Formulas (MPFs) are well suited to replace standard product formulas since they scale better with respect to time and approximation errors. Hamiltonian simulation with MPFs was first proposed in a fully quantum setting using a linear combination of unitaries. Here, we analyze and demonstrate a hybrid quantum-classical approach to MPFs that classically combines expectation values evaluated with a quantum computer. This has the same approximation bounds as the fully quantum MPFs, but, in contrast, requires no additional qubits, no controlled operations, and is not probabilistic. We show how to design MPFs that do not amplify the hardware and sampling errors, and demonstrate their performance. In particular, we illustrate the potential of our work by theoretically analyzing the benefits when applied to a classically intractable spin-boson model, and by computing the dynamics of the transverse field Ising model using a classical simulator as well as quantum hardware. We observe an error reduction of up to an order of magnitude when compared to a product formula approach by suppressing hardware noise with Pauli Twirling, pulse efficient transpilation, and a novel zeronoise extrapolation based on scaled crossresonance pulses. The MPF methodology reduces the circuit depth and may therefore represent an important step towards quantum advantage for Hamiltonian simulation on noisy hardware.",
    "authors": [
        {
            "affiliations": [],
            "name": "Almudena Carrera Vazquez"
        },
        {
            "affiliations": [],
            "name": "Daniel J. Egger"
        },
        {
            "affiliations": [],
            "name": "David Ochsner"
        },
        {
            "affiliations": [],
            "name": "Stefan Woerner"
        }
    ],
    "id": "SP:5509c92b15907b613a782207c23db46ffc53e2c8",
    "references": [
        {
            "authors": [
                "D. Aharonov",
                "A. Ta-Shma"
            ],
            "title": "Adiabatic quantum state generation and statistical zero knowledge",
            "venue": "Proc. 35th Annu. ACM Symp. Theory Comput., page 20\u201329,",
            "year": 2003
        },
        {
            "authors": [
                "G. Ahokas"
            ],
            "title": "Improved algorithms for approximate quantum Fourier transforms and sparse Hamiltonian simulations",
            "year": 2004
        },
        {
            "authors": [
                "T. Alexander",
                "N. Kanazawa",
                "D.J. Egger",
                "L. Capelluto",
                "C.J. Wood",
                "A. Javadi-Abhari",
                "D.C. McKay"
            ],
            "title": "Qiskit pulse: programming quantum computers through the cloud with pulses",
            "venue": "Quantum Sci. Technol., 5(4):044006, aug",
            "year": 2020
        },
        {
            "authors": [
                "D. An",
                "D. Fang",
                "L. Lin"
            ],
            "title": "Timedependent Hamiltonian simulation of highly oscillatory dynamics and superconvergence for Schr\u00f6dinger equation",
            "venue": "Quantum, 6:690,",
            "year": 2022
        },
        {
            "authors": [
                "H. Bernien",
                "S. Schwartz",
                "A. Keesling",
                "H. Levine",
                "A. Omran",
                "H. Pichler",
                "S. Choi",
                "A.S. Zibrov",
                "M. Endres",
                "M. Greiner",
                "V. Vuleti\u0107",
                "M.D. Lukin"
            ],
            "title": "Probing manybody dynamics on a 51-atom quantum simulator",
            "venue": "Nature, 551(7682):579\u2013584, Nov",
            "year": 2017
        },
        {
            "authors": [
                "D.W. Berry",
                "G. Ahokas",
                "R. Cleve",
                "B.C. Sanders"
            ],
            "title": "Efficient quantum algorithms for simulating sparse Hamiltonians",
            "venue": "Commun. Math. Phys., 270(2):359\u2013371, Mar",
            "year": 2007
        },
        {
            "authors": [
                "D.W. Berry",
                "A.M. Childs",
                "Y. Su",
                "X. Wang",
                "N. Wiebe"
            ],
            "title": "Time-dependent Hamiltonian simulation with L1-norm scaling",
            "venue": "Quantum, 4:254,",
            "year": 2020
        },
        {
            "authors": [
                "R.C. Bialczak",
                "M. Ansmann",
                "M. Hofheinz",
                "E. Lucero",
                "M. Neeley",
                "A.D. O\u2019Connell",
                "D. Sank",
                "H. Wang",
                "J. Wenner",
                "M. Steffen",
                "A.N. Cleland",
                "J.M. Martinis"
            ],
            "title": "Quantum process tomography of a universal entangling gate implemented with Josephson phase qubits",
            "venue": "Nat. Phys.,",
            "year": 2010
        },
        {
            "authors": [
                "S. Blanes",
                "F. Casas",
                "J. Ros"
            ],
            "title": "Extrapolation of symplectic Integrators",
            "venue": "Celestial Mech. Dyn. Astron., 75:149\u2013161,",
            "year": 1999
        },
        {
            "authors": [
                "S. Bravyi",
                "D. Gosset",
                "R. K\u00f6nig",
                "M. Tomamichel"
            ],
            "title": "Quantum advantage with noisy shallow circuits",
            "venue": "Nat. Phys., 16(10): 1040\u20131045, Oct",
            "year": 2020
        },
        {
            "authors": [
                "A. Browaeys",
                "T. Lahaye"
            ],
            "title": "Many-body physics with individually controlled Rydberg atoms",
            "venue": "Nat. Phys., 16(2):132\u2013142, Feb",
            "year": 2020
        },
        {
            "authors": [
                "J.C. Butcher"
            ],
            "title": "Numerical Methods for Ordinary Differential Equations",
            "venue": "Wiley, 3 edition, 7",
            "year": 2016
        },
        {
            "authors": [
                "Z. Cai",
                "S.C. Benjamin"
            ],
            "title": "Constructing smaller Pauli twirling sets for arbitrary error channels",
            "venue": "Sci. Rep., 9(1):11281, Aug",
            "year": 2019
        },
        {
            "authors": [
                "E. Campbell"
            ],
            "title": "Random compiler for fast hamiltonian simulation",
            "venue": "Phys. Rev. Lett., 123:070503, Aug",
            "year": 2019
        },
        {
            "authors": [
                "A. Carrera Vazquez",
                "S. Woerner"
            ],
            "title": "Efficient state preparation for quantum amplitude estimation",
            "venue": "Phys. Rev. Applied, 15: 034027, Mar",
            "year": 2021
        },
        {
            "authors": [
                "I. Chen",
                "B. Burdick",
                "Y. Yao",
                "P.P. Orth",
                "T. Iadecola"
            ],
            "title": "Error-mitigated simulation of quantum many-body scars on quantum computers with pulse-level control",
            "venue": "Phys. Rev. Res., 4:043027, Oct",
            "year": 2022
        },
        {
            "authors": [
                "A. Chiesa",
                "F. Tacchino",
                "M. Grossi",
                "P. Santini",
                "I. Tavernelli",
                "D. Gerace",
                "S. Car"
            ],
            "title": "Accepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 11 retta. Quantum hardware simulating fourdimensional inelastic neutron scattering",
            "venue": "Nat. Phys.,",
            "year": 2019
        },
        {
            "authors": [
                "A.M. Childs"
            ],
            "title": "On the relationship between continuous- and discrete-time quantum walk",
            "venue": "Commun. Math. Phys., 294(2): 581\u2013603, Mar",
            "year": 2010
        },
        {
            "authors": [
                "A.M. Childs",
                "R. Kothari"
            ],
            "title": "Limitations on the simulation of non-sparse Hamiltonians",
            "venue": "Quantum Info. Comput., 10(7):669\u2013 684, July",
            "year": 2010
        },
        {
            "authors": [
                "A.M. Childs",
                "R. Kothari"
            ],
            "title": "Simulating sparse Hamiltonians with star decompositions",
            "venue": "Proc. 5th Conf. Theory Quantum Comput. Commun. Cryptogr., pages 94\u2013103,",
            "year": 2011
        },
        {
            "authors": [
                "A.M. Childs",
                "Y. Su"
            ],
            "title": "Nearly optimal lattice simulation by product formulas",
            "venue": "Phys. Rev. Lett., 123:050503, Aug",
            "year": 2019
        },
        {
            "authors": [
                "A.M. Childs",
                "N. Wiebe"
            ],
            "title": "Hamiltonian simulation using linear combinations of unitary operations",
            "venue": "Quantum Info. Comput., 12(11\u201312):901\u2013924, November",
            "year": 2012
        },
        {
            "authors": [
                "A.M. Childs",
                "R. Cleve",
                "E. Deotto",
                "E. Farhi",
                "S. Gutmann",
                "D.A. Spielman"
            ],
            "title": "Exponential algorithmic speedup by a quantum walk",
            "venue": "Proc. 35th Annu. ACM Symp. Theory Comput., pages 59\u201368,",
            "year": 2003
        },
        {
            "authors": [
                "A.M. Childs",
                "D. Maslov",
                "Y. Nam",
                "N.J. Ross",
                "Y. Su"
            ],
            "title": "Toward the first quantum simulation with quantum speedup",
            "venue": "PNAS, 115(38):9456\u20139461,",
            "year": 2018
        },
        {
            "authors": [
                "A.M. Childs",
                "Y. Su",
                "M.C. Tran",
                "N. Wiebe",
                "S. Zhu"
            ],
            "title": "Theory of Trotter error with commutator scaling",
            "venue": "Phys. Rev. X, 11(1): 011020, February",
            "year": 2021
        },
        {
            "authors": [
                "S.A. Chin"
            ],
            "title": "Multi-product splitting and Runge-Kutta-Nystr\u00f6m integrators",
            "venue": "Celestial Mech. Dyn. Astron., 106(4):391\u2013 406, Apr",
            "year": 2010
        },
        {
            "authors": [
                "C. C\u00eerstoiu",
                "Z. Holmes",
                "J. Iosue",
                "L. Cincio",
                "P.J. Coles",
                "A. Sornborger"
            ],
            "title": "Variational fast forwarding for quantum simulation beyond the coherence time",
            "venue": "npj Quantum Inf., 6(1):82, Sep",
            "year": 2020
        },
        {
            "authors": [
                "R.M. Corless",
                "G.H. Gonnet",
                "D.E.G. Hare",
                "D.J. Jeffrey",
                "D.E. Knuth"
            ],
            "title": "On the Lambert W function",
            "venue": "Adv. Comput. Math., 5(4): 329\u2013359,",
            "year": 1996
        },
        {
            "authors": [
                "A. Di Paolo",
                "P. Kl"
            ],
            "title": "Barkoutsos, I",
            "venue": "Tavernelli, and A. Blais. Variational quantum simulation of ultrastrong light-matter coupling. Phys. Rev. Research, 2:033364, Sep",
            "year": 2020
        },
        {
            "authors": [
                "E.F. Dumitrescu",
                "A.J. McCaskey",
                "G. Hagen",
                "G.R. Jansen",
                "T.D. Morris",
                "T. Papenbrock",
                "R.C. Pooser",
                "D.J. Dean",
                "P. Lougovski"
            ],
            "title": "Cloud quantum computing of an atomic nucleus",
            "venue": "Phys. Rev. Lett., 120:210501, May",
            "year": 2018
        },
        {
            "authors": [
                "N. Earnest",
                "C. Tornow",
                "D.J. Egger"
            ],
            "title": "Pulse-efficient circuit transpilation for quantum applications on cross-resonancebased hardware",
            "venue": "Phys. Rev. Research, 3: 043088, Oct",
            "year": 2021
        },
        {
            "authors": [
                "D.J. Egger",
                "F.K. Wilhelm"
            ],
            "title": "Multimode circuit quantum electrodynamics with hybrid metamaterial transmission lines",
            "venue": "Phys. Rev. Lett., 111:163601, Oct",
            "year": 2013
        },
        {
            "authors": [
                "S. Endo",
                "Q. Zhao",
                "Y. Li",
                "S. Benjamin",
                "X. Yuan"
            ],
            "title": "Mitigating algorithmic errors in a Hamiltonian simulation",
            "venue": "Phys. Rev. A, 99:012334, Jan",
            "year": 2019
        },
        {
            "authors": [
                "S. Endo",
                "J. Sun",
                "Y. Li",
                "S.C. Benjamin",
                "X. Yuan"
            ],
            "title": "Variational quantum simulation of general processes",
            "venue": "Phys. Rev. Lett., 125:010501, Jun",
            "year": 2020
        },
        {
            "authors": [
                "P.K. Faehrmann",
                "M. Steudtner",
                "R. Kueng",
                "M. Kieferova",
                "J. Eisert"
            ],
            "title": "Randomizing multi-product formulas for Hamiltonian simulation",
            "venue": "Quantum, 6:806, September",
            "year": 2022
        },
        {
            "authors": [
                "R.P. Feynman"
            ],
            "title": "Simulating physics with computers",
            "venue": "Int. J. Theor. Phys., 21(6):467\u2013 Accepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 12 488, Jun",
            "year": 1982
        },
        {
            "authors": [
                "L.E. Fischer",
                "D. Miller",
                "F. Tacchino",
                "P. Kl"
            ],
            "title": "Barkoutsos, D",
            "venue": "J. Egger, and I. Tavernelli. Ancilla-free implementation of generalized measurements for qubits embedded in a qudit space. Phys. Rev. Research, 4: 033027, Jul",
            "year": 2022
        },
        {
            "authors": [
                "A. Frisk Kockum",
                "A. Miranowicz",
                "S. De Liberato",
                "S. Savasta",
                "F. Nori"
            ],
            "title": "Ultrastrong coupling between light and matter",
            "venue": "Nat. Rev. Phys., 1(1):19\u201340, Jan",
            "year": 2019
        },
        {
            "authors": [
                "J. Gacon",
                "C. Zoufal",
                "G. Carleo",
                "S. Woerner"
            ],
            "title": "Simultaneous Perturbation Stochastic Approximation of the Quantum Fisher Information",
            "venue": "Quantum, 5:567, October",
            "year": 2021
        },
        {
            "authors": [
                "G. Garc\u00eda-P\u00e9rez",
                "M.A.C. Rossi",
                "B. Sokolov",
                "F. Tacchino",
                "P. Kl"
            ],
            "title": "Barkoutsos, G",
            "venue": "Mazzola, I. Tavernelli, and S. Maniscalco. Learning to measure: Adaptive informationally complete generalized measurements for quantum algorithms. PRX Quantum, 2:040342, Nov",
            "year": 2021
        },
        {
            "authors": [
                "T. Giurgica-Tiron",
                "Y. Hindy",
                "R. LaRose",
                "A. Mari",
                "W.J. Zeng"
            ],
            "title": "Digital zero noise extrapolation for quantum error mitigation",
            "venue": "IEEE Int. Conf. on QCE, pages 306\u2013316,",
            "year": 2020
        },
        {
            "authors": [
                "C. Gross",
                "I. Bloch"
            ],
            "title": "Quantum simulations with ultracold atoms in optical lattices",
            "venue": "Science, 357(6355):995\u20131001,",
            "year": 2017
        },
        {
            "authors": [
                "C. Hadfield",
                "S. Bravyi",
                "R. Raymond",
                "A. Mezzacapo"
            ],
            "title": "Measurements of quantum Hamiltonians with locally-biased classical shadows",
            "venue": "Commun. Math. Phys., 391(3): 951\u2013967, May",
            "year": 2022
        },
        {
            "authors": [
                "M. Hagan",
                "N. Wiebe"
            ],
            "title": "Composite quantum simulations. 2022",
            "venue": "URL https:// arxiv.org/abs/2206.06409",
            "year": 2022
        },
        {
            "authors": [
                "G. Hao Low",
                "V. Kliuchnikov",
                "N. Wiebe"
            ],
            "title": "Well-conditioned multiproduct Hamiltonian simulation. 2019",
            "venue": "URL https://arxiv",
            "year": 1907
        },
        {
            "authors": [
                "A.W. Harrow",
                "A. Hassidim",
                "S. Lloyd"
            ],
            "title": "Quantum algorithm for linear systems of equations",
            "venue": "Phys. Rev. Lett., 103: 150502, Oct",
            "year": 2009
        },
        {
            "authors": [
                "A. Hashim",
                "R.K. Naik",
                "A. Morvan",
                "J.L. Ville",
                "B. Mitchell",
                "J.M. Kreikebaum",
                "M. Davis",
                "E. Smith",
                "C. Iancu",
                "K.P. O\u2019Brien",
                "I. Hincks",
                "J.J. Wallman",
                "J. Emerson",
                "I. Siddiqi"
            ],
            "title": "Randomized compiling for scalable quantum computing on a noisy superconducting quantum processor",
            "venue": "Phys. Rev. X,",
            "year": 2021
        },
        {
            "authors": [
                "A. He",
                "B. Nachman",
                "W.A. de Jong",
                "C.W. Bauer"
            ],
            "title": "Zero-noise extrapolation for quantum-gate error mitigation with identity insertions",
            "venue": "Phys. Rev. A,",
            "year": 2020
        },
        {
            "authors": [
                "A. Hoorfar",
                "M. Hassani"
            ],
            "title": "Inequalities on the Lambert W function and hyperpower function",
            "venue": "JIPAM, 9, 01",
            "year": 2008
        },
        {
            "authors": [
                "H.-Y. Huang",
                "R. Kueng",
                "J. Preskill"
            ],
            "title": "Predicting many properties of a quantum system from very few measurements",
            "venue": "Nat. Phys., 16(10):1050\u20131057, Oct",
            "year": 2020
        },
        {
            "authors": [
                "S. Indrajeet",
                "H. Wang",
                "M.D. Hutchings",
                "B.G. Taketani",
                "F.K. Wilhelm",
                "M.D. La- Haye",
                "B.L.T. Plourde"
            ],
            "title": "Coupling a superconducting qubit to a left-handed metamaterial resonator",
            "venue": "Phys. Rev. Applied, 14: 064033, Dec",
            "year": 2020
        },
        {
            "authors": [
                "P. Jurcevic",
                "A. Javadi-Abhari",
                "L.S. Bishop",
                "I. Lauer",
                "D.F. Bogorin",
                "M. Brink",
                "L. Capelluto",
                "O. G\u00fcnl\u00fck",
                "T. Itoko",
                "N. Kanazawa"
            ],
            "title": "Demonstration of quantum volume 64 on a superconducting quantum computing system",
            "venue": "Quantum Sci. Technol.,",
            "year": 2021
        },
        {
            "authors": [
                "H. Kamakari",
                "S.N. Sun",
                "M. Motta",
                "Austin J. Minnich"
            ],
            "title": "Digital quantum simulation of open quantum systems using quantum imaginary\u2013time evolution",
            "venue": "PRX Quantum,",
            "year": 2022
        },
        {
            "authors": [
                "Naoki Kanazawa",
                "Daniel J. Egger",
                "Yael Ben- Haim",
                "Helena Zhang",
                "William E. Shanks",
                "Gadi Aleksandrowicz",
                "Christopher J. Wood"
            ],
            "title": "Qiskit experiments: A python pack- Accepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 13 age to characterize and calibrate quantum computers",
            "venue": "J. Open Source Softw.,",
            "year": 2023
        },
        {
            "authors": [
                "A. Kandala",
                "K. Temme",
                "A.D. C\u00f3rcoles",
                "A. Mezzacapo",
                "J.M. Chow",
                "J.M. Gambetta"
            ],
            "title": "Error mitigation extends the computational reach of a noisy quantum processor",
            "venue": "Nature, 567(7749):491\u2013495, Mar",
            "year": 2019
        },
        {
            "authors": [
                "Y. Kim",
                "C.J. Wood",
                "T.J. Yoder",
                "S.T. Merkel",
                "J.M. Gambetta",
                "K. Temme",
                "A. Kandala"
            ],
            "title": "Scalable error mitigation for noisy quantum circuits produces competitive expectation values",
            "venue": "Nat. Phys., 19(5):752\u2013 759, May",
            "year": 2023
        },
        {
            "authors": [
                "A.M.R. LaRose",
                "S. Kaiser",
                "P.J. Karalekas",
                "A.A. Alves",
                "P. Czarnik",
                "M. El Mandouh",
                "M.H. Gordon",
                "Y. Hindy",
                "P.T.A. Robertson",
                "N. Shammah",
                "W.J. Zeng"
            ],
            "title": "Mitiq: A software package for error mitigation on noisy quantum computers",
            "venue": "ISSN 2521-327X. DOI: 10.22331/q-2022-08-11-774",
            "year": 2022
        },
        {
            "authors": [
                "D. Layden"
            ],
            "title": "First-order Trotter error from a second-order perspective",
            "venue": "Phys. Rev. Lett., 128:210501, May",
            "year": 2022
        },
        {
            "authors": [
                "A.J. Leggett",
                "S. Chakravarty",
                "A.T. Dorsey",
                "Matthew P.A. Fisher",
                "A. Garg",
                "W. Zwerger"
            ],
            "title": "Dynamics of the dissipative two-state system",
            "venue": "Rev. Mod. Phys.,",
            "year": 1987
        },
        {
            "authors": [
                "Y. Li",
                "S.C. Benjamin"
            ],
            "title": "Efficient variational quantum simulator incorporating active error minimization",
            "venue": "Phys. Rev. X, 7: 021050, Jun",
            "year": 2017
        },
        {
            "authors": [
                "D.A. Lidar"
            ],
            "title": "Review of Decoherence- Free Subspaces, Noiseless Subsystems, and Dynamical Decoupling, pages 295\u2013354",
            "venue": "John Wiley & Sons, Ltd,",
            "year": 2014
        },
        {
            "authors": [
                "S. Lloyd"
            ],
            "title": "Universal quantum simulators",
            "venue": "Science, 273(5278):1073\u20131078,",
            "year": 1996
        },
        {
            "authors": [
                "E. Magesan",
                "J.M. Gambetta"
            ],
            "title": "Effective Hamiltonian models of the cross-resonance gate",
            "venue": "Phys. Rev. A, 101:052308, May",
            "year": 2020
        },
        {
            "authors": [
                "A.D. McLachlan"
            ],
            "title": "A variational solution of the time-dependent Schrodinger equation",
            "venue": "Mol. Phys., 8(1):39\u201344,",
            "year": 1964
        },
        {
            "authors": [
                "A. Miessen",
                "P.J. Ollitrault",
                "I. Tavernelli"
            ],
            "title": "Quantum algorithms for quantum dynamics: A performance study on the spin-boson model",
            "venue": "Phys. Rev. Research, 3:043212, Dec",
            "year": 2021
        },
        {
            "authors": [
                "M. Mohseni",
                "A.T. Rezakhani",
                "D.A. Lidar"
            ],
            "title": "Quantum-process tomography: Resource analysis of different strategies",
            "venue": "Phys. Rev. A, 77:032322, Mar",
            "year": 2008
        },
        {
            "authors": [
                "Y. Ouyang",
                "D.R. White",
                "E.T. Campbell"
            ],
            "title": "Compilation by stochastic Hamiltonian sparsification",
            "venue": "Quantum, 4:235, February",
            "year": 2020
        },
        {
            "authors": [
                "B. Pokharel",
                "N. Anand",
                "B. Fortman",
                "D.A. Lidar"
            ],
            "title": "Demonstration of fidelity improvement using dynamical decoupling with superconducting qubits",
            "venue": "Phys. Rev. Lett., 121:220502, Nov",
            "year": 2018
        },
        {
            "authors": [
                "L.F. Richardson"
            ],
            "title": "The approximate arithmetical solution by finite differences of physical problems involving differential equations, with an application to the stresses in a masonry dam",
            "venue": "Philos. Trans. R. Soc. London, Ser. A, 210:307\u2013357,",
            "year": 1911
        },
        {
            "authors": [
                "S. Sachdev"
            ],
            "title": "Quantum Phase Transitions",
            "venue": "Cambridge University Press, 2 edition,",
            "year": 2011
        },
        {
            "authors": [
                "S. Sheldon",
                "E. Magesan",
                "J.M. Chow",
                "J.M. Gambetta"
            ],
            "title": "Procedure for systematically tuning up cross-talk in the cross-resonance gate",
            "venue": "Phys. Rev. A, 93: 060302, Jun",
            "year": 2016
        },
        {
            "authors": [
                "A. Sidi"
            ],
            "title": "Practical Extrapolation Methods: Theory and Applications",
            "venue": "Cambridge Uni- Accepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 14 versity Press,",
            "year": 2003
        },
        {
            "authors": [
                "N. Stamatopoulos",
                "D.J. Egger",
                "Y. Sun",
                "C. Zoufal",
                "R. Iten",
                "N. Shen",
                "S. Woerner"
            ],
            "title": "Option Pricing using Quantum Computers",
            "venue": "Quantum, 4:291, July",
            "year": 2020
        },
        {
            "authors": [
                "J.P.T. Stenger",
                "N.T. Bronn",
                "D.J. Egger",
                "D. Pekker"
            ],
            "title": "Simulating the dynamics of braiding of Majorana zero modes using an IBM quantum computer",
            "venue": "Phys. Rev. Research, 3:033171, Aug",
            "year": 2021
        },
        {
            "authors": [
                "N. Sundaresan",
                "I. Lauer",
                "E. Pritchett",
                "E. Magesan",
                "P. Jurcevic",
                "J.M. Gambetta"
            ],
            "title": "Reducing unitary and spectator errors in cross resonance with optimized rotary echoes",
            "venue": "PRX Quantum, 1:020318, Dec",
            "year": 2020
        },
        {
            "authors": [
                "M. Suzuki"
            ],
            "title": "General theory of fractal path integrals with applications to manybody theories and statistical physics",
            "venue": "J. Math. Phys., 32(2):400\u2013407,",
            "year": 1991
        },
        {
            "authors": [
                "K. Temme",
                "S. Bravyi",
                "J.M. Gambetta"
            ],
            "title": "Error mitigation for short-depth quantum circuits",
            "venue": "Phys. Rev. Lett., 119: 180509, Nov",
            "year": 2017
        },
        {
            "authors": [
                "C. Tornow",
                "N. Kanazawa",
                "W.E. Shanks",
                "D.J. Egger"
            ],
            "title": "Minimum quantum runtime characterization and calibration via restless measurements with dynamic repetition rates",
            "venue": "Phys. Rev. Applied, 17: 064061, Jun",
            "year": 2022
        },
        {
            "authors": [
                "V. Tripathi",
                "H. Chen",
                "M. Khezri",
                "K.W. Yip",
                "E.M. Levenson-Falk",
                "D.A. Lidar"
            ],
            "title": "Suppression of crosstalk in superconducting qubits using dynamical decoupling",
            "venue": "Phys. Rev. Appl., 18:024068, Aug",
            "year": 2022
        },
        {
            "authors": [
                "A. Vazquez Carrera",
                "R. Hiptmair",
                "S. Woerner"
            ],
            "title": "Enhancing the quantum linear systems algorithm using richardson extrapolation",
            "venue": "ACM Trans. Quantum Comput., 3(1), jan",
            "year": 2022
        },
        {
            "authors": [
                "J.J. Wallman",
                "J. Emerson"
            ],
            "title": "Noise tailoring for scalable quantum computation via randomized compiling",
            "venue": "Phys. Rev. A, 94: 052325, Nov",
            "year": 2016
        },
        {
            "authors": [
                "K. Wan",
                "M. Berta",
                "E.T. Campbell"
            ],
            "title": "Randomized quantum algorithm for statistical phase estimation",
            "venue": "Phys. Rev. Lett., 129:030503, Jul",
            "year": 2022
        },
        {
            "authors": [
                "D. Wecker",
                "B. Bauer",
                "B.K. Clark",
                "M.B. Hastings",
                "M. Troyer"
            ],
            "title": "Gate-count estimates for performing quantum chemistry on small quantum computers",
            "venue": "Phys. Rev. A, 90:022305, Aug",
            "year": 2014
        },
        {
            "authors": [
                "J. Weidenfeller",
                "L.C. Valor",
                "J. Gacon",
                "C. Tornow",
                "L. Bello",
                "S. Woerner",
                "D.J. Egger"
            ],
            "title": "Scaling of the quantum approximate optimization algorithm on superconducting qubit based hardware",
            "venue": "Quantum, 6: 870, December",
            "year": 2022
        },
        {
            "authors": [
                "Y. Yongxin"
            ],
            "title": "Quantum many-body scars on QC, 2022",
            "venue": "URL https://gitlab.com/ QANED/rydberg_mfim",
            "year": 2022
        },
        {
            "authors": [
                "X. Yuan",
                "S. Endo",
                "Q. Zhao",
                "Ying Li",
                "S. Benjamin"
            ],
            "title": "Theory of variational quantum simulation. Quantum",
            "year": 2019
        },
        {
            "authors": [
                "J. Zhang",
                "G. Pagano",
                "P.W. Hess",
                "A. Kyprianidis",
                "P. Becker",
                "H. Kaplan",
                "A.V. Gorshkov",
                "Z.-X. Gong",
                "C. Monroe"
            ],
            "title": "Observation of a many-body dynamical phase transition with a 53-qubit quantum simulator",
            "venue": "Nature, 551(7682):601\u2013604, Nov",
            "year": 2017
        }
    ],
    "sections": [
        {
            "text": "Well-conditioned multi-product formulas for hardwarefriendly Hamiltonian simulation Almudena Carrera Vazquez1,2, Daniel J. Egger1, David Ochsner1,2, and Stefan Woerner1\n1IBM Quantum, IBM Research Europe \u2013 Zurich 2ETH Zurich\nSimulating the time-evolution of a Hamiltonian is one of the most promising applications of quantum computers. Multi-Product Formulas (MPFs) are well suited to replace standard product formulas since they scale better with respect to time and approximation errors. Hamiltonian simulation with MPFs was first proposed in a fully quantum setting using a linear combination of unitaries. Here, we analyze and demonstrate a hybrid quantum-classical approach to MPFs that classically combines expectation values evaluated with a quantum computer. This has the same approximation bounds as the fully quantum MPFs, but, in contrast, requires no additional qubits, no controlled operations, and is not probabilistic. We show how to design MPFs that do not amplify the hardware and sampling errors, and demonstrate their performance. In particular, we illustrate the potential of our work by theoretically analyzing the benefits when applied to a classically intractable spin-boson model, and by computing the dynamics of the transverse field Ising model using a classical simulator as well as quantum hardware. We observe an error reduction of up to an order of magnitude when compared to a product formula approach by suppressing hardware noise with Pauli Twirling, pulse efficient transpilation, and a novel zeronoise extrapolation based on scaled crossresonance pulses. The MPF methodology reduces the circuit depth and may therefore represent an important step towards quantum advantage for Hamiltonian simulation on noisy hardware.\nStefan Woerner: wor@zurich.ibm.com"
        },
        {
            "heading": "1 Introduction",
            "text": "A major goal of quantum mechanics is to accurately describe how a given quantum system evolves with time. This was the original incentive argued by Feynman in 1981 to develop quantum computers [37]. More specifically, Hamiltonian simulation seeks to implement the operator e\u2212iHt as accurately as possible with an efficient quantum algorithm, which allows to study the time dynamics of a corresponding quantum system. Here, H is a Hermitian operator and efficient means that the running time should be polynomial in the size of the corresponding system, i.e., polylog(N) for a N \u00d7N Hamiltonian. For example, in the context of the spin-boson model this would enable the study of decoherence models at scale [60, 66].\nHamiltonian simulation can be done with system specific machines in which the hardware natively implements H, as exemplified by cold atoms [43], or with general purpose gate-based quantum computers. System specific machines allow large-scale simulation but only for the subset of Hamiltonians they natively support. Accurate Hamiltonian simulation on gate-based quantum computers is however challenging since e\u2212iHt has to be implemented on hardware with a native gate set and limited connectivity [87].\nMany quantum algorithms have been proposed to simulate Hamiltonians since Feynman\u2019s talk [66]. The choice of the algorithm depends on the structure of the Hamiltonian [19, 20], e.g., whether it is sparse or dense, time-dependent [5, 8] or time-independent, and whether the time evolution is real or imaginary [35, 54].\nHere, we focus on real-time simulations of a time-independent sparse Hamiltonian. Then, the two main approaches are variational quantum algorithms (VQA) [28, 61, 89, 91] and product formulas (PF) [2, 3, 7, 21, 24, 63]. VQAs do\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 1\nar X\niv :2\n20 7.\n11 26\n8v 3\n[ qu\nan t-\nph ]\n2 4\nJu l 2\n02 3\nnot implement the operator e\u2212iHt but instead create a parameterized variational ansatz |\u03c8(\u03b8)\u27e9 which approximates the state |\u03a6(t)\u27e9 governed by the Schr\u00f6dinger\u2019s equation [61]. The quantum computer is then used to determine the coefficients in an equation of motion (EOM) that is classically integrated. The depth and structure of the circuit determine how well the variational approach can approximate the true state evolution. A priori, this is not clear, and we have to rely on error bounds that can be evaluated a posteriori to improve the circuit design [91]. Further, VQAs must compute the coefficients in the EOM to high accuracy. This requires a large number of circuit executions rendering the VQA approach in its current implementation unlikely to lead to a quantum advantage for timedependent problems [66]. First steps towards overcoming this computational cost could include approximating the Quantum Fisher Information matrix using simultaneous perturbation stochastic approximation techniques [40]. In addition, the cost of estimating complex observables can be reduced with positive operator valued measures [38, 41] or classical shadows [44, 51]. In contrast, PFs are analytical techniques which perform well in practice and implement e\u2212iHt as an operator by breaking the Hamiltonian into subHamiltonians, each simulated as a circuit for a small time-step. The circuit depth grows polynomially with the inverse approximation error and the simulation time. Interestingly, the existing error bounds for PFs can be several orders of magnitude larger than measured errors, even for small systems [25, 26, 46, 59], which suggests that further investigation is needed.\nA promising candidate to replace PFs are multi-product formulas (MPF) [10, 23], which can be seen as a form of Richardson extrapolation [13, 71, 74]. Here, we show how to use MPFs to mitigate algorithmic errors in PFs by classically combining expectation values instead of implementing a quantum Linear Combination of Unitaries (LCU) [23], which was the original quantum algorithm proposed in 2012. We run a PF several times on a gate-based quantum computer with a different number of Trotter steps to estimate the same expectation value. Then, we linearly combine these estimates on a classical computer into a better estimate of the expectation value, which would otherwise only be\nobtainable with a large number of Trotter steps, i.e., significantly deeper circuits.\nOur work makes both an algorithmic and a hardware contribution to Hamiltonian simulation with MPFs. We now describe how we build on existing references. The idea to classically combine expectation values to mitigate algorithmic errors was first introduced in 2018 in Ref. [34] applied to Hamiltonian simulation. Next, Ref. [83] showed that such a classical combination reduces the resources needed to implement the HHL algorithm [47]. In particular, Ref. [34] noticed that Richardson extrapolation can mitigate both physical [61, 79] and algorithmic errors, and showed promise in numerical experiments performed with two and three extrapolation points. In 2019 Ref. [46] noticed that a non-careful choice of sequences of Trotter steps leads to exponentially small probabilities of success for MPFs implemented as an LCU. Our work generalizes the classical combination which Ref. [83] applied to tridiagonal Toeplitz symmetric matrices to arbitrary Hamiltonians. We further improve upon Ref. [83], which focused on the HHL algorithm and thus a Hamiltonian simulation embedded in the quantum phase estimation algorithm, by showing that the classical combination is applicable to observables arising in a general Hamiltonian simulation. We also solve the vanishing success probability issue raised by Ref. [46]. We also formalize the classical combination of expectation values for Hamiltonian simulation of Ref. [34], our contribution is an algorithm to create well-conditioned MPFs implemented as a classical combination of expectation values. Here, we explain how ill-conditioning, presented in Ref. [46], increases non-algorithmic errors when classically combining expectation values. The result of our work is a hardware-friendly MPF. Its circuit depth is quadratically lower than MPFs implemented as an LCU [46] since the individual product formulas in the MPF are independently run on the hardware. The ill-conditionning is avoided by a careful choice of Trotter exponents. We compare the different algorithms in Table 1.\nCrucially, we implement for the first time Hamiltonian simulation by MPF on quantum hardware. We observe an algorithmic error reduction of up to an order of magnitude while suppressing hardware noise [57] with Pauli Twirling,\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 2\npulse efficient transpilation [32], and a novel zero-noise extrapolation (ZNE) [61, 79] based on scaled cross-resonance pulses [76]. This last method is similar to digital ZNE [31, 42, 49] but allows for a continuous range of stretch factors without the need for costly pulse-calibration. We illustrate our work by computing the dynamics in simulation and on quantum hardware of the transverse field Ising model; a model ubiquitous in condensed matter and statistical mechanics [72]. The Ising Hamiltonian is\nH = \u2212J \u2211 \u27e8i,j\u27e9 ZiZj \u2212 h \u2211 i Xi, (1)\nwhere J denotes the interaction strength between nearest neighboring spins \u27e8i, j\u27e9, h the transverse magnetic field, and X and Z are Pauli operators. This model is often studied on both gatebased [17, 57] and analogue quantum simulations [6, 12, 90]. Additionally, we extend the scaling predictions made by Ref. [66] of the resources needed to simulate a classically intractable spinboson model by a first-order PF and VQA. We show that in this setting our method requires exponentially less resources with respect to the system size than a first-order PF.\nThe main limitation of PF based approaches, including this work, is that the number of gates depends linearly on the number of terms L in the Hamiltonian, which can grow very large for chemistry applications [86]. Using randomization, the qDRIFT protocol [15] addresses this problem by trading accuracy for an L-independent algorithm. Hybrid approaches that interpolate between qDRIFT and PFs improve the asymptotic complexity with respect to both methods [45, 68]. However, they do not improve the scaling with respect to the simulation time nor the precision. Randomizing the implementation of the LCU has also been explored. For example, Ref. [36] shows a drastic reduction in circuit depth by implementing the LCU on average and increasing the number of circuits. However, this method still requires two controlled PFs per circuit. Alternatively, Ref. [85] presents a randomized phase estimation algorithm based partially on the LCU approach and has an L-independent complexity. Although only one ancilla is required and most of the complexity is handled by the sampling, the circuits still require O(\u03f5\u22122) controlled Pauli rotations, where \u03f5 is the desired precision. The\nMPF approach we present here is suitable for simulating general dynamics, in contrast to Ref. [85], and for applications that require higher precision, since we achieve more accurate results by increasing the number of shallow circuits we run.\nThis paper is structured as follows. In Sec. 2 we review the theory of PFs and then show how to implement well-conditioned MPFs by classically combining the outcome of multiple PFs. Further, in Sec. 3 we update the resource estimate for spinboson models in Ref. [66] with our MPF approach to illustrate that we can achieve the same approximation accuracy as a first-order PF using shallower circuits. In Sec. 4, we discuss error mitigation strategies for quantum hardware and then illustrate our MPF method on fixed-frequency superconducing transmon qubits by simulating an Ising model. We conclude our work in Sec. 5 and provide suggestions for further research."
        },
        {
            "heading": "2 Multi-product formulas",
            "text": "Product formulas are used to build a unitary matrix approximating e\u2212iHt by (i) writing H as\u2211\nj Hj (e.g. where each Hj is a 1-sparse matrix [3, 24]) such that (ii) each e\u2212iHjt has an efficient quantum circuit representation, and finally (iii), if the matrices Hj do not commute with each other, use an approximation. The first-order PF\u2014also known as the Lie-Trotter formula\u2014is\nS1(t) := J\u220f\nj=1 e\u2212iHjt (2)\nand has a quadratic error term in t, i.e. S1(t) = e\u2212iHt + O(t2). Higher order PFs converge faster and are defined recursively as follows.\nDefinition 2.1 (Lie-Trotter-Suzuki, [78]). Let H \u2208 CN\u00d7N be a Hermitian matrix with H =\u2211J\nj=1Hj , and \u03c7 \u2208 N. Then, the 2\u03c7-order symmetric formula approximating e\u2212iHt is recursively defined by\nS2(t) := J\u220f\nj=1 e\u2212iHjt/2 1\u220f j=J e\u2212iHjt/2,\nS2\u03c7(t) := S2\u03c7\u22122 (s\u03c7t)2 S2\u03c7\u22122 [(1 \u2212 4s\u03c7) t]S2\u03c7\u22122 (s\u03c7t)2 , (3) where sp = ( 4 \u2212 41/(2p\u22121) )\u22121 for p \u2208 N.\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 3\nWhen the duration t of the time evolution is long we approximate e\u2212iHt by splitting t into k equal Trotter steps of length t/k and apply a product formula S\u03c7 in each interval such that\nSk\u03c7 ( t k ) = [ S\u03c7 ( t k )]k = e\u2212iHt + O(t ( tk )\u03c7). (4) The last equality follows from the triangle inequality. As the order \u03c7 of the PF increases the number of Trotter steps k required to reach a target error decreases. However, the depth of the quantum circuit scales exponentially with \u03c7 [23, 78]. Therefore, choosing the optimal formula for a given problem is a non-trivial task further complicated by the lack of tight analytical bounds [25]. Moreover, even if one could find the PF that minimizes the resources needed for a given Hamiltonian, it would still require deep circuits, rendering the PF approach very challenging to implement on noisy quantum hardware.\nMulti-product formulas, which can be seen as a form of Richardson extrapolation, are a promising candidate to replace product formulas [10, 23]. MPFs only require a sum of polynomially many unitary operations to achieve the same accuracy as PFs with exponentially many unitaries would. They achieve this by linearly combining PFs of the same order \u03c7 but varying Trotter exponents k to cancel lower order error terms.\nDefinition 2.2 (Multi-product formula). For l \u2208 N, we define the Trotter exponents as k\u20d7 =\n(k1, . . . , kl) where the ki\u2019s are distinct natural numbers, and the extrapolation weights as a\u20d7 = (a1, . . . , al) with ai \u2208 R. Then, the multi-product formula Ml,\u03c7(t) is\nMl,\u03c7(t) = l\u2211\nj=1 ajS\nkj \u03c7\n( t\nkj\n) , (5)\nwhere \u03c7, S\u03c7 are as in Def. 2.1. To cancel the first l\u2212 1 error terms, the extrapolation weights must satisfy\nl\u2211 j=1 aj = 1, and l\u22121\u2211 j=1 aj/k \u03b7 j = 0, (6)\nwhere \u03b7 = \u03c7+2n for symmetric product formulas and \u03b7 = \u03c7+ n otherwise, for n = 0, ..., l\u2212 2. For more details, see Appendix A."
        },
        {
            "heading": "2.1 Circuit implementation",
            "text": "Ref. [23] introduced MPFs as a quantum algorithm to approximate Hamiltonian simulation. The linear combination in Eq. (5) is translated to a quantum circuit by the Linear Combination of Unitaries (LCU) method, illustrated in Fig. 1. Asymptotically, this method with kj = j, i.e. the minimal sequence with l different natural numbers, implements O ( l2 )\nTrotter steps and approximates the Hamiltonian better than PFs with as many Trotter steps. More precisely, MPFs require exponentially fewer Trotter steps [27] to\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 4\nachieve the same accuracy. However, the LCU implementation is probabilistic with a success probability that decreases exponentially as e\u2212\u2126(l). Furthermore, even the shallowest circuits are too deep to implement on noisy hardware since the LCU method sums Trotter steps of varying order as controlled unitaries, requiring additional qubits and controlled operations. For example, simulating a five linearly connected spin Ising model with an MPF with k\u20d7 = [k1, k2, k3] implemented by an LCU requires 108(k1+k2)+40k3+4 CNOT gates, see Appendix B.\nWhile Eq. (5) is a linear combination of operators, in practice we measure operator expectation values after a quantum circuit. Crucially, as we show here and illustrate in Fig. 1, the linear combination in MPFs can thus be done classically. This allows to parallelize the circuits implementing the PF for different Trotter steps, resulting in shallow circuits with O(l) Trotter steps, which is better for noisy hardware. We therefore implement each Skj\u03c7 in Eq. (5) as an independent quantum circuit. As shown in Appendix C we can substitute the S\u03c7\u2019s in Eq. (5) by their expectation values. More precisely, computing an expectation value E after approximately simulating e\u2212iHt with the PF Skj2\u03c7(t/kj) yields an approximation Ej of the expectation value E for each Trotter exponent kj with an approximation error related to \u03c7 and kj by Eq. (4). Finally, combining the Ej \u2019s as\nl\u2211 j=1\najEj = E + O ( t2(\u03c7+l)+1\nk 2(\u03c7+l) 1\n) , (7)\ngives an estimation of E where the remaining asymptotic error depends on the base PF, see Appendix A."
        },
        {
            "heading": "2.2 Choosing Trotter exponents",
            "text": "MPFs can achieve exponentially lower algorithmic errors than PFs while requiring similar circuit depths. However, a poor choice of the Trotter exponents and extrapolation weights amplifies other error sources such as physical or sampling noise so that the error in the final quantity is larger than the largest algorithmic error in the MPF. This choice-of-sequences issue was raised in Ref. [46] where the authors noted that choosing the arithmetic progression for the Trotter exponents kj = j, which gives the shortest circuits,\nj S kj 1 (t/kj) and is successful if the measurement outcome of the top two qubits is 0. Our method implements each of the PFs as a separate quantum circuit and calculates the linear combination classically. Running the PFs separately instead of in sequence circumvents the need of auxiliary qubits and significantly reduces the circuit depth, especially as the number of terms in the linear combination increases.\nleads to an ill-conditioned MPF, i.e. \u2225a\u20d7\u22251 = e\u2126(l) where \u2225a\u20d7\u22251 := \u2211l j |aj |. When implemented as a quantum circuit as an LCU this ill-conditioning translates into an exponentially small success probability scaling as O ( \u2225a\u20d7\u2225\u221221 ) . Since our approach is not probabilistic, i.e., we classically compute the linear combination in Eq. (7) rather than implementingMl,\u03c7 as an LCU, the condition number \u2225a\u20d7\u22251 amplifies any error that is not the Trotter error by a factor of \u2225a\u20d7\u22251. More precisely, suppose that in Eq. (7) we calculated the expectation values Ej with a quantum computer and we have several error sources. If \u03b5(kj) denotes the algorithmic error of the Trotter exponent kj and other sources arising from, e.g., sampling or physical noise are labelled \u03b5\u2032, then\nEj = E + \u03b5(kj) + \u03b5\u2032. (8)\nNow, the result of the MPF is\nl\u2211 j=1 aj ( E + \u03b5(kj) + \u03b5\u2032 ) (9)\n= E + O ( t2(l+\u03c7)+1\nk 2(l+\u03c7) 1\n) + O ( \u2225a\u20d7\u22251\u03b5\n\u2032) . (10) Eq. (10) shows that if \u2225a\u20d7\u22251 is large, then \u03b5\u2032 is amplified and as a result, the sum in Eq. (9) can be a worse approximation to E than the Ej \u2019s. Appendix D shows a toy example illustrating the\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 5\nasymptotic behaviour, where \u03b5\u2032 is the sampling noise of a Bernoulli variable. Here, the increase in non-algorithmic errors results in an increase in the sampling overhead.\nRef. [46] provides choices of k\u20d7 for which \u2225a\u20d7\u22251 remains \u201csmall\u201d to avoid exponentially low success probabilities, i.e., ill-conditioned MPFs. The authors minimize either \u2225a\u20d7\u22251\u2225k\u20d7\u22251 or \u2225a\u20d7\u22251 and provide the corresponding values for \u03c7 = 2 and 4. Their method requires O ( l2 log l ) Trotter steps to\nimplement the LCU instead of O ( l2 )\nfor kj = j. By contrast, our classical combination of expectation values needs only O(l log l) Trotter steps for the longest circuit. Importantly, the condition number decreases exponentially from \u2225a\u20d7\u22251 = e\u2126(l) to \u2225a\u20d7\u22251 = O(log l). Furthermore, Tab. I in Ref. [46] shows that for an MPF based on S2 and a practical value of l \u2264 15, the condition number \u2225a\u20d7\u22251 < 1.7 and is therefore negligible. To avoid increasing non-algorithmic errors, see Eq. (10), we chose the Trotter exponents by minimizing \u2225a\u20d7\u22251 under the constraints in Eq. (6) for a given possible range of the kj \u2019s. The algorithm is described in Appendix E.\nWe illustrate how to choose the Trotter exponents with the Ising model for five linearly connected spins, see Eq. (1), with H1 = \u2212J \u22113 i=0 ZiZi+1 and H2 = \u2212h \u22114 i=0Xi. Therefore, e\u2212iH1t and e\u2212iH2t are implemented with layers of two-qubit RZZ and single-qubit RX rotations, respectively. As benchmark we compute the exact local magnetization \u27e8Z0\u27e9\u2217 for h = 1, J = 0.5 and t = 0.5 by numerically exponentiating H1 + H2. Next, we compute the local magnetization \u27e8Z0(kj)\u27e9 with a first-order PF and kj Trotter steps. We calculate the relative error |\u27e8Z0(kj)\u27e9 \u2212 \u27e8Z0\u27e9\u2217|/|\u27e8Z0\u27e9\u2217| which we fit to k\u22121j , see the blue dots and dashed line in Fig. 2. The condition number of an MPF based on S1 grows faster than for S2, see Appendix D. Therefore, we empirically set the threshold defining a well-conditioned MPF to \u2225a\u20d7\u22251 \u2264 3 instead of 1.7. Thus, we compute well- and ill-conditioned MPFs, with \u2225a\u20d7\u22251 \u2264 3 and \u2225a\u20d7\u22251 > 3, respectively, with different Trotter exponents by classically combining the expectation values \u27e8Z0(kj)\u27e9. The values of a\u20d7 are given in Appendix E. In the absence of non-algorithmic errors, i.e., \u03b5\u2032 = 0, all MPFs reduce the error compared to the benchmark, see triangles in Fig. 2. Next, we artificially add a fixed perturbation \u03b5\u2032 = 10\u22123 fol-\nlowing \u27e8Z0(kj)\u27e9 \u2192 \u27e8Z0(kj)\u27e9 + sign(aj)\u03b5\u2032 before performing the linear combination. The wellconditioned MPFs still reduce the error compared to ill-conditioned sequences which are worse than the benchmark, see stars in Fig. 2. For example, the noisy S1-based MPF [2, 4] whose deepest circuit requires k2 = 4 Trotter steps has a lower error than the PF with k = 8 Totter steps. This is a factor of two reduction in circuit depth."
        },
        {
            "heading": "3 Spin-boson model",
            "text": "The spin-boson model [60] is a model of quantum dissipation. It gives insights into the transition between coherent and incoherent behaviour as well as a phase transition suppressing quantum tunneling. Its dynamics can be simulated with analogue simulators [33, 52] or gate-based quantum computers [66]. In Ref. [66] the authors compare the performance of VQAs based on McLachlan\u2019s variational principle [65] against a first-order PF to simulate the dynamics of the spin-boson model. The authors made scaling predictions for a classically intractable system for\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 6\nboth, VQA and first-order PFs. They conclude that VQA in its current form is unlikely to lead to a quantum advantage due to the large number of circuit executions, although it is assumed to have shallower circuits than first-order PFs. Further, they show that first-order PFs that achieve the desired accuracy lead to very deep circuits, which might render them infeasible as well. We now extend their results by adding second-order PFs and MPFs to the comparison, showing a significant circuit depth reduction.\nMore precisely, the spin-boson Hamiltonian\nH = M\u2211\nk=1 \u03c9ka\n\u2020 kak+ \u03c9s 2 Z+\u2206X+ M\u2211 k=1 gkX ( a\u2020k + ak ) (11)\ndescribes a two-level system, such as an atom, coupled to a bath of M bosons [30, 39]. Here, the bosonic operators a\u2020k (ak) create (annihilate) harmonic basis states with eigenfrequencies \u03c9k. The Pauli matrices X, Z act on the state of the spin with eigenfrequency \u03c9s and tunneling rate \u2206. The coupling strength between the spin and the kth bosonic mode is gk. As in Ref. [66] we consider the resonant case \u03c9k \u2261 \u03c9, gk \u2261 g and ultrastrong coupling, i.e. g/\u03c9 = 0.5 with \u03c9s = \u22121 and \u2206 = 0. We consider different spin-boson models in which the M bosonic modes are truncated at different occupation numbers nmax.\nAs in Ref. [66], we are interested in t = 10. Since we suspected that the algorithm would also work for sequences with t/k1 > 1, we first computed several sequences of Trotter exponents with l = 2, 3 and 4. These sequences and their corresponding extrapolation weights satisfied \u2225a\u20d7\u22251 \u2264 2 to ensure that errors arising from noise or sampling are amplified by at most a factor of 2. Next, we computed the approximation error \u03b5 for each MPF and selected the one which required less resources to achieve the target accuracy \u03b5t. We observed that this method works well in practice even when t/k1 > 1, confirming that the analytical error bounds on PFs are not tight. Furthermore, we found that the second-order PF always requires shallower circuits than the PFs S4 and S6 when used in an MPF. We also found that the PF S2 alone always requires shallower circuits than S1. For small spin-boson systems we see a reduction of up to a factor of eight in circuit depth, see Appendix F.\nWe derive the scaling of the MPF approach taking into account the dependence of the er-\nror on the number of qubits Nq and the number of different Trotter exponents l. First, the circuit depth of the spin-boson model grows linearly with Nq [66]. Next, as a worst case estimate we set \u03b1 = t such that t/kj \u2264 1 for j = 1, \u00b7 \u00b7 \u00b7 , l so that we can bound the error in the MPF by O ( t2l+1/(2l + 1)! ) [46, 83]. A short calculation\ndetailed in Appendix F shows that our hybrid scheme requires the deepest circuit to have\nO ( t log2(Nq/\u03b5t)\nlog2 log(Nq/\u03b5t)\n) (12)\nTrotter steps instead of the O (\u221a t3N2q /\u03b5t ) required by S2. A more careful choice of Trotter exponents and \u03b1may allow better error bounds. Although the sampling overhead of \u03b5\u22122t , not shown in Eq. (12), cannot be avoided in either approach, the depth of the MPF circuits grows logarithmically instead of polynomially in \u03b5\u22121t . Our method is advantageous for large systems as it reduces the linear dependency of errors on Nq to a logarithmic one. Ref. [66] concluded that first-order Trotter formulas are a better approach than VQA to simulate spin-boson models of intractable system sizes. However, S1 exhibits a scaling linear in Nq, making such a simulation challenging to implement on noisy hardware. MPFs implemented as a linear combination of expectation values are therefore promising to simulate classically intractable quantum systems."
        },
        {
            "heading": "4 Ising model computation on hardware",
            "text": "Quantum computing hardware has increased in scale and quality [53]. However, gate errors on cross-resonance based hardware are nonnegligible. For example, a typical CNOT gate on IBM Quantum hardware has an average error ranging from 0.5% to 1%. This makes it challenging to implement MPFs on noisy quantum hardware as hardware-related errors \u03b5\u2032 must be kept comparable to or smaller than the total Trotter error which is close to 10%, see Eq. (10) and Fig. 2. We can however suppress hardware errors in the measured observables with noise mitigation methods which we describe in Sec. 4.1 \u2013 4.3 in the same order as we apply them as Qiskit transpiler passes [70]. Hardware results are in Sec. 4.4. They show a factor of six reduction in\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 7\ncircuit depth of an MPF implementation over a PF."
        },
        {
            "heading": "4.1 Pauli Twirling",
            "text": "Pauli twirling (PT) converts an arbitrary noise channel into a stochastic Pauli error channel, suppressing off-diagonal coherent error contributions [57, 84]. We first apply PT to the RZZ gates, the dominant error source, to convert their noise channels into a stochastic Pauli error channel. PT is implemented by sandwiching each RZZ gate between randomly sampled Pauli gates chosen so that the net operation of the circuit is unaffected in the absence of noise. The gate noise is reduced to a stochastic form by averaging the results of NPT \u2208 N logically equivalent random circuits [14, 17, 48, 57, 84]. As in Ref. [57], we randomly sample twirling gates from the set GZZ = {I \u2297 I,X \u2297X,Y \u2297 Y, Z \u2297 Z,X \u2297 Y, Y \u2297 X,Z\u2297I, I\u2297Z} that commutes with RZZ(\u03b8). We apply the same Pauli gates before and after the RZZ(\u03b8) gate, see Fig. 3(a) and (b). Each quantum circuit is executed with N/NPT shots on that hardware where N is the total shot budget."
        },
        {
            "heading": "4.2 Pulse efficient transpilation and calibration",
            "text": "Second, we use a pulse-efficient circuit transpilation which replaces the RZZ(\u03b8) gates by RZX gates with echos exposed in the circuit as presented in Ref. [32, 76], see Fig. 3(c). This avoids the onerous double CNOT implementation of RZZ(\u03b8). The RZX gates are implemented by scaling the hardware native cross-resonance (CR) pulses [73, 77] found in the calibrated schedules of the CNOT gates. Since we run a Trotter simulation where the rotation angles \u03b8 are small the flat-top of the square pulses with Gaussian flanks vanish. We must therefore implement RZX(\u03b8) with Gaussian CR pulses of varying amplitude. To overcome non-linear effects we calibrate the amplitude of the CR pulses, see Appendix H."
        },
        {
            "heading": "4.3 Zero-noise extrapolation with scaled crossresonance gates",
            "text": "The noise in quantum computers can be mitigated with zero-noise extrapolation (ZNE) which runs logically equivalent circuits with different noise levels [61, 79]. Ideally, such circuits are implemented by reducing the amplitude and increasing the duration of all the underlying pulses\nto increase the noise [56]. This requires extensive gate calibration, which is impractical and reduces the availability of a cloud-based quantum computing system. To overcome this limitation digital ZNE replaces each CNOT gate with 2n + 1 CNOT gates [16, 31, 75]. This, however, limits the possible stretch factors to c = 2n + 1. Similarly, the Mitiq package [58] inserts pairs of CNOT gates but allows for fractional stretch factors by repeating selected gate layers instead of repeating all CNOT gates.\nHere, we implement ZNE by adding the gate sequence RZX(\u2212\u03b8c)RZX(\u03b8c) after the first layer of RZZ(\u03b8) gates, see Fig. 3(d). Crucially, the rotation angle \u03b8c \u0338= \u03b8 which allows us to create a continuous range of stretch factors by linearly scaling the width w of the echoed CR pulses in the RZX(\u00b1\u03b8c) gates as discussed in Ref. [32, 76], see Fig. 3(e). Finally, we calculate the effective stretch factor c of each circuit as the fraction between the duration of the stretched circuit and the duration of the original circuit, both without measurements. The smallest possible stretch factor cmin we can implement, indicated in Fig. 4(b), occurs when the flat-top w of the CR pulses vanishes, see Fig. 3(e). By scaling only the RZX gates rather than each gate in the circuit, it is possible to use a wider range of stretch factors for the same T1 times of the hardware. Each observable we measure is then extrapolated to the zero-noise limit with an exponential fit ae\u2212bc + d where c is the stretch factor and a, b, and d are fit parameters, see Fig. 4(b). We compare our ZNE method to the Mitiq package in Appendix I."
        },
        {
            "heading": "4.4 Results",
            "text": "We compute the dynamics of the Ising model with five linearly connected spins and J = 0.5, h = 1, and an evolution time of t = 0.5. To select five good qubits on ibmq_montreal we perform quantum process tomography [9, 67] of scaledCR RZX(\u03b8c)RZX(\u2212\u03b8c) gates and retain the five linearly connected qubits 13, 14, 16, 19, and 20 as their gate fidelity decay visually resembles their T1 decay, see Appendix J. We calculate the global magnetization \u27e8Z\u27e9 by measuring the local magnetization \u27e8Zi\u27e9 of each qubit and take the average \u27e8Z\u27e9 = 15 \u22115 i=1\u27e8Zi\u27e9, see Fig. 4(a). As benchmark we compute the first-order Trotter formula S1 with exponents kj \u2208 {1, ..., 10} on a noiseless state-vector simulator and compare it to the\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 8\nexact analytical value of e\u2212iHt, see Eq. (2) and the blue dots in Fig. 4(c). Next, we compute S1 on ibmq_montreal with the error mitigation strategies described in Sec. 4.1-4.3. The properties of ibmq_montreal are shown in Appendix J. We also ran the corresponding circuits with and without dynamical decoupling but did not see a meaningful effect. We elaborate on this in Appendix G. For each Trotter step we create eight random PT circuits by dressing the RZZ gates with gates uniformly drawn from GZZ . Each of these eight circuits is executed 20 times with different stretch-factors \u03b8c linearly spaced in the interval [\u03b8minc , \u03b8maxc ]. Here, \u03b8maxc is chosen such that the pulse-schedule of ten Trotter steps does not exceed the shortest T1 time. For every \u03b8c each of the eight circuits is evaluated with 105/8 shots to keep the physical and sampling noise below \u03b5\u2032 = 10\u22122. This process is repeated ten times to gather statistics. Therefore, a zero-noise extrapolated global magnetization \u27e8Z(kj)\u27e9, indicated as green stars in Fig. 4(b) and (c), is computed with a total of 10 \u00d7 20 \u00d7 105 = 2 \u00b7 107 shots. Before computing each \u27e8Z(kj)\u27e9 we calibrate the RZX gates using the procedure in Appendix H. All the measured expectation values are corrected for readout errors with a tensor product of individual qubit calibration matrices [11, 57]. The noise mitigation significantly increases the accuracy in the measured \u27e8Z(kj)\u27e9, see Fig. 4(b). For up to four Trotter steps the measured \u27e8Z(kj)\u27e9 agree well with the noiseless benchmark. At Trotter steps kj > 4 the \u27e8Z(kj)\u27e9 have a lower error than\npredicted by the noiseless benchmark which is a coincidence.\nWe build the MPF estimation of the zero-noise extrapolated values of \u27e8Z\u27e9 using Eq. (7). We select the Trotter exponents kj to combine and the corresponding weights aj following the optimization algorithm described in Appendix E, which also contains the values of k\u20d7 and a\u20d7, with the threshold \u2225a\u20d7\u22251 \u2264 3. Crucially, we observe that the MPF significantly reduces the error. For example, the combinations [1, 2], [1, 3], and [2, 4] all have the same accuracy as a first-order formula with 24 Trotter steps, see green crosses in Fig. 4(c). This is a reduction in circuit depth by a factor of twelve to six over the product formula."
        },
        {
            "heading": "5 Conclusion",
            "text": "We present a hybrid quantum-classical approach to MPFs that requires neither additional qubits nor controlled operations as do previous approaches based on an LCU [23, 46]. Our method approximates a Hamiltonian evolution with the same accuracy as PFs or MPFs implemented with an LCU but with significantly shallower circuits by implementing each unitary in the LCU as a standalone circuit. Therefore, even though the total number of matrix exponentials in both approaches is the same, the reduction in gate count for the deepest circuit can be substantial as illustrated by the l = 3 example for which our approach has 22 times less two qubit gates than an LCU implementation when k\u20d7 = [1, 2, 7]. Re-\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 9\nducing the gate and qubit count makes it possible to execute MPFs on noisy hardware that achieve accurate results, such as those shown in Fig. 4, that would not be possible if implemented as an LCU.\nThe fast convergence of MPFs to the exact operator e\u2212iHt also means that the approximation error soon becomes smaller than the noise levels on the hardware. Error mitigation is thus crucial to suppress hardware noise. As the hardware and error mitigation techniques improve, the advantages of our MPF method will become increasingly noticeable. To mitigate errors we used PT and pulse-efficient transpilation and introduced\nan implementation of ZNE that provides a continuous range of stretch factors while simultaneously avoiding onerous pulse calibration. Crucially, this method overcomes the c \u2208 {1, 3, 5, ...} limitation of the digital ZNE which rapidly becomes infeasible for deep circuits. With these error mitigation methods we demonstrated on hardware that MPFs can achieve the same accuracy as a PF but with up to a factor of 12 reduction in circuit depth for a five spin Ising Hamiltonian.\nOur approach has shallower circuits than MPFs based on an LCU for t \u2264 1. Future work may investigate whether there is a regime for large values of t in which the LCU circuits are shallower than the classical combination of expectation values we propose. For example, since an MPF implemented as an LCU is one quantum circuit, it may be possible to repeat t/\u2206t times the circuit for a time \u2206t. This may use less Trotter steps than a classical combination of expectation values. In addition, tighter bounds could be derived, since as mentioned in Sec. 3, our experiments showed that the scheme still works even when t/k1 > 1. Regarding ZNE as presented in Sec. 4.3: a deeper study of the optimal number of stretch factors is warranted. Furthermore, we empirically found that inserting the gate sequence RZX(\u2212\u03b8c)RZX(\u03b8c) after the gates in the first layer of RZZ gates allowed us to mitigate errors. However, the choices of the sequence and where to insert them are not unique. While we tried several possibilities, a more rigorous study is left as further work. We obtained our ZNE expectation values with an exponential fit using the effective stretch factors as the independent variable. These choices could be either studied empirically in more detail or backed up with theory.\nWe conjecture that our scheme is optimal when used with S2, where optimal means requiring the shallowest circuits to achieve a given approximation error. In summary, the linear combinations of expectation values makes it possible to use the MPF approach on noisy hardware. This allows us to reduce circuit depth by orders of magnitude which we believe is crucial to reach a quantum advantage for Hamiltonian simulation on noisy quantum hardware.\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 10"
        },
        {
            "heading": "6 Acknowledgements",
            "text": "The authors thank Nate Earnest, Andreas Fuhrer, Youngseok Kim, David Layden and Alexander Miessen for useful discussions. This work was supported as a part of NCCR QSIT, a National Centre of Competence (or Excellence) in Research, funded by the Swiss National Science Foundation (grant number 51NF40-185902).\nReferences [1] IBM Quantum. https://\nquantum-computing.ibm.com/. [2] D. Aharonov and A. Ta-Shma. Adiabatic\nquantum state generation and statistical zero knowledge. In Proc. 35th Annu. ACM Symp. Theory Comput., page 20\u201329, 2003. DOI: 10.1145/780542.780546.\n[3] G. Ahokas. Improved algorithms for approximate quantum Fourier transforms and sparse Hamiltonian simulations. 2004. DOI: 10.11575/PRISM/22839.\n[4] T. Alexander, N. Kanazawa, D. J. Egger, L. Capelluto, C. J. Wood, A. Javadi-Abhari, and D. C. McKay. Qiskit pulse: programming quantum computers through the cloud with pulses. Quantum Sci. Technol., 5(4):044006, aug 2020. DOI: 10.1088/2058- 9565/aba404.\n[5] D. An, D. Fang, and L. Lin. Timedependent Hamiltonian simulation of highly oscillatory dynamics and superconvergence for Schr\u00f6dinger equation. Quantum, 6:690, 2022. DOI: 10.22331/q-2022-04-15-690.\n[6] H. Bernien, S. Schwartz, A. Keesling, H. Levine, A. Omran, H. Pichler, S. Choi, A. S. Zibrov, M. Endres, M. Greiner, V. Vuleti\u0107, and M. D. Lukin. Probing manybody dynamics on a 51-atom quantum simulator. Nature, 551(7682):579\u2013584, Nov 2017. ISSN 1476-4687. DOI: 10.1038/nature24622.\n[7] D. W. Berry, G. Ahokas, R. Cleve, and B. C. Sanders. Efficient quantum algorithms for simulating sparse Hamiltonians. Commun. Math. Phys., 270(2):359\u2013371, Mar 2007. ISSN 1432-0916. DOI: 10.1007/s00220-0060150-x.\n[8] D. W. Berry, A. M. Childs, Y. Su, X. Wang, and N. Wiebe. Time-dependent Hamiltonian simulation with L1-norm scaling. Quantum,\n4:254, 2020. DOI: 10.22331/q-2020-04-20254.\n[9] R. C. Bialczak, M. Ansmann, M. Hofheinz, E. Lucero, M. Neeley, A. D. O\u2019Connell, D. Sank, H. Wang, J. Wenner, M. Steffen, A. N. Cleland, and J. M. Martinis. Quantum process tomography of a universal entangling gate implemented with Josephson phase qubits. Nat. Phys., 6(6):409\u2013413, Jun 2010. ISSN 1745-2481. DOI: 10.1038/nphys1639.\n[10] S. Blanes, F. Casas, and J. Ros. Extrapolation of symplectic Integrators. Celestial Mech. Dyn. Astron., 75:149\u2013161, 1999. DOI: 10.1023/A:1008364504014.\n[11] S. Bravyi, D. Gosset, R. K\u00f6nig, and M. Tomamichel. Quantum advantage with noisy shallow circuits. Nat. Phys., 16(10): 1040\u20131045, Oct 2020. ISSN 1745-2481. DOI: 10.1038/s41567-020-0948-z.\n[12] A. Browaeys and T. Lahaye. Many-body physics with individually controlled Rydberg atoms. Nat. Phys., 16(2):132\u2013142, Feb 2020. ISSN 1745-2481. DOI: 10.1038/s41567-0190733-z.\n[13] J. C. Butcher. Numerical Methods for Ordinary Differential Equations. Wiley, 3 edition, 7 2016. ISBN 9781119121534. DOI: 10.1002/9781119121534. Chapter 33.\n[14] Z. Cai and S. C. Benjamin. Constructing smaller Pauli twirling sets for arbitrary error channels. Sci. Rep., 9(1):11281, Aug 2019. ISSN 2045-2322. DOI: 10.1038/s41598-01946722-7.\n[15] E. Campbell. Random compiler for fast hamiltonian simulation. Phys. Rev. Lett., 123:070503, Aug 2019. DOI: 10.1103/PhysRevLett.123.070503.\n[16] A. Carrera Vazquez and S. Woerner. Efficient state preparation for quantum amplitude estimation. Phys. Rev. Applied, 15: 034027, Mar 2021. DOI: 10.1103/PhysRevApplied.15.034027.\n[17] I. Chen, B. Burdick, Y. Yao, P. P. Orth, and T. Iadecola. Error-mitigated simulation of quantum many-body scars on quantum computers with pulse-level control. Phys. Rev. Res., 4:043027, Oct 2022. DOI: 10.1103/PhysRevResearch.4.043027.\n[18] A. Chiesa, F. Tacchino, M. Grossi, P. Santini, I. Tavernelli, D. Gerace, and S. Car-\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 11\nretta. Quantum hardware simulating fourdimensional inelastic neutron scattering. Nat. Phys., 15(5):455\u2013459, May 2019. ISSN 1745-2481. DOI: 10.1038/s41567-019-04374.\n[19] A. M. Childs. On the relationship between continuous- and discrete-time quantum walk. Commun. Math. Phys., 294(2): 581\u2013603, Mar 2010. ISSN 1432-0916. DOI: 10.1007/s00220-009-0930-1.\n[20] A. M. Childs and R. Kothari. Limitations on the simulation of non-sparse Hamiltonians. Quantum Info. Comput., 10(7):669\u2013 684, July 2010. ISSN 1533-7146. DOI: 10.5555/2011373.2011380.\n[21] A. M. Childs and R. Kothari. Simulating sparse Hamiltonians with star decompositions. In Proc. 5th Conf. Theory Quantum Comput. Commun. Cryptogr., pages 94\u2013103, 2011. ISBN 3-642-18072-8, 978-3-642-18072- 9. DOI: 10.5555/1946127.19461355.\n[22] A. M. Childs and Y. Su. Nearly optimal lattice simulation by product formulas. Phys. Rev. Lett., 123:050503, Aug 2019. DOI: 10.1103/PhysRevLett.123.050503.\n[23] A. M. Childs and N. Wiebe. Hamiltonian simulation using linear combinations of unitary operations. Quantum Info. Comput., 12(11\u201312):901\u2013924, November 2012. ISSN 1533-7146. DOI: 10.5555/2481569.2481570.\n[24] A. M. Childs, R. Cleve, E. Deotto, E. Farhi, S. Gutmann, and D. A. Spielman. Exponential algorithmic speedup by a quantum walk. In Proc. 35th Annu. ACM Symp. Theory Comput., pages 59\u201368, 2003. ISBN 1- 58113-674-9. DOI: 10.1145/780542.780552.\n[25] A. M. Childs, D. Maslov, Y. Nam, N. J. Ross, and Y. Su. Toward the first quantum simulation with quantum speedup. PNAS, 115(38):9456\u20139461, 2018. ISSN 0027-8424. DOI: 10.1073/pnas.1801723115.\n[26] A. M. Childs, Y. Su, M. C. Tran, N. Wiebe, and S. Zhu. Theory of Trotter error with commutator scaling. Phys. Rev. X, 11(1): 011020, February 2021. DOI: 10.1103/PhysRevX.11.011020.\n[27] S. A. Chin. Multi-product splitting and Runge-Kutta-Nystr\u00f6m integrators. Celestial Mech. Dyn. Astron., 106(4):391\u2013 406, Apr 2010. ISSN 1572-9478. DOI: 10.1007/s10569-010-9255-9.\n[28] C. C\u00eerstoiu, Z. Holmes, J. Iosue, L. Cincio, P. J. Coles, and A. Sornborger. Variational fast forwarding for quantum simulation beyond the coherence time. npj Quantum Inf., 6(1):82, Sep 2020. ISSN 2056-6387. DOI: 10.1038/s41534-020-00302-0.\n[29] R. M. Corless, G. H. Gonnet, D. E. G. Hare, D. J. Jeffrey, and D. E. Knuth. On the Lambert W function. Adv. Comput. Math., 5(4): 329\u2013359, 1996. DOI: 10.1007/BF02124750.\n[30] A. Di Paolo, P. Kl. Barkoutsos, I. Tavernelli, and A. Blais. Variational quantum simulation of ultrastrong light-matter coupling. Phys. Rev. Research, 2:033364, Sep 2020. DOI: 10.1103/PhysRevResearch.2.033364.\n[31] E. F. Dumitrescu, A. J. McCaskey, G. Hagen, G. R. Jansen, T. D. Morris, T. Papenbrock, R. C. Pooser, D. J. Dean, and P. Lougovski. Cloud quantum computing of an atomic nucleus. Phys. Rev. Lett., 120:210501, May 2018. DOI: 10.1103/PhysRevLett.120.210501.\n[32] N. Earnest, C. Tornow, and D. J. Egger. Pulse-efficient circuit transpilation for quantum applications on cross-resonancebased hardware. Phys. Rev. Research, 3: 043088, Oct 2021. DOI: 10.1103/PhysRevResearch.3.043088.\n[33] D. J. Egger and F. K. Wilhelm. Multimode circuit quantum electrodynamics with hybrid metamaterial transmission lines. Phys. Rev. Lett., 111:163601, Oct 2013. DOI: 10.1103/PhysRevLett.111.163601.\n[34] S. Endo, Q. Zhao, Y. Li, S. Benjamin, and X. Yuan. Mitigating algorithmic errors in a Hamiltonian simulation. Phys. Rev. A, 99:012334, Jan 2019. DOI: 10.1103/PhysRevA.99.012334.\n[35] S. Endo, J. Sun, Y. Li, S. C. Benjamin, and X. Yuan. Variational quantum simulation of general processes. Phys. Rev. Lett., 125:010501, Jun 2020. DOI: 10.1103/PhysRevLett.125.010501.\n[36] P. K. Faehrmann, M. Steudtner, R. Kueng, M. Kieferova, and J. Eisert. Randomizing multi-product formulas for Hamiltonian simulation. Quantum, 6:806, September 2022. ISSN 2521-327X. DOI: 10.22331/q-2022-0919-806.\n[37] R. P. Feynman. Simulating physics with computers. Int. J. Theor. Phys., 21(6):467\u2013\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 12\n488, Jun 1982. ISSN 1572-9575. DOI: 10.1007/BF02650179.\n[38] L. E. Fischer, D. Miller, F. Tacchino, P. Kl. Barkoutsos, D. J. Egger, and I. Tavernelli. Ancilla-free implementation of generalized measurements for qubits embedded in a qudit space. Phys. Rev. Research, 4: 033027, Jul 2022. DOI: 10.1103/PhysRevResearch.4.033027.\n[39] A. Frisk Kockum, A. Miranowicz, S. De Liberato, S. Savasta, and F. Nori. Ultrastrong coupling between light and matter. Nat. Rev. Phys., 1(1):19\u201340, Jan 2019. ISSN 2522- 5820. DOI: 10.1038/s42254-018-0006-2.\n[40] J. Gacon, C. Zoufal, G. Carleo, and S. Woerner. Simultaneous Perturbation Stochastic Approximation of the Quantum Fisher Information. Quantum, 5:567, October 2021. ISSN 2521-327X. DOI: 10.22331/q-2021-1020-567.\n[41] G. Garc\u00eda-P\u00e9rez, M. A. C. Rossi, B. Sokolov, F. Tacchino, P. Kl. Barkoutsos, G. Mazzola, I. Tavernelli, and S. Maniscalco. Learning to measure: Adaptive informationally complete generalized measurements for quantum algorithms. PRX Quantum, 2:040342, Nov 2021. DOI: 10.1103/PRXQuantum.2.040342.\n[42] T. Giurgica-Tiron, Y. Hindy, R. LaRose, A. Mari, and W. J. Zeng. Digital zero noise extrapolation for quantum error mitigation. In IEEE Int. Conf. on QCE, pages 306\u2013316, 2020. DOI: 10.1109/QCE49297.2020.00045.\n[43] C. Gross and I. Bloch. Quantum simulations with ultracold atoms in optical lattices. Science, 357(6355):995\u20131001, 2017. DOI: 10.1126/science.aal3837.\n[44] C. Hadfield, S. Bravyi, R. Raymond, and A. Mezzacapo. Measurements of quantum Hamiltonians with locally-biased classical shadows. Commun. Math. Phys., 391(3): 951\u2013967, May 2022. ISSN 1432-0916. DOI: 10.1007/s00220-022-04343-8.\n[45] M. Hagan and N. Wiebe. Composite quantum simulations. 2022. URL https:// arxiv.org/abs/2206.06409.\n[46] G. Hao Low, V. Kliuchnikov, and N. Wiebe. Well-conditioned multiproduct Hamiltonian simulation. 2019. URL https://arxiv. org/abs/1907.11679.\n[47] A. W. Harrow, A. Hassidim, and S. Lloyd. Quantum algorithm for linear systems\nof equations. Phys. Rev. Lett., 103: 150502, Oct 2009. DOI: 10.1103/PhysRevLett.103.150502.\n[48] A. Hashim, R. K. Naik, A. Morvan, J. L. Ville, B. Mitchell, J. M. Kreikebaum, M. Davis, E. Smith, C. Iancu, K. P. O\u2019Brien, I. Hincks, J. J. Wallman, J. Emerson, and I. Siddiqi. Randomized compiling for scalable quantum computing on a noisy superconducting quantum processor. Phys. Rev. X, 11:041039, Nov 2021. DOI: 10.1103/PhysRevX.11.041039.\n[49] A. He, B. Nachman, W. A. de Jong, and C. W. Bauer. Zero-noise extrapolation for quantum-gate error mitigation with identity insertions. Phys. Rev. A, 102:012426, Jul 2020. DOI: 10.1103/PhysRevA.102.012426.\n[50] A. Hoorfar and M. Hassani. Inequalities on the Lambert W function and hyperpower function. JIPAM, 9, 01 2008. URL http: //eudml.org/doc/130024.\n[51] H.-Y. Huang, R. Kueng, and J. Preskill. Predicting many properties of a quantum system from very few measurements. Nat. Phys., 16(10):1050\u20131057, Oct 2020. ISSN 1745-2481. DOI: 10.1038/s41567-020-09327.\n[52] S. Indrajeet, H. Wang, M.D. Hutchings, B.G. Taketani, F. K. Wilhelm, M.D. LaHaye, and B.L.T. Plourde. Coupling a superconducting qubit to a left-handed metamaterial resonator. Phys. Rev. Applied, 14: 064033, Dec 2020. DOI: 10.1103/PhysRevApplied.14.064033.\n[53] P. Jurcevic, A. Javadi-Abhari, L. S. Bishop, I. Lauer, D. F. Bogorin, M. Brink, L. Capelluto, O. G\u00fcnl\u00fck, T. Itoko, N. Kanazawa, and et al. Demonstration of quantum volume 64 on a superconducting quantum computing system. Quantum Sci. Technol., 6(2):025020, mar 2021. DOI: 10.1088/2058-9565/abe519.\n[54] H. Kamakari, S. N. Sun, M. Motta, and Austin J. Minnich. Digital quantum simulation of open quantum systems using quantum imaginary\u2013time evolution. PRX Quantum, 3:010320, Feb 2022. DOI: 10.1103/PRXQuantum.3.010320.\n[55] Naoki Kanazawa, Daniel J. Egger, Yael BenHaim, Helena Zhang, William E. Shanks, Gadi Aleksandrowicz, and Christopher J. Wood. Qiskit experiments: A python pack-\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 13\nage to characterize and calibrate quantum computers. J. Open Source Softw., 8(84): 5329, 2023. DOI: 10.21105/joss.05329.\n[56] A. Kandala, K. Temme, A. D. C\u00f3rcoles, A. Mezzacapo, J. M. Chow, and J. M. Gambetta. Error mitigation extends the computational reach of a noisy quantum processor. Nature, 567(7749):491\u2013495, Mar 2019. ISSN 1476-4687. DOI: 10.1038/s41586-019-10407.\n[57] Y. Kim, C. J. Wood, T. J. Yoder, S. T. Merkel, J. M. Gambetta, K. Temme, and A. Kandala. Scalable error mitigation for noisy quantum circuits produces competitive expectation values. Nat. Phys., 19(5):752\u2013 759, May 2023. DOI: 10.1038/s41567-02201914-3.\n[58] R. LaRose, A. M., S. Kaiser, P. J. Karalekas, A. A. Alves, P. Czarnik, M. El Mandouh, M. H. Gordon, Y. Hindy, A. Robertson, P. T., N. Shammah, and W. J. Zeng. Mitiq: A software package for error mitigation on noisy quantum computers. Quantum, 6:774, August 2022. ISSN 2521-327X. DOI: 10.22331/q-2022-08-11-774.\n[59] D. Layden. First-order Trotter error from a second-order perspective. Phys. Rev. Lett., 128:210501, May 2022. DOI: 10.1103/PhysRevLett.128.210501.\n[60] A. J. Leggett, S. Chakravarty, A. T. Dorsey, Matthew P. A. Fisher, A. Garg, and W. Zwerger. Dynamics of the dissipative two-state system. Rev. Mod. Phys., 59:1\u201385, Jan 1987. DOI: 10.1103/RevModPhys.59.1.\n[61] Y. Li and S. C. Benjamin. Efficient variational quantum simulator incorporating active error minimization. Phys. Rev. X, 7: 021050, Jun 2017. DOI: 10.1103/PhysRevX.7.021050.\n[62] D. A. Lidar. Review of DecoherenceFree Subspaces, Noiseless Subsystems, and Dynamical Decoupling, pages 295\u2013354. John Wiley & Sons, Ltd, 2014. ISBN 9781118742631. DOI: https://doi.org/10.1002/9781118742631.ch11.\n[63] S. Lloyd. Universal quantum simulators. Science, 273(5278):1073\u20131078, 1996. DOI: 10.1126/science.273.5278.1073.\n[64] E. Magesan and J. M. Gambetta. Effective Hamiltonian models of the cross-resonance\ngate. Phys. Rev. A, 101:052308, May 2020. DOI: 10.1103/PhysRevA.101.052308.\n[65] A. D. McLachlan. A variational solution of the time-dependent Schrodinger equation. Mol. Phys., 8(1):39\u201344, 1964. DOI: 10.1080/00268976400100041.\n[66] A. Miessen, P. J. Ollitrault, and I. Tavernelli. Quantum algorithms for quantum dynamics: A performance study on the spin-boson model. Phys. Rev. Research, 3:043212, Dec 2021. DOI: 10.1103/PhysRevResearch.3.043212.\n[67] M. Mohseni, A. T. Rezakhani, and D. A. Lidar. Quantum-process tomography: Resource analysis of different strategies. Phys. Rev. A, 77:032322, Mar 2008. DOI: 10.1103/PhysRevA.77.032322.\n[68] Y. Ouyang, D. R. White, and E. T. Campbell. Compilation by stochastic Hamiltonian sparsification. Quantum, 4:235, February 2020. ISSN 2521-327X. DOI: 10.22331/q2020-02-27-235.\n[69] B. Pokharel, N. Anand, B. Fortman, and D. A. Lidar. Demonstration of fidelity improvement using dynamical decoupling with superconducting qubits. Phys. Rev. Lett., 121:220502, Nov 2018. DOI: 10.1103/PhysRevLett.121.220502.\n[70] Qiskit contributors. Qiskit: An open-source framework for quantum computing, 2023. URL https://doi.org/10.5281/zenodo. 2562111.\n[71] L. F. Richardson. The approximate arithmetical solution by finite differences of physical problems involving differential equations, with an application to the stresses in a masonry dam. Philos. Trans. R. Soc. London, Ser. A, 210:307\u2013357, 1911. ISSN 02643952. URL http://www.jstor.org/ stable/90994.\n[72] S. Sachdev. Quantum Phase Transitions. Cambridge University Press, 2 edition, 2011. DOI: 10.1017/CBO9780511973765.\n[73] S. Sheldon, E. Magesan, J. M. Chow, and J. M. Gambetta. Procedure for systematically tuning up cross-talk in the cross-resonance gate. Phys. Rev. A, 93: 060302, Jun 2016. DOI: 10.1103/PhysRevA.93.060302.\n[74] A. Sidi. Practical Extrapolation Methods: Theory and Applications. Cambridge Uni-\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 14\nversity Press, 2003. ISBN 9780511546815. DOI: 10.1017/CBO9780511546815.\n[75] N. Stamatopoulos, D. J. Egger, Y. Sun, C. Zoufal, R. Iten, N. Shen, and S. Woerner. Option Pricing using Quantum Computers. Quantum, 4:291, July 2020. ISSN 2521- 327X. DOI: 10.22331/q-2020-07-06-291.\n[76] J. P. T. Stenger, N. T. Bronn, D. J. Egger, and D. Pekker. Simulating the dynamics of braiding of Majorana zero modes using an IBM quantum computer. Phys. Rev. Research, 3:033171, Aug 2021. DOI: 10.1103/PhysRevResearch.3.033171.\n[77] N. Sundaresan, I. Lauer, E. Pritchett, E. Magesan, P. Jurcevic, and J. M. Gambetta. Reducing unitary and spectator errors in cross resonance with optimized rotary echoes. PRX Quantum, 1:020318, Dec 2020. DOI: 10.1103/PRXQuantum.1.020318.\n[78] M. Suzuki. General theory of fractal path integrals with applications to manybody theories and statistical physics. J. Math. Phys., 32(2):400\u2013407, 1991. DOI: 10.1063/1.529425.\n[79] K. Temme, S. Bravyi, and J. M. Gambetta. Error mitigation for short-depth quantum circuits. Phys. Rev. Lett., 119: 180509, Nov 2017. DOI: 10.1103/PhysRevLett.119.180509.\n[80] The IBM Decision Optimization on Cloud team. DOCPLEX, 2022. URL https:// pypi.org/project/docplex/.\n[81] C. Tornow, N. Kanazawa, W. E. Shanks, and D. J. Egger. Minimum quantum runtime characterization and calibration via restless measurements with dynamic repetition rates. Phys. Rev. Applied, 17: 064061, Jun 2022. DOI: 10.1103/PhysRevApplied.17.064061.\n[82] V. Tripathi, H. Chen, M. Khezri, K. W. Yip, E. M. Levenson-Falk, and D. A. Lidar. Suppression of crosstalk in superconducting qubits using dynamical decoupling. Phys. Rev. Appl., 18:024068, Aug 2022. DOI: 10.1103/PhysRevApplied.18.024068.\n[83] A. Vazquez Carrera, R. Hiptmair, and S. Woerner. Enhancing the quantum linear systems algorithm using richardson extrapolation. ACM Trans. Quantum Comput., 3(1), jan 2022. ISSN 2643-6809. DOI: 10.1145/3490631.\n[84] J. J. Wallman and J. Emerson. Noise tailoring for scalable quantum computation via randomized compiling. Phys. Rev. A, 94: 052325, Nov 2016. DOI: 10.1103/PhysRevA.94.052325.\n[85] K. Wan, M. Berta, and E. T. Campbell. Randomized quantum algorithm for statistical phase estimation. Phys. Rev. Lett., 129:030503, Jul 2022. DOI: 10.1103/PhysRevLett.129.030503.\n[86] D. Wecker, B. Bauer, B. K. Clark, M. B. Hastings, and M. Troyer. Gate-count estimates for performing quantum chemistry on small quantum computers. Phys. Rev. A, 90:022305, Aug 2014. DOI: 10.1103/PhysRevA.90.022305.\n[87] J. Weidenfeller, L. C. Valor, J. Gacon, C. Tornow, L. Bello, S. Woerner, and D. J. Egger. Scaling of the quantum approximate optimization algorithm on superconducting qubit based hardware. Quantum, 6: 870, December 2022. ISSN 2521-327X. DOI: 10.22331/q-2022-12-07-870.\n[88] Y. Yongxin. Quantum many-body scars on QC, 2022. URL https://gitlab.com/ QANED/rydberg_mfim.\n[89] X. Yuan, S. Endo, Q. Zhao, Ying Li, and S. Benjamin. Theory of variational quantum simulation. Quantum, 3:191, 2019. DOI: 10.22331/q-2019-10-07-191.\n[90] J. Zhang, G. Pagano, P. W. Hess, A. Kyprianidis, P. Becker, H. Kaplan, A. V. Gorshkov, Z.-X. Gong, and C. Monroe. Observation of a many-body dynamical phase transition with a 53-qubit quantum simulator. Nature, 551(7682):601\u2013604, Nov 2017. ISSN 1476-4687. DOI: 10.1038/nature24654.\n[91] C. Zoufal, D. Sutter, and S. Woerner. Error bounds for variational quantum time evolution. 2021. URL https://arxiv.org/abs/ 2108.00022."
        },
        {
            "heading": "A Error cancellations in multi-product formulas",
            "text": "We illustrate how errors in multi-product formulas cancel with the first-order formula. The example is easily adapted to the 2\u03c7-order. We write S\nkj 1 (t/kj) as a power series in terms of the er-\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 15\nror [27]\nS kj 1\n( t\nkj\n) = e\u2212iHt + \u221e\u2211 n=1 Ant n+1/knj . (13)\nHere, the An are matrices that depend only on commutators of the Hj . In particular, they are independent of the time t and the Trotter exponents kj . Therefore, the lower-order error terms can be cancelled out by a careful choice of extrapolation weights aj that are independent of the Hamiltonian. The An are thus irrelevant in subsequent calculations. For the MPF Ml,1(t) to approximate e\u2212iHt without bias, the extrapolation weights must satisfy \u2211l j=1 aj = 1. Furthermore, to cancel the first l \u2212 1 error terms in S1 we impose the constraint \u2211l\u22121 j=1 aj/k 1+n j = 0 for n = 0, ..., l \u2212 2. Therefore, the resulting error is given by Ml,1(t) = l\u2211\nj=1 ajS\nkj 1\n( t\nkj\n)\n= l\u2211\nj=1 aj\n( e\u2212iHt +\nl\u22121\u2211 n=1 An tn+1 knj + \u221e\u2211 n=l An tn+1 knj\n)\n= e\u2212iHt + O ( tl+1\nkl1\n) . (14)"
        },
        {
            "heading": "B Comparison with LCU",
            "text": "Here, we compare the circuit depth of MPFs implemented by classically combining expectation values to MPFs implemented as LCUs with l = 3 extrapolation points as example. The LCU method implements an operation proportional to the linear combination \u03baU + V for some unitary gates U, V and \u03ba \u2265 0. A linear combination of three unitaries is implemented recursively as \u03b11(\u03b12U1 +U2)+U3. Similarly, we can implement an operation proportional to \u22113 j=1 ajS kj 1 (t/kj) by choosing the appropriate coefficients \u03b11, \u03b12 \u2265 0, shown in Fig. 5. We count the number of CNOT gates for the Ising model described in Sec. 4.4 required by each approach. The first-order Trotter formula implementing a five qubit Ising model requires four RZZ gates and five RX gates. Thus, the deepest circuit of a classical combination will contain 4k3 RZZ gates. The number of different gates required by an LCU implementation is given in Table 2. The table also shows the number of CNOT gates required to implement each\ngate, as transpiled by Qiskit into the native gate set. The LCU approach would therefore require 4(k1 + k2) \u00b7 (20 + 7) + 4k3 \u00b7 (8 + 2) + 2 \u00b7 2 = 108(k1 + k2) + 40k3 + 4 CNOTs and two additional qubits. By contrast, our approach only requires 4k3 CNOTs. For l = 3, this is thus a reduction of the number of CNOT gates by a factor of [108(k1 + k2) + 40k3 + 4]/4k3. With, e.g., k\u20d7 = [1, 2, 7] this corresponds to 22\u00d7 less CNOT gates than an LCU implementation."
        },
        {
            "heading": "C Extrapolation properties",
            "text": "A crucial step in our scheme is to compute expectation values with the Sk\u03c7\u2019s in Eq. (5) instead of Ml,\u03c7, since it allows us to directly compute the extrapolated observable from the measured expectation values without measuring cross-terms in the MPF. Here, cross-terms correspond to \u27e8\u03c8|Skl\u03c7 OS kj \u03c7 |\u03c8\u27e9 for kj \u0338= kl when computing the expectation of an observable O with Eq. (5). The proof included below for completeness follows similar arguments as those from Refs. [34, 83].\nLet Skj\u03c7 = U + Ej , where U = e\u2212iHt is the matrix exponential we want to approximate via\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 16\na PF and Ej = \u2211 i \u03b1\u03b7i t\u03b7i+1\nk \u03b7i j\nis the error incurred\nin the approximation, where \u03b1k denotes matrix commutators. Let O denote the observable of interest and a1, ..., al the extrapolation weights that satisfy Eq. (6). We will prove that if\nl\u2211 j=1 ajS kj \u03c7 = l\u2211 j=1 ajU + l\u2211 j=1 aj \u2211 i \u03b1\u03b7i t\u03b7i+1 k\u03b7ij\n= U + O ( k\u2212n1 ) , (15)\nwhere \u03b7l\u22121 < n \u2208 Z, then\nl\u2211 j=1 aj \u27e8\u03c8| ( S kj \u03c7 )\u2020 OS kj \u03c7 |\u03c8\u27e9 = \u27e8\u03c8|U \u2020OU |\u03c8\u27e9\n+ O ( k\u2212n1 ) . (16)\nEq. (16) shows that by ignoring cross-terms we still obtain an approximation with an O(k\u2212n1 ) error.\nWith Skj\u03c7 = U+Ej the expectation value \u27e8O\u27e9 = \u27e8\u03c8| ( S kj \u03c7 )\u2020 OS kj \u03c7 |\u03c8\u27e9 is\n\u27e8O\u27e9 = \u27e8\u03c8|U \u2020OU |\u03c8\u27e9 + \u27e8\u03c8|U \u2020OEj |\u03c8\u27e9\n+ \u27e8\u03c8|E\u2020jOU |\u03c8\u27e9 + \u27e8\u03c8|E \u2020 jOEj |\u03c8\u27e9 . (17)\nNext, the first order in Ej error terms is\n\u03f5 = l\u2211\nj=1 aj \u27e8\u03c8|U \u2020OEj |\u03c8\u27e9\n= l\u2211 j=1 aj \u2211 i \u27e8\u03c8|U \u2020O\u03b1\u03b7i t\u03b7i+1 k\u03b7ij |\u03c8\u27e9 = \u2211\ni\n\u27e8\u03c8|U \u2020O\u03b1\u03b7it\u03b7i+1 |\u03c8\u27e9 l\u2211\nj=1\naj k\u03b7ij\n= O ( k\u2212n1 ) , (18)\nwhere the last equality comes from combining Eq. (6), i.e. the first l \u2212 1 error terms cancel out, and Eq. (15), i.e. \u03b1n t n+1\nknj = O(k\u2212n1 ). A\nsimilar result can be shown for \u27e8\u03c8|E\u2020jOU |\u03c8\u27e9 and \u27e8\u03c8|E\u2020jOEj |\u03c8\u27e9. Thus, Eq. (16) holds and extrapolation can be applied directly to the measured observables."
        },
        {
            "heading": "D Sampling noise of a Bernoulli variable",
            "text": "We illustrate the asymptotic behaviour of the error term O (\u2225a\u20d7\u22251\u03b5\u2032) from Eq. (9) restated below\nl\u2211 j=1 aj ( Ej + \u03b5(kj) + \u03b5\u2032 ) = E + O ( t2(l+\u03c7)+1\nk 2(l+\u03c7) 1\n) + O ( \u2225a\u20d7\u22251\u03b5\n\u2032) . We consider as example the task of sampling a Bernoulli discrete random variable X and computing the probability p that X = 1 by taking M samples. We thus have Ej = E = E[X ] and \u03b5(kj) = 0 for all j. The number of samples allows us to control the sampling noise as \u03b5\u2032(M) = 1/ \u221a M on average. We use the extrapolation weights a\u20d7 of an ill-conditioned MPF built from the PF S2 and by taking kj = j as the sequence of Trotter exponents. Indeed, this setting uniquely defines the sequences a\u20d7 by Eq. (6) whose 1-norm scales exponentially with the number of extrapolation points l, i.e., \u2225a\u20d7\u22251 \u2208 e\u2126(l) [46], see Fig. 6(a). We expect the sampling error to behave as\nl\u2211 j=1 aj ( E + 1\u221a M ) = E + O (\u2225a\u20d7\u22251\u221a M ) , (19)\ni.e. ill-conditioned sequences have an error that grows exponentially with l. Adding extrapolation points therefore increases the error, see Fig. 6(b). Here, each line corresponds to a different l and we estimate Ej(M) := Ej + \u03b5\u2032(M) for j = 1, \u00b7 \u00b7 \u00b7 , l by sampling M times from X . Thus, each point in the plot corresponds to the value\nEl(M) := l\u2211\nj=1 ajEj(M). (20)\nThis example illustrates how a non-careful choice of Trotter exponents exponentially increases the sampling error of a quantum algorithm. Note that the example above can be seen as a weighted average of l times M samples with weights a\u20d7. A simple average is recovered with aj = l\u22121."
        },
        {
            "heading": "E Optimal Trotter exponents",
            "text": "We obtain sequences of Trotter exponents by solving an optimization problem in Python that\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 17\nminimizes \u2225a\u20d7\u22251. We set Eq. (6) as the constraints for the optimization problem. Then, from all the possible sequences of Trotter exponents we accept those for which the condition number returned by the optimization algorithm is below a set threshold. All the results presented here satisfy \u2225a\u20d7\u22251 \u2264 3. The Trotter exponents and extrapolation weights used in the Ising simulation experiments are given in Table 3. They were obtained with DOCPLEX [80] using the code shown below.\n1 from docplex .mp.model import Model 2 3 # npts := number of extrapolation points 4 num_rows = npts - 1 5 h = np.ones (( num_rows , npts)) 6 # 2nd order 7 h[0, :] = [1/f/f for f in factors ] 8 # 1st order 9 h[0, :] = [1/f for f in factors ]\n10 for i in range (1, num_rows ): 11 h[i, :] = h[0, :]**(i+1) 12 13 # create empty model\n14 mdl = Model () 15 16 # create decision variables 17 a = mdl. continuous_var_list ( 18 [f\u2019a{i}\u2019 for i in range(npts )], 19 lb=-np.inf , 20 ) 21 x = mdl. continuous_var_list ( 22 [f\u2019x{i}\u2019 for i in range(npts )], 23 ) 24 25 # minimize sum_i x[i] 26 mdl. minimize (mdl.sum(x)) 27 28 # x[i] >= a[i] and x[i] >= -a[i] 29 for i in range( num_points ): 30 mdl. add_constraint (x[i] >= a[i]) 31 mdl. add_constraint (x[i] >= -a[i ]) 32 33 # sum(a) == 1 34 mdl. add_constraint (mdl.sum(a) == 1) 35 36 # for each i: sum_j a_i*h_ij = 0 37 for i in range( num_rows ): 38 row = [a[j] * h[i, j] 39 for j in range(npts)] 40 row_sum = mdl.sum(row) 41 mdl. add_constraint ( row_sum == 0)"
        },
        {
            "heading": "F Quantum circuit scaling of the spinboson model",
            "text": "Mapping the spin-boson Hamiltonian to a qubitlattice shows that the approximation error of PFs grows linearly with the number of qubits Nq as O ( Nqt 2/kj )\n[18, 22, 66]. Now, we calculate for the spin-boson model the scaling of the deepest circuit needed by an MPF that classically combines expectation values. We start from the Taylor expansion of a symmetric PF\nS kj 2\u03c7\n( t\nkj\n) = e\u2212iHt + \u221e\u2211 n=\u03c7 A2nt 2n+1/k2nj , (21)\nwhere the An are matrices that depend on the commutators of the Hj [27, 46]. Using this notation we bound the MPF error by O (\n\u2225A2l+1\u2225t2l+1 (2l+1)!\n) [46, 83]. Ref. [22] shows that\n\u2225An\u2225 \u2264 Nq by the triangle inequality and by grouping the Hamiltonian terms Hj in an evenodd pattern. We therefore update the MPF error\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 18\nbound to O (Nq/(2l + 1)!) for which we also as- sumed t \u2264 1. Thus, for a target error tolerance \u03b5t\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 19\nthe asymptotic scaling of l satisfies the inequality\nNq (2l + 1)! < \u03b5t. (22)\nFor simplicity, we write y := Nq/\u03b5t and x := (2l + 1) such that Eq. (22) reads x! > y. By Stirling\u2019s approximation, i.e. x! \u223c \u221a 2\u03c0x(x/e)x, the inequality x! > y holds if we set y = (x/e)x. Rearranging this equation yields\n1 x y 1 x = e\u22121, (23)\nwhich has the solution\n2l + 1 = x = ln y W (\nln y e ) , (24) where W (\u00b7) denotes the Lambert function [29]. For z > e it holds that ln z \u2212 ln ln z < W (z) < ln z [50]. We can thus substitute W (e\u22121 ln y) by ln ( e\u22121 ln y ) \u2212 ln ln ( e\u22121 ln y ) = O(ln ln y) to find that the number of extrapolation points l scales as\nO (\nlog(Nq/\u03b5t) log log(Nq/\u03b5t)\n) . (25)\nEquation (25) holds for t \u2264 1. For an arbitrary time, similarly to the main text, we rescale k\u20d7 by \u03b1 = t to ensure that t/kj \u2264 1. Furthermore, for t < 1 the number of Trotter steps of the deepest circuit kl is bounded by l2 for the sequences in Ref. [46] which becomes kl \u2264 \u03b1l2 when we rescale k\u20d7 to accommodate for t > 1. We thus conclude that kl scales as\nO ( t log2(Nq/\u03b5t)\nlog2 log(Nq/\u03b5t)\n) (26)\nas presented in the main text. We further emphasize that Eq. (26) is a worst case upper bound which may yet be improved, for instance, by better choices of \u03b1."
        },
        {
            "heading": "G Dynamical Decoupling",
            "text": "Dynamical decoupling (DD) applies carefully chosen gate sequences on idle qubits to suppress, e.g., decoherence [69] and cross-talk [82]. These sequences are chosen to cancel systemenvironment interactions to a given order in timedependent perturbation theory [62, 69]. Since,\nin practice, the duration of the two-qubit crossresonance gates on IBM hardware varies across qubit pairs and because the circuit structure has layers of one- and two-qubit gates there are often periods where some qubits idle and therefore suffer decoherence and energy relaxation. The simplest DD sequence replaces sufficiently long idle periods of length \u03c4 with the gate sequence \u03c4 \u2032\n4 \u2013 X \u2013 \u03c4 \u2032\n2 \u2013X \u2013 \u03c4 \u2032\n4 , as done in Ref. [17, 53]. Here, the idle time \u03c4 \u2032 is the idle time without DD less the duration of the X gate. We did not see a significant impact of DD on the hardware results and therefore we did not use it. We conjecture this is because single-qubit gates have a 4\u00b710\u22124 error and that the idle times are small. Indeed, the duration of the average delay which can accommodate the DD sequence in the circuit without the added ZNE gates is 252 ns. Under a T1 time of 125 \u00b5s, the average T1 across ibmq_montreal, this delay can be seen as an error of 1\u2212e\u22120.292/125 \u2248 2\u00b710\u22123, i.e. comparable to twice the single-qubit gate error. If the idle times in the circuit were longer we believe that it would have been advantageous to use DD.\nH Calibration of RZX pulses Computing the dynamics of a quantum system with a Trotter expansion requires many high accuracy small rotations. To avoid decoherence the RZX gates are built from scaled crossresonance gates following the linear methodology in Ref. [32, 76]. Scaling calibrated CNOT gates to implement RZX(\u03b8) with small values of \u03b8, i.e. up to \u223c 50 mrad, results in Gaussian cross-resonance pulses without a flat-top and a \u03b8-dependent amplitude. Since the rotation angle \u03b8 implemented by the cross-resonance drive depends non-linearly on the pulse amplitude [4, 32, 64], we mitigate rotation errors with a fine amplitude calibration experiment [81]. Here, the gate sequence [RZX(\u03b8)]n |00\u27e9 is repeated for a variable n and a desired \u03b8 after which the target qubit is measured and both qubits are reset, see Fig. 7(a). The underlying pulse sequences, implemented by linearly scaling the cross-resonance amplitude, creates an effective rotation [RZX(d\u03b8+\u03b8)]n in the measured population, see Fig. 7(b) which we fit to the function\ny(n) = A2 e \u2212n/\u03c4 cos (2\u03c0n[d\u03b8 + \u03b8] + \u03c0) +B. (27)\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 20\nWe chose the maximum n as 3/\u03b8 to have approximately three full oscillations. The small rotation angles we are dealing with thus require pulse sequences with a duration which can exceed the T1 times of the qubits. To produce good fits, as measured by \u03c72, we add the damping factor e\u2212n/\u03c4 in Eq. (27). We run the fine amplitude calibration for all qubit pairs and 20 values of \u03b8 linearly spaced between 0 and the largest \u03b8 for which the scaled CR gates have no flat-top. The measured d\u03b8 yields a correction factor \u03b8/(d\u03b8+\u03b8) that we multiply with the amplitude of the scaled CR gates, see Fig. 8. We observe that this amplitude calibration improves the value of the measured expectation values, see Fig. 9."
        },
        {
            "heading": "I Comparison with Mitiq",
            "text": "Ref. [17] simulates an Ising model using a similar approach to error mitigation, that is, Pauli Twirling, a pulse efficient transpilation of the RZZ gates and dynamical decoupling. By contrast, we do not apply dynamical decoupling and implement ZNE by linearly scaling crossresonance pulses. Ref. [17] uses the Mitiq package [58] to implement random gate folding, i.e. repeating random layers of RZZ gates. Here, we use the example described in Sec. 4.4 as a benchmark to compare both approaches in Fig. 10. We observe that ZNE implemented by folding gates improves the data with respect to the unmitigated results in some cases. Instead, implementing ZNE by scaling CR pulses improves the results in almost all cases.\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 21"
        },
        {
            "heading": "J Hardware properties",
            "text": "Error mitigation techniques can significantly decrease the physical noise in the measured observables. However, their efficacy is limited and error rates are mostly hardware related. In particular, choosing good qubits is a simple but worthwhile strategy towards achieving accurate results. Here good qubits refers to low error rates in the readout, single- and two-qubit gates. Most of these values are provided by the IBM Quantum backends [1]. However, our circuits comprise mostly RZX(\u03b8) gates, which are the main source of noise. The fidelity of these gates is not provided by the backends as they are built from scaled-CR gates [32]. Therefore, we\nperform quantum process tomography of scaledCR RZX(\u03b8)RZX(\u2212\u03b8) gates using Qiskit Experiments [55] on ibmq_montreal, see Fig. 11.\nFor each qubit pair in the device we calculate the fidelity of the gate sequence for 20 values of \u03b8 \u2208 (0.5, 20), shown as dots in Fig. 12, and plot it together with the T1 decay of the two qubits, represented as solid lines. We then inspect the plots and define as good qubit pairs those for which the gate fidelity decay resembles the T1 decay. Finally, we select 4 good pairs that form five linearly connected qubits, depicted in Fig. 11. The properties of ibmq_montreal are shown in Table 6.\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 22\nAccepted in Quantum 2023-07-11, click title to verify. Published under CC-BY 4.0. 23"
        }
    ],
    "title": "Well-conditioned multi-product formulas for hardware-friendly Hamiltonian simulation",
    "year": 2023
}