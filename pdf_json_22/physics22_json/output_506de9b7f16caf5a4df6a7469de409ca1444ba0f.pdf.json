{
    "abstractText": "We describe the geometry of the incompressible porous medium (IPM) equation: we prove that it is a gradient dynamical system on the group of area-preserving diffeomorphisms and has a special double-bracket form. Furthermore, we show its similarities and differences with the dispersionless Toda system. The Toda flow describes an integrable interaction of several particles on a line with an exponential potential between neighbours, while its continuous version is an integrable PDE, whose physical meaning was obscure. Here we show that this continuous Toda flow can be naturally regarded as a special IPM equation, while the key double-bracket property of Toda is shared by all equations of the IPM type, thus manifesting their gradient and non-autonomous Hamiltonian origin. Finally, we comment on Toda and IPM modifications of the QR diagonalization algorithm, as well as describe doublebracket flows in an invariant setting of general Lie groups with arbitrary inertia operators.",
    "authors": [
        {
            "affiliations": [],
            "name": "BORIS KHESIN"
        }
    ],
    "id": "SP:1e7e9dc5a602ab726e914ffcf5874e60aafbda8c",
    "references": [
        {
            "authors": [
                "T. Balehowsky",
                "C.-J. Karlsson",
                "K. Modin"
            ],
            "title": "Shape analysis via gradient flows on diffeomorphism groups",
            "venue": "Nonlinearity 36 ",
            "year": 2022
        },
        {
            "authors": [
                "A.M. Bloch"
            ],
            "title": "Steepest descent",
            "venue": "linear programming and Hamiltonian flows, Contemp. Math. AMS 114 ",
            "year": 1990
        },
        {
            "authors": [
                "A.M. Bloch",
                "R.W. Brockett",
                "T.S. Ratiu"
            ],
            "title": "Completely integrable gradient flows",
            "venue": "Comm. Math. Phys. 147 ",
            "year": 1992
        },
        {
            "authors": [
                "A.M. Bloch",
                "H. Flaschka",
                "T.S. Ratiu"
            ],
            "title": "A Schur-Horn-Kostant convexity theorem for the diffeomorphism group of the annulus",
            "venue": "Invent. Math. 113 ",
            "year": 1993
        },
        {
            "authors": [
                "Y. Brenier"
            ],
            "title": "Various formulations and approximations of incompressible fluid motions in porous media",
            "venue": "Ann. Math. Qu\u00e9. 46 ",
            "year": 2022
        },
        {
            "authors": [
                "R.W. Brockett"
            ],
            "title": "Dynamical systems that sort lists",
            "venue": "diagonalize matrices, and solve linear programming problems, Linear Algebra Appl. 146 ",
            "year": 1991
        },
        {
            "authors": [
                "R.W. Brockett",
                "A.M. Bloch"
            ],
            "title": "Sorting with the dispersionless limit of the toda lattice",
            "venue": "Proceedings of the CRM Workshop on Hamiltonian Systems, Transformation Groups and Spectral Transform Methods, p. 103, Publications CRM, Montreal",
            "year": 1990
        },
        {
            "authors": [
                "P. Cifani",
                "M. Viviani",
                "K. Modin"
            ],
            "title": "An efficient geometric method for incompressible hydrodynamics on the sphere",
            "venue": "J. Comput. Phys. 473 ",
            "year": 2023
        },
        {
            "authors": [
                "D. C\u00f3rdoba",
                "F. Gancedo",
                "R. Orive"
            ],
            "title": "Analytical behavior of two-dimensional incompressible flow in porous media",
            "venue": "J. Math. Phys. 48 ",
            "year": 2007
        },
        {
            "authors": [
                "P. Deift",
                "T. Nanda",
                "C. Tomei"
            ],
            "title": "Ordinary differential equations and the symmetric eigenvalue problem",
            "venue": "SIAM J. Numer. Anal. 20 ",
            "year": 1983
        },
        {
            "authors": [
                "P. Deift",
                "T. Trogdon"
            ],
            "title": "Universality for the Toda algorithm to compute the eigenvalues of a random matrix",
            "venue": "Comm. Pure Appl. Math. 73 ",
            "year": 2018
        },
        {
            "authors": [
                "D.G. Ebin",
                "J.E. Marsden"
            ],
            "title": "Groups of diffeomorphisms and the notion of an incompressible fluid",
            "venue": "Ann. of Math",
            "year": 1970
        },
        {
            "authors": [
                "H. Flaschka"
            ],
            "title": "The Toda lattice",
            "venue": "Phys. Rev. B 9 ",
            "year": 1974
        },
        {
            "authors": [
                "J. Hoppe"
            ],
            "title": "Diffeomorphism groups",
            "venue": "quantization, and SU(\u221e), Int. J. Mod. Phys. A 04 ",
            "year": 1989
        },
        {
            "authors": [
                "J. Hoppe",
                "S.-T. Yau"
            ],
            "title": "Some properties of matrix harmonics on S2",
            "venue": "Comm. Math. Phys. 195 ",
            "year": 1998
        },
        {
            "authors": [
                "B. Khesin",
                "R. Wendt"
            ],
            "title": "The Geometry of Infinite-dimensional Groups",
            "venue": "Springer-Verlag, Berlin",
            "year": 2009
        },
        {
            "authors": [
                "J.E. Marsden",
                "T.S. Ratiu"
            ],
            "title": "Introduction to Mechanics and Symmetry",
            "venue": "2nd ed., Springer-Verlag, New York",
            "year": 1999
        },
        {
            "authors": [
                "K. Modin"
            ],
            "title": "Generalized Hunter\u2013Saxton equations",
            "venue": "optimal information transport, and factorization of diffeomorphisms, J. Geom. Anal. 25 ",
            "year": 2015
        },
        {
            "authors": [
                "K. Modin",
                "M. Viviani"
            ],
            "title": "A Casimir preserving scheme for long-time simulation of spherical ideal hydrodynamics",
            "venue": "J. Fluid Mech. 884 ",
            "year": 2020
        },
        {
            "authors": [
                "K. Modin",
                "M. Viviani"
            ],
            "title": "Lie\u2013poisson methods for isospectral flows",
            "venue": "Found. Comput. Math. 20 ",
            "year": 2020
        },
        {
            "authors": [
                "J. Moser"
            ],
            "title": "Finitely many mass points on the line under the influence of an exponential potential\u2013an integrable system",
            "venue": "Dynamical systems, theory and applications, pp. 467\u2013497, Springer",
            "year": 1975
        },
        {
            "authors": [
                "F. Otto"
            ],
            "title": "Evolution of microstructure in unstable porous media flow: A relaxational approach",
            "venue": "Comm. Pure Appl. Math. 52 ",
            "year": 1999
        },
        {
            "authors": [
                "R.S. Palais"
            ],
            "title": "Foundations of Global Non-linear Analysis",
            "venue": "Benjamin, New York",
            "year": 1968
        },
        {
            "authors": [
                "V. Zeitlin"
            ],
            "title": "Finite-mode analogs of 2D ideal hydrodynamics: coadjoint orbits and local canonical structure",
            "venue": "Phys. D 49 ",
            "year": 1991
        }
    ],
    "sections": [
        {
            "text": "(IPM) equation: we prove that it is a gradient dynamical system on the group of area-preserving diffeomorphisms and has a special double-bracket form. Furthermore, we show its similarities and differences with the dispersionless Toda system. The Toda flow describes an integrable interaction of several particles on a line with an exponential potential between neighbours, while its continuous version is an integrable PDE, whose physical meaning was obscure. Here we show that this continuous Toda flow can be naturally regarded as a special IPM equation, while the key double-bracket property of Toda is shared by all equations of the IPM type, thus manifesting their gradient and non-autonomous Hamiltonian origin. Finally, we comment on Toda and IPM modifications of the QR diagonalization algorithm, as well as describe doublebracket flows in an invariant setting of general Lie groups with arbitrary inertia operators.\nKeywords: Toda flow, porous medium equation, volume preserving diffeomorphisms, double bracket flow\nMSC 2020: 37K25, 70H06, 76S05"
        },
        {
            "heading": "1. Introduction",
            "text": "The goal of this paper is three fold. We start by studying the geometry of the 2D incompressible porous medium (IPM) equation and describe its relation to other equations of mathematical physics. This equation was recently found to possess intriguing properties for a general potential and to be related to problems of optimal mass transport, see [22, 5]. Here we show that the IPM equation is a gradient dynamical system on the Lie group of area-preserving diffeomorphisms, and moreover, its gradient nature turns out to be due to a novel double bracket form of the IPM equation. Recall that the double brackets were introduced by Brockett for matrix equations [2, 6]. Such equations manifest double nature: they turn out to be gradient on adjoint orbits of compact Lie groups, as well as Hamiltonian with possibly time-dependent Hamiltonian functions. The Hamiltonian viewpoint requires a certain identification of a Lie algebra and its dual, which is natural in the compact case due to bi-invariant inner product. In Appendix A we extend the setting of double brackets to the duals of arbitrary Lie algebras by exhibiting the role of the inertia operator for the identification of a Lie algebra in its dual. It turns out that the 2D IPM equation is a double bracket equation on the dual of the Lie algebra X\u00b5(M) of divergence-free vector fields on M . In the vorticity representation, which we employ, the inertia operator is given by the Laplacian \u2206 on M . Furthermore, extending this result, we prove the local in time existence of solutions for the IPM equation on a symplectic manifold in any dimension.\nThe second goal of the paper is a presentation of the dispersionless Toda flow as a certain porous medium equation. The classical Toda system on a real line describes an evolution of a finite collection of particles with neighbours interacting with exponential potential. The corresponding continuous limit, the dispersionless Toda flow (see e.g. [7, 4]), can be thought of as a flow of continuum of particles\n1\nar X\niv :2\n20 7.\n10 21\n4v 3\n[ m\nat h.\nD S]\n1 6\nM ar\n2 02\n3\nmutually interacting with local exponential-type potential. We show that this interaction can be regarded as a porous medium interaction with a different (\u201cthe identity\u201d) inertia operator on a certain subspace of the dual X\u2217\u00b5(M). This way the dispersionless Toda dynamics turns out to be a special type of percolation of faster particles through slower ones.\nFinally, this new IPM point of view on the Toda flow suggests an unusual modification of the classical QR diagonalization algorithm for symmetric matrices, particularly efficient for matrices of large sizes. It was shown in [10] that the QR diagonalization algorithm is a discrete time version of the Toda flow. It turns out that while theoretically convergent, its numerics is rather unstable and its speed of convergence to reordered eigenvalues is rather slow. The IPM equation with the Laplace inertia operator turns out to be an efficient replacement for that, as thanks to the presence of \u2206\u22121 in the equation, its flow is stable and very fast converging. We demonstrate this in Section 4 by presenting diagonalization process of a 256 \u00d7 256 matrix by two algorithms, where, even after 1000 iterations, the Toda flow keeps oscillating, while the IPM flow obtains and reorders the eigenvalues much faster. We also propose yet another modification of this algorithm, providing a fast diagonalization of large symmetric matrices without ordering their eigenvalues.\nAcknowledgements. We thank the anonymous referee for helpful suggestions. Research of B.K. was partially supported by an NSERC Discovery Grant. K.M. was supported by the Swedish Research Council (grant number 2022-03453) and the Knut and Alice Wallenberg Foundation (grant number WAF2019.0201). The computations were enabled by resources provided by the Swedish National Infrastructure for Computing (SNIC) at C3SE partially funded by the Swedish Research Council through grant agreement no. 2018-05973."
        },
        {
            "heading": "2. The IPM equation",
            "text": "2.1. Definition of the IPM flow.\nDefinition 2.1. Given a potential function V on a manifold M of an arbitrary dimension, the incompressible porous medium (IPM or Muscat) equation is given by\n\u03c1\u0307+ div(\u03c1v) = 0,\nsubject to the conditions\nv + \u03c1\u2207V = \u2212\u2207p, div v = 0.\nThis is a continuity equation on the density \u03c1 transported by the divergence-free part v of the vector field \u03c1\u2207V on M , see [22, 5]. The dot stands for the derivative in time. Note that the pressure term is determined by the condition\ndiv(\u03c1\u2207V ) = \u2212\u2206p .\nThe IPM equation is also called a Muscat equation, where MUSCAT stands for Multiple-Doppler Synthesis and Continuity Adjustment Technique.\nIf M is a Ka\u0308hler 2-manifold, the setting we are going to consider from now on, the field v has a (locally defined) stream function \u03c8, v := \u2212J\u2207\u03c8. Assuming that the stream function is defined globally on M we get\n\u2207\u03c8 = \u03c1J\u2207V + J\u2207p \u21d0\u21d2 \u2206\u03c8 = div(\u03c1J\u2207V ) = \u2207\u03c1 \u00b7 J\u2207V = {\u03c1, V } .\nWe thereby obtain a \u201cvorticity formulation\u201d of the IPM equation as\n\u03c1\u0307 = {\u03c8, \u03c1}, \u2206\u03c8 = {V, \u03c1}. (2.1)\nRemark 2.2. The first equation emphasizes the Hamiltonian nature of the evolution of density \u03c1 with the (time-dependent) Hamiltonian \u03c8 with respect to the area form on M . In particular, \u03c1 preserves all the standard Casimir functions\nCf (\u03c1) = \u222b M f(\u03c1(x))dx\nfor any (measurable) functions f : R\u2192 R.\n2.2. Gradient flows on volume preserving diffeomorphisms. It turns out, the IPM equation is not only Hamiltonian, but it has a more prominent gradient nature. Namely, let M be a two-dimensional Riemannian manifold and Diff\u00b5(M) stands for the group of Hamiltonian diffeomorphisms.\nWe are interested in gradient flows on Diff\u00b5(M) with respect to a right-invariant Riemannian metric defined by an inertia operator A : X\u00b5(M) \u2192 X\u2217\u00b5(M). For the group Diff\u00b5(M) we may identify the dual X \u2217 \u00b5(M) of its Lie algebra with the space of exact 2-forms d\u21261(M) or with the space of vorticity functions C\u221e0 (M). The pairing for a Hamiltonian vector field v = X\u03c8 and a vorticity \u03c9 \u2208 C\u221e0 (M) is\n\u3008v, \u03c9\u3009 = \u222b M \u03c8 \u03c9 \u00b5.\nWith respect to this pairing the ad\u2217 operator is given by the bracket\nad\u2217v \u03c9 = {\u03c8, \u03c9}. Since the Lie algebra of Hamiltonian vector fields can be identified with the Poisson algebra of Hamiltonian functions (modulo constants), from now on we shall implicitly identify v with its Hamiltonian (or stream) function \u03c8 via v = X\u03c8.\nLet V \u2208 C\u221e(M) be a potential function for a classical mechanical system with configuration space M . Now we fix a function \u03c90 \u2208 C\u221e(M), which will have the meaning of density or vorticity depending on the setting. Consider now a \u201clinear\u201d functional on the group Diff\u00b5(M) associated with this fixed function of the form\nE0(\u03d5) = \u222b M (V \u25e6 \u03d5)\u03c90 \u00b5 = \u222b M V \u03c9 \u00b5, (2.2)\nwhere \u03c9 := \u03c90\u25e6\u03d5\u22121 is the vorticity transported by a diffeomorphism \u03d5 \u2208 Diff\u00b5(M).\nTheorem 2.3. The gradient flow on Diff\u00b5(M) for the functional (2.2) and the right-invariant Riemannian metric determined by the inertial operator A is\n\u03d5\u0307 = \u2212\u2207E0(\u03d5) = \u2212X\u03c8 \u25e6 \u03d5, where A\u03c8 = {V, \u03c90 \u25e6 \u03d5\u22121}. The dynamics is completely determined by the transported vorticity \u03c9 = \u03c90 \u25e6 \u03d5\u22121 via the \u201cdouble bracket\u201d-type flow\n\u03c9\u0307 = \u2212{A\u22121{V, \u03c9}, \u03c9} (2.3) for the inertial operator A = \u2206 given by the Laplacian, A : \u03c8 7\u2192 \u03c9 = \u2206\u03c8.\nProof. This is an application of the general framework described in Appendix A (Section 5). By setting E0(\u03d5) = F (\u03c90 \u25e6 \u03d5\u22121) for F (\u03c9) = \u222b M V \u03c9 \u00b5, the gradient flow for E0 corresponds to the dynamics of the generator \u03c9 given above. Namely, it is a double bracket flow with the inertia operator squeezed in between the two brackets.\nExample 2.4. Take the manifold M to be the cylinder, M = T \u2217S1 = {(\u03c6, z) | \u03c6 \u2208 S1, z \u2208 R}, while the potential V (\u03c6, z) = z to be the height function. a) For the inertia operator A = \u2206 on stream functions we obtain the incompressible porous medium equation (IPM) defined above. Note that A defines the standard L2 Arnold metric, when considered on vector fields (instead of their stream\nfunctions), and it is the H\u22121-metric when considered on vorticities. The potential functional is F (\u03c1) = \u222b M V \u03c1.\nb) For the identity inertia, A = id, and the same potential we obtain the continuous Toda flow defined in the next section.\nRemark 2.5. Notice that the functional F (\u03c1) = \u222b M V \u03c1 can be also regarded as a Lyapunov function for the IPM flow with respect to the H\u22121-metric:\nd dt F (\u03c1) = \u222b M V {\u03c8, \u03c1} = \u222b M {V, \u03c1}\u2206\u22121{V, \u03c1} = \u2212\u3008{V, \u03c1}, {V, \u03c1}\u3009H\u22121 .\nRemark 2.6. It is worth to add that the IPM equation (as well as the Toda system discussed below), being a \u201cdouble bracket\u201d flow, exhibit both gradient and Hamiltonian properties: it is a gradient flow for a function on a coadjoint orbit, but it is also a Hamiltonian flow for another function on the same orbit. Note, however, that this is an example of a non-autonomous Hamiltonian equation: the Hamiltonian function does change in time, as its differential is related to a certain bracket itself. Thus the convergent asymptotic behavior typical for gradient systems (and discussed below as a diagonalization procedure) does not contradict the conservative nature of autonomous Hamiltonian systems.\n2.3. Local well-posedness of IPM. In this section we use the techniques developed by Ebin and Marsden [12] to prove local in time well-posedness of the IPM equation (2.1). Short-time existence results for M = R2 were already given by Co\u0301rdoba, Gancedo, and Orive [9]. The alternative approach described below is of interest due to a much closer relation to Euler-Arnold equations and previous geometric analysis framework.\nTheorem 2.7. Let M be a closed Ka\u0308hler (Riemannian and symplectic) manifold of dimension 2d and let V \u2208 C\u221e(M). Furthermore, let s > d+ 1. Then for every initial \u03c10 \u2208 Hs(M) there exists a maximal existence interval [0, T ) with T > 0 in which the equation (2.1) has a unique solution \u03c1 : [0, T )\u2192 Hs(M).\nProof. First, we relax the equation by lifting it to the group of symplectomorphisms Diff\u00b5(M): \u03b7\u0307 = v \u25e6 \u03b7, v = \u2207\u22a5\u2206\u22121{V, \u03c1}, \u03b7(0) = id, (2.4) where \u03c1 = \u03c10\u25e6\u03b7\u22121. Since s > d+1 it follows from results by Palais [23] and by Ebin and Marsden [12] that the Sobolev completion Diffs\u00b5(M) is a Hilbert manifold. The aim is to show that the equation (2.4) is a smooth ordinary differential equation on Diffs\u00b5(M). We have that v can be thought of as the following composition: v = A \u25e6B \u25e6 C \u25e6 \u03c4(\u03b7\u22121) where\nA : Hs+10 (M)\u2192 Xs\u00b5, \u03c8 7\u2192 \u2207\u22a5\u03c8 B : Hs\u221210 (M)\u2192 H s+1 0 (M), \u03c1 7\u2192 \u2206\u22121\u03c1 C : Hs(M)\u2192 Hs\u221210 (M), \u03c1 7\u2192 {V, \u03c1} \u03c4 : Diff\u00b5(M)\u2192 Hs(M), \u03d5 7\u2192 \u03c10 \u25e6 \u03d5.\nThe flow can now be written as \u03b7\u0307 = ( (A \u25e6B \u25e6 C \u25e6 \u03c4)(\u03b7\u22121) ) \u25e6 \u03b7.\nThis proves that (2.4) is indeed an ODE on Diffs\u00b5(M). However, it remains to prove that it is a smooth ODE.\nThe operators A,B,C, \u03c4 are all smooth, but the operation \u03b7 \u2192 \u03b7\u22121 is not more than C0 (in particular not Lipschitz). The strategy of Ebin and Marsden [12] is\nto prove that the particular combination of the \u2018inverse map\u2013differential operator\u2013 forward map\u2019 is smooth. To this end, we define Diffs\u00b5(M)-bundle operators\nA\u0303 : Diffs\u00b5(M)\u00d7Hs+10 \u2192 TDiff\u00b5(M), (\u03b7, \u03c8) 7\u2192 (A(\u03c8 \u25e6 \u03b7\u22121)) \u25e6 \u03b7, B\u0303 : Diffs\u00b5(M)\u00d7Hs\u221210 \u2192 Diff\u00b5(M)\u00d7H s+1 0 , (\u03b7, \u03c1) 7\u2192 (B(\u03c1 \u25e6 \u03b7\u22121)) \u25e6 \u03b7 C\u0303 : Diffs\u00b5(M)\u00d7Hs \u2192 Diff\u00b5(M)\u00d7Hs\u221210 , (\u03b7, \u03c1) 7\u2192 (C(\u03c1 \u25e6 \u03b7\u22121)) \u25e6 \u03b7.\nThe total flow can now be written as\n\u03b7\u0307 = (A\u0303 \u25e6 B\u0303 \u25e6 C\u0303)(\u03b7, \u03c10).\nSince A and C are differential operators, and since the right composition is smooth, it follows from standard results (e.g. [18, Lemma 3.4]) that A\u0303 and C\u0303 are smooth bundle maps. By the same argument it follows that B\u0303\u22121 is a smooth bundle map. Since B is an isomorphism it follows that B\u0303 is also a smooth bundle map (e.g. [18, Lemma 3.2]). Then the standard Picard iterations on Banach manifolds give local well-posedness in the sense of Hadamard.\nRemark 2.8. In the next section we shall see that the Toda flow is geometrically exactly of the same form as IPM. The only difference is the choice of inertia operator A, which is the Laplacian for IPM but the identity for Toda. From an analysis point of view, however, the IPM flow behaves much better than Toda. In particular, the continuous Toda flow (see below) cannot be rigorously posed as an ODE on the Hilbert manifold Diffs\u00b5(M): it is prevented by a loss of spatial derivatives in the right-hand side. As we discuss and illustrate in \u00a7 4, this lack of regularity suggests slower convergence to a steady state."
        },
        {
            "heading": "3. Toda flows, their continuous limit, and double bracket representation",
            "text": "3.1. Toda lattice. Consider n interacting particles on a line, where neighbours interact with an exponential potential. The corresponding system is described by the Toda flow in the symplectic space (R2n, \u2211 dqi \u2227dpi) generated by the Hamiltonian\nH = 12 \u2211n j=1 p 2 j + \u2211n\u22121 j=1 exp 2(qj \u2212 qj+1), being the sum of kinetic and potential energies, with the interaction potential exp(u) where u := 2(qk \u2212 qk+1) stands for the doubled distance between neighbours. (One usually normalizes the system so that the mass center is at 0, i.e., \u2211 qi = 0, so there are n\u2212 1 degrees of freedom.)\nProposition 3.1 (Flaschka [13], Moser [21]). Newton\u2019s equation of the Toda flow of n interacting particles after the change of variables aj = exp(qj \u2212 qj+1) with j = 1, . . . , n\u2212 1, and bk = pk with k = 1, . . . , n, assumes the following form:{\na\u0307k = \u2212ak(bk+1 \u2212 bk) b\u0307k = \u22122(a2k \u2212 a2k\u22121) .\n(3.1)\nThis system has the Lax form L\u0307 = [L,M ], where\nL =  b1 a1 0 0 a1 b2 a2 0 a2 b3\n. . . an\u22121 0 an\u22121 bn\n and M =  0 a1 0 0 \u2212a1 0 a2 0 \u2212a2 0 . . . an\u22121\n0 \u2212an\u22121 0  , with \u2211 bk = 0. This system is Hamiltonian with the Toda Poisson structure given by {bj , aj\u22121}\u2032 = \u2212aj\u22121, {bj , aj}\u2032 = aj, while all other brackets are zero. The\nHamiltonian function in the new coordinates is H = 12 tr(L 2) = \u2211n\u22121 1 a 2 j + \u2211n 1 b 2 k, with evolution equations being\na\u0307j = {H, aj}\u2032, b\u0307j = {H, bj}\u2032.\nRemark 3.2. The Lax equation L\u0307 = [L,M ] implies that L changes in its conjugacy class, L(t) = u(t)L0u\n\u22121(t), where u(t) \u2208 SO(n) are solutions to u\u0307 = Mu, u(0) = I. In particular, functions Ik = 1 k tr(L\nk), that are symmetric polynomials of the eigenvalues of L, are first integrals for k = 2, . . . , n. In particular, I2 = H. (In Lie algebra language, L\u0307 = [L,M ] is an equation on a symplectic manifold, which is the orbit of L0 understood as an orbit in the appropriate lower-trangular matrix group, while \u03c9 is the orbit symplectic structure coming from the Lie-Poisson bracket in that space.) The existence of n\u22121 first integrals, which turn out to be in involution, on the symplectic 2(n\u2212 1)-dimensional space implies complete integrability of the Toda flow.\nRemark 3.3. The matrix M itself can be represented as the commutator: M = [L,D], where D := diag(1, 2, ..., n). This implies that the Toda system of n particles can be rewritten as the double-bracket equation:\nL\u0307 = [L, [L,D]] (3.2)\nfor the matrix L as above, see Bloch [2] and Bloch, Brockett, and Ratiu [3].\n3.2. Toda continuous limit. Following Bloch, Flaschka, and Ratiu [4], consider now the continuous limit of the above system.\nDefinition 3.4. The continuous Toda flow (or dispersionless Toda system of equations) is the following evolution system on functions a(z), b(z) of PDEs:{\na\u0307 = \u2212a \u2202\u2202z b b\u0307 = \u22122 \u2202\u2202za 2 .\nThere are several ways to obtain this system from its discrete analogue. One can directly replace the discrete parameter k \u2208 Z in the Toda system (3.1) by a continuous parameter z \u2208 R, while replacing the differences of consecutive terms by the derivatives.\nAlternatively (see [4]), one can think of L and M as infinite tridiagonal matrices and express them in the form L = ak exp (\u2202/\u2202\u03c6) + bk + ak exp (\u2212\u2202/\u2202\u03c6) and M = ak exp (\u2202/\u2202\u03c6) \u2212 ak exp (\u2212\u2202/\u2202\u03c6), where exp (\u2202/\u2202\u03c6) is understood as the diagonal shift operator. (Indeed, if \u03c6 enumerates diagonals and then according to the Taylor expansion, exp ( \u2202/\u2202\u03c6) is a shift by : for a test function f(\u03c6) one has f(\u03c6+ ) =\u2211 m\nmf (m)(\u03c6)/m! = exp( \u2202/\u2202\u03c6)f(\u03c6) as \u2192 0.) Now replace the integer index k of ak and bk by a continuous parameter z \u2208 R to obtain time-dependent functions a(z), b(z). The corresponding system of equations becomes the system of dispersionless Toda equations. The continuous limit of the tridiagonal matrix L assumes the form L(z, \u03c6) = b(z) + 2a(z) cos\u03c6, where 2 cos\u03c6 = exp(i\u03c6)+exp(\u2212i\u03c6) and exponentials exp(\u00b1i\u03c6) label the first superand sub-diagonals, while variable z parametrizes the diagonal direction. (The above form of L can be thought of as a compact version of a hyperbolic analog L = b(z) + 2a(z) cosh\u03c6, where 2 cosh\u03c6 = exp\u03c6+ exp(\u2212\u03c6).)\nProposition 3.5 (Faybusovich 1990, see [4]). For the function\nL(\u03c6, z) = b(z) + 2a(z) cos\u03c6\non M = T \u2217S1 the dispersionless Toda equations assume the form of the Brockett double bracket equation\ndL dt = \u2212{L, {L, z}} , (3.3)\nwhere {\u00b7, \u00b7} is the Poisson bracket for the symplectic structure dz\u2227d\u03c6 on the annulus M = {(z, \u03c6) | z \u2208 R, \u03c6 \u2208 S1}.\nProof. It is a straightforward computation:\n{L, z} = \u2202L \u2202\u03c6 \u2202z \u2202z \u2212 \u2202z \u2202\u03c6 \u2202L \u2202z = \u22122a(z) sin\u03c6\nThen {L, {L, z}} = {L,\u22122a(z) sin\u03c6}\n= \u2202L\n\u2202\u03c6 (\u22122a\u2032(z) sin(\u03c6)) + 2a(z) cos\u03c6(b\u2032(z) + 2a\u2032(z) cos\u03c6)\n= 2a(z) sin\u03c6(2a\u2032(z) sin\u03c6) + 2a(z) cos\u03c6(b\u2032(x) + 2a\u2032(z) cos\u03c6)\n= 4a(z)a\u2032(z) + 2a(z)b\u2032(z) cos\u03c6\nThus the equation dLdt = \u2212{L, {L, z}} for L\u0307 := b\u0307(z) + 2a\u0307(z) cos\u03c6 is equivalent to the system {\na\u0307 = \u2212ab\u2032 b\u0307 = \u22122(a2)\u2032 , (3.4)\nwhere prime stands for the derivative in z.\nRemark 3.6. In the continuous limit the integrals Ik = tr(L k), k = 1, 2, ... become\nJk = 1\n2\u03c0 \u222b R \u222b 2\u03c0 0 (b(z) + 2a(z) cos\u03c6)k dz d\u03c6 .\nIn particular, J2 = \u222b R(b(z) 2 + 2a(z)2) dz.\nYet one more way of obtaining the continuous Toda flow directly from the coordinates in the (q, p) particle phase space is given in Appendix B.\n3.3. The Hamiltonian nature of the Toda flow. Consider the Poisson structure {F,G}\u2032(a, b) = \u222b R a \u03b4F \u03b4a \u2202 \u2202x \u03b4G \u03b4b \u2212 a\u03b4G \u03b4a \u2202 \u2202x \u03b4F \u03b4b . Then Hamilton\u2019s equations become\na\u0307 = {H, a}\u2032 = \u2212a \u2202 \u2202x \u03b4H \u03b4b b\u0307 = {H, b}\u2032 = \u2212 \u2202 \u2202x a \u03b4H \u03b4a .\nThus we see that (3.4) is Hamiltonian for\nH(a, b) = 1\n2 \u222b R (2a2 + b2) dz = J2(a, b)/2.\nNotice that ad\u2217 is given by\nad\u2217(u,v)(a, b) = ( \u2212a \u2202\u2202xv \u2212 \u2202\u2202xau ) where (u, v) are algebra elements. (Here we assume that a2b vanishes at \u00b1\u221e so the boundary terms vanish when we do integration by parts.) Thus, we have shown that the system (3.4) admits both a Hamiltonian and a gradient formulation.\n3.4. A comparison of the continuous Toda and the IPM equation. Now we return to the double-bracket form of both the equations. Recall that the IPM equation on a 2D manifold can be thought of as the following equation on the vorticity \u03c9, cf. equation (2.3):\n\u03c9\u0307 = \u2212{A\u22121{z, \u03c9}, \u03c9}. On the other hand, the dispersionless Toda equation (3.3) has the form\nL\u0307 = \u2212{{z, L}, L} on the function L(\u03c6, z) = b(z) + 2a(z) cos\u03c6, where b plays the role of the (continuous) momentum and a would be related to the particle density on the line, cf. equation (6.1).\nRemark 3.7. For the interpretation as a porous medium equation the following feature of the Toda dynamics of n particles will be important: ak(t) \u2192 0 and bk(t)\u2192 constk as t\u2192 \u00b1\u221e for k = 1, . . . , n\u2212 1. This implies that the distance between particles goes to infinity, |qk+1(t)\u2212qk(t)| \u2192 \u221e, and L(t)\u2192 diag(p\u00b11 , . . . , p\u00b1n ). Furthermore, due to the isospectral property, p\u00b1k are eigenvalues, that are assumed to be distinct, while the interaction is repelling, with pj(t) \u2192 p\u00b1j and qj(t) \u2192 p\u00b1j t + q \u00b1 j as t \u2192 \u221e. If \u03bb1 < \u00b7 \u00b7 \u00b7 < \u03bbn are ordered eigenvalues of L(t) for all t, then p+j = \u03bbj , p \u2212 j = \u03bbn+1\u2212j and \u03bbj are first integrals, implying integrability [Moser 1975]. In other words, as t \u2192 \u00b1\u221e the particles are almost non-interacting, while as t changes from \u2212\u221e to +\u221e their interaction (by the Toda exponential potential) can be thought of as the faster particles \u201cpenetrating through\u201d slower ones. This can also be interpreted as rearranging the order of particles to have their momenta increasing on the line for large t.\nNow one can interpret the continuous Toda flow as a flow of particles on the line, in which particles \u201cgo through each other\u201d as through porous medium and undergo certain interactions, according to the equations. The interaction law is determined by the inertia operator A and is different for the IPM equation and the Toda flow, where A is respectively \u2206 or the identity id. (The difference in the inertia operator is somewhat similar to different shapes of rigid bodies leading to different Euler top equations according to those shapes.) Hence the Toda flow can be regarded as a certain seepage in the porous medium.\nExample 3.8. We present modelling of the two flows, IPM in equation (2.3) and continuous Toda in equation (3.3), on the sphere M = S2 to see the corresponding similarity and differences in their dynamics. Details of how the numerical simulations were carried out are given in section 4 below.\nWe note that in the case of Toda, the dynamics in a(z) and b(z) is visualized as a dynamics on L of special tridiagonal form (or its smooth analog of the form L(\u03c6, z) = b(z) + 2a(z) cos\u03c6 with auxiliary variable \u03c6). Such a submanifold in the space of all matrices or all functions L(z, \u03c6) is invariant but unstable, which makes the modeling numerically challenging. The corresponding evolution clearly shows the penetration of particles, as they try to align with the potential, which is the height function. See Figure 1 for dynamics of functions L : S2 \u2192 R as a spherical analog of the cylinder.\nOn the other hand, the dynamics of the IPM equation thanks to the (inverse inertia) operator \u2206\u22121 in Equation (2.3), the corresponding dynamics of the vorticity function \u03c9 is numerically stable. Hence, while an analogous submanifold of functions \u03c9 is not invariant, it does not affect the asymptotic dynamics: solutions still converge to a similar final configurations aligned with the potential, see Figure 2.\nThese similarities in the IPM and Toda flows allow one to interpret the latter as a porous medium-type equation."
        },
        {
            "heading": "4. Comments on the diagonalization algorithms",
            "text": "4.1. Discretization of the fluid and Toda flows. We first describe the setup for numerical simulations yielding Figure 1 and Figure 2. The connection between isospectral flows of matrices and incompressible transport equations for functions on some domain M is established via the following discretization procedure. The notion, due to Zeitlin [24] and based on the explicit quantization of Hoppe [14], gives an approach for Casimir preserving numerical discretization schemes for incompressible 2D hydrodynamics. In order for the discretization to yield finitedimensional operators (matrices), the underlying symplectic manifold M has to be compact. Thus, instead of T \u2217S1 we work with S2 (for which efficient discretization algorithms are developed in [19, 8]).\nThe corresponding discretization gives us projections TN : C\u221e(S2)\u2192 u(N) with right inverses T \u22121N such that (weakly)\nT \u22121N ([TN (f), TN (f)])\u2192 {f, g} as N \u2192\u221e.\nThe size N of the matrices should thus be seen as a discretization parameter.\nIn the case of Toda, we confine to the invariant subspace of purely imaginary symmetric matrices iS(N) \u2282 u(N), which we identify with real symmetric matrices S(N). This restriction corresponds to the restriction of functions {L \u2208 C\u221e(S2) | L(\u03b8, \u03c6) = L(\u03b8,\u2212\u03c6)} where \u03b8 is the polar angle and \u03c6 is the azimuthal angle. As described above, the finite-dimensional Toda flow (3.2) actually evolves on even the smaller subspace of tridiagonal symmetric matrices, which corresponds to functions on S2 whose spherical harmonics components L`m vanish for |m| > 1. Furthermore, zonal functions correspond to diagonal matrices, and, in particular, the height function on the sphere z = cos \u03b8 corresponds to the diagonal matrix D with equidistant entries from \u22121 (south pole) to 1 (north pole). We have thus obtained that the finite-dimensional Toda flow (3.2) is a numerical discretization of the corresponding continuous Toda flow (3.3) for M = S2 (instead of M = T \u2217S1).\nTo obtain a matrix discretization of the IPM equation on S2 we need, in addition to the structures just described, a discrete version of the Laplace operator. Based on the representation of so(3) in u(N), such an operator \u2206N : u(N) \u2192 u(N) is given by Hoppe and Yau [15]. An efficient method for solving the discrete Poisson equation \u2206NW = P in O(N2) operations is derived in [8]. This provides all the ingredients needed to obtain a matrix discretization of the IPM equation (2.1) for M = S2 and V (\u03b8, \u03c6) = z = cos \u03b8.\nWe simulate the two systems with initial data given by a randomly generated, tridiagonal symmetric N \u00d7N matrix for N = 256. For time integration we use the isospectral preserving method developed in [20]. Snapshots of the results, visualized as smooth functions via the Hammer projection of the sphere, are given in Figure 1 and Figure 2. In both cases the flows tend towards a zonal state (corresponding to a diagonal matrix).\n4.2. Modification of the QR diagonalization via the IPM flow. The classical QR algorithm for diagonalization of symmetric matrices, which is one of the main diagonalization algorithms, can be regarded as the Toda flow at integer time moments, see [10]. The latter (often restricted to tri-diagonal matrices) is called the Toda algorithm, and it not only diagonalizes matrices, but also orders their eigenvalues. For instance, its stopping time, when the numerically found eigenvalues are sufficiently close to the actual ones, has universal nature and is an important research topic, see [11].\nOur study comparing the Toda and IPM flows suggests the following modification of the QR diagonalization algorithm for symmetric matrices, which is particularly efficient for matrices of large size. Namely, Figure 3 compares the speed of convergence to reordered eigenvalues for the 256\u00d7 256 initial matrix by our finitedimensional versions of the Toda flow and the IPM flow. The graphs for the 10th, 50th, 100th, 150th, and 200th eigenvalues continue to oscillate for a long time in the Toda flow. On the other hand, there are no such oscillations for the IPM flow, which quickly arrives at the final values. The convergence turns out to be so much faster due to the inverse Laplacian as the inertia operator in the IPM equation, which makes the numerical scheme more stable.\nThis comparison is continued in Figure 4 which describes the final diagonal values for the Toda and IPM algorithms (and also the new diagonalizing flow outlined below) by juxtaposing them with the exact spectrum. The result for IPM is almost indistinguishable from the true spectrum, while the Toda flow still exhibits oscillations and unordered segments in the spectrum (after 1500 iterations). While the detailed study is yet to be done, these figures already suggest that the IPM equation with the Laplace inertia operator might be an efficient replacement for\nthe diagonalization and reordering algorithm: due to the presence of \u2206\u22121 in the equation, its flow is stable and converging much faster.\n4.3. An unordered diagonalization algorithm. The new approach via IPM also suggests new gradient flows for diagonalization of symmetric matrices. Indeed, from a numerical point of view, a convergence to a diagonal matrix (called deflation) is much more essential then ordering the eigenvalues. Thus, it is natural to consider the isospectral gradient flow on symmetric matrices L that aims to maximize the following energy\nF (L) = 1\n2 N\u2211 i=1 |Lii|2.\nIndeed, recall that the square of the matrix Frobenius norm is tr (LL>). For a symmetric matrix L = L> the norm is constant on its isospectral orbit. Furthermore, this squared norm is given by the sum of squared eigenvalues, so the energy functional F on the orbit is maximized if and only if L is diagonal. The differential of this energy at a matrix L is given by the projection (denoted by D(L)) onto the diagonal part. Thus the IPM version of the gradient flow for the energy F is given by\nL\u0307 = [\u2206\u22121N [D(L), L], L], (4.1)\nwhere \u2206N is the discrete Laplacian described above. The continuous analog of D(L) for M = S2 is L2-orthogonal projection onto the subspace of zonal functions (i.e., averaging along fixed latitudes). As can be seen in Figure 5, the convergence to a diagonal matrix is fast, and as stable as in IPM, but contrary to IPM and Toda the elements on the diagonal are not sorted. As mentioned above, if sorted,\nthe computed spectrum is precise, similarly to the IPM, cf. the last two diagrams in Figure 4.\nFinally, in Figure 6 we see how the gradient flow for the energy F interpreted on the sphere strives to a zonal state, but with bands that are non-ordered from south to north, while instead correlated to the initial configuration. These findings indicate that the flow (4.1) might be useful for diagonalization when sorting of eigenvalues is unimportant.\nRemark 4.1. The code for the simulations and animations illustrating the dynamics of the three flows are available here:\nhttps://github.com/klasmodin/diagonalizing-flows"
        },
        {
            "heading": "5. Appendix A: Universal double bracket flows",
            "text": "5.1. The gradient flow on a Lie group. Here we consider a framework for Riemannian gradient flows confined to group orbits. This leads to the proper setting for the double bracket flows in the case of an arbitrary inertia operator. A similar framework, with focus on shape analysis, is also given in [1].\nLet Q be a configuration manifold, possibly infinite-dimensional. Furthermore, let G be a Lie group (or a Fre\u0301chet\u2013Lie group in the infinite-dimensional case) acting on Q from the left by a smooth action map \u03a6: G \u00d7 Q \u2192 Q; the action of g \u2208 G on q \u2208 Q is denoted g \u00b7 q. This action is typically neither free, nor transitive. The orbit of q \u2208 Q is Orb(q) = {g \u00b7 q | q \u2208 G}. We think of Q as the space of \u2018shapes\u2019 and the orbit Orb(q) represents all possible deformations of q. For a given template shape q0, our objective is to study gradient flows on Orb(q0). Notice, however, that we do not assume that Q is Riemannian; the Riemannian structure on Orb(q0) is instead inherited from G. Before we state the main result of this section, we need a few concepts from geometric mechanics (cf. [17]).\nBy differentiating the action map at the identity we obtain the infinitesimal action map g\u00d7Q\u2192 TQ, where g = TeG is the Lie algebra of G. The infinitesimal action of v \u2208 g on q \u2208 Q is denoted v \u00b7 q. This linear map in v is the (cotangent bundle) momentum map:\nDefinition 5.1. The momentum map J : T \u2217Q\u2192 g\u2217 is defined by \u3008J(q, p), v\u3009 = \u3008p, v \u00b7 q\u3009 \u2200 v \u2208 g,\nwhere T \u2217Q denotes the cotangent bundle of Q.1\nNext, we introduce a Riemannian structure on G.\nDefinition 5.2. A Riemannian metric \u3008\u3008\u00b7, \u00b7\u3009\u3009 : TG\u00d7 TG\u2192 R on G is called rightinvariant if \u3008\u3008u, v\u3009\u3009e = \u3008\u3008u \u00b7 g, v \u00b7 g\u3009\u3009g, \u2200 g \u2208 G, \u2200u, v \u2208 g, where u \u00b7 g denotes the tangent lifted right action of g on u.\nA right-invariant metric is completely determined by the inner product \u3008\u3008\u00b7, \u00b7\u3009\u3009e.\nDefinition 5.3. Let \u3008\u3008\u00b7, \u00b7\u3009\u3009 be a right-invariant metric on G. Then the inertia operator A : g\u2192 g\u2217 is defined by\n\u3008Av, u\u3009 = \u3008\u3008v, u\u3009\u3009e.\nSince G acts on Q from the left, the action map induces a Riemannian structure on Orb(q). To see this, we first need the notion of horizontal vectors on G.\nDefinition 5.4. The vertical distribution associated with the action of G on q \u2208 Q is the subbundle of TG given by\nVerg = {v \u00b7 g \u2208 TgG | v \u00b7 g \u00b7 q = 0}. If \u3008\u3008\u00b7, \u00b7\u3009\u3009 is a right-invariant metric on G, then the corresponding horizontal distribution is given by\nHorg = Ver \u22a5 g\nwhere the complement is taken with respect to \u3008\u3008\u00b7, \u00b7\u3009\u3009. 1If Q is an infinite-dimensional Fre\u0301chet manifold, the cotangent bundle T \u2217Q is given in terms of the regular dual (cf. [16]), defined so that T \u2217q Q ' TqQ.\nLemma 5.5. Assume that Orb(q) is a submanifold of Q. Then any right-invariant Riemannian metric \u3008\u3008\u00b7, \u00b7\u3009\u3009 induces a Riemannian metric g on Orb(q) fulfilling\ngg\u00b7q(v \u00b7 g \u00b7 q, v \u00b7 g \u00b7 q) = \u3008\u3008v, v\u3009\u3009e \u2200 v \u00b7 g \u2208 Horg. (5.1)\nProof. Since Orb(q) is a manifold, the mapping \u03c0 : G \u2192 Q defined by \u03c0(g) = g \u00b7 q is a submersion. Thus, Tg\u03c0 : Horg \u2192 T\u03c0(g)Orb(q) is a linear isomorphism. Now, for (x, x\u0307) \u2208 TOrb(q), take any g such that x = \u03c0(g) (which exist by definition of the group orbit). Define the metric at x by\ngx(x\u0307, x\u0307) = \u3008\u3008(Tg\u03c0)\u22121x\u0307\ufe38 \ufe37\ufe37 \ufe38 v\u00b7g , (Tg\u03c0) \u22121x\u0307\ufe38 \ufe37\ufe37 \ufe38 v\u00b7g \u3009\u3009g.\nBy right-invariance, this metric satisfies (5.1) and is independent of the choice of g.\nLet G be a Lie group acting from the left on a manifold Q of shapes. Let q0 \u2208 Q and let F : Q \u2192 R be a function on Q. We are interested in finding the minimum of F on the G-orbit of q0, that is, we want to minimize the function E : G \u2192 R defined by\nE(g) = F (g \u00b7 q0). If G is equipped with a right-invariant Riemannian metric g, defined by an inertia\noperator A : g\u2192 g\u2217, one can define the gradient vector field \u2207E on G by gg(\u2207E(g), g\u0307) = \u3008dE, g\u0307\u3009 .\nOur aim is to solve the minimization problem by considering the gradient flow\ng\u0307 = \u2212\u2207E(g). (5.2)\nProposition 5.6. The gradient \u2207E is given by \u2207E(g) = \u03be \u00b7 g.\nwhere \u03be \u2208 g is given by \u03be = A\u22121J(g \u00b7 q0,dF (g \u00b7 q0)).\nProof. By definition of the gradient we have\n\u3008\u3008\u2207E, g\u0307\u3009\u3009g = d\ndt E(g(t)) = \u3008dF, \u03be \u00b7 (g \u00b7 q0)\u3009 .\nwhere \u03be = g\u0307 \u00b7 g\u22121. Now from the definition of the momentum map it follows that \u3008\u3008\u2207E, g\u0307\u3009\u3009g = \u3008J(g \u00b7 q0, dF ), \u03be\u3009 = \u3008\u3008A\u22121J(g \u00b7 q0, dF ), g\u0307 \u00b7 g\u22121\u3009\u3009e\nThe result follows since the metric is right invariant.\nProposition 5.7. The gradient flow (5.2) induces a gradient flow on the G-orbit of q0, given by q\u0307 = \u2212u(q) \u00b7 q (5.3) where\nu(q) = A\u22121J(q,dF (q))\nProof. Follows from Prop. 5.6.\nDefinition 5.8. The double-bracket flow on the dual Lie algebra g\u2217 with the inertia operator A and a potential function F on g\u2217 is defined as follows:\nm\u0307 = ad\u2217A\u22121 ad\u2217 dF (m) (m)(m).\nFor the quadratic potential F (m) = \u3008m,A\u22121m\u3009 the corresponding flow is m\u0307 = ad\u2217A\u22121 ad\u2217\nA\u22121m (m)(m).\nProposition 5.9. The double-bracket flow on g\u2217 is the gradient for the restriction of F on each coadjoint orbit.\nProof. Indeed, consider the special case where Q = g\u2217. The action is given by g \u00b7m = Ad\u2217gm. The momentum map is thereby given by\n\u3008J(m, \u03be), v\u3009 = \u3008\u03be, ad\u2217v(m)\u3009 = \u3008adv(\u03be),m\u3009 = \u3008\u2212 ad\u03be(v),m\u3009 = \u3008\u2212 ad \u2217 \u03be(m), v\u3009\nThen from (5.3) we obtain the equation(s) in Definition 5.8, and the statement follows from Proposition 5.7. The corresponding flow tries to minimize the energy on a specific co-adjoint orbit.\nNote also that this flow is always orthogonal (with respect to A\u22121) to the (Hamiltonian) Euler-Arnold flow: one of them is tangent to levels of the Hamiltonian, while the other is orthogonal to the levels of the same function regarded as a potential. One can also see this directly, since\n\u3008ad\u2217A\u22121 ad\u2217 A\u22121m (m)(m), A \u22121 ad\u2217A\u22121m(m)\u3009 =\n\u3008m, [A\u22121 ad\u2217A\u22121m(m), A\u22121 ad \u2217 A\u22121m(m)]\u3009 = 0.\n5.2. Contraction property of the flow. Consider the gradient flow (5.2).\nProposition 5.10. Let d : G \u00d7 G \u2192 R denote the Riemannian distance function induced by the right-invariant metric associated with the gradient flow (5.2). Let \u03b3 : [0, T )\u2192 G be a solution curve. Then, for all t \u2208 [0, T )\nd(\u03b3(0), \u03b3(t))2 \u2264 t ( E ( \u03b3(0) ) \u2212 E ( \u03b3(t) )) .\nProof. First notice that\nd dt E(\u03b3(t)) = \u3008\u3008\u2207E(\u03b3), \u03b3\u0307\u3009\u3009\u03b3 = \u2212\u3008\u3008\u03b3\u0307, \u03b3\u0307\u3009\u3009\u03b3 = \u2212\u3008\u3008\u03b3\u0307 \u25e6 \u03b3\u22121, \u03b3\u0307 \u25e6 \u03b3\u22121\u3009\u3009e = \u2212\u3008\u3008v, v\u3009\u3009e\nfor the vector field v(t) generating the curve \u03b3(t). Denote by \u2016v\u20162A := \u3008\u3008v, v\u3009\u3009e = \u3008Av, v\u3009. Since any curve between \u03b3(0) and \u03b3(t) cannot exceed the length of the geodesic between the points we have\nd(\u03b3(0), \u03b3(t)) \u2264 \u222b t 0 \u2016v(s)\u2016A ds \u2264 \u221a t (\u222b t 0 \u2016v(s)\u20162A ds )1/2 ,\nwhere the last inequality is Cauchy\u2013Schwartz on L2([0, t]).\nRemark 5.11. Theorem 5.10 in relation to the IPM flow then gives the following result: the \u201cArnold fluid-distance\u201d between \u03d5(0) and \u03d5(t) is bounded by\nd(\u03d5(0), \u03d5(t))2 \u2264 t \u222b M V (\u03c1(0)\u2212 \u03c1(t))."
        },
        {
            "heading": "6. Appendix B: A direct continuous Toda limit",
            "text": "Start from the Hamiltonian for the finite-dimensional Toda lattice in (qj , pj) variables. Take the limit n \u2192 \u221e to obtain a continuous system on T \u2217Dens(R). Under this limit we have qj+1 \u2212 qj \u2192 \u03d5\u2032(z) where \u03d5 is the diffeomorphism describing how each point on the line has moved. Since we also have \u03d5\u2032(z) > 0 and therefore \u03c1 = Jac(\u03d5\u22121) = 1/\u03d5\u2032 \u25e6 \u03d5, we get the potential\nU(\u03d5) = \u222b R V (\u03d5\u2032)dz = \u222b R V (1/\u03c1 \u25e6 \u03d5\u22121)dz,\nwhere the potential V is V (r) = exp(\u22122r).\nThe gradient of U is computed as\nd dt U(\u03d5) = \u222b R V \u2032(\u03d5\u2032)\u03d5\u0307\u2032dz = \u222b R ( \u2212 \u2202 \u2202x V \u2032(\u03d5\u2032) ) \u03d5\u0307 dz\nNewton\u2019s equations on the space of diffeomorphisms is thereby\n\u03d5\u0308 = \u2202 \u2202z V \u2032(\u03d5\u2032) = \u22122 \u2202 \u2202z exp(\u22122\u03d5\u2032).\nThe fluid formulation of this system is v\u0307 +\u2207vv = ( \u2202\n\u2202z V \u2032(\u03d5\u2032)\n) \u25e6 \u03d5\u22121, \u03d5\u0307 = v \u25e6 \u03d5.\nLet us now make the following change of variables\na = exp(\u2212\u03d5\u2032), b = \u03d5\u0307. (6.1)\nSince the density is uniform, the variable b is interpreted physically as the Lagrangian momentum. Direct calculations now yield\na\u0307 = \u2212a \u2202 \u2202z \u03d5\u0307 = \u2212a \u2202 \u2202z b\nand, likewise,\nb\u0307 = \u03d5\u0308 = \u22122 \u2202 \u2202z a2.\nThis is the same equation as in the first continuous limit, which can be rewritten as\na\u0307 = \u2212a \u2202 \u2202z b, b\u0307 = \u22122 \u2202 \u2202z a2.\nDeclaration section. The authors have no competing interests to declare that are relevant to the content of this article. Data sharing is not applicable to this article as no datasets were generated or analysed during the current study."
        }
    ],
    "title": "THE TODA FLOW AS A POROUS MEDIUM EQUATION",
    "year": 2023
}