{
    "abstractText": "In a previous work, a two-layer linear receiver was proposed as a low-complexity scheme that can achieve a good trade-off between performance and complexity in a massive multiple-input multiple-output (MIMO) context. For this scheme, the antenna array is split up into a number of subsets and multi-cell minimum mean-square-error (MMMSE) combining is applied in each subset at the first layer. Then, the resulting outputs are combined using maximal-ratio combining (MRC) at the second layer. This paper presents a more complete performance analysis. First, we provide an entirely analytical derivation of the distribution of the output signal-to-noise-and-interference ratio (SINR) of first-layer processing based on multivariate statistical theory. The analysis includes both cases where the subset size is smaller or greater than the total number of signals. Furthermore, upper bounds and approximations on the average uplink SINR and achievable rate are derived. Numerical simulations confirm our analysis results.",
    "authors": [
        {
            "affiliations": [],
            "name": "Wahiba Abid"
        },
        {
            "affiliations": [],
            "name": "Mohamed Lassaad Ammari"
        },
        {
            "affiliations": [],
            "name": "S\u00e9bastien Roy"
        }
    ],
    "id": "SP:13d713e971440273c008d77e0f1b57265d73d771",
    "references": [
        {
            "authors": [
                "S. Elhoushy",
                "M. Ibrahim",
                "W. Hamouda"
            ],
            "title": "Cell-Free Massive MIMO: A Survey",
            "venue": "IEEE Communications Surveys & Tutorials, vol. 24, no. 1, pp. 492\u2013523, Oct. 2021. https://doi.org/10.1109/MCOM.2014.6736761",
            "year": 2021
        },
        {
            "authors": [
                "W. Saad",
                "M. Bennis",
                "M. Chen"
            ],
            "title": "A Vision of 6G Wireless Systems: Applications, Trends, Technologies, and Open Research Problems",
            "venue": "IEEE Network, vol. 34, no. 3, pp. 134\u2013142, May/June 2020. https://doi.org/10.1109/MNET.001.1900287",
            "year": 2020
        },
        {
            "authors": [
                "E.G. Larsson",
                "L.V. der Perre"
            ],
            "title": "Massive MIMO for 5G",
            "venue": "IEEE 5G Tech Focus, vol. 1, no. 1, March 2017.",
            "year": 2017
        },
        {
            "authors": [
                "T.L. Marzetta"
            ],
            "title": "Noncooperative Cellular Wireless with Unlimited Numbers of Base Station Antennas",
            "venue": "IEEE Trans. Wireless Commun., vol. 9, no. 11, pp. 3590\u20133600, Nov. 2010. https://doi.org/10.1109/TWC.2010.092810.091092",
            "year": 2010
        },
        {
            "authors": [
                "F. Rusek",
                "D. Persson",
                "B.K. Lau",
                "E.G. Larsson",
                "T.L. Marzetta",
                "O. Edfors",
                "F. Tufvesson"
            ],
            "title": "Scaling up MIMO: Opportunities and Challenges with Very Large Arrays",
            "venue": "IEEE Signal Process. Mag., vol. 30, no. 1, pp. 40\u201360, Dec. 2012. https://doi.org/10.1109/MSP.2011.2178495 Springer Nature 2021 LTEX template 18 Uplink SINR and Rate Analysis in Massive MIMO Systems with Two-Layer Linear Receiver",
            "year": 2012
        },
        {
            "authors": [
                "J. Hoydis",
                "S. ten Brink",
                "M. Debbah"
            ],
            "title": "Massive MIMO in the UL/DL of Cellular Networks: How Many Antennas Do We Need",
            "venue": "IEEE J. Sel. Areas Commun., vol. 31, no. 2, pp. 160\u2013171, Feb. 2013. https://doi.org/10.1109/MSP.2011.2178495",
            "year": 2013
        },
        {
            "authors": [
                "N. Krishnan",
                "R.D. Yates",
                "N.B. Mandayam"
            ],
            "title": "Uplink Linear Receivers for Multi-Cell Multiuser MIMO With Pilot Contamination: Large System Analysis",
            "venue": "IEEE Trans. on Wireless Commun., vol. 13, no. 8, pp. 4360\u2013 4373, April 2014. https://doi.org/10.1109/TWC.2014.2320914",
            "year": 2014
        },
        {
            "authors": [
                "L. Sanguinetti",
                "E. Bj\u00f6rnson",
                "A. Kammoun"
            ],
            "title": "Large-system analysis of massive MIMO with optimal M-MMSE processing",
            "venue": "IEEE International Workshop on Signal Processing Advances in Wireless Communications (SPAWC), pp. 1\u20135, July 2019.https://doi.org/10.1109/SPAWC.2019.8815490",
            "year": 2019
        },
        {
            "authors": [
                "X. Li",
                "E. Bj\u00f6rnson",
                "E.G. Larsson",
                "S. Zhou",
                "J. Wang"
            ],
            "title": "Massive MIMO with Multi-Cell MMSE Processing: Exploiting All Pilots for Interference Suppression",
            "venue": "EURASIP Journal on Wireless Communications and Networking, vol. 2017, no. 1, p. 117, June 2017. https://doi.org/10.48550/arXiv.1505.03682",
            "year": 2017
        },
        {
            "authors": [
                "E. Bj\u00f6rnson",
                "J. Hoydis",
                "L. Sanguinetti"
            ],
            "title": "Massive MIMO has unlimited capacity",
            "venue": "IEEE Trans. Wireless Commun., vol. 17, no. 1, pp. 574\u2013590, Jan. 2018. https://doi.org/10.1109/TWC.2017.2768423",
            "year": 2018
        },
        {
            "authors": [
                "A. Adhikary",
                "A. Ashikhmin",
                "T.L. Marzetta"
            ],
            "title": "Uplink interference reduction in large scale antenna systems",
            "venue": "IEEE Trans. Commun., vol. 65, no. 5, pp. 2194\u20132206, May 2017. https://doi.org/10.1109/TCOMM.2017.2662023",
            "year": 2017
        },
        {
            "authors": [
                "L. Sanguinetti",
                "E. Bj\u00f6rnson",
                "J. Hoydis"
            ],
            "title": "Toward Massive MIMO 2.0: Understanding Spatial Correlation, Interference Suppression, and Pilot Contamination",
            "venue": "IEEE Trans. Communications, vol. 68, no. 1, pp. 232\u2013 257, Jan. 2020. https://doi.org/10.1109/TCOMM.2019.2945792",
            "year": 2020
        },
        {
            "authors": [
                "W. Abid",
                "S. Roy",
                "M.L. Ammari"
            ],
            "title": "Uplink Performance Analysis for Massive MIMO Linear Processing",
            "venue": "IEEE Access, vol. 7, pp. 180749\u2013 180760, Dec. 2019. https://doi.org/10.1109/ACCESS.2019.2959580",
            "year": 1807
        },
        {
            "authors": [
                "Y. Jiang",
                "M.K. Varanasi",
                "J. Li"
            ],
            "title": "Performance Analysis of ZF and MMSE equalizers for MIMO systems: an in-depth study of the high SNR regime",
            "venue": "IEEE Trans. Inf. Theory, vol. 57, no. 4, pp. 2008\u20132026, Mar. 2011. https://doi.org/10.1109/TIT.2011.2112070",
            "year": 2008
        },
        {
            "authors": [
                "K. Guo",
                "Y. Guo",
                "G. Fodor",
                "G. Ascheid"
            ],
            "title": "Uplink Power Control with MMSE receiver in multi-cell MU-massive-MIMO systems",
            "venue": "Proc. IEEE Springer Nature 2021 LTEX template Uplink SINR and Rate Analysis in Massive MIMO Systems with Two-Layer Linear Receiver 19 ICC, pp. 5184\u20135190, 2014. https://doi.org/10.1109/ICC.2014.6884144",
            "year": 2021
        },
        {
            "authors": [
                "B. Wang",
                "Y. Chang",
                "D. Yang"
            ],
            "title": "On the SINR in Massive MIMO Networks with MMSE Receivers",
            "venue": "IEEE Communications Letters, vol. 18, no. 11, pp. 1979\u20131982, Nov. 2014. https://doi.org/10.1109/ICC.2014.6884144",
            "year": 1979
        },
        {
            "authors": [
                "H. Kang"
            ],
            "title": "Analytical framework for optimal combining with arbitrary-power interferers and thermal noise",
            "venue": "IEEE Trans. Veh. Technol., vol. 57, no. 3, pp. 1564\u20141575, May 2008. https://doi.org/10.1109/TVT.2007.907293",
            "year": 2008
        },
        {
            "authors": [
                "R.K. Mallik"
            ],
            "title": "Bit-error probability for optimum combining of binary signals in the presence of interference and noise",
            "venue": "IEEE Trans. Wireless Commun., vol. 3, no. 2, pp. 395\u2014407, March 2004. https://doi.org/10.1109/TWC.2003.821182",
            "year": 2004
        },
        {
            "authors": [
                "G.F. Pivaro",
                "S. Kumar",
                "G. Fraidenraich",
                "C.F. Dias"
            ],
            "title": "On the exact and approximate eigenvalue distribution for sum of Wishart matrices",
            "venue": "IEEE Transactions on Vehicular Technology, vol. 66, no. 11, pp. 10537\u2013 10541, Nov. 2017. https://doi.org/10.48550/arXiv.1504.00222",
            "year": 2017
        },
        {
            "authors": [
                "A.M. Tulino",
                "S. Verdu"
            ],
            "title": "Random matrix theory and wireless communications",
            "venue": "Foundations and Trends in Commun. and Info. Theory., vol. 1, no. 1, 2004.",
            "year": 2004
        },
        {
            "authors": [
                "M.S. Srivastava"
            ],
            "title": "Singular Wishart and multivariate beta distributions",
            "venue": "Annals of Statistics, vol. 31, no. 5, pp. 1537\u20131560, Oct. 2003.",
            "year": 2003
        },
        {
            "authors": [
                "S. Kumar"
            ],
            "title": "Eigenvalue statistics for the sum of two complex Wishart matrices",
            "venue": "Europhysics Letters, vol. 107, no. 6, p. 60002, Sep. 2014.",
            "year": 2014
        },
        {
            "authors": [
                "P. Li",
                "D. Paul",
                "R. Narasimhan",
                "J. Cioffi"
            ],
            "title": "On the distribution of SINR for the MMSE MIMO receiver and performance analysis",
            "venue": "IEEE Trans. Inform. Theory, vol. 52, no. 1, Jan. 2006. https://doi.org/10.1109/TIT.2005.860466",
            "year": 2006
        },
        {
            "authors": [
                "A. Shah",
                "A.M. Haimovich"
            ],
            "title": "Performance analysis of optimum combining in wireless communications with Rayleigh fading and cochannel interference",
            "venue": "IEEE Trans. Commun., vol. 46, no. 4, pp. 473-479, April 1998. https://doi.org/10.1109/26.664303",
            "year": 1998
        },
        {
            "authors": [
                "I.S. Gradshteyn",
                "I.M. Ryzhik"
            ],
            "title": "Products, 7th ed",
            "venue": "Nature",
            "year": 2007
        }
    ],
    "sections": [
        {
            "text": "Keywords: Massive MIMO, two-layer linear receiver, M-MMSE, SINR, achievable rate, inter-cell interference.\n1"
        },
        {
            "heading": "1 Introduction",
            "text": "Massive MIMO (multiple-input multiple-output) is the most promising wireless technology to allow for higher spectral efficiency (SE) in 5G and beyond wireless networks [1\u20133]. The key feature of this technology is that the number of base station (BS) antennas is much larger than the number of users within the service area. In fact, if the number of antennas is large enough, the effect of uncorrelated noise and intra-cell interference vanishes, and thereby an increase in data rate, degrees of freedom (DoFs), and transmission reliability can be achieved with simple signal processing [4, 5]. In spite of this potential, however, massive MIMO systems are subject to practical limitations, including BS receiver signal processing complexity and pilot contamination effects. In particular, Marzetta showed in his seminal paper [4] that with an infinite number of antennas, pilot contamination becomes the main capacity-limiting factor, especially when MRC / MRT schemes are used.\nThe uplink capacity behavior of massive MIMO systems has also been studied for other user detection schemes, such as the MMSE scheme. Singlecell MMSE (S-MMSE) combining was considered in [5\u20137], in which the BS only explicitly uses the channel estimates within its own cell. Extended works for multi-cell MMSE (M-MMSE) combining have been reported in [8, 9], where the BS computes estimates of the channels to users in all cells. With both schemes, a finite capacity limit was observed as the number of antennas goes to infinity, under the assumption of uncorrelated Rayleigh fading channels [9]. Moreover, it was shown that the M-MMSE scheme provides substantial SE gains over S-MMSE, while the latter has a lower computational complexity. In [10\u201312], the authors showed that the capacity of the M-MMSE scheme increases without bound by exploiting the spatial channel correlation, even under pilot contamination. However, the price to pay is a high computational complexity when dealing with higher dimensional systems.\nA low-complexity massive MIMO detector based on a two-layer linear receiver structure has been proposed previously in [13], which outperforms S-MMSE combining, and approaches the performance of M-MMSE combining with significantly reduced complexity. The proposed processing scheme, denoted M-MMSE/MRC, consists in dividing the antenna array into a number of subsets, and performing M-MMSE processing at the subset level. Then, the resulting outputs are combined using MRC at the second layer. In this previous work, we investigated a numerical trade-off analysis between complexity and performance in terms of bit error rate (BER), as well as derived tight approximations for the residual interference powers at the output of the first layer. One of the main results of [13] is that the subset size is a key parameter in achieving a desired performance / complexity trade-off.\nIn this paper, we extend our previous study to analyze theoretically the uplink SINR and rate performance with the proposed M-MMSE/MRC scheme that takes the inter-cell interference into account, and assuming uncorrelated Rayleigh fading. Here, it is worth mentioning that many analytical works concerning the performance analysis of MMSE detection are specifically based\non the properties of complex Wishart matrices [14\u201316]. Given a large-scale antenna array, the channel matrix is singular and its distribution becomes more difficult to express. Moreover, several works (see e.g. [17, 18]) have lead to a closed-form for the PDF of the output SINR based on the joint distribution of the eigenvalues of a random matrix. However, such expressions are cumbersome to evaluate as they comprise a squared Vandermonde determinant, whose number of terms explodes as the number of antennas or signals grows. Thus, the analysis of MMSE receivers is sometimes intractable and represents a challenging mathematical problem. Nevertheless, we show that the SINR and rate expressions can be obtained through random matrix theory and multivariate statistics [19\u201321]. The specific contributions of the paper are as follows:\n\u277c In the high SNR regime, we examine the distribution of the output SINR of the first-layer processor for a given user in the presence of multiple equalpower interferers. For the case where the subset size exceeds the total number of interfering signals (intra-cell and out-of-cell interferers), we decompose the SINR into two independent terms using the orthogonal projection onto the interference subspace. Then, we find an approximate expression for the probability density function (PDF) of the output SINR. For the case when there are more interferers than antennas in each subset, upper bounds on the output SINR and its distribution are also derived. \u277c From the obtained analytical expressions for the output SINR, we derive upper bounds and approximations on the average uplink SINR at the output of the two-layer processor as well as the ergodic achievable rate. Furthermore, we apply these results to explicitly study the effects of inter-cell interference, subset size, and the number of BS antennas on the performance of M-MMSE/MRC processing. We also demonstrate that the validity of our theoretical analysis is verified through Monte-Carlo simulations for various system parameters.\nThe rest of this paper is organized as follows. Section 2 describes the system model for the proposed two-layer linear processing receiver architecture. In Section 3.1, we analyze the output SINR of first-layer processing. Upper bounds and approximations on the average output SINR and achievable rate at high SNR are derived in Sections 3.2 and 3.3, respectively. Section 4 presents the numerical results validating the theoretical analysis. Finally, a conclusion is drawn in Section 5."
        },
        {
            "heading": "2 System Description",
            "text": "Consider a massive MIMO system where a BS equipped with L antennas communicates with M users simultaneously using the same bandwidth. The system operates in the presence of I interferers from outside the cell of interest (COI). Both the desired and the interfering users are assumed to undergo Rayleigh fading. Then, the received vector is\nx = \u221a P 0 Hs + \u221a P I H \u2032 s \u2032 + n, (1)\nwhere \u221a P0 s \u2208 CM\u00d71 and \u221a PI s\n\u2032 \u2208 CI\u00d71 represent the transmitted vectors from the M desired users and the I interferers, respectively. We denote by H \u2208 CL\u00d7M and H\u2032 \u2208 CL\u00d7I the channel matrices from the desired and interfering users to the BS, respectively. The elements in H and H \u2032\nrepresent both independent small- and large-scale fading, i.e., hlm \u223c CN (0, \u03b2m) and h \u2032\nli \u223c CN (0, \u03b2 \u2032 i) for m = 1, \u00b7 \u00b7 \u00b7 ,M and i = 1, \u00b7 \u00b7 \u00b7 , I, respectively. Moreover,\u221a \u03b2m and \u221a \u03b2 \u2032\ni represent the path-loss attenuation and log-normal shadowing from the m-th desired user and the i -th interferer, respectively. The large-scale fading effect is assumed constant for analytical simplicity. We assume that the coefficients {\u03b2m} are equal to 1 for all desired users and the coefficients {\u03b2 \u2032\ni} are equal to \u03b2 for all interfering users, i.e., \u03b2 \u2032\ni = \u03b2 for all i \u2208 [1, I]. Then, n is the white Gaussian noise with covariance \u03c32n.\nFor data reception, we consider here the two-layer linear receiver proposed previously in [13]. As shown in Fig.1, the L branches are divided intoK subsets, where each subset is of a given size N . In the first layer, we implement MMMSE detection on each subset to benefit from its capability to mitigate interference. Then, the K resulting outputs are combined using MRC. In Fig.1, yk is the output of first-layer processing and z is the final output vector after MRC processing, which are expressed as\nyk = Wk xk, for k = 1, \u00b7 \u00b7 \u00b7 ,K (2) z = [zm] T m=1\u00b7\u00b7\u00b7M , (3)\nwhere yk = [y1k, y2k, \u00b7 \u00b7 \u00b7 , yMk]T , xk \u2208 CN\u00d71, and Wk \u2208 CM\u00d7N is the MMMSE weight matrix corresponding to the k-th subset. The m-th row of Wk is denoted by wmk. Let vm = [vmk]k=1\u00b7\u00b7\u00b7K be the MRC weighting vector for user m according to the result of first-layer processing. The whole proposed\ndetection scheme for a given user m is summarized in the pseudo-code in Algorithm 1 (see [13] for more detailed description). From [13], we recall that given L = K \u00d7 N , the computational complexity of the proposed M-MMSE/MRC receiver is O(KN3).\nAlgorithm 1 Two-layer linear receiver\nInput: P0, PI , H, H \u2032 , s, s \u2032 , n, N and L Output: zm 1: K = LN , n = kN \u2212N + 1, p = kN 2: x = \u221a P0 Hs + \u221a PI H \u2032 s \u2032 + n\n3: for k = 1 to K do\n4: xk = [xl]l=n\u00b7\u00b7\u00b7p 5: Hk = [hlm]l=n\u00b7\u00b7\u00b7p,m=1\u00b7\u00b7\u00b7M 6: H \u2032\nk = [h \u2032\nli]l=n\u00b7\u00b7\u00b7p,i=1\u00b7\u00b7\u00b7I 7: hmk = [hlm]l=n\u00b7\u00b7\u00b7p,m\u2208{1\u00b7\u00b7\u00b7M} 8: Rxk = P0 Hk H H k + PIH \u2032 k H \u2032 k H + \u03c32nIN 9: wmk = w H M-MMSE,mk = \u221a P0 h H mk R \u22121 xk\n10: ymk = wmkxk\n11: v\u2217mk = \u221a hHmk R \u22121 xk hmk 12: end for 13: zm = \u2211K k=1 v \u2217 mkymk\nIt is worth noting that Rxk represents the covariance matrix of xk. As can be seen in (3), the output of the first-layer processor for user m on subset k can be written as\nymk = \u221a P0 wmk hmk sm + \u221a P0 M\u2211\nn 6=m\nwmk hnk sn\n+ \u221a\nPI\nI\u2211\ni=1\nwmk h \u2032 ik s \u2032 i +wmk nk, (4)\nwhere the first term, denoted by yd,mk, represents the desired portion in the output of the first layer. The remaining terms, denoted by yI +N,mk, represent interference-plus-noise. Assuming that the BS has perfect CSI, the SINR at the output of subset k for user m is given by\n\u03b3mk = E\n[\u2223\u2223yd,mk \u2223\u22232 ]\ntt =\nP0 \u2223\u2223wmk hmk \u2223\u22232\nwmk RI +N,k w H mk\n, (5)\nwhere RI +N,k is the interference-plus-noise covariance matrix corresponding to the k -th subset. Letting Hk be the matrix resulting from deletion of the m-th\ncolumn of Hk, RI +N,k is expressed as\nRI +N,k = P0HkH H k + PIH \u2032 kH \u2032H k + \u03c3 2 nIN , (6)\n= Rxk \u2212 P0hmkhHmk.\nGiven wmk = \u221a P0 h H mk R \u22121 xk , \u03b3mk can be expressed as\n\u03b3mk = P0h\nH mk R \u22121 xk hmk\n1\u2212 P0hHmk R\u22121xk hmk . (7)\nThen, using the matrix inversion lemma, the SINR expression is reduced to\n\u03b3mk = P0 h H mk R \u22121 I +N,k hmk. (8)\nIn the second layer, the K resulting outputs are combined using MRC. As is well known, this implies that the final output SINR is equal to the sum of the combined SINRs, i.e.\n\u03b3m =\nK\u2211\nk=1\n\u03b3mk. (9)"
        },
        {
            "heading": "3 Performance Analysis for Two-Layer Linear Receiver",
            "text": "In this section, we present analytical expressions for the PDF of the output SINR of the first-layer processor, average output SINR, and ergodic uplink rate."
        },
        {
            "heading": "3.1 PDF of Output SINR of the First-Layer Processor",
            "text": "Given (6), the output SINR of subset k for user m is given by\n\u03b3mk = P0 h H mk ( P0HkH H k + PIH \u2032 kH \u2032H k + \u03c3 2 nIN )\u22121 hmk. (10)\nIt is assumed that the subset size N may be chosen such that N > M or N > I. In this case, the products HkH H k and H \u2032 kH \u2032H\nk are complex-singularWishart distributed, denoted as usual by CWN (M \u22121, IN ) and CWN (I, \u03b2IN ), respectively [22]. Obtaining the exact distribution of the linear combination of Wishart matrices with non-identical covariances presents mathematical challenges in wireless communication [23]. An important result presented in [19] can be used to approximate the weighted sum of non-identically distributed Wishart matrices. However, this approximation is not general and cannot be used for any set of linear coefficients, especially if the sum is not of full rank.\nInspired by [19], we propose to approximate the sum of these two Wishart matrices by another central Wishart matrix Sk, as follows:\nP0HkH H k + PIH \u2032 kH \u2032H k \u2248 \u03b1sSk, (11)\nwhere the number of DOFs of the sum of Wishart matrices is approximated as ds = M + I \u2212 1 and\n\u03b1s = P0(M \u2212 1) + PI\u03b2I\nds \u2212 \u01eb, (12)\n\u01eb = (P0 \u2212 PI\u03b2) (M \u2212 1)\nds . (13)\nWe note that \u01eb corresponds to an error between the exact sum and the approximation from [19]. Indeed, (13) is a mathematical approximation that was chosen empirically based on a set of scenarios. Let Hs be a N \u00d7 ds random matrix composed of ds propagation vectors from all interferers as columns. The matrix Sk can be expressed as Sk = HsH H s , which is independent of hmk [19]. Using this approximation, the SINR in (10) can be approximated as\n\u03b3mk \u2248 \u03b3\u0303mk = P0 \u03b1s hHmk\n( Sk +\n\u03c32n \u03b1s IN\n)\u22121 hmk. (14)\nIn the following, we first examine the SINR distribution when the number of antenna elements in each subset is greater than the number of all users, i.e. N > ds. Then, the analysis is extended to the case when the subset size N is smaller than all users.\n1) Case 1: N > ds\nUsing spectral decomposition, the matrix Sk can be written as U H\u039bkU where U is a unitary matrix and the diagonal matrix \u039bk contains the eigenvalues of Sk. Using a similar approach to that of [24], the approximated SINR \u03b3\u0303mk can be expressed as\n\u03b3\u0303mk = P0 \u03b1s\nds\u2211\ni=1\n|umk,i|2\n\u03bbik + \u03c32 n\n\u03b1s\n+ P0 \u03c32n\nN\u2211\ni=ds+1\n|umk,i|2= S1 + S2, (15)\nwhere \u03bbik is a nonzero eigenvalue of Sk for all 1 \u2264 i \u2264 ds. The vector umk = Uhmk = [umk,1, \u00b7 \u00b7 \u00b7 , umk,ds ]T has the same distribution as hmk. From the above sum, we will denote the first and second summation terms as S1 and S2, respectively. Since the two terms are independent, the PDF of \u03b3\u0303mk is computed by the convolution of the S1 and S2 densities as\nf\u03b3\u0303mk(x) = fS1(x) \u2217 fS2(x). (16)\nWe first examine the PDF of S1. We have\nS1 = P0 \u03b1s\nds\u2211\ni=1\n|umk,i|2\n\u03bbik + \u03c32 n\n\u03b1s\n, (17)\nwhere |umk,i|2 has a Chi-square distribution with two DoFs. Since |umk,i| and \u03bbik are independent for 1 \u2264 i \u2264 ds, we can express the PDF of S1 in integral form. However, it requires the evaluation of ds integrals and a closed-form expression becomes difficult to obtain for large ds. We present herein a more tractable expression for the distribution of \u03b3\u0303mk. The matrix HHs Hs is a nonsingular Wishart matrix, whose eigenvalues are the same as the nonzero eigenvalues of Sk. Let us define a new variable V as\nV = P0 \u03b1s cHmk\n( HHs Hs +\n\u03c32n \u03b1s Ids\n)\u22121 cmk, (18)\nwhere cmk is complex Gaussian with zero mean and unit variance. It is noteworthy that V has a similar spectral decomposition as that of S1. Hence, S1 and V have the same distribution. We focus herein on the interference-limited regime, and we ignore the effect of thermal noise to simplify the analysis. We now have\nV \u2248 P0 \u03b1s\ncHmk ( HHs Hs )\u22121 cmk. (19)\nSince cmk is CN (0, I), and is distributed independently of HHs Hs which is CWds(ds, I), the PDF of S1 is given by [25]\nfS1(x) \u2248 1\nB(ds, N\u2212ds+1)\n( P0 \u03b1s )N\u2212ds+1 xds\u22121 ( x+ P0\u03b1s )N+1 u(x), (20)\nwhere u(x) is the Heaviside step function and B(x, y) is the beta function. The second term S2 in (15) is a summation of exponential distributions multiplied by P0\u03c32\nn . Therefore, it follows a scaled central Chi-square distribution with 2(N\u2212 ds) DOFs whose PDF is expressed\nfS2(x) = 1\n\u0393(N \u2212 ds) ( \u03c32n P0 )N\u2212ds xN\u2212ds\u22121 e\u2212 \u03c3 2 n P0 x u(x), (21)\nwhere \u0393(x) is the Gamma function. It follows that the PDF of \u03b3\u0303mk can be computed through the convolution of fS1(x) and fS2(x) as\nf\u03b3\u0303mk(x) =\n\u222b \u221e\n\u2212\u221e\nfS1(t) fS2(x\u2212 t) dt. (22)\nSubstituting (20) and (21) in (22), we have\nf\u03b3\u0303mk(x) = P0 \u03c3\n2(N\u2212ds) n e\n\u2212 \u03c3 2 n\nP0 x\nB(ds, N \u2212 ds + 1) \u0393(N \u2212 ds) \u03b1N\u2212ds+1s \u00d7 \u222b x\n0\ntds\u22121 (\nP0 \u03b1s\n+ t )N+1 (x\u2212 t)\nN\u2212ds\u22121 e \u03c3 2 n P0 t dt. (23)\nAs shown in Appendix A, the above equation can be evaluated as\nf\u03b3\u0303mk(x) \u2248 \u03c3 2(N\u2212ds) n e\n\u2212 \u03c3 2 n\nP0 x \u03b1dss\nB(ds, N\u2212ds+1)\u0393(N\u2212ds)PN0\nN\u2212ds\u22121\u2211\ni=0\n+\u221e\u2211\nj=0\n(\u22121)i j!\n( N\u2212ds\u22121\ni\n) \u00d7\n( \u03c32n P0 )j xN+j\u22121 ds+i+j 2F1 ( N+1, ds+i+j; ds+i+j+1; \u2212 \u03b1s P0 x ) . (24)\n2) Case 2: N \u2264 ds Let us now consider the case when the total number of users exceeds the subset size. We recall that the approximated SINR is given by\n\u03b3\u0303mk = P0 \u03b1s hHmk\n( Sk +\n\u03c32n \u03b1s IN\n)\u22121 hmk. (25)\nIt is worth noting that this expression has a similar form as that of V in (18). Since N \u2264 ds, the matrix Sk is a full rank Wishart matrix, i.e. Sk \u223c CWN (ds, IN ), unlike in Case 1. The SINR expression can be rewritten as follows:\n\u03b3\u0303mk = P0 \u03b1s hHmkhmk[ h\u0303Hmk ( HsHHs + \u03c32 n \u03b1s IN )\u22121 h\u0303mk ]\u22121 , (26)\nwhere h\u0303mk = hmk/\u2016hmk\u2016. Let us now concentrate on the denominator in the above, denoted by D. Using QR factorization, the vector h\u0303mk can be expressed as h\u0303 H mk = e\nHQ, where e = [1 0 \u00b7 \u00b7 \u00b7 0], and Q represents a unitary matrix. It follows that D =( eH ( QHsH H s Q H + \u03c32 n\n\u03b1s IN\n)\u22121 e )\u22121 . Letting A = QHsH H s Q H , we have\nD = ( eH ( A+\n\u03c32n \u03b1s IN\n)\u22121 e\n)\u22121\n= a11 + \u03c32n \u03b1s\n\u2212 a12 ( A22 +\n\u03c32n \u03b1s IN\u22121\n)\u22121 a21, (27)\nwhere a11, a12, a21,and A22 are matrix sub-blocks, and a11 is of size 1 \u00d7 1. The above expression is derived using the block-wise matrix inversion formula. Furthermore, we can see that the denominator D can be lower bounded as follows:\nD \u2265 a11 \u2212 a12A\u2212122 a21 + \u03c32n \u03b1s . (28)\nGiven that a11 \u2212 a12A\u2212122 a21 = [ (A\u22121)11 ]\u22121 , the SINR \u03b3\u0303mk in (26) is then upper bounded by\n\u03b3\u0303mk \u2264 P0 h\nH mkhmk\n\u03b1s [(A\u22121)11] \u22121 + \u03c32n =\nP0 \u00b5\n\u03b1s \u03bd + \u03c32n\n= a\nb = \u03b3umk, (29)\nwhere \u03b3umk denotes the upper bound on \u03b3\u0303mk. It can be shown that \u00b5 = hHmkhmk is Chi-square distributed with 2N DoFs. Furthermore, the matrix A = QHsH H s Q H has the same distribution as HsH H s , i.e. CWN (ds, IN ). According to a property of Wishart matrices [21], \u03bd = [ (A\u22121)11 ]\u22121 follows a central Chi-square distribution with 2(ds \u2212N + 1) DoFs. Thus, we have\nf\u00b5(x) = 1\n\u0393(N) xN\u22121 e\u2212x u(x), (30)\nf\u03bd(x) = 1\n\u0393(ds \u2212N + 1) xds\u2212N e\u2212x u(x). (31)\nIt follows that the PDF of a = P0 \u00b5 is computed as\nfa(x) = 1\nPN0 \u0393(N) xN\u22121 e\u2212x/P0 u(x). (32)\nAlso, the r.v. b is a Chi-square variate multiplied by \u03b1s and to which is added the constant \u03c32n. Thus, we have\nfb(x) = (x\u2212 \u03c32n)ds\u2212N\n\u0393(ds\u2212N+1)\u03b1ds\u2212N+1s e\u2212\nx\u2212\u03c3 2 n\n\u03b1s u(x\u2212 \u03c32n). (33)\nIt follows readily that its inverse has the PDF\nf1/b(x) = e\n\u03c3 2 n \u03b1s \u0393(ds\u2212N+1) \u03b1ds\u2212N+1s x2 ( 1 x \u2212 \u03c32n )ds\u2212N e\u2212 1 \u03b1sx u ( 1 x \u2212 \u03c32n ) . (34)\nGiven that \u03b3umk in (29) is the product of two independent r.v.s, the PDF is then given by the Mellin convolution, i.e.\nf\u03b3u mk (x) =\n\u222b \u221e\n\u2212\u221e\n1 t fa(t) f1/b (x t ) dt. (35)\nSubstituting (32) and (34) in (35), we obtain\nf\u03b3u mk\n(x) = e\n\u03c3 2 n \u03b1s\n\u0393(N) \u0393(ds\u2212N+1) \u03b1ds\u2212N+1s PN0 xds\u2212N+2 \u00d7 \u222b \u221e\n\u03c32 n x\ntN ( t\u2212 \u03c32nx )ds\u2212N e \u2212t ( 1 P0 + 1 \u03b1sx ) dt. (36)\nAs shown in Appendix B, the above can be computed as\nf\u03b3u mk\n(x) = e\u2212\n\u03c3 2 n x\nP0\n\u0393(N) \u0393(ds\u2212N+1) \u03b1ds\u2212N+1s PN0 xds\u2212N+2 \u00d7 N\u2211\ni=0\n( N\ni\n)( \u03c32nx\n)i \u0393(ds \u2212 i+ 1)( 1 P0 + 1\u03b1sx )ds\u2212i+1 . (37)"
        },
        {
            "heading": "3.2 Average output SINR",
            "text": "Now, we investigate the average SINR at the output of the two-layer processor by considering separately the cases N > ds and N \u2264 ds. Given (9), we note that the output SINR is simply the sum of the combined SINRs in each subset. Assuming that all subsets have the same mean SINR, the average output SINR for user m, denoted by \u03b3\u0304m, can be computed as\n\u03b3\u0304m = K E {\u03b3mk} = K \u0393, (38)\nwhere \u0393 is the average SINR in any given subset, and E{.} denotes the expectation operation. When N > ds, the approximated SINR \u03b3\u0303mk given in (15) is expressed as the sum of two terms. Thus, the mean of \u03b3\u0303mk, denoted by \u0393\u0303, can be found by computing the expectations of each term, i.e.\n\u0393\u0303 = E{\u03b3\u0303mk} = E{S1}+ E{S2}. (39)\nUsing (20) and (21), \u0393\u0303 is then given by\n\u0393\u0303 = 1\nB(N\u2212ds+1, ds) ( P0 \u03b1s )N\u2212ds+1\u222b \u221e\n0 xds ( x+ P0\u03b1s )N+1 dx +\n1\n\u0393(N \u2212 ds) ( \u03c32n P0 )N\u2212ds \u222b \u221e\n0\nxN\u2212ds e\u2212 \u03c3 2 n P0 xdx, (40)\nwhere the first integral can be solved by virtue of [26, eq. 3.194-3] and the second is in the form of a Gamma function. After some basic simplifications,\nwe get\n\u0393\u0303 = P0ds\n\u03b1s(N \u2212 ds) + P0 \u03c32n (N \u2212 ds) . (41) When N \u2264 ds, an upper bound on \u03b3\u0303mk is derived in (29). Therefore, its average value \u0393 is bounded by \u0393 \u2264 E {\u03b3umk} = \u0393u, (42) where \u0393u denotes the upper bound on \u0393. Using (37), we have\n\u0393u = 1\n\u0393(N)\u0393(ds\u2212N+1)\u03b1ds\u2212N+1s PN0\nN\u2211\ni=0\n( N\ni\n) \u03c32in \u00d7\n\u0393(ds \u2212 i+ 1) \u222b \u221e\n0\nxN+i\u2212ds\u22121e\u2212 \u03c3 2 n x P0\n( 1 P0 + 1\u03b1sx )ds\u2212i+1 dx. (43)\nThen, by using [26, eq. 9.211-4], we find\n\u0393u = P0N\n\u0393(ds\u2212N+1)\u03b1s\nN\u2211\ni=0\n( N\ni ) ( \u03c32n \u03b1s )i \u00d7\n\u0393(ds\u2212i+ 1) \u03a8(N+1, N\u2212ds+i+1; \u03c32n \u03b1s ), (44)\nwhere \u03a8(a; b; z) is the Tricomi confluent hypergeometric function. Consequently, the average output SINR for user m is given by\n\u03b3\u0304m \u2248 K\u0393\u0303 for N > ds, (45) \u03b3\u0304m \u2264 K\u0393u for N \u2264 ds . (46)"
        },
        {
            "heading": "3.3 Achievable Rate",
            "text": "In this section, the results derived above are leveraged to determine the uplink achievable rate with the proposed two-layer receiver. Given (9), the ergodic achievable rate of the m-th user is given by\nRm = E { log2 (1 + \u03b3m) } . (47)\nBy using Jensen\u2019s inequality of concave functions, the achievable rate is bounded by\nRm \u2264 log2 ( 1 + E {\u03b3m} ) = Rum, (48)\nwhere Rum denotes the upper bound on Rm. Based on our analytical results, we obtain\nRum =    log2 ( 1 +K\u0393\u0303 ) , for N > ds ,\nlog2\n( 1 +K\u0393u ) , for N \u2264 ds,\n(49)\nwhere \u0393\u0303 and \u0393u are derived in (41) and (44), respectively. Hence, the total achievable sum rate for all desired users can be bounded by\nR =\nM\u2211\nm=1\nRm \u2264 M Rum. (50)"
        },
        {
            "heading": "4 Numerical Results",
            "text": "In this section, we provide some numerical results to validate the accuracy of the developed expressions as well as study the effects of inter-cell interference and subset size on the performance of the M-MMSE/MRC receiver. We consider a massive MIMO scenario where at least 2 closest cells are interfering with the COI. Assume that the number of interferers could be at least twice the number of desired users, i.e. I = 2M . As mentioned in Section 2 , we assume that \u03b2m = 1 and \u03b2 \u2032\ni = \u03b2 for i \u2208 [1, I]. Due to this assumption, the received powers from out-of-cell users are equal. The inter-cell interference factor \u03b2 is chosen to vary between 0.1 and 1. Furthermore, we consider 4-quadrature amplitude modulation (4-QAM), and we choose P0 = PI = 10 dB.\nFig. 2 shows the shape of the PDF of the output SINR of first-layer processing when L = 48, M = 5 and I = 15 for different values of N . From the approximation used in (11), we have herein ds = M + I \u2212 1 = 19. The legend Analytical indicates the approximation shown in (24) for N > ds while it indicates the upper bound obtained in (37) for N \u2264 ds. At an SNR of 10 dB, we observe clearly that the analytical results coincide with Monte Carlo simulations and the bound becomes tighter when N increases. Furthermore, as\nN goes up, the distributions become narrower and are translated to the right. Moreover, the weight of the PDF around zero vanishes, which can improve the system performance.\nFig. 3 shows the average output SINR at the second layer for user m in the same scenario as in Fig. 2, but with different values of L. We can see that the analytical curves are accurate in all cases, even for a moderate array size. We observe also that the average SINR increases as the subset size N increases. The highest performance is obtained when N = 24 > ds. Indeed, first-layer M-MMSE processing allows for a significant reduction of both inter-cell and intra-cell interference. When N = {8, 12, 16} < ds, there is an SINR loss compared to the case when N = 24 due to the effect of residual interference. In that case, the performance can be enhanced by increasing the array size. It is interesting to note that for a fixed average SINR performance ( \u03b3\u0304m \u2243 12 dB), the computational complexity can be reduced when the subset size becomes smaller.\nFig. 4 illustrates the effect of inter-cell interference on the uplink achievable sum rate of the M-MMSE/MRC processing scheme with L = 96, M = 10, and I = 20. Again, the cohesion between analytical and simulation results validates the tightness of our analysis in the high SNR regime. As expected, the sum rate increases as N grows. When N = 32 > ds, we can see clearly that the sum rate decreases very slowly and approaches a constant value regardless of the effect of interference. In addition, a 32\u00d732 matrix needs to be inverted instead of a 96\u00d796 one, leading to a substantial reduction of complexity. On the other\nhand, when N < ds, the achievable sum rates decrease significantly as the inter-cell interference factor \u03b2 increases. This is due to the fact that the DoFs are insufficient to combat the effect of inter-cell interference, especially when N < I. For example, when decreasing N from 24 to 16 at \u03b2 = 0.3, the sum rate is reduced by 23.5% while achieving a much better complexity reduction. Therefore, it could be argued that the M-MMSE/MRC receiver can achieve a good trade-off between performance and complexity, especially where the subset size exceeds the out-of-cell interfering signals."
        },
        {
            "heading": "5 Conclusion",
            "text": "A two-layer linear processing receiver architecture for uplink massive MIMO systems has been presented previously that can achieve a desirable tradeoff between performance and complexity. In this paper, we presented a more detailed performance analysis of the proposed M-MMSE/MRC receiver. Under the assumption of uncorrelated Rayleigh fading and equal-power out-of-cell interferers, the analysis is conducted for both cases where the subset size is smaller or greater than the number of all interferers. In the high SNR regime, we derived upper bounds and approximations for the PDF of the output SINR of first-layer processing, as well as the average output SINR and the achievable rate. The validity of the theoretical results is confirmed through Monte-Carlo simulations for various system setups. In addition, although the analytical expressions involve hypergeometric functions, their evaluation in software is highly efficient compared with heavy Monte-Carlo simulations.\nThe results show that, for the case N > ds, the M-MMSE/MRC receiver provides significant sum-rate performance gains regardless of the effect of interference. However, when the subset size becomes smaller, the computational complexity is further reduced but there is a noticeable performance degradation. Nonetheless, system performance can still be improved by increasing the array size. We have proved that to take advantage of the interference mitigation capability of M-MMSE at the first processing layer, it is more efficient to choose a subset size greater than the number of interfering signals. It follows that choosing N > I leads to a better complexity / performance trade-off."
        },
        {
            "heading": "Appendix A",
            "text": "In this appendix, we provide the derivation of (24). From (23), the expression for the PDF of \u03b3mk can be expanded by applying the binomial theorem to the polynomial (x\u2212 t)N\u2212ds\u22121 in the integrand, i.e.\nf\u03b3mk(x) = \u0393(N+1)P0 \u03c3\n2(N\u2212ds) n e\n\u2212 \u03c3 2 n\nP0 x\n\u0393(ds)\u0393(N\u2212ds+1)\u0393(N\u2212ds)\u03b1N\u2212ds+1s\nN\u2212ds\u22121\u2211\ni=0\n(\u22121)i ( N\u2212ds\u22121\ni\n) \u00d7\nxN\u2212ds\u2212i\u22121 \u222b x\n0\ntds+i\u22121 (\nP0 \u03b1s\n+ t )N+1 e\n\u03c3 2 n P0 t dt. (A1)\nLet\nI =\n\u222b x\n0\ntds+i\u22121 (\nP0 \u03b1s\n+ t )N+1 e\n\u03c3 2 n P0 t dt. (A2)\nThen, the integral can be further expanded using the power series representation of the exponential function, i.e.\nI =\n\u221e\u2211\ni=0\n1\nj! ( \u03c32n P0 )j \u222b x\n0\ntds+i+j\u22121 (\nP0 \u03b1s\n+ t )N+1 dt\n(a) =\n\u221e\u2211\ni=0\n1\nj! ( \u03c32n P0 )j ( \u03b1s P0 )N+1 xds+i+j ds + i+ j \u00d7\n2F1 ( N + 1, ds+i+j; ds+i+j + 1; \u2212\n\u03b1s P0 x\n) , (A3)\nwhere the integral is solved in step (a) by virtue of [26, eq. 3.194-1]. We note that 2F1 (a, b; c; z) is the Gaussian hypergeometric function. Finally, substituting (A3) in (A1), we obtain the desired result (24)."
        },
        {
            "heading": "Appendix B",
            "text": "From (36), we apply the change of variables s = t\u2212 \u03c32nx to obtain\nf\u03b3u mk\n(x) = e\u2212\n\u03c3 2 n x\nP0\n\u0393(N) \u0393(ds\u2212N+1) \u03b1ds\u2212N+1s PN0 xds\u2212N+2 \u00d7 \u222b \u221e\n0\nsds\u2212N ( s+ \u03c32nx )N e \u2212s ( 1 P0 + 1 \u03b1sx ) ds. (B4)\nPerforming a binomial expansion of the polynomial in the integrand yields\nf\u03b3u mk\n(x) = e\u2212\n\u03c3 2 n x\nP0\n\u0393(N) \u0393(ds\u2212N+1) \u03b1ds\u2212N+1s PN0 xds\u2212N+2 \u00d7\nN\u2211\ni=0\n( N\ni\n)( \u03c32nx )i \u222b \u221e\n0\nsds\u2212ie \u2212s\n( 1\nP0 + 1 \u03b1sx\n)\nds, (B5)\nwhere the resulting integral corresponds to the definition of the Gamma function. Therefore, with some manipulations, we obtain the desired result (37)."
        }
    ],
    "title": "Uplink SINR and Rate Analysis in Massive MIMO Systems with Two-Layer Linear Receiver",
    "year": 2022
}